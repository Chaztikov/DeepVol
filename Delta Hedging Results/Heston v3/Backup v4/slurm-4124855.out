WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 01:05:45.734305: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 01:05:46.000062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-17 01:05:46.000572: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:05:46.002485: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:05:46.004319: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:05:46.004832: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:05:46.007092: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:05:46.008931: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:05:46.013731: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:05:46.059773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:05:46.060154: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 01:05:46.066803: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399990000 Hz
2019-12-17 01:05:46.066991: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c5534700e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:05:46.067010: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 01:05:46.088522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-17 01:05:46.088555: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:05:46.088570: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:05:46.088581: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:05:46.088593: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:05:46.088604: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:05:46.088615: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:05:46.088627: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:05:46.132246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:05:46.132288: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:05:46.929198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 01:05:46.929229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 01:05:46.929242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 01:05:46.999568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15215 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
2019-12-17 01:05:47.001683: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c553aa9350 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:05:47.001702: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: 4.0000e-02
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 01:06:21.580959: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.4418e+02,   Y0: 2.6537e+00,  elapsed time  34
INFO   step:     1,    loss: 1.0249e+02,   Y0: 2.6587e+00,  elapsed time  50
INFO   step:     2,    loss: 1.0246e+02,   Y0: 2.6617e+00,  elapsed time  52
INFO   step:     3,    loss: 1.0246e+02,   Y0: 2.6656e+00,  elapsed time  54
INFO   step:     4,    loss: 1.0246e+02,   Y0: 2.6700e+00,  elapsed time  56
INFO   step:     5,    loss: 1.0245e+02,   Y0: 2.6740e+00,  elapsed time  57
INFO   step:     6,    loss: 1.0246e+02,   Y0: 2.6777e+00,  elapsed time  59
INFO   step:     7,    loss: 1.0245e+02,   Y0: 2.6816e+00,  elapsed time  61
INFO   step:     8,    loss: 1.0244e+02,   Y0: 2.6858e+00,  elapsed time  63
INFO   step:     9,    loss: 1.0244e+02,   Y0: 2.6903e+00,  elapsed time  65
INFO   step:    10,    loss: 1.0244e+02,   Y0: 2.6944e+00,  elapsed time  66
INFO   step:    11,    loss: 1.0243e+02,   Y0: 2.6986e+00,  elapsed time  68
INFO   step:    12,    loss: 1.0243e+02,   Y0: 2.7022e+00,  elapsed time  70
INFO   step:    13,    loss: 1.0242e+02,   Y0: 2.7055e+00,  elapsed time  72
INFO   step:    14,    loss: 1.0241e+02,   Y0: 2.7081e+00,  elapsed time  73
INFO   step:    15,    loss: 1.0241e+02,   Y0: 2.7112e+00,  elapsed time  75
INFO   step:    16,    loss: 1.0240e+02,   Y0: 2.7143e+00,  elapsed time  77
INFO   step:    17,    loss: 1.0239e+02,   Y0: 2.7173e+00,  elapsed time  79
INFO   step:    18,    loss: 1.0238e+02,   Y0: 2.7204e+00,  elapsed time  80
INFO   step:    19,    loss: 1.0237e+02,   Y0: 2.7223e+00,  elapsed time  82
INFO   step:    20,    loss: 1.0236e+02,   Y0: 2.7240e+00,  elapsed time  84
INFO   step:    21,    loss: 1.0236e+02,   Y0: 2.7262e+00,  elapsed time  86
INFO   step:    22,    loss: 1.0235e+02,   Y0: 2.7278e+00,  elapsed time  88
INFO   step:    23,    loss: 1.0234e+02,   Y0: 2.7291e+00,  elapsed time  89
INFO   step:    24,    loss: 1.0234e+02,   Y0: 2.7293e+00,  elapsed time  91
INFO   step:    25,    loss: 1.0233e+02,   Y0: 2.7288e+00,  elapsed time  93
INFO   step:    26,    loss: 1.0232e+02,   Y0: 2.7289e+00,  elapsed time  95
INFO   step:    27,    loss: 1.0231e+02,   Y0: 2.7286e+00,  elapsed time  96
INFO   step:    28,    loss: 1.0230e+02,   Y0: 2.7285e+00,  elapsed time  98
INFO   step:    29,    loss: 1.0230e+02,   Y0: 2.7286e+00,  elapsed time 100
INFO   step:    30,    loss: 1.0229e+02,   Y0: 2.7289e+00,  elapsed time 102
INFO   step:    31,    loss: 1.0228e+02,   Y0: 2.7297e+00,  elapsed time 103
INFO   step:    32,    loss: 1.0228e+02,   Y0: 2.7302e+00,  elapsed time 105
INFO   step:    33,    loss: 1.0227e+02,   Y0: 2.7309e+00,  elapsed time 107
INFO   step:    34,    loss: 1.0227e+02,   Y0: 2.7313e+00,  elapsed time 109
INFO   step:    35,    loss: 1.0226e+02,   Y0: 2.7316e+00,  elapsed time 111
INFO   step:    36,    loss: 1.0225e+02,   Y0: 2.7318e+00,  elapsed time 112
INFO   step:    37,    loss: 1.0225e+02,   Y0: 2.7328e+00,  elapsed time 114
INFO   step:    38,    loss: 1.0224e+02,   Y0: 2.7338e+00,  elapsed time 116
INFO   step:    39,    loss: 1.0223e+02,   Y0: 2.7342e+00,  elapsed time 118
INFO   step:    40,    loss: 1.0223e+02,   Y0: 2.7343e+00,  elapsed time 119
INFO   step:    41,    loss: 1.0223e+02,   Y0: 2.7344e+00,  elapsed time 121
INFO   step:    42,    loss: 1.0222e+02,   Y0: 2.7347e+00,  elapsed time 123
INFO   step:    43,    loss: 1.0222e+02,   Y0: 2.7347e+00,  elapsed time 125
INFO   step:    44,    loss: 1.0221e+02,   Y0: 2.7352e+00,  elapsed time 127
INFO   step:    45,    loss: 1.0221e+02,   Y0: 2.7349e+00,  elapsed time 128
INFO   step:    46,    loss: 1.0220e+02,   Y0: 2.7345e+00,  elapsed time 130
INFO   step:    47,    loss: 1.0219e+02,   Y0: 2.7348e+00,  elapsed time 132
INFO   step:    48,    loss: 1.0219e+02,   Y0: 2.7350e+00,  elapsed time 134
INFO   step:    49,    loss: 1.0221e+02,   Y0: 2.7348e+00,  elapsed time 135
INFO   step:    50,    loss: 1.0222e+02,   Y0: 2.7349e+00,  elapsed time 137
INFO   step:    51,    loss: 1.0224e+02,   Y0: 2.7351e+00,  elapsed time 139
INFO   step:    52,    loss: 1.0225e+02,   Y0: 2.7351e+00,  elapsed time 141
INFO   step:    53,    loss: 1.0227e+02,   Y0: 2.7357e+00,  elapsed time 142
INFO   step:    54,    loss: 1.0228e+02,   Y0: 2.7366e+00,  elapsed time 144
INFO   step:    55,    loss: 1.0230e+02,   Y0: 2.7377e+00,  elapsed time 146
INFO   step:    56,    loss: 1.0230e+02,   Y0: 2.7388e+00,  elapsed time 148
INFO   step:    57,    loss: 1.0231e+02,   Y0: 2.7405e+00,  elapsed time 150
INFO   step:    58,    loss: 1.0230e+02,   Y0: 2.7417e+00,  elapsed time 151
INFO   step:    59,    loss: 1.0229e+02,   Y0: 2.7429e+00,  elapsed time 153
INFO   step:    60,    loss: 1.0228e+02,   Y0: 2.7443e+00,  elapsed time 155
INFO   step:    61,    loss: 1.0226e+02,   Y0: 2.7460e+00,  elapsed time 157
INFO   step:    62,    loss: 1.0226e+02,   Y0: 2.7479e+00,  elapsed time 158
INFO   step:    63,    loss: 1.0225e+02,   Y0: 2.7499e+00,  elapsed time 160
INFO   step:    64,    loss: 1.0224e+02,   Y0: 2.7506e+00,  elapsed time 162
INFO   step:    65,    loss: 1.0223e+02,   Y0: 2.7513e+00,  elapsed time 164
INFO   step:    66,    loss: 1.0222e+02,   Y0: 2.7520e+00,  elapsed time 166
INFO   step:    67,    loss: 1.0221e+02,   Y0: 2.7536e+00,  elapsed time 167
INFO   step:    68,    loss: 1.0221e+02,   Y0: 2.7552e+00,  elapsed time 169
INFO   step:    69,    loss: 1.0221e+02,   Y0: 2.7577e+00,  elapsed time 171
INFO   step:    70,    loss: 1.0220e+02,   Y0: 2.7602e+00,  elapsed time 173
INFO   step:    71,    loss: 1.0220e+02,   Y0: 2.7632e+00,  elapsed time 174
INFO   step:    72,    loss: 1.0219e+02,   Y0: 2.7660e+00,  elapsed time 176
INFO   step:    73,    loss: 1.0218e+02,   Y0: 2.7683e+00,  elapsed time 178
INFO   step:    74,    loss: 1.0218e+02,   Y0: 2.7702e+00,  elapsed time 180
INFO   step:    75,    loss: 1.0218e+02,   Y0: 2.7718e+00,  elapsed time 182
INFO   step:    76,    loss: 1.0217e+02,   Y0: 2.7732e+00,  elapsed time 183
INFO   step:    77,    loss: 1.0216e+02,   Y0: 2.7750e+00,  elapsed time 185
INFO   step:    78,    loss: 1.0216e+02,   Y0: 2.7757e+00,  elapsed time 187
INFO   step:    79,    loss: 1.0215e+02,   Y0: 2.7762e+00,  elapsed time 189
INFO   step:    80,    loss: 1.0214e+02,   Y0: 2.7755e+00,  elapsed time 190
INFO   step:    81,    loss: 1.0213e+02,   Y0: 2.7752e+00,  elapsed time 192
INFO   step:    82,    loss: 1.0212e+02,   Y0: 2.7749e+00,  elapsed time 194
INFO   step:    83,    loss: 1.0210e+02,   Y0: 2.7745e+00,  elapsed time 196
INFO   step:    84,    loss: 1.0209e+02,   Y0: 2.7749e+00,  elapsed time 197
INFO   step:    85,    loss: 1.0207e+02,   Y0: 2.7748e+00,  elapsed time 199
INFO   step:    86,    loss: 1.0206e+02,   Y0: 2.7737e+00,  elapsed time 201
INFO   step:    87,    loss: 1.0204e+02,   Y0: 2.7730e+00,  elapsed time 203
INFO   step:    88,    loss: 1.0203e+02,   Y0: 2.7726e+00,  elapsed time 205
INFO   step:    89,    loss: 1.0202e+02,   Y0: 2.7723e+00,  elapsed time 206
INFO   step:    90,    loss: 1.0201e+02,   Y0: 2.7721e+00,  elapsed time 208
INFO   step:    91,    loss: 1.0201e+02,   Y0: 2.7717e+00,  elapsed time 210
INFO   step:    92,    loss: 1.0200e+02,   Y0: 2.7704e+00,  elapsed time 212
INFO   step:    93,    loss: 1.0200e+02,   Y0: 2.7696e+00,  elapsed time 213
INFO   step:    94,    loss: 1.0200e+02,   Y0: 2.7685e+00,  elapsed time 215
INFO   step:    95,    loss: 1.0199e+02,   Y0: 2.7671e+00,  elapsed time 217
INFO   step:    96,    loss: 1.0199e+02,   Y0: 2.7658e+00,  elapsed time 219
INFO   step:    97,    loss: 1.0197e+02,   Y0: 2.7644e+00,  elapsed time 220
INFO   step:    98,    loss: 1.0196e+02,   Y0: 2.7630e+00,  elapsed time 222
INFO   step:    99,    loss: 1.0195e+02,   Y0: 2.7620e+00,  elapsed time 224
INFO   step:   100,    loss: 1.0194e+02,   Y0: 2.7611e+00,  elapsed time 226
INFO   step:   101,    loss: 1.0193e+02,   Y0: 2.7611e+00,  elapsed time 228
INFO   step:   102,    loss: 1.0193e+02,   Y0: 2.7609e+00,  elapsed time 229
INFO   step:   103,    loss: 1.0192e+02,   Y0: 2.7607e+00,  elapsed time 231
INFO   step:   104,    loss: 1.0191e+02,   Y0: 2.7604e+00,  elapsed time 233
INFO   step:   105,    loss: 1.0190e+02,   Y0: 2.7602e+00,  elapsed time 235
INFO   step:   106,    loss: 1.0190e+02,   Y0: 2.7598e+00,  elapsed time 236
INFO   step:   107,    loss: 1.0189e+02,   Y0: 2.7601e+00,  elapsed time 238
INFO   step:   108,    loss: 1.0189e+02,   Y0: 2.7597e+00,  elapsed time 240
INFO   step:   109,    loss: 1.0188e+02,   Y0: 2.7596e+00,  elapsed time 242
INFO   step:   110,    loss: 1.0187e+02,   Y0: 2.7593e+00,  elapsed time 243
INFO   step:   111,    loss: 1.0185e+02,   Y0: 2.7586e+00,  elapsed time 245
INFO   step:   112,    loss: 1.0184e+02,   Y0: 2.7591e+00,  elapsed time 247
INFO   step:   113,    loss: 1.0183e+02,   Y0: 2.7602e+00,  elapsed time 249
INFO   step:   114,    loss: 1.0182e+02,   Y0: 2.7610e+00,  elapsed time 251
INFO   step:   115,    loss: 1.0180e+02,   Y0: 2.7619e+00,  elapsed time 252
INFO   step:   116,    loss: 1.0179e+02,   Y0: 2.7630e+00,  elapsed time 254
INFO   step:   117,    loss: 1.0178e+02,   Y0: 2.7636e+00,  elapsed time 256
INFO   step:   118,    loss: 1.0176e+02,   Y0: 2.7641e+00,  elapsed time 258
INFO   step:   119,    loss: 1.0175e+02,   Y0: 2.7645e+00,  elapsed time 259
INFO   step:   120,    loss: 1.0174e+02,   Y0: 2.7649e+00,  elapsed time 261
INFO   step:   121,    loss: 1.0172e+02,   Y0: 2.7655e+00,  elapsed time 263
INFO   step:   122,    loss: 1.0171e+02,   Y0: 2.7661e+00,  elapsed time 265
INFO   step:   123,    loss: 1.0170e+02,   Y0: 2.7672e+00,  elapsed time 267
INFO   step:   124,    loss: 1.0169e+02,   Y0: 2.7677e+00,  elapsed time 268
INFO   step:   125,    loss: 1.0167e+02,   Y0: 2.7681e+00,  elapsed time 270
INFO   step:   126,    loss: 1.0166e+02,   Y0: 2.7680e+00,  elapsed time 272
INFO   step:   127,    loss: 1.0165e+02,   Y0: 2.7684e+00,  elapsed time 274
INFO   step:   128,    loss: 1.0164e+02,   Y0: 2.7685e+00,  elapsed time 275
INFO   step:   129,    loss: 1.0163e+02,   Y0: 2.7685e+00,  elapsed time 277
INFO   step:   130,    loss: 1.0162e+02,   Y0: 2.7680e+00,  elapsed time 279
INFO   step:   131,    loss: 1.0162e+02,   Y0: 2.7676e+00,  elapsed time 281
INFO   step:   132,    loss: 1.0161e+02,   Y0: 2.7667e+00,  elapsed time 282
INFO   step:   133,    loss: 1.0160e+02,   Y0: 2.7661e+00,  elapsed time 284
INFO   step:   134,    loss: 1.0159e+02,   Y0: 2.7653e+00,  elapsed time 286
INFO   step:   135,    loss: 1.0159e+02,   Y0: 2.7643e+00,  elapsed time 288
INFO   step:   136,    loss: 1.0158e+02,   Y0: 2.7638e+00,  elapsed time 289
INFO   step:   137,    loss: 1.0157e+02,   Y0: 2.7643e+00,  elapsed time 291
INFO   step:   138,    loss: 1.0156e+02,   Y0: 2.7642e+00,  elapsed time 293
INFO   step:   139,    loss: 1.0155e+02,   Y0: 2.7638e+00,  elapsed time 295
INFO   step:   140,    loss: 1.0154e+02,   Y0: 2.7630e+00,  elapsed time 297
INFO   step:   141,    loss: 1.0153e+02,   Y0: 2.7630e+00,  elapsed time 298
INFO   step:   142,    loss: 1.0152e+02,   Y0: 2.7632e+00,  elapsed time 300
INFO   step:   143,    loss: 1.0150e+02,   Y0: 2.7634e+00,  elapsed time 302
INFO   step:   144,    loss: 1.0149e+02,   Y0: 2.7631e+00,  elapsed time 304
INFO   step:   145,    loss: 1.0149e+02,   Y0: 2.7638e+00,  elapsed time 305
INFO   step:   146,    loss: 1.0148e+02,   Y0: 2.7644e+00,  elapsed time 307
INFO   step:   147,    loss: 1.0147e+02,   Y0: 2.7647e+00,  elapsed time 309
INFO   step:   148,    loss: 1.0147e+02,   Y0: 2.7656e+00,  elapsed time 311
INFO   step:   149,    loss: 1.0146e+02,   Y0: 2.7663e+00,  elapsed time 312
Delta:  160 ,  160.05
Other:  -50 ,  -50
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 2) dtype=float64>]
num_iterations:  150
total time intervals:  40
# of dimensions:  2
Loss out:  105.55301467516195
Output_Z_Vals:  [[[ 1.59287344e+02 -4.92708515e+01]
  [ 1.59287344e+02 -4.92708515e+01]
  [ 1.59287344e+02 -4.92708515e+01]
  ...
  [ 1.59287344e+02 -4.92708515e+01]
  [ 1.59287344e+02 -4.92708515e+01]
  [ 1.59287344e+02 -4.92708515e+01]]

 [[ 1.26117856e+00  3.14028418e-01]
  [ 1.35421803e+00  3.35062780e-01]
  [ 1.24628367e+00  3.10660982e-01]
  ...
  [ 1.34748680e+00  3.33540982e-01]
  [ 1.09553090e+00  2.76578802e-01]
  [ 1.42102076e+00  3.57685003e-01]]

 [[ 3.34960136e-01  1.12227792e-01]
  [-2.52422124e-01 -9.64226320e-02]
  [ 8.88572599e-01  8.82433674e-02]
  ...
  [ 1.25520346e-01  6.71679310e-02]
  [ 2.91321682e-01  1.07809051e-01]
  [ 1.45238534e+00  3.54314286e-02]]

 ...

 [[-5.02869642e-02  8.22928665e-02]
  [-2.49138852e-02 -2.00617287e-01]
  [-5.28667324e-02  1.23398744e-01]
  ...
  [-2.80858485e-02 -1.71905340e-01]
  [-8.84221464e-02  6.93493555e-01]
  [-2.89152992e-02 -1.64520851e-01]]

 [[-1.19507571e-01 -6.42393101e-02]
  [ 1.54197902e-02 -3.23282388e-02]
  [-2.43209850e-01 -9.73384046e-02]
  ...
  [ 1.96891857e-02 -2.76090784e-02]
  [-4.14338103e-01 -1.49963696e-01]
  [-8.10958964e-02 -5.42092905e-02]]

 [[ 1.18053901e-01 -1.28638407e-01]
  [-4.42612457e-02 -3.79710667e-02]
  [ 1.29083459e-01 -5.47138367e-02]
  ...
  [-4.56896040e-02 -7.91633290e-02]
  [-7.76039334e-01  1.84525457e-01]
  [ 1.12594206e-01 -1.25068878e-01]]]
Z_Vals dimensionality:  (40, 200, 2)
X_test:  [[[1.00000000e+02 1.00288960e+02 1.00249553e+02 ... 9.79352427e+01
   9.84643056e+01 1.00772470e+02]
  [4.00000000e-02 4.06226620e-02 3.94806843e-02 ... 4.25907717e-02
   4.35486509e-02 4.10879818e-02]]

 [[1.00000000e+02 9.98788347e+01 1.01752866e+02 ... 1.01328297e+02
   1.02539171e+02 1.01938320e+02]
  [4.00000000e-02 3.90902793e-02 3.77410867e-02 ... 3.77751213e-02
   3.65263858e-02 3.80439608e-02]]

 [[1.00000000e+02 1.00350685e+02 9.89564316e+01 ... 9.61770952e+01
   9.60401395e+01 9.70895117e+01]
  [4.00000000e-02 3.97435007e-02 3.95271298e-02 ... 4.63652023e-02
   4.70325397e-02 4.60510277e-02]]

 ...

 [[1.00000000e+02 9.99065223e+01 1.00753912e+02 ... 1.01082268e+02
   1.01181701e+02 1.02127902e+02]
  [4.00000000e-02 3.86338039e-02 3.79896836e-02 ... 3.64072038e-02
   3.46369728e-02 3.45083011e-02]]

 [[1.00000000e+02 1.01006157e+02 1.00383218e+02 ... 8.81387866e+01
   8.63036125e+01 8.70638800e+01]
  [4.00000000e-02 3.96369357e-02 3.96128102e-02 ... 4.83460847e-02
   4.95430760e-02 4.75653580e-02]]

 [[1.00000000e+02 9.82481170e+01 9.72104589e+01 ... 9.84875776e+01
   9.75766963e+01 9.77180628e+01]
  [4.00000000e-02 4.06038375e-02 4.11343868e-02 ... 4.43785487e-02
   4.54673774e-02 4.44275977e-02]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.26117856e+00  3.14028418e-01]
 [ 3.34960136e-01  1.12227792e-01]
 [-4.46411981e-03 -5.86176220e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.17614289e-01 -3.65933305e-01]
 [-4.15273692e-01  2.60505923e-01]
 [ 2.27114459e-01 -2.49090174e-01]
 [-3.00412651e-02  3.82001930e-01]
 [-1.18021384e-01 -9.77241956e-02]
 [-1.41730041e-01 -4.06892240e-01]
 [-7.00705965e-02 -1.25372977e-02]
 [-3.87664510e-02 -1.33774995e-01]
 [-8.40949382e-02 -2.19474111e-02]
 [-4.37900682e-02 -3.72635623e-02]
 [ 3.87400761e-01  2.41738576e-01]
 [ 1.30020392e-01 -9.56140020e-02]
 [ 3.87915055e-02  2.75032451e-02]
 [ 8.89753757e-03 -8.66549145e-02]
 [-1.13959225e-01 -4.69287644e-01]
 [-7.56044299e-02 -3.97944782e-02]
 [ 1.51490360e-01 -3.55141249e-03]
 [ 1.30608880e+00  1.36725021e-01]
 [ 1.60066342e-02  4.11902365e-01]
 [-1.36129008e-01  1.23742325e-01]
 [-1.65942926e-01  1.76026435e-01]
 [ 1.76244918e-01 -8.66801181e-02]
 [-1.13162989e-01 -4.49795154e-01]
 [ 6.25614895e-02  6.90647906e-02]
 [ 3.63495565e-01 -1.47873413e-01]
 [-5.26183124e-01 -2.05766904e-01]
 [-6.55949547e-04  2.89538754e-03]
 [-5.13207974e-02  4.16016569e-02]
 [ 2.49773216e-01  2.08266926e-01]
 [ 2.49202067e-02 -1.02598307e-02]
 [ 2.38257209e-01 -1.76592255e-01]
 [ 7.64198158e-02  9.35184730e-02]
 [-5.02869642e-02  8.22928665e-02]
 [-1.19507571e-01 -6.42393101e-02]
 [ 1.18053901e-01 -1.28638407e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.67223894]
curr_Stock_Price:  100.28895951603889
curr_Factors:  [1.0028896e+02 4.0622662e-02]
mat_Sqrt:  [[ 2.02133044e+01  0.00000000e+00]
 [-8.06202575e-03  1.84724216e-02]]
grads:  [ 0.06917384 16.99985113]
Stock Position:  0.06917383559530506
Bond Position:  [-2.26513306]


portfolio before change:  [4.66922991]
curr_Stock_Price:  100.24955332706693
curr_Factors:  [1.00249553e+02 3.94806843e-02]
mat_Sqrt:  [[ 1.99193325e+01  0.00000000e+00]
 [-7.94789877e-03  1.82109239e-02]]
grads:  [0.01927476 6.16266329]
Stock Position:  0.01927476028149825
Bond Position:  [2.7369438]


portfolio before change:  [4.68416924]
curr_Stock_Price:  101.00687508905791
curr_Factors:  [1.01006875e+02 3.88811890e-02]
mat_Sqrt:  [[ 1.99168523e+01  0.00000000e+00]
 [-7.88732542e-03  1.80721329e-02]]
grads:  [-1.50861928e-03 -3.24353646e+00]
Stock Position:  -0.001508619278141993
Bond Position:  [4.83655016]


portfolio before change:  [4.6850102]
curr_Stock_Price:  100.85020779031376
curr_Factors:  [1.00850208e+02 4.16985707e-02]
mat_Sqrt:  [[ 2.05938422e+01  0.00000000e+00]
 [-8.16809115e-03  1.87154480e-02]]
grads:  [-7.91565108e-04 -8.08886929e+00]
Stock Position:  -0.0007915651077462683
Bond Position:  [4.7648397]


portfolio before change:  [4.68468758]
curr_Stock_Price:  102.01026548975409
curr_Factors:  [1.02010265e+02 4.15762716e-02]
mat_Sqrt:  [[ 2.08001587e+01  0.00000000e+00]
 [-8.15610412e-03  1.86879823e-02]]
grads:  [-1.33326231e-02 -1.95812100e+01]
Stock Position:  -0.013332623126651214
Bond Position:  [6.044752]


portfolio before change:  [4.66943154]
curr_Stock_Price:  103.2112053208208
curr_Factors:  [1.03211205e+02 4.17664726e-02]
mat_Sqrt:  [[ 2.10931164e+01  0.00000000e+00]
 [-8.17473890e-03  1.87306799e-02]]
grads:  [-0.01429754 13.90798008]
Stock Position:  -0.014297535771174931
Bond Position:  [6.14509744]


portfolio before change:  [4.68411361]
curr_Stock_Price:  102.23803887817145
curr_Factors:  [1.02238039e+02 4.27351212e-02]
mat_Sqrt:  [[ 2.11351328e+01  0.00000000e+00]
 [-8.26898990e-03  1.89466361e-02]]
grads:  [ 5.60216943e-03 -1.31469340e+01]
Stock Position:  0.005602169428261295
Bond Position:  [4.11135879]


portfolio before change:  [4.67922874]
curr_Stock_Price:  101.27433751997548
curr_Factors:  [1.01274338e+02 4.24798168e-02]
mat_Sqrt:  [[ 2.08732814e+01  0.00000000e+00]
 [-8.24425296e-03  1.88899566e-02]]
grads:  [6.54799035e-03 2.02224885e+01]
Stock Position:  0.0065479903483581445
Bond Position:  [4.01608536]


portfolio before change:  [4.68349739]
curr_Stock_Price:  101.84956754897084
curr_Factors:  [1.01849568e+02 4.03889586e-02]
mat_Sqrt:  [[ 2.04687121e+01  0.00000000e+00]
 [-8.03880176e-03  1.84192088e-02]]
grads:  [-0.00784963 -5.30555882]
Stock Position:  -0.007849625282637716
Bond Position:  [5.48297833]


portfolio before change:  [4.68067217]
curr_Stock_Price:  102.2968031501979
curr_Factors:  [1.02296803e+02 4.12353304e-02]
mat_Sqrt:  [[ 2.07728843e+01  0.00000000e+00]
 [-8.12259372e-03  1.86112003e-02]]
grads:  [-1.53715955e-02 -2.18627619e+01]
Stock Position:  -0.015371595453546539
Bond Position:  [6.25313724]


portfolio before change:  [4.67179316]
curr_Stock_Price:  102.9252808003897
curr_Factors:  [1.02925281e+02 3.96561788e-02]
mat_Sqrt:  [[ 2.04963955e+01  0.00000000e+00]
 [-7.96554367e-03  1.82513534e-02]]
grads:  [-0.00368564 -0.68692428]
Stock Position:  -0.0036856393567767224
Bond Position:  [5.05113862]


portfolio before change:  [4.6741931]
curr_Stock_Price:  102.44544308759932
curr_Factors:  [1.02445443e+02 3.93902938e-02]
mat_Sqrt:  [[ 2.03323349e+01  0.00000000e+00]
 [-7.93879525e-03  1.81900651e-02]]
grads:  [-4.77813521e-03 -7.35428897e+00]
Stock Position:  -0.004778135207736419
Bond Position:  [5.16369127]


portfolio before change:  [4.68232076]
curr_Stock_Price:  100.8795261807917
curr_Factors:  [1.00879526e+02 3.92943033e-02]
mat_Sqrt:  [[ 1.99971374e+01  0.00000000e+00]
 [-7.92911630e-03  1.81678878e-02]]
grads:  [-0.00468435 -1.20803317]
Stock Position:  -0.004684349159337402
Bond Position:  [5.15487568]


portfolio before change:  [4.68594237]
curr_Stock_Price:  100.24396062826068
curr_Factors:  [1.00243961e+02 3.88762901e-02]
mat_Sqrt:  [[ 1.97651732e+01  0.00000000e+00]
 [-7.88682852e-03  1.80709943e-02]]
grads:  [-0.00303834 -2.06206485]
Stock Position:  -0.003038335130088704
Bond Position:  [4.99051712]


portfolio before change:  [4.68468595]
curr_Stock_Price:  100.86281224986746
curr_Factors:  [1.00862812e+02 3.93319118e-02]
mat_Sqrt:  [[ 2.00033899e+01  0.00000000e+00]
 [-7.93290986e-03  1.81765800e-02]]
grads:  [ 0.02464103 13.29945328]
Stock Position:  0.024641029688338846
Bond Position:  [2.1993224]


portfolio before change:  [4.63979401]
curr_Stock_Price:  99.02981797678322
curr_Factors:  [9.9029818e+01 3.9501670e-02]
mat_Sqrt:  [[ 1.96822031e+01  0.00000000e+00]
 [-7.95001082e-03  1.82157632e-02]]
grads:  [ 4.48583018e-03 -5.24897042e+00]
Stock Position:  0.0044858301843690605
Bond Position:  [4.19556307]


portfolio before change:  [4.6471376]
curr_Stock_Price:  100.54996223808341
curr_Factors:  [1.00549962e+02 3.86619699e-02]
mat_Sqrt:  [[ 1.97707844e+01  0.00000000e+00]
 [-7.86505892e-03  1.80211139e-02]]
grads:  [0.00256919 1.52616787]
Stock Position:  0.002569190206945615
Bond Position:  [4.38880562]


portfolio before change:  [4.64649689]
curr_Stock_Price:  100.08703578738438
curr_Factors:  [1.00087036e+02 3.79916500e-02]
mat_Sqrt:  [[ 1.95084114e+01  0.00000000e+00]
 [-7.79657874e-03  1.78642061e-02]]
grads:  [-1.48252808e-03 -4.85075654e+00]
Stock Position:  -0.0014825280816067286
Bond Position:  [4.79487873]


portfolio before change:  [4.64621054]
curr_Stock_Price:  100.68449395515859
curr_Factors:  [1.00684494e+02 3.71277410e-02]
mat_Sqrt:  [[ 1.94004523e+01  0.00000000e+00]
 [-7.70742405e-03  1.76599271e-02]]
grads:  [-1.64312223e-02 -2.65735890e+01]
Stock Position:  -0.016431222333539858
Bond Position:  [6.30057984]


portfolio before change:  [4.66411768]
curr_Stock_Price:  99.64260444348473
curr_Factors:  [9.96426044e+01 3.78784209e-02]
mat_Sqrt:  [[ 1.93928216e+01  0.00000000e+00]
 [-7.78495173e-03  1.78375653e-02]]
grads:  [-0.00479415 -2.23093665]
Stock Position:  -0.004794153516769698
Bond Position:  [5.14181962]


portfolio before change:  [4.67410612]
curr_Stock_Price:  97.6932145771511
curr_Factors:  [9.76932146e+01 3.78293564e-02]
mat_Sqrt:  [[ 1.90011058e+01  0.00000000e+00]
 [-7.77990812e-03  1.78260089e-02]]
grads:  [ 0.00789114 -0.19922645]
Stock Position:  0.007891140548304067
Bond Position:  [3.90319523]


portfolio before change:  [4.66605659]
curr_Stock_Price:  96.61131050785858
curr_Factors:  [9.66113105e+01 3.82817824e-02]
mat_Sqrt:  [[ 1.89027090e+01  0.00000000e+00]
 [-7.82629234e-03  1.79322885e-02]]
grads:  [0.0722521  7.62451599]
Stock Position:  0.07225210367226606
Bond Position:  [-2.31431383]


portfolio before change:  [4.60436134]
curr_Stock_Price:  95.76142595572978
curr_Factors:  [9.57614260e+01 3.93224179e-02]
mat_Sqrt:  [[ 1.89893768e+01  0.00000000e+00]
 [-7.93195238e-03  1.81743861e-02]]
grads:  [1.03097414e-02 2.26638943e+01]
Stock Position:  0.010309741425466886
Bond Position:  [3.6170858]


portfolio before change:  [4.60854763]
curr_Stock_Price:  96.12362046737762
curr_Factors:  [9.61236205e+01 3.87529249e-02]
mat_Sqrt:  [[ 1.89226677e+01  0.00000000e+00]
 [-7.87430504e-03  1.80422994e-02]]
grads:  [-4.33994987e-03  6.85845646e+00]
Stock Position:  -0.004339949869103011
Bond Position:  [5.02571933]


portfolio before change:  [4.60767364]
curr_Stock_Price:  96.46976537962792
curr_Factors:  [9.64697654e+01 3.90447056e-02]
mat_Sqrt:  [[ 1.90621683e+01  0.00000000e+00]
 [-7.90389328e-03  1.81100946e-02]]
grads:  [-4.67516027e-03  9.71979652e+00]
Stock Position:  -0.00467516026907538
Bond Position:  [5.05868525]


portfolio before change:  [4.61031391]
curr_Stock_Price:  96.04028369935948
curr_Factors:  [9.60402837e+01 3.96871229e-02]
mat_Sqrt:  [[ 1.91327872e+01  0.00000000e+00]
 [-7.96865087e-03  1.82584729e-02]]
grads:  [ 0.00723442 -4.74739145]
Stock Position:  0.007234419684400029
Bond Position:  [3.91551819]


portfolio before change:  [4.61210786]
curr_Stock_Price:  96.22059964111381
curr_Factors:  [9.62205996e+01 4.34921897e-02]
mat_Sqrt:  [[ 2.00665955e+01  0.00000000e+00]
 [-8.34191246e-03  1.91137226e-02]]
grads:  [-1.54221322e-02 -2.35325772e+01]
Stock Position:  -0.015422132197173465
Bond Position:  [6.09603467]


portfolio before change:  [4.60021265]
curr_Stock_Price:  97.04132048081185
curr_Factors:  [9.70413205e+01 4.15297436e-02]
mat_Sqrt:  [[ 1.97759030e+01  0.00000000e+00]
 [-8.15153910e-03  1.86775225e-02]]
grads:  [0.00468772 3.69774903]
Stock Position:  0.0046877169369181956
Bond Position:  [4.1453104]


portfolio before change:  [4.59718541]
curr_Stock_Price:  96.28499656364124
curr_Factors:  [9.62849966e+01 4.19113084e-02]
mat_Sqrt:  [[ 1.97117067e+01  0.00000000e+00]
 [-8.18890062e-03  1.87631285e-02]]
grads:  [ 0.01516654 -7.88106382]
Stock Position:  0.015166536374554954
Bond Position:  [3.13687551]


portfolio before change:  [4.59876564]
curr_Stock_Price:  96.36333322664036
curr_Factors:  [9.63633332e+01 4.27314153e-02]
mat_Sqrt:  [[ 1.99198220e+01  0.00000000e+00]
 [-8.26863136e-03  1.89458145e-02]]
grads:  [ -0.03092333 -10.86081064]
Stock Position:  -0.03092332672584376
Bond Position:  [7.57864048]


portfolio before change:  [4.61056431]
curr_Stock_Price:  96.01242391399418
curr_Factors:  [9.60124239e+01 4.41242444e-02]
mat_Sqrt:  [[ 2.01681505e+01  0.00000000e+00]
 [-8.40230867e-03  1.92521077e-02]]
grads:  [3.01317255e-05 1.50393275e-01]
Stock Position:  3.013172546872519e-05
Bond Position:  [4.60767129]


portfolio before change:  [4.61114955]
curr_Stock_Price:  96.31906811264157
curr_Factors:  [9.63190681e+01 4.33942872e-02]
mat_Sqrt:  [[ 2.00645097e+01  0.00000000e+00]
 [-8.33251820e-03  1.90921977e-02]]
grads:  [-1.65288593e-03  2.17898733e+00]
Stock Position:  -0.0016528859311035595
Bond Position:  [4.77035398]


portfolio before change:  [4.61278222]
curr_Stock_Price:  95.69207715717829
curr_Factors:  [9.56920772e+01 4.27421669e-02]
mat_Sqrt:  [[ 1.97835511e+01  0.00000000e+00]
 [-8.26967152e-03  1.89481979e-02]]
grads:  [ 0.01721978 10.99138436]
Stock Position:  0.017219777753599893
Bond Position:  [2.96498592]


portfolio before change:  [4.61839447]
curr_Stock_Price:  95.9964714232817
curr_Factors:  [9.59964714e+01 4.38861135e-02]
mat_Sqrt:  [[ 2.01103130e+01  0.00000000e+00]
 [-8.37960510e-03  1.92000873e-02]]
grads:  [ 0.00101652 -0.53436375]
Stock Position:  0.001016515726250539
Bond Position:  [4.52081255]


portfolio before change:  [4.6177362]
curr_Stock_Price:  94.79294063539311
curr_Factors:  [9.47929406e+01 4.52035534e-02]
mat_Sqrt:  [[ 2.01540478e+01  0.00000000e+00]
 [-8.50445092e-03  1.94861450e-02]]
grads:  [ 7.99770011e-03 -9.06245206e+00]
Stock Position:  0.007997700110432259
Bond Position:  [3.85961069]


portfolio before change:  [4.61787323]
curr_Stock_Price:  94.74974686023631
curr_Factors:  [9.47497469e+01 4.34385909e-02]
mat_Sqrt:  [[ 1.97476728e+01  0.00000000e+00]
 [-8.33677068e-03  1.91019414e-02]]
grads:  [0.00593663 4.89575752]
Stock Position:  0.005936629838143407
Bond Position:  [4.05537906]


portfolio before change:  [4.62386022]
curr_Stock_Price:  95.67283480364458
curr_Factors:  [9.56728348e+01 4.35701149e-02]
mat_Sqrt:  [[ 1.99702267e+01  0.00000000e+00]
 [-8.34938224e-03  1.91308381e-02]]
grads:  [-7.19641946e-04  4.30158189e+00]
Stock Position:  -0.0007196419460255543
Bond Position:  [4.6927104]


portfolio before change:  [4.62281872]
curr_Stock_Price:  97.9352427333094
curr_Factors:  [9.79352427e+01 4.25907717e-02]
mat_Sqrt:  [[ 2.02114168e+01  0.00000000e+00]
 [-8.25501270e-03  1.89146103e-02]]
grads:  [-0.00730003 -3.39627987]
Stock Position:  -0.007300027809952513
Bond Position:  [5.33774871]


portfolio before change:  [4.6196238]
curr_Stock_Price:  98.46430561755058
curr_Factors:  [9.84643056e+01 4.35486509e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.6196238]
Stock Price:  100.77246957392673
PL:  [3.84715423]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.35421803e+00  3.35062780e-01]
 [-2.52422124e-01 -9.64226320e-02]
 [ 5.57424011e-02 -4.03021678e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.75579464e-02 -5.33974424e-02]
 [-3.02415579e-02 -1.14294728e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 7.37777384e-01  7.21439102e-01]
 [-5.77131991e-02  1.50607650e-01]
 [ 1.79046292e-01  4.53238843e-02]
 [-7.18697602e-02 -1.24761995e-02]
 [-5.24210734e-02 -1.36338940e-01]
 [-8.14695049e-02 -2.15105688e-02]
 [-3.94217733e-02 -4.04792752e-02]
 [ 4.18241415e-01  2.64354923e-01]
 [ 1.34068316e-01 -3.54182898e-01]
 [ 3.29383238e-02 -1.07487934e-01]
 [ 3.18205705e-02 -1.53297873e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.39974564e-01 -2.81572333e-02]
 [ 4.17061083e-01 -3.31598845e-01]
 [ 2.87230259e-02 -3.72900967e-01]
 [ 3.25298660e-02  5.52061024e-02]
 [ 4.23133692e-01 -3.49532646e-01]
 [-1.36154410e-01 -9.01182525e-03]
 [-1.56708619e-01  9.46345949e-02]
 [-5.06334698e-02  6.13076908e-02]
 [-6.19075589e-02  2.05073344e-01]
 [-7.40325407e-01 -1.80432875e-02]
 [-1.49774276e-01 -2.42611258e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.64930143e-01  6.72556337e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.91117423e-01  3.38359012e-02]
 [-2.49138852e-02 -2.00617287e-01]
 [ 1.54197902e-02 -3.23282388e-02]
 [-4.42612457e-02 -3.79710667e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.84681167]
curr_Stock_Price:  99.87883471828042
curr_Factors:  [9.98788347e+01 3.90902793e-02]
mat_Sqrt:  [[ 1.97473059e+01  0.00000000e+00]
 [-7.90850472e-03  1.81206607e-02]]
grads:  [ 0.07598259 18.49064913]
Stock Position:  0.07598258865070921
Bond Position:  [-5.74224075]


portfolio before change:  [1.98848756]
curr_Stock_Price:  101.75286568066338
curr_Factors:  [1.01752866e+02 3.77410867e-02]
mat_Sqrt:  [[ 1.97675957e+01  0.00000000e+00]
 [-7.77082613e-03  1.78051995e-02]]
grads:  [-0.01489834 -5.41541992]
Stock Position:  -0.014898342465361775
Bond Position:  [3.5044366]


portfolio before change:  [2.00422424]
curr_Stock_Price:  100.72600035488465
curr_Factors:  [1.00726000e+02 3.64959727e-02]
mat_Sqrt:  [[ 1.92426137e+01  0.00000000e+00]
 [-7.64156766e-03  1.75090311e-02]]
grads:  [ 1.98273965e-03 -2.30179314e+00]
Stock Position:  0.0019827396453119474
Bond Position:  [1.8045108]


portfolio before change:  [2.00418345]
curr_Stock_Price:  100.59165596871398
curr_Factors:  [1.00591656e+02 3.70643116e-02]
mat_Sqrt:  [[ 1.93660000e+01  0.00000000e+00]
 [-7.70083752e-03  1.76448354e-02]]
grads:  [-8.41751884e-04 -8.57966701e+00]
Stock Position:  -0.0008417518838020684
Bond Position:  [2.08885666]


portfolio before change:  [2.00427336]
curr_Stock_Price:  100.79504942817151
curr_Factors:  [1.00795049e+02 3.78057787e-02]
mat_Sqrt:  [[ 1.95982952e+01  0.00000000e+00]
 [-7.77748326e-03  1.78204529e-02]]
grads:  [-0.00616699 -2.99641332]
Stock Position:  -0.006166990512252258
Bond Position:  [2.62587548]


portfolio before change:  [2.01914098]
curr_Stock_Price:  98.4374382353221
curr_Factors:  [9.84374382e+01 3.97334180e-02]
mat_Sqrt:  [[ 1.96217739e+01  0.00000000e+00]
 [-7.97329724e-03  1.82691191e-02]]
grads:  [-4.08341606e-03 -6.25617071e+00]
Stock Position:  -0.004083416060224765
Bond Position:  [2.421102]


portfolio before change:  [2.02090912]
curr_Stock_Price:  98.07855340069594
curr_Factors:  [9.80785534e+01 3.92980937e-02]
mat_Sqrt:  [[ 1.94428441e+01  0.00000000e+00]
 [-7.92949872e-03  1.81687640e-02]]
grads:  [0.00665406 5.29132785]
Stock Position:  0.006654056202062211
Bond Position:  [1.36828891]


portfolio before change:  [2.02463916]
curr_Stock_Price:  98.61341463944264
curr_Factors:  [9.86134146e+01 3.96640103e-02]
mat_Sqrt:  [[ 1.96396755e+01  0.00000000e+00]
 [-7.96633018e-03  1.82531555e-02]]
grads:  [ 0.05359759 39.52407574]
Stock Position:  0.0535975871758695
Bond Position:  [-3.26080193]


portfolio before change:  [2.07155711]
curr_Stock_Price:  99.49639424346189
curr_Factors:  [9.94963942e+01 3.85345572e-02]
mat_Sqrt:  [[ 1.95313620e+01  0.00000000e+00]
 [-7.85208835e-03  1.79913946e-02]]
grads:  [4.10486906e-04 8.37109372e+00]
Stock Position:  0.00041048690588733845
Bond Position:  [2.03071514]


portfolio before change:  [2.0721788]
curr_Stock_Price:  100.39248889285861
curr_Factors:  [1.00392489e+02 3.88630466e-02]
mat_Sqrt:  [[ 1.97910868e+01  0.00000000e+00]
 [-7.88548506e-03  1.80679161e-02]]
grads:  [0.0100463 2.5085286]
Stock Position:  0.010046303103146048
Bond Position:  [1.06360543]


portfolio before change:  [2.0812911]
curr_Stock_Price:  101.28628436317291
curr_Factors:  [1.01286284e+02 3.90528323e-02]
mat_Sqrt:  [[ 2.00159823e+01  0.00000000e+00]
 [-7.90471579e-03  1.81119792e-02]]
grads:  [-0.00386265 -0.68883689]
Stock Position:  -0.0038626543023947807
Bond Position:  [2.472525]


portfolio before change:  [2.07618752]
curr_Stock_Price:  102.68756622330388
curr_Factors:  [1.02687566e+02 3.87759077e-02]
mat_Sqrt:  [[ 2.02208239e+01  0.00000000e+00]
 [-7.87663966e-03  1.80476487e-02]]
grads:  [-5.53509913e-03 -7.55438792e+00]
Stock Position:  -0.005535099131047992
Bond Position:  [2.64457338]


portfolio before change:  [2.08616355]
curr_Stock_Price:  100.94497019605691
curr_Factors:  [1.0094497e+02 3.8346177e-02]
mat_Sqrt:  [[ 1.97672257e+01  0.00000000e+00]
 [-7.83287196e-03  1.79473643e-02]]
grads:  [-0.00459637 -1.19853637]
Stock Position:  -0.004596370193595577
Bond Position:  [2.550144]


portfolio before change:  [2.08666518]
curr_Stock_Price:  100.90519187470947
curr_Factors:  [1.00905192e+02 3.87222655e-02]
mat_Sqrt:  [[ 1.98560973e+01  0.00000000e+00]
 [-7.87118954e-03  1.80351609e-02]]
grads:  [-0.00287511 -2.24446432]
Stock Position:  -0.0028751056433397554
Bond Position:  [2.37677826]


portfolio before change:  [2.0882611]
curr_Stock_Price:  100.4534490596914
curr_Factors:  [1.00453449e+02 3.92817884e-02]
mat_Sqrt:  [[ 1.99095057e+01  0.00000000e+00]
 [-7.92785352e-03  1.81649944e-02]]
grads:  [ 0.02680204 14.55298674]
Stock Position:  0.026802039660272798
Bond Position:  [-0.60409623]


portfolio before change:  [2.09977127]
curr_Stock_Price:  100.88571793386761
curr_Factors:  [1.00885718e+02 3.79134215e-02]
mat_Sqrt:  [[ 1.96438305e+01  0.00000000e+00]
 [-7.78854764e-03  1.78458046e-02]]
grads:  [-1.04408217e-03 -1.98468440e+01]
Stock Position:  -0.0010440821693514792
Bond Position:  [2.20510425]


portfolio before change:  [2.09895962]
curr_Stock_Price:  101.92711318226318
curr_Factors:  [1.01927113e+02 3.77476713e-02]
mat_Sqrt:  [[ 1.98031741e+01  0.00000000e+00]
 [-7.77150398e-03  1.78067526e-02]]
grads:  [-7.05606913e-04 -6.03635802e+00]
Stock Position:  -0.0007056069131047009
Bond Position:  [2.1708801]


portfolio before change:  [2.09878819]
curr_Stock_Price:  102.55467263799974
curr_Factors:  [1.02554673e+02 3.73960140e-02]
mat_Sqrt:  [[ 1.98320729e+01  0.00000000e+00]
 [-7.73521960e-03  1.77236147e-02]]
grads:  [-1.76905898e-03 -8.64935716e+00]
Stock Position:  -0.001769058976884982
Bond Position:  [2.28021345]


portfolio before change:  [2.09856449]
curr_Stock_Price:  102.84225300388383
curr_Factors:  [1.02842253e+02 3.65337045e-02]
mat_Sqrt:  [[ 1.96570543e+01  0.00000000e+00]
 [-7.64551681e-03  1.75180798e-02]]
grads:  [-1.62167301e-02 -2.67887606e+01]
Stock Position:  -0.01621673008090144
Bond Position:  [3.76632955]


portfolio before change:  [2.09811372]
curr_Stock_Price:  102.89908260557063
curr_Factors:  [1.02899083e+02 3.48081033e-02]
mat_Sqrt:  [[ 1.91978097e+01  0.00000000e+00]
 [-7.46277196e-03  1.70993587e-02]]
grads:  [-2.52430203e-04 -6.37996964e+00]
Stock Position:  -0.00025243020341474094
Bond Position:  [2.12408855]


portfolio before change:  [2.09820456]
curr_Stock_Price:  103.59109872437081
curr_Factors:  [1.03591099e+02 3.56528291e-02]
mat_Sqrt:  [[ 1.95600265e+01  0.00000000e+00]
 [-7.55278270e-03  1.73055992e-02]]
grads:  [ 0.00652789 -1.62705914]
Stock Position:  0.006527891963431718
Bond Position:  [1.42197306]


portfolio before change:  [2.09747974]
curr_Stock_Price:  103.45283342069895
curr_Factors:  [1.03452833e+02 3.58844564e-02]
mat_Sqrt:  [[ 1.95972700e+01  0.00000000e+00]
 [-7.57727723e-03  1.73617232e-02]]
grads:  [ 1.38968072e-02 -1.90994201e+01]
Stock Position:  0.01389680720107602
Bond Position:  [0.65981566]


portfolio before change:  [2.09729363]
curr_Stock_Price:  103.43350602319505
curr_Factors:  [1.03433506e+02 3.50430712e-02]
mat_Sqrt:  [[ 1.93625399e+01  0.00000000e+00]
 [-7.48791786e-03  1.71569752e-02]]
grads:  [-6.92183460e-03 -2.17346568e+01]
Stock Position:  -0.006921834601867188
Bond Position:  [2.81324325]


portfolio before change:  [2.08854357]
curr_Stock_Price:  104.74843719156715
curr_Factors:  [1.04748437e+02 3.41599444e-02]
mat_Sqrt:  [[ 1.93600346e+01  0.00000000e+00]
 [-7.39296361e-03  1.69394077e-02]]
grads:  [2.92477702e-03 3.25903381e+00]
Stock Position:  0.0029247770222797756
Bond Position:  [1.78217775]


portfolio before change:  [2.08529305]
curr_Stock_Price:  103.56089222620376
curr_Factors:  [1.03560892e+02 3.39496269e-02]
mat_Sqrt:  [[ 1.90815340e+01  0.00000000e+00]
 [-7.37016981e-03  1.68871805e-02]]
grads:  [ 1.41804710e-02 -2.06981056e+01]
Stock Position:  0.014180470972439994
Bond Position:  [0.61675083]


portfolio before change:  [2.08260971]
curr_Stock_Price:  103.36622725937913
curr_Factors:  [1.03366227e+02 3.44586558e-02]
mat_Sqrt:  [[ 1.91879170e+01  0.00000000e+00]
 [-7.42521713e-03  1.70133098e-02]]
grads:  [-0.00730082 -0.52969266]
Stock Position:  -0.007300818180409049
Bond Position:  [2.83726774]


portfolio before change:  [2.08222095]
curr_Stock_Price:  103.46805727437425
curr_Factors:  [1.03468057e+02 3.47038713e-02]
mat_Sqrt:  [[ 1.92750386e+01  0.00000000e+00]
 [-7.45159003e-03  1.70737377e-02]]
grads:  [-0.00598737  5.54269936]
Stock Position:  -0.005987365200276371
Bond Position:  [2.70172199]


portfolio before change:  [2.07819962]
curr_Stock_Price:  104.19610185344025
curr_Factors:  [1.04196102e+02 3.43145792e-02]
mat_Sqrt:  [[ 1.93014889e+01  0.00000000e+00]
 [-7.40967791e-03  1.69777050e-02]]
grads:  [-1.23703410e-03  3.61107058e+00]
Stock Position:  -0.0012370341029996183
Bond Position:  [2.20709375]


portfolio before change:  [2.07840728]
curr_Stock_Price:  104.25126474857029
curr_Factors:  [1.04251265e+02 3.37099739e-02]
mat_Sqrt:  [[ 1.91408200e+01  0.00000000e+00]
 [-7.34411044e-03  1.68274710e-02]]
grads:  [1.44161985e-03 1.21868191e+01]
Stock Position:  0.0014416198504515645
Bond Position:  [1.92811659]


portfolio before change:  [2.07885008]
curr_Stock_Price:  104.39122495135443
curr_Factors:  [1.04391225e+02 3.36564454e-02]
mat_Sqrt:  [[ 1.91512937e+01  0.00000000e+00]
 [-7.33827722e-03  1.68141054e-02]]
grads:  [-0.03906786 -1.07310422]
Stock Position:  -0.039067864254232594
Bond Position:  [6.15719229]


portfolio before change:  [2.08042614]
curr_Stock_Price:  104.37058502170424
curr_Factors:  [1.04370585e+02 3.37554124e-02]
mat_Sqrt:  [[ 1.91756382e+01  0.00000000e+00]
 [-7.34905844e-03  1.68388083e-02]]
grads:  [-0.00836284 -1.44078639]
Stock Position:  -0.008362835053956073
Bond Position:  [2.95326012]


portfolio before change:  [2.07972491]
curr_Stock_Price:  104.49858129600409
curr_Factors:  [1.04498581e+02 3.47010972e-02]
mat_Sqrt:  [[ 1.94662366e+01  0.00000000e+00]
 [-7.45129220e-03  1.70730553e-02]]
grads:  [ 0.00372659 -0.69976867]
Stock Position:  0.0037265855884670686
Bond Position:  [1.690302]


portfolio before change:  [2.07579229]
curr_Stock_Price:  103.38659494127839
curr_Factors:  [1.03386595e+02 3.55477859e-02]
mat_Sqrt:  [[ 1.94926332e+01  0.00000000e+00]
 [-7.54164819e-03  1.72800869e-02]]
grads:  [-0.01208546  3.89208887]
Stock Position:  -0.01208545690746468
Bond Position:  [3.32526653]


portfolio before change:  [2.06782185]
curr_Stock_Price:  104.08049708918948
curr_Factors:  [1.04080497e+02 3.49324220e-02]
mat_Sqrt:  [[ 1.94528710e+01  0.00000000e+00]
 [-7.47608689e-03  1.71298670e-02]]
grads:  [0.00521626 3.1143885 ]
Stock Position:  0.005216256856091572
Bond Position:  [1.52491125]


portfolio before change:  [2.06639843]
curr_Stock_Price:  103.77107033350129
curr_Factors:  [1.03771070e+02 3.57912806e-02]
mat_Sqrt:  [[ 1.96320167e+01  0.00000000e+00]
 [-7.56743345e-03  1.73391683e-02]]
grads:  [-0.0048221   4.69025646]
Stock Position:  -0.004822103209466116
Bond Position:  [2.56679324]


portfolio before change:  [2.0700144]
curr_Stock_Price:  103.08773688895312
curr_Factors:  [1.03087737e+02 3.49715358e-02]
mat_Sqrt:  [[ 1.92781057e+01  0.00000000e+00]
 [-7.48027120e-03  1.71394545e-02]]
grads:  [-0.01433493  1.97415275]
Stock Position:  -0.014334926308230711
Bond Position:  [3.54776952]


portfolio before change:  [2.08025037]
curr_Stock_Price:  102.40461772532149
curr_Factors:  [1.02404618e+02 3.60624226e-02]
mat_Sqrt:  [[ 1.94467481e+01  0.00000000e+00]
 [-7.59604345e-03  1.74047221e-02]]
grads:  [-5.78350923e-03 -1.15266010e+01]
Stock Position:  -0.00578350923291112
Bond Position:  [2.67250842]


portfolio before change:  [2.08680936]
curr_Stock_Price:  101.3282972426197
curr_Factors:  [1.01328297e+02 3.77751213e-02]
mat_Sqrt:  [[ 1.96939884e+01  0.00000000e+00]
 [-7.77432918e-03  1.78132260e-02]]
grads:  [ 6.65477209e-05 -1.81484471e+00]
Stock Position:  6.654772092031749e-05
Bond Position:  [2.08006619]


portfolio before change:  [2.08714996]
curr_Stock_Price:  102.53917059941301
curr_Factors:  [1.02539171e+02 3.65263858e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.08714996]
Stock Price:  101.93832004285726
PL:  [0.14882992]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.24628367e+00  3.10660982e-01]
 [ 8.88572599e-01  8.82433674e-02]
 [-9.44422495e-02  1.30233212e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.18662604e-01  9.84756312e-01]
 [ 1.45940069e-02 -5.12283767e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 7.79140277e-01  7.66380637e-01]
 [-5.86007185e-02  1.47243353e-01]
 [ 1.80766541e-01  4.24888425e-02]
 [-7.81516719e-02 -1.09067990e-02]
 [-3.99019673e-02 -1.33645536e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.71725466e-02 -4.21350396e-02]
 [ 4.11325086e-01  2.59534910e-01]
 [ 1.32458318e-01 -2.62296683e-01]
 [ 3.94805693e-02  8.26712697e-02]
 [ 1.48935789e-02 -1.07440700e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-3.58232163e-02 -6.30840046e-02]
 [ 1.72512595e-01 -4.07666420e-02]
 [ 5.92002160e-01 -1.77107811e-01]
 [ 2.91587551e-02 -3.84378890e-01]
 [ 4.10651006e-02  3.14948209e-02]
 [ 2.46872710e-01 -1.55089194e-01]
 [ 1.58731617e-01 -9.33009266e-02]
 [-1.79051682e-01  2.26525539e-02]
 [ 1.47371122e-02  2.83254697e-01]
 [-3.16612503e-02  1.88653785e-01]
 [-6.08414084e-01 -7.50474621e-02]
 [-1.68607851e-01 -6.38601243e-02]
 [ 9.96013180e-03 -6.16920487e-02]
 [-1.73331139e-02  1.72758734e-01]
 [ 5.00158513e-03  1.27157015e-02]
 [ 1.18707934e-01 -5.42706574e-02]
 [-2.51289404e-02  1.19318748e-01]
 [-5.28667324e-02  1.23398744e-01]
 [-2.43209850e-01 -9.73384046e-02]
 [ 1.29083459e-01 -5.47138367e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.09747471]
curr_Stock_Price:  100.35068459943928
curr_Factors:  [1.00350685e+02 3.97435007e-02]
mat_Sqrt:  [[ 2.00056837e+01  0.00000000e+00]
 [-7.97430881e-03  1.82714369e-02]]
grads:  [ 0.06907373 17.00254796]
Stock Position:  0.0690737319010432
Bond Position:  [-1.83412157]


portfolio before change:  [5.00093918]
curr_Stock_Price:  98.95643161460048
curr_Factors:  [9.89564316e+01 3.95271298e-02]
mat_Sqrt:  [[ 1.96739547e+01  0.00000000e+00]
 [-7.95257240e-03  1.82216325e-02]]
grads:  [0.04712246 4.84278055]
Stock Position:  0.04712246103489321
Bond Position:  [0.33786858]


portfolio before change:  [4.91611599]
curr_Stock_Price:  97.15547673911992
curr_Factors:  [9.71554767e+01 4.13321150e-02]
mat_Sqrt:  [[ 1.97520011e+01  0.00000000e+00]
 [-8.13212051e-03  1.86330289e-02]]
grads:  [-1.90379778e-03  6.98937424e+00]
Stock Position:  -0.0019037977825172583
Bond Position:  [5.10108037]


portfolio before change:  [4.91763201]
curr_Stock_Price:  96.69410919879778
curr_Factors:  [9.66941092e+01 4.22408158e-02]
mat_Sqrt:  [[ 1.98731251e+01  0.00000000e+00]
 [-8.22102824e-03  1.88367421e-02]]
grads:  [-8.20271946e-04 -8.03678320e+00]
Stock Position:  -0.0008202719458050989
Bond Position:  [4.99694748]


portfolio before change:  [4.91792745]
curr_Stock_Price:  97.09546675406888
curr_Factors:  [9.70954668e+01 4.34187018e-02]
mat_Sqrt:  [[ 2.02319327e+01  0.00000000e+00]
 [-8.33486190e-03  1.90975678e-02]]
grads:  [1.53776849e-02 5.15644884e+01]
Stock Position:  0.015377684921235467
Bond Position:  [3.42482395]


portfolio before change:  [4.91927143]
curr_Stock_Price:  97.15502410105417
curr_Factors:  [9.71550241e+01 4.40649071e-02]
mat_Sqrt:  [[ 2.03944357e+01  0.00000000e+00]
 [-8.39665715e-03  1.92391585e-02]]
grads:  [-3.80686664e-04 -2.66271400e+00]
Stock Position:  -0.0003806866636229233
Bond Position:  [4.95625705]


portfolio before change:  [4.91953887]
curr_Stock_Price:  98.08002090999524
curr_Factors:  [9.80800209e+01 4.36396695e-02]
mat_Sqrt:  [[ 2.04890242e+01  0.00000000e+00]
 [-8.35604400e-03  1.91461021e-02]]
grads:  [0.0063143  5.02122504]
Stock Position:  0.0063142966531648075
Bond Position:  [4.30023252]


portfolio before change:  [4.92162304]
curr_Stock_Price:  98.32495811480611
curr_Factors:  [9.83249581e+01 4.45627152e-02]
mat_Sqrt:  [[ 2.07562834e+01  0.00000000e+00]
 [-8.44395312e-03  1.93475272e-02]]
grads:  [ 0.053652  39.6112966]
Stock Position:  0.053652004371029086
Bond Position:  [-0.35370805]


portfolio before change:  [4.98538709]
curr_Stock_Price:  99.5142570134012
curr_Factors:  [9.9514257e+01 4.3727888e-02]
mat_Sqrt:  [[ 2.08096394e+01  0.00000000e+00]
 [-8.36448568e-03  1.91654444e-02]]
grads:  [2.72063780e-04 7.68275183e+00]
Stock Position:  0.000272063780293023
Bond Position:  [4.95831286]


portfolio before change:  [4.98615699]
curr_Stock_Price:  100.06585897772125
curr_Factors:  [1.00065859e+02 4.45848270e-02]
mat_Sqrt:  [[ 2.11290257e+01  0.00000000e+00]
 [-8.44604778e-03  1.93523266e-02]]
grads:  [0.009433   2.19554182]
Stock Position:  0.009433004423879274
Bond Position:  [4.0422353]


portfolio before change:  [4.99590564]
curr_Stock_Price:  101.0457523377166
curr_Factors:  [1.01045752e+02 4.56077693e-02]
mat_Sqrt:  [[ 2.15793062e+01  0.00000000e+00]
 [-8.54239023e-03  1.95730749e-02]]
grads:  [-0.00384219 -0.55723483]
Stock Position:  -0.0038421897607646594
Bond Position:  [5.38414259]


portfolio before change:  [4.99113958]
curr_Stock_Price:  102.46138248489233
curr_Factors:  [1.02461382e+02 4.65332535e-02]
mat_Sqrt:  [[ 2.21025265e+01  0.00000000e+00]
 [-8.62862710e-03  1.97706684e-02]]
grads:  [-4.44427297e-03 -6.75978845e+00]
Stock Position:  -0.00444427296636622
Bond Position:  [5.44650593]


portfolio before change:  [4.99218683]
curr_Stock_Price:  102.37893971909784
curr_Factors:  [1.02378940e+02 4.55387691e-02]
mat_Sqrt:  [[ 2.18474760e+01  0.00000000e+00]
 [-8.53592588e-03  1.95582632e-02]]
grads:  [-0.00299849 -0.91470304]
Stock Position:  -0.0029984937841342867
Bond Position:  [5.29916945]


portfolio before change:  [4.99628426]
curr_Stock_Price:  101.23336795816658
curr_Factors:  [1.01233368e+02 4.38229233e-02]
mat_Sqrt:  [[ 2.11921177e+01  0.00000000e+00]
 [-8.37357017e-03  1.91862596e-02]]
grads:  [-0.00262181 -2.19610495]
Stock Position:  -0.002621813741304832
Bond Position:  [5.26169929]


portfolio before change:  [4.99869037]
curr_Stock_Price:  100.56651849342701
curr_Factors:  [1.00566518e+02 4.49973867e-02]
mat_Sqrt:  [[ 2.13327607e+01  0.00000000e+00]
 [-8.48503498e-03  1.94416575e-02]]
grads:  [ 0.02459107 13.34942297]
Stock Position:  0.024591069809058293
Bond Position:  [2.52565209]


portfolio before change:  [4.99106215]
curr_Stock_Price:  100.24347659398856
curr_Factors:  [1.00243477e+02 4.76543264e-02]
mat_Sqrt:  [[ 2.18830215e+01  0.00000000e+00]
 [-8.73194836e-03  2.00074072e-02]]
grads:  [ 8.21763148e-04 -1.31099788e+01]
Stock Position:  0.0008217631483669069
Bond Position:  [4.90868575]


portfolio before change:  [4.99149125]
curr_Stock_Price:  100.01893249843752
curr_Factors:  [1.00018932e+02 4.74653659e-02]
mat_Sqrt:  [[ 2.17906724e+01  0.00000000e+00]
 [-8.71461906e-03  1.99677007e-02]]
grads:  [3.46759696e-03 4.14024984e+00]
Stock Position:  0.0034675969647021674
Bond Position:  [4.6446659]


portfolio before change:  [4.99315003]
curr_Stock_Price:  100.32985762231418
curr_Factors:  [1.00329858e+02 4.83797341e-02]
mat_Sqrt:  [[ 2.20679471e+01  0.00000000e+00]
 [-8.79815746e-03  2.01591113e-02]]
grads:  [-1.44994850e-03 -5.32963476e+00]
Stock Position:  -0.0014499485048187581
Bond Position:  [5.13862316]


portfolio before change:  [4.99187321]
curr_Stock_Price:  101.65348697073783
curr_Factors:  [1.01653487e+02 4.83744155e-02]
mat_Sqrt:  [[ 2.23578556e+01  0.00000000e+00]
 [-8.79767383e-03  2.01580031e-02]]
grads:  [-1.42577692e-02 -2.32804629e+01]
Stock Position:  -0.01425776921325078
Bond Position:  [6.44122516]


portfolio before change:  [5.00413966]
curr_Stock_Price:  100.84962713381705
curr_Factors:  [1.00849627e+02 4.82217769e-02]
mat_Sqrt:  [[ 2.21460309e+01  0.00000000e+00]
 [-8.78378296e-03  2.01261752e-02]]
grads:  [-2.86079855e-03 -3.13442590e+00]
Stock Position:  -0.0028607985499861195
Bond Position:  [5.29265012]


portfolio before change:  [5.00444098]
curr_Stock_Price:  100.97556946809807
curr_Factors:  [1.00975569e+02 4.89707821e-02]
mat_Sqrt:  [[ 2.23452301e+01  0.00000000e+00]
 [-8.85173719e-03  2.02818779e-02]]
grads:  [ 0.0069241  -2.01000333]
Stock Position:  0.006924098491790898
Bond Position:  [4.3052762]


portfolio before change:  [5.01009688]
curr_Stock_Price:  101.71468400138367
curr_Factors:  [1.01714684e+02 4.90243203e-02]
mat_Sqrt:  [[ 2.25210920e+01  0.00000000e+00]
 [-8.85657454e-03  2.02929616e-02]]
grads:  [ 0.0228544 -8.7275487]
Stock Position:  0.022854396848982654
Bond Position:  [2.68546913]


portfolio before change:  [5.0437755]
curr_Stock_Price:  103.17361204345897
curr_Factors:  [1.03173612e+02 4.94580355e-02]
mat_Sqrt:  [[ 2.29449474e+01  0.00000000e+00]
 [-8.89566506e-03  2.03825292e-02]]
grads:  [-6.04045604e-03 -1.88582529e+01]
Stock Position:  -0.006040456038113252
Bond Position:  [5.66699117]


portfolio before change:  [5.04088439]
curr_Stock_Price:  103.7695162417043
curr_Factors:  [1.03769516e+02 4.75620517e-02]
mat_Sqrt:  [[ 2.26308092e+01  0.00000000e+00]
 [-8.72349029e-03  1.99880273e-02]]
grads:  [0.00242194 1.57568431]
Stock Position:  0.0024219446577201805
Bond Position:  [4.78956036]


portfolio before change:  [5.03533563]
curr_Stock_Price:  101.23127174023573
curr_Factors:  [1.01231272e+02 4.74775663e-02]
mat_Sqrt:  [[ 2.20576335e+01  0.00000000e+00]
 [-8.71573899e-03  1.99702668e-02]]
grads:  [ 0.00812355 -7.76600508]
Stock Position:  0.008123547608149349
Bond Position:  [4.21297858]


portfolio before change:  [5.0263311]
curr_Stock_Price:  100.05799290076217
curr_Factors:  [1.00057993e+02 4.75834740e-02]
mat_Sqrt:  [[ 2.18262869e+01  0.00000000e+00]
 [-8.72545462e-03  1.99925281e-02]]
grads:  [ 0.00540686 -4.66678981]
Stock Position:  0.005406863502051274
Bond Position:  [4.48533119]


portfolio before change:  [5.03763636]
curr_Stock_Price:  102.04519945357526
curr_Factors:  [1.02045199e+02 4.70464557e-02]
mat_Sqrt:  [[ 2.21338027e+01  0.00000000e+00]
 [-8.67607798e-03  1.98793920e-02]]
grads:  [-0.00764285  1.13949933]
Stock Position:  -0.007642848322411296
Bond Position:  [5.81755234]


portfolio before change:  [5.03892428]
curr_Stock_Price:  101.97183985133795
curr_Factors:  [1.01971840e+02 4.59401972e-02]
mat_Sqrt:  [[ 2.18563020e+01  0.00000000e+00]
 [-8.57346578e-03  1.96442779e-02]]
grads:  [6.33042117e-03 1.44191961e+01]
Stock Position:  0.006330421169587046
Bond Position:  [4.39339958]


portfolio before change:  [5.03929162]
curr_Stock_Price:  101.94311092937045
curr_Factors:  [1.01943111e+02 4.50287924e-02]
mat_Sqrt:  [[ 2.16323167e+01  0.00000000e+00]
 [-8.48799551e-03  1.94484410e-02]]
grads:  [2.34251431e-03 9.70020092e+00]
Stock Position:  0.002342514314227062
Bond Position:  [4.80048842]


portfolio before change:  [5.04001]
curr_Stock_Price:  101.9936036499047
curr_Factors:  [1.01993604e+02 4.63096897e-02]
mat_Sqrt:  [[ 2.19487035e+01  0.00000000e+00]
 [-8.60787451e-03  1.97231182e-02]]
grads:  [-0.02921209 -3.80505056]
Stock Position:  -0.02921208904528861
Bond Position:  [8.01945623]


portfolio before change:  [5.06304622]
curr_Stock_Price:  101.23933626149059
curr_Factors:  [1.01239336e+02 4.55888730e-02]
mat_Sqrt:  [[ 2.16161685e+01  0.00000000e+00]
 [-8.54062040e-03  1.95690197e-02]]
grads:  [-0.00908943 -3.26332771]
Stock Position:  -0.009089432000695497
Bond Position:  [5.98325428]


portfolio before change:  [5.07917068]
curr_Stock_Price:  99.54764497077902
curr_Factors:  [9.95476450e+01 4.46355785e-02]
mat_Sqrt:  [[ 2.10315642e+01  0.00000000e+00]
 [-8.45085354e-03  1.93633380e-02]]
grads:  [-8.06620253e-04 -3.18602344e+00]
Stock Position:  -0.0008066202529915473
Bond Position:  [5.15946783]


portfolio before change:  [5.08080457]
curr_Stock_Price:  98.32164998669928
curr_Factors:  [9.83216500e+01 4.47724805e-02]
mat_Sqrt:  [[ 2.08043780e+01  0.00000000e+00]
 [-8.46380345e-03  1.93930100e-02]]
grads:  [2.79099808e-03 8.90829913e+00]
Stock Position:  0.0027909980752185617
Bond Position:  [4.80638903]


portfolio before change:  [5.08122493]
curr_Stock_Price:  98.25698586122073
curr_Factors:  [9.82569859e+01 4.54452496e-02]
mat_Sqrt:  [[ 2.09463176e+01  0.00000000e+00]
 [-8.52715658e-03  1.95381702e-02]]
grads:  [5.03724447e-04 6.50813323e-01]
Stock Position:  0.0005037244468594236
Bond Position:  [5.03173048]


portfolio before change:  [5.08127008]
curr_Stock_Price:  97.09790920189629
curr_Factors:  [9.70979092e+01 4.67610405e-02]
mat_Sqrt:  [[ 2.09967444e+01  0.00000000e+00]
 [-8.64972051e-03  1.98189995e-02]]
grads:  [ 0.00452557 -2.73831469]
Stock Position:  0.004525571938157185
Bond Position:  [4.64184651]


portfolio before change:  [5.08163349]
curr_Stock_Price:  97.04999072747064
curr_Factors:  [9.70499907e+01 4.63902571e-02]
mat_Sqrt:  [[ 2.09030129e+01  0.00000000e+00]
 [-8.61535904e-03  1.97402675e-02]]
grads:  [1.28909792e-03 6.04443419e+00]
Stock Position:  0.0012890979171806358
Bond Position:  [4.95652655]


portfolio before change:  [5.07988442]
curr_Stock_Price:  95.21252827924708
curr_Factors:  [9.52125283e+01 4.70474033e-02]
mat_Sqrt:  [[ 2.06519910e+01  0.00000000e+00]
 [-8.67616536e-03  1.98795922e-02]]
grads:  [4.78837529e-05 6.20730760e+00]
Stock Position:  4.788375291350305e-05
Bond Position:  [5.07532529]


portfolio before change:  [5.08056507]
curr_Stock_Price:  96.17709523071528
curr_Factors:  [9.61770952e+01 4.63652023e-02]
mat_Sqrt:  [[ 2.07094105e+01  0.00000000e+00]
 [-8.61303220e-03  1.97349360e-02]]
grads:  [-0.01379527 -4.93228884]
Stock Position:  -0.013795265351587005
Bond Position:  [6.40735362]


portfolio before change:  [5.08325538]
curr_Stock_Price:  96.04013949868407
curr_Factors:  [9.60401395e+01 4.70325397e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.08325538]
Stock Price:  97.08951167278711
PL:  [5.08325538]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.22877369e+00  3.06702326e-01]
 [ 8.91255548e-02  5.49979870e-02]
 [ 4.76095391e-02 -4.33170981e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.86840901e-02 -6.98971893e-02]
 [-2.34796978e-01  5.12952047e-02]
 [ 1.74657204e-01 -1.78382729e-01]
 [ 1.85523211e-01  4.39950769e-01]
 [-1.18006150e-01 -9.76553649e-02]
 [-2.64816152e-01 -5.22628875e-01]
 [-7.72805148e-02 -1.10276782e-02]
 [-3.47919762e-02 -1.34228120e-01]
 [-5.65715939e-02 -1.94904749e-02]
 [ 2.32580595e-02 -2.00088094e-01]
 [ 1.51986460e-01  8.73547263e-02]
 [ 1.33518654e-01 -4.96908188e-01]
 [ 2.87195185e-02 -1.41291646e-01]
 [ 3.47518100e-02 -1.56493893e-01]
 [-1.14143777e-01 -4.67455363e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 9.42852969e-02 -1.32207994e-02]
 [ 2.93840758e-01 -4.49737142e-01]
 [ 2.73838538e-02 -3.49808831e-01]
 [-1.37348536e-03  2.13593024e-01]
 [ 5.20778944e-01 -6.57553642e-01]
 [-8.56168365e-01  1.37038247e-01]
 [-1.45110712e-01  2.50972317e-01]
 [-1.31693530e-01 -3.52604079e-01]
 [-7.74561299e-02  2.66522696e-01]
 [-4.71909591e-01  1.04161872e+00]
 [-9.84457953e-02  6.70014489e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-1.81722188e-01 -1.66869763e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.57126385e-01 -1.24493668e-01]
 [-3.34505694e-02 -1.21572069e-01]
 [ 2.41309736e-02 -6.25231311e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.6215248]
curr_Stock_Price:  100.42675307176422
curr_Factors:  [1.00426753e+02 3.97125665e-02]
mat_Sqrt:  [[ 2.00130555e+01  0.00000000e+00]
 [-7.97120482e-03  1.82643247e-02]]
grads:  [ 0.06808703 16.79242625]
Stock Position:  0.06808703238144412
Bond Position:  [-1.21623479]


portfolio before change:  [5.64719682]
curr_Stock_Price:  100.806033161848
curr_Factors:  [1.00806033e+02 4.02470783e-02]
mat_Sqrt:  [[ 2.02233782e+01  0.00000000e+00]
 [-8.02466979e-03  1.83868284e-02]]
grads:  [0.00559395 2.99116225]
Stock Position:  0.005593953832073874
Bond Position:  [5.08329252]


portfolio before change:  [5.64771879]
curr_Stock_Price:  100.78574685320736
curr_Factors:  [1.00785747e+02 4.02452640e-02]
mat_Sqrt:  [[ 2.02188527e+01  0.00000000e+00]
 [-8.02448892e-03  1.83864139e-02]]
grads:  [ 1.41968528e-03 -2.35592967e+00]
Stock Position:  0.0014196852780720176
Bond Position:  [5.50463475]


portfolio before change:  [5.64761469]
curr_Stock_Price:  100.22772435054823
curr_Factors:  [1.00227724e+02 4.00371565e-02]
mat_Sqrt:  [[ 2.00548530e+01  0.00000000e+00]
 [-8.00371479e-03  1.83388144e-02]]
grads:  [-8.12839015e-04 -8.25499451e+00]
Stock Position:  -0.0008128390150928218
Bond Position:  [5.7290837]


portfolio before change:  [5.64782129]
curr_Stock_Price:  100.85464157395337
curr_Factors:  [1.00854642e+02 4.01392094e-02]
mat_Sqrt:  [[ 2.02059976e+01  0.00000000e+00]
 [-8.01390885e-03  1.83621720e-02]]
grads:  [-0.00639363 -3.80658614]
Stock Position:  -0.00639363256765657
Bond Position:  [6.29264881]


portfolio before change:  [5.6498916]
curr_Stock_Price:  100.65386659786897
curr_Factors:  [1.00653867e+02 4.02869311e-02]
mat_Sqrt:  [[ 2.02028461e+01  0.00000000e+00]
 [-8.02864183e-03  1.83959295e-02]]
grads:  [-0.01051386  2.78839972]
Stock Position:  -0.010513860989553255
Bond Position:  [6.70815236]


portfolio before change:  [5.64110291]
curr_Stock_Price:  101.56953978305502
curr_Factors:  [1.01569540e+02 3.96575353e-02]
mat_Sqrt:  [[ 2.02267611e+01  0.00000000e+00]
 [-7.96567991e-03  1.82516656e-02]]
grads:  [ 4.78596639e-03 -9.77350411e+00]
Stock Position:  0.004785966392514673
Bond Position:  [5.15499451]


portfolio before change:  [5.63745306]
curr_Stock_Price:  100.67227690502034
curr_Factors:  [1.00672277e+02 4.22218583e-02]
mat_Sqrt:  [[ 2.06860973e+01  0.00000000e+00]
 [-8.21918325e-03  1.88325147e-02]]
grads:  [1.82505894e-02 2.33612333e+01]
Stock Position:  0.01825058941498964
Bond Position:  [3.80012467]


portfolio before change:  [5.65826523]
curr_Stock_Price:  101.78660408173381
curr_Factors:  [1.01786604e+02 4.21934432e-02]
mat_Sqrt:  [[ 2.09080297e+01  0.00000000e+00]
 [-8.21641704e-03  1.88261765e-02]]
grads:  [-0.00768252 -5.18721179]
Stock Position:  -0.007682524231439616
Bond Position:  [6.44024328]


portfolio before change:  [5.64878139]
curr_Stock_Price:  103.12586732490867
curr_Factors:  [1.03125867e+02 4.30280863e-02]
mat_Sqrt:  [[ 2.13916178e+01  0.00000000e+00]
 [-8.29728499e-03  1.90114683e-02]]
grads:  [-2.30422074e-02 -2.74901900e+01]
Stock Position:  -0.023042207392941338
Bond Position:  [8.02502901]


portfolio before change:  [5.64670329]
curr_Stock_Price:  103.25959118422787
curr_Factors:  [1.03259591e+02 4.28661359e-02]
mat_Sqrt:  [[ 2.13790090e+01  0.00000000e+00]
 [-8.28165548e-03  1.89756566e-02]]
grads:  [-0.00383991 -0.5811487 ]
Stock Position:  -0.003839906152951383
Bond Position:  [6.04321043]


portfolio before change:  [5.65096608]
curr_Stock_Price:  102.3461975432808
curr_Factors:  [1.02346198e+02 4.31441274e-02]
mat_Sqrt:  [[ 2.12584970e+01  0.00000000e+00]
 [-8.30846580e-03  1.90370867e-02]]
grads:  [-4.39231101e-03 -7.05087509e+00]
Stock Position:  -0.004392311012708357
Bond Position:  [6.10050241]


portfolio before change:  [5.64697429]
curr_Stock_Price:  103.42863506379885
curr_Factors:  [1.03428635e+02 4.37411070e-02]
mat_Sqrt:  [[ 2.16314523e+01  0.00000000e+00]
 [-8.36574988e-03  1.91683410e-02]]
grads:  [-0.00300849 -1.01680552]
Stock Position:  -0.003008486606409756
Bond Position:  [5.95813795]


portfolio before change:  [5.64737253]
curr_Stock_Price:  103.54383541672628
curr_Factors:  [1.03543835e+02 4.43027063e-02]
mat_Sqrt:  [[ 2.17941219e+01  0.00000000e+00]
 [-8.41928322e-03  1.92910013e-02]]
grads:  [-2.93967081e-03 -1.03720948e+01]
Stock Position:  -0.0029396708059715258
Bond Position:  [5.95175732]


portfolio before change:  [5.64967836]
curr_Stock_Price:  103.01254684248747
curr_Factors:  [1.03012547e+02 4.51157307e-02]
mat_Sqrt:  [[ 2.18803428e+01  0.00000000e+00]
 [-8.49618557e-03  1.94672067e-02]]
grads:  [0.00868868 4.48727583]
Stock Position:  0.008688675006691357
Bond Position:  [4.75463581]


portfolio before change:  [5.64080734]
curr_Stock_Price:  101.92315329355863
curr_Factors:  [1.01923153e+02 4.75774828e-02]
mat_Sqrt:  [[ 2.22317465e+01  0.00000000e+00]
 [-8.72490530e-03  1.99912695e-02]]
grads:  [-3.74913680e-03 -2.48562598e+01]
Stock Position:  -0.0037491368001831608
Bond Position:  [6.02293118]


portfolio before change:  [5.63953007]
curr_Stock_Price:  102.46465844691467
curr_Factors:  [1.02464658e+02 4.88899493e-02]
mat_Sqrt:  [[ 2.26560341e+01  0.00000000e+00]
 [-8.84442869e-03  2.02651320e-02]]
grads:  [-1.45414732e-03 -6.97215524e+00]
Stock Position:  -0.0014541473204016636
Bond Position:  [5.78852878]


portfolio before change:  [5.63854359]
curr_Stock_Price:  103.64066735245828
curr_Factors:  [1.03640667e+02 4.82183914e-02]
mat_Sqrt:  [[ 2.27581293e+01  0.00000000e+00]
 [-8.78347461e-03  2.01254686e-02]]
grads:  [-1.47409850e-03 -7.77591299e+00]
Stock Position:  -0.0014740985030402894
Bond Position:  [5.79132015]


portfolio before change:  [5.63949022]
curr_Stock_Price:  103.4896174470899
curr_Factors:  [1.03489617e+02 4.74219460e-02]
mat_Sqrt:  [[ 2.25364999e+01  0.00000000e+00]
 [-8.71063221e-03  1.99585657e-02]]
grads:  [-1.41174550e-02 -2.34212904e+01]
Stock Position:  -0.01411745500095488
Bond Position:  [7.10050023]


portfolio before change:  [5.61075997]
curr_Stock_Price:  105.58757788190869
curr_Factors:  [1.05587578e+02 4.62302286e-02]
mat_Sqrt:  [[ 2.27026131e+01  0.00000000e+00]
 [-8.60048637e-03  1.97061899e-02]]
grads:  [-2.13460318e-04 -5.53599604e+00]
Stock Position:  -0.00021346031764824018
Bond Position:  [5.63329873]


portfolio before change:  [5.61123642]
curr_Stock_Price:  106.6545743311074
curr_Factors:  [1.06654574e+02 4.47444787e-02]
mat_Sqrt:  [[ 2.25605256e+01  0.00000000e+00]
 [-8.46115630e-03  1.93869446e-02]]
grads:  [ 0.00392346 -0.68194343]
Stock Position:  0.0039234576654565406
Bond Position:  [5.19278171]


portfolio before change:  [5.61085532]
curr_Stock_Price:  106.39198956523344
curr_Factors:  [1.06391990e+02 4.55272123e-02]
mat_Sqrt:  [[ 2.27009724e+01  0.00000000e+00]
 [-8.53484269e-03  1.95557813e-02]]
grads:  [ 4.29758585e-03 -2.29976565e+01]
Stock Position:  0.004297585847474
Bond Position:  [5.15362661]


portfolio before change:  [5.61852937]
curr_Stock_Price:  108.02774686790421
curr_Factors:  [1.08027747e+02 4.39268761e-02]
mat_Sqrt:  [[ 2.26412540e+01  0.00000000e+00]
 [-8.38349579e-03  1.92090020e-02]]
grads:  [-5.53349369e-03 -1.82106718e+01]
Stock Position:  -0.005533493694164977
Bond Position:  [6.21630022]


portfolio before change:  [5.61542559]
curr_Stock_Price:  108.72908771162551
curr_Factors:  [1.08729088e+02 4.33063017e-02]
mat_Sqrt:  [[ 2.26267038e+01  0.00000000e+00]
 [-8.32406647e-03  1.90728324e-02]]
grads:  [4.05919277e-03 1.11988099e+01]
Stock Position:  0.004059192774798427
Bond Position:  [5.17407326]


portfolio before change:  [5.62301458]
curr_Stock_Price:  110.43932695380487
curr_Factors:  [1.10439327e+02 4.31968746e-02]
mat_Sqrt:  [[ 2.29535527e+01  0.00000000e+00]
 [-8.31354313e-03  1.90487204e-02]]
grads:  [ 1.01857438e-02 -3.45195703e+01]
Stock Position:  0.010185743799669909
Bond Position:  [4.49810789]


portfolio before change:  [5.62263214]
curr_Stock_Price:  110.34657564985487
curr_Factors:  [1.10346576e+02 4.15948629e-02]
mat_Sqrt:  [[ 2.25049840e+01  0.00000000e+00]
 [-8.15792747e-03  1.86921601e-02]]
grads:  [-0.03538594  7.33132216]
Stock Position:  -0.035385938043707314
Bond Position:  [9.52734922]


portfolio before change:  [5.65041444]
curr_Stock_Price:  109.59511024228532
curr_Factors:  [1.09595110e+02 4.10385575e-02]
mat_Sqrt:  [[ 2.22017507e+01  0.00000000e+00]
 [-8.10319024e-03  1.85667413e-02]]
grads:  [-1.60245981e-03  1.35173056e+01]
Stock Position:  -0.001602459813774458
Bond Position:  [5.8260362]


portfolio before change:  [5.65114645]
curr_Stock_Price:  109.59279567974517
curr_Factors:  [1.09592796e+02 4.22781131e-02]
mat_Sqrt:  [[ 2.25340786e+01  0.00000000e+00]
 [-8.22465689e-03  1.88450564e-02]]
grads:  [-1.26733634e-02 -1.87106938e+01]
Stock Position:  -0.012673363411733083
Bond Position:  [7.04005577]


portfolio before change:  [5.63981426]
curr_Stock_Price:  110.55641136687329
curr_Factors:  [1.10556411e+02 4.20670096e-02]
mat_Sqrt:  [[ 2.26753894e+01  0.00000000e+00]
 [-8.20409747e-03  1.87979488e-02]]
grads:  [1.71392475e-03 1.41782861e+01]
Stock Position:  0.0017139247479295095
Bond Position:  [5.45032889]


portfolio before change:  [5.63983445]
curr_Stock_Price:  110.17066273794086
curr_Factors:  [1.10170663e+02 4.15030266e-02]
mat_Sqrt:  [[ 2.24442887e+01  0.00000000e+00]
 [-8.14891665e-03  1.86715137e-02]]
grads:  [-7.71239066e-04  5.57865172e+01]
Stock Position:  -0.0007712390663465427
Bond Position:  [5.72480236]


portfolio before change:  [5.64158456]
curr_Stock_Price:  108.82936055151053
curr_Factors:  [1.08829361e+02 4.07269352e-02]
mat_Sqrt:  [[ 2.19627613e+01  0.00000000e+00]
 [-8.07236622e-03  1.84961146e-02]]
grads:  [-3.15096834e-03  3.62246073e+00]
Stock Position:  -0.003150968340458347
Bond Position:  [5.98450242]


portfolio before change:  [5.64197821]
curr_Stock_Price:  108.94185205654733
curr_Factors:  [1.08941852e+02 4.08850985e-02]
mat_Sqrt:  [[ 2.20281121e+01  0.00000000e+00]
 [-8.08802557e-03  1.85319947e-02]]
grads:  [ 0.00329318 -0.64467907]
Stock Position:  0.003293182655374696
Bond Position:  [5.28321279]


portfolio before change:  [5.6424654]
curr_Stock_Price:  108.88924255996449
curr_Factors:  [1.08889243e+02 3.97340689e-02]
mat_Sqrt:  [[ 2.17053352e+01  0.00000000e+00]
 [-7.97336254e-03  1.82692687e-02]]
grads:  [-0.01172754 -9.13390488]
Stock Position:  -0.011727537084953577
Bond Position:  [6.91946803]


portfolio before change:  [5.63818965]
curr_Stock_Price:  109.32759005226438
curr_Factors:  [1.09327590e+02 4.02242774e-02]
mat_Sqrt:  [[ 2.19267316e+01  0.00000000e+00]
 [-8.02239639e-03  1.83816194e-02]]
grads:  [0.00462774 2.90230473]
Stock Position:  0.004627738120165146
Bond Position:  [5.13225019]


portfolio before change:  [5.64318057]
curr_Stock_Price:  110.26743386248639
curr_Factors:  [1.10267434e+02 4.24033182e-02]
mat_Sqrt:  [[ 2.27063428e+01  0.00000000e+00]
 [-8.23682640e-03  1.88729402e-02]]
grads:  [-4.16921438e-03  4.30908725e+00]
Stock Position:  -0.004169214380004947
Bond Position:  [6.10290914]


portfolio before change:  [5.64471632]
curr_Stock_Price:  110.08206550907686
curr_Factors:  [1.10082066e+02 4.23507392e-02]
mat_Sqrt:  [[ 2.26541132e+01  0.00000000e+00]
 [-8.23171809e-03  1.88612356e-02]]
grads:  [-0.02257691 -6.60050439]
Stock Position:  -0.022576910041143858
Bond Position:  [8.13002921]


portfolio before change:  [5.63298437]
curr_Stock_Price:  110.64672529050513
curr_Factors:  [1.10646725e+02 4.09620600e-02]
mat_Sqrt:  [[ 2.23938858e+01  0.00000000e+00]
 [-8.09563438e-03  1.85494287e-02]]
grads:  [-3.86306205e-03 -6.55395223e+00]
Stock Position:  -0.0038630620480068403
Bond Position:  [6.06041953]


portfolio before change:  [5.62954806]
curr_Stock_Price:  111.73236867886722
curr_Factors:  [1.11732369e+02 3.97596087e-02]
mat_Sqrt:  [[ 2.22792238e+01  0.00000000e+00]
 [-7.97592464e-03  1.82751392e-02]]
grads:  [-1.41672708e-04 -3.42121231e+00]
Stock Position:  -0.00014167270760213037
Bond Position:  [5.64537749]


portfolio before change:  [5.63020727]
curr_Stock_Price:  112.06062930031139
curr_Factors:  [1.12060629e+02 3.87093461e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.63020727]
Stock Price:  111.48168867772254
PL:  [-5.85148141]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.45393479e+00  3.57606740e-01]
 [ 1.27394909e+00  5.27192292e-02]
 [-1.11791322e-01  1.41872587e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.80729784e-02  4.18003455e-01]
 [ 2.74000986e-02 -2.69370650e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.14084223e+00  1.16739113e+00]
 [ 5.13076909e-02  4.69538260e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-4.37711682e-02  1.57240065e-02]
 [ 5.23146647e-02 -1.32502268e-01]
 [-1.18493230e-01 -2.63684125e-02]
 [-8.72047142e-02  1.02137972e-01]
 [ 4.94018109e-01  3.19914052e-01]
 [ 1.31222321e-01 -1.79330950e-01]
 [ 3.95172624e-02  1.08387043e-01]
 [-2.30122862e-03 -5.23747460e-03]
 [-5.85122928e-02 -1.14500367e-01]
 [-7.91603781e-02 -3.70232868e-02]
 [ 1.75008166e-01 -4.19380241e-02]
 [ 9.73498867e-01  7.38892451e-02]
 [ 2.50281946e-02 -1.39204125e-01]
 [ 2.34623299e-02  1.96601847e-02]
 [-6.42311258e-03  2.14653017e-02]
 [ 1.44913326e-01 -9.81525205e-02]
 [-6.66089133e-02 -3.65317993e-01]
 [ 5.18115916e-02  1.96838158e-01]
 [ 2.72459323e-02  1.51291934e-01]
 [-5.56308826e-01 -9.36716967e-02]
 [-1.68164095e-01 -6.33754236e-02]
 [ 1.08169088e-02 -6.80010998e-02]
 [-2.77197330e-01  1.26445846e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.15921799e-01  1.11225276e-02]
 [-2.71064038e-02 -1.80315715e-01]
 [-1.10445935e-02 -6.43702340e-02]
 [ 1.60953145e-01 -1.72240448e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.13833047]
curr_Stock_Price:  99.44552651619122
curr_Factors:  [9.94455265e+01 3.92351493e-02]
mat_Sqrt:  [[ 1.96980351e+01  0.00000000e+00]
 [-7.92314577e-03  1.81542076e-02]]
grads:  [ 0.0817344  19.69828412]
Stock Position:  0.0817344043561509
Bond Position:  [-9.26645134]


portfolio before change:  [-1.27640488]
curr_Stock_Price:  97.77039311061357
curr_Factors:  [9.77703931e+01 3.86274050e-02]
mat_Sqrt:  [[ 1.92156521e+01  0.00000000e+00]
 [-7.86154234e-03  1.80130564e-02]]
grads:  [0.06749485 2.92672315]
Stock Position:  0.06749485470238178
Bond Position:  [-7.87540335]


portfolio before change:  [-1.3266769]
curr_Stock_Price:  97.04015165815731
curr_Factors:  [9.70401517e+01 3.96668168e-02]
mat_Sqrt:  [[ 1.93270309e+01  0.00000000e+00]
 [-7.96661201e-03  1.82538013e-02]]
grads:  [-2.58048167e-03  7.77222150e+00]
Stock Position:  -0.002580481666838102
Bond Position:  [-1.07626657]


portfolio before change:  [-1.32748396]
curr_Stock_Price:  97.30076708438003
curr_Factors:  [9.73007671e+01 3.89324610e-02]
mat_Sqrt:  [[ 1.91987164e+01  0.00000000e+00]
 [-7.89252416e-03  1.80840447e-02]]
grads:  [-8.49086295e-04 -8.37129166e+00]
Stock Position:  -0.0008490862951897845
Bond Position:  [-1.24486721]


portfolio before change:  [-1.32856543]
curr_Stock_Price:  98.39117953142923
curr_Factors:  [9.83911795e+01 3.87360871e-02]
mat_Sqrt:  [[ 1.93648457e+01  0.00000000e+00]
 [-7.87259420e-03  1.80383794e-02]]
grads:  [4.87267945e-03 2.31730049e+01]
Stock Position:  0.0048726794451682985
Bond Position:  [-1.80799411]


portfolio before change:  [-1.33694366]
curr_Stock_Price:  96.71813434188748
curr_Factors:  [9.67181343e+01 3.90008849e-02]
mat_Sqrt:  [[ 1.91005178e+01  0.00000000e+00]
 [-7.89945668e-03  1.80999291e-02]]
grads:  [ 8.19024898e-04 -1.48824146e+00]
Stock Position:  0.0008190248979802183
Bond Position:  [-1.41615822]


portfolio before change:  [-1.33796013]
curr_Stock_Price:  95.69320382137558
curr_Factors:  [9.56932038e+01 3.85633767e-02]
mat_Sqrt:  [[ 1.87918104e+01  0.00000000e+00]
 [-7.85502404e-03  1.79981211e-02]]
grads:  [0.00688458 5.34149573]
Stock Position:  0.006884582928982137
Bond Position:  [-1.99676793]


portfolio before change:  [-1.33785192]
curr_Stock_Price:  95.74517821901435
curr_Factors:  [9.57451782e+01 3.82282157e-02]
mat_Sqrt:  [[ 1.87201328e+01  0.00000000e+00]
 [-7.82081487e-03  1.79197381e-02]]
grads:  [ 0.08815821 65.1455467 ]
Stock Position:  0.08815821474519808
Bond Position:  [-9.7785759]


portfolio before change:  [-1.27739328]
curr_Stock_Price:  96.44484122504895
curr_Factors:  [9.64448412e+01 3.74291585e-02]
mat_Sqrt:  [[ 1.86588139e+01  0.00000000e+00]
 [-7.73864675e-03  1.77314673e-02]]
grads:  [1.37324370e-02 2.64805079e+01]
Stock Position:  0.013732437048228593
Bond Position:  [-2.60181599]


portfolio before change:  [-1.27123159]
curr_Stock_Price:  96.91722197710266
curr_Factors:  [9.69172220e+01 3.85827645e-02]
mat_Sqrt:  [[ 1.90369613e+01  0.00000000e+00]
 [-7.85699836e-03  1.80026449e-02]]
grads:  [0.01294504 6.28110671]
Stock Position:  0.012945037933530164
Bond Position:  [-2.5258287]


portfolio before change:  [-1.26764135]
curr_Stock_Price:  97.2189580222254
curr_Factors:  [9.72189580e+01 3.77917108e-02]
mat_Sqrt:  [[ 1.88994532e+01  0.00000000e+00]
 [-7.77603609e-03  1.78171370e-02]]
grads:  [-0.0019529  0.8825215]
Stock Position:  -0.0019528950841021884
Bond Position:  [-1.07778292]


portfolio before change:  [-1.26842615]
curr_Stock_Price:  97.55183516048241
curr_Factors:  [9.75518352e+01 3.74862685e-02]
mat_Sqrt:  [[ 1.88873727e+01  0.00000000e+00]
 [-7.74454838e-03  1.77449896e-02]]
grads:  [-2.91944570e-04 -7.46702426e+00]
Stock Position:  -0.00029194456986523327
Bond Position:  [-1.23994643]


portfolio before change:  [-1.26839735]
curr_Stock_Price:  96.92223306476646
curr_Factors:  [9.69222331e+01 3.87581416e-02]
mat_Sqrt:  [[ 1.90811649e+01  0.00000000e+00]
 [-7.87483502e-03  1.80435138e-02]]
grads:  [-0.00681307 -1.46137902]
Stock Position:  -0.00681307190492357
Bond Position:  [-0.60805921]


portfolio before change:  [-1.27608845]
curr_Stock_Price:  98.03994996666223
curr_Factors:  [9.80399500e+01 3.74812036e-02]
mat_Sqrt:  [[ 1.89805960e+01  0.00000000e+00]
 [-7.74402517e-03  1.77437908e-02]]
grads:  [-2.24587515e-03  5.75626555e+00]
Stock Position:  -0.0022458751451881406
Bond Position:  [-1.05590296]


portfolio before change:  [-1.27867907]
curr_Stock_Price:  99.13468087285813
curr_Factors:  [9.91346809e+01 3.73572000e-02]
mat_Sqrt:  [[ 1.91607618e+01  0.00000000e+00]
 [-7.73120430e-03  1.77144145e-02]]
grads:  [ 0.03306967 18.05953295]
Stock Position:  0.03306966887262951
Bond Position:  [-4.55703014]


portfolio before change:  [-1.26296519]
curr_Stock_Price:  99.62708198734579
curr_Factors:  [9.96270820e+01 3.82711976e-02]
mat_Sqrt:  [[ 1.94900717e+01  0.00000000e+00]
 [-7.82521029e-03  1.79298092e-02]]
grads:  [ 2.71706944e-03 -1.00018326e+01]
Stock Position:  0.0027170694402149464
Bond Position:  [-1.53365889]


portfolio before change:  [-1.26514946]
curr_Stock_Price:  98.89373673661107
curr_Factors:  [9.88937367e+01 4.00678961e-02]
mat_Sqrt:  [[ 1.97955265e+01  0.00000000e+00]
 [-8.00678673e-03  1.83458531e-02]]
grads:  [4.38590235e-03 5.90798599e+00]
Stock Position:  0.00438590235465449
Bond Position:  [-1.69888774]


portfolio before change:  [-1.26454795]
curr_Stock_Price:  99.07930635211206
curr_Factors:  [9.90793064e+01 4.06346119e-02]
mat_Sqrt:  [[ 1.99724350e+01  0.00000000e+00]
 [-8.06321146e-03  1.84751384e-02]]
grads:  [-2.29669038e-04 -2.83487705e-01]
Stock Position:  -0.00022966903842376474
Bond Position:  [-1.2417925]


portfolio before change:  [-1.2647493]
curr_Stock_Price:  99.28012776242213
curr_Factors:  [9.92801278e+01 4.09186696e-02]
mat_Sqrt:  [[ 2.00827453e+01  0.00000000e+00]
 [-8.09134546e-03  1.85396015e-02]]
grads:  [-5.40186853e-03 -6.17598856e+00]
Stock Position:  -0.0054018685320489125
Bond Position:  [-0.72845111]


portfolio before change:  [-1.2658596]
curr_Stock_Price:  99.46880863843703
curr_Factors:  [9.94688086e+01 4.03687424e-02]
mat_Sqrt:  [[ 1.99852473e+01  0.00000000e+00]
 [-8.03678965e-03  1.84145985e-02]]
grads:  [-0.00476945 -2.01054   ]
Stock Position:  -0.004769451376335564
Bond Position:  [-0.79144795]


portfolio before change:  [-1.26264835]
curr_Stock_Price:  98.77477022425396
curr_Factors:  [9.87747702e+01 3.93730940e-02]
mat_Sqrt:  [[ 1.95995365e+01  0.00000000e+00]
 [-7.93706183e-03  1.81860933e-02]]
grads:  [ 0.00799534 -2.3060491 ]
Stock Position:  0.007995337637571253
Bond Position:  [-2.05238599]


portfolio before change:  [-1.26131555]
curr_Stock_Price:  98.97355619251736
curr_Factors:  [9.89735562e+01 3.96701624e-02]
mat_Sqrt:  [[ 1.97129293e+01  0.00000000e+00]
 [-7.96694796e-03  1.82545711e-02]]
grads:  [0.05101965 4.04771193]
Stock Position:  0.051019651191653505
Bond Position:  [-6.31091187]


portfolio before change:  [-1.22316894]
curr_Stock_Price:  99.73670383870457
curr_Factors:  [9.97367038e+01 3.77435440e-02]
mat_Sqrt:  [[ 1.93765454e+01  0.00000000e+00]
 [-7.77107911e-03  1.78057791e-02]]
grads:  [-1.84374797e-03 -7.81791821e+00]
Stock Position:  -0.0018437479723350397
Bond Position:  [-1.03927959]


portfolio before change:  [-1.22512445]
curr_Stock_Price:  100.72685653800637
curr_Factors:  [1.00726857e+02 3.89862007e-02]
mat_Sqrt:  [[ 1.98884408e+01  0.00000000e+00]
 [-7.89796943e-03  1.80965214e-02]]
grads:  [0.00161112 1.08640685]
Stock Position:  0.0016111236754018017
Bond Position:  [-1.38740787]


portfolio before change:  [-1.22786797]
curr_Stock_Price:  99.13164482496656
curr_Factors:  [9.91316448e+01 3.93801990e-02]
mat_Sqrt:  [[ 1.96721246e+01  0.00000000e+00]
 [-7.93777793e-03  1.81877341e-02]]
grads:  [1.49709967e-04 1.18020758e+00]
Stock Position:  0.0001497099667725245
Bond Position:  [-1.24270897]


portfolio before change:  [-1.22796609]
curr_Stock_Price:  99.51388925554494
curr_Factors:  [9.95138893e+01 4.01021182e-02]
mat_Sqrt:  [[ 1.99281671e+01  0.00000000e+00]
 [-8.01020531e-03  1.83536861e-02]]
grads:  [ 5.12219983e-03 -5.34783694e+00]
Stock Position:  0.005122199833039648
Bond Position:  [-1.73769612]


portfolio before change:  [-1.23248615]
curr_Stock_Price:  98.67385324825104
curr_Factors:  [9.86738532e+01 4.02408504e-02]
mat_Sqrt:  [[ 1.97940956e+01  0.00000000e+00]
 [-8.02404889e-03  1.83854057e-02]]
grads:  [-1.14199083e-02 -1.98699990e+01]
Stock Position:  -0.011419908313857564
Bond Position:  [-0.10563979]


portfolio before change:  [-1.25019748]
curr_Stock_Price:  100.22361344810055
curr_Factors:  [1.00223613e+02 3.82424526e-02]
mat_Sqrt:  [[ 1.95994067e+01  0.00000000e+00]
 [-7.82227104e-03  1.79230746e-02]]
grads:  [7.02668242e-03 1.09823879e+01]
Stock Position:  0.007026682418386011
Bond Position:  [-1.95443698]


portfolio before change:  [-1.25333165]
curr_Stock_Price:  99.8123450290654
curr_Factors:  [9.98123450e+01 3.95543694e-02]
mat_Sqrt:  [[ 1.98509590e+01  0.00000000e+00]
 [-7.95531213e-03  1.82279100e-02]]
grads:  [4.69877278e-03 8.30001544e+00]
Stock Position:  0.004698772784530399
Bond Position:  [-1.72232718]


portfolio before change:  [-1.24767102]
curr_Stock_Price:  101.06286919974313
curr_Factors:  [1.01062869e+02 4.02262963e-02]
mat_Sqrt:  [[ 2.02696686e+01  0.00000000e+00]
 [-8.02259771e-03  1.83820806e-02]]
grads:  [-0.02946227 -5.09581578]
Stock Position:  -0.029462272825799635
Bond Position:  [1.7298708]


portfolio before change:  [-1.22899191]
curr_Stock_Price:  100.4362080178874
curr_Factors:  [1.00436208e+02 4.01632581e-02]
mat_Sqrt:  [[ 2.01281924e+01  0.00000000e+00]
 [-8.01630919e-03  1.83676718e-02]]
grads:  [-0.00972881 -3.4503787 ]
Stock Position:  -0.00972881186319864
Bond Position:  [-0.25186694]


portfolio before change:  [-1.23234732]
curr_Stock_Price:  100.77786587079508
curr_Factors:  [1.00777866e+02 4.08272680e-02]
mat_Sqrt:  [[ 2.03629323e+01  0.00000000e+00]
 [-8.08230343e-03  1.85188836e-02]]
grads:  [-9.26251879e-04 -3.67198699e+00]
Stock Position:  -0.0009262518788162828
Bond Position:  [-1.13900164]


portfolio before change:  [-1.23364471]
curr_Stock_Price:  102.0248337826367
curr_Factors:  [1.02024834e+02 4.00146641e-02]
mat_Sqrt:  [[ 2.04087067e+01  0.00000000e+00]
 [-8.00146628e-03  1.83336624e-02]]
grads:  [-0.01087829  6.89692233]
Stock Position:  -0.01087829041539546
Bond Position:  [-0.12378894]


portfolio before change:  [-1.24304681]
curr_Stock_Price:  102.88770981804977
curr_Factors:  [1.02887710e+02 4.04852433e-02]
mat_Sqrt:  [[ 2.07019796e+01  0.00000000e+00]
 [-8.04837805e-03  1.84411508e-02]]
grads:  [0.00490152 2.89293555]
Stock Position:  0.004901520215314874
Bond Position:  [-1.74735299]


portfolio before change:  [-1.24075319]
curr_Stock_Price:  103.40021405899735
curr_Factors:  [1.03400214e+02 3.90094970e-02]
mat_Sqrt:  [[ 2.04223922e+01  0.00000000e+00]
 [-7.90032880e-03  1.81019274e-02]]
grads:  [-0.00463548  4.4926236 ]
Stock Position:  -0.0046354809807295574
Bond Position:  [-0.76144346]


portfolio before change:  [-1.24370787]
curr_Stock_Price:  104.01708560718255
curr_Factors:  [1.04017086e+02 3.85130282e-02]
mat_Sqrt:  [[ 2.04130789e+01  0.00000000e+00]
 [-7.84989459e-03  1.79863681e-02]]
grads:  [-0.01523864  0.61838652]
Stock Position:  -0.015238638454194603
Bond Position:  [0.34137089]


portfolio before change:  [-1.24386784]
curr_Stock_Price:  104.03038371199693
curr_Factors:  [1.04030384e+02 3.91628817e-02]
mat_Sqrt:  [[ 2.05872112e+01  0.00000000e+00]
 [-7.91584555e-03  1.81374807e-02]]
grads:  [-5.13924069e-03 -9.94160755e+00]
Stock Position:  -0.005139240687048682
Bond Position:  [-0.70923066]


portfolio before change:  [-1.2491876]
curr_Stock_Price:  105.04825723005166
curr_Factors:  [1.05048257e+02 3.70707889e-02]
mat_Sqrt:  [[ 2.02257561e+01  0.00000000e+00]
 [-7.70151038e-03  1.76463771e-02]]
grads:  [-1.93506075e-03 -3.64778750e+00]
Stock Position:  -0.0019350607515085465
Bond Position:  [-1.04591284]


portfolio before change:  [-1.25068629]
curr_Stock_Price:  105.75518113208713
curr_Factors:  [1.05755181e+02 3.66097871e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.25068629]
Stock Price:  108.98964508358047
PL:  [-10.24033137]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.26669925e+00  3.15276536e-01]
 [ 4.27543924e-01  1.21502763e-01]
 [ 7.91023173e-02  7.36178278e-03]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.29399139e-02  4.86824437e-01]
 [ 2.29407066e-02 -3.15290578e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.04479508e+00  1.05967258e+00]
 [ 1.27047298e-01  6.71645000e-01]
 [-1.40610984e-01 -4.86402674e-01]
 [ 1.74533211e-01  1.09629591e-02]
 [ 4.28564069e-02 -4.27635304e-02]
 [ 7.22595237e-02  7.00512267e-01]
 [-1.78661321e-01  6.20252237e-01]
 [-2.95976822e-01 -3.47287709e-02]
 [ 1.27909696e-01 -1.92034116e-01]
 [ 3.54287356e-02 -1.37779798e-01]
 [ 4.94268586e-01  5.85257374e-02]
 [ 6.94963333e-01  7.12722072e-01]
 [-1.24784113e+00  6.49582743e-01]
 [-4.45999428e-01  5.30133215e-01]
 [ 2.03778473e+00  3.93250873e-01]
 [ 1.30691001e-02  3.54185418e-01]
 [-1.70818088e-01  2.60217887e-01]
 [-1.35193713e-01  2.67942067e-02]
 [ 2.71310180e-01 -9.47813850e-02]
 [ 9.15401690e-01 -3.28378669e-01]
 [ 1.67713405e-01 -1.54775982e-01]
 [ 9.72604129e-01 -3.37979429e-01]
 [-8.34204915e-01 -3.69224299e-01]
 [ 3.85544753e-01  1.45436230e-01]
 [-1.67630170e-01  2.40909997e-01]
 [ 6.51963992e-01  2.34768276e-01]
 [ 5.82250136e-02 -9.85869474e-02]
 [ 2.92801665e-01 -3.19972581e-01]
 [ 1.19800700e-01  3.84768082e-02]
 [-6.71931724e-02  3.52645768e-01]
 [-3.36429030e-01 -1.23631843e-01]
 [ 5.63314298e-02  3.76312065e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.50678811]
curr_Stock_Price:  100.26494350612754
curr_Factors:  [1.00264944e+02 4.06231245e-02]
mat_Sqrt:  [[ 2.02085790e+01  0.00000000e+00]
 [-8.06207165e-03  1.84725268e-02]]
grads:  [ 0.06949015 17.06732057]
Stock Position:  0.06949015143901276
Bond Position:  [-2.460638]


portfolio before change:  [4.48499291]
curr_Stock_Price:  99.95572561855006
curr_Factors:  [9.99557256e+01 4.18478572e-02]
mat_Sqrt:  [[ 2.04476917e+01  0.00000000e+00]
 [-8.18269953e-03  1.87489200e-02]]
grads:  [0.02350251 6.48052061]
Stock Position:  0.023502509876942024
Bond Position:  [2.13578248]


portfolio before change:  [4.44808211]
curr_Stock_Price:  98.37386107516542
curr_Factors:  [9.83738611e+01 4.33777805e-02]
mat_Sqrt:  [[ 2.04886518e+01  0.00000000e+00]
 [-8.33093325e-03  1.90885661e-02]]
grads:  [0.0040176  0.38566452]
Stock Position:  0.004017602704726352
Bond Position:  [4.05285502]


portfolio before change:  [4.44655065]
curr_Stock_Price:  97.86656841127184
curr_Factors:  [9.78665684e+01 4.46356214e-02]
mat_Sqrt:  [[ 2.06764108e+01  0.00000000e+00]
 [-8.45085760e-03  1.93633473e-02]]
grads:  [-7.88404094e-04 -7.81821499e+00]
Stock Position:  -0.0007884040938083241
Bond Position:  [4.52370906]


portfolio before change:  [4.44681971]
curr_Stock_Price:  98.24257072334768
curr_Factors:  [9.82425707e+01 4.53766078e-02]
mat_Sqrt:  [[ 2.09274220e+01  0.00000000e+00]
 [-8.52071431e-03  1.95234092e-02]]
grads:  [5.71153434e-03 2.49354215e+01]
Stock Position:  0.005711534337691853
Bond Position:  [3.88570389]


portfolio before change:  [4.43900631]
curr_Stock_Price:  96.78952097190506
curr_Factors:  [9.67895210e+01 4.74112419e-02]
mat_Sqrt:  [[ 2.10750691e+01  0.00000000e+00]
 [-8.70964908e-03  1.99563131e-02]]
grads:  [ 4.35599885e-04 -1.57990395e+00]
Stock Position:  0.00043559988505173936
Bond Position:  [4.39684481]


portfolio before change:  [4.43968471]
curr_Stock_Price:  97.08510578262403
curr_Factors:  [9.70851058e+01 4.72252015e-02]
mat_Sqrt:  [[ 2.10979140e+01  0.00000000e+00]
 [-8.69254407e-03  1.99171206e-02]]
grads:  [0.00613206 4.82684666]
Stock Position:  0.006132064861755035
Bond Position:  [3.84435254]


portfolio before change:  [4.43620358]
curr_Stock_Price:  96.43904280487004
curr_Factors:  [9.64390428e+01 4.74769276e-02]
mat_Sqrt:  [[ 2.10132968e+01  0.00000000e+00]
 [-8.71568036e-03  1.99701325e-02]]
grads:  [ 0.07172954 53.06287185]
Stock Position:  0.0717295399971487
Bond Position:  [-2.4813246]


portfolio before change:  [4.278396]
curr_Stock_Price:  94.24333107382768
curr_Factors:  [9.42433311e+01 4.87106107e-02]
mat_Sqrt:  [[ 2.07999560e+01  0.00000000e+00]
 [-8.82819218e-03  2.02279295e-02]]
grads:  [2.02008701e-02 3.32038433e+01]
Stock Position:  0.020200870069044117
Bond Position:  [2.37459872]


portfolio before change:  [4.23918512]
curr_Stock_Price:  92.28758724885658
curr_Factors:  [9.22875872e+01 4.90186265e-02]
mat_Sqrt:  [[ 2.04326107e+01  0.00000000e+00]
 [-8.85606021e-03  2.02917831e-02]]
grads:  [-1.72711416e-02 -2.39704254e+01]
Stock Position:  -0.01727114164900804
Bond Position:  [5.83309711]


portfolio before change:  [4.25128393]
curr_Stock_Price:  91.62928527783038
curr_Factors:  [9.16292853e+01 4.77343441e-02]
mat_Sqrt:  [[ 2.00193411e+01  0.00000000e+00]
 [-8.73927631e-03  2.00241976e-02]]
grads:  [0.00895723 0.54748556]
Stock Position:  0.00895722979632221
Bond Position:  [3.43053936]


portfolio before change:  [4.25013322]
curr_Stock_Price:  91.45294087804115
curr_Factors:  [9.14529409e+01 4.78641825e-02]
mat_Sqrt:  [[ 2.00079687e+01  0.00000000e+00]
 [-8.75115375e-03  2.00514122e-02]]
grads:  [ 1.20916184e-03 -2.13269419e+00]
Stock Position:  0.001209161837411831
Bond Position:  [4.13955181]


portfolio before change:  [4.24919552]
curr_Stock_Price:  90.24948418688284
curr_Factors:  [9.02494842e+01 4.94252518e-02]
mat_Sqrt:  [[ 2.00640764e+01  0.00000000e+00]
 [-8.89271629e-03  2.03757728e-02]]
grads:  [1.88390501e-02 3.43796662e+01]
Stock Position:  0.01883905010839792
Bond Position:  [2.54898096]


portfolio before change:  [4.26028768]
curr_Stock_Price:  90.82135605626677
curr_Factors:  [9.08213561e+01 4.84451563e-02]
mat_Sqrt:  [[ 1.99900170e+01  0.00000000e+00]
 [-8.80410417e-03  2.01727369e-02]]
grads:  [4.60424560e-03 3.07470543e+01]
Stock Position:  0.004604245602836891
Bond Position:  [3.84212385]


portfolio before change:  [4.25364494]
curr_Stock_Price:  89.27429758049055
curr_Factors:  [8.92742976e+01 4.97200738e-02]
mat_Sqrt:  [[ 1.99063816e+01  0.00000000e+00]
 [-8.91919941e-03  2.04364532e-02]]
grads:  [-0.01562985 -1.69935412]
Stock Position:  -0.015629847130300464
Bond Position:  [5.64898857]


portfolio before change:  [4.24712978]
curr_Stock_Price:  89.73631958234098
curr_Factors:  [8.97363196e+01 4.90452521e-02]
mat_Sqrt:  [[ 1.98731513e+01  0.00000000e+00]
 [-8.85846507e-03  2.02972934e-02]]
grads:  [ 2.21903088e-03 -9.46107014e+00]
Stock Position:  0.002219030884853329
Bond Position:  [4.04800211]


portfolio before change:  [4.25114165]
curr_Stock_Price:  91.31621949163839
curr_Factors:  [9.13162195e+01 4.88923287e-02]
mat_Sqrt:  [[ 2.01914861e+01  0.00000000e+00]
 [-8.84464391e-03  2.02656251e-02]]
grads:  [-1.22345121e-03 -6.79869470e+00]
Stock Position:  -0.0012234512055662313
Bond Position:  [4.36286259]


portfolio before change:  [4.2533328]
curr_Stock_Price:  89.97104941170437
curr_Factors:  [8.99710494e+01 4.98154127e-02]
mat_Sqrt:  [[ 2.00809684e+01  0.00000000e+00]
 [-8.92774666e-03  2.04560374e-02]]
grads:  [0.02588577 2.86104959]
Stock Position:  0.02588576911845658
Bond Position:  [1.92436298]


portfolio before change:  [4.21836704]
curr_Stock_Price:  88.61098503817912
curr_Factors:  [8.86109850e+01 5.11976127e-02]
mat_Sqrt:  [[ 2.00499096e+01  0.00000000e+00]
 [-9.05075579e-03  2.07378868e-02]]
grads:  [ 0.05017582 34.36811475]
Stock Position:  0.050175824432076375
Bond Position:  [-0.22776218]


portfolio before change:  [4.16870086]
curr_Stock_Price:  87.62170949681224
curr_Factors:  [8.76217095e+01 5.06204072e-02]
mat_Sqrt:  [[ 1.97139903e+01  0.00000000e+00]
 [-8.99959174e-03  2.06206552e-02]]
grads:  [-0.04891653 31.5015569 ]
Stock Position:  -0.04891652889264286
Bond Position:  [8.45485074]


portfolio before change:  [4.12365425]
curr_Stock_Price:  88.56420327669011
curr_Factors:  [8.85642033e+01 4.90384107e-02]
mat_Sqrt:  [[ 1.96122045e+01  0.00000000e+00]
 [-8.85784721e-03  2.02958777e-02]]
grads:  [-1.09437123e-02  2.61202410e+01]
Stock Position:  -0.010943712346805665
Bond Position:  [5.09287542]


portfolio before change:  [4.11449253]
curr_Stock_Price:  89.45954641881148
curr_Factors:  [8.94595464e+01 4.90457101e-02]
mat_Sqrt:  [[ 1.98119492e+01  0.00000000e+00]
 [-8.85850643e-03  2.02973881e-02]]
grads:  [ 0.11151924 19.37445698]
Stock Position:  0.1115192385561905
Bond Position:  [-5.86196797]


portfolio before change:  [4.23907383]
curr_Stock_Price:  90.58324578244442
curr_Factors:  [9.05832458e+01 4.87181717e-02]
mat_Sqrt:  [[ 1.99937091e+01  0.00000000e+00]
 [-8.82887732e-03  2.02294993e-02]]
grads:  [8.38505195e-03 1.75083631e+01]
Stock Position:  0.008385051953068604
Bond Position:  [3.47952861]


portfolio before change:  [4.23817007]
curr_Stock_Price:  90.42358868273588
curr_Factors:  [9.04235887e+01 4.87879359e-02]
mat_Sqrt:  [[ 1.99727544e+01  0.00000000e+00]
 [-8.83519651e-03  2.02439784e-02]]
grads:  [-2.86638938e-03  1.28540883e+01]
Stock Position:  -0.0028663893796986154
Bond Position:  [4.49735928]


portfolio before change:  [4.24000896]
curr_Stock_Price:  89.97818884891224
curr_Factors:  [8.99781888e+01 4.85920716e-02]
mat_Sqrt:  [[ 1.98344405e+01  0.00000000e+00]
 [-8.81744377e-03  2.02033018e-02]]
grads:  [-0.00622653  1.3262291 ]
Stock Position:  -0.006226531170509467
Bond Position:  [4.80026096]


portfolio before change:  [4.24949305]
curr_Stock_Price:  88.55138800195239
curr_Factors:  [8.85513880e+01 4.91175561e-02]
mat_Sqrt:  [[ 1.96251845e+01  0.00000000e+00]
 [-8.86499237e-03  2.03122493e-02]]
grads:  [ 0.01171679 -4.66621809]
Stock Position:  0.01171679135422719
Bond Position:  [3.21195491]


portfolio before change:  [4.22561892]
curr_Stock_Price:  86.47951942813064
curr_Factors:  [8.64795194e+01 4.99334578e-02]
mat_Sqrt:  [[ 1.93245366e+01  0.00000000e+00]
 [-8.93831821e-03  2.04802599e-02]]
grads:  [  0.03995364 -16.03391124]
Stock Position:  0.03995363540304579
Bond Position:  [0.77044773]


portfolio before change:  [4.28268685]
curr_Stock_Price:  87.90546275508854
curr_Factors:  [8.79054628e+01 4.96334175e-02]
mat_Sqrt:  [[ 1.95840701e+01  0.00000000e+00]
 [-8.91142345e-03  2.04186363e-02]]
grads:  [ 5.11454609e-03 -7.58013317e+00]
Stock Position:  0.005114546086475815
Bond Position:  [3.83309031]


portfolio before change:  [4.2836994]
curr_Stock_Price:  88.00974939311341
curr_Factors:  [8.80097494e+01 5.14684777e-02]
mat_Sqrt:  [[ 1.99664772e+01  0.00000000e+00]
 [-9.07466607e-03  2.07926721e-02]]
grads:  [  0.04132416 -16.25473762]
Stock Position:  0.04132415578303674
Bond Position:  [0.6467708]


portfolio before change:  [4.34338268]
curr_Stock_Price:  89.45206402444192
curr_Factors:  [8.94520640e+01 5.07775661e-02]
mat_Sqrt:  [[ 2.01570190e+01  0.00000000e+00]
 [-9.01355123e-03  2.06526404e-02]]
grads:  [ -0.0493797  -17.87782542]
Stock Position:  -0.04937970281224779
Bond Position:  [8.76049902]


portfolio before change:  [4.21049713]
curr_Stock_Price:  92.16533840896619
curr_Factors:  [9.21653384e+01 4.99011545e-02]
mat_Sqrt:  [[ 2.05884152e+01  0.00000000e+00]
 [-8.93542652e-03  2.04736342e-02]]
grads:  [0.02180927 7.1035864 ]
Stock Position:  0.02180927102225665
Bond Position:  [2.20043829]


portfolio before change:  [4.21972037]
curr_Stock_Price:  92.5756301867736
curr_Factors:  [9.25756302e+01 5.13368754e-02]
mat_Sqrt:  [[ 2.09754551e+01  0.00000000e+00]
 [-9.06305691e-03  2.07660722e-02]]
grads:  [-2.97912141e-03  1.16011345e+01]
Stock Position:  -0.002979121405122324
Bond Position:  [4.49551441]


portfolio before change:  [4.22276588]
curr_Stock_Price:  91.74198124516253
curr_Factors:  [9.17419812e+01 5.11580823e-02]
mat_Sqrt:  [[ 2.07503412e+01  0.00000000e+00]
 [-9.04726101e-03  2.07298792e-02]]
grads:  [ 0.03635725 11.3251155 ]
Stock Position:  0.0363572463115083
Bond Position:  [0.88728007]


portfolio before change:  [4.22346465]
curr_Stock_Price:  91.75814995623941
curr_Factors:  [9.17581500e+01 5.09285771e-02]
mat_Sqrt:  [[ 2.07073927e+01  0.00000000e+00]
 [-9.02694430e-03  2.06833278e-02]]
grads:  [ 7.33947653e-04 -4.76649350e+00]
Stock Position:  0.0007339476529530843
Bond Position:  [4.15611897]


portfolio before change:  [4.2241905]
curr_Stock_Price:  92.03923432010589
curr_Factors:  [9.20392343e+01 5.10371890e-02]
mat_Sqrt:  [[ 2.07929625e+01  0.00000000e+00]
 [-9.03656474e-03  2.07053710e-02]]
grads:  [ 7.36567396e-03 -1.54536029e+01]
Stock Position:  0.007365673956629861
Bond Position:  [3.54625951]


portfolio before change:  [4.22152345]
curr_Stock_Price:  91.61695735598428
curr_Factors:  [9.16169574e+01 5.13349933e-02]
mat_Sqrt:  [[ 2.07578619e+01  0.00000000e+00]
 [-9.06289078e-03  2.07656915e-02]]
grads:  [0.00658032 1.85290281]
Stock Position:  0.006580319127756845
Bond Position:  [3.61865464]


portfolio before change:  [4.22868154]
curr_Stock_Price:  92.63601566077129
curr_Factors:  [9.26360157e+01 5.38710662e-02]
mat_Sqrt:  [[ 2.15009502e+01  0.00000000e+00]
 [-9.28405654e-03  2.12724459e-02]]
grads:  [4.03303380e-03 1.65775844e+01]
Stock Position:  0.0040330337997133035
Bond Position:  [3.85507736]


portfolio before change:  [4.23766225]
curr_Stock_Price:  94.74331209806302
curr_Factors:  [9.47433121e+01 5.39303168e-02]
mat_Sqrt:  [[ 2.20021463e+01  0.00000000e+00]
 [-9.28916072e-03  2.12841411e-02]]
grads:  [-0.0177431  -5.80863671]
Stock Position:  -0.01774310489773576
Bond Position:  [5.91870278]


portfolio before change:  [4.26803819]
curr_Stock_Price:  93.07302682956181
curr_Factors:  [9.30730268e+01 5.50891674e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.26803819]
Stock Price:  92.46816484362645
PL:  [4.26803819]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.44640066e+00  3.61096168e-01]
 [ 9.66998175e-01  8.02252216e-02]
 [ 9.08806700e-02 -2.13726115e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.95596437e-02  1.75773940e-01]
 [-2.07800535e-01  2.21717562e-02]
 [ 1.13366941e-01 -2.27419892e-02]
 [-4.94327041e-01  2.55814266e-01]
 [-1.18218855e-01 -9.86163750e-02]
 [ 3.15934040e-02 -1.60678460e-01]
 [-6.93765194e-02 -1.26826243e-02]
 [-6.17004967e-02 -1.41609693e-01]
 [-4.89682534e-02 -3.02585871e-02]
 [ 1.92572776e-02 -1.99845081e-01]
 [ 8.78683837e-02  3.68937124e-02]
 [ 1.06175596e-01 -8.14040525e-01]
 [ 2.40802501e-02 -1.89621485e-01]
 [ 3.56043751e-02 -1.57423470e-01]
 [-1.21562002e-01 -3.93805012e-01]
 [ 1.60220107e-02 -9.34362909e-02]
 [ 1.69093897e-01 -3.85305176e-02]
 [ 6.25285233e-01 -1.48974451e-01]
 [ 2.75311527e-02 -2.62526803e-01]
 [-2.58435225e-02  4.36172436e-02]
 [-1.51045958e-01  9.95357072e-02]
 [ 1.22995622e-01 -1.05847354e-01]
 [-4.90348627e-02 -3.53888043e-01]
 [ 5.41573252e-02  8.69550459e-02]
 [ 3.39446086e-01 -1.19171753e-01]
 [-5.12855505e-01 -2.67205282e-01]
 [ 3.64144323e-02  1.65242644e-02]
 [-8.95372479e-02  1.07039727e-01]
 [ 1.61026610e-01  2.00437771e-01]
 [ 2.90149221e-02 -1.47428635e-02]
 [ 1.75190163e-01 -1.18521223e-01]
 [ 9.87486052e-03  1.20231002e-01]
 [-4.00906914e-02 -6.87353943e-02]
 [-1.33914510e-01 -6.78853214e-02]
 [ 1.35015956e-01 -1.31747177e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.57754312]
curr_Stock_Price:  98.51084282817231
curr_Factors:  [9.85108428e+01 4.16010357e-02]
mat_Sqrt:  [[ 2.00925985e+01  0.00000000e+00]
 [-8.15853278e-03  1.86935470e-02]]
grads:  [ 0.07983019 19.31662129]
Stock Position:  0.07983018967018984
Bond Position:  [-15.44168238]


portfolio before change:  [-7.56397853]
curr_Stock_Price:  98.70494132279404
curr_Factors:  [9.87049413e+01 4.20912594e-02]
mat_Sqrt:  [[ 2.02504582e+01  0.00000000e+00]
 [-8.20646178e-03  1.88033662e-02]]
grads:  [0.04948092 4.2665351 ]
Stock Position:  0.04948092145845947
Bond Position:  [-12.44798998]


portfolio before change:  [-7.56994342]
curr_Stock_Price:  98.6158403371272
curr_Factors:  [9.86158403e+01 4.07819023e-02]
mat_Sqrt:  [[ 1.99150050e+01  0.00000000e+00]
 [-8.07781181e-03  1.85085920e-02]]
grads:  [ 0.00409505 -1.15473999]
Stock Position:  0.004095047815421101
Bond Position:  [-7.97378]


portfolio before change:  [-7.57271391]
curr_Stock_Price:  98.18270584185832
curr_Factors:  [9.81827058e+01 4.06690745e-02]
mat_Sqrt:  [[ 1.98000890e+01  0.00000000e+00]
 [-8.06662998e-03  1.84829712e-02]]
grads:  [-8.23297662e-04 -8.19061018e+00]
Stock Position:  -0.000823297662478238
Bond Position:  [-7.49188032]


portfolio before change:  [-7.57475717]
curr_Stock_Price:  99.52694562912451
curr_Factors:  [9.95269456e+01 3.97474365e-02]
mat_Sqrt:  [[ 1.98424474e+01  0.00000000e+00]
 [-7.97470365e-03  1.82723416e-02]]
grads:  [-1.43410079e-04  9.61967241e+00]
Stock Position:  -0.0001434100789307157
Bond Position:  [-7.560484]


portfolio before change:  [-7.57582318]
curr_Stock_Price:  100.3699269533655
curr_Factors:  [1.00369927e+02 3.88444853e-02]
mat_Sqrt:  [[ 1.97819133e+01  0.00000000e+00]
 [-7.88360174e-03  1.80636009e-02]]
grads:  [-0.01001541  1.22742727]
Stock Position:  -0.010015410762681481
Bond Position:  [-6.57057713]


portfolio before change:  [-7.5801736]
curr_Stock_Price:  100.72228855589995
curr_Factors:  [1.00722289e+02 3.87445974e-02]
mat_Sqrt:  [[ 1.98258201e+01  0.00000000e+00]
 [-7.87345895e-03  1.80403608e-02]]
grads:  [ 0.00521752 -1.2606172 ]
Stock Position:  0.005217515457069348
Bond Position:  [-8.1056937]


portfolio before change:  [-7.57153252]
curr_Stock_Price:  102.572661425576
curr_Factors:  [1.02572661e+02 3.79412302e-02]
mat_Sqrt:  [[ 1.99796248e+01  0.00000000e+00]
 [-7.79140349e-03  1.78523481e-02]]
grads:  [-0.01915354 14.32944642]
Stock Position:  -0.01915353996563905
Bond Position:  [-5.60690295]


portfolio before change:  [-7.57509205]
curr_Stock_Price:  102.72190915008487
curr_Factors:  [1.02721909e+02 3.72132399e-02]
mat_Sqrt:  [[ 1.98158097e+01  0.00000000e+00]
 [-7.71629340e-03  1.76802493e-02]]
grads:  [-0.00813787 -5.57777062]
Stock Position:  -0.008137874341030596
Bond Position:  [-6.73915406]


portfolio before change:  [-7.56498851]
curr_Stock_Price:  101.3768413718045
curr_Factors:  [1.01376841e+02 3.89085165e-02]
mat_Sqrt:  [[ 1.99968271e+01  0.00000000e+00]
 [-7.89009673e-03  1.80784827e-02]]
grads:  [-1.92692695e-03 -8.88782882e+00]
Stock Position:  -0.00192692694889971
Bond Position:  [-7.36964274]


portfolio before change:  [-7.568831]
curr_Stock_Price:  102.89284523176757
curr_Factors:  [1.02892845e+02 3.89125185e-02]
mat_Sqrt:  [[ 2.02969063e+01  0.00000000e+00]
 [-7.89050250e-03  1.80794125e-02]]
grads:  [-0.00369079 -0.70149538]
Stock Position:  -0.0036907925408191573
Bond Position:  [-7.18907485]


portfolio before change:  [-7.56941263]
curr_Stock_Price:  102.80694057447965
curr_Factors:  [1.02806941e+02 3.78221872e-02]
mat_Sqrt:  [[ 1.99938190e+01  0.00000000e+00]
 [-7.77917088e-03  1.78243197e-02]]
grads:  [-6.17711073e-03 -7.94474602e+00]
Stock Position:  -0.006177110727290765
Bond Position:  [-6.93436278]


portfolio before change:  [-7.57982367]
curr_Stock_Price:  104.35203039602368
curr_Factors:  [1.04352030e+02 3.75774299e-02]
mat_Sqrt:  [[ 2.02285354e+01  0.00000000e+00]
 [-7.75395950e-03  1.77665532e-02]]
grads:  [-0.00307359 -1.70312085]
Stock Position:  -0.0030735879859899633
Bond Position:  [-7.25908853]


portfolio before change:  [-7.57654951]
curr_Stock_Price:  102.99153492381426
curr_Factors:  [1.02991535e+02 3.83339025e-02]
mat_Sqrt:  [[ 2.01647595e+01  0.00000000e+00]
 [-7.83161822e-03  1.79444917e-02]]
grads:  [-3.37034847e-03 -1.11368483e+01]
Stock Position:  -0.0033703484675338736
Bond Position:  [-7.22943215]


portfolio before change:  [-7.57921852]
curr_Stock_Price:  103.51529990069182
curr_Factors:  [1.03515300e+02 3.74341079e-02]
mat_Sqrt:  [[ 2.00280326e+01  0.00000000e+00]
 [-7.73915839e-03  1.77326396e-02]]
grads:  [0.00519123 2.0805539 ]
Stock Position:  0.005191229821648053
Bond Position:  [-8.11659023]


portfolio before change:  [-7.57599756]
curr_Stock_Price:  104.33121316933189
curr_Factors:  [1.04331213e+02 3.86163478e-02]
mat_Sqrt:  [[ 2.05021712e+01  0.00000000e+00]
 [-7.86041706e-03  1.80104781e-02]]
grads:  [-1.21499725e-02 -4.51981630e+01]
Stock Position:  -0.012149972486597199
Bond Position:  [-6.30837619]


portfolio before change:  [-7.56675519]
curr_Stock_Price:  103.5056170872317
curr_Factors:  [1.03505617e+02 3.89171132e-02]
mat_Sqrt:  [[ 2.04189886e+01  0.00000000e+00]
 [-7.89096832e-03  1.80804798e-02]]
grads:  [-2.87366586e-03 -1.04876356e+01]
Stock Position:  -0.0028736658611129054
Bond Position:  [-7.26931463]


portfolio before change:  [-7.56894976]
curr_Stock_Price:  103.95307527531816
curr_Factors:  [1.03953075e+02 3.95346131e-02]
mat_Sqrt:  [[ 2.06693152e+01  0.00000000e+00]
 [-7.95332515e-03  1.82233573e-02]]
grads:  [-1.60144929e-03 -8.63855480e+00]
Stock Position:  -0.0016014492863632257
Bond Position:  [-7.40247418]


portfolio before change:  [-7.57019497]
curr_Stock_Price:  104.1527978765361
curr_Factors:  [1.04152798e+02 4.03100581e-02]
mat_Sqrt:  [[ 2.09111373e+01  0.00000000e+00]
 [-8.03094595e-03  1.84012089e-02]]
grads:  [-1.40323597e-02 -2.14010403e+01]
Stock Position:  -0.014032359666505697
Bond Position:  [-6.10868545]


portfolio before change:  [-7.54134238]
curr_Stock_Price:  102.04223159092798
curr_Factors:  [1.02042232e+02 4.04872528e-02]
mat_Sqrt:  [[ 2.05323710e+01  0.00000000e+00]
 [-8.04857780e-03  1.84416085e-02]]
grads:  [-1.20575115e-03 -5.06660202e+00]
Stock Position:  -0.001205751145879516
Bond Position:  [-7.41830484]


portfolio before change:  [-7.54155206]
curr_Stock_Price:  101.44703297402805
curr_Factors:  [1.01447033e+02 4.03224898e-02]
mat_Sqrt:  [[ 2.03710315e+01  0.00000000e+00]
 [-8.03218424e-03  1.84040461e-02]]
grads:  [ 0.00747521 -2.09358949]
Stock Position:  0.007475213063491017
Bond Position:  [-8.29989025]


portfolio before change:  [-7.54300549]
curr_Stock_Price:  101.39139829436002
curr_Factors:  [1.01391398e+02 4.07130324e-02]
mat_Sqrt:  [[ 2.04582197e+01  0.00000000e+00]
 [-8.07098828e-03  1.84929574e-02]]
grads:  [ 0.02738593 -8.05573971]
Stock Position:  0.027385933896528755
Bond Position:  [-10.31970363]


portfolio before change:  [-7.56639665]
curr_Stock_Price:  100.58437412733946
curr_Factors:  [1.00584374e+02 4.08767652e-02]
mat_Sqrt:  [[ 2.03361519e+01  0.00000000e+00]
 [-8.08720127e-03  1.85301060e-02]]
grads:  [-4.28030522e-03 -1.41675824e+01]
Stock Position:  -0.0042803052161111835
Bond Position:  [-7.13586483]


portfolio before change:  [-7.56326317]
curr_Stock_Price:  99.6439001511503
curr_Factors:  [9.96439002e+01 3.94117296e-02]
mat_Sqrt:  [[ 1.97816933e+01  0.00000000e+00]
 [-7.94095507e-03  1.81950138e-02]]
grads:  [-3.44126086e-04  2.39720860e+00]
Stock Position:  -0.0003441260863568364
Bond Position:  [-7.52897311]


portfolio before change:  [-7.56373476]
curr_Stock_Price:  98.2792941894628
curr_Factors:  [9.82792942e+01 3.98448467e-02]
mat_Sqrt:  [[ 1.96177009e+01  0.00000000e+00]
 [-7.98446959e-03  1.82947181e-02]]
grads:  [-0.0054851  5.44068  ]
Stock Position:  -0.005485098080026075
Bond Position:  [-7.02466319]


portfolio before change:  [-7.56669389]
curr_Stock_Price:  98.6586844261455
curr_Factors:  [9.86586844e+01 3.92831579e-02]
mat_Sqrt:  [[ 1.95541308e+01  0.00000000e+00]
 [-7.92799171e-03  1.81653111e-02]]
grads:  [ 3.92756140e-03 -5.82689468e+00]
Stock Position:  0.003927561399516901
Bond Position:  [-7.95418193]


portfolio before change:  [-7.5672088]
curr_Stock_Price:  98.78075006356232
curr_Factors:  [9.87807501e+01 3.92701441e-02]
mat_Sqrt:  [[ 1.95750810e+01  0.00000000e+00]
 [-7.92667841e-03  1.81623019e-02]]
grads:  [-1.03950664e-02 -1.94847572e+01]
Stock Position:  -0.010395066426243714
Bond Position:  [-6.54037634]


portfolio before change:  [-7.56040674]
curr_Stock_Price:  98.04774274340446
curr_Factors:  [9.80477427e+01 4.07815579e-02]
mat_Sqrt:  [[ 1.98001968e+01  0.00000000e+00]
 [-8.07777771e-03  1.85085139e-02]]
grads:  [4.65185370e-03 4.69811063e+00]
Stock Position:  0.004651853698609374
Bond Position:  [-8.01651049]


portfolio before change:  [-7.56826869]
curr_Stock_Price:  96.57309956729118
curr_Factors:  [9.65730996e+01 4.09909261e-02]
mat_Sqrt:  [[ 1.95523983e+01  0.00000000e+00]
 [-8.09848638e-03  1.85559634e-02]]
grads:  [ 0.01470077 -6.42228862]
Stock Position:  0.01470076790048196
Bond Position:  [-8.98796741]


portfolio before change:  [-7.59712242]
curr_Stock_Price:  94.68679252556979
curr_Factors:  [9.46867925e+01 4.19549937e-02]
mat_Sqrt:  [[ 1.93946182e+01  0.00000000e+00]
 [-8.19316727e-03  1.87729046e-02]]
grads:  [ -0.03245609 -14.23356095]
Stock Position:  -0.03245608875264316
Bond Position:  [-4.52395948]


portfolio before change:  [-7.6323489]
curr_Stock_Price:  95.75472624494027
curr_Factors:  [9.57547262e+01 4.11001137e-02]
mat_Sqrt:  [[ 1.94125117e+01  0.00000000e+00]
 [-8.10926519e-03  1.85806608e-02]]
grads:  [0.00224732 0.88932598]
Stock Position:  0.0022473244660611126
Bond Position:  [-7.84754084]


portfolio before change:  [-7.63481847]
curr_Stock_Price:  95.0923538767811
curr_Factors:  [9.50923539e+01 4.27299727e-02]
mat_Sqrt:  [[ 1.96567587e+01  0.00000000e+00]
 [-8.26849178e-03  1.89454947e-02]]
grads:  [-2.17845078e-03  5.64987764e+00]
Stock Position:  -0.002178450775167383
Bond Position:  [-7.42766446]


portfolio before change:  [-7.63893738]
curr_Stock_Price:  96.55687919835486
curr_Factors:  [9.65568792e+01 4.18484545e-02]
mat_Sqrt:  [[ 1.97525392e+01  0.00000000e+00]
 [-8.18275792e-03  1.87490538e-02]]
grads:  [ 0.01258091 10.69055395]
Stock Position:  0.01258090530974296
Bond Position:  [-8.85371034]


portfolio before change:  [-7.65183281]
curr_Stock_Price:  95.61985278997281
curr_Factors:  [9.56198528e+01 4.25848841e-02]
mat_Sqrt:  [[ 1.97322135e+01  0.00000000e+00]
 [-8.25444211e-03  1.89133029e-02]]
grads:  [ 0.00114435 -0.77949703]
Stock Position:  0.0011443525562329388
Bond Position:  [-7.76125563]


portfolio before change:  [-7.65241961]
curr_Stock_Price:  95.9549017996783
curr_Factors:  [9.59549018e+01 4.13169729e-02]
mat_Sqrt:  [[ 1.95043469e+01  0.00000000e+00]
 [-8.13063076e-03  1.86296155e-02]]
grads:  [ 6.33003819e-03 -6.36197902e+00]
Stock Position:  0.006330038190339038
Bond Position:  [-8.2598178]


portfolio before change:  [-7.64961765]
curr_Stock_Price:  96.56066455216119
curr_Factors:  [9.65606646e+01 4.13548913e-02]
mat_Sqrt:  [[ 1.96364822e+01  0.00000000e+00]
 [-8.13436083e-03  1.86381621e-02]]
grads:  [3.17510902e-03 6.45079709e+00]
Stock Position:  0.0031751090205268907
Bond Position:  [-7.95620829]


portfolio before change:  [-7.64756684]
curr_Stock_Price:  97.51981253844161
curr_Factors:  [9.75198125e+01 4.06072447e-02]
mat_Sqrt:  [[ 1.96514508e+01  0.00000000e+00]
 [-8.06049574e-03  1.84689159e-02]]
grads:  [-3.56662098e-03 -3.72167996e+00]
Stock Position:  -0.003566620981506761
Bond Position:  [-7.29975063]


portfolio before change:  [-7.6492115]
curr_Stock_Price:  97.72508681783803
curr_Factors:  [9.77250868e+01 4.05358027e-02]
mat_Sqrt:  [[ 1.96754853e+01  0.00000000e+00]
 [-8.05340203e-03  1.84526622e-02]]
grads:  [-0.00831197 -3.67889038]
Stock Position:  -0.00831197252006923
Bond Position:  [-6.83692326]


portfolio before change:  [-7.6543229]
curr_Stock_Price:  98.23720789959692
curr_Factors:  [9.82372079e+01 4.08759759e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.6543229]
Stock Price:  100.36421300767225
PL:  [-8.01853591]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48169711e+00  3.64367644e-01]
 [ 9.23930951e-01  8.53623900e-02]
 [ 3.61203278e-02  3.99953372e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.05361056e-02  4.46066005e-01]
 [ 2.40643999e-02 -3.48578645e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.12924970e+00  1.15432483e+00]
 [ 9.77926410e-02  5.93712950e-01]
 [ 1.04321445e-01 -5.15958073e-02]
 [ 3.91324092e-03  1.91099311e-02]
 [ 5.09868565e-02 -8.40050934e-02]
 [-4.42234155e-02  2.59283738e-01]
 [-1.60964051e-01  5.62920749e-01]
 [-4.85893904e-02  7.45916423e-02]
 [ 1.29532408e-01 -1.53246702e-01]
 [ 3.73674181e-02 -4.81226935e-02]
 [ 3.65024440e-01  6.32804274e-02]
 [ 3.93441028e-01  4.05933205e-01]
 [-7.94831893e-01  3.87290564e-01]
 [-2.23540423e-01  3.52312031e-01]
 [ 1.82125719e+00  2.78940371e-01]
 [ 1.52234965e-02  4.39435171e-01]
 [-1.51035697e-01  1.82388988e-01]
 [-1.73290748e-01  8.77099086e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 2.03750624e-01 -4.45751372e-01]
 [ 1.10935689e-01 -3.39111578e-02]
 [ 6.60542688e-01 -3.14215531e-01]
 [-6.33909079e-01 -3.21258450e-01]
 [ 6.52748701e-01  2.43743597e-01]
 [-2.28223529e-01  3.44389419e-01]
 [ 8.75793643e-01  1.53692745e-01]
 [ 7.13601857e-02 -1.85526446e-01]
 [ 3.04861159e-01 -4.97172468e-01]
 [ 1.32849319e-01  2.20142789e-02]
 [-7.65811353e-02  5.05011305e-01]
 [-3.88253732e-01 -1.43776708e-01]
 [-1.20958057e-01  5.56572642e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.78808029]
curr_Stock_Price:  99.06090217196036
curr_Factors:  [9.90609022e+01 3.94634987e-02]
mat_Sqrt:  [[ 1.96788662e+01  0.00000000e+00]
 [-7.94616876e-03  1.82069599e-02]]
grads:  [ 0.08337473 20.01254717]
Stock Position:  0.0833747315232108
Bond Position:  [-12.04725642]


portfolio before change:  [-3.80696429]
curr_Stock_Price:  98.85246975133575
curr_Factors:  [9.88524698e+01 3.81268856e-02]
mat_Sqrt:  [[ 1.93020391e+01  0.00000000e+00]
 [-7.81044282e-03  1.78959727e-02]]
grads:  [0.04979713 4.76992178]
Stock Position:  0.04979713020727055
Bond Position:  [-8.7295336]


portfolio before change:  [-3.84752774]
curr_Stock_Price:  98.0598098448269
curr_Factors:  [9.80598098e+01 3.85056026e-02]
mat_Sqrt:  [[ 1.9242124e+01  0.0000000e+00]
 [-7.8491378e-03  1.7984634e-02]]
grads:  [0.00278429 2.22386161]
Stock Position:  0.002784293666170596
Bond Position:  [-4.12055505]


portfolio before change:  [-3.84569798]
curr_Stock_Price:  98.90198681937261
curr_Factors:  [9.89019868e+01 3.87690335e-02]
mat_Sqrt:  [[ 1.94736564e+01  0.00000000e+00]
 [-7.87594144e-03  1.80460489e-02]]
grads:  [-8.37098417e-04 -8.38891733e+00]
Stock Position:  -0.000837098416994192
Bond Position:  [-3.76290728]


portfolio before change:  [-3.8456754]
curr_Stock_Price:  98.3130832086129
curr_Factors:  [9.83130832e+01 3.78589882e-02]
mat_Sqrt:  [[ 1.91291564e+01  0.00000000e+00]
 [-7.78295453e-03  1.78329891e-02]]
grads:  [5.44420556e-03 2.50135298e+01]
Stock Position:  0.0054442055575745435
Bond Position:  [-4.38091203]


portfolio before change:  [-3.85410557]
curr_Stock_Price:  96.86520966015814
curr_Factors:  [9.68652097e+01 3.75808506e-02]
mat_Sqrt:  [[ 1.87780774e+01  0.00000000e+00]
 [-7.75431241e-03  1.77673618e-02]]
grads:  [ 4.71357123e-04 -1.96190436e+00]
Stock Position:  0.0004713571234636224
Bond Position:  [-3.89976367]


portfolio before change:  [-3.85438976]
curr_Stock_Price:  97.2965317156973
curr_Factors:  [9.72965317e+01 3.92208684e-02]
mat_Sqrt:  [[ 1.92688574e+01  0.00000000e+00]
 [-7.92170370e-03  1.81509034e-02]]
grads:  [0.00671414 5.29653455]
Stock Position:  0.006714138502849047
Bond Position:  [-4.50765215]


portfolio before change:  [-3.86480384]
curr_Stock_Price:  95.82939067146832
curr_Factors:  [9.58293907e+01 3.97437509e-02]
mat_Sqrt:  [[ 1.91043890e+01  0.00000000e+00]
 [-7.97433392e-03  1.82714944e-02]]
grads:  [ 0.08547975 63.17626825]
Stock Position:  0.08547974799298623
Bond Position:  [-12.05627601]


portfolio before change:  [-3.92860787]
curr_Stock_Price:  95.1005993492025
curr_Factors:  [9.51005993e+01 3.90753019e-02]
mat_Sqrt:  [[ 1.8798986e+01  0.0000000e+00]
 [-7.9069895e-03  1.8117189e-02]]
grads:  [1.89856099e-02 3.27706992e+01]
Stock Position:  0.018985609918386475
Bond Position:  [-5.73415075]


portfolio before change:  [-3.92121548]
curr_Stock_Price:  95.52772303028168
curr_Factors:  [9.55277230e+01 3.87699128e-02]
mat_Sqrt:  [[ 1.88094821e+01  0.00000000e+00]
 [-7.87603076e-03  1.80462536e-02]]
grads:  [ 0.00434904 -2.85908691]
Stock Position:  0.0043490399382994085
Bond Position:  [-4.33666936]


portfolio before change:  [-3.92203854]
curr_Stock_Price:  95.46312499966781
curr_Factors:  [9.54631250e+01 3.88445449e-02]
mat_Sqrt:  [[ 1.88148459e+01  0.00000000e+00]
 [-7.88360779e-03  1.80636147e-02]]
grads:  [6.51267551e-04 1.05792397e+00]
Stock Position:  0.0006512675509178518
Bond Position:  [-3.98421057]


portfolio before change:  [-3.92336277]
curr_Stock_Price:  94.19456103104885
curr_Factors:  [9.41945610e+01 3.99111976e-02]
mat_Sqrt:  [[ 1.88179888e+01  0.00000000e+00]
 [-7.99111483e-03  1.83099443e-02]]
grads:  [ 7.61188036e-04 -4.58794915e+00]
Stock Position:  0.0007611880362885806
Bond Position:  [-3.99506254]


portfolio before change:  [-3.92417513]
curr_Stock_Price:  93.78342690798215
curr_Factors:  [9.37834269e+01 3.89179681e-02]
mat_Sqrt:  [[ 1.85012545e+01  0.00000000e+00]
 [-7.89105500e-03  1.80806784e-02]]
grads:  [3.72608707e-03 1.43403766e+01]
Stock Position:  0.0037260870667837607
Bond Position:  [-4.27362035]


portfolio before change:  [-3.93079072]
curr_Stock_Price:  92.15132588965821
curr_Factors:  [9.21513259e+01 4.04193918e-02]
mat_Sqrt:  [[ 1.85266320e+01  0.00000000e+00]
 [-8.04182982e-03  1.84261469e-02]]
grads:  [4.57259072e-03 3.05501064e+01]
Stock Position:  0.004572590719776116
Bond Position:  [-4.35216102]


portfolio before change:  [-3.93263636]
curr_Stock_Price:  91.8666755706071
curr_Factors:  [9.18666756e+01 3.87822278e-02]
mat_Sqrt:  [[ 1.80914917e+01  0.00000000e+00]
 [-7.87728154e-03  1.80491195e-02]]
grads:  [-8.86324305e-04  4.13270257e+00]
Stock Position:  -0.0008863243054426802
Bond Position:  [-3.85121269]


portfolio before change:  [-3.9329019]
curr_Stock_Price:  91.62309404435409
curr_Factors:  [9.16230940e+01 3.87068896e-02]
mat_Sqrt:  [[ 1.80259885e+01  0.00000000e+00]
 [-7.86962663e-03  1.80315799e-02]]
grads:  [ 3.47554109e-03 -8.49879506e+00]
Stock Position:  0.0034755410859172615
Bond Position:  [-4.25134173]


portfolio before change:  [-3.9285139]
curr_Stock_Price:  93.03854448544224
curr_Factors:  [9.30385445e+01 3.77407382e-02]
mat_Sqrt:  [[ 1.80745754e+01  0.00000000e+00]
 [-7.77079025e-03  1.78051173e-02]]
grads:  [ 9.0541285e-04 -2.7027451e+00]
Stock Position:  0.0009054128500636141
Bond Position:  [-4.01275219]


portfolio before change:  [-3.92935638]
curr_Stock_Price:  92.66207423275578
curr_Factors:  [9.26620742e+01 3.69193661e-02]
mat_Sqrt:  [[ 1.78044735e+01  0.00000000e+00]
 [-7.68576514e-03  1.76103003e-02]]
grads:  [0.02205301 3.59337583]
Stock Position:  0.022053012875436012
Bond Position:  [-5.9728343]


portfolio before change:  [-3.93538721]
curr_Stock_Price:  92.42246176729576
curr_Factors:  [9.24224618e+01 3.46225165e-02]
mat_Sqrt:  [[ 1.71971646e+01  0.00000000e+00]
 [-7.44285069e-03  1.70537133e-02]]
grads:  [ 0.03318017 23.80321498]
Stock Position:  0.033180167597944364
Bond Position:  [-7.00197998]


portfolio before change:  [-3.94134632]
curr_Stock_Price:  92.26924348490965
curr_Factors:  [9.22692435e+01 3.51009606e-02]
mat_Sqrt:  [[ 1.72868738e+01  0.00000000e+00]
 [-7.49410014e-03  1.71711406e-02]]
grads:  [-0.03620113 22.55473727]
Stock Position:  -0.03620113399918879
Bond Position:  [-0.60109507]


portfolio before change:  [-3.89876422]
curr_Stock_Price:  91.0909034035396
curr_Factors:  [9.10909034e+01 3.61356964e-02]
mat_Sqrt:  [[ 1.73158264e+01  0.00000000e+00]
 [-7.60375658e-03  1.74223951e-02]]
grads:  [-4.02977286e-03  2.02217909e+01]
Stock Position:  -0.004029772855372883
Bond Position:  [-3.53168857]


portfolio before change:  [-3.90356757]
curr_Stock_Price:  92.17331333943699
curr_Factors:  [9.21733133e+01 3.63756771e-02]
mat_Sqrt:  [[ 1.75796710e+01  0.00000000e+00]
 [-7.62896345e-03  1.74801512e-02]]
grads:  [ 0.11052521 15.95754908]
Stock Position:  0.1105252058501448
Bond Position:  [-14.091042]


portfolio before change:  [-3.71508229]
curr_Stock_Price:  93.8946108900411
curr_Factors:  [9.38946109e+01 3.32982926e-02]
mat_Sqrt:  [[ 1.71337194e+01  0.00000000e+00]
 [-7.29912791e-03  1.67244031e-02]]
grads:  [1.20819493e-02 2.62750885e+01]
Stock Position:  0.01208194926927406
Bond Position:  [-4.84951222]


portfolio before change:  [-3.71841477]
curr_Stock_Price:  93.66896446379428
curr_Factors:  [9.36689645e+01 3.48621545e-02]
mat_Sqrt:  [[ 1.74893162e+01  0.00000000e+00]
 [-7.46856393e-03  1.71126298e-02]]
grads:  [-4.08447165e-03  1.06581508e+01]
Stock Position:  -0.0040844716529595025
Bond Position:  [-3.33582654]


portfolio before change:  [-3.7157927]
curr_Stock_Price:  92.92490923792224
curr_Factors:  [9.29249092e+01 3.37260847e-02]
mat_Sqrt:  [[ 1.70653464e+01  0.00000000e+00]
 [-7.34586519e-03  1.68314916e-02]]
grads:  [-0.00791141  5.21105974]
Stock Position:  -0.007911413124749628
Bond Position:  [-2.98062536]


portfolio before change:  [-3.71069075]
curr_Stock_Price:  92.23292747947315
curr_Factors:  [9.22329275e+01 3.34199777e-02]
mat_Sqrt:  [[ 1.68612230e+01  0.00000000e+00]
 [-7.31245268e-03  1.67549340e-02]]
grads:  [ 0.01088169 -4.3566592 ]
Stock Position:  0.010881690091136629
Bond Position:  [-4.71434088]


portfolio before change:  [-3.7022842]
curr_Stock_Price:  93.05962659173444
curr_Factors:  [9.30596266e+01 3.26484523e-02]
mat_Sqrt:  [[ 1.68148348e+01  0.00000000e+00]
 [-7.22755309e-03  1.65604046e-02]]
grads:  [ 5.47657832e-04 -2.69166958e+01]
Stock Position:  0.0005476578319874581
Bond Position:  [-3.75324903]


portfolio before change:  [-3.70289987]
curr_Stock_Price:  92.79213673927084
curr_Factors:  [9.27921367e+01 3.16437468e-02]
mat_Sqrt:  [[ 1.65065049e+01  0.00000000e+00]
 [-7.11547573e-03  1.63036031e-02]]
grads:  [ 0.00582411 -2.07997936]
Stock Position:  0.005824106748386484
Bond Position:  [-4.24333118]


portfolio before change:  [-3.70597638]
curr_Stock_Price:  92.35497829394289
curr_Factors:  [9.23549783e+01 3.05304438e-02]
mat_Sqrt:  [[ 1.61371512e+01  0.00000000e+00]
 [-6.98918522e-03  1.60142352e-02]]
grads:  [  0.03243496 -19.62101393]
Stock Position:  0.03243495582241735
Bond Position:  [-6.70150602]


portfolio before change:  [-3.71000474]
curr_Stock_Price:  92.25660842712813
curr_Factors:  [9.22566084e+01 3.16403367e-02]
mat_Sqrt:  [[ 1.64103571e+01  0.00000000e+00]
 [-7.11509232e-03  1.63027246e-02]]
grads:  [ -0.04717251 -19.70581349]
Stock Position:  -0.04717251146981785
Bond Position:  [0.64197118]


portfolio before change:  [-3.61105791]
curr_Stock_Price:  90.16075681682422
curr_Factors:  [9.01607568e+01 3.28210372e-02]
mat_Sqrt:  [[ 1.63340432e+01  0.00000000e+00]
 [-7.24663091e-03  1.66041173e-02]]
grads:  [ 0.04647515 14.67970818]
Stock Position:  0.046475151271909536
Bond Position:  [-7.80129272]


portfolio before change:  [-3.58935296]
curr_Stock_Price:  90.64876327855288
curr_Factors:  [9.06487633e+01 3.22399021e-02]
mat_Sqrt:  [[ 1.62764145e+01  0.00000000e+00]
 [-7.18218932e-03  1.64564631e-02]]
grads:  [-4.78727454e-03  2.09273048e+01]
Stock Position:  -0.00478727453568038
Bond Position:  [-3.15539244]


portfolio before change:  [-3.5836714]
curr_Stock_Price:  89.3795630638328
curr_Factors:  [8.93795631e+01 3.20483790e-02]
mat_Sqrt:  [[ 1.60007839e+01  0.00000000e+00]
 [-7.16082442e-03  1.64075100e-02]]
grads:  [0.05892653 9.36721934]
Stock Position:  0.0589265288175417
Bond Position:  [-8.85049879]


portfolio before change:  [-3.62939498]
curr_Stock_Price:  88.62239645580999
curr_Factors:  [8.86223965e+01 3.35396433e-02]
mat_Sqrt:  [[ 1.62301566e+01  0.00000000e+00]
 [-7.32553270e-03  1.67849040e-02]]
grads:  [-5.92119591e-04 -1.10531729e+01]
Stock Position:  -0.0005921195910592109
Bond Position:  [-3.57691992]


portfolio before change:  [-3.63016189]
curr_Stock_Price:  89.16243833659738
curr_Factors:  [8.91624383e+01 3.33208477e-02]
mat_Sqrt:  [[ 1.62757105e+01  0.00000000e+00]
 [-7.30159958e-03  1.67300664e-02]]
grads:  [ 5.39929147e-03 -2.97173040e+01]
Stock Position:  0.005399291469268211
Bond Position:  [-4.11157588]


portfolio before change:  [-3.62270573]
curr_Stock_Price:  90.63858397579334
curr_Factors:  [9.06385840e+01 3.17520297e-02]
mat_Sqrt:  [[ 1.61509792e+01  0.00000000e+00]
 [-7.12763969e-03  1.63314742e-02]]
grads:  [0.00882034 1.34796643]
Stock Position:  0.008820340626420413
Bond Position:  [-4.42216891]


portfolio before change:  [-3.62092686]
curr_Stock_Price:  90.90293554141977
curr_Factors:  [9.09029355e+01 3.07726454e-02]
mat_Sqrt:  [[ 1.59463145e+01  0.00000000e+00]
 [-7.01685347e-03  1.60776311e-02]]
grads:  [9.01925445e-03 3.14108031e+01]
Stock Position:  0.009019254445918992
Bond Position:  [-4.44080357]


portfolio before change:  [-3.62666916]
curr_Stock_Price:  90.32781442341476
curr_Factors:  [9.03278144e+01 3.12690218e-02]
mat_Sqrt:  [[ 1.59727116e+01  0.00000000e+00]
 [-7.07321956e-03  1.62067820e-02]]
grads:  [-0.02823585 -8.8713915 ]
Stock Position:  -0.02823584642635444
Bond Position:  [-1.07618687]


portfolio before change:  [-3.63994718]
curr_Stock_Price:  90.79330393261617
curr_Factors:  [9.07933039e+01 3.21622289e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.63994718]
Stock Price:  90.8459864210094
PL:  [-3.63994718]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48077129e+00  3.64199041e-01]
 [ 6.31446537e-01  1.13905540e-01]
 [ 1.03931444e-01 -4.55333552e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.16493189e-02  1.66203244e-01]
 [-2.01651546e-01  1.55497502e-02]
 [ 8.80391739e-02  9.40149827e-02]
 [ 5.50284705e-01  5.98883661e-01]
 [-2.66565300e-02  2.61166045e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-7.79308716e-02  1.23969213e-02]
 [ 2.81057840e-02 -1.34803955e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-1.27020678e-01  2.46739802e-01]
 [ 1.68521900e-01  1.70578928e-01]
 [ 1.31452827e-01 -1.07343225e-01]
 [ 3.74589784e-02 -4.38034823e-02]
 [ 4.17696424e-01  6.13139710e-02]
 [ 5.71420246e-01  5.87021110e-01]
 [-9.78185397e-01  4.93333534e-01]
 [-2.51690051e-01  3.74813256e-01]
 [ 1.80156583e+00  2.68836453e-01]
 [ 1.41394659e-02  3.96539938e-01]
 [-1.61179791e-01  2.22298403e-01]
 [-1.73703297e-01  8.85180241e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 1.58769651e-01 -4.46949463e-01]
 [ 1.13047917e-01 -3.84075340e-02]
 [ 6.98962375e-01 -3.16857941e-01]
 [-6.28085653e-01 -3.19863885e-01]
 [ 3.14834912e-01  1.19268566e-01]
 [-1.43225817e-01  1.99004113e-01]
 [ 5.18013738e-01  2.31930890e-01]
 [ 4.64942467e-02 -3.86916846e-02]
 [ 2.60974018e-01 -2.22636587e-01]
 [ 1.10214698e-01  5.05707965e-02]
 [-6.54784407e-02  3.25796658e-01]
 [-3.56320167e-01 -1.36202342e-01]
 [ 2.40854328e-02  4.09992183e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.81594097]
curr_Stock_Price:  99.05685805723868
curr_Factors:  [9.90568581e+01 3.93214053e-02]
mat_Sqrt:  [[ 1.96426041e+01  0.00000000e+00]
 [-7.93185026e-03  1.81741521e-02]]
grads:  [ 0.08347777 20.03939655]
Stock Position:  0.08347776955911637
Bond Position:  [-12.08498654]


portfolio before change:  [-3.77960137]
curr_Stock_Price:  99.51027596276288
curr_Factors:  [9.95102760e+01 3.87275828e-02]
mat_Sqrt:  [[ 1.95829505e+01  0.00000000e+00]
 [-7.87172996e-03  1.80363992e-02]]
grads:  [0.03478327 6.31531486]
Stock Position:  0.03478326667999607
Bond Position:  [-7.24089383]


portfolio before change:  [-3.79893604]
curr_Stock_Price:  98.98043762177375
curr_Factors:  [9.89804376e+01 3.81286601e-02]
mat_Sqrt:  [[ 1.93274760e+01  0.00000000e+00]
 [-7.81062457e-03  1.78963892e-02]]
grads:  [ 0.0043492 -2.5442761]
Stock Position:  0.004349200030212688
Bond Position:  [-4.22942177]


portfolio before change:  [-3.79488432]
curr_Stock_Price:  100.03360438870577
curr_Factors:  [1.00033604e+02 3.69276856e-02]
mat_Sqrt:  [[ 1.92230352e+01  0.00000000e+00]
 [-7.68663105e-03  1.76122843e-02]]
grads:  [-8.48012125e-04 -8.59552399e+00]
Stock Position:  -0.0008480121245459537
Bond Position:  [-3.71005461]


portfolio before change:  [-3.79512436]
curr_Stock_Price:  99.76975752400627
curr_Factors:  [9.97697575e+01 3.71278770e-02]
mat_Sqrt:  [[ 1.92242309e+01  0.00000000e+00]
 [-7.70743818e-03  1.76599594e-02]]
grads:  [-4.73999525e-04  9.41130385e+00]
Stock Position:  -0.0004739995250778372
Bond Position:  [-3.74783355]


portfolio before change:  [-3.79584616]
curr_Stock_Price:  100.3041138911048
curr_Factors:  [1.00304114e+02 3.74051746e-02]
mat_Sqrt:  [[ 1.93992343e+01  0.00000000e+00]
 [-7.73616696e-03  1.77257854e-02]]
grads:  [-0.01004499  0.877239  ]
Stock Position:  -0.010044988147801187
Bond Position:  [-2.78829252]


portfolio before change:  [-3.78847264]
curr_Stock_Price:  99.53536468279998
curr_Factors:  [9.95353647e+01 3.82892290e-02]
mat_Sqrt:  [[ 1.94767156e+01  0.00000000e+00]
 [-7.82705350e-03  1.79340326e-02]]
grads:  [0.00662692 5.24226676]
Stock Position:  0.006626922059357431
Bond Position:  [-4.44808574]


portfolio before change:  [-3.79037321]
curr_Stock_Price:  99.33247635405512
curr_Factors:  [9.93324764e+01 3.89887969e-02]
mat_Sqrt:  [[ 1.96137746e+01  0.00000000e+00]
 [-7.89823240e-03  1.80971239e-02]]
grads:  [ 0.04138209 33.09275351]
Stock Position:  0.0413820889024001
Bond Position:  [-7.90095858]


portfolio before change:  [-3.81779174]
curr_Stock_Price:  98.69377365502841
curr_Factors:  [9.86937737e+01 3.89497316e-02]
mat_Sqrt:  [[ 1.94778936e+01  0.00000000e+00]
 [-7.89427454e-03  1.80880553e-02]]
grads:  [4.48332240e-03 1.44385917e+01]
Stock Position:  0.004483322404330788
Bond Position:  [-4.26026775]


portfolio before change:  [-3.82131241]
curr_Stock_Price:  98.02728173966617
curr_Factors:  [9.80272817e+01 3.88204924e-02]
mat_Sqrt:  [[ 1.93142336e+01  0.00000000e+00]
 [-7.88116665e-03  1.80580214e-02]]
grads:  [0.0127592  6.26184514]
Stock Position:  0.012759200908253067
Bond Position:  [-5.07206219]


portfolio before change:  [-3.82144986]
curr_Stock_Price:  98.06620247328651
curr_Factors:  [9.80662025e+01 3.92708115e-02]
mat_Sqrt:  [[ 1.94336464e+01  0.00000000e+00]
 [-7.92674576e-03  1.81624562e-02]]
grads:  [-0.00373169  0.68255753]
Stock Position:  -0.0037316934860215363
Bond Position:  [-3.45549685]


portfolio before change:  [-3.82717079]
curr_Stock_Price:  99.48351309950469
curr_Factors:  [9.94835131e+01 3.82995602e-02]
mat_Sqrt:  [[ 1.94691955e+01  0.00000000e+00]
 [-7.82810937e-03  1.79364519e-02]]
grads:  [-1.57826168e-03 -7.51564222e+00]
Stock Position:  -0.001578261679542945
Bond Position:  [-3.67015977]


portfolio before change:  [-3.82624979]
curr_Stock_Price:  98.60926079871498
curr_Factors:  [9.86092608e+01 3.87921212e-02]
mat_Sqrt:  [[ 1.94217995e+01  0.00000000e+00]
 [-7.87828623e-03  1.80514215e-02]]
grads:  [-0.00665998 -1.55397209]
Stock Position:  -0.006659984718358826
Bond Position:  [-3.16951362]


portfolio before change:  [-3.81246469]
curr_Stock_Price:  96.47992905398881
curr_Factors:  [9.64799291e+01 3.94994853e-02]
mat_Sqrt:  [[ 1.91748817e+01  0.00000000e+00]
 [-7.94979097e-03  1.82152594e-02]]
grads:  [-1.00832955e-03  1.35457748e+01]
Stock Position:  -0.001008329548452778
Bond Position:  [-3.71518112]


portfolio before change:  [-3.81057719]
curr_Stock_Price:  94.14743392024906
curr_Factors:  [9.41474339e+01 4.07591944e-02]
mat_Sqrt:  [[ 1.90073374e+01  0.00000000e+00]
 [-8.07556258e-03  1.85034384e-02]]
grads:  [0.01278289 9.21876919]
Stock Position:  0.01278288711558055
Bond Position:  [-5.01405321]


portfolio before change:  [-3.81505109]
curr_Stock_Price:  93.84647634141166
curr_Factors:  [9.38464763e+01 3.98240955e-02]
mat_Sqrt:  [[ 1.87279797e+01  0.00000000e+00]
 [-7.98239016e-03  1.82899536e-02]]
grads:  [ 4.51754030e-03 -5.86897196e+00]
Stock Position:  0.004517540301065587
Bond Position:  [-4.23900633]


portfolio before change:  [-3.81885586]
curr_Stock_Price:  93.1215547170936
curr_Factors:  [9.31215547e+01 3.90389045e-02]
mat_Sqrt:  [[ 1.83992038e+01  0.00000000e+00]
 [-7.90330609e-03  1.81087492e-02]]
grads:  [ 9.96867674e-04 -2.41891264e+00]
Stock Position:  0.000996867673570393
Bond Position:  [-3.91168573]


portfolio before change:  [-3.8208914]
curr_Stock_Price:  91.57015509994963
curr_Factors:  [9.15701551e+01 4.10448433e-02]
mat_Sqrt:  [[ 1.85516803e+01  0.00000000e+00]
 [-8.10381078e-03  1.85681632e-02]]
grads:  [0.02395772 3.30210212]
Stock Position:  0.023957723970116796
Bond Position:  [-6.01470389]


portfolio before change:  [-3.84711385]
curr_Stock_Price:  90.5070084892116
curr_Factors:  [9.05070085e+01 4.06062919e-02]
mat_Sqrt:  [[ 1.82380699e+01  0.00000000e+00]
 [-8.06040117e-03  1.84686992e-02]]
grads:  [ 0.04537856 31.78464833]
Stock Position:  0.04537855520808328
Bond Position:  [-7.95419113]


portfolio before change:  [-3.85346828]
curr_Stock_Price:  90.38888893734682
curr_Factors:  [9.03888889e+01 4.28200989e-02]
mat_Sqrt:  [[ 1.87041889e+01  0.00000000e+00]
 [-8.27720715e-03  1.89654642e-02]]
grads:  [-0.04078642 26.0122046 ]
Stock Position:  -0.04078642456557565
Bond Position:  [-0.16682868]


portfolio before change:  [-3.86921849]
curr_Stock_Price:  90.7745406423243
curr_Factors:  [9.07745406e+01 4.25007695e-02]
mat_Sqrt:  [[ 1.87138204e+01  0.00000000e+00]
 [-8.24628590e-03  1.88946147e-02]]
grads:  [-4.70818536e-03  1.98370415e+01]
Stock Position:  -0.004708185364105534
Bond Position:  [-3.44183513]


portfolio before change:  [-3.87736028]
curr_Stock_Price:  92.41244028386026
curr_Factors:  [9.24124403e+01 4.22041691e-02]
mat_Sqrt:  [[ 1.89848913e+01  0.00000000e+00]
 [-8.21746132e-03  1.88285693e-02]]
grads:  [ 0.10107488 14.27811374]
Stock Position:  0.10107488318383756
Bond Position:  [-13.21793689]


portfolio before change:  [-3.89766741]
curr_Stock_Price:  92.22787637483681
curr_Factors:  [9.22278764e+01 4.35456331e-02]
mat_Sqrt:  [[ 1.92457355e+01  0.00000000e+00]
 [-8.34703618e-03  1.91254626e-02]]
grads:  [9.72702149e-03 2.07336129e+01]
Stock Position:  0.00972702149452898
Bond Position:  [-4.79476994]


portfolio before change:  [-3.90041571]
curr_Stock_Price:  92.00695345492979
curr_Factors:  [9.20069535e+01 4.54050801e-02]
mat_Sqrt:  [[ 1.96052721e+01  0.00000000e+00]
 [-8.52338713e-03  1.95295333e-02]]
grads:  [-3.27263061e-03  1.13826787e+01]
Stock Position:  -0.003272630607382449
Bond Position:  [-3.59931094]


portfolio before change:  [-3.90405172]
curr_Stock_Price:  92.9805035402763
curr_Factors:  [9.29805035e+01 4.35291529e-02]
mat_Sqrt:  [[ 1.93991188e+01  0.00000000e+00]
 [-8.34545653e-03  1.91218431e-02]]
grads:  [-0.00696273  4.62915753]
Stock Position:  -0.0069627319487341474
Bond Position:  [-3.2566534]


portfolio before change:  [-3.91035978]
curr_Stock_Price:  93.82800814751775
curr_Factors:  [9.38280081e+01 4.31155848e-02]
mat_Sqrt:  [[ 1.94827222e+01  0.00000000e+00]
 [-8.30571705e-03  1.90307885e-02]]
grads:  [ 0.0094175  -3.83565489]
Stock Position:  0.009417503424838956
Bond Position:  [-4.79398537]


portfolio before change:  [-3.91447666]
curr_Stock_Price:  93.45449160364356
curr_Factors:  [9.34544916e+01 4.17500461e-02]
mat_Sqrt:  [[ 1.90953955e+01  0.00000000e+00]
 [-8.17313121e-03  1.87269962e-02]]
grads:  [-1.90072453e-03 -2.38665858e+01]
Stock Position:  -0.0019007245328468004
Bond Position:  [-3.73684541]


portfolio before change:  [-3.91338985]
curr_Stock_Price:  92.63693991850455
curr_Factors:  [9.26369399e+01 4.08519750e-02]
mat_Sqrt:  [[ 1.87236593e+01  0.00000000e+00]
 [-8.08474860e-03  1.85244862e-02]]
grads:  [ 0.00514245 -2.07333869]
Stock Position:  0.005142450689328263
Bond Position:  [-4.38977075]


portfolio before change:  [-3.91831069]
curr_Stock_Price:  91.78674555419639
curr_Factors:  [9.17867456e+01 4.19438762e-02]
mat_Sqrt:  [[ 1.87981129e+01  0.00000000e+00]
 [-8.19208166e-03  1.87704171e-02]]
grads:  [  0.02982609 -16.88070855]
Stock Position:  0.02982609135222156
Bond Position:  [-6.65595055]


portfolio before change:  [-3.90248828]
curr_Stock_Price:  92.34513106707614
curr_Factors:  [9.23451311e+01 4.32691267e-02]
mat_Sqrt:  [[ 1.92089253e+01  0.00000000e+00]
 [-8.32049293e-03  1.90646443e-02]]
grads:  [ -0.03996505 -16.77785742]
Stock Position:  -0.03996505199497306
Bond Position:  [-0.21191031]


portfolio before change:  [-3.92931948]
curr_Stock_Price:  93.0158348519222
curr_Factors:  [9.30158349e+01 4.41564533e-02]
mat_Sqrt:  [[ 1.95458238e+01  0.00000000e+00]
 [-8.40537478e-03  1.92591331e-02]]
grads:  [0.01877066 6.19283149]
Stock Position:  0.018770658406044183
Bond Position:  [-5.67528794]


portfolio before change:  [-3.92344119]
curr_Stock_Price:  93.36679464972208
curr_Factors:  [9.33667946e+01 4.39903459e-02]
mat_Sqrt:  [[ 1.95826354e+01  0.00000000e+00]
 [-8.38955025e-03  1.92228745e-02]]
grads:  [-2.87873927e-03  1.03524638e+01]
Stock Position:  -0.0028787392660229788
Bond Position:  [-3.65466253]


portfolio before change:  [-3.92306623]
curr_Stock_Price:  93.07784204479869
curr_Factors:  [9.30778420e+01 4.55574198e-02]
mat_Sqrt:  [[ 1.98667060e+01  0.00000000e+00]
 [-8.53767367e-03  1.95622679e-02]]
grads:  [ 0.03116957 11.85603281]
Stock Position:  0.031169569671594406
Bond Position:  [-6.82426251]


portfolio before change:  [-3.89692901]
curr_Stock_Price:  93.94376051472952
curr_Factors:  [9.39437605e+01 4.40883154e-02]
mat_Sqrt:  [[ 1.97255760e+01  0.00000000e+00]
 [-8.39888711e-03  1.92442680e-02]]
grads:  [ 1.50098589e-03 -2.01055632e+00]
Stock Position:  0.0015009858854733514
Bond Position:  [-4.03793727]


portfolio before change:  [-3.89751358]
curr_Stock_Price:  93.8905958789876
curr_Factors:  [9.38905959e+01 4.39187761e-02]
mat_Sqrt:  [[ 1.96764710e+01  0.00000000e+00]
 [-8.38272281e-03  1.92072309e-02]]
grads:  [ 8.32504190e-03 -1.15912902e+01]
Stock Position:  0.008325041901938304
Bond Position:  [-4.67915673]


portfolio before change:  [-3.91133837]
curr_Stock_Price:  92.3002307445479
curr_Factors:  [9.23002307e+01 4.40878482e-02]
mat_Sqrt:  [[ 1.93803778e+01  0.00000000e+00]
 [-8.39884260e-03  1.92441660e-02]]
grads:  [0.00682575 2.62785078]
Stock Position:  0.006825749456891532
Bond Position:  [-4.54135662]


portfolio before change:  [-3.90759313]
curr_Stock_Price:  92.93209441825665
curr_Factors:  [9.29320944e+01 4.54687148e-02]
mat_Sqrt:  [[ 1.98162770e+01  0.00000000e+00]
 [-8.52935775e-03  1.95432138e-02]]
grads:  [3.87110445e-03 1.66705774e+01]
Stock Position:  0.003871104453980085
Bond Position:  [-4.26734298]


portfolio before change:  [-3.9051599]
curr_Stock_Price:  93.6984599970109
curr_Factors:  [9.36984600e+01 4.44768018e-02]
mat_Sqrt:  [[ 1.97605591e+01  0.00000000e+00]
 [-8.43580955e-03  1.93288679e-02]]
grads:  [-0.02104008 -7.04657628]
Stock Position:  -0.02104007992505963
Bond Position:  [-1.93373682]


portfolio before change:  [-3.88319293]
curr_Stock_Price:  92.64291742332048
curr_Factors:  [9.26429174e+01 4.57894417e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.88319293]
Stock Price:  94.17331866202423
PL:  [-3.88319293]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.39363870e+00  3.43975003e-01]
 [ 6.07680630e-01  1.16098744e-01]
 [ 1.11821774e-01 -3.74115004e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.16750336e-01  9.61415531e-01]
 [ 2.86602031e-02 -2.38991194e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.03075583e+00  1.04536234e+00]
 [ 3.05486250e-03  3.40521136e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-8.47244759e-02  1.04799440e-02]
 [ 5.31274558e-02 -1.32078128e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-5.77685067e-02 -1.57064914e-03]
 [ 4.23467393e-01  2.67890097e-01]
 [ 1.30053773e-01  1.09778117e-01]
 [ 4.07692577e-02  1.23725391e-01]
 [ 1.88653067e-01  7.53922090e-02]
 [ 7.89749124e-03  2.04379519e-02]
 [-3.62170796e-01  1.35147864e-01]
 [ 1.31660664e-01  2.88153339e-02]
 [ 1.56126696e+00  1.83408907e-01]
 [ 1.44567759e-02  4.09095934e-01]
 [-1.54588265e-01  1.96365683e-01]
 [-1.71986834e-01  8.59294137e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 4.18397378e-01 -4.23627575e-01]
 [ 1.19792366e-01 -5.27646935e-02]
 [ 6.93583340e-01 -3.16318931e-01]
 [-6.68309830e-01 -3.29496570e-01]
 [ 6.75070955e-01  2.52192602e-01]
 [-2.62295476e-01  4.02950862e-01]
 [ 1.15266488e+00  9.24214406e-02]
 [ 7.95629563e-02 -2.21047913e-01]
 [ 3.68026298e-01 -6.49971592e-01]
 [ 1.89504911e-01 -4.94641163e-02]
 [-1.03830409e-01  9.40949003e-01]
 [-4.30597440e-01 -1.53820271e-01]
 [-8.30995760e-01  1.97409523e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.69872468]
curr_Stock_Price:  99.71218419121956
curr_Factors:  [9.97121842e+01 4.04764717e-02]
mat_Sqrt:  [[ 2.00608603e+01  0.00000000e+00]
 [-8.04750612e-03  1.84391530e-02]]
grads:  [ 0.07695391 18.65459891]
Stock Position:  0.07695391310390651
Bond Position:  [-6.97451808]


portfolio before change:  [0.68561122]
curr_Stock_Price:  99.553107367265
curr_Factors:  [9.95531074e+01 3.94014233e-02]
mat_Sqrt:  [[ 1.97610845e+01  0.00000000e+00]
 [-7.93991671e-03  1.81926347e-02]]
grads:  [0.03331549 6.38163445]
Stock Position:  0.03331549314382791
Bond Position:  [-2.63104964]


portfolio before change:  [0.69424442]
curr_Stock_Price:  99.82211437788918
curr_Factors:  [9.98221144e+01 4.02572870e-02]
mat_Sqrt:  [[ 2.00285273e+01  0.00000000e+00]
 [-8.02568746e-03  1.83891601e-02]]
grads:  [ 0.0047679  -2.03443225]
Stock Position:  0.004767902042133733
Bond Position:  [0.21830236]


portfolio before change:  [0.68612675]
curr_Stock_Price:  98.11382310714924
curr_Factors:  [9.81138231e+01 4.15492104e-02]
mat_Sqrt:  [[ 1.99991522e+01  0.00000000e+00]
 [-8.15344937e-03  1.86818995e-02]]
grads:  [-8.15102899e-04 -8.10339510e+00]
Stock Position:  -0.0008151028989319809
Bond Position:  [0.76609961]


portfolio before change:  [0.68699364]
curr_Stock_Price:  97.16777082377384
curr_Factors:  [9.71677708e+01 4.09185877e-02]
mat_Sqrt:  [[ 1.96554304e+01  0.00000000e+00]
 [-8.09133736e-03  1.85395830e-02]]
grads:  [1.54077421e-02 5.18574518e+01]
Stock Position:  0.015407742098814807
Bond Position:  [-0.81014231]


portfolio before change:  [0.67909372]
curr_Stock_Price:  96.66161914006278
curr_Factors:  [9.66616191e+01 3.96159788e-02]
mat_Sqrt:  [[ 1.92392997e+01  0.00000000e+00]
 [-7.96150526e-03  1.82421003e-02]]
grads:  [ 9.47527848e-04 -1.31010789e+00]
Stock Position:  0.0009475278478411088
Bond Position:  [0.58750414]


portfolio before change:  [0.67955177]
curr_Stock_Price:  97.0675345920626
curr_Factors:  [9.70675346e+01 3.88026936e-02]
mat_Sqrt:  [[ 1.91207506e+01  0.00000000e+00]
 [-7.87935973e-03  1.80538812e-02]]
grads:  [0.00676615 5.32499833]
Stock Position:  0.006766145333992773
Bond Position:  [0.02277873]


portfolio before change:  [0.67591893]
curr_Stock_Price:  96.53019810727933
curr_Factors:  [9.65301981e+01 4.00247080e-02]
mat_Sqrt:  [[ 1.93120014e+01  0.00000000e+00]
 [-8.00247042e-03  1.83359632e-02]]
grads:  [ 0.0769982  57.01158602]
Stock Position:  0.07699820097070978
Bond Position:  [-6.75673267]


portfolio before change:  [0.77545901]
curr_Stock_Price:  97.83392632930334
curr_Factors:  [9.78339263e+01 4.05043683e-02]
mat_Sqrt:  [[ 1.96897597e+01  0.00000000e+00]
 [-8.05027883e-03  1.84455061e-02]]
grads:  [7.70301278e-03 1.84609267e+01]
Stock Position:  0.007703012775658708
Bond Position:  [0.02184302]


portfolio before change:  [0.77830219]
curr_Stock_Price:  98.2026715576684
curr_Factors:  [9.82026716e+01 4.01312540e-02]
mat_Sqrt:  [[ 1.96727316e+01  0.00000000e+00]
 [-8.01311465e-03  1.83603522e-02]]
grads:  [0.01252669 6.15873444]
Stock Position:  0.012526688780545466
Bond Position:  [-0.45185212]


portfolio before change:  [0.77868144]
curr_Stock_Price:  98.23745612254827
curr_Factors:  [9.82374561e+01 4.12489658e-02]
mat_Sqrt:  [[ 1.99518715e+01  0.00000000e+00]
 [-8.12393656e-03  1.86142771e-02]]
grads:  [-0.0040172   0.56300569]
Stock Position:  -0.004017199750150219
Bond Position:  [1.17332092]


portfolio before change:  [0.78160544]
curr_Stock_Price:  97.54609803277515
curr_Factors:  [9.75460980e+01 4.15790099e-02]
mat_Sqrt:  [[ 1.98905583e+01  0.00000000e+00]
 [-8.15637271e-03  1.86885977e-02]]
grads:  [-2.27050691e-04 -7.06731079e+00]
Stock Position:  -0.00022705069064627334
Bond Position:  [0.80375335]


portfolio before change:  [0.78148924]
curr_Stock_Price:  98.50037927175428
curr_Factors:  [9.85003793e+01 4.04193785e-02]
mat_Sqrt:  [[ 1.98030789e+01  0.00000000e+00]
 [-8.04182850e-03  1.84261439e-02]]
grads:  [-0.00653176 -1.52236981]
Stock Position:  -0.006531756435506003
Bond Position:  [1.42486973]


portfolio before change:  [0.77738535]
curr_Stock_Price:  99.15594776459163
curr_Factors:  [9.91559478e+01 4.06794145e-02]
mat_Sqrt:  [[ 1.99989004e+01  0.00000000e+00]
 [-8.06765537e-03  1.84853207e-02]]
grads:  [-0.00292286 -0.08496737]
Stock Position:  -0.002922860415331787
Bond Position:  [1.06720434]


portfolio before change:  [0.77398875]
curr_Stock_Price:  100.36367271367469
curr_Factors:  [1.00363673e+02 3.95352500e-02]
mat_Sqrt:  [[ 1.99557838e+01  0.00000000e+00]
 [-7.95338921e-03  1.82235040e-02]]
grads:  [ 0.02707908 14.70025175]
Stock Position:  0.027079077527766518
Bond Position:  [-1.94376693]


portfolio before change:  [0.70411221]
curr_Stock_Price:  97.79218358051324
curr_Factors:  [9.77921836e+01 4.11365719e-02]
mat_Sqrt:  [[ 1.98343600e+01  0.00000000e+00]
 [-8.11286109e-03  1.85889000e-02]]
grads:  [0.00897255 5.90557357]
Stock Position:  0.008972554248005905
Bond Position:  [-0.17333347]


portfolio before change:  [0.69344323]
curr_Stock_Price:  96.60553031804895
curr_Factors:  [9.66055303e+01 4.24420398e-02]
mat_Sqrt:  [[ 1.99021554e+01  0.00000000e+00]
 [-8.24058637e-03  1.88815554e-02]]
grads:  [4.76166745e-03 6.55271183e+00]
Stock Position:  0.004761667449275971
Bond Position:  [0.23343982]


portfolio before change:  [0.68950148]
curr_Stock_Price:  95.77159316109422
curr_Factors:  [9.57715932e+01 4.16668795e-02]
mat_Sqrt:  [[ 1.95493445e+01  0.00000000e+00]
 [-8.16498666e-03  1.87083347e-02]]
grads:  [0.01133321 4.02987279]
Stock Position:  0.011333214993411148
Bond Position:  [-0.39589858]


portfolio before change:  [0.69746024]
curr_Stock_Price:  96.47821106842083
curr_Factors:  [9.64782111e+01 4.17541104e-02]
mat_Sqrt:  [[ 1.97141864e+01  0.00000000e+00]
 [-8.17352902e-03  1.87279077e-02]]
grads:  [8.53058014e-04 1.09130995e+00]
Stock Position:  0.00085305801435171
Bond Position:  [0.61515873]


portfolio before change:  [0.69774156]
curr_Stock_Price:  96.71784962328252
curr_Factors:  [9.67178496e+01 4.00564990e-02]
mat_Sqrt:  [[ 1.93572263e+01  0.00000000e+00]
 [-8.00564791e-03  1.83432438e-02]]
grads:  [-0.01566275  7.36771891]
Stock Position:  -0.015662751886783968
Bond Position:  [2.21260925]


portfolio before change:  [0.69697404]
curr_Stock_Price:  96.78451201530018
curr_Factors:  [9.67845120e+01 4.10901919e-02]
mat_Sqrt:  [[ 1.96189134e+01  0.00000000e+00]
 [-8.10828632e-03  1.85784179e-02]]
grads:  [0.00735192 1.55101118]
Stock Position:  0.007351921268577584
Bond Position:  [-0.01457807]


portfolio before change:  [0.68222252]
curr_Stock_Price:  94.77827397426131
curr_Factors:  [9.47782740e+01 4.11933651e-02]
mat_Sqrt:  [[ 1.92363394e+01  0.00000000e+00]
 [-8.11845947e-03  1.86017275e-02]]
grads:  [0.08532357 9.85977815]
Stock Position:  0.08532357114872359
Bond Position:  [-7.40459829]


portfolio before change:  [0.5052941]
curr_Stock_Price:  92.71550540308775
curr_Factors:  [9.27155054e+01 4.16581457e-02]
mat_Sqrt:  [[ 1.89235380e+01  0.00000000e+00]
 [-8.16413089e-03  1.87063739e-02]]
grads:  [1.01989849e-02 2.18693338e+01]
Stock Position:  0.01019898492381982
Bond Position:  [-0.44030994]


portfolio before change:  [0.50905615]
curr_Stock_Price:  93.08976730289487
curr_Factors:  [9.30897673e+01 4.30412812e-02]
mat_Sqrt:  [[ 1.93127687e+01  0.00000000e+00]
 [-8.29855710e-03  1.90143830e-02]]
grads:  [-3.56692795e-03  1.03272182e+01]
Stock Position:  -0.003566927947312624
Bond Position:  [0.84110064]


portfolio before change:  [0.51001273]
curr_Stock_Price:  92.851065563352
curr_Factors:  [9.28510656e+01 4.43547263e-02]
mat_Sqrt:  [[ 1.95549560e+01  0.00000000e+00]
 [-8.42422472e-03  1.93023237e-02]]
grads:  [-0.00687724  4.45176523]
Stock Position:  -0.006877241935722894
Bond Position:  [1.14857197]


portfolio before change:  [0.51599398]
curr_Stock_Price:  92.00222680942824
curr_Factors:  [9.20022268e+01 4.40695087e-02]
mat_Sqrt:  [[ 1.93137873e+01  0.00000000e+00]
 [-8.39709556e-03  1.92401630e-02]]
grads:  [ 0.00949988 -3.79391469]
Stock Position:  0.009499876966177032
Bond Position:  [-0.35801586]


portfolio before change:  [0.50824166]
curr_Stock_Price:  91.19089391437166
curr_Factors:  [9.11908939e+01 4.55500906e-02]
mat_Sqrt:  [[ 1.94623866e+01  0.00000000e+00]
 [-8.53698687e-03  1.95606943e-02]]
grads:  [ 1.19980736e-02 -2.16570827e+01]
Stock Position:  0.011998073570848531
Bond Position:  [-0.58587339]


portfolio before change:  [0.51969438]
curr_Stock_Price:  92.151544810779
curr_Factors:  [9.21515448e+01 4.52317369e-02]
mat_Sqrt:  [[ 1.95985641e+01  0.00000000e+00]
 [-8.50710169e-03  1.94922187e-02]]
grads:  [ 0.0049373  -2.70696191]
Stock Position:  0.004937298761522656
Bond Position:  [0.06471467]


portfolio before change:  [0.51819613]
curr_Stock_Price:  91.84645121041507
curr_Factors:  [9.18464512e+01 4.56183771e-02]
mat_Sqrt:  [[ 1.96169866e+01  0.00000000e+00]
 [-8.54338360e-03  1.95753510e-02]]
grads:  [  0.02831885 -16.15904261]
Stock Position:  0.028318846869532913
Bond Position:  [-2.08278945]


portfolio before change:  [0.51608623]
curr_Stock_Price:  91.7811401463975
curr_Factors:  [9.17811401e+01 4.57659750e-02]
mat_Sqrt:  [[ 1.96347243e+01  0.00000000e+00]
 [-8.55719347e-03  1.96069934e-02]]
grads:  [ -0.04136111 -16.80505336]
Stock Position:  -0.04136110648067048
Bond Position:  [4.31225574]


portfolio before change:  [0.61106287]
curr_Stock_Price:  89.49789435533475
curr_Factors:  [8.94978944e+01 4.72836948e-02]
mat_Sqrt:  [[ 1.94611509e+01  0.00000000e+00]
 [-8.69792572e-03  1.99294515e-02]]
grads:  [ 0.0403438 12.6542671]
Stock Position:  0.04034380255273005
Bond Position:  [-2.99962251]


portfolio before change:  [0.61240934]
curr_Stock_Price:  89.5405638511782
curr_Factors:  [8.95405639e+01 4.61015523e-02]
mat_Sqrt:  [[ 1.92254980e+01  0.00000000e+00]
 [-8.58850881e-03  1.96787459e-02]]
grads:  [-4.49576399e-03  2.04764503e+01]
Stock Position:  -0.004495763991017896
Bond Position:  [1.01496259]


portfolio before change:  [0.62861728]
curr_Stock_Price:  85.96362842225606
curr_Factors:  [8.59636284e+01 4.79246612e-02]
mat_Sqrt:  [[ 1.88189013e+01  0.00000000e+00]
 [-8.75668076e-03  2.00640762e-02]]
grads:  [0.06339376 4.60631427]
Stock Position:  0.06339375965057147
Bond Position:  [-4.82094032]


portfolio before change:  [0.71364817]
curr_Stock_Price:  87.31444814648074
curr_Factors:  [8.73144481e+01 4.63392577e-02]
mat_Sqrt:  [[ 1.87957929e+01  0.00000000e+00]
 [-8.61062207e-03  1.97294137e-02]]
grads:  [-8.99683365e-04 -1.12039778e+01]
Stock Position:  -0.0008996833645071405
Bond Position:  [0.79220352]


portfolio before change:  [0.71399691]
curr_Stock_Price:  87.03688890136421
curr_Factors:  [8.70368889e+01 4.56286101e-02]
mat_Sqrt:  [[ 1.85918231e+01  0.00000000e+00]
 [-8.54434176e-03  1.95775464e-02]]
grads:  [ 4.53723329e-03 -3.31998493e+01]
Stock Position:  0.004537233288634026
Bond Position:  [0.31909024]


portfolio before change:  [0.71183614]
curr_Stock_Price:  86.55186568214211
curr_Factors:  [8.65518657e+01 4.50654227e-02]
mat_Sqrt:  [[ 1.83737650e+01  0.00000000e+00]
 [-8.49144725e-03  1.94563499e-02]]
grads:  [ 0.00913895 -2.54231223]
Stock Position:  0.009138954385072055
Bond Position:  [-0.07915741]


portfolio before change:  [0.70682252]
curr_Stock_Price:  86.00434933824677
curr_Factors:  [8.60043493e+01 4.49905742e-02]
mat_Sqrt:  [[ 1.82423667e+01  0.00000000e+00]
 [-8.48439266e-03  1.94401858e-02]]
grads:  [1.68198243e-02 4.84022639e+01]
Stock Position:  0.016819824328410147
Bond Position:  [-0.73975553]


portfolio before change:  [0.71425372]
curr_Stock_Price:  86.45165980487532
curr_Factors:  [8.64516598e+01 4.30571643e-02]
mat_Sqrt:  [[ 1.79389099e+01  0.00000000e+00]
 [-8.30008812e-03  1.90178910e-02]]
grads:  [-0.02774584 -8.08818761]
Stock Position:  -0.02774583925115555
Bond Position:  [3.11292758]


portfolio before change:  [0.72683856]
curr_Stock_Price:  86.01210923706005
curr_Factors:  [8.60121092e+01 4.29478667e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.72683856]
Stock Price:  85.6955655497127
PL:  [0.72683856]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.45817702e+00  3.61590559e-01]
 [ 6.12075375e-01  1.15830358e-01]
 [ 8.94540261e-02 -2.77694644e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.00638691e-01 -9.85351157e-02]
 [-2.71749514e-01  9.19751143e-02]
 [ 2.39183352e-01 -2.63624957e-01]
 [-5.91441594e-01  1.99780959e-01]
 [-1.18069072e-01 -9.79396499e-02]
 [ 1.79399633e-01  4.58099162e-02]
 [-8.31996731e-02 -9.64566461e-03]
 [-1.11781919e-02 -1.36337541e-01]
 [-5.76915255e-02 -1.79043893e-02]
 [ 2.31804087e-02 -1.99371532e-01]
 [ 4.58641927e-02 -1.33404753e-02]
 [ 9.53755906e-02 -9.38862591e-01]
 [ 2.09683607e-02 -2.50690997e-01]
 [ 3.45581818e-02 -1.56282774e-01]
 [-1.20908955e-01 -4.00288652e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 9.07213204e-02 -1.21627114e-02]
 [ 2.94100424e-01 -4.50991292e-01]
 [ 2.72272817e-02 -3.39812589e-01]
 [ 1.89521697e-02  1.18743414e-01]
 [ 4.68437292e-01 -4.89180203e-01]
 [-3.09202304e-01  3.04398720e-02]
 [-1.55073653e-01  9.95764701e-02]
 [-7.25505244e-02 -2.29085013e-02]
 [-4.40839139e-02  1.95771908e-01]
 [-6.05925137e-01 -7.62647705e-02]
 [-1.68370446e-01 -6.21824834e-02]
 [ 5.17355886e-02 -3.35851733e-02]
 [-2.70904100e-01  8.47877268e-02]
 [ 6.82983851e-02  6.15356527e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.79063188e-01  4.28503991e-02]
 [-2.68491207e-02 -1.82698022e-01]
 [-1.11522068e-02 -6.44898195e-02]
 [ 5.72223912e-02 -2.77111467e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.79730044]
curr_Stock_Price:  98.76925389213247
curr_Factors:  [9.87692539e+01 3.94587226e-02]
mat_Sqrt:  [[ 1.96197416e+01  0.00000000e+00]
 [-7.94568789e-03  1.82058581e-02]]
grads:  [ 0.08236541 19.86122031]
Stock Position:  0.08236541063460322
Bond Position:  [-13.93247059]


portfolio before change:  [-5.73504323]
curr_Stock_Price:  99.54626541190929
curr_Factors:  [9.95462654e+01 3.88131955e-02]
mat_Sqrt:  [[ 1.96116743e+01  0.00000000e+00]
 [-7.88042592e-03  1.80563241e-02]]
grads:  [0.03378742 6.41494673]
Stock Position:  0.03378742061682287
Bond Position:  [-9.09845477]


portfolio before change:  [-5.7032441]
curr_Stock_Price:  100.52108111151276
curr_Factors:  [1.00521081e+02 3.71010806e-02]
mat_Sqrt:  [[ 1.93620096e+01  0.00000000e+00]
 [-7.70465632e-03  1.76535854e-02]]
grads:  [ 0.00399413 -1.57302122]
Stock Position:  0.003994132841278996
Bond Position:  [-6.10473865]


portfolio before change:  [-5.69710854]
curr_Stock_Price:  102.24829105807518
curr_Factors:  [1.02248291e+02 3.55237334e-02]
mat_Sqrt:  [[ 1.92714929e+01  0.00000000e+00]
 [-7.53909632e-03  1.72742398e-02]]
grads:  [-8.45879821e-04 -8.76373226e+00]
Stock Position:  -0.0008458798213607612
Bond Position:  [-5.61061877]


portfolio before change:  [-5.69672907]
curr_Stock_Price:  100.97051837957558
curr_Factors:  [1.00970518e+02 3.68449256e-02]
mat_Sqrt:  [[ 1.93813234e+01  0.00000000e+00]
 [-7.67801283e-03  1.75925375e-02]]
grads:  [-0.00741141 -5.60096096]
Stock Position:  -0.0074114103774634964
Bond Position:  [-4.94839512]


portfolio before change:  [-5.6973498]
curr_Stock_Price:  100.97080768068179
curr_Factors:  [1.00970808e+02 3.66416434e-02]
mat_Sqrt:  [[ 1.93278391e+01  0.00000000e+00]
 [-7.65680282e-03  1.75439393e-02]]
grads:  [-0.01198314  5.24255773]
Stock Position:  -0.011983144177188423
Bond Position:  [-4.48740205]


portfolio before change:  [-5.71513777]
curr_Stock_Price:  102.40841102720498
curr_Factors:  [1.02408411e+02 3.59562612e-02]
mat_Sqrt:  [[ 1.94188224e+01  0.00000000e+00]
 [-7.58485450e-03  1.73790850e-02]]
grads:  [ 6.39214808e-03 -1.51690931e+01]
Stock Position:  0.006392148079151476
Bond Position:  [-6.36974749]


portfolio before change:  [-5.712398]
curr_Stock_Price:  102.9615954911909
curr_Factors:  [1.02961595e+02 3.62443759e-02]
mat_Sqrt:  [[ 1.96017830e+01  0.00000000e+00]
 [-7.61518230e-03  1.74485747e-02]]
grads:  [-0.0257247  11.44970081]
Stock Position:  -0.02572470245580748
Bond Position:  [-3.06374159]


portfolio before change:  [-5.68931186]
curr_Stock_Price:  102.04927683194829
curr_Factors:  [1.02049277e+02 3.56829658e-02]
mat_Sqrt:  [[ 1.92770424e+01  0.00000000e+00]
 [-7.55597414e-03  1.73129117e-02]]
grads:  [-0.00834223 -5.65702936]
Stock Position:  -0.00834222573469636
Bond Position:  [-4.83799376]


portfolio before change:  [-5.67594726]
curr_Stock_Price:  100.37473751732078
curr_Factors:  [1.00374738e+02 3.78290453e-02]
mat_Sqrt:  [[ 1.95225756e+01  0.00000000e+00]
 [-7.77987612e-03  1.78259356e-02]]
grads:  [0.01021344 2.56984639]
Stock Position:  0.010213443349397094
Bond Position:  [-6.70111896]


portfolio before change:  [-5.67199073]
curr_Stock_Price:  100.84414131830935
curr_Factors:  [1.00844141e+02 3.65455023e-02]
mat_Sqrt:  [[ 1.92782514e+01  0.00000000e+00]
 [-7.64675119e-03  1.75209081e-02]]
grads:  [-0.00453409 -0.5505231 ]
Stock Position:  -0.004534093069372785
Bond Position:  [-5.21475401]


portfolio before change:  [-5.67585034]
curr_Stock_Price:  101.5516094135145
curr_Factors:  [1.01551609e+02 3.72428474e-02]
mat_Sqrt:  [[ 1.95978419e+01  0.00000000e+00]
 [-7.71936240e-03  1.76872813e-02]]
grads:  [-3.60655900e-03 -7.70822485e+00]
Stock Position:  -0.0036065589970708588
Bond Position:  [-5.30959847]


portfolio before change:  [-5.67716745]
curr_Stock_Price:  101.73277129386146
curr_Factors:  [1.01732771e+02 3.76850899e-02]
mat_Sqrt:  [[ 1.97490247e+01  0.00000000e+00]
 [-7.76505917e-03  1.77919857e-02]]
grads:  [-0.00331691 -1.00631765]
Stock Position:  -0.0033169051407706722
Bond Position:  [-5.3397295]


portfolio before change:  [-5.68467158]
curr_Stock_Price:  103.79391544417543
curr_Factors:  [1.03793915e+02 3.71260127e-02]
mat_Sqrt:  [[ 1.99991275e+01  0.00000000e+00]
 [-7.70724467e-03  1.76595160e-02]]
grads:  [-3.19176231e-03 -1.12897506e+01]
Stock Position:  -0.003191762313766772
Bond Position:  [-5.35338607]


portfolio before change:  [-5.68580128]
curr_Stock_Price:  103.93818877469477
curr_Factors:  [1.03938189e+02 3.81592540e-02]
mat_Sqrt:  [[ 2.03036951e+01  0.00000000e+00]
 [-7.81375751e-03  1.79035676e-02]]
grads:  [ 0.00197215 -0.74512944]
Stock Position:  0.0019721499837299272
Bond Position:  [-5.89078298]


portfolio before change:  [-5.68387418]
curr_Stock_Price:  105.28874174082517
curr_Factors:  [1.05288742e+02 3.79992771e-02]
mat_Sqrt:  [[ 2.05243590e+01  0.00000000e+00]
 [-7.79736131e-03  1.78659992e-02]]
grads:  [-1.53172938e-02 -5.25502425e+01]
Stock Position:  -0.015317293782136577
Bond Position:  [-4.07113559]


portfolio before change:  [-5.67198879]
curr_Stock_Price:  104.47957072645619
curr_Factors:  [1.04479571e+02 3.75835235e-02]
mat_Sqrt:  [[ 2.02549011e+01  0.00000000e+00]
 [-7.75458816e-03  1.77679936e-02]]
grads:  [-4.36645728e-03 -1.41091337e+01]
Stock Position:  -0.00436645727910832
Bond Position:  [-5.21578321]


portfolio before change:  [-5.66865352]
curr_Stock_Price:  103.56640658040315
curr_Factors:  [1.03566407e+02 3.88715470e-02]
mat_Sqrt:  [[ 2.04190165e+01  0.00000000e+00]
 [-7.88634740e-03  1.80698920e-02]]
grads:  [-1.64793503e-03 -8.64879406e+00]
Stock Position:  -0.001647935033447113
Bond Position:  [-5.49798281]


portfolio before change:  [-5.6701843]
curr_Stock_Price:  104.07825271610933
curr_Factors:  [1.04078253e+02 3.82665725e-02]
mat_Sqrt:  [[ 2.03596250e+01  0.00000000e+00]
 [-7.82473744e-03  1.79287258e-02]]
grads:  [-1.45193856e-02 -2.23266648e+01]
Stock Position:  -0.014519385553400882
Bond Position:  [-4.15903202]


portfolio before change:  [-5.69528488]
curr_Stock_Price:  105.77120823941898
curr_Factors:  [1.05771208e+02 3.64853548e-02]
mat_Sqrt:  [[ 2.02035065e+01  0.00000000e+00]
 [-7.64045598e-03  1.75064839e-02]]
grads:  [-2.39864649e-04 -6.23159908e+00]
Stock Position:  -0.00023986464937069917
Bond Position:  [-5.66991411]


portfolio before change:  [-5.69626208]
curr_Stock_Price:  106.89025220681387
curr_Factors:  [1.06890252e+02 3.64216943e-02]
mat_Sqrt:  [[ 2.03994367e+01  0.00000000e+00]
 [-7.63378746e-03  1.74912044e-02]]
grads:  [ 0.00418703 -0.69536157]
Stock Position:  0.004187031207381382
Bond Position:  [-6.14381491]


portfolio before change:  [-5.69907581]
curr_Stock_Price:  106.40167166872519
curr_Factors:  [1.06401672e+02 3.59101994e-02]
mat_Sqrt:  [[ 2.01631026e+01  0.00000000e+00]
 [-7.57999466e-03  1.73679496e-02]]
grads:  [ 4.82424205e-03 -2.59668700e+01]
Stock Position:  0.004824242054174841
Bond Position:  [-6.21238323]


portfolio before change:  [-5.70009833]
curr_Stock_Price:  106.35069581164686
curr_Factors:  [1.06350696e+02 3.69946052e-02]
mat_Sqrt:  [[ 2.04554734e+01  0.00000000e+00]
 [-7.69359268e-03  1.76282354e-02]]
grads:  [-5.91915369e-03 -1.92766083e+01]
Stock Position:  -0.005919153688356162
Bond Position:  [-5.07059221]


portfolio before change:  [-5.70069468]
curr_Stock_Price:  106.34435940869731
curr_Factors:  [1.06344359e+02 3.61658401e-02]
mat_Sqrt:  [[ 2.02238455e+01  0.00000000e+00]
 [-7.60692738e-03  1.74296603e-02]]
grads:  [3.49963336e-03 6.81272109e+00]
Stock Position:  0.0034996333598201835
Bond Position:  [-6.07286095]


portfolio before change:  [-5.70012884]
curr_Stock_Price:  106.72297115179185
curr_Factors:  [1.06722971e+02 3.60641016e-02]
mat_Sqrt:  [[ 2.02672799e+01  0.00000000e+00]
 [-7.59622028e-03  1.74051272e-02]]
grads:  [ 1.2578972e-02 -2.8105523e+01]
Stock Position:  0.012578972037248866
Bond Position:  [-7.04259411]


portfolio before change:  [-5.72492795]
curr_Stock_Price:  104.82148591422593
curr_Factors:  [1.04821486e+02 3.83069027e-02]
mat_Sqrt:  [[ 2.05158177e+01  0.00000000e+00]
 [-7.82885971e-03  1.79381711e-02]]
grads:  [-0.01442386  1.69693286]
Stock Position:  -0.014423858653109104
Bond Position:  [-4.21299765]


portfolio before change:  [-5.70845008]
curr_Stock_Price:  103.64256918730267
curr_Factors:  [1.03642569e+02 3.94815267e-02]
mat_Sqrt:  [[ 2.05937359e+01  0.00000000e+00]
 [-7.94798357e-03  1.82111182e-02]]
grads:  [-5.41984803e-03  5.46789435e+00]
Stock Position:  -0.005419848026154362
Bond Position:  [-5.1467231]


portfolio before change:  [-5.71655191]
curr_Stock_Price:  105.01870534313736
curr_Factors:  [1.05018705e+02 3.85855794e-02]
mat_Sqrt:  [[ 2.06290474e+01  0.00000000e+00]
 [-7.85728496e-03  1.80033016e-02]]
grads:  [-0.00400157 -1.27246112]
Stock Position:  -0.0040015717942990395
Bond Position:  [-5.29631202]


portfolio before change:  [-5.70882449]
curr_Stock_Price:  102.92215583293024
curr_Factors:  [1.02922156e+02 3.76853395e-02]
mat_Sqrt:  [[ 1.99799819e+01  0.00000000e+00]
 [-7.76508488e-03  1.77920446e-02]]
grads:  [2.06996943e-03 1.10033395e+01]
Stock Position:  0.002069969425399141
Bond Position:  [-5.92187021]


portfolio before change:  [-5.71159796]
curr_Stock_Price:  101.9399249951775
curr_Factors:  [1.01939925e+02 3.63229392e-02]
mat_Sqrt:  [[ 1.94283000e+01  0.00000000e+00]
 [-7.62343117e-03  1.74674752e-02]]
grads:  [-0.03290096 -4.36610155]
Stock Position:  -0.032900964597712606
Bond Position:  [-2.3576761]


portfolio before change:  [-5.70580276]
curr_Stock_Price:  101.7548263027162
curr_Factors:  [1.01754826e+02 3.64735629e-02]
mat_Sqrt:  [[ 1.94331907e+01  0.00000000e+00]
 [-7.63922120e-03  1.75036547e-02]]
grads:  [-0.01006058 -3.55254285]
Stock Position:  -0.010060576765826121
Bond Position:  [-4.68209052]


portfolio before change:  [-5.71682466]
curr_Stock_Price:  102.79220209918971
curr_Factors:  [1.02792202e+02 3.62604409e-02]
mat_Sqrt:  [[ 1.95738705e+01  0.00000000e+00]
 [-7.61686979e-03  1.74524412e-02]]
grads:  [ 1.89425067e-03 -1.92438255e+00]
Stock Position:  0.001894250668256523
Bond Position:  [-5.91153886]


portfolio before change:  [-5.71721638]
curr_Stock_Price:  102.97552942305525
curr_Factors:  [1.02975529e+02 3.68967640e-02]
mat_Sqrt:  [[ 1.97800859e+01  0.00000000e+00]
 [-7.68341216e-03  1.76049089e-02]]
grads:  [-0.01182501  4.81614118]
Stock Position:  -0.011825009441750998
Bond Position:  [-4.49952977]


portfolio before change:  [-5.70729527]
curr_Stock_Price:  102.08896893454327
curr_Factors:  [1.02088969e+02 3.73829706e-02]
mat_Sqrt:  [[ 1.97385716e+01  0.00000000e+00]
 [-7.73387050e-03  1.77205235e-02]]
grads:  [0.00482075 3.47256404]
Stock Position:  0.004820751341517322
Bond Position:  [-6.1994408]


portfolio before change:  [-5.71113913]
curr_Stock_Price:  101.45237185597382
curr_Factors:  [1.01452372e+02 3.66449722e-02]
mat_Sqrt:  [[ 1.94209023e+01  0.00000000e+00]
 [-7.65715061e-03  1.75447361e-02]]
grads:  [-0.00487452  4.63530175]
Stock Position:  -0.004874521762168573
Bond Position:  [-5.21660733]


portfolio before change:  [-5.71772759]
curr_Stock_Price:  102.67020475289276
curr_Factors:  [1.02670205e+02 3.68347663e-02]
mat_Sqrt:  [[ 1.97048615e+01  0.00000000e+00]
 [-7.67695422e-03  1.75901119e-02]]
grads:  [-0.01321307  2.43605039]
Stock Position:  -0.013213071310890058
Bond Position:  [-4.36113886]


portfolio before change:  [-5.73374555]
curr_Stock_Price:  103.84122571659279
curr_Factors:  [1.03841226e+02 3.67245430e-02]
mat_Sqrt:  [[ 1.98997677e+01  0.00000000e+00]
 [-7.66545946e-03  1.75637741e-02]]
grads:  [-5.35609643e-03 -1.04019797e+01]
Stock Position:  -0.005356096427130856
Bond Position:  [-5.17756194]


portfolio before change:  [-5.7410207]
curr_Stock_Price:  105.07867797452329
curr_Factors:  [1.05078678e+02 3.56840624e-02]
mat_Sqrt:  [[ 1.98495994e+01  0.00000000e+00]
 [-7.55609025e-03  1.73131778e-02]]
grads:  [-1.97978159e-03 -3.72489790e+00]
Stock Position:  -0.0019797815949047473
Bond Position:  [-5.53298787]


portfolio before change:  [-5.73983394]
curr_Stock_Price:  104.1298724108658
curr_Factors:  [1.04129872e+02 3.67125950e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.73983394]
Stock Price:  103.80260287298708
PL:  [-9.54243682]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.31057027e+00  3.25194895e-01]
 [-2.66920451e-01 -1.00107132e-01]
 [-8.29955608e-01 -2.49864579e-01]
 [-3.21330323e-01 -6.87908755e-02]
 [-1.28432286e-01 -9.80007774e-01]
 [-7.35575338e-02 -4.48766012e-02]
 [ 4.57145079e-01 -5.52094020e-01]
 [-7.95117774e-01  1.46404501e-02]
 [-9.88856013e-02 -1.71953374e-01]
 [-4.48296989e-01 -6.66033705e-01]
 [-7.84505270e-02 -1.06618932e-02]
 [-9.56250072e-02 -1.60823264e-01]
 [-7.19535858e-02 -2.00199329e-02]
 [-4.61176958e-02 -3.55500832e-02]
 [ 4.31424895e-01  2.73278546e-01]
 [ 1.35566602e-01 -3.94910477e-01]
 [ 3.88289843e-02  2.84970400e-02]
 [ 3.09636635e-02 -1.52363562e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.57975161e-01 -3.39314668e-02]
 [ 3.51000778e-01 -3.67257372e-01]
 [ 2.72205562e-02 -3.39383206e-01]
 [ 1.67103088e-02  1.28870683e-01]
 [ 4.70183789e-01 -4.94278087e-01]
 [-3.91752636e-01  4.93216235e-02]
 [-1.27925580e-01  1.81634723e-01]
 [-1.35769746e-01 -2.69778077e-01]
 [-7.83666404e-02  2.24722070e-01]
 [-5.38926411e-01  5.99316411e-01]
 [-1.10491238e-01  4.45932586e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.17695070e-01 -7.13676834e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.06249362e-01 -8.23667886e-02]
 [-2.98338219e-02 -1.55061254e-01]
 [-6.92764424e-03 -6.45433138e-02]
 [ 1.94879314e-01 -1.37941344e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.18262021]
curr_Stock_Price:  100.07273396041015
curr_Factors:  [1.00072734e+02 4.02371334e-02]
mat_Sqrt:  [[ 2.00737856e+01  0.00000000e+00]
 [-8.02367830e-03  1.83845566e-02]]
grads:  [ 0.0723579  17.68848185]
Stock Position:  0.07235789947809687
Bond Position:  [-4.05843262]


portfolio before change:  [3.32609606]
curr_Stock_Price:  102.06260917939065
curr_Factors:  [1.02062609e+02 3.73800414e-02]
mat_Sqrt:  [[ 1.97327019e+01  0.00000000e+00]
 [-7.73356750e-03  1.77198292e-02]]
grads:  [-0.01574092 -5.64944113]
Stock Position:  -0.015740915085195407
Bond Position:  [4.93265493]


portfolio before change:  [3.29708356]
curr_Stock_Price:  103.94490907984166
curr_Factors:  [1.03944909e+02 3.74667138e-02]
mat_Sqrt:  [[ 2.01199096e+01  0.00000000e+00]
 [-7.74252814e-03  1.77403606e-02]]
grads:  [ -0.04667046 -14.08452649]
Stock Position:  -0.0466704607081552
Bond Position:  [8.14824035]


portfolio before change:  [3.25610849]
curr_Stock_Price:  104.84470020503947
curr_Factors:  [1.0484470e+02 3.8100643e-02]
mat_Sqrt:  [[ 2.04650417e+01  0.00000000e+00]
 [-7.80775440e-03  1.78898128e-02]]
grads:  [-0.01716845 -3.84525408]
Stock Position:  -0.017168453736280846
Bond Position:  [5.05612987]


portfolio before change:  [3.25479914]
curr_Stock_Price:  104.9577797065104
curr_Factors:  [1.04957780e+02 3.74224457e-02]
mat_Sqrt:  [[ 2.03039586e+01  0.00000000e+00]
 [-7.73795277e-03  1.77298771e-02]]
grads:  [-2.73908530e-02 -5.52743691e+01]
Stock Position:  -0.027390852975190845
Bond Position:  [6.12968225]


portfolio before change:  [3.230059]
curr_Stock_Price:  105.88898114720843
curr_Factors:  [1.05888981e+02 3.64589692e-02]
mat_Sqrt:  [[ 2.02186876e+01  0.00000000e+00]
 [-7.63769276e-03  1.75001526e-02]]
grads:  [-0.00460679 -2.56435485]
Stock Position:  -0.00460679199235593
Bond Position:  [3.71786751]


portfolio before change:  [3.23290228]
curr_Stock_Price:  105.3726735630218
curr_Factors:  [1.05372674e+02 3.59857461e-02]
mat_Sqrt:  [[ 1.99891007e+01  0.00000000e+00]
 [-7.58796375e-03  1.73862091e-02]]
grads:  [ 1.08154688e-02 -3.17547095e+01]
Stock Position:  0.010815468784897593
Bond Position:  [2.09324742]


portfolio before change:  [3.23422897]
curr_Stock_Price:  105.47114461686246
curr_Factors:  [1.05471145e+02 3.69933487e-02]
mat_Sqrt:  [[ 2.02859561e+01  0.00000000e+00]
 [-7.69346202e-03  1.76279360e-02]]
grads:  [-0.0388805   0.83052548]
Stock Position:  -0.03888050198680936
Bond Position:  [7.33500001]


portfolio before change:  [3.21384059]
curr_Stock_Price:  106.01911358491789
curr_Factors:  [1.06019114e+02 3.74310850e-02]
mat_Sqrt:  [[ 2.05116396e+01  0.00000000e+00]
 [-7.73884591e-03  1.77319236e-02]]
grads:  [-8.47968323e-03 -9.69738974e+00]
Stock Position:  -0.008479683226519331
Bond Position:  [4.11284909]


portfolio before change:  [3.22525845]
curr_Stock_Price:  104.73324962549725
curr_Factors:  [1.04733250e+02 3.90199324e-02]
mat_Sqrt:  [[ 2.06884443e+01  0.00000000e+00]
 [-7.90138544e-03  1.81043484e-02]]
grads:  [-3.5719357e-02 -3.6788604e+01]
Stock Position:  -0.0357193569704311
Bond Position:  [6.96626278]


portfolio before change:  [3.27032826]
curr_Stock_Price:  103.49585403512103
curr_Factors:  [1.03495854e+02 4.13646866e-02]
mat_Sqrt:  [[ 2.10493079e+01  0.00000000e+00]
 [-8.13532412e-03  1.86403693e-02]]
grads:  [-0.00394805 -0.57197865]
Stock Position:  -0.003948051827061351
Bond Position:  [3.67893525]


portfolio before change:  [3.27183384]
curr_Stock_Price:  103.23099397830845
curr_Factors:  [1.03230994e+02 4.30301989e-02]
mat_Sqrt:  [[ 2.14139501e+01  0.00000000e+00]
 [-8.29748867e-03  1.90119350e-02]]
grads:  [-7.74327172e-03 -8.45906871e+00]
Stock Position:  -0.007743271715567059
Bond Position:  [4.07117947]


portfolio before change:  [3.2882556]
curr_Stock_Price:  101.17594061755322
curr_Factors:  [1.01175941e+02 4.33561467e-02]
mat_Sqrt:  [[ 2.10669949e+01  0.00000000e+00]
 [-8.32885555e-03  1.90838055e-02]]
grads:  [-0.00383021 -1.0490535 ]
Stock Position:  -0.0038302093566357255
Bond Position:  [3.67578064]


portfolio before change:  [3.29366188]
curr_Stock_Price:  99.88442410631794
curr_Factors:  [9.98844241e+01 4.19937899e-02]
mat_Sqrt:  [[ 2.04687021e+01  0.00000000e+00]
 [-8.19695455e-03  1.87815823e-02]]
grads:  [-0.00301109 -1.89281619]
Stock Position:  -0.0030110860842540283
Bond Position:  [3.59442248]


portfolio before change:  [3.29307241]
curr_Stock_Price:  100.22941663310917
curr_Factors:  [1.00229417e+02 4.30063389e-02]
mat_Sqrt:  [[ 2.07855461e+01  0.00000000e+00]
 [-8.29518790e-03  1.90066632e-02]]
grads:  [ 0.02649406 14.37803907]
Stock Position:  0.02649405638406615
Bond Position:  [0.63758859]


portfolio before change:  [3.3188326]
curr_Stock_Price:  101.1987088700596
curr_Factors:  [1.01198709e+02 4.24748960e-02]
mat_Sqrt:  [[ 2.08564858e+01  0.00000000e+00]
 [-8.24377545e-03  1.88888625e-02]]
grads:  [-1.76378996e-03 -2.09070545e+01]
Stock Position:  -0.00176378995503924
Bond Position:  [3.49732586]


portfolio before change:  [3.32043756]
curr_Stock_Price:  100.53663135204079
curr_Factors:  [1.00536631e+02 4.26754447e-02]
mat_Sqrt:  [[ 2.07688934e+01  0.00000000e+00]
 [-8.26321436e-03  1.89334026e-02]]
grads:  [0.00246841 1.50511984]
Stock Position:  0.002468408465351402
Bond Position:  [3.07227208]


portfolio before change:  [3.3250248]
curr_Stock_Price:  102.23942530173629
curr_Factors:  [1.02239425e+02 4.18537899e-02]
mat_Sqrt:  [[ 2.09163449e+01  0.00000000e+00]
 [-8.18327952e-03  1.87502489e-02]]
grads:  [-1.69882676e-03 -8.12594874e+00]
Stock Position:  -0.0016988267634842947
Bond Position:  [3.49871188]


portfolio before change:  [3.32444319]
curr_Stock_Price:  102.83924039704826
curr_Factors:  [1.02839240e+02 4.06454762e-02]
mat_Sqrt:  [[ 2.07331347e+01  0.00000000e+00]
 [-8.06428930e-03  1.84776081e-02]]
grads:  [-1.53750578e-02 -2.53976403e+01]
Stock Position:  -0.015375057843910894
Bond Position:  [4.90560246]


portfolio before change:  [3.32205275]
curr_Stock_Price:  103.03460098633961
curr_Factors:  [1.03034601e+02 4.07823305e-02]
mat_Sqrt:  [[ 2.08074621e+01  0.00000000e+00]
 [-8.07785422e-03  1.85086892e-02]]
grads:  [-2.32902358e-04 -5.89417155e+00]
Stock Position:  -0.00023290235840597658
Bond Position:  [3.34604975]


portfolio before change:  [3.32262173]
curr_Stock_Price:  102.38754596611506
curr_Factors:  [1.02387546e+02 4.13880940e-02]
mat_Sqrt:  [[ 2.08297879e+01  0.00000000e+00]
 [-8.13762560e-03  1.86456426e-02]]
grads:  [ 0.00687315 -1.81980678]
Stock Position:  0.006873149927958194
Bond Position:  [2.61889678]


portfolio before change:  [3.34040521]
curr_Stock_Price:  104.92729754122242
curr_Factors:  [1.04927298e+02 4.21688119e-02]
mat_Sqrt:  [[ 2.15468689e+01  0.00000000e+00]
 [-8.21401845e-03  1.88206807e-02]]
grads:  [ 8.85124057e-03 -1.95135010e+01]
Stock Position:  0.00885124056752487
Bond Position:  [2.41166845]


portfolio before change:  [3.35279892]
curr_Stock_Price:  106.29346031390267
curr_Factors:  [1.06293460e+02 4.27187045e-02]
mat_Sqrt:  [[ 2.19692678e+01  0.00000000e+00]
 [-8.26740148e-03  1.89429965e-02]]
grads:  [-5.50306999e-03 -1.79160254e+01]
Stock Position:  -0.005503069993728227
Bond Position:  [3.93773927]


portfolio before change:  [3.3515938]
curr_Stock_Price:  106.60190104447331
curr_Factors:  [1.06601901e+02 4.21738922e-02]
mat_Sqrt:  [[ 2.18920682e+01  0.00000000e+00]
 [-8.21451323e-03  1.88218143e-02]]
grads:  [3.33244375e-03 6.84687887e+00]
Stock Position:  0.0033324437541174087
Bond Position:  [2.99634896]


portfolio before change:  [3.35281443]
curr_Stock_Price:  106.85578753693676
curr_Factors:  [1.06855788e+02 4.34249457e-02]
mat_Sqrt:  [[ 2.22673067e+01  0.00000000e+00]
 [-8.33546118e-03  1.90989409e-02]]
grads:  [ 1.14276571e-02 -2.58798689e+01]
Stock Position:  0.011427657121931046
Bond Position:  [2.13170312]


portfolio before change:  [3.33778846]
curr_Stock_Price:  105.5175917695194
curr_Factors:  [1.05517592e+02 4.32467202e-02]
mat_Sqrt:  [[ 2.19432757e+01  0.00000000e+00]
 [-8.31833831e-03  1.90597075e-02]]
grads:  [-0.016872    2.58774294]
Stock Position:  -0.01687199852922531
Bond Position:  [5.11808112]


portfolio before change:  [3.32151187]
curr_Stock_Price:  106.52022298805572
curr_Factors:  [1.06520223e+02 4.25581332e-02]
mat_Sqrt:  [[ 2.19747201e+01  0.00000000e+00]
 [-8.25184907e-03  1.89073615e-02]]
grads:  [-2.21407543e-03  9.60656107e+00]
Stock Position:  -0.002214075427192161
Bond Position:  [3.55735568]


portfolio before change:  [3.32006339]
curr_Stock_Price:  107.37528718790135
curr_Factors:  [1.07375287e+02 4.25103207e-02]
mat_Sqrt:  [[ 2.21386701e+01  0.00000000e+00]
 [-8.24721245e-03  1.88967377e-02]]
grads:  [-1.14510289e-02 -1.42764366e+01]
Stock Position:  -0.011451028890396514
Bond Position:  [4.54962091]


portfolio before change:  [3.31724784]
curr_Stock_Price:  107.67083196497774
curr_Factors:  [1.07670832e+02 4.16692193e-02]
mat_Sqrt:  [[ 2.19788898e+01  0.00000000e+00]
 [-8.16521591e-03  1.87088600e-02]]
grads:  [8.96774673e-04 1.20115320e+01]
Stock Position:  0.0008967746727191465
Bond Position:  [3.22069136]


portfolio before change:  [3.31758453]
curr_Stock_Price:  107.59732766280632
curr_Factors:  [1.07597328e+02 4.09549382e-02]
mat_Sqrt:  [[ 2.17748224e+01  0.00000000e+00]
 [-8.09493058e-03  1.85478161e-02]]
grads:  [-1.27377978e-02  3.23119665e+01]
Stock Position:  -0.012737797784227874
Bond Position:  [4.68813753]


portfolio before change:  [3.31523058]
curr_Stock_Price:  107.82813730128531
curr_Factors:  [1.07828137e+02 3.91646721e-02]
mat_Sqrt:  [[ 2.13392598e+01  0.00000000e+00]
 [-7.91602649e-03  1.81378953e-02]]
grads:  [-0.00426581  2.45856853]
Stock Position:  -0.004265806101831493
Bond Position:  [3.77520451]


portfolio before change:  [3.32579463]
curr_Stock_Price:  105.46231846230988
curr_Factors:  [1.05462318e+02 3.97823640e-02]
mat_Sqrt:  [[ 2.10350044e+01  0.00000000e+00]
 [-7.97820671e-03  1.82803681e-02]]
grads:  [ 0.00344866 -0.65355298]
Stock Position:  0.003448660874088342
Bond Position:  [2.96209086]


portfolio before change:  [3.33018942]
curr_Stock_Price:  106.62929260611823
curr_Factors:  [1.06629293e+02 3.88347320e-02]
mat_Sqrt:  [[ 2.10129334e+01  0.00000000e+00]
 [-7.88261195e-03  1.80613330e-02]]
grads:  [-0.01184235 -3.95140732]
Stock Position:  -0.011842348488177674
Bond Position:  [4.59293066]


portfolio before change:  [3.33313795]
curr_Stock_Price:  106.42879328402877
curr_Factors:  [1.06428793e+02 3.89159289e-02]
mat_Sqrt:  [[ 2.09953365e+01  0.00000000e+00]
 [-7.89084826e-03  1.80802047e-02]]
grads:  [0.00483303 2.95068898]
Stock Position:  0.0048330338466877525
Bond Position:  [2.81876399]


portfolio before change:  [3.3322237]
curr_Stock_Price:  106.16671731833873
curr_Factors:  [1.06166717e+02 3.93546903e-02]
mat_Sqrt:  [[ 2.10613710e+01  0.00000000e+00]
 [-7.93520665e-03  1.81818426e-02]]
grads:  [-0.00449485  4.47287704]
Stock Position:  -0.004494845594676624
Bond Position:  [3.8094267]


portfolio before change:  [3.32743915]
curr_Stock_Price:  107.33711357557233
curr_Factors:  [1.07337114e+02 4.00375537e-02]
mat_Sqrt:  [[ 2.14774976e+01  0.00000000e+00]
 [-8.00375449e-03  1.83389054e-02]]
grads:  [-0.02058886 -4.49136886]
Stock Position:  -0.02058885925033594
Bond Position:  [5.53738788]


portfolio before change:  [3.35012668]
curr_Stock_Price:  106.26880256811499
curr_Factors:  [1.06268803e+02 3.98851632e-02]
mat_Sqrt:  [[ 2.12232297e+01  0.00000000e+00]
 [-7.98850807e-03  1.83039715e-02]]
grads:  [-4.59440448e-03 -8.47145411e+00]
Stock Position:  -0.004594404476653358
Bond Position:  [3.83836854]


portfolio before change:  [3.35180843]
curr_Stock_Price:  106.00719511915601
curr_Factors:  [1.06007195e+02 4.01220606e-02]
mat_Sqrt:  [[ 2.12337626e+01  0.00000000e+00]
 [-8.01219676e-03  1.83582491e-02]]
grads:  [-1.65287031e-03 -3.51576632e+00]
Stock Position:  -0.001652870307988554
Bond Position:  [3.52702458]


portfolio before change:  [3.35177332]
curr_Stock_Price:  106.29519275823517
curr_Factors:  [1.06295193e+02 4.05953953e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.35177332]
Stock Price:  105.11756409068325
PL:  [-1.76579077]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.46003696e+00  3.58986318e-01]
 [ 1.30949365e-01  6.99863826e-02]
 [ 1.10476063e-01 -2.05232252e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.00247716e-01 -9.28067198e-02]
 [-2.68515100e-01  8.83446645e-02]
 [ 1.13134055e-01 -2.21718199e-02]
 [ 5.16344367e-01  5.75878353e-01]
 [-1.17557595e-01 -9.56287839e-02]
 [ 7.88134461e-02 -9.43125064e-02]
 [-9.17627833e-02 -7.48107173e-03]
 [ 2.60844062e-02 -1.33909111e-01]
 [-8.34761484e-02 -2.18875437e-02]
 [-3.59151716e-02 -4.30606541e-02]
 [ 3.41367524e-01  2.08113672e-01]
 [ 1.36768397e-01 -4.60531095e-01]
 [ 3.78549887e-02 -1.44711747e-02]
 [ 1.18737121e-02 -9.68619621e-02]
 [-1.13959225e-01 -4.69287644e-01]
 [-4.20582795e-02 -5.94337472e-02]
 [ 1.70396439e-01 -3.93824925e-02]
 [ 6.37687391e-01 -1.38124392e-01]
 [ 2.87017668e-02 -3.20192575e-01]
 [ 4.54796454e-02  1.00917885e-02]
 [ 4.38378918e-01 -3.96428261e-01]
 [-1.57406189e-01 -4.09247246e-03]
 [-1.49165744e-01  1.17433822e-01]
 [-8.03234032e-02 -5.42510048e-02]
 [-8.52360795e-02  2.19242006e-01]
 [-5.70681776e-01  5.11559355e-01]
 [-9.65962091e-02  7.10360997e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.36535695e-01 -1.60750851e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.16160865e-01 -9.07098552e-02]
 [-2.96941859e-02 -1.56354211e-01]
 [-9.08590546e-03 -6.46174983e-02]
 [ 3.48176937e-02 -2.99762449e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.28037619]
curr_Stock_Price:  99.42490787370537
curr_Factors:  [9.94249079e+01 4.09303556e-02]
mat_Sqrt:  [[ 2.01149036e+01  0.00000000e+00]
 [-8.09250078e-03  1.85422487e-02]]
grads:  [ 0.08037381 19.36045211]
Stock Position:  0.08037380944386813
Bond Position:  [-9.27153479]


portfolio before change:  [-1.17575153]
curr_Stock_Price:  100.74105401681254
curr_Factors:  [1.00741054e+02 4.07231877e-02]
mat_Sqrt:  [[ 2.03295316e+01  0.00000000e+00]
 [-8.07199482e-03  1.84952636e-02]]
grads:  [0.00794381 3.78401649]
Stock Position:  0.007943809472602651
Bond Position:  [-1.97601927]


portfolio before change:  [-1.18132375]
curr_Stock_Price:  100.070695227841
curr_Factors:  [1.00070695e+02 4.09172733e-02]
mat_Sqrt:  [[ 2.02423188e+01  0.00000000e+00]
 [-8.09120741e-03  1.85392852e-02]]
grads:  [ 0.00501519 -1.10701276]
Stock Position:  0.005015185959561376
Bond Position:  [-1.68319689]


portfolio before change:  [-1.17507787]
curr_Stock_Price:  101.35804346258554
curr_Factors:  [1.01358043e+02 4.14021753e-02]
mat_Sqrt:  [[ 2.06238527e+01  0.00000000e+00]
 [-8.13900979e-03  1.86488142e-02]]
grads:  [-7.90413275e-04 -8.11777149e+00]
Stock Position:  -0.0007904132746850038
Bond Position:  [-1.09496313]


portfolio before change:  [-1.17488463]
curr_Stock_Price:  100.94039522133134
curr_Factors:  [1.00940395e+02 4.16020677e-02]
mat_Sqrt:  [[ 2.05883934e+01  0.00000000e+00]
 [-8.15863397e-03  1.86937789e-02]]
grads:  [-0.00683647 -4.96457781]
Stock Position:  -0.0068364677975283695
Bond Position:  [-0.48480887]


portfolio before change:  [-1.17500874]
curr_Stock_Price:  100.94968448547863
curr_Factors:  [1.00949684e+02 4.11886187e-02]
mat_Sqrt:  [[ 2.04877176e+01  0.00000000e+00]
 [-8.11799174e-03  1.86006558e-02]]
grads:  [-0.0112242   4.74954568]
Stock Position:  -0.011224204262724564
Bond Position:  [-0.04192886]


portfolio before change:  [-1.17222028]
curr_Stock_Price:  100.7007845936904
curr_Factors:  [1.00700785e+02 4.33904121e-02]
mat_Sqrt:  [[ 2.09763414e+01  0.00000000e+00]
 [-8.33214615e-03  1.90913452e-02]]
grads:  [ 0.0049321  -1.16135451]
Stock Position:  0.0049321031701123124
Bond Position:  [-1.66888694]


portfolio before change:  [-1.17832992]
curr_Stock_Price:  99.50433477596326
curr_Factors:  [9.95043348e+01 4.31823228e-02]
mat_Sqrt:  [[ 2.06773558e+01  0.00000000e+00]
 [-8.31214271e-03  1.90455116e-02]]
grads:  [ 0.03712652 30.23695902]
Stock Position:  0.03712652110604523
Bond Position:  [-4.87257971]


portfolio before change:  [-1.1143728]
curr_Stock_Price:  101.24342115598076
curr_Factors:  [1.01243421e+02 4.28867229e-02]
mat_Sqrt:  [[ 2.09666113e+01  0.00000000e+00]
 [-8.28364392e-03  1.89802126e-02]]
grads:  [-0.00759748 -5.03834102]
Stock Position:  -0.007597480419064309
Bond Position:  [-0.34517789]


portfolio before change:  [-1.11346644]
curr_Stock_Price:  101.11844439036093
curr_Factors:  [1.01118444e+02 4.29688686e-02]
mat_Sqrt:  [[ 2.09607751e+01  0.00000000e+00]
 [-8.29157342e-03  1.89983814e-02]]
grads:  [ 1.79631209e-03 -4.96423902e+00]
Stock Position:  0.001796312089381668
Bond Position:  [-1.29510673]


portfolio before change:  [-1.11471703]
curr_Stock_Price:  100.51237560700355
curr_Factors:  [1.00512376e+02 4.32984124e-02]
mat_Sqrt:  [[ 2.09148871e+01  0.00000000e+00]
 [-8.32330823e-03  1.90710950e-02]]
grads:  [-0.00454355 -0.39227279]
Stock Position:  -0.004543547870726911
Bond Position:  [-0.65803424]


portfolio before change:  [-1.10904269]
curr_Stock_Price:  99.24539243742113
curr_Factors:  [9.92453924e+01 4.34939066e-02]
mat_Sqrt:  [[ 2.06978179e+01  0.00000000e+00]
 [-8.34207711e-03  1.91140999e-02]]
grads:  [-1.56336873e-03 -7.00577646e+00]
Stock Position:  -0.0015633687289990938
Bond Position:  [-0.95388555]


portfolio before change:  [-1.11173627]
curr_Stock_Price:  100.89205373582217
curr_Factors:  [1.00892054e+02 4.29970243e-02]
mat_Sqrt:  [[ 2.09206976e+01  0.00000000e+00]
 [-8.29428953e-03  1.90046048e-02]]
grads:  [-0.00444673 -1.15169686]
Stock Position:  -0.004446728179155641
Bond Position:  [-0.66309674]


portfolio before change:  [-1.11419207]
curr_Stock_Price:  101.42568182639704
curr_Factors:  [1.01425682e+02 4.29422896e-02]
mat_Sqrt:  [[ 2.10179587e+01  0.00000000e+00]
 [-8.28900858e-03  1.89925046e-02]]
grads:  [-0.00260294 -2.26724463]
Stock Position:  -0.0026029350709613664
Bond Position:  [-0.8501876]


portfolio before change:  [-1.11415885]
curr_Stock_Price:  101.3720892495997
curr_Factors:  [1.01372089e+02 4.33987747e-02]
mat_Sqrt:  [[ 2.11182113e+01  0.00000000e+00]
 [-8.33294903e-03  1.90931848e-02]]
grads:  [ 0.02046555 10.89989299]
Stock Position:  0.020465548421381898
Bond Position:  [-3.18879425]


portfolio before change:  [-1.10910322]
curr_Stock_Price:  101.63859811842808
curr_Factors:  [1.01638598e+02 4.21772444e-02]
mat_Sqrt:  [[ 2.08736197e+01  0.00000000e+00]
 [-8.21483968e-03  1.88225623e-02]]
grads:  [-3.07679509e-03 -2.44669715e+01]
Stock Position:  -0.003076795085635732
Bond Position:  [-0.79638208]


portfolio before change:  [-1.10696326]
curr_Stock_Price:  100.91072586379347
curr_Factors:  [1.00910726e+02 4.09684486e-02]
mat_Sqrt:  [[ 2.04250011e+01  0.00000000e+00]
 [-8.09626566e-03  1.85508751e-02]]
grads:  [ 0.00154415 -0.78008043]
Stock Position:  0.00154414925823753
Bond Position:  [-1.26278448]


portfolio before change:  [-1.10820014]
curr_Stock_Price:  100.21194492724504
curr_Factors:  [1.00211945e+02 3.92393762e-02]
mat_Sqrt:  [[ 1.98509154e+01  0.00000000e+00]
 [-7.92357255e-03  1.81551855e-02]]
grads:  [-1.53143134e-03 -5.33522293e+00]
Stock Position:  -0.0015314313385310979
Bond Position:  [-0.95473243]


portfolio before change:  [-1.1089969]
curr_Stock_Price:  100.65428130804565
curr_Factors:  [1.00654281e+02 3.93002376e-02]
mat_Sqrt:  [[ 1.99539941e+01  0.00000000e+00]
 [-7.92971501e-03  1.81692596e-02]]
grads:  [-1.59754053e-02 -2.58286608e+01]
Stock Position:  -0.015975405345024254
Bond Position:  [0.49899604]


portfolio before change:  [-1.10972563]
curr_Stock_Price:  100.70380197126939
curr_Factors:  [1.00703802e+02 4.02896212e-02]
mat_Sqrt:  [[ 2.02135438e+01  0.00000000e+00]
 [-8.02890988e-03  1.83965436e-02]]
grads:  [-0.00336395 -3.23070183]
Stock Position:  -0.0033639471693915303
Bond Position:  [-0.77096336]


portfolio before change:  [-1.11174741]
curr_Stock_Price:  101.27616450516737
curr_Factors:  [1.01276165e+02 3.92459646e-02]
mat_Sqrt:  [[ 2.00634101e+01  0.00000000e+00]
 [-7.92423771e-03  1.81567096e-02]]
grads:  [ 0.00763621 -2.16903247]
Stock Position:  0.007636214854154746
Bond Position:  [-1.88511396]


portfolio before change:  [-1.11203948]
curr_Stock_Price:  101.26877670350716
curr_Factors:  [1.01268777e+02 4.07658812e-02]
mat_Sqrt:  [[ 2.04467356e+01  0.00000000e+00]
 [-8.07622498e-03  1.85049562e-02]]
grads:  [ 0.02823947 -7.4641837 ]
Stock Position:  0.02823946937957528
Bond Position:  [-3.97181599]


portfolio before change:  [-1.12067896]
curr_Stock_Price:  100.98042221075706
curr_Factors:  [1.00980422e+02 3.98861621e-02]
mat_Sqrt:  [[ 2.01673255e+01  0.00000000e+00]
 [-7.98860810e-03  1.83042007e-02]]
grads:  [-5.50602159e-03 -1.74928466e+01]
Stock Position:  -0.005506021594011894
Bond Position:  [-0.56467858]


portfolio before change:  [-1.12203437]
curr_Stock_Price:  101.21376990678652
curr_Factors:  [1.01213770e+02 3.92563634e-02]
mat_Sqrt:  [[ 2.00537056e+01  0.00000000e+00]
 [-7.92528747e-03  1.81591149e-02]]
grads:  [0.00248752 0.55574231]
Stock Position:  0.0024875234591980613
Bond Position:  [-1.373806]


portfolio before change:  [-1.11371139]
curr_Stock_Price:  104.62869774108381
curr_Factors:  [1.04628698e+02 3.71464007e-02]
mat_Sqrt:  [[ 2.01655090e+01  0.00000000e+00]
 [-7.70936061e-03  1.76643643e-02]]
grads:  [ 1.31592731e-02 -2.24422603e+01]
Stock Position:  0.013159273102879652
Bond Position:  [-2.490549]


portfolio before change:  [-1.12825416]
curr_Stock_Price:  103.54722224617853
curr_Factors:  [1.03547222e+02 3.86645304e-02]
mat_Sqrt:  [[ 2.03607993e+01  0.00000000e+00]
 [-7.86531936e-03  1.80217107e-02]]
grads:  [-0.00781857 -0.22708568]
Stock Position:  -0.007818567809105453
Bond Position:  [-0.31866318]


portfolio before change:  [-1.1339292]
curr_Stock_Price:  104.2679691029578
curr_Factors:  [1.04267969e+02 3.69986869e-02]
mat_Sqrt:  [[ 2.00559884e+01  0.00000000e+00]
 [-7.69401709e-03  1.76292079e-02]]
grads:  [-4.88200436e-03  6.66132151e+00]
Stock Position:  -0.004882004358619054
Bond Position:  [-0.62489253]


portfolio before change:  [-1.13906714]
curr_Stock_Price:  105.30439170899194
curr_Factors:  [1.05304392e+02 3.69649539e-02]
mat_Sqrt:  [[ 2.02461089e+01  0.00000000e+00]
 [-7.69050885e-03  1.76211695e-02]]
grads:  [-0.00513681 -3.07874032]
Stock Position:  -0.005136813369689831
Bond Position:  [-0.59813813]


portfolio before change:  [-1.1472882]
curr_Stock_Price:  106.8902556286536
curr_Factors:  [1.06890256e+02 3.58011346e-02]
mat_Sqrt:  [[ 2.02249059e+01  0.00000000e+00]
 [-7.56847510e-03  1.73415550e-02]]
grads:  [5.16639059e-04 1.26425805e+01]
Stock Position:  0.0005166390593386486
Bond Position:  [-1.20251188]


portfolio before change:  [-1.14728642]
curr_Stock_Price:  107.18466318175389
curr_Factors:  [1.07184663e+02 3.64791365e-02]
mat_Sqrt:  [[ 2.04717478e+01  0.00000000e+00]
 [-7.63980486e-03  1.75049920e-02]]
grads:  [-1.69706551e-02  2.92236268e+01]
Stock Position:  -0.016970655059688596
Bond Position:  [0.67170753]


portfolio before change:  [-1.17770769]
curr_Stock_Price:  108.98219196180844
curr_Factors:  [1.08982192e+02 3.43335275e-02]
mat_Sqrt:  [[ 2.01936466e+01  0.00000000e+00]
 [-7.41172342e-03  1.69823918e-02]]
grads:  [-3.24822528e-03  4.18292668e+00]
Stock Position:  -0.0032482252843785402
Bond Position:  [-0.82370898]


portfolio before change:  [-1.16962539]
curr_Stock_Price:  106.46226901681513
curr_Factors:  [1.06462269e+02 3.40712518e-02]
mat_Sqrt:  [[ 1.96512311e+01  0.00000000e+00]
 [-7.38335986e-03  1.69174027e-02]]
grads:  [ 0.0036915  -0.70620705]
Stock Position:  0.003691503927309853
Bond Position:  [-1.56263127]


portfolio before change:  [-1.17397305]
curr_Stock_Price:  105.33743606102361
curr_Factors:  [1.05337436e+02 3.46392221e-02]
mat_Sqrt:  [[ 1.96049983e+01  0.00000000e+00]
 [-7.44464608e-03  1.70578271e-02]]
grads:  [-0.01242293 -0.94238762]
Stock Position:  -0.01242292570728252
Bond Position:  [0.13462609]


portfolio before change:  [-1.17985267]
curr_Stock_Price:  105.81207840203686
curr_Factors:  [1.05812078e+02 3.32317739e-02]
mat_Sqrt:  [[ 1.92891019e+01  0.00000000e+00]
 [-7.29183367e-03  1.67076899e-02]]
grads:  [0.00526054 3.19308422]
Stock Position:  0.005260544126276969
Bond Position:  [-1.73648178]


portfolio before change:  [-1.17231883]
curr_Stock_Price:  107.28548452895245
curr_Factors:  [1.07285485e+02 3.19740530e-02]
mat_Sqrt:  [[ 1.91840286e+01  0.00000000e+00]
 [-7.15251598e-03  1.63884729e-02]]
grads:  [-4.93470965e-03  4.96233825e+00]
Stock Position:  -0.004934709646805803
Bond Position:  [-0.64289611]


portfolio before change:  [-1.17535597]
curr_Stock_Price:  107.88466348839775
curr_Factors:  [1.07884663e+02 3.27148939e-02]
mat_Sqrt:  [[ 1.95133785e+01  0.00000000e+00]
 [-7.23490361e-03  1.65772467e-02]]
grads:  [-0.02335577 -5.47194939]
Stock Position:  -0.023355765408491477
Bond Position:  [1.34437293]


portfolio before change:  [-1.13356334]
curr_Stock_Price:  106.10246653223084
curr_Factors:  [1.06102467e+02 3.26923603e-02]
mat_Sqrt:  [[ 1.91844176e+01  0.00000000e+00]
 [-7.23241153e-03  1.65715366e-02]]
grads:  [-5.10480746e-03 -9.43510635e+00]
Stock Position:  -0.00510480745823934
Bond Position:  [-0.59193067]


portfolio before change:  [-1.13095386]
curr_Stock_Price:  105.57679083482252
curr_Factors:  [1.05576791e+02 3.30387637e-02]
mat_Sqrt:  [[ 1.91902375e+01  0.00000000e+00]
 [-7.27062734e-03  1.66591001e-02]]
grads:  [-1.94303451e-03 -3.87881087e+00]
Stock Position:  -0.0019430345091908893
Bond Position:  [-0.92581451]


portfolio before change:  [-1.12756454]
curr_Stock_Price:  103.77288544581572
curr_Factors:  [1.03772885e+02 3.39063842e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.12756454]
Stock Price:  102.6818532695131
PL:  [-3.80941781]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.06467137e+00  2.69602081e-01]
 [ 4.19857047e-01  1.20776441e-01]
 [ 1.10336933e-01 -1.73068676e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.06689932e-01 -1.87195147e-01]
 [-3.53430147e-01  1.83392894e-01]
 [ 2.12891368e-01 -2.29113568e-01]
 [-5.24612413e-01  2.47830353e-01]
 [-1.18158034e-01 -9.83415832e-02]
 [-2.10880685e-02 -2.35120012e-01]
 [-6.12880619e-02 -1.43761932e-02]
 [-3.79166484e-02 -1.33871880e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 2.32206191e-02 -1.99742594e-01]
 [-5.28062629e-02 -9.46855309e-02]
 [ 1.13821441e-01 -7.25698883e-01]
 [ 2.34425379e-02 -2.00972732e-01]
 [ 3.93694826e-02 -1.61528681e-01]
 [-1.18947905e-01 -3.07937765e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.44765180e-01 -2.96603200e-02]
 [ 3.61834400e-01 -3.61446954e-01]
 [ 2.82097787e-02 -3.59253851e-01]
 [ 4.33580844e-02  2.84401937e-02]
 [ 4.26848328e-01 -3.60808488e-01]
 [ 4.14277837e-02 -7.05114128e-02]
 [-1.60011152e-01  8.46522993e-02]
 [-1.32587430e-02  2.11517278e-01]
 [-7.36727752e-02  2.09873246e-01]
 [-7.03209853e-01  1.56858943e-01]
 [-1.22473636e-01  2.92430366e-03]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.59187313e-01  5.04018410e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.46108996e-01 -1.89474076e-02]
 [-2.77020495e-02 -1.74800348e-01]
 [-3.71682288e-03 -5.62272282e-02]
 [-4.94600540e-02 -3.84966624e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.54982171]
curr_Stock_Price:  101.14211983831696
curr_Factors:  [1.01142120e+02 4.01255636e-02]
mat_Sqrt:  [[ 2.02601485e+01  0.00000000e+00]
 [-8.01254652e-03  1.83590505e-02]]
grads:  [ 0.05835769 14.68496868]
Stock Position:  0.05835768509775062
Bond Position:  [4.64740173]


portfolio before change:  [10.48285294]
curr_Stock_Price:  99.98460764720068
curr_Factors:  [9.99846076e+01 4.04917621e-02]
mat_Sqrt:  [[ 2.01194676e+01  0.00000000e+00]
 [-8.04902599e-03  1.84426354e-02]]
grads:  [0.02348811 6.54876259]
Stock Position:  0.023488106953639912
Bond Position:  [8.13440378]


portfolio before change:  [10.49133201]
curr_Stock_Price:  100.30230917761932
curr_Factors:  [1.00302309e+02 4.10723367e-02]
mat_Sqrt:  [[ 2.03275781e+01  0.00000000e+00]
 [-8.10652446e-03  1.85743810e-02]]
grads:  [ 0.00505636 -0.93176013]
Stock Position:  0.005056362190872687
Bond Position:  [9.98416721]


portfolio before change:  [10.49764461]
curr_Stock_Price:  101.3039190458098
curr_Factors:  [1.01303919e+02 3.95409268e-02]
mat_Sqrt:  [[ 2.01441835e+01  0.00000000e+00]
 [-7.95396020e-03  1.82248123e-02]]
grads:  [-8.09234435e-04 -8.30663217e+00]
Stock Position:  -0.000809234435334837
Bond Position:  [10.57962323]


portfolio before change:  [10.49896434]
curr_Stock_Price:  101.30738812296788
curr_Factors:  [1.01307388e+02 3.95540115e-02]
mat_Sqrt:  [[ 2.01482062e+01  0.00000000e+00]
 [-7.95527614e-03  1.82278275e-02]]
grads:  [-9.35014216e-03 -1.02697454e+01]
Stock Position:  -0.009350142158055947
Bond Position:  [11.44620282]


portfolio before change:  [10.49566911]
curr_Stock_Price:  101.8128452594662
curr_Factors:  [1.01812845e+02 3.91601373e-02]
mat_Sqrt:  [[ 2.01476630e+01  0.00000000e+00]
 [-7.91556818e-03  1.81368452e-02]]
grads:  [-0.01356936 10.11162039]
Stock Position:  -0.013569361698386169
Bond Position:  [11.87720443]


portfolio before change:  [10.49373929]
curr_Stock_Price:  102.06448340255552
curr_Factors:  [1.02064483e+02 3.84218691e-02]
mat_Sqrt:  [[ 2.00061668e+01  0.00000000e+00]
 [-7.84059887e-03  1.79650689e-02]]
grads:  [ 5.64316043e-03 -1.27532808e+01]
Stock Position:  0.0056431604324702
Bond Position:  [9.91777303]


portfolio before change:  [10.49832311]
curr_Stock_Price:  102.65706416192785
curr_Factors:  [1.02657064e+02 3.85603368e-02]
mat_Sqrt:  [[ 2.01585481e+01  0.00000000e+00]
 [-7.85471443e-03  1.79974117e-02]]
grads:  [-0.02065875 13.77033304]
Stock Position:  -0.02065874870193132
Bond Position:  [12.6190896]


portfolio before change:  [10.50416527]
curr_Stock_Price:  102.45062997633735
curr_Factors:  [1.02450630e+02 3.72573489e-02]
mat_Sqrt:  [[ 1.97751874e+01  0.00000000e+00]
 [-7.72086512e-03  1.76907244e-02]]
grads:  [-0.00814545 -5.55893478]
Stock Position:  -0.00814545098100375
Bond Position:  [11.33867185]


portfolio before change:  [10.51201648]
curr_Stock_Price:  101.66076678573332
curr_Factors:  [1.01660767e+02 3.70133266e-02]
mat_Sqrt:  [[ 1.95583602e+01  0.00000000e+00]
 [-7.69553913e-03  1.76326953e-02]]
grads:  [-6.32480704e-03 -1.33343206e+01]
Stock Position:  -0.006324807039993436
Bond Position:  [11.15500122]


portfolio before change:  [10.50798526]
curr_Stock_Price:  102.51860873887867
curr_Factors:  [1.02518609e+02 3.67058508e-02]
mat_Sqrt:  [[ 1.96413055e+01  0.00000000e+00]
 [-7.66350842e-03  1.75593037e-02]]
grads:  [-0.00343981 -0.81872228]
Stock Position:  -0.003439809380541694
Bond Position:  [10.86062973]


portfolio before change:  [10.50965285]
curr_Stock_Price:  102.42851068216024
curr_Factors:  [1.02428511e+02 3.75054016e-02]
mat_Sqrt:  [[ 1.98366243e+01  0.00000000e+00]
 [-7.74652455e-03  1.77495176e-02]]
grads:  [-4.85683074e-03 -7.54228274e+00]
Stock Position:  -0.004856830744468121
Bond Position:  [11.00713079]


portfolio before change:  [10.50958065]
curr_Stock_Price:  102.72668293763854
curr_Factors:  [1.02726683e+02 3.84422523e-02]
mat_Sqrt:  [[ 2.01413083e+01  0.00000000e+00]
 [-7.84267835e-03  1.79698336e-02]]
grads:  [-0.0032525  -0.99555752]
Stock Position:  -0.0032524958197188134
Bond Position:  [10.84369876]


portfolio before change:  [10.50789018]
curr_Stock_Price:  103.66320013082616
curr_Factors:  [1.03663200e+02 3.88899724e-02]
mat_Sqrt:  [[ 2.04429435e+01  0.00000000e+00]
 [-7.88821626e-03  1.80741741e-02]]
grads:  [-3.12842403e-03 -1.10512709e+01]
Stock Position:  -0.0031284240334478507
Bond Position:  [10.83219263]


portfolio before change:  [10.50394029]
curr_Stock_Price:  105.35862193366648
curr_Factors:  [1.05358622e+02 3.90882258e-02]
mat_Sqrt:  [[ 2.08301818e+01  0.00000000e+00]
 [-7.90829699e-03  1.81201848e-02]]
grads:  [-4.51894358e-03 -5.22541751e+00]
Stock Position:  -0.004518943584972922
Bond Position:  [10.98004996]


portfolio before change:  [10.51299928]
curr_Stock_Price:  103.6576935347691
curr_Factors:  [1.03657694e+02 4.00774070e-02]
mat_Sqrt:  [[ 2.07515886e+01  0.00000000e+00]
 [-8.00773695e-03  1.83480304e-02]]
grads:  [-9.77754145e-03 -3.95518684e+01]
Stock Position:  -0.00977754145115263
Bond Position:  [11.52651668]


portfolio before change:  [10.51409506]
curr_Stock_Price:  103.69299166632966
curr_Factors:  [1.03692992e+02 4.10101694e-02]
mat_Sqrt:  [[ 2.09988343e+01  0.00000000e+00]
 [-8.10038709e-03  1.85603185e-02]]
grads:  [-3.06060577e-03 -1.08280864e+01]
Stock Position:  -0.0030606057736245716
Bond Position:  [10.83145843]


portfolio before change:  [10.51039554]
curr_Stock_Price:  105.34414808883255
curr_Factors:  [1.05344148e+02 4.02265084e-02]
mat_Sqrt:  [[ 2.11283987e+01  0.00000000e+00]
 [-8.02261887e-03  1.83821291e-02]]
grads:  [-1.47325000e-03 -8.78726727e+00]
Stock Position:  -0.0014732500048389217
Bond Position:  [10.6655938]


portfolio before change:  [10.5123847]
curr_Stock_Price:  104.8989547946594
curr_Factors:  [1.04898955e+02 3.89725267e-02]
mat_Sqrt:  [[ 2.07085859e+01  0.00000000e+00]
 [-7.89658425e-03  1.80933475e-02]]
grads:  [-1.22337163e-02 -1.70193915e+01]
Stock Position:  -0.012233716304078998
Bond Position:  [11.79568875]


portfolio before change:  [10.52269842]
curr_Stock_Price:  104.17642975752385
curr_Factors:  [1.0417643e+02 3.8346685e-02]
mat_Sqrt:  [[ 2.04001510e+01  0.00000000e+00]
 [-7.83292385e-03  1.79474832e-02]]
grads:  [-2.37552506e-04 -6.07847841e+00]
Stock Position:  -0.00023755250639275296
Bond Position:  [10.54744579]


portfolio before change:  [10.52423182]
curr_Stock_Price:  103.27182298952292
curr_Factors:  [1.03271823e+02 4.00187966e-02]
mat_Sqrt:  [[ 2.06592169e+01  0.00000000e+00]
 [-8.00187944e-03  1.83346091e-02]]
grads:  [ 0.0063807  -1.61772306]
Stock Position:  0.006380704330516223
Bond Position:  [9.86528485]


portfolio before change:  [10.53388567]
curr_Stock_Price:  104.59152161395797
curr_Factors:  [1.04591522e+02 3.96431702e-02]
mat_Sqrt:  [[ 2.08247919e+01  0.00000000e+00]
 [-7.96423708e-03  1.82483596e-02]]
grads:  [ 9.80014676e-03 -1.98070929e+01]
Stock Position:  0.009800146759408523
Bond Position:  [9.50887341]


portfolio before change:  [10.52685845]
curr_Stock_Price:  103.75317741892114
curr_Factors:  [1.03753177e+02 3.91417586e-02]
mat_Sqrt:  [[ 2.05268152e+01  0.00000000e+00]
 [-7.91371049e-03  1.81325887e-02]]
grads:  [-6.26407237e-03 -1.98126068e+01]
Stock Position:  -0.006264072366933846
Bond Position:  [11.17677587]


portfolio before change:  [10.52963987]
curr_Stock_Price:  103.53219734616863
curr_Factors:  [1.03532197e+02 3.81628825e-02]
mat_Sqrt:  [[ 2.02253486e+01  0.00000000e+00]
 [-7.81412899e-03  1.79044188e-02]]
grads:  [0.00275745 1.58844551]
Stock Position:  0.0027574507410018834
Bond Position:  [10.24415494]


portfolio before change:  [10.53173291]
curr_Stock_Price:  103.82683048721404
curr_Factors:  [1.0382683e+02 3.8568508e-02]
mat_Sqrt:  [[ 2.03904127e+01  0.00000000e+00]
 [-7.85554662e-03  1.79993185e-02]]
grads:  [ 1.32110418e-02 -2.00456749e+01]
Stock Position:  0.013211041754833732
Bond Position:  [9.16007232]


portfolio before change:  [10.50936511]
curr_Stock_Price:  102.04704031968622
curr_Factors:  [1.02047040e+02 4.12705252e-02]
mat_Sqrt:  [[ 2.07310076e+01  0.00000000e+00]
 [-8.12605933e-03  1.86191410e-02]]
grads:  [ 5.13920039e-04 -3.78703899e+00]
Stock Position:  0.0005139200389105687
Bond Position:  [10.45692109]


portfolio before change:  [10.51122363]
curr_Stock_Price:  103.11982038771056
curr_Factors:  [1.03119820e+02 4.12726115e-02]
mat_Sqrt:  [[ 2.09494740e+01  0.00000000e+00]
 [-8.12626472e-03  1.86196116e-02]]
grads:  [-0.00587441  4.54640521]
Stock Position:  -0.005874412869160002
Bond Position:  [11.11699203]


portfolio before change:  [10.51437233]
curr_Stock_Price:  102.82038695294386
curr_Factors:  [1.02820387e+02 4.10526303e-02]
mat_Sqrt:  [[ 2.08328999e+01  0.00000000e+00]
 [-8.10457947e-03  1.85699245e-02]]
grads:  [3.79471728e-03 1.13903144e+01]
Stock Position:  0.003794717276202668
Bond Position:  [10.12419804]


portfolio before change:  [10.52397523]
curr_Stock_Price:  105.01746599405404
curr_Factors:  [1.05017466e+02 4.07309188e-02]
mat_Sqrt:  [[ 2.11945226e+01  0.00000000e+00]
 [-8.07276100e-03  1.84970192e-02]]
grads:  [8.45662768e-04 1.13463280e+01]
Stock Position:  0.0008456627681061521
Bond Position:  [10.43516587]


portfolio before change:  [10.5257058]
curr_Stock_Price:  105.5213167718034
curr_Factors:  [1.05521317e+02 4.06605632e-02]
mat_Sqrt:  [[ 2.12778085e+01  0.00000000e+00]
 [-8.06578583e-03  1.84810371e-02]]
grads:  [-0.0298316   8.48756175]
Stock Position:  -0.02983159643986461
Bond Position:  [13.67357514]


portfolio before change:  [10.51963082]
curr_Stock_Price:  105.78225764177438
curr_Factors:  [1.05782258e+02 3.90031407e-02]
mat_Sqrt:  [[ 2.08911632e+01  0.00000000e+00]
 [-7.89968513e-03  1.81004525e-02]]
grads:  [-0.00580137  0.1615597 ]
Stock Position:  -0.005801369875914003
Bond Position:  [11.13331282]


portfolio before change:  [10.52943902]
curr_Stock_Price:  104.3314875373367
curr_Factors:  [1.04331488e+02 4.00291865e-02]
mat_Sqrt:  [[ 2.08739088e+01  0.00000000e+00]
 [-8.00291811e-03  1.83369890e-02]]
grads:  [ 0.00347528 -0.65153494]
Stock Position:  0.003475276120628712
Bond Position:  [10.1668583]


portfolio before change:  [10.52878718]
curr_Stock_Price:  103.77821281466123
curr_Factors:  [1.03778213e+02 4.08192598e-02]
mat_Sqrt:  [[ 2.09671185e+01  0.00000000e+00]
 [-8.08151073e-03  1.85170673e-02]]
grads:  [-0.01131248  2.72191271]
Stock Position:  -0.011312481798665378
Bond Position:  [11.70277632]


portfolio before change:  [10.52799952]
curr_Stock_Price:  103.9771606966563
curr_Factors:  [1.03977161e+02 3.99197606e-02]
mat_Sqrt:  [[ 2.07745640e+01  0.00000000e+00]
 [-7.99197204e-03  1.83119084e-02]]
grads:  [0.00488439 2.91335341]
Stock Position:  0.004884394763727144
Bond Position:  [10.02013402]


portfolio before change:  [10.53561364]
curr_Stock_Price:  105.27957833376998
curr_Factors:  [1.05279578e+02 3.94287337e-02]
mat_Sqrt:  [[ 2.09050183e+01  0.00000000e+00]
 [-7.94266794e-03  1.81989385e-02]]
grads:  [-0.00452846  4.46867525]
Stock Position:  -0.004528463429498543
Bond Position:  [11.01236836]


portfolio before change:  [10.53736338]
curr_Stock_Price:  105.19718583962158
curr_Factors:  [1.05197186e+02 3.87988090e-02]
mat_Sqrt:  [[ 2.07211244e+01  0.00000000e+00]
 [-7.87896531e-03  1.80529775e-02]]
grads:  [-0.01710227 -1.04954474]
Stock Position:  -0.017102272766333623
Bond Position:  [12.33647435]


portfolio before change:  [10.55130857]
curr_Stock_Price:  104.47195902547831
curr_Factors:  [1.04471959e+02 4.01329035e-02]
mat_Sqrt:  [[ 2.09290747e+01  0.00000000e+00]
 [-8.01327932e-03  1.83607295e-02]]
grads:  [-4.96874215e-03 -9.52033782e+00]
Stock Position:  -0.004968742151038011
Bond Position:  [11.07040279]


portfolio before change:  [10.56029095]
curr_Stock_Price:  102.94269898787682
curr_Factors:  [1.02942699e+02 4.17799782e-02]
mat_Sqrt:  [[ 2.10416433e+01  0.00000000e+00]
 [-8.17606049e-03  1.87337080e-02]]
grads:  [-1.34287977e-03 -3.00139343e+00]
Stock Position:  -0.0013428797674823643
Bond Position:  [10.69853062]


portfolio before change:  [10.56226107]
curr_Stock_Price:  102.47153218397351
curr_Factors:  [1.02471532e+02 4.31137530e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.56226107]
Stock Price:  101.02990176120507
PL:  [9.53235931]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.13655871e+00  2.85854368e-01]
 [ 5.71916661e-01  1.19204904e-01]
 [ 1.10894096e-01 -4.67595152e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.06457740e-01  7.59197759e-01]
 [-7.15719540e-02 -1.20469399e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.21826744e-01  8.14678480e-01]
 [-5.25067245e-04  3.31057547e-01]
 [ 1.96627343e-01  1.11103007e-01]
 [-2.80397281e-02  1.74251984e-02]
 [ 3.37405609e-02 -1.37298414e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-5.29255122e-02 -1.88423907e-02]
 [ 4.80188171e-01  3.08530498e-01]
 [ 1.31653779e-01 -2.09832929e-01]
 [ 3.70236308e-02 -5.05419911e-02]
 [ 8.61097950e-03 -8.56384683e-02]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.49427568e-01 -3.12278000e-02]
 [ 4.07898755e-01 -3.39812260e-01]
 [ 2.76296819e-02 -3.43899239e-01]
 [ 3.87836349e-02  3.41319655e-02]
 [ 4.09986013e-01 -3.22516361e-01]
 [-9.98187321e-03 -4.83847383e-02]
 [-1.52834675e-01  1.06344046e-01]
 [-4.36356417e-02  8.72224179e-02]
 [-5.04566529e-02  1.99624481e-01]
 [-6.43123550e-01 -6.37225523e-02]
 [-1.67681369e-01 -6.01143790e-02]
 [ 1.26946875e-02 -6.50635834e-02]
 [-2.59588659e-01  1.37027427e-01]
 [ 3.76229514e-02  3.83198688e-02]
 [-2.40826177e-02  5.02623864e-02]
 [-1.98456042e-01  9.29962786e-02]
 [-2.50912391e-02 -1.98519965e-01]
 [ 2.43804967e-02 -2.24012151e-02]
 [-3.71475620e-02 -9.98750498e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.41646739]
curr_Stock_Price:  100.83245286642739
curr_Factors:  [1.00832453e+02 4.10053277e-02]
mat_Sqrt:  [[ 2.04183421e+01  0.00000000e+00]
 [-8.09990891e-03  1.85592228e-02]]
grads:  [ 0.06177366 15.40228112]
Stock Position:  0.061773663020503945
Bond Position:  [2.18767743]


portfolio before change:  [8.34159827]
curr_Stock_Price:  99.6160347717091
curr_Factors:  [9.96160348e+01 4.10720306e-02]
mat_Sqrt:  [[ 2.01884203e+01  0.00000000e+00]
 [-8.10649425e-03  1.85743118e-02]]
grads:  [0.03090593 6.41772925]
Stock Position:  0.030905932030166717
Bond Position:  [5.26287187]


portfolio before change:  [8.33492675]
curr_Stock_Price:  99.37888228081626
curr_Factors:  [9.93788823e+01 4.00091821e-02]
mat_Sqrt:  [[ 1.98780576e+01  0.00000000e+00]
 [-8.00091816e-03  1.83324065e-02]]
grads:  [ 0.00455208 -2.55064795]
Stock Position:  0.004552083124967904
Bond Position:  [7.88254582]


portfolio before change:  [8.329306]
curr_Stock_Price:  97.92765030002906
curr_Factors:  [9.79276503e+01 3.94631868e-02]
mat_Sqrt:  [[ 1.94536640e+01  0.00000000e+00]
 [-7.94613736e-03  1.82068880e-02]]
grads:  [-8.37958697e-04 -8.31480991e+00]
Stock Position:  -0.0008379586974575492
Bond Position:  [8.41136533]


portfolio before change:  [8.33056438]
curr_Stock_Price:  97.68074477867594
curr_Factors:  [9.76807448e+01 3.92697879e-02]
mat_Sqrt:  [[ 1.93570085e+01  0.00000000e+00]
 [-7.92664245e-03  1.81622195e-02]]
grads:  [1.16176695e-02 4.18009351e+01]
Stock Position:  0.01161766946354634
Bond Position:  [7.19574178]


portfolio before change:  [8.34443097]
curr_Stock_Price:  98.79689516994148
curr_Factors:  [9.87968952e+01 3.86720221e-02]
mat_Sqrt:  [[ 1.94286103e+01  0.00000000e+00]
 [-7.86608132e-03  1.80234565e-02]]
grads:  [-6.39001495e-03 -6.68403416e+00]
Stock Position:  -0.006390014953519052
Bond Position:  [8.97574461]


portfolio before change:  [8.34864915]
curr_Stock_Price:  98.31236825055672
curr_Factors:  [9.83123683e+01 3.92072410e-02]
mat_Sqrt:  [[ 1.94666535e+01  0.00000000e+00]
 [-7.92032737e-03  1.81477498e-02]]
grads:  [0.00664592 5.29745494]
Stock Position:  0.006645917703734163
Bond Position:  [7.69527324]


portfolio before change:  [8.34762517]
curr_Stock_Price:  98.01354699064758
curr_Factors:  [9.80135470e+01 3.78495943e-02]
mat_Sqrt:  [[ 1.90685083e+01  0.00000000e+00]
 [-7.78198888e-03  1.78307765e-02]]
grads:  [ 0.06174482 45.68945597]
Stock Position:  0.061744818329557645
Bond Position:  [2.29579652]


portfolio before change:  [8.34353508]
curr_Stock_Price:  97.94265701201984
curr_Factors:  [9.79426570e+01 3.64109315e-02]
mat_Sqrt:  [[ 1.86890737e+01  0.00000000e+00]
 [-7.63265946e-03  1.74886199e-02]]
grads:  [7.70291208e-03 1.89298841e+01]
Stock Position:  0.007702912083301498
Bond Position:  [7.5890914]


portfolio before change:  [8.34697587]
curr_Stock_Price:  98.2661837486846
curr_Factors:  [9.82661837e+01 3.66632111e-02]
mat_Sqrt:  [[ 1.88156549e+01  0.00000000e+00]
 [-7.65905594e-03  1.75491018e-02]]
grads:  [0.01302727 6.33097967]
Stock Position:  0.01302727281083057
Bond Position:  [7.06683549]


portfolio before change:  [8.32770832]
curr_Stock_Price:  96.71935519105128
curr_Factors:  [9.67193552e+01 3.75156444e-02]
mat_Sqrt:  [[ 1.87335290e+01  0.00000000e+00]
 [-7.74758227e-03  1.77519411e-02]]
grads:  [-0.00109081  0.98159397]
Stock Position:  -0.0010908114529411671
Bond Position:  [8.4332109]


portfolio before change:  [8.32722094]
curr_Stock_Price:  98.13261669499649
curr_Factors:  [9.81326167e+01 3.53356305e-02]
mat_Sqrt:  [[ 1.84467475e+01  0.00000000e+00]
 [-7.51910958e-03  1.72284444e-02]]
grads:  [-1.41929517e-03 -7.96928678e+00]
Stock Position:  -0.001419295173527538
Bond Position:  [8.46650009]


portfolio before change:  [8.32680497]
curr_Stock_Price:  99.17140815656238
curr_Factors:  [9.91714082e+01 3.67050369e-02]
mat_Sqrt:  [[ 1.89998124e+01  0.00000000e+00]
 [-7.66342345e-03  1.75591090e-02]]
grads:  [-0.0068079  -1.59754149]
Stock Position:  -0.00680790344943392
Bond Position:  [9.00195434]


portfolio before change:  [8.32676199]
curr_Stock_Price:  99.34301569485744
curr_Factors:  [9.93430157e+01 3.61717579e-02]
mat_Sqrt:  [[ 1.88939233e+01  0.00000000e+00]
 [-7.60754971e-03  1.74310862e-02]]
grads:  [-0.00323644 -1.08096481]
Stock Position:  -0.003236437708945044
Bond Position:  [8.64827948]


portfolio before change:  [8.3277209]
curr_Stock_Price:  99.38077314832559
curr_Factors:  [9.93807731e+01 3.62510894e-02]
mat_Sqrt:  [[ 1.89218198e+01  0.00000000e+00]
 [-7.61588754e-03  1.74501906e-02]]
grads:  [ 0.0324938  17.68063772]
Stock Position:  0.032493804825593275
Bond Position:  [5.09846145]


portfolio before change:  [8.34331813]
curr_Stock_Price:  99.84116504361077
curr_Factors:  [9.98411650e+01 3.62954838e-02]
mat_Sqrt:  [[ 1.90211134e+01  0.00000000e+00]
 [-7.62054946e-03  1.74608724e-02]]
grads:  [ 2.10687878e-03 -1.20173222e+01]
Stock Position:  0.0021068787841415273
Bond Position:  [8.1329649]


portfolio before change:  [8.34725894]
curr_Stock_Price:  101.22905996014572
curr_Factors:  [1.01229060e+02 3.58911589e-02]
mat_Sqrt:  [[ 1.91778070e+01  0.00000000e+00]
 [-7.57798484e-03  1.73633446e-02]]
grads:  [ 7.80344565e-04 -2.91084422e+00]
Stock Position:  0.0007803445648906023
Bond Position:  [8.26826539]


portfolio before change:  [8.34739302]
curr_Stock_Price:  100.07634924674862
curr_Factors:  [1.00076349e+02 3.66763800e-02]
mat_Sqrt:  [[ 1.91657000e+01  0.00000000e+00]
 [-7.66043132e-03  1.75522532e-02]]
grads:  [-1.50084329e-03 -4.87905840e+00]
Stock Position:  -0.0015008432897426127
Bond Position:  [8.49759194]


portfolio before change:  [8.34578599]
curr_Stock_Price:  101.85488291236834
curr_Factors:  [1.01854883e+02 3.63090652e-02]
mat_Sqrt:  [[ 1.94083845e+01  0.00000000e+00]
 [-7.62197510e-03  1.74641389e-02]]
grads:  [-1.64245068e-02 -2.68715020e+01]
Stock Position:  -0.016424506844493834
Bond Position:  [10.01870221]


portfolio before change:  [8.33318058]
curr_Stock_Price:  102.69861141210217
curr_Factors:  [1.02698611e+02 3.57030810e-02]
mat_Sqrt:  [[ 1.94051686e+01  0.00000000e+00]
 [-7.55810357e-03  1.73177909e-02]]
grads:  [-2.49732796e-04 -6.29949802e+00]
Stock Position:  -0.0002497327964000255
Bond Position:  [8.35882779]


portfolio before change:  [8.33416075]
curr_Stock_Price:  102.95787924372786
curr_Factors:  [1.02957879e+02 3.54383008e-02]
mat_Sqrt:  [[ 1.93818859e+01  0.00000000e+00]
 [-7.53002532e-03  1.72534555e-02]]
grads:  [ 0.00700647 -1.80994468]
Stock Position:  0.007006471882471086
Bond Position:  [7.61278927]


portfolio before change:  [8.33922315]
curr_Stock_Price:  103.54458498737301
curr_Factors:  [1.03544585e+02 3.41475250e-02]
mat_Sqrt:  [[ 1.91340546e+01  0.00000000e+00]
 [-7.39161958e-03  1.69363281e-02]]
grads:  [ 1.35670422e-02 -2.00641047e+01]
Stock Position:  0.01356704224706053
Bond Position:  [6.93442939]


portfolio before change:  [8.34772076]
curr_Stock_Price:  104.10703291860315
curr_Factors:  [1.04107033e+02 3.21736939e-02]
mat_Sqrt:  [[ 1.86737066e+01  0.00000000e+00]
 [-7.17481081e-03  1.64395568e-02]]
grads:  [-6.55789732e-03 -2.09190091e+01]
Stock Position:  -0.006557897324924438
Bond Position:  [9.03044399]


portfolio before change:  [8.3497512]
curr_Stock_Price:  103.96955553683202
curr_Factors:  [1.03969556e+02 3.16799243e-02]
mat_Sqrt:  [[ 1.85053905e+01  0.00000000e+00]
 [-7.11954204e-03  1.63129202e-02]]
grads:  [0.00290078 2.09232714]
Stock Position:  0.0029007788756620504
Bond Position:  [8.04815851]


portfolio before change:  [8.34808627]
curr_Stock_Price:  103.04876500064346
curr_Factors:  [1.03048765e+02 3.21883419e-02]
mat_Sqrt:  [[ 1.84880920e+01  0.00000000e+00]
 [-7.17644390e-03  1.64432987e-02]]
grads:  [ 1.45622562e-02 -1.96138480e+01]
Stock Position:  0.014562256213010653
Bond Position:  [6.84746375]


portfolio before change:  [8.33903802]
curr_Stock_Price:  102.36863433119018
curr_Factors:  [1.02368634e+02 3.24957396e-02]
mat_Sqrt:  [[ 1.84535584e+01  0.00000000e+00]
 [-7.21062989e-03  1.65216286e-02]]
grads:  [-1.68524160e-03 -2.92856954e+00]
Stock Position:  -0.0016852416021483723
Bond Position:  [8.5115539]


portfolio before change:  [8.33755885]
curr_Stock_Price:  103.87772548577044
curr_Factors:  [1.03877725e+02 3.14792476e-02]
mat_Sqrt:  [[ 1.84303933e+01  0.00000000e+00]
 [-7.09695682e-03  1.62611709e-02]]
grads:  [-5.77428418e-03  6.53975327e+00]
Stock Position:  -0.005774284182109732
Bond Position:  [8.93737836]


portfolio before change:  [8.33837736]
curr_Stock_Price:  103.92945947434961
curr_Factors:  [1.03929459e+02 3.08800231e-02]
mat_Sqrt:  [[ 1.82632253e+01  0.00000000e+00]
 [-7.02908507e-03  1.61056572e-02]]
grads:  [-3.04910967e-04  5.41563855e+00]
Stock Position:  -0.00030491096717248363
Bond Position:  [8.3700666]


portfolio before change:  [8.3395726]
curr_Stock_Price:  103.44107212794718
curr_Factors:  [1.03441072e+02 3.24711362e-02]
mat_Sqrt:  [[ 1.86398218e+01  0.00000000e+00]
 [-7.20789969e-03  1.65153730e-02]]
grads:  [1.96711179e-03 1.20871918e+01]
Stock Position:  0.001967111794611071
Bond Position:  [8.13609245]


portfolio before change:  [8.33943491]
curr_Stock_Price:  102.85403329895702
curr_Factors:  [1.02854033e+02 3.23632744e-02]
mat_Sqrt:  [[ 1.85032303e+01  0.00000000e+00]
 [-7.19591822e-03  1.64879200e-02]]
grads:  [-0.03626039 -3.86480238]
Stock Position:  -0.03626039024370777
Bond Position:  [12.06896229]


portfolio before change:  [8.37499173]
curr_Stock_Price:  101.91504431945687
curr_Factors:  [1.01915044e+02 3.32322093e-02]
mat_Sqrt:  [[ 1.85788105e+01  0.00000000e+00]
 [-7.29188144e-03  1.67077993e-02]]
grads:  [-0.01043756 -3.59798306]
Stock Position:  -0.010437559241833034
Bond Position:  [9.43873604]


portfolio before change:  [8.38404952]
curr_Stock_Price:  101.16028200753874
curr_Factors:  [1.01160282e+02 3.51217018e-02]
mat_Sqrt:  [[ 1.89582308e+01  0.00000000e+00]
 [-7.49631396e-03  1.71762131e-02]]
grads:  [-8.28209574e-04 -3.78800514e+00]
Stock Position:  -0.0008282095741437528
Bond Position:  [8.46783143]


portfolio before change:  [8.38529959]
curr_Stock_Price:  100.92903442674768
curr_Factors:  [1.00929034e+02 3.58640193e-02]
mat_Sqrt:  [[ 1.91137367e+01  0.00000000e+00]
 [-7.57511920e-03  1.73567786e-02]]
grads:  [-0.01045243  7.89474998]
Stock Position:  -0.010452429590349784
Bond Position:  [9.44025321]


portfolio before change:  [8.39613489]
curr_Stock_Price:  100.0053070767008
curr_Factors:  [1.00005307e+02 3.74141096e-02]
mat_Sqrt:  [[ 1.93437538e+01  0.00000000e+00]
 [-7.73709089e-03  1.77279023e-02]]
grads:  [0.00280954 2.16155686]
Stock Position:  0.0028095432760391827
Bond Position:  [8.11516565]


portfolio before change:  [8.39476272]
curr_Stock_Price:  99.15583692880188
curr_Factors:  [9.91558369e+01 3.76573600e-02]
mat_Sqrt:  [[ 1.92416903e+01  0.00000000e+00]
 [-7.76220175e-03  1.77854385e-02]]
grads:  [-1.11544977e-04  2.82604144e+00]
Stock Position:  -0.00011154497729581201
Bond Position:  [8.40582306]


portfolio before change:  [8.39568766]
curr_Stock_Price:  100.28416439869635
curr_Factors:  [1.00284164e+02 3.63790850e-02]
mat_Sqrt:  [[ 1.91275015e+01  0.00000000e+00]
 [-7.62932081e-03  1.74809700e-02]]
grads:  [-0.00825352  5.31985801]
Stock Position:  -0.008253515917362581
Bond Position:  [9.2233846]


portfolio before change:  [8.396459]
curr_Stock_Price:  100.33040525381095
curr_Factors:  [1.00330405e+02 3.59093748e-02]
mat_Sqrt:  [[ 1.90123801e+01  0.00000000e+00]
 [-7.57990763e-03  1.73677502e-02]]
grads:  [-5.87682628e-03 -1.14303789e+01]
Stock Position:  -0.0058768262815356445
Bond Position:  [8.98608337]


portfolio before change:  [8.39479903]
curr_Stock_Price:  100.8040125324585
curr_Factors:  [1.00804013e+02 3.60382878e-02]
mat_Sqrt:  [[ 1.91363847e+01  0.00000000e+00]
 [-7.59350120e-03  1.73988970e-02]]
grads:  [ 7.63143360e-04 -1.28750777e+00]
Stock Position:  0.00076314335990467
Bond Position:  [8.31787111]


portfolio before change:  [8.39569727]
curr_Stock_Price:  100.61852332580933
curr_Factors:  [1.00618523e+02 3.58840490e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.39569727]
Stock Price:  97.72923547739443
PL:  [8.39569727]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.32576697e+00  3.28630564e-01]
 [ 3.01385289e-01  1.08834063e-01]
 [ 7.53522021e-02 -3.30076800e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.91178523e-02  7.02629846e-02]
 [-2.61380374e-01  8.04655064e-02]
 [ 1.18869016e-01 -3.93398445e-02]
 [ 1.01659325e-01  4.16715979e-01]
 [-7.22675542e-02  9.54368207e-02]
 [ 1.81714785e-01  4.65909631e-02]
 [-9.94185689e-02 -4.94078020e-03]
 [ 2.53369784e-02 -1.33578232e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-6.00905748e-02  6.54915663e-03]
 [ 4.76145722e-01  3.09664852e-01]
 [ 1.30695622e-01  7.42282163e-02]
 [ 4.09485587e-02  1.22270514e-01]
 [ 1.54129792e-01  7.93445480e-02]
 [ 1.30946443e-01  1.38853738e-01]
 [-3.96792273e-01  1.55172062e-01]
 [ 1.10031794e-01  6.41187568e-02]
 [ 1.49045038e+00  1.70417305e-01]
 [ 1.60191504e-02  4.10053783e-01]
 [-1.31820846e-01  1.06792933e-01]
 [-1.90329850e-01  1.50530514e-01]
 [ 2.09057626e-01 -7.50441166e-02]
 [-8.34750434e-02 -4.51791481e-01]
 [ 6.71483739e-02  5.93005201e-02]
 [ 2.96255251e-01 -6.72036780e-02]
 [-5.31774311e-01 -1.75956307e-01]
 [-1.64445385e-01 -5.87701280e-02]
 [-9.76018999e-03 -2.96648869e-02]
 [ 6.66717681e-02  1.86180282e-01]
 [ 2.37867433e-02 -1.05929693e-02]
 [ 1.00418993e-01 -6.11286063e-02]
 [-6.01147871e-02  1.19144233e-01]
 [-3.92948552e-02 -7.47043908e-02]
 [-7.55174171e-02 -5.21038742e-02]
 [ 1.70235491e-02 -1.11101834e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.70125294]
curr_Stock_Price:  100.00286111127046
curr_Factors:  [1.00002861e+02 3.91620061e-02]
mat_Sqrt:  [[ 1.97899588e+01  0.00000000e+00]
 [-7.91575706e-03  1.81372780e-02]]
grads:  [ 0.07423932 18.11906752]
Stock Position:  0.07423932089143624
Bond Position:  [-4.72289156]


portfolio before change:  [2.72665717]
curr_Stock_Price:  100.35300745463337
curr_Factors:  [1.00353007e+02 3.94235296e-02]
mat_Sqrt:  [[ 1.99254503e+01  0.00000000e+00]
 [-7.94214375e-03  1.81977375e-02]]
grads:  [0.01750948 5.98063703]
Stock Position:  0.017509484787148498
Bond Position:  [0.96952771]


portfolio before change:  [2.731313]
curr_Stock_Price:  100.61198914725368
curr_Factors:  [1.00611989e+02 3.88083346e-02]
mat_Sqrt:  [[ 1.98203919e+01  0.00000000e+00]
 [-7.87993244e-03  1.80551934e-02]]
grads:  [ 0.00307494 -1.82815433]
Stock Position:  0.003074937652659762
Bond Position:  [2.42193741]


portfolio before change:  [2.73227151]
curr_Stock_Price:  100.82524519910208
curr_Factors:  [1.00825245e+02 3.92888594e-02]
mat_Sqrt:  [[ 1.99849929e+01  0.00000000e+00]
 [-7.92856702e-03  1.81666293e-02]]
grads:  [-8.15680399e-04 -8.33323619e+00]
Stock Position:  -0.0008156803994563498
Bond Position:  [2.81451269]


portfolio before change:  [2.73303735]
curr_Stock_Price:  100.31769540423328
curr_Factors:  [1.00317695e+02 3.84520031e-02]
mat_Sqrt:  [[ 1.96714798e+01  0.00000000e+00]
 [-7.84367292e-03  1.79721125e-02]]
grads:  [-2.97143745e-03  3.90955625e+00]
Stock Position:  -0.00297143745123186
Bond Position:  [3.0311251]


portfolio before change:  [2.73171517]
curr_Stock_Price:  100.89017452307438
curr_Factors:  [1.00890175e+02 3.82655396e-02]
mat_Sqrt:  [[ 1.97357118e+01  0.00000000e+00]
 [-7.82463184e-03  1.79284838e-02]]
grads:  [-0.01146462  4.48813782]
Stock Position:  -0.011464615532368185
Bond Position:  [3.88838224]


portfolio before change:  [2.73306862]
curr_Stock_Price:  100.81451856897718
curr_Factors:  [1.00814519e+02 3.94090399e-02]
mat_Sqrt:  [[ 2.00134061e+01  0.00000000e+00]
 [-7.94068409e-03  1.81943930e-02]]
grads:  [ 0.00508158 -2.16219604]
Stock Position:  0.0050815787985631754
Bond Position:  [2.2207717]


portfolio before change:  [2.73381774]
curr_Stock_Price:  100.90730531695831
curr_Factors:  [1.00907305e+02 3.97682118e-02]
mat_Sqrt:  [[ 2.01229033e+01  0.00000000e+00]
 [-7.97678750e-03  1.82771163e-02]]
grads:  [1.40898699e-02 2.27998757e+01]
Stock Position:  0.014089869851984512
Bond Position:  [1.31204694]


portfolio before change:  [2.71897735]
curr_Stock_Price:  99.8423981022343
curr_Factors:  [9.98423981e+01 4.00051837e-02]
mat_Sqrt:  [[ 1.99697734e+01  0.00000000e+00]
 [-8.00051835e-03  1.83314905e-02]]
grads:  [-1.53309255e-03  5.20616809e+00]
Stock Position:  -0.0015330925479018242
Bond Position:  [2.87204498]


portfolio before change:  [2.71973895]
curr_Stock_Price:  99.57980647079033
curr_Factors:  [9.95798065e+01 4.08979001e-02]
mat_Sqrt:  [[ 2.01382525e+01  0.00000000e+00]
 [-8.08929170e-03  1.85348958e-02]]
grads:  [0.01003308 2.51368898]
Stock Position:  0.010033082443034077
Bond Position:  [1.72064654]


portfolio before change:  [2.72564627]
curr_Stock_Price:  100.14715176792546
curr_Factors:  [1.00147152e+02 3.91389755e-02]
mat_Sqrt:  [[ 1.98126847e+01  0.00000000e+00]
 [-7.91342915e-03  1.81319440e-02]]
grads:  [-0.00512676 -0.27249037]
Stock Position:  -0.005126761134150649
Bond Position:  [3.23907679]


portfolio before change:  [2.73128105]
curr_Stock_Price:  99.12703979749672
curr_Factors:  [9.91270398e+01 3.95800446e-02]
mat_Sqrt:  [[ 1.97210610e+01  0.00000000e+00]
 [-7.95789365e-03  1.82338250e-02]]
grads:  [-1.67137771e-03 -7.32584811e+00]
Stock Position:  -0.001671377710363572
Bond Position:  [2.89695977]


portfolio before change:  [2.73173837]
curr_Stock_Price:  99.07009175205582
curr_Factors:  [9.90700918e+01 3.87075513e-02]
mat_Sqrt:  [[ 1.94912824e+01  0.00000000e+00]
 [-7.86969390e-03  1.80317340e-02]]
grads:  [-0.00663624 -1.55566875]
Stock Position:  -0.006636243084609325
Bond Position:  [3.38919158]


portfolio before change:  [2.73216979]
curr_Stock_Price:  99.06892525969958
curr_Factors:  [9.90689253e+01 3.89530405e-02]
mat_Sqrt:  [[ 1.95527629e+01  0.00000000e+00]
 [-7.89460986e-03  1.80888236e-02]]
grads:  [-0.00292707  0.36205542]
Stock Position:  -0.0029270691270180033
Bond Position:  [3.02215138]


portfolio before change:  [2.73699953]
curr_Stock_Price:  97.54796633691139
curr_Factors:  [9.75479663e+01 3.97395337e-02]
mat_Sqrt:  [[ 1.94459696e+01  0.00000000e+00]
 [-7.97391082e-03  1.82705250e-02]]
grads:  [ 0.03143554 16.94887545]
Stock Position:  0.031435539368758904
Bond Position:  [-0.3294734]


portfolio before change:  [2.72967005]
curr_Stock_Price:  97.31611739895799
curr_Factors:  [9.73161174e+01 4.09225621e-02]
mat_Sqrt:  [[ 1.96863944e+01  0.00000000e+00]
 [-8.09173031e-03  1.85404833e-02]]
grads:  [0.00828448 4.00357505]
Stock Position:  0.008284476481335684
Bond Position:  [1.92345697]


portfolio before change:  [2.72220022]
curr_Stock_Price:  96.38542716924862
curr_Factors:  [9.63854272e+01 4.04753006e-02]
mat_Sqrt:  [[ 1.93912773e+01  0.00000000e+00]
 [-8.04738969e-03  1.84388862e-02]]
grads:  [4.86361905e-03 6.63112253e+00]
Stock Position:  0.004863619048553361
Bond Position:  [2.25341822]


portfolio before change:  [2.72174624]
curr_Stock_Price:  96.23416770978493
curr_Factors:  [9.62341677e+01 4.22025778e-02]
mat_Sqrt:  [[ 1.97696411e+01  0.00000000e+00]
 [-8.21730640e-03  1.88282143e-02]]
grads:  [0.0095479  4.21413028]
Stock Position:  0.009547901794964123
Bond Position:  [1.80291186]


portfolio before change:  [2.71206683]
curr_Stock_Price:  95.19678914483438
curr_Factors:  [9.51967891e+01 4.18153715e-02]
mat_Sqrt:  [[ 1.94666078e+01  0.00000000e+00]
 [-8.17952287e-03  1.87416413e-02]]
grads:  [0.00983978 7.40883551]
Stock Position:  0.009839782238732352
Bond Position:  [1.77535116]


portfolio before change:  [2.72376196]
curr_Stock_Price:  96.36278953849035
curr_Factors:  [9.63627895e+01 4.15046290e-02]
mat_Sqrt:  [[ 1.96316875e+01  0.00000000e+00]
 [-8.14907396e-03  1.86718741e-02]]
grads:  [-0.01676217  8.31047064]
Stock Position:  -0.016762167453770755
Bond Position:  [4.33901117]


portfolio before change:  [2.73387913]
curr_Stock_Price:  95.79157687487772
curr_Factors:  [9.57915769e+01 4.21346012e-02]
mat_Sqrt:  [[ 1.96628636e+01  0.00000000e+00]
 [-8.21068584e-03  1.88130447e-02]]
grads:  [0.0070191  3.40820733]
Stock Position:  0.0070190952943430624
Bond Position:  [2.06150892]


portfolio before change:  [2.73059337]
curr_Stock_Price:  95.28674477016153
curr_Factors:  [9.52867448e+01 4.21199356e-02]
mat_Sqrt:  [[ 1.95558339e+01  0.00000000e+00]
 [-8.20925679e-03  1.88097703e-02]]
grads:  [0.0800184 9.0600418]
Stock Position:  0.08001840259832582
Bond Position:  [-4.89409974]


portfolio before change:  [2.77159249]
curr_Stock_Price:  95.80676172387491
curr_Factors:  [9.58067617e+01 4.17786898e-02]
mat_Sqrt:  [[ 1.95827450e+01  0.00000000e+00]
 [-8.17593442e-03  1.87334192e-02]]
grads:  [9.95679068e-03 2.18888917e+01]
Stock Position:  0.009956790682652117
Bond Position:  [1.81766462]


portfolio before change:  [2.78203852]
curr_Stock_Price:  96.83307648821177
curr_Factors:  [9.68330765e+01 3.99389872e-02]
mat_Sqrt:  [[ 1.93518395e+01  0.00000000e+00]
 [-7.99389639e-03  1.83163177e-02]]
grads:  [-4.40333275e-03  5.83048048e+00]
Stock Position:  -0.004403332748713392
Bond Position:  [3.20842677]


portfolio before change:  [2.78714364]
curr_Stock_Price:  95.76478372175593
curr_Factors:  [9.57647837e+01 4.04989838e-02]
mat_Sqrt:  [[ 1.92720492e+01  0.00000000e+00]
 [-8.04974373e-03  1.84442800e-02]]
grads:  [-6.46703140e-03  8.16136569e+00]
Stock Position:  -0.006467031403303981
Bond Position:  [3.40645751]


portfolio before change:  [2.79259483]
curr_Stock_Price:  94.98771063123816
curr_Factors:  [9.49877106e+01 4.21205951e-02]
mat_Sqrt:  [[ 1.94946153e+01  0.00000000e+00]
 [-8.20932105e-03  1.88099176e-02]]
grads:  [ 0.00904381 -3.98960369]
Stock Position:  0.00904381468805891
Bond Position:  [1.93354358]


portfolio before change:  [2.8009449]
curr_Stock_Price:  95.88427430401991
curr_Factors:  [9.58842743e+01 4.12470561e-02]
mat_Sqrt:  [[ 1.94734933e+01  0.00000000e+00]
 [-8.12374851e-03  1.86138462e-02]]
grads:  [-1.44120527e-02 -2.42717961e+01]
Stock Position:  -0.014412052694827258
Bond Position:  [4.18283411]


portfolio before change:  [2.79398219]
curr_Stock_Price:  96.40367263713267
curr_Factors:  [9.64036726e+01 3.93154520e-02]
mat_Sqrt:  [[ 1.91150402e+01  0.00000000e+00]
 [-7.93124979e-03  1.81727763e-02]]
grads:  [0.00486681 3.26315139]
Stock Position:  0.004866808630929464
Bond Position:  [2.32480396]


portfolio before change:  [2.79764826]
curr_Stock_Price:  97.09723923833567
curr_Factors:  [9.70972392e+01 3.76062359e-02]
mat_Sqrt:  [[ 1.88294145e+01  0.00000000e+00]
 [-7.75693093e-03  1.77733616e-02]]
grads:  [ 0.01417597 -3.78114616]
Stock Position:  0.01417596716693964
Bond Position:  [1.42120099]


portfolio before change:  [2.79898791]
curr_Stock_Price:  97.17920825056574
curr_Factors:  [9.71792083e+01 3.63665744e-02]
mat_Sqrt:  [[ 1.85320965e+01  0.00000000e+00]
 [-7.62800886e-03  1.74779640e-02]]
grads:  [ -0.03283859 -10.06732289]
Stock Position:  -0.0328385910374658
Bond Position:  [5.99021619]


portfolio before change:  [2.76126594]
curr_Stock_Price:  98.35072014652467
curr_Factors:  [9.83507201e+01 3.55706692e-02]
mat_Sqrt:  [[ 1.85491307e+01  0.00000000e+00]
 [-7.54407521e-03  1.72856478e-02]]
grads:  [-0.01024818 -3.39993783]
Stock Position:  -0.010248176839741628
Bond Position:  [3.76918151]


portfolio before change:  [2.76881701]
curr_Stock_Price:  97.6598763308943
curr_Factors:  [9.76598763e+01 3.73979907e-02]
mat_Sqrt:  [[ 1.88860139e+01  0.00000000e+00]
 [-7.73542404e-03  1.77240831e-02]]
grads:  [-1.20231872e-03 -1.67370502e+00]
Stock Position:  -0.0012023187199472528
Bond Position:  [2.8862353]


portfolio before change:  [2.76936471]
curr_Stock_Price:  97.50442632907645
curr_Factors:  [9.75044263e+01 3.81688639e-02]
mat_Sqrt:  [[ 1.90492968e+01  0.00000000e+00]
 [-7.81474134e-03  1.79058219e-02]]
grads:  [7.76551001e-03 1.03977513e+01]
Stock Position:  0.007765510008314004
Bond Position:  [2.01219311]


portfolio before change:  [2.75803811]
curr_Stock_Price:  96.01345688828663
curr_Factors:  [9.60134569e+01 3.78921429e-02]
mat_Sqrt:  [[ 1.86898876e+01  0.00000000e+00]
 [-7.78636170e-03  1.78407959e-02]]
grads:  [ 0.00102535 -0.59374981]
Stock Position:  0.001025345518641058
Bond Position:  [2.65959114]


portfolio before change:  [2.75945589]
curr_Stock_Price:  97.07194118560291
curr_Factors:  [9.70719412e+01 3.69101506e-02]
mat_Sqrt:  [[ 1.86494755e+01  0.00000000e+00]
 [-7.68480585e-03  1.76081023e-02]]
grads:  [ 0.00395401 -3.47161809]
Stock Position:  0.003954013707831541
Bond Position:  [2.3756321]


portfolio before change:  [2.76159802]
curr_Stock_Price:  97.53859455492073
curr_Factors:  [9.75385946e+01 3.52795418e-02]
mat_Sqrt:  [[ 1.83205270e+01  0.00000000e+00]
 [-7.51313962e-03  1.72147655e-02]]
grads:  [-4.42999318e-04  6.92104883e+00]
Stock Position:  -0.00044299931805528005
Bond Position:  [2.80480755]


portfolio before change:  [2.76183603]
curr_Stock_Price:  97.79279893676275
curr_Factors:  [9.77927989e+01 3.61986936e-02]
mat_Sqrt:  [[ 1.86060132e+01  0.00000000e+00]
 [-7.61038171e-03  1.74375751e-02]]
grads:  [-3.86426278e-03 -4.28410431e+00]
Stock Position:  -0.0038642627793743544
Bond Position:  [3.1397331]


portfolio before change:  [2.7592626]
curr_Stock_Price:  98.56032387402368
curr_Factors:  [9.85603239e+01 3.70953455e-02]
mat_Sqrt:  [[ 1.89828682e+01  0.00000000e+00]
 [-7.70406080e-03  1.76522209e-02]]
grads:  [-0.00517611 -2.95168945]
Stock Position:  -0.005176109904566138
Bond Position:  [3.26942167]


portfolio before change:  [2.75320982]
curr_Stock_Price:  99.80865293688419
curr_Factors:  [9.98086529e+01 3.73815816e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.75320982]
Stock Price:  100.00066843488267
PL:  [2.75254138]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 9.85767252e-01  2.51763441e-01]
 [-2.66793573e-01 -1.00231349e-01]
 [-2.62350399e-01 -1.24941371e-01]
 [-9.31800253e-02 -1.19570474e-01]
 [-1.05057299e-01 -1.63274559e-01]
 [-1.57099999e-01 -3.25468917e-02]
 [ 8.76292371e-02  9.58115919e-02]
 [ 3.69747813e-01  4.87718055e-01]
 [-9.43025504e-02  9.43821761e-03]
 [ 6.16781334e-03 -1.96119541e-01]
 [-6.32087569e-02 -1.39740362e-02]
 [-1.70285727e-01 -2.03479932e-01]
 [-5.62934647e-02 -1.98843710e-02]
 [ 2.22763881e-02 -2.06403371e-01]
 [ 2.46900587e-01  1.39386319e-01]
 [ 1.14101212e-01 -7.23722912e-01]
 [ 2.62290997e-02 -1.66737735e-01]
 [ 3.71342985e-02 -1.59091592e-01]
 [-1.02576254e-01 -1.37447213e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.26870437e-01 -2.39151264e-02]
 [ 3.60968902e-01 -3.60666126e-01]
 [ 2.71558760e-02 -3.35253741e-01]
 [ 3.99841465e-02  3.26337884e-02]
 [ 4.33658805e-01 -3.81989115e-01]
 [-2.81641420e-01  2.40808519e-02]
 [-1.51920884e-01  1.09106088e-01]
 [-3.22445903e-02  1.33344472e-01]
 [-5.13747991e-02  1.99754478e-01]
 [-7.49140845e-01  2.98826823e-02]
 [-1.26904931e-01 -7.23721323e-03]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.03763353e-01 -1.12253844e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.86549136e-01 -6.06924230e-02]
 [-3.12198920e-02 -1.42226972e-01]
 [ 4.79881359e-03 -6.36887763e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.29549755]
curr_Stock_Price:  102.41159810980103
curr_Factors:  [1.02411598e+02 3.90744396e-02]
mat_Sqrt:  [[ 2.02439624e+01  0.00000000e+00]
 [-7.90690226e-03  1.81169890e-02]]
grads:  [ 0.0541221  13.89653876]
Stock Position:  0.054122103342402805
Bond Position:  [13.75276645]


portfolio before change:  [19.27783751]
curr_Stock_Price:  102.05353295045684
curr_Factors:  [1.02053533e+02 3.83000508e-02]
mat_Sqrt:  [[ 1.99722834e+01  0.00000000e+00]
 [-7.82815951e-03  1.79365667e-02]]
grads:  [-0.01554845 -5.58810115]
Stock Position:  -0.015548453543937175
Bond Position:  [20.86461213]


portfolio before change:  [19.2828201]
curr_Stock_Price:  101.90082642353833
curr_Factors:  [1.01900826e+02 3.89061705e-02]
mat_Sqrt:  [[ 2.00995785e+01  0.00000000e+00]
 [-7.88985886e-03  1.80779377e-02]]
grads:  [-0.01576547 -6.91126238]
Stock Position:  -0.015765469110003944
Bond Position:  [20.88933443]


portfolio before change:  [19.26204024]
curr_Stock_Price:  103.38452410726401
curr_Factors:  [1.03384524e+02 3.90200748e-02]
mat_Sqrt:  [[ 2.04220616e+01  0.00000000e+00]
 [-7.90139986e-03  1.81043815e-02]]
grads:  [-0.00711803 -6.60450479]
Stock Position:  -0.007118030557261264
Bond Position:  [19.99793444]


portfolio before change:  [19.27997377]
curr_Stock_Price:  101.21628002105228
curr_Factors:  [1.0121628e+02 3.8953056e-02]
mat_Sqrt:  [[ 1.99765800e+01  0.00000000e+00]
 [-7.89461142e-03  1.80888272e-02]]
grads:  [-8.82614336e-03 -9.02626560e+00]
Stock Position:  -0.008826143356426468
Bond Position:  [20.17332317]


portfolio before change:  [19.29465153]
curr_Stock_Price:  99.83901508875282
curr_Factors:  [9.98390151e+01 3.84150087e-02]
mat_Sqrt:  [[ 1.95681945e+01  0.00000000e+00]
 [-7.83989885e-03  1.79634650e-02]]
grads:  [-0.00875424 -1.81183818]
Stock Position:  -0.008754237755910424
Bond Position:  [20.168666]


portfolio before change:  [19.30239135]
curr_Stock_Price:  99.24289480374638
curr_Factors:  [9.92428948e+01 3.78997499e-02]
mat_Sqrt:  [[ 1.93204659e+01  0.00000000e+00]
 [-7.78714324e-03  1.78425867e-02]]
grads:  [0.00669988 5.36982634]
Stock Position:  0.006699882107977042
Bond Position:  [18.63747565]


portfolio before change:  [19.31086424]
curr_Stock_Price:  100.15978525193323
curr_Factors:  [1.00159785e+02 3.55010308e-02]
mat_Sqrt:  [[ 1.88718235e+01  0.00000000e+00]
 [-7.53668689e-03  1.72687191e-02]]
grads:  [ 0.03087171 28.24286228]
Stock Position:  0.03087170789417325
Bond Position:  [16.2187606]


portfolio before change:  [19.3206551]
curr_Stock_Price:  100.41125780742978
curr_Factors:  [1.00411258e+02 3.53493612e-02]
mat_Sqrt:  [[ 1.88787481e+01  0.00000000e+00]
 [-7.52057032e-03  1.72317914e-02]]
grads:  [-0.00477698  0.54772121]
Stock Position:  -0.0047769785315555065
Bond Position:  [19.80031752]


portfolio before change:  [19.31783779]
curr_Stock_Price:  101.51917539337501
curr_Factors:  [1.01519175e+02 3.47871147e-02]
mat_Sqrt:  [[ 1.89346502e+01  0.00000000e+00]
 [-7.46052167e-03  1.70942026e-02]]
grads:  [-4.19473140e-03 -1.14728686e+01]
Stock Position:  -0.004194731398175389
Bond Position:  [19.74368346]


portfolio before change:  [19.31574779]
curr_Stock_Price:  102.60580500056729
curr_Factors:  [1.02605805e+02 3.43546188e-02]
mat_Sqrt:  [[ 1.90179849e+01  0.00000000e+00]
 [-7.41399961e-03  1.69876072e-02]]
grads:  [-0.00364431 -0.8226018 ]
Stock Position:  -0.0036443149228252204
Bond Position:  [19.68967565]


portfolio before change:  [19.31243277]
curr_Stock_Price:  104.19084452359863
curr_Factors:  [1.04190845e+02 3.51480341e-02]
mat_Sqrt:  [[ 1.95335005e+01  0.00000000e+00]
 [-7.49912359e-03  1.71826508e-02]]
grads:  [ -0.01326396 -11.84217353]
Stock Position:  -0.01326396414263239
Bond Position:  [20.69441639]


portfolio before change:  [19.32431481]
curr_Stock_Price:  103.49006771748125
curr_Factors:  [1.03490068e+02 3.51445936e-02]
mat_Sqrt:  [[ 1.94011706e+01  0.00000000e+00]
 [-7.49875655e-03  1.71818098e-02]]
grads:  [-0.00334886 -1.157292  ]
Stock Position:  -0.0033488554428980424
Bond Position:  [19.67088809]


portfolio before change:  [19.32801898]
curr_Stock_Price:  103.11825316331412
curr_Factors:  [1.03118253e+02 3.60579213e-02]
mat_Sqrt:  [[ 1.95810461e+01  0.00000000e+00]
 [-7.59556937e-03  1.74036358e-02]]
grads:  [-3.46280928e-03 -1.18597845e+01]
Stock Position:  -0.003462809275390348
Bond Position:  [19.68509782]


portfolio before change:  [19.33304111]
curr_Stock_Price:  102.3785823623999
curr_Factors:  [1.02378582e+02 3.70400006e-02]
mat_Sqrt:  [[ 1.97035556e+01  0.00000000e+00]
 [-7.69831156e-03  1.76390477e-02]]
grads:  [0.01561818 7.90214536]
Stock Position:  0.01561818434870262
Bond Position:  [17.73407353]


portfolio before change:  [19.35484105]
curr_Stock_Price:  103.6324440596061
curr_Factors:  [1.03632444e+02 3.62353018e-02]
mat_Sqrt:  [[ 1.97270290e+01  0.00000000e+00]
 [-7.61422897e-03  1.74463903e-02]]
grads:  [-1.02274581e-02 -4.14826734e+01]
Stock Position:  -0.010227458097459563
Bond Position:  [20.41473753]


portfolio before change:  [19.36372691]
curr_Stock_Price:  103.01314466471227
curr_Factors:  [1.03013145e+02 3.63868889e-02]
mat_Sqrt:  [[ 1.96501155e+01  0.00000000e+00]
 [-7.63013907e-03  1.74828449e-02]]
grads:  [-2.36849569e-03 -9.53721981e+00]
Stock Position:  -0.0023684956886658786
Bond Position:  [19.6077131]


portfolio before change:  [19.36261561]
curr_Stock_Price:  104.51722945620641
curr_Factors:  [1.04517229e+02 3.60602842e-02]
mat_Sqrt:  [[ 1.98473469e+01  0.00000000e+00]
 [-7.59581824e-03  1.74042060e-02]]
grads:  [-1.62736939e-03 -9.14098536e+00]
Stock Position:  -0.001627369386296987
Bond Position:  [19.53270375]


portfolio before change:  [19.36214749]
curr_Stock_Price:  106.30530544410888
curr_Factors:  [1.06305305e+02 3.52401621e-02]
mat_Sqrt:  [[ 1.99560181e+01  0.00000000e+00]
 [-7.50894529e-03  1.72051551e-02]]
grads:  [-0.00814607 -7.98872271]
Stock Position:  -0.008146070791562836
Bond Position:  [20.22811803]


portfolio before change:  [19.37592675]
curr_Stock_Price:  104.92419957510646
curr_Factors:  [1.04924200e+02 3.62839369e-02]
mat_Sqrt:  [[ 1.99863214e+01  0.00000000e+00]
 [-7.61933718e-03  1.74580947e-02]]
grads:  [-2.42471184e-04 -6.24887143e+00]
Stock Position:  -0.00024247118391406596
Bond Position:  [19.40136784]


portfolio before change:  [19.37846258]
curr_Stock_Price:  104.46844911827384
curr_Factors:  [1.04468449e+02 3.47321424e-02]
mat_Sqrt:  [[ 1.94693267e+01  0.00000000e+00]
 [-7.45462459e-03  1.70806907e-02]]
grads:  [ 0.00598033 -1.40012642]
Stock Position:  0.005980331086512275
Bond Position:  [18.75370666]


portfolio before change:  [19.38203641]
curr_Stock_Price:  104.67403529609679
curr_Factors:  [1.04674035e+02 3.45497430e-02]
mat_Sqrt:  [[ 1.94563503e+01  0.00000000e+00]
 [-7.43502447e-03  1.70357812e-02]]
grads:  [ 1.04624607e-02 -2.11710940e+01]
Stock Position:  0.010462460657064363
Bond Position:  [18.28688843]


portfolio before change:  [19.39384737]
curr_Stock_Price:  105.5844286810919
curr_Factors:  [1.05584429e+02 3.32481907e-02]
mat_Sqrt:  [[ 1.92523560e+01  0.00000000e+00]
 [-7.29363456e-03  1.67118162e-02]]
grads:  [-6.18941662e-03 -2.00608800e+01]
Stock Position:  -0.006189416622178615
Bond Position:  [20.04735339]


portfolio before change:  [19.40706145]
curr_Stock_Price:  103.85437773273014
curr_Factors:  [1.03854378e+02 3.31028692e-02]
mat_Sqrt:  [[ 1.88954669e+01  0.00000000e+00]
 [-7.27767756e-03  1.66752542e-02]]
grads:  [0.00286983 1.95701895]
Stock Position:  0.0028698258574809702
Bond Position:  [19.10901747]


portfolio before change:  [19.4107148]
curr_Stock_Price:  104.29502259040585
curr_Factors:  [1.04295023e+02 3.41098128e-02]
mat_Sqrt:  [[ 1.92620830e+01  0.00000000e+00]
 [-7.38753684e-03  1.69269734e-02]]
grads:  [ 1.38585784e-02 -2.25668881e+01]
Stock Position:  0.013858578392161543
Bond Position:  [17.96533405]


portfolio before change:  [19.41701246]
curr_Stock_Price:  104.58739397633799
curr_Factors:  [1.04587394e+02 3.38950120e-02]
mat_Sqrt:  [[ 1.92551647e+01  0.00000000e+00]
 [-7.36423922e-03  1.68735918e-02]]
grads:  [-0.01408098  1.42713254]
Stock Position:  -0.014080984434912212
Bond Position:  [20.88970593]


portfolio before change:  [19.42824179]
curr_Stock_Price:  103.97536638366354
curr_Factors:  [1.03975366e+02 3.45493561e-02]
mat_Sqrt:  [[ 1.93263766e+01  0.00000000e+00]
 [-7.43498283e-03  1.70356858e-02]]
grads:  [-5.39692903e-03  6.40456095e+00]
Stock Position:  -0.00539692903455594
Bond Position:  [19.98938946]


portfolio before change:  [19.4332437]
curr_Stock_Price:  103.51156915237803
curr_Factors:  [1.03511569e+02 3.36588944e-02]
mat_Sqrt:  [[ 1.89906056e+01  0.00000000e+00]
 [-7.33854420e-03  1.68147171e-02]]
grads:  [1.36655507e-03 7.93022392e+00]
Stock Position:  0.0013665550715967778
Bond Position:  [19.29178944]


portfolio before change:  [19.43561297]
curr_Stock_Price:  103.4805799140106
curr_Factors:  [1.03480580e+02 3.47796522e-02]
mat_Sqrt:  [[ 1.92984074e+01  0.00000000e+00]
 [-7.45972141e-03  1.70923690e-02]]
grads:  [1.85534492e-03 1.16867637e+01]
Stock Position:  0.0018553449248649957
Bond Position:  [19.2436208]


portfolio before change:  [19.44069701]
curr_Stock_Price:  104.92421222334336
curr_Factors:  [1.04924212e+02 3.40989049e-02]
mat_Sqrt:  [[ 1.93751884e+01  0.00000000e+00]
 [-7.38635552e-03  1.69242666e-02]]
grads:  [-0.03799184  1.76567073]
Stock Position:  -0.03799183573363666
Bond Position:  [23.42696045]


portfolio before change:  [19.42982783]
curr_Stock_Price:  105.28738860493999
curr_Factors:  [1.05287389e+02 3.40592656e-02]
mat_Sqrt:  [[ 1.94309482e+01  0.00000000e+00]
 [-7.38206102e-03  1.69144267e-02]]
grads:  [-0.00669363 -0.42787222]
Stock Position:  -0.0066936265209801135
Bond Position:  [20.13458228]


portfolio before change:  [19.42715169]
curr_Stock_Price:  106.06321943264454
curr_Factors:  [1.06063219e+02 3.39262599e-02]
mat_Sqrt:  [[ 1.95358719e+01  0.00000000e+00]
 [-7.36763299e-03  1.68813679e-02]]
grads:  [ 0.0037133  -0.70771452]
Stock Position:  0.003713302241292011
Bond Position:  [19.0333069]


portfolio before change:  [19.43520071]
curr_Stock_Price:  107.59008573788246
curr_Factors:  [1.07590086e+02 3.16902703e-02]
mat_Sqrt:  [[ 1.91529302e+01  0.00000000e+00]
 [-7.12070450e-03  1.63155837e-02]]
grads:  [-0.01319667 -6.88016107]
Stock Position:  -0.013196672476996124
Bond Position:  [20.85503184]


portfolio before change:  [19.44941411]
curr_Stock_Price:  106.71059450003862
curr_Factors:  [1.06710595e+02 3.19843060e-02]
mat_Sqrt:  [[ 1.90842899e+01  0.00000000e+00]
 [-7.15366267e-03  1.63911003e-02]]
grads:  [0.005317   3.25475775]
Stock Position:  0.005317000118557423
Bond Position:  [18.88203387]


portfolio before change:  [19.44769009]
curr_Stock_Price:  105.94241301854655
curr_Factors:  [1.05942413e+02 3.22502756e-02]
mat_Sqrt:  [[ 1.90255218e+01  0.00000000e+00]
 [-7.18334469e-03  1.64591104e-02]]
grads:  [-0.00497582  4.94104142]
Stock Position:  -0.004975822056809379
Bond Position:  [19.97484069]


portfolio before change:  [19.4463936]
curr_Stock_Price:  106.7047998860156
curr_Factors:  [1.06704800e+02 3.12515371e-02]
mat_Sqrt:  [[ 1.88633858e+01  0.00000000e+00]
 [-7.07124171e-03  1.62022502e-02]]
grads:  [-0.02189625 -3.74592555]
Stock Position:  -0.021896253712096723
Bond Position:  [21.78282897]


portfolio before change:  [19.42184074]
curr_Stock_Price:  107.95048732375498
curr_Factors:  [1.07950487e+02 2.99088241e-02]
mat_Sqrt:  [[ 1.86691385e+01  0.00000000e+00]
 [-6.91766713e-03  1.58503666e-02]]
grads:  [-4.99716855e-03 -8.97310299e+00]
Stock Position:  -0.004997168554775909
Bond Position:  [19.96128752]


portfolio before change:  [19.42347083]
curr_Stock_Price:  108.12362971585523
curr_Factors:  [1.08123630e+02 3.01275628e-02]
mat_Sqrt:  [[ 1.87673355e+01  0.00000000e+00]
 [-6.94291729e-03  1.59082220e-02]]
grads:  [-1.22538691e-03 -4.00351317e+00]
Stock Position:  -0.001225386910236211
Bond Position:  [19.55596412]


portfolio before change:  [19.42519097]
curr_Stock_Price:  108.71488342111583
curr_Factors:  [1.08714883e+02 2.96656649e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.42519097]
Stock Price:  109.7714641472582
PL:  [9.65372682]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.21138200e+00  3.02770415e-01]
 [ 3.50056774e-01  1.13798294e-01]
 [-1.05676953e-01 -8.47260425e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.16835719e-01 -3.46762463e-01]
 [-3.37053149e-01  1.64346704e-01]
 [ 3.24989587e-01 -3.78333225e-01]
 [-5.76338635e-01  2.17106467e-01]
 [-1.18188409e-01 -9.84788197e-02]
 [-5.89666505e-02 -2.89307973e-01]
 [-7.19910828e-02 -1.24458896e-02]
 [-4.37478912e-04 -1.36167068e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-7.27197594e-02  5.12291181e-02]
 [ 4.66428792e-01  2.97613588e-01]
 [ 1.36107337e-01 -4.14888654e-01]
 [ 3.58204199e-02 -8.44937721e-02]
 [ 3.52387636e-02 -1.57024833e-01]
 [-1.24027045e-01 -3.60830739e-01]
 [ 3.76493184e-02 -1.06097789e-01]
 [ 1.58691244e-01 -3.41561168e-02]
 [ 6.52209293e-01 -1.25092060e-01]
 [ 2.94300134e-02 -3.56089384e-01]
 [ 2.83914285e-03  2.97588729e-02]
 [ 4.80451343e-02 -5.86676992e-03]
 [ 1.59664762e-01 -9.29732938e-02]
 [ 9.99278233e-02 -2.20013068e-01]
 [ 5.04404961e-02  1.70806348e-01]
 [ 3.40849873e-02  1.43353008e-01]
 [-5.44757267e-01 -1.21535019e-01]
 [-1.65525779e-01 -6.04936728e-02]
 [ 6.67815001e-03 -6.01055110e-02]
 [-8.40777664e-02  1.62094871e-01]
 [ 1.46672153e-02  2.13782582e-04]
 [ 8.85069444e-02 -3.38210148e-02]
 [-1.68229933e-02  1.19558924e-01]
 [-4.64079123e-02  1.21578599e-02]
 [-3.33591528e-01 -1.22228026e-01]
 [ 1.34566125e-01 -3.35187890e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.11439343]
curr_Stock_Price:  100.4982954001166
curr_Factors:  [1.00498295e+02 3.85346079e-02]
mat_Sqrt:  [[ 1.97280503e+01  0.00000000e+00]
 [-7.85209352e-03  1.79914065e-02]]
grads:  [ 0.06810211 16.82861291]
Stock Position:  0.06810210947859117
Bond Position:  [-0.72975249]


portfolio before change:  [6.09450554]
curr_Stock_Price:  100.20760450692435
curr_Factors:  [1.00207605e+02 3.83256874e-02]
mat_Sqrt:  [[ 1.96175901e+01  0.00000000e+00]
 [-7.83077901e-03  1.79425688e-02]]
grads:  [0.02037571 6.34236355]
Stock Position:  0.02037571477805135
Bond Position:  [4.05270397]


portfolio before change:  [6.11844169]
curr_Stock_Price:  101.35747978813706
curr_Factors:  [1.01357480e+02 3.81262834e-02]
mat_Sqrt:  [[ 1.97910137e+01  0.00000000e+00]
 [-7.81038114e-03  1.78958314e-02]]
grads:  [-0.00720804 -4.73440103]
Stock Position:  -0.007208040575805446
Bond Position:  [6.84903052]


portfolio before change:  [6.11461541]
curr_Stock_Price:  102.00709578111021
curr_Factors:  [1.02007096e+02 3.73979322e-02]
mat_Sqrt:  [[ 1.97266881e+01  0.00000000e+00]
 [-7.73541799e-03  1.77240692e-02]]
grads:  [-8.26361064e-04 -8.54131240e+00]
Stock Position:  -0.0008263610636558885
Bond Position:  [6.19891011]


portfolio before change:  [6.11544993]
curr_Stock_Price:  101.93496875688946
curr_Factors:  [1.01934969e+02 3.80440277e-02]
mat_Sqrt:  [[ 1.98822916e+01  0.00000000e+00]
 [-7.80195131e-03  1.78765162e-02]]
grads:  [-1.34881467e-02 -1.93976533e+01]
Stock Position:  -0.013488146682473107
Bond Position:  [7.49036374]


portfolio before change:  [6.12238699]
curr_Stock_Price:  101.49008159969422
curr_Factors:  [1.01490082e+02 3.79042808e-02]
mat_Sqrt:  [[ 1.97591261e+01  0.00000000e+00]
 [-7.78760870e-03  1.78436532e-02]]
grads:  [-0.01342804  9.21037314]
Stock Position:  -0.013428041626778579
Bond Position:  [7.48520003]


portfolio before change:  [6.09601664]
curr_Stock_Price:  103.5235911839976
curr_Factors:  [1.03523591e+02 3.78347996e-02]
mat_Sqrt:  [[ 2.01365492e+01  0.00000000e+00]
 [-7.78046781e-03  1.78272913e-02]]
grads:  [ 7.93936583e-03 -2.12221373e+01]
Stock Position:  0.007939365826932276
Bond Position:  [5.27410498]


portfolio before change:  [6.09147609]
curr_Stock_Price:  102.86864543980964
curr_Factors:  [1.02868645e+02 3.88723531e-02]
mat_Sqrt:  [[ 2.02816571e+01  0.00000000e+00]
 [-7.88642917e-03  1.80700793e-02]]
grads:  [-0.02374488 12.01469362]
Stock Position:  -0.023744884405377066
Bond Position:  [8.53408019]


portfolio before change:  [6.09913058]
curr_Stock_Price:  102.59121048454945
curr_Factors:  [1.02591210e+02 3.90686324e-02]
mat_Sqrt:  [[ 2.02779598e+01  0.00000000e+00]
 [-7.90631468e-03  1.81156428e-02]]
grads:  [-0.00794794 -5.43612065]
Stock Position:  -0.007947944022636167
Bond Position:  [6.91451978]


portfolio before change:  [6.10582502]
curr_Stock_Price:  101.85767868242306
curr_Factors:  [1.01857679e+02 4.00245183e-02]
mat_Sqrt:  [[ 2.03777782e+01  0.00000000e+00]
 [-8.00245145e-03  1.83359198e-02]]
grads:  [-9.08985266e-03 -1.57782089e+01]
Stock Position:  -0.009089852662709112
Bond Position:  [7.03169631]


portfolio before change:  [6.1119317]
curr_Stock_Price:  101.28256904562964
curr_Factors:  [1.01282569e+02 4.07803607e-02]
mat_Sqrt:  [[ 2.04531517e+01  0.00000000e+00]
 [-8.07765913e-03  1.85082422e-02]]
grads:  [-0.00378538 -0.6724512 ]
Stock Position:  -0.003785378185467826
Bond Position:  [6.49532453]


portfolio before change:  [6.11356116]
curr_Stock_Price:  101.06660696723019
curr_Factors:  [1.01066607e+02 4.02164215e-02]
mat_Sqrt:  [[ 2.02679301e+01  0.00000000e+00]
 [-8.02161296e-03  1.83798243e-02]]
grads:  [-2.95371353e-03 -7.40850759e+00]
Stock Position:  -0.0029537135332350496
Bond Position:  [6.41208297]


portfolio before change:  [6.11894397]
curr_Stock_Price:  99.51559491147141
curr_Factors:  [9.95155949e+01 4.12777518e-02]
mat_Sqrt:  [[ 2.02185107e+01  0.00000000e+00]
 [-8.12677076e-03  1.86207711e-02]]
grads:  [-0.00639755 -1.50645776]
Stock Position:  -0.0063975477895026325
Bond Position:  [6.75559974]


portfolio before change:  [6.12572883]
curr_Stock_Price:  98.5870579457951
curr_Factors:  [9.85870579e+01 4.20413688e-02]
mat_Sqrt:  [[ 2.02142825e+01  0.00000000e+00]
 [-8.20159680e-03  1.87922191e-02]]
grads:  [-2.49138397e-03  2.72608136e+00]
Stock Position:  -0.0024913839672242827
Bond Position:  [6.37134705]


portfolio before change:  [6.12393292]
curr_Stock_Price:  99.6275970833708
curr_Factors:  [9.96275971e+01 4.07560826e-02]
mat_Sqrt:  [[ 2.01129546e+01  0.00000000e+00]
 [-8.07525431e-03  1.85027321e-02]]
grads:  [ 0.02964845 16.08484558]
Stock Position:  0.029648454098859363
Bond Position:  [3.17012868]


portfolio before change:  [6.17477365]
curr_Stock_Price:  101.32901602421082
curr_Factors:  [1.01329016e+02 3.99557695e-02]
mat_Sqrt:  [[ 2.02545955e+01  0.00000000e+00]
 [-7.99557573e-03  1.83201655e-02]]
grads:  [-2.21998589e-03 -2.26465560e+01]
Stock Position:  -0.002219985886903912
Bond Position:  [6.39972263]


portfolio before change:  [6.17508003]
curr_Stock_Price:  101.55137379531966
curr_Factors:  [1.01551374e+02 4.03645928e-02]
mat_Sqrt:  [[ 2.04026270e+01  0.00000000e+00]
 [-8.03637657e-03  1.84136520e-02]]
grads:  [-5.17426252e-05 -4.58864826e+00]
Stock Position:  -5.1742625194514384e-05
Bond Position:  [6.18033457]


portfolio before change:  [6.17573533]
curr_Stock_Price:  103.81825328084368
curr_Factors:  [1.03818253e+02 4.03512716e-02]
mat_Sqrt:  [[ 2.08546224e+01  0.00000000e+00]
 [-8.03505038e-03  1.84106133e-02]]
grads:  [-1.59640829e-03 -8.52903870e+00]
Stock Position:  -0.0015964082864432505
Bond Position:  [6.34147165]


portfolio before change:  [6.17549437]
curr_Stock_Price:  104.46576758151731
curr_Factors:  [1.04465768e+02 4.06455682e-02]
mat_Sqrt:  [[ 2.10610781e+01  0.00000000e+00]
 [-8.06429842e-03  1.84776290e-02]]
grads:  [-1.33661956e-02 -1.95279784e+01]
Stock Position:  -0.013366195629997558
Bond Position:  [7.57180425]


portfolio before change:  [6.20217235]
curr_Stock_Price:  102.54065356706423
curr_Factors:  [1.02540654e+02 4.06793975e-02]
mat_Sqrt:  [[ 2.06815620e+01  0.00000000e+00]
 [-8.06765369e-03  1.84853169e-02]]
grads:  [-4.18515434e-04 -5.73957101e+00]
Stock Position:  -0.000418515433755242
Bond Position:  [6.2450872]


portfolio before change:  [6.20303709]
curr_Stock_Price:  102.33982263204163
curr_Factors:  [1.02339823e+02 4.20428740e-02]
mat_Sqrt:  [[ 2.09841247e+01  0.00000000e+00]
 [-8.20174362e-03  1.87925555e-02]]
grads:  [ 0.00685205 -1.81753444]
Stock Position:  0.006852051022332412
Bond Position:  [5.5017994]


portfolio before change:  [6.19538897]
curr_Stock_Price:  101.12326958693943
curr_Factors:  [1.01123270e+02 4.36426508e-02]
mat_Sqrt:  [[ 2.11254838e+01  0.00000000e+00]
 [-8.35632941e-03  1.91467560e-02]]
grads:  [ 0.0282888  -6.53332917]
Stock Position:  0.028288802655085606
Bond Position:  [3.33473275]


portfolio before change:  [6.19875743]
curr_Stock_Price:  101.22760724970307
curr_Factors:  [1.01227607e+02 4.41788375e-02]
mat_Sqrt:  [[ 2.12767903e+01  0.00000000e+00]
 [-8.40750498e-03  1.92640140e-02]]
grads:  [-5.9210122e-03 -1.8484693e+01]
Stock Position:  -0.0059210122012984
Bond Position:  [6.79812732]


portfolio before change:  [6.20524912]
curr_Stock_Price:  100.27475024786587
curr_Factors:  [1.0027475e+02 4.5593258e-02]
mat_Sqrt:  [[ 2.14112441e+01  0.00000000e+00]
 [-8.54103114e-03  1.95699608e-02]]
grads:  [7.39190104e-04 1.52064039e+00]
Stock Position:  0.000739190104310743
Bond Position:  [6.13112702]


portfolio before change:  [6.20540277]
curr_Stock_Price:  99.44574085735732
curr_Factors:  [9.94457409e+01 4.76314600e-02]
mat_Sqrt:  [[ 2.17036678e+01  0.00000000e+00]
 [-8.72985314e-03  2.00026064e-02]]
grads:  [ 0.00209571 -0.29330027]
Stock Position:  0.0020957133278744974
Bond Position:  [5.996993]


portfolio before change:  [6.20751276]
curr_Stock_Price:  100.09483793626622
curr_Factors:  [1.00094838e+02 4.82326169e-02]
mat_Sqrt:  [[ 2.19827537e+01  0.00000000e+00]
 [-8.78477017e-03  2.01284371e-02]]
grads:  [ 0.00541733 -4.61900212]
Stock Position:  0.005417332708092501
Bond Position:  [5.66526572]


portfolio before change:  [6.20577804]
curr_Stock_Price:  99.64389172765563
curr_Factors:  [9.96438917e+01 4.86457760e-02]
mat_Sqrt:  [[ 2.19772450e+01  0.00000000e+00]
 [-8.82231498e-03  2.02144631e-02]]
grads:  [ 1.77740587e-04 -1.08839432e+01]
Stock Position:  0.0001777405866383005
Bond Position:  [6.18806727]


portfolio before change:  [6.20658355]
curr_Stock_Price:  99.8237096150248
curr_Factors:  [9.98237096e+01 4.85300404e-02]
mat_Sqrt:  [[ 2.19906989e+01  0.00000000e+00]
 [-8.81181392e-03  2.01904022e-02]]
grads:  [5.68360736e-03 8.45977938e+00]
Stock Position:  0.00568360735694335
Bond Position:  [5.63922478]


portfolio before change:  [6.20667282]
curr_Stock_Price:  99.71538427054281
curr_Factors:  [9.97153843e+01 4.86230950e-02]
mat_Sqrt:  [[ 2.19878855e+01  0.00000000e+00]
 [-8.82025805e-03  2.02097501e-02]]
grads:  [4.39557361e-03 7.09325982e+00]
Stock Position:  0.004395573609762573
Bond Position:  [5.76836651]


portfolio before change:  [6.20275946]
curr_Stock_Price:  98.66103963383514
curr_Factors:  [9.86610396e+01 4.61213472e-02]
mat_Sqrt:  [[ 2.11883276e+01  0.00000000e+00]
 [-8.59035247e-03  1.96829702e-02]]
grads:  [-0.02821362 -6.174628  ]
Stock Position:  -0.028213623477982914
Bond Position:  [8.98634489]


portfolio before change:  [6.19603924]
curr_Stock_Price:  98.93904684022444
curr_Factors:  [9.89390468e+01 4.41271160e-02]
mat_Sqrt:  [[ 2.07835866e+01  0.00000000e+00]
 [-8.40258208e-03  1.92527342e-02]]
grads:  [-0.00923457 -3.14208217]
Stock Position:  -0.009234565043948866
Bond Position:  [7.1096983]


portfolio before change:  [6.19640662]
curr_Stock_Price:  98.9955064577115
curr_Factors:  [9.89955065e+01 4.32366323e-02]
mat_Sqrt:  [[ 2.05845516e+01  0.00000000e+00]
 [-8.31736807e-03  1.90574844e-02]]
grads:  [-9.49937893e-04 -3.15390582e+00]
Stock Position:  -0.0009499378932244913
Bond Position:  [6.29044621]


portfolio before change:  [6.19719923]
curr_Stock_Price:  98.988928051816
curr_Factors:  [9.89889281e+01 4.38674661e-02]
mat_Sqrt:  [[ 2.07327970e+01  0.00000000e+00]
 [-8.37782464e-03  1.91960078e-02]]
grads:  [-6.43124272e-04  8.44419696e+00]
Stock Position:  -0.0006431242716114896
Bond Position:  [6.26086141]


portfolio before change:  [6.19932672]
curr_Stock_Price:  96.89783400962682
curr_Factors:  [9.68978340e+01 4.41099029e-02]
mat_Sqrt:  [[ 2.03508297e+01  0.00000000e+00]
 [-8.40094308e-03  1.92489788e-02]]
grads:  [0.0007253  0.01110618]
Stock Position:  0.0007253029896432378
Bond Position:  [6.12904643]


portfolio before change:  [6.20053649]
curr_Stock_Price:  97.50943705074444
curr_Factors:  [9.75094371e+01 4.41236441e-02]
mat_Sqrt:  [[ 2.04824704e+01  0.00000000e+00]
 [-8.40225151e-03  1.92519768e-02]]
grads:  [ 0.00360046 -1.75675543]
Stock Position:  0.0036004564889905184
Bond Position:  [5.84945801]


portfolio before change:  [6.1991954]
curr_Stock_Price:  96.9338648264576
curr_Factors:  [9.69338648e+01 4.46762652e-02]
mat_Sqrt:  [[ 2.04886790e+01  0.00000000e+00]
 [-8.45470427e-03  1.93721612e-02]]
grads:  [1.72567489e-03 6.17168745e+00]
Stock Position:  0.0017256748915452987
Bond Position:  [6.03191906]


portfolio before change:  [6.19922413]
curr_Stock_Price:  96.51356284200914
curr_Factors:  [9.65135628e+01 4.48273275e-02]
mat_Sqrt:  [[ 2.04343003e+01  0.00000000e+00]
 [-8.46898601e-03  1.94048847e-02]]
grads:  [-0.00201141  0.62653605]
Stock Position:  -0.0020114115259424747
Bond Position:  [6.39335262]


portfolio before change:  [6.20353796]
curr_Stock_Price:  94.76622558322099
curr_Factors:  [9.47662256e+01 4.60840935e-02]
mat_Sqrt:  [[ 2.03436609e+01  0.00000000e+00]
 [-8.58688241e-03  1.96750193e-02]]
grads:  [-0.01901999 -6.2123459 ]
Stock Position:  -0.019019989240100354
Bond Position:  [8.00599056]


portfolio before change:  [6.18916828]
curr_Stock_Price:  95.57434903930702
curr_Factors:  [9.55743490e+01 4.60111815e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.18916828]
Stock Price:  95.60545071607648
PL:  [6.18916828]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.37358331e+00  3.39440880e-01]
 [ 1.12008405e+00  6.61927485e-02]
 [-1.05266522e-02  7.26421766e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.94426767e-02  6.05185632e-01]
 [-1.37683131e-02 -1.12904189e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.00814515e-01  7.91163702e-01]
 [-4.12119663e-02  2.13158462e-01]
 [-5.24898115e-02 -2.80139467e-01]
 [-7.77110138e-02 -1.10168880e-02]
 [ 1.36533040e-02 -1.35949707e-01]
 [-9.23311112e-02 -2.32999954e-02]
 [-7.12783562e-03 -1.21379091e-01]
 [ 3.12686206e-01  1.87247963e-01]
 [ 1.34667984e-01 -3.68884988e-01]
 [ 3.81974184e-02  1.89390797e-04]
 [ 3.00512112e-02 -1.51368687e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.42011731e-01 -2.87301973e-02]
 [ 4.19208843e-01 -3.28949525e-01]
 [ 2.94858939e-02 -3.93095554e-01]
 [ 3.66799919e-02  3.69777444e-02]
 [ 4.20694060e-01 -3.41614358e-01]
 [-1.71983929e-01 -6.89418916e-04]
 [-1.49003547e-01  1.17924081e-01]
 [-9.16893636e-02 -9.55786091e-02]
 [-6.89774044e-02  2.07086783e-01]
 [-7.33455069e-01  7.63334364e-02]
 [-1.19329189e-01  5.72953447e-03]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.30884377e-01 -3.26603104e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.73065817e-01 -4.56970546e-02]
 [-2.75695162e-02 -1.76027537e-01]
 [-9.75382817e-03 -6.29358674e-02]
 [ 2.13326060e-01 -1.19291821e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.33525651]
curr_Stock_Price:  99.80457994794992
curr_Factors:  [9.98045799e+01 4.19476951e-02]
mat_Sqrt:  [[ 2.04411122e+01  0.00000000e+00]
 [-8.19245459e-03  1.87712716e-02]]
grads:  [ 0.07444445 18.08299864]
Stock Position:  0.07444445457650062
Bond Position:  [-6.094641]


portfolio before change:  [1.21763452]
curr_Stock_Price:  98.2348173563285
curr_Factors:  [9.82348174e+01 4.14586080e-02]
mat_Sqrt:  [[ 2.00019713e+01  0.00000000e+00]
 [-8.14455480e-03  1.86615194e-02]]
grads:  [0.05744298 3.54701817]
Stock Position:  0.05744298462289547
Bond Position:  [-4.42526659]


portfolio before change:  [1.18814657]
curr_Stock_Price:  97.73110479357835
curr_Factors:  [9.77311048e+01 4.18790568e-02]
mat_Sqrt:  [[ 2.00000580e+01  0.00000000e+00]
 [-8.18574926e-03  1.87559078e-02]]
grads:  [1.05884657e-03 3.87302909e+00]
Stock Position:  0.001058846572661092
Bond Position:  [1.08466432]


portfolio before change:  [1.18842855]
curr_Stock_Price:  97.86935636261853
curr_Factors:  [9.78693564e+01 4.19985221e-02]
mat_Sqrt:  [[ 2.00568966e+01  0.00000000e+00]
 [-8.19741638e-03  1.87826405e-02]]
grads:  [-8.12756194e-04 -8.05993237e+00]
Stock Position:  -0.0008127561936119763
Bond Position:  [1.26797247]


portfolio before change:  [1.18846811]
curr_Stock_Price:  98.0157031912077
curr_Factors:  [9.80157032e+01 4.16140630e-02]
mat_Sqrt:  [[ 1.99947381e+01  0.00000000e+00]
 [-8.15981010e-03  1.86964737e-02]]
grads:  [8.23626626e-03 3.23689719e+01]
Stock Position:  0.008236266260671046
Bond Position:  [0.38118468]


portfolio before change:  [1.19075113]
curr_Stock_Price:  98.28710901433287
curr_Factors:  [9.82871090e+01 4.17409165e-02]
mat_Sqrt:  [[ 2.00806400e+01  0.00000000e+00]
 [-8.17223754e-03  1.87249486e-02]]
grads:  [-3.13952847e-03 -6.02961279e+00]
Stock Position:  -0.003139528466926985
Bond Position:  [1.49932631]


portfolio before change:  [1.19026031]
curr_Stock_Price:  98.50314422465625
curr_Factors:  [9.85031442e+01 4.17687523e-02]
mat_Sqrt:  [[ 2.01314865e+01  0.00000000e+00]
 [-8.17496200e-03  1.87311911e-02]]
grads:  [0.00642644 5.13244922]
Stock Position:  0.006426439355358403
Bond Position:  [0.55723583]


portfolio before change:  [1.18815678]
curr_Stock_Price:  98.16498022485358
curr_Factors:  [9.81649802e+01 3.95612501e-02]
mat_Sqrt:  [[ 1.95250245e+01  0.00000000e+00]
 [-7.95600403e-03  1.82294953e-02]]
grads:  [ 0.05869937 43.40019771]
Stock Position:  0.05869937144263838
Bond Position:  [-4.57406586]


portfolio before change:  [1.24256857]
curr_Stock_Price:  99.101678181995
curr_Factors:  [9.91016782e+01 4.06970535e-02]
mat_Sqrt:  [[ 1.99922877e+01  0.00000000e+00]
 [-8.06940429e-03  1.84893280e-02]]
grads:  [2.59190015e-03 1.15287295e+01]
Stock Position:  0.0025919001457687823
Bond Position:  [0.98570691]


portfolio before change:  [1.24974506]
curr_Stock_Price:  101.82295079149672
curr_Factors:  [1.01822951e+02 4.01493704e-02]
mat_Sqrt:  [[ 2.04025781e+01  0.00000000e+00]
 [-8.01492312e-03  1.83644960e-02]]
grads:  [-8.56522631e-03 -1.52544055e+01]
Stock Position:  -0.00856522631092799
Bond Position:  [2.12188167]


portfolio before change:  [1.25654257]
curr_Stock_Price:  101.06030198232094
curr_Factors:  [1.01060302e+02 4.11494228e-02]
mat_Sqrt:  [[ 2.05004062e+01  0.00000000e+00]
 [-8.11412821e-03  1.85918034e-02]]
grads:  [-0.00402525 -0.59256694]
Stock Position:  -0.004025245996603914
Bond Position:  [1.66333514]


portfolio before change:  [1.25925755]
curr_Stock_Price:  100.4374701211949
curr_Factors:  [1.00437470e+02 4.14794307e-02]
mat_Sqrt:  [[ 2.04555970e+01  0.00000000e+00]
 [-8.14659985e-03  1.86662052e-02]]
grads:  [-2.23313025e-03 -7.28320006e+00]
Stock Position:  -0.0022331302548790127
Bond Position:  [1.4835475]


portfolio before change:  [1.25891163]
curr_Stock_Price:  100.67542167893438
curr_Factors:  [1.00675422e+02 4.06449160e-02]
mat_Sqrt:  [[ 2.02967533e+01  0.00000000e+00]
 [-8.06423373e-03  1.84774807e-02]]
grads:  [-0.00505007 -1.26099416]
Stock Position:  -0.00505007187334407
Bond Position:  [1.76732974]


portfolio before change:  [1.25028622]
curr_Stock_Price:  102.42714607839926
curr_Factors:  [1.02427146e+02 4.15420285e-02]
mat_Sqrt:  [[ 2.08765592e+01  0.00000000e+00]
 [-8.15274467e-03  1.86802848e-02]]
grads:  [-2.87892335e-03 -6.49771093e+00]
Stock Position:  -0.0028789233470538434
Bond Position:  [1.54516612]


portfolio before change:  [1.25263683]
curr_Stock_Price:  101.6777528725784
curr_Factors:  [1.01677753e+02 4.17754950e-02]
mat_Sqrt:  [[ 2.07819713e+01  0.00000000e+00]
 [-8.17562181e-03  1.87327029e-02]]
grads:  [0.01897837 9.99577924]
Stock Position:  0.018978368800140744
Bond Position:  [-0.67704107]


portfolio before change:  [1.23980571]
curr_Stock_Price:  101.00612109536296
curr_Factors:  [1.01006121e+02 4.14077201e-02]
mat_Sqrt:  [[ 2.05536214e+01  0.00000000e+00]
 [-8.13955479e-03  1.86500630e-02]]
grads:  [-1.28087520e-03 -1.97792891e+01]
Stock Position:  -0.0012808751969251302
Bond Position:  [1.36918195]


portfolio before change:  [1.2402666]
curr_Stock_Price:  100.77992393434499
curr_Factors:  [1.00779924e+02 4.42371153e-02]
mat_Sqrt:  [[ 2.11966596e+01  0.00000000e+00]
 [-8.41304846e-03  1.92767157e-02]]
grads:  [0.00180595 0.00982485]
Stock Position:  0.0018059484875499448
Bond Position:  [1.05826325]


portfolio before change:  [1.24242693]
curr_Stock_Price:  101.90290043681286
curr_Factors:  [1.01902900e+02 4.37168374e-02]
mat_Sqrt:  [[ 2.13064411e+01  0.00000000e+00]
 [-8.36342871e-03  1.91630226e-02]]
grads:  [-1.69016965e-03 -7.89899854e+00]
Stock Position:  -0.0016901696458573386
Bond Position:  [1.41466012]


portfolio before change:  [1.24028716]
curr_Stock_Price:  103.2735386971434
curr_Factors:  [1.03273539e+02 4.43208328e-02]
mat_Sqrt:  [[ 2.17416757e+01  0.00000000e+00]
 [-8.42100543e-03  1.92949474e-02]]
grads:  [-1.46618480e-02 -2.43217892e+01]
Stock Position:  -0.01466184797474231
Bond Position:  [2.75446809]


portfolio before change:  [1.24879795]
curr_Stock_Price:  102.7165518586053
curr_Factors:  [1.02716552e+02 4.45292371e-02]
mat_Sqrt:  [[ 2.16751973e+01  0.00000000e+00]
 [-8.44078074e-03  1.93402583e-02]]
grads:  [-2.23578450e-04 -5.64074106e+00]
Stock Position:  -0.00022357844954203003
Bond Position:  [1.27176316]


portfolio before change:  [1.2487913]
curr_Stock_Price:  103.4573633910872
curr_Factors:  [1.03457363e+02 4.30970601e-02]
mat_Sqrt:  [[ 2.14775742e+01  0.00000000e+00]
 [-8.30393257e-03  1.90266998e-02]]
grads:  [ 0.00602828 -1.50999372]
Stock Position:  0.0060282806266257795
Bond Position:  [0.62512128]


portfolio before change:  [1.24868682]
curr_Stock_Price:  103.42706898727286
curr_Factors:  [1.03427069e+02 4.25085182e-02]
mat_Sqrt:  [[ 2.13241732e+01  0.00000000e+00]
 [-8.24703760e-03  1.88963370e-02]]
grads:  [ 1.29263394e-02 -1.74081106e+01]
Stock Position:  0.012926339398972251
Bond Position:  [-0.08824657]


portfolio before change:  [1.24274078]
curr_Stock_Price:  102.96792767478829
curr_Factors:  [1.02967928e+02 4.38430867e-02]
mat_Sqrt:  [[ 2.15601875e+01  0.00000000e+00]
 [-8.37549633e-03  1.91906730e-02]]
grads:  [-6.58969553e-03 -2.04836774e+01]
Stock Position:  -0.0065896955261180645
Bond Position:  [1.92126807]


portfolio before change:  [1.23492015]
curr_Stock_Price:  104.1911713321503
curr_Factors:  [1.04191171e+02 4.30253166e-02]
mat_Sqrt:  [[ 2.16119004e+01  0.00000000e+00]
 [-8.29701794e-03  1.90108564e-02]]
grads:  [0.00244395 1.94508567]
Stock Position:  0.0024439499316151504
Bond Position:  [0.98028214]


portfolio before change:  [1.23312334]
curr_Stock_Price:  103.4058257200737
curr_Factors:  [1.03405826e+02 4.39818118e-02]
mat_Sqrt:  [[ 2.16861054e+01  0.00000000e+00]
 [-8.38873643e-03  1.92210098e-02]]
grads:  [ 1.25242097e-02 -1.77729662e+01]
Stock Position:  0.01252420966463573
Bond Position:  [-0.0619529]


portfolio before change:  [1.23645238]
curr_Stock_Price:  103.67225242401398
curr_Factors:  [1.03672252e+02 4.29859801e-02]
mat_Sqrt:  [[ 2.14944309e+01  0.00000000e+00]
 [-8.29322423e-03  1.90021639e-02]]
grads:  [-0.00801532 -0.03628107]
Stock Position:  -0.008015323449207001
Bond Position:  [2.06741902]


portfolio before change:  [1.23178645]
curr_Stock_Price:  104.28662316709315
curr_Factors:  [1.04286623e+02 4.25723518e-02]
mat_Sqrt:  [[ 2.15175305e+01  0.00000000e+00]
 [-8.25322743e-03  1.89105197e-02]]
grads:  [-4.53292070e-03  6.23589847e+00]
Stock Position:  -0.004532920698289227
Bond Position:  [1.70450944]


portfolio before change:  [1.22540873]
curr_Stock_Price:  105.74060629651099
curr_Factors:  [1.05740606e+02 4.41658966e-02]
mat_Sqrt:  [[ 2.22221115e+01  0.00000000e+00]
 [-8.40627352e-03  1.92611924e-02]]
grads:  [-0.00600318 -4.9622374 ]
Stock Position:  -0.0060031778985442374
Bond Position:  [1.8601884]


portfolio before change:  [1.23225169]
curr_Stock_Price:  104.63945273547105
curr_Factors:  [1.04639453e+02 4.41978359e-02]
mat_Sqrt:  [[ 2.19986466e+01  0.00000000e+00]
 [-8.40931255e-03  1.92681556e-02]]
grads:  [9.72908830e-04 1.07476184e+01]
Stock Position:  0.0009729088301231619
Bond Position:  [1.13044704]


portfolio before change:  [1.23288376]
curr_Stock_Price:  105.143870579501
curr_Factors:  [1.05143871e+02 4.24530060e-02]
mat_Sqrt:  [[ 2.16639769e+01  0.00000000e+00]
 [-8.24165090e-03  1.88839946e-02]]
grads:  [-0.03231819  4.04222932]
Stock Position:  -0.03231818558061233
Bond Position:  [4.63094288]


portfolio before change:  [1.20913605]
curr_Stock_Price:  105.89659269775237
curr_Factors:  [1.05896593e+02 4.31980882e-02]
mat_Sqrt:  [[ 2.20097064e+01  0.00000000e+00]
 [-8.31365991e-03  1.90489879e-02]]
grads:  [-0.00530805  0.30077894]
Stock Position:  -0.00530804967072196
Bond Position:  [1.77124042]


portfolio before change:  [1.21011575]
curr_Stock_Price:  105.75373814613674
curr_Factors:  [1.05753738e+02 4.30822837e-02]
mat_Sqrt:  [[ 2.19505338e+01  0.00000000e+00]
 [-8.30250890e-03  1.90234377e-02]]
grads:  [ 0.00330482 -0.62802472]
Stock Position:  0.0033048215334193854
Bond Position:  [0.86061852]


portfolio before change:  [1.21011463]
curr_Stock_Price:  105.72084555936785
curr_Factors:  [1.05720846e+02 4.34739795e-02]
mat_Sqrt:  [[ 2.20432348e+01  0.00000000e+00]
 [-8.34016590e-03  1.91097208e-02]]
grads:  [-0.0111208  -1.70909407]
Stock Position:  -0.011120804551844582
Bond Position:  [2.38581549]


portfolio before change:  [1.21941082]
curr_Stock_Price:  104.9117364929451
curr_Factors:  [1.04911736e+02 4.37055405e-02]
mat_Sqrt:  [[ 2.19327114e+01  0.00000000e+00]
 [-8.36234804e-03  1.91605465e-02]]
grads:  [0.00462648 2.78431834]
Stock Position:  0.004626476409010371
Bond Position:  [0.73403914]


portfolio before change:  [1.22017038]
curr_Stock_Price:  105.05608009247845
curr_Factors:  [1.05056080e+02 4.33806878e-02]
mat_Sqrt:  [[ 2.18811130e+01  0.00000000e+00]
 [-8.33121243e-03  1.90892058e-02]]
grads:  [-0.00432645  4.26026871]
Stock Position:  -0.00432645317170346
Bond Position:  [1.67469059]


portfolio before change:  [1.21524019]
curr_Stock_Price:  106.2440146621747
curr_Factors:  [1.06244015e+02 4.42391128e-02]
mat_Sqrt:  [[ 2.23464056e+01  0.00000000e+00]
 [-8.41323841e-03  1.92771509e-02]]
grads:  [-0.01758715 -2.37052948]
Stock Position:  -0.017587152627691314
Bond Position:  [3.08376989]


portfolio before change:  [1.24857207]
curr_Stock_Price:  104.37069311062409
curr_Factors:  [1.04370693e+02 4.37788155e-02]
mat_Sqrt:  [[ 2.18378848e+01  0.00000000e+00]
 [-8.36935510e-03  1.91766016e-02]]
grads:  [-4.78041864e-03 -9.17928734e+00]
Stock Position:  -0.004780418637696013
Bond Position:  [1.74750768]


portfolio before change:  [1.2473152]
curr_Stock_Price:  104.67931116095222
curr_Factors:  [1.04679311e+02 4.30091096e-02]
mat_Sqrt:  [[ 2.17090632e+01  0.00000000e+00]
 [-8.29545510e-03  1.90072755e-02]]
grads:  [-1.71455084e-03 -3.31114617e+00]
Stock Position:  -0.0017145508449646512
Bond Position:  [1.4267932]


portfolio before change:  [1.24365556]
curr_Stock_Price:  106.91779852478541
curr_Factors:  [1.06917799e+02 4.30216478e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.24365556]
Stock Price:  107.70435069331748
PL:  [-6.46069513]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.40401535e+00  3.46320954e-01]
 [ 4.41790097e-01  1.22995356e-01]
 [ 8.29860010e-02 -2.11283054e-03]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.71621503e-02  4.07721674e-01]
 [-4.74830296e-02 -1.13709518e-01]
 [ 1.14306840e-01 -2.55843467e-02]
 [-1.80381396e-01  3.40513067e-01]
 [-1.18218605e-01 -9.86152439e-02]
 [-1.30922060e-01 -3.90940105e-01]
 [-7.61107259e-02 -1.14166855e-02]
 [ 3.67347260e-03 -1.36111071e-01]
 [-1.03949221e-01 -2.51485973e-02]
 [-8.13081855e-02  8.13317135e-02]
 [ 4.11617562e-01  2.59760078e-01]
 [ 1.33850854e-01 -3.50182031e-01]
 [ 3.66398016e-02 -6.71975257e-02]
 [ 2.81896574e-02 -1.49338979e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-3.44400744e-02 -6.38937516e-02]
 [ 1.75713759e-01 -4.28604803e-02]
 [ 7.68449518e-01 -5.25558767e-02]
 [ 2.67058006e-02 -2.21827900e-01]
 [-1.00723593e-02  3.58839593e-02]
 [ 1.76153276e-01 -9.37769149e-02]
 [ 1.35602598e-01 -1.01421514e-01]
 [ 4.22584800e-02 -1.15184691e-01]
 [ 5.05606700e-02  1.72238235e-01]
 [ 2.12442841e-02  1.57889822e-01]
 [-5.29951333e-01 -1.01594760e-01]
 [-1.68306104e-01 -6.35305361e-02]
 [ 1.01093222e-02 -6.91080179e-02]
 [-2.24577462e-01  1.39647087e-01]
 [ 6.55118841e-02  6.42860550e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.84966316e-01  3.84423332e-02]
 [-2.37447970e-02 -2.11442431e-01]
 [ 8.25323566e-03 -4.05589402e-02]
 [-4.63482238e-02 -7.70314117e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.39148167]
curr_Stock_Price:  99.66758634289398
curr_Factors:  [9.96675863e+01 4.06324326e-02]
mat_Sqrt:  [[ 2.00904818e+01  0.00000000e+00]
 [-8.06299523e-03  1.84746430e-02]]
grads:  [ 0.07740791 18.74574542]
Stock Position:  0.07740790961572028
Bond Position:  [-7.32357785]


portfolio before change:  [0.40989006]
curr_Stock_Price:  99.91722365444662
curr_Factors:  [9.99172237e+01 4.04778535e-02]
mat_Sqrt:  [[ 2.01024548e+01  0.00000000e+00]
 [-8.04764348e-03  1.84394677e-02]]
grads:  [0.02464722 6.67022272]
Stock Position:  0.024647222209075337
Bond Position:  [-2.05279195]


portfolio before change:  [0.37356821]
curr_Stock_Price:  98.45396581903513
curr_Factors:  [9.84539658e+01 4.22208103e-02]
mat_Sqrt:  [[ 2.02300286e+01  0.00000000e+00]
 [-8.21908125e-03  1.88322810e-02]]
grads:  [ 0.00405654 -0.11219196]
Stock Position:  0.00405653831849429
Bond Position:  [-0.02581408]


portfolio before change:  [0.36826645]
curr_Stock_Price:  97.14779594341054
curr_Factors:  [9.71477959e+01 4.32491416e-02]
mat_Sqrt:  [[ 2.02032714e+01  0.00000000e+00]
 [-8.31857118e-03  1.90602411e-02]]
grads:  [-8.06867692e-04 -7.94254448e+00]
Stock Position:  -0.0008068676916543387
Bond Position:  [0.44665187]


portfolio before change:  [0.36729182]
curr_Stock_Price:  98.42491834110422
curr_Factors:  [9.84249183e+01 4.26728151e-02]
mat_Sqrt:  [[ 2.03320285e+01  0.00000000e+00]
 [-8.26295977e-03  1.89328193e-02]]
grads:  [4.46498374e-03 2.15351801e+01]
Stock Position:  0.004464983736139046
Bond Position:  [-0.07217384]


portfolio before change:  [0.36784917]
curr_Stock_Price:  98.5517666615795
curr_Factors:  [9.85517667e+01 4.12526545e-02]
mat_Sqrt:  [[ 2.00166024e+01  0.00000000e+00]
 [-8.12429979e-03  1.86151094e-02]]
grads:  [-4.85146928e-03 -6.10845285e+00]
Stock Position:  -0.00485146928029321
Bond Position:  [0.84597004]


portfolio before change:  [0.35735279]
curr_Stock_Price:  100.73711203452363
curr_Factors:  [1.00737112e+02 3.91055603e-02]
mat_Sqrt:  [[ 1.99208907e+01  0.00000000e+00]
 [-7.91005035e-03  1.81242022e-02]]
grads:  [ 0.00517753 -1.41161229]
Stock Position:  0.005177525284210048
Bond Position:  [-0.16421615]


portfolio before change:  [0.36229421]
curr_Stock_Price:  101.69547589916327
curr_Factors:  [1.01695476e+02 3.86859291e-02]
mat_Sqrt:  [[ 2.00022177e+01  0.00000000e+00]
 [-7.86749558e-03  1.80266970e-02]]
grads:  [-1.58828940e-03  1.88893765e+01]
Stock Position:  -0.0015882894043663161
Bond Position:  [0.52381606]


portfolio before change:  [0.36072747]
curr_Stock_Price:  102.72313866557566
curr_Factors:  [1.02723139e+02 3.80570958e-02]
mat_Sqrt:  [[ 2.00394641e+01  0.00000000e+00]
 [-7.80329118e-03  1.78795863e-02]]
grads:  [-0.00804701 -5.51552158]
Stock Position:  -0.008047012892959941
Bond Position:  [1.18734189]


portfolio before change:  [0.36471572]
curr_Stock_Price:  102.24596505029061
curr_Factors:  [1.02245965e+02 3.71429591e-02]
mat_Sqrt:  [[ 1.97053625e+01  0.00000000e+00]
 [-7.70900347e-03  1.76635460e-02]]
grads:  [-1.53025507e-02 -2.21325947e+01]
Stock Position:  -0.015302550735538992
Bond Position:  [1.92933979]


portfolio before change:  [0.38217866]
curr_Stock_Price:  101.1205474023037
curr_Factors:  [1.01120547e+02 3.77083820e-02]
mat_Sqrt:  [[ 1.96362413e+01  0.00000000e+00]
 [-7.76745847e-03  1.77974832e-02]]
grads:  [-0.00412978 -0.64147752]
Stock Position:  -0.0041297809807479555
Bond Position:  [0.79978438]


portfolio before change:  [0.38322461]
curr_Stock_Price:  100.89148610709924
curr_Factors:  [1.00891486e+02 3.74707699e-02]
mat_Sqrt:  [[ 1.95299363e+01  0.00000000e+00]
 [-7.74294723e-03  1.77413209e-02]]
grads:  [-2.85358170e-03 -7.67198066e+00]
Stock Position:  -0.0028535816959415787
Bond Position:  [0.67112671]


portfolio before change:  [0.38473526]
curr_Stock_Price:  100.39149979072509
curr_Factors:  [1.00391500e+02 3.71398895e-02]
mat_Sqrt:  [[ 1.93471610e+01  0.00000000e+00]
 [-7.70868492e-03  1.76628161e-02]]
grads:  [-0.00594015 -1.42381584]
Stock Position:  -0.0059401464112888835
Bond Position:  [0.98107547]


portfolio before change:  [0.3974954]
curr_Stock_Price:  98.26402786320405
curr_Factors:  [9.82640279e+01 3.73558691e-02]
mat_Sqrt:  [[ 1.89921436e+01  0.00000000e+00]
 [-7.73106659e-03  1.77140989e-02]]
grads:  [-2.41216140e-03  4.59135482e+00]
Stock Position:  -0.002412161404678807
Bond Position:  [0.63452409]


portfolio before change:  [0.39204473]
curr_Stock_Price:  100.55657462922893
curr_Factors:  [1.00556575e+02 3.48279129e-02]
mat_Sqrt:  [[ 1.87661073e+01  0.00000000e+00]
 [-7.46489522e-03  1.71042237e-02]]
grads:  [ 0.02797523 15.18689665]
Stock Position:  0.02797522923493723
Bond Position:  [-2.4210485]


portfolio before change:  [0.39979992]
curr_Stock_Price:  100.84460957573495
curr_Factors:  [1.00844610e+02 3.36759437e-02]
mat_Sqrt:  [[ 1.85060008e+01  0.00000000e+00]
 [-7.34040257e-03  1.68189752e-02]]
grads:  [-1.02567349e-03 -2.08206521e+01]
Stock Position:  -0.0010256734932504162
Bond Position:  [0.50323356]


portfolio before change:  [0.39931776]
curr_Stock_Price:  101.3760347277931
curr_Factors:  [1.01376035e+02 3.35590985e-02]
mat_Sqrt:  [[ 1.85712203e+01  0.00000000e+00]
 [-7.32765703e-03  1.67897715e-02]]
grads:  [ 3.93748871e-04 -4.00228947e+00]
Stock Position:  0.00039374887099045426
Bond Position:  [0.35940106]


portfolio before change:  [0.39929814]
curr_Stock_Price:  101.21210553532978
curr_Factors:  [1.01212106e+02 3.30538414e-02]
mat_Sqrt:  [[ 1.84010849e+01  0.00000000e+00]
 [-7.27228618e-03  1.66629009e-02]]
grads:  [-2.01005628e-03 -8.96236371e+00]
Stock Position:  -0.0020100562804280632
Bond Position:  [0.60274017]


portfolio before change:  [0.39738524]
curr_Stock_Price:  102.20125416763483
curr_Factors:  [1.02201254e+02 3.33109275e-02]
mat_Sqrt:  [[ 1.86530385e+01  0.00000000e+00]
 [-7.30051258e-03  1.67275758e-02]]
grads:  [-1.70896095e-02 -2.80547314e+01]
Stock Position:  -0.017089609487375285
Bond Position:  [2.14396477]


portfolio before change:  [0.42027243]
curr_Stock_Price:  100.87769143714424
curr_Factors:  [1.00877691e+02 3.41533729e-02]
mat_Sqrt:  [[ 1.86428341e+01  0.00000000e+00]
 [-7.39225247e-03  1.69377783e-02]]
grads:  [-3.34313943e-03 -3.77226285e+00]
Stock Position:  -0.003343139433052792
Bond Position:  [0.75752061]


portfolio before change:  [0.42136233]
curr_Stock_Price:  100.5800041152201
curr_Factors:  [1.00580004e+02 3.41677209e-02]
mat_Sqrt:  [[ 1.85917236e+01  0.00000000e+00]
 [-7.39380507e-03  1.69413357e-02]]
grads:  [ 0.00844504 -2.52993513]
Stock Position:  0.008445043359449178
Bond Position:  [-0.42804016]


portfolio before change:  [0.41920763]
curr_Stock_Price:  100.33119646310205
curr_Factors:  [1.00331196e+02 3.26109507e-02]
mat_Sqrt:  [[ 1.81183115e+01  0.00000000e+00]
 [-7.22340094e-03  1.65508908e-02]]
grads:  [ 0.04114689 -3.17541076]
Stock Position:  0.0411468946134001
Bond Position:  [-3.70910953]


portfolio before change:  [0.41761161]
curr_Stock_Price:  100.30367671421652
curr_Factors:  [1.00303677e+02 3.26265295e-02]
mat_Sqrt:  [[ 1.81176678e+01  0.00000000e+00]
 [-7.22512610e-03  1.65548436e-02]]
grads:  [-3.86958371e-03 -1.33995769e+01]
Stock Position:  -0.00386958370863097
Bond Position:  [0.80574509]


portfolio before change:  [0.41892798]
curr_Stock_Price:  99.98952317818552
curr_Factors:  [9.99895232e+01 3.34939270e-02]
mat_Sqrt:  [[ 1.82994287e+01  0.00000000e+00]
 [-7.32053845e-03  1.67734608e-02]]
grads:  [3.05402127e-04 2.13932949e+00]
Stock Position:  0.0003054021268059465
Bond Position:  [0.38839097]


portfolio before change:  [0.41911854]
curr_Stock_Price:  100.45450650284279
curr_Factors:  [1.00454507e+02 3.29029579e-02]
mat_Sqrt:  [[ 1.82216162e+01  0.00000000e+00]
 [-7.25566900e-03  1.66248262e-02]]
grads:  [ 0.00742117 -5.64077565]
Stock Position:  0.007421167991905778
Bond Position:  [-0.32637123]


portfolio before change:  [0.4093762]
curr_Stock_Price:  99.14722700064509
curr_Factors:  [9.91472270e+01 3.49952807e-02]
mat_Sqrt:  [[ 1.85474971e+01  0.00000000e+00]
 [-7.48281024e-03  1.71452722e-02]]
grads:  [ 4.92457929e-03 -5.91542166e+00]
Stock Position:  0.004924579292983219
Bond Position:  [-0.07888218]


portfolio before change:  [0.41684382]
curr_Stock_Price:  100.66562769816814
curr_Factors:  [1.00665628e+02 3.45817834e-02]
mat_Sqrt:  [[ 1.87199592e+01  0.00000000e+00]
 [-7.43847117e-03  1.70436786e-02]]
grads:  [-4.28005232e-04 -6.75820600e+00]
Stock Position:  -0.00042800523160566045
Bond Position:  [0.45992924]


portfolio before change:  [0.41722826]
curr_Stock_Price:  99.90175539432366
curr_Factors:  [9.99017554e+01 3.37720848e-02]
mat_Sqrt:  [[ 1.83591282e+01  0.00000000e+00]
 [-7.35087313e-03  1.68429663e-02]]
grads:  [6.84845147e-03 1.02261224e+01]
Stock Position:  0.006848451466599742
Bond Position:  [-0.26694406]


portfolio before change:  [0.41711311]
curr_Stock_Price:  99.88981368193515
curr_Factors:  [9.98898137e+01 3.40373177e-02]
mat_Sqrt:  [[ 1.84288768e+01  0.00000000e+00]
 [-7.37968213e-03  1.69089760e-02]]
grads:  [4.89194498e-03 9.33763356e+00]
Stock Position:  0.004891944983532797
Bond Position:  [-0.07154237]


portfolio before change:  [0.42085799]
curr_Stock_Price:  100.6571610009145
curr_Factors:  [1.00657161e+02 3.38001054e-02]
mat_Sqrt:  [[ 1.85056228e+01  0.00000000e+00]
 [-7.35392199e-03  1.68499521e-02]]
grads:  [-0.03103332 -6.02937973]
Stock Position:  -0.03103332046699932
Bond Position:  [3.54458392]


portfolio before change:  [0.42014864]
curr_Stock_Price:  100.69429675357313
curr_Factors:  [1.00694297e+02 3.42576936e-02]
mat_Sqrt:  [[ 1.86373402e+01  0.00000000e+00]
 [-7.40353360e-03  1.69636266e-02]]
grads:  [-0.0105183  -3.74510343]
Stock Position:  -0.010518298248814551
Bond Position:  [1.47928129]


portfolio before change:  [0.42081673]
curr_Stock_Price:  100.64836102570763
curr_Factors:  [1.00648361e+02 3.48287939e-02]
mat_Sqrt:  [[ 1.87834743e+01  0.00000000e+00]
 [-7.46498963e-03  1.71044400e-02]]
grads:  [-1.06752825e-03 -4.04035547e+00]
Stock Position:  -0.0010675282517730316
Bond Position:  [0.5282617]


portfolio before change:  [0.42113295]
curr_Stock_Price:  100.41399718747437
curr_Factors:  [1.00413997e+02 3.49683094e-02]
mat_Sqrt:  [[ 1.87772320e+01  0.00000000e+00]
 [-7.47992613e-03  1.71386639e-02]]
grads:  [-0.0087143   8.14807315]
Stock Position:  -0.00871430229397432
Bond Position:  [1.29617088]


portfolio before change:  [0.4103916]
curr_Stock_Price:  101.66520267762834
curr_Factors:  [1.01665203e+02 3.41061769e-02]
mat_Sqrt:  [[ 1.87753850e+01  0.00000000e+00]
 [-7.38714309e-03  1.69260712e-02]]
grads:  [0.00498358 3.79804943]
Stock Position:  0.004983579229916393
Bond Position:  [-0.09626499]


portfolio before change:  [0.41466321]
curr_Stock_Price:  102.524752968098
curr_Factors:  [1.02524753e+02 3.72657983e-02]
mat_Sqrt:  [[ 1.97917386e+01  0.00000000e+00]
 [-7.72174056e-03  1.76927303e-02]]
grads:  [-0.00478319  4.5965289 ]
Stock Position:  -0.004783188216623953
Bond Position:  [0.9050584]


portfolio before change:  [0.41310905]
curr_Stock_Price:  102.87332743890732
curr_Factors:  [1.02873327e+02 3.71757062e-02]
mat_Sqrt:  [[ 1.98350090e+01  0.00000000e+00]
 [-7.71240105e-03  1.76713308e-02]]
grads:  [-0.01352098  2.1754068 ]
Stock Position:  -0.013520977319009277
Bond Position:  [1.80405698]


portfolio before change:  [0.42229996]
curr_Stock_Price:  102.21025457421
curr_Factors:  [1.02210255e+02 3.87430972e-02]
mat_Sqrt:  [[ 2.01183166e+01  0.00000000e+00]
 [-7.87330652e-03  1.80400115e-02]]
grads:  [-5.76717434e-03 -1.17207481e+01]
Stock Position:  -0.005767174340672156
Bond Position:  [1.01176432]


portfolio before change:  [0.42529918]
curr_Stock_Price:  101.71213532295641
curr_Factors:  [1.01712135e+02 3.92211962e-02]
mat_Sqrt:  [[ 2.01434191e+01  0.00000000e+00]
 [-7.92173680e-03  1.81509793e-02]]
grads:  [-4.69043363e-04 -2.23453179e+00]
Stock Position:  -0.0004690433630332382
Bond Position:  [0.47300658]


portfolio before change:  [0.42557497]
curr_Stock_Price:  101.25021473281048
curr_Factors:  [1.01250215e+02 3.82286917e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.42557497]
Stock Price:  102.27856930975382
PL:  [-1.85299434]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.16635642e+00  2.92591033e-01]
 [-1.91075509e-01 -5.54284080e-02]
 [ 1.10906690e-01 -2.56820724e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.39564304e-02 -6.29666011e-04]
 [-1.70477311e-01 -1.81277852e-02]
 [ 1.15475577e-01 -2.91068851e-02]
 [-1.01701307e-01  3.61507781e-01]
 [-1.09565909e-01 -5.95221031e-02]
 [ 8.29526613e-02 -8.76600194e-02]
 [-6.19659107e-02 -1.47336853e-02]
 [ 1.75747363e-03 -1.36139512e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-4.61100206e-02 -3.55557332e-02]
 [ 4.38968822e-01  2.78374722e-01]
 [ 1.30960442e-01 -1.60348346e-01]
 [ 3.95457810e-02  8.76335920e-02]
 [ 3.24441335e-02 -1.53977763e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 2.89050593e-02 -1.00978547e-01]
 [ 1.70542469e-01 -3.94780089e-02]
 [ 4.84267427e-01 -2.71865596e-01]
 [ 2.92592010e-02 -3.87082999e-01]
 [ 3.53370810e-02  4.14624443e-02]
 [ 4.45312386e-01 -4.17649159e-01]
 [-2.48446288e-01  1.66906663e-02]
 [-1.50874246e-01  1.12269674e-01]
 [-4.64451819e-02  8.09731632e-02]
 [-4.38903552e-02  1.94918370e-01]
 [-6.74827575e-01 -4.95779737e-02]
 [-1.48038326e-01 -2.29106530e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.61896346e-01  5.83521857e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.63874938e-01  5.42105186e-02]
 [-2.56739329e-02 -1.93579644e-01]
 [-3.85217588e-03 -5.63776396e-02]
 [-5.20831902e-02 -6.26711918e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.52505617]
curr_Stock_Price:  100.70306010154812
curr_Factors:  [1.00703060e+02 4.10743304e-02]
mat_Sqrt:  [[ 2.04092908e+01  0.00000000e+00]
 [-8.10672121e-03  1.85748318e-02]]
grads:  [ 0.06340512 15.75201524]
Stock Position:  0.06340512411720964
Bond Position:  [1.13996615]


portfolio before change:  [7.56333741]
curr_Stock_Price:  101.30456881620913
curr_Factors:  [1.01304569e+02 4.01889694e-02]
mat_Sqrt:  [[ 2.03087160e+01  0.00000000e+00]
 [-8.01887468e-03  1.83735501e-02]]
grads:  [-0.01059971 -3.01675004]
Stock Position:  -0.010599707498066198
Bond Position:  [8.63713621]


portfolio before change:  [7.57830163]
curr_Stock_Price:  99.99467306692645
curr_Factors:  [9.99946731e+01 4.11687769e-02]
mat_Sqrt:  [[ 2.02890096e+01  0.00000000e+00]
 [-8.11603616e-03  1.85961750e-02]]
grads:  [ 0.0049139  -1.38104059]
Stock Position:  0.004913897540655691
Bond Position:  [7.08693805]


portfolio before change:  [7.57999232]
curr_Stock_Price:  100.15844701336034
curr_Factors:  [1.00158447e+02 4.09355040e-02]
mat_Sqrt:  [[ 2.02645822e+01  0.00000000e+00]
 [-8.09300973e-03  1.85434148e-02]]
grads:  [-8.04426503e-04 -8.16391230e+00]
Stock Position:  -0.0008044265031939362
Bond Position:  [7.66056243]


portfolio before change:  [7.58060656]
curr_Stock_Price:  100.58532955681687
curr_Factors:  [1.00585330e+02 4.16374893e-02]
mat_Sqrt:  [[ 2.05247044e+01  0.00000000e+00]
 [-8.16210652e-03  1.87017355e-02]]
grads:  [-0.00459111 -0.03366885]
Stock Position:  -0.004591113107695699
Bond Position:  [8.04240518]


portfolio before change:  [7.58438681]
curr_Stock_Price:  99.98092590739296
curr_Factors:  [9.99809259e+01 4.03113233e-02]
mat_Sqrt:  [[ 2.00738503e+01  0.00000000e+00]
 [-8.03107199e-03  1.84014977e-02]]
grads:  [-0.00888663 -0.98512553]
Stock Position:  -0.008886632188664697
Bond Position:  [8.47288052]


portfolio before change:  [7.57854822]
curr_Stock_Price:  100.75712070320189
curr_Factors:  [1.00757121e+02 3.91358578e-02]
mat_Sqrt:  [[ 1.99325644e+01  0.00000000e+00]
 [-7.91311395e-03  1.81312218e-02]]
grads:  [ 0.005156   -1.60534604]
Stock Position:  0.005155999451811086
Bond Position:  [7.05904457]


portfolio before change:  [7.58313673]
curr_Stock_Price:  101.47590783794168
curr_Factors:  [1.01475908e+02 3.80131818e-02]
mat_Sqrt:  [[ 1.97847268e+01  0.00000000e+00]
 [-7.79878779e-03  1.78692677e-02]]
grads:  [2.83418743e-03 2.02306993e+01]
Stock Position:  0.002834187426681951
Bond Position:  [7.29553498]


portfolio before change:  [7.58258239]
curr_Stock_Price:  100.95853493323543
curr_Factors:  [1.00958535e+02 3.84997056e-02]
mat_Sqrt:  [[ 1.98094193e+01  0.00000000e+00]
 [-7.84853674e-03  1.79832569e-02]]
grads:  [-0.00684238 -3.30986226]
Stock Position:  -0.00684237549478025
Bond Position:  [8.2733786]


portfolio before change:  [7.58261518]
curr_Stock_Price:  101.10489525574523
curr_Factors:  [1.01104895e+02 3.78216328e-02]
mat_Sqrt:  [[ 1.96626623e+01  0.00000000e+00]
 [-7.77911386e-03  1.78241891e-02]]
grads:  [ 2.27307430e-03 -4.91803689e+00]
Stock Position:  0.00227307429762911
Bond Position:  [7.35279624]


portfolio before change:  [7.58526619]
curr_Stock_Price:  101.86679611724941
curr_Factors:  [1.01866796e+02 3.67333965e-02]
mat_Sqrt:  [[ 1.95237479e+01  0.00000000e+00]
 [-7.66638340e-03  1.75658911e-02]]
grads:  [-0.00350323 -0.83876674]
Stock Position:  -0.0035032319960033443
Bond Position:  [7.94212921]


portfolio before change:  [7.5893805]
curr_Stock_Price:  100.97576694896749
curr_Factors:  [1.00975767e+02 3.77668949e-02]
mat_Sqrt:  [[ 1.96233342e+01  0.00000000e+00]
 [-7.77348260e-03  1.78112862e-02]]
grads:  [-2.93827135e-03 -7.64344082e+00]
Stock Position:  -0.0029382713475729653
Bond Position:  [7.88607471]


portfolio before change:  [7.58743679]
curr_Stock_Price:  101.97279222091122
curr_Factors:  [1.01972792e+02 3.77787404e-02]
mat_Sqrt:  [[ 1.98202007e+01  0.00000000e+00]
 [-7.77470158e-03  1.78140792e-02]]
grads:  [-0.00330519 -1.004262  ]
Stock Position:  -0.003305189589322623
Bond Position:  [7.9244762]


portfolio before change:  [7.59530761]
curr_Stock_Price:  99.8911587399353
curr_Factors:  [9.98911587e+01 3.96448046e-02]
mat_Sqrt:  [[ 1.98893318e+01  0.00000000e+00]
 [-7.96440126e-03  1.82487358e-02]]
grads:  [-0.00309854 -1.94839432]
Stock Position:  -0.003098536219187741
Bond Position:  [7.90482398]


portfolio before change:  [7.59565887]
curr_Stock_Price:  100.09670893623
curr_Factors:  [1.00096709e+02 3.94455250e-02]
mat_Sqrt:  [[ 1.98801048e+01  0.00000000e+00]
 [-7.94435901e-03  1.82028133e-02]]
grads:  [ 0.02819208 15.29295049]
Stock Position:  0.02819208031118942
Bond Position:  [4.77372441]


portfolio before change:  [7.57936187]
curr_Stock_Price:  99.49747162634691
curr_Factors:  [9.94974716e+01 4.10688957e-02]
mat_Sqrt:  [[ 2.01636225e+01  0.00000000e+00]
 [-8.10618487e-03  1.85736029e-02]]
grads:  [ 3.02419302e-03 -8.63313097e+00]
Stock Position:  0.003024193024108908
Bond Position:  [7.27846231]


portfolio before change:  [7.58148608]
curr_Stock_Price:  99.89901329635039
curr_Factors:  [9.98990133e+01 4.19069026e-02]
mat_Sqrt:  [[ 2.04505023e+01  0.00000000e+00]
 [-8.18847019e-03  1.87621422e-02]]
grads:  [3.80392691e-03 4.67076685e+00]
Stock Position:  0.0038039269139690866
Bond Position:  [7.20147753]


portfolio before change:  [7.59336901]
curr_Stock_Price:  102.78621262844514
curr_Factors:  [1.02786213e+02 4.14639083e-02]
mat_Sqrt:  [[ 2.09300363e+01  0.00000000e+00]
 [-8.14507540e-03  1.86627123e-02]]
grads:  [-1.66064077e-03 -8.25055655e+00]
Stock Position:  -0.0016606407749189093
Bond Position:  [7.76405999]


portfolio before change:  [7.59653002]
curr_Stock_Price:  101.46718162201144
curr_Factors:  [1.01467182e+02 4.31307618e-02]
mat_Sqrt:  [[ 2.10726504e+01  0.00000000e+00]
 [-8.30717875e-03  1.90341377e-02]]
grads:  [-1.51273399e-02 -2.46550514e+01]
Stock Position:  -0.015127339884135543
Bond Position:  [9.13145856]


portfolio before change:  [7.5844711]
curr_Stock_Price:  102.33980217386436
curr_Factors:  [1.02339802e+02 4.30709961e-02]
mat_Sqrt:  [[ 2.12391451e+01  0.00000000e+00]
 [-8.30142119e-03  1.90209455e-02]]
grads:  [-7.14039648e-04 -5.30880797e+00]
Stock Position:  -0.0007140396484993898
Bond Position:  [7.65754577]


portfolio before change:  [7.58621107]
curr_Stock_Price:  101.24360970507843
curr_Factors:  [1.0124361e+02 4.5810407e-02]
mat_Sqrt:  [[ 2.16695402e+01  0.00000000e+00]
 [-8.56134634e-03  1.96165088e-02]]
grads:  [ 0.00707504 -2.01248904]
Stock Position:  0.00707503952660704
Bond Position:  [6.86990853]


portfolio before change:  [7.59796001]
curr_Stock_Price:  102.78284370579783
curr_Factors:  [1.02782844e+02 4.42220605e-02]
mat_Sqrt:  [[ 2.16142473e+01  0.00000000e+00]
 [-8.41161678e-03  1.92734353e-02]]
grads:  [  0.01691549 -14.10571554]
Stock Position:  0.01691548856887957
Bond Position:  [5.85933799]


portfolio before change:  [7.60418433]
curr_Stock_Price:  103.1075085675921
curr_Factors:  [1.03107509e+02 4.31430700e-02]
mat_Sqrt:  [[ 2.14163678e+01  0.00000000e+00]
 [-8.30836398e-03  1.90368534e-02]]
grads:  [-6.52200557e-03 -2.03333498e+01]
Stock Position:  -0.006522005565522374
Bond Position:  [8.27665208]


portfolio before change:  [7.59673382]
curr_Stock_Price:  104.40851308935798
curr_Factors:  [1.04408513e+02 4.32253275e-02]
mat_Sqrt:  [[ 2.17072624e+01  0.00000000e+00]
 [-8.31628065e-03  1.90549928e-02]]
grads:  [0.00246152 2.17593597]
Stock Position:  0.0024615160671646813
Bond Position:  [7.33973059]


portfolio before change:  [7.5993988]
curr_Stock_Price:  105.11842141838827
curr_Factors:  [1.05118421e+02 4.13278999e-02]
mat_Sqrt:  [[ 2.13698020e+01  0.00000000e+00]
 [-8.13170584e-03  1.86320788e-02]]
grads:  [ 1.23087406e-02 -2.24155965e+01]
Stock Position:  0.012308740578191162
Bond Position:  [6.30552342]


portfolio before change:  [7.59028166]
curr_Stock_Price:  104.31367848887977
curr_Factors:  [1.04313678e+02 4.20796594e-02]
mat_Sqrt:  [[ 2.13982062e+01  0.00000000e+00]
 [-8.20533089e-03  1.88007750e-02]]
grads:  [-0.01127019  0.88776481]
Stock Position:  -0.011270191611225435
Bond Position:  [8.76591681]


portfolio before change:  [7.59392168]
curr_Stock_Price:  104.08793142288246
curr_Factors:  [1.04087931e+02 4.08376421e-02]
mat_Sqrt:  [[ 2.10344280e+01  0.00000000e+00]
 [-8.08333022e-03  1.85212363e-02]]
grads:  [-4.84328565e-03  6.06167277e+00]
Stock Position:  -0.004843285651079311
Bond Position:  [8.09804927]


portfolio before change:  [7.59510051]
curr_Stock_Price:  104.05355287273156
curr_Factors:  [1.04053553e+02 4.10899334e-02]
mat_Sqrt:  [[ 2.10923336e+01  0.00000000e+00]
 [-8.10826082e-03  1.85783595e-02]]
grads:  [-5.26522879e-04  4.35846681e+00]
Stock Position:  -0.0005265228789443431
Bond Position:  [7.64988709]


portfolio before change:  [7.59669297]
curr_Stock_Price:  102.84530718212187
curr_Factors:  [1.02845307e+02 4.31455115e-02]
mat_Sqrt:  [[ 2.13625106e+01  0.00000000e+00]
 [-8.30859907e-03  1.90373921e-02]]
grads:  [1.92762904e-03 1.02387117e+01]
Stock Position:  0.0019276290362588353
Bond Position:  [7.39844537]


portfolio before change:  [7.59855201]
curr_Stock_Price:  103.3299306532273
curr_Factors:  [1.03329931e+02 4.22624762e-02]
mat_Sqrt:  [[ 2.12424012e+01  0.00000000e+00]
 [-8.22313577e-03  1.88415711e-02]]
grads:  [-0.03278656 -2.63130785]
Stock Position:  -0.03278655595346807
Bond Position:  [10.98638456]


portfolio before change:  [7.55898965]
curr_Stock_Price:  104.57848329363445
curr_Factors:  [1.04578483e+02 3.96537502e-02]
mat_Sqrt:  [[ 2.08249742e+01  0.00000000e+00]
 [-7.96529976e-03  1.82507946e-02]]
grads:  [-0.00758884 -1.25532359]
Stock Position:  -0.007588837946977074
Bond Position:  [8.35261882]


portfolio before change:  [7.56082379]
curr_Stock_Price:  104.47438336809749
curr_Factors:  [1.04474383e+02 3.93976461e-02]
mat_Sqrt:  [[ 2.07369535e+01  0.00000000e+00]
 [-7.93953612e-03  1.81917626e-02]]
grads:  [ 0.00349823 -0.6567362 ]
Stock Position:  0.003498228256976806
Bond Position:  [7.19534855]


portfolio before change:  [7.55864028]
curr_Stock_Price:  103.59308255417719
curr_Factors:  [1.03593083e+02 3.90638656e-02]
mat_Sqrt:  [[ 2.04747386e+01  0.00000000e+00]
 [-7.90583234e-03  1.81145376e-02]]
grads:  [-0.01154737  3.22129038]
Stock Position:  -0.011547369145986437
Bond Position:  [8.75486784]


portfolio before change:  [7.5649258]
curr_Stock_Price:  103.14353438171295
curr_Factors:  [1.03143534e+02 3.80640485e-02]
mat_Sqrt:  [[ 2.01233137e+01  0.00000000e+00]
 [-7.80400395e-03  1.78812194e-02]]
grads:  [0.00504247 2.98352476]
Stock Position:  0.005042468302959528
Bond Position:  [7.0448278]


portfolio before change:  [7.56605929]
curr_Stock_Price:  103.19367419829105
curr_Factors:  [1.03193674e+02 3.85990877e-02]
mat_Sqrt:  [[ 2.02741005e+01  0.00000000e+00]
 [-7.85866021e-03  1.80064526e-02]]
grads:  [-0.00466939  4.51644462]
Stock Position:  -0.004669386472121899
Bond Position:  [8.04791044]


portfolio before change:  [7.571968]
curr_Stock_Price:  102.14371714615639
curr_Factors:  [1.02143717e+02 3.95542540e-02]
mat_Sqrt:  [[ 2.03145991e+01  0.00000000e+00]
 [-7.95530052e-03  1.82278834e-02]]
grads:  [-0.01182477  2.97404352]
Stock Position:  -0.011824773218166804
Bond Position:  [8.77979429]


portfolio before change:  [7.56333183]
curr_Stock_Price:  102.96687952123693
curr_Factors:  [1.02966880e+02 3.88263091e-02]
mat_Sqrt:  [[ 2.02889983e+01  0.00000000e+00]
 [-7.88175707e-03  1.80593742e-02]]
grads:  [-5.42949507e-03 -1.07190671e+01]
Stock Position:  -0.0054294950657401714
Bond Position:  [8.12239]


portfolio before change:  [7.56427205]
curr_Stock_Price:  102.98072014156648
curr_Factors:  [1.02980720e+02 3.94011625e-02]
mat_Sqrt:  [[ 2.04413908e+01  0.00000000e+00]
 [-7.93989042e-03  1.81925744e-02]]
grads:  [-1.39214573e-03 -3.09893687e+00]
Stock Position:  -0.0013921457334136644
Bond Position:  [7.70763622]


portfolio before change:  [7.5670886]
curr_Stock_Price:  101.64965037754686
curr_Factors:  [1.01649650e+02 4.05263333e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.5670886]
Stock Price:  102.4870887727159
PL:  [5.07999983]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.24215330e+00  3.09727190e-01]
 [-2.23169631e-01 -8.04746108e-02]
 [-6.37768644e-01 -2.09572037e-01]
 [-3.42610028e-01 -6.40546342e-02]
 [-1.28081907e-01 -9.56164211e-01]
 [-3.46601550e-01  1.96777505e-01]
 [ 5.10457379e-01 -6.22642822e-01]
 [-1.12941951e+00  1.42139636e-01]
 [-8.31070164e-02 -2.48777618e-01]
 [-7.33286532e-01 -9.12055793e-01]
 [-8.91997075e-03 -2.11009527e-02]
 [-2.84679409e-01 -2.68581276e-01]
 [ 1.28057180e-02  7.86710067e-02]
 [ 2.25461945e-02 -1.93519004e-01]
 [-1.69840641e-01 -1.22642768e-01]
 [ 8.40081090e-02 -1.13583147e+00]
 [ 1.23593010e-02 -4.20768536e-01]
 [ 4.22526826e-02 -1.65461168e-01]
 [-1.10735917e-01 -2.22420038e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.04295665e-01 -1.65738967e-02]
 [ 3.37422978e-01 -3.81156457e-01]
 [ 2.71806867e-02 -3.36837764e-01]
 [ 2.36239077e-02  9.68428599e-02]
 [ 4.13676713e-01 -3.26655790e-01]
 [ 3.59124978e-02 -6.82546467e-02]
 [-1.82022609e-01  1.23569288e-02]
 [ 2.39562265e-02  2.76831278e-01]
 [-2.98094244e-02  1.88983762e-01]
 [-5.86914685e-01 -8.38799273e-02]
 [-1.64879358e-01 -5.36912125e-02]
 [ 3.55364273e-02 -5.11773921e-02]
 [-2.34651122e-01  1.38037607e-01]
 [ 2.67027339e-02  2.80526802e-02]
 [-1.17439412e-01  8.47678259e-02]
 [-2.46823728e-01  6.69242737e-02]
 [-2.62438424e-02 -1.88302581e-01]
 [-4.93803911e-03 -5.75843082e-02]
 [-5.24691338e-02 -3.88008781e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.19838031]
curr_Stock_Price:  100.36533154730985
curr_Factors:  [1.00365332e+02 3.87936094e-02]
mat_Sqrt:  [[ 1.97680494e+01  0.00000000e+00]
 [-7.87843735e-03  1.80517677e-02]]
grads:  [ 0.06967452 17.15772074]
Stock Position:  0.06967451890232698
Bond Position:  [-1.79452588]


portfolio before change:  [5.27460166]
curr_Stock_Price:  101.46251429726075
curr_Factors:  [1.01462514e+02 3.78008356e-02]
mat_Sqrt:  [[ 1.97267854e+01  0.00000000e+00]
 [-7.77697480e-03  1.78192878e-02]]
grads:  [-0.01309345 -4.51615191]
Stock Position:  -0.013093447588895975
Bond Position:  [6.60309577]


portfolio before change:  [5.251986]
curr_Stock_Price:  103.25280613779121
curr_Factors:  [1.03252806e+02 3.80543600e-02]
mat_Sqrt:  [[ 2.01420688e+01  0.00000000e+00]
 [-7.80301070e-03  1.78789436e-02]]
grads:  [ -0.03620449 -11.72172372]
Stock Position:  -0.03620449256668009
Bond Position:  [8.99020145]


portfolio before change:  [5.19050272]
curr_Stock_Price:  104.98207027825644
curr_Factors:  [1.0498207e+02 3.7726523e-02]
mat_Sqrt:  [[ 2.03909999e+01  0.00000000e+00]
 [-7.76932666e-03  1.78017638e-02]]
grads:  [-0.01817301 -3.59821841]
Stock Position:  -0.018173005897207748
Bond Position:  [7.0983425]


portfolio before change:  [5.1939482]
curr_Stock_Price:  104.84130444343883
curr_Factors:  [1.04841304e+02 3.77996391e-02]
mat_Sqrt:  [[ 2.03833820e+01  0.00000000e+00]
 [-7.77685172e-03  1.78190058e-02]]
grads:  [-2.67564128e-02 -5.36597956e+01]
Stock Position:  -0.026756412751179532
Bond Position:  [7.99912542]


portfolio before change:  [5.20724764]
curr_Stock_Price:  104.38162103479172
curr_Factors:  [1.04381621e+02 3.90898574e-02]
mat_Sqrt:  [[ 2.06374522e+01  0.00000000e+00]
 [-7.90846204e-03  1.81205630e-02]]
grads:  [-0.01263338 10.85934831]
Stock Position:  -0.012633381482982445
Bond Position:  [6.52594047]


portfolio before change:  [5.18617532]
curr_Stock_Price:  106.11418264192774
curr_Factors:  [1.06114183e+02 3.71885222e-02]
mat_Sqrt:  [[ 2.04634047e+01  0.00000000e+00]
 [-7.71373033e-03  1.76743766e-02]]
grads:  [ 1.16653986e-02 -3.52285593e+01]
Stock Position:  0.01166539859009364
Bond Position:  [3.94831108]


portfolio before change:  [5.20926194]
curr_Stock_Price:  108.05094088505628
curr_Factors:  [1.08050941e+02 3.56982149e-02]
mat_Sqrt:  [[ 2.04151137e+01  0.00000000e+00]
 [-7.55758849e-03  1.73166107e-02]]
grads:  [-0.05228404  8.20828269]
Stock Position:  -0.05228404309592453
Bond Position:  [10.85860199]


portfolio before change:  [5.20592471]
curr_Stock_Price:  108.14073196990272
curr_Factors:  [1.08140732e+02 3.57488064e-02]
mat_Sqrt:  [[ 2.04465518e+01  0.00000000e+00]
 [-7.56294191e-03  1.73288769e-02]]
grads:  [-9.37480666e-03 -1.43562459e+01]
Stock Position:  -0.009374806655458206
Bond Position:  [6.21972317]


portfolio before change:  [5.21379785]
curr_Stock_Price:  107.3838494857234
curr_Factors:  [1.07383849e+02 3.64053564e-02]
mat_Sqrt:  [[ 2.04890401e+01  0.00000000e+00]
 [-7.63207510e-03  1.74872809e-02]]
grads:  [ -0.05521685 -52.15538068]
Stock Position:  -0.05521685298650958
Bond Position:  [11.14319608]


portfolio before change:  [5.26215352]
curr_Stock_Price:  106.53333588345737
curr_Factors:  [1.06533336e+02 3.64383090e-02]
mat_Sqrt:  [[ 2.03359579e+01  0.00000000e+00]
 [-7.63552843e-03  1.74951935e-02]]
grads:  [-8.91484023e-04 -1.20609999e+00]
Stock Position:  -0.0008914840231043446
Bond Position:  [5.35712629]


portfolio before change:  [5.26361678]
curr_Stock_Price:  105.64316076290451
curr_Factors:  [1.05643161e+02 3.64148931e-02]
mat_Sqrt:  [[ 2.01595534e+01  0.00000000e+00]
 [-7.63307467e-03  1.74895712e-02]]
grads:  [ -0.01993585 -15.35665299]
Stock Position:  -0.019935852790861193
Bond Position:  [7.36970329]


portfolio before change:  [5.23444341]
curr_Stock_Price:  107.1527346634848
curr_Factors:  [1.07152735e+02 3.56358315e-02]
mat_Sqrt:  [[ 2.02277095e+01  0.00000000e+00]
 [-7.55098208e-03  1.73014735e-02]]
grads:  [2.33049423e-03 4.54706975e+00]
Stock Position:  0.0023304942258374796
Bond Position:  [4.98472458]


portfolio before change:  [5.23209013]
curr_Stock_Price:  105.87557540872328
curr_Factors:  [1.05875575e+02 3.56531033e-02]
mat_Sqrt:  [[ 1.99914572e+01  0.00000000e+00]
 [-7.55281175e-03  1.73056658e-02]]
grads:  [-3.09694397e-03 -1.11824073e+01]
Stock Position:  -0.003096943965689749
Bond Position:  [5.55998085]


portfolio before change:  [5.23013565]
curr_Stock_Price:  106.73110163911853
curr_Factors:  [1.06731102e+02 3.54695216e-02]
mat_Sqrt:  [[ 2.01010460e+01  0.00000000e+00]
 [-7.53334152e-03  1.72610539e-02]]
grads:  [-0.01111217 -7.10517268]
Stock Position:  -0.01111217461847079
Bond Position:  [6.41615029]


portfolio before change:  [5.22723036]
curr_Stock_Price:  107.06473204724576
curr_Factors:  [1.07064732e+02 3.59885141e-02]
mat_Sqrt:  [[ 2.03108637e+01  0.00000000e+00]
 [-7.58825557e-03  1.73868778e-02]]
grads:  [-2.02704027e-02 -6.53269373e+01]
Stock Position:  -0.020270402693721504
Bond Position:  [7.3974756]


portfolio before change:  [5.22574815]
curr_Stock_Price:  107.18347445968665
curr_Factors:  [1.07183474e+02 3.54165641e-02]
mat_Sqrt:  [[ 2.01711679e+01  0.00000000e+00]
 [-7.52771563e-03  1.72481633e-02]]
grads:  [-8.49128539e-03 -2.43949763e+01]
Stock Position:  -0.008491285388730382
Bond Position:  [6.13587362]


portfolio before change:  [5.23420521]
curr_Stock_Price:  106.27783709433622
curr_Factors:  [1.06277837e+02 3.61560693e-02]
mat_Sqrt:  [[ 2.02084643e+01  0.00000000e+00]
 [-7.60589974e-03  1.74273056e-02]]
grads:  [-1.48257140e-03 -9.49436311e+00]
Stock Position:  -0.0014825713991099153
Bond Position:  [5.39176969]


portfolio before change:  [5.2358869]
curr_Stock_Price:  105.59815593925346
curr_Factors:  [1.05598156e+02 3.60728275e-02]
mat_Sqrt:  [[ 2.00560973e+01  0.00000000e+00]
 [-7.59713920e-03  1.74072327e-02]]
grads:  [-1.03613369e-02 -1.27774495e+01]
Stock Position:  -0.010361336872144276
Bond Position:  [6.33002496]


portfolio before change:  [5.24524864]
curr_Stock_Price:  104.77099987087082
curr_Factors:  [1.04771000e+02 3.54947867e-02]
mat_Sqrt:  [[ 1.97389194e+01  0.00000000e+00]
 [-7.53602407e-03  1.72672004e-02]]
grads:  [-2.45510248e-04 -6.31795467e+00]
Stock Position:  -0.0002455102483444665
Bond Position:  [5.27097099]


portfolio before change:  [5.24561051]
curr_Stock_Price:  105.98090184029975
curr_Factors:  [1.05980902e+02 3.59527277e-02]
mat_Sqrt:  [[ 2.00952555e+01  0.00000000e+00]
 [-7.58448181e-03  1.73782310e-02]]
grads:  [ 0.00483011 -0.95371598]
Stock Position:  0.004830106449797411
Bond Position:  [4.73371147]


portfolio before change:  [5.24253731]
curr_Stock_Price:  105.22212928953748
curr_Factors:  [1.05222129e+02 3.62179598e-02]
mat_Sqrt:  [[ 2.0024841e+01  0.0000000e+00]
 [-7.6124067e-03  1.7442215e-02]]
grads:  [ 8.54302223e-03 -2.18525261e+01]
Stock Position:  0.00854302223338126
Bond Position:  [4.34362232]


portfolio before change:  [5.2484753]
curr_Stock_Price:  105.85363899498178
curr_Factors:  [1.05853639e+02 3.57550429e-02]
mat_Sqrt:  [[ 2.00158687e+01  0.00000000e+00]
 [-7.56360156e-03  1.73303883e-02]]
grads:  [-5.98661829e-03 -1.94362502e+01]
Stock Position:  -0.005986618291812236
Bond Position:  [5.88218063]


portfolio before change:  [5.24956404]
curr_Stock_Price:  105.79460356283191
curr_Factors:  [1.05794604e+02 3.60844192e-02]
mat_Sqrt:  [[ 2.00966364e+01  0.00000000e+00]
 [-7.59835974e-03  1.74100293e-02]]
grads:  [3.27863805e-03 5.56247540e+00]
Stock Position:  0.003278638053019804
Bond Position:  [4.90270182]


portfolio before change:  [5.2413256]
curr_Stock_Price:  103.09491252260814
curr_Factors:  [1.03094913e+02 3.51239727e-02]
mat_Sqrt:  [[ 1.93214204e+01  0.00000000e+00]
 [-7.49655630e-03  1.71767684e-02]]
grads:  [ 1.40317033e-02 -1.90173019e+01]
Stock Position:  0.014031703305092309
Bond Position:  [3.79472838]


portfolio before change:  [5.22755011]
curr_Stock_Price:  102.07936441756482
curr_Factors:  [1.02079364e+02 3.58581767e-02]
mat_Sqrt:  [[ 1.93300091e+01  0.00000000e+00]
 [-7.57450214e-03  1.73553647e-02]]
grads:  [ 3.16799013e-04 -3.93276936e+00]
Stock Position:  0.00031679901284463994
Bond Position:  [5.19521146]


portfolio before change:  [5.22817639]
curr_Stock_Price:  102.00627558281658
curr_Factors:  [1.02006276e+02 3.70564339e-02]
mat_Sqrt:  [[ 1.96362568e+01  0.00000000e+00]
 [-7.70001911e-03  1.76429602e-02]]
grads:  [-0.00899508  0.70038863]
Stock Position:  -0.00899507505246526
Bond Position:  [6.1457305]


portfolio before change:  [5.23094222]
curr_Stock_Price:  101.78420224972172
curr_Factors:  [1.01784202e+02 3.69596308e-02]
mat_Sqrt:  [[ 1.95678986e+01  0.00000000e+00]
 [-7.68995509e-03  1.76199006e-02]]
grads:  [7.39861261e-03 1.57112849e+01]
Stock Position:  0.007398612612777806
Bond Position:  [4.47788034]


portfolio before change:  [5.23245153]
curr_Stock_Price:  101.91254176884185
curr_Factors:  [1.01912542e+02 3.61100252e-02]
mat_Sqrt:  [[ 1.93660714e+01  0.00000000e+00]
 [-7.60105521e-03  1.74162054e-02]]
grads:  [2.71969726e-03 1.08510297e+01]
Stock Position:  0.002719697262205912
Bond Position:  [4.95528027]


portfolio before change:  [5.23212403]
curr_Stock_Price:  101.56436073488018
curr_Factors:  [1.01564361e+02 3.66515576e-02]
mat_Sqrt:  [[ 1.94440871e+01  0.00000000e+00]
 [-7.65783861e-03  1.75463125e-02]]
grads:  [-0.03206748 -4.78048747]
Stock Position:  -0.03206748065270336
Bond Position:  [8.4890372]


portfolio before change:  [5.20967188]
curr_Stock_Price:  102.29760653087892
curr_Factors:  [1.02297607e+02 3.47767732e-02]
mat_Sqrt:  [[ 1.90770015e+01  0.00000000e+00]
 [-7.45941265e-03  1.70916616e-02]]
grads:  [-0.00987116 -3.14136881]
Stock Position:  -0.009871159495648554
Bond Position:  [6.21946787]


portfolio before change:  [5.21125132]
curr_Stock_Price:  102.21636438597542
curr_Factors:  [1.02216364e+02 3.44454763e-02]
mat_Sqrt:  [[ 1.89708385e+01  0.00000000e+00]
 [-7.42379701e-03  1.70100559e-02]]
grads:  [ 6.95846007e-04 -3.00865515e+00]
Stock Position:  0.0006958460070367025
Bond Position:  [5.14012447]


portfolio before change:  [5.21071044]
curr_Stock_Price:  100.51564928621718
curr_Factors:  [1.00515649e+02 3.45095493e-02]
mat_Sqrt:  [[ 1.86725369e+01  0.00000000e+00]
 [-7.43069841e-03  1.70258690e-02]]
grads:  [-0.00934027  8.10752201]
Stock Position:  -0.009340271882003546
Bond Position:  [6.14955393]


portfolio before change:  [5.21867215]
curr_Stock_Price:  99.74554678834137
curr_Factors:  [9.97455468e+01 3.50664580e-02]
mat_Sqrt:  [[ 1.86783912e+01  0.00000000e+00]
 [-7.49041607e-03  1.71626993e-02]]
grads:  [0.00208508 1.63451446]
Stock Position:  0.0020850793255810336
Bond Position:  [5.01069477]


portfolio before change:  [5.22077676]
curr_Stock_Price:  100.45450786954598
curr_Factors:  [1.00454508e+02 3.54370454e-02]
mat_Sqrt:  [[ 1.89102897e+01  0.00000000e+00]
 [-7.52989194e-03  1.72531499e-02]]
grads:  [-4.25396443e-03  4.91317970e+00]
Stock Position:  -0.004253964429921293
Bond Position:  [5.64810666]


portfolio before change:  [5.21677603]
curr_Stock_Price:  101.56095482411553
curr_Factors:  [1.01560955e+02 3.48906690e-02]
mat_Sqrt:  [[ 1.89706156e+01  0.00000000e+00]
 [-7.47161766e-03  1.71196267e-02]]
grads:  [-0.01147119  3.90921337]
Stock Position:  -0.011471192368124836
Bond Position:  [6.38180128]


portfolio before change:  [5.19655162]
curr_Stock_Price:  103.39356221424407
curr_Factors:  [1.03393562e+02 3.43899178e-02]
mat_Sqrt:  [[ 1.91738386e+01  0.00000000e+00]
 [-7.41780753e-03  1.69963322e-02]]
grads:  [-5.65488364e-03 -1.10790127e+01]
Stock Position:  -0.005654883643215062
Bond Position:  [5.78123018]


portfolio before change:  [5.19785441]
curr_Stock_Price:  103.2909791914491
curr_Factors:  [1.03290979e+02 3.40929544e-02]
mat_Sqrt:  [[ 1.90719331e+01  0.00000000e+00]
 [-7.38571101e-03  1.69227899e-02]]
grads:  [-1.57665673e-03 -3.40276684e+00]
Stock Position:  -0.0015766567298652378
Bond Position:  [5.36070883]


portfolio before change:  [5.19991837]
curr_Stock_Price:  102.40693583360736
curr_Factors:  [1.02406936e+02 3.48059082e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.19991837]
Stock Price:  101.09532260163323
PL:  [4.10459577]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.13845257e+00  2.86282532e-01]
 [ 6.07097360e-02  4.49650190e-02]
 [-1.44182044e-01 -9.44067001e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.54343000e-02 -2.22827405e-02]
 [-1.21510114e-01 -7.09917417e-02]
 [ 9.00131442e-02  8.03076610e-02]
 [-1.65134838e-01  3.45272298e-01]
 [-6.39865000e-02  1.26827606e-01]
 [ 1.80385168e-01  4.53573673e-02]
 [-1.15219717e-01  3.02250875e-04]
 [ 2.48384246e-02 -1.35775768e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.68276656e-02 -3.50274401e-02]
 [ 4.20875005e-01  2.66141345e-01]
 [ 1.32570630e-01 -2.71896963e-01]
 [ 3.82037259e-02  1.14796651e-03]
 [-3.05142635e-03  7.63090008e-03]
 [-7.80864479e-02 -2.39749157e-01]
 [-9.87817385e-02 -2.02225932e-02]
 [ 1.79177205e-01 -4.57026818e-02]
 [ 8.19760881e-01 -2.03970944e-02]
 [ 2.66224789e-02 -2.17762943e-01]
 [ 5.82855183e-02  5.82816789e-03]
 [ 2.44856171e-01 -1.53762029e-01]
 [-8.00493478e-02 -2.16640870e-02]
 [-1.55768250e-01  9.74769690e-02]
 [-4.37692161e-02  9.16227758e-02]
 [-4.88085034e-02  1.97554428e-01]
 [-6.57805503e-01 -5.75001509e-02]
 [-1.62879320e-01 -4.92790397e-02]
 [ 5.00951271e-02 -3.52961043e-02]
 [-2.52677686e-01  3.12976880e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.53439668e-01 -2.61930842e-02]
 [-2.98861294e-02 -1.54576914e-01]
 [-7.57140262e-03 -6.45962402e-02]
 [ 2.09510961e-01 -1.23148858e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.33099367]
curr_Stock_Price:  100.8200459315135
curr_Factors:  [1.00820046e+02 3.98136323e-02]
mat_Sqrt:  [[ 2.01169803e+01  0.00000000e+00]
 [-7.98134147e-03  1.82875507e-02]]
grads:  [ 0.06280249 15.6545038 ]
Stock Position:  0.06280249280253683
Bond Position:  [1.99924346]


portfolio before change:  [8.33308829]
curr_Stock_Price:  100.84941893033906
curr_Factors:  [1.00849419e+02 4.03839785e-02]
mat_Sqrt:  [[ 2.02664626e+01  0.00000000e+00]
 [-8.03830614e-03  1.84180732e-02]]
grads:  [0.00396389 2.44135304]
Stock Position:  0.003963892504830644
Bond Position:  [7.93333204]


portfolio before change:  [8.33662576]
curr_Stock_Price:  101.49165151704563
curr_Factors:  [1.01491652e+02 4.03001556e-02]
mat_Sqrt:  [[ 2.03743462e+01  0.00000000e+00]
 [-8.02995946e-03  1.83989485e-02]]
grads:  [-0.00909892 -5.13109213]
Stock Position:  -0.009098918005960688
Bond Position:  [9.26008998]


portfolio before change:  [8.34902204]
curr_Stock_Price:  100.25648259799566
curr_Factors:  [1.00256483e+02 3.95236221e-02]
mat_Sqrt:  [[ 1.99315390e+01  0.00000000e+00]
 [-7.95221953e-03  1.82208240e-02]]
grads:  [-8.17867952e-04 -8.30845042e+00]
Stock Position:  -0.0008178679522456419
Bond Position:  [8.43101861]


portfolio before change:  [8.34973578]
curr_Stock_Price:  100.67245024534171
curr_Factors:  [1.00672450e+02 3.94379278e-02]
mat_Sqrt:  [[ 1.99925266e+01  0.00000000e+00]
 [-7.94359393e-03  1.82010602e-02]]
grads:  [-0.00525993 -1.22425508]
Stock Position:  -0.005259929735897871
Bond Position:  [8.8792658]


portfolio before change:  [8.35717183]
curr_Stock_Price:  99.46975943720744
curr_Factors:  [9.94697594e+01 4.14502747e-02]
mat_Sqrt:  [[ 2.02513870e+01  0.00000000e+00]
 [-8.14373621e-03  1.86596438e-02]]
grads:  [-0.00753002 -3.80456039]
Stock Position:  -0.007530024974075853
Bond Position:  [9.1061816]


portfolio before change:  [8.35630063]
curr_Stock_Price:  99.73662997928406
curr_Factors:  [9.97366300e+01 4.12795438e-02]
mat_Sqrt:  [[ 2.02638580e+01  0.00000000e+00]
 [-8.12694715e-03  1.86211753e-02]]
grads:  [0.00617169 4.31270636]
Stock Position:  0.006171691527722168
Bond Position:  [7.74075692]


portfolio before change:  [8.36909014]
curr_Stock_Price:  101.65212653333263
curr_Factors:  [1.01652127e+02 4.11121689e-02]
mat_Sqrt:  [[ 2.06111234e+01  0.00000000e+00]
 [-8.11045438e-03  1.85833856e-02]]
grads:  [-7.00866862e-04  1.85796230e+01]
Stock Position:  -0.0007008668624285017
Bond Position:  [8.44033475]


portfolio before change:  [8.37155319]
curr_Stock_Price:  99.64326520729844
curr_Factors:  [9.96432652e+01 4.27411363e-02]
mat_Sqrt:  [[ 2.06001785e+01  0.00000000e+00]
 [-8.26957182e-03  1.89479694e-02]]
grads:  [-4.19141754e-04  6.69346687e+00]
Stock Position:  -0.00041914175415934613
Bond Position:  [8.41331784]


portfolio before change:  [8.37233183]
curr_Stock_Price:  100.29482325905317
curr_Factors:  [1.00294823e+02 4.32467912e-02]
mat_Sqrt:  [[ 2.08571739e+01  0.00000000e+00]
 [-8.31834514e-03  1.90597231e-02]]
grads:  [0.00959769 2.37974954]
Stock Position:  0.009597692725338258
Bond Position:  [7.40973293]


portfolio before change:  [8.36428194]
curr_Stock_Price:  99.35958149173369
curr_Factors:  [9.93595815e+01 4.36577675e-02]
mat_Sqrt:  [[ 2.07606294e+01  0.00000000e+00]
 [-8.35777650e-03  1.91500717e-02]]
grads:  [-0.00554356  0.01578328]
Stock Position:  -0.00554356042681259
Bond Position:  [8.91508778]


portfolio before change:  [8.36219834]
curr_Stock_Price:  99.93647630605078
curr_Factors:  [9.99364763e+01 4.30699811e-02]
mat_Sqrt:  [[ 2.07401252e+01  0.00000000e+00]
 [-8.30132338e-03  1.90207214e-02]]
grads:  [-1.65953572e-03 -7.13830801e+00]
Stock Position:  -0.0016595357156818096
Bond Position:  [8.52804649]


portfolio before change:  [8.36433138]
curr_Stock_Price:  99.29354783545162
curr_Factors:  [9.92935478e+01 4.22289483e-02]
mat_Sqrt:  [[ 2.04045096e+01  0.00000000e+00]
 [-8.21987332e-03  1.88340958e-02]]
grads:  [-0.00633923 -1.48939484]
Stock Position:  -0.006339230428377116
Bond Position:  [8.99377606]


portfolio before change:  [8.36236665]
curr_Stock_Price:  99.78083426650298
curr_Factors:  [9.97808343e+01 4.03841231e-02]
mat_Sqrt:  [[ 2.00517582e+01  0.00000000e+00]
 [-8.03832053e-03  1.84181061e-02]]
grads:  [-0.00309773 -1.9017938 ]
Stock Position:  -0.0030977280450757757
Bond Position:  [8.67146054]


portfolio before change:  [8.36150048]
curr_Stock_Price:  100.41038353613038
curr_Factors:  [1.00410384e+02 4.21562163e-02]
mat_Sqrt:  [[ 2.06162389e+01  0.00000000e+00]
 [-8.21279161e-03  1.88178696e-02]]
grads:  [ 0.02604882 14.14301142]
Stock Position:  0.02604881587115589
Bond Position:  [5.74592888]


portfolio before change:  [8.3592922]
curr_Stock_Price:  100.29803420744341
curr_Factors:  [1.00298034e+02 4.14807552e-02]
mat_Sqrt:  [[ 2.04275249e+01  0.00000000e+00]
 [-8.14672991e-03  1.86665032e-02]]
grads:  [ 6.80702487e-04 -1.45660363e+01]
Stock Position:  0.0006807024870272153
Bond Position:  [8.29101907]


portfolio before change:  [8.36065427]
curr_Stock_Price:  100.7764038354882
curr_Factors:  [1.00776404e+02 4.01763788e-02]
mat_Sqrt:  [[ 2.01996690e+01  0.00000000e+00]
 [-8.01761848e-03  1.83706718e-02]]
grads:  [0.00191611 0.06248909]
Stock Position:  0.0019161076201472099
Bond Position:  [8.16755583]


portfolio before change:  [8.35811804]
curr_Stock_Price:  98.91991436774929
curr_Factors:  [9.89199144e+01 4.05527793e-02]
mat_Sqrt:  [[ 1.99202160e+01  0.00000000e+00]
 [-8.05508826e-03  1.84565258e-02]]
grads:  [1.40044407e-05 4.13452680e-01]
Stock Position:  1.4004440716938899e-05
Bond Position:  [8.35673272]


portfolio before change:  [8.35917141]
curr_Stock_Price:  99.54190995760206
curr_Factors:  [9.95419100e+01 4.05644676e-02]
mat_Sqrt:  [[ 2.00483603e+01  0.00000000e+00]
 [-8.05624901e-03  1.84591855e-02]]
grads:  [-9.1140400e-03 -1.2988068e+01]
Stock Position:  -0.009114040003392651
Bond Position:  [9.26640036]


portfolio before change:  [8.36445369]
curr_Stock_Price:  99.0894309447722
curr_Factors:  [9.90894309e+01 4.14066439e-02]
mat_Sqrt:  [[ 2.01633343e+01  0.00000000e+00]
 [-8.13944902e-03  1.86498206e-02]]
grads:  [-0.0053368  -1.08433178]
Stock Position:  -0.0053367959986575725
Bond Position:  [8.89327377]


portfolio before change:  [8.3626888]
curr_Stock_Price:  99.62844765774092
curr_Factors:  [9.96284477e+01 3.97539807e-02]
mat_Sqrt:  [[ 1.98643187e+01  0.00000000e+00]
 [-7.97536012e-03  1.82738457e-02]]
grads:  [ 0.00801593 -2.50098871]
Stock Position:  0.00801592651773308
Bond Position:  [7.56407448]


portfolio before change:  [8.36652539]
curr_Stock_Price:  99.98910708894593
curr_Factors:  [9.99891071e+01 3.97019013e-02]
mat_Sqrt:  [[ 1.99231655e+01  0.00000000e+00]
 [-7.97013439e-03  1.82618721e-02]]
grads:  [ 0.0406993  -1.11692242]
Stock Position:  0.04069929844108812
Bond Position:  [4.29703888]


portfolio before change:  [8.37877517]
curr_Stock_Price:  100.27689152803472
curr_Factors:  [1.00276892e+02 4.13056359e-02]
mat_Sqrt:  [[ 2.03800629e+01  0.00000000e+00]
 [-8.12951521e-03  1.86270594e-02]]
grads:  [-3.35705839e-03 -1.16906774e+01]
Stock Position:  -0.0033570583907888965
Bond Position:  [8.71541055]


portfolio before change:  [8.37539632]
curr_Stock_Price:  101.6079237609252
curr_Factors:  [1.01607924e+02 4.08820417e-02]
mat_Sqrt:  [[ 2.05444191e+01  0.00000000e+00]
 [-8.08772321e-03  1.85313019e-02]]
grads:  [0.00296086 0.31450396]
Stock Position:  0.0029608595437484978
Bond Position:  [8.07454952]


portfolio before change:  [8.37520717]
curr_Stock_Price:  101.20313300341697
curr_Factors:  [1.01203133e+02 4.08657030e-02]
mat_Sqrt:  [[ 2.04584838e+01  0.00000000e+00]
 [-8.08610690e-03  1.85275985e-02]]
grads:  [ 0.00868827 -8.29908037]
Stock Position:  0.008688274349542086
Bond Position:  [7.49592658]


portfolio before change:  [8.39087537]
curr_Stock_Price:  102.89865357729411
curr_Factors:  [1.02898654e+02 4.01734398e-02]
mat_Sqrt:  [[ 2.06242993e+01  0.00000000e+00]
 [-8.01732522e-03  1.83699999e-02]]
grads:  [-0.00433975 -1.17931884]
Stock Position:  -0.004339751346702803
Bond Position:  [8.83742994]


portfolio before change:  [8.38907049]
curr_Stock_Price:  103.56911298461196
curr_Factors:  [1.03569113e+02 4.00490170e-02]
mat_Sqrt:  [[ 2.07265103e+01  0.00000000e+00]
 [-8.00490020e-03  1.83415306e-02]]
grads:  [-0.00546285  5.31454933]
Stock Position:  -0.005462849824945324
Bond Position:  [8.954853]


portfolio before change:  [8.38808393]
curr_Stock_Price:  103.9546229254951
curr_Factors:  [1.03954623e+02 4.13489258e-02]
mat_Sqrt:  [[ 2.11385855e+01  0.00000000e+00]
 [-8.13377411e-03  1.86368178e-02]]
grads:  [-1.78903098e-04  4.91622427e+00]
Stock Position:  -0.00017890309758449862
Bond Position:  [8.40668173]


portfolio before change:  [8.38926665]
curr_Stock_Price:  103.21781585189495
curr_Factors:  [1.03217816e+02 4.15484511e-02]
mat_Sqrt:  [[ 2.10393386e+01  0.00000000e+00]
 [-8.15337487e-03  1.86817288e-02]]
grads:  [1.77816035e-03 1.05747402e+01]
Stock Position:  0.0017781603457206283
Bond Position:  [8.20572882]


portfolio before change:  [8.39001775]
curr_Stock_Price:  103.063344359859
curr_Factors:  [1.03063344e+02 4.10660877e-02]
mat_Sqrt:  [[ 2.08855490e+01  0.00000000e+00]
 [-8.10590774e-03  1.85729679e-02]]
grads:  [-0.03269728 -3.09590536]
Stock Position:  -0.03269727913033418
Bond Position:  [11.75990869]


portfolio before change:  [8.40838506]
curr_Stock_Price:  102.54656669180461
curr_Factors:  [1.02546567e+02 4.24243188e-02]
mat_Sqrt:  [[ 2.11216851e+01  0.00000000e+00]
 [-8.23886582e-03  1.88776131e-02]]
grads:  [-0.00872972 -2.61044865]
Stock Position:  -0.00872972283587597
Bond Position:  [9.30358816]


portfolio before change:  [8.40778041]
curr_Stock_Price:  102.7490548449417
curr_Factors:  [1.02749055e+02 4.18894644e-02]
mat_Sqrt:  [[ 2.10295626e+01  0.00000000e+00]
 [-8.18676634e-03  1.87582382e-02]]
grads:  [ 1.64961321e-03 -1.88163216e+00]
Stock Position:  0.0016496132105453783
Bond Position:  [8.23828422]


portfolio before change:  [8.41124546]
curr_Stock_Price:  104.22527527977199
curr_Factors:  [1.04225275e+02 4.09474906e-02]
mat_Sqrt:  [[ 2.10904913e+01  0.00000000e+00]
 [-8.09419453e-03  1.85461296e-02]]
grads:  [-0.01133299  1.68755901]
Stock Position:  -0.011332986597874798
Bond Position:  [9.5924291]


portfolio before change:  [8.41910096]
curr_Stock_Price:  103.63792987264485
curr_Factors:  [1.03637930e+02 4.31156184e-02]
mat_Sqrt:  [[ 2.15196914e+01  0.00000000e+00]
 [-8.30572028e-03  1.90307959e-02]]
grads:  [0.00471527 2.80330161]
Stock Position:  0.004715270763875748
Bond Position:  [7.93042006]


portfolio before change:  [8.42306503]
curr_Stock_Price:  104.2683711373557
curr_Factors:  [1.04268371e+02 4.24805664e-02]
mat_Sqrt:  [[ 2.14905603e+01  0.00000000e+00]
 [-8.24432570e-03  1.88901233e-02]]
grads:  [-0.00440508  4.30516757]
Stock Position:  -0.004405078764650585
Bond Position:  [8.88237542]


portfolio before change:  [8.41883848]
curr_Stock_Price:  105.47990761906239
curr_Factors:  [1.05479908e+02 4.17284272e-02]
mat_Sqrt:  [[ 2.15469473e+01  0.00000000e+00]
 [-8.17101484e-03  1.87221470e-02]]
grads:  [-0.01693378 -1.39904276]
Stock Position:  -0.016933780105996978
Bond Position:  [10.20501204]


portfolio before change:  [8.40569191]
curr_Stock_Price:  106.33159461188639
curr_Factors:  [1.06331595e+02 4.12950201e-02]
mat_Sqrt:  [[ 2.16078307e+01  0.00000000e+00]
 [-8.12847047e-03  1.86246656e-02]]
grads:  [-4.50526604e-03 -8.29958066e+00]
Stock Position:  -0.004505266038230701
Bond Position:  [8.88474403]


portfolio before change:  [8.4087742]
curr_Stock_Price:  105.89396550036356
curr_Factors:  [1.05893966e+02 4.13165413e-02]
mat_Sqrt:  [[ 2.15245059e+01  0.00000000e+00]
 [-8.13058830e-03  1.86295182e-02]]
grads:  [-1.66152539e-03 -3.46741336e+00]
Stock Position:  -0.0016615253913632518
Bond Position:  [8.58471972]


portfolio before change:  [8.40837045]
curr_Stock_Price:  106.78285721052725
curr_Factors:  [1.06782857e+02 4.08013906e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.40837045]
Stock Price:  107.42596537450476
PL:  [0.98240507]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.42618631e+00  3.51333364e-01]
 [ 1.08542173e+00  6.97406953e-02]
 [ 8.23704412e-02 -6.11124514e-04]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.51029468e-02  1.96185576e-01]
 [-2.71388848e-01  9.15485548e-02]
 [ 9.73581534e-02  3.10792634e-02]
 [ 3.52536756e-01  4.84595333e-01]
 [-4.59604462e-02  1.95158517e-01]
 [ 1.82512379e-01  5.00413717e-02]
 [-6.69534694e-02  1.34572696e-02]
 [ 2.58346771e-02 -1.33798559e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.22498212e-02 -3.83974125e-02]
 [ 4.10276859e-01  2.58759845e-01]
 [ 1.31370446e-01 -1.89083600e-01]
 [ 3.95825758e-02  1.00435360e-01]
 [-1.64914995e-03 -1.67374499e-02]
 [-8.16811951e-02 -2.62750800e-01]
 [-7.42349937e-02 -4.05962014e-02]
 [ 1.72863675e-01 -3.84377084e-02]
 [ 8.60314806e-01  4.21403589e-03]
 [ 2.63473072e-02 -2.04186963e-01]
 [-1.66559543e-02  3.91282084e-02]
 [-4.99660987e-02  4.30588697e-02]
 [ 1.46586226e-01 -9.75653485e-02]
 [-7.42486670e-02 -6.59256199e-02]
 [ 5.43824468e-02  2.46713761e-01]
 [-1.78682951e-02  1.83241776e-01]
 [-6.03252644e-01 -7.86968191e-02]
 [-1.64434041e-01 -5.26440592e-02]
 [ 1.92613051e-02 -6.10346377e-02]
 [-2.78398391e-01  1.06781626e-01]
 [ 6.54037558e-02  6.41917780e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.62670616e-01  5.50789599e-02]
 [-2.49222691e-02 -2.00539657e-01]
 [-2.27463270e-03 -5.46245903e-02]
 [-4.23721311e-02 -3.77800787e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.25689804]
curr_Stock_Price:  99.57347080932642
curr_Factors:  [9.95734708e+01 4.13011152e-02]
mat_Sqrt:  [[ 2.02359937e+01  0.00000000e+00]
 [-8.12907032e-03  1.86260400e-02]]
grads:  [ 0.07805501 18.86248305]
Stock Position:  0.07805501354884317
Bond Position:  [-8.02910665]


portfolio before change:  [-0.35371019]
curr_Stock_Price:  98.34602309183022
curr_Factors:  [9.83460231e+01 4.03110120e-02]
mat_Sqrt:  [[ 1.97455235e+01  0.00000000e+00]
 [-8.03104098e-03  1.84014266e-02]]
grads:  [0.056512   3.78996133]
Stock Position:  0.056512001787100745
Bond Position:  [-5.91144082]


portfolio before change:  [-0.34900948]
curr_Stock_Price:  98.44228022673022
curr_Factors:  [9.84422802e+01 4.14434898e-02]
mat_Sqrt:  [[ 2.00405587e+01  0.00000000e+00]
 [-8.14306967e-03  1.86581166e-02]]
grads:  [ 0.00409688 -0.03275382]
Stock Position:  0.004096878035613827
Bond Position:  [-0.7523155]


portfolio before change:  [-0.34967485]
curr_Stock_Price:  98.30282702857845
curr_Factors:  [9.83028270e+01 4.07110654e-02]
mat_Sqrt:  [[ 1.98345450e+01  0.00000000e+00]
 [-8.07079331e-03  1.84925106e-02]]
grads:  [-8.21867453e-04 -8.18638504e+00]
Stock Position:  -0.0008218674529350542
Bond Position:  [-0.26888296]


portfolio before change:  [-0.35024212]
curr_Stock_Price:  98.95215517492024
curr_Factors:  [9.89521552e+01 3.97517581e-02]
mat_Sqrt:  [[ 1.97289253e+01  0.00000000e+00]
 [-7.97513717e-03  1.82733349e-02]]
grads:  [5.33199758e-04 1.07361671e+01]
Stock Position:  0.0005331997579431836
Bond Position:  [-0.40300339]


portfolio before change:  [-0.34921625]
curr_Stock_Price:  100.97062497344898
curr_Factors:  [1.00970625e+02 3.93278518e-02]
mat_Sqrt:  [[ 2.00237381e+01  0.00000000e+00]
 [-7.93250042e-03  1.81756418e-02]]
grads:  [-0.01155797  5.03688155]
Stock Position:  -0.011557970913440864
Bond Position:  [0.81779929]


portfolio before change:  [-0.34231749]
curr_Stock_Price:  100.38258665363259
curr_Factors:  [1.00382587e+02 3.88766229e-02]
mat_Sqrt:  [[ 1.97925909e+01  0.00000000e+00]
 [-7.88686228e-03  1.80710717e-02]]
grads:  [0.00560423 1.7198351 ]
Stock Position:  0.005604231224015022
Bond Position:  [-0.90488472]


portfolio before change:  [-0.34341963]
curr_Stock_Price:  100.20610971018415
curr_Factors:  [1.00206110e+02 4.10871427e-02]
mat_Sqrt:  [[ 2.03117420e+01  0.00000000e+00]
 [-8.10798547e-03  1.85777286e-02]]
grads:  [ 0.02776874 26.08474613]
Stock Position:  0.027768740730331632
Bond Position:  [-3.12601711]


portfolio before change:  [-0.37134422]
curr_Stock_Price:  99.21456968774835
curr_Factors:  [9.92145697e+01 4.11692025e-02]
mat_Sqrt:  [[ 2.01308300e+01  0.00000000e+00]
 [-8.11607812e-03  1.85962712e-02]]
grads:  [1.94794321e-03 1.04944973e+01]
Stock Position:  0.0019479432096541523
Bond Position:  [-0.56460857]


portfolio before change:  [-0.37149607]
curr_Stock_Price:  99.17285243862298
curr_Factors:  [9.91728524e+01 3.98721058e-02]
mat_Sqrt:  [[ 1.98028360e+01  0.00000000e+00]
 [-7.98720034e-03  1.83009751e-02]]
grads:  [0.01031934 2.73435549]
Stock Position:  0.010319341315680429
Bond Position:  [-1.39489458]


portfolio before change:  [-0.38592741]
curr_Stock_Price:  97.79127470243266
curr_Factors:  [9.77912747e+01 3.98928792e-02]
mat_Sqrt:  [[ 1.95320487e+01  0.00000000e+00]
 [-7.98928074e-03  1.83057419e-02]]
grads:  [-0.00312718  0.73513927]
Stock Position:  -0.0031271801728158656
Bond Position:  [-0.08011648]


portfolio before change:  [-0.38902873]
curr_Stock_Price:  98.77980349996722
curr_Factors:  [9.87798035e+01 3.89131096e-02]
mat_Sqrt:  [[ 1.94857051e+01  0.00000000e+00]
 [-7.89056242e-03  1.80795498e-02]]
grads:  [-1.67095833e-03 -7.40054704e+00]
Stock Position:  -0.0016709583292300679
Bond Position:  [-0.2239718]


portfolio before change:  [-0.38978686]
curr_Stock_Price:  99.21675429754954
curr_Factors:  [9.92167543e+01 3.84591723e-02]
mat_Sqrt:  [[ 1.94574078e+01  0.00000000e+00]
 [-7.84440410e-03  1.79737878e-02]]
grads:  [-0.0066478  -1.56068412]
Stock Position:  -0.006647796519936828
Bond Position:  [0.26978594]


portfolio before change:  [-0.39814918]
curr_Stock_Price:  100.47973570938376
curr_Factors:  [1.00479736e+02 3.77147989e-02]
mat_Sqrt:  [[ 1.95134645e+01  0.00000000e+00]
 [-7.76811935e-03  1.77989975e-02]]
grads:  [-0.00302395 -2.15727951]
Stock Position:  -0.0030239543538392154
Bond Position:  [-0.09430304]


portfolio before change:  [-0.39845091]
curr_Stock_Price:  100.57561996998076
curr_Factors:  [1.00575620e+02 3.84643083e-02]
mat_Sqrt:  [[ 1.97252121e+01  0.00000000e+00]
 [-7.84492787e-03  1.79749879e-02]]
grads:  [ 0.02652488 14.39555045]
Stock Position:  0.02652488148938256
Bond Position:  [-3.06620732]


portfolio before change:  [-0.42203112]
curr_Stock_Price:  99.70108609025475
curr_Factors:  [9.97010861e+01 4.00438114e-02]
mat_Sqrt:  [[ 1.99511343e+01  0.00000000e+00]
 [-8.00437994e-03  1.83403385e-02]]
grads:  [ 2.44836192e-03 -1.03097116e+01]
Stock Position:  0.0024483619174426657
Bond Position:  [-0.66613546]


portfolio before change:  [-0.42280886]
curr_Stock_Price:  99.41744107254809
curr_Factors:  [9.94174411e+01 3.89665900e-02]
mat_Sqrt:  [[ 1.96249601e+01  0.00000000e+00]
 [-7.89598278e-03  1.80919694e-02]]
grads:  [4.25051365e-03 5.55137797e+00]
Stock Position:  0.004250513649318743
Bond Position:  [-0.84538405]


portfolio before change:  [-0.42373634]
curr_Stock_Price:  99.22409874464891
curr_Factors:  [9.92240987e+01 3.91405973e-02]
mat_Sqrt:  [[ 1.96304786e+01  0.00000000e+00]
 [-7.91359310e-03  1.81323197e-02]]
grads:  [-4.56126015e-04 -9.23072733e-01]
Stock Position:  -0.00045612601458020944
Bond Position:  [-0.37847765]


portfolio before change:  [-0.42395103]
curr_Stock_Price:  99.59104739522442
curr_Factors:  [9.95910474e+01 3.60273420e-02]
mat_Sqrt:  [[ 1.89032471e+01  0.00000000e+00]
 [-7.59234794e-03  1.73962546e-02]]
grads:  [-1.03873713e-02 -1.51038719e+01]
Stock Position:  -0.0103873712638555
Bond Position:  [0.61053815]


portfolio before change:  [-0.42490889]
curr_Stock_Price:  99.69060838778086
curr_Factors:  [9.96906084e+01 3.55126624e-02]
mat_Sqrt:  [[ 1.87864994e+01  0.00000000e+00]
 [-7.53792145e-03  1.72715478e-02]]
grads:  [-0.00489461 -2.35046689]
Stock Position:  -0.004894612171802242
Bond Position:  [0.06303798]


portfolio before change:  [-0.41993078]
curr_Stock_Price:  98.67516093472128
curr_Factors:  [9.86751609e+01 3.78434393e-02]
mat_Sqrt:  [[ 1.91956642e+01  0.00000000e+00]
 [-7.78135611e-03  1.78293267e-02]]
grads:  [ 0.00813142 -2.15586988]
Stock Position:  0.008131423961108284
Bond Position:  [-1.22230035]


portfolio before change:  [-0.41156801]
curr_Stock_Price:  99.7224038606408
curr_Factors:  [9.97224039e+01 3.70143218e-02]
mat_Sqrt:  [[ 1.91856995e+01  0.00000000e+00]
 [-7.69564259e-03  1.76329324e-02]]
grads:  [0.04493732 0.23898668]
Stock Position:  0.04493732238583474
Bond Position:  [-4.89282582]


portfolio before change:  [-0.39147905]
curr_Stock_Price:  100.18305874910587
curr_Factors:  [1.00183059e+02 3.70320774e-02]
mat_Sqrt:  [[ 1.92789477e+01  0.00000000e+00]
 [-7.69748816e-03  1.76371611e-02]]
grads:  [-3.25573732e-03 -1.15770879e+01]
Stock Position:  -0.003255737315977785
Bond Position:  [-0.06530933]


portfolio before change:  [-0.39038796]
curr_Stock_Price:  99.84542140725776
curr_Factors:  [9.98454214e+01 3.72826971e-02]
mat_Sqrt:  [[ 1.92788807e+01  0.00000000e+00]
 [-7.72349114e-03  1.76967414e-02]]
grads:  [2.18371536e-05 2.21104030e+00]
Stock Position:  2.183715356550493e-05
Bond Position:  [-0.3925683]


portfolio before change:  [-0.39045801]
curr_Stock_Price:  98.8847099830839
curr_Factors:  [9.88847100e+01 3.70854388e-02]
mat_Sqrt:  [[ 1.90428021e+01  0.00000000e+00]
 [-7.70303200e-03  1.76498636e-02]]
grads:  [-1.63703152e-03  2.43961487e+00]
Stock Position:  -0.001637031516506858
Bond Position:  [-0.22858062]


portfolio before change:  [-0.39161933]
curr_Stock_Price:  99.57666198408128
curr_Factors:  [9.9576662e+01 3.6629190e-02]
mat_Sqrt:  [[ 1.90577323e+01  0.00000000e+00]
 [-7.65550156e-03  1.75409577e-02]]
grads:  [ 5.45737631e-03 -5.56214491e+00]
Stock Position:  0.005457376310821588
Bond Position:  [-0.93504665]


portfolio before change:  [-0.38250806]
curr_Stock_Price:  101.26761263945335
curr_Factors:  [1.01267613e+02 3.62618910e-02]
mat_Sqrt:  [[ 1.92839411e+01  0.00000000e+00]
 [-7.61702210e-03  1.74527902e-02]]
grads:  [-0.00534232 -3.7773685 ]
Stock Position:  -0.005342319081739501
Bond Position:  [0.15849583]


portfolio before change:  [-0.38062886]
curr_Stock_Price:  100.91956255380197
curr_Factors:  [1.00919563e+02 3.63188610e-02]
mat_Sqrt:  [[ 1.92327537e+01  0.00000000e+00]
 [-7.62300319e-03  1.74664946e-02]]
grads:  [8.42610280e-03 1.41249728e+01]
Stock Position:  0.0084261027952486
Bond Position:  [-1.23098746]


portfolio before change:  [-0.37957665]
curr_Stock_Price:  101.06269986971539
curr_Factors:  [1.01062700e+02 3.52489973e-02]
mat_Sqrt:  [[ 1.89742352e+01  0.00000000e+00]
 [-7.50988653e-03  1.72073117e-02]]
grads:  [3.27312124e-03 1.06490647e+01]
Stock Position:  0.0032731212374893363
Bond Position:  [-0.71036712]


portfolio before change:  [-0.37715461]
curr_Stock_Price:  101.82981024763436
curr_Factors:  [1.01829810e+02 3.55624973e-02]
mat_Sqrt:  [[ 1.92030874e+01  0.00000000e+00]
 [-7.54320858e-03  1.72836621e-02]]
grads:  [-0.03320293 -4.5532491 ]
Stock Position:  -0.03320292915240464
Bond Position:  [3.00389337]


portfolio before change:  [-0.39445216]
curr_Stock_Price:  102.36208453735443
curr_Factors:  [1.02362085e+02 3.40236145e-02]
mat_Sqrt:  [[ 1.88811893e+01  0.00000000e+00]
 [-7.37819648e-03  1.69055719e-02]]
grads:  [-0.00992574 -3.1140064 ]
Stock Position:  -0.00992574088397355
Bond Position:  [0.62156737]


portfolio before change:  [-0.387812]
curr_Stock_Price:  101.7009292714998
curr_Factors:  [1.01700929e+02 3.44126091e-02]
mat_Sqrt:  [[ 1.88661690e+01  0.00000000e+00]
 [-7.42025434e-03  1.70019386e-02]]
grads:  [-3.90985293e-04 -3.58986344e+00]
Stock Position:  -0.0003909852932130517
Bond Position:  [-0.34804844]


portfolio before change:  [-0.38815302]
curr_Stock_Price:  102.4618474116133
curr_Factors:  [1.02461847e+02 3.48877130e-02]
mat_Sqrt:  [[ 1.91380829e+01  0.00000000e+00]
 [-7.47130114e-03  1.71189015e-02]]
grads:  [-0.01211172  6.23764471]
Stock Position:  -0.012111718256709455
Bond Position:  [0.85283601]


portfolio before change:  [-0.37801773]
curr_Stock_Price:  101.63383307515288
curr_Factors:  [1.01633833e+02 3.43388364e-02]
mat_Sqrt:  [[ 1.88335024e+01  0.00000000e+00]
 [-7.41229642e-03  1.69837047e-02]]
grads:  [0.00496027 3.77960987]
Stock Position:  0.00496027464509607
Bond Position:  [-0.88214946]


portfolio before change:  [-0.37969368]
curr_Stock_Price:  101.31819136564536
curr_Factors:  [1.01318191e+02 3.29614240e-02]
mat_Sqrt:  [[ 1.83946027e+01  0.00000000e+00]
 [-7.26211253e-03  1.66395902e-02]]
grads:  [-0.00514649  4.88744886]
Stock Position:  -0.005146488479803069
Bond Position:  [0.14173923]


portfolio before change:  [-0.38374441]
curr_Stock_Price:  102.1087210506443
curr_Factors:  [1.02108721e+02 3.34960680e-02]
mat_Sqrt:  [[ 1.86878677e+01  0.00000000e+00]
 [-7.32077242e-03  1.67739969e-02]]
grads:  [-0.01276936  3.28359188]
Stock Position:  -0.012769364099955098
Bond Position:  [0.92011902]


portfolio before change:  [-0.3875139]
curr_Stock_Price:  102.41292649530784
curr_Factors:  [1.02412926e+02 3.33936130e-02]
mat_Sqrt:  [[ 1.87148556e+01  0.00000000e+00]
 [-7.30956776e-03  1.67483238e-02]]
grads:  [-6.00832584e-03 -1.19737151e+01]
Stock Position:  -0.006008325837608735
Bond Position:  [0.22781633]


portfolio before change:  [-0.38815554]
curr_Stock_Price:  102.52445860549598
curr_Factors:  [1.02524459e+02 3.25985355e-02]
mat_Sqrt:  [[ 1.85108572e+01  0.00000000e+00]
 [-7.22202581e-03  1.65477400e-02]]
grads:  [-1.41078061e-03 -3.30103025e+00]
Stock Position:  -0.0014107806126125524
Bond Position:  [-0.24351602]


portfolio before change:  [-0.38823599]
curr_Stock_Price:  102.55990148368134
curr_Factors:  [1.02559901e+02 3.23002607e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.38823599]
Stock Price:  100.76727288669372
PL:  [-1.15550887]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.42683367e+00  3.51479720e-01]
 [ 1.16572572e+00  6.21570396e-02]
 [ 4.67109500e-02  3.29242637e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.07777425e-01  7.90786886e-01]
 [ 5.98716136e-02  4.36839583e-02]
 [ 8.94270171e-02  9.30664890e-02]
 [ 1.08771382e+00  1.10820628e+00]
 [-1.72431138e-03  3.27785262e-01]
 [ 1.97071866e-01  1.13026026e-01]
 [-1.15219717e-01  3.02250875e-04]
 [ 2.59372923e-02 -1.33843985e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-6.28568979e-02  1.63527248e-02]
 [ 3.69476502e-01  2.28549061e-01]
 [ 1.32395314e-01 -2.60268816e-01]
 [ 3.95560644e-02  8.84161100e-02]
 [-5.09412619e-04 -3.61275057e-02]
 [-7.77056854e-02 -5.80432068e-02]
 [-2.88974461e-01  1.01177376e-01]
 [ 2.77881204e-02  1.51414165e-01]
 [ 1.71758101e+00  2.24762478e-01]
 [ 1.52377963e-02  4.40001014e-01]
 [-1.44644494e-01  1.57244388e-01]
 [-1.89264283e-01  1.51633632e-01]
 [ 2.05928839e-01 -7.60693470e-02]
 [-9.96889343e-02 -4.51034086e-01]
 [ 6.78541934e-02  5.77980161e-02]
 [ 2.16690323e-01  2.28484449e-03]
 [-5.27979958e-01 -1.96484456e-01]
 [-6.78905791e-03  6.10336039e-04]
 [-6.38690323e-02  6.30900915e-02]
 [ 9.85312908e-02  1.91270512e-01]
 [ 5.27283830e-03  1.34892503e-02]
 [-6.76499292e-03  4.84179153e-02]
 [-1.94310158e-01  9.51047232e-02]
 [-3.73753246e-02 -8.93394884e-02]
 [-4.93764003e-02 -4.30756591e-02]
 [-3.36844800e-02 -1.02013010e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.29664495]
curr_Stock_Price:  99.5677013483129
curr_Factors:  [9.95677013e+01 4.04567172e-02]
mat_Sqrt:  [[ 2.00269033e+01  0.00000000e+00]
 [-8.04554209e-03  1.84346528e-02]]
grads:  [ 0.07890546 19.06625115]
Stock Position:  0.07890545904089648
Bond Position:  [-8.15308013]


portfolio before change:  [-0.41374582]
curr_Stock_Price:  98.09655248096567
curr_Factors:  [9.80965525e+01 4.07545938e-02]
mat_Sqrt:  [[ 1.98035035e+01  0.00000000e+00]
 [-8.07510682e-03  1.85023941e-02]]
grads:  [0.06023446 3.35940523]
Stock Position:  0.06023445657308476
Bond Position:  [-6.32253835]


portfolio before change:  [-0.4125372]
curr_Stock_Price:  98.12973929595837
curr_Factors:  [9.81297393e+01 3.97202502e-02]
mat_Sqrt:  [[ 1.95571980e+01  0.00000000e+00]
 [-7.97197593e-03  1.82660916e-02]]
grads:  [0.00312316 1.80247995]
Stock Position:  0.0031231609308008117
Bond Position:  [-0.71901217]


portfolio before change:  [-0.41727127]
curr_Stock_Price:  96.64272533212386
curr_Factors:  [9.66427253e+01 4.09980993e-02]
mat_Sqrt:  [[ 1.95682068e+01  0.00000000e+00]
 [-8.09919496e-03  1.85575870e-02]]
grads:  [-8.33053692e-04 -8.15767765e+00]
Stock Position:  -0.00083305369224625
Bond Position:  [-0.33676269]


portfolio before change:  [-0.41811841]
curr_Stock_Price:  97.6091007289983
curr_Factors:  [9.76091007e+01 3.99841826e-02]
mat_Sqrt:  [[ 1.95179600e+01  0.00000000e+00]
 [-7.99841811e-03  1.83266782e-02]]
grads:  [1.21606084e-02 4.31494937e+01]
Stock Position:  0.01216060836069023
Bond Position:  [-1.60510445]


portfolio before change:  [-0.44491757]
curr_Stock_Price:  95.42183243905261
curr_Factors:  [9.54218324e+01 4.16778830e-02]
mat_Sqrt:  [[ 1.94805215e+01  0.00000000e+00]
 [-8.16606471e-03  1.87108048e-02]]
grads:  [0.00405209 2.33469157]
Stock Position:  0.004052091531726627
Bond Position:  [-0.83157557]


portfolio before change:  [-0.4486376]
curr_Stock_Price:  94.52943428088021
curr_Factors:  [9.45294343e+01 4.28152472e-02]
mat_Sqrt:  [[ 1.95598845e+01  0.00000000e+00]
 [-8.27673822e-03  1.89643897e-02]]
grads:  [0.00664853 4.90743391]
Stock Position:  0.0066485342815271785
Bond Position:  [-1.07711979]


portfolio before change:  [-0.43815656]
curr_Stock_Price:  96.12612999861472
curr_Factors:  [9.61261300e+01 4.08926278e-02]
mat_Sqrt:  [[ 1.94385546e+01  0.00000000e+00]
 [-8.08877027e-03  1.85337010e-02]]
grads:  [ 0.08083804 59.79411666]
Stock Position:  0.08083804230167589
Bond Position:  [-8.20880473]


portfolio before change:  [-0.28982589]
curr_Stock_Price:  97.97373584349747
curr_Factors:  [9.79737358e+01 3.91114020e-02]
mat_Sqrt:  [[ 1.93758766e+01  0.00000000e+00]
 [-7.91064113e-03  1.81255559e-02]]
grads:  [7.29427153e-03 1.80841494e+01]
Stock Position:  0.007294271525155118
Bond Position:  [-1.00447292]


portfolio before change:  [-0.28801896]
curr_Stock_Price:  98.23866872027985
curr_Factors:  [9.82386687e+01 4.03869669e-02]
mat_Sqrt:  [[ 1.97425428e+01  0.00000000e+00]
 [-8.03860355e-03  1.84187546e-02]]
grads:  [0.01248069 6.13646405]
Stock Position:  0.012480685530536183
Bond Position:  [-1.5141049]


portfolio before change:  [-0.27452266]
curr_Stock_Price:  99.33520973613625
curr_Factors:  [9.93352097e+01 3.94958590e-02]
mat_Sqrt:  [[ 1.97414476e+01  0.00000000e+00]
 [-7.94942604e-03  1.82144233e-02]]
grads:  [-0.00582976  0.01659404]
Stock Position:  -0.005829755040413201
Bond Position:  [0.30457728]


portfolio before change:  [-0.27391169]
curr_Stock_Price:  99.23693896945768
curr_Factors:  [9.92369390e+01 3.91701433e-02]
mat_Sqrt:  [[ 1.96404277e+01  0.00000000e+00]
 [-7.91657939e-03  1.81391622e-02]]
grads:  [-1.65357967e-03 -7.37873030e+00]
Stock Position:  -0.0016535796727183806
Bond Position:  [-0.1098155]


portfolio before change:  [-0.27285878]
curr_Stock_Price:  98.59189425166043
curr_Factors:  [9.85918943e+01 3.99030978e-02]
mat_Sqrt:  [[ 1.96944799e+01  0.00000000e+00]
 [-7.99030391e-03  1.83080862e-02]]
grads:  [-0.00656777 -1.53218664]
Stock Position:  -0.006567773738411492
Bond Position:  [0.37467047]


portfolio before change:  [-0.27524993]
curr_Stock_Price:  98.96309854167768
curr_Factors:  [9.89630985e+01 4.00334262e-02]
mat_Sqrt:  [[ 1.98008879e+01  0.00000000e+00]
 [-8.00334192e-03  1.83379601e-02]]
grads:  [-0.00281401  0.89174176]
Stock Position:  -0.002814014398850263
Bond Position:  [0.00323365]


portfolio before change:  [-0.28118133]
curr_Stock_Price:  101.07104997034853
curr_Factors:  [1.01071050e+02 3.93226299e-02]
mat_Sqrt:  [[ 2.00423229e+01  0.00000000e+00]
 [-7.93197377e-03  1.81744351e-02]]
grads:  [ 0.02341163 12.57530481]
Stock Position:  0.023411632030860607
Bond Position:  [-2.64741956]


portfolio before change:  [-0.30165904]
curr_Stock_Price:  100.21050522773676
curr_Factors:  [1.00210505e+02 3.96731639e-02]
mat_Sqrt:  [[ 1.99600521e+01  0.00000000e+00]
 [-7.96724935e-03  1.82552616e-02]]
grads:  [ 9.42116316e-04 -1.42571945e+01]
Stock Position:  0.0009421163156198201
Bond Position:  [-0.39606899]


portfolio before change:  [-0.30201994]
curr_Stock_Price:  99.87997720441878
curr_Factors:  [9.98799772e+01 4.05677507e-02]
mat_Sqrt:  [[ 2.01172632e+01  0.00000000e+00]
 [-8.05657502e-03  1.84599324e-02]]
grads:  [3.88442590e-03 4.78962262e+00]
Stock Position:  0.0038844258987526382
Bond Position:  [-0.68999631]


portfolio before change:  [-0.30372563]
curr_Stock_Price:  99.46307402085482
curr_Factors:  [9.94630740e+01 4.00618125e-02]
mat_Sqrt:  [[ 1.99079790e+01  0.00000000e+00]
 [-8.00617886e-03  1.83444603e-02]]
grads:  [-8.17599253e-04 -1.96939594e+00]
Stock Position:  -0.000817599253337242
Bond Position:  [-0.22240469]


portfolio before change:  [-0.30248216]
curr_Stock_Price:  97.90819063861872
curr_Factors:  [9.79081906e+01 4.09819679e-02]
mat_Sqrt:  [[ 1.98205376e+01  0.00000000e+00]
 [-8.09760141e-03  1.85539357e-02]]
grads:  [-0.00519854 -3.12835011]
Stock Position:  -0.005198538000980947
Bond Position:  [0.20649729]


portfolio before change:  [-0.30067392]
curr_Stock_Price:  97.56531985057144
curr_Factors:  [9.75653199e+01 4.19843580e-02]
mat_Sqrt:  [[ 1.99912169e+01  0.00000000e+00]
 [-8.19603397e-03  1.87794730e-02]]
grads:  [-0.01224623  5.38765787]
Stock Position:  -0.012246229732558253
Bond Position:  [0.8941334]


portfolio before change:  [-0.25641535]
curr_Stock_Price:  93.96039019648157
curr_Factors:  [9.39603902e+01 4.25104454e-02]
mat_Sqrt:  [[ 1.93728109e+01  0.00000000e+00]
 [-8.24722454e-03  1.88967654e-02]]
grads:  [4.84548577e-03 8.01270280e+00]
Stock Position:  0.004845485773186331
Bond Position:  [-0.71169908]


portfolio before change:  [-0.25893817]
curr_Stock_Price:  93.45809801278001
curr_Factors:  [9.34580980e+01 4.36032621e-02]
mat_Sqrt:  [[ 1.95153538e+01  0.00000000e+00]
 [-8.35255766e-03  1.91381139e-02]]
grads:  [ 0.0930383  11.74423352]
Stock Position:  0.0930383030871551
Bond Position:  [-8.95412101]


portfolio before change:  [-0.21761736]
curr_Stock_Price:  93.9142557498757
curr_Factors:  [9.39142557e+01 4.37485027e-02]
mat_Sqrt:  [[ 1.96432398e+01  0.00000000e+00]
 [-8.36645709e-03  1.91699615e-02]]
grads:  [1.05517208e-02 2.29526290e+01]
Stock Position:  0.010551720818250544
Bond Position:  [-1.20857437]


portfolio before change:  [-0.20920832]
curr_Stock_Price:  94.72550893870786
curr_Factors:  [9.47255089e+01 4.29975957e-02]
mat_Sqrt:  [[ 1.96421505e+01  0.00000000e+00]
 [-8.29434465e-03  1.90047311e-02]]
grads:  [-3.87011680e-03  8.27396014e+00]
Stock Position:  -0.0038701168013574997
Bond Position:  [0.15739046]


portfolio before change:  [-0.21334204]
curr_Stock_Price:  95.7987033295164
curr_Factors:  [9.57987033e+01 4.25552918e-02]
mat_Sqrt:  [[ 1.97622513e+01  0.00000000e+00]
 [-8.25157360e-03  1.89067303e-02]]
grads:  [-6.22833595e-03  8.02008751e+00]
Stock Position:  -0.006228335952196072
Bond Position:  [0.38332447]


portfolio before change:  [-0.20933542]
curr_Stock_Price:  95.16310861713839
curr_Factors:  [9.51631086e+01 4.12069301e-02]
mat_Sqrt:  [[ 1.93176259e+01  0.00000000e+00]
 [-8.11979606e-03  1.86047900e-02]]
grads:  [ 0.00894155 -4.08869688]
Stock Position:  0.008941546711973034
Bond Position:  [-1.0602408]


portfolio before change:  [-0.20137936]
curr_Stock_Price:  96.06771698570209
curr_Factors:  [9.60677170e+01 4.13163508e-02]
mat_Sqrt:  [[ 1.95271314e+01  0.00000000e+00]
 [-8.13056955e-03  1.86294752e-02]]
grads:  [-1.51858633e-02 -2.42107779e+01]
Stock Position:  -0.015185863302068746
Bond Position:  [1.25749186]


portfolio before change:  [-0.20433601]
curr_Stock_Price:  96.27276570440081
curr_Factors:  [9.62727657e+01 4.12439713e-02]
mat_Sqrt:  [[ 1.95516622e+01  0.00000000e+00]
 [-8.12344472e-03  1.86131502e-02]]
grads:  [0.00476069 3.10522483]
Stock Position:  0.004760685533902748
Bond Position:  [-0.66266037]


portfolio before change:  [-0.1965509]
curr_Stock_Price:  97.92545612099364
curr_Factors:  [9.79254561e+01 4.02261732e-02]
mat_Sqrt:  [[ 1.96403835e+01  0.00000000e+00]
 [-8.02258544e-03  1.83820525e-02]]
grads:  [0.01108367 0.12429757]
Stock Position:  0.011083669067129709
Bond Position:  [-1.28192425]


portfolio before change:  [-0.21121112]
curr_Stock_Price:  96.61722808051513
curr_Factors:  [9.66172281e+01 4.11795371e-02]
mat_Sqrt:  [[ 1.96062847e+01  0.00000000e+00]
 [-8.11709673e-03  1.85986051e-02]]
grads:  [ -0.03130286 -10.5644727 ]
Stock Position:  -0.03130286106107901
Bond Position:  [2.81318455]


portfolio before change:  [-0.19524452]
curr_Stock_Price:  96.11839408045897
curr_Factors:  [9.61183941e+01 4.25931409e-02]
mat_Sqrt:  [[ 1.98370158e+01  0.00000000e+00]
 [-8.25524230e-03  1.89151364e-02]]
grads:  [-0.00032881  0.03226707]
Stock Position:  -0.00032881384427109765
Bond Position:  [-0.16363946]


portfolio before change:  [-0.19519847]
curr_Stock_Price:  95.91614372534495
curr_Factors:  [9.59161437e+01 4.33126907e-02]
mat_Sqrt:  [[ 1.99617812e+01  0.00000000e+00]
 [-8.32468048e-03  1.90742392e-02]]
grads:  [-1.82019122e-03  3.30760723e+00]
Stock Position:  -0.0018201912225681608
Bond Position:  [-0.02061275]


portfolio before change:  [-0.19748532]
curr_Stock_Price:  97.17110289921689
curr_Factors:  [9.71711029e+01 4.36712821e-02]
mat_Sqrt:  [[ 2.03065013e+01  0.00000000e+00]
 [-8.35907000e-03  1.91530355e-02]]
grads:  [8.96306967e-03 9.98643330e+00]
Stock Position:  0.008963069671358183
Bond Position:  [-1.06843668]


portfolio before change:  [-0.18576891]
curr_Stock_Price:  98.49319101431702
curr_Factors:  [9.84931910e+01 4.44175603e-02]
mat_Sqrt:  [[ 2.07579068e+01  0.00000000e+00]
 [-8.43018959e-03  1.93159910e-02]]
grads:  [5.37627896e-04 6.98346273e-01]
Stock Position:  0.000537627896337864
Bond Position:  [-0.2387216]


portfolio before change:  [-0.18549339]
curr_Stock_Price:  99.06118003384444
curr_Factors:  [9.90611800e+01 4.34083989e-02]
mat_Sqrt:  [[ 2.06390822e+01  0.00000000e+00]
 [-8.33387294e-03  1.90953018e-02]]
grads:  [6.96073479e-04 2.53559309e+00]
Stock Position:  0.0006960734790172104
Bond Position:  [-0.25444725]


portfolio before change:  [-0.18475056]
curr_Stock_Price:  100.17403668646178
curr_Factors:  [1.00174037e+02 4.29128290e-02]
mat_Sqrt:  [[ 2.07514643e+01  0.00000000e+00]
 [-8.28616476e-03  1.89859886e-02]]
grads:  [-0.00736348  5.00920574]
Stock Position:  -0.007363482969811089
Bond Position:  [0.55287925]


portfolio before change:  [-0.17168482]
curr_Stock_Price:  98.4090260143425
curr_Factors:  [9.84090260e+01 4.19960844e-02]
mat_Sqrt:  [[ 2.01669088e+01  0.00000000e+00]
 [-8.19717848e-03  1.87820954e-02]]
grads:  [-3.78671193e-03 -4.75663052e+00]
Stock Position:  -0.003786711927576195
Bond Position:  [0.20096181]


portfolio before change:  [-0.17556335]
curr_Stock_Price:  99.43990781031195
curr_Factors:  [9.94399078e+01 4.05692579e-02]
mat_Sqrt:  [[ 2.00289990e+01  0.00000000e+00]
 [-8.05672469e-03  1.84602754e-02]]
grads:  [-0.00340387 -2.33342451]
Stock Position:  -0.0034038725152853782
Bond Position:  [0.16291741]


portfolio before change:  [-0.17910316]
curr_Stock_Price:  100.4858253354031
curr_Factors:  [1.00485825e+02 4.07554024e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.17910316]
Stock Price:  99.3597842067515
PL:  [-0.17910316]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.17029296e+00  2.93481005e-01]
 [-1.84196626e-01 -4.99395291e-02]
 [ 7.72875746e-02 -3.22910674e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.01054968e-01 -1.04634222e-01]
 [-1.49187498e-01 -4.10587247e-02]
 [ 1.12134405e-01 -1.88958421e-02]
 [ 2.77755941e-01  4.62664270e-01]
 [-2.91841557e-02  2.54498964e-01]
 [ 1.89062888e-01  7.83790151e-02]
 [-9.48035385e-02  7.33499875e-03]
 [ 2.79108874e-02 -1.35753012e-01]
 [-9.53456553e-02 -2.36963799e-02]
 [-4.71171297e-02 -3.48143516e-02]
 [ 5.10549521e-01  3.34462018e-01]
 [ 1.31080081e-01  5.13988846e-02]
 [ 4.09965689e-02  1.20574864e-01]
 [ 1.60659994e-01  7.85053742e-02]
 [-7.27953434e-02 -5.37706538e-02]
 [-2.16335727e-01  5.23535238e-02]
 [ 1.76689275e-01 -4.46819916e-02]
 [ 6.49188965e-01 -1.28870463e-01]
 [ 2.98634086e-02 -3.77395098e-01]
 [ 2.58278006e-02  1.84490852e-02]
 [ 3.26400715e-01 -2.26166067e-01]
 [ 1.17893186e-01 -8.78106230e-02]
 [-9.93022731e-02 -5.53329876e-02]
 [-1.93477689e-02  1.83526123e-01]
 [-4.38207248e-02  1.96411182e-01]
 [-6.37711263e-01 -6.53609839e-02]
 [-1.65045379e-01 -5.40121526e-02]
 [ 5.51180788e-02 -3.00573809e-02]
 [-2.81468906e-01  1.15792831e-01]
 [ 6.79233047e-02  6.20321022e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.72298937e-01  4.79038946e-02]
 [-2.67660991e-02 -1.83466758e-01]
 [-1.07423019e-02 -6.40343116e-02]
 [ 2.00690985e-01 -1.32065788e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.36268648]
curr_Stock_Price:  100.67949133540846
curr_Factors:  [1.00679491e+02 3.92320652e-02]
mat_Sqrt:  [[ 1.99416733e+01  0.00000000e+00]
 [-7.92283437e-03  1.81534941e-02]]
grads:  [ 0.06510881 16.16664007]
Stock Position:  0.06510880736177009
Bond Position:  [0.80756488]


portfolio before change:  [7.40153789]
curr_Stock_Price:  101.27465592125313
curr_Factors:  [1.01274656e+02 3.89554815e-02]
mat_Sqrt:  [[ 1.99887237e+01  0.00000000e+00]
 [-7.89485721e-03  1.80893904e-02]]
grads:  [-0.01030541 -2.76070824]
Stock Position:  -0.01030541149482725
Bond Position:  [8.4452149]


portfolio before change:  [7.40957972]
curr_Stock_Price:  100.59674904885533
curr_Factors:  [1.00596749e+02 3.75298986e-02]
mat_Sqrt:  [[ 1.94882410e+01  0.00000000e+00]
 [-7.74905399e-03  1.77553132e-02]]
grads:  [ 0.0032427  -1.81867067]
Stock Position:  0.003242704015558447
Bond Position:  [7.08337424]


portfolio before change:  [7.41084144]
curr_Stock_Price:  100.71277548151394
curr_Factors:  [1.00712775e+02 3.54457819e-02]
mat_Sqrt:  [[ 1.89612448e+01  0.00000000e+00]
 [-7.53082008e-03  1.72552765e-02]]
grads:  [-8.59720295e-04 -8.77336345e+00]
Stock Position:  -0.0008597202947910815
Bond Position:  [7.49742625]


portfolio before change:  [7.41153398]
curr_Stock_Price:  100.99739406844603
curr_Factors:  [1.00997394e+02 3.48467770e-02]
mat_Sqrt:  [[ 1.88534779e+01  0.00000000e+00]
 [-7.46691658e-03  1.71088552e-02]]
grads:  [-0.00778218 -6.11579328]
Stock Position:  -0.007782176175550306
Bond Position:  [8.19751349]


portfolio before change:  [7.42223974]
curr_Stock_Price:  99.7533967063929
curr_Factors:  [9.97533967e+01 3.56564677e-02]
mat_Sqrt:  [[ 1.88363544e+01  0.00000000e+00]
 [-7.55316810e-03  1.73064823e-02]]
grads:  [-0.00887151 -2.37244773]
Stock Position:  -0.008871514707371686
Bond Position:  [8.30720347]


portfolio before change:  [7.41471495]
curr_Stock_Price:  100.71864949790557
curr_Factors:  [1.00718649e+02 3.40754456e-02]
mat_Sqrt:  [[ 1.85921950e+01  0.00000000e+00]
 [-7.38381425e-03  1.69184439e-02]]
grads:  [ 0.0055877  -1.11687826]
Stock Position:  0.005587698696186521
Bond Position:  [6.85192949]


portfolio before change:  [7.41388647]
curr_Stock_Price:  100.41709003667638
curr_Factors:  [1.00417090e+02 3.44114717e-02]
mat_Sqrt:  [[ 1.86277009e+01  0.00000000e+00]
 [-7.42013172e-03  1.70016576e-02]]
grads:  [2.57508527e-02 2.72128918e+01]
Stock Position:  0.02575085274948484
Bond Position:  [4.82806077]


portfolio before change:  [7.3721099]
curr_Stock_Price:  98.77131476363095
curr_Factors:  [9.87713148e+01 3.54719636e-02]
mat_Sqrt:  [[ 1.86025915e+01  0.00000000e+00]
 [-7.53360085e-03  1.72616481e-02]]
grads:  [4.40198336e-03 1.47436075e+01]
Stock Position:  0.004401983359427511
Bond Position:  [6.93732022]


portfolio before change:  [7.37290783]
curr_Stock_Price:  98.75557285097592
curr_Factors:  [9.87555729e+01 3.45873919e-02]
mat_Sqrt:  [[ 1.83662512e+01  0.00000000e+00]
 [-7.43907434e-03  1.70450606e-02]]
grads:  [0.01215655 4.59834181]
Stock Position:  0.012156552372647955
Bond Position:  [6.17238053]


portfolio before change:  [7.37079144]
curr_Stock_Price:  98.51800733917305
curr_Factors:  [9.85180073e+01 3.41327049e-02]
mat_Sqrt:  [[ 1.82012398e+01  0.00000000e+00]
 [-7.39001541e-03  1.69326525e-02]]
grads:  [-0.00503275  0.43318663]
Stock Position:  -0.005032749610665311
Bond Position:  [7.86660791]


portfolio before change:  [7.36518553]
curr_Stock_Price:  99.8272916018418
curr_Factors:  [9.98272916e+01 3.30008257e-02]
mat_Sqrt:  [[ 1.81347550e+01  0.00000000e+00]
 [-7.26645175e-03  1.66495326e-02]]
grads:  [-1.72798499e-03 -8.15356295e+00]
Stock Position:  -0.0017279849908283542
Bond Position:  [7.53768559]


portfolio before change:  [7.36477987]
curr_Stock_Price:  100.60735074683572
curr_Factors:  [1.00607351e+02 3.21485254e-02]
mat_Sqrt:  [[ 1.80389079e+01  0.00000000e+00]
 [-7.17200395e-03  1.64331255e-02]]
grads:  [-0.00585887 -1.44198861]
Stock Position:  -0.005858869272093615
Bond Position:  [7.95422519]


portfolio before change:  [7.37076712]
curr_Stock_Price:  99.75515425344952
curr_Factors:  [9.97551543e+01 3.27506442e-02]
mat_Sqrt:  [[ 1.80528290e+01  0.00000000e+00]
 [-7.23885562e-03  1.65863019e-02]]
grads:  [-0.00345161 -2.09898215]
Stock Position:  -0.0034516118509065334
Bond Position:  [7.71508319]


portfolio before change:  [7.37628395]
curr_Stock_Price:  98.4362379476862
curr_Factors:  [9.84362379e+01 3.32585588e-02]
mat_Sqrt:  [[ 1.79517470e+01  0.00000000e+00]
 [-7.29477169e-03  1.67144217e-02]]
grads:  [ 0.03657141 20.01038523]
Stock Position:  0.03657141064562497
Bond Position:  [3.77633187]


portfolio before change:  [7.3253742]
curr_Stock_Price:  97.03126564998307
curr_Factors:  [9.70312656e+01 3.47702080e-02]
mat_Sqrt:  [[ 1.80931982e+01  0.00000000e+00]
 [-7.45870852e-03  1.70900482e-02]]
grads:  [0.00848454 3.00753304]
Stock Position:  0.00848453612242478
Bond Position:  [6.50210893]


portfolio before change:  [7.31980973]
curr_Stock_Price:  96.27962926107229
curr_Factors:  [9.62796293e+01 3.54066219e-02]
mat_Sqrt:  [[ 1.81165983e+01  0.00000000e+00]
 [-7.52665895e-03  1.72457422e-02]]
grads:  [5.16762319e-03 6.99157289e+00]
Stock Position:  0.005167623185027285
Bond Position:  [6.82227289]


portfolio before change:  [7.32007289]
curr_Stock_Price:  96.16551871271982
curr_Factors:  [9.61655187e+01 3.49432577e-02]
mat_Sqrt:  [[ 1.79763317e+01  0.00000000e+00]
 [-7.47724630e-03  1.71325236e-02]]
grads:  [0.01084329 4.5822423 ]
Stock Position:  0.010843288313429247
Bond Position:  [6.27732244]


portfolio before change:  [7.3408739]
curr_Stock_Price:  98.01148077452183
curr_Factors:  [9.80114808e+01 3.34185995e-02]
mat_Sqrt:  [[ 1.79172385e+01  0.00000000e+00]
 [-7.31230191e-03  1.67545885e-02]]
grads:  [-0.00537263 -3.20930912]
Stock Position:  -0.005372634898566984
Bond Position:  [7.8674538]


portfolio before change:  [7.34104439]
curr_Stock_Price:  98.16280456823232
curr_Factors:  [9.81628046e+01 3.34251261e-02]
mat_Sqrt:  [[ 1.79466538e+01  0.00000000e+00]
 [-7.31301592e-03  1.67562245e-02]]
grads:  [-0.01078122  3.12442244]
Stock Position:  -0.010781217408698376
Bond Position:  [8.39935893]


portfolio before change:  [7.33070741]
curr_Stock_Price:  99.2189898513315
curr_Factors:  [9.92189899e+01 3.35267021e-02]
mat_Sqrt:  [[ 1.81672929e+01  0.00000000e+00]
 [-7.32411929e-03  1.67816655e-02]]
grads:  [ 0.00865228 -2.6625481 ]
Stock Position:  0.008652277247796658
Bond Position:  [6.4722372]


portfolio before change:  [7.34830902]
curr_Stock_Price:  101.1598114425014
curr_Factors:  [1.01159811e+02 3.38745070e-02]
mat_Sqrt:  [[ 1.86184920e+01  0.00000000e+00]
 [-7.36201135e-03  1.68684871e-02]]
grads:  [ 0.03184712 -7.63971672]
Stock Position:  0.031847116486344515
Bond Position:  [4.12666072]


portfolio before change:  [7.35560412]
curr_Stock_Price:  101.37267977350866
curr_Factors:  [1.01372680e+02 3.42761199e-02]
mat_Sqrt:  [[ 1.87679464e+01  0.00000000e+00]
 [-7.40552442e-03  1.69681881e-02]]
grads:  [-7.18487322e-03 -2.22413316e+01]
Stock Position:  -0.0071848732216092245
Bond Position:  [8.08395398]


portfolio before change:  [7.36088644]
curr_Stock_Price:  100.77813042703916
curr_Factors:  [1.00778130e+02 3.38863379e-02]
mat_Sqrt:  [[ 1.85514823e+01  0.00000000e+00]
 [-7.36329686e-03  1.68714326e-02]]
grads:  [0.00182625 1.09351029]
Stock Position:  0.0018262498357863566
Bond Position:  [7.1768404]


portfolio before change:  [7.36415115]
curr_Stock_Price:  102.07452627172074
curr_Factors:  [1.02074526e+02 3.25612114e-02]
mat_Sqrt:  [[ 1.84190680e+01  0.00000000e+00]
 [-7.21789015e-03  1.65382640e-02]]
grads:  [ 1.23618498e-02 -1.36753209e+01]
Stock Position:  0.012361849767793299
Bond Position:  [6.10232119]


portfolio before change:  [7.35790418]
curr_Stock_Price:  101.50747467061237
curr_Factors:  [1.01507475e+02 3.31178352e-02]
mat_Sqrt:  [[ 1.84726411e+01  0.00000000e+00]
 [-7.27932251e-03  1.66790232e-02]]
grads:  [ 4.30742347e-03 -5.26473415e+00]
Stock Position:  0.00430742347270723
Bond Position:  [6.9206685]


portfolio before change:  [7.35837892]
curr_Stock_Price:  101.4168416577363
curr_Factors:  [1.01416842e+02 3.27884299e-02]
mat_Sqrt:  [[ 1.83641314e+01  0.00000000e+00]
 [-7.24303030e-03  1.65958673e-02]]
grads:  [-0.00672243 -3.33414257]
Stock Position:  -0.006722428953144076
Bond Position:  [8.04014643]


portfolio before change:  [7.3485391]
curr_Stock_Price:  103.03008401715192
curr_Factors:  [1.03030084e+02 3.24754042e-02]
mat_Sqrt:  [[ 1.85669829e+01  0.00000000e+00]
 [-7.20837338e-03  1.65164583e-02]]
grads:  [3.27191544e-03 1.11117117e+01]
Stock Position:  0.0032719154377810447
Bond Position:  [7.01143337]


portfolio before change:  [7.34920899]
curr_Stock_Price:  102.96694312557203
curr_Factors:  [1.02966943e+02 3.21536056e-02]
mat_Sqrt:  [[ 1.84634417e+01  0.00000000e+00]
 [-7.17257059e-03  1.64344238e-02]]
grads:  [2.26935711e-03 1.19512058e+01]
Stock Position:  0.0022693571116374376
Bond Position:  [7.11554022]


portfolio before change:  [7.34961377]
curr_Stock_Price:  102.75335259074714
curr_Factors:  [1.02753353e+02 3.15850169e-02]
mat_Sqrt:  [[ 1.82615046e+01  0.00000000e+00]
 [-7.10886960e-03  1.62884665e-02]]
grads:  [-0.03648315 -4.01271561]
Stock Position:  -0.03648314578506856
Bond Position:  [11.09837931]


portfolio before change:  [7.36815128]
curr_Stock_Price:  102.2832692317311
curr_Factors:  [1.02283269e+02 3.24237874e-02]
mat_Sqrt:  [[ 1.84177457e+01  0.00000000e+00]
 [-7.20264256e-03  1.65033274e-02]]
grads:  [-0.01024111 -3.2728038 ]
Stock Position:  -0.010241113006248987
Bond Position:  [8.41564579]


portfolio before change:  [7.36282783]
curr_Stock_Price:  102.90580603015479
curr_Factors:  [1.02905806e+02 3.27315979e-02]
mat_Sqrt:  [[ 1.86175909e+01  0.00000000e+00]
 [-7.23675042e-03  1.65814783e-02]]
grads:  [ 0.00225593 -1.81270815]
Stock Position:  0.0022559289535610634
Bond Position:  [7.13067964]


portfolio before change:  [7.36224276]
curr_Stock_Price:  102.25132520045187
curr_Factors:  [1.02251325e+02 3.41749585e-02]
mat_Sqrt:  [[ 1.89026609e+01  0.00000000e+00]
 [-7.39458813e-03  1.69431299e-02]]
grads:  [-0.01221695  6.83420548]
Stock Position:  -0.012216945126479011
Bond Position:  [8.61144159]


portfolio before change:  [7.36559987]
curr_Stock_Price:  102.06464875181851
curr_Factors:  [1.02064649e+02 3.47843529e-02]
mat_Sqrt:  [[ 1.90356324e+01  0.00000000e+00]
 [-7.46022551e-03  1.70935240e-02]]
grads:  [0.00499045 3.62898265]
Stock Position:  0.004990447999735066
Bond Position:  [6.85625155]


portfolio before change:  [7.36610013]
curr_Stock_Price:  101.99314756700178
curr_Factors:  [1.01993148e+02 3.53837516e-02]
mat_Sqrt:  [[ 1.91854917e+01  0.00000000e+00]
 [-7.52422770e-03  1.72401715e-02]]
grads:  [-0.00493433  4.71718893]
Stock Position:  -0.004934333319346258
Bond Position:  [7.86936832]


portfolio before change:  [7.36489399]
curr_Stock_Price:  102.43695034964861
curr_Factors:  [1.0243695e+02 3.6909757e-02]
mat_Sqrt:  [[ 1.96800969e+01  0.00000000e+00]
 [-7.68476487e-03  1.76080084e-02]]
grads:  [-0.01277392  2.72057427]
Stock Position:  -0.012773918972007846
Bond Position:  [8.6734153]


portfolio before change:  [7.34882708]
curr_Stock_Price:  103.7796207331068
curr_Factors:  [1.03779621e+02 3.66635166e-02]
mat_Sqrt:  [[ 1.98714308e+01  0.00000000e+00]
 [-7.65908784e-03  1.75491749e-02]]
grads:  [-5.37644008e-03 -1.04544378e+01]
Stock Position:  -0.005376440076698099
Bond Position:  [7.90679199]


portfolio before change:  [7.34346327]
curr_Stock_Price:  104.96111204341871
curr_Factors:  [1.04961112e+02 3.65156103e-02]
mat_Sqrt:  [[ 2.00570799e+01  0.00000000e+00]
 [-7.64362325e-03  1.75137411e-02]]
grads:  [-1.92895311e-03 -3.65623263e+00]
Stock Position:  -0.0019289531086905008
Bond Position:  [7.54592833]


portfolio before change:  [7.34149404]
curr_Stock_Price:  106.47101098837776
curr_Factors:  [1.06471011e+02 3.51244547e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.34149404]
Stock Price:  106.41560272480118
PL:  [0.92589132]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.46207722e+00  3.62501544e-01]
 [ 1.28584036e+00  5.07184974e-02]
 [-6.33585385e-02  1.08977636e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.12157420e-01  8.96781763e-01]
 [-9.64976479e-02 -9.75380060e-02]
 [ 8.77088719e-02  9.56899944e-02]
 [ 7.28125956e-01  7.11175391e-01]
 [-1.65136602e-02  2.88167911e-01]
 [ 1.22298784e-01 -3.25810392e-02]
 [-7.11611258e-02 -1.26532365e-02]
 [-1.04537691e-02 -1.36315187e-01]
 [-1.14301615e-01 -2.68827256e-02]
 [-4.76495048e-02 -3.44224446e-02]
 [ 4.55741087e-01  2.90124386e-01]
 [ 1.29996214e-01  4.01073825e-02]
 [ 3.95520741e-02  1.02054323e-01]
 [ 2.31544330e-03 -6.42492183e-02]
 [-6.96837537e-02 -5.10970326e-02]
 [-1.46520183e-01  6.43067734e-03]
 [ 1.71725413e-01 -3.65797972e-02]
 [ 9.66754660e-01  7.02517923e-02]
 [ 2.57529294e-02 -1.74938959e-01]
 [ 2.28434510e-02  2.00228699e-02]
 [ 1.77979033e-01 -9.46258598e-02]
 [ 1.66739922e-01 -9.04895050e-02]
 [-1.16139650e-01 -4.82141665e-02]
 [ 5.49734868e-02  2.58628535e-01]
 [-2.63777326e-02  1.86346931e-01]
 [-6.08191472e-01 -7.51198516e-02]
 [-1.68422573e-01 -6.36577513e-02]
 [ 8.82895367e-03 -6.06992718e-02]
 [-1.02359697e-01  1.59173947e-01]
 [ 1.94781228e-02  2.12523643e-02]
 [-5.92758223e-02  1.00508120e-01]
 [-1.88220435e-01  9.82558609e-02]
 [-3.05652403e-02 -1.49853598e-01]
 [ 7.69120394e-03 -2.35821789e-02]
 [-5.25646529e-02 -6.11481252e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.85334894]
curr_Stock_Price:  98.76111817382078
curr_Factors:  [9.87611182e+01 4.05377014e-02]
mat_Sqrt:  [[ 1.98845404e+01  0.00000000e+00]
 [-8.05359064e-03  1.84530944e-02]]
grads:  [ 0.0814847  19.64448544]
Stock Position:  0.08148470253806914
Bond Position:  [-13.90086928]


portfolio before change:  [-5.93974393]
curr_Stock_Price:  97.72218361144785
curr_Factors:  [9.77221836e+01 4.17499482e-02]
mat_Sqrt:  [[ 1.99673823e+01  0.00000000e+00]
 [-8.17312162e-03  1.87269743e-02]]
grads:  [0.06550562 2.70831244]
Stock Position:  0.0655056184782472
Bond Position:  [-12.34109601]


portfolio before change:  [-5.96451149]
curr_Stock_Price:  97.36763651301679
curr_Factors:  [9.73676365e+01 4.19824464e-02]
mat_Sqrt:  [[ 1.99502572e+01  0.00000000e+00]
 [-8.19584738e-03  1.87790455e-02]]
grads:  [-7.91809286e-04  5.80315096e+00]
Stock Position:  -0.00079180928557875
Bond Position:  [-5.88741489]


portfolio before change:  [-5.96524549]
curr_Stock_Price:  97.36514874678394
curr_Factors:  [9.73651487e+01 4.26228212e-02]
mat_Sqrt:  [[ 2.01013223e+01  0.00000000e+00]
 [-8.25811806e-03  1.89217256e-02]]
grads:  [-8.10959930e-04 -8.00068746e+00]
Stock Position:  -0.0008109599302144474
Bond Position:  [-5.88628626]


portfolio before change:  [-5.96598277]
curr_Stock_Price:  97.36692447200042
curr_Factors:  [9.73669245e+01 4.11161648e-02]
mat_Sqrt:  [[ 1.97432094e+01  0.00000000e+00]
 [-8.11084852e-03  1.85842887e-02]]
grads:  [1.41431022e-02 4.82548339e+01]
Stock Position:  0.014143102227451833
Bond Position:  [-7.34305313]


portfolio before change:  [-5.94141808]
curr_Stock_Price:  99.16869530927289
curr_Factors:  [9.91686953e+01 4.10140626e-02]
mat_Sqrt:  [[ 2.00835737e+01  0.00000000e+00]
 [-8.10077158e-03  1.85611995e-02]]
grads:  [-0.0069244  -5.25494089]
Stock Position:  -0.00692440128944617
Bond Position:  [-5.25473423]


portfolio before change:  [-5.94323034]
curr_Stock_Price:  99.33555196101838
curr_Factors:  [9.93355520e+01 4.19396344e-02]
mat_Sqrt:  [[ 2.03430951e+01  0.00000000e+00]
 [-8.19166741e-03  1.87694680e-02]]
grads:  [0.00636439 5.09817297]
Stock Position:  0.006364390897884054
Bond Position:  [-6.57544062]


portfolio before change:  [-5.94823286]
curr_Stock_Price:  98.67868793783992
curr_Factors:  [9.86786879e+01 4.27244456e-02]
mat_Sqrt:  [[ 2.03967787e+01  0.00000000e+00]
 [-8.26795700e-03  1.89442694e-02]]
grads:  [ 0.05091531 37.54039684]
Stock Position:  0.05091531155440389
Bond Position:  [-10.972489]


portfolio before change:  [-5.96401741]
curr_Stock_Price:  98.39561195912735
curr_Factors:  [9.83956120e+01 4.30053804e-02]
mat_Sqrt:  [[ 2.04050248e+01  0.00000000e+00]
 [-8.29509545e-03  1.90064514e-02]]
grads:  [5.35422660e-03 1.51615841e+01]
Stock Position:  0.005354226600568846
Bond Position:  [-6.49084981]


portfolio before change:  [-5.95148838]
curr_Stock_Price:  100.88718254748959
curr_Factors:  [1.00887183e+02 4.26580724e-02]
mat_Sqrt:  [[ 2.08370679e+01  0.00000000e+00]
 [-8.26153229e-03  1.89295485e-02]]
grads:  [ 0.00518687 -1.7211736 ]
Stock Position:  0.005186874332396566
Bond Position:  [-6.47477752]


portfolio before change:  [-5.95007333]
curr_Stock_Price:  101.3160436449527
curr_Factors:  [1.01316044e+02 4.28333939e-02]
mat_Sqrt:  [[ 2.09686015e+01  0.00000000e+00]
 [-8.27849203e-03  1.89684082e-02]]
grads:  [-0.00365706 -0.66706897]
Stock Position:  -0.003657060818441585
Bond Position:  [-5.5795544]


portfolio before change:  [-5.95146756]
curr_Stock_Price:  101.50656258796327
curr_Factors:  [1.01506563e+02 4.20010664e-02]
mat_Sqrt:  [[ 2.08029191e+01  0.00000000e+00]
 [-8.19766469e-03  1.87832095e-02]]
grads:  [-3.36234516e-03 -7.25728942e+00]
Stock Position:  -0.0033623451569673207
Bond Position:  [-5.61016746]


portfolio before change:  [-5.94754936]
curr_Stock_Price:  100.1326659511039
curr_Factors:  [1.00132666e+02 4.19360419e-02]
mat_Sqrt:  [[ 2.05054591e+01  0.00000000e+00]
 [-8.19131656e-03  1.87686641e-02]]
grads:  [-0.00614637 -1.43231961]
Stock Position:  -0.006146372910804836
Bond Position:  [-5.33209665]


portfolio before change:  [-5.94528072]
curr_Stock_Price:  99.65511780509706
curr_Factors:  [9.96551178e+01 4.09669767e-02]
mat_Sqrt:  [[ 2.01704954e+01  0.00000000e+00]
 [-8.09612022e-03  1.85505419e-02]]
grads:  [-0.00310715 -1.85560318]
Stock Position:  -0.003107146857524684
Bond Position:  [-5.63563764]


portfolio before change:  [-5.94647186]
curr_Stock_Price:  99.81173568544209
curr_Factors:  [9.98117357e+01 4.22328244e-02]
mat_Sqrt:  [[ 2.05119369e+01  0.00000000e+00]
 [-8.22025055e-03  1.88349602e-02]]
grads:  [ 0.02839136 15.40350409]
Stock Position:  0.02839135835395931
Bond Position:  [-8.78026261]


portfolio before change:  [-5.99297557]
curr_Stock_Price:  98.21244246445482
curr_Factors:  [9.82124425e+01 4.26071400e-02]
mat_Sqrt:  [[ 2.02725184e+01  0.00000000e+00]
 [-8.25659881e-03  1.89182445e-02]]
grads:  [0.00727588 2.12003722]
Stock Position:  0.0072758849131151025
Bond Position:  [-6.707558]


portfolio before change:  [-5.98582604]
curr_Stock_Price:  99.31031858313843
curr_Factors:  [9.93103186e+01 4.10466658e-02]
mat_Sqrt:  [[ 2.01202475e+01  0.00000000e+00]
 [-8.10399070e-03  1.85685754e-02]]
grads:  [4.17948300e-03 5.49607714e+00]
Stock Position:  0.0041794829956368655
Bond Position:  [-6.40089183]


portfolio before change:  [-5.98456248]
curr_Stock_Price:  99.8040937179913
curr_Factors:  [9.98040937e+01 4.12011631e-02]
mat_Sqrt:  [[ 2.02583044e+01  0.00000000e+00]
 [-8.11922786e-03  1.86034881e-02]]
grads:  [-1.26986019e-03 -3.45361138e+00]
Stock Position:  -0.0012698601947961075
Bond Position:  [-5.85782523]


portfolio before change:  [-5.9830943]
curr_Stock_Price:  98.07126187223724
curr_Factors:  [9.80712619e+01 4.26240493e-02]
mat_Sqrt:  [[ 2.02473932e+01  0.00000000e+00]
 [-8.25823704e-03  1.89219982e-02]]
grads:  [-0.00454302 -2.70040364]
Stock Position:  -0.00454302073318089
Bond Position:  [-5.53755452]


portfolio before change:  [-5.98683701]
curr_Stock_Price:  98.74272442974662
curr_Factors:  [9.87427244e+01 4.33541222e-02]
mat_Sqrt:  [[ 2.05598672e+01  0.00000000e+00]
 [-8.32866109e-03  1.90833599e-02]]
grads:  [-0.00699001  0.33697826]
Stock Position:  -0.006990006489029218
Bond Position:  [-5.29662472]


portfolio before change:  [-5.98669464]
curr_Stock_Price:  98.62763428260234
curr_Factors:  [9.86276343e+01 4.45541301e-02]
mat_Sqrt:  [[ 2.08181724e+01  0.00000000e+00]
 [-8.44313971e-03  1.93456634e-02]]
grads:  [ 0.00748196 -1.89085256]
Stock Position:  0.007481957504700194
Bond Position:  [-6.72462241]


portfolio before change:  [-5.98463076]
curr_Stock_Price:  99.01583631363735
curr_Factors:  [9.90158363e+01 4.48050499e-02]
mat_Sqrt:  [[ 2.09588834e+01  0.00000000e+00]
 [-8.46688135e-03  1.94000623e-02]]
grads:  [0.04758913 3.62121477]
Stock Position:  0.0475891313081516
Bond Position:  [-10.6967084]


portfolio before change:  [-5.93993708]
curr_Stock_Price:  99.98309194623911
curr_Factors:  [9.99830919e+01 4.44366782e-02]
mat_Sqrt:  [[ 2.10764449e+01  0.00000000e+00]
 [-8.43200363e-03  1.93201474e-02]]
grads:  [-2.40062743e-03 -9.05474243e+00]
Stock Position:  -0.002400627428690251
Bond Position:  [-5.69991493]


portfolio before change:  [-5.94240413]
curr_Stock_Price:  100.71394744039547
curr_Factors:  [1.00713947e+02 4.40900310e-02]
mat_Sqrt:  [[ 2.11475383e+01  0.00000000e+00]
 [-8.39905051e-03  1.92446424e-02]]
grads:  [0.00149342 1.04043866]
Stock Position:  0.0014934195827665836
Bond Position:  [-6.09281231]


portfolio before change:  [-5.94350769]
curr_Stock_Price:  100.48499877927611
curr_Factors:  [1.00484999e+02 4.40780855e-02]
mat_Sqrt:  [[ 2.10966061e+01  0.00000000e+00]
 [-8.39791265e-03  1.92420352e-02]]
grads:  [ 0.00647881 -4.9176638 ]
Stock Position:  0.006478810928960085
Bond Position:  [-6.594531]


portfolio before change:  [-5.94508753]
curr_Stock_Price:  100.36839203426152
curr_Factors:  [1.00368392e+02 4.49489368e-02]
mat_Sqrt:  [[ 2.12792677e+01  0.00000000e+00]
 [-8.48046572e-03  1.94311881e-02]]
grads:  [ 0.00597986 -4.65692086]
Stock Position:  0.005979861078177988
Bond Position:  [-6.54527657]


portfolio before change:  [-5.93945043]
curr_Stock_Price:  101.44790015367124
curr_Factors:  [1.01447900e+02 4.38769051e-02]
mat_Sqrt:  [[ 2.12501038e+01  0.00000000e+00]
 [-8.37872592e-03  1.91980729e-02]]
grads:  [-0.00645559 -2.51140658]
Stock Position:  -0.0064555937573855466
Bond Position:  [-5.284544]


portfolio before change:  [-5.93758675]
curr_Stock_Price:  101.05687550524914
curr_Factors:  [1.01056876e+02 4.31877542e-02]
mat_Sqrt:  [[ 2.10012999e+01  0.00000000e+00]
 [-8.31266544e-03  1.90467093e-02]]
grads:  [7.99227829e-03 1.35786466e+01]
Stock Position:  0.007992278287088261
Bond Position:  [-6.74526142]


portfolio before change:  [-5.93419725]
curr_Stock_Price:  101.58647539391708
curr_Factors:  [1.01586475e+02 4.29650668e-02]
mat_Sqrt:  [[ 2.10568614e+01  0.00000000e+00]
 [-8.29120660e-03  1.89975409e-02]]
grads:  [2.60963562e-03 9.80900274e+00]
Stock Position:  0.0026096356245890206
Bond Position:  [-6.19930093]


portfolio before change:  [-5.93391796]
curr_Stock_Price:  101.99046072387596
curr_Factors:  [1.01990461e+02 4.51845992e-02]
mat_Sqrt:  [[ 2.16797750e+01  0.00000000e+00]
 [-8.50266774e-03  1.94820593e-02]]
grads:  [-0.02956564 -3.85584761]
Stock Position:  -0.02956564187247727
Bond Position:  [-2.91850452]


portfolio before change:  [-5.90215499]
curr_Stock_Price:  100.90380054198847
curr_Factors:  [1.00903801e+02 4.48343285e-02]
mat_Sqrt:  [[ 2.13654901e+01  0.00000000e+00]
 [-8.46964732e-03  1.94064000e-02]]
grads:  [-0.00918327 -3.28024525]
Stock Position:  -0.009183271367365868
Bond Position:  [-4.975528]


portfolio before change:  [-5.88829078]
curr_Stock_Price:  99.32634642012071
curr_Factors:  [9.93263464e+01 4.66217144e-02]
mat_Sqrt:  [[ 2.14466064e+01  0.00000000e+00]
 [-8.63682483e-03  1.97894518e-02]]
grads:  [-8.23551293e-04 -3.06725384e+00]
Stock Position:  -0.0008235512933728567
Bond Position:  [-5.80649043]


portfolio before change:  [-5.88888022]
curr_Stock_Price:  99.16071006709842
curr_Factors:  [9.91607101e+01 4.73829095e-02]
mat_Sqrt:  [[ 2.15849223e+01  0.00000000e+00]
 [-8.70704630e-03  1.99503494e-02]]
grads:  [-1.52377156e-03  7.97850426e+00]
Stock Position:  -0.0015237715644470982
Bond Position:  [-5.73778195]


portfolio before change:  [-5.89015778]
curr_Stock_Price:  99.5284085333436
curr_Factors:  [9.95284085e+01 4.92594782e-02]
mat_Sqrt:  [[ 2.20898091e+01  0.00000000e+00]
 [-8.87779055e-03  2.03415736e-02]]
grads:  [0.00130166 1.04477484]
Stock Position:  0.001301659729839541
Bond Position:  [-6.0197099]


portfolio before change:  [-5.89019219]
curr_Stock_Price:  100.08009110005521
curr_Factors:  [1.00080091e+02 4.86009423e-02]
mat_Sqrt:  [[ 2.20632780e+01  0.00000000e+00]
 [-8.81824856e-03  2.02051458e-02]]
grads:  [-6.98467492e-04  4.97438233e+00]
Stock Position:  -0.000698467492171119
Bond Position:  [-5.8202895]


portfolio before change:  [-5.89087366]
curr_Stock_Price:  100.01407268643445
curr_Factors:  [1.00014073e+02 4.80469587e-02]
mat_Sqrt:  [[ 2.19227012e+01  0.00000000e+00]
 [-8.76784659e-03  2.00896603e-02]]
grads:  [-0.00662957  4.8908672 ]
Stock Position:  -0.006629569051678879
Bond Position:  [-5.22782346]


portfolio before change:  [-5.88791754]
curr_Stock_Price:  99.46959721616706
curr_Factors:  [9.94695972e+01 4.84140525e-02]
mat_Sqrt:  [[ 2.1886488e+01  0.0000000e+00]
 [-8.8012774e-03  2.0166260e-02]]
grads:  [-4.3847470e-03 -7.4309068e+00]
Stock Position:  -0.004384747002079752
Bond Position:  [-5.45176852]


portfolio before change:  [-5.89142917]
curr_Stock_Price:  100.11504247893257
curr_Factors:  [1.00115042e+02 4.72080315e-02]
mat_Sqrt:  [[ 2.17524050e+01  0.00000000e+00]
 [-8.69096372e-03  1.99134995e-02]]
grads:  [-1.19568513e-04 -1.18423077e+00]
Stock Position:  -0.00011956851305918101
Bond Position:  [-5.87945856]


portfolio before change:  [-5.89235342]
curr_Stock_Price:  101.69807484009584
curr_Factors:  [1.01698075e+02 4.29078951e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.89235342]
Stock Price:  101.43432591834238
PL:  [-7.32667934]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.22200209e+00  3.05171405e-01]
 [ 2.57366400e-01  1.04324471e-01]
 [-8.09203154e-03 -5.92392190e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.03932032e-01 -1.46787645e-01]
 [-2.79915622e-01  1.00976038e-01]
 [ 2.35533520e-01 -2.60154751e-01]
 [-6.25675867e-01  1.46668941e-01]
 [-1.13965450e-01 -1.05178137e-01]
 [-3.45573036e-01 -5.77706059e-01]
 [-7.12541640e-02 -1.17423284e-02]
 [-1.34653360e-01 -1.83087012e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 1.35357630e-02 -1.82363471e-01]
 [ 1.07822736e-01  6.22746149e-02]
 [ 1.33280038e-01 -5.01718068e-01]
 [ 2.45571360e-02 -1.84574409e-01]
 [ 2.92774218e-02 -1.50525001e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 2.77686440e-02 -1.00313244e-01]
 [ 1.72575769e-01 -4.08079632e-02]
 [ 6.37997738e-01 -1.37965216e-01]
 [ 2.94582273e-02 -3.57461890e-01]
 [ 5.78025357e-02  9.71793981e-03]
 [ 2.29283932e-01 -1.39952197e-01]
 [ 1.66951487e-01 -9.04153715e-02]
 [-4.92444480e-02 -3.52050234e-01]
 [ 5.46602896e-02  8.58843671e-02]
 [ 2.20252590e-01 -5.02753027e-04]
 [-5.37971209e-01 -1.52124735e-01]
 [-1.65644589e-01 -6.06234453e-02]
 [ 7.39512863e-03 -6.03019693e-02]
 [-7.89138955e-02  1.62919908e-01]
 [ 5.28887948e-02  5.26719093e-02]
 [-6.84522222e-02  9.80247928e-02]
 [-2.13867365e-01  8.48048891e-02]
 [-2.21457593e-02 -2.24554541e-01]
 [ 2.90661064e-02 -1.56172607e-02]
 [-5.66798220e-02 -5.09562958e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.85852423]
curr_Stock_Price:  100.46115471598638
curr_Factors:  [1.00461155e+02 4.11256572e-02]
mat_Sqrt:  [[ 2.03729815e+01  0.00000000e+00]
 [-8.11178473e-03  1.85864338e-02]]
grads:  [ 0.06651897 16.41904029]
Stock Position:  0.06651897332301954
Bond Position:  [-0.82404864]


portfolio before change:  [5.85983909]
curr_Stock_Price:  100.48247005114274
curr_Factors:  [1.0048247e+02 4.0943922e-02]
mat_Sqrt:  [[ 2.03322304e+01  0.00000000e+00]
 [-8.09384181e-03  1.85453214e-02]]
grads:  [0.0148974  5.62537953]
Stock Position:  0.014897398138012363
Bond Position:  [4.36291173]


portfolio before change:  [5.86839864]
curr_Stock_Price:  101.02042611863598
curr_Factors:  [1.01020426e+02 4.19237135e-02]
mat_Sqrt:  [[ 2.06842162e+01  0.00000000e+00]
 [-8.19011243e-03  1.87659051e-02]]
grads:  [-1.64116184e-03 -3.15674723e+00]
Stock Position:  -0.0016411618401911028
Bond Position:  [6.03418951]


portfolio before change:  [5.86854011]
curr_Stock_Price:  101.39385178482308
curr_Factors:  [1.01393852e+02 4.25510711e-02]
mat_Sqrt:  [[ 2.09154335e+01  0.00000000e+00]
 [-8.25116439e-03  1.89057927e-02]]
grads:  [-7.79394172e-04 -8.00743004e+00]
Stock Position:  -0.0007793941716725327
Bond Position:  [5.94756588]


portfolio before change:  [5.86947543]
curr_Stock_Price:  101.14771784618955
curr_Factors:  [1.01147718e+02 4.19423057e-02]
mat_Sqrt:  [[ 2.07148713e+01  0.00000000e+00]
 [-8.19192829e-03  1.87700657e-02]]
grads:  [-0.00810989 -7.8203053 ]
Stock Position:  -0.008109894068330775
Bond Position:  [6.68977271]


portfolio before change:  [5.87118007]
curr_Stock_Price:  101.04064285527278
curr_Factors:  [1.01040643e+02 4.17149717e-02]
mat_Sqrt:  [[ 2.06367868e+01  0.00000000e+00]
 [-8.16969735e-03  1.87191282e-02]]
grads:  [-0.01142843  5.39427034]
Stock Position:  -0.011428429624340194
Bond Position:  [7.02591595]


portfolio before change:  [5.85711688]
curr_Stock_Price:  102.34803976956606
curr_Factors:  [1.02348040e+02 4.20041322e-02]
mat_Sqrt:  [[ 2.09761383e+01  0.00000000e+00]
 [-8.19796386e-03  1.87838950e-02]]
grads:  [ 5.81578347e-03 -1.38498832e+01]
Stock Position:  0.0058157834686944606
Bond Position:  [5.26188284]


portfolio before change:  [5.86390937]
curr_Stock_Price:  103.40287958477322
curr_Factors:  [1.03402880e+02 4.25860911e-02]
mat_Sqrt:  [[ 2.13386295e+01  0.00000000e+00]
 [-8.25455909e-03  1.89135709e-02]]
grads:  [-0.02632148  7.75469323]
Stock Position:  -0.026321479252411312
Bond Position:  [8.58562612]


portfolio before change:  [5.86246649]
curr_Stock_Price:  103.49847279865101
curr_Factors:  [1.03498473e+02 4.14136872e-02]
mat_Sqrt:  [[ 2.10623047e+01  0.00000000e+00]
 [-8.14014124e-03  1.86514067e-02]]
grads:  [-0.00759029 -5.63915307]
Stock Position:  -0.007590287734359301
Bond Position:  [6.64804968]


portfolio before change:  [5.86121268]
curr_Stock_Price:  103.77314820086501
curr_Factors:  [1.03773148e+02 4.12162067e-02]
mat_Sqrt:  [[ 2.10677910e+01  0.00000000e+00]
 [-8.12070999e-03  1.86068841e-02]]
grads:  [-2.83705411e-02 -3.10479742e+01]
Stock Position:  -0.028370541058192898
Bond Position:  [8.80531304]


portfolio before change:  [5.86125539]
curr_Stock_Price:  103.81044105603573
curr_Factors:  [1.03810441e+02 4.12159604e-02]
mat_Sqrt:  [[ 2.10752992e+01  0.00000000e+00]
 [-8.12068573e-03  1.86068285e-02]]
grads:  [-0.0036241 -0.6310763]
Stock Position:  -0.003624097367192496
Bond Position:  [6.23747454]


portfolio before change:  [5.8623257]
curr_Stock_Price:  103.73026418733204
curr_Factors:  [1.03730264e+02 4.07169223e-02]
mat_Sqrt:  [[ 2.09311435e+01  0.00000000e+00]
 [-8.07137384e-03  1.84938408e-02]]
grads:  [-0.01025071 -9.89989122]
Stock Position:  -0.0102507100455335
Bond Position:  [6.92563456]


portfolio before change:  [5.86789999]
curr_Stock_Price:  103.27092671591069
curr_Factors:  [1.03270927e+02 4.07272946e-02]
mat_Sqrt:  [[ 2.08411104e+01  0.00000000e+00]
 [-8.07240183e-03  1.84961962e-02]]
grads:  [-0.00314328 -0.96722605]
Stock Position:  -0.0031432836186407096
Bond Position:  [6.1925098]


portfolio before change:  [5.86994796]
curr_Stock_Price:  102.86566186990106
curr_Factors:  [1.02865662e+02 4.06177789e-02]
mat_Sqrt:  [[ 2.07313942e+01  0.00000000e+00]
 [-8.06154119e-03  1.84713114e-02]]
grads:  [-3.18619095e-03 -9.87279503e+00]
Stock Position:  -0.003186190951921896
Bond Position:  [6.19769761]


portfolio before change:  [5.86933058]
curr_Stock_Price:  103.30259278087728
curr_Factors:  [1.03302593e+02 4.05625452e-02]
mat_Sqrt:  [[ 2.08052923e+01  0.00000000e+00]
 [-8.05605811e-03  1.84587480e-02]]
grads:  [0.00648881 3.37371824]
Stock Position:  0.006488810834165597
Bond Position:  [5.1990196]


portfolio before change:  [5.86115956]
curr_Stock_Price:  101.94318522092607
curr_Factors:  [1.01943185e+02 4.11676316e-02]
mat_Sqrt:  [[ 2.06840767e+01  0.00000000e+00]
 [-8.11592327e-03  1.85959164e-02]]
grads:  [-4.14268812e-03 -2.69800132e+01]
Stock Position:  -0.004142688115112726
Bond Position:  [6.28347838]


portfolio before change:  [5.85592802]
curr_Stock_Price:  103.39562870872682
curr_Factors:  [1.03395629e+02 3.99296898e-02]
mat_Sqrt:  [[ 2.06609433e+01  0.00000000e+00]
 [-7.99296589e-03  1.83141856e-02]]
grads:  [-2.71031866e-03 -1.00782210e+01]
Stock Position:  -0.002710318662291112
Bond Position:  [6.13616312]


portfolio before change:  [5.86151871]
curr_Stock_Price:  101.61590584699337
curr_Factors:  [1.01615906e+02 3.97878761e-02]
mat_Sqrt:  [[ 2.02692216e+01  0.00000000e+00]
 [-7.97875941e-03  1.82816345e-02]]
grads:  [-1.79666863e-03 -8.23367306e+00]
Stock Position:  -0.0017966686261045577
Bond Position:  [6.04408882]


portfolio before change:  [5.86061056]
curr_Stock_Price:  102.54189999472688
curr_Factors:  [1.02541900e+02 4.06751651e-02]
mat_Sqrt:  [[ 2.06807375e+01  0.00000000e+00]
 [-8.06723399e-03  1.84843552e-02]]
grads:  [-1.54140124e-02 -2.53883697e+01]
Stock Position:  -0.015414012397040091
Bond Position:  [7.44119268]


portfolio before change:  [5.86507044]
curr_Stock_Price:  102.31290887389618
curr_Factors:  [1.02312909e+02 4.04619108e-02]
mat_Sqrt:  [[ 2.05803912e+01  0.00000000e+00]
 [-8.04605849e-03  1.84358360e-02]]
grads:  [-7.78004877e-04 -5.44120936e+00]
Stock Position:  -0.0007780048773506392
Bond Position:  [5.94467038]


portfolio before change:  [5.86684651]
curr_Stock_Price:  100.9852336609964
curr_Factors:  [1.00985234e+02 3.99617384e-02]
mat_Sqrt:  [[ 2.01873848e+01  0.00000000e+00]
 [-7.99617292e-03  1.83215338e-02]]
grads:  [ 0.00766646 -2.22732243]
Stock Position:  0.00766645682954728
Bond Position:  [5.09264757]


portfolio before change:  [5.86963844]
curr_Stock_Price:  101.26636872709494
curr_Factors:  [1.01266369e+02 3.98026222e-02]
mat_Sqrt:  [[ 2.02032426e+01  0.00000000e+00]
 [-7.98023781e-03  1.82850219e-02]]
grads:  [ 0.02859862 -7.54525845]
Stock Position:  0.028598616177359704
Bond Position:  [2.97356043]


portfolio before change:  [5.86915701]
curr_Stock_Price:  101.23653688336795
curr_Factors:  [1.01236537e+02 4.03805059e-02]
mat_Sqrt:  [[ 2.03433822e+01  0.00000000e+00]
 [-8.03796053e-03  1.84172813e-02]]
grads:  [-6.22074198e-03 -1.94090477e+01]
Stock Position:  -0.006220741984925706
Bond Position:  [6.49892338]


portfolio before change:  [5.86480515]
curr_Stock_Price:  102.06670762545716
curr_Factors:  [1.02066708e+02 4.15915683e-02]
mat_Sqrt:  [[ 2.08154955e+01  0.00000000e+00]
 [-8.15760438e-03  1.86914198e-02]]
grads:  [0.00298065 0.51991448]
Stock Position:  0.0029806541095983214
Bond Position:  [5.56057959]


portfolio before change:  [5.86242953]
curr_Stock_Price:  101.03648638185288
curr_Factors:  [1.01036486e+02 4.22031996e-02]
mat_Sqrt:  [[ 2.07563471e+01  0.00000000e+00]
 [-8.21736694e-03  1.88283530e-02]]
grads:  [ 0.00810373 -7.43305572]
Stock Position:  0.008103727748218346
Bond Position:  [5.04365735]


portfolio before change:  [5.85769323]
curr_Stock_Price:  100.3742244549006
curr_Factors:  [1.00374224e+02 4.15335630e-02]
mat_Sqrt:  [[ 2.04560510e+01  0.00000000e+00]
 [-8.15191393e-03  1.86783813e-02]]
grads:  [ 0.00623243 -4.84064277]
Stock Position:  0.006232433834139331
Bond Position:  [5.23211752]


portfolio before change:  [5.84840484]
curr_Stock_Price:  98.77894894879924
curr_Factors:  [9.87789489e+01 4.20479534e-02]
mat_Sqrt:  [[ 2.02552138e+01  0.00000000e+00]
 [-8.20223905e-03  1.87936907e-02]]
grads:  [-1.00167675e-02 -1.87323629e+01]
Stock Position:  -0.01001676746439406
Bond Position:  [6.8378506]


portfolio before change:  [5.85727779]
curr_Stock_Price:  97.97847469353599
curr_Factors:  [9.79784747e+01 4.29752956e-02]
mat_Sqrt:  [[ 2.03114118e+01  0.00000000e+00]
 [-8.29219349e-03  1.89998022e-02]]
grads:  [0.00453653 4.52027691]
Stock Position:  0.0045365285995520475
Bond Position:  [5.41279564]


portfolio before change:  [5.85751169]
curr_Stock_Price:  97.88087994739094
curr_Factors:  [9.78808799e+01 4.32296557e-02]
mat_Sqrt:  [[ 2.03511405e+01  0.00000000e+00]
 [-8.31669701e-03  1.90559468e-02]]
grads:  [ 0.01081183 -0.026383  ]
Stock Position:  0.010811834854617888
Bond Position:  [4.79923978]


portfolio before change:  [5.857526]
curr_Stock_Price:  97.82671419816253
curr_Factors:  [9.78267142e+01 4.45771923e-02]
mat_Sqrt:  [[ 2.06544589e+01  0.00000000e+00]
 [-8.44532460e-03  1.93506696e-02]]
grads:  [-0.0292607  -7.86147135]
Stock Position:  -0.029260698107336988
Bond Position:  [8.72000395]


portfolio before change:  [5.82339168]
curr_Stock_Price:  99.03052662484774
curr_Factors:  [9.90305266e+01 4.40154380e-02]
mat_Sqrt:  [[ 2.07764624e+01  0.00000000e+00]
 [-8.39194262e-03  1.92283561e-02]]
grads:  [-0.00924618 -3.15281478]
Stock Position:  -0.00924617605578924
Bond Position:  [6.73904536]


portfolio before change:  [5.82354065]
curr_Stock_Price:  99.10552680019538
curr_Factors:  [9.91055268e+01 4.46606722e-02]
mat_Sqrt:  [[ 2.09440421e+01  0.00000000e+00]
 [-8.45322870e-03  1.93687802e-02]]
grads:  [-9.03493619e-04 -3.11335916e+00]
Stock Position:  -0.0009034936194611727
Bond Position:  [5.91308186]


portfolio before change:  [5.82443082]
curr_Stock_Price:  98.9384112868981
curr_Factors:  [9.89384113e+01 4.35577973e-02]
mat_Sqrt:  [[ 2.06489459e+01  0.00000000e+00]
 [-8.34820195e-03  1.91281337e-02]]
grads:  [-3.78218745e-04  8.51729241e+00]
Stock Position:  -0.00037821874477080974
Bond Position:  [5.86185118]


portfolio before change:  [5.82462474]
curr_Stock_Price:  100.36313614930897
curr_Factors:  [1.00363136e+02 4.25392057e-02]
mat_Sqrt:  [[ 2.06999317e+01  0.00000000e+00]
 [-8.25001389e-03  1.89031566e-02]]
grads:  [0.00366555 2.78640814]
Stock Position:  0.003665553192491486
Bond Position:  [5.45673832]


portfolio before change:  [5.82408432]
curr_Stock_Price:  100.0296119585632
curr_Factors:  [1.00029612e+02 4.20164972e-02]
mat_Sqrt:  [[ 2.05039959e+01  0.00000000e+00]
 [-8.19917041e-03  1.87866595e-02]]
grads:  [-1.25198500e-03  5.21778726e+00]
Stock Position:  -0.0012519850014224676
Bond Position:  [5.94931989]


portfolio before change:  [5.82401152]
curr_Stock_Price:  100.68178521484475
curr_Factors:  [1.00681785e+02 4.12600318e-02]
mat_Sqrt:  [[ 2.04510536e+01  0.00000000e+00]
 [-8.12502621e-03  1.86167738e-02]]
grads:  [-0.00864774  4.55529459]
Stock Position:  -0.008647744033534152
Bond Position:  [6.69468183]


portfolio before change:  [5.82329509]
curr_Stock_Price:  100.86140585186088
curr_Factors:  [1.00861406e+02 4.14679938e-02]
mat_Sqrt:  [[ 2.05391057e+01  0.00000000e+00]
 [-8.14547667e-03  1.86636317e-02]]
grads:  [-5.84978711e-03 -1.20316638e+01]
Stock Position:  -0.0058497871052689615
Bond Position:  [6.41331285]


portfolio before change:  [5.82712035]
curr_Stock_Price:  100.34454269864945
curr_Factors:  [1.00344543e+02 4.21060461e-02]
mat_Sqrt:  [[ 2.05904571e+01  0.00000000e+00]
 [-8.20790312e-03  1.88066687e-02]]
grads:  [ 0.00108061 -0.8304108 ]
Stock Position:  0.0010806061688666253
Bond Position:  [5.71868742]


portfolio before change:  [5.82960189]
curr_Stock_Price:  101.97941858920933
curr_Factors:  [1.01979419e+02 4.37813638e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.82960189]
Stock Price:  102.39226210266372
PL:  [3.43733978]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.39245691e+00  3.43707822e-01]
 [ 4.11004327e-01  1.19845332e-01]
 [ 8.99636775e-02 -1.91355138e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.75863350e-02  1.84811678e-01]
 [-7.24624959e-02 -1.21534344e-01]
 [ 1.10986573e-01 -1.55553781e-02]
 [ 5.00977341e-01  5.66347442e-01]
 [-9.66929547e-02 -1.36170169e-03]
 [ 9.33015002e-02 -7.31409263e-02]
 [-9.80080578e-02 -5.40880654e-03]
 [ 1.08159563e-02 -1.35994420e-01]
 [-6.41022618e-02 -1.86975846e-02]
 [-3.87071273e-02 -4.10053606e-02]
 [ 4.10358922e-01  2.58820235e-01]
 [ 1.37234047e-01 -4.55011621e-01]
 [ 3.21606689e-02 -1.13713108e-01]
 [ 3.36472351e-02 -1.55289541e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-5.32196302e-02 -5.28994425e-02]
 [ 1.80134630e-01 -4.57521125e-02]
 [ 8.16274469e-01 -2.26348137e-02]
 [ 2.82225191e-02 -2.96566249e-01]
 [ 5.80755930e-02  7.51883208e-03]
 [ 2.39070617e-01 -1.48982987e-01]
 [-9.20011342e-02 -1.90678433e-02]
 [-1.57052850e-01  9.35941167e-02]
 [ 5.38211358e-02  2.35806338e-01]
 [ 6.60733032e-03  1.71714359e-01]
 [-5.16435703e-01 -1.10678075e-01]
 [-1.65187009e-01 -6.01236454e-02]
 [ 4.81332428e-03 -5.83592235e-02]
 [-2.48867830e-01  1.35766189e-01]
 [ 5.98110147e-02  5.91852461e-02]
 [-9.40628651e-02  9.10940126e-02]
 [-1.81274233e-01  1.00987329e-01]
 [-2.54826331e-02 -1.95042728e-01]
 [ 1.85111091e-02 -1.88699161e-02]
 [ 1.36043263e-01 -1.32043291e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.74306801]
curr_Stock_Price:  99.71862084666336
curr_Factors:  [9.97186208e+01 4.08468361e-02]
mat_Sqrt:  [[ 2.01537318e+01  0.00000000e+00]
 [-8.08424008e-03  1.85233211e-02]]
grads:  [ 0.07653487 18.55541029]
Stock Position:  0.07653487266365278
Bond Position:  [-6.88888394]


portfolio before change:  [0.76436702]
curr_Stock_Price:  100.0081643554651
curr_Factors:  [1.00008164e+02 4.14384156e-02]
mat_Sqrt:  [[ 2.03580899e+01  0.00000000e+00]
 [-8.14257115e-03  1.86569743e-02]]
grads:  [0.02275799 6.42362098]
Stock Position:  0.0227579856764916
Bond Position:  [-1.51161735]


portfolio before change:  [0.73204365]
curr_Stock_Price:  98.59615838952311
curr_Factors:  [9.85961584e+01 4.17850052e-02]
mat_Sqrt:  [[ 2.01544163e+01  0.00000000e+00]
 [-8.17655235e-03  1.87348350e-02]]
grads:  [ 0.00404935 -1.02138683]
Stock Position:  0.004049348468939719
Bond Position:  [0.33279345]


portfolio before change:  [0.73863215]
curr_Stock_Price:  100.21293748225595
curr_Factors:  [1.00212937e+02 4.19104404e-02]
mat_Sqrt:  [[ 2.05156322e+01  0.00000000e+00]
 [-8.18881582e-03  1.87629342e-02]]
grads:  [-7.94582726e-04 -8.06839756e+00]
Stock Position:  -0.0007945827257456633
Bond Position:  [0.81825962]


portfolio before change:  [0.73942933]
curr_Stock_Price:  99.3383997992162
curr_Factors:  [9.93383998e+01 4.20116852e-02]
mat_Sqrt:  [[ 2.03611457e+01  0.00000000e+00]
 [-8.19870089e-03  1.87855837e-02]]
grads:  [1.50880214e-04 9.83795238e+00]
Stock Position:  0.0001508802142993895
Bond Position:  [0.72444113]


portfolio before change:  [0.73945045]
curr_Stock_Price:  98.8781715067589
curr_Factors:  [9.88781715e+01 4.07422705e-02]
mat_Sqrt:  [[ 1.99582768e+01  0.00000000e+00]
 [-8.07388585e-03  1.84995965e-02]]
grads:  [-6.28834010e-03 -6.56956726e+00]
Stock Position:  -0.006288340100194995
Bond Position:  [1.36123003]


portfolio before change:  [0.72827019]
curr_Stock_Price:  100.68316702316498
curr_Factors:  [1.00683167e+02 3.82499953e-02]
mat_Sqrt:  [[ 1.96912171e+01  0.00000000e+00]
 [-7.82304240e-03  1.79248420e-02]]
grads:  [ 0.00529158 -0.86781117]
Stock Position:  0.005291579939929158
Bond Position:  [0.19549717]


portfolio before change:  [0.72240061]
curr_Stock_Price:  99.56931764144701
curr_Factors:  [9.95693176e+01 3.76073745e-02]
mat_Sqrt:  [[ 1.93091003e+01  0.00000000e+00]
 [-7.75704835e-03  1.77736306e-02]]
grads:  [ 0.03874606 31.86447689]
Stock Position:  0.03874606365200812
Bond Position:  [-3.13551851]


portfolio before change:  [0.7579087]
curr_Stock_Price:  100.49586480875809
curr_Factors:  [1.00495865e+02 3.76601002e-02]
mat_Sqrt:  [[ 1.95024390e+01  0.00000000e+00]
 [-7.76248416e-03  1.77860856e-02]]
grads:  [-0.00498847 -0.07655994]
Stock Position:  -0.0049884658095862835
Bond Position:  [1.25922889]


portfolio before change:  [0.75531189]
curr_Stock_Price:  101.04798320769325
curr_Factors:  [1.01047983e+02 3.88815638e-02]
mat_Sqrt:  [[ 1.99250542e+01  0.00000000e+00]
 [-7.88736345e-03  1.80722200e-02]]
grads:  [ 3.08055287e-03 -4.04714674e+00]
Stock Position:  0.0030805528697038197
Bond Position:  [0.44402824]


portfolio before change:  [0.75279889]
curr_Stock_Price:  100.21420077284694
curr_Factors:  [1.00214201e+02 3.94917398e-02]
mat_Sqrt:  [[ 1.99150958e+01  0.00000000e+00]
 [-7.94901149e-03  1.82134734e-02]]
grads:  [-0.00503983 -0.29696733]
Stock Position:  -0.005039827840816434
Bond Position:  [1.25786121]


portfolio before change:  [0.75118701]
curr_Stock_Price:  100.56522790986844
curr_Factors:  [1.00565228e+02 4.08284436e-02]
mat_Sqrt:  [[ 2.03202597e+01  0.00000000e+00]
 [-8.08241979e-03  1.85191503e-02]]
grads:  [-2.38859519e-03 -7.34344817e+00]
Stock Position:  -0.0023885951855112447
Bond Position:  [0.99139663]


portfolio before change:  [0.74938216]
curr_Stock_Price:  101.37272420403774
curr_Factors:  [1.01372724e+02 3.90650822e-02]
mat_Sqrt:  [[ 2.00362060e+01  0.00000000e+00]
 [-7.90595545e-03  1.81148196e-02]]
grads:  [-0.0036066  -1.03217062]
Stock Position:  -0.0036065988040090468
Bond Position:  [1.11499291]


portfolio before change:  [0.75082188]
curr_Stock_Price:  101.01218049272923
curr_Factors:  [1.01012180e+02 3.91976496e-02]
mat_Sqrt:  [[ 1.99987918e+01  0.00000000e+00]
 [-7.91935852e-03  1.81455299e-02]]
grads:  [-0.00283034 -2.25980507]
Stock Position:  -0.0028303376751383402
Bond Position:  [1.03672046]


portfolio before change:  [0.75218843]
curr_Stock_Price:  100.57514676305868
curr_Factors:  [1.00575147e+02 3.93633797e-02]
mat_Sqrt:  [[ 1.99543169e+01  0.00000000e+00]
 [-7.93608263e-03  1.81838497e-02]]
grads:  [ 0.02622577 14.23352257]
Stock Position:  0.026225770393117517
Bond Position:  [-1.88547227]


portfolio before change:  [0.77884525]
curr_Stock_Price:  101.60056993362387
curr_Factors:  [1.01600570e+02 3.96282879e-02]
mat_Sqrt:  [[ 2.02254782e+01  0.00000000e+00]
 [-7.96274203e-03  1.82449340e-02]]
grads:  [-3.03326842e-03 -2.49390664e+01]
Stock Position:  -0.003033268420417317
Bond Position:  [1.08702705]


portfolio before change:  [0.77768855]
curr_Stock_Price:  102.02670519118477
curr_Factors:  [1.02026705e+02 3.91935762e-02]
mat_Sqrt:  [[ 2.01986018e+01  0.00000000e+00]
 [-7.91894702e-03  1.81445871e-02]]
grads:  [-8.64802447e-04 -6.26705408e+00]
Stock Position:  -0.0008648024473006151
Bond Position:  [0.8659215]


portfolio before change:  [0.77675629]
curr_Stock_Price:  103.2298787904054
curr_Factors:  [1.03229879e+02 3.88222043e-02]
mat_Sqrt:  [[ 2.03397454e+01  0.00000000e+00]
 [-7.88134042e-03  1.80584195e-02]]
grads:  [-1.67783207e-03 -8.59928750e+00]
Stock Position:  -0.0016778320660856556
Bond Position:  [0.94995869]


portfolio before change:  [0.78107968]
curr_Stock_Price:  100.72388542346359
curr_Factors:  [1.00723885e+02 3.85446247e-02]
mat_Sqrt:  [[ 1.97749039e+01  0.00000000e+00]
 [-7.85311400e-03  1.79937447e-02]]
grads:  [-1.61200857e-02 -2.60805993e+01]
Stock Position:  -0.01612008568032512
Bond Position:  [2.40475734]


portfolio before change:  [0.78586381]
curr_Stock_Price:  100.44575300629187
curr_Factors:  [1.00445753e+02 3.71428183e-02]
mat_Sqrt:  [[ 1.93583798e+01  0.00000000e+00]
 [-7.70898886e-03  1.76635125e-02]]
grads:  [-0.0039418  -2.99484276]
Stock Position:  -0.003941798876543174
Bond Position:  [1.18180077]


portfolio before change:  [0.78783189]
curr_Stock_Price:  99.98394785629529
curr_Factors:  [9.99839479e+01 3.85584098e-02]
mat_Sqrt:  [[ 1.96331434e+01  0.00000000e+00]
 [-7.85451817e-03  1.79969620e-02]]
grads:  [ 0.00815798 -2.54221309]
Stock Position:  0.008157978984557996
Bond Position:  [-0.02783506]


portfolio before change:  [0.78806207]
curr_Stock_Price:  100.01259044319205
curr_Factors:  [1.00012590e+02 3.86781254e-02]
mat_Sqrt:  [[ 1.96692312e+01  0.00000000e+00]
 [-7.86670202e-03  1.80248787e-02]]
grads:  [ 0.04099783 -1.25575401]
Stock Position:  0.04099783157345651
Bond Position:  [-3.31223726]


portfolio before change:  [0.82065331]
curr_Stock_Price:  100.8176401190612
curr_Factors:  [1.00817640e+02 3.63657299e-02]
mat_Sqrt:  [[ 1.92257231e+01  0.00000000e+00]
 [-7.62792029e-03  1.74777611e-02]]
grads:  [-5.26428073e-03 -1.69682060e+01]
Stock Position:  -0.005264280725966364
Bond Position:  [1.35138567]


portfolio before change:  [0.81559388]
curr_Stock_Price:  101.81081804982888
curr_Factors:  [1.01810818e+02 3.51061340e-02]
mat_Sqrt:  [[ 1.90759173e+01  0.00000000e+00]
 [-7.49465238e-03  1.71724059e-02]]
grads:  [0.00321647 0.43784384]
Stock Position:  0.0032164681554762414
Bond Position:  [0.48812262]


portfolio before change:  [0.81348506]
curr_Stock_Price:  101.13621636049871
curr_Factors:  [1.01136216e+02 3.61875588e-02]
mat_Sqrt:  [[ 1.92391706e+01  0.00000000e+00]
 [-7.60921113e-03  1.74348930e-02]]
grads:  [ 0.0090466  -8.54510476]
Stock Position:  0.009046601571913098
Bond Position:  [-0.10145399]


portfolio before change:  [0.8302901]
curr_Stock_Price:  102.99522662290308
curr_Factors:  [1.02995227e+02 3.39843016e-02]
mat_Sqrt:  [[ 1.89869966e+01  0.00000000e+00]
 [-7.37393264e-03  1.68958022e-02]]
grads:  [-0.00528378 -1.12855507]
Stock Position:  -0.0052837752868853324
Bond Position:  [1.37449374]


portfolio before change:  [0.82815872]
curr_Stock_Price:  103.43112827467816
curr_Factors:  [1.03431128e+02 3.29882630e-02]
mat_Sqrt:  [[ 1.87858559e+01  0.00000000e+00]
 [-7.26506853e-03  1.66463632e-02]]
grads:  [-0.00618577  5.62249636]
Stock Position:  -0.006185772363810679
Bond Position:  [1.46796013]


portfolio before change:  [0.84481257]
curr_Stock_Price:  100.76851070011222
curr_Factors:  [1.00768511e+02 3.64490978e-02]
mat_Sqrt:  [[ 1.92383682e+01  0.00000000e+00]
 [-7.63665873e-03  1.74977833e-02]]
grads:  [8.14702461e-03 1.34763549e+01]
Stock Position:  0.008147024610372294
Bond Position:  [0.02384904]


portfolio before change:  [0.83888994]
curr_Stock_Price:  100.04117571068431
curr_Factors:  [1.00041176e+02 3.52262578e-02]
mat_Sqrt:  [[ 1.87763876e+01  0.00000000e+00]
 [-7.50746379e-03  1.72017605e-02]]
grads:  [4.34320074e-03 9.98237119e+00]
Stock Position:  0.004343200741219729
Bond Position:  [0.40439103]


portfolio before change:  [0.83816716]
curr_Stock_Price:  99.86311968729873
curr_Factors:  [9.98631197e+01 3.45275623e-02]
mat_Sqrt:  [[ 1.85561591e+01  0.00000000e+00]
 [-7.43263746e-03  1.70303119e-02]]
grads:  [-0.03043408 -6.49888712]
Stock Position:  -0.03043407698327943
Bond Position:  [3.87740903]


portfolio before change:  [0.86607129]
curr_Stock_Price:  98.9621746700776
curr_Factors:  [9.89621747e+01 3.58104442e-02]
mat_Sqrt:  [[ 1.87272533e+01  0.00000000e+00]
 [-7.56945907e-03  1.73438096e-02]]
grads:  [-0.01022185 -3.46657665]
Stock Position:  -0.010221847079722592
Bond Position:  [1.87764751]


portfolio before change:  [0.86851356]
curr_Stock_Price:  98.74621123792257
curr_Factors:  [9.87462112e+01 3.48450947e-02]
mat_Sqrt:  [[ 1.84327981e+01  0.00000000e+00]
 [-7.46673633e-03  1.71084422e-02]]
grads:  [-1.12065075e-03 -3.41113602e+00]
Stock Position:  -0.0011206507492133259
Bond Position:  [0.97917357]


portfolio before change:  [0.86649174]
curr_Stock_Price:  100.65958190370513
curr_Factors:  [1.00659582e+02 3.36999779e-02]
mat_Sqrt:  [[ 1.84786368e+01  0.00000000e+00]
 [-7.34302150e-03  1.68249759e-02]]
grads:  [-0.01026129  8.06932442]
Stock Position:  -0.010261287590587817
Bond Position:  [1.89938866]


portfolio before change:  [0.86777721]
curr_Stock_Price:  100.55744788075522
curr_Factors:  [1.00557448e+02 3.37170662e-02]
mat_Sqrt:  [[ 1.84645672e+01  0.00000000e+00]
 [-7.34488297e-03  1.68292411e-02]]
grads:  [0.00463816 3.51681016]
Stock Position:  0.004638157669164393
Bond Position:  [0.40137591]


portfolio before change:  [0.86607762]
curr_Stock_Price:  100.18019358307484
curr_Factors:  [1.00180194e+02 3.53370456e-02]
mat_Sqrt:  [[ 1.88320234e+01  0.00000000e+00]
 [-7.51926014e-03  1.72287894e-02]]
grads:  [-2.88371448e-03  5.28731362e+00]
Stock Position:  -0.0028837144799973733
Bond Position:  [1.15496869]


portfolio before change:  [0.86716512]
curr_Stock_Price:  99.85314184122797
curr_Factors:  [9.98531418e+01 3.55131230e-02]
mat_Sqrt:  [[ 1.88172505e+01  0.00000000e+00]
 [-7.53797034e-03  1.72716598e-02]]
grads:  [-0.00729117  5.84699615]
Stock Position:  -0.007291168754031646
Bond Position:  [1.59521123]


portfolio before change:  [0.8643275]
curr_Stock_Price:  100.26967810799223
curr_Factors:  [1.00269678e+02 3.50586898e-02]
mat_Sqrt:  [[ 1.87744603e+01  0.00000000e+00]
 [-7.48958634e-03  1.71607982e-02]]
grads:  [-5.89131493e-03 -1.13655977e+01]
Stock Position:  -0.005891314926346991
Bond Position:  [1.45504775]


portfolio before change:  [0.8648772]
curr_Stock_Price:  100.20724551864416
curr_Factors:  [1.00207246e+02 3.68436854e-02]
mat_Sqrt:  [[ 1.92344892e+01  0.00000000e+00]
 [-7.67788361e-03  1.75922414e-02]]
grads:  [ 5.34227995e-04 -1.07262717e+00]
Stock Position:  0.0005342279945202223
Bond Position:  [0.81134369]


portfolio before change:  [0.86391834]
curr_Stock_Price:  98.22253995392911
curr_Factors:  [9.82225400e+01 3.82840526e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.86391834]
Stock Price:  97.42829760725826
PL:  [0.86391834]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.15164536e+00  2.89265157e-01]
 [ 1.13511487e-01  6.30615292e-02]
 [ 1.02557335e-01 -4.28387396e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.73726893e-02  1.85790174e-01]
 [-3.03140980e-01  1.26768424e-01]
 [ 1.94103026e-01 -2.03900670e-01]
 [ 9.23485157e-02  4.13729454e-01]
 [-1.18041935e-01 -9.78170432e-02]
 [-1.25174776e-01 -3.82728849e-01]
 [-1.04333419e-01 -3.30996749e-03]
 [-2.26525692e-02 -1.35612120e-01]
 [-1.08801173e-01 -2.59098602e-02]
 [-4.32319093e-02 -3.76744500e-02]
 [ 4.18812871e-01  2.64730388e-01]
 [ 1.26295671e-01 -5.84926333e-01]
 [ 2.78500707e-02 -1.49420561e-01]
 [ 3.37069733e-02 -1.55354676e-01]
 [-1.23177571e-01 -3.51984515e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.30316329e-01 -2.50703745e-02]
 [ 4.20535735e-01 -3.28981286e-01]
 [ 2.78429054e-02 -3.49563996e-01]
 [ 3.37120805e-02  4.98247878e-02]
 [ 4.28323867e-01 -3.65622299e-01]
 [ 8.04986288e-02 -8.82082581e-02]
 [ 1.27450029e-01 -1.51203568e-01]
 [ 5.11254304e-02  9.34091525e-02]
 [ 2.36997314e-01 -1.24201136e-02]
 [-5.34622785e-01 -1.61970903e-01]
 [-9.20709860e-02 -3.09608615e-02]
 [-3.38673590e-02  1.15896374e-02]
 [ 1.99521972e-01  2.03833801e-01]
 [ 1.73389436e-02 -4.94977640e-03]
 [ 1.15094327e-01 -7.97450132e-02]
 [ 3.46495125e-02  1.16578461e-01]
 [-5.33473531e-02  1.32132953e-01]
 [-2.89467838e-01 -1.08455528e-01]
 [ 1.19412638e-01 -9.10608022e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.88917646]
curr_Stock_Price:  100.75591396970327
curr_Factors:  [1.00755914e+02 3.78872614e-02]
mat_Sqrt:  [[ 1.96117864e+01  0.00000000e+00]
 [-7.78586015e-03  1.78396467e-02]]
grads:  [ 0.06515934 16.2147357 ]
Stock Position:  0.06515933828057681
Bond Position:  [1.32398778]


portfolio before change:  [7.89036211]
curr_Stock_Price:  100.77157001195597
curr_Factors:  [1.00771570e+02 3.84566209e-02]
mat_Sqrt:  [[ 1.97616674e+01  0.00000000e+00]
 [-7.84414389e-03  1.79731916e-02]]
grads:  [0.00713674 3.50864392]
Stock Position:  0.007136735568576207
Bond Position:  [7.17118206]


portfolio before change:  [7.87813329]
curr_Stock_Price:  98.93245517415652
curr_Factors:  [9.89324552e+01 3.70628185e-02]
mat_Sqrt:  [[ 1.90461854e+01  0.00000000e+00]
 [-7.70068242e-03  1.76444800e-02]]
grads:  [ 0.00440303 -2.42788337]
Stock Position:  0.00440303263176234
Bond Position:  [7.44253046]


portfolio before change:  [7.88058132]
curr_Stock_Price:  99.27714140863499
curr_Factors:  [9.92771414e+01 3.65120319e-02]
mat_Sqrt:  [[ 1.89699971e+01  0.00000000e+00]
 [-7.64324872e-03  1.75128829e-02]]
grads:  [-8.59323640e-04 -8.64431135e+00]
Stock Position:  -0.0008593236398671332
Bond Position:  [7.96589252]


portfolio before change:  [7.88153892]
curr_Stock_Price:  99.3215934231775
curr_Factors:  [9.93215934e+01 3.55972996e-02]
mat_Sqrt:  [[ 1.87392500e+01  0.00000000e+00]
 [-7.54689866e-03  1.72921172e-02]]
grads:  [1.98129071e-04 1.07442120e+01]
Stock Position:  0.0001981290707337824
Bond Position:  [7.86186043]


portfolio before change:  [7.88289785]
curr_Stock_Price:  101.21999514384405
curr_Factors:  [1.01219995e+02 3.68197431e-02]
mat_Sqrt:  [[ 1.94225697e+01  0.00000000e+00]
 [-7.67538853e-03  1.75865245e-02]]
grads:  [-0.01275911  7.20827041]
Stock Position:  -0.012759110017435371
Bond Position:  [9.1743749]


portfolio before change:  [7.87633841]
curr_Stock_Price:  101.823979462118
curr_Factors:  [1.01823979e+02 3.78035480e-02]
mat_Sqrt:  [[ 1.97977733e+01  0.00000000e+00]
 [-7.77725381e-03  1.78199271e-02]]
grads:  [ 5.30935859e-03 -1.14422841e+01]
Stock Position:  0.0053093585896703335
Bond Position:  [7.33571839]


portfolio before change:  [7.87252953]
curr_Stock_Price:  100.93387101829708
curr_Factors:  [1.00933871e+02 3.79899807e-02]
mat_Sqrt:  [[ 1.96730396e+01  0.00000000e+00]
 [-7.79640745e-03  1.78638136e-02]]
grads:  [1.38725311e-02 2.31601976e+01]
Stock Position:  0.013872531064800265
Bond Position:  [6.47232127]


portfolio before change:  [7.8871655]
curr_Stock_Price:  101.93058021864883
curr_Factors:  [1.01930580e+02 3.65451146e-02]
mat_Sqrt:  [[ 1.94858413e+01  0.00000000e+00]
 [-7.64671063e-03  1.75208151e-02]]
grads:  [-0.0082487  -5.58290482]
Stock Position:  -0.008248696578362448
Bond Position:  [8.72795993]


portfolio before change:  [7.88590246]
curr_Stock_Price:  102.21597185022125
curr_Factors:  [1.02215972e+02 3.67561727e-02]
mat_Sqrt:  [[ 1.95967433e+01  0.00000000e+00]
 [-7.66875977e-03  1.75713361e-02]]
grads:  [-1.49112195e-02 -2.17814313e+01]
Stock Position:  -0.014911219470654772
Bond Position:  [9.41006724]


portfolio before change:  [7.92141523]
curr_Stock_Price:  99.91324622629685
curr_Factors:  [9.99132462e+01 3.74332009e-02]
mat_Sqrt:  [[ 1.93308768e+01  0.00000000e+00]
 [-7.73906463e-03  1.77324247e-02]]
grads:  [-0.00547197 -0.18666187]
Stock Position:  -0.005471971533339256
Bond Position:  [8.46813767]


portfolio before change:  [7.91117949]
curr_Stock_Price:  101.97727919241741
curr_Factors:  [1.01977279e+02 3.58641380e-02]
mat_Sqrt:  [[ 1.93122831e+01  0.00000000e+00]
 [-7.57513174e-03  1.73568073e-02]]
grads:  [-4.23764246e-03 -7.81319503e+00]
Stock Position:  -0.004237642455619233
Bond Position:  [8.34332274]


portfolio before change:  [7.91944184]
curr_Stock_Price:  100.27365109948109
curr_Factors:  [1.00273651e+02 3.46967055e-02]
mat_Sqrt:  [[ 1.86780248e+01  0.00000000e+00]
 [-7.45082068e-03  1.70719749e-02]]
grads:  [-0.00643051 -1.51768383]
Stock Position:  -0.006430506641203879
Bond Position:  [8.56425221]


portfolio before change:  [7.9200814]
curr_Stock_Price:  100.34068113438455
curr_Factors:  [1.00340681e+02 3.37014835e-02]
mat_Sqrt:  [[ 1.84205059e+01  0.00000000e+00]
 [-7.34318552e-03  1.68253517e-02]]
grads:  [-0.00323956 -2.23914784]
Stock Position:  -0.003239562884246826
Bond Position:  [8.24514134]


portfolio before change:  [7.92079457]
curr_Stock_Price:  100.43869941917627
curr_Factors:  [1.00438699e+02 3.30846988e-02]
mat_Sqrt:  [[ 1.82689957e+01  0.00000000e+00]
 [-7.27567991e-03  1.66706770e-02]]
grads:  [ 0.02924905 15.8800023 ]
Stock Position:  0.029249045416084894
Bond Position:  [4.98305849]


portfolio before change:  [7.98338243]
curr_Stock_Price:  102.55722810435725
curr_Factors:  [1.02557228e+02 3.20531232e-02]
mat_Sqrt:  [[ 1.83612165e+01  0.00000000e+00]
 [-7.16135442e-03  1.64087243e-02]]
grads:  [-7.02497626e-03 -3.56472765e+01]
Stock Position:  -0.00702497625534243
Bond Position:  [8.70384452]


portfolio before change:  [7.98386886]
curr_Stock_Price:  102.642868208587
curr_Factors:  [1.02642868e+02 3.17253127e-02]
mat_Sqrt:  [[ 1.82823381e+01  0.00000000e+00]
 [-7.12464037e-03  1.63246019e-02]]
grads:  [-2.04363405e-03 -9.15309068e+00]
Stock Position:  -0.0020436340535176572
Bond Position:  [8.19363332]


portfolio before change:  [7.98365302]
curr_Stock_Price:  103.24968165018188
curr_Factors:  [1.03249682e+02 3.10742827e-02]
mat_Sqrt:  [[ 1.82007497e+01  0.00000000e+00]
 [-7.05115965e-03  1.61562364e-02]]
grads:  [-1.87329458e-03 -9.61577137e+00]
Stock Position:  -0.00187329458192661
Bond Position:  [8.17707009]


portfolio before change:  [7.98237967]
curr_Stock_Price:  104.47509168196268
curr_Factors:  [1.04475092e+02 2.99400146e-02]
mat_Sqrt:  [[ 1.80775164e+01  0.00000000e+00]
 [-6.92127324e-03  1.58586293e-02]]
grads:  [-1.53116280e-02 -2.21951411e+01]
Stock Position:  -0.015311628044829776
Bond Position:  [9.58206341]


portfolio before change:  [7.98389296]
curr_Stock_Price:  104.45448902031013
curr_Factors:  [1.04454489e+02 3.10173849e-02]
mat_Sqrt:  [[ 1.83962668e+01  0.00000000e+00]
 [-7.04470126e-03  1.61414384e-02]]
grads:  [-2.63428829e-04 -6.75859156e+00]
Stock Position:  -0.00026342882893290475
Bond Position:  [8.01140928]


portfolio before change:  [7.98495187]
curr_Stock_Price:  104.23651843527546
curr_Factors:  [1.04236518e+02 3.16210416e-02]
mat_Sqrt:  [[ 1.85356569e+01  0.00000000e+00]
 [-7.11292250e-03  1.62977529e-02]]
grads:  [ 0.00644027 -1.53827185]
Stock Position:  0.006440274607721714
Bond Position:  [7.31364006]


portfolio before change:  [7.98061372]
curr_Stock_Price:  103.42096175649117
curr_Factors:  [1.03420962e+02 3.22734553e-02]
mat_Sqrt:  [[ 1.85793837e+01  0.00000000e+00]
 [-7.18592572e-03  1.64650243e-02]]
grads:  [ 1.49066586e-02 -1.99806135e+01]
Stock Position:  0.014906658636092748
Bond Position:  [6.43895275]


portfolio before change:  [7.98967362]
curr_Stock_Price:  103.97473976400475
curr_Factors:  [1.03974740e+02 3.12666022e-02]
mat_Sqrt:  [[ 1.83851927e+01  0.00000000e+00]
 [-7.07294588e-03  1.62061549e-02]]
grads:  [-6.78368359e-03 -2.15698293e+01]
Stock Position:  -0.006783683592320064
Bond Position:  [8.69500536]


portfolio before change:  [7.98643789]
curr_Stock_Price:  104.61195598717538
curr_Factors:  [1.04611956e+02 3.16292943e-02]
mat_Sqrt:  [[ 1.86048458e+01  0.00000000e+00]
 [-7.11385064e-03  1.62998795e-02]]
grads:  [2.98080411e-03 3.05675804e+00]
Stock Position:  0.0029808041100988
Bond Position:  [7.67461014]


portfolio before change:  [7.98533372]
curr_Stock_Price:  103.91967538930315
curr_Factors:  [1.03919675e+02 3.18722723e-02]
mat_Sqrt:  [[ 1.85525792e+01  0.00000000e+00]
 [-7.14112286e-03  1.63623680e-02]]
grads:  [ 1.44860297e-02 -2.23453169e+01]
Stock Position:  0.014486029712640793
Bond Position:  [6.47995022]


portfolio before change:  [7.95531093]
curr_Stock_Price:  101.79122239480962
curr_Factors:  [1.01791222e+02 3.27892383e-02]
mat_Sqrt:  [[ 1.84321499e+01  0.00000000e+00]
 [-7.24311958e-03  1.65960719e-02]]
grads:  [ 2.27870265e-03 -5.31500820e+00]
Stock Position:  0.002278702651870167
Bond Position:  [7.72335901]


portfolio before change:  [7.95270088]
curr_Stock_Price:  100.2221125138943
curr_Factors:  [1.00222113e+02 3.40000477e-02]
mat_Sqrt:  [[ 1.84800574e+01  0.00000000e+00]
 [-7.37564074e-03  1.68997160e-02]]
grads:  [ 3.32571378e-03 -8.94710703e+00]
Stock Position:  0.0033257137787885914
Bond Position:  [7.61939082]


portfolio before change:  [7.94771514]
curr_Stock_Price:  98.4365633625492
curr_Factors:  [9.84365634e+01 3.43899030e-02]
mat_Sqrt:  [[ 1.82545831e+01  0.00000000e+00]
 [-7.41780592e-03  1.69963286e-02]]
grads:  [5.03394279e-03 5.49584294e+00]
Stock Position:  0.005033942786918755
Bond Position:  [7.45219111]


portfolio before change:  [7.94514125]
curr_Stock_Price:  97.7401971934905
curr_Factors:  [9.77401972e+01 3.49262833e-02]
mat_Sqrt:  [[ 1.82662500e+01  0.00000000e+00]
 [-7.47542998e-03  1.71283619e-02]]
grads:  [ 0.01267785 -0.72511976]
Stock Position:  0.01267784749579585
Bond Position:  [6.70600594]


portfolio before change:  [7.94371218]
curr_Stock_Price:  97.5613519869062
curr_Factors:  [9.75613520e+01 3.51162541e-02]
mat_Sqrt:  [[ 1.82823451e+01  0.00000000e+00]
 [-7.49573256e-03  1.71748809e-02]]
grads:  [-0.03310914 -9.43068566]
Stock Position:  -0.033109137842959616
Bond Position:  [11.17388443]


portfolio before change:  [7.95817057]
curr_Stock_Price:  97.1668518711681
curr_Factors:  [9.71668519e+01 3.49368368e-02]
mat_Sqrt:  [[ 1.81618432e+01  0.00000000e+00]
 [-7.47655929e-03  1.71309494e-02]]
grads:  [-0.00581347 -1.80730564]
Stock Position:  -0.005813474569158178
Bond Position:  [8.52304759]


portfolio before change:  [7.96085912]
curr_Stock_Price:  96.88765517345153
curr_Factors:  [9.68876552e+01 3.53885881e-02]
mat_Sqrt:  [[ 1.82263650e+01  0.00000000e+00]
 [-7.52474192e-03  1.72413497e-02]]
grads:  [-0.00158063  0.67220012]
Stock Position:  -0.0015806347866179297
Bond Position:  [8.11400311]


portfolio before change:  [7.96295572]
curr_Stock_Price:  96.20293761680132
curr_Factors:  [9.62029376e+01 3.49837647e-02]
mat_Sqrt:  [[ 1.79937468e+01  0.00000000e+00]
 [-7.48157895e-03  1.71424509e-02]]
grads:  [ 0.01603237 11.89058682]
Stock Position:  0.016032366052244694
Bond Position:  [6.42059501]


portfolio before change:  [7.96896983]
curr_Stock_Price:  96.52799810799971
curr_Factors:  [9.65279981e+01 3.42248435e-02]
mat_Sqrt:  [[ 1.78576388e+01  0.00000000e+00]
 [-7.39998309e-03  1.69554913e-02]]
grads:  [ 0.00084998 -0.29192763]
Stock Position:  0.0008499826986694286
Bond Position:  [7.8869227]


portfolio before change:  [7.97014262]
curr_Stock_Price:  96.74784429008017
curr_Factors:  [9.67478443e+01 3.44686561e-02]
mat_Sqrt:  [[ 1.79619495e+01  0.00000000e+00]
 [-7.42629448e-03  1.70157783e-02]]
grads:  [ 4.47004649e-03 -4.68653340e+00]
Stock Position:  0.004470046494949521
Bond Position:  [7.53767526]


portfolio before change:  [7.96806794]
curr_Stock_Price:  96.07291725516676
curr_Factors:  [9.60729173e+01 3.36922419e-02]
mat_Sqrt:  [[ 1.76346130e+01  0.00000000e+00]
 [-7.34217863e-03  1.68230447e-02]]
grads:  [4.85003693e-03 6.92968862e+00]
Stock Position:  0.004850036927214193
Bond Position:  [7.50211074]


portfolio before change:  [7.96430798]
curr_Stock_Price:  95.10431132784039
curr_Factors:  [9.51043113e+01 3.38482723e-02]
mat_Sqrt:  [[ 1.74971961e+01  0.00000000e+00]
 [-7.35915999e-03  1.68619538e-02]]
grads:  [2.46907877e-04 7.83615912e+00]
Stock Position:  0.0002469078773204546
Bond Position:  [7.94082598]


portfolio before change:  [7.96539516]
curr_Stock_Price:  95.48709883050446
curr_Factors:  [9.54870988e+01 3.27259004e-02]
mat_Sqrt:  [[ 1.72739040e+01  0.00000000e+00]
 [-7.23612056e-03  1.65800351e-02]]
grads:  [-0.01949772 -6.54133281]
Stock Position:  -0.019497718140501646
Bond Position:  [9.8271757]


portfolio before change:  [7.9411342]
curr_Stock_Price:  96.79440239947212
curr_Factors:  [9.67944024e+01 3.26332857e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.9411342]
Stock Price:  96.4266145677319
PL:  [7.9411342]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.47765105e+00  3.64238042e-01]
 [ 8.21128508e-01  9.45623854e-02]
 [ 9.52691632e-02 -3.06768572e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.10683658e-01  8.62810241e-01]
 [ 8.55527937e-03 -6.76694498e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.02443204e+00  1.03902619e+00]
 [ 5.21460271e-02  4.71804372e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-8.39680226e-02  1.06065531e-02]
 [ 2.58085073e-02 -1.33786974e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-5.61928533e-02 -7.33365324e-03]
 [ 4.40470669e-01  2.79415289e-01]
 [ 1.30419635e-01 -1.24576448e-01]
 [ 3.94267698e-02  6.46251210e-02]
 [ 2.10765857e-02 -1.28195148e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-5.01006492e-02 -5.47254197e-02]
 [ 1.75872914e-01 -4.29645816e-02]
 [ 6.30179444e-01 -1.45381121e-01]
 [ 3.03733133e-02 -4.16409910e-01]
 [ 5.77520606e-02  1.01244485e-02]
 [ 1.86297435e-01 -1.02644384e-01]
 [ 1.57777986e-01 -9.36362783e-02]
 [-3.27605724e-02 -3.43412464e-01]
 [ 5.04199416e-02  9.49109526e-02]
 [ 8.22514355e-02  1.01830488e-01]
 [-5.29733307e-01 -1.12145782e-01]
 [-1.65102922e-01 -6.00317992e-02]
 [ 2.02889712e-03 -5.23967097e-02]
 [-6.14366466e-02  1.65712266e-01]
 [ 1.71120889e-02  1.90367097e-02]
 [-6.51410765e-02  7.12636328e-02]
 [-1.70087963e-01  1.04147997e-01]
 [-2.86091223e-02 -1.67261785e-01]
 [-7.56809673e-02 -5.12257953e-02]
 [ 1.25969727e-01 -1.30489813e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.43451027]
curr_Stock_Price:  98.96706965098933
curr_Factors:  [9.89670697e+01 4.02958976e-02]
mat_Sqrt:  [[ 1.98664893e+01  0.00000000e+00]
 [-8.02953524e-03  1.83979765e-02]]
grads:  [ 0.08238081 19.79772298]
Stock Position:  0.0823808141584917
Bond Position:  [-12.58749805]


portfolio before change:  [-4.42068648]
curr_Stock_Price:  99.15397390247288
curr_Factors:  [9.91539739e+01 3.95635392e-02]
mat_Sqrt:  [[ 1.97223060e+01  0.00000000e+00]
 [-7.95623421e-03  1.82300228e-02]]
grads:  [0.04372708 5.18717868]
Stock Position:  0.04372708329341561
Bond Position:  [-8.75640056]


portfolio before change:  [-4.44093174]
curr_Stock_Price:  98.71601564748869
curr_Factors:  [9.87160156e+01 3.80276097e-02]
mat_Sqrt:  [[ 1.92502836e+01  0.00000000e+00]
 [-7.80026766e-03  1.78726585e-02]]
grads:  [ 0.00425348 -1.71641265]
Stock Position:  0.004253479416589075
Bond Position:  [-4.86081828]


portfolio before change:  [-4.44469195]
curr_Stock_Price:  97.9748419621277
curr_Factors:  [9.7974842e+01 3.8299977e-02]
mat_Sqrt:  [[ 1.91740488e+01  0.00000000e+00]
 [-7.82815196e-03  1.79365495e-02]]
grads:  [-8.50178652e-04 -8.44013018e+00]
Stock Position:  -0.0008501786524202178
Bond Position:  [-4.36139583]


portfolio before change:  [-4.44478411]
curr_Stock_Price:  97.44195308241719
curr_Factors:  [9.74419531e+01 3.89132705e-02]
mat_Sqrt:  [[ 1.92218351e+01  0.00000000e+00]
 [-7.89057874e-03  1.80795872e-02]]
grads:  [1.38320614e-02 4.77228951e+01]
Stock Position:  0.013832061390078018
Bond Position:  [-5.79260718]


portfolio before change:  [-4.44518709]
curr_Stock_Price:  97.46516991885896
curr_Factors:  [9.74651699e+01 3.78812825e-02]
mat_Sqrt:  [[ 1.89697576e+01  0.00000000e+00]
 [-7.78524579e-03  1.78382391e-02]]
grads:  [-1.10587021e-03 -3.79350504e+00]
Stock Position:  -0.0011058702060509715
Bond Position:  [-4.33740326]


portfolio before change:  [-4.44555652]
curr_Stock_Price:  97.30893576428969
curr_Factors:  [9.73089358e+01 3.67258428e-02]
mat_Sqrt:  [[ 1.86482726e+01  0.00000000e+00]
 [-7.66559511e-03  1.75640849e-02]]
grads:  [0.00693757 5.4734925 ]
Stock Position:  0.006937574343217358
Bond Position:  [-5.1206445]


portfolio before change:  [-4.45131979]
curr_Stock_Price:  96.57047293997017
curr_Factors:  [9.65704729e+01 3.59949505e-02]
mat_Sqrt:  [[ 1.83216739e+01  0.00000000e+00]
 [-7.58893410e-03  1.73884325e-02]]
grads:  [ 0.08066404 59.75387311]
Stock Position:  0.08066404064762477
Bond Position:  [-12.24108434]


portfolio before change:  [-4.46482683]
curr_Stock_Price:  96.42199525792944
curr_Factors:  [9.64219953e+01 3.63947344e-02]
mat_Sqrt:  [[ 1.83948136e+01  0.00000000e+00]
 [-7.63096161e-03  1.74847296e-02]]
grads:  [1.40288639e-02 2.69837957e+01]
Stock Position:  0.01402886388816856
Bond Position:  [-5.81751787]


portfolio before change:  [-4.44759358]
curr_Stock_Price:  97.70224748041308
curr_Factors:  [9.77022475e+01 3.64827480e-02]
mat_Sqrt:  [[ 1.86615763e+01  0.00000000e+00]
 [-7.64018303e-03  1.75058585e-02]]
grads:  [0.01320543 6.45935378]
Stock Position:  0.013205432511702534
Bond Position:  [-5.73779401]


portfolio before change:  [-4.44133642]
curr_Stock_Price:  98.23039564777838
curr_Factors:  [9.82303956e+01 3.63595928e-02]
mat_Sqrt:  [[ 1.87307600e+01  0.00000000e+00]
 [-7.62727661e-03  1.74762862e-02]]
grads:  [-0.00423576  0.60691116]
Stock Position:  -0.004235756766192767
Bond Position:  [-4.02525636]


portfolio before change:  [-4.44422901]
curr_Stock_Price:  98.79449790872572
curr_Factors:  [9.87944979e+01 3.61607756e-02]
mat_Sqrt:  [[ 1.87867487e+01  0.00000000e+00]
 [-7.60639474e-03  1.74284398e-02]]
grads:  [-1.73424978e-03 -7.67635972e+00]
Stock Position:  -0.0017342497843358803
Bond Position:  [-4.27289467]


portfolio before change:  [-4.44394824]
curr_Stock_Price:  98.32460406895176
curr_Factors:  [9.83246041e+01 3.62377181e-02]
mat_Sqrt:  [[ 1.87172753e+01  0.00000000e+00]
 [-7.61448285e-03  1.74469720e-02]]
grads:  [-0.00691067 -1.60780937]
Stock Position:  -0.006910668687038708
Bond Position:  [-3.76445948]


portfolio before change:  [-4.45060099]
curr_Stock_Price:  99.21918664226514
curr_Factors:  [9.92191866e+01 3.57530873e-02]
mat_Sqrt:  [[ 1.87608468e+01  0.00000000e+00]
 [-7.56339472e-03  1.73299144e-02]]
grads:  [-0.00316582 -0.42317885]
Stock Position:  -0.0031658230856462634
Bond Position:  [-4.1364906]


portfolio before change:  [-4.45380283]
curr_Stock_Price:  100.06722640072297
curr_Factors:  [1.00067226e+02 3.47046508e-02]
mat_Sqrt:  [[ 1.86417080e+01  0.00000000e+00]
 [-7.45167373e-03  1.70739295e-02]]
grads:  [ 0.03016985 16.36502541]
Stock Position:  0.030169848006891445
Bond Position:  [-7.47281584]


portfolio before change:  [-4.48007452]
curr_Stock_Price:  99.22739688287817
curr_Factors:  [9.92273969e+01 3.51585212e-02]
mat_Sqrt:  [[ 1.86057379e+01  0.00000000e+00]
 [-7.50024225e-03  1.71852139e-02]]
grads:  [ 4.08744962e-03 -7.24904841e+00]
Stock Position:  0.004087449622882401
Bond Position:  [-4.88566151]


portfolio before change:  [-4.47655661]
curr_Stock_Price:  100.2374770363513
curr_Factors:  [1.00237477e+02 3.46305534e-02]
mat_Sqrt:  [[ 1.86534790e+01  0.00000000e+00]
 [-7.44371450e-03  1.70556926e-02]]
grads:  [3.62567673e-03 3.78906460e+00]
Stock Position:  0.0036256767347882923
Bond Position:  [-4.8399853]


portfolio before change:  [-4.4758208]
curr_Stock_Price:  100.6072963910988
curr_Factors:  [1.00607296e+02 3.49740598e-02]
mat_Sqrt:  [[ 1.88149255e+01  0.00000000e+00]
 [-7.48054113e-03  1.71400730e-02]]
grads:  [-1.85344150e-03 -7.47926498e+00]
Stock Position:  -0.001853441495728745
Bond Position:  [-4.28935107]


portfolio before change:  [-4.47550268]
curr_Stock_Price:  100.14635547003193
curr_Factors:  [1.00146355e+02 3.42638119e-02]
mat_Sqrt:  [[ 1.85375779e+01  0.00000000e+00]
 [-7.40419470e-03  1.69651413e-02]]
grads:  [-1.71960516e-02 -2.76618765e+01]
Stock Position:  -0.017196051562066657
Bond Position:  [-2.75338079]


portfolio before change:  [-4.4822181]
curr_Stock_Price:  100.51686093536684
curr_Factors:  [1.00516861e+02 3.43186888e-02]
mat_Sqrt:  [[ 1.86210540e+01  0.00000000e+00]
 [-7.41012160e-03  1.69787216e-02]]
grads:  [-0.00397318 -3.2231767 ]
Stock Position:  -0.003973178977938504
Bond Position:  [-4.08284663]


portfolio before change:  [-4.48288774]
curr_Stock_Price:  100.55694276000122
curr_Factors:  [1.00556943e+02 3.51255100e-02]
mat_Sqrt:  [[ 1.88461820e+01  0.00000000e+00]
 [-7.49672035e-03  1.71771442e-02]]
grads:  [ 0.00833705 -2.50126453]
Stock Position:  0.008337053831320104
Bond Position:  [-5.32123639]


portfolio before change:  [-4.47696572]
curr_Stock_Price:  101.34705602791611
curr_Factors:  [1.01347056e+02 3.48228055e-02]
mat_Sqrt:  [[ 1.89122420e+01  0.00000000e+00]
 [-7.46434785e-03  1.71029695e-02]]
grads:  [ 0.0299663 -8.5003438]
Stock Position:  0.02996630019253109
Bond Position:  [-7.51396203]


portfolio before change:  [-4.45005931]
curr_Stock_Price:  102.27629050622943
curr_Factors:  [1.02276291e+02 3.33049938e-02]
mat_Sqrt:  [[ 1.86650710e+01  0.00000000e+00]
 [-7.29986233e-03  1.67260858e-02]]
grads:  [-8.10941842e-03 -2.48958372e+01]
Stock Position:  -0.008109418420187538
Bond Position:  [-3.62065807]


portfolio before change:  [-4.44923812]
curr_Stock_Price:  102.11921355914217
curr_Factors:  [1.02119214e+02 3.37092593e-02]
mat_Sqrt:  [[ 1.87491708e+01  0.00000000e+00]
 [-7.34403260e-03  1.68272926e-02]]
grads:  [0.00331592 0.6016683 ]
Stock Position:  0.0033159190196904347
Bond Position:  [-4.78785716]


portfolio before change:  [-4.45499063]
curr_Stock_Price:  100.56489360944317
curr_Factors:  [1.00564894e+02 3.39239957e-02]
mat_Sqrt:  [[ 1.85225126e+01  0.00000000e+00]
 [-7.36738713e-03  1.68808046e-02]]
grads:  [ 0.00763934 -6.08053862]
Stock Position:  0.007639339039604938
Bond Position:  [-5.22323995]


portfolio before change:  [-4.45987208]
curr_Stock_Price:  100.01137731473617
curr_Factors:  [1.00011377e+02 3.42566875e-02]
mat_Sqrt:  [[ 1.85106680e+01  0.00000000e+00]
 [-7.40342489e-03  1.69633775e-02]]
grads:  [ 0.00631591 -5.51990772]
Stock Position:  0.0063159127619298655
Bond Position:  [-5.09153521]


portfolio before change:  [-4.46767792]
curr_Stock_Price:  98.87625076320064
curr_Factors:  [9.88762508e+01 3.45773989e-02]
mat_Sqrt:  [[ 1.83860379e+01  0.00000000e+00]
 [-7.43799961e-03  1.70425981e-02]]
grads:  [-9.93351913e-03 -2.01502412e+01]
Stock Position:  -0.009933519131840783
Bond Position:  [-3.48548879]


portfolio before change:  [-4.46456327]
curr_Stock_Price:  98.51883855901585
curr_Factors:  [9.85188386e+01 3.48524233e-02]
mat_Sqrt:  [[ 1.83922886e+01  0.00000000e+00]
 [-7.46752150e-03  1.71102413e-02]]
grads:  [4.99353175e-03 5.54702597e+00]
Stock Position:  0.004993531754469693
Bond Position:  [-4.95652022]


portfolio before change:  [-4.46138546]
curr_Stock_Price:  99.27930504955141
curr_Factors:  [9.92793050e+01 3.38334416e-02]
mat_Sqrt:  [[ 1.82613053e+01  0.00000000e+00]
 [-7.35754760e-03  1.68582594e-02]]
grads:  [0.00693783 6.04039156]
Stock Position:  0.006937833948148426
Bond Position:  [-5.1501688]


portfolio before change:  [-4.46122705]
curr_Stock_Price:  99.39493579901367
curr_Factors:  [9.93949358e+01 3.25907080e-02]
mat_Sqrt:  [[ 1.79436651e+01  0.00000000e+00]
 [-7.22115869e-03  1.65457531e-02]]
grads:  [-0.0322497  -6.77791944]
Stock Position:  -0.03224969564347982
Bond Position:  [-1.25577062]


portfolio before change:  [-4.44899983]
curr_Stock_Price:  99.01092589666119
curr_Factors:  [9.90109259e+01 3.24984488e-02]
mat_Sqrt:  [[ 1.78490225e+01  0.00000000e+00]
 [-7.21093045e-03  1.65223173e-02]]
grads:  [-0.01071784 -3.63337648]
Stock Position:  -0.010717838831252957
Bond Position:  [-3.38781668]


portfolio before change:  [-4.44343331]
curr_Stock_Price:  98.45204280272948
curr_Factors:  [9.84520428e+01 3.09848626e-02]
mat_Sqrt:  [[ 1.73300382e+01  0.00000000e+00]
 [-7.04100704e-03  1.61329739e-02]]
grads:  [-1.20247293e-03 -3.24780230e+00]
Stock Position:  -0.0012024729305952898
Bond Position:  [-4.3250474]


portfolio before change:  [-4.44439489]
curr_Stock_Price:  98.80208052423497
curr_Factors:  [9.88020805e+01 3.06475535e-02]
mat_Sqrt:  [[ 1.72967296e+01  0.00000000e+00]
 [-7.00257707e-03  1.60449197e-02]]
grads:  [6.29374215e-04 1.03280209e+01]
Stock Position:  0.0006293742145389773
Bond Position:  [-4.50657837]


portfolio before change:  [-4.44450378]
curr_Stock_Price:  99.52416845313245
curr_Factors:  [9.95241685e+01 3.06557796e-02]
mat_Sqrt:  [[ 1.74254796e+01  0.00000000e+00]
 [-7.00351679e-03  1.60470729e-02]]
grads:  [0.00145881 1.18630418]
Stock Position:  0.001458805766309412
Bond Position:  [-4.58969021]


portfolio before change:  [-4.44494056]
curr_Stock_Price:  99.61806149378071
curr_Factors:  [9.96180615e+01 3.11548562e-02]
mat_Sqrt:  [[ 1.75833233e+01  0.00000000e+00]
 [-7.06029531e-03  1.61771688e-02]]
grads:  [-1.93587280e-03  4.40519806e+00]
Stock Position:  -0.0019358727985519628
Bond Position:  [-4.25209266]


portfolio before change:  [-4.44543934]
curr_Stock_Price:  99.60113601934842
curr_Factors:  [9.96011360e+01 3.12774955e-02]
mat_Sqrt:  [[ 1.76149039e+01  0.00000000e+00]
 [-7.07417789e-03  1.62089778e-02]]
grads:  [-0.00707549  6.42532789]
Stock Position:  -0.007075488548493486
Bond Position:  [-3.74071264]


portfolio before change:  [-4.44719428]
curr_Stock_Price:  99.7830779853049
curr_Factors:  [9.97830780e+01 3.14642351e-02]
mat_Sqrt:  [[ 1.76996829e+01  0.00000000e+00]
 [-7.09526435e-03  1.62572930e-02]]
grads:  [-5.74067629e-03 -1.02884155e+01]
Stock Position:  -0.005740676292767131
Bond Position:  [-3.87437193]


portfolio before change:  [-4.44213326]
curr_Stock_Price:  98.81710372562024
curr_Factors:  [9.88171037e+01 3.23592962e-02]
mat_Sqrt:  [[ 1.77759023e+01  0.00000000e+00]
 [-7.19547593e-03  1.64869066e-02]]
grads:  [-0.0055152  -3.10705924]
Stock Position:  -0.0055152045593494445
Bond Position:  [-3.89713672]


portfolio before change:  [-4.44007145]
curr_Stock_Price:  98.35492922548964
curr_Factors:  [9.83549292e+01 3.32733555e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.44007145]
Stock Price:  98.53066258536062
PL:  [-4.44007145]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.49900268e+00  3.67795686e-01]
 [ 4.29080954e-01  1.21694878e-01]
 [ 1.11698268e-01 -4.00911695e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.41276812e-01  1.06084697e+00]
 [-5.79057563e-02 -1.14425553e-01]
 [ 9.29590834e-02  5.98509522e-02]
 [ 7.45072039e-01  7.29859091e-01]
 [ 3.92830213e-02  4.37428795e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-6.05138456e-02  1.41268229e-02]
 [ 2.56223068e-02 -1.33704545e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-6.07197127e-02  8.47510135e-03]
 [ 5.03213846e-01  3.27489065e-01]
 [ 1.30793382e-01 -1.51297690e-01]
 [ 3.95963962e-02  1.11288383e-01]
 [-1.31010999e-03 -2.42301451e-02]
 [-6.90545474e-02 -1.81956899e-01]
 [-2.55512834e-02 -6.90976083e-02]
 [ 1.73823336e-01 -4.16239800e-02]
 [ 8.53138710e-01 -8.24750831e-04]
 [ 2.12552296e-02  4.67667651e-02]
 [-8.88794879e-02  7.41518162e-02]
 [-1.47755625e-01  9.44757356e-02]
 [ 1.15799150e-01 -1.08374188e-01]
 [ 7.22092998e-02 -2.55452225e-01]
 [ 4.96258149e-02  9.66014395e-02]
 [ 1.08610355e-01  8.24062301e-02]
 [-5.09164463e-01 -1.09875520e-01]
 [-1.68133488e-01 -6.33419923e-02]
 [ 8.73996378e-03 -6.62243940e-02]
 [-1.39907999e-01  1.53174816e-01]
 [ 2.73248725e-02  2.86385531e-02]
 [-1.14821813e-01  8.54762034e-02]
 [-2.19300322e-01  8.20448975e-02]
 [-2.15997073e-02 -2.31304835e-01]
 [ 4.08604013e-03 -4.57361165e-02]
 [-4.20721146e-03 -1.07542457e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.45597308]
curr_Stock_Price:  99.25426414854682
curr_Factors:  [9.92542641e+01 4.06088264e-02]
mat_Sqrt:  [[ 2.00013539e+01  0.00000000e+00]
 [-8.06065272e-03  1.84692756e-02]]
grads:  [ 0.08297048 19.91392048]
Stock Position:  0.08297047711978084
Bond Position:  [-10.69114673]


portfolio before change:  [-2.39918914]
curr_Stock_Price:  99.95475924829316
curr_Factors:  [9.99547592e+01 4.08762122e-02]
mat_Sqrt:  [[ 2.02087197e+01  0.00000000e+00]
 [-8.08714657e-03  1.85299806e-02]]
grads:  [0.02386064 6.56745847]
Stock Position:  0.023860638420307768
Bond Position:  [-4.78417351]


portfolio before change:  [-2.40527689]
curr_Stock_Price:  99.72468636583181
curr_Factors:  [9.97246864e+01 3.92262199e-02]
mat_Sqrt:  [[ 1.97510828e+01  0.00000000e+00]
 [-7.92224412e-03  1.81521417e-02]]
grads:  [ 0.00476941 -2.20861925]
Stock Position:  0.004769411793085042
Bond Position:  [-2.88090498]


portfolio before change:  [-2.41130362]
curr_Stock_Price:  98.53657331716347
curr_Factors:  [9.85365733e+01 4.01047952e-02]
mat_Sqrt:  [[ 1.97331132e+01  0.00000000e+00]
 [-8.01047267e-03  1.83542987e-02]]
grads:  [-8.26092001e-04 -8.24803034e+00]
Stock Position:  -0.0008260920011523608
Bond Position:  [-2.32990335]


portfolio before change:  [-2.40996148]
curr_Stock_Price:  96.55931712372413
curr_Factors:  [9.65593171e+01 4.01210875e-02]
mat_Sqrt:  [[ 1.93410716e+01  0.00000000e+00]
 [-8.01209960e-03  1.83580264e-02]]
grads:  [1.66337609e-02 5.77865475e+01]
Stock Position:  0.01663376094450992
Bond Position:  [-4.01610608]


portfolio before change:  [-2.37582146]
curr_Stock_Price:  98.64195315938572
curr_Factors:  [9.86419532e+01 3.80572609e-02]
mat_Sqrt:  [[ 1.92433388e+01  0.00000000e+00]
 [-7.80330811e-03  1.78796250e-02]]
grads:  [-5.60428535e-03 -6.39977363e+00]
Stock Position:  -0.005604285345326541
Bond Position:  [-1.82300381]


portfolio before change:  [-2.38412227]
curr_Stock_Price:  100.08244466125049
curr_Factors:  [1.00082445e+02 3.58536184e-02]
mat_Sqrt:  [[ 1.89506627e+01  0.00000000e+00]
 [-7.57402069e-03  1.73542616e-02]]
grads:  [0.00628369 3.44877551]
Stock Position:  0.006283694798655188
Bond Position:  [-3.01300981]


portfolio before change:  [-2.39407174]
curr_Stock_Price:  98.55900723443355
curr_Factors:  [9.85590072e+01 3.74958563e-02]
mat_Sqrt:  [[ 1.90848152e+01  0.00000000e+00]
 [-7.74553872e-03  1.77472587e-02]]
grads:  [ 0.05573062 41.12517328]
Stock Position:  0.05573062414466918
Bond Position:  [-7.88682673]


portfolio before change:  [-2.49346771]
curr_Stock_Price:  96.79319074315002
curr_Factors:  [9.67931907e+01 3.65289814e-02]
mat_Sqrt:  [[ 1.84996532e+01  0.00000000e+00]
 [-7.64502258e-03  1.75169473e-02]]
grads:  [1.24430764e-02 2.49717480e+01]
Stock Position:  0.01244307641970641
Bond Position:  [-3.69787278]


portfolio before change:  [-2.48208769]
curr_Stock_Price:  97.7449075600376
curr_Factors:  [9.77449076e+01 3.60364699e-02]
mat_Sqrt:  [[ 1.85551838e+01  0.00000000e+00]
 [-7.59330967e-03  1.73984582e-02]]
grads:  [0.01328115 6.49922725]
Stock Position:  0.013281150402716246
Bond Position:  [-3.78025251]


portfolio before change:  [-2.48389614]
curr_Stock_Price:  97.64432183324297
curr_Factors:  [9.76443218e+01 3.43500921e-02]
mat_Sqrt:  [[ 1.80971817e+01  0.00000000e+00]
 [-7.41351114e-03  1.69864880e-02]]
grads:  [-0.00300314  0.8316506 ]
Stock Position:  -0.0030031413463333556
Bond Position:  [-2.19065644]


portfolio before change:  [-2.48800303]
curr_Stock_Price:  98.92066608323243
curr_Factors:  [9.89206661e+01 3.34844387e-02]
mat_Sqrt:  [[ 1.81012490e+01  0.00000000e+00]
 [-7.31950148e-03  1.67710848e-02]]
grads:  [-1.80822552e-03 -7.97232536e+00]
Stock Position:  -0.001808225517036681
Bond Position:  [-2.30913216]


portfolio before change:  [-2.48799149]
curr_Stock_Price:  98.75464342882991
curr_Factors:  [9.87546434e+01 3.30180805e-02]
mat_Sqrt:  [[ 1.79445857e+01  0.00000000e+00]
 [-7.26835118e-03  1.66538847e-02]]
grads:  [-0.00720824 -1.68437608]
Stock Position:  -0.007208240423405464
Bond Position:  [-1.77614427]


portfolio before change:  [-2.49034166]
curr_Stock_Price:  99.04988018791883
curr_Factors:  [9.90498802e+01 3.18875959e-02]
mat_Sqrt:  [[ 1.76874345e+01  0.00000000e+00]
 [-7.14283931e-03  1.63663009e-02]]
grads:  [-0.00322381  0.51783854]
Stock Position:  -0.0032238070147026666
Bond Position:  [-2.17102396]


portfolio before change:  [-2.49034152]
curr_Stock_Price:  98.96565356073081
curr_Factors:  [9.89656536e+01 3.13433200e-02]
mat_Sqrt:  [[ 1.75209236e+01  0.00000000e+00]
 [-7.08161789e-03  1.62260250e-02]]
grads:  [ 0.0368783  20.18295085]
Stock Position:  0.036878295181728825
Bond Position:  [-6.14002611]


portfolio before change:  [-2.47462521]
curr_Stock_Price:  99.41263376297034
curr_Factors:  [9.94126338e+01 3.24274201e-02]
mat_Sqrt:  [[ 1.79018444e+01  0.00000000e+00]
 [-7.20304604e-03  1.65042519e-02]]
grads:  [ 3.61759687e-03 -9.16719467e+00]
Stock Position:  0.003617596871333992
Bond Position:  [-2.83426004]


portfolio before change:  [-2.47753498]
curr_Stock_Price:  98.706234250871
curr_Factors:  [9.87062343e+01 3.16122650e-02]
mat_Sqrt:  [[ 1.75498088e+01  0.00000000e+00]
 [-7.11193532e-03  1.62954910e-02]]
grads:  [5.02379425e-03 6.82939739e+00]
Stock Position:  0.0050237942477326485
Bond Position:  [-2.97341479]


portfolio before change:  [-2.47477587]
curr_Stock_Price:  99.32942947936736
curr_Factors:  [9.93294295e+01 3.08360557e-02]
mat_Sqrt:  [[ 1.74424446e+01  0.00000000e+00]
 [-7.02407924e-03  1.60941874e-02]]
grads:  [-6.81384551e-04 -1.50552150e+00]
Stock Position:  -0.0006813845514555936
Bond Position:  [-2.40709434]


portfolio before change:  [-2.47514078]
curr_Stock_Price:  99.42335559607713
curr_Factors:  [9.94233556e+01 3.13053487e-02]
mat_Sqrt:  [[ 1.75912900e+01  0.00000000e+00]
 [-7.07732703e-03  1.62161934e-02]]
grads:  [-8.43980449e-03 -1.12206912e+01]
Stock Position:  -0.008439804488674076
Bond Position:  [-1.6360271]


portfolio before change:  [-2.48933804]
curr_Stock_Price:  101.08130193264664
curr_Factors:  [1.01081302e+02 2.96507794e-02]
mat_Sqrt:  [[ 1.74055954e+01  0.00000000e+00]
 [-6.88776067e-03  1.57818423e-02]]
grads:  [-3.20057721e-03 -4.37829798e+00]
Stock Position:  -0.0032005772101234417
Bond Position:  [-2.16581953]


portfolio before change:  [-2.48884145]
curr_Stock_Price:  100.84155338653993
curr_Factors:  [1.00841553e+02 2.89633560e-02]
mat_Sqrt:  [[ 1.71618447e+01  0.00000000e+00]
 [-6.80744957e-03  1.55978265e-02]]
grads:  [ 0.00906995 -2.66857566]
Stock Position:  0.009069953981864214
Bond Position:  [-3.4034697]


portfolio before change:  [-2.49896127]
curr_Stock_Price:  99.77271029321021
curr_Factors:  [9.97727103e+01 3.04512806e-02]
mat_Sqrt:  [[ 1.74106326e+01  0.00000000e+00]
 [-6.98011812e-03  1.59934598e-02]]
grads:  [ 0.04898034 -0.05156801]
Stock Position:  0.048980343219496854
Bond Position:  [-7.38586286]


portfolio before change:  [-2.56423892]
curr_Stock_Price:  98.4588289062457
curr_Factors:  [9.84588289e+01 3.09897261e-02]
mat_Sqrt:  [[ 1.73325928e+01  0.00000000e+00]
 [-7.04155961e-03  1.61342400e-02]]
grads:  [2.40390573e-03 2.89860355e+00]
Stock Position:  0.0024039057338424877
Bond Position:  [-2.80092466]


portfolio before change:  [-2.56507101]
curr_Stock_Price:  98.2583400541784
curr_Factors:  [9.82583401e+01 3.22425595e-02]
mat_Sqrt:  [[ 1.76434771e+01  0.00000000e+00]
 [-7.18248531e-03  1.64571413e-02]]
grads:  [-3.20327914e-03  4.50575314e+00]
Stock Position:  -0.0032032791401821197
Bond Position:  [-2.25032212]


portfolio before change:  [-2.56552736]
curr_Stock_Price:  98.31298456929719
curr_Factors:  [9.83129846e+01 3.18576004e-02]
mat_Sqrt:  [[ 1.75475873e+01  0.00000000e+00]
 [-7.13947902e-03  1.63586015e-02]]
grads:  [-0.00607052  5.77529415]
Stock Position:  -0.006070523080611301
Bond Position:  [-1.96871612]


portfolio before change:  [-2.56613572]
curr_Stock_Price:  98.37265884489067
curr_Factors:  [9.83726588e+01 3.16280454e-02]
mat_Sqrt:  [[ 1.74948646e+01  0.00000000e+00]
 [-7.11371018e-03  1.62995577e-02]]
grads:  [ 3.91547911e-03 -6.64890359e+00]
Stock Position:  0.0039154791137229195
Bond Position:  [-2.95131181]


portfolio before change:  [-2.5621441]
curr_Stock_Price:  99.48632951227671
curr_Factors:  [9.94863295e+01 3.23989431e-02]
mat_Sqrt:  [[ 1.79072472e+01  0.00000000e+00]
 [-7.19988257e-03  1.64970034e-02]]
grads:  [-2.19348016e-03 -1.54847652e+01]
Stock Position:  -0.0021934801602353673
Bond Position:  [-2.34392281]


portfolio before change:  [-2.56054372]
curr_Stock_Price:  98.62313953654144
curr_Factors:  [9.86231395e+01 3.25934293e-02]
mat_Sqrt:  [[ 1.78050768e+01  0.00000000e+00]
 [-7.22146016e-03  1.65464439e-02]]
grads:  [5.15505439e-03 5.83819944e+00]
Stock Position:  0.005155054394584027
Bond Position:  [-3.06895137]


portfolio before change:  [-2.55888526]
curr_Stock_Price:  99.01927622334176
curr_Factors:  [9.90192762e+01 3.33233829e-02]
mat_Sqrt:  [[ 1.80756652e+01  0.00000000e+00]
 [-7.30187734e-03  1.67307028e-02]]
grads:  [0.00799834 4.9254494 ]
Stock Position:  0.007998343657637413
Bond Position:  [-3.35087546]


portfolio before change:  [-2.55059863]
curr_Stock_Price:  100.10769087862569
curr_Factors:  [1.00107691e+02 3.24628215e-02]
mat_Sqrt:  [[ 1.80368451e+01  0.00000000e+00]
 [-7.20697679e-03  1.65132583e-02]]
grads:  [-0.03088778 -6.65377587]
Stock Position:  -0.03088777817276499
Bond Position:  [0.54150552]


portfolio before change:  [-2.55900114]
curr_Stock_Price:  100.3819158901133
curr_Factors:  [1.00381916e+02 3.19481386e-02]
mat_Sqrt:  [[ 1.79423060e+01  0.00000000e+00]
 [-7.14961690e-03  1.63818303e-02]]
grads:  [-0.01091154 -3.86660044]
Stock Position:  -0.010911540519119394
Bond Position:  [-1.4636798]


portfolio before change:  [-2.55162151]
curr_Stock_Price:  99.68883279600449
curr_Factors:  [9.96888328e+01 3.25319341e-02]
mat_Sqrt:  [[ 1.79804871e+01  0.00000000e+00]
 [-7.21464445e-03  1.65308271e-02]]
grads:  [-1.12136736e-03 -4.00611497e+00]
Stock Position:  -0.0011213673580209062
Bond Position:  [-2.4398337]


portfolio before change:  [-2.55179875]
curr_Stock_Price:  99.57490488094108
curr_Factors:  [9.95749049e+01 3.35865321e-02]
mat_Sqrt:  [[ 1.82487231e+01  0.00000000e+00]
 [-7.33065150e-03  1.67966327e-02]]
grads:  [-4.00340495e-03  9.11937640e+00]
Stock Position:  -0.004003404954363169
Bond Position:  [-2.15316008]


portfolio before change:  [-2.55283229]
curr_Stock_Price:  99.7658374033063
curr_Factors:  [9.97658374e+01 3.32906869e-02]
mat_Sqrt:  [[ 1.82030110e+01  0.00000000e+00]
 [-7.29829426e-03  1.67224929e-02]]
grads:  [0.00218776 1.71257678]
Stock Position:  0.0021877568417061873
Bond Position:  [-2.77109568]


portfolio before change:  [-2.55186625]
curr_Stock_Price:  100.3657445658617
curr_Factors:  [1.00365745e+02 3.28632324e-02]
mat_Sqrt:  [[ 1.81945220e+01  0.00000000e+00]
 [-7.25128760e-03  1.66147871e-02]]
grads:  [-4.26045488e-03  5.14458612e+00]
Stock Position:  -0.004260454881253006
Bond Position:  [-2.12426252]


portfolio before change:  [-2.55409356]
curr_Stock_Price:  100.82620167826224
curr_Factors:  [1.00826202e+02 3.24496199e-02]
mat_Sqrt:  [[ 1.81626082e+01  0.00000000e+00]
 [-7.20551121e-03  1.65099003e-02]]
grads:  [-0.01010279  4.96943629]
Stock Position:  -0.01010278871139115
Bond Position:  [-1.53546774]


portfolio before change:  [-2.56536426]
curr_Stock_Price:  101.92280526071717
curr_Factors:  [1.01922805e+02 3.21630261e-02]
mat_Sqrt:  [[ 1.82788900e+01  0.00000000e+00]
 [-7.17362124e-03  1.64368312e-02]]
grads:  [-6.70442316e-03 -1.40723496e+01]
Stock Position:  -0.00670442316394457
Bond Position:  [-1.88203064]


portfolio before change:  [-2.56583514]
curr_Stock_Price:  101.9579484865591
curr_Factors:  [1.01957948e+02 3.26163308e-02]
mat_Sqrt:  [[ 1.84135972e+01  0.00000000e+00]
 [-7.22399676e-03  1.65522560e-02]]
grads:  [-8.62125817e-04 -2.76313492e+00]
Stock Position:  -0.0008621258165571771
Bond Position:  [-2.47793456]


portfolio before change:  [-2.56453457]
curr_Stock_Price:  100.0900912652625
curr_Factors:  [1.00090091e+02 3.32506012e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.56453457]
Stock Price:  99.4815013234664
PL:  [-2.56453457]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.09248470e+00  2.75890117e-01]
 [ 5.75847494e-01  1.18933096e-01]
 [ 1.10765823e-01 -2.41233005e-02]
 [-1.62290735e-01 -1.04188447e-01]
 [-1.24947049e-01 -7.42834503e-01]
 [-4.12254733e-01  2.61728380e-01]
 [ 2.63932401e-01 -2.97356809e-01]
 [-5.41006842e-01  2.43658976e-01]
 [-1.18146409e-01 -9.82890636e-02]
 [-2.62642815e-01 -5.19497083e-01]
 [-7.25539480e-02 -1.15471837e-02]
 [-1.35195319e-01 -1.83430803e-01]
 [-5.34670302e-02 -2.38872647e-02]
 [-8.29870721e-03 -1.17976787e-01]
 [ 2.11078927e-01  1.18604819e-01]
 [ 1.35221143e-01 -4.79009302e-01]
 [ 3.52655972e-02 -8.89355624e-02]
 [ 2.85346807e-02 -1.49715168e-01]
 [-1.01811736e-01 -3.91559723e-01]
 [-4.12902246e-02 -5.98833976e-02]
 [ 1.70589720e-01 -3.95089150e-02]
 [ 5.56598785e-01 -2.09006880e-01]
 [ 2.98746706e-02 -4.03395626e-01]
 [ 5.82233535e-02  6.32882172e-03]
 [ 2.52094689e-01 -1.60262622e-01]
 [ 1.45767417e-01 -8.64774858e-02]
 [-1.60272683e-01  8.38617905e-02]
 [ 4.30740301e-03  2.80434910e-01]
 [-3.75003807e-02  1.92135964e-01]
 [-6.78768400e-01 -4.76597174e-02]
 [-1.68693754e-01 -6.39539538e-02]
 [ 3.85979364e-02 -4.76683500e-02]
 [-2.58475125e-01  4.83117438e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.16130132e-01  1.09658850e-02]
 [-2.74020233e-02 -1.77578434e-01]
 [-6.03623370e-03 -5.88046800e-02]
 [-1.15992704e-03 -3.36135555e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.70301464]
curr_Stock_Price:  101.01920158777797
curr_Factors:  [1.01019202e+02 3.95773767e-02]
mat_Sqrt:  [[ 2.00968242e+01  0.00000000e+00]
 [-7.95762544e-03  1.82332105e-02]]
grads:  [ 0.06035247 15.13118697]
Stock Position:  0.060352471753807514
Bond Position:  [3.60625613]


portfolio before change:  [9.61839646]
curr_Stock_Price:  99.60966545514684
curr_Factors:  [9.96096655e+01 4.06532102e-02]
mat_Sqrt:  [[ 2.00839395e+01  0.00000000e+00]
 [-8.06505650e-03  1.84793659e-02]]
grads:  [0.03125652 6.43599443]
Stock Position:  0.031256524800211655
Bond Position:  [6.50494449]


portfolio before change:  [9.63196313]
curr_Stock_Price:  100.01769213995566
curr_Factors:  [1.00017692e+02 4.08436654e-02]
mat_Sqrt:  [[ 2.02133913e+01  0.00000000e+00]
 [-8.08392632e-03  1.85226021e-02]]
grads:  [ 0.00495897 -1.30237103]
Stock Position:  0.004958967533016277
Bond Position:  [9.13597864]


portfolio before change:  [9.65197703]
curr_Stock_Price:  103.82328983443574
curr_Factors:  [1.03823290e+02 3.96093955e-02]
mat_Sqrt:  [[ 2.06630246e+01  0.00000000e+00]
 [-7.96084373e-03  1.82405845e-02]]
grads:  [-0.01005479 -5.71190287]
Stock Position:  -0.01005478648866253
Bond Position:  [10.69589805]


portfolio before change:  [9.65353624]
curr_Stock_Price:  103.8011969016766
curr_Factors:  [1.03801197e+02 3.99922216e-02]
mat_Sqrt:  [[ 2.07582208e+01  0.00000000e+00]
 [-7.99922212e-03  1.83285204e-02]]
grads:  [-2.16370473e-02 -4.05288853e+01]
Stock Position:  -0.021637047325550433
Bond Position:  [11.89948765]


portfolio before change:  [9.65607384]
curr_Stock_Price:  103.75266593457943
curr_Factors:  [1.03752666e+02 3.85087419e-02]
mat_Sqrt:  [[ 2.03600542e+01  0.00000000e+00]
 [-7.84945775e-03  1.79853672e-02]]
grads:  [-0.01463783 14.55229564]
Stock Position:  -0.014637834464888106
Bond Position:  [11.17478819]


portfolio before change:  [9.6725832]
curr_Stock_Price:  102.72024390871081
curr_Factors:  [1.02720244e+02 3.90174134e-02]
mat_Sqrt:  [[ 2.02901510e+01  0.00000000e+00]
 [-7.90113039e-03  1.81037641e-02]]
grads:  [ 6.61184087e-03 -1.64251372e+01]
Stock Position:  0.006611840870946016
Bond Position:  [8.99341329]


portfolio before change:  [9.67359065]
curr_Stock_Price:  102.70257932608435
curr_Factors:  [1.02702579e+02 3.94526409e-02]
mat_Sqrt:  [[ 2.03994938e+01  0.00000000e+00]
 [-7.94507554e-03  1.82044550e-02]]
grads:  [-0.02130765 13.38457949]
Stock Position:  -0.021307653598494587
Bond Position:  [11.86194163]


portfolio before change:  [9.68141793]
curr_Stock_Price:  102.40482483871807
curr_Factors:  [1.02404825e+02 3.94388324e-02]
mat_Sqrt:  [[ 2.03367919e+01  0.00000000e+00]
 [-7.94368503e-03  1.82012690e-02]]
grads:  [-0.00791881 -5.40012148]
Stock Position:  -0.007918814081620944
Bond Position:  [10.4923427]


portfolio before change:  [9.67707325]
curr_Stock_Price:  103.1191125353477
curr_Factors:  [1.03119113e+02 3.91326585e-02]
mat_Sqrt:  [[ 2.03989984e+01  0.00000000e+00]
 [-7.91279051e-03  1.81304807e-02]]
grads:  [-2.39899000e-02 -2.86532437e+01]
Stock Position:  -0.02398989997509574
Bond Position:  [12.15089044]


portfolio before change:  [9.66340644]
curr_Stock_Price:  103.75211915748038
curr_Factors:  [1.03752119e+02 3.86571044e-02]
mat_Sqrt:  [[ 2.03991296e+01  0.00000000e+00]
 [-7.86456401e-03  1.80199799e-02]]
grads:  [-0.00380377 -0.64079892]
Stock Position:  -0.0038037677973017416
Bond Position:  [10.05805541]


portfolio before change:  [9.66471111]
curr_Stock_Price:  103.73967571453795
curr_Factors:  [1.03739676e+02 3.88822553e-02]
mat_Sqrt:  [[ 2.04559951e+01  0.00000000e+00]
 [-7.88743358e-03  1.80723807e-02]]
grads:  [ -0.01052264 -10.14978636]
Stock Position:  -0.010522640632226339
Bond Position:  [10.75632643]


portfolio before change:  [9.66529878]
curr_Stock_Price:  103.81161116109182
curr_Factors:  [1.03811611e+02 3.94265976e-02]
mat_Sqrt:  [[ 2.06129705e+01  0.00000000e+00]
 [-7.94245278e-03  1.81984455e-02]]
grads:  [-0.00309962 -1.31259918]
Stock Position:  -0.003099615713904242
Bond Position:  [9.98707488]


portfolio before change:  [9.67091633]
curr_Stock_Price:  102.4020527311344
curr_Factors:  [1.02402053e+02 4.03782107e-02]
mat_Sqrt:  [[ 2.05770066e+01  0.00000000e+00]
 [-8.03773209e-03  1.84167579e-02]]
grads:  [-2.90557316e-03 -6.40594766e+00]
Stock Position:  -0.002905573163392897
Bond Position:  [9.96845299]


portfolio before change:  [9.6714604]
curr_Stock_Price:  102.64368001731815
curr_Factors:  [1.02643680e+02 4.06050561e-02]
mat_Sqrt:  [[ 2.06834162e+01  0.00000000e+00]
 [-8.06027852e-03  1.84684182e-02]]
grads:  [0.01270788 6.42203451]
Stock Position:  0.012707877205002636
Bond Position:  [8.36707712]


portfolio before change:  [9.66143333]
curr_Stock_Price:  101.77232913705731
curr_Factors:  [1.01772329e+02 4.24092395e-02]
mat_Sqrt:  [[ 2.09584884e+01  0.00000000e+00]
 [-8.23740148e-03  1.88742579e-02]]
grads:  [-3.52294758e-03 -2.53789741e+01]
Stock Position:  -0.0035229475805224376
Bond Position:  [10.01997191]


portfolio before change:  [9.66321412]
curr_Stock_Price:  101.62239383361076
curr_Factors:  [1.01622394e+02 4.14376333e-02]
mat_Sqrt:  [[ 2.06864940e+01  0.00000000e+00]
 [-8.14249429e-03  1.86567982e-02]]
grads:  [-1.71564327e-04 -4.76692525e+00]
Stock Position:  -0.00017156432689221225
Bond Position:  [9.6806489]


portfolio before change:  [9.66447239]
curr_Stock_Price:  101.34197736462109
curr_Factors:  [1.01341977e+02 4.13200889e-02]
mat_Sqrt:  [[ 2.06001317e+01  0.00000000e+00]
 [-8.13093735e-03  1.86303179e-02]]
grads:  [-1.78670583e-03 -8.03610376e+00]
Stock Position:  -0.0017867058326070482
Bond Position:  [9.84554069]


portfolio before change:  [9.66835311]
curr_Stock_Price:  99.85882847480624
curr_Factors:  [9.98588285e+01 4.17373053e-02]
mat_Sqrt:  [[ 2.04008691e+01  0.00000000e+00]
 [-8.17188402e-03  1.87241386e-02]]
grads:  [-1.33671956e-02 -2.09120287e+01]
Stock Position:  -0.013367195636167986
Bond Position:  [11.0031856]


portfolio before change:  [9.65819247]
curr_Stock_Price:  100.72184540069753
curr_Factors:  [1.00721845e+02 4.15630862e-02]
mat_Sqrt:  [[ 2.05341896e+01  0.00000000e+00]
 [-8.15481072e-03  1.86850187e-02]]
grads:  [-0.00328357 -3.20488829]
Stock Position:  -0.003283571604014609
Bond Position:  [9.98891987]


portfolio before change:  [9.65771644]
curr_Stock_Price:  101.24710381905605
curr_Factors:  [1.01247104e+02 4.09352927e-02]
mat_Sqrt:  [[ 2.04847920e+01  0.00000000e+00]
 [-8.09298884e-03  1.85433670e-02]]
grads:  [ 0.00748588 -2.13062251]
Stock Position:  0.0074858761231700165
Bond Position:  [8.89979317]


portfolio before change:  [9.66499034]
curr_Stock_Price:  102.07016775771062
curr_Factors:  [1.02070168e+02 4.09190583e-02]
mat_Sqrt:  [[ 2.06472228e+01  0.00000000e+00]
 [-8.09138389e-03  1.85396896e-02]]
grads:  [  0.02253963 -11.27348325]
Stock Position:  0.0225396271934769
Bond Position:  [7.36436681]


portfolio before change:  [9.68028154]
curr_Stock_Price:  102.70773788575717
curr_Factors:  [1.02707738e+02 4.03956244e-02]
mat_Sqrt:  [[ 2.06428819e+01  0.00000000e+00]
 [-8.03946510e-03  1.84207287e-02]]
grads:  [-7.08145381e-03 -2.18990048e+01]
Stock Position:  -0.007081453814879238
Bond Position:  [10.40760164]


portfolio before change:  [9.68894649]
curr_Stock_Price:  101.66784943220196
curr_Factors:  [1.01667849e+02 3.94457721e-02]
mat_Sqrt:  [[ 2.01922106e+01  0.00000000e+00]
 [-7.94438389e-03  1.82028703e-02]]
grads:  [0.00302025 0.34768263]
Stock Position:  0.0030202476997098857
Bond Position:  [9.3818844]


portfolio before change:  [9.68894621]
curr_Stock_Price:  101.2794398070033
curr_Factors:  [1.0127944e+02 3.9047744e-02]
mat_Sqrt:  [[ 2.00133258e+01  0.00000000e+00]
 [-7.90420081e-03  1.81107993e-02]]
grads:  [ 0.00910145 -8.84900878]
Stock Position:  0.00910145314803305
Bond Position:  [8.76715613]


portfolio before change:  [9.69021242]
curr_Stock_Price:  101.29814578119503
curr_Factors:  [1.01298146e+02 4.01152162e-02]
mat_Sqrt:  [[ 2.02887861e+01  0.00000000e+00]
 [-8.01151333e-03  1.83566831e-02]]
grads:  [ 0.0053244  -4.71095378]
Stock Position:  0.005324396813810314
Bond Position:  [9.1508609]


portfolio before change:  [9.70090565]
curr_Stock_Price:  103.09164381019558
curr_Factors:  [1.03091644e+02 3.95146399e-02]
mat_Sqrt:  [[ 2.04928556e+01  0.00000000e+00]
 [-7.95131586e-03  1.82187534e-02]]
grads:  [-0.0060349   4.60304768]
Stock Position:  -0.006034903075941329
Bond Position:  [10.32305372]


portfolio before change:  [9.70777681]
curr_Stock_Price:  102.16690662283803
curr_Factors:  [1.02166907e+02 4.06469625e-02]
mat_Sqrt:  [[ 2.05979639e+01  0.00000000e+00]
 [-8.06443674e-03  1.84779459e-02]]
grads:  [6.15105612e-03 1.51767362e+01]
Stock Position:  0.006151056122712684
Bond Position:  [9.07934243]


portfolio before change:  [9.71043544]
curr_Stock_Price:  102.41461170493075
curr_Factors:  [1.02414612e+02 4.05953209e-02]
mat_Sqrt:  [[ 2.06347833e+01  0.00000000e+00]
 [-8.05931222e-03  1.84662041e-02]]
grads:  [2.24643157e-03 1.04047352e+01]
Stock Position:  0.0022464315666701107
Bond Position:  [9.48036803]


portfolio before change:  [9.7138218]
curr_Stock_Price:  103.39449176869554
curr_Factors:  [1.03394492e+02 4.14821338e-02]
mat_Sqrt:  [[ 2.10585249e+01  0.00000000e+00]
 [-8.14686529e-03  1.86668134e-02]]
grads:  [-0.03322022 -2.55317907]
Stock Position:  -0.03322021885598746
Bond Position:  [13.14860944]


portfolio before change:  [9.78187347]
curr_Stock_Price:  101.39546843936738
curr_Factors:  [1.01395468e+02 4.19378214e-02]
mat_Sqrt:  [[ 2.07645001e+01  0.00000000e+00]
 [-8.19149036e-03  1.87690623e-02]]
grads:  [-0.00946835 -3.40741337]
Stock Position:  -0.009468349689170411
Bond Position:  [10.74192122]


portfolio before change:  [9.77426095]
curr_Stock_Price:  102.34128744191699
curr_Factors:  [1.02341287e+02 4.22580701e-02]
mat_Sqrt:  [[ 2.10380608e+01  0.00000000e+00]
 [-8.22270711e-03  1.88405889e-02]]
grads:  [ 8.45789117e-04 -2.53008812e+00]
Stock Position:  0.0008457891165353666
Bond Position:  [9.6877018]


portfolio before change:  [9.77672826]
curr_Stock_Price:  103.82660932562615
curr_Factors:  [1.03826609e+02 4.17869142e-02]
mat_Sqrt:  [[ 2.12240775e+01  0.00000000e+00]
 [-8.17673912e-03  1.87352630e-02]]
grads:  [-0.01118495  2.57865309]
Stock Position:  -0.011184945578583481
Bond Position:  [10.93802323]


portfolio before change:  [9.78057474]
curr_Stock_Price:  103.60495927859598
curr_Factors:  [1.03604959e+02 4.13042278e-02]
mat_Sqrt:  [[ 2.10560934e+01  0.00000000e+00]
 [-8.12937664e-03  1.86267419e-02]]
grads:  [0.00481909 2.86411124]
Stock Position:  0.004819088225542369
Bond Position:  [9.2812933]


portfolio before change:  [9.78301596]
curr_Stock_Price:  103.87077430542675
curr_Factors:  [1.03870774e+02 4.15979231e-02]
mat_Sqrt:  [[ 2.11850353e+01  0.00000000e+00]
 [-8.15822756e-03  1.86928477e-02]]
grads:  [-0.00446861  4.35060231]
Stock Position:  -0.004468607640432344
Bond Position:  [10.24717369]


portfolio before change:  [9.78362224]
curr_Stock_Price:  104.02176012657466
curr_Factors:  [1.0402176e+02 4.1089915e-02]
mat_Sqrt:  [[ 2.10858843e+01  0.00000000e+00]
 [-8.10825900e-03  1.85783553e-02]]
grads:  [-0.01476553  0.59025058]
Stock Position:  -0.014765528589230833
Bond Position:  [11.31955851]


portfolio before change:  [9.78169609]
curr_Stock_Price:  104.24804247714454
curr_Factors:  [1.04248042e+02 4.15604602e-02]
mat_Sqrt:  [[ 2.12524049e+01  0.00000000e+00]
 [-8.15455310e-03  1.86844284e-02]]
grads:  [-4.93608163e-03 -9.50408703e+00]
Stock Position:  -0.004936081627659573
Bond Position:  [10.29627294]


portfolio before change:  [9.78613383]
curr_Stock_Price:  103.60975828337003
curr_Factors:  [1.03609758e+02 4.18702014e-02]
mat_Sqrt:  [[ 2.12008457e+01  0.00000000e+00]
 [-8.18488376e-03  1.87539247e-02]]
grads:  [-1.49525640e-03 -3.13559327e+00]
Stock Position:  -0.0014952563960303057
Bond Position:  [9.94105698]


portfolio before change:  [9.78794478]
curr_Stock_Price:  103.22972903823454
curr_Factors:  [1.03229729e+02 4.37349639e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.78794478]
Stock Price:  103.71626387901811
PL:  [6.0716809]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.15363041e+00  2.89713938e-01]
 [ 2.57172092e-01  1.04354272e-01]
 [-1.94420571e-02 -6.24224301e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.86300153e-02  4.24291503e-01]
 [-3.98407550e-02 -1.14098735e-01]
 [ 8.75910643e-02  9.58698795e-02]
 [ 7.24384740e-01  7.08788991e-01]
 [-1.30469883e-02  2.97450430e-01]
 [ 1.81904480e-01  4.74115884e-02]
 [-1.10316812e-01 -1.32459808e-03]
 [ 1.38099342e-02 -1.35949679e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-3.86950632e-02 -4.10142416e-02]
 [ 3.00746928e-01  1.78561624e-01]
 [ 1.08600231e-01 -7.85765576e-01]
 [ 1.40307611e-02 -3.86657899e-01]
 [ 9.16030185e-02 -2.12641809e-01]
 [-9.82091385e-02 -6.80490223e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 6.34520219e-02 -3.26278721e-03]
 [ 2.45675676e-01 -6.44059920e-01]
 [ 2.75006270e-02 -3.57264140e-01]
 [ 1.31217964e-02  1.45837986e-01]
 [ 4.79704426e-01 -5.23739023e-01]
 [-4.50333640e-01  6.25943987e-02]
 [-1.40122501e-01  1.44768092e-01]
 [-7.56901098e-02 -3.39281673e-02]
 [-7.18763440e-02  2.08907417e-01]
 [-7.58921105e-01 -9.81146782e-03]
 [-1.56689847e-01 -3.49610346e-02]
 [ 4.37872455e-02 -4.18749547e-02]
 [-2.76499065e-01  1.01207571e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.14551462e-01  1.25073876e-02]
 [-2.60736271e-02 -1.89878685e-01]
 [-9.68017541e-03 -6.28540206e-02]
 [ 7.01120150e-02 -2.64080153e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.87502163]
curr_Stock_Price:  100.7538593257363
curr_Factors:  [1.00753859e+02 3.97690709e-02]
mat_Sqrt:  [[ 2.00925202e+01  0.00000000e+00]
 [-7.97687367e-03  1.82773137e-02]]
grads:  [ 0.06370888 15.85101306]
Stock Position:  0.06370887929257682
Bond Position:  [1.45610617]


portfolio before change:  [7.85827496]
curr_Stock_Price:  100.48813983367901
curr_Factors:  [1.00488140e+02 3.96329916e-02]
mat_Sqrt:  [[ 2.00052155e+01  0.00000000e+00]
 [-7.96321459e-03  1.82460168e-02]]
grads:  [0.01513186 5.7192906 ]
Stock Position:  0.015131855512772801
Bond Position:  [6.33770295]


portfolio before change:  [7.86770454]
curr_Stock_Price:  101.05894337232819
curr_Factors:  [1.01058943e+02 3.93441873e-02]
mat_Sqrt:  [[ 2.00454146e+01  0.00000000e+00]
 [-7.93414769e-03  1.81794162e-02]]
grads:  [-2.32898347e-03 -3.43368728e+00]
Stock Position:  -0.0023289834661345318
Bond Position:  [8.10306915]


portfolio before change:  [7.86956469]
curr_Stock_Price:  100.69518161103784
curr_Factors:  [1.00695182e+02 3.88201853e-02]
mat_Sqrt:  [[ 1.98398092e+01  0.00000000e+00]
 [-7.88113548e-03  1.80579500e-02]]
grads:  [-8.21649381e-04 -8.38338863e+00]
Stock Position:  -0.000821649380659138
Bond Position:  [7.95230082]


portfolio before change:  [7.87246339]
curr_Stock_Price:  98.37715940453715
curr_Factors:  [9.83771594e+01 4.12039110e-02]
mat_Sqrt:  [[ 1.99693302e+01  0.00000000e+00]
 [-8.11949860e-03  1.86041085e-02]]
grads:  [4.83471289e-03 2.28063336e+01]
Stock Position:  0.004834712887881776
Bond Position:  [7.39683807]


portfolio before change:  [7.87398415]
curr_Stock_Price:  98.50045461076182
curr_Factors:  [9.85004546e+01 4.13017384e-02]
mat_Sqrt:  [[ 2.00180791e+01  0.00000000e+00]
 [-8.12913166e-03  1.86261806e-02]]
grads:  [-4.47782853e-03 -6.12571831e+00]
Stock Position:  -0.00447782852952262
Bond Position:  [8.31505229]


portfolio before change:  [7.87202289]
curr_Stock_Price:  99.17057849444993
curr_Factors:  [9.91705785e+01 4.20340578e-02]
mat_Sqrt:  [[ 2.03321594e+01  0.00000000e+00]
 [-8.20088364e-03  1.87905850e-02]]
grads:  [0.00636588 5.10201675]
Stock Position:  0.006365881147616439
Bond Position:  [7.24071478]


portfolio before change:  [7.86988137]
curr_Stock_Price:  98.69198435713932
curr_Factors:  [9.86919844e+01 4.19161236e-02]
mat_Sqrt:  [[ 2.02056319e+01  0.00000000e+00]
 [-8.18937103e-03  1.87642063e-02]]
grads:  [ 0.05116027 37.77345968]
Stock Position:  0.05116027155600046
Bond Position:  [2.82077265]


portfolio before change:  [7.8500018]
curr_Stock_Price:  98.29651766211197
curr_Factors:  [9.82965177e+01 4.22489007e-02]
mat_Sqrt:  [[ 2.02043945e+01  0.00000000e+00]
 [-8.22181495e-03  1.88385447e-02]]
grads:  [5.77948637e-03 1.57894591e+01]
Stock Position:  0.005779486365153882
Bond Position:  [7.28189842]


portfolio before change:  [7.85776405]
curr_Stock_Price:  99.4820816309084
curr_Factors:  [9.94820816e+01 3.96183724e-02]
mat_Sqrt:  [[ 1.98012761e+01  0.00000000e+00]
 [-7.96174578e-03  1.82426514e-02]]
grads:  [0.01023149 2.59894176]
Stock Position:  0.010231491772306697
Bond Position:  [6.83991395]


portfolio before change:  [7.8601438]
curr_Stock_Price:  99.6311031537137
curr_Factors:  [9.96311032e+01 3.98596680e-02]
mat_Sqrt:  [[ 1.98912363e+01  0.00000000e+00]
 [-7.98595447e-03  1.82981204e-02]]
grads:  [-0.00557506 -0.07238984]
Stock Position:  -0.005575063923159874
Bond Position:  [8.41559357]


portfolio before change:  [7.85672413]
curr_Stock_Price:  100.43319092621014
curr_Factors:  [1.00433191e+02 4.04906253e-02]
mat_Sqrt:  [[ 2.02094504e+01  0.00000000e+00]
 [-8.04891300e-03  1.84423765e-02]]
grads:  [-2.25257834e-03 -7.37159222e+00]
Stock Position:  -0.002252578339811958
Bond Position:  [8.08295776]


portfolio before change:  [7.85884632]
curr_Stock_Price:  99.93963939817924
curr_Factors:  [9.99396394e+01 4.20225576e-02]
mat_Sqrt:  [[ 2.04870307e+01  0.00000000e+00]
 [-8.19976172e-03  1.87880144e-02]]
grads:  [-0.0063137  -1.49304789]
Stock Position:  -0.006313696205047897
Bond Position:  [8.48983484]


portfolio before change:  [7.85314336]
curr_Stock_Price:  101.0110020893005
curr_Factors:  [1.01011002e+02 4.04635140e-02]
mat_Sqrt:  [[ 2.03189133e+01  0.00000000e+00]
 [-8.04621789e-03  1.84362013e-02]]
grads:  [-0.00278534 -2.22465794]
Stock Position:  -0.0027853431379766943
Bond Position:  [8.13449366]


portfolio before change:  [7.85194884]
curr_Stock_Price:  101.80494051054816
curr_Factors:  [1.01804941e+02 4.08996642e-02]
mat_Sqrt:  [[ 2.05886905e+01  0.00000000e+00]
 [-8.08946616e-03  1.85352955e-02]]
grads:  [0.01839251 9.63360009]
Stock Position:  0.018392505779730294
Bond Position:  [5.97950089]


portfolio before change:  [7.89523475]
curr_Stock_Price:  104.11775316072449
curr_Factors:  [1.04117753e+02 3.98864160e-02]
mat_Sqrt:  [[ 2.07939643e+01  0.00000000e+00]
 [-7.98863353e-03  1.83042589e-02]]
grads:  [-1.12694231e-02 -4.29280191e+01]
Stock Position:  -0.011269423068116478
Bond Position:  [9.06858176]


portfolio before change:  [7.86787454]
curr_Stock_Price:  106.64617442381989
curr_Factors:  [1.06646174e+02 3.94782502e-02]
mat_Sqrt:  [[ 2.11896717e+01  0.00000000e+00]
 [-7.94765376e-03  1.82103625e-02]]
grads:  [-7.30169786e-03 -2.12328502e+01]
Stock Position:  -0.007301697856327207
Bond Position:  [8.64657269]


portfolio before change:  [7.85076098]
curr_Stock_Price:  109.13798611625863
curr_Factors:  [1.09137986e+02 3.79269098e-02]
mat_Sqrt:  [[ 2.12544399e+01  0.00000000e+00]
 [-7.78993297e-03  1.78489788e-02]]
grads:  [-5.6528198e-05 -1.1913388e+01]
Stock Position:  -5.652819797692448e-05
Bond Position:  [7.85693035]


portfolio before change:  [7.85176391]
curr_Stock_Price:  108.7708056233992
curr_Factors:  [1.08770806e+02 4.01990881e-02]
mat_Sqrt:  [[ 2.18082314e+01  0.00000000e+00]
 [-8.01988410e-03  1.83758630e-02]]
grads:  [-0.00586513 -3.70317423]
Stock Position:  -0.005865132508368602
Bond Position:  [8.4897191]


portfolio before change:  [7.85104718]
curr_Stock_Price:  109.07395499221045
curr_Factors:  [1.09073955e+02 4.09996462e-02]
mat_Sqrt:  [[ 2.20856973e+01  0.00000000e+00]
 [-8.09934775e-03  1.85579371e-02]]
grads:  [-2.19422866e-04 -5.87852997e+00]
Stock Position:  -0.00021942286646213036
Bond Position:  [7.8749805]


portfolio before change:  [7.85210967]
curr_Stock_Price:  108.71821093993199
curr_Factors:  [1.08718211e+02 4.06010717e-02]
mat_Sqrt:  [[ 2.19064016e+01  0.00000000e+00]
 [-8.05988304e-03  1.84675121e-02]]
grads:  [ 0.0028315  -0.17667714]
Stock Position:  0.002831502220944289
Bond Position:  [7.54427382]


portfolio before change:  [7.85330047]
curr_Stock_Price:  108.80569420905813
curr_Factors:  [1.08805694e+02 4.05992765e-02]
mat_Sqrt:  [[ 2.19235445e+01  0.00000000e+00]
 [-8.05970486e-03  1.84671038e-02]]
grads:  [-1.61539197e-03 -3.48760654e+01]
Stock Position:  -0.0016153919702511245
Bond Position:  [8.02906432]


portfolio before change:  [7.85357968]
curr_Stock_Price:  109.254185124277
curr_Factors:  [1.09254185e+02 3.92003767e-02]
mat_Sqrt:  [[ 2.16313290e+01  0.00000000e+00]
 [-7.91963400e-03  1.81461611e-02]]
grads:  [-5.93686254e-03 -1.96881388e+01]
Stock Position:  -0.005936862541407122
Bond Position:  [8.50220676]


portfolio before change:  [7.86786761]
curr_Stock_Price:  107.02656209224028
curr_Factors:  [1.07026562e+02 3.99759533e-02]
mat_Sqrt:  [[ 2.13988774e+01  0.00000000e+00]
 [-7.99759497e-03  1.83247922e-02]]
grads:  [3.58760464e-03 7.95850697e+00]
Stock Position:  0.003587604639870787
Bond Position:  [7.48389862]


portfolio before change:  [7.87055892]
curr_Stock_Price:  107.51595854788079
curr_Factors:  [1.07515959e+02 4.09710467e-02]
mat_Sqrt:  [[ 2.17626341e+01  0.00000000e+00]
 [-8.09652238e-03  1.85514633e-02]]
grads:  [ 1.15393190e-02 -2.82316825e+01]
Stock Position:  0.011539318970038149
Bond Position:  [6.62989798]


portfolio before change:  [7.85398347]
curr_Stock_Price:  106.00770334313414
curr_Factors:  [1.06007703e+02 4.04013902e-02]
mat_Sqrt:  [[ 2.13076513e+01  0.00000000e+00]
 [-8.04003882e-03  1.84220432e-02]]
grads:  [-0.01985274  3.39779892]
Stock Position:  -0.019852737398778363
Bond Position:  [9.95852657]


portfolio before change:  [7.87072261]
curr_Stock_Price:  105.22724434215118
curr_Factors:  [1.05227244e+02 4.07049359e-02]
mat_Sqrt:  [[ 2.12300851e+01  0.00000000e+00]
 [-8.07018571e-03  1.84911184e-02]]
grads:  [-3.62412705e-03  7.82906085e+00]
Stock Position:  -0.0036241270541239505
Bond Position:  [8.25207952]


portfolio before change:  [7.87206739]
curr_Stock_Price:  105.14082409458028
curr_Factors:  [1.05140824e+02 4.14165772e-02]
mat_Sqrt:  [[ 2.13972755e+01  0.00000000e+00]
 [-8.14042527e-03  1.86520575e-02]]
grads:  [-0.0042294 -1.819004 ]
Stock Position:  -0.004229397139016005
Bond Position:  [8.31674969]


portfolio before change:  [7.87420529]
curr_Stock_Price:  104.88115522517126
curr_Factors:  [1.04881155e+02 4.13356295e-02]
mat_Sqrt:  [[ 2.13235614e+01  0.00000000e+00]
 [-8.13246624e-03  1.86338211e-02]]
grads:  [9.05023656e-04 1.12111958e+01]
Stock Position:  0.0009050236557481268
Bond Position:  [7.77928536]


portfolio before change:  [7.87498501]
curr_Stock_Price:  104.66817781807403
curr_Factors:  [1.04668178e+02 4.02735752e-02]
mat_Sqrt:  [[ 2.10051001e+01  0.00000000e+00]
 [-8.02731090e-03  1.83928799e-02]]
grads:  [-0.03633418 -0.53343837]
Stock Position:  -0.036334184371156306
Bond Position:  [11.67801788]


portfolio before change:  [7.9221696]
curr_Stock_Price:  103.40972793385787
curr_Factors:  [1.03409728e+02 4.09209502e-02]
mat_Sqrt:  [[ 2.09186787e+01  0.00000000e+00]
 [-8.09157094e-03  1.85401182e-02]]
grads:  [-0.00821984 -1.88569643]
Stock Position:  -0.00821983528373571
Bond Position:  [8.77218053]


portfolio before change:  [7.93061919]
curr_Stock_Price:  102.515184995991
curr_Factors:  [1.02515185e+02 4.12528326e-02]
mat_Sqrt:  [[ 2.08216474e+01  0.00000000e+00]
 [-8.12431734e-03  1.86151496e-02]]
grads:  [ 1.22524008e-03 -2.24950944e+00]
Stock Position:  0.0012252400824318249
Bond Position:  [7.80501348]


portfolio before change:  [7.93168442]
curr_Stock_Price:  102.58826787266982
curr_Factors:  [1.02588268e+02 4.23754149e-02]
mat_Sqrt:  [[ 2.11180921e+01  0.00000000e+00]
 [-8.23411585e-03  1.88667296e-02]]
grads:  [-0.01100139  5.36434098]
Stock Position:  -0.011001394381769761
Bond Position:  [9.06029842]


portfolio before change:  [7.91765168]
curr_Stock_Price:  103.96676083821595
curr_Factors:  [1.03966761e+02 4.15844047e-02]
mat_Sqrt:  [[ 2.12011666e+01  0.00000000e+00]
 [-8.15690184e-03  1.86898101e-02]]
grads:  [0.00478611 2.85444639]
Stock Position:  0.004786112661062822
Bond Position:  [7.42005505]


portfolio before change:  [7.92150282]
curr_Stock_Price:  104.57760495254674
curr_Factors:  [1.04577605e+02 4.04384805e-02]
mat_Sqrt:  [[ 2.10298466e+01  0.00000000e+00]
 [-8.04372854e-03  1.84304975e-02]]
grads:  [-0.00450158  4.41253126]
Stock Position:  -0.0045015835063171505
Bond Position:  [8.39226764]


portfolio before change:  [7.92532239]
curr_Stock_Price:  103.96216199780142
curr_Factors:  [1.03962162e+02 3.95043930e-02]
mat_Sqrt:  [[ 2.06632200e+01  0.00000000e+00]
 [-7.95028483e-03  1.82163910e-02]]
grads:  [-0.0149586   0.68660074]
Stock Position:  -0.014958597480436755
Bond Position:  [9.48045052]


portfolio before change:  [7.936978]
curr_Stock_Price:  103.26219757288193
curr_Factors:  [1.03262198e+02 4.07467653e-02]
mat_Sqrt:  [[ 2.08443296e+01  0.00000000e+00]
 [-8.07433121e-03  1.85006170e-02]]
grads:  [-5.22652833e-03 -1.02633704e+01]
Stock Position:  -0.00522652833431795
Bond Position:  [8.4766808]


portfolio before change:  [7.93074497]
curr_Stock_Price:  104.65751805430381
curr_Factors:  [1.04657518e+02 4.13996083e-02]
mat_Sqrt:  [[ 2.12945539e+01  0.00000000e+00]
 [-8.13875748e-03  1.86482361e-02]]
grads:  [-1.74278921e-03 -3.37050755e+00]
Stock Position:  -0.0017427892144649898
Bond Position:  [8.11314096]


portfolio before change:  [7.9323133]
curr_Stock_Price:  104.33956558161522
curr_Factors:  [1.04339566e+02 4.03824680e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.9323133]
Stock Price:  103.85485024677696
PL:  [4.07746305]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.02107243e+00  2.59745233e-01]
 [ 3.46326934e-01  1.13404115e-01]
 [-3.99102184e-01 -1.56679540e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.05767911e-01 -1.73686123e-01]
 [-3.64270257e-01  1.96909482e-01]
 [ 2.17392242e-01 -2.34462885e-01]
 [-7.71701597e-02  3.67531115e-01]
 [-1.16891649e-01 -1.04876839e-01]
 [-4.68428558e-01 -6.81468035e-01]
 [-2.66269540e-02 -1.84424920e-02]
 [-3.33732520e-01 -2.94196959e-01]
 [-1.11694242e-02  2.58675832e-02]
 [ 2.26837342e-02 -1.94788220e-01]
 [-2.97522535e-02 -8.91783763e-02]
 [ 1.00888556e-01 -8.76150652e-01]
 [ 1.96908430e-02 -2.76632375e-01]
 [ 3.87359213e-02 -1.60837890e-01]
 [-1.17931839e-01 -4.29846349e-01]
 [-8.52645896e-03 -7.90646270e-02]
 [ 1.55689849e-01 -3.32477845e-02]
 [ 3.67202223e-01 -3.66289653e-01]
 [ 2.74434827e-02 -3.38923735e-01]
 [ 5.16163368e-02  1.79755473e-02]
 [ 3.48420778e-01 -2.50414299e-01]
 [ 7.04394161e-02 -8.32205546e-02]
 [-1.87840419e-01 -7.40806245e-03]
 [ 5.05167181e-02  1.71611858e-01]
 [-2.75518007e-02  1.87745355e-01]
 [-5.09266952e-01 -1.08316188e-01]
 [-1.68598368e-01 -6.38497670e-02]
 [ 1.32370887e-02 -6.42150743e-02]
 [-1.51374814e-01  1.51342751e-01]
 [ 6.34725428e-02  6.25051536e-02]
 [-3.74691619e-02  6.77121511e-02]
 [-1.45586046e-01  1.10340682e-01]
 [-3.90994865e-02 -7.61496413e-02]
 [-1.49103118e-01 -7.19522431e-02]
 [ 1.16163941e-01 -1.04120845e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.29753652]
curr_Stock_Price:  101.39580931972039
curr_Factors:  [1.01395809e+02 3.76526945e-02]
mat_Sqrt:  [[ 1.96751493e+01  0.00000000e+00]
 [-7.76172089e-03  1.77843367e-02]]
grads:  [ 0.05765824 14.60528085]
Stock Position:  0.057658243046765034
Bond Position:  [6.4512323]


portfolio before change:  [12.23039429]
curr_Stock_Price:  100.21733633081047
curr_Factors:  [1.00217336e+02 3.87744440e-02]
mat_Sqrt:  [[ 1.97340237e+01  0.00000000e+00]
 [-7.87649100e-03  1.80473081e-02]]
grads:  [0.02005777 6.28371358]
Stock Position:  0.020057771978761393
Bond Position:  [10.22025781]


portfolio before change:  [12.27527048]
curr_Stock_Price:  102.3909864648042
curr_Factors:  [1.02390986e+02 3.70843747e-02]
mat_Sqrt:  [[ 1.97177433e+01  0.00000000e+00]
 [-7.70292150e-03  1.76496104e-02]]
grads:  [-0.02370873 -8.87722371]
Stock Position:  -0.0237087345514554
Bond Position:  [14.7028312]


portfolio before change:  [12.30604236]
curr_Stock_Price:  101.1705960484278
curr_Factors:  [1.01170596e+02 3.74931664e-02]
mat_Sqrt:  [[ 1.95898165e+01  0.00000000e+00]
 [-7.74526089e-03  1.77466222e-02]]
grads:  [-8.32134744e-04 -8.53045786e+00]
Stock Position:  -0.0008321347442660572
Bond Position:  [12.39022993]


portfolio before change:  [12.3075163]
curr_Stock_Price:  101.26065356249643
curr_Factors:  [1.01260654e+02 3.64302261e-02]
mat_Sqrt:  [[ 1.93273210e+01  0.00000000e+00]
 [-7.63468151e-03  1.74932530e-02]]
grads:  [-9.39451206e-03 -9.92874930e+00]
Stock Position:  -0.009394512061725901
Bond Position:  [13.25881073]


portfolio before change:  [12.30158208]
curr_Stock_Price:  102.06874939591866
curr_Factors:  [1.02068749e+02 3.52431865e-02]
mat_Sqrt:  [[ 1.91615386e+01  0.00000000e+00]
 [-7.50926750e-03  1.72058934e-02]]
grads:  [-0.01452555 11.44430442]
Stock Position:  -0.014525551399298654
Bond Position:  [13.78418695]


portfolio before change:  [12.30243438]
curr_Stock_Price:  102.1287010694885
curr_Factors:  [1.02128701e+02 3.55863519e-02]
mat_Sqrt:  [[ 1.92659107e+01  0.00000000e+00]
 [-7.54573808e-03  1.72894580e-02]]
grads:  [ 5.97242726e-03 -1.35610315e+01]
Stock Position:  0.005972427257293918
Bond Position:  [11.69247815]


portfolio before change:  [12.29959204]
curr_Stock_Price:  101.40805639260411
curr_Factors:  [1.01408056e+02 3.58700683e-02]
mat_Sqrt:  [[ 1.92060724e+01  0.00000000e+00]
 [-7.57575800e-03  1.73582422e-02]]
grads:  [4.33371111e-03 2.11732910e+01]
Stock Position:  0.004333711114301777
Bond Position:  [11.86011882]


portfolio before change:  [12.30817883]
curr_Stock_Price:  103.04734110900986
curr_Factors:  [1.03047341e+02 3.43238628e-02]
mat_Sqrt:  [[ 1.90912722e+01  0.00000000e+00]
 [-7.41068017e-03  1.69800014e-02]]
grads:  [-0.00852032 -6.17649179]
Stock Position:  -0.00852031507507668
Bond Position:  [13.18617465]


portfolio before change:  [12.29364539]
curr_Stock_Price:  104.94654529486395
curr_Factors:  [1.04946545e+02 3.18799767e-02]
mat_Sqrt:  [[ 1.87381687e+01  0.00000000e+00]
 [-7.14198591e-03  1.63643455e-02]]
grads:  [-4.08708879e-02 -4.16434641e+01]
Stock Position:  -0.04087088786865097
Bond Position:  [16.58290387]


portfolio before change:  [12.26260108]
curr_Stock_Price:  105.75683595961974
curr_Factors:  [1.05756836e+02 3.25973481e-02]
mat_Sqrt:  [[ 1.90941172e+01  0.00000000e+00]
 [-7.22189427e-03  1.65474386e-02]]
grads:  [-0.00181605 -1.11452246]
Stock Position:  -0.0018160524004593693
Bond Position:  [12.45466104]


portfolio before change:  [12.26308482]
curr_Stock_Price:  106.34778087526084
curr_Factors:  [1.06347781e+02 3.19111708e-02]
mat_Sqrt:  [[ 1.89976465e+01  0.00000000e+00]
 [-7.14547922e-03  1.63723497e-02]]
grads:  [ -0.02432568 -17.96913479]
Stock Position:  -0.024325676362533917
Bond Position:  [14.85006652]


portfolio before change:  [12.26596877]
curr_Stock_Price:  106.30553876647231
curr_Factors:  [1.06305539e+02 3.30462405e-02]
mat_Sqrt:  [[ 1.93248852e+01  0.00000000e+00]
 [-7.27144998e-03  1.66609850e-02]]
grads:  [6.21554011e-06 1.55258427e+00]
Stock Position:  6.215540105216513e-06
Bond Position:  [12.26530802]


portfolio before change:  [12.26749652]
curr_Stock_Price:  105.41978260480109
curr_Factors:  [1.05419783e+02 3.34806439e-02]
mat_Sqrt:  [[ 1.92894132e+01  0.00000000e+00]
 [-7.31908671e-03  1.67701344e-02]]
grads:  [-3.23124471e-03 -1.16151854e+01]
Stock Position:  -0.0032312447143951328
Bond Position:  [12.60813364]


portfolio before change:  [12.27011458]
curr_Stock_Price:  105.09732298659114
curr_Factors:  [1.05097323e+02 3.47399499e-02]
mat_Sqrt:  [[ 1.95887285e+01  0.00000000e+00]
 [-7.45546242e-03  1.70826104e-02]]
grads:  [-3.50573482e-03 -5.22041854e+00]
Stock Position:  -0.0035057348213269157
Bond Position:  [12.63855793]


portfolio before change:  [12.27274927]
curr_Stock_Price:  104.79645454871918
curr_Factors:  [1.04796455e+02 3.44357929e-02]
mat_Sqrt:  [[ 1.94469561e+01  0.00000000e+00]
 [-7.42275344e-03  1.70076648e-02]]
grads:  [-1.44750128e-02 -5.15150472e+01]
Stock Position:  -0.014475012797954635
Bond Position:  [13.78967929]


portfolio before change:  [12.27313686]
curr_Stock_Price:  104.88876685264937
curr_Factors:  [1.04888767e+02 3.49127707e-02]
mat_Sqrt:  [[ 1.95984235e+01  0.00000000e+00]
 [-7.47398375e-03  1.71250481e-02]]
grads:  [-5.15558937e-03 -1.61536699e+01]
Stock Position:  -0.005155589366149048
Bond Position:  [12.81390027]


portfolio before change:  [12.27360464]
curr_Stock_Price:  105.10873346738072
curr_Factors:  [1.05108733e+02 3.55389341e-02]
mat_Sqrt:  [[ 1.98148597e+01  0.00000000e+00]
 [-7.54070916e-03  1.72779353e-02]]
grads:  [-1.58767154e-03 -9.30886058e+00]
Stock Position:  -0.0015876715414079434
Bond Position:  [12.44048279]


portfolio before change:  [12.2772826]
curr_Stock_Price:  103.77167891112694
curr_Factors:  [1.03771679e+02 3.44444889e-02]
mat_Sqrt:  [[ 1.92592210e+01  0.00000000e+00]
 [-7.42369061e-03  1.70098121e-02]]
grads:  [-1.58642017e-02 -2.52704937e+01]
Stock Position:  -0.015864201696580014
Bond Position:  [13.92353745]


portfolio before change:  [12.31544832]
curr_Stock_Price:  101.47561849535748
curr_Factors:  [1.01475618e+02 3.70546148e-02]
mat_Sqrt:  [[ 1.95336256e+01  0.00000000e+00]
 [-7.69983011e-03  1.76425272e-02]]
grads:  [-2.20302631e-03 -4.48147968e+00]
Stock Position:  -0.002203026314947646
Bond Position:  [12.53900178]


portfolio before change:  [12.31467351]
curr_Stock_Price:  102.53882863701341
curr_Factors:  [1.02538829e+02 3.64909419e-02]
mat_Sqrt:  [[ 1.95875848e+01  0.00000000e+00]
 [-7.64104097e-03  1.75078243e-02]]
grads:  [ 0.00720759 -1.89902434]
Stock Position:  0.007207592348454982
Bond Position:  [11.57561544]


portfolio before change:  [12.32838139]
curr_Stock_Price:  104.2399281904594
curr_Factors:  [1.04239928e+02 3.59273255e-02]
mat_Sqrt:  [[ 1.97581623e+01  0.00000000e+00]
 [-7.58180195e-03  1.73720907e-02]]
grads:  [ 1.04939067e-02 -2.10849494e+01]
Stock Position:  0.010493906733251701
Bond Position:  [11.2344973]


portfolio before change:  [12.32963558]
curr_Stock_Price:  104.22561428481826
curr_Factors:  [1.04225614e+02 3.77215224e-02]
mat_Sqrt:  [[ 2.02427294e+01  0.00000000e+00]
 [-7.76881174e-03  1.78005839e-02]]
grads:  [-5.95151770e-03 -1.90400347e+01]
Stock Position:  -0.0059515176983924315
Bond Position:  [12.94993617]


portfolio before change:  [12.3401815]
curr_Stock_Price:  102.72564783621122
curr_Factors:  [1.02725648e+02 3.79885266e-02]
mat_Sqrt:  [[ 2.00218920e+01  0.00000000e+00]
 [-7.79625824e-03  1.78634718e-02]]
grads:  [0.00296982 1.00627401]
Stock Position:  0.002969824677540085
Bond Position:  [12.03510433]


portfolio before change:  [12.3405237]
curr_Stock_Price:  102.33428617359107
curr_Factors:  [1.02334286e+02 3.81651867e-02]
mat_Sqrt:  [[ 1.99919363e+01  0.00000000e+00]
 [-7.81436489e-03  1.79049593e-02]]
grads:  [ 1.19613735e-02 -1.39857508e+01]
Stock Position:  0.011961373512745435
Bond Position:  [11.11646508]


portfolio before change:  [12.33625718]
curr_Stock_Price:  101.86141697303115
curr_Factors:  [1.01861417e+02 3.77181956e-02]
mat_Sqrt:  [[ 1.97826819e+01  0.00000000e+00]
 [-7.76846915e-03  1.77997990e-02]]
grads:  [ 1.72468974e-03 -4.67536486e+00]
Stock Position:  0.0017246897392073956
Bond Position:  [12.16057784]


portfolio before change:  [12.3377603]
curr_Stock_Price:  101.85153124050238
curr_Factors:  [1.01851531e+02 3.80011250e-02]
mat_Sqrt:  [[ 1.98548125e+01  0.00000000e+00]
 [-7.79755090e-03  1.78664336e-02]]
grads:  [-0.00962354 -0.41463577]
Stock Position:  -0.009623539015785668
Bond Position:  [13.31793249]


portfolio before change:  [12.35841359]
curr_Stock_Price:  99.87840676543641
curr_Factors:  [9.98784068e+01 3.74952064e-02]
mat_Sqrt:  [[ 1.93401341e+01  0.00000000e+00]
 [-7.74547159e-03  1.77471049e-02]]
grads:  [6.48466412e-03 9.66985089e+00]
Stock Position:  0.006484664123934209
Bond Position:  [11.71073567]


portfolio before change:  [12.3719441]
curr_Stock_Price:  101.73919401912964
curr_Factors:  [1.01739194e+02 3.70472350e-02]
mat_Sqrt:  [[ 1.95824124e+01  0.00000000e+00]
 [-7.69906332e-03  1.76407702e-02]]
grads:  [2.77733859e-03 1.06426960e+01]
Stock Position:  0.0027773385878272347
Bond Position:  [12.08937991]


portfolio before change:  [12.36949408]
curr_Stock_Price:  100.3129033219837
curr_Factors:  [1.00312903e+02 3.81532525e-02]
mat_Sqrt:  [[ 1.95939765e+01  0.00000000e+00]
 [-7.81314303e-03  1.79021597e-02]]
grads:  [-0.02840363 -6.05045368]
Stock Position:  -0.028403627599690992
Bond Position:  [15.21874443]


portfolio before change:  [12.34554068]
curr_Stock_Price:  101.22320465715678
curr_Factors:  [1.01223205e+02 3.81443698e-02]
mat_Sqrt:  [[ 1.97694827e+01  0.00000000e+00]
 [-7.81223347e-03  1.79000756e-02]]
grads:  [-0.00993778 -3.56701102]
Stock Position:  -0.009937776030640178
Bond Position:  [13.35147422]


portfolio before change:  [12.34671463]
curr_Stock_Price:  101.27302326782412
curr_Factors:  [1.01273023e+02 3.96935907e-02]
mat_Sqrt:  [[ 2.01768780e+01  0.00000000e+00]
 [-7.96930016e-03  1.82599606e-02]]
grads:  [-7.32951221e-04 -3.51671483e+00]
Stock Position:  -0.000732951221392946
Bond Position:  [12.42094282]


portfolio before change:  [12.3494466]
curr_Stock_Price:  99.66410542747944
curr_Factors:  [9.96641054e+01 4.21411687e-02]
mat_Sqrt:  [[ 2.04593608e+01  0.00000000e+00]
 [-8.21132571e-03  1.88145108e-02]]
grads:  [-4.17038555e-03  8.04393759e+00]
Stock Position:  -0.00417038554672654
Bond Position:  [12.76508435]


portfolio before change:  [12.34516495]
curr_Stock_Price:  101.07342033942045
curr_Factors:  [1.0107342e+02 4.0744196e-02]
mat_Sqrt:  [[ 2.04018635e+01  0.00000000e+00]
 [-8.07407664e-03  1.85000337e-02]]
grads:  [0.00444822 3.3786508 ]
Stock Position:  0.004448222492853501
Bond Position:  [11.89556789]


portfolio before change:  [12.33946699]
curr_Stock_Price:  99.45816814808896
curr_Factors:  [9.94581681e+01 4.00852996e-02]
mat_Sqrt:  [[ 1.99128317e+01  0.00000000e+00]
 [-8.00852542e-03  1.83498370e-02]]
grads:  [-3.97590686e-04  3.69006827e+00]
Stock Position:  -0.0003975906859397644
Bond Position:  [12.37901063]


portfolio before change:  [12.34117727]
curr_Stock_Price:  99.04867337933057
curr_Factors:  [9.90486734e+01 3.97965897e-02]
mat_Sqrt:  [[ 1.97593017e+01  0.00000000e+00]
 [-7.97963304e-03  1.82836362e-02]]
grads:  [-4.93081316e-03  6.03494190e+00]
Stock Position:  -0.004930813157998064
Bond Position:  [12.82956778]


portfolio before change:  [12.34864727]
curr_Stock_Price:  97.85897067132746
curr_Factors:  [9.78589707e+01 4.04529741e-02]
mat_Sqrt:  [[ 1.96823011e+01  0.00000000e+00]
 [-8.04516989e-03  1.84338000e-02]]
grads:  [-3.67507408e-03 -4.13097903e+00]
Stock Position:  -0.003675074083250955
Bond Position:  [12.70828624]


portfolio before change:  [12.35152101]
curr_Stock_Price:  97.50928998823899
curr_Factors:  [9.75092900e+01 4.10338361e-02]
mat_Sqrt:  [[ 1.97522718e+01  0.00000000e+00]
 [-8.10272410e-03  1.85656733e-02]]
grads:  [-0.00913848 -3.87555259]
Stock Position:  -0.009138475446850746
Bond Position:  [13.24260726]


portfolio before change:  [12.35689033]
curr_Stock_Price:  97.10288865446947
curr_Factors:  [9.71028887e+01 4.10542034e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.35689033]
Stock Price:  99.70228239703324
PL:  [12.35689033]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48918761e+00  3.65885389e-01]
 [ 1.04085110e+00  7.36077377e-02]
 [ 1.12815744e-01 -4.54184022e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.83346708e-02  4.20957541e-01]
 [-2.89163116e-03 -8.86939672e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.04965712e+00  1.06592717e+00]
 [-4.97154617e-03  3.19048987e-01]
 [ 1.85103632e-01  6.12511884e-02]
 [-1.12373160e-01  2.18086476e-03]
 [ 2.99918789e-02 -1.35638910e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.44174189e-02 -3.68017392e-02]
 [ 4.92146691e-01  3.21198279e-01]
 [ 1.30014034e-01  5.76179585e-02]
 [ 3.96137176e-02  1.12293614e-01]
 [-2.61437848e-03 -5.94532494e-04]
 [-9.16336738e-02 -7.00990718e-02]
 [-3.50644803e-01  1.28794192e-01]
 [ 1.04629253e-01  7.29369785e-02]
 [ 1.56670111e+00  1.84496715e-01]
 [ 1.58790610e-02  4.30744379e-01]
 [-1.39987921e-01  1.38924263e-01]
 [-2.04336328e-01  1.34841727e-01]
 [ 1.83654034e-01 -8.40334577e-02]
 [ 1.01463993e-01 -4.53718727e-01]
 [ 8.22047550e-02  2.72494448e-02]
 [ 3.66427788e-01 -1.49145090e-01]
 [-5.21111205e-01 -2.23931613e-01]
 [ 1.13791995e-01  4.49684788e-02]
 [-8.11193467e-02  9.24934951e-02]
 [ 3.35553342e-01  2.15834380e-01]
 [ 3.21427199e-02 -1.98811207e-02]
 [ 2.48889346e-01 -2.31492909e-01]
 [ 9.25441152e-02  7.28645342e-02]
 [-6.18432933e-02  2.68073786e-01]
 [-3.59583111e-01 -1.36976284e-01]
 [-1.21364901e-01  5.55393876e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.69540668]
curr_Stock_Price:  99.07435420770416
curr_Factors:  [9.90743542e+01 4.09808288e-02]
mat_Sqrt:  [[ 2.00563370e+01  0.00000000e+00]
 [-8.09748888e-03  1.85536779e-02]]
grads:  [ 0.08221207 19.72036981]
Stock Position:  0.08221207479176196
Bond Position:  [-11.8405149]


portfolio before change:  [-3.74574221]
curr_Stock_Price:  98.48009388053195
curr_Factors:  [9.84800939e+01 4.12560876e-02]
mat_Sqrt:  [[ 2.00028775e+01  0.00000000e+00]
 [-8.12463785e-03  1.86158840e-02]]
grads:  [0.05364109 3.9540286 ]
Stock Position:  0.05364109020522021
Bond Position:  [-9.02832181]


portfolio before change:  [-3.68921718]
curr_Stock_Price:  99.55489759125453
curr_Factors:  [9.95548976e+01 4.13189278e-02]
mat_Sqrt:  [[ 2.02365816e+01  0.00000000e+00]
 [-8.13082311e-03  1.86300562e-02]]
grads:  [ 0.00459532 -2.43791011]
Stock Position:  0.00459531804300792
Bond Position:  [-4.14670359]


portfolio before change:  [-3.69365625]
curr_Stock_Price:  98.70170184127736
curr_Factors:  [9.87017018e+01 4.14665978e-02]
mat_Sqrt:  [[ 2.00989719e+01  0.00000000e+00]
 [-8.14533956e-03  1.86633175e-02]]
grads:  [-8.11054766e-04 -8.11146314e+00]
Stock Position:  -0.0008110547656628479
Bond Position:  [-3.61360377]


portfolio before change:  [-3.69385384]
curr_Stock_Price:  98.38834942677468
curr_Factors:  [9.83883494e+01 4.26646542e-02]
mat_Sqrt:  [[ 2.03225308e+01  0.00000000e+00]
 [-8.26216962e-03  1.89310088e-02]]
grads:  [4.69362123e-03 2.22364030e+01]
Stock Position:  0.004693621232926422
Bond Position:  [-4.15565148]


portfolio before change:  [-3.69694092]
curr_Stock_Price:  97.84131000089793
curr_Factors:  [9.78413100e+01 4.35915504e-02]
mat_Sqrt:  [[ 2.04278856e+01  0.00000000e+00]
 [-8.35143584e-03  1.91355434e-02]]
grads:  [-2.03647371e-03 -4.63503780e+00]
Stock Position:  -0.0020364737116405915
Bond Position:  [-3.49768966]


portfolio before change:  [-3.6972623]
curr_Stock_Price:  97.78441987175346
curr_Factors:  [9.77844199e+01 4.41385786e-02]
mat_Sqrt:  [[ 2.05437081e+01  0.00000000e+00]
 [-8.40367335e-03  1.92552346e-02]]
grads:  [0.00629749 4.99276633]
Stock Position:  0.0062974890791501585
Bond Position:  [-4.31305862]


portfolio before change:  [-3.70653129]
curr_Stock_Price:  96.39818233720082
curr_Factors:  [9.63981823e+01 4.20900454e-02]
mat_Sqrt:  [[ 1.97769148e+01  0.00000000e+00]
 [-8.20634344e-03  1.88030950e-02]]
grads:  [ 0.07659768 56.68892109]
Stock Position:  0.07659768447491466
Bond Position:  [-11.09040884]


portfolio before change:  [-3.58028978]
curr_Stock_Price:  98.06439324576436
curr_Factors:  [9.80643932e+01 4.14687503e-02]
mat_Sqrt:  [[ 1.99697128e+01  0.00000000e+00]
 [-8.14555096e-03  1.86638019e-02]]
grads:  [6.72382465e-03 1.70945335e+01]
Stock Position:  0.006723824652022143
Bond Position:  [-4.23965756]


portfolio before change:  [-3.57451726]
curr_Stock_Price:  99.00173227015928
curr_Factors:  [9.90017323e+01 4.03639279e-02]
mat_Sqrt:  [[ 1.98902162e+01  0.00000000e+00]
 [-8.03631038e-03  1.84135003e-02]]
grads:  [0.01065025 3.32642829]
Stock Position:  0.010650253356956406
Bond Position:  [-4.62891079]


portfolio before change:  [-3.57548607]
curr_Stock_Price:  98.96509834278262
curr_Factors:  [9.89650983e+01 3.79880837e-02]
mat_Sqrt:  [[ 1.92888242e+01  0.00000000e+00]
 [-7.79621280e-03  1.78633676e-02]]
grads:  [-0.00577647  0.12208587]
Stock Position:  -0.005776472007211142
Bond Position:  [-3.00381695]


portfolio before change:  [-3.57244958]
curr_Stock_Price:  98.37442815484607
curr_Factors:  [9.83744282e+01 3.84354554e-02]
mat_Sqrt:  [[ 1.92862697e+01  0.00000000e+00]
 [-7.84198499e-03  1.79682449e-02]]
grads:  [-1.51433093e-03 -7.54881241e+00]
Stock Position:  -0.0015143309304210257
Bond Position:  [-3.42347814]


portfolio before change:  [-3.57500792]
curr_Stock_Price:  99.78123548282574
curr_Factors:  [9.97812355e+01 3.72715790e-02]
mat_Sqrt:  [[ 1.92636143e+01  0.00000000e+00]
 [-7.72233944e-03  1.76941025e-02]]
grads:  [-0.00671467 -1.58535338]
Stock Position:  -0.006714673914810766
Bond Position:  [-2.90500946]


portfolio before change:  [-3.57785138]
curr_Stock_Price:  100.1506228961619
curr_Factors:  [1.00150623e+02 3.82136718e-02]
mat_Sqrt:  [[ 1.95777618e+01  0.00000000e+00]
 [-7.81932701e-03  1.79163290e-02]]
grads:  [-0.00308917 -2.05408928]
Stock Position:  -0.0030891689927221924
Bond Position:  [-3.26846918]


portfolio before change:  [-3.57149734]
curr_Stock_Price:  97.96148216784874
curr_Factors:  [9.79614822e+01 3.80738162e-02]
mat_Sqrt:  [[ 1.91147469e+01  0.00000000e+00]
 [-7.80500519e-03  1.78835135e-02]]
grads:  [ 0.0330807  17.96058019]
Stock Position:  0.03308069501026532
Bond Position:  [-6.81213126]


portfolio before change:  [-3.56787021]
curr_Stock_Price:  98.09686942072825
curr_Factors:  [9.80968694e+01 3.70900311e-02]
mat_Sqrt:  [[ 1.88922527e+01  0.00000000e+00]
 [-7.70350892e-03  1.76509564e-02]]
grads:  [0.00821292 3.26429669]
Stock Position:  0.00821292065922755
Bond Position:  [-4.37353201]


portfolio before change:  [-3.5639315]
curr_Stock_Price:  98.64301227726254
curr_Factors:  [9.86430123e+01 3.72494594e-02]
mat_Sqrt:  [[ 1.90382188e+01  0.00000000e+00]
 [-7.72004760e-03  1.76888513e-02]]
grads:  [4.65498742e-03 6.34827061e+00]
Stock Position:  0.0046549874236540174
Bond Position:  [-4.02311349]


portfolio before change:  [-3.56264586]
curr_Stock_Price:  99.02723843977954
curr_Factors:  [9.90272384e+01 3.69763497e-02]
mat_Sqrt:  [[ 1.90421809e+01  0.00000000e+00]
 [-7.69169419e-03  1.76238854e-02]]
grads:  [-0.00015092 -0.03373447]
Stock Position:  -0.00015092040934187523
Bond Position:  [-3.54770063]


portfolio before change:  [-3.56287784]
curr_Stock_Price:  97.62578993555653
curr_Factors:  [9.76257899e+01 3.63295741e-02]
mat_Sqrt:  [[ 1.86077865e+01  0.00000000e+00]
 [-7.62412740e-03  1.74690705e-02]]
grads:  [-0.00656862 -4.0127534 ]
Stock Position:  -0.006568616686107159
Bond Position:  [-2.92161145]


portfolio before change:  [-3.55804322]
curr_Stock_Price:  96.8341712969531
curr_Factors:  [9.68341713e+01 3.57853558e-02]
mat_Sqrt:  [[ 1.83181373e+01  0.00000000e+00]
 [-7.56680707e-03  1.73377331e-02]]
grads:  [-0.01607338  7.42854855]
Stock Position:  -0.01607338149689111
Bond Position:  [-2.00159065]


portfolio before change:  [-3.53747041]
curr_Stock_Price:  95.53867375985958
curr_Factors:  [9.55386738e+01 3.55207948e-02]
mat_Sqrt:  [[ 1.80061368e+01  0.00000000e+00]
 [-7.53878449e-03  1.72735253e-02]]
grads:  [0.00757861 4.2224721 ]
Stock Position:  0.007578613987340143
Bond Position:  [-4.26152114]


portfolio before change:  [-3.54405721]
curr_Stock_Price:  94.73983781922871
curr_Factors:  [9.47398378e+01 3.67396264e-02]
mat_Sqrt:  [[ 1.81593377e+01  0.00000000e+00]
 [-7.66703347e-03  1.75673806e-02]]
grads:  [ 0.09070937 10.50223246]
Stock Position:  0.09070936956927171
Bond Position:  [-12.13784817]


portfolio before change:  [-3.49526723]
curr_Stock_Price:  95.294436503403
curr_Factors:  [9.52944365e+01 3.64209578e-02]
mat_Sqrt:  [[ 1.81862530e+01  0.00000000e+00]
 [-7.63371027e-03  1.74910276e-02]]
grads:  [1.12101883e-02 2.46265909e+01]
Stock Position:  0.011210188320611868
Bond Position:  [-4.56353581]


portfolio before change:  [-3.49368243]
curr_Stock_Price:  95.48669776046133
curr_Factors:  [9.54866978e+01 3.54166580e-02]
mat_Sqrt:  [[ 1.79699415e+01  0.00000000e+00]
 [-7.52772561e-03  1.72481862e-02]]
grads:  [-4.41606349e-03  8.05442734e+00]
Stock Position:  -0.0044160634873739715
Bond Position:  [-3.07200711]


portfolio before change:  [-3.49327332]
curr_Stock_Price:  95.30709530326486
curr_Factors:  [9.53070953e+01 3.55612688e-02]
mat_Sqrt:  [[ 1.79727220e+01  0.00000000e+00]
 [-7.54307829e-03  1.72833636e-02]]
grads:  [-0.00809485  7.80182205]
Stock Position:  -0.008094854684269648
Bond Position:  [-2.72177623]


portfolio before change:  [-3.49782697]
curr_Stock_Price:  95.82759971899584
curr_Factors:  [9.58275997e+01 3.44296147e-02]
mat_Sqrt:  [[ 1.77810209e+01  0.00000000e+00]
 [-7.42208754e-03  1.70061390e-02]]
grads:  [ 0.00826605 -4.94136016]
Stock Position:  0.008266051061037878
Bond Position:  [-4.2899428]


portfolio before change:  [-3.51386223]
curr_Stock_Price:  93.9525822292173
curr_Factors:  [9.39525822e+01 3.53433264e-02]
mat_Sqrt:  [[ 1.76629171e+01  0.00000000e+00]
 [-7.51992834e-03  1.72303204e-02]]
grads:  [-5.46654289e-03 -2.63325763e+01]
Stock Position:  -0.005466542888802614
Bond Position:  [-3.00026641]


portfolio before change:  [-3.51861708]
curr_Stock_Price:  94.7537819819677
curr_Factors:  [9.4753782e+01 3.3167966e-02]
mat_Sqrt:  [[ 1.72566294e+01  0.00000000e+00]
 [-7.28482982e-03  1.66916420e-02]]
grads:  [0.00545283 1.63252032]
Stock Position:  0.005452825425649867
Bond Position:  [-4.03529291]


portfolio before change:  [-3.51077001]
curr_Stock_Price:  96.28537647115797
curr_Factors:  [9.62853765e+01 3.28882742e-02]
mat_Sqrt:  [[ 1.74614729e+01  0.00000000e+00]
 [-7.25404981e-03  1.66211162e-02]]
grads:  [ 0.01725717 -8.97322951]
Stock Position:  0.01725716583447122
Bond Position:  [-5.17238272]


portfolio before change:  [-3.51857185]
curr_Stock_Price:  95.87075136648481
curr_Factors:  [9.58707514e+01 3.37891930e-02]
mat_Sqrt:  [[ 1.76228052e+01  0.00000000e+00]
 [-7.35273478e-03  1.68472319e-02]]
grads:  [ -0.03511603 -13.29189356]
Stock Position:  -0.03511603095885312
Bond Position:  [-0.15197158]


portfolio before change:  [-3.49588856]
curr_Stock_Price:  95.22425779635745
curr_Factors:  [9.52242578e+01 3.45495615e-02]
mat_Sqrt:  [[ 1.76998207e+01  0.00000000e+00]
 [-7.43500494e-03  1.70357365e-02]]
grads:  [0.00753781 2.6396557 ]
Stock Position:  0.0075378079068452565
Bond Position:  [-4.21367072]


portfolio before change:  [-3.49530701]
curr_Stock_Price:  95.3712891698592
curr_Factors:  [9.53712892e+01 3.41879655e-02]
mat_Sqrt:  [[ 1.76341399e+01  0.00000000e+00]
 [-7.39599518e-03  1.69463539e-02]]
grads:  [-2.31096477e-03  5.45801744e+00]
Stock Position:  -0.002310964770000933
Bond Position:  [-3.27490732]


portfolio before change:  [-3.49458915]
curr_Stock_Price:  94.88350532923722
curr_Factors:  [9.48835053e+01 3.42506930e-02]
mat_Sqrt:  [[ 1.75600360e+01  0.00000000e+00]
 [-7.40277710e-03  1.69618932e-02]]
grads:  [ 0.02447325 12.72466329]
Stock Position:  0.024473252108661497
Bond Position:  [-5.81669709]


portfolio before change:  [-3.48666135]
curr_Stock_Price:  95.23715384913883
curr_Factors:  [9.52371538e+01 3.46726446e-02]
mat_Sqrt:  [[ 1.77337218e+01  0.00000000e+00]
 [-7.44823679e-03  1.70660544e-02]]
grads:  [ 0.00132324 -1.1649512 ]
Stock Position:  0.0013232353445954202
Bond Position:  [-3.61268252]


portfolio before change:  [-3.48906822]
curr_Stock_Price:  93.75951705632885
curr_Factors:  [9.37595171e+01 3.55830312e-02]
mat_Sqrt:  [[ 1.76862937e+01  0.00000000e+00]
 [-7.54538600e-03  1.72886512e-02]]
grads:  [ 8.36000806e-03 -1.33898767e+01]
Stock Position:  0.008360008058241912
Bond Position:  [-4.27289854]


portfolio before change:  [-3.49118976]
curr_Stock_Price:  93.569638383273
curr_Factors:  [9.35696384e+01 3.67532579e-02]
mat_Sqrt:  [[ 1.79383656e+01  0.00000000e+00]
 [-7.66845568e-03  1.75706393e-02]]
grads:  [0.00693178 4.14694837]
Stock Position:  0.006931780047901794
Bond Position:  [-4.13979391]


portfolio before change:  [-3.49165935]
curr_Stock_Price:  93.57655040785676
curr_Factors:  [9.35765504e+01 3.80034009e-02]
mat_Sqrt:  [[ 1.82422441e+01  0.00000000e+00]
 [-7.79778439e-03  1.78669686e-02]]
grads:  [3.02340537e-03 1.50038763e+01]
Stock Position:  0.003023405368879697
Bond Position:  [-3.7745792]


portfolio before change:  [-3.49304621]
curr_Stock_Price:  93.2739085009387
curr_Factors:  [9.32739085e+01 3.91692439e-02]
mat_Sqrt:  [[ 1.84600456e+01  0.00000000e+00]
 [-7.91648850e-03  1.81389539e-02]]
grads:  [-0.02271741 -7.55149857]
Stock Position:  -0.022717412067772162
Bond Position:  [-1.3741044]


portfolio before change:  [-3.43737224]
curr_Stock_Price:  90.81562920895892
curr_Factors:  [9.08156292e+01 4.12496092e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.43737224]
Stock Price:  92.48611582260925
PL:  [-3.43737224]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.23929772e+00  3.09081599e-01]
 [ 3.16314265e-01  1.10205987e-01]
 [ 1.10441280e-01 -1.74528965e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.03198406e-01 -1.36038892e-01]
 [-2.38756014e-01  5.55306336e-02]
 [ 1.99135484e-01 -2.11910658e-01]
 [ 9.71238484e-02  4.16464134e-01]
 [-4.09407331e-02  2.14186618e-01]
 [ 1.18153436e-01 -3.87859003e-02]
 [-7.13477653e-02 -1.17282755e-02]
 [-2.39849923e-02 -1.35460212e-01]
 [-6.40719378e-02 -1.87588799e-02]
 [-3.57905771e-02 -4.31523741e-02]
 [ 4.50188613e-01  2.86234974e-01]
 [ 1.33408543e-01 -3.29087521e-01]
 [ 3.86554514e-02  2.07259096e-02]
 [-2.21676158e-03 -5.91174109e-03]
 [-4.34636743e-02 -3.06707057e-02]
 [-1.06810888e-01 -1.57462234e-02]
 [ 1.78096443e-01 -4.44189617e-02]
 [ 6.48847014e-01 -1.28386287e-01]
 [ 3.01210804e-02 -4.09794944e-01]
 [ 5.14118677e-02  1.83059676e-02]
 [ 2.50742476e-01 -1.58818118e-01]
 [ 1.81484182e-01 -8.53132025e-02]
 [ 1.44225818e-01 -1.71361594e-01]
 [ 5.24416596e-02  2.09484793e-01]
 [-1.88716564e-02  1.82309842e-01]
 [-6.33285211e-01 -6.68262509e-02]
 [-1.65397665e-01 -5.51514220e-02]
 [ 8.63870493e-03 -7.14085886e-02]
 [-2.59436610e-01  1.39821553e-01]
 [ 1.94757421e-02  2.12519383e-02]
 [ 3.51759538e-02  1.84378806e-02]
 [-1.40036000e-01  1.11505285e-01]
 [-2.92253325e-02 -1.61761557e-01]
 [ 2.33517085e-03 -2.56631237e-02]
 [ 7.68347388e-02 -1.21200419e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.36797656]
curr_Stock_Price:  100.38994928628668
curr_Factors:  [1.00389949e+02 4.22804510e-02]
mat_Sqrt:  [[ 2.06423929e+01  0.00000000e+00]
 [-8.22488429e-03  1.88455774e-02]]
grads:  [ 0.06657135 16.40074972]
Stock Position:  0.0665713510182533
Bond Position:  [-1.31511799]


portfolio before change:  [5.36135452]
curr_Stock_Price:  100.29294599957326
curr_Factors:  [1.00292946e+02 4.30829168e-02]
mat_Sqrt:  [[ 2.08172299e+01  0.00000000e+00]
 [-8.30256990e-03  1.90235775e-02]]
grads:  [0.01750531 5.79312627]
Stock Position:  0.01750531185042819
Bond Position:  [3.60569523]


portfolio before change:  [5.362171]
curr_Stock_Price:  100.31383890225113
curr_Factors:  [1.00313839e+02 4.29805702e-02]
mat_Sqrt:  [[ 2.07968202e+01  0.00000000e+00]
 [-8.29270235e-03  1.90009681e-02]]
grads:  [ 0.00494423 -0.9185267 ]
Stock Position:  0.004944227566077798
Bond Position:  [4.86619655]


portfolio before change:  [5.36801218]
curr_Stock_Price:  101.37221872389628
curr_Factors:  [1.01372219e+02 4.38506042e-02]
mat_Sqrt:  [[ 2.12278858e+01  0.00000000e+00]
 [-8.37621434e-03  1.91923181e-02]]
grads:  [-7.67922303e-04 -7.88788574e+00]
Stock Position:  -0.0007679223029683485
Bond Position:  [5.44585817]


portfolio before change:  [5.3688987]
curr_Stock_Price:  101.10429881106604
curr_Factors:  [1.01104299e+02 4.31354838e-02]
mat_Sqrt:  [[ 2.09984364e+01  0.00000000e+00]
 [-8.30763348e-03  1.90351796e-02]]
grads:  [-0.00774204 -7.14670911]
Stock Position:  -0.007742035744588801
Bond Position:  [6.1516518]


portfolio before change:  [5.3728052]
curr_Stock_Price:  100.69904384938494
curr_Factors:  [1.00699044e+02 4.39450644e-02]
mat_Sqrt:  [[ 2.11096192e+01  0.00000000e+00]
 [-8.38523125e-03  1.92129785e-02]]
grads:  [-0.01016221  2.89026679]
Stock Position:  -0.010162213556365589
Bond Position:  [6.39613039]


portfolio before change:  [5.36164041]
curr_Stock_Price:  101.87638219145506
curr_Factors:  [1.01876382e+02 4.33985821e-02]
mat_Sqrt:  [[ 2.12232204e+01  0.00000000e+00]
 [-8.33293053e-03  1.90931425e-02]]
grads:  [ 5.02516059e-03 -1.10987837e+01]
Stock Position:  0.0050251605898807795
Bond Position:  [4.84969522]


portfolio before change:  [5.3574349]
curr_Stock_Price:  100.9188501767931
curr_Factors:  [1.0091885e+02 4.3353431e-02]
mat_Sqrt:  [[ 2.10128050e+01  0.00000000e+00]
 [-8.32859470e-03  1.90832078e-02]]
grads:  [1.32720833e-02 2.18235916e+01]
Stock Position:  0.013272083263909499
Bond Position:  [4.01803152]


portfolio before change:  [5.33369957]
curr_Stock_Price:  99.09263931542384
curr_Factors:  [9.90926393e+01 4.47551630e-02]
mat_Sqrt:  [[ 2.09634602e+01  0.00000000e+00]
 [-8.46216643e-03  1.93892591e-02]]
grads:  [2.50616885e-03 1.10466634e+01]
Stock Position:  0.0025061688476091
Bond Position:  [5.08535668]


portfolio before change:  [5.33887921]
curr_Stock_Price:  100.90573841171087
curr_Factors:  [1.00905738e+02 4.47977677e-02]
mat_Sqrt:  [[ 2.13571871e+01  0.00000000e+00]
 [-8.46619326e-03  1.93984857e-02]]
grads:  [ 0.00473966 -1.99942928]
Stock Position:  0.004739663544041971
Bond Position:  [4.86061996]


portfolio before change:  [5.35324163]
curr_Stock_Price:  103.807801684007
curr_Factors:  [1.03807802e+02 4.37178689e-02]
mat_Sqrt:  [[ 2.17049848e+01  0.00000000e+00]
 [-8.36352738e-03  1.91632486e-02]]
grads:  [-0.00352299 -0.61201917]
Stock Position:  -0.003522988157560977
Bond Position:  [5.71895528]


portfolio before change:  [5.36032678]
curr_Stock_Price:  101.99960844831196
curr_Factors:  [1.01999608e+02 4.40004862e-02]
mat_Sqrt:  [[ 2.13957366e+01  0.00000000e+00]
 [-8.39051715e-03  1.92250900e-02]]
grads:  [-3.88416989e-03 -7.04601188e+00]
Stock Position:  -0.0038841698885904215
Bond Position:  [5.75651059]


portfolio before change:  [5.36349571]
curr_Stock_Price:  101.36902015852841
curr_Factors:  [1.01369020e+02 4.50985349e-02]
mat_Sqrt:  [[ 2.15271464e+01  0.00000000e+00]
 [-8.49456625e-03  1.94634964e-02]]
grads:  [-0.00335664 -0.96379805]
Stock Position:  -0.0033566448004921498
Bond Position:  [5.7037555]


portfolio before change:  [5.36396579]
curr_Stock_Price:  101.44139283208187
curr_Factors:  [1.01441393e+02 4.42650355e-02]
mat_Sqrt:  [[ 2.13425158e+01  0.00000000e+00]
 [-8.41570299e-03  1.92827980e-02]]
grads:  [-0.00255939 -2.23786891]
Stock Position:  -0.002559389795229288
Bond Position:  [5.62359386]


portfolio before change:  [5.36859177]
curr_Stock_Price:  99.90860978480934
curr_Factors:  [9.99086098e+01 4.45343635e-02]
mat_Sqrt:  [[ 2.10838802e+01  0.00000000e+00]
 [-8.44126659e-03  1.93413715e-02]]
grads:  [ 0.02727732 14.79910425]
Stock Position:  0.02727732232265603
Bond Position:  [2.64335242]


portfolio before change:  [5.39092483]
curr_Stock_Price:  100.71523660967281
curr_Factors:  [1.00715237e+02 4.46172338e-02]
mat_Sqrt:  [[ 2.12738699e+01  0.00000000e+00]
 [-8.44911677e-03  1.93593586e-02]]
grads:  [-4.80261760e-04 -1.69988856e+01]
Stock Position:  -0.0004802617600067329
Bond Position:  [5.43929451]


portfolio before change:  [5.39165846]
curr_Stock_Price:  100.60346886920813
curr_Factors:  [1.00603469e+02 4.30635146e-02]
mat_Sqrt:  [[ 2.08769808e+01  0.00000000e+00]
 [-8.30070017e-03  1.90192934e-02]]
grads:  [0.00228486 1.08973079]
Stock Position:  0.0022848600776478926
Bond Position:  [5.16179361]


portfolio before change:  [5.3888271]
curr_Stock_Price:  99.08187334596356
curr_Factors:  [9.90818733e+01 4.44967718e-02]
mat_Sqrt:  [[ 2.09005859e+01  0.00000000e+00]
 [-8.43770318e-03  1.93332068e-02]]
grads:  [-2.29508251e-04 -3.05781714e-01]
Stock Position:  -0.00022950825063539543
Bond Position:  [5.4115672]


portfolio before change:  [5.38951716]
curr_Stock_Price:  99.02271136374424
curr_Factors:  [9.90227114e+01 4.37179088e-02]
mat_Sqrt:  [[ 2.07044884e+01  0.00000000e+00]
 [-8.36353120e-03  1.91632574e-02]]
grads:  [-0.00274576 -1.60049542]
Stock Position:  -0.002745755730764339
Bond Position:  [5.66140934]


portfolio before change:  [5.39020142]
curr_Stock_Price:  99.03125455043099
curr_Factors:  [9.90312546e+01 4.18307977e-02]
mat_Sqrt:  [[ 2.02544453e+01  0.00000000e+00]
 [-8.18103150e-03  1.87450980e-02]]
grads:  [-0.00561275 -0.84001819]
Stock Position:  -0.005612748295617495
Bond Position:  [5.94603893]


portfolio before change:  [5.38410568]
curr_Stock_Price:  100.24973972843775
curr_Factors:  [1.00249740e+02 4.10308643e-02]
mat_Sqrt:  [[ 2.03066642e+01  0.00000000e+00]
 [-8.10243067e-03  1.85650009e-02]]
grads:  [ 0.00781568 -2.39261834]
Stock Position:  0.007815681467977722
Bond Position:  [4.60058564]


portfolio before change:  [5.39178404]
curr_Stock_Price:  101.15858672024262
curr_Factors:  [1.01158587e+02 4.05994631e-02]
mat_Sqrt:  [[ 2.03827557e+01  0.00000000e+00]
 [-8.05972338e-03  1.84671462e-02]]
grads:  [ 0.02908413 -6.95214549]
Stock Position:  0.02908412649838555
Bond Position:  [2.44967491]


portfolio before change:  [5.43101646]
curr_Stock_Price:  102.49698651341211
curr_Factors:  [1.02496987e+02 4.18883298e-02]
mat_Sqrt:  [[ 2.09776879e+01  0.00000000e+00]
 [-8.18665546e-03  1.87579842e-02]]
grads:  [-7.08982309e-03 -2.18464277e+01]
Stock Position:  -0.007089823092338501
Bond Position:  [6.15770196]


portfolio before change:  [5.42997809]
curr_Stock_Price:  102.7520178783796
curr_Factors:  [1.02752018e+02 4.24682946e-02]
mat_Sqrt:  [[ 2.11749684e+01  0.00000000e+00]
 [-8.24313480e-03  1.88873946e-02]]
grads:  [0.00280526 0.96921614]
Stock Position:  0.0028052578845614204
Bond Position:  [5.14173219]


portfolio before change:  [5.42645908]
curr_Stock_Price:  101.26845826772694
curr_Factors:  [1.01268458e+02 4.27735003e-02]
mat_Sqrt:  [[ 2.09440948e+01  0.00000000e+00]
 [-8.27270213e-03  1.89551418e-02]]
grads:  [ 0.00866252 -8.37862989]
Stock Position:  0.008662516507148691
Bond Position:  [4.54921939]


portfolio before change:  [5.42420131]
curr_Stock_Price:  100.94217172736245
curr_Factors:  [1.00942172e+02 4.33446725e-02]
mat_Sqrt:  [[ 2.10155377e+01  0.00000000e+00]
 [-8.32775336e-03  1.90812801e-02]]
grads:  [ 0.00686399 -4.47104189]
Stock Position:  0.006863990351412386
Bond Position:  [4.73133522]


portfolio before change:  [5.4182939]
curr_Stock_Price:  99.99536591817842
curr_Factors:  [9.99953659e+01 4.47353590e-02]
mat_Sqrt:  [[ 2.11497548e+01  0.00000000e+00]
 [-8.46029399e-03  1.93849688e-02]]
grads:  [ 3.28313437e-03 -8.83992105e+00]
Stock Position:  0.0032831343728128935
Bond Position:  [5.08999567]


portfolio before change:  [5.42016926]
curr_Stock_Price:  100.3727714631343
curr_Factors:  [1.00372771e+02 4.46696551e-02]
mat_Sqrt:  [[ 2.12139830e+01  0.00000000e+00]
 [-8.45407879e-03  1.93707280e-02]]
grads:  [6.78176837e-03 1.08145028e+01]
Stock Position:  0.006781768368745543
Bond Position:  [4.73946437]


portfolio before change:  [5.42512936]
curr_Stock_Price:  101.01679686564195
curr_Factors:  [1.01016797e+02 4.55028227e-02]
mat_Sqrt:  [[ 2.15482876e+01  0.00000000e+00]
 [-8.53255626e-03  1.95505425e-02]]
grads:  [2.81669166e-03 9.32505289e+00]
Stock Position:  0.002816691664262913
Bond Position:  [5.14059619]


portfolio before change:  [5.43027846]
curr_Stock_Price:  102.61671654327925
curr_Factors:  [1.02616717e+02 4.42156188e-02]
mat_Sqrt:  [[ 2.15777406e+01  0.00000000e+00]
 [-8.41100411e-03  1.92720315e-02]]
grads:  [-0.03070065 -3.467525  ]
Stock Position:  -0.030700646087332605
Bond Position:  [8.58067795]


portfolio before change:  [5.44448721]
curr_Stock_Price:  102.18883938870202
curr_Factors:  [1.02188839e+02 4.48083836e-02]
mat_Sqrt:  [[ 2.16313241e+01  0.00000000e+00]
 [-8.46719633e-03  1.94007841e-02]]
grads:  [-0.00875895 -2.84274191]
Stock Position:  -0.008758951470980516
Bond Position:  [6.3395543]


portfolio before change:  [5.46147354]
curr_Stock_Price:  100.34000674865382
curr_Factors:  [1.00340007e+02 4.42417719e-02]
mat_Sqrt:  [[ 2.11052442e+01  0.00000000e+00]
 [-8.41349125e-03  1.92777303e-02]]
grads:  [-1.06734411e-03 -3.70420104e+00]
Stock Position:  -0.001067344112164835
Bond Position:  [5.56857086]


portfolio before change:  [5.4613378]
curr_Stock_Price:  101.11937430716468
curr_Factors:  [1.01119374e+02 4.48208110e-02]
mat_Sqrt:  [[ 2.14079080e+01  0.00000000e+00]
 [-8.46837042e-03  1.94034742e-02]]
grads:  [-0.00926823  7.20600607]
Stock Position:  -0.0092682331300301
Bond Position:  [6.39853574]


portfolio before change:  [5.47678532]
curr_Stock_Price:  99.53895990781145
curr_Factors:  [9.95389599e+01 4.55704848e-02]
mat_Sqrt:  [[ 2.12488251e+01  0.00000000e+00]
 [-8.53889780e-03  1.95650728e-02]]
grads:  [0.00135306 1.08621821]
Stock Position:  0.001353055908194182
Bond Position:  [5.34210354]


portfolio before change:  [5.4760028]
curr_Stock_Price:  98.46706910941357
curr_Factors:  [9.84670691e+01 4.63928306e-02]
mat_Sqrt:  [[ 2.12088171e+01  0.00000000e+00]
 [-8.61559800e-03  1.97408150e-02]]
grads:  [0.00203797 0.93399794]
Stock Position:  0.0020379686631278532
Bond Position:  [5.27532999]


portfolio before change:  [5.47759219]
curr_Stock_Price:  98.92337589054107
curr_Factors:  [9.89233759e+01 4.75292536e-02]
mat_Sqrt:  [[ 2.15664879e+01  0.00000000e+00]
 [-8.72048197e-03  1.99811344e-02]]
grads:  [-4.23671693e-03  5.58052826e+00]
Stock Position:  -0.004236716926755885
Bond Position:  [5.89670253]


portfolio before change:  [5.47512878]
curr_Stock_Price:  99.67880722775489
curr_Factors:  [9.96788072e+01 4.85315878e-02]
mat_Sqrt:  [[ 2.19591276e+01  0.00000000e+00]
 [-8.81195441e-03  2.01907240e-02]]
grads:  [-4.54589389e-03 -8.01167690e+00]
Stock Position:  -0.004545893891543387
Bond Position:  [5.92825806]


portfolio before change:  [5.47413457]
curr_Stock_Price:  100.06053400856304
curr_Factors:  [1.00060534e+02 4.94600193e-02]
mat_Sqrt:  [[ 2.22530712e+01  0.00000000e+00]
 [-8.89584346e-03  2.03829380e-02]]
grads:  [-3.98378026e-04 -1.25904929e+00]
Stock Position:  -0.0003983780259278716
Bond Position:  [5.51399648]


portfolio before change:  [5.4752403]
curr_Stock_Price:  99.01518357878736
curr_Factors:  [9.90151836e+01 4.74164255e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.4752403]
Stock Price:  98.56452930362529
PL:  [5.4752403]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.16306078e+00  2.91845954e-01]
 [ 1.11314015e-01  6.32762532e-02]
 [ 1.12022186e-01 -3.94792756e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.07983314e-01  7.93241973e-01]
 [ 5.55101982e-02  3.50642684e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.16746102e+00  1.19618015e+00]
 [ 1.06216475e-01  6.16151084e-01]
 [ 1.14426550e-01 -3.36571093e-02]
 [-2.51769128e-02  1.78106887e-02]
 [ 7.25471063e-02 -1.08317768e-01]
 [-1.00983062e-01  4.42825065e-02]
 [-1.02070937e-01  1.54723751e-01]
 [ 4.25174281e-01  2.84041366e-01]
 [ 1.30006400e-01  5.11932353e-02]
 [ 3.95353317e-02  1.02942975e-01]
 [-1.09900448e-03 -2.61566340e-02]
 [-4.38178678e-02 -3.03908941e-02]
 [-1.30353566e-01 -2.39405880e-03]
 [ 1.75213549e-01 -4.22732573e-02]
 [ 9.73715516e-01  7.41931058e-02]
 [ 1.89483933e-02  1.95508425e-01]
 [-1.10355251e-02  3.64614659e-02]
 [ 1.54269690e-01 -7.39366107e-02]
 [ 1.71512759e-01 -8.88140185e-02]
 [ 1.40518483e-01 -1.56728893e-01]
 [ 4.82898375e-02  1.28726417e-01]
 [ 8.34026080e-02  1.00467036e-01]
 [-5.09903679e-01 -1.08469194e-01]
 [-1.68127851e-01 -6.33358356e-02]
 [ 9.39803888e-03 -7.02207191e-02]
 [-2.62507673e-01  1.43391086e-01]
 [ 6.41915596e-02  6.31274956e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-1.57667714e-01  1.06907377e-01]
 [-3.92611513e-02 -7.49211129e-02]
 [-2.19250780e-01 -9.11142390e-02]
 [ 1.44586222e-01 -1.32356564e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.61833831]
curr_Stock_Price:  100.71660046706923
curr_Factors:  [1.00716600e+02 4.08463701e-02]
mat_Sqrt:  [[ 2.03553134e+01  0.00000000e+00]
 [-8.08419397e-03  1.85232154e-02]]
grads:  [ 0.06339538 15.75568535]
Stock Position:  0.06339537832395516
Bond Position:  [1.23337132]


portfolio before change:  [7.62187177]
curr_Stock_Price:  100.76990529388817
curr_Factors:  [1.00769905e+02 4.14993154e-02]
mat_Sqrt:  [[ 2.05282211e+01  0.00000000e+00]
 [-8.14855231e-03  1.86706789e-02]]
grads:  [0.00676776 3.38907083]
Stock Position:  0.006767758157059886
Bond Position:  [6.93988542]


portfolio before change:  [7.61611782]
curr_Stock_Price:  99.79151740318842
curr_Factors:  [9.97915174e+01 4.10024739e-02]
mat_Sqrt:  [[ 2.02068518e+01  0.00000000e+00]
 [-8.09962705e-03  1.85585770e-02]]
grads:  [ 0.00469108 -2.12727924]
Stock Position:  0.004691082908824445
Bond Position:  [7.14798754]


portfolio before change:  [7.60743036]
curr_Stock_Price:  97.74912943862451
curr_Factors:  [9.77491294e+01 4.19461127e-02]
mat_Sqrt:  [[ 2.00197550e+01  0.00000000e+00]
 [-8.19230006e-03  1.87709176e-02]]
grads:  [-8.14264060e-04 -8.06496602e+00]
Stock Position:  -0.0008142640596965678
Bond Position:  [7.68702396]


portfolio before change:  [7.60850674]
curr_Stock_Price:  97.60735631604518
curr_Factors:  [9.76073563e+01 4.27570865e-02]
mat_Sqrt:  [[ 2.01830410e+01  0.00000000e+00]
 [-8.27111470e-03  1.89515046e-02]]
grads:  [1.18027737e-02 4.18564114e+01]
Stock Position:  0.01180277371962281
Bond Position:  [6.4564692]


portfolio before change:  [7.58536023]
curr_Stock_Price:  95.57786573228587
curr_Factors:  [9.55778657e+01 4.28065681e-02]
mat_Sqrt:  [[ 1.97748198e+01  0.00000000e+00]
 [-8.27589929e-03  1.89624675e-02]]
grads:  [0.00358099 1.8491406 ]
Stock Position:  0.0035809934226912047
Bond Position:  [7.24309652]


portfolio before change:  [7.58803293]
curr_Stock_Price:  96.07137589401675
curr_Factors:  [9.60713759e+01 4.30144147e-02]
mat_Sqrt:  [[ 1.99251234e+01  0.00000000e+00]
 [-8.29596670e-03  1.90084477e-02]]
grads:  [0.006493   5.05758749]
Stock Position:  0.006492997549315346
Bond Position:  [6.96424172]


portfolio before change:  [7.58558636]
curr_Stock_Price:  95.56049415815843
curr_Factors:  [9.55604942e+01 4.21953963e-02]
mat_Sqrt:  [[ 1.96295761e+01  0.00000000e+00]
 [-8.21660721e-03  1.88266123e-02]]
grads:  [ 0.08606996 63.53666443]
Stock Position:  0.08606996003476731
Bond Position:  [-0.63930155]


portfolio before change:  [7.52466675]
curr_Stock_Price:  94.85363086334242
curr_Factors:  [9.48536309e+01 4.19407338e-02]
mat_Sqrt:  [[ 1.94254895e+01  0.00000000e+00]
 [-8.19177478e-03  1.87697140e-02]]
grads:  [1.93110631e-02 3.28268765e+01]
Stock Position:  0.019311063075812766
Bond Position:  [5.6929423]


portfolio before change:  [7.54103097]
curr_Stock_Price:  95.66417985609037
curr_Factors:  [9.56641799e+01 4.15467229e-02]
mat_Sqrt:  [[ 1.94992425e+01  0.00000000e+00]
 [-8.15320530e-03  1.86813402e-02]]
grads:  [ 0.00511494 -1.80164318]
Stock Position:  0.005114936311677618
Bond Position:  [7.05171479]


portfolio before change:  [7.54647857]
curr_Stock_Price:  96.55687456040951
curr_Factors:  [9.65568746e+01 4.08851963e-02]
mat_Sqrt:  [[ 1.95238851e+01  0.00000000e+00]
 [-8.08803524e-03  1.85320169e-02]]
grads:  [-8.91405113e-04  9.61076653e-01]
Stock Position:  -0.0008914051126408875
Bond Position:  [7.63254986]


portfolio before change:  [7.54727784]
curr_Stock_Price:  96.73059331518608
curr_Factors:  [9.67305933e+01 4.08058752e-02]
mat_Sqrt:  [[ 1.95400288e+01  0.00000000e+00]
 [-8.08018566e-03  1.85140312e-02]]
grads:  [ 1.29341450e-03 -5.85057715e+00]
Stock Position:  0.001293414499853604
Bond Position:  [7.42216509]


portfolio before change:  [7.54662245]
curr_Stock_Price:  95.50652748515094
curr_Factors:  [9.55065275e+01 4.21067698e-02]
mat_Sqrt:  [[ 1.95978766e+01  0.00000000e+00]
 [-8.20797366e-03  1.88068303e-02]]
grads:  [-0.0041666   2.35459701]
Stock Position:  -0.004166604057388134
Bond Position:  [7.94456033]


portfolio before change:  [7.53942262]
curr_Stock_Price:  97.47286814480142
curr_Factors:  [9.74728681e+01 4.09130271e-02]
mat_Sqrt:  [[ 1.97158067e+01  0.00000000e+00]
 [-8.09078756e-03  1.85383232e-02]]
grads:  [-1.75209449e-03  8.34615672e+00]
Stock Position:  -0.001752094492764426
Bond Position:  [7.71020429]


portfolio before change:  [7.54149042]
curr_Stock_Price:  96.84278519752232
curr_Factors:  [9.68427852e+01 4.14822340e-02]
mat_Sqrt:  [[ 1.97241519e+01  0.00000000e+00]
 [-8.14687513e-03  1.86668360e-02]]
grads:  [ 0.027841   15.21636371]
Stock Position:  0.02784099905495894
Bond Position:  [4.84529053]


portfolio before change:  [7.57828216]
curr_Stock_Price:  98.14252453250147
curr_Factors:  [9.81425245e+01 4.07963614e-02]
mat_Sqrt:  [[ 1.98229343e+01  0.00000000e+00]
 [-8.07924367e-03  1.85118728e-02]]
grads:  [0.00768549 2.76542713]
Stock Position:  0.007685489824856506
Bond Position:  [6.82400878]


portfolio before change:  [7.58765461]
curr_Stock_Price:  99.25102895610057
curr_Factors:  [9.92510290e+01 4.03871071e-02]
mat_Sqrt:  [[ 1.99460265e+01  0.00000000e+00]
 [-8.03861750e-03  1.84187866e-02]]
grads:  [4.23459427e-03 5.58902045e+00]
Stock Position:  0.004234594265376784
Bond Position:  [7.16736677]


portfolio before change:  [7.58893004]
curr_Stock_Price:  99.34063623148572
curr_Factors:  [9.93406362e+01 3.92883086e-02]
mat_Sqrt:  [[ 1.96905843e+01  0.00000000e+00]
 [-7.92851144e-03  1.81665019e-02]]
grads:  [-6.35567501e-04 -1.43982777e+00]
Stock Position:  -0.0006355675006094056
Bond Position:  [7.65206772]


portfolio before change:  [7.59016274]
curr_Stock_Price:  98.90616944645741
curr_Factors:  [9.89061694e+01 4.02452772e-02]
mat_Sqrt:  [[ 1.98417898e+01  0.00000000e+00]
 [-8.02449024e-03  1.83864170e-02]]
grads:  [-0.00287683 -1.65289921]
Stock Position:  -0.0028768342993985225
Bond Position:  [7.8746994]


portfolio before change:  [7.5912918]
curr_Stock_Price:  98.85588353225104
curr_Factors:  [9.88558835e+01 3.96807226e-02]
mat_Sqrt:  [[ 1.96921125e+01  0.00000000e+00]
 [-7.96800829e-03  1.82570006e-02]]
grads:  [-0.00667264 -0.131131  ]
Stock Position:  -0.0066726420850769155
Bond Position:  [8.25092173]


portfolio before change:  [7.59279248]
curr_Stock_Price:  98.7855599458288
curr_Factors:  [9.87855599e+01 4.12789465e-02]
mat_Sqrt:  [[ 2.00704804e+01  0.00000000e+00]
 [-8.12688836e-03  1.86210405e-02]]
grads:  [ 0.00781067 -2.27018771]
Stock Position:  0.007810674347231634
Bond Position:  [6.82121064]


portfolio before change:  [7.5950963]
curr_Stock_Price:  98.97134668175094
curr_Factors:  [9.89713467e+01 4.14301945e-02]
mat_Sqrt:  [[ 2.01450322e+01  0.00000000e+00]
 [-8.14176340e-03  1.86551235e-02]]
grads:  [0.04994264 3.97709003]
Stock Position:  0.04994263758933311
Bond Position:  [2.6522062]


portfolio before change:  [7.53735022]
curr_Stock_Price:  97.80846000358162
curr_Factors:  [9.78084600e+01 4.19479153e-02]
mat_Sqrt:  [[ 2.00323367e+01  0.00000000e+00]
 [-8.19247608e-03  1.87713209e-02]]
grads:  [5.20534706e-03 1.04152726e+01]
Stock Position:  0.005205347061661038
Bond Position:  [7.02822324]


portfolio before change:  [7.54947817]
curr_Stock_Price:  99.96957674479206
curr_Factors:  [9.99695767e+01 4.25111158e-02]
mat_Sqrt:  [[ 2.06119512e+01  0.00000000e+00]
 [-8.24728957e-03  1.88969144e-02]]
grads:  [2.36637625e-04 1.92949310e+00]
Stock Position:  0.00023663762533994423
Bond Position:  [7.5258216]


portfolio before change:  [7.55047975]
curr_Stock_Price:  100.22648321505268
curr_Factors:  [1.00226483e+02 4.11596088e-02]
mat_Sqrt:  [[ 2.03337796e+01  0.00000000e+00]
 [-8.11513242e-03  1.85941043e-02]]
grads:  [ 0.00599992 -3.976347  ]
Stock Position:  0.005999922810255443
Bond Position:  [6.94912858]


portfolio before change:  [7.55330158]
curr_Stock_Price:  100.55201103163446
curr_Factors:  [1.00552011e+02 4.14365900e-02]
mat_Sqrt:  [[ 2.04683467e+01  0.00000000e+00]
 [-8.14239178e-03  1.86565633e-02]]
grads:  [ 0.00648568 -4.76047045]
Stock Position:  0.006485679821732742
Bond Position:  [6.90115343]


portfolio before change:  [7.55126031]
curr_Stock_Price:  100.10426049129904
curr_Factors:  [1.00104260e+02 4.35693842e-02]
mat_Sqrt:  [[ 2.08950432e+01  0.00000000e+00]
 [-8.34931223e-03  1.91306777e-02]]
grads:  [ 3.45136334e-03 -8.19254268e+00]
Stock Position:  0.003451363344530767
Bond Position:  [7.20576414]


portfolio before change:  [7.54924565]
curr_Stock_Price:  99.25953876936723
curr_Factors:  [9.92595388e+01 4.43292193e-02]
mat_Sqrt:  [[ 2.08986048e+01  0.00000000e+00]
 [-8.42180211e-03  1.92967728e-02]]
grads:  [4.99892948e-03 6.67087798e+00]
Stock Position:  0.004998929478533737
Bond Position:  [7.05305422]


portfolio before change:  [7.55001988]
curr_Stock_Price:  99.23804258904084
curr_Factors:  [9.92380426e+01 4.35501766e-02]
mat_Sqrt:  [[ 2.07096686e+01  0.00000000e+00]
 [-8.34747163e-03  1.91264603e-02]]
grads:  [0.00614447 5.25277725]
Stock Position:  0.00614447383762151
Bond Position:  [6.94025432]


portfolio before change:  [7.55744344]
curr_Stock_Price:  100.30501355898559
curr_Factors:  [1.00305014e+02 4.47331151e-02]
mat_Sqrt:  [[ 2.12147155e+01  0.00000000e+00]
 [-8.46008181e-03  1.93844826e-02]]
grads:  [-0.02626684 -5.59567133]
Stock Position:  -0.02626683898103657
Bond Position:  [10.19213908]


portfolio before change:  [7.55701364]
curr_Stock_Price:  100.36988245531403
curr_Factors:  [1.00369882e+02 4.49132576e-02]
mat_Sqrt:  [[ 2.12711365e+01  0.00000000e+00]
 [-8.47709928e-03  1.94234746e-02]]
grads:  [-0.00920355 -3.26078815]
Stock Position:  -0.009203545665935065
Bond Position:  [8.48077243]


portfolio before change:  [7.55696006]
curr_Stock_Price:  100.49089387774474
curr_Factors:  [1.00490894e+02 4.40299848e-02]
mat_Sqrt:  [[ 2.10863289e+01  0.00000000e+00]
 [-8.39332924e-03  1.92315333e-02]]
grads:  [-1.00770483e-03 -3.65133232e+00]
Stock Position:  -0.00100770482684995
Bond Position:  [7.65822522]


portfolio before change:  [7.55677371]
curr_Stock_Price:  101.62584280226221
curr_Factors:  [1.01625843e+02 4.31223763e-02]
mat_Sqrt:  [[ 2.11035493e+01  0.00000000e+00]
 [-8.30637117e-03  1.90322873e-02]]
grads:  [-0.0094736   7.53409634]
Stock Position:  -0.009473604147038028
Bond Position:  [8.51953672]


portfolio before change:  [7.56109814]
curr_Stock_Price:  101.28178982230587
curr_Factors:  [1.01281790e+02 4.28681936e-02]
mat_Sqrt:  [[ 2.09700255e+01  0.00000000e+00]
 [-8.28185424e-03  1.89761120e-02]]
grads:  [0.00437494 3.32668228]
Stock Position:  0.004374942573136017
Bond Position:  [7.11799613]


portfolio before change:  [7.56012062]
curr_Stock_Price:  100.85496716458398
curr_Factors:  [1.00854967e+02 4.33928165e-02]
mat_Sqrt:  [[ 2.10090402e+01  0.00000000e+00]
 [-8.33237700e-03  1.90918742e-02]]
grads:  [-0.00450604  4.25967328]
Stock Position:  -0.004506041676479567
Bond Position:  [8.01457731]


portfolio before change:  [7.56803536]
curr_Stock_Price:  99.32083794889557
curr_Factors:  [9.93208379e+01 4.48499180e-02]
mat_Sqrt:  [[ 2.10339677e+01  0.00000000e+00]
 [-8.47111969e-03  1.94097736e-02]]
grads:  [-5.27763054e-03  5.50791467e+00]
Stock Position:  -0.005277630536546657
Bond Position:  [8.09221404]


portfolio before change:  [7.57705835]
curr_Stock_Price:  97.80284453507663
curr_Factors:  [9.78028445e+01 4.56020746e-02]
mat_Sqrt:  [[ 2.08854476e+01  0.00000000e+00]
 [-8.54185690e-03  1.95718529e-02]]
grads:  [-3.44543278e-03 -3.82800306e+00]
Stock Position:  -0.00344543278267225
Bond Position:  [7.91403148]


portfolio before change:  [7.58245923]
curr_Stock_Price:  96.52243753248977
curr_Factors:  [9.65224375e+01 4.78625560e-02]
mat_Sqrt:  [[ 2.11167085e+01  0.00000000e+00]
 [-8.75100506e-03  2.00510716e-02]]
grads:  [-0.01226594 -4.54410822]
Stock Position:  -0.012265940687943974
Bond Position:  [8.76639772]


portfolio before change:  [7.56764967]
curr_Stock_Price:  97.81915168612399
curr_Factors:  [9.78191517e+01 4.78307356e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.56764967]
Stock Price:  97.5388370790212
PL:  [7.56764967]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.45964828e+00  3.62225498e-01]
 [ 9.75698797e-01  7.98399283e-02]
 [ 1.09802930e-01 -4.97458190e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.55752612e-02  1.94022380e-01]
 [-9.83357653e-02 -9.57120666e-02]
 [ 8.76936660e-02  9.57132128e-02]
 [ 5.29840780e-01  5.85519184e-01]
 [-1.32494031e-02  2.96971358e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-9.66566162e-02  6.88759090e-03]
 [ 2.54101066e-02 -1.33610606e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-1.37147153e-02 -1.02149193e-01]
 [ 3.96367625e-01  2.48411744e-01]
 [ 1.32387981e-01 -2.60633923e-01]
 [ 3.78444926e-02 -1.42396885e-02]
 [ 9.24206780e-03 -8.77630998e-02]
 [-1.13959225e-01 -4.69287644e-01]
 [-3.22776148e-03 -8.21666981e-02]
 [ 1.60023066e-01 -3.47002386e-02]
 [ 5.77819691e-01 -1.91386713e-01]
 [ 3.03180840e-02 -4.14980616e-01]
 [ 4.86531378e-02  2.16517682e-02]
 [ 3.44042548e-01 -2.45559097e-01]
 [-1.54525949e-01 -4.85546706e-03]
 [-1.45651318e-01  1.28056590e-01]
 [-6.34159232e-02  9.93474059e-03]
 [-6.54975150e-02  2.07117570e-01]
 [-5.72086889e-01  5.04728855e-01]
 [-1.27021806e-01  1.16329553e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-1.91435506e-01 -1.48433039e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.62681084e-01 -1.49142808e-01]
 [-3.49307397e-02 -1.07866469e-01]
 [ 3.75209278e-02 -6.15586404e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.07012749]
curr_Stock_Price:  98.72965169096761
curr_Factors:  [9.87296517e+01 4.05629277e-02]
mat_Sqrt:  [[ 1.98843890e+01  0.00000000e+00]
 [-8.05609610e-03  1.84588351e-02]]
grads:  [ 0.08135711 19.62342129]
Stock Position:  0.0813571110040372
Bond Position:  [-14.10248672]


portfolio before change:  [-6.07564403]
curr_Stock_Price:  98.68351407208826
curr_Factors:  [9.86835141e+01 4.06196419e-02]
mat_Sqrt:  [[ 1.98889864e+01  0.00000000e+00]
 [-8.06172606e-03  1.84717349e-02]]
grads:  [0.05080922 4.32227555]
Stock Position:  0.050809215589958635
Bond Position:  [-11.08967598]


portfolio before change:  [-6.05399752]
curr_Stock_Price:  99.13683351065038
curr_Factors:  [9.91368335e+01 4.05388752e-02]
mat_Sqrt:  [[ 1.99604758e+01  0.00000000e+00]
 [-8.05370724e-03  1.84533615e-02]]
grads:  [ 0.00441333 -2.6957592 ]
Stock Position:  0.004413325394820154
Bond Position:  [-6.49152063]


portfolio before change:  [-6.05594665]
curr_Stock_Price:  98.87906073558523
curr_Factors:  [9.88790607e+01 3.96989732e-02]
mat_Sqrt:  [[ 1.97012585e+01  0.00000000e+00]
 [-7.96984047e-03  1.82611986e-02]]
grads:  [-8.27427698e-04 -8.29008082e+00]
Stock Position:  -0.0008274276975862497
Bond Position:  [-5.97413138]


portfolio before change:  [-6.05685286]
curr_Stock_Price:  99.0717018984322
curr_Factors:  [9.90717019e+01 4.04105939e-02]
mat_Sqrt:  [[ 1.99157763e+01  0.00000000e+00]
 [-8.04095456e-03  1.84241415e-02]]
grads:  [4.57077222e-04 1.05308777e+01]
Stock Position:  0.00045707722163056347
Bond Position:  [-6.10213628]


portfolio before change:  [-6.05756234]
curr_Stock_Price:  99.18839453734222
curr_Factors:  [9.91883945e+01 3.98880277e-02]
mat_Sqrt:  [[ 1.98098936e+01  0.00000000e+00]
 [-7.98879492e-03  1.83046287e-02]]
grads:  [-0.00707262 -5.22884501]
Stock Position:  -0.007072624359708519
Bond Position:  [-5.35604008]


portfolio before change:  [-6.05923874]
curr_Stock_Price:  99.33075344881946
curr_Factors:  [9.93307534e+01 3.83627447e-02]
mat_Sqrt:  [[ 1.94553284e+01  0.00000000e+00]
 [-7.83456390e-03  1.79512411e-02]]
grads:  [0.00665454 5.33184377]
Stock Position:  0.006654543896605135
Bond Position:  [-6.72023959]


portfolio before change:  [-6.05942601]
curr_Stock_Price:  99.42885323139372
curr_Factors:  [9.94288532e+01 3.73541434e-02]
mat_Sqrt:  [[ 1.92168332e+01  0.00000000e+00]
 [-7.73088801e-03  1.77136897e-02]]
grads:  [ 0.0408695  33.05461439]
Stock Position:  0.040869496696536674
Bond Position:  [-10.1230332]


portfolio before change:  [-6.10659831]
curr_Stock_Price:  98.3055987059906
curr_Factors:  [9.83055987e+01 3.97829405e-02]
mat_Sqrt:  [[ 1.96077018e+01  0.00000000e+00]
 [-7.97826453e-03  1.82805006e-02]]
grads:  [5.93437847e-03 1.62452531e+01]
Stock Position:  0.005934378466737642
Bond Position:  [-6.68998094]


portfolio before change:  [-6.10854732]
curr_Stock_Price:  98.11809783355747
curr_Factors:  [9.81180978e+01 3.99253595e-02]
mat_Sqrt:  [[ 1.96053021e+01  0.00000000e+00]
 [-7.99253247e-03  1.83131925e-02]]
grads:  [0.01256977 6.17459426]
Stock Position:  0.012569772504739016
Bond Position:  [-7.34186948]


portfolio before change:  [-6.10400027]
curr_Stock_Price:  98.5528581359826
curr_Factors:  [9.85528581e+01 3.93073888e-02]
mat_Sqrt:  [[ 1.95391794e+01  0.00000000e+00]
 [-7.93043644e-03  1.81709126e-02]]
grads:  [-0.00479297  0.37904485]
Stock Position:  -0.004792966126867027
Bond Position:  [-5.63163976]


portfolio before change:  [-6.10720483]
curr_Stock_Price:  99.07457428320615
curr_Factors:  [9.90745743e+01 3.83517540e-02]
mat_Sqrt:  [[ 1.94023722e+01  0.00000000e+00]
 [-7.83344154e-03  1.79486694e-02]]
grads:  [-1.69578967e-03 -7.44403959e+00]
Stock Position:  -0.0016957896746298
Bond Position:  [-5.93919519]


portfolio before change:  [-6.11365898]
curr_Stock_Price:  102.44273774747565
curr_Factors:  [1.02442738e+02 3.63176435e-02]
mat_Sqrt:  [[ 1.95227057e+01  0.00000000e+00]
 [-7.62287541e-03  1.74662018e-02]]
grads:  [-0.00335556 -1.02426407]
Stock Position:  -0.0033555554323498682
Bond Position:  [-5.76990669]


portfolio before change:  [-6.11385564]
curr_Stock_Price:  102.28639430700647
curr_Factors:  [1.02286394e+02 3.70450933e-02]
mat_Sqrt:  [[ 1.96871666e+01  0.00000000e+00]
 [-7.69884077e-03  1.76402603e-02]]
grads:  [-2.96113094e-03 -5.79068512e+00]
Stock Position:  -0.002961130937673896
Bond Position:  [-5.81097224]


portfolio before change:  [-6.11003022]
curr_Stock_Price:  100.7491997928539
curr_Factors:  [1.00749200e+02 3.73071128e-02]
mat_Sqrt:  [[ 1.94597576e+01  0.00000000e+00]
 [-7.72601971e-03  1.77025351e-02]]
grads:  [ 0.02593986 14.032552  ]
Stock Position:  0.025939860590659756
Bond Position:  [-8.72345042]


portfolio before change:  [-6.12520492]
curr_Stock_Price:  100.20624386922722
curr_Factors:  [1.00206244e+02 3.66952069e-02]
mat_Sqrt:  [[ 1.91955011e+01  0.00000000e+00]
 [-7.66239722e-03  1.75567576e-02]]
grads:  [ 9.70957281e-04 -1.48452196e+01]
Stock Position:  0.0009709572807593266
Bond Position:  [-6.22250091]


portfolio before change:  [-6.12529594]
curr_Stock_Price:  100.91363682017287
curr_Factors:  [1.00913637e+02 3.67932164e-02]
mat_Sqrt:  [[ 1.93568077e+01  0.00000000e+00]
 [-7.67262317e-03  1.75801882e-02]]
grads:  [ 0.00163404 -0.80998498]
Stock Position:  0.0016340392254031212
Bond Position:  [-6.29019278]


portfolio before change:  [-6.12740456]
curr_Stock_Price:  100.10441764241779
curr_Factors:  [1.00104418e+02 3.55303793e-02]
mat_Sqrt:  [[ 1.88691860e+01  0.00000000e+00]
 [-7.53980151e-03  1.72758556e-02]]
grads:  [-1.54012416e-03 -5.08010150e+00]
Stock Position:  -0.0015401241563893346
Bond Position:  [-5.97323133]


portfolio before change:  [-6.12861677]
curr_Stock_Price:  100.40667677790324
curr_Factors:  [1.00406677e+02 3.49091353e-02]
mat_Sqrt:  [[ 1.87599700e+01  0.00000000e+00]
 [-7.47359461e-03  1.71241565e-02]]
grads:  [-1.69921991e-02 -2.74050079e+01]
Stock Position:  -0.016992199092564435
Bond Position:  [-4.42248653]


portfolio before change:  [-6.14938892]
curr_Stock_Price:  101.59659364921404
curr_Factors:  [1.01596594e+02 3.28961861e-02]
mat_Sqrt:  [[ 1.84268849e+01  0.00000000e+00]
 [-7.25492231e-03  1.66231153e-02]]
grads:  [-2.12126189e-03 -4.94291813e+00]
Stock Position:  -0.0021212618855783547
Bond Position:  [-5.93387594]


portfolio before change:  [-6.15151078]
curr_Stock_Price:  102.2471836639661
curr_Factors:  [1.02247184e+02 3.26017679e-02]
mat_Sqrt:  [[ 1.84617102e+01  0.00000000e+00]
 [-7.22238386e-03  1.65485604e-02]]
grads:  [ 0.00784752 -2.09687355]
Stock Position:  0.007847520020046982
Bond Position:  [-6.9538976]


portfolio before change:  [-6.15537212]
curr_Stock_Price:  101.86591030844981
curr_Factors:  [1.01865910e+02 3.28948901e-02]
mat_Sqrt:  [[ 1.84753677e+01  0.00000000e+00]
 [-7.25477940e-03  1.66227879e-02]]
grads:  [  0.02675409 -11.51351473]
Stock Position:  0.026754091739821427
Bond Position:  [-8.88070203]


portfolio before change:  [-6.1442495]
curr_Stock_Price:  102.32314032263423
curr_Factors:  [1.02323140e+02 3.21817991e-02]
mat_Sqrt:  [[ 1.83560410e+01  0.00000000e+00]
 [-7.17571449e-03  1.64416274e-02]]
grads:  [-8.21496884e-03 -2.52396314e+01]
Stock Position:  -0.008214968842562488
Bond Position:  [-5.30366809]


portfolio before change:  [-6.15053853]
curr_Stock_Price:  103.00799159305434
curr_Factors:  [1.03007992e+02 3.31146238e-02]
mat_Sqrt:  [[ 1.87448009e+01  0.00000000e+00]
 [-7.27896958e-03  1.66782145e-02]]
grads:  [0.00309967 1.2982066 ]
Stock Position:  0.003099672512442201
Bond Position:  [-6.46982957]


portfolio before change:  [-6.15360838]
curr_Stock_Price:  102.27853864295929
curr_Factors:  [1.02278539e+02 3.36860553e-02]
mat_Sqrt:  [[ 1.87719588e+01  0.00000000e+00]
 [-7.34150451e-03  1.68215001e-02]]
grads:  [ 1.26183833e-02 -1.45979310e+01]
Stock Position:  0.012618383301204468
Bond Position:  [-7.44419818]


portfolio before change:  [-6.13887696]
curr_Stock_Price:  103.51974376073689
curr_Factors:  [1.03519744e+02 3.32597336e-02]
mat_Sqrt:  [[ 1.88791559e+01  0.00000000e+00]
 [-7.29490054e-03  1.67147169e-02]]
grads:  [-0.00829725 -0.29049053]
Stock Position:  -0.008297248571381541
Bond Position:  [-5.27994791]


portfolio before change:  [-6.14882484]
curr_Stock_Price:  104.6391323930864
curr_Factors:  [1.04639132e+02 3.22255068e-02]
mat_Sqrt:  [[ 1.87842564e+01  0.00000000e+00]
 [-7.18058570e-03  1.64527887e-02]]
grads:  [-4.77862090e-03  7.78327563e+00]
Stock Position:  -0.00477862090124818
Bond Position:  [-5.64879409]


portfolio before change:  [-6.14966227]
curr_Stock_Price:  104.66660695323935
curr_Factors:  [1.04666607e+02 3.20099455e-02]
mat_Sqrt:  [[ 1.87262412e+01  0.00000000e+00]
 [-7.15652938e-03  1.63976688e-02]]
grads:  [-0.00315493  0.60586299]
Stock Position:  -0.003154933569895058
Bond Position:  [-5.81944608]


portfolio before change:  [-6.14996864]
curr_Stock_Price:  104.53313173596483
curr_Factors:  [1.04533132e+02 3.16799773e-02]
mat_Sqrt:  [[ 1.86057162e+01  0.00000000e+00]
 [-7.11954800e-03  1.63129338e-02]]
grads:  [1.33808358e-03 1.26965249e+01]
Stock Position:  0.0013380835765710334
Bond Position:  [-6.28984271]


portfolio before change:  [-6.1472515]
curr_Stock_Price:  107.15137470584071
curr_Factors:  [1.07151375e+02 3.04450358e-02]
mat_Sqrt:  [[ 1.86963139e+01  0.00000000e+00]
 [-6.97940236e-03  1.59918198e-02]]
grads:  [-1.88168191e-02  3.15616897e+01]
Stock Position:  -0.01881681908211968
Bond Position:  [-4.13100346]


portfolio before change:  [-6.13180729]
curr_Stock_Price:  106.30316453827598
curr_Factors:  [1.06303165e+02 3.09453345e-02]
mat_Sqrt:  [[ 1.87000938e+01  0.00000000e+00]
 [-7.03651442e-03  1.61226800e-02]]
grads:  [-0.00652108  0.7215274 ]
Stock Position:  -0.006521077916544406
Bond Position:  [-5.43859607]


portfolio before change:  [-6.13465507]
curr_Stock_Price:  106.6356124722938
curr_Factors:  [1.06635612e+02 3.18750188e-02]
mat_Sqrt:  [[ 1.90382705e+01  0.00000000e+00]
 [-7.14143054e-03  1.63630730e-02]]
grads:  [ 0.00381036 -0.73013114]
Stock Position:  0.0038103564498658516
Bond Position:  [-6.54097477]


portfolio before change:  [-6.12860851]
curr_Stock_Price:  108.43707914332442
curr_Factors:  [1.08437079e+02 3.12800893e-02]
mat_Sqrt:  [[ 1.91783749e+01  0.00000000e+00]
 [-7.07447121e-03  1.62096499e-02]]
grads:  [-0.01335968 -9.15707866]
Stock Position:  -0.013359682317730742
Bond Position:  [-4.67992359]


portfolio before change:  [-6.13228471]
curr_Stock_Price:  108.66845938095032
curr_Factors:  [1.08668459e+02 3.01344995e-02]
mat_Sqrt:  [[ 1.88640744e+01  0.00000000e+00]
 [-6.94371653e-03  1.59100533e-02]]
grads:  [0.00537907 3.3531667 ]
Stock Position:  0.005379069727973303
Bond Position:  [-6.71681993]


portfolio before change:  [-6.12854779]
curr_Stock_Price:  109.51927056774349
curr_Factors:  [1.09519271e+02 2.93430865e-02]
mat_Sqrt:  [[ 1.87604581e+01  0.00000000e+00]
 [-6.85192954e-03  1.56997429e-02]]
grads:  [-5.04612468e-03  5.18003045e+00]
Stock Position:  -0.0050461246800577375
Bond Position:  [-5.5758999]


portfolio before change:  [-6.1388962]
curr_Stock_Price:  111.43190278240232
curr_Factors:  [1.11431903e+02 3.00809732e-02]
mat_Sqrt:  [[ 1.93266013e+01  0.00000000e+00]
 [-6.93754691e-03  1.58959169e-02]]
grads:  [-0.02730808 -9.38246023]
Stock Position:  -0.027308078305598005
Bond Position:  [-3.09590508]


portfolio before change:  [-6.16689239]
curr_Stock_Price:  112.44292886158124
curr_Factors:  [1.12442929e+02 2.93788286e-02]
mat_Sqrt:  [[ 1.92730029e+01  0.00000000e+00]
 [-6.85610135e-03  1.57093017e-02]]
grads:  [-4.25504664e-03 -6.86640762e+00]
Stock Position:  -0.00425504663849623
Bond Position:  [-5.68844249]


portfolio before change:  [-6.17488665]
curr_Stock_Price:  114.1545809727853
curr_Factors:  [1.14154581e+02 2.95575164e-02]
mat_Sqrt:  [[ 1.96257975e+01  0.00000000e+00]
 [-6.87691982e-03  1.57570028e-02]]
grads:  [ 5.42884157e-04 -3.90674808e+00]
Stock Position:  0.0005428841570593977
Bond Position:  [-6.23685937]


portfolio before change:  [-6.17577859]
curr_Stock_Price:  113.94775120684125
curr_Factors:  [1.13947751e+02 2.92457399e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.17577859]
Stock Price:  116.63336959215725
PL:  [-22.80914819]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48150133e+00  3.64616942e-01]
 [ 6.70169566e-01  1.09706518e-01]
 [ 8.10989364e-02  2.49081284e-03]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.50543334e-01  1.11293503e+00]
 [-8.97125187e-02 -1.04258241e-01]
 [ 8.98593564e-02  8.13755694e-02]
 [ 5.55872028e-01  6.02241574e-01]
 [-7.97951827e-02  6.69020275e-02]
 [-1.81206308e-01 -4.62845937e-01]
 [-6.33331473e-02 -1.39479912e-02]
 [-1.15850743e-01 -1.72407510e-01]
 [-5.19872038e-02 -2.59830457e-02]
 [ 2.29886054e-02 -1.97601571e-01]
 [-1.82953036e-03 -7.30798196e-02]
 [ 1.08837075e-01 -7.82388056e-01]
 [ 2.27021351e-02 -2.15245728e-01]
 [ 3.78692279e-02 -1.59892908e-01]
 [-1.14305852e-01 -2.59596509e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.09743233e-01 -1.82681787e-02]
 [ 3.68581397e-01 -3.67533905e-01]
 [ 2.70536160e-02 -3.28725016e-01]
 [ 2.02483920e-02  1.12188868e-01]
 [ 4.60020812e-01 -4.62971082e-01]
 [-4.65737117e-01  6.56948034e-02]
 [-1.42941971e-01  1.36245909e-01]
 [-1.02707106e-01 -1.39902211e-01]
 [-6.54588997e-02  2.05531836e-01]
 [-7.06134319e-01 -3.49002562e-02]
 [-1.50595590e-01 -2.49918070e-02]
 [ 3.80767386e-02 -4.82657367e-02]
 [-2.60164630e-01  1.41017931e-01]
 [ 6.28640636e-02  6.19700593e-02]
 [-1.06252977e-01  8.77951111e-02]
 [-1.33258804e-01  1.13302625e-01]
 [-2.90236105e-02 -1.63557183e-01]
 [-3.48161938e-03 -2.75568076e-02]
 [ 1.00456690e-01 -1.25344149e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.04017858]
curr_Stock_Price:  99.02430885406902
curr_Factors:  [9.90243089e+01 4.01154631e-02]
mat_Sqrt:  [[ 1.98334253e+01  0.00000000e+00]
 [-8.01153799e-03  1.83567396e-02]]
grads:  [ 0.08272062 19.86283778]
Stock Position:  0.08272061835343505
Bond Position:  [-12.23153064]


portfolio before change:  [-4.00768773]
curr_Stock_Price:  99.43557131768262
curr_Factors:  [9.94355713e+01 3.97437611e-02]
mat_Sqrt:  [[ 1.98233138e+01  0.00000000e+00]
 [-7.97433494e-03  1.82714967e-02]]
grads:  [0.03622247 6.00424365]
Stock Position:  0.03622247142360972
Bond Position:  [-7.60948987]


portfolio before change:  [-4.04550159]
curr_Stock_Price:  98.41789880205319
curr_Factors:  [9.84178988e+01 4.00693292e-02]
mat_Sqrt:  [[ 1.97006305e+01  0.00000000e+00]
 [-8.00692991e-03  1.83461812e-02]]
grads:  [0.00417175 0.13576737]
Stock Position:  0.00417174549101247
Bond Position:  [-4.45607602]


portfolio before change:  [-4.04656677]
curr_Stock_Price:  98.2960943326702
curr_Factors:  [9.82960943e+01 4.00125358e-02]
mat_Sqrt:  [[ 1.96622992e+01  0.00000000e+00]
 [-8.00125349e-03  1.83331749e-02]]
grads:  [-8.29067181e-04 -8.25753387e+00]
Stock Position:  -0.0008290671809321816
Bond Position:  [-3.96507271]


portfolio before change:  [-4.0453808]
curr_Stock_Price:  96.26773975181412
curr_Factors:  [9.62677398e+01 4.08892073e-02]
mat_Sqrt:  [[ 1.94663766e+01  0.00000000e+00]
 [-8.08843197e-03  1.85329259e-02]]
grads:  [1.72184758e-02 6.00517714e+01]
Stock Position:  0.01721847576607825
Bond Position:  [-5.70296454]


portfolio before change:  [-3.99751267]
curr_Stock_Price:  99.08918791713518
curr_Factors:  [9.90891879e+01 4.09572353e-02]
mat_Sqrt:  [[ 2.00535648e+01  0.00000000e+00]
 [-8.09515760e-03  1.85483362e-02]]
grads:  [-0.00674267 -5.6208945 ]
Stock Position:  -0.006742668785558348
Bond Position:  [-3.3293871]


portfolio before change:  [-4.00217967]
curr_Stock_Price:  99.71962080850125
curr_Factors:  [9.97196208e+01 4.13357459e-02]
mat_Sqrt:  [[ 2.02741898e+01  0.00000000e+00]
 [-8.13247769e-03  1.86338473e-02]]
grads:  [0.00618395 4.36708363]
Stock Position:  0.0061839495361104505
Bond Position:  [-4.61884078]


portfolio before change:  [-4.00528665]
curr_Stock_Price:  99.3105638900365
curr_Factors:  [9.93105639e+01 4.18296104e-02]
mat_Sqrt:  [[ 2.03112830e+01  0.00000000e+00]
 [-8.18091539e-03  1.87448320e-02]]
grads:  [ 0.04030823 32.12840602]
Stock Position:  0.040308226645845636
Bond Position:  [-8.00831937]


portfolio before change:  [-3.97765208]
curr_Stock_Price:  100.02098144637093
curr_Factors:  [1.00020981e+02 4.13533896e-02]
mat_Sqrt:  [[ 2.03397995e+01  0.00000000e+00]
 [-8.13421314e-03  1.86378237e-02]]
grads:  [-2.48757339e-03  3.58958366e+00]
Stock Position:  -0.002487573389706405
Bond Position:  [-3.72884255]


portfolio before change:  [-3.98430408]
curr_Stock_Price:  102.50768723334448
curr_Factors:  [1.02507687e+02 4.09472256e-02]
mat_Sqrt:  [[ 2.07428619e+01  0.00000000e+00]
 [-8.09416833e-03  1.85460695e-02]]
grads:  [-1.84742509e-02 -2.49565514e+01]
Stock Position:  -0.018474250942177257
Bond Position:  [-2.09055134]


portfolio before change:  [-3.98655048]
curr_Stock_Price:  102.61513748142934
curr_Factors:  [1.02615137e+02 4.05459301e-02]
mat_Sqrt:  [[ 2.06626046e+01  0.00000000e+00]
 [-8.05440800e-03  1.84549672e-02]]
grads:  [-0.00335972 -0.75578521]
Stock Position:  -0.0033597192186646885
Bond Position:  [-3.64179243]


portfolio before change:  [-3.98995529]
curr_Stock_Price:  103.49305701476536
curr_Factors:  [1.03493057e+02 3.94130018e-02]
mat_Sqrt:  [[ 2.05461745e+01  0.00000000e+00]
 [-7.94108323e-03  1.81953075e-02]]
grads:  [-9.30078490e-03 -9.47538313e+00]
Stock Position:  -0.009300784897599033
Bond Position:  [-3.02738863]


portfolio before change:  [-3.99491488]
curr_Stock_Price:  103.9856114597539
curr_Factors:  [1.03985611e+02 3.99579975e-02]
mat_Sqrt:  [[ 2.07862003e+01  0.00000000e+00]
 [-7.99579864e-03  1.83206763e-02]]
grads:  [-0.0030466  -1.41823617]
Stock Position:  -0.0030465950403833018
Bond Position:  [-3.67811284]


portfolio before change:  [-3.99671379]
curr_Stock_Price:  104.4251549000353
curr_Factors:  [1.04425155e+02 4.11351552e-02]
mat_Sqrt:  [[ 2.11793047e+01  0.00000000e+00]
 [-8.11272139e-03  1.85885799e-02]]
grads:  [-2.98649042e-03 -1.06302672e+01]
Stock Position:  -0.0029864904230033893
Bond Position:  [-3.68484906]


portfolio before change:  [-3.99751678]
curr_Stock_Price:  104.53979069005739
curr_Factors:  [1.04539791e+02 3.91963921e-02]
mat_Sqrt:  [[ 2.06968700e+01  0.00000000e+00]
 [-7.91923148e-03  1.81452389e-02]]
grads:  [-1.62943375e-03 -4.02749284e+00]
Stock Position:  -0.0016294337451461978
Bond Position:  [-3.82717612]


portfolio before change:  [-3.99727403]
curr_Stock_Price:  104.09719799850946
curr_Factors:  [1.04097198e+02 4.19188010e-02]
mat_Sqrt:  [[ 2.13129451e+01  0.00000000e+00]
 [-8.18963256e-03  1.87648056e-02]]
grads:  [-1.09147312e-02 -4.16944398e+01]
Stock Position:  -0.010914731206875701
Bond Position:  [-2.8610811]


portfolio before change:  [-3.99571429]
curr_Stock_Price:  103.92152713259374
curr_Factors:  [1.03921527e+02 4.20069069e-02]
mat_Sqrt:  [[ 2.12993266e+01  0.00000000e+00]
 [-8.19823463e-03  1.87845154e-02]]
grads:  [-3.34465045e-03 -1.14586788e+01]
Stock Position:  -0.0033446504482569105
Bond Position:  [-3.64813311]


portfolio before change:  [-3.99907723]
curr_Stock_Price:  104.79064544440503
curr_Factors:  [1.04790645e+02 4.26460170e-02]
mat_Sqrt:  [[ 2.16402241e+01  0.00000000e+00]
 [-8.26036483e-03  1.89268736e-02]]
grads:  [-1.47474251e-03 -8.44793028e+00]
Stock Position:  -0.0014747425081819078
Bond Position:  [-3.84453801]


portfolio before change:  [-4.00035638]
curr_Stock_Price:  105.33213306947911
curr_Factors:  [1.05332133e+02 4.35987902e-02]
mat_Sqrt:  [[ 2.19936899e+01  0.00000000e+00]
 [-8.35212932e-03  1.91371324e-02]]
grads:  [-1.03485617e-02 -1.35650683e+01]
Stock Position:  -0.010348561708881624
Bond Position:  [-2.91032031]


portfolio before change:  [-4.00433553]
curr_Stock_Price:  105.68148883731536
curr_Factors:  [1.05681489e+02 4.30795351e-02]
mat_Sqrt:  [[ 2.19348378e+01  0.00000000e+00]
 [-8.30224404e-03  1.90228309e-02]]
grads:  [-2.20931974e-04 -5.73486617e+00]
Stock Position:  -0.00022093197384388488
Bond Position:  [-3.98098711]


portfolio before change:  [-4.00481922]
curr_Stock_Price:  105.61830141088073
curr_Factors:  [1.05618301e+02 4.21771716e-02]
mat_Sqrt:  [[ 2.16909166e+01  0.00000000e+00]
 [-8.21483260e-03  1.88225461e-02]]
grads:  [ 0.00469184 -0.97054769]
Stock Position:  0.00469184163655574
Bond Position:  [-4.50036357]


portfolio before change:  [-4.0124575]
curr_Stock_Price:  104.11021575099694
curr_Factors:  [1.04110216e+02 4.36527832e-02]
mat_Sqrt:  [[ 2.17520061e+01  0.00000000e+00]
 [-8.35729939e-03  1.91489785e-02]]
grads:  [ 9.57044833e-03 -1.91933948e+01]
Stock Position:  0.009570448328121811
Bond Position:  [-5.00883894]


portfolio before change:  [-4.00910715]
curr_Stock_Price:  104.52571260112911
curr_Factors:  [1.04525713e+02 4.36096988e-02]
mat_Sqrt:  [[ 2.18280370e+01  0.00000000e+00]
 [-8.35317413e-03  1.91395264e-02]]
grads:  [-5.33322090e-03 -1.71751907e+01]
Stock Position:  -0.0053332208982867545
Bond Position:  [-3.45164844]


portfolio before change:  [-4.01838254]
curr_Stock_Price:  106.18397978733769
curr_Factors:  [1.06183980e+02 4.36063815e-02]
mat_Sqrt:  [[ 2.21734884e+01  0.00000000e+00]
 [-8.35285642e-03  1.91387984e-02]]
grads:  [3.12136849e-03 5.86185535e+00]
Stock Position:  0.0031213684912588234
Bond Position:  [-4.34982187]


portfolio before change:  [-4.0190459]
curr_Stock_Price:  106.1456652370869
curr_Factors:  [1.06145665e+02 4.24359684e-02]
mat_Sqrt:  [[ 2.18659989e+01  0.00000000e+00]
 [-8.23999693e-03  1.88802048e-02]]
grads:  [ 1.17974791e-02 -2.45215074e+01]
Stock Position:  0.011797479148002695
Bond Position:  [-5.27129717]


portfolio before change:  [-4.01952785]
curr_Stock_Price:  106.16066892639333
curr_Factors:  [1.06160669e+02 4.20029570e-02]
mat_Sqrt:  [[ 2.17572288e+01  0.00000000e+00]
 [-8.19784918e-03  1.87836322e-02]]
grads:  [-0.02008829  3.49744941]
Stock Position:  -0.020088291487569597
Bond Position:  [-1.88694138]


portfolio before change:  [-3.99502119]
curr_Stock_Price:  104.92897938015328
curr_Factors:  [1.04928979e+02 4.26455054e-02]
mat_Sqrt:  [[ 2.16686613e+01  0.00000000e+00]
 [-8.26031529e-03  1.89267600e-02]]
grads:  [-3.85253988e-03  7.19858596e+00]
Stock Position:  -0.0038525398754570644
Bond Position:  [-3.59077811]


portfolio before change:  [-4.0001586]
curr_Stock_Price:  106.14597814617788
curr_Factors:  [1.06145978e+02 4.20879144e-02]
mat_Sqrt:  [[ 2.17762075e+01  0.00000000e+00]
 [-8.20613569e-03  1.88026190e-02]]
grads:  [-0.00752038 -7.44057046]
Stock Position:  -0.0075203837514537355
Bond Position:  [-3.20190011]


portfolio before change:  [-3.98743146]
curr_Stock_Price:  104.40040218735147
curr_Factors:  [1.04400402e+02 4.29582819e-02]
mat_Sqrt:  [[ 2.16384239e+01  0.00000000e+00]
 [-8.29055192e-03  1.89960409e-02]]
grads:  [1.12034721e-03 1.08197196e+01]
Stock Position:  0.001120347205511167
Bond Position:  [-4.10439616]


portfolio before change:  [-3.98859047]
curr_Stock_Price:  103.82385865622688
curr_Factors:  [1.03823859e+02 4.31141862e-02]
mat_Sqrt:  [[ 2.15579402e+01  0.00000000e+00]
 [-8.30558233e-03  1.90304799e-02]]
grads:  [-0.03346173 -1.83391362]
Stock Position:  -0.03346173308506374
Bond Position:  [-0.51446423]


portfolio before change:  [-4.00226231]
curr_Stock_Price:  104.23051793123382
curr_Factors:  [1.04230518e+02 4.25408933e-02]
mat_Sqrt:  [[ 2.14980069e+01  0.00000000e+00]
 [-8.25017753e-03  1.89035315e-02]]
grads:  [-0.00751246 -1.3220708 ]
Stock Position:  -0.0075124596153729505
Bond Position:  [-3.21923475]


portfolio before change:  [-3.9883876]
curr_Stock_Price:  102.33005619469512
curr_Factors:  [1.02330056e+02 4.42183734e-02]
mat_Sqrt:  [[ 2.15181333e+01  0.00000000e+00]
 [-8.41126611e-03  1.92726318e-02]]
grads:  [ 7.90581780e-04 -2.50436667e+00]
Stock Position:  0.0007905817801509065
Bond Position:  [-4.06928787]


portfolio before change:  [-3.98977308]
curr_Stock_Price:  101.22101006043908
curr_Factors:  [1.01221010e+02 4.48008341e-02]
mat_Sqrt:  [[ 2.14246490e+01  0.00000000e+00]
 [-8.46648301e-03  1.93991496e-02]]
grads:  [-0.0092706   7.26928418]
Stock Position:  -0.009270600356872733
Bond Position:  [-3.05139355]


portfolio before change:  [-3.98714765]
curr_Stock_Price:  100.89666419221554
curr_Factors:  [1.00896664e+02 4.57186860e-02]
mat_Sqrt:  [[ 2.15736525e+01  0.00000000e+00]
 [-8.55277134e-03  1.95968610e-02]]
grads:  [0.00416758 3.16224416]
Stock Position:  0.00416758428050107
Bond Position:  [-4.407643]


portfolio before change:  [-3.98905749]
curr_Stock_Price:  100.57061220268392
curr_Factors:  [1.00570612e+02 4.60656584e-02]
mat_Sqrt:  [[ 2.15853818e+01  0.00000000e+00]
 [-8.58516473e-03  1.96710836e-02]]
grads:  [-3.14731748e-03  4.46315581e+00]
Stock Position:  -0.0031473174781382835
Bond Position:  [-3.67252984]


portfolio before change:  [-3.98385144]
curr_Stock_Price:  98.77062101344544
curr_Factors:  [9.8770621e+01 4.7827633e-02]
mat_Sqrt:  [[ 2.16006703e+01  0.00000000e+00]
 [-8.74781189e-03  2.00437551e-02]]
grads:  [-3.87994834e-03  5.65276440e+00]
Stock Position:  -0.0038799483376485686
Bond Position:  [-3.60062653]


portfolio before change:  [-3.98795125]
curr_Stock_Price:  99.71127970758586
curr_Factors:  [9.97112797e+01 4.64751051e-02]
mat_Sqrt:  [[ 2.14958430e+01  0.00000000e+00]
 [-8.62323421e-03  1.97583117e-02]]
grads:  [-4.67094115e-03 -8.27789263e+00]
Stock Position:  -0.00467094115037041
Bond Position:  [-3.52220573]


portfolio before change:  [-3.98968613]
curr_Stock_Price:  99.98843409438476
curr_Factors:  [9.99884341e+01 4.77169309e-02]
mat_Sqrt:  [[ 2.18416789e+01  0.00000000e+00]
 [-8.73768215e-03  2.00205449e-02]]
grads:  [-7.10036820e-04 -1.37642645e+00]
Stock Position:  -0.0007100368199353784
Bond Position:  [-3.91869066]


portfolio before change:  [-3.98926151]
curr_Stock_Price:  98.70049254815106
curr_Factors:  [9.87004925e+01 4.78781380e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.98926151]
Stock Price:  97.69453146170022
PL:  [-3.98926151]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.24377280e+00  3.10093326e-01]
 [ 3.45307322e-01  1.13293805e-01]
 [ 1.10475511e-01 -2.14926153e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.66388524e-02  1.06584165e-01]
 [-2.29628838e-01  4.57269822e-02]
 [ 2.04313914e-01 -2.17716362e-01]
 [ 1.00493952e-01  4.15871924e-01]
 [-7.53940101e-02  8.35854422e-02]
 [ 1.79188775e-01  4.53632693e-02]
 [-8.12519369e-02 -1.01322646e-02]
 [-5.04168959e-02 -1.35469366e-01]
 [-5.86781298e-02 -1.79453020e-02]
 [ 2.22358617e-02 -2.06616733e-01]
 [ 2.39548847e-01  1.34044249e-01]
 [ 1.33618767e-01 -3.40579225e-01]
 [ 3.95623367e-02  8.88934057e-02]
 [-1.05878930e-03 -2.61922472e-02]
 [-4.60664583e-02 -3.10103543e-02]
 [-7.08798625e-02 -4.25604305e-02]
 [ 1.69309104e-01 -3.86712816e-02]
 [ 6.64376016e-01 -1.15685312e-01]
 [ 2.78605012e-02 -2.78755201e-01]
 [ 1.79309948e-02  2.23697223e-02]
 [ 1.31047152e-01 -5.35415865e-02]
 [ 1.35031762e-01 -1.01621700e-01]
 [ 5.97812134e-02 -2.60807930e-01]
 [ 4.95236593e-02  1.52399630e-01]
 [ 2.85253854e-02  1.50151532e-01]
 [-5.44065253e-01 -9.74401050e-02]
 [-1.68081286e-01 -6.32849741e-02]
 [ 8.20168638e-03 -6.84243459e-02]
 [-2.59950129e-01  1.37554999e-01]
 [ 2.99819100e-02  3.11356538e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.12600141e-01  1.43552232e-02]
 [-2.66933402e-02 -1.84140467e-01]
 [-6.38328109e-03 -5.91903374e-02]
 [-2.89040708e-02 -3.64184678e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.13880161]
curr_Stock_Price:  100.35668340424473
curr_Factors:  [1.00356683e+02 3.83353809e-02]
mat_Sqrt:  [[ 1.96492597e+01  0.00000000e+00]
 [-7.83176924e-03  1.79448377e-02]]
grads:  [ 0.07018629 17.28036391]
Stock Position:  0.0701862893192709
Bond Position:  [-1.9048616]


portfolio before change:  [5.12895157]
curr_Stock_Price:  100.21973465632838
curr_Factors:  [1.00219735e+02 3.89648388e-02]
mat_Sqrt:  [[ 1.97828879e+01  0.00000000e+00]
 [-7.89580535e-03  1.80915628e-02]]
grads:  [0.01995426 6.26224534]
Stock Position:  0.019954255077925063
Bond Position:  [3.12914142]


portfolio before change:  [5.12609106]
curr_Stock_Price:  100.05677825964999
curr_Factors:  [1.00056778e+02 3.90766549e-02]
mat_Sqrt:  [[ 1.97790398e+01  0.00000000e+00]
 [-7.90712639e-03  1.81175026e-02]]
grads:  [ 0.00511124 -1.18629017]
Stock Position:  0.005111237214934426
Bond Position:  [4.61467713]


portfolio before change:  [5.13074577]
curr_Stock_Price:  100.85459744183716
curr_Factors:  [1.00854597e+02 3.97910463e-02]
mat_Sqrt:  [[ 2.01181656e+01  0.00000000e+00]
 [-7.97907727e-03  1.82823628e-02]]
grads:  [-8.10280979e-04 -8.28048400e+00]
Stock Position:  -0.0008102809789943145
Bond Position:  [5.21246633]


portfolio before change:  [5.13194755]
curr_Stock_Price:  100.17560491228231
curr_Factors:  [1.00175605e+02 3.97533019e-02]
mat_Sqrt:  [[ 1.99732426e+01  0.00000000e+00]
 [-7.97529203e-03  1.82736897e-02]]
grads:  [-2.00877293e-03  5.83265705e+00]
Stock Position:  -0.002008772932975089
Bond Position:  [5.33317759]


portfolio before change:  [5.13176413]
curr_Stock_Price:  100.59880233090043
curr_Factors:  [1.00598802e+02 3.93214725e-02]
mat_Sqrt:  [[ 1.99483829e+01  0.00000000e+00]
 [-7.93185703e-03  1.81741676e-02]]
grads:  [-0.01051072  2.51604272]
Stock Position:  -0.010510723989394693
Bond Position:  [6.18913037]


portfolio before change:  [5.11829788]
curr_Stock_Price:  101.95360308515116
curr_Factors:  [1.01953603e+02 3.86288836e-02]
mat_Sqrt:  [[ 2.00381977e+01  0.00000000e+00]
 [-7.86169280e-03  1.80134012e-02]]
grads:  [ 5.45431807e-03 -1.20863550e+01]
Stock Position:  0.005454318069698599
Bond Position:  [4.5622105]


portfolio before change:  [5.11318246]
curr_Stock_Price:  100.91117601651423
curr_Factors:  [1.00911176e+02 3.78055118e-02]
mat_Sqrt:  [[ 1.96208053e+01  0.00000000e+00]
 [-7.77745581e-03  1.78203900e-02]]
grads:  [1.43722612e-02 2.33368588e+01]
Stock Position:  0.014372261232752353
Bond Position:  [3.66286068]


portfolio before change:  [5.09936798]
curr_Stock_Price:  99.91812650486966
curr_Factors:  [9.99181265e+01 3.81094573e-02]
mat_Sqrt:  [[ 1.95056607e+01  0.00000000e+00]
 [-7.80865748e-03  1.78918820e-02]]
grads:  [-1.99502765e-03  4.67169648e+00]
Stock Position:  -0.0019950276544424828
Bond Position:  [5.29870741]


portfolio before change:  [5.09910353]
curr_Stock_Price:  100.38269760983044
curr_Factors:  [1.00382698e+02 3.91650993e-02]
mat_Sqrt:  [[ 1.98659107e+01  0.00000000e+00]
 [-7.91606966e-03  1.81379942e-02]]
grads:  [0.0100165  2.50100804]
Stock Position:  0.010016501735321703
Bond Position:  [4.09362007]


portfolio before change:  [5.10501593]
curr_Stock_Price:  100.92187386620098
curr_Factors:  [1.00921874e+02 3.99428590e-02]
mat_Sqrt:  [[ 2.01699527e+01  0.00000000e+00]
 [-7.99428386e-03  1.83172055e-02]]
grads:  [-0.00424761 -0.55315559]
Stock Position:  -0.004247606377997679
Bond Position:  [5.53369232]


portfolio before change:  [5.09832149]
curr_Stock_Price:  102.66077927829407
curr_Factors:  [1.02660779e+02 3.89915086e-02]
mat_Sqrt:  [[ 2.02716722e+01  0.00000000e+00]
 [-7.89850705e-03  1.80977532e-02]]
grads:  [-5.40362794e-03 -7.48542455e+00]
Stock Position:  -0.0054036279436149495
Bond Position:  [5.65306215]


portfolio before change:  [5.10527512]
curr_Stock_Price:  101.50471348899882
curr_Factors:  [1.01504713e+02 4.05833422e-02]
mat_Sqrt:  [[ 2.04484369e+01  0.00000000e+00]
 [-8.05812308e-03  1.84634795e-02]]
grads:  [-0.00325258 -0.971935  ]
Stock Position:  -0.003252576328149173
Bond Position:  [5.43542695]


portfolio before change:  [5.10072111]
curr_Stock_Price:  103.11373859898123
curr_Factors:  [1.03113739e+02 3.91175122e-02]
mat_Sqrt:  [[ 2.03939874e+01  0.00000000e+00]
 [-7.91125903e-03  1.81269717e-02]]
grads:  [-3.3313286e-03 -1.1398304e+01]
Stock Position:  -0.0033313286032574433
Bond Position:  [5.44422686]


portfolio before change:  [5.10358749]
curr_Stock_Price:  102.4576018657952
curr_Factors:  [1.02457602e+02 3.91987140e-02]
mat_Sqrt:  [[ 2.02852375e+01  0.00000000e+00]
 [-7.91946604e-03  1.81457763e-02]]
grads:  [0.01469298 7.38707715]
Stock Position:  0.014692978271216278
Bond Position:  [3.59818017]


portfolio before change:  [5.07954259]
curr_Stock_Price:  100.79049915807101
curr_Factors:  [1.00790499e+02 4.10573970e-02]
mat_Sqrt:  [[ 2.04228008e+01  0.00000000e+00]
 [-8.10504998e-03  1.85710025e-02]]
grads:  [-7.35559851e-04 -1.83393020e+01]
Stock Position:  -0.0007355598513308883
Bond Position:  [5.15368003]


portfolio before change:  [5.08086474]
curr_Stock_Price:  99.86888582008957
curr_Factors:  [9.98688858e+01 4.16618332e-02]
mat_Sqrt:  [[ 2.03844685e+01  0.00000000e+00]
 [-8.16449222e-03  1.87072018e-02]]
grads:  [3.84403447e-03 4.75182802e+00]
Stock Position:  0.0038440344674723634
Bond Position:  [4.6969653]


portfolio before change:  [5.0794042]
curr_Stock_Price:  99.33619186528632
curr_Factors:  [9.93361919e+01 4.25467134e-02]
mat_Sqrt:  [[ 2.04899319e+01  0.00000000e+00]
 [-8.25074187e-03  1.89048246e-02]]
grads:  [-6.09568796e-04 -1.38547951e+00]
Stock Position:  -0.0006095687961376298
Bond Position:  [5.13995645]


portfolio before change:  [5.08048221]
curr_Stock_Price:  98.62180236654041
curr_Factors:  [9.86218024e+01 4.10281970e-02]
mat_Sqrt:  [[ 1.99762586e+01  0.00000000e+00]
 [-8.10216731e-03  1.85643975e-02]]
grads:  [-0.00298357 -1.67042072]
Stock Position:  -0.002983566028189385
Bond Position:  [5.37472687]


portfolio before change:  [5.07756205]
curr_Stock_Price:  99.82574378541322
curr_Factors:  [9.98257438e+01 4.11066959e-02]
mat_Sqrt:  [[ 2.02394562e+01  0.00000000e+00]
 [-8.10991451e-03  1.85821486e-02]]
grads:  [-0.00441982 -2.2903934 ]
Stock Position:  -0.004419820190184208
Bond Position:  [5.51877389]


portfolio before change:  [5.07120689]
curr_Stock_Price:  101.41971170582953
curr_Factors:  [1.01419712e+02 3.96907068e-02]
mat_Sqrt:  [[ 2.02053691e+01  0.00000000e+00]
 [-7.96901066e-03  1.82592973e-02]]
grads:  [ 0.00754411 -2.11789539]
Stock Position:  0.007544112283604529
Bond Position:  [4.3060852]


portfolio before change:  [5.06869577]
curr_Stock_Price:  101.01549976235138
curr_Factors:  [1.01015500e+02 3.98177785e-02]
mat_Sqrt:  [[ 2.01570294e+01  0.00000000e+00]
 [-7.98175705e-03  1.82885029e-02]]
grads:  [ 0.03045522 -6.32557581]
Stock Position:  0.030455221984373865
Bond Position:  [1.9922463]


portfolio before change:  [5.05921299]
curr_Stock_Price:  100.69595441342945
curr_Factors:  [1.00695954e+02 4.15385204e-02]
mat_Sqrt:  [[ 2.05228435e+01  0.00000000e+00]
 [-8.15240043e-03  1.86794960e-02]]
grads:  [-4.57043112e-03 -1.49230579e+01]
Stock Position:  -0.0045704311174971386
Bond Position:  [5.51943691]


portfolio before change:  [5.06031588]
curr_Stock_Price:  100.6056080699845
curr_Factors:  [1.00605608e+02 4.08383436e-02]
mat_Sqrt:  [[ 2.03308834e+01  0.00000000e+00]
 [-8.08339964e-03  1.85213954e-02]]
grads:  [0.00136216 1.20777738]
Stock Position:  0.0013621612747217638
Bond Position:  [4.92327482]


portfolio before change:  [5.06007252]
curr_Stock_Price:  99.97513257171678
curr_Factors:  [9.99751326e+01 4.02221818e-02]
mat_Sqrt:  [[ 2.00504813e+01  0.00000000e+00]
 [-8.02218741e-03  1.83811405e-02]]
grads:  [ 0.00537043 -2.91285442]
Stock Position:  0.005370429082098676
Bond Position:  [4.52316316]


portfolio before change:  [5.05609246]
curr_Stock_Price:  99.1287391792138
curr_Factors:  [9.91287392e+01 4.03232054e-02]
mat_Sqrt:  [[ 1.99056840e+01  0.00000000e+00]
 [-8.03225551e-03  1.84042094e-02]]
grads:  [ 4.55550361e-03 -5.52165529e+00]
Stock Position:  0.004555503607465497
Bond Position:  [4.60451113]


portfolio before change:  [5.05796134]
curr_Stock_Price:  99.4126334442139
curr_Factors:  [9.94126334e+01 3.96248360e-02]
mat_Sqrt:  [[ 1.97890669e+01  0.00000000e+00]
 [-7.96239522e-03  1.82441394e-02]]
grads:  [-2.73103826e-03 -1.42954361e+01]
Stock Position:  -0.002731038264301947
Bond Position:  [5.32946104]


portfolio before change:  [5.05809709]
curr_Stock_Price:  99.60687137750506
curr_Factors:  [9.96068714e+01 3.91106988e-02]
mat_Sqrt:  [[ 1.96986783e+01  0.00000000e+00]
 [-7.91057002e-03  1.81253930e-02]]
grads:  [5.89056327e-03 8.40807314e+00]
Stock Position:  0.005890563265781967
Bond Position:  [4.47135651]


portfolio before change:  [5.0598015]
curr_Stock_Price:  99.80132671879694
curr_Factors:  [9.98013267e+01 3.89694441e-02]
mat_Sqrt:  [[ 1.97014604e+01  0.00000000e+00]
 [-7.89627194e-03  1.80926319e-02]]
grads:  [4.77410733e-03 8.29904308e+00]
Stock Position:  0.004774107325732552
Bond Position:  [4.58333925]


portfolio before change:  [5.06547588]
curr_Stock_Price:  100.86989012267728
curr_Factors:  [1.00869890e+02 3.88825892e-02]
mat_Sqrt:  [[ 1.98901994e+01  0.00000000e+00]
 [-7.88746744e-03  1.80724583e-02]]
grads:  [-0.02949149 -5.39163535]
Stock Position:  -0.029491489278733317
Bond Position:  [8.04027917]


portfolio before change:  [5.08369045]
curr_Stock_Price:  100.28635000149214
curr_Factors:  [1.00286350e+02 3.90584019e-02]
mat_Sqrt:  [[ 1.98197905e+01  0.00000000e+00]
 [-7.90527944e-03  1.81132707e-02]]
grads:  [-0.00987403 -3.49384576]
Stock Position:  -0.009874025293019664
Bond Position:  [6.07392041]


portfolio before change:  [5.08966929]
curr_Stock_Price:  99.75773536350948
curr_Factors:  [9.97577354e+01 3.89141908e-02]
mat_Sqrt:  [[ 1.96788893e+01  0.00000000e+00]
 [-7.89067204e-03  1.80798010e-02]]
grads:  [-1.10073013e-03 -3.78457407e+00]
Stock Position:  -0.0011007301304576337
Bond Position:  [5.19947564]


portfolio before change:  [5.08897952]
curr_Stock_Price:  100.97487972452636
curr_Factors:  [1.00974880e+02 3.56586845e-02]
mat_Sqrt:  [[ 1.90675987e+01  0.00000000e+00]
 [-7.55340289e-03  1.73070203e-02]]
grads:  [-0.0104846  7.9479308]
Stock Position:  -0.01048460314195166
Bond Position:  [6.14766106]


portfolio before change:  [5.10182589]
curr_Stock_Price:  99.82291773728126
curr_Factors:  [9.98229177e+01 3.59908732e-02]
mat_Sqrt:  [[ 1.89376660e+01  0.00000000e+00]
 [-7.58850428e-03  1.73874476e-02]]
grads:  [0.00230074 1.7906972 ]
Stock Position:  0.0023007388294044376
Bond Position:  [4.87215943]


portfolio before change:  [5.10562781]
curr_Stock_Price:  101.2106719989577
curr_Factors:  [1.01210672e+02 3.58051135e-02]
mat_Sqrt:  [[ 1.91513254e+01  0.00000000e+00]
 [-7.56889567e-03  1.73425187e-02]]
grads:  [-0.00494314  4.68935036]
Stock Position:  -0.00494313624157243
Bond Position:  [5.60592595]


portfolio before change:  [5.09307235]
curr_Stock_Price:  103.89241965912015
curr_Factors:  [1.03892420e+02 3.46325513e-02]
mat_Sqrt:  [[ 1.93341954e+01  0.00000000e+00]
 [-7.44392921e-03  1.70561845e-02]]
grads:  [-0.01584421  0.84164329]
Stock Position:  -0.015844207710068753
Bond Position:  [6.73916542]


portfolio before change:  [5.09653359]
curr_Stock_Price:  103.72713550504001
curr_Factors:  [1.03727136e+02 3.46822842e-02]
mat_Sqrt:  [[ 1.93172914e+01  0.00000000e+00]
 [-7.44927210e-03  1.70684266e-02]]
grads:  [-5.54212422e-03 -1.07883680e+01]
Stock Position:  -0.005542124222227972
Bond Position:  [5.67140226]


portfolio before change:  [5.09735462]
curr_Stock_Price:  103.7069167095981
curr_Factors:  [1.03706917e+02 3.49067538e-02]
mat_Sqrt:  [[ 1.93759254e+01  0.00000000e+00]
 [-7.47333969e-03  1.71235724e-02]]
grads:  [-1.66268509e-03 -3.45665823e+00]
Stock Position:  -0.0016626850854746646
Bond Position:  [5.26978656]


portfolio before change:  [5.0995538]
curr_Stock_Price:  102.78045280273281
curr_Factors:  [1.02780453e+02 3.68244815e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.0995538]
Stock Price:  101.74216047138944
PL:  [3.35739333]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.18756261e+00  2.97385327e-01]
 [ 6.55050924e-01  1.11323767e-01]
 [ 9.74549587e-02 -3.38302430e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.85002683e-02  5.88950890e-01]
 [-7.01208636e-02 -1.19774424e-01]
 [ 8.81662758e-02  9.31323827e-02]
 [ 7.09768194e-01  6.99537349e-01]
 [-3.16077201e-02  2.47967959e-01]
 [ 1.91492874e-01  8.88911878e-02]
 [-1.04380663e-01 -3.29429118e-03]
 [ 7.31909119e-03 -1.36053071e-01]
 [-5.76679545e-02 -1.79377714e-02]
 [-2.80461498e-02 -6.69188795e-02]
 [ 3.52060659e-01  2.15883375e-01]
 [ 1.34921648e-01 -4.82896060e-01]
 [ 3.43386376e-02 -9.63255767e-02]
 [ 2.96659522e-02 -1.50948628e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-1.49407262e-01  8.13676715e-03]
 [ 1.61687560e-01 -2.01956500e-02]
 [ 1.20969940e+00  1.18990586e-01]
 [ 1.59677209e-02  4.17649701e-01]
 [-1.45580661e-01  1.60927507e-01]
 [-1.99415769e-01  1.27500667e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 6.24544759e-02 -4.54851452e-01]
 [ 7.81803167e-02  3.58164154e-02]
 [ 4.57567729e-01 -2.59337049e-01]
 [-5.15979458e-01 -2.53025432e-01]
 [-4.83776180e-02 -1.47421679e-02]
 [-5.25554060e-02  4.37006212e-02]
 [ 3.23311881e-01  2.14754448e-01]
 [ 3.05632368e-02 -1.62217516e-02]
 [ 1.65925755e-01 -1.02901195e-01]
 [-6.25551960e-02  1.18800344e-01]
 [-3.92847704e-02 -7.47633122e-02]
 [-8.82380685e-02 -5.57529981e-02]
 [ 1.26469579e-01 -1.30236385e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.8398449]
curr_Stock_Price:  100.60359828380491
curr_Factors:  [1.00603598e+02 3.90142026e-02]
mat_Sqrt:  [[ 1.98712360e+01  0.00000000e+00]
 [-7.90080529e-03  1.81030191e-02]]
grads:  [ 0.06629443 16.42738843]
Stock Position:  0.0662944269334907
Bond Position:  [0.17038701]


portfolio before change:  [6.76435457]
curr_Stock_Price:  99.46456394034588
curr_Factors:  [9.94645639e+01 3.94219660e-02]
mat_Sqrt:  [[ 1.97486550e+01  0.00000000e+00]
 [-7.94198625e-03  1.81973766e-02]]
grads:  [0.0356296  6.11757229]
Stock Position:  0.03562959604552898
Bond Position:  [3.22047234]


portfolio before change:  [6.74004396]
curr_Stock_Price:  98.77094968810906
curr_Factors:  [9.87709497e+01 4.00333916e-02]
mat_Sqrt:  [[ 1.97624335e+01  0.00000000e+00]
 [-8.00333846e-03  1.83379522e-02]]
grads:  [ 0.00418421 -1.84482121]
Stock Position:  0.004184212945958593
Bond Position:  [6.32676528]


portfolio before change:  [6.74533625]
curr_Stock_Price:  99.84675379406751
curr_Factors:  [9.98467538e+01 3.91331996e-02]
mat_Sqrt:  [[ 1.97517977e+01  0.00000000e+00]
 [-7.91284521e-03  1.81306061e-02]]
grads:  [-8.25310547e-04 -8.34979327e+00]
Stock Position:  -0.0008253105473374626
Bond Position:  [6.82774083]


portfolio before change:  [6.7476772]
curr_Stock_Price:  98.04448639050787
curr_Factors:  [9.80444864e+01 3.94267233e-02]
mat_Sqrt:  [[ 1.94678736e+01  0.00000000e+00]
 [-7.94246544e-03  1.81984746e-02]]
grads:  [8.14362040e-03 3.23626515e+01]
Stock Position:  0.008143620401739915
Bond Position:  [5.94924012]


portfolio before change:  [6.75441265]
curr_Stock_Price:  98.78024577497924
curr_Factors:  [9.87802458e+01 3.84858325e-02]
mat_Sqrt:  [[ 1.93785173e+01  0.00000000e+00]
 [-7.84712252e-03  1.79800165e-02]]
grads:  [-6.31599963e-03 -6.66153030e+00]
Stock Position:  -0.006315999632177502
Bond Position:  [7.37830864]


portfolio before change:  [6.75047773]
curr_Stock_Price:  99.54928679709629
curr_Factors:  [9.95492868e+01 3.82722721e-02]
mat_Sqrt:  [[ 1.94751260e+01  0.00000000e+00]
 [-7.82532014e-03  1.79300609e-02]]
grads:  [0.00661421 5.19420335]
Stock Position:  0.006614210353324879
Bond Position:  [6.09203781]


portfolio before change:  [6.74590936]
curr_Stock_Price:  98.74345822170254
curr_Factors:  [9.87434582e+01 3.78155977e-02]
mat_Sqrt:  [[ 1.92018829e+01  0.00000000e+00]
 [-7.77849319e-03  1.78227669e-02]]
grads:  [ 0.05286311 39.2496492 ]
Stock Position:  0.052863113835261655
Bond Position:  [1.52602269]


portfolio before change:  [6.75111988]
curr_Stock_Price:  98.83841571023211
curr_Factors:  [9.88384157e+01 3.76586862e-02]
mat_Sqrt:  [[ 1.91804308e+01  0.00000000e+00]
 [-7.76233843e-03  1.77857517e-02]]
grads:  [3.99440295e-03 1.39419442e+01]
Stock Position:  0.0039944029491930655
Bond Position:  [6.35631942]


portfolio before change:  [6.75100029]
curr_Stock_Price:  98.6095513452283
curr_Factors:  [9.86095513e+01 3.68360289e-02]
mat_Sqrt:  [[ 1.89258496e+01  0.00000000e+00]
 [-7.67708580e-03  1.75904134e-02]]
grads:  [0.01216792 5.05338822]
Stock Position:  0.01216791708907654
Bond Position:  [5.55112745]


portfolio before change:  [6.76753917]
curr_Stock_Price:  99.91174141859199
curr_Factors:  [9.99117414e+01 3.86968025e-02]
mat_Sqrt:  [[ 1.96541411e+01  0.00000000e+00]
 [-7.86860114e-03  1.80292302e-02]]
grads:  [-0.00538403 -0.18271946]
Stock Position:  -0.005384026177655119
Bond Position:  [7.3054666]


portfolio before change:  [6.76406459]
curr_Stock_Price:  100.72671018931845
curr_Factors:  [1.00726710e+02 3.85377483e-02]
mat_Sqrt:  [[ 1.97736944e+01  0.00000000e+00]
 [-7.85241347e-03  1.79921396e-02]]
grads:  [-2.63275724e-03 -7.56180614e+00]
Stock Position:  -0.0026327572446138933
Bond Position:  [7.02925357]


portfolio before change:  [6.76239008]
curr_Stock_Price:  101.69650169577599
curr_Factors:  [1.01696502e+02 3.82580307e-02]
mat_Sqrt:  [[ 1.98914902e+01  0.00000000e+00]
 [-7.82386408e-03  1.79267247e-02]]
grads:  [-0.0032927  -1.00061621]
Stock Position:  -0.003292696482800964
Bond Position:  [7.09724579]


portfolio before change:  [6.76228968]
curr_Stock_Price:  101.99644172987749
curr_Factors:  [1.01996442e+02 4.01786753e-02]
mat_Sqrt:  [[ 2.04447982e+01  0.00000000e+00]
 [-8.01784762e-03  1.83711968e-02]]
grads:  [-2.80031833e-03 -3.64259771e+00]
Stock Position:  -0.0028003183348065375
Bond Position:  [7.04791218]


portfolio before change:  [6.76524107]
curr_Stock_Price:  101.25711719834727
curr_Factors:  [1.01257117e+02 4.01134464e-02]
mat_Sqrt:  [[ 2.02801212e+01  0.00000000e+00]
 [-8.01133660e-03  1.83562782e-02]]
grads:  [ 0.02200578 11.76073782]
Stock Position:  0.022005780099752355
Bond Position:  [4.53699921]


portfolio before change:  [6.77772192]
curr_Stock_Price:  101.79850635977655
curr_Factors:  [1.01798506e+02 4.10302769e-02]
mat_Sqrt:  [[ 2.06202359e+01  0.00000000e+00]
 [-8.10237268e-03  1.85648681e-02]]
grads:  [-3.67752680e-03 -2.60112842e+01]
Stock Position:  -0.0036775267998599578
Bond Position:  [7.15208865]


portfolio before change:  [6.77881747]
curr_Stock_Price:  101.74371691538649
curr_Factors:  [1.01743717e+02 4.00249797e-02]
mat_Sqrt:  [[ 2.03550962e+01  0.00000000e+00]
 [-8.00249758e-03  1.83360254e-02]]
grads:  [-3.78347052e-04 -5.25335095e+00]
Stock Position:  -0.0003783470521795021
Bond Position:  [6.81731191]


portfolio before change:  [6.77966371]
curr_Stock_Price:  101.75954086516376
curr_Factors:  [1.01759541e+02 4.01566027e-02]
mat_Sqrt:  [[ 2.03917088e+01  0.00000000e+00]
 [-8.01564498e-03  1.83661499e-02]]
grads:  [-1.77588991e-03 -8.21884980e+00]
Stock Position:  -0.0017758899109469558
Bond Position:  [6.96037745]


portfolio before change:  [6.78361766]
curr_Stock_Price:  100.02302884543023
curr_Factors:  [1.00023029e+02 4.09150890e-02]
mat_Sqrt:  [[ 2.02321367e+01  0.00000000e+00]
 [-8.09099143e-03  1.85387903e-02]]
grads:  [-1.57557824e-02 -2.53138223e+01]
Stock Position:  -0.01575578242964611
Bond Position:  [8.35955874]


portfolio before change:  [6.80519657]
curr_Stock_Price:  98.7197677482657
curr_Factors:  [9.87197677e+01 4.20624680e-02]
mat_Sqrt:  [[ 2.02465719e+01  0.00000000e+00]
 [-8.20365460e-03  1.87969341e-02]]
grads:  [-0.00720399  0.43287736]
Stock Position:  -0.007203989207026591
Bond Position:  [7.51637271]


portfolio before change:  [6.81013206]
curr_Stock_Price:  98.16509078646051
curr_Factors:  [9.81650908e+01 4.26077774e-02]
mat_Sqrt:  [[ 2.02628959e+01  0.00000000e+00]
 [-8.25666057e-03  1.89183860e-02]]
grads:  [ 0.0075445  -1.06751443]
Stock Position:  0.007544501859531004
Bond Position:  [6.06952535]


portfolio before change:  [6.80438727]
curr_Stock_Price:  97.30306810784549
curr_Factors:  [9.73030681e+01 4.20209651e-02]
mat_Sqrt:  [[ 1.99461714e+01  0.00000000e+00]
 [-8.19960634e-03  1.87876584e-02]]
grads:  [0.0632518  6.33344418]
Stock Position:  0.06325179512931131
Bond Position:  [0.64979354]


portfolio before change:  [6.69788207]
curr_Stock_Price:  95.61795497424697
curr_Factors:  [9.56179550e+01 4.30769765e-02]
mat_Sqrt:  [[ 1.98455006e+01  0.00000000e+00]
 [-8.30199750e-03  1.90222660e-02]]
grads:  [9.98941766e-03 2.19558333e+01]
Stock Position:  0.009989417660537408
Bond Position:  [5.74271438]


portfolio before change:  [6.68815551]
curr_Stock_Price:  94.57240497871456
curr_Factors:  [9.45724050e+01 4.44072988e-02]
mat_Sqrt:  [[ 1.99292801e+01  0.00000000e+00]
 [-8.42921574e-03  1.93137596e-02]]
grads:  [-3.78067540e-03  8.33227247e+00]
Stock Position:  -0.003780675401148335
Bond Position:  [7.04570308]


portfolio before change:  [6.68762185]
curr_Stock_Price:  94.94652799622588
curr_Factors:  [9.49465280e+01 4.22132875e-02]
mat_Sqrt:  [[ 1.95075926e+01  0.00000000e+00]
 [-8.21834899e-03  1.88306032e-02]]
grads:  [-0.00736995  6.77092847]
Stock Position:  -0.0073699466100080775
Bond Position:  [7.38737269]


portfolio before change:  [6.70007302]
curr_Stock_Price:  93.38237874126429
curr_Factors:  [9.33823787e+01 4.28360908e-02]
mat_Sqrt:  [[ 1.93272404e+01  0.00000000e+00]
 [-8.27875264e-03  1.89690053e-02]]
grads:  [ 0.00949326 -3.84814786]
Stock Position:  0.009493264392421168
Bond Position:  [5.81356941]


portfolio before change:  [6.70946293]
curr_Stock_Price:  94.29493812860703
curr_Factors:  [9.42949381e+01 4.29149543e-02]
mat_Sqrt:  [[ 1.95340685e+01  0.00000000e+00]
 [-8.28636995e-03  1.89864588e-02]]
grads:  [-6.96521425e-03 -2.39566239e+01]
Stock Position:  -0.006965214247297523
Bond Position:  [7.36624738]


portfolio before change:  [6.70535804]
curr_Stock_Price:  95.0164852071597
curr_Factors:  [9.50164852e+01 4.36264245e-02]
mat_Sqrt:  [[ 1.98460359e+01  0.00000000e+00]
 [-8.35477583e-03  1.91431963e-02]]
grads:  [0.00472698 1.87097362]
Stock Position:  0.004726983392206966
Bond Position:  [6.25621669]


portfolio before change:  [6.70676464]
curr_Stock_Price:  95.14860368920239
curr_Factors:  [9.51486037e+01 4.38823840e-02]
mat_Sqrt:  [[ 1.99318461e+01  0.00000000e+00]
 [-8.37924903e-03  1.91992715e-02]]
grads:  [  0.01727807 -13.50765049]
Stock Position:  0.017278066421631526
Bond Position:  [5.06278074]


portfolio before change:  [6.70610166]
curr_Stock_Price:  95.07360323325607
curr_Factors:  [9.50736032e+01 4.25035282e-02]
mat_Sqrt:  [[ 1.96007390e+01  0.00000000e+00]
 [-8.24655353e-03  1.88952279e-02]]
grads:  [ -0.03195843 -13.39097013]
Stock Position:  -0.031958428252210985
Bond Position:  [9.74450459]


portfolio before change:  [6.66050304]
curr_Stock_Price:  96.53853017439903
curr_Factors:  [9.65385302e+01 4.17831769e-02]
mat_Sqrt:  [[ 1.97333769e+01  0.00000000e+00]
 [-8.17637347e-03  1.87344252e-02]]
grads:  [-0.00277761 -0.7869026 ]
Stock Position:  -0.0027776101269730434
Bond Position:  [6.92864944]


portfolio before change:  [6.66208607]
curr_Stock_Price:  96.28043200655348
curr_Factors:  [9.62804320e+01 4.23836179e-02]
mat_Sqrt:  [[ 1.98215240e+01  0.00000000e+00]
 [-8.23491279e-03  1.88685556e-02]]
grads:  [-1.68921881e-03  2.31605546e+00]
Stock Position:  -0.0016892188134656882
Bond Position:  [6.82472479]


portfolio before change:  [6.6651429]
curr_Stock_Price:  94.9758712523039
curr_Factors:  [9.49758713e+01 4.33455906e-02]
mat_Sqrt:  [[ 1.97736002e+01  0.00000000e+00]
 [-8.32784156e-03  1.90814822e-02]]
grads:  [ 0.02109067 11.25459994]
Stock Position:  0.021090666444804857
Bond Position:  [4.66203848]


portfolio before change:  [6.67655705]
curr_Stock_Price:  95.48943311412478
curr_Factors:  [9.54894331e+01 4.29658338e-02]
mat_Sqrt:  [[ 1.97932421e+01  0.00000000e+00]
 [-8.29128061e-03  1.89977105e-02]]
grads:  [ 0.00118644 -0.85387929]
Stock Position:  0.0011864394870646125
Bond Position:  [6.56326462]


portfolio before change:  [6.67823986]
curr_Stock_Price:  96.21626942783158
curr_Factors:  [9.62162694e+01 4.37388165e-02]
mat_Sqrt:  [[ 2.01225043e+01  0.00000000e+00]
 [-8.36553085e-03  1.91678392e-02]]
grads:  [ 0.00601396 -5.3684296 ]
Stock Position:  0.00601396278569168
Bond Position:  [6.0995988]


portfolio before change:  [6.68716102]
curr_Stock_Price:  97.57288878808811
curr_Factors:  [9.75728888e+01 4.17678607e-02]
mat_Sqrt:  [[ 1.99411536e+01  0.00000000e+00]
 [-8.17487475e-03  1.87309912e-02]]
grads:  [-5.36903500e-04  6.34244834e+00]
Stock Position:  -0.0005369035001555344
Bond Position:  [6.73954824]


portfolio before change:  [6.68788396]
curr_Stock_Price:  97.79555577192394
curr_Factors:  [9.77955558e+01 4.05880896e-02]
mat_Sqrt:  [[ 1.97023679e+01  0.00000000e+00]
 [-8.05859438e-03  1.84645594e-02]]
grads:  [-3.65002599e-03 -4.04901686e+00]
Stock Position:  -0.0036500259878703522
Bond Position:  [7.04484028]


portfolio before change:  [6.68664386]
curr_Stock_Price:  98.37658140105133
curr_Factors:  [9.83765814e+01 4.02092718e-02]
mat_Sqrt:  [[ 1.97267178e+01  0.00000000e+00]
 [-8.02089988e-03  1.83781904e-02]]
grads:  [-0.00570651 -3.03365004]
Stock Position:  -0.0057065079541301
Bond Position:  [7.24803061]


portfolio before change:  [6.68769499]
curr_Stock_Price:  98.35116079443384
curr_Factors:  [9.83511608e+01 4.09702876e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.68769499]
Stock Price:  97.94579151379585
PL:  [6.68769499]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48461697e+00  3.64963795e-01]
 [ 1.05551623e+00  7.19925586e-02]
 [ 7.02887649e-02  1.70525701e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.53913068e-02  1.94864890e-01]
 [-7.16322132e-02 -1.22168985e-01]
 [ 8.74972513e-02  9.60131265e-02]
 [ 5.04052438e-01  5.67808201e-01]
 [-4.07889776e-02  2.14761874e-01]
 [ 1.81082339e-01  4.38549916e-02]
 [-9.58071291e-02 -6.13910397e-03]
 [ 1.46575149e-02 -1.35921942e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.31594211e-02 -3.77278121e-02]
 [ 2.51652346e-01  1.42871459e-01]
 [ 1.32585442e-01 -2.70583085e-01]
 [ 3.73637198e-02 -3.77001245e-02]
 [ 2.80504454e-02 -1.49187192e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-6.52651001e-02 -4.58475388e-02]
 [ 1.72804701e-01 -4.09577046e-02]
 [ 6.57266988e-01 -1.20200194e-01]
 [ 2.96407321e-02 -3.66486322e-01]
 [-5.63818433e-03  3.39116422e-02]
 [ 5.96403296e-02 -1.16276632e-02]
 [ 1.30177803e-01 -1.03325471e-01]
 [ 1.44991631e-01 -1.75897609e-01]
 [ 5.22409704e-02  9.10344612e-02]
 [ 2.60920495e-01 -3.07670135e-02]
 [-5.27297683e-01 -2.02470297e-01]
 [-9.41218608e-02 -3.15509580e-02]
 [ 4.59357901e-04 -4.87946285e-02]
 [ 7.79269807e-02  1.87978539e-01]
 [ 9.05955370e-03  5.93340606e-03]
 [ 4.20125894e-02  5.36188246e-03]
 [-6.63498848e-02  1.18676136e-01]
 [-3.55905287e-02 -1.05199326e-01]
 [ 1.93745655e-02 -2.78494635e-02]
 [-5.96557960e-02 -4.39624741e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.7558607]
curr_Stock_Price:  99.06557900653304
curr_Factors:  [9.90655790e+01 4.00657868e-02]
mat_Sqrt:  [[ 1.98294021e+01  0.00000000e+00]
 [-8.00657598e-03  1.83453702e-02]]
grads:  [ 0.08290216 19.8940545 ]
Stock Position:  0.08290215817622174
Bond Position:  [-11.968611]


portfolio before change:  [-3.80991678]
curr_Stock_Price:  98.43157963658597
curr_Factors:  [9.84315796e+01 4.21389591e-02]
mat_Sqrt:  [[ 2.02058143e+01  0.00000000e+00]
 [-8.21111043e-03  1.88140176e-02]]
grads:  [0.05379325 3.82653829]
Stock Position:  0.053793247218017974
Bond Position:  [-9.10487108]


portfolio before change:  [-3.81882128]
curr_Stock_Price:  98.2872061364009
curr_Factors:  [9.82872061e+01 4.16727008e-02]
mat_Sqrt:  [[ 2.00642446e+01  0.00000000e+00]
 [-8.16555701e-03  1.87096415e-02]]
grads:  [0.00387411 0.91143222]
Stock Position:  0.003874111290553713
Bond Position:  [-4.19959686]


portfolio before change:  [-3.81989367]
curr_Stock_Price:  98.14590720752312
curr_Factors:  [9.81459072e+01 4.08889601e-02]
mat_Sqrt:  [[ 1.98461023e+01  0.00000000e+00]
 [-8.08840752e-03  1.85328698e-02]]
grads:  [-8.21388839e-04 -8.16855747e+00]
Stock Position:  -0.0008213888390205075
Bond Position:  [-3.73927772]


portfolio before change:  [-3.82108516]
curr_Stock_Price:  99.02740313636735
curr_Factors:  [9.90274031e+01 4.18212319e-02]
mat_Sqrt:  [[ 2.02513417e+01  0.00000000e+00]
 [-8.18009603e-03  1.87429546e-02]]
grads:  [4.76743891e-04 1.03967007e+01]
Stock Position:  0.00047674389091836676
Bond Position:  [-3.86829587]


portfolio before change:  [-3.82167534]
curr_Stock_Price:  98.8037850882675
curr_Factors:  [9.88037851e+01 4.24746338e-02]
mat_Sqrt:  [[ 2.03628426e+01  0.00000000e+00]
 [-8.24375000e-03  1.88888042e-02]]
grads:  [-6.13623215e-03 -6.46779877e+00]
Stock Position:  -0.006136232151486984
Bond Position:  [-3.21539238]


portfolio before change:  [-3.82350315]
curr_Stock_Price:  99.03615246734537
curr_Factors:  [9.90361525e+01 4.27736563e-02]
mat_Sqrt:  [[ 2.04824521e+01  0.00000000e+00]
 [-8.27271721e-03  1.89551764e-02]]
grads:  [0.00631764 5.06527211]
Stock Position:  0.0063176427600341
Bond Position:  [-4.44917818]


portfolio before change:  [-3.82073225]
curr_Stock_Price:  99.5627851059962
curr_Factors:  [9.95627851e+01 4.24928905e-02]
mat_Sqrt:  [[ 2.05236771e+01  0.00000000e+00]
 [-8.24552150e-03  1.88928632e-02]]
grads:  [ 0.03663399 30.05411062]
Stock Position:  0.03663399343172832
Bond Position:  [-7.46811467]


portfolio before change:  [-3.83898946]
curr_Stock_Price:  99.08990091100982
curr_Factors:  [9.90899009e+01 4.33689711e-02]
mat_Sqrt:  [[ 2.06356880e+01  0.00000000e+00]
 [-8.33008726e-03  1.90866277e-02]]
grads:  [2.56549666e-03 1.12519549e+01]
Stock Position:  0.0025654966573361838
Bond Position:  [-4.09320427]


portfolio before change:  [-3.83740876]
curr_Stock_Price:  99.90548918585554
curr_Factors:  [9.99054892e+01 4.50172105e-02]
mat_Sqrt:  [[ 2.11972070e+01  0.00000000e+00]
 [-8.48690384e-03  1.94459396e-02]]
grads:  [0.00944569 2.25522615]
Stock Position:  0.009445689096328763
Bond Position:  [-4.78108495]


portfolio before change:  [-3.83407075]
curr_Stock_Price:  100.32215345263099
curr_Factors:  [1.00322153e+02 4.57757466e-02]
mat_Sqrt:  [[ 2.14641930e+01  0.00000000e+00]
 [-8.55810695e-03  1.96090864e-02]]
grads:  [-0.00458841 -0.31307445]
Stock Position:  -0.004588407021935427
Bond Position:  [-3.37375187]


portfolio before change:  [-3.83475189]
curr_Stock_Price:  100.37868656897548
curr_Factors:  [1.00378687e+02 4.67225599e-02]
mat_Sqrt:  [[ 2.16972565e+01  0.00000000e+00]
 [-8.64616076e-03  1.98108431e-02]]
grads:  [-2.05849454e-03 -6.86098727e+00]
Stock Position:  -0.0020584945363669683
Bond Position:  [-3.62812291]


portfolio before change:  [-3.83430486]
curr_Stock_Price:  99.94119597777718
curr_Factors:  [9.99411960e+01 4.80893423e-02]
mat_Sqrt:  [[ 2.19163870e+01  0.00000000e+00]
 [-8.77171292e-03  2.00985192e-02]]
grads:  [-0.00590193 -1.39569512]
Stock Position:  -0.00590192572010644
Bond Position:  [-3.24445935]


portfolio before change:  [-3.83693896]
curr_Stock_Price:  100.31878714127227
curr_Factors:  [1.00318787e+02 4.75507700e-02]
mat_Sqrt:  [[ 2.18756542e+01  0.00000000e+00]
 [-8.72245562e-03  1.99856566e-02]]
grads:  [-0.00272564 -1.88774444]
Stock Position:  -0.0027256413742384206
Bond Position:  [-3.56350592]


portfolio before change:  [-3.8428688]
curr_Stock_Price:  102.33092856008939
curr_Factors:  [1.02330929e+02 4.87828208e-02]
mat_Sqrt:  [[ 2.26016617e+01  0.00000000e+00]
 [-8.83473334e-03  2.02429171e-02]]
grads:  [0.01389307 7.05784933]
Stock Position:  0.01389307423154128
Bond Position:  [-5.26455999]


portfolio before change:  [-3.87164484]
curr_Stock_Price:  100.30704766956217
curr_Factors:  [1.00307048e+02 4.94604649e-02]
mat_Sqrt:  [[ 2.23079953e+01  0.00000000e+00]
 [-8.89588353e-03  2.03830298e-02]]
grads:  [ 6.49690937e-04 -1.32749198e+01]
Stock Position:  0.0006496909369028609
Bond Position:  [-3.93681342]


portfolio before change:  [-3.87162055]
curr_Stock_Price:  101.10192444081315
curr_Factors:  [1.01101924e+02 4.94228290e-02]
mat_Sqrt:  [[ 2.24762173e+01  0.00000000e+00]
 [-8.89249832e-03  2.03752733e-02]]
grads:  [ 9.30318309e-04 -1.85028804e+00]
Stock Position:  0.000930318309073093
Bond Position:  [-3.96567752]


portfolio before change:  [-3.87205694]
curr_Stock_Price:  101.16571714491752
curr_Factors:  [1.01165717e+02 5.02871066e-02]
mat_Sqrt:  [[ 2.26861964e+01  0.00000000e+00]
 [-8.96991474e-03  2.05526566e-02]]
grads:  [-1.63360055e-03 -7.25877896e+00]
Stock Position:  -0.0016336005509427225
Bond Position:  [-3.70679257]


portfolio before change:  [-3.87302509]
curr_Stock_Price:  101.47470771853776
curr_Factors:  [1.01474708e+02 4.82726320e-02]
mat_Sqrt:  [[ 2.22950422e+01  0.00000000e+00]
 [-8.78841347e-03  2.01367850e-02]]
grads:  [-1.42979386e-02 -2.33049936e+01]
Stock Position:  -0.014297938605158158
Bond Position:  [-2.42214595]


portfolio before change:  [-3.85292747]
curr_Stock_Price:  100.04790064500742
curr_Factors:  [1.00047901e+02 4.78748732e-02]
mat_Sqrt:  [[ 2.18908083e+01  0.00000000e+00]
 [-8.75213101e-03  2.00536514e-02]]
grads:  [-0.00389545 -2.28624393]
Stock Position:  -0.0038954526113722998
Bond Position:  [-3.46319562]


portfolio before change:  [-3.85683167]
curr_Stock_Price:  100.93900969271935
curr_Factors:  [1.00939010e+02 4.78517452e-02]
mat_Sqrt:  [[ 2.20804505e+01  0.00000000e+00]
 [-8.75001671e-03  2.00488069e-02]]
grads:  [ 0.00701658 -2.04289985]
Stock Position:  0.00701658207705658
Bond Position:  [-4.56507852]


portfolio before change:  [-3.85647961]
curr_Stock_Price:  101.07051706254381
curr_Factors:  [1.01070517e+02 4.76753937e-02]
mat_Sqrt:  [[ 2.20684399e+01  0.00000000e+00]
 [-8.73387828e-03  2.00118292e-02]]
grads:  [ 0.02740598 -6.00645713]
Stock Position:  0.027405984599371457
Bond Position:  [-6.62641665]


portfolio before change:  [-3.8510327]
curr_Stock_Price:  101.29949140664247
curr_Factors:  [1.01299491e+02 4.76331965e-02]
mat_Sqrt:  [[ 2.21086451e+01  0.00000000e+00]
 [-8.73001228e-03  2.00029710e-02]]
grads:  [-5.89393928e-03 -1.83215944e+01]
Stock Position:  -0.005893939284130804
Bond Position:  [-3.25397965]


portfolio before change:  [-3.84430447]
curr_Stock_Price:  100.08892621632448
curr_Factors:  [1.00088926e+02 4.84425808e-02]
mat_Sqrt:  [[ 2.20292477e+01  0.00000000e+00]
 [-8.80387013e-03  2.01722006e-02]]
grads:  [4.15904793e-04 1.68110772e+00]
Stock Position:  0.00041590479265726186
Bond Position:  [-3.88593194]


portfolio before change:  [-3.84503033]
curr_Stock_Price:  99.51167120917206
curr_Factors:  [9.95116712e+01 4.84217607e-02]
mat_Sqrt:  [[ 2.18974886e+01  0.00000000e+00]
 [-8.80197803e-03  2.01678653e-02]]
grads:  [ 0.00249187 -0.57654407]
Stock Position:  0.0024918657287583304
Bond Position:  [-4.09300005]


portfolio before change:  [-3.84695333]
curr_Stock_Price:  98.94529100058533
curr_Factors:  [9.89452910e+01 4.85466411e-02]
mat_Sqrt:  [[ 2.18009151e+01  0.00000000e+00]
 [-8.81332093e-03  2.01938551e-02]]
grads:  [ 3.90272015e-03 -5.11667884e+00]
Stock Position:  0.003902720145020839
Bond Position:  [-4.23310911]


portfolio before change:  [-3.8435846]
curr_Stock_Price:  99.94405697405897
curr_Factors:  [9.99440570e+01 4.86888339e-02]
mat_Sqrt:  [[ 2.20532023e+01  0.00000000e+00]
 [-8.82621857e-03  2.02234073e-02]]
grads:  [ 3.09359246e-03 -8.69772369e+00]
Stock Position:  0.003093592464096519
Bond Position:  [-4.15277078]


portfolio before change:  [-3.84934755]
curr_Stock_Price:  98.24899684451142
curr_Factors:  [9.82489968e+01 4.73253165e-02]
mat_Sqrt:  [[ 2.13734627e+01  0.00000000e+00]
 [-8.70175307e-03  1.99382211e-02]]
grads:  [4.30307750e-03 4.56582666e+00]
Stock Position:  0.004303077496202778
Bond Position:  [-4.2721206]


portfolio before change:  [-3.85326579]
curr_Stock_Price:  97.46253817859566
curr_Factors:  [9.74625382e+01 4.80295376e-02]
mat_Sqrt:  [[ 2.13595412e+01  0.00000000e+00]
 [-8.76625691e-03  2.00860179e-02]]
grads:  [ 0.01158698 -1.53176272]
Stock Position:  0.011586984323399375
Bond Position:  [-4.98256269]


portfolio before change:  [-3.86559545]
curr_Stock_Price:  96.45219735750914
curr_Factors:  [9.64521974e+01 4.58487537e-02]
mat_Sqrt:  [[ 2.06526552e+01  0.00000000e+00]
 [-8.56492883e-03  1.96247173e-02]]
grads:  [ -0.02981035 -10.3171064 ]
Stock Position:  -0.029810354166680448
Bond Position:  [-0.99032129]


portfolio before change:  [-3.87720889]
curr_Stock_Price:  96.83762162124717
curr_Factors:  [9.68376216e+01 4.61212107e-02]
mat_Sqrt:  [[ 2.07967018e+01  0.00000000e+00]
 [-8.59033976e-03  1.96829411e-02]]
grads:  [-0.00518793 -1.60295953]
Stock Position:  -0.005187929747071772
Bond Position:  [-3.37482211]


portfolio before change:  [-3.88508157]
curr_Stock_Price:  98.27380222997061
curr_Factors:  [9.82738022e+01 4.69289005e-02]
mat_Sqrt:  [[ 2.12891317e+01  0.00000000e+00]
 [-8.66523172e-03  1.98545401e-02]]
grads:  [-9.78732443e-04 -2.45760557e+00]
Stock Position:  -0.0009787324425905618
Bond Position:  [-3.78889781]


portfolio before change:  [-3.88466874]
curr_Stock_Price:  97.36807337177447
curr_Factors:  [9.73680734e+01 4.64805345e-02]
mat_Sqrt:  [[ 2.09919186e+01  0.00000000e+00]
 [-8.62373789e-03  1.97594658e-02]]
grads:  [7.62043453e-03 9.51334115e+00]
Stock Position:  0.007620434529166988
Bond Position:  [-4.62665577]


portfolio before change:  [-3.88507748]
curr_Stock_Price:  97.39033316226902
curr_Factors:  [9.73903332e+01 4.41971698e-02]
mat_Sqrt:  [[ 2.04744895e+01  0.00000000e+00]
 [-8.40924918e-03  1.92680104e-02]]
grads:  [0.00056896 0.30794077]
Stock Position:  0.0005689570143020096
Bond Position:  [-3.9404884]


portfolio before change:  [-3.88507919]
curr_Stock_Price:  98.25311232499074
curr_Factors:  [9.82531123e+01 4.33666065e-02]
mat_Sqrt:  [[ 2.04608672e+01  0.00000000e+00]
 [-8.32986017e-03  1.90861074e-02]]
grads:  [0.00216768 0.28093117]
Stock Position:  0.0021676846019275955
Bond Position:  [-4.09806095]


portfolio before change:  [-3.88695097]
curr_Stock_Price:  97.62595179827358
curr_Factors:  [9.76259518e+01 4.28679869e-02]
mat_Sqrt:  [[ 2.02130489e+01  0.00000000e+00]
 [-8.28183428e-03  1.89760662e-02]]
grads:  [-7.20097845e-04  6.25399037e+00]
Stock Position:  -0.0007200978449161295
Bond Position:  [-3.81665073]


portfolio before change:  [-3.88819218]
curr_Stock_Price:  98.6870560968422
curr_Factors:  [9.86870561e+01 4.35204971e-02]
mat_Sqrt:  [[ 2.05876662e+01  0.00000000e+00]
 [-8.34462674e-03  1.91199418e-02]]
grads:  [-3.95884012e-03 -5.50207356e+00]
Stock Position:  -0.003958840120120042
Bond Position:  [-3.4975059]


portfolio before change:  [-3.89803285]
curr_Stock_Price:  101.06236210553685
curr_Factors:  [1.01062362e+02 4.19595583e-02]
mat_Sqrt:  [[ 2.07016470e+01  0.00000000e+00]
 [-8.19361295e-03  1.87739258e-02]]
grads:  [ 3.48767571e-04 -1.48341183e+00]
Stock Position:  0.0003487675710592809
Bond Position:  [-3.93328012]


portfolio before change:  [-3.8981399]
curr_Stock_Price:  102.16521436665805
curr_Factors:  [1.02165214e+02 4.18167749e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.8981399]
Stock Price:  102.69853765927947
PL:  [-6.59667756]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.49281144e+00  3.66395971e-01]
 [ 1.48443721e+00  3.19120404e-02]
 [-2.92204320e-01  2.66899989e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-2.34947102e-01  1.66686691e+00]
 [ 1.02774242e-01  1.36941592e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.13340214e+00  1.15819607e+00]
 [ 6.57401861e-02  5.07934247e-01]
 [ 9.08395892e-02 -7.55289537e-02]
 [ 5.87696332e-03  1.89616578e-02]
 [ 7.08691310e-02 -1.04928050e-01]
 [-1.19358406e-01 -2.55296064e-02]
 [-1.03112642e-01  1.58520809e-01]
 [ 4.78119232e-01  3.11088486e-01]
 [ 1.30674937e-01  7.56822123e-02]
 [ 4.10038095e-02  1.21365058e-01]
 [ 1.10347975e-01  8.43883271e-02]
 [-4.99248588e-02 -3.23864555e-02]
 [-2.41262654e-01  6.81543801e-02]
 [ 1.40793983e-01  1.39075999e-02]
 [ 1.14134987e+00  1.06437907e-01]
 [ 1.76859039e-02  2.76870742e-01]
 [-1.17684704e-01  8.82683638e-02]
 [-1.80541544e-01  1.52717232e-01]
 [ 1.67138177e-01 -8.99340152e-02]
 [-9.72096619e-02 -4.50805963e-01]
 [ 6.41844916e-02  6.56098460e-02]
 [ 3.08964261e-01 -8.29420579e-02]
 [-5.26580333e-01 -2.03452313e-01]
 [-1.63887730e-01 -5.73802585e-02]
 [-1.69463594e-02 -1.73111311e-02]
 [ 1.75242607e-01  2.01691895e-01]
 [ 4.85380599e-03  8.89827244e-03]
 [ 8.23749430e-02 -3.75476248e-02]
 [-5.97211052e-02  1.18930294e-01]
 [-4.68461792e-02  2.05275723e-02]
 [-3.28086688e-01 -1.20278446e-01]
 [ 1.45478056e-01  8.78578553e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.2618162]
curr_Stock_Price:  99.28244698315198
curr_Factors:  [9.92824470e+01 4.09656816e-02]
mat_Sqrt:  [[ 2.00947481e+01  0.00000000e+00]
 [-8.09599226e-03  1.85502487e-02]]
grads:  [ 0.08224635 19.75153961]
Stock Position:  0.0822463534217811
Bond Position:  [-10.42743543]


portfolio before change:  [-2.4422426]
curr_Stock_Price:  97.10456461775601
curr_Factors:  [9.71045646e+01 4.30266413e-02]
mat_Sqrt:  [[ 2.01422679e+01  0.00000000e+00]
 [-8.29714566e-03  1.90111490e-02]]
grads:  [0.07438908 1.67859609]
Stock Position:  0.07438907929186662
Bond Position:  [-9.66576175]


portfolio before change:  [-2.54154451]
curr_Stock_Price:  95.78590844135742
curr_Factors:  [9.57859084e+01 4.55216625e-02]
mat_Sqrt:  [[ 2.04366958e+01  0.00000000e+00]
 [-8.53432247e-03  1.95545894e-02]]
grads:  [-8.59824000e-03  1.36489693e+01]
Stock Position:  -0.008598240000674908
Bond Position:  [-1.71795428]


portfolio before change:  [-2.52532562]
curr_Stock_Price:  93.87462786732323
curr_Factors:  [9.38746279e+01 4.56340908e-02]
mat_Sqrt:  [[ 2.00536268e+01  0.00000000e+00]
 [-8.54485490e-03  1.95787222e-02]]
grads:  [-8.12888715e-04 -7.73221107e+00]
Stock Position:  -0.0008128887152257298
Bond Position:  [-2.44901599]


portfolio before change:  [-2.52520993]
curr_Stock_Price:  93.35569420023606
curr_Factors:  [9.33556942e+01 4.61860682e-02]
mat_Sqrt:  [[ 2.00630201e+01  0.00000000e+00]
 [-8.59637767e-03  1.96967757e-02]]
grads:  [2.45493079e-02 8.46263842e+01]
Stock Position:  0.024549307874635384
Bond Position:  [-4.81702761]


portfolio before change:  [-2.5171106]
curr_Stock_Price:  93.71014390912069
curr_Factors:  [9.37101439e+01 4.51295609e-02]
mat_Sqrt:  [[ 1.99075199e+01  0.00000000e+00]
 [-8.49748771e-03  1.94701903e-02]]
grads:  [0.00816478 7.03339769]
Stock Position:  0.008164776589550104
Bond Position:  [-3.28223299]


portfolio before change:  [-2.50159088]
curr_Stock_Price:  95.66121064045797
curr_Factors:  [9.56612106e+01 4.33013151e-02]
mat_Sqrt:  [[ 1.99061107e+01  0.00000000e+00]
 [-8.32358722e-03  1.90717342e-02]]
grads:  [0.0064992  5.04080468]
Stock Position:  0.006499199108639846
Bond Position:  [-3.12331214]


portfolio before change:  [-2.50104671]
curr_Stock_Price:  95.80501472600001
curr_Factors:  [9.58050147e+01 4.41648814e-02]
mat_Sqrt:  [[ 2.01338476e+01  0.00000000e+00]
 [-8.40617691e-03  1.92609710e-02]]
grads:  [ 0.08139926 60.13175894]
Stock Position:  0.0813992623349551
Bond Position:  [-10.29950424]


portfolio before change:  [-2.48489606]
curr_Stock_Price:  96.01924479669151
curr_Factors:  [9.60192448e+01 4.42178509e-02]
mat_Sqrt:  [[ 2.01909662e+01  0.00000000e+00]
 [-8.41121640e-03  1.92725179e-02]]
grads:  [1.42351220e-02 2.63553651e+01]
Stock Position:  0.014235121952298303
Bond Position:  [-3.85174172]


portfolio before change:  [-2.49485498]
curr_Stock_Price:  95.35346702822517
curr_Factors:  [9.53534670e+01 4.40437849e-02]
mat_Sqrt:  [[ 2.00114614e+01  0.00000000e+00]
 [-8.39464448e-03  1.92345469e-02]]
grads:  [ 2.89214517e-03 -3.92673423e+00]
Stock Position:  0.0028921451656532555
Bond Position:  [-2.77063105]


portfolio before change:  [-2.49503486]
curr_Stock_Price:  95.41102867726639
curr_Factors:  [9.54110287e+01 4.34068060e-02]
mat_Sqrt:  [[ 1.98782200e+01  0.00000000e+00]
 [-8.33372004e-03  1.90949514e-02]]
grads:  [7.11960588e-04 9.93019429e-01]
Stock Position:  0.0007119605884731721
Bond Position:  [-2.56296375]


portfolio before change:  [-2.49460752]
curr_Stock_Price:  96.46126408678988
curr_Factors:  [9.64612641e+01 4.22158763e-02]
mat_Sqrt:  [[ 1.98194160e+01  0.00000000e+00]
 [-8.21860098e-03  1.88311806e-02]]
grads:  [ 1.26516219e-03 -5.57203781e+00]
Stock Position:  0.0012651621853319894
Bond Position:  [-2.61664667]


portfolio before change:  [-2.49535547]
curr_Stock_Price:  96.12862124703446
curr_Factors:  [9.61286212e+01 4.38993683e-02]
mat_Sqrt:  [[ 2.01410380e+01  0.00000000e+00]
 [-8.38087044e-03  1.92029866e-02]]
grads:  [-0.00647933 -1.3294602 ]
Stock Position:  -0.0064793303763288545
Bond Position:  [-1.87250637]


portfolio before change:  [-2.50402987]
curr_Stock_Price:  97.43127452802491
curr_Factors:  [9.74312745e+01 4.38566675e-02]
mat_Sqrt:  [[ 2.04040415e+01  0.00000000e+00]
 [-8.37679342e-03  1.91936450e-02]]
grads:  [-1.66283181e-03  8.25902581e+00]
Stock Position:  -0.0016628318092221052
Bond Position:  [-2.34201805]


portfolio before change:  [-2.50460316]
curr_Stock_Price:  97.59997588530992
curr_Factors:  [9.75999759e+01 4.30472492e-02]
mat_Sqrt:  [[ 2.02498781e+01  0.00000000e+00]
 [-8.29913240e-03  1.90157012e-02]]
grads:  [ 0.03031571 16.35955902]
Stock Position:  0.030315707410760895
Bond Position:  [-5.46341547]


portfolio before change:  [-2.51336187]
curr_Stock_Price:  97.33358793368869
curr_Factors:  [9.73335879e+01 4.38721466e-02]
mat_Sqrt:  [[ 2.03871808e+01  0.00000000e+00]
 [-8.37827157e-03  1.91970318e-02]]
grads:  [0.00802982 3.94239135]
Stock Position:  0.008029818534216257
Bond Position:  [-3.29493292]


portfolio before change:  [-2.52211335]
curr_Stock_Price:  96.29501075635923
curr_Factors:  [9.62950108e+01 4.51551871e-02]
mat_Sqrt:  [[ 2.04624490e+01  0.00000000e+00]
 [-8.49989996e-03  1.94757175e-02]]
grads:  [4.59240551e-03 6.23160909e+00]
Stock Position:  0.004592405510077887
Bond Position:  [-2.96433909]


portfolio before change:  [-2.52009906]
curr_Stock_Price:  96.81431485434982
curr_Factors:  [9.68143149e+01 4.53434987e-02]
mat_Sqrt:  [[ 2.06156527e+01  0.00000000e+00]
 [-8.51760518e-03  1.95162852e-02]]
grads:  [0.00713914 4.32399537]
Stock Position:  0.007139141415940911
Bond Position:  [-3.21127014]


portfolio before change:  [-2.5187603]
curr_Stock_Price:  97.0580683789743
curr_Factors:  [9.70580684e+01 4.48342769e-02]
mat_Sqrt:  [[ 2.05511784e+01  0.00000000e+00]
 [-8.46964244e-03  1.94063888e-02]]
grads:  [-0.00311707 -1.66885534]
Stock Position:  -0.003117070252133705
Bond Position:  [-2.21622348]


portfolio before change:  [-2.52188776]
curr_Stock_Price:  97.97252185669522
curr_Factors:  [9.79725219e+01 4.39770701e-02]
mat_Sqrt:  [[ 2.05455340e+01  0.00000000e+00]
 [-8.38828422e-03  1.92199737e-02]]
grads:  [-0.01029507  3.54601838]
Stock Position:  -0.010295066761058312
Bond Position:  [-1.51325411]


portfolio before change:  [-2.51418228]
curr_Stock_Price:  97.20568400638392
curr_Factors:  [9.7205684e+01 4.3296595e-02]
mat_Sqrt:  [[ 2.02263972e+01  0.00000000e+00]
 [-8.32313354e-03  1.90706947e-02]]
grads:  [0.00726099 0.72926551]
Stock Position:  0.007260994430452405
Bond Position:  [-3.21999222]


portfolio before change:  [-2.51031495]
curr_Stock_Price:  97.79373773976488
curr_Factors:  [9.77937377e+01 4.35743094e-02]
mat_Sqrt:  [[ 2.04139150e+01  0.00000000e+00]
 [-8.34978413e-03  1.91317589e-02]]
grads:  [0.05818596 5.56341463]
Stock Position:  0.05818595688182295
Bond Position:  [-8.20053716]


portfolio before change:  [-2.53124579]
curr_Stock_Price:  97.45163273309446
curr_Factors:  [9.74516327e+01 4.38271012e-02]
mat_Sqrt:  [[ 2.04014245e+01  0.00000000e+00]
 [-8.37396930e-03  1.91871741e-02]]
grads:  [6.78982991e-03 1.44299906e+01]
Stock Position:  0.006789829908921725
Bond Position:  [-3.1929258]


portfolio before change:  [-2.53045429]
curr_Stock_Price:  97.62699026969815
curr_Factors:  [9.76269903e+01 4.24014886e-02]
mat_Sqrt:  [[ 2.01029806e+01  0.00000000e+00]
 [-8.23664870e-03  1.88725331e-02]]
grads:  [-3.93778582e-03  4.67708089e+00]
Stock Position:  -0.003937785817801361
Bond Position:  [-2.14602011]


portfolio before change:  [-2.53175444]
curr_Stock_Price:  97.88903731362599
curr_Factors:  [9.78890373e+01 4.27989467e-02]
mat_Sqrt:  [[ 2.02511923e+01  0.00000000e+00]
 [-8.27516252e-03  1.89607793e-02]]
grads:  [-5.62388023e-03  8.05437527e+00]
Stock Position:  -0.005623880227108213
Bond Position:  [-1.98123822]


portfolio before change:  [-2.52309116]
curr_Stock_Price:  96.30455258259819
curr_Factors:  [9.63045526e+01 4.35796054e-02]
mat_Sqrt:  [[ 2.01042772e+01  0.00000000e+00]
 [-8.35029153e-03  1.91329215e-02]]
grads:  [ 0.00636122 -4.70048524]
Stock Position:  0.006361221198166406
Bond Position:  [-3.13570572]


portfolio before change:  [-2.52516657]
curr_Stock_Price:  96.03991399178871
curr_Factors:  [9.60399140e+01 4.25010258e-02]
mat_Sqrt:  [[ 1.97993744e+01  0.00000000e+00]
 [-8.24631077e-03  1.88946717e-02]]
grads:  [-1.48468082e-02 -2.38588937e+01]
Stock Position:  -0.014846808176948965
Bond Position:  [-1.09928039]


portfolio before change:  [-2.5373255]
curr_Stock_Price:  96.84961763800844
curr_Factors:  [9.68496176e+01 4.10425716e-02]
mat_Sqrt:  [[ 1.96207314e+01  0.00000000e+00]
 [-8.10358652e-03  1.85676493e-02]]
grads:  [0.00473066 3.53355693]
Stock Position:  0.004730658300907516
Bond Position:  [-2.99548795]


portfolio before change:  [-2.53729183]
curr_Stock_Price:  96.93589107326251
curr_Factors:  [9.69358911e+01 4.04337205e-02]
mat_Sqrt:  [[ 1.94920025e+01  0.00000000e+00]
 [-8.04325511e-03  1.84294127e-02]]
grads:  [ 0.01399371 -4.50052638]
Stock Position:  0.01399370737658468
Bond Position:  [-3.89378433]


portfolio before change:  [-2.54490292]
curr_Stock_Price:  96.4267815181473
curr_Factors:  [9.64267815e+01 4.19530300e-02]
mat_Sqrt:  [[ 1.97505565e+01  0.00000000e+00]
 [-8.19297553e-03  1.87724653e-02]]
grads:  [ -0.03115731 -10.83780474]
Stock Position:  -0.031157309466992758
Bond Position:  [0.45949616]


portfolio before change:  [-2.58354878]
curr_Stock_Price:  97.66897185087059
curr_Factors:  [9.76689719e+01 4.09809066e-02]
mat_Sqrt:  [[ 1.97718541e+01  0.00000000e+00]
 [-8.09749656e-03  1.85536955e-02]]
grads:  [-0.00955553 -3.09265928]
Stock Position:  -0.009555529137298794
Bond Position:  [-1.65027008]


portfolio before change:  [-2.58143318]
curr_Stock_Price:  97.42598138971964
curr_Factors:  [9.74259814e+01 4.04836361e-02]
mat_Sqrt:  [[ 1.96026392e+01  0.00000000e+00]
 [-8.04821830e-03  1.84407848e-02]]
grads:  [-0.00124991 -0.93874156]
Stock Position:  -0.0012499111085249536
Bond Position:  [-2.45965936]


portfolio before change:  [-2.58049202]
curr_Stock_Price:  96.42700168957015
curr_Factors:  [9.64270017e+01 3.90291984e-02]
mat_Sqrt:  [[ 1.90499341e+01  0.00000000e+00]
 [-7.90232354e-03  1.81064979e-02]]
grads:  [ 0.0138199  11.13919964]
Stock Position:  0.013819899063000426
Bond Position:  [-3.91310345]


portfolio before change:  [-2.56357838]
curr_Stock_Price:  97.68625856205337
curr_Factors:  [9.76862586e+01 3.89145650e-02]
mat_Sqrt:  [[ 1.92703484e+01  0.00000000e+00]
 [-7.89070998e-03  1.80798879e-02]]
grads:  [4.53408019e-04 4.92164139e-01]
Stock Position:  0.0004534080185052856
Bond Position:  [-2.60787012]


portfolio before change:  [-2.56399776]
curr_Stock_Price:  97.48031913797584
curr_Factors:  [9.74803191e+01 4.02085741e-02]
mat_Sqrt:  [[ 1.95468274e+01  0.00000000e+00]
 [-8.02083030e-03  1.83780310e-02]]
grads:  [ 0.00337588 -2.04307115]
Stock Position:  0.0033758836989785075
Bond Position:  [-2.89307998]


portfolio before change:  [-2.56418079]
curr_Stock_Price:  97.53323452265037
curr_Factors:  [9.75332345e+01 4.01320166e-02]
mat_Sqrt:  [[ 1.95388104e+01  0.00000000e+00]
 [-8.01319078e-03  1.83605267e-02]]
grads:  [-4.00007433e-04  6.47749907e+00]
Stock Position:  -0.0004000074325927246
Bond Position:  [-2.52516677]


portfolio before change:  [-2.56404709]
curr_Stock_Price:  96.40985605852165
curr_Factors:  [9.64098561e+01 4.12797425e-02]
mat_Sqrt:  [[ 1.95879923e+01  0.00000000e+00]
 [-8.12696671e-03  1.86212201e-02]]
grads:  [-0.00193421  1.10237526]
Stock Position:  -0.0019342059981535796
Bond Position:  [-2.37757057]


portfolio before change:  [-2.56133891]
curr_Stock_Price:  94.8560404658675
curr_Factors:  [9.48560405e+01 4.21192304e-02]
mat_Sqrt:  [[ 1.94672769e+01  0.00000000e+00]
 [-8.20918806e-03  1.88096128e-02]]
grads:  [-0.01954976 -6.39452003]
Stock Position:  -0.01954975559700593
Bond Position:  [-0.7069265]


portfolio before change:  [-2.55719331]
curr_Stock_Price:  94.63946637647501
curr_Factors:  [9.46394664e+01 4.20926390e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.55719331]
Stock Price:  93.81362645513467
PL:  [-2.55719331]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.01129727e+00  2.57535267e-01]
 [-2.68152955e-01 -9.89004796e-02]
 [-5.74680082e-01 -1.95968670e-01]
 [-2.94637095e-03 -1.39653852e-01]
 [-1.30424899e-01 -1.11560674e+00]
 [ 4.40865128e-02 -1.49101508e-01]
 [ 5.15450995e-01 -6.29503391e-01]
 [-7.28650607e-01 -5.88452332e-03]
 [-1.02828106e-01 -1.09394167e-01]
 [-5.54039818e-01 -7.57217122e-01]
 [-2.13028887e-02 -1.92418274e-02]
 [-3.87629137e-01 -3.17116700e-01]
 [ 1.20978845e-02  7.71179847e-02]
 [ 2.21901486e-02 -1.90233412e-01]
 [-1.49385148e-01 -1.17756349e-01]
 [ 9.79005752e-02 -9.08713201e-01]
 [ 1.72537160e-02 -3.23139532e-01]
 [ 3.99150950e-02 -1.62123579e-01]
 [-1.18683871e-01 -3.05188177e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.44514213e-01 -2.95564676e-02]
 [ 5.07926008e-01 -2.51492528e-01]
 [ 2.90841357e-02 -3.82447383e-01]
 [ 4.21964952e-02  2.99692449e-02]
 [ 4.08218368e-01 -3.19894337e-01]
 [ 1.09703149e-01 -8.82191217e-02]
 [-1.64576594e-01  7.08527129e-02]
 [-3.13310980e-02  1.40651844e-01]
 [-6.33842361e-02  2.05000576e-01]
 [-7.54495773e-01  1.76976633e-02]
 [-1.24799596e-01 -1.11515235e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.31779539e-01 -3.00332330e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.59545126e-01 -3.23119634e-02]
 [-2.94748009e-02 -1.58385600e-01]
 [-2.75689482e-03 -6.42589275e-02]
 [ 2.09570422e-01 -2.07445207e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.28474427]
curr_Stock_Price:  101.5391074264271
curr_Factors:  [1.01539107e+02 3.87863480e-02]
mat_Sqrt:  [[ 1.99973656e+01  0.00000000e+00]
 [-7.87769997e-03  1.80500782e-02]]
grads:  [ 0.05619215 14.26781999]
Stock Position:  0.05619214551737143
Bond Position:  [7.57904397]


portfolio before change:  [13.31991765]
curr_Stock_Price:  102.14819502586991
curr_Factors:  [1.02148195e+02 3.92199653e-02]
mat_Sqrt:  [[ 2.02294604e+01  0.00000000e+00]
 [-7.92161249e-03  1.81506944e-02]]
grads:  [-0.01538927 -5.44885376]
Stock Position:  -0.015389271700834132
Bond Position:  [14.89190397]


portfolio before change:  [13.30826738]
curr_Stock_Price:  103.02620095949652
curr_Factors:  [1.03026201e+02 4.03257205e-02]
mat_Sqrt:  [[ 2.06889644e+01  0.00000000e+00]
 [-8.03250601e-03  1.84047834e-02]]
grads:  [ -0.03191111 -10.64770314]
Stock Position:  -0.03191111004825345
Bond Position:  [16.59594781]


portfolio before change:  [13.31756807]
curr_Stock_Price:  102.79975736459784
curr_Factors:  [1.02799757e+02 4.11613389e-02]
mat_Sqrt:  [[ 2.08562794e+01  0.00000000e+00]
 [-8.11530297e-03  1.85944951e-02]]
grads:  [-3.06364850e-03 -7.51049448e+00]
Stock Position:  -0.0030636484980847943
Bond Position:  [13.63251039]


portfolio before change:  [13.31065386]
curr_Stock_Price:  105.61286527361311
curr_Factors:  [1.05612865e+02 3.95925795e-02]
mat_Sqrt:  [[ 2.10147256e+01  0.00000000e+00]
 [-7.95915367e-03  1.82367121e-02]]
grads:  [-2.93753822e-02 -6.11736773e+01]
Stock Position:  -0.029375382231234634
Bond Position:  [16.41307215]


portfolio before change:  [13.28562212]
curr_Stock_Price:  106.53484487528952
curr_Factors:  [1.06534845e+02 3.88723498e-02]
mat_Sqrt:  [[ 2.10044868e+01  0.00000000e+00]
 [-7.88642883e-03  1.80700785e-02]]
grads:  [-9.99154153e-04 -8.25129275e+00]
Stock Position:  -0.000999154152690357
Bond Position:  [13.39206686]


portfolio before change:  [13.28764961]
curr_Stock_Price:  106.18117188047357
curr_Factors:  [1.06181172e+02 3.83879557e-02]
mat_Sqrt:  [[ 2.08039119e+01  0.00000000e+00]
 [-7.83713781e-03  1.79571386e-02]]
grads:  [ 1.15705735e-02 -3.50558852e+01]
Stock Position:  0.011570573486250275
Bond Position:  [12.05907256]


portfolio before change:  [13.27538976]
curr_Stock_Price:  104.99131517160426
curr_Factors:  [1.04991315e+02 3.83385171e-02]
mat_Sqrt:  [[ 2.05575347e+01  0.00000000e+00]
 [-7.83208959e-03  1.79455717e-02]]
grads:  [-0.03556938 -0.32790949]
Stock Position:  -0.03556938297245836
Bond Position:  [17.00986606]


portfolio before change:  [13.28189523]
curr_Stock_Price:  104.86820076866339
curr_Factors:  [1.04868201e+02 3.82318677e-02]
mat_Sqrt:  [[ 2.05048489e+01  0.00000000e+00]
 [-7.82118842e-03  1.79205940e-02]]
grads:  [-0.00734322 -6.10438289]
Stock Position:  -0.007343220864587966
Bond Position:  [14.05196559]


portfolio before change:  [13.27741097]
curr_Stock_Price:  105.71808297505733
curr_Factors:  [1.05718083e+02 3.76889765e-02]
mat_Sqrt:  [[ 2.05237375e+01  0.00000000e+00]
 [-7.76545957e-03  1.77929032e-02]]
grads:  [ -0.04309724 -42.55725528]
Stock Position:  -0.043097241135382505
Bond Position:  [17.83356868]


portfolio before change:  [13.26779068]
curr_Stock_Price:  105.99303388837797
curr_Factors:  [1.05993034e+02 3.84393362e-02]
mat_Sqrt:  [[ 2.07809436e+01  0.00000000e+00]
 [-7.84238088e-03  1.79691520e-02]]
grads:  [-0.00142923 -1.07082557]
Stock Position:  -0.0014292282045364755
Bond Position:  [13.41927891]


portfolio before change:  [13.26765093]
curr_Stock_Price:  107.26453259768961
curr_Factors:  [1.07264533e+02 3.74529725e-02]
mat_Sqrt:  [[ 2.07586588e+01  0.00000000e+00]
 [-7.74110819e-03  1.77371071e-02]]
grads:  [ -0.02534028 -17.87871592]
Stock Position:  -0.025340279282908575
Bond Position:  [15.98576414]


portfolio before change:  [13.27321188]
curr_Stock_Price:  107.12394201224522
curr_Factors:  [1.07123942e+02 3.67754953e-02]
mat_Sqrt:  [[ 2.05430920e+01  0.00000000e+00]
 [-7.67077522e-03  1.75759540e-02]]
grads:  [2.22726610e-03 4.38769836e+00]
Stock Position:  0.0022272660991315154
Bond Position:  [13.03461835]


portfolio before change:  [13.27489667]
curr_Stock_Price:  107.14880067893435
curr_Factors:  [1.07148801e+02 3.66559686e-02]
mat_Sqrt:  [[ 2.05144399e+01  0.00000000e+00]
 [-7.65829940e-03  1.75473684e-02]]
grads:  [-2.96544870e-03 -1.08411363e+01]
Stock Position:  -0.002965448697393052
Bond Position:  [13.59264095]


portfolio before change:  [13.2785575]
curr_Stock_Price:  106.48730228334905
curr_Factors:  [1.06487302e+02 3.82891244e-02]
mat_Sqrt:  [[ 2.08370168e+01  0.00000000e+00]
 [-7.82704280e-03  1.79340081e-02]]
grads:  [-0.00963565 -6.56609212]
Stock Position:  -0.009635651490599738
Bond Position:  [14.30463203]


portfolio before change:  [13.29409282]
curr_Stock_Price:  105.06060815734836
curr_Factors:  [1.05060608e+02 3.99448271e-02]
mat_Sqrt:  [[ 2.09976254e+01  0.00000000e+00]
 [-7.99448081e-03  1.83176567e-02]]
grads:  [-1.42251504e-02 -4.96085943e+01]
Stock Position:  -0.014225150447489163
Bond Position:  [14.78859578]


portfolio before change:  [13.2877614]
curr_Stock_Price:  105.63565349802131
curr_Factors:  [1.05635653e+02 3.97777169e-02]
mat_Sqrt:  [[ 2.10683464e+01  0.00000000e+00]
 [-7.97774072e-03  1.82793004e-02]]
grads:  [-5.87497167e-03 -1.76778939e+01]
Stock Position:  -0.005874971673030413
Bond Position:  [13.90836787]


portfolio before change:  [13.29002747]
curr_Stock_Price:  105.54588056162859
curr_Factors:  [1.05545881e+02 4.08335814e-02]
mat_Sqrt:  [[ 2.13279947e+01  0.00000000e+00]
 [-8.08292832e-03  1.85203154e-02]]
grads:  [-1.44605418e-03 -8.75382387e+00]
Stock Position:  -0.001446054178289135
Bond Position:  [13.44265253]


portfolio before change:  [13.29258335]
curr_Stock_Price:  104.94047597259258
curr_Factors:  [1.04940476e+02 4.20239707e-02]
mat_Sqrt:  [[ 2.15125341e+01  0.00000000e+00]
 [-8.19989958e-03  1.87883303e-02]]
grads:  [-1.17084724e-02 -1.62434965e+01]
Stock Position:  -0.011708472375107744
Bond Position:  [14.52127602]


portfolio before change:  [13.30925091]
curr_Stock_Price:  103.67196884582425
curr_Factors:  [1.03671969e+02 4.24888492e-02]
mat_Sqrt:  [[ 2.13697200e+01  0.00000000e+00]
 [-8.24512940e-03  1.88919648e-02]]
grads:  [-2.26774474e-04 -5.77459203e+00]
Stock Position:  -0.00022677447425357034
Bond Position:  [13.33276106]


portfolio before change:  [13.31100438]
curr_Stock_Price:  103.28932026350041
curr_Factors:  [1.03289320e+02 4.19091628e-02]
mat_Sqrt:  [[ 2.11451082e+01  0.00000000e+00]
 [-8.18869101e-03  1.87626482e-02]]
grads:  [ 0.00622436 -1.5752823 ]
Stock Position:  0.006224357506161946
Bond Position:  [12.66809473]


portfolio before change:  [13.30799141]
curr_Stock_Price:  102.5508376323914
curr_Factors:  [1.02550838e+02 4.15347041e-02]
mat_Sqrt:  [[ 2.08999272e+01  0.00000000e+00]
 [-8.15202592e-03  1.86786379e-02]]
grads:  [  0.01905106 -13.46417918]
Stock Position:  0.019051055415131968
Bond Position:  [11.35428972]


portfolio before change:  [13.32205405]
curr_Stock_Price:  103.21448912581965
curr_Factors:  [1.03214489e+02 4.13386852e-02]
mat_Sqrt:  [[ 2.09854844e+01  0.00000000e+00]
 [-8.13276683e-03  1.86345098e-02]]
grads:  [-6.56785348e-03 -2.05236085e+01]
Stock Position:  -0.006567853482397776
Bond Position:  [13.99995169]


portfolio before change:  [13.32093872]
curr_Stock_Price:  103.65077043299614
curr_Factors:  [1.03650770e+02 4.17713625e-02]
mat_Sqrt:  [[ 2.11841896e+01  0.00000000e+00]
 [-8.17521743e-03  1.87317764e-02]]
grads:  [0.00260931 1.59991473]
Stock Position:  0.0026093113298811016
Bond Position:  [13.05048159]


portfolio before change:  [13.32097189]
curr_Stock_Price:  103.03825473050516
curr_Factors:  [1.03038255e+02 4.22967616e-02]
mat_Sqrt:  [[ 2.11910293e+01  0.00000000e+00]
 [-8.22647060e-03  1.88492121e-02]]
grads:  [ 1.26754123e-02 -1.69712312e+01]
Stock Position:  0.012675412297656263
Bond Position:  [12.01491953]


portfolio before change:  [13.30392251]
curr_Stock_Price:  101.57468577854443
curr_Factors:  [1.01574686e+02 4.28844702e-02]
mat_Sqrt:  [[ 2.10346608e+01  0.00000000e+00]
 [-8.28342637e-03  1.89797142e-02]]
grads:  [ 3.3849449e-03 -4.6480743e+00]
Stock Position:  0.003384944896153805
Bond Position:  [12.96009779]


portfolio before change:  [13.30913513]
curr_Stock_Price:  102.63600405954632
curr_Factors:  [1.02636004e+02 4.11864850e-02]
mat_Sqrt:  [[ 2.08294163e+01  0.00000000e+00]
 [-8.11778147e-03  1.86001740e-02]]
grads:  [-0.0064166  3.80925  ]
Stock Position:  -0.006416595299966605
Bond Position:  [13.96770883]


portfolio before change:  [13.30538313]
curr_Stock_Price:  103.4928555598575
curr_Factors:  [1.03492856e+02 4.15512148e-02]
mat_Sqrt:  [[ 2.10961028e+01  0.00000000e+00]
 [-8.15364604e-03  1.86823501e-02]]
grads:  [1.42464224e-03 7.52859481e+00]
Stock Position:  0.0014246422438509948
Bond Position:  [13.15794283]


portfolio before change:  [13.30816566]
curr_Stock_Price:  104.29142977442802
curr_Factors:  [1.04291430e+02 3.94516499e-02]
mat_Sqrt:  [[ 2.07148220e+01  0.00000000e+00]
 [-7.94497576e-03  1.82042264e-02]]
grads:  [1.25926017e-03 1.12611529e+01]
Stock Position:  0.0012592601725628521
Bond Position:  [13.17683561]


portfolio before change:  [13.31053885]
curr_Stock_Price:  104.86795061210263
curr_Factors:  [1.04867951e+02 3.85190381e-02]
mat_Sqrt:  [[ 2.05816646e+01  0.00000000e+00]
 [-7.85050705e-03  1.79877714e-02]]
grads:  [-0.03628336  0.98387193]
Stock Position:  -0.03628335668334337
Bond Position:  [17.11550011]


portfolio before change:  [13.30598066]
curr_Stock_Price:  105.05254657235456
curr_Factors:  [1.05052547e+02 3.77709768e-02]
mat_Sqrt:  [[ 2.04167068e+01  0.00000000e+00]
 [-7.77390268e-03  1.78122487e-02]]
grads:  [-0.006351   -0.62605927]
Stock Position:  -0.006351000731420763
Bond Position:  [13.97316946]


portfolio before change:  [13.30317424]
curr_Stock_Price:  105.76946951827883
curr_Factors:  [1.05769470e+02 3.61913725e-02]
mat_Sqrt:  [[ 2.01216158e+01  0.00000000e+00]
 [-7.60961208e-03  1.74358117e-02]]
grads:  [ 0.00360521 -0.6852098 ]
Stock Position:  0.0036052073246860927
Bond Position:  [12.92185338]


portfolio before change:  [13.30440444]
curr_Stock_Price:  105.66264237294243
curr_Factors:  [1.05662642e+02 3.73885032e-02]
mat_Sqrt:  [[ 2.04310415e+01  0.00000000e+00]
 [-7.73444278e-03  1.77218347e-02]]
grads:  [-0.01198603 -1.69470223]
Stock Position:  -0.011986031919393217
Bond Position:  [14.57088024]


portfolio before change:  [13.29996676]
curr_Stock_Price:  106.18484633404994
curr_Factors:  [1.06184846e+02 3.86632509e-02]
mat_Sqrt:  [[ 2.08790977e+01  0.00000000e+00]
 [-7.86518922e-03  1.80214125e-02]]
grads:  [0.00485994 2.96031518]
Stock Position:  0.004859940459358794
Bond Position:  [12.78391473]


portfolio before change:  [13.29732069]
curr_Stock_Price:  105.31155247168985
curr_Factors:  [1.05311552e+02 3.94640666e-02]
mat_Sqrt:  [[ 2.09207347e+01  0.00000000e+00]
 [-7.94622593e-03  1.82070909e-02]]
grads:  [-0.00452506  4.46667436]
Stock Position:  -0.0045250614752703165
Bond Position:  [13.77386194]


portfolio before change:  [13.29718922]
curr_Stock_Price:  105.72111925285338
curr_Factors:  [1.05721119e+02 3.99068542e-02]
mat_Sqrt:  [[ 2.11195908e+01  0.00000000e+00]
 [-7.99067999e-03  1.83089480e-02]]
grads:  [-0.01769197 -1.76481814]
Stock Position:  -0.0176919726532586
Bond Position:  [15.16760437]


portfolio before change:  [13.29707973]
curr_Stock_Price:  105.83447897554622
curr_Factors:  [1.05834479e+02 3.90961132e-02]
mat_Sqrt:  [[ 2.09263733e+01  0.00000000e+00]
 [-7.90909484e-03  1.81220129e-02]]
grads:  [-4.71175500e-03 -8.73995626e+00]
Stock Position:  -0.004711754997877149
Bond Position:  [13.79574587]


portfolio before change:  [13.29439842]
curr_Stock_Price:  106.76956255396846
curr_Factors:  [1.06769563e+02 3.86663317e-02]
mat_Sqrt:  [[ 2.09949067e+01  0.00000000e+00]
 [-7.86550257e-03  1.80221304e-02]]
grads:  [-1.46710773e-03 -3.56555668e+00]
Stock Position:  -0.001467107734167376
Bond Position:  [13.45104087]


portfolio before change:  [13.29463684]
curr_Stock_Price:  107.75317553861399
curr_Factors:  [1.07753176e+02 3.78250573e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.29463684]
Stock Price:  107.85089500964474
PL:  [5.44374183]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.43508529e+00  3.53345246e-01]
 [ 9.73095520e-01  8.05104270e-02]
 [-7.60069260e-03  7.00831035e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.68105664e-01  1.20933380e+00]
 [ 8.82730664e-03 -6.72909259e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.07055986e+00  1.08986562e+00]
 [ 5.60962663e-02  4.82353366e-01]
 [ 1.72376734e-01  6.92167242e-02]
 [-7.29383602e-03  1.96667804e-02]
 [ 6.18931597e-02 -9.64950556e-02]
 [-1.01141104e-01  4.36838574e-02]
 [-1.27808707e-01  2.60579719e-01]
 [ 3.98162761e-01  2.72096329e-01]
 [ 1.29948168e-01 -2.08730021e-02]
 [ 3.97560005e-02  1.18427168e-01]
 [ 5.78317949e-02  7.57435207e-02]
 [-5.22766327e-02 -3.60075483e-02]
 [-3.44645427e-01  1.25024582e-01]
 [ 1.25721120e-01  3.85100713e-02]
 [ 1.59794816e+00  1.90140367e-01]
 [ 1.60415354e-02  4.06747612e-01]
 [-1.48005365e-01  1.70466902e-01]
 [-1.92285422e-01  1.16658233e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 6.89446373e-02 -4.55064612e-01]
 [ 9.74979947e-02 -5.30584028e-03]
 [ 5.24459500e-01 -3.03215933e-01]
 [-5.34613115e-01 -2.97479547e-01]
 [ 3.45960765e-01  1.30715989e-01]
 [-1.47041229e-01  2.05500932e-01]
 [ 4.91558718e-01  2.29597050e-01]
 [ 4.54300808e-02 -3.64024113e-02]
 [ 2.67370324e-01 -2.90805511e-01]
 [ 1.21822358e-01  3.59262235e-02]
 [-7.42834618e-02  4.67261110e-01]
 [-3.64920411e-01 -1.38242246e-01]
 [ 2.39759596e-02  4.11075269e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.58594298]
curr_Stock_Price:  99.52570830264669
curr_Factors:  [9.95257083e+01 3.87140646e-02]
mat_Sqrt:  [[ 1.95825689e+01  0.00000000e+00]
 [-7.87035599e-03  1.80332510e-02]]
grads:  [ 0.0811588  19.59409569]
Stock Position:  0.0811588005400348
Bond Position:  [-8.66333009]


portfolio before change:  [-0.65427864]
curr_Stock_Price:  98.69705290526859
curr_Factors:  [9.86970529e+01 3.91263744e-02]
mat_Sqrt:  [[ 1.95226599e+01  0.00000000e+00]
 [-7.91215514e-03  1.81290249e-02]]
grads:  [0.05164425 4.44096841]
Stock Position:  0.05164425121252076
Bond Position:  [-5.75141403]


portfolio before change:  [-0.7034546]
curr_Stock_Price:  97.75876868370428
curr_Factors:  [9.77587687e+01 3.86978129e-02]
mat_Sqrt:  [[ 1.92308700e+01  0.00000000e+00]
 [-7.86870387e-03  1.80294656e-02]]
grads:  [1.19526997e-03 3.88714259e+00]
Stock Position:  0.00119526996611824
Bond Position:  [-0.82030272]


portfolio before change:  [-0.70455184]
curr_Stock_Price:  96.92657238742002
curr_Factors:  [9.69265724e+01 3.84938116e-02]
mat_Sqrt:  [[ 1.90168383e+01  0.00000000e+00]
 [-7.84793595e-03  1.79818803e-02]]
grads:  [-8.57207003e-04 -8.41885333e+00]
Stock Position:  -0.0008572070031432907
Bond Position:  [-0.6214657]


portfolio before change:  [-0.70358963]
curr_Stock_Price:  95.71344850465427
curr_Factors:  [9.57134485e+01 4.04472974e-02]
mat_Sqrt:  [[ 1.92494231e+01  0.00000000e+00]
 [-8.04460539e-03  1.84325066e-02]]
grads:  [1.86858003e-02 6.56087544e+01]
Stock Position:  0.018685800252871018
Bond Position:  [-2.49207201]


portfolio before change:  [-0.67128861]
curr_Stock_Price:  97.45876026738698
curr_Factors:  [9.74587603e+01 3.75374019e-02]
mat_Sqrt:  [[ 1.88822171e+01  0.00000000e+00]
 [-7.74982858e-03  1.77570880e-02]]
grads:  [-1.08784159e-03 -3.78952482e+00]
Stock Position:  -0.001087841590848023
Bond Position:  [-0.56526892]


portfolio before change:  [-0.66993752]
curr_Stock_Price:  96.15180566475581
curr_Factors:  [9.61518057e+01 3.78897929e-02]
mat_Sqrt:  [[ 1.87162380e+01  0.00000000e+00]
 [-7.78612026e-03  1.78402427e-02]]
grads:  [0.00691238 5.38876565]
Stock Position:  0.006912381481097487
Bond Position:  [-1.33457548]


portfolio before change:  [-0.66946962]
curr_Stock_Price:  96.2436302469201
curr_Factors:  [9.62436302e+01 3.70362648e-02]
mat_Sqrt:  [[ 1.85219022e+01  0.00000000e+00]
 [-7.69792333e-03  1.76381582e-02]]
grads:  [ 0.08348042 61.7902171 ]
Stock Position:  0.08348042245615177
Bond Position:  [-8.70392853]


portfolio before change:  [-0.66521798]
curr_Stock_Price:  96.30759379176244
curr_Factors:  [9.63075938e+01 3.66635854e-02]
mat_Sqrt:  [[ 1.84407253e+01  0.00000000e+00]
 [-7.65909503e-03  1.75491914e-02]]
grads:  [1.44578117e-02 2.74857887e+01]
Stock Position:  0.014457811672364207
Bond Position:  [-2.05761503]


portfolio before change:  [-0.66374183]
curr_Stock_Price:  96.42748496827767
curr_Factors:  [9.64274850e+01 3.53230438e-02]
mat_Sqrt:  [[ 1.81229920e+01  0.00000000e+00]
 [-7.51777029e-03  1.72253757e-02]]
grads:  [0.01117836 4.01829982]
Stock Position:  0.011178363298350192
Bond Position:  [-1.74164329]


portfolio before change:  [-0.67188903]
curr_Stock_Price:  95.71812504369571
curr_Factors:  [9.57181250e+01 3.64834244e-02]
mat_Sqrt:  [[ 1.82827694e+01  0.00000000e+00]
 [-7.64025386e-03  1.75060208e-02]]
grads:  [7.05281888e-05 1.12342951e+00]
Stock Position:  7.052818882735928e-05
Bond Position:  [-0.67863986]


portfolio before change:  [-0.67199058]
curr_Stock_Price:  95.48118984446796
curr_Factors:  [9.54811898e+01 3.59575732e-02]
mat_Sqrt:  [[ 1.81056036e+01  0.00000000e+00]
 [-7.58499289e-03  1.73794020e-02]]
grads:  [ 1.09243885e-03 -5.55226558e+00]
Stock Position:  0.0010924388499637244
Bond Position:  [-0.77629794]


portfolio before change:  [-0.67205539]
curr_Stock_Price:  95.51069631465752
curr_Factors:  [9.55106963e+01 3.73027309e-02]
mat_Sqrt:  [[ 1.84468546e+01  0.00000000e+00]
 [-7.72556596e-03  1.77014954e-02]]
grads:  [-0.00444932  2.46780605]
Stock Position:  -0.004449317081915228
Bond Position:  [-0.24709802]


portfolio before change:  [-0.67570769]
curr_Stock_Price:  96.32462267127453
curr_Factors:  [9.63246227e+01 3.79897641e-02]
mat_Sqrt:  [[ 1.87745966e+01  0.00000000e+00]
 [-7.79638523e-03  1.78637627e-02]]
grads:  [-7.50077071e-04  1.45870566e+01]
Stock Position:  -0.0007500770711631272
Bond Position:  [-0.6034568]


portfolio before change:  [-0.67595868]
curr_Stock_Price:  96.55866615163036
curr_Factors:  [9.65586662e+01 4.04928520e-02]
mat_Sqrt:  [[ 1.94303418e+01  0.00000000e+00]
 [-8.04913432e-03  1.84428836e-02]]
grads:  [ 0.02660351 14.75345907]
Stock Position:  0.026603512114343524
Bond Position:  [-3.24475833]


portfolio before change:  [-0.62276647]
curr_Stock_Price:  98.57335637931456
curr_Factors:  [9.85733564e+01 4.03114292e-02]
mat_Sqrt:  [[ 1.97912690e+01  0.00000000e+00]
 [-8.03108254e-03  1.84015218e-02]]
grads:  [ 0.00610564 -1.13430847]
Stock Position:  0.006105644020644088
Bond Position:  [-1.22462029]


portfolio before change:  [-0.62488811]
curr_Stock_Price:  98.25094000660175
curr_Factors:  [9.82509400e+01 4.05949678e-02]
mat_Sqrt:  [[ 1.97957889e+01  0.00000000e+00]
 [-8.05927716e-03  1.84661238e-02]]
grads:  [4.61925788e-03 6.41321206e+00]
Stock Position:  0.004619257878648893
Bond Position:  [-1.07873454]


portfolio before change:  [-0.62811227]
curr_Stock_Price:  97.58215108980508
curr_Factors:  [9.75821511e+01 3.96735491e-02]
mat_Sqrt:  [[ 1.94366276e+01  0.00000000e+00]
 [-7.96728803e-03  1.82553502e-02]]
grads:  [0.00467617 4.14911353]
Stock Position:  0.00467617013156904
Bond Position:  [-1.08442301]


portfolio before change:  [-0.62429289]
curr_Stock_Price:  98.42791714934106
curr_Factors:  [9.84279171e+01 3.92761870e-02]
mat_Sqrt:  [[ 1.95066618e+01  0.00000000e+00]
 [-7.92728826e-03  1.81636993e-02]]
grads:  [-0.00348556 -1.98239069]
Stock Position:  -0.0034855587214453563
Bond Position:  [-0.2812166]


portfolio before change:  [-0.61899369]
curr_Stock_Price:  96.89750279372876
curr_Factors:  [9.68975028e+01 3.91664755e-02]
mat_Sqrt:  [[ 1.91765214e+01  0.00000000e+00]
 [-7.91620873e-03  1.81383129e-02]]
grads:  [-0.01512684  6.89284517]
Stock Position:  -0.015126842805607174
Bond Position:  [0.8467596]


portfolio before change:  [-0.6130441]
curr_Stock_Price:  96.51118676794033
curr_Factors:  [9.65111868e+01 4.04571207e-02]
mat_Sqrt:  [[ 1.94122172e+01  0.00000000e+00]
 [-8.04558221e-03  1.84347447e-02]]
grads:  [0.0073422 2.088994 ]
Stock Position:  0.007342195480303394
Bond Position:  [-1.3216481]


portfolio before change:  [-0.62786635]
curr_Stock_Price:  94.51491265269449
curr_Factors:  [9.45149127e+01 4.06102483e-02]
mat_Sqrt:  [[ 1.90466306e+01  0.00000000e+00]
 [-8.06079384e-03  1.84695990e-02]]
grads:  [ 0.08825352 10.29477508]
Stock Position:  0.08825352121059539
Bond Position:  [-8.9691402]


portfolio before change:  [-0.50770545]
curr_Stock_Price:  95.8891593391428
curr_Factors:  [9.58891593e+01 4.02268503e-02]
mat_Sqrt:  [[ 1.92321362e+01  0.00000000e+00]
 [-8.02265296e-03  1.83822072e-02]]
grads:  [1.00644434e-02 2.21272455e+01]
Stock Position:  0.010064443420812114
Bond Position:  [-1.47277647]


portfolio before change:  [-0.52518041]
curr_Stock_Price:  94.1711464058779
curr_Factors:  [9.41711464e+01 4.06529557e-02]
mat_Sqrt:  [[ 1.89873310e+01  0.00000000e+00]
 [-8.06503126e-03  1.84793081e-02]]
grads:  [-3.87666439e-03  9.22474484e+00]
Stock Position:  -0.0038766643868067678
Bond Position:  [-0.16011048]


portfolio before change:  [-0.52607636]
curr_Stock_Price:  94.39709808894976
curr_Factors:  [9.43970981e+01 4.08502646e-02]
mat_Sqrt:  [[ 1.90790208e+01  0.00000000e+00]
 [-8.08457936e-03  1.85240984e-02]]
grads:  [-0.00740979  6.29764698]
Stock Position:  -0.0074097930307362924
Bond Position:  [0.1733866]


portfolio before change:  [-0.51943967]
curr_Stock_Price:  93.50435833332375
curr_Factors:  [9.35043583e+01 4.11983962e-02]
mat_Sqrt:  [[ 1.89789425e+01  0.00000000e+00]
 [-8.11895523e-03  1.86028634e-02]]
grads:  [ 0.00966748 -3.92388717]
Stock Position:  0.009667482950004141
Bond Position:  [-1.42339146]


portfolio before change:  [-0.51252901]
curr_Stock_Price:  94.23759863352898
curr_Factors:  [9.42375986e+01 4.02762355e-02]
mat_Sqrt:  [[ 1.89124872e+01  0.00000000e+00]
 [-8.02757602e-03  1.83934874e-02]]
grads:  [-6.85588525e-03 -2.47405292e+01]
Stock Position:  -0.006855885253407794
Bond Position:  [0.13355315]


portfolio before change:  [-0.50882791]
curr_Stock_Price:  93.70018980045155
curr_Factors:  [9.37001898e+01 4.03555069e-02]
mat_Sqrt:  [[ 1.88231314e+01  0.00000000e+00]
 [-8.03547205e-03  1.84115795e-02]]
grads:  [ 0.00505667 -0.28817953]
Stock Position:  0.00505666852550056
Bond Position:  [-0.98263871]


portfolio before change:  [-0.5065494]
curr_Stock_Price:  94.17507586260668
curr_Factors:  [9.41750759e+01 4.12567063e-02]
mat_Sqrt:  [[ 1.91286031e+01  0.00000000e+00]
 [-8.12469877e-03  1.86160236e-02]]
grads:  [  0.02049942 -16.28790017]
Stock Position:  0.020499417315310277
Bond Position:  [-2.43708358]


portfolio before change:  [-0.51745815]
curr_Stock_Price:  93.65778853621819
curr_Factors:  [9.36577885e+01 4.10635148e-02]
mat_Sqrt:  [[ 1.89789403e+01  0.00000000e+00]
 [-8.10565381e-03  1.85723861e-02]]
grads:  [ -0.03500953 -16.01730361]
Stock Position:  -0.03500953289380347
Bond Position:  [2.76145728]


portfolio before change:  [-0.48676654]
curr_Stock_Price:  92.79098471376794
curr_Factors:  [9.27909847e+01 4.18891373e-02]
mat_Sqrt:  [[ 1.89913786e+01  0.00000000e+00]
 [-8.18673437e-03  1.87581650e-02]]
grads:  [0.02122068 6.96848489]
Stock Position:  0.021220676414876738
Bond Position:  [-2.45585401]


portfolio before change:  [-0.47740253]
curr_Stock_Price:  93.246720031966
curr_Factors:  [9.32467200e+01 4.15382168e-02]
mat_Sqrt:  [[ 1.90045456e+01  0.00000000e+00]
 [-8.15237063e-03  1.86794278e-02]]
grads:  [-3.01787113e-03  1.10014575e+01]
Stock Position:  -0.003017871133558136
Bond Position:  [-0.19599595]


portfolio before change:  [-0.47773832]
curr_Stock_Price:  93.34986751530494
curr_Factors:  [9.33498675e+01 4.04182471e-02]
mat_Sqrt:  [[ 1.87673279e+01  0.00000000e+00]
 [-8.04171594e-03  1.84258860e-02]]
grads:  [ 0.03153156 12.46057039]
Stock Position:  0.03153155779246846
Bond Position:  [-3.42120506]


portfolio before change:  [-0.45662242]
curr_Stock_Price:  94.03310610066765
curr_Factors:  [9.40331061e+01 3.95049678e-02]
mat_Sqrt:  [[ 1.86898854e+01  0.00000000e+00]
 [-7.95034267e-03  1.82165235e-02]]
grads:  [ 1.58068203e-03 -1.99831824e+00]
Stock Position:  0.0015806820296625334
Bond Position:  [-0.60525886]


portfolio before change:  [-0.45902601]
curr_Stock_Price:  92.56037278899261
curr_Factors:  [9.25603728e+01 3.99838211e-02]
mat_Sqrt:  [[ 1.85083304e+01  0.00000000e+00]
 [-7.99838195e-03  1.83265954e-02]]
grads:  [ 7.58860421e-03 -1.58679506e+01]
Stock Position:  0.007588604214202487
Bond Position:  [-1.16143004]


portfolio before change:  [-0.46756487]
curr_Stock_Price:  91.45428346962295
curr_Factors:  [9.14542835e+01 4.15371186e-02]
mat_Sqrt:  [[ 1.86389840e+01  0.00000000e+00]
 [-8.15226286e-03  1.86791808e-02]]
grads:  [0.00737711 1.92332971]
Stock Position:  0.007377110693480819
Bond Position:  [-1.14223324]


portfolio before change:  [-0.46857518]
curr_Stock_Price:  91.33668673781241
curr_Factors:  [9.13366867e+01 4.23354814e-02]
mat_Sqrt:  [[ 1.87930602e+01  0.00000000e+00]
 [-8.23023513e-03  1.88578377e-02]]
grads:  [6.89861066e-03 2.47780852e+01]
Stock Position:  0.006898610662406683
Bond Position:  [-1.09867142]


portfolio before change:  [-0.45877912]
curr_Stock_Price:  92.77660011202289
curr_Factors:  [9.27766001e+01 4.02239248e-02]
mat_Sqrt:  [[ 1.86071850e+01  0.00000000e+00]
 [-8.02236123e-03  1.83815388e-02]]
grads:  [-0.0228543  -7.52071126]
Stock Position:  -0.022854304566918605
Bond Position:  [1.66156555]


portfolio before change:  [-0.45509969]
curr_Stock_Price:  92.62469322586743
curr_Factors:  [9.26246932e+01 4.01976121e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.45509969]
Stock Price:  92.77975964886178
PL:  [-0.45509969]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 9.93125539e-01  2.53427002e-01]
 [-1.82155216e-01 -2.15852636e-02]
 [-7.81653394e-01 -2.39737525e-01]
 [-4.35802234e-01 -4.21893948e-02]
 [-1.25911032e-01 -8.08434351e-01]
 [-1.21612001e-01 -2.45132097e-03]
 [ 5.75312354e-01 -7.08657363e-01]
 [-1.01386348e+00  9.23260597e-02]
 [-8.79932687e-02 -2.28134417e-01]
 [-8.01651407e-01 -9.71998377e-01]
 [ 5.89931618e-02 -3.12971783e-02]
 [-5.89660683e-01 -4.03279848e-01]
 [ 1.78748637e-01  4.77738506e-01]
 [ 2.07012610e-02 -1.76493957e-01]
 [-7.31309842e-01 -2.56766845e-01]
 [ 4.61654643e-02 -1.77329137e+00]
 [-8.91053622e-03 -8.39697159e-01]
 [ 1.87056729e-01 -2.88522144e-01]
 [-5.82968670e-02 -1.95415772e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 7.12937418e-02 -1.15341516e-01]
 [ 4.10631451e-01 -1.01397114e+00]
 [ 2.69928039e-02 -3.24842509e-01]
 [-3.18973205e-02  3.57407398e-01]
 [ 5.63808590e-01 -8.33494654e-01]
 [-1.21236239e+00  2.01953717e-01]
 [-3.72524975e-01  2.92664542e-01]
 [-8.17229487e-02 -4.79258237e-01]
 [ 2.81991598e-02  3.68008955e-01]
 [-8.06324092e-01  2.08511638e+00]
 [-3.48836669e-02  2.23620420e-01]
 [ 7.77567776e-02 -1.19471891e-02]
 [-1.47879754e-02 -4.40350993e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.11252487e-01  4.14830341e-02]
 [-4.09010576e-01 -2.09853399e-01]
 [-3.59253799e-02 -9.86566230e-02]
 [ 2.97139562e-02 -6.20669545e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.64368681]
curr_Stock_Price:  102.17182957894144
curr_Factors:  [1.02171830e+02 3.93121439e-02]
mat_Sqrt:  [[ 2.02579052e+01  0.00000000e+00]
 [-7.93091611e-03  1.81720117e-02]]
grads:  [ 0.05448392 13.94600698]
Stock Position:  0.054483923131846024
Bond Position:  [12.0769647]


portfolio before change:  [17.71661003]
curr_Stock_Price:  103.48255590843152
curr_Factors:  [1.03482556e+02 3.91073665e-02]
mat_Sqrt:  [[ 2.04642783e+01  0.00000000e+00]
 [-7.91023302e-03  1.81246208e-02]]
grads:  [-0.00936147 -1.19093601]
Stock Position:  -0.009361473445378288
Bond Position:  [18.68535923]


portfolio before change:  [17.71624415]
curr_Stock_Price:  103.77115392484939
curr_Factors:  [1.03771154e+02 3.81041335e-02]
mat_Sqrt:  [[ 2.02564199e+01  0.00000000e+00]
 [-7.80811204e-03  1.78906322e-02]]
grads:  [ -0.04375321 -13.40017065]
Stock Position:  -0.04375321166958156
Bond Position:  [22.25656541]


portfolio before change:  [17.63905631]
curr_Stock_Price:  105.59890743097232
curr_Factors:  [1.05598907e+02 3.79257876e-02]
mat_Sqrt:  [[ 2.05649060e+01  0.00000000e+00]
 [-7.78981772e-03  1.78487147e-02]]
grads:  [-0.02208691 -2.36372173]
Stock Position:  -0.022086908413639583
Bond Position:  [19.9714097]


portfolio before change:  [17.67423468]
curr_Stock_Price:  104.11921684000089
curr_Factors:  [1.04119217e+02 4.03907520e-02]
mat_Sqrt:  [[ 2.09253081e+01  0.00000000e+00]
 [-8.03898023e-03  1.84196177e-02]]
grads:  [-2.2878550e-02 -4.3889855e+01]
Stock Position:  -0.022878550007525634
Bond Position:  [20.05633139]


portfolio before change:  [17.64240333]
curr_Stock_Price:  105.62012241553236
curr_Factors:  [1.05620122e+02 4.04406377e-02]
mat_Sqrt:  [[ 2.12400563e+01  0.00000000e+00]
 [-8.04394308e-03  1.84309890e-02]]
grads:  [-0.00577597 -0.13299997]
Stock Position:  -0.005775966100897043
Bond Position:  [18.25246158]


portfolio before change:  [17.63663191]
curr_Stock_Price:  107.01436893297371
curr_Factors:  [1.07014369e+02 3.94746928e-02]
mat_Sqrt:  [[ 2.12618708e+01  0.00000000e+00]
 [-7.94729567e-03  1.82095420e-02]]
grads:  [ 1.25120187e-02 -3.89168142e+01]
Stock Position:  0.012512018728807986
Bond Position:  [16.29766612]


portfolio before change:  [17.63955362]
curr_Stock_Price:  107.08505065856052
curr_Factors:  [1.07085051e+02 3.90511047e-02]
mat_Sqrt:  [[ 2.11614542e+01  0.00000000e+00]
 [-7.90454094e-03  1.81115786e-02]]
grads:  [-0.04600672  5.09762631]
Stock Position:  -0.04600671928787861
Bond Position:  [22.56618549]


portfolio before change:  [17.6222832]
curr_Stock_Price:  107.52175584150307
curr_Factors:  [1.07521756e+02 3.84264732e-02]
mat_Sqrt:  [[ 2.10771366e+01  0.00000000e+00]
 [-7.84106862e-03  1.79661452e-02]]
grads:  [-8.89870830e-03 -1.26980169e+01]
Stock Position:  -0.008898708303673881
Bond Position:  [18.57908794]


portfolio before change:  [17.62028511]
curr_Stock_Price:  108.00728891829937
curr_Factors:  [1.08007289e+02 3.90881962e-02]
mat_Sqrt:  [[ 2.13538349e+01  0.00000000e+00]
 [-7.90829399e-03  1.81201779e-02]]
grads:  [ -0.05740731 -53.64176785]
Stock Position:  -0.05740731283190402
Bond Position:  [23.82069333]


portfolio before change:  [17.53736487]
curr_Stock_Price:  109.50357933363824
curr_Factors:  [1.09503579e+02 3.75127785e-02]
mat_Sqrt:  [[ 2.12088896e+01  0.00000000e+00]
 [-7.74728633e-03  1.77512630e-02]]
grads:  [ 0.0021375  -1.76309586]
Stock Position:  0.002137497729283008
Bond Position:  [17.30330122]


portfolio before change:  [17.54216147]
curr_Stock_Price:  110.7356514633687
curr_Factors:  [1.10735651e+02 3.67427287e-02]
mat_Sqrt:  [[ 2.12262448e+01  0.00000000e+00]
 [-7.66735717e-03  1.75681223e-02]]
grads:  [ -0.03607169 -22.95520492]
Stock Position:  -0.036071686060563865
Bond Position:  [21.53658313]


portfolio before change:  [17.4779974]
curr_Stock_Price:  112.58908065439954
curr_Factors:  [1.12589081e+02 3.62558826e-02]
mat_Sqrt:  [[ 2.14380616e+01  0.00000000e+00]
 [-7.61639102e-03  1.74513442e-02]]
grads:  [1.80637048e-02 2.73754561e+01]
Stock Position:  0.01806370476685076
Bond Position:  [15.44422148]


portfolio before change:  [17.4777788]
curr_Stock_Price:  112.47009913355186
curr_Factors:  [1.12470099e+02 3.55576453e-02]
mat_Sqrt:  [[ 2.12081885e+01  0.00000000e+00]
 [-7.54269399e-03  1.72824831e-02]]
grads:  [-2.65590891e-03 -1.02123032e+01]
Stock Position:  -0.0026559089134327784
Bond Position:  [17.77648914]


portfolio before change:  [17.47783867]
curr_Stock_Price:  113.28425539333035
curr_Factors:  [1.13284255e+02 3.55845989e-02]
mat_Sqrt:  [[ 2.13698066e+01  0.00000000e+00]
 [-7.54555221e-03  1.72890321e-02]]
grads:  [ -0.03946559 -14.85142971]
Stock Position:  -0.03946559254704521
Bond Position:  [21.94866894]


portfolio before change:  [17.46458564]
curr_Stock_Price:  113.68959050115447
curr_Factors:  [1.13689591e+02 3.53590742e-02]
mat_Sqrt:  [[ 2.13782005e+01  0.00000000e+00]
 [-7.52160347e-03  1.72341586e-02]]
grads:  [-3.40422637e-02 -1.02893991e+02]
Stock Position:  -0.03404226369517444
Bond Position:  [21.33483666]


portfolio before change:  [17.46181065]
curr_Stock_Price:  113.84945072036656
curr_Factors:  [1.13849451e+02 3.43081092e-02]
mat_Sqrt:  [[ 2.10877057e+01  0.00000000e+00]
 [-7.40897933e-03  1.69761043e-02]]
grads:  [-1.78011030e-02 -4.94634779e+01]
Stock Position:  -0.01780110302068746
Bond Position:  [19.48845646]


portfolio before change:  [17.46162709]
curr_Stock_Price:  113.99662015259692
curr_Factors:  [1.13996620e+02 3.41480376e-02]
mat_Sqrt:  [[ 2.10656494e+01  0.00000000e+00]
 [-7.39167506e-03  1.69364552e-02]]
grads:  [ 2.90213421e-03 -1.70355686e+01]
Stock Position:  0.002902134208068018
Bond Position:  [17.13079359]


portfolio before change:  [17.45731966]
curr_Stock_Price:  111.7744936468312
curr_Factors:  [1.11774494e+02 3.51021453e-02]
mat_Sqrt:  [[ 2.09415846e+01  0.00000000e+00]
 [-7.49422661e-03  1.71714304e-02]]
grads:  [-0.00319104 -1.13802851]
Stock Position:  -0.0031910436463491606
Bond Position:  [17.81399695]


portfolio before change:  [17.45302136]
curr_Stock_Price:  113.81933966457517
curr_Factors:  [1.13819340e+02 3.41596443e-02]
mat_Sqrt:  [[ 2.10364635e+01  0.00000000e+00]
 [-7.39293114e-03  1.69393333e-02]]
grads:  [-2.30367001e-04 -6.44024103e+00]
Stock Position:  -0.0002303670007552894
Bond Position:  [17.47924157]


portfolio before change:  [17.45545907]
curr_Stock_Price:  112.7225025948275
curr_Factors:  [1.12722503e+02 3.46986358e-02]
mat_Sqrt:  [[ 2.09974629e+01  0.00000000e+00]
 [-7.45102793e-03  1.70724497e-02]]
grads:  [ 9.97957573e-04 -6.75600268e+00]
Stock Position:  0.0009979575734943074
Bond Position:  [17.3429668]


portfolio before change:  [17.45804846]
curr_Stock_Price:  113.1447476191653
curr_Factors:  [1.13144748e+02 3.50599178e-02]
mat_Sqrt:  [[ 2.11855549e+01  0.00000000e+00]
 [-7.48971751e-03  1.71610987e-02]]
grads:  [-1.50582952e-03 -5.90854440e+01]
Stock Position:  -0.0015058295190545148
Bond Position:  [17.62842516]


portfolio before change:  [17.46269832]
curr_Stock_Price:  111.52028468604564
curr_Factors:  [1.11520285e+02 3.48470642e-02]
mat_Sqrt:  [[ 2.08179024e+01  0.00000000e+00]
 [-7.46694735e-03  1.71089257e-02]]
grads:  [-5.51352813e-03 -1.89867274e+01]
Stock Position:  -0.005513528125718742
Bond Position:  [18.07756854]


portfolio before change:  [17.46047782]
curr_Stock_Price:  112.3328914849806
curr_Factors:  [1.12332891e+02 3.25618432e-02]
mat_Sqrt:  [[ 2.02703584e+01  0.00000000e+00]
 [-7.21796018e-03  1.65384245e-02]]
grads:  [6.12165080e-03 2.16107283e+01]
Stock Position:  0.006121650800015301
Bond Position:  [16.77281509]


portfolio before change:  [17.47126654]
curr_Stock_Price:  113.7527669354238
curr_Factors:  [1.13752767e+02 3.07676451e-02]
mat_Sqrt:  [[ 1.99530411e+01  0.00000000e+00]
 [-7.01628336e-03  1.60763248e-02]]
grads:  [ 1.00256246e-02 -5.18460945e+01]
Stock Position:  0.010025624584586529
Bond Position:  [16.330824]


portfolio before change:  [17.47738132]
curr_Stock_Price:  114.15905642574288
curr_Factors:  [1.14159056e+02 3.19261814e-02]
mat_Sqrt:  [[ 2.03978249e+01  0.00000000e+00]
 [-7.14715959e-03  1.63761999e-02]]
grads:  [-0.05511483 12.33214773]
Stock Position:  -0.055114825579179
Bond Position:  [23.76923781]


portfolio before change:  [17.43795619]
curr_Stock_Price:  114.92829538880503
curr_Factors:  [1.14928295e+02 3.21977703e-02]
mat_Sqrt:  [[ 2.06224312e+01  0.00000000e+00]
 [-7.17749486e-03  1.64457068e-02]]
grads:  [-1.18703607e-02  1.77958021e+01]
Stock Position:  -0.011870360668018757
Bond Position:  [18.80219651]


portfolio before change:  [17.4352763]
curr_Stock_Price:  115.35206678636534
curr_Factors:  [1.15352067e+02 3.17052039e-02]
mat_Sqrt:  [[ 2.05395373e+01  0.00000000e+00]
 [-7.12238206e-03  1.63194275e-02]]
grads:  [-1.41623634e-02 -2.93673438e+01]
Stock Position:  -0.014162363420055172
Bond Position:  [19.06893419]


portfolio before change:  [17.41575261]
curr_Stock_Price:  116.89894485673271
curr_Factors:  [1.16898945e+02 3.13700416e-02]
mat_Sqrt:  [[ 2.07046617e+01  0.00000000e+00]
 [-7.08463595e-03  1.62329403e-02]]
grads:  [9.11927170e-03 2.26705051e+01]
Stock Position:  0.00911927170398914
Bond Position:  [16.34971937]


portfolio before change:  [17.43491089]
curr_Stock_Price:  118.77567814343547
curr_Factors:  [1.18775678e+02 3.02619148e-02]
mat_Sqrt:  [[ 2.06621600e+01  0.00000000e+00]
 [-6.95838082e-03  1.59436534e-02]]
grads:  [5.01860912e-03 1.30780338e+02]
Stock Position:  0.00501860912304081
Bond Position:  [16.83882219]


portfolio before change:  [17.43317901]
curr_Stock_Price:  118.01114928608486
curr_Factors:  [1.18011149e+02 2.91525773e-02]
mat_Sqrt:  [[ 2.01493721e+01  0.00000000e+00]
 [-6.82965033e-03  1.56486948e-02]]
grads:  [3.11236923e-03 1.42900365e+01]
Stock Position:  0.0031123692284556
Bond Position:  [17.06588474]


portfolio before change:  [17.42972475]
curr_Stock_Price:  116.21585181633466
curr_Factors:  [1.16215852e+02 3.04510320e-02]
mat_Sqrt:  [[ 2.02799265e+01  0.00000000e+00]
 [-6.98008962e-03  1.59933945e-02]]
grads:  [ 0.00357706 -0.74700772]
Stock Position:  0.003577064080587319
Bond Position:  [17.0140132]


portfolio before change:  [17.43049989]
curr_Stock_Price:  115.83796010134074
curr_Factors:  [1.15837960e+02 2.86912525e-02]
mat_Sqrt:  [[ 1.96212041e+01  0.00000000e+00]
 [-6.77539696e-03  1.55243847e-02]]
grads:  [-1.05484303e-02 -2.83651172e+01]
Stock Position:  -0.010548430348730885
Bond Position:  [18.65240854]


portfolio before change:  [17.45125471]
curr_Stock_Price:  114.09143234417962
curr_Factors:  [1.14091432e+02 2.94339925e-02]
mat_Sqrt:  [[ 1.95739115e+01  0.00000000e+00]
 [-6.86253510e-03  1.57240433e-02]]
grads:  [0.005184  3.3928335]
Stock Position:  0.005184000745776802
Bond Position:  [16.85980464]


portfolio before change:  [17.45346402]
curr_Stock_Price:  114.11105017909172
curr_Factors:  [1.14111050e+02 2.95254576e-02]
mat_Sqrt:  [[ 1.96076714e+01  0.00000000e+00]
 [-6.87318938e-03  1.57484553e-02]]
grads:  [-0.00475058  2.63410178]
Stock Position:  -0.004750579721033893
Bond Position:  [17.99555766]


portfolio before change:  [17.45627133]
curr_Stock_Price:  113.99364765505806
curr_Factors:  [1.13993648e+02 2.99119692e-02]
mat_Sqrt:  [[ 1.97152893e+01  0.00000000e+00]
 [-6.91803085e-03  1.58512000e-02]]
grads:  [ -0.02539137 -13.23895978]
Stock Position:  -0.02539136513833221
Bond Position:  [20.35072567]


portfolio before change:  [17.46761848]
curr_Stock_Price:  113.64694912945032
curr_Factors:  [1.13646949e+02 2.95428341e-02]
mat_Sqrt:  [[ 1.95336706e+01  0.00000000e+00]
 [-6.87521161e-03  1.57530888e-02]]
grads:  [-4.04341108e-03 -6.26268437e+00]
Stock Position:  -0.004043411081963549
Bond Position:  [17.92713982]


portfolio before change:  [17.47362477]
curr_Stock_Price:  112.71574085656857
curr_Factors:  [1.12715741e+02 2.97040256e-02]
mat_Sqrt:  [[ 1.94263954e+01  0.00000000e+00]
 [-6.89394233e-03  1.57960063e-02]]
grads:  [ 1.35162309e-04 -3.92928145e+00]
Stock Position:  0.00013516230888945859
Bond Position:  [17.45838985]


portfolio before change:  [17.47562617]
curr_Stock_Price:  111.37632677555425
curr_Factors:  [1.11376327e+02 3.12649219e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.47562617]
Stock Price:  110.59970900906873
PL:  [6.87591716]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.18301983e+00  2.96358297e-01]
 [-2.66698103e-01 -1.00324817e-01]
 [-1.09204369e+00 -3.04809659e-01]
 [-5.15771659e-01 -2.42743864e-02]
 [-1.32341548e-01 -1.24603632e+00]
 [ 2.57082314e-01 -3.37702355e-01]
 [ 6.14592741e-01 -7.60589644e-01]
 [-1.34597271e+00  2.35878814e-01]
 [-6.47193511e-02 -3.26460933e-01]
 [-9.56938395e-01 -1.10677286e+00]
 [ 3.69895470e-02 -2.79936373e-02]
 [-4.65986378e-01 -3.50502130e-01]
 [ 4.48776142e-02  1.56455273e-01]
 [ 2.20118611e-02 -1.88588175e-01]
 [-2.98860712e-01 -1.53463155e-01]
 [ 7.62541442e-02 -1.28575364e+00]
 [ 9.58476785e-03 -4.73386649e-01]
 [ 4.53076845e-02 -1.73131936e-01]
 [-9.66148854e-02 -7.02728596e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 6.35824158e-02 -3.30513300e-03]
 [ 2.86041049e-01 -4.81607145e-01]
 [ 2.71083678e-02 -3.32220614e-01]
 [ 4.42350903e-02  2.74127447e-02]
 [ 4.24735804e-01 -3.54118043e-01]
 [-1.83985831e-01  2.07035270e-03]
 [-1.47106232e-01  1.23658940e-01]
 [-4.74839005e-02  7.84681259e-02]
 [-5.32104041e-02  1.99486150e-01]
 [-7.23131175e-01 -2.69166695e-02]
 [-1.56342890e-01 -3.42337747e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.42057419e-01  1.29816204e-04]
 [ 7.00489422e-02  5.90299412e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.48757955e-01  6.55277017e-02]
 [-2.09187378e-02 -2.36360517e-01]
 [-1.63067575e-02 -3.17814781e-02]
 [-7.47033492e-03 -1.06458959e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.02630801]
curr_Stock_Price:  100.63066432926739
curr_Factors:  [1.00630664e+02 4.11023301e-02]
mat_Sqrt:  [[ 2.04015687e+01  0.00000000e+00]
 [-8.10948384e-03  1.85811618e-02]]
grads:  [ 0.06432648 15.94939545]
Stock Position:  0.06432648493043551
Bond Position:  [0.55309109]


portfolio before change:  [7.11744853]
curr_Stock_Price:  102.04643239693813
curr_Factors:  [1.02046432e+02 4.01243070e-02]
mat_Sqrt:  [[ 2.04409746e+01  0.00000000e+00]
 [-8.01242106e-03  1.83587630e-02]]
grads:  [-0.01518927 -5.46468282]
Stock Position:  -0.015189268049539073
Bond Position:  [8.66745915]


portfolio before change:  [7.07533983]
curr_Stock_Price:  104.89003222054144
curr_Factors:  [1.04890032e+02 3.99866584e-02]
mat_Sqrt:  [[ 2.09745076e+01  0.00000000e+00]
 [-7.99866573e-03  1.83272456e-02]]
grads:  [ -0.05840774 -16.63150403]
Stock Position:  -0.05840773731720285
Bond Position:  [13.20172928]


portfolio before change:  [7.00679844]
curr_Stock_Price:  106.09178580708809
curr_Factors:  [1.06091786e+02 4.00466555e-02]
mat_Sqrt:  [[ 2.12307280e+01  0.00000000e+00]
 [-8.00466419e-03  1.83409898e-02]]
grads:  [-0.02479264 -1.32350471]
Stock Position:  -0.0247926435225056
Bond Position:  [9.63709427]


portfolio before change:  [7.00421427]
curr_Stock_Price:  106.24460862485176
curr_Factors:  [1.06244609e+02 4.07172509e-02]
mat_Sqrt:  [[ 2.14385854e+01  0.00000000e+00]
 [-8.07140641e-03  1.84939154e-02]]
grads:  [-3.15392256e-02 -6.73754739e+01]
Stock Position:  -0.03153922557906249
Bond Position:  [10.35508695]


portfolio before change:  [6.95936778]
curr_Stock_Price:  107.70757937320344
curr_Factors:  [1.07707579e+02 3.98996470e-02]
mat_Sqrt:  [[ 2.15144770e+01  0.00000000e+00]
 [-7.98995840e-03  1.83072946e-02]]
grads:  [ 5.09874924e-03 -1.84463277e+01]
Stock Position:  0.005098749239139958
Bond Position:  [6.41019384]


portfolio before change:  [6.95942264]
curr_Stock_Price:  107.56117929601697
curr_Factors:  [1.07561179e+02 4.01545994e-02]
mat_Sqrt:  [[ 2.15537680e+01  0.00000000e+00]
 [-8.01544503e-03  1.83656918e-02]]
grads:  [ 1.31134475e-02 -4.14136125e+01]
Stock Position:  0.013113447529073008
Bond Position:  [5.54892476]


portfolio before change:  [6.99015818]
curr_Stock_Price:  109.8521007249336
curr_Factors:  [1.09852101e+02 4.10913552e-02]
mat_Sqrt:  [[ 2.22681224e+01  0.00000000e+00]
 [-8.10840110e-03  1.85786809e-02]]
grads:  [-0.05582091 12.69620891]
Stock Position:  -0.055820905532188575
Bond Position:  [13.12220192]


portfolio before change:  [6.95973147]
curr_Stock_Price:  110.42656449627592
curr_Factors:  [1.10426564e+02 3.91954553e-02]
mat_Sqrt:  [[ 2.18620769e+01  0.00000000e+00]
 [-7.91913685e-03  1.81450220e-02]]
grads:  [-9.47753427e-03 -1.79917628e+01]
Stock Position:  -0.009477534273846316
Bond Position:  [8.00630302]


portfolio before change:  [6.97006439]
curr_Stock_Price:  109.44191254887784
curr_Factors:  [1.09441913e+02 4.02399961e-02]
mat_Sqrt:  [[ 2.19539484e+01  0.00000000e+00]
 [-8.02396372e-03  1.83852106e-02]]
grads:  [ -0.06559065 -60.19908527]
Stock Position:  -0.06559064665224361
Bond Position:  [14.14843021]


portfolio before change:  [7.03076527]
curr_Stock_Price:  108.54342756457655
curr_Factors:  [1.08543428e+02 4.09456464e-02]
mat_Sqrt:  [[ 2.19637958e+01  0.00000000e+00]
 [-8.09401224e-03  1.85457119e-02]]
grads:  [ 1.12786161e-03 -1.50943989e+00]
Stock Position:  0.001127861608656058
Bond Position:  [6.9083433]


portfolio before change:  [7.03169971]
curr_Stock_Price:  108.60623766114307
curr_Factors:  [1.08606238e+02 4.00006760e-02]
mat_Sqrt:  [[ 2.17214311e+01  0.00000000e+00]
 [-8.00006760e-03  1.83304577e-02]]
grads:  [ -0.02849527 -19.12129725]
Stock Position:  -0.028495270263424865
Bond Position:  [10.1264638]


portfolio before change:  [7.04514625]
curr_Stock_Price:  108.17877510867298
curr_Factors:  [1.08178775e+02 4.07795884e-02]
mat_Sqrt:  [[ 2.18455749e+01  0.00000000e+00]
 [-8.07758265e-03  1.85080670e-02]]
grads:  [5.18000986e-03 8.45335570e+00]
Stock Position:  0.005180009864192375
Bond Position:  [6.48477913]


portfolio before change:  [7.04393483]
curr_Stock_Price:  107.78841531412989
curr_Factors:  [1.07788415e+02 4.08022567e-02]
mat_Sqrt:  [[ 2.17727948e+01  0.00000000e+00]
 [-8.07982739e-03  1.85132103e-02]]
grads:  [-2.76927087e-03 -1.01866814e+01]
Stock Position:  -0.002769270865887465
Bond Position:  [7.34243015]


portfolio before change:  [7.04363015]
curr_Stock_Price:  108.2298853086728
curr_Factors:  [1.08229885e+02 3.94438234e-02]
mat_Sqrt:  [[ 2.14949630e+01  0.00000000e+00]
 [-7.94418766e-03  1.82024206e-02]]
grads:  [-0.01701969 -8.43092017]
Stock Position:  -0.01701968617103853
Bond Position:  [8.88566883]


portfolio before change:  [7.04072545]
curr_Stock_Price:  108.4658162937178
curr_Factors:  [1.08465816e+02 4.07858575e-02]
mat_Sqrt:  [[ 2.19052235e+01  0.00000000e+00]
 [-8.07820352e-03  1.85094895e-02]]
grads:  [-2.21360331e-02 -6.94645653e+01]
Stock Position:  -0.022136033077050473
Bond Position:  [9.44172835]


portfolio before change:  [7.05155177]
curr_Stock_Price:  108.03005487918848
curr_Factors:  [1.08030055e+02 4.20497689e-02]
mat_Sqrt:  [[ 2.21526866e+01  0.00000000e+00]
 [-8.20241612e-03  1.87940964e-02]]
grads:  [-8.89364381e-03 -2.51880505e+01]
Stock Position:  -0.008893643810405973
Bond Position:  [8.0123326]


portfolio before change:  [7.06445228]
curr_Stock_Price:  106.69214328142434
curr_Factors:  [1.06692143e+02 4.32635630e-02]
mat_Sqrt:  [[ 2.21918537e+01  0.00000000e+00]
 [-8.31995798e-03  1.90634186e-02]]
grads:  [-1.36326093e-03 -9.08189344e+00]
Stock Position:  -0.0013632609349999352
Bond Position:  [7.20990152]


portfolio before change:  [7.06451458]
curr_Stock_Price:  107.30758176114433
curr_Factors:  [1.07307582e+02 4.25846087e-02]
mat_Sqrt:  [[ 2.21440339e+01  0.00000000e+00]
 [-8.25441542e-03  1.89132417e-02]]
grads:  [-0.00574803 -3.71553753]
Stock Position:  -0.005748025675196399
Bond Position:  [7.68132131]


portfolio before change:  [7.04435286]
curr_Stock_Price:  110.98222522744493
curr_Factors:  [1.10982225e+02 4.02250394e-02]
mat_Sqrt:  [[ 2.22587959e+01  0.00000000e+00]
 [-8.02247238e-03  1.83817935e-02]]
grads:  [-2.17716494e-04 -5.93486100e+00]
Stock Position:  -0.00021771649400726027
Bond Position:  [7.06851552]


portfolio before change:  [7.04573129]
curr_Stock_Price:  108.709476656803
curr_Factors:  [1.08709477e+02 4.05988989e-02]
mat_Sqrt:  [[ 2.19040556e+01  0.00000000e+00]
 [-8.05966738e-03  1.84670179e-02]]
grads:  [ 0.00283691 -0.17897492]
Stock Position:  0.0028369147110453375
Bond Position:  [6.73733178]


portfolio before change:  [7.0411191]
curr_Stock_Price:  106.78682080594321
curr_Factors:  [1.06786821e+02 4.30451465e-02]
mat_Sqrt:  [[ 2.21554080e+01  0.00000000e+00]
 [-8.29892971e-03  1.90152368e-02]]
grads:  [ 3.42356409e-03 -2.53274335e+01]
Stock Position:  0.003423564088638595
Bond Position:  [6.67552757]


portfolio before change:  [7.0361927]
curr_Stock_Price:  105.10410216160454
curr_Factors:  [1.05104102e+02 4.27544598e-02]
mat_Sqrt:  [[ 2.17325345e+01  0.00000000e+00]
 [-8.27086063e-03  1.89509225e-02]]
grads:  [-5.42433718e-03 -1.75305774e+01]
Stock Position:  -0.005424337179770476
Bond Position:  [7.60631279]


portfolio before change:  [7.04609387]
curr_Stock_Price:  103.4540702376478
curr_Factors:  [1.03454070e+02 4.34072088e-02]
mat_Sqrt:  [[ 2.15540315e+01  0.00000000e+00]
 [-8.33375870e-03  1.90950400e-02]]
grads:  [0.00260735 1.43559503]
Stock Position:  0.0026073541285347957
Bond Position:  [6.77635248]


portfolio before change:  [7.04754623]
curr_Stock_Price:  103.68620697171008
curr_Factors:  [1.03686207e+02 4.30217384e-02]
mat_Sqrt:  [[ 2.15062636e+01  0.00000000e+00]
 [-8.29667291e-03  1.90100658e-02]]
grads:  [ 1.25631316e-02 -1.86279230e+01]
Stock Position:  0.012563131580160727
Bond Position:  [5.74492277]


portfolio before change:  [7.04936615]
curr_Stock_Price:  103.77390480996787
curr_Factors:  [1.03773905e+02 4.44360582e-02]
mat_Sqrt:  [[ 2.18753959e+01  0.00000000e+00]
 [-8.43194480e-03  1.93200126e-02]]
grads:  [-0.00836932  0.10716104]
Stock Position:  -0.008369323043786564
Bond Position:  [7.91788349]


portfolio before change:  [7.04437887]
curr_Stock_Price:  104.48806975285243
curr_Factors:  [1.04488070e+02 4.40573281e-02]
mat_Sqrt:  [[ 2.19318761e+01  0.00000000e+00]
 [-8.39593502e-03  1.92375039e-02]]
grads:  [-4.24665202e-03  6.42801379e+00]
Stock Position:  -0.0042466520218875595
Bond Position:  [7.48810335]


portfolio before change:  [7.04696875]
curr_Stock_Price:  104.09863349860615
curr_Factors:  [1.04098633e+02 4.44510331e-02]
mat_Sqrt:  [[ 2.19475455e+01  0.00000000e+00]
 [-8.43336546e-03  1.93232678e-02]]
grads:  [-6.03147295e-04  4.06081036e+00]
Stock Position:  -0.0006031472953589355
Bond Position:  [7.10975556]


portfolio before change:  [7.04820908]
curr_Stock_Price:  103.51575485328574
curr_Factors:  [1.03515755e+02 4.31973205e-02]
mat_Sqrt:  [[ 2.15146783e+01  0.00000000e+00]
 [-8.31358603e-03  1.90488186e-02]]
grads:  [1.57346018e-03 1.04723634e+01]
Stock Position:  0.0015734601789166036
Bond Position:  [6.88533116]


portfolio before change:  [7.04997732]
curr_Stock_Price:  104.09252060609866
curr_Factors:  [1.04092521e+02 4.33899929e-02]
mat_Sqrt:  [[ 2.16827476e+01  0.00000000e+00]
 [-8.33210589e-03  1.90912530e-02]]
grads:  [-0.03389232 -1.40989539]
Stock Position:  -0.03389231778219991
Bond Position:  [10.57791411]


portfolio before change:  [7.07315788]
curr_Stock_Price:  103.44758866982876
curr_Factors:  [1.03447589e+02 4.36940562e-02]
mat_Sqrt:  [[ 2.16237770e+01  0.00000000e+00]
 [-8.36124931e-03  1.91580289e-02]]
grads:  [-0.00792108 -1.78691529]
Stock Position:  -0.007921083075129218
Bond Position:  [7.89257482]


portfolio before change:  [7.06674227]
curr_Stock_Price:  104.38208799045513
curr_Factors:  [1.04382088e+02 4.36726189e-02]
mat_Sqrt:  [[ 2.18137634e+01  0.00000000e+00]
 [-8.35919794e-03  1.91533287e-02]]
grads:  [ 0.00332554 -0.62376568]
Stock Position:  0.0033255424783967735
Bond Position:  [6.7196152]


portfolio before change:  [7.06948134]
curr_Stock_Price:  104.95314334873775
curr_Factors:  [1.04953143e+02 4.39393598e-02]
mat_Sqrt:  [[ 2.19999814e+01  0.00000000e+00]
 [-8.38468698e-03  1.92117314e-02]]
grads:  [-0.01100004  0.00675713]
Stock Position:  -0.011000043973507
Bond Position:  [8.22397053]


portfolio before change:  [7.10057514]
curr_Stock_Price:  102.21990526713316
curr_Factors:  [1.02219905e+02 4.68861414e-02]
mat_Sqrt:  [[ 2.21338886e+01  0.00000000e+00]
 [-8.66128317e-03  1.98454929e-02]]
grads:  [0.00432873 2.97447594]
Stock Position:  0.00432873419438338
Bond Position:  [6.65809234]


portfolio before change:  [7.10328941]
curr_Stock_Price:  102.65466390234874
curr_Factors:  [1.02654664e+02 4.29594117e-02]
mat_Sqrt:  [[ 2.12768753e+01  0.00000000e+00]
 [-8.29066093e-03  1.89962906e-02]]
grads:  [-0.00444932  4.28110665]
Stock Position:  -0.004449319248225753
Bond Position:  [7.56003278]


portfolio before change:  [7.10884899]
curr_Stock_Price:  101.61753541670652
curr_Factors:  [1.01617535e+02 4.42726279e-02]
mat_Sqrt:  [[ 2.13814084e+01  0.00000000e+00]
 [-8.41642470e-03  1.92844516e-02]]
grads:  [-0.01029676  3.39795515]
Stock Position:  -0.010296764264943454
Bond Position:  [8.15518079]


portfolio before change:  [7.11363664]
curr_Stock_Price:  101.25157701133958
curr_Factors:  [1.01251577e+02 4.43141285e-02]
mat_Sqrt:  [[ 2.13143897e+01  0.00000000e+00]
 [-8.42036850e-03  1.92934880e-02]]
grads:  [-5.82118118e-03 -1.22507924e+01]
Stock Position:  -0.00582118117777963
Bond Position:  [7.70304041]


portfolio before change:  [7.12286782]
curr_Stock_Price:  99.83120437307858
curr_Factors:  [9.98312044e+01 4.44384656e-02]
mat_Sqrt:  [[ 2.10448502e+01  0.00000000e+00]
 [-8.43217320e-03  1.93205360e-02]]
grads:  [-1.43395327e-03 -1.64495840e+00]
Stock Position:  -0.0014339532676971895
Bond Position:  [7.2660211]


portfolio before change:  [7.12333635]
curr_Stock_Price:  100.13789345909053
curr_Factors:  [1.00137893e+02 4.47044789e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.12333635]
Stock Price:  99.95874572201781
PL:  [7.12333635]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.45129846e+00  3.61459555e-01]
 [ 1.07190090e+00  7.08809467e-02]
 [-1.34079223e-01  1.57421755e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.55487661e-02  1.94143727e-01]
 [-2.10917956e-01  2.55237052e-02]
 [ 9.42017168e-02  5.12220605e-02]
 [ 6.97339798e-01  6.91419110e-01]
 [-3.68943244e-02  2.29525239e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-8.51476748e-02  1.03154387e-02]
 [ 1.29921335e-02 -1.35967205e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 2.30936536e-02 -2.02008408e-01]
 [ 1.14963251e-01  6.72382183e-02]
 [ 1.04273829e-01 -8.35897495e-01]
 [ 2.79763085e-02 -1.48220018e-01]
 [ 3.12032666e-02 -1.52624808e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 1.33465601e-02 -9.18699743e-02]
 [ 1.75285251e-01 -4.25801989e-02]
 [ 9.01846240e-01  2.98877109e-02]
 [ 2.07859269e-02  7.70998916e-02]
 [-1.31690950e-01  1.06281891e-01]
 [-1.79534614e-01  1.61801108e-01]
 [ 1.55851940e-01 -9.39682694e-02]
 [-1.92659097e-01 -4.24479914e-01]
 [ 5.91298030e-02  7.63699484e-02]
 [ 2.28315110e-01 -6.36826952e-03]
 [-5.33459982e-01 -1.12557109e-01]
 [-1.65523663e-01 -6.04913620e-02]
 [ 7.73613876e-03 -7.28205244e-02]
 [-2.38501884e-01  1.37422367e-01]
 [ 2.56238098e-02  2.70345151e-02]
 [-1.07450519e-02  4.97254940e-02]
 [-2.13735273e-01  8.48778455e-02]
 [-2.23912611e-02 -2.22507315e-01]
 [ 1.99090978e-02 -2.72619391e-02]
 [-5.44610120e-02 -5.66967503e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.97345591]
curr_Stock_Price:  98.59852908532591
curr_Factors:  [9.85985291e+01 4.10876563e-02]
mat_Sqrt:  [[ 1.99860109e+01  0.00000000e+00]
 [-8.10803615e-03  1.85778447e-02]]
grads:  [ 0.08050893 19.45648493]
Stock Position:  0.08050892942799469
Bond Position:  [-14.91151793]


portfolio before change:  [-6.99240849]
curr_Stock_Price:  98.38627280793176
curr_Factors:  [9.83862728e+01 4.07120906e-02]
mat_Sqrt:  [[ 1.98516318e+01  0.00000000e+00]
 [-8.07089493e-03  1.84927435e-02]]
grads:  [0.05555392 3.83290596]
Stock Position:  0.055553915921727405
Bond Position:  [-12.45815122]


portfolio before change:  [-7.07743531]
curr_Stock_Price:  96.88377833908223
curr_Factors:  [9.68837783e+01 4.09912951e-02]
mat_Sqrt:  [[ 1.96153873e+01  0.00000000e+00]
 [-8.09852284e-03  1.85560470e-02]]
grads:  [-3.33282927e-03  8.48358247e+00]
Stock Position:  -0.0033328292683300433
Bond Position:  [-6.75453822]


portfolio before change:  [-7.08329957]
curr_Stock_Price:  98.38997222054657
curr_Factors:  [9.83899722e+01 4.09747676e-02]
mat_Sqrt:  [[ 1.99163196e+01  0.00000000e+00]
 [-8.09689003e-03  1.85523057e-02]]
grads:  [-8.18492937e-04 -8.15999987e+00]
Stock Position:  -0.0008184929374697064
Bond Position:  [-7.00276807]


portfolio before change:  [-7.08472748]
curr_Stock_Price:  99.06500547682019
curr_Factors:  [9.90650055e+01 4.03807849e-02]
mat_Sqrt:  [[ 1.99070839e+01  0.00000000e+00]
 [-8.03798829e-03  1.84173449e-02]]
grads:  [4.61268112e-04 1.05413526e+01]
Stock Position:  0.00046126811220033065
Bond Position:  [-7.13042301]


portfolio before change:  [-7.08500129]
curr_Stock_Price:  100.40381886072562
curr_Factors:  [1.00403819e+02 4.00866140e-02]
mat_Sqrt:  [[ 2.01024930e+01  0.00000000e+00]
 [-8.00865672e-03  1.83501378e-02]]
grads:  [-0.009938    1.39092717]
Stock Position:  -0.009937996153372031
Bond Position:  [-6.08718852]


portfolio before change:  [-7.08378939]
curr_Stock_Price:  100.20530416465982
curr_Factors:  [1.00205304e+02 3.85713391e-02]
mat_Sqrt:  [[ 1.96799082e+01  0.00000000e+00]
 [-7.85583494e-03  1.79999791e-02]]
grads:  [0.00592263 2.84567333]
Stock Position:  0.005922632124093012
Bond Position:  [-7.67726855]


portfolio before change:  [-7.09313803]
curr_Stock_Price:  98.78888730370235
curr_Factors:  [9.87888873e+01 3.76325525e-02]
mat_Sqrt:  [[ 1.91641664e+01  0.00000000e+00]
 [-7.75964458e-03  1.77795793e-02]]
grads:  [ 0.05213375 38.88838409]
Stock Position:  0.05213374890886964
Bond Position:  [-12.24337307]


portfolio before change:  [-7.08360503]
curr_Stock_Price:  99.00110144992766
curr_Factors:  [9.90011014e+01 3.70004378e-02]
mat_Sqrt:  [[ 1.90433548e+01  0.00000000e+00]
 [-7.69419914e-03  1.76296250e-02]]
grads:  [3.32287578e-03 1.30192922e+01]
Stock Position:  0.0033228757783468382
Bond Position:  [-7.41257339]


portfolio before change:  [-7.08843185]
curr_Stock_Price:  97.82736164823478
curr_Factors:  [9.78273616e+01 3.88428201e-02]
mat_Sqrt:  [[ 1.92803857e+01  0.00000000e+00]
 [-7.88343277e-03  1.80632137e-02]]
grads:  [0.0127816  6.26004516]
Stock Position:  0.012781600459652799
Bond Position:  [-8.3388221]


portfolio before change:  [-7.08402898]
curr_Stock_Price:  98.2533869404134
curr_Factors:  [9.82533869e+01 3.93415673e-02]
mat_Sqrt:  [[ 1.94882732e+01  0.00000000e+00]
 [-7.93388352e-03  1.81788109e-02]]
grads:  [-0.00413816  0.56744299]
Stock Position:  -0.00413816285965218
Bond Position:  [-6.67744046]


portfolio before change:  [-7.09405829]
curr_Stock_Price:  100.47528431764184
curr_Factors:  [1.00475284e+02 3.83557556e-02]
mat_Sqrt:  [[ 1.96777081e+01  0.00000000e+00]
 [-7.83385020e-03  1.79496058e-02]]
grads:  [-2.35539725e-03 -7.57494103e+00]
Stock Position:  -0.00235539725477228
Bond Position:  [-6.85739908]


portfolio before change:  [-7.10062641]
curr_Stock_Price:  102.89988363767564
curr_Factors:  [1.02899884e+02 3.77453307e-02]
mat_Sqrt:  [[ 1.99915515e+01  0.00000000e+00]
 [-7.77126303e-03  1.78062006e-02]]
grads:  [-0.00327686 -1.00470636]
Stock Position:  -0.00327686027255237
Bond Position:  [-6.76343787]


portfolio before change:  [-7.10267237]
curr_Stock_Price:  103.2662328987601
curr_Factors:  [1.03266233e+02 3.77752750e-02]
mat_Sqrt:  [[ 2.00706830e+01  0.00000000e+00]
 [-7.77434499e-03  1.78132622e-02]]
grads:  [-3.24204430e-03 -1.13403376e+01]
Stock Position:  -0.0032420443039823253
Bond Position:  [-6.76787866]


portfolio before change:  [-7.10347379]
curr_Stock_Price:  103.25247125091269
curr_Factors:  [1.03252471e+02 3.76801504e-02]
mat_Sqrt:  [[ 2.00427250e+01  0.00000000e+00]
 [-7.76455025e-03  1.77908196e-02]]
grads:  [0.00720004 3.77937721]
Stock Position:  0.007200039664947832
Bond Position:  [-7.84689568]


portfolio before change:  [-7.09548113]
curr_Stock_Price:  104.49879512256847
curr_Factors:  [1.04498795e+02 3.86138882e-02]
mat_Sqrt:  [[ 2.05344488e+01  0.00000000e+00]
 [-7.86016673e-03  1.80099045e-02]]
grads:  [-1.26880322e-02 -4.64132108e+01]
Stock Position:  -0.012688032158500543
Bond Position:  [-5.76959706]


portfolio before change:  [-7.07224684]
curr_Stock_Price:  102.61075301342575
curr_Factors:  [1.02610753e+02 3.87792780e-02]
mat_Sqrt:  [[ 2.02065763e+01  0.00000000e+00]
 [-7.87698196e-03  1.80484330e-02]]
grads:  [-1.81684469e-03 -8.21234830e+00]
Stock Position:  -0.0018168446928917563
Bond Position:  [-6.88581903]


portfolio before change:  [-7.07259203]
curr_Stock_Price:  102.32697275429874
curr_Factors:  [1.02326973e+02 3.85545954e-02]
mat_Sqrt:  [[ 2.00922328e+01  0.00000000e+00]
 [-7.85412966e-03  1.79960718e-02]]
grads:  [-1.76225614e-03 -8.48100684e+00]
Stock Position:  -0.0017622561447299542
Bond Position:  [-6.8922657]


portfolio before change:  [-7.07110934]
curr_Stock_Price:  100.99670369090742
curr_Factors:  [1.00996704e+02 3.98155546e-02]
mat_Sqrt:  [[ 2.01527160e+01  0.00000000e+00]
 [-7.98153415e-03  1.82879922e-02]]
grads:  [-1.58178751e-02 -2.56609714e+01]
Stock Position:  -0.015817875101007958
Bond Position:  [-5.4735561]


portfolio before change:  [-7.08735499]
curr_Stock_Price:  101.98049002091143
curr_Factors:  [1.01980490e+02 4.01559233e-02]
mat_Sqrt:  [[ 2.04358122e+01  0.00000000e+00]
 [-8.01557717e-03  1.83659946e-02]]
grads:  [-1.30891709e-03 -5.00217802e+00]
Stock Position:  -0.001308917089486006
Bond Position:  [-6.95387099]


portfolio before change:  [-7.08644882]
curr_Stock_Price:  100.6240593444044
curr_Factors:  [1.00624059e+02 4.05875012e-02]
mat_Sqrt:  [[ 2.02720650e+01  0.00000000e+00]
 [-8.05853596e-03  1.84644255e-02]]
grads:  [ 0.00772993 -2.30606681]
Stock Position:  0.0077299342001880605
Bond Position:  [-7.86426618]


portfolio before change:  [-7.09652946]
curr_Stock_Price:  99.44713560918983
curr_Factors:  [9.94471356e+01 3.90928545e-02]
mat_Sqrt:  [[ 1.96626012e+01  0.00000000e+00]
 [-7.90876522e-03  1.81212576e-02]]
grads:  [0.04652946 1.6493177 ]
Stock Position:  0.04652946467496705
Bond Position:  [-11.72375145]


portfolio before change:  [-7.15006321]
curr_Stock_Price:  98.32809871195062
curr_Factors:  [9.83280987e+01 4.05151154e-02]
mat_Sqrt:  [[ 1.97918405e+01  0.00000000e+00]
 [-8.05134676e-03  1.84479530e-02]]
grads:  [2.7503798e-03 4.1793196e+00]
Stock Position:  0.0027503798022162265
Bond Position:  [-7.42050283]


portfolio before change:  [-7.15504089]
curr_Stock_Price:  96.85555491388912
curr_Factors:  [9.68555549e+01 4.16831155e-02]
mat_Sqrt:  [[ 1.97744594e+01  0.00000000e+00]
 [-8.16657730e-03  1.87119793e-02]]
grads:  [-4.31393487e-03  5.67988501e+00]
Stock Position:  -0.004313934871588709
Bond Position:  [-6.73721233]


portfolio before change:  [-7.152543]
curr_Stock_Price:  96.08129903849608
curr_Factors:  [9.60812990e+01 4.28789781e-02]
mat_Sqrt:  [[ 1.98957850e+01  0.00000000e+00]
 [-8.28289593e-03  1.89784988e-02]]
grads:  [-5.47446713e-03  8.52549560e+00]
Stock Position:  -0.005474467127484449
Bond Position:  [-6.62654909]


portfolio before change:  [-7.15641732]
curr_Stock_Price:  96.63769107100063
curr_Factors:  [9.66376911e+01 4.33400038e-02]
mat_Sqrt:  [[ 2.01182878e+01  0.00000000e+00]
 [-8.32730485e-03  1.90802524e-02]]
grads:  [ 0.00570828 -4.92489656]
Stock Position:  0.005708280231380671
Bond Position:  [-7.70805234]


portfolio before change:  [-7.15037019]
curr_Stock_Price:  97.86585321507512
curr_Factors:  [9.78658532e+01 4.27629434e-02]
mat_Sqrt:  [[ 2.02378784e+01  0.00000000e+00]
 [-8.27168117e-03  1.89528025e-02]]
grads:  [-1.86737618e-02 -2.23966832e+01]
Stock Position:  -0.018673761756199257
Bond Position:  [-5.32284657]


portfolio before change:  [-7.14325558]
curr_Stock_Price:  97.44922517872669
curr_Factors:  [9.74492252e+01 4.19493942e-02]
mat_Sqrt:  [[ 1.99591130e+01  0.00000000e+00]
 [-8.19262050e-03  1.87716518e-02]]
grads:  [0.00463249 4.06836592]
Stock Position:  0.004632489485426918
Bond Position:  [-7.59468809]


portfolio before change:  [-7.14255338]
curr_Stock_Price:  97.8057482712454
curr_Factors:  [9.78057483e+01 4.16393089e-02]
mat_Sqrt:  [[ 1.99579595e+01  0.00000000e+00]
 [-8.16228487e-03  1.87021441e-02]]
grads:  [ 0.01130054 -0.34051013]
Stock Position:  0.011300542514297839
Bond Position:  [-8.2478114]


portfolio before change:  [-7.12676606]
curr_Stock_Price:  99.29402765107625
curr_Factors:  [9.92940277e+01 4.03251336e-02]
mat_Sqrt:  [[ 1.99393517e+01  0.00000000e+00]
 [-8.03244755e-03  1.84046495e-02]]
grads:  [-0.0292178  -6.11568884]
Stock Position:  -0.02921779703495678
Bond Position:  [-4.22561331]


portfolio before change:  [-7.11897357]
curr_Stock_Price:  99.00924484807113
curr_Factors:  [9.90092448e+01 4.20430210e-02]
mat_Sqrt:  [[ 2.03012465e+01  0.00000000e+00]
 [-8.20175796e-03  1.87925883e-02]]
grads:  [-0.00945382 -3.21889464]
Stock Position:  -0.00945381640767374
Bond Position:  [-6.18295835]


portfolio before change:  [-7.13068213]
curr_Stock_Price:  100.16598860442139
curr_Factors:  [1.00165989e+02 4.15179238e-02]
mat_Sqrt:  [[ 2.04097693e+01  0.00000000e+00]
 [-8.15037901e-03  1.86748644e-02]]
grads:  [-1.17812912e-03 -3.89938705e+00]
Stock Position:  -0.0011781291247081281
Bond Position:  [-7.01267366]


portfolio before change:  [-7.13199435]
curr_Stock_Price:  100.53571385218986
curr_Factors:  [1.00535714e+02 4.07688514e-02]
mat_Sqrt:  [[ 2.02994656e+01  0.00000000e+00]
 [-8.07651919e-03  1.85056303e-02]]
grads:  [-0.00879461  7.42597605]
Stock Position:  -0.008794608178498881
Bond Position:  [-6.24782214]


portfolio before change:  [-7.12540686]
curr_Stock_Price:  99.6978690585511
curr_Factors:  [9.96978691e+01 4.24886822e-02]
mat_Sqrt:  [[ 2.05505054e+01  0.00000000e+00]
 [-8.24511319e-03  1.88919277e-02]]
grads:  [0.00182101 1.43100882]
Stock Position:  0.0018210082344351788
Bond Position:  [-7.3069575]


portfolio before change:  [-7.12741708]
curr_Stock_Price:  99.0955722316566
curr_Factors:  [9.90955722e+01 4.24657050e-02]
mat_Sqrt:  [[ 2.04208314e+01  0.00000000e+00]
 [-8.24288348e-03  1.88868187e-02]]
grads:  [5.36556653e-04 2.63281470e+00]
Stock Position:  0.0005365566530962358
Bond Position:  [-7.18058747]


portfolio before change:  [-7.12746539]
curr_Stock_Price:  100.67846842812226
curr_Factors:  [1.00678468e+02 4.09916832e-02]
mat_Sqrt:  [[ 2.03837684e+01  0.00000000e+00]
 [-8.09856117e-03  1.85561348e-02]]
grads:  [-0.00866825  4.57411236]
Stock Position:  -0.008668247226845203
Bond Position:  [-6.25475954]


portfolio before change:  [-7.12886176]
curr_Stock_Price:  100.74935657690756
curr_Factors:  [1.00749357e+02 4.17069281e-02]
mat_Sqrt:  [[ 2.05753098e+01  0.00000000e+00]
 [-8.16890966e-03  1.87173234e-02]]
grads:  [-5.80800076e-03 -1.18877743e+01]
Stock Position:  -0.005808000759823578
Bond Position:  [-6.54370942]


portfolio before change:  [-7.13132564]
curr_Stock_Price:  101.03273466826333
curr_Factors:  [1.01032735e+02 4.16197997e-02]
mat_Sqrt:  [[ 2.06116188e+01  0.00000000e+00]
 [-8.16037251e-03  1.86977624e-02]]
grads:  [ 3.88664869e-04 -1.45803217e+00]
Stock Position:  0.00038866486927834754
Bond Position:  [-7.17059351]


portfolio before change:  [-7.1319175]
curr_Stock_Price:  101.81622199197723
curr_Factors:  [1.01816222e+02 4.16198295e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.1319175]
Stock Price:  102.52211716806178
PL:  [-9.65403467]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.40604301e+00  3.56815309e-01]
 [ 1.14141731e+00  6.34817592e-02]
 [ 1.10341973e-01 -4.83895137e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.01271041e-01 -1.07800017e-01]
 [-3.78864403e-01  2.15106996e-01]
 [ 1.75382905e-01 -1.79465050e-01]
 [-6.13749962e-01  1.67897422e-01]
 [-1.18064656e-01 -9.79197003e-02]
 [ 5.40864498e-02 -1.28860871e-01]
 [-1.11314685e-01 -9.93490584e-04]
 [ 2.53422224e-02 -1.33580554e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-7.20695942e-02  4.89541300e-02]
 [ 4.69061164e-01  3.04559579e-01]
 [ 1.30452966e-01 -1.24440080e-01]
 [ 3.99851727e-02  1.25675168e-01]
 [-1.33456910e-03 -2.11005479e-02]
 [-1.13002008e-01 -4.63162715e-01]
 [-3.71474662e-02 -6.23087353e-02]
 [ 1.58882356e-01 -3.42063661e-02]
 [ 6.38067533e-01 -1.37539899e-01]
 [ 2.82120382e-02 -2.96070754e-01]
 [-2.73957514e-02  4.43829259e-02]
 [-2.94677757e-02  3.26131303e-02]
 [ 1.29699032e-01 -1.03493751e-01]
 [ 6.64794759e-02 -1.25425297e-01]
 [ 5.41851920e-02  2.43223330e-01]
 [ 3.21281395e-02  1.46209473e-01]
 [-5.45582967e-01 -1.15862014e-01]
 [-1.48013089e-01 -5.14770394e-02]
 [-9.55023400e-02  1.17251209e-01]
 [ 4.45893859e-01  2.25568532e-01]
 [ 4.60739708e-02 -3.82029104e-02]
 [ 2.61001854e-01 -2.30606545e-01]
 [ 9.95743884e-02  6.39949304e-02]
 [-6.52976507e-02  3.23073955e-01]
 [-3.59348804e-01 -1.36920709e-01]
 [ 1.08855126e-01  3.26014728e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.4435626]
curr_Stock_Price:  97.94967090430313
curr_Factors:  [9.79496709e+01 4.27519491e-02]
mat_Sqrt:  [[ 2.02526073e+01  0.00000000e+00]
 [-8.27061778e-03  1.89503660e-02]]
grads:  [ 0.07711451 18.82894023]
Stock Position:  0.0771145147067049
Bond Position:  [-18.99690394]


portfolio before change:  [-11.42974844]
curr_Stock_Price:  98.15960450775118
curr_Factors:  [9.81596045e+01 4.40015169e-02]
mat_Sqrt:  [[ 2.05904873e+01  0.00000000e+00]
 [-8.39061541e-03  1.92253151e-02]]
grads:  [0.05677976 3.30198797]
Stock Position:  0.05677976460137215
Bond Position:  [-17.00322767]


portfolio before change:  [-11.37047101]
curr_Stock_Price:  99.24102783967629
curr_Factors:  [9.92410278e+01 4.25183342e-02]
mat_Sqrt:  [[ 2.04634745e+01  0.00000000e+00]
 [-8.24798974e-03  1.88985187e-02]]
grads:  [ 0.00436011 -2.56049242]
Stock Position:  0.004360112838452697
Bond Position:  [-11.80317309]


portfolio before change:  [-11.36898448]
curr_Stock_Price:  99.92037251534427
curr_Factors:  [9.99203725e+01 4.25730910e-02]
mat_Sqrt:  [[ 2.06168180e+01  0.00000000e+00]
 [-8.25329908e-03  1.89106839e-02]]
grads:  [-7.90682975e-04 -8.00535895e+00]
Stock Position:  -0.000790682975101387
Bond Position:  [-11.28997914]


portfolio before change:  [-11.37124714]
curr_Stock_Price:  100.99706974486605
curr_Factors:  [1.0099707e+02 4.2233414e-02]
mat_Sqrt:  [[ 2.07556753e+01  0.00000000e+00]
 [-8.22030792e-03  1.88350916e-02]]
grads:  [-0.00714594 -5.72336035]
Stock Position:  -0.0071459407110162215
Bond Position:  [-10.64952807]


portfolio before change:  [-11.38261084]
curr_Stock_Price:  102.40100359472626
curr_Factors:  [1.02401004e+02 3.99600129e-02]
mat_Sqrt:  [[ 2.04699614e+01  0.00000000e+00]
 [-7.99600029e-03  1.83211383e-02]]
grads:  [-0.01392206 11.74091875]
Stock Position:  -0.01392205915577218
Bond Position:  [-9.95697801]


portfolio before change:  [-11.37239474]
curr_Stock_Price:  101.57779209286483
curr_Factors:  [1.01577792e+02 4.01500524e-02]
mat_Sqrt:  [[ 2.03536277e+01  0.00000000e+00]
 [-8.01499119e-03  1.83646519e-02]]
grads:  [ 4.76858166e-03 -9.77230884e+00]
Stock Position:  0.004768581655365607
Bond Position:  [-11.85677674]


portfolio before change:  [-11.36613209]
curr_Stock_Price:  103.20193211255403
curr_Factors:  [1.03201932e+02 4.02519480e-02]
mat_Sqrt:  [[ 2.07052882e+01  0.00000000e+00]
 [-8.02515525e-03  1.83879407e-02]]
grads:  [-0.02610316  9.13084423]
Stock Position:  -0.02610316337056544
Bond Position:  [-8.6722352]


portfolio before change:  [-11.33690035]
curr_Stock_Price:  102.04054667293559
curr_Factors:  [1.02040547e+02 3.96288886e-02]
mat_Sqrt:  [[ 2.03132177e+01  0.00000000e+00]
 [-7.96280238e-03  1.82450723e-02]]
grads:  [-0.00791604 -5.36691215]
Stock Position:  -0.007916043605555817
Bond Position:  [-10.52914294]


portfolio before change:  [-11.33200595]
curr_Stock_Price:  101.25598403121823
curr_Factors:  [1.01255984e+02 3.94949771e-02]
mat_Sqrt:  [[ 2.01229492e+01  0.00000000e+00]
 [-7.94933729e-03  1.82142199e-02]]
grads:  [-1.06994499e-04 -7.07474002e+00]
Stock Position:  -0.00010699449914944825
Bond Position:  [-11.32117211]


portfolio before change:  [-11.33324235]
curr_Stock_Price:  99.58460408224892
curr_Factors:  [9.95846041e+01 4.12196303e-02]
mat_Sqrt:  [[ 2.02182819e+01  0.00000000e+00]
 [-8.12104725e-03  1.86076569e-02]]
grads:  [-0.00552709 -0.05339149]
Stock Position:  -0.005527090801847601
Bond Position:  [-10.7828292]


portfolio before change:  [-11.33205921]
curr_Stock_Price:  99.12666338592884
curr_Factors:  [9.91266634e+01 4.21402204e-02]
mat_Sqrt:  [[ 2.03488040e+01  0.00000000e+00]
 [-8.21123332e-03  1.88142991e-02]]
grads:  [-1.61960923e-03 -7.09994846e+00]
Stock Position:  -0.0016196092342655038
Bond Position:  [-11.17151275]


portfolio before change:  [-11.33188237]
curr_Stock_Price:  98.15521526436366
curr_Factors:  [9.81552153e+01 4.21975191e-02]
mat_Sqrt:  [[ 2.01630784e+01  0.00000000e+00]
 [-8.21681389e-03  1.88270858e-02]]
grads:  [-0.00641514 -1.4899494 ]
Stock Position:  -0.00641513590134296
Bond Position:  [-10.70220333]


portfolio before change:  [-11.33614703]
curr_Stock_Price:  98.61144839057344
curr_Factors:  [9.86114484e+01 4.24888412e-02]
mat_Sqrt:  [[ 2.03266019e+01  0.00000000e+00]
 [-8.24512861e-03  1.88919630e-02]]
grads:  [-2.49447796e-03  2.59126752e+00]
Stock Position:  -0.002494477957110034
Bond Position:  [-11.09016294]


portfolio before change:  [-11.33442659]
curr_Stock_Price:  97.36598113405523
curr_Factors:  [9.73659811e+01 4.43195062e-02]
mat_Sqrt:  [[ 2.04976796e+01  0.00000000e+00]
 [-8.42087940e-03  1.92946586e-02]]
grads:  [ 0.02936829 15.78465752]
Stock Position:  0.02936829303131895
Bond Position:  [-14.19389926]


portfolio before change:  [-11.28099706]
curr_Stock_Price:  99.245691545018
curr_Factors:  [9.92456915e+01 4.35021064e-02]
mat_Sqrt:  [[ 2.06998313e+01  0.00000000e+00]
 [-8.34286344e-03  1.91159016e-02]]
grads:  [ 3.67842914e-03 -6.50976774e+00]
Stock Position:  0.003678429137158107
Bond Position:  [-11.6460653]


portfolio before change:  [-11.28813749]
curr_Stock_Price:  97.70030728487299
curr_Factors:  [9.77003073e+01 4.44151877e-02]
mat_Sqrt:  [[ 2.05902529e+01  0.00000000e+00]
 [-8.42996443e-03  1.93154751e-02]]
grads:  [4.60578668e-03 6.50644974e+00]
Stock Position:  0.0046057866845396304
Bond Position:  [-11.73812427]


portfolio before change:  [-11.28237321]
curr_Stock_Price:  99.27042730168438
curr_Factors:  [9.92704273e+01 4.43130419e-02]
mat_Sqrt:  [[ 2.08970833e+01  0.00000000e+00]
 [-8.42026526e-03  1.92932515e-02]]
grads:  [-5.04549035e-04 -1.09367506e+00]
Stock Position:  -0.0005045490350041303
Bond Position:  [-11.23228641]


portfolio before change:  [-11.28414933]
curr_Stock_Price:  100.00770350269507
curr_Factors:  [1.00007704e+02 4.48294682e-02]
mat_Sqrt:  [[ 2.11746016e+01  0.00000000e+00]
 [-8.46918823e-03  1.94053481e-02]]
grads:  [-1.48830563e-02 -2.38677871e+01]
Stock Position:  -0.01488305634563075
Bond Position:  [-9.79572904]


portfolio before change:  [-11.2974339]
curr_Stock_Price:  100.81802324744183
curr_Factors:  [1.00818023e+02 4.42007178e-02]
mat_Sqrt:  [[ 2.11959477e+01  0.00000000e+00]
 [-8.40958670e-03  1.92687838e-02]]
grads:  [-3.03554381e-03 -3.23366207e+00]
Stock Position:  -0.0030355438082278093
Bond Position:  [-10.99139638]


portfolio before change:  [-11.30338964]
curr_Stock_Price:  102.32738416851097
curr_Factors:  [1.02327384e+02 4.30367591e-02]
mat_Sqrt:  [[ 2.12281258e+01  0.00000000e+00]
 [-8.29812114e-03  1.90133841e-02]]
grads:  [ 0.00678126 -1.79906774]
Stock Position:  0.006781261591751651
Bond Position:  [-11.99729841]


portfolio before change:  [-11.31210363]
curr_Stock_Price:  101.26353699452592
curr_Factors:  [1.01263537e+02 4.29307566e-02]
mat_Sqrt:  [[ 2.09815401e+01  0.00000000e+00]
 [-8.28789543e-03  1.89899541e-02]]
grads:  [ 0.02754994 -7.24277156]
Stock Position:  0.027549941346763005
Bond Position:  [-14.10190813]


portfolio before change:  [-11.32622825]
curr_Stock_Price:  100.81483280185802
curr_Factors:  [1.00814833e+02 4.09014428e-02]
mat_Sqrt:  [[ 2.03888978e+01  0.00000000e+00]
 [-8.08964205e-03  1.85356985e-02]]
grads:  [-4.95386427e-03 -1.59730022e+01]
Stock Position:  -0.004953864272105489
Bond Position:  [-10.82680525]


portfolio before change:  [-11.32161278]
curr_Stock_Price:  99.60993354333372
curr_Factors:  [9.96099335e+01 4.03690491e-02]
mat_Sqrt:  [[ 2.00136781e+01  0.00000000e+00]
 [-8.03682018e-03  1.84146684e-02]]
grads:  [-4.00998481e-04  2.41019414e+00]
Stock Position:  -0.00040099848132562574
Bond Position:  [-11.28166935]


portfolio before change:  [-11.3227807]
curr_Stock_Price:  99.00550830879378
curr_Factors:  [9.90055083e+01 4.28719552e-02]
mat_Sqrt:  [[ 2.04996291e+01  0.00000000e+00]
 [-8.28221759e-03  1.89769445e-02]]
grads:  [-7.43147046e-04  1.71856593e+00]
Stock Position:  -0.0007431470455353899
Bond Position:  [-11.24920505]


portfolio before change:  [-11.32412586]
curr_Stock_Price:  98.9233236797633
curr_Factors:  [9.89233237e+01 4.38852041e-02]
mat_Sqrt:  [[ 2.07232450e+01  0.00000000e+00]
 [-8.37951827e-03  1.91998884e-02]]
grads:  [ 4.07902603e-03 -5.39033085e+00]
Stock Position:  0.004079026034946429
Bond Position:  [-11.72763668]


portfolio before change:  [-11.31914454]
curr_Stock_Price:  100.50393832323726
curr_Factors:  [1.00503938e+02 4.13172016e-02]
mat_Sqrt:  [[ 2.04290669e+01  0.00000000e+00]
 [-8.13065327e-03  1.86296670e-02]]
grads:  [ 5.74641449e-04 -6.73255709e+00]
Stock Position:  0.0005746414490105753
Bond Position:  [-11.37689827]


portfolio before change:  [-11.32036837]
curr_Stock_Price:  100.84914393302793
curr_Factors:  [1.00849144e+02 4.19517036e-02]
mat_Sqrt:  [[ 2.06560377e+01  0.00000000e+00]
 [-8.19284601e-03  1.87721685e-02]]
grads:  [7.76221259e-03 1.29565921e+01]
Stock Position:  0.007762212590165446
Bond Position:  [-12.10318087]


portfolio before change:  [-11.33037274]
curr_Stock_Price:  99.75520716491083
curr_Factors:  [9.97552072e+01 4.21581348e-02]
mat_Sqrt:  [[ 2.04821843e+01  0.00000000e+00]
 [-8.21297849e-03  1.88182978e-02]]
grads:  [4.68403096e-03 7.76953765e+00]
Stock Position:  0.00468403095628231
Bond Position:  [-11.79762921]


portfolio before change:  [-11.33624233]
curr_Stock_Price:  98.81695482796113
curr_Factors:  [9.88169548e+01 4.30750974e-02]
mat_Sqrt:  [[ 2.05090054e+01  0.00000000e+00]
 [-8.30181641e-03  1.90218511e-02]]
grads:  [-0.02906768 -6.09099574]
Stock Position:  -0.02906768429619974
Bond Position:  [-8.46386229]


portfolio before change:  [-11.29754141]
curr_Stock_Price:  97.44914805342138
curr_Factors:  [9.74491481e+01 4.29192652e-02]
mat_Sqrt:  [[ 2.01885062e+01  0.00000000e+00]
 [-8.28678613e-03  1.89874123e-02]]
grads:  [-0.00844438 -2.711114  ]
Stock Position:  -0.008444384612749897
Bond Position:  [-10.47464332]


portfolio before change:  [-11.27733368]
curr_Stock_Price:  94.9010480982348
curr_Factors:  [9.49010481e+01 4.24586510e-02]
mat_Sqrt:  [[ 1.95548327e+01  0.00000000e+00]
 [-8.24219883e-03  1.88852500e-02]]
grads:  [-2.26694433e-03  6.20861302e+00]
Stock Position:  -0.0022669443264280867
Bond Position:  [-11.06219829]


portfolio before change:  [-11.27619539]
curr_Stock_Price:  93.78890875957126
curr_Factors:  [9.37889088e+01 4.19941084e-02]
mat_Sqrt:  [[ 1.92196584e+01  0.00000000e+00]
 [-8.19698563e-03  1.87816536e-02]]
grads:  [ 0.02832205 12.01004648]
Stock Position:  0.028322045322796936
Bond Position:  [-13.93248911]


portfolio before change:  [-11.27295949]
curr_Stock_Price:  93.9646575572766
curr_Factors:  [9.39646576e+01 4.17547117e-02]
mat_Sqrt:  [[ 1.92007096e+01  0.00000000e+00]
 [-8.17358787e-03  1.87280426e-02]]
grads:  [ 1.53123787e-03 -2.03987738e+00]
Stock Position:  0.0015312378737655033
Bond Position:  [-11.41684173]


portfolio before change:  [-11.27473467]
curr_Stock_Price:  93.73739989001105
curr_Factors:  [9.37373999e+01 4.30225410e-02]
mat_Sqrt:  [[ 1.94428950e+01  0.00000000e+00]
 [-8.29675031e-03  1.90102431e-02]]
grads:  [ 8.24758381e-03 -1.21306468e+01]
Stock Position:  0.008247583811046387
Bond Position:  [-12.04784173]


portfolio before change:  [-11.281731]
curr_Stock_Price:  93.07172003076597
curr_Factors:  [9.30717200e+01 4.40117802e-02]
mat_Sqrt:  [[ 1.95255020e+01  0.00000000e+00]
 [-8.39159391e-03  1.92275571e-02]]
grads:  [0.00653013 3.3282923 ]
Stock Position:  0.006530129979698611
Bond Position:  [-11.88950143]


portfolio before change:  [-11.28393994]
curr_Stock_Price:  92.96105481845889
curr_Factors:  [9.29610548e+01 4.31918463e-02]
mat_Sqrt:  [[ 1.93197689e+01  0.00000000e+00]
 [-8.31305925e-03  1.90476116e-02]]
grads:  [3.91844144e-03 1.69613893e+01]
Stock Position:  0.003918441441789904
Bond Position:  [-11.64820239]


portfolio before change:  [-11.28367202]
curr_Stock_Price:  93.40103476719104
curr_Factors:  [9.34010348e+01 4.43231655e-02]
mat_Sqrt:  [[ 1.96637830e+01  0.00000000e+00]
 [-8.42122703e-03  1.92954552e-02]]
grads:  [-0.02131359 -7.09600824]
Stock Position:  -0.021313594713180607
Bond Position:  [-9.29296022]


portfolio before change:  [-11.29109187]
curr_Stock_Price:  93.69465753304277
curr_Factors:  [9.36946575e+01 4.40508294e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.29109187]
Stock Price:  95.90221632107577
PL:  [-11.29109187]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.14956611e+00  2.88795081e-01]
 [-2.40953285e-01 -9.02297585e-02]
 [-7.46020388e-02 -7.66422794e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.14113659e-01 -2.95964235e-01]
 [-3.82421940e-01  2.32239822e-01]
 [ 3.77746233e-01 -4.48010056e-01]
 [-6.98796191e-01  5.26173209e-02]
 [-1.05982460e-01 -7.43360934e-02]
 [-3.50517380e-01 -5.81930807e-01]
 [-7.45302814e-02 -1.16035247e-02]
 [-1.17498536e-01 -1.73355310e-01]
 [-4.32219700e-02 -3.83966712e-02]
 [ 2.25039814e-02 -1.93129461e-01]
 [-1.71662277e-01 -1.23077922e-01]
 [ 8.08475719e-02 -1.19228272e+00]
 [ 1.34696292e-02 -3.98360670e-01]
 [ 4.63789844e-02 -1.75793799e-01]
 [-9.68717493e-02 -6.99145578e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 8.65430055e-02 -1.08195583e-02]
 [ 2.87909436e-01 -4.75768289e-01]
 [ 2.73746176e-02 -3.49219153e-01]
 [ 9.68492917e-03  1.62175930e-01]
 [ 5.07986168e-01 -6.11191357e-01]
 [-6.93645536e-01  1.07222565e-01]
 [-1.25044582e-01  1.90342878e-01]
 [-1.24069658e-01 -2.27957818e-01]
 [-7.22028538e-02  2.10154435e-01]
 [-7.06655179e-01 -3.39428459e-02]
 [-1.25461480e-01  7.23260532e-03]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.13400247e-01 -8.39719315e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.00875298e-01 -7.76143157e-02]
 [-3.08118886e-02 -1.46004869e-01]
 [ 1.00508254e-02 -6.33811063e-02]
 [ 2.14934360e-01 -1.70241275e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.01006151]
curr_Stock_Price:  100.77346103496198
curr_Factors:  [1.00773461e+02 4.03180854e-02]
mat_Sqrt:  [[ 2.02346699e+01  0.00000000e+00]
 [-8.03174555e-03  1.84030410e-02]]
grads:  [ 0.06304064 15.69279126]
Stock Position:  0.06304064367306669
Bond Position:  [1.65723766]


portfolio before change:  [8.0646565]
curr_Stock_Price:  101.63620321473984
curr_Factors:  [1.01636203e+02 3.97626023e-02]
mat_Sqrt:  [[ 2.02668304e+01  0.00000000e+00]
 [-7.97622490e-03  1.82758272e-02]]
grads:  [-0.0138321  -4.93710942]
Stock Position:  -0.013832097784482968
Bond Position:  [9.4704984]


portfolio before change:  [8.07118173]
curr_Stock_Price:  101.25004753577323
curr_Factors:  [1.01250048e+02 3.90204762e-02]
mat_Sqrt:  [[ 2.00005306e+01  0.00000000e+00]
 [-7.90144049e-03  1.81044746e-02]]
grads:  [-0.00540243 -4.23333354]
Stock Position:  -0.005402430257419517
Bond Position:  [8.61817805]


portfolio before change:  [8.07297399]
curr_Stock_Price:  101.11771392153858
curr_Factors:  [1.01117714e+02 3.86492590e-02]
mat_Sqrt:  [[ 1.98791508e+01  0.00000000e+00]
 [-7.86376591e-03  1.80181513e-02]]
grads:  [-8.20023306e-04 -8.40190595e+00]
Stock Position:  -0.0008200233058364854
Bond Position:  [8.15589288]


portfolio before change:  [8.07349305]
curr_Stock_Price:  101.72806092997072
curr_Factors:  [1.01728061e+02 3.85121209e-02]
mat_Sqrt:  [[ 1.99636287e+01  0.00000000e+00]
 [-7.84980212e-03  1.79861562e-02]]
grads:  [-1.21863137e-02 -1.64551131e+01]
Stock Position:  -0.012186313664016225
Bond Position:  [9.3131831]


portfolio before change:  [8.04648356]
curr_Stock_Price:  104.03997508687542
curr_Factors:  [1.04039975e+02 3.76288712e-02]
mat_Sqrt:  [[ 2.01818435e+01  0.00000000e+00]
 [-7.75926504e-03  1.77787097e-02]]
grads:  [-0.01392659 13.06280524]
Stock Position:  -0.013926585599848208
Bond Position:  [9.49540517]


portfolio before change:  [8.04462437]
curr_Stock_Price:  104.25870672599106
curr_Factors:  [1.04258707e+02 3.84367084e-02]
mat_Sqrt:  [[ 2.04402135e+01  0.00000000e+00]
 [-7.84211281e-03  1.79685378e-02]]
grads:  [ 8.91471192e-03 -2.49330280e+01]
Stock Position:  0.00891471192169795
Bond Position:  [7.11518803]


portfolio before change:  [8.04602152]
curr_Stock_Price:  104.31565673461853
curr_Factors:  [1.04315657e+02 3.86364390e-02]
mat_Sqrt:  [[ 2.05044461e+01  0.00000000e+00]
 [-7.86246160e-03  1.80151627e-02]]
grads:  [-0.03296027  2.92072416]
Stock Position:  -0.03296027144326219
Bond Position:  [11.48429388]


portfolio before change:  [8.05402274]
curr_Stock_Price:  104.1164595892693
curr_Factors:  [1.04116460e+02 4.08147392e-02]
mat_Sqrt:  [[ 2.10342923e+01  0.00000000e+00]
 [-8.08106322e-03  1.85160420e-02]]
grads:  [-0.00658094 -4.01468595]
Stock Position:  -0.006580938835868269
Bond Position:  [8.73920679]


portfolio before change:  [8.05706805]
curr_Stock_Price:  103.81971748848146
curr_Factors:  [1.03819717e+02 4.10151112e-02]
mat_Sqrt:  [[ 2.10257642e+01  0.00000000e+00]
 [-8.10087513e-03  1.85614367e-02]]
grads:  [-2.87500992e-02 -3.13516036e+01]
Stock Position:  -0.02875009921208114
Bond Position:  [11.04189522]


portfolio before change:  [8.07825124]
curr_Stock_Price:  103.13092424728684
curr_Factors:  [1.03130924e+02 3.96729270e-02]
mat_Sqrt:  [[ 2.05416834e+01  0.00000000e+00]
 [-7.96722556e-03  1.82552071e-02]]
grads:  [-0.00387478 -0.63562821]
Stock Position:  -0.0038747785764499513
Bond Position:  [8.47786074]


portfolio before change:  [8.07782401]
curr_Stock_Price:  103.51469577873338
curr_Factors:  [1.03514696e+02 3.89085222e-02]
mat_Sqrt:  [[ 2.04185256e+01  0.00000000e+00]
 [-7.89009731e-03  1.80784841e-02]]
grads:  [-9.45988953e-03 -9.58904016e+00]
Stock Position:  -0.009459889531584782
Bond Position:  [9.0570616]


portfolio before change:  [8.06462263]
curr_Stock_Price:  105.02989171522239
curr_Factors:  [1.05029892e+02 3.89736577e-02]
mat_Sqrt:  [[ 2.07347356e+01  0.00000000e+00]
 [-7.89669882e-03  1.80936100e-02]]
grads:  [-0.00289271 -2.12211223]
Stock Position:  -0.0028927135821141046
Bond Position:  [8.36844402]


portfolio before change:  [8.06278021]
curr_Stock_Price:  106.02845010133657
curr_Factors:  [1.06028450e+02 3.91751765e-02]
mat_Sqrt:  [[ 2.09859142e+01  0.00000000e+00]
 [-7.91708800e-03  1.81403275e-02]]
grads:  [-2.94409978e-03 -1.06464153e+01]
Stock Position:  -0.00294409978394286
Bond Position:  [8.37493854]


portfolio before change:  [8.06171134]
curr_Stock_Price:  106.74710632960299
curr_Factors:  [1.06747106e+02 3.84066079e-02]
mat_Sqrt:  [[ 2.09198751e+01  0.00000000e+00]
 [-7.83904157e-03  1.79615007e-02]]
grads:  [-0.01077339 -6.85231842]
Stock Position:  -0.010773385825278115
Bond Position:  [9.21173911]


portfolio before change:  [8.05385099]
curr_Stock_Price:  107.58360206764986
curr_Factors:  [1.07583602e+02 3.73281033e-02]
mat_Sqrt:  [[ 2.07856707e+01  0.00000000e+00]
 [-7.72819288e-03  1.77075144e-02]]
grads:  [-2.11447238e-02 -6.73320200e+01]
Stock Position:  -0.021144723791169804
Bond Position:  [10.32867654]


portfolio before change:  [8.07108959]
curr_Stock_Price:  106.82939799079827
curr_Factors:  [1.06829398e+02 3.72749352e-02]
mat_Sqrt:  [[ 2.06252504e+01  0.00000000e+00]
 [-7.72268711e-03  1.76948991e-02]]
grads:  [-7.77635266e-03 -2.25127404e+01]
Stock Position:  -0.007776352657998135
Bond Position:  [8.90183267]


portfolio before change:  [8.072124]
curr_Stock_Price:  106.8394786888435
curr_Factors:  [1.06839479e+02 3.69308870e-02]
mat_Sqrt:  [[ 2.05317813e+01  0.00000000e+00]
 [-7.68696424e-03  1.76130477e-02]]
grads:  [-1.47789024e-03 -9.98088469e+00]
Stock Position:  -0.0014778902409568204
Bond Position:  [8.23002103]


portfolio before change:  [8.07215704]
curr_Stock_Price:  107.51326037330112
curr_Factors:  [1.07513260e+02 3.72332448e-02]
mat_Sqrt:  [[ 2.07456705e+01  0.00000000e+00]
 [-7.71836716e-03  1.76850009e-02]]
grads:  [-0.00614032 -3.9533251 ]
Stock Position:  -0.006140315600006836
Bond Position:  [8.73232239]


portfolio before change:  [8.08023182]
curr_Stock_Price:  106.37599534415051
curr_Factors:  [1.06375995e+02 3.61869974e-02]
mat_Sqrt:  [[ 2.02357782e+01  0.00000000e+00]
 [-7.60915211e-03  1.74347578e-02]]
grads:  [-2.39482117e-04 -6.25723573e+00]
Stock Position:  -0.0002394821167505117
Bond Position:  [8.10570697]


portfolio before change:  [8.08105502]
curr_Stock_Price:  107.16970897271224
curr_Factors:  [1.07169709e+02 3.53294878e-02]
mat_Sqrt:  [[ 2.01437685e+01  0.00000000e+00]
 [-7.51845599e-03  1.72269468e-02]]
grads:  [ 0.00406185 -0.62806012]
Stock Position:  0.004061849851380444
Bond Position:  [7.64574775]


portfolio before change:  [8.08014329]
curr_Stock_Price:  106.70994340912308
curr_Factors:  [1.06709943e+02 3.61173795e-02]
mat_Sqrt:  [[ 2.02797691e+01  0.00000000e+00]
 [-7.60182920e-03  1.74179789e-02]]
grads:  [ 3.95799041e-03 -2.73147816e+01]
Stock Position:  0.003957990406041801
Bond Position:  [7.65778636]


portfolio before change:  [8.08585212]
curr_Stock_Price:  107.91043703780457
curr_Factors:  [1.07910437e+02 3.60397924e-02]
mat_Sqrt:  [[ 2.04858784e+01  0.00000000e+00]
 [-7.59365971e-03  1.73992602e-02]]
grads:  [-6.10357599e-03 -2.00709196e+01]
Stock Position:  -0.006103575992523413
Bond Position:  [8.74449167]


portfolio before change:  [8.08984885]
curr_Stock_Price:  107.43471599697641
curr_Factors:  [1.07434716e+02 3.65023783e-02]
mat_Sqrt:  [[ 2.05260424e+01  0.00000000e+00]
 [-7.64223823e-03  1.75105676e-02]]
grads:  [3.92010824e-03 9.26160326e+00]
Stock Position:  0.003920108237190531
Bond Position:  [7.66869313]


portfolio before change:  [8.09882316]
curr_Stock_Price:  109.47947090520702
curr_Factors:  [1.09479471e+02 3.52998785e-02]
mat_Sqrt:  [[ 2.05692897e+01  0.00000000e+00]
 [-7.51530476e-03  1.72197265e-02]]
grads:  [ 1.17281828e-02 -3.54936740e+01]
Stock Position:  0.011728182847724372
Bond Position:  [6.8148279]


portfolio before change:  [8.08935771]
curr_Stock_Price:  108.5997645113365
curr_Factors:  [1.08599765e+02 3.53848627e-02]
mat_Sqrt:  [[ 2.04285547e+01  0.00000000e+00]
 [-7.52434584e-03  1.72404422e-02]]
grads:  [-0.031664    6.21924678]
Stock Position:  -0.03166400084220274
Bond Position:  [11.52806074]


portfolio before change:  [8.14704795]
curr_Stock_Price:  106.82332615966982
curr_Factors:  [1.06823326e+02 3.42249385e-02]
mat_Sqrt:  [[ 1.97622976e+01  0.00000000e+00]
 [-7.39999336e-03  1.69555148e-02]]
grads:  [-2.12384918e-03  1.12260158e+01]
Stock Position:  -0.0021238491809977534
Bond Position:  [8.37392458]


portfolio before change:  [8.14788245]
curr_Stock_Price:  106.92328724016052
curr_Factors:  [1.06923287e+02 3.35626776e-02]
mat_Sqrt:  [[ 1.95884739e+01  0.00000000e+00]
 [-7.32804777e-03  1.67906668e-02]]
grads:  [-1.14127628e-02 -1.35764601e+01]
Stock Position:  -0.011412762797420341
Bond Position:  [9.36817257]


portfolio before change:  [8.17106293]
curr_Stock_Price:  104.99479885854525
curr_Factors:  [1.04994799e+02 3.35128155e-02]
mat_Sqrt:  [[ 1.92208790e+01  0.00000000e+00]
 [-7.32260233e-03  1.67781897e-02]]
grads:  [1.01535737e-03 1.25254535e+01]
Stock Position:  0.0010153573666473543
Bond Position:  [8.06445569]


portfolio before change:  [8.17091493]
curr_Stock_Price:  103.85616592266372
curr_Factors:  [1.03856166e+02 3.41693710e-02]
mat_Sqrt:  [[ 1.91977697e+01  0.00000000e+00]
 [-7.39398361e-03  1.69417448e-02]]
grads:  [-0.03758088 -2.00350356]
Stock Position:  -0.03758087850121929
Bond Position:  [12.07392088]


portfolio before change:  [8.09003386]
curr_Stock_Price:  106.04851486951539
curr_Factors:  [1.06048515e+02 3.39299320e-02]
mat_Sqrt:  [[ 1.95342205e+01  0.00000000e+00]
 [-7.36803170e-03  1.68822815e-02]]
grads:  [-0.00626106  0.42841397]
Stock Position:  -0.0062610592846453015
Bond Position:  [8.7540099]


portfolio before change:  [8.09096634]
curr_Stock_Price:  106.07436435300104
curr_Factors:  [1.06074364e+02 3.30230583e-02]
mat_Sqrt:  [[ 1.92760961e+01  0.00000000e+00]
 [-7.26889904e-03  1.66551400e-02]]
grads:  [ 0.00376334 -0.71732745]
Stock Position:  0.0037633448329573173
Bond Position:  [7.69177193]


portfolio before change:  [8.09513711]
curr_Stock_Price:  106.92712694430877
curr_Factors:  [1.06927127e+02 3.35847962e-02]
mat_Sqrt:  [[ 1.95956312e+01  0.00000000e+00]
 [-7.33046206e-03  1.67961986e-02]]
grads:  [-0.01276043 -4.9994605 ]
Stock Position:  -0.012760426033709488
Bond Position:  [9.4595728]


portfolio before change:  [8.1085874]
curr_Stock_Price:  105.96573489813917
curr_Factors:  [1.05965735e+02 3.52676555e-02]
mat_Sqrt:  [[ 1.99000308e+01  0.00000000e+00]
 [-7.51187386e-03  1.72118653e-02]]
grads:  [0.00509905 3.09955138]
Stock Position:  0.005099045950114473
Bond Position:  [7.56826325]


portfolio before change:  [8.10597633]
curr_Stock_Price:  105.26812151579571
curr_Factors:  [1.05268122e+02 3.56169277e-02]
mat_Sqrt:  [[ 1.98666710e+01  0.00000000e+00]
 [-7.54897903e-03  1.72968839e-02]]
grads:  [-0.00476515  4.70172238]
Stock Position:  -0.004765147143474991
Bond Position:  [8.60759442]


portfolio before change:  [8.09838284]
curr_Stock_Price:  107.08747894113067
curr_Factors:  [1.07087479e+02 3.39700710e-02]
mat_Sqrt:  [[ 1.97372627e+01  0.00000000e+00]
 [-7.37238859e-03  1.68922644e-02]]
grads:  [-0.02202681 -4.59466617]
Stock Position:  -0.022026811382832794
Bond Position:  [10.45717854]


portfolio before change:  [8.09160545]
curr_Stock_Price:  107.45451444537741
curr_Factors:  [1.07454514e+02 3.53797042e-02]
mat_Sqrt:  [[ 2.02116498e+01  0.00000000e+00]
 [-7.52379736e-03  1.72391855e-02]]
grads:  [-4.67718561e-03 -8.46936009e+00]
Stock Position:  -0.00467718561439415
Bond Position:  [8.59419016]


portfolio before change:  [8.08494401]
curr_Stock_Price:  109.10845280038023
curr_Factors:  [1.09108453e+02 3.37111393e-02]
mat_Sqrt:  [[ 2.00329595e+01  0.00000000e+00]
 [-7.34423739e-03  1.68277619e-02]]
grads:  [-8.79099128e-04 -3.76646085e+00]
Stock Position:  -0.0008790991279280674
Bond Position:  [8.18086116]


portfolio before change:  [8.08731018]
curr_Stock_Price:  107.58018765910904
curr_Factors:  [1.07580188e+02 3.26794544e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.08731018]
Stock Price:  107.75317521666814
PL:  [0.33413496]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.34226903e+00  3.32361348e-01]
 [ 1.11754322e+00  6.67678393e-02]
 [ 9.19146027e-02 -2.38950085e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.11686139e-01  8.88198027e-01]
 [ 4.46777196e-02  9.34577340e-03]
 [ 8.74161999e-02  9.61368871e-02]
 [ 9.39073186e-01  9.44021906e-01]
 [ 1.35644611e-04  3.32723204e-01]
 [ 1.54263045e-01  3.70610942e-02]
 [ 1.96993583e-02  1.83539465e-02]
 [ 5.08532817e-02 -8.29702685e-02]
 [ 1.13305662e-03  4.31090611e-01]
 [-1.67007226e-01  5.82760271e-01]
 [-1.59708205e-01  2.54808291e-02]
 [ 1.28353429e-01 -1.81427627e-01]
 [ 3.49200324e-02 -1.61792452e-01]
 [ 4.64010423e-01  5.94844191e-02]
 [ 5.06421583e-01  5.20887143e-01]
 [-8.95291550e-01  4.45035950e-01]
 [-2.35250493e-02  1.92431019e-01]
 [ 1.45909955e+00  1.64728481e-01]
 [ 1.58101376e-02  4.40924076e-01]
 [-1.45508995e-01  1.60645555e-01]
 [-1.98037882e-01  1.25380895e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 8.85979678e-03 -4.56071892e-01]
 [ 7.27242595e-02  4.74309263e-02]
 [ 5.06870433e-01 -3.01838757e-01]
 [-5.24022775e-01 -2.14517491e-01]
 [-3.52690313e-02 -9.93710222e-03]
 [-9.01030647e-02  1.07966172e-01]
 [ 4.61262990e-01  2.26924385e-01]
 [ 5.06255728e-02 -6.43357961e-02]
 [ 2.75836782e-01 -3.23082186e-01]
 [ 1.22573022e-01  3.49791634e-02]
 [-7.12425667e-02  4.18590456e-01]
 [-3.71795112e-01 -1.39872866e-01]
 [ 1.58550413e-02  4.18853240e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.21672824]
curr_Stock_Price:  99.932529945215
curr_Factors:  [9.99325299e+01 3.95796290e-02]
mat_Sqrt:  [[ 1.98812068e+01  0.00000000e+00]
 [-7.95785187e-03  1.82337293e-02]]
grads:  [ 0.07481052 18.22783169]
Stock Position:  0.07481051971440746
Bond Position:  [-5.25927626]


portfolio before change:  [2.08997639]
curr_Stock_Price:  98.24701308415254
curr_Factors:  [9.82470131e+01 4.02774123e-02]
mat_Sqrt:  [[ 1.97174222e+01  0.00000000e+00]
 [-8.02769329e-03  1.83937561e-02]]
grads:  [0.05815583 3.6299187 ]
Stock Position:  0.05815583199195667
Bond Position:  [-3.62366039]


portfolio before change:  [2.11233028]
curr_Stock_Price:  98.63918127457575
curr_Factors:  [9.86391813e+01 3.85589324e-02]
mat_Sqrt:  [[ 1.93692123e+01  0.00000000e+00]
 [-7.85457140e-03  1.79970840e-02]]
grads:  [ 0.00420698 -1.32771556]
Stock Position:  0.0042069839933777334
Bond Position:  [1.69735682]


portfolio before change:  [2.10692464]
curr_Stock_Price:  97.30382494157013
curr_Factors:  [9.73038249e+01 3.81322746e-02]
mat_Sqrt:  [[ 1.90009917e+01  0.00000000e+00]
 [-7.81099477e-03  1.78972374e-02]]
grads:  [-8.57921903e-04 -8.45866929e+00]
Stock Position:  -0.0008579219030111053
Bond Position:  [2.19040372]


portfolio before change:  [2.10713119]
curr_Stock_Price:  97.38222231791113
curr_Factors:  [9.73822223e+01 3.79585387e-02]
mat_Sqrt:  [[ 1.89729308e+01  0.00000000e+00]
 [-7.79318047e-03  1.78564197e-02]]
grads:  [1.45446828e-02 4.97411039e+01]
Stock Position:  0.014544682773997187
Bond Position:  [0.69073766]


portfolio before change:  [2.08791939]
curr_Stock_Price:  96.05540411807716
curr_Factors:  [9.60554041e+01 3.82016581e-02]
mat_Sqrt:  [[ 1.87742636e+01  0.00000000e+00]
 [-7.81809779e-03  1.79135125e-02]]
grads:  [0.00259699 0.52171641]
Stock Position:  0.0025969886543600064
Bond Position:  [1.8384646]


portfolio before change:  [2.09131257]
curr_Stock_Price:  97.27348906100615
curr_Factors:  [9.72734891e+01 3.80264101e-02]
mat_Sqrt:  [[ 1.89686821e+01  0.00000000e+00]
 [-7.80014463e-03  1.78723766e-02]]
grads:  [0.00682039 5.37907684]
Stock Position:  0.006820388295252946
Bond Position:  [1.4278696]


portfolio before change:  [2.09086653]
curr_Stock_Price:  97.18192045770617
curr_Factors:  [9.71819205e+01 3.97531977e-02]
mat_Sqrt:  [[ 1.93763295e+01  0.00000000e+00]
 [-7.97528158e-03  1.82736658e-02]]
grads:  [ 0.06972828 51.66023708]
Stock Position:  0.06972827970946803
Bond Position:  [-4.6854616]


portfolio before change:  [2.14163084]
curr_Stock_Price:  97.91835095560484
curr_Factors:  [9.79183510e+01 4.03954264e-02]
mat_Sqrt:  [[ 1.96802309e+01  0.00000000e+00]
 [-8.03944539e-03  1.84206835e-02]]
grads:  [7.38548020e-03 1.80624787e+01]
Stock Position:  0.007385480202044027
Bond Position:  [1.4184568]


portfolio before change:  [2.12905147]
curr_Stock_Price:  96.19108551783042
curr_Factors:  [9.61910855e+01 3.97888173e-02]
mat_Sqrt:  [[ 1.91873652e+01  0.00000000e+00]
 [-7.97885378e-03  1.82818507e-02]]
grads:  [0.00888282 2.02720692]
Stock Position:  0.00888281589337612
Bond Position:  [1.27460377]


portfolio before change:  [2.11959073]
curr_Stock_Price:  95.10808695525124
curr_Factors:  [9.51080870e+01 3.98478505e-02]
mat_Sqrt:  [[ 1.89854063e+01  0.00000000e+00]
 [-7.98477056e-03  1.82954077e-02]]
grads:  [0.00145953 1.00319964]
Stock Position:  0.0014595251120447681
Bond Position:  [1.98077809]


portfolio before change:  [2.1184122]
curr_Stock_Price:  94.13095598380706
curr_Factors:  [9.41309560e+01 4.06232778e-02]
mat_Sqrt:  [[ 1.89722986e+01  0.00000000e+00]
 [-8.06208686e-03  1.84725616e-02]]
grads:  [ 7.71761402e-04 -4.49154103e+00]
Stock Position:  0.0007717614024557395
Bond Position:  [2.04576556]


portfolio before change:  [2.11733756]
curr_Stock_Price:  92.40713249165572
curr_Factors:  [9.24071325e+01 4.11933050e-02]
mat_Sqrt:  [[ 1.87550753e+01  0.00000000e+00]
 [-8.11845354e-03  1.86017139e-02]]
grads:  [1.00920109e-02 2.31747790e+01]
Stock Position:  0.010092010861125477
Bond Position:  [1.18476377]


portfolio before change:  [2.11032358]
curr_Stock_Price:  91.69745411485765
curr_Factors:  [9.16974541e+01 4.09043536e-02]
mat_Sqrt:  [[ 1.85456494e+01  0.00000000e+00]
 [-8.08992989e-03  1.85363581e-02]]
grads:  [4.70893231e-03 3.14387685e+01]
Stock Position:  0.004708932311495861
Bond Position:  [1.67852647]


portfolio before change:  [2.10584279]
curr_Stock_Price:  90.70134268239826
curr_Factors:  [9.07013427e+01 4.18154943e-02]
mat_Sqrt:  [[ 1.85473699e+01  0.00000000e+00]
 [-8.17953489e-03  1.87416689e-02]]
grads:  [-0.00801124  1.35958165]
Stock Position:  -0.008011241470666834
Bond Position:  [2.83247314]


portfolio before change:  [2.10976805]
curr_Stock_Price:  90.2555714518957
curr_Factors:  [9.02555715e+01 4.15883888e-02]
mat_Sqrt:  [[ 1.84060276e+01  0.00000000e+00]
 [-8.15729257e-03  1.86907053e-02]]
grads:  [ 2.67151188e-03 -9.70683683e+00]
Stock Position:  0.0026715118823887165
Bond Position:  [1.86864922]


portfolio before change:  [2.11160227]
curr_Stock_Price:  90.85471742279991
curr_Factors:  [9.08547174e+01 4.13485490e-02]
mat_Sqrt:  [[ 1.84747095e+01  0.00000000e+00]
 [-8.13373705e-03  1.86367329e-02]]
grads:  [-1.93193742e-03 -8.68137422e+00]
Stock Position:  -0.0019319374244378049
Bond Position:  [2.2871279]


portfolio before change:  [2.11232861]
curr_Stock_Price:  90.62674288953563
curr_Factors:  [9.06267429e+01 4.07212132e-02]
mat_Sqrt:  [[ 1.82880216e+01  0.00000000e+00]
 [-8.07179912e-03  1.84948152e-02]]
grads:  [0.02679194 3.21627539]
Stock Position:  0.026791938587794027
Bond Position:  [-0.31573752]


portfolio before change:  [2.12757087]
curr_Stock_Price:  91.19712841834745
curr_Factors:  [9.11971284e+01 4.13941952e-02]
mat_Sqrt:  [[ 1.85545696e+01  0.00000000e+00]
 [-8.13822538e-03  1.86470169e-02]]
grads:  [ 0.0395458  27.93407362]
Stock Position:  0.03954580379849385
Bond Position:  [-1.47889287]


portfolio before change:  [2.12912634]
curr_Stock_Price:  91.24113662377817
curr_Factors:  [9.12411366e+01 4.36408970e-02]
mat_Sqrt:  [[ 1.90606418e+01  0.00000000e+00]
 [-8.35616151e-03  1.91463713e-02]]
grads:  [-0.0367806  23.24387961]
Stock Position:  -0.036780604951609765
Bond Position:  [5.48503054]


portfolio before change:  [2.05132174]
curr_Stock_Price:  93.37514914533665
curr_Factors:  [9.33751491e+01 4.20752323e-02]
mat_Sqrt:  [[ 1.91533423e+01  0.00000000e+00]
 [-8.20489925e-03  1.87997859e-02]]
grads:  [3.15656306e-03 1.02358091e+01]
Stock Position:  0.0031565630589557346
Bond Position:  [1.7565772]


portfolio before change:  [2.05828721]
curr_Stock_Price:  95.51224779231843
curr_Factors:  [9.55122478e+01 3.95108646e-02]
mat_Sqrt:  [[ 1.89852942e+01  0.00000000e+00]
 [-7.95093600e-03  1.82178830e-02]]
grads:  [0.08064099 9.04213076]
Stock Position:  0.08064099182194846
Bond Position:  [-5.64391518]


portfolio before change:  [2.01958319]
curr_Stock_Price:  95.04104213397451
curr_Factors:  [9.50410421e+01 3.98078256e-02]
mat_Sqrt:  [[ 1.89624923e+01  0.00000000e+00]
 [-7.98075943e-03  1.82862171e-02]]
grads:  [1.09819520e-02 2.41123724e+01]
Stock Position:  0.010981952020201401
Bond Position:  [0.97584702]


portfolio before change:  [2.0146617]
curr_Stock_Price:  94.58179044762089
curr_Factors:  [9.45817904e+01 4.06315473e-02]
mat_Sqrt:  [[ 1.90651055e+01  0.00000000e+00]
 [-8.06290740e-03  1.84744417e-02]]
grads:  [-3.95473958e-03  8.69555665e+00]
Stock Position:  -0.003954739581599091
Bond Position:  [2.38870805]


portfolio before change:  [2.01395053]
curr_Stock_Price:  94.83712202019976
curr_Factors:  [9.48371220e+01 4.06293802e-02]
mat_Sqrt:  [[ 1.91160635e+01  0.00000000e+00]
 [-8.06269237e-03  1.84739491e-02]]
grads:  [-0.00749721  6.78690272]
Stock Position:  -0.007497211576017398
Bond Position:  [2.7249645]


portfolio before change:  [2.01612325]
curr_Stock_Price:  94.59275454600174
curr_Factors:  [9.45927545e+01 4.13314197e-02]
mat_Sqrt:  [[ 1.92308302e+01  0.00000000e+00]
 [-8.13205211e-03  1.86328722e-02]]
grads:  [ 0.00954086 -3.91756765]
Stock Position:  0.009540857078110743
Bond Position:  [1.1136273]


portfolio before change:  [2.01861786]
curr_Stock_Price:  94.83962879301039
curr_Factors:  [9.48396288e+01 4.09664235e-02]
mat_Sqrt:  [[ 1.91956963e+01  0.00000000e+00]
 [-8.09606556e-03  1.85504166e-02]]
grads:  [-9.90775704e-03 -2.45855336e+01]
Stock Position:  -0.009907757036550693
Bond Position:  [2.95826585]


portfolio before change:  [2.012744]
curr_Stock_Price:  95.46980806231218
curr_Factors:  [9.54698081e+01 4.01947292e-02]
mat_Sqrt:  [[ 1.91403821e+01  0.00000000e+00]
 [-8.01944928e-03  1.83748667e-02]]
grads:  [0.00488103 2.58129363]
Stock Position:  0.004881031754692413
Bond Position:  [1.54675283]


portfolio before change:  [2.00779153]
curr_Stock_Price:  94.41555866002932
curr_Factors:  [9.44155587e+01 4.12537458e-02]
mat_Sqrt:  [[ 1.91767612e+01  0.00000000e+00]
 [-8.12440725e-03  1.86153556e-02]]
grads:  [  0.01956207 -16.21450397]
Stock Position:  0.019562072796224954
Bond Position:  [0.1608275]


portfolio before change:  [2.04125701]
curr_Stock_Price:  96.12526381157886
curr_Factors:  [9.61252638e+01 4.06025451e-02]
mat_Sqrt:  [[ 1.93693110e+01  0.00000000e+00]
 [-8.06002929e-03  1.84678472e-02]]
grads:  [ -0.03188786 -11.61572808]
Stock Position:  -0.031887860247499296
Bond Position:  [5.10648599]


portfolio before change:  [2.03066811]
curr_Stock_Price:  96.47734940861761
curr_Factors:  [9.64773494e+01 3.97533548e-02]
mat_Sqrt:  [[ 1.92358887e+01  0.00000000e+00]
 [-7.97529734e-03  1.82737019e-02]]
grads:  [-0.00205896 -0.54379251]
Stock Position:  -0.002058960666767406
Bond Position:  [2.22931117]


portfolio before change:  [2.03383007]
curr_Stock_Price:  95.07699016697302
curr_Factors:  [9.50769902e+01 3.99343830e-02]
mat_Sqrt:  [[ 1.89997950e+01  0.00000000e+00]
 [-7.99343560e-03  1.83152619e-02]]
grads:  [-2.26227516e-03  5.89487461e+00]
Stock Position:  -0.0022622751590594815
Bond Position:  [2.24892038]


portfolio before change:  [2.03734952]
curr_Stock_Price:  93.64554911344979
curr_Factors:  [9.36455491e+01 3.99552429e-02]
mat_Sqrt:  [[ 1.87186286e+01  0.00000000e+00]
 [-7.99552304e-03  1.83200448e-02]]
grads:  [ 0.0299328  12.38667195]
Stock Position:  0.029932796980630966
Bond Position:  [-0.76572369]


portfolio before change:  [2.01842159]
curr_Stock_Price:  93.01639950448009
curr_Factors:  [9.30163995e+01 4.07622695e-02]
mat_Sqrt:  [[ 1.87797023e+01  0.00000000e+00]
 [-8.07586721e-03  1.85041364e-02]]
grads:  [ 1.20061166e-03 -3.47683322e+00]
Stock Position:  0.0012006116553030593
Bond Position:  [1.90674502]


portfolio before change:  [2.01733515]
curr_Stock_Price:  91.9129636963469
curr_Factors:  [9.19129637e+01 4.14150854e-02]
mat_Sqrt:  [[ 1.87049284e+01  0.00000000e+00]
 [-8.14027865e-03  1.86517216e-02]]
grads:  [ 7.20837594e-03 -1.73218427e+01]
Stock Position:  0.007208375935966206
Bond Position:  [1.35479195]


portfolio before change:  [2.01380048]
curr_Stock_Price:  91.3991136968655
curr_Factors:  [9.13991137e+01 4.10900549e-02]
mat_Sqrt:  [[ 1.85272237e+01  0.00000000e+00]
 [-8.10827280e-03  1.85783869e-02]]
grads:  [0.00743982 1.88278797]
Stock Position:  0.007439818461289733
Bond Position:  [1.33380767]


portfolio before change:  [2.01757324]
curr_Stock_Price:  91.88380565943247
curr_Factors:  [9.18838057e+01 4.10317828e-02]
mat_Sqrt:  [[ 1.86122625e+01  0.00000000e+00]
 [-8.10252137e-03  1.85652087e-02]]
grads:  [5.98773447e-03 2.25470374e+01]
Stock Position:  0.005987734467170466
Bond Position:  [1.46739741]


portfolio before change:  [2.01928363]
curr_Stock_Price:  92.13881978643782
curr_Factors:  [9.21388198e+01 4.17195597e-02]
mat_Sqrt:  [[ 1.88196916e+01  0.00000000e+00]
 [-8.17014660e-03  1.87201576e-02]]
grads:  [-0.02299935 -7.4717782 ]
Stock Position:  -0.022999347896702174
Bond Position:  [4.13841641]


portfolio before change:  [2.01083724]
curr_Stock_Price:  92.52855804288515
curr_Factors:  [9.25285580e+01 4.18969537e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.01083724]
Stock Price:  91.2215919648922
PL:  [2.01083724]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.47037610e+00  3.63758815e-01]
 [ 4.86266354e-01  1.27463691e-01]
 [ 1.02972755e-01 -4.37017879e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.12491031e-01 -2.72190213e-01]
 [-2.94002516e-01  1.16601504e-01]
 [ 9.48942655e-02  4.67533080e-02]
 [ 1.49588467e-01  4.30285685e-01]
 [-1.18177054e-01 -9.84275168e-02]
 [-2.57533582e-01 -5.16348462e-01]
 [-6.92503286e-02 -1.27090462e-02]
 [-1.25996122e-02 -1.36353306e-01]
 [-5.45699002e-02 -2.23253423e-02]
 [ 2.29542366e-02 -1.97284416e-01]
 [-3.99341679e-02 -9.16106377e-02]
 [ 1.10978775e-01 -7.58578375e-01]
 [ 2.25764334e-02 -2.18382490e-01]
 [ 4.06297426e-02 -1.62902781e-01]
 [-1.19547970e-01 -3.14186703e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.32023080e-01 -2.55458386e-02]
 [ 3.87902535e-01 -3.56914232e-01]
 [ 2.71519845e-02 -3.31183820e-01]
 [ 2.58139161e-02  8.64787817e-02]
 [ 4.55953237e-01 -4.50624433e-01]
 [-3.36686041e-01  3.66705716e-02]
 [-1.39077379e-01  1.47927096e-01]
 [-1.17404716e-01 -1.99886723e-01]
 [-7.70101856e-02  2.26324933e-01]
 [-4.90980980e-01  7.27202500e-01]
 [-1.19773186e-01  2.73666091e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.31807329e-01 -2.99516736e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.39902411e-01 -1.27829238e-02]
 [-2.90937899e-02 -1.61913562e-01]
 [-1.13989012e-02 -6.47639595e-02]
 [ 2.03938838e-01 -2.46505524e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.38409235]
curr_Stock_Price:  98.82923309794495
curr_Factors:  [9.88292331e+01 4.12033228e-02]
mat_Sqrt:  [[ 2.00609523e+01  0.00000000e+00]
 [-8.11944065e-03  1.86039757e-02]]
grads:  [ 0.08120918 19.55274623]
Stock Position:  0.08120917869729903
Bond Position:  [-13.4099332]


portfolio before change:  [-5.30877058]
curr_Stock_Price:  99.77737852120461
curr_Factors:  [9.97773785e+01 4.12773469e-02]
mat_Sqrt:  [[ 2.02715976e+01  0.00000000e+00]
 [-8.12673090e-03  1.86206797e-02]]
grads:  [0.02673179 6.84527594]
Stock Position:  0.026731788937473848
Bond Position:  [-7.97599841]


portfolio before change:  [-5.3320959]
curr_Stock_Price:  98.94210873598149
curr_Factors:  [9.89421087e+01 4.20280118e-02]
mat_Sqrt:  [[ 2.02838591e+01  0.00000000e+00]
 [-8.20029383e-03  1.87892336e-02]]
grads:  [ 0.00413628 -2.32589518]
Stock Position:  0.004136280521182246
Bond Position:  [-5.74134822]


portfolio before change:  [-5.32370338]
curr_Stock_Price:  101.14462720616534
curr_Factors:  [1.01144627e+02 4.10988526e-02]
mat_Sqrt:  [[ 2.05049005e+01  0.00000000e+00]
 [-8.10914077e-03  1.85803757e-02]]
grads:  [-7.94998588e-04 -8.14767230e+00]
Stock Position:  -0.000794998588024098
Bond Position:  [-5.24329354]


portfolio before change:  [-5.32474691]
curr_Stock_Price:  101.63277034700594
curr_Factors:  [1.01632770e+02 4.07125041e-02]
mat_Sqrt:  [[ 2.05067894e+01  0.00000000e+00]
 [-8.07093592e-03  1.84928374e-02]]
grads:  [-1.12784392e-02 -1.47186831e+01]
Stock Position:  -0.011278439249460578
Bond Position:  [-4.17848788]


portfolio before change:  [-5.31983863]
curr_Stock_Price:  101.1512660494027
curr_Factors:  [1.01151266e+02 4.05918540e-02]
mat_Sqrt:  [[ 2.03793706e+01  0.00000000e+00]
 [-8.05896807e-03  1.84654156e-02]]
grads:  [-0.01192939  6.31458868]
Stock Position:  -0.011929389401036385
Bond Position:  [-4.11316579]


portfolio before change:  [-5.3094228]
curr_Stock_Price:  100.23504051121222
curr_Factors:  [1.00235041e+02 4.16281618e-02]
mat_Sqrt:  [[ 2.04509359e+01  0.00000000e+00]
 [-8.16119225e-03  1.86996406e-02]]
grads:  [0.00563784 2.50022495]
Stock Position:  0.0056378389020722555
Bond Position:  [-5.87453181]


portfolio before change:  [-5.30712623]
curr_Stock_Price:  100.77264658787333
curr_Factors:  [1.00772647e+02 4.22464538e-02]
mat_Sqrt:  [[ 2.07127515e+01  0.00000000e+00]
 [-8.22157686e-03  1.88379991e-02]]
grads:  [1.62885427e-02 2.28413687e+01]
Stock Position:  0.016288542651743183
Bond Position:  [-6.94856578]


portfolio before change:  [-5.27913973]
curr_Stock_Price:  102.54414478417922
curr_Factors:  [1.02544145e+02 4.03647053e-02]
mat_Sqrt:  [[ 2.06021128e+01  0.00000000e+00]
 [-8.03638777e-03  1.84136776e-02]]
grads:  [-0.00782125 -5.3453481 ]
Stock Position:  -0.007821253377194437
Bond Position:  [-4.47711599]


portfolio before change:  [-5.28388458]
curr_Stock_Price:  103.07924861025029
curr_Factors:  [1.03079249e+02 3.94932858e-02]
mat_Sqrt:  [[ 2.04848542e+01  0.00000000e+00]
 [-7.94916708e-03  1.82138299e-02]]
grads:  [-2.35728563e-02 -2.83492524e+01]
Stock Position:  -0.023572856332990267
Bond Position:  [-2.85401227]


portfolio before change:  [-5.2797228]
curr_Stock_Price:  102.88756386217551
curr_Factors:  [1.02887564e+02 3.98372310e-02]
mat_Sqrt:  [[ 2.05356028e+01  0.00000000e+00]
 [-7.98370651e-03  1.82929697e-02]]
grads:  [-0.00364231 -0.6947503 ]
Stock Position:  -0.0036423090034896246
Bond Position:  [-4.9049745]


portfolio before change:  [-5.27567566]
curr_Stock_Price:  101.60807310852768
curr_Factors:  [1.01608073e+02 3.97022293e-02]
mat_Sqrt:  [[ 2.02458336e+01  0.00000000e+00]
 [-7.97016731e-03  1.82619475e-02]]
grads:  [-3.56167473e-03 -7.46652601e+00]
Stock Position:  -0.003561674725087411
Bond Position:  [-4.91378075]


portfolio before change:  [-5.2836746]
curr_Stock_Price:  103.68144547200033
curr_Factors:  [1.03681445e+02 3.91784295e-02]
mat_Sqrt:  [[ 2.05222302e+01  0.00000000e+00]
 [-7.91741670e-03  1.81410807e-02]]
grads:  [-0.00313384 -1.23065118]
Stock Position:  -0.0031338445106019706
Bond Position:  [-4.95875307]


portfolio before change:  [-5.28697348]
curr_Stock_Price:  104.53630566626443
curr_Factors:  [1.04536306e+02 3.87038698e-02]
mat_Sqrt:  [[ 2.05657401e+01  0.00000000e+00]
 [-7.86931964e-03  1.80308765e-02]]
grads:  [-3.07053095e-03 -1.09414768e+01]
Stock Position:  -0.00307053095430903
Bond Position:  [-4.96599152]


portfolio before change:  [-5.28966297]
curr_Stock_Price:  105.21003426221772
curr_Factors:  [1.05210034e+02 3.81647516e-02]
mat_Sqrt:  [[ 2.05536228e+01  0.00000000e+00]
 [-7.81432035e-03  1.79048573e-02]]
grads:  [-3.88818696e-03 -5.11652432e+00]
Stock Position:  -0.0038881869560195375
Bond Position:  [-4.88058669]


portfolio before change:  [-5.28521087]
curr_Stock_Price:  103.90808619440801
curr_Factors:  [1.03908086e+02 3.94264533e-02]
mat_Sqrt:  [[ 2.06320889e+01  0.00000000e+00]
 [-7.94243825e-03  1.81984122e-02]]
grads:  [-1.06674593e-02 -4.16837670e+01]
Stock Position:  -0.01066745934435097
Bond Position:  [-4.17677558]


portfolio before change:  [-5.28637641]
curr_Stock_Price:  103.9684019054233
curr_Factors:  [1.03968402e+02 3.97922680e-02]
mat_Sqrt:  [[ 2.07396162e+01  0.00000000e+00]
 [-7.97919976e-03  1.82826434e-02]]
grads:  [-3.50698386e-03 -1.19447984e+01]
Stock Position:  -0.0035069838586835223
Bond Position:  [-4.9217609]


portfolio before change:  [-5.29344591]
curr_Stock_Price:  105.80879681944127
curr_Factors:  [1.05808797e+02 3.71320858e-02]
mat_Sqrt:  [[ 2.03890245e+01  0.00000000e+00]
 [-7.70787501e-03  1.76609603e-02]]
grads:  [-1.49427746e-03 -9.22389145e+00]
Stock Position:  -0.0014942774640868055
Bond Position:  [-5.13533821]


portfolio before change:  [-5.29263532]
curr_Stock_Price:  104.83672860334327
curr_Factors:  [1.04836729e+02 3.73454850e-02]
mat_Sqrt:  [[ 2.02596768e+01  0.00000000e+00]
 [-7.72999198e-03  1.77116367e-02]]
grads:  [-1.26690219e-02 -1.77389988e+01]
Stock Position:  -0.012669021911821133
Bond Position:  [-3.96445651]


portfolio before change:  [-5.29715485]
curr_Stock_Price:  105.15434915711946
curr_Factors:  [1.05154349e+02 3.65896141e-02]
mat_Sqrt:  [[ 2.01143570e+01  0.00000000e+00]
 [-7.65136475e-03  1.75314791e-02]]
grads:  [-2.40927761e-04 -6.22271451e+00]
Stock Position:  -0.00024092776130363872
Bond Position:  [-5.27182025]


portfolio before change:  [-5.29756578]
curr_Stock_Price:  104.12461452280367
curr_Factors:  [1.04124615e+02 3.82434085e-02]
mat_Sqrt:  [[ 2.03625284e+01  0.00000000e+00]
 [-7.82236880e-03  1.79232986e-02]]
grads:  [ 0.0059361  -1.42528667]
Stock Position:  0.005936097886824129
Bond Position:  [-5.91565968]


portfolio before change:  [-5.30058847]
curr_Stock_Price:  103.73998652362157
curr_Factors:  [1.03739987e+02 3.74264144e-02]
mat_Sqrt:  [[ 2.00694420e+01  0.00000000e+00]
 [-7.73836307e-03  1.77308173e-02]]
grads:  [ 1.15664598e-02 -2.01295985e+01]
Stock Position:  0.011566459788707656
Bond Position:  [-6.50049286]


portfolio before change:  [-5.2936976]
curr_Stock_Price:  104.40600587547533
curr_Factors:  [1.04406006e+02 3.82352569e-02]
mat_Sqrt:  [[ 2.04153810e+01  0.00000000e+00]
 [-7.82153509e-03  1.79213883e-02]]
grads:  [-5.75000215e-03 -1.84798083e+01]
Stock Position:  -0.005750002148143282
Bond Position:  [-4.69336284]


portfolio before change:  [-5.30077769]
curr_Stock_Price:  105.53528880470375
curr_Factors:  [1.05535289e+02 3.75697322e-02]
mat_Sqrt:  [[ 2.04558134e+01  0.00000000e+00]
 [-7.75316526e-03  1.77647333e-02]]
grads:  [3.10700678e-03 4.86800337e+00]
Stock Position:  0.0031070067752855795
Bond Position:  [-5.62867654]


portfolio before change:  [-5.30048971]
curr_Stock_Price:  105.85443843838328
curr_Factors:  [1.05854438e+02 3.73642990e-02]
mat_Sqrt:  [[ 2.04615011e+01  0.00000000e+00]
 [-7.73193885e-03  1.77160975e-02]]
grads:  [ 1.26718274e-02 -2.54358745e+01]
Stock Position:  0.01267182742746512
Bond Position:  [-6.64185889]


portfolio before change:  [-5.31149421]
curr_Stock_Price:  105.05153808316103
curr_Factors:  [1.05051538e+02 3.71564539e-02]
mat_Sqrt:  [[ 2.02497444e+01  0.00000000e+00]
 [-7.71040376e-03  1.76667544e-02]]
grads:  [-0.01583633  2.07568242]
Stock Position:  -0.015836332813488174
Bond Position:  [-3.64786309]


portfolio before change:  [-5.31647617]
curr_Stock_Price:  105.33733294255593
curr_Factors:  [1.05337333e+02 3.81901936e-02]
mat_Sqrt:  [[ 2.05853496e+01  0.00000000e+00]
 [-7.81692457e-03  1.79108243e-02]]
grads:  [-3.61988999e-03  8.25908924e+00]
Stock Position:  -0.0036198899874696436
Bond Position:  [-4.93516661]


portfolio before change:  [-5.32196509]
curr_Stock_Price:  106.68322735442413
curr_Factors:  [1.06683227e+02 3.74943912e-02]
mat_Sqrt:  [[ 2.06575731e+01  0.00000000e+00]
 [-7.74538739e-03  1.77469120e-02]]
grads:  [-9.90641220e-03 -1.12631833e+01]
Stock Position:  -0.009906412204549193
Bond Position:  [-4.26511707]


portfolio before change:  [-5.33409895]
curr_Stock_Price:  107.85425516647365
curr_Factors:  [1.07854255e+02 3.82607332e-02]
mat_Sqrt:  [[ 2.10966709e+01  0.00000000e+00]
 [-7.82414041e-03  1.79273578e-02]]
grads:  [1.03173213e-03 1.26245560e+01]
Stock Position:  0.0010317321304428501
Bond Position:  [-5.44537565]


portfolio before change:  [-5.33442618]
curr_Stock_Price:  108.19686333230962
curr_Factors:  [1.08196863e+02 3.85791320e-02]
mat_Sqrt:  [[ 2.12515640e+01  0.00000000e+00]
 [-7.85662849e-03  1.80017974e-02]]
grads:  [-8.16898884e-03  4.03961052e+01]
Stock Position:  -0.008168988843131513
Bond Position:  [-4.45056721]


portfolio before change:  [-5.32566737]
curr_Stock_Price:  107.05655517103602
curr_Factors:  [1.07056555e+02 3.75073558e-02]
mat_Sqrt:  [[ 2.07334459e+01  0.00000000e+00]
 [-7.74672636e-03  1.77499800e-02]]
grads:  [-0.00520075  1.54178253]
Stock Position:  -0.005200747546828443
Bond Position:  [-4.76889326]


portfolio before change:  [-5.32393247]
curr_Stock_Price:  106.60834082279125
curr_Factors:  [1.06608341e+02 3.83225504e-02]
mat_Sqrt:  [[ 2.08698048e+01  0.00000000e+00]
 [-7.83045852e-03  1.79418345e-02]]
grads:  [ 0.00347596 -0.66588448]
Stock Position:  0.0034759595269677136
Bond Position:  [-5.69449875]


portfolio before change:  [-5.3279412]
curr_Stock_Price:  105.65986237681794
curr_Factors:  [1.05659862e+02 3.90030048e-02]
mat_Sqrt:  [[ 2.08669547e+01  0.00000000e+00]
 [-7.89967136e-03  1.81004210e-02]]
grads:  [-0.01173527 -1.65475011]
Stock Position:  -0.011735268261958995
Bond Position:  [-4.08799437]


portfolio before change:  [-5.32843101]
curr_Stock_Price:  105.65805356400075
curr_Factors:  [1.05658054e+02 3.75717018e-02]
mat_Sqrt:  [[ 2.04801456e+01  0.00000000e+00]
 [-7.75336849e-03  1.77651990e-02]]
grads:  [0.00495461 3.00300947]
Stock Position:  0.0049546118395040716
Bond Position:  [-5.85192565]


portfolio before change:  [-5.32691889]
curr_Stock_Price:  106.11089429108006
curr_Factors:  [1.06110894e+02 3.68052370e-02]
mat_Sqrt:  [[ 2.03570472e+01  0.00000000e+00]
 [-7.67387641e-03  1.75830598e-02]]
grads:  [-0.00465036  4.62519876]
Stock Position:  -0.004650360623532842
Bond Position:  [-4.83346497]


portfolio before change:  [-5.32215142]
curr_Stock_Price:  104.95578036267993
curr_Factors:  [1.04955780e+02 3.78295493e-02]
mat_Sqrt:  [[ 2.04137102e+01  0.00000000e+00]
 [-7.77992795e-03  1.78260544e-02]]
grads:  [-0.01692399 -0.71709216]
Stock Position:  -0.016923985505778037
Bond Position:  [-3.54588131]


portfolio before change:  [-5.33192693]
curr_Stock_Price:  105.50720162648506
curr_Factors:  [1.05507202e+02 3.79256465e-02]
mat_Sqrt:  [[ 2.05470085e+01  0.00000000e+00]
 [-7.78980323e-03  1.78486815e-02]]
grads:  [-4.85514286e-03 -9.07145786e+00]
Stock Position:  -0.004855142863535751
Bond Position:  [-4.81967439]


portfolio before change:  [-5.33079617]
curr_Stock_Price:  105.15020923485905
curr_Factors:  [1.05150209e+02 3.72255749e-02]
mat_Sqrt:  [[ 2.02876082e+01  0.00000000e+00]
 [-7.71757215e-03  1.76831793e-02]]
grads:  [-1.95509545e-03 -3.66246128e+00]
Stock Position:  -0.0019550954511662927
Bond Position:  [-5.12521748]


portfolio before change:  [-5.33688456]
curr_Stock_Price:  107.93661672116072
curr_Factors:  [1.07936617e+02 3.49132961e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.33688456]
Stock Price:  109.7820616550026
PL:  [-15.11894621]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.16733180e+00  2.92811547e-01]
 [ 3.47139396e-01  1.13408973e-01]
 [-9.03443958e-03 -5.95874817e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.20910181e-01 -4.68122295e-01]
 [-3.75574774e-01  2.11005141e-01]
 [ 2.19889144e-01 -2.38381719e-01]
 [ 1.29478649e-01  4.23862227e-01]
 [-7.42814492e-02  8.78027993e-02]
 [ 1.81617680e-01  4.61708864e-02]
 [-1.12353495e-01  2.22847911e-03]
 [ 3.32290774e-02 -1.37071986e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-8.54363873e-02  9.60359599e-02]
 [ 3.32946835e-01  2.43269322e-01]
 [ 1.32962328e-01 -6.65975127e-02]
 [ 3.99366970e-02  7.15856888e-02]
 [ 1.52695010e-02  6.02791328e-02]
 [-3.75000560e-02 -2.09396949e-02]
 [-5.11783393e-01  2.22171670e-01]
 [ 1.93171605e-02  1.58185372e-01]
 [ 1.64471852e+00  1.98702213e-01]
 [ 1.54539907e-02  4.48555857e-01]
 [-1.60256078e-01  2.18664287e-01]
 [-1.70514147e-01  8.36027984e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 1.83934426e-01 -4.45744620e-01]
 [ 1.04114085e-01 -1.93897561e-02]
 [ 6.00417427e-01 -3.09226305e-01]
 [-5.61054531e-01 -3.03811605e-01]
 [ 3.99323494e-01  1.50375881e-01]
 [-2.01567771e-01  2.98860385e-01]
 [ 7.34389473e-01  2.04121746e-01]
 [ 7.05904154e-02 -1.74605128e-01]
 [ 3.21990850e-01 -4.95981380e-01]
 [ 1.38626767e-01  1.47252767e-02]
 [-6.66520932e-02  3.44880674e-01]
 [-3.81397228e-01 -1.42150405e-01]
 [-1.54890603e-01  5.88112052e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.48558407]
curr_Stock_Price:  100.69733052963907
curr_Factors:  [1.00697331e+02 4.06493731e-02]
mat_Sqrt:  [[ 2.03022833e+01  0.00000000e+00]
 [-8.06467587e-03  1.84784938e-02]]
grads:  [ 0.0637921 15.8460722]
Stock Position:  0.06379209758099214
Bond Position:  [1.06189013]


portfolio before change:  [7.45443174]
curr_Stock_Price:  100.20690809800958
curr_Factors:  [1.00206908e+02 4.08239640e-02]
mat_Sqrt:  [[ 2.02467466e+01  0.00000000e+00]
 [-8.08197639e-03  1.85181343e-02]]
grads:  [0.01959007 6.12421164]
Stock Position:  0.01959006734346623
Bond Position:  [5.49137166]


portfolio before change:  [7.47111258]
curr_Stock_Price:  101.02336141132253
curr_Factors:  [1.01023361e+02 4.08894312e-02]
mat_Sqrt:  [[ 2.04280706e+01  0.00000000e+00]
 [-8.08845411e-03  1.85329766e-02]]
grads:  [-1.71531367e-03 -3.21521378e+00]
Stock Position:  -0.001715313668044113
Bond Position:  [7.64439933]


portfolio before change:  [7.4715129]
curr_Stock_Price:  101.34708468838717
curr_Factors:  [1.01347085e+02 4.24836873e-02]
mat_Sqrt:  [[ 2.08892267e+01  0.00000000e+00]
 [-8.24462853e-03  1.88908172e-02]]
grads:  [-7.80371970e-04 -8.01377787e+00]
Stock Position:  -0.0007803719701933398
Bond Position:  [7.55060132]


portfolio before change:  [7.47158601]
curr_Stock_Price:  102.46292863188006
curr_Factors:  [1.02462929e+02 4.21576974e-02]
mat_Sqrt:  [[ 2.10380366e+01  0.00000000e+00]
 [-8.21293589e-03  1.88182002e-02]]
grads:  [-1.54584530e-02 -2.48760397e+01]
Stock Position:  -0.015458453012709643
Bond Position:  [9.05550438]


portfolio before change:  [7.47481146]
curr_Stock_Price:  102.32750492667746
curr_Factors:  [1.02327505e+02 3.96392281e-02]
mat_Sqrt:  [[ 2.03729997e+01  0.00000000e+00]
 [-7.96384109e-03  1.82474523e-02]]
grads:  [-0.01391472 11.5635398 ]
Stock Position:  -0.013914719688362304
Bond Position:  [8.89867001]


portfolio before change:  [7.47832101]
curr_Stock_Price:  102.15523086888285
curr_Factors:  [1.02155231e+02 3.81230475e-02]
mat_Sqrt:  [[ 1.99459357e+01  0.00000000e+00]
 [-7.81004968e-03  1.78950719e-02]]
grads:  [ 5.80824256e-03 -1.33210819e+01]
Stock Position:  0.005808242556688075
Bond Position:  [6.88497865]


portfolio before change:  [7.47148438]
curr_Stock_Price:  100.82999287223477
curr_Factors:  [1.00829993e+02 3.85054706e-02]
mat_Sqrt:  [[ 1.97856788e+01  0.00000000e+00]
 [-7.84912435e-03  1.79846032e-02]]
grads:  [1.58936822e-02 2.35680611e+01]
Stock Position:  0.015893682215275335
Bond Position:  [5.86892452]


portfolio before change:  [7.45728974]
curr_Stock_Price:  99.89073301942194
curr_Factors:  [9.98907330e+01 3.94861954e-02]
mat_Sqrt:  [[ 1.98494211e+01  0.00000000e+00]
 [-7.94845348e-03  1.82121949e-02]]
grads:  [-1.81169847e-03  4.82109927e+00]
Stock Position:  -0.0018116984742415866
Bond Position:  [7.63826163]


portfolio before change:  [7.45872079]
curr_Stock_Price:  99.62788123096269
curr_Factors:  [9.96278812e+01 3.93978612e-02]
mat_Sqrt:  [[ 1.97750330e+01  0.00000000e+00]
 [-7.93955779e-03  1.81918123e-02]]
grads:  [0.01020318 2.53800367]
Stock Position:  0.01020318432673297
Bond Position:  [6.44219916]


portfolio before change:  [7.45270391]
curr_Stock_Price:  98.95924590695243
curr_Factors:  [9.89592459e+01 4.00577625e-02]
mat_Sqrt:  [[ 1.98061344e+01  0.00000000e+00]
 [-8.00577417e-03  1.83435331e-02]]
grads:  [-0.00562356  0.12148582]
Stock Position:  -0.005623556058992967
Bond Position:  [8.00920678]


portfolio before change:  [7.45809881]
curr_Stock_Price:  98.17794626278398
curr_Factors:  [9.81779463e+01 4.05680675e-02]
mat_Sqrt:  [[ 1.97745270e+01  0.00000000e+00]
 [-8.05660648e-03  1.84600045e-02]]
grads:  [-1.34486360e-03 -7.42534951e+00]
Stock Position:  -0.0013448636020659073
Bond Position:  [7.59013475]


portfolio before change:  [7.4588898]
curr_Stock_Price:  98.29530338946904
curr_Factors:  [9.82953034e+01 4.07257288e-02]
mat_Sqrt:  [[ 1.98365984e+01  0.00000000e+00]
 [-8.07224666e-03  1.84958407e-02]]
grads:  [-0.00652072 -1.51663315]
Stock Position:  -0.006520719222273318
Bond Position:  [8.09984588]


portfolio before change:  [7.46114409]
curr_Stock_Price:  98.10487265462132
curr_Factors:  [9.81048727e+01 4.07575080e-02]
mat_Sqrt:  [[ 1.98058912e+01  0.00000000e+00]
 [-8.07539552e-03  1.85030556e-02]]
grads:  [-2.19747032e-03  5.19027570e+00]
Stock Position:  -0.002197470321483219
Bond Position:  [7.67672664]


portfolio before change:  [7.46700543]
curr_Stock_Price:  95.87426907316333
curr_Factors:  [9.58742691e+01 4.13294454e-02]
mat_Sqrt:  [[ 1.94908983e+01  0.00000000e+00]
 [-8.13185788e-03  1.86324271e-02]]
grads:  [ 0.0225294  13.05623367]
Stock Position:  0.02252940145302237
Bond Position:  [5.30701553]


portfolio before change:  [7.4614869]
curr_Stock_Price:  95.5998746425335
curr_Factors:  [9.55998746e+01 4.24250243e-02]
mat_Sqrt:  [[ 1.96910272e+01  0.00000000e+00]
 [-8.23893432e-03  1.88777701e-02]]
grads:  [ 0.00527635 -3.5278273 ]
Stock Position:  0.005276351995133136
Bond Position:  [6.95706831]


portfolio before change:  [7.46097776]
curr_Stock_Price:  95.3385522093059
curr_Factors:  [9.53385522e+01 4.20642563e-02]
mat_Sqrt:  [[ 1.95535295e+01  0.00000000e+00]
 [-8.20382899e-03  1.87973337e-02]]
grads:  [3.64022531e-03 3.80828952e+00]
Stock Position:  0.0036402253141523985
Bond Position:  [7.11392395]


portfolio before change:  [7.4723545]
curr_Stock_Price:  98.21954012286803
curr_Factors:  [9.82195401e+01 3.98032917e-02]
mat_Sqrt:  [[ 1.95955470e+01  0.00000000e+00]
 [-7.98030493e-03  1.82851757e-02]]
grads:  [2.12178161e-03 3.29661217e+00]
Stock Position:  0.002121781613480827
Bond Position:  [7.26395409]


portfolio before change:  [7.47055436]
curr_Stock_Price:  96.94316261396895
curr_Factors:  [9.69431626e+01 4.09760496e-02]
mat_Sqrt:  [[ 1.96237602e+01  0.00000000e+00]
 [-8.09701670e-03  1.85525960e-02]]
grads:  [-0.00237665 -1.12866657]
Stock Position:  -0.0023766539970393346
Bond Position:  [7.70095472]


portfolio before change:  [7.47570619]
curr_Stock_Price:  95.18053907228177
curr_Factors:  [9.51805391e+01 4.03569463e-02]
mat_Sqrt:  [[ 1.91208550e+01  0.00000000e+00]
 [-8.03561535e-03  1.84119078e-02]]
grads:  [-0.02169462 12.06673814]
Stock Position:  -0.02169462225297526
Bond Position:  [9.54061203]


portfolio before change:  [7.50548938]
curr_Stock_Price:  93.86267594442383
curr_Factors:  [9.38626759e+01 4.08894361e-02]
mat_Sqrt:  [[ 1.89800998e+01  0.00000000e+00]
 [-8.08845459e-03  1.85329777e-02]]
grads:  [4.65513448e-03 8.53534574e+00]
Stock Position:  0.004655134475382273
Bond Position:  [7.068546]


portfolio before change:  [7.50784544]
curr_Stock_Price:  94.17897876378808
curr_Factors:  [9.41789788e+01 4.08843137e-02]
mat_Sqrt:  [[ 1.90428669e+01  0.00000000e+00]
 [-8.08794794e-03  1.85318168e-02]]
grads:  [ 0.09092325 10.72221977]
Stock Position:  0.09092324621977745
Bond Position:  [-1.05521304]


portfolio before change:  [7.5139085]
curr_Stock_Price:  94.24711283197014
curr_Factors:  [9.42471128e+01 3.96676139e-02]
mat_Sqrt:  [[ 1.87709431e+01  0.00000000e+00]
 [-7.96669205e-03  1.82539847e-02]]
grads:  [1.12524882e-02 2.45730379e+01]
Stock Position:  0.011252488216836358
Bond Position:  [6.45339397]


portfolio before change:  [7.4911819]
curr_Stock_Price:  92.15572457806346
curr_Factors:  [9.21557246e+01 4.04079674e-02]
mat_Sqrt:  [[ 1.85248978e+01  0.00000000e+00]
 [-8.04069325e-03  1.84235427e-02]]
grads:  [-3.49924518e-03  1.18687427e+01]
Stock Position:  -0.003499245184994805
Bond Position:  [7.81365737]


portfolio before change:  [7.49016278]
curr_Stock_Price:  92.72610026346916
curr_Factors:  [9.27261003e+01 3.93808387e-02]
mat_Sqrt:  [[ 1.84011292e+01  0.00000000e+00]
 [-7.93784239e-03  1.81878818e-02]]
grads:  [-0.00728362  4.59662094]
Stock Position:  -0.007283623328007701
Bond Position:  [8.16554477]


portfolio before change:  [7.49555924]
curr_Stock_Price:  92.1253421562004
curr_Factors:  [9.21253422e+01 3.98881237e-02]
mat_Sqrt:  [[ 1.83992838e+01  0.00000000e+00]
 [-7.98880453e-03  1.83046507e-02]]
grads:  [ 0.00997205 -3.98781371]
Stock Position:  0.009972051354515938
Bond Position:  [6.57688059]


portfolio before change:  [7.50743788]
curr_Stock_Price:  93.23408926697742
curr_Factors:  [9.32340893e+01 3.84936236e-02]
mat_Sqrt:  [[ 1.82923343e+01  0.00000000e+00]
 [-7.84791678e-03  1.79818363e-02]]
grads:  [-5.79722346e-04 -2.47886040e+01]
Stock Position:  -0.0005797223464583011
Bond Position:  [7.56148777]


portfolio before change:  [7.50837428]
curr_Stock_Price:  93.24934259534056
curr_Factors:  [9.32493426e+01 3.92612648e-02]
mat_Sqrt:  [[ 1.84768495e+01  0.00000000e+00]
 [-7.92578221e-03  1.81602485e-02]]
grads:  [ 0.00517684 -1.06770324]
Stock Position:  0.005176840425003135
Bond Position:  [7.02563732]


portfolio before change:  [7.50870701]
curr_Stock_Price:  93.1439634847328
curr_Factors:  [9.31439635e+01 3.93023622e-02]
mat_Sqrt:  [[ 1.84656262e+01  0.00000000e+00]
 [-7.92992935e-03  1.81697508e-02]]
grads:  [  0.02520684 -17.01874225]
Stock Position:  0.025206835488850332
Bond Position:  [5.16084245]


portfolio before change:  [7.51291716]
curr_Stock_Price:  93.28539365509715
curr_Factors:  [9.32853937e+01 3.98173575e-02]
mat_Sqrt:  [[ 1.86144353e+01  0.00000000e+00]
 [-7.98171486e-03  1.82884063e-02]]
grads:  [ -0.03726403 -16.61225154]
Stock Position:  -0.037264025145469136
Bond Position:  [10.98910642]


portfolio before change:  [7.5497517]
curr_Stock_Price:  92.3337837454698
curr_Factors:  [9.23337837e+01 4.03021709e-02]
mat_Sqrt:  [[ 1.85363770e+01  0.00000000e+00]
 [-8.03016024e-03  1.83994086e-02]]
grads:  [0.02508327 8.17286491]
Stock Position:  0.025083267867103045
Bond Position:  [5.23371867]


portfolio before change:  [7.52941391]
curr_Stock_Price:  91.49688902121189
curr_Factors:  [9.14968890e+01 4.01695673e-02]
mat_Sqrt:  [[ 1.83381240e+01  0.00000000e+00]
 [-8.01693880e-03  1.83691144e-02]]
grads:  [-3.87904489e-03  1.62697220e+01]
Stock Position:  -0.003879044894355938
Bond Position:  [7.88433445]


portfolio before change:  [7.5327393]
curr_Stock_Price:  90.8937027270689
curr_Factors:  [9.08937027e+01 4.11809933e-02]
mat_Sqrt:  [[ 1.84451505e+01  0.00000000e+00]
 [-8.11724025e-03  1.85989339e-02]]
grads:  [ 0.04464455 10.97491643]
Stock Position:  0.0446445532915019
Bond Position:  [3.47483054]


portfolio before change:  [7.44898757]
curr_Stock_Price:  89.00800558372384
curr_Factors:  [8.90080056e+01 4.19020519e-02]
mat_Sqrt:  [[ 1.82199305e+01  0.00000000e+00]
 [-8.18799628e-03  1.87610564e-02]]
grads:  [-3.08097229e-04 -9.30678555e+00]
Stock Position:  -0.0003080972288169856
Bond Position:  [7.47641069]


portfolio before change:  [7.44983296]
curr_Stock_Price:  89.29760023047884
curr_Factors:  [8.92976002e+01 4.24371675e-02]
mat_Sqrt:  [[ 1.83955587e+01  0.00000000e+00]
 [-8.24011335e-03  1.88804716e-02]]
grads:  [ 5.73653841e-03 -2.62695440e+01]
Stock Position:  0.0057365384114583294
Bond Position:  [6.93757384]


portfolio before change:  [7.45609612]
curr_Stock_Price:  90.23822288638945
curr_Factors:  [9.02382229e+01 4.30992219e-02]
mat_Sqrt:  [[ 1.87337728e+01  0.00000000e+00]
 [-8.30414084e-03  1.90271770e-02]]
grads:  [0.00774288 0.77390759]
Stock Position:  0.007742882687360788
Bond Position:  [6.75739215]


portfolio before change:  [7.4761158]
curr_Stock_Price:  92.71468368516847
curr_Factors:  [9.27146837e+01 4.21206633e-02]
mat_Sqrt:  [[ 1.90281305e+01  0.00000000e+00]
 [-8.20932770e-03  1.88099328e-02]]
grads:  [4.40748358e-03 1.83350296e+01]
Stock Position:  0.004407483584035479
Bond Position:  [7.06747735]


portfolio before change:  [7.47045544]
curr_Stock_Price:  91.22997172732164
curr_Factors:  [9.12299717e+01 4.29176223e-02]
mat_Sqrt:  [[ 1.88997199e+01  0.00000000e+00]
 [-8.28662752e-03  1.89870489e-02]]
grads:  [-0.02346261 -7.48670345]
Stock Position:  -0.02346260973713134
Bond Position:  [9.61094867]


portfolio before change:  [7.49093716]
curr_Stock_Price:  90.40822694827197
curr_Factors:  [9.04082269e+01 4.47737702e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.49093716]
Stock Price:  89.67150606867888
PL:  [7.49093716]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.28626324e+00  3.19699563e-01]
 [ 9.81282978e-02  5.76464327e-02]
 [ 1.09956006e-01 -1.51483280e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.96815481e-02  6.20039699e-02]
 [-1.00289959e-01 -9.37859410e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 6.88053866e-01  6.85034691e-01]
 [-8.35677949e-02  5.26012806e-02]
 [ 1.51946083e-01  9.96868205e-03]
 [-1.00459240e-01 -4.59547178e-03]
 [ 2.93578684e-02 -1.35717570e-01]
 [-5.75833280e-02 -1.80576223e-02]
 [-2.03107201e-02 -8.50281685e-02]
 [ 3.10005679e-01  1.85289060e-01]
 [ 1.32271554e-01 -2.51765607e-01]
 [ 3.89312063e-02  3.38327185e-02]
 [ 2.94501497e-02 -1.50713332e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 6.29910666e-04 -8.44251349e-02]
 [ 1.66860295e-01 -3.70695488e-02]
 [ 5.15816191e-01 -2.45016637e-01]
 [ 2.92945660e-02 -3.88061381e-01]
 [ 5.80477396e-02  7.74315376e-03]
 [ 4.19209764e-01 -3.37380540e-01]
 [-2.57761055e-01  1.86597141e-02]
 [-1.52215754e-01  1.08214807e-01]
 [-3.46207331e-03  2.47270832e-01]
 [-3.51759037e-02  1.91841219e-01]
 [-6.63340890e-01 -5.43349159e-02]
 [-1.56618013e-01 -3.46160160e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.47356565e-01  1.56815064e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.44944845e-01 -1.79037362e-02]
 [-2.87764080e-02 -1.64852352e-01]
 [-1.07101601e-02 -6.39985939e-02]
 [ 1.18966804e-01 -2.14688326e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.90030575]
curr_Stock_Price:  100.17690958043073
curr_Factors:  [1.00176910e+02 3.97878148e-02]
mat_Sqrt:  [[ 1.99821711e+01  0.00000000e+00]
 [-7.97875326e-03  1.82816204e-02]]
grads:  [ 0.07135319 17.48748504]
Stock Position:  0.07135318598390004
Bond Position:  [-3.24763591]


portfolio before change:  [3.94400067]
curr_Stock_Price:  100.79497447272907
curr_Factors:  [1.00794974e+02 3.85807830e-02]
mat_Sqrt:  [[ 1.97981403e+01  0.00000000e+00]
 [-7.85679660e-03  1.80021826e-02]]
grads:  [0.00622721 3.20219132]
Stock Position:  0.00622721436051483
Bond Position:  [3.31632876]


portfolio before change:  [3.94040024]
curr_Stock_Price:  100.15022384877632
curr_Factors:  [1.00150224e+02 3.90008178e-02]
mat_Sqrt:  [[ 1.97782919e+01  0.00000000e+00]
 [-7.89944989e-03  1.80999135e-02]]
grads:  [ 0.00522516 -0.8369282 ]
Stock Position:  0.005225159696622994
Bond Position:  [3.41709932]


portfolio before change:  [3.93984594]
curr_Stock_Price:  99.9623904726238
curr_Factors:  [9.99623905e+01 4.01791683e-02]
mat_Sqrt:  [[ 2.00372033e+01  0.00000000e+00]
 [-8.01789681e-03  1.83713095e-02]]
grads:  [-8.13555002e-04 -8.24039311e+00]
Stock Position:  -0.0008135550016530526
Bond Position:  [4.02117084]


portfolio before change:  [3.94003691]
curr_Stock_Price:  100.34553233774973
curr_Factors:  [1.00345532e+02 4.07956488e-02]
mat_Sqrt:  [[ 2.02677231e+01  0.00000000e+00]
 [-8.07917310e-03  1.85117112e-02]]
grads:  [-3.08968090e-03  3.34944562e+00]
Stock Position:  -0.0030896808996696374
Bond Position:  [4.25007259]


portfolio before change:  [3.94406277]
curr_Stock_Price:  99.214487196927
curr_Factors:  [9.92144872e+01 4.18859392e-02]
mat_Sqrt:  [[ 2.03052912e+01  0.00000000e+00]
 [-8.18642185e-03  1.87574489e-02]]
grads:  [-0.00695491 -4.99993051]
Stock Position:  -0.006954911336832317
Bond Position:  [4.63409073]


portfolio before change:  [3.94793251]
curr_Stock_Price:  98.74137674049712
curr_Factors:  [9.87413767e+01 4.23156085e-02]
mat_Sqrt:  [[ 2.03118497e+01  0.00000000e+00]
 [-8.22830321e-03  1.88534111e-02]]
grads:  [0.00636937 5.09917735]
Stock Position:  0.006369374495879121
Bond Position:  [3.3190117]


portfolio before change:  [3.94887963]
curr_Stock_Price:  98.82493479020117
curr_Factors:  [9.88249348e+01 4.16822716e-02]
mat_Sqrt:  [[ 2.01763325e+01  0.00000000e+00]
 [-8.16649463e-03  1.87117899e-02]]
grads:  [ 0.04892007 36.60978957]
Stock Position:  0.04892006594010838
Bond Position:  [-0.8856427]


portfolio before change:  [4.01168879]
curr_Stock_Price:  100.11111212968379
curr_Factors:  [1.00111112e+02 4.10351363e-02]
mat_Sqrt:  [[ 2.02796393e+01  0.00000000e+00]
 [-8.10285247e-03  1.85659674e-02]]
grads:  [-0.00298875  2.83320979]
Stock Position:  -0.002988747137897032
Bond Position:  [4.31089559]


portfolio before change:  [4.01036437]
curr_Stock_Price:  100.73455635168524
curr_Factors:  [1.00734556e+02 3.93970705e-02]
mat_Sqrt:  [[ 1.99944952e+01  0.00000000e+00]
 [-7.93947812e-03  1.81916297e-02]]
grads:  [0.00781699 0.5479818 ]
Stock Position:  0.007816990178210791
Bond Position:  [3.22292333]


portfolio before change:  [4.00578858]
curr_Stock_Price:  100.09765095274166
curr_Factors:  [1.00097651e+02 3.88231738e-02]
mat_Sqrt:  [[ 1.97228378e+01  0.00000000e+00]
 [-7.88143883e-03  1.80586450e-02]]
grads:  [-0.00519524 -0.25447489]
Stock Position:  -0.005195239591635473
Bond Position:  [4.52581986]


portfolio before change:  [4.00817202]
curr_Stock_Price:  99.74777632945812
curr_Factors:  [9.97477763e+01 3.86392946e-02]
mat_Sqrt:  [[ 1.96073011e+01  0.00000000e+00]
 [-7.86275215e-03  1.80158285e-02]]
grads:  [-1.52362302e-03 -7.53324059e+00]
Stock Position:  -0.001523623019648359
Bond Position:  [4.16015003]


portfolio before change:  [4.00594332]
curr_Stock_Price:  101.55186691901704
curr_Factors:  [1.01551867e+02 3.73887218e-02]
mat_Sqrt:  [[ 1.96362350e+01  0.00000000e+00]
 [-7.73446539e-03  1.77218866e-02]]
grads:  [-0.00333385 -1.01894469]
Stock Position:  -0.0033338529738455775
Bond Position:  [4.34450232]


portfolio before change:  [4.00449017]
curr_Stock_Price:  102.15064872303229
curr_Factors:  [1.02150649e+02 3.64989442e-02]
mat_Sqrt:  [[ 1.95155718e+01  0.00000000e+00]
 [-7.64187874e-03  1.75097439e-02]]
grads:  [-2.94226866e-03 -4.85604866e+00]
Stock Position:  -0.0029422686555903793
Bond Position:  [4.30504482]


portfolio before change:  [4.00633841]
curr_Stock_Price:  101.70538720857377
curr_Factors:  [1.01705387e+02 3.80409095e-02]
mat_Sqrt:  [[ 1.98366990e+01  0.00000000e+00]
 [-7.80163157e-03  1.78757836e-02]]
grads:  [ 0.01970451 10.36536715]
Stock Position:  0.019704511042182647
Bond Position:  [2.00228349]


portfolio before change:  [3.97591935]
curr_Stock_Price:  100.14892336370231
curr_Factors:  [1.00148923e+02 3.94010584e-02]
mat_Sqrt:  [[ 1.98792607e+01  0.00000000e+00]
 [-7.93987994e-03  1.81925504e-02]]
grads:  [ 1.12640178e-03 -1.38389396e+01]
Stock Position:  0.0011264017757654664
Bond Position:  [3.86311143]


portfolio before change:  [3.97679326]
curr_Stock_Price:  100.49603701267574
curr_Factors:  [1.00496037e+02 3.79101802e-02]
mat_Sqrt:  [[ 1.95671178e+01  0.00000000e+00]
 [-7.78821471e-03  1.78450417e-02]]
grads:  [0.00274425 1.89591703]
Stock Position:  0.0027442475478389222
Bond Position:  [3.70100726]


portfolio before change:  [3.98050208]
curr_Stock_Price:  101.67893528138558
curr_Factors:  [1.01678935e+02 3.71263464e-02]
mat_Sqrt:  [[ 1.95916988e+01  0.00000000e+00]
 [-7.70727930e-03  1.76595954e-02]]
grads:  [-1.85418024e-03 -8.53435927e+00]
Stock Position:  -0.001854180240223413
Bond Position:  [4.16903316]


portfolio before change:  [3.9801737]
curr_Stock_Price:  102.13711097899869
curr_Factors:  [1.02137111e+02 3.73103452e-02]
mat_Sqrt:  [[ 1.97286879e+01  0.00000000e+00]
 [-7.72635440e-03  1.77033019e-02]]
grads:  [-1.61578482e-02 -2.65084811e+01]
Stock Position:  -0.01615784819304492
Bond Position:  [5.63048964]


portfolio before change:  [3.98815474]
curr_Stock_Price:  101.68673026424885
curr_Factors:  [1.01686730e+02 3.74849922e-02]
mat_Sqrt:  [[ 1.96876099e+01  0.00000000e+00]
 [-7.74441654e-03  1.77446875e-02]]
grads:  [-1.83954473e-03 -4.75776961e+00]
Stock Position:  -0.0018395447286004031
Bond Position:  [4.17521203]


portfolio before change:  [3.98856243]
curr_Stock_Price:  101.7488386549997
curr_Factors:  [1.01748839e+02 3.77777748e-02]
mat_Sqrt:  [[ 1.97764187e+01  0.00000000e+00]
 [-7.77460222e-03  1.78138516e-02]]
grads:  [ 0.00761927 -2.08093958]
Stock Position:  0.007619267200541897
Bond Position:  [3.21331084]


portfolio before change:  [3.99449949]
curr_Stock_Price:  102.47533618478003
curr_Factors:  [1.02475336e+02 3.79029646e-02]
mat_Sqrt:  [[ 1.99505991e+01  0.00000000e+00]
 [-7.78747349e-03  1.78433434e-02]]
grads:  [  0.02049473 -13.73154302]
Stock Position:  0.020494731085363527
Bond Position:  [1.89429504]


portfolio before change:  [4.00715809]
curr_Stock_Price:  103.08143328359805
curr_Factors:  [1.03081433e+02 3.65587036e-02]
mat_Sqrt:  [[ 1.97095107e+01  0.00000000e+00]
 [-7.64813218e-03  1.75240723e-02]]
grads:  [-7.10668611e-03 -2.21444750e+01]
Stock Position:  -0.007106686111984024
Bond Position:  [4.73972548]


portfolio before change:  [4.0166004]
curr_Stock_Price:  101.83615433107701
curr_Factors:  [1.01836154e+02 3.71041814e-02]
mat_Sqrt:  [[ 1.96161339e+01  0.00000000e+00]
 [-7.70497827e-03  1.76543231e-02]]
grads:  [0.00313146 0.43859817]
Stock Position:  0.0031314595041485667
Bond Position:  [3.69770461]


portfolio before change:  [4.02161272]
curr_Stock_Price:  103.28917695281008
curr_Factors:  [1.03289177e+02 3.52104407e-02]
mat_Sqrt:  [[ 1.93816411e+01  0.00000000e+00]
 [-7.50577812e-03  1.71978982e-02]]
grads:  [ 1.40320845e-02 -1.96175449e+01]
Stock Position:  0.014032084467427678
Bond Position:  [2.57225027]


portfolio before change:  [4.03734294]
curr_Stock_Price:  104.38727898309541
curr_Factors:  [1.04387279e+02 3.45260179e-02]
mat_Sqrt:  [[ 1.93963862e+01  0.00000000e+00]
 [-7.43247123e-03  1.70299310e-02]]
grads:  [-0.01286927  1.0957011 ]
Stock Position:  -0.012869267769785411
Bond Position:  [5.38073078]


portfolio before change:  [4.04371901]
curr_Stock_Price:  103.94409569512403
curr_Factors:  [1.03944096e+02 3.44594416e-02]
mat_Sqrt:  [[ 1.92954070e+01  0.00000000e+00]
 [-7.42530178e-03  1.70135037e-02]]
grads:  [-5.44103272e-03  6.36052449e+00]
Stock Position:  -0.005441032715105446
Bond Position:  [4.60928224]


portfolio before change:  [4.05245216]
curr_Stock_Price:  102.44494164492427
curr_Factors:  [1.02444942e+02 3.51265097e-02]
mat_Sqrt:  [[ 1.92003002e+01  0.00000000e+00]
 [-7.49682703e-03  1.71773887e-02]]
grads:  [5.44031939e-03 1.43951352e+01]
Stock Position:  0.005440319392479344
Bond Position:  [3.49511895]


portfolio before change:  [4.05219543]
curr_Stock_Price:  102.317440152125
curr_Factors:  [1.02317440e+02 3.45034329e-02]
mat_Sqrt:  [[ 1.90055665e+01  0.00000000e+00]
 [-7.43003988e-03  1.70243601e-02]]
grads:  [2.55453941e-03 1.12686303e+01]
Stock Position:  0.002554539406115283
Bond Position:  [3.79082149]


portfolio before change:  [4.05484703]
curr_Stock_Price:  103.16993050860698
curr_Factors:  [1.03169931e+02 3.40560481e-02]
mat_Sqrt:  [[ 1.90392687e+01  0.00000000e+00]
 [-7.38171234e-03  1.69136278e-02]]
grads:  [-0.03608619 -3.2124933 ]
Stock Position:  -0.03608618595912437
Bond Position:  [7.77785633]


portfolio before change:  [4.045903]
curr_Stock_Price:  103.44472603859722
curr_Factors:  [1.03444726e+02 3.41214978e-02]
mat_Sqrt:  [[ 1.91083152e+01  0.00000000e+00]
 [-7.38880210e-03  1.69298725e-02]]
grads:  [-0.00898696 -2.04467081]
Stock Position:  -0.00898696085687556
Bond Position:  [4.9755567]


portfolio before change:  [4.03862673]
curr_Stock_Price:  104.32358266485468
curr_Factors:  [1.04323583e+02 3.41429465e-02]
mat_Sqrt:  [[ 1.92767135e+01  0.00000000e+00]
 [-7.39112403e-03  1.69351927e-02]]
grads:  [ 0.00376322 -0.7054652 ]
Stock Position:  0.003763224309143169
Bond Position:  [3.64603369]


portfolio before change:  [4.04010243]
curr_Stock_Price:  104.59460475333327
curr_Factors:  [1.04594605e+02 3.38423077e-02]
mat_Sqrt:  [[ 1.92415152e+01  0.00000000e+00]
 [-7.35851155e-03  1.68604681e-02]]
grads:  [-0.01249967  0.93007539]
Stock Position:  -0.01249967022907703
Bond Position:  [5.3475005]


portfolio before change:  [4.05132962]
curr_Stock_Price:  103.7498857384146
curr_Factors:  [1.03749886e+02 3.46627507e-02]
mat_Sqrt:  [[ 1.93160864e+01  0.00000000e+00]
 [-7.44717404e-03  1.70636194e-02]]
grads:  [0.0052532  3.12647978]
Stock Position:  0.005253195170537559
Bond Position:  [3.50631122]


portfolio before change:  [4.05493062]
curr_Stock_Price:  104.35193458382238
curr_Factors:  [1.04351935e+02 3.38152577e-02]
mat_Sqrt:  [[ 1.91891994e+01  0.00000000e+00]
 [-7.35557016e-03  1.68537285e-02]]
grads:  [-0.00493338  4.82535043]
Stock Position:  -0.004933379909968935
Bond Position:  [4.56973835]


portfolio before change:  [4.05151743]
curr_Stock_Price:  105.15958354911473
curr_Factors:  [1.05159584e+02 3.29196725e-02]
mat_Sqrt:  [[ 1.90799227e+01  0.00000000e+00]
 [-7.25751170e-03  1.66290484e-02]]
grads:  [-0.01848848 -1.07665429]
Stock Position:  -0.018488475132090412
Bond Position:  [5.99575778]


portfolio before change:  [4.0501314]
curr_Stock_Price:  105.27509050791109
curr_Factors:  [1.05275091e+02 3.33387043e-02]
mat_Sqrt:  [[ 1.92220624e+01  0.00000000e+00]
 [-7.30355577e-03  1.67345486e-02]]
grads:  [-5.24001385e-03 -9.85101878e+00]
Stock Position:  -0.005240013851851411
Bond Position:  [4.60177433]


portfolio before change:  [4.05240297]
curr_Stock_Price:  104.95136710314551
curr_Factors:  [1.04951367e+02 3.51962789e-02]
mat_Sqrt:  [[ 1.96895810e+01  0.00000000e+00]
 [-7.50426853e-03  1.71944393e-02]]
grads:  [-1.96253218e-03 -3.72205181e+00]
Stock Position:  -0.001962532178173609
Bond Position:  [4.25837341]


portfolio before change:  [4.05265645]
curr_Stock_Price:  105.0934554522492
curr_Factors:  [1.05093455e+02 3.48122305e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.05265645]
Stock Price:  106.01471848181325
PL:  [-1.96206203]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.06307752e+00  2.69241743e-01]
 [-2.23399810e-01 -8.06416245e-02]
 [-1.44673978e-01 -9.47070537e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.16066649e-01 -3.27825538e-01]
 [-3.36426340e-01  1.63667494e-01]
 [ 9.36531832e-02  5.50310980e-02]
 [ 5.41154077e-01  5.92804385e-01]
 [-1.09361070e-02  3.03202441e-01]
 [ 1.90402774e-01  8.41753907e-02]
 [-2.25894166e-02  1.82238486e-02]
 [ 7.12936472e-02 -1.05375031e-01]
 [-1.05839572e-01  2.58864150e-02]
 [-1.31052219e-01  3.19431414e-01]
 [ 2.63941866e-01  2.12760031e-01]
 [ 1.32481439e-01 -8.27564806e-02]
 [ 3.96509661e-02  5.82471568e-02]
 [ 2.04251055e-01  7.36119111e-02]
 [ 2.12137400e-02  3.25691495e-02]
 [-4.26477546e-01  1.72254128e-01]
 [ 1.41487810e-01  1.27751109e-02]
 [ 1.28733637e+00  1.33171376e-01]
 [ 1.66278908e-02  3.45341577e-01]
 [-1.17475215e-01  8.82126415e-02]
 [-1.04969994e-01  6.96763312e-02]
 [ 1.20401045e-01 -1.06697046e-01]
 [-1.68930289e-01 -4.12709144e-01]
 [ 5.10985925e-02  9.34662833e-02]
 [-1.31570054e-02  1.79990754e-01]
 [-5.88787993e-01 -8.35197610e-02]
 [-1.68259812e-01 -6.34799730e-02]
 [ 8.02958937e-03 -6.04998255e-02]
 [-1.76707485e-01  1.47295323e-01]
 [ 3.80757839e-03  1.05674488e-02]
 [-1.75533160e-03  3.64425283e-02]
 [-1.11158829e-01  1.17899337e-01]
 [-3.05416726e-02 -1.50075513e-01]
 [-1.21807285e-03 -5.33639499e-02]
 [-3.44572162e-03 -3.38446477e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.59552872]
curr_Stock_Price:  101.1487544374224
curr_Factors:  [1.01148754e+02 4.00399518e-02]
mat_Sqrt:  [[ 2.02398511e+01  0.00000000e+00]
 [-8.00399419e-03  1.83394546e-02]]
grads:  [ 0.05832969 14.68101145]
Stock Position:  0.05832969059855437
Bond Position:  [4.69555317]


portfolio before change:  [10.61443594]
curr_Stock_Price:  101.46283537952388
curr_Factors:  [1.01462835e+02 3.91885864e-02]
mat_Sqrt:  [[ 2.00856918e+01  0.00000000e+00]
 [-7.91844292e-03  1.81434320e-02]]
grads:  [-0.01287457 -4.44467311]
Stock Position:  -0.012874572756951067
Bond Position:  [11.9207266]


portfolio before change:  [10.61554019]
curr_Stock_Price:  101.49281254607983
curr_Factors:  [1.01492813e+02 3.86021345e-02]
mat_Sqrt:  [[ 1.99407252e+01  0.00000000e+00]
 [-7.85897037e-03  1.80071633e-02]]
grads:  [-0.00932802 -5.25940995]
Stock Position:  -0.009328022113436892
Bond Position:  [11.56226739]


portfolio before change:  [10.61960892]
curr_Stock_Price:  101.21157807071657
curr_Factors:  [1.01211578e+02 3.84431311e-02]
mat_Sqrt:  [[ 1.98444731e+01  0.00000000e+00]
 [-7.84276799e-03  1.79700390e-02]]
grads:  [-8.21456275e-04 -8.42440089e+00]
Stock Position:  -0.0008214562746017423
Bond Position:  [10.70274981]


portfolio before change:  [10.62041828]
curr_Stock_Price:  101.85503200407388
curr_Factors:  [1.01855032e+02 3.78352963e-02]
mat_Sqrt:  [[ 1.98121250e+01  0.00000000e+00]
 [-7.78051888e-03  1.78274084e-02]]
grads:  [-1.30799419e-02 -1.83888500e+01]
Stock Position:  -0.013079941867879896
Bond Position:  [11.95267618]


portfolio before change:  [10.62677137]
curr_Stock_Price:  101.48355365361587
curr_Factors:  [1.01483554e+02 3.63438168e-02]
mat_Sqrt:  [[ 1.93468798e+01  0.00000000e+00]
 [-7.62562174e-03  1.74724944e-02]]
grads:  [-0.01369709  9.36715105]
Stock Position:  -0.01369709180994802
Bond Position:  [12.01680092]


portfolio before change:  [10.64657317]
curr_Stock_Price:  100.14753282618888
curr_Factors:  [1.00147533e+02 3.81413958e-02]
mat_Sqrt:  [[ 1.95586352e+01  0.00000000e+00]
 [-7.81192891e-03  1.78993778e-02]]
grads:  [0.00601631 3.07446989]
Stock Position:  0.0060163054517870344
Bond Position:  [10.04405502]


portfolio before change:  [10.64319372]
curr_Stock_Price:  99.37712098844494
curr_Factors:  [9.93771210e+01 3.91914051e-02]
mat_Sqrt:  [[ 1.96735090e+01  0.00000000e+00]
 [-7.91872769e-03  1.81440845e-02]]
grads:  [ 0.04065747 32.67204716]
Stock Position:  0.04065747099219341
Bond Position:  [6.6027713]


portfolio before change:  [10.5978438]
curr_Stock_Price:  98.24140559355179
curr_Factors:  [9.82414056e+01 3.78062852e-02]
mat_Sqrt:  [[ 1.91019002e+01  0.00000000e+00]
 [-7.77753536e-03  1.78205723e-02]]
grads:  [6.3549849e-03 1.7014181e+01]
Stock Position:  0.006354984900139577
Bond Position:  [9.97352115]


portfolio before change:  [10.60185422]
curr_Stock_Price:  98.67628498787523
curr_Factors:  [9.86762850e+01 3.72337302e-02]
mat_Sqrt:  [[ 1.90406191e+01  0.00000000e+00]
 [-7.71841747e-03  1.76851162e-02]]
grads:  [0.01192923 4.75967418]
Stock Position:  0.01192923012665404
Bond Position:  [9.42472211]


portfolio before change:  [10.57613494]
curr_Stock_Price:  96.42153360305463
curr_Factors:  [9.64215336e+01 3.80415221e-02]
mat_Sqrt:  [[ 1.88062835e+01  0.00000000e+00]
 [-7.80169439e-03  1.78759276e-02]]
grads:  [-7.78243987e-04  1.01946310e+00]
Stock Position:  -0.0007782439871983573
Bond Position:  [10.65117442]


portfolio before change:  [10.57740233]
curr_Stock_Price:  96.50388733101231
curr_Factors:  [9.65038873e+01 4.00626481e-02]
mat_Sqrt:  [[ 1.93158860e+01  0.00000000e+00]
 [-8.00626236e-03  1.83446516e-02]]
grads:  [ 1.31002084e-03 -5.74418273e+00]
Stock Position:  0.0013100208396981227
Bond Position:  [10.45098022]


portfolio before change:  [10.5775949]
curr_Stock_Price:  95.65361318435772
curr_Factors:  [9.56536132e+01 3.97206414e-02]
mat_Sqrt:  [[ 1.90638014e+01  0.00000000e+00]
 [-7.97201520e-03  1.82661815e-02]]
grads:  [-0.00495923  1.41717714]
Stock Position:  -0.004959232023542298
Bond Position:  [11.05196336]


portfolio before change:  [10.57893346]
curr_Stock_Price:  95.66228940968932
curr_Factors:  [9.56622894e+01 3.94557497e-02]
mat_Sqrt:  [[ 1.90018515e+01  0.00000000e+00]
 [-7.94538857e-03  1.82051723e-02]]
grads:  [4.39908681e-04 1.75461902e+01]
Stock Position:  0.0004399086811020676
Bond Position:  [10.53685079]


portfolio before change:  [10.58002493]
curr_Stock_Price:  95.14919380349036
curr_Factors:  [9.51491938e+01 4.03386706e-02]
mat_Sqrt:  [[ 1.91102295e+01  0.00000000e+00]
 [-8.03379568e-03  1.84077384e-02]]
grads:  [ 0.01867052 11.55818421]
Stock Position:  0.018670521760347877
Bond Position:  [8.80353984]


portfolio before change:  [10.57875174]
curr_Stock_Price:  95.02205755680991
curr_Factors:  [9.50220576e+01 4.06490933e-02]
mat_Sqrt:  [[ 1.91579864e+01  0.00000000e+00]
 [-8.06464811e-03  1.84784302e-02]]
grads:  [ 0.00502994 -4.47854496]
Stock Position:  0.005029941454606667
Bond Position:  [10.10079635]


portfolio before change:  [10.58031724]
curr_Stock_Price:  95.08226205719816
curr_Factors:  [9.50822621e+01 4.10309252e-02]
mat_Sqrt:  [[ 1.92599502e+01  0.00000000e+00]
 [-8.10243669e-03  1.85650147e-02]]
grads:  [0.00337862 3.13746893]
Stock Position:  0.0033786229290383757
Bond Position:  [10.25907013]


portfolio before change:  [10.58321882]
curr_Stock_Price:  95.56148315459383
curr_Factors:  [9.55614832e+01 4.18478365e-02]
mat_Sqrt:  [[ 1.95487677e+01  0.00000000e+00]
 [-8.18269750e-03  1.87489153e-02]]
grads:  [0.0120917  3.92619571]
Stock Position:  0.012091704705869493
Bond Position:  [9.42771758]


portfolio before change:  [10.59382584]
curr_Stock_Price:  96.34123143931109
curr_Factors:  [9.63412314e+01 4.21793869e-02]
mat_Sqrt:  [[ 1.97861968e+01  0.00000000e+00]
 [-8.21504833e-03  1.88230404e-02]]
grads:  [0.00179055 1.73028102]
Stock Position:  0.0017905453258347055
Bond Position:  [10.4213225]


portfolio before change:  [10.59462302]
curr_Stock_Price:  96.05887748934212
curr_Factors:  [9.60588775e+01 4.38024455e-02]
mat_Sqrt:  [[ 2.01041949e+01  0.00000000e+00]
 [-8.37161352e-03  1.91817763e-02]]
grads:  [-0.01747395  8.98009262]
Stock Position:  -0.0174739492161362
Bond Position:  [12.27315097]


portfolio before change:  [10.57555867]
curr_Stock_Price:  97.23769462965946
curr_Factors:  [9.72376946e+01 4.34862280e-02]
mat_Sqrt:  [[ 2.02773185e+01  0.00000000e+00]
 [-8.34134071e-03  1.91124126e-02]]
grads:  [0.0072526  0.66841959]
Stock Position:  0.007252602232694827
Bond Position:  [9.87033235]


portfolio before change:  [10.57322088]
curr_Stock_Price:  96.74522917020919
curr_Factors:  [9.67452292e+01 4.39966356e-02]
mat_Sqrt:  [[ 2.02926746e+01  0.00000000e+00]
 [-8.39015000e-03  1.92242487e-02]]
grads:  [0.0663026  6.92726036]
Stock Position:  0.06630260179925289
Bond Position:  [4.15876048]


portfolio before change:  [10.59106629]
curr_Stock_Price:  97.00653921683468
curr_Factors:  [9.70065392e+01 4.38119576e-02]
mat_Sqrt:  [[ 2.03047357e+01  0.00000000e+00]
 [-8.37252245e-03  1.91838589e-02]]
grads:  [8.24178725e-03 1.80016741e+01]
Stock Position:  0.008241787249187916
Bond Position:  [9.79155904]


portfolio before change:  [10.59744605]
curr_Stock_Price:  97.63209984924914
curr_Factors:  [9.76320998e+01 4.61890232e-02]
mat_Sqrt:  [[ 2.09827313e+01  0.00000000e+00]
 [-8.59665267e-03  1.96974058e-02]]
grads:  [-3.76385997e-03  4.47838880e+00]
Stock Position:  -0.0037638599670824463
Bond Position:  [10.96491961]


portfolio before change:  [10.59523586]
curr_Stock_Price:  98.58348998026938
curr_Factors:  [9.85834900e+01 4.52620226e-02]
mat_Sqrt:  [[ 2.09735124e+01  0.00000000e+00]
 [-8.50994924e-03  1.94987433e-02]]
grads:  [-3.55499585e-03  3.57337548e+00]
Stock Position:  -0.00355499585464101
Bond Position:  [10.94569975]


portfolio before change:  [10.59861372]
curr_Stock_Price:  98.01821144728694
curr_Factors:  [9.80182114e+01 4.52216474e-02]
mat_Sqrt:  [[ 2.08439472e+01  0.00000000e+00]
 [-8.50615283e-03  1.94900446e-02]]
grads:  [ 3.54225787e-03 -5.47443828e+00]
Stock Position:  0.0035422578716515075
Bond Position:  [10.25140793]


portfolio before change:  [10.59989802]
curr_Stock_Price:  98.01900043158035
curr_Factors:  [9.80190004e+01 4.44289557e-02]
mat_Sqrt:  [[ 2.06606187e+01  0.00000000e+00]
 [-8.43127091e-03  1.93184686e-02]]
grads:  [-1.68945244e-02 -2.13634503e+01]
Stock Position:  -0.016894524426006943
Bond Position:  [12.25588241]


portfolio before change:  [10.59493716]
curr_Stock_Price:  98.40332256356422
curr_Factors:  [9.84033226e+01 4.30566197e-02]
mat_Sqrt:  [[ 2.04187771e+01  0.00000000e+00]
 [-8.30003563e-03  1.90177708e-02]]
grads:  [4.50030001e-03 4.91468135e+00]
Stock Position:  0.004500300013656139
Bond Position:  [10.15209268]


portfolio before change:  [10.60629743]
curr_Stock_Price:  100.64565782762803
curr_Factors:  [1.00645658e+02 4.20037499e-02]
mat_Sqrt:  [[ 2.06271428e+01  0.00000000e+00]
 [-8.19792656e-03  1.87838095e-02]]
grads:  [3.17045363e-03 9.58222846e+00]
Stock Position:  0.003170453631839393
Bond Position:  [10.28720504]


portfolio before change:  [10.61055449]
curr_Stock_Price:  101.58277101854837
curr_Factors:  [1.01582771e+02 4.08941665e-02]
mat_Sqrt:  [[ 2.05423789e+01  0.00000000e+00]
 [-8.08892245e-03  1.85340497e-02]]
grads:  [-0.03043654 -4.50628775]
Stock Position:  -0.030436543292645533
Bond Position:  [13.70238289]


portfolio before change:  [10.64188693]
curr_Stock_Price:  100.60961388496443
curr_Factors:  [1.00609614e+02 4.01091481e-02]
mat_Sqrt:  [[ 2.01493575e+01  0.00000000e+00]
 [-8.01090738e-03  1.83552947e-02]]
grads:  [-0.00972561 -3.45840118]
Stock Position:  -0.009725607594365216
Bond Position:  [11.62037655]


portfolio before change:  [10.65697866]
curr_Stock_Price:  99.20722376211928
curr_Factors:  [9.92072238e+01 4.11065002e-02]
mat_Sqrt:  [[ 2.01140047e+01  0.00000000e+00]
 [-8.10989521e-03  1.85821043e-02]]
grads:  [-9.13527638e-04 -3.25581132e+00]
Stock Position:  -0.0009135276375012072
Bond Position:  [10.7476072]


portfolio before change:  [10.65766927]
curr_Stock_Price:  99.92195503573217
curr_Factors:  [9.99219550e+01 4.02271571e-02]
mat_Sqrt:  [[ 2.00410556e+01  0.00000000e+00]
 [-8.02268355e-03  1.83822773e-02]]
grads:  [-5.60961150e-03  8.01289854e+00]
Stock Position:  -0.005609611501819278
Bond Position:  [11.21819262]


portfolio before change:  [10.67063174]
curr_Stock_Price:  97.8611878777171
curr_Factors:  [9.78611879e+01 4.00659610e-02]
mat_Sqrt:  [[ 1.95883685e+01  0.00000000e+00]
 [-8.00659339e-03  1.83454101e-02]]
grads:  [4.29826055e-04 5.76026849e-01]
Stock Position:  0.0004298260548151914
Bond Position:  [10.62856845]


portfolio before change:  [10.67239408]
curr_Stock_Price:  98.87016652658303
curr_Factors:  [9.88701665e+01 4.01640911e-02]
mat_Sqrt:  [[ 1.98145511e+01  0.00000000e+00]
 [-8.01639232e-03  1.83678623e-02]]
grads:  [7.14096001e-04 1.98403754e+00]
Stock Position:  0.0007140960013037875
Bond Position:  [10.60179129]


portfolio before change:  [10.67327802]
curr_Stock_Price:  98.25209634880153
curr_Factors:  [9.82520963e+01 4.07525536e-02]
mat_Sqrt:  [[ 1.98344078e+01  0.00000000e+00]
 [-8.07490469e-03  1.85019310e-02]]
grads:  [-3.01008936e-03  6.37227199e+00]
Stock Position:  -0.003010089355449987
Bond Position:  [10.96902561]


portfolio before change:  [10.67096071]
curr_Stock_Price:  99.47748339571584
curr_Factors:  [9.94774834e+01 3.94776095e-02]
mat_Sqrt:  [[ 1.97651545e+01  0.00000000e+00]
 [-7.94758927e-03  1.82102147e-02]]
grads:  [-4.85905619e-03 -8.24128190e+00]
Stock Position:  -0.0048590561901131
Bond Position:  [11.15432739]


portfolio before change:  [10.65903231]
curr_Stock_Price:  102.21932759363297
curr_Factors:  [1.02219328e+02 3.93307302e-02]
mat_Sqrt:  [[ 2.02721133e+01  0.00000000e+00]
 [-7.93279070e-03  1.81763069e-02]]
grads:  [-1.20895190e-03 -2.93590717e+00]
Stock Position:  -0.0012089519048599344
Bond Position:  [10.78261056]


portfolio before change:  [10.65921005]
curr_Stock_Price:  103.18724894135615
curr_Factors:  [1.03187249e+02 4.05626227e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.65921005]
Stock Price:  102.11579108325772
PL:  [8.54341897]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.27804137e+00  3.17840762e-01]
 [ 6.17675805e-01  1.14120759e-01]
 [ 1.10778028e-01 -4.72420150e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.50787258e-02  1.29442433e-01]
 [-9.50733259e-02 -9.89605910e-02]
 [ 8.75455098e-02  9.59394385e-02]
 [ 6.92501184e-01  6.87723285e-01]
 [-6.14334882e-02  1.36505244e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-6.07947028e-02  1.40160769e-02]
 [ 4.21873027e-02 -1.38388866e-01]
 [-1.18121145e-01 -2.68199093e-02]
 [-4.76948578e-02 -3.43890580e-02]
 [ 5.19188258e-01  3.40693359e-01]
 [ 1.32386363e-01 -2.57659797e-01]
 [ 3.95036175e-02  8.44251387e-02]
 [ 1.98239121e-02 -1.24189554e-01]
 [-7.74699290e-02 -2.35804249e-01]
 [-9.02691679e-02 -2.52456292e-02]
 [ 1.76689275e-01 -4.46819916e-02]
 [ 8.94047967e-01  2.54087125e-02]
 [ 2.90054649e-02 -3.35158774e-01]
 [ 5.77647616e-02  1.00221593e-02]
 [ 3.23537492e-01 -2.22940917e-01]
 [-5.27022989e-02 -2.95877144e-02]
 [-1.88533119e-01 -9.69303116e-03]
 [ 4.64227719e-02  2.71992077e-01]
 [-2.63781252e-02  1.86830100e-01]
 [-6.01074322e-01 -7.95781496e-02]
 [-1.64661210e-01 -5.32748428e-02]
 [ 5.11192024e-02 -3.42280376e-02]
 [-2.67691809e-01  7.53604440e-02]
 [ 6.97703588e-02  5.87737899e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.53732971e-01  6.17663016e-02]
 [-1.98467774e-02 -2.47128973e-01]
 [-1.52843781e-02 -3.07491939e-02]
 [-4.25084891e-02 -8.66828488e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.1926464]
curr_Stock_Price:  100.21934427787768
curr_Factors:  [1.00219344e+02 4.16937536e-02]
mat_Sqrt:  [[ 2.04638364e+01  0.00000000e+00]
 [-8.16761935e-03  1.87143670e-02]]
grads:  [ 0.0692323  16.98378379]
Stock Position:  0.06923229951831622
Bond Position:  [-2.74576926]


portfolio before change:  [4.14435644]
curr_Stock_Price:  99.52679583513728
curr_Factors:  [9.95267958e+01 4.26856740e-02]
mat_Sqrt:  [[ 2.05627452e+01  0.00000000e+00]
 [-8.26420464e-03  1.89356717e-02]]
grads:  [0.03246075 6.02676057]
Stock Position:  0.032460752750275046
Bond Position:  [0.91364173]


portfolio before change:  [4.13814165]
curr_Stock_Price:  99.33182188058726
curr_Factors:  [9.93318219e+01 4.31714092e-02]
mat_Sqrt:  [[ 2.06388984e+01  0.00000000e+00]
 [-8.31109227e-03  1.90431047e-02]]
grads:  [ 0.00436845 -2.48079374]
Stock Position:  0.004368446426075842
Bond Position:  [3.70421591]


portfolio before change:  [4.14233641]
curr_Stock_Price:  100.18606280470472
curr_Factors:  [1.00186063e+02 4.42108561e-02]
mat_Sqrt:  [[ 2.10655000e+01  0.00000000e+00]
 [-8.41055110e-03  1.92709935e-02]]
grads:  [-7.73841919e-04 -7.85568281e+00]
Stock Position:  -0.000773841919354325
Bond Position:  [4.21986459]


portfolio before change:  [4.14294507]
curr_Stock_Price:  100.0812067557033
curr_Factors:  [1.00081207e+02 4.35083688e-02]
mat_Sqrt:  [[ 2.08755984e+01  0.00000000e+00]
 [-8.34346391e-03  1.91172775e-02]]
grads:  [-1.36932202e-03  6.77096584e+00]
Stock Position:  -0.0013693220201624308
Bond Position:  [4.27998847]


portfolio before change:  [4.14474694]
curr_Stock_Price:  99.15605273081863
curr_Factors:  [9.91560527e+01 4.35134565e-02]
mat_Sqrt:  [[ 2.06838329e+01  0.00000000e+00]
 [-8.34395172e-03  1.91183952e-02]]
grads:  [-0.00668461 -5.17619759]
Stock Position:  -0.0066846057586206365
Bond Position:  [4.80756606]


portfolio before change:  [4.14573287]
curr_Stock_Price:  99.09846527743522
curr_Factors:  [9.90984653e+01 4.38809374e-02]
mat_Sqrt:  [[ 2.07589258e+01  0.00000000e+00]
 [-8.37911092e-03  1.91989550e-02]]
grads:  [0.00623428 4.99711773]
Stock Position:  0.006234277952252986
Bond Position:  [3.52792549]


portfolio before change:  [4.14437618]
curr_Stock_Price:  98.81010729832299
curr_Factors:  [9.88101073e+01 4.45891590e-02]
mat_Sqrt:  [[ 2.08648858e+01  0.00000000e+00]
 [-8.44645810e-03  1.93532668e-02]]
grads:  [ 0.04757506 35.53525573]
Stock Position:  0.04757506193869526
Bond Position:  [-0.55652079]


portfolio before change:  [4.18105434]
curr_Stock_Price:  99.58252306604867
curr_Factors:  [9.95825231e+01 4.25601781e-02]
mat_Sqrt:  [[ 2.05439923e+01  0.00000000e+00]
 [-8.25204732e-03  1.89078157e-02]]
grads:  [-9.04262177e-05  7.21951418e+00]
Stock Position:  -9.042621769502008e-05
Bond Position:  [4.19005921]


portfolio before change:  [4.18174246]
curr_Stock_Price:  97.76529662914882
curr_Factors:  [9.77652966e+01 4.38600730e-02]
mat_Sqrt:  [[ 2.04747872e+01  0.00000000e+00]
 [-8.37711865e-03  1.91943902e-02]]
grads:  [0.01203598 5.89112405]
Stock Position:  0.012035982790745931
Bond Position:  [3.00504103]


portfolio before change:  [4.18044334]
curr_Stock_Price:  97.62614937851338
curr_Factors:  [9.76261494e+01 4.47281893e-02]
mat_Sqrt:  [[ 2.06469934e+01  0.00000000e+00]
 [-8.45961600e-03  1.93834153e-02]]
grads:  [-0.00264821  0.72309635]
Stock Position:  -0.0026482105345634215
Bond Position:  [4.43897793]


portfolio before change:  [4.1806645]
curr_Stock_Price:  97.75217425013551
curr_Factors:  [9.77521743e+01 4.70452056e-02]
mat_Sqrt:  [[ 2.12023555e+01  0.00000000e+00]
 [-8.67596271e-03  1.98791279e-02]]
grads:  [-8.58892784e-04 -6.96151595e+00]
Stock Position:  -0.0008588927836029535
Bond Position:  [4.26462314]


portfolio before change:  [4.18177613]
curr_Stock_Price:  97.07861905796852
curr_Factors:  [9.70786191e+01 4.87007384e-02]
mat_Sqrt:  [[ 2.14235463e+01  0.00000000e+00]
 [-8.82729752e-03  2.02258795e-02]]
grads:  [-0.00605998 -1.32601943]
Stock Position:  -0.0060599823532102364
Bond Position:  [4.77007084]


portfolio before change:  [4.16688656]
curr_Stock_Price:  99.63404878653941
curr_Factors:  [9.96340488e+01 4.69549121e-02]
mat_Sqrt:  [[ 2.15897839e+01  0.00000000e+00]
 [-8.66763285e-03  1.98600418e-02]]
grads:  [-0.00290431 -1.73157027]
Stock Position:  -0.0029043122243652105
Bond Position:  [4.45625495]


portfolio before change:  [4.17026227]
curr_Stock_Price:  98.66354755769966
curr_Factors:  [9.86635476e+01 4.65028578e-02]
mat_Sqrt:  [[ 2.12763217e+01  0.00000000e+00]
 [-8.62580851e-03  1.97642102e-02]]
grads:  [ 0.03139072 17.2378939 ]
Stock Position:  0.03139071869673219
Bond Position:  [1.0731426]


portfolio before change:  [4.21886082]
curr_Stock_Price:  100.20745603266305
curr_Factors:  [1.00207456e+02 4.64498687e-02]
mat_Sqrt:  [[ 2.15969430e+01  0.00000000e+00]
 [-8.62089264e-03  1.97529466e-02]]
grads:  [ 9.23019894e-04 -1.30441196e+01]
Stock Position:  0.0009230198944871187
Bond Position:  [4.12636734]


portfolio before change:  [4.21916367]
curr_Stock_Price:  99.97672019416915
curr_Factors:  [9.99767202e+01 4.61317911e-02]
mat_Sqrt:  [[ 2.14733125e+01  0.00000000e+00]
 [-8.59132503e-03  1.96851986e-02]]
grads:  [3.55556549e-03 4.28876235e+00]
Stock Position:  0.0035555654939042384
Bond Position:  [3.86368989]


portfolio before change:  [4.22166066]
curr_Stock_Price:  100.54315675162735
curr_Factors:  [1.00543157e+02 4.47622321e-02]
mat_Sqrt:  [[ 2.12720029e+01  0.00000000e+00]
 [-8.46283471e-03  1.93907903e-02]]
grads:  [-1.61606093e-03 -6.40456381e+00]
Stock Position:  -0.0016160609329905035
Bond Position:  [4.38414453]


portfolio before change:  [4.22384169]
curr_Stock_Price:  99.53269374728987
curr_Factors:  [9.95326937e+01 4.46652984e-02]
mat_Sqrt:  [[ 2.10354050e+01  0.00000000e+00]
 [-8.45366651e-03  1.93697833e-02]]
grads:  [-8.57522546e-03 -1.21738196e+01]
Stock Position:  -0.008575225463497538
Bond Position:  [5.07735698]


portfolio before change:  [4.22769837]
curr_Stock_Price:  99.15696300346578
curr_Factors:  [9.91569630e+01 4.51046472e-02]
mat_Sqrt:  [[ 2.10588117e+01  0.00000000e+00]
 [-8.49514188e-03  1.94648153e-02]]
grads:  [-0.00480973 -1.29698786]
Stock Position:  -0.004809733099381433
Bond Position:  [4.7046169]


portfolio before change:  [4.22701725]
curr_Stock_Price:  99.42085287947953
curr_Factors:  [9.94208529e+01 4.34432253e-02]
mat_Sqrt:  [[ 2.07223266e+01  0.00000000e+00]
 [-8.33721540e-03  1.91029603e-02]]
grads:  [ 0.00758546 -2.33900876]
Stock Position:  0.007585463647029484
Bond Position:  [3.47286398]


portfolio before change:  [4.22803102]
curr_Stock_Price:  99.49726671380411
curr_Factors:  [9.94972667e+01 4.22197815e-02]
mat_Sqrt:  [[ 2.04441539e+01  0.00000000e+00]
 [-8.21898110e-03  1.88320515e-02]]
grads:  [0.04427365 1.34922701]
Stock Position:  0.04427364632912928
Bond Position:  [-0.17707578]


portfolio before change:  [4.29823158]
curr_Stock_Price:  101.08337280247285
curr_Factors:  [1.01083373e+02 4.08665932e-02]
mat_Sqrt:  [[ 2.04344965e+01  0.00000000e+00]
 [-8.08619497e-03  1.85278003e-02]]
grads:  [-5.73881604e-03 -1.80895071e+01]
Stock Position:  -0.005738816036800431
Bond Position:  [4.87833046]


portfolio before change:  [4.29298919]
curr_Stock_Price:  102.10313308870599
curr_Factors:  [1.02103133e+02 4.06979451e-02]
mat_Sqrt:  [[ 2.05980121e+01  0.00000000e+00]
 [-8.06949268e-03  1.84895305e-02]]
grads:  [0.00301674 0.54204509]
Stock Position:  0.0030167372497434553
Bond Position:  [3.98497087]


portfolio before change:  [4.29333804]
curr_Stock_Price:  102.05364176333094
curr_Factors:  [1.02053642e+02 4.29001621e-02]
mat_Sqrt:  [[ 2.11377119e+01  0.00000000e+00]
 [-8.28494172e-03  1.89831863e-02]]
grads:  [ 1.07030553e-02 -1.17441252e+01]
Stock Position:  0.010703055317071246
Bond Position:  [3.20105227]


portfolio before change:  [4.30008512]
curr_Stock_Price:  102.6466428411592
curr_Factors:  [1.02646643e+02 4.21946719e-02]
mat_Sqrt:  [[ 2.10849976e+01  0.00000000e+00]
 [-8.21653668e-03  1.88264506e-02]]
grads:  [-0.00311195 -1.57160343]
Stock Position:  -0.0031119489418845857
Bond Position:  [4.61951623]


portfolio before change:  [4.30323642]
curr_Stock_Price:  101.81956520922057
curr_Factors:  [1.01819565e+02 4.16502098e-02]
mat_Sqrt:  [[ 2.07797269e+01  0.00000000e+00]
 [-8.16335322e-03  1.87045920e-02]]
grads:  [-0.00927652 -0.51821666]
Stock Position:  -0.009276517709110628
Bond Position:  [5.24776742]


portfolio before change:  [4.30795314]
curr_Stock_Price:  101.38182443466319
curr_Factors:  [1.01381824e+02 4.06688584e-02]
mat_Sqrt:  [[ 2.04451873e+01  0.00000000e+00]
 [-8.06660855e-03  1.84829221e-02]]
grads:  [8.07670987e-03 1.47158590e+01]
Stock Position:  0.008076709872965823
Bond Position:  [3.48912156]


portfolio before change:  [4.31036598]
curr_Stock_Price:  101.62656195940903
curr_Factors:  [1.01626562e+02 3.94884042e-02]
mat_Sqrt:  [[ 2.01949148e+01  0.00000000e+00]
 [-7.94867578e-03  1.82127042e-02]]
grads:  [2.73144086e-03 1.02582295e+01]
Stock Position:  0.0027314408608658794
Bond Position:  [4.03277904]


portfolio before change:  [4.31130191]
curr_Stock_Price:  101.7846447152057
curr_Factors:  [1.01784645e+02 3.92570804e-02]
mat_Sqrt:  [[ 2.01669984e+01  0.00000000e+00]
 [-7.92535985e-03  1.81592807e-02]]
grads:  [-0.03152701 -4.38223027]
Stock Position:  -0.03152700569633988
Bond Position:  [7.52026698]


portfolio before change:  [4.29549943]
curr_Stock_Price:  102.31569958974852
curr_Factors:  [1.02315700e+02 3.80710709e-02]
mat_Sqrt:  [[ 1.99636444e+01  0.00000000e+00]
 [-7.80472379e-03  1.78828688e-02]]
grads:  [-0.00941272 -2.97909935]
Stock Position:  -0.009412723135162674
Bond Position:  [5.25856878]


portfolio before change:  [4.29184815]
curr_Stock_Price:  102.77344646097276
curr_Factors:  [1.02773446e+02 3.75415815e-02]
mat_Sqrt:  [[ 1.99130233e+01  0.00000000e+00]
 [-7.75026002e-03  1.77580766e-02]]
grads:  [ 1.81694470e-03 -1.92746312e+00]
Stock Position:  0.001816944697435204
Bond Position:  [4.10511448]


portfolio before change:  [4.29313103]
curr_Stock_Price:  103.19707709183713
curr_Factors:  [1.03197077e+02 3.52238302e-02]
mat_Sqrt:  [[ 1.93680406e+01  0.00000000e+00]
 [-7.50720510e-03  1.72011678e-02]]
grads:  [-0.01212316  4.3811237 ]
Stock Position:  -0.012123157945616034
Bond Position:  [5.5442055]


portfolio before change:  [4.30518976]
curr_Stock_Price:  102.25956056286597
curr_Factors:  [1.02259561e+02 3.62637879e-02]
mat_Sqrt:  [[ 1.94733426e+01  0.00000000e+00]
 [-7.61722132e-03  1.74532466e-02]]
grads:  [0.0049001  3.36749896]
Stock Position:  0.00490010089914582
Bond Position:  [3.8041076]


portfolio before change:  [4.30499878]
curr_Stock_Price:  102.12353874596226
curr_Factors:  [1.02123539e+02 3.70875750e-02]
mat_Sqrt:  [[ 1.96670886e+01  0.00000000e+00]
 [-7.70325385e-03  1.76503719e-02]]
grads:  [-0.0048135   4.60755991]
Stock Position:  -0.004813504061355742
Bond Position:  [4.79657085]


portfolio before change:  [4.30716342]
curr_Stock_Price:  101.79840628001496
curr_Factors:  [1.01798406e+02 3.55601332e-02]
mat_Sqrt:  [[ 1.91965272e+01  0.00000000e+00]
 [-7.54295785e-03  1.72830877e-02]]
grads:  [-0.01181338  3.57380017]
Stock Position:  -0.011813383996365603
Bond Position:  [5.50974708]


portfolio before change:  [4.30972509]
curr_Stock_Price:  101.63986464595355
curr_Factors:  [1.01639865e+02 3.61935651e-02]
mat_Sqrt:  [[ 1.93365842e+01  0.00000000e+00]
 [-7.60984258e-03  1.74363398e-02]]
grads:  [-6.60420175e-03 -1.41732138e+01]
Stock Position:  -0.006604201746405737
Bond Position:  [4.98097527]


portfolio before change:  [4.32237154]
curr_Stock_Price:  99.8192385405847
curr_Factors:  [9.98192385e+01 3.67458558e-02]
mat_Sqrt:  [[ 1.91345580e+01  0.00000000e+00]
 [-7.66768343e-03  1.75688699e-02]]
grads:  [-1.50013533e-03 -1.75020899e+00]
Stock Position:  -0.0015001353296683856
Bond Position:  [4.4721139]


portfolio before change:  [4.32118771]
curr_Stock_Price:  100.98105290282996
curr_Factors:  [1.00981053e+02 3.64364429e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.32118771]
Stock Price:  102.32053545279116
PL:  [2.00065225]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.12994927e+00  2.84360105e-01]
 [ 6.99295189e-02  4.79037351e-02]
 [-1.36397795e-01 -9.23306211e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.16819386e-01 -3.46360288e-01]
 [-3.85659550e-01  2.23579900e-01]
 [ 3.01956333e-01 -3.48632056e-01]
 [-6.36968949e-01  1.27253082e-01]
 [-1.11035030e-01 -9.38696365e-02]
 [-2.43824124e-01 -5.08864861e-01]
 [-3.81939249e-02 -1.67058700e-02]
 [-2.53602026e-01 -2.50771101e-01]
 [-4.13821862e-02 -3.72980868e-02]
 [ 2.25068984e-02 -1.93156379e-01]
 [-1.30721944e-01 -1.13298072e-01]
 [ 8.80528005e-02 -1.06487366e+00]
 [ 1.04198136e-02 -4.57667485e-01]
 [ 6.32763636e-02 -1.90322287e-01]
 [-9.70621666e-02 -6.96489432e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 7.94998244e-02 -8.45483541e-03]
 [ 2.91204642e-01 -4.61410138e-01]
 [ 2.72312626e-02 -3.40066746e-01]
 [ 2.82680941e-02  7.46665049e-02]
 [ 4.57081128e-01 -4.53946397e-01]
 [-3.44750405e-01  3.85987076e-02]
 [-1.25585735e-01  1.88707180e-01]
 [-1.34096587e-01 -2.62441578e-01]
 [-7.37517084e-02  2.28480300e-01]
 [-6.27639164e-01  3.62510845e-01]
 [-1.16979696e-01  2.24265793e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.57889614e-01  4.65934121e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.77562089e-01 -5.02019695e-02]
 [-3.00440788e-02 -1.53114385e-01]
 [-1.74882858e-03 -6.42404759e-02]
 [ 2.19789527e-01 -1.12757304e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.58995699]
curr_Stock_Price:  100.85763574320306
curr_Factors:  [1.00857636e+02 3.99841704e-02]
mat_Sqrt:  [[ 2.01675354e+01  0.00000000e+00]
 [-7.99841689e-03  1.83266754e-02]]
grads:  [ 0.06218183 15.51618605]
Stock Position:  0.06218182666330397
Bond Position:  [2.31844497]


portfolio before change:  [8.58896031]
curr_Stock_Price:  100.83694624947849
curr_Factors:  [1.00836946e+02 3.93705596e-02]
mat_Sqrt:  [[ 2.00080829e+01  0.00000000e+00]
 [-7.93680637e-03  1.81855080e-02]]
grads:  [0.00453999 2.63417085]
Stock Position:  0.004539986327603082
Bond Position:  [8.13116195]


portfolio before change:  [8.59282766]
curr_Stock_Price:  101.46489978201832
curr_Factors:  [1.01464900e+02 4.10233116e-02]
mat_Sqrt:  [[ 2.05509162e+01  0.00000000e+00]
 [-8.10168493e-03  1.85632922e-02]]
grads:  [-0.00859787 -4.97382792]
Stock Position:  -0.00859787366875046
Bond Position:  [9.46521005]


portfolio before change:  [8.59309638]
curr_Stock_Price:  101.57126482537356
curr_Factors:  [1.01571265e+02 4.20514442e-02]
mat_Sqrt:  [[ 2.08286594e+01  0.00000000e+00]
 [-8.20257952e-03  1.87944708e-02]]
grads:  [-7.82641198e-04 -8.05485902e+00]
Stock Position:  -0.0007826411982243159
Bond Position:  [8.67259023]


portfolio before change:  [8.59390296]
curr_Stock_Price:  101.92590499116524
curr_Factors:  [1.01925905e+02 4.23865762e-02]
mat_Sqrt:  [[ 2.09845058e+01  0.00000000e+00]
 [-8.23520017e-03  1.88692141e-02]]
grads:  [-1.27705371e-02 -1.83558407e+01]
Stock Position:  -0.01277053705137239
Bond Position:  [9.89555151]


portfolio before change:  [8.58711877]
curr_Stock_Price:  102.55400798923854
curr_Factors:  [1.02554008e+02 4.12530182e-02]
mat_Sqrt:  [[ 2.08295795e+01  0.00000000e+00]
 [-8.12433561e-03  1.86151915e-02]]
grads:  [-0.01383039 12.0106151 ]
Stock Position:  -0.013830393566668207
Bond Position:  [10.00548106]


portfolio before change:  [8.57937168]
curr_Stock_Price:  103.20459343178089
curr_Factors:  [1.03204593e+02 4.13457026e-02]
mat_Sqrt:  [[ 2.09852533e+01  0.00000000e+00]
 [-8.13345708e-03  1.86360914e-02]]
grads:  [ 7.13838557e-03 -1.87073592e+01]
Stock Position:  0.007138385566356346
Bond Position:  [7.8426575]


portfolio before change:  [8.58305872]
curr_Stock_Price:  103.5837604659698
curr_Factors:  [1.0358376e+02 4.1592228e-02]
mat_Sqrt:  [[ 2.11250510e+01  0.00000000e+00]
 [-8.15766908e-03  1.86915680e-02]]
grads:  [-0.0275233   6.80804746]
Stock Position:  -0.027523301632788103
Bond Position:  [11.4340258]


portfolio before change:  [8.58055125]
curr_Stock_Price:  103.72679608831949
curr_Factors:  [1.03726796e+02 4.16398435e-02]
mat_Sqrt:  [[ 2.11663273e+01  0.00000000e+00]
 [-8.16233727e-03  1.87022642e-02]]
grads:  [-0.00718136 -5.01915894]
Stock Position:  -0.007181363834551897
Bond Position:  [9.32545111]


portfolio before change:  [8.58717488]
curr_Stock_Price:  102.96679028142005
curr_Factors:  [1.02966790e+02 4.26407175e-02]
mat_Sqrt:  [[ 2.12622601e+01  0.00000000e+00]
 [-8.25985157e-03  1.89256975e-02]]
grads:  [-2.19125791e-02 -2.68875089e+01]
Stock Position:  -0.02191257910263157
Bond Position:  [10.84344281]


portfolio before change:  [8.53836034]
curr_Stock_Price:  105.25634497255983
curr_Factors:  [1.05256345e+02 4.17112766e-02]
mat_Sqrt:  [[ 2.14968599e+01  0.00000000e+00]
 [-8.16933550e-03  1.87182992e-02]]
grads:  [-0.00211589 -0.89248867]
Stock Position:  -0.0021158887625129102
Bond Position:  [8.76107106]


portfolio before change:  [8.5394907]
curr_Stock_Price:  105.23973005433405
curr_Factors:  [1.05239730e+02 4.25283444e-02]
mat_Sqrt:  [[ 2.17029597e+01  0.00000000e+00]
 [-8.24896060e-03  1.89007432e-02]]
grads:  [ -0.01672802 -13.26779053]
Stock Position:  -0.016728018348851563
Bond Position:  [10.29994284]


portfolio before change:  [8.54217525]
curr_Stock_Price:  105.156219040974
curr_Factors:  [1.05156219e+02 4.07952956e-02]
mat_Sqrt:  [[ 2.12392905e+01  0.00000000e+00]
 [-8.07913814e-03  1.85116310e-02]]
grads:  [-0.0027148  -2.01484606]
Stock Position:  -0.002714799059486478
Bond Position:  [8.82765325]


portfolio before change:  [8.54093874]
curr_Stock_Price:  106.0181740832182
curr_Factors:  [1.06018174e+02 3.94425257e-02]
mat_Sqrt:  [[ 2.10553604e+01  0.00000000e+00]
 [-7.94405697e-03  1.82021212e-02]]
grads:  [-2.93480879e-03 -1.06117511e+01]
Stock Position:  -0.0029348087947897437
Bond Position:  [8.85208181]


portfolio before change:  [8.54131697]
curr_Stock_Price:  106.26635120963192
curr_Factors:  [1.06266351e+02 4.00309891e-02]
mat_Sqrt:  [[ 2.12615014e+01  0.00000000e+00]
 [-8.00309831e-03  1.83374019e-02]]
grads:  [-0.00847397 -6.1785237 ]
Stock Position:  -0.00847396770876293
Bond Position:  [9.4418146]


portfolio before change:  [8.54106122]
curr_Stock_Price:  106.43581648943167
curr_Factors:  [1.06435816e+02 4.00654874e-02]
mat_Sqrt:  [[ 2.13045817e+01  0.00000000e+00]
 [-8.00654606e-03  1.83453017e-02]]
grads:  [-1.76814628e-02 -5.80461244e+01]
Stock Position:  -0.017681462784473308
Bond Position:  [10.42300215]


portfolio before change:  [8.51865739]
curr_Stock_Price:  107.77658762818125
curr_Factors:  [1.07776588e+02 3.96618348e-02]
mat_Sqrt:  [[ 2.14640084e+01  0.00000000e+00]
 [-7.96611171e-03  1.82526549e-02]]
grads:  [-8.82047048e-03 -2.50740228e+01]
Stock Position:  -0.008820470482359736
Bond Position:  [9.4692976]


portfolio before change:  [8.52020661]
curr_Stock_Price:  107.73515113189966
curr_Factors:  [1.07735151e+02 4.12991197e-02]
mat_Sqrt:  [[ 2.18941366e+01  0.00000000e+00]
 [-8.12887394e-03  1.86255901e-02]]
grads:  [-9.03762163e-04 -1.02183225e+01]
Stock Position:  -0.0009037621629085371
Bond Position:  [8.61757357]


portfolio before change:  [8.52130418]
curr_Stock_Price:  107.71268110800621
curr_Factors:  [1.07712681e+02 4.10200917e-02]
mat_Sqrt:  [[ 2.18154989e+01  0.00000000e+00]
 [-8.10136697e-03  1.85625637e-02]]
grads:  [-0.00584261 -3.75211875]
Stock Position:  -0.005842610241590719
Bond Position:  [9.1506274]


portfolio before change:  [8.52406448]
curr_Stock_Price:  107.43602396564795
curr_Factors:  [1.07436024e+02 4.16269560e-02]
mat_Sqrt:  [[ 2.19198337e+01  0.00000000e+00]
 [-8.16107405e-03  1.86993698e-02]]
grads:  [-2.21083202e-04 -5.83406770e+00]
Stock Position:  -0.00022108320164887385
Bond Position:  [8.54781678]


portfolio before change:  [8.52508708]
curr_Stock_Price:  107.64386689215382
curr_Factors:  [1.07643867e+02 4.19812624e-02]
mat_Sqrt:  [[ 2.20555066e+01  0.00000000e+00]
 [-8.19573181e-03  1.87787807e-02]]
grads:  [ 0.00343723 -0.45023346]
Stock Position:  0.003437229219935468
Bond Position:  [8.15509043]


portfolio before change:  [8.52229277]
curr_Stock_Price:  106.53432353969998
curr_Factors:  [1.06534324e+02 4.09105667e-02]
mat_Sqrt:  [[ 2.15480166e+01  0.00000000e+00]
 [-8.09054428e-03  1.85377658e-02]]
grads:  [ 4.16877110e-03 -2.48902777e+01]
Stock Position:  0.004168771101027984
Bond Position:  [8.07817556]


portfolio before change:  [8.5227567]
curr_Stock_Price:  106.40337101597144
curr_Factors:  [1.06403371e+02 4.12538581e-02]
mat_Sqrt:  [[ 2.16116374e+01  0.00000000e+00]
 [-8.12441831e-03  1.86153809e-02]]
grads:  [-5.60744339e-03 -1.82680520e+01]
Stock Position:  -0.0056074433941620755
Bond Position:  [9.11940758]


portfolio before change:  [8.53041213]
curr_Stock_Price:  105.24144451083534
curr_Factors:  [1.05241445e+02 4.23260790e-02]
mat_Sqrt:  [[ 2.16516411e+01  0.00000000e+00]
 [-8.22932114e-03  1.88557435e-02]]
grads:  [2.81065200e-03 3.95988123e+00]
Stock Position:  0.0028106520036212277
Bond Position:  [8.23461505]


portfolio before change:  [8.53340232]
curr_Stock_Price:  105.93907494911787
curr_Factors:  [1.05939075e+02 4.13600184e-02]
mat_Sqrt:  [[ 2.15450020e+01  0.00000000e+00]
 [-8.13486505e-03  1.86393174e-02]]
grads:  [ 1.20196173e-02 -2.43542393e+01]
Stock Position:  0.01201961727899376
Bond Position:  [7.26005518]


portfolio before change:  [8.52449016]
curr_Stock_Price:  105.12210012677967
curr_Factors:  [1.05122100e+02 4.18357729e-02]
mat_Sqrt:  [[ 2.15014588e+01  0.00000000e+00]
 [-8.18151799e-03  1.87462127e-02]]
grads:  [-0.01525034  2.05901363]
Stock Position:  -0.015250339555204846
Bond Position:  [10.12763788]


portfolio before change:  [8.50064998]
curr_Stock_Price:  106.76837204176921
curr_Factors:  [1.06768372e+02 4.33141293e-02]
mat_Sqrt:  [[ 2.22206836e+01  0.00000000e+00]
 [-8.32481873e-03  1.90745560e-02]]
grads:  [-1.94535733e-03  9.89313617e+00]
Stock Position:  -0.0019453573315263751
Bond Position:  [8.70835262]


portfolio before change:  [8.50067286]
curr_Stock_Price:  107.31621033867046
curr_Factors:  [1.07316210e+02 4.41127478e-02]
mat_Sqrt:  [[ 2.25396612e+01  0.00000000e+00]
 [-8.40121399e-03  1.92495995e-02]]
grads:  [-1.10310213e-02 -1.36336124e+01]
Stock Position:  -0.01103102129249047
Bond Position:  [9.68448026]


portfolio before change:  [8.49213945]
curr_Stock_Price:  108.19954117144277
curr_Factors:  [1.08199541e+02 4.49388537e-02]
mat_Sqrt:  [[ 2.29369894e+01  0.00000000e+00]
 [-8.47951448e-03  1.94290085e-02]]
grads:  [1.13202605e-03 1.17597509e+01]
Stock Position:  0.0011320260495972546
Bond Position:  [8.36965475]


portfolio before change:  [8.49124719]
curr_Stock_Price:  106.4870987880818
curr_Factors:  [1.06487099e+02 4.49949655e-02]
mat_Sqrt:  [[ 2.25880612e+01  0.00000000e+00]
 [-8.48480670e-03  1.94411345e-02]]
grads:  [-0.02078206 18.64658902]
Stock Position:  -0.020782060742855334
Bond Position:  [10.70426855]


portfolio before change:  [8.48676959]
curr_Stock_Price:  106.76694197867495
curr_Factors:  [1.06766942e+02 4.40562857e-02]
mat_Sqrt:  [[ 2.24099426e+01  0.00000000e+00]
 [-8.39583571e-03  1.92372763e-02]]
grads:  [-0.00478323  1.16578766]
Stock Position:  -0.004783231086910733
Bond Position:  [8.99746055]


portfolio before change:  [8.49508208]
curr_Stock_Price:  105.26424757222507
curr_Factors:  [1.05264248e+02 4.40267697e-02]
mat_Sqrt:  [[ 2.20871307e+01  0.00000000e+00]
 [-8.39302278e-03  1.92308311e-02]]
grads:  [ 0.00328438 -0.62125184]
Stock Position:  0.0032843830061832654
Bond Position:  [8.14935397]


portfolio before change:  [8.49150514]
curr_Stock_Price:  103.86499686551662
curr_Factors:  [1.03864997e+02 4.51784821e-02]
mat_Sqrt:  [[ 2.20767444e+01  0.00000000e+00]
 [-8.50209218e-03  1.94807405e-02]]
grads:  [-0.0107604   2.39176802]
Stock Position:  -0.010760399121961136
Bond Position:  [9.60913396]


portfolio before change:  [8.48724047]
curr_Stock_Price:  104.37295970020938
curr_Factors:  [1.04372960e+02 4.44825859e-02]
mat_Sqrt:  [[ 2.20131915e+01  0.00000000e+00]
 [-8.43635807e-03  1.93301247e-02]]
grads:  [0.00460956 2.75989222]
Stock Position:  0.004609562028754319
Bond Position:  [8.00612684]


portfolio before change:  [8.49254389]
curr_Stock_Price:  105.3063657951282
curr_Factors:  [1.05306366e+02 4.39990351e-02]
mat_Sqrt:  [[ 2.20890074e+01  0.00000000e+00]
 [-8.39037879e-03  1.92247729e-02]]
grads:  [-0.00428573  4.23022661]
Stock Position:  -0.004285734025546595
Bond Position:  [8.94385897]


portfolio before change:  [8.48888249]
curr_Stock_Price:  106.4215666784162
curr_Factors:  [1.06421567e+02 4.29604552e-02]
mat_Sqrt:  [[ 2.20578960e+01  0.00000000e+00]
 [-8.29076163e-03  1.89965214e-02]]
grads:  [-0.01811016 -2.64269276]
Stock Position:  -0.018110159924202923
Bond Position:  [10.41619408]


portfolio before change:  [8.48836341]
curr_Stock_Price:  106.52212831864396
curr_Factors:  [1.06522128e+02 4.30916578e-02]
mat_Sqrt:  [[ 2.21124282e+01  0.00000000e+00]
 [-8.30341210e-03  1.90255072e-02]]
grads:  [-4.38073440e-03 -8.04784774e+00]
Stock Position:  -0.004380734404462613
Bond Position:  [8.95500856]


portfolio before change:  [8.48748335]
curr_Stock_Price:  106.97856062243596
curr_Factors:  [1.06978561e+02 4.37141307e-02]
mat_Sqrt:  [[ 2.23669967e+01  0.00000000e+00]
 [-8.36316980e-03  1.91624293e-02]]
grads:  [-1.33167949e-03 -3.35241815e+00]
Stock Position:  -0.0013316794934282992
Bond Position:  [8.6299445]


portfolio before change:  [8.48833803]
curr_Stock_Price:  107.1468609280474
curr_Factors:  [1.07146861e+02 4.47408946e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.48833803]
Stock Price:  107.3877367421796
PL:  [1.10060129]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.05326281e+00  2.67022834e-01]
 [ 2.84140782e-01  1.07133805e-01]
 [-4.47845871e-01 -1.67621145e-01]
 [-1.04597949e-01 -1.17029177e-01]
 [-1.22643857e-01 -5.86100426e-01]
 [-3.76931518e-01  2.12696872e-01]
 [ 4.18519847e-01 -5.02048766e-01]
 [-6.64914657e-01  8.85562478e-02]
 [-1.10340788e-01 -9.12199656e-02]
 [-3.60818911e-01 -5.91307133e-01]
 [-4.39496113e-02 -1.58417326e-02]
 [-1.92300940e-01 -2.15878540e-01]
 [-4.40317884e-02 -3.72497784e-02]
 [ 2.26907577e-02 -1.94853033e-01]
 [-9.25628217e-02 -1.04182600e-01]
 [ 8.46270750e-02 -1.12464497e+00]
 [ 1.49194736e-02 -3.69587188e-01]
 [ 3.95017800e-02 -1.61672929e-01]
 [-1.00302695e-01 -1.13770896e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 9.96092771e-02 -1.50449733e-02]
 [ 2.83430275e-01 -4.93282439e-01]
 [ 2.74856617e-02 -3.56308688e-01]
 [-4.59576431e-03  2.29107725e-01]
 [ 5.04582188e-01 -6.00657016e-01]
 [-6.90413048e-01  1.06671539e-01]
 [-1.16637566e-01  2.45752289e-01]
 [-1.25317067e-01 -3.71739458e-01]
 [-7.84448591e-02  2.71890654e-01]
 [-5.85505206e-01  1.39589627e+00]
 [-7.39531439e-02  1.20953787e-01]
 [ 7.77567776e-02 -1.19471891e-02]
 [-1.81639240e-01 -1.67005653e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.02312878e-01 -7.91142953e-02]
 [-3.19738940e-02 -1.35245309e-01]
 [ 1.73656046e-02 -6.29429172e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.8496787]
curr_Stock_Price:  101.18564556835072
curr_Factors:  [1.01185646e+02 3.83793964e-02]
mat_Sqrt:  [[ 1.98229359e+01  0.00000000e+00]
 [-7.83626405e-03  1.79551366e-02]]
grads:  [ 0.05901251 14.87166819]
Stock Position:  0.05901250615122491
Bond Position:  [4.87846016]


portfolio before change:  [10.80454725]
curr_Stock_Price:  100.41053366692174
curr_Factors:  [1.00410534e+02 3.82594030e-02]
mat_Sqrt:  [[ 1.96403114e+01  0.00000000e+00]
 [-7.82400440e-03  1.79270462e-02]]
grads:  [0.01684789 5.9760991 ]
Stock Position:  0.016847890059585185
Bond Position:  [9.11284161]


portfolio before change:  [10.84202213]
curr_Stock_Price:  102.56722585021684
curr_Factors:  [1.02567226e+02 3.76556741e-02]
mat_Sqrt:  [[ 1.99032420e+01  0.00000000e+00]
 [-7.76202799e-03  1.77850404e-02]]
grads:  [-0.02617673 -9.42483912]
Stock Position:  -0.026176727280923563
Bond Position:  [13.52689643]


portfolio before change:  [10.82024486]
curr_Stock_Price:  103.4637568342649
curr_Factors:  [1.03463757e+02 3.74676219e-02]
mat_Sqrt:  [[ 2.00270189e+01  0.00000000e+00]
 [-7.74262197e-03  1.77405756e-02]]
grads:  [-0.00777318 -6.59669562]
Stock Position:  -0.007773182316476032
Bond Position:  [11.6244875]


portfolio before change:  [10.82497567]
curr_Stock_Price:  103.04209390798518
curr_Factors:  [1.03042094e+02 3.86125439e-02]
mat_Sqrt:  [[ 2.02478485e+01  0.00000000e+00]
 [-7.86002992e-03  1.80095910e-02]]
grads:  [-1.86903341e-02 -3.25437943e+01]
Stock Position:  -0.01869033413947607
Bond Position:  [12.75086684]


portfolio before change:  [10.83930704]
curr_Stock_Price:  102.36059688986103
curr_Factors:  [1.02360597e+02 4.12516146e-02]
mat_Sqrt:  [[ 2.07899424e+01  0.00000000e+00]
 [-8.12419740e-03  1.86148748e-02]]
grads:  [-0.01366541 11.42617796]
Stock Position:  -0.013665405471794118
Bond Position:  [12.2381061]


portfolio before change:  [10.80715966]
curr_Stock_Price:  104.82501213357293
curr_Factors:  [1.04825012e+02 3.97117502e-02]
mat_Sqrt:  [[ 2.08893264e+01  0.00000000e+00]
 [-7.97112291e-03  1.82641370e-02]]
grads:  [ 9.54591824e-03 -2.74882281e+01]
Stock Position:  0.009545918243307486
Bond Position:  [9.80650866]


portfolio before change:  [10.80009393]
curr_Stock_Price:  103.95640875483556
curr_Factors:  [1.03956409e+02 4.10159613e-02]
mat_Sqrt:  [[ 2.10536654e+01  0.00000000e+00]
 [-8.10095909e-03  1.85616291e-02]]
grads:  [-0.02974615  4.77093079]
Stock Position:  -0.02974615258511903
Bond Position:  [13.89239713]


portfolio before change:  [10.80695339]
curr_Stock_Price:  103.78419155166011
curr_Factors:  [1.03784192e+02 4.26952953e-02]
mat_Sqrt:  [[ 2.14447613e+01  0.00000000e+00]
 [-8.26513596e-03  1.89378056e-02]]
grads:  [-0.00700182 -4.81681815]
Stock Position:  -0.007001824016825839
Bond Position:  [11.53363204]


portfolio before change:  [10.80752094]
curr_Stock_Price:  103.90905174492102
curr_Factors:  [1.03909052e+02 4.26494255e-02]
mat_Sqrt:  [[ 2.14590244e+01  0.00000000e+00]
 [-8.26069493e-03  1.89276299e-02]]
grads:  [-2.88403838e-02 -3.12404213e+01]
Stock Position:  -0.028840383822944543
Bond Position:  [13.80429787]


portfolio before change:  [10.77763311]
curr_Stock_Price:  105.00520462877206
curr_Factors:  [1.05005205e+02 4.26356134e-02]
mat_Sqrt:  [[ 2.16818873e+01  0.00000000e+00]
 [-8.25935720e-03  1.89245648e-02]]
grads:  [-0.0023459  -0.83709891]
Stock Position:  -0.002345898648545538
Bond Position:  [11.02396468]


portfolio before change:  [10.78028779]
curr_Stock_Price:  104.46102404182737
curr_Factors:  [1.04461024e+02 4.21704258e-02]
mat_Sqrt:  [[ 2.14515299e+01  0.00000000e+00]
 [-8.21417563e-03  1.88210408e-02]]
grads:  [ -0.01335653 -11.47006389]
Stock Position:  -0.01335653262882702
Bond Position:  [12.17552486]


portfolio before change:  [10.77557363]
curr_Stock_Price:  104.92792612484712
curr_Factors:  [1.04927926e+02 4.07248018e-02]
mat_Sqrt:  [[ 2.11748615e+01  0.00000000e+00]
 [-8.07215478e-03  1.84956302e-02]]
grads:  [-0.00284719 -2.01397725]
Stock Position:  -0.0028471933350010478
Bond Position:  [11.07432372]


portfolio before change:  [10.77561327]
curr_Stock_Price:  105.40022658214508
curr_Factors:  [1.05400227e+02 3.90540838e-02]
mat_Sqrt:  [[ 2.08293046e+01  0.00000000e+00]
 [-7.90484244e-03  1.81122694e-02]]
grads:  [-2.99338259e-03 -1.07580684e+01]
Stock Position:  -0.0029933825872747654
Bond Position:  [11.09111648]


portfolio before change:  [10.77573469]
curr_Stock_Price:  105.82284663418025
curr_Factors:  [1.05822847e+02 3.89799242e-02]
mat_Sqrt:  [[ 2.08929582e+01  0.00000000e+00]
 [-7.89733364e-03  1.80950646e-02]]
grads:  [-0.00660662 -5.75751467]
Stock Position:  -0.00660662003089069
Bond Position:  [11.47486603]


portfolio before change:  [10.76959288]
curr_Stock_Price:  106.96961458613069
curr_Factors:  [1.06969615e+02 3.78730862e-02]
mat_Sqrt:  [[ 2.08173661e+01  0.00000000e+00]
 [-7.78440350e-03  1.78363091e-02]]
grads:  [-1.95129503e-02 -6.30536823e+01]
Stock Position:  -0.019512950331200013
Bond Position:  [12.85688565]


portfolio before change:  [10.78285048]
curr_Stock_Price:  106.37255487422544
curr_Factors:  [1.06372555e+02 3.80770693e-02]
mat_Sqrt:  [[ 2.07568452e+01  0.00000000e+00]
 [-7.80533861e-03  1.78842775e-02]]
grads:  [-7.05220845e-03 -2.06654805e+01]
Stock Position:  -0.007052208445545005
Bond Position:  [11.53301191]


portfolio before change:  [10.79120446]
curr_Stock_Price:  105.39239910118926
curr_Factors:  [1.05392399e+02 3.81021651e-02]
mat_Sqrt:  [[ 2.05723601e+01  0.00000000e+00]
 [-7.80791036e-03  1.78901701e-02]]
grads:  [-1.50969898e-03 -9.03696993e+00]
Stock Position:  -0.0015096989811018045
Bond Position:  [10.95031526]


portfolio before change:  [10.79087398]
curr_Stock_Price:  106.51802700716905
curr_Factors:  [1.06518027e+02 3.75987850e-02]
mat_Sqrt:  [[ 2.06542780e+01  0.00000000e+00]
 [-7.75616245e-03  1.77716008e-02]]
grads:  [-0.00726031 -6.40183724]
Stock Position:  -0.007260306266060064
Bond Position:  [11.56422748]


portfolio before change:  [10.79971253]
curr_Stock_Price:  105.4997600877569
curr_Factors:  [1.05499760e+02 3.65839293e-02]
mat_Sqrt:  [[ 2.01788609e+01  0.00000000e+00]
 [-7.65077034e-03  1.75301171e-02]]
grads:  [-2.40157610e-04 -6.22319797e+00]
Stock Position:  -0.0002401576101335334
Bond Position:  [10.8250491]


portfolio before change:  [10.80087475]
curr_Stock_Price:  106.295029372717
curr_Factors:  [1.06295029e+02 3.66219945e-02]
mat_Sqrt:  [[ 2.03415458e+01  0.00000000e+00]
 [-7.65474959e-03  1.75392347e-02]]
grads:  [ 0.00457404 -0.85778961]
Stock Position:  0.004574043354632097
Bond Position:  [10.31467668]


portfolio before change:  [10.80506359]
curr_Stock_Price:  106.92891555546471
curr_Factors:  [1.06928916e+02 3.79931268e-02]
mat_Sqrt:  [[ 2.08423978e+01  0.00000000e+00]
 [-7.79673027e-03  1.78645533e-02]]
grads:  [ 3.26949755e-03 -2.76123579e+01]
Stock Position:  0.0032694975547163706
Bond Position:  [10.45545976]


portfolio before change:  [10.81343338]
curr_Stock_Price:  109.0891162567079
curr_Factors:  [1.09089116e+02 3.65952567e-02]
mat_Sqrt:  [[ 2.08686244e+01  0.00000000e+00]
 [-7.65195470e-03  1.75328308e-02]]
grads:  [-6.13457775e-03 -2.03223708e+01]
Stock Position:  -0.00613457774515665
Bond Position:  [11.48264904]


portfolio before change:  [10.81471008]
curr_Stock_Price:  109.11498798580831
curr_Factors:  [1.09114988e+02 3.69761632e-02]
mat_Sqrt:  [[ 2.09819251e+01  0.00000000e+00]
 [-7.69167479e-03  1.76238410e-02]]
grads:  [4.54653442e-03 1.29998747e+01]
Stock Position:  0.004546534420004005
Bond Position:  [10.31861504]


portfolio before change:  [10.81658415]
curr_Stock_Price:  109.24347230162344
curr_Factors:  [1.09243472e+02 3.62018813e-02]
mat_Sqrt:  [[ 2.07855282e+01  0.00000000e+00]
 [-7.61071679e-03  1.74383429e-02]]
grads:  [ 1.16635946e-02 -3.44446155e+01]
Stock Position:  0.011663594584144312
Bond Position:  [9.54241258]


portfolio before change:  [10.80988198]
curr_Stock_Price:  108.5665759591538
curr_Factors:  [1.08566576e+02 3.75334392e-02]
mat_Sqrt:  [[ 2.10331985e+01  0.00000000e+00]
 [-7.74941951e-03  1.77561507e-02]]
grads:  [-0.0306115   6.00758244]
Stock Position:  -0.03061150069818942
Bond Position:  [14.1332678]


portfolio before change:  [10.80064304]
curr_Stock_Price:  108.92610455005381
curr_Factors:  [1.08926105e+02 3.73168611e-02]
mat_Sqrt:  [[ 2.10418793e+01  0.00000000e+00]
 [-7.72702904e-03  1.77048477e-02]]
grads:  [-4.45895269e-04  1.38805085e+01]
Stock Position:  -0.0004458952688469922
Bond Position:  [10.84921268]


portfolio before change:  [10.80136221]
curr_Stock_Price:  110.35485123976333
curr_Factors:  [1.10354851e+02 3.75850824e-02]
mat_Sqrt:  [[ 2.13943543e+01  0.00000000e+00]
 [-7.75474898e-03  1.77683621e-02]]
grads:  [-1.34408108e-02 -2.09214251e+01]
Stock Position:  -0.01344081079639665
Bond Position:  [12.28462088]


portfolio before change:  [10.79613657]
curr_Stock_Price:  110.85789416519201
curr_Factors:  [1.10857894e+02 3.87368471e-02]
mat_Sqrt:  [[ 2.18186944e+01  0.00000000e+00]
 [-7.87267142e-03  1.80385564e-02]]
grads:  [1.84327944e-03 1.50727502e+01]
Stock Position:  0.001843279437956873
Bond Position:  [10.5917945]


portfolio before change:  [10.80157893]
curr_Stock_Price:  113.09211667912282
curr_Factors:  [1.13092117e+02 3.81266726e-02]
mat_Sqrt:  [[ 2.20824261e+01  0.00000000e+00]
 [-7.81042099e-03  1.78959227e-02]]
grads:  [1.07387974e-03 7.80007988e+01]
Stock Position:  0.0010738797448563147
Bond Position:  [10.68013159]


portfolio before change:  [10.80142898]
curr_Stock_Price:  111.70923903264814
curr_Factors:  [1.11709239e+02 3.87275558e-02]
mat_Sqrt:  [[ 2.19836164e+01  0.00000000e+00]
 [-7.87172721e-03  1.80363929e-02]]
grads:  [-9.62743486e-04  6.70609626e+00]
Stock Position:  -0.0009627434856458183
Bond Position:  [10.90897633]


portfolio before change:  [10.80370826]
curr_Stock_Price:  110.75824296534418
curr_Factors:  [1.10758243e+02 3.94465388e-02]
mat_Sqrt:  [[ 2.19978638e+01  0.00000000e+00]
 [-7.94446110e-03  1.82030472e-02]]
grads:  [ 0.00329771 -0.65632908]
Stock Position:  0.003297710967722112
Bond Position:  [10.43845958]


portfolio before change:  [10.79886051]
curr_Stock_Price:  108.8925132351968
curr_Factors:  [1.08892513e+02 4.00660703e-02]
mat_Sqrt:  [[ 2.17964816e+01  0.00000000e+00]
 [-8.00660431e-03  1.83454351e-02]]
grads:  [-0.01167741 -9.10339014]
Stock Position:  -0.011677411382423897
Bond Position:  [12.07044318]


portfolio before change:  [10.79902403]
curr_Stock_Price:  109.00772505038935
curr_Factors:  [1.09007725e+02 3.83188898e-02]
mat_Sqrt:  [[ 2.13384925e+01  0.00000000e+00]
 [-7.83008453e-03  1.79409775e-02]]
grads:  [0.00475531 2.97358719]
Stock Position:  0.004755311162382907
Bond Position:  [10.28065838]


portfolio before change:  [10.79779512]
curr_Stock_Price:  108.47903738582377
curr_Factors:  [1.08479037e+02 3.82894484e-02]
mat_Sqrt:  [[ 2.12268415e+01  0.00000000e+00]
 [-7.82707592e-03  1.79340839e-02]]
grads:  [-4.45980673e-03  4.53466965e+00]
Stock Position:  -0.004459806730224832
Bond Position:  [11.28159066]


portfolio before change:  [10.80524244]
curr_Stock_Price:  107.12538458019651
curr_Factors:  [1.07125385e+02 3.94608248e-02]
mat_Sqrt:  [[ 2.12801886e+01  0.00000000e+00]
 [-7.94589955e-03  1.82063431e-02]]
grads:  [-0.02052807 -4.34542483]
Stock Position:  -0.02052806932657675
Bond Position:  [13.00431976]


portfolio before change:  [10.77126149]
curr_Stock_Price:  108.85991650317374
curr_Factors:  [1.08859917e+02 3.88048553e-02]
mat_Sqrt:  [[ 2.14442584e+01  0.00000000e+00]
 [-7.87957921e-03  1.80543841e-02]]
grads:  [-4.24355016e-03 -7.49099545e+00]
Stock Position:  -0.004243550159584938
Bond Position:  [11.233214]


portfolio before change:  [10.76581072]
curr_Stock_Price:  110.47531131431765
curr_Factors:  [1.10475311e+02 3.76627881e-02]
mat_Sqrt:  [[ 2.14398364e+01  0.00000000e+00]
 [-7.76276117e-03  1.77867203e-02]]
grads:  [-4.71315937e-04 -3.53875903e+00]
Stock Position:  -0.00047131593717374663
Bond Position:  [10.81787949]


portfolio before change:  [10.76813155]
curr_Stock_Price:  108.42039909633982
curr_Factors:  [1.08420399e+02 3.82019546e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.76813155]
Stock Price:  107.61080676490651
PL:  [3.15732478]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.50364784e+00  3.68845864e-01]
 [ 7.30834541e-02  4.85782437e-02]
 [-3.89692621e-01 -1.54467336e-01]
 [-4.32023148e-02 -1.30694054e-01]
 [-1.25157119e-01 -7.57129954e-01]
 [-3.75478276e-01  2.25383078e-01]
 [ 3.81408544e-01 -4.52775178e-01]
 [-7.41195263e-01  5.34333374e-03]
 [-1.03040531e-01 -1.04106602e-01]
 [-2.25526254e-01 -4.94995138e-01]
 [-6.74820795e-02 -1.35723671e-02]
 [-7.54979986e-03 -1.36279415e-01]
 [-7.38089446e-02 -2.02738948e-02]
 [-1.25477899e-02 -1.05479150e-01]
 [ 3.09645662e-01  1.85027531e-01]
 [ 1.35567145e-01 -4.76197217e-01]
 [ 3.96044045e-02  9.20945758e-02]
 [ 5.35900167e-03 -7.46002631e-02]
 [-4.37380917e-02 -3.04132872e-02]
 [-9.97111064e-02 -1.95637037e-02]
 [ 1.76689275e-01 -4.46819916e-02]
 [ 7.08070314e-01 -8.88769468e-02]
 [ 2.81546178e-02 -2.93240475e-01]
 [ 3.08678372e-02  1.60907205e-02]
 [ 1.97858522e-01 -1.12258958e-01]
 [ 1.73109739e-01 -8.82533230e-02]
 [ 1.36662504e-01 -1.55098590e-01]
 [ 4.81868993e-02  1.26657154e-01]
 [ 1.12538559e-01  7.89830236e-02]
 [-5.19164360e-01 -1.10979247e-01]
 [-1.67426305e-01 -6.25695583e-02]
 [ 8.55983965e-03 -6.06583342e-02]
 [-2.25611309e-03  1.75167602e-01]
 [ 4.79185771e-03  1.29297380e-02]
 [ 1.02611365e-01 -5.44871657e-02]
 [-4.29902049e-02  1.19238405e-01]
 [-4.50436536e-02 -1.23312600e-02]
 [-1.68682564e-01 -7.70023035e-02]
 [ 1.24002148e-01 -7.37512347e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.6500554]
curr_Stock_Price:  99.22609213595295
curr_Factors:  [9.92260921e+01 4.01803123e-02]
mat_Sqrt:  [[ 1.98898973e+01  0.00000000e+00]
 [-8.01801095e-03  1.83715711e-02]]
grads:  [ 0.083692   20.07699084]
Stock Position:  0.08369200402494387
Bond Position:  [-10.9544859]


portfolio before change:  [-2.51682599]
curr_Stock_Price:  100.83435576304106
curr_Factors:  [1.00834356e+02 3.80114158e-02]
mat_Sqrt:  [[ 1.96591869e+01  0.00000000e+00]
 [-7.79860663e-03  1.78688526e-02]]
grads:  [0.00479596 2.71859894]
Stock Position:  0.004795963251911262
Bond Position:  [-3.00042386]


portfolio before change:  [-2.50989718]
curr_Stock_Price:  102.35728055648006
curr_Factors:  [1.02357281e+02 3.79346385e-02]
mat_Sqrt:  [[ 1.99359398e+01  0.00000000e+00]
 [-7.79072664e-03  1.78507973e-02]]
grads:  [-0.02292883 -8.65324575]
Stock Position:  -0.022928825924500643
Bond Position:  [-0.16296491]


portfolio before change:  [-2.52621841]
curr_Stock_Price:  103.06821387105241
curr_Factors:  [1.03068214e+02 3.83528890e-02]
mat_Sqrt:  [[ 2.01847694e+01  0.00000000e+00]
 [-7.83355746e-03  1.79489350e-02]]
grads:  [-4.96621360e-03 -7.28143781e+00]
Stock Position:  -0.004966213601840363
Bond Position:  [-2.01435965]


portfolio before change:  [-2.53047576]
curr_Stock_Price:  103.87477159190666
curr_Factors:  [1.03874772e+02 3.75579508e-02]
mat_Sqrt:  [[ 2.01307996e+01  0.00000000e+00]
 [-7.75194951e-03  1.77619477e-02]]
grads:  [-2.26317747e-02 -4.26265163e+01]
Stock Position:  -0.022631774683890542
Bond Position:  [-0.17960534]


portfolio before change:  [-2.53575789]
curr_Stock_Price:  104.10717404434826
curr_Factors:  [1.04107174e+02 3.71520813e-02]
mat_Sqrt:  [[ 2.00665278e+01  0.00000000e+00]
 [-7.70995007e-03  1.76657149e-02]]
grads:  [-0.01380972 12.75822005]
Stock Position:  -0.01380971527926731
Bond Position:  [-1.09806746]


portfolio before change:  [-2.53870219]
curr_Stock_Price:  104.3104386843339
curr_Factors:  [1.04310439e+02 3.81695383e-02]
mat_Sqrt:  [[ 2.03791575e+01  0.00000000e+00]
 [-7.81481038e-03  1.79059800e-02]]
grads:  [ 9.0190802e-03 -2.5286255e+01]
Stock Position:  0.009019080204978323
Bond Position:  [-3.4794864]


portfolio before change:  [-2.53472122]
curr_Stock_Price:  104.80005972899474
curr_Factors:  [1.04800060e+02 3.74065591e-02]
mat_Sqrt:  [[ 2.02691441e+01  0.00000000e+00]
 [-7.73631014e-03  1.77261134e-02]]
grads:  [-0.03645261  0.30143854]
Stock Position:  -0.03645261174444338
Bond Position:  [1.28551467]


portfolio before change:  [-2.5339088]
curr_Stock_Price:  104.78218110309004
curr_Factors:  [1.04782181e+02 3.72234193e-02]
mat_Sqrt:  [[ 2.02160157e+01  0.00000000e+00]
 [-7.71734870e-03  1.76826673e-02]]
grads:  [-0.00734449 -5.88749427]
Stock Position:  -0.007344492583501188
Bond Position:  [-1.76433685]


portfolio before change:  [-2.5198561]
curr_Stock_Price:  102.83878578167942
curr_Factors:  [1.02838786e+02 3.80740697e-02]
mat_Sqrt:  [[ 2.00664982e+01  0.00000000e+00]
 [-7.80503117e-03  1.78835731e-02]]
grads:  [-2.20048281e-02 -2.76787606e+01]
Stock Position:  -0.022004828088333917
Bond Position:  [-0.2569063]


portfolio before change:  [-2.48948496]
curr_Stock_Price:  101.45712273029501
curr_Factors:  [1.01457123e+02 3.93555640e-02]
mat_Sqrt:  [[ 2.01273043e+01  0.00000000e+00]
 [-7.93529473e-03  1.81820444e-02]]
grads:  [-0.00364706 -0.7464709 ]
Stock Position:  -0.003647062971443745
Bond Position:  [-2.11946444]


portfolio before change:  [-2.48949474]
curr_Stock_Price:  101.38715671723098
curr_Factors:  [1.01387157e+02 3.84730446e-02]
mat_Sqrt:  [[ 1.98866313e+01  0.00000000e+00]
 [-7.84581871e-03  1.79770291e-02]]
grads:  [-3.37045584e-03 -7.58075287e+00]
Stock Position:  -0.003370455840776846
Bond Position:  [-2.1477738]


portfolio before change:  [-2.48890786]
curr_Stock_Price:  101.13337282126243
curr_Factors:  [1.01133373e+02 3.90379450e-02]
mat_Sqrt:  [[ 1.99819545e+01  0.00000000e+00]
 [-7.90320897e-03  1.81085267e-02]]
grads:  [-0.00413659 -1.11957727]
Stock Position:  -0.004136592233061258
Bond Position:  [-2.07056033]


portfolio before change:  [-2.49404089]
curr_Stock_Price:  102.31168359548099
curr_Factors:  [1.02311684e+02 3.95945564e-02]
mat_Sqrt:  [[ 2.03583685e+01  0.00000000e+00]
 [-7.95935238e-03  1.82371674e-02]]
grads:  [-2.87757169e-03 -5.78374633e+00]
Stock Position:  -0.0028775716884559465
Bond Position:  [-2.19963168]


portfolio before change:  [-2.49258235]
curr_Stock_Price:  101.70926454233697
curr_Factors:  [1.01709265e+02 3.81763130e-02]
mat_Sqrt:  [[ 1.98727288e+01  0.00000000e+00]
 [-7.81550387e-03  1.79075690e-02]]
grads:  [ 0.01964493 10.33236451]
Stock Position:  0.019644926557626632
Bond Position:  [-4.49065339]


portfolio before change:  [-2.49251479]
curr_Stock_Price:  101.74127945941335
curr_Factors:  [1.01741279e+02 3.87994804e-02]
mat_Sqrt:  [[ 2.00405737e+01  0.00000000e+00]
 [-7.87903349e-03  1.80531337e-02]]
grads:  [-3.60580291e-03 -2.63775379e+01]
Stock Position:  -0.0036058029081072166
Bond Position:  [-2.12565579]


portfolio before change:  [-2.48575263]
curr_Stock_Price:  99.79223209974366
curr_Factors:  [9.97922321e+01 4.06706816e-02]
mat_Sqrt:  [[ 2.01250729e+01  0.00000000e+00]
 [-8.06678936e-03  1.84833364e-02]]
grads:  [3.96509235e-03 4.98257315e+00]
Stock Position:  0.00396509234663773
Bond Position:  [-2.88143805]


portfolio before change:  [-2.48554557]
curr_Stock_Price:  99.93529790016647
curr_Factors:  [9.99352979e+01 3.93854833e-02]
mat_Sqrt:  [[ 1.98329356e+01  0.00000000e+00]
 [-7.93831048e-03  1.81889543e-02]]
grads:  [-1.37141687e-03 -4.10140472e+00]
Stock Position:  -0.0013714168681845842
Bond Position:  [-2.34849261]


portfolio before change:  [-2.48445365]
curr_Stock_Price:  98.92502961873731
curr_Factors:  [9.89250296e+01 3.92268068e-02]
mat_Sqrt:  [[ 1.95928524e+01  0.00000000e+00]
 [-7.92230338e-03  1.81522775e-02]]
grads:  [-0.00290981 -1.67545297]
Stock Position:  -0.0029098130917198325
Bond Position:  [-2.1966003]


portfolio before change:  [-2.48517837]
curr_Stock_Price:  99.07972460960185
curr_Factors:  [9.90797246e+01 3.93493094e-02]
mat_Sqrt:  [[ 1.96541084e+01  0.00000000e+00]
 [-7.93466414e-03  1.81805995e-02]]
grads:  [-0.00550772 -1.07607583]
Stock Position:  -0.005507724096475012
Bond Position:  [-1.93947459]


portfolio before change:  [-2.48529555]
curr_Stock_Price:  99.05697961094197
curr_Factors:  [9.90569796e+01 3.98276452e-02]
mat_Sqrt:  [[ 1.97686675e+01  0.00000000e+00]
 [-7.98274591e-03  1.82907687e-02]]
grads:  [ 0.00795139 -2.44287117]
Stock Position:  0.007951393561656094
Bond Position:  [-3.27293658]


portfolio before change:  [-2.47242715]
curr_Stock_Price:  100.72681723093406
curr_Factors:  [1.00726817e+02 3.99218130e-02]
mat_Sqrt:  [[ 2.01256650e+01  0.00000000e+00]
 [-7.99217748e-03  1.83123791e-02]]
grads:  [ 0.03325511 -4.85338067]
Stock Position:  0.03325511156601762
Bond Position:  [-5.8221087]


portfolio before change:  [-2.47087602]
curr_Stock_Price:  100.79534629215969
curr_Factors:  [1.00795346e+02 4.05839347e-02]
mat_Sqrt:  [[ 2.03056809e+01  0.00000000e+00]
 [-8.05818190e-03  1.84636143e-02]]
grads:  [-4.91616206e-03 -1.58820733e+01]
Stock Position:  -0.004916162060531759
Bond Position:  [-1.97534976]


portfolio before change:  [-2.47158745]
curr_Stock_Price:  100.88982903348806
curr_Factors:  [1.00889829e+02 4.12891944e-02]
mat_Sqrt:  [[ 2.05005537e+01  0.00000000e+00]
 [-8.12789708e-03  1.86233518e-02]]
grads:  [0.00184826 0.86400776]
Stock Position:  0.0018482624408398803
Bond Position:  [-2.65805833]


portfolio before change:  [-2.47227485]
curr_Stock_Price:  100.69768981818785
curr_Factors:  [1.00697690e+02 4.23192185e-02]
mat_Sqrt:  [[ 2.07151617e+01  0.00000000e+00]
 [-8.22865418e-03  1.88542153e-02]]
grads:  [ 0.00718627 -5.95405094]
Stock Position:  0.0071862676574438195
Bond Position:  [-3.1959154]


portfolio before change:  [-2.47326978]
curr_Stock_Price:  100.61483579028432
curr_Factors:  [1.00614836e+02 4.22202302e-02]
mat_Sqrt:  [[ 2.06738957e+01  0.00000000e+00]
 [-8.21902478e-03  1.88321516e-02]]
grads:  [ 0.00651028 -4.68631121]
Stock Position:  0.006510279087132482
Bond Position:  [-3.12830044]


portfolio before change:  [-2.47683916]
curr_Stock_Price:  100.12663593554728
curr_Factors:  [1.00126636e+02 4.31496176e-02]
mat_Sqrt:  [[ 2.07987915e+01  0.00000000e+00]
 [-8.30899442e-03  1.90382979e-02]]
grads:  [ 3.31615082e-03 -8.14666262e+00]
Stock Position:  0.0033161508161985704
Bond Position:  [-2.80887418]


portfolio before change:  [-2.480146]
curr_Stock_Price:  99.2353268794134
curr_Factors:  [9.92353269e+01 4.32285718e-02]
mat_Sqrt:  [[ 2.06324950e+01  0.00000000e+00]
 [-8.31659275e-03  1.90557079e-02]]
grads:  [5.01464381e-03 6.64667798e+00]
Stock Position:  0.005014643805823954
Bond Position:  [-2.97777582]


portfolio before change:  [-2.48194984]
curr_Stock_Price:  98.94984522064951
curr_Factors:  [9.89498452e+01 4.32382152e-02]
mat_Sqrt:  [[ 2.05754337e+01  0.00000000e+00]
 [-8.31752032e-03  1.90578332e-02]]
grads:  [0.00714491 4.14438633]
Stock Position:  0.007144907804824192
Bond Position:  [-3.18893736]


portfolio before change:  [-2.47633474]
curr_Stock_Price:  99.79152705745247
curr_Factors:  [9.97915271e+01 4.08167444e-02]
mat_Sqrt:  [[ 2.01610362e+01  0.00000000e+00]
 [-8.08126173e-03  1.85164968e-02]]
grads:  [-0.0281533  -5.99353366]
Stock Position:  -0.028153298679212478
Bond Position:  [0.33312593]


portfolio before change:  [-2.48145307]
curr_Stock_Price:  99.9748084201695
curr_Factors:  [9.99748084e+01 3.95244743e-02]
mat_Sqrt:  [[ 1.98757549e+01  0.00000000e+00]
 [-7.95230525e-03  1.82210204e-02]]
grads:  [-0.00979756 -3.43392175]
Stock Position:  -0.009797559891572088
Bond Position:  [-1.5019439]


portfolio before change:  [-2.47494097]
curr_Stock_Price:  99.29097904866153
curr_Factors:  [9.92909790e+01 3.95096169e-02]
mat_Sqrt:  [[ 1.97360939e+01  0.00000000e+00]
 [-7.95081047e-03  1.82175954e-02]]
grads:  [-9.07658217e-04 -3.32965646e+00]
Stock Position:  -0.0009076582170811634
Bond Position:  [-2.38481869]


portfolio before change:  [-2.47423885]
curr_Stock_Price:  98.18897813688075
curr_Factors:  [9.81889781e+01 3.87931910e-02]
mat_Sqrt:  [[ 1.93392885e+01  0.00000000e+00]
 [-7.87839486e-03  1.80516704e-02]]
grads:  [3.83640256e-03 9.70367829e+00]
Stock Position:  0.0038364025634794762
Bond Position:  [-2.85093129]


portfolio before change:  [-2.47343859]
curr_Stock_Price:  98.49046976700176
curr_Factors:  [9.84904698e+01 3.98404826e-02]
mat_Sqrt:  [[ 1.96587774e+01  0.00000000e+00]
 [-7.98403232e-03  1.82937162e-02]]
grads:  [5.30798932e-04 7.06785755e-01]
Stock Position:  0.0005307989320749166
Bond Position:  [-2.52571723]


portfolio before change:  [-2.47446145]
curr_Stock_Price:  97.15827743361966
curr_Factors:  [9.71582774e+01 4.05872317e-02]
mat_Sqrt:  [[ 1.95737718e+01  0.00000000e+00]
 [-8.05850921e-03  1.84643642e-02]]
grads:  [ 0.00402739 -2.95093647]
Stock Position:  0.004027390154660731
Bond Position:  [-2.86575574]


portfolio before change:  [-2.47425121]
curr_Stock_Price:  97.29943120909283
curr_Factors:  [9.72994312e+01 4.05262907e-02]
mat_Sqrt:  [[ 1.95874874e+01  0.00000000e+00]
 [-8.05245709e-03  1.84504971e-02]]
grads:  [4.62014401e-04 6.46261205e+00]
Stock Position:  0.0004620144014532063
Bond Position:  [-2.51920495]


portfolio before change:  [-2.47479477]
curr_Stock_Price:  96.80456669679096
curr_Factors:  [9.68045667e+01 3.90795989e-02]
mat_Sqrt:  [[ 1.91368694e+01  0.00000000e+00]
 [-7.90742424e-03  1.81181851e-02]]
grads:  [-0.00263499 -0.68060128]
Stock Position:  -0.0026349898486782083
Bond Position:  [-2.21971572]


portfolio before change:  [-2.47618308]
curr_Stock_Price:  97.22613608614643
curr_Factors:  [9.72261361e+01 3.93760170e-02]
mat_Sqrt:  [[ 1.92929624e+01  0.00000000e+00]
 [-7.93735644e-03  1.81867683e-02]]
grads:  [-0.01048513 -4.23397395]
Stock Position:  -0.010485125116398292
Bond Position:  [-1.45675488]


portfolio before change:  [-2.46804425]
curr_Stock_Price:  96.43254174001731
curr_Factors:  [9.64325417e+01 3.85266088e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.46804425]
Stock Price:  97.02017043130066
PL:  [-2.46804425]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.32319170e+00  3.28048347e-01]
 [ 5.33693442e-01  1.23760219e-01]
 [ 1.09677078e-01 -4.99557518e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.14058775e-02  3.67398780e-02]
 [-2.46425285e-01  6.38779434e-02]
 [ 2.05053392e-01 -2.18436398e-01]
 [ 1.03878762e-01  4.16873351e-01]
 [-1.15356082e-01 -8.56822795e-02]
 [ 9.90798550e-02 -6.46883091e-02]
 [-7.33649380e-02 -1.21026615e-02]
 [-2.20516828e-03 -1.36204883e-01]
 [-1.16479834e-01 -2.74106691e-02]
 [-4.49221730e-02 -3.64301652e-02]
 [ 3.95357101e-01  2.47662175e-01]
 [ 1.34887133e-01 -3.77677131e-01]
 [ 3.88643513e-02  3.16307459e-02]
 [ 3.02240562e-02 -1.51557145e-01]
 [-1.14420906e-01 -4.64703942e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.47000401e-01 -3.04841772e-02]
 [ 3.76101470e-01 -3.67932229e-01]
 [ 2.70936619e-02 -3.31281726e-01]
 [ 4.09076949e-02  3.14324698e-02]
 [ 4.20110679e-01 -3.40326707e-01]
 [-1.55069752e-01 -4.79036748e-03]
 [-1.71690691e-01  4.73569910e-02]
 [ 2.00792861e-02  2.75363663e-01]
 [-9.99749002e-03  1.79904734e-01]
 [-5.42977500e-01 -1.22614899e-01]
 [-1.68249021e-01 -6.34681855e-02]
 [ 9.94177437e-03 -6.93701226e-02]
 [-2.55653026e-01  1.35453529e-01]
 [ 6.67257215e-02  6.40981037e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.79613769e-01  4.24208577e-02]
 [-2.79711792e-02 -1.72308349e-01]
 [-6.44531179e-03 -6.44292879e-02]
 [ 1.88207510e-01 -1.44686488e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.78846353]
curr_Stock_Price:  100.01552016216262
curr_Factors:  [1.0001552e+02 3.9578156e-02]
mat_Sqrt:  [[ 1.98973471e+01  0.00000000e+00]
 [-7.95770379e-03  1.82333900e-02]]
grads:  [ 0.07369644 17.99162674]
Stock Position:  0.07369644439827151
Bond Position:  [-4.58232469]


portfolio before change:  [2.76412227]
curr_Stock_Price:  99.69300205242372
curr_Factors:  [9.96930021e+01 3.86816094e-02]
mat_Sqrt:  [[ 1.96072615e+01  0.00000000e+00]
 [-7.86705631e-03  1.80256905e-02]]
grads:  [0.02997394 6.86576852]
Stock Position:  0.029973937376718406
Bond Position:  [-0.22406953]


portfolio before change:  [2.74717861]
curr_Stock_Price:  99.12865689086141
curr_Factors:  [9.91286569e+01 3.80088095e-02]
mat_Sqrt:  [[ 1.93259724e+01  0.00000000e+00]
 [-7.79833926e-03  1.78682400e-02]]
grads:  [ 0.00454697 -2.79578469]
Stock Position:  0.004546969153949087
Bond Position:  [2.29644367]


portfolio before change:  [2.74637559]
curr_Stock_Price:  98.88891482522018
curr_Factors:  [9.88889148e+01 3.82610951e-02]
mat_Sqrt:  [[ 1.93431103e+01  0.00000000e+00]
 [-7.82417741e-03  1.79274426e-02]]
grads:  [-8.42747970e-04 -8.44441763e+00]
Stock Position:  -0.0008427479695444528
Bond Position:  [2.82971402]


portfolio before change:  [2.7454166]
curr_Stock_Price:  100.44657949964352
curr_Factors:  [1.00446579e+02 3.85847572e-02]
mat_Sqrt:  [[ 1.97307247e+01  0.00000000e+00]
 [-7.85720125e-03  1.80031097e-02]]
grads:  [-0.00382     2.04075177]
Stock Position:  -0.0038199955208757996
Bond Position:  [3.12912209]


portfolio before change:  [2.74456221]
curr_Stock_Price:  100.77264126011461
curr_Factors:  [1.00772641e+02 3.93653957e-02]
mat_Sqrt:  [[ 1.99940122e+01  0.00000000e+00]
 [-7.93628585e-03  1.81843153e-02]]
grads:  [-0.01093061  3.51280443]
Stock Position:  -0.010930605763044854
Bond Position:  [3.84606823]


portfolio before change:  [2.73200245]
curr_Stock_Price:  101.96567258197851
curr_Factors:  [1.01965673e+02 3.74767837e-02]
mat_Sqrt:  [[ 1.97394544e+01  0.00000000e+00]
 [-7.74356855e-03  1.77427445e-02]]
grads:  [ 5.55840755e-03 -1.23113083e+01]
Stock Position:  0.005558407548138061
Bond Position:  [2.16523568]


portfolio before change:  [2.72635866]
curr_Stock_Price:  100.90161623217628
curr_Factors:  [1.00901616e+02 3.81400850e-02]
mat_Sqrt:  [[ 1.97055677e+01  0.00000000e+00]
 [-7.81179468e-03  1.78990702e-02]]
grads:  [1.45043884e-02 2.32902238e+01]
Stock Position:  0.014504388437570567
Bond Position:  [1.26284242]


portfolio before change:  [2.73036959]
curr_Stock_Price:  101.16726454470427
curr_Factors:  [1.01167265e+02 3.78494151e-02]
mat_Sqrt:  [[ 1.96820166e+01  0.00000000e+00]
 [-7.78197045e-03  1.78307343e-02]]
grads:  [-0.00776094 -4.80531413]
Stock Position:  -0.00776093719819116
Bond Position:  [3.51552238]


portfolio before change:  [2.73195216]
curr_Stock_Price:  101.01997486627543
curr_Factors:  [1.01019975e+02 3.71945023e-02]
mat_Sqrt:  [[ 1.94825874e+01  0.00000000e+00]
 [-7.71435051e-03  1.76757976e-02]]
grads:  [ 3.63645552e-03 -3.65971090e+00]
Stock Position:  0.0036364555186716484
Bond Position:  [2.36459752]


portfolio before change:  [2.73299851]
curr_Stock_Price:  101.22642688581044
curr_Factors:  [1.01226427e+02 3.61244131e-02]
mat_Sqrt:  [[ 1.92395233e+01  0.00000000e+00]
 [-7.60256937e-03  1.74196748e-02]]
grads:  [-0.00408778 -0.69476966]
Stock Position:  -0.004087781762466003
Bond Position:  [3.14679005]


portfolio before change:  [2.73367357]
curr_Stock_Price:  101.1575166534829
curr_Factors:  [1.01157517e+02 3.56298935e-02]
mat_Sqrt:  [[ 1.90943739e+01  0.00000000e+00]
 [-7.55035295e-03  1.73000320e-02]]
grads:  [-3.22869203e-03 -7.87310008e+00]
Stock Position:  -0.003228692028933169
Bond Position:  [3.06028004]


portfolio before change:  [2.73756851]
curr_Stock_Price:  100.06965289716247
curr_Factors:  [1.00069653e+02 3.57263266e-02]
mat_Sqrt:  [[ 1.89145745e+01  0.00000000e+00]
 [-7.56056364e-03  1.73234276e-02]]
grads:  [-0.00679068 -1.58228901]
Stock Position:  -0.006790680439598586
Bond Position:  [3.41710954]


portfolio before change:  [2.7379028]
curr_Stock_Price:  100.08332943294562
curr_Factors:  [1.00083329e+02 3.43913820e-02]
mat_Sqrt:  [[ 1.85603670e+01  0.00000000e+00]
 [-7.41796544e-03  1.69966941e-02]]
grads:  [-0.00327696 -2.14336771]
Stock Position:  -0.003276961104170113
Bond Position:  [3.06587198]


portfolio before change:  [2.73606879]
curr_Stock_Price:  100.75995339306931
curr_Factors:  [1.00759953e+02 3.42150554e-02]
mat_Sqrt:  [[ 1.86378830e+01  0.00000000e+00]
 [-7.39892483e-03  1.69530666e-02]]
grads:  [ 0.02701196 14.6086948 ]
Stock Position:  0.0270119591736833
Bond Position:  [0.01434504]


portfolio before change:  [2.74408593]
curr_Stock_Price:  101.0566865882371
curr_Factors:  [1.01056687e+02 3.50524094e-02]
mat_Sqrt:  [[ 1.89201246e+01  0.00000000e+00]
 [-7.48891547e-03  1.71592610e-02]]
grads:  [-1.58268940e-03 -2.20101047e+01]
Stock Position:  -0.0015826893963707055
Bond Position:  [2.90402727]


portfolio before change:  [2.74529756]
curr_Stock_Price:  100.52050916390338
curr_Factors:  [1.00520509e+02 3.33199599e-02]
mat_Sqrt:  [[ 1.83487682e+01  0.00000000e+00]
 [-7.30150230e-03  1.67298435e-02]]
grads:  [0.00287045 1.89067793]
Stock Position:  0.0028704455768478482
Bond Position:  [2.45675891]


portfolio before change:  [2.74974567]
curr_Stock_Price:  101.96314297322758
curr_Factors:  [1.01963143e+02 3.13743923e-02]
mat_Sqrt:  [[ 1.80605460e+01  0.00000000e+00]
 [-7.08512721e-03  1.62340659e-02]]
grads:  [-1.98891578e-03 -9.33574783e+00]
Stock Position:  -0.0019889157781797927
Bond Position:  [2.95254178]


portfolio before change:  [2.74724514]
curr_Stock_Price:  103.4059533042195
curr_Factors:  [1.03405953e+02 2.92465436e-02]
mat_Sqrt:  [[ 1.76840941e+01  0.00000000e+00]
 [-6.84064834e-03  1.56738944e-02]]
grads:  [-1.79389644e-02 -2.96482756e+01]
Stock Position:  -0.017938964351370986
Bond Position:  [4.60224085]


portfolio before change:  [2.75972082]
curr_Stock_Price:  102.74257217057603
curr_Factors:  [1.02742572e+02 3.06718496e-02]
mat_Sqrt:  [[ 1.79936976e+01  0.00000000e+00]
 [-7.00535220e-03  1.60512784e-02]]
grads:  [-2.69322466e-04 -6.79655457e+00]
Stock Position:  -0.00026932246587643683
Bond Position:  [2.7873917]


portfolio before change:  [2.75996786]
curr_Stock_Price:  103.11909005434876
curr_Factors:  [1.03119090e+02 3.17142532e-02]
mat_Sqrt:  [[ 1.83639591e+01  0.00000000e+00]
 [-7.12339843e-03  1.63217563e-02]]
grads:  [ 0.00728035 -1.86770203]
Stock Position:  0.007280348105369832
Bond Position:  [2.00922499]


portfolio before change:  [2.76561853]
curr_Stock_Price:  103.86074429609036
curr_Factors:  [1.03860744e+02 3.14184735e-02]
mat_Sqrt:  [[ 1.84095838e+01  0.00000000e+00]
 [-7.09010279e-03  1.62454664e-02]]
grads:  [ 1.17070914e-02 -2.26483021e+01]
Stock Position:  0.011707091387475334
Bond Position:  [1.54971131]


portfolio before change:  [2.77819421]
curr_Stock_Price:  104.91838988985603
curr_Factors:  [1.04918390e+02 3.06314672e-02]
mat_Sqrt:  [[ 1.83626568e+01  0.00000000e+00]
 [-7.00073907e-03  1.60407084e-02]]
grads:  [-6.39828637e-03 -2.06525621e+01]
Stock Position:  -0.006398286369007177
Bond Position:  [3.44949212]


portfolio before change:  [2.78602821]
curr_Stock_Price:  103.76139471101301
curr_Factors:  [1.03761395e+02 3.11367720e-02]
mat_Sqrt:  [[ 1.83093360e+01  0.00000000e+00]
 [-7.05824590e-03  1.61724731e-02]]
grads:  [0.0029835  1.94357843]
Stock Position:  0.0029835024862177027
Bond Position:  [2.47645583]


portfolio before change:  [2.78509725]
curr_Stock_Price:  103.34559673156895
curr_Factors:  [1.03345597e+02 3.09431105e-02]
mat_Sqrt:  [[ 1.81791663e+01  0.00000000e+00]
 [-7.03626157e-03  1.61221006e-02]]
grads:  [ 1.49390749e-02 -2.11093278e+01]
Stock Position:  0.0149390749232385
Bond Position:  [1.24120964]


portfolio before change:  [2.78789539]
curr_Stock_Price:  103.52251388679755
curr_Factors:  [1.03522514e+02 3.03152001e-02]
mat_Sqrt:  [[ 1.80245748e+01  0.00000000e+00]
 [-6.96450430e-03  1.59576841e-02]]
grads:  [-0.00871923 -0.3001919 ]
Stock Position:  -0.008719231436329796
Bond Position:  [3.69053215]


portfolio before change:  [2.79900687]
curr_Stock_Price:  102.30106076526363
curr_Factors:  [1.02301061e+02 3.01624191e-02]
mat_Sqrt:  [[ 1.77669640e+01  0.00000000e+00]
 [-6.94693245e-03  1.59174219e-02]]
grads:  [-0.00850018  2.97516716]
Stock Position:  -0.008500180774618669
Bond Position:  [3.66858438]


portfolio before change:  [2.80336798]
curr_Stock_Price:  101.84195174102778
curr_Factors:  [1.01841952e+02 3.08697479e-02]
mat_Sqrt:  [[ 1.78934159e+01  0.00000000e+00]
 [-7.02791553e-03  1.61029774e-02]]
grads:  [7.83851682e-03 1.71001707e+01]
Stock Position:  0.007838516824256361
Bond Position:  [2.00507813]


portfolio before change:  [2.79343112]
curr_Stock_Price:  100.54227759429112
curr_Factors:  [1.00542278e+02 3.15175273e-02]
mat_Sqrt:  [[ 1.78494479e+01  0.00000000e+00]
 [-7.10127057e-03  1.62710550e-02]]
grads:  [3.83873906e-03 1.10567344e+01]
Stock Position:  0.0038387390556041817
Bond Position:  [2.40747555]


portfolio before change:  [2.78641362]
curr_Stock_Price:  98.63580556488087
curr_Factors:  [9.86358056e+01 3.42072045e-02]
mat_Sqrt:  [[ 1.82428794e+01  0.00000000e+00]
 [-7.39807592e-03  1.69511214e-02]]
grads:  [-0.0326972  -7.23343876]
Stock Position:  -0.032697197343433876
Bond Position:  [6.01152802]


portfolio before change:  [2.72323056]
curr_Stock_Price:  100.59115810246904
curr_Factors:  [1.00591158e+02 3.23254100e-02]
mat_Sqrt:  [[ 1.80855545e+01  0.00000000e+00]
 [-7.19170745e-03  1.64782719e-02]]
grads:  [-0.01083455 -3.85162874]
Stock Position:  -0.010834547953945957
Bond Position:  [3.81309029]


portfolio before change:  [2.72339256]
curr_Stock_Price:  100.62020120449525
curr_Factors:  [1.00620201e+02 3.20099307e-02]
mat_Sqrt:  [[ 1.80022815e+01  0.00000000e+00]
 [-7.15652772e-03  1.63976650e-02]]
grads:  [-1.12951401e-03 -4.23048785e+00]
Stock Position:  -0.0011295140141306561
Bond Position:  [2.83704449]


portfolio before change:  [2.72357541]
curr_Stock_Price:  100.77230284395826
curr_Factors:  [1.00772303e+02 3.19503761e-02]
mat_Sqrt:  [[ 1.80127147e+01  0.00000000e+00]
 [-7.14986726e-03  1.63824040e-02]]
grads:  [-0.01091097  8.26823276]
Stock Position:  -0.010910973827601412
Bond Position:  [3.82309937]


portfolio before change:  [2.71128449]
curr_Stock_Price:  101.94257774005726
curr_Factors:  [1.01942578e+02 3.31768205e-02]
mat_Sqrt:  [[ 1.85683363e+01  0.00000000e+00]
 [-7.28580214e-03  1.66938699e-02]]
grads:  [0.0051001  3.83961922]
Stock Position:  0.005100102990965554
Bond Position:  [2.19136684]


portfolio before change:  [2.71361543]
curr_Stock_Price:  102.34590302514707
curr_Factors:  [1.02345903e+02 3.32586514e-02]
mat_Sqrt:  [[ 1.86647759e+01  0.00000000e+00]
 [-7.29478185e-03  1.67144450e-02]]
grads:  [-0.00507199  4.86556066]
Stock Position:  -0.005071992894307361
Bond Position:  [3.23271312]


portfolio before change:  [2.71225911]
curr_Stock_Price:  102.69299197308752
curr_Factors:  [1.02692992e+02 3.32958562e-02]
mat_Sqrt:  [[ 1.87385465e+01  0.00000000e+00]
 [-7.29886087e-03  1.67237912e-02]]
grads:  [-0.01393383  2.53655748]
Stock Position:  -0.013933833566317614
Bond Position:  [4.14316617]


portfolio before change:  [2.6851176]
curr_Stock_Price:  104.67804802621869
curr_Factors:  [1.04678048e+02 3.21492204e-02]
mat_Sqrt:  [[ 1.87689872e+01  0.00000000e+00]
 [-7.17208148e-03  1.64333031e-02]]
grads:  [-5.49697789e-03 -1.04853143e+01]
Stock Position:  -0.0054969778937851614
Bond Position:  [3.26053051]


portfolio before change:  [2.67795364]
curr_Stock_Price:  106.05544907207151
curr_Factors:  [1.06055449e+02 3.12409606e-02]
mat_Sqrt:  [[ 1.87454201e+01  0.00000000e+00]
 [-7.07004505e-03  1.61995083e-02]]
grads:  [-1.84389351e-03 -3.97723726e+00]
Stock Position:  -0.0018438935082705063
Bond Position:  [2.8735086]


portfolio before change:  [2.67810115]
curr_Stock_Price:  106.17026366712471
curr_Factors:  [1.06170264e+02 3.08892996e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.67810115]
Stock Price:  108.26519665592846
PL:  [-5.58709551]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48594887e+00  3.64844482e-01]
 [ 8.06851600e-01  9.61900265e-02]
 [ 1.02394748e-01 -4.23502106e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.60927496e-02  5.46079854e-01]
 [-1.80735462e-01 -7.02116896e-03]
 [ 1.26495742e-01 -6.22477279e-02]
 [-6.22478638e-01  1.53978575e-01]
 [-1.18217230e-01 -9.86090314e-02]
 [-1.28017815e-01 -3.86500091e-01]
 [-7.57915272e-02 -1.13394439e-02]
 [-8.87334211e-02 -1.57069819e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-1.47513355e-02 -9.92667615e-02]
 [ 1.64898259e-01  9.35823655e-02]
 [ 1.32932851e-01 -2.99032147e-01]
 [ 3.76128530e-02 -2.42431874e-02]
 [ 2.86732717e-02 -1.49866278e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-4.77882691e-02 -5.60791803e-02]
 [ 1.76689275e-01 -4.46819916e-02]
 [ 8.81608886e-01  1.69914434e-02]
 [ 2.24729125e-02 -1.33119243e-02]
 [-4.89628145e-02  5.48335789e-02]
 [ 1.65954852e-01 -8.45105019e-02]
 [ 1.32462366e-01 -1.02523832e-01]
 [-1.40928373e-01 -4.01037772e-01]
 [ 4.95800851e-02  9.66987862e-02]
 [ 2.24571996e-01 -3.52068563e-03]
 [-5.27216905e-01 -2.00013251e-01]
 [ 5.58076160e-02  2.36759765e-02]
 [-8.68949217e-02  1.02479852e-01]
 [ 3.22169845e-01  2.14653699e-01]
 [ 3.35158509e-02 -1.98493498e-02]
 [ 2.12204673e-01 -1.59892155e-01]
 [ 7.34659956e-02  9.56474272e-02]
 [-4.78235183e-02  3.87695739e-02]
 [-2.44069878e-01 -9.67622429e-02]
 [ 1.23184163e-01 -7.67395492e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.33462134]
curr_Stock_Price:  99.12672399024687
curr_Factors:  [9.91267240e+01 3.91123671e-02]
mat_Sqrt:  [[ 1.96041404e+01  0.00000000e+00]
 [-7.91073873e-03  1.81257795e-02]]
grads:  [ 0.08392003 20.12848506]
Stock Position:  0.083920030444122
Bond Position:  [-11.65333904]


portfolio before change:  [-3.33142743]
curr_Stock_Price:  99.18214186065659
curr_Factors:  [9.91821419e+01 3.89202199e-02]
mat_Sqrt:  [[ 1.95668594e+01  0.00000000e+00]
 [-7.89128328e-03  1.80812015e-02]]
grads:  [0.04338112 5.3198913 ]
Stock Position:  0.04338112469019619
Bond Position:  [-7.6340603]


portfolio before change:  [-3.34366556]
curr_Stock_Price:  98.9220330307754
curr_Factors:  [9.89220330e+01 3.92402293e-02]
mat_Sqrt:  [[ 1.95956106e+01  0.00000000e+00]
 [-7.92365868e-03  1.81553828e-02]]
grads:  [ 0.00428216 -2.33265313]
Stock Position:  0.0042821630957452375
Bond Position:  [-3.76726584]


portfolio before change:  [-3.34529365]
curr_Stock_Price:  98.65180655694026
curr_Factors:  [9.86518066e+01 3.81387486e-02]
mat_Sqrt:  [[ 1.92658539e+01  0.00000000e+00]
 [-7.81165781e-03  1.78987566e-02]]
grads:  [-8.46127405e-04 -8.45795134e+00]
Stock Position:  -0.0008461274053696986
Bond Position:  [-3.26182166]


portfolio before change:  [-3.34525502]
curr_Stock_Price:  98.12424519625904
curr_Factors:  [9.81242452e+01 3.79943815e-02]
mat_Sqrt:  [[ 1.91265226e+01  0.00000000e+00]
 [-7.79685901e-03  1.78648483e-02]]
grads:  [7.43658639e-03 3.05672819e+01]
Stock Position:  0.007436586387121898
Bond Position:  [-4.07496445]


portfolio before change:  [-3.33118451]
curr_Stock_Price:  100.08481154968148
curr_Factors:  [1.00084812e+02 3.69560889e-02]
mat_Sqrt:  [[ 1.92402707e+01  0.00000000e+00]
 [-7.68958662e-03  1.76190564e-02]]
grads:  [-0.00955287 -0.39849858]
Stock Position:  -0.009552867246983775
Bond Position:  [-2.37508759]


portfolio before change:  [-3.33979963]
curr_Stock_Price:  100.95556834897681
curr_Factors:  [1.00955568e+02 3.68233814e-02]
mat_Sqrt:  [[ 1.93727873e+01  0.00000000e+00]
 [-7.67576773e-03  1.75873933e-02]]
grads:  [ 0.00512722 -3.53933791]
Stock Position:  0.005127223291984214
Bond Position:  [-3.85742138]


portfolio before change:  [-3.32812387]
curr_Stock_Price:  103.32682706705428
curr_Factors:  [1.03326827e+02 3.44028072e-02]
mat_Sqrt:  [[ 1.91650534e+01  0.00000000e+00]
 [-7.41919750e-03  1.69995171e-02]]
grads:  [-0.02897341  9.05782054]
Stock Position:  -0.02897340625366187
Bond Position:  [-0.33439373]


portfolio before change:  [-3.31023111]
curr_Stock_Price:  102.70782639447908
curr_Factors:  [1.02707826e+02 3.47573441e-02]
mat_Sqrt:  [[ 1.91481504e+01  0.00000000e+00]
 [-7.45732864e-03  1.70868865e-02]]
grads:  [-0.00842137 -5.77103567]
Stock Position:  -0.008421374178380382
Bond Position:  [-2.44529008]


portfolio before change:  [-3.30654633]
curr_Stock_Price:  102.23397702628712
curr_Factors:  [1.02233977e+02 3.50318117e-02]
mat_Sqrt:  [[ 1.91349157e+01  0.00000000e+00]
 [-7.48671481e-03  1.71542187e-02]]
grads:  [-1.55057011e-02 -2.25309061e+01]
Stock Position:  -0.01550570107448866
Bond Position:  [-1.72133684]


portfolio before change:  [-3.32152275]
curr_Stock_Price:  103.18596519939925
curr_Factors:  [1.03185965e+02 3.43121002e-02]
mat_Sqrt:  [[ 1.91136787e+01  0.00000000e+00]
 [-7.40941026e-03  1.69770917e-02]]
grads:  [-0.00422422 -0.66792617]
Stock Position:  -0.0042242243068368905
Bond Position:  [-2.88564209]


portfolio before change:  [-3.32175506]
curr_Stock_Price:  103.15556318678719
curr_Factors:  [1.03155563e+02 3.41807002e-02]
mat_Sqrt:  [[ 1.90714245e+01  0.00000000e+00]
 [-7.39520928e-03  1.69445532e-02]]
grads:  [-8.24711915e-03 -9.26963474e+00]
Stock Position:  -0.008247119153757856
Bond Position:  [-2.47101884]


portfolio before change:  [-3.314669]
curr_Stock_Price:  102.25889165551196
curr_Factors:  [1.02258892e+02 3.39410908e-02]
mat_Sqrt:  [[ 1.88392660e+01  0.00000000e+00]
 [-7.36924320e-03  1.68850574e-02]]
grads:  [-0.00347729 -1.05951685]
Stock Position:  -0.003477286266105239
Bond Position:  [-2.95908556]


portfolio before change:  [-3.31505521]
curr_Stock_Price:  102.26358022941481
curr_Factors:  [1.02263580e+02 3.30528386e-02]
mat_Sqrt:  [[ 1.85919685e+01  0.00000000e+00]
 [-7.27217586e-03  1.66626482e-02]]
grads:  [-3.12365536e-03 -5.95744209e+00]
Stock Position:  -0.00312365536221534
Bond Position:  [-2.99561903]


portfolio before change:  [-3.31754822]
curr_Stock_Price:  102.94180371304064
curr_Factors:  [1.02941804e+02 3.26621820e-02]
mat_Sqrt:  [[ 1.86043444e+01  0.00000000e+00]
 [-7.22907264e-03  1.65638863e-02]]
grads:  [0.01105876 5.64978315]
Stock Position:  0.011058758506944492
Bond Position:  [-4.45595677]


portfolio before change:  [-3.34536639]
curr_Stock_Price:  100.4766861292309
curr_Factors:  [1.00476686e+02 3.46141785e-02]
mat_Sqrt:  [[ 1.86935730e+01  0.00000000e+00]
 [-7.44195442e-03  1.70516597e-02]]
grads:  [ 1.29698170e-04 -1.75368352e+01]
Stock Position:  0.00012969816953765584
Bond Position:  [-3.35839803]


portfolio before change:  [-3.34571805]
curr_Stock_Price:  101.00225807259694
curr_Factors:  [1.01002258e+02 3.50981746e-02]
mat_Sqrt:  [[ 1.89222749e+01  0.00000000e+00]
 [-7.49380273e-03  1.71704591e-02]]
grads:  [ 0.00142859 -1.41191259]
Stock Position:  0.0014285945347421265
Bond Position:  [-3.49000933]


portfolio before change:  [-3.34559958]
curr_Stock_Price:  101.39057478197859
curr_Factors:  [1.01390575e+02 3.24278878e-02]
mat_Sqrt:  [[ 1.82581561e+01  0.00000000e+00]
 [-7.20309798e-03  1.65043709e-02]]
grads:  [-2.01190822e-03 -9.08039933e+00]
Stock Position:  -0.002011908216689904
Bond Position:  [-3.14161105]


portfolio before change:  [-3.34602786]
curr_Stock_Price:  101.4082444560011
curr_Factors:  [1.01408244e+02 3.19540109e-02]
mat_Sqrt:  [[ 1.81274182e+01  0.00000000e+00]
 [-7.15027394e-03  1.63833358e-02]]
grads:  [-1.75851377e-02 -2.86442060e+01]
Stock Position:  -0.017585137680828266
Bond Position:  [-1.56274992]


portfolio before change:  [-3.33147638]
curr_Stock_Price:  100.56964785943016
curr_Factors:  [1.00569648e+02 3.24770161e-02]
mat_Sqrt:  [[ 1.81240391e+01  0.00000000e+00]
 [-7.20855226e-03  1.65168682e-02]]
grads:  [-0.00398715 -3.39526717]
Stock Position:  -0.003987148208611431
Bond Position:  [-2.93049029]


portfolio before change:  [-3.32653157]
curr_Stock_Price:  99.23758326156688
curr_Factors:  [9.92375833e+01 3.32855172e-02]
mat_Sqrt:  [[ 1.81052211e+01  0.00000000e+00]
 [-7.29772756e-03  1.67211945e-02]]
grads:  [ 0.00868194 -2.67217702]
Stock Position:  0.008681940643311209
Bond Position:  [-4.18810638]


portfolio before change:  [-3.32405601]
curr_Stock_Price:  99.58302514253535
curr_Factors:  [9.95830251e+01 3.41062610e-02]
mat_Sqrt:  [[ 1.83908741e+01  0.00000000e+00]
 [-7.38715219e-03  1.69260920e-02]]
grads:  [0.04834053 1.00386098]
Stock Position:  0.048340527864166094
Bond Position:  [-8.13795202]


portfolio before change:  [-3.35946323]
curr_Stock_Price:  98.8716155845151
curr_Factors:  [9.88716156e+01 3.63984757e-02]
mat_Sqrt:  [[ 1.88631070e+01  0.00000000e+00]
 [-7.63135382e-03  1.74856283e-02]]
grads:  [ 0.00088337 -0.7613066 ]
Stock Position:  0.0008833705089710429
Bond Position:  [-3.4468035]


portfolio before change:  [-3.35966063]
curr_Stock_Price:  99.13591893482983
curr_Factors:  [9.91359189e+01 3.82110493e-02]
mat_Sqrt:  [[ 1.93787392e+01  0.00000000e+00]
 [-7.81905870e-03  1.79157142e-02]]
grads:  [-1.29169800e-03  3.06064153e+00]
Stock Position:  -0.001291697999251559
Bond Position:  [-3.23160697]


portfolio before change:  [-3.36163094]
curr_Stock_Price:  100.34852822279349
curr_Factors:  [1.00348528e+02 3.70483261e-02]
mat_Sqrt:  [[ 1.93150263e+01  0.00000000e+00]
 [-7.69917670e-03  1.76410300e-02]]
grads:  [ 0.00668244 -4.79056505]
Stock Position:  0.006682436934039297
Bond Position:  [-4.03220365]


portfolio before change:  [-3.37096435]
curr_Stock_Price:  99.02725065960159
curr_Factors:  [9.90272507e+01 3.84841905e-02]
mat_Sqrt:  [[ 1.94265598e+01  0.00000000e+00]
 [-7.84695513e-03  1.79796329e-02]]
grads:  [ 4.51532838e-03 -5.70222055e+00]
Stock Position:  0.004515328382212242
Bond Position:  [-3.8181049]


portfolio before change:  [-3.37519466]
curr_Stock_Price:  98.19607676394713
curr_Factors:  [9.81960768e+01 3.88972203e-02]
mat_Sqrt:  [[ 1.93666017e+01  0.00000000e+00]
 [-7.88895129e-03  1.80758582e-02]]
grads:  [-1.63144578e-02 -2.21863752e+01]
Stock Position:  -0.01631445782822811
Bond Position:  [-1.77317891]


portfolio before change:  [-3.3820438]
curr_Stock_Price:  98.60230987136795
curr_Factors:  [9.86023099e+01 3.88450358e-02]
mat_Sqrt:  [[ 1.94336713e+01  0.00000000e+00]
 [-7.88365761e-03  1.80637289e-02]]
grads:  [4.72287990e-03 5.35320182e+00]
Stock Position:  0.004722879896154864
Bond Position:  [-3.84773066]


portfolio before change:  [-3.386088]
curr_Stock_Price:  97.84785408530641
curr_Factors:  [9.78478541e+01 4.00247792e-02]
mat_Sqrt:  [[ 1.95756313e+01  0.00000000e+00]
 [-8.00247753e-03  1.83359795e-02]]
grads:  [ 0.01139352 -0.19200968]
Stock Position:  0.011393524879631614
Bond Position:  [-4.50091996]


portfolio before change:  [-3.40176902]
curr_Stock_Price:  96.52092705462773
curr_Factors:  [9.65209271e+01 4.11537033e-02]
mat_Sqrt:  [[ 1.95805977e+01  0.00000000e+00]
 [-8.11455022e-03  1.85927703e-02]]
grads:  [ -0.03138361 -10.75758199]
Stock Position:  -0.03138361002695007
Bond Position:  [-0.37259389]


portfolio before change:  [-3.37210254]
curr_Stock_Price:  95.57415711609957
curr_Factors:  [9.55741571e+01 4.09856379e-02]
mat_Sqrt:  [[ 1.93489020e+01  0.00000000e+00]
 [-8.09796398e-03  1.85547665e-02]]
grads:  [0.00341832 1.2760051 ]
Stock Position:  0.003418315887933681
Bond Position:  [-3.6988052]


portfolio before change:  [-3.37391396]
curr_Stock_Price:  95.1795076224495
curr_Factors:  [9.51795076e+01 4.04491452e-02]
mat_Sqrt:  [[ 1.91424767e+01  0.00000000e+00]
 [-8.04478914e-03  1.84329276e-02]]
grads:  [-2.20290447e-03  5.55960801e+00]
Stock Position:  -0.0022029044686162863
Bond Position:  [-3.1642426]


portfolio before change:  [-3.37390146]
curr_Stock_Price:  94.99427267256257
curr_Factors:  [9.49942727e+01 4.08439349e-02]
mat_Sqrt:  [[ 1.91982308e+01  0.00000000e+00]
 [-8.08395298e-03  1.85226632e-02]]
grads:  [ 0.02166098 11.58870601]
Stock Position:  0.02166097507335417
Bond Position:  [-5.43157003]


portfolio before change:  [-3.37021162]
curr_Stock_Price:  95.19596397414408
curr_Factors:  [9.51959640e+01 4.04331362e-02]
mat_Sqrt:  [[ 1.91419973e+01  0.00000000e+00]
 [-8.04319700e-03  1.84292795e-02]]
grads:  [ 0.00129834 -1.07705511]
Stock Position:  0.001298343329344266
Bond Position:  [-3.49380866]


portfolio before change:  [-3.37070785]
curr_Stock_Price:  95.15014895502
curr_Factors:  [9.5150149e+01 3.9735157e-02]
mat_Sqrt:  [[ 1.89669255e+01  0.00000000e+00]
 [-7.97347172e-03  1.82695188e-02]]
grads:  [ 7.50896688e-03 -8.75185361e+00]
Stock Position:  0.0075089668793681865
Bond Position:  [-4.08518717]


portfolio before change:  [-3.3734309]
curr_Stock_Price:  94.85551904992894
curr_Factors:  [9.48555190e+01 3.93180873e-02]
mat_Sqrt:  [[ 1.88087007e+01  0.00000000e+00]
 [-7.93151560e-03  1.81733853e-02]]
grads:  [0.00612535 5.26304954]
Stock Position:  0.006125354264007317
Bond Position:  [-3.95445456]


portfolio before change:  [-3.36576833]
curr_Stock_Price:  96.18718253543771
curr_Factors:  [9.61871825e+01 3.79032898e-02]
mat_Sqrt:  [[ 1.87264587e+01  0.00000000e+00]
 [-7.78750689e-03  1.78434199e-02]]
grads:  [-1.65023668e-03  2.17276588e+00]
Stock Position:  -0.0016502366846090548
Bond Position:  [-3.20703671]


portfolio before change:  [-3.36609805]
curr_Stock_Price:  96.14404941595863
curr_Factors:  [9.61440494e+01 3.67615931e-02]
mat_Sqrt:  [[ 1.84339995e+01  0.00000000e+00]
 [-7.66932520e-03  1.75726316e-02]]
grads:  [-0.01553111 -5.50641731]
Stock Position:  -0.015531105053746547
Bond Position:  [-1.87287472]


portfolio before change:  [-3.37171703]
curr_Stock_Price:  96.49076345981725
curr_Factors:  [9.64907635e+01 3.59672169e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.37171703]
Stock Price:  96.51823203892636
PL:  [-3.37171703]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.09294377e+00  2.75993904e-01]
 [-2.71125357e-01 -9.59904232e-02]
 [-4.08684822e-01 -1.58616022e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.14216989e-01 -2.97478170e-01]
 [-3.63453171e-01  1.95890653e-01]
 [ 2.34620097e-01 -2.57751635e-01]
 [-2.95962910e-01  3.09081986e-01]
 [-1.18223438e-01 -9.86370822e-02]
 [ 5.43130337e-02 -1.28600175e-01]
 [-1.15219717e-01  3.02250875e-04]
 [ 2.70463710e-02 -1.34334963e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-1.03346406e-01  1.59030970e-01]
 [ 4.97910038e-01  3.23119525e-01]
 [ 1.35489705e-01 -3.95738688e-01]
 [ 3.82131918e-02  2.47453126e-03]
 [ 3.16729990e-02 -1.53136972e-01]
 [-1.20860787e-01 -4.00766882e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.18848273e-01 -2.13438579e-02]
 [ 2.99208172e-01 -4.31748359e-01]
 [ 2.84139461e-02 -3.64712225e-01]
 [ 5.30498142e-02  1.60834414e-02]
 [ 4.07242881e-01 -3.19261265e-01]
 [-1.06445784e-01 -1.57765299e-02]
 [-1.78188066e-01 -2.61416619e-02]
 [ 2.67791712e-02  2.75365939e-01]
 [-4.43468285e-03  1.77212710e-01]
 [-5.31193692e-01 -1.01272033e-01]
 [-1.68302823e-01 -6.35269517e-02]
 [ 9.19510749e-03 -7.05381762e-02]
 [-2.62119541e-01  1.40692250e-01]
 [ 6.26347887e-02  6.17844847e-02]
 [-9.95081479e-02  8.96204042e-02]
 [-1.99315583e-01  9.25377055e-02]
 [-2.21230644e-02 -2.24782318e-01]
 [-7.56906979e-02 -5.11735536e-02]
 [ 6.47726969e-02 -1.19672291e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.6920009]
curr_Stock_Price:  101.01760288878943
curr_Factors:  [1.01017603e+02 3.96913170e-02]
mat_Sqrt:  [[ 2.01254135e+01  0.00000000e+00]
 [-7.96907191e-03  1.82594376e-02]]
grads:  [ 0.0602918  15.11513714]
Stock Position:  0.06029179884816882
Bond Position:  [3.60146791]


portfolio before change:  [9.77312278]
curr_Stock_Price:  102.35562344753123
curr_Factors:  [1.02355623e+02 3.93860533e-02]
mat_Sqrt:  [[ 2.03134150e+01  0.00000000e+00]
 [-7.93836793e-03  1.81890860e-02]]
grads:  [-0.01540947 -5.27736377]
Stock Position:  -0.01540947263523711
Bond Position:  [11.35036896]


portfolio before change:  [9.77345241]
curr_Stock_Price:  102.42631086729044
curr_Factors:  [1.02426311e+02 3.92571882e-02]
mat_Sqrt:  [[ 2.02941621e+01  0.00000000e+00]
 [-7.92537073e-03  1.81593056e-02]]
grads:  [-0.02354916 -8.73469645]
Stock Position:  -0.023549162869714826
Bond Position:  [12.18550629]


portfolio before change:  [9.8097506]
curr_Stock_Price:  100.94961676560663
curr_Factors:  [1.00949617e+02 3.89328670e-02]
mat_Sqrt:  [[ 1.99187861e+01  0.00000000e+00]
 [-7.89256531e-03  1.80841390e-02]]
grads:  [-8.18391587e-04 -8.37124801e+00]
Stock Position:  -0.0008183915874061502
Bond Position:  [9.89236692]


portfolio before change:  [9.81034519]
curr_Stock_Price:  101.73412493027267
curr_Factors:  [1.01734125e+02 3.83744340e-02]
mat_Sqrt:  [[ 1.99290981e+01  0.00000000e+00]
 [-7.83575742e-03  1.79539758e-02]]
grads:  [-1.22457677e-02 -1.65689301e+01]
Stock Position:  -0.012245767712055832
Bond Position:  [11.05615765]


portfolio before change:  [9.80780681]
curr_Stock_Price:  102.05427530330414
curr_Factors:  [1.02054275e+02 3.71777256e-02]
mat_Sqrt:  [[ 1.96776219e+01  0.00000000e+00]
 [-7.71261051e-03  1.76718107e-02]]
grads:  [-0.01412566 11.08492251]
Stock Position:  -0.01412566426362793
Bond Position:  [11.24939124]


portfolio before change:  [9.8050696]
curr_Stock_Price:  102.34760479071218
curr_Factors:  [1.02347605e+02 3.68875061e-02]
mat_Sqrt:  [[ 1.96570042e+01  0.00000000e+00]
 [-7.68244816e-03  1.76027001e-02]]
grads:  [ 6.21295392e-03 -1.46427328e+01]
Stock Position:  0.006212953922676839
Bond Position:  [9.16918865]


portfolio before change:  [9.80417239]
curr_Stock_Price:  102.01870693829065
curr_Factors:  [1.02018707e+02 3.74919701e-02]
mat_Sqrt:  [[ 1.97537224e+01  0.00000000e+00]
 [-7.74513732e-03  1.77463390e-02]]
grads:  [-8.15382889e-03  1.74166618e+01]
Stock Position:  -0.008153828885420369
Bond Position:  [10.63601547]


portfolio before change:  [9.79958534]
curr_Stock_Price:  102.74433363695194
curr_Factors:  [1.02744334e+02 3.79226380e-02]
mat_Sqrt:  [[ 2.00081599e+01  0.00000000e+00]
 [-7.78949426e-03  1.78479735e-02]]
grads:  [-0.00806032 -5.52651437]
Stock Position:  -0.008060320936343813
Bond Position:  [10.62773765]


portfolio before change:  [9.81292554]
curr_Stock_Price:  101.25411453968094
curr_Factors:  [1.01254115e+02 3.98951357e-02]
mat_Sqrt:  [[ 2.02242606e+01  0.00000000e+00]
 [-7.98950669e-03  1.83062596e-02]]
grads:  [-8.96291814e-05 -7.02492904e+00]
Stock Position:  -8.962918141200656e-05
Bond Position:  [9.82200086]


portfolio before change:  [9.81433705]
curr_Stock_Price:  99.20466134319238
curr_Factors:  [9.92046613e+01 4.03850461e-02]
mat_Sqrt:  [[ 1.99361995e+01  0.00000000e+00]
 [-8.03841239e-03  1.84183166e-02]]
grads:  [-0.00577281  0.01641034]
Stock Position:  -0.005772805578026378
Bond Position:  [10.38702628]


portfolio before change:  [9.81470644]
curr_Stock_Price:  99.36560073880581
curr_Factors:  [9.93656007e+01 3.73736640e-02]
mat_Sqrt:  [[ 1.92096256e+01  0.00000000e+00]
 [-7.73290776e-03  1.77183176e-02]]
grads:  [-1.64408272e-03 -7.58169973e+00]
Stock Position:  -0.001644082722063453
Bond Position:  [9.97807171]


portfolio before change:  [9.81533564]
curr_Stock_Price:  99.7415795058905
curr_Factors:  [9.97415795e+01 3.65068086e-02]
mat_Sqrt:  [[ 1.90573792e+01  0.00000000e+00]
 [-7.64270199e-03  1.75116302e-02]]
grads:  [-0.00678734 -1.60187286]
Stock Position:  -0.006787338740975137
Bond Position:  [10.49231552]


portfolio before change:  [9.83235305]
curr_Stock_Price:  97.4275964432434
curr_Factors:  [9.74275964e+01 3.62848403e-02]
mat_Sqrt:  [[ 1.85585737e+01  0.00000000e+00]
 [-7.61943203e-03  1.74583120e-02]]
grads:  [-1.82878281e-03  9.10918362e+00]
Stock Position:  -0.001828782813596319
Bond Position:  [10.01052696]


portfolio before change:  [9.83061252]
curr_Stock_Price:  99.06361238237767
curr_Factors:  [9.90636124e+01 3.53988083e-02]
mat_Sqrt:  [[ 1.86383937e+01  0.00000000e+00]
 [-7.52582841e-03  1.72438392e-02]]
grads:  [ 0.03428037 18.73825903]
Stock Position:  0.03428036612420015
Bond Position:  [6.43467562]


portfolio before change:  [9.90419819]
curr_Stock_Price:  101.18673105556604
curr_Factors:  [1.01186731e+02 3.41239869e-02]
mat_Sqrt:  [[ 1.8691900e+01  0.0000000e+00]
 [-7.3890716e-03  1.6930490e-02]]
grads:  [-1.99149461e-03 -2.33743199e+01]
Stock Position:  -0.001991494613476231
Bond Position:  [10.10571102]


portfolio before change:  [9.90628881]
curr_Stock_Price:  100.77130179999304
curr_Factors:  [1.00771302e+02 3.47526321e-02]
mat_Sqrt:  [[ 1.87858444e+01  0.00000000e+00]
 [-7.45682314e-03  1.70857283e-02]]
grads:  [0.00209164 0.14483031]
Stock Position:  0.0020916369242890433
Bond Position:  [9.69551183]


portfolio before change:  [9.91111506]
curr_Stock_Price:  102.4992458001587
curr_Factors:  [1.02499246e+02 3.42752251e-02]
mat_Sqrt:  [[ 1.89762690e+01  0.00000000e+00]
 [-7.40542775e-03  1.69679666e-02]]
grads:  [-1.85291718e-03 -9.02506324e+00]
Stock Position:  -0.0018529171802664872
Bond Position:  [10.10103767]


portfolio before change:  [9.90951804]
curr_Stock_Price:  104.04260927524504
curr_Factors:  [1.04042609e+02 3.31371204e-02]
mat_Sqrt:  [[ 1.89395047e+01  0.00000000e+00]
 [-7.28144166e-03  1.66838788e-02]]
grads:  [-1.56165538e-02 -2.40212056e+01]
Stock Position:  -0.01561655375178925
Bond Position:  [11.53430504]


portfolio before change:  [9.88390037]
curr_Stock_Price:  105.77535687368616
curr_Factors:  [1.05775357e+02 3.23287765e-02]
mat_Sqrt:  [[ 1.90186258e+01  0.00000000e+00]
 [-7.19208193e-03  1.64791299e-02]]
grads:  [-2.54808473e-04 -6.62009401e+00]
Stock Position:  -0.00025480847322400363
Bond Position:  [9.91085283]


portfolio before change:  [9.88533566]
curr_Stock_Price:  105.00476164024289
curr_Factors:  [1.05004762e+02 3.20004601e-02]
mat_Sqrt:  [[ 1.87839578e+01  0.00000000e+00]
 [-7.15546897e-03  1.63952391e-02]]
grads:  [ 0.0058312  -1.30183267]
Stock Position:  0.00583120186426557
Bond Position:  [9.2730317]


portfolio before change:  [9.89322638]
curr_Stock_Price:  106.15915838834658
curr_Factors:  [1.06159158e+02 3.07166446e-02]
mat_Sqrt:  [[ 1.86056288e+01  0.00000000e+00]
 [-7.01046584e-03  1.60629952e-02]]
grads:  [ 5.95399060e-03 -2.68784467e+01]
Stock Position:  0.005953990604088333
Bond Position:  [9.26115575]


portfolio before change:  [9.87928301]
curr_Stock_Price:  103.62286175880699
curr_Factors:  [1.03622862e+02 3.26052214e-02]
mat_Sqrt:  [[ 1.87110931e+01  0.00000000e+00]
 [-7.22276639e-03  1.65494369e-02]]
grads:  [-6.98834204e-03 -2.20377423e+01]
Stock Position:  -0.00698834203510979
Bond Position:  [10.60343501]


portfolio before change:  [9.88790438]
curr_Stock_Price:  102.57885814940522
curr_Factors:  [1.02578858e+02 3.32118765e-02]
mat_Sqrt:  [[ 1.86941003e+01  0.00000000e+00]
 [-7.28965037e-03  1.67026873e-02]]
grads:  [0.00321327 0.96292538]
Stock Position:  0.0032132706379140842
Bond Position:  [9.55829075]


portfolio before change:  [9.89050936]
curr_Stock_Price:  103.01770039059294
curr_Factors:  [1.03017700e+02 3.32195687e-02]
mat_Sqrt:  [[ 1.87762494e+01  0.00000000e+00]
 [-7.29049449e-03  1.67046214e-02]]
grads:  [ 1.42683363e-02 -1.91121521e+01]
Stock Position:  0.014268336337494312
Bond Position:  [8.42061816]


portfolio before change:  [9.89297378]
curr_Stock_Price:  103.1166448858823
curr_Factors:  [1.03116645e+02 3.42152439e-02]
mat_Sqrt:  [[ 1.90738601e+01  0.00000000e+00]
 [-7.39894521e-03  1.69531132e-02]]
grads:  [-0.0059417 -0.9305978]
Stock Position:  -0.005941703737684169
Bond Position:  [10.50566233]


portfolio before change:  [9.90263869]
curr_Stock_Price:  101.71105132375685
curr_Factors:  [1.01711051e+02 3.43812871e-02]
mat_Sqrt:  [[ 1.88594580e+01  0.00000000e+00]
 [-7.41687665e-03  1.69941993e-02]]
grads:  [-0.01005316 -1.5382697 ]
Stock Position:  -0.010053163888771404
Bond Position:  [10.92515656]


portfolio before change:  [9.90382104]
curr_Stock_Price:  101.72929206417791
curr_Factors:  [1.01729292e+02 3.53967478e-02]
mat_Sqrt:  [[ 1.91393728e+01  0.00000000e+00]
 [-7.52560937e-03  1.72433373e-02]]
grads:  [7.67834562e-03 1.59694109e+01]
Stock Position:  0.007678345622022375
Bond Position:  [9.12270838]


portfolio before change:  [9.89433905]
curr_Stock_Price:  100.34586913112648
curr_Factors:  [1.00345869e+02 3.57714727e-02]
mat_Sqrt:  [[ 1.89787633e+01  0.00000000e+00]
 [-7.56533915e-03  1.73343696e-02]]
grads:  [3.84151925e-03 1.02231990e+01]
Stock Position:  0.0038415192470712344
Bond Position:  [9.50885846]


portfolio before change:  [9.89678702]
curr_Stock_Price:  100.67367846099259
curr_Factors:  [1.00673678e+02 3.50492604e-02]
mat_Sqrt:  [[ 1.88475701e+01  0.00000000e+00]
 [-7.48857908e-03  1.71584902e-02]]
grads:  [-0.03052873 -5.90215288]
Stock Position:  -0.030528732818040756
Bond Position:  [12.97022685]


portfolio before change:  [9.8979658]
curr_Stock_Price:  100.68817624048211
curr_Factors:  [1.00688176e+02 3.55080469e-02]
mat_Sqrt:  [[ 1.89732560e+01  0.00000000e+00]
 [-7.53743160e-03  1.72704254e-02]]
grads:  [-0.01033182 -3.67836635]
Stock Position:  -0.010331819541755454
Bond Position:  [10.93825787]


portfolio before change:  [9.90162232]
curr_Stock_Price:  100.46661236498551
curr_Factors:  [1.00466612e+02 3.51313339e-02]
mat_Sqrt:  [[ 1.88308133e+01  0.00000000e+00]
 [-7.49734181e-03  1.71785682e-02]]
grads:  [-1.14653978e-03 -4.10617320e+00]
Stock Position:  -0.001146539776337473
Bond Position:  [10.01681129]


portfolio before change:  [9.9019786]
curr_Stock_Price:  101.24800774954738
curr_Factors:  [1.01248008e+02 3.43409166e-02]
mat_Sqrt:  [[ 1.87625744e+01  0.00000000e+00]
 [-7.41252093e-03  1.69842191e-02]]
grads:  [-0.0106977   8.28370434]
Stock Position:  -0.010697700911187342
Bond Position:  [10.98509951]


portfolio before change:  [9.90781432]
curr_Stock_Price:  100.83086271662975
curr_Factors:  [1.00830863e+02 3.46972116e-02]
mat_Sqrt:  [[ 1.87819539e+01  0.00000000e+00]
 [-7.45087502e-03  1.70720994e-02]]
grads:  [0.00477052 3.61903262]
Stock Position:  0.004770523285335892
Bond Position:  [9.42679834]


portfolio before change:  [9.90624637]
curr_Stock_Price:  100.25516642444232
curr_Factors:  [1.00255166e+02 3.56476526e-02]
mat_Sqrt:  [[ 1.89287629e+01  0.00000000e+00]
 [-7.55223438e-03  1.73043429e-02]]
grads:  [-3.19062568e-03  5.17907007e+00]
Stock Position:  -0.003190625677461917
Bond Position:  [10.22612308]


portfolio before change:  [9.90736162]
curr_Stock_Price:  100.30628417805715
curr_Factors:  [1.00306284e+02 3.67924540e-02]
mat_Sqrt:  [[ 1.92401086e+01  0.00000000e+00]
 [-7.67254367e-03  1.75800061e-02]]
grads:  [-0.00826029  5.26380396]
Stock Position:  -0.008260286901010938
Bond Position:  [10.7359203]


portfolio before change:  [9.90404786]
curr_Stock_Price:  100.8699251253442
curr_Factors:  [1.00869925e+02 3.48608206e-02]
mat_Sqrt:  [[ 1.88334768e+01  0.00000000e+00]
 [-7.46842105e-03  1.71123024e-02]]
grads:  [-6.38363866e-03 -1.31357145e+01]
Stock Position:  -0.006383638663017419
Bond Position:  [10.54796501]


portfolio before change:  [9.91770684]
curr_Stock_Price:  98.93679393485637
curr_Factors:  [9.89367939e+01 3.43912026e-02]
mat_Sqrt:  [[ 1.83476951e+01  0.00000000e+00]
 [-7.41794609e-03  1.69966497e-02]]
grads:  [-0.00534261 -3.01080239]
Stock Position:  -0.005342614817943826
Bond Position:  [10.44628803]


portfolio before change:  [9.91776201]
curr_Stock_Price:  99.1708929424072
curr_Factors:  [9.91708929e+01 3.39346662e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.91776201]
Stock Price:  98.98524522782158
PL:  [9.91776201]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.10365357e+00  2.78415175e-01]
 [-2.14589600e-01 -7.44283721e-02]
 [ 1.52954392e-02 -5.36373839e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.00829036e-01 -1.01323965e-01]
 [-2.40975530e-01  5.79649836e-02]
 [ 1.57127361e-01 -1.47258607e-01]
 [-2.30470548e-01  3.26775629e-01]
 [-1.17977470e-01 -9.75257890e-02]
 [ 1.81203867e-01  4.43807218e-02]
 [-9.99678165e-02 -4.75853252e-03]
 [ 2.41827649e-02 -1.35787543e-01]
 [-1.00865463e-01 -2.47066727e-02]
 [-3.47547885e-02 -4.39148681e-02]
 [ 2.58973075e-01  1.48182155e-01]
 [ 1.26846078e-01 -5.75143913e-01]
 [ 2.33527723e-02 -2.02497004e-01]
 [ 3.64781975e-02 -1.58376226e-01]
 [-1.23116587e-01 -3.78370619e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 9.45802954e-02 -1.33574916e-02]
 [ 2.94436959e-01 -4.48426050e-01]
 [ 2.72529505e-02 -3.41451400e-01]
 [ 1.41770748e-02  1.40730304e-01]
 [ 4.54855192e-01 -4.47003635e-01]
 [-2.76582041e-01  2.31109366e-02]
 [-1.56074559e-01  9.65511165e-02]
 [-2.52085218e-03  2.54760184e-01]
 [-6.60541619e-02  2.05734387e-01]
 [-7.25000730e-01  9.88256658e-02]
 [-1.20178419e-01  7.02108887e-03]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.41443572e-01 -1.67167265e-03]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.45509436e-01 -1.82379276e-02]
 [-2.92903833e-02 -1.60093210e-01]
 [-5.06776371e-03 -6.44442929e-02]
 [ 1.79401071e-01 -1.53589732e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.36991511]
curr_Stock_Price:  100.97085053652657
curr_Factors:  [1.00970851e+02 3.96456600e-02]
mat_Sqrt:  [[ 2.01045261e+01  0.00000000e+00]
 [-7.96448718e-03  1.82489327e-02]]
grads:  [ 0.06093971 15.25651828]
Stock Position:  0.06093970619802668
Bond Position:  [3.21678114]


portfolio before change:  [9.39684491]
curr_Stock_Price:  101.40616084364132
curr_Factors:  [1.01406161e+02 3.86381822e-02]
mat_Sqrt:  [[ 1.99330008e+01  0.00000000e+00]
 [-7.86263896e-03  1.80155691e-02]]
grads:  [-0.01239516 -4.13133616]
Stock Position:  -0.012395163532954044
Bond Position:  [10.65379086]


portfolio before change:  [9.40397889]
curr_Stock_Price:  100.93806147059806
curr_Factors:  [1.00938061e+02 3.78871414e-02]
mat_Sqrt:  [[ 1.96472097e+01  0.00000000e+00]
 [-7.78584782e-03  1.78396185e-02]]
grads:  [-4.12976423e-04 -3.00664411e+00]
Stock Position:  -0.0004129764229913768
Bond Position:  [9.44566393]


portfolio before change:  [9.40554195]
curr_Stock_Price:  100.01238600101692
curr_Factors:  [1.00012386e+02 3.77480795e-02]
mat_Sqrt:  [[ 1.94312715e+01  0.00000000e+00]
 [-7.77154600e-03  1.78068489e-02]]
grads:  [-8.38924360e-04 -8.50160594e+00]
Stock Position:  -0.0008389243596028207
Bond Position:  [9.48944478]


portfolio before change:  [9.40591722]
curr_Stock_Price:  100.97908136679074
curr_Factors:  [1.00979081e+02 3.81301390e-02]
mat_Sqrt:  [[ 1.97181247e+01  0.00000000e+00]
 [-7.81077605e-03  1.78967362e-02]]
grads:  [-0.0073562  -5.66158902]
Stock Position:  -0.007356198519392599
Bond Position:  [10.14873939]


portfolio before change:  [9.40910345]
curr_Stock_Price:  100.7184096172074
curr_Factors:  [1.00718410e+02 4.01874369e-02]
mat_Sqrt:  [[ 2.01908226e+01  0.00000000e+00]
 [-8.01872179e-03  1.83731998e-02]]
grads:  [-0.01068196  3.15486601]
Stock Position:  -0.010681958879152666
Bond Position:  [10.48497336]


portfolio before change:  [9.40357887]
curr_Stock_Price:  101.35829987283829
curr_Factors:  [1.01358300e+02 3.87087411e-02]
mat_Sqrt:  [[ 1.99417763e+01  0.00000000e+00]
 [-7.86981485e-03  1.80320111e-02]]
grads:  [ 4.65647764e-03 -8.16651042e+00]
Stock Position:  0.004656477639544189
Bond Position:  [8.93160621]


portfolio before change:  [9.40691834]
curr_Stock_Price:  101.83568829131639
curr_Factors:  [1.01835688e+02 3.77382922e-02]
mat_Sqrt:  [[ 1.97829532e+01  0.00000000e+00]
 [-7.77053843e-03  1.78045403e-02]]
grads:  [-4.44089262e-03  1.83535000e+01]
Stock Position:  -0.004440892617109078
Bond Position:  [9.8591597]


portfolio before change:  [9.40896597]
curr_Stock_Price:  101.65213094556884
curr_Factors:  [1.01652131e+02 3.98576398e-02]
mat_Sqrt:  [[ 2.02942159e+01  0.00000000e+00]
 [-7.98575129e-03  1.82976549e-02]]
grads:  [-0.00791069 -5.32996111]
Stock Position:  -0.007910688174745358
Bond Position:  [10.21310428]


portfolio before change:  [9.42457596]
curr_Stock_Price:  99.84024419525814
curr_Factors:  [9.98402442e+01 4.12827800e-02]
mat_Sqrt:  [[ 2.02857048e+01  0.00000000e+00]
 [-8.12726571e-03  1.86219052e-02]]
grads:  [0.00988742 2.38325356]
Stock Position:  0.00988741596257494
Bond Position:  [8.43741394]


portfolio before change:  [9.42842336]
curr_Stock_Price:  100.12268986143495
curr_Factors:  [1.00122690e+02 4.18360916e-02]
mat_Sqrt:  [[ 2.04789677e+01  0.00000000e+00]
 [-8.18154915e-03  1.87462842e-02]]
grads:  [-0.0049829  -0.25383871]
Stock Position:  -0.004982898149950573
Bond Position:  [9.92732453]


portfolio before change:  [9.43043696]
curr_Stock_Price:  99.96763851866933
curr_Factors:  [9.99676385e+01 4.23137038e-02]
mat_Sqrt:  [[ 2.05636382e+01  0.00000000e+00]
 [-8.22811802e-03  1.88529868e-02]]
grads:  [-1.70591298e-03 -7.20244194e+00]
Stock Position:  -0.0017059129848821198
Bond Position:  [9.60097305]


portfolio before change:  [9.43079112]
curr_Stock_Price:  100.46358334741842
curr_Factors:  [1.00463583e+02 4.25113487e-02]
mat_Sqrt:  [[ 2.07138633e+01  0.00000000e+00]
 [-8.24731216e-03  1.88969661e-02]]
grads:  [-0.00539003 -1.30744123]
Stock Position:  -0.005390029719118559
Bond Position:  [9.97229282]


portfolio before change:  [9.4259031]
curr_Stock_Price:  101.60172739375112
curr_Factors:  [1.01601727e+02 4.27337518e-02]
mat_Sqrt:  [[ 2.10032549e+01  0.00000000e+00]
 [-8.26885741e-03  1.89463325e-02]]
grads:  [-0.00256726 -2.31785588]
Stock Position:  -0.002567259619431507
Bond Position:  [9.68674111]


portfolio before change:  [9.42544638]
curr_Stock_Price:  102.2513070103301
curr_Factors:  [1.02251307e+02 4.30400007e-02]
mat_Sqrt:  [[ 2.12131422e+01  0.00000000e+00]
 [-8.29843366e-03  1.90141002e-02]]
grads:  [0.01525682 7.79327729]
Stock Position:  0.015256818953372596
Bond Position:  [7.8654167]


portfolio before change:  [9.4303824]
curr_Stock_Price:  102.51038972419033
curr_Factors:  [1.02510390e+02 4.27699213e-02]
mat_Sqrt:  [[ 2.12000610e+01  0.00000000e+00]
 [-8.27235601e-03  1.89543488e-02]]
grads:  [-5.85693147e-03 -3.03436388e+01]
Stock Position:  -0.005856931468656763
Bond Position:  [10.03077872]


portfolio before change:  [9.42456129]
curr_Stock_Price:  103.71836588557748
curr_Factors:  [1.03718366e+02 4.18197784e-02]
mat_Sqrt:  [[ 2.12102862e+01  0.00000000e+00]
 [-8.17995387e-03  1.87426289e-02]]
grads:  [-3.06569016e-03 -1.08040876e+01]
Stock Position:  -0.00306569015500928
Bond Position:  [9.74252966]


portfolio before change:  [9.42406751]
curr_Stock_Price:  104.27669763720266
curr_Factors:  [1.04276698e+02 4.23502517e-02]
mat_Sqrt:  [[ 2.14592859e+01  0.00000000e+00]
 [-8.23167071e-03  1.88611271e-02]]
grads:  [-1.52115286e-03 -8.39696509e+00]
Stock Position:  -0.0015211528568450882
Bond Position:  [9.5826883]


portfolio before change:  [9.42521985]
curr_Stock_Price:  104.30665165344494
curr_Factors:  [1.04306652e+02 4.12765201e-02]
mat_Sqrt:  [[ 2.11915900e+01  0.00000000e+00]
 [-8.12664950e-03  1.86204932e-02]]
grads:  [-1.36021443e-02 -2.03201179e+01]
Stock Position:  -0.013602144257998414
Bond Position:  [10.84401398]


portfolio before change:  [9.42656188]
curr_Stock_Price:  104.30764895718627
curr_Factors:  [1.04307649e+02 4.21685985e-02]
mat_Sqrt:  [[ 2.14195696e+01  0.00000000e+00]
 [-8.21399766e-03  1.88206330e-02]]
grads:  [-2.26246703e-04 -5.79647821e+00]
Stock Position:  -0.00022624670316213812
Bond Position:  [9.45016114]


portfolio before change:  [9.42721699]
curr_Stock_Price:  106.6335581215306
curr_Factors:  [1.06633558e+02 4.12887179e-02]
mat_Sqrt:  [[ 2.16675396e+01  0.00000000e+00]
 [-8.12785019e-03  1.86232444e-02]]
grads:  [ 0.00409602 -0.71724836]
Stock Position:  0.004096016880494698
Bond Position:  [8.99044414]


portfolio before change:  [9.42727321]
curr_Stock_Price:  106.37290140558328
curr_Factors:  [1.06372901e+02 4.10035431e-02]
mat_Sqrt:  [[ 2.15398016e+01  0.00000000e+00]
 [-8.09973265e-03  1.85588190e-02]]
grads:  [ 4.58350489e-03 -2.41624238e+01]
Stock Position:  0.004583504889706675
Bond Position:  [8.9397125]


portfolio before change:  [9.4295962]
curr_Stock_Price:  106.63589906073328
curr_Factors:  [1.06635899e+02 4.23065597e-02]
mat_Sqrt:  [[ 2.19334672e+01  0.00000000e+00]
 [-8.22742338e-03  1.88513952e-02]]
grads:  [-5.55172862e-03 -1.81127920e+01]
Stock Position:  -0.0055517286223632995
Bond Position:  [10.02160977]


portfolio before change:  [9.42938418]
curr_Stock_Price:  106.89974368357743
curr_Factors:  [1.06899744e+02 4.24659765e-02]
mat_Sqrt:  [[ 2.20291237e+01  0.00000000e+00]
 [-8.24290983e-03  1.88868791e-02]]
grads:  [3.43167598e-03 7.45122064e+00]
Stock Position:  0.003431675980636896
Bond Position:  [9.0625389]


portfolio before change:  [9.42669787]
curr_Stock_Price:  105.7868187440768
curr_Factors:  [1.05786819e+02 4.33292216e-02]
mat_Sqrt:  [[ 2.20202376e+01  0.00000000e+00]
 [-8.32626895e-03  1.90778789e-02]]
grads:  [ 1.17967307e-02 -2.34304683e+01]
Stock Position:  0.011796730667586927
Bond Position:  [8.17875926]


portfolio before change:  [9.41313537]
curr_Stock_Price:  104.5504670352059
curr_Factors:  [1.04550467e+02 4.29987415e-02]
mat_Sqrt:  [[ 2.16797290e+01  0.00000000e+00]
 [-8.29445516e-03  1.90049843e-02]]
grads:  [-0.01229239  1.21604607]
Stock Position:  -0.01229238615730671
Bond Position:  [10.69831009]


portfolio before change:  [9.42692155]
curr_Stock_Price:  103.53774231914701
curr_Factors:  [1.03537742e+02 4.41862457e-02]
mat_Sqrt:  [[ 2.17641767e+01  0.00000000e+00]
 [-8.40820987e-03  1.92656291e-02]]
grads:  [-0.00523503  5.01157352]
Stock Position:  -0.005235033624325303
Bond Position:  [9.96894511]


portfolio before change:  [9.43399039]
curr_Stock_Price:  102.42549665252679
curr_Factors:  [1.02425497e+02 4.31737409e-02]
mat_Sqrt:  [[ 2.12822686e+01  0.00000000e+00]
 [-8.31131671e-03  1.90436190e-02]]
grads:  [5.1059222e-03 1.3377719e+01]
Stock Position:  0.005105922198472
Bond Position:  [8.91101377]


portfolio before change:  [9.44536892]
curr_Stock_Price:  104.4358256558486
curr_Factors:  [1.04435826e+02 4.36036080e-02]
mat_Sqrt:  [[ 2.18077429e+01  0.00000000e+00]
 [-8.35259078e-03  1.91381898e-02]]
grads:  [1.08840635e-03 1.07499398e+01]
Stock Position:  0.0010884063530931523
Bond Position:  [9.3317003]


portfolio before change:  [9.44742083]
curr_Stock_Price:  105.2492912136253
curr_Factors:  [1.05249291e+02 4.19187427e-02]
mat_Sqrt:  [[ 2.15488106e+01  0.00000000e+00]
 [-8.18962688e-03  1.87647925e-02]]
grads:  [-0.03164303  5.26654721]
Stock Position:  -0.03164303062162597
Bond Position:  [12.77782738]


portfolio before change:  [9.42602691]
curr_Stock_Price:  105.97587301766019
curr_Factors:  [1.05975873e+02 4.17456923e-02]
mat_Sqrt:  [[ 2.16527388e+01  0.00000000e+00]
 [-8.17270504e-03  1.87260197e-02]]
grads:  [-0.00540875  0.3749376 ]
Stock Position:  -0.005408745991940435
Bond Position:  [9.99922349]


portfolio before change:  [9.43289037]
curr_Stock_Price:  104.9380206414797
curr_Factors:  [1.04938021e+02 4.26515004e-02]
mat_Sqrt:  [[ 2.16720516e+01  0.00000000e+00]
 [-8.26089588e-03  1.89280903e-02]]
grads:  [ 0.00334729 -0.6311883 ]
Stock Position:  0.0033472879372313216
Bond Position:  [9.0816326]


portfolio before change:  [9.43421977]
curr_Stock_Price:  104.99601308488258
curr_Factors:  [1.04996013e+02 4.26308827e-02]
mat_Sqrt:  [[ 2.16787866e+01  0.00000000e+00]
 [-8.25889898e-03  1.89235149e-02]]
grads:  [-0.01117097 -0.08833838]
Stock Position:  -0.011170973452067936
Bond Position:  [10.60712744]


portfolio before change:  [9.42645053]
curr_Stock_Price:  105.8101951121101
curr_Factors:  [1.05810195e+02 4.31169792e-02]
mat_Sqrt:  [[ 2.19710938e+01  0.00000000e+00]
 [-8.30585135e-03  1.90310963e-02]]
grads:  [0.00461839 2.80325737]
Stock Position:  0.004618394179473102
Bond Position:  [8.93777735]


portfolio before change:  [9.42888872]
curr_Stock_Price:  106.09620121039448
curr_Factors:  [1.06096201e+02 4.39463971e-02]
mat_Sqrt:  [[ 2.22413668e+01  0.00000000e+00]
 [-8.38535839e-03  1.92132698e-02]]
grads:  [-0.00425638  4.23275929]
Stock Position:  -0.004256375596869438
Bond Position:  [9.880474]


portfolio before change:  [9.43408274]
curr_Stock_Price:  105.16609271310024
curr_Factors:  [1.05166093e+02 4.44736136e-02]
mat_Sqrt:  [[ 2.21782333e+01  0.00000000e+00]
 [-8.43550720e-03  1.93281751e-02]]
grads:  [-0.01593766 -0.94359284]
Stock Position:  -0.015937659029418058
Bond Position:  [11.11018407]


portfolio before change:  [9.42777783]
curr_Stock_Price:  105.64883458441749
curr_Factors:  [1.05648835e+02 4.35112921e-02]
mat_Sqrt:  [[ 2.20376713e+01  0.00000000e+00]
 [-8.34374420e-03  1.91179197e-02]]
grads:  [-4.49960376e-03 -8.37398696e+00]
Stock Position:  -0.004499603756358647
Bond Position:  [9.90315572]


portfolio before change:  [9.42581208]
curr_Stock_Price:  106.36083399553682
curr_Factors:  [1.06360834e+02 4.24577740e-02]
mat_Sqrt:  [[ 2.19159522e+01  0.00000000e+00]
 [-8.24211371e-03  1.88850550e-02]]
grads:  [-1.51458438e-03 -3.41244931e+00]
Stock Position:  -0.0015145843840120216
Bond Position:  [9.58690454]


portfolio before change:  [9.42746584]
curr_Stock_Price:  106.0602126228633
curr_Factors:  [1.06060213e+02 4.42026678e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.42746584]
Stock Price:  107.88258283557067
PL:  [1.544883]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.27696391e+00  3.17597170e-01]
 [ 6.20318091e-01  1.14563949e-01]
 [ 5.49265808e-02 -4.06003454e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.09840138e-01 -2.33350535e-01]
 [-3.53322021e-01  1.83258071e-01]
 [ 2.66315867e-01 -3.00629688e-01]
 [-6.16558090e-01  1.63391923e-01]
 [-1.08149406e-01 -5.31222981e-02]
 [ 1.82107346e-01  4.82891899e-02]
 [-1.10802363e-01  2.70167281e-03]
 [ 6.87815594e-02 -1.22615389e-01]
 [-1.06820749e-01  2.21697905e-02]
 [-1.32131329e-01  3.39628475e-01]
 [ 1.99549498e-01  1.84304834e-01]
 [ 1.32828455e-01 -7.44618264e-02]
 [ 4.00805071e-02  7.82210648e-02]
 [ 3.65371858e-02  6.80088269e-02]
 [-3.48908733e-03  1.01392300e-02]
 [-3.27144610e-01  1.17721327e-01]
 [ 1.06307944e-01  7.01969585e-02]
 [ 1.31431414e+00  1.38245086e-01]
 [ 1.62292793e-02  3.79018636e-01]
 [-9.76734956e-02  7.84899760e-02]
 [-1.78511439e-01  1.91483642e-01]
 [ 1.27508795e-01 -1.04130169e-01]
 [-1.84390628e-01 -4.48020742e-01]
 [ 6.45533438e-02  6.48246566e-02]
 [ 3.17076648e-01 -9.23558441e-02]
 [-5.30197983e-01 -1.84845311e-01]
 [-1.14845262e-01 -3.93233487e-02]
 [-2.83403828e-02  2.16261437e-03]
 [ 1.68776311e-01  2.01121443e-01]
 [ 7.09308928e-03  6.31110968e-03]
 [ 6.85936036e-02 -3.16987785e-02]
 [-1.47544849e-01  1.09952769e-01]
 [-3.45192140e-02 -1.14728312e-01]
 [ 2.16471236e-02 -2.53967741e-02]
 [-5.98512896e-02 -3.95472085e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.17729477]
curr_Stock_Price:  100.21711591248699
curr_Factors:  [1.00217116e+02 3.97162903e-02]
mat_Sqrt:  [[ 1.99722153e+01  0.00000000e+00]
 [-7.97157855e-03  1.82651811e-02]]
grads:  [ 0.0708772  17.38812058]
Stock Position:  0.07087719914157399
Bond Position:  [-2.92581371]


portfolio before change:  [4.12804634]
curr_Stock_Price:  99.52743459376941
curr_Factors:  [9.95274346e+01 4.02887655e-02]
mat_Sqrt:  [[ 1.99772079e+01  0.00000000e+00]
 [-8.02882462e-03  1.83963483e-02]]
grads:  [0.03355413 6.22753752]
Stock Position:  0.03355413329529839
Bond Position:  [0.78848954]


portfolio before change:  [4.16873482]
curr_Stock_Price:  100.73711878185361
curr_Factors:  [1.00737119e+02 3.88084060e-02]
mat_Sqrt:  [[ 1.98450605e+01  0.00000000e+00]
 [-7.87993970e-03  1.80552101e-02]]
grads:  [ 1.87488152e-03 -2.24867754e+00]
Stock Position:  0.0018748815235164794
Bond Position:  [3.97986465]


portfolio before change:  [4.17035247]
curr_Stock_Price:  101.33456511286147
curr_Factors:  [1.01334565e+02 3.77517695e-02]
mat_Sqrt:  [[ 1.96891181e+01  0.00000000e+00]
 [-7.77192583e-03  1.78077192e-02]]
grads:  [-8.27937893e-04 -8.50119045e+00]
Stock Position:  -0.0008279378927939385
Bond Position:  [4.2542512]


portfolio before change:  [4.17075735]
curr_Stock_Price:  101.48787589400315
curr_Factors:  [1.01487876e+02 3.79444548e-02]
mat_Sqrt:  [[ 1.97691648e+01  0.00000000e+00]
 [-7.79173457e-03  1.78531067e-02]]
grads:  [-1.07077190e-02 -1.30705842e+01]
Stock Position:  -0.010707718973068533
Bond Position:  [5.25746101]


portfolio before change:  [4.16800464]
curr_Stock_Price:  101.80633182386661
curr_Factors:  [1.01806332e+02 3.83586766e-02]
mat_Sqrt:  [[ 1.99391480e+01  0.00000000e+00]
 [-7.83414849e-03  1.79502892e-02]]
grads:  [-0.01370879 10.20919877]
Stock Position:  -0.013708792437050948
Bond Position:  [5.56364651]


portfolio before change:  [4.15576301]
curr_Stock_Price:  102.75004252697126
curr_Factors:  [1.02750043e+02 3.94172973e-02]
mat_Sqrt:  [[ 2.03997775e+01  0.00000000e+00]
 [-7.94151595e-03  1.81962990e-02]]
grads:  [ 6.62312682e-03 -1.65214744e+01]
Stock Position:  0.006623126823846068
Bond Position:  [3.47523644]


portfolio before change:  [4.15945899]
curr_Stock_Price:  103.24249104185255
curr_Factors:  [1.03242491e+02 3.84992112e-02]
mat_Sqrt:  [[ 2.02574320e+01  0.00000000e+00]
 [-7.84848635e-03  1.79831414e-02]]
grads:  [-0.02691595  9.08583875]
Stock Position:  -0.026915949023680427
Bond Position:  [6.93832861]


portfolio before change:  [4.22320132]
curr_Stock_Price:  100.90651598633178
curr_Factors:  [1.00906516e+02 4.02339599e-02]
mat_Sqrt:  [[ 2.02402373e+01  0.00000000e+00]
 [-8.02336188e-03  1.83838316e-02]]
grads:  [-0.00648875 -2.88962059]
Stock Position:  -0.006488751862810988
Bond Position:  [4.87795866]


portfolio before change:  [4.23371956]
curr_Stock_Price:  99.37949540761396
curr_Factors:  [9.93794954e+01 4.03754804e-02]
mat_Sqrt:  [[ 1.99689688e+01  0.00000000e+00]
 [-8.03746034e-03  1.84161352e-02]]
grads:  [0.01017491 2.62211313]
Stock Position:  0.01017491077241865
Bond Position:  [3.22254206]


portfolio before change:  [4.22942115]
curr_Stock_Price:  98.91745166969591
curr_Factors:  [9.89174517e+01 4.06175372e-02]
mat_Sqrt:  [[ 1.99356185e+01  0.00000000e+00]
 [-8.06151720e-03  1.84712564e-02]]
grads:  [-0.00549886  0.14626362]
Stock Position:  -0.005498864079940672
Bond Position:  [4.77335477]


portfolio before change:  [4.23926116]
curr_Stock_Price:  97.23650398628794
curr_Factors:  [9.72365040e+01 4.05232337e-02]
mat_Sqrt:  [[ 1.95740811e+01  0.00000000e+00]
 [-8.05215337e-03  1.84498012e-02]]
grads:  [ 7.80001694e-04 -6.64589216e+00]
Stock Position:  0.0007800016943746559
Bond Position:  [4.16341652]


portfolio before change:  [4.23857042]
curr_Stock_Price:  95.68368880023274
curr_Factors:  [9.56836888e+01 4.19886872e-02]
mat_Sqrt:  [[ 1.96066799e+01  0.00000000e+00]
 [-8.19645653e-03  1.87804412e-02]]
grads:  [-0.00495469  1.18047229]
Stock Position:  -0.004954691982162845
Bond Position:  [4.71265362]


portfolio before change:  [4.2403948]
curr_Stock_Price:  95.43437772394843
curr_Factors:  [9.54343777e+01 4.24556521e-02]
mat_Sqrt:  [[ 1.96640334e+01  0.00000000e+00]
 [-8.24190775e-03  1.88845831e-02]]
grads:  [8.18483632e-04 1.79844307e+01]
Stock Position:  0.0008184836317391154
Bond Position:  [4.16228332]


portfolio before change:  [4.24012938]
curr_Stock_Price:  94.47439610606081
curr_Factors:  [9.44743961e+01 4.31267250e-02]
mat_Sqrt:  [[ 1.96194742e+01  0.00000000e+00]
 [-8.30679000e-03  1.90332470e-02]]
grads:  [0.01427086 9.68331019]
Stock Position:  0.014270857577861569
Bond Position:  [2.89189873]


portfolio before change:  [4.25330618]
curr_Stock_Price:  95.37239996471963
curr_Factors:  [9.53724000e+01 4.18651928e-02]
mat_Sqrt:  [[ 1.95141329e+01  0.00000000e+00]
 [-8.18439421e-03  1.87528030e-02]]
grads:  [ 0.00514144 -3.97070382]
Stock Position:  0.005141435174196041
Bond Position:  [3.76295517]


portfolio before change:  [4.25425788]
curr_Stock_Price:  95.46601188289773
curr_Factors:  [9.54660119e+01 4.09075757e-02]
mat_Sqrt:  [[ 1.93085940e+01  0.00000000e+00]
 [-8.09024852e-03  1.85370881e-02]]
grads:  [3.84383132e-03 4.21970615e+00]
Stock Position:  0.0038438313210429065
Bond Position:  [3.88730263]


portfolio before change:  [4.26410315]
curr_Stock_Price:  97.90090862829614
curr_Factors:  [9.79009086e+01 3.97889462e-02]
mat_Sqrt:  [[ 1.95284575e+01  0.00000000e+00]
 [-7.97886671e-03  1.82818803e-02]]
grads:  [3.39088078e-03 3.72001270e+00]
Stock Position:  0.0033908807796615014
Bond Position:  [3.93213284]


portfolio before change:  [4.26019322]
curr_Stock_Price:  96.60287358564318
curr_Factors:  [9.66028736e+01 3.89065512e-02]
mat_Sqrt:  [[ 1.90546692e+01  0.00000000e+00]
 [-7.88989746e-03  1.80780262e-02]]
grads:  [4.91236771e-05 5.60859348e-01]
Stock Position:  4.912367714866975e-05
Bond Position:  [4.25544773]


portfolio before change:  [4.26075031]
curr_Stock_Price:  97.11442052028801
curr_Factors:  [9.71144205e+01 3.77693680e-02]
mat_Sqrt:  [[ 1.88735494e+01  0.00000000e+00]
 [-7.77373712e-03  1.78118694e-02]]
grads:  [-0.01461129  6.6091506 ]
Stock Position:  -0.014611285078318688
Bond Position:  [5.6797168]


portfolio before change:  [4.28333019]
curr_Stock_Price:  95.61764153011312
curr_Factors:  [9.56176415e+01 3.81178836e-02]
mat_Sqrt:  [[ 1.86681988e+01  0.00000000e+00]
 [-7.80952071e-03  1.78938599e-02]]
grads:  [0.00733571 3.92296346]
Stock Position:  0.007335705487253559
Bond Position:  [3.58190733]


portfolio before change:  [4.2906345]
curr_Stock_Price:  96.55232261363781
curr_Factors:  [9.65523226e+01 3.76393679e-02]
mat_Sqrt:  [[ 1.87319887e+01  0.00000000e+00]
 [-7.76034720e-03  1.77811892e-02]]
grads:  [0.07338512 7.77479414]
Stock Position:  0.07338512039498261
Bond Position:  [-2.79486932]


portfolio before change:  [4.29216359]
curr_Stock_Price:  96.5779201407329
curr_Factors:  [9.65779201e+01 3.76583209e-02]
mat_Sqrt:  [[ 1.87416716e+01  0.00000000e+00]
 [-7.76230078e-03  1.77856654e-02]]
grads:  [9.69212231e-03 2.13103433e+01]
Stock Position:  0.009692122308940959
Bond Position:  [3.35611858]


portfolio before change:  [4.3070049]
curr_Stock_Price:  98.06590827493314
curr_Factors:  [9.80659083e+01 3.76874243e-02]
mat_Sqrt:  [[ 1.90377791e+01  0.00000000e+00]
 [-7.76529967e-03  1.77925368e-02]]
grads:  [-3.33114810e-03  4.41139884e+00]
Stock Position:  -0.0033311480963688195
Bond Position:  [4.63367696]


portfolio before change:  [4.3117493]
curr_Stock_Price:  96.81554096368237
curr_Factors:  [9.68155410e+01 3.79966242e-02]
mat_Sqrt:  [[ 1.88719850e+01  0.00000000e+00]
 [-7.79708912e-03  1.78653755e-02]]
grads:  [-5.03079700e-03  1.07181426e+01]
Stock Position:  -0.005030797004440725
Bond Position:  [4.79880864]


portfolio before change:  [4.30815353]
curr_Stock_Price:  97.64953610845389
curr_Factors:  [9.76495361e+01 3.75917703e-02]
mat_Sqrt:  [[ 1.89328753e+01  0.00000000e+00]
 [-7.75543890e-03  1.77699429e-02]]
grads:  [ 4.33440046e-03 -5.85990455e+00]
Stock Position:  0.004334400458006848
Bond Position:  [3.88490134]


portfolio before change:  [4.30593369]
curr_Stock_Price:  97.02534700693506
curr_Factors:  [9.70253470e+01 3.84001226e-02]
mat_Sqrt:  [[ 1.90130377e+01  0.00000000e+00]
 [-7.83837969e-03  1.79599841e-02]]
grads:  [-1.99822309e-02 -2.49454976e+01]
Stock Position:  -0.01998223089764069
Bond Position:  [6.24471658]


portfolio before change:  [4.31096578]
curr_Stock_Price:  96.81258511826378
curr_Factors:  [9.68125851e+01 3.93778220e-02]
mat_Sqrt:  [[ 1.92113402e+01  0.00000000e+00]
 [-7.93753836e-03  1.81871852e-02]]
grads:  [0.00483283 3.56430398]
Stock Position:  0.0048328301099836045
Bond Position:  [3.84308701]


portfolio before change:  [4.31159308]
curr_Stock_Price:  96.84297748694478
curr_Factors:  [9.68429775e+01 3.96457135e-02]
mat_Sqrt:  [[ 1.92826293e+01  0.00000000e+00]
 [-7.96449255e-03  1.82489450e-02]]
grads:  [ 0.01435329 -5.06088676]
Stock Position:  0.014353294297905989
Bond Position:  [2.92157732]


portfolio before change:  [4.31328888]
curr_Stock_Price:  96.93567952306584
curr_Factors:  [9.69356795e+01 3.89641407e-02]
mat_Sqrt:  [[ 1.91344600e+01  0.00000000e+00]
 [-7.89573462e-03  1.80914008e-02]]
grads:  [ -0.03192518 -10.21730229]
Stock Position:  -0.03192518052789007
Bond Position:  [7.40797795]


portfolio before change:  [4.30247924]
curr_Stock_Price:  97.30327934883385
curr_Factors:  [9.73032793e+01 3.74968125e-02]
mat_Sqrt:  [[ 1.88418982e+01  0.00000000e+00]
 [-7.74563748e-03  1.77474850e-02]]
grads:  [-0.00700606 -2.21571387]
Stock Position:  -0.007006055180163826
Bond Position:  [4.98419139]


portfolio before change:  [4.30478827]
curr_Stock_Price:  97.06263592284057
curr_Factors:  [9.70626359e+01 3.79038818e-02]
mat_Sqrt:  [[ 1.88970462e+01  0.00000000e+00]
 [-7.78756771e-03  1.78435593e-02]]
grads:  [-0.00144978  0.1211986 ]
Stock Position:  -0.0014497789845490066
Bond Position:  [4.44550764]


portfolio before change:  [4.30616597]
curr_Stock_Price:  96.49567050607929
curr_Factors:  [9.64956705e+01 3.70270702e-02]
mat_Sqrt:  [[ 1.85681016e+01  0.00000000e+00]
 [-7.69696773e-03  1.76359686e-02]]
grads:  [ 0.01381686 11.4040486 ]
Stock Position:  0.013816862443851512
Bond Position:  [2.97289856]


portfolio before change:  [4.32003824]
curr_Stock_Price:  97.4727834141967
curr_Factors:  [9.74727834e+01 3.76559049e-02]
mat_Sqrt:  [[ 1.89147198e+01  0.00000000e+00]
 [-7.76205178e-03  1.77850949e-02]]
grads:  [0.00052063 0.35485387]
Stock Position:  0.0005206253896264106
Bond Position:  [4.26929143]


portfolio before change:  [4.32064769]
curr_Stock_Price:  97.61830053289074
curr_Factors:  [9.76183005e+01 3.75111471e-02]
mat_Sqrt:  [[ 1.89065120e+01  0.00000000e+00]
 [-7.74711788e-03  1.77508770e-02]]
grads:  [ 0.00289631 -1.78575844]
Stock Position:  0.0028963101391349254
Bond Position:  [4.03791482]


portfolio before change:  [4.32542339]
curr_Stock_Price:  99.09291037826196
curr_Factors:  [9.90929104e+01 3.65041819e-02]
mat_Sqrt:  [[ 1.89327584e+01  0.00000000e+00]
 [-7.64242703e-03  1.75110002e-02]]
grads:  [-5.25847974e-03  6.27906845e+00]
Stock Position:  -0.005258479735351788
Bond Position:  [4.84650145]


portfolio before change:  [4.32726953]
curr_Stock_Price:  98.85704638894451
curr_Factors:  [9.88570464e+01 3.78392064e-02]
mat_Sqrt:  [[ 1.92299715e+01  0.00000000e+00]
 [-7.78092091e-03  1.78283295e-02]]
grads:  [-4.39890171e-03 -6.43516891e+00]
Stock Position:  -0.0043989017057343
Bond Position:  [4.76213196]


portfolio before change:  [4.31864758]
curr_Stock_Price:  100.95239977399139
curr_Factors:  [1.00952400e+02 3.82221251e-02]
mat_Sqrt:  [[ 1.97366783e+01  0.00000000e+00]
 [-7.82019182e-03  1.79183105e-02]]
grads:  [ 5.35199618e-04 -1.41736433e+00]
Stock Position:  0.0005351996179129633
Bond Position:  [4.26461789]


portfolio before change:  [4.31990157]
curr_Stock_Price:  102.29933377452295
curr_Factors:  [1.02299334e+02 3.86548713e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.31990157]
Stock Price:  101.96498446859239
PL:  [2.3549171]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.49120097e+00  3.66031876e-01]
 [ 1.53283392e+00  2.79824956e-02]
 [-7.13736228e-02  1.14217114e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.78422024e-01  1.26755799e+00]
 [ 3.54517875e-03 -7.69711968e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.29968333e-01  8.23235954e-01]
 [-2.88722421e-02  2.55199887e-01]
 [ 1.82151932e-01  4.84820731e-02]
 [-1.11954709e-01 -7.81122053e-04]
 [ 2.99107561e-02 -1.35602998e-01]
 [-1.12446282e-01 -2.65699730e-02]
 [-4.81810286e-02 -3.40311642e-02]
 [ 4.23467302e-01  2.67894406e-01]
 [ 1.33036505e-01 -3.03966521e-01]
 [ 3.94600022e-02  8.11062020e-02]
 [-1.53842005e-03 -1.80429472e-02]
 [-1.03055670e-01 -3.99519267e-01]
 [-6.59206140e-02 -4.54637745e-02]
 [ 1.71919830e-01 -4.03789220e-02]
 [ 6.41326429e-01 -1.34710862e-01]
 [ 3.02420804e-02 -4.12941916e-01]
 [ 5.54147084e-02  7.09824103e-03]
 [ 3.39343451e-01 -2.39601251e-01]
 [ 1.78461886e-01 -8.63742741e-02]
 [-1.77126960e-01  2.90897065e-02]
 [-4.23757672e-02  9.66797634e-02]
 [-4.71627696e-02  1.96940541e-01]
 [-6.94312700e-01 -4.01461544e-02]
 [-1.54997019e-01 -3.10076784e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.37978667e-01 -1.18403177e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.02830446e-01 -7.95534588e-02]
 [-3.04046715e-02 -1.49775486e-01]
 [ 1.90210397e-03 -6.39649005e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.22303504]
curr_Stock_Price:  99.28807626124888
curr_Factors:  [9.92880763e+01 4.05719424e-02]
mat_Sqrt:  [[ 1.99990790e+01  0.00000000e+00]
 [-8.05699124e-03  1.84608861e-02]]
grads:  [ 0.08255132 19.82742724]
Stock Position:  0.08255132017888946
Bond Position:  [-10.41939681]


portfolio before change:  [-2.41632156]
curr_Stock_Price:  96.96244395300847
curr_Factors:  [9.69624440e+01 4.10620333e-02]
mat_Sqrt:  [[ 1.96482456e+01  0.00000000e+00]
 [-8.10550759e-03  1.85720510e-02]]
grads:  [0.07863534 1.50669926]
Stock Position:  0.07863534018776265
Bond Position:  [-10.04099633]


portfolio before change:  [-2.38975461]
curr_Stock_Price:  97.31625633845286
curr_Factors:  [9.73162563e+01 4.04127948e-02]
mat_Sqrt:  [[ 1.95634226e+01  0.00000000e+00]
 [-8.04117353e-03  1.84246432e-02]]
grads:  [-1.10027718e-03  6.19914931e+00]
Stock Position:  -0.001100277179852434
Bond Position:  [-2.28267975]


portfolio before change:  [-2.38936017]
curr_Stock_Price:  96.6984222337724
curr_Factors:  [9.66984222e+01 4.15466623e-02]
mat_Sqrt:  [[ 1.97100378e+01  0.00000000e+00]
 [-8.15319935e-03  1.86813266e-02]]
grads:  [-8.27059141e-04 -8.10364359e+00]
Stock Position:  -0.0008270591406060584
Bond Position:  [-2.30938486]


portfolio before change:  [-2.3885659]
curr_Stock_Price:  95.38900739230844
curr_Factors:  [9.53890074e+01 4.14944995e-02]
mat_Sqrt:  [[ 1.94309304e+01  0.00000000e+00]
 [-8.14807948e-03  1.86695955e-02]]
grads:  [1.92880953e-02 6.78942395e+01]
Stock Position:  0.019288095276527747
Bond Position:  [-4.22843816]


portfolio before change:  [-2.34583372]
curr_Stock_Price:  97.63188155748425
curr_Factors:  [9.76318816e+01 4.02091710e-02]
mat_Sqrt:  [[ 1.95773641e+01  0.00000000e+00]
 [-8.02088983e-03  1.83781674e-02]]
grads:  [-1.53482386e-03 -4.18818673e+00]
Stock Position:  -0.001534823860510405
Bond Position:  [-2.19598598]


portfolio before change:  [-2.34644886]
curr_Stock_Price:  97.85381002255251
curr_Factors:  [9.78538100e+01 4.01021319e-02]
mat_Sqrt:  [[ 1.95957311e+01  0.00000000e+00]
 [-8.01020668e-03  1.83536892e-02]]
grads:  [0.00660214 5.23801433]
Stock Position:  0.006602140884726369
Bond Position:  [-2.9924935]


portfolio before change:  [-2.34612956]
curr_Stock_Price:  97.95883337913995
curr_Factors:  [9.79588334e+01 4.05838773e-02]
mat_Sqrt:  [[ 1.97342385e+01  0.00000000e+00]
 [-8.05817620e-03  1.84636012e-02]]
grads:  [ 0.06026369 44.58696573]
Stock Position:  0.06026368634246705
Bond Position:  [-8.24948997]


portfolio before change:  [-2.29915873]
curr_Stock_Price:  98.75536743487966
curr_Factors:  [9.87553674e+01 4.07602838e-02]
mat_Sqrt:  [[ 1.99378952e+01  0.00000000e+00]
 [-8.07567050e-03  1.85036857e-02]]
grads:  [4.13815596e-03 1.37918408e+01]
Stock Position:  0.004138155959515468
Bond Position:  [-2.70782385]


portfolio before change:  [-2.29701049]
curr_Stock_Price:  99.35629767034037
curr_Factors:  [9.93562977e+01 3.98227193e-02]
mat_Sqrt:  [[ 1.98271758e+01  0.00000000e+00]
 [-7.98225225e-03  1.82896376e-02]]
grads:  [0.01025417 2.65079463]
Stock Position:  0.010254170649963422
Bond Position:  [-3.31582692]


portfolio before change:  [-2.29540014]
curr_Stock_Price:  99.55376422179494
curr_Factors:  [9.95537642e+01 4.03432508e-02]
mat_Sqrt:  [[ 1.99960001e+01  0.00000000e+00]
 [-8.03425176e-03  1.84087834e-02]]
grads:  [-0.0056159  -0.04243203]
Stock Position:  -0.005615904079996169
Bond Position:  [-1.73631575]


portfolio before change:  [-2.28906609]
curr_Stock_Price:  98.38723800606711
curr_Factors:  [9.83872380e+01 4.14566098e-02]
mat_Sqrt:  [[ 2.00325235e+01  0.00000000e+00]
 [-8.14435852e-03  1.86610697e-02]]
grads:  [-1.46118607e-03 -7.26662513e+00]
Stock Position:  -0.0014611860653827016
Bond Position:  [-2.14530403]


portfolio before change:  [-2.29195264]
curr_Stock_Price:  100.17918574098105
curr_Factors:  [1.00179186e+02 4.08973579e-02]
mat_Sqrt:  [[ 2.02593321e+01  0.00000000e+00]
 [-8.08923807e-03  1.85347729e-02]]
grads:  [-0.00612273 -1.43352029]
Stock Position:  -0.006122727483811681
Bond Position:  [-1.67858279]


portfolio before change:  [-2.28843947]
curr_Stock_Price:  99.57112193968868
curr_Factors:  [9.95711219e+01 4.24771740e-02]
mat_Sqrt:  [[ 2.05215995e+01  0.00000000e+00]
 [-8.24399651e-03  1.88893690e-02]]
grads:  [-0.00307157 -1.80160408]
Stock Position:  -0.0030715659469440697
Bond Position:  [-1.9826002]


portfolio before change:  [-2.29112765]
curr_Stock_Price:  100.36561562079136
curr_Factors:  [1.00365616e+02 4.19851331e-02]
mat_Sqrt:  [[ 2.05651897e+01  0.00000000e+00]
 [-8.19610962e-03  1.87796464e-02]]
grads:  [ 0.02627673 14.26514644]
Stock Position:  0.02627673336254858
Bond Position:  [-4.92840817]


portfolio before change:  [-2.28742938]
curr_Stock_Price:  100.52980500187458
curr_Factors:  [1.00529805e+02 4.22978541e-02]
mat_Sqrt:  [[ 2.06754041e+01  0.00000000e+00]
 [-8.22657684e-03  1.88494555e-02]]
grads:  [ 1.81200525e-05 -1.61260107e+01]
Stock Position:  1.8120052544147418e-05
Bond Position:  [-2.28925098]


portfolio before change:  [-2.28772416]
curr_Stock_Price:  100.0549333685766
curr_Factors:  [1.00054933e+02 4.25241292e-02]
mat_Sqrt:  [[ 2.06327075e+01  0.00000000e+00]
 [-8.24855180e-03  1.88998065e-02]]
grads:  [3.62810604e-03 4.29137738e+00]
Stock Position:  0.0036281060386540716
Bond Position:  [-2.65073406]


portfolio before change:  [-2.2910273]
curr_Stock_Price:  99.23583406527054
curr_Factors:  [9.92358341e+01 4.21066486e-02]
mat_Sqrt:  [[ 2.03630985e+01  0.00000000e+00]
 [-8.20796185e-03  1.88068032e-02]]
grads:  [-4.62258128e-04 -9.59384057e-01]
Stock Position:  -0.00046225812755872417
Bond Position:  [-2.24515473]


portfolio before change:  [-2.29160341]
curr_Stock_Price:  99.87498020658226
curr_Factors:  [9.98749802e+01 4.37554558e-02]
mat_Sqrt:  [[ 2.08916534e+01  0.00000000e+00]
 [-8.36712193e-03  1.91714848e-02]]
grads:  [-1.32789956e-02 -2.08392449e+01]
Stock Position:  -0.013278995585310755
Bond Position:  [-0.96536399]


portfolio before change:  [-2.29357777]
curr_Stock_Price:  100.0145754385884
curr_Factors:  [1.00014575e+02 4.22825346e-02]
mat_Sqrt:  [[ 2.05657145e+01  0.00000000e+00]
 [-8.22508695e-03  1.88460418e-02]]
grads:  [-0.00417018 -2.41237789]
Stock Position:  -0.004170175168815304
Bond Position:  [-1.87649947]


portfolio before change:  [-2.29820854]
curr_Stock_Price:  101.0687743496439
curr_Factors:  [1.01068774e+02 4.17542218e-02]
mat_Sqrt:  [[ 2.06522416e+01  0.00000000e+00]
 [-8.17353993e-03  1.87279327e-02]]
grads:  [ 0.0074712  -2.15608005]
Stock Position:  0.007471199812795013
Bond Position:  [-3.05331355]


portfolio before change:  [-2.29737488]
curr_Stock_Price:  101.23144535276624
curr_Factors:  [1.01231445e+02 4.27556026e-02]
mat_Sqrt:  [[ 2.09320592e+01  0.00000000e+00]
 [-8.27097118e-03  1.89511757e-02]]
grads:  [ 0.02782974 -7.10831156]
Stock Position:  0.02782974116320008
Bond Position:  [-5.11461981]


portfolio before change:  [-2.26568448]
curr_Stock_Price:  102.39314406571792
curr_Factors:  [1.02393144e+02 4.19031127e-02]
mat_Sqrt:  [[ 2.09601324e+01  0.00000000e+00]
 [-8.18809992e-03  1.87612938e-02]]
grads:  [-7.15551526e-03 -2.20103112e+01]
Stock Position:  -0.007155515263925738
Bond Position:  [-1.53300877]


portfolio before change:  [-2.25903882]
curr_Stock_Price:  101.43761612906538
curr_Factors:  [1.01437616e+02 4.23017359e-02]
mat_Sqrt:  [[ 2.08630659e+01  0.00000000e+00]
 [-8.22695432e-03  1.88503205e-02]]
grads:  [0.0028046  0.37655811]
Stock Position:  0.002804603847936283
Bond Position:  [-2.54353115]


portfolio before change:  [-2.25712817]
curr_Stock_Price:  102.23224355265029
curr_Factors:  [1.02232244e+02 4.23262233e-02]
mat_Sqrt:  [[ 2.10325849e+01  0.00000000e+00]
 [-8.22933517e-03  1.88557757e-02]]
grads:  [ 1.11623413e-02 -1.27070482e+01]
Stock Position:  0.011162341331835343
Bond Position:  [-3.39827936]


portfolio before change:  [-2.27327113]
curr_Stock_Price:  100.82410270041605
curr_Factors:  [1.00824103e+02 4.30306430e-02]
mat_Sqrt:  [[ 2.09147792e+01  0.00000000e+00]
 [-8.29753149e-03  1.90120331e-02]]
grads:  [ 0.00673041 -4.54313717]
Stock Position:  0.006730411100343406
Bond Position:  [-2.95185879]


portfolio before change:  [-2.26494143]
curr_Stock_Price:  102.1165505278943
curr_Factors:  [1.02116551e+02 4.14696029e-02]
mat_Sqrt:  [[ 2.07951029e+01  0.00000000e+00]
 [-8.14563470e-03  1.86639938e-02]]
grads:  [-0.00790721  1.55860031]
Stock Position:  -0.007907206424598
Bond Position:  [-1.45748478]


portfolio before change:  [-2.27923446]
curr_Stock_Price:  103.9011038726945
curr_Factors:  [1.03901104e+02 4.04454607e-02]
mat_Sqrt:  [[ 2.08956100e+01  0.00000000e+00]
 [-8.04442273e-03  1.84320880e-02]]
grads:  [-8.67450917e-06  5.24518780e+00]
Stock Position:  -8.674509173150498e-06
Bond Position:  [-2.27833316]


portfolio before change:  [-2.27951245]
curr_Stock_Price:  103.11541009388577
curr_Factors:  [1.03115410e+02 4.01522358e-02]
mat_Sqrt:  [[ 2.06622894e+01  0.00000000e+00]
 [-8.01520912e-03  1.83651513e-02]]
grads:  [1.87729096e-03 1.07236003e+01]
Stock Position:  0.0018772909550810034
Bond Position:  [-2.47309008]


portfolio before change:  [-2.27882298]
curr_Stock_Price:  103.64736299673677
curr_Factors:  [1.03647363e+02 3.90681287e-02]
mat_Sqrt:  [[ 2.04865846e+01  0.00000000e+00]
 [-7.90626372e-03  1.81155260e-02]]
grads:  [-0.03474634 -2.21611862]
Stock Position:  -0.03474634404086304
Bond Position:  [1.32254396]


portfolio before change:  [-2.2787848]
curr_Stock_Price:  103.65102245356792
curr_Factors:  [1.03651022e+02 3.90928919e-02]
mat_Sqrt:  [[ 2.04937998e+01  0.00000000e+00]
 [-7.90876899e-03  1.81212663e-02]]
grads:  [-0.00822346 -1.71112095]
Stock Position:  -0.008223456871143031
Bond Position:  [-1.42641509]


portfolio before change:  [-2.28949974]
curr_Stock_Price:  104.93231139545075
curr_Factors:  [1.04932311e+02 3.86956666e-02]
mat_Sqrt:  [[ 2.06414597e+01  0.00000000e+00]
 [-7.86848566e-03  1.80289656e-02]]
grads:  [ 0.00351441 -0.66266637]
Stock Position:  0.003514412149832146
Bond Position:  [-2.65827513]


portfolio before change:  [-2.28876424]
curr_Stock_Price:  105.23614570999952
curr_Factors:  [1.05236146e+02 3.86719436e-02]
mat_Sqrt:  [[ 2.06948810e+01  0.00000000e+00]
 [-7.86607334e-03  1.80234383e-02]]
grads:  [-0.0117491  -0.65694001]
Stock Position:  -0.011749098959144123
Bond Position:  [-1.05233435]


portfolio before change:  [-2.29102818]
curr_Stock_Price:  105.4176397345598
curr_Factors:  [1.05417640e+02 3.78525952e-02]
mat_Sqrt:  [[ 2.05097855e+01  0.00000000e+00]
 [-7.78229737e-03  1.78314834e-02]]
grads:  [0.00494745 2.99184648]
Stock Position:  0.004947451630031569
Bond Position:  [-2.81257686]


portfolio before change:  [-2.28728066]
curr_Stock_Price:  106.24617172492023
curr_Factors:  [1.06246172e+02 3.83807518e-02]
mat_Sqrt:  [[ 2.08146939e+01  0.00000000e+00]
 [-7.83640242e-03  1.79554536e-02]]
grads:  [-0.00454811  4.52927271]
Stock Position:  -0.004548114475094723
Bond Position:  [-1.8040609]


portfolio before change:  [-2.29163648]
curr_Stock_Price:  107.15430566332415
curr_Factors:  [1.07154306e+02 3.88788497e-02]
mat_Sqrt:  [[ 2.11283864e+01  0.00000000e+00]
 [-7.88708815e-03  1.80715892e-02]]
grads:  [-0.02070913 -4.40212854]
Stock Position:  -0.020709126330862488
Bond Position:  [-0.07256442]


portfolio before change:  [-2.28762062]
curr_Stock_Price:  106.95995042255196
curr_Factors:  [1.06959950e+02 3.96345033e-02]
mat_Sqrt:  [[ 2.12940320e+01  0.00000000e+00]
 [-7.96336645e-03  1.82463648e-02]]
grads:  [-4.49760067e-03 -8.20851101e+00]
Stock Position:  -0.004497600670146977
Bond Position:  [-1.80655747]


portfolio before change:  [-2.29087271]
curr_Stock_Price:  107.63281042517136
curr_Factors:  [1.07632810e+02 3.95798854e-02]
mat_Sqrt:  [[ 2.14132184e+01  0.00000000e+00]
 [-7.95787764e-03  1.82337883e-02]]
grads:  [-1.21487890e-03 -3.50804229e+00]
Stock Position:  -0.0012148789047901531
Bond Position:  [-2.16011188]


portfolio before change:  [-2.29281234]
curr_Stock_Price:  109.00710224818624
curr_Factors:  [1.09007102e+02 3.98010687e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.29281234]
Stock Price:  107.2942592586827
PL:  [-9.5870716]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.38489918e+00  3.41999172e-01]
 [ 2.03209190e-02  2.99820588e-02]
 [ 1.10132506e-01 -1.69436268e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.49429161e-02  1.96918515e-01]
 [ 5.15183189e-03 -7.51700918e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.01974663e+00  1.03347223e+00]
 [ 6.31439369e-02  5.01153109e-01]
 [ 5.82844258e-02 -1.33321254e-01]
 [ 7.55078369e-02  1.57453133e-02]
 [ 4.54745132e-02 -6.07614367e-02]
 [ 1.16072058e-02  4.70765892e-01]
 [-1.53426409e-01  5.38468875e-01]
 [ 3.96827218e-03  9.78179214e-02]
 [ 1.30987265e-01 -1.18471473e-01]
 [ 3.71961392e-02 -5.62030101e-02]
 [ 3.77346198e-01  6.27718739e-02]
 [ 3.75908645e-01  3.88094591e-01]
 [-7.64498203e-01  3.69398862e-01]
 [-1.90618596e-01  3.25996178e-01]
 [ 1.93525334e+00  3.38947592e-01]
 [ 1.23964877e-02  3.27570058e-01]
 [-1.63337902e-01  2.30788956e-01]
 [-1.38181281e-01  3.26848565e-02]
 [ 2.19641171e-01 -7.46709954e-02]
 [ 6.40115642e-01 -4.06581130e-01]
 [ 1.59895452e-01 -1.38133615e-01]
 [ 9.18224229e-01 -3.34102462e-01]
 [-9.01043966e-01 -3.85230583e-01]
 [ 8.24350851e-01  3.07173349e-01]
 [-3.16417003e-01  4.95583923e-01]
 [ 1.02750575e+00  1.19707404e-01]
 [ 7.34340704e-02 -1.89504535e-01]
 [ 3.81441636e-01 -7.11043321e-01]
 [ 2.21543506e-01 -6.71905003e-02]
 [-1.02599683e-01  9.21305619e-01]
 [-4.37814374e-01 -1.55532065e-01]
 [-7.42485464e-01  1.77134872e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.94542424]
curr_Stock_Price:  99.74799385820577
curr_Factors:  [9.97479939e+01 3.98441663e-02]
mat_Sqrt:  [[ 1.99107006e+01  0.00000000e+00]
 [-7.98440143e-03  1.82945620e-02]]
grads:  [ 0.07705203 18.69403449]
Stock Position:  0.07705202773910047
Bond Position:  [-6.74036095]


portfolio before change:  [1.03448235]
curr_Stock_Price:  100.91474706679898
curr_Factors:  [1.00914747e+02 3.83667600e-02]
mat_Sqrt:  [[ 1.97666102e+01  0.00000000e+00]
 [-7.83497389e-03  1.79521805e-02]]
grads:  [0.00169003 1.67010681]
Stock Position:  0.0016900298963504236
Bond Position:  [0.86393341]


portfolio before change:  [1.03351277]
curr_Stock_Price:  100.27714221139411
curr_Factors:  [1.00277142e+02 3.74535810e-02]
mat_Sqrt:  [[ 1.94065628e+01  0.00000000e+00]
 [-7.74117108e-03  1.77372512e-02]]
grads:  [ 0.00529397 -0.95525663]
Stock Position:  0.005293966873563946
Bond Position:  [0.5026489]


portfolio before change:  [1.03551848]
curr_Stock_Price:  100.64413886534864
curr_Factors:  [1.00644139e+02 3.74911301e-02]
mat_Sqrt:  [[ 1.94873486e+01  0.00000000e+00]
 [-7.74505056e-03  1.77461402e-02]]
grads:  [-8.36510256e-04 -8.53068952e+00]
Stock Position:  -0.0008365102556550378
Bond Position:  [1.11970833]


portfolio before change:  [1.03710967]
curr_Stock_Price:  98.90928511406449
curr_Factors:  [9.89092851e+01 3.77851300e-02]
mat_Sqrt:  [[ 1.92263801e+01  0.00000000e+00]
 [-7.77535902e-03  1.78155856e-02]]
grads:  [5.72097804e-04 1.10531598e+01]
Stock Position:  0.0005720978039596442
Bond Position:  [0.98052389]


portfolio before change:  [1.03648498]
curr_Stock_Price:  97.60309901483754
curr_Factors:  [9.76030990e+01 3.74311772e-02]
mat_Sqrt:  [[ 1.88834068e+01  0.00000000e+00]
 [-7.73885544e-03  1.77319454e-02]]
grads:  [-1.46451782e-03 -4.23924674e+00]
Stock Position:  -0.0014645178199724775
Bond Position:  [1.17942646]


portfolio before change:  [1.03693439]
curr_Stock_Price:  97.39690255734239
curr_Factors:  [9.73969026e+01 3.80693809e-02]
mat_Sqrt:  [[ 1.90034763e+01  0.00000000e+00]
 [-7.80455056e-03  1.78824719e-02]]
grads:  [0.0068079  5.37604018]
Stock Position:  0.006807900590425706
Bond Position:  [0.37386596]


portfolio before change:  [1.03159989]
curr_Stock_Price:  96.60646190549974
curr_Factors:  [9.66064619e+01 3.82816937e-02]
mat_Sqrt:  [[ 1.89017384e+01  0.00000000e+00]
 [-7.82628328e-03  1.79322678e-02]]
grads:  [ 0.07781247 57.63198751]
Stock Position:  0.07781246672665887
Bond Position:  [-6.48558721]


portfolio before change:  [0.99156661]
curr_Stock_Price:  96.10239701459356
curr_Factors:  [9.61023970e+01 3.79748955e-02]
mat_Sqrt:  [[ 1.87276168e+01  0.00000000e+00]
 [-7.79485939e-03  1.78602666e-02]]
grads:  [1.50507717e-02 2.80596656e+01]
Stock Position:  0.015050771714931238
Bond Position:  [-0.45484863]


portfolio before change:  [0.97365799]
curr_Stock_Price:  94.91629457012331
curr_Factors:  [9.49162946e+01 3.79117308e-02]
mat_Sqrt:  [[ 1.84810900e+01  0.00000000e+00]
 [-7.78837399e-03  1.78454067e-02]]
grads:  [ 5.31679436e-06 -7.47090032e+00]
Stock Position:  5.316794358590248e-06
Bond Position:  [0.97315334]


portfolio before change:  [0.97377404]
curr_Stock_Price:  93.86228333619674
curr_Factors:  [9.38622833e+01 3.81589145e-02]
mat_Sqrt:  [[ 1.83353465e+01  0.00000000e+00]
 [-7.81372275e-03  1.79034880e-02]]
grads:  [0.00449294 0.87945507]
Stock Position:  0.004492942370058646
Bond Position:  [0.55205621]


portfolio before change:  [0.96808585]
curr_Stock_Price:  92.58089564717656
curr_Factors:  [9.25808956e+01 3.76257679e-02]
mat_Sqrt:  [[ 1.79582521e+01  0.00000000e+00]
 [-7.75894508e-03  1.77779766e-02]]
grads:  [ 1.05556198e-03 -3.41779260e+00]
Stock Position:  0.0010555619771793908
Bond Position:  [0.87036098]


portfolio before change:  [0.96767521]
curr_Stock_Price:  92.08879528569881
curr_Factors:  [9.20887953e+01 3.78148784e-02]
mat_Sqrt:  [[ 1.79076314e+01  0.00000000e+00]
 [-7.77841922e-03  1.78225974e-02]]
grads:  [1.21214404e-02 2.64139890e+01]
Stock Position:  0.012121440350480428
Bond Position:  [-0.14857363]


portfolio before change:  [0.97528051]
curr_Stock_Price:  92.71775277211046
curr_Factors:  [9.27177528e+01 3.72864398e-02]
mat_Sqrt:  [[ 1.79035171e+01  0.00000000e+00]
 [-7.72387879e-03  1.76976296e-02]]
grads:  [4.55668426e-03 3.04260450e+01]
Stock Position:  0.004556684262194622
Bond Position:  [0.55279498]


portfolio before change:  [0.97398172]
curr_Stock_Price:  92.41755974224162
curr_Factors:  [9.24175597e+01 3.67278359e-02]
mat_Sqrt:  [[ 1.77113704e+01  0.00000000e+00]
 [-7.66580312e-03  1.75645615e-02]]
grads:  [2.63443832e-03 5.56905000e+00]
Stock Position:  0.0026344383236294846
Bond Position:  [0.73051336]


portfolio before change:  [0.97642607]
curr_Stock_Price:  93.31073868607498
curr_Factors:  [9.33107387e+01 3.49785497e-02]
mat_Sqrt:  [[ 1.74514906e+01  0.00000000e+00]
 [-7.48102129e-03  1.71411732e-02]]
grads:  [ 4.54299735e-03 -6.91151488e+00]
Stock Position:  0.004542997354548307
Bond Position:  [0.55251563]


portfolio before change:  [0.97455306]
curr_Stock_Price:  92.88324994444847
curr_Factors:  [9.28832499e+01 3.53012632e-02]
mat_Sqrt:  [[ 1.74514905e+01  0.00000000e+00]
 [-7.51545216e-03  1.72200642e-02]]
grads:  [ 7.25848293e-04 -3.26380956e+00]
Stock Position:  0.0007258482925895115
Bond Position:  [0.90713391]


portfolio before change:  [0.97432636]
curr_Stock_Price:  92.41470609443553
curr_Factors:  [9.24147061e+01 3.59757303e-02]
mat_Sqrt:  [[ 1.75285461e+01  0.00000000e+00]
 [-7.58690770e-03  1.73837894e-02]]
grads:  [0.02309045 3.61094307]
Stock Position:  0.02309045408377104
Bond Position:  [-1.15957116]


portfolio before change:  [0.97858058]
curr_Stock_Price:  92.60522515611817
curr_Factors:  [9.26052252e+01 3.59047448e-02]
mat_Sqrt:  [[ 1.75473450e+01  0.00000000e+00]
 [-7.57941895e-03  1.73666305e-02]]
grads:  [ 0.03107519 22.34714386]
Stock Position:  0.03107518610810058
Bond Position:  [-1.89914403]


portfolio before change:  [0.97763458]
curr_Stock_Price:  92.58242266522774
curr_Factors:  [9.25824227e+01 3.80426735e-02]
mat_Sqrt:  [[ 1.80577675e+01  0.00000000e+00]
 [-7.80181246e-03  1.78761981e-02]]
grads:  [-0.0334083  20.66428556]
Stock Position:  -0.033408300518483175
Bond Position:  [4.07065598]


portfolio before change:  [1.01538272]
curr_Stock_Price:  91.46775140329854
curr_Factors:  [9.14677514e+01 3.83367613e-02]
mat_Sqrt:  [[ 1.79091805e+01  0.00000000e+00]
 [-7.83191024e-03  1.79451608e-02]]
grads:  [-2.69929712e-03  1.81662445e+01]
Stock Position:  -0.002699297120019796
Bond Position:  [1.26228136]


portfolio before change:  [1.01748018]
curr_Stock_Price:  90.74916736819654
curr_Factors:  [9.07491674e+01 3.88744533e-02]
mat_Sqrt:  [[ 1.78926553e+01  0.00000000e+00]
 [-7.88664220e-03  1.80705674e-02]]
grads:  [ 0.11642667 18.75688704]
Stock Position:  0.1164266652879691
Bond Position:  [-9.54814275]


portfolio before change:  [0.87695612]
curr_Stock_Price:  89.55244435271314
curr_Factors:  [8.95524444e+01 3.98713796e-02]
mat_Sqrt:  [[ 1.78816700e+01  0.00000000e+00]
 [-7.98712761e-03  1.83008084e-02]]
grads:  [8.68821432e-03 1.78992124e+01]
Stock Position:  0.008688214321085371
Bond Position:  [0.09890529]


portfolio before change:  [0.89516753]
curr_Stock_Price:  91.6471257957306
curr_Factors:  [9.16471258e+01 3.78430323e-02]
mat_Sqrt:  [[ 1.78283772e+01  0.00000000e+00]
 [-7.78131426e-03  1.78292308e-02]]
grads:  [-3.51200467e-03  1.29444146e+01]
Stock Position:  -0.003512004668115282
Bond Position:  [1.21703266]


portfolio before change:  [0.90036456]
curr_Stock_Price:  90.21065554250598
curr_Factors:  [9.02106555e+01 3.78366657e-02]
mat_Sqrt:  [[ 1.75474603e+01  0.00000000e+00]
 [-7.78065969e-03  1.78277310e-02]]
grads:  [-0.00706179  1.83337165]
Stock Position:  -0.007061787747886234
Bond Position:  [1.53741306]


portfolio before change:  [0.89639257]
curr_Stock_Price:  90.8003330093602
curr_Factors:  [9.08003330e+01 3.74410342e-02]
mat_Sqrt:  [[ 1.75695792e+01  0.00000000e+00]
 [-7.73987434e-03  1.77342800e-02]]
grads:  [ 0.01064636 -4.21054564]
Stock Position:  0.01064636064490292
Bond Position:  [-0.07030052]


portfolio before change:  [0.87993263]
curr_Stock_Price:  89.25509594482611
curr_Factors:  [8.92550959e+01 3.89404184e-02]
mat_Sqrt:  [[ 1.76129997e+01  0.00000000e+00]
 [-7.89333070e-03  1.80858927e-02]]
grads:  [  0.02626861 -22.48056742]
Stock Position:  0.026268613868992385
Bond Position:  [-1.46467502]


portfolio before change:  [0.86282017]
curr_Stock_Price:  88.61062496182025
curr_Factors:  [8.86106250e+01 3.97110082e-02]
mat_Sqrt:  [[ 1.76579896e+01  0.00000000e+00]
 [-7.97104844e-03  1.82639664e-02]]
grads:  [ 5.64101588e-03 -7.56317723e+00]
Stock Position:  0.005641015882250452
Bond Position:  [0.36296623]


portfolio before change:  [0.86392234]
curr_Stock_Price:  88.79796594591676
curr_Factors:  [8.87979659e+01 3.95819351e-02]
mat_Sqrt:  [[ 1.76665411e+01  0.00000000e+00]
 [-7.95808369e-03  1.82342605e-02]]
grads:  [  0.04372163 -18.32278652]
Stock Position:  0.043721629227721805
Bond Position:  [-3.0184694]


portfolio before change:  [0.85082178]
curr_Stock_Price:  88.50696058221712
curr_Factors:  [8.85069606e+01 4.10708222e-02]
mat_Sqrt:  [[ 1.79367653e+01  0.00000000e+00]
 [-8.10637499e-03  1.85740385e-02]]
grads:  [ -0.05960787 -20.74027049]
Stock Position:  -0.059607870102309016
Bond Position:  [6.12653319]


portfolio before change:  [0.86664274]
curr_Stock_Price:  88.25439157750901
curr_Factors:  [8.82543916e+01 4.17056918e-02]
mat_Sqrt:  [[ 1.80232867e+01  0.00000000e+00]
 [-8.16878859e-03  1.87170460e-02]]
grads:  [ 0.05317633 16.41142244]
Stock Position:  0.053176332904883716
Bond Position:  [-3.82640216]


portfolio before change:  [0.84231548]
curr_Stock_Price:  87.80590376816006
curr_Factors:  [8.78059038e+01 4.25795341e-02]
mat_Sqrt:  [[ 1.81185805e+01  0.00000000e+00]
 [-8.25392359e-03  1.89121148e-02]]
grads:  [-5.52617504e-03  2.62045746e+01]
Stock Position:  -0.005526175038271876
Bond Position:  [1.32754627]


portfolio before change:  [0.84419008]
curr_Stock_Price:  87.49671254137718
curr_Factors:  [8.74967125e+01 4.33141742e-02]
mat_Sqrt:  [[ 1.82098662e+01  0.00000000e+00]
 [-8.32482305e-03  1.90745659e-02]]
grads:  [0.0592948  6.27576031]
Stock Position:  0.05929479840445138
Bond Position:  [-4.34390986]


portfolio before change:  [0.90106268]
curr_Stock_Price:  88.4650205783369
curr_Factors:  [8.84650206e+01 4.30810103e-02]
mat_Sqrt:  [[ 1.83617691e+01  0.00000000e+00]
 [-8.30238620e-03  1.90231566e-02]]
grads:  [-5.04988876e-04 -9.96178178e+00]
Stock Position:  -0.000504988875899659
Bond Position:  [0.94573653]


portfolio before change:  [0.90237132]
curr_Stock_Price:  86.10771613208642
curr_Factors:  [8.61077161e+01 4.43630312e-02]
mat_Sqrt:  [[ 1.81364664e+01  0.00000000e+00]
 [-8.42501335e-03  1.93041307e-02]]
grads:  [ 3.92120974e-03 -3.68337395e+01]
Stock Position:  0.0039212097445636505
Bond Position:  [0.5647249]


portfolio before change:  [0.8973706]
curr_Stock_Price:  84.81441318467321
curr_Factors:  [8.48144132e+01 4.42101192e-02]
mat_Sqrt:  [[ 1.78332503e+01  0.00000000e+00]
 [-8.41048101e-03  1.92708329e-02]]
grads:  [ 0.0107787  -3.48664225]
Stock Position:  0.010778695105460425
Bond Position:  [-0.0168181]


portfolio before change:  [0.91256888]
curr_Stock_Price:  86.22463727768265
curr_Factors:  [8.62246373e+01 4.37572154e-02]
mat_Sqrt:  [[ 1.80366640e+01  0.00000000e+00]
 [-8.36729016e-03  1.91718703e-02]]
grads:  [1.66045703e-02 4.80550727e+01]
Stock Position:  0.01660457026284875
Bond Position:  [-0.51915417]


portfolio before change:  [0.90456464]
curr_Stock_Price:  85.74649526728457
curr_Factors:  [8.57464953e+01 4.28673546e-02]
mat_Sqrt:  [[ 1.77533257e+01  0.00000000e+00]
 [-8.28177320e-03  1.89759263e-02]]
grads:  [-0.02848447 -8.19628317]
Stock Position:  -0.02848447337317455
Bond Position:  [3.3470084]


portfolio before change:  [0.88443456]
curr_Stock_Price:  86.46788755453612
curr_Factors:  [8.64678876e+01 4.34121467e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.88443456]
Stock Price:  84.70987608645453
PL:  [0.88443456]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.49955282e+00  3.67920063e-01]
 [ 1.11678022e+00  6.64477824e-02]
 [ 5.82310072e-02  2.48637201e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.82904627e-01  1.29018028e+00]
 [ 7.70759091e-02  7.91742735e-02]
 [ 8.93141782e-02  9.32387873e-02]
 [ 1.26527208e+00  1.30464118e+00]
 [ 1.52172911e-01  7.38986339e-01]
 [-3.01760463e-02 -2.90357302e-01]
 [ 1.24267664e-01  1.33890670e-02]
 [ 4.48195089e-02 -5.43184830e-02]
 [ 1.75281344e-02  4.93193920e-01]
 [-1.73288249e-01  6.03139373e-01]
 [-1.23657109e-01  4.14221505e-02]
 [ 1.27896436e-01 -1.92351072e-01]
 [ 3.47152848e-02 -1.71250262e-01]
 [ 5.20567859e-01  5.73296593e-02]
 [ 4.97047293e-01  5.11349116e-01]
 [-7.26981879e-01  3.47215582e-01]
 [-1.50008702e-01  2.93534919e-01]
 [ 1.84038788e+00  2.89233701e-01]
 [ 1.46582537e-02  4.17068436e-01]
 [-1.50708020e-01  1.81099826e-01]
 [-1.91808774e-01  1.15961512e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 7.33533154e-02 -4.54556939e-01]
 [ 9.51243810e-02 -2.53041041e-04]
 [ 6.97372459e-01 -3.16742103e-01]
 [-8.06894247e-01 -3.62684077e-01]
 [ 6.41642935e-01  2.39797579e-01]
 [-2.07491572e-01  3.09031200e-01]
 [ 5.56578804e-01  2.35333070e-01]
 [ 5.96102261e-02 -1.12440977e-01]
 [ 3.02843644e-01 -4.22136739e-01]
 [ 1.50258917e-01  4.98074185e-05]
 [-9.01328076e-02  7.21491268e-01]
 [-4.16713725e-01 -1.50527173e-01]
 [-4.94314423e-01  1.20345211e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.03709273]
curr_Stock_Price:  99.16991174528611
curr_Factors:  [9.91699117e+01 4.09071003e-02]
mat_Sqrt:  [[ 2.00576142e+01  0.00000000e+00]
 [-8.09020151e-03  1.85369804e-02]]
grads:  [ 0.08276788 19.8478962 ]
Stock Position:  0.08276788457893558
Bond Position:  [-11.24517654]


portfolio before change:  [-3.11510529]
curr_Stock_Price:  98.24434960880014
curr_Factors:  [9.82443496e+01 4.16387586e-02]
mat_Sqrt:  [[ 2.00473267e+01  0.00000000e+00]
 [-8.16223093e-03  1.87020205e-02]]
grads:  [0.05715378 3.55297345]
Stock Position:  0.05715377535141355
Bond Position:  [-8.73014078]


portfolio before change:  [-3.11810899]
curr_Stock_Price:  98.21088953002115
curr_Factors:  [9.82108895e+01 3.88987681e-02]
mat_Sqrt:  [[ 1.93699085e+01  0.00000000e+00]
 [-7.88910825e-03  1.80762179e-02]]
grads:  [0.00356648 1.3754935 ]
Stock Position:  0.003566481710033239
Bond Position:  [-3.46837634]


portfolio before change:  [-3.12064867]
curr_Stock_Price:  97.62036438325202
curr_Factors:  [9.76203644e+01 3.96733782e-02]
mat_Sqrt:  [[ 1.94441971e+01  0.00000000e+00]
 [-7.96727087e-03  1.82553109e-02]]
grads:  [-8.38366678e-04 -8.29275454e+00]
Stock Position:  -0.0008383666781050747
Bond Position:  [-3.038807]


portfolio before change:  [-3.11903803]
curr_Stock_Price:  95.24609466334469
curr_Factors:  [9.52460947e+01 3.97607018e-02]
mat_Sqrt:  [[ 1.89921529e+01  0.00000000e+00]
 [-7.97603429e-03  1.82753904e-02]]
grads:  [2.00175416e-02 7.05965920e+01]
Stock Position:  0.02001754163183809
Bond Position:  [-5.0256307]


portfolio before change:  [-3.12909144]
curr_Stock_Price:  94.77524911376177
curr_Factors:  [9.47752491e+01 3.97844204e-02]
mat_Sqrt:  [[ 1.89039018e+01  0.00000000e+00]
 [-7.97841292e-03  1.82808406e-02]]
grads:  [0.00590515 4.33099743]
Stock Position:  0.005905151020688701
Bond Position:  [-3.6887536]


portfolio before change:  [-3.13075532]
curr_Stock_Price:  94.57157062668394
curr_Factors:  [9.45715706e+01 4.11704040e-02]
mat_Sqrt:  [[ 1.91890364e+01  0.00000000e+00]
 [-8.11619655e-03  1.85965425e-02]]
grads:  [0.00677506 5.01377002]
Stock Position:  0.006775062515296158
Bond Position:  [-3.77148362]


portfolio before change:  [-3.12925417]
curr_Stock_Price:  94.86272829910457
curr_Factors:  [9.48627283e+01 4.03585055e-02]
mat_Sqrt:  [[ 1.90573780e+01  0.00000000e+00]
 [-8.03577058e-03  1.84122635e-02]]
grads:  [ 0.09627054 70.85718595]
Stock Position:  0.09627054489504659
Bond Position:  [-12.26174072]


portfolio before change:  [-3.25923748]
curr_Stock_Price:  93.52846253647962
curr_Factors:  [9.35284625e+01 4.06808911e-02]
mat_Sqrt:  [[ 1.88642274e+01  0.00000000e+00]
 [-8.06780179e-03  1.84856562e-02]]
grads:  [2.51636592e-02 3.99762027e+01]
Stock Position:  0.02516365924971056
Bond Position:  [-5.61275584]


portfolio before change:  [-3.25445765]
curr_Stock_Price:  93.74629513997769
curr_Factors:  [9.37462951e+01 4.18629306e-02]
mat_Sqrt:  [[ 1.91808976e+01  0.00000000e+00]
 [-8.18417308e-03  1.87522963e-02]]
grads:  [-8.17992804e-03 -1.54838265e+01]
Stock Position:  -0.008179928039440811
Bond Position:  [-2.4876197]


portfolio before change:  [-3.24672168]
curr_Stock_Price:  92.76255228231146
curr_Factors:  [9.27625523e+01 4.29906690e-02]
mat_Sqrt:  [[ 1.92335651e+01  0.00000000e+00]
 [-8.29367653e-03  1.90032002e-02]]
grads:  [0.0067648  0.70456906]
Stock Position:  0.006764795369435564
Bond Position:  [-3.87424136]


portfolio before change:  [-3.2510258]
curr_Stock_Price:  92.19789202517224
curr_Factors:  [9.21978920e+01 4.33447175e-02]
mat_Sqrt:  [[ 1.91950426e+01  0.00000000e+00]
 [-8.32775768e-03  1.90812900e-02]]
grads:  [ 1.09991834e-03 -2.84668820e+00]
Stock Position:  0.0010999183377351745
Bond Position:  [-3.35243595]


portfolio before change:  [-3.25176168]
curr_Stock_Price:  91.90987351153673
curr_Factors:  [9.19098735e+01 4.37941214e-02]
mat_Sqrt:  [[ 1.92340206e+01  0.00000000e+00]
 [-8.37081802e-03  1.91799536e-02]]
grads:  [1.21022854e-02 2.57140309e+01]
Stock Position:  0.012102285443199991
Bond Position:  [-4.3640812]


portfolio before change:  [-3.26059017]
curr_Stock_Price:  91.22546153392558
curr_Factors:  [9.12254615e+01 4.34835219e-02]
mat_Sqrt:  [[ 1.90229745e+01  0.00000000e+00]
 [-8.34108117e-03  1.91118179e-02]]
grads:  [4.72814355e-03 3.15584512e+01]
Stock Position:  0.004728143553859726
Bond Position:  [-3.69191725]


portfolio before change:  [-3.26173758]
curr_Stock_Price:  91.08039673240005
curr_Factors:  [9.10803967e+01 4.28340534e-02]
mat_Sqrt:  [[ 1.88503536e+01  0.00000000e+00]
 [-8.27855576e-03  1.89685542e-02]]
grads:  [-0.0056009   2.18372734]
Stock Position:  -0.005600902937983159
Bond Position:  [-2.75160511]


portfolio before change:  [-3.25448908]
curr_Stock_Price:  89.72481807236775
curr_Factors:  [8.97248181e+01 4.36515119e-02]
mat_Sqrt:  [[ 1.87461562e+01  0.00000000e+00]
 [-8.35717769e-03  1.91486997e-02]]
grads:  [ 2.34434968e-03 -1.00451245e+01]
Stock Position:  0.002344349682835992
Bond Position:  [-3.46483543]


portfolio before change:  [-3.25269926]
curr_Stock_Price:  90.6730365110289
curr_Factors:  [9.06730365e+01 4.27634911e-02]
mat_Sqrt:  [[ 1.87505813e+01  0.00000000e+00]
 [-8.27173414e-03  1.89529239e-02]]
grads:  [-2.13457154e-03 -9.03555901e+00]
Stock Position:  -0.002134571535675026
Bond Position:  [-3.05915118]


portfolio before change:  [-3.25049549]
curr_Stock_Price:  89.46146556565631
curr_Factors:  [8.94614656e+01 4.34502925e-02]
mat_Sqrt:  [[ 1.86480043e+01  0.00000000e+00]
 [-8.33789350e-03  1.91045140e-02]]
grads:  [0.02925721 3.00084363]
Stock Position:  0.029257209789242667
Bond Position:  [-5.86788836]


portfolio before change:  [-3.1975896]
curr_Stock_Price:  91.29484013249697
curr_Factors:  [9.12948401e+01 4.20826274e-02]
mat_Sqrt:  [[ 1.87282697e+01  0.00000000e+00]
 [-8.20562026e-03  1.88014380e-02]]
grads:  [ 0.03845621 27.19734078]
Stock Position:  0.0384562136688791
Bond Position:  [-6.70844348]


portfolio before change:  [-3.13400443]
curr_Stock_Price:  92.97009021655944
curr_Factors:  [9.29700902e+01 4.23480418e-02]
mat_Sqrt:  [[ 1.91319800e+01  0.00000000e+00]
 [-8.23145594e-03  1.88606350e-02]]
grads:  [-0.03007763 18.40953832]
Stock Position:  -0.03007762786865862
Bond Position:  [-0.33768466]


portfolio before change:  [-3.10287033]
curr_Stock_Price:  91.93356175644308
curr_Factors:  [9.19335618e+01 4.24016469e-02]
mat_Sqrt:  [[ 1.89306466e+01  0.00000000e+00]
 [-8.23666407e-03  1.88725683e-02]]
grads:  [-1.15683107e-03  1.55535227e+01]
Stock Position:  -0.0011568310741554824
Bond Position:  [-2.99651873]


portfolio before change:  [-3.10323901]
curr_Stock_Price:  91.92845280432616
curr_Factors:  [9.19284528e+01 4.21321614e-02]
mat_Sqrt:  [[ 1.88693448e+01  0.00000000e+00]
 [-8.21044812e-03  1.88125000e-02]]
grads:  [ 0.104223   15.37454887]
Stock Position:  0.10422300495230055
Bond Position:  [-12.6842986]


portfolio before change:  [-2.99058516]
curr_Stock_Price:  93.02455905553732
curr_Factors:  [9.30245591e+01 4.30328901e-02]
mat_Sqrt:  [[ 1.92973590e+01  0.00000000e+00]
 [-8.29774814e-03  1.90125295e-02]]
grads:  [1.01921637e-02 2.19365044e+01]
Stock Position:  0.01019216368590052
Bond Position:  [-3.93870669]


portfolio before change:  [-2.98390821]
curr_Stock_Price:  93.72797315325248
curr_Factors:  [9.37279732e+01 4.28814119e-02]
mat_Sqrt:  [[ 1.94090270e+01  0.00000000e+00]
 [-8.28313099e-03  1.89790374e-02]]
grads:  [-3.69258986e-03  9.54209757e+00]
Stock Position:  -0.0036925898604740076
Bond Position:  [-2.63780925]


portfolio before change:  [-2.98658679]
curr_Stock_Price:  94.36406624331876
curr_Factors:  [9.43640662e+01 4.22690456e-02]
mat_Sqrt:  [[ 1.94007209e+01  0.00000000e+00]
 [-8.22377487e-03  1.88430354e-02]]
grads:  [-0.00727803  6.15407815]
Stock Position:  -0.007278029614962274
Bond Position:  [-2.29980232]


portfolio before change:  [-2.97995626]
curr_Stock_Price:  93.41353050221244
curr_Factors:  [9.34135305e+01 4.19673110e-02]
mat_Sqrt:  [[ 1.91366255e+01  0.00000000e+00]
 [-8.19436987e-03  1.87756601e-02]]
grads:  [ 0.00958782 -3.88777474]
Stock Position:  0.009587824286876953
Bond Position:  [-3.87558877]


portfolio before change:  [-2.97290723]
curr_Stock_Price:  94.19926677097543
curr_Factors:  [9.41992668e+01 4.07241269e-02]
mat_Sqrt:  [[ 1.90096190e+01  0.00000000e+00]
 [-8.07208790e-03  1.84954769e-02]]
grads:  [-6.57728052e-03 -2.45766541e+01]
Stock Position:  -0.006577280516875233
Bond Position:  [-2.35333223]


portfolio before change:  [-2.97098203]
curr_Stock_Price:  93.86183450243355
curr_Factors:  [9.38618345e+01 4.08354632e-02]
mat_Sqrt:  [[ 1.89673990e+01  0.00000000e+00]
 [-8.08311457e-03  1.85207422e-02]]
grads:  [ 0.00500933 -0.01366258]
Stock Position:  0.005009329145434951
Bond Position:  [-3.44116686]


portfolio before change:  [-2.98169303]
curr_Stock_Price:  91.80949881835174
curr_Factors:  [9.18094988e+01 4.16738941e-02]
mat_Sqrt:  [[ 1.87421608e+01  0.00000000e+00]
 [-8.16567392e-03  1.87099094e-02]]
grads:  [  0.029833   -16.92910939]
Stock Position:  0.029832999504582108
Bond Position:  [-5.72064576]


portfolio before change:  [-3.04142191]
curr_Stock_Price:  89.83136189616161
curr_Factors:  [8.98313619e+01 4.27475725e-02]
mat_Sqrt:  [[ 1.85730707e+01  0.00000000e+00]
 [-8.27019443e-03  1.89493960e-02]]
grads:  [ -0.05196677 -19.13961144]
Stock Position:  -0.05196677323433135
Bond Position:  [1.6268241]


portfolio before change:  [-3.047428]
curr_Stock_Price:  89.95085081747347
curr_Factors:  [8.99508508e+01 4.29357983e-02]
mat_Sqrt:  [[ 1.86386755e+01  0.00000000e+00]
 [-8.28838207e-03  1.89910691e-02]]
grads:  [ 0.04004035 12.62686045]
Stock Position:  0.04004035482320989
Bond Position:  [-6.64909199]


portfolio before change:  [-2.99404153]
curr_Stock_Price:  91.30492634727524
curr_Factors:  [9.13049263e+01 4.18722426e-02]
mat_Sqrt:  [[ 1.86834606e+01  0.00000000e+00]
 [-8.18508328e-03  1.87543818e-02]]
grads:  [-3.88682271e-03  1.64778132e+01]
Stock Position:  -0.0038868227137776423
Bond Position:  [-2.63915546]


portfolio before change:  [-2.99983946]
curr_Stock_Price:  92.71173705881935
curr_Factors:  [9.27117371e+01 4.26255747e-02]
mat_Sqrt:  [[ 1.91412300e+01  0.00000000e+00]
 [-8.25838480e-03  1.89223367e-02]]
grads:  [ 0.03444327 12.4367869 ]
Stock Position:  0.034443271172628645
Bond Position:  [-6.19313496]


portfolio before change:  [-3.05043928]
curr_Stock_Price:  91.26513731145138
curr_Factors:  [9.12651373e+01 4.31892462e-02]
mat_Sqrt:  [[ 1.89667414e+01  0.00000000e+00]
 [-8.31280903e-03  1.90470383e-02]]
grads:  [ 5.55549332e-04 -5.90333127e+00]
Stock Position:  0.0005555493319443387
Bond Position:  [-3.10114157]


portfolio before change:  [-3.05130679]
curr_Stock_Price:  90.40141375402331
curr_Factors:  [9.04014138e+01 4.24377632e-02]
mat_Sqrt:  [[ 1.86230781e+01  0.00000000e+00]
 [-8.24017118e-03  1.88806041e-02]]
grads:  [ 6.36887552e-03 -2.23582221e+01]
Stock Position:  0.006368875523813257
Bond Position:  [-3.62706214]


portfolio before change:  [-3.0581875]
curr_Stock_Price:  89.39224001958672
curr_Factors:  [8.93922400e+01 4.16097397e-02]
mat_Sqrt:  [[ 1.82346453e+01  0.00000000e+00]
 [-8.15938622e-03  1.86955025e-02]]
grads:  [0.00824149 0.00266414]
Stock Position:  0.00824149044273516
Bond Position:  [-3.79491279]


portfolio before change:  [-3.06623392]
curr_Stock_Price:  88.47347185313352
curr_Factors:  [8.84734719e+01 4.19819964e-02]
mat_Sqrt:  [[ 1.81277797e+01  0.00000000e+00]
 [-8.19580346e-03  1.87789449e-02]]
grads:  [1.23981978e-02 3.84202240e+01]
Stock Position:  0.012398197754097213
Bond Position:  [-4.16314552]


portfolio before change:  [-3.07517074]
curr_Stock_Price:  87.79463125429326
curr_Factors:  [8.77946313e+01 4.27505351e-02]
mat_Sqrt:  [[ 1.81525958e+01  0.00000000e+00]
 [-8.27048101e-03  1.89500526e-02]]
grads:  [-0.02657522 -7.94336439]
Stock Position:  -0.02657521689416428
Bond Position:  [-0.74200937]


portfolio before change:  [-3.07392237]
curr_Stock_Price:  87.74416591443443
curr_Factors:  [8.77441659e+01 4.34811315e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.07392237]
Stock Price:  88.53335630449008
PL:  [-3.07392237]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.27078507e+00  3.16200259e-01]
 [ 1.33460107e-01  7.02073180e-02]
 [-3.00223173e-01 -1.34434967e-01]
 [-2.60451006e-02 -1.34512749e-01]
 [-1.20924871e-01 -4.69121942e-01]
 [-3.50459657e-01  1.79688975e-01]
 [ 1.17531144e-01 -3.51901713e-02]
 [ 2.30217470e-01  4.50275992e-01]
 [-5.17463749e-02  1.73225942e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-4.88928545e-02  1.52196934e-02]
 [ 5.51275842e-02 -1.30907771e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-1.29885189e-01  2.98322763e-01]
 [ 2.96836912e-01  2.27295470e-01]
 [ 1.32854570e-01 -7.38375918e-02]
 [ 3.92337590e-02  3.86685767e-02]
 [ 2.37749451e-01  6.97038629e-02]
 [ 7.30605240e-02  8.00861395e-02]
 [-4.87596416e-01  2.08604687e-01]
 [ 8.89872136e-02  9.84684801e-02]
 [ 1.69407504e+00  2.12007833e-01]
 [ 1.46329153e-02  4.16065795e-01]
 [-1.60911444e-01  2.21242661e-01]
 [-1.49697293e-01  5.19589824e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 4.03929437e-01 -4.27513565e-01]
 [ 1.37114646e-01 -8.96392704e-02]
 [ 8.46659680e-01 -3.28610527e-01]
 [-7.74559330e-01 -3.54940672e-01]
 [ 5.49729640e-01  2.05787810e-01]
 [-2.16951383e-01  3.25133958e-01]
 [ 7.39742022e-01  2.03410711e-01]
 [ 6.38502186e-02 -1.41157968e-01]
 [ 3.17961654e-01 -5.15401956e-01]
 [ 1.59304934e-01 -1.13629187e-02]
 [-8.59725514e-02  6.55066455e-01]
 [-3.88458309e-01 -1.43825232e-01]
 [-3.37147241e-01  8.46792559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.38386166]
curr_Stock_Price:  100.24710012111848
curr_Factors:  [1.00247100e+02 4.06036419e-02]
mat_Sqrt:  [[ 2.02001369e+01  0.00000000e+00]
 [-8.06013816e-03  1.84680966e-02]]
grads:  [ 0.06974142 17.12143192]
Stock Position:  0.06974141732550941
Bond Position:  [-2.60751319]


portfolio before change:  [4.41795261]
curr_Stock_Price:  100.7405932366629
curr_Factors:  [1.00740593e+02 3.86739247e-02]
mat_Sqrt:  [[ 1.98113298e+01  0.00000000e+00]
 [-7.86627482e-03  1.80238999e-02]]
grads:  [0.00828319 3.89523457]
Stock Position:  0.008283194237150359
Bond Position:  [3.5834987]


portfolio before change:  [4.42911105]
curr_Stock_Price:  102.03363061927847
curr_Factors:  [1.02033631e+02 3.63958554e-02]
mat_Sqrt:  [[ 1.94656677e+01  0.00000000e+00]
 [-7.63107913e-03  1.74849989e-02]]
grads:  [-0.01843735 -7.68858885]
Stock Position:  -0.01843735381192814
Bond Position:  [6.3103412]


portfolio before change:  [4.41261266]
curr_Stock_Price:  102.97125046170619
curr_Factors:  [1.0297125e+02 3.5279675e-02]
mat_Sqrt:  [[ 1.9340971e+01  0.0000000e+00]
 [-7.5131538e-03  1.7214798e-02]]
grads:  [-4.38195565e-03 -7.81378610e+00]
Stock Position:  -0.0043819556493911015
Bond Position:  [4.86382812]


portfolio before change:  [4.4153643]
curr_Stock_Price:  102.48205783861728
curr_Factors:  [1.02482058e+02 3.37348668e-02]
mat_Sqrt:  [[ 1.88229348e+01  0.00000000e+00]
 [-7.34682155e-03  1.68336829e-02]]
grads:  [-1.73015778e-02 -2.78680514e+01]
Stock Position:  -0.01730157784369038
Bond Position:  [6.1884656]


portfolio before change:  [4.42987856]
curr_Stock_Price:  101.68787282535017
curr_Factors:  [1.01687873e+02 3.45176336e-02]
mat_Sqrt:  [[ 1.88925104e+01  0.00000000e+00]
 [-7.43156873e-03  1.70278631e-02]]
grads:  [-0.0143992  10.55264388]
Stock Position:  -0.014399195950967872
Bond Position:  [5.89410217]


portfolio before change:  [4.44329605]
curr_Stock_Price:  100.8072208216467
curr_Factors:  [1.00807221e+02 3.52298676e-02]
mat_Sqrt:  [[ 1.89211334e+01  0.00000000e+00]
 [-7.50784844e-03  1.72026419e-02]]
grads:  [ 0.00539994 -2.04562599]
Stock Position:  0.005399935212496139
Bond Position:  [3.89894359]


portfolio before change:  [4.44239128]
curr_Stock_Price:  100.54940865997314
curr_Factors:  [1.00549409e+02 3.59159303e-02]
mat_Sqrt:  [[ 1.90556199e+01  0.00000000e+00]
 [-7.58059948e-03  1.73693355e-02]]
grads:  [2.23941297e-02 2.59236165e+01]
Stock Position:  0.02239412973366169
Bond Position:  [2.19067478]


portfolio before change:  [4.4159227]
curr_Stock_Price:  99.3552370753051
curr_Factors:  [9.93552371e+01 3.68381206e-02]
mat_Sqrt:  [[ 1.90695084e+01  0.00000000e+00]
 [-7.67730375e-03  1.75909128e-02]]
grads:  [1.25098266e-03 9.84746750e+00]
Stock Position:  0.0012509826601011349
Bond Position:  [4.29163102]


portfolio before change:  [4.41416831]
curr_Stock_Price:  97.5239783723922
curr_Factors:  [9.75239784e+01 3.80544643e-02]
mat_Sqrt:  [[ 1.90245423e+01  0.00000000e+00]
 [-7.80302140e-03  1.78789681e-02]]
grads:  [0.01295349 6.32455591]
Stock Position:  0.01295348837126656
Bond Position:  [3.15089259]


portfolio before change:  [4.41223524]
curr_Stock_Price:  97.34433906288214
curr_Factors:  [9.73443391e+01 3.86935927e-02]
mat_Sqrt:  [[ 1.91483003e+01  0.00000000e+00]
 [-7.86827480e-03  1.80284824e-02]]
grads:  [-0.00220648  0.84420269]
Stock Position:  -0.0022064849195521483
Bond Position:  [4.62702406]


portfolio before change:  [4.41245945]
curr_Stock_Price:  97.50486818153324
curr_Factors:  [9.75048682e+01 3.89094452e-02]
mat_Sqrt:  [[ 1.92333006e+01  0.00000000e+00]
 [-7.89019089e-03  1.80786985e-02]]
grads:  [-1.04259319e-04 -7.24099529e+00]
Stock Position:  -0.00010425931891847855
Bond Position:  [4.42262524]


portfolio before change:  [4.41300988]
curr_Stock_Price:  97.52821160155497
curr_Factors:  [9.75282116e+01 3.77059109e-02]
mat_Sqrt:  [[ 1.89380378e+01  0.00000000e+00]
 [-7.76720396e-03  1.77969000e-02]]
grads:  [-0.00683011 -1.57619614]
Stock Position:  -0.006830110364792212
Bond Position:  [5.07913833]


portfolio before change:  [4.42476714]
curr_Stock_Price:  95.89978650856818
curr_Factors:  [9.58997865e+01 3.91987556e-02]
mat_Sqrt:  [[ 1.89868876e+01  0.00000000e+00]
 [-7.91947024e-03  1.81457859e-02]]
grads:  [1.65134423e-05 1.64403330e+01]
Stock Position:  1.6513442320629247e-05
Bond Position:  [4.4231835]


portfolio before change:  [4.42531336]
curr_Stock_Price:  95.4937947160607
curr_Factors:  [9.54937947e+01 3.86649407e-02]
mat_Sqrt:  [[ 1.87773294e+01  0.00000000e+00]
 [-7.86536110e-03  1.80218063e-02]]
grads:  [ 0.02109122 12.61224688]
Stock Position:  0.021091220067924122
Bond Position:  [2.41123272]


portfolio before change:  [4.42366305]
curr_Stock_Price:  95.40125688749157
curr_Factors:  [9.54012569e+01 3.82039253e-02]
mat_Sqrt:  [[ 1.86469622e+01  0.00000000e+00]
 [-7.81832977e-03  1.79140440e-02]]
grads:  [ 0.00539655 -4.12177127]
Stock Position:  0.0053965467598554445
Bond Position:  [3.90882571]


portfolio before change:  [4.42039986]
curr_Stock_Price:  94.70602896295105
curr_Factors:  [9.47060290e+01 3.73191401e-02]
mat_Sqrt:  [[ 1.82954645e+01  0.00000000e+00]
 [-7.72726498e-03  1.77053883e-02]]
grads:  [0.00306689 2.18400048]
Stock Position:  0.0030668862984416165
Bond Position:  [4.12994723]


portfolio before change:  [4.42220927]
curr_Stock_Price:  95.12767472445914
curr_Factors:  [9.51276747e+01 3.56187651e-02]
mat_Sqrt:  [[ 1.79533836e+01  0.00000000e+00]
 [-7.54917374e-03  1.72973301e-02]]
grads:  [0.01493706 4.02974694]
Stock Position:  0.014937056789157238
Bond Position:  [3.00128179]


portfolio before change:  [4.43317408]
curr_Stock_Price:  95.83662475170715
curr_Factors:  [9.58366248e+01 3.43637679e-02]
mat_Sqrt:  [[ 1.77656826e+01  0.00000000e+00]
 [-7.41498676e-03  1.69898691e-02]]
grads:  [0.00607987 4.71375849]
Stock Position:  0.006079866626696467
Bond Position:  [3.85050018]


portfolio before change:  [4.43115916]
curr_Stock_Price:  95.42604594847636
curr_Factors:  [9.54260459e+01 3.42294499e-02]
mat_Sqrt:  [[ 1.76549661e+01  0.00000000e+00]
 [-7.40048106e-03  1.69566323e-02]]
grads:  [-0.02246132 12.3022475 ]
Stock Position:  -0.022461321273957346
Bond Position:  [6.57455424]


portfolio before change:  [4.44561623]
curr_Stock_Price:  94.81899336583933
curr_Factors:  [9.48189934e+01 3.40411002e-02]
mat_Sqrt:  [[ 1.74943227e+01  0.00000000e+00]
 [-7.38009216e-03  1.69099155e-02]]
grads:  [0.00754315 5.82312077]
Stock Position:  0.007543154629412914
Bond Position:  [3.7303819]


portfolio before change:  [4.43810781]
curr_Stock_Price:  93.76177697173215
curr_Factors:  [9.37617770e+01 3.39649726e-02]
mat_Sqrt:  [[ 1.72799095e+01  0.00000000e+00]
 [-7.37183533e-03  1.68909967e-02]]
grads:  [ 0.10339191 12.55152892]
Stock Position:  0.10339191002111633
Bond Position:  [-5.25610139]


portfolio before change:  [4.35741479]
curr_Stock_Price:  92.9876741809295
curr_Factors:  [9.29876742e+01 3.38978867e-02]
mat_Sqrt:  [[ 1.71203129e+01  0.00000000e+00]
 [-7.36455149e-03  1.68743073e-02]]
grads:  [1.14611758e-02 2.46567629e+01]
Stock Position:  0.0114611757993111
Bond Position:  [3.29166671]


portfolio before change:  [4.34701033]
curr_Stock_Price:  92.04397103671619
curr_Factors:  [9.20439710e+01 3.42118665e-02]
mat_Sqrt:  [[ 1.70248671e+01  0.00000000e+00]
 [-7.39858003e-03  1.69522765e-02]]
grads:  [-3.77995494e-03  1.30509116e+01]
Stock Position:  -0.003779954939806165
Bond Position:  [4.69493239]


portfolio before change:  [4.35107687]
curr_Stock_Price:  91.1234209251752
curr_Factors:  [9.11234209e+01 3.59596675e-02]
mat_Sqrt:  [[ 1.72797657e+01  0.00000000e+00]
 [-7.58521377e-03  1.73799081e-02]]
grads:  [-0.00735083  2.98960052]
Stock Position:  -0.007350825016434714
Bond Position:  [5.02090919]


portfolio before change:  [4.34956783]
curr_Stock_Price:  91.41409561906586
curr_Factors:  [9.14140956e+01 3.69469670e-02]
mat_Sqrt:  [[ 1.75712462e+01  0.00000000e+00]
 [-7.68863754e-03  1.76168817e-02]]
grads:  [ 0.01044198 -4.1434993 ]
Stock Position:  0.010441980092608376
Bond Position:  [3.39502366]


portfolio before change:  [4.34895314]
curr_Stock_Price:  91.31458449580553
curr_Factors:  [9.13145845e+01 3.64577435e-02]
mat_Sqrt:  [[ 1.74355254e+01  0.00000000e+00]
 [-7.63756438e-03  1.74998584e-02]]
grads:  [ 1.24657683e-02 -2.44295442e+01]
Stock Position:  0.01246576830876169
Bond Position:  [3.21064668]


portfolio before change:  [4.34109399]
curr_Stock_Price:  90.65192930702244
curr_Factors:  [9.06519293e+01 3.65588770e-02]
mat_Sqrt:  [[ 1.73329895e+01  0.00000000e+00]
 [-7.64815031e-03  1.75241139e-02]]
grads:  [ 0.00565355 -5.11519562]
Stock Position:  0.005653546410287618
Bond Position:  [3.8285891]


portfolio before change:  [4.33669678]
curr_Stock_Price:  89.78949523905298
curr_Factors:  [8.97894952e+01 3.60963220e-02]
mat_Sqrt:  [[ 1.70591350e+01  0.00000000e+00]
 [-7.59961283e-03  1.74129005e-02]]
grads:  [  0.0412238  -18.87167085]
Stock Position:  0.0412237952438567
Bond Position:  [0.63523301]


portfolio before change:  [4.35706831]
curr_Stock_Price:  90.2817380801811
curr_Factors:  [9.02817381e+01 3.55091419e-02]
mat_Sqrt:  [[ 1.70125729e+01  0.00000000e+00]
 [-7.53754781e-03  1.72706917e-02]]
grads:  [ -0.05463419 -20.55161875]
Stock Position:  -0.0546341897785328
Bond Position:  [9.28953792]


portfolio before change:  [4.31644317]
curr_Stock_Price:  91.04657782532715
curr_Factors:  [9.10465778e+01 3.57829176e-02]
mat_Sqrt:  [[ 1.72227105e+01  0.00000000e+00]
 [-7.56654929e-03  1.73371424e-02]]
grads:  [ 0.03713369 11.86976519]
Stock Position:  0.037133690698378574
Bond Position:  [0.93554771]


portfolio before change:  [4.31511137]
curr_Stock_Price:  91.00756344414897
curr_Factors:  [9.10075634e+01 3.54478038e-02]
mat_Sqrt:  [[ 1.71345283e+01  0.00000000e+00]
 [-7.53103486e-03  1.72557687e-02]]
grads:  [-4.38012003e-03  1.88420443e+01]
Stock Position:  -0.004380120030278578
Bond Position:  [4.71373543]


portfolio before change:  [4.31637041]
curr_Stock_Price:  90.85464895802319
curr_Factors:  [9.08546490e+01 3.59290341e-02]
mat_Sqrt:  [[ 1.72214583e+01  0.00000000e+00]
 [-7.58198223e-03  1.73725037e-02]]
grads:  [ 0.04810962 11.7087735 ]
Stock Position:  0.04810961518717847
Bond Position:  [-0.05461179]


portfolio before change:  [4.28632627]
curr_Stock_Price:  90.23029728275361
curr_Factors:  [9.02302973e+01 3.67528873e-02]
mat_Sqrt:  [[ 1.72980887e+01  0.00000000e+00]
 [-7.66841702e-03  1.75705507e-02]]
grads:  [ 1.29715522e-04 -8.03378165e+00]
Stock Position:  0.00012971552213748613
Bond Position:  [4.274622]


portfolio before change:  [4.28669407]
curr_Stock_Price:  88.94630168237116
curr_Factors:  [8.89463017e+01 3.76982390e-02]
mat_Sqrt:  [[ 1.72698445e+01  0.00000000e+00]
 [-7.76641374e-03  1.77950894e-02]]
grads:  [ 5.38637155e-03 -2.89631563e+01]
Stock Position:  0.005386371548209846
Bond Position:  [3.80759624]


portfolio before change:  [4.28601672]
curr_Stock_Price:  88.73218044160554
curr_Factors:  [8.87321804e+01 3.91336388e-02]
mat_Sqrt:  [[ 1.75531987e+01  0.00000000e+00]
 [-7.91288962e-03  1.81307078e-02]]
grads:  [ 0.00879303 -0.62672229]
Stock Position:  0.008793026944792118
Bond Position:  [3.50579226]


portfolio before change:  [4.29073218]
curr_Stock_Price:  89.21861285475795
curr_Factors:  [8.92186129e+01 3.81184203e-02]
mat_Sqrt:  [[ 1.74189877e+01  0.00000000e+00]
 [-7.80957569e-03  1.78939859e-02]]
grads:  [1.14772392e-02 3.66081912e+01]
Stock Position:  0.011477239160729848
Bond Position:  [3.26674882]


portfolio before change:  [4.30496249]
curr_Stock_Price:  90.42290414380626
curr_Factors:  [9.04229041e+01 3.69470927e-02]
mat_Sqrt:  [[ 1.73807530e+01  0.00000000e+00]
 [-7.68865062e-03  1.76169117e-02]]
grads:  [-0.02596141 -8.16404342]
Stock Position:  -0.02596140615881274
Bond Position:  [6.65246823]


portfolio before change:  [4.35457768]
curr_Stock_Price:  88.5438233015112
curr_Factors:  [8.85438233e+01 3.71411248e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.35457768]
Stock Price:  88.18937327830838
PL:  [4.35457768]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.20156471e+00  3.00550922e-01]
 [ 5.13467483e-01  1.25428654e-01]
 [ 7.62134075e-02  1.30192597e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.07792092e-01  7.89495299e-01]
 [ 8.80244593e-04 -8.15038815e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.57613074e-01  8.53344744e-01]
 [-2.85576428e-02  2.55984606e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-1.01863646e-01  5.38129473e-03]
 [ 2.58885462e-02 -1.35767348e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-6.05380356e-02  8.20429426e-03]
 [ 4.63410422e-01  2.95498708e-01]
 [ 1.32911344e-01 -2.95367890e-01]
 [ 3.70980290e-02 -4.82557399e-02]
 [ 3.15730321e-02 -1.53027975e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-4.33252962e-02 -5.86919845e-02]
 [ 1.65421161e-01 -3.63729146e-02]
 [ 5.49112058e-01 -2.15830186e-01]
 [ 3.02910528e-02 -4.14240977e-01]
 [ 5.40838495e-02  1.48352896e-02]
 [ 4.20167772e-01 -3.40280754e-01]
 [-3.49304434e-01  3.95213931e-02]
 [-1.33795646e-01  1.63891755e-01]
 [-9.22078383e-02 -1.01343124e-01]
 [-7.37281095e-02  2.10516936e-01]
 [-6.68391455e-01 -5.21119480e-02]
 [-1.52751399e-01 -2.66740613e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.48534786e-01  1.91392937e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.38176394e-01 -1.11053865e-02]
 [-2.69482137e-02 -1.81780472e-01]
 [-2.74218994e-03 -5.51441646e-02]
 [-5.81401476e-02 -4.83946056e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.41145952]
curr_Stock_Price:  100.54141601833786
curr_Factors:  [1.00541416e+02 3.86520614e-02]
mat_Sqrt:  [[ 1.97665706e+01  0.00000000e+00]
 [-7.86405101e-03  1.80188045e-02]]
grads:  [ 0.06742373 16.67984809]
Stock Position:  0.06742372834951797
Bond Position:  [-0.3674176]


portfolio before change:  [6.35656307]
curr_Stock_Price:  99.72789650497667
curr_Factors:  [9.97278965e+01 3.99245760e-02]
mat_Sqrt:  [[ 1.99267657e+01  0.00000000e+00]
 [-7.99245404e-03  1.83130128e-02]]
grads:  [0.02851487 6.84915448]
Stock Position:  0.028514865014890017
Bond Position:  [3.51283556]


portfolio before change:  [6.3170671]
curr_Stock_Price:  98.32739548190075
curr_Factors:  [9.83273955e+01 4.19015646e-02]
mat_Sqrt:  [[ 2.01274917e+01  0.00000000e+00]
 [-8.18794866e-03  1.87609473e-02]]
grads:  [0.00406884 0.69395535]
Stock Position:  0.004068836773603092
Bond Position:  [5.91698898]


portfolio before change:  [6.31951517]
curr_Stock_Price:  98.7472682055271
curr_Factors:  [9.87472682e+01 4.14454650e-02]
mat_Sqrt:  [[ 2.01031262e+01  0.00000000e+00]
 [-8.14326372e-03  1.86585612e-02]]
grads:  [-8.10887163e-04 -8.11353088e+00]
Stock Position:  -0.0008108871634307988
Bond Position:  [6.39958806]


portfolio before change:  [6.32123366]
curr_Stock_Price:  97.61456966998387
curr_Factors:  [9.76145697e+01 4.17597952e-02]
mat_Sqrt:  [[ 1.99477458e+01  0.00000000e+00]
 [-8.17408542e-03  1.87291826e-02]]
grads:  [1.18696071e-02 4.21532171e+01]
Stock Position:  0.011869607108008317
Bond Position:  [5.16258707]


portfolio before change:  [6.32303418]
curr_Stock_Price:  97.711890698674
curr_Factors:  [9.77118907e+01 4.21608232e-02]
mat_Sqrt:  [[ 2.00632811e+01  0.00000000e+00]
 [-8.21324036e-03  1.88188978e-02]]
grads:  [-1.72907738e-03 -4.33095936e+00]
Stock Position:  -0.0017290773822757348
Bond Position:  [6.4919856]


portfolio before change:  [6.32358404]
curr_Stock_Price:  97.86323859557986
curr_Factors:  [9.78632386e+01 4.34647627e-02]
mat_Sqrt:  [[ 2.04027280e+01  0.00000000e+00]
 [-8.33928176e-03  1.91076950e-02]]
grads:  [0.006341   5.03131787]
Stock Position:  0.0063410038655269665
Bond Position:  [5.70303287]


portfolio before change:  [6.32367738]
curr_Stock_Price:  97.76552738627916
curr_Factors:  [9.77655274e+01 4.34144828e-02]
mat_Sqrt:  [[ 2.03705644e+01  0.00000000e+00]
 [-8.33445694e-03  1.90966399e-02]]
grads:  [ 0.06038337 44.68559644]
Stock Position:  0.060383366215032666
Bond Position:  [0.42026573]


portfolio before change:  [6.38277443]
curr_Stock_Price:  98.74335483804309
curr_Factors:  [9.87433548e+01 4.29921015e-02]
mat_Sqrt:  [[ 2.04739772e+01  0.00000000e+00]
 [-8.29381470e-03  1.90035168e-02]]
grads:  [4.06189757e-03 1.34703806e+01]
Stock Position:  0.004061897570430734
Bond Position:  [5.98168903]


portfolio before change:  [6.38000615]
curr_Stock_Price:  97.8777401357637
curr_Factors:  [9.78777401e+01 4.22253634e-02]
mat_Sqrt:  [[ 2.01127118e+01  0.00000000e+00]
 [-8.21952440e-03  1.88332964e-02]]
grads:  [0.01225266 6.0040755 ]
Stock Position:  0.012252658354929244
Bond Position:  [5.18074364]


portfolio before change:  [6.39051603]
curr_Stock_Price:  98.68264756131234
curr_Factors:  [9.86826476e+01 4.15012947e-02]
mat_Sqrt:  [[ 2.01034973e+01  0.00000000e+00]
 [-8.14874663e-03  1.86711241e-02]]
grads:  [-0.00495014  0.28821482]
Stock Position:  -0.004950136546122495
Bond Position:  [6.87900861]


portfolio before change:  [6.38535768]
curr_Stock_Price:  99.89842887807798
curr_Factors:  [9.98984289e+01 3.98981239e-02]
mat_Sqrt:  [[ 1.99542264e+01  0.00000000e+00]
 [-7.98980590e-03  1.83069452e-02]]
grads:  [-1.67208598e-03 -7.41616620e+00]
Stock Position:  -0.0016720859830539898
Bond Position:  [6.55239644]


portfolio before change:  [6.38776183]
curr_Stock_Price:  98.95048000599405
curr_Factors:  [9.89504800e+01 3.98753612e-02]
mat_Sqrt:  [[ 1.97592393e+01  0.00000000e+00]
 [-7.98752639e-03  1.83017222e-02]]
grads:  [-0.00654625 -1.53271943]
Stock Position:  -0.006546248385787822
Bond Position:  [7.03551625]


portfolio before change:  [6.38798553]
curr_Stock_Price:  99.05065982036575
curr_Factors:  [9.90506598e+01 4.07983117e-02]
mat_Sqrt:  [[ 2.00068386e+01  0.00000000e+00]
 [-8.07943678e-03  1.85123153e-02]]
grads:  [-0.0028469   0.44318034]
Stock Position:  -0.0028468959614728227
Bond Position:  [6.66997245]


portfolio before change:  [6.38702834]
curr_Stock_Price:  99.67976250130934
curr_Factors:  [9.96797625e+01 4.13783307e-02]
mat_Sqrt:  [[ 2.02765227e+01  0.00000000e+00]
 [-8.13666573e-03  1.86434433e-02]]
grads:  [ 0.0292149  15.85000705]
Stock Position:  0.029214902381237137
Bond Position:  [3.4748938]


portfolio before change:  [6.41047715]
curr_Stock_Price:  100.46752586725982
curr_Factors:  [1.00467526e+02 4.20200076e-02]
mat_Sqrt:  [[ 2.05946194e+01  0.00000000e+00]
 [-8.19951293e-03  1.87874443e-02]]
grads:  [ 1.94333698e-04 -1.57215577e+01]
Stock Position:  0.0001943336977101411
Bond Position:  [6.39095293]


portfolio before change:  [6.41141882]
curr_Stock_Price:  101.20209145362034
curr_Factors:  [1.01202091e+02 4.19818757e-02]
mat_Sqrt:  [[ 2.07357815e+01  0.00000000e+00]
 [-8.19579167e-03  1.87789179e-02]]
grads:  [ 7.73421420e-04 -2.56967629e+00]
Stock Position:  0.0007734214204353818
Bond Position:  [6.33314696]


portfolio before change:  [6.41318702]
curr_Stock_Price:  102.46466643113997
curr_Factors:  [1.02464666e+02 4.23118459e-02]
mat_Sqrt:  [[ 2.10768215e+01  0.00000000e+00]
 [-8.22793738e-03  1.88525729e-02]]
grads:  [-1.67073824e-03 -8.11708701e+00]
Stock Position:  -0.001670738235499123
Bond Position:  [6.58437866]


portfolio before change:  [6.4135711]
curr_Stock_Price:  102.7274343734686
curr_Factors:  [1.02727434e+02 4.12813219e-02]
mat_Sqrt:  [[ 2.08719603e+01  0.00000000e+00]
 [-8.12712219e-03  1.86215763e-02]]
grads:  [-1.52727938e-02 -2.52012846e+01]
Stock Position:  -0.01527279375252493
Bond Position:  [7.98250602]


portfolio before change:  [6.44591764]
curr_Stock_Price:  100.67485255277657
curr_Factors:  [1.00674853e+02 4.12026393e-02]
mat_Sqrt:  [[ 2.04354178e+01  0.00000000e+00]
 [-8.11937331e-03  1.86038214e-02]]
grads:  [-0.00337358 -3.15483488]
Stock Position:  -0.003373583017442501
Bond Position:  [6.78555261]


portfolio before change:  [6.442673]
curr_Stock_Price:  101.88806726237286
curr_Factors:  [1.01888067e+02 3.92945429e-02]
mat_Sqrt:  [[ 2.01971199e+01  0.00000000e+00]
 [-7.92914047e-03  1.81679432e-02]]
grads:  [ 0.00740436 -2.0020381 ]
Stock Position:  0.007404358669248656
Bond Position:  [5.68825721]


portfolio before change:  [6.44529241]
curr_Stock_Price:  102.14579809817275
curr_Factors:  [1.02145798e+02 3.85384172e-02]
mat_Sqrt:  [[ 2.00524501e+01  0.00000000e+00]
 [-7.85248162e-03  1.79922957e-02]]
grads:  [  0.02268631 -11.99570025]
Stock Position:  0.02268630722634368
Bond Position:  [4.12798145]


portfolio before change:  [6.45042196]
curr_Stock_Price:  102.3491596923026
curr_Factors:  [1.02349160e+02 3.79246356e-02]
mat_Sqrt:  [[ 1.99317297e+01  0.00000000e+00]
 [-7.78969942e-03  1.78484436e-02]]
grads:  [-7.55070098e-03 -2.32088010e+01]
Stock Position:  -0.007550700976208301
Bond Position:  [7.22322986]


portfolio before change:  [6.45031097]
curr_Stock_Price:  102.48344556890979
curr_Factors:  [1.02483446e+02 3.70900208e-02]
mat_Sqrt:  [[ 1.97370507e+01  0.00000000e+00]
 [-7.70350786e-03  1.76509539e-02]]
grads:  [0.00306826 0.8404809 ]
Stock Position:  0.0030682649395186988
Bond Position:  [6.13586461]


portfolio before change:  [6.45376156]
curr_Stock_Price:  103.35806198822371
curr_Factors:  [1.03358062e+02 3.66012916e-02]
mat_Sqrt:  [[ 1.97739105e+01  0.00000000e+00]
 [-7.65258561e-03  1.75342764e-02]]
grads:  [ 1.37381564e-02 -1.94066037e+01]
Stock Position:  0.013738156432777284
Bond Position:  [5.03381233]


portfolio before change:  [6.47910298]
curr_Stock_Price:  105.15685908024508
curr_Factors:  [1.05156859e+02 3.61345791e-02]
mat_Sqrt:  [[ 1.99893700e+01  0.00000000e+00]
 [-7.60363903e-03  1.74221257e-02]]
grads:  [-0.01661162  2.26845987]
Stock Position:  -0.01661162329810703
Bond Position:  [8.22592911]


portfolio before change:  [6.4678403]
curr_Stock_Price:  105.89676159734184
curr_Factors:  [1.05896762e+02 3.71664054e-02]
mat_Sqrt:  [[ 2.04154031e+01  0.00000000e+00]
 [-7.71143623e-03  1.76691201e-02]]
grads:  [-3.05002161e-03  9.27560362e+00]
Stock Position:  -0.0030500216105608735
Bond Position:  [6.79082771]


portfolio before change:  [6.46915332]
curr_Stock_Price:  105.74459639998811
curr_Factors:  [1.05744596e+02 3.62497380e-02]
mat_Sqrt:  [[ 2.01330986e+01  0.00000000e+00]
 [-7.61574558e-03  1.74498653e-02]]
grads:  [-0.00677678 -5.80767374]
Stock Position:  -0.006776781204665179
Bond Position:  [7.18576131]


portfolio before change:  [6.47460567]
curr_Stock_Price:  105.07258512431662
curr_Factors:  [1.05072585e+02 3.62929031e-02]
mat_Sqrt:  [[ 2.00170591e+01  0.00000000e+00]
 [-7.62027854e-03  1.74602516e-02]]
grads:  [9.06677329e-04 1.20569245e+01]
Stock Position:  0.0009066773288276025
Bond Position:  [6.37933874]


portfolio before change:  [6.47374585]
curr_Stock_Price:  103.24471876538784
curr_Factors:  [1.03244719e+02 3.60138162e-02]
mat_Sqrt:  [[ 1.95930667e+01  0.00000000e+00]
 [-7.59092260e-03  1.73929887e-02]]
grads:  [-0.03527447 -2.99614683]
Stock Position:  -0.035274466388872876
Bond Position:  [10.11564821]


portfolio before change:  [6.44942669]
curr_Stock_Price:  103.96999393756826
curr_Factors:  [1.03969994e+02 3.58663654e-02]
mat_Sqrt:  [[ 1.96902714e+01  0.00000000e+00]
 [-7.57536696e-03  1.73573463e-02]]
grads:  [-0.00834894 -1.53675919]
Stock Position:  -0.008348940972816979
Bond Position:  [7.31746603]


portfolio before change:  [6.44780335]
curr_Stock_Price:  104.27399426382644
curr_Factors:  [1.04273994e+02 3.62122375e-02]
mat_Sqrt:  [[ 1.98428336e+01  0.00000000e+00]
 [-7.61180531e-03  1.74408370e-02]]
grads:  [ 0.00365586 -0.68501237]
Stock Position:  0.0036558587494937215
Bond Position:  [6.06659235]


portfolio before change:  [6.44943473]
curr_Stock_Price:  104.51279288132912
curr_Factors:  [1.04512793e+02 3.54780243e-02]
mat_Sqrt:  [[ 1.96856231e+01  0.00000000e+00]
 [-7.53424441e-03  1.72631227e-02]]
grads:  [-0.01220087  1.10868086]
Stock Position:  -0.012200869199250319
Bond Position:  [7.72458165]


portfolio before change:  [6.46339509]
curr_Stock_Price:  103.44772771857662
curr_Factors:  [1.03447728e+02 3.57202017e-02]
mat_Sqrt:  [[ 1.95514021e+01  0.00000000e+00]
 [-7.55991553e-03  1.73219426e-02]]
grads:  [0.00518997 3.07985439]
Stock Position:  0.0051899690526372
Bond Position:  [5.92650458]


portfolio before change:  [6.46589124]
curr_Stock_Price:  103.78593564270446
curr_Factors:  [1.03785936e+02 3.45308778e-02]
mat_Sqrt:  [[ 1.92860067e+01  0.00000000e+00]
 [-7.43299431e-03  1.70311295e-02]]
grads:  [-0.00490862  4.77508823]
Stock Position:  -0.004908616493626166
Bond Position:  [6.97533659]


portfolio before change:  [6.46133811]
curr_Stock_Price:  104.89115441106749
curr_Factors:  [1.04891154e+02 3.56991697e-02]
mat_Sqrt:  [[ 1.98183696e+01  0.00000000e+00]
 [-7.55768957e-03  1.73168423e-02]]
grads:  [-0.01730835 -0.64130552]
Stock Position:  -0.017308345203970784
Bond Position:  [8.27683042]


portfolio before change:  [6.47926419]
curr_Stock_Price:  103.91524293250885
curr_Factors:  [1.03915243e+02 3.61738960e-02]
mat_Sqrt:  [[ 1.97640935e+01  0.00000000e+00]
 [-7.60777454e-03  1.74316014e-02]]
grads:  [-5.37761653e-03 -1.04282142e+01]
Stock Position:  -0.005377616532577342
Bond Position:  [7.03808052]


portfolio before change:  [6.48689001]
curr_Stock_Price:  102.66078281219737
curr_Factors:  [1.02660783e+02 3.74981178e-02]
mat_Sqrt:  [[ 1.98796762e+01  0.00000000e+00]
 [-7.74577229e-03  1.77477939e-02]]
grads:  [-1.34856706e-03 -3.10709967e+00]
Stock Position:  -0.001348567060066179
Bond Position:  [6.62533496]


portfolio before change:  [6.48856919]
curr_Stock_Price:  102.02977528317878
curr_Factors:  [1.02029775e+02 3.68184741e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.48856919]
Stock Price:  100.91669252146406
PL:  [5.57187667]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.46176224e+00  3.61975878e-01]
 [ 1.45055016e+00  3.58357681e-02]
 [ 1.31146243e-02  5.58851350e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.08189292e-01  8.01758492e-01]
 [-1.66264152e-03 -8.94449825e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.13317856e+00  1.15896608e+00]
 [ 8.81653674e-02  5.67983714e-01]
 [ 4.47604529e-02 -1.57329167e-01]
 [ 1.06486689e-01  1.42597146e-02]
 [ 5.29871752e-02 -8.79286098e-02]
 [-5.35242644e-02  2.24052829e-01]
 [-1.29399557e-01  2.89433530e-01]
 [ 1.25926474e-01  1.51748672e-01]
 [ 1.29963010e-01 -1.42954091e-01]
 [ 3.42970647e-02 -1.90708858e-01]
 [ 4.26284187e-01  6.09853767e-02]
 [ 5.03862984e-01  5.18283854e-01]
 [-1.09571895e+00  5.61721098e-01]
 [-4.80432174e-01  5.57656810e-01]
 [ 2.16740700e+00  4.61121370e-01]
 [ 1.15060835e-02  2.92336646e-01]
 [-1.84225107e-01  3.12964470e-01]
 [-1.11763251e-01 -2.40382524e-02]
 [ 3.24827205e-01 -1.15611052e-01]
 [ 1.02625674e+00 -2.91926868e-01]
 [ 1.96229552e-01 -2.15479357e-01]
 [ 1.24963729e+00 -3.59921330e-01]
 [-1.27932849e+00 -4.75820278e-01]
 [ 1.46414623e+00  5.43216159e-01]
 [-4.67283511e-01  7.53979783e-01]
 [ 1.36391517e+00  4.83631904e-02]
 [ 1.05095401e-01 -3.64905202e-01]
 [ 4.60630775e-01 -1.00731304e+00]
 [ 2.89664390e-01 -9.98950344e-02]
 [-1.38118622e-01  1.49098368e+00]
 [-4.94641863e-01 -1.69011056e-01]
 [-1.88784131e+00  4.39243046e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.45819719]
curr_Stock_Price:  98.81847641166648
curr_Factors:  [9.88184764e+01 3.93685015e-02]
mat_Sqrt:  [[ 1.96070653e+01  0.00000000e+00]
 [-7.93659892e-03  1.81850326e-02]]
grads:  [ 0.08261009 19.90515413]
Stock Position:  0.08261009196550055
Bond Position:  [-13.62160062]


portfolio before change:  [-5.59202249]
curr_Stock_Price:  97.21912595920922
curr_Factors:  [9.72191260e+01 4.03196699e-02]
mat_Sqrt:  [[ 1.95213657e+01  0.00000000e+00]
 [-8.03190338e-03  1.84034026e-02]]
grads:  [0.07510695 1.947236  ]
Stock Position:  0.0751069465549544
Bond Position:  [-12.89385419]


portfolio before change:  [-5.54245034]
curr_Stock_Price:  97.90060725092708
curr_Factors:  [9.79006073e+01 3.89425742e-02]
mat_Sqrt:  [[ 1.93195815e+01  0.00000000e+00]
 [-7.89354919e-03  1.80863933e-02]]
grads:  [1.94128930e-03 3.08989935e+00]
Stock Position:  0.0019412893018192023
Bond Position:  [-5.73250374]


portfolio before change:  [-5.54342624]
curr_Stock_Price:  97.7670398580814
curr_Factors:  [9.77670399e+01 3.91352176e-02]
mat_Sqrt:  [[ 1.93408850e+01  0.00000000e+00]
 [-7.91304923e-03  1.81310735e-02]]
grads:  [-8.42844935e-04 -8.34957798e+00]
Stock Position:  -0.0008428449351603511
Bond Position:  [-5.46102379]


portfolio before change:  [-5.54395337]
curr_Stock_Price:  97.58249677026667
curr_Factors:  [9.75824968e+01 3.90096876e-02]
mat_Sqrt:  [[ 1.92733923e+01  0.00000000e+00]
 [-7.90034810e-03  1.81019716e-02]]
grads:  [1.25419955e-02 4.42912247e+01]
Stock Position:  0.012541995547536306
Bond Position:  [-6.76783261]


portfolio before change:  [-5.54127197]
curr_Stock_Price:  97.86374667076637
curr_Factors:  [9.78637467e+01 3.78073175e-02]
mat_Sqrt:  [[ 1.90287286e+01  0.00000000e+00]
 [-7.77764155e-03  1.78208156e-02]]
grads:  [-2.13885190e-03 -5.01912958e+00]
Stock Position:  -0.002138851901395849
Bond Position:  [-5.33195591]


portfolio before change:  [-5.53857797]
curr_Stock_Price:  96.29255878755677
curr_Factors:  [9.62925588e+01 3.88834310e-02]
mat_Sqrt:  [[ 1.89878161e+01  0.00000000e+00]
 [-7.88755283e-03  1.80726539e-02]]
grads:  [0.00681352 5.31946705]
Stock Position:  0.006813515385097804
Bond Position:  [-6.1946688]


portfolio before change:  [-5.54271299]
curr_Stock_Price:  95.7993266742562
curr_Factors:  [9.57993267e+01 3.79239185e-02]
mat_Sqrt:  [[ 1.86560226e+01  0.00000000e+00]
 [-7.78962577e-03  1.78482749e-02]]
grads:  [ 0.08785328 64.93434746]
Stock Position:  0.08785328291686051
Bond Position:  [-13.95899834]


portfolio before change:  [-5.58144044]
curr_Stock_Price:  95.37836961326876
curr_Factors:  [9.53783696e+01 3.92136803e-02]
mat_Sqrt:  [[ 1.88872486e+01  0.00000000e+00]
 [-7.92097775e-03  1.81492401e-02]]
grads:  [1.77926277e-02 3.12951789e+01]
Stock Position:  0.01779262773243693
Bond Position:  [-7.27847226]


portfolio before change:  [-5.5937433]
curr_Stock_Price:  94.7380486811155
curr_Factors:  [9.47380487e+01 3.92357532e-02]
mat_Sqrt:  [[ 1.87657286e+01  0.00000000e+00]
 [-7.92320674e-03  1.81543473e-02]]
grads:  [-1.27379145e-03 -8.66619790e+00]
Stock Position:  -0.001273791450291998
Bond Position:  [-5.47306678]


portfolio before change:  [-5.59242406]
curr_Stock_Price:  93.16525350439015
curr_Factors:  [9.31652535e+01 4.02952334e-02]
mat_Sqrt:  [[ 1.87016880e+01  0.00000000e+00]
 [-8.02946906e-03  1.83978249e-02]]
grads:  [0.00602674 0.77507611]
Stock Position:  0.006026736106823673
Bond Position:  [-6.15390646]


portfolio before change:  [-5.58500341]
curr_Stock_Price:  94.52418689372418
curr_Factors:  [9.45241869e+01 3.98819233e-02]
mat_Sqrt:  [[ 1.88769140e+01  0.00000000e+00]
 [-7.98818361e-03  1.83032280e-02]]
grads:  [ 7.74066344e-04 -4.80399467e+00]
Stock Position:  0.0007740663437352596
Bond Position:  [-5.6581714]


portfolio before change:  [-5.58606551]
curr_Stock_Price:  94.06585327996903
curr_Factors:  [9.40658533e+01 3.99963394e-02]
mat_Sqrt:  [[ 1.88123098e+01  0.00000000e+00]
 [-7.99963394e-03  1.83294640e-02]]
grads:  [2.35273644e-03 1.22236432e+01]
Stock Position:  0.002352736438638991
Bond Position:  [-5.80737767]


portfolio before change:  [-5.58224116]
curr_Stock_Price:  95.99990498373892
curr_Factors:  [9.59999050e+01 3.86629961e-02]
mat_Sqrt:  [[ 1.88763732e+01  0.00000000e+00]
 [-7.86516331e-03  1.80213531e-02]]
grads:  [-1.63188542e-04  1.60605882e+01]
Stock Position:  -0.00016318854199155134
Bond Position:  [-5.56657508]


portfolio before change:  [-5.58256174]
curr_Stock_Price:  93.70017113733692
curr_Factors:  [9.37001711e+01 4.07876552e-02]
mat_Sqrt:  [[ 1.89236433e+01  0.00000000e+00]
 [-8.07838154e-03  1.85098975e-02]]
grads:  [0.01015423 8.1982449 ]
Stock Position:  0.010154229855834826
Bond Position:  [-6.53401481]


portfolio before change:  [-5.59943647]
curr_Stock_Price:  92.11876756427716
curr_Factors:  [9.21187676e+01 4.29574401e-02]
mat_Sqrt:  [[ 1.90926985e+01  0.00000000e+00]
 [-8.29047068e-03  1.89958547e-02]]
grads:  [ 3.53919219e-03 -7.52554138e+00]
Stock Position:  0.0035391921879064183
Bond Position:  [-5.9254625]


portfolio before change:  [-5.60661707]
curr_Stock_Price:  90.29918225668223
curr_Factors:  [9.02991823e+01 4.26446315e-02]
mat_Sqrt:  [[ 1.86473018e+01  0.00000000e+00]
 [-8.26023065e-03  1.89265661e-02]]
grads:  [-2.62424586e-03 -1.00762524e+01]
Stock Position:  -0.0026242458609261787
Bond Position:  [-5.36964981]


portfolio before change:  [-5.61015995]
curr_Stock_Price:  91.39345252472687
curr_Factors:  [9.13934525e+01 4.14036793e-02]
mat_Sqrt:  [[ 1.85966429e+01  0.00000000e+00]
 [-8.13915763e-03  1.86491530e-02]]
grads:  [0.02435388 3.27014191]
Stock Position:  0.024353878815977902
Bond Position:  [-7.83594502]


portfolio before change:  [-5.61529368]
curr_Stock_Price:  91.22287678265448
curr_Factors:  [9.12228768e+01 4.18730327e-02]
mat_Sqrt:  [[ 1.86668472e+01  0.00000000e+00]
 [-8.18516050e-03  1.87545588e-02]]
grads:  [ 0.03911001 27.6350865 ]
Stock Position:  0.03911001119022213
Bond Position:  [-9.18302142]


portfolio before change:  [-5.69629705]
curr_Stock_Price:  89.18106155932297
curr_Factors:  [8.91810616e+01 4.27787982e-02]
mat_Sqrt:  [[ 1.84453511e+01  0.00000000e+00]
 [-8.27321443e-03  1.89563157e-02]]
grads:  [-0.04611264 29.63239836]
Stock Position:  -0.04611263609229133
Bond Position:  [-1.58392321]


portfolio before change:  [-5.64976079]
curr_Stock_Price:  88.1675809276915
curr_Factors:  [8.81675809e+01 4.32465899e-02]
mat_Sqrt:  [[ 1.83351665e+01  0.00000000e+00]
 [-8.31832578e-03  1.90596788e-02]]
grads:  [-1.29287502e-02  2.92584580e+01]
Stock Position:  -0.012928750224883524
Bond Position:  [-4.50986416]


portfolio before change:  [-5.64621486]
curr_Stock_Price:  87.84970782860827
curr_Factors:  [8.78497078e+01 4.32164493e-02]
mat_Sqrt:  [[ 1.82626948e+01  0.00000000e+00]
 [-8.31542656e-03  1.90530358e-02]]
grads:  [ 0.1296992  24.20198936]
Stock Position:  0.1296991977233818
Bond Position:  [-17.04025148]


portfolio before change:  [-5.60491133]
curr_Stock_Price:  88.18458800956954
curr_Factors:  [8.81845880e+01 4.29948756e-02]
mat_Sqrt:  [[ 1.82852557e+01  0.00000000e+00]
 [-8.29408229e-03  1.90041300e-02]]
grads:  [7.60679848e-03 1.53827955e+01]
Stock Position:  0.0076067984805522244
Bond Position:  [-6.27571372]


portfolio before change:  [-5.6054698]
curr_Stock_Price:  88.21430446011281
curr_Factors:  [8.82143045e+01 4.28129961e-02]
mat_Sqrt:  [[ 1.82526878e+01  0.00000000e+00]
 [-8.27652063e-03  1.89638911e-02]]
grads:  [-2.60981913e-03  1.65031780e+01]
Stock Position:  -0.0026098191281928957
Bond Position:  [-5.37524642]


portfolio before change:  [-5.60526104]
curr_Stock_Price:  87.87684683895354
curr_Factors:  [8.78768468e+01 4.25190278e-02]
mat_Sqrt:  [[ 1.81203311e+01  0.00000000e+00]
 [-8.24805702e-03  1.88986728e-02]]
grads:  [-0.00674681 -1.27195453]
Stock Position:  -0.0067468085115708004
Bond Position:  [-5.01237278]


portfolio before change:  [-5.59480143]
curr_Stock_Price:  86.23367119378752
curr_Factors:  [8.62336712e+01 4.49176718e-02]
mat_Sqrt:  [[ 1.82761828e+01  0.00000000e+00]
 [-8.47751584e-03  1.94244290e-02]]
grads:  [ 0.01501246 -5.95183783]
Stock Position:  0.015012456790676998
Bond Position:  [-6.8893807]


portfolio before change:  [-5.60963636]
curr_Stock_Price:  85.30286426631936
curr_Factors:  [8.53028643e+01 4.50038454e-02]
mat_Sqrt:  [[ 1.80962433e+01  0.00000000e+00]
 [-8.48564391e-03  1.94430528e-02]]
grads:  [  0.0496705  -15.01445642]
Stock Position:  0.049670497406240834
Bond Position:  [-9.84667206]


portfolio before change:  [-5.60826604]
curr_Stock_Price:  85.35523399244855
curr_Factors:  [8.5355234e+01 4.4022988e-02]
mat_Sqrt:  [[ 1.79089414e+01  0.00000000e+00]
 [-8.39266232e-03  1.92300052e-02]]
grads:  [ 5.70590120e-03 -1.12053718e+01]
Stock Position:  0.005705901199088196
Bond Position:  [-6.09529457]


portfolio before change:  [-5.61532556]
curr_Stock_Price:  84.25154103290967
curr_Factors:  [8.42515410e+01 4.36881233e-02]
mat_Sqrt:  [[ 1.76100078e+01  0.00000000e+00]
 [-8.36068163e-03  1.91567282e-02]]
grads:  [  0.0620417 -18.7882464]
Stock Position:  0.06204169540668731
Bond Position:  [-10.84243401]


portfolio before change:  [-5.68246888]
curr_Stock_Price:  83.19115845419702
curr_Factors:  [8.31911585e+01 4.39576568e-02]
mat_Sqrt:  [[ 1.74419260e+01  0.00000000e+00]
 [-8.38643255e-03  1.92157310e-02]]
grads:  [ -0.08525397 -24.76201809]
Stock Position:  -0.08525397307818798
Bond Position:  [1.4099079]


portfolio before change:  [-5.58776055]
curr_Stock_Price:  82.08232941120178
curr_Factors:  [8.20823294e+01 4.48235200e-02]
mat_Sqrt:  [[ 1.73781144e+01  0.00000000e+00]
 [-8.46862633e-03  1.94040606e-02]]
grads:  [ 0.09789469 27.99497333]
Stock Position:  0.09789469460687143
Bond Position:  [-13.62318512]


portfolio before change:  [-5.50366151]
curr_Stock_Price:  82.95880229364339
curr_Factors:  [8.29588023e+01 4.43570043e-02]
mat_Sqrt:  [[ 1.74720385e+01  0.00000000e+00]
 [-8.42444104e-03  1.93028194e-02]]
grads:  [-7.91091181e-03  3.90606040e+01]
Stock Position:  -0.007910911813355277
Bond Position:  [-4.84738174]


portfolio before change:  [-5.50799319]
curr_Stock_Price:  83.42976163145303
curr_Factors:  [8.34297616e+01 4.32588889e-02]
mat_Sqrt:  [[ 1.73523653e+01  0.00000000e+00]
 [-8.31950853e-03  1.90623888e-02]]
grads:  [0.07981751 2.5371002 ]
Stock Position:  0.07981751008748074
Bond Position:  [-12.16714903]


portfolio before change:  [-5.61645494]
curr_Stock_Price:  82.08994582846803
curr_Factors:  [8.20899458e+01 4.42210738e-02]
mat_Sqrt:  [[ 1.72625366e+01  0.00000000e+00]
 [-8.41152294e-03  1.92732203e-02]]
grads:  [-3.13756241e-03 -1.89332762e+01]
Stock Position:  -0.0031375624137974724
Bond Position:  [-5.35889261]


portfolio before change:  [-5.61588595]
curr_Stock_Price:  81.69508574556296
curr_Factors:  [8.16950857e+01 4.55992078e-02]
mat_Sqrt:  [[ 1.74451449e+01  0.00000000e+00]
 [-8.54158840e-03  1.95712377e-02]]
grads:  [ 1.20396368e-03 -5.14690515e+01]
Stock Position:  0.0012039636758029177
Bond Position:  [-5.71424386]


portfolio before change:  [-5.61713009]
curr_Stock_Price:  81.25502346217824
curr_Factors:  [8.12550235e+01 4.59166739e-02]
mat_Sqrt:  [[ 1.74114697e+01  0.00000000e+00]
 [-8.57127051e-03  1.96392480e-02]]
grads:  [ 0.01413244 -5.08649998]
Stock Position:  0.014132444177132528
Bond Position:  [-6.76546217]


portfolio before change:  [-5.63840689]
curr_Stock_Price:  79.80933807989815
curr_Factors:  [7.98093381e+01 4.37453797e-02]
mat_Sqrt:  [[ 1.66924392e+01  0.00000000e+00]
 [-8.36615846e-03  1.91692772e-02]]
grads:  [3.07085139e-02 7.77798589e+01]
Stock Position:  0.030708513907343693
Bond Position:  [-8.08923306]


portfolio before change:  [-5.62602067]
curr_Stock_Price:  80.2456158872172
curr_Factors:  [8.02456159e+01 4.39269792e-02]
mat_Sqrt:  [[ 1.68184893e+01  0.00000000e+00]
 [-8.38350563e-03  1.92090246e-02]]
grads:  [-0.0337964  -8.79852358]
Stock Position:  -0.033796396604579955
Bond Position:  [-2.91400801]


portfolio before change:  [-5.63759272]
curr_Stock_Price:  80.57724226111512
curr_Factors:  [8.05772423e+01 4.28109467e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.63759272]
Stock Price:  79.6483964825169
PL:  [-5.63759272]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.33304687e+00  3.30276404e-01]
 [ 3.83161090e-01  1.17082516e-01]
 [ 1.12641488e-01 -4.41503088e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.88463820e-02  4.26733935e-01]
 [-7.19219164e-02 -1.22544834e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 9.90607671e-01  1.00063556e+00]
 [ 4.41851967e-02  4.50410977e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-2.36497967e-02  1.87192632e-02]
 [ 5.91329919e-02 -9.37361117e-02]
 [-1.07622963e-01  1.91310665e-02]
 [-1.05841796e-01  1.68069707e-01]
 [ 4.91602515e-01  3.20807769e-01]
 [ 1.30341841e-01  9.50717870e-02]
 [ 4.03819590e-02  9.25082543e-02]
 [ 7.22911195e-02  8.13244660e-02]
 [-4.88010680e-02 -3.14125155e-02]
 [-3.37270046e-01  1.21516033e-01]
 [ 1.06508835e-01  6.98690577e-02]
 [ 1.27293091e+00  1.30527238e-01]
 [ 1.78760563e-02  2.64612908e-01]
 [-1.36771237e-01  1.26269015e-01]
 [-1.87991026e-01  1.65968939e-01]
 [ 1.26109678e-01 -1.04634755e-01]
 [-1.27423813e-01 -3.92309886e-01]
 [ 6.86490238e-02  5.61060311e-02]
 [ 3.21898155e-01 -1.00183010e-01]
 [-5.37646290e-01 -1.56919158e-01]
 [-1.64395045e-01 -5.83116281e-02]
 [-4.05852507e-02  2.33171292e-02]
 [-5.39474085e-02  1.66908830e-01]
 [ 5.62662291e-03  1.35765919e-02]
 [-6.78518766e-03  6.05431529e-02]
 [-1.74839015e-01  1.02180277e-01]
 [-1.98584620e-02 -2.47169310e-01]
 [ 2.24828416e-02 -2.42834766e-02]
 [-3.72989425e-02 -9.76581206e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.50914997]
curr_Stock_Price:  99.97497641147336
curr_Factors:  [9.99749764e+01 4.02446374e-02]
mat_Sqrt:  [[ 2.00560461e+01  0.00000000e+00]
 [-8.02442645e-03  1.83862708e-02]]
grads:  [ 0.07365317 17.96320784]
Stock Position:  0.07365316678449713
Bond Position:  [-4.85432364]


portfolio before change:  [2.51769603]
curr_Stock_Price:  100.09924659656582
curr_Factors:  [1.00099247e+02 4.00241152e-02]
mat_Sqrt:  [[ 2.00258832e+01  0.00000000e+00]
 [-8.00241116e-03  1.83358274e-02]]
grads:  [0.02168494 6.38545038]
Stock Position:  0.02168494067999604
Bond Position:  [0.34704981]


portfolio before change:  [2.50690796]
curr_Stock_Price:  99.59975456570943
curr_Factors:  [9.95997546e+01 4.12158390e-02]
mat_Sqrt:  [[ 2.02204278e+01  0.00000000e+00]
 [-8.12067376e-03  1.86068011e-02]]
grads:  [ 0.00461774 -2.3728049 ]
Stock Position:  0.0046177417179187556
Bond Position:  [2.04698202]


portfolio before change:  [2.5082066]
curr_Stock_Price:  99.82556941055255
curr_Factors:  [9.98255694e+01 4.14035921e-02]
mat_Sqrt:  [[ 2.03123797e+01  0.00000000e+00]
 [-8.13914906e-03  1.86491333e-02]]
grads:  [-8.02533587e-04 -8.11763259e+00]
Stock Position:  -0.0008025335868177475
Bond Position:  [2.58831998]


portfolio before change:  [2.50969712]
curr_Stock_Price:  98.3714823447769
curr_Factors:  [9.83714823e+01 4.19919641e-02]
mat_Sqrt:  [[ 2.01582260e+01  0.00000000e+00]
 [-8.19677636e-03  1.87811741e-02]]
grads:  [4.83155492e-03 2.27213663e+01]
Stock Position:  0.004831554916032699
Bond Position:  [2.0344099]


portfolio before change:  [2.51228725]
curr_Stock_Price:  98.85493161257075
curr_Factors:  [9.88549316e+01 4.33960511e-02]
mat_Sqrt:  [[ 2.05931814e+01  0.00000000e+00]
 [-8.33268754e-03  1.90925857e-02]]
grads:  [-6.08963054e-03 -6.41845141e+00]
Stock Position:  -0.0060896305372956355
Bond Position:  [3.11427726]


portfolio before change:  [2.52701623]
curr_Stock_Price:  96.50016246602667
curr_Factors:  [9.65001625e+01 4.39079460e-02]
mat_Sqrt:  [[ 2.02208592e+01  0.00000000e+00]
 [-8.38168918e-03  1.92048626e-02]]
grads:  [0.00639804 5.00586176]
Stock Position:  0.006398035612832552
Bond Position:  [1.90960475]


portfolio before change:  [2.52928906]
curr_Stock_Price:  96.81808983149448
curr_Factors:  [9.68180898e+01 4.20496985e-02]
mat_Sqrt:  [[ 1.98535399e+01  0.00000000e+00]
 [-8.20240926e-03  1.87940807e-02]]
grads:  [ 0.07189251 53.24205936]
Stock Position:  0.07189251074035737
Bond Position:  [-4.43120651]


portfolio before change:  [2.51632838]
curr_Stock_Price:  96.64551638101017
curr_Factors:  [9.66455164e+01 4.12080267e-02]
mat_Sqrt:  [[ 1.96188081e+01  0.00000000e+00]
 [-8.11990411e-03  1.86050376e-02]]
grads:  [1.22719312e-02 2.42090871e+01]
Stock Position:  0.0122719311561313
Bond Position:  [1.33030126]


portfolio before change:  [2.52317253]
curr_Stock_Price:  97.18967280355709
curr_Factors:  [9.71896728e+01 4.06061223e-02]
mat_Sqrt:  [[ 1.95846529e+01  0.00000000e+00]
 [-8.06038434e-03  1.84686607e-02]]
grads:  [0.01258303 6.12261687]
Stock Position:  0.012583025492443252
Bond Position:  [1.3002324]


portfolio before change:  [2.51283072]
curr_Stock_Price:  96.35486940274346
curr_Factors:  [9.63548694e+01 4.18737337e-02]
mat_Sqrt:  [[ 1.97171668e+01  0.00000000e+00]
 [-8.18522901e-03  1.87547158e-02]]
grads:  [-7.85104706e-04  9.98109671e-01]
Stock Position:  -0.0007851047056831755
Bond Position:  [2.58847938]


portfolio before change:  [2.51406676]
curr_Stock_Price:  95.19264871782221
curr_Factors:  [9.51926487e+01 4.24648148e-02]
mat_Sqrt:  [[ 1.96163422e+01  0.00000000e+00]
 [-8.24279708e-03  1.88866208e-02]]
grads:  [ 9.28980475e-04 -4.96309598e+00]
Stock Position:  0.0009289804749332508
Bond Position:  [2.42563465]


portfolio before change:  [2.51484884]
curr_Stock_Price:  95.70810622684266
curr_Factors:  [9.57081062e+01 4.25231174e-02]
mat_Sqrt:  [[ 1.97360970e+01  0.00000000e+00]
 [-8.24845366e-03  1.88995816e-02]]
grads:  [-0.00503005  1.01224815]
Stock Position:  -0.005030046275333865
Bond Position:  [2.99626504]


portfolio before change:  [2.50707071]
curr_Stock_Price:  97.32890340879368
curr_Factors:  [9.73289034e+01 4.19623591e-02]
mat_Sqrt:  [[ 1.99375495e+01  0.00000000e+00]
 [-8.19388641e-03  1.87745524e-02]]
grads:  [-1.62959657e-03  8.95199544e+00]
Stock Position:  -0.0016295965705614552
Bond Position:  [2.66567756]


portfolio before change:  [2.50639351]
curr_Stock_Price:  97.94895165983746
curr_Factors:  [9.79489517e+01 4.34735964e-02]
mat_Sqrt:  [[ 2.04226727e+01  0.00000000e+00]
 [-8.34012915e-03  1.91096366e-02]]
grads:  [ 0.03092712 16.7877483 ]
Stock Position:  0.030927122721814387
Bond Position:  [-0.52288574]


portfolio before change:  [2.49481485]
curr_Stock_Price:  97.57668003600831
curr_Factors:  [9.75766800e+01 4.46808737e-02]
mat_Sqrt:  [[ 2.06256131e+01  0.00000000e+00]
 [-8.45514033e-03  1.93731603e-02]]
grads:  [0.00833113 4.90739692]
Stock Position:  0.008331125501740907
Bond Position:  [1.68189129]


portfolio before change:  [2.47972869]
curr_Stock_Price:  95.74062406525137
curr_Factors:  [9.57406241e+01 4.66153637e-02]
mat_Sqrt:  [[ 2.06709669e+01  0.00000000e+00]
 [-8.63623656e-03  1.97881039e-02]]
grads:  [3.90672925e-03 4.67494283e+00]
Stock Position:  0.003906729250610552
Bond Position:  [2.105696]


portfolio before change:  [2.48626622]
curr_Stock_Price:  97.34664672467385
curr_Factors:  [9.73466467e+01 4.65401457e-02]
mat_Sqrt:  [[ 2.10007529e+01  0.00000000e+00]
 [-8.62926609e-03  1.97721325e-02]]
grads:  [0.00513239 4.11308522]
Stock Position:  0.005132388664270716
Bond Position:  [1.98664539]


portfolio before change:  [2.48494828]
curr_Stock_Price:  97.04147102481816
curr_Factors:  [9.7041471e+01 4.6531213e-02]
mat_Sqrt:  [[ 2.09329077e+01  0.00000000e+00]
 [-8.62843791e-03  1.97702349e-02]]
grads:  [-0.00298624 -1.58887922]
Stock Position:  -0.002986236535549381
Bond Position:  [2.77473707]


portfolio before change:  [2.48544118]
curr_Stock_Price:  96.99256763453783
curr_Factors:  [9.69925676e+01 4.44468394e-02]
mat_Sqrt:  [[ 2.04483796e+01  0.00000000e+00]
 [-8.43296763e-03  1.93223562e-02]]
grads:  [-0.01390018  6.28888275]
Stock Position:  -0.013900177282621249
Bond Position:  [3.83365507]


portfolio before change:  [2.50483058]
curr_Stock_Price:  95.63214208692993
curr_Factors:  [9.56321421e+01 4.55375331e-02]
mat_Sqrt:  [[ 2.04074450e+01  0.00000000e+00]
 [-8.53581004e-03  1.95579978e-02]]
grads:  [0.00671334 3.57240339]
Stock Position:  0.006713343665053471
Bond Position:  [1.86281914]


portfolio before change:  [2.5132303]
curr_Stock_Price:  96.8486530322886
curr_Factors:  [9.68486530e+01 4.42524099e-02]
mat_Sqrt:  [[ 2.03733313e+01  0.00000000e+00]
 [-8.41450271e-03  1.92800478e-02]]
grads:  [0.0652764  6.77006816]
Stock Position:  0.0652763970499207
Bond Position:  [-3.80870083]


portfolio before change:  [2.55561812]
curr_Stock_Price:  97.50530594272354
curr_Factors:  [9.75053059e+01 4.32161774e-02]
mat_Sqrt:  [[ 2.02698915e+01  0.00000000e+00]
 [-8.31540040e-03  1.90529759e-02]]
grads:  [6.57934441e-03 1.38882718e+01]
Stock Position:  0.006579344406783645
Bond Position:  [1.91409713]


portfolio before change:  [2.54610129]
curr_Stock_Price:  96.02246689877451
curr_Factors:  [9.60224669e+01 4.58125003e-02]
mat_Sqrt:  [[ 2.05525094e+01  0.00000000e+00]
 [-8.56154194e-03  1.96169570e-02]]
grads:  [-3.97337953e-03  6.43672793e+00]
Stock Position:  -0.003973379531823011
Bond Position:  [2.92763499]


portfolio before change:  [2.53943424]
curr_Stock_Price:  97.79250316509042
curr_Factors:  [9.77925032e+01 4.51242824e-02]
mat_Sqrt:  [[ 2.07735499e+01  0.00000000e+00]
 [-8.49699075e-03  1.94690516e-02]]
grads:  [-5.56266231e-03  8.52475722e+00]
Stock Position:  -0.005562662311759045
Bond Position:  [3.08342091]


portfolio before change:  [2.54020728]
curr_Stock_Price:  97.72282659666034
curr_Factors:  [9.77228266e+01 4.54543422e-02]
mat_Sqrt:  [[ 2.08345301e+01  0.00000000e+00]
 [-8.52800959e-03  1.95401247e-02]]
grads:  [ 3.86105790e-03 -5.35486626e+00]
Stock Position:  0.0038610579040222926
Bond Position:  [2.16289378]


portfolio before change:  [2.54265431]
curr_Stock_Price:  98.28657302254858
curr_Factors:  [9.82865730e+01 4.67005177e-02]
mat_Sqrt:  [[ 2.12400258e+01  0.00000000e+00]
 [-8.64412103e-03  1.98061695e-02]]
grads:  [-1.40603353e-02 -1.98074588e+01]
Stock Position:  -0.014060335262597845
Bond Position:  [3.92459648]


portfolio before change:  [2.57386045]
curr_Stock_Price:  96.1020214058816
curr_Factors:  [9.61020214e+01 4.67552309e-02]
mat_Sqrt:  [[ 2.07800996e+01  0.00000000e+00]
 [-8.64918316e-03  1.98177683e-02]]
grads:  [0.00448197 2.83109734]
Stock Position:  0.004481966155195659
Bond Position:  [2.14313444]


portfolio before change:  [2.57704233]
curr_Stock_Price:  96.75217803473222
curr_Factors:  [9.67521780e+01 4.83307732e-02]
mat_Sqrt:  [[ 2.12702513e+01  0.00000000e+00]
 [-8.79370440e-03  2.01489080e-02]]
grads:  [ 0.01307811 -4.972131  ]
Stock Position:  0.01307811084444691
Bond Position:  [1.31170663]


portfolio before change:  [2.58952257]
curr_Stock_Price:  97.69392412905762
curr_Factors:  [9.76939241e+01 5.00230411e-02]
mat_Sqrt:  [[ 2.18500583e+01  0.00000000e+00]
 [-8.94633253e-03  2.04986230e-02]]
grads:  [-0.02774049 -7.65510729]
Stock Position:  -0.02774049466759414
Bond Position:  [5.29960035]


portfolio before change:  [2.58638017]
curr_Stock_Price:  97.83108420808253
curr_Factors:  [9.78310842e+01 4.85882460e-02]
mat_Sqrt:  [[ 2.15646532e+01  0.00000000e+00]
 [-8.81709667e-03  2.02025064e-02]]
grads:  [-0.0088035  -2.88635612]
Stock Position:  -0.008803495440065031
Bond Position:  [3.44763567]


portfolio before change:  [2.5971454]
curr_Stock_Price:  96.65720456242228
curr_Factors:  [9.66572046e+01 5.00165345e-02]
mat_Sqrt:  [[ 2.16167813e+01  0.00000000e+00]
 [-8.94575068e-03  2.04972898e-02]]
grads:  [-0.00140672  1.13757133]
Stock Position:  -0.001406722894713515
Bond Position:  [2.7331153]


portfolio before change:  [2.59465038]
curr_Stock_Price:  98.67372065559914
curr_Factors:  [9.86737207e+01 4.90626765e-02]
mat_Sqrt:  [[ 2.18563241e+01  0.00000000e+00]
 [-8.86003851e-03  2.03008986e-02]]
grads:  [8.64627405e-04 8.22174590e+00]
Stock Position:  0.0008646274049731526
Bond Position:  [2.50933437]


portfolio before change:  [2.59466608]
curr_Stock_Price:  98.32907776045619
curr_Factors:  [9.83290778e+01 5.03388859e-02]
mat_Sqrt:  [[ 2.20614354e+01  0.00000000e+00]
 [-8.97453160e-03  2.05632352e-02]]
grads:  [5.23625648e-04 6.60236183e-01]
Stock Position:  0.0005236256477349618
Bond Position:  [2.54317845]


portfolio before change:  [2.59545818]
curr_Stock_Price:  99.23466441737983
curr_Factors:  [9.92346644e+01 4.86018982e-02]
mat_Sqrt:  [[ 2.18771136e+01  0.00000000e+00]
 [-8.81833528e-03  2.02053445e-02]]
grads:  [8.97650892e-04 2.99639301e+00]
Stock Position:  0.0008976508921576597
Bond Position:  [2.5063801]


portfolio before change:  [2.59619617]
curr_Stock_Price:  99.70775730618337
curr_Factors:  [9.97077573e+01 4.83145965e-02]
mat_Sqrt:  [[ 2.19163449e+01  0.00000000e+00]
 [-8.79223262e-03  2.01455358e-02]]
grads:  [-0.00594277  5.07210521]
Stock Position:  -0.005942774069918144
Bond Position:  [3.18873685]


portfolio before change:  [2.5850443]
curr_Stock_Price:  101.6513765162721
curr_Factors:  [1.01651377e+02 4.69736385e-02]
mat_Sqrt:  [[ 2.20313122e+01  0.00000000e+00]
 [-8.66936108e-03  1.98640017e-02]]
grads:  [-5.79774784e-03 -1.24430774e+01]
Stock Position:  -0.00579774784114065
Bond Position:  [3.17439335]


portfolio before change:  [2.59016209]
curr_Stock_Price:  100.83710048836322
curr_Factors:  [1.0083710e+02 4.7577141e-02]
mat_Sqrt:  [[ 2.19947748e+01  0.00000000e+00]
 [-8.72487396e-03  1.99911977e-02]]
grads:  [ 5.40340316e-04 -1.21470844e+00]
Stock Position:  0.0005403403160497762
Bond Position:  [2.53567574]


portfolio before change:  [2.59041324]
curr_Stock_Price:  100.71526580578605
curr_Factors:  [1.00715266e+02 4.86141762e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.59041324]
Stock Price:  99.59763044947913
PL:  [2.59041324]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 9.70328889e-01  2.48273136e-01]
 [-2.21744456e-01 -5.30655463e-02]
 [-5.90221546e-02 -7.26443654e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.23583996e-01 -6.50077643e-01]
 [-3.17864541e-01  1.71359454e-01]
 [ 4.31609934e-01 -5.19396275e-01]
 [-6.42554064e-01  1.17671705e-01]
 [-1.01690865e-01 -1.31363498e-01]
 [-2.08230316e-01 -4.85080045e-01]
 [-6.65856636e-02 -1.24432397e-02]
 [-1.24195783e-01 -1.77133962e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.41579401e-02 -4.57294901e-02]
 [ 4.37251358e-01  2.77215996e-01]
 [ 1.31359563e-01 -1.88533733e-01]
 [ 3.96056641e-02  9.92098793e-02]
 [ 3.49067211e-03 -6.81472002e-02]
 [-9.75519781e-02 -3.64302891e-01]
 [-6.66631000e-02 -4.50290932e-02]
 [ 1.53742898e-01 -7.22808631e-03]
 [ 1.23284046e+00  1.23371702e-01]
 [ 1.79039280e-02  2.62729391e-01]
 [-7.12272793e-02  6.56017135e-02]
 [ 8.96807691e-02 -2.56323322e-02]
 [ 1.71874699e-01 -8.86872496e-02]
 [-9.14246137e-04 -3.16247246e-01]
 [ 5.04908305e-02  1.70933940e-01]
 [ 1.07736321e-01  8.30070931e-02]
 [-5.34009464e-01 -1.12617758e-01]
 [-1.66071732e-01 -6.10900004e-02]
 [ 8.31678529e-03 -7.19121858e-02]
 [-1.11012951e-01  1.57791408e-01]
 [ 3.66412058e-02  3.73986862e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.63187798e-01  5.46806573e-02]
 [-2.48617066e-02 -2.01100434e-01]
 [-1.49776652e-03 -5.37612956e-02]
 [-5.37878279e-02 -6.01780751e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.98508061]
curr_Stock_Price:  102.94715941088161
curr_Factors:  [1.02947159e+02 3.94666677e-02]
mat_Sqrt:  [[ 2.04517086e+01  0.00000000e+00]
 [-7.94648779e-03  1.82076909e-02]]
grads:  [ 0.05274299 13.635619  ]
Stock Position:  0.05274298533306472
Bond Position:  [17.55534009]


portfolio before change:  [22.99296762]
curr_Stock_Price:  103.05508747839086
curr_Factors:  [1.03055087e+02 3.90931345e-02]
mat_Sqrt:  [[ 2.03760352e+01  0.00000000e+00]
 [-7.90879353e-03  1.81213225e-02]]
grads:  [-0.01201923 -2.92834843]
Stock Position:  -0.012019225341211144
Bond Position:  [24.23160994]


portfolio before change:  [23.0183414]
curr_Stock_Price:  101.19601252566565
curr_Factors:  [1.01196013e+02 3.89315013e-02]
mat_Sqrt:  [[ 1.99670532e+01  0.00000000e+00]
 [-7.89242688e-03  1.80838218e-02]]
grads:  [-0.00454382 -4.01709142]
Stock Position:  -0.004543822957702273
Bond Position:  [23.47815816]


portfolio before change:  [23.01599202]
curr_Stock_Price:  102.35898170482709
curr_Factors:  [1.02358982e+02 3.85372812e-02]
mat_Sqrt:  [[ 2.00940044e+01  0.00000000e+00]
 [-7.85236588e-03  1.79920305e-02]]
grads:  [-8.11255270e-04 -8.41410381e+00]
Stock Position:  -0.0008112552702840223
Bond Position:  [23.09903129]


portfolio before change:  [23.01807422]
curr_Stock_Price:  103.35171708055654
curr_Factors:  [1.03351717e+02 3.93142529e-02]
mat_Sqrt:  [[ 2.04923946e+01  0.00000000e+00]
 [-7.93112884e-03  1.81724991e-02]]
grads:  [-1.98757221e-02 -3.57726055e+01]
Stock Position:  -0.019875722071023203
Bond Position:  [25.07226423]


portfolio before change:  [22.99757484]
curr_Stock_Price:  104.54078656983569
curr_Factors:  [1.04540787e+02 3.82998120e-02]
mat_Sqrt:  [[ 2.04589850e+01  0.00000000e+00]
 [-7.82813510e-03  1.79365108e-02]]
grads:  [-0.01188119  9.55366711]
Stock Position:  -0.011881192714250394
Bond Position:  [24.23964407]


portfolio before change:  [22.9950678]
curr_Stock_Price:  105.00683274814791
curr_Factors:  [1.05006833e+02 4.01157317e-02]
mat_Sqrt:  [[ 2.10317262e+01  0.00000000e+00]
 [-8.01156482e-03  1.83568011e-02]]
grads:  [ 9.74369929e-03 -2.82944873e+01]
Stock Position:  0.0097436992932277
Bond Position:  [21.97191279]


portfolio before change:  [22.98481731]
curr_Stock_Price:  103.67293001603653
curr_Factors:  [1.03672930e+02 4.10029016e-02]
mat_Sqrt:  [[ 2.09929112e+01  0.00000000e+00]
 [-8.09966929e-03  1.85586738e-02]]
grads:  [-0.02816179  6.34052338]
Stock Position:  -0.028161788329266003
Bond Position:  [25.90443242]


portfolio before change:  [22.94366126]
curr_Stock_Price:  105.24933219610557
curr_Factors:  [1.05249332e+02 4.01534899e-02]
mat_Sqrt:  [[ 2.10902145e+01  0.00000000e+00]
 [-8.01533430e-03  1.83654381e-02]]
grads:  [-0.00754011 -7.15275603]
Stock Position:  -0.007540112758198898
Bond Position:  [23.73725309]


portfolio before change:  [22.96585384]
curr_Stock_Price:  102.69960406369582
curr_Factors:  [1.02699604e+02 4.09748055e-02]
mat_Sqrt:  [[ 2.07886946e+01  0.00000000e+00]
 [-8.09689378e-03  1.85523143e-02]]
grads:  [-2.02002392e-02 -2.61466056e+01]
Stock Position:  -0.02020023921309031
Bond Position:  [25.04041041]


portfolio before change:  [22.94242928]
curr_Stock_Price:  104.01418279700363
curr_Factors:  [1.04014183e+02 4.05334385e-02]
mat_Sqrt:  [[ 2.09410901e+01  0.00000000e+00]
 [-8.05316718e-03  1.84521241e-02]]
grads:  [-0.003439  -0.6743527]
Stock Position:  -0.0034389966496028456
Bond Position:  [23.30013371]


portfolio before change:  [22.94677537]
curr_Stock_Price:  103.59737891715933
curr_Factors:  [1.03597379e+02 4.06871045e-02]
mat_Sqrt:  [[ 2.08966736e+01  0.00000000e+00]
 [-8.06841789e-03  1.84870679e-02]]
grads:  [-0.00964284 -9.58150657]
Stock Position:  -0.009642844868760388
Bond Position:  [23.94574882]


portfolio before change:  [22.95532041]
curr_Stock_Price:  103.02165335242339
curr_Factors:  [1.03021653e+02 4.05939386e-02]
mat_Sqrt:  [[ 2.07567384e+01  0.00000000e+00]
 [-8.05917501e-03  1.84658898e-02]]
grads:  [-0.00315606 -0.96881348]
Stock Position:  -0.0031560604537418033
Bond Position:  [23.28046297]


portfolio before change:  [22.96233105]
curr_Stock_Price:  101.7224387715932
curr_Factors:  [1.01722439e+02 3.97434645e-02]
mat_Sqrt:  [[ 2.02791443e+01  0.00000000e+00]
 [-7.97430518e-03  1.82714286e-02]]
grads:  [-0.00266855 -2.50278679]
Stock Position:  -0.002668550756271083
Bond Position:  [23.23378254]


portfolio before change:  [22.96949142]
curr_Stock_Price:  100.12757823432888
curr_Factors:  [1.00127578e+02 4.10850732e-02]
mat_Sqrt:  [[ 2.02953126e+01  0.00000000e+00]
 [-8.10778127e-03  1.85772607e-02]]
grads:  [ 0.02750578 14.922329  ]
Stock Position:  0.02750577677493264
Bond Position:  [20.2154046]


portfolio before change:  [22.96013472]
curr_Stock_Price:  99.69553130808485
curr_Factors:  [9.96955313e+01 3.93454075e-02]
mat_Sqrt:  [[ 1.97752834e+01  0.00000000e+00]
 [-7.93427073e-03  1.81796981e-02]]
grads:  [ 2.48171896e-03 -1.03705646e+01]
Stock Position:  0.0024817189610027747
Bond Position:  [22.71271843]


portfolio before change:  [22.9624853]
curr_Stock_Price:  99.49861894384426
curr_Factors:  [9.94986189e+01 3.77267967e-02]
mat_Sqrt:  [[ 1.93260019e+01  0.00000000e+00]
 [-7.76935485e-03  1.78018283e-02]]
grads:  [4.28978562e-03 5.57301629e+00]
Stock Position:  0.004289785622729806
Bond Position:  [22.53565756]


portfolio before change:  [22.96684708]
curr_Stock_Price:  99.8586943605299
curr_Factors:  [9.98586944e+01 3.69884246e-02]
mat_Sqrt:  [[ 1.92051985e+01  0.00000000e+00]
 [-7.69294998e-03  1.76267628e-02]]
grads:  [-1.36688014e-03 -3.86612113e+00]
Stock Position:  -0.0013668801372838783
Bond Position:  [23.10334195]


portfolio before change:  [22.96981112]
curr_Stock_Price:  99.80314019247574
curr_Factors:  [9.98031402e+01 3.64182116e-02]
mat_Sqrt:  [[ 1.90459883e+01  0.00000000e+00]
 [-7.63342246e-03  1.74903681e-02]]
grads:  [-1.34698599e-02 -2.08287721e+01]
Stock Position:  -0.01346985992555846
Bond Position:  [24.31414543]


portfolio before change:  [22.97052518]
curr_Stock_Price:  99.97577731434204
curr_Factors:  [9.99757773e+01 3.52648822e-02]
mat_Sqrt:  [[ 1.87743975e+01  0.00000000e+00]
 [-7.51157849e-03  1.72111885e-02]]
grads:  [-0.00459751 -2.61626867]
Stock Position:  -0.004597506131093689
Bond Position:  [23.43016442]


portfolio before change:  [22.98347952]
curr_Stock_Price:  97.79516145493434
curr_Factors:  [9.77951615e+01 3.56622535e-02]
mat_Sqrt:  [[ 1.84680805e+01  0.00000000e+00]
 [-7.55378089e-03  1.73078863e-02]]
grads:  [ 0.00815398 -0.41761808]
Stock Position:  0.008153976930478694
Bond Position:  [22.18606003]


portfolio before change:  [22.98089269]
curr_Stock_Price:  97.1377816298238
curr_Factors:  [9.71377816e+01 3.51706288e-02]
mat_Sqrt:  [[ 1.82170583e+01  0.00000000e+00]
 [-7.50153358e-03  1.71881727e-02]]
grads:  [0.07063074 7.17770898]
Stock Position:  0.07063073872960338
Bond Position:  [16.11997942]


portfolio before change:  [23.00928945]
curr_Stock_Price:  97.51129646982727
curr_Factors:  [9.75112965e+01 3.44651800e-02]
mat_Sqrt:  [[ 1.81027772e+01  0.00000000e+00]
 [-7.42592001e-03  1.70149203e-02]]
grads:  [7.32309929e-03 1.54411179e+01]
Stock Position:  0.0073230992864240455
Bond Position:  [22.29520454]


portfolio before change:  [23.02038864]
curr_Stock_Price:  98.6463506521869
curr_Factors:  [9.86463507e+01 3.43006284e-02]
mat_Sqrt:  [[ 1.82697272e+01  0.00000000e+00]
 [-7.40817153e-03  1.69742534e-02]]
grads:  [-2.33152602e-03  3.86477755e+00]
Stock Position:  -0.0023315260190719576
Bond Position:  [23.25038517]


portfolio before change:  [23.02091419]
curr_Stock_Price:  99.66753822249741
curr_Factors:  [9.96675382e+01 3.50168620e-02]
mat_Sqrt:  [[ 1.86505801e+01  0.00000000e+00]
 [-7.48511718e-03  1.71505580e-02]]
grads:  [ 0.00420866 -1.494548  ]
Stock Position:  0.004208657417257327
Bond Position:  [22.60144767]


portfolio before change:  [23.02749991]
curr_Stock_Price:  100.56102017897882
curr_Factors:  [1.00561020e+02 3.42246671e-02]
mat_Sqrt:  [[ 1.86036983e+01  0.00000000e+00]
 [-7.39996401e-03  1.69554476e-02]]
grads:  [ 0.00715817 -5.23060503]
Stock Position:  0.007158168649903039
Bond Position:  [22.30766717]


portfolio before change:  [23.01955258]
curr_Stock_Price:  99.06120093919921
curr_Factors:  [9.90612009e+01 3.45768036e-02]
mat_Sqrt:  [[ 1.84202708e+01  0.00000000e+00]
 [-7.43793558e-03  1.70424514e-02]]
grads:  [-7.54255251e-03 -1.85564411e+01]
Stock Position:  -0.007542552514757798
Bond Position:  [23.76672689]


portfolio before change:  [23.0163456]
curr_Stock_Price:  99.880288149457
curr_Factors:  [9.98802881e+01 3.46497489e-02]
mat_Sqrt:  [[ 1.85921593e+01  0.00000000e+00]
 [-7.44577720e-03  1.70604188e-02]]
grads:  [6.72824043e-03 1.00193285e+01]
Stock Position:  0.006728240430217599
Bond Position:  [22.34432701]


portfolio before change:  [23.01338685]
curr_Stock_Price:  99.02538910519138
curr_Factors:  [9.90253891e+01 3.41574846e-02]
mat_Sqrt:  [[ 1.83016185e+01  0.00000000e+00]
 [-7.39269744e-03  1.69387978e-02]]
grads:  [0.00786617 4.9004123 ]
Stock Position:  0.007866166961527643
Bond Position:  [22.2344366]


portfolio before change:  [23.0179485]
curr_Stock_Price:  99.25195136556732
curr_Factors:  [9.92519514e+01 3.40360349e-02]
mat_Sqrt:  [[ 1.83108512e+01  0.00000000e+00]
 [-7.37954306e-03  1.69086573e-02]]
grads:  [-0.03184778 -6.66036075]
Stock Position:  -0.031847775708599466
Bond Position:  [26.17890239]


portfolio before change:  [23.01372346]
curr_Stock_Price:  99.48737175229446
curr_Factors:  [9.94873718e+01 3.47279685e-02]
mat_Sqrt:  [[ 1.85399111e+01  0.00000000e+00]
 [-7.45417666e-03  1.70796644e-02]]
grads:  [-0.01039561 -3.5767682 ]
Stock Position:  -0.010395605057156776
Bond Position:  [24.04795488]


portfolio before change:  [23.00836391]
curr_Stock_Price:  100.29210842117959
curr_Factors:  [1.00292108e+02 3.53610589e-02]
mat_Sqrt:  [[ 1.88594660e+01  0.00000000e+00]
 [-7.52181455e-03  1.72346423e-02]]
grads:  [-1.22316643e-03 -4.17253719e+00]
Stock Position:  -0.0012231664263615712
Bond Position:  [23.13103785]


portfolio before change:  [23.01249118]
curr_Stock_Price:  99.28185501423741
curr_Factors:  [9.9281855e+01 3.5406919e-02]
mat_Sqrt:  [[ 1.86815950e+01  0.00000000e+00]
 [-7.52669053e-03  1.72458145e-02]]
grads:  [-2.25607797e-03  9.14954799e+00]
Stock Position:  -0.002256077969447701
Bond Position:  [23.23647879]


portfolio before change:  [23.01379195]
curr_Stock_Price:  99.9928105503349
curr_Factors:  [9.99928106e+01 3.34282172e-02]
mat_Sqrt:  [[ 1.82820706e+01  0.00000000e+00]
 [-7.31335405e-03  1.67569993e-02]]
grads:  [0.00289701 2.23182478]
Stock Position:  0.0028970094070559635
Bond Position:  [22.72411184]


portfolio before change:  [23.02133798]
curr_Stock_Price:  101.61701635298529
curr_Factors:  [1.01617016e+02 3.24068863e-02]
mat_Sqrt:  [[ 1.82930066e+01  0.00000000e+00]
 [-7.20076510e-03  1.64990256e-02]]
grads:  [-0.00517507  4.92908783]
Stock Position:  -0.005175071145407677
Bond Position:  [23.54721327]


portfolio before change:  [23.02163179]
curr_Stock_Price:  102.12904407658925
curr_Factors:  [1.02129044e+02 3.11773153e-02]
mat_Sqrt:  [[ 1.80330266e+01  0.00000000e+00]
 [-7.06283969e-03  1.61829987e-02]]
grads:  [-0.01327138  3.37889523]
Stock Position:  -0.013271382974773472
Bond Position:  [24.37702545]


portfolio before change:  [23.02145995]
curr_Stock_Price:  102.37160788652024
curr_Factors:  [1.02371608e+02 2.87094337e-02]
mat_Sqrt:  [[ 1.73457003e+01  0.00000000e+00]
 [-6.77754336e-03  1.55293027e-02]]
grads:  [-6.49320175e-03 -1.29497401e+01]
Stock Position:  -0.0064932017477520535
Bond Position:  [23.68617945]


portfolio before change:  [23.02488644]
curr_Stock_Price:  102.29991236682726
curr_Factors:  [1.02299912e+02 2.96200773e-02]
mat_Sqrt:  [[ 1.76063104e+01  0.00000000e+00]
 [-6.88419375e-03  1.57736695e-02]]
grads:  [-1.41773710e-03 -3.40829353e+00]
Stock Position:  -0.0014177371004874134
Bond Position:  [23.16992082]


portfolio before change:  [23.02865448]
curr_Stock_Price:  101.68511501149689
curr_Factors:  [1.01685115e+02 2.89714748e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.02865448]
Stock Price:  101.12503108650205
PL:  [21.9036234]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 9.99801985e-01  2.54936413e-01]
 [-2.40824771e-01 -6.84566719e-02]
 [-4.14353332e-01 -1.59648084e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.07889148e-01 -2.04765519e-01]
 [-2.28665819e-01  4.46394118e-02]
 [ 1.49412418e-01 -1.28065369e-01]
 [ 1.18698403e-01  4.22990575e-01]
 [-1.01839885e-01 -2.46156891e-02]
 [ 1.80160406e-01  4.44382665e-02]
 [-9.61802273e-02 -6.01530503e-03]
 [ 5.06212444e-03 -1.36076706e-01]
 [-6.20629291e-02 -1.84178420e-02]
 [-1.53448684e-02 -9.79034981e-02]
 [ 1.10791680e-01  6.53016904e-02]
 [ 1.34832033e-01 -3.71610786e-01]
 [ 3.88735916e-02  3.01051779e-02]
 [ 2.55681446e-02 -1.43785197e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-6.71095863e-02 -4.47677022e-02]
 [ 1.79981324e-01 -4.60325773e-02]
 [ 1.02309206e+00  8.47438951e-02]
 [ 2.04575214e-02  9.83159610e-02]
 [-1.31439408e-01  1.05292261e-01]
 [-1.93281207e-01  2.03244663e-01]
 [ 1.67715916e-01 -8.97267227e-02]
 [-1.65944834e-01 -4.46535581e-01]
 [ 6.39331161e-02  6.61449582e-02]
 [ 4.84076460e-01 -2.89389332e-01]
 [-6.18455277e-01 -3.17557650e-01]
 [ 3.15208136e-01  1.19484410e-01]
 [-1.60633078e-01  2.28895330e-01]
 [ 3.40617755e-01  2.16281158e-01]
 [ 3.40378347e-02 -1.86866762e-02]
 [ 1.93943744e-01 -1.27729760e-01]
 [ 3.59877706e-02  1.15366682e-01]
 [-5.43395728e-02  1.47098315e-01]
 [-2.76257368e-01 -1.06142000e-01]
 [ 8.14203101e-02  3.52629197e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.23400263]
curr_Stock_Price:  101.96720692146495
curr_Factors:  [1.01967207e+02 3.98821807e-02]
mat_Sqrt:  [[ 2.03633850e+01  0.00000000e+00]
 [-7.98820938e-03  1.83032871e-02]]
grads:  [ 0.05456192 13.92844967]
Stock Position:  0.054561918847171174
Bond Position:  [10.67047616]


portfolio before change:  [16.28289341]
curr_Stock_Price:  102.83882000108336
curr_Factors:  [1.02838820e+02 4.03326581e-02]
mat_Sqrt:  [[ 2.06531123e+01  0.00000000e+00]
 [-8.03319694e-03  1.84063665e-02]]
grads:  [-0.01310707 -3.71918444]
Stock Position:  -0.013107066261207027
Bond Position:  [17.63080863]


portfolio before change:  [16.2902256]
curr_Stock_Price:  102.44756465095394
curr_Factors:  [1.02447565e+02 4.16319722e-02]
mat_Sqrt:  [[ 2.09033134e+01  0.00000000e+00]
 [-8.16156575e-03  1.87004964e-02]]
grads:  [-0.02315563 -8.53710406]
Stock Position:  -0.023155633714969117
Bond Position:  [18.66246389]


portfolio before change:  [16.32807024]
curr_Stock_Price:  100.91395574087959
curr_Factors:  [1.00913956e+02 4.27694879e-02]
mat_Sqrt:  [[ 2.08697985e+01  0.00000000e+00]
 [-8.27231411e-03  1.89542528e-02]]
grads:  [-7.81098436e-04 -7.98695755e+00]
Stock Position:  -0.000781098435996117
Bond Position:  [16.40689398]


portfolio before change:  [16.3297641]
curr_Stock_Price:  101.37117344543164
curr_Factors:  [1.01371173e+02 4.18462327e-02]
mat_Sqrt:  [[ 2.07368438e+01  0.00000000e+00]
 [-8.18254070e-03  1.87485561e-02]]
grads:  [-9.51235149e-03 -1.09216688e+01]
Stock Position:  -0.009512351493276448
Bond Position:  [17.29404233]


portfolio before change:  [16.33932331]
curr_Stock_Price:  100.59351954739036
curr_Factors:  [1.0059352e+02 4.3991528e-02]
mat_Sqrt:  [[ 2.10986431e+01  0.00000000e+00]
 [-8.38966297e-03  1.92231328e-02]]
grads:  [-0.00991455  2.32217153]
Stock Position:  -0.009914551437428759
Bond Position:  [17.33666293]


portfolio before change:  [16.33487589]
curr_Stock_Price:  101.26068449325116
curr_Factors:  [1.01260684e+02 4.57457360e-02]
mat_Sqrt:  [[ 2.16578912e+01  0.00000000e+00]
 [-8.55530114e-03  1.96026575e-02]]
grads:  [ 4.31806162e-03 -6.53306161e+00]
Stock Position:  0.004318061624095239
Bond Position:  [15.89762601]


portfolio before change:  [16.33512332]
curr_Stock_Price:  100.85775034635333
curr_Factors:  [1.0085775e+02 4.6016680e-02]
mat_Sqrt:  [[ 2.16354991e+01  0.00000000e+00]
 [-8.58059951e-03  1.96606234e-02]]
grads:  [1.40189336e-02 2.15146065e+01]
Stock Position:  0.014018933610949752
Bond Position:  [14.92120521]


portfolio before change:  [16.3344412]
curr_Stock_Price:  100.6760402042882
curr_Factors:  [1.00676040e+02 4.59280645e-02]
mat_Sqrt:  [[ 2.15757150e+01  0.00000000e+00]
 [-8.57233360e-03  1.96416838e-02]]
grads:  [-0.00521805 -1.25323722]
Stock Position:  -0.005218045018278992
Bond Position:  [16.85977331]


portfolio before change:  [16.33853261]
curr_Stock_Price:  100.29585969951906
curr_Factors:  [1.00295860e+02 4.67048655e-02]
mat_Sqrt:  [[ 2.16752476e+01  0.00000000e+00]
 [-8.64452340e-03  1.98070914e-02]]
grads:  [0.00920658 2.24355336]
Stock Position:  0.009206577867270844
Bond Position:  [15.41515096]


portfolio before change:  [16.34052918]
curr_Stock_Price:  100.30341485037482
curr_Factors:  [1.00303415e+02 4.39554920e-02]
mat_Sqrt:  [[ 2.10291777e+01  0.00000000e+00]
 [-8.38622604e-03  1.92152578e-02]]
grads:  [-0.0046985  -0.31304836]
Stock Position:  -0.004698496669402993
Bond Position:  [16.81180444]


portfolio before change:  [16.34022815]
curr_Stock_Price:  100.81477731542905
curr_Factors:  [1.00814777e+02 4.30293170e-02]
mat_Sqrt:  [[ 2.09125225e+01  0.00000000e+00]
 [-8.29740365e-03  1.90117401e-02]]
grads:  [-2.59780326e-03 -7.15750928e+00]
Stock Position:  -0.0025978032589521164
Bond Position:  [16.60212511]


portfolio before change:  [16.34073246]
curr_Stock_Price:  101.41955316391731
curr_Factors:  [1.01419553e+02 4.37569581e-02]
mat_Sqrt:  [[ 2.12151084e+01  0.00000000e+00]
 [-8.36726556e-03  1.91718139e-02]]
grads:  [-0.0033043 -0.9606729]
Stock Position:  -0.003304302442515079
Bond Position:  [16.67585333]


portfolio before change:  [16.34005685]
curr_Stock_Price:  102.25489320224081
curr_Factors:  [1.02254893e+02 4.41796475e-02]
mat_Sqrt:  [[ 2.14929101e+01  0.00000000e+00]
 [-8.40758205e-03  1.92641906e-02]]
grads:  [-2.70198208e-03 -5.08214958e+00]
Stock Position:  -0.0027019820784851753
Bond Position:  [16.61634774]


portfolio before change:  [16.33938018]
curr_Stock_Price:  103.27408799051454
curr_Factors:  [1.03274088e+02 4.31455873e-02]
mat_Sqrt:  [[ 2.14515936e+01  0.00000000e+00]
 [-8.30860636e-03  1.90374088e-02]]
grads:  [0.0064933  3.43017746]
Stock Position:  0.006493301940998945
Bond Position:  [15.66879034]


portfolio before change:  [16.32681003]
curr_Stock_Price:  101.03657102913559
curr_Factors:  [1.01036571e+02 4.52569777e-02]
mat_Sqrt:  [[ 2.14942043e+01  0.00000000e+00]
 [-8.50947497e-03  1.94976566e-02]]
grads:  [-1.27253887e-03 -1.90592538e+01]
Stock Position:  -0.0012725388740445877
Bond Position:  [16.45538299]


portfolio before change:  [16.32952434]
curr_Stock_Price:  100.5200788234935
curr_Factors:  [1.00520079e+02 4.49066423e-02]
mat_Sqrt:  [[ 2.13013983e+01  0.00000000e+00]
 [-8.47647496e-03  1.94220441e-02]]
grads:  [0.00244174 1.55005198]
Stock Position:  0.002441744324780516
Bond Position:  [16.08408]


portfolio before change:  [16.33218911]
curr_Stock_Price:  100.7879783778241
curr_Factors:  [1.00787978e+02 4.38770791e-02]
mat_Sqrt:  [[ 2.11119131e+01  0.00000000e+00]
 [-8.37874254e-03  1.91981110e-02]]
grads:  [-1.76132120e-03 -7.48954921e+00]
Stock Position:  -0.0017613211962266419
Bond Position:  [16.50970912]


portfolio before change:  [16.33512234]
curr_Stock_Price:  100.29437891480586
curr_Factors:  [1.00294379e+02 4.43873366e-02]
mat_Sqrt:  [[ 2.11303230e+01  0.00000000e+00]
 [-8.42732096e-03  1.93094181e-02]]
grads:  [-1.50860516e-02 -2.43035622e+01]
Stock Position:  -0.01508605164698251
Bond Position:  [17.84816852]


portfolio before change:  [16.34217784]
curr_Stock_Price:  99.97459072445174
curr_Factors:  [9.99745907e+01 4.54370466e-02]
mat_Sqrt:  [[ 2.13105512e+01  0.00000000e+00]
 [-8.52638695e-03  1.95364068e-02]]
grads:  [-0.00406596 -2.29150133]
Stock Position:  -0.004065958347115959
Bond Position:  [16.74867037]


portfolio before change:  [16.34550473]
curr_Stock_Price:  99.67129994693717
curr_Factors:  [9.96712999e+01 4.65341915e-02]
mat_Sqrt:  [[ 2.15008787e+01  0.00000000e+00]
 [-8.62871407e-03  1.97708677e-02]]
grads:  [ 0.00743649 -2.32830334]
Stock Position:  0.007436489575224052
Bond Position:  [15.60430014]


portfolio before change:  [16.33980731]
curr_Stock_Price:  98.64284732486111
curr_Factors:  [9.86428473e+01 4.50791023e-02]
mat_Sqrt:  [[ 2.09436914e+01  0.00000000e+00]
 [-8.49273594e-03  1.94593026e-02]]
grads:  [0.05061559 4.3549297 ]
Stock Position:  0.050615591674093664
Bond Position:  [11.34694123]


portfolio before change:  [16.32065297]
curr_Stock_Price:  98.2363956630846
curr_Factors:  [9.82363957e+01 4.61583104e-02]
mat_Sqrt:  [[ 2.11055839e+01  0.00000000e+00]
 [-8.59379407e-03  1.96908559e-02]]
grads:  [3.00233933e-03 4.99297549e+00]
Stock Position:  0.0030023393307170767
Bond Position:  [16.02571398]


portfolio before change:  [16.31864424]
curr_Stock_Price:  96.90007995884945
curr_Factors:  [9.69000800e+01 4.66245861e-02]
mat_Sqrt:  [[ 2.09233698e+01  0.00000000e+00]
 [-8.63709081e-03  1.97900612e-02]]
grads:  [-4.08567544e-03  5.32046160e+00]
Stock Position:  -0.004085675435122366
Bond Position:  [16.71454652]


portfolio before change:  [16.32000806]
curr_Stock_Price:  97.07768363858922
curr_Factors:  [9.70776836e+01 4.62964488e-02]
mat_Sqrt:  [[ 2.08878262e+01  0.00000000e+00]
 [-8.60664383e-03  1.97202984e-02]]
grads:  [-5.00664658e-03  1.03063685e+01]
Stock Position:  -0.00500664658299691
Bond Position:  [16.80604171]


portfolio before change:  [16.32607876]
curr_Stock_Price:  96.28477373036155
curr_Factors:  [9.62847737e+01 4.60464558e-02]
mat_Sqrt:  [[ 2.06612084e+01  0.00000000e+00]
 [-8.58337517e-03  1.96669832e-02]]
grads:  [ 0.00622209 -4.5623023 ]
Stock Position:  0.006222093161629765
Bond Position:  [15.72698593]


portfolio before change:  [16.33136466]
curr_Stock_Price:  96.81834016525994
curr_Factors:  [9.68183402e+01 4.64770948e-02]
mat_Sqrt:  [[ 2.08726273e+01  0.00000000e+00]
 [-8.62341879e-03  1.97587347e-02]]
grads:  [-1.72871835e-02 -2.25994016e+01]
Stock Position:  -0.017287183489199883
Bond Position:  [18.00508107]


portfolio before change:  [16.33293543]
curr_Stock_Price:  96.8576760372482
curr_Factors:  [9.6857676e+01 4.6262484e-02]
mat_Sqrt:  [[ 2.08328419e+01  0.00000000e+00]
 [-8.60348618e-03  1.97130633e-02]]
grads:  [0.00445456 3.35538709]
Stock Position:  0.004454559914865106
Bond Position:  [15.90147711]


portfolio before change:  [16.32538823]
curr_Stock_Price:  94.7171708514664
curr_Factors:  [9.47171709e+01 4.88601891e-02]
mat_Sqrt:  [[ 2.09366064e+01  0.00000000e+00]
 [-8.84173640e-03  2.02589632e-02]]
grads:  [  0.01708857 -14.28450851]
Stock Position:  0.0170885669866007
Bond Position:  [14.70680751]


portfolio before change:  [16.28907227]
curr_Stock_Price:  92.48442499289104
curr_Factors:  [9.24844250e+01 5.01129663e-02]
mat_Sqrt:  [[ 2.07034945e+01  0.00000000e+00]
 [-8.95437022e-03  2.05170397e-02]]
grads:  [ -0.03656623 -15.47775191]
Stock Position:  -0.03656623265376554
Bond Position:  [19.67087927]


portfolio before change:  [16.27821984]
curr_Stock_Price:  92.84846140773702
curr_Factors:  [9.28484614e+01 4.94111568e-02]
mat_Sqrt:  [[ 2.06389321e+01  0.00000000e+00]
 [-8.89144819e-03  2.03728672e-02]]
grads:  [0.01779915 5.86487945]
Stock Position:  0.01779914802990346
Bond Position:  [14.62559633]


portfolio before change:  [16.27922909]
curr_Stock_Price:  92.80244411544068
curr_Factors:  [9.28024441e+01 4.92551108e-02]
mat_Sqrt:  [[ 2.05961034e+01  0.00000000e+00]
 [-8.87739699e-03  2.03406718e-02]]
grads:  [-2.94885712e-03  1.12530860e+01]
Stock Position:  -0.002948857119227565
Bond Position:  [16.55289024]


portfolio before change:  [16.27542873]
curr_Stock_Price:  94.79291105281578
curr_Factors:  [9.47929111e+01 4.84233382e-02]
mat_Sqrt:  [[ 2.08594678e+01  0.00000000e+00]
 [-8.80212140e-03  2.01681938e-02]]
grads:  [ 0.02085435 10.72387347]
Stock Position:  0.020854347580358448
Bond Position:  [14.29858441]


portfolio before change:  [16.2866253]
curr_Stock_Price:  95.24409441274294
curr_Factors:  [9.52440944e+01 4.72675673e-02]
mat_Sqrt:  [[ 2.07071191e+01  0.00000000e+00]
 [-8.69644224e-03  1.99260524e-02]]
grads:  [ 0.00124992 -0.93780122]
Stock Position:  0.0012499228124467714
Bond Position:  [16.16757753]


portfolio before change:  [16.28927266]
curr_Stock_Price:  95.74515671273026
curr_Factors:  [9.57451567e+01 4.67440843e-02]
mat_Sqrt:  [[ 2.07004670e+01  0.00000000e+00]
 [-8.64815210e-03  1.98154058e-02]]
grads:  [ 0.00667608 -6.44598255]
Stock Position:  0.00667607677963814
Bond Position:  [15.65007064]


portfolio before change:  [16.29314362]
curr_Stock_Price:  96.03193904545806
curr_Factors:  [9.60319390e+01 4.50819749e-02]
mat_Sqrt:  [[ 2.03899971e+01  0.00000000e+00]
 [-8.49300653e-03  1.94599226e-02]]
grads:  [4.23432715e-03 5.92842449e+00]
Stock Position:  0.0042343271517853425
Bond Position:  [15.88651297]


portfolio before change:  [16.29052668]
curr_Stock_Price:  94.94489982961406
curr_Factors:  [9.49448998e+01 4.60546493e-02]
mat_Sqrt:  [[ 2.03755049e+01  0.00000000e+00]
 [-8.58413879e-03  1.96687329e-02]]
grads:  [4.83884708e-04 7.47878961e+00]
Stock Position:  0.00048388470812516985
Bond Position:  [16.24458429]


portfolio before change:  [16.29292585]
curr_Stock_Price:  95.70639377831526
curr_Factors:  [9.57063938e+01 4.69083572e-02]
mat_Sqrt:  [[ 2.07284135e+01  0.00000000e+00]
 [-8.66333489e-03  1.98501940e-02]]
grads:  [-0.01556229 -5.34715176]
Stock Position:  -0.015562287682425466
Bond Position:  [17.78233629]


portfolio before change:  [16.33160129]
curr_Stock_Price:  93.36403200167193
curr_Factors:  [9.33640320e+01 4.78503787e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.33160129]
Stock Price:  93.1043042164518
PL:  [16.33160129]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.01273798e+00  2.57860981e-01]
 [ 3.49580435e-01  1.13630568e-01]
 [ 1.00635078e-01 -2.36028090e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.56303080e-02  1.21360900e-01]
 [-2.98528469e-01  1.21590300e-01]
 [ 1.06517120e-01 -2.16655209e-03]
 [ 2.88699442e-02  3.96902279e-01]
 [-1.17910273e-01 -9.72221930e-02]
 [ 1.82144560e-01  4.84501791e-02]
 [-8.44006303e-02  1.05876454e-02]
 [ 6.52407546e-02 -1.25154277e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-1.32216924e-01  3.41455369e-01]
 [ 1.13222414e-01  1.46150106e-01]
 [ 1.31623885e-01 -1.03254468e-01]
 [ 3.81910273e-02 -9.54086262e-03]
 [ 3.61788908e-01  6.36009362e-02]
 [ 2.56138626e-01  2.66232600e-01]
 [-6.58294336e-01  3.07084862e-01]
 [-1.37342873e-01  2.83410569e-01]
 [ 1.77492404e+00  2.55029777e-01]
 [ 1.50486250e-02  4.32515483e-01]
 [-1.62477504e-01  2.27403935e-01]
 [-1.53379209e-01  5.77451993e-02]
 [ 2.26387300e-01 -7.72966950e-02]
 [ 6.19753773e-01 -4.05860593e-01]
 [ 1.63619982e-01 -1.46062160e-01]
 [ 9.19018621e-01 -3.33946891e-01]
 [-8.40391955e-01 -3.70705941e-01]
 [ 6.88693720e-01  2.57226893e-01]
 [-2.85899409e-01  4.43362653e-01]
 [ 8.74296159e-01  1.51772459e-01]
 [ 6.49192179e-02 -1.40845247e-01]
 [ 3.23690497e-01 -4.79917660e-01]
 [ 1.48639257e-01  2.09321972e-03]
 [-7.74404070e-02  5.17759694e-01]
 [-3.95149311e-01 -1.45412280e-01]
 [-2.79889735e-01  7.12382599e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.17469722]
curr_Stock_Price:  101.52313355185821
curr_Factors:  [1.01523134e+02 3.96818057e-02]
mat_Sqrt:  [[ 2.02237053e+01  0.00000000e+00]
 [-7.96811704e-03  1.82572497e-02]]
grads:  [ 0.05564152 14.12375824]
Stock Position:  0.055641521824822765
Bond Position:  [7.52579557]


portfolio before change:  [13.10183921]
curr_Stock_Price:  100.19680758222127
curr_Factors:  [1.00196808e+02 4.14946394e-02]
mat_Sqrt:  [[ 2.04103232e+01  0.00000000e+00]
 [-8.14809321e-03  1.86696270e-02]]
grads:  [0.0195574  6.08638666]
Stock Position:  0.019557401287864516
Bond Position:  [11.14225004]


portfolio before change:  [13.10847955]
curr_Stock_Price:  100.46511872879982
curr_Factors:  [1.00465119e+02 4.18365056e-02]
mat_Sqrt:  [[ 2.05491094e+01  0.00000000e+00]
 [-8.18158964e-03  1.87463769e-02]]
grads:  [ 0.004396   -1.25905977]
Stock Position:  0.004396004048792363
Bond Position:  [12.66683448]


portfolio before change:  [13.10841527]
curr_Stock_Price:  100.09029292704291
curr_Factors:  [1.00090293e+02 4.32637779e-02]
mat_Sqrt:  [[ 2.08187275e+01  0.00000000e+00]
 [-8.31997864e-03  1.90634659e-02]]
grads:  [-7.83014571e-04 -7.94120087e+00]
Stock Position:  -0.0007830145705530719
Bond Position:  [13.18678742]


portfolio before change:  [13.11004445]
curr_Stock_Price:  100.11489897359377
curr_Factors:  [1.00114899e+02 4.19932337e-02]
mat_Sqrt:  [[ 2.05157960e+01  0.00000000e+00]
 [-8.19690026e-03  1.87814580e-02]]
grads:  [-1.59214242e-03  6.46174007e+00]
Stock Position:  -0.0015921424200396827
Bond Position:  [13.26944163]


portfolio before change:  [13.10999159]
curr_Stock_Price:  101.18995550378422
curr_Factors:  [1.01189956e+02 4.33878985e-02]
mat_Sqrt:  [[ 2.10776269e+01  0.00000000e+00]
 [-8.33190480e-03  1.90907922e-02]]
grads:  [-0.01164562  6.3690547 ]
Stock Position:  -0.011645623698832664
Bond Position:  [14.28841174]


portfolio before change:  [13.11869762]
curr_Stock_Price:  100.59575219411067
curr_Factors:  [1.00595752e+02 4.10283008e-02]
mat_Sqrt:  [[ 2.03761162e+01  0.00000000e+00]
 [-8.10217756e-03  1.85644210e-02]]
grads:  [ 0.00518114 -0.11670453]
Stock Position:  0.005181142380368937
Bond Position:  [12.59749671]


portfolio before change:  [13.1229414]
curr_Stock_Price:  101.11088801376226
curr_Factors:  [1.01110888e+02 3.89443109e-02]
mat_Sqrt:  [[ 1.99535391e+01  0.00000000e+00]
 [-7.89372520e-03  1.80867966e-02]]
grads:  [1.01281431e-02 2.19443104e+01]
Stock Position:  0.010128143137121001
Bond Position:  [12.09887585]


portfolio before change:  [13.12689857]
curr_Stock_Price:  101.35226619791202
curr_Factors:  [1.01352266e+02 3.98525883e-02]
mat_Sqrt:  [[ 2.02330675e+01  0.00000000e+00]
 [-7.98524523e-03  1.82964953e-02]]
grads:  [-0.00792473 -5.31370578]
Stock Position:  -0.00792472604507292
Bond Position:  [13.93008751]


portfolio before change:  [13.14441821]
curr_Stock_Price:  99.36124873353702
curr_Factors:  [9.93612487e+01 4.11463370e-02]
mat_Sqrt:  [[ 2.01549920e+01  0.00000000e+00]
 [-8.11382396e-03  1.85911062e-02]]
grads:  [0.01008633 2.60609447]
Stock Position:  0.010086332527808767
Bond Position:  [12.14222761]


portfolio before change:  [13.13450163]
curr_Stock_Price:  98.22759098950054
curr_Factors:  [9.82275910e+01 4.18073428e-02]
mat_Sqrt:  [[ 2.00844422e+01  0.00000000e+00]
 [-8.17873758e-03  1.87398420e-02]]
grads:  [-0.00397222  0.56498051]
Stock Position:  -0.00397221899587392
Bond Position:  [13.52468313]


portfolio before change:  [13.13975162]
curr_Stock_Price:  97.33154219839498
curr_Factors:  [9.73315422e+01 4.19266147e-02]
mat_Sqrt:  [[ 1.99295964e+01  0.00000000e+00]
 [-8.19039581e-03  1.87665544e-02]]
grads:  [ 5.32823146e-04 -6.66900668e+00]
Stock Position:  0.0005328231459948094
Bond Position:  [13.08789112]


portfolio before change:  [13.14151719]
curr_Stock_Price:  97.57454346180468
curr_Factors:  [9.75745435e+01 4.16505556e-02]
mat_Sqrt:  [[ 1.99134692e+01  0.00000000e+00]
 [-8.16338710e-03  1.87046697e-02]]
grads:  [-0.00649555 -1.49970065]
Stock Position:  -0.006495547645455169
Bond Position:  [13.77531728]


portfolio before change:  [13.15727606]
curr_Stock_Price:  95.41354745289445
curr_Factors:  [9.54135475e+01 4.36088392e-02]
mat_Sqrt:  [[ 1.99249530e+01  0.00000000e+00]
 [-8.35309180e-03  1.91393377e-02]]
grads:  [8.43485879e-04 1.78405008e+01]
Stock Position:  0.0008434858792892809
Bond Position:  [13.07679608]


portfolio before change:  [13.15735486]
curr_Stock_Price:  93.56893359458657
curr_Factors:  [9.35689336e+01 4.52224510e-02]
mat_Sqrt:  [[ 1.98979680e+01  0.00000000e+00]
 [-8.50622840e-03  1.94902178e-02]]
grads:  [0.00889576 7.49863894]
Stock Position:  0.0088957600677831
Bond Position:  [12.32498808]


portfolio before change:  [13.16310519]
curr_Stock_Price:  94.04214894679247
curr_Factors:  [9.40421489e+01 4.32394407e-02]
mat_Sqrt:  [[ 1.95552142e+01  0.00000000e+00]
 [-8.31763819e-03  1.90581033e-02]]
grads:  [ 4.42643785e-03 -5.41787743e+00]
Stock Position:  0.004426437851630931
Bond Position:  [12.74683346]


portfolio before change:  [13.16353792]
curr_Stock_Price:  93.77992500446261
curr_Factors:  [9.37799250e+01 4.36000887e-02]
mat_Sqrt:  [[ 1.95818431e+01  0.00000000e+00]
 [-8.35225370e-03  1.91374174e-02]]
grads:  [ 0.00173768 -0.49854494]
Stock Position:  0.0017376838939324435
Bond Position:  [13.00057806]


portfolio before change:  [13.16327949]
curr_Stock_Price:  92.69594592588852
curr_Factors:  [9.26959459e+01 4.45203789e-02]
mat_Sqrt:  [[ 1.95587082e+01  0.00000000e+00]
 [-8.43994113e-03  1.93383345e-02]]
grads:  [0.01991679 3.28885283]
Stock Position:  0.01991678738413654
Bond Position:  [11.31707404]


portfolio before change:  [13.18773626]
curr_Stock_Price:  93.85286219941311
curr_Factors:  [9.38528622e+01 4.49438573e-02]
mat_Sqrt:  [[ 1.98967752e+01  0.00000000e+00]
 [-8.47998654e-03  1.94300901e-02]]
grads:  [ 0.01871319 13.70207749]
Stock Position:  0.018713186183892543
Bond Position:  [11.43145018]


portfolio before change:  [13.18587331]
curr_Stock_Price:  93.67694469644553
curr_Factors:  [9.36769447e+01 4.43654197e-02]
mat_Sqrt:  [[ 1.97312689e+01  0.00000000e+00]
 [-8.42524015e-03  1.93046504e-02]]
grads:  [-0.02657059 15.90729986]
Stock Position:  -0.026570592994526115
Bond Position:  [15.67492528]


portfolio before change:  [13.23025598]
curr_Stock_Price:  92.08032290566435
curr_Factors:  [9.20803229e+01 4.57518996e-02]
mat_Sqrt:  [[ 1.96956990e+01  0.00000000e+00]
 [-8.55587748e-03  1.96039781e-02]]
grads:  [-6.93164525e-04  1.44567887e+01]
Stock Position:  -0.000693164524685298
Bond Position:  [13.2940828]


portfolio before change:  [13.23146089]
curr_Stock_Price:  92.73955711479783
curr_Factors:  [9.27395571e+01 4.68253139e-02]
mat_Sqrt:  [[ 2.00680589e+01  0.00000000e+00]
 [-8.65566302e-03  1.98326155e-02]]
grads:  [ 0.09399156 12.85910963]
Stock Position:  0.09399156008862179
Bond Position:  [4.51472523]


portfolio before change:  [13.31506983]
curr_Stock_Price:  93.62308921971395
curr_Factors:  [9.36230892e+01 4.69345973e-02]
mat_Sqrt:  [[ 2.02828750e+01  0.00000000e+00]
 [-8.66575765e-03  1.98557452e-02]]
grads:  [1.00485684e-02 2.17828885e+01]
Stock Position:  0.010048568407081281
Bond Position:  [12.37429181]


portfolio before change:  [13.2982443]
curr_Stock_Price:  91.7947287617931
curr_Factors:  [9.17947288e+01 4.73712122e-02]
mat_Sqrt:  [[ 1.99790573e+01  0.00000000e+00]
 [-8.70597149e-03  1.99478867e-02]]
grads:  [-3.16482852e-03  1.13999011e+01]
Stock Position:  -0.0031648285247700618
Bond Position:  [13.58875888]


portfolio before change:  [13.30109156]
curr_Stock_Price:  91.43181740538742
curr_Factors:  [9.14318174e+01 4.67474133e-02]
mat_Sqrt:  [[ 1.97686105e+01  0.00000000e+00]
 [-8.64846005e-03  1.98161114e-02]]
grads:  [-0.00648387  2.91405302]
Stock Position:  -0.006483871903685199
Bond Position:  [13.89392375]


portfolio before change:  [13.30887134]
curr_Stock_Price:  90.49982218437026
curr_Factors:  [9.04998222e+01 4.85741582e-02]
mat_Sqrt:  [[ 1.99457498e+01  0.00000000e+00]
 [-8.81581835e-03  2.01995775e-02]]
grads:  [ 0.00965881 -3.82664911]
Stock Position:  0.009658812456126214
Bond Position:  [12.43475053]


portfolio before change:  [13.30014124]
curr_Stock_Price:  89.43503870621062
curr_Factors:  [8.94350387e+01 4.73967746e-02]
mat_Sqrt:  [[ 1.94707237e+01  0.00000000e+00]
 [-8.70832012e-03  1.99532681e-02]]
grads:  [  0.02273268 -20.34055734]
Stock Position:  0.02273267783407146
Bond Position:  [11.26704332]


portfolio before change:  [13.27513941]
curr_Stock_Price:  88.27326193925768
curr_Factors:  [8.82732619e+01 4.71503039e-02]
mat_Sqrt:  [[ 1.91677627e+01  0.00000000e+00]
 [-8.68564829e-03  1.99013204e-02]]
grads:  [ 5.21047922e-03 -7.33932006e+00]
Stock Position:  0.005210479219689949
Bond Position:  [12.81519342]


portfolio before change:  [13.27928554]
curr_Stock_Price:  88.76153324646461
curr_Factors:  [8.87615332e+01 4.63739059e-02]
mat_Sqrt:  [[ 1.91144424e+01  0.00000000e+00]
 [-8.61384057e-03  1.97367882e-02]]
grads:  [  0.04045487 -16.92002198]
Stock Position:  0.04045486822549892
Bond Position:  [9.68844941]


portfolio before change:  [13.30483904]
curr_Stock_Price:  89.36324995292063
curr_Factors:  [8.93632500e+01 4.75592781e-02]
mat_Sqrt:  [[ 1.94884178e+01  0.00000000e+00]
 [-8.72323592e-03  1.99874445e-02]]
grads:  [ -0.05142446 -18.54694039]
Stock Position:  -0.05142445640199483
Bond Position:  [17.90029559]


portfolio before change:  [13.3078137]
curr_Stock_Price:  89.34891866856407
curr_Factors:  [8.93489187e+01 4.79132332e-02]
mat_Sqrt:  [[ 1.95576667e+01  0.00000000e+00]
 [-8.75563665e-03  2.00616839e-02]]
grads:  [ 0.04095359 12.82179975]
Stock Position:  0.04095359394362667
Bond Position:  [9.64865436]


portfolio before change:  [13.28585348]
curr_Stock_Price:  88.78324495544491
curr_Factors:  [8.87832450e+01 4.53463616e-02]
mat_Sqrt:  [[ 1.89061125e+01  0.00000000e+00]
 [-8.51787407e-03  1.95169013e-02]]
grads:  [-4.88731269e-03  2.27168568e+01]
Stock Position:  -0.004887312686737205
Bond Position:  [13.71976496]


portfolio before change:  [13.28486017]
curr_Stock_Price:  89.33741196915065
curr_Factors:  [8.93374120e+01 4.60013385e-02]
mat_Sqrt:  [[ 1.91610190e+01  0.00000000e+00]
 [-8.57916905e-03  1.96573458e-02]]
grads:  [0.04908586 7.72090295]
Stock Position:  0.049085859692814676
Bond Position:  [8.8996565]


portfolio before change:  [13.32983755]
curr_Stock_Price:  90.23104716168788
curr_Factors:  [9.02310472e+01 4.46496374e-02]
mat_Sqrt:  [[ 1.90662360e+01  0.00000000e+00]
 [-8.45218432e-03  1.93663872e-02]]
grads:  [ 1.80912079e-04 -7.27266505e+00]
Stock Position:  0.00018091207893112819
Bond Position:  [13.31351366]


portfolio before change:  [13.33138355]
curr_Stock_Price:  89.57718622349802
curr_Factors:  [8.95771862e+01 4.55032371e-02]
mat_Sqrt:  [[ 1.91081465e+01  0.00000000e+00]
 [-8.53259512e-03  1.95506315e-02]]
grads:  [ 5.97845838e-03 -2.45474250e+01]
Stock Position:  0.0059784583838002675
Bond Position:  [12.79585007]


portfolio before change:  [13.33261872]
curr_Stock_Price:  89.51623240327241
curr_Factors:  [8.95162324e+01 4.55965347e-02]
mat_Sqrt:  [[ 1.91147100e+01  0.00000000e+00]
 [-8.54133804e-03  1.95706640e-02]]
grads:  [0.00782396 0.10695701]
Stock Position:  0.007823964499462727
Bond Position:  [12.6322469]


portfolio before change:  [13.34400184]
curr_Stock_Price:  90.76930370868735
curr_Factors:  [9.07693037e+01 4.40685052e-02]
mat_Sqrt:  [[ 1.90547460e+01  0.00000000e+00]
 [-8.39699996e-03  1.92399440e-02]]
grads:  [7.79482703e-03 2.69106654e+01]
Stock Position:  0.007794827026219328
Bond Position:  [12.63647082]


portfolio before change:  [13.33904137]
curr_Stock_Price:  89.93026955207701
curr_Factors:  [8.99302696e+01 4.47294662e-02]
mat_Sqrt:  [[ 1.90196602e+01  0.00000000e+00]
 [-8.45973675e-03  1.93836920e-02]]
grads:  [-0.02411255 -7.5017845 ]
Stock Position:  -0.02411254615077856
Bond Position:  [15.50748915]


portfolio before change:  [13.36703398]
curr_Stock_Price:  88.84975127604555
curr_Factors:  [8.88497513e+01 4.48141623e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.36703398]
Stock Price:  90.3331460349677
PL:  [13.36703398]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.24676331e+00  3.10769421e-01]
 [ 3.79588539e-01  1.16635445e-01]
 [ 1.01513962e-01 -2.32733327e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.24166018e-02  4.77629119e-01]
 [-1.52905308e-02 -1.14651636e-01]
 [ 1.07260200e-01 -4.49051642e-03]
 [ 2.42333941e-01  4.55312318e-01]
 [-1.17895775e-01 -9.71566899e-02]
 [ 1.21678741e-01 -3.36116707e-02]
 [-9.37507451e-02 -6.82143953e-03]
 [-5.78636149e-02 -1.39323687e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-5.30010622e-03 -1.26665005e-01]
 [ 5.67958028e-02  1.19149470e-04]
 [ 1.08585480e-01 -7.85316163e-01]
 [ 2.51833906e-02 -1.77976542e-01]
 [ 3.40863000e-02 -1.55768267e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 1.27635930e-03 -8.48035920e-02]
 [ 1.63065669e-01 -3.55540495e-02]
 [ 3.67544317e-01 -3.66598281e-01]
 [ 2.97330859e-02 -3.99660757e-01]
 [ 4.69233379e-02  2.39994996e-02]
 [ 4.25036133e-01 -3.55025812e-01]
 [-2.64468966e-01  2.03705333e-02]
 [-1.35097832e-01  1.59955745e-01]
 [-1.29624820e-01 -2.45224264e-01]
 [-8.72237111e-02  2.16663401e-01]
 [-5.69796026e-01  5.16521124e-01]
 [-1.07720339e-01  4.96070026e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-1.59966150e-01 -2.02511756e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.25218959e-01 -9.80474090e-02]
 [-3.27312896e-02 -1.28232224e-01]
 [ 1.28152504e-02 -6.32779919e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.11002847]
curr_Stock_Price:  100.35250684046531
curr_Factors:  [1.00352507e+02 4.08611969e-02]
mat_Sqrt:  [[ 2.02854090e+01  0.00000000e+00]
 [-8.08566107e-03  1.85265770e-02]]
grads:  [ 0.06814722 16.7742493 ]
Stock Position:  0.06814721907274102
Bond Position:  [-1.72871579]


portfolio before change:  [5.09270274]
curr_Stock_Price:  100.101438134689
curr_Factors:  [1.00101438e+02 4.22966442e-02]
mat_Sqrt:  [[ 2.05870099e+01  0.00000000e+00]
 [-8.22645918e-03  1.88491860e-02]]
grads:  [0.02091088 6.187824  ]
Stock Position:  0.020910876478049692
Bond Position:  [2.99949393]


portfolio before change:  [5.1006399]
curr_Stock_Price:  100.46307757708283
curr_Factors:  [1.00463078e+02 4.30995170e-02]
mat_Sqrt:  [[ 2.08565600e+01  0.00000000e+00]
 [-8.30416926e-03  1.90272421e-02]]
grads:  [ 0.00438024 -1.22315849]
Stock Position:  0.004380235628349655
Bond Position:  [4.66058794]


portfolio before change:  [5.09446285]
curr_Stock_Price:  98.91986134347778
curr_Factors:  [9.89198613e+01 4.39130056e-02]
mat_Sqrt:  [[ 2.07290825e+01  0.00000000e+00]
 [-8.38217209e-03  1.92059690e-02]]
grads:  [-7.86400794e-04 -7.88227931e+00]
Stock Position:  -0.0007864007939785268
Bond Position:  [5.17225351]


portfolio before change:  [5.09562885]
curr_Stock_Price:  98.25935754544285
curr_Factors:  [9.82593575e+01 4.46982789e-02]
mat_Sqrt:  [[ 2.07739614e+01  0.00000000e+00]
 [-8.45678699e-03  1.93769333e-02]]
grads:  [5.58573463e-03 2.46493660e+01]
Stock Position:  0.00558573462815176
Bond Position:  [4.54677815]


portfolio before change:  [5.09650935]
curr_Stock_Price:  98.3152350445994
curr_Factors:  [9.83152350e+01 4.43024447e-02]
mat_Sqrt:  [[ 2.06935342e+01  0.00000000e+00]
 [-8.41925837e-03  1.92909444e-02]]
grads:  [-3.15695747e-03 -5.94328790e+00]
Stock Position:  -0.0031569574712459938
Bond Position:  [5.40688636]


portfolio before change:  [5.089981]
curr_Stock_Price:  100.59725858165478
curr_Factors:  [1.00597259e+02 4.40258619e-02]
mat_Sqrt:  [[ 2.11076595e+01  0.00000000e+00]
 [-8.39293626e-03  1.92306329e-02]]
grads:  [ 0.00498873 -0.23350851]
Stock Position:  0.004988728279214297
Bond Position:  [4.58812861]


portfolio before change:  [5.09013672]
curr_Stock_Price:  100.51350360426699
curr_Factors:  [1.00513504e+02 4.24849835e-02]
mat_Sqrt:  [[ 2.07177286e+01  0.00000000e+00]
 [-8.24475431e-03  1.88911054e-02]]
grads:  [2.12884596e-02 2.41019416e+01]
Stock Position:  0.021288459607199245
Bond Position:  [2.95035906]


portfolio before change:  [5.10711254]
curr_Stock_Price:  101.29359755493591
curr_Factors:  [1.01293598e+02 4.20195971e-02]
mat_Sqrt:  [[ 2.07638526e+01  0.00000000e+00]
 [-8.19947287e-03  1.87873525e-02]]
grads:  [-0.00772007 -5.17138802]
Stock Position:  -0.007720071694774312
Bond Position:  [5.88910637]


portfolio before change:  [5.11097348]
curr_Stock_Price:  100.88884038475476
curr_Factors:  [1.0088884e+02 4.3653912e-02]
mat_Sqrt:  [[ 2.10792286e+01  0.00000000e+00]
 [-8.35740745e-03  1.91492261e-02]]
grads:  [ 0.00507653 -1.75524956]
Stock Position:  0.005076533278724944
Bond Position:  [4.59880792]


portfolio before change:  [5.10916207]
curr_Stock_Price:  100.41877763634811
curr_Factors:  [1.00418778e+02 4.43509172e-02]
mat_Sqrt:  [[ 2.11478506e+01  0.00000000e+00]
 [-8.42386299e-03  1.93014949e-02]]
grads:  [-0.00457389 -0.35341509]
Stock Position:  -0.0045738863612969655
Bond Position:  [5.56846615]


portfolio before change:  [5.09919133]
curr_Stock_Price:  102.75089672765861
curr_Factors:  [1.02750897e+02 4.31117709e-02]
mat_Sqrt:  [[ 2.13345532e+01  0.00000000e+00]
 [-8.30534969e-03  1.90299468e-02]]
grads:  [-5.56231274e-03 -7.32128621e+00]
Stock Position:  -0.005562312740401233
Bond Position:  [5.67072395]


portfolio before change:  [5.10469547]
curr_Stock_Price:  101.88879842246247
curr_Factors:  [1.01888798e+02 4.37184013e-02]
mat_Sqrt:  [[ 2.13038736e+01  0.00000000e+00]
 [-8.36357830e-03  1.91633653e-02]]
grads:  [-0.00307501 -0.93355225]
Stock Position:  -0.0030750051522841775
Bond Position:  [5.41800405]


portfolio before change:  [5.10359654]
curr_Stock_Price:  102.46643232293576
curr_Factors:  [1.02466432e+02 4.39311627e-02]
mat_Sqrt:  [[ 2.14767205e+01  0.00000000e+00]
 [-8.38390484e-03  1.92099393e-02]]
grads:  [-2.82078665e-03 -6.59372228e+00]
Stock Position:  -0.002820786652765162
Bond Position:  [5.39263248]


portfolio before change:  [5.10043982]
curr_Stock_Price:  103.82450689137315
curr_Factors:  [1.03824507e+02 4.23837519e-02]
mat_Sqrt:  [[ 2.13746778e+01  0.00000000e+00]
 [-8.23492580e-03  1.88685854e-02]]
grads:  [0.00265959 0.0063147 ]
Stock Position:  0.00265958647338786
Bond Position:  [4.82430957]


portfolio before change:  [5.10182706]
curr_Stock_Price:  104.1193507761558
curr_Factors:  [1.04119351e+02 4.18052378e-02]
mat_Sqrt:  [[ 2.12885852e+01  0.00000000e+00]
 [-8.17853168e-03  1.87393702e-02]]
grads:  [-1.09990678e-02 -4.19072868e+01]
Stock Position:  -0.010999067812559469
Bond Position:  [6.24704286]


portfolio before change:  [5.11216426]
curr_Stock_Price:  103.25052504136389
curr_Factors:  [1.03250525e+02 4.27638813e-02]
mat_Sqrt:  [[ 2.13516197e+01  0.00000000e+00]
 [-8.27177188e-03  1.89530104e-02]]
grads:  [-2.45845237e-03 -9.39041017e+00]
Stock Position:  -0.0024584523708083977
Bond Position:  [5.36600076]


portfolio before change:  [5.11248399]
curr_Stock_Price:  103.3933252803101
curr_Factors:  [1.03393325e+02 4.31023752e-02]
mat_Sqrt:  [[ 2.14656036e+01  0.00000000e+00]
 [-8.30444461e-03  1.90278730e-02]]
grads:  [-1.57910981e-03 -8.18632050e+00]
Stock Position:  -0.0015791098115735976
Bond Position:  [5.2757534]


portfolio before change:  [5.11555168]
curr_Stock_Price:  101.86830065150951
curr_Factors:  [1.01868301e+02 4.31955072e-02]
mat_Sqrt:  [[ 2.11718277e+01  0.00000000e+00]
 [-8.31341155e-03  1.90484189e-02]]
grads:  [-1.50564774e-02 -2.46365668e+01]
Stock Position:  -0.015056477382073528
Bond Position:  [6.64932944]


portfolio before change:  [5.11886711]
curr_Stock_Price:  101.70330768598123
curr_Factors:  [1.01703308e+02 4.36948282e-02]
mat_Sqrt:  [[ 2.12593556e+01  0.00000000e+00]
 [-8.36132316e-03  1.91581982e-02]]
grads:  [-1.68090526e-03 -4.42649102e+00]
Stock Position:  -0.0016809052594623007
Bond Position:  [5.28982073]


portfolio before change:  [5.11894982]
curr_Stock_Price:  102.04750331197553
curr_Factors:  [1.02047503e+02 4.38835375e-02]
mat_Sqrt:  [[ 2.13773170e+01  0.00000000e+00]
 [-8.37935916e-03  1.91995238e-02]]
grads:  [ 0.00690211 -1.85181934]
Stock Position:  0.006902110738394135
Bond Position:  [4.41460665]


portfolio before change:  [5.13425223]
curr_Stock_Price:  104.18461006243285
curr_Factors:  [1.04184610e+02 4.29454591e-02]
mat_Sqrt:  [[ 2.15904749e+01  0.00000000e+00]
 [-8.28931448e-03  1.89932055e-02]]
grads:  [ 9.61292934e-03 -1.93015486e+01]
Stock Position:  0.009612929338669533
Bond Position:  [4.13273293]


portfolio before change:  [5.1216007]
curr_Stock_Price:  102.81477230718123
curr_Factors:  [1.02814772e+02 4.31235886e-02]
mat_Sqrt:  [[ 2.13507416e+01  0.00000000e+00]
 [-8.30648793e-03  1.90325548e-02]]
grads:  [-6.77696217e-03 -2.09987971e+01]
Stock Position:  -0.006776962174971772
Bond Position:  [5.81837252]


portfolio before change:  [5.11977895]
curr_Stock_Price:  103.1909129497999
curr_Factors:  [1.03190913e+02 4.29258638e-02]
mat_Sqrt:  [[ 2.13796690e+01  0.00000000e+00]
 [-8.28742313e-03  1.89888719e-02]]
grads:  [0.00268468 1.26387179]
Stock Position:  0.0026846804016049997
Bond Position:  [4.84274433]


portfolio before change:  [5.12177216]
curr_Stock_Price:  103.70785652691924
curr_Factors:  [1.03707857e+02 4.34941600e-02]
mat_Sqrt:  [[ 2.16285364e+01  0.00000000e+00]
 [-8.34210142e-03  1.91141556e-02]]
grads:  [ 1.24876765e-02 -1.85739731e+01]
Stock Position:  0.012487676488531402
Bond Position:  [3.82670199]


portfolio before change:  [5.13150879]
curr_Stock_Price:  104.44924901792666
curr_Factors:  [1.04449249e+02 4.37915713e-02]
mat_Sqrt:  [[ 2.18575050e+01  0.00000000e+00]
 [-8.37057430e-03  1.91793952e-02]]
grads:  [-0.01169294  1.06210509]
Stock Position:  -0.011692941905685659
Bond Position:  [6.35282779]


portfolio before change:  [5.11696755]
curr_Stock_Price:  105.76075785621673
curr_Factors:  [1.05760758e+02 4.47198823e-02]
mat_Sqrt:  [[ 2.23653078e+01  0.00000000e+00]
 [-8.45883040e-03  1.93816153e-02]]
grads:  [-2.91913809e-03  8.25296252e+00]
Stock Position:  -0.00291913808812518
Bond Position:  [5.42569781]


portfolio before change:  [5.11359475]
curr_Stock_Price:  107.14851516627644
curr_Factors:  [1.07148515e+02 4.33147972e-02]
mat_Sqrt:  [[ 2.22999711e+01  0.00000000e+00]
 [-8.32488291e-03  1.90747030e-02]]
grads:  [-1.06120973e-02 -1.28559938e+01]
Stock Position:  -0.010612097313784383
Bond Position:  [6.25066522]


portfolio before change:  [5.1212082]
curr_Stock_Price:  106.50471504625705
curr_Factors:  [1.06504715e+02 4.22829811e-02]
mat_Sqrt:  [[ 2.19003792e+01  0.00000000e+00]
 [-8.22513038e-03  1.88461413e-02]]
grads:  [3.34969054e-04 1.14964330e+01]
Stock Position:  0.00033496905380346414
Bond Position:  [5.08553242]


portfolio before change:  [5.12207984]
curr_Stock_Price:  107.2089923032395
curr_Factors:  [1.07208992e+02 4.15817722e-02]
mat_Sqrt:  [[ 2.18616386e+01  0.00000000e+00]
 [-8.15664364e-03  1.86892185e-02]]
grads:  [-1.57521461e-02  2.76373849e+01]
Stock Position:  -0.01575214614799966
Bond Position:  [6.81085156]


portfolio before change:  [5.10954699]
curr_Stock_Price:  108.05867119696195
curr_Factors:  [1.08058671e+02 4.10986921e-02]
mat_Sqrt:  [[ 2.19065316e+01  0.00000000e+00]
 [-8.10912494e-03  1.85803394e-02]]
grads:  [-0.00392897  2.66986525]
Stock Position:  -0.003928968269327924
Bond Position:  [5.53410608]


portfolio before change:  [5.10591336]
curr_Stock_Price:  109.15958005367261
curr_Factors:  [1.09159580e+02 4.02008373e-02]
mat_Sqrt:  [[ 2.18866557e+01  0.00000000e+00]
 [-8.02005858e-03  1.83762628e-02]]
grads:  [ 0.00331447 -0.65014248]
Stock Position:  0.003314466943267402
Bond Position:  [4.74410754]


portfolio before change:  [5.10860872]
curr_Stock_Price:  109.79386226228559
curr_Factors:  [1.09793862e+02 4.01222116e-02]
mat_Sqrt:  [[ 2.19922921e+01  0.00000000e+00]
 [-8.01221184e-03  1.83582836e-02]]
grads:  [ -0.01129257 -11.03108328]
Stock Position:  -0.011292571302797264
Bond Position:  [6.34846373]


portfolio before change:  [5.10608798]
curr_Stock_Price:  110.08736013073896
curr_Factors:  [1.10087360e+02 4.04589977e-02]
mat_Sqrt:  [[ 2.21434363e+01  0.00000000e+00]
 [-8.04576885e-03  1.84351724e-02]]
grads:  [0.00458245 2.89387372]
Stock Position:  0.004582449185675321
Bond Position:  [4.60161824]


portfolio before change:  [5.10328667]
curr_Stock_Price:  109.35051641040708
curr_Factors:  [1.09350516e+02 4.12134116e-02]
mat_Sqrt:  [[ 2.21993430e+01  0.00000000e+00]
 [-8.12043462e-03  1.86062532e-02]]
grads:  [-4.26443300e-03  4.37085024e+00]
Stock Position:  -0.00426443299719318
Bond Position:  [5.56960462]


portfolio before change:  [5.10821506]
curr_Stock_Price:  108.3580872408622
curr_Factors:  [1.08358087e+02 4.24106475e-02]
mat_Sqrt:  [[ 2.23150971e+01  0.00000000e+00]
 [-8.23753823e-03  1.88745712e-02]]
grads:  [-0.02097281 -5.19468272]
Stock Position:  -0.020972812884361397
Bond Position:  [7.38078895]


portfolio before change:  [5.07940812]
curr_Stock_Price:  109.77561744059422
curr_Factors:  [1.09775617e+02 4.19437510e-02]
mat_Sqrt:  [[ 2.24822370e+01  0.00000000e+00]
 [-8.19206943e-03  1.87703891e-02]]
grads:  [-3.94517771e-03 -6.83162308e+00]
Stock Position:  -0.003945177705718076
Bond Position:  [5.51249244]


portfolio before change:  [5.08057009]
curr_Stock_Price:  109.6557576336276
curr_Factors:  [1.09655758e+02 4.19146140e-02]
mat_Sqrt:  [[ 2.24498878e+01  0.00000000e+00]
 [-8.18922356e-03  1.87638684e-02]]
grads:  [-6.59314182e-04 -3.37233190e+00]
Stock Position:  -0.0006593141818649546
Bond Position:  [5.15286769]


portfolio before change:  [5.08216543]
curr_Stock_Price:  108.21306117497703
curr_Factors:  [1.08213061e+02 4.16387247e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.08216543]
Stock Price:  107.87703779122124
PL:  [-2.79487236]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48676565e+00  3.66027674e-01]
 [ 1.29167893e+00  4.97198609e-02]
 [-5.61704406e-02  1.04252528e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.49203208e-01  1.10848097e+00]
 [ 1.82600945e-02 -4.46972628e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.18053143e+00  1.21078612e+00]
 [ 4.39218203e-02  4.49739433e-01]
 [ 6.30149685e-02 -1.24923540e-01]
 [ 2.30409950e-02  1.81904359e-02]
 [ 5.85690039e-02 -9.32321430e-02]
 [-2.38624680e-02  3.36409461e-01]
 [-1.48531046e-01  5.21987836e-01]
 [ 2.09450535e-01  1.88672203e-01]
 [ 1.31497443e-01 -1.06276795e-01]
 [ 3.69517723e-02 -6.73602937e-02]
 [ 3.73280414e-01  6.30397842e-02]
 [ 4.78661417e-01  4.92642102e-01]
 [-8.87474181e-01  4.40796806e-01]
 [-3.24378415e-01  4.32916235e-01]
 [ 2.02389688e+00  3.85663038e-01]
 [ 1.21779886e-02  3.18924017e-01]
 [-1.82112132e-01  3.04651499e-01]
 [-1.18876539e-01 -8.69458096e-03]
 [ 2.56953651e-01 -8.91935986e-02]
 [ 7.11370463e-01 -3.99717602e-01]
 [ 1.63154450e-01 -1.45071166e-01]
 [ 8.51062153e-01 -3.28802696e-01]
 [-8.64526542e-01 -3.76485572e-01]
 [ 6.83583736e-01  2.55243290e-01]
 [-2.39020895e-01  3.62999164e-01]
 [ 7.60403063e-01  1.93495148e-01]
 [ 6.50391025e-02 -1.43785816e-01]
 [ 3.50902535e-01 -5.89485377e-01]
 [ 1.70710027e-01 -2.57519267e-02]
 [-9.12344868e-02  7.38858656e-01]
 [-4.12039725e-01 -1.49418541e-01]
 [-2.75838507e-01  7.08181043e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.27232661]
curr_Stock_Price:  98.99061141462016
curr_Factors:  [9.89906114e+01 4.20053305e-02]
mat_Sqrt:  [[ 2.02883258e+01  0.00000000e+00]
 [-8.19808080e-03  1.87841629e-02]]
grads:  [ 0.0811557  19.48597208]
Stock Position:  0.08115569741005806
Bond Position:  [-12.30597872]


portfolio before change:  [-4.37874308]
curr_Stock_Price:  97.69830387402325
curr_Factors:  [9.76983039e+01 4.33398183e-02]
mat_Sqrt:  [[ 2.03390455e+01  0.00000000e+00]
 [-8.32728703e-03  1.90802116e-02]]
grads:  [0.06457424 2.60583383]
Stock Position:  0.06457424243064525
Bond Position:  [-10.68753704]


portfolio before change:  [-4.39843285]
curr_Stock_Price:  97.41407684541039
curr_Factors:  [9.74140768e+01 4.32377764e-02]
mat_Sqrt:  [[ 2.02559863e+01  0.00000000e+00]
 [-8.31747812e-03  1.90577365e-02]]
grads:  [-5.26802654e-04  5.47035203e+00]
Stock Position:  -0.0005268026535274967
Bond Position:  [-4.34711485]


portfolio before change:  [-4.39857794]
curr_Stock_Price:  96.65794218568907
curr_Factors:  [9.66579422e+01 4.35251302e-02]
mat_Sqrt:  [[ 2.01654345e+01  0.00000000e+00]
 [-8.34507090e-03  1.91209595e-02]]
grads:  [-8.08381637e-04 -7.91732299e+00]
Stock Position:  -0.0008083816370957274
Bond Position:  [-4.32044143]


portfolio before change:  [-4.39883848]
curr_Stock_Price:  96.31213735563064
curr_Factors:  [9.63121374e+01 4.32956388e-02]
mat_Sqrt:  [[ 2.00402482e+01  0.00000000e+00]
 [-8.32304164e-03  1.90704842e-02]]
grads:  [1.66952797e-02 5.81254761e+01]
Stock Position:  0.016695279718593945
Bond Position:  [-6.00679656]


portfolio before change:  [-4.3874578]
curr_Stock_Price:  97.03878442066986
curr_Factors:  [9.70387844e+01 4.18882003e-02]
mat_Sqrt:  [[ 1.98605467e+01  0.00000000e+00]
 [-8.18664280e-03  1.87579552e-02]]
grads:  [-6.28074501e-05 -2.38284303e+00]
Stock Position:  -6.280745006413158e-05
Bond Position:  [-4.38136304]


portfolio before change:  [-4.38794616]
curr_Stock_Price:  96.09381864957314
curr_Factors:  [9.60938186e+01 4.05783898e-02]
mat_Sqrt:  [[ 1.93572143e+01  0.00000000e+00]
 [-8.05763140e-03  1.84623529e-02]]
grads:  [0.00668349 5.207185  ]
Stock Position:  0.006683491516720623
Bond Position:  [-5.03018838]


portfolio before change:  [-4.392768]
curr_Stock_Price:  95.46644797402418
curr_Factors:  [9.54664480e+01 4.12602258e-02]
mat_Sqrt:  [[ 1.93917304e+01  0.00000000e+00]
 [-8.12504531e-03  1.86168176e-02]]
grads:  [ 0.08812838 65.03722318]
Stock Position:  0.08812838145321923
Bond Position:  [-12.80607154]


portfolio before change:  [-4.28964053]
curr_Stock_Price:  96.65480893576495
curr_Factors:  [9.66548089e+01 3.99217191e-02]
mat_Sqrt:  [[ 1.93120370e+01  0.00000000e+00]
 [-7.99216808e-03  1.83123576e-02]]
grads:  [1.24380562e-02 2.45593409e+01]
Stock Position:  0.01243805618359223
Bond Position:  [-5.49183847]


portfolio before change:  [-4.31114727]
curr_Stock_Price:  94.9808962487775
curr_Factors:  [9.49808962e+01 4.00423270e-02]
mat_Sqrt:  [[ 1.90062272e+01  0.00000000e+00]
 [-8.00423158e-03  1.83399985e-02]]
grads:  [ 4.46899091e-04 -6.81153491e+00]
Stock Position:  0.00044689909106559555
Bond Position:  [-4.35359415]


portfolio before change:  [-4.31166848]
curr_Stock_Price:  95.03242253330286
curr_Factors:  [9.50324225e+01 4.03451623e-02]
mat_Sqrt:  [[ 1.90883124e+01  0.00000000e+00]
 [-8.03444209e-03  1.84092195e-02]]
grads:  [0.00162298 0.98811554]
Stock Position:  0.0016229801507668194
Bond Position:  [-4.46590421]


portfolio before change:  [-4.31206991]
curr_Stock_Price:  95.12906133946854
curr_Factors:  [9.51290613e+01 4.07538919e-02]
mat_Sqrt:  [[ 1.92042679e+01  0.00000000e+00]
 [-8.07503728e-03  1.85022348e-02]]
grads:  [ 9.30999344e-04 -5.03896659e+00]
Stock Position:  0.0009309993443977773
Bond Position:  [-4.400635]


portfolio before change:  [-4.31444789]
curr_Stock_Price:  93.1657210118412
curr_Factors:  [9.31657210e+01 4.09007256e-02]
mat_Sqrt:  [[ 1.88417682e+01  0.00000000e+00]
 [-8.08957112e-03  1.85355360e-02]]
grads:  [6.52585558e-03 1.81494326e+01]
Stock Position:  0.006525855584834816
Bond Position:  [-4.92243393]


portfolio before change:  [-4.31559013]
curr_Stock_Price:  93.08498135490076
curr_Factors:  [9.30849814e+01 4.04177908e-02]
mat_Sqrt:  [[ 1.87139688e+01  0.00000000e+00]
 [-8.04167055e-03  1.84257820e-02]]
grads:  [4.23657445e-03 2.83292094e+01]
Stock Position:  0.004236574445930712
Bond Position:  [-4.70995158]


portfolio before change:  [-4.3098571]
curr_Stock_Price:  94.57717803161381
curr_Factors:  [9.45771780e+01 4.06971176e-02]
mat_Sqrt:  [[ 1.90795522e+01  0.00000000e+00]
 [-8.06941065e-03  1.84893426e-02]]
grads:  [ 0.01529354 10.20437599]
Stock Position:  0.015293536890181161
Bond Position:  [-5.75627667]


portfolio before change:  [-4.32097196]
curr_Stock_Price:  93.89746132568722
curr_Factors:  [9.38974613e+01 4.07853223e-02]
mat_Sqrt:  [[ 1.89629456e+01  0.00000000e+00]
 [-8.07815051e-03  1.85093681e-02]]
grads:  [ 4.48846125e-03 -5.74178407e+00]
Stock Position:  0.0044884612459228776
Bond Position:  [-4.74242707]


portfolio before change:  [-4.32707878]
curr_Stock_Price:  92.6689807487483
curr_Factors:  [9.26689807e+01 3.97988206e-02]
mat_Sqrt:  [[ 1.84871297e+01  0.00000000e+00]
 [-7.97985670e-03  1.82841487e-02]]
grads:  [ 4.08572349e-04 -3.68408149e+00]
Stock Position:  0.00040857234893859655
Bond Position:  [-4.36494077]


portfolio before change:  [-4.32770178]
curr_Stock_Price:  92.47968717259667
curr_Factors:  [9.24796872e+01 4.02240419e-02]
mat_Sqrt:  [[ 1.85476634e+01  0.00000000e+00]
 [-8.02237291e-03  1.83815656e-02]]
grads:  [0.02160883 3.42951116]
Stock Position:  0.021608826006766956
Bond Position:  [-6.32607925]


portfolio before change:  [-4.34974726]
curr_Stock_Price:  91.49607638322072
curr_Factors:  [9.14960764e+01 4.04019038e-02]
mat_Sqrt:  [[ 1.83909170e+01  0.00000000e+00]
 [-8.04008993e-03  1.84221603e-02]]
grads:  [ 0.03771797 26.74182032]
Stock Position:  0.03771796995074572
Bond Position:  [-7.80079352]


portfolio before change:  [-4.35737845]
curr_Stock_Price:  91.31960792009413
curr_Factors:  [9.13196079e+01 3.98938422e-02]
mat_Sqrt:  [[ 1.82396698e+01  0.00000000e+00]
 [-7.98937716e-03  1.83059628e-02]]
grads:  [-0.03810895 24.0794112 ]
Stock Position:  -0.038108951111042476
Bond Position:  [-0.87728398]


portfolio before change:  [-4.30510966]
curr_Stock_Price:  89.9451681613848
curr_Factors:  [8.99451682e+01 4.14037688e-02]
mat_Sqrt:  [[ 1.83019673e+01  0.00000000e+00]
 [-8.13916642e-03  1.86491731e-02]]
grads:  [-7.40020336e-03  2.32136960e+01]
Stock Position:  -0.007400203359018901
Bond Position:  [-3.63949713]


portfolio before change:  [-4.30330881]
curr_Stock_Price:  89.64033651017809
curr_Factors:  [8.96403365e+01 4.21041531e-02]
mat_Sqrt:  [[ 1.83935665e+01  0.00000000e+00]
 [-8.20771862e-03  1.88062459e-02]]
grads:  [ 0.11918374 20.50717829]
Stock Position:  0.11918373898108689
Bond Position:  [-14.98697928]


portfolio before change:  [-4.35572422]
curr_Stock_Price:  89.21626925101596
curr_Factors:  [8.92162693e+01 4.29544828e-02]
mat_Sqrt:  [[ 1.84904851e+01  0.00000000e+00]
 [-8.29018531e-03  1.89952009e-02]]
grads:  [8.18625580e-03 1.67897155e+01]
Stock Position:  0.008186255795011924
Bond Position:  [-5.08607142]


portfolio before change:  [-4.36171476]
curr_Stock_Price:  88.56215563259852
curr_Factors:  [8.85621556e+01 4.32258712e-02]
mat_Sqrt:  [[ 1.84128093e+01  0.00000000e+00]
 [-8.31633296e-03  1.90551126e-02]]
grads:  [-2.66940894e-03  1.59879138e+01]
Stock Position:  -0.0026694089382474557
Bond Position:  [-4.12530615]


portfolio before change:  [-4.36208983]
curr_Stock_Price:  88.50947591997473
curr_Factors:  [8.85094759e+01 4.26333474e-02]
mat_Sqrt:  [[ 1.82752988e+01  0.00000000e+00]
 [-8.25913771e-03  1.89240619e-02]]
grads:  [-0.0067124  -0.45944581]
Stock Position:  -0.006712402738825596
Bond Position:  [-3.76797859]


portfolio before change:  [-4.3670577]
curr_Stock_Price:  89.17940549098967
curr_Factors:  [8.91794055e+01 4.14936660e-02]
mat_Sqrt:  [[ 1.81658396e+01  0.00000000e+00]
 [-8.14799764e-03  1.86694080e-02]]
grads:  [ 0.012002   -4.77752689]
Stock Position:  0.01200199810663485
Bond Position:  [-5.43738875]


portfolio before change:  [-4.37427989]
curr_Stock_Price:  88.6342900668594
curr_Factors:  [8.86342901e+01 4.15725470e-02]
mat_Sqrt:  [[ 1.80719529e+01  0.00000000e+00]
 [-8.15573879e-03  1.86871452e-02]]
grads:  [  0.02971009 -21.38997681]
Stock Position:  0.029710092840057673
Bond Position:  [-7.00761288]


portfolio before change:  [-4.38455219]
curr_Stock_Price:  88.31802383844598
curr_Factors:  [8.83180238e+01 4.12597859e-02]
mat_Sqrt:  [[ 1.79396030e+01  0.00000000e+00]
 [-8.12500199e-03  1.86167183e-02]]
grads:  [ 5.56535186e-03 -7.79252086e+00]
Stock Position:  0.005565351859453579
Bond Position:  [-4.87607307]


portfolio before change:  [-4.37740716]
curr_Stock_Price:  89.71139218476205
curr_Factors:  [8.97113922e+01 4.08542964e-02]
mat_Sqrt:  [[ 1.81328665e+01  0.00000000e+00]
 [-8.08497831e-03  1.85250125e-02]]
grads:  [  0.03902091 -17.74912134]
Stock Position:  0.03902090670183044
Bond Position:  [-7.87802702]


portfolio before change:  [-4.40535745]
curr_Stock_Price:  89.02034002441398
curr_Factors:  [8.90203400e+01 4.11801062e-02]
mat_Sqrt:  [[ 1.80647926e+01  0.00000000e+00]
 [-8.11715282e-03  1.85987336e-02]]
grads:  [ -0.05695268 -20.24253801]
Stock Position:  -0.0569526780630538
Bond Position:  [0.66458931]


portfolio before change:  [-4.43853388]
curr_Stock_Price:  89.60432495599066
curr_Factors:  [8.96043250e+01 4.12775013e-02]
mat_Sqrt:  [[ 1.82047899e+01  0.00000000e+00]
 [-8.12674609e-03  1.86207146e-02]]
grads:  [ 0.04366878 13.7074917 ]
Stock Position:  0.04366878405918383
Bond Position:  [-8.3514458]


portfolio before change:  [-4.4094534]
curr_Stock_Price:  90.2941651199585
curr_Factors:  [9.02941651e+01 4.00279759e-02]
mat_Sqrt:  [[ 1.80651471e+01  0.00000000e+00]
 [-8.00279710e-03  1.83367117e-02]]
grads:  [-4.46135707e-03  1.97963064e+01]
Stock Position:  -0.00446135706799293
Bond Position:  [-4.00661888]


portfolio before change:  [-4.41138125]
curr_Stock_Price:  90.61402132539385
curr_Factors:  [9.06140213e+01 4.14679638e-02]
mat_Sqrt:  [[ 1.84523532e+01  0.00000000e+00]
 [-8.14547372e-03  1.86636249e-02]]
grads:  [ 0.04578556 10.36750085]
Stock Position:  0.04578555687644778
Bond Position:  [-8.56019467]


portfolio before change:  [-4.43470199]
curr_Stock_Price:  90.12804598612446
curr_Factors:  [9.01280460e+01 4.17848193e-02]
mat_Sqrt:  [[ 1.84233762e+01  0.00000000e+00]
 [-8.17653416e-03  1.87347933e-02]]
grads:  [ 1.24072143e-04 -7.67480127e+00]
Stock Position:  0.00012407214271970452
Bond Position:  [-4.44588437]


portfolio before change:  [-4.43553031]
curr_Stock_Price:  87.93133088697896
curr_Factors:  [8.79313309e+01 4.48761712e-02]
mat_Sqrt:  [[ 1.86273701e+01  0.00000000e+00]
 [-8.47359864e-03  1.94154536e-02]]
grads:  [ 5.02647573e-03 -3.03616588e+01]
Stock Position:  0.005026475730599399
Bond Position:  [-4.87751501]


portfolio before change:  [-4.43623026]
curr_Stock_Price:  87.91338243387278
curr_Factors:  [8.79133824e+01 4.41807486e-02]
mat_Sqrt:  [[ 1.84787047e+01  0.00000000e+00]
 [-8.40768682e-03  1.92644306e-02]]
grads:  [ 0.00862999 -1.33676033]
Stock Position:  0.00862998611425954
Bond Position:  [-5.19492153]


portfolio before change:  [-4.43370888]
curr_Stock_Price:  88.2807970021147
curr_Factors:  [8.8280797e+01 4.5869595e-02]
mat_Sqrt:  [[ 1.89072644e+01  0.00000000e+00]
 [-8.56687527e-03  1.96291772e-02]]
grads:  [1.22296839e-02 3.76408368e+01]
Stock Position:  0.012229683908351028
Bond Position:  [-5.51335512]


portfolio before change:  [-4.43381207]
curr_Stock_Price:  88.3287149793463
curr_Factors:  [8.83287150e+01 4.66954822e-02]
mat_Sqrt:  [[ 1.90870734e+01  0.00000000e+00]
 [-8.64365498e-03  1.98051016e-02]]
grads:  [-0.0250039  -7.54444706]
Stock Position:  -0.025003902445028103
Bond Position:  [-2.2252495]


portfolio before change:  [-4.4484564]
curr_Stock_Price:  88.90327158785732
curr_Factors:  [8.89032716e+01 4.58112182e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.4484564]
Stock Price:  89.2964352325318
PL:  [-4.4484564]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.27006389e+00  3.16037215e-01]
 [ 6.79382156e-01  1.08728010e-01]
 [ 5.72486519e-02  2.58444665e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.10603265e-01  8.60055944e-01]
 [-2.88394424e-03 -9.07246829e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 3.47568362e-01  4.82461023e-01]
 [-1.18214816e-01 -9.85981264e-02]
 [-1.25616809e-01 -3.83341262e-01]
 [-6.72340149e-02 -1.36343407e-02]
 [-4.22041682e-02 -1.33383065e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 6.35307265e-03 -1.61439790e-01]
 [ 2.84953962e-01  1.67056181e-01]
 [ 1.20330265e-01 -6.52539467e-01]
 [ 2.51407442e-02 -1.78311260e-01]
 [ 3.37874869e-02 -1.55442462e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-7.88594985e-03 -7.94396068e-02]
 [ 1.59627027e-01 -3.44897418e-02]
 [ 6.55271606e-01 -1.22844613e-01]
 [ 2.74005723e-02 -2.56097445e-01]
 [ 5.78891921e-02  9.02003972e-03]
 [ 4.08560635e-01 -3.20449869e-01]
 [-2.46158786e-01  1.61034578e-02]
 [-1.42979340e-01  1.36132959e-01]
 [-5.20826394e-02  5.79444782e-02]
 [-5.57390176e-02  2.01331404e-01]
 [-6.09224853e-01 -7.30203691e-02]
 [-1.57412449e-01 -3.65810566e-02]
 [ 6.95038999e-02 -1.60493504e-02]
 [-2.82967286e-01  1.20190209e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.45878920e-01  6.76389982e-02]
 [-2.21789384e-02 -2.24258467e-01]
 [ 3.03145537e-02 -1.48735430e-02]
 [-4.12207268e-02 -8.95139150e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.38869385]
curr_Stock_Price:  100.24780153849171
curr_Factors:  [1.00247802e+02 3.99070933e-02]
mat_Sqrt:  [[ 2.00262625e+01  0.00000000e+00]
 [-7.99070393e-03  1.83090028e-02]]
grads:  [ 0.07030737 17.26130134]
Stock Position:  0.07030736955394716
Bond Position:  [-2.65946538]


portfolio before change:  [4.33001738]
curr_Stock_Price:  99.417959346479
curr_Factors:  [9.94179593e+01 3.99163002e-02]
mat_Sqrt:  [[ 1.98627778e+01  0.00000000e+00]
 [-7.99162563e-03  1.83111147e-02]]
grads:  [0.03659281 5.93781494]
Stock Position:  0.036592814807913314
Bond Position:  [0.6920344]


portfolio before change:  [4.28553263]
curr_Stock_Price:  98.19992644433138
curr_Factors:  [9.81999264e+01 4.06729335e-02]
mat_Sqrt:  [[ 1.98045013e+01  0.00000000e+00]
 [-8.06701268e-03  1.84838481e-02]]
grads:  [0.00346023 1.39821894]
Stock Position:  0.003460228604802375
Bond Position:  [3.94573844]


portfolio before change:  [4.28510837]
curr_Stock_Price:  97.93476601313122
curr_Factors:  [9.7934766e+01 4.0410856e-02]
mat_Sqrt:  [[ 1.96872889e+01  0.00000000e+00]
 [-8.04098063e-03  1.84242012e-02]]
grads:  [-8.28014818e-04 -8.21673682e+00]
Stock Position:  -0.0008280148182039008
Bond Position:  [4.3661998]


portfolio before change:  [4.286056]
curr_Stock_Price:  97.44948293753853
curr_Factors:  [9.74494829e+01 3.97628476e-02]
mat_Sqrt:  [[ 1.94320348e+01  0.00000000e+00]
 [-7.97624951e-03  1.82758836e-02]]
grads:  [1.36247143e-02 4.70596095e+01]
Stock Position:  0.013624714288394386
Bond Position:  [2.95833463]


portfolio before change:  [4.29234269]
curr_Stock_Price:  97.88375860062183
curr_Factors:  [9.78837586e+01 4.00727207e-02]
mat_Sqrt:  [[ 1.95945391e+01  0.00000000e+00]
 [-8.00726877e-03  1.83469576e-02]]
grads:  [-2.16792250e-03 -4.94494427e+00]
Stock Position:  -0.0021679224954633766
Bond Position:  [4.5045471]


portfolio before change:  [4.29067703]
curr_Stock_Price:  98.91182407190186
curr_Factors:  [9.89118241e+01 3.95161007e-02]
mat_Sqrt:  [[ 1.96623423e+01  0.00000000e+00]
 [-7.95146283e-03  1.82190901e-02]]
grads:  [0.00657977 5.27671175]
Stock Position:  0.006579774433461579
Bond Position:  [3.63985954]


portfolio before change:  [4.29974555]
curr_Stock_Price:  100.22091291878232
curr_Factors:  [1.00220913e+02 3.81375967e-02]
mat_Sqrt:  [[ 1.95719914e+01  0.00000000e+00]
 [-7.81153984e-03  1.78984863e-02]]
grads:  [ 0.02851685 26.9554092 ]
Stock Position:  0.028516853734166923
Bond Position:  [1.44176044]


portfolio before change:  [4.37066824]
curr_Stock_Price:  102.70163748572125
curr_Factors:  [1.02701637e+02 3.64048142e-02]
mat_Sqrt:  [[ 1.95955193e+01  0.00000000e+00]
 [-7.63201826e-03  1.74871507e-02]]
grads:  [-0.00822875 -5.63831857]
Stock Position:  -0.008228746774774687
Bond Position:  [5.21577401]


portfolio before change:  [4.37529598]
curr_Stock_Price:  102.21848716435787
curr_Factors:  [1.02218487e+02 3.66598572e-02]
mat_Sqrt:  [[ 1.95715325e+01  0.00000000e+00]
 [-7.65870561e-03  1.75482991e-02]]
grads:  [-1.49666691e-02 -2.18449241e+01]
Stock Position:  -0.014966669131663255
Bond Position:  [5.90516625]


portfolio before change:  [4.38731507]
curr_Stock_Price:  101.46475225034591
curr_Factors:  [1.01464752e+02 3.58800051e-02]
mat_Sqrt:  [[ 1.92194718e+01  0.00000000e+00]
 [-7.57680725e-03  1.73606464e-02]]
grads:  [-0.00380783 -0.78535905]
Stock Position:  -0.0038078324880784407
Bond Position:  [4.77367585]


portfolio before change:  [4.3838578]
curr_Stock_Price:  102.52940370191432
curr_Factors:  [1.02529404e+02 3.63196561e-02]
mat_Sqrt:  [[ 1.95397632e+01  0.00000000e+00]
 [-7.62308663e-03  1.74666858e-02]]
grads:  [-5.13912627e-03 -7.63642666e+00]
Stock Position:  -0.0051391262689470234
Bond Position:  [4.91076935]


portfolio before change:  [4.38445718]
curr_Stock_Price:  102.53222722016767
curr_Factors:  [1.02532227e+02 3.61756239e-02]
mat_Sqrt:  [[ 1.95015175e+01  0.00000000e+00]
 [-7.60795624e-03  1.74320177e-02]]
grads:  [-0.0033592  -1.02627264]
Stock Position:  -0.003359201211935285
Bond Position:  [4.72888356]


portfolio before change:  [4.38444454]
curr_Stock_Price:  102.71196821867053
curr_Factors:  [1.02711968e+02 3.46723401e-02]
mat_Sqrt:  [[ 1.91254925e+01  0.00000000e+00]
 [-7.44820409e-03  1.70659795e-02]]
grads:  [-3.35181056e-03 -9.45974355e+00]
Stock Position:  -0.003351810563465951
Bond Position:  [4.7287156]


portfolio before change:  [4.38751739]
curr_Stock_Price:  101.97155335527813
curr_Factors:  [1.01971553e+02 3.34885426e-02]
mat_Sqrt:  [[ 1.86606668e+01  0.00000000e+00]
 [-7.31995001e-03  1.67721125e-02]]
grads:  [0.01917741 9.96035418]
Stock Position:  0.019177409873615523
Bond Position:  [2.43196712]


portfolio before change:  [4.40914279]
curr_Stock_Price:  103.08334992161183
curr_Factors:  [1.0308335e+02 3.4981796e-02]
mat_Sqrt:  [[ 1.92801130e+01  0.00000000e+00]
 [-7.48136843e-03  1.71419686e-02]]
grads:  [-8.53010078e-03 -3.80667754e+01]
Stock Position:  -0.00853010078160008
Bond Position:  [5.28845415]


portfolio before change:  [4.40827194]
curr_Stock_Price:  103.26294328437959
curr_Factors:  [1.03262943e+02 3.68319055e-02]
mat_Sqrt:  [[ 1.98178526e+01  0.00000000e+00]
 [-7.67665609e-03  1.75894288e-02]]
grads:  [-2.65824310e-03 -1.01374105e+01]
Stock Position:  -0.002658243103147889
Bond Position:  [4.68276994]


portfolio before change:  [4.40880784]
curr_Stock_Price:  103.2815583091378
curr_Factors:  [1.03281558e+02 3.83742024e-02]
mat_Sqrt:  [[ 2.02321699e+01  0.00000000e+00]
 [-7.83573378e-03  1.79539216e-02]]
grads:  [-1.68311978e-03 -8.65785568e+00]
Stock Position:  -0.00168311978282847
Bond Position:  [4.58264307]


portfolio before change:  [4.40960274]
curr_Stock_Price:  103.14963576881742
curr_Factors:  [1.03149636e+02 3.90344523e-02]
mat_Sqrt:  [[ 2.03794164e+01  0.00000000e+00]
 [-7.90285542e-03  1.81077166e-02]]
grads:  [-1.56419172e-02 -2.59164452e+01]
Stock Position:  -0.01564191719849741
Bond Position:  [6.02306081]


portfolio before change:  [4.43629513]
curr_Stock_Price:  101.4913057029788
curr_Factors:  [1.01491306e+02 4.04814065e-02]
mat_Sqrt:  [[ 2.04200422e+01  0.00000000e+00]
 [-8.04799667e-03  1.84402770e-02]]
grads:  [-2.08404254e-03 -4.30794001e+00]
Stock Position:  -0.002084042537424262
Bond Position:  [4.64780733]


portfolio before change:  [4.43524034]
curr_Stock_Price:  102.27622715022774
curr_Factors:  [1.02276227e+02 3.95185690e-02]
mat_Sqrt:  [[ 2.03317754e+01  0.00000000e+00]
 [-7.95171116e-03  1.82196592e-02]]
grads:  [ 0.00711076 -1.89299599]
Stock Position:  0.007110764636370938
Bond Position:  [3.70797816]


portfolio before change:  [4.4273082]
curr_Stock_Price:  101.0955298970938
curr_Factors:  [1.01095530e+02 3.99493664e-02]
mat_Sqrt:  [[ 2.02063048e+01  0.00000000e+00]
 [-7.99493504e-03  1.83186975e-02]]
grads:  [ 0.02977575 -6.70596876]
Stock Position:  0.029775747024064794
Bond Position:  [1.41711328]


portfolio before change:  [4.41095322]
curr_Stock_Price:  100.54030841425019
curr_Factors:  [1.00540308e+02 4.16792472e-02]
mat_Sqrt:  [[ 2.05258025e+01  0.00000000e+00]
 [-8.16619835e-03  1.87111110e-02]]
grads:  [-4.11041253e-03 -1.36869181e+01]
Stock Position:  -0.004110412530418835
Bond Position:  [4.82421536]


portfolio before change:  [4.40561893]
curr_Stock_Price:  101.9847750861805
curr_Factors:  [1.01984775e+02 4.07974726e-02]
mat_Sqrt:  [[ 2.05992767e+01  0.00000000e+00]
 [-8.07935370e-03  1.85121249e-02]]
grads:  [0.00300136 0.48725037]
Stock Position:  0.0030013607236226403
Bond Position:  [4.09952583]


portfolio before change:  [4.40929678]
curr_Stock_Price:  103.03942273077384
curr_Factors:  [1.03039423e+02 3.94781825e-02]
mat_Sqrt:  [[ 2.04730238e+01  0.00000000e+00]
 [-7.94764694e-03  1.82103469e-02]]
grads:  [ 1.31248246e-02 -1.75971315e+01]
Stock Position:  0.013124824583781548
Bond Position:  [3.05692243]


portfolio before change:  [4.42612441]
curr_Stock_Price:  104.29242960195374
curr_Factors:  [1.04292430e+02 3.87295064e-02]
mat_Sqrt:  [[ 2.05245558e+01  0.00000000e+00]
 [-7.87192545e-03  1.80368471e-02]]
grads:  [-0.01165095  0.89280891]
Stock Position:  -0.011650954302921136
Bond Position:  [5.64123075]


portfolio before change:  [4.4194722]
curr_Stock_Price:  104.92391560069687
curr_Factors:  [1.04923916e+02 3.84492530e-02]
mat_Sqrt:  [[ 2.05739861e+01  0.00000000e+00]
 [-7.84339242e-03  1.79714697e-02]]
grads:  [-4.06173334e-03  7.57494858e+00]
Stock Position:  -0.004061733341342069
Bond Position:  [4.84564516]


portfolio before change:  [4.42277647]
curr_Stock_Price:  104.25953620188855
curr_Factors:  [1.04259536e+02 3.92837084e-02]
mat_Sqrt:  [[ 2.06643633e+01  0.00000000e+00]
 [-7.92804727e-03  1.81654384e-02]]
grads:  [-1.29660883e-03  3.18981998e+00]
Stock Position:  -0.0012966088272514545
Bond Position:  [4.55796031]


portfolio before change:  [4.42400963]
curr_Stock_Price:  103.74791304064328
curr_Factors:  [1.03747913e+02 3.88493359e-02]
mat_Sqrt:  [[ 2.04489573e+01  0.00000000e+00]
 [-7.88409395e-03  1.80647287e-02]]
grads:  [1.57119066e-03 1.11450002e+01]
Stock Position:  0.0015711906572991234
Bond Position:  [4.26100188]


portfolio before change:  [4.42192983]
curr_Stock_Price:  102.0851881509264
curr_Factors:  [1.02085188e+02 3.92005089e-02]
mat_Sqrt:  [[ 2.02119672e+01  0.00000000e+00]
 [-7.91964735e-03  1.81461917e-02]]
grads:  [-0.03171851 -4.02400516]
Stock Position:  -0.031718513438412685
Bond Position:  [7.65992024]


portfolio before change:  [4.38384284]
curr_Stock_Price:  103.3161582424817
curr_Factors:  [1.03316158e+02 3.91412616e-02]
mat_Sqrt:  [[ 2.04402244e+01  0.00000000e+00]
 [-7.91366025e-03  1.81324736e-02]]
grads:  [-0.00848218 -2.01743333]
Stock Position:  -0.008482183341549559
Bond Position:  [5.26018944]


portfolio before change:  [4.38323221]
curr_Stock_Price:  103.46567036257404
curr_Factors:  [1.03465670e+02 3.71997549e-02]
mat_Sqrt:  [[ 1.99556701e+01  0.00000000e+00]
 [-7.71489519e-03  1.76770456e-02]]
grads:  [ 0.00313191 -0.9079204 ]
Stock Position:  0.003131911324884889
Bond Position:  [4.05918691]


portfolio before change:  [4.37960896]
curr_Stock_Price:  102.1467679941945
curr_Factors:  [1.02146768e+02 3.72086222e-02]
mat_Sqrt:  [[ 1.97036382e+01  0.00000000e+00]
 [-7.71581464e-03  1.76791523e-02]]
grads:  [-0.01169896  6.79841473]
Stock Position:  -0.01169895509019002
Bond Position:  [5.57461941]


portfolio before change:  [4.36916095]
curr_Stock_Price:  103.09940724444392
curr_Factors:  [1.03099407e+02 3.57398483e-02]
mat_Sqrt:  [[ 1.94909282e+01  0.00000000e+00]
 [-7.56199427e-03  1.73267056e-02]]
grads:  [0.00520607 3.07900776]
Stock Position:  0.0052060718124810924
Bond Position:  [3.83241803]


portfolio before change:  [4.36302236]
curr_Stock_Price:  101.82826219093606
curr_Factors:  [1.01828262e+02 3.56314643e-02]
mat_Sqrt:  [[ 1.92214067e+01  0.00000000e+00]
 [-7.55051938e-03  1.73004133e-02]]
grads:  [-0.00492511  4.7007632 ]
Stock Position:  -0.004925113566973866
Bond Position:  [4.86453811]


portfolio before change:  [4.36511656]
curr_Stock_Price:  101.5265231597202
curr_Factors:  [1.01526523e+02 3.66218072e-02]
mat_Sqrt:  [[ 1.94289531e+01  0.00000000e+00]
 [-7.65473000e-03  1.75391898e-02]]
grads:  [-0.0111359   3.85644941]
Stock Position:  -0.011135898062656103
Bond Position:  [5.49570557]


portfolio before change:  [4.37341793]
curr_Stock_Price:  100.84275600282103
curr_Factors:  [1.00842756e+02 3.86288829e-02]
mat_Sqrt:  [[ 1.98198691e+01  0.00000000e+00]
 [-7.86169273e-03  1.80134010e-02]]
grads:  [-6.05722254e-03 -1.24495350e+01]
Stock Position:  -0.006057222536222497
Bond Position:  [4.98424494]


portfolio before change:  [4.37703702]
curr_Stock_Price:  100.3481364707257
curr_Factors:  [1.00348136e+02 3.86229612e-02]
mat_Sqrt:  [[ 1.97211436e+01  0.00000000e+00]
 [-7.86109012e-03  1.80120203e-02]]
grads:  [ 0.001208   -0.82575651]
Stock Position:  0.0012080033385550048
Bond Position:  [4.25581613]


portfolio before change:  [4.37824754]
curr_Stock_Price:  100.90981515629076
curr_Factors:  [1.00909815e+02 3.86328511e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.37824754]
Stock Price:  100.46803524108151
PL:  [3.9102123]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.46420955e+00  3.59929658e-01]
 [ 2.15530735e-01  1.00040413e-01]
 [ 1.10896732e-01 -4.70030516e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.13245287e-01 -2.83241238e-01]
 [-3.49463898e-01  1.78447358e-01]
 [ 2.40181941e-01 -2.66398078e-01]
 [-6.50048076e-01  1.04419105e-01]
 [-1.05151988e-01 -7.72630956e-02]
 [-2.74228030e-01 -5.28231578e-01]
 [-6.92031935e-02 -1.27189154e-02]
 [-3.23837744e-02 -1.34502677e-01]
 [-6.52317619e-02 -1.89342232e-02]
 [-3.95730801e-02 -4.03678909e-02]
 [ 2.88773062e-01  1.69858182e-01]
 [ 1.35440748e-01 -3.90532661e-01]
 [ 3.67575310e-02 -6.33594244e-02]
 [ 1.46245657e-02 -1.06320295e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 2.29325000e-02 -9.74819700e-02]
 [ 1.56272330e-01 -3.33995530e-02]
 [ 3.70214234e-01 -3.69007005e-01]
 [ 2.71083374e-02 -3.32218669e-01]
 [ 2.76021186e-02  7.79774893e-02]
 [ 4.57913755e-01 -4.56587658e-01]
 [-4.14880414e-01  5.44966087e-02]
 [-1.52133644e-01  1.08462994e-01]
 [ 1.17134810e-02  2.81984905e-01]
 [-3.55863255e-02  1.91380087e-01]
 [-6.60442382e-01 -5.61084331e-02]
 [-1.52762117e-01 -2.67123560e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.71317529e-01  8.60010378e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.48599554e-01 -2.13975175e-02]
 [-2.96575388e-02 -1.56693544e-01]
 [-2.80366239e-04 -6.40857607e-02]
 [ 2.23497200e-01 -1.09008875e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.38510871]
curr_Stock_Price:  99.40970542822257
curr_Factors:  [9.94097054e+01 4.17739458e-02]
mat_Sqrt:  [[ 2.03180272e+01  0.00000000e+00]
 [-8.17547022e-03  1.87323556e-02]]
grads:  [ 0.07979592 19.2143298 ]
Stock Position:  0.07979592305464252
Bond Position:  [-9.31759792]


portfolio before change:  [-1.29083773]
curr_Stock_Price:  100.60570329781645
curr_Factors:  [1.00605703e+02 4.23393718e-02]
mat_Sqrt:  [[ 2.07011659e+01  0.00000000e+00]
 [-8.23061328e-03  1.88587042e-02]]
grads:  [0.01252065 5.3047342 ]
Stock Position:  0.012520645044435043
Bond Position:  [-2.55048603]


portfolio before change:  [-1.30691576]
curr_Stock_Price:  99.34704630809064
curr_Factors:  [9.93470463e+01 4.47323739e-02]
mat_Sqrt:  [[ 2.10119294e+01  0.00000000e+00]
 [-8.46001171e-03  1.93843220e-02]]
grads:  [ 0.0043015 -2.4247973]
Stock Position:  0.004301504953564331
Bond Position:  [-1.73425757]


portfolio before change:  [-1.29802224]
curr_Stock_Price:  101.46498313203153
curr_Factors:  [1.01464983e+02 4.28943893e-02]
mat_Sqrt:  [[ 2.10143728e+01  0.00000000e+00]
 [-8.28438428e-03  1.89819090e-02]]
grads:  [-7.75724649e-04 -7.97532072e+00]
Stock Position:  -0.0007757246490529013
Bond Position:  [-1.21931335]


portfolio before change:  [-1.29833634]
curr_Stock_Price:  101.67340173896802
curr_Factors:  [1.01673402e+02 4.18514141e-02]
mat_Sqrt:  [[ 2.07999563e+01  0.00000000e+00]
 [-8.18304726e-03  1.87497168e-02]]
grads:  [-1.13876152e-02 -1.51064276e+01]
Stock Position:  -0.011387615172246988
Bond Position:  [-0.14051877]


portfolio before change:  [-1.29834093]
curr_Stock_Price:  101.6722624744686
curr_Factors:  [1.01672262e+02 4.14233832e-02]
mat_Sqrt:  [[ 2.06930864e+01  0.00000000e+00]
 [-8.14109410e-03  1.86535900e-02]]
grads:  [-0.01312434  9.56638151]
Stock Position:  -0.01312433925403419
Bond Position:  [0.03604033]


portfolio before change:  [-1.30798582]
curr_Stock_Price:  102.40749109690097
curr_Factors:  [1.02407491e+02 4.21804762e-02]
mat_Sqrt:  [[ 2.10323338e+01  0.00000000e+00]
 [-8.21515441e-03  1.88232835e-02]]
grads:  [ 5.89170411e-03 -1.41525828e+01]
Stock Position:  0.005891704112074779
Bond Position:  [-1.91134045]


portfolio before change:  [-1.30003222]
curr_Stock_Price:  103.79800964671654
curr_Factors:  [1.03798010e+02 4.20634964e-02]
mat_Sqrt:  [[ 2.12883357e+01  0.00000000e+00]
 [-8.20375489e-03  1.87971639e-02]]
grads:  [-0.0283947   5.55504573]
Stock Position:  -0.028394697022409668
Bond Position:  [1.64728081]


portfolio before change:  [-1.31263829]
curr_Stock_Price:  104.24922027069145
curr_Factors:  [1.0424922e+02 4.1306524e-02]
mat_Sqrt:  [[ 2.11876183e+01  0.00000000e+00]
 [-8.12960260e-03  1.86272596e-02]]
grads:  [-0.00655441 -4.1478509 ]
Stock Position:  -0.006554411423523899
Bond Position:  [-0.62934601]


portfolio before change:  [-1.30584273]
curr_Stock_Price:  103.20042585856665
curr_Factors:  [1.03200426e+02 4.19177148e-02]
mat_Sqrt:  [[ 2.11290655e+01  0.00000000e+00]
 [-8.18952646e-03  1.87645625e-02]]
grads:  [-2.38897074e-02 -2.81504873e+01]
Stock Position:  -0.023889707367591474
Bond Position:  [1.15958524]


portfolio before change:  [-1.29819946]
curr_Stock_Price:  102.88655359456835
curr_Factors:  [1.02886554e+02 4.18392739e-02]
mat_Sqrt:  [[ 2.10450852e+01  0.00000000e+00]
 [-8.18186031e-03  1.87469971e-02]]
grads:  [-0.0035521  -0.67845081]
Stock Position:  -0.0035520969578728702
Bond Position:  [-0.93273645]


portfolio before change:  [-1.29613662]
curr_Stock_Price:  102.27299023423576
curr_Factors:  [1.02272990e+02 4.17086991e-02]
mat_Sqrt:  [[ 2.08869139e+01  0.00000000e+00]
 [-8.16908310e-03  1.87177208e-02]]
grads:  [-4.36089101e-03 -7.18584693e+00]
Stock Position:  -0.004360891012147298
Bond Position:  [-0.85013526]


portfolio before change:  [-1.29217988]
curr_Stock_Price:  101.34129506511483
curr_Factors:  [1.01341295e+02 4.39103431e-02]
mat_Sqrt:  [[ 2.12358606e+01  0.00000000e+00]
 [-8.38191798e-03  1.92053868e-02]]
grads:  [-0.00346091 -0.98588086]
Stock Position:  -0.003460906806077551
Bond Position:  [-0.9414471]


portfolio before change:  [-1.29066391]
curr_Stock_Price:  100.86926536591939
curr_Factors:  [1.00869265e+02 4.42162804e-02]
mat_Sqrt:  [[ 2.12104538e+01  0.00000000e+00]
 [-8.41106704e-03  1.92721757e-02]]
grads:  [-0.00269636 -2.09462033]
Stock Position:  -0.0026963624895015668
Bond Position:  [-1.01868381]


portfolio before change:  [-1.29366041]
curr_Stock_Price:  101.9333494311526
curr_Factors:  [1.01933349e+02 4.32974200e-02]
mat_Sqrt:  [[ 2.12103241e+01  0.00000000e+00]
 [-8.32321284e-03  1.90708764e-02]]
grads:  [0.01710984 8.90667938]
Stock Position:  0.01710983994869293
Bond Position:  [-3.03772371]


portfolio before change:  [-1.30712034]
curr_Stock_Price:  101.1688661181534
curr_Factors:  [1.01168866e+02 4.24155082e-02]
mat_Sqrt:  [[ 2.08357539e+01  0.00000000e+00]
 [-8.23801026e-03  1.88756528e-02]]
grads:  [-1.67988542e-03 -2.06897566e+01]
Stock Position:  -0.0016798854166818174
Bond Position:  [-1.13716824]


portfolio before change:  [-1.30753823]
curr_Stock_Price:  101.33300377716165
curr_Factors:  [1.01333004e+02 4.18787551e-02]
mat_Sqrt:  [[ 2.07370893e+01  0.00000000e+00]
 [-8.18571977e-03  1.87558402e-02]]
grads:  [ 4.39078555e-04 -3.37811709e+00]
Stock Position:  0.0004390785545131715
Bond Position:  [-1.35203137]


portfolio before change:  [-1.3081492]
curr_Stock_Price:  100.32644044467617
curr_Factors:  [1.00326440e+02 4.12460203e-02]
mat_Sqrt:  [[ 2.03754134e+01  0.00000000e+00]
 [-8.12364650e-03  1.86136125e-02]]
grads:  [-1.55959609e-03 -5.71196455e+00]
Stock Position:  -0.001559596089402421
Bond Position:  [-1.15168048]


portfolio before change:  [-1.3090908]
curr_Stock_Price:  100.83787279250147
curr_Factors:  [1.00837873e+02 4.16010708e-02]
mat_Sqrt:  [[ 2.05672359e+01  0.00000000e+00]
 [-8.15853622e-03  1.86935549e-02]]
grads:  [-1.54990756e-02 -2.51042483e+01]
Stock Position:  -0.0154990755897937
Bond Position:  [0.25380301]


portfolio before change:  [-1.33019575]
curr_Stock_Price:  102.2016106556313
curr_Factors:  [1.02201611e+02 4.09928214e-02]
mat_Sqrt:  [[ 2.06924372e+01  0.00000000e+00]
 [-8.09867361e-03  1.85563924e-02]]
grads:  [-9.47791673e-04 -5.25328241e+00]
Stock Position:  -0.0009477916729104988
Bond Position:  [-1.23332991]


portfolio before change:  [-1.33063364]
curr_Stock_Price:  102.50096045114744
curr_Factors:  [1.02500960e+02 3.96370137e-02]
mat_Sqrt:  [[ 2.04069640e+01  0.00000000e+00]
 [-7.96361864e-03  1.82469426e-02]]
grads:  [ 0.00694349 -1.83041914]
Stock Position:  0.00694349098099266
Bond Position:  [-2.04234814]


portfolio before change:  [-1.32036638]
curr_Stock_Price:  104.01641896407678
curr_Factors:  [1.04016419e+02 3.96226875e-02]
mat_Sqrt:  [[ 2.07049346e+01  0.00000000e+00]
 [-7.96217935e-03  1.82436448e-02]]
grads:  [ 1.01022475e-02 -2.02266055e+01]
Stock Position:  0.010102247500536966
Bond Position:  [-2.37116599]


portfolio before change:  [-1.30977423]
curr_Stock_Price:  105.09425516227282
curr_Factors:  [1.05094255e+02 3.88796256e-02]
mat_Sqrt:  [[ 2.07223981e+01  0.00000000e+00]
 [-7.88716685e-03  1.80717696e-02]]
grads:  [-5.68871304e-03 -1.83832949e+01]
Stock Position:  -0.005688713041743539
Bond Position:  [-0.71192317]


portfolio before change:  [-1.31116401]
curr_Stock_Price:  105.32291547779559
curr_Factors:  [1.05322915e+02 3.93873107e-02]
mat_Sqrt:  [[ 2.09026350e+01  0.00000000e+00]
 [-7.93849464e-03  1.81893763e-02]]
grads:  [2.94863710e-03 4.28697983e+00]
Stock Position:  0.002948637098011364
Bond Position:  [-1.62172306]


portfolio before change:  [-1.30938696]
curr_Stock_Price:  105.99433594272429
curr_Factors:  [1.05994336e+02 3.94953253e-02]
mat_Sqrt:  [[ 2.10647110e+01  0.00000000e+00]
 [-7.94937234e-03  1.82143002e-02]]
grads:  [ 1.22784767e-02 -2.50675377e+01]
Stock Position:  0.012278476723727007
Bond Position:  [-2.61083595]


portfolio before change:  [-1.31321567]
curr_Stock_Price:  105.70909403657964
curr_Factors:  [1.05709094e+02 3.88539763e-02]
mat_Sqrt:  [[ 2.08367550e+01  0.00000000e+00]
 [-7.88456480e-03  1.80658075e-02]]
grads:  [-0.01876953  3.01656091]
Stock Position:  -0.01876953214547925
Bond Position:  [0.67089457]


portfolio before change:  [-1.2801943]
curr_Stock_Price:  103.95425514826145
curr_Factors:  [1.03954255e+02 4.00030532e-02]
mat_Sqrt:  [[ 2.07916445e+01  0.00000000e+00]
 [-8.00030531e-03  1.83310023e-02]]
grads:  [-5.04031862e-03  5.91691562e+00]
Stock Position:  -0.005040318619335171
Bond Position:  [-0.75623173]


portfolio before change:  [-1.27052064]
curr_Stock_Price:  102.01624335256099
curr_Factors:  [1.02016243e+02 4.08943865e-02]
mat_Sqrt:  [[ 2.06300925e+01  0.00000000e+00]
 [-8.08894420e-03  1.85340996e-02]]
grads:  [6.53326121e-03 1.52143839e+01]
Stock Position:  0.00653326121392394
Bond Position:  [-1.9370194]


portfolio before change:  [-1.26896096]
curr_Stock_Price:  102.29203440488504
curr_Factors:  [1.02292034e+02 3.92730829e-02]
mat_Sqrt:  [[ 2.02716600e+01  0.00000000e+00]
 [-7.92697500e-03  1.81629815e-02]]
grads:  [2.36481828e-03 1.05368211e+01]
Stock Position:  0.0023648182772438645
Bond Position:  [-1.51086304]


portfolio before change:  [-1.26721503]
curr_Stock_Price:  103.1101972085476
curr_Factors:  [1.03110197e+02 3.91850838e-02]
mat_Sqrt:  [[ 2.04108931e+01  0.00000000e+00]
 [-7.91808905e-03  1.81426212e-02]]
grads:  [-0.03355709 -3.09263102]
Stock Position:  -0.033557086733856684
Bond Position:  [2.1928628]


portfolio before change:  [-1.29529312]
curr_Stock_Price:  103.95509221503634
curr_Factors:  [1.03955092e+02 3.96098635e-02]
mat_Sqrt:  [[ 2.06893783e+01  0.00000000e+00]
 [-7.96089075e-03  1.82406922e-02]]
grads:  [-0.00794709 -1.46443763]
Stock Position:  -0.007947089670357175
Bond Position:  [-0.46915268]


portfolio before change:  [-1.29839053]
curr_Stock_Price:  104.3374666420589
curr_Factors:  [1.04337467e+02 3.91103012e-02]
mat_Sqrt:  [[ 2.06341160e+01  0.00000000e+00]
 [-7.91052981e-03  1.81253008e-02]]
grads:  [ 0.00351566 -0.65914432]
Stock Position:  0.003515662930803261
Bond Position:  [-1.66520589]


portfolio before change:  [-1.30349225]
curr_Stock_Price:  102.94553613288316
curr_Factors:  [1.02945536e+02 3.98544385e-02]
mat_Sqrt:  [[ 2.05516108e+01  0.00000000e+00]
 [-7.98543059e-03  1.82969201e-02]]
grads:  [-0.01137544  4.70030134]
Stock Position:  -0.011375439156045487
Bond Position:  [-0.13244157]


portfolio before change:  [-1.30976811]
curr_Stock_Price:  103.49578325253158
curr_Factors:  [1.03495783e+02 4.06001850e-02]
mat_Sqrt:  [[ 2.08538700e+01  0.00000000e+00]
 [-8.05979503e-03  1.84673104e-02]]
grads:  [0.00486582 2.88883761]
Stock Position:  0.00486581971286374
Bond Position:  [-1.81335993]


portfolio before change:  [-1.30587541]
curr_Stock_Price:  104.34237882835025
curr_Factors:  [1.04342379e+02 4.03299099e-02]
mat_Sqrt:  [[ 2.09543580e+01  0.00000000e+00]
 [-8.03292324e-03  1.84057394e-02]]
grads:  [-0.0045178   4.41846667]
Stock Position:  -0.00451780058054379
Bond Position:  [-0.83447735]


portfolio before change:  [-1.31027196]
curr_Stock_Price:  105.29244999380961
curr_Factors:  [1.05292450e+02 4.03797429e-02]
mat_Sqrt:  [[ 2.11582140e+01  0.00000000e+00]
 [-8.03788459e-03  1.84171073e-02]]
grads:  [-0.01691722 -1.16182836]
Stock Position:  -0.016917221651286715
Bond Position:  [0.47098375]


portfolio before change:  [-1.32312721]
curr_Stock_Price:  106.05582188392235
curr_Factors:  [1.06055822e+02 3.87610772e-02]
mat_Sqrt:  [[ 2.08800932e+01  0.00000000e+00]
 [-7.87513324e-03  1.80441971e-02]]
grads:  [-4.69558286e-03 -8.68387454e+00]
Stock Position:  -0.00469558286183566
Bond Position:  [-0.82513332]


portfolio before change:  [-1.32869746]
curr_Stock_Price:  107.22012853797571
curr_Factors:  [1.07220129e+02 3.73399264e-02]
mat_Sqrt:  [[ 2.07187262e+01  0.00000000e+00]
 [-7.72941668e-03  1.77103185e-02]]
grads:  [-1.36348562e-03 -3.61855495e+00]
Stock Position:  -0.0013634856171220794
Bond Position:  [-1.18250436]


portfolio before change:  [-1.32892667]
curr_Stock_Price:  107.27981808695992
curr_Factors:  [1.07279818e+02 3.86122392e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.32892667]
Stock Price:  107.32709496378534
PL:  [-8.65602163]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.38222152e+00  3.41393806e-01]
 [ 4.61705546e-01  1.25089548e-01]
 [ 1.10595216e-01 -4.74954238e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.67151226e-02  4.02675452e-01]
 [-8.36248374e-03 -1.01979112e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.43857618e-01  8.38279146e-01]
 [-8.01061751e-05  3.32089270e-01]
 [ 1.73926731e-01  7.19682969e-02]
 [-1.68374406e-02  2.00097782e-02]
 [ 6.38155926e-02 -9.81429129e-02]
 [-8.21463803e-02  1.15634427e-01]
 [-1.33498479e-01  3.66350420e-01]
 [ 1.74883829e-01  1.73433550e-01]
 [ 1.31062158e-01 -1.16681318e-01]
 [ 3.74280252e-02 -4.46089274e-02]
 [ 3.31400986e-01  6.49832538e-02]
 [ 3.69208302e-01  3.81277216e-01]
 [-7.67977483e-01  3.70212758e-01]
 [-4.76584383e-02  2.11721889e-01]
 [ 1.79267995e+00  2.64604202e-01]
 [ 1.40212345e-02  3.91861504e-01]
 [-1.68194178e-01  2.49894766e-01]
 [-1.65532143e-01  7.62695868e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 3.40015990e-01 -4.29061145e-01]
 [ 1.30531538e-01 -7.56255651e-02]
 [ 7.42578701e-01 -3.20016247e-01]
 [-7.93434085e-01 -3.59460704e-01]
 [ 7.31331385e-01  2.72966356e-01]
 [-2.77376061e-01  4.28813537e-01]
 [ 8.64495977e-01  1.53390515e-01]
 [ 6.49561285e-02 -1.37421113e-01]
 [ 3.25222192e-01 -4.53531862e-01]
 [ 1.44579062e-01  7.21568319e-03]
 [-8.19553106e-02  5.89831595e-01]
 [-3.87695283e-01 -1.43644249e-01]
 [-1.30693241e-01  5.63550041e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.03460089]
curr_Stock_Price:  99.76093829171903
curr_Factors:  [9.97609383e+01 4.02145453e-02]
mat_Sqrt:  [[ 2.00056242e+01  0.00000000e+00]
 [-8.02142583e-03  1.83793955e-02]]
grads:  [ 0.07653938 18.57481141]
Stock Position:  0.07653937579557861
Bond Position:  [-6.60103905]


portfolio before change:  [1.04167786]
curr_Stock_Price:  99.86418120481235
curr_Factors:  [9.98641812e+01 3.83607044e-02]
mat_Sqrt:  [[ 1.95592876e+01  0.00000000e+00]
 [-7.83435556e-03  1.79507637e-02]]
grads:  [0.02639662 6.96848056]
Stock Position:  0.026396620963148324
Bond Position:  [-1.59439908]


portfolio before change:  [1.02719831]
curr_Stock_Price:  99.32319371182135
curr_Factors:  [9.93231937e+01 3.86080388e-02]
mat_Sqrt:  [[ 1.95159432e+01  0.00000000e+00]
 [-7.85957137e-03  1.80085404e-02]]
grads:  [ 0.00460477 -2.63738331]
Stock Position:  0.004604774307837005
Bond Position:  [0.56983741]


portfolio before change:  [1.03066595]
curr_Stock_Price:  100.06077909148244
curr_Factors:  [1.00060779e+02 3.92155298e-02]
mat_Sqrt:  [[ 1.98149474e+01  0.00000000e+00]
 [-7.92116454e-03  1.81496680e-02]]
grads:  [-8.22680305e-04 -8.34102376e+00]
Stock Position:  -0.0008226803052449284
Bond Position:  [1.11298399]


portfolio before change:  [1.03214267]
curr_Stock_Price:  98.43489598317196
curr_Factors:  [9.84348960e+01 3.97534489e-02]
mat_Sqrt:  [[ 1.96262123e+01  0.00000000e+00]
 [-7.97530678e-03  1.82737235e-02]]
grads:  [4.53611991e-03 2.20357636e+01]
Stock Position:  0.004536119909574145
Bond Position:  [0.58563018]


portfolio before change:  [1.03064537]
curr_Stock_Price:  98.08867285628244
curr_Factors:  [9.80886729e+01 4.07566641e-02]
mat_Sqrt:  [[ 1.98024157e+01  0.00000000e+00]
 [-8.07531191e-03  1.85028641e-02]]
grads:  [-2.66986703e-03 -5.51153115e+00]
Stock Position:  -0.002669867032081267
Bond Position:  [1.29252908]


portfolio before change:  [1.03200143]
curr_Stock_Price:  97.64127763318481
curr_Factors:  [9.76412776e+01 4.24903553e-02]
mat_Sqrt:  [[ 2.01269809e+01  0.00000000e+00]
 [-8.24527553e-03  1.88922996e-02]]
grads:  [0.00642788 5.08868105]
Stock Position:  0.006427877967975437
Bond Position:  [0.40437521]


portfolio before change:  [1.03347277]
curr_Stock_Price:  97.86231406122326
curr_Factors:  [9.78623141e+01 4.25218885e-02]
mat_Sqrt:  [[ 2.01800275e+01  0.00000000e+00]
 [-8.24833448e-03  1.88993085e-02]]
grads:  [ 0.05994603 44.3550167 ]
Stock Position:  0.05994603492596008
Bond Position:  [-4.83298492]


portfolio before change:  [1.03642099]
curr_Stock_Price:  97.92157364235533
curr_Factors:  [9.79215736e+01 4.26856067e-02]
mat_Sqrt:  [[ 2.02310821e+01  0.00000000e+00]
 [-8.26419813e-03  1.89356567e-02]]
grads:  [7.16004872e-03 1.75377741e+01]
Stock Position:  0.00716004871742319
Bond Position:  [0.33529775]


portfolio before change:  [1.02595751]
curr_Stock_Price:  96.45435041206785
curr_Factors:  [9.64543504e+01 4.25806897e-02]
mat_Sqrt:  [[ 1.99034410e+01  0.00000000e+00]
 [-8.25403559e-03  1.89123714e-02]]
grads:  [0.01031662 3.80535551]
Stock Position:  0.010316621668767201
Bond Position:  [0.03087447]


portfolio before change:  [1.02040833]
curr_Stock_Price:  95.91608826770698
curr_Factors:  [9.59160883e+01 4.52078129e-02]
mat_Sqrt:  [[ 2.03938024e+01  0.00000000e+00]
 [-8.50485159e-03  1.94870631e-02]]
grads:  [-3.97398055e-04  1.02682370e+00]
Stock Position:  -0.000397398054870153
Bond Position:  [1.05852519]


portfolio before change:  [1.02062519]
curr_Stock_Price:  95.70335763987987
curr_Factors:  [9.57033576e+01 4.53500691e-02]
mat_Sqrt:  [[ 2.03805618e+01  0.00000000e+00]
 [-8.51822227e-03  1.95176992e-02]]
grads:  [ 1.02953559e-03 -5.02840586e+00]
Stock Position:  0.0010295355946038736
Bond Position:  [0.92209518]


portfolio before change:  [1.01995005]
curr_Stock_Price:  94.93562693431736
curr_Factors:  [9.49356269e+01 4.82454930e-02]
mat_Sqrt:  [[ 2.08524744e+01  0.00000000e+00]
 [-8.78594268e-03  2.01311237e-02]]
grads:  [-1.51921437e-03  5.74406223e+00]
Stock Position:  -0.0015192143685604548
Bond Position:  [1.16417762]


portfolio before change:  [1.01979763]
curr_Stock_Price:  95.13175323621456
curr_Factors:  [9.51317532e+01 5.08710730e-02]
mat_Sqrt:  [[ 2.14566022e+01  0.00000000e+00]
 [-9.02184664e-03  2.06716476e-02]]
grads:  [1.22992224e-03 1.77223620e+01]
Stock Position:  0.0012299222372268988
Bond Position:  [0.90279297]


portfolio before change:  [1.01878839]
curr_Stock_Price:  94.21942560762596
curr_Factors:  [9.42194256e+01 5.13983458e-02]
mat_Sqrt:  [[ 2.13606775e+01  0.00000000e+00]
 [-9.06848131e-03  2.07785010e-02]]
grads:  [0.01173073 8.34677871]
Stock Position:  0.011730734441840427
Bond Position:  [-0.08647467]


portfolio before change:  [1.00898838]
curr_Stock_Price:  93.38493438220901
curr_Factors:  [9.33849344e+01 5.25237692e-02]
mat_Sqrt:  [[ 2.14020197e+01  0.00000000e+00]
 [-9.16722590e-03  2.10047533e-02]]
grads:  [ 3.74442493e-03 -5.55499590e+00]
Stock Position:  0.003744424928743491
Bond Position:  [0.65931551]


portfolio before change:  [1.0080277]
curr_Stock_Price:  93.1063593901701
curr_Factors:  [9.31063594e+01 5.26770313e-02]
mat_Sqrt:  [[ 2.13692850e+01  0.00000000e+00]
 [-9.18059094e-03  2.10353765e-02]]
grads:  [ 8.40416195e-04 -2.12066218e+00]
Stock Position:  0.0008404161947297606
Bond Position:  [0.92977961]


portfolio before change:  [1.00829382]
curr_Stock_Price:  93.28470467013037
curr_Factors:  [9.32847047e+01 5.18864538e-02]
mat_Sqrt:  [[ 2.12489481e+01  0.00000000e+00]
 [-9.11143930e-03  2.08769301e-02]]
grads:  [0.01693081 3.11268244]
Stock Position:  0.016930814714824848
Bond Position:  [-0.57109224]


portfolio before change:  [0.9970269]
curr_Stock_Price:  92.62345338801181
curr_Factors:  [9.26234534e+01 5.27031061e-02]
mat_Sqrt:  [[ 2.12637117e+01  0.00000000e+00]
 [-9.18286283e-03  2.10405820e-02]]
grads:  [ 0.02518899 18.1210394 ]
Stock Position:  0.025188985286111062
Bond Position:  [-1.3360639]


portfolio before change:  [0.99510937]
curr_Stock_Price:  92.55395815359596
curr_Factors:  [9.25539582e+01 5.27110106e-02]
mat_Sqrt:  [[ 2.12493509e+01  0.00000000e+00]
 [-9.18355143e-03  2.10421598e-02]]
grads:  [-0.0285375  17.59385734]
Stock Position:  -0.028537501816710706
Bond Position:  [3.63636812]


portfolio before change:  [0.97978288]
curr_Stock_Price:  93.10695201735729
curr_Factors:  [9.3106952e+01 5.1795286e-02]
mat_Sqrt:  [[ 2.11898180e+01  0.00000000e+00]
 [-9.10343109e-03  2.08585810e-02]]
grads:  [2.11160708e-03 1.01503496e+01]
Stock Position:  0.00211160707806153
Bond Position:  [0.78317758]


portfolio before change:  [0.97862394]
curr_Stock_Price:  92.51174604825556
curr_Factors:  [9.25117460e+01 5.26660318e-02]
mat_Sqrt:  [[ 2.12305955e+01  0.00000000e+00]
 [-9.17963240e-03  2.10331802e-02]]
grads:  [ 0.08987796 12.58032309]
Stock Position:  0.08987796336826659
Bond Position:  [-7.33614338]


portfolio before change:  [0.9356945]
curr_Stock_Price:  92.04430816153553
curr_Factors:  [9.20443082e+01 5.27250484e-02]
mat_Sqrt:  [[ 2.11351547e+01  0.00000000e+00]
 [-9.18477422e-03  2.10449615e-02]]
grads:  [8.75525248e-03 1.86202053e+01]
Stock Position:  0.008755252481959989
Bond Position:  [0.12982334]


portfolio before change:  [0.92532127]
curr_Stock_Price:  90.85765388582621
curr_Factors:  [9.08576539e+01 5.26002212e-02]
mat_Sqrt:  [[ 2.08379650e+01  0.00000000e+00]
 [-9.17389524e-03  2.10200347e-02]]
grads:  [-2.83766484e-03  1.18884088e+01]
Stock Position:  -0.0028376648392653895
Bond Position:  [1.18314484]


portfolio before change:  [0.92116591]
curr_Stock_Price:  92.37413428860644
curr_Factors:  [9.23741343e+01 5.14686979e-02]
mat_Sqrt:  [[ 2.09566554e+01  0.00000000e+00]
 [-9.07468548e-03  2.07927166e-02]]
grads:  [-0.00631042  3.66809149]
Stock Position:  -0.006310423317570488
Bond Position:  [1.5040858]


portfolio before change:  [0.9229357]
curr_Stock_Price:  92.12347438201637
curr_Factors:  [9.21234744e+01 5.00137426e-02]
mat_Sqrt:  [[ 2.06022658e+01  0.00000000e+00]
 [-8.94550100e-03  2.04967177e-02]]
grads:  [ 0.00890575 -3.56132812]
Stock Position:  0.00890574873901067
Bond Position:  [0.10250719]


portfolio before change:  [0.92074275]
curr_Stock_Price:  91.87579466346766
curr_Factors:  [9.18757947e+01 4.99216749e-02]
mat_Sqrt:  [[ 2.05279548e+01  0.00000000e+00]
 [-8.93726356e-03  2.04778434e-02]]
grads:  [ 7.44147949e-03 -2.09524576e+01]
Stock Position:  0.007441479487092108
Bond Position:  [0.2370509]


portfolio before change:  [0.91599686]
curr_Stock_Price:  91.23405101418786
curr_Factors:  [9.12340510e+01 5.04963217e-02]
mat_Sqrt:  [[ 2.05015563e+01  0.00000000e+00]
 [-8.98855466e-03  2.05953660e-02]]
grads:  [ 0.004757   -3.67196994]
Stock Position:  0.004756996666340649
Bond Position:  [0.48199678]


portfolio before change:  [0.9157061]
curr_Stock_Price:  91.1602637057228
curr_Factors:  [9.11602637e+01 4.99582582e-02]
mat_Sqrt:  [[ 2.03755442e+01  0.00000000e+00]
 [-8.94053763e-03  2.04853452e-02]]
grads:  [  0.02958999 -15.6217161 ]
Stock Position:  0.02958999056918876
Bond Position:  [-1.78172524]


portfolio before change:  [0.88187375]
curr_Stock_Price:  90.02441918148587
curr_Factors:  [9.00244192e+01 4.94674586e-02]
mat_Sqrt:  [[ 2.00225842e+01  0.00000000e+00]
 [-8.89651245e-03  2.03844709e-02]]
grads:  [ -0.04746219 -17.63404636]
Stock Position:  -0.04746218525633571
Bond Position:  [5.15462941]


portfolio before change:  [0.93499058]
curr_Stock_Price:  88.91885564707893
curr_Factors:  [8.89188556e+01 4.87220962e-02]
mat_Sqrt:  [[ 1.96271322e+01  0.00000000e+00]
 [-8.82923292e-03  2.02303141e-02]]
grads:  [ 0.04333102 13.49293712]
Stock Position:  0.043331020628524626
Bond Position:  [-2.91795419]


portfolio before change:  [0.94047478]
curr_Stock_Price:  89.05383919554633
curr_Factors:  [8.90538392e+01 4.84785314e-02]
mat_Sqrt:  [[ 1.96077326e+01  0.00000000e+00]
 [-8.80713633e-03  2.01796844e-02]]
grads:  [-4.60157698e-03  2.12497643e+01]
Stock Position:  -0.0046015769757442645
Bond Position:  [1.35026288]


portfolio before change:  [0.93885055]
curr_Stock_Price:  89.4434949752429
curr_Factors:  [8.94434950e+01 4.88729874e-02]
mat_Sqrt:  [[ 1.97734843e+01  0.00000000e+00]
 [-8.84289431e-03  2.02616163e-02]]
grads:  [0.04710556 7.57049747]
Stock Position:  0.04710556172186394
Bond Position:  [-3.27443553]


portfolio before change:  [0.98111068]
curr_Stock_Price:  90.34932152279855
curr_Factors:  [9.03493215e+01 4.92243716e-02]
mat_Sqrt:  [[ 2.00454120e+01  0.00000000e+00]
 [-8.87462645e-03  2.03343237e-02]]
grads:  [ 2.48467721e-04 -6.75808621e+00]
Stock Position:  0.0002484677209559401
Bond Position:  [0.95866179]


portfolio before change:  [0.98115067]
curr_Stock_Price:  90.02794582401539
curr_Factors:  [9.00279458e+01 4.98807350e-02]
mat_Sqrt:  [[ 2.01068373e+01  0.00000000e+00]
 [-8.93359815e-03  2.04694449e-02]]
grads:  [ 6.33041678e-03 -2.21565296e+01]
Stock Position:  0.006330416783158584
Bond Position:  [0.41123625]


portfolio before change:  [0.97986791]
curr_Stock_Price:  89.81719084489039
curr_Factors:  [8.98171908e+01 4.95731984e-02]
mat_Sqrt:  [[ 1.99978330e+01  0.00000000e+00]
 [-8.90601580e-03  2.04062458e-02]]
grads:  [0.00738721 0.3536017 ]
Stock Position:  0.007387212608841389
Bond Position:  [0.31636923]


portfolio before change:  [0.98096954]
curr_Stock_Price:  89.96096339462869
curr_Factors:  [8.99609634e+01 4.84595735e-02]
mat_Sqrt:  [[ 1.98035884e+01  0.00000000e+00]
 [-8.80541411e-03  2.01757383e-02]]
grads:  [8.86042964e-03 2.92346969e+01]
Stock Position:  0.008860429644537501
Bond Position:  [0.18387675]


portfolio before change:  [0.98748399]
curr_Stock_Price:  90.69359889346335
curr_Factors:  [9.06935989e+01 4.66539944e-02]
mat_Sqrt:  [[ 1.95893963e+01  0.00000000e+00]
 [-8.63981430e-03  1.97963015e-02]]
grads:  [-0.02299136 -7.25611545]
Stock Position:  -0.022991355445447774
Bond Position:  [3.07265276]


portfolio before change:  [0.98729173]
curr_Stock_Price:  90.71866792542755
curr_Factors:  [9.07186679e+01 4.76684293e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.98729173]
Stock Price:  89.50261304370319
PL:  [0.98729173]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.36141553e+00  3.36689988e-01]
 [ 1.03720364e+00  7.41595003e-02]
 [ 1.11031933e-01 -2.75433114e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.19263198e-01 -4.06534606e-01]
 [-3.30970146e-01  1.57553847e-01]
 [ 1.48102094e-01 -1.24285731e-01]
 [ 4.17801109e-01  5.10369263e-01]
 [-7.40569094e-02  8.86539566e-02]
 [ 1.43359365e-01 -2.65201943e-03]
 [-1.05668316e-01  4.27790479e-03]
 [ 2.07896540e-02 -1.35836176e-01]
 [-1.10913656e-01 -2.63530476e-02]
 [-4.20735789e-02 -3.85271530e-02]
 [ 2.74391769e-01  1.59397826e-01]
 [ 1.27267787e-01 -5.70545669e-01]
 [ 2.85500901e-02 -1.42571508e-01]
 [ 2.78722068e-02 -1.48992853e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.40517930e-01 -2.82553186e-02]
 [ 4.21195025e-01 -3.27253739e-01]
 [ 2.83293241e-02 -3.62412883e-01]
 [ 3.53553626e-02  4.09853557e-02]
 [ 4.57489555e-01 -4.55270618e-01]
 [-4.74529219e-01  6.72507313e-02]
 [-1.25001678e-01  1.90472560e-01]
 [-1.40530953e-01 -3.36246832e-01]
 [-7.80295263e-02  2.25299709e-01]
 [-5.13106046e-01  6.68284530e-01]
 [-1.19896259e-01  2.71092336e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.15636810e-01 -7.74081697e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.04926714e-01 -8.13527594e-02]
 [-3.00549194e-02 -1.53014008e-01]
 [-3.35673470e-03 -6.42629775e-02]
 [ 2.11184065e-01 -1.21457363e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.64031288]
curr_Stock_Price:  99.84886039457726
curr_Factors:  [9.98488604e+01 3.94729024e-02]
mat_Sqrt:  [[ 1.98377605e+01  0.00000000e+00]
 [-7.94711544e-03  1.82091290e-02]]
grads:  [ 0.07603475 18.49017533]
Stock Position:  0.07603474609788516
Bond Position:  [-5.95166987]


portfolio before change:  [1.53655898]
curr_Stock_Price:  98.49408634955574
curr_Factors:  [9.84940863e+01 4.05139743e-02]
mat_Sqrt:  [[ 1.98249719e+01  0.00000000e+00]
 [-8.05123338e-03  1.84476932e-02]]
grads:  [0.05395062 4.01998773]
Stock Position:  0.05395061882365788
Bond Position:  [-3.77725793]


portfolio before change:  [1.61557197]
curr_Stock_Price:  99.96738148655842
curr_Factors:  [9.99673815e+01 4.05615466e-02]
mat_Sqrt:  [[ 2.01333280e+01  0.00000000e+00]
 [-8.05595895e-03  1.84585208e-02]]
grads:  [ 0.00491777 -1.49217327]
Stock Position:  0.004917768503095167
Bond Position:  [1.12395553]


portfolio before change:  [1.61873639]
curr_Stock_Price:  100.58227583655632
curr_Factors:  [1.00582276e+02 4.09370909e-02]
mat_Sqrt:  [[ 2.03507278e+01  0.00000000e+00]
 [-8.09316659e-03  1.85437742e-02]]
grads:  [-8.01021324e-04 -8.16375407e+00]
Stock Position:  -0.0008010213236182483
Bond Position:  [1.69930493]


portfolio before change:  [1.61766888]
curr_Stock_Price:  102.1801570914929
curr_Factors:  [1.02180157e+02 4.29060751e-02]
mat_Sqrt:  [[ 2.11653747e+01  0.00000000e+00]
 [-8.28551267e-03  1.89844945e-02]]
grads:  [-1.40176798e-02 -2.14140338e+01]
Stock Position:  -0.014017679846115098
Bond Position:  [3.0499976]


portfolio before change:  [1.6283293]
curr_Stock_Price:  101.4468580449913
curr_Factors:  [1.01446858e+02 4.29485474e-02]
mat_Sqrt:  [[ 2.10238786e+01  0.00000000e+00]
 [-8.28961253e-03  1.89938884e-02]]
grads:  [-0.01247191  8.29497589]
Stock Position:  -0.012471914164891434
Bond Position:  [2.89356581]


portfolio before change:  [1.63112115]
curr_Stock_Price:  101.25200975787389
curr_Factors:  [1.01252010e+02 4.30946558e-02]
mat_Sqrt:  [[ 2.10191602e+01  0.00000000e+00]
 [-8.30370094e-03  1.90261691e-02]]
grads:  [ 4.46541884e-03 -6.53235715e+00]
Stock Position:  0.0044654188368503595
Bond Position:  [1.17898852]


portfolio before change:  [1.6256094]
curr_Stock_Price:  99.98468646791329
curr_Factors:  [9.99846865e+01 4.45066923e-02]
mat_Sqrt:  [[ 2.10933786e+01  0.00000000e+00]
 [-8.43864371e-03  1.93353618e-02]]
grads:  [ 0.03036709 26.39564075]
Stock Position:  0.030367089479524687
Bond Position:  [-1.41063452]


portfolio before change:  [1.62233013]
curr_Stock_Price:  99.88250557294673
curr_Factors:  [9.98825056e+01 4.40199469e-02]
mat_Sqrt:  [[ 2.09562797e+01  0.00000000e+00]
 [-8.39237243e-03  1.92293410e-02]]
grads:  [-1.68756818e-03  4.61034815e+00]
Stock Position:  -0.0016875681751194651
Bond Position:  [1.79088866]


portfolio before change:  [1.62104697]
curr_Stock_Price:  100.77552322079855
curr_Factors:  [1.00775523e+02 4.22994620e-02]
mat_Sqrt:  [[ 2.07263336e+01  0.00000000e+00]
 [-8.22673320e-03  1.88498138e-02]]
grads:  [ 0.00686093 -0.14069208]
Stock Position:  0.006860930266267372
Bond Position:  [0.92963314]


portfolio before change:  [1.60745719]
curr_Stock_Price:  98.77783634727281
curr_Factors:  [9.87778363e+01 4.29670300e-02]
mat_Sqrt:  [[ 2.04751540e+01  0.00000000e+00]
 [-8.29139602e-03  1.89979749e-02]]
grads:  [-0.00506962  0.22517688]
Stock Position:  -0.0050696217079331096
Bond Position:  [2.10822346]


portfolio before change:  [1.60094222]
curr_Stock_Price:  100.11492298737485
curr_Factors:  [1.00114923e+02 4.35665567e-02]
mat_Sqrt:  [[ 2.08965907e+01  0.00000000e+00]
 [-8.34904131e-03  1.91300569e-02]]
grads:  [-1.84212410e-03 -7.10066763e+00]
Stock Position:  -0.0018421241038193048
Bond Position:  [1.78536633]


portfolio before change:  [1.60098136]
curr_Stock_Price:  100.214828991929
curr_Factors:  [1.00214829e+02 4.38139693e-02]
mat_Sqrt:  [[ 2.09767542e+01  0.00000000e+00]
 [-8.37271466e-03  1.91842994e-02]]
grads:  [-0.00583575 -1.37367787]
Stock Position:  -0.005835748816276382
Bond Position:  [2.18580993]


portfolio before change:  [1.59964116]
curr_Stock_Price:  100.49130523061575
curr_Factors:  [1.00491305e+02 4.40761128e-02]
mat_Sqrt:  [[ 2.10974579e+01  0.00000000e+00]
 [-8.39772472e-03  1.92416046e-02]]
grads:  [-0.00279125 -2.00228379]
Stock Position:  -0.0027912465639341588
Bond Position:  [1.88013717]


portfolio before change:  [1.59542268]
curr_Stock_Price:  102.08683227269071
curr_Factors:  [1.02086832e+02 4.33208494e-02]
mat_Sqrt:  [[ 2.12480074e+01  0.00000000e+00]
 [-8.32546449e-03  1.90760356e-02]]
grads:  [0.01618781 8.35591991]
Stock Position:  0.01618780886527169
Bond Position:  [-0.05713945]


portfolio before change:  [1.60166852]
curr_Stock_Price:  102.47310961766966
curr_Factors:  [1.02473110e+02 4.20002417e-02]
mat_Sqrt:  [[ 2.10007986e+01  0.00000000e+00]
 [-8.19758420e-03  1.87830251e-02]]
grads:  [-5.79686323e-03 -3.03756007e+01]
Stock Position:  -0.005796863234402671
Bond Position:  [2.19569112]


portfolio before change:  [1.60182811]
curr_Stock_Price:  102.49292818677978
curr_Factors:  [1.02492928e+02 4.13088113e-02]
mat_Sqrt:  [[ 2.08312461e+01  0.00000000e+00]
 [-8.12982768e-03  1.86277754e-02]]
grads:  [-1.61647639e-03 -7.65370559e+00]
Stock Position:  -0.0016164763856505793
Bond Position:  [1.76750551]


portfolio before change:  [1.60430469]
curr_Stock_Price:  101.09753290347382
curr_Factors:  [1.01097533e+02 4.22792209e-02]
mat_Sqrt:  [[ 2.07875853e+01  0.00000000e+00]
 [-8.22476464e-03  1.88453033e-02]]
grads:  [-1.78729778e-03 -7.90610003e+00]
Stock Position:  -0.0017872977775621889
Bond Position:  [1.78499609]


portfolio before change:  [1.60138069]
curr_Stock_Price:  102.85836907736379
curr_Factors:  [1.02858369e+02 4.19118998e-02]
mat_Sqrt:  [[ 2.10575726e+01  0.00000000e+00]
 [-8.18895840e-03  1.87632609e-02]]
grads:  [-1.51381714e-02 -2.50109855e+01]
Stock Position:  -0.01513817144121227
Bond Position:  [3.15846832]


portfolio before change:  [1.59462193]
curr_Stock_Price:  103.33092251339808
curr_Factors:  [1.03330923e+02 4.26420114e-02]
mat_Sqrt:  [[ 2.13377758e+01  0.00000000e+00]
 [-8.25997689e-03  1.89259847e-02]]
grads:  [-2.27113972e-04 -5.76421207e+00]
Stock Position:  -0.00022711397152627377
Bond Position:  [1.61808982]


portfolio before change:  [1.59477283]
curr_Stock_Price:  103.55710945439904
curr_Factors:  [1.03557109e+02 4.22579814e-02]
mat_Sqrt:  [[ 2.12879721e+01  0.00000000e+00]
 [-8.22269847e-03  1.88405691e-02]]
grads:  [ 0.00602154 -1.49970622]
Stock Position:  0.006021536342905295
Bond Position:  [0.97119993]


portfolio before change:  [1.59399443]
curr_Stock_Price:  103.40767731259903
curr_Factors:  [1.03407677e+02 4.21577840e-02]
mat_Sqrt:  [[ 2.12320374e+01  0.00000000e+00]
 [-8.21294432e-03  1.88182195e-02]]
grads:  [ 1.31108371e-02 -1.73902605e+01]
Stock Position:  0.013110837116965198
Bond Position:  [0.23823321]


portfolio before change:  [1.59760522]
curr_Stock_Price:  103.6808111818509
curr_Factors:  [1.03680811e+02 4.14427867e-02]
mat_Sqrt:  [[ 2.11068227e+01  0.00000000e+00]
 [-8.14300060e-03  1.86579583e-02]]
grads:  [-6.15159503e-03 -1.94240376e+01]
Stock Position:  -0.006151595026175534
Bond Position:  [2.23540759]


portfolio before change:  [1.59349188]
curr_Stock_Price:  104.39490030486157
curr_Factors:  [1.04394900e+02 4.16630191e-02]
mat_Sqrt:  [[ 2.13085870e+01  0.00000000e+00]
 [-8.16460841e-03  1.87074680e-02]]
grads:  [0.00249866 2.19085531]
Stock Position:  0.0024986564442864736
Bond Position:  [1.33264489]


portfolio before change:  [1.59758183]
curr_Stock_Price:  105.9650890109193
curr_Factors:  [1.05965089e+02 3.97163793e-02]
mat_Sqrt:  [[ 2.11177494e+01  0.00000000e+00]
 [-7.97158747e-03  1.82652015e-02]]
grads:  [ 1.22547703e-02 -2.49255732e+01]
Stock Position:  0.012254770288856355
Bond Position:  [0.29900401]


portfolio before change:  [1.60114818]
curr_Stock_Price:  106.25305602422658
curr_Factors:  [1.06253056e+02 3.92531227e-02]
mat_Sqrt:  [[ 2.10512814e+01  0.00000000e+00]
 [-7.92496033e-03  1.81583653e-02]]
grads:  [-0.02114734  3.70356748]
Stock Position:  -0.021147339471429445
Bond Position:  [3.84811763]


portfolio before change:  [1.58944892]
curr_Stock_Price:  106.82902964310975
curr_Factors:  [1.06829030e+02 3.86231068e-02]
mat_Sqrt:  [[ 2.09948553e+01  0.00000000e+00]
 [-7.86110494e-03  1.80120542e-02]]
grads:  [-1.99442376e-03  1.05747272e+01]
Stock Position:  -0.001994423756857365
Bond Position:  [1.80251127]


portfolio before change:  [1.58608352]
curr_Stock_Price:  108.62941052808925
curr_Factors:  [1.08629411e+02 3.73541109e-02]
mat_Sqrt:  [[ 2.09950360e+01  0.00000000e+00]
 [-7.73088465e-03  1.77136820e-02]]
grads:  [-1.36832869e-02 -1.89823229e+01]
Stock Position:  -0.013683286923080774
Bond Position:  [3.07249091]


portfolio before change:  [1.59882238]
curr_Stock_Price:  107.72650093343965
curr_Factors:  [1.07726501e+02 3.92497244e-02]
mat_Sqrt:  [[ 2.13422823e+01  0.00000000e+00]
 [-7.92461728e-03  1.81575793e-02]]
grads:  [9.51132024e-04 1.24080256e+01]
Stock Position:  0.0009511320238466417
Bond Position:  [1.49636025]


portfolio before change:  [1.59919414]
curr_Stock_Price:  107.92069304634819
curr_Factors:  [1.07920693e+02 3.98671351e-02]
mat_Sqrt:  [[ 2.15482616e+01  0.00000000e+00]
 [-7.98670245e-03  1.82998343e-02]]
grads:  [-1.02765954e-02  3.65186110e+01]
Stock Position:  -0.01027659539854063
Bond Position:  [2.70825143]


portfolio before change:  [1.60851777]
curr_Stock_Price:  107.0463686353081
curr_Factors:  [1.07046369e+02 3.78088504e-02]
mat_Sqrt:  [[ 2.08146290e+01  0.00000000e+00]
 [-7.77779921e-03  1.78211768e-02]]
grads:  [-0.00519177  1.52118089]
Stock Position:  -0.005191772552339568
Bond Position:  [2.16427817]


portfolio before change:  [1.61620926]
curr_Stock_Price:  105.61700233629304
curr_Factors:  [1.05617002e+02 3.88745716e-02]
mat_Sqrt:  [[ 2.08241194e+01  0.00000000e+00]
 [-7.88665420e-03  1.80705949e-02]]
grads:  [ 0.00348359 -0.66113978]
Stock Position:  0.003483585327349909
Bond Position:  [1.24828342]


portfolio before change:  [1.62038924]
curr_Stock_Price:  106.77211354063988
curr_Factors:  [1.06772114e+02 3.61590118e-02]
mat_Sqrt:  [[ 2.03032759e+01  0.00000000e+00]
 [-7.60620923e-03  1.74280148e-02]]
grads:  [-0.01228474 -4.44159422]
Stock Position:  -0.012284741930054592
Bond Position:  [2.9320571]


portfolio before change:  [1.60657819]
curr_Stock_Price:  107.92619343630918
curr_Factors:  [1.07926193e+02 3.55593366e-02]
mat_Sqrt:  [[ 2.03518402e+01  0.00000000e+00]
 [-7.54287336e-03  1.72828941e-02]]
grads:  [0.00498585 3.08681293]
Stock Position:  0.004985847496765976
Bond Position:  [1.06847465]


portfolio before change:  [1.60667888]
curr_Stock_Price:  107.91959829064864
curr_Factors:  [1.07919598e+02 3.45858086e-02]
mat_Sqrt:  [[ 2.00700885e+01  0.00000000e+00]
 [-7.43890407e-03  1.70446705e-02]]
grads:  [-4.71685069e-03  4.77129471e+00]
Stock Position:  -0.0047168506929892535
Bond Position:  [2.11571951]


portfolio before change:  [1.60999149]
curr_Stock_Price:  107.27337719273628
curr_Factors:  [1.07273377e+02 3.53466006e-02]
mat_Sqrt:  [[ 2.01681369e+01  0.00000000e+00]
 [-7.52027666e-03  1.72311185e-02]]
grads:  [-0.02183801 -4.72126979]
Stock Position:  -0.02183800970747991
Bond Position:  [3.95262854]


portfolio before change:  [1.62654241]
curr_Stock_Price:  106.5381079552296
curr_Factors:  [1.06538108e+02 3.54911818e-02]
mat_Sqrt:  [[ 2.00708244e+01  0.00000000e+00]
 [-7.53564138e-03  1.72663235e-02]]
grads:  [-4.82470005e-03 -8.86199125e+00]
Stock Position:  -0.004824700048454949
Bond Position:  [2.14055683]


portfolio before change:  [1.62630976]
curr_Stock_Price:  106.6417917545865
curr_Factors:  [1.06641792e+02 3.49185877e-02]
mat_Sqrt:  [[ 1.99276354e+01  0.00000000e+00]
 [-7.47460636e-03  1.71264747e-02]]
grads:  [-1.57587174e-03 -3.75225950e+00]
Stock Position:  -0.0015758717412824484
Bond Position:  [1.79436354]


portfolio before change:  [1.62621522]
curr_Stock_Price:  106.84412500314339
curr_Factors:  [1.06844125e+02 3.22381242e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.62621522]
Stock Price:  105.99392594526465
PL:  [-4.36771073]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.26102832e+00  3.13994453e-01]
 [ 1.12475062e+00  6.58676267e-02]
 [-1.05199628e-01  1.37755665e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.11730555e-01  8.87248206e-01]
 [ 2.78202850e-02 -2.48290405e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.71710140e-01  8.69566825e-01]
 [ 8.96301482e-03  3.56286150e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-3.81561306e-02  1.62442464e-02]
 [ 6.46124336e-02 -1.25501987e-01]
 [-1.07870259e-01 -2.58061766e-02]
 [-4.80266264e-02 -3.41448271e-02]
 [ 4.72920283e-01  3.02543480e-01]
 [ 1.34402882e-01 -3.62262350e-01]
 [ 3.80177745e-02 -7.43571091e-03]
 [ 3.04654570e-02 -1.51820352e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-3.25169391e-02 -6.50196326e-02]
 [ 1.72639057e-01 -4.08493590e-02]
 [ 6.79139414e-01 -1.06635736e-01]
 [ 2.28574557e-02 -3.22744150e-02]
 [-6.37136514e-02  6.20033897e-02]
 [ 1.65413444e-01 -8.41091044e-02]
 [ 1.31442279e-01 -1.02882003e-01]
 [ 1.17781901e-01 -2.11444166e-01]
 [ 4.40596751e-02  2.71930018e-01]
 [-2.03011900e-02  1.83846099e-01]
 [-6.10349237e-01 -7.18362180e-02]
 [-1.68336750e-01 -6.20323753e-02]
 [ 2.67312780e-02 -5.70909258e-02]
 [-2.71249634e-01  1.31491201e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.06235225e-01  2.07807041e-02]
 [-2.81168594e-02 -1.70959426e-01]
 [-7.29457915e-03 -6.02030200e-02]
 [ 1.39228631e-01 -1.94203770e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.6752502]
curr_Stock_Price:  100.28939661535688
curr_Factors:  [1.00289397e+02 4.05607621e-02]
mat_Sqrt:  [[ 2.01979862e+01  0.00000000e+00]
 [-8.05588104e-03  1.84583423e-02]]
grads:  [ 0.06921813 17.01097789]
Stock Position:  0.0692181250829477
Bond Position:  [-2.2665938]


portfolio before change:  [4.53185197]
curr_Stock_Price:  98.22180398547108
curr_Factors:  [9.8221804e+01 4.1081887e-02]
mat_Sqrt:  [[ 1.99082506e+01  0.00000000e+00]
 [-8.10746688e-03  1.85765403e-02]]
grads:  [0.05794068 3.5457424 ]
Stock Position:  0.05794068182143818
Bond Position:  [-1.15918632]


portfolio before change:  [4.46553628]
curr_Stock_Price:  97.07976028749928
curr_Factors:  [9.70797603e+01 4.20733841e-02]
mat_Sqrt:  [[ 1.99128039e+01  0.00000000e+00]
 [-8.20471904e-03  1.87993730e-02]]
grads:  [-2.26377594e-03  7.32767338e+00]
Stock Position:  -0.0022637759427138874
Bond Position:  [4.6853031]


portfolio before change:  [4.46492163]
curr_Stock_Price:  97.61000237528121
curr_Factors:  [9.76100024e+01 4.07541513e-02]
mat_Sqrt:  [[ 1.97051729e+01  0.00000000e+00]
 [-8.07506298e-03  1.85022937e-02]]
grads:  [-8.27263330e-04 -8.18205651e+00]
Stock Position:  -0.0008272633298535949
Bond Position:  [4.5456708]


portfolio before change:  [4.46567395]
curr_Stock_Price:  97.3874886731723
curr_Factors:  [9.73874887e+01 4.01487636e-02]
mat_Sqrt:  [[ 1.95136834e+01  0.00000000e+00]
 [-8.01486256e-03  1.83643572e-02]]
grads:  [1.41181089e-02 4.83135999e+01]
Stock Position:  0.01411810892846093
Bond Position:  [3.09074678]


portfolio before change:  [4.45602141]
curr_Stock_Price:  96.6764226211844
curr_Factors:  [9.66764226e+01 4.10882730e-02]
mat_Sqrt:  [[ 1.95965453e+01  0.00000000e+00]
 [-8.10809699e-03  1.85779841e-02]]
grads:  [ 8.66683544e-04 -1.33647657e+00]
Stock Position:  0.000866683543771328
Bond Position:  [4.37223354]


portfolio before change:  [4.45660274]
curr_Stock_Price:  96.71653690080024
curr_Factors:  [9.67165369e+01 4.07342266e-02]
mat_Sqrt:  [[ 1.95200297e+01  0.00000000e+00]
 [-8.07308879e-03  1.84977702e-02]]
grads:  [0.00662774 5.1972149 ]
Stock Position:  0.006627744883105247
Bond Position:  [3.81559021]


portfolio before change:  [4.46333765]
curr_Stock_Price:  97.6607396940288
curr_Factors:  [9.76607397e+01 3.95294951e-02]
mat_Sqrt:  [[ 1.94169335e+01  0.00000000e+00]
 [-7.95281033e-03  1.82221777e-02]]
grads:  [ 0.06443964 47.72024732]
Stock Position:  0.06443964060956045
Bond Position:  [-1.82988532]


portfolio before change:  [4.46320084]
curr_Stock_Price:  97.6621664648588
curr_Factors:  [9.76621665e+01 4.14061897e-02]
mat_Sqrt:  [[ 1.98727966e+01  0.00000000e+00]
 [-8.13940437e-03  1.86497183e-02]]
grads:  [8.27558608e-03 1.91041036e+01]
Stock Position:  0.008275586075569795
Bond Position:  [3.65498918]


portfolio before change:  [4.45919494]
curr_Stock_Price:  97.12289329120381
curr_Factors:  [9.71228933e+01 4.13677313e-02]
mat_Sqrt:  [[ 1.97538824e+01  0.00000000e+00]
 [-8.13562352e-03  1.86410553e-02]]
grads:  [0.01247523 6.0659942 ]
Stock Position:  0.012475228009577803
Bond Position:  [3.2475647]


portfolio before change:  [4.45896172]
curr_Stock_Price:  97.07165662687183
curr_Factors:  [9.70716566e+01 4.08617221e-02]
mat_Sqrt:  [[ 1.96223390e+01  0.00000000e+00]
 [-8.08571304e-03  1.85266960e-02]]
grads:  [-0.00158322  0.87680212]
Stock Position:  -0.0015832241130693048
Bond Position:  [4.61264791]


portfolio before change:  [4.45911314]
curr_Stock_Price:  97.34022354127393
curr_Factors:  [9.73402235e+01 4.07582823e-02]
mat_Sqrt:  [[ 1.96517068e+01  0.00000000e+00]
 [-8.07547223e-03  1.85032314e-02]]
grads:  [ 5.00662670e-04 -6.78270645e+00]
Stock Position:  0.0005006626699429075
Bond Position:  [4.41037852]


portfolio before change:  [4.46114302]
curr_Stock_Price:  100.2934132114098
curr_Factors:  [1.00293413e+02 3.90263124e-02]
mat_Sqrt:  [[ 1.98130425e+01  0.00000000e+00]
 [-7.90203138e-03  1.81058285e-02]]
grads:  [-0.00601286 -1.42529664]
Stock Position:  -0.006012857366630642
Bond Position:  [5.06419301]


portfolio before change:  [4.46594812]
curr_Stock_Price:  99.59956109806375
curr_Factors:  [9.95995611e+01 4.03361195e-02]
mat_Sqrt:  [[ 2.00034305e+01  0.00000000e+00]
 [-8.03354164e-03  1.84071563e-02]]
grads:  [-0.00314589 -1.85497567]
Stock Position:  -0.0031458929310633488
Bond Position:  [4.77927768]


portfolio before change:  [4.46681337]
curr_Stock_Price:  99.51443276165108
curr_Factors:  [9.95144328e+01 4.10894626e-02]
mat_Sqrt:  [[ 2.01721088e+01  0.00000000e+00]
 [-8.10821436e-03  1.85782530e-02]]
grads:  [ 0.02998998 16.28481857]
Stock Position:  0.029989977149291313
Bond Position:  [1.48237781]


portfolio before change:  [4.51013099]
curr_Stock_Price:  100.95265676758851
curr_Factors:  [1.00952657e+02 4.01377824e-02]
mat_Sqrt:  [[ 2.02252752e+01  0.00000000e+00]
 [-8.01376640e-03  1.83618456e-02]]
grads:  [-1.17186882e-03 -1.97290816e+01]
Stock Position:  -0.0011718688173581898
Bond Position:  [4.62843426]


portfolio before change:  [4.51083171]
curr_Stock_Price:  100.84843808633238
curr_Factors:  [1.00848438e+02 4.21269565e-02]
mat_Sqrt:  [[ 2.06989930e+01  0.00000000e+00]
 [-8.20994095e-03  1.88113379e-02]]
grads:  [ 0.00167992 -0.39527815]
Stock Position:  0.0016799157411264776
Bond Position:  [4.34141483]


portfolio before change:  [4.51340196]
curr_Stock_Price:  102.05536798906442
curr_Factors:  [1.02055368e+02 4.18038632e-02]
mat_Sqrt:  [[ 2.08662334e+01  0.00000000e+00]
 [-8.17839722e-03  1.87390622e-02]]
grads:  [-1.71542108e-03 -8.10181165e+00]
Stock Position:  -0.001715421084375333
Bond Position:  [4.68846989]


portfolio before change:  [4.51543116]
curr_Stock_Price:  101.21411603778277
curr_Factors:  [1.01214116e+02 4.10498118e-02]
mat_Sqrt:  [[ 2.05067422e+01  0.00000000e+00]
 [-8.10430126e-03  1.85692870e-02]]
grads:  [-1.5544797e-02 -2.5272249e+01]
Stock Position:  -0.01554479699351291
Bond Position:  [6.08878404]


portfolio before change:  [4.52070625]
curr_Stock_Price:  100.92373264403696
curr_Factors:  [1.00923733e+02 4.05271988e-02]
mat_Sqrt:  [[ 2.03173283e+01  0.00000000e+00]
 [-8.05254730e-03  1.84507038e-02]]
grads:  [-2.99713783e-03 -3.52396491e+00]
Stock Position:  -0.0029971378328505637
Bond Position:  [4.82318859]


portfolio before change:  [4.52115223]
curr_Stock_Price:  100.97610057547803
curr_Factors:  [1.00976101e+02 4.03240228e-02]
mat_Sqrt:  [[ 2.02768515e+01  0.00000000e+00]
 [-8.03233692e-03  1.84043960e-02]]
grads:  [ 0.00763486 -2.21954358]
Stock Position:  0.007634860620430961
Bond Position:  [3.75021378]


portfolio before change:  [4.52117744]
curr_Stock_Price:  100.91799822165824
curr_Factors:  [1.00917998e+02 3.97663097e-02]
mat_Sqrt:  [[ 2.01245544e+01  0.00000000e+00]
 [-7.97659673e-03  1.82766792e-02]]
grads:  [ 0.03143422 -5.83452468]
Stock Position:  0.03143422466986364
Bond Position:  [1.34889841]


portfolio before change:  [4.46113094]
curr_Stock_Price:  99.00240706369432
curr_Factors:  [9.90024071e+01 4.03073255e-02]
mat_Sqrt:  [[ 1.98764008e+01  0.00000000e+00]
 [-8.03067375e-03  1.84005852e-02]]
grads:  [ 4.41314617e-04 -1.75398851e+00]
Stock Position:  0.0004413146166675618
Bond Position:  [4.41743973]


portfolio before change:  [4.4615991]
curr_Stock_Price:  98.8119591801152
curr_Factors:  [9.88119592e+01 3.85501835e-02]
mat_Sqrt:  [[ 1.94009383e+01  0.00000000e+00]
 [-7.85368026e-03  1.79950421e-02]]
grads:  [-1.88924643e-03  3.44558180e+00]
Stock Position:  -0.0018892464336263994
Bond Position:  [4.64827925]


portfolio before change:  [4.45929028]
curr_Stock_Price:  100.34161451059752
curr_Factors:  [1.00341615e+02 3.59363558e-02]
mat_Sqrt:  [[ 1.90216463e+01  0.00000000e+00]
 [-7.58275473e-03  1.73742738e-02]]
grads:  [ 0.00676625 -4.84101411]
Stock Position:  0.006766250357602539
Bond Position:  [3.78035379]


portfolio before change:  [4.45059557]
curr_Stock_Price:  98.98675959962489
curr_Factors:  [9.89867596e+01 3.74733366e-02]
mat_Sqrt:  [[ 1.91618876e+01  0.00000000e+00]
 [-7.74321241e-03  1.77419285e-02]]
grads:  [ 4.51630305e-03 -5.79880611e+00]
Stock Position:  0.004516303051202115
Bond Position:  [4.00354136]


portfolio before change:  [4.45454085]
curr_Stock_Price:  99.74950948943464
curr_Factors:  [9.97495095e+01 3.94703393e-02]
mat_Sqrt:  [[ 1.98173782e+01  0.00000000e+00]
 [-7.94685742e-03  1.82085378e-02]]
grads:  [ 1.28675455e-03 -1.16123638e+01]
Stock Position:  0.0012867545502005494
Bond Position:  [4.32618771]


portfolio before change:  [4.45723278]
curr_Stock_Price:  101.42124940842426
curr_Factors:  [1.01421249e+02 3.89271799e-02]
mat_Sqrt:  [[ 2.00103842e+01  0.00000000e+00]
 [-7.89198884e-03  1.80828181e-02]]
grads:  [8.13276063e-03 1.50380332e+01]
Stock Position:  0.008132760630735467
Bond Position:  [3.63239803]


portfolio before change:  [4.45579754]
curr_Stock_Price:  101.18894007019941
curr_Factors:  [1.01188940e+02 3.94955068e-02]
mat_Sqrt:  [[ 2.01097602e+01  0.00000000e+00]
 [-7.94939060e-03  1.82143421e-02]]
grads:  [2.98043462e-03 1.00934801e+01]
Stock Position:  0.0029804346246933705
Bond Position:  [4.15421052]


portfolio before change:  [4.45914623]
curr_Stock_Price:  102.13825942126438
curr_Factors:  [1.02138259e+02 3.96814374e-02]
mat_Sqrt:  [[ 2.03461457e+01  0.00000000e+00]
 [-7.96808006e-03  1.82571650e-02]]
grads:  [-0.0315392  -3.93468635]
Stock Position:  -0.031539198747648975
Bond Position:  [7.68050509]


portfolio before change:  [4.47176109]
curr_Stock_Price:  101.7687277105886
curr_Factors:  [1.01768728e+02 3.99666067e-02]
mat_Sqrt:  [[ 2.03452478e+01  0.00000000e+00]
 [-7.99665997e-03  1.83226498e-02]]
grads:  [-0.00960469 -3.385557  ]
Stock Position:  -0.009604694933503261
Bond Position:  [5.44921867]


portfolio before change:  [4.47064993]
curr_Stock_Price:  101.95533958540513
curr_Factors:  [1.01955340e+02 4.07529674e-02]
mat_Sqrt:  [[ 2.05820957e+01  0.00000000e+00]
 [-8.07494569e-03  1.85020249e-02]]
grads:  [ 8.81715456e-05 -3.08565825e+00]
Stock Position:  8.817154563784664e-05
Bond Position:  [4.46166037]


portfolio before change:  [4.47120562]
curr_Stock_Price:  101.93200204479223
curr_Factors:  [1.01932002e+02 3.99519936e-02]
mat_Sqrt:  [[ 2.03741633e+01  0.00000000e+00]
 [-7.99519792e-03  1.83192998e-02]]
grads:  [-0.01049673  7.17774161]
Stock Position:  -0.010496733831411238
Bond Position:  [5.54115871]


portfolio before change:  [4.45408476]
curr_Stock_Price:  103.62905801458155
curr_Factors:  [1.03629058e+02 3.93611882e-02]
mat_Sqrt:  [[ 2.05596468e+01  0.00000000e+00]
 [-7.93586171e-03  1.81833435e-02]]
grads:  [0.00493545 2.93395221]
Stock Position:  0.004935453049817189
Bond Position:  [3.94262841]


portfolio before change:  [4.4539093]
curr_Stock_Price:  103.49364660857361
curr_Factors:  [1.03493647e+02 3.91946954e-02]
mat_Sqrt:  [[ 2.04893101e+01  0.00000000e+00]
 [-7.91906008e-03  1.81448461e-02]]
grads:  [-0.00462034  4.48199701]
Stock Position:  -0.004620341538941217
Bond Position:  [4.9320853]


portfolio before change:  [4.4538599]
curr_Stock_Price:  103.63778147279628
curr_Factors:  [1.03637781e+02 3.88884164e-02]
mat_Sqrt:  [[ 2.04375220e+01  0.00000000e+00]
 [-7.88805846e-03  1.80738125e-02]]
grads:  [-0.01454021  1.14976871]
Stock Position:  -0.014540206114949526
Bond Position:  [5.9607746]


portfolio before change:  [4.4379766]
curr_Stock_Price:  104.78139958232201
curr_Factors:  [1.04781400e+02 3.83406697e-02]
mat_Sqrt:  [[ 2.05170087e+01  0.00000000e+00]
 [-7.83230946e-03  1.79460755e-02]]
grads:  [-5.00704911e-03 -9.52628481e+00]
Stock Position:  -0.005007049109140517
Bond Position:  [4.96262221]


portfolio before change:  [4.44265538]
curr_Stock_Price:  103.97085999207252
curr_Factors:  [1.03970860e+02 3.98231719e-02]
mat_Sqrt:  [[ 2.07481587e+01  0.00000000e+00]
 [-7.98229760e-03  1.82897415e-02]]
grads:  [-1.61794267e-03 -3.29162771e+00]
Stock Position:  -0.0016179426668165519
Bond Position:  [4.61087427]


portfolio before change:  [4.44088845]
curr_Stock_Price:  105.41919488082804
curr_Factors:  [1.05419195e+02 3.87294521e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.44088845]
Stock Price:  104.66196867459529
PL:  [-0.22108022]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.02611399e+00  2.60885030e-01]
 [-2.62748841e-01 -1.02049040e-01]
 [-2.14617045e-01 -1.12757899e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.03766892e-01 -1.44368089e-01]
 [-3.61205893e-01  1.93088511e-01]
 [ 1.18615020e-01 -3.84962841e-02]
 [ 2.16338408e-01  4.46630345e-01]
 [-1.05829993e-01 -4.26431200e-02]
 [ 6.90833146e-02 -1.07039841e-01]
 [-1.03497386e-01 -3.58737444e-03]
 [-9.44187823e-03 -1.36319521e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 2.30145064e-02 -1.97840586e-01]
 [ 9.63973082e-03 -5.62116054e-02]
 [ 1.11856095e-01 -7.50937681e-01]
 [ 2.21162515e-02 -2.29929868e-01]
 [ 3.43237403e-02 -1.56027155e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 2.53176658e-02 -9.88783422e-02]
 [ 1.64592918e-01 -3.61859206e-02]
 [ 3.95064965e-01 -3.51431350e-01]
 [ 2.99751627e-02 -4.06061430e-01]
 [ 5.82574231e-02  6.05443704e-03]
 [ 2.71377133e-01 -1.77630881e-01]
 [ 1.49653396e-01 -8.62803680e-02]
 [-1.45787689e-01 -3.79698761e-02]
 [-8.83684268e-03  2.24911234e-01]
 [-2.25500535e-02  1.86002840e-01]
 [-5.22712268e-01 -1.03719311e-01]
 [-1.68302079e-01 -6.35261394e-02]
 [ 7.53595746e-03 -7.08636467e-02]
 [-2.73510179e-01  1.29573609e-01]
 [ 6.94859372e-02  5.87781116e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.39743908e-01  7.13031140e-02]
 [-2.19719192e-02 -2.26245962e-01]
 [ 2.74128946e-03 -4.72145411e-02]
 [-2.32970445e-02 -3.58516016e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.09057895]
curr_Stock_Price:  101.36576840220121
curr_Factors:  [1.01365768e+02 3.86362323e-02]
mat_Sqrt:  [[ 1.99245582e+01  0.00000000e+00]
 [-7.86244057e-03  1.80151145e-02]]
grads:  [ 0.0572145  14.48145275]
Stock Position:  0.05721449573755898
Bond Position:  [6.29098763]


portfolio before change:  [12.11938708]
curr_Stock_Price:  101.85553411193251
curr_Factors:  [1.01855534e+02 3.76008277e-02]
mat_Sqrt:  [[ 1.97507382e+01  0.00000000e+00]
 [-7.75637314e-03  1.77720835e-02]]
grads:  [-0.01555824 -5.74209768]
Stock Position:  -0.015558238382896392
Bond Position:  [13.70407976]


portfolio before change:  [12.12297439]
curr_Stock_Price:  101.73507066871545
curr_Factors:  [1.01735071e+02 3.79960889e-02]
mat_Sqrt:  [[ 1.98307956e+01  0.00000000e+00]
 [-7.79703419e-03  1.78652497e-02]]
grads:  [-0.01330399 -6.31157699]
Stock Position:  -0.013303985973517429
Bond Position:  [13.47645634]


portfolio before change:  [12.12989617]
curr_Stock_Price:  101.3414204325988
curr_Factors:  [1.01341420e+02 3.82819014e-02]
mat_Sqrt:  [[ 1.98282204e+01  0.00000000e+00]
 [-7.82630451e-03  1.79323164e-02]]
grads:  [-8.22129603e-04 -8.44212253e+00]
Stock Position:  -0.0008221296026909283
Bond Position:  [12.21321195]


portfolio before change:  [12.13158427]
curr_Stock_Price:  101.14515631149676
curr_Factors:  [1.01145156e+02 3.79547689e-02]
mat_Sqrt:  [[ 1.97050829e+01  0.00000000e+00]
 [-7.79279348e-03  1.78555330e-02]]
grads:  [-0.00846352 -8.08534191]
Stock Position:  -0.008463516363276958
Bond Position:  [12.98762796]


portfolio before change:  [12.12594184]
curr_Stock_Price:  102.00366365586959
curr_Factors:  [1.02003664e+02 3.67445933e-02]
mat_Sqrt:  [[ 1.95529592e+01  0.00000000e+00]
 [-7.66755172e-03  1.75685681e-02]]
grads:  [-0.01416334 10.99056626]
Stock Position:  -0.014163337424762798
Bond Position:  [13.57065414]


portfolio before change:  [12.14439518]
curr_Stock_Price:  100.82054509614886
curr_Factors:  [1.00820545e+02 3.66472728e-02]
mat_Sqrt:  [[ 1.93005583e+01  0.00000000e+00]
 [-7.65739097e-03  1.75452869e-02]]
grads:  [ 0.00527518 -2.1941097 ]
Stock Position:  0.005275177179218458
Bond Position:  [11.61254894]


portfolio before change:  [12.14462051]
curr_Stock_Price:  100.58807311290388
curr_Factors:  [1.00588073e+02 3.62484570e-02]
mat_Sqrt:  [[ 1.91509910e+01  0.00000000e+00]
 [-7.61561102e-03  1.74495570e-02]]
grads:  [2.14748089e-02 2.55955120e+01]
Stock Position:  0.021474808897743322
Bond Position:  [9.98451086]


portfolio before change:  [12.15097146]
curr_Stock_Price:  100.82569140063967
curr_Factors:  [1.00825691e+02 3.58986821e-02]
mat_Sqrt:  [[ 1.91033909e+01  0.00000000e+00]
 [-7.57877902e-03  1.73651643e-02]]
grads:  [-0.00651408 -2.45567041]
Stock Position:  -0.006514077917353756
Bond Position:  [12.80775787]


portfolio before change:  [12.15025136]
curr_Stock_Price:  101.1820227832233
curr_Factors:  [1.01182023e+02 3.58842047e-02]
mat_Sqrt:  [[ 1.91670387e+01  0.00000000e+00]
 [-7.57725066e-03  1.73616624e-02]]
grads:  [ 1.16696680e-03 -6.16529911e+00]
Stock Position:  0.0011669667998950427
Bond Position:  [12.0321753]


portfolio before change:  [12.15031917]
curr_Stock_Price:  99.95122430037715
curr_Factors:  [9.99512243e+01 3.46076954e-02]
mat_Sqrt:  [[ 1.85940699e+01  0.00000000e+00]
 [-7.44125747e-03  1.70500628e-02]]
grads:  [-0.00565035 -0.21040242]
Stock Position:  -0.005650352248844474
Bond Position:  [12.7150788]


portfolio before change:  [12.14324769]
curr_Stock_Price:  101.48404279034213
curr_Factors:  [1.01484043e+02 3.37192355e-02]
mat_Sqrt:  [[ 1.86353099e+01  0.00000000e+00]
 [-7.34511925e-03  1.68297825e-02]]
grads:  [-3.69924594e-03 -8.09989795e+00]
Stock Position:  -0.0036992459419786313
Bond Position:  [12.51866213]


portfolio before change:  [12.14152114]
curr_Stock_Price:  102.37381547508333
curr_Factors:  [1.02373815e+02 3.22363640e-02]
mat_Sqrt:  [[ 1.83806944e+01  0.00000000e+00]
 [-7.18179520e-03  1.64555601e-02]]
grads:  [-0.00356404 -1.08717071]
Stock Position:  -0.0035640395047373055
Bond Position:  [12.50638546]


portfolio before change:  [12.13609648]
curr_Stock_Price:  104.33452786306852
curr_Factors:  [1.04334528e+02 3.19386779e-02]
mat_Sqrt:  [[ 1.86460362e+01  0.00000000e+00]
 [-7.14855822e-03  1.63794046e-02]]
grads:  [-3.39644328e-03 -1.20786189e+01]
Stock Position:  -0.003396443275473549
Bond Position:  [12.49046278]


portfolio before change:  [12.13777295]
curr_Stock_Price:  104.30064851586368
curr_Factors:  [1.04300649e+02 3.25599158e-02]
mat_Sqrt:  [[ 1.88203912e+01  0.00000000e+00]
 [-7.21774655e-03  1.65379350e-02]]
grads:  [-7.91323886e-04 -3.39894948e+00]
Stock Position:  -0.0007913238859374711
Bond Position:  [12.22030854]


portfolio before change:  [12.13967333]
curr_Stock_Price:  103.8296025089673
curr_Factors:  [1.03829603e+02 3.18559166e-02]
mat_Sqrt:  [[ 1.85317419e+01  0.00000000e+00]
 [-7.13929034e-03  1.63581692e-02]]
grads:  [-1.16492005e-02 -4.59059735e+01]
Stock Position:  -0.011649200516944154
Bond Position:  [13.34920519]


portfolio before change:  [12.1377177]
curr_Stock_Price:  104.1407301120955
curr_Factors:  [1.04140730e+02 3.14709027e-02]
mat_Sqrt:  [[ 1.84746074e+01  0.00000000e+00]
 [-7.09601608e-03  1.62590154e-02]]
grads:  [-4.23464315e-03 -1.41416846e+01]
Stock Position:  -0.004234643154490143
Bond Position:  [12.57871653]


portfolio before change:  [12.14209712]
curr_Stock_Price:  103.47786855610914
curr_Factors:  [1.03477869e+02 3.22600000e-02]
mat_Sqrt:  [[ 1.85857314e+01  0.00000000e+00]
 [-7.18442760e-03  1.64615917e-02]]
grads:  [-1.81709788e-03 -9.47825452e+00]
Stock Position:  -0.0018170978792150223
Bond Position:  [12.33012654]


portfolio before change:  [12.14597705]
curr_Stock_Price:  102.19089196602476
curr_Factors:  [1.02190892e+02 3.28246399e-02]
mat_Sqrt:  [[ 1.85145080e+01  0.00000000e+00]
 [-7.24702862e-03  1.66050286e-02]]
grads:  [-1.72174786e-02 -2.82617787e+01]
Stock Position:  -0.017217478592876215
Bond Position:  [13.90544654]


portfolio before change:  [12.14662395]
curr_Stock_Price:  102.25428010476155
curr_Factors:  [1.02254280e+02 3.25210321e-02]
mat_Sqrt:  [[ 1.84401163e+01  0.00000000e+00]
 [-7.21343547e-03  1.65280570e-02]]
grads:  [-9.67259661e-04 -5.98245408e+00]
Stock Position:  -0.0009672596612289589
Bond Position:  [12.24553039]


portfolio before change:  [12.14845773]
curr_Stock_Price:  101.9410279248179
curr_Factors:  [1.01941028e+02 3.23898222e-02]
mat_Sqrt:  [[ 1.83465027e+01  0.00000000e+00]
 [-7.19886904e-03  1.64946811e-02]]
grads:  [ 0.00811054 -2.19379328]
Stock Position:  0.008110542352989344
Bond Position:  [11.32166071]


portfolio before change:  [12.16392655]
curr_Stock_Price:  103.67377551900147
curr_Factors:  [1.03673776e+02 3.07317748e-02]
mat_Sqrt:  [[ 1.81745110e+01  0.00000000e+00]
 [-7.01219221e-03  1.60669508e-02]]
grads:  [ 1.32981707e-02 -2.18729337e+01]
Stock Position:  0.013298170695513105
Bond Position:  [10.78525499]


portfolio before change:  [12.1512279]
curr_Stock_Price:  102.61747291348607
curr_Factors:  [1.02617473e+02 3.22150034e-02]
mat_Sqrt:  [[ 1.84183366e+01  0.00000000e+00]
 [-7.17941539e-03  1.64501072e-02]]
grads:  [-7.99445560e-03 -2.46844245e+01]
Stock Position:  -0.007994455600007975
Bond Position:  [12.97159873]


portfolio before change:  [12.16067152]
curr_Stock_Price:  101.63903692555003
curr_Factors:  [1.01639037e+02 3.32010124e-02]
mat_Sqrt:  [[ 1.85197963e+01  0.00000000e+00]
 [-7.28845798e-03  1.66999552e-02]]
grads:  [0.00328836 0.36254211]
Stock Position:  0.0032883620955259725
Bond Position:  [11.82644556]


portfolio before change:  [12.16163345]
curr_Stock_Price:  101.48197775433408
curr_Factors:  [1.01481978e+02 3.34464715e-02]
mat_Sqrt:  [[ 1.85594062e+01  0.00000000e+00]
 [-7.31535060e-03  1.67615739e-02]]
grads:  [ 1.04449818e-02 -1.05975061e+01]
Stock Position:  0.010444981829689483
Bond Position:  [11.10165603]


portfolio before change:  [12.16075634]
curr_Stock_Price:  101.26513630584722
curr_Factors:  [1.01265136e+02 3.31617808e-02]
mat_Sqrt:  [[ 1.84407625e+01  0.00000000e+00]
 [-7.28415056e-03  1.66900856e-02]]
grads:  [ 0.00607337 -5.16955813]
Stock Position:  0.0060733690650749
Bond Position:  [11.54573579]


portfolio before change:  [12.16422404]
curr_Stock_Price:  101.59845947931923
curr_Factors:  [1.01598459e+02 3.29629766e-02]
mat_Sqrt:  [[ 1.84459206e+01  0.00000000e+00]
 [-7.26228357e-03  1.66399821e-02]]
grads:  [-0.0088019  -2.28184597]
Stock Position:  -0.008801897473637143
Bond Position:  [13.05848326]


portfolio before change:  [12.15669182]
curr_Stock_Price:  102.63967012257599
curr_Factors:  [1.02639670e+02 3.25458748e-02]
mat_Sqrt:  [[ 1.85166843e+01  0.00000000e+00]
 [-7.21619011e-03  1.65343687e-02]]
grads:  [4.82389102e-03 1.36026502e+01]
Stock Position:  0.00482389102134231
Bond Position:  [11.66156924]


portfolio before change:  [12.15235375]
curr_Stock_Price:  101.43818068654114
curr_Factors:  [1.01438181e+02 3.19168086e-02]
mat_Sqrt:  [[ 1.81222109e+01  0.00000000e+00]
 [-7.14611039e-03  1.63737959e-02]]
grads:  [3.23515940e-03 1.13597874e+01]
Stock Position:  0.0032351593976146682
Bond Position:  [11.82418507]


portfolio before change:  [12.15095322]
curr_Stock_Price:  100.54837947212282
curr_Factors:  [1.00548379e+02 3.10742485e-02]
mat_Sqrt:  [[ 1.77245571e+01  0.00000000e+00]
 [-7.05115577e-03  1.61562275e-02]]
grads:  [-0.03204475 -6.41977288]
Stock Position:  -0.032044754730979536
Bond Position:  [15.37300138]


portfolio before change:  [12.14841704]
curr_Stock_Price:  100.68749507219034
curr_Factors:  [1.00687495e+02 3.07697297e-02]
mat_Sqrt:  [[ 1.76618982e+01  0.00000000e+00]
 [-7.01652104e-03  1.60768694e-02]]
grads:  [-0.01109887 -3.95139986]
Stock Position:  -0.011098872666143738
Bond Position:  [13.26593473]


portfolio before change:  [12.15955199]
curr_Stock_Price:  99.83366022539361
curr_Factors:  [9.98336602e+01 3.03480771e-02]
mat_Sqrt:  [[ 1.73917219e+01  0.00000000e+00]
 [-6.96827980e-03  1.59663348e-02]]
grads:  [-1.34497743e-03 -4.43831646e+00]
Stock Position:  -0.0013449774308642063
Bond Position:  [12.29382601]


portfolio before change:  [12.1582116]
curr_Stock_Price:  101.97289028586523
curr_Factors:  [1.01972890e+02 2.95863764e-02]
mat_Sqrt:  [[ 1.75400416e+01  0.00000000e+00]
 [-6.88027632e-03  1.57646935e-02]]
grads:  [-0.01236939  8.21922791]
Stock Position:  -0.01236939026533226
Bond Position:  [13.41955407]


portfolio before change:  [12.15614615]
curr_Stock_Price:  102.275491791448
curr_Factors:  [1.02275492e+02 2.91167625e-02]
mat_Sqrt:  [[ 1.74519162e+01  0.00000000e+00]
 [-6.82545384e-03  1.56390794e-02]]
grads:  [0.00545148 3.7584125 ]
Stock Position:  0.0054514820676733544
Bond Position:  [11.59859314]


portfolio before change:  [12.15420236]
curr_Stock_Price:  101.6529625300582
curr_Factors:  [1.01652963e+02 2.86057914e-02]
mat_Sqrt:  [[ 1.71928163e+01  0.00000000e+00]
 [-6.76529868e-03  1.55012467e-02]]
grads:  [-0.00550623  5.24636166]
Stock Position:  -0.005506230563247091
Bond Position:  [12.71392701]


portfolio before change:  [12.157417]
curr_Stock_Price:  101.35778861133151
curr_Factors:  [1.01357789e+02 2.86717860e-02]
mat_Sqrt:  [[ 1.71626561e+01  0.00000000e+00]
 [-6.77309808e-03  1.55191173e-02]]
grads:  [-0.01215573  4.59453412]
Stock Position:  -0.012155733734295925
Bond Position:  [13.38949529]


portfolio before change:  [12.16442113]
curr_Stock_Price:  100.91928430294102
curr_Factors:  [1.00919284e+02 2.85770798e-02]
mat_Sqrt:  [[ 1.70601594e+01  0.00000000e+00]
 [-6.76190267e-03  1.54934654e-02]]
grads:  [-7.07576929e-03 -1.46026700e+01]
Stock Position:  -0.007075769285017839
Bond Position:  [12.8785027]


portfolio before change:  [12.15836184]
curr_Stock_Price:  102.00315270760134
curr_Factors:  [1.02003153e+02 2.90976197e-02]
mat_Sqrt:  [[ 1.73997227e+01  0.00000000e+00]
 [-6.82320976e-03  1.56339376e-02]]
grads:  [-1.02673048e-03 -3.02000317e+00]
Stock Position:  -0.0010267304816370323
Bond Position:  [12.26309158]


portfolio before change:  [12.15902401]
curr_Stock_Price:  102.85129177849261
curr_Factors:  [1.02851292e+02 2.87146164e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.15902401]
Stock Price:  103.53867061677154
PL:  [8.62035339]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.31506562e+00  3.26211204e-01]
 [ 3.80202531e-01  1.16774364e-01]
 [ 1.10148418e-01 -1.52403209e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.10938418e-02  1.68747325e-01]
 [-3.10304059e-01  1.34677404e-01]
 [ 9.45641398e-02  4.88671102e-02]
 [-3.16504683e-02  3.80765992e-01]
 [-1.18040339e-01 -9.78098337e-02]
 [-1.15672766e-01 -3.69409563e-01]
 [-6.11604851e-02 -1.46895445e-02]
 [-7.17479091e-03 -1.36272566e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 2.00833491e-02 -2.02579891e-01]
 [ 1.22302451e-01  7.10536276e-02]
 [ 1.06675719e-01 -8.08950894e-01]
 [ 2.20020552e-02 -2.30534513e-01]
 [ 3.85221802e-02 -1.60604842e-01]
 [-1.20413509e-01 -4.05207590e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.23965851e-01 -2.29316017e-02]
 [ 3.23066287e-01 -3.94706683e-01]
 [ 2.71643797e-02 -3.35796655e-01]
 [ 3.35875784e-02  4.99312219e-02]
 [ 4.10087623e-01 -3.22263864e-01]
 [-1.91011892e-02 -4.42601848e-02]
 [-8.35775361e-02 -6.19813861e-02]
 [ 7.59573045e-04  2.65217545e-01]
 [-2.51566484e-02  1.86569489e-01]
 [-5.51896328e-01 -9.49415415e-02]
 [-1.66619537e-01 -6.16883506e-02]
 [ 7.39693763e-03 -7.33511561e-02]
 [-1.38147673e-01  1.53456065e-01]
 [ 8.94485874e-03  1.18737168e-02]
 [-7.96388488e-02  9.49974557e-02]
 [-1.61427679e-01  1.06147288e-01]
 [-2.10992711e-02 -2.34633195e-01]
 [ 4.93695791e-03 -4.45800525e-02]
 [-5.36208680e-02 -3.89173176e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.02842706]
curr_Stock_Price:  100.0503520589321
curr_Factors:  [1.00050352e+02 3.94293710e-02]
mat_Sqrt:  [[ 1.98668286e+01  0.00000000e+00]
 [-7.94273212e-03  1.81990856e-02]]
grads:  [ 0.07336027 17.92459312]
Stock Position:  0.07336026765966801
Bond Position:  [-4.31129355]


portfolio before change:  [3.0320753]
curr_Stock_Price:  100.10742916876185
curr_Factors:  [1.00107429e+02 4.02603726e-02]
mat_Sqrt:  [[ 2.00865432e+01  0.00000000e+00]
 [-8.02599503e-03  1.83898649e-02]]
grads:  [0.02146547 6.34993051]
Stock Position:  0.021465467574542707
Bond Position:  [0.88322253]


portfolio before change:  [3.03462833]
curr_Stock_Price:  100.2212221521304
curr_Factors:  [1.00221222e+02 4.04217123e-02]
mat_Sqrt:  [[ 2.01496287e+01  0.00000000e+00]
 [-8.04206066e-03  1.84266759e-02]]
grads:  [ 0.00513642 -0.82707923]
Stock Position:  0.005136422021533099
Bond Position:  [2.51984984]


portfolio before change:  [3.0347943]
curr_Stock_Price:  100.19220815316204
curr_Factors:  [1.00192208e+02 4.07866178e-02]
mat_Sqrt:  [[ 2.02345148e+01  0.00000000e+00]
 [-8.07827880e-03  1.85096621e-02]]
grads:  [-8.05621836e-04 -8.17879937e+00]
Stock Position:  -0.0008056218361539249
Bond Position:  [3.11551133]


portfolio before change:  [3.03559736]
curr_Stock_Price:  99.67883105541513
curr_Factors:  [9.96788311e+01 4.07691579e-02]
mat_Sqrt:  [[ 2.01265255e+01  0.00000000e+00]
 [-8.07654955e-03  1.85056998e-02]]
grads:  [-3.69982951e-04  9.11866757e+00]
Stock Position:  -0.00036998295118155673
Bond Position:  [3.07247682]


portfolio before change:  [3.03538907]
curr_Stock_Price:  101.2798905315744
curr_Factors:  [1.01279891e+02 3.99038157e-02]
mat_Sqrt:  [[ 2.02316096e+01  0.00000000e+00]
 [-7.99037579e-03  1.83082509e-02]]
grads:  [-0.01243233  7.35610432]
Stock Position:  -0.01243232872884174
Bond Position:  [4.29453397]


portfolio before change:  [3.04905168]
curr_Stock_Price:  100.22411441159161
curr_Factors:  [1.00224114e+02 3.97954485e-02]
mat_Sqrt:  [[ 1.99935047e+01  0.00000000e+00]
 [-7.97951864e-03  1.82833741e-02]]
grads:  [0.00579646 2.67276215]
Stock Position:  0.0057964572416455635
Bond Position:  [2.46810689]


portfolio before change:  [3.05547924]
curr_Stock_Price:  101.27976408417176
curr_Factors:  [1.01279764e+02 3.95090168e-02]
mat_Sqrt:  [[ 2.01312523e+01  0.00000000e+00]
 [-7.95075008e-03  1.82174570e-02]]
grads:  [6.68261629e-03 2.09011604e+01]
Stock Position:  0.006682616293020528
Bond Position:  [2.37866544]


portfolio before change:  [3.06011869]
curr_Stock_Price:  101.92952374617222
curr_Factors:  [1.01929524e+02 3.87257273e-02]
mat_Sqrt:  [[ 2.00585616e+01  0.00000000e+00]
 [-7.87154138e-03  1.80359671e-02]]
grads:  [-0.00801294 -5.42304347]
Stock Position:  -0.008012939974284943
Bond Position:  [3.87687384]


portfolio before change:  [3.05872778]
curr_Stock_Price:  102.16358892178309
curr_Factors:  [1.02163589e+02 3.78067051e-02]
mat_Sqrt:  [[ 1.98646334e+01  0.00000000e+00]
 [-7.77757855e-03  1.78206712e-02]]
grads:  [-1.39391606e-02 -2.07292733e+01]
Stock Position:  -0.01393916064078974
Bond Position:  [4.48280245]


portfolio before change:  [3.05987308]
curr_Stock_Price:  102.12162661671124
curr_Factors:  [1.02121627e+02 3.83441855e-02]
mat_Sqrt:  [[ 1.99971214e+01  0.00000000e+00]
 [-7.83266856e-03  1.79468983e-02]]
grads:  [-0.00337906 -0.81850046]
Stock Position:  -0.0033790627528611323
Bond Position:  [3.40494847]


portfolio before change:  [3.06284121]
curr_Stock_Price:  101.36920380028758
curr_Factors:  [1.01369204e+02 3.89534441e-02]
mat_Sqrt:  [[ 2.00068615e+01  0.00000000e+00]
 [-7.89465076e-03  1.80889173e-02]]
grads:  [-3.33130783e-03 -7.53348380e+00]
Stock Position:  -0.0033313078303087757
Bond Position:  [3.40053323]


portfolio before change:  [3.05882961]
curr_Stock_Price:  102.70102072134908
curr_Factors:  [1.02701021e+02 3.78537357e-02]
mat_Sqrt:  [[ 1.99815481e+01  0.00000000e+00]
 [-7.78241461e-03  1.78317520e-02]]
grads:  [-0.0032785  -1.00326669]
Stock Position:  -0.0032785007827614205
Bond Position:  [3.39553499]


portfolio before change:  [3.05823675]
curr_Stock_Price:  103.0113239974832
curr_Factors:  [1.03011324e+02 3.73503069e-02]
mat_Sqrt:  [[ 1.99082028e+01  0.00000000e+00]
 [-7.73049100e-03  1.77127801e-02]]
grads:  [-3.43224170e-03 -1.14369337e+01]
Stock Position:  -0.0034322417019742296
Bond Position:  [3.41179651]


portfolio before change:  [3.05798911]
curr_Stock_Price:  103.20773839194592
curr_Factors:  [1.03207738e+02 3.58632977e-02]
mat_Sqrt:  [[ 1.95450764e+01  0.00000000e+00]
 [-7.57504299e-03  1.73566039e-02]]
grads:  [0.00784406 4.09375174]
Stock Position:  0.007844062288128211
Bond Position:  [2.24842118]


portfolio before change:  [3.06673461]
curr_Stock_Price:  104.2868260076754
curr_Factors:  [1.04286826e+02 3.65761969e-02]
mat_Sqrt:  [[ 1.99447558e+01  0.00000000e+00]
 [-7.64996176e-03  1.75282644e-02]]
grads:  [-1.23530916e-02 -4.61512261e+01]
Stock Position:  -0.012353091608608549
Bond Position:  [4.35499933]


portfolio before change:  [3.06887155]
curr_Stock_Price:  104.15790839115702
curr_Factors:  [1.04157908e+02 3.69590121e-02]
mat_Sqrt:  [[ 2.00240734e+01  0.00000000e+00]
 [-7.68989073e-03  1.76197532e-02]]
grads:  [-3.92584732e-03 -1.30838673e+01]
Stock Position:  -0.003925847318332123
Bond Position:  [3.4777796]


portfolio before change:  [3.06588063]
curr_Stock_Price:  105.0305032786665
curr_Factors:  [1.05030503e+02 3.80293464e-02]
mat_Sqrt:  [[ 2.04821186e+01  0.00000000e+00]
 [-7.80044577e-03  1.78730666e-02]]
grads:  [-1.54141864e-03 -8.98585819e+00]
Stock Position:  -0.0015414186355778316
Bond Position:  [3.2277766]


portfolio before change:  [3.06782034]
curr_Stock_Price:  104.0338790130177
curr_Factors:  [1.04033879e+02 3.87281143e-02]
mat_Sqrt:  [[ 2.04733055e+01  0.00000000e+00]
 [-7.87178397e-03  1.80365230e-02]]
grads:  [-1.45194238e-02 -2.24659482e+01]
Stock Position:  -0.014519423790388472
Bond Position:  [4.57833232]


portfolio before change:  [3.05589673]
curr_Stock_Price:  104.89451488810963
curr_Factors:  [1.04894515e+02 3.85592646e-02]
mat_Sqrt:  [[ 2.05976251e+01  0.00000000e+00]
 [-7.85460523e-03  1.79971615e-02]]
grads:  [-2.35275037e-04 -6.06169974e+00]
Stock Position:  -0.00023527503660672025
Bond Position:  [3.08057579]


portfolio before change:  [3.056336]
curr_Stock_Price:  104.66424597199591
curr_Factors:  [1.04664246e+02 3.81774742e-02]
mat_Sqrt:  [[ 2.04504065e+01  0.00000000e+00]
 [-7.81562274e-03  1.79078414e-02]]
grads:  [ 0.00557239 -1.28053411]
Stock Position:  0.00557239187231094
Bond Position:  [2.47310581]


portfolio before change:  [3.06142578]
curr_Stock_Price:  105.52215731808455
curr_Factors:  [1.05522157e+02 3.89109429e-02]
mat_Sqrt:  [[ 2.08151497e+01  0.00000000e+00]
 [-7.89034274e-03  1.80790464e-02]]
grads:  [ 7.24482747e-03 -2.18322733e+01]
Stock Position:  0.00724482747069863
Bond Position:  [2.29693595]


portfolio before change:  [3.0629239]
curr_Stock_Price:  105.68930999050323
curr_Factors:  [1.05689310e+02 3.92382678e-02]
mat_Sqrt:  [[ 2.09356272e+01  0.00000000e+00]
 [-7.92346064e-03  1.81549291e-02]]
grads:  [-5.70268539e-03 -1.84961700e+01]
Stock Position:  -0.005702685393458939
Bond Position:  [3.66563679]


portfolio before change:  [3.06948706]
curr_Stock_Price:  104.61877587768926
curr_Factors:  [1.04618776e+02 3.90822241e-02]
mat_Sqrt:  [[ 2.06823208e+01  0.00000000e+00]
 [-7.90768984e-03  1.81187936e-02]]
grads:  [2.67761780e-03 2.75576967e+00]
Stock Position:  0.002677617796843028
Bond Position:  [2.78935796]


portfolio before change:  [3.06565305]
curr_Stock_Price:  103.05667854940862
curr_Factors:  [1.03056679e+02 3.88678148e-02]
mat_Sqrt:  [[ 2.03175438e+01  0.00000000e+00]
 [-7.88596878e-03  1.80690244e-02]]
grads:  [ 1.32614525e-02 -1.78351557e+01]
Stock Position:  0.013261452543057993
Bond Position:  [1.6989718]


portfolio before change:  [3.05754673]
curr_Stock_Price:  102.42939394596429
curr_Factors:  [1.02429394e+02 3.85663697e-02]
mat_Sqrt:  [[ 2.01154144e+01  0.00000000e+00]
 [-7.85532886e-03  1.79988196e-02]]
grads:  [-1.90987453e-03 -2.45906042e+00]
Stock Position:  -0.0019098745290430832
Bond Position:  [3.25317402]


portfolio before change:  [3.06010984]
curr_Stock_Price:  101.30029595449857
curr_Factors:  [1.01300296e+02 3.94051693e-02]
mat_Sqrt:  [[ 2.01088536e+01  0.00000000e+00]
 [-7.94029413e-03  1.81934994e-02]]
grads:  [-0.00550148 -3.40678748]
Stock Position:  -0.005501478736563871
Bond Position:  [3.61741126]


portfolio before change:  [3.05509758]
curr_Stock_Price:  102.29356659418214
curr_Factors:  [1.02293567e+02 3.79700767e-02]
mat_Sqrt:  [[ 1.99328344e+01  0.00000000e+00]
 [-7.79436481e-03  1.78591334e-02]]
grads:  [5.84512955e-03 1.48505271e+01]
Stock Position:  0.005845129546681691
Bond Position:  [2.45717843]


portfolio before change:  [3.0511563]
curr_Stock_Price:  101.56673066086282
curr_Factors:  [1.01566731e+02 3.70482856e-02]
mat_Sqrt:  [[ 1.95494945e+01  0.00000000e+00]
 [-7.69917249e-03  1.76410204e-02]]
grads:  [2.87828169e-03 1.05758899e+01]
Stock Position:  0.0028782816919427157
Bond Position:  [2.75881864]


portfolio before change:  [3.04986379]
curr_Stock_Price:  100.99785457301878
curr_Factors:  [1.00997855e+02 3.80955546e-02]
mat_Sqrt:  [[ 1.97128446e+01  0.00000000e+00]
 [-7.80723302e-03  1.78886181e-02]]
grads:  [-0.03009876 -5.30737147]
Stock Position:  -0.030098761739540625
Bond Position:  [6.08977415]


portfolio before change:  [3.09021338]
curr_Stock_Price:  99.68257395841735
curr_Factors:  [9.96825740e+01 3.89895788e-02]
mat_Sqrt:  [[ 1.96831007e+01  0.00000000e+00]
 [-7.89831160e-03  1.80973054e-02]]
grads:  [-0.00983293 -3.40870363]
Stock Position:  -0.009832929396426169
Bond Position:  [4.07038509]


portfolio before change:  [3.08656097]
curr_Stock_Price:  100.10576818339935
curr_Factors:  [1.00105768e+02 3.76034039e-02]
mat_Sqrt:  [[ 1.94121073e+01  0.00000000e+00]
 [-7.75663885e-03  1.77726923e-02]]
grads:  [-1.26808136e-03 -4.12718313e+00]
Stock Position:  -0.0012680813612450917
Bond Position:  [3.21350322]


portfolio before change:  [3.08767052]
curr_Stock_Price:  99.54756929396947
curr_Factors:  [9.95475693e+01 3.69442409e-02]
mat_Sqrt:  [[ 1.91339235e+01  0.00000000e+00]
 [-7.68835389e-03  1.76162318e-02]]
grads:  [-3.71977840e-03  8.71106071e+00]
Stock Position:  -0.003719778401206761
Bond Position:  [3.45796542]


portfolio before change:  [3.08915562]
curr_Stock_Price:  99.26453441544993
curr_Factors:  [9.92645344e+01 3.73448239e-02]
mat_Sqrt:  [[ 1.91826816e+01  0.00000000e+00]
 [-7.72992356e-03  1.77114799e-02]]
grads:  [0.00073644 0.67039665]
Stock Position:  0.0007364441489838164
Bond Position:  [3.01605283]


portfolio before change:  [3.09013553]
curr_Stock_Price:  100.08317238002
curr_Factors:  [1.00083172e+02 3.86087993e-02]
mat_Sqrt:  [[ 1.96654646e+01  0.00000000e+00]
 [-7.85964877e-03  1.80087177e-02]]
grads:  [-1.94140138e-03  5.27508161e+00]
Stock Position:  -0.0019414013805889169
Bond Position:  [3.28443714]


portfolio before change:  [3.09186128]
curr_Stock_Price:  99.40574165223373
curr_Factors:  [9.94057417e+01 3.89073065e-02]
mat_Sqrt:  [[ 1.96077180e+01  0.00000000e+00]
 [-7.88997404e-03  1.80782016e-02]]
grads:  [-5.87019885e-03  5.87156235e+00]
Stock Position:  -0.005870198853524283
Bond Position:  [3.67539275]


portfolio before change:  [3.08181441]
curr_Stock_Price:  101.1955138432201
curr_Factors:  [1.01195514e+02 3.70282621e-02]
mat_Sqrt:  [[ 1.94727785e+01  0.00000000e+00]
 [-7.69709162e-03  1.76362525e-02]]
grads:  [-6.34226864e-03 -1.33040279e+01]
Stock Position:  -0.006342268637952556
Bond Position:  [3.72362354]


portfolio before change:  [3.07786506]
curr_Stock_Price:  101.89161091525753
curr_Factors:  [1.01891611e+02 3.69637948e-02]
mat_Sqrt:  [[ 1.95896512e+01  0.00000000e+00]
 [-7.69038826e-03  1.76208932e-02]]
grads:  [-7.41175631e-04 -2.52995419e+00]
Stock Position:  -0.0007411756311859517
Bond Position:  [3.15338464]


portfolio before change:  [3.07788685]
curr_Stock_Price:  102.3940602468551
curr_Factors:  [1.02394060e+02 3.72697447e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.07788685]
Stock Price:  103.46775607953275
PL:  [-0.38986923]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.43100905e+00  3.58436923e-01]
 [ 8.29420230e-01  9.36936841e-02]
 [ 5.04112035e-02 -4.22793142e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.48593484e-02  1.97301255e-01]
 [ 3.95504595e-03 -7.74847935e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.39319843e-01  8.33897500e-01]
 [-1.82873659e-02  2.83586286e-01]
 [ 1.90299850e-01  8.37301394e-02]
 [-3.58040858e-02  1.65011926e-02]
 [ 7.02953592e-02 -1.17030818e-01]
 [-1.18993639e-01 -2.58028480e-02]
 [-1.29481693e-01  2.90719103e-01]
 [ 4.66917048e-01  3.03011914e-01]
 [ 1.32173074e-01 -1.37694279e-02]
 [ 4.06901437e-02  1.06544799e-01]
 [ 2.54576447e-01  6.78656342e-02]
 [ 3.73998789e-03  1.65910240e-02]
 [-2.72719704e-01  8.99293617e-02]
 [ 1.50974914e-01 -2.71008309e-03]
 [ 1.20017131e+00  1.17280624e-01]
 [ 2.06497750e-02  8.58685597e-02]
 [-3.39331329e-02  4.75472844e-02]
 [-2.01434515e-01  1.90694493e-01]
 [ 1.20054839e-01 -1.06822458e-01]
 [-2.14646878e-01 -4.35195391e-01]
 [ 4.71433682e-02  1.06245889e-01]
 [ 1.41004883e-01  5.79721827e-02]
 [-5.37065379e-01 -1.55960529e-01]
 [-1.12164258e-01 -3.82276057e-02]
 [ 1.40635137e-03 -5.08634127e-02]
 [-4.66894281e-02  1.68068445e-01]
 [ 5.69799241e-03  1.44707961e-02]
 [ 4.42932957e-02  8.20347689e-03]
 [-1.55212358e-01  1.07597229e-01]
 [-2.43072341e-02 -2.05476872e-01]
 [-4.71433437e-03 -2.76883048e-02]
 [-4.70100810e-02 -7.49252906e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.16494447]
curr_Stock_Price:  98.42557860483477
curr_Factors:  [9.84255786e+01 3.95828483e-02]
mat_Sqrt:  [[ 1.95822007e+01  0.00000000e+00]
 [-7.95817550e-03  1.82344708e-02]]
grads:  [ 0.08106565 19.65710588]
Stock Position:  0.08106564581954041
Bond Position:  [-16.14387757]


portfolio before change:  [-8.10919212]
curr_Stock_Price:  99.13821669125005
curr_Factors:  [9.91382167e+01 3.96782836e-02]
mat_Sqrt:  [[ 1.97477464e+01  0.00000000e+00]
 [-7.96776341e-03  1.82564395e-02]]
grads:  [0.04407143 5.13208965]
Stock Position:  0.044071434203297094
Bond Position:  [-12.47835551]


portfolio before change:  [-8.0390936]
curr_Stock_Price:  100.76417711375544
curr_Factors:  [1.00764177e+02 3.85804616e-02]
mat_Sqrt:  [[ 1.97920087e+01  0.00000000e+00]
 [-7.85676387e-03  1.80021076e-02]]
grads:  [ 1.61474252e-03 -2.34857580e+00]
Stock Position:  0.001614742523328126
Bond Position:  [-8.2018018]


portfolio before change:  [-8.04045849]
curr_Stock_Price:  100.55386759329271
curr_Factors:  [1.00553868e+02 3.77869385e-02]
mat_Sqrt:  [[ 1.95465283e+01  0.00000000e+00]
 [-7.77554510e-03  1.78160120e-02]]
grads:  [-8.33977610e-04 -8.49723341e+00]
Stock Position:  -0.0008339776095386437
Bond Position:  [-7.95659881]


portfolio before change:  [-8.04006333]
curr_Stock_Price:  98.88741058518653
curr_Factors:  [9.88874106e+01 3.71356908e-02]
mat_Sqrt:  [[ 1.90562200e+01  0.00000000e+00]
 [-7.70824917e-03  1.76618176e-02]]
grads:  [5.90357302e-04 1.11710617e+01]
Stock Position:  0.0005903573022752218
Bond Position:  [-8.09844224]


portfolio before change:  [-8.04180925]
curr_Stock_Price:  97.64485905109021
curr_Factors:  [9.76448591e+01 3.78278163e-02]
mat_Sqrt:  [[ 1.89913142e+01  0.00000000e+00]
 [-7.77974975e-03  1.78256461e-02]]
grads:  [-1.57240779e-03 -4.34681544e+00]
Stock Position:  -0.0015724077910950244
Bond Position:  [-7.88827172]


portfolio before change:  [-8.04403601]
curr_Stock_Price:  98.43388222664709
curr_Factors:  [9.84338822e+01 3.76581587e-02]
mat_Sqrt:  [[ 1.91017939e+01  0.00000000e+00]
 [-7.76228407e-03  1.77856271e-02]]
grads:  [0.00677286 5.40531331]
Stock Position:  0.006772860077426092
Bond Position:  [-8.71071493]


portfolio before change:  [-8.04880833]
curr_Stock_Price:  97.89003361334532
curr_Factors:  [9.78900336e+01 3.86179309e-02]
mat_Sqrt:  [[ 1.92368066e+01  0.00000000e+00]
 [-7.86057818e-03  1.80108473e-02]]
grads:  [ 0.06255002 46.29973746]
Stock Position:  0.06255001550543801
Bond Position:  [-14.17183145]


portfolio before change:  [-8.01523522]
curr_Stock_Price:  98.45509658020663
curr_Factors:  [9.84550966e+01 3.67012499e-02]
mat_Sqrt:  [[ 1.88616043e+01  0.00000000e+00]
 [-7.66302811e-03  1.75582032e-02]]
grads:  [5.59230459e-03 1.61512134e+01]
Stock Position:  0.005592304587036715
Bond Position:  [-8.56582611]


portfolio before change:  [-8.01503755]
curr_Stock_Price:  98.68192017673412
curr_Factors:  [9.86819202e+01 3.65088884e-02]
mat_Sqrt:  [[ 1.88554498e+01  0.00000000e+00]
 [-7.64291970e-03  1.75121290e-02]]
grads:  [0.01203062 4.78126556]
Stock Position:  0.012030616160011805
Bond Position:  [-9.20224186]


portfolio before change:  [-8.03610583]
curr_Stock_Price:  97.02631687015088
curr_Factors:  [9.70263169e+01 3.66271040e-02]
mat_Sqrt:  [[ 1.85690992e+01  0.00000000e+00]
 [-7.65528356e-03  1.75404582e-02]]
grads:  [-0.00154032  0.94075037]
Stock Position:  -0.001540321079214497
Bond Position:  [-7.88665415]


portfolio before change:  [-8.03710151]
curr_Stock_Price:  97.03266562471768
curr_Factors:  [9.70326656e+01 3.71557443e-02]
mat_Sqrt:  [[ 1.87038472e+01  0.00000000e+00]
 [-7.71033014e-03  1.76665858e-02]]
grads:  [ 1.02753848e-03 -6.62441628e+00]
Stock Position:  0.0010275384787486535
Bond Position:  [-8.1368063]


portfolio before change:  [-8.03853443]
curr_Stock_Price:  96.62804336049538
curr_Factors:  [9.66280434e+01 3.85193222e-02]
mat_Sqrt:  [[ 1.89645483e+01  0.00000000e+00]
 [-7.85053600e-03  1.79878377e-02]]
grads:  [-0.00686834 -1.43446079]
Stock Position:  -0.006868337861725568
Bond Position:  [-7.37486039]


portfolio before change:  [-8.0350441]
curr_Stock_Price:  95.98563861422717
curr_Factors:  [9.59856386e+01 3.78667593e-02]
mat_Sqrt:  [[ 1.86782132e+01  0.00000000e+00]
 [-7.78375327e-03  1.78348193e-02]]
grads:  [-1.39278561e-04  1.63006475e+01]
Stock Position:  -0.00013927856096552
Bond Position:  [-8.02167536]


portfolio before change:  [-8.03623113]
curr_Stock_Price:  97.30862486516172
curr_Factors:  [9.73086249e+01 3.77606776e-02]
mat_Sqrt:  [[ 1.89091159e+01  0.00000000e+00]
 [-7.77284273e-03  1.78098201e-02]]
grads:  [ 0.03168643 17.01375489]
Stock Position:  0.03168642527432962
Bond Position:  [-11.1195936]


portfolio before change:  [-8.07199441]
curr_Stock_Price:  96.22383091483431
curr_Factors:  [9.62238309e+01 3.83313763e-02]
mat_Sqrt:  [[ 1.88390869e+01  0.00000000e+00]
 [-7.83136017e-03  1.79439004e-02]]
grads:  [ 0.00669691 -0.7673598 ]
Stock Position:  0.006696906491806712
Bond Position:  [-8.71639641]


portfolio before change:  [-8.07451488]
curr_Stock_Price:  96.01017232016454
curr_Factors:  [9.60101723e+01 4.02008071e-02]
mat_Sqrt:  [[ 1.92501729e+01  0.00000000e+00]
 [-8.02005557e-03  1.83762559e-02]]
grads:  [4.52931549e-03 5.79796016e+00]
Stock Position:  0.004529315485096658
Bond Position:  [-8.50937524]


portfolio before change:  [-8.08067913]
curr_Stock_Price:  94.88406091715703
curr_Factors:  [9.48840609e+01 4.22504300e-02]
mat_Sqrt:  [[ 1.95033328e+01  0.00000000e+00]
 [-8.22196376e-03  1.88388856e-02]]
grads:  [0.01457163 3.60242296]
Stock Position:  0.014571634575193195
Bond Position:  [-9.463295]


portfolio before change:  [-8.05809706]
curr_Stock_Price:  96.51497320912793
curr_Factors:  [9.65149732e+01 4.36013601e-02]
mat_Sqrt:  [[ 2.01532324e+01  0.00000000e+00]
 [-8.35237548e-03  1.91376964e-02]]
grads:  [5.44870628e-04 8.66928997e-01]
Stock Position:  0.0005448706278232394
Bond Position:  [-8.11068523]


portfolio before change:  [-8.05846309]
curr_Stock_Price:  97.70400981898646
curr_Factors:  [9.77040098e+01 4.26435490e-02]
mat_Sqrt:  [[ 2.01761853e+01  0.00000000e+00]
 [-8.26012581e-03  1.89263259e-02]]
grads:  [-0.01157163  4.75154883]
Stock Position:  -0.011571628091796524
Bond Position:  [-6.92786862]


portfolio before change:  [-8.05896126]
curr_Stock_Price:  97.67221962289162
curr_Factors:  [9.76722196e+01 4.16097603e-02]
mat_Sqrt:  [[ 1.99236390e+01  0.00000000e+00]
 [-8.15938825e-03  1.86955071e-02]]
grads:  [ 0.00751831 -0.14495906]
Stock Position:  0.007518312135459686
Bond Position:  [-8.7932915]


portfolio before change:  [-8.06231971]
curr_Stock_Price:  97.37172399231164
curr_Factors:  [9.73717240e+01 4.03130738e-02]
mat_Sqrt:  [[ 1.95504076e+01  0.00000000e+00]
 [-8.03124636e-03  1.84018972e-02]]
grads:  [0.06400668 6.37328979]
Stock Position:  0.06400668443464091
Bond Position:  [-14.29476092]


portfolio before change:  [-8.00536337]
curr_Stock_Price:  98.28949220984975
curr_Factors:  [9.82894922e+01 4.01417563e-02]
mat_Sqrt:  [[ 1.96927005e+01  0.00000000e+00]
 [-8.01416309e-03  1.83627545e-02]]
grads:  [2.95164631e-03 4.67623524e+00]
Stock Position:  0.0029516463120436865
Bond Position:  [-8.29547919]


portfolio before change:  [-8.0029271]
curr_Stock_Price:  99.46621296548744
curr_Factors:  [9.94662130e+01 3.94327287e-02]
mat_Sqrt:  [[ 1.97516781e+01  0.00000000e+00]
 [-7.94307031e-03  1.81998605e-02]]
grads:  [-6.67376038e-04  2.61250818e+00]
Stock Position:  -0.0006673760379802061
Bond Position:  [-7.93654574]


portfolio before change:  [-8.00267987]
curr_Stock_Price:  97.60914372893079
curr_Factors:  [9.76091437e+01 4.22013711e-02]
mat_Sqrt:  [[ 2.00518193e+01  0.00000000e+00]
 [-8.21718892e-03  1.88279451e-02]]
grads:  [-5.89515659e-03  1.01282690e+01]
Stock Position:  -0.0058951565867492685
Bond Position:  [-7.42725868]


portfolio before change:  [-8.00612335]
curr_Stock_Price:  98.03576814149672
curr_Factors:  [9.80357681e+01 4.20473450e-02]
mat_Sqrt:  [[ 2.01026747e+01  0.00000000e+00]
 [-8.20217971e-03  1.87935547e-02]]
grads:  [ 3.65293160e-03 -5.68399433e+00]
Stock Position:  0.0036529315990897556
Bond Position:  [-8.36424131]


portfolio before change:  [-8.00830688]
curr_Stock_Price:  97.72425790561319
curr_Factors:  [9.77242579e+01 4.18667084e-02]
mat_Sqrt:  [[ 1.99957082e+01  0.00000000e+00]
 [-8.18454235e-03  1.87531424e-02]]
grads:  [-2.02334278e-02 -2.32065315e+01]
Stock Position:  -0.02023342779196183
Bond Position:  [-6.03101016]


portfolio before change:  [-8.03408943]
curr_Stock_Price:  98.96125221463058
curr_Factors:  [9.89612522e+01 4.12968443e-02]
mat_Sqrt:  [[ 2.01105346e+01  0.00000000e+00]
 [-8.12865000e-03  1.86250770e-02]]
grads:  [4.64994481e-03 5.70445372e+00]
Stock Position:  0.0046499448112232835
Bond Position:  [-8.49425379]


portfolio before change:  [-8.03651919]
curr_Stock_Price:  98.66707593387333
curr_Factors:  [9.86670759e+01 4.33227460e-02]
mat_Sqrt:  [[ 2.05366805e+01  0.00000000e+00]
 [-8.32564674e-03  1.90764532e-02]]
grads:  [0.008098   3.03893927]
Stock Position:  0.008097999003352174
Bond Position:  [-8.83552507]


portfolio before change:  [-8.04527494]
curr_Stock_Price:  97.7222444361826
curr_Factors:  [9.77222444e+01 4.39608810e-02]
mat_Sqrt:  [[ 2.04892767e+01  0.00000000e+00]
 [-8.38674011e-03  1.92164357e-02]]
grads:  [-0.02953409 -8.11599671]
Stock Position:  -0.029534089646002855
Bond Position:  [-5.15913741]


portfolio before change:  [-8.02618279]
curr_Stock_Price:  97.0539629072919
curr_Factors:  [9.70539629e+01 4.46769494e-02]
mat_Sqrt:  [[ 2.05142210e+01  0.00000000e+00]
 [-8.45476902e-03  1.93723095e-02]]
grads:  [-0.00628092 -1.97331174]
Stock Position:  -0.006280918636900354
Bond Position:  [-7.41659474]


portfolio before change:  [-8.03541326]
curr_Stock_Price:  98.37595786639926
curr_Factors:  [9.83759579e+01 4.51670309e-02]
mat_Sqrt:  [[ 2.09073864e+01  0.00000000e+00]
 [-8.50101461e-03  1.94782715e-02]]
grads:  [-9.94493596e-04 -2.61128986e+00]
Stock Position:  -0.000994493595780619
Bond Position:  [-7.937579]


portfolio before change:  [-8.0366392]
curr_Stock_Price:  98.61093205572134
curr_Factors:  [9.86109321e+01 4.58148843e-02]
mat_Sqrt:  [[ 2.11070899e+01  0.00000000e+00]
 [-8.56176471e-03  1.96174674e-02]]
grads:  [1.26316109e-03 8.56728553e+00]
Stock Position:  0.0012631610932089038
Bond Position:  [-8.16120069]


portfolio before change:  [-8.03748993]
curr_Stock_Price:  98.74510930280228
curr_Factors:  [9.87451093e+01 4.46261539e-02]
mat_Sqrt:  [[ 2.08598089e+01  0.00000000e+00]
 [-8.44996132e-03  1.93612937e-02]]
grads:  [5.75919256e-04 7.47408531e-01]
Stock Position:  0.0005759192557594403
Bond Position:  [-8.09435914]


portfolio before change:  [-8.03876691]
curr_Stock_Price:  98.28475814784099
curr_Factors:  [9.82847581e+01 4.54471121e-02]
mat_Sqrt:  [[ 2.09526674e+01  0.00000000e+00]
 [-8.52733131e-03  1.95385706e-02]]
grads:  [0.00228484 0.41986065]
Stock Position:  0.0022848444864213106
Bond Position:  [-8.2633323]


portfolio before change:  [-8.037559]
curr_Stock_Price:  99.26552077373299
curr_Factors:  [9.92655208e+01 4.40153984e-02]
mat_Sqrt:  [[ 2.08257545e+01  0.00000000e+00]
 [-8.39193884e-03  1.92283475e-02]]
grads:  [-5.19803869e-03  5.59576059e+00]
Stock Position:  -0.0051980386851524524
Bond Position:  [-7.52157298]


portfolio before change:  [-8.04465217]
curr_Stock_Price:  100.4492198500638
curr_Factors:  [1.00449220e+02 4.36240539e-02]
mat_Sqrt:  [[ 2.09801978e+01  0.00000000e+00]
 [-8.35454883e-03  1.91426762e-02]]
grads:  [-5.43296560e-03 -1.07339679e+01]
Stock Position:  -0.00543296560083087
Bond Position:  [-7.49891501]


portfolio before change:  [-8.04295151]
curr_Stock_Price:  99.9636498667267
curr_Factors:  [9.99636499e+01 4.42618229e-02]
mat_Sqrt:  [[ 2.10308465e+01  0.00000000e+00]
 [-8.41539759e-03  1.92820982e-02]]
grads:  [-7.98755359e-04 -1.43595912e+00]
Stock Position:  -0.0007987553587021693
Bond Position:  [-7.96310501]


portfolio before change:  [-8.04502824]
curr_Stock_Price:  101.31736405818077
curr_Factors:  [1.01317364e+02 4.15879977e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.04502824]
Stock Price:  101.08890621105748
PL:  [-9.13393446]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.45853092e+00  3.62623730e-01]
 [ 9.12024596e-01  8.50705406e-02]
 [ 1.11957866e-01 -3.98576621e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.14058018e-01 -2.95148999e-01]
 [-3.83393456e-01  2.20754295e-01]
 [ 3.09883113e-01 -3.58830848e-01]
 [-6.23463668e-01  1.50903589e-01]
 [-1.15807083e-01 -1.09942993e-01]
 [-2.35319618e-01 -5.01800640e-01]
 [-6.10768070e-02 -1.44204259e-02]
 [-2.90257381e-01 -2.71752948e-01]
 [-4.67116533e-02 -3.34544617e-02]
 [ 2.27747828e-02 -1.95628417e-01]
 [-1.99713452e-01 -1.29778802e-01]
 [ 7.16125222e-02 -1.37881567e+00]
 [ 2.14530482e-03 -6.20289698e-01]
 [ 9.82959539e-02 -2.17916816e-01]
 [-9.98836982e-02 -6.57131647e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 6.76089080e-02 -3.48650846e-02]
 [ 2.47734770e-01 -7.44787556e-01]
 [ 2.74704886e-02 -3.55339971e-01]
 [-1.62259487e-02  2.83627689e-01]
 [ 5.32661985e-01 -7.06305727e-01]
 [-9.31300677e-01  1.50685586e-01]
 [-1.67877286e-01  2.55146150e-01]
 [-1.15260538e-01 -3.94292953e-01]
 [-7.61673913e-02  2.59525943e-01]
 [-4.48715020e-01  9.69621244e-01]
 [-9.84353653e-02  6.69772633e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.31687172e-01 -3.03043048e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.64828425e-01  5.35208968e-02]
 [-2.21812150e-02 -2.24242913e-01]
 [ 1.77762430e-02 -2.95815191e-02]
 [-3.24810437e-02 -1.02164520e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.62365538]
curr_Stock_Price:  98.64930436884995
curr_Factors:  [9.86493044e+01 4.18316095e-02]
mat_Sqrt:  [[ 2.01765224e+01  0.00000000e+00]
 [-8.18111088e-03  1.87452799e-02]]
grads:  [ 0.08013239 19.34480204]
Stock Position:  0.08013238623312302
Bond Position:  [-14.52865954]


portfolio before change:  [-6.60768442]
curr_Stock_Price:  98.87127648428539
curr_Factors:  [9.88712765e+01 4.29933094e-02]
mat_Sqrt:  [[ 2.05007892e+01  0.00000000e+00]
 [-8.29393122e-03  1.90037838e-02]]
grads:  [0.04629834 4.47650539]
Stock Position:  0.04629833593500034
Bond Position:  [-11.18526]


portfolio before change:  [-6.56783883]
curr_Stock_Price:  99.76210418636522
curr_Factors:  [9.97621042e+01 4.20342609e-02]
mat_Sqrt:  [[ 2.04534846e+01  0.00000000e+00]
 [-8.20090345e-03  1.87906304e-02]]
grads:  [ 0.0046233  -2.12114555]
Stock Position:  0.004623298091793746
Bond Position:  [-7.02906877]


portfolio before change:  [-6.56382286]
curr_Stock_Price:  100.82079699233097
curr_Factors:  [1.00820797e+02 4.23334794e-02]
mat_Sqrt:  [[ 2.07439811e+01  0.00000000e+00]
 [-8.23004052e-03  1.88573918e-02]]
grads:  [-7.85835991e-04 -8.02798254e+00]
Stock Position:  -0.0007858359910224527
Bond Position:  [-6.48459425]


portfolio before change:  [-6.56533895]
curr_Stock_Price:  101.7185140362967
curr_Factors:  [1.01718514e+02 4.22931880e-02]
mat_Sqrt:  [[ 2.09187254e+01  0.00000000e+00]
 [-8.22612307e-03  1.88484158e-02]]
grads:  [-1.16102486e-02 -1.56590879e+01]
Stock Position:  -0.011610248586926388
Bond Position:  [-5.38436171]


portfolio before change:  [-6.57513817]
curr_Stock_Price:  102.50455495987515
curr_Factors:  [1.02504555e+02 4.16590863e-02]
mat_Sqrt:  [[ 2.09217513e+01  0.00000000e+00]
 [-8.16422305e-03  1.87065851e-02]]
grads:  [-0.01372009 11.80088693]
Stock Position:  -0.013720093454503795
Bond Position:  [-5.16876609]


portfolio before change:  [-6.58683858]
curr_Stock_Price:  103.31025456931394
curr_Factors:  [1.03310255e+02 3.97121009e-02]
mat_Sqrt:  [[ 2.05875593e+01  0.00000000e+00]
 [-7.97115810e-03  1.82642177e-02]]
grads:  [ 7.44510260e-03 -1.96466585e+01]
Stock Position:  0.007445102603079191
Bond Position:  [-7.35599402]


portfolio before change:  [-6.58737633]
curr_Stock_Price:  103.36153638902667
curr_Factors:  [1.03361536e+02 4.07668932e-02]
mat_Sqrt:  [[ 2.08695346e+01  0.00000000e+00]
 [-8.07632522e-03  1.85051858e-02]]
grads:  [-0.02671856  8.15466488]
Stock Position:  -0.0267185614341149
Bond Position:  [-3.82570477]


portfolio before change:  [-6.58648417]
curr_Stock_Price:  103.31024609322054
curr_Factors:  [1.03310246e+02 4.00071815e-02]
mat_Sqrt:  [[ 2.06639039e+01  0.00000000e+00]
 [-8.00071812e-03  1.83319482e-02]]
grads:  [-0.00792639 -5.99734366]
Stock Position:  -0.007926388909845955
Bond Position:  [-5.76760698]


portfolio before change:  [-6.58403911]
curr_Stock_Price:  102.91081279285844
curr_Factors:  [1.02910813e+02 3.91226469e-02]
mat_Sqrt:  [[ 2.03551883e+01  0.00000000e+00]
 [-7.91177825e-03  1.81281614e-02]]
grads:  [-2.23197824e-02 -2.76807245e+01]
Stock Position:  -0.022319782357970632
Bond Position:  [-4.28709216]


portfolio before change:  [-6.5756385]
curr_Stock_Price:  102.51042700221944
curr_Factors:  [1.02510427e+02 3.93895386e-02]
mat_Sqrt:  [[ 2.03450372e+01  0.00000000e+00]
 [-7.93871915e-03  1.81898907e-02]]
grads:  [-0.00331139 -0.79277144]
Stock Position:  -0.003311392161224721
Bond Position:  [-6.23618628]


portfolio before change:  [-6.58702564]
curr_Stock_Price:  105.71378082209928
curr_Factors:  [1.05713781e+02 3.66196487e-02]
mat_Sqrt:  [[ 2.02296651e+01  0.00000000e+00]
 [-7.65450442e-03  1.75386730e-02]]
grads:  [ -0.02021092 -15.49449887]
Stock Position:  -0.02021091746282827
Bond Position:  [-4.45045314]


portfolio before change:  [-6.56538736]
curr_Stock_Price:  104.6156311138721
curr_Factors:  [1.04615631e+02 3.89125953e-02]
mat_Sqrt:  [[ 2.06367678e+01  0.00000000e+00]
 [-7.89051028e-03  1.80794303e-02]]
grads:  [-0.00297103 -1.8504157 ]
Stock Position:  -0.0029710261762865265
Bond Position:  [-6.25457159]


portfolio before change:  [-6.56767877]
curr_Stock_Price:  105.12371689367336
curr_Factors:  [1.05123717e+02 3.73356146e-02]
mat_Sqrt:  [[ 2.03124524e+01  0.00000000e+00]
 [-7.72897039e-03  1.77092959e-02]]
grads:  [-3.08207285e-03 -1.10466513e+01]
Stock Position:  -0.003082072846267293
Bond Position:  [-6.24367982]


portfolio before change:  [-6.57447031]
curr_Stock_Price:  107.07403894937703
curr_Factors:  [1.07074039e+02 3.86721327e-02]
mat_Sqrt:  [[ 2.10563575e+01  0.00000000e+00]
 [-7.86609257e-03  1.80234823e-02]]
grads:  [-0.01217464 -7.20053984]
Stock Position:  -0.01217463962822616
Bond Position:  [-5.27088248]


portfolio before change:  [-6.60273357]
curr_Stock_Price:  109.34140388138589
curr_Factors:  [1.09341404e+02 3.90171406e-02]
mat_Sqrt:  [[ 2.15979417e+01  0.00000000e+00]
 [-7.90110277e-03  1.81037008e-02]]
grads:  [-2.45464117e-02 -7.61620890e+01]
Stock Position:  -0.02454641171293855
Bond Position:  [-3.91879445]


portfolio before change:  [-6.62836973]
curr_Stock_Price:  110.36584221973408
curr_Factors:  [1.10365842e+02 4.04055554e-02]
mat_Sqrt:  [[ 2.21847849e+01  0.00000000e+00]
 [-8.04045326e-03  1.84229929e-02]]
grads:  [-1.21061040e-02 -3.36693231e+01]
Stock Position:  -0.012106104019129187
Bond Position:  [-5.29226936]


portfolio before change:  [-6.61816489]
curr_Stock_Price:  109.46824442109731
curr_Factors:  [1.09468244e+02 4.03646169e-02]
mat_Sqrt:  [[ 2.19932075e+01  0.00000000e+00]
 [-8.03637898e-03  1.84136575e-02]]
grads:  [ 1.4501106e-04 -1.1834521e+01]
Stock Position:  0.0001450110602519806
Bond Position:  [-6.634039]


portfolio before change:  [-6.61887164]
curr_Stock_Price:  110.31342513505396
curr_Factors:  [1.10313425e+02 3.86330550e-02]
mat_Sqrt:  [[ 2.16824271e+01  0.00000000e+00]
 [-7.86211727e-03  1.80143738e-02]]
grads:  [-0.00592938 -3.64781844]
Stock Position:  -0.005929376531660582
Bond Position:  [-5.96478181]


portfolio before change:  [-6.61798837]
curr_Stock_Price:  110.03870633263142
curr_Factors:  [1.10038706e+02 3.69176852e-02]
mat_Sqrt:  [[ 2.11428100e+01  0.00000000e+00]
 [-7.68559017e-03  1.76098994e-02]]
grads:  [-2.29208275e-04 -6.19500356e+00]
Stock Position:  -0.0002292082750210348
Bond Position:  [-6.59276659]


portfolio before change:  [-6.61876807]
curr_Stock_Price:  109.84479293806147
curr_Factors:  [1.09844793e+02 3.86155670e-02]
mat_Sqrt:  [[ 2.15854289e+01  0.00000000e+00]
 [-7.86033760e-03  1.80102960e-02]]
grads:  [ 0.00242722 -1.93584184]
Stock Position:  0.00242721781627666
Bond Position:  [-6.88538531]


portfolio before change:  [-6.61917987]
curr_Stock_Price:  110.02975149688125
curr_Factors:  [1.10029751e+02 3.81428387e-02]
mat_Sqrt:  [[ 2.14890214e+01  0.00000000e+00]
 [-7.81207667e-03  1.78997163e-02]]
grads:  [-3.59798463e-03 -4.16089027e+01]
Stock Position:  -0.003597984626749423
Bond Position:  [-6.22329451]


portfolio before change:  [-6.6160004]
curr_Stock_Price:  108.92984987775779
curr_Factors:  [1.08929850e+02 3.72471313e-02]
mat_Sqrt:  [[ 2.10229337e+01  0.00000000e+00]
 [-7.71980635e-03  1.76882985e-02]]
grads:  [-6.07016087e-03 -2.00889855e+01]
Stock Position:  -0.006070160865775528
Bond Position:  [-5.95477869]


portfolio before change:  [-6.62617616]
curr_Stock_Price:  110.48357674230081
curr_Factors:  [1.10483577e+02 3.71938949e-02]
mat_Sqrt:  [[ 2.13075519e+01  0.00000000e+00]
 [-7.71428752e-03  1.76756532e-02]]
grads:  [5.04794373e-03 1.60462352e+01]
Stock Position:  0.005047943725933097
Bond Position:  [-7.18389104]


portfolio before change:  [-6.62270098]
curr_Stock_Price:  111.34991498112338
curr_Factors:  [1.11349915e+02 3.65910486e-02]
mat_Sqrt:  [[ 2.12998879e+01  0.00000000e+00]
 [-7.65151474e-03  1.75318227e-02]]
grads:  [ 1.05354965e-02 -4.02870676e+01]
Stock Position:  0.010535496476687507
Bond Position:  [-7.79582762]


portfolio before change:  [-6.62579155]
curr_Stock_Price:  111.1490671138858
curr_Factors:  [1.11149067e+02 3.71023338e-02]
mat_Sqrt:  [[ 2.14094956e+01  0.00000000e+00]
 [-7.70478644e-03  1.76538835e-02]]
grads:  [-0.04042767  8.53554888]
Stock Position:  -0.04042767331923609
Bond Position:  [-2.13229338]


portfolio before change:  [-6.58480288]
curr_Stock_Price:  110.12859712595137
curr_Factors:  [1.10128597e+02 3.85517801e-02]
mat_Sqrt:  [[ 2.16233175e+01  0.00000000e+00]
 [-7.85384290e-03  1.79954148e-02]]
grads:  [-2.61395490e-03  1.41783978e+01]
Stock Position:  -0.002613954899352122
Bond Position:  [-6.29693169]


portfolio before change:  [-6.58914111]
curr_Stock_Price:  111.4871001875807
curr_Factors:  [1.11487100e+02 3.87581858e-02]
mat_Sqrt:  [[ 2.19485755e+01  0.00000000e+00]
 [-7.87483950e-03  1.80435241e-02]]
grads:  [-1.30916966e-02 -2.18523251e+01]
Stock Position:  -0.013091696571563421
Bond Position:  [-5.12958582]


portfolio before change:  [-6.57235348]
curr_Stock_Price:  110.1558083005047
curr_Factors:  [1.10155808e+02 4.05814973e-02]
mat_Sqrt:  [[ 2.21907221e+01  0.00000000e+00]
 [-8.05793992e-03  1.84630598e-02]]
grads:  [1.67182554e-03 1.40564969e+01]
Stock Position:  0.0016718255421154084
Bond Position:  [-6.75651477]


portfolio before change:  [-6.57416574]
curr_Stock_Price:  109.57701465975805
curr_Factors:  [1.09577015e+02 4.13692030e-02]
mat_Sqrt:  [[ 2.22873299e+01  0.00000000e+00]
 [-8.13576824e-03  1.86413869e-02]]
grads:  [-1.14583556e-03  5.20144370e+01]
Stock Position:  -0.001145835558760858
Bond Position:  [-6.4486085]


portfolio before change:  [-6.57411624]
curr_Stock_Price:  108.83029407609646
curr_Factors:  [1.08830294e+02 4.12151647e-02]
mat_Sqrt:  [[ 2.20942021e+01  0.00000000e+00]
 [-8.12060734e-03  1.86066489e-02]]
grads:  [-3.13222857e-03  3.59964137e+00]
Stock Position:  -0.0031322285721746834
Bond Position:  [-6.23323489]


portfolio before change:  [-6.56977335]
curr_Stock_Price:  107.19500654053975
curr_Factors:  [1.07195007e+02 4.15285834e-02]
mat_Sqrt:  [[ 2.18448020e+01  0.00000000e+00]
 [-8.15142524e-03  1.86772616e-02]]
grads:  [ 0.00332082 -0.63966492]
Stock Position:  0.0033208173091006246
Bond Position:  [-6.92574839]


portfolio before change:  [-6.57571521]
curr_Stock_Price:  105.66644220816009
curr_Factors:  [1.05666442e+02 4.21046317e-02]
mat_Sqrt:  [[ 2.16821339e+01  0.00000000e+00]
 [-8.20776527e-03  1.88063528e-02]]
grads:  [-0.01129562 -1.61138659]
Stock Position:  -0.011295615866246791
Bond Position:  [-5.38214767]


portfolio before change:  [-6.5512964]
curr_Stock_Price:  103.44508303122487
curr_Factors:  [1.03445083e+02 4.30001904e-02]
mat_Sqrt:  [[ 2.14508765e+01  0.00000000e+00]
 [-8.29459490e-03  1.90053045e-02]]
grads:  [0.0047304  2.80706162]
Stock Position:  0.004730397468205284
Bond Position:  [-7.04063276]


portfolio before change:  [-6.55304942]
curr_Stock_Price:  103.26055506490566
curr_Factors:  [1.03260555e+02 4.31605864e-02]
mat_Sqrt:  [[ 2.14525105e+01  0.00000000e+00]
 [-8.31005044e-03  1.90407176e-02]]
grads:  [-0.00441289  4.27111772]
Stock Position:  -0.004412891940690084
Bond Position:  [-6.09737175]


portfolio before change:  [-6.54900732]
curr_Stock_Price:  102.17185399565629
curr_Factors:  [1.02171854e+02 4.39513040e-02]
mat_Sqrt:  [[ 2.14198861e+01  0.00000000e+00]
 [-8.38582652e-03  1.92143424e-02]]
grads:  [-0.01127317  2.78546597]
Stock Position:  -0.011273168774699714
Bond Position:  [-5.39720677]


portfolio before change:  [-6.53460647]
curr_Stock_Price:  100.83455948293809
curr_Factors:  [1.00834559e+02 4.41965102e-02]
mat_Sqrt:  [[ 2.11984152e+01  0.00000000e+00]
 [-8.40918642e-03  1.92678667e-02]]
grads:  [-5.66310474e-03 -1.16381807e+01]
Stock Position:  -0.005663104740201958
Bond Position:  [-5.9635698]


portfolio before change:  [-6.53709414]
curr_Stock_Price:  101.14219539759728
curr_Factors:  [1.01142195e+02 4.42305236e-02]
mat_Sqrt:  [[ 2.12712698e+01  0.00000000e+00]
 [-8.41242163e-03  1.92752795e-02]]
grads:  [ 2.28750314e-04 -1.53468691e+00]
Stock Position:  0.000228750313878768
Bond Position:  [-6.56023044]


portfolio before change:  [-6.53806791]
curr_Stock_Price:  100.47029820047014
curr_Factors:  [1.00470298e+02 4.21219491e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.53806791]
Stock Price:  101.02768714965732
PL:  [-7.56575506]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.10259410e+00  2.78175651e-01]
 [ 5.44223572e-01  1.23025624e-01]
 [ 1.09961974e-01 -1.47401024e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.06161555e-01 -1.79453611e-01]
 [-3.83570404e-01  2.20974933e-01]
 [ 4.03802358e-01 -4.81013688e-01]
 [-6.06071839e-01  1.82519124e-01]
 [-1.14904739e-01 -1.08608376e-01]
 [-5.21341251e-01 -7.28139450e-01]
 [-6.07913855e-02 -1.33131711e-02]
 [-2.70052719e-01 -2.60263378e-01]
 [-2.19512577e-02  3.31080011e-03]
 [ 2.27957274e-02 -1.95821694e-01]
 [-6.41909633e-04 -7.04243574e-02]
 [ 1.07453767e-01 -8.00424938e-01]
 [ 2.20471519e-02 -2.30288841e-01]
 [ 3.64321963e-02 -1.58326069e-01]
 [-1.05739524e-01 -1.70388765e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.12088471e-01 -1.91268115e-02]
 [ 2.65515018e-01 -5.66227565e-01]
 [ 2.73750231e-02 -3.49245041e-01]
 [ 3.44609685e-03  1.91615128e-01]
 [ 4.81925557e-01 -5.30821731e-01]
 [-4.59836710e-01  6.44980606e-02]
 [-1.26815106e-01  1.84991261e-01]
 [-6.30808883e-02  1.45756442e-02]
 [-6.71177741e-02  2.06972263e-01]
 [-7.59349788e-01 -9.48240605e-03]
 [-1.48180787e-01 -2.30127370e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.33705177e-01 -2.43819569e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.20221131e-01 -9.40374111e-02]
 [-2.94787012e-02 -1.58349485e-01]
 [-9.01113484e-03 -6.46293173e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.3668018]
curr_Stock_Price:  100.97039862381516
curr_Factors:  [1.00970399e+02 3.81985223e-02]
mat_Sqrt:  [[ 1.97341012e+01  0.00000000e+00]
 [-7.81777690e-03  1.79127772e-02]]
grads:  [ 0.06202461 15.52945406]
Stock Position:  0.062024608793598314
Bond Position:  [3.10415232]


portfolio before change:  [9.28689837]
curr_Stock_Price:  99.67588878205294
curr_Factors:  [9.96758888e+01 3.75814905e-02]
mat_Sqrt:  [[ 1.93231140e+01  0.00000000e+00]
 [-7.75437843e-03  1.77675131e-02]]
grads:  [0.03094306 6.9241893 ]
Stock Position:  0.030943064082093883
Bond Position:  [6.20262096]


portfolio before change:  [9.30366307]
curr_Stock_Price:  100.19262249666683
curr_Factors:  [1.00192622e+02 3.73833928e-02]
mat_Sqrt:  [[ 1.93720286e+01  0.00000000e+00]
 [-7.73391418e-03  1.77206236e-02]]
grads:  [ 0.00534424 -0.83180495]
Stock Position:  0.005344244943950148
Bond Position:  [8.76820916]


portfolio before change:  [9.30569125]
curr_Stock_Price:  100.36703167195047
curr_Factors:  [1.00367032e+02 3.70712949e-02]
mat_Sqrt:  [[ 1.93245753e+01  0.00000000e+00]
 [-7.70156294e-03  1.76464976e-02]]
grads:  [-8.43556286e-04 -8.57885888e+00]
Stock Position:  -0.0008435562855544879
Bond Position:  [9.3903565]


portfolio before change:  [9.3060923]
curr_Stock_Price:  101.28318022526679
curr_Factors:  [1.01283180e+02 3.62448798e-02]
mat_Sqrt:  [[ 1.92823811e+01  0.00000000e+00]
 [-7.61523524e-03  1.74486960e-02]]
grads:  [-9.56736262e-03 -1.02846431e+01]
Stock Position:  -0.00956736261946876
Bond Position:  [10.27510521]


portfolio before change:  [9.29577389]
curr_Stock_Price:  102.49593604256215
curr_Factors:  [1.02495936e+02 3.49799934e-02]
mat_Sqrt:  [[ 1.91697526e+01  0.00000000e+00]
 [-7.48117567e-03  1.71415269e-02]]
grads:  [-0.01497823 12.89120474]
Stock Position:  -0.014978233834525498
Bond Position:  [10.83098199]


portfolio before change:  [9.26508036]
curr_Stock_Price:  104.63553991718078
curr_Factors:  [1.04635540e+02 3.26674485e-02]
mat_Sqrt:  [[ 1.89119725e+01  0.00000000e+00]
 [-7.22965543e-03  1.65652216e-02]]
grads:  [ 1.02512191e-02 -2.90375643e+01]
Stock Position:  0.010251219118209073
Bond Position:  [8.19243852]


portfolio before change:  [9.24994793]
curr_Stock_Price:  103.05947871203423
curr_Factors:  [1.03059479e+02 3.42925512e-02]
mat_Sqrt:  [[ 1.90848099e+01  0.00000000e+00]
 [-7.40729923e-03  1.69722547e-02]]
grads:  [-0.02758288 10.75397033]
Stock Position:  -0.027582876877710664
Bond Position:  [12.09262485]


portfolio before change:  [9.24197215]
curr_Stock_Price:  103.4034404965551
curr_Factors:  [1.03403440e+02 3.47157838e-02]
mat_Sqrt:  [[ 1.92663070e+01  0.00000000e+00]
 [-7.45286884e-03  1.70766678e-02]]
grads:  [-0.00842431 -6.36004503]
Stock Position:  -0.00842430884488868
Bond Position:  [10.11307467]


portfolio before change:  [9.22620313]
curr_Stock_Price:  105.42535498531522
curr_Factors:  [1.05425355e+02 3.49484762e-02]
mat_Sqrt:  [[ 1.97087552e+01  0.00000000e+00]
 [-7.47780462e-03  1.71338029e-02]]
grads:  [ -0.04257638 -42.49724689]
Stock Position:  -0.04257637548787153
Bond Position:  [13.71483263]


portfolio before change:  [9.27733935]
curr_Stock_Price:  104.26457611139634
curr_Factors:  [1.04264576e+02 3.54185947e-02]
mat_Sqrt:  [[ 1.96224145e+01  0.00000000e+00]
 [-7.52793142e-03  1.72486578e-02]]
grads:  [-0.00339417 -0.77183809]
Stock Position:  -0.00339416588141781
Bond Position:  [9.63123062]


portfolio before change:  [9.27449298]
curr_Stock_Price:  105.45790290956829
curr_Factors:  [1.05457903e+02 3.59334270e-02]
mat_Sqrt:  [[ 1.99907206e+01  0.00000000e+00]
 [-7.58244572e-03  1.73735657e-02]]
grads:  [ -0.01919095 -14.98042379]
Stock Position:  -0.019190952457856295
Bond Position:  [11.29833058]


portfolio before change:  [9.26753556]
curr_Stock_Price:  105.89403576877045
curr_Factors:  [1.05894036e+02 3.63284773e-02]
mat_Sqrt:  [[ 2.01834358e+01  0.00000000e+00]
 [-7.62401231e-03  1.74688068e-02]]
grads:  [-0.001016   0.1895264]
Stock Position:  -0.0010159967943036035
Bond Position:  [9.37512356]


portfolio before change:  [9.26956045]
curr_Stock_Price:  105.05453104470574
curr_Factors:  [1.05054531e+02 3.64871622e-02]
mat_Sqrt:  [[ 2.00671100e+01  0.00000000e+00]
 [-7.64064523e-03  1.75069176e-02]]
grads:  [-3.12291437e-03 -1.11853896e+01]
Stock Position:  -0.003122914371086267
Bond Position:  [9.59763676]


portfolio before change:  [9.27256441]
curr_Stock_Price:  104.47680726234663
curr_Factors:  [1.04476807e+02 3.52084267e-02]
mat_Sqrt:  [[ 1.96039326e+01  0.00000000e+00]
 [-7.50556345e-03  1.71974063e-02]]
grads:  [-1.60057778e-03 -4.09505690e+00]
Stock Position:  -0.0016005777819359944
Bond Position:  [9.43978767]


portfolio before change:  [9.2741586]
curr_Stock_Price:  104.21806500920599
curr_Factors:  [1.04218065e+02 3.52871408e-02]
mat_Sqrt:  [[ 1.95772299e+01  0.00000000e+00]
 [-7.51394871e-03  1.72166194e-02]]
grads:  [-1.23551860e-02 -4.64914116e+01]
Stock Position:  -0.012355185974836072
Bond Position:  [10.56179217]


portfolio before change:  [9.27630693]
curr_Stock_Price:  104.15104658069833
curr_Factors:  [1.04151047e+02 3.48147650e-02]
mat_Sqrt:  [[ 1.94332471e+01  0.00000000e+00]
 [-7.46348605e-03  1.71009949e-02]]
grads:  [-4.03736636e-03 -1.34664002e+01]
Stock Position:  -0.004037366358860476
Bond Position:  [9.69680286]


portfolio before change:  [9.27708909]
curr_Stock_Price:  104.25755637330886
curr_Factors:  [1.04257556e+02 3.50028501e-02]
mat_Sqrt:  [[ 1.95055969e+01  0.00000000e+00]
 [-7.48361946e-03  1.71471263e-02]]
grads:  [-1.67474829e-03 -9.23338793e+00]
Stock Position:  -0.0016747482939001995
Bond Position:  [9.45169425]


portfolio before change:  [9.27531812]
curr_Stock_Price:  106.0205097827332
curr_Factors:  [1.06020510e+02 3.38033777e-02]
mat_Sqrt:  [[ 1.94926075e+01  0.00000000e+00]
 [-7.35427796e-03  1.68507677e-02]]
grads:  [-9.23956826e-03 -1.01116321e+01]
Stock Position:  -0.009239568260167256
Bond Position:  [10.25490186]


portfolio before change:  [9.2783782]
curr_Stock_Price:  105.82806156651718
curr_Factors:  [1.05828062e+02 3.30917487e-02]
mat_Sqrt:  [[ 1.92513283e+01  0.00000000e+00]
 [-7.27645504e-03  1.66724530e-02]]
grads:  [-2.51728449e-04 -6.54333164e+00]
Stock Position:  -0.0002517284486499328
Bond Position:  [9.30501813]


portfolio before change:  [9.2796345]
curr_Stock_Price:  105.45822836160829
curr_Factors:  [1.05458228e+02 3.39512131e-02]
mat_Sqrt:  [[ 1.94315802e+01  0.00000000e+00]
 [-7.37034199e-03  1.68875750e-02]]
grads:  [ 0.00533878 -1.13259668]
Stock Position:  0.005338775574581301
Bond Position:  [8.71661668]


portfolio before change:  [9.29340396]
curr_Stock_Price:  107.83326975709073
curr_Factors:  [1.07833270e+02 3.33709474e-02]
mat_Sqrt:  [[ 1.96986763e+01  0.00000000e+00]
 [-7.30708669e-03  1.67426389e-02]]
grads:  [ 9.33720038e-04 -3.38194933e+01]
Stock Position:  0.0009337200381607918
Bond Position:  [9.19271787]


portfolio before change:  [9.29462026]
curr_Stock_Price:  107.9051818687869
curr_Factors:  [1.07905182e+02 3.21526152e-02]
mat_Sqrt:  [[ 1.93486404e+01  0.00000000e+00]
 [-7.17246013e-03  1.64341707e-02]]
grads:  [-6.46288352e-03 -2.12511508e+01]
Stock Position:  -0.006462883523532412
Bond Position:  [9.99199889]


portfolio before change:  [9.29414468]
curr_Stock_Price:  108.17203821523071
curr_Factors:  [1.08172038e+02 3.36088855e-02]
mat_Sqrt:  [[ 1.98308838e+01  0.00000000e+00]
 [-7.33309054e-03  1.68022212e-02]]
grads:  [4.39081767e-03 1.14041546e+01]
Stock Position:  0.004390817665292361
Bond Position:  [8.81918098]


portfolio before change:  [9.29300751]
curr_Stock_Price:  107.66196625819303
curr_Factors:  [1.07661966e+02 3.50581370e-02]
mat_Sqrt:  [[ 2.01584309e+01  0.00000000e+00]
 [-7.48952730e-03  1.71606629e-02]]
grads:  [ 1.24144564e-02 -3.09324724e+01]
Stock Position:  0.012414456374007586
Bond Position:  [7.95644273]


portfolio before change:  [9.27452452]
curr_Stock_Price:  106.09302007061926
curr_Factors:  [1.06093020e+02 3.55939778e-02]
mat_Sqrt:  [[ 2.00158978e+01  0.00000000e+00]
 [-7.54654653e-03  1.72913103e-02]]
grads:  [-0.02156723  3.73008519]
Stock Position:  -0.021567228837817486
Bond Position:  [11.56265696]


portfolio before change:  [9.2642509]
curr_Stock_Price:  106.63639278145125
curr_Factors:  [1.06636393e+02 3.68349461e-02]
mat_Sqrt:  [[ 2.04661176e+01  0.00000000e+00]
 [-7.67697296e-03  1.75901548e-02]]
grads:  [-2.25144316e-03  1.05167500e+01]
Stock Position:  -0.002251443161065511
Bond Position:  [9.50433667]


portfolio before change:  [9.26987122]
curr_Stock_Price:  104.66778460184574
curr_Factors:  [1.04667785e+02 3.90718954e-02]
mat_Sqrt:  [[ 2.06892750e+01  0.00000000e+00]
 [-7.90664484e-03  1.81163992e-02]]
grads:  [-0.0027415   0.80455525]
Stock Position:  -0.0027414955645590233
Bond Position:  [9.55681749]


portfolio before change:  [9.27132912]
curr_Stock_Price:  104.57177261115632
curr_Factors:  [1.04571773e+02 3.84511630e-02]
mat_Sqrt:  [[ 2.05054455e+01  0.00000000e+00]
 [-7.84358724e-03  1.79719161e-02]]
grads:  [1.13200795e-03 1.15164272e+01]
Stock Position:  0.001132007946871091
Bond Position:  [9.15295304]


portfolio before change:  [9.27259499]
curr_Stock_Price:  104.67926722706707
curr_Factors:  [1.04679267e+02 3.86763691e-02]
mat_Sqrt:  [[ 2.05865476e+01  0.00000000e+00]
 [-7.86652341e-03  1.80244695e-02]]
grads:  [-0.03708676 -0.52608517]
Stock Position:  -0.03708675503028772
Bond Position:  [13.15480933]


portfolio before change:  [9.27846254]
curr_Stock_Price:  104.56539638959741
curr_Factors:  [1.04565396e+02 3.80665907e-02]
mat_Sqrt:  [[ 2.04014004e+01  0.00000000e+00]
 [-7.80426455e-03  1.78818165e-02]]
grads:  [-0.00775556 -1.28693508]
Stock Position:  -0.007755564090036244
Bond Position:  [10.08942618]


portfolio before change:  [9.27931361]
curr_Stock_Price:  104.61828620873278
curr_Factors:  [1.04618286e+02 3.74768049e-02]
mat_Sqrt:  [[ 2.02529775e+01  0.00000000e+00]
 [-7.74357074e-03  1.77427495e-02]]
grads:  [ 0.00358182 -0.67335613]
Stock Position:  0.003581823796341752
Bond Position:  [8.90458934]


portfolio before change:  [9.28369455]
curr_Stock_Price:  105.53061265560154
curr_Factors:  [1.05530613e+02 3.69472301e-02]
mat_Sqrt:  [[ 2.02847380e+01  0.00000000e+00]
 [-7.68866492e-03  1.76169445e-02]]
grads:  [-0.01204582 -1.384006  ]
Stock Position:  -0.012045821644208105
Bond Position:  [10.55489749]


portfolio before change:  [9.25525496]
curr_Stock_Price:  108.00109847161428
curr_Factors:  [1.08001098e+02 3.49153610e-02]
mat_Sqrt:  [[ 2.01807100e+01  0.00000000e+00]
 [-7.47426101e-03  1.71256834e-02]]
grads:  [0.00502813 3.11514931]
Stock Position:  0.005028126947082273
Bond Position:  [8.71221173]


portfolio before change:  [9.25516731]
curr_Stock_Price:  107.76706678789587
curr_Factors:  [1.07767067e+02 3.47968638e-02]
mat_Sqrt:  [[ 2.01027797e+01  0.00000000e+00]
 [-7.46156700e-03  1.70965978e-02]]
grads:  [-4.70918013e-03  4.75680292e+00]
Stock Position:  -0.004709180127970342
Bond Position:  [9.76266184]


portfolio before change:  [9.25481756]
curr_Stock_Price:  108.10049346796187
curr_Factors:  [1.08100493e+02 3.48627764e-02]
mat_Sqrt:  [[ 2.01840662e+01  0.00000000e+00]
 [-7.46863054e-03  1.71127824e-02]]
grads:  [-0.0228528  -5.49515613]
Stock Position:  -0.02285279974009596
Bond Position:  [11.72521649]


portfolio before change:  [9.30792538]
curr_Stock_Price:  105.84072330304787
curr_Factors:  [1.05840723e+02 3.50442893e-02]
mat_Sqrt:  [[ 1.98135104e+01  0.00000000e+00]
 [-7.48804800e-03  1.71572734e-02]]
grads:  [-4.97580088e-03 -9.22929197e+00]
Stock Position:  -0.004975800878826445
Bond Position:  [9.83456774]


portfolio before change:  [9.31035864]
curr_Stock_Price:  105.59877959494139
curr_Factors:  [1.05598780e+02 3.48292815e-02]
mat_Sqrt:  [[ 1.97074828e+01  0.00000000e+00]
 [-7.46504189e-03  1.71045598e-02]]
grads:  [-1.88850508e-03 -3.77848470e+00]
Stock Position:  -0.0018885050764568233
Bond Position:  [9.50978247]


portfolio before change:  [9.30642425]
curr_Stock_Price:  108.31160246220183
curr_Factors:  [1.08311602e+02 3.40006355e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.30642425]
Stock Price:  109.83060729435086
PL:  [-0.52418304]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.50209777e+00  3.68495426e-01]
 [ 1.19973629e+00  5.89038750e-02]
 [ 1.11810371e-01 -3.73732759e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.08356703e-01  8.02950047e-01]
 [ 4.01852625e-03 -7.52391424e-02]
 [ 8.74492007e-02  9.60864968e-02]
 [ 5.03322184e-01  5.67620615e-01]
 [-8.16196845e-02  5.99859339e-02]
 [ 1.16953459e-01 -3.98767800e-02]
 [-6.15557338e-02 -1.43201478e-02]
 [-8.21226336e-02 -1.53215427e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-2.15749299e-02 -8.22764728e-02]
 [ 4.53158709e-01  2.88312349e-01]
 [ 1.30163567e-01 -1.05635427e-01]
 [ 3.97319818e-02  1.17365581e-01]
 [-3.96266599e-03  2.31980685e-02]
 [-5.91275002e-02 -4.19424452e-02]
 [-6.33289283e-02 -4.69810518e-02]
 [ 1.80782713e-01 -4.61760147e-02]
 [ 7.68876749e-01 -5.19176873e-02]
 [ 3.03466136e-02 -4.01214237e-01]
 [ 5.73206101e-02  1.07385620e-02]
 [ 3.70626729e-01 -2.76400334e-01]
 [ 2.03804524e-02 -6.14553853e-02]
 [-4.74070109e-02 -7.72742374e-02]
 [ 3.83247364e-02  2.73201057e-01]
 [-3.35672310e-02  1.90536304e-01]
 [-6.38825426e-01 -6.54192197e-02]
 [-1.57266430e-01 -3.62208703e-02]
 [ 5.85459562e-02 -2.64822516e-02]
 [-2.64534089e-01  6.60933115e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.48640016e-01  6.55990273e-02]
 [-2.43918200e-02 -2.04725008e-01]
 [ 1.90495176e-02 -1.93346165e-02]
 [-4.62582146e-02 -7.62289237e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.11989687]
curr_Stock_Price:  99.15789231358035
curr_Factors:  [9.91578923e+01 4.18326060e-02]
mat_Sqrt:  [[ 2.02807843e+01  0.00000000e+00]
 [-8.18120832e-03  1.87455032e-02]]
grads:  [ 0.08199497 19.65780389]
Stock Position:  0.0819949728911984
Bond Position:  [-11.25034556]


portfolio before change:  [-3.21703457]
curr_Stock_Price:  97.99036561278832
curr_Factors:  [9.79903656e+01 4.10863369e-02]
mat_Sqrt:  [[ 1.98624167e+01  0.00000000e+00]
 [-8.10790595e-03  1.85775464e-02]]
grads:  [0.06169662 3.17070262]
Stock Position:  0.06169662359622665
Bond Position:  [-9.26270928]


portfolio before change:  [-3.10514273]
curr_Stock_Price:  99.82271477792332
curr_Factors:  [9.98227148e+01 4.00651458e-02]
mat_Sqrt:  [[ 1.99807939e+01  0.00000000e+00]
 [-8.00651193e-03  1.83452235e-02]]
grads:  [ 0.00477956 -2.03722107]
Stock Position:  0.004779556657218163
Bond Position:  [-3.58225105]


portfolio before change:  [-3.10926608]
curr_Stock_Price:  99.05370062677966
curr_Factors:  [9.90537006e+01 4.02012655e-02]
mat_Sqrt:  [[ 1.98605178e+01  0.00000000e+00]
 [-8.02010130e-03  1.83763606e-02]]
grads:  [-8.20792645e-04 -8.23812807e+00]
Stock Position:  -0.0008207926447730375
Bond Position:  [-3.02796353]


portfolio before change:  [-3.1084384]
curr_Stock_Price:  97.5841475423492
curr_Factors:  [9.75841475e+01 4.21303135e-02]
mat_Sqrt:  [[ 2.00298002e+01  0.00000000e+00]
 [-8.21026806e-03  1.88120874e-02]]
grads:  [1.20859631e-02 4.26826661e+01]
Stock Position:  0.012085963130788484
Bond Position:  [-4.28783681]


portfolio before change:  [-3.10880321]
curr_Stock_Price:  97.59831315240935
curr_Factors:  [9.75983132e+01 4.14559201e-02]
mat_Sqrt:  [[ 1.98717260e+01  0.00000000e+00]
 [-8.14429077e-03  1.86609145e-02]]
grads:  [-1.45022770e-03 -4.03191079e+00]
Stock Position:  -0.0014502277030502633
Bond Position:  [-2.96726343]


portfolio before change:  [-3.11117475]
curr_Stock_Price:  98.97782705410779
curr_Factors:  [9.89778271e+01 4.08620129e-02]
mat_Sqrt:  [[ 2.00077289e+01  0.00000000e+00]
 [-8.08574181e-03  1.85267619e-02]]
grads:  [0.00646674 5.18636214]
Stock Position:  0.0064667402694904355
Bond Position:  [-3.75123865]


portfolio before change:  [-3.10786581]
curr_Stock_Price:  99.56202742772103
curr_Factors:  [9.95620274e+01 3.99875709e-02]
mat_Sqrt:  [[ 1.99093116e+01  0.00000000e+00]
 [-7.99875699e-03  1.83274547e-02]]
grads:  [ 0.03772366 30.97105544]
Stock Position:  0.037723661492828284
Bond Position:  [-6.86371003]


portfolio before change:  [-3.08973186]
curr_Stock_Price:  100.06547731844012
curr_Factors:  [1.00065477e+02 3.97690585e-02]
mat_Sqrt:  [[ 1.99552387e+01  0.00000000e+00]
 [-7.97687242e-03  1.82773108e-02]]
grads:  [-2.77820163e-03  3.28198904e+00]
Stock Position:  -0.002778201632646306
Bond Position:  [-2.81172979]


portfolio before change:  [-3.09245404]
curr_Stock_Price:  100.91879751531529
curr_Factors:  [1.00918798e+02 4.07688469e-02]
mat_Sqrt:  [[ 2.03768140e+01  0.00000000e+00]
 [-8.07651875e-03  1.85056293e-02]]
grads:  [ 0.00488545 -2.15484594]
Stock Position:  0.004885445054752662
Bond Position:  [-3.58548728]


portfolio before change:  [-3.08501565]
curr_Stock_Price:  102.53310350728137
curr_Factors:  [1.02533104e+02 4.04110296e-02]
mat_Sqrt:  [[ 2.06117118e+01  0.00000000e+00]
 [-8.04099791e-03  1.84242408e-02]]
grads:  [-0.00328966 -0.77724493]
Stock Position:  -0.0032896616917951304
Bond Position:  [-2.74771643]


portfolio before change:  [-3.08710901]
curr_Stock_Price:  103.06503546677352
curr_Factors:  [1.03065035e+02 3.89064744e-02]
mat_Sqrt:  [[ 2.03292940e+01  0.00000000e+00]
 [-7.88988967e-03  1.80780083e-02]]
grads:  [-7.32889831e-03 -8.47523823e+00]
Stock Position:  -0.00732889830926924
Bond Position:  [-2.33175585]


portfolio before change:  [-3.08219092]
curr_Stock_Price:  102.35420828232083
curr_Factors:  [1.02354208e+02 3.83265391e-02]
mat_Sqrt:  [[ 2.00380523e+01  0.00000000e+00]
 [-7.83086602e-03  1.79427681e-02]]
grads:  [-0.00326926 -0.99705925]
Stock Position:  -0.003269255919950568
Bond Position:  [-2.74756882]


portfolio before change:  [-3.08178936]
curr_Stock_Price:  102.12631980092448
curr_Factors:  [1.02126320e+02 3.87710694e-02]
mat_Sqrt:  [[ 2.01090508e+01  0.00000000e+00]
 [-7.87614823e-03  1.80465227e-02]]
grads:  [-2.85857980e-03 -4.55913164e+00]
Stock Position:  -0.0028585798028660037
Bond Position:  [-2.78985313]


portfolio before change:  [-3.07564263]
curr_Stock_Price:  99.85404190813394
curr_Factors:  [9.98540419e+01 3.98192031e-02]
mat_Sqrt:  [[ 1.99256240e+01  0.00000000e+00]
 [-7.98189984e-03  1.82888301e-02]]
grads:  [ 0.02905749 15.76439542]
Stock Position:  0.029057485677740354
Bond Position:  [-5.97715002]


portfolio before change:  [-3.09827335]
curr_Stock_Price:  99.10093016810107
curr_Factors:  [9.91009302e+01 3.91881630e-02]
mat_Sqrt:  [[ 1.96180205e+01  0.00000000e+00]
 [-7.91840015e-03  1.81433340e-02]]
grads:  [ 4.28486083e-03 -5.82227205e+00]
Stock Position:  0.004284860826755245
Bond Position:  [-3.52290705]


portfolio before change:  [-3.10206552]
curr_Stock_Price:  98.31869448394252
curr_Factors:  [9.83186945e+01 3.95005215e-02]
mat_Sqrt:  [[ 1.95405830e+01  0.00000000e+00]
 [-7.94989524e-03  1.82154984e-02]]
grads:  [4.65464724e-03 6.44317158e+00]
Stock Position:  0.004654647241287721
Bond Position:  [-3.55970436]


portfolio before change:  [-3.10060734]
curr_Stock_Price:  98.72756923363748
curr_Factors:  [9.87275692e+01 4.01369953e-02]
mat_Sqrt:  [[ 1.97792980e+01  0.00000000e+00]
 [-8.01368782e-03  1.83616655e-02]]
grads:  [3.11527798e-04 1.26339675e+00]
Stock Position:  0.0003115277979608667
Bond Position:  [-3.13136372]


portfolio before change:  [-3.10113566]
curr_Stock_Price:  98.28819107547508
curr_Factors:  [9.82881911e+01 3.90101908e-02]
mat_Sqrt:  [[ 1.94128983e+01  0.00000000e+00]
 [-7.90039906e-03  1.81020884e-02]]
grads:  [-0.00398872 -2.31699484]
Stock Position:  -0.00398872351675622
Bond Position:  [-2.70909124]


portfolio before change:  [-3.10872229]
curr_Stock_Price:  100.10530744719281
curr_Factors:  [1.00105307e+02 3.77296196e-02]
mat_Sqrt:  [[ 1.94445688e+01  0.00000000e+00]
 [-7.76964551e-03  1.78024943e-02]]
grads:  [-0.00431139 -2.63901512]
Stock Position:  -0.004311391069312448
Bond Position:  [-2.67712917]


portfolio before change:  [-3.1081758]
curr_Stock_Price:  99.90092974009174
curr_Factors:  [9.99009297e+01 3.70259245e-02]
mat_Sqrt:  [[ 1.92230584e+01  0.00000000e+00]
 [-7.69684866e-03  1.76356958e-02]]
grads:  [ 0.0083561  -2.61832679]
Stock Position:  0.008356102568400406
Bond Position:  [-3.94295822]


portfolio before change:  [-3.10511124]
curr_Stock_Price:  100.32666189026577
curr_Factors:  [1.00326662e+02 3.64829461e-02]
mat_Sqrt:  [[ 1.91629035e+01  0.00000000e+00]
 [-7.64020378e-03  1.75059061e-02]]
grads:  [ 0.03894076 -2.96572409]
Stock Position:  0.0389407592533311
Bond Position:  [-7.01190763]


portfolio before change:  [-3.05886701]
curr_Stock_Price:  101.53672514284453
curr_Factors:  [1.01536725e+02 3.73299669e-02]
mat_Sqrt:  [[ 1.96178746e+01  0.00000000e+00]
 [-7.72838580e-03  1.77079565e-02]]
grads:  [-7.37886432e-03 -2.26572862e+01]
Stock Position:  -0.007378864315163291
Bond Position:  [-2.30964129]


portfolio before change:  [-3.06381202]
curr_Stock_Price:  102.16775637279102
curr_Factors:  [1.02167756e+02 3.73236782e-02]
mat_Sqrt:  [[ 1.97381331e+01  0.00000000e+00]
 [-7.72773479e-03  1.77064648e-02]]
grads:  [0.0031415 0.6064769]
Stock Position:  0.0031414978469290664
Bond Position:  [-3.38477181]


portfolio before change:  [-3.06290125]
curr_Stock_Price:  102.59236194477175
curr_Factors:  [1.02592362e+02 3.63774842e-02]
mat_Sqrt:  [[ 1.95673205e+01  0.00000000e+00]
 [-7.62915295e-03  1.74805854e-02]]
grads:  [ 1.27761863e-02 -1.58118465e+01]
Stock Position:  0.012776186340716289
Bond Position:  [-4.37364038]


portfolio before change:  [-3.06873363]
curr_Stock_Price:  102.17865154206534
curr_Factors:  [1.02178652e+02 3.75739021e-02]
mat_Sqrt:  [[ 1.98062983e+01  0.00000000e+00]
 [-7.75359551e-03  1.77657192e-02]]
grads:  [-3.25193357e-04 -3.45921179e+00]
Stock Position:  -0.00032519335660069677
Bond Position:  [-3.03550581]


portfolio before change:  [-3.06876717]
curr_Stock_Price:  101.1149033882884
curr_Factors:  [1.01114903e+02 3.85930887e-02]
mat_Sqrt:  [[ 1.98641479e+01  0.00000000e+00]
 [-7.85804950e-03  1.80050533e-02]]
grads:  [-4.08435607e-03 -4.29180831e+00]
Stock Position:  -0.004084356069822815
Bond Position:  [-2.6557779]


portfolio before change:  [-3.07077064]
curr_Stock_Price:  101.52414414332628
curr_Factors:  [1.01524144e+02 3.80649665e-02]
mat_Sqrt:  [[ 1.98076094e+01  0.00000000e+00]
 [-7.80409805e-03  1.78814350e-02]]
grads:  [7.95449112e-03 1.52784749e+01]
Stock Position:  0.007954491115207681
Bond Position:  [-3.87834355]


portfolio before change:  [-3.06620647]
curr_Stock_Price:  102.15887980977955
curr_Factors:  [1.02158880e+02 3.82124697e-02]
mat_Sqrt:  [[ 1.99700281e+01  0.00000000e+00]
 [-7.81920402e-03  1.79160471e-02]]
grads:  [2.48320280e-03 1.06349522e+01]
Stock Position:  0.002483202796566336
Bond Position:  [-3.31988768]


portfolio before change:  [-3.06514691]
curr_Stock_Price:  102.7526994456964
curr_Factors:  [1.02752699e+02 3.85864176e-02]
mat_Sqrt:  [[ 2.01841502e+01  0.00000000e+00]
 [-7.85737031e-03  1.80034971e-02]]
grads:  [-0.03306439 -3.63369513]
Stock Position:  -0.03306439490399829
Bond Position:  [0.33230893]


portfolio before change:  [-3.08451255]
curr_Stock_Price:  103.33965067232712
curr_Factors:  [1.03339651e+02 3.82562479e-02]
mat_Sqrt:  [[ 2.02124135e+01  0.00000000e+00]
 [-7.82368178e-03  1.79263070e-02]]
grads:  [-0.00856278 -2.02054279]
Stock Position:  -0.008562783114672554
Bond Position:  [-2.19963754]


portfolio before change:  [-3.08232398]
curr_Stock_Price:  103.05194654841968
curr_Factors:  [1.03051947e+02 3.93229465e-02]
mat_Sqrt:  [[ 2.04352157e+01  0.00000000e+00]
 [-7.93200570e-03  1.81745083e-02]]
grads:  [ 0.00229937 -1.45710966]
Stock Position:  0.002299371575125404
Bond Position:  [-3.31927869]


portfolio before change:  [-3.08191202]
curr_Stock_Price:  103.41156428492275
curr_Factors:  [1.03411564e+02 3.96896542e-02]
mat_Sqrt:  [[ 2.06019233e+01  0.00000000e+00]
 [-7.96890499e-03  1.82590552e-02]]
grads:  [-0.01144013  3.61975529]
Stock Position:  -0.011440126237766671
Bond Position:  [-1.89887067]


portfolio before change:  [-3.08670304]
curr_Stock_Price:  103.80960650133079
curr_Factors:  [1.03809607e+02 3.98756930e-02]
mat_Sqrt:  [[ 2.07296356e+01  0.00000000e+00]
 [-7.98755963e-03  1.83017983e-02]]
grads:  [0.00489498 2.91496278]
Stock Position:  0.004894980978187084
Bond Position:  [-3.59484909]


portfolio before change:  [-3.09216301]
curr_Stock_Price:  102.78599048616776
curr_Factors:  [1.02785990e+02 4.06305773e-02]
mat_Sqrt:  [[ 2.07186008e+01  0.00000000e+00]
 [-8.06281115e-03  1.84742212e-02]]
grads:  [-0.00456921  4.40208793]
Stock Position:  -0.004569208698533159
Bond Position:  [-2.62251237]


portfolio before change:  [-3.08714936]
curr_Stock_Price:  101.6169727257848
curr_Factors:  [1.01616973e+02 4.10172009e-02]
mat_Sqrt:  [[ 2.05801844e+01  0.00000000e+00]
 [-8.10108149e-03  1.85619096e-02]]
grads:  [-0.01069039  3.53406674]
Stock Position:  -0.01069039267497829
Bond Position:  [-2.00082402]


portfolio before change:  [-3.07477406]
curr_Stock_Price:  100.43596670771096
curr_Factors:  [1.00435967e+02 4.37145918e-02]
mat_Sqrt:  [[ 2.09991868e+01  0.00000000e+00]
 [-8.36321390e-03  1.91625304e-02]]
grads:  [-5.41645443e-03 -1.06836103e+01]
Stock Position:  -0.005416454426416217
Bond Position:  [-2.53076722]


portfolio before change:  [-3.07400982]
curr_Stock_Price:  100.23646295209312
curr_Factors:  [1.00236463e+02 4.43239922e-02]
mat_Sqrt:  [[ 2.11030471e+01  0.00000000e+00]
 [-8.42130557e-03  1.92956351e-02]]
grads:  [ 5.02827819e-04 -1.00202022e+00]
Stock Position:  0.0005028278188738261
Bond Position:  [-3.1244115]


portfolio before change:  [-3.07386956]
curr_Stock_Price:  101.29215415677639
curr_Factors:  [1.01292154e+02 4.52782897e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.07386956]
Stock Price:  102.24763728575317
PL:  [-5.32150685]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.43783692e+00  3.53967334e-01]
 [ 2.27040514e-01  1.01381448e-01]
 [ 1.11874877e-01 -3.87929571e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.11164109e-02  4.55831228e-01]
 [-5.49904274e-02 -1.13842991e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 7.62860032e-01  7.48976947e-01]
 [-1.47925529e-02  2.92820365e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-4.56760450e-02  1.54925365e-02]
 [ 6.09625924e-02 -1.27630469e-01]
 [-1.18641505e-01 -2.61884921e-02]
 [-1.28026827e-01  2.65538578e-01]
 [ 3.41979665e-01  2.47261512e-01]
 [ 1.32054664e-01 -9.29576251e-02]
 [ 3.82283371e-02 -7.91976697e-03]
 [ 3.82933685e-01  6.27142763e-02]
 [ 2.93229458e-01  3.03971281e-01]
 [-6.59966342e-01  3.08240435e-01]
 [ 2.76216590e-02  1.51547225e-01]
 [ 1.68732521e+00  2.08783733e-01]
 [ 1.55939577e-02  4.54094368e-01]
 [-1.49436172e-01  1.76096055e-01]
 [-1.97245446e-01  1.24221894e-01]
 [ 1.91245376e-01 -8.13172384e-02]
 [-1.88438528e-01 -4.46351241e-01]
 [ 5.74122812e-02  8.00261008e-02]
 [ 2.86191769e-01 -5.63599222e-02]
 [-5.31884429e-01 -1.79160322e-01]
 [ 8.76915893e-03  6.36213833e-03]
 [-4.52809239e-02  3.12686063e-02]
 [ 1.09349563e-01  1.92998958e-01]
 [ 4.52523469e-03  1.16625901e-02]
 [ 1.32391677e-01 -7.30243339e-02]
 [-5.37964330e-02  1.18881311e-01]
 [-4.06734483e-02 -6.43665146e-02]
 [-8.35052729e-02 -5.46957372e-02]
 [ 1.58731005e-01 -1.35839950e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.6596927]
curr_Stock_Price:  99.51500316455581
curr_Factors:  [9.95150032e+01 3.90759802e-02]
mat_Sqrt:  [[ 1.96717729e+01  0.00000000e+00]
 [-7.90705813e-03  1.81173462e-02]]
grads:  [ 0.08094445 19.53748248]
Stock Position:  0.08094445471506062
Bond Position:  [-8.71488037]


portfolio before change:  [-0.57389196]
curr_Stock_Price:  100.58845736340584
curr_Factors:  [1.00588457e+02 3.76502902e-02]
mat_Sqrt:  [[ 1.95178651e+01  0.00000000e+00]
 [-7.76147308e-03  1.77837689e-02]]
grads:  [0.01389942 5.70078528]
Stock Position:  0.01389942005147257
Bond Position:  [-1.97201318]


portfolio before change:  [-0.58506925]
curr_Stock_Price:  99.8020380430479
curr_Factors:  [9.9802038e+01 3.8883024e-02]
mat_Sqrt:  [[ 1.96797432e+01  0.00000000e+00]
 [-7.88751155e-03  1.80725594e-02]]
grads:  [ 0.00482447 -2.14651153]
Stock Position:  0.004824465497319219
Bond Position:  [-1.06656074]


portfolio before change:  [-0.57872808]
curr_Stock_Price:  101.14405233920317
curr_Factors:  [1.01144052e+02 3.86010544e-02]
mat_Sqrt:  [[ 1.98719247e+01  0.00000000e+00]
 [-7.85886042e-03  1.80069114e-02]]
grads:  [-8.20321492e-04 -8.40715042e+00]
Stock Position:  -0.0008203214923328434
Bond Position:  [-0.49575744]


portfolio before change:  [-0.57645405]
curr_Stock_Price:  98.29639197476945
curr_Factors:  [9.82963920e+01 3.98948405e-02]
mat_Sqrt:  [[ 1.96334194e+01  0.00000000e+00]
 [-7.98947713e-03  1.83061918e-02]]
grads:  [5.49189343e-03 2.49003852e+01]
Stock Position:  0.005491893427165667
Bond Position:  [-1.11628736]


portfolio before change:  [-0.57486294]
curr_Stock_Price:  98.61152234735707
curr_Factors:  [9.86115223e+01 3.95313964e-02]
mat_Sqrt:  [[ 1.96064398e+01  0.00000000e+00]
 [-7.95300159e-03  1.82226159e-02]]
grads:  [-5.33883678e-03 -6.24734627e+00]
Stock Position:  -0.005338836780952313
Bond Position:  [-0.04839211]


portfolio before change:  [-0.57333946]
curr_Stock_Price:  98.32503271214905
curr_Factors:  [9.83250327e+01 4.05602692e-02]
mat_Sqrt:  [[ 1.98022488e+01  0.00000000e+00]
 [-8.05583209e-03  1.84582302e-02]]
grads:  [0.00653329 5.20834805]
Stock Position:  0.006533287114153839
Bond Position:  [-1.21572513]


portfolio before change:  [-0.5727635]
curr_Stock_Price:  98.43645353326549
curr_Factors:  [9.84364535e+01 4.08855237e-02]
mat_Sqrt:  [[ 1.99040173e+01  0.00000000e+00]
 [-8.08806763e-03  1.85320911e-02]]
grads:  [ 0.05474977 40.41513421]
Stock Position:  0.054749770014242215
Bond Position:  [-5.96213669]


portfolio before change:  [-0.57831246]
curr_Stock_Price:  98.3487152669024
curr_Factors:  [9.83487153e+01 4.08770069e-02]
mat_Sqrt:  [[ 1.98842052e+01  0.00000000e+00]
 [-8.08722518e-03  1.85301608e-02]]
grads:  [5.6831405e-03 1.5802365e+01]
Stock Position:  0.005683140496140298
Bond Position:  [-1.13724203]


portfolio before change:  [-0.58170292]
curr_Stock_Price:  97.77714883414092
curr_Factors:  [9.77771488e+01 4.25484818e-02]
mat_Sqrt:  [[ 2.01687695e+01  0.00000000e+00]
 [-8.25091334e-03  1.89052175e-02]]
grads:  [0.0122186  5.98123421]
Stock Position:  0.01221860294252818
Bond Position:  [-1.77640307]


portfolio before change:  [-0.58833722]
curr_Stock_Price:  97.2523552683633
curr_Factors:  [9.72523553e+01 4.35846305e-02]
mat_Sqrt:  [[ 2.03033084e+01  0.00000000e+00]
 [-8.35077295e-03  1.91340246e-02]]
grads:  [-0.00191666  0.8096852 ]
Stock Position:  -0.0019166604222166513
Bond Position:  [-0.40193748]


portfolio before change:  [-0.58869714]
curr_Stock_Price:  97.41392048622222
curr_Factors:  [9.74139205e+01 4.49062673e-02]
mat_Sqrt:  [[ 2.06430802e+01  0.00000000e+00]
 [-8.47643956e-03  1.94219630e-02]]
grads:  [ 2.54811249e-04 -6.57145054e+00]
Stock Position:  0.0002548112492096876
Bond Position:  [-0.6135193]


portfolio before change:  [-0.58891473]
curr_Stock_Price:  96.86098152903656
curr_Factors:  [9.68609815e+01 4.29675148e-02]
mat_Sqrt:  [[ 2.00779322e+01  0.00000000e+00]
 [-8.29144280e-03  1.89980821e-02]]
grads:  [-0.00647831 -1.37848084]
Stock Position:  -0.006478311525696374
Bond Position:  [0.03858089]


portfolio before change:  [-0.58506727]
curr_Stock_Price:  96.2678274503497
curr_Factors:  [9.62678275e+01 4.21633702e-02]
mat_Sqrt:  [[ 1.97673672e+01  0.00000000e+00]
 [-8.21348843e-03  1.88194662e-02]]
grads:  [-6.13955862e-04  1.41097826e+01]
Stock Position:  -0.0006139558624754965
Bond Position:  [-0.52596307]


portfolio before change:  [-0.58494955]
curr_Stock_Price:  95.96899631625426
curr_Factors:  [9.59689963e+01 4.10778043e-02]
mat_Sqrt:  [[ 1.94506699e+01  0.00000000e+00]
 [-8.10706401e-03  1.85756173e-02]]
grads:  [ 0.02312997 13.31107918]
Stock Position:  0.02312997123918588
Bond Position:  [-2.80470967]


portfolio before change:  [-0.61831343]
curr_Stock_Price:  94.5417023130317
curr_Factors:  [9.45417023e+01 4.23498381e-02]
mat_Sqrt:  [[ 1.94558090e+01  0.00000000e+00]
 [-8.23163051e-03  1.88610350e-02]]
grads:  [ 4.70217558e-03 -4.92855378e+00]
Stock Position:  0.004702175583881661
Bond Position:  [-1.06286511]


portfolio before change:  [-0.62188209]
curr_Stock_Price:  93.81102023273901
curr_Factors:  [9.38110202e+01 4.11418387e-02]
mat_Sqrt:  [[ 1.90281124e+01  0.00000000e+00]
 [-8.11338043e-03  1.85900900e-02]]
grads:  [ 0.00182739 -0.42602091]
Stock Position:  0.0018273944761575097
Bond Position:  [-0.79331183]


portfolio before change:  [-0.62479042]
curr_Stock_Price:  92.27376948644182
curr_Factors:  [9.22737695e+01 4.23521930e-02]
mat_Sqrt:  [[ 1.89896174e+01  0.00000000e+00]
 [-8.23185938e-03  1.88615593e-02]]
grads:  [0.02160678 3.32497834]
Stock Position:  0.02160677761488389
Bond Position:  [-2.61852924]


portfolio before change:  [-0.59941024]
curr_Stock_Price:  93.4635588996812
curr_Factors:  [9.34635589e+01 4.30704072e-02]
mat_Sqrt:  [[ 1.93968766e+01  0.00000000e+00]
 [-8.30136444e-03  1.90208155e-02]]
grads:  [ 0.0219568  15.98098052]
Stock Position:  0.021956803130300365
Bond Position:  [-2.6515712]


portfolio before change:  [-0.59545787]
curr_Stock_Price:  93.65866211762784
curr_Factors:  [9.36586621e+01 4.21507577e-02]
mat_Sqrt:  [[ 1.92287318e+01  0.00000000e+00]
 [-8.21225988e-03  1.88166513e-02]]
grads:  [-0.02732573 16.38125886]
Stock Position:  -0.02732573275255982
Bond Position:  [1.9638337]


portfolio before change:  [-0.60338272]
curr_Stock_Price:  93.95766039966986
curr_Factors:  [9.39576604e+01 4.13389706e-02]
mat_Sqrt:  [[ 1.91034595e+01  0.00000000e+00]
 [-8.13279490e-03  1.86345741e-02]]
grads:  [4.90813143e-03 8.13258320e+00]
Stock Position:  0.004908131433667819
Bond Position:  [-1.06453927]


portfolio before change:  [-0.60410579]
curr_Stock_Price:  93.8374534907349
curr_Factors:  [9.38374535e+01 4.16911785e-02]
mat_Sqrt:  [[ 1.91601233e+01  0.00000000e+00]
 [-8.16736712e-03  1.87137890e-02]]
grads:  [ 0.09282017 11.15667877]
Stock Position:  0.09282016967676465
Bond Position:  [-9.31411414]


portfolio before change:  [-0.5473701]
curr_Stock_Price:  94.46124058764016
curr_Factors:  [9.44612406e+01 4.32102107e-02]
mat_Sqrt:  [[ 1.96357203e+01  0.00000000e+00]
 [-8.31482634e-03  1.90516605e-02]]
grads:  [1.08871477e-02 2.38348971e+01]
Stock Position:  0.010887147741661406
Bond Position:  [-1.57578358]


portfolio before change:  [-0.55327061]
curr_Stock_Price:  93.93736367884055
curr_Factors:  [9.39373637e+01 4.31469197e-02]
mat_Sqrt:  [[ 1.95125157e+01  0.00000000e+00]
 [-8.30873465e-03  1.90377027e-02]]
grads:  [-3.71974345e-03  9.24985844e+00]
Stock Position:  -0.003719743453413284
Bond Position:  [-0.20384772]


portfolio before change:  [-0.55643835]
curr_Stock_Price:  94.78211507426126
curr_Factors:  [9.47821151e+01 4.29510202e-02]
mat_Sqrt:  [[ 1.96432407e+01  0.00000000e+00]
 [-8.28985116e-03  1.89944352e-02]]
grads:  [-0.00728141  6.53990986]
Stock Position:  -0.007281413933839885
Bond Position:  [0.13370946]


portfolio before change:  [-0.56233393]
curr_Stock_Price:  95.5940853468848
curr_Factors:  [9.55940853e+01 4.30912273e-02]
mat_Sqrt:  [[ 1.98438280e+01  0.00000000e+00]
 [-8.30337063e-03  1.90254122e-02]]
grads:  [ 0.00784907 -4.27413806]
Stock Position:  0.007849071423847633
Bond Position:  [-1.31265873]


portfolio before change:  [-0.55089612]
curr_Stock_Price:  97.07220908205994
curr_Factors:  [9.70722091e+01 4.35622532e-02]
mat_Sqrt:  [[ 2.02604963e+01  0.00000000e+00]
 [-8.34862894e-03  1.91291120e-02]]
grads:  [-1.8915735e-02 -2.3333610e+01]
Stock Position:  -0.018915735012348462
Bond Position:  [1.28529606]


portfolio before change:  [-0.56172109]
curr_Stock_Price:  97.65297638115831
curr_Factors:  [9.76529764e+01 4.22547085e-02]
mat_Sqrt:  [[ 2.00734971e+01  0.00000000e+00]
 [-8.22238004e-03  1.88398395e-02]]
grads:  [0.00460002 4.24770609]
Stock Position:  0.004600022330920472
Bond Position:  [-1.01092696]


portfolio before change:  [-0.56393482]
curr_Stock_Price:  97.19920479460443
curr_Factors:  [9.71992048e+01 4.20042020e-02]
mat_Sqrt:  [[ 1.99209058e+01  0.00000000e+00]
 [-8.19797068e-03  1.87839106e-02]]
grads:  [ 0.01313165 -3.00043603]
Stock Position:  0.013131645996636906
Bond Position:  [-1.84032037]


portfolio before change:  [-0.56560455]
curr_Stock_Price:  97.0895708702025
curr_Factors:  [9.70895709e+01 4.25257991e-02]
mat_Sqrt:  [[ 2.00216020e+01  0.00000000e+00]
 [-8.24871375e-03  1.89001776e-02]]
grads:  [-0.03047091 -9.47929303]
Stock Position:  -0.030470908612804232
Bond Position:  [2.39280289]


portfolio before change:  [-0.53038377]
curr_Stock_Price:  95.94350515017541
curr_Factors:  [9.59435052e+01 4.34643945e-02]
mat_Sqrt:  [[ 2.00024133e+01  0.00000000e+00]
 [-8.33924644e-03  1.91076140e-02]]
grads:  [0.00057722 0.33296352]
Stock Position:  0.0005772215349298042
Bond Position:  [-0.58576443]


portfolio before change:  [-0.53012865]
curr_Stock_Price:  96.51234666389692
curr_Factors:  [9.65123467e+01 4.40926030e-02]
mat_Sqrt:  [[ 2.02658930e+01  0.00000000e+00]
 [-8.39929549e-03  1.92452037e-02]]
grads:  [-1.56095690e-03  1.62474801e+00]
Stock Position:  -0.0015609568951101382
Bond Position:  [-0.37947703]


portfolio before change:  [-0.53102989]
curr_Stock_Price:  97.05932374704363
curr_Factors:  [9.70593237e+01 4.50587277e-02]
mat_Sqrt:  [[ 2.06028226e+01  0.00000000e+00]
 [-8.49081647e-03  1.94549046e-02]]
grads:  [9.39585887e-03 9.92032407e+00]
Stock Position:  0.009395858872287693
Bond Position:  [-1.4429856]


portfolio before change:  [-0.52238474]
curr_Stock_Price:  97.99862417377231
curr_Factors:  [9.79986242e+01 4.48441024e-02]
mat_Sqrt:  [[ 2.07526063e+01  0.00000000e+00]
 [-8.47057045e-03  1.94085151e-02]]
grads:  [4.63325241e-04 6.00900687e-01]
Stock Position:  0.00046332524094625
Bond Position:  [-0.56778998]


portfolio before change:  [-0.5230223]
curr_Stock_Price:  96.77575877542125
curr_Factors:  [9.67757588e+01 4.38860626e-02]
mat_Sqrt:  [[ 2.02735543e+01  0.00000000e+00]
 [-8.37960024e-03  1.92000762e-02]]
grads:  [ 0.00495824 -3.80333563]
Stock Position:  0.0049582448042822455
Bond Position:  [-1.00286021]


portfolio before change:  [-0.51980193]
curr_Stock_Price:  97.45054220278082
curr_Factors:  [9.74505422e+01 4.37332220e-02]
mat_Sqrt:  [[ 2.03793345e+01  0.00000000e+00]
 [-8.36499582e-03  1.91666133e-02]]
grads:  [-9.38389514e-05  6.20252045e+00]
Stock Position:  -9.3838951432455e-05
Bond Position:  [-0.51065727]


portfolio before change:  [-0.51985351]
curr_Stock_Price:  97.31999868401822
curr_Factors:  [9.73199987e+01 4.33138921e-02]
mat_Sqrt:  [[ 2.02542282e+01  0.00000000e+00]
 [-8.32479594e-03  1.90745038e-02]]
grads:  [-0.00339511 -3.37447912]
Stock Position:  -0.0033951082957184727
Bond Position:  [-0.18944158]


portfolio before change:  [-0.52371112]
curr_Stock_Price:  98.44924734696683
curr_Factors:  [9.84492473e+01 4.25622163e-02]
mat_Sqrt:  [[ 2.03106825e+01  0.00000000e+00]
 [-8.25224491e-03  1.89082685e-02]]
grads:  [-0.0052867  -2.89268884]
Stock Position:  -0.00528669824672146
Bond Position:  [-0.00323965]


portfolio before change:  [-0.52092331]
curr_Stock_Price:  97.9218468206517
curr_Factors:  [9.79218468e+01 4.28558811e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.52092331]
Stock Price:  98.08753960674177
PL:  [-0.52092331]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.38800565e+00  3.42701482e-01]
 [ 5.92222874e-01  1.17739649e-01]
 [ 1.80605612e-02  5.27392903e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.53183469e-01  1.12928406e+00]
 [ 3.82454063e-02 -1.49029555e-03]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.35657181e+00  1.40537493e+00]
 [ 6.65970497e-02  5.10344582e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-1.15756446e-01  4.33650432e-04]
 [ 3.13834014e-02 -1.36254923e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-1.27898367e-01  2.62265244e-01]
 [ 3.23618466e-01  2.39134602e-01]
 [ 1.32521263e-01 -3.71414830e-02]
 [ 4.07123565e-02  1.24227683e-01]
 [ 1.51736648e-01  7.95720374e-02]
 [-3.89376367e-02 -2.21448136e-02]
 [-3.14290998e-01  1.12336378e-01]
 [ 1.51031562e-01 -2.80254491e-03]
 [ 1.08989673e+00  9.71057456e-02]
 [ 1.80008516e-02  2.56536872e-01]
 [-1.28474112e-01  9.36260409e-02]
 [-2.04129528e-01  1.95733253e-01]
 [ 1.15988867e-01 -1.08307199e-01]
 [-1.24593128e-01 -4.50258704e-01]
 [ 7.27082855e-02  4.74649306e-02]
 [ 2.76454750e-01 -4.41907086e-02]
 [-5.32720963e-01 -1.73900241e-01]
 [-9.07926613e-02 -3.03994475e-02]
 [-5.61985174e-02  4.99123672e-02]
 [ 2.11114172e-01  2.04856456e-01]
 [ 3.11494071e-02 -1.70154188e-02]
 [ 2.25123282e-01 -1.66685914e-01]
 [ 4.11701480e-02  1.12709883e-01]
 [-4.57750707e-02  7.58573246e-04]
 [-1.53924410e-01 -7.33146194e-02]
 [ 1.44737417e-01 -1.33383076e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.85922283]
curr_Stock_Price:  99.73548129536394
curr_Factors:  [9.97354813e+01 4.01306791e-02]
mat_Sqrt:  [[ 1.99796531e+01  0.00000000e+00]
 [-8.01305726e-03  1.83602207e-02]]
grads:  [ 0.07695693 18.66543367]
Stock Position:  0.0769569336587289
Bond Position:  [-6.81611399]


portfolio before change:  [0.84660942]
curr_Stock_Price:  99.58265110352946
curr_Factors:  [9.95826511e+01 3.91150586e-02]
mat_Sqrt:  [[ 1.96949860e+01  0.00000000e+00]
 [-7.91101092e-03  1.81264032e-02]]
grads:  [0.03267881 6.49547777]
Stock Position:  0.032678808148765816
Bond Position:  [-2.40763293]


portfolio before change:  [0.79233804]
curr_Stock_Price:  97.93110947849749
curr_Factors:  [9.79311095e+01 4.04183779e-02]
mat_Sqrt:  [[ 1.96883860e+01  0.00000000e+00]
 [-8.04172896e-03  1.84259158e-02]]
grads:  [2.08640132e-03 2.86223441e+00]
Stock Position:  0.0020864013205685447
Bond Position:  [0.58801444]


portfolio before change:  [0.79113297]
curr_Stock_Price:  97.31829864292658
curr_Factors:  [9.73182986e+01 4.13995694e-02]
mat_Sqrt:  [[ 1.98012415e+01  0.00000000e+00]
 [-8.13875365e-03  1.86482273e-02]]
grads:  [-8.23249744e-04 -8.11802697e+00]
Stock Position:  -0.0008232497438386813
Bond Position:  [0.87125024]


portfolio before change:  [0.79217425]
curr_Stock_Price:  96.18575855678044
curr_Factors:  [9.61857586e+01 4.23415493e-02]
mat_Sqrt:  [[ 1.97922035e+01  0.00000000e+00]
 [-8.23082492e-03  1.88591891e-02]]
grads:  [1.71621368e-02 5.98797783e+01]
Stock Position:  0.017162136759575074
Bond Position:  [-0.85857889]


portfolio before change:  [0.79310664]
curr_Stock_Price:  96.24634075704842
curr_Factors:  [9.62463408e+01 4.30918047e-02]
mat_Sqrt:  [[ 1.99793598e+01  0.00000000e+00]
 [-8.30342625e-03  1.90255397e-02]]
grads:  [ 0.00188169 -0.07833132]
Stock Position:  0.0018816913214202173
Bond Position:  [0.61200074]


portfolio before change:  [0.79238495]
curr_Stock_Price:  95.82214901951286
curr_Factors:  [9.58221490e+01 4.31885395e-02]
mat_Sqrt:  [[ 1.99136177e+01  0.00000000e+00]
 [-8.31274102e-03  1.90468825e-02]]
grads:  [0.00649675 5.04738176]
Stock Position:  0.006496749065780126
Bond Position:  [0.16985249]


portfolio before change:  [0.7819652]
curr_Stock_Price:  94.21504026628911
curr_Factors:  [9.42150403e+01 4.17542549e-02]
mat_Sqrt:  [[ 1.92517675e+01  0.00000000e+00]
 [-8.17354316e-03  1.87279401e-02]]
grads:  [ 0.10232451 75.04161832]
Stock Position:  0.10232451223919076
Bond Position:  [-8.85854284]


portfolio before change:  [0.96358724]
curr_Stock_Price:  96.00082379516107
curr_Factors:  [9.60008238e+01 3.94050493e-02]
mat_Sqrt:  [[ 1.90568404e+01  0.00000000e+00]
 [-7.94028204e-03  1.81934718e-02]]
grads:  [1.51824583e-02 2.80509728e+01]
Stock Position:  0.015182458324011347
Bond Position:  [-0.49394127]


portfolio before change:  [0.99312013]
curr_Stock_Price:  97.95008891537347
curr_Factors:  [9.79500889e+01 3.79955570e-02]
mat_Sqrt:  [[ 1.90928712e+01  0.00000000e+00]
 [-7.79697962e-03  1.78651246e-02]]
grads:  [0.01290713 6.32945673]
Stock Position:  0.012907130863587898
Bond Position:  [-0.27113449]


portfolio before change:  [1.00854786]
curr_Stock_Price:  99.14800210228013
curr_Factors:  [9.91480021e+01 3.68558647e-02]
mat_Sqrt:  [[ 1.90343158e+01  0.00000000e+00]
 [-7.67915253e-03  1.75951489e-02]]
grads:  [-0.00607152  0.02464602]
Stock Position:  -0.006071517702114572
Bond Position:  [1.61052671]


portfolio before change:  [1.01398588]
curr_Stock_Price:  98.28550094696203
curr_Factors:  [9.82855009e+01 3.76099342e-02]
mat_Sqrt:  [[ 1.90607832e+01  0.00000000e+00]
 [-7.75731234e-03  1.77742355e-02]]
grads:  [-1.47334566e-03 -7.66586688e+00]
Stock Position:  -0.001473345664200706
Bond Position:  [1.15879439]


portfolio before change:  [1.01410441]
curr_Stock_Price:  98.30337086039624
curr_Factors:  [9.83033709e+01 3.72964889e-02]
mat_Sqrt:  [[ 1.89846408e+01  0.00000000e+00]
 [-7.72491956e-03  1.77000143e-02]]
grads:  [-0.00681334 -1.58482387]
Stock Position:  -0.006813343982239014
Bond Position:  [1.68387909]


portfolio before change:  [1.02792644]
curr_Stock_Price:  96.30559543926584
curr_Factors:  [9.63055954e+01 3.82692430e-02]
mat_Sqrt:  [[ 1.88398073e+01  0.00000000e+00]
 [-7.82501047e-03  1.79293514e-02]]
grads:  [-7.13193614e-04  1.46277039e+01]
Stock Position:  -0.0007131936138958049
Bond Position:  [1.09661097]


portfolio before change:  [1.02844195]
curr_Stock_Price:  95.77497713481013
curr_Factors:  [9.57749771e+01 3.85841017e-02]
mat_Sqrt:  [[ 1.88129219e+01  0.00000000e+00]
 [-7.85713451e-03  1.80029568e-02]]
grads:  [ 0.02274954 13.2830737 ]
Stock Position:  0.022749542241048044
Bond Position:  [-1.15039493]


portfolio before change:  [1.03223194]
curr_Stock_Price:  95.94789460976524
curr_Factors:  [9.59478946e+01 3.91686182e-02]
mat_Sqrt:  [[ 1.89891085e+01  0.00000000e+00]
 [-7.91642528e-03  1.81388090e-02]]
grads:  [ 0.00612516 -2.04762523]
Stock Position:  0.006125163324069544
Bond Position:  [0.44453541]


portfolio before change:  [1.03677682]
curr_Stock_Price:  96.68082358982925
curr_Factors:  [9.66808236e+01 3.87787231e-02]
mat_Sqrt:  [[ 1.90386914e+01  0.00000000e+00]
 [-7.87692560e-03  1.80483039e-02]]
grads:  [4.98614955e-03 6.88306690e+00]
Stock Position:  0.004986149551419469
Bond Position:  [0.55471177]


portfolio before change:  [1.03482666]
curr_Stock_Price:  96.27580131169111
curr_Factors:  [9.62758013e+01 3.86061316e-02]
mat_Sqrt:  [[ 1.89166960e+01  0.00000000e+00]
 [-7.85937724e-03  1.80080956e-02]]
grads:  [0.00985715 4.41868143]
Stock Position:  0.009857151133739053
Bond Position:  [0.08582154]


portfolio before change:  [1.04166557]
curr_Stock_Price:  96.96851476093165
curr_Factors:  [9.69685148e+01 3.74465892e-02]
mat_Sqrt:  [[ 1.87644948e+01  0.00000000e+00]
 [-7.74044849e-03  1.77355956e-02]]
grads:  [-0.00259013 -1.2486084 ]
Stock Position:  -0.002590127050263219
Bond Position:  [1.29282634]


portfolio before change:  [1.04103241]
curr_Stock_Price:  97.2753605463655
curr_Factors:  [9.72753605e+01 3.79191024e-02]
mat_Sqrt:  [[ 1.89422635e+01  0.00000000e+00]
 [-7.78913114e-03  1.78471415e-02]]
grads:  [-0.01400378  6.2943625 ]
Stock Position:  -0.01400378488527922
Bond Position:  [2.40325564]


portfolio before change:  [1.03576913]
curr_Stock_Price:  97.67266097836851
curr_Factors:  [9.76726610e+01 3.85677741e-02]
mat_Sqrt:  [[ 1.91816211e+01  0.00000000e+00]
 [-7.85547189e-03  1.79991473e-02]]
grads:  [ 0.00781    -0.15570432]
Stock Position:  0.007809998446769946
Bond Position:  [0.2729458]


portfolio before change:  [1.03963953]
curr_Stock_Price:  98.1638624048131
curr_Factors:  [9.81638624e+01 3.90817349e-02]
mat_Sqrt:  [[ 1.94061130e+01  0.00000000e+00]
 [-7.90764035e-03  1.81186802e-02]]
grads:  [0.05834642 5.35942709]
Stock Position:  0.05834641644675755
Bond Position:  [-4.68787006]


portfolio before change:  [1.00264487]
curr_Stock_Price:  97.5398541255937
curr_Factors:  [9.75398541e+01 3.96902247e-02]
mat_Sqrt:  [[ 1.94322854e+01  0.00000000e+00]
 [-7.96896226e-03  1.82591864e-02]]
grads:  [6.68797925e-03 1.40497428e+01]
Stock Position:  0.006687979250571099
Bond Position:  [0.35030035]


portfolio before change:  [1.00165244]
curr_Stock_Price:  97.38491630984066
curr_Factors:  [9.73849163e+01 4.19742395e-02]
mat_Sqrt:  [[ 1.99518473e+01  0.00000000e+00]
 [-8.19504626e-03  1.87772099e-02]]
grads:  [-4.39119026e-03  4.98615297e+00]
Stock Position:  -0.004391190255870582
Bond Position:  [1.42928813]


portfolio before change:  [1.00101196]
curr_Stock_Price:  97.57146026399016
curr_Factors:  [9.75714603e+01 4.08955207e-02]
mat_Sqrt:  [[ 1.97315261e+01  0.00000000e+00]
 [-8.08905638e-03  1.85343566e-02]]
grads:  [-6.01598339e-03  1.05605637e+01]
Stock Position:  -0.006015983388409222
Bond Position:  [1.58800024]


portfolio before change:  [0.99630669]
curr_Stock_Price:  98.38658567732921
curr_Factors:  [9.83865857e+01 4.08543326e-02]
mat_Sqrt:  [[ 1.98863441e+01  0.00000000e+00]
 [-8.08498189e-03  1.85250208e-02]]
grads:  [ 3.45562409e-03 -5.84653590e+00]
Stock Position:  0.0034556240937841996
Bond Position:  [0.65631963]


portfolio before change:  [0.9893483]
curr_Stock_Price:  96.34920211928035
curr_Factors:  [9.63492021e+01 4.00745183e-02]
mat_Sqrt:  [[ 1.92877815e+01  0.00000000e+00]
 [-8.00744836e-03  1.83473691e-02]]
grads:  [-1.66479560e-02 -2.45407776e+01]
Stock Position:  -0.016647955973148477
Bond Position:  [2.59336558]


portfolio before change:  [1.00417807]
curr_Stock_Price:  95.47788937340171
curr_Factors:  [9.54778894e+01 3.94183403e-02]
mat_Sqrt:  [[ 1.89562303e+01  0.00000000e+00]
 [-7.94162102e-03  1.81965397e-02]]
grads:  [0.00492839 2.60845915]
Stock Position:  0.004928389132387242
Bond Position:  [0.53362588]


portfolio before change:  [1.01334606]
curr_Stock_Price:  97.32459481282493
curr_Factors:  [9.73245948e+01 3.93817650e-02]
mat_Sqrt:  [[ 1.93139095e+01  0.00000000e+00]
 [-7.93793575e-03  1.81880957e-02]]
grads:  [ 0.01331519 -2.4296501 ]
Stock Position:  0.013315188384658975
Bond Position:  [-0.28254925]


portfolio before change:  [1.01210369]
curr_Stock_Price:  97.23394305829322
curr_Factors:  [9.72339431e+01 4.02474767e-02]
mat_Sqrt:  [[ 1.95068537e+01  0.00000000e+00]
 [-8.02470951e-03  1.83869194e-02]]
grads:  [-0.03120018 -9.45782363]
Stock Position:  -0.031200175083130124
Bond Position:  [4.04581974]


portfolio before change:  [1.02095871]
curr_Stock_Price:  96.96634015335242
curr_Factors:  [9.69663402e+01 4.09787801e-02]
mat_Sqrt:  [[ 1.96291059e+01  0.00000000e+00]
 [-8.09728647e-03  1.85532141e-02]]
grads:  [-0.00530131 -1.63850034]
Stock Position:  -0.005301314726936035
Bond Position:  [1.5350078]


portfolio before change:  [1.02539753]
curr_Stock_Price:  96.16523087835546
curr_Factors:  [9.61652309e+01 4.05886955e-02]
mat_Sqrt:  [[ 1.93740593e+01  0.00000000e+00]
 [-8.05865452e-03  1.84646972e-02]]
grads:  [-1.77634299e-03  2.70312406e+00]
Stock Position:  -0.0017763429906555394
Bond Position:  [1.19621997]


portfolio before change:  [1.02571347]
curr_Stock_Price:  96.0715521627979
curr_Factors:  [9.60715522e+01 4.14087732e-02]
mat_Sqrt:  [[ 1.95497402e+01  0.00000000e+00]
 [-8.13965829e-03  1.86503001e-02]]
grads:  [ 0.01537212 10.9840836 ]
Stock Position:  0.015372115268151734
Bond Position:  [-0.4511095]


portfolio before change:  [1.01575045]
curr_Stock_Price:  95.4270973710335
curr_Factors:  [9.54270974e+01 4.21663486e-02]
mat_Sqrt:  [[ 1.95954261e+01  0.00000000e+00]
 [-8.21377853e-03  1.88201309e-02]]
grads:  [ 0.00121065 -0.90410735]
Stock Position:  0.0012106534138300786
Bond Position:  [0.90022131]


portfolio before change:  [1.01534359]
curr_Stock_Price:  94.99807670781158
curr_Factors:  [9.49980767e+01 4.32349978e-02]
mat_Sqrt:  [[ 1.97529759e+01  0.00000000e+00]
 [-8.31721086e-03  1.90571242e-02]]
grads:  [ 7.71405716e-03 -8.74664574e+00]
Stock Position:  0.007714057164815466
Bond Position:  [0.28252299]


portfolio before change:  [1.02209822]
curr_Stock_Price:  95.86912546843674
curr_Factors:  [9.58691255e+01 4.26878535e-02]
mat_Sqrt:  [[ 1.98075575e+01  0.00000000e+00]
 [-8.26441562e-03  1.89361551e-02]]
grads:  [4.56193421e-03 5.95209972e+00]
Stock Position:  0.004561934205752626
Bond Position:  [0.58474958]


portfolio before change:  [1.02573067]
curr_Stock_Price:  96.64935409207928
curr_Factors:  [9.66493541e+01 4.25846734e-02]
mat_Sqrt:  [[ 1.99446131e+01  0.00000000e+00]
 [-8.25442169e-03  1.89132561e-02]]
grads:  [-0.00227851  0.04010802]
Stock Position:  -0.0022785100866716673
Bond Position:  [1.2459472]


portfolio before change:  [1.02407893]
curr_Stock_Price:  97.44263446946486
curr_Factors:  [9.74426345e+01 4.20449455e-02]
mat_Sqrt:  [[ 1.99804799e+01  0.00000000e+00]
 [-8.20194567e-03  1.87930184e-02]]
grads:  [-0.00930516 -3.90116253]
Stock Position:  -0.009305158541549436
Bond Position:  [1.93079809]


portfolio before change:  [1.01812629]
curr_Stock_Price:  98.10828716735975
curr_Factors:  [9.81082872e+01 4.26305515e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.01812629]
Stock Price:  95.70328773126423
PL:  [1.01812629]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48412130e+00  3.64996582e-01]
 [ 5.63838641e-01  1.19899917e-01]
 [ 1.10936240e-01 -4.67467571e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.35403792e-02  5.46612764e-03]
 [-6.70433518e-02 -1.21403422e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 5.44763305e-01  5.94579798e-01]
 [-2.96622377e-02  2.52993461e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-1.17078783e-01  7.57378839e-04]
 [ 2.79986982e-02 -1.35728755e-01]
 [-7.24364602e-02 -2.00988219e-02]
 [-4.46513428e-02 -3.66295365e-02]
 [ 4.55524384e-01  2.89973071e-01]
 [ 1.30728709e-01 -1.43789329e-01]
 [ 3.98680940e-02  1.23282646e-01]
 [ 1.36659531e-01  8.13817568e-02]
 [-7.47750116e-02 -5.50496016e-02]
 [-2.52379689e-01  7.57212855e-02]
 [ 1.76689275e-01 -4.46819916e-02]
 [ 1.04243599e+00  8.82904064e-02]
 [ 2.26434772e-02 -2.17519475e-02]
 [ 3.60224059e-02  1.36103052e-02]
 [ 2.76075877e-01 -1.80990428e-01]
 [ 1.69949769e-01 -8.93626402e-02]
 [-1.71344729e-01  4.88169370e-02]
 [ 5.27718253e-02  2.16013574e-01]
 [ 2.23950268e-02  1.54809587e-01]
 [-5.38240056e-01 -1.13084704e-01]
 [-1.65623648e-01 -6.06005724e-02]
 [-4.05350087e-02  2.32434570e-02]
 [ 9.40667563e-02  1.90557208e-01]
 [ 1.34404135e-02  2.17163422e-03]
 [ 8.09819283e-02 -2.07839795e-02]
 [-4.22675425e-02  1.18912396e-01]
 [-3.83816135e-02 -8.14999257e-02]
 [-7.54019333e-02 -5.27238903e-02]
 [ 1.28179810e-01 -1.30287450e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.87710012]
curr_Stock_Price:  99.04798050222895
curr_Factors:  [9.90479805e+01 4.02842357e-02]
mat_Sqrt:  [[ 1.98798539e+01  0.00000000e+00]
 [-8.02837325e-03  1.83953141e-02]]
grads:  [ 0.08266755 19.8418239 ]
Stock Position:  0.08266755263750056
Bond Position:  [-12.06515426]


portfolio before change:  [-3.83047799]
curr_Stock_Price:  99.63019650678045
curr_Factors:  [9.96301965e+01 4.14715987e-02]
mat_Sqrt:  [[ 2.02892679e+01  0.00000000e+00]
 [-8.14583071e-03  1.86644429e-02]]
grads:  [0.03036912 6.4239751 ]
Stock Position:  0.030369122204820624
Bond Position:  [-6.8561596]


portfolio before change:  [-3.83908614]
curr_Stock_Price:  99.37496771554639
curr_Factors:  [9.93749677e+01 4.19214741e-02]
mat_Sqrt:  [[ 2.03467605e+01  0.00000000e+00]
 [-8.18989368e-03  1.87654039e-02]]
grads:  [ 0.00444957 -2.49111383]
Stock Position:  0.004449567395534148
Bond Position:  [-4.28126175]


portfolio before change:  [-3.84050663]
curr_Stock_Price:  99.17600448510056
curr_Factors:  [9.91760045e+01 4.42507072e-02]
mat_Sqrt:  [[ 2.08625176e+01  0.00000000e+00]
 [-8.41434082e-03  1.92796769e-02]]
grads:  [-7.81371035e-04 -7.85214469e+00]
Stock Position:  -0.0007813710349828261
Bond Position:  [-3.76301337]


portfolio before change:  [-3.84205616]
curr_Stock_Price:  100.55707149309787
curr_Factors:  [1.00557071e+02 4.44589523e-02]
mat_Sqrt:  [[ 2.12027518e+01  0.00000000e+00]
 [-8.43411665e-03  1.93249890e-02]]
grads:  [-0.0042992   0.28285282]
Stock Position:  -0.00429919505486744
Bond Position:  [-3.40974169]


portfolio before change:  [-3.83474117]
curr_Stock_Price:  98.7564473570491
curr_Factors:  [9.87564474e+01 4.51389155e-02]
mat_Sqrt:  [[ 2.09817167e+01  0.00000000e+00]
 [-8.49836836e-03  1.94722081e-02]]
grads:  [-5.72060669e-03 -6.23470234e+00]
Stock Position:  -0.005720606694109351
Bond Position:  [-3.26979437]


portfolio before change:  [-3.82896281]
curr_Stock_Price:  97.67489918053661
curr_Factors:  [9.76748992e+01 4.53026688e-02]
mat_Sqrt:  [[ 2.07895393e+01  0.00000000e+00]
 [-8.51376944e-03  1.95074964e-02]]
grads:  [0.00622302 4.92820221]
Stock Position:  0.006223022813096634
Bond Position:  [-4.43679593]


portfolio before change:  [-3.81897768]
curr_Stock_Price:  99.3685707064781
curr_Factors:  [9.93685707e+01 4.44110655e-02]
mat_Sqrt:  [[ 2.09408661e+01  0.00000000e+00]
 [-8.42957323e-03  1.93145787e-02]]
grads:  [ 0.03840621 30.78399   ]
Stock Position:  0.03840620534992618
Bond Position:  [-7.63534742]


portfolio before change:  [-3.8427989]
curr_Stock_Price:  98.77317885495285
curr_Factors:  [9.87731789e+01 4.45667765e-02]
mat_Sqrt:  [[ 2.08518524e+01  0.00000000e+00]
 [-8.44433789e-03  1.93484088e-02]]
grads:  [3.87270920e-03 1.30756727e+01]
Stock Position:  0.0038727092017793057
Bond Position:  [-4.2253187]


portfolio before change:  [-3.84569556]
curr_Stock_Price:  98.16160317922487
curr_Factors:  [9.81616032e+01 4.47939627e-02]
mat_Sqrt:  [[ 2.07754952e+01  0.00000000e+00]
 [-8.46583371e-03  1.93976619e-02]]
grads:  [0.01186177 5.82938985]
Stock Position:  0.011861771962478047
Bond Position:  [-5.01006611]


portfolio before change:  [-3.83530462]
curr_Stock_Price:  99.0904052064336
curr_Factors:  [9.90904052e+01 4.38336708e-02]
mat_Sqrt:  [[ 2.07460550e+01  0.00000000e+00]
 [-8.37459690e-03  1.91886121e-02]]
grads:  [-0.00562749  0.03947023]
Stock Position:  -0.005627490878556109
Bond Position:  [-3.27767426]


portfolio before change:  [-3.83969266]
curr_Stock_Price:  99.7973476865084
curr_Factors:  [9.97973477e+01 4.26239304e-02]
mat_Sqrt:  [[ 2.06037251e+01  0.00000000e+00]
 [-8.25822552e-03  1.89219718e-02]]
grads:  [-1.51614268e-03 -7.17307672e+00]
Stock Position:  -0.0015161426807054224
Bond Position:  [-3.68838565]


portfolio before change:  [-3.84222578]
curr_Stock_Price:  101.16400190929524
curr_Factors:  [1.01164002e+02 4.33978845e-02]
mat_Sqrt:  [[ 2.10746456e+01  0.00000000e+00]
 [-8.33286356e-03  1.90929890e-02]]
grads:  [-0.00385337 -1.05268074]
Stock Position:  -0.0038533651586218362
Bond Position:  [-3.45240394]


portfolio before change:  [-3.83856676]
curr_Stock_Price:  100.10243677189709
curr_Factors:  [1.00102437e+02 4.36068460e-02]
mat_Sqrt:  [[ 2.09036434e+01  0.00000000e+00]
 [-8.35290090e-03  1.91389003e-02]]
grads:  [-0.00290082 -1.91387885]
Stock Position:  -0.002900823652566497
Bond Position:  [-3.54818725]


portfolio before change:  [-3.83817924]
curr_Stock_Price:  99.81594017097036
curr_Factors:  [9.98159402e+01 4.28596754e-02]
mat_Sqrt:  [[ 2.06644733e+01  0.00000000e+00]
 [-8.28103138e-03  1.89742266e-02]]
grads:  [ 0.0281681 15.2824712]
Stock Position:  0.02816810274283488
Bond Position:  [-6.6498049]


portfolio before change:  [-3.85121651]
curr_Stock_Price:  99.38261323019273
curr_Factors:  [9.93826132e+01 4.27318854e-02]
mat_Sqrt:  [[ 2.05440678e+01  0.00000000e+00]
 [-8.26867684e-03  1.89459188e-02]]
grads:  [ 3.30868752e-03 -7.58946192e+00]
Stock Position:  0.0033086875222289617
Bond Position:  [-4.18004253]


portfolio before change:  [-3.85651003]
curr_Stock_Price:  97.94065893946288
curr_Factors:  [9.79406589e+01 4.37026650e-02]
mat_Sqrt:  [[ 2.04746734e+01  0.00000000e+00]
 [-8.36207295e-03  1.91599161e-02]]
grads:  [4.57506942e-03 6.43440428e+00]
Stock Position:  0.0045750694192184475
Bond Position:  [-4.30459534]


portfolio before change:  [-3.8638195]
curr_Stock_Price:  96.46060266747918
curr_Factors:  [9.64606027e+01 4.53779438e-02]
mat_Sqrt:  [[ 2.05481334e+01  0.00000000e+00]
 [-8.52083975e-03  1.95236966e-02]]
grads:  [0.00837923 4.168358  ]
Stock Position:  0.008379225403360818
Bond Position:  [-4.67208463]


portfolio before change:  [-3.85727603]
curr_Stock_Price:  97.31121919032417
curr_Factors:  [9.73112192e+01 4.48564723e-02]
mat_Sqrt:  [[ 2.06098804e+01  0.00000000e+00]
 [-8.47173865e-03  1.94111918e-02]]
grads:  [-0.00479385 -2.83597226]
Stock Position:  -0.00479384768151653
Bond Position:  [-3.39078087]


portfolio before change:  [-3.86042471]
curr_Stock_Price:  97.87961567354868
curr_Factors:  [9.78796157e+01 4.45314280e-02]
mat_Sqrt:  [[ 2.06550175e+01  0.00000000e+00]
 [-8.44098837e-03  1.93407341e-02]]
grads:  [-0.01061883  3.91511952]
Stock Position:  -0.010618834448025971
Bond Position:  [-2.82105728]


portfolio before change:  [-3.87147598]
curr_Stock_Price:  98.88712847319836
curr_Factors:  [9.88871285e+01 4.49186538e-02]
mat_Sqrt:  [[ 2.09581591e+01  0.00000000e+00]
 [-8.47760851e-03  1.94246414e-02]]
grads:  [ 0.00750011 -2.3002737 ]
Stock Position:  0.007500107950260429
Bond Position:  [-4.61314012]


portfolio before change:  [-3.8749266]
curr_Stock_Price:  98.50394163867617
curr_Factors:  [9.85039416e+01 4.49327620e-02]
mat_Sqrt:  [[ 2.08802247e+01  0.00000000e+00]
 [-8.47893975e-03  1.94276916e-02]]
grads:  [0.05176999 4.54456496]
Stock Position:  0.051769992963537376
Bond Position:  [-8.97447497]


portfolio before change:  [-3.85395704]
curr_Stock_Price:  98.93066445568645
curr_Factors:  [9.89306645e+01 4.44823924e-02]
mat_Sqrt:  [[ 2.08653174e+01  0.00000000e+00]
 [-8.43633972e-03  1.93300827e-02]]
grads:  [ 6.30239586e-04 -1.12528994e+00]
Stock Position:  0.0006302395862073362
Bond Position:  [-3.91630707]


portfolio before change:  [-3.85314035]
curr_Stock_Price:  101.00331044872824
curr_Factors:  [1.01003310e+02 4.32289183e-02]
mat_Sqrt:  [[ 2.10001691e+01  0.00000000e+00]
 [-8.31662607e-03  1.90557843e-02]]
grads:  [0.00199819 0.71423485]
Stock Position:  0.0019981948618011196
Bond Position:  [-4.05496465]


portfolio before change:  [-3.85256736]
curr_Stock_Price:  101.54374489828805
curr_Factors:  [1.01543745e+02 4.49226464e-02]
mat_Sqrt:  [[ 2.15221593e+01  0.00000000e+00]
 [-8.47798527e-03  1.94255046e-02]]
grads:  [ 9.15731434e-03 -9.31715453e+00]
Stock Position:  0.009157314338915534
Bond Position:  [-4.78243535]


portfolio before change:  [-3.8627881]
curr_Stock_Price:  100.49290164417086
curr_Factors:  [1.00492902e+02 4.40301609e-02]
mat_Sqrt:  [[ 2.10867924e+01  0.00000000e+00]
 [-8.39334602e-03  1.92315717e-02]]
grads:  [ 0.00620999 -4.64666339]
Stock Position:  0.006209987403816957
Bond Position:  [-4.48684776]


portfolio before change:  [-3.85241331]
curr_Stock_Price:  102.25388483546024
curr_Factors:  [1.02253885e+02 4.48305337e-02]
mat_Sqrt:  [[ 2.16504422e+01  0.00000000e+00]
 [-8.46928887e-03  1.94055787e-02]]
grads:  [-0.00693008  2.51561357]
Stock Position:  -0.006930078819303782
Bond Position:  [-3.14378583]


portfolio before change:  [-3.84034616]
curr_Stock_Price:  100.45590408901411
curr_Factors:  [1.00455904e+02 4.64354281e-02]
mat_Sqrt:  [[ 2.16471234e+01  0.00000000e+00]
 [-8.61955248e-03  1.97498758e-02]]
grads:  [6.79295236e-03 1.09374649e+01]
Stock Position:  0.006792952362598011
Bond Position:  [-4.52273833]


portfolio before change:  [-3.84511251]
curr_Stock_Price:  99.83747297257683
curr_Factors:  [9.98374730e+01 4.71054174e-02]
mat_Sqrt:  [[ 2.16685080e+01  0.00000000e+00]
 [-8.68151299e-03  1.98918452e-02]]
grads:  [4.15162271e-03 7.78256543e+00]
Stock Position:  0.004151622706833379
Bond Position:  [-4.25960003]


portfolio before change:  [-3.84846833]
curr_Stock_Price:  99.15741719575244
curr_Factors:  [9.91574172e+01 4.82847049e-02]
mat_Sqrt:  [[ 2.17886336e+01  0.00000000e+00]
 [-8.78951238e-03  2.01393029e-02]]
grads:  [-0.02696793 -5.61512506]
Stock Position:  -0.026967926360607148
Bond Position:  [-1.1743984]


portfolio before change:  [-3.83934067]
curr_Stock_Price:  98.81350980137542
curr_Factors:  [9.88135098e+01 4.99776056e-02]
mat_Sqrt:  [[ 2.20904238e+01  0.00000000e+00]
 [-8.94226867e-03  2.04893115e-02]]
grads:  [-0.0086948  -2.95766758]
Stock Position:  -0.008694804024693316
Bond Position:  [-2.98017657]


portfolio before change:  [-3.82097149]
curr_Stock_Price:  96.6580017489239
curr_Factors:  [9.66580017e+01 5.08292279e-02]
mat_Sqrt:  [[ 2.17918735e+01  0.00000000e+00]
 [-9.01813532e-03  2.06631439e-02]]
grads:  [-0.00139459  1.12487515]
Stock Position:  -0.0013945901631995366
Bond Position:  [-3.68617319]


portfolio before change:  [-3.82218433]
curr_Stock_Price:  97.19725117783736
curr_Factors:  [9.71972512e+01 4.99402255e-02]
mat_Sqrt:  [[ 2.17209708e+01  0.00000000e+00]
 [-8.93892391e-03  2.04816477e-02]]
grads:  [8.15952204e-03 9.30380264e+00]
Stock Position:  0.008159522044214796
Bond Position:  [-4.61526744]


portfolio before change:  [-3.8240056]
curr_Stock_Price:  97.0447503005407
curr_Factors:  [9.70447503e+01 4.69811595e-02]
mat_Sqrt:  [[ 2.10345833e+01  0.00000000e+00]
 [-8.67005509e-03  1.98655919e-02]]
grads:  [0.00068403 0.10931636]
Stock Position:  0.0006840255488622266
Bond Position:  [-3.89038669]


portfolio before change:  [-3.82402625]
curr_Stock_Price:  97.72555072580899
curr_Factors:  [9.77255507e+01 4.68730997e-02]
mat_Sqrt:  [[ 2.11577735e+01  0.00000000e+00]
 [-8.66007849e-03  1.98427326e-02]]
grads:  [ 0.0033988  -1.04743535]
Stock Position:  0.003398800729783428
Bond Position:  [-4.15617592]


portfolio before change:  [-3.82602768]
curr_Stock_Price:  97.28954941432688
curr_Factors:  [9.72895494e+01 4.79730859e-02]
mat_Sqrt:  [[ 2.13090957e+01  0.00000000e+00]
 [-8.76110367e-03  2.00742104e-02]]
grads:  [4.51923543e-04 5.92364005e+00]
Stock Position:  0.0004519235434951943
Bond Position:  [-3.86999512]


portfolio before change:  [-3.82614349]
curr_Stock_Price:  98.10378707056691
curr_Factors:  [9.81037871e+01 4.55080123e-02]
mat_Sqrt:  [[ 2.09280954e+01  0.00000000e+00]
 [-8.53304281e-03  1.95516573e-02]]
grads:  [-3.53357990e-03 -4.16844078e+00]
Stock Position:  -0.003533579899352747
Bond Position:  [-3.47948592]


portfolio before change:  [-3.82850744]
curr_Stock_Price:  98.6496876299264
curr_Factors:  [9.86496876e+01 4.64374159e-02]
mat_Sqrt:  [[ 2.12583590e+01  0.00000000e+00]
 [-8.61973697e-03  1.97502986e-02]]
grads:  [-0.00462936 -2.66952371]
Stock Position:  -0.00462935665172058
Bond Position:  [-3.37182285]


portfolio before change:  [-3.82745125]
curr_Stock_Price:  98.33048667018295
curr_Factors:  [9.83304867e+01 4.66137883e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.82745125]
Stock Price:  97.6592735778868
PL:  [-3.82745125]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.42528448e+00  3.58303281e-01]
 [ 1.31829217e+00  4.81637440e-02]
 [-1.93406990e-03  6.63991236e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.26180171e-02  1.61766614e-01]
 [-2.34803533e-01  5.13239147e-02]
 [ 1.31769201e-01 -7.82050037e-02]
 [ 2.66353406e-01  4.61023345e-01]
 [-4.52897330e-02  1.97700973e-01]
 [ 1.81755468e-01  4.67669607e-02]
 [-1.09928625e-01 -1.45340362e-03]
 [ 3.16138351e-02 -1.36356934e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-5.37771427e-02 -1.57239036e-02]
 [ 5.13188543e-01  3.35693036e-01]
 [ 1.29903899e-01 -7.70134699e-02]
 [ 3.94750653e-02  1.06141785e-01]
 [ 6.09292345e-03 -7.70742616e-02]
 [-9.61889291e-02 -3.55581174e-01]
 [-7.86727265e-02 -3.69225367e-02]
 [ 1.72397672e-01 -4.06914723e-02]
 [ 6.38807986e-01 -1.37499567e-01]
 [ 2.94447929e-02 -3.56785097e-01]
 [ 1.04464725e-02  2.59637860e-02]
 [ 1.66975421e-01 -8.54270687e-02]
 [ 1.54132542e-01 -9.49160335e-02]
 [ 1.41857310e-01 -1.57332589e-01]
 [ 5.03376778e-02  1.68019117e-01]
 [ 1.46793998e-02  1.63843409e-01]
 [-5.17871826e-01 -1.10836585e-01]
 [-1.64935709e-01 -5.98410104e-02]
 [ 9.67313731e-03 -6.26715792e-02]
 [-1.42437295e-01  1.52770708e-01]
 [ 2.67335536e-02  2.80808736e-02]
 [-8.24912892e-02  9.42255251e-02]
 [-1.89428609e-01  9.77714973e-02]
 [-2.60304650e-02 -1.90173052e-01]
 [ 1.95210619e-02 -2.78324965e-02]
 [-3.80398588e-02 -9.78635860e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.12251126]
curr_Stock_Price:  98.28658303103666
curr_Factors:  [9.8286583e+01 4.0879584e-02]
mat_Sqrt:  [[ 1.98722696e+01  0.00000000e+00]
 [-8.08748011e-03  1.85307449e-02]]
grads:  [ 0.07959135 19.33561137]
Stock Position:  0.07959135445921425
Bond Position:  [-16.94527353]


portfolio before change:  [-9.1770538]
curr_Stock_Price:  97.62791536736655
curr_Factors:  [9.76279154e+01 4.01534639e-02]
mat_Sqrt:  [[ 1.95630031e+01  0.00000000e+00]
 [-8.01533170e-03  1.83654321e-02]]
grads:  [0.0684615  2.62252169]
Stock Position:  0.06846150046586295
Bond Position:  [-15.86080738]


portfolio before change:  [-9.16761037]
curr_Stock_Price:  97.79481440332798
curr_Factors:  [9.77948144e+01 3.99254777e-02]
mat_Sqrt:  [[ 1.95407347e+01  0.00000000e+00]
 [-7.99254430e-03  1.83132196e-02]]
grads:  [1.38402593e-03 3.62574823e+00]
Stock Position:  0.0013840259291272856
Bond Position:  [-9.30296093]


portfolio before change:  [-9.16807534]
curr_Stock_Price:  98.29911943673237
curr_Factors:  [9.82991194e+01 3.86245362e-02]
mat_Sqrt:  [[ 1.93188498e+01  0.00000000e+00]
 [-7.86125040e-03  1.80123875e-02]]
grads:  [-8.43806289e-04 -8.40459447e+00]
Stock Position:  -0.0008438062887163824
Bond Position:  [-9.08512993]


portfolio before change:  [-9.17057476]
curr_Stock_Price:  99.91525634453019
curr_Factors:  [9.99152563e+01 3.84897694e-02]
mat_Sqrt:  [[ 1.96021840e+01  0.00000000e+00]
 [-7.84752388e-03  1.79809361e-02]]
grads:  [-6.13058151e-04  8.99656243e+00]
Stock Position:  -0.0006130581513156374
Bond Position:  [-9.1093209]


portfolio before change:  [-9.17216503]
curr_Stock_Price:  100.65178137204417
curr_Factors:  [1.00651781e+02 3.81884188e-02]
mat_Sqrt:  [[ 1.96692275e+01  0.00000000e+00]
 [-7.81674293e-03  1.79104081e-02]]
grads:  [-0.01079879  2.86559159]
Stock Position:  -0.010798794231173532
Bond Position:  [-8.08524715]


portfolio before change:  [-9.1773404]
curr_Stock_Price:  101.03744050006888
curr_Factors:  [1.01037441e+02 3.91931737e-02]
mat_Sqrt:  [[ 2.00026507e+01  0.00000000e+00]
 [-7.91890636e-03  1.81444939e-02]]
grads:  [ 0.00488124 -4.31012318]
Stock Position:  0.004881240001190533
Bond Position:  [-9.6705284]


portfolio before change:  [-9.18142999]
curr_Stock_Price:  100.447284031139
curr_Factors:  [1.00447284e+02 3.96958137e-02]
mat_Sqrt:  [[ 2.00129243e+01  0.00000000e+00]
 [-7.96952332e-03  1.82604719e-02]]
grads:  [2.33629270e-02 2.52470663e+01]
Stock Position:  0.023362926996937622
Bond Position:  [-11.52817255]


portfolio before change:  [-9.21204196]
curr_Stock_Price:  99.19868782451569
curr_Factors:  [9.91986878e+01 4.10018478e-02]
mat_Sqrt:  [[ 2.00866560e+01  0.00000000e+00]
 [-8.09956520e-03  1.85584353e-02]]
grads:  [2.04085964e-03 1.06528902e+01]
Stock Position:  0.002040859642720683
Bond Position:  [-9.41449256]


portfolio before change:  [-9.21248585]
curr_Stock_Price:  99.55784812650022
curr_Factors:  [9.95578481e+01 3.95191070e-02]
mat_Sqrt:  [[ 1.97915160e+01  0.00000000e+00]
 [-7.95176529e-03  1.82197832e-02]]
grads:  [0.01021479 2.56682312]
Stock Position:  0.010214793194658421
Bond Position:  [-10.22944868]


portfolio before change:  [-9.21283202]
curr_Stock_Price:  99.64914661846892
curr_Factors:  [9.96491466e+01 3.92525846e-02]
mat_Sqrt:  [[ 1.97427530e+01  0.00000000e+00]
 [-7.92490602e-03  1.81582409e-02]]
grads:  [-0.00560018 -0.08004099]
Stock Position:  -0.0056001785749567705
Bond Position:  [-8.654779]


portfolio before change:  [-9.20622345]
curr_Stock_Price:  98.27589082735521
curr_Factors:  [9.82758908e+01 3.94678581e-02]
mat_Sqrt:  [[ 1.95239986e+01  0.00000000e+00]
 [-7.94660764e-03  1.82079655e-02]]
grads:  [-1.42886764e-03 -7.48886161e+00]
Stock Position:  -0.0014288676377593385
Bond Position:  [-9.06580021]


portfolio before change:  [-9.20735829]
curr_Stock_Price:  98.27697018809015
curr_Factors:  [9.82769702e+01 3.93408226e-02]
mat_Sqrt:  [[ 1.94927664e+01  0.00000000e+00]
 [-7.93380843e-03  1.81786388e-02]]
grads:  [-0.00663574 -1.54309712]
Stock Position:  -0.006635737882291107
Bond Position:  [-8.55521808]


portfolio before change:  [-9.21527455]
curr_Stock_Price:  99.3087756007721
curr_Factors:  [9.93087756e+01 3.89215800e-02]
mat_Sqrt:  [[ 1.95921843e+01  0.00000000e+00]
 [-7.89142116e-03  1.80815174e-02]]
grads:  [-0.00309509 -0.86961195]
Stock Position:  -0.0030950921972495897
Bond Position:  [-8.90790474]


portfolio before change:  [-9.21479455]
curr_Stock_Price:  98.79390925298189
curr_Factors:  [9.87939093e+01 3.93286069e-02]
mat_Sqrt:  [[ 1.95922562e+01  0.00000000e+00]
 [-7.93257657e-03  1.81758163e-02]]
grads:  [ 0.03367131 18.46921372]
Stock Position:  0.03367131312909252
Bond Position:  [-12.5413152]


portfolio before change:  [-9.21259694]
curr_Stock_Price:  98.90573661713336
curr_Factors:  [9.89057366e+01 3.82556153e-02]
mat_Sqrt:  [[ 1.93450153e+01  0.00000000e+00]
 [-7.82361709e-03  1.79261588e-02]]
grads:  [ 0.00497764 -4.29615016]
Stock Position:  0.004977637041500059
Bond Position:  [-9.7049138]


portfolio before change:  [-9.21315311]
curr_Stock_Price:  99.03773095717803
curr_Factors:  [9.90377310e+01 3.84619705e-02]
mat_Sqrt:  [[ 1.94230061e+01  0.00000000e+00]
 [-7.84468947e-03  1.79744416e-02]]
grads:  [4.41739746e-03 5.90515058e+00]
Stock Position:  0.004417397461277973
Bond Position:  [-9.65064213]


portfolio before change:  [-9.21025097]
curr_Stock_Price:  99.96781390905323
curr_Factors:  [9.99678139e+01 3.81651301e-02]
mat_Sqrt:  [[ 1.95296099e+01  0.00000000e+00]
 [-7.81435911e-03  1.79049461e-02]]
grads:  [-1.41042459e-03 -4.30463523e+00]
Stock Position:  -0.0014104245897338314
Bond Position:  [-9.06925391]


portfolio before change:  [-9.21112602]
curr_Stock_Price:  99.78441407668032
curr_Factors:  [9.97844141e+01 3.85356944e-02]
mat_Sqrt:  [[ 1.95881899e+01  0.00000000e+00]
 [-7.85220421e-03  1.79916601e-02]]
grads:  [-1.28331039e-02 -1.97636667e+01]
Stock Position:  -0.01283310388756928
Bond Position:  [-7.93058227]


portfolio before change:  [-9.20795133]
curr_Stock_Price:  99.45977886906992
curr_Factors:  [9.94597789e+01 3.83968055e-02]
mat_Sqrt:  [[ 1.94892459e+01  0.00000000e+00]
 [-7.83804113e-03  1.79592084e-02]]
grads:  [-0.00486356 -2.05591115]
Stock Position:  -0.00486355618638265
Bond Position:  [-8.72422311]


portfolio before change:  [-9.21659487]
curr_Stock_Price:  101.0127464906495
curr_Factors:  [1.01012746e+02 3.80383472e-02]
mat_Sqrt:  [[ 1.97009423e+01  0.00000000e+00]
 [-7.80136882e-03  1.78751816e-02]]
grads:  [ 0.00784929 -2.27642288]
Stock Position:  0.007849292453763273
Bond Position:  [-10.00947346]


portfolio before change:  [-9.21590704]
curr_Stock_Price:  101.2597876066557
curr_Factors:  [1.01259788e+02 3.77177495e-02]
mat_Sqrt:  [[ 1.96657221e+01  0.00000000e+00]
 [-7.76842321e-03  1.77996937e-02]]
grads:  [ 0.02943183 -7.72482772]
Stock Position:  0.02943183328132696
Bond Position:  [-12.19616822]


portfolio before change:  [-9.21826541]
curr_Stock_Price:  101.23145931165541
curr_Factors:  [1.01231459e+02 3.71292944e-02]
mat_Sqrt:  [[ 1.95062527e+01  0.00000000e+00]
 [-7.70758530e-03  1.76602965e-02]]
grads:  [-6.47325714e-03 -2.02026674e+01]
Stock Position:  -0.0064732571409068145
Bond Position:  [-8.56296814]


portfolio before change:  [-9.21421737]
curr_Stock_Price:  100.44074787356391
curr_Factors:  [1.00440748e+02 3.74014305e-02]
mat_Sqrt:  [[ 1.94246877e+01  0.00000000e+00]
 [-7.73577978e-03  1.77248982e-02]]
grads:  [1.12115047e-03 1.46482003e+00]
Stock Position:  0.001121150472169636
Bond Position:  [-9.32682656]


portfolio before change:  [-9.21547462]
curr_Stock_Price:  100.3592862728231
curr_Factors:  [1.00359286e+02 3.67914353e-02]
mat_Sqrt:  [[ 1.92500087e+01  0.00000000e+00]
 [-7.67243745e-03  1.75797627e-02]]
grads:  [ 0.00673724 -4.85939829]
Stock Position:  0.006737243264257949
Bond Position:  [-9.89161955]


portfolio before change:  [-9.22000401]
curr_Stock_Price:  99.87053201850209
curr_Factors:  [9.98705320e+01 3.60930531e-02]
mat_Sqrt:  [[ 1.89735752e+01  0.00000000e+00]
 [-7.59926871e-03  1.74121120e-02]]
grads:  [ 0.00594025 -5.45114994]
Stock Position:  0.005940250443656585
Bond Position:  [-9.81325998]


portfolio before change:  [-9.21963941]
curr_Stock_Price:  100.1384229547474
curr_Factors:  [1.00138423e+02 3.55387167e-02]
mat_Sqrt:  [[ 1.88778103e+01  0.00000000e+00]
 [-7.54068609e-03  1.72778824e-02]]
grads:  [ 3.87713073e-03 -9.10601112e+00]
Stock Position:  0.0038771307330588665
Bond Position:  [-9.60788916]


portfolio before change:  [-9.2220131]
curr_Stock_Price:  99.83597484364002
curr_Factors:  [9.98359748e+01 3.56840370e-02]
mat_Sqrt:  [[ 1.88592342e+01  0.00000000e+00]
 [-7.55608756e-03  1.73131716e-02]]
grads:  [6.55738357e-03 9.70469890e+00]
Stock Position:  0.006557383569891127
Bond Position:  [-9.87667588]


portfolio before change:  [-9.22251016]
curr_Stock_Price:  99.94845881560681
curr_Factors:  [9.99484588e+01 3.63625322e-02]
mat_Sqrt:  [[ 1.90591339e+01  0.00000000e+00]
 [-7.62758490e-03  1.74769926e-02]]
grads:  [4.52205890e-03 9.37480566e+00]
Stock Position:  0.004522058896221175
Bond Position:  [-9.67448298]


portfolio before change:  [-9.22430649]
curr_Stock_Price:  99.81866282947072
curr_Factors:  [9.98186628e+01 3.59864344e-02]
mat_Sqrt:  [[ 1.89356910e+01  0.00000000e+00]
 [-7.58803631e-03  1.73863754e-02]]
grads:  [-0.02990358 -6.37491038]
Stock Position:  -0.029903576230933177
Bond Position:  [-6.2393715]


portfolio before change:  [-9.19289672]
curr_Stock_Price:  98.7422115436549
curr_Factors:  [9.87422115e+01 3.65010449e-02]
mat_Sqrt:  [[ 1.88649430e+01  0.00000000e+00]
 [-7.64209865e-03  1.75102478e-02]]
grads:  [-0.01012738 -3.41748507]
Stock Position:  -0.01012738108154587
Bond Position:  [-8.19289671]


portfolio before change:  [-9.20238522]
curr_Stock_Price:  99.57799818047837
curr_Factors:  [9.95779982e+01 3.67307908e-02]
mat_Sqrt:  [[ 1.90844009e+01  0.00000000e+00]
 [-7.66611148e-03  1.75652681e-02]]
grads:  [-9.26357730e-04 -3.56792615e+00]
Stock Position:  -0.0009263577302640287
Bond Position:  [-9.11014037]


portfolio before change:  [-9.20353251]
curr_Stock_Price:  99.58712316023873
curr_Factors:  [9.95871232e+01 3.80267797e-02]
mat_Sqrt:  [[ 1.94199435e+01  0.00000000e+00]
 [-7.80018253e-03  1.78724634e-02]]
grads:  [-3.90128281e-03  8.54782599e+00]
Stock Position:  -0.0039012828096503904
Bond Position:  [-8.81501498]


portfolio before change:  [-9.20523749]
curr_Stock_Price:  99.74169466176897
curr_Factors:  [9.97416947e+01 3.66674056e-02]
mat_Sqrt:  [[ 1.90992729e+01  0.00000000e+00]
 [-7.65949404e-03  1.75501056e-02]]
grads:  [0.00204139 1.60004015]
Stock Position:  0.002041389315967568
Bond Position:  [-9.40884912]


portfolio before change:  [-9.20572934]
curr_Stock_Price:  100.07692282928328
curr_Factors:  [1.00076923e+02 3.69409733e-02]
mat_Sqrt:  [[ 1.92348193e+01  0.00000000e+00]
 [-7.68801387e-03  1.76154527e-02]]
grads:  [-2.15067779e-03  5.34902659e+00]
Stock Position:  -0.0021506777898252184
Bond Position:  [-8.99049612]


portfolio before change:  [-9.20679636]
curr_Stock_Price:  100.05048674852068
curr_Factors:  [1.00050487e+02 3.54181524e-02]
mat_Sqrt:  [[ 1.88292125e+01  0.00000000e+00]
 [-7.52788442e-03  1.72485501e-02]]
grads:  [-0.00779415  5.66838933]
Stock Position:  -0.007794145885918045
Bond Position:  [-8.42698827]


portfolio before change:  [-9.20888886]
curr_Stock_Price:  100.18379963916139
curr_Factors:  [1.00183800e+02 3.57358706e-02]
mat_Sqrt:  [[ 1.89386790e+01  0.00000000e+00]
 [-7.56157344e-03  1.73257413e-02]]
grads:  [-5.75693742e-03 -1.09763299e+01]
Stock Position:  -0.005756937421375516
Bond Position:  [-8.632137]


portfolio before change:  [-9.21527279]
curr_Stock_Price:  101.1052695903844
curr_Factors:  [1.01105270e+02 3.45530029e-02]
mat_Sqrt:  [[ 1.87938904e+01  0.00000000e+00]
 [-7.43537522e-03  1.70365849e-02]]
grads:  [ 3.92359664e-04 -1.63368989e+00]
Stock Position:  0.0003923596644861895
Bond Position:  [-9.25494242]


portfolio before change:  [-9.21660043]
curr_Stock_Price:  100.67022019446634
curr_Factors:  [1.00670220e+02 3.47054745e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.21660043]
Stock Price:  102.00681297546825
PL:  [-11.2234134]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.37804902e+00  3.40450489e-01]
 [ 9.23819896e-01  8.44659835e-02]
 [-2.65978272e-02  8.37583171e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.42212308e-01  1.06825005e+00]
 [ 1.03230118e-02 -6.14889604e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.18462522e+00  1.21482473e+00]
 [ 9.43722242e-02  5.84403198e-01]
 [ 1.57590860e-01  4.29686702e-02]
 [-2.98206941e-02  1.71048004e-02]
 [ 4.61816777e-02 -1.36079856e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-5.33374130e-02 -1.70973141e-02]
 [ 5.09185735e-01  3.32393819e-01]
 [ 1.29939603e-01 -2.82917442e-02]
 [ 3.95022768e-02  1.04697461e-01]
 [ 8.97664884e-02  8.67438290e-02]
 [ 1.07578940e-01  1.15078085e-01]
 [-3.58706422e-01  1.32707325e-01]
 [ 1.28666161e-01  3.37030691e-02]
 [ 1.39610956e+00  1.53046832e-01]
 [ 1.58064149e-02  4.41473901e-01]
 [-1.47981447e-01  1.70372802e-01]
 [-1.97562748e-01  1.24708083e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 3.86505233e-02 -4.56695229e-01]
 [ 9.19931151e-02  6.41260065e-03]
 [ 6.78625240e-01 -3.15137454e-01]
 [-6.04470562e-01 -3.14208660e-01]
 [ 4.50959271e-01  1.69512268e-01]
 [-1.86254612e-01  2.72719244e-01]
 [ 4.15024614e-01  2.22845272e-01]
 [ 3.96242815e-02 -2.46803487e-02]
 [ 2.62335560e-01 -2.07071833e-01]
 [ 5.77411147e-02  1.03684903e-01]
 [-6.12220200e-02  2.57367278e-01]
 [-3.54295904e-01 -1.35722204e-01]
 [ 1.45361958e-02  4.18741940e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.1541806]
curr_Stock_Price:  99.77829588059745
curr_Factors:  [9.97782959e+01 3.99873076e-02]
mat_Sqrt:  [[ 1.99524929e+01  0.00000000e+00]
 [-7.99873066e-03  1.83273944e-02]]
grads:  [ 0.07651344 18.57604427]
Stock Position:  0.07651343660562954
Bond Position:  [-6.48019971]


portfolio before change:  [1.08166799]
curr_Stock_Price:  98.84117236681335
curr_Factors:  [9.88411724e+01 4.12846004e-02]
mat_Sqrt:  [[ 2.00831546e+01  0.00000000e+00]
 [-8.12744490e-03  1.86223157e-02]]
grads:  [0.04783531 4.53574006]
Stock Position:  0.047835307499873886
Bond Position:  [-3.64642989]


portfolio before change:  [1.02278123]
curr_Stock_Price:  97.61967029846214
curr_Factors:  [9.76196703e+01 4.22769476e-02]
mat_Sqrt:  [[ 2.00719307e+01  0.00000000e+00]
 [-8.22454353e-03  1.88447966e-02]]
grads:  [4.96080793e-04 4.44463895e+00]
Stock Position:  0.0004960807929934555
Bond Position:  [0.97435399]


portfolio before change:  [1.02287253]
curr_Stock_Price:  97.55819221762059
curr_Factors:  [9.75581922e+01 4.24343152e-02]
mat_Sqrt:  [[ 2.00965886e+01  0.00000000e+00]
 [-8.23983643e-03  1.88798371e-02]]
grads:  [-8.11150949e-04 -8.01843850e+00]
Stock Position:  -0.0008111509491658165
Bond Position:  [1.10200695]


portfolio before change:  [1.02384315]
curr_Stock_Price:  96.53143409989974
curr_Factors:  [9.65314341e+01 4.19521543e-02]
mat_Sqrt:  [[ 1.97717856e+01  0.00000000e+00]
 [-8.19289002e-03  1.87722693e-02]]
grads:  [1.6387505e-02 5.6905749e+01]
Stock Position:  0.016387504989090498
Bond Position:  [-0.55806621]


portfolio before change:  [1.03711914]
curr_Stock_Price:  97.345820192239
curr_Factors:  [9.73458202e+01 4.20423733e-02]
mat_Sqrt:  [[ 1.99600176e+01  0.00000000e+00]
 [-8.20169478e-03  1.87924436e-02]]
grads:  [-8.27302407e-04 -3.27200452e+00]
Stock Position:  -0.0008273024072384648
Bond Position:  [1.11765357]


portfolio before change:  [1.0382738]
curr_Stock_Price:  96.11901211941121
curr_Factors:  [9.61190121e+01 4.42090147e-02]
mat_Sqrt:  [[ 2.02099257e+01  0.00000000e+00]
 [-8.41037594e-03  1.92705922e-02]]
grads:  [0.0064015  4.98878738]
Stock Position:  0.006401496932011038
Bond Position:  [0.42296824]


portfolio before change:  [1.03398528]
curr_Stock_Price:  95.44082761990373
curr_Factors:  [9.54408276e+01 4.42566160e-02]
mat_Sqrt:  [[ 2.00781317e+01  0.00000000e+00]
 [-8.41490259e-03  1.92809640e-02]]
grads:  [ 0.08540726 63.00643082]
Stock Position:  0.08540725912863294
Bond Position:  [-7.11735422]


portfolio before change:  [1.0117123]
curr_Stock_Price:  95.19045958124637
curr_Factors:  [9.51904596e+01 4.58488620e-02]
mat_Sqrt:  [[ 2.03825119e+01  0.00000000e+00]
 [-8.56493895e-03  1.96247405e-02]]
grads:  [1.71434557e-02 2.97789007e+01]
Stock Position:  0.017143455746213832
Bond Position:  [-0.62018113]


portfolio before change:  [1.02964679]
curr_Stock_Price:  96.24112385545746
curr_Factors:  [9.62411239e+01 4.65745620e-02]
mat_Sqrt:  [[ 2.07699320e+01  0.00000000e+00]
 [-8.63245615e-03  1.97794419e-02]]
grads:  [0.00849035 2.17239043]
Stock Position:  0.008490346747770385
Bond Position:  [0.21252628]


portfolio before change:  [1.03438616]
curr_Stock_Price:  96.79620148599007
curr_Factors:  [9.67962015e+01 4.53506980e-02]
mat_Sqrt:  [[ 2.06134319e+01  0.00000000e+00]
 [-8.51828132e-03  1.95178345e-02]]
grads:  [-0.00108451  0.87636774]
Stock Position:  -0.0010845135983662052
Bond Position:  [1.13936296]


portfolio before change:  [1.03357456]
curr_Stock_Price:  97.67588696900624
curr_Factors:  [9.76758870e+01 4.45576394e-02]
mat_Sqrt:  [[ 2.06180909e+01  0.00000000e+00]
 [-8.44347222e-03  1.93464253e-02]]
grads:  [-6.40623831e-04 -7.03385012e+00]
Stock Position:  -0.0006406238306830768
Bond Position:  [1.09614806]


portfolio before change:  [1.03333717]
curr_Stock_Price:  98.26035049332678
curr_Factors:  [9.82603505e+01 4.34926101e-02]
mat_Sqrt:  [[ 2.04920801e+01  0.00000000e+00]
 [-8.34195278e-03  1.91138150e-02]]
grads:  [-0.00631214 -1.46759844]
Stock Position:  -0.006312140474055565
Bond Position:  [1.6535703]


portfolio before change:  [1.0268392]
curr_Stock_Price:  99.32253838170705
curr_Factors:  [9.93225384e+01 4.32028274e-02]
mat_Sqrt:  [[ 2.06444775e+01  0.00000000e+00]
 [-8.31411594e-03  1.90500328e-02]]
grads:  [-0.00294506 -0.89749526]
Stock Position:  -0.0029450632820979534
Bond Position:  [1.31935036]


portfolio before change:  [1.0283392]
curr_Stock_Price:  98.8692118836123
curr_Factors:  [9.88692119e+01 4.41059672e-02]
mat_Sqrt:  [[ 2.07639392e+01  0.00000000e+00]
 [-8.40056829e-03  1.92481200e-02]]
grads:  [ 0.03150916 17.26889786]
Stock Position:  0.031509160455490244
Bond Position:  [-2.08694666]


portfolio before change:  [1.02039397]
curr_Stock_Price:  98.62533531558776
curr_Factors:  [9.86253353e+01 4.42083743e-02]
mat_Sqrt:  [[ 2.07367535e+01  0.00000000e+00]
 [-8.41031503e-03  1.92704526e-02]]
grads:  [ 0.00567071 -1.46814113]
Stock Position:  0.005670707960063554
Bond Position:  [0.4611185]


portfolio before change:  [1.02334194]
curr_Stock_Price:  99.13503028866452
curr_Factors:  [9.91350303e+01 4.29760953e-02]
mat_Sqrt:  [[ 2.05513625e+01  0.00000000e+00]
 [-8.29227065e-03  1.89999790e-02]]
grads:  [4.14551564e-03 5.51039877e+00]
Stock Position:  0.004145515636261664
Bond Position:  [0.61237613]


portfolio before change:  [1.01494177]
curr_Stock_Price:  97.09023577925817
curr_Factors:  [9.70902358e+01 4.56054178e-02]
mat_Sqrt:  [[ 2.07340325e+01  0.00000000e+00]
 [-8.54217001e-03  1.95725703e-02]]
grads:  [0.00615532 4.4319079 ]
Stock Position:  0.006155319717050685
Bond Position:  [0.41732033]


portfolio before change:  [1.00478344]
curr_Stock_Price:  95.43142734560747
curr_Factors:  [9.54314273e+01 4.63527809e-02]
mat_Sqrt:  [[ 2.05460962e+01  0.00000000e+00]
 [-8.61187839e-03  1.97322923e-02]]
grads:  [0.00768044 5.83196737]
Stock Position:  0.0076804436359798065
Bond Position:  [0.27182774]


portfolio before change:  [1.0149908]
curr_Stock_Price:  96.75600914841368
curr_Factors:  [9.67560091e+01 4.52051853e-02]
mat_Sqrt:  [[ 2.05717896e+01  0.00000000e+00]
 [-8.50460443e-03  1.94864968e-02]]
grads:  [-0.01462139  6.81021975]
Stock Position:  -0.014621391848070311
Bond Position:  [2.42969832]


portfolio before change:  [1.01683093]
curr_Stock_Price:  96.65092991447804
curr_Factors:  [9.66509299e+01 4.67090141e-02]
mat_Sqrt:  [[ 2.08884583e+01  0.00000000e+00]
 [-8.64490732e-03  1.98079711e-02]]
grads:  [0.00686386 1.70149022]
Stock Position:  0.006863856805544844
Bond Position:  [0.35343279]


portfolio before change:  [1.01215819]
curr_Stock_Price:  95.96371741695798
curr_Factors:  [9.59637174e+01 4.64041652e-02]
mat_Sqrt:  [[ 2.06721451e+01  0.00000000e+00]
 [-8.61665041e-03  1.97432264e-02]]
grads:  [0.07076695 7.75186534]
Stock Position:  0.07076695077554633
Bond Position:  [-5.77890148]


portfolio before change:  [0.94507732]
curr_Stock_Price:  95.02601337764932
curr_Factors:  [9.50260134e+01 4.60596397e-02]
mat_Sqrt:  [[ 2.03940171e+01  0.00000000e+00]
 [-8.58460387e-03  1.96697985e-02]]
grads:  [1.02226756e-02 2.24442513e+01]
Stock Position:  0.010222675639491354
Bond Position:  [-0.02634279]


portfolio before change:  [0.936408]
curr_Stock_Price:  94.17828763360839
curr_Factors:  [9.41782876e+01 4.56898782e-02]
mat_Sqrt:  [[ 2.01307887e+01  0.00000000e+00]
 [-8.55007632e-03  1.95906860e-02]]
grads:  [-3.65731624e-03  8.69662258e+00]
Stock Position:  -0.0036573162370870183
Bond Position:  [1.28084779]


portfolio before change:  [0.93426853]
curr_Stock_Price:  94.80705174245797
curr_Factors:  [9.48070517e+01 4.32105782e-02]
mat_Sqrt:  [[ 1.97076881e+01  0.00000000e+00]
 [-8.31486170e-03  1.90517416e-02]]
grads:  [-0.00726294  6.54575763]
Stock Position:  -0.007262936042734277
Bond Position:  [1.62284608]


portfolio before change:  [0.94044461]
curr_Stock_Price:  93.98462837235418
curr_Factors:  [9.39846284e+01 4.35349442e-02]
mat_Sqrt:  [[ 1.96099201e+01  0.00000000e+00]
 [-8.34601166e-03  1.91231151e-02]]
grads:  [ 0.00935642 -3.81713632]
Stock Position:  0.009356417654343717
Bond Position:  [0.06108517]


portfolio before change:  [0.94530357]
curr_Stock_Price:  94.50313126764847
curr_Factors:  [9.45031313e+01 4.35090440e-02]
mat_Sqrt:  [[ 1.97122396e+01  0.00000000e+00]
 [-8.34352865e-03  1.91174258e-02]]
grads:  [-8.15065251e-03 -2.38889500e+01]
Stock Position:  -0.00815065251499842
Bond Position:  [1.71556576]


portfolio before change:  [0.9490428]
curr_Stock_Price:  94.07067973512625
curr_Factors:  [9.40706797e+01 4.51997031e-02]
mat_Sqrt:  [[ 1.99996351e+01  0.00000000e+00]
 [-8.50408872e-03  1.94853151e-02]]
grads:  [0.00473968 0.32909915]
Stock Position:  0.004739676634844598
Bond Position:  [0.50317819]


portfolio before change:  [0.93952716]
curr_Stock_Price:  92.04975332684562
curr_Factors:  [9.20497533e+01 4.59370628e-02]
mat_Sqrt:  [[ 1.97289622e+01  0.00000000e+00]
 [-8.57317331e-03  1.96436078e-02]]
grads:  [  0.02742607 -16.0427482 ]
Stock Position:  0.027426074098632798
Bond Position:  [-1.5850362]


portfolio before change:  [0.9565652]
curr_Stock_Price:  92.67821296733143
curr_Factors:  [9.26782130e+01 4.52411984e-02]
mat_Sqrt:  [[ 1.97126359e+01  0.00000000e+00]
 [-8.50799139e-03  1.94942573e-02]]
grads:  [ -0.03762066 -16.11801136]
Stock Position:  -0.037620664539074374
Bond Position:  [4.44318116]


portfolio before change:  [0.99561018]
curr_Stock_Price:  91.65511712595584
curr_Factors:  [9.16551171e+01 4.63444682e-02]
mat_Sqrt:  [[ 1.97312986e+01  0.00000000e+00]
 [-8.61110615e-03  1.97305229e-02]]
grads:  [0.02660446 8.5913723 ]
Stock Position:  0.02660445725547165
Bond Position:  [-1.44282447]


portfolio before change:  [1.0041576]
curr_Stock_Price:  91.98317459832911
curr_Factors:  [9.19831746e+01 4.56651066e-02]
mat_Sqrt:  [[ 1.96562484e+01  0.00000000e+00]
 [-8.54775822e-03  1.95853745e-02]]
grads:  [-3.42029539e-03  1.39246377e+01]
Stock Position:  -0.0034202953856487177
Bond Position:  [1.31876723]


portfolio before change:  [0.997166]
curr_Stock_Price:  94.07552671220829
curr_Factors:  [9.40755267e+01 4.65422440e-02]
mat_Sqrt:  [[ 2.02955263e+01  0.00000000e+00]
 [-8.62946061e-03  1.97725782e-02]]
grads:  [ 0.02524114 11.27042056]
Stock Position:  0.025241142165028034
Bond Position:  [-1.37740775]


portfolio before change:  [1.01369181]
curr_Stock_Price:  94.73706572535563
curr_Factors:  [9.47370657e+01 4.59870243e-02]
mat_Sqrt:  [[ 2.03159710e+01  0.00000000e+00]
 [-8.57783416e-03  1.96542872e-02]]
grads:  [ 0.00142021 -1.25572342]
Stock Position:  0.001420207496029158
Bond Position:  [0.87914552]


portfolio before change:  [1.01301795]
curr_Stock_Price:  94.1852007653119
curr_Factors:  [9.41852008e+01 4.65268367e-02]
mat_Sqrt:  [[ 2.03158235e+01  0.00000000e+00]
 [-8.62803215e-03  1.97693052e-02]]
grads:  [ 8.46443677e-03 -1.04744112e+01]
Stock Position:  0.008464436767780132
Bond Position:  [0.21579327]


portfolio before change:  [1.02290085]
curr_Stock_Price:  95.34959280822164
curr_Factors:  [9.53495928e+01 4.71317958e-02]
mat_Sqrt:  [[ 2.07002617e+01  0.00000000e+00]
 [-8.68394342e-03  1.98974140e-02]]
grads:  [4.97544028e-03 5.21097378e+00]
Stock Position:  0.004975440284828762
Bond Position:  [0.54849464]


portfolio before change:  [1.01478312]
curr_Stock_Price:  93.70425214205481
curr_Factors:  [9.37042521e+01 4.75532111e-02]
mat_Sqrt:  [[ 2.04338040e+01  0.00000000e+00]
 [-8.72267951e-03  1.99861696e-02]]
grads:  [2.50086909e-03 1.28772688e+01]
Stock Position:  0.0025008690944527145
Bond Position:  [0.78044105]


portfolio before change:  [1.01551529]
curr_Stock_Price:  93.95801009382184
curr_Factors:  [9.39580101e+01 4.75802045e-02]
mat_Sqrt:  [[ 2.04949547e+01  0.00000000e+00]
 [-8.72515485e-03  1.99918413e-02]]
grads:  [-0.02017716 -6.78887965]
Stock Position:  -0.0201771575742769
Bond Position:  [2.91132087]


portfolio before change:  [1.04455662]
curr_Stock_Price:  92.5367302979118
curr_Factors:  [9.25367303e+01 5.00618020e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.04455662]
Stock Price:  92.18272822307263
PL:  [1.04455662]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.37919008e+00  3.40708459e-01]
 [ 3.91492498e-01  1.17921567e-01]
 [ 1.10296834e-01 -1.74499967e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.10055464e-02  3.35503083e-01]
 [-2.21607919e-01  3.70582599e-02]
 [ 1.01759811e-01  1.21697477e-02]
 [-9.66273663e-04  3.89016475e-01]
 [-1.12814130e-01 -1.00629728e-01]
 [-3.89631706e-01 -6.14529719e-01]
 [-4.79053475e-02 -1.52478330e-02]
 [-2.13962374e-01 -2.28268323e-01]
 [-1.49848139e-02  1.77379046e-02]
 [ 2.27205080e-02 -1.95127569e-01]
 [-2.10734362e-01 -1.32411483e-01]
 [ 8.34757014e-02 -1.14428494e+00]
 [ 1.13513468e-02 -4.39938708e-01]
 [ 6.82891916e-02 -1.94271318e-01]
 [-9.69682293e-02 -6.97799771e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 8.68595355e-02 -1.08695024e-02]
 [ 2.95604804e-01 -4.44027637e-01]
 [ 2.72735732e-02 -3.42768043e-01]
 [ 1.53238959e-02  1.35447664e-01]
 [ 4.51912479e-01 -4.37984426e-01]
 [-2.42763057e-01  1.53788858e-02]
 [-1.48027330e-01  1.20874815e-01]
 [-4.45950456e-02  8.81160491e-02]
 [-7.27619478e-02  2.09446202e-01]
 [-6.78751423e-01 -4.76919439e-02]
 [-1.58807806e-01 -3.98856616e-02]
 [ 5.58829413e-02 -2.92596621e-02]
 [-2.71253395e-01  8.58128219e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.07125948e-01  8.83928444e-02]
 [-2.08700540e-02 -2.36835019e-01]
 [ 1.47318968e-03 -2.51657007e-02]
 [-5.00348414e-02 -6.81849412e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.10602451]
curr_Stock_Price:  99.77130578477842
curr_Factors:  [9.97713058e+01 3.94080194e-02]
mat_Sqrt:  [[ 1.98060541e+01  0.00000000e+00]
 [-7.94058128e-03  1.81941574e-02]]
grads:  [ 0.07714245 18.72625656]
Stock Position:  0.07714244531128035
Bond Position:  [-6.59057799]


portfolio before change:  [1.12849403]
curr_Stock_Price:  100.07325875764822
curr_Factors:  [1.00073259e+02 4.01200404e-02]
mat_Sqrt:  [[ 2.00446613e+01  0.00000000e+00]
 [-8.01199505e-03  1.83577869e-02]]
grads:  [0.02209854 6.4235176 ]
Stock Position:  0.022098536924329906
Bond Position:  [-1.08297857]


portfolio before change:  [1.13346959]
curr_Stock_Price:  100.30453831665444
curr_Factors:  [1.00304538e+02 4.00298917e-02]
mat_Sqrt:  [[ 2.00684019e+01  0.00000000e+00]
 [-8.00298861e-03  1.83371506e-02]]
grads:  [ 0.00511655 -0.95161986]
Stock Position:  0.0051165524207761265
Bond Position:  [0.62025616]


portfolio before change:  [1.12899687]
curr_Stock_Price:  99.41521869002872
curr_Factors:  [9.94152187e+01 3.96326859e-02]
mat_Sqrt:  [[ 1.97915417e+01  0.00000000e+00]
 [-7.96318387e-03  1.82459464e-02]]
grads:  [-8.23653217e-04 -8.29701068e+00]
Stock Position:  -0.0008236532172824805
Bond Position:  [1.21088054]


portfolio before change:  [1.12980597]
curr_Stock_Price:  98.61666878114372
curr_Factors:  [9.86166688e+01 4.05582135e-02]
mat_Sqrt:  [[ 1.98604798e+01  0.00000000e+00]
 [-8.05562795e-03  1.84577624e-02]]
grads:  [3.29397901e-03 1.81768015e+01]
Stock Position:  0.0032939790096995474
Bond Position:  [0.80496474]


portfolio before change:  [1.13616302]
curr_Stock_Price:  100.51601865441887
curr_Factors:  [1.00516019e+02 4.04300964e-02]
mat_Sqrt:  [[ 2.02109937e+01  0.00000000e+00]
 [-8.04289465e-03  1.84285868e-02]]
grads:  [-0.01016449  2.01091166]
Stock Position:  -0.010164486278463218
Bond Position:  [2.15785671]


portfolio before change:  [1.13645296]
curr_Stock_Price:  100.51403169572883
curr_Factors:  [1.00514032e+02 4.09782404e-02]
mat_Sqrt:  [[ 2.03471387e+01  0.00000000e+00]
 [-8.09723315e-03  1.85530919e-02]]
grads:  [0.00526222 0.65594176]
Stock Position:  0.005262220213521983
Bond Position:  [0.60752599]


portfolio before change:  [1.14010738]
curr_Stock_Price:  101.1940625500849
curr_Factors:  [1.01194063e+02 3.94791219e-02]
mat_Sqrt:  [[ 2.01066063e+01  0.00000000e+00]
 [-7.94774150e-03  1.82105635e-02]]
grads:  [8.39596861e-03 2.13621327e+01]
Stock Position:  0.008395968613977057
Bond Position:  [0.29048521]


portfolio before change:  [1.16014514]
curr_Stock_Price:  103.57633010640274
curr_Factors:  [1.03576330e+02 3.79097023e-02]
mat_Sqrt:  [[ 2.01667403e+01  0.00000000e+00]
 [-7.78816561e-03  1.78449292e-02]]
grads:  [-0.00777183 -5.6391217 ]
Stock Position:  -0.007771833291156531
Bond Position:  [1.96512311]


portfolio before change:  [1.15555035]
curr_Stock_Price:  104.19914860514054
curr_Factors:  [1.04199149e+02 3.64815216e-02]
mat_Sqrt:  [[ 1.99021797e+01  0.00000000e+00]
 [-7.64005462e-03  1.75055643e-02]]
grads:  [-3.30533878e-02 -3.51048220e+01]
Stock Position:  -0.03305338784071718
Bond Position:  [4.59968522]


portfolio before change:  [1.13529028]
curr_Stock_Price:  104.82949466951062
curr_Factors:  [1.04829495e+02 3.79217820e-02]
mat_Sqrt:  [[ 2.04139883e+01  0.00000000e+00]
 [-7.78940634e-03  1.78477721e-02]]
grads:  [-0.00267268 -0.85432697]
Stock Position:  -0.002672679473320082
Bond Position:  [1.41546591]


portfolio before change:  [1.1357051]
curr_Stock_Price:  104.74049007204907
curr_Factors:  [1.04740490e+02 3.91686116e-02]
mat_Sqrt:  [[ 2.07292548e+01  0.00000000e+00]
 [-7.91642461e-03  1.81388075e-02]]
grads:  [ -0.01512774 -12.58452756]
Stock Position:  -0.015127742904454943
Bond Position:  [2.72019231]


portfolio before change:  [1.11477015]
curr_Stock_Price:  106.14684606870641
curr_Factors:  [1.06146846e+02 3.92032468e-02]
mat_Sqrt:  [[ 2.10168736e+01  0.00000000e+00]
 [-7.91992392e-03  1.81468254e-02]]
grads:  [-3.44644866e-04  9.77465988e-01]
Stock Position:  -0.00034464486629420024
Bond Position:  [1.15135312]


portfolio before change:  [1.11520495]
curr_Stock_Price:  105.30288818976301
curr_Factors:  [1.05302888e+02 3.93519563e-02]
mat_Sqrt:  [[ 2.08892788e+01  0.00000000e+00]
 [-7.93493101e-03  1.81812110e-02]]
grads:  [-2.98910007e-03 -1.07323747e+01]
Stock Position:  -0.002989100068942682
Bond Position:  [1.42996582]


portfolio before change:  [1.10971055]
curr_Stock_Price:  107.2008368212595
curr_Factors:  [1.07200837e+02 3.96979171e-02]
mat_Sqrt:  [[ 2.13590551e+01  0.00000000e+00]
 [-7.96973446e-03  1.82609557e-02]]
grads:  [-0.01257188 -7.25107084]
Stock Position:  -0.0125718797093823
Bond Position:  [2.45742657]


portfolio before change:  [1.11064975]
curr_Stock_Price:  107.15056543845874
curr_Factors:  [1.07150565e+02 3.88632631e-02]
mat_Sqrt:  [[ 2.11234134e+01  0.00000000e+00]
 [-7.88550702e-03  1.80679664e-02]]
grads:  [-1.96905292e-02 -6.33322484e+01]
Stock Position:  -0.01969052920077221
Bond Position:  [3.22050109]


portfolio before change:  [1.10433629]
curr_Stock_Price:  107.49164531238333
curr_Factors:  [1.07491645e+02 3.76437526e-02]
mat_Sqrt:  [[ 2.08555269e+01  0.00000000e+00]
 [-7.76079919e-03  1.77822249e-02]]
grads:  [-8.66214735e-03 -2.47403635e+01]
Stock Position:  -0.008662147346050711
Bond Position:  [2.03544476]


portfolio before change:  [1.1003256]
curr_Stock_Price:  107.98403312225663
curr_Factors:  [1.07984033e+02 3.90052967e-02]
mat_Sqrt:  [[ 2.13265859e+01  0.00000000e+00]
 [-7.89990346e-03  1.81009528e-02]]
grads:  [-7.73577293e-04 -1.07326570e+01]
Stock Position:  -0.0007735772929792824
Bond Position:  [1.1838596]


portfolio before change:  [1.10075943]
curr_Stock_Price:  107.6145328347011
curr_Factors:  [1.07614533e+02 3.91900436e-02]
mat_Sqrt:  [[ 2.13038845e+01  0.00000000e+00]
 [-7.91859014e-03  1.81437693e-02]]
grads:  [-0.0059812 -3.8459471]
Stock Position:  -0.005981195980060569
Bond Position:  [1.74442304]


portfolio before change:  [1.10110339]
curr_Stock_Price:  107.59348514814558
curr_Factors:  [1.07593485e+02 3.85091657e-02]
mat_Sqrt:  [[ 2.11138791e+01  0.00000000e+00]
 [-7.84950095e-03  1.79854661e-02]]
grads:  [-2.29522343e-04 -6.06564147e+00]
Stock Position:  -0.00022952234335347512
Bond Position:  [1.1257985]


portfolio before change:  [1.10134588]
curr_Stock_Price:  107.15013001687143
curr_Factors:  [1.07150130e+02 3.97843457e-02]
mat_Sqrt:  [[ 2.13721795e+01  0.00000000e+00]
 [-7.97840543e-03  1.82808234e-02]]
grads:  [ 0.00384218 -0.59458494]
Stock Position:  0.003842176969607364
Bond Position:  [0.68965612]


portfolio before change:  [1.09823285]
curr_Stock_Price:  106.31746579262708
curr_Factors:  [1.06317466e+02 3.98105146e-02]
mat_Sqrt:  [[ 2.12130693e+01  0.00000000e+00]
 [-7.98102896e-03  1.82868347e-02]]
grads:  [ 4.79964754e-03 -2.42812736e+01]
Stock Position:  0.0047996475419173025
Bond Position:  [0.58794649]


portfolio before change:  [1.10087918]
curr_Stock_Price:  106.85351144987224
curr_Factors:  [1.06853511e+02 4.18858143e-02]
mat_Sqrt:  [[ 2.18686654e+01  0.00000000e+00]
 [-8.18640964e-03  1.87574209e-02]]
grads:  [-5.59351305e-03 -1.82737299e+01]
Stock Position:  -0.005593513047741837
Bond Position:  [1.69856569]


portfolio before change:  [1.1015792]
curr_Stock_Price:  106.76632398149796
curr_Factors:  [1.06766324e+02 4.09858332e-02]
mat_Sqrt:  [[ 2.16147976e+01  0.00000000e+00]
 [-8.09798327e-03  1.85548107e-02]]
grads:  [3.44384917e-03 7.29986777e+00]
Stock Position:  0.003443849173086451
Bond Position:  [0.73389208]


portfolio before change:  [1.09758353]
curr_Stock_Price:  105.57945095227765
curr_Factors:  [1.05579451e+02 4.18756262e-02]
mat_Sqrt:  [[ 2.16052878e+01  0.00000000e+00]
 [-8.18541398e-03  1.87551396e-02]]
grads:  [ 1.20692863e-02 -2.33527681e+01]
Stock Position:  0.012069286294826467
Bond Position:  [-0.17668509]


portfolio before change:  [1.08170168]
curr_Stock_Price:  104.265391618437
curr_Factors:  [1.04265392e+02 4.11443054e-02]
mat_Sqrt:  [[ 2.11492537e+01  0.00000000e+00]
 [-8.11362364e-03  1.85906472e-02]]
grads:  [-0.01116121  0.82723778]
Stock Position:  -0.011161205233466986
Bond Position:  [2.24542912]


portfolio before change:  [1.08059923]
curr_Stock_Price:  104.38931633279287
curr_Factors:  [1.04389316e+02 3.97012210e-02]
mat_Sqrt:  [[ 2.07997438e+01  0.00000000e+00]
 [-7.97006610e-03  1.82617156e-02]]
grads:  [-4.58050044e-03  6.61902842e+00]
Stock Position:  -0.00458050044142795
Bond Position:  [1.55875454]


portfolio before change:  [1.08264949]
curr_Stock_Price:  103.98425087489827
curr_Factors:  [1.03984251e+02 4.08011127e-02]
mat_Sqrt:  [[ 2.10040755e+01  0.00000000e+00]
 [-8.07971412e-03  1.85129508e-02]]
grads:  [-2.92231329e-04  4.75969769e+00]
Stock Position:  -0.0002922313290867136
Bond Position:  [1.11303695]


portfolio before change:  [1.08250537]
curr_Stock_Price:  104.95354998630626
curr_Factors:  [1.04953550e+02 4.05865282e-02]
mat_Sqrt:  [[ 2.11440455e+01  0.00000000e+00]
 [-8.05843937e-03  1.84642042e-02]]
grads:  [8.81944233e-04 1.13433647e+01]
Stock Position:  0.0008819442334694393
Bond Position:  [0.98994219]


portfolio before change:  [1.08125316]
curr_Stock_Price:  103.39340427229678
curr_Factors:  [1.03393404e+02 4.17864998e-02]
mat_Sqrt:  [[ 2.11354176e+01  0.00000000e+00]
 [-8.17669858e-03  1.87351701e-02]]
grads:  [-0.03309922 -2.54558371]
Stock Position:  -0.033099222738861116
Bond Position:  [4.50349448]


portfolio before change:  [1.09116856]
curr_Stock_Price:  103.11084704099072
curr_Factors:  [1.03110847e+02 4.23905210e-02]
mat_Sqrt:  [[ 2.12294495e+01  0.00000000e+00]
 [-8.23558338e-03  1.88700921e-02]]
grads:  [-0.00830051 -2.11369724]
Stock Position:  -0.008300513700504832
Bond Position:  [1.94704155]


portfolio before change:  [1.09266508]
curr_Stock_Price:  102.95987727069067
curr_Factors:  [1.02959877e+02 4.12390660e-02]
mat_Sqrt:  [[ 2.09084783e+01  0.00000000e+00]
 [-8.12296163e-03  1.86120433e-02]]
grads:  [ 0.00206199 -1.57208221]
Stock Position:  0.0020619854410544604
Bond Position:  [0.88036331]


portfolio before change:  [1.09275303]
curr_Stock_Price:  102.94916102518744
curr_Factors:  [1.02949161e+02 4.13006270e-02]
mat_Sqrt:  [[ 2.09219006e+01  0.00000000e+00]
 [-8.12902228e-03  1.86259300e-02]]
grads:  [-0.01117497  4.6071698 ]
Stock Position:  -0.01117496989423215
Bond Position:  [2.24320681]


portfolio before change:  [1.09424676]
curr_Stock_Price:  102.8405867987706
curr_Factors:  [1.02840587e+02 3.95019127e-02]
mat_Sqrt:  [[ 2.04396572e+01  0.00000000e+00]
 [-7.95003524e-03  1.82158191e-02]]
grads:  [0.00496443 2.92872149]
Stock Position:  0.004964426290010883
Bond Position:  [0.58370225]


portfolio before change:  [1.08562734]
curr_Stock_Price:  101.08965186247472
curr_Factors:  [1.01089652e+02 3.93181446e-02]
mat_Sqrt:  [[ 2.00448684e+01  0.00000000e+00]
 [-7.93152137e-03  1.81733985e-02]]
grads:  [-0.00472279  4.4749553 ]
Stock Position:  -0.004722785356523556
Bond Position:  [1.56305207]


portfolio before change:  [1.0885697]
curr_Stock_Price:  100.5080114581202
curr_Factors:  [1.00508011e+02 3.87313337e-02]
mat_Sqrt:  [[ 1.97802559e+01  0.00000000e+00]
 [-7.87211115e-03  1.80372726e-02]]
grads:  [-0.00852103  4.90056597]
Stock Position:  -0.008521029683176261
Bond Position:  [1.94500145]


portfolio before change:  [1.08233781]
curr_Stock_Price:  101.26789942543934
curr_Factors:  [1.01267899e+02 4.01233458e-02]
mat_Sqrt:  [[ 2.02847833e+01  0.00000000e+00]
 [-8.01232509e-03  1.83585431e-02]]
grads:  [-6.12445933e-03 -1.29005345e+01]
Stock Position:  -0.0061244593323922505
Bond Position:  [1.70254895]


portfolio before change:  [1.0901784]
curr_Stock_Price:  100.02244247975813
curr_Factors:  [1.00022442e+02 4.03038302e-02]
mat_Sqrt:  [[ 2.00803194e+01  0.00000000e+00]
 [-8.03032554e-03  1.83997873e-02]]
grads:  [-4.73599168e-04 -1.36771693e+00]
Stock Position:  -0.0004735991680732765
Bond Position:  [1.13754894]


portfolio before change:  [1.08962607]
curr_Stock_Price:  101.48894009426132
curr_Factors:  [1.01488940e+02 3.70535188e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.08962607]
Stock Price:  103.43584845364695
PL:  [-2.34622239]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.45933268e+00  3.62029626e-01]
 [ 1.30500407e+00  4.92310925e-02]
 [-2.05048036e-01  2.05910363e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.06161918e-01  7.53718773e-01]
 [ 4.35836435e-02  6.83515052e-03]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.32146263e+00  1.36698561e+00]
 [ 1.80024697e-01  8.13456408e-01]
 [-9.78821699e-02 -4.10549992e-01]
 [ 1.32349489e-01  1.30476572e-02]
 [ 4.26111256e-02 -4.52794442e-02]
 [ 4.71699236e-02  6.05474767e-01]
 [-1.64374462e-01  5.74059696e-01]
 [-1.14895338e-01  4.52965697e-02]
 [ 1.29293414e-01 -1.58959328e-01]
 [ 3.67715941e-02 -7.56944072e-02]
 [ 3.15571927e-01  6.52918780e-02]
 [ 1.60950662e-01  1.69382029e-01]
 [-6.95454050e-01  3.28930403e-01]
 [ 7.24443965e-02  1.15718456e-01]
 [ 1.41331584e+00  1.56346540e-01]
 [ 1.60705337e-02  4.02464682e-01]
 [-1.36758612e-01  1.26219349e-01]
 [-1.96420903e-01  1.44166717e-01]
 [ 2.12434470e-01 -7.39423634e-02]
 [ 1.33264647e-01 -4.49494227e-01]
 [ 1.01611277e-01 -1.40619362e-02]
 [ 5.08118641e-01 -3.01927852e-01]
 [-5.15964636e-01 -2.52345266e-01]
 [ 1.06941261e-01  4.25705584e-02]
 [-8.83770784e-02  1.05071056e-01]
 [ 1.91403787e-01  2.03117621e-01]
 [ 2.68043299e-02 -1.25372422e-02]
 [ 1.09298666e-01 -5.68536346e-02]
 [-1.41699085e-01  1.11232117e-01]
 [-3.05067416e-02 -1.50380680e-01]
 [-6.05512459e-02 -4.71824383e-02]
 [ 1.17286381e-01 -1.28618967e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.96004587]
curr_Stock_Price:  98.74563058509177
curr_Factors:  [9.87456306e+01 4.01832463e-02]
mat_Sqrt:  [[ 1.97943114e+01  0.00000000e+00]
 [-8.01830369e-03  1.83722418e-02]]
grads:  [ 0.08170708 19.70525045]
Stock Position:  0.08170707899481182
Bond Position:  [-14.02826291]


portfolio before change:  [-6.04994856]
curr_Stock_Price:  97.66678834235614
curr_Factors:  [9.76667883e+01 4.07331777e-02]
mat_Sqrt:  [[ 1.97115625e+01  0.00000000e+00]
 [-8.07298484e-03  1.84975321e-02]]
grads:  [0.06729503 2.66149519]
Stock Position:  0.06729503424961998
Bond Position:  [-12.62243842]


portfolio before change:  [-6.13677828]
curr_Stock_Price:  96.3999516756356
curr_Factors:  [9.63999517e+01 3.92678524e-02]
mat_Sqrt:  [[ 1.91027280e+01  0.00000000e+00]
 [-7.92644711e-03  1.81617719e-02]]
grads:  [-6.02957787e-03  1.13375701e+01]
Stock Position:  -0.006029577873418637
Bond Position:  [-5.55552726]


portfolio before change:  [-6.14196105]
curr_Stock_Price:  97.14433031314908
curr_Factors:  [9.71443303e+01 3.87076822e-02]
mat_Sqrt:  [[ 1.91124359e+01  0.00000000e+00]
 [-7.86970721e-03  1.80317645e-02]]
grads:  [-8.52919379e-04 -8.39556287e+00]
Stock Position:  -0.0008529193785653262
Bond Position:  [-6.05910477]


portfolio before change:  [-6.14318449]
curr_Stock_Price:  97.6906942378269
curr_Factors:  [9.76906942e+01 3.73856576e-02]
mat_Sqrt:  [[ 1.88888583e+01  0.00000000e+00]
 [-7.73414844e-03  1.77211603e-02]]
grads:  [1.17946739e-02 4.25321344e+01]
Stock Position:  0.011794673875772835
Bond Position:  [-7.29541437]


portfolio before change:  [-6.16283673]
curr_Stock_Price:  96.10181988976434
curr_Factors:  [9.61018199e+01 3.78860021e-02]
mat_Sqrt:  [[ 1.87055724e+01  0.00000000e+00]
 [-7.78573076e-03  1.78393503e-02]]
grads:  [0.00248946 0.38315019]
Stock Position:  0.0024894585845522646
Bond Position:  [-6.40207823]


portfolio before change:  [-6.1627804]
curr_Stock_Price:  96.44592472506109
curr_Factors:  [9.64459247e+01 3.73614863e-02]
mat_Sqrt:  [[ 1.86421481e+01  0.00000000e+00]
 [-7.73164782e-03  1.77154307e-02]]
grads:  [0.00693985 5.42673158]
Stock Position:  0.0069398535298820984
Bond Position:  [-6.832101]


portfolio before change:  [-6.17740525]
curr_Stock_Price:  94.46162014065831
curr_Factors:  [9.44616201e+01 3.90843911e-02]
mat_Sqrt:  [[ 1.86748475e+01  0.00000000e+00]
 [-7.90790906e-03  1.81192959e-02]]
grads:  [ 0.10270842 75.44363816]
Stock Position:  0.10270841867512862
Bond Position:  [-15.87940888]


portfolio before change:  [-6.35757993]
curr_Stock_Price:  92.72671239904582
curr_Factors:  [9.27267124e+01 3.88776267e-02]
mat_Sqrt:  [[ 1.82833063e+01  0.00000000e+00]
 [-7.88696410e-03  1.80713050e-02]]
grads:  [2.92641916e-02 4.50137058e+01]
Stock Position:  0.029264191617846397
Bond Position:  [-9.07115221]


portfolio before change:  [-6.35520462]
curr_Stock_Price:  92.84662955968294
curr_Factors:  [9.28466296e+01 4.00889337e-02]
mat_Sqrt:  [[ 1.85899574e+01  0.00000000e+00]
 [-8.00888843e-03  1.83506687e-02]]
grads:  [-1.49037929e-02 -2.23724813e+01]
Stock Position:  -0.014903792935084675
Bond Position:  [-4.97143768]


portfolio before change:  [-6.35196348]
curr_Stock_Price:  92.58745983194963
curr_Factors:  [9.25874598e+01 3.97713515e-02]
mat_Sqrt:  [[ 1.84644912e+01  0.00000000e+00]
 [-7.97710238e-03  1.82778378e-02]]
grads:  [0.00747619 0.71385124]
Stock Position:  0.007476185098672348
Bond Position:  [-7.04416446]


portfolio before change:  [-6.36048367]
curr_Stock_Price:  91.56559935162244
curr_Factors:  [9.15655994e+01 4.19849103e-02]
mat_Sqrt:  [[ 1.87619925e+01  0.00000000e+00]
 [-8.19608788e-03  1.87795966e-02]]
grads:  [ 1.21786405e-03 -2.41109781e+00]
Stock Position:  0.001217864045286115
Bond Position:  [-6.47199812]


portfolio before change:  [-6.36196932]
curr_Stock_Price:  91.01003798951503
curr_Factors:  [9.10100380e+01 4.23226635e-02]
mat_Sqrt:  [[ 1.87230153e+01  0.00000000e+00]
 [-8.22898910e-03  1.88549827e-02]]
grads:  [1.66330461e-02 3.21121889e+01]
Stock Position:  0.01663304610432336
Bond Position:  [-7.87574348]


portfolio before change:  [-6.34823213]
curr_Stock_Price:  91.8951263708137
curr_Factors:  [9.18951264e+01 4.11859679e-02]
mat_Sqrt:  [[ 1.86494968e+01  0.00000000e+00]
 [-8.11773051e-03  1.86000573e-02]]
grads:  [4.62027104e-03 3.08633295e+01]
Stock Position:  0.004620271038525408
Bond Position:  [-6.77281252]


portfolio before change:  [-6.35241737]
curr_Stock_Price:  91.17253080645729
curr_Factors:  [9.11725308e+01 4.31014671e-02]
mat_Sqrt:  [[ 1.89282314e+01  0.00000000e+00]
 [-8.30435713e-03  1.90276726e-02]]
grads:  [-0.00502563  2.38056281]
Stock Position:  -0.005025630326667602
Bond Position:  [-5.89421794]


portfolio before change:  [-6.35401273]
curr_Stock_Price:  91.34336184057288
curr_Factors:  [9.13433618e+01 4.28134539e-02]
mat_Sqrt:  [[ 1.89002315e+01  0.00000000e+00]
 [-8.27656488e-03  1.89639925e-02]]
grads:  [ 3.17021914e-03 -8.38216570e+00]
Stock Position:  0.0031702191405417637
Bond Position:  [-6.64359121]


portfolio before change:  [-6.35114828]
curr_Stock_Price:  92.50888063957714
curr_Factors:  [9.25088806e+01 4.08026430e-02]
mat_Sqrt:  [[ 1.86864832e+01  0.00000000e+00]
 [-8.07986564e-03  1.85132980e-02]]
grads:  [ 1.99922391e-04 -4.08865062e+00]
Stock Position:  0.0001999223912143601
Bond Position:  [-6.36964288]


portfolio before change:  [-6.35171445]
curr_Stock_Price:  93.65978888637603
curr_Factors:  [9.36597889e+01 3.95427273e-02]
mat_Sqrt:  [[ 1.86245798e+01  0.00000000e+00]
 [-7.95414129e-03  1.82252273e-02]]
grads:  [0.01847385 3.58250007]
Stock Position:  0.018473847002590423
Bond Position:  [-8.08197106]


portfolio before change:  [-6.33013798]
curr_Stock_Price:  94.88242387422184
curr_Factors:  [9.48824239e+01 4.01237762e-02]
mat_Sqrt:  [[ 1.90058226e+01  0.00000000e+00]
 [-8.01236806e-03  1.83586416e-02]]
grads:  [0.01235806 9.22628333]
Stock Position:  0.012358057087028047
Bond Position:  [-7.50270039]


portfolio before change:  [-6.3507091]
curr_Stock_Price:  93.29372617296185
curr_Factors:  [9.32937262e+01 4.16384863e-02]
mat_Sqrt:  [[ 1.90370612e+01  0.00000000e+00]
 [-8.16220424e-03  1.87019594e-02]]
grads:  [-0.02899066 17.58801826]
Stock Position:  -0.02899066444891347
Bond Position:  [-3.64606199]


portfolio before change:  [-6.38520639]
curr_Stock_Price:  94.4679492670171
curr_Factors:  [9.44679493e+01 4.04143241e-02]
mat_Sqrt:  [[ 1.89911886e+01  0.00000000e+00]
 [-8.04132567e-03  1.84249918e-02]]
grads:  [0.00647395 6.28051599]
Stock Position:  0.006473953436049826
Bond Position:  [-6.99678749]


portfolio before change:  [-6.37719139]
curr_Stock_Price:  95.84109035795937
curr_Factors:  [9.58410904e+01 3.92769740e-02]
mat_Sqrt:  [[ 1.89941891e+01  0.00000000e+00]
 [-7.92736768e-03  1.81638812e-02]]
grads:  [0.07800023 8.60755132]
Stock Position:  0.07800022757076833
Bond Position:  [-13.85281825]


portfolio before change:  [-6.36687128]
curr_Stock_Price:  95.99560045241935
curr_Factors:  [9.59956005e+01 3.95710578e-02]
mat_Sqrt:  [[ 1.90959012e+01  0.00000000e+00]
 [-7.95699016e-03  1.82317549e-02]]
grads:  [1.00398782e-02 2.20749283e+01]
Stock Position:  0.010039878151402535
Bond Position:  [-7.33065541]


portfolio before change:  [-6.3675349]
curr_Stock_Price:  96.02077670385316
curr_Factors:  [9.60207767e+01 3.98955497e-02]
mat_Sqrt:  [[ 1.91790655e+01  0.00000000e+00]
 [-7.98954815e-03  1.83063546e-02]]
grads:  [-4.25839166e-03  6.89483797e+00]
Stock Position:  -0.00425839166297635
Bond Position:  [-5.95864083]


portfolio before change:  [-6.36643467]
curr_Stock_Price:  95.58748869559207
curr_Factors:  [9.55874887e+01 4.00364967e-02]
mat_Sqrt:  [[ 1.91262173e+01  0.00000000e+00]
 [-8.00364884e-03  1.83386633e-02]]
grads:  [-6.98002051e-03  7.86135362e+00]
Stock Position:  -0.006980020511159162
Bond Position:  [-5.69923204]


portfolio before change:  [-6.36163493]
curr_Stock_Price:  94.79777975981493
curr_Factors:  [9.47977798e+01 4.05478264e-02]
mat_Sqrt:  [[ 1.90889462e+01  0.00000000e+00]
 [-8.05459634e-03  1.84553987e-02]]
grads:  [ 0.0094381  -4.00654381]
Stock Position:  0.009438099638048312
Bond Position:  [-7.25634582]


portfolio before change:  [-6.37312365]
curr_Stock_Price:  93.67661992943144
curr_Factors:  [9.36766199e+01 4.05056456e-02]
mat_Sqrt:  [[ 1.88533700e+01  0.00000000e+00]
 [-8.05040576e-03  1.84457969e-02]]
grads:  [-3.33684196e-03 -2.43683821e+01]
Stock Position:  -0.003336841962802419
Bond Position:  [-6.06053957]


portfolio before change:  [-6.37301707]
curr_Stock_Price:  93.41763343810555
curr_Factors:  [9.34176334e+01 4.15938665e-02]
mat_Sqrt:  [[ 1.90521287e+01  0.00000000e+00]
 [-8.15782976e-03  1.86919362e-02]]
grads:  [ 0.00501121 -0.75229961]
Stock Position:  0.0050112061531083505
Bond Position:  [-6.84115209]


portfolio before change:  [-6.36896206]
curr_Stock_Price:  94.39747861447715
curr_Factors:  [9.43974786e+01 4.15233250e-02]
mat_Sqrt:  [[ 1.92356318e+01  0.00000000e+00]
 [-8.15090916e-03  1.86760791e-02]]
grads:  [  0.01956507 -16.16655457]
Stock Position:  0.019565072094247092
Bond Position:  [-8.21585553]


portfolio before change:  [-6.35638884]
curr_Stock_Price:  95.09260850782726
curr_Factors:  [9.50926085e+01 4.12618863e-02]
mat_Sqrt:  [[ 1.93161825e+01  0.00000000e+00]
 [-8.12520880e-03  1.86171922e-02]]
grads:  [ -0.03241309 -13.55442131]
Stock Position:  -0.03241308884693038
Bond Position:  [-3.27414367]


portfolio before change:  [-6.35440728]
curr_Stock_Price:  95.01884659071652
curr_Factors:  [9.50188466e+01 4.32243102e-02]
mat_Sqrt:  [[ 1.97548524e+01  0.00000000e+00]
 [-8.31618279e-03  1.90547686e-02]]
grads:  [0.00635391 2.23411574]
Stock Position:  0.006353911112321969
Bond Position:  [-6.95814859]


portfolio before change:  [-6.35458092]
curr_Stock_Price:  95.12841373513932
curr_Factors:  [9.51284137e+01 4.39253160e-02]
mat_Sqrt:  [[ 1.99373624e+01  0.00000000e+00]
 [-8.38334692e-03  1.92086609e-02]]
grads:  [-2.13269486e-03  5.46998335e+00]
Stock Position:  -0.002132694861146331
Bond Position:  [-6.15170105]


portfolio before change:  [-6.35776071]
curr_Stock_Price:  96.25880481843379
curr_Factors:  [9.62588048e+01 4.28598066e-02]
mat_Sqrt:  [[ 1.99280851e+01  0.00000000e+00]
 [-8.28104405e-03  1.89742556e-02]]
grads:  [ 0.01405311 10.70490594]
Stock Position:  0.0140531106445652
Bond Position:  [-7.71049635]


portfolio before change:  [-6.36501373]
curr_Stock_Price:  95.81127803969937
curr_Factors:  [9.5811278e+01 4.2421053e-02]
mat_Sqrt:  [[ 1.97336470e+01  0.00000000e+00]
 [-8.23854871e-03  1.88768865e-02]]
grads:  [ 0.00108103 -0.66415837]
Stock Position:  0.0010810281924649298
Bond Position:  [-6.46858842]


portfolio before change:  [-6.3644313]
curr_Stock_Price:  97.0980679480512
curr_Factors:  [9.70980679e+01 4.20984519e-02]
mat_Sqrt:  [[ 1.99224915e+01  0.00000000e+00]
 [-8.20716291e-03  1.88049726e-02]]
grads:  [ 0.00424072 -3.02332982]
Stock Position:  0.004240719867625388
Bond Position:  [-6.776197]


portfolio before change:  [-6.35737832]
curr_Stock_Price:  98.96097142743825
curr_Factors:  [9.89609714e+01 4.33648003e-02]
mat_Sqrt:  [[ 2.06078472e+01  0.00000000e+00]
 [-8.32968670e-03  1.90857099e-02]]
grads:  [-4.52028826e-03  5.82803141e+00]
Stock Position:  -0.004520288261708463
Bond Position:  [-5.91004621]


portfolio before change:  [-6.36046852]
curr_Stock_Price:  99.48115917198685
curr_Factors:  [9.94811592e+01 4.32594759e-02]
mat_Sqrt:  [[ 2.06909992e+01  0.00000000e+00]
 [-8.31956498e-03  1.90625181e-02]]
grads:  [-4.64638031e-03 -7.88881507e+00]
Stock Position:  -0.0046463803080529316
Bond Position:  [-5.89824123]


portfolio before change:  [-6.36044732]
curr_Stock_Price:  99.31790625730521
curr_Factors:  [9.93179063e+01 4.25813226e-02]
mat_Sqrt:  [[ 2.04944906e+01  0.00000000e+00]
 [-8.25409693e-03  1.89125120e-02]]
grads:  [-0.00395928 -2.49477374]
Stock Position:  -0.003959276260181024
Bond Position:  [-5.96722029]


portfolio before change:  [-6.35785024]
curr_Stock_Price:  98.4735543230133
curr_Factors:  [9.84735543e+01 4.09376135e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.35785024]
Stock Price:  100.01475608092028
PL:  [-6.37260632]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.31654568e+00  3.26545816e-01]
 [ 3.05955049e-01  1.09248879e-01]
 [ 1.11808262e-01 -3.70744019e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.24933957e-02  1.62337379e-01]
 [-1.53992287e-01 -3.59016406e-02]
 [ 8.74459810e-02  9.60914132e-02]
 [ 5.79107078e-01  6.17016917e-01]
 [-3.54842359e-02  2.34763310e-01]
 [ 1.80946541e-01  4.32675260e-02]
 [-9.47546760e-02 -6.48832192e-03]
 [-7.23526422e-04 -1.36180555e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 2.32390734e-02 -1.99912891e-01]
 [ 7.92168248e-02  2.60198364e-02]
 [ 1.23448204e-01 -6.15946627e-01]
 [ 2.54215770e-02 -1.75367622e-01]
 [ 3.51499293e-02 -1.56927974e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.39326800e-01 -2.79016834e-02]
 [ 3.68395932e-01 -3.67366584e-01]
 [ 2.71904771e-02 -3.37462823e-01]
 [-1.06289669e-02  2.57365427e-01]
 [ 5.22897962e-01 -6.66448636e-01]
 [-8.44892965e-01  1.34907396e-01]
 [-2.15897168e-01  2.63949713e-01]
 [-1.32178119e-01 -3.54703728e-01]
 [-7.35205789e-02  2.45156005e-01]
 [-5.09227178e-01  6.78213207e-01]
 [-1.14298091e-01  3.74961571e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.19710491e-01 -6.54529181e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.72514689e-01 -4.52584448e-02]
 [-3.02908360e-02 -1.50829543e-01]
 [-9.30441652e-03 -6.46811572e-02]
 [ 1.87548594e-01 -1.45352647e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.01421102]
curr_Stock_Price:  100.04828853108609
curr_Factors:  [1.00048289e+02 4.06804499e-02]
mat_Sqrt:  [[ 2.01791346e+01  0.00000000e+00]
 [-8.06775804e-03  1.84855560e-02]]
grads:  [ 0.07230548 17.66491721]
Stock Position:  0.07230547728265471
Bond Position:  [-4.21982823]


portfolio before change:  [3.03434899]
curr_Stock_Price:  100.33409649271526
curr_Factors:  [1.00334096e+02 4.06796497e-02]
mat_Sqrt:  [[ 2.02365813e+01  0.00000000e+00]
 [-8.06767869e-03  1.84853741e-02]]
grads:  [0.01747504 5.91001718]
Stock Position:  0.017475044982849016
Bond Position:  [1.28100614]


portfolio before change:  [3.02564787]
curr_Stock_Price:  99.82701584002241
curr_Factors:  [9.98270158e+01 4.05798098e-02]
mat_Sqrt:  [[ 2.01095843e+01  0.00000000e+00]
 [-8.05777238e-03  1.84626759e-02]]
grads:  [ 0.00475533 -2.00807305]
Stock Position:  0.004755327879456008
Bond Position:  [2.55093768]


portfolio before change:  [3.03130825]
curr_Stock_Price:  100.95028006887487
curr_Factors:  [1.0095028e+02 3.9704050e-02]
mat_Sqrt:  [[ 2.01152268e+01  0.00000000e+00]
 [-7.97035006e-03  1.82623662e-02]]
grads:  [-8.10399363e-04 -8.28955079e+00]
Stock Position:  -0.000810399362873846
Bond Position:  [3.11311829]


portfolio before change:  [3.03255193]
curr_Stock_Price:  99.8958330180422
curr_Factors:  [9.98958330e+01 3.87306903e-02]
mat_Sqrt:  [[ 1.96596142e+01  0.00000000e+00]
 [-7.87204576e-03  1.80371228e-02]]
grads:  [-5.92257544e-04  9.00018153e+00]
Stock Position:  -0.0005922575440331512
Bond Position:  [3.09171599]


portfolio before change:  [3.0329913]
curr_Stock_Price:  99.80654678699626
curr_Factors:  [9.98065468e+01 3.84609555e-02]
mat_Sqrt:  [[ 1.95735259e+01  0.00000000e+00]
 [-7.84458595e-03  1.79742045e-02]]
grads:  [-0.00866788 -1.99739803]
Stock Position:  -0.008667883789397144
Bond Position:  [3.89810285]


portfolio before change:  [3.04056175]
curr_Stock_Price:  98.98937436620011
curr_Factors:  [9.89893744e+01 3.73710600e-02]
mat_Sqrt:  [[ 1.91362258e+01  0.00000000e+00]
 [-7.73263836e-03  1.77177003e-02]]
grads:  [0.00676119 5.42346984]
Stock Position:  0.00676119277358762
Bond Position:  [2.37127551]


portfolio before change:  [3.04243829]
curr_Stock_Price:  99.22307687507886
curr_Factors:  [9.92230769e+01 3.76535485e-02]
mat_Sqrt:  [[ 1.92537641e+01  0.00000000e+00]
 [-7.76180892e-03  1.77845384e-02]]
grads:  [ 0.04406387 34.69400787]
Stock Position:  0.04406386900177101
Bond Position:  [-1.32971437]


portfolio before change:  [3.03085411]
curr_Stock_Price:  98.96395409285064
curr_Factors:  [9.89639541e+01 3.64559770e-02]
mat_Sqrt:  [[ 1.88956315e+01  0.00000000e+00]
 [-7.63737934e-03  1.74994345e-02]]
grads:  [3.54446331e-03 1.34154798e+01]
Stock Position:  0.0035444633113311938
Bond Position:  [2.68008001]


portfolio before change:  [3.03474219]
curr_Stock_Price:  99.96637488017024
curr_Factors:  [9.99663749e+01 3.59082877e-02]
mat_Sqrt:  [[ 1.89431104e+01  0.00000000e+00]
 [-7.57979289e-03  1.73674873e-02]]
grads:  [0.01054896 2.49129452]
Stock Position:  0.010548955963829435
Bond Position:  [1.9802013]


portfolio before change:  [3.0392187]
curr_Stock_Price:  100.36726541712929
curr_Factors:  [1.00367265e+02 3.75759640e-02]
mat_Sqrt:  [[ 1.94557133e+01  0.00000000e+00]
 [-7.75380825e-03  1.77662066e-02]]
grads:  [-0.00501582 -0.36520581]
Stock Position:  -0.005015822883714742
Bond Position:  [3.54264313]


portfolio before change:  [3.036038]
curr_Stock_Price:  101.08969040295207
curr_Factors:  [1.01089690e+02 3.63807336e-02]
mat_Sqrt:  [[ 1.92815788e+01  0.00000000e+00]
 [-7.62949368e-03  1.74813661e-02]]
grads:  [-3.11995163e-03 -7.79004079e+00]
Stock Position:  -0.003119951632918341
Bond Position:  [3.35143295]


portfolio before change:  [3.03249142]
curr_Stock_Price:  102.36071733709905
curr_Factors:  [1.02360717e+02 3.55186241e-02]
mat_Sqrt:  [[ 1.92912952e+01  0.00000000e+00]
 [-7.53855414e-03  1.72729975e-02]]
grads:  [-0.00339581 -1.03572081]
Stock Position:  -0.0033958072910394853
Bond Position:  [3.38008869]


portfolio before change:  [3.02870253]
curr_Stock_Price:  103.60089999417654
curr_Factors:  [1.03600900e+02 3.59879571e-02]
mat_Sqrt:  [[ 1.96536006e+01  0.00000000e+00]
 [-7.58819684e-03  1.73867432e-02]]
grads:  [-3.25691289e-03 -1.14980067e+01]
Stock Position:  -0.003256912892224262
Bond Position:  [3.36612164]


portfolio before change:  [3.02910521]
curr_Stock_Price:  103.6064626396176
curr_Factors:  [1.03606463e+02 3.66294926e-02]
mat_Sqrt:  [[ 1.98290678e+01  0.00000000e+00]
 [-7.65553318e-03  1.75410301e-02]]
grads:  [0.00456768 1.48336992]
Stock Position:  0.004567678789856463
Bond Position:  [2.55586417]


portfolio before change:  [3.025782]
curr_Stock_Price:  102.80896488775133
curr_Factors:  [1.02808965e+02 3.73370893e-02]
mat_Sqrt:  [[ 1.98655785e+01  0.00000000e+00]
 [-7.72912303e-03  1.77096457e-02]]
grads:  [-7.31783087e-03 -3.47802908e+01]
Stock Position:  -0.0073178308706538225
Bond Position:  [3.77812061]


portfolio before change:  [3.02341076]
curr_Stock_Price:  103.19754073315198
curr_Factors:  [1.03197541e+02 3.88570193e-02]
mat_Sqrt:  [[ 2.03424890e+01  0.00000000e+00]
 [-7.88487355e-03  1.80665149e-02]]
grads:  [-2.51272732e-03 -9.70677644e+00]
Stock Position:  -0.0025127273200209297
Bond Position:  [3.28271804]


portfolio before change:  [3.0223454]
curr_Stock_Price:  103.78484098645586
curr_Factors:  [1.03784841e+02 3.83127571e-02]
mat_Sqrt:  [[ 2.03144761e+01  0.00000000e+00]
 [-7.82945792e-03  1.79395418e-02]]
grads:  [-1.64114760e-03 -8.74760215e+00]
Stock Position:  -0.0016411475969886733
Bond Position:  [3.19267164]


portfolio before change:  [3.02364809]
curr_Stock_Price:  103.23426281991767
curr_Factors:  [1.03234263e+02 4.04606001e-02]
mat_Sqrt:  [[ 2.07653866e+01  0.00000000e+00]
 [-8.04592818e-03  1.84355375e-02]]
grads:  [-1.53511779e-02 -2.54555988e+01]
Stock Position:  -0.01535117793410879
Bond Position:  [4.60841563]


portfolio before change:  [3.01734894]
curr_Stock_Price:  103.68212661114035
curr_Factors:  [1.03682127e+02 4.00291904e-02]
mat_Sqrt:  [[ 2.07439903e+01  0.00000000e+00]
 [-8.00291851e-03  1.83369899e-02]]
grads:  [-2.33614987e-04 -5.94936190e+00]
Stock Position:  -0.0002336149867065495
Bond Position:  [3.04157064]


portfolio before change:  [3.01773997]
curr_Stock_Price:  103.63587650436922
curr_Factors:  [1.03635877e+02 3.94770242e-02]
mat_Sqrt:  [[ 2.05912318e+01  0.00000000e+00]
 [-7.94753035e-03  1.82100797e-02]]
grads:  [ 0.00617493 -1.53221094]
Stock Position:  0.006174934432716527
Bond Position:  [2.37779522]


portfolio before change:  [3.02112706]
curr_Stock_Price:  104.13626293950985
curr_Factors:  [1.04136263e+02 4.07171996e-02]
mat_Sqrt:  [[ 2.10131393e+01  0.00000000e+00]
 [-8.07140132e-03  1.84939038e-02]]
grads:  [ 9.90161478e-03 -1.98641990e+01]
Stock Position:  0.009901614775546734
Bond Position:  [1.9900099]


portfolio before change:  [3.03951352]
curr_Stock_Price:  105.96805385380995
curr_Factors:  [1.05968054e+02 4.00738916e-02]
mat_Sqrt:  [[ 2.12131771e+01  0.00000000e+00]
 [-8.00738575e-03  1.83472257e-02]]
grads:  [-5.66112153e-03 -1.83931254e+01]
Stock Position:  -0.005661121525423564
Bond Position:  [3.63941155]


portfolio before change:  [3.01813642]
curr_Stock_Price:  109.82454268482415
curr_Factors:  [1.09824543e+02 3.74753447e-02]
mat_Sqrt:  [[ 2.12604387e+01  0.00000000e+00]
 [-7.74341988e-03  1.77424039e-02]]
grads:  [4.78327448e-03 1.45056684e+01]
Stock Position:  0.004783274484557189
Bond Position:  [2.49281549]


portfolio before change:  [3.02213934]
curr_Stock_Price:  110.59625257346761
curr_Factors:  [1.10596253e+02 3.81298356e-02]
mat_Sqrt:  [[ 2.15959781e+01  0.00000000e+00]
 [-7.81074497e-03  1.78966650e-02]]
grads:  [ 1.07444049e-02 -3.72387054e+01]
Stock Position:  0.01074440486210528
Bond Position:  [1.83384843]


portfolio before change:  [3.01835906]
curr_Stock_Price:  110.22307952378526
curr_Factors:  [1.10223080e+02 3.77921126e-02]
mat_Sqrt:  [[ 2.14275800e+01  0.00000000e+00]
 [-7.77607742e-03  1.78172317e-02]]
grads:  [-0.03668238  7.57173722]
Stock Position:  -0.03668237615336374
Bond Position:  [7.06160353]


portfolio before change:  [2.98138608]
curr_Stock_Price:  111.2550667240968
curr_Factors:  [1.11255067e+02 3.79608491e-02]
mat_Sqrt:  [[ 2.16764300e+01  0.00000000e+00]
 [-7.79341764e-03  1.78569631e-02]]
grads:  [-4.64560212e-03  1.47813327e+01]
Stock Position:  -0.004645602124421488
Bond Position:  [3.49823285]


portfolio before change:  [2.98966396]
curr_Stock_Price:  109.5673256242612
curr_Factors:  [1.09567326e+02 3.86385712e-02]
mat_Sqrt:  [[ 2.15373165e+01  0.00000000e+00]
 [-7.86267855e-03  1.80156598e-02]]
grads:  [-1.33249431e-02 -1.96886338e+01]
Stock Position:  -0.013324943108151252
Bond Position:  [4.44964234]


portfolio before change:  [2.99331561]
curr_Stock_Price:  109.33502350112684
curr_Factors:  [1.09335024e+02 3.90356537e-02]
mat_Sqrt:  [[ 2.16018045e+01  0.00000000e+00]
 [-7.90297703e-03  1.81079952e-02]]
grads:  [1.54960542e-03 1.35385503e+01]
Stock Position:  0.0015496054209276767
Bond Position:  [2.82388946]


portfolio before change:  [2.99154883]
curr_Stock_Price:  107.96706754358009
curr_Factors:  [1.07967068e+02 3.88482001e-02]
mat_Sqrt:  [[ 2.12802515e+01  0.00000000e+00]
 [-7.88397870e-03  1.80644646e-02]]
grads:  [-1.00201197e-02  3.75440525e+01]
Stock Position:  -0.010020119719177116
Bond Position:  [4.07339177]


portfolio before change:  [2.99662054]
curr_Stock_Price:  107.51173302154778
curr_Factors:  [1.07511733e+02 3.88406816e-02]
mat_Sqrt:  [[ 2.11884547e+01  0.00000000e+00]
 [-7.88321574e-03  1.80627164e-02]]
grads:  [-0.00462202  2.07588694]
Stock Position:  -0.004622018346071831
Bond Position:  [3.49354174]


portfolio before change:  [2.99632611]
curr_Stock_Price:  107.66992100871306
curr_Factors:  [1.07669921e+02 3.84390211e-02]
mat_Sqrt:  [[ 2.11096267e+01  0.00000000e+00]
 [-7.84234874e-03  1.79690784e-02]]
grads:  [ 0.00343647 -0.6648749 ]
Stock Position:  0.0034364698953136337
Bond Position:  [2.62632167]


portfolio before change:  [2.99260502]
curr_Stock_Price:  106.49155909169741
curr_Factors:  [1.06491559e+02 3.75350503e-02]
mat_Sqrt:  [[ 2.06316369e+01  0.00000000e+00]
 [-7.74958582e-03  1.77565318e-02]]
grads:  [-0.01203378 -3.68613188]
Stock Position:  -0.01203377546831892
Bond Position:  [4.27410053]


portfolio before change:  [2.9881884]
curr_Stock_Price:  106.90297708068351
curr_Factors:  [1.06902977e+02 3.74730967e-02]
mat_Sqrt:  [[ 2.06942452e+01  0.00000000e+00]
 [-7.74318763e-03  1.77418717e-02]]
grads:  [0.00490335 3.00695787]
Stock Position:  0.0049033521393159136
Bond Position:  [2.46400546]


portfolio before change:  [2.98957143]
curr_Stock_Price:  107.12221772335971
curr_Factors:  [1.07122218e+02 3.73924539e-02]
mat_Sqrt:  [[ 2.07143609e+01  0.00000000e+00]
 [-7.73485140e-03  1.77227710e-02]]
grads:  [-4.57014393e-03  4.58873762e+00]
Stock Position:  -0.004570143934102646
Bond Position:  [3.47913539]


portfolio before change:  [2.99408393]
curr_Stock_Price:  106.22999660217086
curr_Factors:  [1.06229997e+02 3.86481430e-02]
mat_Sqrt:  [[ 2.08838942e+01  0.00000000e+00]
 [-7.86365238e-03  1.80178911e-02]]
grads:  [-0.01878324 -2.51186137]
Stock Position:  -0.018783235081025446
Bond Position:  [4.98942693]


portfolio before change:  [2.98357705]
curr_Stock_Price:  106.822578140929
curr_Factors:  [1.06822578e+02 3.84807152e-02]
mat_Sqrt:  [[ 2.09548532e+01  0.00000000e+00]
 [-7.84660081e-03  1.79788211e-02]]
grads:  [-4.58692048e-03 -8.38928996e+00]
Stock Position:  -0.004586920484492712
Bond Position:  [3.47356372]


portfolio before change:  [2.98979879]
curr_Stock_Price:  105.56083392694532
curr_Factors:  [1.05560834e+02 3.83509410e-02]
mat_Sqrt:  [[ 2.06723964e+01  0.00000000e+00]
 [-7.83335851e-03  1.79484792e-02]]
grads:  [-1.81563797e-03 -3.60371241e+00]
Stock Position:  -0.001815637966789045
Bond Position:  [3.18145905]


portfolio before change:  [2.98907691]
curr_Stock_Price:  106.17747021057986
curr_Factors:  [1.06177470e+02 3.92399824e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.98907691]
Stock Price:  105.5224681845176
PL:  [-2.53339127]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.36123588e+00  3.36649375e-01]
 [ 6.85214277e-01  1.08153580e-01]
 [ 1.10073064e-01 -1.72817943e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.16105477e-01 -3.28781620e-01]
 [-3.61217980e-01  1.93103582e-01]
 [ 1.19362695e-01 -4.07412597e-02]
 [-6.35430321e-01  1.30997283e-01]
 [-1.16823298e-01 -1.05196116e-01]
 [-4.06325854e-01 -6.28867395e-01]
 [-6.96777400e-02 -1.26195544e-02]
 [-3.37014351e-02 -1.34352452e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.77911195e-02 -4.16796782e-02]
 [ 2.94957770e-01  1.74340299e-01]
 [ 1.31796744e-01 -2.19528774e-01]
 [ 3.87900764e-02  2.76581114e-02]
 [ 3.14734062e-02 -1.52919350e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-4.59155089e-02 -5.71755696e-02]
 [ 1.69374715e-01 -3.87141966e-02]
 [ 6.45424139e-01 -1.32004055e-01]
 [ 2.46393189e-02 -1.20037732e-01]
 [-3.61905898e-03  3.27720741e-02]
 [-9.39679899e-02  6.48748234e-02]
 [ 1.25898311e-01 -1.04828563e-01]
 [-1.71383789e-01 -4.17473503e-01]
 [ 4.79597672e-02  1.00148017e-01]
 [ 5.98681599e-03  1.72717009e-01]
 [-5.06042547e-01 -1.09530942e-01]
 [-1.67037144e-01 -6.21444901e-02]
 [ 1.19813920e-02 -6.61794323e-02]
 [-2.53690143e-01  1.35004182e-01]
 [ 1.61254706e-02  1.81078463e-02]
 [-6.45179411e-02  7.77271089e-02]
 [-1.85416596e-01  9.98918040e-02]
 [-2.81451694e-02 -1.71379675e-01]
 [ 1.40926707e-02 -3.38621981e-02]
 [-5.86246416e-02 -4.75134045e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.63123632]
curr_Stock_Price:  99.84754288668653
curr_Factors:  [9.98475429e+01 3.88727179e-02]
mat_Sqrt:  [[ 1.96861067e+01  0.00000000e+00]
 [-7.88646617e-03  1.80701641e-02]]
grads:  [ 0.07661046 18.63012273]
Stock Position:  0.0766104612241456
Bond Position:  [-6.01812999]


portfolio before change:  [1.59674637]
curr_Stock_Price:  99.40716384543826
curr_Factors:  [9.94071638e+01 3.98733583e-02]
mat_Sqrt:  [[ 1.98499351e+01  0.00000000e+00]
 [-7.98732579e-03  1.83012625e-02]]
grads:  [0.03689767 5.909624  ]
Stock Position:  0.036897670755748735
Bond Position:  [-2.07114644]


portfolio before change:  [1.62275478]
curr_Stock_Price:  100.11906035421045
curr_Factors:  [1.00119060e+02 3.76906175e-02]
mat_Sqrt:  [[ 1.94371860e+01  0.00000000e+00]
 [-7.76562862e-03  1.77932905e-02]]
grads:  [ 0.00527498 -0.97125342]
Stock Position:  0.00527497502271039
Bond Position:  [1.09462924]


portfolio before change:  [1.62573304]
curr_Stock_Price:  100.65772134694102
curr_Factors:  [1.00657721e+02 3.78554043e-02]
mat_Sqrt:  [[ 1.95844347e+01  0.00000000e+00]
 [-7.78258613e-03  1.78321450e-02]]
grads:  [-8.32363417e-04 -8.48954583e+00]
Stock Position:  -0.0008323634174179167
Bond Position:  [1.70951685]


portfolio before change:  [1.62494522]
curr_Stock_Price:  101.86094631077918
curr_Factors:  [1.01860946e+02 3.67372798e-02]
mat_Sqrt:  [[ 1.95236586e+01  0.00000000e+00]
 [-7.66678862e-03  1.75668196e-02]]
grads:  [-1.32965622e-02 -1.87160584e+01]
Stock Position:  -0.013296562173542715
Bond Position:  [2.97934563]


portfolio before change:  [1.62343851]
curr_Stock_Price:  102.00227307306642
curr_Factors:  [1.02002273e+02 3.58612873e-02]
mat_Sqrt:  [[ 1.93162487e+01  0.00000000e+00]
 [-7.57483067e-03  1.73561175e-02]]
grads:  [-0.01433719 11.12596652]
Stock Position:  -0.014337186889695383
Bond Position:  [3.08586416]


portfolio before change:  [1.64056721]
curr_Stock_Price:  100.83447447481522
curr_Factors:  [1.00834474e+02 3.63667655e-02]
mat_Sqrt:  [[ 1.92292071e+01  0.00000000e+00]
 [-7.62802889e-03  1.74780099e-02]]
grads:  [ 0.00528268 -2.33100106]
Stock Position:  0.00528268021412537
Bond Position:  [1.10789093]


portfolio before change:  [1.65501956]
curr_Stock_Price:  103.54405666218982
curr_Factors:  [1.03544057e+02 3.65963422e-02]
mat_Sqrt:  [[ 1.98081545e+01  0.00000000e+00]
 [-7.65206818e-03  1.75330908e-02]]
grads:  [-0.02919295  7.47143129]
Stock Position:  -0.02919294768012196
Bond Position:  [4.67777579]


portfolio before change:  [1.66949545]
curr_Stock_Price:  103.06821799265754
curr_Factors:  [1.03068218e+02 3.62312308e-02]
mat_Sqrt:  [[ 1.96185231e+01  0.00000000e+00]
 [-7.61380124e-03  1.74454102e-02]]
grads:  [-0.00829495 -6.03001673]
Stock Position:  -0.008294948894715007
Bond Position:  [2.52444105]


portfolio before change:  [1.65913388]
curr_Stock_Price:  104.35540511340574
curr_Factors:  [1.04355405e+02 3.60642847e-02]
mat_Sqrt:  [[ 1.98177164e+01  0.00000000e+00]
 [-7.59623957e-03  1.74051714e-02]]
grads:  [-3.43523982e-02 -3.61310659e+01]
Stock Position:  -0.03435239819259616
Bond Position:  [5.24399231]


portfolio before change:  [1.70959372]
curr_Stock_Price:  102.90559933940094
curr_Factors:  [1.02905599e+02 3.69588286e-02]
mat_Sqrt:  [[ 1.97832712e+01  0.00000000e+00]
 [-7.68987163e-03  1.76197094e-02]]
grads:  [-0.00380045 -0.71621808]
Stock Position:  -0.003800451613159118
Bond Position:  [2.10068147]


portfolio before change:  [1.71205812]
curr_Stock_Price:  102.32624686201744
curr_Factors:  [1.02326247e+02 3.71614443e-02]
mat_Sqrt:  [[ 1.97257415e+01  0.00000000e+00]
 [-7.71092154e-03  1.76679408e-02]]
grads:  [-4.68107382e-03 -7.60430733e+00]
Stock Position:  -0.0046810738238536815
Bond Position:  [2.19105484]


portfolio before change:  [1.70902629]
curr_Stock_Price:  103.03243818474324
curr_Factors:  [1.03032438e+02 3.70061480e-02]
mat_Sqrt:  [[ 1.98203317e+01  0.00000000e+00]
 [-7.69479284e-03  1.76309853e-02]]
grads:  [-0.00330517 -1.01469104]
Stock Position:  -0.0033051677476917166
Bond Position:  [2.04956578]


portfolio before change:  [1.71548289]
curr_Stock_Price:  101.15647065469707
curr_Factors:  [1.01156471e+02 3.67910570e-02]
mat_Sqrt:  [[ 1.94028176e+01  0.00000000e+00]
 [-7.67239800e-03  1.75796723e-02]]
grads:  [-0.00288523 -2.37090189]
Stock Position:  -0.0028852315960134676
Bond Position:  [2.00734273]


portfolio before change:  [1.71368779]
curr_Stock_Price:  101.86561023177721
curr_Factors:  [1.01865610e+02 3.66279039e-02]
mat_Sqrt:  [[ 1.94954662e+01  0.00000000e+00]
 [-7.65536715e-03  1.75406497e-02]]
grads:  [0.01903243 9.93921558]
Stock Position:  0.01903243097808097
Bond Position:  [-0.22506241]


portfolio before change:  [1.67648517]
curr_Stock_Price:  99.91239232803163
curr_Factors:  [9.99123923e+01 3.70422057e-02]
mat_Sqrt:  [[ 1.92294905e+01  0.00000000e+00]
 [-7.69854071e-03  1.76395728e-02]]
grads:  [ 1.87142412e-03 -1.24452433e+01]
Stock Position:  0.0018714241183779453
Bond Position:  [1.48950671]


portfolio before change:  [1.6778649]
curr_Stock_Price:  100.55015960379166
curr_Factors:  [1.00550160e+02 3.73552257e-02]
mat_Sqrt:  [[ 1.94338321e+01  0.00000000e+00]
 [-7.73100000e-03  1.77139464e-02]]
grads:  [0.00261714 1.56137491]
Stock Position:  0.0026171403309362203
Bond Position:  [1.41471102]


portfolio before change:  [1.68295077]
curr_Stock_Price:  102.42587657907204
curr_Factors:  [1.02425877e+02 3.55150722e-02]
mat_Sqrt:  [[ 1.93026102e+01  0.00000000e+00]
 [-7.53817721e-03  1.72721338e-02]]
grads:  [-1.82701040e-03 -8.85352969e+00]
Stock Position:  -0.0018270103968130854
Bond Position:  [1.87008391]


portfolio before change:  [1.68446394]
curr_Stock_Price:  101.72560812994452
curr_Factors:  [1.01725608e+02 3.62147595e-02]
mat_Sqrt:  [[ 1.93585622e+01  0.00000000e+00]
 [-7.61207036e-03  1.74414443e-02]]
grads:  [-1.64667779e-02 -2.69064669e+01]
Stock Position:  -0.01646677794953192
Bond Position:  [3.35955694]


portfolio before change:  [1.70319236]
curr_Stock_Price:  100.61376651631763
curr_Factors:  [1.00613767e+02 3.60368374e-02]
mat_Sqrt:  [[ 1.90998846e+01  0.00000000e+00]
 [-7.59334839e-03  1.73985469e-02]]
grads:  [-0.00371044 -3.28622672]
Stock Position:  -0.0037104398763670087
Bond Position:  [2.07651369]


portfolio before change:  [1.7004625]
curr_Stock_Price:  101.4194510185623
curr_Factors:  [1.01419451e+02 3.54721656e-02]
mat_Sqrt:  [[ 1.91013960e+01  0.00000000e+00]
 [-7.53362230e-03  1.72616972e-02]]
grads:  [ 0.00798258 -2.24278042]
Stock Position:  0.007982581721124973
Bond Position:  [0.89087344]


portfolio before change:  [1.69879089]
curr_Stock_Price:  101.19609354955361
curr_Factors:  [1.01196094e+02 3.52330203e-02]
mat_Sqrt:  [[ 1.89949732e+01  0.00000000e+00]
 [-7.50818436e-03  1.72034116e-02]]
grads:  [ 0.03094571 -7.67313242]
Stock Position:  0.030945705489846643
Bond Position:  [-1.43279361]


portfolio before change:  [1.64936761]
curr_Stock_Price:  99.60478462893333
curr_Factors:  [9.96047846e+01 3.59102685e-02]
mat_Sqrt:  [[ 1.88751116e+01  0.00000000e+00]
 [-7.58000196e-03  1.73679664e-02]]
grads:  [-1.47016044e-03 -6.91144429e+00]
Stock Position:  -0.001470160439863852
Bond Position:  [1.79580262]


portfolio before change:  [1.6488177]
curr_Stock_Price:  100.13152522262835
curr_Factors:  [1.00131525e+02 3.53867826e-02]
mat_Sqrt:  [[ 1.88361166e+01  0.00000000e+00]
 [-7.52454996e-03  1.72409099e-02]]
grads:  [5.67200074e-04 1.90083205e+00]
Stock Position:  0.0005672000742915019
Bond Position:  [1.59202309]


portfolio before change:  [1.64816803]
curr_Stock_Price:  98.63525694797646
curr_Factors:  [9.86352569e+01 3.48536513e-02]
mat_Sqrt:  [[ 1.84143469e+01  0.00000000e+00]
 [-7.46765305e-03  1.71105427e-02]]
grads:  [-3.56538823e-03  3.79151174e+00]
Stock Position:  -0.003565388227507943
Bond Position:  [1.99984102]


portfolio before change:  [1.64794772]
curr_Stock_Price:  98.76716599060344
curr_Factors:  [9.87671660e+01 3.26397602e-02]
mat_Sqrt:  [[ 1.78437476e+01  0.00000000e+00]
 [-7.22659092e-03  1.65582000e-02]]
grads:  [ 4.49162234e-03 -6.33091541e+00]
Stock Position:  0.004491622344202523
Bond Position:  [1.20432291]


portfolio before change:  [1.64464046]
curr_Stock_Price:  97.99733106718914
curr_Factors:  [9.79973311e+01 3.22712690e-02]
mat_Sqrt:  [[ 1.76044422e+01  0.00000000e+00]
 [-7.18568233e-03  1.64644666e-02]]
grads:  [-2.00849398e-02 -2.53560296e+01]
Stock Position:  -0.020084939839048913
Bond Position:  [3.61291096]


portfolio before change:  [1.62844719]
curr_Stock_Price:  98.82605748467356
curr_Factors:  [9.88260575e+01 3.16356079e-02]
mat_Sqrt:  [[ 1.75775994e+01  0.00000000e+00]
 [-7.11456061e-03  1.63015063e-02]]
grads:  [5.21504348e-03 6.14348241e+00]
Stock Position:  0.005215043482291328
Bond Position:  [1.113065]


portfolio before change:  [1.63501162]
curr_Stock_Price:  100.0581259815195
curr_Factors:  [1.00058126e+02 3.24466295e-02]
mat_Sqrt:  [[ 1.80234182e+01  0.00000000e+00]
 [-7.20517920e-03  1.65091395e-02]]
grads:  [4.51449874e-03 1.04619026e+01]
Stock Position:  0.00451449873826654
Bond Position:  [1.18329934]


portfolio before change:  [1.63585544]
curr_Stock_Price:  100.21227367210223
curr_Factors:  [1.00212274e+02 3.14604631e-02]
mat_Sqrt:  [[ 1.77747488e+01  0.00000000e+00]
 [-7.09483904e-03  1.62563185e-02]]
grads:  [-0.03115913 -6.73774584]
Stock Position:  -0.031159133415428763
Bond Position:  [4.75838305]


portfolio before change:  [1.64466265]
curr_Stock_Price:  99.94871132221004
curr_Factors:  [9.99487113e+01 3.22748669e-02]
mat_Sqrt:  [[ 1.79559931e+01  0.00000000e+00]
 [-7.18608287e-03  1.64653844e-02]]
grads:  [-0.01081306 -3.7742508 ]
Stock Position:  -0.010813059579513692
Bond Position:  [2.72541402]


portfolio before change:  [1.63338777]
curr_Stock_Price:  101.02292873659891
curr_Factors:  [1.01022929e+02 3.28726012e-02]
mat_Sqrt:  [[ 1.83162680e+01  0.00000000e+00]
 [-7.25232114e-03  1.66171553e-02]]
grads:  [-9.22768776e-04 -3.98259697e+00]
Stock Position:  -0.0009227687762475667
Bond Position:  [1.72660858]


portfolio before change:  [1.63388893]
curr_Stock_Price:  100.71373262633668
curr_Factors:  [1.00713733e+02 3.17511807e-02]
mat_Sqrt:  [[ 1.79460400e+01  0.00000000e+00]
 [-7.12754439e-03  1.63312558e-02]]
grads:  [-0.01085306  8.26661359]
Stock Position:  -0.01085306218408585
Bond Position:  [2.72694133]


portfolio before change:  [1.64747402]
curr_Stock_Price:  99.49341272630411
curr_Factors:  [9.94934127e+01 3.29773976e-02]
mat_Sqrt:  [[ 1.80676853e+01  0.00000000e+00]
 [-7.26387198e-03  1.66436216e-02]]
grads:  [0.00132991 1.08797512]
Stock Position:  0.0013299092908626
Bond Position:  [1.51515681]


portfolio before change:  [1.64794886]
curr_Stock_Price:  99.70803973402882
curr_Factors:  [9.97080397e+01 3.41627756e-02]
mat_Sqrt:  [[ 1.84292114e+01  0.00000000e+00]
 [-7.39326998e-03  1.69401096e-02]]
grads:  [-1.66013884e-03  4.58834745e+00]
Stock Position:  -0.0016601388392972676
Bond Position:  [1.81347805]


portfolio before change:  [1.64777957]
curr_Stock_Price:  99.94657096067054
curr_Factors:  [9.99465710e+01 3.51492096e-02]
mat_Sqrt:  [[ 1.87381055e+01  0.00000000e+00]
 [-7.49924899e-03  1.71829381e-02]]
grads:  [-0.00756855  5.81342979]
Stock Position:  -0.007568547356644134
Bond Position:  [2.40422992]


portfolio before change:  [1.64878286]
curr_Stock_Price:  99.85372048417666
curr_Factors:  [9.98537205e+01 3.53256650e-02]
mat_Sqrt:  [[ 1.87676296e+01  0.00000000e+00]
 [-7.51804922e-03  1.72260148e-02]]
grads:  [-5.48505025e-03 -9.94888701e+00]
Stock Position:  -0.005485050250452711
Bond Position:  [2.19648553]


portfolio before change:  [1.64041959]
curr_Stock_Price:  101.42851882332587
curr_Factors:  [1.01428519e+02 3.47971384e-02]
mat_Sqrt:  [[ 1.89204669e+01  0.00000000e+00]
 [-7.46159644e-03  1.70966653e-02]]
grads:  [-3.62572547e-05 -1.98063175e+00]
Stock Position:  -3.6257254726391336e-05
Bond Position:  [1.64409711]


portfolio before change:  [1.64060266]
curr_Stock_Price:  102.04795047947273
curr_Factors:  [1.02047950e+02 3.47241967e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.64060266]
Stock Price:  102.45467352865096
PL:  [-0.81407087]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.19320383e+00  2.98660693e-01]
 [ 3.78021714e-01  1.16568913e-01]
 [ 8.62545268e-02 -1.00867132e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.01212063e-02  1.73201988e-01]
 [-1.24971411e-02 -1.09772316e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 7.51428996e-01  7.36023263e-01]
 [-8.16145626e-02  6.00053494e-02]
 [ 1.82184533e-01  4.86231023e-02]
 [-1.01797376e-01 -4.15146019e-03]
 [-6.05084896e-03 -1.36247539e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-4.22544158e-02 -3.83940302e-02]
 [ 4.51549887e-01  2.87187320e-01]
 [ 1.31858097e-01 -2.21910944e-01]
 [ 3.94483260e-02  8.02177001e-02]
 [ 4.31120435e-03 -7.11018990e-02]
 [-1.13959225e-01 -4.69287644e-01]
 [ 3.58548705e-02 -1.05047247e-01]
 [ 1.56281415e-01 -3.33561958e-02]
 [ 5.76126900e-01 -1.91413594e-01]
 [ 2.99557256e-02 -4.05473428e-01]
 [ 5.54110251e-02  1.32979182e-02]
 [ 3.25861505e-01 -2.24644276e-01]
 [-9.93626954e-03 -4.79987379e-02]
 [-1.56350658e-01  9.57165725e-02]
 [-6.29707936e-02  1.75816502e-02]
 [-6.62150120e-02  2.05463377e-01]
 [-7.21016888e-01  1.11476250e-01]
 [-1.14954731e-01  1.95837284e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.11124158e-01 -9.06516907e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.98168199e-01  2.86477007e-02]
 [-2.35992870e-02 -2.12789777e-01]
 [-7.46135039e-03 -6.03883450e-02]
 [ 7.98311496e-02 -2.54254181e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.69576368]
curr_Stock_Price:  100.58268417915073
curr_Factors:  [1.00582684e+02 4.00515271e-02]
mat_Sqrt:  [[ 2.01294895e+01  0.00000000e+00]
 [-8.00515106e-03  1.83421053e-02]]
grads:  [ 0.06575179 16.28279241]
Stock Position:  0.06575179353327636
Bond Position:  [0.0822718]


portfolio before change:  [6.66506799]
curr_Stock_Price:  100.11568584889403
curr_Factors:  [1.00115686e+02 3.98594452e-02]
mat_Sqrt:  [[ 1.99879269e+01  0.00000000e+00]
 [-7.98593216e-03  1.82980693e-02]]
grads:  [0.02145778 6.37055805]
Stock Position:  0.021457781064497836
Bond Position:  [4.51680752]


portfolio before change:  [6.63143387]
curr_Stock_Price:  98.52191625616238
curr_Factors:  [9.85219163e+01 4.07397023e-02]
mat_Sqrt:  [[ 1.98857409e+01  0.00000000e+00]
 [-8.07363138e-03  1.84990135e-02]]
grads:  [ 0.00411613 -0.54525682]
Stock Position:  0.004116131492564074
Bond Position:  [6.2259047]


portfolio before change:  [6.62975776]
curr_Stock_Price:  97.92563090730233
curr_Factors:  [9.79256309e+01 4.11001725e-02]
mat_Sqrt:  [[ 1.98526369e+01  0.00000000e+00]
 [-8.10927099e-03  1.85806741e-02]]
grads:  [-8.21118474e-04 -8.14754147e+00]
Stock Position:  -0.0008211184743116896
Bond Position:  [6.71016631]


portfolio before change:  [6.62923821]
curr_Stock_Price:  99.57993720144513
curr_Factors:  [9.95799372e+01 4.03301919e-02]
mat_Sqrt:  [[ 1.99980197e+01  0.00000000e+00]
 [-8.03295133e-03  1.84058038e-02]]
grads:  [-2.26505509e-04  9.41018333e+00]
Stock Position:  -0.00022650550922901906
Bond Position:  [6.65179361]


portfolio before change:  [6.6303758]
curr_Stock_Price:  98.22869319832208
curr_Factors:  [9.82286932e+01 4.24770042e-02]
mat_Sqrt:  [[ 2.02448846e+01  0.00000000e+00]
 [-8.24398003e-03  1.88893313e-02]]
grads:  [-2.98375164e-03 -5.81133948e+00]
Stock Position:  -0.0029837516384350993
Bond Position:  [6.92346582]


portfolio before change:  [6.63074105]
curr_Stock_Price:  98.39634655798635
curr_Factors:  [9.83963466e+01 4.16396557e-02]
mat_Sqrt:  [[ 2.00785589e+01  0.00000000e+00]
 [-8.16231885e-03  1.87022220e-02]]
grads:  [0.00644338 5.14039921]
Stock Position:  0.0064433796319278485
Bond Position:  [5.99673603]


portfolio before change:  [6.63228736]
curr_Stock_Price:  98.51998942425534
curr_Factors:  [9.85199894e+01 4.28057724e-02]
mat_Sqrt:  [[ 2.03833483e+01  0.00000000e+00]
 [-8.27582237e-03  1.89622912e-02]]
grads:  [ 0.05262413 38.81510174]
Stock Position:  0.052624125661733176
Bond Position:  [1.44775906]


portfolio before change:  [6.71371933]
curr_Stock_Price:  100.06397675781236
curr_Factors:  [1.00063977e+02 4.19428245e-02]
mat_Sqrt:  [[ 2.04930498e+01  0.00000000e+00]
 [-8.19197895e-03  1.87701818e-02]]
grads:  [-2.70462824e-03  3.19684433e+00]
Stock Position:  -0.0027046282359608994
Bond Position:  [6.98435519]


portfolio before change:  [6.71654759]
curr_Stock_Price:  99.34108255961885
curr_Factors:  [9.93410826e+01 4.13479924e-02]
mat_Sqrt:  [[ 2.02002201e+01  0.00000000e+00]
 [-8.13368230e-03  1.86366074e-02]]
grads:  [0.01006946 2.60901039]
Stock Position:  0.01006946423834264
Bond Position:  [5.71623611]


portfolio before change:  [6.72426595]
curr_Stock_Price:  100.03662992116523
curr_Factors:  [1.00036630e+02 4.29425895e-02]
mat_Sqrt:  [[ 2.07301845e+01  0.00000000e+00]
 [-8.28903753e-03  1.89925710e-02]]
grads:  [-0.00499799 -0.21858337]
Stock Position:  -0.004997988428028463
Bond Position:  [7.22424787]


portfolio before change:  [6.71880333]
curr_Stock_Price:  101.31028458263224
curr_Factors:  [1.01310285e+02 4.22822149e-02]
mat_Sqrt:  [[ 2.08320687e+01  0.00000000e+00]
 [-8.22505585e-03  1.88459705e-02]]
grads:  [-3.14487010e-03 -7.22953159e+00]
Stock Position:  -0.0031448701017310725
Bond Position:  [7.03741101]


portfolio before change:  [6.71672157]
curr_Stock_Price:  102.25197415615887
curr_Factors:  [1.02251974e+02 4.10036601e-02]
mat_Sqrt:  [[ 2.07053709e+01  0.00000000e+00]
 [-8.09974420e-03  1.85588455e-02]]
grads:  [-0.00316389 -0.96396098]
Stock Position:  -0.0031638902520576533
Bond Position:  [7.04023559]


portfolio before change:  [6.72324314]
curr_Stock_Price:  100.4688873420126
curr_Factors:  [1.00468887e+02 4.19939655e-02]
mat_Sqrt:  [[ 2.05885156e+01  0.00000000e+00]
 [-8.19697168e-03  1.87816216e-02]]
grads:  [-0.00286621 -2.04423404]
Stock Position:  -0.002866206841561908
Bond Position:  [7.01120775]


portfolio before change:  [6.72579657]
curr_Stock_Price:  99.88380197858862
curr_Factors:  [9.98838020e+01 4.26294562e-02]
mat_Sqrt:  [[ 2.06229107e+01  0.00000000e+00]
 [-8.25876080e-03  1.89231983e-02]]
grads:  [ 0.0279732  15.17646837]
Stock Position:  0.027973195290478196
Bond Position:  [3.93172747]


portfolio before change:  [6.72797796]
curr_Stock_Price:  99.94421284921914
curr_Factors:  [9.99442128e+01 4.34255871e-02]
mat_Sqrt:  [[ 2.08271815e+01  0.00000000e+00]
 [-8.33552274e-03  1.90990820e-02]]
grads:  [ 1.68089097e-03 -1.16189325e+01]
Stock Position:  0.0016808909677836412
Bond Position:  [6.55998263]


portfolio before change:  [6.72901967]
curr_Stock_Price:  100.07608476589219
curr_Factors:  [1.00076085e+02 4.23423167e-02]
mat_Sqrt:  [[ 2.05929049e+01  0.00000000e+00]
 [-8.23089950e-03  1.88593600e-02]]
grads:  [3.61572109e-03 4.25346884e+00]
Stock Position:  0.0036157210883814806
Bond Position:  [6.36717246]


portfolio before change:  [6.72913387]
curr_Stock_Price:  99.8875349527887
curr_Factors:  [9.98875350e+01 4.23234453e-02]
mat_Sqrt:  [[ 2.05495257e+01  0.00000000e+00]
 [-8.22906510e-03  1.88551569e-02]]
grads:  [-1.30028346e-03 -3.77095240e+00]
Stock Position:  -0.0013002834623848717
Bond Position:  [6.85901598]


portfolio before change:  [6.72807097]
curr_Stock_Price:  101.36438789244654
curr_Factors:  [1.01364388e+02 4.18560329e-02]
mat_Sqrt:  [[ 2.07378837e+01  0.00000000e+00]
 [-8.18349880e-03  1.87507513e-02]]
grads:  [-1.53715369e-02 -2.50276715e+01]
Stock Position:  -0.015371536929161765
Bond Position:  [8.2861974]


portfolio before change:  [6.71165576]
curr_Stock_Price:  102.49967149200364
curr_Factors:  [1.02499671e+02 4.20402670e-02]
mat_Sqrt:  [[ 2.10162491e+01  0.00000000e+00]
 [-8.20148933e-03  1.87919728e-02]]
grads:  [-4.75418167e-04 -5.59000631e+00]
Stock Position:  -0.00047541816716203787
Bond Position:  [6.76038596]


portfolio before change:  [6.71249986]
curr_Stock_Price:  102.5017744222464
curr_Factors:  [1.02501774e+02 4.35448369e-02]
mat_Sqrt:  [[ 2.13894549e+01  0.00000000e+00]
 [-8.34695987e-03  1.91252877e-02]]
grads:  [ 0.00662586 -1.74408858]
Stock Position:  0.006625862022205543
Bond Position:  [6.03333725]


portfolio before change:  [6.70909518]
curr_Stock_Price:  101.87409792444235
curr_Factors:  [1.01874098e+02 4.53735798e-02]
mat_Sqrt:  [[ 2.17002780e+01  0.00000000e+00]
 [-8.52043001e-03  1.95227577e-02]]
grads:  [ 0.02269958 -9.80463911]
Stock Position:  0.022699578219252156
Bond Position:  [4.39659612]


portfolio before change:  [6.72704201]
curr_Stock_Price:  102.64050967120137
curr_Factors:  [1.02640510e+02 4.51582583e-02]
mat_Sqrt:  [[ 2.18115933e+01  0.00000000e+00]
 [-8.50018901e-03  1.94763798e-02]]
grads:  [-6.73987380e-03 -2.08187267e+01]
Stock Position:  -0.00673987380137128
Bond Position:  [7.41882609]


portfolio before change:  [6.7298143]
curr_Stock_Price:  102.36678334476927
curr_Factors:  [1.02366783e+02 4.61225335e-02]
mat_Sqrt:  [[ 2.19844515e+01  0.00000000e+00]
 [-8.59046294e-03  1.96832233e-02]]
grads:  [0.00278445 0.67559657]
Stock Position:  0.0027844548461051838
Bond Position:  [6.44477861]


portfolio before change:  [6.72983143]
curr_Stock_Price:  102.08359865034986
curr_Factors:  [1.02083599e+02 4.79625108e-02]
mat_Sqrt:  [[ 2.23566602e+01  0.00000000e+00]
 [-8.76013797e-03  2.00719977e-02]]
grads:  [ 1.01901940e-02 -1.11919242e+01]
Stock Position:  0.010190194022142114
Bond Position:  [5.68957976]


portfolio before change:  [6.73352124]
curr_Stock_Price:  102.37589552381476
curr_Factors:  [1.02375896e+02 4.80028864e-02]
mat_Sqrt:  [[ 2.24301093e+01  0.00000000e+00]
 [-8.76382441e-03  2.00804444e-02]]
grads:  [-1.37692758e-03 -2.39032249e+00]
Stock Position:  -0.0013769275820310284
Bond Position:  [6.87448543]


portfolio before change:  [6.73282017]
curr_Stock_Price:  103.50916274325472
curr_Factors:  [1.03509163e+02 4.67647761e-02]
mat_Sqrt:  [[ 2.23840272e+01  0.00000000e+00]
 [-8.65006600e-03  1.98197911e-02]]
grads:  [-0.00511867  4.82934315]
Stock Position:  -0.00511867324559052
Bond Position:  [7.26264976]


portfolio before change:  [6.72776439]
curr_Stock_Price:  104.67424485716137
curr_Factors:  [1.04674245e+02 4.45400029e-02]
mat_Sqrt:  [[ 2.20909787e+01  0.00000000e+00]
 [-8.44180103e-03  1.93425961e-02]]
grads:  [-0.00250317  0.90896021]
Stock Position:  -0.0025031725882471213
Bond Position:  [6.98978209]


portfolio before change:  [6.72927864]
curr_Stock_Price:  104.41838047012818
curr_Factors:  [1.04418380e+02 4.61228123e-02]
mat_Sqrt:  [[ 2.24251235e+01  0.00000000e+00]
 [-8.59048891e-03  1.96832828e-02]]
grads:  [1.04599457e-03 1.04384710e+01]
Stock Position:  0.0010459945722938388
Bond Position:  [6.62005758]


portfolio before change:  [6.73103823]
curr_Stock_Price:  105.30942962520326
curr_Factors:  [1.05309430e+02 4.57297119e-02]
mat_Sqrt:  [[ 2.25199018e+01  0.00000000e+00]
 [-8.55380260e-03  1.95992240e-02]]
grads:  [-0.02985647  5.68778895]
Stock Position:  -0.029856465148244044
Bond Position:  [9.87520554]


portfolio before change:  [6.69402055]
curr_Stock_Price:  106.59063145679448
curr_Factors:  [1.06590631e+02 4.74825634e-02]
mat_Sqrt:  [[ 2.32266253e+01  0.00000000e+00]
 [-8.71619764e-03  1.99713177e-02]]
grads:  [-0.00458128  0.9805927 ]
Stock Position:  -0.004581280768771726
Bond Position:  [7.18234216]


portfolio before change:  [6.69569093]
curr_Stock_Price:  106.42200381462644
curr_Factors:  [1.06422004e+02 4.81648725e-02]
mat_Sqrt:  [[ 2.33559017e+01  0.00000000e+00]
 [-8.77859875e-03  2.01142966e-02]]
grads:  [ 0.00310596 -0.59396505]
Stock Position:  0.003105964288418575
Bond Position:  [6.36514799]


portfolio before change:  [6.69851631]
curr_Stock_Price:  107.07548536908342
curr_Factors:  [1.07075485e+02 4.83767129e-02]
mat_Sqrt:  [[ 2.35509391e+01  0.00000000e+00]
 [-8.79788273e-03  2.01584818e-02]]
grads:  [-0.01064449 -4.4969503 ]
Stock Position:  -0.01064449271920665
Bond Position:  [7.83828054]


portfolio before change:  [6.7268981]
curr_Stock_Price:  104.50120173404925
curr_Factors:  [1.04501202e+02 4.86809113e-02]
mat_Sqrt:  [[ 2.30568851e+01  0.00000000e+00]
 [-8.82550044e-03  2.02217619e-02]]
grads:  [0.00440091 2.63820043]
Stock Position:  0.004400905477436939
Bond Position:  [6.26699819]


portfolio before change:  [6.72587134]
curr_Stock_Price:  104.08988107108433
curr_Factors:  [1.04089881e+02 4.93576989e-02]
mat_Sqrt:  [[ 2.31252249e+01  0.00000000e+00]
 [-8.88663706e-03  2.03618435e-02]]
grads:  [-0.00409369  3.99399721]
Stock Position:  -0.004093694710963193
Bond Position:  [7.15198354]


portfolio before change:  [6.72994037]
curr_Stock_Price:  103.31430527007245
curr_Factors:  [1.03314305e+02 5.02895328e-02]
mat_Sqrt:  [[ 2.31685717e+01  0.00000000e+00]
 [-8.97013113e-03  2.05531525e-02]]
grads:  [-0.01232986  1.39383487]
Stock Position:  -0.012329863137249077
Bond Position:  [8.00379161]


portfolio before change:  [6.74487682]
curr_Stock_Price:  102.18404810365055
curr_Factors:  [1.02184048e+02 5.08367691e-02]
mat_Sqrt:  [[ 2.30394482e+01  0.00000000e+00]
 [-9.01880427e-03  2.06646766e-02]]
grads:  [-5.05517138e-03 -1.02972711e+01]
Stock Position:  -0.005055171380830307
Bond Position:  [7.2614347]


portfolio before change:  [6.73649038]
curr_Stock_Price:  104.02259687274692
curr_Factors:  [1.04022597e+02 4.97579371e-02]
mat_Sqrt:  [[ 2.32037872e+01  0.00000000e+00]
 [-8.92259488e-03  2.04442332e-02]]
grads:  [-1.45739075e-03 -2.95380826e+00]
Stock Position:  -0.0014573907482952867
Bond Position:  [6.88809195]


portfolio before change:  [6.7366414]
curr_Stock_Price:  104.50979718647478
curr_Factors:  [1.04509797e+02 4.89211203e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.7366414]
Stock Price:  105.36784903215309
PL:  [1.36879237]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.38416028e+00  3.41832122e-01]
 [ 8.08387437e-01  9.60869814e-02]
 [ 1.12135300e-01 -4.59095155e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.89859951e-02  7.21948965e-02]
 [-1.49003171e-01 -4.12634966e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.23508385e-01  8.16879135e-01]
 [ 2.67092391e-02  4.03824805e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-3.73643171e-02  1.63522885e-02]
 [ 4.35834059e-02 -1.37488383e-01]
 [-1.17171384e-01 -2.79723720e-02]
 [-1.27334444e-01  2.52056170e-01]
 [ 3.85048884e-01  2.66301126e-01]
 [ 1.32556062e-01 -3.93376312e-02]
 [ 4.00199462e-02  7.54903136e-02]
 [ 1.99470678e-01  7.41635991e-02]
 [ 1.52021793e-01  1.60297202e-01]
 [-5.90730658e-01  2.67929340e-01]
 [-2.40448252e-02  1.92846499e-01]
 [ 1.68148709e+00  2.05838270e-01]
 [ 1.55607592e-02  4.52780699e-01]
 [-1.57561786e-01  2.08064262e-01]
 [-1.63815421e-01  7.35479293e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [-2.28900581e-02 -4.54299036e-01]
 [ 8.72137902e-02  1.65865262e-02]
 [ 4.97530179e-01 -3.01018927e-01]
 [-5.49040989e-01 -3.00934662e-01]
 [ 2.66043954e-01  1.01248014e-01]
 [-1.43831581e-01  2.00031113e-01]
 [ 4.83752723e-01  2.28908411e-01]
 [ 5.34547232e-02 -7.85382884e-02]
 [ 2.72723799e-01 -2.90874727e-01]
 [ 9.79526838e-02  6.60409216e-02]
 [-5.45652298e-02  1.51050714e-01]
 [-3.50528460e-01 -1.29722804e-01]
 [ 7.77111234e-02  3.57271316e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.98693427]
curr_Stock_Price:  99.75401924489815
curr_Factors:  [9.97540192e+01 4.06478771e-02]
mat_Sqrt:  [[ 2.01117257e+01  0.00000000e+00]
 [-8.06452748e-03  1.84781538e-02]]
grads:  [ 0.0762415  18.49925732]
Stock Position:  0.0762414957069309
Bond Position:  [-6.61846136]


portfolio before change:  [0.94231828]
curr_Stock_Price:  99.17967806673387
curr_Factors:  [9.91796781e+01 3.87459195e-02]
mat_Sqrt:  [[ 1.95225112e+01  0.00000000e+00]
 [-7.87359328e-03  1.80406686e-02]]
grads:  [0.04355604 5.32613195]
Stock Position:  0.04355603773968738
Bond Position:  [-3.37755552]


portfolio before change:  [0.95593337]
curr_Stock_Price:  99.50195972131964
curr_Factors:  [9.95019597e+01 3.79533006e-02]
mat_Sqrt:  [[ 1.93845806e+01  0.00000000e+00]
 [-7.79264274e-03  1.78551876e-02]]
grads:  [ 0.00475113 -2.5712144 ]
Stock Position:  0.004751134223383
Bond Position:  [0.48318621]


portfolio before change:  [0.9577412]
curr_Stock_Price:  99.86975186844083
curr_Factors:  [9.98697519e+01 3.73515683e-02]
mat_Sqrt:  [[ 1.93013814e+01  0.00000000e+00]
 [-7.73062153e-03  1.77130792e-02]]
grads:  [-8.44569964e-04 -8.54661186e+00]
Stock Position:  -0.0008445699641366083
Bond Position:  [1.0420882]


portfolio before change:  [0.95749718]
curr_Stock_Price:  100.31293221749422
curr_Factors:  [1.00312932e+02 3.68720549e-02]
mat_Sqrt:  [[ 1.92621871e+01  0.00000000e+00]
 [-7.68083901e-03  1.75990131e-02]]
grads:  [-2.98395810e-03  4.10221279e+00]
Stock Position:  -0.0029839580961796594
Bond Position:  [1.25682676]


portfolio before change:  [0.95932795]
curr_Stock_Price:  99.75204752809346
curr_Factors:  [9.97520475e+01 3.62209994e-02]
mat_Sqrt:  [[ 1.89846254e+01  0.00000000e+00]
 [-7.61272612e-03  1.74429469e-02]]
grads:  [-0.00879723 -2.36562646]
Stock Position:  -0.00879722581187026
Bond Position:  [1.83686923]


portfolio before change:  [0.97877146]
curr_Stock_Price:  97.56796223119704
curr_Factors:  [9.75679622e+01 3.62277659e-02]
mat_Sqrt:  [[ 1.85706887e+01  0.00000000e+00]
 [-7.61343716e-03  1.74445761e-02]]
grads:  [0.00696656 5.51099017]
Stock Position:  0.006966557839638797
Bond Position:  [0.29905861]


portfolio before change:  [0.98181272]
curr_Stock_Price:  97.99914713275705
curr_Factors:  [9.79991471e+01 3.57571423e-02]
mat_Sqrt:  [[ 1.85312066e+01  0.00000000e+00]
 [-7.56382362e-03  1.73308971e-02]]
grads:  [ 0.06367765 47.13426712]
Stock Position:  0.06367764892250177
Bond Position:  [-5.25854257]


portfolio before change:  [0.92746379]
curr_Stock_Price:  97.155969482746
curr_Factors:  [9.71559695e+01 3.67138743e-02]
mat_Sqrt:  [[ 1.86159240e+01  0.00000000e+00]
 [-7.66434596e-03  1.75612227e-02]]
grads:  [1.09021090e-02 2.29952555e+01]
Stock Position:  0.010902108995550407
Bond Position:  [-0.13174118]


portfolio before change:  [0.92598383]
curr_Stock_Price:  97.02172997279804
curr_Factors:  [9.70217300e+01 3.60738953e-02]
mat_Sqrt:  [[ 1.84274624e+01  0.00000000e+00]
 [-7.59725164e-03  1.74074904e-02]]
grads:  [0.0133732  6.49585501]
Stock Position:  0.013373202513807164
Bond Position:  [-0.37150742]


portfolio before change:  [0.92646708]
curr_Stock_Price:  97.06133892090283
curr_Factors:  [9.70613389e+01 3.69837924e-02]
mat_Sqrt:  [[ 1.86660317e+01  0.00000000e+00]
 [-7.69246825e-03  1.76256590e-02]]
grads:  [-0.00161939  0.92775473]
Stock Position:  -0.0016193904414015486
Bond Position:  [1.08364729]


portfolio before change:  [0.9255594]
curr_Stock_Price:  97.70550360719075
curr_Factors:  [9.77055036e+01 3.67736306e-02]
mat_Sqrt:  [[ 1.87364489e+01  0.00000000e+00]
 [-7.67058075e-03  1.75755085e-02]]
grads:  [-8.76443775e-04 -7.82272579e+00]
Stock Position:  -0.0008764437751811879
Bond Position:  [1.01119278]


portfolio before change:  [0.92588958]
curr_Stock_Price:  97.47299566639535
curr_Factors:  [9.74729957e+01 3.73151334e-02]
mat_Sqrt:  [[ 1.88289808e+01  0.00000000e+00]
 [-7.72685017e-03  1.77044379e-02]]
grads:  [-0.0068713  -1.57996386]
Stock Position:  -0.006871297437038245
Bond Position:  [1.59565553]


portfolio before change:  [0.93332128]
curr_Stock_Price:  96.42046853145368
curr_Factors:  [9.64204685e+01 3.81078986e-02]
mat_Sqrt:  [[ 1.88224754e+01  0.00000000e+00]
 [-7.80849779e-03  1.78915161e-02]]
grads:  [-9.20607556e-04  1.40880274e+01]
Stock Position:  -0.0009206075558044308
Bond Position:  [1.02208669]


portfolio before change:  [0.93344835]
curr_Stock_Price:  96.42122275195011
curr_Factors:  [9.64212228e+01 4.10258760e-02]
mat_Sqrt:  [[ 1.95299695e+01  0.00000000e+00]
 [-8.10193814e-03  1.85638724e-02]]
grads:  [ 0.02566682 14.34512803]
Stock Position:  0.02566682054004186
Bond Position:  [-1.54137787]


portfolio before change:  [0.92043527]
curr_Stock_Price:  95.92172957249234
curr_Factors:  [9.59217296e+01 4.12931596e-02]
mat_Sqrt:  [[ 1.94919845e+01  0.00000000e+00]
 [-8.12828736e-03  1.86242460e-02]]
grads:  [ 0.00591975 -2.11217308]
Stock Position:  0.005919751898989377
Bond Position:  [0.35260243]


portfolio before change:  [0.91747125]
curr_Stock_Price:  95.41358478798966
curr_Factors:  [9.54135848e+01 4.27603100e-02]
mat_Sqrt:  [[ 1.97301613e+01  0.00000000e+00]
 [-8.27142648e-03  1.89522190e-02]]
grads:  [3.69822725e-03 3.98319130e+00]
Stock Position:  0.003698227253708367
Bond Position:  [0.56461013]


portfolio before change:  [0.91832231]
curr_Stock_Price:  95.62462636952617
curr_Factors:  [9.56246264e+01 4.22670895e-02]
mat_Sqrt:  [[ 1.96594301e+01  0.00000000e+00]
 [-8.22358457e-03  1.88425994e-02]]
grads:  [0.01179273 3.93595372]
Stock Position:  0.011792728771226132
Bond Position:  [-0.20935297]


portfolio before change:  [0.91055101]
curr_Stock_Price:  94.96785461044838
curr_Factors:  [9.49678546e+01 4.31927104e-02]
mat_Sqrt:  [[ 1.97370325e+01  0.00000000e+00]
 [-8.31314241e-03  1.90478022e-02]]
grads:  [0.01124694 8.41552223]
Stock Position:  0.011246940383984829
Bond Position:  [-0.15754679]


portfolio before change:  [0.90381083]
curr_Stock_Price:  94.37031507726111
curr_Factors:  [9.43703151e+01 4.24891964e-02]
mat_Sqrt:  [[ 1.94524660e+01  0.00000000e+00]
 [-8.24516308e-03  1.88920420e-02]]
grads:  [-0.02435664 14.18212705]
Stock Position:  -0.02435663986929399
Bond Position:  [3.20235461]


portfolio before change:  [0.92857626]
curr_Stock_Price:  93.36996705893637
curr_Factors:  [9.33699671e+01 4.31210230e-02]
mat_Sqrt:  [[ 1.93888358e+01  0.00000000e+00]
 [-8.30624084e-03  1.90319887e-02]]
grads:  [3.10076827e-03 1.01327561e+01]
Stock Position:  0.0031007682714912707
Bond Position:  [0.63905763]


portfolio before change:  [0.93032146]
curr_Stock_Price:  93.90703154561085
curr_Factors:  [9.39070315e+01 4.46196820e-02]
mat_Sqrt:  [[ 1.98363311e+01  0.00000000e+00]
 [-8.44934857e-03  1.93598897e-02]]
grads:  [ 0.08929687 10.6322026 ]
Stock Position:  0.08929686989241947
Bond Position:  [-7.45528252]


portfolio before change:  [0.97428758]
curr_Stock_Price:  94.40982726045785
curr_Factors:  [9.44098273e+01 4.51942710e-02]
mat_Sqrt:  [[ 2.00705325e+01  0.00000000e+00]
 [-8.50357769e-03  1.94841442e-02]]
grads:  [1.06210663e-02 2.32384186e+01]
Stock Position:  0.010621066308264234
Bond Position:  [-0.02844546]


portfolio before change:  [0.95508808]
curr_Stock_Price:  92.60248097685124
curr_Factors:  [9.26024810e+01 4.59685882e-02]
mat_Sqrt:  [[ 1.98542372e+01  0.00000000e+00]
 [-8.57611457e-03  1.96503471e-02]]
grads:  [-3.36225947e-03  1.05883250e+01]
Stock Position:  -0.003362259472398188
Bond Position:  [1.26644165]


portfolio before change:  [0.95650815]
curr_Stock_Price:  92.2272097210829
curr_Factors:  [9.22272097e+01 4.51593190e-02]
mat_Sqrt:  [[ 1.95989481e+01  0.00000000e+00]
 [-8.50028885e-03  1.94766085e-02]]
grads:  [-0.00672059  3.77621849]
Stock Position:  -0.006720588922662072
Bond Position:  [1.57632931]


portfolio before change:  [0.94869163]
curr_Stock_Price:  93.41960169633467
curr_Factors:  [9.34196017e+01 4.30248990e-02]
mat_Sqrt:  [[ 1.93775087e+01  0.00000000e+00]
 [-8.29697767e-03  1.90107641e-02]]
grads:  [ 0.00946864 -3.83969507]
Stock Position:  0.009468637340933304
Bond Position:  [0.0641353]


portfolio before change:  [0.96554862]
curr_Stock_Price:  95.19905247066103
curr_Factors:  [9.51990525e+01 4.21090181e-02]
mat_Sqrt:  [[ 1.95353044e+01  0.00000000e+00]
 [-8.20819280e-03  1.88073324e-02]]
grads:  [-1.13211654e-02 -2.41554212e+01]
Stock Position:  -0.01132116540108694
Bond Position:  [2.04331284]


portfolio before change:  [0.97486299]
curr_Stock_Price:  94.39887537820549
curr_Factors:  [9.43988754e+01 4.38572519e-02]
mat_Sqrt:  [[ 1.97691287e+01  0.00000000e+00]
 [-8.37684924e-03  1.91937729e-02]]
grads:  [0.00477779 0.86416185]
Stock Position:  0.004777789920677552
Bond Position:  [0.52384499]


portfolio before change:  [0.97556866]
curr_Stock_Price:  94.53286759528712
curr_Factors:  [9.45328676e+01 4.40127568e-02]
mat_Sqrt:  [[ 1.98322559e+01  0.00000000e+00]
 [-8.39168701e-03  1.92277705e-02]]
grads:  [  0.01846259 -15.65542545]
Stock Position:  0.018462586909769926
Bond Position:  [-0.76975263]


portfolio before change:  [0.95560952]
curr_Stock_Price:  93.45702090644588
curr_Factors:  [9.34570209e+01 4.46260722e-02]
mat_Sqrt:  [[ 1.97426872e+01  0.00000000e+00]
 [-8.44995358e-03  1.93612759e-02]]
grads:  [ -0.03446236 -15.54312138]
Stock Position:  -0.034462362512558305
Bond Position:  [4.17635925]


portfolio before change:  [0.95368022]
curr_Stock_Price:  93.52815287800126
curr_Factors:  [9.35281529e+01 4.25832783e-02]
mat_Sqrt:  [[ 1.93002042e+01  0.00000000e+00]
 [-8.25428648e-03  1.89129463e-02]]
grads:  [0.01607404 5.35337076]
Stock Position:  0.016074037691326912
Bond Position:  [-0.54969483]


portfolio before change:  [0.95071615]
curr_Stock_Price:  93.34802666189522
curr_Factors:  [9.33480267e+01 4.33063991e-02]
mat_Sqrt:  [[ 1.94259013e+01  0.00000000e+00]
 [-8.32407584e-03  1.90728538e-02]]
grads:  [-2.91007583e-03  1.04877390e+01]
Stock Position:  -0.0029100758281306867
Bond Position:  [1.22236599]


portfolio before change:  [0.95066742]
curr_Stock_Price:  93.4172792904053
curr_Factors:  [9.34172793e+01 4.33029765e-02]
mat_Sqrt:  [[ 1.94395447e+01  0.00000000e+00]
 [-8.32374690e-03  1.90721001e-02]]
grads:  [ 0.03002419 12.00226559]
Stock Position:  0.030024187928482365
Bond Position:  [-1.85411052]


portfolio before change:  [0.92282586]
curr_Stock_Price:  92.4976945712831
curr_Factors:  [9.24976946e+01 4.27178005e-02]
mat_Sqrt:  [[ 1.91176871e+01  0.00000000e+00]
 [-8.26731400e-03  1.89427961e-02]]
grads:  [ 1.00314457e-03 -4.14607685e+00]
Stock Position:  0.0010031445700133734
Bond Position:  [0.8300373]


portfolio before change:  [0.92297381]
curr_Stock_Price:  92.54174203281323
curr_Factors:  [9.25417420e+01 4.32191166e-02]
mat_Sqrt:  [[ 1.92386952e+01  0.00000000e+00]
 [-8.31568317e-03  1.90536238e-02]]
grads:  [ 7.57721140e-03 -1.52661106e+01]
Stock Position:  0.007577211401170184
Bond Position:  [0.22176547]


portfolio before change:  [0.92789453]
curr_Stock_Price:  93.18749379290996
curr_Factors:  [9.31874938e+01 4.28964333e-02]
mat_Sqrt:  [[ 1.93004851e+01  0.00000000e+00]
 [-8.28458166e-03  1.89823613e-02]]
grads:  [0.0065685  3.47906779]
Stock Position:  0.006568503568256202
Bond Position:  [0.31579214]


portfolio before change:  [0.93916414]
curr_Stock_Price:  94.89718859007246
curr_Factors:  [9.48971886e+01 4.17673884e-02]
mat_Sqrt:  [[ 1.93942061e+01  0.00000000e+00]
 [-8.17482853e-03  1.87308853e-02]]
grads:  [5.85675240e-04 8.06425919e+00]
Stock Position:  0.0005856752397638439
Bond Position:  [0.88358521]


portfolio before change:  [0.9389396]
curr_Stock_Price:  94.32519802992798
curr_Factors:  [9.43251980e+01 4.32624025e-02]
mat_Sqrt:  [[ 1.96192790e+01  0.00000000e+00]
 [-8.31984640e-03  1.90631629e-02]]
grads:  [-0.02075225 -6.80489403]
Stock Position:  -0.020752247500436204
Bond Position:  [2.89639945]


portfolio before change:  [0.96055052]
curr_Stock_Price:  93.30126783735957
curr_Factors:  [9.33012678e+01 4.23727725e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.96055052]
Stock Price:  94.0566951059039
PL:  [0.96055052]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.28972606e+00  3.20482436e-01]
 [ 3.56177783e-01  1.14307823e-01]
 [ 3.61143932e-03 -5.64045008e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.17217376e-02  1.65871567e-01]
 [-1.75469682e-01 -1.27434622e-02]
 [ 8.74369261e-02  9.61052395e-02]
 [ 7.59605749e-01  7.45736920e-01]
 [-1.02750267e-02  3.04905621e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-2.30257803e-02  1.83910724e-02]
 [ 6.52244461e-02 -9.95847091e-02]
 [-8.25435718e-02  1.14129896e-01]
 [-1.30267581e-01  3.05365639e-01]
 [ 4.83439822e-01  3.14922428e-01]
 [ 1.32730598e-01 -5.11960420e-02]
 [ 4.08969289e-02  1.22685648e-01]
 [ 2.35882456e-01  6.99864988e-02]
 [ 1.45965699e-01  1.54135330e-01]
 [-7.48967802e-01  3.60039536e-01]
 [-6.23374019e-02  2.23455425e-01]
 [ 1.72869812e+00  2.30488865e-01]
 [ 1.52446748e-02  4.40273198e-01]
 [-1.51193563e-01  1.83010075e-01]
 [-1.90656298e-01  1.14137123e-01]
 [ 1.80449086e-01 -8.51782311e-02]
 [-7.79451610e-02 -4.53306562e-01]
 [ 9.90577602e-02 -8.62617085e-03]
 [ 5.90048434e-01 -3.08494163e-01]
 [-5.82223426e-01 -3.08881027e-01]
 [ 3.04024071e-01  1.15178871e-01]
 [-1.50410209e-01  2.11209452e-01]
 [ 6.08247839e-01  2.39891271e-01]
 [ 5.16535641e-02 -7.34865566e-02]
 [ 2.58010316e-01 -2.70360571e-01]
 [ 1.01028560e-01  6.21603043e-02]
 [-5.43982349e-02  1.48766517e-01]
 [-3.40374550e-01 -1.23655135e-01]
 [ 1.38846697e-01 -1.63822985e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.81032679]
curr_Stock_Price:  100.16384868700447
curr_Factors:  [1.00163849e+02 4.03608193e-02]
mat_Sqrt:  [[ 2.01229195e+01  0.00000000e+00]
 [-8.03600092e-03  1.84127913e-02]]
grads:  [ 0.07104317 17.40542384]
Stock Position:  0.07104317330868636
Bond Position:  [-3.30563088]


portfolio before change:  [3.81088663]
curr_Stock_Price:  100.17754567207788
curr_Factors:  [1.00177546e+02 4.12302394e-02]
mat_Sqrt:  [[ 2.03412818e+01  0.00000000e+00]
 [-8.12209228e-03  1.86100513e-02]]
grads:  [0.01996265 6.14226265]
Stock Position:  0.01996264600995979
Bond Position:  [1.81107775]


portfolio before change:  [3.82711833]
curr_Stock_Price:  100.9793080297563
curr_Factors:  [1.00979308e+02 4.02111396e-02]
mat_Sqrt:  [[ 2.02490933e+01  0.00000000e+00]
 [-8.02108617e-03  1.83786173e-02]]
grads:  [-1.03735524e-03 -3.06902854e+00]
Stock Position:  -0.0010373552404332432
Bond Position:  [3.93186974]


portfolio before change:  [3.82878038]
curr_Stock_Price:  99.85092827097884
curr_Factors:  [9.98509283e+01 4.23115122e-02]
mat_Sqrt:  [[ 2.05390986e+01  0.00000000e+00]
 [-8.22790493e-03  1.88524986e-02]]
grads:  [-7.93674896e-04 -8.03006624e+00]
Stock Position:  -0.0007936748955361897
Bond Position:  [3.90802955]


portfolio before change:  [3.82933058]
curr_Stock_Price:  99.7732217752885
curr_Factors:  [9.97732218e+01 4.16043838e-02]
mat_Sqrt:  [[ 2.03508964e+01  0.00000000e+00]
 [-8.15886108e-03  1.86942992e-02]]
grads:  [-4.58429471e-04  8.87284221e+00]
Stock Position:  -0.0004584294705779247
Bond Position:  [3.87506957]


portfolio before change:  [3.82969564]
curr_Stock_Price:  100.03357226227243
curr_Factors:  [1.00033572e+02 4.07127715e-02]
mat_Sqrt:  [[ 2.01841801e+01  0.00000000e+00]
 [-8.07096242e-03  1.84928981e-02]]
grads:  [-0.00896897 -0.68910033]
Stock Position:  -0.008968973910615546
Bond Position:  [4.72689414]


portfolio before change:  [3.83981839]
curr_Stock_Price:  98.97081469674868
curr_Factors:  [9.89708147e+01 3.86575920e-02]
mat_Sqrt:  [[ 1.94591804e+01  0.00000000e+00]
 [-7.86461360e-03  1.80200936e-02]]
grads:  [0.00664883 5.33322644]
Stock Position:  0.0066488253189802195
Bond Position:  [3.18177873]


portfolio before change:  [3.83680008]
curr_Stock_Price:  98.45703182003857
curr_Factors:  [9.84570318e+01 3.86852680e-02]
mat_Sqrt:  [[ 1.93650911e+01  0.00000000e+00]
 [-7.86742835e-03  1.80265430e-02]]
grads:  [ 0.05603237 41.36882604]
Stock Position:  0.056032373884214406
Bond Position:  [-1.67998114]


portfolio before change:  [3.82325271]
curr_Stock_Price:  98.21900228839166
curr_Factors:  [9.82190023e+01 4.03331824e-02]
mat_Sqrt:  [[ 1.97254429e+01  0.00000000e+00]
 [-8.03324915e-03  1.84064861e-02]]
grads:  [6.22529473e-03 1.65651183e+01]
Stock Position:  0.006225294732411307
Bond Position:  [3.21181047]


portfolio before change:  [3.82055285]
curr_Stock_Price:  97.72081492260412
curr_Factors:  [9.77208149e+01 4.00308965e-02]
mat_Sqrt:  [[ 1.95517096e+01  0.00000000e+00]
 [-8.00308905e-03  1.83373807e-02]]
grads:  [0.01260423 6.16644958]
Stock Position:  0.012604227036981505
Bond Position:  [2.58885751]


portfolio before change:  [3.80419168]
curr_Stock_Price:  96.39706866093512
curr_Factors:  [9.63970687e+01 4.04603860e-02]
mat_Sqrt:  [[ 1.93900460e+01  0.00000000e+00]
 [-8.04590688e-03  1.84354887e-02]]
grads:  [-7.73554547e-04  9.97590721e-01]
Stock Position:  -0.0007735545469175595
Bond Position:  [3.87876007]


portfolio before change:  [3.80510126]
curr_Stock_Price:  95.84803571487289
curr_Factors:  [9.58480357e+01 4.03209929e-02]
mat_Sqrt:  [[ 1.92463698e+01  0.00000000e+00]
 [-8.03203515e-03  1.84037045e-02]]
grads:  [ 1.13071276e-03 -5.41112301e+00]
Stock Position:  0.0011307127554527289
Bond Position:  [3.69672467]


portfolio before change:  [3.80454405]
curr_Stock_Price:  94.94654293828229
curr_Factors:  [9.49465429e+01 3.95300914e-02]
mat_Sqrt:  [[ 1.88774386e+01  0.00000000e+00]
 [-7.95287032e-03  1.82223151e-02]]
grads:  [-1.73398533e-03  6.26319407e+00]
Stock Position:  -0.0017339853315807027
Bond Position:  [3.96917996]


portfolio before change:  [3.80352494]
curr_Stock_Price:  95.82042094582208
curr_Factors:  [9.58204209e+01 3.97972711e-02]
mat_Sqrt:  [[ 1.91154586e+01  0.00000000e+00]
 [-7.97970136e-03  1.82837927e-02]]
grads:  [1.57197895e-04 1.67014385e+01]
Stock Position:  0.00015719789498005096
Bond Position:  [3.78846217]


portfolio before change:  [3.80429973]
curr_Stock_Price:  97.73648763304769
curr_Factors:  [9.77364876e+01 3.90450677e-02]
mat_Sqrt:  [[ 1.93125588e+01  0.00000000e+00]
 [-7.90392993e-03  1.81101786e-02]]
grads:  [ 0.0321492  17.38925024]
Stock Position:  0.032149196043857624
Bond Position:  [0.66215023]


portfolio before change:  [3.74154627]
curr_Stock_Price:  95.78196799343583
curr_Factors:  [9.57819680e+01 3.96288118e-02]
mat_Sqrt:  [[ 1.90673036e+01  0.00000000e+00]
 [-7.96279467e-03  1.82450546e-02]]
grads:  [ 0.00578932 -2.80602295]
Stock Position:  0.005789324815609157
Bond Position:  [3.18703334]


portfolio before change:  [3.74580226]
curr_Stock_Price:  96.44829650446421
curr_Factors:  [9.64482965e+01 4.14429376e-02]
mat_Sqrt:  [[ 1.96344992e+01  0.00000000e+00]
 [-8.14301542e-03  1.86579923e-02]]
grads:  [4.80996916e-03 6.57550105e+00]
Stock Position:  0.004809969158253946
Bond Position:  [3.28188893]


portfolio before change:  [3.73991249]
curr_Stock_Price:  95.13850966996942
curr_Factors:  [9.51385097e+01 4.10330449e-02]
mat_Sqrt:  [[ 1.92718416e+01  0.00000000e+00]
 [-8.10264598e-03  1.85654943e-02]]
grads:  [0.01382468 3.76970835]
Stock Position:  0.013824681314534069
Bond Position:  [2.42465291]


portfolio before change:  [3.73878832]
curr_Stock_Price:  95.0352685498156
curr_Factors:  [9.50352685e+01 4.22823839e-02]
mat_Sqrt:  [[ 1.95417989e+01  0.00000000e+00]
 [-8.22507230e-03  1.88460082e-02]]
grads:  [0.01091178 8.17867253]
Stock Position:  0.01091178318443516
Bond Position:  [2.70178407]


portfolio before change:  [3.71412385]
curr_Stock_Price:  92.7439644222533
curr_Factors:  [9.27439644e+01 4.19607752e-02]
mat_Sqrt:  [[ 1.89979792e+01  0.00000000e+00]
 [-8.19373177e-03  1.87741980e-02]]
grads:  [-0.03115245 19.17735902]
Stock Position:  -0.031152453661852812
Bond Position:  [6.6033259]


portfolio before change:  [3.70907468]
curr_Stock_Price:  92.93254146764464
curr_Factors:  [9.29325415e+01 4.18277663e-02]
mat_Sqrt:  [[ 1.90064125e+01  0.00000000e+00]
 [-8.18073505e-03  1.87444188e-02]]
grads:  [1.85129840e-03 1.19211712e+01]
Stock Position:  0.0018512983971600103
Bond Position:  [3.53702881]


portfolio before change:  [3.71023879]
curr_Stock_Price:  93.32251523001786
curr_Factors:  [9.33225152e+01 4.08402748e-02]
mat_Sqrt:  [[ 1.88595255e+01  0.00000000e+00]
 [-8.08359076e-03  1.85218333e-02]]
grads:  [ 0.09699564 12.44417124]
Stock Position:  0.09699563767207157
Bond Position:  [-5.34163808]


portfolio before change:  [3.76808464]
curr_Stock_Price:  93.92577527227718
curr_Factors:  [9.39257753e+01 3.94178350e-02]
mat_Sqrt:  [[ 1.86479533e+01  0.00000000e+00]
 [-7.94157012e-03  1.81964231e-02]]
grads:  [1.11216308e-02 2.41955903e+01]
Stock Position:  0.011121630807876147
Bond Position:  [2.72347684]


portfolio before change:  [3.76530069]
curr_Stock_Price:  93.64484545950292
curr_Factors:  [9.36448455e+01 3.77686599e-02]
mat_Sqrt:  [[ 1.81990897e+01  0.00000000e+00]
 [-7.77366425e-03  1.78117024e-02]]
grads:  [-3.91895527e-03  1.02747099e+01]
Stock Position:  -0.003918955270137653
Bond Position:  [4.13229065]


portfolio before change:  [3.7633838]
curr_Stock_Price:  94.26579099443063
curr_Factors:  [9.42657910e+01 3.81799411e-02]
mat_Sqrt:  [[ 1.84192415e+01  0.00000000e+00]
 [-7.81587524e-03  1.79084200e-02]]
grads:  [-0.0076465   6.37337763]
Stock Position:  -0.007646502328222635
Bond Position:  [4.48418739]


portfolio before change:  [3.75130085]
curr_Stock_Price:  95.91929345297966
curr_Factors:  [9.59192935e+01 3.69799537e-02]
mat_Sqrt:  [[ 1.84454456e+01  0.00000000e+00]
 [-7.69206902e-03  1.76247443e-02]]
grads:  [ 0.00776746 -4.83287756]
Stock Position:  0.00776745983035895
Bond Position:  [3.00625159]


portfolio before change:  [3.75091166]
curr_Stock_Price:  95.82080600665306
curr_Factors:  [9.58208060e+01 3.68558255e-02]
mat_Sqrt:  [[ 1.83955548e+01  0.00000000e+00]
 [-7.67914844e-03  1.75951395e-02]]
grads:  [-1.49919025e-02 -2.57631696e+01]
Stock Position:  -0.014991902499563755
Bond Position:  [5.18744784]


portfolio before change:  [3.78489018]
curr_Stock_Price:  93.59760279306299
curr_Factors:  [9.35976028e+01 3.69557782e-02]
mat_Sqrt:  [[ 1.79930962e+01  0.00000000e+00]
 [-7.68955428e-03  1.76189823e-02]]
grads:  [ 0.00529609 -0.4895953 ]
Stock Position:  0.005296086322455439
Bond Position:  [3.28918919]


portfolio before change:  [3.78369923]
curr_Stock_Price:  93.29509271572579
curr_Factors:  [9.32950927e+01 3.68142236e-02]
mat_Sqrt:  [[ 1.79005602e+01  0.00000000e+00]
 [-7.67481320e-03  1.75852062e-02]]
grads:  [  0.02544113 -17.54282318]
Stock Position:  0.025441133534470122
Bond Position:  [1.41016632]


portfolio before change:  [3.77601002]
curr_Stock_Price:  92.98592813675461
curr_Factors:  [9.29859281e+01 3.65030427e-02]
mat_Sqrt:  [[ 1.77656771e+01  0.00000000e+00]
 [-7.64230778e-03  1.75107270e-02]]
grads:  [ -0.04036042 -17.63953191]
Stock Position:  -0.04036041834900997
Bond Position:  [7.52896098]


portfolio before change:  [3.76297544]
curr_Stock_Price:  93.33220205077681
curr_Factors:  [9.33322021e+01 3.73016136e-02]
mat_Sqrt:  [[ 1.80258321e+01  0.00000000e+00]
 [-7.72545026e-03  1.77012303e-02]]
grads:  [0.0196547  6.50682859]
Stock Position:  0.01965469604433267
Bond Position:  [1.92855937]


portfolio before change:  [3.75948899]
curr_Stock_Price:  93.14255100698082
curr_Factors:  [9.31425510e+01 3.75254955e-02]
mat_Sqrt:  [[ 1.80431079e+01  0.00000000e+00]
 [-7.74859941e-03  1.77542717e-02]]
grads:  [-3.22731803e-03  1.18962611e+01]
Stock Position:  -0.00322731802770384
Bond Position:  [4.06008962]


portfolio before change:  [3.76295667]
curr_Stock_Price:  92.22533873176691
curr_Factors:  [9.22253387e+01 3.72919970e-02]
mat_Sqrt:  [[ 1.78097605e+01  0.00000000e+00]
 [-7.72445437e-03  1.76989484e-02]]
grads:  [ 0.04003114 13.55398439]
Stock Position:  0.04003113753035073
Bond Position:  [0.07107145]


portfolio before change:  [3.78155415]
curr_Stock_Price:  92.68969215976543
curr_Factors:  [9.26896922e+01 3.64437054e-02]
mat_Sqrt:  [[ 1.76946796e+01  0.00000000e+00]
 [-7.63609381e-03  1.74964889e-02]]
grads:  [ 1.10662650e-03 -4.20007448e+00]
Stock Position:  0.0011066265021392136
Bond Position:  [3.67898128]


portfolio before change:  [3.78233905]
curr_Stock_Price:  92.98337731173875
curr_Factors:  [9.29833773e+01 3.66556965e-02]
mat_Sqrt:  [[ 1.78022975e+01  0.00000000e+00]
 [-7.65827098e-03  1.75473032e-02]]
grads:  [ 7.86501231e-03 -1.54075283e+01]
Stock Position:  0.007865012307267572
Bond Position:  [3.05102364]


portfolio before change:  [3.78249329]
curr_Stock_Price:  92.95449563358885
curr_Factors:  [9.29544956e+01 3.68339023e-02]
mat_Sqrt:  [[ 1.78399759e+01  0.00000000e+00]
 [-7.67686418e-03  1.75899056e-02]]
grads:  [0.00718373 3.5338623 ]
Stock Position:  0.007183728325992064
Bond Position:  [3.11473345]


portfolio before change:  [3.79699601]
curr_Stock_Price:  94.91912266837123
curr_Factors:  [9.49191227e+01 3.66948120e-02]
mat_Sqrt:  [[ 1.81826027e+01  0.00000000e+00]
 [-7.66235599e-03  1.75566632e-02]]
grads:  [5.79058799e-04 8.47350751e+00]
Stock Position:  0.0005790587994204784
Bond Position:  [3.74203225]


portfolio before change:  [3.79727807]
curr_Stock_Price:  94.59839587945774
curr_Factors:  [9.45983959e+01 3.67846224e-02]
mat_Sqrt:  [[ 1.81433268e+01  0.00000000e+00]
 [-7.67172705e-03  1.75781349e-02]]
grads:  [-0.02173483 -7.03459926]
Stock Position:  -0.021734827320031215
Bond Position:  [5.85335787]


portfolio before change:  [3.78553103]
curr_Stock_Price:  95.17253221985808
curr_Factors:  [9.51725322e+01 3.60349867e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.78553103]
Stock Price:  95.08588393663986
PL:  [3.78553103]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.20469049e+00  3.01257598e-01]
 [ 3.41644296e-01  1.12876991e-01]
 [ 9.66668125e-02 -2.50836573e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.00410255e-01 -9.51881708e-02]
 [-3.31380635e-01  1.58087384e-01]
 [ 1.23881490e-01 -5.43492703e-02]
 [-2.27994749e-01  3.27232024e-01]
 [-1.18012684e-01 -9.76848895e-02]
 [-1.16441871e-01 -3.70329290e-01]
 [-8.83314062e-02 -8.36361153e-03]
 [ 2.14309048e-02 -1.35842584e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-3.61108618e-02 -4.29165970e-02]
 [ 3.56702790e-01  2.19253127e-01]
 [ 1.32776497e-01 -2.87231620e-01]
 [ 3.95829173e-02  1.00417233e-01]
 [-3.48438943e-03  1.45128984e-02]
 [-8.16934168e-02 -6.14912126e-02]
 [-5.70093372e-02 -5.06807953e-02]
 [ 1.76701558e-01 -4.46870305e-02]
 [ 8.44011423e-01 -5.93796214e-03]
 [ 1.96623614e-02  1.49446337e-01]
 [-7.45585616e-02  6.72440745e-02]
 [-2.09573461e-01  2.13624416e-01]
 [ 1.24769558e-01 -1.05119781e-01]
 [-2.33426156e-01 -4.46304639e-01]
 [ 6.20006003e-02  7.02587762e-02]
 [ 4.04134850e-01 -1.95026059e-01]
 [-5.23750864e-01 -2.14488539e-01]
 [ 6.78759550e-03  5.55879491e-03]
 [-4.89651924e-02  3.74911131e-02]
 [ 1.89537186e-01  2.02952951e-01]
 [ 3.48349194e-02 -2.08894989e-02]
 [ 2.67307550e-01 -2.61436377e-01]
 [ 8.69037338e-02  7.99806086e-02]
 [-5.94443624e-02  2.29252856e-01]
 [-3.68165209e-01 -1.39011884e-01]
 [ 9.19772139e-02  3.42994466e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.32729613]
curr_Stock_Price:  100.52919928438217
curr_Factors:  [1.00529199e+02 3.90471896e-02]
mat_Sqrt:  [[ 1.98649334e+01  0.00000000e+00]
 [-7.90414470e-03  1.81106707e-02]]
grads:  [ 0.06726275 16.63425964]
Stock Position:  0.06726275176567229
Bond Position:  [-0.43457445]


portfolio before change:  [6.30686435]
curr_Stock_Price:  100.22624630203183
curr_Factors:  [1.00226246e+02 4.01927456e-02]
mat_Sqrt:  [[ 2.00934866e+01  0.00000000e+00]
 [-8.01925139e-03  1.83744133e-02]]
grads:  [0.01945446 6.14316165]
Stock Position:  0.019454456104360397
Bond Position:  [4.35701724]


portfolio before change:  [6.31239424]
curr_Stock_Price:  100.48249754652453
curr_Factors:  [1.00482498e+02 3.92178362e-02]
mat_Sqrt:  [[ 1.98990451e+01  0.00000000e+00]
 [-7.92139747e-03  1.81502018e-02]]
grads:  [ 0.00430771 -1.38200432]
Stock Position:  0.00430771460029242
Bond Position:  [5.87954432]


portfolio before change:  [6.31590523]
curr_Stock_Price:  101.12692211914161
curr_Factors:  [1.01126922e+02 3.74717381e-02]
mat_Sqrt:  [[ 1.95757635e+01  0.00000000e+00]
 [-7.74304727e-03  1.77415501e-02]]
grads:  [-8.32732118e-04 -8.53289659e+00]
Stock Position:  -0.0008327321176204915
Bond Position:  [6.40011686]


portfolio before change:  [6.31684623]
curr_Stock_Price:  100.95767158332312
curr_Factors:  [1.00957672e+02 3.68192883e-02]
mat_Sqrt:  [[ 1.93721142e+01  0.00000000e+00]
 [-7.67534111e-03  1.75864158e-02]]
grads:  [-0.00732774 -5.41259639]
Stock Position:  -0.007327738059592441
Bond Position:  [7.05663761]


portfolio before change:  [6.31417742]
curr_Stock_Price:  101.44226182004287
curr_Factors:  [1.01442262e+02 3.50727977e-02]
mat_Sqrt:  [[ 1.89978358e+01  0.00000000e+00]
 [-7.49109313e-03  1.71642507e-02]]
grads:  [-0.01381134  9.2102701 ]
Stock Position:  -0.013811343947808379
Bond Position:  [7.71523139]


portfolio before change:  [6.32244667]
curr_Stock_Price:  100.91336382019789
curr_Factors:  [1.00913364e+02 3.60781131e-02]
mat_Sqrt:  [[ 1.91677259e+01  0.00000000e+00]
 [-7.59769576e-03  1.74085080e-02]]
grads:  [ 0.00522553 -3.12199474]
Stock Position:  0.00522552986197131
Bond Position:  [5.79512088]


portfolio before change:  [6.32795588]
curr_Stock_Price:  101.8290162046318
curr_Factors:  [1.01829016e+02 3.69613505e-02]
mat_Sqrt:  [[ 1.95769695e+01  0.00000000e+00]
 [-7.69013399e-03  1.76203106e-02]]
grads:  [-4.35097914e-03  1.85712972e+01]
Stock Position:  -0.004350979140124993
Bond Position:  [6.7710118]


portfolio before change:  [6.3289261]
curr_Stock_Price:  101.80056375981883
curr_Factors:  [1.01800564e+02 3.67274242e-02]
mat_Sqrt:  [[ 1.95094676e+01  0.00000000e+00]
 [-7.66576015e-03  1.75644631e-02]]
grads:  [-0.00823425 -5.56150729]
Stock Position:  -0.008234251618834947
Bond Position:  [7.16717756]


portfolio before change:  [6.32678369]
curr_Stock_Price:  102.169554951111
curr_Factors:  [1.02169555e+02 3.66779992e-02]
mat_Sqrt:  [[ 1.95670034e+01  0.00000000e+00]
 [-7.66060042e-03  1.75526406e-02]]
grads:  [-1.42110071e-02 -2.10982095e+01]
Stock Position:  -0.014211007058862087
Bond Position:  [7.77871596]


portfolio before change:  [6.34942548]
curr_Stock_Price:  100.64472378820155
curr_Factors:  [1.00644724e+02 3.68648036e-02]
mat_Sqrt:  [[ 1.93239976e+01  0.00000000e+00]
 [-7.68008370e-03  1.75972825e-02]]
grads:  [-0.00475997 -0.47527859]
Stock Position:  -0.004759966729492622
Bond Position:  [6.82849101]


portfolio before change:  [6.35284905]
curr_Stock_Price:  100.10481282286607
curr_Factors:  [1.00104813e+02 3.67808097e-02]
mat_Sqrt:  [[ 1.91984250e+01  0.00000000e+00]
 [-7.67132945e-03  1.75772240e-02]]
grads:  [-1.97181067e-03 -7.72832980e+00]
Stock Position:  -0.001971810671956943
Bond Position:  [6.55023679]


portfolio before change:  [6.35544321]
curr_Stock_Price:  99.20445822904624
curr_Factors:  [9.92044582e+01 3.69465244e-02]
mat_Sqrt:  [[ 1.90685638e+01  0.00000000e+00]
 [-7.68859149e-03  1.76167762e-02]]
grads:  [-0.00678336 -1.59231205]
Stock Position:  -0.006783357640722764
Bond Position:  [7.02838253]


portfolio before change:  [6.34136297]
curr_Stock_Price:  101.40968522427467
curr_Factors:  [1.01409685e+02 3.72067812e-02]
mat_Sqrt:  [[ 1.95609744e+01  0.00000000e+00]
 [-7.71562375e-03  1.76787149e-02]]
grads:  [-0.0028036  -2.42758578]
Stock Position:  -0.0028036026859824567
Bond Position:  [6.62567544]


portfolio before change:  [6.34275987]
curr_Stock_Price:  101.20686113726707
curr_Factors:  [1.01206861e+02 3.73653627e-02]
mat_Sqrt:  [[ 1.95634100e+01  0.00000000e+00]
 [-7.73204891e-03  1.77163497e-02]]
grads:  [ 0.02312443 12.37575071]
Stock Position:  0.023124429743971407
Bond Position:  [4.00240892]


portfolio before change:  [6.32459349]
curr_Stock_Price:  100.39963195107775
curr_Factors:  [1.00399632e+02 3.78764465e-02]
mat_Sqrt:  [[ 1.95396480e+01  0.00000000e+00]
 [-7.78474884e-03  1.78371004e-02]]
grads:  [ 3.79655790e-04 -1.61030444e+01]
Stock Position:  0.00037965578981456467
Bond Position:  [6.28647618]


portfolio before change:  [6.32500672]
curr_Stock_Price:  99.41814880836458
curr_Factors:  [9.94181488e+01 3.71351455e-02]
mat_Sqrt:  [[ 1.91583559e+01  0.00000000e+00]
 [-7.70819258e-03  1.76616880e-02]]
grads:  [4.35364031e-03 5.68559658e+00]
Stock Position:  0.004353640310107204
Bond Position:  [5.89217586]


portfolio before change:  [6.32322075]
curr_Stock_Price:  98.83873971451531
curr_Factors:  [9.88387397e+01 3.77959750e-02]
mat_Sqrt:  [[ 1.92154242e+01  0.00000000e+00]
 [-7.77647478e-03  1.78181422e-02]]
grads:  [1.48295384e-04 8.14501212e-01]
Stock Position:  0.0001482953841275498
Bond Position:  [6.30856342]


portfolio before change:  [6.32385947]
curr_Stock_Price:  97.827959735839
curr_Factors:  [9.78279597e+01 3.81113256e-02]
mat_Sqrt:  [[ 1.90980939e+01  0.00000000e+00]
 [-7.80884889e-03  1.78923206e-02]]
grads:  [-0.00568279 -3.4367377 ]
Stock Position:  -0.005682786087263435
Bond Position:  [6.87979484]


portfolio before change:  [6.31043573]
curr_Stock_Price:  100.341476346891
curr_Factors:  [1.00341476e+02 3.63292757e-02]
mat_Sqrt:  [[ 1.91253264e+01  0.00000000e+00]
 [-7.62409609e-03  1.74689987e-02]]
grads:  [-0.00413735 -2.9011849 ]
Stock Position:  -0.004137354198584711
Bond Position:  [6.72558395]


portfolio before change:  [6.31491762]
curr_Stock_Price:  99.46141153269905
curr_Factors:  [9.94614115e+01 3.63960623e-02]
mat_Sqrt:  [[ 1.89750015e+01  0.00000000e+00]
 [-7.63110082e-03  1.74850486e-02]]
grads:  [ 0.00828451 -2.55572813]
Stock Position:  0.00828450731110028
Bond Position:  [5.49092882]


portfolio before change:  [6.3186642]
curr_Stock_Price:  99.83079718358486
curr_Factors:  [9.98307972e+01 3.54401542e-02]
mat_Sqrt:  [[ 1.87937022e+01  0.00000000e+00]
 [-7.53022223e-03  1.72539067e-02]]
grads:  [ 0.04477137 -0.34415175]
Stock Position:  0.04477137475533186
Bond Position:  [1.84910217]


portfolio before change:  [6.23733902]
curr_Stock_Price:  98.00917924112868
curr_Factors:  [9.80091792e+01 3.59228993e-02]
mat_Sqrt:  [[ 1.85760103e+01  0.00000000e+00]
 [-7.58133490e-03  1.73710205e-02]]
grads:  [4.56966211e-03 8.60319848e+00]
Stock Position:  0.004569662110278581
Bond Position:  [5.78947018]


portfolio before change:  [6.24064124]
curr_Stock_Price:  98.57344412140573
curr_Factors:  [9.85734441e+01 3.62818392e-02]
mat_Sqrt:  [[ 1.87760649e+01  0.00000000e+00]
 [-7.61911693e-03  1.74575900e-02]]
grads:  [-2.40789759e-03  3.85185323e+00]
Stock Position:  -0.0024078975903369802
Bond Position:  [6.477996]


portfolio before change:  [6.24424036]
curr_Stock_Price:  97.41503944986096
curr_Factors:  [9.74150394e+01 3.65734430e-02]
mat_Sqrt:  [[ 1.86298318e+01  0.00000000e+00]
 [-7.64967377e-03  1.75276045e-02]]
grads:  [-6.24482947e-03  1.21878843e+01]
Stock Position:  -0.006244829470790017
Bond Position:  [6.85258067]


portfolio before change:  [6.24274773]
curr_Stock_Price:  97.79123255171332
curr_Factors:  [9.77912326e+01 3.71144630e-02]
mat_Sqrt:  [[ 1.88395928e+01  0.00000000e+00]
 [-7.70604573e-03  1.76567689e-02]]
grads:  [ 4.18753875e-03 -5.95351174e+00]
Stock Position:  0.0041875387495854425
Bond Position:  [5.83324315]


portfolio before change:  [6.2425912]
curr_Stock_Price:  97.57971803977989
curr_Factors:  [9.7579718e+01 3.6613221e-02]
mat_Sqrt:  [[ 1.86714707e+01  0.00000000e+00]
 [-7.65383261e-03  1.75371336e-02]]
grads:  [-2.29338908e-02 -2.54491211e+01]
Stock Position:  -0.022933890772103237
Bond Position:  [8.4804738]


portfolio before change:  [6.25391525]
curr_Stock_Price:  97.13217416754073
curr_Factors:  [9.71321742e+01 3.58472536e-02]
mat_Sqrt:  [[ 1.83903949e+01  0.00000000e+00]
 [-7.57334839e-03  1.73527211e-02]]
grads:  [0.00503872 4.04886218]
Stock Position:  0.0050387196575355135
Bond Position:  [5.76449346]


portfolio before change:  [6.24802236]
curr_Stock_Price:  95.81963904483854
curr_Factors:  [9.58196390e+01 3.79389756e-02]
mat_Sqrt:  [[ 1.86636822e+01  0.00000000e+00]
 [-7.79117199e-03  1.78518177e-02]]
grads:  [  0.01709301 -10.92471716]
Stock Position:  0.017093009651048135
Bond Position:  [4.61017635]


portfolio before change:  [6.25384925]
curr_Stock_Price:  96.1268159498522
curr_Factors:  [9.61268159e+01 3.84608317e-02]
mat_Sqrt:  [[ 1.88518464e+01  0.00000000e+00]
 [-7.84457333e-03  1.79741755e-02]]
grads:  [ -0.03274806 -11.93315034]
Stock Position:  -0.03274805682311003
Bond Position:  [9.40181568]


portfolio before change:  [6.25544144]
curr_Stock_Price:  96.11408553575828
curr_Factors:  [9.61140855e+01 3.85966416e-02]
mat_Sqrt:  [[ 1.88826002e+01  0.00000000e+00]
 [-7.85841120e-03  1.80058821e-02]]
grads:  [0.00048794 0.30872105]
Stock Position:  0.0004879440552979375
Bond Position:  [6.20854315]


portfolio before change:  [6.25635696]
curr_Stock_Price:  96.39976526237817
curr_Factors:  [9.63997653e+01 3.83740943e-02]
mat_Sqrt:  [[ 1.88840458e+01  0.00000000e+00]
 [-7.83572275e-03  1.79538963e-02]]
grads:  [-1.72646950e-03  2.08818813e+00]
Stock Position:  -0.0017264695004538407
Bond Position:  [6.42278821]


portfolio before change:  [6.25735982]
curr_Stock_Price:  96.28394316055096
curr_Factors:  [9.62839432e+01 4.04616840e-02]
mat_Sqrt:  [[ 1.93676017e+01  0.00000000e+00]
 [-8.04603594e-03  1.84357844e-02]]
grads:  [ 0.01435971 11.00864206]
Stock Position:  0.014359708568971192
Bond Position:  [4.87475046]


portfolio before change:  [6.2409256]
curr_Stock_Price:  95.09703851914202
curr_Factors:  [9.50970385e+01 4.16448395e-02]
mat_Sqrt:  [[ 1.94065166e+01  0.00000000e+00]
 [-8.16282691e-03  1.87033861e-02]]
grads:  [ 0.00132522 -1.11688326]
Stock Position:  0.0013252246722647671
Bond Position:  [6.11490065]


portfolio before change:  [6.23907631]
curr_Stock_Price:  93.12476826322663
curr_Factors:  [9.31247683e+01 4.33105406e-02]
mat_Sqrt:  [[ 1.93803675e+01  0.00000000e+00]
 [-8.32447385e-03  1.90737658e-02]]
grads:  [ 7.90528668e-03 -1.37065947e+01]
Stock Position:  0.007905286675049432
Bond Position:  [5.50289832]


portfolio before change:  [6.24658879]
curr_Stock_Price:  93.98806145516565
curr_Factors:  [9.39880615e+01 4.24816694e-02]
mat_Sqrt:  [[ 1.93719562e+01  0.00000000e+00]
 [-8.24443273e-03  1.88903685e-02]]
grads:  [0.00628796 4.23393586]
Stock Position:  0.006287962433571356
Bond Position:  [5.65559539]


portfolio before change:  [6.24747801]
curr_Stock_Price:  94.01704115756631
curr_Factors:  [9.40170412e+01 4.24460340e-02]
mat_Sqrt:  [[ 1.93698001e+01  0.00000000e+00]
 [-8.24097412e-03  1.88824438e-02]]
grads:  [2.09655167e-03 1.21410585e+01]
Stock Position:  0.002096551668081094
Bond Position:  [6.05036642]


portfolio before change:  [6.24509139]
curr_Stock_Price:  92.51793135073795
curr_Factors:  [9.25179314e+01 4.30217985e-02]
mat_Sqrt:  [[ 1.91897888e+01  0.00000000e+00]
 [-8.29667871e-03  1.90100791e-02]]
grads:  [-0.02234704 -7.3125358 ]
Stock Position:  -0.02234703955131134
Bond Position:  [8.31259326]


portfolio before change:  [6.22461413]
curr_Stock_Price:  93.48076106660001
curr_Factors:  [9.34807611e+01 4.29071911e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.22461413]
Stock Price:  95.24392735263095
PL:  [6.22461413]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.11153505e+00  2.80197020e-01]
 [ 1.66509475e-01  8.22752571e-02]
 [-3.34184910e-01 -1.41668567e-01]
 [-2.71475387e-01 -7.98871294e-02]
 [-1.28267081e-01 -9.68765440e-01]
 [-3.48651363e-01  1.98805567e-01]
 [ 2.96037518e-01 -3.40069139e-01]
 [-5.41619126e-01  2.43454376e-01]
 [-1.18219330e-01 -9.86185227e-02]
 [-2.35903018e-01 -5.02116939e-01]
 [-6.33038669e-02 -1.39541220e-02]
 [-3.70394654e-02 -1.33971887e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-1.38062527e-02 -1.01710142e-01]
 [ 1.87654182e-01  1.06058199e-01]
 [ 1.24899568e-01 -5.98705026e-01]
 [ 3.06161330e-02 -1.26036495e-01]
 [ 3.02429291e-02 -1.51577723e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-4.46003339e-03 -8.14452765e-02]
 [ 1.76689275e-01 -4.46819916e-02]
 [ 1.02654243e+00  8.54736822e-02]
 [ 2.33057431e-02 -5.43594166e-02]
 [ 1.42863189e-02  2.41427160e-02]
 [ 1.58873840e-01 -7.81061402e-02]
 [ 1.57089350e-01 -9.38778053e-02]
 [ 7.27778175e-02 -1.28088227e-01]
 [ 5.41988689e-02  2.43372337e-01]
 [-4.50430314e-02  1.96140168e-01]
 [-6.52143713e-01 -6.00589423e-02]
 [-1.68006499e-01 -6.32032865e-02]
 [ 9.49498943e-03 -7.00690538e-02]
 [-2.43037346e-01  1.36697732e-01]
 [ 5.83941208e-02  5.78491789e-02]
 [-4.81095293e-02  7.85114196e-02]
 [-1.20426784e-01  1.16335118e-01]
 [-3.88727747e-02 -7.78443046e-02]
 [-7.86550406e-02 -5.32031778e-02]
 [ 6.26664619e-02 -1.19038382e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.14701236]
curr_Stock_Price:  100.93849509565904
curr_Factors:  [1.00938495e+02 4.01982888e-02]
mat_Sqrt:  [[ 2.02376746e+01  0.00000000e+00]
 [-8.01980437e-03  1.83756803e-02]]
grads:  [ 0.06096664 15.2482529 ]
Stock Position:  0.06096664176909291
Bond Position:  [2.99313129]


portfolio before change:  [9.13212145]
curr_Stock_Price:  100.68811109796214
curr_Factors:  [1.00688111e+02 3.97359059e-02]
mat_Sqrt:  [[ 2.00710343e+01  0.00000000e+00]
 [-7.97354686e-03  1.82696910e-02]]
grads:  [0.01008505 4.50337431]
Stock Position:  0.010085047859745844
Bond Position:  [8.11667703]


portfolio before change:  [9.14795651]
curr_Stock_Price:  102.15765419067175
curr_Factors:  [1.02157654e+02 4.05380509e-02]
mat_Sqrt:  [[ 2.05684869e+01  0.00000000e+00]
 [-8.05362536e-03  1.84531739e-02]]
grads:  [-0.01925344 -7.67719243]
Stock Position:  -0.019253440692276136
Bond Position:  [11.11484285]


portfolio before change:  [9.1038053]
curr_Stock_Price:  104.52297980634243
curr_Factors:  [1.04522980e+02 3.89488516e-02]
mat_Sqrt:  [[ 2.06280944e+01  0.00000000e+00]
 [-7.89418537e-03  1.80878510e-02]]
grads:  [-0.01485067 -4.41661806]
Stock Position:  -0.014850668333602624
Bond Position:  [10.65604141]


portfolio before change:  [9.09954248]
curr_Stock_Price:  104.89972454682804
curr_Factors:  [1.04899725e+02 3.94513138e-02]
mat_Sqrt:  [[ 2.08355555e+01  0.00000000e+00]
 [-7.94494192e-03  1.82041489e-02]]
grads:  [-2.6448586e-02 -5.3216739e+01]
Stock Position:  -0.026448586041868647
Bond Position:  [11.87399187]


portfolio before change:  [9.11523191]
curr_Stock_Price:  104.3626415087904
curr_Factors:  [1.04362642e+02 3.87675534e-02]
mat_Sqrt:  [[ 2.05484591e+01  0.00000000e+00]
 [-7.87579110e-03  1.80457044e-02]]
grads:  [-0.01274478 11.01678061]
Stock Position:  -0.012744775633246486
Bond Position:  [10.44531036]


portfolio before change:  [9.13218674]
curr_Stock_Price:  103.13475860895134
curr_Factors:  [1.03134759e+02 3.84714405e-02]
mat_Sqrt:  [[ 2.02289938e+01  0.00000000e+00]
 [-7.84565516e-03  1.79766543e-02]]
grads:  [ 7.29740586e-03 -1.89172653e+01]
Stock Position:  0.007297405864357323
Bond Position:  [8.37957055]


portfolio before change:  [9.13009328]
curr_Stock_Price:  102.70433582151095
curr_Factors:  [1.02704336e+02 3.93053445e-02]
mat_Sqrt:  [[ 2.03617257e+01  0.00000000e+00]
 [-7.93023021e-03  1.81704401e-02]]
grads:  [-0.02138163 13.3983753 ]
Stock Position:  -0.02138163205138052
Bond Position:  [11.3260796]


portfolio before change:  [9.13099325]
curr_Stock_Price:  102.7284630440189
curr_Factors:  [1.02728463e+02 3.88071919e-02]
mat_Sqrt:  [[ 2.02370358e+01  0.00000000e+00]
 [-7.87981644e-03  1.80549276e-02]]
grads:  [-0.00796856 -5.46213891]
Stock Position:  -0.007968557453965354
Bond Position:  [9.94959091]


portfolio before change:  [9.13074573]
curr_Stock_Price:  102.91561071437383
curr_Factors:  [1.02915611e+02 3.89838251e-02]
mat_Sqrt:  [[ 2.03199896e+01  0.00000000e+00]
 [-7.89772879e-03  1.80959700e-02]]
grads:  [-2.23939493e-02 -2.77474454e+01]
Stock Position:  -0.022393949302003262
Bond Position:  [11.4354327]


portfolio before change:  [9.13894773]
curr_Stock_Price:  102.61318612821783
curr_Factors:  [1.02613186e+02 3.95110080e-02]
mat_Sqrt:  [[ 2.03968089e+01  0.00000000e+00]
 [-7.95095043e-03  1.82179161e-02]]
grads:  [-0.0034022  -0.76595599]
Stock Position:  -0.0034021961634516833
Bond Position:  [9.48805792]


portfolio before change:  [9.1408415]
curr_Stock_Price:  102.40517810363185
curr_Factors:  [1.02405178e+02 3.96091699e-02]
mat_Sqrt:  [[ 2.03807324e+01  0.00000000e+00]
 [-7.96082105e-03  1.82405325e-02]]
grads:  [-4.68626879e-03 -7.34473549e+00]
Stock Position:  -0.004686268791617366
Bond Position:  [9.62073969]


portfolio before change:  [9.1441305]
curr_Stock_Price:  101.95997575957938
curr_Factors:  [1.01959976e+02 3.95471319e-02]
mat_Sqrt:  [[ 2.02762305e+01  0.00000000e+00]
 [-7.95458428e-03  1.82262423e-02]]
grads:  [-0.00323085 -0.98155191]
Stock Position:  -0.0032308530426245676
Bond Position:  [9.4735482]


portfolio before change:  [9.14426392]
curr_Stock_Price:  102.28522994635283
curr_Factors:  [1.02285230e+02 4.09042039e-02]
mat_Sqrt:  [[ 2.06869706e+01  0.00000000e+00]
 [-8.08991509e-03  1.85363241e-02]]
grads:  [-2.81318125e-03 -5.48707184e+00]
Stock Position:  -0.0028131812512209244
Bond Position:  [9.43201081]


portfolio before change:  [9.14401593]
curr_Stock_Price:  102.79250811827366
curr_Factors:  [1.02792508e+02 3.93603001e-02]
mat_Sqrt:  [[ 2.03934482e+01  0.00000000e+00]
 [-7.93577219e-03  1.81831384e-02]]
grads:  [0.01147142 5.83277742]
Stock Position:  0.01147141829388925
Bond Position:  [7.96484007]


portfolio before change:  [9.14373637]
curr_Stock_Price:  102.68134196331289
curr_Factors:  [1.02681342e+02 3.90784815e-02]
mat_Sqrt:  [[ 2.02983331e+01  0.00000000e+00]
 [-7.90731120e-03  1.81179261e-02]]
grads:  [-6.71960236e-03 -3.30448984e+01]
Stock Position:  -0.00671960236484182
Bond Position:  [9.83371415]


portfolio before change:  [9.14801186]
curr_Stock_Price:  102.22801059798918
curr_Factors:  [1.02228011e+02 3.78584527e-02]
mat_Sqrt:  [[ 1.98907583e+01  0.00000000e+00]
 [-7.78289949e-03  1.78328630e-02]]
grads:  [-1.22623295e-03 -7.06765342e+00]
Stock Position:  -0.0012262329469482059
Bond Position:  [9.27336722]


portfolio before change:  [9.14948502]
curr_Stock_Price:  101.97201228066994
curr_Factors:  [1.01972012e+02 3.78648851e-02]
mat_Sqrt:  [[ 1.98426335e+01  0.00000000e+00]
 [-7.78356063e-03  1.78343779e-02]]
grads:  [-1.80979066e-03 -8.49918758e+00]
Stock Position:  -0.0018097906595007322
Bond Position:  [9.33403302]


portfolio before change:  [9.15298951]
curr_Stock_Price:  100.68033533476124
curr_Factors:  [1.00680335e+02 3.93047993e-02]
mat_Sqrt:  [[ 1.99603175e+01  0.00000000e+00]
 [-7.93017521e-03  1.81703141e-02]]
grads:  [-1.59703444e-02 -2.58271619e+01]
Stock Position:  -0.015970344391171967
Bond Position:  [10.76088914]


portfolio before change:  [9.14012852]
curr_Stock_Price:  101.56987097432476
curr_Factors:  [1.01569871e+02 3.90775613e-02]
mat_Sqrt:  [[ 2.00783781e+01  0.00000000e+00]
 [-7.90721810e-03  1.81177127e-02]]
grads:  [-1.99247499e-03 -4.49533987e+00]
Stock Position:  -0.001992474993834916
Bond Position:  [9.34250395]


portfolio before change:  [9.1457923]
curr_Stock_Price:  99.31343232961143
curr_Factors:  [9.93134323e+01 4.02154089e-02]
mat_Sqrt:  [[ 1.99160971e+01  0.00000000e+00]
 [-8.02151197e-03  1.83795929e-02]]
grads:  [ 0.00789253 -2.43106536]
Stock Position:  0.007892533068496141
Bond Position:  [8.36195775]


portfolio before change:  [9.14135436]
curr_Stock_Price:  98.61869267448101
curr_Factors:  [9.86186927e+01 4.03663618e-02]
mat_Sqrt:  [[ 1.98138580e+01  0.00000000e+00]
 [-8.03655267e-03  1.84140555e-02]]
grads:  [0.05369203 4.64176305]
Stock Position:  0.05369202758634392
Bond Position:  [3.84631679]


portfolio before change:  [9.17058442]
curr_Stock_Price:  99.15413989359546
curr_Factors:  [9.91541399e+01 4.03322808e-02]
mat_Sqrt:  [[ 1.99130252e+01  0.00000000e+00]
 [-8.03315935e-03  1.84062804e-02]]
grads:  [-2.10239940e-05 -2.95330808e+00]
Stock Position:  -2.102399403053468e-05
Bond Position:  [9.17266904]


portfolio before change:  [9.17170224]
curr_Stock_Price:  100.52557932056524
curr_Factors:  [1.00525579e+02 4.10420538e-02]
mat_Sqrt:  [[ 2.03653148e+01  0.00000000e+00]
 [-8.10353541e-03  1.85675322e-02]]
grads:  [1.21888929e-03 1.30026520e+00]
Stock Position:  0.0012188892852222108
Bond Position:  [9.04917269]


portfolio before change:  [9.17252745]
curr_Stock_Price:  100.27452492426512
curr_Factors:  [1.00274525e+02 3.94920357e-02]
mat_Sqrt:  [[ 1.99271584e+01  0.00000000e+00]
 [-7.94904127e-03  1.82135417e-02]]
grads:  [ 0.00626208 -4.28835542]
Stock Position:  0.0062620832704105185
Bond Position:  [8.54460003]


portfolio before change:  [9.17180489]
curr_Stock_Price:  99.9885652006295
curr_Factors:  [9.99885652e+01 3.99647381e-02]
mat_Sqrt:  [[ 1.99888966e+01  0.00000000e+00]
 [-7.99647303e-03  1.83222215e-02]]
grads:  [ 0.00580911 -5.12371305]
Stock Position:  0.005809110883341679
Bond Position:  [8.59096023]


portfolio before change:  [9.17568916]
curr_Stock_Price:  100.47234453477176
curr_Factors:  [1.00472345e+02 4.10423147e-02]
mat_Sqrt:  [[ 2.03545947e+01  0.00000000e+00]
 [-8.10356116e-03  1.85675912e-02]]
grads:  [ 8.29077276e-04 -6.89848382e+00]
Stock Position:  0.0008290772755699945
Bond Position:  [9.09238982]


portfolio before change:  [9.17714612]
curr_Stock_Price:  100.85873234424496
curr_Factors:  [1.00858732e+02 4.00445602e-02]
mat_Sqrt:  [[ 2.01829791e+01  0.00000000e+00]
 [-8.00445478e-03  1.83405100e-02]]
grads:  [7.94804693e-03 1.32696603e+01]
Stock Position:  0.007948046930681928
Bond Position:  [8.37551618]


portfolio before change:  [9.19507458]
curr_Stock_Price:  102.9827071194173
curr_Factors:  [1.02982707e+02 3.84235137e-02]
mat_Sqrt:  [[ 2.01865844e+01  0.00000000e+00]
 [-7.84076667e-03  1.79654534e-02]]
grads:  [2.00923321e-03 1.09176297e+01]
Stock Position:  0.002009233214282268
Bond Position:  [8.9881583]


portfolio before change:  [9.1961872]
curr_Stock_Price:  102.97724897878587
curr_Factors:  [1.02977249e+02 3.97104614e-02]
mat_Sqrt:  [[ 2.05207747e+01  0.00000000e+00]
 [-7.97099355e-03  1.82638407e-02]]
grads:  [-0.03305702 -3.28840705]
Stock Position:  -0.033057016344436856
Bond Position:  [12.6003078]


portfolio before change:  [9.29120925]
curr_Stock_Price:  100.15040861511439
curr_Factors:  [1.00150409e+02 4.23319798e-02]
mat_Sqrt:  [[ 2.06056831e+01  0.00000000e+00]
 [-8.22989476e-03  1.88570578e-02]]
grads:  [-0.00949207 -3.35170455]
Stock Position:  -0.009492074294710343
Bond Position:  [10.24184437]


portfolio before change:  [9.28905975]
curr_Stock_Price:  100.51174212316187
curr_Factors:  [1.00511742e+02 4.31191847e-02]
mat_Sqrt:  [[ 2.08714235e+01  0.00000000e+00]
 [-8.30606378e-03  1.90315830e-02]]
grads:  [-1.01026424e-03 -3.68172494e+00]
Stock Position:  -0.0010102642369735374
Bond Position:  [9.39060317]


portfolio before change:  [9.29016883]
curr_Stock_Price:  100.57590675259793
curr_Factors:  [1.00575907e+02 4.24707912e-02]
mat_Sqrt:  [[ 2.07271282e+01  0.00000000e+00]
 [-8.24337710e-03  1.88879498e-02]]
grads:  [-0.00884722  7.23729856]
Stock Position:  -0.008847224924824983
Bond Position:  [10.1799865]


portfolio before change:  [9.29210505]
curr_Stock_Price:  100.50089463549713
curr_Factors:  [1.00500895e+02 4.13573833e-02]
mat_Sqrt:  [[ 2.04383793e+01  0.00000000e+00]
 [-8.13460591e-03  1.86387237e-02]]
grads:  [0.00409238 3.10370924]
Stock Position:  0.004092377931095337
Bond Position:  [8.88081741]


portfolio before change:  [9.28975171]
curr_Stock_Price:  99.65456221238706
curr_Factors:  [9.96545622e+01 4.06979510e-02]
mat_Sqrt:  [[ 2.01040455e+01  0.00000000e+00]
 [-8.06949327e-03  1.84895319e-02]]
grads:  [-6.88634366e-04  4.24626325e+00]
Stock Position:  -0.0006886343656895885
Bond Position:  [9.35837727]


portfolio before change:  [9.29174032]
curr_Stock_Price:  98.46563719931349
curr_Factors:  [9.84656372e+01 4.05915879e-02]
mat_Sqrt:  [[ 1.98382206e+01  0.00000000e+00]
 [-8.05894165e-03  1.84653551e-02]]
grads:  [-3.51109999e-03  6.30018309e+00]
Stock Position:  -0.0035110999873296557
Bond Position:  [9.63746302]


portfolio before change:  [9.29480295]
curr_Stock_Price:  97.93649581971388
curr_Factors:  [9.79364958e+01 4.07232256e-02]
mat_Sqrt:  [[ 1.97635814e+01  0.00000000e+00]
 [-8.07199857e-03  1.84952722e-02]]
grads:  [-3.68591164e-03 -4.20887585e+00]
Stock Position:  -0.003685911637628163
Bond Position:  [9.65578822]


portfolio before change:  [9.29388449]
curr_Stock_Price:  98.51315214816803
curr_Factors:  [9.85131521e+01 4.00878610e-02]
mat_Sqrt:  [[ 1.97242572e+01  0.00000000e+00]
 [-8.00878129e-03  1.83504232e-02]]
grads:  [-0.00516495 -2.89928887]
Stock Position:  -0.005164950436471001
Bond Position:  [9.80270004]


portfolio before change:  [9.29155621]
curr_Stock_Price:  99.20119298960654
curr_Factors:  [9.92011930e+01 3.98527538e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.29155621]
Stock Price:  100.083328258341
PL:  [9.20822795]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.23951356e+00  3.09130398e-01]
 [ 3.44213266e-01  1.13181789e-01]
 [ 8.54441623e-02 -2.92563162e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.72894717e-02  9.70515871e-02]
 [-2.73880905e-01  9.43079146e-02]
 [ 1.33255561e-01 -8.26571899e-02]
 [ 3.26008753e-01  4.76445532e-01]
 [-1.18072934e-01 -9.79570978e-02]
 [ 1.23278682e-01 -3.02932549e-02]
 [-8.90136410e-02 -8.19316985e-03]
 [-7.13231715e-03 -1.36277790e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.63462117e-02 -3.53818616e-02]
 [ 5.02723628e-01  3.27080246e-01]
 [ 1.30070311e-01  1.10038623e-01]
 [ 4.03103367e-02  1.27552099e-01]
 [ 1.81559859e-01  7.61451763e-02]
 [-6.05124638e-02 -4.18031185e-02]
 [-4.10348212e-01  1.63367177e-01]
 [ 1.16415603e-01  5.36988727e-02]
 [ 1.35011241e+00  1.44835864e-01]
 [ 1.62430517e-02  3.76984513e-01]
 [-1.38905714e-01  1.34666585e-01]
 [-1.78411585e-01  1.63011126e-01]
 [ 1.50218527e-01 -9.59838671e-02]
 [-1.12839682e-02 -3.23380626e-01]
 [ 4.70785236e-02  1.04681200e-01]
 [ 1.60079280e-01  4.42861114e-02]
 [-5.31325589e-01 -1.78188961e-01]
 [-8.69813583e-02 -2.90616014e-02]
 [-3.22244390e-03 -4.10055609e-02]
 [ 1.60632671e-01  2.00403018e-01]
 [ 1.21521268e-02  6.08280723e-04]
 [ 8.83420406e-02 -5.47602166e-02]
 [ 3.34443033e-02  1.17190210e-01]
 [-4.60761608e-02  7.15001324e-03]
 [-2.55868964e-01 -9.96608294e-02]
 [ 1.33223884e-01 -3.80322334e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.30064934]
curr_Stock_Price:  100.38017640482575
curr_Factors:  [1.00380176e+02 3.97545601e-02]
mat_Sqrt:  [[ 2.00143473e+01  0.00000000e+00]
 [-7.97541824e-03  1.82739789e-02]]
grads:  [ 0.06867219 16.91642523]
Stock Position:  0.0686721936982842
Bond Position:  [-1.59267758]


portfolio before change:  [5.28965378]
curr_Stock_Price:  100.22295914953848
curr_Factors:  [1.00222959e+02 3.90008695e-02]
mat_Sqrt:  [[ 1.97926692e+01  0.00000000e+00]
 [-7.89945512e-03  1.80999255e-02]]
grads:  [0.01988665 6.25316324]
Stock Position:  0.019886648153907973
Bond Position:  [3.29655506]


portfolio before change:  [5.2965718]
curr_Stock_Price:  100.5501091740271
curr_Factors:  [1.00550109e+02 3.87873313e-02]
mat_Sqrt:  [[ 1.98028408e+01  0.00000000e+00]
 [-7.87779983e-03  1.80503070e-02]]
grads:  [ 0.00366996 -1.62082098]
Stock Position:  0.0036699612854777437
Bond Position:  [4.92755679]


portfolio before change:  [5.29350073]
curr_Stock_Price:  99.5454517650235
curr_Factors:  [9.95454518e+01 3.77424754e-02]
mat_Sqrt:  [[ 1.93391157e+01  0.00000000e+00]
 [-7.77096909e-03  1.78055270e-02]]
grads:  [-8.42922044e-04 -8.50223709e+00]
Stock Position:  -0.0008429220439622388
Bond Position:  [5.37740978]


portfolio before change:  [5.29360935]
curr_Stock_Price:  100.21406793483145
curr_Factors:  [1.00214068e+02 3.87207012e-02]
mat_Sqrt:  [[ 1.97196998e+01  0.00000000e+00]
 [-7.87103055e-03  1.80347966e-02]]
grads:  [-2.27856849e-03  5.38135189e+00]
Stock Position:  -0.0022785684921152504
Bond Position:  [5.52195397]


portfolio before change:  [5.29253007]
curr_Stock_Price:  100.99068284022698
curr_Factors:  [1.00990683e+02 3.96185652e-02]
mat_Sqrt:  [[ 2.01016025e+01  0.00000000e+00]
 [-7.96176515e-03  1.82426957e-02]]
grads:  [-0.01157726  5.16962602]
Stock Position:  -0.01157726391528081
Bond Position:  [6.46172586]


portfolio before change:  [5.29245934]
curr_Stock_Price:  101.06656409935815
curr_Factors:  [1.01066564e+02 3.82551603e-02]
mat_Sqrt:  [[ 1.97675349e+01  0.00000000e+00]
 [-7.82357057e-03  1.79260522e-02]]
grads:  [ 0.00491619 -4.61100911]
Stock Position:  0.004916192445989508
Bond Position:  [4.79559666]


portfolio before change:  [5.28919872]
curr_Stock_Price:  100.2813827994715
curr_Factors:  [1.00281383e+02 3.73501996e-02]
mat_Sqrt:  [[ 1.93805803e+01  0.00000000e+00]
 [-7.73047990e-03  1.77127546e-02]]
grads:  [ 0.0275506 26.8984436]
Stock Position:  0.027550600708980123
Bond Position:  [2.52638639]


portfolio before change:  [5.33884117]
curr_Stock_Price:  102.07178393158655
curr_Factors:  [1.02071784e+02 3.75796176e-02]
mat_Sqrt:  [[ 1.97870879e+01  0.00000000e+00]
 [-7.75418521e-03  1.77670703e-02]]
grads:  [-0.00812777 -5.51340744]
Stock Position:  -0.008127770834395406
Bond Position:  [6.16845724]


portfolio before change:  [5.34920335]
curr_Stock_Price:  100.89174581118446
curr_Factors:  [1.00891746e+02 3.67409340e-02]
mat_Sqrt:  [[ 1.93388539e+01  0.00000000e+00]
 [-7.66716991e-03  1.75676932e-02]]
grads:  [ 0.00569101 -1.72437294]
Stock Position:  0.0056910105197297434
Bond Position:  [4.77502737]


portfolio before change:  [5.34824072]
curr_Stock_Price:  100.61770814733626
curr_Factors:  [1.00617708e+02 3.60393583e-02]
mat_Sqrt:  [[ 1.91013009e+01  0.00000000e+00]
 [-7.59361398e-03  1.73991554e-02]]
grads:  [-0.00484728 -0.47089469]
Stock Position:  -0.004847284178280195
Bond Position:  [5.83596334]


portfolio before change:  [5.34530435]
curr_Stock_Price:  101.37398825088324
curr_Factors:  [1.01373988e+02 3.64887688e-02]
mat_Sqrt:  [[ 1.93644933e+01  0.00000000e+00]
 [-7.64081344e-03  1.75073030e-02]]
grads:  [-3.43973993e-03 -7.78405391e+00]
Stock Position:  -0.003439739932642902
Bond Position:  [5.69400451]


portfolio before change:  [5.35145279]
curr_Stock_Price:  99.7934486830043
curr_Factors:  [9.97934487e+01 3.70026086e-02]
mat_Sqrt:  [[ 1.91963298e+01  0.00000000e+00]
 [-7.69442485e-03  1.76301422e-02]]
grads:  [-0.00673821 -1.59110488]
Stock Position:  -0.006738209311861058
Bond Position:  [6.02388194]


portfolio before change:  [5.35173806]
curr_Stock_Price:  99.86286881257082
curr_Factors:  [9.98628688e+01 3.65080353e-02]
mat_Sqrt:  [[ 1.90808742e+01  0.00000000e+00]
 [-7.64283040e-03  1.75119244e-02]]
grads:  [-0.00323822 -2.02044394]
Stock Position:  -0.0032382228025494672
Bond Position:  [5.67511628]


portfolio before change:  [5.35530892]
curr_Stock_Price:  98.97922779830527
curr_Factors:  [9.89792278e+01 3.73711449e-02]
mat_Sqrt:  [[ 1.91342861e+01  0.00000000e+00]
 [-7.73264714e-03  1.77177204e-02]]
grads:  [ 0.03373385 18.46062799]
Stock Position:  0.03373385071518777
Bond Position:  [2.01635843]


portfolio before change:  [5.31466348]
curr_Stock_Price:  97.76686985767256
curr_Factors:  [9.77668699e+01 3.56063725e-02]
mat_Sqrt:  [[ 1.84482670e+01  0.00000000e+00]
 [-7.54786036e-03  1.72943207e-02]]
grads:  [0.00965376 6.36270282]
Stock Position:  0.009653757862273045
Bond Position:  [4.37084579]


portfolio before change:  [5.30957036]
curr_Stock_Price:  97.18269193046602
curr_Factors:  [9.71826919e+01 3.66007408e-02]
mat_Sqrt:  [[ 1.85923319e+01  0.00000000e+00]
 [-7.65252803e-03  1.75341445e-02]]
grads:  [5.16226998e-03 7.27449800e+00]
Stock Position:  0.005162269977440092
Bond Position:  [4.80788706]


portfolio before change:  [5.30344032]
curr_Stock_Price:  95.8787961766882
curr_Factors:  [9.58787962e+01 3.71583989e-02]
mat_Sqrt:  [[ 1.84820895e+01  0.00000000e+00]
 [-7.71060557e-03  1.76672168e-02]]
grads:  [0.01162165 4.3099701 ]
Stock Position:  0.01162164798418531
Bond Position:  [4.1891707]


portfolio before change:  [5.31920346]
curr_Stock_Price:  97.19009544940722
curr_Factors:  [9.71900954e+01 3.68736558e-02]
mat_Sqrt:  [[ 1.86629420e+01  0.00000000e+00]
 [-7.68100575e-03  1.75993951e-02]]
grads:  [-0.00421996 -2.37525882]
Stock Position:  -0.004219958475243374
Bond Position:  [5.72934162]


portfolio before change:  [5.32400655]
curr_Stock_Price:  96.22163072617789
curr_Factors:  [9.62216307e+01 3.77733462e-02]
mat_Sqrt:  [[ 1.87010264e+01  0.00000000e+00]
 [-7.77414650e-03  1.78128074e-02]]
grads:  [-0.01812996  9.17133237]
Stock Position:  -0.018129963784761373
Bond Position:  [7.06850123]


portfolio before change:  [5.32744503]
curr_Stock_Price:  96.08071109897222
curr_Factors:  [9.60807111e+01 3.62906094e-02]
mat_Sqrt:  [[ 1.83034661e+01  0.00000000e+00]
 [-7.62003773e-03  1.74596999e-02]]
grads:  [0.00764072 3.07558968]
Stock Position:  0.007640722888319351
Bond Position:  [4.59331895]


portfolio before change:  [5.3296599]
curr_Stock_Price:  96.29543705351122
curr_Factors:  [9.62954371e+01 3.60410236e-02]
mat_Sqrt:  [[ 1.82811818e+01  0.00000000e+00]
 [-7.59378942e-03  1.73995574e-02]]
grads:  [0.07731032 8.32411198]
Stock Position:  0.0773103174477676
Bond Position:  [-2.11497091]


portfolio before change:  [5.35518337]
curr_Stock_Price:  96.62900006242582
curr_Factors:  [9.66290001e+01 3.49641303e-02]
mat_Sqrt:  [[ 1.80683648e+01  0.00000000e+00]
 [-7.47947916e-03  1.71376397e-02]]
grads:  [1.00049221e-02 2.19974582e+01]
Stock Position:  0.010004922079315706
Bond Position:  [4.38841775]


portfolio before change:  [5.34609056]
curr_Stock_Price:  95.66533470908796
curr_Factors:  [9.56653347e+01 3.63775155e-02]
mat_Sqrt:  [[ 1.82461446e+01  0.00000000e+00]
 [-7.62915623e-03  1.74805929e-02]]
grads:  [-4.39174408e-03  7.70377675e+00]
Stock Position:  -0.00439174407728106
Bond Position:  [5.76622823]


portfolio before change:  [5.34488707]
curr_Stock_Price:  96.1035009979856
curr_Factors:  [9.61035010e+01 3.58301286e-02]
mat_Sqrt:  [[ 1.81912856e+01  0.00000000e+00]
 [-7.57153919e-03  1.73485757e-02]]
grads:  [-5.89665288e-03  9.39622528e+00]
Stock Position:  -0.005896652881693647
Bond Position:  [5.91157606]


portfolio before change:  [5.34145566]
curr_Stock_Price:  96.8107509115972
curr_Factors:  [9.68107509e+01 3.71171765e-02]
mat_Sqrt:  [[ 1.86513836e+01  0.00000000e+00]
 [-7.70632743e-03  1.76574144e-02]]
grads:  [ 0.00580803 -5.43589594]
Stock Position:  0.005808026629179421
Bond Position:  [4.77917624]


portfolio before change:  [5.35477111]
curr_Stock_Price:  99.00048216029643
curr_Factors:  [9.90004822e+01 3.69353656e-02]
mat_Sqrt:  [[ 1.90264827e+01  0.00000000e+00]
 [-7.68743032e-03  1.76141157e-02]]
grads:  [-8.01087865e-03 -1.83591747e+01]
Stock Position:  -0.008010878653733114
Bond Position:  [6.14785196]


portfolio before change:  [5.35587022]
curr_Stock_Price:  98.95921538468409
curr_Factors:  [9.89592154e+01 3.63445777e-02]
mat_Sqrt:  [[ 1.88658361e+01  0.00000000e+00]
 [-7.62570156e-03  1.74726773e-02]]
grads:  [4.91709695e-03 5.99113682e+00]
Stock Position:  0.00491709694785239
Bond Position:  [4.86927816]


portfolio before change:  [5.35422286]
curr_Stock_Price:  98.50039565551724
curr_Factors:  [9.85003957e+01 3.59562840e-02]
mat_Sqrt:  [[ 1.86777852e+01  0.00000000e+00]
 [-7.58485692e-03  1.73790905e-02]]
grads:  [0.00960539 2.54824103]
Stock Position:  0.00960538534279575
Bond Position:  [4.4080886]


portfolio before change:  [5.34149724]
curr_Stock_Price:  97.11818569398231
curr_Factors:  [9.71181857e+01 3.66124831e-02]
mat_Sqrt:  [[ 1.85829712e+01  0.00000000e+00]
 [-7.65375548e-03  1.75369569e-02]]
grads:  [ -0.03277698 -10.16076857]
Stock Position:  -0.032776977488398605
Bond Position:  [8.52473783]


portfolio before change:  [5.34405522]
curr_Stock_Price:  97.07265613563433
curr_Factors:  [9.70726561e+01 3.64080711e-02]
mat_Sqrt:  [[ 1.85223356e+01  0.00000000e+00]
 [-7.63235965e-03  1.74879329e-02]]
grads:  [-0.00538079 -1.66180883]
Stock Position:  -0.0053807944755061765
Bond Position:  [5.86638324]


portfolio before change:  [5.34039208]
curr_Stock_Price:  97.88972623460029
curr_Factors:  [9.78897262e+01 3.46799732e-02]
mat_Sqrt:  [[ 1.82295728e+01  0.00000000e+00]
 [-7.44902390e-03  1.70678579e-02]]
grads:  [-1.15848781e-03 -2.40250189e+00]
Stock Position:  -0.0011584878132290023
Bond Position:  [5.45379614]


portfolio before change:  [5.34258944]
curr_Stock_Price:  96.58147416760224
curr_Factors:  [9.65814742e+01 3.47376370e-02]
mat_Sqrt:  [[ 1.80008895e+01  0.00000000e+00]
 [-7.45521423e-03  1.70820418e-02]]
grads:  [ 0.01378241 11.73179535]
Stock Position:  0.013782414373588786
Bond Position:  [4.01146354]


portfolio before change:  [5.34883682]
curr_Stock_Price:  96.99837618089326
curr_Factors:  [9.69983762e+01 3.53861133e-02]
mat_Sqrt:  [[ 1.82465556e+01  0.00000000e+00]
 [-7.52447880e-03  1.72407468e-02]]
grads:  [0.00068055 0.03528158]
Stock Position:  0.0006805450016020427
Bond Position:  [5.28282506]


portfolio before change:  [5.34964167]
curr_Stock_Price:  97.2106326945654
curr_Factors:  [9.72106327e+01 3.50794628e-02]
mat_Sqrt:  [[ 1.82070773e+01  0.00000000e+00]
 [-7.49180489e-03  1.71658815e-02]]
grads:  [ 0.00353943 -3.19006144]
Stock Position:  0.003539432581162562
Bond Position:  [5.00557119]


portfolio before change:  [5.3463746]
curr_Stock_Price:  96.11079343371225
curr_Factors:  [9.61107934e+01 3.43886603e-02]
mat_Sqrt:  [[ 1.78229583e+01  0.00000000e+00]
 [-7.41767190e-03  1.69960215e-02]]
grads:  [4.74614275e-03 6.89515547e+00]
Stock Position:  0.004746142745943742
Bond Position:  [4.89021905]


portfolio before change:  [5.34914193]
curr_Stock_Price:  96.56506176734204
curr_Factors:  [9.65650618e+01 3.32634914e-02]
mat_Sqrt:  [[ 1.76118078e+01  0.00000000e+00]
 [-7.29531262e-03  1.67156611e-02]]
grads:  [-0.00243902  0.42774337]
Stock Position:  -0.0024390249751245156
Bond Position:  [5.58466653]


portfolio before change:  [5.35129222]
curr_Stock_Price:  95.96967623829931
curr_Factors:  [9.59696762e+01 3.40341733e-02]
mat_Sqrt:  [[ 1.77048248e+01  0.00000000e+00]
 [-7.37934125e-03  1.69081949e-02]]
grads:  [-0.01690864 -5.89423235]
Stock Position:  -0.01690864045451345
Bond Position:  [6.97400897]


portfolio before change:  [5.35766069]
curr_Stock_Price:  95.64459585457601
curr_Factors:  [9.56445959e+01 3.57271877e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.35766069]
Stock Price:  95.84439581279268
PL:  [5.35766069]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.01150311e+00  2.57581803e-01]
 [-1.40773129e-01  1.15030197e-02]
 [-8.93280377e-01 -2.63140305e-01]
 [-2.84668678e-01 -7.69506879e-02]
 [-1.22183043e-01 -5.54741633e-01]
 [-4.18367153e-01  2.67732053e-01]
 [ 3.43880125e-01 -4.03803751e-01]
 [-6.22304342e-01  1.52859666e-01]
 [-1.13801297e-01 -1.04548155e-01]
 [-1.40218336e-01 -4.04727064e-01]
 [-8.04807994e-02 -1.03249167e-02]
 [ 3.68293386e-03 -1.36102038e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-5.50307503e-02 -1.12237202e-02]
 [ 4.84669745e-01  3.12215340e-01]
 [ 1.32753190e-01 -5.07883671e-01]
 [ 1.60361569e-02 -3.46853352e-01]
 [ 3.78231179e-02 -1.59842633e-01]
 [-1.23579099e-01 -3.73778669e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.33678768e-01 -2.60564779e-02]
 [ 3.70785648e-01 -3.69522519e-01]
 [ 2.74789316e-02 -3.39853157e-01]
 [ 3.37425909e-02  4.91821313e-02]
 [ 4.48031011e-01 -4.26105819e-01]
 [-4.69329347e-01  6.63386172e-02]
 [-1.23888965e-01  1.93835867e-01]
 [-1.13740670e-01 -1.83861366e-01]
 [-8.28569615e-02  2.20805460e-01]
 [-4.38051357e-01  9.37175807e-01]
 [-1.00253688e-01  6.36189839e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-1.80980575e-01 -1.68084716e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.55205629e-01 -1.22926383e-01]
 [-3.27081233e-02 -1.28446731e-01]
 [ 6.98282458e-03 -6.36578682e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.35757953]
curr_Stock_Price:  101.54967982616819
curr_Factors:  [1.0154968e+02 3.9266631e-02]
mat_Sqrt:  [[ 2.01228912e+01  0.00000000e+00]
 [-7.92632384e-03  1.81614895e-02]]
grads:  [ 0.05585286 14.18285672]
Stock Position:  0.055852860191368106
Bond Position:  [7.68573946]


portfolio before change:  [13.49193014]
curr_Stock_Price:  103.93791618097849
curr_Factors:  [1.03937916e+02 3.80841928e-02]
mat_Sqrt:  [[ 2.02836628e+01  0.00000000e+00]
 [-7.80606870e-03  1.78859503e-02]]
grads:  [-0.00669272  0.64313159]
Stock Position:  -0.00669271624167298
Bond Position:  [14.18755712]


portfolio before change:  [13.4921289]
curr_Stock_Price:  104.17321567617856
curr_Factors:  [1.04173216e+02 3.79455059e-02]
mat_Sqrt:  [[ 2.02925322e+01  0.00000000e+00]
 [-7.79184249e-03  1.78533540e-02]]
grads:  [ -0.04967957 -14.73898432]
Stock Position:  -0.049679567395262116
Bond Position:  [18.66740919]


portfolio before change:  [13.47251312]
curr_Stock_Price:  104.61503411566353
curr_Factors:  [1.04615034e+02 3.70322561e-02]
mat_Sqrt:  [[ 2.01318732e+01  0.00000000e+00]
 [-7.69750673e-03  1.76372036e-02]]
grads:  [-0.0158084  -4.36297554]
Stock Position:  -0.015808400320468634
Bond Position:  [15.12630946]


portfolio before change:  [13.50167684]
curr_Stock_Price:  102.88982415329329
curr_Factors:  [1.02889824e+02 3.85673288e-02]
mat_Sqrt:  [[ 2.02060864e+01  0.00000000e+00]
 [-7.85542654e-03  1.79990434e-02]]
grads:  [-1.80288322e-02 -3.08206176e+01]
Stock Position:  -0.018028832189465726
Bond Position:  [15.35666021]


portfolio before change:  [13.48913495]
curr_Stock_Price:  103.69196114532004
curr_Factors:  [1.03691961e+02 4.02181748e-02]
mat_Sqrt:  [[ 2.07948728e+01  0.00000000e+00]
 [-8.02178781e-03  1.83802249e-02]]
grads:  [-1.44996947e-02  1.45663099e+01]
Stock Position:  -0.014499694692797877
Bond Position:  [14.99263673]


portfolio before change:  [13.48970766]
curr_Stock_Price:  103.78172080843444
curr_Factors:  [1.03781721e+02 4.02948028e-02]
mat_Sqrt:  [[ 2.08326916e+01  0.00000000e+00]
 [-8.02942617e-03  1.83977266e-02]]
grads:  [ 8.04724240e-03 -2.19485679e+01]
Stock Position:  0.008047242401385796
Bond Position:  [12.65455099]


portfolio before change:  [13.48776291]
curr_Stock_Price:  103.34347617470277
curr_Factors:  [1.03343476e+02 4.10422360e-02]
mat_Sqrt:  [[ 2.09362344e+01  0.00000000e+00]
 [-8.10355339e-03  1.85675734e-02]]
grads:  [-0.02653729  8.23261408]
Stock Position:  -0.026537289541801116
Bond Position:  [16.23021866]


portfolio before change:  [13.48532882]
curr_Stock_Price:  103.511654472453
curr_Factors:  [1.03511654e+02 4.15451325e-02]
mat_Sqrt:  [[ 2.10983904e+01  0.00000000e+00]
 [-8.15304925e-03  1.86809827e-02]]
grads:  [-0.00755649 -5.5965019 ]
Stock Position:  -0.007556493611978472
Bond Position:  [14.26751398]


portfolio before change:  [13.49635156]
curr_Stock_Price:  102.28897263007406
curr_Factors:  [1.02288973e+02 4.10981765e-02]
mat_Sqrt:  [[ 2.07367214e+01  0.00000000e+00]
 [-8.10907407e-03  1.85802229e-02]]
grads:  [-1.52799327e-02 -2.17826808e+01]
Stock Position:  -0.015279932730096868
Bond Position:  [15.05932018]


portfolio before change:  [13.51864364]
curr_Stock_Price:  100.95326351838182
curr_Factors:  [1.00953264e+02 4.23451212e-02]
mat_Sqrt:  [[ 2.07740921e+01  0.00000000e+00]
 [-8.23117208e-03  1.88599846e-02]]
grads:  [-0.00409101 -0.54745096]
Stock Position:  -0.004091007299623559
Bond Position:  [13.93164418]


portfolio before change:  [13.52068097]
curr_Stock_Price:  100.88096563245296
curr_Factors:  [1.00880966e+02 4.12027031e-02]
mat_Sqrt:  [[ 2.04772713e+01  0.00000000e+00]
 [-8.11937959e-03  1.86038358e-02]]
grads:  [-2.72091258e-03 -7.31580516e+00]
Stock Position:  -0.002720912583681494
Bond Position:  [13.79516926]


portfolio before change:  [13.52633612]
curr_Stock_Price:  99.43636140148887
curr_Factors:  [9.94363614e+01 4.13482925e-02]
mat_Sqrt:  [[ 2.02196677e+01  0.00000000e+00]
 [-8.13371182e-03  1.86366750e-02]]
grads:  [-0.00639718 -1.5051722 ]
Stock Position:  -0.006397181699221905
Bond Position:  [14.16244859]


portfolio before change:  [13.5292356]
curr_Stock_Price:  99.2598668391461
curr_Factors:  [9.92598668e+01 4.07962160e-02]
mat_Sqrt:  [[ 2.00485805e+01  0.00000000e+00]
 [-8.07922927e-03  1.85118398e-02]]
grads:  [-0.0029892  -0.60629955]
Stock Position:  -0.002989198328559384
Bond Position:  [13.82594303]


portfolio before change:  [13.53083005]
curr_Stock_Price:  99.30466228642689
curr_Factors:  [9.93046623e+01 4.11555666e-02]
mat_Sqrt:  [[ 2.01457728e+01  0.00000000e+00]
 [-8.11473391e-03  1.85931912e-02]]
grads:  [ 0.03082193 16.7919179 ]
Stock Position:  0.030821934583638935
Bond Position:  [10.47006825]


portfolio before change:  [13.61489255]
curr_Stock_Price:  101.98955738034347
curr_Factors:  [1.01989557e+02 4.08242225e-02]
mat_Sqrt:  [[ 2.06069951e+01  0.00000000e+00]
 [-8.08200198e-03  1.85181929e-02]]
grads:  [-4.31433190e-03 -2.74262004e+01]
Stock Position:  -0.004314331896255112
Bond Position:  [14.05490935]


portfolio before change:  [13.59928582]
curr_Stock_Price:  106.01421431043802
curr_Factors:  [1.06014214e+02 4.06065962e-02]
mat_Sqrt:  [[ 2.13630075e+01  0.00000000e+00]
 [-8.06043137e-03  1.84687684e-02]]
grads:  [-6.3353934e-03 -1.8780535e+01]
Stock Position:  -0.00633539340174217
Bond Position:  [14.27092757]


portfolio before change:  [13.60893214]
curr_Stock_Price:  104.77319499408173
curr_Factors:  [1.04773195e+02 4.12197819e-02]
mat_Sqrt:  [[ 2.12717408e+01  0.00000000e+00]
 [-8.12106219e-03  1.86076911e-02]]
grads:  [-1.50142514e-03 -8.59013793e+00]
Stock Position:  -0.0015014251396336035
Bond Position:  [13.76624125]


portfolio before change:  [13.61129136]
curr_Stock_Price:  104.34804904164749
curr_Factors:  [1.04348049e+02 4.08412728e-02]
mat_Sqrt:  [[ 2.10879308e+01  0.00000000e+00]
 [-8.08368953e-03  1.85220596e-02]]
grads:  [-1.35959041e-02 -2.01801893e+01]
Stock Position:  -0.013595904055603755
Bond Position:  [15.02999742]


portfolio before change:  [13.60968558]
curr_Stock_Price:  104.60435020065866
curr_Factors:  [1.04604350e+02 4.11821121e-02]
mat_Sqrt:  [[ 2.12277544e+01  0.00000000e+00]
 [-8.11735051e-03  1.85991866e-02]]
grads:  [-2.28291081e-04 -5.86549249e+00]
Stock Position:  -0.0002282910814078348
Bond Position:  [13.63356582]


portfolio before change:  [13.61152453]
curr_Stock_Price:  104.01454105730127
curr_Factors:  [1.04014541e+02 4.04986633e-02]
mat_Sqrt:  [[ 2.09321772e+01  0.00000000e+00]
 [-8.04971187e-03  1.84442070e-02]]
grads:  [ 0.005843  -1.4127188]
Stock Position:  0.005843003715427199
Bond Position:  [13.00376718]


portfolio before change:  [13.61292405]
curr_Stock_Price:  103.97585336392252
curr_Factors:  [1.03975853e+02 3.99188429e-02]
mat_Sqrt:  [[ 2.07740640e+01  0.00000000e+00]
 [-7.99188017e-03  1.83116979e-02]]
grads:  [ 1.00853063e-02 -2.01795880e+01]
Stock Position:  0.010085306322557925
Bond Position:  [12.56429572]


portfolio before change:  [13.61680505]
curr_Stock_Price:  104.20493554989449
curr_Factors:  [1.04204936e+02 3.96181301e-02]
mat_Sqrt:  [[ 2.07412667e+01  0.00000000e+00]
 [-7.96172143e-03  1.82425956e-02]]
grads:  [-5.82631466e-03 -1.86296493e+01]
Stock Position:  -0.005826314657208112
Bond Position:  [14.22393579]


portfolio before change:  [13.61628041]
curr_Stock_Price:  104.60016672878734
curr_Factors:  [1.04600167e+02 3.94294172e-02]
mat_Sqrt:  [[ 2.07702898e+01  0.00000000e+00]
 [-7.94273678e-03  1.81990963e-02]]
grads:  [2.65800012e-03 2.70244910e+00]
Stock Position:  0.002658000119033608
Bond Position:  [13.33825315]


portfolio before change:  [13.61982191]
curr_Stock_Price:  105.30524988539531
curr_Factors:  [1.05305250e+02 3.95042354e-02]
mat_Sqrt:  [[ 2.09301265e+01  0.00000000e+00]
 [-7.95026896e-03  1.82163547e-02]]
grads:  [ 1.25208601e-02 -2.33913879e+01]
Stock Position:  0.012520860073106115
Bond Position:  [12.30130961]


portfolio before change:  [13.63254663]
curr_Stock_Price:  106.19871585265183
curr_Factors:  [1.06198716e+02 4.13177797e-02]
mat_Sqrt:  [[ 2.15867744e+01  0.00000000e+00]
 [-8.13071015e-03  1.86297974e-02]]
grads:  [-0.02040031  3.56088775]
Stock Position:  -0.02040030583928737
Bond Position:  [15.79903291]


portfolio before change:  [13.61924704]
curr_Stock_Price:  106.94745917027103
curr_Factors:  [1.06947459e+02 4.05876272e-02]
mat_Sqrt:  [[ 2.15460321e+01  0.00000000e+00]
 [-8.05854847e-03  1.84644542e-02]]
grads:  [-1.82363310e-03  1.04977848e+01]
Stock Position:  -0.001823633101820418
Bond Position:  [13.81427997]


portfolio before change:  [13.62169203]
curr_Stock_Price:  106.55368764463581
curr_Factors:  [1.06553688e+02 4.09167744e-02]
mat_Sqrt:  [[ 2.15535683e+01  0.00000000e+00]
 [-8.09115808e-03  1.85391722e-02]]
grads:  [-9.00010364e-03 -9.91745283e+00]
Stock Position:  -0.009000103639056886
Bond Position:  [14.58068626]


portfolio before change:  [13.6182218]
curr_Stock_Price:  107.14178359855552
curr_Factors:  [1.07141784e+02 4.07669166e-02]
mat_Sqrt:  [[ 2.16328034e+01  0.00000000e+00]
 [-8.07632754e-03  1.85051912e-02]]
grads:  [6.24534951e-04 1.19320821e+01]
Stock Position:  0.0006245349514897008
Bond Position:  [13.55130801]


portfolio before change:  [13.6212697]
curr_Stock_Price:  109.30960415458532
curr_Factors:  [1.09309604e+02 3.97250204e-02]
mat_Sqrt:  [[ 2.17866465e+01  0.00000000e+00]
 [-7.97245461e-03  1.82671884e-02]]
grads:  [-1.33266503e-03  5.13037797e+01]
Stock Position:  -0.001332665030557192
Bond Position:  [13.76694279]


portfolio before change:  [13.6238309]
curr_Stock_Price:  108.67911701486882
curr_Factors:  [1.08679117e+02 4.07073072e-02]
mat_Sqrt:  [[ 2.19271551e+01  0.00000000e+00]
 [-8.07042078e-03  1.84916571e-02]]
grads:  [-3.30585917e-03  3.44041552e+00]
Stock Position:  -0.003305859168265748
Bond Position:  [13.98310876]


portfolio before change:  [13.6306896]
curr_Stock_Price:  107.13316687358275
curr_Factors:  [1.07133167e+02 4.14097923e-02]
mat_Sqrt:  [[ 2.18009525e+01  0.00000000e+00]
 [-8.13975846e-03  1.86505296e-02]]
grads:  [ 0.0033275  -0.64058176]
Stock Position:  0.0033274966613210666
Bond Position:  [13.27420434]


portfolio before change:  [13.63829489]
curr_Stock_Price:  108.92007054470828
curr_Factors:  [1.08920071e+02 3.97629149e-02]
mat_Sqrt:  [[ 2.17193598e+01  0.00000000e+00]
 [-7.97625625e-03  1.82758990e-02]]
grads:  [-0.01171023 -9.19706965]
Stock Position:  -0.011710232769979472
Bond Position:  [14.91377427]


portfolio before change:  [13.62566727]
curr_Stock_Price:  110.15761750042287
curr_Factors:  [1.10157618e+02 3.98452171e-02]
mat_Sqrt:  [[ 2.19888559e+01  0.00000000e+00]
 [-7.98450671e-03  1.82948032e-02]]
grads:  [0.00461466 2.91607733]
Stock Position:  0.004614663544702873
Bond Position:  [13.11732692]


portfolio before change:  [13.6264842]
curr_Stock_Price:  109.97930925985442
curr_Factors:  [1.09979309e+02 3.91472940e-02]
mat_Sqrt:  [[ 2.17601488e+01  0.00000000e+00]
 [-7.91427005e-03  1.81338708e-02]]
grads:  [-4.35050383e-03  4.48470970e+00]
Stock Position:  -0.004350503828659648
Bond Position:  [14.10494961]


portfolio before change:  [13.62824178]
curr_Stock_Price:  109.98060859484946
curr_Factors:  [1.09980609e+02 4.09434924e-02]
mat_Sqrt:  [[ 2.22540244e+01  0.00000000e+00]
 [-8.09379934e-03  1.85452241e-02]]
grads:  [-0.02286576 -6.62846577]
Stock Position:  -0.022865756347413883
Bond Position:  [16.14303158]


portfolio before change:  [13.63557596]
curr_Stock_Price:  109.74811353288364
curr_Factors:  [1.09748114e+02 4.05056301e-02]
mat_Sqrt:  [[ 2.20879169e+01  0.00000000e+00]
 [-8.05040423e-03  1.84457934e-02]]
grads:  [-4.01879783e-03 -6.96347013e+00]
Stock Position:  -0.004018797831043765
Bond Position:  [14.07663144]


portfolio before change:  [13.64202648]
curr_Stock_Price:  108.58089183566808
curr_Factors:  [1.08580892e+02 4.20375298e-02]
mat_Sqrt:  [[ 2.22624009e+01  0.00000000e+00]
 [-8.20122233e-03  1.87913611e-02]]
grads:  [-9.34299357e-04 -3.38761349e+00]
Stock Position:  -0.0009342993565558442
Bond Position:  [13.74347353]


portfolio before change:  [13.64378696]
curr_Stock_Price:  108.53546066267552
curr_Factors:  [1.08535461e+02 4.23232685e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.64378696]
Stock Price:  108.14111271416489
PL:  [5.50267425]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.14796327e+00  2.88432709e-01]
 [-2.58149744e-01 -8.19418508e-02]
 [-3.48427196e-01 -1.44982422e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.13712101e-01 -2.90080777e-01]
 [-2.80563076e-01  1.01703140e-01]
 [ 9.12265366e-02  7.18818204e-02]
 [-2.51631071e-02  3.82346138e-01]
 [-8.72793336e-02  3.85320437e-02]
 [ 1.81301232e-01  4.48019261e-02]
 [-1.09043088e-01 -1.74723665e-03]
 [ 1.41497627e-02 -1.35949939e-01]
 [-1.15546771e-01 -2.70389128e-02]
 [-5.08738048e-02 -2.60457538e-02]
 [ 4.36900413e-01  2.76969482e-01]
 [ 1.35655465e-01 -4.01033215e-01]
 [ 3.94370356e-02  7.93585524e-02]
 [ 2.07312572e-02 -1.27038184e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-4.17340992e-02 -5.96235354e-02]
 [ 1.72803750e-01 -4.09570824e-02]
 [ 8.08301597e-01 -2.77353403e-02]
 [ 2.60716542e-02 -1.90600255e-01]
 [-7.20514815e-03  3.44967490e-02]
 [ 2.71039215e-01 -1.77375737e-01]
 [ 1.61308739e-01 -9.23967172e-02]
 [ 5.04353628e-02 -1.18641867e-01]
 [ 5.11480501e-02  1.83657621e-01]
 [ 1.05241267e-01  8.49027389e-02]
 [-5.42242103e-01 -1.13526426e-01]
 [-1.41040282e-01 -4.90506126e-02]
 [-3.40485040e-02  1.18747200e-02]
 [ 1.06452523e-01  1.92536095e-01]
 [ 1.26020304e-02 -5.65291486e-04]
 [ 1.70820894e-01 -1.30236839e-01]
 [ 4.16343670e-02  1.12863111e-01]
 [-5.23682886e-02  1.16431106e-01]
 [-3.55621859e-01 -1.36036710e-01]
 [ 1.37507269e-01 -2.14027993e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.04190158]
curr_Stock_Price:  100.77808277908001
curr_Factors:  [1.00778083e+02 3.96457447e-02]
mat_Sqrt:  [[ 2.00661651e+01  0.00000000e+00]
 [-7.96449569e-03  1.82489522e-02]]
grads:  [ 0.06348227 15.80543949]
Stock Position:  0.06348226536030784
Bond Position:  [1.64428059]


portfolio before change:  [8.16191676]
curr_Stock_Price:  102.66537567318699
curr_Factors:  [1.02665376e+02 3.86691752e-02]
mat_Sqrt:  [[ 2.01886117e+01  0.00000000e+00]
 [-7.86579178e-03  1.80227931e-02]]
grads:  [-0.01455831 -4.5465678 ]
Stock Position:  -0.014558311602208366
Bond Position:  [9.65655129]


portfolio before change:  [8.16977116]
curr_Stock_Price:  102.20878032591163
curr_Factors:  [1.02208780e+02 3.95827237e-02]
mat_Sqrt:  [[ 2.03348533e+01  0.00000000e+00]
 [-7.95816298e-03  1.82344421e-02]]
grads:  [-0.02024616 -7.95102043]
Stock Position:  -0.020246160934020662
Bond Position:  [10.23910657]


portfolio before change:  [8.19088017]
curr_Stock_Price:  101.22938287322332
curr_Factors:  [1.01229383e+02 3.93912557e-02]
mat_Sqrt:  [[ 2.00912289e+01  0.00000000e+00]
 [-7.93889218e-03  1.81902872e-02]]
grads:  [-8.11367340e-04 -8.32239815e+00]
Stock Position:  -0.0008113673401316503
Bond Position:  [8.27301438]


portfolio before change:  [8.19153099]
curr_Stock_Price:  101.70187302300936
curr_Factors:  [1.01701873e+02 4.05945128e-02]
mat_Sqrt:  [[ 2.04909747e+01  0.00000000e+00]
 [-8.05923200e-03  1.84660203e-02]]
grads:  [-1.17277843e-02 -1.57088951e+01]
Stock Position:  -0.011727784256343673
Bond Position:  [9.38426862]


portfolio before change:  [8.20040971]
curr_Stock_Price:  101.04483419561814
curr_Factors:  [1.01044834e+02 4.07676308e-02]
mat_Sqrt:  [[ 2.04019581e+01  0.00000000e+00]
 [-8.07639829e-03  1.85053532e-02]]
grads:  [-0.01157615  5.49587673]
Stock Position:  -0.011576152880409783
Bond Position:  [9.37012016]


portfolio before change:  [8.2152084]
curr_Stock_Price:  99.86764276542544
curr_Factors:  [9.98676428e+01 4.15302527e-02]
mat_Sqrt:  [[ 2.03519996e+01  0.00000000e+00]
 [-8.15158907e-03  1.86776370e-02]]
grads:  [0.0060239  3.84855003]
Stock Position:  0.0060238962860737905
Bond Position:  [7.61361607]


portfolio before change:  [8.22455863]
curr_Stock_Price:  101.26183528753147
curr_Factors:  [1.01261835e+02 3.88950851e-02]
mat_Sqrt:  [[ 1.99706940e+01  0.00000000e+00]
 [-7.88873476e-03  1.80753621e-02]]
grads:  [7.09571877e-03 2.11528896e+01]
Stock Position:  0.007095718767822493
Bond Position:  [7.50603312]


portfolio before change:  [8.21797328]
curr_Stock_Price:  100.20152542795729
curr_Factors:  [1.00201525e+02 3.79754576e-02]
mat_Sqrt:  [[ 1.95265645e+01  0.00000000e+00]
 [-7.79491708e-03  1.78603988e-02]]
grads:  [-0.00360855  2.15740108]
Stock Position:  -0.0036085493099898593
Bond Position:  [8.57955543]


portfolio before change:  [8.22053307]
curr_Stock_Price:  99.78937179380735
curr_Factors:  [9.97893718e+01 3.98383191e-02]
mat_Sqrt:  [[ 1.99174984e+01  0.00000000e+00]
 [-7.98381554e-03  1.82932195e-02]]
grads:  [0.01008432 2.44910012]
Stock Position:  0.010084318392415395
Bond Position:  [7.21422527]


portfolio before change:  [8.22044583]
curr_Stock_Price:  99.6912913196503
curr_Factors:  [9.96912913e+01 3.95609175e-02]
mat_Sqrt:  [[ 1.98285245e+01  0.00000000e+00]
 [-7.95597059e-03  1.82294187e-02]]
grads:  [-0.00553776 -0.09584709]
Stock Position:  -0.00553776174632993
Bond Position:  [8.77251245]


portfolio before change:  [8.2174834]
curr_Stock_Price:  100.42426934749042
curr_Factors:  [1.00424269e+02 3.82112938e-02]
mat_Sqrt:  [[ 1.96306442e+01  0.00000000e+00]
 [-7.81908371e-03  1.79157715e-02]]
grads:  [-2.30168987e-03 -7.58828271e+00]
Stock Position:  -0.0023016898735538156
Bond Position:  [8.44862893]


portfolio before change:  [8.21927428]
curr_Stock_Price:  100.10505613183739
curr_Factors:  [1.00105056e+02 3.77397118e-02]
mat_Sqrt:  [[ 1.94471204e+01  0.00000000e+00]
 [-7.77068458e-03  1.78048751e-02]]
grads:  [-0.0065484  -1.51862412]
Stock Position:  -0.006548399820029218
Bond Position:  [8.87480221]


portfolio before change:  [8.2248672]
curr_Stock_Price:  99.42038502158113
curr_Factors:  [9.9420385e+01 3.6999995e-02]
mat_Sqrt:  [[ 1.91238916e+01  0.00000000e+00]
 [-7.69415311e-03  1.76295195e-02]]
grads:  [-0.00325463 -1.47739442]
Stock Position:  -0.0032546254165029763
Bond Position:  [8.54844331]


portfolio before change:  [8.22362773]
curr_Stock_Price:  100.12955819111711
curr_Factors:  [1.00129558e+02 3.59585644e-02]
mat_Sqrt:  [[ 1.89873114e+01  0.00000000e+00]
 [-7.58509743e-03  1.73796416e-02]]
grads:  [ 0.02937645 15.93643234]
Stock Position:  0.02937645010788766
Bond Position:  [5.28217676]


portfolio before change:  [8.25647394]
curr_Stock_Price:  101.22519437614747
curr_Factors:  [1.01225194e+02 3.53210655e-02]
mat_Sqrt:  [[ 1.90241612e+01  0.00000000e+00]
 [-7.51755977e-03  1.72248933e-02]]
grads:  [-2.06946202e-03 -2.32821886e+01]
Stock Position:  -0.002069462017809124
Bond Position:  [8.46595564]


portfolio before change:  [8.25987159]
curr_Stock_Price:  100.09478862681956
curr_Factors:  [1.00094789e+02 3.57359563e-02]
mat_Sqrt:  [[ 1.89218751e+01  0.00000000e+00]
 [-7.56158252e-03  1.73257621e-02]]
grads:  [3.91461983e-03 4.58037873e+00]
Stock Position:  0.003914619826350336
Bond Position:  [7.86803854]


portfolio before change:  [8.26280042]
curr_Stock_Price:  100.59171361370362
curr_Factors:  [1.00591714e+02 3.58007972e-02]
mat_Sqrt:  [[ 1.90330573e+01  0.00000000e+00]
 [-7.56843944e-03  1.73414733e-02]]
grads:  [-1.82381376e-03 -7.32568577e+00]
Stock Position:  -0.0018238137641006327
Bond Position:  [8.44626098]


portfolio before change:  [8.26225789]
curr_Stock_Price:  101.46811112442074
curr_Factors:  [1.01468111e+02 3.60169483e-02]
mat_Sqrt:  [[ 1.92567518e+01  0.00000000e+00]
 [-7.59125268e-03  1.73937450e-02]]
grads:  [-1.65538378e-02 -2.69802532e+01]
Stock Position:  -0.01655383776165904
Bond Position:  [9.94194454]


portfolio before change:  [8.27604884]
curr_Stock_Price:  100.71009159498392
curr_Factors:  [1.00710092e+02 3.59280452e-02]
mat_Sqrt:  [[ 1.90892904e+01  0.00000000e+00]
 [-7.58187789e-03  1.73722647e-02]]
grads:  [-0.00354942 -3.4321107 ]
Stock Position:  -0.0035494217950486216
Bond Position:  [8.63351143]


portfolio before change:  [8.27623475]
curr_Stock_Price:  100.9617785887827
curr_Factors:  [1.00961779e+02 3.65542792e-02]
mat_Sqrt:  [[ 1.93030575e+01  0.00000000e+00]
 [-7.64766937e-03  1.75230119e-02]]
grads:  [ 0.00802612 -2.3373312 ]
Stock Position:  0.008026117804090412
Bond Position:  [7.46590362]


portfolio before change:  [8.26998016]
curr_Stock_Price:  100.06621675717477
curr_Factors:  [1.00066217e+02 3.65096706e-02]
mat_Sqrt:  [[ 1.91201563e+01  0.00000000e+00]
 [-7.64300157e-03  1.75123166e-02]]
grads:  [ 0.04164176 -1.58376192]
Stock Position:  0.0416417569993696
Bond Position:  [4.10304708]


portfolio before change:  [8.27146363]
curr_Stock_Price:  100.0895239724214
curr_Factors:  [1.00089524e+02 3.55832388e-02]
mat_Sqrt:  [[ 1.88804074e+01  0.00000000e+00]
 [-7.54540801e-03  1.72887017e-02]]
grads:  [-3.02499388e-03 -1.10245557e+01]
Stock Position:  -0.003024993878256636
Bond Position:  [8.57423383]


portfolio before change:  [8.27264728]
curr_Stock_Price:  100.05256419419054
curr_Factors:  [1.00052564e+02 3.39569399e-02]
mat_Sqrt:  [[ 1.84370951e+01  0.00000000e+00]
 [-7.37096356e-03  1.68889992e-02]]
grads:  [4.25797413e-04 2.04255732e+00]
Stock Position:  0.00042579741253916673
Bond Position:  [8.23004516]


portfolio before change:  [8.27428293]
curr_Stock_Price:  101.47772819832277
curr_Factors:  [1.01477728e+02 3.28203176e-02]
mat_Sqrt:  [[ 1.83840895e+01  0.00000000e+00]
 [-7.24655147e-03  1.66039353e-02]]
grads:  [ 1.05322647e-02 -1.06827528e+01]
Stock Position:  0.010532264662111686
Bond Position:  [7.20549264]


portfolio before change:  [8.26118889]
curr_Stock_Price:  100.14897488581708
curr_Factors:  [1.00148975e+02 3.41504994e-02]
mat_Sqrt:  [[ 1.85073841e+01  0.00000000e+00]
 [-7.39194150e-03  1.69370657e-02]]
grads:  [ 0.00653704 -5.45529661]
Stock Position:  0.0065370397334248076
Bond Position:  [7.60651106]


portfolio before change:  [8.26527272]
curr_Stock_Price:  100.62823672530413
curr_Factors:  [1.00628237e+02 3.35218939e-02]
mat_Sqrt:  [[ 1.84240090e+01  0.00000000e+00]
 [-7.32359408e-03  1.67804621e-02]]
grads:  [-7.29587560e-05 -7.07023833e+00]
Stock Position:  -7.29587559618781e-05
Bond Position:  [8.27261443]


portfolio before change:  [8.26634835]
curr_Stock_Price:  100.05955000278188
curr_Factors:  [1.00059550e+02 3.37236443e-02]
mat_Sqrt:  [[ 1.83749343e+01  0.00000000e+00]
 [-7.34559942e-03  1.68308827e-02]]
grads:  [7.14575655e-03 1.09119423e+01]
Stock Position:  0.0071457565468470005
Bond Position:  [7.55134717]


portfolio before change:  [8.260102]
curr_Stock_Price:  99.05331205456675
curr_Factors:  [9.90533121e+01 3.31280487e-02]
mat_Sqrt:  [[ 1.80288045e+01  0.00000000e+00]
 [-7.28044489e-03  1.66815949e-02]]
grads:  [0.0078927 5.0896056]
Stock Position:  0.007892695259402295
Bond Position:  [7.47830439]


portfolio before change:  [8.26033562]
curr_Stock_Price:  98.96446692196905
curr_Factors:  [9.89644669e+01 3.34847158e-02]
mat_Sqrt:  [[ 1.81093390e+01  0.00000000e+00]
 [-7.31953177e-03  1.67711542e-02]]
grads:  [-0.03267867 -6.76914804]
Stock Position:  -0.03267866913148358
Bond Position:  [11.49436269]


portfolio before change:  [8.30348496]
curr_Stock_Price:  97.68802380272183
curr_Factors:  [9.76880238e+01 3.31339919e-02]
mat_Sqrt:  [[ 1.77819017e+01  0.00000000e+00]
 [-7.28109793e-03  1.66830912e-02]]
grads:  [-0.00913557 -2.94013933]
Stock Position:  -0.009135565345140035
Bond Position:  [9.19592029]


portfolio before change:  [8.31198434]
curr_Stock_Price:  96.88349658188586
curr_Factors:  [9.68834966e+01 3.37369859e-02]
mat_Sqrt:  [[ 1.77952029e+01  0.00000000e+00]
 [-7.34705229e-03  1.68342116e-02]]
grads:  [-0.00162212  0.7053921 ]
Stock Position:  -0.001622119818006045
Bond Position:  [8.46914098]


portfolio before change:  [8.31265233]
curr_Stock_Price:  97.12436633047292
curr_Factors:  [9.71243663e+01 3.26659379e-02]
mat_Sqrt:  [[ 1.75539867e+01  0.00000000e+00]
 [-7.22948827e-03  1.65648386e-02]]
grads:  [1.08512196e-02 1.16231797e+01]
Stock Position:  0.010851219574107337
Bond Position:  [7.2587345]


portfolio before change:  [8.31133387]
curr_Stock_Price:  96.91924110478895
curr_Factors:  [9.69192411e+01 3.24941278e-02]
mat_Sqrt:  [[ 1.74707861e+01  0.00000000e+00]
 [-7.21045106e-03  1.65212189e-02]]
grads:  [ 0.0007072  -0.03421609]
Stock Position:  0.0007071986866306475
Bond Position:  [8.24279271]


portfolio before change:  [8.3115542]
curr_Stock_Price:  95.77376803101464
curr_Factors:  [9.57737680e+01 3.30933156e-02]
mat_Sqrt:  [[ 1.74227504e+01  0.00000000e+00]
 [-7.27662730e-03  1.66728477e-02]]
grads:  [ 6.54207142e-03 -7.81131344e+00]
Stock Position:  0.006542071415491549
Bond Position:  [7.68499537]


portfolio before change:  [8.31303812]
curr_Stock_Price:  95.85374826392035
curr_Factors:  [9.58537483e+01 3.35374466e-02]
mat_Sqrt:  [[ 1.75539193e+01  0.00000000e+00]
 [-7.32529280e-03  1.67843544e-02]]
grads:  [5.17786744e-03 6.72430461e+00]
Stock Position:  0.005177867439071158
Bond Position:  [7.81672012]


portfolio before change:  [8.3110503]
curr_Stock_Price:  95.2811236345068
curr_Factors:  [9.52811236e+01 3.38346036e-02]
mat_Sqrt:  [[ 1.75261860e+01  0.00000000e+00]
 [-7.35767394e-03  1.68585489e-02]]
grads:  [-8.86438023e-05  6.90635400e+00]
Stock Position:  -8.864380227283416e-05
Bond Position:  [8.31949638]


portfolio before change:  [8.31224352]
curr_Stock_Price:  93.55268231008488
curr_Factors:  [9.35526823e+01 3.39258094e-02]
mat_Sqrt:  [[ 1.72314313e+01  0.00000000e+00]
 [-7.36758407e-03  1.68812558e-02]]
grads:  [-0.0240835  -8.05844725]
Stock Position:  -0.02408349834423852
Bond Position:  [10.56531939]


portfolio before change:  [8.27205795]
curr_Stock_Price:  95.27611591868724
curr_Factors:  [9.52761159e+01 3.38281927e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.27205795]
Stock Price:  95.6954214028201
PL:  [8.27205795]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.02540780e+00  2.60725375e-01]
 [ 1.05509318e+00  7.25664709e-02]
 [ 9.52113140e-02 -3.05933998e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.05478421e-01  7.36222234e-01]
 [-1.27751859e-02 -1.13137903e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.19093703e-01  8.11835127e-01]
 [-5.46066438e-03  3.17862021e-01]
 [ 1.81934286e-01  4.75405301e-02]
 [-1.15219717e-01  3.02250875e-04]
 [ 3.08371439e-02 -1.36013101e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-8.89143609e-02  1.08245880e-01]
 [ 4.17845681e-01  2.80798186e-01]
 [ 1.32822898e-01 -5.73435772e-02]
 [ 4.03691510e-02  1.27011727e-01]
 [ 1.43830312e-01  8.05243683e-02]
 [-5.64537613e-02 -3.96346168e-02]
 [-7.82947783e-02 -3.62919952e-02]
 [ 1.63748558e-01 -2.35596853e-02]
 [ 7.64943873e-01 -5.38606494e-02]
 [ 2.56956068e-02 -1.72101883e-01]
 [ 2.72612240e-02  1.78377138e-02]
 [ 2.64769233e-01 -1.71364476e-01]
 [ 1.57147112e-01 -8.59302643e-02]
 [-1.63797099e-01  7.32088267e-02]
 [ 2.89324120e-02  2.77410343e-01]
 [-1.73529975e-02  1.82122075e-01]
 [-5.66176879e-01 -9.07521999e-02]
 [-1.68771463e-01 -6.40388330e-02]
 [ 1.70096343e-02 -6.22233892e-02]
 [-2.76117603e-01  1.27361765e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.27743105e-01 -5.36570970e-04]
 [-2.90161636e-02 -1.62632341e-01]
 [-2.29023420e-03 -5.46419275e-02]
 [-5.16977973e-02 -3.87228966e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.1262915]
curr_Stock_Price:  101.37095225475885
curr_Factors:  [1.01370952e+02 3.86686734e-02]
mat_Sqrt:  [[ 1.99339407e+01  0.00000000e+00]
 [-7.86574074e-03  1.80226762e-02]]
grads:  [ 0.05714864 14.46651833]
Stock Position:  0.057148644231510504
Bond Position:  [6.33307901]


portfolio before change:  [11.95956887]
curr_Stock_Price:  98.43974868680719
curr_Factors:  [9.84397487e+01 4.02770658e-02]
mat_Sqrt:  [[ 1.97560178e+01  0.00000000e+00]
 [-8.02765876e-03  1.83936770e-02]]
grads:  [0.05500925 3.94518567]
Stock Position:  0.05500925298705367
Bond Position:  [6.54447183]


portfolio before change:  [11.97532995]
curr_Stock_Price:  98.71139341648214
curr_Factors:  [9.87113934e+01 4.09852807e-02]
mat_Sqrt:  [[ 1.99839456e+01  0.00000000e+00]
 [-8.09792869e-03  1.85546856e-02]]
grads:  [ 0.00409625 -1.6488234 ]
Stock Position:  0.004096251124299703
Bond Position:  [11.5709833]


portfolio before change:  [11.97250235]
curr_Stock_Price:  97.66798496189668
curr_Factors:  [9.76679850e+01 4.09426882e-02]
mat_Sqrt:  [[ 1.97624327e+01  0.00000000e+00]
 [-8.09371985e-03  1.85450419e-02]]
grads:  [-8.24866411e-04 -8.16319601e+00]
Stock Position:  -0.0008248664113186798
Bond Position:  [12.05306539]


portfolio before change:  [11.97395617]
curr_Stock_Price:  97.73213225160136
curr_Factors:  [9.77321323e+01 3.82378366e-02]
mat_Sqrt:  [[ 1.91110272e+01  0.00000000e+00]
 [-7.82179893e-03  1.79219928e-02]]
grads:  [1.12937574e-02 4.10792617e+01]
Stock Position:  0.011293757371596663
Bond Position:  [10.87019318]


portfolio before change:  [11.98169956]
curr_Stock_Price:  98.29744703171795
curr_Factors:  [9.82974470e+01 3.77082338e-02]
mat_Sqrt:  [[ 1.90879960e+01  0.00000000e+00]
 [-7.76744322e-03  1.77974483e-02]]
grads:  [-3.25611003e-03 -6.35697330e+00]
Stock Position:  -0.0032561100274357516
Bond Position:  [12.30176686]


portfolio before change:  [11.98151914]
curr_Stock_Price:  98.82514251824678
curr_Factors:  [9.88251425e+01 3.74343070e-02]
mat_Sqrt:  [[ 1.91206366e+01  0.00000000e+00]
 [-7.73917898e-03  1.77326867e-02]]
grads:  [0.00676619 5.42145071]
Stock Position:  0.00676618565279566
Bond Position:  [11.31284988]


portfolio before change:  [11.97756478]
curr_Stock_Price:  98.03170413517452
curr_Factors:  [9.80317041e+01 3.67519908e-02]
mat_Sqrt:  [[ 1.87934705e+01  0.00000000e+00]
 [-7.66832350e-03  1.75703364e-02]]
grads:  [ 0.06243698 46.20487091]
Stock Position:  0.062436983068973384
Bond Position:  [5.85676093]


portfolio before change:  [11.98161213]
curr_Stock_Price:  98.08480101148145
curr_Factors:  [9.80848010e+01 3.66799275e-02]
mat_Sqrt:  [[ 1.87852055e+01  0.00000000e+00]
 [-7.66080179e-03  1.75531020e-02]]
grads:  [7.09418350e-03 1.81085953e+01]
Stock Position:  0.007094183504770157
Bond Position:  [11.28578055]


portfolio before change:  [11.99281468]
curr_Stock_Price:  99.46504955467401
curr_Factors:  [9.94650496e+01 3.75644588e-02]
mat_Sqrt:  [[ 1.92778711e+01  0.00000000e+00]
 [-7.75262111e-03  1.77634865e-02]]
grads:  [0.01051375 2.67630625]
Stock Position:  0.010513747788374168
Bond Position:  [10.94706423]


portfolio before change:  [11.99301132]
curr_Stock_Price:  99.35359346881417
curr_Factors:  [9.93535935e+01 3.78885347e-02]
mat_Sqrt:  [[ 1.93391546e+01  0.00000000e+00]
 [-7.78599098e-03  1.78399465e-02]]
grads:  [-0.00595103  0.01694236]
Stock Position:  -0.005951025579084058
Bond Position:  [12.5842671]


portfolio before change:  [12.00072847]
curr_Stock_Price:  98.32116431268838
curr_Factors:  [9.83211643e+01 3.82279716e-02]
mat_Sqrt:  [[ 1.92237292e+01  0.00000000e+00]
 [-7.82078989e-03  1.79196808e-02]]
grads:  [-1.48378285e-03 -7.59015195e+00]
Stock Position:  -0.0014837828539471544
Bond Position:  [12.14661573]


portfolio before change:  [12.00233]
curr_Stock_Price:  98.26515161597564
curr_Factors:  [9.82651516e+01 3.95058380e-02]
mat_Sqrt:  [[ 1.95312558e+01  0.00000000e+00]
 [-7.95043022e-03  1.82167242e-02]]
grads:  [-0.00662266 -1.53987099]
Stock Position:  -0.006622661113691613
Bond Position:  [12.6531068]


portfolio before change:  [12.00584169]
curr_Stock_Price:  97.97373472575764
curr_Factors:  [9.79737347e+01 3.93309409e-02]
mat_Sqrt:  [[ 1.94301803e+01  0.00000000e+00]
 [-7.93281195e-03  1.81763556e-02]]
grads:  [-2.14470402e-03  5.95531261e+00]
Stock Position:  -0.002144704015834263
Bond Position:  [12.21596636]


portfolio before change:  [12.00996028]
curr_Stock_Price:  96.76541364084979
curr_Factors:  [9.67654136e+01 4.06270059e-02]
mat_Sqrt:  [[ 1.95041742e+01  0.00000000e+00]
 [-8.06245679e-03  1.84734093e-02]]
grads:  [ 0.02770669 15.20012802]
Stock Position:  0.02770668742143443
Bond Position:  [9.32891121]


portfolio before change:  [11.98186525]
curr_Stock_Price:  95.70930730570724
curr_Factors:  [9.57093073e+01 4.05520284e-02]
mat_Sqrt:  [[ 1.92734945e+01  0.00000000e+00]
 [-8.05501368e-03  1.84563550e-02]]
grads:  [ 0.00559297 -3.10698279]
Stock Position:  0.005592971671760386
Bond Position:  [11.44656581]


portfolio before change:  [11.9910856]
curr_Stock_Price:  97.1020248769506
curr_Factors:  [9.71020249e+01 4.26259958e-02]
mat_Sqrt:  [[ 2.00477462e+01  0.00000000e+00]
 [-8.25842559e-03  1.89224302e-02]]
grads:  [4.77867250e-03 6.71223124e+00]
Stock Position:  0.0047786724957169955
Bond Position:  [11.52706682]


portfolio before change:  [11.98903814]
curr_Stock_Price:  96.37202516949287
curr_Factors:  [9.63720252e+01 4.24172456e-02]
mat_Sqrt:  [[ 1.98482498e+01  0.00000000e+00]
 [-8.23817898e-03  1.88760394e-02]]
grads:  [0.00901712 4.26595679]
Stock Position:  0.009017118833130671
Bond Position:  [11.12004014]


portfolio before change:  [12.0081855]
curr_Stock_Price:  98.34130932044664
curr_Factors:  [9.83413093e+01 4.26029850e-02]
mat_Sqrt:  [[ 2.02981287e+01  0.00000000e+00]
 [-8.25619622e-03  1.89173221e-02]]
grads:  [-0.00363342 -2.09514945]
Stock Position:  -0.0036334249059904494
Bond Position:  [12.36550126]


portfolio before change:  [12.00579485]
curr_Stock_Price:  99.42470494871654
curr_Factors:  [9.94247049e+01 4.12910346e-02]
mat_Sqrt:  [[ 2.02032944e+01  0.00000000e+00]
 [-8.12807821e-03  1.86237668e-02]]
grads:  [-0.00465933 -1.94869252]
Stock Position:  -0.004659334335674837
Bond Position:  [12.46904779]


portfolio before change:  [12.01278246]
curr_Stock_Price:  98.25954203073107
curr_Factors:  [9.82595420e+01 4.22763412e-02]
mat_Sqrt:  [[ 2.02033521e+01  0.00000000e+00]
 [-8.22448454e-03  1.88446615e-02]]
grads:  [ 0.00759608 -1.25020475]
Stock Position:  0.007596079469921887
Bond Position:  [11.26639517]


portfolio before change:  [12.03007398]
curr_Stock_Price:  100.35050622978851
curr_Factors:  [1.00350506e+02 4.13117779e-02]
mat_Sqrt:  [[ 2.03965404e+01  0.00000000e+00]
 [-8.13011959e-03  1.86284442e-02]]
grads:  [ 0.03635112 -2.89131227]
Stock Position:  0.03635112344605094
Bond Position:  [8.38222034]


portfolio before change:  [12.01704375]
curr_Stock_Price:  99.9632260335755
curr_Factors:  [9.99632260e+01 4.15908959e-02]
mat_Sqrt:  [[ 2.03863465e+01  0.00000000e+00]
 [-8.15753845e-03  1.86912687e-02]]
grads:  [-2.42396609e-03 -9.20760839e+00]
Stock Position:  -0.002423966090855562
Bond Position:  [12.25935122]


portfolio before change:  [12.01652237]
curr_Stock_Price:  100.81055346039118
curr_Factors:  [1.00810553e+02 4.08751201e-02]
mat_Sqrt:  [[ 2.03814707e+01  0.00000000e+00]
 [-8.08703853e-03  1.85297331e-02]]
grads:  [0.00171951 0.96265358]
Stock Position:  0.0017195147985127758
Bond Position:  [11.84317713]


portfolio before change:  [12.01904573]
curr_Stock_Price:  101.41704270828343
curr_Factors:  [1.01417043e+02 3.99929991e-02]
mat_Sqrt:  [[ 2.02816334e+01  0.00000000e+00]
 [-7.99929988e-03  1.83286986e-02]]
grads:  [ 0.00936708 -9.34951683]
Stock Position:  0.009367078100962423
Bond Position:  [11.06906437]


portfolio before change:  [12.01850579]
curr_Stock_Price:  101.21167919508981
curr_Factors:  [1.01211679e+02 4.08837975e-02]
mat_Sqrt:  [[ 2.04647406e+01  0.00000000e+00]
 [-8.08789689e-03  1.85316998e-02]]
grads:  [ 0.00584635 -4.63693374]
Stock Position:  0.005846351638839967
Bond Position:  [11.42678673]


portfolio before change:  [12.02874145]
curr_Stock_Price:  102.71812663429253
curr_Factors:  [1.02718127e+02 3.93642184e-02]
mat_Sqrt:  [[ 2.03797056e+01  0.00000000e+00]
 [-7.93616718e-03  1.81840434e-02]]
grads:  [-0.00646948  4.02599274]
Stock Position:  -0.0064694824526981805
Bond Position:  [12.69327457]


portfolio before change:  [12.0368926]
curr_Stock_Price:  101.70345721327965
curr_Factors:  [1.01703457e+02 4.16884321e-02]
mat_Sqrt:  [[ 2.07655528e+01  0.00000000e+00]
 [-8.16709810e-03  1.87131726e-02]]
grads:  [7.22370423e-03 1.48243352e+01]
Stock Position:  0.007223704226326739
Bond Position:  [11.3022169]


portfolio before change:  [12.0328895]
curr_Stock_Price:  100.95370942098099
curr_Factors:  [1.00953709e+02 4.14882456e-02]
mat_Sqrt:  [[ 2.05629214e+01  0.00000000e+00]
 [-8.14746543e-03  1.86681885e-02]]
grads:  [3.02153526e-03 9.75574434e+00]
Stock Position:  0.0030215352649030133
Bond Position:  [11.72785431]


portfolio before change:  [12.03513709]
curr_Stock_Price:  101.21235741726004
curr_Factors:  [1.01212357e+02 4.35059847e-02]
mat_Sqrt:  [[ 2.11109629e+01  0.00000000e+00]
 [-8.34323532e-03  1.91167537e-02]]
grads:  [-0.02869525 -4.74725999]
Stock Position:  -0.02869525136160136
Bond Position:  [14.93945113]


portfolio before change:  [12.02771851]
curr_Stock_Price:  101.53596968511332
curr_Factors:  [1.01535970e+02 4.38833908e-02]
mat_Sqrt:  [[ 2.12701234e+01  0.00000000e+00]
 [-8.37934516e-03  1.91994917e-02]]
grads:  [-0.00924867 -3.33544418]
Stock Position:  -0.009248667593362882
Bond Position:  [12.96679094]


portfolio before change:  [12.02823172]
curr_Stock_Price:  101.65574239263435
curr_Factors:  [1.01655742e+02 4.28288744e-02]
mat_Sqrt:  [[ 2.10377963e+01  0.00000000e+00]
 [-8.27805527e-03  1.89674074e-02]]
grads:  [-4.82316633e-04 -3.28054266e+00]
Stock Position:  -0.00048231663332575425
Bond Position:  [12.07726197]


portfolio before change:  [12.02957233]
curr_Stock_Price:  102.00642481109134
curr_Factors:  [1.02006425e+02 4.28882390e-02]
mat_Sqrt:  [[ 2.11249959e+01  0.00000000e+00]
 [-8.28379034e-03  1.89805481e-02]]
grads:  [-0.0104394   6.71012047]
Stock Position:  -0.0104394042224806
Bond Position:  [13.09445863]


portfolio before change:  [12.01735636]
curr_Stock_Price:  103.3334051330066
curr_Factors:  [1.03333405e+02 4.37064949e-02]
mat_Sqrt:  [[ 2.16029833e+01  0.00000000e+00]
 [-8.36243935e-03  1.91607557e-02]]
grads:  [0.00469709 2.78428794]
Stock Position:  0.0046970906814130155
Bond Position:  [11.53198998]


portfolio before change:  [12.01591725]
curr_Stock_Price:  102.72011216268479
curr_Factors:  [1.02720112e+02 4.65444716e-02]
mat_Sqrt:  [[ 2.21610094e+01  0.00000000e+00]
 [-8.62966712e-03  1.97730514e-02]]
grads:  [-0.00427181  4.11292848]
Stock Position:  -0.004271809519641287
Bond Position:  [12.454718]


portfolio before change:  [12.00999352]
curr_Stock_Price:  104.47128275782661
curr_Factors:  [1.04471283e+02 4.45097799e-02]
mat_Sqrt:  [[ 2.20406628e+01  0.00000000e+00]
 [-8.43893641e-03  1.93360324e-02]]
grads:  [-0.01488055 -0.0277498 ]
Stock Position:  -0.014880554465991099
Bond Position:  [13.56458413]


portfolio before change:  [11.99718397]
curr_Stock_Price:  105.44606058736689
curr_Factors:  [1.05446061e+02 4.24038856e-02]
mat_Sqrt:  [[ 2.17136677e+01  0.00000000e+00]
 [-8.23688151e-03  1.88730665e-02]]
grads:  [-4.60515183e-03 -8.61716569e+00]
Stock Position:  -0.004605151827668735
Bond Position:  [12.48277908]


portfolio before change:  [12.01215903]
curr_Stock_Price:  102.53310143454097
curr_Factors:  [1.02533101e+02 4.35328301e-02]
mat_Sqrt:  [[ 2.13930421e+01  0.00000000e+00]
 [-8.34580901e-03  1.91226508e-02]]
grads:  [-1.22179569e-03 -2.85744525e+00]
Stock Position:  -0.0012217956861844401
Bond Position:  [12.13743353]


portfolio before change:  [12.01379426]
curr_Stock_Price:  102.4365543022284
curr_Factors:  [1.02436554e+02 4.31561109e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.01379426]
Stock Price:  100.91331453003328
PL:  [11.10047973]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.43344064e+00  3.59015288e-01]
 [ 9.27265590e-01  8.43735270e-02]
 [-2.08088930e-01  2.08449855e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.28247383e-01  1.01673366e+00]
 [-9.37246951e-03 -1.04361790e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 7.40542007e-01  7.24301338e-01]
 [-9.78968374e-02 -6.80088067e-03]
 [ 1.53901635e-01  1.23691771e-02]
 [-7.77753675e-02 -1.10008106e-02]
 [-6.48061248e-02 -1.43330584e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.78767718e-02 -4.16166254e-02]
 [ 5.19384204e-01  3.40790666e-01]
 [ 1.30112108e-01  1.08052161e-01]
 [ 3.94737515e-02  1.06211521e-01]
 [-3.61292557e-03  1.71462780e-02]
 [-1.01838621e-01 -3.91731756e-01]
 [-6.60283682e-02 -4.54006909e-02]
 [ 1.75080772e-01 -4.24464520e-02]
 [ 8.43093529e-01 -6.16298490e-03]
 [ 2.61782967e-02 -1.95869413e-01]
 [-4.29908892e-05  3.10776187e-02]
 [-2.10151679e-01  2.16536924e-01]
 [ 1.34045887e-01 -1.01768331e-01]
 [-1.46445718e-01 -4.48988220e-01]
 [ 5.43317342e-02  8.65837750e-02]
 [ 3.61547997e-01 -1.45164662e-01]
 [-5.33139212e-01 -1.71674601e-01]
 [-6.12522555e-02 -1.95314721e-02]
 [-8.36016764e-03 -3.20670309e-02]
 [ 8.27203929e-02  1.88744388e-01]
 [ 4.22098967e-03  8.69681582e-03]
 [ 8.40055565e-02 -4.84934699e-02]
 [-8.16936441e-02  1.18768703e-01]
 [-4.50960814e-02 -1.08430127e-02]
 [-1.13348607e-01 -6.17796339e-02]
 [ 1.15821605e-01 -1.04924618e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.20888107]
curr_Stock_Price:  98.41920098928317
curr_Factors:  [9.84192010e+01 4.02804529e-02]
mat_Sqrt:  [[ 1.97527245e+01  0.00000000e+00]
 [-8.02799630e-03  1.83944504e-02]]
grads:  [ 0.08050169 19.51758716]
Stock Position:  0.08050169266043658
Bond Position:  [-16.13179334]


portfolio before change:  [-8.17754924]
curr_Stock_Price:  98.8334585013843
curr_Factors:  [9.88334585e+01 4.04923884e-02]
mat_Sqrt:  [[ 1.98879807e+01  0.00000000e+00]
 [-8.04908824e-03  1.84427781e-02]]
grads:  [0.04847597 4.57488165]
Stock Position:  0.048475973033065105
Bond Position:  [-12.96859731]


portfolio before change:  [-8.29845051]
curr_Stock_Price:  96.37285620701672
curr_Factors:  [9.63728562e+01 4.18764666e-02]
mat_Sqrt:  [[ 1.97214910e+01  0.00000000e+00]
 [-8.18549611e-03  1.87553278e-02]]
grads:  [-5.93839252e-03  1.11141676e+01]
Stock Position:  -0.005938392517414728
Bond Position:  [-7.72615066]


portfolio before change:  [-8.30796166]
curr_Stock_Price:  97.81185256725556
curr_Factors:  [9.78118526e+01 4.13914203e-02]
mat_Sqrt:  [[ 1.98997055e+01  0.00000000e+00]
 [-8.13795260e-03  1.86463919e-02]]
grads:  [-8.19176292e-04 -8.11882606e+00]
Stock Position:  -0.0008191762920664517
Bond Position:  [-8.22783651]


portfolio before change:  [-8.30821747]
curr_Stock_Price:  96.86854933455238
curr_Factors:  [9.68685493e+01 4.05206625e-02]
mat_Sqrt:  [[ 1.94993918e+01  0.00000000e+00]
 [-8.05189791e-03  1.84492158e-02]]
grads:  [1.61795593e-02 5.51098578e+01]
Stock Position:  0.01617955934421998
Bond Position:  [-9.87550792]


portfolio before change:  [-8.28899569]
curr_Stock_Price:  98.13287892237899
curr_Factors:  [9.81328789e+01 4.03535009e-02]
mat_Sqrt:  [[ 1.97131102e+01  0.00000000e+00]
 [-8.03527233e-03  1.84111219e-02]]
grads:  [-2.78594743e-03 -5.66841013e+00]
Stock Position:  -0.002785947428365757
Bond Position:  [-8.01560265]


portfolio before change:  [-8.28848604]
curr_Stock_Price:  97.59027528408502
curr_Factors:  [9.75902753e+01 4.08227767e-02]
mat_Sqrt:  [[ 1.97177708e+01  0.00000000e+00]
 [-8.08185887e-03  1.85178650e-02]]
grads:  [0.00656128 5.19157511]
Stock Position:  0.006561278076508466
Bond Position:  [-8.92880298]


portfolio before change:  [-8.28300896]
curr_Stock_Price:  98.5951476495904
curr_Factors:  [9.85951476e+01 4.08600268e-02]
mat_Sqrt:  [[ 1.99298883e+01  0.00000000e+00]
 [-8.08554531e-03  1.85263117e-02]]
grads:  [ 0.05301851 39.09581948]
Stock Position:  0.053018512135884835
Bond Position:  [-13.510377]


portfolio before change:  [-8.18171504]
curr_Stock_Price:  100.53754140542834
curr_Factors:  [1.00537541e+02 4.03638338e-02]
mat_Sqrt:  [[ 2.01987487e+01  0.00000000e+00]
 [-8.03630102e-03  1.84134789e-02]]
grads:  [-0.00499363 -0.36934252]
Stock Position:  -0.004993625432836529
Bond Position:  [-7.67966822]


portfolio before change:  [-8.1835865]
curr_Stock_Price:  100.72006238521311
curr_Factors:  [1.00720062e+02 4.18585405e-02]
mat_Sqrt:  [[ 2.06066800e+01  0.00000000e+00]
 [-8.18374393e-03  1.87513130e-02]]
grads:  [0.0077305  0.65964325]
Stock Position:  0.007730502278568455
Bond Position:  [-8.96220317]


portfolio before change:  [-8.18209629]
curr_Stock_Price:  101.05775761954988
curr_Factors:  [1.01057758e+02 4.10783856e-02]
mat_Sqrt:  [[ 2.04821877e+01  0.00000000e+00]
 [-8.10712137e-03  1.85757487e-02]]
grads:  [-0.00403163 -0.59221358]
Stock Position:  -0.004031625735282796
Bond Position:  [-7.77466924]


portfolio before change:  [-8.19026577]
curr_Stock_Price:  102.84303953824747
curr_Factors:  [1.02843040e+02 4.02779324e-02]
mat_Sqrt:  [[ 2.06399427e+01  0.00000000e+00]
 [-8.02774513e-03  1.83938748e-02]]
grads:  [-6.17059465e-03 -7.79229964e+00]
Stock Position:  -0.006170594653532009
Bond Position:  [-7.55566306]


portfolio before change:  [-8.19194242]
curr_Stock_Price:  102.96168694358876
curr_Factors:  [1.02961687e+02 4.06956695e-02]
mat_Sqrt:  [[ 2.07706338e+01  0.00000000e+00]
 [-8.06926708e-03  1.84890136e-02]]
grads:  [-0.00315395 -0.9676018 ]
Stock Position:  -0.003153949068493333
Bond Position:  [-7.8672065]


portfolio before change:  [-8.18716218]
curr_Stock_Price:  101.13423225444087
curr_Factors:  [1.01134232e+02 4.07023161e-02]
mat_Sqrt:  [[ 2.04036443e+01  0.00000000e+00]
 [-8.06992601e-03  1.84905234e-02]]
grads:  [-0.00274656 -2.25070024]
Stock Position:  -0.0027465562228532444
Bond Position:  [-7.90939133]


portfolio before change:  [-8.1814255]
curr_Stock_Price:  98.68555850234064
curr_Factors:  [9.86855585e+01 4.21951793e-02]
mat_Sqrt:  [[ 2.02714597e+01  0.00000000e+00]
 [-8.21658608e-03  1.88265638e-02]]
grads:  [ 0.03295853 18.10158606]
Stock Position:  0.032958526664140404
Bond Position:  [-11.43395611]


portfolio before change:  [-8.21399896]
curr_Stock_Price:  97.74060953167387
curr_Factors:  [9.77406095e+01 4.06858409e-02]
mat_Sqrt:  [[ 1.97149959e+01  0.00000000e+00]
 [-8.06829260e-03  1.84867808e-02]]
grads:  [0.00899163 5.8448338 ]
Stock Position:  0.008991629433333743
Bond Position:  [-9.0928463]


portfolio before change:  [-8.20351371]
curr_Stock_Price:  99.03313647678216
curr_Factors:  [9.90331365e+01 3.86244579e-02]
mat_Sqrt:  [[ 1.94630874e+01  0.00000000e+00]
 [-7.86124243e-03  1.80123693e-02]]
grads:  [4.40979677e-03 5.89658806e+00]
Stock Position:  0.00440979676692637
Bond Position:  [-8.64022971]


portfolio before change:  [-8.20560901]
curr_Stock_Price:  98.80292141838264
curr_Factors:  [9.88029214e+01 3.99135926e-02]
mat_Sqrt:  [[ 1.97392295e+01  0.00000000e+00]
 [-7.99135459e-03  1.83104937e-02]]
grads:  [1.96072682e-04 9.36418118e-01]
Stock Position:  0.00019607268157146148
Bond Position:  [-8.22498156]


portfolio before change:  [-8.20642995]
curr_Stock_Price:  99.85988392179121
curr_Factors:  [9.98598839e+01 3.88058004e-02]
mat_Sqrt:  [[ 1.96715862e+01  0.00000000e+00]
 [-7.87967516e-03  1.80546039e-02]]
grads:  [-1.38679400e-02 -2.16970562e+01]
Stock Position:  -0.013867939952606224
Bond Position:  [-6.82157908]


portfolio before change:  [-8.20927828]
curr_Stock_Price:  100.0037827243771
curr_Factors:  [1.00003783e+02 3.79091065e-02]
mat_Sqrt:  [[ 1.94709975e+01  0.00000000e+00]
 [-7.78810441e-03  1.78447890e-02]]
grads:  [-0.00440875 -2.54419881]
Stock Position:  -0.0044087548121135535
Bond Position:  [-7.76838612]


portfolio before change:  [-8.21313505]
curr_Stock_Price:  100.65831180852247
curr_Factors:  [1.00658312e+02 3.70499288e-02]
mat_Sqrt:  [[ 1.93750723e+01  0.00000000e+00]
 [-7.69934323e-03  1.76414116e-02]]
grads:  [ 0.00808026 -2.40606892]
Stock Position:  0.008080260013790592
Bond Position:  [-9.02648038]


portfolio before change:  [-8.2209134]
curr_Stock_Price:  99.83532229188393
curr_Factors:  [9.98353223e+01 3.89186328e-02]
mat_Sqrt:  [[ 1.96953187e+01  0.00000000e+00]
 [-7.89112239e-03  1.80808328e-02]]
grads:  [ 0.04267023 -0.34085736]
Stock Position:  0.042670230215940734
Bond Position:  [-12.48090959]


portfolio before change:  [-8.21006325]
curr_Stock_Price:  100.1261657482991
curr_Factors:  [1.00126166e+02 3.89370025e-02]
mat_Sqrt:  [[ 1.97573568e+01  0.00000000e+00]
 [-7.89298448e-03  1.80850994e-02]]
grads:  [-3.00172356e-03 -1.08304305e+01]
Stock Position:  -0.003001723559709351
Bond Position:  [-7.90951218]


portfolio before change:  [-8.21130529]
curr_Stock_Price:  100.21054590535681
curr_Factors:  [1.00210546e+02 3.89020337e-02]
mat_Sqrt:  [[ 1.97651257e+01  0.00000000e+00]
 [-7.88943939e-03  1.80769766e-02]]
grads:  [6.84053017e-04 1.71918233e+00]
Stock Position:  0.0006840530168040767
Bond Position:  [-8.27985462]


portfolio before change:  [-8.21427086]
curr_Stock_Price:  97.38835905810569
curr_Factors:  [9.73883591e+01 4.05368018e-02]
mat_Sqrt:  [[ 1.96079319e+01  0.00000000e+00]
 [-8.05350128e-03  1.84528896e-02]]
grads:  [-5.89798139e-03  1.17345808e+01]
Stock Position:  -0.0058979813948511995
Bond Position:  [-7.63987613]


portfolio before change:  [-8.21477291]
curr_Stock_Price:  97.3115537983488
curr_Factors:  [9.73115538e+01 4.02461581e-02]
mat_Sqrt:  [[ 1.95221040e+01  0.00000000e+00]
 [-8.02457805e-03  1.83866182e-02]]
grads:  [ 4.59123392e-03 -5.53491297e+00]
Stock Position:  0.004591233916268622
Bond Position:  [-8.66155302]


portfolio before change:  [-8.2191381]
curr_Stock_Price:  96.5966201304357
curr_Factors:  [9.65966201e+01 4.10356550e-02]
mat_Sqrt:  [[ 1.95678277e+01  0.00000000e+00]
 [-8.10290368e-03  1.85660847e-02]]
grads:  [-1.74981223e-02 -2.41832474e+01]
Stock Position:  -0.017498122291408645
Bond Position:  [-6.52887863]


portfolio before change:  [-8.24499393]
curr_Stock_Price:  98.02761182543327
curr_Factors:  [9.80276118e+01 4.06175309e-02]
mat_Sqrt:  [[ 1.97562804e+01  0.00000000e+00]
 [-8.06151657e-03  1.84712549e-02]]
grads:  [4.66282062e-03 4.68748741e+00]
Stock Position:  0.0046628206151832574
Bond Position:  [-8.7020791]


portfolio before change:  [-8.2540699]
curr_Stock_Price:  96.31445498708325
curr_Factors:  [9.6314455e+01 4.0260316e-02]
mat_Sqrt:  [[ 1.93254698e+01  0.00000000e+00]
 [-8.02598938e-03  1.83898519e-02]]
grads:  [ 0.01543005 -7.8937374 ]
Stock Position:  0.01543004892015121
Bond Position:  [-9.74020665]


portfolio before change:  [-8.2401599]
curr_Stock_Price:  97.29485351531153
curr_Factors:  [9.72948535e+01 3.97785563e-02]
mat_Sqrt:  [[ 1.94050326e+01  0.00000000e+00]
 [-7.97782490e-03  1.82794932e-02]]
grads:  [-0.03133538 -9.39164991]
Stock Position:  -0.031335384093760715
Bond Position:  [-5.1913883]


portfolio before change:  [-8.2235885]
curr_Stock_Price:  96.7453033907176
curr_Factors:  [9.67453034e+01 3.90719920e-02]
mat_Sqrt:  [[ 1.91232925e+01  0.00000000e+00]
 [-7.90665461e-03  1.81164216e-02]]
grads:  [-0.00364877 -1.07810872]
Stock Position:  -0.003648769624353934
Bond Position:  [-7.87058718]


portfolio before change:  [-8.2280746]
curr_Stock_Price:  97.70513815066923
curr_Factors:  [9.77051382e+01 3.71014549e-02]
mat_Sqrt:  [[ 1.88197077e+01  0.00000000e+00]
 [-7.70469518e-03  1.76536744e-02]]
grads:  [-1.18787006e-03 -1.81645079e+00]
Stock Position:  -0.001187870059952534
Bond Position:  [-8.1120136]


portfolio before change:  [-8.22866714]
curr_Stock_Price:  97.35027345877673
curr_Factors:  [9.73502735e+01 3.62318131e-02]
mat_Sqrt:  [[ 1.85302897e+01  0.00000000e+00]
 [-7.61386242e-03  1.74455504e-02]]
grads:  [8.90947738e-03 1.08190560e+01]
Stock Position:  0.008909477382515376
Bond Position:  [-9.0960072]


portfolio before change:  [-8.22673391]
curr_Stock_Price:  97.6948842745669
curr_Factors:  [9.76948843e+01 3.55056867e-02]
mat_Sqrt:  [[ 1.84086008e+01  0.00000000e+00]
 [-7.53718109e-03  1.72698514e-02]]
grads:  [4.35480748e-04 5.03583708e-01]
Stock Position:  0.00043548074831985066
Bond Position:  [-8.26927815]


portfolio before change:  [-8.22793204]
curr_Stock_Price:  97.3173519557732
curr_Factors:  [9.73173520e+01 3.61293575e-02]
mat_Sqrt:  [[ 1.84978137e+01  0.00000000e+00]
 [-7.60308963e-03  1.74208669e-02]]
grads:  [ 0.00339723 -2.78364276]
Stock Position:  0.0033972269363437995
Bond Position:  [-8.55854117]


portfolio before change:  [-8.22722592]
curr_Stock_Price:  97.84013089524878
curr_Factors:  [9.78401309e+01 3.42923891e-02]
mat_Sqrt:  [[ 1.81182354e+01  0.00000000e+00]
 [-7.40728173e-03  1.69722146e-02]]
grads:  [-1.64799341e-03  6.99783181e+00]
Stock Position:  -0.0016479934056384412
Bond Position:  [-8.06598603]


portfolio before change:  [-8.22649086]
curr_Stock_Price:  96.78225567909698
curr_Factors:  [9.67822557e+01 3.34284445e-02]
mat_Sqrt:  [[ 1.76951327e+01  0.00000000e+00]
 [-7.31337892e-03  1.67570562e-02]]
grads:  [-0.00281594 -0.64707145]
Stock Position:  -0.002815935938783123
Bond Position:  [-7.95395823]


portfolio before change:  [-8.23091937]
curr_Stock_Price:  98.0018155423098
curr_Factors:  [9.80018155e+01 3.27080447e-02]
mat_Sqrt:  [[ 1.77239866e+01  0.00000000e+00]
 [-7.23414621e-03  1.65755113e-02]]
grads:  [-0.00791647 -3.72716309]
Stock Position:  -0.00791647235703779
Bond Position:  [-7.45509071]


portfolio before change:  [-8.22469855]
curr_Stock_Price:  97.09828593515961
curr_Factors:  [9.70982859e+01 3.30136399e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.22469855]
Stock Price:  96.71411983107093
PL:  [-8.22469855]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.11692798e+00  2.81416253e-01]
 [-2.68643758e-01 -9.84199711e-02]
 [-2.60998967e-01 -1.24321779e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.20227685e-01 -4.30283296e-01]
 [-4.04445805e-01  2.47004576e-01]
 [ 2.22180122e-01 -2.42003766e-01]
 [-2.22541831e-02  3.84029666e-01]
 [-1.08452619e-01 -5.44922244e-02]
 [-3.65272375e-02 -2.57700958e-01]
 [-7.07111040e-02 -1.24031877e-02]
 [-9.29088852e-02 -1.59311183e-01]
 [-5.11461981e-02 -2.71741069e-02]
 [ 2.32837999e-02 -2.00325627e-01]
 [ 1.23695537e-01  7.20818368e-02]
 [ 1.19977983e-01 -6.54194516e-01]
 [ 2.05826314e-02 -2.56774809e-01]
 [ 3.13497991e-02 -1.52784577e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-6.25096494e-02 -4.74606907e-02]
 [ 1.81435425e-01 -4.66029452e-02]
 [ 6.42054821e-01 -1.33924431e-01]
 [ 3.00217690e-02 -4.07207377e-01]
 [ 4.81069772e-02  2.24982234e-02]
 [ 4.18484474e-01 -3.34867609e-01]
 [-2.57251206e-01  1.87039685e-02]
 [-1.57531174e-01  9.21483255e-02]
 [-1.66363151e-02  1.98962696e-01]
 [-1.61915766e-02  1.81326948e-01]
 [-5.19332248e-01 -1.10997777e-01]
 [-1.66861141e-01 -6.19522480e-02]
 [ 3.51572543e-02 -5.16119928e-02]
 [-2.80794308e-01  1.13813055e-01]
 [ 6.47668639e-02  6.36304328e-02]
 [-5.66180642e-02  8.56418712e-02]
 [-1.87661501e-01  9.86301683e-02]
 [-2.31173665e-02 -2.16055346e-01]
 [-3.71090154e-02 -3.88345896e-02]
 [-7.73027399e-03 -1.06562152e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.98817886]
curr_Stock_Price:  100.91543962409855
curr_Factors:  [1.00915440e+02 4.03144667e-02]
mat_Sqrt:  [[ 2.02622690e+01  0.00000000e+00]
 [-8.03138510e-03  1.84022151e-02]]
grads:  [ 0.06118506 15.2925206 ]
Stock Position:  0.061185058069104084
Bond Position:  [2.81366182]


portfolio before change:  [9.06604297]
curr_Stock_Price:  102.18229113259207
curr_Factors:  [1.02182291e+02 3.98923631e-02]
mat_Sqrt:  [[ 2.04089432e+01  0.00000000e+00]
 [-7.98922905e-03  1.83056234e-02]]
grads:  [-0.01526771 -5.37648834]
Stock Position:  -0.015267706485989477
Bond Position:  [10.6261322]


portfolio before change:  [9.07172716]
curr_Stock_Price:  101.89699339801935
curr_Factors:  [1.01896993e+02 4.15632545e-02]
mat_Sqrt:  [[ 2.07738094e+01  0.00000000e+00]
 [-8.15482723e-03  1.86850565e-02]]
grads:  [-0.01517572 -6.65354043]
Stock Position:  -0.015175716358265177
Bond Position:  [10.61808703]


portfolio before change:  [9.08136483]
curr_Stock_Price:  101.34938675335057
curr_Factors:  [1.01349387e+02 4.21863734e-02]
mat_Sqrt:  [[ 2.08164765e+01  0.00000000e+00]
 [-8.21572866e-03  1.88245992e-02]]
grads:  [-7.83099240e-04 -8.04196735e+00]
Stock Position:  -0.000783099239833178
Bond Position:  [9.16073146]


portfolio before change:  [9.08177819]
curr_Stock_Price:  102.28388441313919
curr_Factors:  [1.02283884e+02 4.11147127e-02]
mat_Sqrt:  [[ 2.07398611e+01  0.00000000e+00]
 [-8.11070529e-03  1.85839605e-02]]
grads:  [-1.48515320e-02 -2.31534767e+01]
Stock Position:  -0.014851532018451108
Bond Position:  [10.60085057]


portfolio before change:  [9.07294173]
curr_Stock_Price:  102.96809968516546
curr_Factors:  [1.02968100e+02 4.00804349e-02]
mat_Sqrt:  [[ 2.06143151e+01  0.00000000e+00]
 [-8.00803945e-03  1.83487235e-02]]
grads:  [-0.0143902  13.46167631]
Stock Position:  -0.014390202564542357
Bond Position:  [10.55467354]


portfolio before change:  [9.08561184]
curr_Stock_Price:  102.17932021804175
curr_Factors:  [1.02179320e+02 4.05646213e-02]
mat_Sqrt:  [[ 2.05795902e+01  0.00000000e+00]
 [-8.05626428e-03  1.84592204e-02]]
grads:  [ 5.66391354e-03 -1.31101835e+01]
Stock Position:  0.005663913538897352
Bond Position:  [8.50687701]


portfolio before change:  [9.08142677]
curr_Stock_Price:  101.25266473170805
curr_Factors:  [1.01252665e+02 4.22276911e-02]
mat_Sqrt:  [[ 2.08067922e+01  0.00000000e+00]
 [-8.21975095e-03  1.88338155e-02]]
grads:  [6.98570461e-03 2.03904337e+01]
Stock Position:  0.006985704608726877
Bond Position:  [8.37410557]


portfolio before change:  [9.08012365]
curr_Stock_Price:  100.91627068376543
curr_Factors:  [1.00916271e+02 4.21382736e-02]
mat_Sqrt:  [[ 2.07156976e+01  0.00000000e+00]
 [-8.21104365e-03  1.88138645e-02]]
grads:  [-0.00638332 -2.89638656]
Stock Position:  -0.006383322366587813
Bond Position:  [9.72430474]


portfolio before change:  [9.07610896]
curr_Stock_Price:  101.73564117507566
curr_Factors:  [1.01735641e+02 4.14974093e-02]
mat_Sqrt:  [[ 2.07244789e+01  0.00000000e+00]
 [-8.14836517e-03  1.86702501e-02]]
grads:  [-7.18942837e-03 -1.38027588e+01]
Stock Position:  -0.007189428370211685
Bond Position:  [9.80753007]


portfolio before change:  [9.06856258]
curr_Stock_Price:  102.95582178276663
curr_Factors:  [1.02955822e+02 4.13904159e-02]
mat_Sqrt:  [[ 2.09459858e+01  0.00000000e+00]
 [-8.13785386e-03  1.86461657e-02]]
grads:  [-0.00363431 -0.66518704]
Stock Position:  -0.0036343144523026723
Bond Position:  [9.44273641]


portfolio before change:  [9.0688595]
curr_Stock_Price:  103.19891990176768
curr_Factors:  [1.03198920e+02 4.12479945e-02]
mat_Sqrt:  [[ 2.09592902e+01  0.00000000e+00]
 [-8.12384092e-03  1.86140580e-02]]
grads:  [-7.75016636e-03 -8.55864871e+00]
Stock Position:  -0.00775016635724548
Bond Position:  [9.8686683]


portfolio before change:  [9.06327945]
curr_Stock_Price:  104.07808976900061
curr_Factors:  [1.04078090e+02 4.21998147e-02]
mat_Sqrt:  [[ 2.13803389e+01  0.00000000e+00]
 [-8.21703739e-03  1.88275979e-02]]
grads:  [-0.00294691 -1.44331248]
Stock Position:  -0.0029469107584683646
Bond Position:  [9.36998829]


portfolio before change:  [9.06628036]
curr_Stock_Price:  103.45724069066758
curr_Factors:  [1.03457241e+02 4.07413164e-02]
mat_Sqrt:  [[ 2.08823043e+01  0.00000000e+00]
 [-8.07379132e-03  1.84993799e-02]]
grads:  [-3.07176212e-03 -1.08287752e+01]
Stock Position:  -0.003071762116458704
Bond Position:  [9.38407639]


portfolio before change:  [9.06826125]
curr_Stock_Price:  103.19425911503426
curr_Factors:  [1.03194259e+02 4.13232858e-02]
mat_Sqrt:  [[ 2.09774629e+01  0.00000000e+00]
 [-8.13125189e-03  1.86310386e-02]]
grads:  [0.00739625 3.86891135]
Stock Position:  0.007396253325982918
Bond Position:  [8.30501037]


portfolio before change:  [9.06871725]
curr_Stock_Price:  103.11554430124148
curr_Factors:  [1.03115544e+02 4.24022994e-02]
mat_Sqrt:  [[ 2.12333658e+01  0.00000000e+00]
 [-8.23672745e-03  1.88727135e-02]]
grads:  [-7.79602784e-03 -3.46635112e+01]
Stock Position:  -0.007796027838755507
Bond Position:  [9.87260891]


portfolio before change:  [9.0585085]
curr_Stock_Price:  104.58333096033765
curr_Factors:  [1.04583331e+02 4.26195722e-02]
mat_Sqrt:  [[ 2.15907144e+01  0.00000000e+00]
 [-8.25780331e-03  1.89210044e-02]]
grads:  [-4.23714941e-03 -1.35708868e+01]
Stock Position:  -0.004237149413332912
Bond Position:  [9.5016437]


portfolio before change:  [9.06902197]
curr_Stock_Price:  102.38239526602383
curr_Factors:  [1.02382395e+02 4.29736231e-02]
mat_Sqrt:  [[ 2.12239528e+01  0.00000000e+00]
 [-8.29203214e-03  1.89994325e-02]]
grads:  [-1.66466904e-03 -8.04153373e+00]
Stock Position:  -0.0016646690359352929
Bond Position:  [9.23945478]


portfolio before change:  [9.07237756]
curr_Stock_Price:  101.06045826436744
curr_Factors:  [1.01060458e+02 4.37619298e-02]
mat_Sqrt:  [[ 2.11411932e+01  0.00000000e+00]
 [-8.36774090e-03  1.91729030e-02]]
grads:  [-1.50782948e-02 -2.44766087e+01]
Stock Position:  -0.01507829481701894
Bond Position:  [10.59619695]


portfolio before change:  [9.08746572]
curr_Stock_Price:  100.14765256497478
curr_Factors:  [1.00147653e+02 4.51703695e-02]
mat_Sqrt:  [[ 2.12847031e+01  0.00000000e+00]
 [-8.50132879e-03  1.94789913e-02]]
grads:  [-0.00391    -2.43650658]
Stock Position:  -0.003910000191192482
Bond Position:  [9.47904307]


portfolio before change:  [9.09001109]
curr_Stock_Price:  99.79972019565064
curr_Factors:  [9.97997202e+01 4.42631807e-02]
mat_Sqrt:  [[ 2.09966802e+01  0.00000000e+00]
 [-8.41552667e-03  1.92823940e-02]]
grads:  [ 0.00767246 -2.41686511]
Stock Position:  0.0076724620908974585
Bond Position:  [8.32430152]


portfolio before change:  [9.10197457]
curr_Stock_Price:  101.22336645622352
curr_Factors:  [1.01223366e+02 4.40398256e-02]
mat_Sqrt:  [[ 2.12423995e+01  0.00000000e+00]
 [-8.39426715e-03  1.92336823e-02]]
grads:  [ 0.02747361 -6.96301566]
Stock Position:  0.02747361038020314
Bond Position:  [6.32100324]


portfolio before change:  [9.14010713]
curr_Stock_Price:  102.58257578424777
curr_Factors:  [1.02582576e+02 4.26093855e-02]
mat_Sqrt:  [[ 2.11751373e+01  0.00000000e+00]
 [-8.25681638e-03  1.89187430e-02]]
grads:  [-6.97507166e-03 -2.15240186e+01]
Stock Position:  -0.006975071663322063
Bond Position:  [9.85562795]


portfolio before change:  [9.13790317]
curr_Stock_Price:  103.07518625719642
curr_Factors:  [1.03075186e+02 4.28131068e-02]
mat_Sqrt:  [[ 2.13276252e+01  0.00000000e+00]
 [-8.27653133e-03  1.89639157e-02]]
grads:  [0.00271601 1.18637015]
Stock Position:  0.0027160082920290683
Bond Position:  [8.85795011]


portfolio before change:  [9.13948296]
curr_Stock_Price:  103.24914661059242
curr_Factors:  [1.03249147e+02 4.22411359e-02]
mat_Sqrt:  [[ 2.12204341e+01  0.00000000e+00]
 [-8.22105938e-03  1.88368135e-02]]
grads:  [ 1.28336803e-02 -1.77772960e+01]
Stock Position:  0.01283368029749331
Bond Position:  [7.81441642]


portfolio before change:  [9.1550743]
curr_Stock_Price:  104.38790613006897
curr_Factors:  [1.04387906e+02 4.25739938e-02]
mat_Sqrt:  [[ 2.15388436e+01  0.00000000e+00]
 [-8.25338658e-03  1.89108844e-02]]
grads:  [-0.0115646   0.98905837]
Stock Position:  -0.011564600673646227
Bond Position:  [10.36227875]


portfolio before change:  [9.16799253]
curr_Stock_Price:  103.38286753986213
curr_Factors:  [1.03382868e+02 4.22124474e-02]
mat_Sqrt:  [[ 2.12407008e+01  0.00000000e+00]
 [-8.21826721e-03  1.88304158e-02]]
grads:  [-0.00552309  4.89358953]
Stock Position:  -0.005523092137732808
Bond Position:  [9.73898564]


portfolio before change:  [9.17160686]
curr_Stock_Price:  102.9488935692807
curr_Factors:  [1.02948894e+02 4.26113613e-02]
mat_Sqrt:  [[ 2.12512455e+01  0.00000000e+00]
 [-8.25700782e-03  1.89191817e-02]]
grads:  [3.30324755e-03 1.05164536e+01]
Stock Position:  0.003303247545524904
Bond Position:  [8.83154118]


portfolio before change:  [9.16578241]
curr_Stock_Price:  100.85142419135805
curr_Factors:  [1.00851424e+02 4.31079902e-02]
mat_Sqrt:  [[ 2.09392404e+01  0.00000000e+00]
 [-8.30498551e-03  1.90291124e-02]]
grads:  [3.00612583e-03 9.52892307e+00]
Stock Position:  0.0030061258283925413
Bond Position:  [8.86261034]


portfolio before change:  [9.16371139]
curr_Stock_Price:  99.7939441323618
curr_Factors:  [9.97939441e+01 4.30672466e-02]
mat_Sqrt:  [[ 2.07098876e+01  0.00000000e+00]
 [-8.30105985e-03  1.90201176e-02]]
grads:  [-0.02741568 -5.83580922]
Stock Position:  -0.027415679979518666
Bond Position:  [11.89963023]


portfolio before change:  [9.16695031]
curr_Stock_Price:  99.730062027636
curr_Factors:  [9.97300620e+01 4.24671324e-02]
mat_Sqrt:  [[ 2.05519274e+01  0.00000000e+00]
 [-8.24302200e-03  1.88871361e-02]]
grads:  [-0.00943461 -3.28012927]
Stock Position:  -0.00943460510011996
Bond Position:  [10.10786406]


portfolio before change:  [9.14465714]
curr_Stock_Price:  102.22690525230544
curr_Factors:  [1.02226905e+02 4.20063243e-02]
mat_Sqrt:  [[ 2.09518586e+01  0.00000000e+00]
 [-8.19817778e-03  1.87843851e-02]]
grads:  [ 6.02902790e-04 -2.74760086e+00]
Stock Position:  0.000602902789773612
Bond Position:  [9.08302425]


portfolio before change:  [9.14583335]
curr_Stock_Price:  102.29450573396385
curr_Factors:  [1.02294506e+02 4.00243416e-02]
mat_Sqrt:  [[ 2.04651252e+01  0.00000000e+00]
 [-8.00243379e-03  1.83358793e-02]]
grads:  [-0.01129347  6.20712281]
Stock Position:  -0.01129346712591021
Bond Position:  [10.30109298]


portfolio before change:  [9.15667246]
curr_Stock_Price:  101.44876030001598
curr_Factors:  [1.01448760e+02 4.05620099e-02]
mat_Sqrt:  [[ 2.04317929e+01  0.00000000e+00]
 [-8.05600496e-03  1.84586263e-02]]
grads:  [0.00452909 3.44719222]
Stock Position:  0.0045290915951755086
Bond Position:  [8.69720173]


portfolio before change:  [9.15024738]
curr_Stock_Price:  99.79008274321886
curr_Factors:  [9.97900827e+01 4.05422215e-02]
mat_Sqrt:  [[ 2.00928320e+01  0.00000000e+00]
 [-8.05403963e-03  1.84541231e-02]]
grads:  [-9.57599570e-04  4.64079873e+00]
Stock Position:  -0.0009575995701128933
Bond Position:  [9.24580632]


portfolio before change:  [9.15120003]
curr_Stock_Price:  100.00221740498226
curr_Factors:  [1.00002217e+02 4.15024880e-02]
mat_Sqrt:  [[ 2.03726112e+01  0.00000000e+00]
 [-8.14886378e-03  1.86713925e-02]]
grads:  [-0.00709854  5.28242166]
Stock Position:  -0.007098538568927237
Bond Position:  [9.86106963]


portfolio before change:  [9.14793144]
curr_Stock_Price:  100.63633433104312
curr_Factors:  [1.00636334e+02 4.08992146e-02]
mat_Sqrt:  [[ 2.03522436e+01  0.00000000e+00]
 [-8.08942169e-03  1.85351936e-02]]
grads:  [-5.76897821e-03 -1.16564926e+01]
Stock Position:  -0.005768978213753332
Bond Position:  [9.72850026]


portfolio before change:  [9.1552228]
curr_Stock_Price:  99.58325018939875
curr_Factors:  [9.95832502e+01 4.14164641e-02]
mat_Sqrt:  [[ 2.02662225e+01  0.00000000e+00]
 [-8.14041415e-03  1.86520320e-02]]
grads:  [-0.00266739 -2.08205677]
Stock Position:  -0.0026673850974574882
Bond Position:  [9.42084968]


portfolio before change:  [9.15491516]
curr_Stock_Price:  100.14009550133454
curr_Factors:  [1.00140096e+02 4.13462870e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.15491516]
Stock Price:  101.38252325985701
PL:  [7.7723919]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.03833230e+00  2.63647345e-01]
 [ 2.88478245e-01  1.07513190e-01]
 [-1.76475037e-01 -1.02746071e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.07630896e-01  7.84619611e-01]
 [ 8.71603183e-03 -6.36273352e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 9.77939917e-01  9.86505350e-01]
 [ 7.66667933e-03  3.52785980e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-2.39513422e-02  2.03890846e-02]
 [ 6.98078654e-02 -1.03941915e-01]
 [-9.45764101e-02  6.85504184e-02]
 [-1.37781284e-01  4.41690955e-01]
 [ 1.50347921e-01  1.62562172e-01]
 [ 1.32442970e-01 -8.36760024e-02]
 [ 4.08073583e-02  1.12262519e-01]
 [ 1.87201151e-01  7.56230497e-02]
 [ 1.27520123e-01  1.35367573e-01]
 [-5.31002268e-01  2.33060998e-01]
 [ 8.99138444e-02  9.69560000e-02]
 [ 1.48808756e+00  1.69926111e-01]
 [ 1.56524516e-02  4.56408980e-01]
 [-1.51328163e-01  1.83539624e-01]
 [-1.93097559e-01  1.17959378e-01]
 [ 2.13706638e-01 -7.35272967e-02]
 [ 3.77290065e-02 -4.56281388e-01]
 [ 8.39161412e-02  2.36063536e-02]
 [ 5.12570195e-01 -3.02164577e-01]
 [-5.12476929e-01 -2.71316597e-01]
 [ 1.75403636e-01  6.78633856e-02]
 [-1.07955644e-01  1.38634748e-01]
 [ 5.35489021e-01  2.33472546e-01]
 [ 5.57486748e-02 -8.60427634e-02]
 [ 3.04580428e-01 -3.72358710e-01]
 [ 1.42589894e-01  9.72527751e-03]
 [-8.38250528e-02  6.19707335e-01]
 [-3.99907475e-01 -1.46540876e-01]
 [-2.25480299e-01  6.57653085e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.52143605]
curr_Stock_Price:  101.28315448417537
curr_Factors:  [1.01283154e+02 3.93090566e-02]
mat_Sqrt:  [[ 2.00809165e+01  0.00000000e+00]
 [-7.93060468e-03  1.81712981e-02]]
grads:  [ 0.05743749 14.50899895]
Stock Position:  0.057437489932928645
Bond Position:  [5.70398589]


portfolio before change:  [11.47091246]
curr_Stock_Price:  100.39111282273964
curr_Factors:  [1.00391113e+02 3.98318951e-02]
mat_Sqrt:  [[ 2.00359876e+01  0.00000000e+00]
 [-7.98317181e-03  1.82917446e-02]]
grads:  [0.01673992 5.87768925]
Stock Position:  0.016739920948258765
Bond Position:  [9.79037317]


portfolio before change:  [11.49243138]
curr_Stock_Price:  101.60348671013003
curr_Factors:  [1.01603487e+02 3.99693224e-02]
mat_Sqrt:  [[ 2.03129035e+01  0.00000000e+00]
 [-7.99693165e-03  1.83232723e-02]]
grads:  [-0.01089539 -5.60740837]
Stock Position:  -0.01089539460640402
Bond Position:  [12.59944146]


portfolio before change:  [11.52579731]
curr_Stock_Price:  98.68565738934561
curr_Factors:  [9.86856574e+01 4.08946956e-02]
mat_Sqrt:  [[ 1.99566448e+01  0.00000000e+00]
 [-8.08897478e-03  1.85341696e-02]]
grads:  [-8.16839057e-04 -8.16798463e+00]
Stock Position:  -0.0008168390574266946
Bond Position:  [11.60640761]


portfolio before change:  [11.52811279]
curr_Stock_Price:  97.62720026323872
curr_Factors:  [9.76272003e+01 4.27670860e-02]
mat_Sqrt:  [[ 2.01895047e+01  0.00000000e+00]
 [-8.27208182e-03  1.89537205e-02]]
grads:  [1.16300613e-02 4.13966012e+01]
Stock Position:  0.011630061264857315
Bond Position:  [10.39270247]


portfolio before change:  [11.52655612]
curr_Stock_Price:  97.38164396448981
curr_Factors:  [9.73816440e+01 4.42418077e-02]
mat_Sqrt:  [[ 2.04829985e+01  0.00000000e+00]
 [-8.41349466e-03  1.92777381e-02]]
grads:  [-9.30196516e-04 -3.30056021e+00]
Stock Position:  -0.0009301965160507314
Bond Position:  [11.61714019]


portfolio before change:  [11.52877464]
curr_Stock_Price:  96.55786249765701
curr_Factors:  [9.65578625e+01 4.36461296e-02]
mat_Sqrt:  [[ 2.01725366e+01  0.00000000e+00]
 [-8.35666246e-03  1.91475191e-02]]
grads:  [0.00641336 5.02085343]
Stock Position:  0.006413361875978272
Bond Position:  [10.90951412]


portfolio before change:  [11.53239073]
curr_Stock_Price:  96.90905413156007
curr_Factors:  [9.69090541e+01 4.27977311e-02]
mat_Sqrt:  [[ 2.00481696e+01  0.00000000e+00]
 [-8.27504500e-03  1.89605100e-02]]
grads:  [ 0.0702551  52.02947327]
Stock Position:  0.07025509950643748
Bond Position:  [4.72403549]


portfolio before change:  [11.58838774]
curr_Stock_Price:  97.69770113598247
curr_Factors:  [9.76977011e+01 4.28476624e-02]
mat_Sqrt:  [[ 2.02231085e+01  0.00000000e+00]
 [-8.27987076e-03  1.89715673e-02]]
grads:  [7.99259441e-03 1.85955106e+01]
Stock Position:  0.007992594413179043
Bond Position:  [10.80752964]


portfolio before change:  [11.59213499]
curr_Stock_Price:  97.99750646757491
curr_Factors:  [9.79975065e+01 4.09590368e-02]
mat_Sqrt:  [[ 1.98330676e+01  0.00000000e+00]
 [-8.09533563e-03  1.85487441e-02]]
grads:  [0.01242542 6.09618271]
Stock Position:  0.012425419574905667
Bond Position:  [10.37447486]


portfolio before change:  [11.56962759]
curr_Stock_Price:  96.08173269056277
curr_Factors:  [9.60817327e+01 4.15950650e-02]
mat_Sqrt:  [[ 1.95957428e+01  0.00000000e+00]
 [-8.15794729e-03  1.86922055e-02]]
grads:  [-7.68167676e-04  1.09078004e+00]
Stock Position:  -0.0007681676761662479
Bond Position:  [11.64343447]


portfolio before change:  [11.57088123]
curr_Stock_Price:  96.34453916816389
curr_Factors:  [9.63445392e+01 4.09198027e-02]
mat_Sqrt:  [[ 1.94891936e+01  0.00000000e+00]
 [-8.09145749e-03  1.85398582e-02]]
grads:  [ 1.25422812e-03 -5.60640289e+00]
Stock Position:  0.001254228123564312
Bond Position:  [11.4500432]


portfolio before change:  [11.57101744]
curr_Stock_Price:  95.3119200039432
curr_Factors:  [9.53119200e+01 4.08643575e-02]
mat_Sqrt:  [[ 1.92672422e+01  0.00000000e+00]
 [-8.08597378e-03  1.85272935e-02]]
grads:  [-3.35588011e-03  3.69996937e+00]
Stock Position:  -0.0033558801097200025
Bond Position:  [11.89087281]


portfolio before change:  [11.57594613]
curr_Stock_Price:  94.28618463304046
curr_Factors:  [9.42861846e+01 4.31664210e-02]
mat_Sqrt:  [[ 1.95893977e+01  0.00000000e+00]
 [-8.31061211e-03  1.90420045e-02]]
grads:  [2.80705171e-03 2.31956124e+01]
Stock Position:  0.002807051714551733
Bond Position:  [11.31127994]


portfolio before change:  [11.576441]
curr_Stock_Price:  93.95874976055313
curr_Factors:  [9.39587498e+01 4.51749344e-02]
mat_Sqrt:  [[ 1.99703646e+01  0.00000000e+00]
 [-8.50175835e-03  1.94799756e-02]]
grads:  [0.01108121 8.34509115]
Stock Position:  0.01108121324347204
Bond Position:  [10.53526406]


portfolio before change:  [11.58907078]
curr_Stock_Price:  94.97964763163762
curr_Factors:  [9.49796476e+01 4.58954848e-02]
mat_Sqrt:  [[ 2.03477098e+01  0.00000000e+00]
 [-8.56929261e-03  1.96347160e-02]]
grads:  [ 0.00471423 -4.26163548]
Stock Position:  0.0047142292540076625
Bond Position:  [11.14131495]


portfolio before change:  [11.59584009]
curr_Stock_Price:  96.12014206814631
curr_Factors:  [9.61201421e+01 4.59115686e-02]
mat_Sqrt:  [[ 2.05956484e+01  0.00000000e+00]
 [-8.57079400e-03  1.96381561e-02]]
grads:  [4.36027731e-03 5.71655091e+00]
Stock Position:  0.004360277314260769
Bond Position:  [11.17672961]


portfolio before change:  [11.59574432]
curr_Stock_Price:  95.7777465210231
curr_Factors:  [9.57777465e+01 4.67405183e-02]
mat_Sqrt:  [[ 2.07067231e+01  0.00000000e+00]
 [-8.64782223e-03  1.98146500e-02]]
grads:  [0.01063451 3.8165221 ]
Stock Position:  0.010634505246387432
Bond Position:  [10.57719538]


portfolio before change:  [11.59115555]
curr_Stock_Price:  95.22191396334969
curr_Factors:  [9.52219140e+01 4.54124819e-02]
mat_Sqrt:  [[ 2.02919847e+01  0.00000000e+00]
 [-8.52408183e-03  1.95311251e-02]]
grads:  [0.00919572 6.93086403]
Stock Position:  0.00919571833879016
Bond Position:  [10.71552165]


portfolio before change:  [11.59031468]
curr_Stock_Price:  94.98480352834783
curr_Factors:  [9.49848035e+01 4.39042552e-02]
mat_Sqrt:  [[ 1.99024910e+01  0.00000000e+00]
 [-8.38133691e-03  1.92040554e-02]]
grads:  [-0.02156947 12.13603026]
Stock Position:  -0.021569466357742574
Bond Position:  [13.6390862]


portfolio before change:  [11.59452219]
curr_Stock_Price:  94.86878202276692
curr_Factors:  [9.48687820e+01 4.41999386e-02]
mat_Sqrt:  [[ 1.99450054e+01  0.00000000e+00]
 [-8.40951258e-03  1.92686140e-02]]
grads:  [0.00662968 5.03180977]
Stock Position:  0.006629675413311341
Bond Position:  [10.96557296]


portfolio before change:  [11.59877396]
curr_Stock_Price:  95.3033407449674
curr_Factors:  [9.53033407e+01 4.49341895e-02]
mat_Sqrt:  [[ 2.02021030e+01  0.00000000e+00]
 [-8.47907443e-03  1.94280002e-02]]
grads:  [0.07733103 8.74645406]
Stock Position:  0.07733102798011768
Bond Position:  [4.22886865]


portfolio before change:  [11.54111027]
curr_Stock_Price:  94.55083136042337
curr_Factors:  [9.45508314e+01 4.42198253e-02]
mat_Sqrt:  [[ 1.98826315e+01  0.00000000e+00]
 [-8.41140419e-03  1.92729482e-02]]
grads:  [1.08056955e-02 2.36813266e+01]
Stock Position:  0.010805695477870707
Bond Position:  [10.51942278]


portfolio before change:  [11.53244004]
curr_Stock_Price:  93.62675945620968
curr_Factors:  [9.36267595e+01 4.41395810e-02]
mat_Sqrt:  [[ 1.96704409e+01  0.00000000e+00]
 [-8.40376877e-03  1.92554533e-02]]
grads:  [-3.62091039e-03  9.53182569e+00]
Stock Position:  -0.0036209103925854995
Bond Position:  [11.87145415]


portfolio before change:  [11.53087658]
curr_Stock_Price:  94.46839494091276
curr_Factors:  [9.44683949e+01 4.45665232e-02]
mat_Sqrt:  [[ 1.99430195e+01  0.00000000e+00]
 [-8.44431389e-03  1.93483538e-02]]
grads:  [-0.00710102  6.09661054]
Stock Position:  -0.007101024291523046
Bond Position:  [12.20169895]


portfolio before change:  [11.53061857]
curr_Stock_Price:  94.7195303417567
curr_Factors:  [9.47195303e+01 4.47736528e-02]
mat_Sqrt:  [[ 2.00424496e+01  0.00000000e+00]
 [-8.46391425e-03  1.93932639e-02]]
grads:  [ 0.0090616 -3.7913833]
Stock Position:  0.00906160170291714
Bond Position:  [10.67230791]


portfolio before change:  [11.53008866]
curr_Stock_Price:  94.51382384631026
curr_Factors:  [9.45138238e+01 4.48015923e-02]
mat_Sqrt:  [[ 2.00051614e+01  0.00000000e+00]
 [-8.46655465e-03  1.93993138e-02]]
grads:  [-8.06834366e-03 -2.35204911e+01]
Stock Position:  -0.008068343663372607
Bond Position:  [12.29265867]


portfolio before change:  [11.53075845]
curr_Stock_Price:  94.62126668317842
curr_Factors:  [9.46212667e+01 4.63749781e-02]
mat_Sqrt:  [[ 2.03765482e+01  0.00000000e+00]
 [-8.61394016e-03  1.97370164e-02]]
grads:  [0.00462388 1.19604469]
Stock Position:  0.00462388416127425
Bond Position:  [11.09324068]


portfolio before change:  [11.53076829]
curr_Stock_Price:  94.32348528637307
curr_Factors:  [9.43234853e+01 4.50115264e-02]
mat_Sqrt:  [[ 2.00115952e+01  0.00000000e+00]
 [-8.48636803e-03  1.94447119e-02]]
grads:  [  0.01902371 -15.53967874]
Stock Position:  0.01902370886501517
Bond Position:  [9.73638577]


portfolio before change:  [11.53673584]
curr_Stock_Price:  94.57319616078748
curr_Factors:  [9.45731962e+01 4.58552950e-02]
mat_Sqrt:  [[ 2.02517619e+01  0.00000000e+00]
 [-8.56553979e-03  1.96261172e-02]]
grads:  [ -0.03115231 -13.82426254]
Stock Position:  -0.031152311793138033
Bond Position:  [14.48290953]


portfolio before change:  [11.54750138]
curr_Stock_Price:  94.28573555171413
curr_Factors:  [9.42857356e+01 4.58884233e-02]
mat_Sqrt:  [[ 2.01974974e+01  0.00000000e+00]
 [-8.56863334e-03  1.96332054e-02]]
grads:  [0.01015084 3.45656168]
Stock Position:  0.010150844024921767
Bond Position:  [10.59042158]


portfolio before change:  [11.55097349]
curr_Stock_Price:  94.49736590687182
curr_Factors:  [9.44973659e+01 4.61663601e-02]
mat_Sqrt:  [[ 2.03040428e+01  0.00000000e+00]
 [-8.59454340e-03  1.96925728e-02]]
grads:  [-2.33699664e-03  7.03995100e+00]
Stock Position:  -0.0023369966367871053
Bond Position:  [11.77181352]


portfolio before change:  [11.55617829]
curr_Stock_Price:  92.89991643689093
curr_Factors:  [9.28999164e+01 4.83478077e-02]
mat_Sqrt:  [[ 2.04269590e+01  0.00000000e+00]
 [-8.79525396e-03  2.01524585e-02]]
grads:  [ 0.03120312 11.58531331]
Stock Position:  0.0312031171896588
Bond Position:  [8.65741132]


portfolio before change:  [11.53592265]
curr_Stock_Price:  92.21607798013473
curr_Factors:  [9.2216078e+01 4.9359114e-02]
mat_Sqrt:  [[ 2.04875641e+01  0.00000000e+00]
 [-8.88676445e-03  2.03621354e-02]]
grads:  [ 8.88174606e-04 -4.22562573e+00]
Stock Position:  0.0008881746063178354
Bond Position:  [11.45401867]


portfolio before change:  [11.53649114]
curr_Stock_Price:  91.24403429968815
curr_Factors:  [9.12440343e+01 5.00934529e-02]
mat_Sqrt:  [[ 2.04218444e+01  0.00000000e+00]
 [-8.95262669e-03  2.05130447e-02]]
grads:  [ 6.95675476e-03 -1.81522887e+01]
Stock Position:  0.006956754763181431
Bond Position:  [10.90172877]


portfolio before change:  [11.52895554]
curr_Stock_Price:  89.9649316526244
curr_Factors:  [8.99649317e+01 5.17015936e-02]
mat_Sqrt:  [[ 2.04562122e+01  0.00000000e+00]
 [-9.09519377e-03  2.08397070e-02]]
grads:  [0.00717798 0.46667055]
Stock Position:  0.0071779834778618054
Bond Position:  [10.88318875]


portfolio before change:  [11.52788035]
curr_Stock_Price:  89.62560607027089
curr_Factors:  [8.96256061e+01 4.99068820e-02]
mat_Sqrt:  [[ 2.00222244e+01  0.00000000e+00]
 [-8.93593930e-03  2.04748091e-02]]
grads:  [9.32151185e-03 3.02668187e+01]
Stock Position:  0.009321511846782876
Bond Position:  [10.6924342]


portfolio before change:  [11.52863303]
curr_Stock_Price:  89.56295982475974
curr_Factors:  [8.95629598e+01 4.94249829e-02]
mat_Sqrt:  [[ 1.99113956e+01  0.00000000e+00]
 [-8.89269210e-03  2.03757173e-02]]
grads:  [-0.02329637 -7.19193702]
Stock Position:  -0.02329636582626571
Bond Position:  [13.61512451]


portfolio before change:  [11.53088973]
curr_Stock_Price:  89.53914918318603
curr_Factors:  [8.95391492e+01 4.84539757e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.53088973]
Stock Price:  90.96659378208949
PL:  [11.53088973]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.45698244e+00  3.62823034e-01]
 [ 1.22954672e+00  5.60479111e-02]
 [ 2.89214186e-02  4.54792555e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.12479885e-01  9.03737066e-01]
 [ 2.58426850e-02 -2.95495927e-02]
 [ 9.09869523e-02  9.06845609e-02]
 [ 1.65748153e+00  1.73810046e+00]
 [ 2.72515934e-01  1.06051982e+00]
 [-3.19803571e-01 -8.04507416e-01]
 [ 2.81189908e-01  5.99994256e-03]
 [ 3.42240687e-02 -7.34019930e-03]
 [ 5.96697195e-02  6.52823045e-01]
 [-1.82485964e-01  6.33582027e-01]
 [-2.27396272e-01 -4.44075373e-03]
 [ 1.26896174e-01 -2.16260159e-01]
 [ 3.16623598e-02 -3.13209522e-01]
 [ 6.05758730e-01  5.40113540e-02]
 [ 7.29878014e-01  7.48246593e-01]
 [-1.16012358e+00  5.99165858e-01]
 [-4.61190423e-01  5.42276040e-01]
 [ 2.04743543e+00  3.98121861e-01]
 [ 1.27202855e-02  3.40382780e-01]
 [-1.68002864e-01  2.49142089e-01]
 [-1.46276953e-01  4.68942039e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 5.71200313e-01 -4.11314620e-01]
 [ 1.47934523e-01 -1.12671943e-01]
 [ 8.60499078e-01 -3.29497557e-01]
 [-8.45245118e-01 -3.71868152e-01]
 [ 8.33803156e-01  3.10689684e-01]
 [-2.97898455e-01  4.63863498e-01]
 [ 8.98099100e-01  1.47356698e-01]
 [ 7.11791037e-02 -1.78246512e-01]
 [ 3.24061897e-01 -5.13249763e-01]
 [ 1.66338967e-01 -2.02372662e-02]
 [-9.34464565e-02  7.74643706e-01]
 [-4.07275636e-01 -1.48288540e-01]
 [-2.23761243e-01  6.56818132e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.08611511]
curr_Stock_Price:  98.58217604389763
curr_Factors:  [9.85821760e+01 4.27459188e-02]
mat_Sqrt:  [[ 2.03819498e+01  0.00000000e+00]
 [-8.27003447e-03  1.89490295e-02]]
grads:  [ 0.07925304 19.14731489]
Stock Position:  0.07925303527027316
Bond Position:  [-14.89905178]


portfolio before change:  [-7.14226135]
curr_Stock_Price:  97.89723390756096
curr_Factors:  [9.78972339e+01 4.13929551e-02]
mat_Sqrt:  [[ 1.99174455e+01  0.00000000e+00]
 [-8.13810347e-03  1.86467376e-02]]
grads:  [0.06296028 3.00577572]
Stock Position:  0.06296028459466645
Bond Position:  [-13.30589905]


portfolio before change:  [-7.13726935]
curr_Stock_Price:  98.00294086362312
curr_Factors:  [9.80029409e+01 4.16144602e-02]
mat_Sqrt:  [[ 1.99922301e+01  0.00000000e+00]
 [-8.15984904e-03  1.86965629e-02]]
grads:  [0.00243946 2.43249284]
Stock Position:  0.002439457372445572
Bond Position:  [-7.37634334]


portfolio before change:  [-7.13810007]
curr_Stock_Price:  98.04040082029839
curr_Factors:  [9.80404008e+01 4.18673428e-02]
mat_Sqrt:  [[ 2.00605473e+01  0.00000000e+00]
 [-8.18460436e-03  1.87532845e-02]]
grads:  [-8.12608286e-04 -8.07254923e+00]
Stock Position:  -0.0008126082859823432
Bond Position:  [-7.05843162]


portfolio before change:  [-7.13842329]
curr_Stock_Price:  97.3523302508757
curr_Factors:  [9.73523303e+01 4.21123197e-02]
mat_Sqrt:  [[ 1.99779505e+01  0.00000000e+00]
 [-8.20851457e-03  1.88080697e-02]]
grads:  [1.41127243e-02 4.80504954e+01]
Stock Position:  0.014112724255567529
Bond Position:  [-8.51232989]


portfolio before change:  [-7.14778848]
curr_Stock_Price:  96.76413197834137
curr_Factors:  [9.67641320e+01 4.02040501e-02]
mat_Sqrt:  [[ 1.94021254e+01  0.00000000e+00]
 [-8.02037905e-03  1.83769971e-02]]
grads:  [ 6.67256043e-04 -1.60796634e+00]
Stock Position:  0.0006672560433916865
Bond Position:  [-7.21235493]


portfolio before change:  [-7.15068994]
curr_Stock_Price:  93.76698967570441
curr_Factors:  [9.37669897e+01 4.12154713e-02]
mat_Sqrt:  [[ 1.90361934e+01  0.00000000e+00]
 [-8.12063754e-03  1.86067181e-02]]
grads:  [0.00685877 4.87375368]
Stock Position:  0.006858773527166311
Bond Position:  [-7.79381649]


portfolio before change:  [-7.1632679]
curr_Stock_Price:  92.07519038579748
curr_Factors:  [9.20751904e+01 4.19204644e-02]
mat_Sqrt:  [[ 1.88519235e+01  0.00000000e+00]
 [-8.18979506e-03  1.87651779e-02]]
grads:  [ 0.12815938 92.62371339]
Stock Position:  0.1281593767269564
Bond Position:  [-18.96356691]


portfolio before change:  [-7.42496937]
curr_Stock_Price:  90.05168742280091
curr_Factors:  [9.00516874e+01 4.24448066e-02]
mat_Sqrt:  [[ 1.85525724e+01  0.00000000e+00]
 [-8.24085497e-03  1.88821708e-02]]
grads:  [3.96368070e-02 5.61651429e+01]
Stock Position:  0.03963680699264575
Bond Position:  [-10.99433073]


portfolio before change:  [-7.43217477]
curr_Stock_Price:  89.90457614427886
curr_Factors:  [8.99045761e+01 4.20955299e-02]
mat_Sqrt:  [[ 1.84458974e+01  0.00000000e+00]
 [-8.20687809e-03  1.88043200e-02]]
grads:  [-3.63722826e-02 -4.27831166e+01]
Stock Position:  -0.03637228260542338
Bond Position:  [-4.16214012]


portfolio before change:  [-7.40894775]
curr_Stock_Price:  89.25168018702641
curr_Factors:  [8.92516802e+01 4.26742020e-02]
mat_Sqrt:  [[ 1.84373757e+01  0.00000000e+00]
 [-8.26309405e-03  1.89331270e-02]]
grads:  [0.01539311 0.31690183]
Stock Position:  0.015393107039794244
Bond Position:  [-8.78280842]


portfolio before change:  [-7.41427903]
curr_Stock_Price:  88.97666377458108
curr_Factors:  [8.89766638e+01 4.26964080e-02]
mat_Sqrt:  [[ 1.83853452e+01  0.00000000e+00]
 [-8.26524366e-03  1.89380524e-02]]
grads:  [ 0.00168724 -0.38758998]
Stock Position:  0.001687242900214265
Bond Position:  [-7.56440428]


portfolio before change:  [-7.41243425]
curr_Stock_Price:  90.63047944690152
curr_Factors:  [9.06304794e+01 4.09189436e-02]
mat_Sqrt:  [[ 1.83331244e+01  0.00000000e+00]
 [-8.09137256e-03  1.85396636e-02]]
grads:  [1.87957627e-02 3.52122379e+01]
Stock Position:  0.01879576268548087
Bond Position:  [-9.11590324]


portfolio before change:  [-7.4153697]
curr_Stock_Price:  90.53493178080673
curr_Factors:  [9.05349318e+01 4.20980959e-02]
mat_Sqrt:  [[ 1.85757948e+01  0.00000000e+00]
 [-8.20712821e-03  1.88048931e-02]]
grads:  [5.06206618e-03 3.36924024e+01]
Stock Position:  0.005062066182461315
Bond Position:  [-7.87366352]


portfolio before change:  [-7.41910852]
curr_Stock_Price:  89.99077701584284
curr_Factors:  [8.9990777e+01 4.2222099e-02]
mat_Sqrt:  [[ 1.84913199e+01  0.00000000e+00]
 [-8.21920668e-03  1.88325684e-02]]
grads:  [-0.01240227 -0.23580181]
Stock Position:  -0.01240227183299919
Bond Position:  [-6.30301844]


portfolio before change:  [-7.40223182]
curr_Stock_Price:  88.5664710304573
curr_Factors:  [8.85664710e+01 4.34692776e-02]
mat_Sqrt:  [[ 1.84654779e+01  0.00000000e+00]
 [-8.33971488e-03  1.91086873e-02]]
grads:  [ 1.76071819e-03 -1.13173739e+01]
Stock Position:  0.0017607181871127475
Bond Position:  [-7.55817241]


portfolio before change:  [-7.40426976]
curr_Stock_Price:  87.94563786349921
curr_Factors:  [8.79456379e+01 4.37165048e-02]
mat_Sqrt:  [[ 1.83881069e+01  0.00000000e+00]
 [-8.36339690e-03  1.91629497e-02]]
grads:  [-5.71203349e-03 -1.63445360e+01]
Stock Position:  -0.005712033490073758
Bond Position:  [-6.90192133]


portfolio before change:  [-7.4038341]
curr_Stock_Price:  87.71831962122239
curr_Factors:  [8.77183196e+01 4.47037590e-02]
mat_Sqrt:  [[ 1.85465154e+01  0.00000000e+00]
 [-8.45730538e-03  1.93781210e-02]]
grads:  [0.03393259 2.7872338 ]
Stock Position:  0.03393258533371024
Bond Position:  [-10.38034347]


portfolio before change:  [-7.40389094]
curr_Stock_Price:  87.75488594769539
curr_Factors:  [8.77548859e+01 4.39905154e-02]
mat_Sqrt:  [[ 1.84056361e+01  0.00000000e+00]
 [-8.38956641e-03  1.92229116e-02]]
grads:  [ 0.05739761 38.92472743]
Stock Position:  0.05739761424585305
Bond Position:  [-12.44081203]


portfolio before change:  [-7.36156554]
curr_Stock_Price:  88.51938806025078
curr_Factors:  [8.85193881e+01 4.31129079e-02]
mat_Sqrt:  [[ 1.83798542e+01  0.00000000e+00]
 [-8.30545920e-03  1.90301977e-02]]
grads:  [-0.04889191 31.48500432]
Stock Position:  -0.04889190923397226
Bond Position:  [-3.03368365]


portfolio before change:  [-7.3554902]
curr_Stock_Price:  88.38737080324927
curr_Factors:  [8.83873708e+01 4.38775612e-02]
mat_Sqrt:  [[ 1.85144773e+01  0.00000000e+00]
 [-8.37878857e-03  1.91982164e-02]]
grads:  [-1.21268212e-02  2.82461676e+01]
Stock Position:  -0.012126821220183784
Bond Position:  [-6.28363235]


portfolio before change:  [-7.36788237]
curr_Stock_Price:  89.34447808521531
curr_Factors:  [8.93444781e+01 4.42524792e-02]
mat_Sqrt:  [[ 1.87947485e+01  0.00000000e+00]
 [-8.41450929e-03  1.92800629e-02]]
grads:  [ 0.11818142 20.64940678]
Stock Position:  0.1181814190427438
Bond Position:  [-17.92673957]


portfolio before change:  [-7.28689418]
curr_Stock_Price:  90.0487273316258
curr_Factors:  [9.00487273e+01 4.38962737e-02]
mat_Sqrt:  [[ 1.88665029e+01  0.00000000e+00]
 [-8.38057503e-03  1.92023097e-02]]
grads:  [8.54824611e-03 1.77261374e+01]
Stock Position:  0.00854824610779898
Bond Position:  [-8.05665286]


portfolio before change:  [-7.28077359]
curr_Stock_Price:  90.88255166087427
curr_Factors:  [9.08825517e+01 4.22743397e-02]
mat_Sqrt:  [[ 1.86861112e+01  0.00000000e+00]
 [-8.22428984e-03  1.88442154e-02]]
grads:  [-3.17178579e-03  1.32211442e+01]
Stock Position:  -0.0031717857856252687
Bond Position:  [-6.9925136]


portfolio before change:  [-7.28163263]
curr_Stock_Price:  90.8778004478798
curr_Factors:  [9.08778004e+01 4.26318113e-02]
mat_Sqrt:  [[ 1.87639687e+01  0.00000000e+00]
 [-8.25898892e-03  1.89237210e-02]]
grads:  [-0.00670491  2.47806465]
Stock Position:  -0.00670490592195074
Bond Position:  [-6.67230553]


portfolio before change:  [-7.28694662]
curr_Stock_Price:  91.5459521667
curr_Factors:  [9.15459522e+01 4.31954457e-02]
mat_Sqrt:  [[ 1.90264658e+01  0.00000000e+00]
 [-8.31340563e-03  1.90484053e-02]]
grads:  [ 0.00964334 -3.83210752]
Stock Position:  0.009643335982363686
Bond Position:  [-8.16975499]


portfolio before change:  [-7.30425192]
curr_Stock_Price:  89.85732333157439
curr_Factors:  [8.98573233e+01 4.29346939e-02]
mat_Sqrt:  [[ 1.86190562e+01  0.00000000e+00]
 [-8.28827547e-03  1.89908249e-02]]
grads:  [ 2.10369361e-02 -2.16585969e+01]
Stock Position:  0.021036936082954236
Bond Position:  [-9.19457469]


portfolio before change:  [-7.30912768]
curr_Stock_Price:  89.68018864209401
curr_Factors:  [8.96801886e+01 4.22835943e-02]
mat_Sqrt:  [[ 1.84409148e+01  0.00000000e+00]
 [-8.22519002e-03  1.88462779e-02]]
grads:  [ 5.35550738e-03 -5.97847188e+00]
Stock Position:  0.005355507378477022
Bond Position:  [-7.78941059]


portfolio before change:  [-7.31065299]
curr_Stock_Price:  89.57719828926083
curr_Factors:  [8.95771983e+01 4.22289184e-02]
mat_Sqrt:  [[ 1.84078240e+01  0.00000000e+00]
 [-8.21987040e-03  1.88340892e-02]]
grads:  [  0.03893424 -17.49474339]
Stock Position:  0.03893423546040267
Bond Position:  [-10.79827272]


portfolio before change:  [-7.32310792]
curr_Stock_Price:  89.29197201304274
curr_Factors:  [8.92919720e+01 4.22228263e-02]
mat_Sqrt:  [[ 1.83478873e+01  0.00000000e+00]
 [-8.21927747e-03  1.88327306e-02]]
grads:  [ -0.05491323 -19.74584359]
Stock Position:  -0.05491322606248385
Bond Position:  [-2.41979768]


portfolio before change:  [-7.25808316]
curr_Stock_Price:  88.10232676496184
curr_Factors:  [8.81023268e+01 4.37044014e-02]
mat_Sqrt:  [[ 1.84183180e+01  0.00000000e+00]
 [-8.36223907e-03  1.91602968e-02]]
grads:  [ 0.05263234 16.21528557]
Stock Position:  0.05263234415282111
Bond Position:  [-11.89511514]


portfolio before change:  [-7.24384685]
curr_Stock_Price:  88.40106490881917
curr_Factors:  [8.84010649e+01 4.21726648e-02]
mat_Sqrt:  [[ 1.81540287e+01  0.00000000e+00]
 [-8.21439369e-03  1.88215404e-02]]
grads:  [-5.25788673e-03  2.46453525e+01]
Stock Position:  -0.00525788672518164
Bond Position:  [-6.77904406]


portfolio before change:  [-7.24819399]
curr_Stock_Price:  89.06667497252094
curr_Factors:  [8.90666750e+01 4.20553849e-02]
mat_Sqrt:  [[ 1.82652679e+01  0.00000000e+00]
 [-8.20296384e-03  1.87953514e-02]]
grads:  [0.05269076 7.84006085]
Stock Position:  0.052690759478237266
Bond Position:  [-11.94118473]


portfolio before change:  [-7.25971753]
curr_Stock_Price:  88.87630385066542
curr_Factors:  [8.88763039e+01 4.14441718e-02]
mat_Sqrt:  [[ 1.80932972e+01  0.00000000e+00]
 [-8.14313667e-03  1.86582701e-02]]
grads:  [-3.65552605e-04 -9.55321748e+00]
Stock Position:  -0.00036555260527019047
Bond Position:  [-7.22722856]


portfolio before change:  [-7.26067471]
curr_Stock_Price:  89.02328110211896
curr_Factors:  [8.90232811e+01 4.11789975e-02]
mat_Sqrt:  [[ 1.80651462e+01  0.00000000e+00]
 [-8.11704355e-03  1.85984832e-02]]
grads:  [ 5.53891648e-03 -2.75963237e+01]
Stock Position:  0.0055389164769121795
Bond Position:  [-7.75376723]


portfolio before change:  [-7.26605073]
curr_Stock_Price:  88.22768592174008
curr_Factors:  [8.82276859e+01 4.25482651e-02]
mat_Sqrt:  [[ 1.81989284e+01  0.00000000e+00]
 [-8.25089233e-03  1.89051693e-02]]
grads:  [ 0.00865472 -1.07046205]
Stock Position:  0.008654723853887773
Bond Position:  [-8.02963699]


portfolio before change:  [-7.27010818]
curr_Stock_Price:  87.87485231049887
curr_Factors:  [8.78748523e+01 4.19065640e-02]
mat_Sqrt:  [[ 1.79889426e+01  0.00000000e+00]
 [-8.18843712e-03  1.87620665e-02]]
grads:  [1.35992304e-02 4.12877605e+01]
Stock Position:  0.013599230363702298
Bond Position:  [-8.46513854]


portfolio before change:  [-7.25983332]
curr_Stock_Price:  88.70821283930653
curr_Factors:  [8.87082128e+01 4.25734707e-02]
mat_Sqrt:  [[ 1.83034669e+01  0.00000000e+00]
 [-8.25333587e-03  1.89107682e-02]]
grads:  [-0.02578714 -7.84148684]
Stock Position:  -0.025787139881655534
Bond Position:  [-4.97230223]


portfolio before change:  [-7.28204501]
curr_Stock_Price:  89.54545627906678
curr_Factors:  [8.95454563e+01 4.34364833e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.28204501]
Stock Price:  88.89872488982401
PL:  [-7.28204501]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.18842242e+00  2.97579713e-01]
 [ 4.82225967e-01  1.27081458e-01]
 [ 7.99260297e-02  5.35223403e-03]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.44998261e-01  1.08102255e+00]
 [ 6.87023866e-02  6.14752149e-02]
 [ 8.78598357e-02  9.54594817e-02]
 [ 8.75670993e-01  8.74125538e-01]
 [ 5.75965879e-02  4.86317968e-01]
 [ 1.42327445e-01  1.58728805e-02]
 [-2.50815902e-02  1.78550686e-02]
 [ 6.70146080e-02 -1.01344619e-01]
 [-1.17724792e-01 -2.73008530e-02]
 [-1.10090724e-01  1.82936839e-01]
 [ 4.73811233e-01  3.07981710e-01]
 [ 1.31388377e-01  3.37735588e-02]
 [ 4.04572103e-02  1.26336366e-01]
 [ 1.90583532e-01  7.51292732e-02]
 [ 1.58980466e-02  2.78283079e-02]
 [-4.36411362e-01  1.78411061e-01]
 [ 9.72909198e-02  8.49148711e-02]
 [ 1.64126958e+00  1.98107024e-01]
 [ 1.46841100e-02  4.18091576e-01]
 [-1.54274599e-01  1.95131642e-01]
 [-1.77731998e-01  9.45842546e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 5.51585254e-01 -4.12546241e-01]
 [ 1.37157453e-01 -8.97303951e-02]
 [ 8.91282947e-01 -3.31781764e-01]
 [-8.34307051e-01 -3.69248759e-01]
 [ 6.83074556e-01  2.55100542e-01]
 [-2.93635364e-01  4.56605627e-01]
 [ 9.60358876e-01  1.33728967e-01]
 [ 7.88376256e-02 -2.18589245e-01]
 [ 3.80096295e-01 -7.07134717e-01]
 [ 2.07592583e-01 -6.04927242e-02]
 [-1.08790427e-01  1.02064601e+00]
 [-4.34735511e-01 -1.54801786e-01]
 [-5.64297311e-01  1.36367507e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.82790744]
curr_Stock_Price:  100.60186550123804
curr_Factors:  [1.00601866e+02 3.95883013e-02]
mat_Sqrt:  [[ 2.00165612e+01  0.00000000e+00]
 [-7.95872365e-03  1.82357268e-02]]
grads:  [ 0.06586031 16.31850032]
Stock Position:  0.06586030655575603
Bond Position:  [0.20223773]


portfolio before change:  [6.77462845]
curr_Stock_Price:  99.79251204736512
curr_Factors:  [9.97925120e+01 4.05768263e-02]
mat_Sqrt:  [[ 2.01018947e+01  0.00000000e+00]
 [-8.05747617e-03  1.84619972e-02]]
grads:  [0.02674817 6.88340793]
Stock Position:  0.02674816833281641
Bond Position:  [4.10536154]


portfolio before change:  [6.73771469]
curr_Stock_Price:  98.39327751273501
curr_Factors:  [9.83932775e+01 4.08263823e-02]
mat_Sqrt:  [[ 1.98808925e+01  0.00000000e+00]
 [-8.08221576e-03  1.85186828e-02]]
grads:  [0.00413774 0.28901807]
Stock Position:  0.004137738596191487
Bond Position:  [6.33058903]


portfolio before change:  [6.7362008]
curr_Stock_Price:  97.83614697933677
curr_Factors:  [9.78361470e+01 4.07161939e-02]
mat_Sqrt:  [[ 1.97416264e+01  0.00000000e+00]
 [-8.07130165e-03  1.84936754e-02]]
grads:  [-8.25735766e-04 -8.18586946e+00]
Stock Position:  -0.0008257357659238021
Bond Position:  [6.81698761]


portfolio before change:  [6.73820444]
curr_Stock_Price:  96.44168110437327
curr_Factors:  [9.64416811e+01 3.98219942e-02]
mat_Sqrt:  [[ 1.92453704e+01  0.00000000e+00]
 [-7.98217957e-03  1.82894711e-02]]
grads:  [1.69806376e-02 5.91062775e+01]
Stock Position:  0.016980637558013403
Bond Position:  [5.10056321]


portfolio before change:  [6.71603966]
curr_Stock_Price:  95.0988344704789
curr_Factors:  [9.50988345e+01 3.99745257e-02]
mat_Sqrt:  [[ 1.90137095e+01  0.00000000e+00]
 [-7.99745216e-03  1.83244650e-02]]
grads:  [0.00502439 3.35481636]
Stock Position:  0.005024394111009701
Bond Position:  [6.23822564]


portfolio before change:  [6.71765573]
curr_Stock_Price:  95.26527159092959
curr_Factors:  [9.52652716e+01 4.03443213e-02]
mat_Sqrt:  [[ 1.91348833e+01  0.00000000e+00]
 [-8.03435835e-03  1.84090277e-02]]
grads:  [0.00676888 5.18547114]
Stock Position:  0.006768882112799055
Bond Position:  [6.07281634]


portfolio before change:  [6.73443019]
curr_Stock_Price:  97.63129180578552
curr_Factors:  [9.76312918e+01 3.84330586e-02]
mat_Sqrt:  [[ 1.91399813e+01  0.00000000e+00]
 [-7.84174048e-03  1.79676847e-02]]
grads:  [ 0.06568296 48.64987083]
Stock Position:  0.06568296141941093
Bond Position:  [0.32171782]


portfolio before change:  [6.64452773]
curr_Stock_Price:  96.26194614455233
curr_Factors:  [9.62619461e+01 3.84396272e-02]
mat_Sqrt:  [[ 1.88731426e+01  0.00000000e+00]
 [-7.84241056e-03  1.79692200e-02]]
grads:  [1.42977328e-02 2.70639442e+01]
Stock Position:  0.014297732794955928
Bond Position:  [5.26820015]


portfolio before change:  [6.64189116]
curr_Stock_Price:  96.03148030997558
curr_Factors:  [9.60314803e+01 3.83165049e-02]
mat_Sqrt:  [[ 1.87977802e+01  0.00000000e+00]
 [-7.82984086e-03  1.79404192e-02]]
grads:  [0.00794003 0.88475528]
Stock Position:  0.007940029959115594
Bond Position:  [5.87939833]


portfolio before change:  [6.64683014]
curr_Stock_Price:  96.56095062778202
curr_Factors:  [9.65609506e+01 3.71098016e-02]
mat_Sqrt:  [[ 1.86014093e+01  0.00000000e+00]
 [-7.70556180e-03  1.76556601e-02]]
grads:  [-9.29445671e-04  1.01129431e+00]
Stock Position:  -0.0009294456712346942
Bond Position:  [6.7365783]


portfolio before change:  [6.64815883]
curr_Stock_Price:  96.03745656142456
curr_Factors:  [9.60374566e+01 3.75991970e-02]
mat_Sqrt:  [[ 1.86221549e+01  0.00000000e+00]
 [-7.75620495e-03  1.77716981e-02]]
grads:  [ 1.22349913e-03 -5.70258497e+00]
Stock Position:  0.0012234991279075707
Bond Position:  [6.53065708]


portfolio before change:  [6.65044967]
curr_Stock_Price:  97.24257736996975
curr_Factors:  [9.72425774e+01 3.91879842e-02]
mat_Sqrt:  [[ 1.92500970e+01  0.00000000e+00]
 [-7.91838207e-03  1.81432926e-02]]
grads:  [-0.0067345  -1.50473531]
Stock Position:  -0.006734504293858866
Bond Position:  [7.30533023]


portfolio before change:  [6.65185495]
curr_Stock_Price:  97.16951245862096
curr_Factors:  [9.71695125e+01 3.90317623e-02]
mat_Sqrt:  [[ 1.91972537e+01  0.00000000e+00]
 [-7.90258311e-03  1.81070926e-02]]
grads:  [-1.57577446e-03  1.01030487e+01]
Stock Position:  -0.0015757744578286006
Bond Position:  [6.80497219]


portfolio before change:  [6.65220497]
curr_Stock_Price:  97.48723409501797
curr_Factors:  [9.74872341e+01 3.85824654e-02]
mat_Sqrt:  [[ 1.91488517e+01  0.00000000e+00]
 [-7.85696790e-03  1.80025751e-02]]
grads:  [ 0.03176303 17.10764757]
Stock Position:  0.03176302576397753
Bond Position:  [3.55571544]


portfolio before change:  [6.63111683]
curr_Stock_Price:  96.80931908619755
curr_Factors:  [9.68093191e+01 3.77417158e-02]
mat_Sqrt:  [[ 1.88073664e+01  0.00000000e+00]
 [-7.77089089e-03  1.78053479e-02]]
grads:  [0.00776974 1.89682106]
Stock Position:  0.007769741058541509
Bond Position:  [5.87893349]


portfolio before change:  [6.63332691]
curr_Stock_Price:  96.99917968329817
curr_Factors:  [9.69991797e+01 3.75225287e-02]
mat_Sqrt:  [[ 1.87894519e+01  0.00000000e+00]
 [-7.74829309e-03  1.77535698e-02]]
grads:  [5.08769077e-03 7.11611059e+00]
Stock Position:  0.005087690773982776
Bond Position:  [6.13982508]


portfolio before change:  [6.62776116]
curr_Stock_Price:  95.75435732105859
curr_Factors:  [9.57543573e+01 3.83594644e-02]
mat_Sqrt:  [[ 1.87540389e+01  0.00000000e+00]
 [-7.83422893e-03  1.79504736e-02]]
grads:  [0.01191064 4.18536442]
Stock Position:  0.01191064155599237
Bond Position:  [5.48726534]


portfolio before change:  [6.63621098]
curr_Stock_Price:  96.40620001331516
curr_Factors:  [9.6406200e+01 3.8617206e-02]
mat_Sqrt:  [[ 1.89450340e+01  0.00000000e+00]
 [-7.86050441e-03  1.80106782e-02]]
grads:  [1.48024627e-03 1.54510050e+00]
Stock Position:  0.0014802462673880305
Bond Position:  [6.49350606]


portfolio before change:  [6.63635413]
curr_Stock_Price:  95.95452347241172
curr_Factors:  [9.59545235e+01 3.92317865e-02]
mat_Sqrt:  [[ 1.90057274e+01  0.00000000e+00]
 [-7.92280622e-03  1.81534296e-02]]
grads:  [-0.01886518  9.82795345]
Stock Position:  -0.01886517593920623
Bond Position:  [8.44655309]


portfolio before change:  [6.65156748]
curr_Stock_Price:  95.20406846817329
curr_Factors:  [9.52040685e+01 3.90870809e-02]
mat_Sqrt:  [[ 1.88222755e+01  0.00000000e+00]
 [-7.90818117e-03  1.81199194e-02]]
grads:  [0.00713786 4.686272  ]
Stock Position:  0.007137862129311357
Bond Position:  [5.97201396]


portfolio before change:  [6.64517555]
curr_Stock_Price:  94.2039826977726
curr_Factors:  [9.42039827e+01 3.91196191e-02]
mat_Sqrt:  [[ 1.86323045e+01  0.00000000e+00]
 [-7.91147209e-03  1.81274598e-02]]
grads:  [ 0.09272769 10.92855954]
Stock Position:  0.09272769124633762
Bond Position:  [-2.09014227]


portfolio before change:  [6.53928302]
curr_Stock_Price:  93.06482730048144
curr_Factors:  [9.30648273e+01 4.04684306e-02]
mat_Sqrt:  [[ 1.87216343e+01  0.00000000e+00]
 [-8.04670671e-03  1.84373213e-02]]
grads:  [1.05308239e-02 2.26763730e+01]
Stock Position:  0.01053082387567492
Bond Position:  [5.55923371]


portfolio before change:  [6.54076811]
curr_Stock_Price:  93.13985864218388
curr_Factors:  [9.31398586e+01 4.06736163e-02]
mat_Sqrt:  [[ 1.87841682e+01  0.00000000e+00]
 [-8.06708039e-03  1.84840033e-02]]
grads:  [-3.67927754e-03  1.05567846e+01]
Stock Position:  -0.0036792775418227623
Bond Position:  [6.8834555]


portfolio before change:  [6.54110172]
curr_Stock_Price:  93.28305794287051
curr_Factors:  [9.32830579e+01 4.10813101e-02]
mat_Sqrt:  [[ 1.89070998e+01  0.00000000e+00]
 [-8.10740995e-03  1.85764099e-02]]
grads:  [-0.00721697  5.09163262]
Stock Position:  -0.007216973833428486
Bond Position:  [7.21432311]


portfolio before change:  [6.55104997]
curr_Stock_Price:  92.02956850074683
curr_Factors:  [9.20295685e+01 4.34614363e-02]
mat_Sqrt:  [[ 1.91857784e+01  0.00000000e+00]
 [-8.33896265e-03  1.91069638e-02]]
grads:  [ 0.00956326 -3.82036298]
Stock Position:  0.009563260827791228
Bond Position:  [5.6709472]


portfolio before change:  [6.53262541]
curr_Stock_Price:  90.02884214144538
curr_Factors:  [9.00288421e+01 4.44686674e-02]
mat_Sqrt:  [[ 1.89849179e+01  0.00000000e+00]
 [-8.43503811e-03  1.93271003e-02]]
grads:  [ 1.95700248e-02 -2.13454804e+01]
Stock Position:  0.01957002482536163
Bond Position:  [4.77075874]


portfolio before change:  [6.54525977]
curr_Stock_Price:  90.64396524024842
curr_Factors:  [9.06439652e+01 4.44575466e-02]
mat_Sqrt:  [[ 1.91122423e+01  0.00000000e+00]
 [-8.43398331e-03  1.93246835e-02]]
grads:  [ 0.00512739 -4.64330478]
Stock Position:  0.005127388834086943
Bond Position:  [6.08049292]


portfolio before change:  [6.53831619]
curr_Stock_Price:  89.14150674613795
curr_Factors:  [8.91415067e+01 4.61664896e-02]
mat_Sqrt:  [[ 1.91532906e+01  0.00000000e+00]
 [-8.59455545e-03  1.96926005e-02]]
grads:  [  0.03897406 -16.84804221]
Stock Position:  0.038974060923659695
Bond Position:  [3.06410968]


portfolio before change:  [6.55058306]
curr_Stock_Price:  89.44642324131176
curr_Factors:  [8.94464232e+01 4.34397730e-02]
mat_Sqrt:  [[ 1.86426116e+01  0.00000000e+00]
 [-8.33688412e-03  1.91022013e-02]]
grads:  [ -0.05339705 -19.33016794]
Stock Position:  -0.05339704763661794
Bond Position:  [11.32675799]


portfolio before change:  [6.5483526]
curr_Stock_Price:  89.51471150384396
curr_Factors:  [8.95147115e+01 4.43068476e-02]
mat_Sqrt:  [[ 1.88421233e+01  0.00000000e+00]
 [-8.41967673e-03  1.92919030e-02]]
grads:  [ 0.04216136 13.22319224]
Stock Position:  0.042161360782736586
Bond Position:  [2.77429056]


portfolio before change:  [6.5073996]
curr_Stock_Price:  88.53514606504977
curr_Factors:  [8.85351461e+01 4.49944777e-02]
mat_Sqrt:  [[ 1.87799882e+01  0.00000000e+00]
 [-8.48476071e-03  1.94410291e-02]]
grads:  [-5.02430189e-03  2.34867005e+01]
Stock Position:  -0.005024301886777458
Bond Position:  [6.9522269]


portfolio before change:  [6.50943715]
curr_Stock_Price:  88.30258349543395
curr_Factors:  [8.83025835e+01 4.46884419e-02]
mat_Sqrt:  [[ 1.86668491e+01  0.00000000e+00]
 [-8.45585638e-03  1.93748010e-02]]
grads:  [0.05457391 6.90221113]
Stock Position:  0.054573912105335715
Bond Position:  [1.69041972]


portfolio before change:  [6.46074382]
curr_Stock_Price:  87.4064658978327
curr_Factors:  [8.74064659e+01 4.43474722e-02]
mat_Sqrt:  [[ 1.84067874e+01  0.00000000e+00]
 [-8.42353581e-03  1.93007452e-02]]
grads:  [-8.99806247e-04 -1.13254303e+01]
Stock Position:  -0.000899806247155629
Bond Position:  [6.5393927]


portfolio before change:  [6.46267936]
curr_Stock_Price:  86.16390761864457
curr_Factors:  [8.61639076e+01 4.41895680e-02]
mat_Sqrt:  [[ 1.81127863e+01  0.00000000e+00]
 [-8.40852595e-03  1.92663533e-02]]
grads:  [ 3.94624006e-03 -3.67030909e+01]
Stock Position:  0.003946240062118553
Bond Position:  [6.12265589]


portfolio before change:  [6.46099691]
curr_Stock_Price:  85.54361477570897
curr_Factors:  [8.55436148e+01 4.40135769e-02]
mat_Sqrt:  [[ 1.79465482e+01  0.00000000e+00]
 [-8.39176520e-03  1.92279496e-02]]
grads:  [ 0.01009617 -3.14608294]
Stock Position:  0.010096169557630602
Bond Position:  [5.59733407]


portfolio before change:  [6.45727303]
curr_Stock_Price:  85.10546899427372
curr_Factors:  [8.51054690e+01 4.31269478e-02]
mat_Sqrt:  [[ 1.76738771e+01  0.00000000e+00]
 [-8.30681145e-03  1.90332961e-02]]
grads:  [1.90482262e-02 5.36242383e+01]
Stock Position:  0.01904822622745305
Bond Position:  [4.8361648]


portfolio before change:  [6.47580116]
curr_Stock_Price:  86.04642647113695
curr_Factors:  [8.60464265e+01 4.29037063e-02]
mat_Sqrt:  [[ 1.78229769e+01  0.00000000e+00]
 [-8.28528395e-03  1.89839704e-02]]
grads:  [-0.02818253 -8.15434191]
Stock Position:  -0.02818252821847798
Bond Position:  [8.900807]


portfolio before change:  [6.43921666]
curr_Stock_Price:  87.38403427753994
curr_Factors:  [8.73840343e+01 4.32926289e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.43921666]
Stock Price:  86.6333648154987
PL:  [6.43921666]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.43364188e+00  3.53018920e-01]
 [ 8.78041437e-01  8.88724559e-02]
 [ 8.37882338e-02 -4.06997478e-03]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.12845646e-01  9.16002038e-01]
 [-2.13484446e-02 -1.14336103e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 5.52888074e-01  6.00635939e-01]
 [-1.94886316e-02  2.80339376e-01]
 [ 1.88128540e-01  7.43370056e-02]
 [-9.01188588e-02  8.85532611e-03]
 [ 3.77157436e-02 -1.39058188e-01]
 [-1.18458569e-01 -2.64104703e-02]
 [-1.26660561e-01  2.41507202e-01]
 [ 5.12992174e-01  3.36225040e-01]
 [ 1.30021440e-01  6.89166983e-02]
 [ 4.01046048e-02  1.27513562e-01]
 [ 7.34584465e-02  8.14423013e-02]
 [-4.47561053e-02 -2.75354105e-02]
 [-1.73175654e-01  2.19143158e-02]
 [ 1.51159359e-01 -3.01114036e-03]
 [ 9.46713666e-01  5.76072317e-02]
 [ 2.13182370e-02  4.35487984e-02]
 [-3.56743627e-02  4.84390155e-02]
 [ 7.66768859e-02 -1.96560835e-02]
 [ 1.41206171e-01 -9.94539384e-02]
 [-2.24494907e-02 -3.30602014e-01]
 [ 4.90411597e-02  9.78460166e-02]
 [ 2.85567772e-01 -5.57161247e-02]
 [-5.29370081e-01 -1.91368327e-01]
 [-1.32595356e-01 -4.57846569e-02]
 [-5.17414007e-02  4.23387941e-02]
 [ 8.87616122e-02  1.89709600e-01]
 [ 1.29972447e-02  1.53145193e-03]
 [ 9.51908067e-02 -4.19663360e-02]
 [-4.08414755e-02  1.19149950e-01]
 [-4.01114673e-02 -6.85703108e-02]
 [-1.40437582e-01 -6.98336887e-02]
 [ 1.15874235e-01 -1.05285640e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.49585166]
curr_Stock_Price:  99.5387855053929
curr_Factors:  [9.95387855e+01 4.06577486e-02]
mat_Sqrt:  [[ 2.00707685e+01  0.00000000e+00]
 [-8.06550667e-03  1.84803974e-02]]
grads:  [ 0.07910569 19.1023446 ]
Stock Position:  0.07910568899200567
Bond Position:  [-8.36993586]


portfolio before change:  [-0.54074857]
curr_Stock_Price:  98.984456087795
curr_Factors:  [9.89844561e+01 4.07416353e-02]
mat_Sqrt:  [[ 1.99795742e+01  0.00000000e+00]
 [-8.07382291e-03  1.84994523e-02]]
grads:  [0.04588829 4.80405875]
Stock Position:  0.045888292988451165
Bond Position:  [-5.0829763]


portfolio before change:  [-0.56486997]
curr_Stock_Price:  98.47264838342439
curr_Factors:  [9.84726484e+01 3.99521964e-02]
mat_Sqrt:  [[ 1.96827578e+01  0.00000000e+00]
 [-7.99521821e-03  1.83193463e-02]]
grads:  [ 0.00416669 -0.22216812]
Stock Position:  0.004166690053717669
Bond Position:  [-0.97517497]


portfolio before change:  [-0.56731188]
curr_Stock_Price:  97.91584860859234
curr_Factors:  [9.79158486e+01 3.92532117e-02]
mat_Sqrt:  [[ 1.93995024e+01  0.00000000e+00]
 [-7.92496932e-03  1.81583859e-02]]
grads:  [-8.40298201e-04 -8.33701924e+00]
Stock Position:  -0.0008402982007284116
Bond Position:  [-0.48503337]


portfolio before change:  [-0.56687106]
curr_Stock_Price:  97.31908711348204
curr_Factors:  [9.73190871e+01 3.85334717e-02]
mat_Sqrt:  [[ 1.91036827e+01  0.00000000e+00]
 [-7.85197776e-03  1.79911412e-02]]
grads:  [1.50196390e-02 5.09140597e+01]
Stock Position:  0.015019639026638026
Bond Position:  [-2.02856862]


portfolio before change:  [-0.55119396]
curr_Stock_Price:  98.37974399095357
curr_Factors:  [9.83797440e+01 3.75002265e-02]
mat_Sqrt:  [[ 1.90512130e+01  0.00000000e+00]
 [-7.74599009e-03  1.77482930e-02]]
grads:  [-3.73985692e-03 -6.44209014e+00]
Stock Position:  -0.0037398569246728792
Bond Position:  [-0.1832678]


portfolio before change:  [-0.55200385]
curr_Stock_Price:  98.59017426334509
curr_Factors:  [9.85901743e+01 3.76236476e-02]
mat_Sqrt:  [[ 1.91233548e+01  0.00000000e+00]
 [-7.75872645e-03  1.77774756e-02]]
grads:  [0.00676522 5.40779181]
Stock Position:  0.006765223910005038
Bond Position:  [-1.21898846]


portfolio before change:  [-0.54721966]
curr_Stock_Price:  99.319872648831
curr_Factors:  [9.93198726e+01 3.85338514e-02]
mat_Sqrt:  [[ 1.94965318e+01  0.00000000e+00]
 [-7.85201645e-03  1.79912299e-02]]
grads:  [ 0.0418037  33.38492944]
Stock Position:  0.041803695967820166
Bond Position:  [-4.69915742]


portfolio before change:  [-0.5825889]
curr_Stock_Price:  98.48784545937335
curr_Factors:  [9.84878455e+01 3.81739598e-02]
mat_Sqrt:  [[ 1.92427104e+01  0.00000000e+00]
 [-7.81526300e-03  1.79070171e-02]]
grads:  [5.34547893e-03 1.56552805e+01]
Stock Position:  0.0053454789253302
Bond Position:  [-1.10905361]


portfolio before change:  [-0.58097155]
curr_Stock_Price:  98.81634559689401
curr_Factors:  [9.88163456e+01 3.90219123e-02]
mat_Sqrt:  [[ 1.95201461e+01  0.00000000e+00]
 [-7.90158590e-03  1.81048077e-02]]
grads:  [0.0112997  4.10592626]
Stock Position:  0.0112997038181906
Bond Position:  [-1.69756699]


portfolio before change:  [-0.58611302]
curr_Stock_Price:  98.38011691169375
curr_Factors:  [9.83801169e+01 4.03436182e-02]
mat_Sqrt:  [[ 1.97603557e+01  0.00000000e+00]
 [-8.03428834e-03  1.84088672e-02]]
grads:  [-0.00436501  0.48103591]
Stock Position:  -0.004365006338998041
Bond Position:  [-0.15668318]


portfolio before change:  [-0.58403275]
curr_Stock_Price:  97.89905158695723
curr_Factors:  [9.78990516e+01 4.09598714e-02]
mat_Sqrt:  [[ 1.98133439e+01  0.00000000e+00]
 [-8.09541811e-03  1.85489331e-02]]
grads:  [-1.15953295e-03 -7.49682942e+00]
Stock Position:  -0.0011595329472391983
Bond Position:  [-0.47051558]


portfolio before change:  [-0.58297627]
curr_Stock_Price:  96.93719713510248
curr_Factors:  [9.69371971e+01 4.27174729e-02]
mat_Sqrt:  [[ 2.00351794e+01  0.00000000e+00]
 [-8.26728230e-03  1.89427235e-02]]
grads:  [-0.00648784 -1.39422773]
Stock Position:  -0.006487840265448747
Bond Position:  [0.04593678]


portfolio before change:  [-0.58038146]
curr_Stock_Price:  96.5381324795052
curr_Factors:  [9.65381325e+01 4.18564309e-02]
mat_Sqrt:  [[ 1.97505862e+01  0.00000000e+00]
 [-8.18353771e-03  1.87508405e-02]]
grads:  [-1.07633145e-03  1.28798067e+01]
Stock Position:  -0.0010763314540201728
Bond Position:  [-0.47647443]


portfolio before change:  [-0.58255422]
curr_Stock_Price:  98.50146289251427
curr_Factors:  [9.85014629e+01 4.03215497e-02]
mat_Sqrt:  [[ 1.97793169e+01  0.00000000e+00]
 [-8.03209060e-03  1.84038316e-02]]
grads:  [ 0.03335468 18.2692956 ]
Stock Position:  0.03335468137079164
Bond Position:  [-3.86803912]


portfolio before change:  [-0.59861531]
curr_Stock_Price:  98.03443520870277
curr_Factors:  [9.80344352e+01 3.98116222e-02]
mat_Sqrt:  [[ 1.95606638e+01  0.00000000e+00]
 [-7.98113999e-03  1.82870891e-02]]
grads:  [0.00818475 3.7685986 ]
Stock Position:  0.008184750525383389
Bond Position:  [-1.40100271]


portfolio before change:  [-0.60332562]
curr_Stock_Price:  97.48033458896171
curr_Factors:  [9.74803346e+01 4.02751342e-02]
mat_Sqrt:  [[ 1.95630024e+01  0.00000000e+00]
 [-8.02746627e-03  1.83932359e-02]]
grads:  [4.89475407e-03 6.93263342e+00]
Stock Position:  0.004894754067442479
Bond Position:  [-1.08046789]


portfolio before change:  [-0.60411375]
curr_Stock_Price:  97.34691446637028
curr_Factors:  [9.73469145e+01 4.00706021e-02]
mat_Sqrt:  [[ 1.94865576e+01  0.00000000e+00]
 [-8.00705709e-03  1.83464726e-02]]
grads:  [0.00559374 4.43912587]
Stock Position:  0.005593742277611192
Bond Position:  [-1.1486473]


portfolio before change:  [-0.60609005]
curr_Stock_Price:  97.01927834353408
curr_Factors:  [9.70192783e+01 4.02578476e-02]
mat_Sqrt:  [[ 1.94662957e+01  0.00000000e+00]
 [-8.02574334e-03  1.83892882e-02]]
grads:  [-0.0029165  -1.49736141]
Stock Position:  -0.002916504742257786
Bond Position:  [-0.32313286]


portfolio before change:  [-0.61056541]
curr_Stock_Price:  98.53992404464655
curr_Factors:  [9.85399240e+01 3.97519788e-02]
mat_Sqrt:  [[ 1.96467898e+01  0.00000000e+00]
 [-7.97515931e-03  1.82733856e-02]]
grads:  [-0.00832764  1.19924771]
Stock Position:  -0.008327643546549066
Bond Position:  [0.21003995]


portfolio before change:  [-0.60337724]
curr_Stock_Price:  97.67990655090352
curr_Factors:  [9.76799066e+01 4.05021917e-02]
mat_Sqrt:  [[ 1.96582339e+01  0.00000000e+00]
 [-8.05006253e-03  1.84450104e-02]]
grads:  [ 0.00762252 -0.16324959]
Stock Position:  0.00762251534886102
Bond Position:  [-1.34794383]


portfolio before change:  [-0.59234122]
curr_Stock_Price:  99.14983113631791
curr_Factors:  [9.91498311e+01 4.11697467e-02]
mat_Sqrt:  [[ 2.01178273e+01  0.00000000e+00]
 [-8.11613176e-03  1.85963941e-02]]
grads:  [0.04830817 3.09776355]
Stock Position:  0.04830817495859834
Bond Position:  [-5.38208861]


portfolio before change:  [-0.62529184]
curr_Stock_Price:  98.48166641643334
curr_Factors:  [9.84816664e+01 4.17056145e-02]
mat_Sqrt:  [[ 2.01118792e+01  0.00000000e+00]
 [-8.16878101e-03  1.87170287e-02]]
grads:  [2.0050086e-03 2.3266940e+00]
Stock Position:  0.002005008603566413
Bond Position:  [-0.82274843]


portfolio before change:  [-0.62349634]
curr_Stock_Price:  99.42847272562895
curr_Factors:  [9.94284727e+01 4.32062695e-02]
mat_Sqrt:  [[ 2.06673195e+01  0.00000000e+00]
 [-8.31444714e-03  1.90507917e-02]]
grads:  [-7.03228260e-04  2.54262481e+00]
Stock Position:  -0.0007032282599545431
Bond Position:  [-0.55357542]


portfolio before change:  [-0.62368719]
curr_Stock_Price:  99.60146411683625
curr_Factors:  [9.96014641e+01 4.22646837e-02]
mat_Sqrt:  [[ 2.04764438e+01  0.00000000e+00]
 [-8.22335053e-03  1.88420631e-02]]
grads:  [ 0.00332569 -1.04320229]
Stock Position:  0.003325688211978629
Bond Position:  [-0.9549306]


portfolio before change:  [-0.62457408]
curr_Stock_Price:  99.37067833562222
curr_Factors:  [9.93706783e+01 4.19958893e-02]
mat_Sqrt:  [[ 2.03639324e+01  0.00000000e+00]
 [-8.19715944e-03  1.87820518e-02]]
grads:  [ 4.80265363e-03 -5.29515834e+00]
Stock Position:  0.004802653625651219
Bond Position:  [-1.10181703]


portfolio before change:  [-0.62680437]
curr_Stock_Price:  98.93497062499588
curr_Factors:  [9.89349706e+01 4.01077813e-02]
mat_Sqrt:  [[ 1.98136345e+01  0.00000000e+00]
 [-8.01077088e-03  1.83549820e-02]]
grads:  [-8.41521722e-03 -1.80115684e+01]
Stock Position:  -0.008415217220739698
Bond Position:  [0.2057549]


portfolio before change:  [-0.62444305]
curr_Stock_Price:  98.65742530032225
curr_Factors:  [9.86574253e+01 4.10377485e-02]
mat_Sqrt:  [[ 1.99858001e+01  0.00000000e+00]
 [-8.10311037e-03  1.85665583e-02]]
grads:  [4.59049233e-03 5.27001369e+00]
Stock Position:  0.004590492333175303
Bond Position:  [-1.0773292]


portfolio before change:  [-0.63124474]
curr_Stock_Price:  97.20507174174173
curr_Factors:  [9.72050717e+01 4.23941040e-02]
mat_Sqrt:  [[ 2.00143576e+01  0.00000000e+00]
 [-8.23593142e-03  1.88708896e-02]]
grads:  [ 0.01305319 -2.95249063]
Stock Position:  0.013053192457989433
Bond Position:  [-1.90008125]


portfolio before change:  [-0.63734317]
curr_Stock_Price:  96.75606997646356
curr_Factors:  [9.67560700e+01 4.34025069e-02]
mat_Sqrt:  [[ 2.01574517e+01  0.00000000e+00]
 [-8.33330733e-03  1.90940058e-02]]
grads:  [ -0.03040514 -10.02242951]
Stock Position:  -0.03040513633626462
Bond Position:  [2.30453833]


portfolio before change:  [-0.65333555]
curr_Stock_Price:  97.29152105877378
curr_Factors:  [9.72915211e+01 4.32796399e-02]
mat_Sqrt:  [[ 2.02402938e+01  0.00000000e+00]
 [-8.32150370e-03  1.90669603e-02]]
grads:  [-0.0075383  -2.40125621]
Stock Position:  -0.007538300586816706
Bond Position:  [0.08007718]


portfolio before change:  [-0.6458847]
curr_Stock_Price:  96.30444927884113
curr_Factors:  [9.63044493e+01 4.44997232e-02]
mat_Sqrt:  [[ 2.03153827e+01  0.00000000e+00]
 [-8.43798300e-03  1.93338479e-02]]
grads:  [-1.63734233e-03  2.18987934e+00]
Stock Position:  -0.0016373423316891895
Bond Position:  [-0.48820134]


portfolio before change:  [-0.64752183]
curr_Stock_Price:  97.2670494253738
curr_Factors:  [9.72670494e+01 4.41296520e-02]
mat_Sqrt:  [[ 2.04329463e+01  0.00000000e+00]
 [-8.40282352e-03  1.92532874e-02]]
grads:  [8.39612982e-03 9.85336143e+00]
Stock Position:  0.008396129817844072
Bond Position:  [-1.4641886]


portfolio before change:  [-0.64975292]
curr_Stock_Price:  97.02312117338741
curr_Factors:  [9.70231212e+01 4.25791572e-02]
mat_Sqrt:  [[ 2.00204471e+01  0.00000000e+00]
 [-8.25388706e-03  1.89120311e-02]]
grads:  [0.00068258 0.08097766]
Stock Position:  0.0006825834150595592
Bond Position:  [-0.71597929]


portfolio before change:  [-0.64960797]
curr_Stock_Price:  97.36659692779223
curr_Factors:  [9.73665969e+01 4.31547226e-02]
mat_Sqrt:  [[ 2.02266591e+01  0.00000000e+00]
 [-8.30948591e-03  1.90394241e-02]]
grads:  [ 0.00380069 -2.20418096]
Stock Position:  0.003800686785739524
Bond Position:  [-1.01966791]


portfolio before change:  [-0.65010453]
curr_Stock_Price:  97.2694859815308
curr_Factors:  [9.72694860e+01 4.33801983e-02]
mat_Sqrt:  [[ 2.02592044e+01  0.00000000e+00]
 [-8.33116542e-03  1.90890981e-02]]
grads:  [5.50852124e-04 6.24177996e+00]
Stock Position:  0.0005508521238473755
Bond Position:  [-0.70368563]


portfolio before change:  [-0.65005874]
curr_Stock_Price:  97.51229700770338
curr_Factors:  [9.75122970e+01 4.31841801e-02]
mat_Sqrt:  [[ 2.02638390e+01  0.00000000e+00]
 [-8.31232146e-03  1.90459212e-02]]
grads:  [-3.45630482e-03 -3.60026224e+00]
Stock Position:  -0.0034563048236995937
Bond Position:  [-0.31302652]


portfolio before change:  [-0.65053102]
curr_Stock_Price:  97.63761829488149
curr_Factors:  [9.76376183e+01 4.31591990e-02]
mat_Sqrt:  [[ 2.02840123e+01  0.00000000e+00]
 [-8.30991687e-03  1.90404115e-02]]
grads:  [-0.00842612 -3.66765648]
Stock Position:  -0.008426119053522379
Bond Position:  [0.17217518]


portfolio before change:  [-0.64623568]
curr_Stock_Price:  97.13040806382527
curr_Factors:  [9.71304081e+01 4.18075097e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.64623568]
Stock Price:  97.028114082834
PL:  [-0.64623568]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.01207232e+00  2.57710490e-01]
 [-2.67433271e-01 -9.96050683e-02]
 [-3.74801755e-01 -1.50921490e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.14823409e-01 -3.06363163e-01]
 [-2.87115824e-01  1.08986202e-01]
 [ 8.97568130e-02  8.20876346e-02]
 [ 5.24490781e-01  5.81642717e-01]
 [-4.47407331e-02  1.99782053e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-7.56852979e-02  1.26177012e-02]
 [ 7.14555134e-02 -1.05540434e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-1.06776916e-01  1.71290861e-01]
 [ 3.50463408e-01  2.51005198e-01]
 [ 1.32774969e-01 -5.41549712e-02]
 [ 3.95346768e-02  5.27846359e-02]
 [ 2.74745760e-01  6.68990055e-02]
 [ 2.50256039e-01  2.60247264e-01]
 [-5.83978163e-01  2.64232075e-01]
 [-1.04281331e-01  2.56983037e-01]
 [ 1.75391693e+00  2.43721589e-01]
 [ 1.50832188e-02  4.33884364e-01]
 [-1.54296476e-01  1.95217711e-01]
 [-1.67243492e-01  7.86288765e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 2.97441726e-01 -4.35809593e-01]
 [ 1.27173045e-01 -6.84762178e-02]
 [ 8.15218870e-01 -3.25953541e-01]
 [-8.12369141e-01 -3.63995177e-01]
 [ 7.77283014e-01  2.89832266e-01]
 [-2.82653574e-01  4.37761873e-01]
 [ 9.80920318e-01  1.29748138e-01]
 [ 8.28672709e-02 -2.41686546e-01]
 [ 4.05877330e-01 -7.89599443e-01]
 [ 2.20721615e-01 -6.67959139e-02]
 [-1.12605186e-01  1.08131941e+00]
 [-4.42704766e-01 -1.56692024e-01]
 [-8.25908499e-01  1.96053616e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.47946571]
curr_Stock_Price:  101.56737221141125
curr_Factors:  [1.01567372e+02 4.02783474e-02]
mat_Sqrt:  [[ 2.03840295e+01  0.00000000e+00]
 [-8.02778649e-03  1.83939696e-02]]
grads:  [ 0.05516801 14.01059668]
Stock Position:  0.05516801289049875
Bond Position:  [7.87619561]


portfolio before change:  [13.50971275]
curr_Stock_Price:  102.09779646687467
curr_Factors:  [1.02097796e+02 3.99128097e-02]
mat_Sqrt:  [[ 2.03972923e+01  0.00000000e+00]
 [-7.99127621e-03  1.83103141e-02]]
grads:  [-0.01524244 -5.43983396]
Stock Position:  -0.015242439154534113
Bond Position:  [15.0659322]


portfolio before change:  [13.50845182]
curr_Stock_Price:  102.30408205567353
curr_Factors:  [1.02304082e+02 3.97121409e-02]
mat_Sqrt:  [[ 2.03870606e+01  0.00000000e+00]
 [-7.97116212e-03  1.82642269e-02]]
grads:  [-0.02161515 -8.26322905]
Stock Position:  -0.021615146122460585
Bond Position:  [15.7197695]


portfolio before change:  [13.516442]
curr_Stock_Price:  102.02533814094018
curr_Factors:  [1.02025338e+02 3.88910917e-02]
mat_Sqrt:  [[ 2.01202378e+01  0.00000000e+00]
 [-7.88832978e-03  1.80744342e-02]]
grads:  [-8.10197528e-04 -8.37574284e+00]
Stock Position:  -0.0008101975284102382
Bond Position:  [13.59910268]


portfolio before change:  [13.51835104]
curr_Stock_Price:  101.76731485161852
curr_Factors:  [1.01767315e+02 3.89818294e-02]
mat_Sqrt:  [[ 2.00927520e+01  0.00000000e+00]
 [-7.89752664e-03  1.80955068e-02]]
grads:  [-1.23691993e-02 -1.69303444e+01]
Stock Position:  -0.012369199346582406
Bond Position:  [14.77713125]


portfolio before change:  [13.52851639]
curr_Stock_Price:  101.09483046290445
curr_Factors:  [1.01094830e+02 3.87789371e-02]
mat_Sqrt:  [[ 1.99079664e+01  0.00000000e+00]
 [-7.87694734e-03  1.80483537e-02]]
grads:  [-0.01203289  6.03856749]
Stock Position:  -0.01203288879112593
Bond Position:  [14.74497925]


portfolio before change:  [13.54692861]
curr_Stock_Price:  99.71785654557154
curr_Factors:  [9.97178565e+01 3.92893894e-02]
mat_Sqrt:  [[ 1.97656260e+01  0.00000000e+00]
 [-7.92862050e-03  1.81667518e-02]]
grads:  [0.0063536  4.51856422]
Stock Position:  0.006353595562511801
Bond Position:  [12.91336168]


portfolio before change:  [13.54690182]
curr_Stock_Price:  99.45956889188136
curr_Factors:  [9.94595689e+01 4.01273869e-02]
mat_Sqrt:  [[ 1.99235632e+01  0.00000000e+00]
 [-8.01272856e-03  1.83594676e-02]]
grads:  [ 0.03906633 31.68080526]
Stock Position:  0.03906632896661728
Bond Position:  [9.66138159]


portfolio before change:  [13.53741289]
curr_Stock_Price:  99.18576059876389
curr_Factors:  [9.91857606e+01 4.07504127e-02]
mat_Sqrt:  [[ 2.00223631e+01  0.00000000e+00]
 [-8.07469258e-03  1.85014450e-02]]
grads:  [2.12019445e-03 1.07981865e+01]
Stock Position:  0.002120194448153221
Bond Position:  [13.32711979]


portfolio before change:  [13.53674448]
curr_Stock_Price:  98.08472968418835
curr_Factors:  [9.80847297e+01 4.00922892e-02]
mat_Sqrt:  [[ 1.96395633e+01  0.00000000e+00]
 [-8.00922360e-03  1.83514367e-02]]
grads:  [0.01254784 6.16172647]
Stock Position:  0.012547844523541045
Bond Position:  [12.30599254]


portfolio before change:  [13.5373593]
curr_Stock_Price:  98.01112943003223
curr_Factors:  [9.80111294e+01 3.89168085e-02]
mat_Sqrt:  [[ 1.93349923e+01  0.00000000e+00]
 [-7.89093744e-03  1.80804091e-02]]
grads:  [-0.00362961  0.69786592]
Stock Position:  -0.003629610018838827
Bond Position:  [13.89310148]


portfolio before change:  [13.54450635]
curr_Stock_Price:  96.52052896514743
curr_Factors:  [9.65205290e+01 3.94974976e-02]
mat_Sqrt:  [[ 1.91824681e+01  0.00000000e+00]
 [-7.94959095e-03  1.82148011e-02]]
grads:  [ 1.32380733e-03 -5.79421278e+00]
Stock Position:  0.001323807331414338
Bond Position:  [13.41673176]


portfolio before change:  [13.54846051]
curr_Stock_Price:  98.24054442645536
curr_Factors:  [9.82405444e+01 3.82755827e-02]
mat_Sqrt:  [[ 1.92199240e+01  0.00000000e+00]
 [-7.82565859e-03  1.79308364e-02]]
grads:  [-0.00672994 -1.56442257]
Stock Position:  -0.0067299375474350505
Bond Position:  [14.20961324]


portfolio before change:  [13.55660253]
curr_Stock_Price:  97.29466533443473
curr_Factors:  [9.72946653e+01 4.00928381e-02]
mat_Sqrt:  [[ 1.94815016e+01  0.00000000e+00]
 [-8.00927843e-03  1.83515623e-02]]
grads:  [-1.64358250e-03  9.33385713e+00]
Stock Position:  -0.0016435825046402105
Bond Position:  [13.71651434]


portfolio before change:  [13.560351]
curr_Stock_Price:  96.05724852657241
curr_Factors:  [9.60572485e+01 3.93715000e-02]
mat_Sqrt:  [[ 1.90599222e+01  0.00000000e+00]
 [-7.93690116e-03  1.81857252e-02]]
grads:  [ 0.02413499 13.80232   ]
Stock Position:  0.024134991381275662
Bond Position:  [11.24201013]


portfolio before change:  [13.55426852]
curr_Stock_Price:  95.74700121734108
curr_Factors:  [9.57470012e+01 4.00192785e-02]
mat_Sqrt:  [[ 1.91540143e+01  0.00000000e+00]
 [-8.00192762e-03  1.83347195e-02]]
grads:  [ 0.00569801 -2.95368419]
Stock Position:  0.005698011914930107
Bond Position:  [13.00870097]


portfolio before change:  [13.55150888]
curr_Stock_Price:  94.9772888337613
curr_Factors:  [9.49772888e+01 3.98817917e-02]
mat_Sqrt:  [[ 1.89673692e+01  0.00000000e+00]
 [-7.98817042e-03  1.83031978e-02]]
grads:  [0.00329892 2.88390239]
Stock Position:  0.00329891719744939
Bond Position:  [13.23818667]


portfolio before change:  [13.55156399]
curr_Stock_Price:  94.49235167113882
curr_Factors:  [9.44923517e+01 3.96062983e-02]
mat_Sqrt:  [[ 1.88052358e+01  0.00000000e+00]
 [-7.96053247e-03  1.82398713e-02]]
grads:  [0.01616267 3.66773451]
Stock Position:  0.016162673079274933
Bond Position:  [12.024315]


portfolio before change:  [13.54400057]
curr_Stock_Price:  93.931395413161
curr_Factors:  [9.39313954e+01 3.99363751e-02]
mat_Sqrt:  [[ 1.87713322e+01  0.00000000e+00]
 [-7.99363498e-03  1.83157187e-02]]
grads:  [ 0.0193826  14.20895727]
Stock Position:  0.019382601772034682
Bond Position:  [11.72336574]


portfolio before change:  [13.55529143]
curr_Stock_Price:  94.43831131617563
curr_Factors:  [9.44383113e+01 3.96836329e-02]
mat_Sqrt:  [[ 1.88128211e+01  0.00000000e+00]
 [-7.96830049e-03  1.82576701e-02]]
grads:  [-0.02491162 14.47238744]
Stock Position:  -0.02491161904465275
Bond Position:  [15.90790267]


portfolio before change:  [13.60672624]
curr_Stock_Price:  92.45344667537562
curr_Factors:  [9.24534467e+01 4.04690380e-02]
mat_Sqrt:  [[ 1.85987838e+01  0.00000000e+00]
 [-8.04676710e-03  1.84374597e-02]]
grads:  [4.23428848e-04 1.39380935e+01]
Stock Position:  0.00042342884797463327
Bond Position:  [13.56757878]


portfolio before change:  [13.60865735]
curr_Stock_Price:  93.00857249788532
curr_Factors:  [9.30085725e+01 4.03786839e-02]
mat_Sqrt:  [[ 1.86895592e+01  0.00000000e+00]
 [-8.03777919e-03  1.84168658e-02]]
grads:  [ 0.0995361  13.23360836]
Stock Position:  0.09953609573701437
Bond Position:  [4.35094717]


portfolio before change:  [13.67583409]
curr_Stock_Price:  93.67800648307555
curr_Factors:  [9.36780065e+01 3.87952203e-02]
mat_Sqrt:  [[ 1.84512907e+01  0.00000000e+00]
 [-7.87860092e-03  1.80521426e-02]]
grads:  [1.10803024e-02 2.40350619e+01]
Stock Position:  0.011080302352385343
Bond Position:  [12.63785346]


portfolio before change:  [13.67139373]
curr_Stock_Price:  93.1346821112174
curr_Factors:  [9.31346821e+01 3.81953690e-02]
mat_Sqrt:  [[ 1.82019028e+01  0.00000000e+00]
 [-7.81745422e-03  1.79120378e-02]]
grads:  [-3.79611307e-03  1.08986880e+01]
Stock Position:  -0.0037961130722297693
Bond Position:  [14.02494351]


portfolio before change:  [13.67565495]
curr_Stock_Price:  92.47400698932043
curr_Factors:  [9.24740070e+01 3.87260212e-02]
mat_Sqrt:  [[ 1.81978934e+01  0.00000000e+00]
 [-7.87157125e-03  1.80360355e-02]]
grads:  [-0.00730453  4.35954322]
Stock Position:  -0.00730452882332163
Bond Position:  [14.351134]


portfolio before change:  [13.66979909]
curr_Stock_Price:  93.52128429037394
curr_Factors:  [9.35212843e+01 3.82227911e-02]
mat_Sqrt:  [[ 1.82840189e+01  0.00000000e+00]
 [-7.82025995e-03  1.79184666e-02]]
grads:  [ 0.01003492 -4.07376026]
Stock Position:  0.010034916512861345
Bond Position:  [12.73132081]


portfolio before change:  [13.65857531]
curr_Stock_Price:  92.2442139309699
curr_Factors:  [9.22442139e+01 3.92583580e-02]
mat_Sqrt:  [[ 1.82770121e+01  0.00000000e+00]
 [-7.92548881e-03  1.81595762e-02]]
grads:  [ 5.86741557e-03 -2.39988857e+01]
Stock Position:  0.005867415573675352
Bond Position:  [13.11734017]


portfolio before change:  [13.65608461]
curr_Stock_Price:  91.54024674801157
curr_Factors:  [9.15402467e+01 3.99875271e-02]
mat_Sqrt:  [[ 1.83051947e+01  0.00000000e+00]
 [-7.99875261e-03  1.83274447e-02]]
grads:  [ 0.00531475 -3.73626651]
Stock Position:  0.0053147521913650105
Bond Position:  [13.16957088]


portfolio before change:  [13.65058888]
curr_Stock_Price:  90.1964350816255
curr_Factors:  [9.01964351e+01 4.21807346e-02]
mat_Sqrt:  [[ 1.85244978e+01  0.00000000e+00]
 [-8.21517957e-03  1.88233411e-02]]
grads:  [  0.03632817 -17.31645508]
Stock Position:  0.03632816884441002
Bond Position:  [10.37391756]


portfolio before change:  [13.63582353]
curr_Stock_Price:  89.75429417201455
curr_Factors:  [8.97542942e+01 4.25583717e-02]
mat_Sqrt:  [[ 1.85160241e+01  0.00000000e+00]
 [-8.25187220e-03  1.89074145e-02]]
grads:  [ -0.05245347 -19.25145172]
Stock Position:  -0.05245346701531969
Bond Position:  [18.34374744]


portfolio before change:  [13.69560002]
curr_Stock_Price:  88.65840132743223
curr_Factors:  [8.86584013e+01 4.30816500e-02]
mat_Sqrt:  [[ 1.84020438e+01  0.00000000e+00]
 [-8.30244783e-03  1.90232978e-02]]
grads:  [ 0.04911282 15.23564785]
Stock Position:  0.04911281566967795
Bond Position:  [9.3413363]


portfolio before change:  [13.70815533]
curr_Stock_Price:  88.89026682550968
curr_Factors:  [8.88902668e+01 4.25822572e-02]
mat_Sqrt:  [[ 1.83429233e+01  0.00000000e+00]
 [-8.25418751e-03  1.89127195e-02]]
grads:  [-4.99367674e-03  2.31464265e+01]
Stock Position:  -0.004993676737766365
Bond Position:  [14.15204459]


portfolio before change:  [13.71404938]
curr_Stock_Price:  88.06423504610383
curr_Factors:  [8.80642350e+01 4.23173866e-02]
mat_Sqrt:  [[ 1.81158613e+01  0.00000000e+00]
 [-8.22847607e-03  1.88538072e-02]]
grads:  [0.05727285 6.88180037]
Stock Position:  0.057272852310258006
Bond Position:  [8.67035946]


portfolio before change:  [13.6294564]
curr_Stock_Price:  86.56829337842083
curr_Factors:  [8.65682934e+01 4.35177242e-02]
mat_Sqrt:  [[ 1.80589271e+01  0.00000000e+00]
 [-8.34436090e-03  1.91193327e-02]]
grads:  [-1.25219983e-03 -1.26409509e+01]
Stock Position:  -0.0012521998302192727
Bond Position:  [13.7378572]


portfolio before change:  [13.63318659]
curr_Stock_Price:  84.96084546873115
curr_Factors:  [8.49608455e+01 4.64884157e-02]
mat_Sqrt:  [[ 1.83185544e+01  0.00000000e+00]
 [-8.62446898e-03  1.97611410e-02]]
grads:  [ 3.34458053e-03 -3.99571788e+01]
Stock Position:  0.0033445805316251556
Bond Position:  [13.3490282]


portfolio before change:  [13.63453557]
curr_Stock_Price:  84.86524227321404
curr_Factors:  [8.48652423e+01 4.89974524e-02]
mat_Sqrt:  [[ 1.87852338e+01  0.00000000e+00]
 [-8.85414727e-03  2.02874000e-02]]
grads:  [ 0.01019788 -3.29248271]
Stock Position:  0.010197876137659549
Bond Position:  [12.76909034]


portfolio before change:  [13.63166384]
curr_Stock_Price:  84.42711545819341
curr_Factors:  [8.44271155e+01 4.96940831e-02]
mat_Sqrt:  [[ 1.88206359e+01  0.00000000e+00]
 [-8.91686789e-03  2.04311110e-02]]
grads:  [1.90918785e-02 5.29251399e+01]
Stock Position:  0.01909187853627278
Bond Position:  [12.01979161]


portfolio before change:  [13.65085944]
curr_Stock_Price:  85.35384642058206
curr_Factors:  [8.53538464e+01 4.69460453e-02]
mat_Sqrt:  [[ 1.84936487e+01  0.00000000e+00]
 [-8.66681443e-03  1.98581666e-02]]
grads:  [-0.02763602 -7.89055844]
Stock Position:  -0.0276360160096888
Bond Position:  [16.00969971]


portfolio before change:  [13.63379336]
curr_Stock_Price:  86.04379455809222
curr_Factors:  [8.60437946e+01 4.70431079e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.63379336]
Stock Price:  86.5189161420776
PL:  [13.63379336]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48354037e+00  3.64490769e-01]
 [ 9.93879953e-01  7.83875419e-02]
 [-2.02517659e-01  2.04553413e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-2.00824544e-01  1.39311529e+00]
 [ 6.40602206e-02  5.30950367e-02]
 [ 8.79513266e-02  9.53197804e-02]
 [ 1.18900087e+00  1.21974962e+00]
 [ 9.20318950e-02  5.78175522e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-2.43119425e-02  1.90212001e-02]
 [ 7.25027794e-02 -1.08310783e-01]
 [-1.19053424e-01 -2.57580644e-02]
 [-1.18551515e-01  2.12979909e-01]
 [ 3.69039863e-01  2.59233894e-01]
 [ 1.30779345e-01  6.95485180e-02]
 [ 3.95914497e-02  1.11632221e-01]
 [-3.03109493e-03  7.58267160e-03]
 [-4.58568752e-02 -3.09400593e-02]
 [-1.29239969e-01 -3.16600971e-03]
 [ 1.35803473e-01  2.20532915e-02]
 [ 1.19347747e+00  1.16023440e-01]
 [ 1.63021573e-02  3.69294413e-01]
 [-1.32984935e-01  1.11372753e-01]
 [-1.82274834e-01  1.58935363e-01]
 [ 1.28401131e-01 -1.03807262e-01]
 [-2.23262112e-01 -4.45018775e-01]
 [ 4.78938251e-02  1.00288390e-01]
 [ 1.56254371e-01  4.67510694e-02]
 [-5.33487097e-01 -1.71862098e-01]
 [-8.25495289e-02 -2.73124532e-02]
 [-5.42442617e-02  4.66457508e-02]
 [ 3.24324098e-01  2.14843745e-01]
 [ 1.43173477e-02  6.92674626e-04]
 [ 1.77402369e-01 -1.13693342e-01]
 [ 3.67916505e-02  1.14983116e-01]
 [-4.61505110e-02  7.53864048e-03]
 [-3.34191529e-01 -1.22255188e-01]
 [ 1.35778604e-01  2.99161071e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.54895374]
curr_Stock_Price:  99.09561257909067
curr_Factors:  [9.90956126e+01 3.92376567e-02]
mat_Sqrt:  [[ 1.96293518e+01  0.00000000e+00]
 [-7.92339894e-03  1.81547877e-02]]
grads:  [ 0.08368168 20.07684006]
Stock Position:  0.08368168258655563
Bond Position:  [-11.84144133]


portfolio before change:  [-3.58936131]
curr_Stock_Price:  98.63042953677119
curr_Factors:  [9.86304295e+01 3.97986343e-02]
mat_Sqrt:  [[ 1.96763713e+01  0.00000000e+00]
 [-7.97983802e-03  1.82841059e-02]]
grads:  [0.05225003 4.2871958 ]
Stock Position:  0.05225003461487358
Bond Position:  [-8.74280467]


portfolio before change:  [-3.7063632]
curr_Stock_Price:  96.41207745865806
curr_Factors:  [9.64120775e+01 4.14893886e-02]
mat_Sqrt:  [[ 1.96381222e+01  0.00000000e+00]
 [-8.14757766e-03  1.86684457e-02]]
grads:  [-5.76649993e-03  1.09571743e+01]
Stock Position:  -0.005766499926474309
Bond Position:  [-3.15040296]


portfolio before change:  [-3.70270604]
curr_Stock_Price:  95.70957438549915
curr_Factors:  [9.57095744e+01 4.23235205e-02]
mat_Sqrt:  [[ 1.96900255e+01  0.00000000e+00]
 [-8.22907242e-03  1.88551736e-02]]
grads:  [-8.27899740e-04 -8.02892699e+00]
Stock Position:  -0.0008278997395574407
Bond Position:  [-3.62346811]


portfolio before change:  [-3.70230979]
curr_Stock_Price:  94.6838293902872
curr_Factors:  [9.46838294e+01 4.30493351e-02]
mat_Sqrt:  [[ 1.96453169e+01  0.00000000e+00]
 [-8.29933348e-03  1.90161619e-02]]
grads:  [2.07266097e-02 7.32595409e+01]
Stock Position:  0.020726609732089056
Bond Position:  [-5.66478457]


portfolio before change:  [-3.69131789]
curr_Stock_Price:  95.24832337149773
curr_Factors:  [9.52483234e+01 4.25413647e-02]
mat_Sqrt:  [[ 1.96454983e+01  0.00000000e+00]
 [-8.25022324e-03  1.89036362e-02]]
grads:  [0.00444035 2.80872082]
Stock Position:  0.00444034522234247
Bond Position:  [-4.11425332]


portfolio before change:  [-3.69185185]
curr_Stock_Price:  95.2438988014756
curr_Factors:  [9.52438988e+01 4.34082724e-02]
mat_Sqrt:  [[ 1.98437349e+01  0.00000000e+00]
 [-8.33386080e-03  1.90952740e-02]]
grads:  [0.00652862 4.99179957]
Stock Position:  0.006528624284661805
Bond Position:  [-4.31366348]


portfolio before change:  [-3.69131261]
curr_Stock_Price:  95.40909165825013
curr_Factors:  [9.54090917e+01 4.37278107e-02]
mat_Sqrt:  [[ 1.99511819e+01  0.00000000e+00]
 [-8.36447829e-03  1.91654275e-02]]
grads:  [ 0.08627776 63.64322521]
Stock Position:  0.08627775827392765
Bond Position:  [-11.92299515]


portfolio before change:  [-3.70571862]
curr_Stock_Price:  95.25939441947259
curr_Factors:  [9.52593944e+01 4.48078858e-02]
mat_Sqrt:  [[ 2.01643879e+01  0.00000000e+00]
 [-8.46714930e-03  1.94006763e-02]]
grads:  [1.70780478e-02 2.98018231e+01]
Stock Position:  0.017078047815979536
Bond Position:  [-5.33256311]


portfolio before change:  [-3.67443402]
curr_Stock_Price:  97.13028767882055
curr_Factors:  [9.71302877e+01 4.40234487e-02]
mat_Sqrt:  [[ 2.03796493e+01  0.00000000e+00]
 [-8.39270623e-03  1.92301058e-02]]
grads:  [0.01209217 5.8801826 ]
Stock Position:  0.012092170163277325
Bond Position:  [-4.84894999]


portfolio before change:  [-3.68491277]
curr_Stock_Price:  96.31384256741782
curr_Factors:  [9.63138426e+01 4.44371939e-02]
mat_Sqrt:  [[ 2.03030846e+01  0.00000000e+00]
 [-8.43205255e-03  1.93202595e-02]]
grads:  [-7.88570335e-04  9.84520939e-01]
Stock Position:  -0.0007885703346310145
Bond Position:  [-3.60896253]


portfolio before change:  [-3.68569764]
curr_Stock_Price:  96.73703787193892
curr_Factors:  [9.67370379e+01 4.45401623e-02]
mat_Sqrt:  [[ 2.04159072e+01  0.00000000e+00]
 [-8.44181613e-03  1.93426307e-02]]
grads:  [ 1.23590287e-03 -5.59958904e+00]
Stock Position:  0.001235902867833047
Bond Position:  [-3.80525522]


portfolio before change:  [-3.6864084]
curr_Stock_Price:  96.5468353437625
curr_Factors:  [9.65468353e+01 4.43444092e-02]
mat_Sqrt:  [[ 2.03309410e+01  0.00000000e+00]
 [-8.42324490e-03  1.93000787e-02]]
grads:  [-0.00640871 -1.33460929]
Stock Position:  -0.006408712940517781
Bond Position:  [-3.06766745]


portfolio before change:  [-3.68870189]
curr_Stock_Price:  96.84486770857326
curr_Factors:  [9.68448677e+01 4.37539531e-02]
mat_Sqrt:  [[ 2.02574725e+01  0.00000000e+00]
 [-8.36697825e-03  1.91711556e-02]]
grads:  [-1.26370463e-03  1.11093934e+01]
Stock Position:  -0.001263704627253334
Bond Position:  [-3.56631858]


portfolio before change:  [-3.68840145]
curr_Stock_Price:  96.25434309735792
curr_Factors:  [9.62543431e+01 4.35367716e-02]
mat_Sqrt:  [[ 2.00839183e+01  0.00000000e+00]
 [-8.34618682e-03  1.91235164e-02]]
grads:  [ 0.0240082  13.55576493]
Stock Position:  0.024008204164636365
Bond Position:  [-5.99929538]


portfolio before change:  [-3.66508282]
curr_Stock_Price:  97.25685852855128
curr_Factors:  [9.72568585e+01 4.29677468e-02]
mat_Sqrt:  [[ 2.01600464e+01  0.00000000e+00]
 [-8.29146518e-03  1.89981334e-02]]
grads:  [0.00799268 3.66080796]
Stock Position:  0.00799268032443714
Bond Position:  [-4.4424258]


portfolio before change:  [-3.65421161]
curr_Stock_Price:  98.68648527917973
curr_Factors:  [9.86864853e+01 4.27649739e-02]
mat_Sqrt:  [[ 2.04080631e+01  0.00000000e+00]
 [-8.27187755e-03  1.89532525e-02]]
grads:  [4.32729677e-03 5.88987147e+00]
Stock Position:  0.004327296768620522
Bond Position:  [-4.08125732]


portfolio before change:  [-3.65371881]
curr_Stock_Price:  98.91826751186602
curr_Factors:  [9.89182675e+01 4.20497857e-02]
mat_Sqrt:  [[ 2.02842238e+01  0.00000000e+00]
 [-8.20241776e-03  1.87941001e-02]]
grads:  [1.37177673e-05 4.03460211e-01]
Stock Position:  1.3717767308602947e-05
Bond Position:  [-3.65507574]


portfolio before change:  [-3.65417946]
curr_Stock_Price:  98.64582482103219
curr_Factors:  [9.86458248e+01 4.12356020e-02]
mat_Sqrt:  [[ 2.00315649e+01  0.00000000e+00]
 [-8.12262047e-03  1.86112616e-02]]
grads:  [-0.00296333 -1.66243751]
Stock Position:  -0.002963334339613412
Bond Position:  [-3.3618589]


portfolio before change:  [-3.65525556]
curr_Stock_Price:  98.86714332230474
curr_Factors:  [9.88671433e+01 4.18832341e-02]
mat_Sqrt:  [[ 2.02335502e+01  0.00000000e+00]
 [-8.18615750e-03  1.87568432e-02]]
grads:  [-0.0064557  -0.16879225]
Stock Position:  -0.006455699952532169
Bond Position:  [-3.01699894]


portfolio before change:  [-3.64342025]
curr_Stock_Price:  96.9754108760939
curr_Factors:  [9.69754109e+01 4.18914531e-02]
mat_Sqrt:  [[ 1.98483469e+01  0.00000000e+00]
 [-8.18696067e-03  1.87586835e-02]]
grads:  [0.00732697 1.17563109]
Stock Position:  0.007326973838832713
Bond Position:  [-4.35395654]


portfolio before change:  [-3.64070996]
curr_Stock_Price:  97.41959980560604
curr_Factors:  [9.74195998e+01 4.18072282e-02]
mat_Sqrt:  [[ 1.99192063e+01  0.00000000e+00]
 [-8.17872638e-03  1.87398164e-02]]
grads:  [0.06245802 6.19127946]
Stock Position:  0.0624580235963673
Bond Position:  [-9.72534563]


portfolio before change:  [-3.68173186]
curr_Stock_Price:  96.78227326981133
curr_Factors:  [9.67822733e+01 4.29659418e-02]
mat_Sqrt:  [[ 2.00612498e+01  0.00000000e+00]
 [-8.29129103e-03  1.89977344e-02]]
grads:  [8.84667974e-03 1.94388660e+01]
Stock Position:  0.00884667974311255
Bond Position:  [-4.53793364]


portfolio before change:  [-3.68352911]
curr_Stock_Price:  96.64324171380281
curr_Factors:  [9.66432417e+01 4.25467334e-02]
mat_Sqrt:  [[ 1.99344657e+01  0.00000000e+00]
 [-8.25074381e-03  1.89048290e-02]]
grads:  [-4.23276359e-03  5.89123301e+00]
Stock Position:  -0.004232763588002639
Bond Position:  [-3.27446111]


portfolio before change:  [-3.68122568]
curr_Stock_Price:  96.00234515309486
curr_Factors:  [9.60023452e+01 4.32198808e-02]
mat_Sqrt:  [[ 1.99583036e+01  0.00000000e+00]
 [-8.31575669e-03  1.90537923e-02]]
grads:  [-5.65728215e-03  8.34140315e+00]
Stock Position:  -0.0056572821549695515
Bond Position:  [-3.13811332]


portfolio before change:  [-3.69067859]
curr_Stock_Price:  97.60393126756098
curr_Factors:  [9.76039313e+01 4.26508526e-02]
mat_Sqrt:  [[ 2.01572447e+01  0.00000000e+00]
 [-8.26083313e-03  1.89279466e-02]]
grads:  [ 4.12238520e-03 -5.48433827e+00]
Stock Position:  0.0041223851990349605
Bond Position:  [-4.09303959]


portfolio before change:  [-3.69175891]
curr_Stock_Price:  97.46598880188904
curr_Factors:  [9.74659888e+01 4.26885244e-02]
mat_Sqrt:  [[ 2.01376443e+01  0.00000000e+00]
 [-8.26448057e-03  1.89363039e-02]]
grads:  [-2.07315326e-02 -2.35008256e+01]
Stock Position:  -0.02073153260892427
Bond Position:  [-1.67113958]


portfolio before change:  [-3.71944367]
curr_Stock_Price:  98.79130598407555
curr_Factors:  [9.87913060e+01 4.17716962e-02]
mat_Sqrt:  [[ 2.01910908e+01  0.00000000e+00]
 [-8.17525008e-03  1.87318512e-02]]
grads:  [4.53978776e-03 5.35389639e+00]
Stock Position:  0.004539787761858051
Bond Position:  [-4.16793523]


portfolio before change:  [-3.72120728]
curr_Stock_Price:  98.5175957357281
curr_Factors:  [9.85175957e+01 4.27166994e-02]
mat_Sqrt:  [[ 2.03616350e+01  0.00000000e+00]
 [-8.26720745e-03  1.89425520e-02]]
grads:  [0.00867603 2.46804493]
Stock Position:  0.00867603263667212
Bond Position:  [-4.57594915]


portfolio before change:  [-3.73244148]
curr_Stock_Price:  97.28867263778527
curr_Factors:  [9.72886726e+01 4.27680986e-02]
mat_Sqrt:  [[ 2.01197347e+01  0.00000000e+00]
 [-8.27217974e-03  1.89539449e-02]]
grads:  [-0.03024363 -9.06735238]
Stock Position:  -0.030243632726589136
Bond Position:  [-0.7900786]


portfolio before change:  [-3.71748295]
curr_Stock_Price:  96.7908058730645
curr_Factors:  [9.67908059e+01 4.40985000e-02]
mat_Sqrt:  [[ 2.03257236e+01  0.00000000e+00]
 [-8.39985715e-03  1.92464906e-02]]
grads:  [-0.00464779 -1.41908745]
Stock Position:  -0.004647788329971421
Bond Position:  [-3.26761977]


portfolio before change:  [-3.71525101]
curr_Stock_Price:  96.22270359426263
curr_Factors:  [9.62227036e+01 4.58558677e-02]
mat_Sqrt:  [[ 2.06051136e+01  0.00000000e+00]
 [-8.56559328e-03  1.96262398e-02]]
grads:  [-1.64456201e-03  2.37670340e+00]
Stock Position:  -0.001644562011882865
Bond Position:  [-3.55700681]


portfolio before change:  [-3.71361272]
curr_Stock_Price:  94.95614078661191
curr_Factors:  [9.49561408e+01 4.67341443e-02]
mat_Sqrt:  [[ 2.05276958e+01  0.00000000e+00]
 [-8.64723255e-03  1.98132989e-02]]
grads:  [ 0.0203671  10.84341111]
Stock Position:  0.02036709816765494
Bond Position:  [-5.64759376]


portfolio before change:  [-3.67400843]
curr_Stock_Price:  96.93532729773747
curr_Factors:  [9.69353273e+01 4.46079847e-02]
mat_Sqrt:  [[ 2.04733251e+01  0.00000000e+00]
 [-8.44824097e-03  1.93573519e-02]]
grads:  [0.00071408 0.03578354]
Stock Position:  0.0007140831116273649
Bond Position:  [-3.74322831]


portfolio before change:  [-3.67512299]
curr_Stock_Price:  96.02979371015239
curr_Factors:  [9.60297937e+01 4.50915841e-02]
mat_Sqrt:  [[ 2.03917145e+01  0.00000000e+00]
 [-8.49391162e-03  1.94619965e-02]]
grads:  [ 0.00626639 -5.84181292]
Stock Position:  0.006266394455172901
Bond Position:  [-4.27688356]


portfolio before change:  [-3.67580281]
curr_Stock_Price:  96.0066258628607
curr_Factors:  [9.60066259e+01 4.40584548e-02]
mat_Sqrt:  [[ 2.01518925e+01  0.00000000e+00]
 [-8.39604238e-03  1.92377499e-02]]
grads:  [4.31594186e-03 5.97695242e+00]
Stock Position:  0.004315941861432012
Bond Position:  [-4.09016183]


portfolio before change:  [-3.67388935]
curr_Stock_Price:  96.5684422932592
curr_Factors:  [9.65684423e+01 4.37293382e-02]
mat_Sqrt:  [[ 2.01939687e+01  0.00000000e+00]
 [-8.36462438e-03  1.91657622e-02]]
grads:  [-0.00212243  0.39333893]
Stock Position:  -0.00212243463594599
Bond Position:  [-3.46892914]


portfolio before change:  [-3.67045407]
curr_Stock_Price:  94.74557248894205
curr_Factors:  [9.47455725e+01 4.38203091e-02]
mat_Sqrt:  [[ 1.98333759e+01  0.00000000e+00]
 [-8.37332040e-03  1.91856873e-02]]
grads:  [-0.0195402  -6.37220788]
Stock Position:  -0.019540196760391173
Bond Position:  [-1.81910694]


portfolio before change:  [-3.65673507]
curr_Stock_Price:  94.03184394286743
curr_Factors:  [9.40318439e+01 4.45420993e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.65673507]
Stock Price:  93.59738361611788
PL:  [-3.65673507]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.03073888e+00  2.61930624e-01]
 [ 3.73093430e-01  1.16110634e-01]
 [-1.29006060e-01 -9.06381424e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.84922351e-02  4.22736187e-01]
 [-7.25624901e-02 -1.21789558e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.92319477e-01  8.92343864e-01]
 [-2.29943060e-02  2.70952495e-01]
 [ 1.83583579e-01  5.46754083e-02]
 [-1.15219717e-01  3.02250875e-04]
 [ 2.56131094e-02 -1.33700473e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-8.87598492e-02  1.07608840e-01]
 [ 4.86725472e-01  3.17290297e-01]
 [ 1.30969667e-01  5.80134752e-02]
 [ 4.00695933e-02  1.26867380e-01]
 [ 4.42148606e-02  7.07306336e-02]
 [ 9.53922935e-02  1.02678580e-01]
 [-5.04747942e-01  2.18107826e-01]
 [ 1.33216268e-01  2.62762206e-02]
 [ 1.33333209e+00  1.41679388e-01]
 [ 1.62051323e-02  3.82585041e-01]
 [-1.32497382e-01  1.09454598e-01]
 [-2.02575757e-01  1.32233910e-01]
 [ 2.09324624e-01 -7.49570038e-02]
 [ 1.11966278e-01 -4.51362229e-01]
 [ 1.28858509e-01 -7.20641263e-02]
 [ 7.54614775e-01 -3.21171777e-01]
 [-7.42930147e-01 -3.47366272e-01]
 [ 5.92012394e-01  2.21483195e-01]
 [-2.32788796e-01  3.52371487e-01]
 [ 7.39621996e-01  2.01468247e-01]
 [ 5.25824651e-02 -7.43935698e-02]
 [ 2.81296737e-01 -3.40249736e-01]
 [ 1.38195241e-01  1.52697029e-02]
 [-7.17537635e-02  4.26476216e-01]
 [-3.75372212e-01 -1.40721323e-01]
 [ 5.11536071e-02  3.83308727e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.88283434]
curr_Stock_Price:  101.33561323997924
curr_Factors:  [1.01335613e+02 3.90855331e-02]
mat_Sqrt:  [[ 2.00341131e+01  0.00000000e+00]
 [-7.90802460e-03  1.81195607e-02]]
grads:  [ 0.05715525 14.45568293]
Stock Position:  0.05715525161461545
Bond Position:  [6.09097187]


portfolio before change:  [11.81497216]
curr_Stock_Price:  100.13496068616621
curr_Factors:  [1.00134961e+02 3.87941842e-02]
mat_Sqrt:  [[ 1.97228215e+01  0.00000000e+00]
 [-7.87849571e-03  1.80519015e-02]]
grads:  [0.02148619 6.43204452]
Stock Position:  0.021486188779692165
Bond Position:  [9.66345349]


portfolio before change:  [11.84419092]
curr_Stock_Price:  101.43862376324464
curr_Factors:  [1.01438624e+02 3.89855065e-02]
mat_Sqrt:  [[ 2.00288004e+01  0.00000000e+00]
 [-7.89789911e-03  1.80963603e-02]]
grads:  [-0.00841607 -5.00863937]
Stock Position:  -0.008416070116120222
Bond Position:  [12.69790549]


portfolio before change:  [11.860318]
curr_Stock_Price:  99.71100754055635
curr_Factors:  [9.97110075e+01 4.05741698e-02]
mat_Sqrt:  [[ 2.00848192e+01  0.00000000e+00]
 [-8.05721240e-03  1.84613929e-02]]
grads:  [-8.11626275e-04 -8.20018368e+00]
Stock Position:  -0.0008116262749250015
Bond Position:  [11.94124607]


portfolio before change:  [11.86288943]
curr_Stock_Price:  98.38196226560136
curr_Factors:  [9.83819623e+01 4.15776869e-02]
mat_Sqrt:  [[ 2.00606797e+01  0.00000000e+00]
 [-8.15624295e-03  1.86883004e-02]]
grads:  [4.78572832e-03 2.26203656e+01]
Stock Position:  0.00478572831586281
Bond Position:  [11.39206009]


portfolio before change:  [11.86661936]
curr_Stock_Price:  98.86377624588289
curr_Factors:  [9.88637762e+01 4.11058917e-02]
mat_Sqrt:  [[ 2.00442233e+01  0.00000000e+00]
 [-8.10983519e-03  1.85819668e-02]]
grads:  [-6.27192228e-03 -6.55418012e+00]
Stock Position:  -0.006271922284145191
Bond Position:  [12.48668528]


portfolio before change:  [11.88106591]
curr_Stock_Price:  96.80928414293591
curr_Factors:  [9.68092841e+01 4.13716435e-02]
mat_Sqrt:  [[ 1.96910283e+01  0.00000000e+00]
 [-8.13600821e-03  1.86419367e-02]]
grads:  [0.00657019 5.1570225 ]
Stock Position:  0.006570188997696467
Bond Position:  [11.24501061]


portfolio before change:  [11.88710346]
curr_Stock_Price:  97.51426247119461
curr_Factors:  [9.75142625e+01 3.96106017e-02]
mat_Sqrt:  [[ 1.94076906e+01  0.00000000e+00]
 [-7.96096494e-03  1.82408622e-02]]
grads:  [ 0.06604445 48.92004852]
Stock Position:  0.06604445080599938
Bond Position:  [5.44682755]


portfolio before change:  [11.95870263]
curr_Stock_Price:  98.58805847709466
curr_Factors:  [9.85880585e+01 3.89360250e-02]
mat_Sqrt:  [[ 1.94536062e+01  0.00000000e+00]
 [-7.89288541e-03  1.80848724e-02]]
grads:  [4.89673002e-03 1.49822730e+01]
Stock Position:  0.004896730024193654
Bond Position:  [11.47594352]


portfolio before change:  [11.96261388]
curr_Stock_Price:  99.09383930947193
curr_Factors:  [9.90938393e+01 3.98333405e-02]
mat_Sqrt:  [[ 1.97774374e+01  0.00000000e+00]
 [-7.98331665e-03  1.82920764e-02]]
grads:  [0.01048902 2.98902142]
Stock Position:  0.010489017315916253
Bond Position:  [10.92321689]


portfolio before change:  [11.96609511]
curr_Stock_Price:  99.29554957325242
curr_Factors:  [9.92955496e+01 3.91082055e-02]
mat_Sqrt:  [[ 1.96364840e+01  0.00000000e+00]
 [-7.91031787e-03  1.81248152e-02]]
grads:  [-0.00586092  0.01667608]
Stock Position:  -0.0058609170306813075
Bond Position:  [12.54805809]


portfolio before change:  [11.96978978]
curr_Stock_Price:  98.9327969937007
curr_Factors:  [9.89327970e+01 3.79659024e-02]
mat_Sqrt:  [[ 1.92768981e+01  0.00000000e+00]
 [-7.79393636e-03  1.78581517e-02]]
grads:  [-1.69833138e-03 -7.48680353e+00]
Stock Position:  -0.001698331375681317
Bond Position:  [12.13781045]


portfolio before change:  [11.97076541]
curr_Stock_Price:  99.25175107309121
curr_Factors:  [9.92517511e+01 3.67452043e-02]
mat_Sqrt:  [[ 1.90256065e+01  0.00000000e+00]
 [-7.66761547e-03  1.75687141e-02]]
grads:  [-0.00679867 -1.59666808]
Stock Position:  -0.006798673562528897
Bond Position:  [12.64554567]


portfolio before change:  [11.98098477]
curr_Stock_Price:  97.9811254971891
curr_Factors:  [9.79811255e+01 3.71165224e-02]
mat_Sqrt:  [[ 1.88766995e+01  0.00000000e+00]
 [-7.70625952e-03  1.76572588e-02]]
grads:  [-2.21413181e-03  6.09431179e+00]
Stock Position:  -0.0022141318126659565
Bond Position:  [12.1979279]


portfolio before change:  [11.98286407]
curr_Stock_Price:  97.82103406794177
curr_Factors:  [9.78210341e+01 3.74299908e-02]
mat_Sqrt:  [[ 1.89252711e+01  0.00000000e+00]
 [-7.73873280e-03  1.77316644e-02]]
grads:  [ 0.03303532 17.89399403]
Stock Position:  0.033035315928467056
Bond Position:  [8.75131531]


portfolio before change:  [11.9605886]
curr_Stock_Price:  97.11362587637129
curr_Factors:  [9.71136259e+01 3.72115163e-02]
mat_Sqrt:  [[ 1.87334969e+01  0.00000000e+00]
 [-7.71611470e-03  1.76798398e-02]]
grads:  [0.00834275 3.28133488]
Stock Position:  0.008342746885437407
Bond Position:  [11.1503942]


portfolio before change:  [11.96567066]
curr_Stock_Price:  97.55570680170749
curr_Factors:  [9.75557068e+01 3.63183270e-02]
mat_Sqrt:  [[ 1.85915499e+01  0.00000000e+00]
 [-7.62294715e-03  1.74663662e-02]]
grads:  [5.13346428e-03 7.26352460e+00]
Stock Position:  0.005133464282414494
Bond Position:  [11.46487192]


portfolio before change:  [11.96830587]
curr_Stock_Price:  97.78985883134455
curr_Factors:  [9.77898588e+01 3.83350186e-02]
mat_Sqrt:  [[ 1.91465997e+01  0.00000000e+00]
 [-7.83173223e-03  1.79447529e-02]]
grads:  [3.92154434e-03 3.94157746e+00]
Stock Position:  0.003921544344491605
Bond Position:  [11.5848186]


portfolio before change:  [11.96108848]
curr_Stock_Price:  95.58012353718739
curr_Factors:  [9.55801235e+01 4.04012412e-02]
mat_Sqrt:  [[ 1.92116622e+01  0.00000000e+00]
 [-8.04002400e-03  1.84220093e-02]]
grads:  [0.00729791 5.57369057]
Stock Position:  0.007297905724245273
Bond Position:  [11.26355375]


portfolio before change:  [11.96010671]
curr_Stock_Price:  95.25265922026973
curr_Factors:  [9.52526592e+01 3.99986210e-02]
mat_Sqrt:  [[ 1.90502035e+01  0.00000000e+00]
 [-7.99986210e-03  1.83299868e-02]]
grads:  [-0.02149887 11.89896253]
Stock Position:  -0.02149887182627515
Bond Position:  [14.00793142]


portfolio before change:  [11.92741924]
curr_Stock_Price:  96.85453743448583
curr_Factors:  [9.68545374e+01 3.90598900e-02]
mat_Sqrt:  [[ 1.91419192e+01  0.00000000e+00]
 [-7.90543003e-03  1.81136158e-02]]
grads:  [0.0075585  1.45063365]
Stock Position:  0.007558497613833043
Bond Position:  [11.19534445]


portfolio before change:  [11.92549969]
curr_Stock_Price:  96.41542217194464
curr_Factors:  [9.64154222e+01 4.00242485e-02]
mat_Sqrt:  [[ 1.92889284e+01  0.00000000e+00]
 [-8.00242448e-03  1.83358580e-02]]
grads:  [0.07232989 7.72690256]
Stock Position:  0.07232988875636916
Bond Position:  [4.95178293]


portfolio before change:  [11.93144662]
curr_Stock_Price:  96.48908350431257
curr_Factors:  [9.64890835e+01 3.91216250e-02]
mat_Sqrt:  [[ 1.90847565e+01  0.00000000e+00]
 [-7.91167492e-03  1.81279246e-02]]
grads:  [9.59818025e-03 2.11047348e+01]
Stock Position:  0.009598180247060406
Bond Position:  [11.00532701]


portfolio before change:  [11.9350525]
curr_Stock_Price:  96.72143228282893
curr_Factors:  [9.67214323e+01 3.93851143e-02]
mat_Sqrt:  [[ 1.91950291e+01  0.00000000e+00]
 [-7.93827330e-03  1.81888691e-02]]
grads:  [-4.41403235e-03  6.01766924e+00]
Stock Position:  -0.004414032349178089
Bond Position:  [12.36198403]


portfolio before change:  [11.9433993]
curr_Stock_Price:  95.1805609182656
curr_Factors:  [9.51805609e+01 3.89528443e-02]
mat_Sqrt:  [[ 1.87852875e+01  0.00000000e+00]
 [-7.89458997e-03  1.80887781e-02]]
grads:  [-0.00771157  7.31027324]
Stock Position:  -0.007711574673904317
Bond Position:  [12.6773913]


portfolio before change:  [11.94656536]
curr_Stock_Price:  94.97550660115405
curr_Factors:  [9.49755066e+01 3.99718848e-02]
mat_Sqrt:  [[ 1.89884245e+01  0.00000000e+00]
 [-7.99718799e-03  1.83238597e-02]]
grads:  [ 0.00930097 -4.09067769]
Stock Position:  0.00930096678195012
Bond Position:  [11.06320133]


portfolio before change:  [11.93759497]
curr_Stock_Price:  93.8623553070425
curr_Factors:  [9.38623553e+01 4.03490820e-02]
mat_Sqrt:  [[ 1.88542073e+01  0.00000000e+00]
 [-8.03483237e-03  1.84101138e-02]]
grads:  [-4.50956900e-03 -2.45170798e+01]
Stock Position:  -0.004509568999040291
Bond Position:  [12.36087373]


portfolio before change:  [11.95030024]
curr_Stock_Price:  91.38760292381458
curr_Factors:  [9.13876029e+01 4.33096093e-02]
mat_Sqrt:  [[ 1.90186383e+01  0.00000000e+00]
 [-8.32438436e-03  1.90735607e-02]]
grads:  [ 0.00512167 -3.77822093]
Stock Position:  0.005121667699781566
Bond Position:  [11.4822433]


portfolio before change:  [11.94985661]
curr_Stock_Price:  91.0207306563848
curr_Factors:  [9.10207307e+01 4.33129136e-02]
mat_Sqrt:  [[ 1.89430112e+01  0.00000000e+00]
 [-8.32470190e-03  1.90742883e-02]]
grads:  [  0.03243644 -16.83794287]
Stock Position:  0.03243644384078139
Bond Position:  [8.99746779]


portfolio before change:  [11.94155454]
curr_Stock_Price:  90.73010606956268
curr_Factors:  [9.07301061e+01 4.20773168e-02]
mat_Sqrt:  [[ 1.86112455e+01  0.00000000e+00]
 [-8.20510249e-03  1.88002516e-02]]
grads:  [ -0.04806412 -18.4766821 ]
Stock Position:  -0.048064124397875836
Bond Position:  [16.30241764]


portfolio before change:  [11.95763676]
curr_Stock_Price:  90.43790702317945
curr_Factors:  [9.04379070e+01 4.24285659e-02]
mat_Sqrt:  [[ 1.86285769e+01  0.00000000e+00]
 [-8.23927821e-03  1.88785580e-02]]
grads:  [ 0.03696877 11.73199747]
Stock Position:  0.03696877050069487
Bond Position:  [8.61425853]


portfolio before change:  [11.9606888]
curr_Stock_Price:  90.49133562832675
curr_Factors:  [9.04913356e+01 4.29975626e-02]
mat_Sqrt:  [[ 1.87641509e+01  0.00000000e+00]
 [-8.29434145e-03  1.90047238e-02]]
grads:  [-4.21022361e-03  1.85412580e+01]
Stock Position:  -0.004210223607468658
Bond Position:  [12.34167755]


portfolio before change:  [11.96080163]
curr_Stock_Price:  90.83097856728784
curr_Factors:  [9.08309786e+01 4.30960614e-02]
mat_Sqrt:  [[ 1.88561396e+01  0.00000000e+00]
 [-8.30383636e-03  1.90264793e-02]]
grads:  [ 0.04388756 10.58883485]
Stock Position:  0.04388755955518332
Bond Position:  [7.97445165]


portfolio before change:  [12.04160933]
curr_Stock_Price:  92.64950824190554
curr_Factors:  [9.26495082e+01 4.18198789e-02]
mat_Sqrt:  [[ 1.89467404e+01  0.00000000e+00]
 [-8.17996371e-03  1.87426514e-02]]
grads:  [ 1.06163113e-03 -3.96921268e+00]
Stock Position:  0.001061631129716444
Bond Position:  [11.94324973]


portfolio before change:  [12.0420129]
curr_Stock_Price:  91.62332694782432
curr_Factors:  [9.16233269e+01 4.22740689e-02]
mat_Sqrt:  [[ 1.88383596e+01  0.00000000e+00]
 [-8.22426351e-03  1.88441550e-02]]
grads:  [ 7.04942365e-03 -1.80559826e+01]
Stock Position:  0.007049423650565268
Bond Position:  [11.39612125]


portfolio before change:  [12.03391112]
curr_Stock_Price:  90.27195571491428
curr_Factors:  [9.02719557e+01 4.45867909e-02]
mat_Sqrt:  [[ 1.90614511e+01  0.00000000e+00]
 [-8.44623380e-03  1.93527529e-02]]
grads:  [0.0075996  0.78901968]
Stock Position:  0.007599604319014986
Bond Position:  [11.34787997]


portfolio before change:  [12.04692712]
curr_Stock_Price:  91.79801220377865
curr_Factors:  [9.17980122e+01 4.50617742e-02]
mat_Sqrt:  [[ 1.94866606e+01  0.00000000e+00]
 [-8.49110351e-03  1.94555623e-02]]
grads:  [5.86943649e-03 2.19205289e+01]
Stock Position:  0.00586943648939864
Bond Position:  [11.50812451]


portfolio before change:  [12.04854859]
curr_Stock_Price:  91.82916814549041
curr_Factors:  [9.18291681e+01 4.35943468e-02]
mat_Sqrt:  [[ 1.91732501e+01  0.00000000e+00]
 [-8.35170371e-03  1.91361572e-02]]
grads:  [-0.02278112 -7.35368765]
Stock Position:  -0.022781115876269725
Bond Position:  [14.14051951]


portfolio before change:  [12.02417938]
curr_Stock_Price:  92.97647322468175
curr_Factors:  [9.29764732e+01 4.44781031e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.02417938]
Stock Price:  91.65631284647894
PL:  [12.02417938]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.38393735e+00  3.41781722e-01]
 [ 1.01372990e+00  7.59125528e-02]
 [ 9.64179809e-02 -3.23342242e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.17809675e-02  1.65600295e-01]
 [-2.60402393e-01  7.93856691e-02]
 [ 8.77760083e-02  9.55874810e-02]
 [ 9.40509037e-01  9.45652698e-01]
 [-1.76066972e-03  3.27708272e-01]
 [ 1.91682836e-01  1.03489139e-01]
 [-1.88753250e-02  2.01766000e-02]
 [ 6.51369377e-02 -9.94938019e-02]
 [-1.02692864e-01  3.78059069e-02]
 [-1.26387453e-01  2.40516937e-01]
 [ 4.14231440e-01  2.79202335e-01]
 [ 1.32907956e-01 -7.25615255e-02]
 [ 4.09505810e-02  1.22250046e-01]
 [ 2.11694819e-01  7.27710135e-02]
 [ 8.92488142e-02  9.64277947e-02]
 [-5.33459547e-01  2.34426505e-01]
 [ 5.74502825e-02  1.27703905e-01]
 [ 1.72075960e+00  2.26571304e-01]
 [ 1.42932468e-02  4.02625068e-01]
 [-1.58311426e-01  2.11013535e-01]
 [-1.92039888e-01  1.16365197e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 2.82804972e-01 -4.35573299e-01]
 [ 1.26888529e-01 -6.78705568e-02]
 [ 6.96681770e-01 -3.16581063e-01]
 [-5.72892485e-01 -3.06646499e-01]
 [ 5.65313394e-01  2.11674716e-01]
 [-1.74793317e-01  2.53094163e-01]
 [ 6.86001413e-01  2.22448712e-01]
 [ 5.53069021e-02 -8.68386284e-02]
 [ 3.07441671e-01 -4.05039377e-01]
 [ 1.39591804e-01  1.35077574e-02]
 [-7.92175403e-02  5.45980560e-01]
 [-3.98732233e-01 -1.46262118e-01]
 [-3.31079563e-01  8.27490095e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.9681661]
curr_Stock_Price:  99.75129495167266
curr_Factors:  [9.97512950e+01 3.95915945e-02]
mat_Sqrt:  [[ 1.98481503e+01  0.00000000e+00]
 [-7.95905467e-03  1.82364852e-02]]
grads:  [ 0.07724161 18.74164439]
Stock Position:  0.07724161205594612
Bond Position:  [-6.73678473]


portfolio before change:  [0.87538798]
curr_Stock_Price:  98.56105610792284
curr_Factors:  [9.85610561e+01 4.19992979e-02]
mat_Sqrt:  [[ 2.0198837e+01  0.0000000e+00]
 [-8.1974921e-03  1.8782814e-02]]
grads:  [0.05182778 4.04159636]
Stock Position:  0.0518277789295838
Bond Position:  [-4.23281265]


portfolio before change:  [0.8842328]
curr_Stock_Price:  98.74192343704938
curr_Factors:  [9.87419234e+01 4.18989819e-02]
mat_Sqrt:  [[ 2.02117221e+01  0.00000000e+00]
 [-8.18769632e-03  1.87603691e-02]]
grads:  [ 0.0040722  -1.72353881]
Stock Position:  0.004072199696844454
Bond Position:  [0.48213597]


portfolio before change:  [0.88393485]
curr_Stock_Price:  98.65395533316777
curr_Factors:  [9.86539553e+01 4.23161824e-02]
mat_Sqrt:  [[ 2.0294004e+01  0.0000000e+00]
 [-8.2283590e-03  1.8853539e-02]]
grads:  [-8.03260261e-04 -8.02962312e+00]
Stock Position:  -0.0008032602605683489
Bond Position:  [0.96317965]


portfolio before change:  [0.88314701]
curr_Stock_Price:  99.78465070432773
curr_Factors:  [9.97846507e+01 4.01931011e-02]
mat_Sqrt:  [[ 2.00050435e+01  0.00000000e+00]
 [-8.01928686e-03  1.83744945e-02]]
grads:  [-4.75233845e-04  9.01250885e+00]
Stock Position:  -0.00047523384458231406
Bond Position:  [0.93056805]


portfolio before change:  [0.88274184]
curr_Stock_Price:  100.88199870232047
curr_Factors:  [1.00881999e+02 3.78462220e-02]
mat_Sqrt:  [[ 1.96256904e+01  0.00000000e+00]
 [-7.78164219e-03  1.78299822e-02]]
grads:  [-0.01150307  4.45236951]
Stock Position:  -0.011503067732128587
Bond Position:  [2.0431943]


portfolio before change:  [0.89953352]
curr_Stock_Price:  99.44444635080279
curr_Factors:  [9.94444464e+01 3.86484291e-02]
mat_Sqrt:  [[ 1.95499863e+01  0.00000000e+00]
 [-7.86368149e-03  1.80179578e-02]]
grads:  [0.00662373 5.30512292]
Stock Position:  0.006623728696436639
Bond Position:  [0.24084048]


portfolio before change:  [0.88450759]
curr_Stock_Price:  97.17140118950451
curr_Factors:  [9.71714012e+01 3.94894076e-02]
mat_Sqrt:  [[ 1.93098444e+01  0.00000000e+00]
 [-7.94877677e-03  1.82129356e-02]]
grads:  [ 0.07007958 51.92203596]
Stock Position:  0.07007957607119662
Bond Position:  [-5.92522301]


portfolio before change:  [0.94014173]
curr_Stock_Price:  97.97584160463201
curr_Factors:  [9.79758416e+01 3.83069160e-02]
mat_Sqrt:  [[ 1.91759813e+01  0.00000000e+00]
 [-7.82886107e-03  1.79381742e-02]]
grads:  [7.36666059e-03 1.82687640e+01]
Stock Position:  0.007366660593715105
Bond Position:  [0.21838696]


portfolio before change:  [0.9306698]
curr_Stock_Price:  96.68635151248093
curr_Factors:  [9.66863515e+01 3.85120908e-02]
mat_Sqrt:  [[ 1.89742108e+01  0.00000000e+00]
 [-7.84979906e-03  1.79861492e-02]]
grads:  [0.01248269 5.75382411]
Stock Position:  0.012482690421063852
Bond Position:  [-0.276236]


portfolio before change:  [0.92171881]
curr_Stock_Price:  95.97204575757257
curr_Factors:  [9.59720458e+01 3.94137396e-02]
mat_Sqrt:  [[ 1.90532284e+01  0.00000000e+00]
 [-7.94115756e-03  1.81954778e-02]]
grads:  [-5.28494940e-04  1.10887992e+00]
Stock Position:  -0.000528494939677242
Bond Position:  [0.97243955]


portfolio before change:  [0.9219106]
curr_Stock_Price:  95.83915406112156
curr_Factors:  [9.58391541e+01 4.07021741e-02]
mat_Sqrt:  [[ 1.93353383e+01  0.00000000e+00]
 [-8.06991193e-03  1.84904911e-02]]
grads:  [ 1.12303608e-03 -5.38080904e+00]
Stock Position:  0.001123036080305994
Bond Position:  [0.81427978]


portfolio before change:  [0.92169696]
curr_Stock_Price:  95.55827869699957
curr_Factors:  [9.55582787e+01 4.10191406e-02]
mat_Sqrt:  [[ 1.93535927e+01  0.00000000e+00]
 [-8.10127305e-03  1.85623485e-02]]
grads:  [-0.00445359  2.03669848]
Stock Position:  -0.004453592413286203
Bond Position:  [1.34727459]


portfolio before change:  [0.91745333]
curr_Stock_Price:  96.54895079684586
curr_Factors:  [9.65489508e+01 4.12105484e-02]
mat_Sqrt:  [[ 1.95998052e+01  0.00000000e+00]
 [-8.12015255e-03  1.86056069e-02]]
grads:  [-1.09272798e-03  1.29271213e+01]
Stock Position:  -0.00109272797581365
Bond Position:  [1.02295507]


portfolio before change:  [0.91738589]
curr_Stock_Price:  96.72769754551697
curr_Factors:  [9.67276975e+01 4.11100352e-02]
mat_Sqrt:  [[ 1.96121305e+01  0.00000000e+00]
 [-8.11024392e-03  1.85829033e-02]]
grads:  [ 0.02733437 15.02468858]
Stock Position:  0.0273343749768282
Bond Position:  [-1.72660527]


portfolio before change:  [0.88233563]
curr_Stock_Price:  95.45331604085311
curr_Factors:  [9.54533160e+01 4.11603224e-02]
mat_Sqrt:  [[ 1.93655753e+01  0.00000000e+00]
 [-8.11520276e-03  1.85942655e-02]]
grads:  [ 0.00522781 -3.90236042]
Stock Position:  0.005227808011121601
Bond Position:  [0.38332402]


portfolio before change:  [0.88724062]
curr_Stock_Price:  96.38240028097093
curr_Factors:  [9.63824003e+01 4.08819345e-02]
mat_Sqrt:  [[ 1.94878289e+01  0.00000000e+00]
 [-8.08771261e-03  1.85312776e-02]]
grads:  [4.83916786e-03 6.59695721e+00]
Stock Position:  0.004839167858151482
Bond Position:  [0.42083001]


portfolio before change:  [0.88282678]
curr_Stock_Price:  95.45942114240003
curr_Factors:  [9.54594211e+01 4.26147571e-02]
mat_Sqrt:  [[ 1.97060148e+01  0.00000000e+00]
 [-8.25733682e-03  1.89199355e-02]]
grads:  [0.01235433 3.84626118]
Stock Position:  0.012354334191935825
Bond Position:  [-0.29651082]


portfolio before change:  [0.88496456]
curr_Stock_Price:  95.63546078368873
curr_Factors:  [9.56354608e+01 4.36006231e-02]
mat_Sqrt:  [[ 1.99694132e+01  0.00000000e+00]
 [-8.35230489e-03  1.91375347e-02]]
grads:  [0.00657673 5.03867381]
Stock Position:  0.006576725768715866
Bond Position:  [0.25599636]


portfolio before change:  [0.88055384]
curr_Stock_Price:  94.95993850256775
curr_Factors:  [9.49599385e+01 4.46822731e-02]
mat_Sqrt:  [[ 2.00728045e+01  0.00000000e+00]
 [-8.45527273e-03  1.93734637e-02]]
grads:  [-0.02147918 12.10039203]
Stock Position:  -0.021479182579934326
Bond Position:  [2.9202157]


portfolio before change:  [0.8950899]
curr_Stock_Price:  94.30018266101938
curr_Factors:  [9.43001827e+01 4.48553942e-02]
mat_Sqrt:  [[ 1.99719225e+01  0.00000000e+00]
 [-8.47163684e-03  1.94109585e-02]]
grads:  [5.66719782e-03 6.57895923e+00]
Stock Position:  0.005667197820542356
Bond Position:  [0.36067211]


portfolio before change:  [0.89011748]
curr_Stock_Price:  93.41482269869269
curr_Factors:  [9.34148227e+01 4.69190846e-02]
mat_Sqrt:  [[ 2.02344106e+01  0.00000000e+00]
 [-8.66432544e-03  1.98524636e-02]]
grads:  [ 0.08992817 11.41275505]
Stock Position:  0.08992816529495942
Bond Position:  [-7.51050614]


portfolio before change:  [0.80362211]
curr_Stock_Price:  92.46343553719983
curr_Factors:  [9.24634355e+01 4.60895223e-02]
mat_Sqrt:  [[ 1.98504853e+01  0.00000000e+00]
 [-8.58738818e-03  1.96761782e-02]]
grads:  [9.57222099e-03 2.04625646e+01]
Stock Position:  0.009572220993202265
Bond Position:  [-0.08145833]


portfolio before change:  [0.80376088]
curr_Stock_Price:  92.4789964282251
curr_Factors:  [9.24789964e+01 4.57057923e-02]
mat_Sqrt:  [[ 1.97710042e+01  0.00000000e+00]
 [-8.55156521e-03  1.95940975e-02]]
grads:  [-3.34922638e-03  1.07692398e+01]
Stock Position:  -0.003349226382428178
Bond Position:  [1.11349397]


portfolio before change:  [0.79750386]
curr_Stock_Price:  94.38875489637553
curr_Factors:  [9.43887549e+01 4.51236967e-02]
mat_Sqrt:  [[ 2.00503793e+01  0.00000000e+00]
 [-8.49693561e-03  1.94689253e-02]]
grads:  [-0.00704495  5.97697074]
Stock Position:  -0.007044951635368151
Bond Position:  [1.46246807]


portfolio before change:  [0.80356133]
curr_Stock_Price:  93.55487380013761
curr_Factors:  [9.35548738e+01 4.44351495e-02]
mat_Sqrt:  [[ 1.97210366e+01  0.00000000e+00]
 [-8.43185859e-03  1.93198151e-02]]
grads:  [ 0.0093037  -3.77827307]
Stock Position:  0.009303699698452022
Bond Position:  [-0.06684512]


portfolio before change:  [0.79255993]
curr_Stock_Price:  92.37329566633186
curr_Factors:  [9.23732957e+01 4.43699721e-02]
mat_Sqrt:  [[ 1.94576782e+01  0.00000000e+00]
 [-8.42567240e-03  1.93056408e-02]]
grads:  [ 4.76445330e-03 -2.25619706e+01]
Stock Position:  0.004764453300087226
Bond Position:  [0.35245167]


portfolio before change:  [0.78874474]
curr_Stock_Price:  91.56328702311501
curr_Factors:  [9.1563287e+01 4.4640279e-02]
mat_Sqrt:  [[ 1.93457168e+01  0.00000000e+00]
 [-8.45129851e-03  1.93643576e-02]]
grads:  [ 0.00502785 -3.50492169]
Stock Position:  0.005027851400482935
Bond Position:  [0.32837814]


portfolio before change:  [0.79000803]
curr_Stock_Price:  91.80638229604287
curr_Factors:  [9.18063823e+01 4.50096860e-02]
mat_Sqrt:  [[ 1.94771705e+01  0.00000000e+00]
 [-8.48619453e-03  1.94443144e-02]]
grads:  [  0.02867534 -16.28142072]
Stock Position:  0.028675338996203854
Bond Position:  [-1.8425711]


portfolio before change:  [0.82749485]
curr_Stock_Price:  93.1216989491102
curr_Factors:  [9.31216989e+01 4.45438823e-02]
mat_Sqrt:  [[ 1.96537272e+01  0.00000000e+00]
 [-8.44216866e-03  1.93434385e-02]]
grads:  [ -0.03595878 -15.85273994]
Stock Position:  -0.03595877676538068
Bond Position:  [4.17603723]


portfolio before change:  [0.91840441]
curr_Stock_Price:  90.60805618349613
curr_Factors:  [9.06080562e+01 4.51021985e-02]
mat_Sqrt:  [[ 1.92426849e+01  0.00000000e+00]
 [-8.49491127e-03  1.94642870e-02]]
grads:  [ 0.034179   10.87503058]
Stock Position:  0.034179004402717
Bond Position:  [-2.17848875]


portfolio before change:  [0.97770638]
curr_Stock_Price:  92.35106499061354
curr_Factors:  [9.23510650e+01 4.58713258e-02]
mat_Sqrt:  [[ 1.97793745e+01  0.00000000e+00]
 [-8.56703690e-03  1.96295475e-02]]
grads:  [-3.25257852e-03  1.28935301e+01]
Stock Position:  -0.0032525785164748164
Bond Position:  [1.27808547]


portfolio before change:  [0.98097292]
curr_Stock_Price:  91.39589598627443
curr_Factors:  [9.13958960e+01 4.58291681e-02]
mat_Sqrt:  [[ 1.95658032e+01  0.00000000e+00]
 [-8.56309926e-03  1.96205253e-02]]
grads:  [ 0.0400232 11.3375513]
Stock Position:  0.04002319662591706
Bond Position:  [-2.676983]


portfolio before change:  [1.01252787]
curr_Stock_Price:  92.19267395132366
curr_Factors:  [9.2192674e+01 4.5255515e-02]
mat_Sqrt:  [[ 1.96124644e+01  0.00000000e+00]
 [-8.50933746e-03  1.94973415e-02]]
grads:  [ 8.87569108e-04 -4.45387020e+00]
Stock Position:  0.0008875691080519822
Bond Position:  [0.9307005]


portfolio before change:  [1.01133513]
curr_Stock_Price:  90.71775957593995
curr_Factors:  [9.07177596e+01 4.71591312e-02]
mat_Sqrt:  [[ 1.97004077e+01  0.00000000e+00]
 [-8.68646130e-03  1.99031832e-02]]
grads:  [ 6.63275584e-03 -2.03504823e+01]
Stock Position:  0.006632755835063408
Bond Position:  [0.40962638]


portfolio before change:  [1.00778139]
curr_Stock_Price:  90.17425252608683
curr_Factors:  [9.01742525e+01 4.67654704e-02]
mat_Sqrt:  [[ 1.95004757e+01  0.00000000e+00]
 [-8.65013021e-03  1.98199382e-02]]
grads:  [0.00746069 0.68152369]
Stock Position:  0.007460693540654021
Bond Position:  [0.33501892]


portfolio before change:  [1.00991196]
curr_Stock_Price:  90.45421204455113
curr_Factors:  [9.04542120e+01 4.76976867e-02]
mat_Sqrt:  [[ 1.97550191e+01  0.00000000e+00]
 [-8.73592002e-03  2.00165074e-02]]
grads:  [8.05202521e-03 2.72765148e+01]
Stock Position:  0.00805202521343726
Bond Position:  [0.28157236]


portfolio before change:  [1.00325154]
curr_Stock_Price:  89.62266724351548
curr_Factors:  [8.96226672e+01 4.67334043e-02]
mat_Sqrt:  [[ 1.93745478e+01  0.00000000e+00]
 [-8.64716409e-03  1.98131420e-02]]
grads:  [-0.02387494 -7.38207592]
Stock Position:  -0.023874944626905818
Bond Position:  [3.14298776]


portfolio before change:  [1.02828427]
curr_Stock_Price:  88.59062988635645
curr_Factors:  [8.85906299e+01 4.87078665e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.02828427]
Stock Price:  88.7285485257781
PL:  [1.02828427]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.46094585e+00  3.61927160e-01]
 [ 1.07457548e+00  7.09602872e-02]
 [-4.37349187e-02  9.53630795e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.18591633e-01  9.81573038e-01]
 [ 3.60872102e-02 -6.85515047e-03]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.45932424e-01  8.40951928e-01]
 [-1.60601780e-02  2.89498342e-01]
 [ 1.91160736e-01  8.74543494e-02]
 [-1.00400397e-01  5.73101835e-03]
 [ 2.57910228e-02 -1.33779233e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-1.04220620e-01  1.62267637e-01]
 [ 4.24955210e-01  2.83935650e-01]
 [ 1.30384910e-01 -1.21285003e-01]
 [ 3.80000508e-02 -7.62394039e-03]
 [ 2.92740161e-02 -1.50521288e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-1.90786676e-02 -7.28869386e-02]
 [ 1.68859905e-01 -3.83774662e-02]
 [ 5.81984513e-01 -1.87036234e-01]
 [ 2.89644556e-02 -3.79290270e-01]
 [ 5.73400917e-02  1.07370057e-02]
 [ 4.25721772e-01 -3.57372520e-01]
 [-2.58912542e-01  1.89902711e-02]
 [-1.46632110e-01  1.25092031e-01]
 [-1.24979117e-01 -2.30799965e-01]
 [-8.52155032e-02  2.19370601e-01]
 [-6.12193179e-01  3.99452927e-01]
 [-1.26343517e-01 -1.35634747e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.34160163e-01 -2.30466861e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.44746643e-01 -1.76196443e-02]
 [-2.98628815e-02 -1.54792177e-01]
 [-1.77747462e-03 -6.41659860e-02]
 [ 2.16615928e-01 -1.15965790e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.56913198]
curr_Stock_Price:  98.80237367727133
curr_Factors:  [9.88023737e+01 3.94824463e-02]
mat_Sqrt:  [[ 1.96322197e+01  0.00000000e+00]
 [-7.94807613e-03  1.82113302e-02]]
grads:  [ 0.08246158 19.87373551]
Stock Position:  0.08246157804391359
Bond Position:  [-13.71653162]


portfolio before change:  [-5.60549277]
curr_Stock_Price:  98.38222507154083
curr_Factors:  [9.83822251e+01 3.95709284e-02]
mat_Sqrt:  [[ 1.95706279e+01  0.00000000e+00]
 [-7.95697715e-03  1.82317250e-02]]
grads:  [0.05649002 3.89213237]
Stock Position:  0.056490016436851496
Bond Position:  [-11.16310628]


portfolio before change:  [-5.65648385]
curr_Stock_Price:  97.50427148996764
curr_Factors:  [9.75042715e+01 4.12569901e-02]
mat_Sqrt:  [[ 1.98048890e+01  0.00000000e+00]
 [-8.12472672e-03  1.86160876e-02]]
grads:  [-1.06794772e-04  5.12261661e+00]
Stock Position:  -0.00010679477213805791
Bond Position:  [-5.64607091]


portfolio before change:  [-5.65717791]
curr_Stock_Price:  97.39423723361365
curr_Factors:  [9.73942372e+01 4.14562538e-02]
mat_Sqrt:  [[ 1.98302545e+01  0.00000000e+00]
 [-8.14432355e-03  1.86609896e-02]]
grads:  [-8.22045272e-04 -8.11247505e+00]
Stock Position:  -0.0008220452722383078
Bond Position:  [-5.57711543]


portfolio before change:  [-5.65762938]
curr_Stock_Price:  97.09534181063523
curr_Factors:  [9.70953418e+01 4.09336358e-02]
mat_Sqrt:  [[ 1.96443904e+01  0.00000000e+00]
 [-8.09282505e-03  1.85429917e-02]]
grads:  [1.57705053e-02 5.29349878e+01]
Stock Position:  0.01577050526472557
Bond Position:  [-7.18887198]


portfolio before change:  [-5.67033747]
curr_Stock_Price:  96.34651232441895
curr_Factors:  [9.63465123e+01 4.17603197e-02]
mat_Sqrt:  [[ 1.96887392e+01  0.00000000e+00]
 [-8.17413675e-03  1.87293002e-02]]
grads:  [ 0.00168093 -0.3660121 ]
Stock Position:  0.0016809292341758526
Bond Position:  [-5.83228914]


portfolio before change:  [-5.66938541]
curr_Stock_Price:  97.34663854855279
curr_Factors:  [9.73466385e+01 4.23288485e-02]
mat_Sqrt:  [[ 2.00280740e+01  0.00000000e+00]
 [-8.22959037e-03  1.88563604e-02]]
grads:  [0.00645962 5.09837981]
Stock Position:  0.006459621497138088
Bond Position:  [-6.29820785]


portfolio before change:  [-5.66695447]
curr_Stock_Price:  97.84485078158939
curr_Factors:  [9.78448508e+01 4.02002545e-02]
mat_Sqrt:  [[ 1.96178937e+01  0.00000000e+00]
 [-8.02000045e-03  1.83761296e-02]]
grads:  [ 0.06182896 45.76327808]
Stock Position:  0.06182895853482942
Bond Position:  [-11.71659969]


portfolio before change:  [-5.6347915]
curr_Stock_Price:  98.3887325016751
curr_Factors:  [9.83887325e+01 3.82722630e-02]
mat_Sqrt:  [[ 1.92480810e+01  0.00000000e+00]
 [-7.82531921e-03  1.79300588e-02]]
grads:  [5.72977935e-03 1.61459784e+01]
Stock Position:  0.0057297793493133724
Bond Position:  [-6.19853722]


portfolio before change:  [-5.63417676]
curr_Stock_Price:  98.63125501567767
curr_Factors:  [9.86312550e+01 3.85273978e-02]
mat_Sqrt:  [[ 1.93597345e+01  0.00000000e+00]
 [-7.85135889e-03  1.79897232e-02]]
grads:  [0.01184567 4.86135047]
Stock Position:  0.011845665695907124
Bond Position:  [-6.80252964]


portfolio before change:  [-5.63473894]
curr_Stock_Price:  98.65558407953415
curr_Factors:  [9.86555841e+01 3.72385628e-02]
mat_Sqrt:  [[ 1.90378599e+01  0.00000000e+00]
 [-7.71891835e-03  1.76862638e-02]]
grads:  [-0.00514234  0.32403782]
Stock Position:  -0.005142341408086882
Bond Position:  [-5.12741824]


portfolio before change:  [-5.63829658]
curr_Stock_Price:  99.22277287450821
curr_Factors:  [9.92227729e+01 3.79227462e-02]
mat_Sqrt:  [[ 1.93224081e+01  0.00000000e+00]
 [-7.78950537e-03  1.78479990e-02]]
grads:  [-1.68690265e-03 -7.49547517e+00]
Stock Position:  -0.0016869026500557468
Bond Position:  [-5.47091743]


portfolio before change:  [-5.63747066]
curr_Stock_Price:  98.32774414087073
curr_Factors:  [9.83277441e+01 4.02834276e-02]
mat_Sqrt:  [[ 1.97350978e+01  0.00000000e+00]
 [-8.02829273e-03  1.83951296e-02]]
grads:  [-0.00655426 -1.52493654]
Stock Position:  -0.006554256245911676
Bond Position:  [-4.99300543]


portfolio before change:  [-5.63196081]
curr_Stock_Price:  97.39186141746164
curr_Factors:  [9.73918614e+01 3.99619720e-02]
mat_Sqrt:  [[ 1.94691110e+01  0.00000000e+00]
 [-7.99619629e-03  1.83215874e-02]]
grads:  [-1.71560052e-03  8.85663634e+00]
Stock Position:  -0.001715600518404778
Bond Position:  [-5.46487529]


portfolio before change:  [-5.63169615]
curr_Stock_Price:  96.83939375254839
curr_Factors:  [9.68393938e+01 3.92446232e-02]
mat_Sqrt:  [[ 1.91841315e+01  0.00000000e+00]
 [-7.92410229e-03  1.81563993e-02]]
grads:  [ 0.02861088 15.63832377]
Stock Position:  0.028610880122630064
Bond Position:  [-8.40235644]


portfolio before change:  [-5.56489975]
curr_Stock_Price:  99.21075613827061
curr_Factors:  [9.92107561e+01 3.81688138e-02]
mat_Sqrt:  [[ 1.93826472e+01  0.00000000e+00]
 [-7.81473622e-03  1.79058101e-02]]
grads:  [ 3.99593482e-03 -6.77349992e+00]
Stock Position:  0.003995934819896667
Bond Position:  [-5.96133946]


portfolio before change:  [-5.55907752]
curr_Stock_Price:  100.85428775311321
curr_Factors:  [1.00854288e+02 3.85427635e-02]
mat_Sqrt:  [[ 1.98000274e+01  0.00000000e+00]
 [-7.85292440e-03  1.79933102e-02]]
grads:  [ 0.00175114 -0.42370972]
Stock Position:  0.0017511435565487922
Bond Position:  [-5.73568785]


portfolio before change:  [-5.55846415]
curr_Stock_Price:  101.6140019758693
curr_Factors:  [1.01614002e+02 3.75789928e-02]
mat_Sqrt:  [[ 1.96981810e+01  0.00000000e+00]
 [-7.75412074e-03  1.77669226e-02]]
grads:  [-1.84884379e-03 -8.47199547e+00]
Stock Position:  -0.0018488437926373184
Bond Position:  [-5.37059574]


portfolio before change:  [-5.55841347]
curr_Stock_Price:  101.22345824168067
curr_Factors:  [1.01223458e+02 3.80754371e-02]
mat_Sqrt:  [[ 1.97516608e+01  0.00000000e+00]
 [-7.80517132e-03  1.78838942e-02]]
grads:  [-1.61390552e-02 -2.62407974e+01]
Stock Position:  -0.016139055210971903
Bond Position:  [-3.92476248]


portfolio before change:  [-5.55905339]
curr_Stock_Price:  101.2327088745751
curr_Factors:  [1.01232709e+02 3.79808974e-02]
mat_Sqrt:  [[ 1.97289271e+01  0.00000000e+00]
 [-7.79547534e-03  1.78616779e-02]]
grads:  [-2.57941728e-03 -4.08063223e+00]
Stock Position:  -0.002579417278341105
Bond Position:  [-5.29793199]


portfolio before change:  [-5.56035808]
curr_Stock_Price:  101.48176155604808
curr_Factors:  [1.01481762e+02 3.85034952e-02]
mat_Sqrt:  [[ 1.99130633e+01  0.00000000e+00]
 [-7.84892300e-03  1.79841419e-02]]
grads:  [ 0.00763873 -2.13396149]
Stock Position:  0.007638734572240202
Bond Position:  [-6.33555032]


portfolio before change:  [-5.55856196]
curr_Stock_Price:  101.82057613287891
curr_Factors:  [1.01820576e+02 3.89825058e-02]
mat_Sqrt:  [[ 2.01034422e+01  0.00000000e+00]
 [-7.89759515e-03  1.80956638e-02]]
grads:  [  0.02488903 -10.33596977]
Stock Position:  0.024889031602325654
Bond Position:  [-8.0927775]


portfolio before change:  [-5.52309183]
curr_Stock_Price:  103.28635401289787
curr_Factors:  [1.03286354e+02 3.81278351e-02]
mat_Sqrt:  [[ 2.01680552e+01  0.00000000e+00]
 [-7.81054007e-03  1.78961955e-02]]
grads:  [-6.77166876e-03 -2.11939051e+01]
Stock Position:  -0.0067716687613811576
Bond Position:  [-4.82367085]


portfolio before change:  [-5.51612122]
curr_Stock_Price:  102.16792937389091
curr_Factors:  [1.02167929e+02 3.87746844e-02]
mat_Sqrt:  [[ 2.01181818e+01  0.00000000e+00]
 [-7.87651541e-03  1.80473640e-02]]
grads:  [0.00308309 0.59493484]
Stock Position:  0.0030830870237084306
Bond Position:  [-5.83111384]


portfolio before change:  [-5.51198236]
curr_Stock_Price:  103.74680055434837
curr_Factors:  [1.03746801e+02 3.75828177e-02]
mat_Sqrt:  [[ 2.01126539e+01  0.00000000e+00]
 [-7.75451535e-03  1.77678268e-02]]
grads:  [ 1.34120350e-02 -2.01134626e+01]
Stock Position:  0.013412034971626324
Bond Position:  [-6.90343808]


portfolio before change:  [-5.50409741]
curr_Stock_Price:  104.3990460887388
curr_Factors:  [1.04399046e+02 3.79683416e-02]
mat_Sqrt:  [[ 2.03426415e+01  0.00000000e+00]
 [-7.79418672e-03  1.78587253e-02]]
grads:  [-0.01232016  1.06336095]
Stock Position:  -0.01232015560027701
Bond Position:  [-4.21788491]


portfolio before change:  [-5.50631719]
curr_Stock_Price:  104.53642404755125
curr_Factors:  [1.04536424e+02 3.68813372e-02]
mat_Sqrt:  [[ 2.00757126e+01  0.00000000e+00]
 [-7.68180574e-03  1.76012281e-02]]
grads:  [-4.58451830e-03  7.10700583e+00]
Stock Position:  -0.004584518298976295
Bond Position:  [-5.02706804]


portfolio before change:  [-5.51805699]
curr_Stock_Price:  106.96009714748095
curr_Factors:  [1.06960097e+02 3.51265384e-02]
mat_Sqrt:  [[ 2.00465419e+01  0.00000000e+00]
 [-7.49683009e-03  1.71773957e-02]]
grads:  [-1.12592227e-02 -1.34362606e+01]
Stock Position:  -0.011259222740199205
Bond Position:  [-4.31376943]


portfolio before change:  [-5.51790725]
curr_Stock_Price:  106.89890309271719
curr_Factors:  [1.06898903e+02 3.48348476e-02]
mat_Sqrt:  [[ 1.99517138e+01  0.00000000e+00]
 [-7.46563836e-03  1.71059264e-02]]
grads:  [5.27557508e-04 1.28242456e+01]
Stock Position:  0.0005275575078161621
Bond Position:  [-5.57430256]


portfolio before change:  [-5.51873088]
curr_Stock_Price:  106.6585353434719
curr_Factors:  [1.06658535e+02 3.57997101e-02]
mat_Sqrt:  [[ 2.01806602e+01  0.00000000e+00]
 [-7.56832453e-03  1.73412100e-02]]
grads:  [-2.16968931e-02  2.30348935e+01]
Stock Position:  -0.021696893139308608
Bond Position:  [-3.20457204]


portfolio before change:  [-5.48186177]
curr_Stock_Price:  104.94079103888973
curr_Factors:  [1.04940791e+02 3.58725473e-02]
mat_Sqrt:  [[ 1.98758377e+01  0.00000000e+00]
 [-7.57601978e-03  1.73588420e-02]]
grads:  [-0.00665447 -0.78135826]
Stock Position:  -0.006654466819335567
Bond Position:  [-4.78353675]


portfolio before change:  [-5.48523627]
curr_Stock_Price:  105.35803386508823
curr_Factors:  [1.05358034e+02 3.46643261e-02]
mat_Sqrt:  [[ 1.96159361e+01  0.00000000e+00]
 [-7.44734327e-03  1.70640071e-02]]
grads:  [ 0.00369815 -0.70013972]
Stock Position:  0.003698146055745059
Bond Position:  [-5.87486567]


portfolio before change:  [-5.4854435]
curr_Stock_Price:  105.50058490811352
curr_Factors:  [1.05500585e+02 3.46783164e-02]
mat_Sqrt:  [[ 1.96464402e+01  0.00000000e+00]
 [-7.44884597e-03  1.70674502e-02]]
grads:  [-0.01243068 -1.35032977]
Stock Position:  -0.012430677489992173
Bond Position:  [-4.17399976]


portfolio before change:  [-5.48127825]
curr_Stock_Price:  105.12353087703171
curr_Factors:  [1.05123531e+02 3.59021274e-02]
mat_Sqrt:  [[ 1.99186560e+01  0.00000000e+00]
 [-7.57914268e-03  1.73659975e-02]]
grads:  [0.00509428 3.07204126]
Stock Position:  0.005094278033768615
Bond Position:  [-6.01680674]


portfolio before change:  [-5.47540741]
curr_Stock_Price:  106.42361366721642
curr_Factors:  [1.06423614e+02 3.55147191e-02]
mat_Sqrt:  [[ 2.00559018e+01  0.00000000e+00]
 [-7.53813973e-03  1.72720480e-02]]
grads:  [-0.00472019  4.70848312]
Stock Position:  -0.004720187201310245
Bond Position:  [-4.97306804]


portfolio before change:  [-5.46999816]
curr_Stock_Price:  105.14592565405269
curr_Factors:  [1.05145926e+02 3.73032645e-02]
mat_Sqrt:  [[ 2.03079399e+01  0.00000000e+00]
 [-7.72562122e-03  1.77016220e-02]]
grads:  [-0.01735462 -0.99536892]
Stock Position:  -0.017354615398830577
Bond Position:  [-3.64523106]


portfolio before change:  [-5.49056728]
curr_Stock_Price:  106.30489318667361
curr_Factors:  [1.06304893e+02 3.74587436e-02]
mat_Sqrt:  [[ 2.05745269e+01  0.00000000e+00]
 [-7.74170457e-03  1.77384736e-02]]
grads:  [-4.73496798e-03 -8.72635272e+00]
Stock Position:  -0.004734967979696008
Bond Position:  [-4.98721701]


portfolio before change:  [-5.49417768]
curr_Stock_Price:  106.93572245530632
curr_Factors:  [1.06935722e+02 3.55154787e-02]
mat_Sqrt:  [[ 2.01526260e+01  0.00000000e+00]
 [-7.53822034e-03  1.72722327e-02]]
grads:  [-1.47781271e-03 -3.71497926e+00]
Stock Position:  -0.0014778127119411016
Bond Position:  [-5.33614671]


portfolio before change:  [-5.49499356]
curr_Stock_Price:  107.03642704653207
curr_Factors:  [1.07036427e+02 3.45993257e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.49499356]
Stock Price:  105.89076149764429
PL:  [-11.38575506]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.09912910e+00  2.77392284e-01]
 [-2.64971445e-01 -1.02015259e-01]
 [-1.75468164e-02 -6.16416514e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.16359744e-02  1.66264362e-01]
 [-1.04737042e-01 -8.93804135e-02]
 [ 8.77253389e-02  9.56648503e-02]
 [ 7.75156013e-02  4.10537889e-01]
 [-7.52078856e-02  8.42909798e-02]
 [ 1.80754059e-01  4.24348449e-02]
 [-1.11075926e-01 -1.07271404e-03]
 [ 2.55272337e-02 -1.33662457e-01]
 [-1.07794236e-01 -2.58303051e-02]
 [-4.13772090e-02 -3.90397845e-02]
 [ 1.92537876e-01  1.08857932e-01]
 [ 1.22494509e-01 -6.25691706e-01]
 [ 3.95846153e-02  9.05887080e-02]
 [ 5.29414718e-03 -7.44953940e-02]
 [-5.86414954e-02 -1.15327093e-01]
 [-6.20946726e-02 -4.77036348e-02]
 [ 1.78112664e-01 -4.44295720e-02]
 [ 6.91318335e-01 -9.90421047e-02]
 [ 2.79421665e-02 -2.82780894e-01]
 [ 5.82444306e-02  6.15907418e-03]
 [ 2.56731101e-01 -1.64230937e-01]
 [-3.90200694e-02 -3.55763896e-02]
 [-1.50847699e-01  1.12349916e-01]
 [-1.17753208e-01 -2.01239759e-01]
 [-7.55667364e-02  2.27800115e-01]
 [-5.97137738e-01  4.40177300e-01]
 [-1.13768535e-01  3.87249453e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.11161027e-01 -9.05434913e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.61450345e-01 -1.28239363e-01]
 [-3.38561498e-02 -1.17816608e-01]
 [ 1.33012023e-02 -6.31783793e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.53431766]
curr_Stock_Price:  100.99471438254024
curr_Factors:  [1.00994714e+02 4.08409435e-02]
mat_Sqrt:  [[ 2.04101656e+01  0.00000000e+00]
 [-8.08365694e-03  1.85219849e-02]]
grads:  [ 0.05978359 14.97637997]
Stock Position:  0.0597835924229238
Bond Position:  [3.49649082]


portfolio before change:  [9.59040517]
curr_Stock_Price:  101.92557894955013
curr_Factors:  [1.01925579e+02 4.15267308e-02]
mat_Sqrt:  [[ 2.07705051e+01  0.00000000e+00]
 [-8.15124342e-03  1.86768450e-02]]
grads:  [-0.01490068 -5.46212482]
Stock Position:  -0.014900675369897861
Bond Position:  [11.10916514]


portfolio before change:  [9.60479157]
curr_Stock_Price:  101.05329203325164
curr_Factors:  [1.01053292e+02 4.22095621e-02]
mat_Sqrt:  [[ 2.07613643e+01  0.00000000e+00]
 [-8.21798633e-03  1.88297722e-02]]
grads:  [-2.14096906e-03 -3.27362704e+00]
Stock Position:  -0.0021409690619427885
Bond Position:  [9.82114354]


portfolio before change:  [9.60987992]
curr_Stock_Price:  99.25007438546847
curr_Factors:  [9.92500744e+01 4.29074486e-02]
mat_Sqrt:  [[ 2.05587728e+01  0.00000000e+00]
 [-8.28564528e-03  1.89847983e-02]]
grads:  [-7.92915372e-04 -7.97410695e+00]
Stock Position:  -0.000792915372490199
Bond Position:  [9.68857683]


portfolio before change:  [9.61068669]
curr_Stock_Price:  99.76006143496296
curr_Factors:  [9.97600614e+01 4.16482702e-02]
mat_Sqrt:  [[ 2.03589414e+01  0.00000000e+00]
 [-8.16316313e-03  1.87041565e-02]]
grads:  [-4.45615405e-04  8.88916653e+00]
Stock Position:  -0.00044561540487128456
Bond Position:  [9.65514131]


portfolio before change:  [9.61211371]
curr_Stock_Price:  99.26626458371464
curr_Factors:  [9.92662646e+01 4.17165503e-02]
mat_Sqrt:  [[ 2.02747671e+01  0.00000000e+00]
 [-8.16985193e-03  1.87194824e-02]]
grads:  [-0.00708989 -4.77472675]
Stock Position:  -0.007089889194991368
Bond Position:  [10.31590052]


portfolio before change:  [9.61279973]
curr_Stock_Price:  99.35139158108312
curr_Factors:  [9.93513916e+01 4.34974185e-02]
mat_Sqrt:  [[ 2.07207607e+01  0.00000000e+00]
 [-8.34241390e-03  1.91148716e-02]]
grads:  [0.00624866 5.00473413]
Stock Position:  0.006248655832215604
Bond Position:  [8.99198708]


portfolio before change:  [9.62406527]
curr_Stock_Price:  100.97437512227226
curr_Factors:  [1.00974375e+02 4.09528056e-02]
mat_Sqrt:  [[ 2.04339819e+01  0.00000000e+00]
 [-8.09471982e-03  1.85473332e-02]]
grads:  [1.25618701e-02 2.21346048e+01]
Stock Position:  0.01256187005998329
Bond Position:  [8.35563829]


portfolio before change:  [9.61175617]
curr_Stock_Price:  99.91134725809601
curr_Factors:  [9.99113473e+01 4.18035115e-02]
mat_Sqrt:  [[ 2.04277812e+01  0.00000000e+00]
 [-8.17836282e-03  1.87389834e-02]]
grads:  [-1.88078606e-03  4.49816184e+00]
Stock Position:  -0.001880786055242386
Bond Position:  [9.79966804]


portfolio before change:  [9.61268349]
curr_Stock_Price:  100.06963709490294
curr_Factors:  [1.00069637e+02 4.17385704e-02]
mat_Sqrt:  [[ 2.04442466e+01  0.00000000e+00]
 [-8.17200787e-03  1.87244223e-02]]
grads:  [0.0097472  2.26628326]
Stock Position:  0.009747199216131949
Bond Position:  [8.63728481]


portfolio before change:  [9.60915283]
curr_Stock_Price:  99.59664055483363
curr_Factors:  [9.95966406e+01 4.24618621e-02]
mat_Sqrt:  [[ 2.05231589e+01  0.00000000e+00]
 [-8.24251050e-03  1.88859641e-02]]
grads:  [-0.00543504 -0.05679954]
Stock Position:  -0.005435035473315128
Bond Position:  [10.15046411]


portfolio before change:  [9.6136652]
curr_Stock_Price:  98.99986830162781
curr_Factors:  [9.89998683e+01 4.36789207e-02]
mat_Sqrt:  [[ 2.06904800e+01  0.00000000e+00]
 [-8.35980102e-03  1.91547105e-02]]
grads:  [-1.58564929e-03 -6.97804630e+00]
Stock Position:  -0.001585649286352593
Bond Position:  [9.77064427]


portfolio before change:  [9.61283641]
curr_Stock_Price:  100.29283574952953
curr_Factors:  [1.00292836e+02 4.23497522e-02]
mat_Sqrt:  [[ 2.06393183e+01  0.00000000e+00]
 [-8.23162217e-03  1.88610158e-02]]
grads:  [-0.00576897 -1.36950763]
Stock Position:  -0.005768965037312186
Bond Position:  [10.19142227]


portfolio before change:  [9.6123427]
curr_Stock_Price:  100.59925458512315
curr_Factors:  [1.00599255e+02 4.29812897e-02]
mat_Sqrt:  [[ 2.08561665e+01  0.00000000e+00]
 [-8.29277177e-03  1.90011272e-02]]
grads:  [-0.00280088 -2.05460361]
Stock Position:  -0.0028008775223469806
Bond Position:  [9.89410889]


portfolio before change:  [9.60753187]
curr_Stock_Price:  102.75846110943012
curr_Factors:  [1.02758461e+02 4.31325924e-02]
mat_Sqrt:  [[ 2.13412755e+01  0.00000000e+00]
 [-8.30735505e-03  1.90345417e-02]]
grads:  [0.01124803 5.71896784]
Stock Position:  0.011248033048555981
Bond Position:  [8.4517013]


portfolio before change:  [9.61010831]
curr_Stock_Price:  102.89358844965011
curr_Factors:  [1.02893588e+02 4.11047840e-02]
mat_Sqrt:  [[ 2.08609700e+01  0.00000000e+00]
 [-8.10972591e-03  1.85817164e-02]]
grads:  [-7.21825201e-03 -3.36724386e+01]
Stock Position:  -0.007218252011426301
Bond Position:  [10.35282016]


portfolio before change:  [9.63352497]
curr_Stock_Price:  99.828791451263
curr_Factors:  [9.98287915e+01 4.29775665e-02]
mat_Sqrt:  [[ 2.06955382e+01  0.00000000e+00]
 [-8.29241258e-03  1.90003042e-02]]
grads:  [3.82308342e-03 4.76775041e+00]
Stock Position:  0.0038230834199278222
Bond Position:  [9.25187118]


portfolio before change:  [9.63506042]
curr_Stock_Price:  99.92789685721054
curr_Factors:  [9.99278969e+01 4.35308899e-02]
mat_Sqrt:  [[ 2.08490140e+01  0.00000000e+00]
 [-8.34562304e-03  1.91222246e-02]]
grads:  [-1.30549619e-03 -3.89574934e+00]
Stock Position:  -0.0013054961888219814
Bond Position:  [9.76551591]


portfolio before change:  [9.63712566]
curr_Stock_Price:  99.28103776122056
curr_Factors:  [9.92810378e+01 4.43614602e-02]
mat_Sqrt:  [[ 2.09107314e+01  0.00000000e+00]
 [-8.42486417e-03  1.93037889e-02]]
grads:  [-5.21140859e-03 -5.97432422e+00]
Stock Position:  -0.005211408590062627
Bond Position:  [10.15451971]


portfolio before change:  [9.63381521]
curr_Stock_Price:  100.15984839126706
curr_Factors:  [1.00159848e+02 4.29257034e-02]
mat_Sqrt:  [[ 2.07516373e+01  0.00000000e+00]
 [-8.28740764e-03  1.89888364e-02]]
grads:  [-0.00399555 -2.51219368]
Stock Position:  -0.003995551985995795
Bond Position:  [10.03400909]


portfolio before change:  [9.63472889]
curr_Stock_Price:  100.2451047513976
curr_Factors:  [1.00245105e+02 4.22683323e-02]
mat_Sqrt:  [[ 2.06096554e+01  0.00000000e+00]
 [-8.22370547e-03  1.88428764e-02]]
grads:  [ 0.00770134 -2.35789754]
Stock Position:  0.007701342227100047
Bond Position:  [8.86270703]


portfolio before change:  [9.64039504]
curr_Stock_Price:  100.8369813650968
curr_Factors:  [1.00836981e+02 4.10442045e-02]
mat_Sqrt:  [[ 2.04289365e+01  0.00000000e+00]
 [-8.10374772e-03  1.85680187e-02]]
grads:  [ 0.03172426 -5.33401578]
Stock Position:  0.03172425633852135
Bond Position:  [6.4414168]


portfolio before change:  [9.63760593]
curr_Stock_Price:  100.72368197350124
curr_Factors:  [1.00723682e+02 4.20707510e-02]
mat_Sqrt:  [[ 2.06595913e+01  0.00000000e+00]
 [-8.20446230e-03  1.87987848e-02]]
grads:  [-4.62126923e-03 -1.50425092e+01]
Stock Position:  -0.004621269226601262
Bond Position:  [10.10307718]


portfolio before change:  [9.63459885]
curr_Stock_Price:  101.64768054546178
curr_Factors:  [1.01647681e+02 3.96727230e-02]
mat_Sqrt:  [[ 2.02461979e+01  0.00000000e+00]
 [-7.96720508e-03  1.82551602e-02]]
grads:  [0.00300958 0.33738812]
Stock Position:  0.003009575977360648
Bond Position:  [9.32868243]


portfolio before change:  [9.63481222]
curr_Stock_Price:  101.33109546885336
curr_Factors:  [1.01331095e+02 4.07589043e-02]
mat_Sqrt:  [[ 2.04575673e+01  0.00000000e+00]
 [-8.07553385e-03  1.85033726e-02]]
grads:  [ 0.00904579 -8.87572989]
Stock Position:  0.009045789320098108
Bond Position:  [8.71819248]


portfolio before change:  [9.64698281]
curr_Stock_Price:  102.55605683016208
curr_Factors:  [1.02556057e+02 3.93974466e-02]
mat_Sqrt:  [[ 2.03561364e+01  0.00000000e+00]
 [-7.93951602e-03  1.81917166e-02]]
grads:  [-0.00267963 -1.95563675]
Stock Position:  -0.002679628278155355
Bond Position:  [9.92179492]


portfolio before change:  [9.64411193]
curr_Stock_Price:  104.09029099898537
curr_Factors:  [1.04090291e+02 3.91134129e-02]
mat_Sqrt:  [[ 2.05860527e+01  0.00000000e+00]
 [-7.91084450e-03  1.81260219e-02]]
grads:  [-4.94578428e-03  6.19826660e+00]
Stock Position:  -0.004945784284822379
Bond Position:  [10.15892006]


portfolio before change:  [9.63249336]
curr_Stock_Price:  106.69624989704535
curr_Factors:  [1.06696250e+02 3.75326355e-02]
mat_Sqrt:  [[ 2.06706287e+01  0.00000000e+00]
 [-7.74933654e-03  1.77559606e-02]]
grads:  [-9.94558232e-03 -1.13336453e+01]
Stock Position:  -0.00994558231946276
Bond Position:  [10.6936497]


portfolio before change:  [9.62050079]
curr_Stock_Price:  108.03647918554537
curr_Factors:  [1.08036479e+02 3.66550252e-02]
mat_Sqrt:  [[ 2.06841264e+01  0.00000000e+00]
 [-7.65820086e-03  1.75471426e-02]]
grads:  [1.15322175e-03 1.29821772e+01]
Stock Position:  0.0011532217489377322
Bond Position:  [9.49591078]


portfolio before change:  [9.62031922]
curr_Stock_Price:  106.84968585890415
curr_Factors:  [1.06849686e+02 3.61755897e-02]
mat_Sqrt:  [[ 2.03226838e+01  0.00000000e+00]
 [-7.60795265e-03  1.74320095e-02]]
grads:  [-1.99298783e-02  2.52510935e+01]
Stock Position:  -0.019929878319546155
Bond Position:  [11.74982046]


portfolio before change:  [9.60772369]
curr_Stock_Price:  107.55537777272107
curr_Factors:  [1.07555378e+02 3.61877931e-02]
mat_Sqrt:  [[ 2.04603557e+01  0.00000000e+00]
 [-7.60923576e-03  1.74349494e-02]]
grads:  [-0.0047344   2.22111027]
Stock Position:  -0.004734403688210795
Bond Position:  [10.11693426]


portfolio before change:  [9.60591787]
curr_Stock_Price:  108.20393131341837
curr_Factors:  [1.08203931e+02 3.56377075e-02]
mat_Sqrt:  [[ 2.04266863e+01  0.00000000e+00]
 [-7.55118083e-03  1.73019289e-02]]
grads:  [ 0.00355136 -0.69051198]
Stock Position:  0.0035513639200335932
Bond Position:  [9.22164633]


portfolio before change:  [9.60307681]
curr_Stock_Price:  107.07933837745463
curr_Factors:  [1.07079338e+02 3.65420084e-02]
mat_Sqrt:  [[ 2.04692479e+01  0.00000000e+00]
 [-7.64638564e-03  1.75200705e-02]]
grads:  [-0.01224654 -5.1679867 ]
Stock Position:  -0.012246539165688205
Bond Position:  [10.91442812]


portfolio before change:  [9.58547441]
curr_Stock_Price:  108.62808516629401
curr_Factors:  [1.08628085e+02 3.57117641e-02]
mat_Sqrt:  [[ 2.05280538e+01  0.00000000e+00]
 [-7.55902260e-03  1.73198966e-02]]
grads:  [0.00494305 3.08021821]
Stock Position:  0.0049430488095048
Bond Position:  [9.04852048]


portfolio before change:  [9.59159111]
curr_Stock_Price:  109.63668594802277
curr_Factors:  [1.09636686e+02 3.44733334e-02]
mat_Sqrt:  [[ 2.03562389e+01  0.00000000e+00]
 [-7.42679833e-03  1.70169328e-02]]
grads:  [-4.65054528e-03  4.77907196e+00]
Stock Position:  -0.004650545280991426
Bond Position:  [10.10146148]


portfolio before change:  [9.58962541]
curr_Stock_Price:  110.33089531892155
curr_Factors:  [1.10330895e+02 3.31080078e-02]
mat_Sqrt:  [[ 2.00753750e+01  0.00000000e+00]
 [-7.27824240e-03  1.66765484e-02]]
grads:  [-0.02577379 -7.68980251]
Stock Position:  -0.02577379457531105
Bond Position:  [12.43327125]


portfolio before change:  [9.57030888]
curr_Stock_Price:  111.14066334793198
curr_Factors:  [1.11140663e+02 3.31008529e-02]
mat_Sqrt:  [[ 2.02205320e+01  0.00000000e+00]
 [-7.27745592e-03  1.66747463e-02]]
grads:  [-4.21727446e-03 -7.06557122e+00]
Stock Position:  -0.004217274455119177
Bond Position:  [10.03901956]


portfolio before change:  [9.57758938]
curr_Stock_Price:  109.71188438126227
curr_Factors:  [1.09711884e+02 3.46064789e-02]
mat_Sqrt:  [[ 2.04095007e+01  0.00000000e+00]
 [-7.44112668e-03  1.70497631e-02]]
grads:  [-6.99287216e-04 -3.70552827e+00]
Stock Position:  -0.0006992872155619014
Bond Position:  [9.6543095]


portfolio before change:  [9.57876126]
curr_Stock_Price:  109.76191840088222
curr_Factors:  [1.09761918e+02 3.45716496e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.57876126]
Stock Price:  110.16116055301616
PL:  [-0.58239929]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.02864509e+00  2.61457261e-01]
 [-2.68628391e-01 -9.84350160e-02]
 [-1.01039568e+00 -2.87695108e-01]
 [-1.82171775e-01 -9.97635075e-02]
 [-1.27838776e-01 -9.39618961e-01]
 [-5.27054025e-02 -6.33442250e-02]
 [ 3.99071452e-01 -4.75773576e-01]
 [-6.29217277e-01  1.41340913e-01]
 [-1.09245669e-01 -8.68730153e-02]
 [-3.29665099e-01 -5.63414174e-01]
 [-7.84441446e-02 -1.07840363e-02]
 [-2.02826239e-01 -2.21916204e-01]
 [-2.28022356e-02  1.45686978e-03]
 [ 2.25377029e-02 -1.93440644e-01]
 [-8.23232775e-02 -1.01736572e-01]
 [ 8.72938921e-02 -1.07794898e+00]
 [ 1.79659484e-02 -3.08547213e-01]
 [ 4.48940483e-02 -1.72093924e-01]
 [-9.71504673e-02 -6.95257718e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 6.08567332e-02 -3.03823120e-03]
 [ 2.62035045e-01 -7.68350889e-01]
 [ 2.75331163e-02 -3.59338396e-01]
 [-5.51752975e-03  2.33285381e-01]
 [ 5.08681584e-01 -6.13195440e-01]
 [-8.42462104e-01  1.34498282e-01]
 [-1.47483220e-01  2.51407273e-01]
 [-1.36578416e-01 -3.42942870e-01]
 [-7.14603034e-02  2.33970463e-01]
 [-4.99906782e-01  7.04634770e-01]
 [-1.19533076e-01  9.43834748e-03]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.38148964e-01 -1.13405369e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.72434880e-01  4.78664322e-02]
 [-2.25765068e-02 -2.22260185e-01]
 [ 1.26116729e-05 -5.00566263e-02]
 [-2.34335949e-02 -3.58654068e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.02034653]
curr_Stock_Price:  101.35557381747999
curr_Factors:  [1.01355574e+02 3.99823975e-02]
mat_Sqrt:  [[ 2.02666540e+01  0.00000000e+00]
 [-7.99823955e-03  1.83262691e-02]]
grads:  [ 0.05638594 14.26680249]
Stock Position:  0.05638594306035424
Bond Position:  [6.30531692]


portfolio before change:  [12.06771765]
curr_Stock_Price:  102.18171778661906
curr_Factors:  [1.02181718e+02 3.78078180e-02]
mat_Sqrt:  [[ 1.98684509e+01  0.00000000e+00]
 [-7.77769303e-03  1.78209335e-02]]
grads:  [-0.0156826  -5.52356115]
Stock Position:  -0.01568259932044253
Bond Position:  [13.67019259]


portfolio before change:  [12.03159086]
curr_Stock_Price:  104.59430708215669
curr_Factors:  [1.04594307e+02 3.58818265e-02]
mat_Sqrt:  [[ 1.98127755e+01  0.00000000e+00]
 [-7.57699957e-03  1.73610870e-02]]
grads:  [ -0.05733453 -16.57126122]
Stock Position:  -0.05733452731851915
Bond Position:  [18.02845602]


portfolio before change:  [12.07009448]
curr_Stock_Price:  103.9620542697172
curr_Factors:  [1.03962054e+02 3.67096950e-02]
mat_Sqrt:  [[ 1.99188949e+01  0.00000000e+00]
 [-7.66390971e-03  1.75602232e-02]]
grads:  [-0.01133156 -5.68122093]
Stock Position:  -0.011331559316142078
Bond Position:  [13.24814666]


portfolio before change:  [12.06267179]
curr_Stock_Price:  104.76325124818338
curr_Factors:  [1.04763251e+02 3.64267193e-02]
mat_Sqrt:  [[ 1.99948890e+01  0.00000000e+00]
 [-7.63431404e-03  1.74924110e-02]]
grads:  [-2.69029806e-02 -5.37158064e+01]
Stock Position:  -0.026902980615996518
Bond Position:  [14.88111551]


portfolio before change:  [12.03116126]
curr_Stock_Price:  106.00366344542638
curr_Factors:  [1.06003663e+02 3.66852326e-02]
mat_Sqrt:  [[ 2.03032944e+01  0.00000000e+00]
 [-7.66135576e-03  1.75543714e-02]]
grads:  [-0.00395754 -3.60845875]
Stock Position:  -0.003957539451636629
Bond Position:  [12.45067494]


portfolio before change:  [12.03843195]
curr_Stock_Price:  104.55977240531101
curr_Factors:  [1.04559772e+02 3.69531297e-02]
mat_Sqrt:  [[ 2.00997309e+01  0.00000000e+00]
 [-7.68927874e-03  1.76183509e-02]]
grads:  [ 9.52385091e-03 -2.70044329e+01]
Stock Position:  0.009523850906634641
Bond Position:  [11.04262026]


portfolio before change:  [12.02923523]
curr_Stock_Price:  103.44917840197748
curr_Factors:  [1.03449178e+02 3.87227049e-02]
mat_Sqrt:  [[ 2.03568178e+01  0.00000000e+00]
 [-7.87123420e-03  1.80352633e-02]]
grads:  [-0.02787916  7.83691987]
Stock Position:  -0.027879163199498375
Bond Position:  [14.91331176]


portfolio before change:  [12.0197594]
curr_Stock_Price:  103.85593766335796
curr_Factors:  [1.03855938e+02 3.86616459e-02]
mat_Sqrt:  [[ 2.04207412e+01  0.00000000e+00]
 [-7.86502596e-03  1.80210384e-02]]
grads:  [-0.00720641 -4.82064426]
Stock Position:  -0.00720640646491298
Bond Position:  [12.7681875]


portfolio before change:  [12.02296437]
curr_Stock_Price:  103.63268532685501
curr_Factors:  [1.03632685e+02 3.93624528e-02]
mat_Sqrt:  [[ 2.05606968e+01  0.00000000e+00]
 [-7.93598919e-03  1.81836356e-02]]
grads:  [-2.79931760e-02 -3.09846824e+01]
Stock Position:  -0.02799317601792635
Bond Position:  [14.92397237]


portfolio before change:  [12.03380674]
curr_Stock_Price:  103.31200871755259
curr_Factors:  [1.03312009e+02 4.07372090e-02]
mat_Sqrt:  [[ 2.08519388e+01  0.00000000e+00]
 [-8.07338432e-03  1.84984474e-02]]
grads:  [-0.00398767 -0.58296981]
Stock Position:  -0.003987671588251461
Bond Position:  [12.4457811]


portfolio before change:  [12.03023418]
curr_Stock_Price:  104.598066534858
curr_Factors:  [1.04598067e+02 3.98028762e-02]
mat_Sqrt:  [[ 2.08680027e+01  0.00000000e+00]
 [-7.98026327e-03  1.82850802e-02]]
grads:  [ -0.01436067 -12.1364632 ]
Stock Position:  -0.014360665702187822
Bond Position:  [13.53233205]


portfolio before change:  [12.01387496]
curr_Stock_Price:  105.85503290471665
curr_Factors:  [1.05855033e+02 3.90805229e-02]
mat_Sqrt:  [[ 2.09262637e+01  0.00000000e+00]
 [-7.90751773e-03  1.81183993e-02]]
grads:  [-0.00105926  0.08040831]
Stock Position:  -0.0010592624556607425
Bond Position:  [12.12600322]


portfolio before change:  [12.01533478]
curr_Stock_Price:  105.90792303093237
curr_Factors:  [1.05907923e+02 3.91898084e-02]
mat_Sqrt:  [[ 2.09659730e+01  0.00000000e+00]
 [-7.91856638e-03  1.81437149e-02]]
grads:  [-2.95176930e-03 -1.06615787e+01]
Stock Position:  -0.002951769300309646
Bond Position:  [12.32795053]


portfolio before change:  [12.01748437]
curr_Stock_Price:  105.70177499167164
curr_Factors:  [1.05701775e+02 3.98501775e-02]
mat_Sqrt:  [[ 2.11007266e+01  0.00000000e+00]
 [-7.98500369e-03  1.82959419e-02]]
grads:  [-0.00600571 -5.56060859]
Stock Position:  -0.00600570587812409
Bond Position:  [12.65229814]


portfolio before change:  [12.01394395]
curr_Stock_Price:  106.55464043532645
curr_Factors:  [1.06554640e+02 4.02182092e-02]
mat_Sqrt:  [[ 2.13689770e+01  0.00000000e+00]
 [-8.02179124e-03  1.83802328e-02]]
grads:  [-1.79307419e-02 -5.86471885e+01]
Stock Position:  -0.01793074185332403
Bond Position:  [13.9245477]


portfolio before change:  [12.03627963]
curr_Stock_Price:  105.40605400168849
curr_Factors:  [1.05406054e+02 4.16998923e-02]
mat_Sqrt:  [[ 2.15244975e+01  0.00000000e+00]
 [-8.16822060e-03  1.87157446e-02]]
grads:  [-5.42150148e-03 -1.64859705e+01]
Stock Position:  -0.00542150148012589
Bond Position:  [12.60773871]


portfolio before change:  [12.03118752]
curr_Stock_Price:  106.6360051764467
curr_Factors:  [1.06636005e+02 4.24843755e-02]
mat_Sqrt:  [[ 2.19795343e+01  0.00000000e+00]
 [-8.24469532e-03  1.88909702e-02]]
grads:  [-1.37463776e-03 -9.10985103e+00]
Stock Position:  -0.0013746377598020468
Bond Position:  [12.17777339]


portfolio before change:  [12.0311166]
curr_Stock_Price:  107.79502480700671
curr_Factors:  [1.07795025e+02 4.11027144e-02]
mat_Sqrt:  [[ 2.18541524e+01  0.00000000e+00]
 [-8.10952175e-03  1.85812486e-02]]
grads:  [-0.00583386 -3.74171689]
Stock Position:  -0.005833857069882986
Bond Position:  [12.65997737]


portfolio before change:  [12.02972178]
curr_Stock_Price:  108.30539346359713
curr_Factors:  [1.08305393e+02 4.12795965e-02]
mat_Sqrt:  [[ 2.20048193e+01  0.00000000e+00]
 [-8.12695234e-03  1.86211871e-02]]
grads:  [-2.20229348e-04 -5.85856253e+00]
Stock Position:  -0.00022022934823819312
Bond Position:  [12.0535738]


portfolio before change:  [12.03109302]
curr_Stock_Price:  108.92086418814918
curr_Factors:  [1.08920864e+02 4.07101284e-02]
mat_Sqrt:  [[ 2.19766916e+01  0.00000000e+00]
 [-8.07070043e-03  1.84922978e-02]]
grads:  [ 0.00270881 -0.16429712]
Stock Position:  0.0027088126528730873
Bond Position:  [11.73604681]


portfolio before change:  [12.03630632]
curr_Stock_Price:  110.30383123421986
curr_Factors:  [1.10303831e+02 4.04762144e-02]
mat_Sqrt:  [[ 2.21916984e+01  0.00000000e+00]
 [-8.04748054e-03  1.84390944e-02]]
grads:  [-3.30307188e-03 -4.16696652e+01]
Stock Position:  -0.003303071876208057
Bond Position:  [12.4006478]


portfolio before change:  [12.04018421]
curr_Stock_Price:  109.59912075878596
curr_Factors:  [1.09599121e+02 3.93944949e-02]
mat_Sqrt:  [[ 2.17532844e+01  0.00000000e+00]
 [-7.93921859e-03  1.81910351e-02]]
grads:  [-5.94370094e-03 -1.97535981e+01]
Stock Position:  -0.005943700938187739
Bond Position:  [12.6916086]


portfolio before change:  [12.04401758]
curr_Stock_Price:  109.22110415939801
curr_Factors:  [1.09221104e+02 3.92322362e-02]
mat_Sqrt:  [[ 2.16335651e+01  0.00000000e+00]
 [-7.92285163e-03  1.81535337e-02]]
grads:  [4.45125698e-03 1.28506871e+01]
Stock Position:  0.004451256976067669
Bond Position:  [11.55784637]


portfolio before change:  [12.04685224]
curr_Stock_Price:  109.53334048925964
curr_Factors:  [1.09533340e+02 3.88877395e-02]
mat_Sqrt:  [[ 2.15999468e+01  0.00000000e+00]
 [-7.88798981e-03  1.80736552e-02]]
grads:  [ 1.11602661e-02 -3.39275832e+01]
Stock Position:  0.011160266062061993
Bond Position:  [10.82443102]


portfolio before change:  [12.05562668]
curr_Stock_Price:  110.19831620018395
curr_Factors:  [1.10198316e+02 3.96925370e-02]
mat_Sqrt:  [[ 2.19547951e+01  0.00000000e+00]
 [-7.96919438e-03  1.82597182e-02]]
grads:  [-0.03569891  7.36584649]
Stock Position:  -0.035698909480078624
Bond Position:  [15.9895864]


portfolio before change:  [12.07718873]
curr_Stock_Price:  109.65030995239177
curr_Factors:  [1.09650310e+02 3.92777691e-02]
mat_Sqrt:  [[ 2.17311780e+01  0.00000000e+00]
 [-7.92744792e-03  1.81640651e-02]]
grads:  [-1.73759982e-03  1.38409145e+01]
Stock Position:  -0.001737599823679796
Bond Position:  [12.26771709]


portfolio before change:  [12.07975735]
curr_Stock_Price:  109.05462687493025
curr_Factors:  [1.09054627e+02 4.02532453e-02]
mat_Sqrt:  [[ 2.18798604e+01  0.00000000e+00]
 [-8.02528458e-03  1.83882370e-02]]
grads:  [-1.30828511e-02 -1.86501224e+01]
Stock Position:  -0.013082851105167128
Bond Position:  [13.5065028]


portfolio before change:  [12.08609042]
curr_Stock_Price:  108.69960894115135
curr_Factors:  [1.08699609e+02 4.04881575e-02]
mat_Sqrt:  [[ 2.18721758e+01  0.00000000e+00]
 [-8.04866772e-03  1.84418145e-02]]
grads:  [1.40145079e-03 1.26869545e+01]
Stock Position:  0.0014014507868129991
Bond Position:  [11.93375327]


portfolio before change:  [12.0867301]
curr_Stock_Price:  108.09157450295844
curr_Factors:  [1.08091575e+02 4.14772713e-02]
mat_Sqrt:  [[ 2.20138971e+01  0.00000000e+00]
 [-8.14638780e-03  1.86657194e-02]]
grads:  [-8.73897773e-03  3.77502070e+01]
Stock Position:  -0.008738977725229195
Bond Position:  [13.03133996]


portfolio before change:  [12.10577799]
curr_Stock_Price:  106.09833528025263
curr_Factors:  [1.06098335e+02 4.23195461e-02]
mat_Sqrt:  [[ 2.18262472e+01  0.00000000e+00]
 [-8.22868603e-03  1.88542883e-02]]
grads:  [-0.00528785  0.50059421]
Stock Position:  -0.005287846439452952
Bond Position:  [12.6668097]


portfolio before change:  [12.11295997]
curr_Stock_Price:  105.03958093906515
curr_Factors:  [1.05039581e+02 4.42405159e-02]
mat_Sqrt:  [[ 2.20934263e+01  0.00000000e+00]
 [-8.41337182e-03  1.92774566e-02]]
grads:  [ 0.00328345 -0.61974924]
Stock Position:  0.0032834471158674355
Bond Position:  [11.76806806]


portfolio before change:  [12.11502455]
curr_Stock_Price:  105.22032851319268
curr_Factors:  [1.05220329e+02 4.63076695e-02]
mat_Sqrt:  [[ 2.26425907e+01  0.00000000e+00]
 [-8.60768675e-03  1.97226880e-02]]
grads:  [-0.01073633 -0.57499956]
Stock Position:  -0.010736332397596306
Bond Position:  [13.24470497]


portfolio before change:  [12.12819716]
curr_Stock_Price:  104.14762359837906
curr_Factors:  [1.04147624e+02 4.72515269e-02]
mat_Sqrt:  [[ 2.26390025e+01  0.00000000e+00]
 [-8.69496653e-03  1.99226711e-02]]
grads:  [0.00448214 2.67780663]
Stock Position:  0.004482139685729318
Bond Position:  [11.66139296]


portfolio before change:  [12.12955837]
curr_Stock_Price:  104.12608117984013
curr_Factors:  [1.04126081e+02 4.79116142e-02]
mat_Sqrt:  [[ 2.27918682e+01  0.00000000e+00]
 [-8.75548872e-03  2.00613449e-02]]
grads:  [-0.00415357  4.05382324]
Stock Position:  -0.00415356958894397
Bond Position:  [12.56205329]


portfolio before change:  [12.13818075]
curr_Stock_Price:  102.42825662706174
curr_Factors:  [1.02428257e+02 4.93444823e-02]
mat_Sqrt:  [[ 2.27530216e+01  0.00000000e+00]
 [-8.88544719e-03  2.03591172e-02]]
grads:  [-0.01105542  2.35110549]
Stock Position:  -0.01105542202169599
Bond Position:  [13.27056836]


portfolio before change:  [12.14406512]
curr_Stock_Price:  102.04605078578092
curr_Factors:  [1.02046051e+02 4.94591357e-02]
mat_Sqrt:  [[ 2.26944396e+01  0.00000000e+00]
 [-8.89576400e-03  2.03827559e-02]]
grads:  [-5.26907940e-03 -1.09043245e+01]
Stock Position:  -0.00526907939523386
Bond Position:  [12.68175387]


portfolio before change:  [12.14548513]
curr_Stock_Price:  102.07742543317654
curr_Factors:  [1.02077425e+02 4.86000526e-02]
mat_Sqrt:  [[ 2.25033968e+01  0.00000000e+00]
 [-8.81816784e-03  2.02049608e-02]]
grads:  [-9.70248684e-04 -2.47744239e+00]
Stock Position:  -0.0009702486844800282
Bond Position:  [12.24452562]


portfolio before change:  [12.14622729]
curr_Stock_Price:  102.89010670876502
curr_Factors:  [1.02890107e+02 4.82216356e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.14622729]
Stock Price:  105.01924531123164
PL:  [7.12698197]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.47243408e+00  3.63679184e-01]
 [ 8.54418028e-01  9.08894361e-02]
 [ 1.10309585e-01 -1.78530720e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.80276176e-02  1.82790607e-01]
 [-1.16817376e-01 -7.60593245e-02]
 [ 9.12703051e-02  7.15778901e-02]
 [-1.72143001e-01  3.42944398e-01]
 [-1.12679301e-01 -1.00134048e-01]
 [-1.94853954e-01 -4.75509556e-01]
 [-6.20926745e-02 -1.47406325e-02]
 [-1.18299369e-04 -1.36162322e-01]
 [-9.99331030e-02 -2.45347975e-02]
 [-3.96572630e-02 -4.03059198e-02]
 [ 4.54894322e-01  2.89531146e-01]
 [ 1.29916768e-01 -5.66231467e-02]
 [ 3.96668886e-02  1.14846770e-01]
 [-4.14256353e-03  2.70470823e-02]
 [-7.91702629e-02 -2.46684144e-01]
 [-3.41468415e-02 -6.40654220e-02]
 [ 1.66528388e-01 -3.68524526e-02]
 [ 5.00919623e-01 -2.57455018e-01]
 [ 3.02177012e-02 -4.12290955e-01]
 [ 1.75064837e-02  2.26233853e-02]
 [ 1.39328534e-01 -6.05677127e-02]
 [ 1.61587667e-01 -9.22983482e-02]
 [ 1.44740287e-01 -1.74408865e-01]
 [ 4.87305938e-02  1.37366097e-01]
 [ 8.65601383e-02  9.80739241e-02]
 [-5.45591055e-01 -1.17062718e-01]
 [-1.65564729e-01 -6.05362177e-02]
 [ 9.87846982e-03 -6.10114973e-02]
 [-1.89471522e-01  1.45256000e-01]
 [ 5.80551053e-02  5.75294215e-02]
 [-1.03357167e-01  8.85787784e-02]
 [-2.61838968e-01  5.57569660e-02]
 [-2.57953694e-02 -1.92455206e-01]
 [-7.20593608e-03 -6.01045151e-02]
 [ 1.63329761e-02 -3.18450361e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.9295313]
curr_Stock_Price:  98.89521489102222
curr_Factors:  [9.88952149e+01 4.04315624e-02]
mat_Sqrt:  [[ 1.98854554e+01  0.00000000e+00]
 [-8.04304046e-03  1.84289209e-02]]
grads:  [ 0.08202763 19.73415516]
Stock Position:  0.08202762556156158
Bond Position:  [-13.04167096]


portfolio before change:  [-4.91804682]
curr_Stock_Price:  99.05509756401308
curr_Factors:  [9.90550976e+01 4.13562073e-02]
mat_Sqrt:  [[ 2.01440681e+01  0.00000000e+00]
 [-8.13449026e-03  1.86384587e-02]]
grads:  [0.04438455 4.87644594]
Stock Position:  0.044384551516235486
Bond Position:  [-9.3145629]


portfolio before change:  [-4.86312129]
curr_Stock_Price:  100.31882377809616
curr_Factors:  [1.00318824e+02 3.96654091e-02]
mat_Sqrt:  [[ 1.99796741e+01  0.00000000e+00]
 [-7.96647064e-03  1.82534774e-02]]
grads:  [ 0.00513111 -0.97806416]
Stock Position:  0.00513110797025745
Bond Position:  [-5.377868]


portfolio before change:  [-4.86675107]
curr_Stock_Price:  99.74243521281575
curr_Factors:  [9.97424352e+01 3.94886864e-02]
mat_Sqrt:  [[ 1.98205778e+01  0.00000000e+00]
 [-7.94870419e-03  1.82127693e-02]]
grads:  [-8.22446606e-04 -8.31212485e+00]
Stock Position:  -0.0008224466060368525
Bond Position:  [-4.78471825]


portfolio before change:  [-4.867052]
curr_Stock_Price:  99.38106946183625
curr_Factors:  [9.93810695e+01 4.05712184e-02]
mat_Sqrt:  [[ 2.00176315e+01  0.00000000e+00]
 [-8.05691935e-03  1.84607214e-02]]
grads:  [8.73601649e-05 9.90159610e+00]
Stock Position:  8.736016493313401e-05
Bond Position:  [-4.87573394]


portfolio before change:  [-4.86765802]
curr_Stock_Price:  99.42091165996042
curr_Factors:  [9.94209117e+01 4.16953576e-02]
mat_Sqrt:  [[ 2.03011945e+01  0.00000000e+00]
 [-8.16777646e-03  1.87147269e-02]]
grads:  [-0.00738934 -4.0641429 ]
Stock Position:  -0.0073893379189666295
Bond Position:  [-4.13300331]


portfolio before change:  [-4.87153395]
curr_Stock_Price:  99.87552156516702
curr_Factors:  [9.98755216e+01 4.08532558e-02]
mat_Sqrt:  [[ 2.01870285e+01  0.00000000e+00]
 [-8.08487534e-03  1.85247766e-02]]
grads:  [0.00606872 3.86390031]
Stock Position:  0.006068721664350552
Bond Position:  [-5.47765069]


portfolio before change:  [-4.86131506]
curr_Stock_Price:  101.67221508928405
curr_Factors:  [1.01672215e+02 3.94777898e-02]
mat_Sqrt:  [[ 2.02012713e+01  0.00000000e+00]
 [-7.94760742e-03  1.82102563e-02]]
grads:  [-1.11229608e-03  1.88324861e+01]
Stock Position:  -0.0011122960846577565
Bond Position:  [-4.74822546]


portfolio before change:  [-4.86404133]
curr_Stock_Price:  103.58960157416865
curr_Factors:  [1.03589602e+02 3.87590011e-02]
mat_Sqrt:  [[ 2.03940017e+01  0.00000000e+00]
 [-7.87492234e-03  1.80437138e-02]]
grads:  [-0.00766801 -5.54952536]
Stock Position:  -0.007668008713467819
Bond Position:  [-4.06971536]


portfolio before change:  [-4.8569832]
curr_Stock_Price:  102.60279123001594
curr_Factors:  [1.02602791e+02 3.89211340e-02]
mat_Sqrt:  [[ 2.02419300e+01  0.00000000e+00]
 [-7.89137595e-03  1.80814138e-02]]
grads:  [-1.98787042e-02 -2.62982508e+01]
Stock Position:  -0.019878704192037328
Bond Position:  [-2.81737267]


portfolio before change:  [-4.8419554]
curr_Stock_Price:  101.8290990434196
curr_Factors:  [1.01829099e+02 4.06281915e-02]
mat_Sqrt:  [[ 2.05251172e+01  0.00000000e+00]
 [-8.06257442e-03  1.84736788e-02]]
grads:  [-0.00333864 -0.79792621]
Stock Position:  -0.003338641778534014
Bond Position:  [-4.50198452]


portfolio before change:  [-4.83992559]
curr_Stock_Price:  101.05255787092614
curr_Factors:  [1.01052558e+02 4.01704337e-02]
mat_Sqrt:  [[ 2.02535227e+01  0.00000000e+00]
 [-8.01702526e-03  1.83693125e-02]]
grads:  [-2.93995318e-03 -7.41248871e+00]
Stock Position:  -0.002939953183670203
Bond Position:  [-4.5428358]


portfolio before change:  [-4.83883356]
curr_Stock_Price:  100.48794969225523
curr_Factors:  [1.00487950e+02 4.06493367e-02]
mat_Sqrt:  [[ 2.02600595e+01  0.00000000e+00]
 [-8.06467226e-03  1.84784855e-02]]
grads:  [-0.00546104 -1.32774937]
Stock Position:  -0.005461038571285742
Bond Position:  [-4.29006499]


portfolio before change:  [-4.841419]
curr_Stock_Price:  100.86318008388444
curr_Factors:  [1.0086318e+02 4.1413387e-02]
mat_Sqrt:  [[ 2.05259389e+01  0.00000000e+00]
 [-8.14011174e-03  1.86513391e-02]]
grads:  [-0.00278907 -2.16102016]
Stock Position:  -0.00278906649829989
Bond Position:  [-4.56010488]


portfolio before change:  [-4.83909747]
curr_Stock_Price:  99.82642458813733
curr_Factors:  [9.98264246e+01 4.24765577e-02]
mat_Sqrt:  [[ 2.05740681e+01  0.00000000e+00]
 [-8.24393670e-03  1.88892320e-02]]
grads:  [ 0.02825188 15.32784108]
Stock Position:  0.028251878546595676
Bond Position:  [-7.65938149]


portfolio before change:  [-4.86920777]
curr_Stock_Price:  98.79453509623777
curr_Factors:  [9.87945351e+01 4.39281332e-02]
mat_Sqrt:  [[ 2.07063855e+01  0.00000000e+00]
 [-8.38361575e-03  1.92092769e-02]]
grads:  [ 0.00508077 -2.94769798]
Stock Position:  0.005080770907602985
Bond Position:  [-5.37116017]


portfolio before change:  [-4.87147295]
curr_Stock_Price:  98.4808531333005
curr_Factors:  [9.84808531e+01 4.37805624e-02]
mat_Sqrt:  [[ 2.06059419e+01  0.00000000e+00]
 [-8.36952208e-03  1.91769842e-02]]
grads:  [4.35748722e-03 5.98878159e+00]
Stock Position:  0.0043574872184788905
Bond Position:  [-5.30060201]


portfolio before change:  [-4.87129308]
curr_Stock_Price:  98.67419485343106
curr_Factors:  [9.86741949e+01 4.39133796e-02]
mat_Sqrt:  [[ 2.06776901e+01  0.00000000e+00]
 [-8.38220779e-03  1.92060508e-02]]
grads:  [3.70532246e-04 1.40825839e+00]
Stock Position:  0.00037053224577799254
Bond Position:  [-4.90785505]


portfolio before change:  [-4.87157994]
curr_Stock_Price:  99.55578467158456
curr_Factors:  [9.95557847e+01 4.31566341e-02]
mat_Sqrt:  [[ 2.06818928e+01  0.00000000e+00]
 [-8.30966995e-03  1.90398458e-02]]
grads:  [-9.03360499e-03 -1.29562050e+01]
Stock Position:  -0.009033604988617232
Bond Position:  [-3.97223231]


portfolio before change:  [-4.88409992]
curr_Stock_Price:  100.88674957416879
curr_Factors:  [1.00886750e+02 4.26538561e-02]
mat_Sqrt:  [[ 2.08359487e+01  0.00000000e+00]
 [-8.26112400e-03  1.89286130e-02]]
grads:  [-2.98077543e-03 -3.38458090e+00]
Stock Position:  -0.0029807754295875545
Bond Position:  [-4.58337917]


portfolio before change:  [-4.88734414]
curr_Stock_Price:  101.782914035421
curr_Factors:  [1.01782914e+02 4.27743983e-02]
mat_Sqrt:  [[ 2.10507142e+01  0.00000000e+00]
 [-8.27278897e-03  1.89553408e-02]]
grads:  [ 0.00714677 -1.94417251]
Stock Position:  0.0071467721989524734
Bond Position:  [-5.61476344]


portfolio before change:  [-4.8820698]
curr_Stock_Price:  102.61912832766018
curr_Factors:  [1.02619128e+02 4.29394060e-02]
mat_Sqrt:  [[ 2.12645569e+01  0.00000000e+00]
 [-8.28873028e-03  1.89918670e-02]]
grads:  [  0.01827252 -13.55606685]
Stock Position:  0.018272520009405505
Bond Position:  [-6.75717987]


portfolio before change:  [-4.88663769]
curr_Stock_Price:  102.41536908130084
curr_Factors:  [1.02415369e+02 4.45535095e-02]
mat_Sqrt:  [[ 2.16175312e+01  0.00000000e+00]
 [-8.44308091e-03  1.93455287e-02]]
grads:  [-6.92589834e-03 -2.13119507e+01]
Stock Position:  -0.006925898336865956
Bond Position:  [-4.17731926]


portfolio before change:  [-4.87456471]
curr_Stock_Price:  100.59680716097758
curr_Factors:  [1.00596807e+02 4.47410262e-02]
mat_Sqrt:  [[ 2.12783117e+01  0.00000000e+00]
 [-8.46082986e-03  1.93861966e-02]]
grads:  [0.00128676 1.16698421]
Stock Position:  0.0012867627332426707
Bond Position:  [-5.00400894]


portfolio before change:  [-4.87587034]
curr_Stock_Price:  100.06827871558048
curr_Factors:  [1.00068279e+02 4.41897541e-02]
mat_Sqrt:  [[ 2.10357123e+01  0.00000000e+00]
 [-8.40854367e-03  1.92663939e-02]]
grads:  [ 0.00536681 -3.14369741]
Stock Position:  0.0053668074290754
Bond Position:  [-5.41291753]


portfolio before change:  [-4.87601503]
curr_Stock_Price:  100.16740119821114
curr_Factors:  [1.00167401e+02 4.48193314e-02]
mat_Sqrt:  [[ 2.12060164e+01  0.00000000e+00]
 [-8.46823064e-03  1.94031540e-02]]
grads:  [ 0.00572033 -4.75687346]
Stock Position:  0.0057203278297514315
Bond Position:  [-5.4490054]


portfolio before change:  [-4.87782734]
curr_Stock_Price:  99.96966003843075
curr_Factors:  [9.99696600e+01 4.56922439e-02]
mat_Sqrt:  [[ 2.13692588e+01  0.00000000e+00]
 [-8.55029767e-03  1.95911931e-02]]
grads:  [ 3.21124932e-03 -8.90241161e+00]
Stock Position:  0.003211249321381035
Bond Position:  [-5.19885485]


portfolio before change:  [-4.8803889]
curr_Stock_Price:  99.37435996158382
curr_Factors:  [9.937436e+01 4.544798e-02]
mat_Sqrt:  [[ 2.11851546e+01  0.00000000e+00]
 [-8.52741273e-03  1.95387572e-02]]
grads:  [5.13010530e-03 7.03044191e+00]
Stock Position:  0.005130105297828349
Bond Position:  [-5.39018983]


portfolio before change:  [-4.88194157]
curr_Stock_Price:  99.20304572413325
curr_Factors:  [9.92030457e+01 4.47422030e-02]
mat_Sqrt:  [[ 2.09837782e+01  0.00000000e+00]
 [-8.46094113e-03  1.93864516e-02]]
grads:  [0.00616491 5.0588899 ]
Stock Position:  0.006164910168625673
Bond Position:  [-5.49351944]


portfolio before change:  [-4.88521505]
curr_Stock_Price:  98.78345411064342
curr_Factors:  [9.87834541e+01 4.51277897e-02]
mat_Sqrt:  [[ 2.09848679e+01  0.00000000e+00]
 [-8.49732097e-03  1.94698083e-02]]
grads:  [-0.02843389 -6.01252548]
Stock Position:  -0.028433889456492643
Bond Position:  [-2.07641724]


portfolio before change:  [-4.88900096]
curr_Stock_Price:  98.90747321459934
curr_Factors:  [9.89074732e+01 4.59221149e-02]
mat_Sqrt:  [[ 2.11953234e+01  0.00000000e+00]
 [-8.57177833e-03  1.96404115e-02]]
grads:  [-0.00905789 -3.08222756]
Stock Position:  -0.009057889673283193
Bond Position:  [-3.99310798]


portfolio before change:  [-4.89479335]
curr_Stock_Price:  99.49184935714713
curr_Factors:  [9.94918494e+01 4.37634946e-02]
mat_Sqrt:  [[ 2.08134225e+01  0.00000000e+00]
 [-8.36789050e-03  1.91732458e-02]]
grads:  [-8.04727362e-04 -3.18211626e+00]
Stock Position:  -0.0008047273618209121
Bond Position:  [-4.81472953]


portfolio before change:  [-4.89583463]
curr_Stock_Price:  100.03787476790104
curr_Factors:  [1.00037875e+02 4.40561644e-02]
mat_Sqrt:  [[ 2.09975101e+01  0.00000000e+00]
 [-8.39582415e-03  1.92372498e-02]]
grads:  [-6.00435986e-03  7.55076743e+00]
Stock Position:  -0.00600435986240464
Bond Position:  [-4.29517123]


portfolio before change:  [-4.8990676]
curr_Stock_Price:  100.48688850488233
curr_Factors:  [1.00486889e+02 4.33505564e-02]
mat_Sqrt:  [[ 2.09221705e+01  0.00000000e+00]
 [-8.32831857e-03  1.90825751e-02]]
grads:  [0.00397487 3.01476195]
Stock Position:  0.003974874561445978
Bond Position:  [-5.29849038]


portfolio before change:  [-4.89973977]
curr_Stock_Price:  100.48441848870071
curr_Factors:  [1.00484418e+02 4.37423025e-02]
mat_Sqrt:  [[ 2.10159750e+01  0.00000000e+00]
 [-8.36586421e-03  1.91686030e-02]]
grads:  [-3.07852570e-03  4.62103463e+00]
Stock Position:  -0.0030785256982550175
Bond Position:  [-4.5903959]


portfolio before change:  [-4.90518934]
curr_Stock_Price:  102.06820801060775
curr_Factors:  [1.02068208e+02 4.45042440e-02]
mat_Sqrt:  [[ 2.15323388e+01  0.00000000e+00]
 [-8.43841160e-03  1.93348300e-02]]
grads:  [-0.01103014  2.88375777]
Stock Position:  -0.011030136351990492
Bond Position:  [-3.77936309]


portfolio before change:  [-4.91652399]
curr_Stock_Price:  103.05298275338843
curr_Factors:  [1.03052983e+02 4.40499755e-02]
mat_Sqrt:  [[ 2.16288487e+01  0.00000000e+00]
 [-8.39523441e-03  1.92358986e-02]]
grads:  [-5.07607728e-03 -1.00050021e+01]
Stock Position:  -0.005076077279489691
Bond Position:  [-4.39341909]


portfolio before change:  [-4.92161064]
curr_Stock_Price:  103.94687015079968
curr_Factors:  [1.03946870e+02 4.37760351e-02]
mat_Sqrt:  [[ 2.17485160e+01  0.00000000e+00]
 [-8.36908932e-03  1.91759927e-02]]
grads:  [-1.53747028e-03 -3.13436265e+00]
Stock Position:  -0.0015374702803160546
Bond Position:  [-4.76179542]


portfolio before change:  [-4.92152873]
curr_Stock_Price:  103.50642024233025
curr_Factors:  [1.03506420e+02 4.49574891e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.92152873]
Stock Price:  105.44595535554623
PL:  [-10.36748408]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.30767538e+00  3.24540417e-01]
 [ 2.28014872e-01  1.01333924e-01]
 [-2.34312387e-01 -1.17581602e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.11975367e-01 -2.64634943e-01]
 [-2.41664637e-01  5.86829038e-02]
 [ 1.54143643e-01 -1.39890522e-01]
 [-1.44873083e-01  3.51033941e-01]
 [-1.16790916e-01 -1.05347374e-01]
 [-2.19618680e-01 -4.93366214e-01]
 [-6.09389114e-02 -1.46774013e-02]
 [-1.65905410e-02 -1.36303245e-01]
 [-8.90747355e-02 -2.28090416e-02]
 [-4.01806300e-02 -3.99206441e-02]
 [ 3.93067069e-01  2.45949520e-01]
 [ 1.25738626e-01 -5.87120180e-01]
 [ 2.37007692e-02 -1.94681152e-01]
 [ 3.64175131e-02 -1.58310059e-01]
 [-1.16037778e-01 -2.77632379e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.38189359e-01 -2.74465500e-02]
 [ 5.47784276e-01 -2.15929420e-01]
 [ 2.91065278e-02 -3.40170205e-01]
 [ 1.25534789e-02  2.50757721e-02]
 [ 2.08610720e-01 -1.21395191e-01]
 [ 5.53759723e-02 -7.64654700e-02]
 [-1.88095488e-01 -8.14616387e-03]
 [-1.28585163e-02  2.14728650e-01]
 [-3.98192017e-02  1.92579593e-01]
 [-6.84867758e-01 -4.50976395e-02]
 [-1.56494008e-01 -3.46008496e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.62045213e-01  5.87890740e-02]
 [ 7.79041206e-02  5.35068812e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.55475795e-01  6.04902497e-02]
 [-2.33579468e-02 -2.13915144e-01]
 [ 3.41305360e-03 -2.48241202e-02]
 [ 9.05572478e-03 -1.09333840e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.27401882]
curr_Stock_Price:  100.0860009230934
curr_Factors:  [1.00086001e+02 4.04295086e-02]
mat_Sqrt:  [[ 2.01243827e+01  0.00000000e+00]
 [-8.04283618e-03  1.84284528e-02]]
grads:  [ 0.07201793 17.61083368]
Stock Position:  0.07201793191347583
Bond Position:  [-3.93396798]


portfolio before change:  [3.30841816]
curr_Stock_Price:  100.57047912956826
curr_Factors:  [1.00570479e+02 4.15224327e-02]
mat_Sqrt:  [[ 2.04933008e+01  0.00000000e+00]
 [-8.15082157e-03  1.86758784e-02]]
grads:  [0.01328437 5.42592545]
Stock Position:  0.013284371583507109
Bond Position:  [1.97240255]


portfolio before change:  [3.32505261]
curr_Stock_Price:  101.80410004905347
curr_Factors:  [1.01804100e+02 4.03578673e-02]
mat_Sqrt:  [[ 2.04516981e+01  0.00000000e+00]
 [-8.03570704e-03  1.84121179e-02]]
grads:  [-0.01396604 -6.38609868]
Stock Position:  -0.013966038603007925
Bond Position:  [4.7468526]


portfolio before change:  [3.34219787]
curr_Stock_Price:  100.61894876428399
curr_Factors:  [1.00618949e+02 4.04747962e-02]
mat_Sqrt:  [[ 2.02428711e+01  0.00000000e+00]
 [-8.04733955e-03  1.84387713e-02]]
grads:  [-8.05289271e-04 -8.21024405e+00]
Stock Position:  -0.0008052892713391563
Bond Position:  [3.42322523]


portfolio before change:  [3.34183244]
curr_Stock_Price:  101.60413890817934
curr_Factors:  [1.01604139e+02 4.04371988e-02]
mat_Sqrt:  [[ 2.04315790e+01  0.00000000e+00]
 [-8.04360106e-03  1.84302054e-02]]
grads:  [-1.11333306e-02 -1.43587626e+01]
Stock Position:  -0.01113333064989784
Bond Position:  [4.47302491]


portfolio before change:  [3.35214378]
curr_Stock_Price:  100.7281940982179
curr_Factors:  [1.00728194e+02 4.26958059e-02]
mat_Sqrt:  [[ 2.08134299e+01  0.00000000e+00]
 [-8.26518538e-03  1.89379188e-02]]
grads:  [-0.01038048  3.09869867]
Stock Position:  -0.010380476404119642
Bond Position:  [4.39775042]


portfolio before change:  [3.34655328]
curr_Stock_Price:  101.3197141315658
curr_Factors:  [1.01319714e+02 4.18358174e-02]
mat_Sqrt:  [[ 2.07237376e+01  0.00000000e+00]
 [-8.18152234e-03  1.87462227e-02]]
grads:  [ 4.49197030e-03 -7.46233117e+00]
Stock Position:  0.00449197030482628
Bond Position:  [2.89142813]


portfolio before change:  [3.34815207]
curr_Stock_Price:  101.59517120800027
curr_Factors:  [1.01595171e+02 4.22528312e-02]
mat_Sqrt:  [[ 2.08833888e+01  0.00000000e+00]
 [-8.22219739e-03  1.88394210e-02]]
grads:  [3.98914620e-04 1.86329475e+01]
Stock Position:  0.00039891461963085704
Bond Position:  [3.30762427]


portfolio before change:  [3.34916303]
curr_Stock_Price:  103.09292545386648
curr_Factors:  [1.03092925e+02 4.24628854e-02]
mat_Sqrt:  [[ 2.12438690e+01  0.00000000e+00]
 [-8.24260982e-03  1.88861917e-02]]
grads:  [-0.00766189 -5.57801043]
Stock Position:  -0.007661894355353046
Bond Position:  [4.13905013]


portfolio before change:  [3.35206852]
curr_Stock_Price:  102.78124280254566
curr_Factors:  [1.02781243e+02 4.30350873e-02]
mat_Sqrt:  [[ 2.13218660e+01  0.00000000e+00]
 [-8.29795998e-03  1.90130149e-02]]
grads:  [-2.03988408e-02 -2.59488680e+01]
Stock Position:  -0.02039884076622755
Bond Position:  [5.44868673]


portfolio before change:  [3.36471595]
curr_Stock_Price:  102.19462581473528
curr_Factors:  [1.02194626e+02 4.37703955e-02]
mat_Sqrt:  [[ 2.13805215e+01  0.00000000e+00]
 [-8.36855022e-03  1.91747574e-02]]
grads:  [-0.00314981 -0.76545434]
Stock Position:  -0.003149813470244791
Bond Position:  [3.68660996]


portfolio before change:  [3.36653695]
curr_Stock_Price:  101.76280867165114
curr_Factors:  [1.01762809e+02 4.44464512e-02]
mat_Sqrt:  [[ 2.14539681e+01  0.00000000e+00]
 [-8.43293080e-03  1.93222719e-02]]
grads:  [-3.54611109e-03 -7.05420389e+00]
Stock Position:  -0.0035461110935103963
Bond Position:  [3.72739918]


portfolio before change:  [3.37058319]
curr_Stock_Price:  100.75317328812653
curr_Factors:  [1.00753173e+02 4.41037820e-02]
mat_Sqrt:  [[ 2.11590736e+01  0.00000000e+00]
 [-8.40036018e-03  1.92476432e-02]]
grads:  [-0.00468023 -1.18503036]
Stock Position:  -0.004680234074775782
Bond Position:  [3.84213162]


portfolio before change:  [3.37094798]
curr_Stock_Price:  100.7778512242842
curr_Factors:  [1.00777851e+02 4.40054678e-02]
mat_Sqrt:  [[ 2.11406538e+01  0.00000000e+00]
 [-8.39099210e-03  1.92261782e-02]]
grads:  [-0.00272477 -2.07636919]
Stock Position:  -0.002724770382391299
Bond Position:  [3.64554449]


portfolio before change:  [3.37135438]
curr_Stock_Price:  100.79595504007354
curr_Factors:  [1.00795955e+02 4.60474661e-02]
mat_Sqrt:  [[ 2.16294747e+01  0.00000000e+00]
 [-8.58346933e-03  1.96671990e-02]]
grads:  [ 0.02313548 12.5055693 ]
Stock Position:  0.023135478152989122
Bond Position:  [1.03939176]


portfolio before change:  [3.41341468]
curr_Stock_Price:  102.60833900334214
curr_Factors:  [1.02608339e+02 4.50987633e-02]
mat_Sqrt:  [[ 2.17903885e+01  0.00000000e+00]
 [-8.49458776e-03  1.94635457e-02]]
grads:  [-5.98895368e-03 -3.01651194e+01]
Stock Position:  -0.0059889536816945255
Bond Position:  [4.02793127]


portfolio before change:  [3.40798865]
curr_Stock_Price:  103.5984198159654
curr_Factors:  [1.03598420e+02 4.50508534e-02]
mat_Sqrt:  [[ 2.19889576e+01  0.00000000e+00]
 [-8.49007452e-03  1.94532046e-02]]
grads:  [-2.78617352e-03 -1.00076649e+01]
Stock Position:  -0.0027861735178460454
Bond Position:  [3.69663183]


portfolio before change:  [3.40662164]
curr_Stock_Price:  104.25492019595595
curr_Factors:  [1.04254920e+02 4.45395022e-02]
mat_Sqrt:  [[ 2.20023586e+01  0.00000000e+00]
 [-8.44175358e-03  1.93424874e-02]]
grads:  [-1.48505266e-03 -8.18457607e+00]
Stock Position:  -0.0014850526618667783
Bond Position:  [3.56144568]


portfolio before change:  [3.4056867]
curr_Stock_Price:  105.18428106441257
curr_Factors:  [1.05184281e+02 4.41460955e-02]
mat_Sqrt:  [[ 2.21002401e+01  0.00000000e+00]
 [-8.40438890e-03  1.92568741e-02]]
grads:  [-1.07332084e-02 -1.44173129e+01]
Stock Position:  -0.010733208375906335
Bond Position:  [4.5346515]


portfolio before change:  [3.39004066]
curr_Stock_Price:  106.694817714612
curr_Factors:  [1.06694818e+02 4.44004288e-02]
mat_Sqrt:  [[ 2.24821017e+01  0.00000000e+00]
 [-8.42856371e-03  1.93122656e-02]]
grads:  [-2.15554002e-04 -5.64891720e+00]
Stock Position:  -0.00021555400249813445
Bond Position:  [3.41303915]


portfolio before change:  [3.39110969]
curr_Stock_Price:  103.71470061065054
curr_Factors:  [1.03714701e+02 4.67322981e-02]
mat_Sqrt:  [[ 2.24206855e+01  0.00000000e+00]
 [-8.64706175e-03  1.98129075e-02]]
grads:  [ 0.00562921 -1.38528633]
Stock Position:  0.005629208013243978
Bond Position:  [2.80727807]


portfolio before change:  [3.38266768]
curr_Stock_Price:  102.15267973453892
curr_Factors:  [1.02152680e+02 4.76553202e-02]
mat_Sqrt:  [[ 2.23000306e+01  0.00000000e+00]
 [-8.73203942e-03  2.00076158e-02]]
grads:  [  0.02033831 -10.79236138]
Stock Position:  0.02033831067116495
Bond Position:  [1.30505475]


portfolio before change:  [3.36180213]
curr_Stock_Price:  101.11873496583168
curr_Factors:  [1.01118735e+02 4.79518880e-02]
mat_Sqrt:  [[ 2.21428992e+01  0.00000000e+00]
 [-8.75916781e-03  2.00697748e-02]]
grads:  [-5.39025716e-03 -1.69493783e+01]
Stock Position:  -0.005390257161354094
Bond Position:  [3.90685812]


portfolio before change:  [3.36568752]
curr_Stock_Price:  100.48852439191074
curr_Factors:  [1.00488524e+02 4.85502566e-02]
mat_Sqrt:  [[ 2.21417648e+01  0.00000000e+00]
 [-8.81364910e-03  2.01946071e-02]]
grads:  [1.06122720e-03 1.24170636e+00]
Stock Position:  0.0010612272005944175
Bond Position:  [3.25904636]


portfolio before change:  [3.36644503]
curr_Stock_Price:  100.81843049198855
curr_Factors:  [1.00818430e+02 4.72674122e-02]
mat_Sqrt:  [[ 2.19190055e+01  0.00000000e+00]
 [-8.69642797e-03  1.99260197e-02]]
grads:  [ 0.00710021 -6.09229504]
Stock Position:  0.0071002087939406565
Bond Position:  [2.65061312]


portfolio before change:  [3.37488675]
curr_Stock_Price:  101.96070311034782
curr_Factors:  [1.01960703e+02 4.55324393e-02]
mat_Sqrt:  [[ 2.17567129e+01  0.00000000e+00]
 [-8.53533262e-03  1.95569039e-02]]
grads:  [ 1.01135247e-03 -3.90989649e+00]
Stock Position:  0.0010113524657249708
Bond Position:  [3.27176854]


portfolio before change:  [3.37515274]
curr_Stock_Price:  101.81930155087576
curr_Factors:  [1.01819302e+02 4.46881121e-02]
mat_Sqrt:  [[ 2.15241553e+01  0.00000000e+00]
 [-8.45582518e-03  1.93747295e-02]]
grads:  [-0.00890399 -0.42045304]
Stock Position:  -0.008903985408869138
Bond Position:  [4.28175032]


portfolio before change:  [3.36684699]
curr_Stock_Price:  102.81222822165907
curr_Factors:  [1.02812228e+02 4.45313217e-02]
mat_Sqrt:  [[ 2.16958947e+01  0.00000000e+00]
 [-8.44097831e-03  1.93407110e-02]]
grads:  [3.72682256e-03 1.11024176e+01]
Stock Position:  0.00372682256114747
Bond Position:  [2.98368406]


portfolio before change:  [3.36614563]
curr_Stock_Price:  102.52395492217549
curr_Factors:  [1.02523955e+02 4.55954853e-02]
mat_Sqrt:  [[ 2.18920420e+01  0.00000000e+00]
 [-8.54123976e-03  1.95704389e-02]]
grads:  [2.02034253e-03 9.84033086e+00]
Stock Position:  0.0020203425255022962
Bond Position:  [3.15901212]


portfolio before change:  [3.36847343]
curr_Stock_Price:  103.48067257813126
curr_Factors:  [1.03480673e+02 4.53853340e-02]
mat_Sqrt:  [[ 2.20453506e+01  0.00000000e+00]
 [-8.52153357e-03  1.95252863e-02]]
grads:  [-0.03195912 -2.30970439]
Stock Position:  -0.031959118875498786
Bond Position:  [6.67562455]


portfolio before change:  [3.37111688]
curr_Stock_Price:  103.42407061199724
curr_Factors:  [1.03424071e+02 4.43941909e-02]
mat_Sqrt:  [[ 2.17913783e+01  0.00000000e+00]
 [-8.42797161e-03  1.93109089e-02]]
grads:  [-0.00787445 -1.79177737]
Stock Position:  -0.007874447170753269
Bond Position:  [4.18552426]


portfolio before change:  [3.36648727]
curr_Stock_Price:  104.0784451288272
curr_Factors:  [1.04078445e+02 4.27446110e-02]
mat_Sqrt:  [[ 2.15179790e+01  0.00000000e+00]
 [-8.26990795e-03  1.89487396e-02]]
grads:  [ 0.00337126 -0.63050046]
Stock Position:  0.003371255109922485
Bond Position:  [3.01561228]


portfolio before change:  [3.36518879]
curr_Stock_Price:  103.58146184553674
curr_Factors:  [1.03581462e+02 4.16500271e-02]
mat_Sqrt:  [[ 2.11392551e+01  0.00000000e+00]
 [-8.16333531e-03  1.87045510e-02]]
grads:  [-0.0111824   3.14303583]
Stock Position:  -0.011182397694633259
Bond Position:  [4.52347789]


portfolio before change:  [3.37447072]
curr_Stock_Price:  102.80198077009679
curr_Factors:  [1.02801981e+02 4.11147301e-02]
mat_Sqrt:  [[ 2.08449186e+01  0.00000000e+00]
 [-8.11070701e-03  1.85839644e-02]]
grads:  [0.00485761 2.87919628]
Stock Position:  0.0048576077346034535
Bond Position:  [2.87509903]


portfolio before change:  [3.37293071]
curr_Stock_Price:  102.41096039525206
curr_Factors:  [1.02410960e+02 4.12174091e-02]
mat_Sqrt:  [[ 2.07915460e+01  0.00000000e+00]
 [-8.12082844e-03  1.86071555e-02]]
grads:  [-0.00455318  4.37063828]
Stock Position:  -0.004553178047211179
Bond Position:  [3.83922605]


portfolio before change:  [3.37595078]
curr_Stock_Price:  101.85307854620828
curr_Factors:  [1.01853079e+02 4.05837518e-02]
mat_Sqrt:  [[ 2.05187196e+01  0.00000000e+00]
 [-8.05816374e-03  1.84635726e-02]]
grads:  [-0.01116423  3.27619421]
Stock Position:  -0.011164229074715069
Bond Position:  [4.51306188]


portfolio before change:  [3.39052635]
curr_Stock_Price:  100.59805198623745
curr_Factors:  [1.00598052e+02 4.24053786e-02]
mat_Sqrt:  [[ 2.07157205e+01  0.00000000e+00]
 [-8.23702651e-03  1.88733987e-02]]
grads:  [-5.63427999e-03 -1.13342142e+01]
Stock Position:  -0.005634279988689232
Bond Position:  [3.95732394]


portfolio before change:  [3.39407117]
curr_Stock_Price:  100.05670109464255
curr_Factors:  [1.00056701e+02 4.42010849e-02]
mat_Sqrt:  [[ 2.10359749e+01  0.00000000e+00]
 [-8.40962162e-03  1.92688638e-02]]
grads:  [-3.52780450e-04 -1.28830223e+00]
Stock Position:  -0.0003527804499010621
Bond Position:  [3.42936922]


portfolio before change:  [3.39454882]
curr_Stock_Price:  99.91793791885632
curr_Factors:  [9.99179379e+01 4.55705466e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.39454882]
Stock Price:  102.65461062423172
PL:  [0.7399382]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.07231728e+00  2.71330667e-01]
 [-2.67703679e-01 -9.93403319e-02]
 [-3.09945496e-01 -1.36509340e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.02318843e-01 -1.23151937e-01]
 [-3.38420586e-01  1.65858926e-01]
 [ 2.25363086e-01 -2.45573779e-01]
 [-6.79046030e-01  7.31504827e-02]
 [-1.06608265e-01 -7.66795489e-02]
 [-3.83094892e-01 -6.09280889e-01]
 [-7.89538434e-02 -1.05863271e-02]
 [-5.40693477e-03 -1.36247017e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-1.10654592e-01  1.84957257e-01]
 [ 3.93563775e-01  2.70062145e-01]
 [ 1.31352100e-01  3.63577825e-02]
 [ 4.06567062e-02  1.24639663e-01]
 [ 2.90110849e-01  6.63850473e-02]
 [ 2.22008828e-01  2.31506672e-01]
 [-4.11146450e-01  1.63557610e-01]
 [ 1.16452663e-01  5.36383820e-02]
 [ 1.36083549e+00  1.46736841e-01]
 [ 1.59924288e-02  4.14000436e-01]
 [-1.34659146e-01  1.17959519e-01]
 [-2.02731407e-01  1.32482858e-01]
 [ 1.95387563e-01 -7.98375415e-02]
 [-2.02462241e-01 -4.46623714e-01]
 [ 6.32267729e-02  6.76485771e-02]
 [ 3.68450359e-01 -1.53076956e-01]
 [-5.21279547e-01 -2.27403796e-01]
 [-6.84238900e-02 -2.21546129e-02]
 [-3.25145991e-04 -4.72167907e-02]
 [ 6.26547193e-02  1.85538474e-01]
 [ 1.34050881e-02  2.58408208e-04]
 [ 7.58114964e-02 -3.22931904e-02]
 [-9.75134059e-02  1.18169571e-01]
 [-3.56963857e-02 -1.04262159e-01]
 [-1.04197823e-01 -6.00309419e-02]
 [ 1.17265360e-01 -9.99773272e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.29121298]
curr_Stock_Price:  101.10458149732683
curr_Factors:  [1.01104581e+02 3.89031839e-02]
mat_Sqrt:  [[ 1.99417565e+01  0.00000000e+00]
 [-7.88955603e-03  1.80772438e-02]]
grads:  [ 0.05971067 15.00951526]
Stock Position:  0.05971067241938442
Bond Position:  [4.25419044]


portfolio before change:  [10.35221059]
curr_Stock_Price:  102.11722791562444
curr_Factors:  [1.02117228e+02 3.75852821e-02]
mat_Sqrt:  [[ 1.97973893e+01  0.00000000e+00]
 [-7.75476958e-03  1.77684093e-02]]
grads:  [-0.01571214 -5.59083991]
Stock Position:  -0.01571214009439306
Bond Position:  [11.95669078]


portfolio before change:  [10.35446109]
curr_Stock_Price:  102.06912386931128
curr_Factors:  [1.02069124e+02 3.75471768e-02]
mat_Sqrt:  [[ 1.97780300e+01  0.00000000e+00]
 [-7.75083756e-03  1.77593999e-02]]
grads:  [-0.01868351 -7.68659646]
Stock Position:  -0.01868351179234849
Bond Position:  [12.26147077]


portfolio before change:  [10.36916969]
curr_Stock_Price:  101.36391239962659
curr_Factors:  [1.01363912e+02 3.86688121e-02]
mat_Sqrt:  [[ 1.99325921e+01  0.00000000e+00]
 [-7.86575485e-03  1.80227085e-02]]
grads:  [-8.17824739e-04 -8.39978145e+00]
Stock Position:  -0.0008178247388703853
Bond Position:  [10.45206761]


portfolio before change:  [10.37072323]
curr_Stock_Price:  101.06195326752855
curr_Factors:  [1.01061953e+02 3.88354367e-02]
mat_Sqrt:  [[ 1.99159847e+01  0.00000000e+00]
 [-7.88268347e-03  1.80614968e-02]]
grads:  [-0.00783626 -6.81847899]
Stock Position:  -0.007836255992296285
Bond Position:  [11.16267057]


portfolio before change:  [10.368676]
curr_Stock_Price:  101.5012765097752
curr_Factors:  [1.01501277e+02 3.82531617e-02]
mat_Sqrt:  [[ 1.98520414e+01  0.00000000e+00]
 [-7.82336620e-03  1.79255839e-02]]
grads:  [-0.01340083  9.25263727]
Stock Position:  -0.01340082921163881
Bond Position:  [11.72887728]


portfolio before change:  [10.36041999]
curr_Stock_Price:  102.22677041323774
curr_Factors:  [1.0222677e+02 3.7639324e-02]
mat_Sqrt:  [[ 1.98328692e+01  0.00000000e+00]
 [-7.76034267e-03  1.77811789e-02]]
grads:  [ 5.95909248e-03 -1.38108829e+01]
Stock Position:  0.005959092477125198
Bond Position:  [9.75124121]


portfolio before change:  [10.37284899]
curr_Stock_Price:  104.10793298200772
curr_Factors:  [1.04107933e+02 3.85272082e-02]
mat_Sqrt:  [[ 2.04346683e+01  0.00000000e+00]
 [-7.85133957e-03  1.79896789e-02]]
grads:  [-0.03166778  4.06624726]
Stock Position:  -0.031667778057013984
Bond Position:  [13.6697159]


portfolio before change:  [10.37608636]
curr_Stock_Price:  104.05966455403842
curr_Factors:  [1.04059665e+02 3.83296435e-02]
mat_Sqrt:  [[ 2.03727573e+01  0.00000000e+00]
 [-7.83118316e-03  1.79434948e-02]]
grads:  [-0.00687555 -4.27338987]
Stock Position:  -0.006875552582633907
Bond Position:  [11.09155406]


portfolio before change:  [10.3769682]
curr_Stock_Price:  104.13306949045271
curr_Factors:  [1.04133069e+02 3.79513862e-02]
mat_Sqrt:  [[ 2.02862836e+01  0.00000000e+00]
 [-7.79244621e-03  1.78547373e-02]]
grads:  [-3.19923987e-02 -3.41243267e+01]
Stock Position:  -0.03199239869482184
Bond Position:  [13.70843487]


portfolio before change:  [10.3998321]
curr_Stock_Price:  103.47196741685582
curr_Factors:  [1.03471967e+02 3.81316994e-02]
mat_Sqrt:  [[ 2.02053225e+01  0.00000000e+00]
 [-7.81093586e-03  1.78971024e-02]]
grads:  [-0.00413624 -0.59151067]
Stock Position:  -0.004136241590177526
Bond Position:  [10.82781715]


portfolio before change:  [10.41020159]
curr_Stock_Price:  101.29222701526056
curr_Factors:  [1.01292227e+02 3.83892230e-02]
mat_Sqrt:  [[ 1.98463562e+01  0.00000000e+00]
 [-7.83726718e-03  1.79574351e-02]]
grads:  [-3.26861048e-03 -7.58722035e+00]
Stock Position:  -0.003268610482188803
Bond Position:  [10.74128643]


portfolio before change:  [10.41672262]
curr_Stock_Price:  99.70798061792374
curr_Factors:  [9.97079806e+01 3.80580973e-02]
mat_Sqrt:  [[ 1.94515161e+01  0.00000000e+00]
 [-7.80339386e-03  1.78798215e-02]]
grads:  [-0.00664981 -1.56888619]
Stock Position:  -0.006649810099493398
Bond Position:  [11.07976176]


portfolio before change:  [10.43513389]
curr_Stock_Price:  97.14757547218929
curr_Factors:  [9.71475755e+01 3.97847652e-02]
mat_Sqrt:  [[ 1.93771707e+01  0.00000000e+00]
 [-7.97844749e-03  1.82809198e-02]]
grads:  [-1.54473671e-03  1.01175028e+01]
Stock Position:  -0.0015447367147515467
Bond Position:  [10.58520131]


portfolio before change:  [10.43744163]
curr_Stock_Price:  96.51024037030857
curr_Factors:  [9.65102404e+01 4.02185288e-02]
mat_Sqrt:  [[ 1.93547019e+01  0.00000000e+00]
 [-8.02182311e-03  1.83803058e-02]]
grads:  [ 0.026424   14.69301698]
Stock Position:  0.026423995560827605
Bond Position:  [7.88725547]


portfolio before change:  [10.44714867]
curr_Stock_Price:  96.84028388693301
curr_Factors:  [9.68402839e+01 4.33116842e-02]
mat_Sqrt:  [[ 2.01538764e+01  0.00000000e+00]
 [-8.32458375e-03  1.90740176e-02]]
grads:  [0.0073048  1.90614181]
Stock Position:  0.00730479511650338
Bond Position:  [9.73975024]


portfolio before change:  [10.44766164]
curr_Stock_Price:  96.74382977738817
curr_Factors:  [9.67438298e+01 4.35699980e-02]
mat_Sqrt:  [[ 2.01937533e+01  0.00000000e+00]
 [-8.34937105e-03  1.91308124e-02]]
grads:  [4.70709498e-03 6.51512649e+00]
Stock Position:  0.004707094979345982
Bond Position:  [9.99227924]


portfolio before change:  [10.43676679]
curr_Stock_Price:  94.16390267696046
curr_Factors:  [9.41639027e+01 4.31569639e-02]
mat_Sqrt:  [[ 1.95618485e+01  0.00000000e+00]
 [-8.30970169e-03  1.90399185e-02]]
grads:  [0.01631153 3.48662455]
Stock Position:  0.016311528962973356
Bond Position:  [8.90080956]


portfolio before change:  [10.43887875]
curr_Stock_Price:  94.22516520957983
curr_Factors:  [9.42251652e+01 4.22197612e-02]
mat_Sqrt:  [[ 1.93608666e+01  0.00000000e+00]
 [-8.21897913e-03  1.88320470e-02]]
grads:  [ 0.01668555 12.29322929]
Stock Position:  0.01668554559503342
Bond Position:  [8.86668046]


portfolio before change:  [10.47318993]
curr_Stock_Price:  96.21507791437917
curr_Factors:  [9.62150779e+01 4.10937658e-02]
mat_Sqrt:  [[ 1.95043332e+01  0.00000000e+00]
 [-8.10863893e-03  1.85792258e-02]]
grads:  [-0.01741993  8.80325216]
Stock Position:  -0.017419926864866188
Bond Position:  [12.14924955]


portfolio before change:  [10.47697635]
curr_Stock_Price:  96.08490140525112
curr_Factors:  [9.60849014e+01 3.97922325e-02]
mat_Sqrt:  [[ 1.91670070e+01  0.00000000e+00]
 [-7.97919620e-03  1.82826353e-02]]
grads:  [0.00729704 2.93384303]
Stock Position:  0.007297037670107874
Bond Position:  [9.7758412]


portfolio before change:  [10.47916978]
curr_Stock_Price:  96.21802047700007
curr_Factors:  [9.62180205e+01 3.90935816e-02]
mat_Sqrt:  [[ 1.90243203e+01  0.00000000e+00]
 [-7.90883877e-03  1.81214262e-02]]
grads:  [0.07489764 8.09742237]
Stock Position:  0.07489764056250804
Bond Position:  [3.27266706]


portfolio before change:  [10.44147572]
curr_Stock_Price:  95.70928395010536
curr_Factors:  [9.57092840e+01 3.96431727e-02]
mat_Sqrt:  [[ 1.90562863e+01  0.00000000e+00]
 [-7.96423734e-03  1.82483602e-02]]
grads:  [1.03208479e-02 2.26869938e+01]
Stock Position:  0.010320847880741514
Bond Position:  [9.45367476]


portfolio before change:  [10.44943364]
curr_Stock_Price:  96.36583189623299
curr_Factors:  [9.63658319e+01 3.94068401e-02]
mat_Sqrt:  [[ 1.91297318e+01  0.00000000e+00]
 [-7.94046246e-03  1.81938851e-02]]
grads:  [-4.34806886e-03  6.48347055e+00]
Stock Position:  -0.0043480688641145005
Bond Position:  [10.86843891]


portfolio before change:  [10.45588674]
curr_Stock_Price:  95.19416963565178
curr_Factors:  [9.51941696e+01 3.96423452e-02]
mat_Sqrt:  [[ 1.89535262e+01  0.00000000e+00]
 [-7.96415421e-03  1.82481698e-02]]
grads:  [-0.0076456   7.26006278]
Stock Position:  -0.007645603590093913
Bond Position:  [11.18370363]


portfolio before change:  [10.45513732]
curr_Stock_Price:  95.47504673147114
curr_Factors:  [9.54750467e+01 4.02727669e-02]
mat_Sqrt:  [[ 1.91600048e+01  0.00000000e+00]
 [-8.02723035e-03  1.83926953e-02]]
grads:  [ 0.0083791  -4.34072005]
Stock Position:  0.008379100348959953
Bond Position:  [9.65514232]


portfolio before change:  [10.47105094]
curr_Stock_Price:  97.23020532102858
curr_Factors:  [9.72302053e+01 4.03986731e-02]
mat_Sqrt:  [[ 1.95427085e+01  0.00000000e+00]
 [-8.03976847e-03  1.84214238e-02]]
grads:  [-2.03341727e-02 -2.42447988e+01]
Stock Position:  -0.020334172728442304
Bond Position:  [12.44814673]


portfolio before change:  [10.47784772]
curr_Stock_Price:  96.97247818843769
curr_Factors:  [9.69724782e+01 3.90141947e-02]
mat_Sqrt:  [[ 1.91540148e+01  0.00000000e+00]
 [-7.90080449e-03  1.81030173e-02]]
grads:  [0.00484238 3.73686751]
Stock Position:  0.004842380754259646
Bond Position:  [10.00827006]


portfolio before change:  [10.47553713]
curr_Stock_Price:  96.23695182054345
curr_Factors:  [9.62369518e+01 3.91906385e-02]
mat_Sqrt:  [[ 1.90516690e+01  0.00000000e+00]
 [-7.91865024e-03  1.81439071e-02]]
grads:  [ 0.01583284 -8.43682431]
Stock Position:  0.01583284368536088
Bond Position:  [8.95183252]


portfolio before change:  [10.46931806]
curr_Stock_Price:  95.77347728367373
curr_Factors:  [9.57734773e+01 4.08412881e-02]
mat_Sqrt:  [[ 1.93550800e+01  0.00000000e+00]
 [-8.08369105e-03  1.85220631e-02]]
grads:  [ -0.03206015 -12.27745502]
Stock Position:  -0.032060146456303174
Bond Position:  [13.53982977]


portfolio before change:  [10.43916253]
curr_Stock_Price:  96.7668637657884
curr_Factors:  [9.67668638e+01 4.05645409e-02]
mat_Sqrt:  [[ 1.94894664e+01  0.00000000e+00]
 [-8.05625629e-03  1.84592021e-02]]
grads:  [-0.00400693 -1.20019341]
Stock Position:  -0.004006931449361908
Bond Position:  [10.82690072]


portfolio before change:  [10.4347888]
curr_Stock_Price:  98.19618073756322
curr_Factors:  [9.81961807e+01 3.81693354e-02]
mat_Sqrt:  [[ 1.91845623e+01  0.00000000e+00]
 [-7.81478961e-03  1.79059325e-02]]
grads:  [-1.09109828e-03 -2.63693559e+00]
Stock Position:  -0.0010910982758452756
Bond Position:  [10.54193049]


portfolio before change:  [10.43681712]
curr_Stock_Price:  97.54500584436107
curr_Factors:  [9.75450058e+01 3.79708740e-02]
mat_Sqrt:  [[ 1.90077336e+01  0.00000000e+00]
 [-7.79444663e-03  1.78593209e-02]]
grads:  [7.55641632e-03 1.03888874e+01]
Stock Position:  0.007556416317652808
Bond Position:  [9.69972645]


portfolio before change:  [10.43345638]
curr_Stock_Price:  96.93978708978513
curr_Factors:  [9.69397871e+01 3.91131125e-02]
mat_Sqrt:  [[ 1.91718159e+01  0.00000000e+00]
 [-7.91081412e-03  1.81259522e-02]]
grads:  [0.00070509 0.01425626]
Stock Position:  0.0007050905734446303
Bond Position:  [10.36510505]


portfolio before change:  [10.43520445]
curr_Stock_Price:  97.58134150530725
curr_Factors:  [9.75813415e+01 3.99829383e-02]
mat_Sqrt:  [[ 1.95121056e+01  0.00000000e+00]
 [-7.99829365e-03  1.83263930e-02]]
grads:  [ 0.00316304 -1.76211382]
Stock Position:  0.00316304113572568
Bond Position:  [10.12655066]


portfolio before change:  [10.43798879]
curr_Stock_Price:  98.0613984358106
curr_Factors:  [9.80613984e+01 4.06592796e-02]
mat_Sqrt:  [[ 1.97732438e+01  0.00000000e+00]
 [-8.06565852e-03  1.84807453e-02]]
grads:  [-2.32334043e-03  6.39419944e+00]
Stock Position:  -0.002323340428483201
Bond Position:  [10.6658188]


portfolio before change:  [10.43790406]
curr_Stock_Price:  98.67174255416917
curr_Factors:  [9.86717426e+01 4.09299342e-02]
mat_Sqrt:  [[ 1.99624261e+01  0.00000000e+00]
 [-8.09245912e-03  1.85421532e-02]]
grads:  [-4.06764800e-03 -5.62298011e+00]
Stock Position:  -0.004067647995155775
Bond Position:  [10.83926598]


portfolio before change:  [10.44138154]
curr_Stock_Price:  98.14994547812726
curr_Factors:  [9.81499455e+01 4.07868005e-02]
mat_Sqrt:  [[ 1.98221100e+01  0.00000000e+00]
 [-8.07829690e-03  1.85097035e-02]]
grads:  [-0.00657839 -3.24321467]
Stock Position:  -0.006578385169513642
Bond Position:  [11.08704969]


portfolio before change:  [10.45022224]
curr_Stock_Price:  97.01673045607262
curr_Factors:  [9.70167305e+01 4.26329404e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.45022224]
Stock Price:  94.36508057442614
PL:  [10.45022224]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.30594992e+00  3.24150327e-01]
 [ 8.10184705e-02  5.14261955e-02]
 [ 7.07666000e-02 -3.47140349e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.22766602e-02  1.63330026e-01]
 [-1.85582002e-01 -1.82430383e-03]
 [ 8.83223489e-02  9.20486051e-02]
 [ 5.49108755e-01  5.97837669e-01]
 [ 6.97522481e-03  3.50974203e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-2.44607796e-02  1.79198804e-02]
 [ 6.10948968e-02 -9.56308890e-02]
 [-1.14276133e-01 -6.07063621e-03]
 [-1.33393621e-01  3.62822140e-01]
 [ 2.62557380e-01  2.12165758e-01]
 [ 1.31482437e-01 -1.06635462e-01]
 [ 3.71616270e-02 -5.72785063e-02]
 [ 3.24260355e-01  6.51077126e-02]
 [ 8.98900366e-02  9.70802171e-02]
 [-3.57567908e-01  1.32277763e-01]
 [ 1.28409770e-01  3.41215604e-02]
 [ 1.42586969e+00  1.58573073e-01]
 [ 1.60478115e-02  4.05820650e-01]
 [-1.47832810e-01  1.69788025e-01]
 [-2.02074651e-01  1.31554693e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 4.35322835e-02 -4.56622282e-01]
 [ 7.71011085e-02  3.81137659e-02]
 [ 4.32476347e-01 -2.29477458e-01]
 [-5.14237782e-01 -2.60926752e-01]
 [ 7.12221802e-02  2.93650162e-02]
 [-8.53749253e-02  9.98953170e-02]
 [ 3.33891545e-01  2.15687778e-01]
 [ 2.41331523e-02 -1.01552688e-02]
 [ 2.07655224e-01 -1.50727105e-01]
 [ 7.92475688e-02  8.96398563e-02]
 [-6.56838748e-02  3.29473914e-01]
 [-3.69601967e-01 -1.39352671e-01]
 [ 2.22428092e-02  4.12934621e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.29370422]
curr_Stock_Price:  100.08885835725123
curr_Factors:  [1.00088858e+02 3.91001763e-02]
mat_Sqrt:  [[ 1.97913351e+01  0.00000000e+00]
 [-7.90950580e-03  1.81229545e-02]]
grads:  [ 0.07313406 17.8861745 ]
Stock Position:  0.07313406161450833
Bond Position:  [-4.02620051]


portfolio before change:  [3.34681898]
curr_Stock_Price:  100.82200591204284
curr_Factors:  [1.00822006e+02 3.81148480e-02]
mat_Sqrt:  [[ 1.96835048e+01  0.00000000e+00]
 [-7.80920974e-03  1.78931474e-02]]
grads:  [0.00525632 2.87407209]
Stock Position:  0.005256315045139966
Bond Position:  [2.81686675]


portfolio before change:  [3.34620356]
curr_Stock_Price:  100.63793349058706
curr_Factors:  [1.00637933e+02 3.79969790e-02]
mat_Sqrt:  [[ 1.96171650e+01  0.00000000e+00]
 [-7.79712552e-03  1.78654590e-02]]
grads:  [ 0.00283508 -1.94308106]
Stock Position:  0.0028350759708538594
Bond Position:  [3.06088738]


portfolio before change:  [3.34694604]
curr_Stock_Price:  100.76485756819245
curr_Factors:  [1.00764858e+02 3.93904356e-02]
mat_Sqrt:  [[ 1.99988253e+01  0.00000000e+00]
 [-7.93880954e-03  1.81900978e-02]]
grads:  [-8.15116223e-04 -8.32248479e+00]
Stock Position:  -0.0008151162231053653
Bond Position:  [3.42908111]


portfolio before change:  [3.34811223]
curr_Stock_Price:  99.8600432606025
curr_Factors:  [9.98600433e+01 4.03356634e-02]
mat_Sqrt:  [[ 2.00556320e+01  0.00000000e+00]
 [-8.03349622e-03  1.84070523e-02]]
grads:  [-5.48154898e-04  8.87323096e+00]
Stock Position:  -0.0005481548976018471
Bond Position:  [3.402851]


portfolio before change:  [3.34838474]
curr_Stock_Price:  100.13892427733325
curr_Factors:  [1.00138924e+02 4.02728959e-02]
mat_Sqrt:  [[ 2.00959875e+01  0.00000000e+00]
 [-8.02724320e-03  1.83927248e-02]]
grads:  [-0.0092744  -0.09918616]
Stock Position:  -0.009274398349342001
Bond Position:  [4.27711302]


portfolio before change:  [3.35435137]
curr_Stock_Price:  99.55323031674182
curr_Factors:  [9.95532303e+01 4.11130890e-02]
mat_Sqrt:  [[ 2.01857742e+01  0.00000000e+00]
 [-8.11054514e-03  1.85835935e-02]]
grads:  [0.00636565 4.95321882]
Stock Position:  0.00636565397365822
Bond Position:  [2.72062996]


portfolio before change:  [3.3533471]
curr_Stock_Price:  99.3420385852549
curr_Factors:  [9.93420386e+01 4.12358574e-02]
mat_Sqrt:  [[ 2.01730044e+01  0.00000000e+00]
 [-8.12264561e-03  1.86113192e-02]]
grads:  [ 0.04015398 32.12226191]
Stock Position:  0.04015398454248885
Bond Position:  [-0.63563158]


portfolio before change:  [3.28811805]
curr_Stock_Price:  97.71954486456367
curr_Factors:  [9.77195449e+01 4.14150903e-02]
mat_Sqrt:  [[ 1.98866093e+01  0.00000000e+00]
 [-8.14027914e-03  1.86517227e-02]]
grads:  [8.05330474e-03 1.88172540e+01]
Stock Position:  0.008053304736695055
Bond Position:  [2.50115278]


portfolio before change:  [3.28720729]
curr_Stock_Price:  97.56762925618843
curr_Factors:  [9.75676293e+01 4.08878557e-02]
mat_Sqrt:  [[ 1.97289022e+01  0.00000000e+00]
 [-8.08829829e-03  1.85326196e-02]]
grads:  [0.01249102 6.10148679]
Stock Position:  0.012491023787529245
Bond Position:  [2.06848772]


portfolio before change:  [3.27438076]
curr_Stock_Price:  96.52006766089092
curr_Factors:  [9.65200677e+01 4.01553618e-02]
mat_Sqrt:  [[ 1.93414660e+01  0.00000000e+00]
 [-8.01552112e-03  1.83658661e-02]]
grads:  [-8.60322715e-04  9.75716598e-01]
Stock Position:  -0.0008603227145108912
Bond Position:  [3.35741916]


portfolio before change:  [3.27576161]
curr_Stock_Price:  95.40287344337841
curr_Factors:  [9.54028734e+01 4.12101537e-02]
mat_Sqrt:  [[ 1.93670544e+01  0.00000000e+00]
 [-8.12011366e-03  1.86055178e-02]]
grads:  [ 9.99540495e-04 -5.13992087e+00]
Stock Position:  0.0009995404954237475
Bond Position:  [3.18040257]


portfolio before change:  [3.27666621]
curr_Stock_Price:  95.91013572469804
curr_Factors:  [9.59101357e+01 4.33069907e-02]
mat_Sqrt:  [[ 1.99592174e+01  0.00000000e+00]
 [-8.32413269e-03  1.90729841e-02]]
grads:  [-0.00585822 -0.31828455]
Stock Position:  -0.005858224470474286
Bond Position:  [3.83852931]


portfolio before change:  [3.28146399]
curr_Stock_Price:  95.1730638789071
curr_Factors:  [9.51730639e+01 4.42068572e-02]
mat_Sqrt:  [[ 2.00105429e+01  0.00000000e+00]
 [-8.41017072e-03  1.92701220e-02]]
grads:  [1.24708972e-03 1.88282223e+01]
Stock Position:  0.001247089723738702
Bond Position:  [3.16277464]


portfolio before change:  [3.28181419]
curr_Stock_Price:  95.13684217783
curr_Factors:  [9.51368422e+01 4.48223465e-02]
mat_Sqrt:  [[ 2.01416955e+01  0.00000000e+00]
 [-8.46851548e-03  1.94038066e-02]]
grads:  [ 0.01763278 10.93423379]
Stock Position:  0.017632781091545507
Bond Position:  [1.60428708]


portfolio before change:  [3.25978247]
curr_Stock_Price:  93.87599351612093
curr_Factors:  [9.38759935e+01 4.65050193e-02]
mat_Sqrt:  [[ 2.02443791e+01  0.00000000e+00]
 [-8.62600897e-03  1.97646695e-02]]
grads:  [ 4.19587609e-03 -5.39525654e+00]
Stock Position:  0.004195876087380663
Bond Position:  [2.86589043]


portfolio before change:  [3.25588958]
curr_Stock_Price:  92.86282017285775
curr_Factors:  [9.28628202e+01 4.66923470e-02]
mat_Sqrt:  [[ 2.00661808e+01  0.00000000e+00]
 [-8.64336481e-03  1.98044368e-02]]
grads:  [ 6.06156078e-04 -2.89220577e+00]
Stock Position:  0.0006061560776660053
Bond Position:  [3.19960022]


portfolio before change:  [3.25664933]
curr_Stock_Price:  93.45636311858294
curr_Factors:  [9.34563631e+01 4.57374294e-02]
mat_Sqrt:  [[ 1.99868684e+01  0.00000000e+00]
 [-8.55452436e-03  1.96008777e-02]]
grads:  [0.01764537 3.32167333]
Stock Position:  0.01764537016402049
Bond Position:  [1.60757721]


portfolio before change:  [3.29511869]
curr_Stock_Price:  95.62511331022199
curr_Factors:  [9.56251133e+01 4.47110672e-02]
mat_Sqrt:  [[ 2.02199222e+01  0.00000000e+00]
 [-8.45799667e-03  1.93797050e-02]]
grads:  [0.00654104 5.00937539]
Stock Position:  0.00654103984006048
Bond Position:  [2.66963102]


portfolio before change:  [3.30291701]
curr_Stock_Price:  96.76630652728733
curr_Factors:  [9.67663065e+01 4.23834068e-02]
mat_Sqrt:  [[ 1.99215028e+01  0.00000000e+00]
 [-8.23489228e-03  1.88685086e-02]]
grads:  [-0.01505093  7.01050441]
Stock Position:  -0.015050930782475932
Bond Position:  [4.75933999]


portfolio before change:  [3.30546186]
curr_Stock_Price:  96.63675294071659
curr_Factors:  [9.66367529e+01 4.33339218e-02]
mat_Sqrt:  [[ 2.01166809e+01  0.00000000e+00]
 [-8.32672054e-03  1.90789136e-02]]
grads:  [0.00712352 1.78844357]
Stock Position:  0.007123523033162559
Bond Position:  [2.61706773]


portfolio before change:  [3.29947551]
curr_Stock_Price:  95.75046275254194
curr_Factors:  [9.57504628e+01 4.28024733e-02]
mat_Sqrt:  [[ 1.98095821e+01  0.00000000e+00]
 [-8.27550345e-03  1.89615605e-02]]
grads:  [0.0754724  8.36287042]
Stock Position:  0.07547239729246055
Bond Position:  [-3.92704146]


portfolio before change:  [3.3111296]
curr_Stock_Price:  95.91138251049824
curr_Factors:  [9.59113825e+01 4.37650341e-02]
mat_Sqrt:  [[ 2.00647516e+01  0.00000000e+00]
 [-8.36803767e-03  1.91735830e-02]]
grads:  [9.62695517e-03 2.11656136e+01]
Stock Position:  0.009626955173379304
Bond Position:  [2.38779502]


portfolio before change:  [3.29496253]
curr_Stock_Price:  94.20102258244995
curr_Factors:  [9.42010226e+01 4.29941074e-02]
mat_Sqrt:  [[ 1.95326013e+01  0.00000000e+00]
 [-8.29400819e-03  1.90039602e-02]]
grads:  [-3.77477835e-03  8.93434964e+00]
Stock Position:  -0.0037747783454867207
Bond Position:  [3.65055051]


portfolio before change:  [3.29182596]
curr_Stock_Price:  95.15284617392133
curr_Factors:  [9.51528462e+01 4.33088004e-02]
mat_Sqrt:  [[ 1.98020367e+01  0.00000000e+00]
 [-8.32430661e-03  1.90733826e-02]]
grads:  [-0.00730528  6.89729219]
Stock Position:  -0.007305282718952529
Bond Position:  [3.9869444]


portfolio before change:  [3.30115438]
curr_Stock_Price:  93.94412915268927
curr_Factors:  [9.39441292e+01 4.24402345e-02]
mat_Sqrt:  [[ 1.93534561e+01  0.00000000e+00]
 [-8.24041110e-03  1.88811538e-02]]
grads:  [ 0.00948041 -3.86605278]
Stock Position:  0.009480405025068056
Bond Position:  [2.41052598]


portfolio before change:  [3.30634492]
curr_Stock_Price:  94.45984635719573
curr_Factors:  [9.44598464e+01 4.23939253e-02]
mat_Sqrt:  [[ 1.94490794e+01  0.00000000e+00]
 [-8.23591407e-03  1.88708498e-02]]
grads:  [-8.00829771e-03 -2.41972294e+01]
Stock Position:  -0.008008297709688852
Bond Position:  [4.06280749]


portfolio before change:  [3.30179417]
curr_Stock_Price:  95.09152053244405
curr_Factors:  [9.50915205e+01 4.25371745e-02]
mat_Sqrt:  [[ 1.96121909e+01  0.00000000e+00]
 [-8.24981692e-03  1.89027052e-02]]
grads:  [0.00477944 2.01631276]
Stock Position:  0.0047794415354243495
Bond Position:  [2.8473098]


portfolio before change:  [3.30395959]
curr_Stock_Price:  95.4701186946674
curr_Factors:  [9.54701187e+01 4.15966210e-02]
mat_Sqrt:  [[ 1.94713691e+01  0.00000000e+00]
 [-8.15809988e-03  1.86925551e-02]]
grads:  [  0.01706732 -12.27640931]
Stock Position:  0.01706732442832047
Bond Position:  [1.6745401]


portfolio before change:  [3.29372283]
curr_Stock_Price:  94.85806648208207
curr_Factors:  [9.48580665e+01 4.21906262e-02]
mat_Sqrt:  [[ 1.94841854e+01  0.00000000e+00]
 [-8.21614276e-03  1.88255481e-02]]
grads:  [ -0.0322372  -13.86024734]
Stock Position:  -0.032237198531964814
Bond Position:  [6.35168115]


portfolio before change:  [3.27636569]
curr_Stock_Price:  95.4211163592793
curr_Factors:  [9.54211164e+01 4.11998778e-02]
mat_Sqrt:  [[ 1.93683425e+01  0.00000000e+00]
 [-8.11910121e-03  1.86031979e-02]]
grads:  [0.00433894 1.57849292]
Stock Position:  0.004338942472104782
Bond Position:  [2.86233895]


portfolio before change:  [3.27588167]
curr_Stock_Price:  95.22709988505608
curr_Factors:  [9.52270999e+01 4.16683808e-02]
mat_Sqrt:  [[ 1.94385502e+01  0.00000000e+00]
 [-8.16513376e-03  1.87086717e-02]]
grads:  [-2.14918470e-03  5.33951947e+00]
Stock Position:  -0.0021491847012785575
Bond Position:  [3.4805423]


portfolio before change:  [3.27706296]
curr_Stock_Price:  94.87990433509346
curr_Factors:  [9.48799043e+01 4.10115594e-02]
mat_Sqrt:  [[ 1.92144244e+01  0.00000000e+00]
 [-8.10052437e-03  1.85606331e-02]]
grads:  [ 0.02227625 11.62071234]
Stock Position:  0.02227625451155329
Bond Position:  [1.16349406]


portfolio before change:  [3.30275888]
curr_Stock_Price:  96.02688716168704
curr_Factors:  [9.60268872e+01 4.10798991e-02]
mat_Sqrt:  [[ 1.94628993e+01  0.00000000e+00]
 [-8.10727073e-03  1.85760909e-02]]
grads:  [ 0.00101224 -0.54668492]
Stock Position:  0.001012235092390183
Bond Position:  [3.2055571]


portfolio before change:  [3.30244184]
curr_Stock_Price:  95.31779824528647
curr_Factors:  [9.53177982e+01 4.20920088e-02]
mat_Sqrt:  [[ 1.95557208e+01  0.00000000e+00]
 [-8.20653484e-03  1.88035335e-02]]
grads:  [ 7.25478358e-03 -8.01589259e+00]
Stock Position:  0.0072547835782830195
Bond Position:  [2.61093184]


portfolio before change:  [3.29712387]
curr_Stock_Price:  94.53977974889659
curr_Factors:  [9.45397797e+01 4.03525205e-02]
mat_Sqrt:  [[ 1.89910912e+01  0.00000000e+00]
 [-8.03517472e-03  1.84108982e-02]]
grads:  [0.0062329  4.86884753]
Stock Position:  0.006232901948671059
Bond Position:  [2.70786669]


portfolio before change:  [3.28716081]
curr_Stock_Price:  92.88700866759204
curr_Factors:  [9.28870087e+01 4.05482399e-02]
mat_Sqrt:  [[ 1.87042794e+01  0.00000000e+00]
 [-8.05463741e-03  1.84554928e-02]]
grads:  [4.17606733e-03 1.78523498e+01]
Stock Position:  0.004176067325005324
Bond Position:  [2.89925841]


portfolio before change:  [3.28508755]
curr_Stock_Price:  92.30375751835822
curr_Factors:  [9.23037575e+01 3.93397839e-02]
mat_Sqrt:  [[ 1.83077665e+01  0.00000000e+00]
 [-7.93370369e-03  1.81783988e-02]]
grads:  [-0.02351027 -7.66583855]
Stock Position:  -0.023510265879604197
Bond Position:  [5.45517343]


portfolio before change:  [3.27878769]
curr_Stock_Price:  92.60072576970809
curr_Factors:  [9.26007258e+01 3.94158344e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.27878769]
Stock Price:  94.77709162753457
PL:  [3.27878769]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.47693425e+00  3.64103452e-01]
 [ 3.82146883e-01  1.16990131e-01]
 [ 1.07035887e-01 -4.80947866e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.15949279e-01 -3.24935533e-01]
 [-3.50787881e-01  1.80098239e-01]
 [ 1.10587322e-01 -1.43175301e-02]
 [ 8.35747704e-03  3.91034078e-01]
 [-1.18017250e-01 -9.77055192e-02]
 [-1.50258124e-02 -2.26795002e-01]
 [-7.77731110e-02 -1.09245380e-02]
 [-1.65244935e-01 -2.00574254e-01]
 [-5.41127163e-02 -2.29728219e-02]
 [ 2.28381973e-02 -1.96213606e-01]
 [-7.82411254e-02 -1.00761425e-01]
 [ 9.68726867e-02 -9.22333217e-01]
 [ 1.74460086e-02 -3.21087486e-01]
 [ 3.31438770e-02 -1.54740715e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.49259314e-01 -3.11770184e-02]
 [ 3.64547206e-01 -3.63894371e-01]
 [ 2.70881619e-02 -3.30930580e-01]
 [ 3.68324673e-02  3.66396270e-02]
 [ 4.49149475e-01 -4.29796571e-01]
 [-5.16456125e-01  7.48102934e-02]
 [-1.18255428e-01  2.10863896e-01]
 [-8.82151530e-02 -8.62561995e-02]
 [-8.05439873e-02  2.13917172e-01]
 [-7.60949199e-01 -8.47180232e-03]
 [-1.25197081e-01  1.65819234e-03]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.47668755e-01  1.65977074e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.96387215e-01  2.99086480e-02]
 [-2.74405853e-02 -1.77221370e-01]
 [-6.26344232e-03 -5.90571663e-02]
 [-6.06952171e-02 -4.25136649e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.45257974]
curr_Stock_Price:  98.9644467777195
curr_Factors:  [9.89644468e+01 4.01761854e-02]
mat_Sqrt:  [[ 1.98364317e+01  0.00000000e+00]
 [-8.01759918e-03  1.83706276e-02]]
grads:  [ 0.08246655 19.81987006]
Stock Position:  0.08246654696181815
Bond Position:  [-12.61383594]


portfolio before change:  [-4.36023015]
curr_Stock_Price:  100.10341066016119
curr_Factors:  [1.00103411e+02 3.97538652e-02]
mat_Sqrt:  [[ 1.99589898e+01  0.00000000e+00]
 [-7.97534854e-03  1.82738192e-02]]
grads:  [0.02170478 6.40206239]
Stock Position:  0.021704784043581195
Bond Position:  [-6.53295306]


portfolio before change:  [-4.38399197]
curr_Stock_Price:  99.04626368346028
curr_Factors:  [9.90462637e+01 4.05623923e-02]
mat_Sqrt:  [[ 1.99480238e+01  0.00000000e+00]
 [-8.05604293e-03  1.84587133e-02]]
grads:  [ 0.00431349 -2.605533  ]
Stock Position:  0.004313490019168107
Bond Position:  [-4.81122704]


portfolio before change:  [-4.37587253]
curr_Stock_Price:  101.06803335581847
curr_Factors:  [1.01068033e+02 3.90823010e-02]
mat_Sqrt:  [[ 1.99803862e+01  0.00000000e+00]
 [-7.90769762e-03  1.81188115e-02]]
grads:  [-8.15868463e-04 -8.35522864e+00]
Stock Position:  -0.0008158684633806997
Bond Position:  [-4.29341431]


portfolio before change:  [-4.37704007]
curr_Stock_Price:  101.84123875204524
curr_Factors:  [1.01841239e+02 3.87440748e-02]
mat_Sqrt:  [[ 2.00459351e+01  0.00000000e+00]
 [-7.87340585e-03  1.80402391e-02]]
grads:  [-1.28586055e-02 -1.80117088e+01]
Stock Position:  -0.012858605533142638
Bond Position:  [-3.06750376]


portfolio before change:  [-4.37569833]
curr_Stock_Price:  101.70707122368245
curr_Factors:  [1.01707071e+02 3.67658541e-02]
mat_Sqrt:  [[ 1.95017452e+01  0.00000000e+00]
 [-7.66976965e-03  1.75736500e-02]]
grads:  [-0.01395704 10.24819767]
Stock Position:  -0.013957036281027813
Bond Position:  [-2.95616904]


portfolio before change:  [-4.36174586]
curr_Stock_Price:  100.68092150172888
curr_Factors:  [1.00680922e+02 3.70208153e-02]
mat_Sqrt:  [[ 1.93718087e+01  0.00000000e+00]
 [-7.69631760e-03  1.76344790e-02]]
grads:  [ 0.00538611 -0.81190548]
Stock Position:  0.005386107251203507
Bond Position:  [-4.9040241]


portfolio before change:  [-4.35973227]
curr_Stock_Price:  101.16858900342127
curr_Factors:  [1.01168589e+02 3.76590402e-02]
mat_Sqrt:  [[ 1.96327129e+01  0.00000000e+00]
 [-7.76237492e-03  1.77858353e-02]]
grads:  [9.11839035e-03 2.19857022e+01]
Stock Position:  0.00911839034838181
Bond Position:  [-5.28222696]


portfolio before change:  [-4.35443078]
curr_Stock_Price:  101.82241212471085
curr_Factors:  [1.01822412e+02 3.72571492e-02]
mat_Sqrt:  [[ 1.96538751e+01  0.00000000e+00]
 [-7.72084443e-03  1.76906770e-02]]
grads:  [-0.00817444 -5.52299491]
Stock Position:  -0.008174440626818495
Bond Position:  [-3.52208952]


portfolio before change:  [-4.35326113]
curr_Stock_Price:  101.62546462648609
curr_Factors:  [1.01625465e+02 3.88215087e-02]
mat_Sqrt:  [[ 2.00234427e+01  0.00000000e+00]
 [-7.88126982e-03  1.80582578e-02]]
grads:  [-5.69368954e-03 -1.25590744e+01]
Stock Position:  -0.005693689543229819
Bond Position:  [-3.77463729]


portfolio before change:  [-4.36315027]
curr_Stock_Price:  103.27945085946658
curr_Factors:  [1.03279451e+02 3.79541366e-02]
mat_Sqrt:  [[ 2.01207182e+01  0.00000000e+00]
 [-7.79272857e-03  1.78553843e-02]]
grads:  [-0.00410229 -0.61183438]
Stock Position:  -0.004102287477908625
Bond Position:  [-3.93946828]


portfolio before change:  [-4.36710815]
curr_Stock_Price:  104.12420195458868
curr_Factors:  [1.04124202e+02 3.70164220e-02]
mat_Sqrt:  [[ 2.00331344e+01  0.00000000e+00]
 [-7.69586091e-03  1.76334326e-02]]
grads:  [ -0.01261823 -11.37465735]
Stock Position:  -0.012618230933677404
Bond Position:  [-3.05324492]


portfolio before change:  [-4.36273515]
curr_Stock_Price:  103.74739158593641
curr_Factors:  [1.03747392e+02 3.56528278e-02]
mat_Sqrt:  [[ 1.95895373e+01  0.00000000e+00]
 [-7.55278257e-03  1.73055989e-02]]
grads:  [-0.00327414 -1.32747916]
Stock Position:  -0.0032741394983854684
Bond Position:  [-4.02305172]


portfolio before change:  [-4.36705832]
curr_Stock_Price:  104.91418917717299
curr_Factors:  [1.04914189e+02 3.46827941e-02]
mat_Sqrt:  [[ 1.95385022e+01  0.00000000e+00]
 [-7.44932685e-03  1.70685521e-02]]
grads:  [-3.21398438e-03 -1.14956210e+01]
Stock Position:  -0.003213984381333972
Bond Position:  [-4.02986576]


portfolio before change:  [-4.36996777]
curr_Stock_Price:  105.66269511110241
curr_Factors:  [1.05662695e+02 3.50643219e-02]
mat_Sqrt:  [[ 1.97858360e+01  0.00000000e+00]
 [-7.49018791e-03  1.71621765e-02]]
grads:  [-0.006177   -5.87113324]
Stock Position:  -0.006176995318563135
Bond Position:  [-3.7172898]


portfolio before change:  [-4.3672675]
curr_Stock_Price:  105.15031560179628
curr_Factors:  [1.05150316e+02 3.43429734e-02]
mat_Sqrt:  [[ 1.94863064e+01  0.00000000e+00]
 [-7.41274291e-03  1.69847277e-02]]
grads:  [-1.56862221e-02 -5.43036798e+01]
Stock Position:  -0.015686222131071507
Bond Position:  [-2.71785629]


portfolio before change:  [-4.37458309]
curr_Stock_Price:  105.59502707465708
curr_Factors:  [1.05595027e+02 3.39904207e-02]
mat_Sqrt:  [[ 1.94680179e+01  0.00000000e+00]
 [-7.37459647e-03  1.68973233e-02]]
grads:  [-6.30203135e-03 -1.90022692e+01]
Stock Position:  -0.006302031345630287
Bond Position:  [-3.70911992]


portfolio before change:  [-4.35896235]
curr_Stock_Price:  103.04276806012662
curr_Factors:  [1.03042768e+02 3.48374201e-02]
mat_Sqrt:  [[ 1.92327112e+01  0.00000000e+00]
 [-7.46591402e-03  1.71065581e-02]]
grads:  [-1.78812583e-03 -9.04569547e+00]
Stock Position:  -0.00178812582916212
Bond Position:  [-4.17470891]


portfolio before change:  [-4.35882433]
curr_Stock_Price:  102.67372754297207
curr_Factors:  [1.02673728e+02 3.50379908e-02]
mat_Sqrt:  [[ 1.92189177e+01  0.00000000e+00]
 [-7.48737506e-03  1.71557315e-02]]
grads:  [-1.65864254e-02 -2.73545692e+01]
Stock Position:  -0.01658642541086782
Bond Position:  [-2.6558342]


portfolio before change:  [-4.37641668]
curr_Stock_Price:  103.71435858106032
curr_Factors:  [1.03714359e+02 3.46456863e-02]
mat_Sqrt:  [[ 1.93047184e+01  0.00000000e+00]
 [-7.44534069e-03  1.70594187e-02]]
grads:  [-2.51032256e-04 -6.39490662e+00]
Stock Position:  -0.00025103225624494973
Bond Position:  [-4.35038103]


portfolio before change:  [-4.37677341]
curr_Stock_Price:  102.96903097655895
curr_Factors:  [1.02969031e+02 3.51154067e-02]
mat_Sqrt:  [[ 1.92954751e+01  0.00000000e+00]
 [-7.49564211e-03  1.71746737e-02]]
grads:  [ 0.00703028 -1.81529029]
Stock Position:  0.0070302776743036005
Bond Position:  [-5.10067429]


portfolio before change:  [-4.3671659]
curr_Stock_Price:  104.4263171621232
curr_Factors:  [1.04426317e+02 3.50130570e-02]
mat_Sqrt:  [[ 1.95400188e+01  0.00000000e+00]
 [-7.48471049e-03  1.71496262e-02]]
grads:  [ 1.05286839e-02 -2.12187932e+01]
Stock Position:  0.010528683932301828
Bond Position:  [-5.46663759]


portfolio before change:  [-4.36318094]
curr_Stock_Price:  104.86970941028744
curr_Factors:  [1.04869709e+02 3.45502585e-02]
mat_Sqrt:  [[ 1.94928668e+01  0.00000000e+00]
 [-7.43507994e-03  1.70359083e-02]]
grads:  [-6.01972944e-03 -1.94254732e+01]
Stock Position:  -0.0060197294414141705
Bond Position:  [-3.73189366]


portfolio before change:  [-4.35939492]
curr_Stock_Price:  104.16327611786632
curr_Factors:  [1.04163276e+02 3.39293939e-02]
mat_Sqrt:  [[ 1.91868059e+01  0.00000000e+00]
 [-7.36797328e-03  1.68821476e-02]]
grads:  [0.00275311 2.17031789]
Stock Position:  0.002753106062354918
Bond Position:  [-4.64616746]


portfolio before change:  [-4.3566424]
curr_Stock_Price:  105.37402685339444
curr_Factors:  [1.05374027e+02 3.33615792e-02]
mat_Sqrt:  [[ 1.92467266e+01  0.00000000e+00]
 [-7.30606096e-03  1.67402887e-02]]
grads:  [ 1.35904083e-02 -2.56743823e+01]
Stock Position:  0.013590408296790011
Bond Position:  [-5.78871845]


portfolio before change:  [-4.33936185]
curr_Stock_Price:  106.69879817001305
curr_Factors:  [1.06698798e+02 3.37046194e-02]
mat_Sqrt:  [[ 1.95886380e+01  0.00000000e+00]
 [-7.34352715e-03  1.68261345e-02]]
grads:  [-0.02469831  4.44607722]
Stock Position:  -0.02469830908043779
Bond Position:  [-1.70408196]


portfolio before change:  [-4.36042425]
curr_Stock_Price:  107.54296005153572
curr_Factors:  [1.07542960e+02 3.49718958e-02]
mat_Sqrt:  [[ 2.01113662e+01  0.00000000e+00]
 [-7.48030970e-03  1.71395427e-02]]
grads:  [-1.30408244e-03  1.23027725e+01]
Stock Position:  -0.0013040824399705656
Bond Position:  [-4.22017936]


portfolio before change:  [-4.3584098]
curr_Stock_Price:  105.59369511814643
curr_Factors:  [1.05593695e+02 3.49298316e-02]
mat_Sqrt:  [[ 1.97349593e+01  0.00000000e+00]
 [-7.47580970e-03  1.71292319e-02]]
grads:  [-0.00637754 -5.03561397]
Stock Position:  -0.0063775376072442444
Bond Position:  [-3.68498204]


portfolio before change:  [-4.35870561]
curr_Stock_Price:  105.56784879827
curr_Factors:  [1.05567849e+02 3.59006404e-02]
mat_Sqrt:  [[ 2.00024305e+01  0.00000000e+00]
 [-7.57898573e-03  1.73656379e-02]]
grads:  [6.40778162e-04 1.23184172e+01]
Stock Position:  0.000640778161800186
Bond Position:  [-4.42635119]


portfolio before change:  [-4.35980651]
curr_Stock_Price:  104.71330812213769
curr_Factors:  [1.04713308e+02 3.54445727e-02]
mat_Sqrt:  [[ 1.97140908e+01  0.00000000e+00]
 [-7.53069162e-03  1.72549822e-02]]
grads:  [-0.03878681 -0.49097717]
Stock Position:  -0.0387868050583214
Bond Position:  [-0.29831184]


portfolio before change:  [-4.39989008]
curr_Stock_Price:  105.74577976764053
curr_Factors:  [1.05745780e+02 3.51884549e-02]
mat_Sqrt:  [[ 1.98364130e+01  0.00000000e+00]
 [-7.50343440e-03  1.71925281e-02]]
grads:  [-0.00627499  0.09644843]
Stock Position:  -0.006274994674019479
Bond Position:  [-3.73633588]


portfolio before change:  [-4.39897802]
curr_Stock_Price:  105.52599697154655
curr_Factors:  [1.05525997e+02 3.48301255e-02]
mat_Sqrt:  [[ 1.96941383e+01  0.00000000e+00]
 [-7.46513234e-03  1.71047670e-02]]
grads:  [ 0.00368346 -0.69847132]
Stock Position:  0.003683461320418799
Bond Position:  [-4.78767895]


portfolio before change:  [-4.40309081]
curr_Stock_Price:  104.57192375967816
curr_Factors:  [1.04571924e+02 3.61356254e-02]
mat_Sqrt:  [[ 1.98784668e+01  0.00000000e+00]
 [-7.60374911e-03  1.74223779e-02]]
grads:  [-0.01209474  0.95266602]
Stock Position:  -0.012094741707845023
Bond Position:  [-3.1383204]


portfolio before change:  [-4.38260525]
curr_Stock_Price:  102.84572982618488
curr_Factors:  [1.02845730e+02 3.83985428e-02]
mat_Sqrt:  [[ 2.01531824e+01  0.00000000e+00]
 [-7.83821845e-03  1.79596147e-02]]
grads:  [0.00503499 2.97050142]
Stock Position:  0.005034994948517164
Bond Position:  [-4.90043298]


portfolio before change:  [-4.38161431]
curr_Stock_Price:  103.16420652653088
curr_Factors:  [1.03164207e+02 3.71432142e-02]
mat_Sqrt:  [[ 1.98823989e+01  0.00000000e+00]
 [-7.70902995e-03  1.76636066e-02]]
grads:  [-0.00476138  4.60410763]
Stock Position:  -0.004761377691337858
Bond Position:  [-3.89041056]


portfolio before change:  [-4.38259209]
curr_Stock_Price:  103.26742207381268
curr_Factors:  [1.03267422e+02 3.68045273e-02]
mat_Sqrt:  [[ 1.98113449e+01  0.00000000e+00]
 [-7.67380243e-03  1.75828902e-02]]
grads:  [-0.0143016   1.70100863]
Stock Position:  -0.014301604075242681
Bond Position:  [-2.90570231]


portfolio before change:  [-4.39747236]
curr_Stock_Price:  104.28248508104222
curr_Factors:  [1.04282485e+02 3.41208761e-02]
mat_Sqrt:  [[ 1.92628906e+01  0.00000000e+00]
 [-7.38873479e-03  1.69297182e-02]]
grads:  [-5.43980310e-03 -1.04680638e+01]
Stock Position:  -0.005439803101284698
Bond Position:  [-3.83019617]


portfolio before change:  [-4.39462957]
curr_Stock_Price:  103.67187577450927
curr_Factors:  [1.03671876e+02 3.33880742e-02]
mat_Sqrt:  [[ 1.89433438e+01  0.00000000e+00]
 [-7.30896153e-03  1.67469347e-02]]
grads:  [-1.69125911e-03 -3.52644631e+00]
Stock Position:  -0.0016912591100668572
Bond Position:  [-4.21929357]


portfolio before change:  [-4.39263977]
curr_Stock_Price:  102.18349076270489
curr_Factors:  [1.02183491e+02 3.42789086e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.39263977]
Stock Price:  101.94631219417964
PL:  [-6.33895196]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.35340977e+00  3.34880048e-01]
 [ 1.05311615e+00  7.30149223e-02]
 [ 1.10079690e-01 -1.57799355e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.17840238e-01 -3.71496864e-01]
 [-3.85574090e-01  2.23473339e-01]
 [ 2.50342702e-01 -2.78849072e-01]
 [-6.01609289e-01  1.87720630e-01]
 [-1.18082039e-01 -9.79982349e-02]
 [-1.63100550e-01 -4.36537977e-01]
 [-6.84340447e-02 -1.28799605e-02]
 [ 8.91415606e-03 -1.36032900e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-3.65274677e-02 -4.26099134e-02]
 [ 3.30579594e-01  2.00240599e-01]
 [ 1.28964590e-01 -5.54417464e-01]
 [ 3.06743514e-02 -1.25511215e-01]
 [ 3.06788764e-02 -1.52053050e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 8.48590630e-03 -8.90243515e-02]
 [ 1.63343713e-01 -3.57964535e-02]
 [ 5.69556225e-01 -1.98924941e-01]
 [ 2.97209832e-02 -3.70359874e-01]
 [ 5.80382153e-02  7.81985903e-03]
 [ 2.69749306e-01 -1.76501499e-01]
 [-7.62876052e-02 -2.27498197e-02]
 [-1.56444215e-01  9.54337861e-02]
 [-4.15788485e-02  9.49486216e-02]
 [-4.78531152e-02  1.98739556e-01]
 [-5.77380767e-01 -8.65444406e-02]
 [-1.68365167e-01 -6.35950483e-02]
 [ 1.32370887e-02 -6.42150743e-02]
 [-2.80859213e-01  1.14003535e-01]
 [ 7.52064986e-02  5.50080143e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.27883861e-01  7.75596704e-02]
 [-2.11564850e-02 -2.34093400e-01]
 [ 2.06602182e-02 -2.66353824e-02]
 [-3.83993963e-02 -9.74126819e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.88675024]
curr_Stock_Price:  99.88463200126616
curr_Factors:  [9.9884632e+01 3.9742484e-02]
mat_Sqrt:  [[ 1.99125178e+01  0.00000000e+00]
 [-7.97420682e-03  1.82712032e-02]]
grads:  [ 0.07530757 18.32829753]
Stock Position:  0.07530757385049346
Bond Position:  [-5.63531906]


portfolio before change:  [1.7779507]
curr_Stock_Price:  98.44925069683529
curr_Factors:  [9.84492507e+01 3.93545910e-02]
mat_Sqrt:  [[ 1.95303541e+01  0.00000000e+00]
 [-7.93519663e-03  1.81818196e-02]]
grads:  [0.05555365 4.01582041]
Stock Position:  0.055553650906885056
Bond Position:  [-3.6912646]


portfolio before change:  [1.87668749]
curr_Stock_Price:  100.23487995634223
curr_Factors:  [1.00234880e+02 3.81784524e-02]
mat_Sqrt:  [[ 1.95852011e+01  0.00000000e+00]
 [-7.81572286e-03  1.79080708e-02]]
grads:  [ 0.00526892 -0.88116334]
Stock Position:  0.005268915097027806
Bond Position:  [1.34855842]


portfolio before change:  [1.87870803]
curr_Stock_Price:  100.58636755317289
curr_Factors:  [1.00586368e+02 3.67912365e-02]
mat_Sqrt:  [[ 1.92935132e+01  0.00000000e+00]
 [-7.67241673e-03  1.75797152e-02]]
grads:  [-8.44914390e-04 -8.61144852e+00]
Stock Position:  -0.0008449143902627879
Bond Position:  [1.9636949]


portfolio before change:  [1.87772436]
curr_Stock_Price:  102.041128683639
curr_Factors:  [1.02041129e+02 3.72834515e-02]
mat_Sqrt:  [[ 1.97030432e+01  0.00000000e+00]
 [-7.72356928e-03  1.76969204e-02]]
grads:  [-1.42097218e-02 -2.09921758e+01]
Stock Position:  -0.014209721776637775
Bond Position:  [3.32770041]


portfolio before change:  [1.87100363]
curr_Stock_Price:  102.54337015629477
curr_Factors:  [1.0254337e+02 3.6595713e-02]
mat_Sqrt:  [[ 1.96165529e+01  0.00000000e+00]
 [-7.65200241e-03  1.75329401e-02]]
grads:  [-0.01468364 12.74591356]
Stock Position:  -0.014683636344268357
Bond Position:  [3.37671319]


portfolio before change:  [1.87134486]
curr_Stock_Price:  102.54887864932871
curr_Factors:  [1.02548879e+02 3.73988292e-02]
mat_Sqrt:  [[ 1.98316989e+01  0.00000000e+00]
 [-7.73551076e-03  1.77242818e-02]]
grads:  [ 6.48673571e-03 -1.57326021e+01]
Stock Position:  0.006486735709410529
Bond Position:  [1.20613739]


portfolio before change:  [1.87460594]
curr_Stock_Price:  103.02836513052753
curr_Factors:  [1.03028365e+02 3.79097023e-02]
mat_Sqrt:  [[ 2.00600493e+01  0.00000000e+00]
 [-7.78816562e-03  1.78449292e-02]]
grads:  [-0.02590628 10.51955028]
Stock Position:  -0.025906281788137628
Bond Position:  [4.5436878]


portfolio before change:  [1.89895481]
curr_Stock_Price:  102.11040761617474
curr_Factors:  [1.02110408e+02 3.68583168e-02]
mat_Sqrt:  [[ 1.96036870e+01  0.00000000e+00]
 [-7.67940797e-03  1.75957342e-02]]
grads:  [-0.00820519 -5.56943143]
Stock Position:  -0.00820518993541022
Bond Position:  [2.73679009]


portfolio before change:  [1.89677312]
curr_Stock_Price:  102.41799430838407
curr_Factors:  [1.02417994e+02 3.68293625e-02]
mat_Sqrt:  [[ 1.96550145e+01  0.00000000e+00]
 [-7.67639108e-03  1.75888216e-02]]
grads:  [-1.79914059e-02 -2.48190576e+01]
Stock Position:  -0.017991405869966125
Bond Position:  [3.73941682]


portfolio before change:  [1.88950653]
curr_Stock_Price:  102.84786871497163
curr_Factors:  [1.02847869e+02 3.62970130e-02]
mat_Sqrt:  [[ 1.95943445e+01  0.00000000e+00]
 [-7.62070999e-03  1.74612402e-02]]
grads:  [-0.00377942 -0.73763148]
Stock Position:  -0.0037794231998619365
Bond Position:  [2.27821215]


portfolio before change:  [1.8980582]
curr_Stock_Price:  100.66053074208591
curr_Factors:  [1.00660531e+02 3.68191314e-02]
mat_Sqrt:  [[ 1.93150566e+01  0.00000000e+00]
 [-7.67532477e-03  1.75863784e-02]]
grads:  [-2.61223511e-03 -7.73512872e+00]
Stock Position:  -0.002612235107230798
Bond Position:  [2.16100717]


portfolio before change:  [1.90031084]
curr_Stock_Price:  99.90160353139393
curr_Factors:  [9.99016035e+01 3.56617732e-02]
mat_Sqrt:  [[ 1.88657435e+01  0.00000000e+00]
 [-7.55373002e-03  1.73077698e-02]]
grads:  [-0.00685628 -1.6207406 ]
Stock Position:  -0.006856283610398885
Bond Position:  [2.58526457]


portfolio before change:  [1.89067505]
curr_Stock_Price:  101.35413436966306
curr_Factors:  [1.01354134e+02 3.40559050e-02]
mat_Sqrt:  [[ 1.87041373e+01  0.00000000e+00]
 [-7.38169682e-03  1.69135922e-02]]
grads:  [-0.00294715 -2.51927046]
Stock Position:  -0.002947153220412344
Bond Position:  [2.18938122]


portfolio before change:  [1.89056474]
curr_Stock_Price:  101.4844308348077
curr_Factors:  [1.01484431e+02 3.26929927e-02]
mat_Sqrt:  [[ 1.83496066e+01  0.00000000e+00]
 [-7.23248147e-03  1.65716969e-02]]
grads:  [ 0.02277824 12.08328876]
Stock Position:  0.022778240674590052
Bond Position:  [-0.42107205]


portfolio before change:  [1.90958968]
curr_Stock_Price:  102.32196610874657
curr_Factors:  [1.02321966e+02 3.15451766e-02]
mat_Sqrt:  [[ 1.81733654e+01  0.00000000e+00]
 [-7.10438474e-03  1.62781904e-02]]
grads:  [-6.21805739e-03 -3.40589125e+01]
Stock Position:  -0.006218057393949965
Bond Position:  [2.54583354]


portfolio before change:  [1.91050684]
curr_Stock_Price:  102.2256486562794
curr_Factors:  [1.02225649e+02 3.16295155e-02]
mat_Sqrt:  [[ 1.81805135e+01  0.00000000e+00]
 [-7.11387551e-03  1.62999365e-02]]
grads:  [-1.32577300e-03 -7.70010456e+00]
Stock Position:  -0.001325772999428592
Bond Position:  [2.04603484]


portfolio before change:  [1.91088795]
curr_Stock_Price:  102.13111139138357
curr_Factors:  [1.02131111e+02 3.12136885e-02]
mat_Sqrt:  [[ 1.80439080e+01  0.00000000e+00]
 [-7.06695844e-03  1.61924360e-02]]
grads:  [-1.97753807e-03 -9.39037521e+00]
Stock Position:  -0.001977538070488901
Bond Position:  [2.11285611]


portfolio before change:  [1.91163668]
curr_Stock_Price:  101.88605162964406
curr_Factors:  [1.01886052e+02 3.12906242e-02]
mat_Sqrt:  [[ 1.80227827e+01  0.00000000e+00]
 [-7.07566242e-03  1.62123793e-02]]
grads:  [-1.76872324e-02 -2.89462537e+01]
Stock Position:  -0.017687232350708727
Bond Position:  [3.71371895]


portfolio before change:  [1.91245842]
curr_Stock_Price:  101.86583958574163
curr_Factors:  [1.01865840e+02 3.03894104e-02]
mat_Sqrt:  [[ 1.77578223e+01  0.00000000e+00]
 [-6.97302350e-03  1.59772040e-02]]
grads:  [-1.71009178e-03 -5.57196062e+00]
Stock Position:  -0.0017100917835761156
Bond Position:  [2.08665836]


portfolio before change:  [1.91244845]
curr_Stock_Price:  102.02420640419183
curr_Factors:  [1.02024206e+02 3.10421228e-02]
mat_Sqrt:  [[ 1.79754152e+01  0.00000000e+00]
 [-7.04750995e-03  1.61478739e-02]]
grads:  [ 0.00821794 -2.2167905 ]
Stock Position:  0.008217938633586337
Bond Position:  [1.07401978]


portfolio before change:  [1.91196819]
curr_Stock_Price:  101.94942843602904
curr_Factors:  [1.01949428e+02 3.02070589e-02]
mat_Sqrt:  [[ 1.77189922e+01  0.00000000e+00]
 [-6.95207122e-03  1.59291963e-02]]
grads:  [  0.02724412 -12.4880714 ]
Stock Position:  0.02724411515708919
Bond Position:  [-0.86555378]


portfolio before change:  [1.89481564]
curr_Stock_Price:  101.32381246906162
curr_Factors:  [1.01323812e+02 3.02216377e-02]
mat_Sqrt:  [[ 1.76145081e+01  0.00000000e+00]
 [-6.95374865e-03  1.59330398e-02]]
grads:  [-7.48912865e-03 -2.32447718e+01]
Stock Position:  -0.007489128654607256
Bond Position:  [2.6536427]


portfolio before change:  [1.89120914]
curr_Stock_Price:  101.84967070949934
curr_Factors:  [1.01849671e+02 2.93196049e-02]
mat_Sqrt:  [[ 1.74396870e+01  0.00000000e+00]
 [-6.84918739e-03  1.56934598e-02]]
grads:  [0.00352363 0.49828777]
Stock Position:  0.0035236344322469772
Bond Position:  [1.53232813]


portfolio before change:  [1.89002795]
curr_Stock_Price:  101.46008864205793
curr_Factors:  [1.01460089e+02 2.89631614e-02]
mat_Sqrt:  [[ 1.72670529e+01  0.00000000e+00]
 [-6.80742670e-03  1.55977741e-02]]
grads:  [ 1.11610092e-02 -1.13158133e+01]
Stock Position:  0.01116100922649663
Bond Position:  [0.75763096]


portfolio before change:  [1.90574745]
curr_Stock_Price:  102.86003296480568
curr_Factors:  [1.02860033e+02 2.86340496e-02]
mat_Sqrt:  [[ 1.74055618e+01  0.00000000e+00]
 [-6.76863940e-03  1.55089012e-02]]
grads:  [-0.00495338 -1.46688791]
Stock Position:  -0.004953384527893851
Bond Position:  [2.41525275]


portfolio before change:  [1.90290554]
curr_Stock_Price:  103.49471718539812
curr_Factors:  [1.03494717e+02 2.95395749e-02]
mat_Sqrt:  [[ 1.77877207e+01  0.00000000e+00]
 [-6.87483235e-03  1.57522198e-02]]
grads:  [-0.00645352  6.05843413]
Stock Position:  -0.006453524751952494
Bond Position:  [2.57081126]


portfolio before change:  [1.90092417]
curr_Stock_Price:  103.85153681091992
curr_Factors:  [1.03851537e+02 3.01030030e-02]
mat_Sqrt:  [[ 1.80184670e+01  0.00000000e+00]
 [-6.94008680e-03  1.59017366e-02]]
grads:  [-7.76274308e-06  5.97095929e+00]
Stock Position:  -7.762743080601269e-06
Bond Position:  [1.90173034]


portfolio before change:  [1.90116629]
curr_Stock_Price:  103.28621983769303
curr_Factors:  [1.03286220e+02 2.96415423e-02]
mat_Sqrt:  [[ 1.77824985e+01  0.00000000e+00]
 [-6.88668772e-03  1.57793839e-02]]
grads:  [2.18664087e-03 1.25948870e+01]
Stock Position:  0.002186640874159642
Bond Position:  [1.67531642]


portfolio before change:  [1.89731236]
curr_Stock_Price:  101.4279538482862
curr_Factors:  [1.01427954e+02 3.05704678e-02]
mat_Sqrt:  [[ 1.77340818e+01  0.00000000e+00]
 [-6.99376498e-03  1.60247287e-02]]
grads:  [-0.03468755 -5.40068055]
Stock Position:  -0.03468755048385821
Bond Position:  [5.41559962]


portfolio before change:  [1.91970449]
curr_Stock_Price:  100.80193274729483
curr_Factors:  [1.00801933e+02 2.97012252e-02]
mat_Sqrt:  [[ 1.73722488e+01  0.00000000e+00]
 [-6.89361736e-03  1.57952617e-02]]
grads:  [-0.01128929 -4.02621049]
Stock Position:  -0.011289288058171391
Bond Position:  [3.05768654]


portfolio before change:  [1.91456432]
curr_Stock_Price:  101.29110440405277
curr_Factors:  [1.01291104e+02 2.86580518e-02]
mat_Sqrt:  [[ 1.71472562e+01  0.00000000e+00]
 [-6.77147568e-03  1.55153999e-02]]
grads:  [-8.62450947e-04 -4.13879594e+00]
Stock Position:  -0.0008624509471759699
Bond Position:  [2.00192293]


portfolio before change:  [1.91394806]
curr_Stock_Price:  102.29581776415213
curr_Factors:  [1.02295818e+02 2.93298606e-02]
mat_Sqrt:  [[ 1.75191438e+01  0.00000000e+00]
 [-6.85038517e-03  1.56962043e-02]]
grads:  [-0.01319151  7.2631276 ]
Stock Position:  -0.013191511768367647
Bond Position:  [3.26338454]


portfolio before change:  [1.90936576]
curr_Stock_Price:  102.67411010185239
curr_Factors:  [1.02674110e+02 2.89087135e-02]
mat_Sqrt:  [[ 1.74572299e+01  0.00000000e+00]
 [-6.80102504e-03  1.55831060e-02]]
grads:  [0.00568326 3.52997754]
Stock Position:  0.005683259318092878
Bond Position:  [1.32584217]


portfolio before change:  [1.90415228]
curr_Stock_Price:  101.72760781676952
curr_Factors:  [1.01727608e+02 2.93826767e-02]
mat_Sqrt:  [[ 1.74375116e+01  0.00000000e+00]
 [-6.85655035e-03  1.57103305e-02]]
grads:  [-0.00542896  5.17653949]
Stock Position:  -0.005428963304921705
Bond Position:  [2.45642773]


portfolio before change:  [1.90813686]
curr_Stock_Price:  101.05022242576374
curr_Factors:  [1.01050222e+02 2.88129469e-02]
mat_Sqrt:  [[ 1.71526455e+01  0.00000000e+00]
 [-6.78975073e-03  1.55572733e-02]]
grads:  [-0.01131219  4.98542827]
Stock Position:  -0.011312193543484514
Bond Position:  [3.05123653]


portfolio before change:  [1.90706378]
curr_Stock_Price:  101.17880109656309
curr_Factors:  [1.01178801e+02 2.93278205e-02]
mat_Sqrt:  [[ 1.73272413e+01  0.00000000e+00]
 [-6.85014691e-03  1.56956584e-02]]
grads:  [-7.11730266e-03 -1.49145320e+01]
Stock Position:  -0.007117302656377302
Bond Position:  [2.62718393]


portfolio before change:  [1.90822633]
curr_Stock_Price:  101.061603471493
curr_Factors:  [1.01061603e+02 3.10378826e-02]
mat_Sqrt:  [[ 1.78046003e+01  0.00000000e+00]
 [-7.04702860e-03  1.61467710e-02]]
grads:  [ 5.07485939e-04 -1.64957950e+00]
Stock Position:  0.0005074859389228885
Bond Position:  [1.85693899]


portfolio before change:  [1.90826185]
curr_Stock_Price:  100.67418563933104
curr_Factors:  [1.00674186e+02 3.17517729e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.90826185]
Stock Price:  100.51655073836999
PL:  [1.39171111]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.01930722e+00  2.59346155e-01]
 [-2.72129972e-01 -9.50068791e-02]
 [ 5.89049331e-02 -3.91167460e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.17387812e-02  3.18623237e-02]
 [-4.04081239e-01  2.46549997e-01]
 [ 1.66176496e-01 -1.67291143e-01]
 [-6.37515109e-01  1.26745503e-01]
 [-1.06284379e-01 -7.54464639e-02]
 [-3.48084744e-01 -5.79413616e-01]
 [-5.46763937e-02 -1.42312533e-02]
 [-2.25146220e-01 -2.34645883e-01]
 [-5.75177578e-02 -1.81504850e-02]
 [ 1.10717689e-03 -1.45718581e-01]
 [ 1.82888245e-01  1.03540014e-01]
 [ 1.36380097e-01 -4.66740517e-01]
 [ 3.68560316e-02 -5.83956347e-02]
 [ 3.00650295e-02 -1.51383754e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-1.10699276e-02 -7.75755779e-02]
 [ 1.52764155e-01 -3.23033903e-02]
 [ 6.07240769e-01 -1.65269447e-01]
 [ 2.39167895e-02 -8.44456392e-02]
 [-5.79028432e-02  5.91481373e-02]
 [ 1.54840824e-02  1.08045052e-02]
 [ 1.37607941e-01 -1.00717391e-01]
 [-1.12380805e-01 -3.87532795e-01]
 [ 6.03670091e-02  7.37362621e-02]
 [ 2.65802238e-01 -3.39339182e-02]
 [-5.44421944e-01 -1.18709828e-01]
 [-1.65504551e-01 -6.04704861e-02]
 [ 7.22863871e-03 -7.36144357e-02]
 [-2.21805438e-01  1.40089976e-01]
 [ 4.81015351e-02  4.81728282e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.66077883e-01  5.25441970e-02]
 [-2.52102383e-02 -1.97873213e-01]
 [ 6.88724460e-03 -4.23009116e-02]
 [-5.85634965e-02 -4.75473035e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.48630115]
curr_Stock_Price:  101.42320944397507
curr_Factors:  [1.01423209e+02 4.02526167e-02]
mat_Sqrt:  [[ 2.03485941e+01  0.00000000e+00]
 [-8.02522191e-03  1.83880934e-02]]
grads:  [ 0.05565471 14.10402637]
Stock Position:  0.055654712786218426
Bond Position:  [6.84162156]


portfolio before change:  [12.5429342]
curr_Stock_Price:  102.4254208568859
curr_Factors:  [1.02425421e+02 4.07343618e-02]
mat_Sqrt:  [[ 2.06722722e+01  0.00000000e+00]
 [-8.07310219e-03  1.84978009e-02]]
grads:  [-0.01516981 -5.1361175 ]
Stock Position:  -0.01516980669417144
Bond Position:  [14.09670803]


portfolio before change:  [12.57059042]
curr_Stock_Price:  100.718475732525
curr_Factors:  [1.00718476e+02 4.09727815e-02]
mat_Sqrt:  [[ 2.03871664e+01  0.00000000e+00]
 [-8.09669380e-03  1.85518561e-02]]
grads:  [ 2.05192740e-03 -2.10850849e+00]
Stock Position:  0.002051927403704051
Bond Position:  [12.36392342]


portfolio before change:  [12.56981522]
curr_Stock_Price:  99.58744543677292
curr_Factors:  [9.95874454e+01 4.10716452e-02]
mat_Sqrt:  [[ 2.01825316e+01  0.00000000e+00]
 [-8.10645621e-03  1.85742246e-02]]
grads:  [-8.07696837e-04 -8.15037051e+00]
Stock Position:  -0.0008076968367777174
Bond Position:  [12.65025168]


portfolio before change:  [12.57069151]
curr_Stock_Price:  100.46040813378274
curr_Factors:  [1.00460408e+02 4.15097600e-02]
mat_Sqrt:  [[ 2.04677474e+01  0.00000000e+00]
 [-8.14957766e-03  1.86730282e-02]]
grads:  [-0.00380271  1.70632868]
Stock Position:  -0.0038027107448177036
Bond Position:  [12.95271338]


portfolio before change:  [12.5628041]
curr_Stock_Price:  102.96036072838947
curr_Factors:  [1.02960361e+02 4.02613293e-02]
mat_Sqrt:  [[ 2.06592290e+01  0.00000000e+00]
 [-8.02609038e-03  1.83900834e-02]]
grads:  [-0.01435087 13.40668185]
Stock Position:  -0.014350874291043387
Bond Position:  [14.0403753]


portfolio before change:  [12.58611633]
curr_Stock_Price:  101.45821700620021
curr_Factors:  [1.01458217e+02 4.06272187e-02]
mat_Sqrt:  [[ 2.04501158e+01  0.00000000e+00]
 [-8.06247790e-03  1.84734576e-02]]
grads:  [ 4.55570308e-03 -9.05575699e+00]
Stock Position:  0.004555703077508024
Bond Position:  [12.12390282]


portfolio before change:  [12.59732818]
curr_Stock_Price:  103.586595923498
curr_Factors:  [1.03586596e+02 3.95296335e-02]
mat_Sqrt:  [[ 2.05951498e+01  0.00000000e+00]
 [-7.95282425e-03  1.82222096e-02]]
grads:  [-0.02826874  6.95555076]
Stock Position:  -0.028268735203766434
Bond Position:  [15.52559023]


portfolio before change:  [12.58512924]
curr_Stock_Price:  104.08678675114754
curr_Factors:  [1.04086787e+02 3.89267663e-02]
mat_Sqrt:  [[ 2.05361849e+01  0.00000000e+00]
 [-7.89194691e-03  1.80827220e-02]]
grads:  [-0.00677886 -4.17229573]
Stock Position:  -0.006778859660502659
Bond Position:  [13.29071896]


portfolio before change:  [12.58871658]
curr_Stock_Price:  103.8026825947512
curr_Factors:  [1.03802683e+02 3.95453026e-02]
mat_Sqrt:  [[ 2.06422022e+01  0.00000000e+00]
 [-7.95440030e-03  1.82258207e-02]]
grads:  [-2.91132492e-02 -3.17908106e+01]
Stock Position:  -0.029113249174161554
Bond Position:  [15.61074995]


portfolio before change:  [12.56937172]
curr_Stock_Price:  104.53418201804098
curr_Factors:  [1.04534182e+02 3.92352242e-02]
mat_Sqrt:  [[ 2.07060088e+01  0.00000000e+00]
 [-7.92315333e-03  1.81542249e-02]]
grads:  [-0.00294057 -0.78390861]
Stock Position:  -0.0029405677538175117
Bond Position:  [12.87676157]


portfolio before change:  [12.56995453]
curr_Stock_Price:  104.88339683043071
curr_Factors:  [1.04883397e+02 3.86239774e-02]
mat_Sqrt:  [[ 2.06127170e+01  0.00000000e+00]
 [-7.86119354e-03  1.80122572e-02]]
grads:  [ -0.01589087 -13.02701156]
Stock Position:  -0.01589087352124569
Bond Position:  [14.23664332]


portfolio before change:  [12.59642016]
curr_Stock_Price:  103.32993043273565
curr_Factors:  [1.03329930e+02 3.96034772e-02]
mat_Sqrt:  [[ 2.05632993e+01  0.00000000e+00]
 [-7.96024896e-03  1.82392217e-02]]
grads:  [-0.00318233 -0.99513484]
Stock Position:  -0.003182333634279172
Bond Position:  [12.92525047]


portfolio before change:  [12.60035325]
curr_Stock_Price:  102.60174294501955
curr_Factors:  [1.02601743e+02 4.03625751e-02]
mat_Sqrt:  [[ 2.06131409e+01  0.00000000e+00]
 [-8.03617571e-03  1.84131918e-02]]
grads:  [-3.03154313e-03 -7.91381432e+00]
Stock Position:  -0.0030315431289858483
Bond Position:  [12.91139486]


portfolio before change:  [12.60129889]
curr_Stock_Price:  102.82222187194903
curr_Factors:  [1.02822222e+02 3.97661755e-02]
mat_Sqrt:  [[ 2.05042504e+01  0.00000000e+00]
 [-7.97658328e-03  1.82766483e-02]]
grads:  [0.01112339 5.66515329]
Stock Position:  0.01112339187753698
Bond Position:  [11.45756702]


portfolio before change:  [12.58991398]
curr_Stock_Price:  101.6699483975874
curr_Factors:  [1.01669948e+02 3.88888990e-02]
mat_Sqrt:  [[ 2.00495868e+01  0.00000000e+00]
 [-7.88810740e-03  1.80739246e-02]]
grads:  [-3.35778318e-03 -2.58239717e+01]
Stock Position:  -0.0033577831794723116
Bond Position:  [12.93129963]


portfolio before change:  [12.59279227]
curr_Stock_Price:  101.29417384244249
curr_Factors:  [1.01294174e+02 3.83501974e-02]
mat_Sqrt:  [[ 1.98366472e+01  0.00000000e+00]
 [-7.83328257e-03  1.79483052e-02]]
grads:  [ 5.73185937e-04 -3.25354590e+00]
Stock Position:  0.0005731859369050244
Bond Position:  [12.53473187]


portfolio before change:  [12.59470992]
curr_Stock_Price:  101.90603516658315
curr_Factors:  [1.01906035e+02 3.69785509e-02]
mat_Sqrt:  [[ 1.95963347e+01  0.00000000e+00]
 [-7.69192313e-03  1.76244100e-02]]
grads:  [-1.83729548e-03 -8.58943669e+00]
Stock Position:  -0.0018372954810740398
Bond Position:  [12.78194141]


portfolio before change:  [12.59773622]
curr_Stock_Price:  101.12855465039495
curr_Factors:  [1.01128555e+02 3.70523008e-02]
mat_Sqrt:  [[ 1.94662094e+01  0.00000000e+00]
 [-7.69958968e-03  1.76419763e-02]]
grads:  [-1.63757174e-02 -2.66006278e+01]
Stock Position:  -0.016375717432519307
Bond Position:  [14.25378885]


portfolio before change:  [12.59480059]
curr_Stock_Price:  101.41663162768307
curr_Factors:  [1.01416632e+02 3.56644008e-02]
mat_Sqrt:  [[ 1.91525519e+01  0.00000000e+00]
 [-7.55400829e-03  1.73084074e-02]]
grads:  [-2.34572843e-03 -4.48195932e+00]
Stock Position:  -0.0023457284290701133
Bond Position:  [12.83269646]


portfolio before change:  [12.59331312]
curr_Stock_Price:  102.73462678592675
curr_Factors:  [1.02734627e+02 3.60558278e-02]
mat_Sqrt:  [[ 1.95076333e+01  0.00000000e+00]
 [-7.59534887e-03  1.74031306e-02]]
grads:  [ 0.00710828 -1.85618272]
Stock Position:  0.007108284101822214
Bond Position:  [11.8630462]


portfolio before change:  [12.58653748]
curr_Stock_Price:  101.57279724819747
curr_Factors:  [1.01572797e+02 3.62675249e-02]
mat_Sqrt:  [[ 1.93435585e+01  0.00000000e+00]
 [-7.61761379e-03  1.74541459e-02]]
grads:  [ 0.02766354 -9.46877882]
Stock Position:  0.02766353810753438
Bond Position:  [9.77667453]


portfolio before change:  [12.52655561]
curr_Stock_Price:  99.36035337360626
curr_Factors:  [9.93603534e+01 3.66354125e-02]
mat_Sqrt:  [[ 1.90179486e+01  0.00000000e+00]
 [-7.65615177e-03  1.75424475e-02]]
grads:  [-6.80320953e-04 -4.81378890e+00]
Stock Position:  -0.00068032095253441
Bond Position:  [12.59415254]


portfolio before change:  [12.52841647]
curr_Stock_Price:  98.93923651107531
curr_Factors:  [9.89392365e+01 3.58794046e-02]
mat_Sqrt:  [[ 1.87409313e+01  0.00000000e+00]
 [-7.57674385e-03  1.73605011e-02]]
grads:  [-1.71221372e-03  3.40705242e+00]
Stock Position:  -0.0017122137180791168
Bond Position:  [12.69782159]


portfolio before change:  [12.52946729]
curr_Stock_Price:  99.25258162093675
curr_Factors:  [9.92525816e+01 3.71220585e-02]
mat_Sqrt:  [[ 1.91230798e+01  0.00000000e+00]
 [-7.70683421e-03  1.76585756e-02]]
grads:  [0.00105629 0.61185599]
Stock Position:  0.0010562919414217292
Bond Position:  [12.42462758]


portfolio before change:  [12.53099346]
curr_Stock_Price:  99.22701747526881
curr_Factors:  [9.92270175e+01 3.72522456e-02]
mat_Sqrt:  [[ 1.91516487e+01  0.00000000e+00]
 [-7.72033632e-03  1.76895128e-02]]
grads:  [ 4.88998463e-03 -5.69362154e+00]
Stock Position:  0.004889984628374117
Bond Position:  [12.04577487]


portfolio before change:  [12.52835368]
curr_Stock_Price:  98.37924536131631
curr_Factors:  [9.83792454e+01 3.86845570e-02]
mat_Sqrt:  [[ 1.93496138e+01  0.00000000e+00]
 [-7.86735605e-03  1.80263773e-02]]
grads:  [-1.45488167e-02 -2.14980963e+01]
Stock Position:  -0.01454881665773067
Bond Position:  [13.95965528]


portfolio before change:  [12.5456515]
curr_Stock_Price:  97.31024069159938
curr_Factors:  [9.73102407e+01 3.98778176e-02]
mat_Sqrt:  [[ 1.94323014e+01  0.00000000e+00]
 [-7.98777242e-03  1.83022859e-02]]
grads:  [0.00476259 4.0288007 ]
Stock Position:  0.004762593490877184
Bond Position:  [12.08220238]


portfolio before change:  [12.54777688]
curr_Stock_Price:  97.43937395095759
curr_Factors:  [9.74393740e+01 3.97957981e-02]
mat_Sqrt:  [[ 1.94380679e+01  0.00000000e+00]
 [-7.97955368e-03  1.82834544e-02]]
grads:  [ 0.01291241 -1.85599053]
Stock Position:  0.012912407936490247
Bond Position:  [11.28959993]


portfolio before change:  [12.56599183]
curr_Stock_Price:  98.74073141803254
curr_Factors:  [9.87407314e+01 3.88560204e-02]
mat_Sqrt:  [[ 1.94637044e+01  0.00000000e+00]
 [-7.88477220e-03  1.80662827e-02]]
grads:  [-0.03063297 -6.57079434]
Stock Position:  -0.030632974581524624
Bond Position:  [15.59071414]


portfolio before change:  [12.55783003]
curr_Stock_Price:  99.07079247980933
curr_Factors:  [9.90707925e+01 3.91936238e-02]
mat_Sqrt:  [[ 1.96134208e+01  0.00000000e+00]
 [-7.91895183e-03  1.81445981e-02]]
grads:  [-0.00978391 -3.33269912]
Stock Position:  -0.009783914593988967
Bond Position:  [13.52713021]


portfolio before change:  [12.54974663]
curr_Stock_Price:  100.06982019146085
curr_Factors:  [1.00069820e+02 3.90488372e-02]
mat_Sqrt:  [[ 1.97745756e+01  0.00000000e+00]
 [-7.90431145e-03  1.81110528e-02]]
grads:  [-1.25915900e-03 -4.06461384e+00]
Stock Position:  -0.0012591590041814977
Bond Position:  [12.67575044]


portfolio before change:  [12.55094414]
curr_Stock_Price:  100.37721057291395
curr_Factors:  [1.00377211e+02 3.81125923e-02]
mat_Sqrt:  [[ 1.95960874e+01  0.00000000e+00]
 [-7.80897866e-03  1.78926179e-02]]
grads:  [-0.00819884  7.82948457]
Stock Position:  -0.00819883873140404
Bond Position:  [13.37392071]


portfolio before change:  [12.55357381]
curr_Stock_Price:  100.26038634996394
curr_Factors:  [1.00260386e+02 3.76417090e-02]
mat_Sqrt:  [[ 1.94519901e+01  0.00000000e+00]
 [-7.76058854e-03  1.77817422e-02]]
grads:  [0.00355367 2.70911746]
Stock Position:  0.0035536662578037944
Bond Position:  [12.19728186]


portfolio before change:  [12.56240385]
curr_Stock_Price:  102.31608891029066
curr_Factors:  [1.02316089e+02 3.59824906e-02]
mat_Sqrt:  [[ 1.94083914e+01  0.00000000e+00]
 [-7.58762051e-03  1.73854227e-02]]
grads:  [-0.00487766  4.67777791]
Stock Position:  -0.004877663943389232
Bond Position:  [13.06146735]


portfolio before change:  [12.56448597]
curr_Stock_Price:  102.22396722665003
curr_Factors:  [1.02223967e+02 3.55475058e-02]
mat_Sqrt:  [[ 1.92733540e+01  0.00000000e+00]
 [-7.54161848e-03  1.72800188e-02]]
grads:  [-0.01261564  3.04074884]
Stock Position:  -0.012615641038077798
Bond Position:  [13.85410685]


portfolio before change:  [12.56115782]
curr_Stock_Price:  102.6250583549579
curr_Factors:  [1.02625058e+02 3.55935083e-02]
mat_Sqrt:  [[ 1.93614917e+01  0.00000000e+00]
 [-7.54649675e-03  1.72911963e-02]]
grads:  [-5.76242730e-03 -1.14435814e+01]
Stock Position:  -0.005762427295555786
Bond Position:  [13.15252726]


portfolio before change:  [12.56755609]
curr_Stock_Price:  101.80004220574172
curr_Factors:  [1.01800042e+02 3.56945267e-02]
mat_Sqrt:  [[ 1.92330771e+01  0.00000000e+00]
 [-7.55719807e-03  1.73157161e-02]]
grads:  [-6.01795892e-04 -2.44292014e+00]
Stock Position:  -0.0006017958923937853
Bond Position:  [12.62881893]


portfolio before change:  [12.5689848]
curr_Stock_Price:  102.04928274271845
curr_Factors:  [1.02049283e+02 3.55214570e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.5689848]
Stock Price:  102.83722665337574
PL:  [9.73175814]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48247610e+00  3.64059358e-01]
 [ 4.37979194e-01  1.22583381e-01]
 [ 1.10473746e-01 -1.91263677e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.14732698e-01  9.39180235e-01]
 [ 1.53442589e-02 -5.11766037e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.01643244e+00  1.02924497e+00]
 [ 5.70705387e-02  4.84809914e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-5.93876563e-02  1.41695045e-02]
 [ 3.08012361e-02 -1.35997205e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-5.27671709e-02 -1.90933464e-02]
 [ 5.14265934e-01  3.36576186e-01]
 [ 1.29990875e-01  3.42974845e-02]
 [ 3.97146857e-02  1.16850074e-01]
 [ 4.93630300e-02  7.29561940e-02]
 [-2.64436151e-02 -1.10188704e-02]
 [-2.97040444e-01  1.04533634e-01]
 [ 1.13080164e-01  5.91430964e-02]
 [ 1.43943145e+00  1.60958056e-01]
 [ 1.58908279e-02  4.29006468e-01]
 [-1.49683943e-01  1.77070851e-01]
 [-1.91919923e-01  1.16142949e-01]
 [ 2.14977152e-01 -7.31127697e-02]
 [-8.12292976e-02 -4.51209602e-01]
 [ 7.86215724e-02  3.48770981e-02]
 [ 4.25785673e-01 -2.22018869e-01]
 [-5.23652295e-01 -2.18003107e-01]
 [ 3.54165403e-02  1.62123611e-02]
 [-1.00259572e-01  1.25458945e-01]
 [ 4.13633704e-01  2.22722567e-01]
 [ 4.90361156e-02 -5.01760501e-02]
 [ 2.75875098e-01 -2.72010941e-01]
 [ 8.40680580e-02  8.35581823e-02]
 [-5.50762510e-02  1.58904660e-01]
 [-3.63723781e-01 -1.37958415e-01]
 [ 6.48640611e-02  3.69486174e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.966461]
curr_Stock_Price:  99.32531925771261
curr_Factors:  [9.93253193e+01 4.03677002e-02]
mat_Sqrt:  [[ 1.99561598e+01  0.00000000e+00]
 [-8.03668591e-03  1.84143607e-02]]
grads:  [ 0.08224852 19.77040435]
Stock Position:  0.08224852079297536
Bond Position:  [-10.13582158]


portfolio before change:  [-1.91830482]
curr_Stock_Price:  99.92622039937608
curr_Factors:  [9.99262204e+01 4.11810051e-02]
mat_Sqrt:  [[ 2.02781314e+01  0.00000000e+00]
 [-8.11724141e-03  1.85989366e-02]]
grads:  [0.0242369  6.59088119]
Stock Position:  0.024236896347119244
Bond Position:  [-4.34020627]


portfolio before change:  [-1.90804685]
curr_Stock_Price:  100.37184421235465
curr_Factors:  [1.00371844e+02 4.10484750e-02]
mat_Sqrt:  [[ 2.03357605e+01  0.00000000e+00]
 [-8.10416930e-03  1.85689846e-02]]
grads:  [ 0.00502201 -1.03001689]
Stock Position:  0.005022006189778793
Bond Position:  [-2.41211487]


portfolio before change:  [-1.91592164]
curr_Stock_Price:  98.86382937158425
curr_Factors:  [9.88638294e+01 4.05151147e-02]
mat_Sqrt:  [[ 1.98996741e+01  0.00000000e+00]
 [-8.05134669e-03  1.84479528e-02]]
grads:  [-8.19177583e-04 -8.20615783e+00]
Stock Position:  -0.0008191775831455187
Bond Position:  [-1.83493461]


portfolio before change:  [-1.91482651]
curr_Stock_Price:  97.24695772563116
curr_Factors:  [9.72469577e+01 4.07499894e-02]
mat_Sqrt:  [[ 1.96308803e+01  0.00000000e+00]
 [-8.07465065e-03  1.85013489e-02]]
grads:  [1.50354521e-02 5.07627979e+01]
Stock Position:  0.015035452128541658
Bond Position:  [-3.37697849]


portfolio before change:  [-1.91658519]
curr_Stock_Price:  97.15806578258608
curr_Factors:  [9.71580658e+01 4.14109334e-02]
mat_Sqrt:  [[ 1.97713521e+01  0.00000000e+00]
 [-8.13987060e-03  1.86507866e-02]]
grads:  [-3.53594537e-04 -2.74393809e+00]
Stock Position:  -0.00035359453717743517
Bond Position:  [-1.88223063]


portfolio before change:  [-1.91699162]
curr_Stock_Price:  97.64204676202003
curr_Factors:  [9.76420468e+01 4.07963922e-02]
mat_Sqrt:  [[ 1.97218546e+01  0.00000000e+00]
 [-8.07924672e-03  1.85118798e-02]]
grads:  [0.00655992 5.19325363]
Stock Position:  0.00655991941686299
Bond Position:  [-2.55751558]


portfolio before change:  [-1.92392367]
curr_Stock_Price:  96.63405564601324
curr_Factors:  [9.66340556e+01 4.17318511e-02]
mat_Sqrt:  [[ 1.97407674e+01  0.00000000e+00]
 [-8.17135006e-03  1.87229151e-02]]
grads:  [ 0.07424391 54.97247422]
Stock Position:  0.0742439106775822
Bond Position:  [-9.09841387]


portfolio before change:  [-1.95195827]
curr_Stock_Price:  96.27177373235587
curr_Factors:  [9.62717737e+01 4.25229202e-02]
mat_Sqrt:  [[ 1.98522856e+01  0.00000000e+00]
 [-8.24843453e-03  1.88995378e-02]]
grads:  [1.35328968e-02 2.56519455e+01]
Stock Position:  0.013532896787155328
Bond Position:  [-3.25479425]


portfolio before change:  [-1.93799327]
curr_Stock_Price:  97.33376879771188
curr_Factors:  [9.73337688e+01 4.21756492e-02]
mat_Sqrt:  [[ 1.99891546e+01  0.00000000e+00]
 [-8.21468433e-03  1.88222064e-02]]
grads:  [0.01232839 6.00761309]
Stock Position:  0.012328394636519755
Bond Position:  [-3.13796239]


portfolio before change:  [-1.93515031]
curr_Stock_Price:  97.596190214296
curr_Factors:  [9.75961902e+01 4.26306279e-02]
mat_Sqrt:  [[ 2.01508667e+01  0.00000000e+00]
 [-8.25887430e-03  1.89234583e-02]]
grads:  [-0.00264026  0.74877986]
Stock Position:  -0.0026402624940698037
Bond Position:  [-1.67747075]


portfolio before change:  [-1.9373183]
curr_Stock_Price:  98.33789273767393
curr_Factors:  [9.83378927e+01 4.38766132e-02]
mat_Sqrt:  [[ 2.05985878e+01  0.00000000e+00]
 [-8.37869805e-03  1.91980090e-02]]
grads:  [-1.38615377e-03 -7.08392231e+00]
Stock Position:  -0.0013861537667671472
Bond Position:  [-1.80100686]


portfolio before change:  [-1.93935001]
curr_Stock_Price:  99.64119476645129
curr_Factors:  [9.96411948e+01 4.25148364e-02]
mat_Sqrt:  [[ 2.05451437e+01  0.00000000e+00]
 [-8.24765047e-03  1.88977413e-02]]
grads:  [-0.00629584 -1.48437873]
Stock Position:  -0.00629583760587367
Bond Position:  [-1.31202523]


portfolio before change:  [-1.93764257]
curr_Stock_Price:  99.34394219246414
curr_Factors:  [9.93439422e+01 4.35783845e-02]
mat_Sqrt:  [[ 2.07384815e+01  0.00000000e+00]
 [-8.35017456e-03  1.91326535e-02]]
grads:  [-0.00294622 -0.99794555]
Stock Position:  -0.0029462229679047365
Bond Position:  [-1.64495317]


portfolio before change:  [-1.93618104]
curr_Stock_Price:  98.7780783591481
curr_Factors:  [9.87780784e+01 4.35923292e-02]
mat_Sqrt:  [[ 2.06236538e+01  0.00000000e+00]
 [-8.35151045e-03  1.91357144e-02]]
grads:  [ 0.03205833 17.58890098]
Stock Position:  0.03205832629774998
Bond Position:  [-5.10284091]


portfolio before change:  [-1.9537775]
curr_Stock_Price:  98.24908755855922
curr_Factors:  [9.82490876e+01 4.35573533e-02]
mat_Sqrt:  [[ 2.05049761e+01  0.00000000e+00]
 [-8.34815940e-03  1.91280362e-02]]
grads:  [0.00706948 1.79304787]
Stock Position:  0.0070694802893973814
Bond Position:  [-2.64834749]


portfolio before change:  [-1.95337701]
curr_Stock_Price:  98.35256814008687
curr_Factors:  [9.83525681e+01 4.37484665e-02]
mat_Sqrt:  [[ 2.05715550e+01  0.00000000e+00]
 [-8.36645363e-03  1.91699535e-02]]
grads:  [4.40959561e-03 6.09548028e+00]
Stock Position:  0.004409595614953148
Bond Position:  [-2.38707206]


portfolio before change:  [-1.95658742]
curr_Stock_Price:  97.69218870412521
curr_Factors:  [9.76921887e+01 4.58144837e-02]
mat_Sqrt:  [[ 2.09103469e+01  0.00000000e+00]
 [-8.56172727e-03  1.96173817e-02]]
grads:  [0.00388342 3.71895675]
Stock Position:  0.003883423064199093
Bond Position:  [-2.33596752]


portfolio before change:  [-1.96028942]
curr_Stock_Price:  96.81409985191354
curr_Factors:  [9.68140999e+01 4.63838709e-02]
mat_Sqrt:  [[ 2.08507704e+01  0.00000000e+00]
 [-8.61476601e-03  1.97389087e-02]]
grads:  [-0.00149887 -0.55823098]
Stock Position:  -0.00149887240444458
Bond Position:  [-1.81517744]


portfolio before change:  [-1.96154096]
curr_Stock_Price:  97.4976972279547
curr_Factors:  [9.74976972e+01 4.68666679e-02]
mat_Sqrt:  [[ 2.11069945e+01  0.00000000e+00]
 [-8.65948432e-03  1.98413712e-02]]
grads:  [-0.01191161  5.26846824]
Stock Position:  -0.011911607110819799
Bond Position:  [-0.80018669]


portfolio before change:  [-1.9430201]
curr_Stock_Price:  95.93444150356038
curr_Factors:  [9.59344415e+01 4.60981892e-02]
mat_Sqrt:  [[ 2.05975936e+01  0.00000000e+00]
 [-8.58819555e-03  1.96780281e-02]]
grads:  [0.00674313 3.00553979]
Stock Position:  0.006743133704163732
Bond Position:  [-2.58991887]


portfolio before change:  [-1.94524551]
curr_Stock_Price:  95.65242888374996
curr_Factors:  [9.56524289e+01 4.75905400e-02]
mat_Sqrt:  [[ 2.08668224e+01  0.00000000e+00]
 [-8.72610245e-03  1.99940125e-02]]
grads:  [0.07234831 8.05031284]
Stock Position:  0.07234830867779339
Bond Position:  [-8.86553696]


portfolio before change:  [-1.96928791]
curr_Stock_Price:  95.33543264709769
curr_Factors:  [9.53354326e+01 4.60785529e-02]
mat_Sqrt:  [[ 2.04646234e+01  0.00000000e+00]
 [-8.58636621e-03  1.96738365e-02]]
grads:  [9.92564566e-03 2.18059384e+01]
Stock Position:  0.009925645655122033
Bond Position:  [-2.91555363]


portfolio before change:  [-1.98392928]
curr_Stock_Price:  93.89704737771213
curr_Factors:  [9.38970474e+01 4.38421160e-02]
mat_Sqrt:  [[ 1.96606417e+01  0.00000000e+00]
 [-8.37540361e-03  1.91904605e-02]]
grads:  [-3.68268186e-03  9.22702457e+00]
Stock Position:  -0.003682681855235643
Bond Position:  [-1.63813633]


portfolio before change:  [-1.98589151]
curr_Stock_Price:  94.37426667178487
curr_Factors:  [9.43742667e+01 4.29585229e-02]
mat_Sqrt:  [[ 1.95604238e+01  0.00000000e+00]
 [-8.29057517e-03  1.89960941e-02]]
grads:  [-0.00722024  6.11404367]
Stock Position:  -0.0072202415351882605
Bond Position:  [-1.30448651]


portfolio before change:  [-1.98803601]
curr_Stock_Price:  94.64869447223563
curr_Factors:  [9.46486945e+01 4.37326875e-02]
mat_Sqrt:  [[ 1.97932774e+01  0.00000000e+00]
 [-8.36494471e-03  1.91664962e-02]]
grads:  [ 0.00924901 -3.81461323]
Stock Position:  0.009249005092226648
Bond Position:  [-2.86344227]


portfolio before change:  [-1.97719652]
curr_Stock_Price:  95.8593599267959
curr_Factors:  [9.58593599e+01 4.36242136e-02]
mat_Sqrt:  [[ 2.00215792e+01  0.00000000e+00]
 [-8.35456412e-03  1.91427112e-02]]
grads:  [-1.38926760e-02 -2.35708305e+01]
Stock Position:  -0.013892675961774027
Bond Position:  [-0.64545349]


portfolio before change:  [-1.96512454]
curr_Stock_Price:  94.98460686801039
curr_Factors:  [9.49846069e+01 4.50891178e-02]
mat_Sqrt:  [[ 2.01692198e+01  0.00000000e+00]
 [-8.49367933e-03  1.94614642e-02]]
grads:  [0.00465279 1.79211069]
Stock Position:  0.004652792069140706
Bond Position:  [-2.40706817]


portfolio before change:  [-1.96283256]
curr_Stock_Price:  95.54188124234255
curr_Factors:  [9.55418812e+01 4.34989074e-02]
mat_Sqrt:  [[ 1.99265890e+01  0.00000000e+00]
 [-8.34255668e-03  1.91151987e-02]]
grads:  [  0.01650502 -11.61478213]
Stock Position:  0.016505017266024796
Bond Position:  [-3.53975296]


portfolio before change:  [-1.95523365]
curr_Stock_Price:  96.02909129333301
curr_Factors:  [9.60290913e+01 4.35279580e-02]
mat_Sqrt:  [[ 2.00348902e+01  0.00000000e+00]
 [-8.34534199e-03  1.91215807e-02]]
grads:  [ -0.03088595 -11.40089359]
Stock Position:  -0.03088595171276276
Bond Position:  [1.01071623]


portfolio before change:  [-1.94328951]
curr_Stock_Price:  95.64646457025458
curr_Factors:  [9.56464646e+01 4.48764209e-02]
mat_Sqrt:  [[ 2.02618002e+01  0.00000000e+00]
 [-8.47362222e-03  1.94155076e-02]]
grads:  [0.00209716 0.83502123]
Stock Position:  0.00209715792293545
Bond Position:  [-2.14387525]


portfolio before change:  [-1.94544958]
curr_Stock_Price:  94.74425847193481
curr_Factors:  [9.47442585e+01 4.64440239e-02]
mat_Sqrt:  [[ 2.04182173e+01  0.00000000e+00]
 [-8.62035024e-03  1.97517037e-02]]
grads:  [-2.22863723e-03  6.35180371e+00]
Stock Position:  -0.0022286372349294
Bond Position:  [-1.734299]


portfolio before change:  [-1.94419894]
curr_Stock_Price:  94.0858122479292
curr_Factors:  [9.40858122e+01 4.76473124e-02]
mat_Sqrt:  [[ 2.05372998e+01  0.00000000e+00]
 [-8.73130574e-03  2.00059347e-02]]
grads:  [ 0.02487366 11.13282484]
Stock Position:  0.024873659457226277
Bond Position:  [-4.2844574]


portfolio before change:  [-1.95876036]
curr_Stock_Price:  93.5219297214982
curr_Factors:  [9.35219297e+01 4.74534564e-02]
mat_Sqrt:  [[ 2.03726435e+01  0.00000000e+00]
 [-8.71352570e-03  1.99651956e-02]]
grads:  [ 1.33205551e-03 -2.51317599e+00]
Stock Position:  0.0013320555103566766
Bond Position:  [-2.08333676]


portfolio before change:  [-1.95985731]
curr_Stock_Price:  92.89393858281106
curr_Factors:  [9.28939386e+01 4.72894040e-02]
mat_Sqrt:  [[ 2.02008339e+01  0.00000000e+00]
 [-8.69845081e-03  1.99306546e-02]]
grads:  [ 7.77986650e-03 -1.36478679e+01]
Stock Position:  0.007779866498937263
Bond Position:  [-2.68255975]


portfolio before change:  [-1.95003338]
curr_Stock_Price:  94.19978008176916
curr_Factors:  [9.41997801e+01 4.61899293e-02]
mat_Sqrt:  [[ 2.02452683e+01  0.00000000e+00]
 [-8.59673699e-03  1.96975990e-02]]
grads:  [0.00595378 4.24204911]
Stock Position:  0.005953778257776322
Bond Position:  [-2.51087798]


portfolio before change:  [-1.94670204]
curr_Stock_Price:  94.81203212532776
curr_Factors:  [9.48120321e+01 4.61705422e-02]
mat_Sqrt:  [[ 2.03725758e+01  0.00000000e+00]
 [-8.59493266e-03  1.96934648e-02]]
grads:  [7.00717890e-04 8.06890316e+00]
Stock Position:  0.0007007178898876491
Bond Position:  [-2.01313853]


portfolio before change:  [-1.94820443]
curr_Stock_Price:  93.02711357204537
curr_Factors:  [9.30271136e+01 4.68531162e-02]
mat_Sqrt:  [[ 2.01362589e+01  0.00000000e+00]
 [-8.65823226e-03  1.98385024e-02]]
grads:  [-0.02105325 -6.9540741 ]
Stock Position:  -0.021053253814033314
Bond Position:  [0.01031901]


portfolio before change:  [-1.9508058]
curr_Stock_Price:  93.15073646109371
curr_Factors:  [9.31507365e+01 4.55757663e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.9508058]
Stock Price:  94.16631305064101
PL:  [-1.9508058]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.33639086e+00  3.31032413e-01]
 [ 8.16662169e-01  9.44591940e-02]
 [ 1.12089967e-01 -3.90924778e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.27839444e-02  4.84314193e-01]
 [-9.18764568e-02 -1.02136914e-01]
 [ 9.30071490e-02  5.95171830e-02]
 [ 5.06423865e-02  4.04428681e-01]
 [-1.17910850e-01 -9.72247966e-02]
 [ 5.31973100e-02 -1.30767771e-01]
 [-6.79941287e-02 -1.29720705e-02]
 [-2.58188614e-02 -1.35251135e-01]
 [-4.94911603e-02 -2.95180284e-02]
 [ 8.63719858e-04 -1.44965475e-01]
 [ 2.47541621e-01  1.39864032e-01]
 [ 1.21622164e-01 -6.36134080e-01]
 [ 2.19962043e-02 -2.29558546e-01]
 [ 3.52703415e-02 -1.57059264e-01]
 [-1.15307162e-01 -4.55904930e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.35001638e-01 -2.64553169e-02]
 [ 3.76054548e-01 -3.66896616e-01]
 [ 2.96852409e-02 -3.98409627e-01]
 [ 5.82349240e-02  6.23563673e-03]
 [ 2.63007185e-01 -1.69765154e-01]
 [ 1.57435252e-01 -9.37563338e-02]
 [-1.57149392e-01 -3.33650414e-02]
 [ 5.51227019e-02  2.61536646e-01]
 [-2.85062646e-02  1.87290566e-01]
 [-6.06987799e-01 -7.58870204e-02]
 [-1.68486907e-01 -6.37280214e-02]
 [ 9.93298723e-03 -6.10280946e-02]
 [-1.71997255e-01  1.48047882e-01]
 [ 2.86375180e-02  2.98676192e-02]
 [-2.97146389e-02  6.78841807e-02]
 [-1.47179944e-01  1.09773003e-01]
 [-2.96311390e-02 -1.58161756e-01]
 [ 2.07186694e-03 -2.50974863e-02]
 [ 8.91161625e-02 -1.23558069e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.4207269]
curr_Stock_Price:  99.9621413646851
curr_Factors:  [9.99621414e+01 4.07344098e-02]
mat_Sqrt:  [[ 2.01751264e+01  0.00000000e+00]
 [-8.07310694e-03  1.84978118e-02]]
grads:  [ 0.07340054 17.89576066]
Stock Position:  0.07340054376489966
Bond Position:  [-4.91654863]


portfolio before change:  [2.36108583]
curr_Stock_Price:  99.15797197350653
curr_Factors:  [9.9157972e+01 4.1431969e-02]
mat_Sqrt:  [[ 2.01834509e+01  0.00000000e+00]
 [-8.14193775e-03  1.86555230e-02]]
grads:  [0.0425045  5.06333668]
Stock Position:  0.04250450260971297
Bond Position:  [-1.85357445]


portfolio before change:  [2.3880057]
curr_Stock_Price:  99.79676507426873
curr_Factors:  [9.97967651e+01 4.33024622e-02]
mat_Sqrt:  [[ 2.07669520e+01  0.00000000e+00]
 [-8.32369747e-03  1.90719869e-02]]
grads:  [ 0.00457595 -2.04973284]
Stock Position:  0.004575953694195643
Bond Position:  [1.93134032]


portfolio before change:  [2.38012084]
curr_Stock_Price:  98.02089783082833
curr_Factors:  [9.80208978e+01 4.34117356e-02]
mat_Sqrt:  [[ 2.04231276e+01  0.00000000e+00]
 [-8.33419324e-03  1.90960357e-02]]
grads:  [-7.98181713e-04 -7.92765655e+00]
Stock Position:  -0.0007981817125300285
Bond Position:  [2.45835933]


portfolio before change:  [2.38024805]
curr_Stock_Price:  98.24654699837265
curr_Factors:  [9.8246547e+01 4.4489237e-02]
mat_Sqrt:  [[ 2.07226253e+01  0.00000000e+00]
 [-8.43698875e-03  1.93315698e-02]]
grads:  [5.72263874e-03 2.50530194e+01]
Stock Position:  0.005722638737454247
Bond Position:  [1.81801855]


portfolio before change:  [2.38548526]
curr_Stock_Price:  99.12200761584675
curr_Factors:  [9.91220076e+01 4.56058527e-02]
mat_Sqrt:  [[ 2.11680270e+01  0.00000000e+00]
 [-8.54221074e-03  1.95726637e-02]]
grads:  [-0.00644617 -5.21834513]
Stock Position:  -0.006446168127207442
Bond Position:  [3.02444239]


portfolio before change:  [2.37993851]
curr_Stock_Price:  100.04113273236091
curr_Factors:  [1.00041133e+02 4.59815075e-02]
mat_Sqrt:  [[ 2.14521193e+01  0.00000000e+00]
 [-8.57731963e-03  1.96531082e-02]]
grads:  [0.00554643 3.02838524]
Stock Position:  0.005546425299866132
Bond Position:  [1.82506784]


portfolio before change:  [2.38575193]
curr_Stock_Price:  101.04813694192865
curr_Factors:  [1.01048137e+02 4.51107545e-02]
mat_Sqrt:  [[ 2.14619093e+01  0.00000000e+00]
 [-8.49571699e-03  1.94661331e-02]]
grads:  [1.05838455e-02 2.07760154e+01]
Stock Position:  0.010583845541193198
Bond Position:  [1.31627405]


portfolio before change:  [2.38930439]
curr_Stock_Price:  101.36823949801254
curr_Factors:  [1.01368239e+02 4.46717352e-02]
mat_Sqrt:  [[ 2.14248759e+01  0.00000000e+00]
 [-8.45427563e-03  1.93711790e-02]]
grads:  [-0.00748397 -5.01904384]
Stock Position:  -0.007483974712331115
Bond Position:  [3.14794173]


portfolio before change:  [2.39055522]
curr_Stock_Price:  101.25368544052733
curr_Factors:  [1.01253685e+02 4.37502962e-02]
mat_Sqrt:  [[ 2.11787995e+01  0.00000000e+00]
 [-8.36662859e-03  1.91703544e-02]]
grads:  [-1.82938800e-04 -6.82135386e+00]
Stock Position:  -0.00018293879955759033
Bond Position:  [2.40907845]


portfolio before change:  [2.39056804]
curr_Stock_Price:  102.82984255759804
curr_Factors:  [1.02829843e+02 4.01839141e-02]
mat_Sqrt:  [[ 2.06131939e+01  0.00000000e+00]
 [-8.01837032e-03  1.83723945e-02]]
grads:  [-0.00357323 -0.70606314]
Stock Position:  -0.003573226191842407
Bond Position:  [2.75800232]


portfolio before change:  [2.39363639]
curr_Stock_Price:  102.06762454756252
curr_Factors:  [1.02067625e+02 4.01377501e-02]
mat_Sqrt:  [[ 2.04486443e+01  0.00000000e+00]
 [-8.01376317e-03  1.83618382e-02]]
grads:  [-4.14928711e-03 -7.36588210e+00]
Stock Position:  -0.004149287113845892
Bond Position:  [2.81714427]


portfolio before change:  [2.3847824]
curr_Stock_Price:  104.28635454960136
curr_Factors:  [1.04286355e+02 3.86584464e-02]
mat_Sqrt:  [[ 2.05045237e+01  0.00000000e+00]
 [-7.86470052e-03  1.80202927e-02]]
grads:  [-0.00304196 -1.63804378]
Stock Position:  -0.0030419572301711795
Bond Position:  [2.70201703]


portfolio before change:  [2.39025993]
curr_Stock_Price:  102.59673577176498
curr_Factors:  [1.02596736e+02 4.11630216e-02]
mat_Sqrt:  [[ 2.08155153e+01  0.00000000e+00]
 [-8.11546885e-03  1.85948751e-02]]
grads:  [-2.99797527e-03 -7.79599076e+00]
Stock Position:  -0.0029979752749286935
Bond Position:  [2.6978424]


portfolio before change:  [2.39126807]
curr_Stock_Price:  102.37295269381416
curr_Factors:  [1.02372953e+02 4.16936957e-02]
mat_Sqrt:  [[ 2.09035682e+01  0.00000000e+00]
 [-8.16761368e-03  1.87143540e-02]]
grads:  [0.01476223 7.4736233 ]
Stock Position:  0.014762230337547678
Bond Position:  [0.88001496]


portfolio before change:  [2.40019564]
curr_Stock_Price:  102.97025828285106
curr_Factors:  [1.02970258e+02 3.98123348e-02]
mat_Sqrt:  [[ 2.05456850e+01  0.00000000e+00]
 [-7.98121142e-03  1.82872527e-02]]
grads:  [-7.59329801e-03 -3.47856558e+01]
Stock Position:  -0.007593298010364126
Bond Position:  [3.1820795]


portfolio before change:  [2.39165509]
curr_Stock_Price:  104.14739325896231
curr_Factors:  [1.04147393e+02 4.06041655e-02]
mat_Sqrt:  [[ 2.09861948e+01  0.00000000e+00]
 [-8.06019012e-03  1.84682157e-02]]
grads:  [-3.72584740e-03 -1.24299256e+01]
Stock Position:  -0.003725847396246908
Bond Position:  [2.77969239]


portfolio before change:  [2.39318467]
curr_Stock_Price:  103.8301249394905
curr_Factors:  [1.03830125e+02 4.10574491e-02]
mat_Sqrt:  [[ 2.10387221e+01  0.00000000e+00]
 [-8.10505512e-03  1.85710143e-02]]
grads:  [-1.58165218e-03 -8.45722592e+00]
Stock Position:  -0.0015816521781943942
Bond Position:  [2.55740781]


portfolio before change:  [2.39391762]
curr_Stock_Price:  103.56884233701612
curr_Factors:  [1.03568842e+02 4.22139055e-02]
mat_Sqrt:  [[ 2.12792780e+01  0.00000000e+00]
 [-8.21840914e-03  1.88307410e-02]]
grads:  [-1.47693162e-02 -2.42106740e+01]
Stock Position:  -0.014769316212085184
Bond Position:  [3.92355861]


portfolio before change:  [2.39659418]
curr_Stock_Price:  103.42082708974641
curr_Factors:  [1.03420827e+02 4.21556485e-02]
mat_Sqrt:  [[ 2.12341995e+01  0.00000000e+00]
 [-8.21273630e-03  1.88177429e-02]]
grads:  [-2.28221789e-04 -5.79736847e+00]
Stock Position:  -0.00022822178914467473
Bond Position:  [2.42019707]


portfolio before change:  [2.39678123]
curr_Stock_Price:  103.9268752190479
curr_Factors:  [1.03926875e+02 4.30731144e-02]
mat_Sqrt:  [[ 2.15690495e+01  0.00000000e+00]
 [-8.30162533e-03  1.90214132e-02]]
grads:  [ 0.00572374 -1.39081763]
Stock Position:  0.00572373814330774
Bond Position:  [1.80193101]


portfolio before change:  [2.3965944]
curr_Stock_Price:  103.85487793744522
curr_Factors:  [1.03854878e+02 4.06634872e-02]
mat_Sqrt:  [[ 2.09425331e+01  0.00000000e+00]
 [-8.06607585e-03  1.84817016e-02]]
grads:  [ 1.03104881e-02 -1.98518851e+01]
Stock Position:  0.01031048806144431
Bond Position:  [1.32579992]


portfolio before change:  [2.38632028]
curr_Stock_Price:  102.84233099142054
curr_Factors:  [1.02842331e+02 4.00171382e-02]
mat_Sqrt:  [[ 2.05728721e+01  0.00000000e+00]
 [-8.00171364e-03  1.83342292e-02]]
grads:  [-7.00898615e-03 -2.17303723e+01]
Stock Position:  -0.007008986153427537
Bond Position:  [3.10714075]


portfolio before change:  [2.39502019]
curr_Stock_Price:  101.65649700253229
curr_Factors:  [1.01656497e+02 4.00597634e-02]
mat_Sqrt:  [[ 2.03464821e+01  0.00000000e+00]
 [-8.00597410e-03  1.83439912e-02]]
grads:  [0.00299592 0.33992803]
Stock Position:  0.0029959173669218365
Bond Position:  [2.09046572]


portfolio before change:  [2.3945092]
curr_Stock_Price:  101.3987080315954
curr_Factors:  [1.01398708e+02 4.06842684e-02]
mat_Sqrt:  [[ 2.04524659e+01  0.00000000e+00]
 [-8.06813668e-03  1.84864235e-02]]
grads:  [ 0.00923681 -9.18323403]
Stock Position:  0.009236812765960391
Bond Position:  [1.45790832]


portfolio before change:  [2.38179605]
curr_Stock_Price:  100.00262035578666
curr_Factors:  [1.00002620e+02 4.07667649e-02]
mat_Sqrt:  [[ 2.01913104e+01  0.00000000e+00]
 [-8.07631251e-03  1.85051567e-02]]
grads:  [ 0.00577063 -5.06649769]
Stock Position:  0.005770632586041701
Bond Position:  [1.80471767]


portfolio before change:  [2.39131135]
curr_Stock_Price:  101.61244365813386
curr_Factors:  [1.01612444e+02 4.07686112e-02]
mat_Sqrt:  [[ 2.05168108e+01  0.00000000e+00]
 [-8.07649539e-03  1.85055757e-02]]
grads:  [-0.00836929 -1.80297235]
Stock Position:  -0.008369287573717988
Bond Position:  [3.24173511]


portfolio before change:  [2.39603386]
curr_Stock_Price:  101.09659714331771
curr_Factors:  [1.01096597e+02 4.32926620e-02]
mat_Sqrt:  [[ 2.10350565e+01  0.00000000e+00]
 [-8.32275551e-03  1.90698285e-02]]
grads:  [8.04688364e-03 1.37146826e+01]
Stock Position:  0.008046883636569921
Bond Position:  [1.58252131]


portfolio before change:  [2.40133936]
curr_Stock_Price:  101.7313357358475
curr_Factors:  [1.01731336e+02 4.36936009e-02]
mat_Sqrt:  [[ 2.12649157e+01  0.00000000e+00]
 [-8.36120574e-03  1.91579291e-02]]
grads:  [2.50337412e-03 9.77613838e+00]
Stock Position:  0.0025033741233994383
Bond Position:  [2.14666776]


portfolio before change:  [2.4021711]
curr_Stock_Price:  101.9563909925103
curr_Factors:  [1.01956391e+02 4.14891226e-02]
mat_Sqrt:  [[ 2.07673738e+01  0.00000000e+00]
 [-8.14755154e-03  1.86683858e-02]]
grads:  [-0.03082275 -4.06500171]
Stock Position:  -0.03082275196187257
Bond Position:  [5.54474766]


portfolio before change:  [2.43170648]
curr_Stock_Price:  101.0206459495974
curr_Factors:  [1.01020646e+02 4.26979572e-02]
mat_Sqrt:  [[ 2.08743850e+01  0.00000000e+00]
 [-8.26539361e-03  1.89383959e-02]]
grads:  [-0.00940387 -3.36501685]
Stock Position:  -0.00940387444099348
Bond Position:  [3.38169195]


portfolio before change:  [2.44642434]
curr_Stock_Price:  99.50051489386789
curr_Factors:  [9.95005149e+01 4.35390847e-02]
mat_Sqrt:  [[ 2.07617987e+01  0.00000000e+00]
 [-8.34640854e-03  1.91240245e-02]]
grads:  [-8.04451345e-04 -3.19117426e+00]
Stock Position:  -0.0008044513447509004
Bond Position:  [2.52646766]


portfolio before change:  [2.44644532]
curr_Stock_Price:  99.86702816987962
curr_Factors:  [9.98670282e+01 4.29742019e-02]
mat_Sqrt:  [[ 2.07026546e+01  0.00000000e+00]
 [-8.29208797e-03  1.89995604e-02]]
grads:  [-5.18696103e-03  7.79217405e+00]
Stock Position:  -0.005186961032699961
Bond Position:  [2.96445171]


portfolio before change:  [2.44733316]
curr_Stock_Price:  99.76730662808608
curr_Factors:  [9.97673066e+01 4.39188492e-02]
mat_Sqrt:  [[ 2.09080593e+01  0.00000000e+00]
 [-8.38272978e-03  1.92072469e-02]]
grads:  [0.00199315 1.55501824]
Stock Position:  0.001993146045194449
Bond Position:  [2.24848234]


portfolio before change:  [2.44694204]
curr_Stock_Price:  99.4300543191799
curr_Factors:  [9.94300543e+01 4.30885837e-02]
mat_Sqrt:  [[ 2.06394817e+01  0.00000000e+00]
 [-8.30311592e-03  1.90248286e-02]]
grads:  [-4.24204126e-06  3.56818882e+00]
Stock Position:  -4.242041258045831e-06
Bond Position:  [2.44736383]


portfolio before change:  [2.44724945]
curr_Stock_Price:  99.08450378630351
curr_Factors:  [9.90845038e+01 4.32591804e-02]
mat_Sqrt:  [[ 2.06084288e+01  0.00000000e+00]
 [-8.31953656e-03  1.90624530e-02]]
grads:  [-4.81701338e-03  5.75859794e+00]
Stock Position:  -0.004817013383801731
Bond Position:  [2.92454083]


portfolio before change:  [2.44504666]
curr_Stock_Price:  99.61769319364224
curr_Factors:  [9.96176932e+01 4.37198097e-02]
mat_Sqrt:  [[ 2.08293449e+01  0.00000000e+00]
 [-8.36371302e-03  1.91636740e-02]]
grads:  [-4.73651901e-03 -8.25320633e+00]
Stock Position:  -0.004736519007141855
Bond Position:  [2.91688775]


portfolio before change:  [2.4434379]
curr_Stock_Price:  100.0343258305898
curr_Factors:  [1.00034326e+02 4.19320613e-02]
mat_Sqrt:  [[ 2.04843485e+01  0.00000000e+00]
 [-8.19092779e-03  1.87677733e-02]]
grads:  [-4.33578549e-04 -1.33726500e+00]
Stock Position:  -0.00043357854907334484
Bond Position:  [2.48681064]


portfolio before change:  [2.44426234]
curr_Stock_Price:  98.84984834372517
curr_Factors:  [9.88498483e+01 4.30758851e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.44426234]
Stock Price:  96.90975098436628
PL:  [2.44426234]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.29946920e+00  3.22685164e-01]
 [ 2.52326101e-01  1.03910815e-01]
 [-1.39924203e-01 -9.35379534e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.71517358e-02  1.86802139e-01]
 [-9.57838800e-02 -9.82376148e-02]
 [ 1.03383968e-01  7.32285047e-03]
 [ 2.32349315e-01  4.51452318e-01]
 [-7.39613509e-02  8.90161879e-02]
 [ 1.80968082e-01  4.33607101e-02]
 [-8.09686202e-02 -1.02030451e-02]
 [-5.66569498e-03 -1.36256130e-01]
 [-5.76312803e-02 -1.79897106e-02]
 [-3.21239776e-02 -5.66568281e-02]
 [ 2.87320093e-01  1.68785108e-01]
 [ 1.27649677e-01 -5.67514420e-01]
 [ 2.82267115e-02 -1.45578189e-01]
 [ 2.82319771e-02 -1.49385121e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 3.28747859e-02 -1.03302585e-01]
 [ 1.58722672e-01 -3.42030782e-02]
 [ 6.61334180e-01 -1.17576734e-01]
 [ 3.06976971e-02 -4.24810541e-01]
 [ 3.66140789e-02  3.69829747e-02]
 [ 4.28383570e-01 -3.65553824e-01]
 [-1.23555972e-01 -1.17627854e-02]
 [-1.85110504e-01  1.93738819e-03]
 [-7.36371313e-03  2.34625839e-01]
 [-5.15323086e-02  1.98948134e-01]
 [-6.68233093e-01 -5.25470049e-02]
 [-1.68229627e-01 -6.34470022e-02]
 [ 1.04413797e-02 -6.85885615e-02]
 [-2.11783520e-01  1.41691188e-01]
 [ 6.39857644e-02  6.29488938e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.35176023e-01  7.35347280e-02]
 [-2.48148325e-02 -2.00963081e-01]
 [-7.16168675e-02 -5.08299225e-02]
 [ 1.09941477e-01 -1.27121381e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.48276129]
curr_Stock_Price:  100.11630092937179
curr_Factors:  [1.00116301e+02 3.88852560e-02]
mat_Sqrt:  [[ 1.97422786e+01  0.00000000e+00]
 [-7.88773792e-03  1.80730780e-02]]
grads:  [ 0.07295513 17.85446639]
Stock Position:  0.07295513236431342
Bond Position:  [-3.82123669]


portfolio before change:  [3.51084752]
curr_Stock_Price:  100.50782809157832
curr_Factors:  [1.00507828e+02 3.83954891e-02]
mat_Sqrt:  [[ 1.96942747e+01  0.00000000e+00]
 [-7.83790677e-03  1.79589005e-02]]
grads:  [0.01511487 5.78603432]
Stock Position:  0.015114874950319405
Bond Position:  [1.99168427]


portfolio before change:  [3.52573307]
curr_Stock_Price:  101.47618342965325
curr_Factors:  [1.01476183e+02 3.80892641e-02]
mat_Sqrt:  [[ 1.98045699e+01  0.00000000e+00]
 [-7.80658840e-03  1.78871411e-02]]
grads:  [-0.00912656 -5.2293406 ]
Stock Position:  -0.009126555801573568
Bond Position:  [4.45186112]


portfolio before change:  [3.53259367]
curr_Stock_Price:  100.78544317835343
curr_Factors:  [1.00785443e+02 3.71194165e-02]
mat_Sqrt:  [[ 1.94177265e+01  0.00000000e+00]
 [-7.70655996e-03  1.76579472e-02]]
grads:  [-8.39509555e-04 -8.57329626e+00]
Stock Position:  -0.0008395095554415486
Bond Position:  [3.61720401]


portfolio before change:  [3.53429379]
curr_Stock_Price:  99.2989227698872
curr_Factors:  [9.92989228e+01 3.87290893e-02]
mat_Sqrt:  [[ 1.95417377e+01  0.00000000e+00]
 [-7.87188305e-03  1.80367500e-02]]
grads:  [2.23900329e-04 1.03567516e+01]
Stock Position:  0.00022390032857052522
Bond Position:  [3.51206073]


portfolio before change:  [3.53470124]
curr_Stock_Price:  99.15783442017377
curr_Factors:  [9.91578344e+01 3.94587550e-02]
mat_Sqrt:  [[ 1.96969382e+01  0.00000000e+00]
 [-7.94569116e-03  1.82058656e-02]]
grads:  [-0.00703959 -5.39593211]
Stock Position:  -0.00703958598075211
Bond Position:  [4.23273134]


portfolio before change:  [3.52544239]
curr_Stock_Price:  100.54825364224648
curr_Factors:  [1.00548254e+02 3.93163455e-02]
mat_Sqrt:  [[ 1.99370594e+01  0.00000000e+00]
 [-7.93133991e-03  1.81729827e-02]]
grads:  [0.00534582 0.40295259]
Stock Position:  0.0053458195223593085
Bond Position:  [2.98792957]


portfolio before change:  [3.52578651]
curr_Stock_Price:  100.54275457444524
curr_Factors:  [1.00542755e+02 3.81456114e-02]
mat_Sqrt:  [[ 1.96369064e+01  0.00000000e+00]
 [-7.81236060e-03  1.79003669e-02]]
grads:  [2.1865932e-02 2.5220283e+01]
Stock Position:  0.02186593204977401
Bond Position:  [1.32732547]


portfolio before change:  [3.51156389]
curr_Stock_Price:  99.88471997294133
curr_Factors:  [9.98847200e+01 3.69359145e-02]
mat_Sqrt:  [[ 1.91965633e+01  0.00000000e+00]
 [-7.68748745e-03  1.76142466e-02]]
grads:  [-1.82905143e-03  5.05364720e+00]
Stock Position:  -0.0018290514251509862
Bond Position:  [3.69425818]


portfolio before change:  [3.51189538]
curr_Stock_Price:  99.95597200809766
curr_Factors:  [9.99559720e+01 3.65298288e-02]
mat_Sqrt:  [[ 1.91043632e+01  0.00000000e+00]
 [-7.64511125e-03  1.75171505e-02]]
grads:  [0.01046317 2.47532897]
Stock Position:  0.010463172488865774
Bond Position:  [2.4660388]


portfolio before change:  [3.52240275]
curr_Stock_Price:  100.93073329815407
curr_Factors:  [1.00930733e+02 3.62241778e-02]
mat_Sqrt:  [[ 1.92097935e+01  0.00000000e+00]
 [-7.61306013e-03  1.74437122e-02]]
grads:  [-0.00444677 -0.58491249]
Stock Position:  -0.004446773154251222
Bond Position:  [3.97121882]


portfolio before change:  [3.52121445]
curr_Stock_Price:  101.3095996805871
curr_Factors:  [1.01309600e+02 3.62158691e-02]
mat_Sqrt:  [[ 1.92796904e+01  0.00000000e+00]
 [-7.61218698e-03  1.74417115e-02]]
grads:  [-3.37830867e-03 -7.81208481e+00]
Stock Position:  -0.0033783086712040706
Bond Position:  [3.86346955]


portfolio before change:  [3.52062362]
curr_Stock_Price:  101.6274476669885
curr_Factors:  [1.01627448e+02 3.65874672e-02]
mat_Sqrt:  [[ 1.94391464e+01  0.00000000e+00]
 [-7.65114028e-03  1.75309647e-02]]
grads:  [-0.0033686  -1.02616775]
Stock Position:  -0.003368596138971021
Bond Position:  [3.86296545]


portfolio before change:  [3.5201475]
curr_Stock_Price:  101.9121443997751
curr_Factors:  [1.01912144e+02 3.63691183e-02]
mat_Sqrt:  [[ 1.94353482e+01  0.00000000e+00]
 [-7.62827564e-03  1.74785753e-02]]
grads:  [-2.92513641e-03 -3.24150151e+00]
Stock Position:  -0.0029251364055799416
Bond Position:  [3.81825442]


portfolio before change:  [3.52052245]
curr_Stock_Price:  101.94713712030331
curr_Factors:  [1.01947137e+02 3.66963965e-02]
mat_Sqrt:  [[ 1.95293030e+01  0.00000000e+00]
 [-7.66252141e-03  1.75570422e-02]]
grads:  [0.01848422 9.6135275 ]
Stock Position:  0.018484221026343093
Bond Position:  [1.63610904]


portfolio before change:  [3.52981507]
curr_Stock_Price:  102.43880462069085
curr_Factors:  [1.02438805e+02 3.77913133e-02]
mat_Sqrt:  [[ 1.99140913e+01  0.00000000e+00]
 [-7.77599520e-03  1.78170433e-02]]
grads:  [-6.02758722e-03 -3.18523343e+01]
Stock Position:  -0.006027587217145255
Bond Position:  [4.1472739]


portfolio before change:  [3.52964629]
curr_Stock_Price:  102.5528169141711
curr_Factors:  [1.02552817e+02 3.97259753e-02]
mat_Sqrt:  [[ 2.04401876e+01  0.00000000e+00]
 [-7.97255044e-03  1.82674079e-02]]
grads:  [-1.72742147e-03 -7.96928548e+00]
Stock Position:  -0.001727421465408972
Bond Position:  [3.70679823]


portfolio before change:  [3.53239523]
curr_Stock_Price:  101.22971404651284
curr_Factors:  [1.01229714e+02 3.98102199e-02]
mat_Sqrt:  [[ 2.01978572e+01  0.00000000e+00]
 [-7.98099942e-03  1.82867670e-02]]
grads:  [-1.83014636e-03 -8.16902852e+00]
Stock Position:  -0.0018301463562412907
Bond Position:  [3.71766042]


portfolio before change:  [3.53144036]
curr_Stock_Price:  102.00539195290561
curr_Factors:  [1.02005392e+02 3.94020850e-02]
mat_Sqrt:  [[ 2.02480279e+01  0.00000000e+00]
 [-7.93998338e-03  1.81927874e-02]]
grads:  [-1.57434169e-02 -2.57952579e+01]
Stock Position:  -0.015743416888279203
Bond Position:  [5.13735377]


portfolio before change:  [3.52539787]
curr_Stock_Price:  102.42999489523216
curr_Factors:  [1.02429995e+02 3.83280477e-02]
mat_Sqrt:  [[ 2.00532838e+01  0.00000000e+00]
 [-7.83102013e-03  1.79431213e-02]]
grads:  [-6.08885733e-04 -5.75722493e+00]
Stock Position:  -0.0006088857329008687
Bond Position:  [3.58776603]


portfolio before change:  [3.52590324]
curr_Stock_Price:  102.33658844952242
curr_Factors:  [1.02336588e+02 3.89404934e-02]
mat_Sqrt:  [[ 2.01944328e+01  0.00000000e+00]
 [-7.89333830e-03  1.80859101e-02]]
grads:  [ 0.00712054 -1.89114498]
Stock Position:  0.007120537924760539
Bond Position:  [2.79721168]


portfolio before change:  [3.5169906]
curr_Stock_Price:  101.03580005786141
curr_Factors:  [1.01035800e+02 3.96662605e-02]
mat_Sqrt:  [[ 2.01226843e+01  0.00000000e+00]
 [-7.96655614e-03  1.82536733e-02]]
grads:  [ 0.03031502 -6.44126428]
Stock Position:  0.03031501542545534
Bond Position:  [0.45408876]


portfolio before change:  [3.54629754]
curr_Stock_Price:  102.0006741428327
curr_Factors:  [1.02000674e+02 3.89875286e-02]
mat_Sqrt:  [[ 2.01402982e+01  0.00000000e+00]
 [-7.89810394e-03  1.80968296e-02]]
grads:  [-7.68135714e-03 -2.34743074e+01]
Stock Position:  -0.007681357136005646
Bond Position:  [4.32980114]


portfolio before change:  [3.53001732]
curr_Stock_Price:  104.19058285902669
curr_Factors:  [1.04190583e+02 3.81138547e-02]
mat_Sqrt:  [[ 2.03408878e+01  0.00000000e+00]
 [-7.80910799e-03  1.78929142e-02]]
grads:  [0.00259353 2.06690616]
Stock Position:  0.002593533419962
Bond Position:  [3.25979557]


portfolio before change:  [3.52975805]
curr_Stock_Price:  103.93349067755935
curr_Factors:  [1.03933491e+02 3.83094434e-02]
mat_Sqrt:  [[ 2.03426925e+01  0.00000000e+00]
 [-7.82911933e-03  1.79387660e-02]]
grads:  [ 1.32156941e-02 -2.03778690e+01]
Stock Position:  0.013215694086888014
Bond Position:  [2.15620483]


portfolio before change:  [3.52117971]
curr_Stock_Price:  103.26399284764332
curr_Factors:  [1.03263993e+02 4.02672467e-02]
mat_Sqrt:  [[ 2.07216761e+01  0.00000000e+00]
 [-8.02668018e-03  1.83914348e-02]]
grads:  [-0.00621039 -0.63957954]
Stock Position:  -0.006210389129432819
Bond Position:  [4.16248929]


portfolio before change:  [3.53010844]
curr_Stock_Price:  101.91006983899454
curr_Factors:  [1.01910070e+02 4.12332367e-02]
mat_Sqrt:  [[ 2.06938269e+01  0.00000000e+00]
 [-8.12238750e-03  1.86107278e-02]]
grads:  [-0.00890434  0.10410061]
Stock Position:  -0.008904344212012635
Bond Position:  [4.43755078]


portfolio before change:  [3.52451085]
curr_Stock_Price:  102.601005124935
curr_Factors:  [1.02601005e+02 4.08749759e-02]
mat_Sqrt:  [[ 2.07434205e+01  0.00000000e+00]
 [-8.08702427e-03  1.85297004e-02]]
grads:  [4.58147190e-03 1.26621496e+01]
Stock Position:  0.004581471901296845
Bond Position:  [3.05444722]


portfolio before change:  [3.5286386]
curr_Stock_Price:  103.41862935396516
curr_Factors:  [1.03418629e+02 4.11406062e-02]
mat_Sqrt:  [[ 2.09765529e+01  0.00000000e+00]
 [-8.11325890e-03  1.85898115e-02]]
grads:  [1.68262991e-03 1.07019984e+01]
Stock Position:  0.0016826299133129421
Bond Position:  [3.35462332]


portfolio before change:  [3.52874062]
curr_Stock_Price:  103.23003344071829
curr_Factors:  [1.03230033e+02 4.05418189e-02]
mat_Sqrt:  [[ 2.07853663e+01  0.00000000e+00]
 [-8.05399964e-03  1.84540315e-02]]
grads:  [-0.03325255 -2.84745395]
Stock Position:  -0.03325255258658899
Bond Position:  [6.96140273]


portfolio before change:  [3.61857746]
curr_Stock_Price:  100.55455109370118
curr_Factors:  [1.00554551e+02 4.28108290e-02]
mat_Sqrt:  [[ 2.08055188e+01  0.00000000e+00]
 [-8.27631116e-03  1.89634112e-02]]
grads:  [-0.00941674 -3.34575892]
Stock Position:  -0.009416740349278495
Bond Position:  [4.56547356]


portfolio before change:  [3.6177715]
curr_Stock_Price:  100.70074658912266
curr_Factors:  [1.00700747e+02 4.23263751e-02]
mat_Sqrt:  [[ 2.07175420e+01  0.00000000e+00]
 [-8.22934993e-03  1.88558095e-02]]
grads:  [-9.40899391e-04 -3.63752941e+00]
Stock Position:  -0.0009408993910608783
Bond Position:  [3.71252077]


portfolio before change:  [3.61864657]
curr_Stock_Price:  100.26395381343697
curr_Factors:  [1.00263954e+02 4.27211716e-02]
mat_Sqrt:  [[ 2.07236574e+01  0.00000000e+00]
 [-8.26764020e-03  1.89435435e-02]]
grads:  [-7.23542246e-03  7.47965596e+00]
Stock Position:  -0.007235422463928969
Bond Position:  [4.34409863]


portfolio before change:  [3.61225683]
curr_Stock_Price:  101.22212706858056
curr_Factors:  [1.01222127e+02 4.26432603e-02]
mat_Sqrt:  [[ 2.09026169e+01  0.00000000e+00]
 [-8.26009785e-03  1.89262618e-02]]
grads:  [0.00437548 3.32600776]
Stock Position:  0.004375476747480133
Bond Position:  [3.16936176]


portfolio before change:  [3.61602016]
curr_Stock_Price:  101.99167376103388
curr_Factors:  [1.01991674e+02 4.31561408e-02]
mat_Sqrt:  [[ 2.11878076e+01  0.00000000e+00]
 [-8.30962246e-03  1.90397369e-02]]
grads:  [-0.00446802  4.2713377 ]
Stock Position:  -0.004468022964814834
Bond Position:  [4.0717213]


portfolio before change:  [3.61991708]
curr_Stock_Price:  101.23341324648112
curr_Factors:  [1.01233413e+02 4.34106034e-02]
mat_Sqrt:  [[ 2.10921957e+01  0.00000000e+00]
 [-8.33408456e-03  1.90957867e-02]]
grads:  [-0.00962834  3.85083523]
Stock Position:  -0.009628340241615954
Bond Position:  [4.59462683]


portfolio before change:  [3.62881375]
curr_Stock_Price:  100.36905746655614
curr_Factors:  [1.00369057e+02 4.55072763e-02]
mat_Sqrt:  [[ 2.14111635e+01  0.00000000e+00]
 [-8.53297381e-03  1.95514992e-02]]
grads:  [-5.25531048e-03 -1.02786533e+01]
Stock Position:  -0.00525531047871465
Bond Position:  [4.15628431]


portfolio before change:  [3.6359774]
curr_Stock_Price:  99.10479761681812
curr_Factors:  [9.91047976e+01 4.59785055e-02]
mat_Sqrt:  [[ 2.12506444e+01  0.00000000e+00]
 [-8.57703963e-03  1.96524667e-02]]
grads:  [-0.00441402 -2.58643983]
Stock Position:  -0.004414024465937207
Bond Position:  [4.0734284]


portfolio before change:  [3.6388332]
curr_Stock_Price:  98.57317531055322
curr_Factors:  [9.85731753e+01 4.55074470e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.6388332]
Stock Price:  99.00565348476516
PL:  [3.6388332]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.20343886e+00  3.00974630e-01]
 [ 5.16461826e-02  4.23771812e-02]
 [-3.99792657e-02 -6.73227827e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.52261282e-02 -1.92327013e-02]
 [-1.52626640e-02 -1.14754928e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 4.70683103e-01  5.45610071e-01]
 [-7.21833456e-02  9.57560279e-02]
 [ 1.73372317e-01  4.01811772e-02]
 [-7.77776099e-02 -1.10002504e-02]
 [-7.73825121e-02 -1.50514732e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.56198062e-02 -3.59166038e-02]
 [ 5.16488366e-01  3.38745394e-01]
 [ 1.30265978e-01 -1.12894338e-01]
 [ 3.97395240e-02  1.17649629e-01]
 [ 4.95029754e-02  7.27025473e-02]
 [-5.00079311e-02 -3.40403755e-02]
 [-7.66635971e-02 -3.53614437e-02]
 [ 1.72122327e-01 -4.05113730e-02]
 [ 7.30870888e-01 -7.49513516e-02]
 [ 2.56692101e-02 -1.70786320e-01]
 [ 3.19956801e-02  1.55153291e-02]
 [ 1.24846524e-01 -4.80079957e-02]
 [ 1.19035104e-01 -1.07237681e-01]
 [-1.95548507e-01 -4.26205780e-01]
 [ 6.04377931e-02  7.35855815e-02]
 [ 2.49304520e-01 -2.18276649e-02]
 [-5.25220766e-01 -1.11647716e-01]
 [-1.68452334e-01 -6.36902582e-02]
 [ 7.18089357e-03 -6.02575344e-02]
 [-1.52414689e-01  1.51176609e-01]
 [ 6.29697752e-02  6.20650738e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.37388769e-01 -1.02123507e-02]
 [-2.60559046e-02 -1.90042786e-01]
 [ 1.44888721e-02 -3.32742263e-02]
 [-5.39527299e-02 -5.78071756e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.43176497]
curr_Stock_Price:  100.54436345548434
curr_Factors:  [1.00544363e+02 4.18261754e-02]
mat_Sqrt:  [[ 2.05627789e+01  0.00000000e+00]
 [-8.18057948e-03  1.87440623e-02]]
grads:  [ 0.06491316 16.05706513]
Stock Position:  0.06491316006224751
Bond Position:  [-0.09488739]


portfolio before change:  [6.45225211]
curr_Stock_Price:  100.86015453317435
curr_Factors:  [1.00860155e+02 4.23017996e-02]
mat_Sqrt:  [[ 2.07443127e+01  0.00000000e+00]
 [-8.22696052e-03  1.88503347e-02]]
grads:  [0.00338122 2.24808641]
Stock Position:  0.0033812207572845475
Bond Position:  [6.11122166]


portfolio before change:  [6.45393296]
curr_Stock_Price:  101.13132892470598
curr_Factors:  [1.01131329e+02 4.30722563e-02]
mat_Sqrt:  [[ 2.09886510e+01  0.00000000e+00]
 [-8.30154263e-03  1.90212237e-02]]
grads:  [-3.30470677e-03 -3.53935076e+00]
Stock Position:  -0.003304706768501511
Bond Position:  [6.78814234]


portfolio before change:  [6.45495423]
curr_Stock_Price:  101.07906832666198
curr_Factors:  [1.01079068e+02 4.43921987e-02]
mat_Sqrt:  [[ 2.12968101e+01  0.00000000e+00]
 [-8.42778250e-03  1.93104756e-02]]
grads:  [-7.65437025e-04 -7.83962111e+00]
Stock Position:  -0.0007654370249776934
Bond Position:  [6.53232389]


portfolio before change:  [6.45609651]
curr_Stock_Price:  100.653579108006
curr_Factors:  [1.00653579e+02 4.36422655e-02]
mat_Sqrt:  [[ 2.10272688e+01  0.00000000e+00]
 [-8.35629253e-03  1.91466715e-02]]
grads:  [-0.00492789 -1.0044932 ]
Stock Position:  -0.004927885229063419
Bond Position:  [6.9521058]


portfolio before change:  [6.46847729]
curr_Stock_Price:  98.31754515710716
curr_Factors:  [9.83175452e+01 4.40230079e-02]
mat_Sqrt:  [[ 2.06286536e+01  0.00000000e+00]
 [-8.39266421e-03  1.92300095e-02]]
grads:  [-3.16772106e-03 -5.96749199e+00]
Stock Position:  -0.0031677210633667646
Bond Position:  [6.77991984]


portfolio before change:  [6.47239768]
curr_Stock_Price:  97.34749228353122
curr_Factors:  [9.73474923e+01 4.38160047e-02]
mat_Sqrt:  [[ 2.03770427e+01  0.00000000e+00]
 [-8.37290914e-03  1.91847450e-02]]
grads:  [0.006349   5.01111103]
Stock Position:  0.006348996716930205
Bond Position:  [5.85433878]


portfolio before change:  [6.48822852]
curr_Stock_Price:  99.72566267740059
curr_Factors:  [9.97256627e+01 4.30682859e-02]
mat_Sqrt:  [[ 2.06959671e+01  0.00000000e+00]
 [-8.30116001e-03  1.90203470e-02]]
grads:  [ 0.03424855 28.68560019]
Stock Position:  0.03424854988842869
Bond Position:  [3.07276919]


portfolio before change:  [6.49249638]
curr_Stock_Price:  99.83906127967548
curr_Factors:  [9.98390613e+01 4.21017585e-02]
mat_Sqrt:  [[ 2.04856905e+01  0.00000000e+00]
 [-8.20748522e-03  1.88057111e-02]]
grads:  [-1.48357161e-03  5.09185891e+00]
Stock Position:  -0.001483571610312576
Bond Position:  [6.64061477]


portfolio before change:  [6.49217032]
curr_Stock_Price:  100.61838430273131
curr_Factors:  [1.00618384e+02 4.05886546e-02]
mat_Sqrt:  [[ 2.02712097e+01  0.00000000e+00]
 [-8.05865047e-03  1.84646879e-02]]
grads:  [0.00941773 2.1761092 ]
Stock Position:  0.009417732010387796
Bond Position:  [5.54457335]


portfolio before change:  [6.49699973]
curr_Stock_Price:  101.0575868556004
curr_Factors:  [1.01057587e+02 4.09345800e-02]
mat_Sqrt:  [[ 2.04462701e+01  0.00000000e+00]
 [-8.09291838e-03  1.85432055e-02]]
grads:  [-0.00403881 -0.5932227 ]
Stock Position:  -0.004038805734452058
Bond Position:  [6.90515169]


portfolio before change:  [6.48999918]
curr_Stock_Price:  103.00463436560509
curr_Factors:  [1.03004634e+02 3.90151370e-02]
mat_Sqrt:  [[ 2.03457326e+01  0.00000000e+00]
 [-7.90089990e-03  1.81032359e-02]]
grads:  [-7.03206561e-03 -8.31424463e+00]
Stock Position:  -0.0070320656061959265
Bond Position:  [7.21433453]


portfolio before change:  [6.51511884]
curr_Stock_Price:  99.56072245158424
curr_Factors:  [9.95607225e+01 4.04911107e-02]
mat_Sqrt:  [[ 2.00340099e+01  0.00000000e+00]
 [-8.04896124e-03  1.84424871e-02]]
grads:  [-0.00645647 -1.52102073]
Stock Position:  -0.0064564652195890256
Bond Position:  [7.15792919]


portfolio before change:  [6.51341269]
curr_Stock_Price:  99.96356653361197
curr_Factors:  [9.99635665e+01 4.03845609e-02]
mat_Sqrt:  [[ 2.00885886e+01  0.00000000e+00]
 [-8.03836410e-03  1.84182060e-02]]
grads:  [-0.00305124 -1.95005984]
Stock Position:  -0.003051239602448998
Bond Position:  [6.81842549]


portfolio before change:  [6.51844974]
curr_Stock_Price:  98.59209529383243
curr_Factors:  [9.85920953e+01 4.09326917e-02]
mat_Sqrt:  [[ 1.99469844e+01  0.00000000e+00]
 [-8.09273172e-03  1.85427778e-02]]
grads:  [ 0.03330473 18.26831973]
Stock Position:  0.03330473228613103
Bond Position:  [3.2348664]


portfolio before change:  [6.53749266]
curr_Stock_Price:  99.1517316211954
curr_Factors:  [9.91517316e+01 3.86546023e-02]
mat_Sqrt:  [[ 1.94939976e+01  0.00000000e+00]
 [-7.86430949e-03  1.80193968e-02]]
grads:  [ 4.15486096e-03 -6.26515637e+00]
Stock Position:  0.004154860955063546
Bond Position:  [6.125531]


portfolio before change:  [6.53472112]
curr_Stock_Price:  98.30037296277719
curr_Factors:  [9.83003730e+01 3.88467804e-02]
mat_Sqrt:  [[ 1.93745971e+01  0.00000000e+00]
 [-7.88383464e-03  1.80641345e-02]]
grads:  [4.70131230e-03 6.51288493e+00]
Stock Position:  0.004701312300713902
Bond Position:  [6.07258037]


portfolio before change:  [6.53269408]
curr_Stock_Price:  97.7077375031208
curr_Factors:  [9.77077375e+01 3.93861172e-02]
mat_Sqrt:  [[ 1.93910150e+01  0.00000000e+00]
 [-7.93837436e-03  1.81891007e-02]]
grads:  [0.00418921 3.99703913]
Stock Position:  0.004189206624604244
Bond Position:  [6.12337618]


portfolio before change:  [6.53667163]
curr_Stock_Price:  98.47449006110173
curr_Factors:  [9.84744901e+01 3.86192597e-02]
mat_Sqrt:  [[ 1.93519937e+01  0.00000000e+00]
 [-7.86071343e-03  1.80111571e-02]]
grads:  [-0.00335182 -1.8899605 ]
Stock Position:  -0.003351818425671889
Bond Position:  [6.86674024]


portfolio before change:  [6.53454742]
curr_Stock_Price:  99.36433700224401
curr_Factors:  [9.93643370e+01 3.94464396e-02]
mat_Sqrt:  [[ 1.97348779e+01  0.00000000e+00]
 [-7.94445111e-03  1.82030243e-02]]
grads:  [-0.00466669 -1.94261366]
Stock Position:  -0.004666691969786219
Bond Position:  [6.99825018]


portfolio before change:  [6.52755901]
curr_Stock_Price:  101.04930974013467
curr_Factors:  [1.01049310e+02 3.80447304e-02]
mat_Sqrt:  [[ 1.97097269e+01  0.00000000e+00]
 [-7.80202337e-03  1.78766813e-02]]
grads:  [ 0.00783581 -2.26615736]
Stock Position:  0.007835811999861293
Bond Position:  [5.73575562]


portfolio before change:  [6.52457091]
curr_Stock_Price:  100.57646612829272
curr_Factors:  [1.00576466e+02 3.93219056e-02]
mat_Sqrt:  [[ 1.99440636e+01  0.00000000e+00]
 [-7.93190071e-03  1.81742677e-02]]
grads:  [ 0.03500588 -4.12403695]
Stock Position:  0.035005876990182816
Bond Position:  [3.00380351]


portfolio before change:  [6.50314785]
curr_Stock_Price:  99.9537546075317
curr_Factors:  [9.99537546e+01 3.82990482e-02]
mat_Sqrt:  [[ 1.95610923e+01  0.00000000e+00]
 [-7.82805704e-03  1.79363320e-02]]
grads:  [-2.49822709e-03 -9.52180861e+00]
Stock Position:  -0.0024982270933314762
Bond Position:  [6.75285502]


portfolio before change:  [6.50159235]
curr_Stock_Price:  100.91429879750338
curr_Factors:  [1.00914299e+02 3.90265696e-02]
mat_Sqrt:  [[ 1.99357646e+01  0.00000000e+00]
 [-7.90205742e-03  1.81058881e-02]]
grads:  [0.0019446  0.85692174]
Stock Position:  0.0019446018622164215
Bond Position:  [6.30535421]


portfolio before change:  [6.50042619]
curr_Stock_Price:  99.90927034469307
curr_Factors:  [9.99092703e+01 4.12657053e-02]
mat_Sqrt:  [[ 2.02955312e+01  0.00000000e+00]
 [-8.12558481e-03  1.86180537e-02]]
grads:  [ 0.00511906 -2.5785722 ]
Stock Position:  0.005119063703824656
Bond Position:  [5.98898427]


portfolio before change:  [6.49399289]
curr_Stock_Price:  98.50628571750589
curr_Factors:  [9.85062857e+01 4.21539581e-02]
mat_Sqrt:  [[ 2.02247482e+01  0.00000000e+00]
 [-8.21257164e-03  1.88173656e-02]]
grads:  [ 3.57150273e-03 -5.69886793e+00]
Stock Position:  0.0035715027267710447
Bond Position:  [6.14217742]


portfolio before change:  [6.49240508]
curr_Stock_Price:  97.84672359496126
curr_Factors:  [9.78467236e+01 4.15715793e-02]
mat_Sqrt:  [[ 1.99500758e+01  0.00000000e+00]
 [-8.15564386e-03  1.86869277e-02]]
grads:  [-1.91257399e-02 -2.28076968e+01]
Stock Position:  -0.019125739852247834
Bond Position:  [8.36379606]


portfolio before change:  [6.50399117]
curr_Stock_Price:  97.295604962237
curr_Factors:  [9.72956050e+01 4.13487934e-02]
mat_Sqrt:  [[ 1.97844801e+01  0.00000000e+00]
 [-8.13376109e-03  1.86367879e-02]]
grads:  [0.00467807 3.94840473]
Stock Position:  0.004678069537423619
Bond Position:  [6.04883557]


portfolio before change:  [6.50616734]
curr_Stock_Price:  97.59915342401574
curr_Factors:  [9.75991534e+01 4.10820003e-02]
mat_Sqrt:  [[ 1.97820749e+01  0.00000000e+00]
 [-8.10747806e-03  1.85765659e-02]]
grads:  [ 0.01212098 -1.17501076]
Stock Position:  0.012120980613341352
Bond Position:  [5.3231699]


portfolio before change:  [6.53082764]
curr_Stock_Price:  99.57876713619999
curr_Factors:  [9.95787671e+01 4.00643210e-02]
mat_Sqrt:  [[ 1.99317595e+01  0.00000000e+00]
 [-8.00642952e-03  1.83450346e-02]]
grads:  [-0.02879564 -6.08599099]
Stock Position:  -0.028795642620925845
Bond Position:  [9.39826223]


portfolio before change:  [6.49227545]
curr_Stock_Price:  100.95838737790551
curr_Factors:  [1.00958387e+02 4.00450677e-02]
mat_Sqrt:  [[ 2.02030492e+01  0.00000000e+00]
 [-8.00450550e-03  1.83406262e-02]]
grads:  [-0.00971383 -3.4726327 ]
Stock Position:  -0.009713832783227617
Bond Position:  [7.47296834]


portfolio before change:  [6.51150229]
curr_Stock_Price:  99.075230920973
curr_Factors:  [9.90752309e+01 4.13742107e-02]
mat_Sqrt:  [[ 2.01525475e+01  0.00000000e+00]
 [-8.13626063e-03  1.86425151e-02]]
grads:  [-9.48646838e-04 -3.23226421e+00]
Stock Position:  -0.0009486468378372653
Bond Position:  [6.6054897]


portfolio before change:  [6.51175946]
curr_Stock_Price:  99.67458237375169
curr_Factors:  [9.96745824e+01 4.20993963e-02]
mat_Sqrt:  [[ 2.04513678e+01  0.00000000e+00]
 [-8.20725497e-03  1.88051836e-02]]
grads:  [-4.22640719e-03  8.03909242e+00]
Stock Position:  -0.004226407192455397
Bond Position:  [6.93302483]


portfolio before change:  [6.50733091]
curr_Stock_Price:  100.9274744985445
curr_Factors:  [1.00927474e+02 4.32055376e-02]
mat_Sqrt:  [[ 2.09787261e+01  0.00000000e+00]
 [-8.31437671e-03  1.90506303e-02]]
grads:  [0.00429279 3.25790132]
Stock Position:  0.004292786591829339
Bond Position:  [6.0740708]


portfolio before change:  [6.51212504]
curr_Stock_Price:  101.86738345679638
curr_Factors:  [1.01867383e+02 4.32837922e-02]
mat_Sqrt:  [[ 2.11932618e+01  0.00000000e+00]
 [-8.32190288e-03  1.90678749e-02]]
grads:  [-0.00446687  4.26503459]
Stock Position:  -0.004466873090941824
Bond Position:  [6.96715372]


portfolio before change:  [6.49965977]
curr_Stock_Price:  104.85296697805008
curr_Factors:  [1.04852967e+02 4.11809820e-02]
mat_Sqrt:  [[ 2.12779152e+01  0.00000000e+00]
 [-8.11723914e-03  1.85989314e-02]]
grads:  [-0.01606576 -0.54908266]
Stock Position:  -0.016065756521809332
Bond Position:  [8.18420201]


portfolio before change:  [6.52646064]
curr_Stock_Price:  103.24844985282479
curr_Factors:  [1.03248450e+02 4.14987004e-02]
mat_Sqrt:  [[ 2.10329790e+01  0.00000000e+00]
 [-8.14849192e-03  1.86705405e-02]]
grads:  [-5.18221296e-03 -1.01787512e+01]
Stock Position:  -0.005182212959671175
Bond Position:  [7.06151609]


portfolio before change:  [6.53716838]
curr_Stock_Price:  101.35254184881273
curr_Factors:  [1.01352542e+02 4.22872071e-02]
mat_Sqrt:  [[ 2.08419882e+01  0.00000000e+00]
 [-8.22554141e-03  1.88470831e-02]]
grads:  [-1.59249920e-06 -1.76548414e+00]
Stock Position:  -1.592499197509265e-06
Bond Position:  [6.53732979]


portfolio before change:  [6.53798491]
curr_Stock_Price:  101.78843270814417
curr_Factors:  [1.01788433e+02 4.25350210e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.53798491]
Stock Price:  102.75168368496645
PL:  [3.78630122]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.36867311e+00  3.38330783e-01]
 [ 1.09938315e+00  6.83483341e-02]
 [ 1.02355514e-01 -4.21623697e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.13351086e-01  9.24695073e-01]
 [ 1.83359077e-02 -4.50836598e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 9.25309372e-01  9.28266830e-01]
 [ 2.87618909e-02  4.09155337e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-2.65315287e-02  2.04593460e-02]
 [ 3.44938217e-02 -1.37631875e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-6.59831043e-02  2.73709330e-02]
 [ 5.15813146e-01  3.37853314e-01]
 [ 1.29909397e-01 -7.05379218e-02]
 [ 3.99466781e-02  1.24929172e-01]
 [ 6.58864982e-02  7.85655796e-02]
 [-6.56688806e-02 -4.76049440e-02]
 [-2.32040506e-01  6.25748973e-02]
 [ 1.11922973e-01  6.10319058e-02]
 [ 1.43785101e+00  1.60861512e-01]
 [ 1.60023034e-02  4.12542003e-01]
 [-1.34518626e-01  1.17406678e-01]
 [-1.90725700e-01  2.01638963e-01]
 [ 1.41461751e-01 -9.91133808e-02]
 [-2.32221260e-01 -4.44569306e-01]
 [ 7.10470569e-02  5.10012493e-02]
 [ 4.76094414e-01 -2.78597516e-01]
 [-5.23695687e-01 -2.14383135e-01]
 [ 1.88137085e-03  3.73734403e-03]
 [-8.79383642e-02  1.04226399e-01]
 [ 3.63227138e-01  2.18275740e-01]
 [ 3.27424413e-02 -1.93583350e-02]
 [ 2.15072435e-01 -1.65454889e-01]
 [ 7.87138258e-02  9.03132423e-02]
 [-5.56043053e-02  1.67758919e-01]
 [-3.56278695e-01 -1.36192505e-01]
 [ 1.43010205e-01 -7.87301186e-04]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.45273066]
curr_Stock_Price:  99.8216319036742
curr_Factors:  [9.98216319e+01 4.07154052e-02]
mat_Sqrt:  [[ 2.01420675e+01  0.00000000e+00]
 [-8.07122347e-03  1.84934963e-02]]
grads:  [ 0.07528188 18.29458196]
Stock Position:  0.07528188319226847
Bond Position:  [-6.06202977]


portfolio before change:  [1.3375497]
curr_Stock_Price:  98.30170228812058
curr_Factors:  [9.83017023e+01 4.06454539e-02]
mat_Sqrt:  [[ 1.98183287e+01  0.00000000e+00]
 [-8.06428709e-03  1.84776030e-02]]
grads:  [0.05697821 3.69898271]
Stock Position:  0.056978205583474724
Bond Position:  [-4.26350491]


portfolio before change:  [1.37204309]
curr_Stock_Price:  98.91643498488324
curr_Factors:  [9.89164350e+01 4.16778476e-02]
mat_Sqrt:  [[ 2.01939416e+01  0.00000000e+00]
 [-8.16606124e-03  1.87107969e-02]]
grads:  [ 0.0041574  -2.25337114]
Stock Position:  0.004157402711254364
Bond Position:  [0.96080764]


portfolio before change:  [1.36711279]
curr_Stock_Price:  97.70163499866305
curr_Factors:  [9.77016350e+01 4.17693938e-02]
mat_Sqrt:  [[ 1.99678322e+01  0.00000000e+00]
 [-8.17502478e-03  1.87313349e-02]]
grads:  [-8.16381409e-04 -8.08200873e+00]
Stock Position:  -0.0008163814085496088
Bond Position:  [1.44687458]


portfolio before change:  [1.36761985]
curr_Stock_Price:  97.30208029472396
curr_Factors:  [9.73020803e+01 4.13994471e-02]
mat_Sqrt:  [[ 1.97979123e+01  0.00000000e+00]
 [-8.13874163e-03  1.86481998e-02]]
grads:  [1.46590673e-02 4.95862916e+01]
Stock Position:  0.014659067346319592
Bond Position:  [-0.0587379]


portfolio before change:  [1.36387722]
curr_Stock_Price:  97.04726995817394
curr_Factors:  [9.70472700e+01 4.09468198e-02]
mat_Sqrt:  [[ 1.96378262e+01  0.00000000e+00]
 [-8.09412822e-03  1.85459776e-02]]
grads:  [-6.82465823e-05 -2.43091309e+00]
Stock Position:  -6.824658234737527e-05
Bond Position:  [1.37050037]


portfolio before change:  [1.36404152]
curr_Stock_Price:  97.15012826305811
curr_Factors:  [9.71501283e+01 4.24992588e-02]
mat_Sqrt:  [[ 2.00278374e+01  0.00000000e+00]
 [-8.24613934e-03  1.88942789e-02]]
grads:  [0.0064597  5.08814799]
Stock Position:  0.00645969781210354
Bond Position:  [0.73648105]


portfolio before change:  [1.36499599]
curr_Stock_Price:  97.28363344362027
curr_Factors:  [9.72836334e+01 4.30339462e-02]
mat_Sqrt:  [[ 2.01811248e+01  0.00000000e+00]
 [-8.29784995e-03  1.90127628e-02]]
grads:  [ 0.06592488 48.82335315]
Stock Position:  0.06592487990902876
Bond Position:  [-5.04841586]


portfolio before change:  [1.35150836]
curr_Stock_Price:  97.08861538397204
curr_Factors:  [9.70886154e+01 4.28777907e-02]
mat_Sqrt:  [[ 2.01040941e+01  0.00000000e+00]
 [-8.28278124e-03  1.89782360e-02]]
grads:  [1.03129203e-02 2.15591869e+01]
Stock Position:  0.010312920295836196
Bond Position:  [0.35024121]


portfolio before change:  [1.35068212]
curr_Stock_Price:  97.0042530281548
curr_Factors:  [9.70042530e+01 4.32199438e-02]
mat_Sqrt:  [[ 2.01666088e+01  0.00000000e+00]
 [-8.31576275e-03  1.90538061e-02]]
grads:  [0.01221991 5.93459032]
Stock Position:  0.012219912066756915
Bond Position:  [0.16529868]


portfolio before change:  [1.34016378]
curr_Stock_Price:  96.14180811233904
curr_Factors:  [9.61418081e+01 4.32438505e-02]
mat_Sqrt:  [[ 1.99928388e+01  0.00000000e+00]
 [-8.31806233e-03  1.90590751e-02]]
grads:  [-8.80432149e-04  1.07347003e+00]
Stock Position:  -0.0008804321488909743
Bond Position:  [1.42481012]


portfolio before change:  [1.33861749]
curr_Stock_Price:  98.10039540472461
curr_Factors:  [9.81003954e+01 4.10943665e-02]
mat_Sqrt:  [[ 1.98866625e+01  0.00000000e+00]
 [-8.10869820e-03  1.85793616e-02]]
grads:  [-1.28597009e-03 -7.40778277e+00]
Stock Position:  -0.0012859700908210028
Bond Position:  [1.46477167]


portfolio before change:  [1.33805669]
curr_Stock_Price:  98.67887532087812
curr_Factors:  [9.86788753e+01 3.96924562e-02]
mat_Sqrt:  [[ 1.96597585e+01  0.00000000e+00]
 [-7.96918628e-03  1.82596997e-02]]
grads:  [-0.00657937 -1.5362468 ]
Stock Position:  -0.006579373208752504
Bond Position:  [1.98730184]


portfolio before change:  [1.33721535]
curr_Stock_Price:  98.84450923278148
curr_Factors:  [9.88445092e+01 3.97916733e-02]
mat_Sqrt:  [[ 1.97173548e+01  0.00000000e+00]
 [-7.97914013e-03  1.82825068e-02]]
grads:  [-0.0027406  1.4971105]
Stock Position:  -0.0027406034174491307
Bond Position:  [1.60810895]


portfolio before change:  [1.3376829]
curr_Stock_Price:  98.74725944382736
curr_Factors:  [9.87472594e+01 3.96045817e-02]
mat_Sqrt:  [[ 1.96515933e+01  0.00000000e+00]
 [-7.96035997e-03  1.82394761e-02]]
grads:  [ 0.03375118 18.52319182]
Stock Position:  0.03375117788971853
Bond Position:  [-1.99515342]


portfolio before change:  [1.34144908]
curr_Stock_Price:  98.86623558335523
curr_Factors:  [9.88662356e+01 3.78912272e-02]
mat_Sqrt:  [[ 1.92449742e+01  0.00000000e+00]
 [-7.78626762e-03  1.78405804e-02]]
grads:  [ 0.00515065 -3.95379076]
Stock Position:  0.00515064985997305
Bond Position:  [0.83222372]


portfolio before change:  [1.33599324]
curr_Stock_Price:  97.78678430965572
curr_Factors:  [9.77867843e+01 3.83520339e-02]
mat_Sqrt:  [[ 1.91502464e+01  0.00000000e+00]
 [-7.83347013e-03  1.79487349e-02]]
grads:  [4.93310827e-03 6.96033299e+00]
Stock Position:  0.004933108273148426
Bond Position:  [0.85360044]


portfolio before change:  [1.33452529]
curr_Stock_Price:  97.46758384203986
curr_Factors:  [9.74675838e+01 3.74429772e-02]
mat_Sqrt:  [[ 1.88601606e+01  0.00000000e+00]
 [-7.74007517e-03  1.77347402e-02]]
grads:  [0.00531148 4.43003838]
Stock Position:  0.005311477997388845
Bond Position:  [0.81682837]


portfolio before change:  [1.33828124]
curr_Stock_Price:  98.1554967103209
curr_Factors:  [9.81554967e+01 3.69802335e-02]
mat_Sqrt:  [[ 1.88755428e+01  0.00000000e+00]
 [-7.69209813e-03  1.76248110e-02]]
grads:  [-0.00457976 -2.7010187 ]
Stock Position:  -0.004579756054145739
Bond Position:  [1.78780947]


portfolio before change:  [1.33903917]
curr_Stock_Price:  98.0388007383828
curr_Factors:  [9.80388007e+01 3.79467721e-02]
mat_Sqrt:  [[ 1.90978910e+01  0.00000000e+00]
 [-7.79197249e-03  1.78536519e-02]]
grads:  [-0.01072006  3.50487944]
Stock Position:  -0.010720062365809704
Bond Position:  [2.39002122]


portfolio before change:  [1.36252126]
curr_Stock_Price:  95.87618977948837
curr_Factors:  [9.58761898e+01 3.89366304e-02]
mat_Sqrt:  [[ 1.89186416e+01  0.00000000e+00]
 [-7.89294677e-03  1.80850130e-02]]
grads:  [0.00732397 3.3747228 ]
Stock Position:  0.007323965614346311
Bond Position:  [0.66032734]


portfolio before change:  [1.36105716]
curr_Stock_Price:  95.66501408785378
curr_Factors:  [9.56650141e+01 3.82860984e-02]
mat_Sqrt:  [[ 1.87186143e+01  0.00000000e+00]
 [-7.82673351e-03  1.79332994e-02]]
grads:  [0.08056455 8.96998975]
Stock Position:  0.08056454955763329
Bond Position:  [-6.3461516]


portfolio before change:  [1.36678351]
curr_Stock_Price:  95.74593883434359
curr_Factors:  [9.57459388e+01 3.75694387e-02]
mat_Sqrt:  [[ 1.85582797e+01  0.00000000e+00]
 [-7.75313497e-03  1.77646639e-02]]
grads:  [1.05640392e-02 2.32226179e+01]
Stock Position:  0.01056403922932474
Bond Position:  [0.35531966]


portfolio before change:  [1.3736052]
curr_Stock_Price:  96.38748087562419
curr_Factors:  [9.63874809e+01 3.71027878e-02]
mat_Sqrt:  [[ 1.85662375e+01  0.00000000e+00]
 [-7.70483358e-03  1.76539915e-02]]
grads:  [-4.48546189e-03  6.65043242e+00]
Stock Position:  -0.004485461889084259
Bond Position:  [1.80594758]


portfolio before change:  [1.37094511]
curr_Stock_Price:  97.0308595183294
curr_Factors:  [9.70308595e+01 3.72547748e-02]
mat_Sqrt:  [[ 1.87284075e+01  0.00000000e+00]
 [-7.72059840e-03  1.76901133e-02]]
grads:  [-5.48488932e-03  1.13983986e+01]
Stock Position:  -0.005484889319301844
Bond Position:  [1.90314864]


portfolio before change:  [1.37098383]
curr_Stock_Price:  97.06717581343031
curr_Factors:  [9.70671758e+01 3.87782356e-02]
mat_Sqrt:  [[ 1.91146529e+01  0.00000000e+00]
 [-7.87687609e-03  1.80481905e-02]]
grads:  [ 5.13768815e-03 -5.49159657e+00]
Stock Position:  0.0051376881486245255
Bond Position:  [0.87228295]


portfolio before change:  [1.37388046]
curr_Stock_Price:  97.60975267907193
curr_Factors:  [9.76097527e+01 3.84160971e-02]
mat_Sqrt:  [[ 1.91315357e+01  0.00000000e+00]
 [-7.84000991e-03  1.79637194e-02]]
grads:  [-2.22798221e-02 -2.47481769e+01]
Stock Position:  -0.022279822083344145
Bond Position:  [3.54860839]


portfolio before change:  [1.41558]
curr_Stock_Price:  95.75803519279108
curr_Factors:  [9.57580352e+01 3.88817100e-02]
mat_Sqrt:  [[ 1.88819962e+01  0.00000000e+00]
 [-7.88737827e-03  1.80722540e-02]]
grads:  [0.00494152 2.82207462]
Stock Position:  0.004941523461247804
Bond Position:  [0.94238942]


portfolio before change:  [1.41135196]
curr_Stock_Price:  94.87857985107163
curr_Factors:  [9.48785799e+01 3.99348901e-02]
mat_Sqrt:  [[ 1.89602658e+01  0.00000000e+00]
 [-7.99348636e-03  1.83153782e-02]]
grads:  [  0.01869723 -15.21112551]
Stock Position:  0.018697232004513804
Bond Position:  [-0.36261486]


portfolio before change:  [1.43470297]
curr_Stock_Price:  96.12990601330036
curr_Factors:  [9.6129906e+01 3.7861238e-02]
mat_Sqrt:  [[ 1.87049229e+01  0.00000000e+00]
 [-7.78318578e-03  1.78335190e-02]]
grads:  [ -0.03299988 -12.02135908]
Stock Position:  -0.0329998771282825
Bond Position:  [4.60697805]


portfolio before change:  [1.4334525]
curr_Stock_Price:  96.18525073068423
curr_Factors:  [9.61852507e+01 3.78082387e-02]
mat_Sqrt:  [[ 1.87025879e+01  0.00000000e+00]
 [-7.77773630e-03  1.78210327e-02]]
grads:  [1.87807245e-04 2.09715346e-01]
Stock Position:  0.0001878072452540522
Bond Position:  [1.41538822]


portfolio before change:  [1.43343476]
curr_Stock_Price:  95.14866320507147
curr_Factors:  [9.51486632e+01 3.77939180e-02]
mat_Sqrt:  [[ 1.84975261e+01  0.00000000e+00]
 [-7.77626316e-03  1.78176573e-02]]
grads:  [-2.29491415e-03  5.84961296e+00]
Stock Position:  -0.0022949141527834394
Bond Position:  [1.65179277]


portfolio before change:  [1.43490088]
curr_Stock_Price:  94.59978307876963
curr_Factors:  [9.45997831e+01 3.93406020e-02]
mat_Sqrt:  [[ 1.87633613e+01  0.00000000e+00]
 [-7.93378618e-03  1.81785879e-02]]
grads:  [ 0.02443541 12.00729901]
Stock Position:  0.024435412918880725
Bond Position:  [-0.87668388]


portfolio before change:  [1.45061553]
curr_Stock_Price:  95.24737764152647
curr_Factors:  [9.52473776e+01 3.92428895e-02]
mat_Sqrt:  [[ 1.88683323e+01  0.00000000e+00]
 [-7.92392726e-03  1.81559982e-02]]
grads:  [ 0.00128754 -1.06622257]
Stock Position:  0.0012875420470445991
Bond Position:  [1.32798052]


portfolio before change:  [1.45052494]
curr_Stock_Price:  95.04808402568642
curr_Factors:  [9.50480840e+01 3.83631826e-02]
mat_Sqrt:  [[ 1.86166134e+01  0.00000000e+00]
 [-7.83460861e-03  1.79513435e-02]]
grads:  [ 7.67389844e-03 -9.21685273e+00]
Stock Position:  0.007673898438215057
Bond Position:  [0.72113559]


portfolio before change:  [1.44702436]
curr_Stock_Price:  94.58016993665574
curr_Factors:  [9.45801699e+01 4.13795611e-02]
mat_Sqrt:  [[ 1.92394667e+01  0.00000000e+00]
 [-8.13678670e-03  1.86437205e-02]]
grads:  [0.00613997 4.84416415]
Stock Position:  0.006139970406491994
Bond Position:  [0.86630492]


portfolio before change:  [1.44792135]
curr_Stock_Price:  94.70862184386323
curr_Factors:  [9.47086218e+01 4.12166337e-02]
mat_Sqrt:  [[ 1.92276309e+01  0.00000000e+00]
 [-8.12075205e-03  1.86069805e-02]]
grads:  [9.15957324e-04 9.01591308e+00]
Stock Position:  0.0009159573235923166
Bond Position:  [1.36117229]


portfolio before change:  [1.447135]
curr_Stock_Price:  93.66435632736061
curr_Factors:  [9.36643563e+01 4.25934708e-02]
mat_Sqrt:  [[ 1.93306238e+01  0.00000000e+00]
 [-8.25527427e-03  1.89152096e-02]]
grads:  [-0.02150567 -7.2001584 ]
Stock Position:  -0.02150566802727958
Bond Position:  [3.46144955]


portfolio before change:  [1.42204269]
curr_Stock_Price:  94.85125348101529
curr_Factors:  [9.48512535e+01 4.30638516e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.42204269]
Stock Price:  95.99558647897503
PL:  [1.42204269]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.47788160e+00  3.63020634e-01]
 [ 7.20388575e-01  1.04751924e-01]
 [ 6.02566701e-03  6.09076999e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.16335356e-01 -3.34441953e-01]
 [-3.67111389e-01  2.00452104e-01]
 [ 1.23225991e-01 -5.23434950e-02]
 [ 3.08500462e-01  4.70764228e-01]
 [-9.95706279e-02 -1.43631168e-02]
 [-3.02974849e-02 -2.47418381e-01]
 [-9.35393517e-02 -6.89158267e-03]
 [ 2.14021507e-02 -1.35852205e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.43638885e-02 -3.68411455e-02]
 [ 3.99030853e-01  2.50395855e-01]
 [ 1.34703319e-01 -3.73208474e-01]
 [ 3.68344231e-02 -5.87135302e-02]
 [ 3.37367304e-02 -1.55387121e-01]
 [-1.22375721e-01 -3.85726161e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.21546801e-01 -2.22306972e-02]
 [ 3.71851575e-01 -3.70484168e-01]
 [ 2.76240365e-02 -3.43755432e-01]
 [ 3.21328762e-02  5.73080249e-02]
 [ 4.38553725e-01 -3.97225975e-01]
 [-2.15979882e-01  9.04805981e-03]
 [-1.45290462e-01  1.29147320e-01]
 [-7.90751383e-02 -5.30839610e-02]
 [-7.05311549e-02  2.09807073e-01]
 [-5.96551288e-01  4.38338126e-01]
 [-1.19773408e-01  2.81249268e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-1.74832676e-01 -1.78156557e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.18787143e-01 -9.30110846e-02]
 [-3.08279118e-02 -1.45856504e-01]
 [ 7.44407844e-03 -6.34603547e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.81731646]
curr_Stock_Price:  99.34696832803124
curr_Factors:  [9.93469683e+01 4.08425918e-02]
mat_Sqrt:  [[ 2.00775754e+01  0.00000000e+00]
 [-8.08382007e-03  1.85223587e-02]]
grads:  [ 0.08149972 19.59905002]
Stock Position:  0.08149972101757315
Bond Position:  [-9.91406666]


portfolio before change:  [-1.81891601]
curr_Stock_Price:  99.34254849181227
curr_Factors:  [9.93425485e+01 3.94020902e-02]
mat_Sqrt:  [[ 1.97194559e+01  0.00000000e+00]
 [-7.93998389e-03  1.81927886e-02]]
grads:  [0.03885026 5.75788169]
Stock Position:  0.038850263778934996
Bond Position:  [-5.67840022]


portfolio before change:  [-1.87761913]
curr_Stock_Price:  97.84981028119401
curr_Factors:  [9.78498103e+01 3.98107835e-02]
mat_Sqrt:  [[ 1.95236202e+01  0.00000000e+00]
 [-7.98105592e-03  1.82868964e-02]]
grads:  [1.67018034e-03 3.33067452e+00]
Stock Position:  0.0016701803386781333
Bond Position:  [-2.04104596]


portfolio before change:  [-1.8729444]
curr_Stock_Price:  100.8015126613097
curr_Factors:  [1.00801513e+02 3.69985419e-02]
mat_Sqrt:  [[ 1.93891761e+01  0.00000000e+00]
 [-7.69400202e-03  1.76291733e-02]]
grads:  [-8.40745729e-04 -8.58728935e+00]
Stock Position:  -0.0008407457292377201
Bond Position:  [-1.78819596]


portfolio before change:  [-1.87408045]
curr_Stock_Price:  101.88687624392492
curr_Factors:  [1.01886876e+02 3.55978769e-02]
mat_Sqrt:  [[ 1.92234041e+01  0.00000000e+00]
 [-7.54695985e-03  1.72922574e-02]]
grads:  [-1.36447108e-02 -1.93405606e+01]
Stock Position:  -0.013644710834042314
Bond Position:  [-0.48386349]


portfolio before change:  [-1.87745411]
curr_Stock_Price:  102.1296936641174
curr_Factors:  [1.02129694e+02 3.41706526e-02]
mat_Sqrt:  [[ 1.88789861e+01  0.00000000e+00]
 [-7.39412227e-03  1.69420625e-02]]
grads:  [-0.01481154 11.83162344]
Stock Position:  -0.014811543248632
Bond Position:  [-0.36475574]


portfolio before change:  [-1.85937709]
curr_Stock_Price:  100.9061467249834
curr_Factors:  [1.00906147e+02 3.49975461e-02]
mat_Sqrt:  [[ 1.88771497e+01  0.00000000e+00]
 [-7.48305243e-03  1.71458271e-02]]
grads:  [ 0.00531762 -3.05284164]
Stock Position:  0.005317615124718438
Bond Position:  [-2.39595714]


portfolio before change:  [-1.86273281]
curr_Stock_Price:  100.33141348786108
curr_Factors:  [1.00331413e+02 3.37644899e-02]
mat_Sqrt:  [[ 1.84360139e+01  0.00000000e+00]
 [-7.35004652e-03  1.68410723e-02]]
grads:  [2.78779793e-02 2.79533405e+01]
Stock Position:  0.027877979335824733
Bond Position:  [-4.65976989]


portfolio before change:  [-1.85577125]
curr_Stock_Price:  100.60202395875503
curr_Factors:  [1.00602024e+02 3.33440591e-02]
mat_Sqrt:  [[ 1.83702874e+01  0.00000000e+00]
 [-7.30414229e-03  1.67358925e-02]]
grads:  [-0.00576143 -0.85822234]
Stock Position:  -0.005761434399634206
Bond Position:  [-1.27615929]


portfolio before change:  [-1.86236152]
curr_Stock_Price:  101.71819428233542
curr_Factors:  [1.01718194e+02 3.19696482e-02]
mat_Sqrt:  [[ 1.81872724e+01  0.00000000e+00]
 [-7.15202329e-03  1.63873440e-02]]
grads:  [-7.60310379e-03 -1.50981380e+01]
Stock Position:  -0.007603103785947763
Bond Position:  [-1.08898753]


portfolio before change:  [-1.85264396]
curr_Stock_Price:  100.42218562823368
curr_Factors:  [1.00422186e+02 3.29733143e-02]
mat_Sqrt:  [[ 1.82352185e+01  0.00000000e+00]
 [-7.26342226e-03  1.66425912e-02]]
grads:  [-0.00529454 -0.41409313]
Stock Position:  -0.005294539531699525
Bond Position:  [-1.32095473]


portfolio before change:  [-1.85119076]
curr_Stock_Price:  100.11652514514809
curr_Factors:  [1.00116525e+02 3.29250532e-02]
mat_Sqrt:  [[ 1.81664058e+01  0.00000000e+00]
 [-7.25810479e-03  1.66304073e-02]]
grads:  [-2.08564165e-03 -8.16890427e+00]
Stock Position:  -0.002085641651491405
Bond Position:  [-1.64238357]


portfolio before change:  [-1.85055538]
curr_Stock_Price:  99.71343655858281
curr_Factors:  [9.97134366e+01 3.37863884e-02]
mat_Sqrt:  [[ 1.83284006e+01  0.00000000e+00]
 [-7.35242963e-03  1.68465327e-02]]
grads:  [-0.00705729 -1.66511446]
Stock Position:  -0.007057292712502449
Bond Position:  [-1.14684847]


portfolio before change:  [-1.8539084]
curr_Stock_Price:  100.1682373680745
curr_Factors:  [1.00168237e+02 3.42030766e-02]
mat_Sqrt:  [[ 1.85251878e+01  0.00000000e+00]
 [-7.39762953e-03  1.69500986e-02]]
grads:  [-0.00326273 -2.17350626]
Stock Position:  -0.0032627298220503087
Bond Position:  [-1.52708651]


portfolio before change:  [-1.85587895]
curr_Stock_Price:  100.71368693904182
curr_Factors:  [1.00713687e+02 3.38404762e-02]
mat_Sqrt:  [[ 1.85270694e+01  0.00000000e+00]
 [-7.35831244e-03  1.68600119e-02]]
grads:  [ 0.02743621 14.85146373]
Stock Position:  0.027436209830621394
Bond Position:  [-4.6190808]


portfolio before change:  [-1.84805635]
curr_Stock_Price:  101.01985271118494
curr_Factors:  [1.01019853e+02 3.38966960e-02]
mat_Sqrt:  [[ 1.85988210e+01  0.00000000e+00]
 [-7.36442214e-03  1.68740110e-02]]
grads:  [-1.51505367e-03 -2.21173540e+01]
Stock Position:  -0.0015150536741582253
Bond Position:  [-1.69500585]


portfolio before change:  [-1.84869487]
curr_Stock_Price:  101.30144829171675
curr_Factors:  [1.01301448e+02 3.45095411e-02]
mat_Sqrt:  [[ 1.88185105e+01  0.00000000e+00]
 [-7.43069753e-03  1.70258669e-02]]
grads:  [ 5.95676142e-04 -3.44848990e+00]
Stock Position:  0.0005956761418096817
Bond Position:  [-1.90903772]


portfolio before change:  [-1.84776596]
curr_Stock_Price:  103.261491825789
curr_Factors:  [1.03261492e+02 3.38709145e-02]
mat_Sqrt:  [[ 1.90042991e+01  0.00000000e+00]
 [-7.36162096e-03  1.68675926e-02]]
grads:  [-1.79326629e-03 -9.21216940e+00]
Stock Position:  -0.0017932662920433769
Bond Position:  [-1.66259061]


portfolio before change:  [-1.84962541]
curr_Stock_Price:  104.18249683094383
curr_Factors:  [1.04182497e+02 3.24204029e-02]
mat_Sqrt:  [[ 1.87587530e+01  0.00000000e+00]
 [-7.20226663e-03  1.65024660e-02]]
grads:  [-1.54978542e-02 -2.33738498e+01]
Stock Position:  -0.015497854210680468
Bond Position:  [-0.23502026]


portfolio before change:  [-1.85586682]
curr_Stock_Price:  104.58332887969677
curr_Factors:  [1.04583329e+02 3.09244190e-02]
mat_Sqrt:  [[ 1.83913342e+01  0.00000000e+00]
 [-7.03413608e-03  1.61172305e-02]]
grads:  [-2.63499481e-04 -6.76874287e+00]
Stock Position:  -0.00026349948065002607
Bond Position:  [-1.82830917]


portfolio before change:  [-1.85615871]
curr_Stock_Price:  104.82368177819492
curr_Factors:  [1.04823682e+02 3.10706852e-02]
mat_Sqrt:  [[ 1.84771432e+01  0.00000000e+00]
 [-7.05075147e-03  1.61553012e-02]]
grads:  [ 0.00605313 -1.37606208]
Stock Position:  0.006053128881098023
Bond Position:  [-2.49066996]


portfolio before change:  [-1.8618001]
curr_Stock_Price:  103.94313893120624
curr_Factors:  [1.03943139e+02 3.10016959e-02]
mat_Sqrt:  [[ 1.83015787e+01  0.00000000e+00]
 [-7.04291938e-03  1.61373556e-02]]
grads:  [ 1.14831092e-02 -2.29581709e+01]
Stock Position:  0.011483109245344817
Bond Position:  [-3.05539052]


portfolio before change:  [-1.86026736]
curr_Stock_Price:  104.10987828115907
curr_Factors:  [1.04109878e+02 3.11745829e-02]
mat_Sqrt:  [[ 1.83819789e+01  0.00000000e+00]
 [-7.06253019e-03  1.61822896e-02]]
grads:  [-6.65886595e-03 -2.12426944e+01]
Stock Position:  -0.006658865946677652
Bond Position:  [-1.16701364]


portfolio before change:  [-1.86500273]
curr_Stock_Price:  104.79910660426353
curr_Factors:  [1.04799107e+02 3.04060022e-02]
mat_Sqrt:  [[ 1.82741524e+01  0.00000000e+00]
 [-6.97492678e-03  1.59815650e-02]]
grads:  [3.12704784e-03 3.58588317e+00]
Stock Position:  0.003127047840535085
Bond Position:  [-2.19271455]


portfolio before change:  [-1.86580249]
curr_Stock_Price:  104.63100728357824
curr_Factors:  [1.04631007e+02 3.05578996e-02]
mat_Sqrt:  [[ 1.82903559e+01  0.00000000e+00]
 [-6.99232717e-03  1.60214343e-02]]
grads:  [ 1.44989031e-02 -2.47934091e+01]
Stock Position:  0.014498903051356846
Bond Position:  [-3.38283732]


portfolio before change:  [-1.87489185]
curr_Stock_Price:  104.03327365750152
curr_Factors:  [1.04033274e+02 2.92619123e-02]
mat_Sqrt:  [[ 1.77960500e+01  0.00000000e+00]
 [-6.84244545e-03  1.56780121e-02]]
grads:  [-0.0119145  0.5771178]
Stock Position:  -0.011914497062448884
Bond Position:  [-0.63538772]


portfolio before change:  [-1.88263311]
curr_Stock_Price:  104.67634127298672
curr_Factors:  [1.04676341e+02 2.83081422e-02]
mat_Sqrt:  [[ 1.76118192e+01  0.00000000e+00]
 [-6.73000947e-03  1.54203889e-02]]
grads:  [-5.04922005e-03  8.37510133e+00]
Stock Position:  -0.005049220051493324
Bond Position:  [-1.35409923]


portfolio before change:  [-1.88566183]
curr_Stock_Price:  105.24265740653216
curr_Factors:  [1.05242657e+02 2.90081470e-02]
mat_Sqrt:  [[ 1.79246960e+01  0.00000000e+00]
 [-6.81271130e-03  1.56098826e-02]]
grads:  [-0.00570402 -3.40066369]
Stock Position:  -0.0057040229893457655
Bond Position:  [-1.2853553]


portfolio before change:  [-1.88394606]
curr_Stock_Price:  104.9136864670322
curr_Factors:  [1.04913686e+02 3.01062943e-02]
mat_Sqrt:  [[ 1.82037473e+01  0.00000000e+00]
 [-6.94046619e-03  1.59026058e-02]]
grads:  [1.15559496e-03 1.31932512e+01]
Stock Position:  0.001155594958341735
Bond Position:  [-2.00518378]


portfolio before change:  [-1.88197107]
curr_Stock_Price:  106.83966509913456
curr_Factors:  [1.06839665e+02 2.94075613e-02]
mat_Sqrt:  [[ 1.83215420e+01  0.00000000e+00]
 [-6.85945319e-03  1.57169817e-02]]
grads:  [-2.21184901e-02  2.78894595e+01]
Stock Position:  -0.022118490081644165
Bond Position:  [0.481161]


portfolio before change:  [-1.88668216]
curr_Stock_Price:  107.055377715462
curr_Factors:  [1.07055378e+02 2.90324156e-02]
mat_Sqrt:  [[ 1.82410601e+01  0.00000000e+00]
 [-6.81556050e-03  1.56164109e-02]]
grads:  [-0.00589323  1.80098532]
Stock Position:  -0.005893225673754425
Bond Position:  [-1.25578066]


portfolio before change:  [-1.89701901]
curr_Stock_Price:  108.78276248804262
curr_Factors:  [1.08782762e+02 2.88130755e-02]
mat_Sqrt:  [[ 1.84652373e+01  0.00000000e+00]
 [-6.78976589e-03  1.55573081e-02]]
grads:  [ 0.0039286  -0.76794707]
Stock Position:  0.0039286035555401505
Bond Position:  [-2.32438336]


portfolio before change:  [-1.89574059]
curr_Stock_Price:  109.18213640675336
curr_Factors:  [1.09182136e+02 2.79455948e-02]
mat_Sqrt:  [[ 1.82519078e+01  0.00000000e+00]
 [-6.68677438e-03  1.53213249e-02]]
grads:  [ -0.01383891 -11.62801251]
Stock Position:  -0.013838913453973608
Bond Position:  [-0.38477846]


portfolio before change:  [-1.90550213]
curr_Stock_Price:  109.88402918986979
curr_Factors:  [1.09884029e+02 2.62010078e-02]
mat_Sqrt:  [[ 1.77866260e+01  0.00000000e+00]
 [-6.47469014e-03  1.48353788e-02]]
grads:  [0.00570491 3.59607001]
Stock Position:  0.005704913995645199
Bond Position:  [-2.53238106]


portfolio before change:  [-1.91030394]
curr_Stock_Price:  109.09782244441185
curr_Factors:  [1.09097822e+02 2.61772257e-02]
mat_Sqrt:  [[ 1.76513486e+01  0.00000000e+00]
 [-6.47175101e-03  1.48286444e-02]]
grads:  [-5.36319423e-03  5.48432775e+00]
Stock Position:  -0.005363194228812618
Bond Position:  [-1.32519112]


portfolio before change:  [-1.90478694]
curr_Stock_Price:  108.03825679285323
curr_Factors:  [1.08038257e+02 2.56071467e-02]
mat_Sqrt:  [[ 1.72885338e+01  0.00000000e+00]
 [-6.40089328e-03  1.46662890e-02]]
grads:  [-0.0265714  -6.34182817]
Stock Position:  -0.02657139778602063
Bond Position:  [0.96594056]


portfolio before change:  [-1.88977466]
curr_Stock_Price:  107.47782227578752
curr_Factors:  [1.07477822e+02 2.49739523e-02]
mat_Sqrt:  [[ 1.69848805e+01  0.00000000e+00]
 [-6.32125966e-03  1.44838254e-02]]
grads:  [-5.56288333e-03 -1.00703025e+01]
Stock Position:  -0.00556288332598993
Bond Position:  [-1.29188807]


portfolio before change:  [-1.89608702]
curr_Stock_Price:  108.58351874118762
curr_Factors:  [1.08583519e+02 2.40443454e-02]
mat_Sqrt:  [[ 1.68372202e+01  0.00000000e+00]
 [-6.20249568e-03  1.42117030e-02]]
grads:  [-1.20282866e-03 -4.46535892e+00]
Stock Position:  -0.0012028286613413144
Bond Position:  [-1.76547965]


portfolio before change:  [-1.89841861]
curr_Stock_Price:  110.33845888172272
curr_Factors:  [1.10338459e+02 2.45433609e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.89841861]
Stock Price:  109.91495239155768
PL:  [-11.813371]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.16498099e+00  2.92280075e-01]
 [-1.77580948e-01 -4.45259787e-02]
 [ 1.10492401e-01 -1.88704107e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.12251078e-01 -2.68674531e-01]
 [-3.69705866e-01  2.03687171e-01]
 [ 1.11759841e-01 -1.79406355e-02]
 [ 3.43010844e-01  4.81593344e-01]
 [-6.41459550e-02  1.26223164e-01]
 [ 1.82126136e-01  4.83704759e-02]
 [-1.05439329e-01  4.28369956e-03]
 [ 3.15511807e-02 -1.36329197e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-7.81934096e-02  7.03284649e-02]
 [ 4.90795835e-01  3.20224393e-01]
 [ 1.29967900e-01  9.95257917e-04]
 [ 4.03343030e-02  1.27336759e-01]
 [ 1.17094526e-01  8.35298350e-02]
 [-4.59110305e-02 -3.10133714e-02]
 [-7.04345646e-02 -4.28211258e-02]
 [ 1.79398960e-01 -4.57936584e-02]
 [ 7.66557555e-01 -5.30029998e-02]
 [ 2.89062554e-02 -3.30260397e-01]
 [ 3.87733227e-02  1.22149760e-02]
 [ 1.83808787e-01 -1.00086768e-01]
 [ 1.49488514e-01 -8.62960059e-02]
 [ 1.02125425e-02 -1.01635710e-01]
 [ 5.46700500e-02  2.52436736e-01]
 [ 7.45017587e-02  1.07262325e-01]
 [-5.42233760e-01 -1.28997868e-01]
 [-1.64990615e-01 -5.99091299e-02]
 [-1.45017504e-02 -2.15463480e-02]
 [ 1.71421480e-01  2.01354798e-01]
 [ 2.89134687e-02 -1.52896003e-02]
 [ 1.88298842e-01 -1.36183575e-01]
 [ 5.31635322e-02  1.06479401e-01]
 [-5.24876646e-02  1.17839108e-01]
 [-3.07522760e-01 -1.13775174e-01]
 [ 1.34582160e-01 -3.30307731e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.57229507]
curr_Stock_Price:  100.70991706295163
curr_Factors:  [1.00709917e+02 4.13240013e-02]
mat_Sqrt:  [[ 2.04726198e+01  0.00000000e+00]
 [-8.13132228e-03  1.86311999e-02]]
grads:  [ 0.06313518 15.68766781]
Stock Position:  0.06313517674577143
Bond Position:  [1.21395666]


portfolio before change:  [7.60630904]
curr_Stock_Price:  101.24626171947236
curr_Factors:  [1.01246262e+02 4.10422997e-02]
mat_Sqrt:  [[ 2.05113781e+01  0.00000000e+00]
 [-8.10355968e-03  1.85675878e-02]]
grads:  [-0.00960509 -2.39804864]
Stock Position:  -0.00960509221725859
Bond Position:  [8.57878872]


portfolio before change:  [7.61585108]
curr_Stock_Price:  100.36447734434327
curr_Factors:  [1.00364477e+02 4.18272344e-02]
mat_Sqrt:  [[ 2.05262494e+01  0.00000000e+00]
 [-8.18068304e-03  1.87442996e-02]]
grads:  [ 0.00498175 -1.00672797]
Stock Position:  0.004981751734889101
Bond Position:  [7.11586017]


portfolio before change:  [7.61839909]
curr_Stock_Price:  100.69738772488819
curr_Factors:  [1.00697388e+02 4.02758163e-02]
mat_Sqrt:  [[ 2.02087932e+01  0.00000000e+00]
 [-8.02753424e-03  1.83933917e-02]]
grads:  [-8.06647225e-04 -8.23050013e+00]
Stock Position:  -0.0008066472250899687
Bond Position:  [7.69962636]


portfolio before change:  [7.61861562]
curr_Stock_Price:  101.62218378160236
curr_Factors:  [1.01622184e+02 3.89695227e-02]
mat_Sqrt:  [[ 2.00609302e+01  0.00000000e+00]
 [-7.89627990e-03  1.80926502e-02]]
grads:  [-1.14406587e-02 -1.48499268e+01]
Stock Position:  -0.011440658748677978
Bond Position:  [8.78124035]


portfolio before change:  [7.61313317]
curr_Stock_Price:  102.19734123330775
curr_Factors:  [1.02197341e+02 3.95796332e-02]
mat_Sqrt:  [[ 2.03317837e+01  0.00000000e+00]
 [-7.95785229e-03  1.82337302e-02]]
grads:  [-0.01381136 11.17089965]
Stock Position:  -0.013811355749557906
Bond Position:  [9.024617]


portfolio before change:  [7.63509164]
curr_Stock_Price:  100.68913850622828
curr_Factors:  [1.00689139e+02 4.01998263e-02]
mat_Sqrt:  [[ 2.01880659e+01  0.00000000e+00]
 [-8.01995774e-03  1.83760317e-02]]
grads:  [ 0.00514809 -0.9763063 ]
Stock Position:  0.0051480863369767925
Bond Position:  [7.11673526]


portfolio before change:  [7.63363421]
curr_Stock_Price:  100.23322703146641
curr_Factors:  [1.00233227e+02 3.94659176e-02]
mat_Sqrt:  [[ 1.99123636e+01  0.00000000e+00]
 [-7.94641228e-03  1.82075179e-02]]
grads:  [ 0.0277815  26.45024692]
Stock Position:  0.027781504007382742
Bond Position:  [4.84900442]


portfolio before change:  [7.61799344]
curr_Stock_Price:  99.64841553353013
curr_Factors:  [9.96484155e+01 4.06132868e-02]
mat_Sqrt:  [[ 2.00818846e+01  0.00000000e+00]
 [-8.06109539e-03  1.84702899e-02]]
grads:  [-4.51035858e-04  6.83384854e+00]
Stock Position:  -0.0004510358579349915
Bond Position:  [7.66293844]


portfolio before change:  [7.61907699]
curr_Stock_Price:  99.36989121116216
curr_Factors:  [9.93698912e+01 4.03325067e-02]
mat_Sqrt:  [[ 1.99564102e+01  0.00000000e+00]
 [-8.03318185e-03  1.84063320e-02]]
grads:  [0.01018403 2.62792587]
Stock Position:  0.01018403311246525
Bond Position:  [6.60709072]


portfolio before change:  [7.61389403]
curr_Stock_Price:  98.7798597942389
curr_Factors:  [9.87798598e+01 3.98746099e-02]
mat_Sqrt:  [[ 1.97249826e+01  0.00000000e+00]
 [-7.98745115e-03  1.83015497e-02]]
grads:  [-0.00525069  0.23406212]
Stock Position:  -0.005250690007887415
Bond Position:  [8.13255645]


portfolio before change:  [7.61752258]
curr_Stock_Price:  98.28241573090584
curr_Factors:  [9.82824157e+01 4.04878608e-02]
mat_Sqrt:  [[ 1.97759902e+01  0.00000000e+00]
 [-8.04863822e-03  1.84417469e-02]]
grads:  [-1.41321667e-03 -7.39242317e+00]
Stock Position:  -0.0014132166682303536
Bond Position:  [7.75641693]


portfolio before change:  [7.61784678]
curr_Stock_Price:  98.7391175914819
curr_Factors:  [9.87391176e+01 3.81422231e-02]
mat_Sqrt:  [[ 1.92837833e+01  0.00000000e+00]
 [-7.81201363e-03  1.78995719e-02]]
grads:  [-0.00670765 -1.56715509]
Stock Position:  -0.006707650988096575
Bond Position:  [8.28015432]


portfolio before change:  [7.62127324]
curr_Stock_Price:  98.38260250600794
curr_Factors:  [9.83826025e+01 3.69869361e-02]
mat_Sqrt:  [[ 1.89209303e+01  0.00000000e+00]
 [-7.69279519e-03  1.76264081e-02]]
grads:  [-2.51042367e-03  3.98994874e+00]
Stock Position:  -0.002510423668070985
Bond Position:  [7.86825525]


portfolio before change:  [7.6234021]
curr_Stock_Price:  97.92639945734312
curr_Factors:  [9.79263995e+01 3.76138123e-02]
mat_Sqrt:  [[ 1.89921208e+01  0.00000000e+00]
 [-7.75771227e-03  1.77751518e-02]]
grads:  [ 0.03320078 18.01528314]
Stock Position:  0.0332007797398849
Bond Position:  [4.37216928]


portfolio before change:  [7.64088456]
curr_Stock_Price:  98.43650527919478
curr_Factors:  [9.84365053e+01 3.72935904e-02]
mat_Sqrt:  [[ 1.90096134e+01  0.00000000e+00]
 [-7.72461938e-03  1.76993265e-02]]
grads:  [0.00685981 0.0562314 ]
Stock Position:  0.006859806339720908
Bond Position:  [6.9656292]


portfolio before change:  [7.63293338]
curr_Stock_Price:  97.15047225496275
curr_Factors:  [9.71504723e+01 3.85429062e-02]
mat_Sqrt:  [[ 1.90729182e+01  0.00000000e+00]
 [-7.85293893e-03  1.79933435e-02]]
grads:  [5.02852370e-03 7.07688145e+00]
Stock Position:  0.005028523696493216
Bond Position:  [7.14440993]


portfolio before change:  [7.63177069]
curr_Stock_Price:  96.74164521610524
curr_Factors:  [9.67416452e+01 3.85068347e-02]
mat_Sqrt:  [[ 1.89837663e+01  0.00000000e+00]
 [-7.84926337e-03  1.79849218e-02]]
grads:  [0.00808849 4.64443694]
Stock Position:  0.008088486369564597
Bond Position:  [6.84927721]


portfolio before change:  [7.64806681]
curr_Stock_Price:  98.65051941586071
curr_Factors:  [9.86505194e+01 3.99506750e-02]
mat_Sqrt:  [[ 1.97179353e+01  0.00000000e+00]
 [-7.99506598e-03  1.83189975e-02]]
grads:  [-0.00301484 -1.69296226]
Stock Position:  -0.003014837735725158
Bond Position:  [7.94548212]


portfolio before change:  [7.64547088]
curr_Stock_Price:  99.84102285078829
curr_Factors:  [9.98410229e+01 4.01227416e-02]
mat_Sqrt:  [[ 1.99988177e+01  0.00000000e+00]
 [-8.01226476e-03  1.83584049e-02]]
grads:  [-0.00445643 -2.33250798]
Stock Position:  -0.004456425238724057
Bond Position:  [8.09040494]


portfolio before change:  [7.64735937]
curr_Stock_Price:  99.64420014212892
curr_Factors:  [9.96442001e+01 3.96604565e-02]
mat_Sqrt:  [[ 1.98440759e+01  0.00000000e+00]
 [-7.96597328e-03  1.82523378e-02]]
grads:  [ 0.00803328 -2.50892017]
Stock Position:  0.008033277520652209
Bond Position:  [6.84688986]


portfolio before change:  [7.65380844]
curr_Stock_Price:  100.3404476213414
curr_Factors:  [1.00340448e+02 3.99526238e-02]
mat_Sqrt:  [[ 2.00562016e+01  0.00000000e+00]
 [-7.99526098e-03  1.83194443e-02]]
grads:  [ 0.0370671 -2.8932646]
Stock Position:  0.03706709589330047
Bond Position:  [3.93447944]


portfolio before change:  [7.68057945]
curr_Stock_Price:  101.04940996404574
curr_Factors:  [1.01049410e+02 3.85127259e-02]
mat_Sqrt:  [[ 1.98306026e+01  0.00000000e+00]
 [-7.84986379e-03  1.79862975e-02]]
grads:  [-5.81077646e-03 -1.83617777e+01]
Stock Position:  -0.00581077646269172
Bond Position:  [8.26775498]


portfolio before change:  [7.68153353]
curr_Stock_Price:  101.06308399331337
curr_Factors:  [1.01063084e+02 3.83769038e-02]
mat_Sqrt:  [[ 1.97982824e+01  0.00000000e+00]
 [-7.83600958e-03  1.79545535e-02]]
grads:  [0.00222769 0.68032747]
Stock Position:  0.0022276869516401183
Bond Position:  [7.45639662]


portfolio before change:  [7.6813076]
curr_Stock_Price:  100.54324804309454
curr_Factors:  [1.00543248e+02 3.92965980e-02]
mat_Sqrt:  [[ 1.99310596e+01  0.00000000e+00]
 [-7.92934781e-03  1.81684183e-02]]
grads:  [ 0.0070306  -5.50883225]
Stock Position:  0.007030601627306216
Bond Position:  [6.97442808]


portfolio before change:  [7.68728199]
curr_Stock_Price:  101.26900824338601
curr_Factors:  [1.01269008e+02 3.85774642e-02]
mat_Sqrt:  [[ 1.98903944e+01  0.00000000e+00]
 [-7.85645866e-03  1.80014083e-02]]
grads:  [ 0.0056221 -4.7938475]
Stock Position:  0.005622103141129732
Bond Position:  [7.11793718]


portfolio before change:  [7.68559719]
curr_Stock_Price:  100.81106483886184
curr_Factors:  [1.00811065e+02 3.89491356e-02]
mat_Sqrt:  [[ 1.98956033e+01  0.00000000e+00]
 [-7.89421414e-03  1.80879169e-02]]
grads:  [-1.71620420e-03 -5.61898368e+00]
Stock Position:  -0.0017162041958165102
Bond Position:  [7.85860956]


portfolio before change:  [7.6862722]
curr_Stock_Price:  100.9901653285665
curr_Factors:  [1.00990165e+02 3.84413068e-02]
mat_Sqrt:  [[ 1.98005911e+01  0.00000000e+00]
 [-7.84258190e-03  1.79696126e-02]]
grads:  [8.32512896e-03 1.40479788e+01]
Stock Position:  0.008325128963735686
Bond Position:  [6.84551605]


portfolio before change:  [7.67338642]
curr_Stock_Price:  99.33955723786109
curr_Factors:  [9.93395572e+01 3.92582449e-02]
mat_Sqrt:  [[ 1.96828354e+01  0.00000000e+00]
 [-7.92547738e-03  1.81595500e-02]]
grads:  [0.00616349 5.90666204]
Stock Position:  0.006163485743657959
Bond Position:  [7.06110847]


portfolio before change:  [7.66884717]
curr_Stock_Price:  98.45987032170756
curr_Factors:  [9.84598703e+01 3.90614622e-02]
mat_Sqrt:  [[ 1.94595820e+01  0.00000000e+00]
 [-7.90558913e-03  1.81139803e-02]]
grads:  [-0.03075775 -7.12145349]
Stock Position:  -0.030757754471147678
Bond Position:  [10.69725169]


portfolio before change:  [7.66092272]
curr_Stock_Price:  98.76098766075181
curr_Factors:  [9.87609877e+01 3.72141307e-02]
mat_Sqrt:  [[ 1.90519470e+01  0.00000000e+00]
 [-7.71638575e-03  1.76804609e-02]]
grads:  [-0.01003242 -3.38843711]
Stock Position:  -0.010032418367434218
Bond Position:  [8.65173427]


portfolio before change:  [7.67457771]
curr_Stock_Price:  97.50770549279011
curr_Factors:  [9.75077055e+01 3.72866471e-02]
mat_Sqrt:  [[ 1.88284948e+01  0.00000000e+00]
 [-7.72390027e-03  1.76976788e-02]]
grads:  [-0.00126964 -1.21746746]
Stock Position:  -0.0012696366771197246
Bond Position:  [7.79837707]


portfolio before change:  [7.6768786]
curr_Stock_Price:  96.46328226506772
curr_Factors:  [9.64632823e+01 3.93176601e-02]
mat_Sqrt:  [[ 1.91273968e+01  0.00000000e+00]
 [-7.93147251e-03  1.81732866e-02]]
grads:  [ 0.01355647 11.07971292]
Stock Position:  0.013556466746576215
Bond Position:  [6.36917732]


portfolio before change:  [7.66587299]
curr_Stock_Price:  95.592715444717
curr_Factors:  [9.55927154e+01 3.99617264e-02]
mat_Sqrt:  [[ 1.91093942e+01  0.00000000e+00]
 [-7.99617173e-03  1.83215311e-02]]
grads:  [ 0.00116385 -0.83451542]
Stock Position:  0.0011638537506967854
Bond Position:  [7.55461705]


portfolio before change:  [7.66684817]
curr_Stock_Price:  95.6191758740801
curr_Factors:  [9.56191759e+01 3.91610609e-02]
mat_Sqrt:  [[ 1.89222258e+01  0.00000000e+00]
 [-7.91566152e-03  1.81370591e-02]]
grads:  [ 6.81016380e-03 -7.50858088e+00]
Stock Position:  0.00681016379608834
Bond Position:  [7.01566592]


portfolio before change:  [7.66686249]
curr_Stock_Price:  95.49249814075331
curr_Factors:  [9.54924981e+01 3.90191253e-02]
mat_Sqrt:  [[ 1.88628808e+01  0.00000000e+00]
 [-7.90130372e-03  1.81041612e-02]]
grads:  [5.28206449e-03 5.88148768e+00]
Stock Position:  0.005282064492367179
Bond Position:  [7.16246496]


portfolio before change:  [7.66658333]
curr_Stock_Price:  95.27013746742598
curr_Factors:  [9.52701375e+01 4.03542559e-02]
mat_Sqrt:  [[ 1.91382165e+01  0.00000000e+00]
 [-8.03534750e-03  1.84112941e-02]]
grads:  [-5.53061620e-05  6.40037077e+00]
Stock Position:  -5.530616198731947e-05
Bond Position:  [7.67185236]


portfolio before change:  [7.66754419]
curr_Stock_Price:  95.23725135533937
curr_Factors:  [9.52372514e+01 3.86483792e-02]
mat_Sqrt:  [[ 1.87228732e+01  0.00000000e+00]
 [-7.86367642e-03  1.80179462e-02]]
grads:  [-0.01907711 -6.3145473 ]
Stock Position:  -0.019077110282451036
Bond Position:  [9.48439574]


portfolio before change:  [7.66285182]
curr_Stock_Price:  95.54536884800004
curr_Factors:  [9.55453688e+01 3.93638600e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.66285182]
Stock Price:  97.45144344102334
PL:  [7.66285182]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.43049172e+00  3.52306732e-01]
 [ 1.05113005e+00  7.31172842e-02]
 [ 1.01723302e-01 -4.06771051e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.43388806e-02  3.75851511e-01]
 [-1.12914409e-01 -8.02496022e-02]
 [ 8.84106960e-02  9.14351197e-02]
 [ 4.10448968e-01  5.06222579e-01]
 [ 2.18986830e-03  3.38224967e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-2.87195520e-02  1.73149959e-02]
 [ 6.76580632e-02 -1.01943119e-01]
 [-7.91826246e-02  1.26860909e-01]
 [-1.34899882e-01  3.88395528e-01]
 [ 1.80200213e-01  1.75734619e-01]
 [ 1.31407271e-01  3.27162014e-02]
 [ 4.06660740e-02  1.24614365e-01]
 [ 4.62513503e-02  7.14415507e-02]
 [-4.80196515e-02 -3.23146329e-02]
 [-9.78825579e-02 -2.04178417e-02]
 [ 1.61169113e-01 -1.93494217e-02]
 [ 1.19562707e+00  1.16498139e-01]
 [ 1.62304971e-02  3.78838771e-01]
 [-1.36357704e-01  1.24642076e-01]
 [-1.95002710e-01  2.05142397e-01]
 [ 1.15267968e-01 -1.08552305e-01]
 [-2.11832126e-01 -4.47116517e-01]
 [ 6.61823826e-02  6.13568614e-02]
 [ 3.66942323e-01 -1.50919559e-01]
 [-5.34149547e-01 -1.64808494e-01]
 [-1.21246826e-01 -4.16833326e-02]
 [ 9.15416612e-03 -6.08430618e-02]
 [-1.43720218e-01  1.52565734e-01]
 [ 4.07866931e-03  1.14302885e-02]
 [ 2.18451767e-02  1.49007194e-02]
 [-1.39270126e-01  1.12034779e-01]
 [-3.89370347e-02 -7.73628666e-02]
 [-1.27507440e-01 -6.62786483e-02]
 [ 1.19518462e-01 -9.12562349e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.41482919]
curr_Stock_Price:  99.55054631858053
curr_Factors:  [9.95505463e+01 4.01019315e-02]
mat_Sqrt:  [[ 1.99354615e+01  0.00000000e+00]
 [-8.01018667e-03  1.83536434e-02]]
grads:  [ 0.07946899 19.1954657 ]
Stock Position:  0.07946898972567863
Bond Position:  [-8.32601053]


portfolio before change:  [-0.50298546]
curr_Stock_Price:  98.45432691030355
curr_Factors:  [9.84543269e+01 3.96403318e-02]
mat_Sqrt:  [[ 1.96021383e+01  0.00000000e+00]
 [-7.96395197e-03  1.82477064e-02]]
grads:  [0.05525117 4.00693012]
Stock Position:  0.055251168755490514
Bond Position:  [-5.94270209]


portfolio before change:  [-0.47942645]
curr_Stock_Price:  98.89417088037222
curr_Factors:  [9.88941709e+01 3.88182229e-02]
mat_Sqrt:  [[ 1.94844665e+01  0.00000000e+00]
 [-7.88093627e-03  1.80574935e-02]]
grads:  [ 0.00430961 -2.25264404]
Stock Position:  0.004309605172790231
Bond Position:  [-0.90562128]


portfolio before change:  [-0.4746989]
curr_Stock_Price:  100.0174189989954
curr_Factors:  [1.00017419e+02 3.78313886e-02]
mat_Sqrt:  [[ 1.94536807e+01  0.00000000e+00]
 [-7.78011708e-03  1.78264877e-02]]
grads:  [-8.37957977e-04 -8.49224002e+00]
Stock Position:  -0.0008379579767706036
Bond Position:  [-0.39088851]


portfolio before change:  [-0.47348472]
curr_Stock_Price:  98.51013163913517
curr_Factors:  [9.85101316e+01 4.05991166e-02]
mat_Sqrt:  [[ 1.98490256e+01  0.00000000e+00]
 [-8.05968898e-03  1.84670674e-02]]
grads:  [4.01511735e-03 2.03525282e+01]
Stock Position:  0.0040151173452292336
Bond Position:  [-0.86901446]


portfolio before change:  [-0.47010936]
curr_Stock_Price:  99.37785076291969
curr_Factors:  [9.93778508e+01 3.95276660e-02]
mat_Sqrt:  [[ 1.97578728e+01  0.00000000e+00]
 [-7.95262633e-03  1.82217561e-02]]
grads:  [-0.00748756 -4.40405425]
Stock Position:  -0.007487557377287566
Bond Position:  [0.273988]


portfolio before change:  [-0.47151817]
curr_Stock_Price:  99.57057870070264
curr_Factors:  [9.95705787e+01 3.94321655e-02]
mat_Sqrt:  [[ 1.97722615e+01  0.00000000e+00]
 [-7.94301359e-03  1.81997305e-02]]
grads:  [0.00648971 5.02398207]
Stock Position:  0.0064897105446128514
Bond Position:  [-1.11770241]


portfolio before change:  [-0.46880756]
curr_Stock_Price:  100.00978699699414
curr_Factors:  [1.00009787e+02 3.83500690e-02]
mat_Sqrt:  [[ 1.95850902e+01  0.00000000e+00]
 [-7.83326946e-03  1.79482751e-02]]
grads:  [ 0.03223792 28.20452526]
Stock Position:  0.03223792211635922
Bond Position:  [-3.69291528]


portfolio before change:  [-0.53858359]
curr_Stock_Price:  97.85969830860867
curr_Factors:  [9.78596983e+01 3.98961017e-02]
mat_Sqrt:  [[ 1.95465045e+01  0.00000000e+00]
 [-7.98960341e-03  1.83064812e-02]]
grads:  [7.66394553e-03 1.84756952e+01]
Stock Position:  0.007663945530222451
Bond Position:  [-1.28857499]


portfolio before change:  [-0.54076473]
curr_Stock_Price:  97.59611944199456
curr_Factors:  [9.75961194e+01 3.89463685e-02]
mat_Sqrt:  [[ 1.92604325e+01  0.00000000e+00]
 [-7.89393372e-03  1.80872744e-02]]
grads:  [0.01279484 6.25171769]
Stock Position:  0.012794841827771535
Bond Position:  [-1.78949164]


portfolio before change:  [-0.55178462]
curr_Stock_Price:  96.75232704918395
curr_Factors:  [9.67523270e+01 3.90153463e-02]
mat_Sqrt:  [[ 1.91108125e+01  0.00000000e+00]
 [-7.90092109e-03  1.81032845e-02]]
grads:  [-0.00110737  0.95645605]
Stock Position:  -0.0011073662193326877
Bond Position:  [-0.44464436]


portfolio before change:  [-0.5511269]
curr_Stock_Price:  96.10818170048672
curr_Factors:  [9.61081817e+01 3.83546365e-02]
mat_Sqrt:  [[ 1.88221529e+01  0.00000000e+00]
 [-7.83373592e-03  1.79493439e-02]]
grads:  [ 1.23080706e-03 -5.67948998e+00]
Stock Position:  0.0012308070569292465
Bond Position:  [-0.66941753]


portfolio before change:  [-0.55276617]
curr_Stock_Price:  94.84430349367915
curr_Factors:  [9.48443035e+01 3.77471189e-02]
mat_Sqrt:  [[ 1.84269372e+01  0.00000000e+00]
 [-7.77144711e-03  1.78066223e-02]]
grads:  [-1.29245488e-03  7.12436679e+00]
Stock Position:  -0.0012924548787663936
Bond Position:  [-0.43018419]


portfolio before change:  [-0.55287511]
curr_Stock_Price:  94.88698559569958
curr_Factors:  [9.48869856e+01 3.77369454e-02]
mat_Sqrt:  [[ 1.84327453e+01  0.00000000e+00]
 [-7.77039977e-03  1.78042226e-02]]
grads:  [1.87762716e-03 2.18147985e+01]
Stock Position:  0.0018776271581208842
Bond Position:  [-0.73103749]


portfolio before change:  [-0.55412646]
curr_Stock_Price:  94.26920214581314
curr_Factors:  [9.42692021e+01 3.89937982e-02]
mat_Sqrt:  [[ 1.86151955e+01  0.00000000e+00]
 [-7.89873895e-03  1.80982846e-02]]
grads:  [0.0138004  9.71001522]
Stock Position:  0.013800397027027867
Bond Position:  [-1.85507888]


portfolio before change:  [-0.51948846]
curr_Stock_Price:  96.79593392502683
curr_Factors:  [9.67959339e+01 3.81881231e-02]
mat_Sqrt:  [[ 1.89156501e+01  0.00000000e+00]
 [-7.81671267e-03  1.79103387e-02]]
grads:  [0.00770187 1.8266657 ]
Stock Position:  0.0077018654491298865
Bond Position:  [-1.26499772]


portfolio before change:  [-0.52008408]
curr_Stock_Price:  96.73913210346299
curr_Factors:  [9.67391321e+01 3.81097383e-02]
mat_Sqrt:  [[ 1.88851383e+01  0.00000000e+00]
 [-7.80868628e-03  1.78919480e-02]]
grads:  [5.03317689e-03 6.96482940e+00]
Stock Position:  0.005033176890239879
Bond Position:  [-1.00698924]


portfolio before change:  [-0.5150665]
curr_Stock_Price:  97.76104264732226
curr_Factors:  [9.77610426e+01 3.77163674e-02]
mat_Sqrt:  [[ 1.89858810e+01  0.00000000e+00]
 [-7.76828088e-03  1.77993676e-02]]
grads:  [0.00407835 4.01371287]
Stock Position:  0.004078346396650206
Bond Position:  [-0.9137699]


portfolio before change:  [-0.5121034]
curr_Stock_Price:  98.51559511507953
curr_Factors:  [9.85155951e+01 3.73308413e-02]
mat_Sqrt:  [[ 1.90343861e+01  0.00000000e+00]
 [-7.72847631e-03  1.77081639e-02]]
grads:  [-0.00326372 -1.8248438 ]
Stock Position:  -0.003263720370229891
Bond Position:  [-0.19057605]


portfolio before change:  [-0.51400024]
curr_Stock_Price:  99.08948267570533
curr_Factors:  [9.90894827e+01 3.67788553e-02]
mat_Sqrt:  [[ 1.90031968e+01  0.00000000e+00]
 [-7.67112563e-03  1.75767569e-02]]
grads:  [-0.00561977 -1.16163873]
Stock Position:  -0.005619772079859286
Bond Position:  [0.04286007]


portfolio before change:  [-0.50864486]
curr_Stock_Price:  98.13748434405476
curr_Factors:  [9.81374843e+01 3.72760671e-02]
mat_Sqrt:  [[ 1.89474148e+01  0.00000000e+00]
 [-7.72280437e-03  1.76951678e-02]]
grads:  [ 0.00806043 -1.0934862 ]
Stock Position:  0.008060431144506577
Bond Position:  [-1.2996753]


portfolio before change:  [-0.51471406]
curr_Stock_Price:  97.40467958511513
curr_Factors:  [9.74046796e+01 3.79049674e-02]
mat_Sqrt:  [[ 1.89639100e+01  0.00000000e+00]
 [-7.78767923e-03  1.78438148e-02]]
grads:  [0.06572859 6.52876865]
Stock Position:  0.06572858783353816
Bond Position:  [-6.91698609]


portfolio before change:  [-0.56962194]
curr_Stock_Price:  96.58246186842264
curr_Factors:  [9.65824619e+01 3.73069325e-02]
mat_Sqrt:  [[ 1.86549050e+01  0.00000000e+00]
 [-7.72600103e-03  1.77024923e-02]]
grads:  [9.73305903e-03 2.14003071e+01]
Stock Position:  0.009733059032758364
Bond Position:  [-1.50966475]


portfolio before change:  [-0.57464756]
curr_Stock_Price:  96.08550644799944
curr_Factors:  [9.60855064e+01 3.79785730e-02]
mat_Sqrt:  [[ 1.87252319e+01  0.00000000e+00]
 [-7.79523680e-03  1.78611314e-02]]
grads:  [-4.37695208e-03  6.97839756e+00]
Stock Position:  -0.0043769520847860635
Bond Position:  [-0.1540859]


portfolio before change:  [-0.57913538]
curr_Stock_Price:  97.10643643893744
curr_Factors:  [9.71064364e+01 3.79271438e-02]
mat_Sqrt:  [[ 1.89113741e+01  0.00000000e+00]
 [-7.78995701e-03  1.78490338e-02]]
grads:  [-5.57713188e-03  1.14931934e+01]
Stock Position:  -0.005577131881347014
Bond Position:  [-0.03755998]


portfolio before change:  [-0.58570128]
curr_Stock_Price:  98.28288442655268
curr_Factors:  [9.82828844e+01 3.67803899e-02]
mat_Sqrt:  [[ 1.88489021e+01  0.00000000e+00]
 [-7.67128567e-03  1.75771236e-02]]
grads:  [ 3.60189988e-03 -6.17577181e+00]
Stock Position:  0.003601899880714803
Bond Position:  [-0.93970639]


portfolio before change:  [-0.58923097]
curr_Stock_Price:  97.33554641244658
curr_Factors:  [9.73355464e+01 3.72049954e-02]
mat_Sqrt:  [[ 1.87746608e+01  0.00000000e+00]
 [-7.71543859e-03  1.76782907e-02]]
grads:  [-2.16765446e-02 -2.52918410e+01]
Stock Position:  -0.02167654459136496
Bond Position:  [1.52066734]


portfolio before change:  [-0.5726545]
curr_Stock_Price:  96.57959696150077
curr_Factors:  [9.65795970e+01 3.71393232e-02]
mat_Sqrt:  [[ 1.86124002e+01  0.00000000e+00]
 [-7.70862615e-03  1.76626814e-02]]
grads:  [0.00499456 3.47381352]
Stock Position:  0.004994558011306648
Bond Position:  [-1.0550269]


portfolio before change:  [-0.57437905]
curr_Stock_Price:  96.2607177193839
curr_Factors:  [9.62607177e+01 3.76663535e-02]
mat_Sqrt:  [[ 1.86821083e+01  0.00000000e+00]
 [-7.76312860e-03  1.77875622e-02]]
grads:  [ 0.01611572 -8.48455551]
Stock Position:  0.016115720104594132
Bond Position:  [-2.12568984]


portfolio before change:  [-0.55493829]
curr_Stock_Price:  97.48352948954638
curr_Factors:  [9.74835295e+01 3.61761882e-02]
mat_Sqrt:  [[ 1.85414053e+01  0.00000000e+00]
 [-7.60801558e-03  1.74321536e-02]]
grads:  [-0.03268781 -9.45428185]
Stock Position:  -0.03268780661899249
Bond Position:  [2.63158447]


portfolio before change:  [-0.55061431]
curr_Stock_Price:  97.36131246727004
curr_Factors:  [9.73613125e+01 3.75850074e-02]
mat_Sqrt:  [[ 1.88752946e+01  0.00000000e+00]
 [-7.75474125e-03  1.77683444e-02]]
grads:  [-0.00738738 -2.34593228]
Stock Position:  -0.007387377346441398
Bond Position:  [0.16863044]


portfolio before change:  [-0.56555134]
curr_Stock_Price:  99.38613218535102
curr_Factors:  [9.93861322e+01 3.63031549e-02]
mat_Sqrt:  [[ 1.89364242e+01  0.00000000e+00]
 [-7.62135473e-03  1.74627175e-02]]
grads:  [-9.18860016e-04 -3.48416917e+00]
Stock Position:  -0.0009188600160551101
Bond Position:  [-0.4742294]


portfolio before change:  [-0.56581232]
curr_Stock_Price:  99.60564301588431
curr_Factors:  [9.96056430e+01 3.60598237e-02]
mat_Sqrt:  [[ 1.89145382e+01  0.00000000e+00]
 [-7.59576974e-03  1.74040949e-02]]
grads:  [-4.07808385e-03  8.76608260e+00]
Stock Position:  -0.004078083847915312
Bond Position:  [-0.15961216]


portfolio before change:  [-0.55986847]
curr_Stock_Price:  98.14323905226941
curr_Factors:  [9.81432391e+01 3.83316528e-02]
mat_Sqrt:  [[ 1.92149456e+01  0.00000000e+00]
 [-7.83138841e-03  1.79439651e-02]]
grads:  [4.71885602e-04 6.36999036e-01]
Stock Position:  0.0004718856019905175
Bond Position:  [-0.60618085]


portfolio before change:  [-0.5597905]
curr_Stock_Price:  98.46904341584619
curr_Factors:  [9.84690434e+01 3.98394823e-02]
mat_Sqrt:  [[ 1.96542539e+01  0.00000000e+00]
 [-7.98393210e-03  1.82934866e-02]]
grads:  [0.00144235 0.81453687]
Stock Position:  0.0014423535961434247
Bond Position:  [-0.70181768]


portfolio before change:  [-0.55924752]
curr_Stock_Price:  98.90632799868156
curr_Factors:  [9.89063280e+01 3.96094791e-02]
mat_Sqrt:  [[ 1.96844663e+01  0.00000000e+00]
 [-7.96085213e-03  1.82406037e-02]]
grads:  [-4.59113997e-03  6.14205434e+00]
Stock Position:  -0.004591139974439552
Bond Position:  [-0.10515472]


portfolio before change:  [-0.55470693]
curr_Stock_Price:  97.9144757412761
curr_Factors:  [9.79144757e+01 4.09383379e-02]
mat_Sqrt:  [[ 1.98112558e+01  0.00000000e+00]
 [-8.09328985e-03  1.85440567e-02]]
grads:  [-3.66967942e-03 -4.17184157e+00]
Stock Position:  -0.0036696794187749343
Bond Position:  [-0.19539219]


portfolio before change:  [-0.55438073]
curr_Stock_Price:  97.81892942402335
curr_Factors:  [9.78189294e+01 4.16262779e-02]
mat_Sqrt:  [[ 1.99575256e+01  0.00000000e+00]
 [-8.16100757e-03  1.86992175e-02]]
grads:  [-0.00783834 -3.54446106]
Stock Position:  -0.007838337119608848
Bond Position:  [0.21235702]


portfolio before change:  [-0.54656031]
curr_Stock_Price:  96.82460165986889
curr_Factors:  [9.68246017e+01 4.20418791e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.54656031]
Stock Price:  95.92682814523519
PL:  [-0.54656031]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.41725344e+00  3.57464420e-01]
 [ 1.48982967e+00  3.18911023e-02]
 [-2.11850732e-01  2.11270537e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.53081846e-01  1.12634007e+00]
 [ 3.57702863e-02 -8.12328707e-03]
 [ 8.98085088e-02  9.24839739e-02]
 [ 1.23222714e+00  1.26819885e+00]
 [ 1.09141404e-01  6.24008406e-01]
 [ 1.46179216e-01  2.27105883e-02]
 [-9.79059600e-03  1.97532079e-02]
 [ 6.95525997e-02 -1.03752666e-01]
 [-1.18388929e-01 -2.64949731e-02]
 [-1.31640219e-01  3.29693894e-01]
 [ 3.55350545e-01  2.53159396e-01]
 [ 1.31779063e-01 -9.95452633e-02]
 [ 3.74407727e-02 -4.45724324e-02]
 [ 3.44476931e-01  6.41607293e-02]
 [ 5.11870421e-01  5.26431154e-01]
 [-8.31119051e-01  4.08047418e-01]
 [-1.84752177e-01  3.21306893e-01]
 [ 1.88518453e+00  3.12713630e-01]
 [ 1.45695733e-02  4.13559343e-01]
 [-1.51595476e-01  1.84591298e-01]
 [-1.91210588e-01  1.15009338e-01]
 [ 1.99698733e-01 -7.82969817e-02]
 [ 2.77625250e-02 -4.57650226e-01]
 [ 1.05242734e-01 -2.17923538e-02]
 [ 6.10593851e-01 -3.10064286e-01]
 [-5.64826257e-01 -3.04714839e-01]
 [ 4.24734723e-01  1.59730298e-01]
 [-2.09994665e-01  3.13284915e-01]
 [ 6.59929923e-01  2.34817387e-01]
 [ 6.55333152e-02 -1.47634841e-01]
 [ 3.00237474e-01 -4.21874784e-01]
 [ 1.34571661e-01  1.98413203e-02]
 [-8.18761360e-02  5.88985522e-01]
 [-3.83488921e-01 -1.42646536e-01]
 [-1.95445839e-01  6.28338327e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.90308241]
curr_Stock_Price:  98.17327925280117
curr_Factors:  [9.81732793e+01 4.11397635e-02]
mat_Sqrt:  [[ 1.99124268e+01  0.00000000e+00]
 [-8.11317580e-03  1.85896211e-02]]
grads:  [ 0.07900914 19.22924719]
Stock Position:  0.0790091391816595
Bond Position:  [-17.6596687]


portfolio before change:  [-9.99055651]
curr_Stock_Price:  97.09408125949659
curr_Factors:  [9.70940813e+01 4.13558562e-02]
mat_Sqrt:  [[ 1.97451876e+01  0.00000000e+00]
 [-8.13445573e-03  1.86383796e-02]]
grads:  [0.0761577 1.7110448]
Stock Position:  0.07615770044094858
Bond Position:  [-17.38501847]


portfolio before change:  [-10.04987262]
curr_Stock_Price:  96.34375864475793
curr_Factors:  [9.63437586e+01 4.32399299e-02]
mat_Sqrt:  [[ 2.00339265e+01  0.00000000e+00]
 [-8.31768525e-03  1.90582111e-02]]
grads:  [-5.97210487e-03  1.10855387e+01]
Stock Position:  -0.005972104871208669
Bond Position:  [-9.47449759]


portfolio before change:  [-10.0544684]
curr_Stock_Price:  96.91497954517578
curr_Factors:  [9.69149795e+01 4.25453289e-02]
mat_Sqrt:  [[ 1.99901867e+01  0.00000000e+00]
 [-8.25060763e-03  1.89045170e-02]]
grads:  [-8.15468468e-04 -8.00797040e+00]
Stock Position:  -0.0008154684684139544
Bond Position:  [-9.97543729]


portfolio before change:  [-10.05512195]
curr_Stock_Price:  96.18723793499379
curr_Factors:  [9.61872379e+01 4.03930110e-02]
mat_Sqrt:  [[ 1.93317232e+01  0.00000000e+00]
 [-8.03920503e-03  1.84201328e-02]]
grads:  [1.75097304e-02 6.11472284e+01]
Stock Position:  0.01750973035324636
Bond Position:  [-11.73933455]


portfolio before change:  [-10.05336742]
curr_Stock_Price:  96.3712525681913
curr_Factors:  [9.63712526e+01 4.07391337e-02]
mat_Sqrt:  [[ 1.94515135e+01  0.00000000e+00]
 [-8.07357504e-03  1.84988844e-02]]
grads:  [ 0.00165668 -0.43912308]
Stock Position:  0.0016566830764715582
Bond Position:  [-10.21302404]


portfolio before change:  [-10.05802039]
curr_Stock_Price:  94.33328547702375
curr_Factors:  [9.43332855e+01 4.11135128e-02]
mat_Sqrt:  [[ 1.91274578e+01  0.00000000e+00]
 [-8.11058694e-03  1.85836893e-02]]
grads:  [0.0068055  4.97662076]
Stock Position:  0.006805495288015949
Bond Position:  [-10.70000512]


portfolio before change:  [-10.05416032]
curr_Stock_Price:  95.09702915634227
curr_Factors:  [9.50970292e+01 3.97481209e-02]
mat_Sqrt:  [[ 1.89594289e+01  0.00000000e+00]
 [-7.97477231e-03  1.82724989e-02]]
grads:  [ 0.09418609 69.40478474]
Stock Position:  0.09418609139142615
Bond Position:  [-19.0109778]


portfolio before change:  [-10.08721108]
curr_Stock_Price:  94.77135221857736
curr_Factors:  [9.47713522e+01 4.02892802e-02]
mat_Sqrt:  [[ 1.90226857e+01  0.00000000e+00]
 [-8.02887591e-03  1.83964658e-02]]
grads:  [2.00540032e-02 3.39200155e+01]
Stock Position:  0.020054003202703292
Bond Position:  [-11.98775608]


portfolio before change:  [-10.06239246]
curr_Stock_Price:  96.08366788411848
curr_Factors:  [9.60836679e+01 3.95754953e-02]
mat_Sqrt:  [[ 1.91144917e+01  0.00000000e+00]
 [-7.95743630e-03  1.82327771e-02]]
grads:  [0.0081661  1.24559129]
Stock Position:  0.008166104121856737
Bond Position:  [-10.8470217]


portfolio before change:  [-10.06631451]
curr_Stock_Price:  95.76943188467588
curr_Factors:  [9.57694319e+01 3.90363872e-02]
mat_Sqrt:  [[ 1.89217683e+01  0.00000000e+00]
 [-7.90305128e-03  1.81081654e-02]]
grads:  [-6.18118387e-05  1.09084535e+00]
Stock Position:  -6.181183873723815e-05
Bond Position:  [-10.06039482]


portfolio before change:  [-10.06760572]
curr_Stock_Price:  96.31274968384244
curr_Factors:  [9.63127497e+01 3.81689584e-02]
mat_Sqrt:  [[ 1.88165040e+01  0.00000000e+00]
 [-7.81475101e-03  1.79058440e-02]]
grads:  [ 1.28989019e-03 -5.79434659e+00]
Stock Position:  0.001289890188226094
Bond Position:  [-10.19183859]


portfolio before change:  [-10.06803764]
curr_Stock_Price:  96.96562313800055
curr_Factors:  [9.69656231e+01 3.81245191e-02]
mat_Sqrt:  [[ 1.89330238e+01  0.00000000e+00]
 [-7.81020041e-03  1.78954173e-02]]
grads:  [-0.00686379 -1.48054514]
Stock Position:  -0.006863789173092601
Bond Position:  [-9.40248605]


portfolio before change:  [-10.05947722]
curr_Stock_Price:  95.54719324082511
curr_Factors:  [9.55471932e+01 3.80672276e-02]
mat_Sqrt:  [[ 1.86420453e+01  0.00000000e+00]
 [-7.80432984e-03  1.78819661e-02]]
grads:  [6.57116378e-04 1.84372285e+01]
Stock Position:  0.0006571163776149493
Bond Position:  [-10.12226285]


portfolio before change:  [-10.0603742]
curr_Stock_Price:  96.10779348616664
curr_Factors:  [9.61077935e+01 3.77866048e-02]
mat_Sqrt:  [[ 1.86821796e+01  0.00000000e+00]
 [-7.77551077e-03  1.78159333e-02]]
grads:  [ 0.0249349  14.20971843]
Stock Position:  0.024934904494802526
Bond Position:  [-12.45681286]


portfolio before change:  [-10.10888367]
curr_Stock_Price:  94.2247999142457
curr_Factors:  [9.42247999e+01 3.91448953e-02]
mat_Sqrt:  [[ 1.86424416e+01  0.00000000e+00]
 [-7.91402758e-03  1.81333152e-02]]
grads:  [ 4.73832507e-03 -5.48963397e+00]
Stock Position:  0.00473832506620033
Bond Position:  [-10.5553514]


portfolio before change:  [-10.11550054]
curr_Stock_Price:  93.10681542711629
curr_Factors:  [9.31068154e+01 4.07131760e-02]
mat_Sqrt:  [[ 1.87866335e+01  0.00000000e+00]
 [-8.07100252e-03  1.84929900e-02]]
grads:  [ 9.57476939e-04 -2.41023396e+00]
Stock Position:  0.0009574769391220324
Bond Position:  [-10.20464817]


portfolio before change:  [-10.1168122]
curr_Stock_Price:  93.06921885687959
curr_Factors:  [9.30692189e+01 3.97612453e-02]
mat_Sqrt:  [[ 1.85582089e+01  0.00000000e+00]
 [-7.97608880e-03  1.82755153e-02]]
grads:  [0.02007085 3.51074802]
Stock Position:  0.020070846921227428
Bond Position:  [-11.98479025]


portfolio before change:  [-10.15698713]
curr_Stock_Price:  91.14220810552459
curr_Factors:  [9.11422081e+01 4.04016672e-02]
mat_Sqrt:  [[ 1.83197351e+01  0.00000000e+00]
 [-8.04006639e-03  1.84221064e-02]]
grads:  [ 0.04048223 28.57605651]
Stock Position:  0.040482234512019724
Bond Position:  [-13.84662737]


portfolio before change:  [-10.12810207]
curr_Stock_Price:  91.89849054786583
curr_Factors:  [9.18984905e+01 3.94148203e-02]
mat_Sqrt:  [[ 1.82447599e+01  0.00000000e+00]
 [-7.94126643e-03  1.81957273e-02]]
grads:  [-0.03579288 22.42545253]
Stock Position:  -0.03579288301648803
Bond Position:  [-6.83879014]


portfolio before change:  [-10.11600132]
curr_Stock_Price:  91.53652892390645
curr_Factors:  [9.15365289e+01 4.10178071e-02]
mat_Sqrt:  [[ 1.85387590e+01  0.00000000e+00]
 [-8.10114136e-03  1.85620468e-02]]
grads:  [-2.40158210e-03  1.73098849e+01]
Stock Position:  -0.0024015820994435985
Bond Position:  [-9.89616883]


portfolio before change:  [-10.116842]
curr_Stock_Price:  91.37146357691071
curr_Factors:  [9.13714636e+01 4.06994364e-02]
mat_Sqrt:  [[ 1.84333716e+01  0.00000000e+00]
 [-8.06964052e-03  1.84898693e-02]]
grads:  [ 0.10967413 16.91270098]
Stock Position:  0.10967412721764289
Bond Position:  [-20.13792752]


portfolio before change:  [-9.95292137]
curr_Stock_Price:  92.88903235339153
curr_Factors:  [9.28890324e+01 4.01533137e-02]
mat_Sqrt:  [[ 1.86133753e+01  0.00000000e+00]
 [-8.01531671e-03  1.83653978e-02]]
grads:  [1.04796505e-02 2.25183984e+01]
Stock Position:  0.010479650490279234
Bond Position:  [-10.92636596]


portfolio before change:  [-9.94705135]
curr_Stock_Price:  93.57950365048013
curr_Factors:  [9.35795037e+01 3.89836598e-02]
mat_Sqrt:  [[ 1.84765993e+01  0.00000000e+00]
 [-7.89771205e-03  1.80959316e-02]]
grads:  [-3.84449686e-03  1.02007071e+01]
Stock Position:  -0.0038444968589264705
Bond Position:  [-9.58728524]


portfolio before change:  [-9.95106733]
curr_Stock_Price:  94.31236766762088
curr_Factors:  [9.43123677e+01 3.98650089e-02]
mat_Sqrt:  [[ 1.88306183e+01  0.00000000e+00]
 [-7.98648948e-03  1.82993463e-02]]
grads:  [-0.00748868  6.28488781]
Stock Position:  -0.007488675923914315
Bond Position:  [-9.24479257]


portfolio before change:  [-9.95998909]
curr_Stock_Price:  95.34941280889053
curr_Factors:  [9.53494128e+01 3.89054691e-02]
mat_Sqrt:  [[ 1.88071657e+01  0.00000000e+00]
 [-7.88978774e-03  1.80777748e-02]]
grads:  [ 0.00880128 -4.33111833]
Stock Position:  0.008801279845975916
Bond Position:  [-10.79918596]


portfolio before change:  [-9.96771251]
curr_Stock_Price:  94.62526485485107
curr_Factors:  [9.46252649e+01 3.84691574e-02]
mat_Sqrt:  [[ 1.85593792e+01  0.00000000e+00]
 [-7.84542235e-03  1.79761209e-02]]
grads:  [-9.26606471e-03 -2.54587866e+01]
Stock Position:  -0.009266064708752358
Bond Position:  [-9.09090868]


portfolio before change:  [-9.95539323]
curr_Stock_Price:  93.17311544507653
curr_Factors:  [9.31731154e+01 3.84944130e-02]
mat_Sqrt:  [[ 1.82805588e+01  0.00000000e+00]
 [-7.84799725e-03  1.79820207e-02]]
grads:  [ 0.00523681 -1.21189683]
Stock Position:  0.005236807702300105
Bond Position:  [-10.44332292]


portfolio before change:  [-9.95755468]
curr_Stock_Price:  93.00966577671058
curr_Factors:  [9.30096658e+01 3.80192823e-02]
mat_Sqrt:  [[ 1.81355212e+01  0.00000000e+00]
 [-7.79941355e-03  1.78707015e-02]]
grads:  [  0.02620662 -17.35042613]
Stock Position:  0.026206619429771094
Bond Position:  [-12.3950236]


portfolio before change:  [-9.9533038]
curr_Stock_Price:  93.23099759483084
curr_Factors:  [9.32309976e+01 3.74131242e-02]
mat_Sqrt:  [[ 1.80331801e+01  0.00000000e+00]
 [-7.73698900e-03  1.77276689e-02]]
grads:  [ -0.03869615 -17.1886581 ]
Stock Position:  -0.03869615412075068
Bond Position:  [-6.34562275]


portfolio before change:  [-9.91156856]
curr_Stock_Price:  92.13196105863153
curr_Factors:  [9.21319611e+01 3.90366244e-02]
mat_Sqrt:  [[ 1.82031456e+01  0.00000000e+00]
 [-7.90307529e-03  1.81082204e-02]]
grads:  [0.02716271 8.82087222]
Stock Position:  0.02716270859638131
Bond Position:  [-12.41412217]


portfolio before change:  [-9.93770941]
curr_Stock_Price:  91.2267132117115
curr_Factors:  [9.12267132e+01 3.97045202e-02]
mat_Sqrt:  [[ 1.81778286e+01  0.00000000e+00]
 [-7.97039725e-03  1.82624744e-02]]
grads:  [-4.03050994e-03  1.71545711e+01]
Stock Position:  -0.004030509935699874
Bond Position:  [-9.57001923]


portfolio before change:  [-9.94080421]
curr_Stock_Price:  91.69773813806644
curr_Factors:  [9.16977381e+01 3.93561196e-02]
mat_Sqrt:  [[ 1.81913428e+01  0.00000000e+00]
 [-7.93535074e-03  1.81821727e-02]]
grads:  [ 0.04191074 12.91470444]
Stock Position:  0.04191073956646629
Bond Position:  [-13.78392423]


portfolio before change:  [-10.01409811]
curr_Stock_Price:  89.99004209273785
curr_Factors:  [8.99900421e+01 4.04021713e-02]
mat_Sqrt:  [[ 1.80882607e+01  0.00000000e+00]
 [-8.04011654e-03  1.84222213e-02]]
grads:  [ 6.08233244e-05 -8.01395436e+00]
Stock Position:  6.0823324428190825e-05
Bond Position:  [-10.0195716]


portfolio before change:  [-10.01532641]
curr_Stock_Price:  90.38824750648396
curr_Factors:  [9.03882475e+01 4.11108501e-02]
mat_Sqrt:  [[ 1.83269500e+01  0.00000000e+00]
 [-8.11032429e-03  1.85830875e-02]]
grads:  [ 6.33581820e-03 -2.27020824e+01]
Stock Position:  0.0063358181982534865
Bond Position:  [-10.58800992]


portfolio before change:  [-10.01575449]
curr_Stock_Price:  90.52958752101036
curr_Factors:  [9.05295875e+01 4.14505714e-02]
mat_Sqrt:  [[ 1.84312930e+01  0.00000000e+00]
 [-8.14376536e-03  1.86597106e-02]]
grads:  [0.00777108 1.06332412]
Stock Position:  0.00777108386569056
Bond Position:  [-10.71926751]


portfolio before change:  [-10.02147092]
curr_Stock_Price:  89.9664178695233
curr_Factors:  [8.99664179e+01 4.30060622e-02]
mat_Sqrt:  [[ 1.86571485e+01  0.00000000e+00]
 [-8.29516121e-03  1.90066021e-02]]
grads:  [9.38933513e-03 3.09884702e+01]
Stock Position:  0.009389335132172208
Bond Position:  [-10.86619577]


portfolio before change:  [-10.01256622]
curr_Stock_Price:  91.05947298390065
curr_Factors:  [9.10594730e+01 4.45358507e-02]
mat_Sqrt:  [[ 1.92167530e+01  0.00000000e+00]
 [-8.44140753e-03  1.93416945e-02]]
grads:  [-0.02319564 -7.37507959]
Stock Position:  -0.023195644591765225
Bond Position:  [-7.90038305]


portfolio before change:  [-9.98675631]
curr_Stock_Price:  89.90419065886326
curr_Factors:  [8.99041907e+01 4.53182286e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.98675631]
Stock Price:  88.45361747920508
PL:  [-9.98675631]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.46351862e+00  3.63303838e-01]
 [ 6.32765017e-01  1.13117539e-01]
 [-2.40504176e-02 -6.33631200e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.13516799e-01 -2.87219303e-01]
 [-3.54172167e-01  1.84318122e-01]
 [ 9.25683448e-02  6.25642552e-02]
 [ 7.42565565e-01  7.26244382e-01]
 [-2.29507861e-02  2.70954972e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-6.46110543e-02  1.36477080e-02]
 [ 2.60289750e-02 -1.33884572e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-6.61568789e-02  2.80229315e-02]
 [ 4.71932719e-01  3.01732032e-01]
 [ 1.29910515e-01 -6.84609772e-02]
 [ 3.96565409e-02  1.14233382e-01]
 [ 1.71830748e-02  6.10143313e-02]
 [-5.91423091e-02 -4.19633299e-02]
 [-1.89070200e-01  3.26724174e-02]
 [ 1.76689275e-01 -4.46819916e-02]
 [ 1.09126308e+00  9.73051052e-02]
 [ 1.72381727e-02  3.05713442e-01]
 [-1.14689006e-01  8.68324391e-02]
 [-1.46070921e-01  8.99817628e-02]
 [ 1.41951726e-01 -9.91920789e-02]
 [ 8.88540586e-03 -3.00554021e-01]
 [ 4.90223227e-02  1.42971958e-01]
 [ 2.88428347e-01 -5.97797782e-02]
 [-5.32261693e-01 -1.79773214e-01]
 [-1.64485129e-01 -5.85706441e-02]
 [ 9.36386475e-03 -6.08561061e-02]
 [-1.26880647e-01  1.55256209e-01]
 [ 1.33174581e-02  1.54610194e-02]
 [ 4.06731655e-02  9.39315104e-03]
 [-1.10220733e-01  1.17738716e-01]
 [-2.51016806e-02 -1.98414980e-01]
 [-7.54024230e-02 -5.27212612e-02]
 [ 8.89209091e-02 -1.23443997e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.27637368]
curr_Stock_Price:  98.69971403237552
curr_Factors:  [9.86997140e+01 4.20508941e-02]
mat_Sqrt:  [[ 2.02396739e+01  0.00000000e+00]
 [-8.20252587e-03  1.87943478e-02]]
grads:  [ 0.08014346 19.33048389]
Stock Position:  0.08014345579923761
Bond Position:  [-14.18650985]


portfolio before change:  [-6.2137961]
curr_Stock_Price:  99.50266177509212
curr_Factors:  [9.95026618e+01 4.09422202e-02]
mat_Sqrt:  [[ 2.01335517e+01  0.00000000e+00]
 [-8.09367360e-03  1.85449360e-02]]
grads:  [0.03388044 6.0996457 ]
Stock Position:  0.03388043848336041
Bond Position:  [-9.58498991]


portfolio before change:  [-6.16169963]
curr_Stock_Price:  101.07568351415036
curr_Factors:  [1.01075684e+02 4.17329345e-02]
mat_Sqrt:  [[ 2.06483878e+01  0.00000000e+00]
 [-8.17145613e-03  1.87231581e-02]]
grads:  [-2.50403813e-03 -3.38421113e+00]
Stock Position:  -0.00250403812545467
Bond Position:  [-5.90860226]


portfolio before change:  [-6.16588812]
curr_Stock_Price:  102.45340736749174
curr_Factors:  [1.02453407e+02 4.21440013e-02]
mat_Sqrt:  [[ 2.10326643e+01  0.00000000e+00]
 [-8.21160167e-03  1.88151431e-02]]
grads:  [-7.75050024e-04 -8.04600908e+00]
Stock Position:  -0.0007750500241729978
Bond Position:  [-6.08648161]


portfolio before change:  [-6.1660569]
curr_Stock_Price:  101.68948092242265
curr_Factors:  [1.01689481e+02 4.14039259e-02]
mat_Sqrt:  [[ 2.06917295e+01  0.00000000e+00]
 [-8.13918187e-03  1.86492085e-02]]
grads:  [-1.15442056e-02 -1.54011524e+01]
Stock Position:  -0.011544205600281313
Bond Position:  [-4.99213263]


portfolio before change:  [-6.16849138]
curr_Stock_Price:  101.84630654388836
curr_Factors:  [1.01846307e+02 4.10421506e-02]
mat_Sqrt:  [[ 2.06329031e+01  0.00000000e+00]
 [-8.10354496e-03  1.85675541e-02]]
grads:  [-0.01326663  9.92689297]
Stock Position:  -0.013266632521414946
Bond Position:  [-4.81733386]


portfolio before change:  [-6.1447626]
curr_Stock_Price:  100.01230790198724
curr_Factors:  [1.00012308e+02 4.18538420e-02]
mat_Sqrt:  [[ 2.04607295e+01  0.00000000e+00]
 [-8.18328462e-03  1.87502606e-02]]
grads:  [0.00585872 3.3367139 ]
Stock Position:  0.005858717022078951
Bond Position:  [-6.73070641]


portfolio before change:  [-6.1539787]
curr_Stock_Price:  98.58286441864284
curr_Factors:  [9.85828644e+01 4.26677578e-02]
mat_Sqrt:  [[ 2.03634493e+01  0.00000000e+00]
 [-8.26247012e-03  1.89316974e-02]]
grads:  [ 0.0520307  38.36129255]
Stock Position:  0.05203070379282669
Bond Position:  [-11.28331452]


portfolio before change:  [-6.15549443]
curr_Stock_Price:  98.58084189470371
curr_Factors:  [9.85808419e+01 4.34763677e-02]
mat_Sqrt:  [[ 2.05550790e+01  0.00000000e+00]
 [-8.34039497e-03  1.91102456e-02]]
grads:  [4.63650171e-03 1.41785186e+01]
Stock Position:  0.004636501712711573
Bond Position:  [-6.61256468]


portfolio before change:  [-6.15891697]
curr_Stock_Price:  98.02095499157294
curr_Factors:  [9.80209550e+01 4.29396497e-02]
mat_Sqrt:  [[ 2.03117891e+01  0.00000000e+00]
 [-8.28875380e-03  1.89919209e-02]]
grads:  [0.01213257 5.95392821]
Stock Position:  0.012132569209413403
Bond Position:  [-7.34816299]


portfolio before change:  [-6.16346495]
curr_Stock_Price:  97.7218098818369
curr_Factors:  [9.77218099e+01 4.44787625e-02]
mat_Sqrt:  [[ 2.06095187e+01  0.00000000e+00]
 [-8.43599549e-03  1.93292940e-02]]
grads:  [-0.002846    0.70606345]
Stock Position:  -0.0028460007786654273
Bond Position:  [-5.8853486]


portfolio before change:  [-6.16684192]
curr_Stock_Price:  98.64987051996746
curr_Factors:  [9.86498705e+01 4.30526758e-02]
mat_Sqrt:  [[ 2.04689985e+01  0.00000000e+00]
 [-8.29965549e-03  1.90168998e-02]]
grads:  [-1.58303020e-03 -7.04029438e+00]
Stock Position:  -0.0015830302033791115
Bond Position:  [-6.0106762]


portfolio before change:  [-6.16758596]
curr_Stock_Price:  98.64522904384069
curr_Factors:  [9.86452290e+01 4.23330912e-02]
mat_Sqrt:  [[ 2.02962627e+01  0.00000000e+00]
 [-8.23000279e-03  1.88573054e-02]]
grads:  [-0.00637304 -1.4875617 ]
Stock Position:  -0.0063730396969386574
Bond Position:  [-5.538916]


portfolio before change:  [-6.16950221]
curr_Stock_Price:  98.83726330860787
curr_Factors:  [9.88372633e+01 4.07301455e-02]
mat_Sqrt:  [[ 1.99470507e+01  0.00000000e+00]
 [-8.07268436e-03  1.84968436e-02]]
grads:  [-0.00270349  1.51501154]
Stock Position:  -0.002703490838679918
Bond Position:  [-5.90229657]


portfolio before change:  [-6.17211475]
curr_Stock_Price:  99.53070465832785
curr_Factors:  [9.95307047e+01 3.93834356e-02]
mat_Sqrt:  [[ 1.97521274e+01  0.00000000e+00]
 [-7.93810411e-03  1.81884815e-02]]
grads:  [ 0.03055971 16.58918215]
Stock Position:  0.03055971448421781
Bond Position:  [-9.21374467]


portfolio before change:  [-6.19390125]
curr_Stock_Price:  98.85547896290649
curr_Factors:  [9.88554790e+01 3.87641187e-02]
mat_Sqrt:  [[ 1.94632653e+01  0.00000000e+00]
 [-7.87544220e-03  1.80449050e-02]]
grads:  [ 0.00513951 -3.79392284]
Stock Position:  0.005139512509841349
Bond Position:  [-6.70197022]


portfolio before change:  [-6.19646637]
curr_Stock_Price:  98.51939263786858
curr_Factors:  [9.85193926e+01 4.01525840e-02]
mat_Sqrt:  [[ 1.97414240e+01  0.00000000e+00]
 [-8.01524388e-03  1.83652309e-02]]
grads:  [4.53422592e-03 6.22008964e+00]
Stock Position:  0.004534225919673613
Bond Position:  [-6.64317555]


portfolio before change:  [-6.19879684]
curr_Stock_Price:  98.1885697188554
curr_Factors:  [9.81885697e+01 4.06403789e-02]
mat_Sqrt:  [[ 1.97942845e+01  0.00000000e+00]
 [-8.06378361e-03  1.84764494e-02]]
grads:  [2.21336175e-03 3.30227578e+00]
Stock Position:  0.002213361747182467
Bond Position:  [-6.41612367]


portfolio before change:  [-6.19938207]
curr_Stock_Price:  98.28653777262268
curr_Factors:  [9.82865378e+01 4.23445517e-02]
mat_Sqrt:  [[ 2.02251992e+01  0.00000000e+00]
 [-8.23111674e-03  1.88598578e-02]]
grads:  [-0.00382971 -2.22500777]
Stock Position:  -0.003829708035572183
Bond Position:  [-5.82297332]


portfolio before change:  [-6.20057527]
curr_Stock_Price:  98.40802999601372
curr_Factors:  [9.84080300e+01 4.10288942e-02]
mat_Sqrt:  [[ 1.99331275e+01  0.00000000e+00]
 [-8.10223615e-03  1.85645552e-02]]
grads:  [-0.00876986  1.75993537]
Stock Position:  -0.008769862554067968
Bond Position:  [-5.33755037]


portfolio before change:  [-6.20630722]
curr_Stock_Price:  98.98554368491668
curr_Factors:  [9.89855437e+01 4.11324957e-02]
mat_Sqrt:  [[ 2.00754044e+01  0.00000000e+00]
 [-8.11245913e-03  1.85879790e-02]]
grads:  [ 0.0078299  -2.40381117]
Stock Position:  0.00782990229842726
Bond Position:  [-6.98135435]


portfolio before change:  [-6.21369301]
curr_Stock_Price:  98.1537236049974
curr_Factors:  [9.81537236e+01 4.15375813e-02]
mat_Sqrt:  [[ 2.00044853e+01  0.00000000e+00]
 [-8.15230826e-03  1.86792849e-02]]
grads:  [0.05667382 5.20925217]
Stock Position:  0.05667381531862488
Bond Position:  [-11.77643901]


portfolio before change:  [-6.26214156]
curr_Stock_Price:  97.32483284324883
curr_Factors:  [9.73248328e+01 4.33206625e-02]
mat_Sqrt:  [[ 2.02568173e+01  0.00000000e+00]
 [-8.32544654e-03  1.90759945e-02]]
grads:  [7.43761743e-03 1.60260815e+01]
Stock Position:  0.0074376174288380715
Bond Position:  [-6.98600643]


portfolio before change:  [-6.26027654]
curr_Stock_Price:  97.69300474148004
curr_Factors:  [9.76930047e+01 4.39916526e-02]
mat_Sqrt:  [[ 2.04903136e+01  0.00000000e+00]
 [-8.38967486e-03  1.92231600e-02]]
grads:  [-3.74773290e-03  4.51707414e+00]
Stock Position:  -0.003747732898477018
Bond Position:  [-5.89414926]


portfolio before change:  [-6.26348199]
curr_Stock_Price:  98.35170487818806
curr_Factors:  [9.83517049e+01 4.44696995e-02]
mat_Sqrt:  [[ 2.07402501e+01  0.00000000e+00]
 [-8.43513599e-03  1.93273246e-02]]
grads:  [-0.00514939  4.65567608]
Stock Position:  -0.005149391135443273
Bond Position:  [-5.75703059]


portfolio before change:  [-6.26960828]
curr_Stock_Price:  99.40165821468975
curr_Factors:  [9.94016582e+01 4.46931822e-02]
mat_Sqrt:  [[ 2.10142681e+01  0.00000000e+00]
 [-8.45630484e-03  1.93758285e-02]]
grads:  [ 4.69494124e-03 -5.11937226e+00]
Stock Position:  0.004694941236005947
Bond Position:  [-6.73629323]


portfolio before change:  [-6.27179157]
curr_Stock_Price:  99.11598955985482
curr_Factors:  [9.91159896e+01 4.46790870e-02]
mat_Sqrt:  [[ 2.09505711e+01  0.00000000e+00]
 [-8.45497127e-03  1.93727729e-02]]
grads:  [-5.83693505e-03 -1.55142489e+01]
Stock Position:  -0.005836935054434911
Bond Position:  [-5.69325798]


portfolio before change:  [-6.27448821]
curr_Stock_Price:  99.45605493280975
curr_Factors:  [9.94560549e+01 4.43525098e-02]
mat_Sqrt:  [[ 2.09454805e+01  0.00000000e+00]
 [-8.42401423e-03  1.93018414e-02]]
grads:  [5.31954377e-03 7.40716673e+00]
Stock Position:  0.005319543769783814
Bond Position:  [-6.80354905]


portfolio before change:  [-6.28755029]
curr_Stock_Price:  97.16044772216443
curr_Factors:  [9.71604477e+01 4.51678640e-02]
mat_Sqrt:  [[ 2.06492501e+01  0.00000000e+00]
 [-8.50109301e-03  1.94784511e-02]]
grads:  [ 0.0127045  -3.06902114]
Stock Position:  0.012704495882235258
Bond Position:  [-7.5219248]


portfolio before change:  [-6.28962128]
curr_Stock_Price:  97.07144844868692
curr_Factors:  [9.70714484e+01 4.64467356e-02]
mat_Sqrt:  [[ 2.09203578e+01  0.00000000e+00]
 [-8.62060189e-03  1.97522804e-02]]
grads:  [-0.02919267 -9.10139035]
Stock Position:  -0.02919267256876221
Bond Position:  [-3.45584627]


portfolio before change:  [-6.31682924]
curr_Stock_Price:  97.98866329685846
curr_Factors:  [9.79886633e+01 4.64165089e-02]
mat_Sqrt:  [[ 2.11111587e+01  0.00000000e+00]
 [-8.61779636e-03  1.97458521e-02]]
grads:  [-0.00900223 -2.9662252 ]
Stock Position:  -0.009002227532952156
Bond Position:  [-5.434713]


portfolio before change:  [-6.33030637]
curr_Stock_Price:  99.41028349675183
curr_Factors:  [9.94102835e+01 4.56259333e-02]
mat_Sqrt:  [[ 2.12342631e+01  0.00000000e+00]
 [-8.54409114e-03  1.95769722e-02]]
grads:  [-8.09819365e-04 -3.10855558e+00]
Stock Position:  -0.0008098193654418508
Bond Position:  [-6.249802]


portfolio before change:  [-6.33108801]
curr_Stock_Price:  99.41073271341885
curr_Factors:  [9.94107327e+01 4.53812239e-02]
mat_Sqrt:  [[ 2.11773384e+01  0.00000000e+00]
 [-8.52114771e-03  1.95244022e-02]]
grads:  [-2.79172390e-03  7.95190593e+00]
Stock Position:  -0.0027917238987597483
Bond Position:  [-6.05356069]


portfolio before change:  [-6.33177907]
curr_Stock_Price:  99.38720342403074
curr_Factors:  [9.93872034e+01 4.60785563e-02]
mat_Sqrt:  [[ 2.13343739e+01  0.00000000e+00]
 [-8.58636652e-03  1.96738373e-02]]
grads:  [0.00094051 0.785867  ]
Stock Position:  0.0009405103827269236
Bond Position:  [-6.42525376]


portfolio before change:  [-6.33358971]
curr_Stock_Price:  98.31604507180955
curr_Factors:  [9.83160451e+01 4.45898163e-02]
mat_Sqrt:  [[ 2.07607119e+01  0.00000000e+00]
 [-8.44652035e-03  1.93534094e-02]]
grads:  [0.00215661 0.48534864]
Stock Position:  0.0021566058512511588
Bond Position:  [-6.54561867]


portfolio before change:  [-6.3345739]
curr_Stock_Price:  98.23910080437948
curr_Factors:  [9.82391008e+01 4.46699226e-02]
mat_Sqrt:  [[ 2.07630896e+01  0.00000000e+00]
 [-8.45410411e-03  1.93707860e-02]]
grads:  [-2.83365073e-03  6.07815894e+00]
Stock Position:  -0.002833650727518148
Bond Position:  [-6.0561986]


portfolio before change:  [-6.34124072]
curr_Stock_Price:  100.32466113066285
curr_Factors:  [1.00324661e+02 4.46502972e-02]
mat_Sqrt:  [[ 2.11992198e+01  0.00000000e+00]
 [-8.45224677e-03  1.93665303e-02]]
grads:  [-5.26892395e-03 -1.02452518e+01]
Stock Position:  -0.005268923950661737
Bond Position:  [-5.81263771]


portfolio before change:  [-6.33274704]
curr_Stock_Price:  98.57471910382044
curr_Factors:  [9.85747191e+01 4.47449757e-02]
mat_Sqrt:  [[ 2.08515184e+01  0.00000000e+00]
 [-8.46120329e-03  1.93870523e-02]]
grads:  [-0.00471965 -2.71940574]
Stock Position:  -0.0047196499434266105
Bond Position:  [-5.86750887]


portfolio before change:  [-6.3347945]
curr_Stock_Price:  98.85312590583777
curr_Factors:  [9.88531259e+01 4.48708840e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.3347945]
Stock Price:  98.74996248945762
PL:  [-6.3347945]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.49642202e+00  3.67212252e-01]
 [ 1.24098965e+00  5.52030820e-02]
 [-1.89021373e-02  7.80871295e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.12017943e-01  8.93900842e-01]
 [ 2.74600304e-02 -2.66277616e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.23685642e+00  1.27357211e+00]
 [ 9.33428500e-02  5.81867636e-01]
 [ 6.06481198e-03 -2.26022114e-01]
 [ 7.97504446e-02  1.55476980e-02]
 [ 4.70336899e-02 -6.90414776e-02]
 [-6.58246907e-03  4.01864785e-01]
 [-1.60522438e-01  5.61996402e-01]
 [-3.73145896e-02  7.95712601e-02]
 [ 1.30494782e-01 -1.30243225e-01]
 [ 3.68353666e-02 -7.28796709e-02]
 [ 3.34580041e-01  6.44995855e-02]
 [ 3.59540509e-01  3.71440560e-01]
 [-6.90381597e-01  3.26396756e-01]
 [-1.26370815e-02  1.83727792e-01]
 [ 1.67927292e+00  2.05113551e-01]
 [ 1.53583230e-02  4.44770273e-01]
 [-1.49474795e-01  1.76248007e-01]
 [-1.89136335e-01  1.11853280e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 9.24664402e-02 -4.52868493e-01]
 [ 7.43351667e-02  4.40017283e-02]
 [ 4.66325701e-01 -2.68269959e-01]
 [-5.15790550e-01 -2.92972012e-01]
 [ 2.59308739e-01  9.87711720e-02]
 [-1.45518047e-01  2.02937434e-01]
 [ 3.43711374e-01  2.16554075e-01]
 [ 2.74342718e-02 -1.26523944e-02]
 [ 1.74153609e-01 -1.13710074e-01]
 [ 3.98370324e-02  1.13378756e-01]
 [-4.83430342e-02  4.77294322e-02]
 [-3.10057052e-01 -1.14805579e-01]
 [ 1.46411886e-01  1.23446570e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.00082319]
curr_Stock_Price:  99.1751764497393
curr_Factors:  [9.91751764e+01 4.00479352e-02]
mat_Sqrt:  [[ 1.98469167e+01  0.00000000e+00]
 [-8.00479209e-03  1.83412828e-02]]
grads:  [ 0.08347325 20.02107787]
Stock Position:  0.08347324734355176
Bond Position:  [-11.27929722]


portfolio before change:  [-3.11162185]
curr_Stock_Price:  97.86471273391999
curr_Factors:  [9.78647127e+01 4.06349540e-02]
mat_Sqrt:  [[ 1.97276799e+01  0.00000000e+00]
 [-8.06324540e-03  1.84752162e-02]]
grads:  [0.06412727 2.98795324]
Stock Position:  0.0641272699289879
Bond Position:  [-9.3874187]


portfolio before change:  [-3.12477967]
curr_Stock_Price:  97.6778293612408
curr_Factors:  [9.76778294e+01 4.00638805e-02]
mat_Sqrt:  [[ 1.95511589e+01  0.00000000e+00]
 [-8.00638551e-03  1.83449338e-02]]
grads:  [7.76316127e-04 4.25660459e+00]
Stock Position:  0.0007763161274976156
Bond Position:  [-3.20060855]


portfolio before change:  [-3.12571006]
curr_Stock_Price:  96.99474357499007
curr_Factors:  [9.69947436e+01 4.10288878e-02]
mat_Sqrt:  [[ 1.96468564e+01  0.00000000e+00]
 [-8.10223552e-03  1.85645538e-02]]
grads:  [-8.29718842e-04 -8.15461628e+00]
Stock Position:  -0.0008297188421393597
Bond Position:  [-3.0452317]


portfolio before change:  [-3.12640438]
curr_Stock_Price:  97.37275075848844
curr_Factors:  [9.73727508e+01 4.05481223e-02]
mat_Sqrt:  [[ 1.96075266e+01  0.00000000e+00]
 [-8.05462573e-03  1.84554661e-02]]
grads:  [1.41839598e-02 4.84355605e+01]
Stock Position:  0.014183959760706771
Bond Position:  [-4.50753556]


portfolio before change:  [-3.13633985]
curr_Stock_Price:  96.71200466440109
curr_Factors:  [9.67120047e+01 3.93134516e-02]
mat_Sqrt:  [[ 1.91756888e+01  0.00000000e+00]
 [-7.93104801e-03  1.81723139e-02]]
grads:  [ 8.25979325e-04 -1.46529284e+00]
Stock Position:  0.0008259793247507417
Bond Position:  [-3.21622197]


portfolio before change:  [-3.13680673]
curr_Stock_Price:  96.63351914053922
curr_Factors:  [9.66335191e+01 3.80517712e-02]
mat_Sqrt:  [[ 1.88501684e+01  0.00000000e+00]
 [-7.80274528e-03  1.78783354e-02]]
grads:  [0.00686327 5.377284  ]
Stock Position:  0.006863269046501224
Bond Position:  [-3.80002858]


portfolio before change:  [-3.14806555]
curr_Stock_Price:  95.06228812139048
curr_Factors:  [9.50622881e+01 3.81891519e-02]
mat_Sqrt:  [[ 1.85771150e+01  0.00000000e+00]
 [-7.81681796e-03  1.79105800e-02]]
grads:  [ 0.09649985 71.10725117]
Stock Position:  0.09649985239883714
Bond Position:  [-12.32156232]


portfolio before change:  [-3.13328239]
curr_Stock_Price:  95.23144333811844
curr_Factors:  [9.52314433e+01 3.72677802e-02]
mat_Sqrt:  [[ 1.83843013e+01  0.00000000e+00]
 [-7.72194589e-03  1.76932008e-02]]
grads:  [1.88906122e-02 3.28865107e+01]
Stock Position:  0.01889061215869883
Bond Position:  [-4.93226265]


portfolio before change:  [-3.15294206]
curr_Stock_Price:  94.2233708976161
curr_Factors:  [9.42233709e+01 3.76488742e-02]
mat_Sqrt:  [[ 1.82824601e+01  0.00000000e+00]
 [-7.76132712e-03  1.77834345e-02]]
grads:  [-5.06383304e-03 -1.27096998e+01]
Stock Position:  -0.005063833043893471
Bond Position:  [-2.67581065]


portfolio before change:  [-3.15096901]
curr_Stock_Price:  93.76767795374525
curr_Factors:  [9.37676780e+01 3.79736416e-02]
mat_Sqrt:  [[ 1.82723449e+01  0.00000000e+00]
 [-7.79473069e-03  1.78599717e-02]]
grads:  [0.0047359  0.87053318]
Stock Position:  0.004735900978460237
Bond Position:  [-3.59504345]


portfolio before change:  [-3.15445762]
curr_Stock_Price:  93.1259403060672
curr_Factors:  [9.31259403e+01 3.54966223e-02]
mat_Sqrt:  [[ 1.75454368e+01  0.00000000e+00]
 [-7.53621892e-03  1.72676468e-02]]
grads:  [ 9.63299969e-04 -3.99831420e+00]
Stock Position:  0.000963299968919049
Bond Position:  [-3.24416584]


portfolio before change:  [-3.15533076]
curr_Stock_Price:  92.64053241170483
curr_Factors:  [9.26405324e+01 3.52999121e-02]
mat_Sqrt:  [[ 1.74055541e+01  0.00000000e+00]
 [-7.51530833e-03  1.72197347e-02]]
grads:  [9.69838138e-03 2.33374552e+01]
Stock Position:  0.0096983813805871
Bond Position:  [-4.05379398]


portfolio before change:  [-3.16025493]
curr_Stock_Price:  92.18505348719229
curr_Factors:  [9.21850535e+01 3.58645347e-02]
mat_Sqrt:  [[ 1.74579446e+01  0.00000000e+00]
 [-7.57517363e-03  1.73569033e-02]]
grads:  [4.85468951e-03 3.23788405e+01]
Stock Position:  0.00485468950853784
Bond Position:  [-3.60778474]


portfolio before change:  [-3.1616796]
curr_Stock_Price:  91.98449077813277
curr_Factors:  [9.19844908e+01 3.75994482e-02]
mat_Sqrt:  [[ 1.78363237e+01  0.00000000e+00]
 [-7.75623086e-03  1.77717575e-02]]
grads:  [-1.45032387e-04  4.47739961e+00]
Stock Position:  -0.00014503238652462127
Bond Position:  [-3.14833887]


portfolio before change:  [-3.1621824]
curr_Stock_Price:  92.73770059883732
curr_Factors:  [9.27377006e+01 3.86941136e-02]
mat_Sqrt:  [[ 1.82422656e+01  0.00000000e+00]
 [-7.86832776e-03  1.80286038e-02]]
grads:  [ 4.03743593e-03 -7.22425465e+00]
Stock Position:  0.004037435933425495
Bond Position:  [-3.53660493]


portfolio before change:  [-3.16333028]
curr_Stock_Price:  92.56289250207105
curr_Factors:  [9.25628925e+01 3.75437010e-02]
mat_Sqrt:  [[ 1.79351684e+01  0.00000000e+00]
 [-7.75047879e-03  1.77585779e-02]]
grads:  [ 2.80346994e-04 -4.10391369e+00]
Stock Position:  0.00028034699389103973
Bond Position:  [-3.18928001]


portfolio before change:  [-3.16352808]
curr_Stock_Price:  93.27947984678003
curr_Factors:  [9.32794798e+01 3.77812756e-02]
mat_Sqrt:  [[ 1.81311113e+01  0.00000000e+00]
 [-7.77496244e-03  1.78146770e-02]]
grads:  [0.02000594 3.62058687]
Stock Position:  0.020005942350799968
Bond Position:  [-5.02967197]


portfolio before change:  [-3.17424193]
curr_Stock_Price:  92.77537449799107
curr_Factors:  [9.27753745e+01 3.72527018e-02]
mat_Sqrt:  [[ 1.79065370e+01  0.00000000e+00]
 [-7.72038359e-03  1.76896211e-02]]
grads:  [ 0.02913185 20.99765495]
Stock Position:  0.029131845028978885
Bond Position:  [-5.87695976]


portfolio before change:  [-3.1584308]
curr_Stock_Price:  93.34333696708791
curr_Factors:  [9.33433370e+01 3.65774416e-02]
mat_Sqrt:  [[ 1.78521277e+01  0.00000000e+00]
 [-7.65009193e-03  1.75285627e-02]]
grads:  [-0.03069272 18.62085113]
Stock Position:  -0.030692720931044363
Bond Position:  [-0.29346981]


portfolio before change:  [-3.16313863]
curr_Stock_Price:  93.49552772905275
curr_Factors:  [9.34955277e+01 3.68163320e-02]
mat_Sqrt:  [[ 1.79395315e+01  0.00000000e+00]
 [-7.67503298e-03  1.75857098e-02]]
grads:  [3.76533248e-03 1.04475619e+01]
Stock Position:  0.0037653324846438755
Bond Position:  [-3.51518038]


portfolio before change:  [-3.16193709]
curr_Stock_Price:  93.93133632875798
curr_Factors:  [9.39313363e+01 3.69514308e-02]
mat_Sqrt:  [[ 1.80561906e+01  0.00000000e+00]
 [-7.68910198e-03  1.76179459e-02]]
grads:  [ 0.09796041 11.64230789]
Stock Position:  0.09796040879795312
Bond Position:  [-12.3634892]


portfolio before change:  [-3.14688696]
curr_Stock_Price:  94.10074831446548
curr_Factors:  [9.41007483e+01 3.72813562e-02]
mat_Sqrt:  [[ 1.81693307e+01  0.00000000e+00]
 [-7.72335225e-03  1.76964231e-02]]
grads:  [1.15288773e-02 2.51333430e+01]
Stock Position:  0.011528877334814064
Bond Position:  [-4.23176294]


portfolio before change:  [-3.14941084]
curr_Stock_Price:  93.92771508641808
curr_Factors:  [9.39277151e+01 3.79711001e-02]
mat_Sqrt:  [[ 1.83029186e+01  0.00000000e+00]
 [-7.79446985e-03  1.78593740e-02]]
grads:  [-3.96405950e-03  9.86865535e+00]
Stock Position:  -0.0039640594963490285
Bond Position:  [-2.77707579]


portfolio before change:  [-3.15064819]
curr_Stock_Price:  94.15228035589435
curr_Factors:  [9.41522804e+01 3.93641703e-02]
mat_Sqrt:  [[ 1.86801945e+01  0.00000000e+00]
 [-7.93616233e-03  1.81840323e-02]]
grads:  [-0.00751168  6.15118135]
Stock Position:  -0.007511675590088259
Bond Position:  [-2.4434068]


portfolio before change:  [-3.14842762]
curr_Stock_Price:  93.81600155303545
curr_Factors:  [9.38160016e+01 4.04407648e-02]
mat_Sqrt:  [[ 1.88662941e+01  0.00000000e+00]
 [-8.04395573e-03  1.84310180e-02]]
grads:  [ 0.00972521 -3.96047235]
Stock Position:  0.009725206337295742
Bond Position:  [-4.06080759]


portfolio before change:  [-3.14682879]
curr_Stock_Price:  94.03259958551965
curr_Factors:  [9.40325996e+01 4.09061839e-02]
mat_Sqrt:  [[ 1.90183540e+01  0.00000000e+00]
 [-8.09011089e-03  1.85367728e-02]]
grads:  [-5.53052984e-03 -2.44308165e+01]
Stock Position:  -0.005530529843675714
Bond Position:  [-2.62677869]


portfolio before change:  [-3.15407414]
curr_Stock_Price:  95.28329012449561
curr_Factors:  [9.52832901e+01 4.02047852e-02]
mat_Sqrt:  [[ 1.91053773e+01  0.00000000e+00]
 [-8.02045238e-03  1.83771651e-02]]
grads:  [0.00489596 2.39436976]
Stock Position:  0.0048959564667409
Bond Position:  [-3.62057698]


portfolio before change:  [-3.15579589]
curr_Stock_Price:  95.02406520279251
curr_Factors:  [9.50240652e+01 4.12836428e-02]
mat_Sqrt:  [[ 1.93073474e+01  0.00000000e+00]
 [-8.12735065e-03  1.86220998e-02]]
grads:  [  0.01808861 -14.40599943]
Stock Position:  0.018088610736365945
Bond Position:  [-4.87464922]


portfolio before change:  [-3.17632166]
curr_Stock_Price:  93.92301854288175
curr_Factors:  [9.39230185e+01 4.21901615e-02]
mat_Sqrt:  [[ 1.92920170e+01  0.00000000e+00]
 [-8.21609751e-03  1.88254444e-02]]
grads:  [ -0.03336375 -15.56255494]
Stock Position:  -0.03336374938185921
Bond Position:  [-0.04269761]


portfolio before change:  [-3.16476028]
curr_Stock_Price:  93.57633314197764
curr_Factors:  [9.35763331e+01 4.30891069e-02]
mat_Sqrt:  [[ 1.94244965e+01  0.00000000e+00]
 [-8.30316633e-03  1.90249441e-02]]
grads:  [0.0155688  5.19166687]
Stock Position:  0.015568795483858379
Bond Position:  [-4.62163107]


portfolio before change:  [-3.16975437]
curr_Stock_Price:  93.29266614608255
curr_Factors:  [9.32926661e+01 4.44979497e-02]
mat_Sqrt:  [[ 1.96796561e+01  0.00000000e+00]
 [-8.43781486e-03  1.93334626e-02]]
grads:  [-2.89379494e-03  1.04966936e+01]
Stock Position:  -0.002893794943472853
Bond Position:  [-2.89978453]


portfolio before change:  [-3.17439983]
curr_Stock_Price:  94.77271536724312
curr_Factors:  [9.47727154e+01 4.50474869e-02]
mat_Sqrt:  [[ 2.01149338e+01  0.00000000e+00]
 [-8.48975730e-03  1.94524777e-02]]
grads:  [ 0.02178597 11.13246743]
Stock Position:  0.02178596879297024
Bond Position:  [-5.23911524]


portfolio before change:  [-3.15299702]
curr_Stock_Price:  95.78518961839667
curr_Factors:  [9.57851896e+01 4.45400812e-02]
mat_Sqrt:  [[ 2.02150056e+01  0.00000000e+00]
 [-8.44180845e-03  1.93426131e-02]]
grads:  [ 0.00108396 -0.65412022]
Stock Position:  0.0010839628066979426
Bond Position:  [-3.25682461]


portfolio before change:  [-3.15313085]
curr_Stock_Price:  96.03732048124712
curr_Factors:  [9.60373205e+01 4.31878965e-02]
mat_Sqrt:  [[ 1.99581857e+01  0.00000000e+00]
 [-8.31267913e-03  1.90467407e-02]]
grads:  [ 0.00623937 -5.97005419]
Stock Position:  0.006239367919742623
Bond Position:  [-3.75234303]


portfolio before change:  [-3.15438785]
curr_Stock_Price:  95.91103717723188
curr_Factors:  [9.59110372e+01 4.36363586e-02]
mat_Sqrt:  [[ 2.00351611e+01  0.00000000e+00]
 [-8.35572700e-03  1.91453757e-02]]
grads:  [4.45814125e-03 5.92199167e+00]
Stock Position:  0.004458141250210471
Bond Position:  [-3.5819728]


portfolio before change:  [-3.1540654]
curr_Stock_Price:  96.08380481118414
curr_Factors:  [9.60838048e+01 4.40169082e-02]
mat_Sqrt:  [[ 2.01585810e+01  0.00000000e+00]
 [-8.39208276e-03  1.92286772e-02]]
grads:  [-1.36478863e-03  2.48220049e+00]
Stock Position:  -0.0013647886295525295
Bond Position:  [-3.02293132]


portfolio before change:  [-3.15324212]
curr_Stock_Price:  95.20369113099444
curr_Factors:  [9.52036911e+01 4.24064526e-02]
mat_Sqrt:  [[ 1.96051315e+01  0.00000000e+00]
 [-8.23713082e-03  1.88736377e-02]]
grads:  [-0.01837082 -6.08285379]
Stock Position:  -0.01837081861722491
Bond Position:  [-1.40427238]


portfolio before change:  [-3.14165587]
curr_Stock_Price:  94.56344735042236
curr_Factors:  [9.45634474e+01 4.27165246e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.14165587]
Stock Price:  95.56210271907686
PL:  [-3.14165587]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.00295623e+00  2.55649524e-01]
 [-2.71141577e-01 -9.59745430e-02]
 [-2.02750881e-01 -1.09668912e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.01568605e-01 -1.12159791e-01]
 [-3.64129953e-01  1.96734536e-01]
 [ 1.72759193e-01 -1.76334596e-01]
 [ 7.05946775e-02  4.09011633e-01]
 [-1.00357122e-01 -1.79165221e-02]
 [ 1.92808132e-01  9.45810181e-02]
 [-2.64097381e-02  2.03229595e-02]
 [ 5.92057764e-02 -9.37566747e-02]
 [-9.87159415e-02  5.28701876e-02]
 [-1.28786318e-01  2.79499179e-01]
 [ 2.52433605e-01  2.07689079e-01]
 [ 1.32944249e-01 -6.53428944e-02]
 [ 4.03267472e-02  1.27355462e-01]
 [ 1.78285773e-01  7.65993336e-02]
 [ 6.99729049e-02  7.70245627e-02]
 [-3.16511835e-01  1.13086583e-01]
 [ 1.25153480e-01  3.94365944e-02]
 [ 1.47670691e+00  1.67885799e-01]
 [ 1.52860078e-02  4.41908749e-01]
 [-1.39673684e-01  1.37687973e-01]
 [-1.67561955e-01  1.74328806e-01]
 [ 1.30693175e-01 -1.02979585e-01]
 [-1.06504790e-01 -4.51083510e-01]
 [ 6.08542957e-02  7.26989571e-02]
 [ 2.78617966e-01 -4.62892233e-02]
 [-5.31865903e-01 -1.76261199e-01]
 [-1.63894086e-01 -5.74434509e-02]
 [-1.36818868e-03 -4.49880157e-02]
 [ 4.36251631e-02  1.82498102e-01]
 [ 1.25812878e-02  1.16336816e-05]
 [ 8.57097491e-02 -5.20060722e-02]
 [-4.01459977e-02  1.19541505e-01]
 [-4.74228424e-02  3.16357334e-02]
 [-2.77995469e-01 -1.05867345e-01]
 [ 1.13232907e-01 -1.15184361e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.97452649]
curr_Stock_Price:  101.78438770605295
curr_Factors:  [1.01784388e+02 3.77902313e-02]
mat_Sqrt:  [[ 1.97865895e+01  0.00000000e+00]
 [-7.77588388e-03  1.78167882e-02]]
grads:  [ 0.05632759 14.34879961]
Stock Position:  0.05632758643577477
Bond Position:  [9.24125759]


portfolio before change:  [15.00794371]
curr_Stock_Price:  102.35714427074167
curr_Factors:  [1.02357144e+02 3.77632702e-02]
mat_Sqrt:  [[ 1.98908324e+01  0.00000000e+00]
 [-7.77310957e-03  1.78104315e-02]]
grads:  [-0.01573732 -5.38867029]
Stock Position:  -0.015737315305054615
Bond Position:  [16.61877037]


portfolio before change:  [15.02045646]
curr_Stock_Price:  101.69405366565324
curr_Factors:  [1.01694054e+02 3.83585195e-02]
mat_Sqrt:  [[ 1.99171171e+01  0.00000000e+00]
 [-7.83413245e-03  1.79502525e-02]]
grads:  [-0.01258286 -6.10960277]
Stock Position:  -0.012582861072298838
Bond Position:  [16.3000586]


portfolio before change:  [15.0296925]
curr_Stock_Price:  101.1219733302331
curr_Factors:  [1.01121973e+02 4.00241791e-02]
mat_Sqrt:  [[ 2.02305063e+01  0.00000000e+00]
 [-8.00241755e-03  1.83358421e-02]]
grads:  [-8.05781461e-04 -8.25633269e+00]
Stock Position:  -0.0008057814608661468
Bond Position:  [15.11117471]


portfolio before change:  [15.03166593]
curr_Stock_Price:  101.01720245612852
curr_Factors:  [1.01017202e+02 4.02613564e-02]
mat_Sqrt:  [[ 2.02693368e+01  0.00000000e+00]
 [-8.02609309e-03  1.83900896e-02]]
grads:  [-0.00742595 -6.09892578]
Stock Position:  -0.007425953437311165
Bond Position:  [15.78181498]


portfolio before change:  [15.02577718]
curr_Stock_Price:  102.07586821350134
curr_Factors:  [1.02075868e+02 4.06907952e-02]
mat_Sqrt:  [[ 2.05907029e+01  0.00000000e+00]
 [-8.06878382e-03  1.84879063e-02]]
grads:  [-0.01351425 10.64125554]
Stock Position:  -0.013514252716800894
Bond Position:  [16.40525626]


portfolio before change:  [15.03506342]
curr_Stock_Price:  101.54047367557135
curr_Factors:  [1.01540474e+02 4.17504504e-02]
mat_Sqrt:  [[ 2.07476908e+01  0.00000000e+00]
 [-8.17317079e-03  1.87270869e-02]]
grads:  [ 4.61740377e-03 -9.41601845e+00]
Stock Position:  0.0046174037742336745
Bond Position:  [14.56621006]


portfolio before change:  [15.03435787]
curr_Stock_Price:  100.99331706968445
curr_Factors:  [1.00993317e+02 4.21979636e-02]
mat_Sqrt:  [[ 2.07461915e+01  0.00000000e+00]
 [-8.21685717e-03  1.88271850e-02]]
grads:  [1.20071189e-02 2.17245240e+01]
Stock Position:  0.012007118910258758
Bond Position:  [13.8217191]


portfolio before change:  [15.03166396]
curr_Stock_Price:  100.62505791248505
curr_Factors:  [1.00625058e+02 4.20231582e-02]
mat_Sqrt:  [[ 2.06276849e+01  0.00000000e+00]
 [-8.19982031e-03  1.87881486e-02]]
grads:  [-0.00524424 -0.95360764]
Stock Position:  -0.0052442401686902335
Bond Position:  [15.55936593]


portfolio before change:  [15.04457018]
curr_Stock_Price:  98.53492161673745
curr_Factors:  [9.85349216e+01 4.30998801e-02]
mat_Sqrt:  [[ 2.04563529e+01  0.00000000e+00]
 [-8.30420424e-03  1.90273223e-02]]
grads:  [0.01144323 4.97080024]
Stock Position:  0.011443226157384152
Bond Position:  [13.91701279]


portfolio before change:  [15.01908627]
curr_Stock_Price:  96.15590324199441
curr_Factors:  [9.61559032e+01 4.46296030e-02]
mat_Sqrt:  [[ 2.03136265e+01  0.00000000e+00]
 [-8.45028785e-03  1.93620419e-02]]
grads:  [-8.63463321e-04  1.04962894e+00]
Stock Position:  -0.0008634633211660539
Bond Position:  [15.10211337]


portfolio before change:  [15.02179583]
curr_Stock_Price:  95.20429977353622
curr_Factors:  [9.52042998e+01 4.49481697e-02]
mat_Sqrt:  [[ 2.01842478e+01  0.00000000e+00]
 [-8.48039336e-03  1.94310222e-02]]
grads:  [ 9.06003983e-04 -4.82510253e+00]
Stock Position:  0.000906003982992604
Bond Position:  [14.93554035]


portfolio before change:  [15.02387463]
curr_Stock_Price:  95.43801253390494
curr_Factors:  [9.54380125e+01 4.43511522e-02]
mat_Sqrt:  [[ 2.00989718e+01  0.00000000e+00]
 [-8.42388530e-03  1.93015460e-02]]
grads:  [-0.00376345  2.73916854]
Stock Position:  -0.003763451225676963
Bond Position:  [15.38305094]


portfolio before change:  [15.02326663]
curr_Stock_Price:  96.1105334947703
curr_Factors:  [9.61105335e+01 4.32395376e-02]
mat_Sqrt:  [[ 1.99853385e+01  0.00000000e+00]
 [-8.31764751e-03  1.90581247e-02]]
grads:  [-3.40393332e-04  1.46656182e+01]
Stock Position:  -0.0003403933318128273
Bond Position:  [15.05598202]


portfolio before change:  [15.02551642]
curr_Stock_Price:  95.03038751283364
curr_Factors:  [9.50303875e+01 4.45164491e-02]
mat_Sqrt:  [[ 2.00503869e+01  0.00000000e+00]
 [-8.43956862e-03  1.93374810e-02]]
grads:  [ 0.01711072 10.74023439]
Stock Position:  0.017110719668758288
Bond Position:  [13.3994781]


portfolio before change:  [15.03718806]
curr_Stock_Price:  95.61461739874983
curr_Factors:  [9.56146174e+01 4.29813211e-02]
mat_Sqrt:  [[ 1.98227622e+01  0.00000000e+00]
 [-8.29277479e-03  1.90011341e-02]]
grads:  [ 0.005268   -3.43889444]
Stock Position:  0.005267998018276755
Bond Position:  [14.53349044]


portfolio before change:  [15.0471145]
curr_Stock_Price:  97.15403303598019
curr_Factors:  [9.71540330e+01 4.31266755e-02]
mat_Sqrt:  [[ 2.01759421e+01  0.00000000e+00]
 [-8.30678522e-03  1.90332360e-02]]
grads:  [4.75364307e-03 6.69121434e+00]
Stock Position:  0.004753643073056844
Bond Position:  [14.5852789]


portfolio before change:  [15.04300667]
curr_Stock_Price:  95.90633722244954
curr_Factors:  [9.59063372e+01 4.34100113e-02]
mat_Sqrt:  [[ 1.99821518e+01  0.00000000e+00]
 [-8.33402772e-03  1.90956564e-02]]
grads:  [0.01059528 4.01134854]
Stock Position:  0.0105952784658267
Bond Position:  [14.02685232]


portfolio before change:  [15.04409168]
curr_Stock_Price:  95.84324730415426
curr_Factors:  [9.58432473e+01 4.25546178e-02]
mat_Sqrt:  [[ 1.97712837e+01  0.00000000e+00]
 [-8.25150825e-03  1.89065806e-02]]
grads:  [0.00523938 4.07395522]
Stock Position:  0.005239375542559743
Bond Position:  [14.54193291]


portfolio before change:  [15.05327762]
curr_Stock_Price:  97.2495386917216
curr_Factors:  [9.72495387e+01 4.06309506e-02]
mat_Sqrt:  [[ 1.96027067e+01  0.00000000e+00]
 [-8.06284819e-03  1.84743061e-02]]
grads:  [-0.01362857  6.1212899 ]
Stock Position:  -0.013628567153409453
Bond Position:  [16.37864949]


portfolio before change:  [15.06572969]
curr_Stock_Price:  96.48609743668955
curr_Factors:  [9.64860974e+01 4.18496363e-02]
mat_Sqrt:  [[ 1.97383382e+01  0.00000000e+00]
 [-8.18287346e-03  1.87493185e-02]]
grads:  [0.00721261 2.10336148]
Stock Position:  0.007212614338068223
Bond Position:  [14.36981268]


portfolio before change:  [15.05958683]
curr_Stock_Price:  95.38535907823054
curr_Factors:  [9.53853591e+01 4.27919708e-02]
mat_Sqrt:  [[ 1.97316255e+01  0.00000000e+00]
 [-8.27448810e-03  1.89592340e-02]]
grads:  [0.078553   8.85509399]
Stock Position:  0.0785529951442482
Bond Position:  [7.56678118]


portfolio before change:  [14.95078854]
curr_Stock_Price:  93.98828691498862
curr_Factors:  [9.39882869e+01 4.37252712e-02]
mat_Sqrt:  [[ 1.96535039e+01  0.00000000e+00]
 [-8.36423541e-03  1.91648709e-02]]
grads:  [1.05910273e-02 2.30582690e+01]
Stock Position:  0.010591027340885855
Bond Position:  [13.95535602]


portfolio before change:  [14.96899802]
curr_Stock_Price:  95.5429003296427
curr_Factors:  [9.55429003e+01 4.25006938e-02]
mat_Sqrt:  [[ 1.96968343e+01  0.00000000e+00]
 [-8.24627856e-03  1.88945979e-02]]
grads:  [-4.04033079e-03  7.28716081e+00]
Stock Position:  -0.004040330789658608
Bond Position:  [15.35502294]


portfolio before change:  [14.96735603]
curr_Stock_Price:  96.4243835329184
curr_Factors:  [9.64243835e+01 4.01082015e-02]
mat_Sqrt:  [[ 1.93109422e+01  0.00000000e+00]
 [-8.01081284e-03  1.83550781e-02]]
grads:  [-4.73713945e-03  9.49757908e+00]
Stock Position:  -0.004737139447938396
Bond Position:  [15.42413178]


portfolio before change:  [14.96426]
curr_Stock_Price:  97.48497379395492
curr_Factors:  [9.74849738e+01 3.95683018e-02]
mat_Sqrt:  [[ 1.93914991e+01  0.00000000e+00]
 [-7.95671307e-03  1.82311200e-02]]
grads:  [ 4.42199948e-03 -5.64856057e+00]
Stock Position:  0.004421999481343454
Bond Position:  [14.5331815]


portfolio before change:  [14.96014949]
curr_Stock_Price:  96.1445665724825
curr_Factors:  [9.61445666e+01 4.00672382e-02]
mat_Sqrt:  [[ 1.92450680e+01  0.00000000e+00]
 [-8.00672100e-03  1.83457025e-02]]
grads:  [-1.57637153e-02 -2.45879660e+01]
Stock Position:  -0.01576371533616737
Bond Position:  [16.47574506]


portfolio before change:  [14.94470203]
curr_Stock_Price:  97.25515827873842
curr_Factors:  [9.72551583e+01 3.91432139e-02]
mat_Sqrt:  [[ 1.92415869e+01  0.00000000e+00]
 [-7.91385761e-03  1.81329258e-02]]
grads:  [0.00481159 4.00922377]
Stock Position:  0.004811594930922893
Bond Position:  [14.4767496]


portfolio before change:  [14.9467582]
curr_Stock_Price:  97.30638109364946
curr_Factors:  [9.73063811e+01 3.74832903e-02]
mat_Sqrt:  [[ 1.88391010e+01  0.00000000e+00]
 [-7.74424073e-03  1.77442847e-02]]
grads:  [ 0.01371699 -2.60868354]
Stock Position:  0.013716986452968026
Bond Position:  [13.61200789]


portfolio before change:  [14.94659533]
curr_Stock_Price:  97.17045621324623
curr_Factors:  [9.71704562e+01 3.75772597e-02]
mat_Sqrt:  [[ 1.88363519e+01  0.00000000e+00]
 [-7.75394194e-03  1.77665129e-02]]
grads:  [-0.03232009 -9.92097883]
Stock Position:  -0.03232009046926536
Bond Position:  [18.08715326]


portfolio before change:  [14.93038805]
curr_Stock_Price:  97.74187510323279
curr_Factors:  [9.77418751e+01 3.91378022e-02]
mat_Sqrt:  [[ 1.93365452e+01  0.00000000e+00]
 [-7.91331053e-03  1.81316722e-02]]
grads:  [-0.0097724  -3.16812758]
Stock Position:  -0.009772400432962668
Bond Position:  [15.8855608]


portfolio before change:  [14.92900868]
curr_Stock_Price:  98.0862316412657
curr_Factors:  [9.80862316e+01 3.63644568e-02]
mat_Sqrt:  [[ 1.87045215e+01  0.00000000e+00]
 [-7.62778676e-03  1.74774551e-02]]
grads:  [-1.12286050e-03 -2.57405986e+00]
Stock Position:  -0.001122860504625179
Bond Position:  [15.03914584]


portfolio before change:  [14.9312753]
curr_Stock_Price:  97.74192453089542
curr_Factors:  [9.77419245e+01 3.54286630e-02]
mat_Sqrt:  [[ 1.83974770e+01  0.00000000e+00]
 [-7.52900132e-03  1.72511092e-02]]
grads:  [6.70058535e-03 1.05789199e+01]
Stock Position:  0.0067005853504261284
Bond Position:  [14.27634719]


portfolio before change:  [14.92776616]
curr_Stock_Price:  96.95187433915689
curr_Factors:  [9.69518743e+01 3.47379301e-02]
mat_Sqrt:  [[ 1.80700010e+01  0.00000000e+00]
 [-7.45524568e-03  1.70821138e-02]]
grads:  [0.00069653 0.00068104]
Stock Position:  0.0006965337258109949
Bond Position:  [14.86023591]


portfolio before change:  [14.9298387]
curr_Stock_Price:  97.26039854301956
curr_Factors:  [9.72603985e+01 3.52664318e-02]
mat_Sqrt:  [[ 1.82648792e+01  0.00000000e+00]
 [-7.51174353e-03  1.72115667e-02]]
grads:  [ 0.00344992 -3.0215769 ]
Stock Position:  0.0034499236269636426
Bond Position:  [14.59429775]


portfolio before change:  [14.93166009]
curr_Stock_Price:  97.25952499111114
curr_Factors:  [9.72595250e+01 3.51034374e-02]
mat_Sqrt:  [[ 1.82224584e+01  0.00000000e+00]
 [-7.49436454e-03  1.71717464e-02]]
grads:  [6.59965406e-04 6.96152283e+00]
Stock Position:  0.000659965405864792
Bond Position:  [14.86747217]


portfolio before change:  [14.93286655]
curr_Stock_Price:  96.27145930770465
curr_Factors:  [9.62714593e+01 3.55874773e-02]
mat_Sqrt:  [[ 1.81612676e+01  0.00000000e+00]
 [-7.54585739e-03  1.72897313e-02]]
grads:  [-0.00185097  1.82974118]
Stock Position:  -0.0018509653208047799
Bond Position:  [15.11106168]


portfolio before change:  [14.93588255]
curr_Stock_Price:  95.6625870976392
curr_Factors:  [9.56625871e+01 3.81265070e-02]
mat_Sqrt:  [[ 1.86790864e+01  0.00000000e+00]
 [-7.81040404e-03  1.78958839e-02]]
grads:  [-0.0173563  -5.91573713]
Stock Position:  -0.01735629669979298
Bond Position:  [16.5962308]


portfolio before change:  [14.90893781]
curr_Stock_Price:  97.33456821730256
curr_Factors:  [9.73345682e+01 3.74304456e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.90893781]
Stock Price:  96.28360402304202
PL:  [14.90893781]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.25311389e+00  3.12205159e-01]
 [ 2.66424801e-01  1.05276428e-01]
 [-3.96421614e-02 -6.77772527e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.19237183e-01 -4.05894030e-01]
 [-2.31723796e-01  4.80005175e-02]
 [ 1.76125721e-01 -1.79869574e-01]
 [-5.74102085e-01  2.19895280e-01]
 [-1.08828421e-01 -8.51975174e-02]
 [-5.29390152e-01 -7.35401721e-01]
 [-2.11847669e-02 -1.92595618e-02]
 [-3.58086940e-01 -3.04552640e-01]
 [ 6.65331705e-03  6.38391518e-02]
 [ 2.24492687e-02 -1.92624573e-01]
 [-2.88128850e-01 -1.50899522e-01]
 [ 8.45413521e-02 -1.12648767e+00]
 [ 1.03548116e-02 -4.60559096e-01]
 [ 4.50054360e-02 -1.72345007e-01]
 [-1.13679054e-01 -2.53069173e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.16672677e-01 -2.06106446e-02]
 [ 3.33545452e-01 -3.85058342e-01]
 [ 2.70600963e-02 -3.29138746e-01]
 [ 4.22889890e-02  2.97723499e-02]
 [ 4.22718783e-01 -3.48098639e-01]
 [-1.14764962e-01 -1.38223382e-02]
 [-1.65981792e-01  6.66053361e-02]
 [-7.85663466e-03  2.29452710e-01]
 [-5.72354993e-02  2.02908133e-01]
 [-6.60982893e-01 -5.54026888e-02]
 [-1.62286383e-01 -4.76969761e-02]
 [ 5.77204526e-02 -2.73432165e-02]
 [-2.72901375e-01  9.06492378e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.97290587e-01  2.92265934e-02]
 [-2.56151451e-02 -1.94123988e-01]
 [-8.15151258e-03 -6.11552897e-02]
 [ 1.25513278e-01 -2.08069890e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.88838868]
curr_Stock_Price:  100.32033472342232
curr_Factors:  [1.00320335e+02 3.95618848e-02]
mat_Sqrt:  [[ 1.99538847e+01  0.00000000e+00]
 [-7.95606785e-03  1.82296416e-02]]
grads:  [ 0.06962912 17.12623685]
Stock Position:  0.06962911800930441
Bond Position:  [-2.09682775]


portfolio before change:  [4.89773194]
curr_Stock_Price:  100.45828543503536
curr_Factors:  [1.00458285e+02 3.99961052e-02]
mat_Sqrt:  [[ 2.00906789e+01  0.00000000e+00]
 [-7.99961052e-03  1.83294104e-02]]
grads:  [0.01554807 5.74357962]
Stock Position:  0.015548065969740493
Bond Position:  [3.3357999]


portfolio before change:  [4.90856896]
curr_Stock_Price:  101.1284661037056
curr_Factors:  [1.01128466e+02 3.77860072e-02]
mat_Sqrt:  [[ 1.96579815e+01  0.00000000e+00]
 [-7.77544928e-03  1.78157924e-02]]
grads:  [-3.52134728e-03 -3.80433556e+00]
Stock Position:  -0.0035213472796963323
Bond Position:  [5.26467741]


portfolio before change:  [4.90725615]
curr_Stock_Price:  101.6881759940385
curr_Factors:  [1.01688176e+02 3.69461513e-02]
mat_Sqrt:  [[ 1.95458724e+01  0.00000000e+00]
 [-7.68855266e-03  1.76166873e-02]]
grads:  [-8.34005596e-04 -8.59337570e+00]
Stock Position:  -0.0008340055955550688
Bond Position:  [4.99206466]


portfolio before change:  [4.90746476]
curr_Stock_Price:  102.18629712068628
curr_Factors:  [1.02186297e+02 3.76798529e-02]
mat_Sqrt:  [[ 1.98356877e+01  0.00000000e+00]
 [-7.76451961e-03  1.77907494e-02]]
grads:  [-1.49419503e-02 -2.28148922e+01]
Stock Position:  -0.014941950337744899
Bond Position:  [6.43432734]


portfolio before change:  [4.93168025]
curr_Stock_Price:  100.61949054330294
curr_Factors:  [1.00619491e+02 3.81221023e-02]
mat_Sqrt:  [[ 1.96458369e+01  0.00000000e+00]
 [-7.80995286e-03  1.78948501e-02]]
grads:  [-0.01072872  2.68236489]
Stock Position:  -0.01072871843962552
Bond Position:  [6.01119843]


portfolio before change:  [4.92198757]
curr_Stock_Price:  101.59296396025186
curr_Factors:  [1.01592964e+02 3.76155943e-02]
mat_Sqrt:  [[ 1.97036913e+01  0.00000000e+00]
 [-7.75789604e-03  1.77755729e-02]]
grads:  [ 4.95461491e-03 -1.01189185e+01]
Stock Position:  0.004954614905111346
Bond Position:  [4.41863356]


portfolio before change:  [4.92878055]
curr_Stock_Price:  102.85252010679497
curr_Factors:  [1.0285252e+02 3.7328022e-02]
mat_Sqrt:  [[ 1.98715812e+01  0.00000000e+00]
 [-7.72818447e-03  1.77074952e-02]]
grads:  [-0.02406109 12.41820356]
Stock Position:  -0.024061090627904253
Bond Position:  [7.40352436]


portfolio before change:  [4.90495712]
curr_Stock_Price:  103.8811072788303
curr_Factors:  [1.03881107e+02 3.64679168e-02]
mat_Sqrt:  [[ 1.98377333e+01  0.00000000e+00]
 [-7.63862991e-03  1.75022999e-02]]
grads:  [-0.0073603  -4.86778983]
Stock Position:  -0.007360299884091594
Bond Position:  [5.66955322]


portfolio before change:  [4.8937797]
curr_Stock_Price:  105.49600869848908
curr_Factors:  [1.05496009e+02 3.59974391e-02]
mat_Sqrt:  [[ 2.00157483e+01  0.00000000e+00]
 [-7.58919644e-03  1.73890336e-02]]
grads:  [ -0.04248384 -42.29112093]
Stock Position:  -0.04248383635253133
Bond Position:  [9.37565487]


portfolio before change:  [4.8736881]
curr_Stock_Price:  105.99651984904035
curr_Factors:  [1.05996520e+02 3.55490853e-02]
mat_Sqrt:  [[ 1.99850768e+01  0.00000000e+00]
 [-7.54178603e-03  1.72804027e-02]]
grads:  [-0.00148062 -1.114532  ]
Stock Position:  -0.001480621215854928
Bond Position:  [5.0306288]


portfolio before change:  [4.87318376]
curr_Stock_Price:  106.76187873523793
curr_Factors:  [1.06761879e+02 3.45128778e-02]
mat_Sqrt:  [[ 1.98338395e+01  0.00000000e+00]
 [-7.43105675e-03  1.70266900e-02]]
grads:  [ -0.0247559  -17.88677891]
Stock Position:  -0.024755903125122502
Bond Position:  [7.51617049]


portfolio before change:  [4.8694033]
curr_Stock_Price:  106.95254195005585
curr_Factors:  [1.06952542e+02 3.53352019e-02]
mat_Sqrt:  [[ 2.01045751e+01  0.00000000e+00]
 [-7.51906397e-03  1.72283399e-02]]
grads:  [1.71677376e-03 3.70547320e+00]
Stock Position:  0.0017167737622618253
Bond Position:  [4.68578998]


portfolio before change:  [4.86873603]
curr_Stock_Price:  106.22266424703295
curr_Factors:  [1.06222664e+02 3.67784655e-02]
mat_Sqrt:  [[ 2.03710771e+01  0.00000000e+00]
 [-7.67108499e-03  1.75766638e-02]]
grads:  [-3.02482714e-03 -1.09591089e+01]
Stock Position:  -0.0030248271395937848
Bond Position:  [5.19004122]


portfolio before change:  [4.86366667]
curr_Stock_Price:  108.11307007345376
curr_Factors:  [1.0811307e+02 3.4725699e-02]
mat_Sqrt:  [[ 2.01466897e+01  0.00000000e+00]
 [-7.45393308e-03  1.70791063e-02]]
grads:  [-0.01757047 -8.83532894]
Stock Position:  -0.017570469669466626
Bond Position:  [6.76326409]


portfolio before change:  [4.88438945]
curr_Stock_Price:  106.9817790250072
curr_Factors:  [1.06981779e+02 3.64832571e-02]
mat_Sqrt:  [[ 2.04341519e+01  0.00000000e+00]
 [-7.64023635e-03  1.75059807e-02]]
grads:  [-1.99224404e-02 -6.43487326e+01]
Stock Position:  -0.019922440389711263
Bond Position:  [7.01572756]


portfolio before change:  [4.8686628]
curr_Stock_Price:  107.81519427455143
curr_Factors:  [1.07815194e+02 3.42753528e-02]
mat_Sqrt:  [[ 1.99604780e+01  0.00000000e+00]
 [-7.40544155e-03  1.69679982e-02]]
grads:  [-9.55135731e-03 -2.71428067e+01]
Stock Position:  -0.009551357305864544
Bond Position:  [5.89844425]


portfolio before change:  [4.88049876]
curr_Stock_Price:  106.65320142160874
curr_Factors:  [1.06653201e+02 3.37462743e-02]
mat_Sqrt:  [[ 1.95923627e+01  0.00000000e+00]
 [-7.34806362e-03  1.68365289e-02]]
grads:  [-1.5420341e-03 -1.0236374e+01]
Stock Position:  -0.0015420341021843069
Bond Position:  [5.04496164]


portfolio before change:  [4.88316865]
curr_Stock_Price:  105.33077251967343
curr_Factors:  [1.05330773e+02 3.43385232e-02]
mat_Sqrt:  [[ 1.95184837e+01  0.00000000e+00]
 [-7.41226262e-03  1.69836273e-02]]
grads:  [-1.14828333e-02 -1.49007729e+01]
Stock Position:  -0.011482833347971034
Bond Position:  [6.09266436]


portfolio before change:  [4.89171385]
curr_Stock_Price:  104.65292853884051
curr_Factors:  [1.04652929e+02 3.53064174e-02]
mat_Sqrt:  [[ 1.96642873e+01  0.00000000e+00]
 [-7.51600079e-03  1.72213213e-02]]
grads:  [-2.46442036e-04 -6.33478625e+00]
Stock Position:  -0.00024644203600116205
Bond Position:  [4.91750473]


portfolio before change:  [4.89220576]
curr_Stock_Price:  105.15131111368349
curr_Factors:  [1.05151311e+02 3.42884556e-02]
mat_Sqrt:  [[ 1.94710178e+01  0.00000000e+00]
 [-7.40685689e-03  1.69712412e-02]]
grads:  [ 0.00553014 -1.21444533]
Stock Position:  0.0055301399641687074
Bond Position:  [4.31070429]


portfolio before change:  [4.89359808]
curr_Stock_Price:  105.30563793940765
curr_Factors:  [1.05305638e+02 3.50468355e-02]
mat_Sqrt:  [[ 1.97140579e+01  0.00000000e+00]
 [-7.48832003e-03  1.71578967e-02]]
grads:  [ 8.39462959e-03 -2.24420481e+01]
Stock Position:  0.00839462958502373
Bond Position:  [4.00959625]


portfolio before change:  [4.88797074]
curr_Stock_Price:  104.57557951713343
curr_Factors:  [1.04575580e+02 3.59451706e-02]
mat_Sqrt:  [[ 1.98267054e+01  0.00000000e+00]
 [-7.58368465e-03  1.73764045e-02]]
grads:  [-5.88034304e-03 -1.89417061e+01]
Stock Position:  -0.005880343043099978
Bond Position:  [5.50291102]


portfolio before change:  [4.89419201]
curr_Stock_Price:  103.63458571256189
curr_Factors:  [1.03634586e+02 3.67689308e-02]
mat_Sqrt:  [[ 1.98721665e+01  0.00000000e+00]
 [-7.67009057e-03  1.75743853e-02]]
grads:  [0.00278192 1.69407632]
Stock Position:  0.0027819165006643357
Bond Position:  [4.60588925]


portfolio before change:  [4.89449869]
curr_Stock_Price:  103.53785726862972
curr_Factors:  [1.03537857e+02 3.78814251e-02]
mat_Sqrt:  [[ 2.01517296e+01  0.00000000e+00]
 [-7.78526044e-03  1.78382726e-02]]
grads:  [ 1.34378581e-02 -1.95141450e+01]
Stock Position:  0.013437858055117418
Bond Position:  [3.50317166]


portfolio before change:  [4.89024024]
curr_Stock_Price:  103.18836871925612
curr_Factors:  [1.03188369e+02 3.72914345e-02]
mat_Sqrt:  [[ 1.99266958e+01  0.00000000e+00]
 [-7.72439611e-03  1.76988149e-02]]
grads:  [-0.0060621  -0.78097535]
Stock Position:  -0.006062095073766343
Bond Position:  [5.51577794]


portfolio before change:  [4.89519033]
curr_Stock_Price:  102.48554705138703
curr_Factors:  [1.02485547e+02 3.52942662e-02]
mat_Sqrt:  [[ 1.92537222e+01  0.00000000e+00]
 [-7.51470731e-03  1.72183575e-02]]
grads:  [-0.00711098  3.86827466]
Stock Position:  -0.007110980321161592
Bond Position:  [5.62396303]


portfolio before change:  [4.89503641]
curr_Stock_Price:  102.60605868827298
curr_Factors:  [1.02606059e+02 3.40020290e-02]
mat_Sqrt:  [[ 1.89201869e+01  0.00000000e+00]
 [-7.37585564e-03  1.69002084e-02]]
grads:  [4.87758068e-03 1.35769160e+01]
Stock Position:  0.004877580677945589
Bond Position:  [4.39456708]


portfolio before change:  [4.90202148]
curr_Stock_Price:  103.92550763184839
curr_Factors:  [1.03925508e+02 3.27872457e-02]
mat_Sqrt:  [[ 1.88180502e+01  0.00000000e+00]
 [-7.24289950e-03  1.65955676e-02]]
grads:  [1.66440570e-03 1.22266461e+01]
Stock Position:  0.001664405697966758
Bond Position:  [4.72904728]


portfolio before change:  [4.90129527]
curr_Stock_Price:  103.13400299769484
curr_Factors:  [1.03134003e+02 3.35178242e-02]
mat_Sqrt:  [[ 1.88816431e+01  0.00000000e+00]
 [-7.32314951e-03  1.67794435e-02]]
grads:  [-0.03628723 -3.30181921]
Stock Position:  -0.03628723439209895
Bond Position:  [8.64374301]


portfolio before change:  [4.91962513]
curr_Stock_Price:  102.65864771371574
curr_Factors:  [1.02658648e+02 3.43005198e-02]
mat_Sqrt:  [[ 1.90127917e+01  0.00000000e+00]
 [-7.40815980e-03  1.69742265e-02]]
grads:  [-0.00963052 -2.80996463]
Stock Position:  -0.00963051893851548
Bond Position:  [5.90828118]


portfolio before change:  [4.91705677]
curr_Stock_Price:  103.002028929478
curr_Factors:  [1.03002029e+02 3.29082725e-02]
mat_Sqrt:  [[ 1.86852246e+01  0.00000000e+00]
 [-7.25625495e-03  1.66261688e-02]]
grads:  [ 0.00245043 -1.64458913]
Stock Position:  0.0024504331998587607
Bond Position:  [4.66465718]


portfolio before change:  [4.91724136]
curr_Stock_Price:  102.83939109462608
curr_Factors:  [1.02839391e+02 3.49506702e-02]
mat_Sqrt:  [[ 1.92259253e+01  0.00000000e+00]
 [-7.47803933e-03  1.71343406e-02]]
grads:  [-0.01213667  5.2905005 ]
Stock Position:  -0.012136674871671563
Bond Position:  [6.16536961]


portfolio before change:  [4.91654628]
curr_Stock_Price:  102.96016513282703
curr_Factors:  [1.02960165e+02 3.59945287e-02]
mat_Sqrt:  [[ 1.95338333e+01  0.00000000e+00]
 [-7.58888964e-03  1.73883306e-02]]
grads:  [0.00519464 3.06809561]
Stock Position:  0.005194636933319967
Bond Position:  [4.38170561]


portfolio before change:  [4.92017465]
curr_Stock_Price:  103.553203978301
curr_Factors:  [1.03553204e+02 3.51639484e-02]
mat_Sqrt:  [[ 1.94183515e+01  0.00000000e+00]
 [-7.50082112e-03  1.71865403e-02]]
grads:  [-0.00487516  4.73190909]
Stock Position:  -0.004875162078055776
Bond Position:  [5.4250133]


portfolio before change:  [4.9220869]
curr_Stock_Price:  103.30006717491983
curr_Factors:  [1.03300067e+02 3.54062872e-02]
mat_Sqrt:  [[ 1.94375175e+01  0.00000000e+00]
 [-7.52662339e-03  1.72456607e-02]]
grads:  [-0.01463845  1.69472158]
Stock Position:  -0.014638446259631847
Bond Position:  [6.43423939]


portfolio before change:  [4.92836562]
curr_Stock_Price:  102.9260936346477
curr_Factors:  [1.02926094e+02 3.51482307e-02]
mat_Sqrt:  [[ 1.92964414e+01  0.00000000e+00]
 [-7.49914456e-03  1.71826988e-02]]
grads:  [-5.71803875e-03 -1.12976425e+01]
Stock Position:  -0.005718038746904818
Bond Position:  [5.51690102]


portfolio before change:  [4.92168076]
curr_Stock_Price:  104.21578733070837
curr_Factors:  [1.04215787e+02 3.58430163e-02]
mat_Sqrt:  [[ 1.97303954e+01  0.00000000e+00]
 [-7.57290077e-03  1.73516955e-02]]
grads:  [-1.76589817e-03 -3.52445613e+00]
Stock Position:  -0.0017658981702279052
Bond Position:  [5.10571523]


portfolio before change:  [4.92058544]
curr_Stock_Price:  105.19748134040796
curr_Factors:  [1.05197481e+02 3.54974563e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.92058544]
Stock Price:  104.71670218567807
PL:  [0.20388326]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.31593442e+00  3.26407622e-01]
 [ 3.95752293e-01  1.18308786e-01]
 [ 1.10439867e-01 -4.80269762e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.26511652e-02  1.61614796e-01]
 [-1.39453213e-01 -5.16271196e-02]
 [ 9.80483930e-02  2.66580604e-02]
 [ 8.92821144e-01  8.92218201e-01]
 [-8.98884961e-04  3.29878675e-01]
 [ 1.82366400e-01  4.94098663e-02]
 [-1.06232085e-01  4.11658534e-03]
 [-1.97143270e-02 -1.35947106e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-1.01257280e-02 -1.12361739e-01]
 [ 1.08150511e-01  6.37837522e-02]
 [ 1.19252583e-01 -6.61644763e-01]
 [ 1.74158558e-02 -3.18433847e-01]
 [ 3.87192048e-02 -1.60819664e-01]
 [-1.21492984e-01 -3.34441616e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.24751819e-01 -2.30970725e-02]
 [ 3.62283714e-01 -3.61852313e-01]
 [ 2.76110746e-02 -3.43320711e-01]
 [ 3.65488282e-02  3.72071165e-02]
 [ 4.36407490e-01 -3.89955660e-01]
 [-1.72163727e-01 -5.55695255e-04]
 [-1.33174126e-01 -4.15090184e-02]
 [-2.84235720e-02  1.54468983e-01]
 [-4.47836749e-02  1.94821998e-01]
 [-7.54194643e-01 -1.25912676e-02]
 [-1.49781954e-01 -2.43743924e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.39955689e-01 -6.03824203e-03]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.22337288e-01 -9.56024034e-02]
 [-3.21817449e-02 -1.33320719e-01]
 [ 4.64155418e-03 -6.38210735e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.04582123]
curr_Stock_Price:  100.05287690975737
curr_Factors:  [1.00052877e+02 4.12320487e-02]
mat_Sqrt:  [[ 2.03164132e+01  0.00000000e+00]
 [-8.12227049e-03  1.86104597e-02]]
grads:  [ 0.07178385 17.53893392]
Stock Position:  0.07178385134355253
Bond Position:  [-4.13635961]


portfolio before change:  [3.04550579]
curr_Stock_Price:  100.05568580608477
curr_Factors:  [1.00055686e+02 4.12766692e-02]
mat_Sqrt:  [[ 2.03279739e+01  0.00000000e+00]
 [-8.12666418e-03  1.86205269e-02]]
grads:  [0.02200841 6.35367552]
Stock Position:  0.02200841468153628
Bond Position:  [0.84343876]


portfolio before change:  [3.02842907]
curr_Stock_Price:  99.27497727806205
curr_Factors:  [9.92749773e+01 4.06880213e-02]
mat_Sqrt:  [[ 2.00250257e+01  0.00000000e+00]
 [-8.06850879e-03  1.84872761e-02]]
grads:  [ 0.00446837 -2.5978395 ]
Stock Position:  0.004468367616909222
Bond Position:  [2.58483197]


portfolio before change:  [3.03220201]
curr_Stock_Price:  100.04703204242098
curr_Factors:  [1.00047032e+02 4.03925546e-02]
mat_Sqrt:  [[ 2.01073515e+01  0.00000000e+00]
 [-8.03915962e-03  1.84200287e-02]]
grads:  [-8.10716765e-04 -8.21859806e+00]
Stock Position:  -0.0008107167647807541
Bond Position:  [3.11331182]


portfolio before change:  [3.03269676]
curr_Stock_Price:  99.9168281081229
curr_Factors:  [9.99168281e+01 4.05470079e-02]
mat_Sqrt:  [[ 2.01195399e+01  0.00000000e+00]
 [-8.05451505e-03  1.84552125e-02]]
grads:  [-6.02234720e-04  8.75713551e+00]
Stock Position:  -0.0006022347197958774
Bond Position:  [3.09287014]


portfolio before change:  [3.03323945]
curr_Stock_Price:  99.65770095239218
curr_Factors:  [9.96577010e+01 4.16509096e-02]
mat_Sqrt:  [[ 2.03386962e+01  0.00000000e+00]
 [-8.16342179e-03  1.87047491e-02]]
grads:  [-0.00796438 -2.76010757]
Stock Position:  -0.007964381500428755
Bond Position:  [3.8269514]


portfolio before change:  [3.02777077]
curr_Stock_Price:  100.4044103278553
curr_Factors:  [1.00404410e+02 4.29627121e-02]
mat_Sqrt:  [[ 2.08112724e+01  0.00000000e+00]
 [-8.29097939e-03  1.89970203e-02]]
grads:  [0.00527036 1.40327588]
Stock Position:  0.005270361280616606
Bond Position:  [2.49860325]


portfolio before change:  [3.01285784]
curr_Stock_Price:  97.5155628365334
curr_Factors:  [9.75155628e+01 4.37850707e-02]
mat_Sqrt:  [[ 2.04050169e+01  0.00000000e+00]
 [-8.36995300e-03  1.91779716e-02]]
grads:  [ 0.06283833 46.52307448]
Stock Position:  0.06283832521469211
Bond Position:  [-3.11485681]


portfolio before change:  [3.03939234]
curr_Stock_Price:  97.9440254419436
curr_Factors:  [9.79440254e+01 4.35901617e-02]
mat_Sqrt:  [[ 2.04490054e+01  0.00000000e+00]
 [-8.35130282e-03  1.91352387e-02]]
grads:  [6.99652473e-03 1.72393290e+01]
Stock Position:  0.00699652472851791
Bond Position:  [2.35412454]


portfolio before change:  [3.0488198]
curr_Stock_Price:  99.24941401192669
curr_Factors:  [9.92494140e+01 4.23574535e-02]
mat_Sqrt:  [[ 2.04264489e+01  0.00000000e+00]
 [-8.23237059e-03  1.88627307e-02]]
grads:  [0.00998366 2.61944397]
Stock Position:  0.009983655727640732
Bond Position:  [2.05794782]


portfolio before change:  [3.04450703]
curr_Stock_Price:  98.7916625709379
curr_Factors:  [9.87916626e+01 4.32922135e-02]
mat_Sqrt:  [[ 2.05553649e+01  0.00000000e+00]
 [-8.32271239e-03  1.90697298e-02]]
grads:  [-0.00508069  0.21587015]
Stock Position:  -0.005080691124357985
Bond Position:  [3.54643695]


portfolio before change:  [3.02935215]
curr_Stock_Price:  101.86175888978772
curr_Factors:  [1.01861759e+02 4.46966968e-02]
mat_Sqrt:  [[ 2.15351988e+01  0.00000000e+00]
 [-8.45663733e-03  1.93765903e-02]]
grads:  [-3.67057249e-03 -7.01604894e+00]
Stock Position:  -0.0036705724912900247
Bond Position:  [3.40324312]


portfolio before change:  [3.02756273]
curr_Stock_Price:  102.46516694998898
curr_Factors:  [1.02465167e+02 4.44766202e-02]
mat_Sqrt:  [[ 2.16093718e+01  0.00000000e+00]
 [-8.43579234e-03  1.93288285e-02]]
grads:  [-0.00303153 -0.92556064]
Stock Position:  -0.003031532882810836
Bond Position:  [3.33818925]


portfolio before change:  [3.02828579]
curr_Stock_Price:  102.36430768921335
curr_Factors:  [1.02364308e+02 4.55491596e-02]
mat_Sqrt:  [[ 2.18468455e+01  0.00000000e+00]
 [-8.53689964e-03  1.95604944e-02]]
grads:  [-2.70814434e-03 -5.74431997e+00]
Stock Position:  -0.0027081443400229165
Bond Position:  [3.30550311]


portfolio before change:  [3.02619149]
curr_Stock_Price:  103.29022297032051
curr_Factors:  [1.03290223e+02 4.52334728e-02]
mat_Sqrt:  [[ 2.19679323e+01  0.00000000e+00]
 [-8.50726492e-03  1.94925927e-02]]
grads:  [0.0061903  3.27220463]
Stock Position:  0.006190296868938635
Bond Position:  [2.38679435]


portfolio before change:  [3.02580688]
curr_Stock_Price:  103.17989250175492
curr_Factors:  [1.03179893e+02 4.51504781e-02]
mat_Sqrt:  [[ 2.19243258e+01  0.00000000e+00]
 [-8.49945675e-03  1.94747020e-02]]
grads:  [-7.73172533e-03 -3.39745771e+01]
Stock Position:  -0.007731725334239917
Bond Position:  [3.82356547]


portfolio before change:  [3.00782278]
curr_Stock_Price:  105.5677257775016
curr_Factors:  [1.05567726e+02 4.48380521e-02]
mat_Sqrt:  [[ 2.23539633e+01  0.00000000e+00]
 [-8.46999901e-03  1.94072058e-02]]
grads:  [-5.43796493e-03 -1.64080213e+01]
Stock Position:  -0.005437964928673828
Bond Position:  [3.58189637]


portfolio before change:  [3.01078587]
curr_Stock_Price:  105.10517761138512
curr_Factors:  [1.05105178e+02 4.44990122e-02]
mat_Sqrt:  [[ 2.21717154e+01  0.00000000e+00]
 [-8.43791559e-03  1.93336935e-02]]
grads:  [-1.41929707e-03 -8.31810353e+00]
Stock Position:  -0.001419297069152441
Bond Position:  [3.15996134]


portfolio before change:  [3.0117313]
curr_Stock_Price:  104.71736931984908
curr_Factors:  [1.04717369e+02 4.56703662e-02]
mat_Sqrt:  [[ 2.23787575e+01  0.00000000e+00]
 [-8.54825046e-03  1.95865024e-02]]
grads:  [-1.19513012e-02 -1.70751066e+01]
Stock Position:  -0.011951301188223414
Bond Position:  [4.26324012]


portfolio before change:  [3.03035402]
curr_Stock_Price:  103.20374492855692
curr_Factors:  [1.03203745e+02 4.66847461e-02]
mat_Sqrt:  [[ 2.22988752e+01  0.00000000e+00]
 [-8.64266127e-03  1.98028247e-02]]
grads:  [-2.17325177e-04 -5.50898120e+00]
Stock Position:  -0.00021732517703748234
Bond Position:  [3.0527828]


portfolio before change:  [3.03042908]
curr_Stock_Price:  104.61435646507276
curr_Factors:  [1.04614356e+02 4.57406782e-02]
mat_Sqrt:  [[ 2.23739461e+01  0.00000000e+00]
 [-8.55482817e-03  1.96015738e-02]]
grads:  [ 0.00512522 -1.17832745]
Stock Position:  0.005125221527124335
Bond Position:  [2.49425733]


portfolio before change:  [3.03028652]
curr_Stock_Price:  104.52570439128161
curr_Factors:  [1.04525704e+02 4.73533667e-02]
mat_Sqrt:  [[ 2.27456595e+01  0.00000000e+00]
 [-8.70433149e-03  1.99441290e-02]]
grads:  [ 8.98450175e-03 -1.81432999e+01]
Stock Position:  0.008984501754457573
Bond Position:  [2.09117515]


portfolio before change:  [3.02697061]
curr_Stock_Price:  104.12753767385708
curr_Factors:  [1.04127538e+02 4.61997791e-02]
mat_Sqrt:  [[ 2.23813124e+01  0.00000000e+00]
 [-8.59765355e-03  1.96996991e-02]]
grads:  [-5.46109030e-03 -1.74277134e+01]
Stock Position:  -0.005461090298917339
Bond Position:  [3.59562049]


portfolio before change:  [3.02697167]
curr_Stock_Price:  104.20964989777089
curr_Factors:  [1.04209650e+02 4.69916611e-02]
mat_Sqrt:  [[ 2.25901095e+01  0.00000000e+00]
 [-8.67102403e-03  1.98678120e-02]]
grads:  [0.00233675 1.87273347]
Stock Position:  0.0023367458732725817
Bond Position:  [2.7834602]


portfolio before change:  [3.02801262]
curr_Stock_Price:  104.50621678338767
curr_Factors:  [1.04506217e+02 4.71378126e-02]
mat_Sqrt:  [[ 2.2689600e+01  0.0000000e+00]
 [-8.6844977e-03  1.9898684e-02]]
grads:  [ 1.17329916e-02 -1.95970578e+01]
Stock Position:  0.011732991629904653
Bond Position:  [1.80184206]


portfolio before change:  [3.01850403]
curr_Stock_Price:  103.67660424709388
curr_Factors:  [1.03676604e+02 4.76467327e-02]
mat_Sqrt:  [[ 2.26306656e+01  0.00000000e+00]
 [-8.73125262e-03  2.00058130e-02]]
grads:  [-0.00761826 -0.02777669]
Stock Position:  -0.007618258164386408
Bond Position:  [3.80833917]


portfolio before change:  [3.03559873]
curr_Stock_Price:  101.49518302436222
curr_Factors:  [1.01495183e+02 4.94488507e-02]
mat_Sqrt:  [[ 2.25695828e+01  0.00000000e+00]
 [-8.89483901e-03  2.03806365e-02]]
grads:  [-0.00670328 -2.03668901]
Stock Position:  -0.006703276192831519
Bond Position:  [3.71594898]


portfolio before change:  [3.0233311]
curr_Stock_Price:  103.3945753305166
curr_Factors:  [1.03394575e+02 4.66059842e-02]
mat_Sqrt:  [[ 2.23212543e+01  0.00000000e+00]
 [-8.63536766e-03  1.97861130e-02]]
grads:  [1.74686506e-03 7.80693931e+00]
Stock Position:  0.0017468650622934488
Bond Position:  [2.84271473]


portfolio before change:  [3.02276183]
curr_Stock_Price:  102.8652631343759
curr_Factors:  [1.02865263e+02 4.69957943e-02]
mat_Sqrt:  [[ 2.22996598e+01  0.00000000e+00]
 [-8.67140536e-03  1.98686857e-02]]
grads:  [1.80467398e-03 9.80547988e+00]
Stock Position:  0.001804673980174941
Bond Position:  [2.83712356]


portfolio before change:  [3.02620122]
curr_Stock_Price:  104.57456293479376
curr_Factors:  [1.04574563e+02 4.72279666e-02]
mat_Sqrt:  [[ 2.27261402e+01  0.00000000e+00]
 [-8.69279854e-03  1.99177037e-02]]
grads:  [-0.03342802 -0.63216462]
Stock Position:  -0.0334280223514941
Bond Position:  [6.52192205]


portfolio before change:  [3.03549626]
curr_Stock_Price:  104.32089103205402
curr_Factors:  [1.04320891e+02 4.72673366e-02]
mat_Sqrt:  [[ 2.26804597e+01  0.00000000e+00]
 [-8.69642102e-03  1.99260038e-02]]
grads:  [-0.00707304 -1.2232454 ]
Stock Position:  -0.007073040549968689
Bond Position:  [3.77336215]


portfolio before change:  [3.03380905]
curr_Stock_Price:  104.62612240240148
curr_Factors:  [1.04626122e+02 4.60268023e-02]
mat_Sqrt:  [[ 2.24463397e+01  0.00000000e+00]
 [-8.58154320e-03  1.96627857e-02]]
grads:  [ 0.00323182 -0.6076041 ]
Stock Position:  0.0032318229868383793
Bond Position:  [2.69567594]


portfolio before change:  [3.03566603]
curr_Stock_Price:  105.09644737541775
curr_Factors:  [1.05096447e+02 4.59021786e-02]
mat_Sqrt:  [[ 2.25166971e+01  0.00000000e+00]
 [-8.56991749e-03  1.96361478e-02]]
grads:  [-0.01077383 -0.30750645]
Stock Position:  -0.010773826807481741
Bond Position:  [4.16795696]


portfolio before change:  [3.01134429]
curr_Stock_Price:  107.40229199010123
curr_Factors:  [1.07402292e+02 4.45374349e-02]
mat_Sqrt:  [[ 2.26660660e+01  0.00000000e+00]
 [-8.44155767e-03  1.93420385e-02]]
grads:  [0.00447679 2.75819226]
Stock Position:  0.004476787967821105
Bond Position:  [2.530527]


portfolio before change:  [3.02064975]
curr_Stock_Price:  109.41023155525217
curr_Factors:  [1.09410232e+02 4.45921657e-02]
mat_Sqrt:  [[ 2.31040023e+01  0.00000000e+00]
 [-8.44674287e-03  1.93539193e-02]]
grads:  [-4.09745504e-03  4.20199883e+00]
Stock Position:  -0.004097455040248368
Bond Position:  [3.46895325]


portfolio before change:  [3.02605425]
curr_Stock_Price:  108.19707518838591
curr_Factors:  [1.08197075e+02 4.56434879e-02]
mat_Sqrt:  [[ 2.31155873e+01  0.00000000e+00]
 [-8.54573464e-03  1.95807379e-02]]
grads:  [-0.0200757  -4.88247193]
Stock Position:  -0.02007570002540429
Bond Position:  [5.19818627]


portfolio before change:  [3.00838693]
curr_Stock_Price:  109.10947814917401
curr_Factors:  [1.09109478e+02 4.42767349e-02]
mat_Sqrt:  [[ 2.29588575e+01  0.00000000e+00]
 [-8.41681507e-03  1.92853461e-02]]
grads:  [-3.93607029e-03 -6.91305816e+00]
Stock Position:  -0.003936070294286724
Bond Position:  [3.43784951]


portfolio before change:  [3.01257482]
curr_Stock_Price:  108.15468617324072
curr_Factors:  [1.08154686e+02 4.32373949e-02]
mat_Sqrt:  [[ 2.24892567e+01  0.00000000e+00]
 [-8.31744143e-03  1.90576525e-02]]
grads:  [-1.03214820e-03 -3.34884234e+00]
Stock Position:  -0.0010321482025420579
Bond Position:  [3.12420648]


portfolio before change:  [3.01061268]
curr_Stock_Price:  110.43409495642699
curr_Factors:  [1.10434095e+02 4.48643840e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.01061268]
Stock Price:  109.39184503116859
PL:  [-6.38123235]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 9.88628733e-01  2.52410364e-01]
 [-2.63391778e-01 -8.63746669e-02]
 [-8.71943251e-01 -2.58666140e-01]
 [-1.17878455e-01 -1.14073324e-01]
 [-1.22524286e-01 -5.77963482e-01]
 [-3.76068240e-01  2.11620447e-01]
 [ 2.91000475e-01 -3.33901637e-01]
 [-5.67043297e-01  2.27739926e-01]
 [-1.18103635e-01 -9.80958055e-02]
 [-8.35623701e-02 -3.24287467e-01]
 [-8.95680524e-02 -8.05466210e-03]
 [ 2.56278265e-03 -1.36123088e-01]
 [-1.16456699e-01 -2.73870056e-02]
 [-4.76727782e-02 -3.44053119e-02]
 [ 4.62139240e-01  2.94608738e-01]
 [ 1.36526579e-01 -4.63942825e-01]
 [ 2.93034732e-02 -1.36540040e-01]
 [ 3.45933033e-02 -1.56321068e-01]
 [-1.16633283e-01 -4.42738803e-01]
 [ 2.13548594e-02 -9.65583556e-02]
 [ 1.51710021e-01 -3.19390875e-02]
 [ 4.50861147e-01 -3.01896293e-01]
 [ 2.88179571e-02 -3.75407100e-01]
 [ 4.23302825e-02  2.97583653e-02]
 [ 4.01631871e-01 -3.12346146e-01]
 [-1.68785394e-01 -1.48603930e-03]
 [-1.45870921e-01  1.27392814e-01]
 [-5.85506583e-02  3.20803039e-02]
 [-4.00493971e-02  1.93600647e-01]
 [-6.52843125e-01 -5.95795628e-02]
 [-1.53619574e-01 -2.77784996e-02]
 [ 6.77849256e-02 -1.69037808e-02]
 [-2.63381165e-01  1.42122538e-01]
 [ 6.47109176e-02  6.35867611e-02]
 [-1.22590384e-01  8.33738642e-02]
 [-1.61639361e-01  1.06064330e-01]
 [-3.13424102e-02 -1.42957469e-01]
 [ 2.39115716e-02 -1.73552792e-02]
 [ 5.93090924e-02 -1.18339130e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.83583483]
curr_Stock_Price:  102.3448757831034
curr_Factors:  [1.02344876e+02 3.98937460e-02]
mat_Sqrt:  [[ 2.04417707e+01  0.00000000e+00]
 [-7.98936753e-03  1.83059407e-02]]
grads:  [ 0.05375218 13.78843993]
Stock Position:  0.05375217560289253
Bond Position:  [13.33457509]


portfolio before change:  [18.85102166]
curr_Stock_Price:  102.59639871073375
curr_Factors:  [1.02596399e+02 4.01727284e-02]
mat_Sqrt:  [[ 2.05635353e+01  0.00000000e+00]
 [-8.01725423e-03  1.83698372e-02]]
grads:  [-0.01464188 -4.70198325]
Stock Position:  -0.014641877920493498
Bond Position:  [20.3532256]


portfolio before change:  [18.83159744]
curr_Stock_Price:  104.09678896883581
curr_Factors:  [1.04096789e+02 3.90706150e-02]
mat_Sqrt:  [[ 2.05760713e+01  0.00000000e+00]
 [-7.90651529e-03  1.81161024e-02]]
grads:  [ -0.04786309 -14.27824453]
Stock Position:  -0.047863092697601244
Bond Position:  [23.8139917]


portfolio before change:  [18.86106851]
curr_Stock_Price:  103.54324888277218
curr_Factors:  [1.03543249e+02 3.87607084e-02]
mat_Sqrt:  [[ 2.03853250e+01  0.00000000e+00]
 [-7.87509577e-03  1.80441112e-02]]
grads:  [-0.00822475 -6.32191427]
Stock Position:  -0.008224746715874014
Bond Position:  [19.71268551]


portfolio before change:  [18.86798887]
curr_Stock_Price:  103.00145451593336
curr_Factors:  [1.03001455e+02 3.92668420e-02]
mat_Sqrt:  [[ 2.04106269e+01  0.00000000e+00]
 [-7.92634513e-03  1.81615383e-02]]
grads:  [-1.83614267e-02 -3.18234873e+01]
Stock Position:  -0.018361426650625786
Bond Position:  [20.75924253]


portfolio before change:  [18.88272068]
curr_Stock_Price:  102.34046371165324
curr_Factors:  [1.02340464e+02 4.07171705e-02]
mat_Sqrt:  [[ 2.06507665e+01  0.00000000e+00]
 [-8.07139844e-03  1.84938972e-02]]
grads:  [-0.01373845 11.44271784]
Stock Position:  -0.013738449160081705
Bond Position:  [20.28871993]


portfolio before change:  [18.87530812]
curr_Stock_Price:  103.0646211409453
curr_Factors:  [1.03064621e+02 4.08629908e-02]
mat_Sqrt:  [[ 2.08340972e+01  0.00000000e+00]
 [-8.08583856e-03  1.85269836e-02]]
grads:  [ 6.97288932e-03 -1.80224500e+01]
Stock Position:  0.0069728893166650955
Bond Position:  [18.15664993]


portfolio before change:  [18.87581463]
curr_Stock_Price:  102.81175300012039
curr_Factors:  [1.02811753e+02 4.07478074e-02]
mat_Sqrt:  [[ 2.07536690e+01  0.00000000e+00]
 [-8.07443446e-03  1.85008536e-02]]
grads:  [-0.02253334 12.30969835]
Stock Position:  -0.02253333825997834
Bond Position:  [21.19250663]


portfolio before change:  [18.89188534]
curr_Stock_Price:  102.2161248825531
curr_Factors:  [1.02216125e+02 4.02205930e-02]
mat_Sqrt:  [[ 2.04995179e+01  0.00000000e+00]
 [-8.02202897e-03  1.83807775e-02]]
grads:  [-0.00784975 -5.33686922]
Stock Position:  -0.007849753107516955
Bond Position:  [19.69425669]


portfolio before change:  [18.89613966]
curr_Stock_Price:  101.98778942486491
curr_Factors:  [1.01987789e+02 4.06194189e-02]
mat_Sqrt:  [[ 2.05548841e+01  0.00000000e+00]
 [-8.06170393e-03  1.84716843e-02]]
grads:  [-1.09508292e-02 -1.75559231e+01]
Stock Position:  -0.010950829165399049
Bond Position:  [20.01299052]


portfolio before change:  [18.9138484]
curr_Stock_Price:  100.59913118457247
curr_Factors:  [1.00599131e+02 4.11814133e-02]
mat_Sqrt:  [[ 2.04147870e+01  0.00000000e+00]
 [-8.11728164e-03  1.85990288e-02]]
grads:  [-0.00455961 -0.43306896]
Stock Position:  -0.004559606477024472
Bond Position:  [19.37254085]


portfolio before change:  [18.91473748]
curr_Stock_Price:  100.93526444105164
curr_Factors:  [1.00935264e+02 3.95189125e-02]
mat_Sqrt:  [[ 2.00652889e+01  0.00000000e+00]
 [-7.95174572e-03  1.82197383e-02]]
grads:  [-2.83306181e-03 -7.47118790e+00]
Stock Position:  -0.0028330618076991432
Bond Position:  [19.20069332]


portfolio before change:  [18.91958717]
curr_Stock_Price:  100.07066965867381
curr_Factors:  [1.0007067e+02 4.2082505e-02]
mat_Sqrt:  [[ 2.05285180e+01  0.00000000e+00]
 [-8.20560833e-03  1.88014106e-02]]
grads:  [-0.00625517 -1.45664632]
Stock Position:  -0.006255169933978683
Bond Position:  [19.54554621]


portfolio before change:  [18.92464842]
curr_Stock_Price:  99.65215017114214
curr_Factors:  [9.96521502e+01 4.07337766e-02]
mat_Sqrt:  [[ 2.01124053e+01  0.00000000e+00]
 [-8.07304419e-03  1.84976680e-02]]
grads:  [-0.00311691 -1.85998104]
Stock Position:  -0.0031169065265749616
Bond Position:  [19.23525486]


portfolio before change:  [18.9268965]
curr_Stock_Price:  99.70235553035188
curr_Factors:  [9.97023555e+01 4.24309091e-02]
mat_Sqrt:  [[ 2.05374532e+01  0.00000000e+00]
 [-8.23950572e-03  1.88790793e-02]]
grads:  [ 0.02876292 15.60503736]
Stock Position:  0.02876291562709248
Bond Position:  [16.05916606]


portfolio before change:  [18.9851605]
curr_Stock_Price:  101.65822413984183
curr_Factors:  [1.01658224e+02 4.16633245e-02]
mat_Sqrt:  [[ 2.07500658e+01  0.00000000e+00]
 [-8.16463834e-03  1.87075366e-02]]
grads:  [-3.17852823e-03 -2.47997818e+01]
Stock Position:  -0.0031785282292419036
Bond Position:  [19.30828404]


portfolio before change:  [18.98522757]
curr_Stock_Price:  102.39649546898036
curr_Factors:  [1.02396495e+02 3.98469168e-02]
mat_Sqrt:  [[ 2.04400736e+01  0.00000000e+00]
 [-7.98467701e-03  1.82951934e-02]]
grads:  [-1.48176990e-03 -7.46316463e+00]
Stock Position:  -0.0014817699015527495
Bond Position:  [19.13695562]


portfolio before change:  [18.98586643]
curr_Stock_Price:  103.57981520350225
curr_Factors:  [1.03579815e+02 4.03574871e-02]
mat_Sqrt:  [[ 2.08083282e+01  0.00000000e+00]
 [-8.03566919e-03  1.84120312e-02]]
grads:  [-1.61621845e-03 -8.49015878e+00]
Stock Position:  -0.0016162184542297697
Bond Position:  [19.15327404]


portfolio before change:  [18.98811562]
curr_Stock_Price:  103.6696047528556
curr_Factors:  [1.03669605e+02 3.80041622e-02]
mat_Sqrt:  [[ 2.02100331e+01  0.00000000e+00]
 [-7.79786250e-03  1.78671476e-02]]
grads:  [-1.53320055e-02 -2.47794899e+01]
Stock Position:  -0.015332005473345614
Bond Position:  [20.57757857]


portfolio before change:  [19.01375883]
curr_Stock_Price:  102.16485403459761
curr_Factors:  [1.02164854e+02 3.95070691e-02]
mat_Sqrt:  [[ 2.0306680e+01  0.0000000e+00]
 [-7.9505541e-03  1.8217008e-02]]
grads:  [-1.02363665e-03 -5.30045085e+00]
Stock Position:  -0.0010236366483370653
Bond Position:  [19.11833851]


portfolio before change:  [19.01549256]
curr_Stock_Price:  102.80591161692422
curr_Factors:  [1.02805912e+02 3.79274602e-02]
mat_Sqrt:  [[ 2.00214243e+01  0.00000000e+00]
 [-7.78998949e-03  1.78491083e-02]]
grads:  [ 0.00688116 -1.78939402]
Stock Position:  0.006881161815262836
Bond Position:  [18.30806844]


portfolio before change:  [19.01992784]
curr_Stock_Price:  103.11786930026322
curr_Factors:  [1.03117869e+02 3.71661146e-02]
mat_Sqrt:  [[ 1.98795940e+01  0.00000000e+00]
 [-7.71140605e-03  1.76690510e-02]]
grads:  [ 1.60517766e-02 -1.70861635e+01]
Stock Position:  0.01605177660835321
Bond Position:  [17.36470284]


portfolio before change:  [19.02624686]
curr_Stock_Price:  103.37630179304934
curr_Factors:  [1.03376302e+02 3.72780488e-02]
mat_Sqrt:  [[ 1.99594044e+01  0.00000000e+00]
 [-7.72300965e-03  1.76956382e-02]]
grads:  [-6.76488791e-03 -2.12146687e+01]
Stock Position:  -0.006764887914775934
Bond Position:  [19.72557596]


portfolio before change:  [19.02696946]
curr_Stock_Price:  103.63399347117124
curr_Factors:  [1.03633993e+02 3.91739778e-02]
mat_Sqrt:  [[ 2.05116723e+01  0.00000000e+00]
 [-7.91696687e-03  1.81400500e-02]]
grads:  [0.0026969  1.64047868]
Stock Position:  0.0026968984801427538
Bond Position:  [18.7474791]


portfolio before change:  [19.02749215]
curr_Stock_Price:  102.95881537642454
curr_Factors:  [1.02958815e+02 3.99547134e-02]
mat_Sqrt:  [[ 2.05801031e+01  0.00000000e+00]
 [-7.99547006e-03  1.83199234e-02]]
grads:  [ 1.28917156e-02 -1.70495334e+01]
Stock Position:  0.012891715617444472
Bond Position:  [17.70017639]


portfolio before change:  [19.03852886]
curr_Stock_Price:  103.64328967348203
curr_Factors:  [1.03643290e+02 3.95295292e-02]
mat_Sqrt:  [[ 2.06063945e+01  0.00000000e+00]
 [-7.95281376e-03  1.82221855e-02]]
grads:  [-0.0082224 -0.0815511]
Stock Position:  -0.008222396942373316
Bond Position:  [19.89072513]


portfolio before change:  [19.0330071]
curr_Stock_Price:  104.61724700172381
curr_Factors:  [1.04617247e+02 3.74925563e-02]
mat_Sqrt:  [[ 2.02570320e+01  0.00000000e+00]
 [-7.74519788e-03  1.77464778e-02]]
grads:  [-4.45633588e-03  7.17848443e+00]
Stock Position:  -0.004456335879705098
Bond Position:  [19.49921669]


portfolio before change:  [19.03597538]
curr_Stock_Price:  104.49815229765613
curr_Factors:  [1.04498152e+02 3.83958113e-02]
mat_Sqrt:  [[ 2.04762553e+01  0.00000000e+00]
 [-7.83793966e-03  1.79589759e-02]]
grads:  [-0.00217567  1.78631031]
Stock Position:  -0.0021756744669852585
Bond Position:  [19.26332934]


portfolio before change:  [19.04247873]
curr_Stock_Price:  102.61584360762971
curr_Factors:  [1.02615844e+02 3.90589263e-02]
mat_Sqrt:  [[ 2.02803091e+01  0.00000000e+00]
 [-7.90533251e-03  1.81133923e-02]]
grads:  [2.19152737e-03 1.06882600e+01]
Stock Position:  0.0021915273677646663
Bond Position:  [18.8175933]


portfolio before change:  [19.0456585]
curr_Stock_Price:  102.99339973217826
curr_Factors:  [1.02993400e+02 3.78268015e-02]
mat_Sqrt:  [[ 2.00313032e+01  0.00000000e+00]
 [-7.77964539e-03  1.78254069e-02]]
grads:  [-0.03388925 -3.34239566]
Stock Position:  -0.033889246824560675
Bond Position:  [22.53602725]


portfolio before change:  [19.01947704]
curr_Stock_Price:  103.8490882828739
curr_Factors:  [1.03849088e+02 3.71368314e-02]
mat_Sqrt:  [[ 2.00126735e+01  0.00000000e+00]
 [-7.70836755e-03  1.76620889e-02]]
grads:  [-0.00828191 -1.57277544]
Stock Position:  -0.008281907212806567
Bond Position:  [19.87954556]


portfolio before change:  [19.02581202]
curr_Stock_Price:  103.38423399750512
curr_Factors:  [1.03384234e+02 3.65664846e-02]
mat_Sqrt:  [[ 1.97695106e+01  0.00000000e+00]
 [-7.64894603e-03  1.75259371e-02]]
grads:  [ 0.00305559 -0.96450083]
Stock Position:  0.003055589582458378
Bond Position:  [18.70991223]


portfolio before change:  [19.02289062]
curr_Stock_Price:  101.66270531373728
curr_Factors:  [1.01662705e+02 3.67025193e-02]
mat_Sqrt:  [[ 1.94764410e+01  0.00000000e+00]
 [-7.66316063e-03  1.75585068e-02]]
grads:  [-0.01033833  8.09422686]
Stock Position:  -0.01033832641319907
Bond Position:  [20.07391285]


portfolio before change:  [19.02777702]
curr_Stock_Price:  101.43278413989157
curr_Factors:  [1.01432784e+02 3.65779602e-02]
mat_Sqrt:  [[ 1.93993906e+01  0.00000000e+00]
 [-7.65014616e-03  1.75286869e-02]]
grads:  [0.00476626 3.62758268]
Stock Position:  0.00476625565955232
Bond Position:  [18.54432244]


portfolio before change:  [19.02589796]
curr_Stock_Price:  100.55216703597345
curr_Factors:  [1.00552167e+02 3.71399939e-02]
mat_Sqrt:  [[ 1.93781516e+01  0.00000000e+00]
 [-7.70869576e-03  1.76628409e-02]]
grads:  [-4.44846592e-03  4.72029752e+00]
Stock Position:  -0.004448465922174413
Bond Position:  [19.47320085]


portfolio before change:  [19.03341095]
curr_Stock_Price:  99.41049524901862
curr_Factors:  [9.94104952e+01 3.95515261e-02]
mat_Sqrt:  [[ 1.97703274e+01  0.00000000e+00]
 [-7.95502620e-03  1.82272549e-02]]
grads:  [-0.00583446  5.8189964 ]
Stock Position:  -0.005834455353482684
Bond Position:  [19.61341704]


portfolio before change:  [19.03620488]
curr_Stock_Price:  99.35186075796639
curr_Factors:  [9.93518608e+01 4.06767956e-02]
mat_Sqrt:  [[ 2.00377693e+01  0.00000000e+00]
 [-8.06739567e-03  1.84847257e-02]]
grads:  [-4.67787424e-03 -7.73381611e+00]
Stock Position:  -0.004677874244711305
Bond Position:  [19.50096039]


portfolio before change:  [19.03428801]
curr_Stock_Price:  100.28276277952556
curr_Factors:  [1.00282763e+02 4.12468406e-02]
mat_Sqrt:  [[ 2.03667454e+01  0.00000000e+00]
 [-8.12372728e-03  1.86137976e-02]]
grads:  [ 8.02146169e-04 -9.32387875e-01]
Stock Position:  0.0008021461685719829
Bond Position:  [18.95384657]


portfolio before change:  [19.03582644]
curr_Stock_Price:  99.24685452234907
curr_Factors:  [9.92468545e+01 4.22729727e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.03582644]
Stock Price:  99.25143698945367
PL:  [19.03582644]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.06173449e+00  2.68938111e-01]
 [ 2.51460047e-01  1.03733804e-01]
 [-3.02058855e-01 -1.34326039e-01]
 [ 4.74846119e-02 -1.50878318e-01]
 [-1.20651305e-01 -4.50505571e-01]
 [-3.97426958e-01  2.38252741e-01]
 [ 3.29271617e-01 -3.84097219e-01]
 [-5.93033482e-01  1.97783306e-01]
 [-1.16310413e-01 -1.07591872e-01]
 [-8.27089936e-02 -3.22382838e-01]
 [-6.15646981e-02 -1.47116971e-02]
 [-3.13396996e-02 -1.34621711e-01]
 [-8.41879619e-02 -2.19171745e-02]
 [-3.80379548e-02 -4.14979709e-02]
 [ 4.05639243e-01  2.55311038e-01]
 [ 1.32936444e-01 -5.07036538e-01]
 [ 2.65349698e-02 -1.63505904e-01]
 [ 3.56892817e-02 -1.57516047e-01]
 [-1.23615140e-01 -3.56541258e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.03956665e-01 -1.64342704e-02]
 [ 2.94217928e-01 -4.50009176e-01]
 [ 2.71990942e-02 -3.38012978e-01]
 [ 1.31530864e-02  1.45818458e-01]
 [ 4.58725456e-01 -4.59116938e-01]
 [-3.89578657e-01  4.87408841e-02]
 [-1.28420555e-01  1.80138602e-01]
 [-1.25642641e-01 -2.31913786e-01]
 [-8.69206417e-02  2.16525525e-01]
 [-6.46037850e-01  3.10441911e-01]
 [-1.21595217e-01  1.91910961e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.47827084e-01  1.70623643e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.01338738e-01  2.56645499e-02]
 [-2.72033253e-02 -1.79418273e-01]
 [-1.05931750e-02 -6.38685939e-02]
 [ 1.37005104e-01 -1.96451739e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.61730819]
curr_Stock_Price:  101.15191583577632
curr_Factors:  [1.01151916e+02 3.92732452e-02]
mat_Sqrt:  [[ 2.00457591e+01  0.00000000e+00]
 [-7.92699138e-03  1.81630190e-02]]
grads:  [ 0.05882086 14.80690576]
Stock Position:  0.05882085566914025
Bond Position:  [4.66746595]


portfolio before change:  [10.57962305]
curr_Stock_Price:  100.50131992751184
curr_Factors:  [1.00501320e+02 4.07657118e-02]
mat_Sqrt:  [[ 2.02917396e+01  0.00000000e+00]
 [-8.07620820e-03  1.85049177e-02]]
grads:  [0.01462335 5.6057425 ]
Stock Position:  0.014623349035081818
Bond Position:  [9.10995717]


portfolio before change:  [10.60329048]
curr_Stock_Price:  102.04191188273884
curr_Factors:  [1.02041912e+02 4.14207510e-02]
mat_Sqrt:  [[ 2.07676603e+01  0.00000000e+00]
 [-8.14083544e-03  1.86529973e-02]]
grads:  [-0.01736756 -7.20131125]
Stock Position:  -0.017367557982862367
Bond Position:  [12.3755093]


portfolio before change:  [10.5972268]
curr_Stock_Price:  102.48012620389034
curr_Factors:  [1.02480126e+02 4.05987251e-02]
mat_Sqrt:  [[ 2.06488491e+01  0.00000000e+00]
 [-8.05965013e-03  1.84669784e-02]]
grads:  [-8.89351476e-04 -8.17016809e+00]
Stock Position:  -0.0008893514763392762
Bond Position:  [10.68836766]


portfolio before change:  [10.59865116]
curr_Stock_Price:  102.38092237305383
curr_Factors:  [1.02380922e+02 4.00457316e-02]
mat_Sqrt:  [[ 2.04878862e+01  0.00000000e+00]
 [-8.00457185e-03  1.83407782e-02]]
grads:  [-1.54856412e-02 -2.45630565e+01]
Stock Position:  -0.015485641214101741
Bond Position:  [12.18408539]


portfolio before change:  [10.59350706]
curr_Stock_Price:  102.81146330326656
curr_Factors:  [1.02811463e+02 3.94931919e-02]
mat_Sqrt:  [[ 2.04316132e+01  0.00000000e+00]
 [-7.94915763e-03  1.82138083e-02]]
grads:  [-0.0143623 13.0808855]
Stock Position:  -0.014362298981379093
Bond Position:  [12.07011604]


portfolio before change:  [10.58394643]
curr_Stock_Price:  103.58219632708726
curr_Factors:  [1.03582196e+02 3.83512686e-02]
mat_Sqrt:  [[ 2.02849986e+01  0.00000000e+00]
 [-7.83339197e-03  1.79485558e-02]]
grads:  [ 7.96834399e-03 -2.13998955e+01]
Stock Position:  0.007968343993144887
Bond Position:  [9.75856785]


portfolio before change:  [10.58031369]
curr_Stock_Price:  102.97320707824973
curr_Factors:  [1.02973207e+02 3.74534939e-02]
mat_Sqrt:  [[ 1.99283071e+01  0.00000000e+00]
 [-7.74116207e-03  1.77372306e-02]]
grads:  [-0.02542683 11.15074338]
Stock Position:  -0.02542683469556293
Bond Position:  [13.1985964]


portfolio before change:  [10.57656205]
curr_Stock_Price:  103.18564271909578
curr_Factors:  [1.03185643e+02 3.64371026e-02]
mat_Sqrt:  [[ 1.96965967e+01  0.00000000e+00]
 [-7.63540203e-03  1.74949039e-02]]
grads:  [-0.00828912 -6.14989784]
Stock Position:  -0.00828911502139308
Bond Position:  [11.43187971]


portfolio before change:  [10.58789525]
curr_Stock_Price:  101.99080685111475
curr_Factors:  [1.01990807e+02 3.60447140e-02]
mat_Sqrt:  [[ 1.93634090e+01  0.00000000e+00]
 [-7.59417819e-03  1.74004482e-02]]
grads:  [-1.15376584e-02 -1.85272721e+01]
Stock Position:  -0.011537658419179041
Bond Position:  [11.76463035]


portfolio before change:  [10.58934786]
curr_Stock_Price:  101.99237298081556
curr_Factors:  [1.01992373e+02 3.51883802e-02]
mat_Sqrt:  [[ 1.91323067e+01  0.00000000e+00]
 [-7.50342644e-03  1.71925098e-02]]
grads:  [-0.00355344 -0.85570387]
Stock Position:  -0.003553435043048203
Bond Position:  [10.95177113]


portfolio before change:  [10.58978646]
curr_Stock_Price:  102.25422044143187
curr_Factors:  [1.02254220e+02 3.58472901e-02]
mat_Sqrt:  [[ 1.93601807e+01  0.00000000e+00]
 [-7.57335224e-03  1.73527299e-02]]
grads:  [-4.65354287e-03 -7.75795572e+00]
Stock Position:  -0.004653542866556591
Bond Position:  [11.06563085]


portfolio before change:  [10.59756343]
curr_Stock_Price:  100.88028066865235
curr_Factors:  [1.00880281e+02 3.51627694e-02]
mat_Sqrt:  [[ 1.89168064e+01  0.00000000e+00]
 [-7.50069537e-03  1.71862522e-02]]
grads:  [-0.00495609 -1.27527365]
Stock Position:  -0.004956090329388049
Bond Position:  [11.09753522]


portfolio before change:  [10.59774919]
curr_Stock_Price:  101.1227144601141
curr_Factors:  [1.01122714e+02 3.52793956e-02]
mat_Sqrt:  [[ 1.89936875e+01  0.00000000e+00]
 [-7.51312405e-03  1.72147298e-02]]
grads:  [-0.0029562  -2.41060831]
Stock Position:  -0.002956200800752169
Bond Position:  [10.89668824]


portfolio before change:  [10.60056117]
curr_Stock_Price:  100.63228544962234
curr_Factors:  [1.00632285e+02 3.61195548e-02]
mat_Sqrt:  [[ 1.91253121e+01  0.00000000e+00]
 [-7.60205812e-03  1.74185034e-02]]
grads:  [ 0.0270357 14.6574612]
Stock Position:  0.02703569559003684
Bond Position:  [7.87989733]


portfolio before change:  [10.63778805]
curr_Stock_Price:  101.9728034980189
curr_Factors:  [1.01972803e+02 3.69213305e-02]
mat_Sqrt:  [[ 1.95939967e+01  0.00000000e+00]
 [-7.68596960e-03  1.76107687e-02]]
grads:  [-4.50915883e-03 -2.87912779e+01]
Stock Position:  -0.004509158827441672
Bond Position:  [11.09759962]


portfolio before change:  [10.63480291]
curr_Stock_Price:  102.94248145198668
curr_Factors:  [1.02942481e+02 3.73025950e-02]
mat_Sqrt:  [[ 1.98821871e+01  0.00000000e+00]
 [-7.72555189e-03  1.77014632e-02]]
grads:  [-2.25452345e-03 -9.23685813e+00]
Stock Position:  -0.0022545234521001625
Bond Position:  [10.86688915]


portfolio before change:  [10.63381386]
curr_Stock_Price:  103.98371629637303
curr_Factors:  [1.03983716e+02 3.70567962e-02]
mat_Sqrt:  [[ 2.00170129e+01  0.00000000e+00]
 [-7.70005674e-03  1.76430464e-02]]
grads:  [-1.65141309e-03 -8.92793924e+00]
Stock Position:  -0.001651413087848062
Bond Position:  [10.80553393]


portfolio before change:  [10.63433298]
curr_Stock_Price:  104.48731976060776
curr_Factors:  [1.04487320e+02 3.82673309e-02]
mat_Sqrt:  [[ 2.04398486e+01  0.00000000e+00]
 [-7.82481498e-03  1.79289035e-02]]
grads:  [-1.36606933e-02 -1.98863951e+01]
Stock Position:  -0.013660693259188849
Bond Position:  [12.06170221]


portfolio before change:  [10.63748407]
curr_Stock_Price:  104.3670270289772
curr_Factors:  [1.04367027e+02 3.89457701e-02]
mat_Sqrt:  [[ 2.05965016e+01  0.00000000e+00]
 [-7.89387308e-03  1.80871355e-02]]
grads:  [-2.35287871e-04 -6.03154599e+00]
Stock Position:  -0.00023528787054083325
Bond Position:  [10.66204037]


portfolio before change:  [10.63843163]
curr_Stock_Price:  106.00451663299427
curr_Factors:  [1.06004517e+02 3.84509006e-02]
mat_Sqrt:  [[ 2.07863209e+01  0.00000000e+00]
 [-7.84356048e-03  1.79718548e-02]]
grads:  [ 0.00465615 -0.91444487]
Stock Position:  0.004656146777259628
Bond Position:  [10.14485904]


portfolio before change:  [10.64149829]
curr_Stock_Price:  106.3907740116716
curr_Factors:  [1.06390774e+02 3.80507293e-02]
mat_Sqrt:  [[ 2.07532186e+01  0.00000000e+00]
 [-7.80263845e-03  1.78780907e-02]]
grads:  [ 4.71338081e-03 -2.51709863e+01]
Stock Position:  0.004713380813324087
Bond Position:  [10.14003805]


portfolio before change:  [10.64119263]
curr_Stock_Price:  106.05699167222464
curr_Factors:  [1.06056992e+02 3.90881382e-02]
mat_Sqrt:  [[ 2.09682312e+01  0.00000000e+00]
 [-7.90828813e-03  1.81201645e-02]]
grads:  [-5.73829345e-03 -1.86539685e+01]
Stock Position:  -0.005738293445781511
Bond Position:  [11.24977877]


portfolio before change:  [10.63704441]
curr_Stock_Price:  107.02496661244234
curr_Factors:  [1.07024967e+02 3.79901324e-02]
mat_Sqrt:  [[ 2.08602978e+01  0.00000000e+00]
 [-7.79642301e-03  1.78638493e-02]]
grads:  [3.68132228e-03 8.16276805e+00]
Stock Position:  0.0036813222777768626
Bond Position:  [10.24305102]


portfolio before change:  [10.63473553]
curr_Stock_Price:  106.04995038581397
curr_Factors:  [1.06049950e+02 3.88394467e-02]
mat_Sqrt:  [[ 2.09000337e+01  0.00000000e+00]
 [-7.88309042e-03  1.80624293e-02]]
grads:  [ 1.23612431e-02 -2.54183383e+01]
Stock Position:  0.012361243080470452
Bond Position:  [9.32382631]


portfolio before change:  [10.62906225]
curr_Stock_Price:  105.49670309933359
curr_Factors:  [1.05496703e+02 3.89242810e-02]
mat_Sqrt:  [[ 2.08136950e+01  0.00000000e+00]
 [-7.89169497e-03  1.80821448e-02]]
grads:  [-0.01769539  2.69552559]
Stock Position:  -0.01769538712606816
Bond Position:  [12.49586726]


portfolio before change:  [10.61345916]
curr_Stock_Price:  106.46673977654808
curr_Factors:  [1.06466740e+02 3.86377028e-02]
mat_Sqrt:  [[ 2.09276086e+01  0.00000000e+00]
 [-7.86259019e-03  1.80154573e-02]]
grads:  [-2.37970925e-03  9.99911345e+00]
Stock Position:  -0.0023797092500470757
Bond Position:  [10.86681905]


portfolio before change:  [10.61357027]
curr_Stock_Price:  106.99088879922071
curr_Factors:  [1.06990889e+02 3.83072668e-02]
mat_Sqrt:  [[ 2.09405160e+01  0.00000000e+00]
 [-7.82889692e-03  1.79382564e-02]]
grads:  [-1.08334539e-02 -1.29284464e+01]
Stock Position:  -0.010833453936020676
Bond Position:  [11.77265114]


portfolio before change:  [10.62595337]
curr_Stock_Price:  105.98369145989754
curr_Factors:  [1.05983691e+02 3.96566728e-02]
mat_Sqrt:  [[ 2.11055745e+01  0.00000000e+00]
 [-7.96559329e-03  1.82514671e-02]]
grads:  [3.59092076e-04 1.18634586e+01]
Stock Position:  0.00035909207619120236
Bond Position:  [10.58789547]


portfolio before change:  [10.62736962]
curr_Stock_Price:  106.24176708143135
curr_Factors:  [1.06241767e+02 3.99790896e-02]
mat_Sqrt:  [[ 2.12427988e+01  0.00000000e+00]
 [-7.99790868e-03  1.83255110e-02]]
grads:  [-0.02403402 16.94042317]
Stock Position:  -0.024034021959721173
Bond Position:  [13.18078658]


portfolio before change:  [10.61928903]
curr_Stock_Price:  106.64653848067505
curr_Factors:  [1.06646538e+02 3.77612873e-02]
mat_Sqrt:  [[ 2.07238366e+01  0.00000000e+00]
 [-7.77290548e-03  1.78099639e-02]]
grads:  [-0.00546325  1.07754829]
Stock Position:  -0.005463251701028084
Bond Position:  [11.20192592]


portfolio before change:  [10.62955475]
curr_Stock_Price:  105.02380734030369
curr_Factors:  [1.05023807e+02 3.83630562e-02]
mat_Sqrt:  [[ 2.05704768e+01  0.00000000e+00]
 [-7.83459571e-03  1.79513139e-02]]
grads:  [ 0.00352654 -0.66553285]
Stock Position:  0.0035265393975112214
Bond Position:  [10.25918416]


portfolio before change:  [10.62920057]
curr_Stock_Price:  104.5597099810998
curr_Factors:  [1.04559710e+02 3.86164159e-02]
mat_Sqrt:  [[ 2.05470913e+01  0.00000000e+00]
 [-7.86042400e-03  1.80104940e-02]]
grads:  [-0.011699    0.94735682]
Stock Position:  -0.011699001763498798
Bond Position:  [11.8524448]


portfolio before change:  [10.62392379]
curr_Stock_Price:  105.13740284932078
curr_Factors:  [1.05137403e+02 3.73452872e-02]
mat_Sqrt:  [[ 2.03177282e+01  0.00000000e+00]
 [-7.72997151e-03  1.77115898e-02]]
grads:  [0.00499422 3.01209894]
Stock Position:  0.004994218380846067
Bond Position:  [10.09884464]


portfolio before change:  [10.61683364]
curr_Stock_Price:  103.46495207490213
curr_Factors:  [1.03464952e+02 3.92822419e-02]
mat_Sqrt:  [[ 2.05064930e+01  0.00000000e+00]
 [-7.92789928e-03  1.81650993e-02]]
grads:  [-0.00461647  4.47699982]
Stock Position:  -0.004616470055017063
Bond Position:  [11.09447649]


portfolio before change:  [10.61830835]
curr_Stock_Price:  103.44592936311138
curr_Factors:  [1.03445929e+02 3.91648804e-02]
mat_Sqrt:  [[ 2.04720724e+01  0.00000000e+00]
 [-7.91604753e-03  1.81379435e-02]]
grads:  [-0.01417237  1.41496471]
Stock Position:  -0.014172371256273016
Bond Position:  [12.08438247]


portfolio before change:  [10.61049389]
curr_Stock_Price:  104.10390688919179
curr_Factors:  [1.04103907e+02 3.71789136e-02]
mat_Sqrt:  [[ 2.00731429e+01  0.00000000e+00]
 [-7.71273375e-03  1.76720931e-02]]
grads:  [-5.25617139e-03 -1.01526329e+01]
Stock Position:  -0.005256171389694792
Bond Position:  [11.15768187]


portfolio before change:  [10.60761066]
curr_Stock_Price:  104.91781285970146
curr_Factors:  [1.04917813e+02 3.54298314e-02]
mat_Sqrt:  [[ 1.97484844e+01  0.00000000e+00]
 [-7.52912547e-03  1.72513937e-02]]
grads:  [-1.94788186e-03 -3.70222807e+00]
Stock Position:  -0.0019478818636542662
Bond Position:  [10.81197817]


portfolio before change:  [10.60807122]
curr_Stock_Price:  105.3752468094114
curr_Factors:  [1.05375247e+02 3.43931419e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.60807122]
Stock Price:  106.21238637454194
PL:  [4.39568484]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.00961047e+00  2.57153914e-01]
 [ 4.60871250e-01  1.24966671e-01]
 [ 1.05591468e-01 -4.68388841e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.51576112e-02  1.95935213e-01]
 [-2.50683263e-01  6.85720693e-02]
 [ 1.22983949e-01 -5.18107319e-02]
 [ 2.92980602e-02  3.97902674e-01]
 [-4.75745155e-02  1.89040105e-01]
 [ 1.82255222e-01  4.89289072e-02]
 [-1.15219717e-01  3.02250875e-04]
 [ 3.06472100e-02 -1.35929019e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-5.32987531e-02 -1.71049078e-02]
 [ 4.33503216e-01  2.74688518e-01]
 [ 1.30686775e-01  7.50395846e-02]
 [ 4.08716950e-02  1.22880324e-01]
 [ 5.61047546e-02  7.52217076e-02]
 [ 6.23445566e-02  7.00728245e-02]
 [-4.80663865e-01  2.03982758e-01]
 [ 1.11945828e-01  6.09946000e-02]
 [ 1.39583282e+00  1.53094849e-01]
 [ 1.63446356e-02  3.64813887e-01]
 [-1.34536959e-01  1.17478807e-01]
 [-1.71589063e-01  1.85573506e-01]
 [ 1.78468208e-01 -8.58849001e-02]
 [-1.09970676e-02 -4.55348520e-01]
 [ 6.78995108e-02  5.77015471e-02]
 [ 4.80604698e-01 -2.83463161e-01]
 [-5.14499916e-01 -2.58662812e-01]
 [ 1.00304449e-02  6.77085025e-03]
 [-6.26540785e-02  6.09237819e-02]
 [ 1.76891953e-01  2.01837399e-01]
 [ 3.40273094e-02 -2.02409733e-02]
 [ 2.15938541e-01 -1.61898726e-01]
 [ 6.37433836e-02  1.00757350e-01]
 [-5.50919951e-02  1.59414131e-01]
 [-2.89243964e-01 -1.09259718e-01]
 [ 1.23945744e-01 -7.41712054e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.81945568]
curr_Stock_Price:  101.61672344313084
curr_Factors:  [1.01616723e+02 3.93527389e-02]
mat_Sqrt:  [[ 2.01582427e+01  0.00000000e+00]
 [-7.93500991e-03  1.81813918e-02]]
grads:  [ 0.05565176 14.14379699]
Stock Position:  0.05565175774649146
Bond Position:  [8.1643064]


portfolio before change:  [13.72286727]
curr_Stock_Price:  99.86279830855482
curr_Factors:  [9.98627983e+01 3.93810822e-02]
mat_Sqrt:  [[ 1.98174401e+01  0.00000000e+00]
 [-7.93786694e-03  1.81879381e-02]]
grads:  [0.02600796 6.87085421]
Stock Position:  0.026007959297426005
Bond Position:  [11.12563967]


portfolio before change:  [13.7021534]
curr_Stock_Price:  99.01287917374599
curr_Factors:  [9.90128792e+01 4.11239762e-02]
mat_Sqrt:  [[ 2.00788687e+01  0.00000000e+00]
 [-8.11161895e-03  1.85860539e-02]]
grads:  [ 0.00424074 -2.52010912]
Stock Position:  0.0042407420561744276
Bond Position:  [13.28226531]


portfolio before change:  [13.6996958]
curr_Stock_Price:  98.041827482408
curr_Factors:  [9.80418275e+01 4.16898431e-02]
mat_Sqrt:  [[ 2.00182693e+01  0.00000000e+00]
 [-8.16723632e-03  1.87134893e-02]]
grads:  [-8.14324489e-04 -8.08971592e+00]
Stock Position:  -0.0008143244890533155
Bond Position:  [13.77953366]


portfolio before change:  [13.70066184]
curr_Stock_Price:  98.97083947976527
curr_Factors:  [9.89708395e+01 4.34020791e-02]
mat_Sqrt:  [[ 2.06187589e+01  0.00000000e+00]
 [-8.33326626e-03  1.90939117e-02]]
grads:  [5.02238112e-04 1.02616591e+01]
Stock Position:  0.0005022381124006291
Bond Position:  [13.65095491]


portfolio before change:  [13.70329149]
curr_Stock_Price:  100.80896902938014
curr_Factors:  [1.00808969e+02 4.19247411e-02]
mat_Sqrt:  [[ 2.06411727e+01  0.00000000e+00]
 [-8.19021281e-03  1.87661351e-02]]
grads:  [-0.01069493  3.6540326 ]
Stock Position:  -0.010694932937806953
Bond Position:  [14.78143665]


portfolio before change:  [13.70442408]
curr_Stock_Price:  100.87584273775461
curr_Factors:  [1.00875843e+02 4.19384496e-02]
mat_Sqrt:  [[ 2.06582420e+01  0.00000000e+00]
 [-8.19155171e-03  1.87692029e-02]]
grads:  [ 0.00485869 -2.76041195]
Stock Position:  0.00485868503805608
Bond Position:  [13.21430013]


portfolio before change:  [13.70720718]
curr_Stock_Price:  101.10866506384772
curr_Factors:  [1.01108665e+02 4.22198178e-02]
mat_Sqrt:  [[ 2.07752641e+01  0.00000000e+00]
 [-8.21898464e-03  1.88320596e-02]]
grads:  [9.76916699e-03 2.11290046e+01]
Stock Position:  0.009769166986882969
Bond Position:  [12.71945974]


portfolio before change:  [13.69066125]
curr_Stock_Price:  99.25221666882146
curr_Factors:  [9.92522167e+01 4.24750112e-02]
mat_Sqrt:  [[ 2.04553524e+01  0.00000000e+00]
 [-8.24378662e-03  1.88888881e-02]]
grads:  [1.70758976e-03 1.00080060e+01]
Stock Position:  0.001707589757118747
Bond Position:  [13.52117919]


portfolio before change:  [13.69244358]
curr_Stock_Price:  99.30613870432606
curr_Factors:  [9.93061387e+01 4.24988876e-02]
mat_Sqrt:  [[ 2.04722170e+01  0.00000000e+00]
 [-8.24610333e-03  1.88941964e-02]]
grads:  [0.00994565 2.58962627]
Stock Position:  0.00994565208265574
Bond Position:  [12.70477928]


portfolio before change:  [13.69474232]
curr_Stock_Price:  99.37758107686713
curr_Factors:  [9.93775811e+01 4.35840978e-02]
mat_Sqrt:  [[ 2.07468636e+01  0.00000000e+00]
 [-8.35072191e-03  1.91339076e-02]]
grads:  [-0.00554724  0.01579661]
Stock Position:  -0.005547238643885524
Bond Position:  [14.24601348]


portfolio before change:  [13.70222012]
curr_Stock_Price:  98.35059538835715
curr_Factors:  [9.83505954e+01 4.50827992e-02]
mat_Sqrt:  [[ 2.08824971e+01  0.00000000e+00]
 [-8.49308417e-03  1.94601005e-02]]
grads:  [-1.37325901e-03 -6.98501112e+00]
Stock Position:  -0.001373259011097751
Bond Position:  [13.83728096]


portfolio before change:  [13.70312539]
curr_Stock_Price:  98.9509901612764
curr_Factors:  [9.89509902e+01 4.60075997e-02]
mat_Sqrt:  [[ 2.12243761e+01  0.00000000e+00]
 [-8.57975289e-03  1.96586835e-02]]
grads:  [-0.00609436 -1.42692185]
Stock Position:  -0.006094355267387461
Bond Position:  [14.30616788]


portfolio before change:  [13.70265346]
curr_Stock_Price:  99.32187668556847
curr_Factors:  [9.93218767e+01 4.63036152e-02]
mat_Sqrt:  [[ 2.13723544e+01  0.00000000e+00]
 [-8.60730993e-03  1.97218246e-02]]
grads:  [-0.00284311 -0.86730858]
Stock Position:  -0.0028431096439609214
Bond Position:  [13.98503644]


portfolio before change:  [13.70191783]
curr_Stock_Price:  100.19552035804755
curr_Factors:  [1.0019552e+02 4.5387383e-02]
mat_Sqrt:  [[ 2.13459691e+01  0.00000000e+00]
 [-8.52172593e-03  1.95257271e-02]]
grads:  [ 0.02592467 14.06803022]
Stock Position:  0.025924665746958713
Bond Position:  [11.10438246]


portfolio before change:  [13.6288988]
curr_Stock_Price:  97.3253900322295
curr_Factors:  [9.73253900e+01 4.43827444e-02]
mat_Sqrt:  [[ 2.05037468e+01  0.00000000e+00]
 [-8.42688502e-03  1.93084192e-02]]
grads:  [0.00797107 3.88636603]
Stock Position:  0.007971066795981712
Bond Position:  [12.85311161]


portfolio before change:  [13.62375031]
curr_Stock_Price:  96.47792132026039
curr_Factors:  [9.64779213e+01 4.27840490e-02]
mat_Sqrt:  [[ 1.99557879e+01  0.00000000e+00]
 [-8.27372216e-03  1.89574790e-02]]
grads:  [4.73552163e-03 6.48189161e+00]
Stock Position:  0.004735521632639684
Bond Position:  [13.16687702]


portfolio before change:  [13.63071885]
curr_Stock_Price:  97.6018903177567
curr_Factors:  [9.76018903e+01 4.19097831e-02]
mat_Sqrt:  [[ 1.99809409e+01  0.00000000e+00]
 [-8.18875162e-03  1.87627871e-02]]
grads:  [0.00445095 4.0090903 ]
Stock Position:  0.004450951515175903
Bond Position:  [13.19629757]


portfolio before change:  [13.62488911]
curr_Stock_Price:  95.92148921694024
curr_Factors:  [9.59214892e+01 4.23862618e-02]
mat_Sqrt:  [[ 1.97482434e+01  0.00000000e+00]
 [-8.23516963e-03  1.88691441e-02]]
grads:  [0.00470558 3.71361966]
Stock Position:  0.004705575205598797
Bond Position:  [13.17352332]


portfolio before change:  [13.62455646]
curr_Stock_Price:  95.50083011257867
curr_Factors:  [9.55008301e+01 4.13596204e-02]
mat_Sqrt:  [[ 1.94220657e+01  0.00000000e+00]
 [-8.13482592e-03  1.86392278e-02]]
grads:  [-0.02016462 10.94373437]
Stock Position:  -0.020164615733987014
Bond Position:  [15.550294]


portfolio before change:  [13.61888644]
curr_Stock_Price:  95.87841860682086
curr_Factors:  [9.58784186e+01 4.05958709e-02]
mat_Sqrt:  [[ 1.93179836e+01  0.00000000e+00]
 [-8.05936681e-03  1.84663292e-02]]
grads:  [0.0071729  3.30301703]
Stock Position:  0.007172904639384979
Bond Position:  [12.93115968]


portfolio before change:  [13.62113356]
curr_Stock_Price:  95.96633653395203
curr_Factors:  [9.59663365e+01 4.16445304e-02]
mat_Sqrt:  [[ 1.95838422e+01  0.00000000e+00]
 [-8.16279662e-03  1.87033167e-02]]
grads:  [0.07468651 8.18543851]
Stock Position:  0.07468651348088705
Bond Position:  [6.45374247]


portfolio before change:  [13.68658286]
curr_Stock_Price:  96.83185468375689
curr_Factors:  [9.68318547e+01 4.22257531e-02]
mat_Sqrt:  [[ 1.98978866e+01  0.00000000e+00]
 [-8.21956234e-03  1.88333833e-02]]
grads:  [8.82317164e-03 1.93705975e+01]
Stock Position:  0.008823171644473542
Bond Position:  [12.83221879]


portfolio before change:  [13.6842717]
curr_Stock_Price:  96.38810406048891
curr_Factors:  [9.63881041e+01 4.28190531e-02]
mat_Sqrt:  [[ 1.99453640e+01  0.00000000e+00]
 [-8.27710607e-03  1.89652326e-02]]
grads:  [-4.17465454e-03  6.19443011e+00]
Stock Position:  -0.004174654535816918
Bond Position:  [14.08665874]


portfolio before change:  [13.68475547]
curr_Stock_Price:  96.6940389310615
curr_Factors:  [9.66940389e+01 4.11574934e-02]
mat_Sqrt:  [[ 1.96166191e+01  0.00000000e+00]
 [-8.11492387e-03  1.85936264e-02]]
grads:  [-4.61843832e-03  9.98049015e+00]
Stock Position:  -0.004618438317956555
Bond Position:  [14.13133093]


portfolio before change:  [13.68985256]
curr_Stock_Price:  95.97289352415325
curr_Factors:  [9.59728935e+01 4.13236528e-02]
mat_Sqrt:  [[ 1.95095809e+01  0.00000000e+00]
 [-8.13128799e-03  1.86311214e-02]]
grads:  [ 0.00722645 -4.60975475]
Stock Position:  0.007226447603617794
Bond Position:  [12.99630948]


portfolio before change:  [13.68491015]
curr_Stock_Price:  95.06414096790144
curr_Factors:  [9.50641410e+01 4.03416505e-02]
mat_Sqrt:  [[ 1.90938523e+01  0.00000000e+00]
 [-8.03409241e-03  1.84084183e-02]]
grads:  [-1.09840304e-02 -2.47358851e+01]
Stock Position:  -0.01098403040073802
Bond Position:  [14.72909756]


portfolio before change:  [13.67345106]
curr_Stock_Price:  96.2750213352831
curr_Factors:  [9.62750213e+01 3.98417160e-02]
mat_Sqrt:  [[ 1.92168695e+01  0.00000000e+00]
 [-7.98415591e-03  1.82939994e-02]]
grads:  [0.00484379 3.15412425]
Stock Position:  0.004843792611176098
Bond Position:  [13.20711482]


portfolio before change:  [13.66800409]
curr_Stock_Price:  94.80964885891169
curr_Factors:  [9.48096489e+01 3.97269456e-02]
mat_Sqrt:  [[ 1.88970985e+01  0.00000000e+00]
 [-7.97264780e-03  1.82676310e-02]]
grads:  [  0.01888603 -15.51723706]
Stock Position:  0.018886033382398398
Bond Position:  [11.87742589]


portfolio before change:  [13.67158188]
curr_Stock_Price:  94.92047254180008
curr_Factors:  [9.49204725e+01 4.04561213e-02]
mat_Sqrt:  [[ 1.90920258e+01  0.00000000e+00]
 [-8.04548284e-03  1.84345170e-02]]
grads:  [ -0.03286134 -14.03143956]
Stock Position:  -0.0328613437123614
Bond Position:  [16.79079615]


portfolio before change:  [13.63656326]
curr_Stock_Price:  96.04999414767008
curr_Factors:  [9.60499941e+01 3.96647294e-02]
mat_Sqrt:  [[ 1.91293226e+01  0.00000000e+00]
 [-7.96640239e-03  1.82533210e-02]]
grads:  [0.00067883 0.37093799]
Stock Position:  0.00067882624278996
Bond Position:  [13.57136201]


portfolio before change:  [13.63819925]
curr_Stock_Price:  95.96081462197813
curr_Factors:  [9.59608146e+01 3.76877066e-02]
mat_Sqrt:  [[ 1.86291818e+01  0.00000000e+00]
 [-7.76532874e-03  1.77926034e-02]]
grads:  [-1.93592830e-03  3.42410723e+00]
Stock Position:  -0.0019359282964647039
Bond Position:  [13.82397251]


portfolio before change:  [13.63905337]
curr_Stock_Price:  96.41226985260211
curr_Factors:  [9.64122699e+01 3.85868548e-02]
mat_Sqrt:  [[ 1.89387799e+01  0.00000000e+00]
 [-7.85741482e-03  1.80035991e-02]]
grads:  [ 0.01399145 11.21094721]
Stock Position:  0.013991451229829225
Bond Position:  [12.2901058]


portfolio before change:  [13.62304423]
curr_Stock_Price:  95.15825427857986
curr_Factors:  [9.51582543e+01 4.09501384e-02]
mat_Sqrt:  [[ 1.92563581e+01  0.00000000e+00]
 [-8.09445622e-03  1.85467292e-02]]
grads:  [ 0.00130832 -1.09135002]
Stock Position:  0.0013083171976820444
Bond Position:  [13.49854705]


portfolio before change:  [13.6246626]
curr_Stock_Price:  95.10547157549465
curr_Factors:  [9.51054716e+01 4.07239429e-02]
mat_Sqrt:  [[ 1.91924498e+01  0.00000000e+00]
 [-8.07206966e-03  1.84954351e-02]]
grads:  [ 7.56965085e-03 -8.75344242e+00]
Stock Position:  0.007569650850256647
Bond Position:  [12.90474739]


portfolio before change:  [13.62669399]
curr_Stock_Price:  95.16071772365136
curr_Factors:  [9.51607177e+01 4.09424472e-02]
mat_Sqrt:  [[ 1.92550481e+01  0.00000000e+00]
 [-8.09369604e-03  1.85449874e-02]]
grads:  [0.00559425 5.43313125]
Stock Position:  0.005594247070637524
Bond Position:  [13.09434142]


portfolio before change:  [13.62633434]
curr_Stock_Price:  94.80382500345615
curr_Factors:  [9.4803825e+01 4.2863879e-02]
mat_Sqrt:  [[ 1.96277987e+01  0.00000000e+00]
 [-8.28143746e-03  1.89751570e-02]]
grads:  [7.37832901e-04 8.40120222e+00]
Stock Position:  0.0007378329008659849
Bond Position:  [13.55638496]


portfolio before change:  [13.62855195]
curr_Stock_Price:  95.51259616025551
curr_Factors:  [9.55125962e+01 4.30394005e-02]
mat_Sqrt:  [[ 1.98149854e+01  0.00000000e+00]
 [-8.29837579e-03  1.90139676e-02]]
grads:  [-0.01700374 -5.74628714]
Stock Position:  -0.017003737721391958
Bond Position:  [15.25262308]


portfolio before change:  [13.61451207]
curr_Stock_Price:  96.45042361671703
curr_Factors:  [9.64504236e+01 4.16863106e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.61451207]
Stock Price:  97.80759245181866
PL:  [13.61451207]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.49343500e+00  5.90273050e-01]
 [ 1.64013769e+00  1.73245164e-02]
 [ 8.28470923e-02 -1.77393814e-03]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.53331570e-02  1.25714622e-01]
 [-1.14494613e-01 -7.85771755e-02]
 [ 1.03791892e-01  6.01145719e-03]
 [-1.16882102e-01  3.58142348e-01]
 [-1.14877116e-01 -8.35182959e-02]
 [ 1.80508498e-01  4.33376207e-02]
 [-6.13403424e-02 -1.46994015e-02]
 [ 3.19845756e-03 -1.36113807e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.58143431e-02 -4.31348788e-02]
 [ 2.69681686e-01  1.55962090e-01]
 [ 1.34775838e-01 -4.84733380e-01]
 [ 2.48096371e-02 -1.81871610e-01]
 [ 3.51088140e-02 -1.56883145e-01]
 [-1.18438333e-01 -4.24817724e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.16455326e-01 -2.04423460e-02]
 [ 3.99134870e-01 -3.46541047e-01]
 [ 3.07648777e-02 -4.26535194e-01]
 [ 3.14060202e-02  1.58403933e-02]
 [ 8.31366333e-02 -2.27850499e-02]
 [ 1.23693522e-01 -1.05602247e-01]
 [-2.15569434e-01 -4.45351544e-01]
 [ 6.63558978e-02  6.09874933e-02]
 [ 2.72233304e-01 -4.00343146e-02]
 [-5.27690093e-01 -1.99917749e-01]
 [-1.64473426e-01 -5.86204605e-02]
 [-4.38564849e-02  2.88173370e-02]
 [ 3.21573856e-01  2.14601121e-01]
 [ 3.10540589e-02 -1.65663005e-02]
 [ 2.21135879e-01 -1.62063386e-01]
 [ 8.18930451e-02  8.63022439e-02]
 [-5.52356876e-02  1.61741650e-01]
 [-3.57139280e-01 -1.36396629e-01]
 [ 1.44388683e-01  4.62128287e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.88472819]
curr_Stock_Price:  97.15985870258048
curr_Factors:  [9.71598587e+01 4.31222596e-02]
mat_Sqrt:  [[ 2.01761189e+01  0.00000000e+00]
 [-8.30635993e-03  1.90322616e-02]]
grads:  [ 0.08678831 31.01434099]
Stock Position:  0.08678831062092435
Bond Position:  [-25.31706819]


portfolio before change:  [-16.93454142]
curr_Stock_Price:  96.62236243530421
curr_Factors:  [9.66223624e+01 4.34815385e-02]
mat_Sqrt:  [[ 2.01479147e+01  0.00000000e+00]
 [-8.34089093e-03  1.91113820e-02]]
grads:  [0.08178011 0.90650254]
Stock Position:  0.08178011246112554
Bond Position:  [-24.83632908]


portfolio before change:  [-16.78818366]
curr_Stock_Price:  98.44997665865831
curr_Factors:  [9.84499767e+01 4.33303787e-02]
mat_Sqrt:  [[ 2.04932982e+01  0.00000000e+00]
 [-8.32638012e-03  1.90781336e-02]]
grads:  [ 0.00400486 -0.09298279]
Stock Position:  0.0040048644849632895
Bond Position:  [-17.18246247]


portfolio before change:  [-16.78585668]
curr_Stock_Price:  99.56734748449229
curr_Factors:  [9.95673475e+01 4.34560435e-02]
mat_Sqrt:  [[ 2.07559220e+01  0.00000000e+00]
 [-8.33844528e-03  1.91057783e-02]]
grads:  [-7.85383901e-04 -7.92361399e+00]
Stock Position:  -0.0007853839009435014
Bond Position:  [-16.70765809]


portfolio before change:  [-16.78836184]
curr_Stock_Price:  100.09775578893563
curr_Factors:  [1.00097756e+02 4.22148265e-02]
mat_Sqrt:  [[ 2.05663321e+01  0.00000000e+00]
 [-8.21849880e-03  1.88309464e-02]]
grads:  [-1.48139189e-03  6.67595879e+00]
Stock Position:  -0.0014813918932962743
Bond Position:  [-16.64007784]


portfolio before change:  [-16.7894049]
curr_Stock_Price:  99.39768438721889
curr_Factors:  [9.93976844e+01 4.27431436e-02]
mat_Sqrt:  [[ 2.05498898e+01  0.00000000e+00]
 [-8.26976601e-03  1.89484144e-02]]
grads:  [-0.00724036 -4.14689979]
Stock Position:  -0.007240355334030484
Bond Position:  [-16.06973035]


portfolio before change:  [-16.79971597]
curr_Stock_Price:  100.54434449162352
curr_Factors:  [1.00544344e+02 4.22196316e-02]
mat_Sqrt:  [[ 2.06592650e+01  0.00000000e+00]
 [-8.21896652e-03  1.88320181e-02]]
grads:  [0.00515098 0.31921471]
Stock Position:  0.005150982239476194
Bond Position:  [-17.3176181]


portfolio before change:  [-16.79686822]
curr_Stock_Price:  101.51747678775435
curr_Factors:  [1.01517477e+02 4.06790973e-02]
mat_Sqrt:  [[ 2.04751206e+01  0.00000000e+00]
 [-8.06762392e-03  1.84852486e-02]]
grads:  [1.92546034e-03 1.93744945e+01]
Stock Position:  0.0019254603393901422
Bond Position:  [-16.99233609]


portfolio before change:  [-16.79970422]
curr_Stock_Price:  101.14778620448492
curr_Factors:  [1.01147786e+02 4.15499444e-02]
mat_Sqrt:  [[ 2.06177659e+01  0.00000000e+00]
 [-8.15352138e-03  1.86820645e-02]]
grads:  [-0.00733966 -4.47050678]
Stock Position:  -0.007339664685429326
Bond Position:  [-16.05731338]


portfolio before change:  [-16.79505975]
curr_Stock_Price:  100.24151005865833
curr_Factors:  [1.00241510e+02 4.15515704e-02]
mat_Sqrt:  [[ 2.04334322e+01  0.00000000e+00]
 [-8.15368092e-03  1.86824300e-02]]
grads:  [0.00975962 2.31969935]
Stock Position:  0.009759622596873267
Bond Position:  [-17.77337905]


portfolio before change:  [-16.77947444]
curr_Stock_Price:  102.06608056402554
curr_Factors:  [1.02066081e+02 4.03244293e-02]
mat_Sqrt:  [[ 2.04958320e+01  0.00000000e+00]
 [-8.03237741e-03  1.84044887e-02]]
grads:  [-0.00330583 -0.79868567]
Stock Position:  -0.0033058276013835384
Bond Position:  [-16.44206157]


portfolio before change:  [-16.77769968]
curr_Stock_Price:  100.90747813939132
curr_Factors:  [1.00907478e+02 3.93557382e-02]
mat_Sqrt:  [[ 2.00183088e+01  0.00000000e+00]
 [-7.93531229e-03  1.81820846e-02]]
grads:  [-2.80775358e-03 -7.48614969e+00]
Stock Position:  -0.0028077535758778277
Bond Position:  [-16.49437635]


portfolio before change:  [-16.78273957]
curr_Stock_Price:  101.9680974674471
curr_Factors:  [1.01968097e+02 3.89926809e-02]
mat_Sqrt:  [[ 2.01351961e+01  0.00000000e+00]
 [-7.89862580e-03  1.80980253e-02]]
grads:  [-0.00325348 -0.98850579]
Stock Position:  -0.0032534831364231407
Bond Position:  [-16.45098808]


portfolio before change:  [-16.78310732]
curr_Stock_Price:  101.44903940100609
curr_Factors:  [1.01449039e+02 3.95269933e-02]
mat_Sqrt:  [[ 2.01694859e+01  0.00000000e+00]
 [-7.95255866e-03  1.82216010e-02]]
grads:  [-0.00270904 -2.36723868]
Stock Position:  -0.0027090401716807233
Bond Position:  [-16.5082778]


portfolio before change:  [-16.78703216]
curr_Stock_Price:  102.13606129809311
curr_Factors:  [1.02136061e+02 3.93378578e-02]
mat_Sqrt:  [[ 2.02574352e+01  0.00000000e+00]
 [-7.93350947e-03  1.81779538e-02]]
grads:  [0.01667285 8.57973848]
Stock Position:  0.01667284722384491
Bond Position:  [-18.4899311]


portfolio before change:  [-16.79475861]
curr_Stock_Price:  101.81127734922308
curr_Factors:  [1.01811277e+02 4.05293430e-02]
mat_Sqrt:  [[ 2.04965454e+01  0.00000000e+00]
 [-8.05276032e-03  1.84511919e-02]]
grads:  [-3.74595581e-03 -2.62711148e+01]
Stock Position:  -0.003745955807653094
Bond Position:  [-16.41337807]


portfolio before change:  [-16.8025297]
curr_Stock_Price:  103.3380670382069
curr_Factors:  [1.03338067e+02 3.89392230e-02]
mat_Sqrt:  [[ 2.03917254e+01  0.00000000e+00]
 [-7.89320953e-03  1.80856151e-02]]
grads:  [-2.67587169e-03 -1.00561473e+01]
Stock Position:  -0.0026758716933183136
Bond Position:  [-16.52601029]


portfolio before change:  [-16.80575147]
curr_Stock_Price:  103.77003525777118
curr_Factors:  [1.03770035e+02 3.96217852e-02]
mat_Sqrt:  [[ 2.06556556e+01  0.00000000e+00]
 [-7.96208869e-03  1.82434370e-02]]
grads:  [-1.61508327e-03 -8.59942919e+00]
Stock Position:  -0.0016150832748050453
Bond Position:  [-16.63815423]


portfolio before change:  [-16.8079711]
curr_Stock_Price:  103.85654632104358
curr_Factors:  [1.03856546e+02 4.04971382e-02]
mat_Sqrt:  [[ 2.08999883e+01  0.00000000e+00]
 [-8.04956030e-03  1.84438597e-02]]
grads:  [-1.45379980e-02 -2.30330165e+01]
Stock Position:  -0.014537997994178924
Bond Position:  [-15.29810483]


portfolio before change:  [-16.81962148]
curr_Stock_Price:  104.5263771527627
curr_Factors:  [1.04526377e+02 4.13115661e-02]
mat_Sqrt:  [[ 2.12452442e+01  0.00000000e+00]
 [-8.13009876e-03  1.86283965e-02]]
grads:  [-2.28103144e-04 -5.85629522e+00]
Stock Position:  -0.0002281031442535058
Bond Position:  [-16.79577868]


portfolio before change:  [-16.82186764]
curr_Stock_Price:  105.16887163664946
curr_Factors:  [1.05168872e+02 4.25383375e-02]
mat_Sqrt:  [[ 2.16908949e+01  0.00000000e+00]
 [-8.24992970e-03  1.89029637e-02]]
grads:  [ 0.00495754 -1.08143603]
Stock Position:  0.004957543493169347
Bond Position:  [-17.34324689]


portfolio before change:  [-16.83168593]
curr_Stock_Price:  103.62571765984656
curr_Factors:  [1.03625718e+02 4.21674566e-02]
mat_Sqrt:  [[ 2.12792470e+01  0.00000000e+00]
 [-8.21388645e-03  1.88203782e-02]]
grads:  [ 1.16494704e-02 -1.84130756e+01]
Stock Position:  0.011649470401087832
Bond Position:  [-18.03887066]


portfolio before change:  [-16.8535232]
curr_Stock_Price:  101.94475981565454
curr_Factors:  [1.01944760e+02 4.25403284e-02]
mat_Sqrt:  [[ 2.10264196e+01  0.00000000e+00]
 [-8.25012275e-03  1.89034060e-02]]
grads:  [-7.39024265e-03 -2.25639334e+01]
Stock Position:  -0.007390242653147641
Bond Position:  [-16.10012669]


portfolio before change:  [-16.84782791]
curr_Stock_Price:  100.90177296842839
curr_Factors:  [1.00901773e+02 4.22032932e-02]
mat_Sqrt:  [[ 2.07286953e+01  0.00000000e+00]
 [-8.21737605e-03  1.88283739e-02]]
grads:  [0.00184861 0.84130437]
Stock Position:  0.0018486129529721748
Bond Position:  [-17.03435624]


portfolio before change:  [-16.85229563]
curr_Stock_Price:  99.63688807395877
curr_Factors:  [9.96368881e+01 4.13542420e-02]
mat_Sqrt:  [[ 2.02619009e+01  0.00000000e+00]
 [-8.13429697e-03  1.86380158e-02]]
grads:  [ 0.00361232 -1.22250405]
Stock Position:  0.003612317648428781
Bond Position:  [-17.21221571]


portfolio before change:  [-16.85787697]
curr_Stock_Price:  98.68744706429196
curr_Factors:  [9.86874471e+01 4.14731209e-02]
mat_Sqrt:  [[ 2.00976498e+01  0.00000000e+00]
 [-8.14598020e-03  1.86647854e-02]]
grads:  [ 3.86139294e-03 -5.65783341e+00]
Stock Position:  0.0038613929379564967
Bond Position:  [-17.23894798]


portfolio before change:  [-16.8650845]
curr_Stock_Price:  97.37897354984649
curr_Factors:  [9.73789735e+01 4.27480095e-02]
mat_Sqrt:  [[ 2.01336790e+01  0.00000000e+00]
 [-8.27023671e-03  1.89494929e-02]]
grads:  [-2.03607488e-02 -2.35020297e+01]
Stock Position:  -0.02036074883935501
Bond Position:  [-14.88237568]


portfolio before change:  [-16.84912836]
curr_Stock_Price:  96.50392935172366
curr_Factors:  [9.65039294e+01 4.38385210e-02]
mat_Sqrt:  [[ 2.02056555e+01  0.00000000e+00]
 [-8.37506022e-03  1.91896737e-02]]
grads:  [0.00460134 3.17814123]
Stock Position:  0.004601336594860379
Bond Position:  [-17.29317542]


portfolio before change:  [-16.84734595]
curr_Stock_Price:  97.3611138910184
curr_Factors:  [9.73611139e+01 4.28355726e-02]
mat_Sqrt:  [[ 2.01505926e+01  0.00000000e+00]
 [-8.27870257e-03  1.89688906e-02]]
grads:  [ 0.01264285 -2.11052483]
Stock Position:  0.012642848848327276
Bond Position:  [-18.07826779]


portfolio before change:  [-16.86021095]
curr_Stock_Price:  96.5222936063315
curr_Factors:  [9.65222936e+01 4.46389531e-02]
mat_Sqrt:  [[ 2.0393165e+01  0.0000000e+00]
 [-8.4511730e-03  1.9364070e-02]]
grads:  [ -0.03015429 -10.32415959]
Stock Position:  -0.03015428700070014
Bond Position:  [-13.94965001]


portfolio before change:  [-16.90901677]
curr_Stock_Price:  98.08300063835229
curr_Factors:  [9.80830006e+01 4.35585352e-02]
mat_Sqrt:  [[ 2.04705908e+01  0.00000000e+00]
 [-8.34827266e-03  1.91282957e-02]]
grads:  [-0.00928442 -3.06459401]
Stock Position:  -0.00928441654867375
Bond Position:  [-15.99837334]


portfolio before change:  [-16.89686608]
curr_Stock_Price:  96.55887511078058
curr_Factors:  [9.65588751e+01 4.33158182e-02]
mat_Sqrt:  [[ 2.00962701e+01  0.00000000e+00]
 [-8.32498103e-03  1.90749279e-02]]
grads:  [-0.00155649  1.51074422]
Stock Position:  -0.001556486244166626
Bond Position:  [-16.74657352]


portfolio before change:  [-16.89651896]
curr_Stock_Price:  94.99087398461934
curr_Factors:  [9.49908740e+01 4.39901666e-02]
mat_Sqrt:  [[ 1.99232272e+01  0.00000000e+00]
 [-8.38953316e-03  1.92228354e-02]]
grads:  [ 0.02084168 11.16386406]
Stock Position:  0.020841676926609615
Bond Position:  [-18.87628807]


portfolio before change:  [-16.88920592]
curr_Stock_Price:  95.45497870745663
curr_Factors:  [9.54549787e+01 4.35882173e-02]
mat_Sqrt:  [[ 1.99288913e+01  0.00000000e+00]
 [-8.35111656e-03  1.91348119e-02]]
grads:  [ 0.00119545 -0.86576762]
Stock Position:  0.0011954469629621891
Bond Position:  [-17.00331729]


portfolio before change:  [-16.8917707]
curr_Stock_Price:  95.087562682683
curr_Factors:  [9.50875627e+01 4.34932859e-02]
mat_Sqrt:  [[ 1.98305530e+01  0.00000000e+00]
 [-8.34201759e-03  1.91139635e-02]]
grads:  [ 7.58453979e-03 -8.47879540e+00]
Stock Position:  0.00758453978993209
Bond Position:  [-17.6129661]


portfolio before change:  [-16.89952999]
curr_Stock_Price:  94.35481766083755
curr_Factors:  [9.43548177e+01 4.45495439e-02]
mat_Sqrt:  [[ 1.99152476e+01  0.00000000e+00]
 [-8.44270515e-03  1.93446677e-02]]
grads:  [0.00600336 4.46129369]
Stock Position:  0.006003361572791223
Bond Position:  [-17.46597607]


portfolio before change:  [-16.89917649]
curr_Stock_Price:  94.77739428963666
curr_Factors:  [9.47773943e+01 4.25694344e-02]
mat_Sqrt:  [[ 1.95548147e+01  0.00000000e+00]
 [-8.25294462e-03  1.89098717e-02]]
grads:  [7.85185438e-04 8.55329176e+00]
Stock Position:  0.0007851854375646741
Bond Position:  [-16.97359432]


portfolio before change:  [-16.90223189]
curr_Stock_Price:  93.58841326500033
curr_Factors:  [9.35884133e+01 4.29730682e-02]
mat_Sqrt:  [[ 1.94008280e+01  0.00000000e+00]
 [-8.29197860e-03  1.89993098e-02]]
grads:  [-0.0214768  -7.17903072]
Stock Position:  -0.02147679722107885
Bond Position:  [-14.89225252]


portfolio before change:  [-16.92858927]
curr_Stock_Price:  94.72898047538442
curr_Factors:  [9.47289805e+01 4.15652419e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.92858927]
Stock Price:  93.31692260976861
PL:  [-16.92858927]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.36950133e+00  3.38518028e-01]
 [ 1.11050773e+00  6.76037525e-02]
 [-1.97103609e-01  2.01039310e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.99961725e-02  1.73774641e-01]
 [-2.72534470e-01  9.27767521e-02]
 [ 1.66307129e-01 -1.68302481e-01]
 [-2.42825684e-02  3.84488229e-01]
 [-1.17891486e-01 -9.71373093e-02]
 [ 1.04892649e-01 -5.78443919e-02]
 [-8.84317912e-02 -8.33853251e-03]
 [ 1.26505359e-02 -1.35948382e-01]
 [-8.20319033e-02 -2.17185310e-02]
 [-4.58001461e-02 -3.57838469e-02]
 [ 5.12546091e-01  3.35906942e-01]
 [ 1.29946752e-01 -1.35373307e-02]
 [ 4.01094716e-02  1.27852426e-01]
 [ 1.29063463e-02 -1.00737165e-01]
 [-5.27519478e-02 -7.76417523e-02]
 [-1.41412475e-01  3.11448246e-03]
 [ 1.70036045e-01 -3.38223497e-02]
 [ 8.51557942e-01  2.95873885e-04]
 [ 2.51135531e-02 -1.43488938e-01]
 [-4.59018203e-02  5.35462386e-02]
 [-1.51153536e-01  9.82091311e-02]
 [ 1.24495441e-01 -1.05320207e-01]
 [-2.04653666e-01 -4.27302220e-01]
 [ 4.72898787e-02  1.01574033e-01]
 [ 4.41950457e-02  1.33179737e-01]
 [-5.39788989e-01 -1.13255666e-01]
 [-1.67009797e-01 -6.21146202e-02]
 [ 2.88461135e-03 -5.40023665e-02]
 [ 9.64986890e-02  1.90945761e-01]
 [ 2.49796562e-02 -8.61370405e-03]
 [ 1.74667821e-01 -9.61483459e-02]
 [ 2.93815304e-02  1.18630899e-01]
 [-4.42786723e-02 -2.74725174e-02]
 [-1.39370316e-01 -7.01144430e-02]
 [ 1.18541296e-01 -9.55216847e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.39352141]
curr_Stock_Price:  99.81303738638559
curr_Factors:  [9.98130374e+01 3.92882098e-02]
mat_Sqrt:  [[ 1.97841954e+01  0.00000000e+00]
 [-7.92850147e-03  1.81664791e-02]]
grads:  [ 0.07668963 18.63421229]
Stock Position:  0.07668963468473247
Bond Position:  [-6.26110397]


portfolio before change:  [1.27448589]
curr_Stock_Price:  98.27107109213064
curr_Factors:  [9.82710711e+01 3.96412758e-02]
mat_Sqrt:  [[ 1.95658852e+01  0.00000000e+00]
 [-7.96404679e-03  1.82479236e-02]]
grads:  [0.05826531 3.70473671]
Stock Position:  0.05826531288670608
Bond Position:  [-4.45130882]


portfolio before change:  [1.16761664]
curr_Stock_Price:  96.44643835368005
curr_Factors:  [9.64464384e+01 4.26952925e-02]
mat_Sqrt:  [[ 1.99285725e+01  0.00000000e+00]
 [-8.26513569e-03  1.89378050e-02]]
grads:  [-5.48774181e-03  1.06157662e+01]
Stock Position:  -0.005487741812122939
Bond Position:  [1.69688979]


portfolio before change:  [1.15278228]
curr_Stock_Price:  99.18827417661532
curr_Factors:  [9.91882742e+01 4.09507581e-02]
mat_Sqrt:  [[ 2.00720304e+01  0.00000000e+00]
 [-8.09451746e-03  1.85468695e-02]]
grads:  [-8.12143396e-04 -8.16239164e+00]
Stock Position:  -0.0008121433958109982
Bond Position:  [1.23333738]


portfolio before change:  [1.15262891]
curr_Stock_Price:  99.56696189575086
curr_Factors:  [9.95669619e+01 4.23726558e-02]
mat_Sqrt:  [[ 2.04954802e+01  0.00000000e+00]
 [-8.23384779e-03  1.88661154e-02]]
grads:  [-2.02713047e-04  9.21093919e+00]
Stock Position:  -0.00020271304729947275
Bond Position:  [1.17281243]


portfolio before change:  [1.15248829]
curr_Stock_Price:  100.98387555179013
curr_Factors:  [1.00983876e+02 4.35032679e-02]
mat_Sqrt:  [[ 2.10626483e+01  0.00000000e+00]
 [-8.34297481e-03  1.91161568e-02]]
grads:  [-0.01101682  4.85331613]
Stock Position:  -0.011016818658876657
Bond Position:  [2.26500934]


portfolio before change:  [1.14761535]
curr_Stock_Price:  101.45189529536306
curr_Factors:  [1.01451895e+02 4.42434738e-02]
mat_Sqrt:  [[ 2.13395263e+01  0.00000000e+00]
 [-8.41365307e-03  1.92781010e-02]]
grads:  [ 4.35126361e-03 -8.73024165e+00]
Stock Position:  0.004351263614920007
Bond Position:  [0.70617141]


portfolio before change:  [1.1468563]
curr_Stock_Price:  101.25716512824602
curr_Factors:  [1.01257165e+02 4.59447608e-02]
mat_Sqrt:  [[ 2.17041990e+01  0.00000000e+00]
 [-8.57389161e-03  1.96452537e-02]]
grads:  [6.61263067e-03 1.95715584e+01]
Stock Position:  0.006612630673584133
Bond Position:  [0.47728006]


portfolio before change:  [1.14709649]
curr_Stock_Price:  101.28446493813377
curr_Factors:  [1.01284465e+02 4.56187091e-02]
mat_Sqrt:  [[ 2.16328796e+01  0.00000000e+00]
 [-8.54341469e-03  1.95754223e-02]]
grads:  [-0.00740935 -4.96220761]
Stock Position:  -0.0074093549080732025
Bond Position:  [1.89754904]


portfolio before change:  [1.14963615]
curr_Stock_Price:  100.97371532064807
curr_Factors:  [1.00973715e+02 4.64319953e-02]
mat_Sqrt:  [[ 2.17579017e+01  0.00000000e+00]
 [-8.61923387e-03  1.97491458e-02]]
grads:  [ 0.00366061 -2.92895665]
Stock Position:  0.003660614352113906
Bond Position:  [0.78001032]


portfolio before change:  [1.14853878]
curr_Stock_Price:  100.64730069227738
curr_Factors:  [1.00647301e+02 4.80212660e-02]
mat_Sqrt:  [[ 2.20556029e+01  0.00000000e+00]
 [-8.76550202e-03  2.00842882e-02]]
grads:  [-0.0041745 -0.4151769]
Stock Position:  -0.004174495950668337
Bond Position:  [1.56869053]


portfolio before change:  [1.14950357]
curr_Stock_Price:  100.46316065190676
curr_Factors:  [1.00463161e+02 4.84400376e-02]
mat_Sqrt:  [[ 2.21110351e+01  0.00000000e+00]
 [-8.80363903e-03  2.01716711e-02]]
grads:  [-2.11126264e-03 -6.73956962e+00]
Stock Position:  -0.002111262640114926
Bond Position:  [1.36160769]


portfolio before change:  [1.14870239]
curr_Stock_Price:  100.92326147810641
curr_Factors:  [1.00923261e+02 4.89710867e-02]
mat_Sqrt:  [[ 2.23337241e+01  0.00000000e+00]
 [-8.85176472e-03  2.02819409e-02]]
grads:  [-0.00409742 -1.07083099]
Stock Position:  -0.004097419971302926
Bond Position:  [1.56222738]


portfolio before change:  [1.15302136]
curr_Stock_Price:  99.91685151064117
curr_Factors:  [9.99168515e+01 4.85742942e-02]
mat_Sqrt:  [[ 2.20212512e+01  0.00000000e+00]
 [-8.81583069e-03  2.01996057e-02]]
grads:  [-0.00278901 -1.77151215]
Stock Position:  -0.002789010341531039
Bond Position:  [1.4316905]


portfolio before change:  [1.15717153]
curr_Stock_Price:  98.49297996764709
curr_Factors:  [9.84929800e+01 5.09838352e-02]
mat_Sqrt:  [[ 2.22393213e+01  0.00000000e+00]
 [-9.03184014e-03  2.06945456e-02]]
grads:  [ 0.02963885 16.23166553]
Stock Position:  0.029638849675321502
Bond Position:  [-1.7620471]


portfolio before change:  [1.15867945]
curr_Stock_Price:  98.55128814900827
curr_Factors:  [9.85512881e+01 5.16340060e-02]
mat_Sqrt:  [[ 2.23939248e+01  0.00000000e+00]
 [-9.08924692e-03  2.08260810e-02]]
grads:  [ 0.00553894 -0.65001815]
Stock Position:  0.005538938668163625
Bond Position:  [0.61280991]


portfolio before change:  [1.15262605]
curr_Stock_Price:  97.44457805673107
curr_Factors:  [9.74445781e+01 5.28304189e-02]
mat_Sqrt:  [[ 2.23975083e+01  0.00000000e+00]
 [-9.19394747e-03  2.10659801e-02]]
grads:  [4.28212120e-03 6.06914207e+00]
Stock Position:  0.004282121196358715
Bond Position:  [0.73535656]


portfolio before change:  [1.16469689]
curr_Stock_Price:  100.24200201773375
curr_Factors:  [1.00242002e+02 5.15167217e-02]
mat_Sqrt:  [[ 2.27522233e+01  0.00000000e+00]
 [-9.07891815e-03  2.08024148e-02]]
grads:  [-1.36509546e-03 -4.84257071e+00]
Stock Position:  -0.001365095463246351
Bond Position:  [1.30153679]


portfolio before change:  [1.16628097]
curr_Stock_Price:  99.200769520284
curr_Factors:  [9.92007695e+01 5.07952334e-02]
mat_Sqrt:  [[ 2.23576690e+01  0.00000000e+00]
 [-9.01511916e-03  2.06562330e-02]]
grads:  [-0.00387507 -3.75875661]
Stock Position:  -0.0038750724304149374
Bond Position:  [1.55069114]


portfolio before change:  [1.16806802]
curr_Stock_Price:  98.78962851583493
curr_Factors:  [9.87896285e+01 5.00966803e-02]
mat_Sqrt:  [[ 2.21113789e+01  0.00000000e+00]
 [-8.95291508e-03  2.05137055e-02]]
grads:  [-0.00633399  0.15182447]
Stock Position:  -0.006333987774672986
Bond Position:  [1.79380032]


portfolio before change:  [1.16978049]
curr_Stock_Price:  98.55466830097272
curr_Factors:  [9.85546683e+01 5.10954991e-02]
mat_Sqrt:  [[ 2.22776062e+01  0.00000000e+00]
 [-9.04172542e-03  2.07171956e-02]]
grads:  [ 0.00696999 -1.63257375]
Stock Position:  0.006969993102043577
Bond Position:  [0.48285514]


portfolio before change:  [1.17833706]
curr_Stock_Price:  99.77363791186474
curr_Factors:  [9.97736379e+01 5.19657990e-02]
mat_Sqrt:  [[ 2.27444067e+01  0.00000000e+00]
 [-9.11840328e-03  2.08928866e-02]]
grads:  [0.037446   0.01416147]
Stock Position:  0.03744600087008956
Bond Position:  [-2.55778667]


portfolio before change:  [1.17782199]
curr_Stock_Price:  99.76842142983489
curr_Factors:  [9.97684214e+01 5.50686587e-02]
mat_Sqrt:  [[ 2.34123684e+01  0.00000000e+00]
 [-9.38668493e-03  2.15075971e-02]]
grads:  [-1.60215117e-03 -6.67154666e+00]
Stock Position:  -0.0016021511668351555
Bond Position:  [1.33766608]


portfolio before change:  [1.17889132]
curr_Stock_Price:  99.20535742010878
curr_Factors:  [9.92053574e+01 5.46330316e-02]
mat_Sqrt:  [[ 2.31879725e+01  0.00000000e+00]
 [-9.34948397e-03  2.14223590e-02]]
grads:  [-9.71724713e-04  2.49954912e+00]
Stock Position:  -0.00097172471251248
Bond Position:  [1.27529161]


portfolio before change:  [1.17993533]
curr_Stock_Price:  98.29502443108832
curr_Factors:  [9.82950244e+01 5.31993863e-02]
mat_Sqrt:  [[ 2.26717397e+01  0.00000000e+00]
 [-9.22599686e-03  2.11394145e-02]]
grads:  [-0.0047765   4.64578294]
Stock Position:  -0.00477649967300654
Bond Position:  [1.64944148]


portfolio before change:  [1.17807673]
curr_Stock_Price:  98.7273065317404
curr_Factors:  [9.87273065e+01 5.36122234e-02]
mat_Sqrt:  [[ 2.28596301e+01  0.00000000e+00]
 [-9.26172540e-03  2.12212789e-02]]
grads:  [ 3.43531079e-03 -4.96295287e+00]
Stock Position:  0.003435310792705415
Bond Position:  [0.83891775]


portfolio before change:  [1.17497397]
curr_Stock_Price:  97.7935836333893
curr_Factors:  [9.77935836e+01 5.24883596e-02]
mat_Sqrt:  [[ 2.24048407e+01  0.00000000e+00]
 [-9.16413528e-03  2.09976718e-02]]
grads:  [-1.74579971e-02 -2.03499809e+01]
Stock Position:  -0.017457997071875654
Bond Position:  [2.88225407]


portfolio before change:  [1.15746902]
curr_Stock_Price:  98.81691135806639
curr_Factors:  [9.88169114e+01 5.28279083e-02]
mat_Sqrt:  [[ 2.27123976e+01  0.00000000e+00]
 [-9.19372902e-03  2.10654796e-02]]
grads:  [4.03393876e-03 4.82182392e+00]
Stock Position:  0.004033938762721681
Bond Position:  [0.75884766]


portfolio before change:  [1.16074025]
curr_Stock_Price:  99.604322001499
curr_Factors:  [9.96043220e+01 5.16894101e-02]
mat_Sqrt:  [[ 2.26453466e+01  0.00000000e+00]
 [-9.09412207e-03  2.08372514e-02]]
grads:  [4.51834322e-03 6.39142536e+00]
Stock Position:  0.004518343218687637
Bond Position:  [0.71069374]


portfolio before change:  [1.15860382]
curr_Stock_Price:  99.11182313653305
curr_Factors:  [9.91118231e+01 5.05014647e-02]
mat_Sqrt:  [[ 2.22729351e+01  0.00000000e+00]
 [-8.98901237e-03  2.05964148e-02]]
grads:  [-0.02645443 -5.49880487]
Stock Position:  -0.026454430515103815
Bond Position:  [3.78055065]


portfolio before change:  [1.145029]
curr_Stock_Price:  99.64282723006751
curr_Factors:  [9.96428272e+01 4.94273623e-02]
mat_Sqrt:  [[ 2.21528578e+01  0.00000000e+00]
 [-8.89290614e-03  2.03762078e-02]]
grads:  [-0.0087627  -3.04838962]
Stock Position:  -0.008762699695615371
Bond Position:  [2.01816918]


portfolio before change:  [1.15502597]
curr_Stock_Price:  98.53076418752497
curr_Factors:  [9.85307642e+01 4.92126288e-02]
mat_Sqrt:  [[ 2.18579855e+01  0.00000000e+00]
 [-8.87356784e-03  2.03318981e-02]]
grads:  [-9.46288193e-04 -2.65604156e+00]
Stock Position:  -0.000946288193322352
Bond Position:  [1.24826446]


portfolio before change:  [1.15646507]
curr_Stock_Price:  97.174878608731
curr_Factors:  [9.71748786e+01 4.93087388e-02]
mat_Sqrt:  [[ 2.15782368e+01  0.00000000e+00]
 [-8.88222844e-03  2.03517421e-02]]
grads:  [8.33405681e-03 9.38228088e+00]
Stock Position:  0.008334056810309336
Bond Position:  [0.34660411]


portfolio before change:  [1.14743255]
curr_Stock_Price:  96.08587219385933
curr_Factors:  [9.60858722e+01 5.07749073e-02]
mat_Sqrt:  [[ 2.16513064e+01  0.00000000e+00]
 [-9.01331525e-03  2.06520997e-02]]
grads:  [ 0.00098009 -0.41708612]
Stock Position:  0.000980094558146584
Bond Position:  [1.05325931]


portfolio before change:  [1.14775289]
curr_Stock_Price:  96.27837522431773
curr_Factors:  [9.62783752e+01 4.99380197e-02]
mat_Sqrt:  [[ 2.15151516e+01  0.00000000e+00]
 [-8.93872651e-03  2.04811954e-02]]
grads:  [ 0.00616799 -4.69446943]
Stock Position:  0.006167990100713247
Bond Position:  [0.55390882]


portfolio before change:  [1.1475838]
curr_Stock_Price:  96.23973416653878
curr_Factors:  [9.62397342e+01 5.09328695e-02]
mat_Sqrt:  [[ 2.17196832e+01  0.00000000e+00]
 [-9.02732469e-03  2.06841994e-02]]
grads:  [3.73653237e-03 5.73533918e+00]
Stock Position:  0.0037365323714418325
Bond Position:  [0.78798091]


portfolio before change:  [1.15050963]
curr_Stock_Price:  96.99640731891806
curr_Factors:  [9.69964073e+01 5.09832910e-02]
mat_Sqrt:  [[ 2.19012842e+01  0.00000000e+00]
 [-9.03179193e-03  2.06944351e-02]]
grads:  [-0.00256919 -1.32753164]
Stock Position:  -0.0025691946303578635
Bond Position:  [1.39971228]


portfolio before change:  [1.14896066]
curr_Stock_Price:  97.66741256594317
curr_Factors:  [9.76674126e+01 4.98905499e-02]
mat_Sqrt:  [[ 2.18151814e+01  0.00000000e+00]
 [-8.93447703e-03  2.04714586e-02]]
grads:  [-0.0077914  -3.42498521]
Stock Position:  -0.007791398318765666
Bond Position:  [1.90992638]


portfolio before change:  [1.15487285]
curr_Stock_Price:  96.93924718451252
curr_Factors:  [9.69392472e+01 4.98331237e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.15487285]
Stock Price:  98.45007347026122
PL:  [1.15487285]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.39136147e+00  3.43460167e-01]
 [ 1.00882349e+00  7.65159337e-02]
 [-1.28260957e-01  1.53295125e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.19103781e-01  9.87972368e-01]
 [ 3.25339460e-02 -1.46013046e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.86808226e-01  8.86030915e-01]
 [ 2.80686669e-02  4.07343295e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-8.77010015e-02  9.56115206e-03]
 [ 2.88469375e-02 -1.35132056e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-5.10555537e-02 -2.52873410e-02]
 [ 4.99727101e-01  3.26663149e-01]
 [ 1.29938899e-01 -3.34387845e-02]
 [ 4.00639128e-02  1.26837151e-01]
 [ 1.89303475e-01  7.52867621e-02]
 [ 1.10675414e-02  2.34172959e-02]
 [-4.81449352e-01  2.04654197e-01]
 [ 1.06375922e-01  7.00860031e-02]
 [ 1.30681939e+00  1.36817585e-01]
 [ 1.63198380e-02  3.67470580e-01]
 [-1.47343433e-01  1.67862692e-01]
 [-1.81603020e-01  1.00473507e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 4.95074013e-01 -4.17500247e-01]
 [ 1.38584050e-01 -9.27672464e-02]
 [ 8.06957254e-01 -3.25139208e-01]
 [-8.06463217e-01 -3.62580856e-01]
 [ 5.66759171e-01  2.12249404e-01]
 [-2.91740960e-01  4.53395064e-01]
 [ 1.20307717e+00  8.17013915e-02]
 [ 9.10132803e-02 -2.83726796e-01]
 [ 3.93082033e-01 -7.24520610e-01]
 [ 2.15935883e-01 -6.44983055e-02]
 [-1.10659111e-01  1.05010215e+00]
 [-4.34716754e-01 -1.54797337e-01]
 [-7.46940069e-01  1.77897234e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.78939266]
curr_Stock_Price:  99.72534509964052
curr_Factors:  [9.97253451e+01 4.14068675e-02]
mat_Sqrt:  [[ 2.02927888e+01  0.00000000e+00]
 [-8.13947099e-03  1.86498710e-02]]
grads:  [ 0.07595111 18.41622216]
Stock Position:  0.0759511071263427
Bond Position:  [-6.78485771]


portfolio before change:  [0.70140966]
curr_Stock_Price:  98.57809598849963
curr_Factors:  [9.85780960e+01 4.14845156e-02]
mat_Sqrt:  [[ 2.00781381e+01  0.00000000e+00]
 [-8.14709918e-03  1.86673493e-02]]
grads:  [0.05190809 4.09891797]
Stock Position:  0.05190808878916342
Bond Position:  [-4.4155909]


portfolio before change:  [0.61507614]
curr_Stock_Price:  96.92553001351193
curr_Factors:  [9.69255300e+01 4.02534098e-02]
mat_Sqrt:  [[ 1.94464138e+01  0.00000000e+00]
 [-8.02530097e-03  1.83882746e-02]]
grads:  [-3.15520797e-03  8.33656928e+00]
Stock Position:  -0.0031552079655985488
Bond Position:  [0.92089634]


portfolio before change:  [0.60935443]
curr_Stock_Price:  98.77543259316892
curr_Factors:  [9.87754326e+01 4.04326007e-02]
mat_Sqrt:  [[ 1.98616250e+01  0.00000000e+00]
 [-8.04314374e-03  1.84291575e-02]]
grads:  [-8.20746888e-04 -8.21452703e+00]
Stock Position:  -0.0008207468884288195
Bond Position:  [0.69042406]


portfolio before change:  [0.61083541]
curr_Stock_Price:  97.07615674592263
curr_Factors:  [9.70761567e+01 4.17561850e-02]
mat_Sqrt:  [[ 1.98368624e+01  0.00000000e+00]
 [-8.17373207e-03  1.87283730e-02]]
grads:  [1.57324633e-02 5.27527068e+01]
Stock Position:  0.015732463339586073
Bond Position:  [-0.91641166]


portfolio before change:  [0.60147942]
curr_Stock_Price:  96.48874503653866
curr_Factors:  [9.64887450e+01 4.14359277e-02]
mat_Sqrt:  [[ 1.96410722e+01  0.00000000e+00]
 [-8.14232672e-03  1.86564143e-02]]
grads:  [ 0.00133197 -0.7826426 ]
Stock Position:  0.0013319748535338119
Bond Position:  [0.47295884]


portfolio before change:  [0.60175439]
curr_Stock_Price:  96.65079109585895
curr_Factors:  [9.66507911e+01 4.03192145e-02]
mat_Sqrt:  [[ 1.94071358e+01  0.00000000e+00]
 [-8.03185802e-03  1.84032987e-02]]
grads:  [0.0066663 5.2238943]
Stock Position:  0.00666629937833474
Bond Position:  [-0.04254872]


portfolio before change:  [0.60777694]
curr_Stock_Price:  97.55502121019532
curr_Factors:  [9.75550212e+01 4.09510492e-02]
mat_Sqrt:  [[ 1.97415907e+01  0.00000000e+00]
 [-8.09454624e-03  1.85469354e-02]]
grads:  [ 0.06450867 47.7723621 ]
Stock Position:  0.06450867287540153
Bond Position:  [-5.68536801]


portfolio before change:  [0.57840648]
curr_Stock_Price:  97.11074395190634
curr_Factors:  [9.71107440e+01 4.12671496e-02]
mat_Sqrt:  [[ 1.97273849e+01  0.00000000e+00]
 [-8.12572701e-03  1.86183795e-02]]
grads:  [1.04346246e-02 2.18785579e+01]
Stock Position:  0.01043462461655025
Bond Position:  [-0.43490768]


portfolio before change:  [0.58537704]
curr_Stock_Price:  97.78397624430788
curr_Factors:  [9.77839762e+01 4.13458273e-02]
mat_Sqrt:  [[ 1.98830744e+01  0.00000000e+00]
 [-8.13346936e-03  1.86361195e-02]]
grads:  [0.01239417 6.06760079]
Stock Position:  0.012394169150894115
Bond Position:  [-0.6265741]


portfolio before change:  [0.5919303]
curr_Stock_Price:  98.31903320912262
curr_Factors:  [9.83190332e+01 3.96413567e-02]
mat_Sqrt:  [[ 1.95754545e+01  0.00000000e+00]
 [-7.96405491e-03  1.82479422e-02]]
grads:  [-0.00426699  0.52395782]
Stock Position:  -0.0042669850992703975
Bond Position:  [1.01145615]


portfolio before change:  [0.58674892]
curr_Stock_Price:  99.56296039507941
curr_Factors:  [9.95629604e+01 4.05590500e-02]
mat_Sqrt:  [[ 2.00512609e+01  0.00000000e+00]
 [-8.05571102e-03  1.84579528e-02]]
grads:  [-1.50262505e-03 -7.32107498e+00]
Stock Position:  -0.0015026250458029123
Bond Position:  [0.73635472]


portfolio before change:  [0.58711459]
curr_Stock_Price:  99.38086555641445
curr_Factors:  [9.93808656e+01 3.98066000e-02]
mat_Sqrt:  [[ 1.98280642e+01  0.00000000e+00]
 [-7.98063657e-03  1.82859356e-02]]
grads:  [-0.00652353 -1.53404265]
Stock Position:  -0.0065235257774671675
Bond Position:  [1.23542823]


portfolio before change:  [0.58706892]
curr_Stock_Price:  99.41154127418656
curr_Factors:  [9.94115413e+01 3.98233079e-02]
mat_Sqrt:  [[ 1.98383466e+01  0.00000000e+00]
 [-7.98231124e-03  1.82897727e-02]]
grads:  [-0.00312989 -1.3825946 ]
Stock Position:  -0.003129890580373741
Bond Position:  [0.89821617]


portfolio before change:  [0.59110396]
curr_Stock_Price:  98.15822145895392
curr_Factors:  [9.81582215e+01 4.02040163e-02]
mat_Sqrt:  [[ 1.96816453e+01  0.00000000e+00]
 [-8.02037568e-03  1.83769893e-02]]
grads:  [ 0.03263419 17.77566192]
Stock Position:  0.032634191796450385
Bond Position:  [-2.61221027]


portfolio before change:  [0.60669095]
curr_Stock_Price:  98.64585553517675
curr_Factors:  [9.86458555e+01 3.88698533e-02]
mat_Sqrt:  [[ 1.94484634e+01  0.00000000e+00]
 [-7.88617558e-03  1.80694983e-02]]
grads:  [ 0.0059308  -1.85056519]
Stock Position:  0.005930803600750303
Bond Position:  [0.02164176]


portfolio before change:  [0.60025581]
curr_Stock_Price:  97.56036214204715
curr_Factors:  [9.75603621e+01 3.92731105e-02]
mat_Sqrt:  [[ 1.93339706e+01  0.00000000e+00]
 [-7.92697779e-03  1.81629879e-02]]
grads:  [4.93536407e-03 6.98327565e+00]
Stock Position:  0.004935364071538633
Bond Position:  [0.11875991]


portfolio before change:  [0.5914309]
curr_Stock_Price:  95.76925617596605
curr_Factors:  [9.57692562e+01 3.92347492e-02]
mat_Sqrt:  [[ 1.89697477e+01  0.00000000e+00]
 [-7.92310537e-03  1.81541150e-02]]
grads:  [0.01171135 4.14709073]
Stock Position:  0.011711347759209087
Bond Position:  [-0.53015617]


portfolio before change:  [0.59939373]
curr_Stock_Price:  96.45483994321354
curr_Factors:  [9.64548399e+01 3.88091062e-02]
mat_Sqrt:  [[ 1.90016295e+01  0.00000000e+00]
 [-7.88001079e-03  1.80553729e-02]]
grads:  [1.12030851e-03 1.29697105e+00]
Stock Position:  0.001120308509512341
Bond Position:  [0.49133456]


portfolio before change:  [0.59837588]
curr_Stock_Price:  95.49146694591995
curr_Factors:  [9.54914669e+01 3.87612203e-02]
mat_Sqrt:  [[ 1.88002353e+01  0.00000000e+00]
 [-7.87514777e-03  1.80442304e-02]]
grads:  [-0.02085777 11.341808  ]
Stock Position:  -0.020857767534954937
Bond Position:  [2.5901147]


portfolio before change:  [0.59597334]
curr_Stock_Price:  95.62217702259537
curr_Factors:  [9.56221770e+01 4.01060293e-02]
mat_Sqrt:  [[ 1.91497655e+01  0.00000000e+00]
 [-8.01059591e-03  1.83545811e-02]]
grads:  [0.00715225 3.81844744]
Stock Position:  0.007152252650849925
Bond Position:  [-0.08794063]


portfolio before change:  [0.60299747]
curr_Stock_Price:  96.60579943693332
curr_Factors:  [9.66057994e+01 4.02716538e-02]
mat_Sqrt:  [[ 1.93866572e+01  0.00000000e+00]
 [-8.02711942e-03  1.83924412e-02]]
grads:  [0.07048825 7.4387942 ]
Stock Position:  0.07048824693354362
Bond Position:  [-6.20657598]


portfolio before change:  [0.61598371]
curr_Stock_Price:  96.8010392481986
curr_Factors:  [9.68010392e+01 4.01071203e-02]
mat_Sqrt:  [[ 1.93861139e+01  0.00000000e+00]
 [-8.01070486e-03  1.83548307e-02]]
grads:  [9.11462444e-03 2.00203743e+01]
Stock Position:  0.009114624435069888
Bond Position:  [-0.26632141]


portfolio before change:  [0.59298278]
curr_Stock_Price:  94.28117320341853
curr_Factors:  [9.42811732e+01 4.24398467e-02]
mat_Sqrt:  [[ 1.94228019e+01  0.00000000e+00]
 [-8.24037346e-03  1.88810676e-02]]
grads:  [-3.81418437e-03  8.89052972e+00]
Stock Position:  -0.0038141843654044293
Bond Position:  [0.95258856]


portfolio before change:  [0.59576967]
curr_Stock_Price:  93.58172987913832
curr_Factors:  [9.35817299e+01 4.19804960e-02]
mat_Sqrt:  [[ 1.91740940e+01  0.00000000e+00]
 [-8.19565699e-03  1.87786093e-02]]
grads:  [-0.00718432  5.35042321]
Stock Position:  -0.007184317895210407
Bond Position:  [1.26809057]


portfolio before change:  [0.61361972]
curr_Stock_Price:  91.11920886110256
curr_Factors:  [9.11192089e+01 4.33264494e-02]
mat_Sqrt:  [[ 1.89664692e+01  0.00000000e+00]
 [-8.32600259e-03  1.90772685e-02]]
grads:  [ 0.00967384 -3.82630967]
Stock Position:  0.009673840746263226
Bond Position:  [-0.26785299]


portfolio before change:  [0.60780563]
curr_Stock_Price:  90.52165851079879
curr_Factors:  [9.05216585e+01 4.40614601e-02]
mat_Sqrt:  [[ 1.90012400e+01  0.00000000e+00]
 [-8.39632873e-03  1.92384060e-02]]
grads:  [ 1.64653447e-02 -2.17013950e+01]
Stock Position:  0.016465344679472166
Bond Position:  [-0.88266467]


portfolio before change:  [0.60760292]
curr_Stock_Price:  90.51604805413699
curr_Factors:  [9.05160481e+01 4.48174650e-02]
mat_Sqrt:  [[ 1.91623703e+01  0.00000000e+00]
 [-8.46805433e-03  1.94027500e-02]]
grads:  [ 0.00511926 -4.78113909]
Stock Position:  0.005119257331886316
Bond Position:  [0.14422797]


portfolio before change:  [0.60646234]
curr_Stock_Price:  90.28972505314552
curr_Factors:  [9.02897251e+01 4.74024540e-02]
mat_Sqrt:  [[ 1.96579734e+01  0.00000000e+00]
 [-8.70884185e-03  1.99544635e-02]]
grads:  [  0.0338313  -16.29405911]
Stock Position:  0.03383130381223205
Bond Position:  [-2.44815678]


portfolio before change:  [0.59095035]
curr_Stock_Price:  89.84026124436889
curr_Factors:  [8.98402612e+01 4.77041434e-02]
mat_Sqrt:  [[ 1.96222614e+01  0.00000000e+00]
 [-8.73651129e-03  2.00178621e-02]]
grads:  [ -0.04916388 -18.11286605]
Stock Position:  -0.04916387848780045
Bond Position:  [5.00784604]


portfolio before change:  [0.55876848]
curr_Stock_Price:  90.50757820413564
curr_Factors:  [9.05075782e+01 4.78846445e-02]
mat_Sqrt:  [[ 1.98053754e+01  0.00000000e+00]
 [-8.75302412e-03  2.00556978e-02]]
grads:  [ 0.03329361 10.58299773]
Stock Position:  0.03329360806458273
Bond Position:  [-2.45455535]


portfolio before change:  [0.4947438]
curr_Stock_Price:  88.59376194688868
curr_Factors:  [8.85937619e+01 4.72102016e-02]
mat_Sqrt:  [[ 1.92495717e+01  0.00000000e+00]
 [-8.69116347e-03  1.99139572e-02]]
grads:  [-4.87611533e-03  2.27677030e+01]
Stock Position:  -0.004876115330549716
Bond Position:  [0.9267372]


portfolio before change:  [0.51066001]
curr_Stock_Price:  85.35340329427655
curr_Factors:  [8.53534033e+01 4.80961635e-02]
mat_Sqrt:  [[ 1.87187162e+01  0.00000000e+00]
 [-8.77233502e-03  2.00999446e-02]]
grads:  [0.06617626 4.06475705]
Stock Position:  0.06617625710242526
Bond Position:  [-5.13770875]


portfolio before change:  [0.48895031]
curr_Stock_Price:  85.03504981365943
curr_Factors:  [8.50350498e+01 4.77028773e-02]
mat_Sqrt:  [[ 1.85724953e+01  0.00000000e+00]
 [-8.73639534e-03  2.00175965e-02]]
grads:  [-1.76687326e-03 -1.41738693e+01]
Stock Position:  -0.0017668732639479709
Bond Position:  [0.63919647]


portfolio before change:  [0.48739404]
curr_Stock_Price:  85.96108059783805
curr_Factors:  [8.59610806e+01 4.86213232e-02]
mat_Sqrt:  [[ 1.89546275e+01  0.00000000e+00]
 [-8.82009734e-03  2.02093819e-02]]
grads:  [ 4.05575449e-03 -3.58507061e+01]
Stock Position:  0.004055754489759672
Bond Position:  [0.138757]


portfolio before change:  [0.48398787]
curr_Stock_Price:  85.11696676419217
curr_Factors:  [8.51169668e+01 4.98928034e-02]
mat_Sqrt:  [[ 1.90123190e+01  0.00000000e+00]
 [-8.93467881e-03  2.04719210e-02]]
grads:  [ 0.0098771  -3.15057417]
Stock Position:  0.009877096801881374
Bond Position:  [-0.35672065]


portfolio before change:  [0.48060225]
curr_Stock_Price:  84.77870680585666
curr_Factors:  [8.47787068e+01 4.97554231e-02]
mat_Sqrt:  [[ 1.89106736e+01  0.00000000e+00]
 [-8.92236947e-03  2.04437167e-02]]
grads:  [1.83834298e-02 5.13655205e+01]
Stock Position:  0.018383429788043085
Bond Position:  [-1.07792116]


portfolio before change:  [0.50606926]
curr_Stock_Price:  86.17136091564701
curr_Factors:  [8.61713609e+01 4.89838750e-02]
mat_Sqrt:  [[ 1.90717050e+01  0.00000000e+00]
 [-8.85292042e-03  2.02845890e-02]]
grads:  [-0.02633618 -7.63127795]
Stock Position:  -0.026336179719980767
Bond Position:  [2.77549371]


portfolio before change:  [0.49901525]
curr_Stock_Price:  86.45237990383401
curr_Factors:  [8.64523799e+01 4.88970509e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.49901525]
Stock Price:  86.19501646544818
PL:  [0.49901525]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.47827504e+00  3.64397051e-01]
 [ 9.95970306e-01  7.78102528e-02]
 [ 8.20385762e-02  1.98493221e-04]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.25636788e-01  1.01451344e+00]
 [ 2.07185989e-02 -3.77987591e-02]
 [ 8.84523917e-02  9.45546838e-02]
 [ 1.37345867e+00  1.42341443e+00]
 [ 7.36747763e-02  5.29121939e-01]
 [ 1.43579942e-01  1.80963273e-02]
 [ 3.13362250e-02  1.77304742e-02]
 [ 5.22160692e-02 -8.55991907e-02]
 [-6.18295352e-02  1.92593094e-01]
 [-1.40990659e-01  4.93496211e-01]
 [ 1.53731194e-01  1.64063494e-01]
 [ 1.31559638e-01 -1.04790159e-01]
 [ 3.81444969e-02 -1.15691437e-02]
 [ 3.17917216e-01  6.53913227e-02]
 [ 2.50656138e-01  2.60654352e-01]
 [-6.31178182e-01  2.91077615e-01]
 [-4.32899014e-02  2.08229927e-01]
 [ 1.87883928e+00  3.09722605e-01]
 [ 1.32832073e-02  3.62657668e-01]
 [-1.61612074e-01  2.23999115e-01]
 [-1.53710046e-01  5.82816770e-02]
 [ 2.56261704e-01 -8.89242819e-02]
 [ 7.18593684e-01 -3.97384979e-01]
 [ 1.68274541e-01 -1.55970492e-01]
 [ 9.46449311e-01 -3.36047339e-01]
 [-9.99253097e-01 -4.08749216e-01]
 [ 1.08874521e+00  4.04784913e-01]
 [-3.47669187e-01  5.49193236e-01]
 [ 1.19378540e+00  8.35945959e-02]
 [ 8.59158766e-02 -2.56226416e-01]
 [ 3.94621389e-01 -7.44789317e-01]
 [ 2.58899077e-01 -8.51247443e-02]
 [-1.17892675e-01  1.16640640e+00]
 [-4.76655844e-01 -1.64744927e-01]
 [-1.42994592e+00  3.34230557e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.45493616]
curr_Stock_Price:  98.96410473279842
curr_Factors:  [9.89641047e+01 4.05002635e-02]
mat_Sqrt:  [[ 1.99162067e+01  0.00000000e+00]
 [-8.04987090e-03  1.84445714e-02]]
grads:  [ 0.08220998 19.75633068]
Stock Position:  0.08220997983989277
Bond Position:  [-12.59077321]


portfolio before change:  [-4.48487631]
curr_Stock_Price:  98.61905889083843
curr_Factors:  [9.86190589e+01 4.11331518e-02]
mat_Sqrt:  [[ 2.00012366e+01  0.00000000e+00]
 [-8.11252383e-03  1.85881273e-02]]
grads:  [0.05149329 4.18601894]
Stock Position:  0.05149329033182278
Bond Position:  [-9.56309614]


portfolio before change:  [-4.49553521]
curr_Stock_Price:  98.43527885323347
curr_Factors:  [9.84352789e+01 4.16909218e-02]
mat_Sqrt:  [[ 2.00988646e+01  0.00000000e+00]
 [-8.16734197e-03  1.87137314e-02]]
grads:  [0.00408606 0.01060682]
Stock Position:  0.004086061942083124
Bond Position:  [-4.89774786]


portfolio before change:  [-4.49425895]
curr_Stock_Price:  98.897463670817
curr_Factors:  [9.88974637e+01 4.43663650e-02]
mat_Sqrt:  [[ 2.08310940e+01  0.00000000e+00]
 [-8.42532991e-03  1.93048560e-02]]
grads:  [-7.82549730e-04 -7.84190321e+00]
Stock Position:  -0.0007825497302152167
Bond Position:  [-4.41686677]


portfolio before change:  [-4.49326835]
curr_Stock_Price:  96.92602891752519
curr_Factors:  [9.69260289e+01 4.43126614e-02]
mat_Sqrt:  [[ 2.04034843e+01  0.00000000e+00]
 [-8.42022911e-03  1.92931686e-02]]
grads:  [1.55430893e-02 5.25840757e+01]
Stock Position:  0.015543089265406075
Bond Position:  [-5.99979827]


portfolio before change:  [-4.49429492]
curr_Stock_Price:  96.90823675333716
curr_Factors:  [9.69082368e+01 4.47580245e-02]
mat_Sqrt:  [[ 2.05019961e+01  0.00000000e+00]
 [-8.46243695e-03  1.93898790e-02]]
grads:  [ 2.05924727e-04 -1.94940665e+00]
Stock Position:  0.00020592472722047307
Bond Position:  [-4.51425072]


portfolio before change:  [-4.49524941]
curr_Stock_Price:  95.01350825506161
curr_Factors:  [9.50135083e+01 4.48575880e-02]
mat_Sqrt:  [[ 2.01234905e+01  0.00000000e+00]
 [-8.47184401e-03  1.94114332e-02]]
grads:  [0.00644617 4.87108205]
Stock Position:  0.006446169909265817
Bond Position:  [-5.10772262]


portfolio before change:  [-4.50177988]
curr_Stock_Price:  94.09948111781502
curr_Factors:  [9.40994811e+01 4.56462042e-02]
mat_Sqrt:  [[ 2.01043281e+01  0.00000000e+00]
 [-8.54598892e-03  1.95813206e-02]]
grads:  [ 0.09921683 72.69246325]
Stock Position:  0.09921682750811794
Bond Position:  [-13.83803187]


portfolio before change:  [-4.33584323]
curr_Stock_Price:  95.7893811451389
curr_Factors:  [9.57893811e+01 4.48133489e-02]
mat_Sqrt:  [[ 2.02778108e+01  0.00000000e+00]
 [-8.46766546e-03  1.94018590e-02]]
grads:  [1.50214698e-02 2.72717135e+01]
Stock Position:  0.015021469770461522
Bond Position:  [-5.77474052]


portfolio before change:  [-4.33258435]
curr_Stock_Price:  96.05438639099015
curr_Factors:  [9.60543864e+01 4.55591758e-02]
mat_Sqrt:  [[ 2.05024203e+01  0.00000000e+00]
 [-8.53783821e-03  1.95626449e-02]]
grads:  [0.00738829 0.92504502]
Stock Position:  0.007388289999010989
Bond Position:  [-5.04226201]


portfolio before change:  [-4.34221138]
curr_Stock_Price:  94.83668749840142
curr_Factors:  [9.48366875e+01 4.60034882e-02]
mat_Sqrt:  [[ 2.03409746e+01  0.00000000e+00]
 [-8.57936951e-03  1.96578051e-02]]
grads:  [0.00192097 0.90195595]
Stock Position:  0.0019209717856739248
Bond Position:  [-4.52438998]


portfolio before change:  [-4.34367746]
curr_Stock_Price:  94.36791480191492
curr_Factors:  [9.43679148e+01 4.62616991e-02]
mat_Sqrt:  [[ 2.02971541e+01  0.00000000e+00]
 [-8.60341320e-03  1.97128961e-02]]
grads:  [ 7.32000141e-04 -4.34229401e+00]
Stock Position:  0.0007320001406481654
Bond Position:  [-4.41275479]


portfolio before change:  [-4.34426499]
curr_Stock_Price:  94.31887879383812
curr_Factors:  [9.43188788e+01 4.73145092e-02]
mat_Sqrt:  [[ 2.05161469e+01  0.00000000e+00]
 [-8.70075943e-03  1.99359444e-02]]
grads:  [1.08329220e-03 9.66059547e+00]
Stock Position:  0.0010832922022328906
Bond Position:  [-4.44643989]


portfolio before change:  [-4.34551481]
curr_Stock_Price:  93.67825523843753
curr_Factors:  [9.36782552e+01 4.66869707e-02]
mat_Sqrt:  [[ 2.02412179e+01  0.00000000e+00]
 [-8.64286718e-03  1.98032965e-02]]
grads:  [3.67511212e-03 2.49199021e+01]
Stock Position:  0.0036751121171665667
Bond Position:  [-4.6897929]


portfolio before change:  [-4.3449371]
curr_Stock_Price:  93.9949726354609
curr_Factors:  [9.39949726e+01 4.66034281e-02]
mat_Sqrt:  [[ 2.02914722e+01  0.00000000e+00]
 [-8.63513086e-03  1.97855704e-02]]
grads:  [0.01110488 8.29207807]
Stock Position:  0.01110488044166549
Bond Position:  [-5.38874003]


portfolio before change:  [-4.34592851]
curr_Stock_Price:  93.96635668013437
curr_Factors:  [9.39663567e+01 4.51736009e-02]
mat_Sqrt:  [[ 1.99716867e+01  0.00000000e+00]
 [-8.50163287e-03  1.94796881e-02]]
grads:  [ 4.29735677e-03 -5.37945773e+00]
Stock Position:  0.00429735676561794
Bond Position:  [-4.74973547]


portfolio before change:  [-4.34749063]
curr_Stock_Price:  93.74101620858232
curr_Factors:  [9.37410162e+01 4.65248084e-02]
mat_Sqrt:  [[ 2.02195718e+01  0.00000000e+00]
 [-8.62784407e-03  1.97688743e-02]]
grads:  [ 0.0016368  -0.58522016]
Stock Position:  0.0016367957246699912
Bond Position:  [-4.50092553]


portfolio before change:  [-4.3483167]
curr_Stock_Price:  93.5800800832828
curr_Factors:  [9.35800801e+01 4.70809984e-02]
mat_Sqrt:  [[ 2.03051520e+01  0.00000000e+00]
 [-8.67926250e-03  1.98866887e-02]]
grads:  [0.01706248 3.28819562]
Stock Position:  0.017062483924061043
Bond Position:  [-5.94502532]


portfolio before change:  [-4.34349619]
curr_Stock_Price:  93.90615760465681
curr_Factors:  [9.39061576e+01 4.65630444e-02]
mat_Sqrt:  [[ 2.02635137e+01  0.00000000e+00]
 [-8.63138871e-03  1.97769961e-02]]
grads:  [ 0.0179838  13.17967355]
Stock Position:  0.017983802257418965
Bond Position:  [-6.03228595]


portfolio before change:  [-4.3433362]
curr_Stock_Price:  93.95698487915297
curr_Factors:  [9.39569849e+01 4.71567817e-02]
mat_Sqrt:  [[ 2.04033346e+01  0.00000000e+00]
 [-8.68624492e-03  1.99026874e-02]]
grads:  [-0.02470878 14.62504076]
Stock Position:  -0.02470877955343236
Bond Position:  [-2.02177377]


portfolio before change:  [-4.3237447]
curr_Stock_Price:  93.15385972887657
curr_Factors:  [9.31538597e+01 4.77268845e-02]
mat_Sqrt:  [[ 2.03508427e+01  0.00000000e+00]
 [-8.73859344e-03  2.00226329e-02]]
grads:  [2.33843336e-03 1.03997275e+01]
Stock Position:  0.002338433362335064
Bond Position:  [-4.54157879]


portfolio before change:  [-4.32831653]
curr_Stock_Price:  91.44155715409897
curr_Factors:  [9.14415572e+01 4.89156474e-02]
mat_Sqrt:  [[ 2.02240214e+01  0.00000000e+00]
 [-8.84675284e-03  2.02704573e-02]]
grads:  [ 0.0995852  15.27950756]
Stock Position:  0.09958520437526469
Bond Position:  [-13.43454269]


portfolio before change:  [-4.38270325]
curr_Stock_Price:  90.91228882810294
curr_Factors:  [9.09122888e+01 4.73911487e-02]
mat_Sqrt:  [[ 1.97911582e+01  0.00000000e+00]
 [-8.70780328e-03  1.99520838e-02]]
grads:  [8.66851693e-03 1.81764306e+01]
Stock Position:  0.008668516930569792
Bond Position:  [-5.17077797]


portfolio before change:  [-4.37446648]
curr_Stock_Price:  91.93705049501837
curr_Factors:  [9.19370505e+01 4.73033485e-02]
mat_Sqrt:  [[ 1.99956952e+01  0.00000000e+00]
 [-8.69973319e-03  1.99335929e-02]]
grads:  [-3.19322958e-03  1.12372674e+01]
Stock Position:  -0.003193229576818248
Bond Position:  [-4.08089037]


portfolio before change:  [-4.37345874]
curr_Stock_Price:  91.46170877079679
curr_Factors:  [9.14617088e+01 4.86074845e-02]
mat_Sqrt:  [[ 2.01646591e+01  0.00000000e+00]
 [-8.81884206e-03  2.02065056e-02]]
grads:  [-0.00636132  2.88430262]
Stock Position:  -0.006361319375059034
Bond Position:  [-3.7916416]


portfolio before change:  [-4.359579]
curr_Stock_Price:  89.20530218486924
curr_Factors:  [8.92053022e+01 4.72333364e-02]
mat_Sqrt:  [[ 1.93871951e+01  0.00000000e+00]
 [-8.69329272e-03  1.99188360e-02]]
grads:  [ 0.01121627 -4.46433125]
Stock Position:  0.011216267446413013
Bond Position:  [-5.36012953]


portfolio before change:  [-4.36734226]
curr_Stock_Price:  88.57289968652334
curr_Factors:  [8.85728997e+01 4.74560599e-02]
mat_Sqrt:  [[ 1.92950852e+01  0.00000000e+00]
 [-8.71376474e-03  1.99657432e-02]]
grads:  [  0.02825386 -19.90334015]
Stock Position:  0.02825386122826092
Bond Position:  [-6.86986867]


portfolio before change:  [-4.38845097]
curr_Stock_Price:  87.85618628240688
curr_Factors:  [8.78561863e+01 4.77899504e-02]
mat_Sqrt:  [[ 1.92061642e+01  0.00000000e+00]
 [-8.74436508e-03  2.00358574e-02]]
grads:  [ 5.21725403e-03 -7.78456788e+00]
Stock Position:  0.005217254031450671
Bond Position:  [-4.84681901]


portfolio before change:  [-4.38631909]
curr_Stock_Price:  88.38093879070871
curr_Factors:  [8.83809388e+01 4.78537113e-02]
mat_Sqrt:  [[ 1.93337644e+01  0.00000000e+00]
 [-8.75019646e-03  2.00492188e-02]]
grads:  [  0.04136733 -16.76111884]
Stock Position:  0.04136733073703866
Bond Position:  [-8.04240262]


portfolio before change:  [-4.43908302]
curr_Stock_Price:  87.12974451747692
curr_Factors:  [8.71297445e+01 4.68058187e-02]
mat_Sqrt:  [[ 1.88502174e+01  0.00000000e+00]
 [-8.65386098e-03  1.98284865e-02]]
grads:  [ -0.06247386 -20.61424185]
Stock Position:  -0.06247386192101241
Bond Position:  [1.00424861]


portfolio before change:  [-4.34106557]
curr_Stock_Price:  85.56281863562867
curr_Factors:  [8.55628186e+01 4.75159052e-02]
mat_Sqrt:  [[ 1.86511058e+01  0.00000000e+00]
 [-8.71925732e-03  1.99783283e-02]]
grads:  [ 0.06784626 20.26120036]
Stock Position:  0.06784626304165478
Bond Position:  [-10.14618307]


portfolio before change:  [-4.25864073]
curr_Stock_Price:  86.7963897335332
curr_Factors:  [8.67963897e+01 4.83539542e-02]
mat_Sqrt:  [[ 1.90861204e+01  0.00000000e+00]
 [-8.79581302e-03  2.01537395e-02]]
grads:  [-5.65759862e-03  2.72501903e+01]
Stock Position:  -0.005657598620668
Bond Position:  [-3.7675816]


portfolio before change:  [-4.25157161]
curr_Stock_Price:  85.4636514572631
curr_Factors:  [8.54636515e+01 4.85799711e-02]
mat_Sqrt:  [[ 1.88369277e+01  0.00000000e+00]
 [-8.81634583e-03  2.02007861e-02]]
grads:  [0.06531156 4.1381853 ]
Stock Position:  0.0653115566629033
Bond Position:  [-9.83333573]


portfolio before change:  [-4.21543095]
curr_Stock_Price:  86.03583055276731
curr_Factors:  [8.60358306e+01 4.65882466e-02]
mat_Sqrt:  [[ 1.85702409e+01  0.00000000e+00]
 [-8.63372426e-03  1.97823475e-02]]
grads:  [-1.39526995e-03 -1.29522756e+01]
Stock Position:  -0.0013952699538762091
Bond Position:  [-4.09538774]


portfolio before change:  [-4.21538099]
curr_Stock_Price:  85.63309963769258
curr_Factors:  [8.56330996e+01 4.66784874e-02]
mat_Sqrt:  [[ 1.85012065e+01  0.00000000e+00]
 [-8.64208191e-03  1.98014973e-02]]
grads:  [ 3.76022410e-03 -3.76127778e+01]
Stock Position:  0.0037602241028758514
Bond Position:  [-4.53738063]


portfolio before change:  [-4.2263461]
curr_Stock_Price:  82.86786276662424
curr_Factors:  [8.28678628e+01 4.83891875e-02]
mat_Sqrt:  [[ 1.82288933e+01  0.00000000e+00]
 [-8.79901699e-03  2.01610807e-02]]
grads:  [ 0.01216462 -4.22223121]
Stock Position:  0.012164621811880709
Bond Position:  [-5.23440232]


portfolio before change:  [-4.21972175]
curr_Stock_Price:  83.46621255818032
curr_Factors:  [8.34662126e+01 4.60572066e-02]
mat_Sqrt:  [[ 1.79126361e+01  0.00000000e+00]
 [-8.58437712e-03  1.96692790e-02]]
grads:  [2.18375906e-02 5.93009233e+01]
Stock Position:  0.021837590568846935
Bond Position:  [-6.04242272]


portfolio before change:  [-4.2511581]
curr_Stock_Price:  82.06124992445835
curr_Factors:  [8.20612499e+01 4.72756186e-02]
mat_Sqrt:  [[ 1.78425424e+01  0.00000000e+00]
 [-8.69718286e-03  1.99277494e-02]]
grads:  [-0.0307443  -8.26711153]
Stock Position:  -0.030744297068334647
Bond Position:  [-1.72824265]


portfolio before change:  [-4.27835168]
curr_Stock_Price:  82.93873110834011
curr_Factors:  [8.29387311e+01 4.78699937e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.27835168]
Stock Price:  83.69722604614307
PL:  [-4.27835168]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.42629367e+00  4.33173087e-01]
 [ 7.27035086e-01  1.03754741e-01]
 [ 1.32920879e-02  5.61411131e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.24571458e-01  1.00391884e+00]
 [ 3.64594447e-03 -7.71020326e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 7.51188223e-01  7.36392686e-01]
 [ 5.59036769e-03  3.47318294e-01]
 [ 9.36115653e-02 -7.06081097e-02]
 [-6.60870230e-03  1.96085334e-02]
 [ 6.22257713e-02 -9.67460490e-02]
 [-1.17106251e-01 -2.80514051e-02]
 [-5.65927921e-02 -5.82661904e-03]
 [ 5.04122170e-01  3.29830717e-01]
 [ 1.30017625e-01  6.35193676e-02]
 [ 4.02923412e-02  1.27662691e-01]
 [ 6.91404884e-02  7.99306006e-02]
 [-9.46634373e-02 -7.29949511e-02]
 [-1.56957542e-01  1.25017128e-02]
 [ 1.63174172e-01 -2.26221529e-02]
 [ 1.37446207e+00  1.49202678e-01]
 [ 1.85469816e-02  2.21358701e-01]
 [-8.35420195e-02  7.16476596e-02]
 [ 1.06817770e-01 -3.43559773e-02]
 [ 1.43659615e-01 -9.85926739e-02]
 [ 8.38223937e-03 -3.04627407e-01]
 [ 4.88208143e-02  9.83150740e-02]
 [ 2.48435201e-01 -2.12183538e-02]
 [-5.36364121e-01 -1.56776572e-01]
 [-1.34750181e-01 -4.66268843e-02]
 [ 2.39613652e-03 -5.30756749e-02]
 [-4.37243410e-03  1.74829475e-01]
 [ 5.92908066e-03  1.17565043e-02]
 [-5.41995149e-02  7.75686253e-02]
 [-1.59731358e-01  1.06624906e-01]
 [-2.45859876e-02 -2.03006895e-01]
 [-8.88372977e-02 -5.59606968e-02]
 [ 1.08834075e-01 -1.27067099e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.71888079]
curr_Stock_Price:  97.61939717162845
curr_Factors:  [9.76193972e+01 4.20626875e-02]
mat_Sqrt:  [[ 2.00209477e+01  0.00000000e+00]
 [-8.20367601e-03  1.87969831e-02]]
grads:  [ 0.08068279 23.04481966]
Stock Position:  0.08068278918279581
Bond Position:  [-21.59508604]


portfolio before change:  [-13.58376159]
curr_Stock_Price:  99.3275528069576
curr_Factors:  [9.93275528e+01 4.05108556e-02]
mat_Sqrt:  [[ 1.99919632e+01  0.00000000e+00]
 [-8.05092348e-03  1.84469831e-02]]
grads:  [0.03863139 5.62448286]
Stock Position:  0.03863139201461848
Bond Position:  [-17.42092322]


portfolio before change:  [-13.64121831]
curr_Stock_Price:  97.89661873411552
curr_Factors:  [9.78966187e+01 4.11379159e-02]
mat_Sqrt:  [[ 1.98558661e+01  0.00000000e+00]
 [-8.11299362e-03  1.85892037e-02]]
grads:  [1.90342130e-03 3.02009242e+00]
Stock Position:  0.0019034213006772875
Bond Position:  [-13.82755682]


portfolio before change:  [-13.64399248]
curr_Stock_Price:  97.34728630339492
curr_Factors:  [9.73472863e+01 4.03037274e-02]
mat_Sqrt:  [[ 1.95432351e+01  0.00000000e+00]
 [-8.03031530e-03  1.83997639e-02]]
grads:  [-8.34118144e-04 -8.22764975e+00]
Stock Position:  -0.000834118143955309
Bond Position:  [-13.56279334]


portfolio before change:  [-13.64535477]
curr_Stock_Price:  96.94786694529084
curr_Factors:  [9.69478669e+01 3.89276818e-02]
mat_Sqrt:  [[ 1.91279104e+01  0.00000000e+00]
 [-7.89203971e-03  1.80829347e-02]]
grads:  [1.63935651e-02 5.55174730e+01]
Stock Position:  0.016393565053129687
Bond Position:  [-15.23467593]


portfolio before change:  [-13.63599192]
curr_Stock_Price:  97.63516746422238
curr_Factors:  [9.76351675e+01 3.96158633e-02]
mat_Sqrt:  [[ 1.94330442e+01  0.00000000e+00]
 [-7.96149366e-03  1.82420737e-02]]
grads:  [-1.54397536e-03 -4.22660461e+00]
Stock Position:  -0.001543975356676338
Bond Position:  [-13.48524562]


portfolio before change:  [-13.63799883]
curr_Stock_Price:  97.84316967381284
curr_Factors:  [9.78431697e+01 3.95055167e-02]
mat_Sqrt:  [[ 1.94473033e+01  0.00000000e+00]
 [-7.95039790e-03  1.82166501e-02]]
grads:  [0.00665253 5.27741855]
Stock Position:  0.006652530456635589
Bond Position:  [-14.28890349]


portfolio before change:  [-13.63530135]
curr_Stock_Price:  98.51715373004222
curr_Factors:  [9.85171537e+01 3.89058153e-02]
mat_Sqrt:  [[ 1.94320723e+01  0.00000000e+00]
 [-7.88982284e-03  1.80778552e-02]]
grads:  [ 0.05519619 40.73451621]
Stock Position:  0.05519618935042213
Bond Position:  [-19.07307282]


portfolio before change:  [-13.6793746]
curr_Stock_Price:  97.76186682631379
curr_Factors:  [9.77618668e+01 3.96330110e-02]
mat_Sqrt:  [[ 1.94624729e+01  0.00000000e+00]
 [-7.96321654e-03  1.82460213e-02]]
grads:  [8.07566949e-03 1.90352893e+01]
Stock Position:  0.008075669490536327
Bond Position:  [-14.46886712]


portfolio before change:  [-13.70037007]
curr_Stock_Price:  95.38599524621043
curr_Factors:  [9.53859952e+01 3.91604037e-02]
mat_Sqrt:  [[ 1.88759229e+01  0.00000000e+00]
 [-7.91559511e-03  1.81369069e-02]]
grads:  [ 3.32675971e-03 -3.89306237e+00]
Stock Position:  0.003326759709555118
Bond Position:  [-14.01769636]


portfolio before change:  [-13.70108111]
curr_Stock_Price:  95.69899607293397
curr_Factors:  [9.56989961e+01 3.86082651e-02]
mat_Sqrt:  [[ 1.88038823e+01  0.00000000e+00]
 [-7.85959440e-03  1.80085931e-02]]
grads:  [1.03657490e-04 1.08884315e+00]
Stock Position:  0.00010365749036822914
Bond Position:  [-13.71100103]


portfolio before change:  [-13.70281341]
curr_Stock_Price:  95.52227061030761
curr_Factors:  [9.55222706e+01 3.93179691e-02]
mat_Sqrt:  [[ 1.89408810e+01  0.00000000e+00]
 [-7.93150368e-03  1.81733580e-02]]
grads:  [ 1.05604031e-03 -5.32350978e+00]
Stock Position:  0.0010560403142357185
Bond Position:  [-13.80368878]


portfolio before change:  [-13.70235992]
curr_Stock_Price:  97.58569515023504
curr_Factors:  [9.75856952e+01 3.99419193e-02]
mat_Sqrt:  [[ 1.95029643e+01  0.00000000e+00]
 [-7.99418982e-03  1.83169900e-02]]
grads:  [-0.00663227 -1.53144186]
Stock Position:  -0.006632268123806934
Bond Position:  [-13.05514543]


portfolio before change:  [-13.71471436]
curr_Stock_Price:  99.20240322853353
curr_Factors:  [9.92024032e+01 3.80687949e-02]
mat_Sqrt:  [[ 1.93556053e+01  0.00000000e+00]
 [-7.80449049e-03  1.78823342e-02]]
grads:  [-0.00305523 -0.32583101]
Stock Position:  -0.003055225405390733
Bond Position:  [-13.41162866]


portfolio before change:  [-13.7135467]
curr_Stock_Price:  98.27146829589744
curr_Factors:  [9.82714683e+01 3.85762388e-02]
mat_Sqrt:  [[ 1.93013367e+01  0.00000000e+00]
 [-7.85633389e-03  1.80011224e-02]]
grads:  [ 0.03357654 18.32278622]
Stock Position:  0.03357653968962526
Bond Position:  [-17.01316256]


portfolio before change:  [-13.72260318]
curr_Stock_Price:  98.06508323884471
curr_Factors:  [9.80650832e+01 3.89377196e-02]
mat_Sqrt:  [[ 1.93508327e+01  0.00000000e+00]
 [-7.89305716e-03  1.80852660e-02]]
grads:  [0.00815157 3.51221639]
Stock Position:  0.008151574245443275
Bond Position:  [-14.52198798]


portfolio before change:  [-13.73147008]
curr_Stock_Price:  97.20003112021135
curr_Factors:  [9.72000311e+01 4.05405704e-02]
mat_Sqrt:  [[ 1.95709241e+01  0.00000000e+00]
 [-8.05387563e-03  1.84537474e-02]]
grads:  [4.90569107e-03 6.91798195e+00]
Stock Position:  0.0049056910749744964
Bond Position:  [-14.2083034]


portfolio before change:  [-13.73222469]
curr_Stock_Price:  97.40826515671327
curr_Factors:  [9.74082652e+01 4.12905610e-02]
mat_Sqrt:  [[ 1.97934364e+01  0.00000000e+00]
 [-8.12803159e-03  1.86236600e-02]]
grads:  [0.00525553 4.29188465]
Stock Position:  0.00525553321083268
Bond Position:  [-14.24415707]


portfolio before change:  [-13.73334897]
curr_Stock_Price:  97.53315361811256
curr_Factors:  [9.75331536e+01 3.95692925e-02]
mat_Sqrt:  [[ 1.94013258e+01  0.00000000e+00]
 [-7.95681268e-03  1.82313482e-02]]
grads:  [-0.00652126 -4.00381532]
Stock Position:  -0.006521257716071456
Bond Position:  [-13.09731014]


portfolio before change:  [-13.74234627]
curr_Stock_Price:  98.6617760741388
curr_Factors:  [9.86617761e+01 4.01334170e-02]
mat_Sqrt:  [[ 1.97652357e+01  0.00000000e+00]
 [-8.01333060e-03  1.83608470e-02]]
grads:  [-0.00766504  0.68088976]
Stock Position:  -0.007665041273856662
Bond Position:  [-12.98609969]


portfolio before change:  [-13.74066624]
curr_Stock_Price:  98.23080686326465
curr_Factors:  [9.82308069e+01 3.89732240e-02]
mat_Sqrt:  [[ 1.93923695e+01  0.00000000e+00]
 [-7.89665489e-03  1.80935094e-02]]
grads:  [ 0.00790523 -1.25029105]
Stock Position:  0.007905225570798976
Bond Position:  [-14.51720293]


portfolio before change:  [-13.7591677]
curr_Stock_Price:  96.11996246851251
curr_Factors:  [9.61199625e+01 4.05555501e-02]
mat_Sqrt:  [[ 1.93570308e+01  0.00000000e+00]
 [-8.05536344e-03  1.84571563e-02]]
grads:  [0.07436985 8.08373051]
Stock Position:  0.07436984925428705
Bond Position:  [-20.90759482]


portfolio before change:  [-13.64467625]
curr_Stock_Price:  97.69459342602025
curr_Factors:  [9.76945934e+01 4.06418664e-02]
mat_Sqrt:  [[ 1.96950620e+01  0.00000000e+00]
 [-8.06393119e-03  1.84767875e-02]]
grads:  [5.84693967e-03 1.19803673e+01]
Stock Position:  0.005846939668698355
Bond Position:  [-14.21589064]


portfolio before change:  [-13.64246595]
curr_Stock_Price:  98.37655741034519
curr_Factors:  [9.83765574e+01 3.95380742e-02]
mat_Sqrt:  [[ 1.95613749e+01  0.00000000e+00]
 [-7.95367328e-03  1.82241549e-02]]
grads:  [-2.67222614e-03  3.93146677e+00]
Stock Position:  -0.0026722261373438696
Bond Position:  [-13.37958154]


portfolio before change:  [-13.64785776]
curr_Stock_Price:  99.76837866518578
curr_Factors:  [9.97683787e+01 3.97000797e-02]
mat_Sqrt:  [[ 1.98787286e+01  0.00000000e+00]
 [-7.96995154e-03  1.82614531e-02]]
grads:  [ 0.00461919 -1.88133864]
Stock Position:  0.004619188410327031
Bond Position:  [-14.1087067]


portfolio before change:  [-13.65102315]
curr_Stock_Price:  99.46492763402867
curr_Factors:  [9.94649276e+01 3.99942360e-02]
mat_Sqrt:  [[ 1.98915522e+01  0.00000000e+00]
 [-7.99942358e-03  1.83289820e-02]]
grads:  [ 5.0589438e-03 -5.3790589e+00]
Stock Position:  0.005058943804548797
Bond Position:  [-14.15421063]


portfolio before change:  [-13.65456724]
curr_Stock_Price:  99.11412260160634
curr_Factors:  [9.91141226e+01 3.96593167e-02]
mat_Sqrt:  [[ 1.97382277e+01  0.00000000e+00]
 [-7.96585882e-03  1.82520755e-02]]
grads:  [-6.31100536e-03 -1.66900146e+01]
Stock Position:  -0.006311005363749547
Bond Position:  [-13.02905748]


portfolio before change:  [-13.65345659]
curr_Stock_Price:  98.68005720223864
curr_Factors:  [9.86800572e+01 4.19111083e-02]
mat_Sqrt:  [[ 2.02019813e+01  0.00000000e+00]
 [-8.18888107e-03  1.87630837e-02]]
grads:  [4.54059574e-03 5.23981429e+00]
Stock Position:  0.004540595742804976
Bond Position:  [-14.10152284]


portfolio before change:  [-13.66009665]
curr_Stock_Price:  97.6059119342902
curr_Factors:  [9.76059119e+01 4.16906161e-02]
mat_Sqrt:  [[ 1.99294485e+01  0.00000000e+00]
 [-8.16731202e-03  1.87136628e-02]]
grads:  [ 0.01200107 -1.13384291]
Stock Position:  0.012001072302594307
Bond Position:  [-14.83147226]


portfolio before change:  [-13.66080459]
curr_Stock_Price:  97.70141223263445
curr_Factors:  [9.77014122e+01 3.99139341e-02]
mat_Sqrt:  [[ 1.95192492e+01  0.00000000e+00]
 [-7.99138878e-03  1.83105720e-02]]
grads:  [-0.03098413 -8.56207945]
Stock Position:  -0.030984133662549655
Bond Position:  [-10.63361098]


portfolio before change:  [-13.65314504]
curr_Stock_Price:  97.41130131696005
curr_Factors:  [9.74113013e+01 4.00940255e-02]
mat_Sqrt:  [[ 1.95051447e+01  0.00000000e+00]
 [-8.00939704e-03  1.83518341e-02]]
grads:  [-0.00795174 -2.54072067]
Stock Position:  -0.007951739116901061
Bond Position:  [-12.87855579]


portfolio before change:  [-13.66329516]
curr_Stock_Price:  98.4853055372142
curr_Factors:  [9.84853055e+01 3.95681132e-02]
mat_Sqrt:  [[ 1.95904362e+01  0.00000000e+00]
 [-7.95669410e-03  1.82310765e-02]]
grads:  [-1.06010845e-03 -2.91127487e+00]
Stock Position:  -0.0010601084541258287
Bond Position:  [-13.55889006]


portfolio before change:  [-13.66469776]
curr_Stock_Price:  98.2095075320514
curr_Factors:  [9.82095075e+01 3.89796824e-02]
mat_Sqrt:  [[ 1.93897711e+01  0.00000000e+00]
 [-7.89730916e-03  1.80950085e-02]]
grads:  [3.70965723e-03 9.66175149e+00]
Stock Position:  0.0037096572280716175
Bond Position:  [-14.02902136]


portfolio before change:  [-13.66337439]
curr_Stock_Price:  99.03899110649635
curr_Factors:  [9.90389911e+01 3.89214467e-02]
mat_Sqrt:  [[ 1.95389263e+01  0.00000000e+00]
 [-7.89140766e-03  1.80814865e-02]]
grads:  [5.66051563e-04 6.50195673e-01]
Stock Position:  0.0005660515627329582
Bond Position:  [-13.71943557]


portfolio before change:  [-13.66473502]
curr_Stock_Price:  99.66509039011403
curr_Factors:  [9.96650904e+01 3.79928733e-02]
mat_Sqrt:  [[ 1.94264809e+01  0.00000000e+00]
 [-7.79670425e-03  1.78644937e-02]]
grads:  [-1.04732255e-03  4.34205562e+00]
Stock Position:  -0.0010473225470337252
Bond Position:  [-13.56035353]


portfolio before change:  [-13.66611853]
curr_Stock_Price:  99.36752559889801
curr_Factors:  [9.93675256e+01 3.83058481e-02]
mat_Sqrt:  [[ 1.94480927e+01  0.00000000e+00]
 [-7.82875195e-03  1.79379242e-02]]
grads:  [-5.82043880e-03  5.94410505e+00]
Stock Position:  -0.0058204388035421935
Bond Position:  [-13.08775593]


portfolio before change:  [-13.67381164]
curr_Stock_Price:  100.40817513590667
curr_Factors:  [1.00408175e+02 3.83313334e-02]
mat_Sqrt:  [[ 1.96583036e+01  0.00000000e+00]
 [-7.83135578e-03  1.79438903e-02]]
grads:  [-5.75764128e-03 -1.13134271e+01]
Stock Position:  -0.00575764128207882
Bond Position:  [-13.09569738]


portfolio before change:  [-13.66370952]
curr_Stock_Price:  98.36928787297754
curr_Factors:  [9.83692879e+01 4.07932338e-02]
mat_Sqrt:  [[ 1.98679745e+01  0.00000000e+00]
 [-8.07893397e-03  1.85111632e-02]]
grads:  [-0.00570066 -3.02307835]
Stock Position:  -0.00570065901341565
Bond Position:  [-13.10293975]


portfolio before change:  [-13.66658712]
curr_Stock_Price:  98.58674192074565
curr_Factors:  [9.85867419e+01 4.23313244e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.66658712]
Stock Price:  98.72051500635833
PL:  [-13.66658712]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.43423199e+00  3.53152333e-01]
 [ 8.74819505e-01  8.94101603e-02]
 [ 1.08755405e-01 -4.96648834e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.58768156e-02  1.92641263e-01]
 [-7.32075727e-02 -1.21114647e-01]
 [ 8.77417929e-02  9.56397259e-02]
 [ 4.06101161e-01  5.03350622e-01]
 [-8.21407118e-02  5.80108887e-02]
 [ 1.83580461e-01  5.46619198e-02]
 [-1.15091429e-01  1.35085628e-03]
 [ 2.16575559e-02 -1.35837825e-01]
 [-7.57520527e-02 -2.05721318e-02]
 [-3.80872012e-02 -4.14617182e-02]
 [ 4.12840404e-01  2.60667858e-01]
 [ 1.30151044e-01 -5.38846707e-01]
 [ 2.81865981e-02 -1.45949306e-01]
 [ 5.30159072e-03 -7.43863298e-02]
 [-6.45731004e-02 -4.66586994e-02]
 [-1.65251584e-01  1.73222141e-02]
 [ 1.72966526e-01 -3.86055853e-02]
 [ 1.08217964e+00  9.57726018e-02]
 [ 1.74881419e-02  2.89523508e-01]
 [-1.29940270e-01  9.93942761e-02]
 [-1.78982230e-01  1.92096113e-01]
 [ 1.44099034e-01 -9.81722566e-02]
 [-1.86028238e-01 -4.24199825e-01]
 [ 5.92083730e-02  7.62026936e-02]
 [ 2.93799490e-01 -6.34420749e-02]
 [-5.27445168e-01 -1.95392533e-01]
 [ 6.17162425e-02  2.57647873e-02]
 [-9.51301884e-02  1.16517429e-01]
 [ 3.56903575e-01  2.17717880e-01]
 [ 4.30524836e-02 -3.08502296e-02]
 [ 2.67768954e-01 -3.26469937e-01]
 [ 1.13201011e-01  4.68031743e-02]
 [-6.39260931e-02  3.01622364e-01]
 [-3.74006189e-01 -1.40397314e-01]
 [ 1.07132089e-02  4.25011413e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.53415804]
curr_Stock_Price:  99.53322514316338
curr_Factors:  [9.95332251e+01 3.98019261e-02]
mat_Sqrt:  [[ 1.98572965e+01  0.00000000e+00]
 [-7.98016802e-03  1.82848620e-02]]
grads:  [ 0.07998875 19.31391841]
Stock Position:  0.07998874909999344
Bond Position:  [-8.49569622]


portfolio before change:  [-0.57807509]
curr_Stock_Price:  98.99746202926437
curr_Factors:  [9.89974620e+01 3.99108817e-02]
mat_Sqrt:  [[ 1.97774239e+01  0.00000000e+00]
 [-7.99108320e-03  1.83098718e-02]]
grads:  [0.04620629 4.88316691]
Stock Position:  0.04620628566631148
Bond Position:  [-5.1523801]


portfolio before change:  [-0.57447888]
curr_Stock_Price:  99.08923100279686
curr_Factors:  [9.90892310e+01 3.79128541e-02]
mat_Sqrt:  [[ 1.92938856e+01  0.00000000e+00]
 [-7.78848937e-03  1.78456710e-02]]
grads:  [ 0.00451334 -2.78302134]
Stock Position:  0.004513340363767662
Bond Position:  [-1.0217023]


portfolio before change:  [-0.57630251]
curr_Stock_Price:  98.71347575182908
curr_Factors:  [9.87134758e+01 3.82298836e-02]
mat_Sqrt:  [[ 1.93009165e+01  0.00000000e+00]
 [-7.82098547e-03  1.79201290e-02]]
grads:  [-8.44590306e-04 -8.44786401e+00]
Stock Position:  -0.0008445903059268993
Bond Position:  [-0.49293006]


portfolio before change:  [-0.5767278]
curr_Stock_Price:  99.1440665665864
curr_Factors:  [9.91440666e+01 3.79110451e-02]
mat_Sqrt:  [[ 1.93041021e+01  0.00000000e+00]
 [-7.78830355e-03  1.78452453e-02]]
grads:  [4.24714107e-04 1.07951031e+01]
Stock Position:  0.00042471410664710225
Bond Position:  [-0.61883569]


portfolio before change:  [-0.57694486]
curr_Stock_Price:  98.8151494136873
curr_Factors:  [9.88151494e+01 3.85681997e-02]
mat_Sqrt:  [[ 1.94060978e+01  0.00000000e+00]
 [-7.85551523e-03  1.79992466e-02]]
grads:  [-6.49622297e-03 -6.72887314e+00]
Stock Position:  -0.006496222971542356
Bond Position:  [0.06498039]


portfolio before change:  [-0.58073162]
curr_Stock_Price:  99.39931717738644
curr_Factors:  [9.93993172e+01 3.80699218e-02]
mat_Sqrt:  [[ 1.93943127e+01  0.00000000e+00]
 [-7.80460601e-03  1.78825989e-02]]
grads:  [0.00667631 5.34820059]
Stock Position:  0.006676307297018423
Bond Position:  [-1.244352]


portfolio before change:  [-0.57667177]
curr_Stock_Price:  100.03071443907767
curr_Factors:  [1.00030714e+02 3.82535049e-02]
mat_Sqrt:  [[ 1.95645105e+01  0.00000000e+00]
 [-7.82340130e-03  1.79256643e-02]]
grads:  [ 0.03198554 28.07988664]
Stock Position:  0.03198553735026077
Bond Position:  [-3.77620792]


portfolio before change:  [-0.57559658]
curr_Stock_Price:  100.07908773658198
curr_Factors:  [1.00079088e+02 3.78916500e-02]
mat_Sqrt:  [[ 1.94811727e+01  0.00000000e+00]
 [-7.78631106e-03  1.78406799e-02]]
grads:  [-2.91679999e-03  3.25160750e+00]
Stock Position:  -0.002916799990212688
Bond Position:  [-0.2836859]


portfolio before change:  [-0.57275437]
curr_Stock_Price:  99.09250124925987
curr_Factors:  [9.90925012e+01 3.80832063e-02]
mat_Sqrt:  [[ 1.93378213e+01  0.00000000e+00]
 [-7.80596760e-03  1.78857187e-02]]
grads:  [0.010727   3.05617687]
Stock Position:  0.010727003584126663
Bond Position:  [-1.63571998]


portfolio before change:  [-0.57353878]
curr_Stock_Price:  99.03843803281846
curr_Factors:  [9.90384380e+01 3.69692428e-02]
mat_Sqrt:  [[ 1.90425042e+01  0.00000000e+00]
 [-7.69095498e-03  1.76221917e-02]]
grads:  [-0.00601296  0.07665654]
Stock Position:  -0.00601296265818583
Bond Position:  [0.02197565]


portfolio before change:  [-0.57987863]
curr_Stock_Price:  100.09325891764303
curr_Factors:  [1.00093259e+02 3.73310431e-02]
mat_Sqrt:  [[ 1.93392618e+01  0.00000000e+00]
 [-7.72849720e-03  1.77082117e-02]]
grads:  [-1.94562398e-03 -7.67089458e+00]
Stock Position:  -0.0019456239777352505
Bond Position:  [-0.38513479]


portfolio before change:  [-0.58185949]
curr_Stock_Price:  101.08662275488871
curr_Factors:  [1.01086623e+02 3.74551248e-02]
mat_Sqrt:  [[ 1.95636242e+01  0.00000000e+00]
 [-7.74133061e-03  1.77376168e-02]]
grads:  [-0.00433102 -1.15980247]
Stock Position:  -0.004331020995023321
Bond Position:  [-0.1440512]


portfolio before change:  [-0.58198781]
curr_Stock_Price:  101.11209362894692
curr_Factors:  [1.01112094e+02 3.66156205e-02]
mat_Sqrt:  [[ 1.93480100e+01  0.00000000e+00]
 [-7.65408341e-03  1.75377083e-02]]
grads:  [-0.00290379 -2.36414687]
Stock Position:  -0.002903791068902466
Bond Position:  [-0.28837942]


portfolio before change:  [-0.58037122]
curr_Stock_Price:  100.54296059531943
curr_Factors:  [1.00542961e+02 3.75961714e-02]
mat_Sqrt:  [[ 1.94950108e+01  0.00000000e+00]
 [-7.75589287e-03  1.77709831e-02]]
grads:  [ 0.02701231 14.66817325]
Stock Position:  0.027012305376545847
Bond Position:  [-3.29626837]


portfolio before change:  [-0.53552721]
curr_Stock_Price:  102.21834772351845
curr_Factors:  [1.02218348e+02 3.75451294e-02]
mat_Sqrt:  [[ 1.98064052e+01  0.00000000e+00]
 [-7.75062623e-03  1.77589157e-02]]
grads:  [-5.30237254e-03 -3.03423202e+01]
Stock Position:  -0.005302372541813502
Bond Position:  [0.00647255]


portfolio before change:  [-0.53735521]
curr_Stock_Price:  102.5632514536299
curr_Factors:  [1.02563251e+02 3.69651669e-02]
mat_Sqrt:  [[ 1.97191466e+01  0.00000000e+00]
 [-7.69053100e-03  1.76212202e-02]]
grads:  [-1.80083357e-03 -8.28258793e+00]
Stock Position:  -0.0018008335687181715
Bond Position:  [-0.35265586]


portfolio before change:  [-0.53266367]
curr_Stock_Price:  99.9335665349426
curr_Factors:  [9.99335665e+01 3.87566708e-02]
mat_Sqrt:  [[ 1.96736354e+01  0.00000000e+00]
 [-7.87468560e-03  1.80431714e-02]]
grads:  [-1.38069373e-03 -4.12268598e+00]
Stock Position:  -0.001380693734729874
Bond Position:  [-0.39468602]


portfolio before change:  [-0.53028819]
curr_Stock_Price:  98.17733761057906
curr_Factors:  [9.81773376e+01 3.82764168e-02]
mat_Sqrt:  [[ 1.92077674e+01  0.00000000e+00]
 [-7.82574385e-03  1.79310318e-02]]
grads:  [-0.00442199 -2.60212017]
Stock Position:  -0.004421993691985493
Bond Position:  [-0.09614862]


portfolio before change:  [-0.53215831]
curr_Stock_Price:  98.59753167786644
curr_Factors:  [9.85975317e+01 3.76316060e-02]
mat_Sqrt:  [[ 1.91268045e+01  0.00000000e+00]
 [-7.75954700e-03  1.77793557e-02]]
grads:  [-0.00824453  0.97428807]
Stock Position:  -0.00824453192454136
Bond Position:  [0.28073219]


portfolio before change:  [-0.5327992]
curr_Stock_Price:  98.67952388663407
curr_Factors:  [9.86795239e+01 3.73335575e-02]
mat_Sqrt:  [[ 1.90667527e+01  0.00000000e+00]
 [-7.72875747e-03  1.77088081e-02]]
grads:  [ 0.00818795 -2.18002167]
Stock Position:  0.00818795258403885
Bond Position:  [-1.34078246]


portfolio before change:  [-0.536731]
curr_Stock_Price:  98.21980040640135
curr_Factors:  [9.82198004e+01 3.52004306e-02]
mat_Sqrt:  [[ 1.84277807e+01  0.00000000e+00]
 [-7.50471112e-03  1.71954534e-02]]
grads:  [0.06099368 5.5696468 ]
Stock Position:  0.060993683761055566
Bond Position:  [-6.52751845]


portfolio before change:  [-0.58793117]
curr_Stock_Price:  97.3937447532683
curr_Factors:  [9.73937448e+01 3.49233320e-02]
mat_Sqrt:  [[ 1.82007339e+01  0.00000000e+00]
 [-7.47511413e-03  1.71276382e-02]]
grads:  [7.90333844e-03 1.69038781e+01]
Stock Position:  0.007903338438445052
Bond Position:  [-1.3576669]


portfolio before change:  [-0.59011276]
curr_Stock_Price:  97.1391853131334
curr_Factors:  [9.71391853e+01 3.48348230e-02]
mat_Sqrt:  [[ 1.81301443e+01  0.00000000e+00]
 [-7.46563572e-03  1.71059204e-02]]
grads:  [-4.77442707e-03  5.81051903e+00]
Stock Position:  -0.00477442706882291
Bond Position:  [-0.1263288]


portfolio before change:  [-0.58861935]
curr_Stock_Price:  96.82308457757478
curr_Factors:  [9.68230846e+01 3.40513271e-02]
mat_Sqrt:  [[ 1.78667654e+01  0.00000000e+00]
 [-7.38120067e-03  1.69124554e-02]]
grads:  [-5.32522875e-03  1.13582628e+01]
Stock Position:  -0.005325228753688935
Bond Position:  [-0.07301428]


portfolio before change:  [-0.58954298]
curr_Stock_Price:  96.99481510581471
curr_Factors:  [9.69948151e+01 3.38949803e-02]
mat_Sqrt:  [[ 1.78573172e+01  0.00000000e+00]
 [-7.36423577e-03  1.68735839e-02]]
grads:  [ 5.67012096e-03 -5.81810343e+00]
Stock Position:  0.005670120956511352
Bond Position:  [-1.13951532]


portfolio before change:  [-0.58453194]
curr_Stock_Price:  97.9036999255373
curr_Factors:  [9.79036999e+01 3.30612367e-02]
mat_Sqrt:  [[ 1.78015842e+01  0.00000000e+00]
 [-7.27309966e-03  1.66647649e-02]]
grads:  [-2.08500668e-02 -2.54548941e+01]
Stock Position:  -0.02085006683286714
Bond Position:  [1.45676674]


portfolio before change:  [-0.57544596]
curr_Stock_Price:  97.47665672888455
curr_Factors:  [9.74766567e+01 3.31955348e-02]
mat_Sqrt:  [[ 1.77598977e+01  0.00000000e+00]
 [-7.28785672e-03  1.66985775e-02]]
grads:  [0.00520645 4.56342424]
Stock Position:  0.005206446378177445
Bond Position:  [-1.08295294]


portfolio before change:  [-0.57733464]
curr_Stock_Price:  97.1398997192185
curr_Factors:  [9.71398997e+01 3.41054630e-02]
mat_Sqrt:  [[ 1.79394707e+01  0.00000000e+00]
 [-7.38706578e-03  1.69258941e-02]]
grads:  [ 0.01483383 -3.74822593]
Stock Position:  0.014833832169774432
Bond Position:  [-2.01829161]


portfolio before change:  [-0.58486681]
curr_Stock_Price:  96.64913857303529
curr_Factors:  [9.66491386e+01 3.52515510e-02]
mat_Sqrt:  [[ 1.81462589e+01  0.00000000e+00]
 [-7.51015856e-03  1.72079350e-02]]
grads:  [ -0.03376572 -11.35479258]
Stock Position:  -0.03376571799151231
Bond Position:  [2.67856074]


portfolio before change:  [-0.55275525]
curr_Stock_Price:  95.70804430051123
curr_Factors:  [9.57080443e+01 3.48918772e-02]
mat_Sqrt:  [[ 1.78776574e+01  0.00000000e+00]
 [-7.47174702e-03  1.71199231e-02]]
grads:  [0.00408112 1.50495929]
Stock Position:  0.004081122938142742
Bond Position:  [-0.94335154]


portfolio before change:  [-0.55609187]
curr_Stock_Price:  94.91936545471575
curr_Factors:  [9.49193655e+01 3.61225404e-02]
mat_Sqrt:  [[ 1.80403089e+01  0.00000000e+00]
 [-7.60237230e-03  1.74192233e-02]]
grads:  [-2.45438222e-03  6.68901405e+00]
Stock Position:  -0.0024543822150493878
Bond Position:  [-0.32312347]


portfolio before change:  [-0.55552768]
curr_Stock_Price:  94.6730353190188
curr_Factors:  [9.46730353e+01 3.52943268e-02]
mat_Sqrt:  [[ 1.77860190e+01  0.00000000e+00]
 [-7.51471376e-03  1.72183723e-02]]
grads:  [ 0.02540892 12.64450997]
Stock Position:  0.02540891512817628
Bond Position:  [-2.96106679]


portfolio before change:  [-0.56568681]
curr_Stock_Price:  94.28777756909908
curr_Factors:  [9.42877776e+01 3.51425958e-02]
mat_Sqrt:  [[ 1.76755248e+01  0.00000000e+00]
 [-7.49854342e-03  1.71813214e-02]]
grads:  [ 1.67397233e-03 -1.79556792e+00]
Stock Position:  0.0016739723327147294
Bond Position:  [-0.72352194]


portfolio before change:  [-0.56981793]
curr_Stock_Price:  91.87395685348943
curr_Factors:  [9.18739569e+01 3.61393332e-02]
mat_Sqrt:  [[ 1.74655589e+01  0.00000000e+00]
 [-7.60413921e-03  1.74232718e-02]]
grads:  [ 7.17330565e-03 -1.87375793e+01]
Stock Position:  0.00717330565109445
Bond Position:  [-1.2288579]


portfolio before change:  [-0.5685468]
curr_Stock_Price:  92.0725738987894
curr_Factors:  [9.20725739e+01 3.73218470e-02]
mat_Sqrt:  [[ 1.77873745e+01  0.00000000e+00]
 [-7.72754523e-03  1.77060305e-02]]
grads:  [0.0075125  2.64334654]
Stock Position:  0.007512496633410888
Bond Position:  [-1.26024171]


portfolio before change:  [-0.56025428]
curr_Stock_Price:  93.19737481990244
curr_Factors:  [9.31973748e+01 3.61605551e-02]
mat_Sqrt:  [[ 1.77223465e+01  0.00000000e+00]
 [-7.60637155e-03  1.74283867e-02]]
grads:  [3.82075244e-03 1.73063846e+01]
Stock Position:  0.003820752438368174
Bond Position:  [-0.91633838]


portfolio before change:  [-0.56565273]
curr_Stock_Price:  91.81442645545556
curr_Factors:  [9.18144265e+01 3.63102993e-02]
mat_Sqrt:  [[ 1.74954791e+01  0.00000000e+00]
 [-7.62210462e-03  1.74644357e-02]]
grads:  [-0.0248796  -8.03904098]
Stock Position:  -0.024879604507340707
Bond Position:  [1.71865388]


portfolio before change:  [-0.58115975]
curr_Stock_Price:  92.44634393256129
curr_Factors:  [9.24463439e+01 3.58931468e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.58115975]
Stock Price:  94.47254689338985
PL:  [-0.58115975]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.07278665e+00  2.71436783e-01]
 [ 7.70175358e-01  9.95214886e-02]
 [ 1.11882286e-01 -3.77736358e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.85684954e-02  1.80313391e-01]
 [-4.13462363e-01  2.58247368e-01]
 [ 4.14367894e-01 -4.97182214e-01]
 [-7.65403459e-01  5.04565126e-03]
 [-1.03847432e-01 -1.01779961e-01]
 [-2.59559258e-01 -5.19343770e-01]
 [-6.08715180e-02 -1.46737079e-02]
 [-6.95916042e-03 -1.36261457e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.27940415e-02 -5.56781336e-02]
 [ 3.29293913e-01  1.99325195e-01]
 [ 1.31656347e-01 -2.08357422e-01]
 [ 3.95341629e-02  1.03005014e-01]
 [-2.89122595e-03  5.33113559e-03]
 [-7.20266048e-02 -2.00974149e-01]
 [-4.25784570e-02 -5.91292144e-02]
 [ 1.71118042e-01 -3.98544832e-02]
 [ 7.04406546e-01 -9.06244797e-02]
 [ 3.03859614e-02 -4.03187901e-01]
 [ 5.68841033e-02  6.69355614e-03]
 [ 2.06150943e-01 -1.19410974e-01]
 [ 1.64701311e-01 -9.12052423e-02]
 [-1.67142260e-01  6.30666975e-02]
 [ 5.18269101e-02  1.97475228e-01]
 [-1.27221553e-02  1.79596595e-01]
 [-5.42355817e-01 -1.13538977e-01]
 [-1.66340085e-01 -6.13831143e-02]
 [ 8.10103625e-03 -6.89260242e-02]
 [-6.01659617e-02  1.65915285e-01]
 [ 2.37862868e-02  2.53049950e-02]
 [ 6.18713301e-02 -5.35729027e-03]
 [-2.12323822e-01  8.55628944e-02]
 [-2.12898764e-02 -2.34173707e-01]
 [-1.20923342e-03 -5.25425543e-02]
 [-4.69783139e-02 -3.82457603e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.27057683]
curr_Stock_Price:  101.10158605660935
curr_Factors:  [1.01101586e+02 3.86305626e-02]
mat_Sqrt:  [[ 1.98711721e+01  0.00000000e+00]
 [-7.86186366e-03  1.80137927e-02]]
grads:  [ 0.05994872 15.06827511]
Stock Position:  0.05994872217507379
Bond Position:  [4.20966593]


portfolio before change:  [10.15997232]
curr_Stock_Price:  99.24782268322853
curr_Factors:  [9.92478227e+01 4.01397609e-02]
mat_Sqrt:  [[ 1.98842117e+01  0.00000000e+00]
 [-8.01396390e-03  1.83622981e-02]]
grads:  [0.04091739 5.41988198]
Stock Position:  0.04091739257671825
Bond Position:  [6.0990102]


portfolio before change:  [10.18400931]
curr_Stock_Price:  99.81664097830706
curr_Factors:  [9.98166410e+01 4.09766976e-02]
mat_Sqrt:  [[ 2.02055850e+01  0.00000000e+00]
 [-8.09708072e-03  1.85527427e-02]]
grads:  [ 0.00472129 -2.03601357]
Stock Position:  0.004721294632908706
Bond Position:  [9.71274554]


portfolio before change:  [10.18246201]
curr_Stock_Price:  99.23174404284346
curr_Factors:  [9.92317440e+01 4.30414906e-02]
mat_Sqrt:  [[ 2.05870574e+01  0.00000000e+00]
 [-8.29857728e-03  1.90144293e-02]]
grads:  [-7.91825982e-04 -7.96168059e+00]
Stock Position:  -0.000791825982071525
Bond Position:  [10.26103628]


portfolio before change:  [10.18358666]
curr_Stock_Price:  99.43135425334198
curr_Factors:  [9.94313543e+01 4.25261695e-02]
mat_Sqrt:  [[ 2.05046088e+01  0.00000000e+00]
 [-8.24874968e-03  1.89002599e-02]]
grads:  [6.18008850e-06 9.54025989e+00]
Stock Position:  6.180088502246947e-06
Bond Position:  [10.18297216]


portfolio before change:  [10.18488274]
curr_Stock_Price:  103.17357114682116
curr_Factors:  [1.03173571e+02 4.31000985e-02]
mat_Sqrt:  [[ 2.14194145e+01  0.00000000e+00]
 [-8.30422528e-03  1.90273705e-02]]
grads:  [-0.01404119 13.572415  ]
Stock Position:  -0.014041185500071095
Bond Position:  [11.63356199]


portfolio before change:  [10.16404579]
curr_Stock_Price:  104.76113167867622
curr_Factors:  [1.04761132e+02 4.23205323e-02]
mat_Sqrt:  [[ 2.15514126e+01  0.00000000e+00]
 [-8.22878191e-03  1.88545080e-02]]
grads:  [ 9.15855448e-03 -2.63694080e+01]
Stock Position:  0.009158554479259621
Bond Position:  [9.20458526]


portfolio before change:  [10.16973113]
curr_Stock_Price:  105.25626370053588
curr_Factors:  [1.05256264e+02 4.30600414e-02]
mat_Sqrt:  [[ 2.18416363e+01  0.00000000e+00]
 [-8.30036542e-03  1.90185264e-02]]
grads:  [-0.0349425  0.2653019]
Stock Position:  -0.03494249906178714
Bond Position:  [13.84764803]


portfolio before change:  [10.19167342]
curr_Stock_Price:  104.67784987643039
curr_Factors:  [1.04677850e+02 4.31352387e-02]
mat_Sqrt:  [[ 2.17405685e+01  0.00000000e+00]
 [-8.30760988e-03  1.90351256e-02]]
grads:  [-0.00681987 -5.34695505]
Stock Position:  -0.006819869905470742
Bond Position:  [10.90556274]


portfolio before change:  [10.20389898]
curr_Stock_Price:  103.08511020114653
curr_Factors:  [1.03085110e+02 4.32963905e-02]
mat_Sqrt:  [[ 2.14497278e+01  0.00000000e+00]
 [-8.32311389e-03  1.90706497e-02]]
grads:  [-2.26678616e-02 -2.72326207e+01]
Stock Position:  -0.022667861598214503
Bond Position:  [12.54061799]


portfolio before change:  [10.22519588]
curr_Stock_Price:  102.21474910555769
curr_Factors:  [1.02214749e+02 4.18405698e-02]
mat_Sqrt:  [[ 2.09079938e+01  0.00000000e+00]
 [-8.18198702e-03  1.87472874e-02]]
grads:  [-0.0032177  -0.78271099]
Stock Position:  -0.0032176998872805364
Bond Position:  [10.55409226]


portfolio before change:  [10.22929537]
curr_Stock_Price:  101.35073263916851
curr_Factors:  [1.01350733e+02 4.22403269e-02]
mat_Sqrt:  [[ 2.08300603e+01  0.00000000e+00]
 [-8.22098066e-03  1.88366331e-02]]
grads:  [-3.18907072e-03 -7.23385415e+00]
Stock Position:  -0.0031890707224105845
Bond Position:  [10.55251002]


portfolio before change:  [10.22790843]
curr_Stock_Price:  102.1992815681312
curr_Factors:  [1.02199282e+02 4.27037761e-02]
mat_Sqrt:  [[ 2.11193712e+01  0.00000000e+00]
 [-8.26595680e-03  1.89396864e-02]]
grads:  [-0.00310187 -0.94457757]
Stock Position:  -0.0031018689234119756
Bond Position:  [10.54491721]


portfolio before change:  [10.23015104]
curr_Stock_Price:  101.9012645235447
curr_Factors:  [1.01901265e+02 4.14285393e-02]
mat_Sqrt:  [[ 2.07409853e+01  0.00000000e+00]
 [-8.14160075e-03  1.86547509e-02]]
grads:  [-2.75271258e-03 -2.98466241e+00]
Stock Position:  -0.0027527125839268973
Bond Position:  [10.51065593]


portfolio before change:  [10.23256885]
curr_Stock_Price:  101.50024170660883
curr_Factors:  [1.01500242e+02 4.07221800e-02]
mat_Sqrt:  [[ 2.04824822e+01  0.00000000e+00]
 [-8.07189495e-03  1.84950348e-02]]
grads:  [ 0.02032403 10.77722738]
Stock Position:  0.020324028912109958
Bond Position:  [8.169675]


portfolio before change:  [10.19992064]
curr_Stock_Price:  99.84360729763145
curr_Factors:  [9.98436073e+01 4.19318941e-02]
mat_Sqrt:  [[ 2.04452537e+01  0.00000000e+00]
 [-8.19091146e-03  1.87677359e-02]]
grads:  [ 1.99174408e-03 -1.11018944e+01]
Stock Position:  0.001991744082792468
Bond Position:  [10.00105772]


portfolio before change:  [10.19998361]
curr_Stock_Price:  99.2475280180657
curr_Factors:  [9.92475280e+01 4.26880055e-02]
mat_Sqrt:  [[ 2.05056070e+01  0.00000000e+00]
 [-8.26443034e-03  1.89361888e-02]]
grads:  [4.12029921e-03 5.43958529e+00]
Stock Position:  0.004120299213799876
Bond Position:  [9.7910541]


portfolio before change:  [10.19996128]
curr_Stock_Price:  98.94505294926684
curr_Factors:  [9.89450529e+01 4.27995982e-02]
mat_Sqrt:  [[ 2.04698156e+01  0.00000000e+00]
 [-8.27522550e-03  1.89609236e-02]]
grads:  [-2.75785400e-05  2.81164341e-01]
Stock Position:  -2.7578539993083152e-05
Bond Position:  [10.20269004]


portfolio before change:  [10.20122249]
curr_Stock_Price:  99.46026046402042
curr_Factors:  [9.94602605e+01 4.32263308e-02]
mat_Sqrt:  [[ 2.06787260e+01  0.00000000e+00]
 [-8.31637718e-03  1.90552140e-02]]
grads:  [-7.72479477e-03 -1.05469374e+01]
Stock Position:  -0.0077247947747995085
Bond Position:  [10.96953259]


portfolio before change:  [10.19307009]
curr_Stock_Price:  100.69313163758721
curr_Factors:  [1.00693132e+02 4.51527310e-02]
mat_Sqrt:  [[ 2.13964567e+01  0.00000000e+00]
 [-8.49966880e-03  1.94751878e-02]]
grads:  [-0.00319607 -3.03613064]
Stock Position:  -0.0031960694564089637
Bond Position:  [10.51489233]


portfolio before change:  [10.19286792]
curr_Stock_Price:  101.16765621496667
curr_Factors:  [1.01167656e+02 4.55589416e-02]
mat_Sqrt:  [[ 2.15937715e+01  0.00000000e+00]
 [-8.53781627e-03  1.95625947e-02]]
grads:  [ 0.00711891 -2.03728002]
Stock Position:  0.007118910138575914
Bond Position:  [9.47266447]


portfolio before change:  [10.19106989]
curr_Stock_Price:  100.74874558908546
curr_Factors:  [1.00748746e+02 4.50633795e-02]
mat_Sqrt:  [[ 2.13870816e+01  0.00000000e+00]
 [-8.49125475e-03  1.94559088e-02]]
grads:  [ 0.03108675 -4.65794122]
Stock Position:  0.03108674632683866
Bond Position:  [7.05911919]


portfolio before change:  [10.21690091]
curr_Stock_Price:  101.5512925009924
curr_Factors:  [1.01551293e+02 4.49884117e-02]
mat_Sqrt:  [[ 2.15395083e+01  0.00000000e+00]
 [-8.48418875e-03  1.94397186e-02]]
grads:  [-6.75872738e-03 -2.07404186e+01]
Stock Position:  -0.006758727377179238
Bond Position:  [10.90325841]


portfolio before change:  [10.21880628]
curr_Stock_Price:  101.47104343312644
curr_Factors:  [1.01471043e+02 4.48761305e-02]
mat_Sqrt:  [[ 2.14956126e+01  0.00000000e+00]
 [-8.47359480e-03  1.94154448e-02]]
grads:  [0.00278221 0.3447542 ]
Stock Position:  0.0027822147544092073
Bond Position:  [9.93649205]


portfolio before change:  [10.21815167]
curr_Stock_Price:  100.78930286417544
curr_Factors:  [1.00789303e+02 4.45776258e-02]
mat_Sqrt:  [[ 2.12800630e+01  0.00000000e+00]
 [-8.44536567e-03  1.93507637e-02]]
grads:  [ 0.0072385 -6.1708662]
Stock Position:  0.007238499350558907
Bond Position:  [9.48858837]


portfolio before change:  [10.21571224]
curr_Stock_Price:  100.28842820555326
curr_Factors:  [1.00288428e+02 4.42800869e-02]
mat_Sqrt:  [[ 2.11035276e+01  0.00000000e+00]
 [-8.41713366e-03  1.92860761e-02]]
grads:  [ 0.00591826 -4.729072  ]
Stock Position:  0.00591825603402131
Bond Position:  [9.62217964]


portfolio before change:  [10.22924081]
curr_Stock_Price:  102.37109001378502
curr_Factors:  [1.02371090e+02 4.27309488e-02]
mat_Sqrt:  [[ 2.11616046e+01  0.00000000e+00]
 [-8.26858622e-03  1.89457111e-02]]
grads:  [-0.00659769  3.32881131]
Stock Position:  -0.006597689521682618
Bond Position:  [10.90465348]


portfolio before change:  [10.24485847]
curr_Stock_Price:  100.21056298727339
curr_Factors:  [1.00210563e+02 4.37732691e-02]
mat_Sqrt:  [[ 2.09661164e+01  0.00000000e+00]
 [-8.36882492e-03  1.91753868e-02]]
grads:  [6.58262898e-03 1.02983700e+01]
Stock Position:  0.006582628975348665
Bond Position:  [9.58520951]


portfolio before change:  [10.24861601]
curr_Stock_Price:  100.59936105163558
curr_Factors:  [1.00599361e+02 4.33045177e-02]
mat_Sqrt:  [[ 2.09344630e+01  0.00000000e+00]
 [-8.32389502e-03  1.90724395e-02]]
grads:  [3.13646568e-03 9.41655076e+00]
Stock Position:  0.003136465676120636
Bond Position:  [9.93308956]


portfolio before change:  [10.24483938]
curr_Stock_Price:  98.99936411474597
curr_Factors:  [9.89993641e+01 4.40945211e-02]
mat_Sqrt:  [[ 2.07885750e+01  0.00000000e+00]
 [-8.39947818e-03  1.92456223e-02]]
grads:  [-0.02847277 -5.89947028]
Stock Position:  -0.028472768808667115
Bond Position:  [13.06362539]


portfolio before change:  [10.23557271]
curr_Stock_Price:  99.38217653871726
curr_Factors:  [9.93821765e+01 4.51284169e-02]
mat_Sqrt:  [[ 2.11122030e+01  0.00000000e+00]
 [-8.49738001e-03  1.94699436e-02]]
grads:  [-0.00914778 -3.15271147]
Stock Position:  -0.009147783971156405
Bond Position:  [11.14469939]


portfolio before change:  [10.23338523]
curr_Stock_Price:  99.77360003768506
curr_Factors:  [9.9773600e+01 4.5387692e-02]
mat_Sqrt:  [[ 2.12561542e+01  0.00000000e+00]
 [-8.52175493e-03  1.95257935e-02]]
grads:  [-1.03408861e-03 -3.52999862e+00]
Stock Position:  -0.0010340886072996516
Bond Position:  [10.33655997]


portfolio before change:  [10.23574181]
curr_Stock_Price:  98.74425100295086
curr_Factors:  [9.87442510e+01 4.61157442e-02]
mat_Sqrt:  [[ 2.12049099e+01  0.00000000e+00]
 [-8.58983066e-03  1.96817746e-02]]
grads:  [5.77479704e-04 8.42989457e+00]
Stock Position:  0.0005774797044571768
Bond Position:  [10.17871901]


portfolio before change:  [10.23753333]
curr_Stock_Price:  99.6431498021388
curr_Factors:  [9.96431498e+01 4.59218772e-02]
mat_Sqrt:  [[ 2.13529196e+01  0.00000000e+00]
 [-8.57175615e-03  1.96403607e-02]]
grads:  [0.00163117 1.28841804]
Stock Position:  0.001631172353776156
Bond Position:  [10.07499818]


portfolio before change:  [10.23614762]
curr_Stock_Price:  98.02151809487019
curr_Factors:  [9.80215181e+01 4.62708153e-02]
mat_Sqrt:  [[ 2.10850677e+01  0.00000000e+00]
 [-8.60426083e-03  1.97148383e-02]]
grads:  [ 0.00282348 -0.27173899]
Stock Position:  0.002823477626364287
Bond Position:  [9.95938606]


portfolio before change:  [10.24478553]
curr_Stock_Price:  100.63988742354373
curr_Factors:  [1.00639887e+02 4.59175145e-02]
mat_Sqrt:  [[ 2.15654899e+01  0.00000000e+00]
 [-8.57134898e-03  1.96394277e-02]]
grads:  [-0.00811394  4.35668979]
Stock Position:  -0.00811394104422867
Bond Position:  [11.06137164]


portfolio before change:  [10.23615218]
curr_Stock_Price:  101.87431894175593
curr_Factors:  [1.01874319e+02 4.42392506e-02]
mat_Sqrt:  [[ 2.14273567e+01  0.00000000e+00]
 [-8.41325151e-03  1.92771810e-02]]
grads:  [-5.76327089e-03 -1.21477154e+01]
Stock Position:  -0.005763270890075081
Bond Position:  [10.82328148]


portfolio before change:  [10.23572448]
curr_Stock_Price:  102.18329189073407
curr_Factors:  [1.02183292e+02 4.59698599e-02]
mat_Sqrt:  [[ 2.19086935e+01  0.00000000e+00]
 [-8.57623320e-03  1.96506189e-02]]
grads:  [-1.10187694e-03 -2.67383712e+00]
Stock Position:  -0.0011018769368029366
Bond Position:  [10.3483179]


portfolio before change:  [10.23665408]
curr_Stock_Price:  102.51366013880462
curr_Factors:  [1.02513660e+02 4.46558265e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.23665408]
Stock Price:  105.5085693235761
PL:  [4.72808476]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.00802480e+00  2.56795426e-01]
 [-2.39154477e-01 -8.92529293e-02]
 [-6.78231768e-01 -2.18053793e-01]
 [-1.05287904e-01 -1.16875614e-01]
 [-1.23937987e-01 -6.74167041e-01]
 [-3.68936336e-01  2.18870131e-01]
 [ 4.44204477e-01 -5.35496996e-01]
 [-8.31931780e-01  2.62315665e-02]
 [-1.08496079e-01 -8.39758329e-02]
 [-6.17879469e-01 -8.12562509e-01]
 [-3.66257594e-03 -2.18902785e-02]
 [-3.88767549e-01 -3.17590517e-01]
 [ 8.60482378e-03  6.89652672e-02]
 [ 2.21938621e-02 -1.90267680e-01]
 [-2.49378420e-01 -1.41642798e-01]
 [ 8.25721609e-02 -1.16036714e+00]
 [ 1.74184205e-02 -3.20506268e-01]
 [ 3.89592661e-02 -1.61081410e-01]
 [-1.22390316e-01 -3.85581263e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.51903476e-01 -3.19778338e-02]
 [ 4.48925807e-01 -3.03114802e-01]
 [ 2.85623416e-02 -3.68602299e-01]
 [ 2.57078608e-02  8.68546298e-02]
 [ 4.57706212e-01 -4.55908147e-01]
 [-2.58140648e-01  1.88622704e-02]
 [-1.51728238e-01  1.09688382e-01]
 [-3.74038655e-02  1.15931109e-01]
 [-4.16152468e-02  1.93955351e-01]
 [-6.98396398e-01  1.70080656e-01]
 [-1.20894586e-01  1.06960652e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.26984620e-01 -4.41051382e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.57132593e-01 -1.24586628e-01]
 [-3.40476255e-02 -1.16043643e-01]
 [ 1.58816499e-02 -6.30428572e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.38283552]
curr_Stock_Price:  101.69850082449341
curr_Factors:  [1.01698501e+02 4.01267873e-02]
mat_Sqrt:  [[ 2.03719099e+01  0.00000000e+00]
 [-8.01266870e-03  1.83593304e-02]]
grads:  [ 0.05498255 13.9871891 ]
Stock Position:  0.05498254806409654
Bond Position:  [8.79119281]


portfolio before change:  [14.37951751]
curr_Stock_Price:  101.61816656588807
curr_Factors:  [1.01618167e+02 3.98951102e-02]
mat_Sqrt:  [[ 2.02969690e+01  0.00000000e+00]
 [-7.98950413e-03  1.83062537e-02]]
grads:  [-0.01370193 -4.87554311]
Stock Position:  -0.013701929998309093
Bond Position:  [15.77188251]


portfolio before change:  [14.35708423]
curr_Stock_Price:  103.39929423558779
curr_Factors:  [1.03399294e+02 3.99155133e-02]
mat_Sqrt:  [[ 2.06580076e+01  0.00000000e+00]
 [-7.99154686e-03  1.83109342e-02]]
grads:  [ -0.03743818 -11.90839259]
Stock Position:  -0.037438181798632834
Bond Position:  [18.22816581]


portfolio before change:  [14.35720804]
curr_Stock_Price:  103.45685181079642
curr_Factors:  [1.03456852e+02 4.02345710e-02]
mat_Sqrt:  [[ 2.07519516e+01  0.00000000e+00]
 [-8.02342281e-03  1.83839712e-02]]
grads:  [-0.00753166 -6.35747371]
Stock Position:  -0.007531658079106977
Bond Position:  [15.13640968]


portfolio before change:  [14.35901526]
curr_Stock_Price:  103.46813139188258
curr_Factors:  [1.03468131e+02 3.96778326e-02]
mat_Sqrt:  [[ 2.06101226e+01  0.00000000e+00]
 [-7.96771812e-03  1.82563357e-02]]
grads:  [-2.02894769e-02 -3.69278399e+01]
Stock Position:  -0.020289476853293548
Bond Position:  [16.45832951]


portfolio before change:  [14.34687391]
curr_Stock_Price:  104.16794086730181
curr_Factors:  [1.04167941e+02 3.88194468e-02]
mat_Sqrt:  [[ 2.05238461e+01  0.00000000e+00]
 [-7.88106051e-03  1.80577782e-02]]
grads:  [-0.01332175 12.12054598]
Stock Position:  -0.013321751595957675
Bond Position:  [15.73457334]


portfolio before change:  [14.33525809]
curr_Stock_Price:  105.18753386440831
curr_Factors:  [1.05187534e+02 3.79642700e-02]
mat_Sqrt:  [[ 2.04951830e+01  0.00000000e+00]
 [-7.79376879e-03  1.78577677e-02]]
grads:  [ 1.02704342e-02 -2.99867825e+01]
Stock Position:  0.01027043418111656
Bond Position:  [13.25493645]


portfolio before change:  [14.34242651]
curr_Stock_Price:  105.72416631728639
curr_Factors:  [1.05724166e+02 3.76131527e-02]
mat_Sqrt:  [[ 2.05042618e+01  0.00000000e+00]
 [-7.75764425e-03  1.77749960e-02]]
grads:  [-0.04001526  1.47575654]
Stock Position:  -0.04001526100173449
Bond Position:  [18.57300662]


portfolio before change:  [14.41718916]
curr_Stock_Price:  103.91383501484566
curr_Factors:  [1.03913835e+02 3.85657891e-02]
mat_Sqrt:  [[ 2.04067801e+01  0.00000000e+00]
 [-7.85526974e-03  1.79986841e-02]]
grads:  [-0.00711264 -4.66566514]
Stock Position:  -0.007112642766939776
Bond Position:  [15.15629115]


portfolio before change:  [14.40205006]
curr_Stock_Price:  106.30869056394685
curr_Factors:  [1.06308691e+02 3.79428191e-02]
mat_Sqrt:  [[ 2.07077811e+01  0.00000000e+00]
 [-7.79156663e-03  1.78527219e-02]]
grads:  [ -0.04696355 -45.5147687 ]
Stock Position:  -0.04696354549647192
Bond Position:  [19.39468309]


portfolio before change:  [14.38305536]
curr_Stock_Price:  106.76477168763553
curr_Factors:  [1.06764772e+02 3.91013481e-02]
mat_Sqrt:  [[ 2.11117309e+01  0.00000000e+00]
 [-7.90962433e-03  1.81232261e-02]]
grads:  [-6.26015782e-04 -1.20785772e+00]
Stock Position:  -0.0006260157816736583
Bond Position:  [14.44989179]


portfolio before change:  [14.38453763]
curr_Stock_Price:  107.28245948570932
curr_Factors:  [1.07282459e+02 3.84603115e-02]
mat_Sqrt:  [[ 2.10394857e+01  0.00000000e+00]
 [-7.84452028e-03  1.79740540e-02]]
grads:  [ -0.02506598 -17.66938708]
Stock Position:  -0.02506598410560353
Bond Position:  [17.07367806]


portfolio before change:  [14.39374682]
curr_Stock_Price:  107.00021058658218
curr_Factors:  [1.07000211e+02 3.86577149e-02]
mat_Sqrt:  [[ 2.10379162e+01  0.00000000e+00]
 [-7.86462611e-03  1.80201222e-02]]
grads:  [1.83971329e-03 3.82712538e+00]
Stock Position:  0.0018397132850983236
Bond Position:  [14.19689711]


portfolio before change:  [14.3957722]
curr_Stock_Price:  107.13646027517207
curr_Factors:  [1.0713646e+02 3.8309976e-02]
mat_Sqrt:  [[ 2.09697491e+01  0.00000000e+00]
 [-7.82917375e-03  1.79388907e-02]]
grads:  [-2.90159702e-03 -1.06064351e+01]
Stock Position:  -0.0029015970197892337
Bond Position:  [14.70663904]


portfolio before change:  [14.39610152]
curr_Stock_Price:  107.6565639353626
curr_Factors:  [1.07656564e+02 3.70826028e-02]
mat_Sqrt:  [[ 2.07312562e+01  0.00000000e+00]
 [-7.70273747e-03  1.76491888e-02]]
grads:  [-0.01501098 -8.02545656]
Stock Position:  -0.015010976745789287
Bond Position:  [16.0121317]


portfolio before change:  [14.40360167]
curr_Stock_Price:  107.2902643597857
curr_Factors:  [1.07290264e+02 3.70639332e-02]
mat_Sqrt:  [[ 2.06555169e+01  0.00000000e+00]
 [-7.70079821e-03  1.76447454e-02]]
grads:  [-2.05201147e-02 -6.57627590e+01]
Stock Position:  -0.02052011468861516
Bond Position:  [16.6052102]


portfolio before change:  [14.44054765]
curr_Stock_Price:  105.59094657411895
curr_Factors:  [1.05590947e+02 3.77459640e-02]
mat_Sqrt:  [[ 2.05145476e+01  0.00000000e+00]
 [-7.77132823e-03  1.78063499e-02]]
grads:  [-5.96951906e-03 -1.79995490e+01]
Stock Position:  -0.005969519059651949
Bond Position:  [15.07087482]


portfolio before change:  [14.44481412]
curr_Stock_Price:  105.19183659429292
curr_Factors:  [1.05191837e+02 3.75817990e-02]
mat_Sqrt:  [[ 2.03925164e+01  0.00000000e+00]
 [-7.75441025e-03  1.77675860e-02]]
grads:  [-1.53695719e-03 -9.06602676e+00]
Stock Position:  -0.0015369571945474158
Bond Position:  [14.60648947]


portfolio before change:  [14.44814381]
curr_Stock_Price:  104.2134371717696
curr_Factors:  [1.04213437e+02 3.73010024e-02]
mat_Sqrt:  [[ 2.01272283e+01  0.00000000e+00]
 [-7.72538697e-03  1.77010853e-02]]
grads:  [-1.44417190e-02 -2.17829165e+01]
Stock Position:  -0.014441719012034086
Bond Position:  [15.95316498]


portfolio before change:  [14.46813732]
curr_Stock_Price:  102.96710079779041
curr_Factors:  [1.02967101e+02 3.92520374e-02]
mat_Sqrt:  [[ 2.03999727e+01  0.00000000e+00]
 [-7.92485078e-03  1.81581143e-02]]
grads:  [-2.37554583e-04 -6.00796908e+00]
Stock Position:  -0.000237554582603889
Bond Position:  [14.49259762]


portfolio before change:  [14.4699902]
curr_Stock_Price:  102.79369292870419
curr_Factors:  [1.02793693e+02 3.99562927e-02]
mat_Sqrt:  [[ 2.05475034e+01  0.00000000e+00]
 [-7.99562808e-03  1.83202855e-02]]
grads:  [ 0.00671357 -1.74548775]
Stock Position:  0.006713574963167466
Bond Position:  [13.77987703]


portfolio before change:  [14.4739989]
curr_Stock_Price:  103.13421363828282
curr_Factors:  [1.03134214e+02 4.12334537e-02]
mat_Sqrt:  [[ 2.09424563e+01  0.00000000e+00]
 [-8.12240888e-03  1.86107768e-02]]
grads:  [ 1.51193183e-02 -1.62870581e+01]
Stock Position:  0.015119318256955899
Bond Position:  [12.9146799]


portfolio before change:  [14.48169361]
curr_Stock_Price:  103.53636613478096
curr_Factors:  [1.03536366e+02 4.06525743e-02]
mat_Sqrt:  [[ 2.08755028e+01  0.00000000e+00]
 [-8.06499342e-03  1.84792214e-02]]
grads:  [-6.33799778e-03 -1.99468522e+01]
Stock Position:  -0.006337997778824089
Bond Position:  [15.13790687]


portfolio before change:  [14.47085032]
curr_Stock_Price:  105.54577809748855
curr_Factors:  [1.05545778e+02 3.94658438e-02]
mat_Sqrt:  [[ 2.09677371e+01  0.00000000e+00]
 [-7.94640485e-03  1.82075009e-02]]
grads:  [3.03391485e-03 4.77026641e+00]
Stock Position:  0.0030339148539918286
Bond Position:  [14.15063341]


portfolio before change:  [14.4739408]
curr_Stock_Price:  105.98136934033603
curr_Factors:  [1.05981369e+02 4.04989007e-02]
mat_Sqrt:  [[ 2.13280497e+01  0.00000000e+00]
 [-8.04973547e-03  1.84442611e-02]]
grads:  [ 1.21310475e-02 -2.47181574e+01]
Stock Position:  0.012131047509848749
Bond Position:  [13.18827578]


portfolio before change:  [14.45633328]
curr_Stock_Price:  104.39402400359559
curr_Factors:  [1.04394024e+02 4.03604155e-02]
mat_Sqrt:  [[ 2.09726569e+01  0.00000000e+00]
 [-8.03596072e-03  1.84126991e-02]]
grads:  [-0.01191592  1.02441637]
Stock Position:  -0.011915918882058122
Bond Position:  [15.700284]


portfolio before change:  [14.46302448]
curr_Stock_Price:  103.99719865686885
curr_Factors:  [1.03997199e+02 3.99391107e-02]
mat_Sqrt:  [[ 2.07836029e+01  0.00000000e+00]
 [-7.99390875e-03  1.83163460e-02]]
grads:  [-4.99703079e-03  5.98855153e+00]
Stock Position:  -0.004997030793595066
Bond Position:  [14.98270168]


portfolio before change:  [14.4663071]
curr_Stock_Price:  103.71509774699743
curr_Factors:  [1.03715098e+02 3.97886457e-02]
mat_Sqrt:  [[ 2.06881454e+01  0.00000000e+00]
 [-7.97883658e-03  1.82818113e-02]]
grads:  [6.37689763e-04 6.34133605e+00]
Stock Position:  0.0006376897630413957
Bond Position:  [14.40016904]


portfolio before change:  [14.46745625]
curr_Stock_Price:  102.6942532505725
curr_Factors:  [1.02694253e+02 4.20385788e-02]
mat_Sqrt:  [[ 2.10557228e+01  0.00000000e+00]
 [-8.20132465e-03  1.87915955e-02]]
grads:  [2.04380580e-03 1.03213881e+01]
Stock Position:  0.002043805795025373
Bond Position:  [14.25756914]


portfolio before change:  [14.47514353]
curr_Stock_Price:  105.58345800243356
curr_Factors:  [1.05583458e+02 4.11797317e-02]
mat_Sqrt:  [[ 2.14258292e+01  0.00000000e+00]
 [-8.11711591e-03  1.85986490e-02]]
grads:  [-0.02913153  9.14478551]
Stock Position:  -0.029131526683568477
Bond Position:  [17.55095085]


portfolio before change:  [14.45990873]
curr_Stock_Price:  106.18173785927614
curr_Factors:  [1.06181738e+02 4.01177561e-02]
mat_Sqrt:  [[ 2.12675835e+01  0.00000000e+00]
 [-8.01176696e-03  1.83572643e-02]]
grads:  [-0.00546496  0.58266118]
Stock Position:  -0.005464957512496361
Bond Position:  [15.04018742]


portfolio before change:  [14.46915753]
curr_Stock_Price:  104.83338998206511
curr_Factors:  [1.04833390e+02 4.04898433e-02]
mat_Sqrt:  [[ 2.10946672e+01  0.00000000e+00]
 [-8.04883528e-03  1.84421985e-02]]
grads:  [ 0.00343891 -0.64781805]
Stock Position:  0.0034389069092711105
Bond Position:  [14.10864527]


portfolio before change:  [14.47490012]
curr_Stock_Price:  105.99041303760785
curr_Factors:  [1.05990413e+02 4.03196648e-02]
mat_Sqrt:  [[ 2.12826176e+01  0.00000000e+00]
 [-8.03190287e-03  1.84034014e-02]]
grads:  [-0.01156971 -2.39657535]
Stock Position:  -0.011569708470393951
Bond Position:  [15.7011783]


portfolio before change:  [14.47008731]
curr_Stock_Price:  106.57604371849511
curr_Factors:  [1.06576044e+02 3.98301528e-02]
mat_Sqrt:  [[ 2.12699065e+01  0.00000000e+00]
 [-7.98299721e-03  1.82913445e-02]]
grads:  [0.00477064 2.91662873]
Stock Position:  0.004770644935478492
Bond Position:  [13.96165085]


portfolio before change:  [14.48474625]
curr_Stock_Price:  109.2829348628714
curr_Factors:  [1.09282935e+02 3.81971972e-02]
mat_Sqrt:  [[ 2.13583696e+01  0.00000000e+00]
 [-7.81764130e-03  1.79124665e-02]]
grads:  [-4.43234256e-03  4.54014226e+00]
Stock Position:  -0.004432342564422384
Bond Position:  [14.96912565]


portfolio before change:  [14.48303742]
curr_Stock_Price:  110.09065194347734
curr_Factors:  [1.10090652e+02 3.73390803e-02]
mat_Sqrt:  [[ 2.12731720e+01  0.00000000e+00]
 [-7.72932911e-03  1.77101179e-02]]
grads:  [-0.02404468 -7.03477128]
Stock Position:  -0.024044681983311354
Bond Position:  [17.13013214]


portfolio before change:  [14.45440231]
curr_Stock_Price:  111.37062361011061
curr_Factors:  [1.11370624e+02 3.79822486e-02]
mat_Sqrt:  [[ 2.17050598e+01  0.00000000e+00]
 [-7.79561401e-03  1.78619956e-02]]
grads:  [-3.90200369e-03 -6.49667850e+00]
Stock Position:  -0.003902003685632355
Bond Position:  [14.8889709]


portfolio before change:  [14.46081787]
curr_Stock_Price:  110.20344831157725
curr_Factors:  [1.10203448e+02 3.80470724e-02]
mat_Sqrt:  [[ 2.14959086e+01  0.00000000e+00]
 [-7.80226351e-03  1.78772316e-02]]
grads:  [-5.41149898e-04 -3.52643288e+00]
Stock Position:  -0.0005411498977120157
Bond Position:  [14.52045446]


portfolio before change:  [14.46261076]
curr_Stock_Price:  110.24462104931035
curr_Factors:  [1.10244621e+02 3.64477275e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.46261076]
Stock Price:  109.12273513335295
PL:  [5.33987563]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.45408717e+00  3.61098589e-01]
 [ 1.20153391e+00  5.87269681e-02]
 [ 7.86488976e-02  8.46791918e-03]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.66440318e-02  1.89127419e-01]
 [-1.44291559e-01 -4.63719682e-02]
 [ 9.98504607e-02  1.79702728e-02]
 [ 4.98688699e-01  5.64665362e-01]
 [ 3.84850510e-03  3.42649694e-01]
 [ 1.95042424e-01  1.04246614e-01]
 [-1.15219717e-01  3.02250875e-04]
 [ 2.82601833e-02 -1.35733790e-01]
 [-8.23819224e-02 -2.16591618e-02]
 [-3.88726864e-02 -4.08834845e-02]
 [ 2.53315053e-01  1.44056943e-01]
 [ 1.30989835e-01 -5.28790662e-01]
 [ 3.10039566e-02 -1.22956382e-01]
 [ 3.41891376e-02 -1.55880394e-01]
 [-1.24240529e-01 -3.63053912e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.48907044e-01 -3.10153083e-02]
 [ 5.55495921e-01 -2.10098670e-01]
 [ 3.02274123e-02 -4.12570960e-01]
 [ 4.84375380e-02  2.20266326e-02]
 [ 4.24403013e-01 -3.53261217e-01]
 [-2.94138108e-01  2.70055747e-02]
 [-1.39962855e-01  1.45250641e-01]
 [-1.28550273e-01 -2.43427602e-01]
 [-8.16140563e-02  2.14091134e-01]
 [-6.93738835e-01  1.80908818e-01]
 [-1.23714386e-01  1.27229283e-03]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.66524412e-01  7.19344200e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.19328701e-01  7.70690617e-03]
 [-2.60413247e-02 -1.90177789e-01]
 [-2.00293570e-03 -5.43226663e-02]
 [-5.99118333e-02 -4.34636820e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.1388414]
curr_Stock_Price:  98.71967752562223
curr_Factors:  [9.87196775e+01 3.94361834e-02]
mat_Sqrt:  [[ 1.96042922e+01  0.00000000e+00]
 [-7.94341825e-03  1.82006577e-02]]
grads:  [ 0.08221075 19.83986485]
Stock Position:  0.08221074763151634
Bond Position:  [-14.2546599]


portfolio before change:  [-6.20104726]
curr_Stock_Price:  97.98468944224071
curr_Factors:  [9.79846894e+01 4.11211519e-02]
mat_Sqrt:  [[ 1.98696792e+01  0.00000000e+00]
 [-8.11134040e-03  1.85854157e-02]]
grads:  [0.06176066 3.15984152]
Stock Position:  0.06176065759568199
Bond Position:  [-12.25264612]


portfolio before change:  [-6.17897692]
curr_Stock_Price:  98.36684237521077
curr_Factors:  [9.83668424e+01 4.12952744e-02]
mat_Sqrt:  [[ 1.99893609e+01  0.00000000e+00]
 [-8.12849550e-03  1.86247230e-02]]
grads:  [0.00411942 0.45466014]
Stock Position:  0.004119421375981237
Bond Position:  [-6.5841914]


portfolio before change:  [-6.17622986]
curr_Stock_Price:  99.23350252992915
curr_Factors:  [9.92335025e+01 4.05801424e-02]
mat_Sqrt:  [[ 1.99901063e+01  0.00000000e+00]
 [-8.05780540e-03  1.84627516e-02]]
grads:  [-8.15471749e-04 -8.19958021e+00]
Stock Position:  -0.0008154717493914038
Bond Position:  [-6.09530774]


portfolio before change:  [-6.17700508]
curr_Stock_Price:  99.24976223771766
curr_Factors:  [9.92497622e+01 4.05124403e-02]
mat_Sqrt:  [[ 1.99766968e+01  0.00000000e+00]
 [-8.05108096e-03  1.84473440e-02]]
grads:  [2.95241056e-04 1.02522845e+01]
Stock Position:  0.00029524105614635326
Bond Position:  [-6.20630769]


portfolio before change:  [-6.1776465]
curr_Stock_Price:  99.70504493054798
curr_Factors:  [9.97050449e+01 3.84562845e-02]
mat_Sqrt:  [[ 1.95524325e+01  0.00000000e+00]
 [-7.84410959e-03  1.79731130e-02]]
grads:  [-0.00841481 -2.58007437]
Stock Position:  -0.008414806988452712
Bond Position:  [-5.33864779]


portfolio before change:  [-6.18489753]
curr_Stock_Price:  100.48743412300786
curr_Factors:  [1.00487434e+02 3.93113874e-02]
mat_Sqrt:  [[ 1.99237435e+01  0.00000000e+00]
 [-7.93083979e-03  1.81718368e-02]]
grads:  [0.00540528 0.98890789]
Stock Position:  0.005405275900468946
Bond Position:  [-6.72805983]


portfolio before change:  [-6.19062837]
curr_Stock_Price:  99.58280212793065
curr_Factors:  [9.95828021e+01 3.89946110e-02]
mat_Sqrt:  [[ 1.96646689e+01  0.00000000e+00]
 [-7.89882128e-03  1.80984732e-02]]
grads:  [ 0.03789176 31.19961313]
Stock Position:  0.03789175758329233
Bond Position:  [-9.96399577]


portfolio before change:  [-6.25899467]
curr_Stock_Price:  97.81142157722807
curr_Factors:  [9.78114216e+01 4.01929931e-02]
mat_Sqrt:  [[ 1.96094199e+01  0.00000000e+00]
 [-8.01927609e-03  1.83744699e-02]]
grads:  [7.82241865e-03 1.86481404e+01]
Stock Position:  0.007822418645222297
Bond Position:  [-7.02411656]


portfolio before change:  [-6.25543679]
curr_Stock_Price:  98.37850374838729
curr_Factors:  [9.83785037e+01 3.97524191e-02]
mat_Sqrt:  [[ 1.96147146e+01  0.00000000e+00]
 [-7.97520348e-03  1.82734868e-02]]
grads:  [0.01226321 5.70480142]
Stock Position:  0.012263210571244772
Bond Position:  [-7.46187309]


portfolio before change:  [-6.24447586]
curr_Stock_Price:  99.34837349871837
curr_Factors:  [9.93483735e+01 3.86188090e-02]
mat_Sqrt:  [[ 1.95236134e+01  0.00000000e+00]
 [-7.86066756e-03  1.80110520e-02]]
grads:  [-0.0058948   0.01678141]
Stock Position:  -0.005894800366224184
Bond Position:  [-5.65883703]


portfolio before change:  [-6.2478218]
curr_Stock_Price:  99.7959771105475
curr_Factors:  [9.97959771e+01 3.88400277e-02]
mat_Sqrt:  [[ 1.96676649e+01  0.00000000e+00]
 [-7.88314939e-03  1.80625644e-02]]
grads:  [-1.57511833e-03 -7.51464672e+00]
Stock Position:  -0.0015751183258554554
Bond Position:  [-6.09063132]


portfolio before change:  [-6.25035749]
curr_Stock_Price:  100.9224430887025
curr_Factors:  [1.00922443e+02 3.83820382e-02]
mat_Sqrt:  [[ 1.97720533e+01  0.00000000e+00]
 [-7.83653375e-03  1.79557545e-02]]
grads:  [-0.00464467 -1.20625183]
Stock Position:  -0.004644674695814447
Bond Position:  [-5.78160557]


portfolio before change:  [-6.2513947]
curr_Stock_Price:  100.9901481312931
curr_Factors:  [1.00990148e+02 3.79271401e-02]
mat_Sqrt:  [[ 1.96677218e+01  0.00000000e+00]
 [-7.78995662e-03  1.78490329e-02]]
grads:  [-0.00288369 -2.29051539]
Stock Position:  -0.00288369453461053
Bond Position:  [-5.96016996]


portfolio before change:  [-6.25594771]
curr_Stock_Price:  102.31065448170833
curr_Factors:  [1.02310654e+02 3.90649162e-02]
mat_Sqrt:  [[ 2.02215439e+01  0.00000000e+00]
 [-7.90593865e-03  1.81147811e-02]]
grads:  [0.01563613 7.95245285]
Stock Position:  0.015636128402671635
Bond Position:  [-7.85569024]


portfolio before change:  [-6.25952564]
curr_Stock_Price:  102.14463428335608
curr_Factors:  [1.02144634e+02 3.88353755e-02]
mat_Sqrt:  [[ 2.01293297e+01  0.00000000e+00]
 [-7.88267727e-03  1.80614826e-02]]
grads:  [-4.95760823e-03 -2.92772567e+01]
Stock Position:  -0.004957608226074493
Bond Position:  [-5.75313256]


portfolio before change:  [-6.26040153]
curr_Stock_Price:  102.17624175970215
curr_Factors:  [1.02176242e+02 3.96623476e-02]
mat_Sqrt:  [[ 2.03488154e+01  0.00000000e+00]
 [-7.96616321e-03  1.82527729e-02]]
grads:  [-1.11350993e-03 -6.73631248e+00]
Stock Position:  -0.0011135099311135204
Bond Position:  [-6.14662727]


portfolio before change:  [-6.26256627]
curr_Stock_Price:  103.43025952997277
curr_Factors:  [1.0343026e+02 3.9493377e-02]
mat_Sqrt:  [[ 2.05546341e+01  0.00000000e+00]
 [-7.94917626e-03  1.82138510e-02]]
grads:  [-1.64647270e-03 -8.55834356e+00]
Stock Position:  -0.0016464726962103842
Bond Position:  [-6.09227117]


portfolio before change:  [-6.26498423]
curr_Stock_Price:  104.4362813692335
curr_Factors:  [1.04436281e+02 3.88531099e-02]
mat_Sqrt:  [[ 2.05856362e+01  0.00000000e+00]
 [-7.88447689e-03  1.80656061e-02]]
grads:  [-1.37324027e-02 -2.00964147e+01]
Stock Position:  -0.013732402729933806
Bond Position:  [-4.83082316]


portfolio before change:  [-6.26460392]
curr_Stock_Price:  104.36461125524119
curr_Factors:  [1.04364611e+02 3.84777076e-02]
mat_Sqrt:  [[ 2.04718860e+01  0.00000000e+00]
 [-7.84629416e-03  1.79781185e-02]]
grads:  [-2.36720105e-04 -6.06812050e+00]
Stock Position:  -0.00023672010510684496
Bond Position:  [-6.23989872]


portfolio before change:  [-6.26505953]
curr_Stock_Price:  102.9940806265072
curr_Factors:  [1.02994081e+02 3.91138260e-02]
mat_Sqrt:  [[ 2.03693615e+01  0.00000000e+00]
 [-7.91088628e-03  1.81261176e-02]]
grads:  [ 0.00664581 -1.71108392]
Stock Position:  0.006645807443826795
Bond Position:  [-6.94953835]


portfolio before change:  [-6.27199099]
curr_Stock_Price:  102.08181829200676
curr_Factors:  [1.02081818e+02 3.98242727e-02]
mat_Sqrt:  [[ 2.03714679e+01  0.00000000e+00]
 [-7.98240793e-03  1.82899943e-02]]
grads:  [  0.0227672  -11.48708234]
Stock Position:  0.022767202937683813
Bond Position:  [-8.59610847]


portfolio before change:  [-6.26570944]
curr_Stock_Price:  102.40492067365561
curr_Factors:  [1.02404921e+02 4.02483179e-02]
mat_Sqrt:  [[ 2.05444582e+01  0.00000000e+00]
 [-8.02479337e-03  1.83871115e-02]]
grads:  [-7.29312572e-03 -2.24380518e+01]
Stock Position:  -0.0072931257230561715
Bond Position:  [-5.51885747]


portfolio before change:  [-6.27101771]
curr_Stock_Price:  103.03817136807538
curr_Factors:  [1.03038171e+02 3.94984241e-02]
mat_Sqrt:  [[ 2.04780230e+01  0.00000000e+00]
 [-7.94968418e-03  1.82150147e-02]]
grads:  [0.00283478 1.20925692]
Stock Position:  0.002834782857258827
Bond Position:  [-6.56310855]


portfolio before change:  [-6.27008526]
curr_Stock_Price:  103.65652157071825
curr_Factors:  [1.03656522e+02 3.86997905e-02]
mat_Sqrt:  [[ 2.03915828e+01  0.00000000e+00]
 [-7.86890493e-03  1.80299262e-02]]
grads:  [ 1.32518981e-02 -1.95930484e+01]
Stock Position:  0.013251898103171764
Bond Position:  [-7.64373093]


portfolio before change:  [-6.25728157]
curr_Stock_Price:  104.69480428251654
curr_Factors:  [1.04694804e+02 3.79748551e-02]
mat_Sqrt:  [[ 2.04020211e+01  0.00000000e+00]
 [-7.79485524e-03  1.78602571e-02]]
grads:  [-0.01383941  1.51204848]
Stock Position:  -0.013839408750387049
Bond Position:  [-4.80836738]


portfolio before change:  [-6.26547778]
curr_Stock_Price:  105.24360806776524
curr_Factors:  [1.05243608e+02 3.85999711e-02]
mat_Sqrt:  [[ 2.06770805e+01  0.00000000e+00]
 [-7.85875014e-03  1.80066587e-02]]
grads:  [-3.70314745e-03  8.06649603e+00]
Stock Position:  -0.0037031474480518985
Bond Position:  [-5.87574518]


portfolio before change:  [-6.27308167]
curr_Stock_Price:  107.09862026407922
curr_Factors:  [1.07098620e+02 3.81486157e-02]
mat_Sqrt:  [[ 2.09181497e+01  0.00000000e+00]
 [-7.81266824e-03  1.79010718e-02]]
grads:  [-1.12242618e-02 -1.35984931e+01]
Stock Position:  -0.011224261766894813
Bond Position:  [-5.07097873]


portfolio before change:  [-6.25707153]
curr_Stock_Price:  105.6157563087432
curr_Factors:  [1.05615756e+02 3.84294939e-02]
mat_Sqrt:  [[ 2.07043235e+01  0.00000000e+00]
 [-7.84137681e-03  1.79668514e-02]]
grads:  [5.71038943e-04 1.19158961e+01]
Stock Position:  0.0005710389431780094
Bond Position:  [-6.31738224]


portfolio before change:  [-6.25785109]
curr_Stock_Price:  105.63356541180056
curr_Factors:  [1.05633565e+02 3.77906018e-02]
mat_Sqrt:  [[ 2.05349591e+01  0.00000000e+00]
 [-7.77592200e-03  1.78168756e-02]]
grads:  [-0.0299384  10.15379026]
Stock Position:  -0.029938396771486
Bond Position:  [-3.09535149]


portfolio before change:  [-6.26046166]
curr_Stock_Price:  105.70783882732518
curr_Factors:  [1.05707839e+02 3.74328587e-02]
mat_Sqrt:  [[ 2.04519015e+01  0.00000000e+00]
 [-7.73902927e-03  1.77323437e-02]]
grads:  [-0.00602189  0.07174984]
Stock Position:  -0.006021890528439262
Bond Position:  [-5.62390062]


portfolio before change:  [-6.25760324]
curr_Stock_Price:  105.11642268633737
curr_Factors:  [1.05116423e+02 3.78095716e-02]
mat_Sqrt:  [[ 2.04395557e+01  0.00000000e+00]
 [-7.77787340e-03  1.78213468e-02]]
grads:  [ 0.00354913 -0.67038643]
Stock Position:  0.003549127869997788
Bond Position:  [-6.63067487]


portfolio before change:  [-6.26496337]
curr_Stock_Price:  103.27618568082806
curr_Factors:  [1.03276186e+02 3.72205223e-02]
mat_Sqrt:  [[ 1.99246830e+01  0.00000000e+00]
 [-7.71704838e-03  1.76819792e-02]]
grads:  [-0.01180092  4.0682335 ]
Stock Position:  -0.011800923352809163
Bond Position:  [-5.04620902]


portfolio before change:  [-6.28303196]
curr_Stock_Price:  104.75384820495094
curr_Factors:  [1.04753848e+02 3.62826008e-02]
mat_Sqrt:  [[ 1.99535049e+01  0.00000000e+00]
 [-7.61919689e-03  1.74577732e-02]]
grads:  [0.00508538 3.0558915 ]
Stock Position:  0.0050853808611623814
Bond Position:  [-6.81574518]


portfolio before change:  [-6.28241246]
curr_Stock_Price:  105.04321183053298
curr_Factors:  [1.05043212e+02 3.70560954e-02]
mat_Sqrt:  [[ 2.02207761e+01  0.00000000e+00]
 [-7.69998393e-03  1.76428796e-02]]
grads:  [-0.0046817   4.60951658]
Stock Position:  -0.004681700166509784
Bond Position:  [-5.79063164]


portfolio before change:  [-6.27896286]
curr_Stock_Price:  104.1517678185442
curr_Factors:  [1.04151768e+02 3.74343286e-02]
mat_Sqrt:  [[ 2.01512351e+01  0.00000000e+00]
 [-7.73918121e-03  1.77326918e-02]]
grads:  [-0.01567969  0.43461569]
Stock Position:  -0.015679690601372847
Bond Position:  [-4.64589537]


portfolio before change:  [-6.26523803]
curr_Stock_Price:  103.23940236474449
curr_Factors:  [1.03239402e+02 3.92182945e-02]
mat_Sqrt:  [[ 2.04451280e+01  0.00000000e+00]
 [-7.92144376e-03  1.81503078e-02]]
grads:  [-5.33338389e-03 -1.04779374e+01]
Stock Position:  -0.005333383892724422
Bond Position:  [-5.71462266]


portfolio before change:  [-6.26173865]
curr_Stock_Price:  102.4493321650905
curr_Factors:  [1.02449332e+02 4.05155130e-02]
mat_Sqrt:  [[ 2.06214786e+01  0.00000000e+00]
 [-8.05138627e-03  1.84480435e-02]]
grads:  [-1.24682092e-03 -2.94463021e+00]
Stock Position:  -0.0012468209186268136
Bond Position:  [-6.13400268]


portfolio before change:  [-6.26216512]
curr_Stock_Price:  102.17637218281455
curr_Factors:  [1.02176372e+02 4.09382694e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.26216512]
Stock Price:  102.01322393840887
PL:  [-8.27538906]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.46609000e+00  3.62526706e-01]
 [ 3.53260825e-01  1.14107121e-01]
 [ 9.72764858e-02 -2.48569753e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.91326657e-02  7.00459457e-02]
 [-2.34062928e-02 -1.15099675e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.53081938e-01  8.48809010e-01]
 [ 3.67307017e-02  4.30507185e-01]
 [ 1.50183105e-01  2.98183384e-02]
 [-4.39322809e-02  1.57116128e-02]
 [ 7.09049553e-02 -1.05015750e-01]
 [-1.19107153e-01 -2.57178161e-02]
 [-1.22949468e-01  2.28251212e-01]
 [ 4.44066530e-01  2.92382195e-01]
 [ 1.30874835e-01  6.37203729e-02]
 [ 4.01652237e-02  8.21070259e-02]
 [ 2.69567623e-01  6.71568684e-02]
 [ 3.41225421e-01  3.52805570e-01]
 [-7.72415995e-01  3.73549582e-01]
 [-1.23350364e-01  2.72225746e-01]
 [ 1.72208470e+00  2.27147658e-01]
 [ 1.43469852e-02  4.04751502e-01]
 [-1.53962403e-01  1.93903388e-01]
 [-1.52114055e-01  5.57874404e-02]
 [ 2.43002830e-01 -8.37637200e-02]
 [ 5.82051791e-01 -4.09718409e-01]
 [ 1.31337823e-01 -7.73419354e-02]
 [ 6.88110736e-01 -3.15860163e-01]
 [-5.69887068e-01 -3.05926777e-01]
 [ 4.63236145e-01  1.74049223e-01]
 [-1.44077405e-01  2.00517823e-01]
 [ 5.81272445e-01  2.37511523e-01]
 [ 5.43319514e-02 -8.03694967e-02]
 [ 2.69181029e-01 -2.47201572e-01]
 [ 1.08604676e-01  5.26020486e-02]
 [-7.36566673e-02  4.56651442e-01]
 [-3.77547318e-01 -1.41237239e-01]
 [ 1.25199876e-01  3.08929321e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.122917]
curr_Stock_Price:  98.86714399636509
curr_Factors:  [9.88671440e+01 3.94647299e-02]
mat_Sqrt:  [[ 1.96406816e+01  0.00000000e+00]
 [-7.94629271e-03  1.82072439e-02]]
grads:  [ 0.08270129 19.9111248 ]
Stock Position:  0.08270128571670758
Bond Position:  [-13.29935692]


portfolio before change:  [-5.01466575]
curr_Stock_Price:  100.19618954010397
curr_Factors:  [1.00196190e+02 3.87297512e-02]
mat_Sqrt:  [[ 1.97184857e+01  0.00000000e+00]
 [-7.87195033e-03  1.80369041e-02]]
grads:  [0.02044078 6.32631409]
Stock Position:  0.02044078142305883
Bond Position:  [-7.06275416]


portfolio before change:  [-5.00977134]
curr_Stock_Price:  100.47882602682834
curr_Factors:  [1.00478826e+02 3.92417900e-02]
mat_Sqrt:  [[ 1.99043939e+01  0.00000000e+00]
 [-7.92381625e-03  1.81557439e-02]]
grads:  [ 0.00434216 -1.36909705]
Stock Position:  0.004342157466804584
Bond Position:  [-5.44606622]


portfolio before change:  [-5.00990497]
curr_Stock_Price:  100.60484018681727
curr_Factors:  [1.00604840e+02 3.92021332e-02]
mat_Sqrt:  [[ 1.99192841e+01  0.00000000e+00]
 [-7.91981143e-03  1.81465677e-02]]
grads:  [-8.18371127e-04 -8.34244884e+00]
Stock Position:  -0.0008183711269206555
Bond Position:  [-4.92757287]


portfolio before change:  [-5.01028399]
curr_Stock_Price:  100.31528655809683
curr_Factors:  [1.00315287e+02 4.03668315e-02]
mat_Sqrt:  [[ 2.01548444e+01  0.00000000e+00]
 [-8.03659943e-03  1.84141626e-02]]
grads:  [-2.90560957e-03  3.80391698e+00]
Stock Position:  -0.0029056095688986387
Bond Position:  [-4.71880693]


portfolio before change:  [-5.00527773]
curr_Stock_Price:  98.38930654659268
curr_Factors:  [9.83893065e+01 4.23196421e-02]
mat_Sqrt:  [[ 2.02403908e+01  0.00000000e+00]
 [-8.22869536e-03  1.88543097e-02]]
grads:  [-3.63826521e-03 -6.10468785e+00]
Stock Position:  -0.0036382652062389464
Bond Position:  [-4.64731134]


portfolio before change:  [-5.00336024]
curr_Stock_Price:  97.70259534479804
curr_Factors:  [9.77025953e+01 4.23264162e-02]
mat_Sqrt:  [[ 2.01007309e+01  0.00000000e+00]
 [-8.22935392e-03  1.88558186e-02]]
grads:  [0.00643627 5.0985263 ]
Stock Position:  0.006436272287387384
Bond Position:  [-5.63220075]


portfolio before change:  [-5.00347372]
curr_Stock_Price:  97.79435469825356
curr_Factors:  [9.77943547e+01 4.05009263e-02]
mat_Sqrt:  [[ 1.96809593e+01  0.00000000e+00]
 [-8.04993677e-03  1.84447223e-02]]
grads:  [ 0.06216834 46.01907234]
Stock Position:  0.062168339575884295
Bond Position:  [-11.08318638]


portfolio before change:  [-5.06284879]
curr_Stock_Price:  96.86157149406762
curr_Factors:  [9.68615715e+01 4.05725834e-02]
mat_Sqrt:  [[ 1.95104750e+01  0.00000000e+00]
 [-8.05705489e-03  1.84610320e-02]]
grads:  [1.15127613e-02 2.33197790e+01]
Stock Position:  0.01151276130572648
Bond Position:  [-6.17799294]


portfolio before change:  [-5.07197684]
curr_Stock_Price:  96.13578969771507
curr_Factors:  [9.61357897e+01 3.84359204e-02]
mat_Sqrt:  [[ 1.88474995e+01  0.00000000e+00]
 [-7.84203243e-03  1.79683536e-02]]
grads:  [0.00865881 1.65949196]
Stock Position:  0.008658808805576521
Bond Position:  [-5.90439826]


portfolio before change:  [-5.06329278]
curr_Stock_Price:  97.22394830096871
curr_Factors:  [9.72239483e+01 3.73886874e-02]
mat_Sqrt:  [[ 1.87993729e+01  0.00000000e+00]
 [-7.73446183e-03  1.77218784e-02]]
grads:  [-0.00197215  0.88656589]
Stock Position:  -0.0019721493397507764
Bond Position:  [-4.87155264]


portfolio before change:  [-5.06239709]
curr_Stock_Price:  96.46098974508149
curr_Factors:  [9.64609897e+01 3.94915977e-02]
mat_Sqrt:  [[ 1.91692034e+01  0.00000000e+00]
 [-7.94899719e-03  1.82134407e-02]]
grads:  [ 1.30794816e-03 -5.76583810e+00]
Stock Position:  0.0013079481626583947
Bond Position:  [-5.18856307]


portfolio before change:  [-5.06303051]
curr_Stock_Price:  96.47260615535076
curr_Factors:  [9.64726062e+01 4.00503422e-02]
mat_Sqrt:  [[ 1.93066590e+01  0.00000000e+00]
 [-8.00503264e-03  1.83418340e-02]]
grads:  [-0.00675059 -1.40213983]
Stock Position:  -0.006750589436014328
Bond Position:  [-4.41178356]


portfolio before change:  [-5.06499438]
curr_Stock_Price:  96.68182617344038
curr_Factors:  [9.66818262e+01 3.78970267e-02]
mat_Sqrt:  [[ 1.88212045e+01  0.00000000e+00]
 [-7.78686347e-03  1.78419456e-02]]
grads:  [-1.23969067e-03  1.27929552e+01]
Stock Position:  -0.001239690672525408
Bond Position:  [-4.94513882]


portfolio before change:  [-5.06605636]
curr_Stock_Price:  97.03981664786274
curr_Factors:  [9.70398166e+01 3.87175019e-02]
mat_Sqrt:  [[ 1.90942952e+01  0.00000000e+00]
 [-7.87070537e-03  1.80340516e-02]]
grads:  [ 0.02993944 16.21278468]
Stock Position:  0.02993944402309877
Bond Position:  [-7.97137451]


portfolio before change:  [-5.06271787]
curr_Stock_Price:  97.18460793303882
curr_Factors:  [9.71846079e+01 3.96080727e-02]
mat_Sqrt:  [[ 1.93414639e+01  0.00000000e+00]
 [-7.96071079e-03  1.82402799e-02]]
grads:  [0.00820438 3.49338789]
Stock Position:  0.008204378243365229
Bond Position:  [-5.86005715]


portfolio before change:  [-5.07693809]
curr_Stock_Price:  95.54064758903411
curr_Factors:  [9.55406476e+01 3.97347959e-02]
mat_Sqrt:  [[ 1.90446798e+01  0.00000000e+00]
 [-7.97343549e-03  1.82694358e-02]]
grads:  [3.99059835e-03 4.49422886e+00]
Stock Position:  0.003990598352766028
Bond Position:  [-5.45820245]


portfolio before change:  [-5.08141819]
curr_Stock_Price:  94.5889670250724
curr_Factors:  [9.45889670e+01 4.17390799e-02]
mat_Sqrt:  [[ 1.93246625e+01  0.00000000e+00]
 [-8.17205774e-03  1.87245366e-02]]
grads:  [0.01546611 3.58657039]
Stock Position:  0.015466106220250268
Bond Position:  [-6.5443412]


portfolio before change:  [-5.107589]
curr_Stock_Price:  92.94972310618023
curr_Factors:  [9.29497231e+01 4.38285575e-02]
mat_Sqrt:  [[ 1.94592765e+01  0.00000000e+00]
 [-8.37410843e-03  1.91874929e-02]]
grads:  [ 0.02544814 18.3872678 ]
Stock Position:  0.025448140150293314
Bond Position:  [-7.47298658]


portfolio before change:  [-5.119871]
curr_Stock_Price:  92.50380377082912
curr_Factors:  [9.25038038e+01 4.35693093e-02]
mat_Sqrt:  [[ 1.93085619e+01  0.00000000e+00]
 [-8.34930505e-03  1.91306612e-02]]
grads:  [-0.03156038 19.52622434]
Stock Position:  -0.03156038210080589
Bond Position:  [-2.20041561]


portfolio before change:  [-5.11180339]
curr_Stock_Price:  92.23946343190553
curr_Factors:  [9.22394634e+01 4.52400440e-02]
mat_Sqrt:  [[ 1.96190637e+01  0.00000000e+00]
 [-8.50788284e-03  1.94940086e-02]]
grads:  [-2.31474220e-04  1.39645853e+01]
Stock Position:  -0.00023147422049050385
Bond Position:  [-5.09045233]


portfolio before change:  [-5.11270871]
curr_Stock_Price:  93.40145381261488
curr_Factors:  [9.34014538e+01 4.40478958e-02]
mat_Sqrt:  [[ 1.96027147e+01  0.00000000e+00]
 [-8.39503623e-03  1.92354445e-02]]
grads:  [ 0.09290652 11.80880735]
Stock Position:  0.09290652312699298
Bond Position:  [-13.79031303]


portfolio before change:  [-5.1938563]
curr_Stock_Price:  92.54657633177544
curr_Factors:  [9.25465763e+01 4.32479590e-02]
mat_Sqrt:  [[ 1.92461189e+01  0.00000000e+00]
 [-8.31845745e-03  1.90599805e-02]]
grads:  [9.92382015e-03 2.12356724e+01]
Stock Position:  0.009923820146989315
Bond Position:  [-6.11227188]


portfolio before change:  [-5.18820408]
curr_Stock_Price:  93.19313212945549
curr_Factors:  [9.31931321e+01 4.36844751e-02]
mat_Sqrt:  [[ 1.94781394e+01  0.00000000e+00]
 [-8.36033253e-03  1.91559283e-02]]
grads:  [-3.55968431e-03  1.01223697e+01]
Stock Position:  -0.003559684308258465
Bond Position:  [-4.85646595]


portfolio before change:  [-5.18217851]
curr_Stock_Price:  91.32985913959651
curr_Factors:  [9.13298591e+01 4.46789548e-02]
mat_Sqrt:  [[ 1.93047548e+01  0.00000000e+00]
 [-8.45495877e-03  1.93727443e-02]]
grads:  [-0.00661839  2.87968703]
Stock Position:  -0.006618391234245722
Bond Position:  [-4.57772177]


portfolio before change:  [-5.17251316]
curr_Stock_Price:  89.7830188427888
curr_Factors:  [8.97830188e+01 4.33835648e-02]
mat_Sqrt:  [[ 1.87006551e+01  0.00000000e+00]
 [-8.33148868e-03  1.90898388e-02]]
grads:  [ 0.01103947 -4.38786943]
Stock Position:  0.01103947127841589
Bond Position:  [-6.16367022]


portfolio before change:  [-5.17350134]
curr_Stock_Price:  89.76330200330604
curr_Factors:  [8.9763302e+01 4.5227318e-02]
mat_Sqrt:  [[ 1.90897059e+01  0.00000000e+00]
 [-8.50668612e-03  1.94912665e-02]]
grads:  [  0.02112322 -21.02061497]
Stock Position:  0.021123217914906827
Bond Position:  [-7.06959112]


portfolio before change:  [-5.14479895]
curr_Stock_Price:  91.16394759626839
curr_Factors:  [9.11639476e+01 4.65071547e-02]
mat_Sqrt:  [[ 1.96599771e+01  0.00000000e+00]
 [-8.62620701e-03  1.97651233e-02]]
grads:  [ 0.00496354 -3.91305099]
Stock Position:  0.0049635375987678665
Bond Position:  [-5.59729463]


portfolio before change:  [-5.14175728]
curr_Stock_Price:  91.91771876758355
curr_Factors:  [9.19177188e+01 4.65617935e-02]
mat_Sqrt:  [[ 1.98341726e+01  0.00000000e+00]
 [-8.63127277e-03  1.97767304e-02]]
grads:  [  0.02774293 -15.97130345]
Stock Position:  0.02774292988355573
Bond Position:  [-7.69182411]


portfolio before change:  [-5.10812697]
curr_Stock_Price:  93.16458958590516
curr_Factors:  [9.31645896e+01 4.56680051e-02]
mat_Sqrt:  [[ 1.99093415e+01  0.00000000e+00]
 [-8.54802949e-03  1.95859961e-02]]
grads:  [ -0.03533037 -15.61966906]
Stock Position:  -0.03533037296656451
Bond Position:  [-1.81658727]


portfolio before change:  [-5.05027763]
curr_Stock_Price:  91.5207794149911
curr_Factors:  [9.15207794e+01 4.69143888e-02]
mat_Sqrt:  [[ 1.98231534e+01  0.00000000e+00]
 [-8.66389186e-03  1.98514701e-02]]
grads:  [0.02720039 8.76757348]
Stock Position:  0.02720038747545795
Bond Position:  [-7.53967829]


portfolio before change:  [-5.00185104]
curr_Stock_Price:  93.3357943136757
curr_Factors:  [9.33357943e+01 4.76239466e-02]
mat_Sqrt:  [[ 2.03685878e+01  0.00000000e+00]
 [-8.72916460e-03  2.00010288e-02]]
grads:  [-2.77703359e-03  1.00253755e+01]
Stock Position:  -0.002777033586169832
Bond Position:  [-4.74265441]


portfolio before change:  [-5.00001134]
curr_Stock_Price:  92.45983607613769
curr_Factors:  [9.24598361e+01 4.67333390e-02]
mat_Sqrt:  [[ 1.99878704e+01  0.00000000e+00]
 [-8.64715805e-03  1.98131282e-02]]
grads:  [ 0.03426733 11.98758323]
Stock Position:  0.03426733101980612
Bond Position:  [-8.16836315]


portfolio before change:  [-5.00219257]
curr_Stock_Price:  92.42598111636885
curr_Factors:  [9.24259811e+01 4.65664866e-02]
mat_Sqrt:  [[ 1.99448514e+01  0.00000000e+00]
 [-8.63170774e-03  1.97777271e-02]]
grads:  [ 9.65453537e-04 -4.06363666e+00]
Stock Position:  0.0009654535365860884
Bond Position:  [-5.09142556]


portfolio before change:  [-5.00189623]
curr_Stock_Price:  93.39216986440867
curr_Factors:  [9.33921699e+01 4.60763721e-02]
mat_Sqrt:  [[ 2.00470099e+01  0.00000000e+00]
 [-8.58616302e-03  1.96733710e-02]]
grads:  [ 8.04575939e-03 -1.25652880e+01]
Stock Position:  0.008045759390921508
Bond Position:  [-5.75330716]


portfolio before change:  [-5.01041278]
curr_Stock_Price:  92.42304578491236
curr_Factors:  [9.24230458e+01 4.77829285e-02]
mat_Sqrt:  [[ 2.02030369e+01  0.00000000e+00]
 [-8.74372264e-03  2.00343854e-02]]
grads:  [0.006512   2.62558833]
Stock Position:  0.006511995817724866
Bond Position:  [-5.61227127]


portfolio before change:  [-5.01737583]
curr_Stock_Price:  91.46151594392072
curr_Factors:  [9.14615159e+01 4.94995307e-02]
mat_Sqrt:  [[ 2.03488062e+01  0.00000000e+00]
 [-8.89939600e-03  2.03910779e-02]]
grads:  [6.17443401e-03 2.23946691e+01]
Stock Position:  0.006174434009858447
Bond Position:  [-5.58209893]


portfolio before change:  [-5.01641539]
curr_Stock_Price:  91.7300835561505
curr_Factors:  [9.17300836e+01 4.91398633e-02]
mat_Sqrt:  [[ 2.03342782e+01  0.00000000e+00]
 [-8.86700521e-03  2.03168613e-02]]
grads:  [-0.02159842 -6.95172533]
Stock Position:  -0.021598421043599363
Bond Position:  [-3.03519042]


portfolio before change:  [-5.06394036]
curr_Stock_Price:  93.91290771193397
curr_Factors:  [9.39129077e+01 4.88434782e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.06394036]
Stock Price:  95.99355495859358
PL:  [-5.06394036]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.43631407e+00  3.59754888e-01]
 [ 1.01063454e+00  7.65958198e-02]
 [-7.61091384e-02  1.17513634e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.58303215e-01  1.15465725e+00]
 [ 5.74655160e-02  3.73859747e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.55039448e-01  8.51341377e-01]
 [ 1.17562927e-01  6.46540086e-01]
 [ 7.75965093e-03 -2.23013416e-01]
 [ 9.31459891e-02  1.49046396e-02]
 [ 4.88765314e-02 -7.58133824e-02]
 [-1.32837519e-03  4.21766894e-01]
 [-1.65146380e-01  5.77039239e-01]
 [ 4.65421362e-03  9.81222092e-02]
 [ 1.28776163e-01 -1.71323095e-01]
 [ 3.49352593e-02 -1.61238063e-01]
 [ 4.45278497e-01  6.01417660e-02]
 [ 4.47477191e-01  4.60913194e-01]
 [-7.75000936e-01  3.75671505e-01]
 [ 1.86309119e-02  1.58733921e-01]
 [ 1.70269979e+00  2.16577281e-01]
 [ 1.50205561e-02  4.31404793e-01]
 [-1.49256480e-01  1.75389100e-01]
 [-1.86443196e-01  1.07685366e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 5.78473194e-02 -4.57890627e-01]
 [ 8.29471059e-02  2.56691750e-02]
 [ 5.21318178e-01 -3.03190691e-01]
 [-5.58301652e-01 -3.03152359e-01]
 [ 3.01957268e-01  1.14393103e-01]
 [-1.23999388e-01  1.65952592e-01]
 [ 4.11588475e-01  2.22542139e-01]
 [ 5.34196099e-02 -8.33308178e-02]
 [ 2.73483790e-01 -3.48818201e-01]
 [ 1.30567646e-01  2.48929065e-02]
 [-7.86798141e-02  5.38283371e-01]
 [-3.74775502e-01 -1.40579789e-01]
 [-5.64181889e-02  4.91458886e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.30931067]
curr_Stock_Price:  98.40462313455485
curr_Factors:  [9.84046231e+01 4.12391906e-02]
mat_Sqrt:  [[ 1.99834546e+01  0.00000000e+00]
 [-8.12297390e-03  1.86120714e-02]]
grads:  [ 0.07973216 19.32911607]
Stock Position:  0.07973215857302306
Bond Position:  [-16.15532368]


portfolio before change:  [-8.2976906]
curr_Stock_Price:  98.57569098579371
curr_Factors:  [9.85756910e+01 4.06206852e-02]
mat_Sqrt:  [[ 1.98675106e+01  0.00000000e+00]
 [-8.06182959e-03  1.84719722e-02]]
grads:  [0.05255131 4.14659675]
Stock Position:  0.0525513093467897
Bond Position:  [-13.47797223]


portfolio before change:  [-8.36730117]
curr_Stock_Price:  97.28313110224758
curr_Factors:  [9.72831311e+01 4.06522948e-02]
mat_Sqrt:  [[ 1.96146279e+01  0.00000000e+00]
 [-8.06496569e-03  1.84791579e-02]]
grads:  [-1.26548330e-03  6.35925264e+00]
Stock Position:  -0.0012654833025060944
Bond Position:  [-8.24419099]


portfolio before change:  [-8.36693274]
curr_Stock_Price:  96.17760898089055
curr_Factors:  [9.61776090e+01 4.07412138e-02]
mat_Sqrt:  [[ 1.94129242e+01  0.00000000e+00]
 [-8.07378115e-03  1.84993566e-02]]
grads:  [-8.39717233e-04 -8.18335553e+00]
Stock Position:  -0.00083971723275859
Bond Position:  [-8.28617074]


portfolio before change:  [-8.36783807]
curr_Stock_Price:  96.0221962471711
curr_Factors:  [9.60221962e+01 3.99814538e-02]
mat_Sqrt:  [[ 1.91999866e+01  0.00000000e+00]
 [-7.99814517e-03  1.83260528e-02]]
grads:  [1.80016022e-02 6.30063254e+01]
Stock Position:  0.018001602243670693
Bond Position:  [-10.09639145]


portfolio before change:  [-8.3777782]
curr_Stock_Price:  95.54012775227635
curr_Factors:  [9.55401278e+01 3.96487283e-02]
mat_Sqrt:  [[ 1.90239392e+01  0.00000000e+00]
 [-7.96479537e-03  1.82496388e-02]]
grads:  [0.00387838 2.0485871 ]
Stock Position:  0.003878381464758672
Bond Position:  [-8.74831926]


portfolio before change:  [-8.37266638]
curr_Stock_Price:  97.14013422004977
curr_Factors:  [9.71401342e+01 3.78282505e-02]
mat_Sqrt:  [[ 1.88932568e+01  0.00000000e+00]
 [-7.77979439e-03  1.78257484e-02]]
grads:  [0.00684762 5.39314733]
Stock Position:  0.006847616515196558
Bond Position:  [-9.03784476]


portfolio before change:  [-8.36942967]
curr_Stock_Price:  97.77780221094154
curr_Factors:  [9.77778022e+01 3.82449674e-02]
mat_Sqrt:  [[ 1.91217404e+01  0.00000000e+00]
 [-7.82252822e-03  1.79236639e-02]]
grads:  [ 0.06414663 47.49817807]
Stock Position:  0.0641466340576674
Bond Position:  [-14.64154657]


portfolio before change:  [-8.57961657]
curr_Stock_Price:  94.52967244133413
curr_Factors:  [9.45296724e+01 3.91766532e-02]
mat_Sqrt:  [[ 1.87103460e+01  0.00000000e+00]
 [-7.91723721e-03  1.81406694e-02]]
grads:  [2.13644447e-02 3.56403654e+01]
Stock Position:  0.021364444745767548
Bond Position:  [-10.59919053]


portfolio before change:  [-8.58698906]
curr_Stock_Price:  94.24660809974789
curr_Factors:  [9.42466081e+01 3.85181034e-02]
mat_Sqrt:  [[ 1.84968671e+01  0.00000000e+00]
 [-7.85041180e-03  1.79875532e-02]]
grads:  [-4.84251646e-03 -1.23982075e+01]
Stock Position:  -0.004842516456894918
Bond Position:  [-8.13059831]


portfolio before change:  [-8.5842262]
curr_Stock_Price:  93.4661775284024
curr_Factors:  [9.34661775e+01 3.89523615e-02]
mat_Sqrt:  [[ 1.84468144e+01  0.00000000e+00]
 [-7.89454105e-03  1.80886660e-02]]
grads:  [0.00540207 0.82397672]
Stock Position:  0.005402065911702745
Bond Position:  [-9.08913666]


portfolio before change:  [-8.58456649]
curr_Stock_Price:  93.61351570429896
curr_Factors:  [9.36135157e+01 3.78859960e-02]
mat_Sqrt:  [[ 1.82212392e+01  0.00000000e+00]
 [-7.78573013e-03  1.78393488e-02]]
grads:  [ 8.66508499e-04 -4.24978418e+00]
Stock Position:  0.0008665084994656357
Bond Position:  [-8.66568339]


portfolio before change:  [-8.58663084]
curr_Stock_Price:  92.48129824645359
curr_Factors:  [9.24812982e+01 3.70616445e-02]
mat_Sqrt:  [[ 1.78039457e+01  0.00000000e+00]
 [-7.70056045e-03  1.76442006e-02]]
grads:  [1.02643420e-02 2.39039957e+01]
Stock Position:  0.010264342048368635
Bond Position:  [-9.53589052]


portfolio before change:  [-8.59442977]
curr_Stock_Price:  91.83762650267862
curr_Factors:  [9.18376265e+01 3.74173285e-02]
mat_Sqrt:  [[ 1.77646657e+01  0.00000000e+00]
 [-7.73742370e-03  1.77286649e-02]]
grads:  [4.88014763e-03 3.25483753e+01]
Stock Position:  0.004880147632387445
Bond Position:  [-9.04261094]


portfolio before change:  [-8.59269423]
curr_Stock_Price:  92.42489172159931
curr_Factors:  [9.24248917e+01 3.69927951e-02]
mat_Sqrt:  [[ 1.77765519e+01  0.00000000e+00]
 [-7.69340446e-03  1.76278041e-02]]
grads:  [2.67083611e-03 5.56633194e+00]
Stock Position:  0.0026708361084915072
Bond Position:  [-8.83954596]


portfolio before change:  [-8.59827987]
curr_Stock_Price:  90.74727928805773
curr_Factors:  [9.07472793e+01 3.86389710e-02]
mat_Sqrt:  [[ 1.78380094e+01  0.00000000e+00]
 [-7.86271922e-03  1.80157530e-02]]
grads:  [ 3.02750339e-03 -9.50962724e+00]
Stock Position:  0.0030275033895956855
Bond Position:  [-8.87301756]


portfolio before change:  [-8.59903175]
curr_Stock_Price:  90.86530095221958
curr_Factors:  [9.08653010e+01 3.80402367e-02]
mat_Sqrt:  [[ 1.77222833e+01  0.00000000e+00]
 [-7.80156258e-03  1.78756255e-02]]
grads:  [-1.99944893e-03 -9.01999554e+00]
Stock Position:  -0.0019994489328420094
Bond Position:  [-8.41735122]


portfolio before change:  [-8.60039739]
curr_Stock_Price:  91.02204706910659
curr_Factors:  [9.10220471e+01 3.76026112e-02]
mat_Sqrt:  [[ 1.76504426e+01  0.00000000e+00]
 [-7.75655709e-03  1.77725050e-02]]
grads:  [0.02671471 3.383978  ]
Stock Position:  0.02671471335698871
Bond Position:  [-11.03202529]


portfolio before change:  [-8.57991759]
curr_Stock_Price:  91.84028118464784
curr_Factors:  [9.18402812e+01 3.66385971e-02]
mat_Sqrt:  [[ 1.75793423e+01  0.00000000e+00]
 [-7.65648453e-03  1.75432100e-02]]
grads:  [ 0.03689764 26.27302502]
Stock Position:  0.03689763752345804
Bond Position:  [-11.968607]


portfolio before change:  [-8.55804879]
curr_Stock_Price:  92.4735188871047
curr_Factors:  [9.24735189e+01 3.60810757e-02]
mat_Sqrt:  [[ 1.75653627e+01  0.00000000e+00]
 [-7.59800771e-03  1.74092227e-02]]
grads:  [-0.0347869  21.57887864]
Stock Position:  -0.03478689614792528
Bond Position:  [-5.34118209]


portfolio before change:  [-8.60660823]
curr_Stock_Price:  93.85023728756768
curr_Factors:  [9.38502373e+01 3.43921362e-02]
mat_Sqrt:  [[ 1.74046362e+01  0.00000000e+00]
 [-7.41804677e-03  1.69968804e-02]]
grads:  [5.05084239e-03 9.33900321e+00]
Stock Position:  0.005050842391890176
Bond Position:  [-9.08063099]


portfolio before change:  [-8.60873831]
curr_Stock_Price:  93.65325552087131
curr_Factors:  [9.36532555e+01 3.48578664e-02]
mat_Sqrt:  [[ 1.74853077e+01  0.00000000e+00]
 [-7.46810460e-03  1.71115773e-02]]
grads:  [ 0.10278469 12.65676901]
Stock Position:  0.10278468620720117
Bond Position:  [-18.23485879]


portfolio before change:  [-8.61828253]
curr_Stock_Price:  93.58257645692628
curr_Factors:  [9.35825765e+01 3.52464302e-02]
mat_Sqrt:  [[ 1.75692235e+01  0.00000000e+00]
 [-7.50961306e-03  1.72066852e-02]]
grads:  [1.15714302e-02 2.50719293e+01]
Stock Position:  0.011571430239626038
Bond Position:  [-9.70116679]


portfolio before change:  [-8.61510412]
curr_Stock_Price:  93.96205678916483
curr_Factors:  [9.39620568e+01 3.55025253e-02]
mat_Sqrt:  [[ 1.77044377e+01  0.00000000e+00]
 [-7.53684552e-03  1.72690826e-02]]
grads:  [-4.10690258e-03  1.01562489e+01]
Stock Position:  -0.0041069025760154
Bond Position:  [-8.22921111]


portfolio before change:  [-8.61602248]
curr_Stock_Price:  93.93518545823932
curr_Factors:  [9.39351855e+01 3.49382010e-02]
mat_Sqrt:  [[ 1.75581424e+01  0.00000000e+00]
 [-7.47670527e-03  1.71312839e-02]]
grads:  [-0.00794192  6.28588999]
Stock Position:  -0.007941924937573225
Bond Position:  [-7.86999629]


portfolio before change:  [-8.61872536]
curr_Stock_Price:  94.15163980568823
curr_Factors:  [9.41516398e+01 3.41801281e-02]
mat_Sqrt:  [[ 1.74066313e+01  0.00000000e+00]
 [-7.39514739e-03  1.69444114e-02]]
grads:  [ 0.01054073 -4.30794175]
Stock Position:  0.010540730087946029
Bond Position:  [-9.61115238]


portfolio before change:  [-8.61801917]
curr_Stock_Price:  94.33261929118947
curr_Factors:  [9.43326193e+01 3.38331584e-02]
mat_Sqrt:  [[ 1.73513458e+01  0.00000000e+00]
 [-7.35751680e-03  1.68581888e-02]]
grads:  [-8.18337295e-03 -2.71613180e+01]
Stock Position:  -0.008183372953128593
Bond Position:  [-7.84606017]


portfolio before change:  [-8.62201505]
curr_Stock_Price:  94.70105647027778
curr_Factors:  [9.47010565e+01 3.48603670e-02]
mat_Sqrt:  [[ 1.76815691e+01  0.00000000e+00]
 [-7.46837246e-03  1.71121911e-02]]
grads:  [0.00532476 1.50005192]
Stock Position:  0.005324756644277615
Bond Position:  [-9.12627513]


portfolio before change:  [-8.62558993]
curr_Stock_Price:  94.24394224112977
curr_Factors:  [9.42439422e+01 3.43725027e-02]
mat_Sqrt:  [[ 1.74726598e+01  0.00000000e+00]
 [-7.41592909e-03  1.69920282e-02]]
grads:  [  0.02226306 -17.84311368]
Stock Position:  0.0222630621895227
Bond Position:  [-10.72374867]


portfolio before change:  [-8.64746427]
curr_Stock_Price:  93.3216165228691
curr_Factors:  [9.33216165e+01 3.55007860e-02]
mat_Sqrt:  [[ 1.75833345e+01  0.00000000e+00]
 [-7.53666091e-03  1.72686595e-02]]
grads:  [ -0.03927629 -17.55506028]
Stock Position:  -0.03927629252917602
Bond Position:  [-4.98213716]


portfolio before change:  [-8.65119992]
curr_Stock_Price:  93.40087136448544
curr_Factors:  [9.34008714e+01 3.57285342e-02]
mat_Sqrt:  [[ 1.76546262e+01  0.00000000e+00]
 [-7.56079722e-03  1.73239628e-02]]
grads:  [0.01993146 6.60317181]
Stock Position:  0.01993146198581183
Bond Position:  [-10.51281583]


portfolio before change:  [-8.64072145]
curr_Stock_Price:  93.99253128963062
curr_Factors:  [9.39925313e+01 3.57783898e-02]
mat_Sqrt:  [[ 1.77788531e+01  0.00000000e+00]
 [-7.56607056e-03  1.73360455e-02]]
grads:  [-2.90073488e-03  9.57269013e+00]
Stock Position:  -0.0029007348792109205
Bond Position:  [-8.36807404]


portfolio before change:  [-8.64219871]
curr_Stock_Price:  94.14117562288037
curr_Factors:  [9.41411756e+01 3.54944335e-02]
mat_Sqrt:  [[ 1.77361659e+01  0.00000000e+00]
 [-7.53598658e-03  1.72671145e-02]]
grads:  [ 0.02868229 12.88820661]
Stock Position:  0.028682288493535858
Bond Position:  [-11.34238306]


portfolio before change:  [-8.69550795]
curr_Stock_Price:  92.3319978543333
curr_Factors:  [9.23319979e+01 3.64309937e-02]
mat_Sqrt:  [[ 1.76233206e+01  0.00000000e+00]
 [-7.63476195e-03  1.74934373e-02]]
grads:  [ 9.67528186e-04 -4.76354741e+00]
Stock Position:  0.0009675281859066701
Bond Position:  [-8.78484176]


portfolio before change:  [-8.69748104]
curr_Stock_Price:  91.42771612606644
curr_Factors:  [9.14277161e+01 3.70281934e-02]
mat_Sqrt:  [[ 1.75931714e+01  0.00000000e+00]
 [-7.69708448e-03  1.76362361e-02]]
grads:  [ 6.89171063e-03 -1.97784946e+01]
Stock Position:  0.006891710631431018
Bond Position:  [-9.32757441]


portfolio before change:  [-8.70288405]
curr_Stock_Price:  90.81292157008878
curr_Factors:  [9.08129216e+01 3.71641553e-02]
mat_Sqrt:  [[ 1.75069214e+01  0.00000000e+00]
 [-7.71120280e-03  1.76685853e-02]]
grads:  [0.00807862 1.40887944]
Stock Position:  0.00807862204159763
Bond Position:  [-9.43652732]


portfolio before change:  [-8.70633331]
curr_Stock_Price:  90.5319795819971
curr_Factors:  [9.05319796e+01 3.57654884e-02]
mat_Sqrt:  [[ 1.71211959e+01  0.00000000e+00]
 [-7.56470631e-03  1.73329196e-02]]
grads:  [9.12589924e-03 3.10555511e+01]
Stock Position:  0.009125899244978702
Bond Position:  [-9.53251904]


portfolio before change:  [-8.69646506]
curr_Stock_Price:  91.74390294407644
curr_Factors:  [9.17439029e+01 3.65195128e-02]
mat_Sqrt:  [[ 1.75323325e+01  0.00000000e+00]
 [-7.64403169e-03  1.75146769e-02]]
grads:  [-0.02487573 -8.02639918]
Stock Position:  -0.024875728945301115
Bond Position:  [-6.4142686]


portfolio before change:  [-8.69404594]
curr_Stock_Price:  91.61442093603375
curr_Factors:  [9.16144209e+01 3.75944661e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.69404594]
Stock Price:  93.82617354714635
PL:  [-8.69404594]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.12418255e+00  2.83056367e-01]
 [-2.49233634e-01 -7.47935703e-02]
 [-6.23035893e-01 -2.06483945e-01]
 [-4.14347920e-01 -4.70002302e-02]
 [-1.30586353e-01 -1.12659382e+00]
 [ 2.23574882e-01 -3.07946310e-01]
 [ 6.23325188e-01 -7.71654075e-01]
 [-1.01795904e+00  9.40755937e-02]
 [-8.11051021e-02 -2.57235208e-01]
 [-8.81271621e-01 -1.04078525e+00]
 [ 4.87456430e-02 -2.97586539e-02]
 [-5.73385689e-01 -3.96325636e-01]
 [ 1.89186302e-01  5.03003490e-01]
 [ 2.11182222e-02 -1.80341675e-01]
 [-3.93097568e-01 -1.75974508e-01]
 [ 6.52687046e-02 -1.47624776e+00]
 [-8.48003637e-04 -6.78671251e-01]
 [ 1.21273248e-01 -2.36023814e-01]
 [-9.97749301e-02 -6.58648863e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 7.07707139e-02 -5.59825500e-03]
 [ 2.73421429e-01 -5.31812420e-01]
 [ 2.71499641e-02 -3.34876302e-01]
 [ 3.38787386e-02  4.82548793e-02]
 [ 4.57861776e-01 -4.56260123e-01]
 [-2.27794264e-01  1.20165898e-02]
 [-1.59428137e-01  8.64145298e-02]
 [ 7.14360629e-03  2.84613057e-01]
 [-4.09294604e-02  1.93317099e-01]
 [-6.15338357e-01 -7.05660541e-02]
 [-1.21061777e-01  5.10301725e-05]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.43750502e-01  5.09859959e-03]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.68634545e-01 -4.14006982e-02]
 [-2.95017670e-02 -1.58135909e-01]
 [-1.72681166e-04 -6.40977342e-02]
 [ 1.80606290e-01 -1.52371265e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.73480457]
curr_Stock_Price:  100.8786610889735
curr_Factors:  [1.00878661e+02 3.88225433e-02]
mat_Sqrt:  [[ 1.98765635e+01  0.00000000e+00]
 [-7.88137483e-03  1.80584984e-02]]
grads:  [ 0.06277335 15.67441328]
Stock Position:  0.06277335004854777
Bond Position:  [2.40231307]


portfolio before change:  [8.85347792]
curr_Stock_Price:  102.76438225858328
curr_Factors:  [1.02764382e+02 3.83397933e-02]
mat_Sqrt:  [[ 2.01218311e+01  0.00000000e+00]
 [-7.83221994e-03  1.79458704e-02]]
grads:  [-0.01400848 -4.16773156]
Stock Position:  -0.014008477794315738
Bond Position:  [10.29305048]


portfolio before change:  [8.84867078]
curr_Stock_Price:  103.19939386364129
curr_Factors:  [1.03199394e+02 3.71827151e-02]
mat_Sqrt:  [[ 1.98997535e+01  0.00000000e+00]
 [-7.71312804e-03  1.76729966e-02]]
grads:  [ -0.03583727 -11.68358431]
Stock Position:  -0.03583727183630256
Bond Position:  [12.54705551]


portfolio before change:  [8.76905528]
curr_Stock_Price:  105.4647441739856
curr_Factors:  [1.05464744e+02 3.78141280e-02]
mat_Sqrt:  [[ 2.05085213e+01  0.00000000e+00]
 [-7.77834204e-03  1.78224206e-02]]
grads:  [-0.02120389 -2.63714067]
Stock Position:  -0.02120389352195764
Bond Position:  [11.00531849]


portfolio before change:  [8.76608338]
curr_Stock_Price:  105.66978462021744
curr_Factors:  [1.05669785e+02 3.75021880e-02]
mat_Sqrt:  [[ 2.04634628e+01  0.00000000e+00]
 [-7.74619266e-03  1.77487571e-02]]
grads:  [-3.04089398e-02 -6.34745190e+01]
Stock Position:  -0.03040893976518726
Bond Position:  [11.97938949]


portfolio before change:  [8.71113434]
curr_Stock_Price:  107.52603348278906
curr_Factors:  [1.07526033e+02 3.68378831e-02]
mat_Sqrt:  [[ 2.06376840e+01  0.00000000e+00]
 [-7.67727901e-03  1.75908561e-02]]
grads:  [ 4.32103202e-03 -1.75060445e+01]
Stock Position:  0.004321032019917922
Bond Position:  [8.2465109]


portfolio before change:  [8.71286264]
curr_Stock_Price:  107.68743600949324
curr_Factors:  [1.07687436e+02 3.82365718e-02]
mat_Sqrt:  [[ 2.10573885e+01  0.00000000e+00]
 [-7.82166957e-03  1.79216964e-02]]
grads:  [ 1.36079429e-02 -4.30569772e+01]
Stock Position:  0.013607942857282498
Bond Position:  [7.24745816]


portfolio before change:  [8.70604225]
curr_Stock_Price:  107.11965142842212
curr_Factors:  [1.07119651e+02 3.84516976e-02]
mat_Sqrt:  [[ 2.10052043e+01  0.00000000e+00]
 [-7.84364177e-03  1.79720411e-02]]
grads:  [-0.04650757  5.23455257]
Stock Position:  -0.046507573623027876
Bond Position:  [13.68791732]


portfolio before change:  [8.64904088]
curr_Stock_Price:  108.38207958690877
curr_Factors:  [1.08382080e+02 3.84629198e-02]
mat_Sqrt:  [[ 2.12558563e+01  0.00000000e+00]
 [-7.84478627e-03  1.79746635e-02]]
grads:  [-9.09733999e-03 -1.43109889e+01]
Stock Position:  -0.009097339985280754
Bond Position:  [9.6350295]


portfolio before change:  [8.64692464]
curr_Stock_Price:  108.74709686854857
curr_Factors:  [1.08747097e+02 3.85486093e-02]
mat_Sqrt:  [[ 2.13511872e+01  0.00000000e+00]
 [-7.85351990e-03  1.79946747e-02]]
grads:  [ -0.06254957 -57.83851434]
Stock Position:  -0.06254956831432677
Bond Position:  [15.44900861]


portfolio before change:  [8.62950226]
curr_Stock_Price:  109.05650960403092
curr_Factors:  [1.09056510e+02 3.92697989e-02]
mat_Sqrt:  [[ 2.16113020e+01  0.00000000e+00]
 [-7.92664356e-03  1.81622221e-02]]
grads:  [ 0.00165459 -1.63849191]
Stock Position:  0.0016545926615073904
Bond Position:  [8.44905816]


portfolio before change:  [8.63287104]
curr_Stock_Price:  110.45418843664791
curr_Factors:  [1.10454188e+02 3.79407207e-02]
mat_Sqrt:  [[ 2.15146843e+01  0.00000000e+00]
 [-7.79135117e-03  1.78522283e-02]]
grads:  [ -0.03469056 -22.20034553]
Stock Position:  -0.03469055684915617
Bond Position:  [12.46458835]


portfolio before change:  [8.54872013]
curr_Stock_Price:  112.92486334766056
curr_Factors:  [1.12924863e+02 3.75503145e-02]
mat_Sqrt:  [[ 2.18824711e+01  0.00000000e+00]
 [-7.75116141e-03  1.77601419e-02]]
grads:  [1.86777362e-02 2.83220422e+01]
Stock Position:  0.018677736241357098
Bond Position:  [6.43953931]


portfolio before change:  [8.51324183]
curr_Stock_Price:  110.98226777434404
curr_Factors:  [1.10982268e+02 4.01051689e-02]
mat_Sqrt:  [[ 2.22256141e+01  0.00000000e+00]
 [-8.01050998e-03  1.83543842e-02]]
grads:  [-2.59112469e-03 -9.82553669e+00]
Stock Position:  -0.0025911246946656963
Bond Position:  [8.80081073]


portfolio before change:  [8.51862839]
curr_Stock_Price:  109.32801068040904
curr_Factors:  [1.09328011e+02 4.04432938e-02]
mat_Sqrt:  [[ 2.19864294e+01  0.00000000e+00]
 [-8.04420724e-03  1.84315943e-02]]
grads:  [-0.02137224 -9.54743823]
Stock Position:  -0.02137223520127406
Bond Position:  [10.85521235]


portfolio before change:  [8.49647619]
curr_Stock_Price:  110.42799772775916
curr_Factors:  [1.10427998e+02 4.12982092e-02]
mat_Sqrt:  [[ 2.24411344e+01  0.00000000e+00]
 [-8.12878433e-03  1.86253848e-02]]
grads:  [-2.58016653e-02 -7.92599874e+01]
Stock Position:  -0.025801665261697273
Bond Position:  [11.34570243]


portfolio before change:  [8.47546127]
curr_Stock_Price:  111.29744659405264
curr_Factors:  [1.11297447e+02 4.21683473e-02]
mat_Sqrt:  [[ 2.28548561e+01  0.00000000e+00]
 [-8.21397319e-03  1.88205770e-02]]
grads:  [-1.29969937e-02 -3.60600662e+01]
Stock Position:  -0.01299699372502199
Bond Position:  [9.92199348]


portfolio before change:  [8.48571278]
curr_Stock_Price:  110.60411756467197
curr_Factors:  [1.10604118e+02 4.31388171e-02]
mat_Sqrt:  [[ 2.29723493e+01  0.00000000e+00]
 [-8.30795446e-03  1.90359151e-02]]
grads:  [ 7.95043232e-04 -1.23988688e+01]
Stock Position:  0.0007950432321082285
Bond Position:  [8.39777773]


portfolio before change:  [8.48647608]
curr_Stock_Price:  110.24377021346527
curr_Factors:  [1.10243770e+02 4.37792725e-02]
mat_Sqrt:  [[ 2.30668519e+01  0.00000000e+00]
 [-8.36939879e-03  1.91767017e-02]]
grads:  [-0.00557166 -3.43463059]
Stock Position:  -0.005571662905120595
Bond Position:  [9.10071721]


portfolio before change:  [8.49660419]
curr_Stock_Price:  108.63016726712549
curr_Factors:  [1.08630167e+02 4.45475966e-02]
mat_Sqrt:  [[ 2.29278107e+01  0.00000000e+00]
 [-8.44252063e-03  1.93442449e-02]]
grads:  [-2.11363705e-04 -5.63957858e+00]
Stock Position:  -0.00021136370460679584
Bond Position:  [8.51956467]


portfolio before change:  [8.49775395]
curr_Stock_Price:  108.22924532576906
curr_Factors:  [1.08229245e+02 4.39644399e-02]
mat_Sqrt:  [[ 2.26931823e+01  0.00000000e+00]
 [-8.38707958e-03  1.92172135e-02]]
grads:  [ 0.00301092 -0.29131461]
Stock Position:  0.003010923461529394
Bond Position:  [8.17188397]


portfolio before change:  [8.49631556]
curr_Stock_Price:  107.4122415483617
curr_Factors:  [1.07412242e+02 4.47235251e-02]
mat_Sqrt:  [[ 2.27154735e+01  0.00000000e+00]
 [-8.45917491e-03  1.93824047e-02]]
grads:  [ 1.81900063e-03 -2.74378968e+01]
Stock Position:  0.001819000625603943
Bond Position:  [8.30093262]


portfolio before change:  [8.49396733]
curr_Stock_Price:  105.5508281456711
curr_Factors:  [1.05550828e+02 4.50786921e-02]
mat_Sqrt:  [[ 2.24102808e+01  0.00000000e+00]
 [-8.49269730e-03  1.94592141e-02]]
grads:  [-5.31015373e-03 -1.72091381e+01]
Stock Position:  -0.005310153727195415
Bond Position:  [9.05445845]


portfolio before change:  [8.50025763]
curr_Stock_Price:  104.57940266223592
curr_Factors:  [1.04579403e+02 4.39393014e-02]
mat_Sqrt:  [[ 2.19216243e+01  0.00000000e+00]
 [-8.38468140e-03  1.92117186e-02]]
grads:  [2.50615072e-03 2.51174194e+00]
Stock Position:  0.002506150716460046
Bond Position:  [8.23816588]


portfolio before change:  [8.50484043]
curr_Stock_Price:  105.99710079482982
curr_Factors:  [1.05997101e+02 4.37563000e-02]
mat_Sqrt:  [[ 2.21724805e+01  0.00000000e+00]
 [-8.36720264e-03  1.91716697e-02]]
grads:  [ 1.16691289e-02 -2.37986639e+01]
Stock Position:  0.011669128882498861
Bond Position:  [7.2679466]


portfolio before change:  [8.48409049]
curr_Stock_Price:  104.14105114400503
curr_Factors:  [1.04141051e+02 4.33378394e-02]
mat_Sqrt:  [[ 2.16798156e+01  0.00000000e+00]
 [-8.32709692e-03  1.90797760e-02]]
grads:  [-0.0102653  0.6298077]
Stock Position:  -0.010265299182362233
Bond Position:  [9.55312954]


portfolio before change:  [8.49512778]
curr_Stock_Price:  103.18218266826922
curr_Factors:  [1.03182183e+02 4.34811666e-02]
mat_Sqrt:  [[ 2.15156913e+01  0.00000000e+00]
 [-8.34085527e-03  1.91113003e-02]]
grads:  [-0.00565698  4.52164575]
Stock Position:  -0.005656975770841612
Bond Position:  [9.07882689]


portfolio before change:  [8.50234819]
curr_Stock_Price:  102.10643309068487
curr_Factors:  [1.02106433e+02 4.40303414e-02]
mat_Sqrt:  [[ 2.14254095e+01  0.00000000e+00]
 [-8.39336322e-03  1.92316112e-02]]
grads:  [6.13098798e-03 1.47992311e+01]
Stock Position:  0.006130987980650288
Bond Position:  [7.87633488]


portfolio before change:  [8.50648061]
curr_Stock_Price:  102.61986029341814
curr_Factors:  [1.02619860e+02 4.42097415e-02]
mat_Sqrt:  [[ 2.15769675e+01  0.00000000e+00]
 [-8.41044507e-03  1.92707506e-02]]
grads:  [2.01330602e-03 1.00316331e+01]
Stock Position:  0.0020133060153733257
Bond Position:  [8.29987543]


portfolio before change:  [8.50676014]
curr_Stock_Price:  102.2433533054234
curr_Factors:  [1.02243353e+02 4.29487441e-02]
mat_Sqrt:  [[ 2.11889931e+01  0.00000000e+00]
 [-8.28963151e-03  1.89939319e-02]]
grads:  [-0.03049394 -3.71518937]
Stock Position:  -0.030493941150448612
Bond Position:  [11.62456294]


portfolio before change:  [8.4055076]
curr_Stock_Price:  105.61142225924455
curr_Factors:  [1.05611422e+02 4.15309593e-02]
mat_Sqrt:  [[ 2.15227060e+01  0.00000000e+00]
 [-8.15165842e-03  1.86777959e-02]]
grads:  [-0.00562381  0.00273213]
Stock Position:  -0.005623805193277634
Bond Position:  [8.99944567]


portfolio before change:  [8.40527869]
curr_Stock_Price:  105.852169414702
curr_Factors:  [1.05852169e+02 4.06430907e-02]
mat_Sqrt:  [[ 2.13399367e+01  0.00000000e+00]
 [-8.06405264e-03  1.84770658e-02]]
grads:  [ 0.00339938 -0.64659558]
Stock Position:  0.003399382007526265
Bond Position:  [8.04544673]


portfolio before change:  [8.40284134]
curr_Stock_Price:  104.83930988044489
curr_Factors:  [1.04839310e+02 3.93788259e-02]
mat_Sqrt:  [[ 2.08044163e+01  0.00000000e+00]
 [-7.93763954e-03  1.81874170e-02]]
grads:  [-0.01160933  0.28033665]
Stock Position:  -0.011609327926355602
Bond Position:  [9.61995527]


portfolio before change:  [8.39782126]
curr_Stock_Price:  105.3753140065953
curr_Factors:  [1.05375314e+02 3.83363616e-02]
mat_Sqrt:  [[ 2.06321425e+01  0.00000000e+00]
 [-7.83186942e-03  1.79450672e-02]]
grads:  [0.00491811 2.9729095 ]
Stock Position:  0.004918111232610226
Bond Position:  [7.87957374]


portfolio before change:  [8.40072469]
curr_Stock_Price:  105.7653865584818
curr_Factors:  [1.05765387e+02 3.97454046e-02]
mat_Sqrt:  [[ 2.10856514e+01  0.00000000e+00]
 [-7.97449982e-03  1.82718745e-02]]
grads:  [-0.00448967  4.4508376 ]
Stock Position:  -0.004489669725845722
Bond Position:  [8.87557634]


portfolio before change:  [8.40042703]
curr_Stock_Price:  106.07881066849528
curr_Factors:  [1.06078811e+02 3.82407149e-02]
mat_Sqrt:  [[ 2.07439589e+01  0.00000000e+00]
 [-7.82209331e-03  1.79226674e-02]]
grads:  [-0.01864173 -2.30996299]
Stock Position:  -0.018641730471219572
Bond Position:  [10.37791963]


portfolio before change:  [8.4056688]
curr_Stock_Price:  105.86721828364884
curr_Factors:  [1.05867218e+02 3.88432526e-02]
mat_Sqrt:  [[ 2.08650436e+01  0.00000000e+00]
 [-7.88347666e-03  1.80633143e-02]]
grads:  [-4.72167409e-03 -8.75453454e+00]
Stock Position:  -0.004721674086252115
Bond Position:  [8.9055393]


portfolio before change:  [8.40025626]
curr_Stock_Price:  107.24931369343174
curr_Factors:  [1.07249314e+02 3.93765530e-02]
mat_Sqrt:  [[ 2.12820456e+01  0.00000000e+00]
 [-7.93741046e-03  1.81868921e-02]]
grads:  [-1.32258084e-03 -3.52439184e+00]
Stock Position:  -0.0013225808434978923
Bond Position:  [8.54210215]


portfolio before change:  [8.40288456]
curr_Stock_Price:  106.06944976294076
curr_Factors:  [1.06069450e+02 3.96066061e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.40288456]
Stock Price:  104.40813206492288
PL:  [3.99475249]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.09877855e+00  2.77313031e-01]
 [-2.67033938e-01 -9.99960257e-02]
 [-5.23111132e-01 -1.84384716e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.22889754e-01 -6.02833889e-01]
 [-4.19617413e-01  2.65922131e-01]
 [ 1.32670895e-01 -8.09287811e-02]
 [ 3.18376975e-01  4.75289745e-01]
 [-7.60302320e-02  8.11737317e-02]
 [-1.40165712e-01 -4.04445622e-01]
 [-6.29445269e-02 -1.47059769e-02]
 [-9.76958568e-03 -1.36310137e-01]
 [-5.78507618e-02 -1.80468313e-02]
 [-1.50877343e-02 -9.80035096e-02]
 [ 2.46600260e-01  1.39175682e-01]
 [ 1.34232781e-01 -4.91377267e-01]
 [ 2.14781605e-02 -2.40741987e-01]
 [ 3.48282341e-02 -1.56577220e-01]
 [-1.14856478e-01 -2.65330600e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 9.97413061e-02 -1.50822882e-02]
 [ 3.07556604e-01 -4.09868330e-01]
 [ 2.70761565e-02 -3.30164103e-01]
 [ 3.15047062e-02  5.97775571e-02]
 [ 4.25436663e-01 -3.56405117e-01]
 [-1.75671366e-01  1.18888556e-04]
 [-1.54433294e-01  1.01512032e-01]
 [-3.77764707e-02  1.15053399e-01]
 [-5.19624679e-02  1.98954590e-01]
 [-7.51556686e-01 -1.33135268e-02]
 [-1.51052832e-01 -2.53420285e-02]
 [ 6.91773313e-02 -1.62116740e-02]
 [-2.71706001e-01  8.71411074e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.47622033e-01 -2.04550969e-02]
 [-2.81530236e-02 -1.70624565e-01]
 [-7.39051228e-03 -6.03096259e-02]
 [-3.88756457e-02 -3.74265866e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.54464892]
curr_Stock_Price:  100.99621401608975
curr_Factors:  [1.00996214e+02 4.08336689e-02]
mat_Sqrt:  [[ 2.04086508e+01  0.00000000e+00]
 [-8.08293698e-03  1.85203353e-02]]
grads:  [ 0.05976916 14.97343468]
Stock Position:  0.059769158094363756
Bond Position:  [3.50819023]


portfolio before change:  [9.60924589]
curr_Stock_Price:  102.06965105014697
curr_Factors:  [1.02069651e+02 4.10513518e-02]
mat_Sqrt:  [[ 2.06804679e+01  0.00000000e+00]
 [-8.10445327e-03  1.85696353e-02]]
grads:  [-0.01502267 -5.38492136]
Stock Position:  -0.015022666918147576
Bond Position:  [11.14260426]


portfolio before change:  [9.59906953]
curr_Stock_Price:  102.83977219849004
curr_Factors:  [1.02839772e+02 3.97996445e-02]
mat_Sqrt:  [[ 2.05163785e+01  0.00000000e+00]
 [-7.97993929e-03  1.82843379e-02]]
grads:  [ -0.02941958 -10.08429817]
Stock Position:  -0.029419579088551816
Bond Position:  [12.62457235]


portfolio before change:  [9.61386788]
curr_Stock_Price:  102.39040575872279
curr_Factors:  [1.02390406e+02 4.08203508e-02]
mat_Sqrt:  [[ 2.06870055e+01  0.00000000e+00]
 [-8.08161873e-03  1.85173148e-02]]
grads:  [-7.88000319e-04 -8.17541929e+00]
Stock Position:  -0.0007880003194708378
Bond Position:  [9.69455155]


portfolio before change:  [9.61450385]
curr_Stock_Price:  103.12127136389428
curr_Factors:  [1.03121271e+02 3.98615984e-02]
mat_Sqrt:  [[ 2.05885430e+01  0.00000000e+00]
 [-7.98614785e-03  1.82985635e-02]]
grads:  [-1.87477100e-02 -3.29443286e+01]
Stock Position:  -0.018747709985097234
Bond Position:  [11.54779154]


portfolio before change:  [9.61255486]
curr_Stock_Price:  103.30222962176984
curr_Factors:  [1.03302230e+02 3.89807447e-02]
mat_Sqrt:  [[ 2.03955190e+01  0.00000000e+00]
 [-7.89741676e-03  1.80952551e-02]]
grads:  [-0.01488364 14.69568293]
Stock Position:  -0.014883635976060603
Bond Position:  [11.15006764]


portfolio before change:  [9.64743931]
curr_Stock_Price:  101.05206645792175
curr_Factors:  [1.01052066e+02 3.94319081e-02]
mat_Sqrt:  [[ 2.00663829e+01  0.00000000e+00]
 [-7.94298766e-03  1.81996711e-02]]
grads:  [ 0.00485143 -4.44671668]
Stock Position:  0.00485143137180366
Bond Position:  [9.15719215]


portfolio before change:  [9.64494348]
curr_Stock_Price:  100.30165853048608
curr_Factors:  [1.00301659e+02 4.06742365e-02]
mat_Sqrt:  [[ 2.02286928e+01  0.00000000e+00]
 [-8.06714189e-03  1.84841442e-02]]
grads:  [ 0.0259933  25.71337574]
Stock Position:  0.025993297303841784
Bond Position:  [7.03777265]


portfolio before change:  [9.63621133]
curr_Stock_Price:  99.9318737972382
curr_Factors:  [9.99318738e+01 4.03463767e-02]
mat_Sqrt:  [[ 2.00727234e+01  0.00000000e+00]
 [-8.03456301e-03  1.84094966e-02]]
grads:  [-2.02280031e-03  4.40934011e+00]
Stock Position:  -0.0020228003070899446
Bond Position:  [9.83835356]


portfolio before change:  [9.63266927]
curr_Stock_Price:  102.29094624707521
curr_Factors:  [1.02290946e+02 3.97352397e-02]
mat_Sqrt:  [[ 2.03903704e+01  0.00000000e+00]
 [-7.97348001e-03  1.82695379e-02]]
grads:  [-1.5530873e-02 -2.2137704e+01]
Stock Position:  -0.015530872991248817
Bond Position:  [11.22133697]


portfolio before change:  [9.64428353]
curr_Stock_Price:  101.6334493052754
curr_Factors:  [1.01633449e+02 3.90710191e-02]
mat_Sqrt:  [[ 2.00892644e+01  0.00000000e+00]
 [-7.90655618e-03  1.81161961e-02]]
grads:  [-0.00345273 -0.81175854]
Stock Position:  -0.003452726790280392
Bond Position:  [9.99519606]


portfolio before change:  [9.64605499]
curr_Stock_Price:  101.48226805949461
curr_Factors:  [1.01482268e+02 3.97518283e-02]
mat_Sqrt:  [[ 2.02333931e+01  0.00000000e+00]
 [-7.97514422e-03  1.82733510e-02]]
grads:  [-3.42306435e-03 -7.45950409e+00]
Stock Position:  -0.00342306435382281
Bond Position:  [9.99343533]


portfolio before change:  [9.64715949]
curr_Stock_Price:  101.52455688443801
curr_Factors:  [1.01524557e+02 3.93772756e-02]
mat_Sqrt:  [[ 2.01462368e+01  0.00000000e+00]
 [-7.93748329e-03  1.81870590e-02]]
grads:  [-0.0032625 -0.9922897]
Stock Position:  -0.00326249737059312
Bond Position:  [9.97838309]


portfolio before change:  [9.64601503]
curr_Stock_Price:  102.25768737535478
curr_Factors:  [1.02257687e+02 3.92405824e-02]
mat_Sqrt:  [[ 2.02564664e+01  0.00000000e+00]
 [-7.92369433e-03  1.81554645e-02]]
grads:  [-2.85637047e-03 -5.39801719e+00]
Stock Position:  -0.0028563704689439045
Bond Position:  [9.93810087]


portfolio before change:  [9.64690054]
curr_Stock_Price:  102.38261384387526
curr_Factors:  [1.02382614e+02 4.02146055e-02]
mat_Sqrt:  [[ 2.05313790e+01  0.00000000e+00]
 [-8.02143184e-03  1.83794093e-02]]
grads:  [0.01496936 7.57236971]
Stock Position:  0.014969355331177187
Bond Position:  [8.11429881]


portfolio before change:  [9.64007579]
curr_Stock_Price:  101.8589373812295
curr_Factors:  [1.01858937e+02 3.92806897e-02]
mat_Sqrt:  [[ 2.01877861e+01  0.00000000e+00]
 [-7.92774265e-03  1.81647404e-02]]
grads:  [-3.97378098e-03 -2.70511582e+01]
Stock Position:  -0.003973780977663136
Bond Position:  [10.0448409]


portfolio before change:  [9.63154841]
curr_Stock_Price:  104.32083989198622
curr_Factors:  [1.04320840e+02 3.73028886e-02]
mat_Sqrt:  [[ 2.01484808e+01  0.00000000e+00]
 [-7.72558229e-03  1.77015328e-02]]
grads:  [-4.14871260e-03 -1.36000644e+01]
Stock Position:  -0.004148712603737127
Bond Position:  [10.0643456]


portfolio before change:  [9.63552461]
curr_Stock_Price:  103.66567886590988
curr_Factors:  [1.03665679e+02 3.72026530e-02]
mat_Sqrt:  [[ 1.99950250e+01  0.00000000e+00]
 [-7.71519570e-03  1.76777342e-02]]
grads:  [-1.67580022e-03 -8.85731277e+00]
Stock Position:  -0.001675800217392438
Bond Position:  [9.80924758]


portfolio before change:  [9.63409657]
curr_Stock_Price:  105.24956179391187
curr_Factors:  [1.05249562e+02 3.78988889e-02]
mat_Sqrt:  [[ 2.04896026e+01  0.00000000e+00]
 [-7.78705478e-03  1.78423840e-02]]
grads:  [-1.12572338e-02 -1.48708043e+01]
Stock Position:  -0.011257233763862418
Bond Position:  [10.81891549]


portfolio before change:  [9.63636196]
curr_Stock_Price:  105.16846386744758
curr_Factors:  [1.05168464e+02 3.89295983e-02]
mat_Sqrt:  [[ 2.07503531e+01  0.00000000e+00]
 [-7.89223399e-03  1.80833798e-02]]
grads:  [-2.33543351e-04 -6.03279864e+00]
Stock Position:  -0.00023354335116157612
Bond Position:  [9.66092335]


portfolio before change:  [9.63730857]
curr_Stock_Price:  106.28635641068199
curr_Factors:  [1.06286356e+02 3.70891685e-02]
mat_Sqrt:  [[ 2.04692094e+01  0.00000000e+00]
 [-7.70341935e-03  1.76507511e-02]]
grads:  [ 0.00455117 -0.85448422]
Stock Position:  0.004551170207034146
Bond Position:  [9.15358127]


portfolio before change:  [9.63647432]
curr_Stock_Price:  105.85162907557067
curr_Factors:  [1.05851629e+02 3.77187279e-02]
mat_Sqrt:  [[ 2.05577729e+01  0.00000000e+00]
 [-7.76852397e-03  1.77999246e-02]]
grads:  [ 6.25920912e-03 -2.30264083e+01]
Stock Position:  0.0062592091153100765
Bond Position:  [8.97392684]


portfolio before change:  [9.63070772]
curr_Stock_Price:  104.75110467901588
curr_Factors:  [1.04751105e+02 3.80814145e-02]
mat_Sqrt:  [[ 2.04416123e+01  0.00000000e+00]
 [-7.80578396e-03  1.78852979e-02]]
grads:  [-5.72456173e-03 -1.84600841e+01]
Stock Position:  -0.005724561731706198
Bond Position:  [10.23036189]


portfolio before change:  [9.63133329]
curr_Stock_Price:  104.86522879872548
curr_Factors:  [1.04865229e+02 3.78370612e-02]
mat_Sqrt:  [[ 2.03981230e+01  0.00000000e+00]
 [-7.78070034e-03  1.78278241e-02]]
grads:  [2.82348385e-03 3.35304839e+00]
Stock Position:  0.002823483849976166
Bond Position:  [9.33524801]


portfolio before change:  [9.62929577]
curr_Stock_Price:  103.73028442525519
curr_Factors:  [1.03730284e+02 3.98261593e-02]
mat_Sqrt:  [[ 2.07009264e+01  0.00000000e+00]
 [-7.98259700e-03  1.82904275e-02]]
grads:  [ 1.30375188e-02 -1.94858823e+01]
Stock Position:  0.013037518802908044
Bond Position:  [8.27691023]


portfolio before change:  [9.62996522]
curr_Stock_Price:  103.7022712332757
curr_Factors:  [1.03702271e+02 4.14429884e-02]
mat_Sqrt:  [[ 2.11112428e+01  0.00000000e+00]
 [-8.14302041e-03  1.86580037e-02]]
grads:  [-0.00831877  0.00637199]
Stock Position:  -0.00831876553577055
Bond Position:  [10.4926401]


portfolio before change:  [9.63120465]
curr_Stock_Price:  103.71095496456685
curr_Factors:  [1.03710955e+02 4.14876320e-02]
mat_Sqrt:  [[ 2.11243793e+01  0.00000000e+00]
 [-8.14740518e-03  1.86680505e-02]]
grads:  [-5.21339867e-03  5.43774147e+00]
Stock Position:  -0.0052133986712949556
Bond Position:  [10.1718912]


portfolio before change:  [9.63236986]
curr_Stock_Price:  103.73135455217712
curr_Factors:  [1.03731355e+02 4.10387178e-02]
mat_Sqrt:  [[ 2.10139135e+01  0.00000000e+00]
 [-8.10320606e-03  1.85667776e-02]]
grads:  [5.91843551e-04 6.19673491e+00]
Stock Position:  0.000591843550559867
Bond Position:  [9.57097713]


portfolio before change:  [9.63338951]
curr_Stock_Price:  103.43262315451453
curr_Factors:  [1.03432623e+02 4.26141036e-02]
mat_Sqrt:  [[ 2.13517865e+01  0.00000000e+00]
 [-8.25727350e-03  1.89197904e-02]]
grads:  [1.63304527e-03 1.05156868e+01]
Stock Position:  0.0016330452735502895
Bond Position:  [9.46447935]


portfolio before change:  [9.63639789]
curr_Stock_Price:  104.55032193714955
curr_Factors:  [1.04550322e+02 4.06932205e-02]
mat_Sqrt:  [[ 2.10904771e+01  0.00000000e+00]
 [-8.06902427e-03  1.84884573e-02]]
grads:  [-0.03591039 -0.72009939]
Stock Position:  -0.035910386514059346
Bond Position:  [13.39084036]


portfolio before change:  [9.651433]
curr_Stock_Price:  104.17825284835631
curr_Factors:  [1.04178253e+02 4.02949314e-02]
mat_Sqrt:  [[ 2.09123231e+01  0.00000000e+00]
 [-8.02943898e-03  1.83977560e-02]]
grads:  [-0.00775203 -1.37745215]
Stock Position:  -0.007752032095916859
Bond Position:  [10.45902616]


portfolio before change:  [9.65828067]
curr_Stock_Price:  103.46357407961337
curr_Factors:  [1.03463574e+02 4.14644868e-02]
mat_Sqrt:  [[ 2.10681123e+01  0.00000000e+00]
 [-8.14513222e-03  1.86628425e-02]]
grads:  [ 0.00294768 -0.8686605 ]
Stock Position:  0.002947676368991868
Bond Position:  [9.35330354]


portfolio before change:  [9.6578415]
curr_Stock_Price:  102.91792117790592
curr_Factors:  [1.02917921e+02 4.15812291e-02]
mat_Sqrt:  [[ 2.09864831e+01  0.00000000e+00]
 [-8.15659038e-03  1.86890964e-02]]
grads:  [-0.01113452  4.66267098]
Stock Position:  -0.011134524150507015
Bond Position:  [10.80378358]


portfolio before change:  [9.65496447]
curr_Stock_Price:  103.29760403685458
curr_Factors:  [1.03297604e+02 4.12370449e-02]
mat_Sqrt:  [[ 2.09765478e+01  0.00000000e+00]
 [-8.12276258e-03  1.86115872e-02]]
grads:  [0.00483736 2.86644338]
Stock Position:  0.00483736278386468
Bond Position:  [9.15527648]


portfolio before change:  [9.66534716]
curr_Stock_Price:  105.20736521747581
curr_Factors:  [1.05207365e+02 3.96744623e-02]
mat_Sqrt:  [[ 2.09556757e+01  0.00000000e+00]
 [-7.96737972e-03  1.82555603e-02]]
grads:  [-0.00451752  4.45481512]
Stock Position:  -0.004517516498524907
Bond Position:  [10.14062316]


portfolio before change:  [9.66639343]
curr_Stock_Price:  105.25637070994499
curr_Factors:  [1.05256371e+02 3.87863470e-02]
mat_Sqrt:  [[ 2.07294524e+01  0.00000000e+00]
 [-7.87769986e-03  1.80500780e-02]]
grads:  [-0.01720013 -1.13324147]
Stock Position:  -0.017200134470316538
Bond Position:  [11.47681716]


portfolio before change:  [9.67553309]
curr_Stock_Price:  104.80841109321155
curr_Factors:  [1.04808411e+02 3.81412626e-02]
mat_Sqrt:  [[ 2.04688607e+01  0.00000000e+00]
 [-7.81191526e-03  1.78993465e-02]]
grads:  [-5.01345387e-03 -9.53244660e+00]
Stock Position:  -0.005013453870319913
Bond Position:  [10.20098522]


portfolio before change:  [9.68087357]
curr_Stock_Price:  103.99753665771632
curr_Factors:  [1.03997537e+02 3.74233857e-02]
mat_Sqrt:  [[ 2.01184534e+01  0.00000000e+00]
 [-7.73804996e-03  1.77300998e-02]]
grads:  [-1.67566514e-03 -3.40153899e+00]
Stock Position:  -0.0016756651400198224
Bond Position:  [9.85513862]


portfolio before change:  [9.6844055]
curr_Stock_Price:  102.6249731356389
curr_Factors:  [1.02624973e+02 3.71964914e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.6844055]
Stock Price:  101.86489254989102
PL:  [7.81951295]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.25566744e+00  3.12782465e-01]
 [-2.04251077e-01 -6.59967527e-02]
 [-9.12995695e-02 -8.06554268e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.23166322e-01 -6.21654545e-01]
 [-2.20771791e-01  3.61342890e-02]
 [ 1.18779308e-01 -3.91612490e-02]
 [ 7.11954006e-01  7.00650620e-01]
 [-4.35182895e-02  2.04415940e-01]
 [ 1.83747793e-01  5.53858004e-02]
 [-1.08524391e-01 -1.91934711e-03]
 [ 2.98465446e-02 -1.35574572e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.79389808e-02 -3.42093473e-02]
 [ 4.69489343e-01  2.99761712e-01]
 [ 1.31185632e-01 -1.75111042e-01]
 [ 3.99148961e-02  1.24532913e-01]
 [-3.35502032e-03  1.34725751e-02]
 [-1.13959225e-01 -4.69287644e-01]
 [-8.12224333e-03 -7.93012711e-02]
 [ 1.76689275e-01 -4.46819916e-02]
 [ 9.07495132e-01  3.35264757e-02]
 [ 2.85592895e-02 -3.13173327e-01]
 [ 5.82512844e-02  6.10387568e-03]
 [ 6.91301882e-02 -1.57789006e-02]
 [ 1.69321940e-01 -8.95832286e-02]
 [ 1.01519060e-01 -1.40239988e-01]
 [ 5.05073291e-02  2.70657237e-01]
 [-3.00332063e-02  1.88623721e-01]
 [-5.32313372e-01 -1.01187009e-01]
 [-1.66733558e-01 -6.18128931e-02]
 [ 1.03525746e-02 -6.87274844e-02]
 [-1.31226327e-01  1.54561896e-01]
 [ 9.84656594e-03  4.11625267e-03]
 [ 1.15732613e-01 -6.54503774e-02]
 [ 3.46185113e-02  1.16245521e-01]
 [-4.81089417e-02  4.37869613e-02]
 [-2.54151895e-01 -9.96819620e-02]
 [ 1.41032495e-01  2.95038386e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.8247058]
curr_Stock_Price:  100.31109083748278
curr_Factors:  [1.00311091e+02 4.00952190e-02]
mat_Sqrt:  [[ 2.00860828e+01  0.00000000e+00]
 [-8.00951624e-03  1.83521072e-02]]
grads:  [ 0.06931052 17.04340875]
Stock Position:  0.06931052277195862
Bond Position:  [-2.12790835]


portfolio before change:  [4.89725874]
curr_Stock_Price:  101.36170973475868
curr_Factors:  [1.01361710e+02 4.12115522e-02]
mat_Sqrt:  [[ 2.05770642e+01  0.00000000e+00]
 [-8.12025144e-03  1.86058335e-02]]
grads:  [-0.01132593 -3.54710004]
Stock Position:  -0.011325931547517156
Bond Position:  [6.04527453]


portfolio before change:  [4.8986136]
curr_Stock_Price:  101.30880902687909
curr_Factors:  [1.01308809e+02 4.17685091e-02]
mat_Sqrt:  [[ 2.07048313e+01  0.00000000e+00]
 [-8.17493820e-03  1.87311365e-02]]
grads:  [-0.00610971 -4.30595478]
Stock Position:  -0.006109708489006024
Bond Position:  [5.51758089]


portfolio before change:  [4.89406762]
curr_Stock_Price:  102.16575965503063
curr_Factors:  [1.02165760e+02 4.09185279e-02]
mat_Sqrt:  [[ 2.06664256e+01  0.00000000e+00]
 [-8.09133145e-03  1.85395694e-02]]
grads:  [-7.88785021e-04 -8.16560563e+00]
Stock Position:  -0.0007887850210095184
Bond Position:  [4.97465444]


portfolio before change:  [4.89386436]
curr_Stock_Price:  103.21183998482064
curr_Factors:  [1.03211840e+02 4.03722637e-02]
mat_Sqrt:  [[ 2.07382006e+01  0.00000000e+00]
 [-8.03714016e-03  1.84154016e-02]]
grads:  [-1.90218340e-02 -3.37573168e+01]
Stock Position:  -0.019021833952871655
Bond Position:  [6.85714284]


portfolio before change:  [4.9461267]
curr_Stock_Price:  100.50941135582835
curr_Factors:  [1.00509411e+02 4.25160881e-02]
mat_Sqrt:  [[ 2.07244674e+01  0.00000000e+00]
 [-8.24777188e-03  1.88980195e-02]]
grads:  [-0.00989176  1.91206751]
Stock Position:  -0.00989176177344931
Bond Position:  [5.94034185]


portfolio before change:  [4.94398715]
curr_Stock_Price:  100.80077916661925
curr_Factors:  [1.00800779e+02 4.26475362e-02]
mat_Sqrt:  [[ 2.08166511e+01  0.00000000e+00]
 [-8.26051197e-03  1.89272107e-02]]
grads:  [ 0.00488493 -2.06904491]
Stock Position:  0.004884932633065075
Bond Position:  [4.45158213]


portfolio before change:  [4.93446487]
curr_Stock_Price:  98.73754480853897
curr_Factors:  [9.87375448e+01 4.19773188e-02]
mat_Sqrt:  [[ 2.02297107e+01  0.00000000e+00]
 [-8.19534685e-03  1.87778987e-02]]
grads:  [ 0.05030932 37.31251474]
Stock Position:  0.05030932087971686
Bond Position:  [-0.03295395]


portfolio before change:  [4.95547388]
curr_Stock_Price:  99.15522345743955
curr_Factors:  [9.91552235e+01 4.29540196e-02]
mat_Sqrt:  [[ 2.05502686e+01  0.00000000e+00]
 [-8.29014061e-03  1.89950984e-02]]
grads:  [2.22362742e-03 1.07615099e+01]
Stock Position:  0.002223627421418235
Bond Position:  [4.73498961]


portfolio before change:  [4.9559149]
curr_Stock_Price:  99.08736482656683
curr_Factors:  [9.90873648e+01 4.38721208e-02]
mat_Sqrt:  [[ 2.07545152e+01  0.00000000e+00]
 [-8.37826911e-03  1.91970262e-02]]
grads:  [0.01001807 2.88512397]
Stock Position:  0.010018067689502174
Bond Position:  [3.96325097]


portfolio before change:  [4.96272349]
curr_Stock_Price:  99.71754178587429
curr_Factors:  [9.97175418e+01 4.24345248e-02]
mat_Sqrt:  [[ 2.05414566e+01  0.00000000e+00]
 [-8.23985677e-03  1.88798837e-02]]
grads:  [-0.00532397 -0.10166096]
Stock Position:  -0.0053239682821819715
Bond Position:  [5.49361652]


portfolio before change:  [4.96365224]
curr_Stock_Price:  99.67208718630233
curr_Factors:  [9.96720872e+01 4.25604609e-02]
mat_Sqrt:  [[ 2.05625378e+01  0.00000000e+00]
 [-8.25207473e-03  1.89078786e-02]]
grads:  [-1.42604234e-03 -7.17026883e+00]
Stock Position:  -0.0014260423447917038
Bond Position:  [5.10578885]


portfolio before change:  [4.9648596]
curr_Stock_Price:  99.27300688215196
curr_Factors:  [9.92730069e+01 4.33334759e-02]
mat_Sqrt:  [[ 2.06653583e+01  0.00000000e+00]
 [-8.32667770e-03  1.90788154e-02]]
grads:  [-0.00625921 -1.47029071]
Stock Position:  -0.0062592134251430245
Bond Position:  [5.58623054]


portfolio before change:  [4.96347505]
curr_Stock_Price:  99.60577680053419
curr_Factors:  [9.96057768e+01 4.33048298e-02]
mat_Sqrt:  [[ 2.07277754e+01  0.00000000e+00]
 [-8.32392501e-03  1.90725082e-02]]
grads:  [-0.00303309 -1.79364701]
Stock Position:  -0.003033087861309909
Bond Position:  [5.26558812]


portfolio before change:  [4.9642177]
curr_Stock_Price:  99.57794681051166
curr_Factors:  [9.95779468e+01 4.42373601e-02]
mat_Sqrt:  [[ 2.09439103e+01  0.00000000e+00]
 [-8.41307175e-03  1.92767691e-02]]
grads:  [ 0.02866304 15.5504126 ]
Stock Position:  0.028663037217082712
Bond Position:  [2.1100113]


portfolio before change:  [4.96540087]
curr_Stock_Price:  99.61002293624732
curr_Factors:  [9.96100229e+01 4.39817782e-02]
mat_Sqrt:  [[ 2.08900477e+01  0.00000000e+00]
 [-8.38873323e-03  1.92210025e-02]]
grads:  [ 2.62138738e-03 -9.11040107e+00]
Stock Position:  0.0026213873756660375
Bond Position:  [4.70428441]


portfolio before change:  [4.96133824]
curr_Stock_Price:  97.83588558353387
curr_Factors:  [9.78358856e+01 4.39347370e-02]
mat_Sqrt:  [[ 2.05070031e+01  0.00000000e+00]
 [-8.38424589e-03  1.92107207e-02]]
grads:  [4.59674750e-03 6.48246958e+00]
Stock Position:  0.0045967474992654024
Bond Position:  [4.51161138]


portfolio before change:  [4.96653086]
curr_Stock_Price:  98.84282262359922
curr_Factors:  [9.88428226e+01 4.36733221e-02]
mat_Sqrt:  [[ 2.06563343e+01  0.00000000e+00]
 [-8.35926524e-03  1.91534829e-02]]
grads:  [1.22233377e-04 7.03400795e-01]
Stock Position:  0.00012223337697281293
Bond Position:  [4.95444897]


portfolio before change:  [4.96743901]
curr_Stock_Price:  101.20556892438259
curr_Factors:  [1.01205569e+02 4.39791610e-02]
mat_Sqrt:  [[ 2.12240315e+01  0.00000000e+00]
 [-8.38848363e-03  1.92204306e-02]]
grads:  [-1.50194437e-02 -2.44160838e+01]
Stock Position:  -0.015019443651206651
Bond Position:  [6.48749035]


portfolio before change:  [4.9640319]
curr_Stock_Price:  101.48641163001571
curr_Factors:  [1.01486412e+02 4.25168155e-02]
mat_Sqrt:  [[ 2.09260983e+01  0.00000000e+00]
 [-8.24784243e-03  1.88981811e-02]]
grads:  [-2.04205079e-03 -4.19623828e+00]
Stock Position:  -0.0020420507856273927
Bond Position:  [5.1712723]


portfolio before change:  [4.96898996]
curr_Stock_Price:  99.37500045254916
curr_Factors:  [9.93750005e+01 4.25999370e-02]
mat_Sqrt:  [[ 2.05107538e+01  0.00000000e+00]
 [-8.25590087e-03  1.89166453e-02]]
grads:  [ 0.00766371 -2.36204627]
Stock Position:  0.007663709323376623
Bond Position:  [4.20740884]


portfolio before change:  [4.96977668]
curr_Stock_Price:  99.40902694576822
curr_Factors:  [9.94090269e+01 4.08862647e-02]
mat_Sqrt:  [[ 2.01008555e+01  0.00000000e+00]
 [-8.08814091e-03  1.85322590e-02]]
grads:  [0.04587503 1.80908737]
Stock Position:  0.045875026935536474
Bond Position:  [0.40938489]


portfolio before change:  [5.03970325]
curr_Stock_Price:  100.93219533815066
curr_Factors:  [1.00932195e+02 3.98644018e-02]
mat_Sqrt:  [[ 2.01521945e+01  0.00000000e+00]
 [-7.98642867e-03  1.82992069e-02]]
grads:  [-5.36521003e-03 -1.71140382e+01]
Stock Position:  -0.005365210030734045
Bond Position:  [5.58122568]


portfolio before change:  [5.03659613]
curr_Stock_Price:  101.64136084310682
curr_Factors:  [1.01641361e+02 3.93298050e-02]
mat_Sqrt:  [[ 2.01572540e+01  0.00000000e+00]
 [-7.93269739e-03  1.81760931e-02]]
grads:  [0.003022  0.3358189]
Stock Position:  0.003022000629586352
Bond Position:  [4.72943587]


portfolio before change:  [5.03088683]
curr_Stock_Price:  99.5564800391393
curr_Factors:  [9.95564800e+01 3.96061442e-02]
mat_Sqrt:  [[ 1.98130263e+01  0.00000000e+00]
 [-7.96051699e-03  1.82398358e-02]]
grads:  [ 0.00314155 -0.86507909]
Stock Position:  0.0031415549808053375
Bond Position:  [4.71812468]


portfolio before change:  [5.03433235]
curr_Stock_Price:  100.46549284652299
curr_Factors:  [1.00465493e+02 3.98924606e-02]
mat_Sqrt:  [[ 2.00660704e+01  0.00000000e+00]
 [-7.98923882e-03  1.83056458e-02]]
grads:  [ 0.00648979 -4.8937486 ]
Stock Position:  0.006489791521056094
Bond Position:  [4.38233224]


portfolio before change:  [5.03399251]
curr_Stock_Price:  100.32871426322133
curr_Factors:  [1.00328714e+02 3.96828833e-02]
mat_Sqrt:  [[ 1.99860448e+01  0.00000000e+00]
 [-7.96822522e-03  1.82574976e-02]]
grads:  [ 2.01707300e-03 -7.68122721e+00]
Stock Position:  0.002017073002928474
Bond Position:  [4.83162217]


portfolio before change:  [5.03656848]
curr_Stock_Price:  101.3063601752018
curr_Factors:  [1.01306360e+02 4.02662654e-02]
mat_Sqrt:  [[ 2.03285961e+01  0.00000000e+00]
 [-8.02658238e-03  1.83912107e-02]]
grads:  [8.29530138e-03 1.47166623e+01]
Stock Position:  0.008295301375494281
Bond Position:  [4.19620169]


portfolio before change:  [5.04193186]
curr_Stock_Price:  101.8896812252167
curr_Factors:  [1.01889681e+02 3.94924833e-02]
mat_Sqrt:  [[ 2.02482468e+01  0.00000000e+00]
 [-7.94908632e-03  1.82136449e-02]]
grads:  [2.58239319e-03 1.03561765e+01]
Stock Position:  0.0025823931943492733
Bond Position:  [4.77881264]


portfolio before change:  [5.03940019]
curr_Stock_Price:  100.67799204417582
curr_Factors:  [1.00677992e+02 4.00147567e-02]
mat_Sqrt:  [[ 2.01393123e+01  0.00000000e+00]
 [-8.00147553e-03  1.83336837e-02]]
grads:  [-0.02862436 -5.51918594]
Stock Position:  -0.02862436393087929
Bond Position:  [7.92124368]


portfolio before change:  [5.06842841]
curr_Stock_Price:  99.69847673461985
curr_Factors:  [9.96984767e+01 4.09001757e-02]
mat_Sqrt:  [[ 2.01628124e+01  0.00000000e+00]
 [-8.08951674e-03  1.85354114e-02]]
grads:  [-0.00960734 -3.33485412]
Stock Position:  -0.009607336146504877
Bond Position:  [6.02626519]


portfolio before change:  [5.05967214]
curr_Stock_Price:  100.68830437502316
curr_Factors:  [1.00688304e+02 3.94461166e-02]
mat_Sqrt:  [[ 1.99977509e+01  0.00000000e+00]
 [-7.94441857e-03  1.82029497e-02]]
grads:  [-9.82238394e-04 -3.77562348e+00]
Stock Position:  -0.000982238393927472
Bond Position:  [5.15857206]


portfolio before change:  [5.06151474]
curr_Stock_Price:  99.4689090665061
curr_Factors:  [9.94689091e+01 4.02786148e-02]
mat_Sqrt:  [[ 1.99629454e+01  0.00000000e+00]
 [-8.02781314e-03  1.83940307e-02]]
grads:  [-3.19441766e-03  8.40282907e+00]
Stock Position:  -0.0031944176639197006
Bond Position:  [5.37925998]


portfolio before change:  [5.06922748]
curr_Stock_Price:  97.26497362271813
curr_Factors:  [9.72649736e+01 4.00899651e-02]
mat_Sqrt:  [[ 1.94748586e+01  0.00000000e+00]
 [-8.00899145e-03  1.83509048e-02]]
grads:  [0.00059785 0.22430789]
Stock Position:  0.000597850087288785
Bond Position:  [5.0110776]


portfolio before change:  [5.06966545]
curr_Stock_Price:  96.94975733284068
curr_Factors:  [9.69497573e+01 4.08414801e-02]
mat_Sqrt:  [[ 1.95928432e+01  0.00000000e+00]
 [-8.08371005e-03  1.85221066e-02]]
grads:  [ 0.00444896 -3.53363572]
Stock Position:  0.004448957478288113
Bond Position:  [4.6383401]


portfolio before change:  [5.06635173]
curr_Stock_Price:  96.07459825370407
curr_Factors:  [9.60745983e+01 4.16744495e-02]
mat_Sqrt:  [[ 1.96129767e+01  0.00000000e+00]
 [-8.16572834e-03  1.87100341e-02]]
grads:  [4.35182365e-03 6.21300424e+00]
Stock Position:  0.004351823652677237
Bond Position:  [4.64825202]


portfolio before change:  [5.06716719]
curr_Stock_Price:  96.12845812317023
curr_Factors:  [9.61284581e+01 4.02445270e-02]
mat_Sqrt:  [[ 1.92843671e+01  0.00000000e+00]
 [-8.02441545e-03  1.83862456e-02]]
grads:  [-1.50374368e-03  2.38150639e+00]
Stock Position:  -0.0015037436763633222
Bond Position:  [5.21171975]


portfolio before change:  [5.0680021]
curr_Stock_Price:  96.00649138197292
curr_Factors:  [9.60064914e+01 3.97214961e-02]
mat_Sqrt:  [[ 1.91343360e+01  0.00000000e+00]
 [-7.97210096e-03  1.82663780e-02]]
grads:  [-0.01555615 -5.45712794]
Stock Position:  -0.01555615353539584
Bond Position:  [6.56149382]


portfolio before change:  [5.09881753]
curr_Stock_Price:  94.07830343630059
curr_Factors:  [9.40783034e+01 3.82234363e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.09881753]
Stock Price:  95.87814754105315
PL:  [5.09881753]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.49887585e+00  3.67767014e-01]
 [ 1.10545236e+00  6.78718775e-02]
 [ 7.79623107e-02  1.01428879e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.59607145e-02  5.43177667e-01]
 [ 1.50433698e-02 -5.26413957e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.90653419e-01  8.90624165e-01]
 [-2.23795672e-02  2.72632475e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-9.11461872e-02  8.45519222e-03]
 [ 4.98680917e-02 -1.33876562e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-1.11504510e-01  1.87786234e-01]
 [ 4.91860165e-01  3.20990404e-01]
 [ 1.31311492e-01  3.79588282e-02]
 [ 4.01037826e-02  1.27381319e-01]
 [ 1.72029076e-02  6.07424258e-02]
 [-6.12823862e-02 -4.37989410e-02]
 [-1.68393678e-01  1.92553442e-02]
 [ 1.76689275e-01 -4.46819916e-02]
 [ 8.38824628e-01 -9.14047047e-03]
 [ 2.61298901e-02 -1.93463761e-01]
 [ 4.09174966e-02  1.13934760e-02]
 [ 3.49298677e-01 -2.51619381e-01]
 [-1.25815455e-02 -4.72110393e-02]
 [-2.61349401e-02 -8.62680414e-02]
 [ 4.72056681e-02  1.07059887e-01]
 [ 2.21384642e-01 -9.53216970e-04]
 [-5.34535080e-01 -1.63205196e-01]
 [-9.24421833e-02 -3.10884837e-02]
 [-3.65123686e-02  1.61366257e-02]
 [ 1.53957041e-01  1.99814099e-01]
 [ 2.10401427e-02 -7.65014171e-03]
 [ 2.18482842e-01 -1.66914516e-01]
 [ 8.19311239e-02  8.62542025e-02]
 [-6.39615890e-02  3.01758465e-01]
 [-3.71931406e-01 -1.39905193e-01]
 [-5.80288795e-02  4.92136683e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.46255509]
curr_Stock_Price:  99.25330873651545
curr_Factors:  [9.92533087e+01 4.01778835e-02]
mat_Sqrt:  [[ 1.98947516e+01  0.00000000e+00]
 [-8.01776862e-03  1.83710158e-02]]
grads:  [ 0.08340806 20.01887204]
Stock Position:  0.08340805513411957
Bond Position:  [-10.74108054]


portfolio before change:  [-2.54473853]
curr_Stock_Price:  98.28408921338306
curr_Factors:  [9.82840892e+01 4.03422114e-02]
mat_Sqrt:  [[ 1.97407236e+01  0.00000000e+00]
 [-8.03414826e-03  1.84085463e-02]]
grads:  [0.05749911 3.6869765 ]
Stock Position:  0.05749911207250519
Bond Position:  [-8.19598639]


portfolio before change:  [-2.54167828]
curr_Stock_Price:  98.3551305339781
curr_Factors:  [9.83551305e+01 3.91718422e-02]
mat_Sqrt:  [[ 1.94663271e+01  0.00000000e+00]
 [-7.91675107e-03  1.81395555e-02]]
grads:  [0.00423239 0.55915857]
Stock Position:  0.004232387001477605
Bond Position:  [-2.95795525]


portfolio before change:  [-2.54568039]
curr_Stock_Price:  97.49690364204665
curr_Factors:  [9.74969036e+01 3.94890779e-02]
mat_Sqrt:  [[ 1.93744472e+01  0.00000000e+00]
 [-7.94874359e-03  1.82128596e-02]]
grads:  [-8.41384881e-04 -8.31208365e+00]
Stock Position:  -0.0008413848812469902
Bond Position:  [-2.46364797]


portfolio before change:  [-2.54652195]
curr_Stock_Price:  98.13107582390687
curr_Factors:  [9.81310758e+01 3.95548533e-02]
mat_Sqrt:  [[ 1.95167028e+01  0.00000000e+00]
 [-7.95536079e-03  1.82280215e-02]]
grads:  [7.22977933e-03 2.97990469e+01]
Stock Position:  0.007229779328152928
Bond Position:  [-3.25598797]


portfolio before change:  [-2.55375443]
curr_Stock_Price:  97.18700079075282
curr_Factors:  [9.71870008e+01 3.99930796e-02]
mat_Sqrt:  [[ 1.94357187e+01  0.00000000e+00]
 [-7.99930793e-03  1.83287170e-02]]
grads:  [-4.08074376e-04 -2.87207203e+00]
Stock Position:  -0.00040807437566514637
Bond Position:  [-2.5140949]


portfolio before change:  [-2.5544493]
curr_Stock_Price:  98.11965048553182
curr_Factors:  [9.81196505e+01 3.89983785e-02]
mat_Sqrt:  [[ 1.93766756e+01  0.00000000e+00]
 [-7.89920284e-03  1.80993475e-02]]
grads:  [0.00667678 5.31162172]
Stock Position:  0.006676778835656442
Bond Position:  [-3.20957251]


portfolio before change:  [-2.55881931]
curr_Stock_Price:  97.52523370606326
curr_Factors:  [9.75252337e+01 3.88580424e-02]
mat_Sqrt:  [[ 1.92246065e+01  0.00000000e+00]
 [-7.88497736e-03  1.80667528e-02]]
grads:  [ 0.06654772 49.2963055 ]
Stock Position:  0.06654771701059733
Bond Position:  [-9.04890097]


portfolio before change:  [-2.49027309]
curr_Stock_Price:  98.57226289721831
curr_Factors:  [9.85722629e+01 3.74484569e-02]
mat_Sqrt:  [[ 1.90753138e+01  0.00000000e+00]
 [-7.74064152e-03  1.77360378e-02]]
grads:  [5.06450383e-03 1.53716674e+01]
Stock Position:  0.005064503834006164
Bond Position:  [-2.9894927]


portfolio before change:  [-2.49316473]
curr_Stock_Price:  98.07509200388934
curr_Factors:  [9.80750920e+01 3.72132583e-02]
mat_Sqrt:  [[ 1.89194093e+01  0.00000000e+00]
 [-7.71629531e-03  1.76802537e-02]]
grads:  [0.01302547 6.39563976]
Stock Position:  0.013025469382401953
Bond Position:  [-3.77063883]


portfolio before change:  [-2.48915795]
curr_Stock_Price:  98.4188907901978
curr_Factors:  [9.84188908e+01 3.56740832e-02]
mat_Sqrt:  [[ 1.85889507e+01  0.00000000e+00]
 [-7.55503363e-03  1.73107567e-02]]
grads:  [-0.00470473  0.48843574]
Stock Position:  -0.004704732397222375
Bond Position:  [-2.0261234]


portfolio before change:  [-2.48551152]
curr_Stock_Price:  97.59000036686903
curr_Factors:  [9.75900004e+01 3.49866762e-02]
mat_Sqrt:  [[ 1.82539418e+01  0.00000000e+00]
 [-7.48189026e-03  1.71431642e-02]]
grads:  [-4.68963372e-04 -7.80932622e+00]
Stock Position:  -0.00046896337154464404
Bond Position:  [-2.43974538]


portfolio before change:  [-2.48599903]
curr_Stock_Price:  97.97920336588537
curr_Factors:  [9.79792034e+01 3.46534072e-02]
mat_Sqrt:  [[ 1.82392457e+01  0.00000000e+00]
 [-7.44617026e-03  1.70613194e-02]]
grads:  [-0.00709179 -1.64415216]
Stock Position:  -0.007091789318381669
Bond Position:  [-1.79115116]


portfolio before change:  [-2.4801161]
curr_Stock_Price:  97.11808933464292
curr_Factors:  [9.71180893e+01 3.57094972e-02]
mat_Sqrt:  [[ 1.83523633e+01  0.00000000e+00]
 [-7.55878267e-03  1.73193469e-02]]
grads:  [-1.61003123e-03  1.08425702e+01]
Stock Position:  -0.001610031233530019
Bond Position:  [-2.32375294]


portfolio before change:  [-2.48175063]
curr_Stock_Price:  97.95288271396117
curr_Factors:  [9.79528827e+01 3.39388647e-02]
mat_Sqrt:  [[ 1.80453736e+01  0.00000000e+00]
 [-7.36900152e-03  1.68845036e-02]]
grads:  [ 0.03502016 19.01094701]
Stock Position:  0.03502015966120023
Bond Position:  [-5.91207622]


portfolio before change:  [-2.52066904]
curr_Stock_Price:  96.8626718472836
curr_Factors:  [9.68626718e+01 3.45613158e-02]
mat_Sqrt:  [[ 1.80074235e+01  0.00000000e+00]
 [-7.43626958e-03  1.70386341e-02]]
grads:  [0.00821206 2.22780934]
Stock Position:  0.008212062267455411
Bond Position:  [-3.31611133]


portfolio before change:  [-2.51589917]
curr_Stock_Price:  97.49398788072037
curr_Factors:  [9.74939879e+01 3.45388278e-02]
mat_Sqrt:  [[ 1.81188918e+01  0.00000000e+00]
 [-7.43384991e-03  1.70330900e-02]]
grads:  [5.28164463e-03 7.47846214e+00]
Stock Position:  0.005281644627885417
Bond Position:  [-3.03082777]


portfolio before change:  [-2.51252566]
curr_Stock_Price:  98.20444642515653
curr_Factors:  [9.82044464e+01 3.47482048e-02]
mat_Sqrt:  [[ 1.83061635e+01  0.00000000e+00]
 [-7.45634814e-03  1.70846399e-02]]
grads:  [2.38788841e-03 3.55538228e+00]
Stock Position:  0.002387888405006701
Bond Position:  [-2.74702692]


portfolio before change:  [-2.51276992]
curr_Stock_Price:  98.24596553366356
curr_Factors:  [9.82459655e+01 3.46712273e-02]
mat_Sqrt:  [[ 1.82936065e+01  0.00000000e+00]
 [-7.44808457e-03  1.70657057e-02]]
grads:  [-0.00439486 -2.56648872]
Stock Position:  -0.004394858459494038
Bond Position:  [-2.08099281]


portfolio before change:  [-2.51445825]
curr_Stock_Price:  98.57093502699817
curr_Factors:  [9.85709350e+01 3.50833641e-02]
mat_Sqrt:  [[ 1.84628819e+01  0.00000000e+00]
 [-7.49222147e-03  1.71668360e-02]]
grads:  [-0.00866549  1.12165947]
Stock Position:  -0.008665492059181289
Bond Position:  [-1.6602926]


portfolio before change:  [-2.52055741]
curr_Stock_Price:  99.250827775986
curr_Factors:  [9.92508278e+01 3.56525083e-02]
mat_Sqrt:  [[ 1.87404141e+01  0.00000000e+00]
 [-7.55274873e-03  1.73055214e-02]]
grads:  [ 0.00838767 -2.58195004]
Stock Position:  0.008387672476934087
Bond Position:  [-3.35304085]


portfolio before change:  [-2.51582377]
curr_Stock_Price:  99.86515753538396
curr_Factors:  [9.98651575e+01 3.52200568e-02]
mat_Sqrt:  [[ 1.87417015e+01  0.00000000e+00]
 [-7.50680297e-03  1.72002464e-02]]
grads:  [ 0.04454427 -0.53141509]
Stock Position:  0.04454426926426821
Bond Position:  [-6.96424424]


portfolio before change:  [-2.50583079]
curr_Stock_Price:  100.10903991414403
curr_Factors:  [1.00109040e+02 3.43896493e-02]
mat_Sqrt:  [[ 1.85646673e+01  0.00000000e+00]
 [-7.41777857e-03  1.69962659e-02]]
grads:  [-3.14062280e-03 -1.13827215e+01]
Stock Position:  -0.0031406228003257003
Bond Position:  [-2.19142606]


portfolio before change:  [-2.50924953]
curr_Stock_Price:  101.11036628966964
curr_Factors:  [1.01110366e+02 3.37874983e-02]
mat_Sqrt:  [[ 1.85854766e+01  0.00000000e+00]
 [-7.35255040e-03  1.68468094e-02]]
grads:  [0.00246913 0.67629875]
Stock Position:  0.002469133194136445
Bond Position:  [-2.75890449]


portfolio before change:  [-2.50655515]
curr_Stock_Price:  102.34126707349456
curr_Factors:  [1.02341267e+02 3.48940615e-02]
mat_Sqrt:  [[ 1.91172998e+01  0.00000000e+00]
 [-7.47198088e-03  1.71204590e-02]]
grads:  [ 1.25270294e-02 -1.46969997e+01]
Stock Position:  0.012527029376217675
Bond Position:  [-3.78858721]


portfolio before change:  [-2.50646943]
curr_Stock_Price:  102.38591618821758
curr_Factors:  [1.02385916e+02 3.41460510e-02]
mat_Sqrt:  [[ 1.89195352e+01  0.00000000e+00]
 [-7.39146005e-03  1.69359626e-02]]
grads:  [-1.75406700e-03 -2.78762067e+00]
Stock Position:  -0.0017540669956051971
Bond Position:  [-2.32687768]


portfolio before change:  [-2.50438187]
curr_Stock_Price:  101.02995979550712
curr_Factors:  [1.01029960e+02 3.34454853e-02]
mat_Sqrt:  [[ 1.84764670e+01  0.00000000e+00]
 [-7.31524275e-03  1.67613268e-02]]
grads:  [-3.45225091e-03 -5.14685039e+00]
Stock Position:  -0.0034522509120921458
Bond Position:  [-2.1556011]


portfolio before change:  [-2.4976368]
curr_Stock_Price:  98.99808518127611
curr_Factors:  [9.89980852e+01 3.48150354e-02]
mat_Sqrt:  [[ 1.84718424e+01  0.00000000e+00]
 [-7.46351504e-03  1.71010613e-02]]
grads:  [5.08506034e-03 6.26042354e+00]
Stock Position:  0.005085060339833773
Bond Position:  [-3.00104804]


portfolio before change:  [-2.50363651]
curr_Stock_Price:  97.8919915576765
curr_Factors:  [9.78919916e+01 3.59524849e-02]
mat_Sqrt:  [[ 1.85614381e+01  0.00000000e+00]
 [-7.58445620e-03  1.73781723e-02]]
grads:  [ 0.01190471 -0.05485139]
Stock Position:  0.011904714684167162
Bond Position:  [-3.66901274]


portfolio before change:  [-2.50843817]
curr_Stock_Price:  97.52717718396377
curr_Factors:  [9.75271772e+01 3.64870098e-02]
mat_Sqrt:  [[ 1.86292251e+01  0.00000000e+00]
 [-7.64062927e-03  1.75068810e-02]]
grads:  [-0.03251685 -9.32234564]
Stock Position:  -0.03251684720928331
Bond Position:  [0.66283815]


portfolio before change:  [-2.49611964]
curr_Stock_Price:  97.15089002043204
curr_Factors:  [9.71508900e+01 3.55618461e-02]
mat_Sqrt:  [[ 1.83205679e+01  0.00000000e+00]
 [-7.54313952e-03  1.72835039e-02]]
grads:  [-0.00578641 -1.79873733]
Stock Position:  -0.0057864095815687005
Bond Position:  [-1.9339648]


portfolio before change:  [-2.49434009]
curr_Stock_Price:  96.8015690208757
curr_Factors:  [9.68015690e+01 3.65208999e-02]
mat_Sqrt:  [[ 1.84992078e+01  0.00000000e+00]
 [-7.64417686e-03  1.75150095e-02]]
grads:  [-0.00159303  0.92130271]
Stock Position:  -0.0015930286321072947
Bond Position:  [-2.34013242]


portfolio before change:  [-2.49437153]
curr_Stock_Price:  96.63767381656237
curr_Factors:  [9.66376738e+01 3.77012525e-02]
mat_Sqrt:  [[ 1.87639539e+01  0.00000000e+00]
 [-7.76672415e-03  1.77958007e-02]]
grads:  [ 0.01285247 11.22816012]
Stock Position:  0.012852465136890588
Bond Position:  [-3.73640387]


portfolio before change:  [-2.49966028]
curr_Stock_Price:  96.2625186697336
curr_Factors:  [9.62625187e+01 3.85056315e-02]
mat_Sqrt:  [[ 1.88894514e+01  0.00000000e+00]
 [-7.84914074e-03  1.79846408e-02]]
grads:  [ 0.0009371  -0.42537084]
Stock Position:  0.0009371022319676622
Bond Position:  [-2.5898681]


portfolio before change:  [-2.50115443]
curr_Stock_Price:  95.0135628112672
curr_Factors:  [9.50135628e+01 3.94640588e-02]
mat_Sqrt:  [[ 1.88749790e+01  0.00000000e+00]
 [-7.94622514e-03  1.82070891e-02]]
grads:  [ 7.71578999e-03 -9.16755640e+00]
Stock Position:  0.007715789988502791
Bond Position:  [-3.23425913]


portfolio before change:  [-2.50669832]
curr_Stock_Price:  94.34745135814883
curr_Factors:  [9.43474514e+01 4.17414562e-02]
mat_Sqrt:  [[ 1.92758692e+01  0.00000000e+00]
 [-8.17229038e-03  1.87250696e-02]]
grads:  [0.00620338 4.60634883]
Stock Position:  0.0062033801295755375
Bond Position:  [-3.09197142]


portfolio before change:  [-2.51420288]
curr_Stock_Price:  93.2000060989054
curr_Factors:  [9.32000061e+01 4.17353311e-02]
mat_Sqrt:  [[ 1.90400407e+01  0.00000000e+00]
 [-8.17169075e-03  1.87236957e-02]]
grads:  [3.55758705e-03 1.61163944e+01]
Stock Position:  0.0035575870478902136
Bond Position:  [-2.84577001]


portfolio before change:  [-2.51836411]
curr_Stock_Price:  92.13032282782737
curr_Factors:  [9.21303228e+01 4.19540373e-02]
mat_Sqrt:  [[ 1.88707635e+01  0.00000000e+00]
 [-8.19307388e-03  1.87726906e-02]]
grads:  [-0.02294507 -7.45259144]
Stock Position:  -0.022945072542045756
Bond Position:  [-0.40442717]


portfolio before change:  [-2.50648317]
curr_Stock_Price:  91.61032017709391
curr_Factors:  [9.16103202e+01 4.28955910e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.50648317]
Stock Price:  91.79881498822189
PL:  [-2.50648317]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.41803757e+00  3.57769151e-01]
 [ 1.23509331e+00  5.56634567e-02]
 [ 1.00088548e-01 -3.76296489e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.41094290e-01  1.06583409e+00]
 [ 4.87342015e-02  2.20607099e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.16159964e+00  1.18903590e+00]
 [ 1.07155039e-01  6.18520310e-01]
 [ 3.82271431e-02 -1.68927173e-01]
 [-3.00555148e-02  1.70447638e-02]
 [ 6.73101457e-02 -1.01390817e-01]
 [-1.13642177e-01 -3.66925886e-03]
 [-1.28886657e-01  2.82442755e-01]
 [ 1.63103794e-01  1.68218362e-01]
 [ 1.31568268e-01 -1.04583860e-01]
 [ 3.77742959e-02 -2.85845314e-02]
 [ 3.40598592e-01  6.45762593e-02]
 [ 4.29086652e-01  4.42201436e-01]
 [-7.96823175e-01  3.87132509e-01]
 [-5.74313458e-02  2.19533801e-01]
 [ 1.83109557e+00  2.84770987e-01]
 [ 1.47520203e-02  4.20778793e-01]
 [-1.52963436e-01  1.89973201e-01]
 [-1.75939529e-01  9.20460248e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 2.42449990e-01 -4.36565971e-01]
 [ 1.31823968e-01 -7.83768082e-02]
 [ 7.41417653e-01 -3.19734711e-01]
 [-5.88393952e-01 -3.10358714e-01]
 [ 3.39696200e-01  1.28611263e-01]
 [-2.03185990e-01  3.01875025e-01]
 [ 7.74341330e-01  1.83522644e-01]
 [ 6.35224678e-02 -1.23836424e-01]
 [ 3.25280961e-01 -4.09019750e-01]
 [ 1.19906230e-01  3.83436691e-02]
 [-6.73238316e-02  3.54769146e-01]
 [-3.59710975e-01 -1.37006612e-01]
 [ 1.40604192e-01 -1.05828332e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.01939883]
curr_Stock_Price:  98.15639534779031
curr_Factors:  [9.81563953e+01 4.16476827e-02]
mat_Sqrt:  [[ 2.00315254e+01  0.00000000e+00]
 [-8.16310556e-03  1.87040246e-02]]
grads:  [ 0.07858517 19.12792352]
Stock Position:  0.07858517011688396
Bond Position:  [-17.73303585]


portfolio before change:  [-10.04319535]
curr_Stock_Price:  97.88179189046177
curr_Factors:  [9.78817919e+01 4.09383023e-02]
mat_Sqrt:  [[ 1.98046342e+01  0.00000000e+00]
 [-8.09328634e-03  1.85440486e-02]]
grads:  [0.06359051 3.00168846]
Stock Position:  0.06359051237718237
Bond Position:  [-16.26754865]


portfolio before change:  [-9.98434085]
curr_Stock_Price:  98.83929433351213
curr_Factors:  [9.88392943e+01 4.04008409e-02]
mat_Sqrt:  [[ 1.98666591e+01  0.00000000e+00]
 [-8.03998417e-03  1.84219180e-02]]
grads:  [ 0.00421136 -2.04265641]
Stock Position:  0.004211358481446367
Bond Position:  [-10.40058855]


portfolio before change:  [-9.99207786]
curr_Stock_Price:  97.3108449558893
curr_Factors:  [9.7310845e+01 4.2537613e-02]
mat_Sqrt:  [[ 2.00700198e+01  0.00000000e+00]
 [-8.24985944e-03  1.89028027e-02]]
grads:  [-8.12224757e-04 -8.00869665e+00]
Stock Position:  -0.0008122247565406942
Bond Position:  [-9.91303958]


portfolio before change:  [-9.99271485]
curr_Stock_Price:  96.56941470258936
curr_Factors:  [9.65694147e+01 4.50226231e-02]
mat_Sqrt:  [[ 2.04906151e+01  0.00000000e+00]
 [-8.48741403e-03  1.94471086e-02]]
grads:  [1.58157205e-02 5.48068151e+01]
Stock Position:  0.015815720468826306
Bond Position:  [-11.52002972]


portfolio before change:  [-10.00613122]
curr_Stock_Price:  95.81217627536822
curr_Factors:  [9.58121763e+01 4.52274084e-02]
mat_Sqrt:  [[ 2.03761231e+01  0.00000000e+00]
 [-8.50669462e-03  1.94912860e-02]]
grads:  [0.00286425 1.13182424]
Stock Position:  0.0028642487228293717
Bond Position:  [-10.28056112]


portfolio before change:  [-10.00821478]
curr_Stock_Price:  95.5334251433963
curr_Factors:  [9.55334251e+01 4.50128419e-02]
mat_Sqrt:  [[ 2.02685913e+01  0.00000000e+00]
 [-8.48649204e-03  1.94449961e-02]]
grads:  [0.00638297 4.94404251]
Stock Position:  0.006382968376291487
Bond Position:  [-10.61800161]


portfolio before change:  [-10.009073]
curr_Stock_Price:  95.60692051476683
curr_Factors:  [9.56069205e+01 4.62606163e-02]
mat_Sqrt:  [[ 2.05634054e+01  0.00000000e+00]
 [-8.60331251e-03  1.97126654e-02]]
grads:  [ 0.08172467 60.31837261]
Stock Position:  0.08172466683283491
Bond Position:  [-17.82251672]


portfolio before change:  [-10.07567178]
curr_Stock_Price:  94.81926565418713
curr_Factors:  [9.48192657e+01 4.74771305e-02]
mat_Sqrt:  [[ 2.06604044e+01  0.00000000e+00]
 [-8.71569899e-03  1.99701752e-02]]
grads:  [1.82522774e-02 3.09722025e+01]
Stock Position:  0.018252277411968602
Bond Position:  [-11.80633932]


portfolio before change:  [-10.08007551]
curr_Stock_Price:  94.65885600573473
curr_Factors:  [9.46588560e+01 4.78371185e-02]
mat_Sqrt:  [[ 2.07034994e+01  0.00000000e+00]
 [-8.74867930e-03  2.00457426e-02]]
grads:  [-1.71462413e-03 -8.42708484e+00]
Stock Position:  -0.0017146241296314962
Bond Position:  [-9.91777115]


portfolio before change:  [-10.08498825]
curr_Stock_Price:  96.8009831648769
curr_Factors:  [9.68009832e+01 4.85764863e-02]
mat_Sqrt:  [[ 2.13350083e+01  0.00000000e+00]
 [-8.81602961e-03  2.02000615e-02]]
grads:  [-0.00106007  0.84379762]
Stock Position:  -0.0010600684876107972
Bond Position:  [-9.98237258]


portfolio before change:  [-10.08547995]
curr_Stock_Price:  96.0876539313718
curr_Factors:  [9.60876539e+01 4.95800751e-02]
mat_Sqrt:  [[ 2.13954379e+01  0.00000000e+00]
 [-8.90663349e-03  2.04076611e-02]]
grads:  [ 1.07777954e-03 -4.96827229e+00]
Stock Position:  0.001077779544319257
Bond Position:  [-10.18904125]


portfolio before change:  [-10.08696494]
curr_Stock_Price:  95.89162161582028
curr_Factors:  [9.58916216e+01 4.88683384e-02]
mat_Sqrt:  [[ 2.11979786e+01  0.00000000e+00]
 [-8.84247372e-03  2.02606526e-02]]
grads:  [-0.00543654 -0.1811027 ]
Stock Position:  -0.005436535955629003
Bond Position:  [-9.56564669]


portfolio before change:  [-10.08916472]
curr_Stock_Price:  96.07629877371818
curr_Factors:  [9.60762988e+01 4.78556458e-02]
mat_Sqrt:  [[ 2.10175870e+01  0.00000000e+00]
 [-8.75037332e-03  2.00496241e-02]]
grads:  [-2.67325287e-04  1.40871846e+01]
Stock Position:  -0.0002673252871715912
Bond Position:  [-10.0634811]


portfolio before change:  [-10.08989303]
curr_Stock_Price:  94.09480213040737
curr_Factors:  [9.40948021e+01 4.94986884e-02]
mat_Sqrt:  [[ 2.09344945e+01  0.00000000e+00]
 [-8.89932028e-03  2.03909044e-02]]
grads:  [0.01129811 8.24967638]
Stock Position:  0.011298114051951347
Bond Position:  [-11.15298684]


portfolio before change:  [-10.09266198]
curr_Stock_Price:  93.97312365406566
curr_Factors:  [9.39731237e+01 4.96900421e-02]
mat_Sqrt:  [[ 2.09477965e+01  0.00000000e+00]
 [-8.91650533e-03  2.04302803e-02]]
grads:  [ 4.10182187e-03 -5.11906144e+00]
Stock Position:  0.004101821871303652
Bond Position:  [-10.47812299]


portfolio before change:  [-10.09626445]
curr_Stock_Price:  93.41419489186067
curr_Factors:  [9.34141949e+01 5.09136103e-02]
mat_Sqrt:  [[ 2.10780205e+01  0.00000000e+00]
 [-9.02561779e-03  2.06802883e-02]]
grads:  [ 1.20025425e-03 -1.38221145e+00]
Stock Position:  0.0012002542477073197
Bond Position:  [-10.20838524]


portfolio before change:  [-10.09791216]
curr_Stock_Price:  93.10460868423552
curr_Factors:  [9.31046087e+01 5.01051203e-02]
mat_Sqrt:  [[ 2.08406967e+01  0.00000000e+00]
 [-8.95366922e-03  2.05154335e-02]]
grads:  [0.01769528 3.14769168]
Stock Position:  0.017695280864340527
Bond Position:  [-11.74542436]


portfolio before change:  [-10.11913892]
curr_Stock_Price:  91.98801213006575
curr_Factors:  [9.19880121e+01 5.18780589e-02]
mat_Sqrt:  [[ 2.09518846e+01  0.00000000e+00]
 [-9.11070218e-03  2.08752412e-02]]
grads:  [ 0.02969085 21.18305757]
Stock Position:  0.029690846141260628
Bond Position:  [-12.85034084]


portfolio before change:  [-10.11276746]
curr_Stock_Price:  92.25670957030502
curr_Factors:  [9.22567096e+01 5.10561752e-02]
mat_Sqrt:  [[ 2.08459696e+01  0.00000000e+00]
 [-9.03824543e-03  2.07092219e-02]]
grads:  [-0.03011924 18.69372546]
Stock Position:  -0.030119236920072366
Bond Position:  [-7.33406577]


portfolio before change:  [-10.13593105]
curr_Stock_Price:  92.9953329101487
curr_Factors:  [9.29953329e+01 5.14923017e-02]
mat_Sqrt:  [[ 2.11024221e+01  0.00000000e+00]
 [-9.07676610e-03  2.07974839e-02]]
grads:  [1.81879879e-03 1.05557866e+01]
Stock Position:  0.001818798788933744
Bond Position:  [-10.30507085]


portfolio before change:  [-10.13896906]
curr_Stock_Price:  92.03327032243703
curr_Factors:  [9.20332703e+01 5.21897619e-02]
mat_Sqrt:  [[ 2.10250730e+01  0.00000000e+00]
 [-9.13803147e-03  2.09378604e-02]]
grads:  [ 0.09300228 13.60076822]
Stock Position:  0.09300228432867161
Bond Position:  [-18.69827343]


portfolio before change:  [-10.03590856]
curr_Stock_Price:  93.16655360469834
curr_Factors:  [9.31665536e+01 5.19784683e-02]
mat_Sqrt:  [[ 2.12408440e+01  0.00000000e+00]
 [-9.11951475e-03  2.08954333e-02]]
grads:  [9.34025697e-03 2.01373566e+01]
Stock Position:  0.009340256967639642
Bond Position:  [-10.90610811]


portfolio before change:  [-10.03543913]
curr_Stock_Price:  93.36277721647487
curr_Factors:  [9.33627772e+01 5.20301843e-02]
mat_Sqrt:  [[ 2.12961670e+01  0.00000000e+00]
 [-9.12405035e-03  2.09058257e-02]]
grads:  [-3.28943393e-03  9.08709388e+00]
Stock Position:  -0.0032894339322703616
Bond Position:  [-9.72832844]


portfolio before change:  [-10.03601985]
curr_Stock_Price:  93.16961509293077
curr_Factors:  [9.31696151e+01 5.08185813e-02]
mat_Sqrt:  [[ 2.10032049e+01  0.00000000e+00]
 [-9.01719080e-03  2.06609797e-02]]
grads:  [-0.00646413  4.45506583]
Stock Position:  -0.006464125395112722
Bond Position:  [-9.43375977]


portfolio before change:  [-10.03052421]
curr_Stock_Price:  92.1370035892879
curr_Factors:  [9.21370036e+01 5.31673511e-02]
mat_Sqrt:  [[ 2.12449932e+01  0.00000000e+00]
 [-9.22321863e-03  2.11330488e-02]]
grads:  [ 0.00863632 -3.45409401]
Stock Position:  0.008636322029437201
Bond Position:  [-10.82624905]


portfolio before change:  [-10.02677674]
curr_Stock_Price:  92.72762933528132
curr_Factors:  [9.27276293e+01 5.28177829e-02]
mat_Sqrt:  [[ 2.13107748e+01  0.00000000e+00]
 [-9.19284790e-03  2.10634607e-02]]
grads:  [ 2.43618450e-03 -2.07262224e+01]
Stock Position:  0.0024361844959013244
Bond Position:  [-10.25267836]


portfolio before change:  [-10.03198382]
curr_Stock_Price:  91.116335520845
curr_Factors:  [9.11163355e+01 5.43184239e-02]
mat_Sqrt:  [[ 2.12358586e+01  0.00000000e+00]
 [-9.32252531e-03  2.13605890e-02]]
grads:  [ 0.00459682 -3.66922505]
Stock Position:  0.004596824920417497
Bond Position:  [-10.45082966]


portfolio before change:  [-10.03311825]
curr_Stock_Price:  91.15375324491885
curr_Factors:  [9.11537532e+01 5.59034561e-02]
mat_Sqrt:  [[ 2.15523129e+01  0.00000000e+00]
 [-9.45756468e-03  2.16700030e-02]]
grads:  [  0.02792619 -14.75471462]
Stock Position:  0.027926189945309706
Bond Position:  [-12.57869528]


portfolio before change:  [-9.98566176]
curr_Stock_Price:  92.90941431847261
curr_Factors:  [9.29094143e+01 5.43434496e-02]
mat_Sqrt:  [[ 2.16587468e+01  0.00000000e+00]
 [-9.32467261e-03  2.13655090e-02]]
grads:  [ -0.03342047 -14.52615583]
Stock Position:  -0.03342047474444045
Bond Position:  [-6.88058503]


portfolio before change:  [-9.97012159]
curr_Stock_Price:  92.41868815072199
curr_Factors:  [9.24186882e+01 5.57380834e-02]
mat_Sqrt:  [[ 2.18190489e+01  0.00000000e+00]
 [-9.44356572e-03  2.16379274e-02]]
grads:  [0.01814134 5.94378845]
Stock Position:  0.01814133875228702
Bond Position:  [-11.64672031]


portfolio before change:  [-9.98953436]
curr_Stock_Price:  91.42885807337517
curr_Factors:  [9.14288581e+01 5.61556751e-02]
mat_Sqrt:  [[ 2.16660690e+01  0.00000000e+00]
 [-9.47887547e-03  2.17188322e-02]]
grads:  [-3.29717994e-03  1.38992291e+01]
Stock Position:  -0.0032971799381590885
Bond Position:  [-9.68807696]


portfolio before change:  [-9.98738786]
curr_Stock_Price:  90.41053806190351
curr_Factors:  [9.04105381e+01 5.70228194e-02]
mat_Sqrt:  [[ 2.15895404e+01  0.00000000e+00]
 [-9.55178052e-03  2.18858786e-02]]
grads:  [0.03957644 8.38543643]
Stock Position:  0.03957644130545847
Bond Position:  [-13.56551521]


portfolio before change:  [-9.9723459]
curr_Stock_Price:  90.83346038575891
curr_Factors:  [9.08334604e+01 5.62842068e-02]
mat_Sqrt:  [[ 2.15495961e+01  0.00000000e+00]
 [-9.48971711e-03  2.17436735e-02]]
grads:  [ 4.39721534e-04 -5.69528530e+00]
Stock Position:  0.0004397215341065906
Bond Position:  [-10.01228732]


portfolio before change:  [-9.97362481]
curr_Stock_Price:  90.77137100868678
curr_Factors:  [9.07713710e+01 5.59453801e-02]
mat_Sqrt:  [[ 2.14699488e+01  0.00000000e+00]
 [-9.46111031e-03  2.16781271e-02]]
grads:  [ 6.83607158e-03 -1.88678546e+01]
Stock Position:  0.006836071578677862
Bond Position:  [-10.5941444]


portfolio before change:  [-9.96917454]
curr_Stock_Price:  91.6160984858754
curr_Factors:  [9.16160985e+01 5.54779464e-02]
mat_Sqrt:  [[ 2.15790331e+01  0.00000000e+00]
 [-9.42150276e-03  2.15873748e-02]]
grads:  [0.00633211 1.77620806]
Stock Position:  0.006332108487660424
Bond Position:  [-10.54929762]


portfolio before change:  [-9.96418817]
curr_Stock_Price:  92.61183679865293
curr_Factors:  [9.26118368e+01 5.35136443e-02]
mat_Sqrt:  [[ 2.14239113e+01  0.00000000e+00]
 [-9.25320652e-03  2.12017596e-02]]
grads:  [4.08469379e-03 1.67330048e+01]
Stock Position:  0.004084693788374248
Bond Position:  [-10.34247916]


portfolio before change:  [-9.96162186]
curr_Stock_Price:  93.55663229435017
curr_Factors:  [9.35566323e+01 5.37458997e-02]
mat_Sqrt:  [[ 2.16893856e+01  0.00000000e+00]
 [-9.27326477e-03  2.12477189e-02]]
grads:  [-0.01934151 -6.44806218]
Stock Position:  -0.019341514373352197
Bond Position:  [-8.15209491]


portfolio before change:  [-9.99225419]
curr_Stock_Price:  95.08770477170515
curr_Factors:  [9.50877048e+01 5.12212080e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.99225419]
Stock Price:  94.3126329360923
PL:  [-9.99225419]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.28043214e+00  3.18381267e-01]
 [ 9.58750797e-01  8.15486785e-02]
 [ 1.10712538e-01 -4.73192813e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.84207427e-02  4.21929153e-01]
 [ 3.05292004e-02 -1.91566033e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 9.53896241e-01  9.59994756e-01]
 [-9.64839007e-03  3.06546412e-01]
 [ 1.81153734e-01  4.41638438e-02]
 [-6.68128123e-02 -1.37395691e-02]
 [-8.96419845e-03 -1.36288975e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.44366137e-02 -4.41490920e-02]
 [ 3.85190924e-01  2.40090665e-01]
 [ 1.33355213e-01 -3.25543754e-01]
 [ 3.87643140e-02  2.52476532e-02]
 [-3.76642760e-03  2.05822161e-02]
 [-4.01618548e-03  9.45321943e-03]
 [-4.03528614e-01  1.58791237e-01]
 [ 1.09199235e-01  6.54776884e-02]
 [ 1.68619098e+00  2.08398206e-01]
 [ 1.57104177e-02  4.55652288e-01]
 [-1.48976614e-01  1.74288038e-01]
 [-1.80598006e-01  9.90907677e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 4.87260690e-01 -4.17024606e-01]
 [ 1.34182975e-01 -8.33985152e-02]
 [ 7.62337540e-01 -3.21664379e-01]
 [-6.96353193e-01 -3.36212255e-01]
 [ 6.75588777e-01  2.52401209e-01]
 [-2.72408772e-01  4.20301136e-01]
 [ 8.16314501e-01  1.69220590e-01]
 [ 7.43305161e-02 -1.90749495e-01]
 [ 3.27994571e-01 -4.80113810e-01]
 [ 1.54990009e-01 -5.91907989e-03]
 [-9.09237789e-02  7.33594108e-01]
 [-4.07966611e-01 -1.48452433e-01]
 [-2.52026346e-01  6.83912540e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.06044293]
curr_Stock_Price:  100.20015428672507
curr_Factors:  [1.00200154e+02 3.91806792e-02]
mat_Sqrt:  [[ 1.98337288e+01  0.00000000e+00]
 [-7.91764402e-03  1.81416015e-02]]
grads:  [ 0.07156421 17.54978837]
Stock Position:  0.0715642091271858
Bond Position:  [-3.11030187]


portfolio before change:  [3.95538427]
curr_Stock_Price:  98.73755383411309
curr_Factors:  [9.87375538e+01 4.01490901e-02]
mat_Sqrt:  [[ 1.97842785e+01  0.00000000e+00]
 [-8.01489514e-03  1.83644318e-02]]
grads:  [0.05025918 4.44057727]
Stock Position:  0.05025917713992778
Bond Position:  [-1.00708394]


portfolio before change:  [3.98505827]
curr_Stock_Price:  99.3304782524993
curr_Factors:  [9.93304783e+01 4.12820182e-02]
mat_Sqrt:  [[ 2.01819436e+01  0.00000000e+00]
 [-8.12719073e-03  1.86217334e-02]]
grads:  [ 0.00446244 -2.54107823]
Stock Position:  0.004462439917797586
Bond Position:  [3.54180198]


portfolio before change:  [3.98103789]
curr_Stock_Price:  98.33032267075879
curr_Factors:  [9.83303227e+01 4.07020244e-02]
mat_Sqrt:  [[ 1.98378896e+01  0.00000000e+00]
 [-8.06989709e-03  1.84904571e-02]]
grads:  [-8.21728887e-04 -8.18729420e+00]
Stock Position:  -0.0008217288865732348
Bond Position:  [4.06183875]


portfolio before change:  [3.98150246]
curr_Stock_Price:  98.3828868326951
curr_Factors:  [9.83828868e+01 4.06160435e-02]
mat_Sqrt:  [[ 1.98275188e+01  0.00000000e+00]
 [-8.06136897e-03  1.84709168e-02]]
grads:  [4.82784748e-03 2.28428918e+01]
Stock Position:  0.004827847475522971
Bond Position:  [3.50652488]


portfolio before change:  [3.97320224]
curr_Stock_Price:  96.57285432150059
curr_Factors:  [9.65728543e+01 4.09350153e-02]
mat_Sqrt:  [[ 1.95390096e+01  0.00000000e+00]
 [-8.09296142e-03  1.85433042e-02]]
grads:  [ 0.00113458 -1.03307389]
Stock Position:  0.0011345801943959057
Bond Position:  [3.86363259]


portfolio before change:  [3.97364252]
curr_Stock_Price:  96.53521803166065
curr_Factors:  [9.65352180e+01 4.19572119e-02]
mat_Sqrt:  [[ 1.97737524e+01  0.00000000e+00]
 [-8.19338386e-03  1.87734009e-02]]
grads:  [0.0065427  5.12090952]
Stock Position:  0.006542702388536448
Bond Position:  [3.34204132]


portfolio before change:  [3.97762136]
curr_Stock_Price:  97.07949664762913
curr_Factors:  [9.70794966e+01 4.23226689e-02]
mat_Sqrt:  [[ 1.99716543e+01  0.00000000e+00]
 [-8.22898962e-03  1.88549839e-02]]
grads:  [ 0.06874104 50.91464199]
Stock Position:  0.06874104086862606
Bond Position:  [-2.69572429]


portfolio before change:  [4.05425024]
curr_Stock_Price:  98.19914614833063
curr_Factors:  [9.81991461e+01 4.16772253e-02]
mat_Sqrt:  [[ 2.00473564e+01  0.00000000e+00]
 [-8.16600027e-03  1.87106572e-02]]
grads:  [6.19230937e-03 1.63835193e+01]
Stock Position:  0.00619230937044474
Bond Position:  [3.44617075]


portfolio before change:  [4.0650097]
curr_Stock_Price:  99.86712804012772
curr_Factors:  [9.98671280e+01 4.27885496e-02]
mat_Sqrt:  [[ 2.06579082e+01  0.00000000e+00]
 [-8.27415732e-03  1.89584761e-02]]
grads:  [0.00970226 2.32950389]
Stock Position:  0.009702260897165218
Bond Position:  [3.09607277]


portfolio before change:  [4.08109668]
curr_Stock_Price:  101.48530254746021
curr_Factors:  [1.01485303e+02 4.30530830e-02]
mat_Sqrt:  [[ 2.10574258e+01  0.00000000e+00]
 [-8.29969474e-03  1.90169897e-02]]
grads:  [-0.00345765 -0.72248917]
Stock Position:  -0.0034576520683228056
Bond Position:  [4.43199755]


portfolio before change:  [4.08181988]
curr_Stock_Price:  101.43637987172868
curr_Factors:  [1.01436380e+02 4.34924965e-02]
mat_Sqrt:  [[ 2.11544096e+01  0.00000000e+00]
 [-8.34194188e-03  1.91137901e-02]]
grads:  [-3.23552323e-03 -7.13040034e+00]
Stock Position:  -0.003235523225500114
Bond Position:  [4.41001964]


portfolio before change:  [4.07825497]
curr_Stock_Price:  102.70856875857007
curr_Factors:  [1.02708569e+02 4.26637287e-02]
mat_Sqrt:  [[ 2.12146603e+01  0.00000000e+00]
 [-8.26208000e-03  1.89308035e-02]]
grads:  [-0.00308794 -0.94502079]
Stock Position:  -0.0030879363694073943
Bond Position:  [4.39541249]


portfolio before change:  [4.08208252]
curr_Stock_Price:  101.64698962126882
curr_Factors:  [1.01646990e+02 4.39447863e-02]
mat_Sqrt:  [[ 2.13082704e+01  0.00000000e+00]
 [-8.38520472e-03  1.92129177e-02]]
grads:  [-0.00252038 -2.29788587]
Stock Position:  -0.002520376175780196
Bond Position:  [4.33827117]


portfolio before change:  [4.08452369]
curr_Stock_Price:  100.89358918717484
curr_Factors:  [1.00893589e+02 4.43297998e-02]
mat_Sqrt:  [[ 2.12427852e+01  0.00000000e+00]
 [-8.42185726e-03  1.92968992e-02]]
grads:  [ 0.02306548 12.44192981]
Stock Position:  0.02306548208664582
Bond Position:  [1.75736441]


portfolio before change:  [4.08001555]
curr_Stock_Price:  100.68861543027083
curr_Factors:  [1.00688615e+02 4.40897127e-02]
mat_Sqrt:  [[ 2.11421429e+01  0.00000000e+00]
 [-8.39902020e-03  1.92445729e-02]]
grads:  [-4.12622765e-04 -1.69161329e+01]
Stock Position:  -0.0004126227652322791
Bond Position:  [4.12156197]


portfolio before change:  [4.08058298]
curr_Stock_Price:  100.5621096100434
curr_Factors:  [1.00562110e+02 4.49347827e-02]
mat_Sqrt:  [[ 2.13169810e+01  0.00000000e+00]
 [-8.47913040e-03  1.94281284e-02]]
grads:  [0.00233538 1.29954119]
Stock Position:  0.002335381975552954
Bond Position:  [3.84573204]


portfolio before change:  [4.07684196]
curr_Stock_Price:  98.75436710361166
curr_Factors:  [9.87543671e+01 4.38902951e-02]
mat_Sqrt:  [[ 2.06890505e+01  0.00000000e+00]
 [-8.38000431e-03  1.92010020e-02]]
grads:  [2.52132785e-04 1.07193448e+00]
Stock Position:  0.0002521327846903193
Bond Position:  [4.05194274]


portfolio before change:  [4.07680214]
curr_Stock_Price:  96.58749406796431
curr_Factors:  [9.65874941e+01 4.57490158e-02]
mat_Sqrt:  [[ 2.06591180e+01  0.00000000e+00]
 [-8.55560783e-03  1.96033602e-02]]
grads:  [5.30214904e-06 4.82224441e-01]
Stock Position:  5.3021490446813695e-06
Bond Position:  [4.07629002]


portfolio before change:  [4.07731016]
curr_Stock_Price:  96.29537296745525
curr_Factors:  [9.6295373e+01 4.5142590e-02]
mat_Sqrt:  [[ 2.04596715e+01  0.00000000e+00]
 [-8.49871425e-03  1.94730007e-02]]
grads:  [-0.01633587  8.15443085]
Stock Position:  -0.016335865256393568
Bond Position:  [5.6503784]


portfolio before change:  [4.08683418]
curr_Stock_Price:  95.75559844444754
curr_Factors:  [9.57555984e+01 4.53313532e-02]
mat_Sqrt:  [[ 2.03874785e+01  0.00000000e+00]
 [-8.51646436e-03  1.95136713e-02]]
grads:  [0.00675788 3.35547768]
Stock Position:  0.006757875489709168
Bond Position:  [3.43972977]


portfolio before change:  [4.07435977]
curr_Stock_Price:  93.84606257676923
curr_Factors:  [9.38460626e+01 4.67290502e-02]
mat_Sqrt:  [[ 2.02866125e+01  0.00000000e+00]
 [-8.64676126e-03  1.98122190e-02]]
grads:  [ 0.08760178 10.51867064]
Stock Position:  0.08760178237143264
Bond Position:  [-4.14672258]


portfolio before change:  [4.14634102]
curr_Stock_Price:  94.6736669247854
curr_Factors:  [9.46736669e+01 4.81373911e-02]
mat_Sqrt:  [[ 2.07716250e+01  0.00000000e+00]
 [-8.77609399e-03  2.01085575e-02]]
grads:  [1.03301200e-02 2.26596208e+01]
Stock Position:  0.010330120045087963
Bond Position:  [3.16835067]


portfolio before change:  [4.13995337]
curr_Stock_Price:  94.01697449511894
curr_Factors:  [9.40169745e+01 4.94498413e-02]
mat_Sqrt:  [[ 2.09068557e+01  0.00000000e+00]
 [-8.89492811e-03  2.03808407e-02]]
grads:  [-3.48742436e-03  8.55156275e+00]
Stock Position:  -0.0034874243592392215
Bond Position:  [4.46783046]


portfolio before change:  [4.14223303]
curr_Stock_Price:  93.52344523579653
curr_Factors:  [9.35234452e+01 4.96137420e-02]
mat_Sqrt:  [[ 2.08315454e+01  0.00000000e+00]
 [-8.90965696e-03  2.04145887e-02]]
grads:  [-0.00659343  4.85391937]
Stock Position:  -0.006593425842140886
Bond Position:  [4.75887293]


portfolio before change:  [4.15812549]
curr_Stock_Price:  91.20332154486941
curr_Factors:  [9.12033215e+01 4.88808898e-02]
mat_Sqrt:  [[ 2.01641633e+01  0.00000000e+00]
 [-8.84360920e-03  2.02632543e-02]]
grads:  [ 0.00909924 -3.60236002]
Stock Position:  0.009099242036415912
Bond Position:  [3.32824439]


portfolio before change:  [4.15296893]
curr_Stock_Price:  90.59089539471988
curr_Factors:  [9.05908954e+01 4.79901807e-02]
mat_Sqrt:  [[ 1.98454406e+01  0.00000000e+00]
 [-8.76266450e-03  2.00777867e-02]]
grads:  [ 1.53816807e-02 -2.07704471e+01]
Stock Position:  0.015381680700240109
Bond Position:  [2.75952871]


portfolio before change:  [4.15820302]
curr_Stock_Price:  90.90874874881978
curr_Factors:  [9.09087487e+01 4.73888311e-02]
mat_Sqrt:  [[ 1.97899036e+01  0.00000000e+00]
 [-8.70759035e-03  1.99515960e-02]]
grads:  [ 0.00494115 -4.18004231]
Stock Position:  0.004941149851727085
Bond Position:  [3.70900927]


portfolio before change:  [4.15863324]
curr_Stock_Price:  90.90198315361124
curr_Factors:  [9.09019832e+01 4.68094286e-02]
mat_Sqrt:  [[ 1.96670865e+01  0.00000000e+00]
 [-8.65419469e-03  1.98292511e-02]]
grads:  [  0.03162399 -16.22171092]
Stock Position:  0.03162398739887917
Bond Position:  [1.28395007]


portfolio before change:  [4.1741426]
curr_Stock_Price:  91.3873378256891
curr_Factors:  [9.13873378e+01 4.64580791e-02]
mat_Sqrt:  [[ 1.96977513e+01  0.00000000e+00]
 [-8.62165451e-03  1.97546922e-02]]
grads:  [ -0.04280124 -17.01936187]
Stock Position:  -0.042801243487442554
Bond Position:  [8.08563429]


portfolio before change:  [4.25781314]
curr_Stock_Price:  89.4560908060337
curr_Factors:  [8.94560908e+01 4.84668097e-02]
mat_Sqrt:  [[ 1.96939183e+01  0.00000000e+00]
 [-8.80607152e-03  2.01772447e-02]]
grads:  [ 0.03989789 12.509201  ]
Stock Position:  0.03989788535708484
Bond Position:  [0.68870428]


portfolio before change:  [4.24822997]
curr_Stock_Price:  89.21374054395923
curr_Factors:  [8.92137405e+01 4.81112175e-02]
mat_Sqrt:  [[ 1.95683822e+01  0.00000000e+00]
 [-8.77370777e-03  2.01030900e-02]]
grads:  [-4.54684073e-03  2.09072902e+01]
Stock Position:  -0.004546840733590514
Bond Position:  [4.65387064]


portfolio before change:  [4.24525986]
curr_Stock_Price:  89.99491616149935
curr_Factors:  [8.99949162e+01 4.72486976e-02]
mat_Sqrt:  [[ 1.95619839e+01  0.00000000e+00]
 [-8.69470621e-03  1.99220747e-02]]
grads:  [0.04550502 8.49412488]
Stock Position:  0.04550501753697945
Bond Position:  [0.15003962]


portfolio before change:  [4.1733133]
curr_Stock_Price:  88.41343529401863
curr_Factors:  [8.84134353e+01 4.78034629e-02]
mat_Sqrt:  [[ 1.93307162e+01  0.00000000e+00]
 [-8.74560122e-03  2.00386898e-02]]
grads:  [-4.61410142e-04 -9.51906021e+00]
Stock Position:  -0.0004614101419376732
Bond Position:  [4.21410815]


portfolio before change:  [4.17329127]
curr_Stock_Price:  89.60287748026046
curr_Factors:  [8.96028775e+01 4.77266811e-02]
mat_Sqrt:  [[ 1.95750362e+01  0.00000000e+00]
 [-8.73857482e-03  2.00225903e-02]]
grads:  [ 6.05136688e-03 -2.39786063e+01]
Stock Position:  0.00605136687805652
Bond Position:  [3.63107139]


portfolio before change:  [4.17046876]
curr_Stock_Price:  89.06144108962177
curr_Factors:  [8.90614411e+01 4.91044753e-02]
mat_Sqrt:  [[ 1.97355964e+01  0.00000000e+00]
 [-8.86381185e-03  2.03095444e-02]]
grads:  [ 0.00772243 -0.29144326]
Stock Position:  0.0077224274009398365
Bond Position:  [3.48269824]


portfolio before change:  [4.16535435]
curr_Stock_Price:  88.3427853270458
curr_Factors:  [8.83427853e+01 4.94882821e-02]
mat_Sqrt:  [[ 1.96527024e+01  0.00000000e+00]
 [-8.89838476e-03  2.03887609e-02]]
grads:  [1.16647031e-02 3.59803184e+01]
Stock Position:  0.011664703083423494
Bond Position:  [3.13486199]


portfolio before change:  [4.17070817]
curr_Stock_Price:  88.76816595825387
curr_Factors:  [8.87681660e+01 4.88506142e-02]
mat_Sqrt:  [[ 1.96196954e+01  0.00000000e+00]
 [-8.84087002e-03  2.02569780e-02]]
grads:  [-0.02409602 -7.328459  ]
Stock Position:  -0.024096019518542237
Bond Position:  [6.30966763]


portfolio before change:  [4.16083946]
curr_Stock_Price:  89.21045780602034
curr_Factors:  [8.92104578e+01 4.92194033e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.16083946]
Stock Price:  90.68113137240249
PL:  [4.16083946]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.50006267e+00  3.68035329e-01]
 [ 8.50339922e-01  9.17724925e-02]
 [ 1.11656462e-01 -4.62222560e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.58483420e-01  1.15370963e+00]
 [ 4.99141485e-02  1.99515106e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 9.73218731e-01  9.82238574e-01]
 [ 5.37479152e-02  4.76074886e-01]
 [ 1.15938652e-01 -3.09728082e-02]
 [-1.01077545e-02  1.97967239e-02]
 [ 6.26714684e-02 -9.72415730e-02]
 [-8.76394343e-02  9.48271560e-02]
 [-1.40639349e-01  4.90158648e-01]
 [ 1.49672843e-01  1.62237708e-01]
 [ 1.32243226e-01 -8.84504527e-02]
 [ 4.06408274e-02  1.04051415e-01]
 [ 9.54203832e-02  8.59733786e-02]
 [-1.07836014e-02  3.54235021e-03]
 [-1.98226736e-01  3.95346492e-02]
 [ 1.68060259e-01 -3.05973992e-02]
 [ 1.14116110e+00  1.06592698e-01]
 [ 1.92856877e-02  1.73713036e-01]
 [-1.31033423e-01  1.03695015e-01]
 [-1.84919379e-01  1.96934612e-01]
 [ 1.32070542e-01 -1.02482325e-01]
 [-5.00521513e-02 -4.54441795e-01]
 [ 6.44175011e-02  6.51138300e-02]
 [ 2.36031817e-01 -1.17799326e-02]
 [-5.42681584e-01 -1.25349558e-01]
 [-1.65968078e-01 -6.09767832e-02]
 [ 5.68346640e-03 -5.98581050e-02]
 [-1.67648869e-01  1.48742628e-01]
 [ 2.41194484e-02  2.56230669e-02]
 [-2.40322659e-02  4.48306387e-02]
 [-2.14872885e-01  8.43667496e-02]
 [-3.35840124e-02 -1.23041480e-01]
 [-7.56011258e-02 -5.16544537e-02]
 [ 4.40926197e-02 -1.15885059e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.60683123]
curr_Stock_Price:  99.23236633838482
curr_Factors:  [9.92323663e+01 3.91892557e-02]
mat_Sqrt:  [[ 1.96443135e+01  0.00000000e+00]
 [-7.91851053e-03  1.81435870e-02]]
grads:  [ 0.08453777 20.28459585]
Stock Position:  0.08453776995664648
Bond Position:  [-10.99571419]


portfolio before change:  [-2.6215803]
curr_Stock_Price:  99.07415880462881
curr_Factors:  [9.90741588e+01 3.95995915e-02]
mat_Sqrt:  [[ 1.97154070e+01  0.00000000e+00]
 [-7.95985844e-03  1.82383269e-02]]
grads:  [0.04516228 5.0318482 ]
Stock Position:  0.0451622795810307
Bond Position:  [-7.09599515]


portfolio before change:  [-2.605355]
curr_Stock_Price:  99.45306677283067
curr_Factors:  [9.94530668e+01 3.94026027e-02]
mat_Sqrt:  [[ 1.97415221e+01  0.00000000e+00]
 [-7.94003554e-03  1.81929069e-02]]
grads:  [ 0.00463406 -2.54067457]
Stock Position:  0.004634060905362289
Bond Position:  [-3.06622657]


portfolio before change:  [-2.60978607]
curr_Stock_Price:  98.57958597164654
curr_Factors:  [9.85795860e+01 3.95859947e-02]
mat_Sqrt:  [[ 1.96136206e+01  0.00000000e+00]
 [-7.95849179e-03  1.82351955e-02]]
grads:  [-8.31124822e-04 -8.30190234e+00]
Stock Position:  -0.0008311248218482113
Bond Position:  [-2.52785413]


portfolio before change:  [-2.60797067]
curr_Stock_Price:  96.01510619814628
curr_Factors:  [9.60151062e+01 3.83933098e-02]
mat_Sqrt:  [[ 1.88134023e+01  0.00000000e+00]
 [-7.83768433e-03  1.79583909e-02]]
grads:  [1.83399438e-02 6.42434859e+01]
Stock Position:  0.018339943838076883
Bond Position:  [-4.36888232]


portfolio before change:  [-2.61131183]
curr_Stock_Price:  95.86270568013897
curr_Factors:  [9.58627057e+01 3.72878097e-02]
mat_Sqrt:  [[ 1.85111380e+01  0.00000000e+00]
 [-7.72402068e-03  1.76979547e-02]]
grads:  [0.00316683 1.12733425]
Stock Position:  0.003166834018450395
Bond Position:  [-2.91489311]


portfolio before change:  [-2.61039413]
curr_Stock_Price:  96.2675516756536
curr_Factors:  [9.62675517e+01 3.79754628e-02]
mat_Sqrt:  [[ 1.87599408e+01  0.00000000e+00]
 [-7.79491761e-03  1.78604000e-02]]
grads:  [0.00689628 5.38268388]
Stock Position:  0.006896278527714692
Bond Position:  [-3.27428198]


portfolio before change:  [-2.60619498]
curr_Stock_Price:  96.93580511499432
curr_Factors:  [9.69358051e+01 3.69447038e-02]
mat_Sqrt:  [[ 1.86320361e+01  0.00000000e+00]
 [-7.68840205e-03  1.76163422e-02]]
grads:  [ 0.07524152 55.75723745]
Stock Position:  0.07524152403966577
Bond Position:  [-9.89979269]


portfolio before change:  [-2.64961164]
curr_Stock_Price:  96.37522233306277
curr_Factors:  [9.63752223e+01 3.67941627e-02]
mat_Sqrt:  [[ 1.84865068e+01  0.00000000e+00]
 [-7.67272183e-03  1.75804143e-02]]
grads:  [1.41467521e-02 2.70798445e+01]
Stock Position:  0.01414675212060568
Bond Position:  [-4.01300802]


portfolio before change:  [-2.65995414]
curr_Stock_Price:  95.67959660162536
curr_Factors:  [9.56795966e+01 3.62038113e-02]
mat_Sqrt:  [[ 1.82052431e+01  0.00000000e+00]
 [-7.61091967e-03  1.74388077e-02]]
grads:  [ 0.00562591 -1.77608519]
Stock Position:  0.005625907325086071
Bond Position:  [-3.19823868]


portfolio before change:  [-2.6597851]
curr_Stock_Price:  95.78070770332958
curr_Factors:  [9.57807077e+01 3.66983774e-02]
mat_Sqrt:  [[ 1.83485383e+01  0.00000000e+00]
 [-7.66272823e-03  1.75575161e-02]]
grads:  [-7.99930665e-05  1.12753557e+00]
Stock Position:  -7.999306651240644e-05
Bond Position:  [-2.65212331]


portfolio before change:  [-2.66009938]
curr_Stock_Price:  95.5649879976982
curr_Factors:  [9.55649880e+01 3.57223854e-02]
mat_Sqrt:  [[ 1.8062133e+01  0.0000000e+00]
 [-7.5601466e-03  1.7322472e-02]]
grads:  [ 1.12012057e-03 -5.61360832e+00]
Stock Position:  0.001120120565847288
Bond Position:  [-2.76714369]


portfolio before change:  [-2.66096521]
curr_Stock_Price:  95.10083071037371
curr_Factors:  [9.51008307e+01 3.66665414e-02]
mat_Sqrt:  [[ 1.82103916e+01  0.00000000e+00]
 [-7.65940378e-03  1.75498988e-02]]
grads:  [-2.53994925e-03  5.40328791e+00]
Stock Position:  -0.002539949253641967
Bond Position:  [-2.41941392]


portfolio before change:  [-2.65780129]
curr_Stock_Price:  93.7360922472928
curr_Factors:  [9.37360922e+01 3.78582513e-02]
mat_Sqrt:  [[ 1.82384161e+01  0.00000000e+00]
 [-7.78287878e-03  1.78328156e-02]]
grads:  [4.01808046e-03 2.74863297e+01]
Stock Position:  0.004018080462745202
Bond Position:  [-3.03444045]


portfolio before change:  [-2.65732731]
curr_Stock_Price:  93.94845917913592
curr_Factors:  [9.39484592e+01 3.86084573e-02]
mat_Sqrt:  [[ 1.84599655e+01  0.00000000e+00]
 [-7.85961396e-03  1.80086380e-02]]
grads:  [0.01194364 9.00888274]
Stock Position:  0.011943640058983358
Bond Position:  [-3.77941389]


portfolio before change:  [-2.64806653]
curr_Stock_Price:  94.76338946578218
curr_Factors:  [9.47633895e+01 3.77350906e-02]
mat_Sqrt:  [[ 1.84082831e+01  0.00000000e+00]
 [-7.77020881e-03  1.78037850e-02]]
grads:  [ 0.00508686 -4.96807014]
Stock Position:  0.005086855916323019
Bond Position:  [-3.13011424]


portfolio before change:  [-2.64235975]
curr_Stock_Price:  95.9621798371991
curr_Factors:  [9.59621798e+01 3.59117106e-02]
mat_Sqrt:  [[ 1.81852029e+01  0.00000000e+00]
 [-7.58015415e-03  1.73683151e-02]]
grads:  [4.73201143e-03 5.99087560e+00]
Stock Position:  0.004732011428301382
Bond Position:  [-3.09645388]


portfolio before change:  [-2.63764736]
curr_Stock_Price:  97.03983233790969
curr_Factors:  [9.70398323e+01 3.58897296e-02]
mat_Sqrt:  [[ 1.83837934e+01  0.00000000e+00]
 [-7.57783395e-03  1.73629988e-02]]
grads:  [0.00723149 4.95152821]
Stock Position:  0.007231491288133337
Bond Position:  [-3.33939006]


portfolio before change:  [-2.64064662]
curr_Stock_Price:  96.68280888347424
curr_Factors:  [9.66828089e+01 3.70580958e-02]
mat_Sqrt:  [[ 1.86119042e+01  0.00000000e+00]
 [-7.70019177e-03  1.76433558e-02]]
grads:  [-0.00049633  0.20077531]
Stock Position:  -0.000496327129033245
Bond Position:  [-2.59266032]


portfolio before change:  [-2.64178419]
curr_Stock_Price:  98.3217665806602
curr_Factors:  [9.83217666e+01 3.64571671e-02]
mat_Sqrt:  [[ 1.87733221e+01  0.00000000e+00]
 [-7.63750400e-03  1.74997201e-02]]
grads:  [-0.00963987  2.25915895]
Stock Position:  -0.009639870842812521
Bond Position:  [-1.69397506]


portfolio before change:  [-2.64325652]
curr_Stock_Price:  98.45253311283517
curr_Factors:  [9.84525331e+01 3.51007886e-02]
mat_Sqrt:  [[ 1.84452834e+01  0.00000000e+00]
 [-7.49408178e-03  1.71710985e-02]]
grads:  [ 0.00838732 -1.78191274]
Stock Position:  0.00838731808685974
Bond Position:  [-3.46900923]


portfolio before change:  [-2.64919417]
curr_Stock_Price:  97.79630509965186
curr_Factors:  [9.77963051e+01 3.44433264e-02]
mat_Sqrt:  [[ 1.81499315e+01  0.00000000e+00]
 [-7.42356534e-03  1.70095250e-02]]
grads:  [0.06543727 6.26664752]
Stock Position:  0.0654372701334424
Bond Position:  [-9.0487174]


portfolio before change:  [-2.64337389]
curr_Stock_Price:  97.9025355866442
curr_Factors:  [9.79025356e+01 3.56462696e-02]
mat_Sqrt:  [[ 1.84842138e+01  0.00000000e+00]
 [-7.55208788e-03  1.73040072e-02]]
grads:  [5.14494547e-03 1.00388907e+01]
Stock Position:  0.005144945474515592
Bond Position:  [-3.1470771]


portfolio before change:  [-2.64861496]
curr_Stock_Price:  96.9603178200837
curr_Factors:  [9.69603178e+01 3.63400501e-02]
mat_Sqrt:  [[ 1.84836098e+01  0.00000000e+00]
 [-7.62522656e-03  1.74715890e-02]]
grads:  [-4.64071734e-03  5.93506491e+00]
Stock Position:  -0.0046407173441072825
Bond Position:  [-2.19864953]


portfolio before change:  [-2.64874021]
curr_Stock_Price:  96.92808182903177
curr_Factors:  [9.69280818e+01 3.54242753e-02]
mat_Sqrt:  [[ 1.82431616e+01  0.00000000e+00]
 [-7.52853508e-03  1.72500409e-02]]
grads:  [-5.42505024e-03  1.14164722e+01]
Stock Position:  -0.005425050244654919
Bond Position:  [-2.1229005]


portfolio before change:  [-2.65163827]
curr_Stock_Price:  97.41336448795106
curr_Factors:  [9.74133645e+01 3.66215552e-02]
mat_Sqrt:  [[ 1.86417610e+01  0.00000000e+00]
 [-7.65470367e-03  1.75391295e-02]]
grads:  [ 4.68537222e-03 -5.84306792e+00]
Stock Position:  0.004685372215728146
Bond Position:  [-3.10805614]


portfolio before change:  [-2.66096658]
curr_Stock_Price:  95.50534729420828
curr_Factors:  [9.55053473e+01 3.73195084e-02]
mat_Sqrt:  [[ 1.84499692e+01  0.00000000e+00]
 [-7.72730312e-03  1.77054757e-02]]
grads:  [-1.34627222e-02 -2.56667373e+01]
Stock Position:  -0.013462722238280607
Bond Position:  [-1.37520461]


portfolio before change:  [-2.67913111]
curr_Stock_Price:  96.84182461973411
curr_Factors:  [9.68418246e+01 3.62809354e-02]
mat_Sqrt:  [[ 1.84459999e+01  0.00000000e+00]
 [-7.61902203e-03  1.74573726e-02]]
grads:  [0.00503283 3.72987571]
Stock Position:  0.005032825921524312
Bond Position:  [-3.16651915]


portfolio before change:  [-2.6749785]
curr_Stock_Price:  97.74558201623296
curr_Factors:  [9.77455820e+01 3.62930773e-02]
mat_Sqrt:  [[ 1.86212587e+01  0.00000000e+00]
 [-7.62029682e-03  1.74602935e-02]]
grads:  [ 0.0123993  -0.67466979]
Stock Position:  0.012399303207279916
Bond Position:  [-3.8869556]


portfolio before change:  [-2.66536163]
curr_Stock_Price:  98.5603672713741
curr_Factors:  [9.85603673e+01 3.64618952e-02]
mat_Sqrt:  [[ 1.88201002e+01  0.00000000e+00]
 [-7.63799924e-03  1.75008548e-02]]
grads:  [-0.03174205 -7.16248203]
Stock Position:  -0.03174205280675522
Bond Position:  [0.46314676]


portfolio before change:  [-2.69140817]
curr_Stock_Price:  99.38276035732835
curr_Factors:  [9.93827604e+01 3.67230281e-02]
mat_Sqrt:  [[ 1.90449702e+01  0.00000000e+00]
 [-7.66530137e-03  1.75634119e-02]]
grads:  [-0.01011188 -3.47180739]
Stock Position:  -0.010111883934149543
Bond Position:  [-1.68646124]


portfolio before change:  [-2.68620566]
curr_Stock_Price:  98.84741679305465
curr_Factors:  [9.88474168e+01 3.62186781e-02]
mat_Sqrt:  [[ 1.88118550e+01  0.00000000e+00]
 [-7.61248218e-03  1.74423879e-02]]
grads:  [-1.08658888e-03 -3.43176091e+00]
Stock Position:  -0.0010865888760805298
Bond Position:  [-2.57879916]


portfolio before change:  [-2.6876114]
curr_Stock_Price:  99.84445247884227
curr_Factors:  [9.98444525e+01 3.58780294e-02]
mat_Sqrt:  [[ 1.89120336e+01  0.00000000e+00]
 [-7.57659865e-03  1.73601684e-02]]
grads:  [-5.43211094e-03  8.56804060e+00]
Stock Position:  -0.005432110944164126
Bond Position:  [-2.14524526]


portfolio before change:  [-2.68698281]
curr_Stock_Price:  99.67936709074839
curr_Factors:  [9.96793671e+01 3.61560432e-02]
mat_Sqrt:  [[ 1.89537750e+01  0.00000000e+00]
 [-7.60589700e-03  1.74272994e-02]]
grads:  [0.00186255 1.47028328]
Stock Position:  0.0018625456738860493
Bond Position:  [-2.87264018]


portfolio before change:  [-2.68846206]
curr_Stock_Price:  99.07795820206705
curr_Factors:  [9.90779582e+01 3.53464302e-02]
mat_Sqrt:  [[ 1.86272965e+01  0.00000000e+00]
 [-7.52025853e-03  1.72310770e-02]]
grads:  [-2.39786330e-04  2.60173167e+00]
Stock Position:  -0.00023978632993121464
Bond Position:  [-2.66470452]


portfolio before change:  [-2.68918674]
curr_Stock_Price:  100.71092785422113
curr_Factors:  [1.00710928e+02 3.36371735e-02]
mat_Sqrt:  [[ 1.84708272e+01  0.00000000e+00]
 [-7.33617595e-03  1.68092908e-02]]
grads:  [-0.00963964  5.01905468]
Stock Position:  -0.009639644986009367
Bond Position:  [-1.71836915]


portfolio before change:  [-2.67294452]
curr_Stock_Price:  99.00370495309727
curr_Factors:  [9.9003705e+01 3.6564643e-02]
mat_Sqrt:  [[ 1.89313732e+01  0.00000000e+00]
 [-7.64875342e-03  1.75254958e-02]]
grads:  [-4.61053278e-03 -7.02071321e+00]
Stock Position:  -0.004610532777391463
Bond Position:  [-2.2164847]


portfolio before change:  [-2.67204531]
curr_Stock_Price:  98.74857263086199
curr_Factors:  [9.87485726e+01 3.59304671e-02]
mat_Sqrt:  [[ 1.87181213e+01  0.00000000e+00]
 [-7.58213343e-03  1.73728502e-02]]
grads:  [-0.00524331 -2.97328608]
Stock Position:  -0.0052433134625792955
Bond Position:  [-2.15427559]


portfolio before change:  [-2.67598058]
curr_Stock_Price:  99.44774452710537
curr_Factors:  [9.94477445e+01 3.71262895e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.67598058]
Stock Price:  99.4362330785823
PL:  [-2.67598058]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.41282594e+00  3.57149891e-01]
 [ 1.06286267e+00  7.13386013e-02]
 [ 4.58399840e-02  3.41172757e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.80276711e-01  1.28296324e+00]
 [ 6.02154007e-02  4.72717884e-02]
 [ 8.96549827e-02  9.27183991e-02]
 [ 1.38716077e+00  1.43767666e+00]
 [ 1.17381085e-01  6.45735643e-01]
 [-4.19503288e-02 -3.11259144e-01]
 [ 7.32219247e-02  1.56791523e-02]
 [ 5.85693783e-02 -9.30161157e-02]
 [-8.43768482e-02  1.07185584e-01]
 [-1.36667259e-01  4.23653736e-01]
 [ 3.57645606e-01  2.54224105e-01]
 [ 1.32580296e-01 -8.03935288e-02]
 [ 3.92485990e-02  4.00659041e-02]
 [ 2.36812134e-01  7.00176254e-02]
 [ 2.03960631e-01  2.13143234e-01]
 [-4.66798268e-01  1.94999128e-01]
 [ 6.50143355e-02  1.21657627e-01]
 [ 1.69579893e+00  2.13866231e-01]
 [ 1.34295457e-02  3.68448300e-01]
 [-1.61557763e-01  2.23785441e-01]
 [-1.70556870e-01  8.40122653e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 2.08272297e-01 -4.38278538e-01]
 [ 6.96513182e-02  5.39724099e-02]
 [ 3.02602057e-01 -7.91859160e-02]
 [-5.31938444e-01 -1.86387488e-01]
 [-1.14606377e-02 -8.97009421e-04]
 [ 3.39038891e-03 -5.50013527e-02]
 [ 5.34242272e-02  1.84063709e-01]
 [ 1.94101676e-02 -1.39574566e-03]
 [ 2.37244040e-01 -1.49265601e-01]
 [ 6.59795440e-02  9.87531822e-02]
 [-4.91928373e-02  6.18018114e-02]
 [-2.24036293e-01 -9.34721983e-02]
 [ 1.34335279e-01 -3.55426646e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.46122966]
curr_Stock_Price:  98.09226140896719
curr_Factors:  [9.80922614e+01 4.16372711e-02]
mat_Sqrt:  [[ 2.00159347e+01  0.00000000e+00]
 [-8.16208514e-03  1.87016865e-02]]
grads:  [ 0.0783725  19.09720234]
Stock Position:  0.07837250440963779
Bond Position:  [-18.14896585]


portfolio before change:  [-10.43865378]
curr_Stock_Price:  98.40926851130007
curr_Factors:  [9.84092685e+01 4.20408730e-02]
mat_Sqrt:  [[ 2.01777096e+01  0.00000000e+00]
 [-8.20154844e-03  1.87921083e-02]]
grads:  [0.05421812 3.79619999]
Stock Position:  0.05421811562276644
Bond Position:  [-15.77421888]


portfolio before change:  [-10.45654991]
curr_Stock_Price:  98.11556172340478
curr_Factors:  [9.81155617e+01 4.31720494e-02]
mat_Sqrt:  [[ 2.03863383e+01  0.00000000e+00]
 [-8.31115390e-03  1.90432459e-02]]
grads:  [0.00297895 1.7915683 ]
Stock Position:  0.0029789549694671856
Bond Position:  [-10.74883175]


portfolio before change:  [-10.46045195]
curr_Stock_Price:  97.25675291810579
curr_Factors:  [9.72567529e+01 4.43451997e-02]
mat_Sqrt:  [[ 2.04806188e+01  0.00000000e+00]
 [-8.42331998e-03  1.93002507e-02]]
grads:  [-7.95941136e-04 -7.84377440e+00]
Stock Position:  -0.0007959411360706695
Bond Position:  [-10.3830413]


portfolio before change:  [-10.46021971]
curr_Stock_Price:  95.33425463990443
curr_Factors:  [9.53342546e+01 4.57200827e-02]
mat_Sqrt:  [[ 2.03846134e+01  0.00000000e+00]
 [-8.55290198e-03  1.95971604e-02]]
grads:  [1.86245550e-02 6.54667931e+01]
Stock Position:  0.018624555035672417
Bond Position:  [-12.23577779]


portfolio before change:  [-10.4614784]
curr_Stock_Price:  95.34879888860365
curr_Factors:  [9.53487989e+01 4.65883236e-02]
mat_Sqrt:  [[ 2.05803979e+01  0.00000000e+00]
 [-8.63373139e-03  1.97823638e-02]]
grads:  [0.00392833 2.38959251]
Stock Position:  0.003928325426449517
Bond Position:  [-10.83603951]


portfolio before change:  [-10.46630806]
curr_Stock_Price:  94.46417975140811
curr_Factors:  [9.44641798e+01 4.88263491e-02]
mat_Sqrt:  [[ 2.08734523e+01  0.00000000e+00]
 [-8.83867402e-03  2.02519464e-02]]
grads:  [0.00623378 4.57824633]
Stock Position:  0.006233784796524127
Bond Position:  [-11.05517743]


portfolio before change:  [-10.47053128]
curr_Stock_Price:  94.00839956064783
curr_Factors:  [9.40083996e+01 5.11055944e-02]
mat_Sqrt:  [[ 2.12520526e+01  0.00000000e+00]
 [-9.04261860e-03  2.07192421e-02]]
grads:  [ 0.09479622 69.38847742]
Stock Position:  0.09479622277975912
Bond Position:  [-19.38217247]


portfolio before change:  [-10.42462306]
curr_Stock_Price:  94.51824206741051
curr_Factors:  [9.45182421e+01 5.18835718e-02]
mat_Sqrt:  [[ 2.15293327e+01  0.00000000e+00]
 [-9.11118625e-03  2.08763503e-02]]
grads:  [1.85422944e-02 3.09314431e+01]
Stock Position:  0.01854229437957377
Bond Position:  [-12.17720813]


portfolio before change:  [-10.44316248]
curr_Stock_Price:  93.60049317020626
curr_Factors:  [9.36004932e+01 5.38169463e-02]
mat_Sqrt:  [[ 2.17138915e+01  0.00000000e+00]
 [-9.27939190e-03  2.12617579e-02]]
grads:  [-8.18807429e-03 -1.46393890e+01]
Stock Position:  -0.008188074289380926
Bond Position:  [-9.67675469]


portfolio before change:  [-10.44672635]
curr_Stock_Price:  93.88800948994005
curr_Factors:  [9.38880095e+01 5.23843763e-02]
mat_Sqrt:  [[ 2.14887434e+01  0.00000000e+00]
 [-9.15505336e-03  2.09768625e-02]]
grads:  [0.0037259  0.74744983]
Stock Position:  0.0037258980777147375
Bond Position:  [-10.79654351]


portfolio before change:  [-10.44338937]
curr_Stock_Price:  95.14586199841929
curr_Factors:  [9.51458620e+01 5.17616988e-02]
mat_Sqrt:  [[ 2.16468230e+01  0.00000000e+00]
 [-9.10047900e-03  2.08518169e-02]]
grads:  [ 8.30321256e-04 -4.46081586e+00]
Stock Position:  0.000830321256329658
Bond Position:  [-10.52239101]


portfolio before change:  [-10.4448228]
curr_Stock_Price:  95.00369661901084
curr_Factors:  [9.50036966e+01 5.11062971e-02]
mat_Sqrt:  [[ 2.14772025e+01  0.00000000e+00]
 [-9.04268076e-03  2.07193845e-02]]
grads:  [-1.75056431e-03  5.17320309e+00]
Stock Position:  -0.0017505643094229504
Bond Position:  [-10.27851272]


portfolio before change:  [-10.44520324]
curr_Stock_Price:  94.48703552569677
curr_Factors:  [9.44870355e+01 5.15201386e-02]
mat_Sqrt:  [[ 2.14467127e+01  0.00000000e+00]
 [-9.07921923e-03  2.08031047e-02]]
grads:  [2.24884765e-03 2.03649283e+01]
Stock Position:  0.0022488476509776893
Bond Position:  [-10.65769019]


portfolio before change:  [-10.44282264]
curr_Stock_Price:  96.13805827080454
curr_Factors:  [9.61380583e+01 5.04305564e-02]
mat_Sqrt:  [[ 2.15894822e+01  0.00000000e+00]
 [-8.98269949e-03  2.05819502e-02]]
grads:  [ 0.02170493 12.35179869]
Stock Position:  0.021704925477017318
Bond Position:  [-12.52949203]


portfolio before change:  [-10.46660921]
curr_Stock_Price:  95.11431439978867
curr_Factors:  [9.51143144e+01 5.23658774e-02]
mat_Sqrt:  [[ 2.17655715e+01  0.00000000e+00]
 [-9.15343673e-03  2.09731583e-02]]
grads:  [ 0.00447926 -3.83316273]
Stock Position:  0.004479261368146218
Bond Position:  [-10.89265108]


portfolio before change:  [-10.46967805]
curr_Stock_Price:  94.73318685330622
curr_Factors:  [9.47331869e+01 5.25214395e-02]
mat_Sqrt:  [[ 2.17105316e+01  0.00000000e+00]
 [-9.16702259e-03  2.10042875e-02]]
grads:  [0.00261324 1.90751075]
Stock Position:  0.0026132383209605038
Bond Position:  [-10.71723844]


portfolio before change:  [-10.47006512]
curr_Stock_Price:  95.0977394368592
curr_Factors:  [9.50977394e+01 5.17710207e-02]
mat_Sqrt:  [[ 2.16378227e+01  0.00000000e+00]
 [-9.10129843e-03  2.08536945e-02]]
grads:  [0.01235662 3.35756455]
Stock Position:  0.01235661898890186
Bond Position:  [-11.64515165]


portfolio before change:  [-10.48030186]
curr_Stock_Price:  94.38710774525174
curr_Factors:  [9.43871077e+01 5.18166815e-02]
mat_Sqrt:  [[ 2.14855995e+01  0.00000000e+00]
 [-9.10531111e-03  2.08628887e-02]]
grads:  [ 0.01382247 10.21638169]
Stock Position:  0.013822465800610896
Bond Position:  [-11.78496443]


portfolio before change:  [-10.4643349]
curr_Stock_Price:  95.6488346440266
curr_Factors:  [9.56488346e+01 5.24629487e-02]
mat_Sqrt:  [[ 2.19081664e+01  0.00000000e+00]
 [-9.16191671e-03  2.09925884e-02]]
grads:  [-0.01742244  9.28895113]
Stock Position:  -0.0174224380103603
Bond Position:  [-8.797899]


portfolio before change:  [-10.44355982]
curr_Stock_Price:  94.39327666445136
curr_Factors:  [9.43932767e+01 5.45246856e-02]
mat_Sqrt:  [[ 2.20413224e+01  0.00000000e+00]
 [-9.34020862e-03  2.14011065e-02]]
grads:  [5.35857491e-03 5.68464193e+00]
Stock Position:  0.005358574905811398
Bond Position:  [-10.94937327]


portfolio before change:  [-10.44856188]
curr_Stock_Price:  93.71524154191884
curr_Factors:  [9.37152415e+01 5.67628967e-02]
mat_Sqrt:  [[ 2.23276237e+01  0.00000000e+00]
 [-9.52998608e-03  2.18359413e-02]]
grads:  [0.08013113 9.79423   ]
Stock Position:  0.08013113387108879
Bond Position:  [-17.95807045]


portfolio before change:  [-10.65759995]
curr_Stock_Price:  91.13455706519132
curr_Factors:  [9.11345571e+01 5.83594848e-02]
mat_Sqrt:  [[ 2.20160200e+01  0.00000000e+00]
 [-9.66308313e-03  2.21409049e-02]]
grads:  [7.91394480e-03 1.66410678e+01]
Stock Position:  0.007913944798583013
Bond Position:  [-11.37883381]


portfolio before change:  [-10.65254458]
curr_Stock_Price:  91.953089502292
curr_Factors:  [9.19530895e+01 5.84633138e-02]
mat_Sqrt:  [[ 2.22335105e+01  0.00000000e+00]
 [-9.67167525e-03  2.21605920e-02]]
grads:  [-2.87358081e-03  1.00983512e+01]
Stock Position:  -0.0028735808104873757
Bond Position:  [-10.38830994]


portfolio before change:  [-10.65620431]
curr_Stock_Price:  92.7747536422006
curr_Factors:  [9.27747536e+01 5.79186288e-02]
mat_Sqrt:  [[ 2.23274407e+01  0.00000000e+00]
 [-9.62651578e-03  2.20571186e-02]]
grads:  [-0.0059967   3.80885041]
Stock Position:  -0.0059966976456675
Bond Position:  [-10.09986217]


portfolio before change:  [-10.65947541]
curr_Stock_Price:  93.10969409153458
curr_Factors:  [9.31096941e+01 5.64807188e-02]
mat_Sqrt:  [[ 2.21281449e+01  0.00000000e+00]
 [-9.50626899e-03  2.17815986e-02]]
grads:  [ 0.00829164 -3.35124793]
Stock Position:  0.008291639596714582
Bond Position:  [-11.43150744]


portfolio before change:  [-10.66159096]
curr_Stock_Price:  93.0268979276623
curr_Factors:  [9.30268979e+01 5.69788638e-02]
mat_Sqrt:  [[ 2.22057493e+01  0.00000000e+00]
 [-9.54809835e-03  2.18774417e-02]]
grads:  [ 7.65200970e-04 -2.00333542e+01]
Stock Position:  0.0007652009699886586
Bond Position:  [-10.73277523]


portfolio before change:  [-10.66074747]
curr_Stock_Price:  95.88257413150174
curr_Factors:  [9.58825741e+01 5.42970776e-02]
mat_Sqrt:  [[ 2.23423017e+01  0.00000000e+00]
 [-9.32069333e-03  2.13563914e-02]]
grads:  [0.00417176 2.52722517]
Stock Position:  0.004171763955974006
Bond Position:  [-11.06074694]


portfolio before change:  [-10.65767311]
curr_Stock_Price:  96.95095589494213
curr_Factors:  [9.69509559e+01 5.59235039e-02]
mat_Sqrt:  [[ 2.29271083e+01  0.00000000e+00]
 [-9.45926034e-03  2.16738883e-02]]
grads:  [ 0.01169107 -3.65351685]
Stock Position:  0.011691072689821379
Bond Position:  [-11.79113379]


portfolio before change:  [-10.65988415]
curr_Stock_Price:  96.88791195694168
curr_Factors:  [9.68879120e+01 5.49222237e-02]
mat_Sqrt:  [[ 2.27061579e+01  0.00000000e+00]
 [-9.37419639e-03  2.14789823e-02]]
grads:  [-0.02700962 -8.67766849]
Stock Position:  -0.027009616354628816
Bond Position:  [-8.04297882]


portfolio before change:  [-10.62908702]
curr_Stock_Price:  95.71045844816955
curr_Factors:  [9.57104584e+01 5.71000465e-02]
mat_Sqrt:  [[ 2.28706036e+01  0.00000000e+00]
 [-9.55824640e-03  2.19006938e-02]]
grads:  [-0.00051823 -0.04095804]
Stock Position:  -0.0005182252665034678
Bond Position:  [-10.57948744]


portfolio before change:  [-10.63189654]
curr_Stock_Price:  98.57986665260941
curr_Factors:  [9.85798667e+01 5.62324569e-02]
mat_Sqrt:  [[ 2.33766221e+01  0.00000000e+00]
 [-9.48535350e-03  2.17336752e-02]]
grads:  [-8.81828406e-04 -2.53069728e+00]
Stock Position:  -0.0008818284063734898
Bond Position:  [-10.54496601]


portfolio before change:  [-10.63233243]
curr_Stock_Price:  97.57931836999168
curr_Factors:  [9.75793184e+01 5.76941536e-02]
mat_Sqrt:  [[ 2.34381691e+01  0.00000000e+00]
 [-9.60784293e-03  2.20143337e-02]]
grads:  [5.70676894e-03 8.36108468e+00]
Stock Position:  0.005706768944095819
Bond Position:  [-11.18919505]


portfolio before change:  [-10.63897611]
curr_Stock_Price:  96.66024415725761
curr_Factors:  [9.66602442e+01 5.70671032e-02]
mat_Sqrt:  [[ 2.30908969e+01  0.00000000e+00]
 [-9.55548875e-03  2.18943752e-02]]
grads:  [ 0.00081422 -0.06374905]
Stock Position:  0.0008142175828928194
Bond Position:  [-10.71767858]


portfolio before change:  [-10.64145905]
curr_Stock_Price:  95.25625564195337
curr_Factors:  [9.52562556e+01 5.91294769e-02]
mat_Sqrt:  [[ 2.31630383e+01  0.00000000e+00]
 [-9.72662136e-03  2.22864893e-02]]
grads:  [ 0.00742991 -6.69758251]
Stock Position:  0.007429905751798306
Bond Position:  [-11.34920405]


portfolio before change:  [-10.64409669]
curr_Stock_Price:  95.09220338031768
curr_Factors:  [9.50922034e+01 5.95023680e-02]
mat_Sqrt:  [[ 2.31959431e+01  0.00000000e+00]
 [-9.75724289e-03  2.23566520e-02]]
grads:  [0.0047025  4.41717221]
Stock Position:  0.004702501880212267
Bond Position:  [-11.09126795]


portfolio before change:  [-10.64155954]
curr_Stock_Price:  95.92657704088099
curr_Factors:  [9.59265770e+01 6.02827265e-02]
mat_Sqrt:  [[ 2.35524121e+01  0.00000000e+00]
 [-9.82101637e-03  2.25027754e-02]]
grads:  [-9.43441181e-04  2.74640840e+00]
Stock Position:  -0.0009434411811535995
Bond Position:  [-10.55105845]


portfolio before change:  [-10.64340275]
curr_Stock_Price:  96.4822490385315
curr_Factors:  [9.64822490e+01 6.08777149e-02]
mat_Sqrt:  [[ 2.38054607e+01  0.00000000e+00]
 [-9.86936391e-03  2.26135536e-02]]
grads:  [-0.0111248  -4.13345908]
Stock Position:  -0.0111247964789167
Bond Position:  [-9.57005736]


portfolio before change:  [-10.63553305]
curr_Stock_Price:  95.66731017706493
curr_Factors:  [9.56673102e+01 6.37005984e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.63553305]
Stock Price:  95.11172090323221
PL:  [-10.63553305]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48801855e+00  3.65462953e-01]
 [ 3.96982311e-01  1.18539912e-01]
 [ 1.09997597e-01 -1.45091109e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.09370952e-02  4.36082633e-02]
 [-2.70636005e-01  9.07114340e-02]
 [ 1.82655529e-01 -1.88745637e-01]
 [-2.95149857e-01  3.09644174e-01]
 [-1.17942977e-01 -9.73699496e-02]
 [ 4.68756391e-02 -1.39082002e-01]
 [-6.44778068e-02 -1.37083214e-02]
 [ 1.41790835e-02 -1.35950983e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.49741306e-02 -3.63919168e-02]
 [ 4.39608397e-01  2.78812520e-01]
 [ 1.31113893e-01 -1.72357115e-01]
 [ 3.98268072e-02  1.21300178e-01]
 [ 1.93316177e-03  4.12070314e-02]
 [-5.04798147e-02 -3.44505123e-02]
 [-1.12556142e-01 -1.22860386e-02]
 [ 1.76689275e-01 -4.46819916e-02]
 [ 8.40078378e-01 -8.12697241e-03]
 [ 2.68751176e-02 -2.30191946e-01]
 [ 4.93872514e-02  8.87025333e-03]
 [ 2.11321272e-01 -1.24359735e-01]
 [ 1.76148556e-01 -8.71865653e-02]
 [ 1.17649240e-02 -1.02292055e-01]
 [ 5.40171521e-02  2.39761686e-01]
 [-8.74605027e-03  1.78424773e-01]
 [-5.24033460e-01 -1.11516668e-01]
 [-1.68067300e-01 -6.32696976e-02]
 [ 9.04551049e-03 -6.07963830e-02]
 [-6.96054968e-02  1.64407120e-01]
 [ 7.40604759e-03  1.07968384e-02]
 [-6.20093673e-02  8.37477651e-02]
 [-1.38590698e-01  1.12339747e-01]
 [-3.78662103e-02 -8.53839244e-02]
 [-1.25995660e-01 -6.55674810e-02]
 [ 1.43097518e-01 -1.32426919e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.54954223]
curr_Stock_Price:  99.0955271557802
curr_Factors:  [9.90955272e+01 4.02998936e-02]
mat_Sqrt:  [[ 1.98932620e+01  0.00000000e+00]
 [-8.02993336e-03  1.83988887e-02]]
grads:  [ 0.08281797 19.86331663]
Stock Position:  0.08281797401550464
Bond Position:  [-11.75643303]


portfolio before change:  [-3.4709002]
curr_Stock_Price:  100.0628495465353
curr_Factors:  [1.00062850e+02 3.84477915e-02]
mat_Sqrt:  [[ 1.96204320e+01  0.00000000e+00]
 [-7.84324336e-03  1.79711282e-02]]
grads:  [0.0228699 6.5961308]
Stock Position:  0.02286990261871644
Bond Position:  [-5.75932782]


portfolio before change:  [-3.46877694]
curr_Stock_Price:  100.1871712423864
curr_Factors:  [1.00187171e+02 3.84705561e-02]
mat_Sqrt:  [[ 1.96506240e+01  0.00000000e+00]
 [-7.84556497e-03  1.79764477e-02]]
grads:  [ 0.00527542 -0.8071178 ]
Stock Position:  0.005275420330466364
Bond Position:  [-3.99730638]


portfolio before change:  [-3.4658189]
curr_Stock_Price:  100.84261226684637
curr_Factors:  [1.00842612e+02 3.85817617e-02]
mat_Sqrt:  [[ 1.98077486e+01  0.00000000e+00]
 [-7.85689625e-03  1.80024109e-02]]
grads:  [-8.22979296e-04 -8.40925214e+00]
Stock Position:  -0.0008229792958425752
Bond Position:  [-3.38282752]


portfolio before change:  [-3.46589354]
curr_Stock_Price:  100.41945710400329
curr_Factors:  [1.00419457e+02 3.89800720e-02]
mat_Sqrt:  [[ 1.98261865e+01  0.00000000e+00]
 [-7.89734862e-03  1.80950989e-02]]
grads:  [-0.00362676  2.40994888]
Stock Position:  -0.003626763454379763
Bond Position:  [-3.10169592]


portfolio before change:  [-3.46825953]
curr_Stock_Price:  100.9649182030353
curr_Factors:  [1.00964918e+02 3.95937231e-02]
mat_Sqrt:  [[ 2.00901726e+01  0.00000000e+00]
 [-7.95926862e-03  1.82369755e-02]]
grads:  [-0.01150046  4.97403937]
Stock Position:  -0.011500463139119742
Bond Position:  [-2.30711621]


portfolio before change:  [-3.47671956]
curr_Stock_Price:  101.6754655172412
curr_Factors:  [1.01675466e+02 3.83205353e-02]
mat_Sqrt:  [[ 1.99036146e+01  0.00000000e+00]
 [-7.83025265e-03  1.79413627e-02]]
grads:  [ 5.03828985e-03 -1.05201394e+01]
Stock Position:  0.005038289850869454
Bond Position:  [-3.98899003]


portfolio before change:  [-3.47550232]
curr_Stock_Price:  102.01603741333723
curr_Factors:  [1.02016037e+02 3.87625404e-02]
mat_Sqrt:  [[ 2.00851263e+01  0.00000000e+00]
 [-7.87528188e-03  1.80445377e-02]]
grads:  [-7.96659471e-03  1.71599949e+01]
Stock Position:  -0.007966594708983529
Bond Position:  [-2.66278189]


portfolio before change:  [-3.47168208]
curr_Stock_Price:  101.49472251656333
curr_Factors:  [1.01494723e+02 3.86021190e-02]
mat_Sqrt:  [[ 1.99410964e+01  0.00000000e+00]
 [-7.85896879e-03  1.80071597e-02]]
grads:  [-0.00804563 -5.40729084]
Stock Position:  -0.008045631174402542
Bond Position:  [-2.65509298]


portfolio before change:  [-3.47040306]
curr_Stock_Price:  101.29449883388976
curr_Factors:  [1.01294499e+02 3.94457909e-02]
mat_Sqrt:  [[ 2.01180644e+01  0.00000000e+00]
 [-7.94438579e-03  1.82028746e-02]]
grads:  [-6.87179583e-04 -7.64066146e+00]
Stock Position:  -0.0006871795832815442
Bond Position:  [-3.40079555]


portfolio before change:  [-3.47177115]
curr_Stock_Price:  102.66671306444981
curr_Factors:  [1.02666713e+02 3.84733948e-02]
mat_Sqrt:  [[ 2.01377021e+01  0.00000000e+00]
 [-7.84585443e-03  1.79771109e-02]]
grads:  [-0.00349894 -0.76254307]
Stock Position:  -0.0034989398604844298
Bond Position:  [-3.11254649]


portfolio before change:  [-3.46431543]
curr_Stock_Price:  100.42465990084875
curr_Factors:  [1.00424660e+02 3.75859094e-02]
mat_Sqrt:  [[ 1.94694149e+01  0.00000000e+00]
 [-7.75483430e-03  1.77685576e-02]]
grads:  [-2.31926793e-03 -7.65121096e+00]
Stock Position:  -0.002319267929890769
Bond Position:  [-3.23140374]


portfolio before change:  [-3.46354288]
curr_Stock_Price:  99.91738783364303
curr_Factors:  [9.99173878e+01 3.81522959e-02]
mat_Sqrt:  [[ 1.95164764e+01  0.00000000e+00]
 [-7.81304508e-03  1.79019352e-02]]
grads:  [-0.00662768 -1.5669482 ]
Stock Position:  -0.006627676307875078
Bond Position:  [-2.80132278]


portfolio before change:  [-3.46489099]
curr_Stock_Price:  100.06795710260604
curr_Factors:  [1.00067957e+02 3.75572966e-02]
mat_Sqrt:  [[ 1.93928749e+01  0.00000000e+00]
 [-7.75188200e-03  1.77617930e-02]]
grads:  [-0.0031381  -2.04888756]
Stock Position:  -0.0031381043563775534
Bond Position:  [-3.1508673]


portfolio before change:  [-3.4653332]
curr_Stock_Price:  100.08335832832009
curr_Factors:  [1.00083358e+02 3.64410246e-02]
mat_Sqrt:  [[ 1.91054451e+01  0.00000000e+00]
 [-7.63581294e-03  1.74958454e-02]]
grads:  [ 0.02937865 15.93592729]
Stock Position:  0.029378648570748015
Bond Position:  [-6.40564702]


portfolio before change:  [-3.48113364]
curr_Stock_Price:  99.57279424724044
curr_Factors:  [9.95727942e+01 3.64107211e-02]
mat_Sqrt:  [[ 1.90000759e+01  0.00000000e+00]
 [-7.63263741e-03  1.74885693e-02]]
grads:  [ 2.94162412e-03 -9.85541538e+00]
Stock Position:  0.0029416241154861275
Bond Position:  [-3.77403938]


portfolio before change:  [-3.48603617]
curr_Stock_Price:  98.06657204839408
curr_Factors:  [9.80665720e+01 3.86320467e-02]
mat_Sqrt:  [[ 1.92750207e+01  0.00000000e+00]
 [-7.86201467e-03  1.80141387e-02]]
grads:  [4.81278575e-03 6.73360963e+00]
Stock Position:  0.004812785746534335
Bond Position:  [-3.95800957]


portfolio before change:  [-3.48448461]
curr_Stock_Price:  98.4917610568023
curr_Factors:  [9.84917611e+01 3.84357702e-02]
mat_Sqrt:  [[ 1.93093519e+01  0.00000000e+00]
 [-7.84201711e-03  1.79683185e-02]]
grads:  [1.03148903e-03 2.29331595e+00]
Stock Position:  0.0010314890324300307
Bond Position:  [-3.58607778]


portfolio before change:  [-3.48496087]
curr_Stock_Price:  98.4646402675208
curr_Factors:  [9.84646403e+01 3.91575856e-02]
mat_Sqrt:  [[ 1.94844545e+01  0.00000000e+00]
 [-7.91531029e-03  1.81362543e-02]]
grads:  [-0.00336244 -1.89953845]
Stock Position:  -0.003362437005863733
Bond Position:  [-3.15387972]


portfolio before change:  [-3.4871021]
curr_Stock_Price:  98.98419651706998
curr_Factors:  [9.89841965e+01 3.82863786e-02]
mat_Sqrt:  [[ 1.93681441e+01  0.00000000e+00]
 [-7.82676215e-03  1.79333650e-02]]
grads:  [-0.00608826 -0.68509388]
Stock Position:  -0.006088255443483351
Bond Position:  [-2.88446103]


portfolio before change:  [-3.48776572]
curr_Stock_Price:  99.03397004493033
curr_Factors:  [9.90339700e+01 3.70375231e-02]
mat_Sqrt:  [[ 1.90592215e+01  0.00000000e+00]
 [-7.69805410e-03  1.76384578e-02]]
grads:  [ 0.00824737 -2.53321419]
Stock Position:  0.008247370205176891
Bond Position:  [-4.30453553]


portfolio before change:  [-3.48152619]
curr_Stock_Price:  99.85576222278058
curr_Factors:  [9.98557622e+01 3.77373830e-02]
mat_Sqrt:  [[ 1.93980923e+01  0.00000000e+00]
 [-7.77044483e-03  1.78043258e-02]]
grads:  [ 0.04312442 -0.45646055]
Stock Position:  0.043124419893405055
Bond Position:  [-7.78774801]


portfolio before change:  [-3.46067765]
curr_Stock_Price:  100.36178819269114
curr_Factors:  [1.00361788e+02 3.75536542e-02]
mat_Sqrt:  [[ 1.94488753e+01  0.00000000e+00]
 [-7.75150609e-03  1.77609317e-02]]
grads:  [-3.78370898e-03 -1.29605783e+01]
Stock Position:  -0.003783708975138872
Bond Position:  [-3.08093785]


portfolio before change:  [-3.46461816]
curr_Stock_Price:  101.30144033932112
curr_Factors:  [1.01301440e+02 3.79915086e-02]
mat_Sqrt:  [[ 1.97450796e+01  0.00000000e+00]
 [-7.79656423e-03  1.78641729e-02]]
grads:  [0.00269731 0.49653871]
Stock Position:  0.0026973072904196084
Bond Position:  [-3.73785927]


portfolio before change:  [-3.46633152]
curr_Stock_Price:  100.83946205392738
curr_Factors:  [1.00839462e+02 3.87838976e-02]
mat_Sqrt:  [[ 1.98589483e+01  0.00000000e+00]
 [-7.87745112e-03  1.80495080e-02]]
grads:  [ 0.00790808 -6.88992381]
Stock Position:  0.007908084131454841
Bond Position:  [-4.26377847]


portfolio before change:  [-3.46771741]
curr_Stock_Price:  100.73161201038195
curr_Factors:  [1.00731612e+02 3.97972147e-02]
mat_Sqrt:  [[ 2.00951903e+01  0.00000000e+00]
 [-7.97969570e-03  1.82837798e-02]]
grads:  [ 0.00687215 -4.76851977]
Stock Position:  0.006872152839045355
Bond Position:  [-4.15996044]


portfolio before change:  [-3.46776664]
curr_Stock_Price:  100.80011936940689
curr_Factors:  [1.00800119e+02 3.94937444e-02]
mat_Sqrt:  [[ 2.00320411e+01  0.00000000e+00]
 [-7.94921323e-03  1.82139357e-02]]
grads:  [-1.64131996e-03 -5.61614232e+00]
Stock Position:  -0.0016413199578789468
Bond Position:  [-3.3023214]


portfolio before change:  [-3.468202]
curr_Stock_Price:  100.81385489910386
curr_Factors:  [1.00813855e+02 3.87900315e-02]
mat_Sqrt:  [[ 1.98554753e+01  0.00000000e+00]
 [-7.87807403e-03  1.80509353e-02]]
grads:  [7.99062870e-03 1.32825077e+01]
Stock Position:  0.007990628701273908
Bond Position:  [-4.27376809]


portfolio before change:  [-3.47151667]
curr_Stock_Price:  100.46589635323173
curr_Factors:  [1.00465896e+02 3.96779885e-02]
mat_Sqrt:  [[ 2.00121379e+01  0.00000000e+00]
 [-7.96773378e-03  1.82563716e-02]]
grads:  [3.45414892e-03 9.77328774e+00]
Stock Position:  0.0034541489246815967
Bond Position:  [-3.81854083]


portfolio before change:  [-3.47490938]
curr_Stock_Price:  99.62187820670907
curr_Factors:  [9.96218782e+01 4.05946284e-02]
mat_Sqrt:  [[ 2.00719243e+01  0.00000000e+00]
 [-8.05924347e-03  1.84660466e-02]]
grads:  [-0.02853256 -6.03901151]
Stock Position:  -0.02853255702400161
Bond Position:  [-0.63244246]


portfolio before change:  [-3.49321938]
curr_Stock_Price:  100.2608305570113
curr_Factors:  [1.00260831e+02 4.03600548e-02]
mat_Sqrt:  [[ 2.01422124e+01  0.00000000e+00]
 [-8.03592482e-03  1.84126169e-02]]
grads:  [-0.00971494 -3.43621431]
Stock Position:  -0.009714943707424664
Bond Position:  [-2.51919106]


portfolio before change:  [-3.48484499]
curr_Stock_Price:  99.36640357417676
curr_Factors:  [9.93664036e+01 3.94774735e-02]
mat_Sqrt:  [[ 1.97430501e+01  0.00000000e+00]
 [-7.94757558e-03  1.82101834e-02]]
grads:  [-8.85790508e-04 -3.33859258e+00]
Stock Position:  -0.0008857905084885387
Bond Position:  [-3.39682718]


portfolio before change:  [-3.48482178]
curr_Stock_Price:  98.86081735372073
curr_Factors:  [9.88608174e+01 3.83883112e-02]
mat_Sqrt:  [[ 1.93697359e+01  0.00000000e+00]
 [-7.83717411e-03  1.79572218e-02]]
grads:  [1.10876734e-04 9.15548754e+00]
Stock Position:  0.00011087673414526018
Bond Position:  [-3.49578314]


portfolio before change:  [-3.48522108]
curr_Stock_Price:  99.20084107702233
curr_Factors:  [9.92008411e+01 3.81031391e-02]
mat_Sqrt:  [[ 1.93640294e+01  0.00000000e+00]
 [-7.80801015e-03  1.78903988e-02]]
grads:  [0.00062581 0.60349904]
Stock Position:  0.0006258085019598717
Bond Position:  [-3.54730181]


portfolio before change:  [-3.48529942]
curr_Stock_Price:  99.78425135316984
curr_Factors:  [9.97842514e+01 3.76930251e-02]
mat_Sqrt:  [[ 1.93728047e+01  0.00000000e+00]
 [-7.76587665e-03  1.77938588e-02]]
grads:  [-1.31415386e-03  4.70655444e+00]
Stock Position:  -0.001314153863179265
Bond Position:  [-3.35416756]


portfolio before change:  [-3.48454497]
curr_Stock_Price:  98.89109601113249
curr_Factors:  [9.88910960e+01 3.65986448e-02]
mat_Sqrt:  [[ 1.89186304e+01  0.00000000e+00]
 [-7.65230891e-03  1.75336424e-02]]
grads:  [-4.73404313e-03  6.40709699e+00]
Stock Position:  -0.004734043128615831
Bond Position:  [-3.01639026]


portfolio before change:  [-3.48203548]
curr_Stock_Price:  98.28134995814075
curr_Factors:  [9.82813500e+01 3.77791005e-02]
mat_Sqrt:  [[ 1.91027952e+01  0.00000000e+00]
 [-7.77473864e-03  1.78141642e-02]]
grads:  [-3.93297468e-03 -4.79303568e+00]
Stock Position:  -0.003932974683803399
Bond Position:  [-3.09549742]


portfolio before change:  [-3.48065711]
curr_Stock_Price:  97.83249635879379
curr_Factors:  [9.78324964e+01 3.79175454e-02]
mat_Sqrt:  [[ 1.90503625e+01  0.00000000e+00]
 [-7.78897122e-03  1.78467751e-02]]
grads:  [-0.00811594 -3.67391199]
Stock Position:  -0.008115942955216776
Bond Position:  [-2.68665415]


portfolio before change:  [-3.48064524]
curr_Stock_Price:  97.78965179442658
curr_Factors:  [9.77896518e+01 3.76398115e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.48064524]
Stock Price:  96.4504032083209
PL:  [-3.48064524]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.29279365e+00  3.21175956e-01]
 [-2.38797819e-01 -8.90873892e-02]
 [ 5.44093248e-02 -4.07873241e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.83408047e-02  1.81356213e-01]
 [-3.58421898e-01  1.89617134e-01]
 [ 9.14096535e-02  7.06102494e-02]
 [ 7.71935457e-01  7.58753077e-01]
 [ 1.84944067e-02  3.81732590e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-3.23772454e-02  1.67681424e-02]
 [ 7.23865452e-02 -1.08924239e-01]
 [-1.17918056e-01 -2.70663414e-02]
 [-1.29453253e-01  2.91311861e-01]
 [ 3.97086824e-01  2.71627415e-01]
 [ 1.32886870e-01 -7.30655458e-02]
 [ 4.03213511e-02  8.95757986e-02]
 [ 6.66336876e-02  7.91629006e-02]
 [-7.34897607e-02 -5.38350499e-02]
 [-3.33911861e-01  1.20172545e-01]
 [ 1.31197486e-01  2.95713497e-02]
 [ 1.22653556e+00  1.21998491e-01]
 [ 1.71093038e-02  3.14082474e-01]
 [-1.10724252e-01  8.49300682e-02]
 [-1.95881578e-01  1.80055603e-01]
 [ 1.30031096e-01 -1.03217972e-01]
 [-1.73760900e-01 -4.46016848e-01]
 [ 4.86624751e-02  1.36121816e-01]
 [ 1.30356995e-01  6.55911557e-02]
 [-5.33907793e-01 -1.71874662e-01]
 [-1.65320291e-01 -6.02692252e-02]
 [ 6.90094031e-03 -7.36362257e-02]
 [-2.14718285e-01  1.41222298e-01]
 [ 6.39175944e-02  6.28849007e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.70598023e-01  4.92237724e-02]
 [-2.52595207e-02 -1.97416884e-01]
 [-3.67273493e-03 -5.61782354e-02]
 [-4.61028328e-03 -3.39623840e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.75941758]
curr_Stock_Price:  100.15645896314618
curr_Factors:  [1.00156459e+02 4.20637635e-02]
mat_Sqrt:  [[ 2.05415412e+01  0.00000000e+00]
 [-8.20378093e-03  1.87972235e-02]]
grads:  [ 0.06975944 17.08635084]
Stock Position:  0.06975943581183067
Bond Position:  [-3.22744049]


portfolio before change:  [3.86063972]
curr_Stock_Price:  101.61325963025062
curr_Factors:  [1.01613260e+02 4.08621743e-02]
mat_Sqrt:  [[ 2.05405051e+01  0.00000000e+00]
 [-8.08575778e-03  1.85267985e-02]]
grads:  [-0.01351859 -4.808569  ]
Stock Position:  -0.013518593700856322
Bond Position:  [5.23430809]


portfolio before change:  [3.87300914]
curr_Stock_Price:  100.7466682695587
curr_Factors:  [1.00746668e+02 4.12191062e-02]
mat_Sqrt:  [[ 2.04540813e+01  0.00000000e+00]
 [-8.12099563e-03  1.86075386e-02]]
grads:  [ 1.78977861e-03 -2.19197848e+00]
Stock Position:  0.0017897786080832733
Bond Position:  [3.69269491]


portfolio before change:  [3.87443701]
curr_Stock_Price:  101.28653712269909
curr_Factors:  [1.01286537e+02 4.01006823e-02]
mat_Sqrt:  [[ 2.02827858e+01  0.00000000e+00]
 [-8.01006190e-03  1.83533575e-02]]
grads:  [-8.03704537e-04 -8.24845332e+00]
Stock Position:  -0.0008037045365970474
Bond Position:  [3.95584145]


portfolio before change:  [3.87643875]
curr_Stock_Price:  99.41117696098051
curr_Factors:  [9.94111770e+01 3.98738479e-02]
mat_Sqrt:  [[ 1.98508583e+01  0.00000000e+00]
 [-7.98737482e-03  1.83013749e-02]]
grads:  [4.07808797e-05 9.90943106e+00]
Stock Position:  4.078087969287989e-05
Bond Position:  [3.87238468]


portfolio before change:  [3.87702625]
curr_Stock_Price:  101.94709913569592
curr_Factors:  [1.01947099e+02 3.94755121e-02]
mat_Sqrt:  [[ 2.02553037e+01  0.00000000e+00]
 [-7.94737814e-03  1.82097310e-02]]
grads:  [-0.01360958 10.41295637]
Stock Position:  -0.013609581015219488
Bond Position:  [5.26448355]


portfolio before change:  [3.90564658]
curr_Stock_Price:  99.89250041856317
curr_Factors:  [9.98925004e+01 4.04614437e-02]
mat_Sqrt:  [[ 2.00934066e+01  0.00000000e+00]
 [-8.04601206e-03  1.84357296e-02]]
grads:  [0.00608292 3.8300762 ]
Stock Position:  0.006082915429720045
Bond Position:  [3.29800894]


portfolio before change:  [3.89682053]
curr_Stock_Price:  98.3737678027166
curr_Factors:  [9.83737678e+01 4.24786741e-02]
mat_Sqrt:  [[ 2.02751830e+01  0.00000000e+00]
 [-8.24414208e-03  1.88897026e-02]]
grads:  [ 0.05440555 40.16755024]
Stock Position:  0.05440554841276591
Bond Position:  [-1.45525826]


portfolio before change:  [3.84288618]
curr_Stock_Price:  97.38577233685417
curr_Factors:  [9.73857723e+01 4.23282923e-02]
mat_Sqrt:  [[ 2.00359937e+01  0.00000000e+00]
 [-8.22953630e-03  1.88562365e-02]]
grads:  [9.23818255e-03 2.02443679e+01]
Stock Position:  0.009238182547539345
Bond Position:  [2.94321864]


portfolio before change:  [3.84937252]
curr_Stock_Price:  98.04806911873254
curr_Factors:  [9.80480691e+01 4.16505023e-02]
mat_Sqrt:  [[ 2.00100958e+01  0.00000000e+00]
 [-8.16338187e-03  1.87046577e-02]]
grads:  [0.01231549 6.0453677 ]
Stock Position:  0.01231549262968602
Bond Position:  [2.64186225]


portfolio before change:  [3.83610049]
curr_Stock_Price:  96.9435832188473
curr_Factors:  [9.69435832e+01 4.14058934e-02]
mat_Sqrt:  [[ 1.97265051e+01  0.00000000e+00]
 [-8.13937525e-03  1.86496516e-02]]
grads:  [-0.00127032  0.8991129 ]
Stock Position:  -0.0012703227456780809
Bond Position:  [3.95925013]


portfolio before change:  [3.83683858]
curr_Stock_Price:  96.75217394673412
curr_Factors:  [9.67521739e+01 4.08614616e-02]
mat_Sqrt:  [[ 1.95576955e+01  0.00000000e+00]
 [-8.08568727e-03  1.85266370e-02]]
grads:  [ 1.27050295e-03 -5.87933144e+00]
Stock Position:  0.0012705029472074383
Bond Position:  [3.71391465]


portfolio before change:  [3.83782398]
curr_Stock_Price:  97.16235647416876
curr_Factors:  [9.71623565e+01 4.17324328e-02]
mat_Sqrt:  [[ 1.98488290e+01  0.00000000e+00]
 [-8.17140701e-03  1.87230456e-02]]
grads:  [-0.00653594 -1.44561638]
Stock Position:  -0.006535941041519586
Bond Position:  [4.47287142]


portfolio before change:  [3.84612483]
curr_Stock_Price:  95.977874640292
curr_Factors:  [9.59778746e+01 4.23668637e-02]
mat_Sqrt:  [[ 1.97553299e+01  0.00000000e+00]
 [-8.23328500e-03  1.88648259e-02]]
grads:  [-1.17149821e-04  1.54420647e+01]
Stock Position:  -0.00011714982077152754
Bond Position:  [3.85736862]


portfolio before change:  [3.84654022]
curr_Stock_Price:  96.54819613280075
curr_Factors:  [9.65481961e+01 4.21908104e-02]
mat_Sqrt:  [[ 1.98313874e+01  0.00000000e+00]
 [-8.21616070e-03  1.88255892e-02]]
grads:  [ 0.02600094 14.42862757]
Stock Position:  0.026000941681834176
Bond Position:  [1.3361962]


portfolio before change:  [3.81765222]
curr_Stock_Price:  95.43073525448237
curr_Factors:  [9.54307353e+01 4.30334630e-02]
mat_Sqrt:  [[ 1.97966369e+01  0.00000000e+00]
 [-8.29780337e-03  1.90126560e-02]]
grads:  [ 0.0051018 -3.8429952]
Stock Position:  0.005101798429517874
Bond Position:  [3.33078384]


portfolio before change:  [3.81936189]
curr_Stock_Price:  95.68423379479256
curr_Factors:  [9.56842338e+01 4.41784183e-02]
mat_Sqrt:  [[ 2.01115464e+01  0.00000000e+00]
 [-8.40746509e-03  1.92639226e-02]]
grads:  [3.94874831e-03 4.64992518e+00]
Stock Position:  0.003948748305360717
Bond Position:  [3.44152893]


portfolio before change:  [3.82671537]
curr_Stock_Price:  97.43751281803839
curr_Factors:  [9.74375128e+01 4.43192782e-02]
mat_Sqrt:  [[ 2.05126859e+01  0.00000000e+00]
 [-8.42085774e-03  1.92946090e-02]]
grads:  [0.00493271 4.10285073]
Stock Position:  0.004932713861265271
Bond Position:  [3.346084]


portfolio before change:  [3.82646724]
curr_Stock_Price:  97.3024127448825
curr_Factors:  [9.73024127e+01 4.34418483e-02]
mat_Sqrt:  [[ 2.02804579e+01  0.00000000e+00]
 [-8.33708326e-03  1.91026575e-02]]
grads:  [-0.0047822  -2.81819688]
Stock Position:  -0.004782204778108795
Bond Position:  [4.29178731]


portfolio before change:  [3.82828775]
curr_Stock_Price:  97.0339169353603
curr_Factors:  [9.70339169e+01 4.35226796e-02]
mat_Sqrt:  [[ 2.02433030e+01  0.00000000e+00]
 [-8.34483597e-03  1.91204212e-02]]
grads:  [-0.01390407  6.28503649]
Stock Position:  -0.013904068055127547
Bond Position:  [5.17745394]


portfolio before change:  [3.83266802]
curr_Stock_Price:  96.76543126044226
curr_Factors:  [9.67654313e+01 4.41849592e-02]
mat_Sqrt:  [[ 2.03403052e+01  0.00000000e+00]
 [-8.40808746e-03  1.92653486e-02]]
grads:  [0.00708463 1.53495015]
Stock Position:  0.0070846272602241534
Bond Position:  [3.147121]


portfolio before change:  [3.8360103]
curr_Stock_Price:  97.1816658248994
curr_Factors:  [9.71816658e+01 4.56947910e-02]
mat_Sqrt:  [[ 2.07738833e+01  0.00000000e+00]
 [-8.55053598e-03  1.95917392e-02]]
grads:  [0.06160524 6.22703734]
Stock Position:  0.061605240316772746
Bond Position:  [-2.15088958]


portfolio before change:  [3.84153096]
curr_Stock_Price:  97.27564387498415
curr_Factors:  [9.72756439e+01 4.70919467e-02]
mat_Sqrt:  [[ 2.11094752e+01  0.00000000e+00]
 [-8.68027158e-03  1.98890008e-02]]
grads:  [7.30411969e-03 1.57917674e+01]
Stock Position:  0.0073041196945140534
Bond Position:  [3.13101801]


portfolio before change:  [3.84560881]
curr_Stock_Price:  97.78035221118158
curr_Factors:  [9.77803522e+01 4.59358038e-02]
mat_Sqrt:  [[ 2.09569104e+01  0.00000000e+00]
 [-8.57305581e-03  1.96433386e-02]]
grads:  [-3.51472284e-03  4.32360659e+00]
Stock Position:  -0.00351472283799318
Bond Position:  [4.18927965]


portfolio before change:  [3.84645117]
curr_Stock_Price:  97.68968541179196
curr_Factors:  [9.76896854e+01 4.71454526e-02]
mat_Sqrt:  [[ 2.12113649e+01  0.00000000e+00]
 [-8.68520145e-03  1.99002965e-02]]
grads:  [-5.53000105e-03  9.04788542e+00]
Stock Position:  -0.005530001046761693
Bond Position:  [4.38667524]


portfolio before change:  [3.84793756]
curr_Stock_Price:  97.52006202009918
curr_Factors:  [9.75200620e+01 4.68832944e-02]
mat_Sqrt:  [[ 2.11155807e+01  0.00000000e+00]
 [-8.66102021e-03  1.98448904e-02]]
grads:  [ 4.02466222e-03 -5.20123670e+00]
Stock Position:  0.004024662219571836
Bond Position:  [3.45545225]


portfolio before change:  [3.84590167]
curr_Stock_Price:  96.90688098014753
curr_Factors:  [9.69068810e+01 4.70443811e-02]
mat_Sqrt:  [[ 2.10188280e+01  0.00000000e+00]
 [-8.67588669e-03  1.98789537e-02]]
grads:  [-1.75280283e-02 -2.24366360e+01]
Stock Position:  -0.0175280283033183
Bond Position:  [5.54448822]


portfolio before change:  [3.80373646]
curr_Stock_Price:  99.35201119268113
curr_Factors:  [9.93520112e+01 4.67585794e-02]
mat_Sqrt:  [[ 2.14836128e+01  0.00000000e+00]
 [-8.64949288e-03  1.98184779e-02]]
grads:  [5.03038790e-03 6.86842937e+00]
Stock Position:  0.005030387896518438
Bond Position:  [3.30395731]


portfolio before change:  [3.80116592]
curr_Stock_Price:  98.75890297779264
curr_Factors:  [9.87589030e+01 4.78318177e-02]
mat_Sqrt:  [[ 2.15990525e+01  0.00000000e+00]
 [-8.74819458e-03  2.00446319e-02]]
grads:  [0.00736066 3.27225543]
Stock Position:  0.007360661877148469
Bond Position:  [3.07423503]


portfolio before change:  [3.79071729]
curr_Stock_Price:  97.28716982343636
curr_Factors:  [9.72871698e+01 4.60282996e-02]
mat_Sqrt:  [[ 2.08721908e+01  0.00000000e+00]
 [-8.58168278e-03  1.96631055e-02]]
grads:  [-0.02917375 -8.74097241]
Stock Position:  -0.02917374859405078
Bond Position:  [6.62894873]


portfolio before change:  [3.7522469]
curr_Stock_Price:  98.63423936066472
curr_Factors:  [9.86342394e+01 4.83314639e-02]
mat_Sqrt:  [[ 2.16841636e+01  0.00000000e+00]
 [-8.79376724e-03  2.01490520e-02]]
grads:  [-0.00883705 -2.99116927]
Stock Position:  -0.008837045378749494
Bond Position:  [4.62388215]


portfolio before change:  [3.74145556]
curr_Stock_Price:  99.92079597559119
curr_Factors:  [9.99207960e+01 4.82395021e-02]
mat_Sqrt:  [[ 2.19460969e+01  0.00000000e+00]
 [-8.78539716e-03  2.01298738e-02]]
grads:  [-1.1499331e-03 -3.6580570e+00]
Stock Position:  -0.0011499331011452837
Bond Position:  [3.85635779]


portfolio before change:  [3.74152775]
curr_Stock_Price:  100.2772358016273
curr_Factors:  [1.00277236e+02 4.81796739e-02]
mat_Sqrt:  [[ 2.20107217e+01  0.00000000e+00]
 [-8.77994751e-03  2.01173870e-02]]
grads:  [-6.95496603e-03  7.01991255e+00]
Stock Position:  -0.006954966032920527
Bond Position:  [4.43895252]


portfolio before change:  [3.7356501]
curr_Stock_Price:  101.20212278119837
curr_Factors:  [1.01202123e+02 4.64505538e-02]
mat_Sqrt:  [[ 2.18114767e+01  0.00000000e+00]
 [-8.62095621e-03  1.97530922e-02]]
grads:  [0.00418875 3.18354717]
Stock Position:  0.004188749630666635
Bond Position:  [3.31173974]


portfolio before change:  [3.73901634]
curr_Stock_Price:  101.90692810873117
curr_Factors:  [1.01906928e+02 4.61807245e-02]
mat_Sqrt:  [[ 2.18994940e+01  0.00000000e+00]
 [-8.59588036e-03  1.96956362e-02]]
grads:  [-0.00432282  4.12909465]
Stock Position:  -0.00432282182337922
Bond Position:  [4.17954184]


portfolio before change:  [3.73754552]
curr_Stock_Price:  102.3680375702067
curr_Factors:  [1.02368038e+02 4.64633588e-02]
mat_Sqrt:  [[ 2.20658001e+01  0.00000000e+00]
 [-8.62214440e-03  1.97558147e-02]]
grads:  [-0.01128964  2.49160934]
Stock Position:  -0.011289643109354475
Bond Position:  [4.89324413]


portfolio before change:  [3.73493923]
curr_Stock_Price:  102.65307658071049
curr_Factors:  [1.02653077e+02 4.65866329e-02]
mat_Sqrt:  [[ 2.21565752e+01  0.00000000e+00]
 [-8.63357473e-03  1.97820049e-02]]
grads:  [-5.02872449e-03 -9.97961960e+00]
Stock Position:  -0.0050287244905253105
Bond Position:  [4.25115327]


portfolio before change:  [3.73407011]
curr_Stock_Price:  102.93158629663617
curr_Factors:  [1.02931586e+02 4.59007407e-02]
mat_Sqrt:  [[ 2.20525346e+01  0.00000000e+00]
 [-8.56978326e-03  1.96358402e-02]]
grads:  [-1.27835314e-03 -2.86100491e+00]
Stock Position:  -0.0012783531425145816
Bond Position:  [3.86565303]


portfolio before change:  [3.73423592]
curr_Stock_Price:  103.17989148107259
curr_Factors:  [1.03179891e+02 4.57505228e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.73423592]
Stock Price:  103.24286851373236
PL:  [0.49136741]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.44441842e+00  3.55455280e-01]
 [-2.31931992e-01 -8.52922844e-02]
 [-2.17578052e-01 -1.13228317e-01]
 [-4.72294304e-02 -1.29797736e-01]
 [-1.26369954e-01 -8.39664363e-01]
 [-2.68389771e-01  8.81902818e-02]
 [ 1.32837150e-01 -8.14584286e-02]
 [ 2.47424041e-01  4.56246910e-01]
 [-1.03704447e-01 -3.30398363e-02]
 [-1.38520821e-01 -4.02421766e-01]
 [-7.39801504e-02 -1.17187116e-02]
 [-4.38049282e-02 -1.33200564e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.40311111e-02 -4.92372553e-02]
 [ 1.09477010e-01  6.41552339e-02]
 [ 1.12982870e-01 -7.35191212e-01]
 [ 2.19966810e-02 -2.29279126e-01]
 [ 3.33838899e-02 -1.55002408e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.16014400e-01 -2.03214786e-02]
 [ 4.07691282e-01 -3.39280385e-01]
 [ 2.75288255e-02 -3.41170607e-01]
 [ 4.06135756e-02  3.19502267e-02]
 [ 4.53974919e-01 -4.44513191e-01]
 [-4.52339039e-01  6.30057689e-02]
 [-1.20737053e-01  2.03362891e-01]
 [-1.23842197e-01 -2.24739989e-01]
 [-8.71956734e-02  2.16875738e-01]
 [-6.27454553e-01  3.60152989e-01]
 [-1.16093771e-01  3.42518304e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.05561424e-01 -1.06976947e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.84348515e-01  3.89068937e-02]
 [-2.84855894e-02 -1.67545180e-01]
 [-1.01690358e-02 -6.33972681e-02]
 [ 1.77889144e-01 -1.55118279e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.84745244]
curr_Stock_Price:  99.48774890556693
curr_Factors:  [9.94877489e+01 3.94701069e-02]
mat_Sqrt:  [[ 1.97653157e+01  0.00000000e+00]
 [-7.94683403e-03  1.82084842e-02]]
grads:  [ 0.08092721 19.52140968]
Stock Position:  0.08092720851617352
Bond Position:  [-8.89871824]


portfolio before change:  [-0.6818694]
curr_Stock_Price:  101.54756854253182
curr_Factors:  [1.01547569e+02 3.91391289e-02]
mat_Sqrt:  [[ 2.00897766e+01  0.00000000e+00]
 [-7.91344465e-03  1.81319796e-02]]
grads:  [-0.01339769 -4.70396981]
Stock Position:  -0.01339768989700829
Bond Position:  [0.67863344]


portfolio before change:  [-0.68444639]
curr_Stock_Price:  101.74624623243447
curr_Factors:  [1.01746246e+02 4.08398944e-02]
mat_Sqrt:  [[ 2.05617796e+01  0.00000000e+00]
 [-8.08355312e-03  1.85217470e-02]]
grads:  [-0.01298501 -6.11326332]
Stock Position:  -0.012985011291582499
Bond Position:  [0.63672977]


portfolio before change:  [-0.70174369]
curr_Stock_Price:  103.08447409990694
curr_Factors:  [1.03084474e+02 4.06642371e-02]
mat_Sqrt:  [[ 2.07873713e+01  0.00000000e+00]
 [-8.06615022e-03  1.84818720e-02]]
grads:  [-4.99715932e-03 -7.02297558e+00]
Stock Position:  -0.00499715931970069
Bond Position:  [-0.18661415]


portfolio before change:  [-0.70769025]
curr_Stock_Price:  104.26979374467219
curr_Factors:  [1.04269794e+02 4.10657602e-02]
mat_Sqrt:  [[ 2.11299490e+01  0.00000000e+00]
 [-8.10587542e-03  1.85728938e-02]]
grads:  [-2.33237442e-02 -4.52091295e+01]
Stock Position:  -0.02332374423287226
Bond Position:  [1.72427175]


portfolio before change:  [-0.6300502]
curr_Stock_Price:  100.95023642275046
curr_Factors:  [1.00950236e+02 4.27393194e-02]
mat_Sqrt:  [[ 2.08699371e+01  0.00000000e+00]
 [-8.26939605e-03  1.89475667e-02]]
grads:  [-0.01101586  4.65443839]
Stock Position:  -0.011015863374249257
Bond Position:  [0.48200381]


portfolio before change:  [-0.63110121]
curr_Stock_Price:  101.05111522941615
curr_Factors:  [1.01051115e+02 4.04446905e-02]
mat_Sqrt:  [[ 2.03222537e+01  0.00000000e+00]
 [-8.04434614e-03  1.84319126e-02]]
grads:  [ 0.00478715 -4.41942356]
Stock Position:  0.004787154955788044
Bond Position:  [-1.11484856]


portfolio before change:  [-0.63387985]
curr_Stock_Price:  100.49979050084225
curr_Factors:  [1.00499791e+02 4.08738392e-02]
mat_Sqrt:  [[ 2.03183236e+01  0.00000000e+00]
 [-8.08691182e-03  1.85294428e-02]]
grads:  [2.19775276e-02 2.46228079e+01]
Stock Position:  0.021977527581097653
Bond Position:  [-2.84261677]


portfolio before change:  [-0.62882771]
curr_Stock_Price:  100.74583685422637
curr_Factors:  [1.00745837e+02 4.14635330e-02]
mat_Sqrt:  [[ 2.05144681e+01  0.00000000e+00]
 [-8.14503854e-03  1.86626278e-02]]
grads:  [-0.00575809 -1.77037428]
Stock Position:  -0.005758092917591898
Bond Position:  [-0.04872382]


portfolio before change:  [-0.63766078]
curr_Stock_Price:  102.27880609661173
curr_Factors:  [1.02278806e+02 4.17746662e-02]
mat_Sqrt:  [[ 2.09046136e+01  0.00000000e+00]
 [-8.17554071e-03  1.87325171e-02]]
grads:  [-1.50278826e-02 -2.14825250e+01]
Stock Position:  -0.015027882605889074
Bond Position:  [0.89937311]


portfolio before change:  [-0.64999719]
curr_Stock_Price:  103.10718868470794
curr_Factors:  [1.03107189e+02 4.24798125e-02]
mat_Sqrt:  [[ 2.12510426e+01  0.00000000e+00]
 [-8.24425255e-03  1.88899557e-02]]
grads:  [-0.00372192 -0.62036735]
Stock Position:  -0.003721916946081412
Bond Position:  [-0.2662408]


portfolio before change:  [-0.64799138]
curr_Stock_Price:  102.55932831188207
curr_Factors:  [1.02559328e+02 4.12332475e-02]
mat_Sqrt:  [[ 2.08256679e+01  0.00000000e+00]
 [-8.12238857e-03  1.86107302e-02]]
grads:  [-4.89484519e-03 -7.15719170e+00]
Stock Position:  -0.004894845185508891
Bond Position:  [-0.14597935]


portfolio before change:  [-0.65120179]
curr_Stock_Price:  103.21147641358444
curr_Factors:  [1.03211476e+02 4.01043300e-02]
mat_Sqrt:  [[ 2.06691979e+01  0.00000000e+00]
 [-8.01042621e-03  1.83541922e-02]]
grads:  [-0.00316943 -0.97470936]
Stock Position:  -0.0031694273488231907
Bond Position:  [-0.32408052]


portfolio before change:  [-0.64675911]
curr_Stock_Price:  101.79696285598054
curr_Factors:  [1.01796963e+02 4.08237941e-02]
mat_Sqrt:  [[ 2.05679735e+01  0.00000000e+00]
 [-8.08195957e-03  1.85180958e-02]]
grads:  [-0.00269934 -2.65887249]
Stock Position:  -0.0026993427986790977
Bond Position:  [-0.37197421]


portfolio before change:  [-0.65082712]
curr_Stock_Price:  103.28677524545314
curr_Factors:  [1.03286775e+02 3.98764779e-02]
mat_Sqrt:  [[ 2.06254349e+01  0.00000000e+00]
 [-7.98763824e-03  1.83019784e-02]]
grads:  [0.00666539 3.50537152]
Stock Position:  0.006665393972308832
Bond Position:  [-1.33927417]


portfolio before change:  [-0.64802923]
curr_Stock_Price:  103.73165752036861
curr_Factors:  [1.03731658e+02 4.05269204e-02]
mat_Sqrt:  [[ 2.08825303e+01  0.00000000e+00]
 [-8.05251965e-03  1.84506404e-02]]
grads:  [-9.95477451e-03 -3.98463791e+01]
Stock Position:  -0.009954774505747433
Bond Position:  [0.38459603]


portfolio before change:  [-0.6520878]
curr_Stock_Price:  104.14418799939249
curr_Factors:  [1.04144188e+02 4.15062951e-02]
mat_Sqrt:  [[ 2.12173931e+01  0.00000000e+00]
 [-8.14923752e-03  1.86722489e-02]]
grads:  [-3.67947811e-03 -1.22791383e+01]
Stock Position:  -0.0036794781056876747
Bond Position:  [-0.26889154]


portfolio before change:  [-0.64840294]
curr_Stock_Price:  103.13359132252506
curr_Factors:  [1.03133591e+02 4.22259120e-02]
mat_Sqrt:  [[ 2.11928644e+01  0.00000000e+00]
 [-8.21957780e-03  1.88334187e-02]]
grads:  [-1.61680395e-03 -8.23017904e+00]
Stock Position:  -0.0016168039549325974
Bond Position:  [-0.48165614]


portfolio before change:  [-0.64770072]
curr_Stock_Price:  102.66202190027747
curr_Factors:  [1.02662022e+02 4.21710975e-02]
mat_Sqrt:  [[ 2.10822649e+01  0.00000000e+00]
 [-8.21424105e-03  1.88211907e-02]]
grads:  [-1.51204411e-02 -2.49340040e+01]
Stock Position:  -0.015120441114897314
Bond Position:  [0.90459434]


portfolio before change:  [-0.65996536]
curr_Stock_Price:  103.48063072367742
curr_Factors:  [1.03480631e+02 4.20020735e-02]
mat_Sqrt:  [[ 2.12077421e+01  0.00000000e+00]
 [-8.19776297e-03  1.87834347e-02]]
grads:  [-2.28506505e-04 -5.80795745e+00]
Stock Position:  -0.00022850650451466974
Bond Position:  [-0.63631937]


portfolio before change:  [-0.66043727]
curr_Stock_Price:  105.1977208238253
curr_Factors:  [1.05197721e+02 4.06616503e-02]
mat_Sqrt:  [[ 2.12128407e+01  0.00000000e+00]
 [-8.06589366e-03  1.84812841e-02]]
grads:  [ 0.00505097 -1.0995707 ]
Stock Position:  0.005050967987304295
Bond Position:  [-1.19178759]


portfolio before change:  [-0.66894702]
curr_Stock_Price:  103.54244193150134
curr_Factors:  [1.03542442e+02 4.02724121e-02]
mat_Sqrt:  [[ 2.07788843e+01  0.00000000e+00]
 [-8.02719499e-03  1.83926143e-02]]
grads:  [ 1.24942792e-02 -1.84465557e+01]
Stock Position:  0.012494279249859
Bond Position:  [-1.9626352]


portfolio before change:  [-0.661291]
curr_Stock_Price:  104.17484069323048
curr_Factors:  [1.04174841e+02 4.07469302e-02]
mat_Sqrt:  [[ 2.10285967e+01  0.00000000e+00]
 [-8.07434755e-03  1.85006544e-02]]
grads:  [-5.77167540e-03 -1.84410021e+01]
Stock Position:  -0.005771675402101152
Bond Position:  [-0.06002763]


portfolio before change:  [-0.65915315]
curr_Stock_Price:  103.80313734790523
curr_Factors:  [1.03803137e+02 4.02452303e-02]
mat_Sqrt:  [[ 2.08241694e+01  0.00000000e+00]
 [-8.02448556e-03  1.83864062e-02]]
grads:  [0.00261993 1.73770917]
Stock Position:  0.0026199267118846414
Bond Position:  [-0.93110976]


portfolio before change:  [-0.65425574]
curr_Stock_Price:  105.71685770069706
curr_Factors:  [1.05716858e+02 3.76060619e-02]
mat_Sqrt:  [[ 2.05009117e+01  0.00000000e+00]
 [-7.75691299e-03  1.77733205e-02]]
grads:  [ 1.26810681e-02 -2.50101376e+01]
Stock Position:  0.012681068149313832
Bond Position:  [-1.99485841]


portfolio before change:  [-0.65062081]
curr_Stock_Price:  106.02316462006776
curr_Factors:  [1.06023165e+02 3.81448856e-02]
mat_Sqrt:  [[ 2.07070829e+01  0.00000000e+00]
 [-7.81228628e-03  1.79001966e-02]]
grads:  [-0.0205167   3.51983669]
Stock Position:  -0.020516702886462533
Bond Position:  [1.52462496]


portfolio before change:  [-0.67623502]
curr_Stock_Price:  107.28091048752665
curr_Factors:  [1.07280910e+02 3.84875679e-02]
mat_Sqrt:  [[ 2.10466357e+01  0.00000000e+00]
 [-7.84729944e-03  1.79804219e-02]]
grads:  [-1.51958782e-03  1.13102403e+01]
Stock Position:  -0.0015195878241020906
Bond Position:  [-0.51321225]


portfolio before change:  [-0.67575737]
curr_Stock_Price:  106.92436167568573
curr_Factors:  [1.06924362e+02 3.84996330e-02]
mat_Sqrt:  [[ 2.09799747e+01  0.00000000e+00]
 [-7.84852934e-03  1.79832399e-02]]
grads:  [-1.05780285e-02 -1.24971913e+01]
Stock Position:  -0.010578028467094974
Bond Position:  [0.45529157]


portfolio before change:  [-0.66928094]
curr_Stock_Price:  106.31748968320237
curr_Factors:  [1.06317490e+02 3.96163041e-02]
mat_Sqrt:  [[ 2.11612682e+01  0.00000000e+00]
 [-7.96153796e-03  1.82421752e-02]]
grads:  [3.52372954e-04 1.18886995e+01]
Stock Position:  0.00035237295411330935
Bond Position:  [-0.70674435]


portfolio before change:  [-0.66931383]
curr_Stock_Price:  106.47487374401508
curr_Factors:  [1.06474874e+02 3.93421208e-02]
mat_Sqrt:  [[ 2.11191297e+01  0.00000000e+00]
 [-7.93393932e-03  1.81789388e-02]]
grads:  [-0.02226753 19.81155195]
Stock Position:  -0.022267532243920845
Bond Position:  [1.70161885]


portfolio before change:  [-0.68886254]
curr_Stock_Price:  107.36232825213816
curr_Factors:  [1.07362328e+02 3.75334120e-02]
mat_Sqrt:  [[ 2.07998855e+01  0.00000000e+00]
 [-7.74941671e-03  1.77561443e-02]]
grads:  [-0.00486277  1.92901284]
Stock Position:  -0.004862769398060014
Bond Position:  [-0.1667843]


portfolio before change:  [-0.68232438]
curr_Stock_Price:  106.01350538559522
curr_Factors:  [1.06013505e+02 3.82801912e-02]
mat_Sqrt:  [[ 2.07418860e+01  0.00000000e+00]
 [-7.82612969e-03  1.79319158e-02]]
grads:  [ 0.0034974 -0.6662528]
Stock Position:  0.003497396360431919
Bond Position:  [-1.05309562]


portfolio before change:  [-0.67738582]
curr_Stock_Price:  107.46321139093396
curr_Factors:  [1.07463211e+02 3.79341281e-02]
mat_Sqrt:  [[ 2.09302718e+01  0.00000000e+00]
 [-7.79067423e-03  1.78506772e-02]]
grads:  [-0.01205192 -5.99287892]
Stock Position:  -0.012051921443069937
Bond Position:  [0.61775236]


portfolio before change:  [-0.6642552]
curr_Stock_Price:  106.38011399323847
curr_Factors:  [1.06380114e+02 3.74510884e-02]
mat_Sqrt:  [[ 2.05869814e+01  0.00000000e+00]
 [-7.74091347e-03  1.77366610e-02]]
grads:  [0.0049289  3.00784127]
Stock Position:  0.004928899945302725
Bond Position:  [-1.18859213]


portfolio before change:  [-0.67063969]
curr_Stock_Price:  105.11494165938164
curr_Factors:  [1.05114942e+02 3.73795083e-02]
mat_Sqrt:  [[ 2.03226925e+01  0.00000000e+00]
 [-7.73351235e-03  1.77197029e-02]]
grads:  [-0.00465822  4.58953216]
Stock Position:  -0.004658221878673717
Bond Position:  [-0.18099097]


portfolio before change:  [-0.66011821]
curr_Stock_Price:  102.85139548036557
curr_Factors:  [1.02851395e+02 3.77662759e-02]
mat_Sqrt:  [[ 1.99876745e+01  0.00000000e+00]
 [-7.77341890e-03  1.78111403e-02]]
grads:  [-0.01337665  2.18441342]
Stock Position:  -0.01337665141256613
Bond Position:  [0.71568905]


portfolio before change:  [-0.68953373]
curr_Stock_Price:  105.05710324145006
curr_Factors:  [1.05057103e+02 3.59302786e-02]
mat_Sqrt:  [[ 1.99138721e+01  0.00000000e+00]
 [-7.58211354e-03  1.73728046e-02]]
grads:  [-5.10238793e-03 -9.64410661e+00]
Stock Position:  -0.005102387928240635
Bond Position:  [-0.15349163]


portfolio before change:  [-0.68822006]
curr_Stock_Price:  104.79588190358102
curr_Factors:  [1.04795882e+02 3.55471843e-02]
mat_Sqrt:  [[ 1.97581746e+01  0.00000000e+00]
 [-7.54158437e-03  1.72799406e-02]]
grads:  [-1.91504897e-03 -3.66883599e+00]
Stock Position:  -0.0019150489699638418
Bond Position:  [-0.48753082]


portfolio before change:  [-0.6906207]
curr_Stock_Price:  106.01762177114152
curr_Factors:  [1.06017622e+02 3.52014129e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.6906207]
Stock Price:  106.11178245720708
PL:  [-6.80240316]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.00415864e+00  2.55921365e-01]
 [ 5.68021312e-02  4.25542015e-02]
 [-7.63976055e-02 -7.75964123e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.09592284e-01 -2.29719090e-01]
 [-3.79211758e-01  2.15540115e-01]
 [ 2.02435838e-01 -2.13378335e-01]
 [-5.73361658e-01  2.21555970e-01]
 [-1.18062159e-01 -9.94092299e-02]
 [-2.54112751e-01 -5.10515623e-01]
 [-6.24955353e-02 -1.41233713e-02]
 [-1.45108997e-01 -1.89240042e-01]
 [-5.18475121e-02 -2.61808820e-02]
 [ 2.06758509e-02 -2.04541441e-01]
 [ 3.43891873e-01  2.09914995e-01]
 [ 1.33618976e-01 -3.46234415e-01]
 [ 3.72730201e-02 -3.81189626e-02]
 [ 2.74710418e-02 -1.48555450e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-6.83933044e-02 -4.40161618e-02]
 [ 1.75835762e-01 -4.29402808e-02]
 [ 7.74024645e-01 -4.96639040e-02]
 [ 2.15377237e-02  3.27921371e-02]
 [-7.14494748e-03  3.44022018e-02]
 [-8.13745726e-02  5.90445479e-02]
 [ 1.15313916e-01 -1.08536558e-01]
 [-6.52804424e-02 -3.67982953e-01]
 [ 4.70107913e-02  1.02920720e-01]
 [ 8.60163217e-02  9.93282353e-02]
 [-5.41940673e-01 -1.13493156e-01]
 [-1.64849033e-01 -5.97544841e-02]
 [ 2.44245529e-03 -5.33122947e-02]
 [-3.69575416e-02  1.69623318e-01]
 [ 4.19451435e-03  1.29739589e-02]
 [-6.32862082e-03  1.30796480e-02]
 [-7.35572490e-02  1.19138824e-01]
 [-3.82932867e-02 -8.22240294e-02]
 [-2.23576456e-01 -9.07332080e-02]
 [ 1.20790219e-01 -8.55059961e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.53325475]
curr_Stock_Price:  101.72033492239348
curr_Factors:  [1.01720335e+02 3.71473244e-02]
mat_Sqrt:  [[ 1.96052123e+01  0.00000000e+00]
 [-7.70945647e-03  1.76645839e-02]]
grads:  [ 0.05691608 14.48782297]
Stock Position:  0.05691608227962501
Bond Position:  [8.7437318]


portfolio before change:  [14.48541563]
curr_Stock_Price:  100.86061038247661
curr_Factors:  [1.00860610e+02 3.72466325e-02]
mat_Sqrt:  [[ 1.94654792e+01  0.00000000e+00]
 [-7.71975466e-03  1.76881800e-02]]
grads:  [0.0038722  2.40579875]
Stock Position:  0.0038722040517152846
Bond Position:  [14.09486277]


portfolio before change:  [14.48870371]
curr_Stock_Price:  101.25473037378599
curr_Factors:  [1.01254730e+02 3.42113355e-02]
mat_Sqrt:  [[ 1.87283853e+01  0.00000000e+00]
 [-7.39852261e-03  1.69521449e-02]]
grads:  [-0.0058875  -4.57738018]
Stock Position:  -0.00588750468622218
Bond Position:  [15.08484141]


portfolio before change:  [14.49021216]
curr_Stock_Price:  101.31881072827818
curr_Factors:  [1.01318811e+02 3.39615214e-02]
mat_Sqrt:  [[ 1.86716910e+01  0.00000000e+00]
 [-7.37146080e-03  1.68901385e-02]]
grads:  [-8.73052523e-04 -8.96302964e+00]
Stock Position:  -0.0008730525226541321
Bond Position:  [14.57866881]


portfolio before change:  [14.49189237]
curr_Stock_Price:  101.48173593354377
curr_Factors:  [1.01481736e+02 3.33142745e-02]
mat_Sqrt:  [[ 1.85226477e+01  0.00000000e+00]
 [-7.30087934e-03  1.67284161e-02]]
grads:  [-1.13293692e-02 -1.37322678e+01]
Stock Position:  -0.011329369164422416
Bond Position:  [15.64161642]


portfolio before change:  [14.48351402]
curr_Stock_Price:  102.39385013366149
curr_Factors:  [1.02393850e+02 3.20502087e-02]
mat_Sqrt:  [[ 1.83311328e+01  0.00000000e+00]
 [-7.16102883e-03  1.64079783e-02]]
grads:  [-0.01555509 13.13629932]
Stock Position:  -0.015555085564882908
Bond Position:  [16.07625912]


portfolio before change:  [14.49247535]
curr_Stock_Price:  101.94694314761341
curr_Factors:  [1.01946943e+02 3.07137714e-02]
mat_Sqrt:  [[ 1.78665534e+01  0.00000000e+00]
 [-7.01013796e-03  1.60622439e-02]]
grads:  [ 6.11813005e-03 -1.32844661e+01]
Stock Position:  0.0061181300461196466
Bond Position:  [13.86875069]


portfolio before change:  [14.4996691]
curr_Stock_Price:  102.83937995847647
curr_Factors:  [1.02839380e+02 3.04267153e-02]
mat_Sqrt:  [[ 1.79385355e+01  0.00000000e+00]
 [-6.97730210e-03  1.59870075e-02]]
grads:  [-0.02657222 13.85850168]
Stock Position:  -0.026572219609076728
Bond Position:  [17.23233969]


portfolio before change:  [14.50356596]
curr_Stock_Price:  102.77379701686353
curr_Factors:  [1.02773797e+02 3.18559088e-02]
mat_Sqrt:  [[ 1.83432972e+01  0.00000000e+00]
 [-7.13928947e-03  1.63581672e-02]]
grads:  [-0.00880147 -6.0770396 ]
Stock Position:  -0.008801465850064345
Bond Position:  [15.40812602]


portfolio before change:  [14.50285199]
curr_Stock_Price:  103.07375857235078
curr_Factors:  [1.03073759e+02 3.13212591e-02]
mat_Sqrt:  [[ 1.82418012e+01  0.00000000e+00]
 [-7.07912527e-03  1.62203137e-02]]
grads:  [-2.6144350e-02 -3.1473844e+01]
Stock Position:  -0.026144349962576214
Bond Position:  [17.19764841]


portfolio before change:  [14.5181657]
curr_Stock_Price:  102.57025144888311
curr_Factors:  [1.02570251e+02 2.97634651e-02]
mat_Sqrt:  [[ 1.76955133e+01  0.00000000e+00]
 [-6.90083649e-03  1.58118028e-02]]
grads:  [-0.00388005 -0.89321701]
Stock Position:  -0.0038800501859781967
Bond Position:  [14.91614342]


portfolio before change:  [14.51495808]
curr_Stock_Price:  103.8775165121749
curr_Factors:  [1.03877517e+02 3.02801296e-02]
mat_Sqrt:  [[ 1.80759205e+01  0.00000000e+00]
 [-6.96047465e-03  1.59484510e-02]]
grads:  [ -0.01259688 -11.86573182]
Stock Position:  -0.012596875645173613
Bond Position:  [15.82349024]


portfolio before change:  [14.51494911]
curr_Stock_Price:  104.03525605089523
curr_Factors:  [1.04035256e+02 2.99527823e-02]
mat_Sqrt:  [[ 1.80052487e+01  0.00000000e+00]
 [-6.92274885e-03  1.58620103e-02]]
grads:  [-0.00351419 -1.65053997]
Stock Position:  -0.0035141855961314
Bond Position:  [14.88054831]


portfolio before change:  [14.52037346]
curr_Stock_Price:  103.02103523422151
curr_Factors:  [1.03021035e+02 2.94399660e-02]
mat_Sqrt:  [[ 1.76764301e+01  0.00000000e+00]
 [-6.86323142e-03  1.57256387e-02]]
grads:  [-3.88049803e-03 -1.30068765e+01]
Stock Position:  -0.0038804980303757935
Bond Position:  [14.92014638]


portfolio before change:  [14.52875615]
curr_Stock_Price:  101.34146780642003
curr_Factors:  [1.01341468e+02 2.92557001e-02]
mat_Sqrt:  [[ 1.73337464e+01  0.00000000e+00]
 [-6.84171910e-03  1.56763478e-02]]
grads:  [ 0.02512476 13.39055485]
Stock Position:  0.02512476401508944
Bond Position:  [11.98257569]


portfolio before change:  [14.51668468]
curr_Stock_Price:  100.80138765677283
curr_Factors:  [1.00801388e+02 2.84467464e-02]
mat_Sqrt:  [[ 1.70013266e+01  0.00000000e+00]
 [-6.74646532e-03  1.54580940e-02]]
grads:  [-1.02874978e-03 -2.23982604e+01]
Stock Position:  -0.001028749782931156
Bond Position:  [14.62038409]


portfolio before change:  [14.51817327]
curr_Stock_Price:  101.13098136878169
curr_Factors:  [1.01130981e+02 2.78226533e-02]
mat_Sqrt:  [[ 1.68687730e+01  0.00000000e+00]
 [-6.67204955e-03  1.52875861e-02]]
grads:  [ 1.22335756e-03 -2.49345858e+00]
Stock Position:  0.0012233575613084288
Bond Position:  [14.39445392]


portfolio before change:  [14.51974532]
curr_Stock_Price:  100.94512012496216
curr_Factors:  [1.00945120e+02 2.78504227e-02]
mat_Sqrt:  [[ 1.68461718e+01  0.00000000e+00]
 [-6.67537836e-03  1.52952133e-02]]
grads:  [-2.21794439e-03 -9.71254517e+00]
Stock Position:  -0.0022179443850915293
Bond Position:  [14.74363598]


portfolio before change:  [14.52358438]
curr_Stock_Price:  100.04518994078377
curr_Factors:  [1.00045190e+02 2.72756951e-02]
mat_Sqrt:  [[ 1.65228183e+01  0.00000000e+00]
 [-6.60614200e-03  1.51365729e-02]]
grads:  [-1.92929039e-02 -3.10035599e+01]
Stock Position:  -0.019292903857641173
Bond Position:  [16.45374661]


portfolio before change:  [14.5284633]
curr_Stock_Price:  99.89891493992353
curr_Factors:  [9.98989149e+01 2.77171763e-02]
mat_Sqrt:  [[ 1.66316472e+01  0.00000000e+00]
 [-6.65939052e-03  1.52585806e-02]]
grads:  [-0.00526728 -2.8846826 ]
Stock Position:  -0.0052672793835270805
Bond Position:  [15.0546588]


portfolio before change:  [14.5267732]
curr_Stock_Price:  100.57707363832971
curr_Factors:  [1.00577074e+02 2.75436440e-02]
mat_Sqrt:  [[ 1.66920506e+01  0.00000000e+00]
 [-6.63851116e-03  1.52107399e-02]]
grads:  [ 0.00941137 -2.8230238 ]
Stock Position:  0.009411371356105876
Bond Position:  [13.58020501]


portfolio before change:  [14.52583278]
curr_Stock_Price:  100.29676866157448
curr_Factors:  [1.00296769e+02 2.71830173e-02]
mat_Sqrt:  [[ 1.65362021e+01  0.00000000e+00]
 [-6.59490922e-03  1.51108354e-02]]
grads:  [ 0.04549712 -3.28664185]
Stock Position:  0.04549711808315461
Bond Position:  [9.96261885]


portfolio before change:  [14.44778513]
curr_Stock_Price:  98.55395381522142
curr_Factors:  [9.85539538e+01 2.94435693e-02]
mat_Sqrt:  [[ 1.69109996e+01  0.00000000e+00]
 [-6.86365143e-03  1.57266011e-02]]
grads:  [0.00211989 2.08513822]
Stock Position:  0.0021198856577844785
Bond Position:  [14.23886202]


portfolio before change:  [14.45274326]
curr_Stock_Price:  100.05316585610841
curr_Factors:  [1.00053166e+02 2.85851298e-02]
mat_Sqrt:  [[ 1.69161263e+01  0.00000000e+00]
 [-6.76285500e-03  1.54956475e-02]]
grads:  [4.65201320e-04 2.22012032e+00]
Stock Position:  0.00046520132045301264
Bond Position:  [14.40619839]


portfolio before change:  [14.45391462]
curr_Stock_Price:  98.69993809380324
curr_Factors:  [9.86999381e+01 2.85508732e-02]
mat_Sqrt:  [[ 1.66773321e+01  0.00000000e+00]
 [-6.75880146e-03  1.54863596e-02]]
grads:  [-3.33419151e-03  3.81268092e+00]
Stock Position:  -0.0033341915120269692
Bond Position:  [14.78299912]


portfolio before change:  [14.45716404]
curr_Stock_Price:  98.27961710405191
curr_Factors:  [9.82796171e+01 2.89107942e-02]
mat_Sqrt:  [[ 1.67106548e+01  0.00000000e+00]
 [-6.80126979e-03  1.55836668e-02]]
grads:  [ 4.06594955e-03 -6.96476374e+00]
Stock Position:  0.004065949548548482
Bond Position:  [14.05756408]


portfolio before change:  [14.46053692]
curr_Stock_Price:  98.67696028991793
curr_Factors:  [9.86769603e+01 2.91032988e-02]
mat_Sqrt:  [[ 1.68339825e+01  0.00000000e+00]
 [-6.82387559e-03  1.56354632e-02]]
grads:  [-1.34181777e-02 -2.35351488e+01]
Stock Position:  -0.013418177740330123
Bond Position:  [15.78460192]


portfolio before change:  [14.4586657]
curr_Stock_Price:  98.96346856814411
curr_Factors:  [9.89634686e+01 2.91154073e-02]
mat_Sqrt:  [[ 1.68863717e+01  0.00000000e+00]
 [-6.82529499e-03  1.56387155e-02]]
grads:  [5.44398039e-03 6.58114924e+00]
Stock Position:  0.005443980391194783
Bond Position:  [13.91991052]


portfolio before change:  [14.46200903]
curr_Stock_Price:  99.25796407240327
curr_Factors:  [9.92579641e+01 2.86155050e-02]
mat_Sqrt:  [[ 1.67905944e+01  0.00000000e+00]
 [-6.76644722e-03  1.55038783e-02]]
grads:  [0.00770471 6.40667021]
Stock Position:  0.007704713400860887
Bond Position:  [13.69725486]


portfolio before change:  [14.46139625]
curr_Stock_Price:  98.95619558924274
curr_Factors:  [9.89561956e+01 2.83701354e-02]
mat_Sqrt:  [[ 1.66676240e+01  0.00000000e+00]
 [-6.73737461e-03  1.54372646e-02]]
grads:  [-0.03548635 -7.35189548]
Stock Position:  -0.03548635051832062
Bond Position:  [17.9729905]


portfolio before change:  [14.46508688]
curr_Stock_Price:  98.91550763527422
curr_Factors:  [9.89155076e+01 2.95363208e-02]
mat_Sqrt:  [[ 1.69997519e+01  0.00000000e+00]
 [-6.87445367e-03  1.57513521e-02]]
grads:  [-0.01123122 -3.79360982]
Stock Position:  -0.01123122437610705
Bond Position:  [15.57602914]


portfolio before change:  [14.47173122]
curr_Stock_Price:  98.49727998427696
curr_Factors:  [9.84972800e+01 2.93035522e-02]
mat_Sqrt:  [[ 1.68610405e+01  0.00000000e+00]
 [-6.84731214e-03  1.56891631e-02]]
grads:  [-1.23509208e-03 -3.39803305e+00]
Stock Position:  -0.0012350920821673854
Bond Position:  [14.59338443]


portfolio before change:  [14.47347316]
curr_Stock_Price:  98.56395468787358
curr_Factors:  [9.85639547e+01 2.87184805e-02]
mat_Sqrt:  [[ 1.67031680e+01  0.00000000e+00]
 [-6.77861113e-03  1.55317493e-02]]
grads:  [2.21946782e-03 1.09210698e+01]
Stock Position:  0.0022194678154421996
Bond Position:  [14.25471363]


portfolio before change:  [14.475925]
curr_Stock_Price:  98.86578252241674
curr_Factors:  [9.88657825e+01 2.83322122e-02]
mat_Sqrt:  [[ 1.66412617e+01  0.00000000e+00]
 [-6.73287008e-03  1.54269434e-02]]
grads:  [5.92311713e-04 8.40993487e-01]
Stock Position:  0.0005923117126450329
Bond Position:  [14.41736564]


portfolio before change:  [14.47754266]
curr_Stock_Price:  98.5540819027726
curr_Factors:  [9.85540819e+01 2.84148782e-02]
mat_Sqrt:  [[ 1.66129790e+01  0.00000000e+00]
 [-6.74268531e-03  1.54494329e-02]]
grads:  [-3.73319221e-05  8.46610233e-01]
Stock Position:  -3.733192214549093e-05
Bond Position:  [14.48122188]


portfolio before change:  [14.47938383]
curr_Stock_Price:  97.72628929730932
curr_Factors:  [9.77262893e+01 2.96607374e-02]
mat_Sqrt:  [[ 1.68307078e+01  0.00000000e+00]
 [-6.88891718e-03  1.57844922e-02]]
grads:  [-1.28103961e-03  7.54784014e+00]
Stock Position:  -0.0012810396126858097
Bond Position:  [14.60457508]


portfolio before change:  [14.4806838]
curr_Stock_Price:  98.13667426279211
curr_Factors:  [9.81366743e+01 2.86317093e-02]
mat_Sqrt:  [[ 1.66056154e+01  0.00000000e+00]
 [-6.76836279e-03  1.55082674e-02]]
grads:  [-4.46709102e-03 -5.30194813e+00]
Stock Position:  -0.004467091016507899
Bond Position:  [14.91906925]


portfolio before change:  [14.49021186]
curr_Stock_Price:  96.42122672031081
curr_Factors:  [9.64212267e+01 2.96199205e-02]
mat_Sqrt:  [[ 1.65945162e+01  0.00000000e+00]
 [-6.88417553e-03  1.57736277e-02]]
grads:  [-0.0158592  -5.75220929]
Stock Position:  -0.015859195310233356
Bond Position:  [16.01937493]


portfolio before change:  [14.48838798]
curr_Stock_Price:  96.66250160601173
curr_Factors:  [9.66625016e+01 2.88002353e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.48838798]
Stock Price:  97.02379427516179
PL:  [14.48838798]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.22042446e+00  3.04814734e-01]
 [ 5.33465136e-01  1.23395973e-01]
 [ 8.11861780e-02  2.27798203e-03]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.31929212e-01  1.02330477e+00]
 [ 2.95753047e-02 -2.35290522e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 9.46815327e-01  9.52985457e-01]
 [ 4.19903531e-02  4.44590319e-01]
 [ 1.51051239e-01  3.13594598e-02]
 [-2.85718417e-02  1.73402717e-02]
 [ 7.00738330e-02 -1.17738819e-01]
 [-1.17711974e-01 -2.73164073e-02]
 [-1.34854377e-01  3.87904603e-01]
 [ 2.51517548e-01  2.07256748e-01]
 [ 1.32807541e-01 -7.49617238e-02]
 [ 4.07275943e-02  1.08169177e-01]
 [ 1.07965339e-01  8.45542594e-02]
 [-5.95409897e-02 -4.09344543e-02]
 [-3.59062933e-01  1.33718046e-01]
 [ 1.30440711e-01  3.08065847e-02]
 [ 1.29402108e+00  1.34536464e-01]
 [ 1.59728430e-02  4.16893188e-01]
 [-1.49382136e-01  1.75883463e-01]
 [-1.67168614e-01  7.85099901e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 2.63812948e-01 -4.38608612e-01]
 [ 1.11094255e-01 -3.42487023e-02]
 [ 6.63581884e-01 -3.14113013e-01]
 [-6.12248745e-01 -3.16071341e-01]
 [ 3.73878051e-01  1.40998362e-01]
 [-1.72058847e-01  2.48349009e-01]
 [ 4.00201863e-01  2.21537621e-01]
 [ 4.61392621e-02 -3.92800952e-02]
 [ 2.49967617e-01 -1.95555767e-01]
 [ 8.99641032e-02  7.61195547e-02]
 [-7.04612282e-02  4.06023972e-01]
 [-3.65314363e-01 -1.38335688e-01]
 [-1.12484000e-01  5.46700066e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.86798977]
curr_Stock_Price:  100.46252868626593
curr_Factors:  [1.00462529e+02 3.95560321e-02]
mat_Sqrt:  [[ 1.99806893e+01  0.00000000e+00]
 [-7.95547933e-03  1.82282931e-02]]
grads:  [ 0.06773823 16.72206673]
Stock Position:  0.06773822962142378
Bond Position:  [-0.93716406]


portfolio before change:  [5.81556894]
curr_Stock_Price:  99.6903845537093
curr_Factors:  [9.96903846e+01 3.99903497e-02]
mat_Sqrt:  [[ 1.99356717e+01  0.00000000e+00]
 [-7.99903491e-03  1.83280915e-02]]
grads:  [0.02946074 6.73261443]
Stock Position:  0.029460735735653
Bond Position:  [2.87861687]


portfolio before change:  [5.77848389]
curr_Stock_Price:  98.4193739889536
curr_Factors:  [9.84193740e+01 4.03514847e-02]
mat_Sqrt:  [[ 1.97701679e+01  0.00000000e+00]
 [-8.03507160e-03  1.84106619e-02]]
grads:  [0.00415679 0.12373167]
Stock Position:  0.004156786691654252
Bond Position:  [5.36937554]


portfolio before change:  [5.77441492]
curr_Stock_Price:  97.27902632856637
curr_Factors:  [9.72790263e+01 3.93597745e-02]
mat_Sqrt:  [[ 1.92994759e+01  0.00000000e+00]
 [-7.93571920e-03  1.81830170e-02]]
grads:  [-8.44653348e-04 -8.32572574e+00]
Stock Position:  -0.0008446533479427185
Bond Position:  [5.85658197]


portfolio before change:  [5.77556174]
curr_Stock_Price:  96.78805804209834
curr_Factors:  [9.67880580e+01 3.76339429e-02]
mat_Sqrt:  [[ 1.87763701e+01  0.00000000e+00]
 [-7.75978792e-03  1.77799078e-02]]
grads:  [1.67592353e-02 5.75539978e+01]
Stock Position:  0.016759235315865907
Bond Position:  [4.15346789]


portfolio before change:  [5.7739167]
curr_Stock_Price:  96.65891994456359
curr_Factors:  [9.66589199e+01 3.69064404e-02]
mat_Sqrt:  [[ 1.85691925e+01  0.00000000e+00]
 [-7.68441961e-03  1.76072173e-02]]
grads:  [ 1.03969973e-03 -1.33632998e+00]
Stock Position:  0.0010396997285665338
Bond Position:  [5.67342044]


portfolio before change:  [5.77399879]
curr_Stock_Price:  96.05573616480568
curr_Factors:  [9.60557362e+01 3.63252659e-02]
mat_Sqrt:  [[ 1.83074436e+01  0.00000000e+00]
 [-7.62367532e-03  1.74680346e-02]]
grads:  [0.00706673 5.50358923]
Stock Position:  0.0070667308807194065
Bond Position:  [5.09519875]


portfolio before change:  [5.78218473]
curr_Stock_Price:  97.12398197851059
curr_Factors:  [9.71239820e+01 3.72861193e-02]
mat_Sqrt:  [[ 1.87542660e+01  0.00000000e+00]
 [-7.72384561e-03  1.76975536e-02]]
grads:  [ 0.07266252 53.84842902]
Stock Position:  0.07266252253406762
Bond Position:  [-1.2750888]


portfolio before change:  [5.75203205]
curr_Stock_Price:  96.71120681337696
curr_Factors:  [9.67112068e+01 3.94388157e-02]
mat_Sqrt:  [[ 1.92060801e+01  0.00000000e+00]
 [-7.94368334e-03  1.82012651e-02]]
grads:  [1.22891019e-02 2.44263416e+01]
Stock Position:  0.012289101942369025
Bond Position:  [4.56353817]


portfolio before change:  [5.74567466]
curr_Stock_Price:  96.14746584528928
curr_Factors:  [9.61474658e+01 3.86204675e-02]
mat_Sqrt:  [[ 1.88949874e+01  0.00000000e+00]
 [-7.86083635e-03  1.80114388e-02]]
grads:  [0.00871859 1.74108577]
Stock Position:  0.00871858901588335
Bond Position:  [4.90740442]


portfolio before change:  [5.75150269]
curr_Stock_Price:  96.7455633845756
curr_Factors:  [9.67455634e+01 3.85254174e-02]
mat_Sqrt:  [[ 1.89891154e+01  0.00000000e+00]
 [-7.85115710e-03  1.79892609e-02]]
grads:  [-0.0011061   0.96392352]
Stock Position:  -0.0011061034831155701
Bond Position:  [5.85851329]


portfolio before change:  [5.75188415]
curr_Stock_Price:  97.06279968399272
curr_Factors:  [9.70627997e+01 3.99776147e-02]
mat_Sqrt:  [[ 1.94071272e+01  0.00000000e+00]
 [-7.99776116e-03  1.83251730e-02]]
grads:  [ 9.62965782e-04 -6.42497726e+00]
Stock Position:  0.0009629657816996847
Bond Position:  [5.658416]


portfolio before change:  [5.75276967]
curr_Stock_Price:  97.24781995320647
curr_Factors:  [9.72478200e+01 3.84210495e-02]
mat_Sqrt:  [[ 1.90618253e+01  0.00000000e+00]
 [-7.84051524e-03  1.79648773e-02]]
grads:  [-0.0068007  -1.52054516]
Stock Position:  -0.0068007039566389035
Bond Position:  [6.4141233]


portfolio before change:  [5.76959149]
curr_Stock_Price:  94.89218064217884
curr_Factors:  [9.48921806e+01 3.90788425e-02]
mat_Sqrt:  [[ 1.87586367e+01  0.00000000e+00]
 [-7.90734772e-03  1.81180097e-02]]
grads:  [1.83601144e-03 2.14098904e+01]
Stock Position:  0.0018360114424051768
Bond Position:  [5.59536836]


portfolio before change:  [5.77052086]
curr_Stock_Price:  95.01740222615034
curr_Factors:  [9.50174022e+01 3.76130458e-02]
mat_Sqrt:  [[ 1.84277539e+01  0.00000000e+00]
 [-7.75763322e-03  1.77749707e-02]]
grads:  [ 0.01855743 11.66003317]
Stock Position:  0.018557433034649323
Bond Position:  [4.00724178]


portfolio before change:  [5.7772665]
curr_Stock_Price:  95.35390896947516
curr_Factors:  [9.53539090e+01 3.78399631e-02]
mat_Sqrt:  [[ 1.85487161e+01  0.00000000e+00]
 [-7.78099871e-03  1.78285078e-02]]
grads:  [ 0.00539615 -4.20459888]
Stock Position:  0.005396145067158347
Bond Position:  [5.26272297]


portfolio before change:  [5.7816338]
curr_Stock_Price:  96.04132916415888
curr_Factors:  [9.60413292e+01 3.76724478e-02]
mat_Sqrt:  [[ 1.86410376e+01  0.00000000e+00]
 [-7.76375660e-03  1.77890011e-02]]
grads:  [4.71736045e-03 6.08067738e+00]
Stock Position:  0.004717360448352597
Bond Position:  [5.32857223]


portfolio before change:  [5.7862007]
curr_Stock_Price:  96.86823022452977
curr_Factors:  [9.68682302e+01 3.70292739e-02]
mat_Sqrt:  [[ 1.86403457e+01  0.00000000e+00]
 [-7.69719678e-03  1.76364934e-02]]
grads:  [0.00777174 4.79427839]
Stock Position:  0.00777173586390435
Bond Position:  [5.03336641]


portfolio before change:  [5.78924085]
curr_Stock_Price:  97.17844922857208
curr_Factors:  [9.71784492e+01 3.74497575e-02]
mat_Sqrt:  [[ 1.88059150e+01  0.00000000e+00]
 [-7.74077593e-03  1.77363458e-02]]
grads:  [-0.00411606 -2.30794182]
Stock Position:  -0.004116058707822198
Bond Position:  [6.18923306]


portfolio before change:  [5.79178834]
curr_Stock_Price:  96.74750795217051
curr_Factors:  [9.67475080e+01 3.54707451e-02]
mat_Sqrt:  [[ 1.82211147e+01  0.00000000e+00]
 [-7.53347145e-03  1.72613516e-02]]
grads:  [-0.01650303  7.746673  ]
Stock Position:  -0.01650302944170034
Bond Position:  [7.38841531]


portfolio before change:  [5.79308283]
curr_Stock_Price:  96.72503403192117
curr_Factors:  [9.67250340e+01 3.62611826e-02]
mat_Sqrt:  [[ 1.84187381e+01  0.00000000e+00]
 [-7.61694769e-03  1.74526197e-02]]
grads:  [0.00781193 1.76515533]
Stock Position:  0.0078119253343477075
Bond Position:  [5.03747409]


portfolio before change:  [5.79350231]
curr_Stock_Price:  96.69812000377694
curr_Factors:  [9.66981200e+01 3.72189631e-02]
mat_Sqrt:  [[ 1.86552110e+01  0.00000000e+00]
 [-7.71688674e-03  1.76816088e-02]]
grads:  [0.07251259 7.60883614]
Stock Position:  0.07251258701270938
Bond Position:  [-1.21832853]


portfolio before change:  [5.71649376]
curr_Stock_Price:  95.63821786673455
curr_Factors:  [9.56382179e+01 3.63529553e-02]
mat_Sqrt:  [[ 1.82348139e+01  0.00000000e+00]
 [-7.62658040e-03  1.74746910e-02]]
grads:  [1.08539603e-02 2.38569706e+01]
Stock Position:  0.010853960321392303
Bond Position:  [4.67844034]


portfolio before change:  [5.69867597]
curr_Stock_Price:  93.94274125154806
curr_Factors:  [9.39427413e+01 3.76311338e-02]
mat_Sqrt:  [[ 1.82237136e+01  0.00000000e+00]
 [-7.75949832e-03  1.77792442e-02]]
grads:  [-3.98493419e-03  9.89262880e+00]
Stock Position:  -0.0039849341887428
Bond Position:  [6.07303161]


portfolio before change:  [5.70531358]
curr_Stock_Price:  92.46757536082937
curr_Factors:  [9.24675754e+01 3.84413258e-02]
mat_Sqrt:  [[ 1.81296178e+01  0.00000000e+00]
 [-7.84258384e-03  1.79696171e-02]]
grads:  [-0.00733077  4.3690408 ]
Stock Position:  -0.00733076926694203
Bond Position:  [6.38317204]


portfolio before change:  [5.7093536]
curr_Stock_Price:  92.02532040426705
curr_Factors:  [9.20253204e+01 3.83194999e-02]
mat_Sqrt:  [[ 1.80142943e+01  0.00000000e+00]
 [-7.83014686e-03  1.79411203e-02]]
grads:  [ 0.01018517 -4.06861644]
Stock Position:  0.01018516735847498
Bond Position:  [4.77206031]


portfolio before change:  [5.71516801]
curr_Stock_Price:  92.53762084753554
curr_Factors:  [9.25376208e+01 3.95277046e-02]
mat_Sqrt:  [[ 1.83979370e+01  0.00000000e+00]
 [-7.95263022e-03  1.82217650e-02]]
grads:  [ 3.93459638e-03 -2.40705888e+01]
Stock Position:  0.00393459638356295
Bond Position:  [5.35106982]


portfolio before change:  [5.71675609]
curr_Stock_Price:  92.77122913272468
curr_Factors:  [9.27712291e+01 4.01915974e-02]
mat_Sqrt:  [[ 1.85986296e+01  0.00000000e+00]
 [-8.01913685e-03  1.83741508e-02]]
grads:  [ 0.00516957 -1.86396109]
Stock Position:  0.005169568837373216
Bond Position:  [5.23716883]


portfolio before change:  [5.71483744]
curr_Stock_Price:  92.27344484495426
curr_Factors:  [9.22734448e+01 4.11498783e-02]
mat_Sqrt:  [[ 1.87180676e+01  0.00000000e+00]
 [-8.11417312e-03  1.85919063e-02]]
grads:  [  0.02812746 -16.89514827]
Stock Position:  0.02812746147114838
Bond Position:  [3.11941968]


portfolio before change:  [5.72345759]
curr_Stock_Price:  92.5660484176171
curr_Factors:  [9.25660484e+01 4.03055735e-02]
mat_Sqrt:  [[ 1.85837895e+01  0.00000000e+00]
 [-8.03049921e-03  1.84001852e-02]]
grads:  [ -0.04036817 -17.17761732]
Stock Position:  -0.04036817082889788
Bond Position:  [9.46017965]


portfolio before change:  [5.72496932]
curr_Stock_Price:  92.55789527756235
curr_Factors:  [9.25578953e+01 4.08632407e-02]
mat_Sqrt:  [[ 1.87102622e+01  0.00000000e+00]
 [-8.08586329e-03  1.85270403e-02]]
grads:  [0.02327144 7.61040943]
Stock Position:  0.02327144201983831
Bond Position:  [3.57101362]


portfolio before change:  [5.72274174]
curr_Stock_Price:  92.4429913916282
curr_Factors:  [9.24429914e+01 4.17854700e-02]
mat_Sqrt:  [[ 1.88967291e+01  0.00000000e+00]
 [-8.17659783e-03  1.87349392e-02]]
grads:  [-3.36939016e-03  1.32559282e+01]
Stock Position:  -0.0033693901630143857
Bond Position:  [6.03421825]


portfolio before change:  [5.71745323]
curr_Stock_Price:  94.23644220733645
curr_Factors:  [9.42364422e+01 4.07525321e-02]
mat_Sqrt:  [[ 1.90237522e+01  0.00000000e+00]
 [-8.07490256e-03  1.85019261e-02]]
grads:  [ 0.02611939 11.97375989]
Stock Position:  0.026119390222247164
Bond Position:  [3.25605482]


portfolio before change:  [5.70977063]
curr_Stock_Price:  93.92672468333159
curr_Factors:  [9.39267247e+01 4.08552948e-02]
mat_Sqrt:  [[ 1.89851203e+01  0.00000000e+00]
 [-8.08507710e-03  1.85252389e-02]]
grads:  [ 1.52730257e-03 -2.12035566e+00]
Stock Position:  0.001527302574389579
Bond Position:  [5.5663161]


portfolio before change:  [5.71124942]
curr_Stock_Price:  94.43936626279786
curr_Factors:  [9.44393663e+01 4.15895120e-02]
mat_Sqrt:  [[ 1.92594986e+01  0.00000000e+00]
 [-8.15740272e-03  1.86909577e-02]]
grads:  [ 8.54747504e-03 -1.04625868e+01]
Stock Position:  0.00854747503891754
Bond Position:  [4.9040313]


portfolio before change:  [5.70609704]
curr_Stock_Price:  93.76484877703687
curr_Factors:  [9.37648488e+01 4.17006371e-02]
mat_Sqrt:  [[ 1.91474702e+01  0.00000000e+00]
 [-8.16829354e-03  1.87159117e-02]]
grads:  [0.00643351 4.06710375]
Stock Position:  0.00643350787809938
Bond Position:  [5.10286015]


portfolio before change:  [5.69554582]
curr_Stock_Price:  92.02565492871393
curr_Factors:  [9.20256549e+01 4.14801205e-02]
mat_Sqrt:  [[ 1.87425605e+01  0.00000000e+00]
 [-8.14666759e-03  1.86663604e-02]]
grads:  [5.69517493e-03 2.17516410e+01]
Stock Position:  0.005695174930934745
Bond Position:  [5.17144362]


portfolio before change:  [5.70040119]
curr_Stock_Price:  92.76468284184449
curr_Factors:  [9.27646828e+01 4.15260667e-02]
mat_Sqrt:  [[ 1.89035366e+01  0.00000000e+00]
 [-8.15117824e-03  1.86766956e-02]]
grads:  [-0.02251901 -7.40686095]
Stock Position:  -0.022519014039836117
Bond Position:  [7.78937038]


portfolio before change:  [5.74282498]
curr_Stock_Price:  90.924013514682
curr_Factors:  [9.09240135e+01 4.04700101e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.74282498]
Stock Price:  93.2562523432165
PL:  [5.74282498]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.09792175e+00  2.77119326e-01]
 [-2.34194436e-01 -8.64609530e-02]
 [-1.52538274e-01 -9.68942648e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.19956332e-01 -4.23601745e-01]
 [-4.10078760e-01  2.59578478e-01]
 [ 2.98014671e-01 -3.42741104e-01]
 [-5.66694035e-01  2.28371911e-01]
 [-1.15804990e-01 -1.09952768e-01]
 [-8.68380141e-02 -3.28840918e-01]
 [-7.88373838e-02 -1.07354887e-02]
 [-2.79723246e-02 -1.35005621e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-2.47974990e-03 -1.35182132e-01]
 [ 2.06048468e-01  1.15840339e-01]
 [ 1.34500653e-01 -3.65345490e-01]
 [ 3.83827791e-02  9.34034532e-03]
 [ 1.48167682e-02 -1.06928368e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-1.12421662e-02 -7.74747424e-02]
 [ 1.57184573e-01 -3.37056395e-02]
 [ 4.93986327e-01 -2.63992586e-01]
 [ 2.98354846e-02 -4.02390120e-01]
 [ 4.12565444e-02  3.10762337e-02]
 [ 4.32206647e-01 -3.77423563e-01]
 [-4.36204814e-01  5.92718537e-02]
 [-1.56064198e-01  9.65824330e-02]
 [-1.13677574e-02  2.15621758e-01]
 [-4.00682831e-02  1.94354243e-01]
 [-6.47324972e-01 -6.17984069e-02]
 [-1.66863978e-01 -5.82546569e-02]
 [ 2.59912392e-02 -5.74816233e-02]
 [-2.63205903e-01  1.39220490e-01]
 [ 6.66518355e-02  6.43481631e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.93590665e-01  3.19957942e-02]
 [-2.62102253e-02 -1.88613857e-01]
 [-8.30045286e-03 -6.13208000e-02]
 [ 8.01576885e-02 -2.53924052e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.50468855]
curr_Stock_Price:  100.9904135709665
curr_Factors:  [1.00990414e+02 3.81093185e-02]
mat_Sqrt:  [[ 1.97149528e+01  0.00000000e+00]
 [-7.80864326e-03  1.78918494e-02]]
grads:  [ 0.06182447 15.48857917]
Stock Position:  0.061824471708102305
Bond Position:  [3.26100959]


portfolio before change:  [9.54111976]
curr_Stock_Price:  101.57308831571778
curr_Factors:  [1.01573088e+02 3.69687236e-02]
mat_Sqrt:  [[ 1.95297141e+01  0.00000000e+00]
 [-7.69090097e-03  1.76220679e-02]]
grads:  [-0.01392386 -4.90640221]
Stock Position:  -0.01392386433024371
Bond Position:  [10.95540966]


portfolio before change:  [9.54323462]
curr_Stock_Price:  101.51955828277444
curr_Factors:  [1.01519558e+02 3.69945205e-02]
mat_Sqrt:  [[ 1.95262309e+01  0.00000000e+00]
 [-7.69358388e-03  1.76282152e-02]]
grads:  [-0.00997768 -5.49654424]
Stock Position:  -0.009977675600252638
Bond Position:  [10.55616384]


portfolio before change:  [9.54078821]
curr_Stock_Price:  101.89700197968541
curr_Factors:  [1.01897002e+02 3.66465049e-02]
mat_Sqrt:  [[ 1.95064252e+01  0.00000000e+00]
 [-7.65731075e-03  1.75451031e-02]]
grads:  [-8.35692178e-04 -8.62843678e+00]
Stock Position:  -0.0008356921776817185
Bond Position:  [9.62594274]


portfolio before change:  [9.5416879]
curr_Stock_Price:  102.26032654824175
curr_Factors:  [1.02260327e+02 3.82990869e-02]
mat_Sqrt:  [[ 2.00125019e+01  0.00000000e+00]
 [-7.82806101e-03  1.79363411e-02]]
grads:  [-1.52320431e-02 -2.36169542e+01]
Stock Position:  -0.015232043056174567
Bond Position:  [11.0993216]


portfolio before change:  [9.52002412]
curr_Stock_Price:  103.77366831434806
curr_Factors:  [1.03773668e+02 3.84060123e-02]
mat_Sqrt:  [[ 2.03369948e+01  0.00000000e+00]
 [-7.83898078e-03  1.79613614e-02]]
grads:  [-0.01459357 14.45204919]
Stock Position:  -0.014593573275018612
Bond Position:  [11.03445275]


portfolio before change:  [9.53036075]
curr_Stock_Price:  103.15988839016839
curr_Factors:  [1.03159888e+02 3.86174607e-02]
mat_Sqrt:  [[ 2.02722858e+01  0.00000000e+00]
 [-7.86053034e-03  1.80107376e-02]]
grads:  [ 7.32182798e-03 -1.90298205e+01]
Stock Position:  0.007321827977371333
Bond Position:  [8.7750418]


portfolio before change:  [9.52887506]
curr_Stock_Price:  102.80715616780785
curr_Factors:  [1.02807156e+02 3.88040899e-02]
mat_Sqrt:  [[ 2.02517285e+01  0.00000000e+00]
 [-7.87950150e-03  1.80542060e-02]]
grads:  [-0.02306096 12.64923591]
Stock Position:  -0.023060962974092842
Bond Position:  [11.89970708]


portfolio before change:  [9.51885071]
curr_Stock_Price:  103.30635034617059
curr_Factors:  [1.03306350e+02 3.84348706e-02]
mat_Sqrt:  [[ 2.02530171e+01  0.00000000e+00]
 [-7.84192533e-03  1.79681082e-02]]
grads:  [-0.0080873  -6.11932913]
Stock Position:  -0.008087304294700653
Bond Position:  [10.3543206]


portfolio before change:  [9.53065929]
curr_Stock_Price:  102.00626309220593
curr_Factors:  [1.02006263e+02 4.00059679e-02]
mat_Sqrt:  [[ 2.04027745e+01  0.00000000e+00]
 [-8.00059676e-03  1.83316701e-02]]
grads:  [-1.12904231e-02 -1.79384047e+01]
Stock Position:  -0.011290423142090745
Bond Position:  [10.68235316]


portfolio before change:  [9.5431762]
curr_Stock_Price:  101.01590738400058
curr_Factors:  [1.01015907e+02 4.01450514e-02]
mat_Sqrt:  [[ 2.02397796e+01  0.00000000e+00]
 [-8.01449202e-03  1.83635082e-02]]
grads:  [-0.00412666 -0.5846099 ]
Stock Position:  -0.004126662290245835
Bond Position:  [9.96003473]


portfolio before change:  [9.53978042]
curr_Stock_Price:  102.14051144845676
curr_Factors:  [1.02140511e+02 3.84225454e-02]
mat_Sqrt:  [[ 2.00212457e+01  0.00000000e+00]
 [-7.84066787e-03  1.79652270e-02]]
grads:  [-4.34007003e-03 -7.51482968e+00]
Stock Position:  -0.004340070028356594
Bond Position:  [9.98307739]


portfolio before change:  [9.53978738]
curr_Stock_Price:  102.4264520543019
curr_Factors:  [1.02426452e+02 3.82188689e-02]
mat_Sqrt:  [[ 2.00240096e+01  0.00000000e+00]
 [-7.81985871e-03  1.79175472e-02]]
grads:  [-0.00327155 -0.99846272]
Stock Position:  -0.003271548626050768
Bond Position:  [9.8748805]


portfolio before change:  [9.54069813]
curr_Stock_Price:  102.52539373223252
curr_Factors:  [1.02525394e+02 3.93901849e-02]
mat_Sqrt:  [[ 2.03481746e+01  0.00000000e+00]
 [-7.93878428e-03  1.81900399e-02]]
grads:  [-3.02130636e-03 -7.43165671e+00]
Stock Position:  -0.003021306360259758
Bond Position:  [9.85045875]


portfolio before change:  [9.54147209]
curr_Stock_Price:  102.67679106789286
curr_Factors:  [1.02676791e+02 3.89992189e-02]
mat_Sqrt:  [[ 2.02768385e+01  0.00000000e+00]
 [-7.89928795e-03  1.80995425e-02]]
grads:  [0.0126551 6.4001805]
Stock Position:  0.012655095953500919
Bond Position:  [8.24208745]


portfolio before change:  [9.52094843]
curr_Stock_Price:  100.97360460944114
curr_Factors:  [1.00973605e+02 3.91760487e-02]
mat_Sqrt:  [[ 1.99856453e+01  0.00000000e+00]
 [-7.91717613e-03  1.81405295e-02]]
grads:  [-1.24835554e-03 -2.01397369e+01]
Stock Position:  -0.0012483555373300696
Bond Position:  [9.64699939]


portfolio before change:  [9.522487]
curr_Stock_Price:  100.70715941463247
curr_Factors:  [1.00707159e+02 3.87342805e-02]
mat_Sqrt:  [[ 1.98202027e+01  0.00000000e+00]
 [-7.87241060e-03  1.80379587e-02]]
grads:  [0.00214222 0.51781609]
Stock Position:  0.002142220264206737
Bond Position:  [9.30675008]


portfolio before change:  [9.52285647]
curr_Stock_Price:  100.33654117958218
curr_Factors:  [1.00336541e+02 3.95127357e-02]
mat_Sqrt:  [[ 1.99447077e+01  0.00000000e+00]
 [-7.95112427e-03  1.82183144e-02]]
grads:  [-1.59694481e-03 -5.86927886e+00]
Stock Position:  -0.001596944807174093
Bond Position:  [9.68308839]


portfolio before change:  [9.52310898]
curr_Stock_Price:  100.93640278531873
curr_Factors:  [1.00936403e+02 3.97170047e-02]
mat_Sqrt:  [[ 2.01157425e+01  0.00000000e+00]
 [-7.97165024e-03  1.82653453e-02]]
grads:  [-1.5846949e-02 -2.5692788e+01]
Stock Position:  -0.015846948968897507
Bond Position:  [11.12264301]


portfolio before change:  [9.51693521]
curr_Stock_Price:  101.41373099306347
curr_Factors:  [1.01413731e+02 3.96111642e-02]
mat_Sqrt:  [[ 2.01839222e+01  0.00000000e+00]
 [-7.96102146e-03  1.82409917e-02]]
grads:  [-2.23221807e-03 -4.24728784e+00]
Stock Position:  -0.002232218069148875
Bond Position:  [9.74331277]


portfolio before change:  [9.51586334]
curr_Stock_Price:  102.43955284802787
curr_Factors:  [1.02439553e+02 3.87919912e-02]
mat_Sqrt:  [[ 2.01761692e+01  0.00000000e+00]
 [-7.87827303e-03  1.80513912e-02]]
grads:  [ 0.00706151 -1.86720453]
Stock Position:  0.007061510296702875
Bond Position:  [8.79248538]


portfolio before change:  [9.5187342]
curr_Stock_Price:  102.69045352368308
curr_Factors:  [1.02690454e+02 3.88572052e-02]
mat_Sqrt:  [[ 2.02425794e+01  0.00000000e+00]
 [-7.88489241e-03  1.80665582e-02]]
grads:  [  0.01871157 -14.61222352]
Stock Position:  0.018711573696939102
Bond Position:  [7.59723422]


portfolio before change:  [9.52061692]
curr_Stock_Price:  102.74031596011008
curr_Factors:  [1.02740316e+02 3.82492729e-02]
mat_Sqrt:  [[ 2.00933565e+01  0.00000000e+00]
 [-7.82296853e-03  1.79246727e-02]]
grads:  [-7.25523194e-03 -2.24489521e+01]
Stock Position:  -0.007255231942285708
Bond Position:  [10.26602175]


portfolio before change:  [9.51468341]
curr_Stock_Price:  103.7350251461478
curr_Factors:  [1.03735025e+02 3.65144022e-02]
mat_Sqrt:  [[ 1.98224583e+01  0.00000000e+00]
 [-7.64349681e-03  1.75134514e-02]]
grads:  [0.00276552 1.77442087]
Stock Position:  0.002765515949960444
Bond Position:  [9.22780254]


portfolio before change:  [9.51711477]
curr_Stock_Price:  104.1970776359977
curr_Factors:  [1.04197078e+02 3.63175608e-02]
mat_Sqrt:  [[ 1.98570109e+01  0.00000000e+00]
 [-7.62286673e-03  1.74661819e-02]]
grads:  [ 1.34705823e-02 -2.16088190e+01]
Stock Position:  0.01347058228661993
Bond Position:  [8.11351946]


portfolio before change:  [9.54087682]
curr_Stock_Price:  105.88577966379782
curr_Factors:  [1.0588578e+02 3.4993417e-02]
mat_Sqrt:  [[ 1.98075525e+01  0.00000000e+00]
 [-7.48261099e-03  1.71448156e-02]]
grads:  [-0.02071616  3.45712984]
Stock Position:  -0.02071616151380369
Bond Position:  [11.73442374]


portfolio before change:  [9.5910107]
curr_Stock_Price:  103.53655212904724
curr_Factors:  [1.03536552e+02 3.54886381e-02]
mat_Sqrt:  [[ 1.95046591e+01  0.00000000e+00]
 [-7.53537132e-03  1.72657047e-02]]
grads:  [-0.00584025  5.59388884]
Stock Position:  -0.005840254240580351
Bond Position:  [10.19569048]


portfolio before change:  [9.59695805]
curr_Stock_Price:  102.73644801075736
curr_Factors:  [1.02736448e+02 3.39647547e-02]
mat_Sqrt:  [[ 1.89338437e+01  0.00000000e+00]
 [-7.37181168e-03  1.68909425e-02]]
grads:  [4.36980964e-03 1.27655255e+01]
Stock Position:  0.004369809638121127
Bond Position:  [9.14801933]


portfolio before change:  [9.59785031]
curr_Stock_Price:  102.67893802103654
curr_Factors:  [1.02678938e+02 3.37009743e-02]
mat_Sqrt:  [[ 1.88496199e+01  0.00000000e+00]
 [-7.34313005e-03  1.68252246e-02]]
grads:  [2.37431114e-03 1.15513609e+01]
Stock Position:  0.002374311141907524
Bond Position:  [9.35405857]


portfolio before change:  [9.5995891]
curr_Stock_Price:  102.91877809497073
curr_Factors:  [1.02918778e+02 3.30507669e-02]
mat_Sqrt:  [[ 1.87105000e+01  0.00000000e+00]
 [-7.27194796e-03  1.66621260e-02]]
grads:  [-0.03603837 -3.70891487]
Stock Position:  -0.03603837470471286
Bond Position:  [13.30861459]


portfolio before change:  [9.63347441]
curr_Stock_Price:  102.02468580451556
curr_Factors:  [1.02024686e+02 3.42143785e-02]
mat_Sqrt:  [[ 1.88716378e+01  0.00000000e+00]
 [-7.39885164e-03  1.69528988e-02]]
grads:  [-0.01018928 -3.43626524]
Stock Position:  -0.010189279605425502
Bond Position:  [10.67303246]


portfolio before change:  [9.63595358]
curr_Stock_Price:  101.91231747958106
curr_Factors:  [1.01912317e+02 3.42830775e-02]
mat_Sqrt:  [[ 1.88697687e+01  0.00000000e+00]
 [-7.40627599e-03  1.69699102e-02]]
grads:  [ 4.79180276e-05 -3.38726739e+00]
Stock Position:  4.7918027625728186e-05
Bond Position:  [9.63107014]


portfolio before change:  [9.63715099]
curr_Stock_Price:  101.77577142789625
curr_Factors:  [1.01775771e+02 3.38508161e-02]
mat_Sqrt:  [[ 1.87253082e+01  0.00000000e+00]
 [-7.35943651e-03  1.68625874e-02]]
grads:  [-0.01081131  8.25617604]
Stock Position:  -0.010811309330779314
Bond Position:  [10.73748034]


portfolio before change:  [9.63689372]
curr_Stock_Price:  101.92372259512368
curr_Factors:  [1.01923723e+02 3.47829891e-02]
mat_Sqrt:  [[ 1.90089762e+01  0.00000000e+00]
 [-7.46007926e-03  1.70931889e-02]]
grads:  [0.00498373 3.76454992]
Stock Position:  0.0049837337475822805
Bond Position:  [9.12893302]


portfolio before change:  [9.6494767]
curr_Stock_Price:  104.21955104999122
curr_Factors:  [1.04219551e+02 3.40915164e-02]
mat_Sqrt:  [[ 1.92429813e+01  0.00000000e+00]
 [-7.38555525e-03  1.69224330e-02]]
grads:  [-0.00491959  4.80575968]
Stock Position:  -0.0049195916842888245
Bond Position:  [10.16219434]


portfolio before change:  [9.65590338]
curr_Stock_Price:  103.17143105655347
curr_Factors:  [1.03171431e+02 3.64233181e-02]
mat_Sqrt:  [[ 1.96901583e+01  0.00000000e+00]
 [-7.63395762e-03  1.74915943e-02]]
grads:  [-0.01420134  1.82920971]
Stock Position:  -0.014201336069600619
Bond Position:  [11.12107554]


portfolio before change:  [9.65450916]
curr_Stock_Price:  103.3674996037696
curr_Factors:  [1.03367500e+02 3.57971305e-02]
mat_Sqrt:  [[ 1.95572649e+01  0.00000000e+00]
 [-7.56805185e-03  1.73405852e-02]]
grads:  [-5.54924535e-03 -1.08770180e+01]
Stock Position:  -0.005549245352465713
Bond Position:  [10.22812078]


portfolio before change:  [9.65084283]
curr_Stock_Price:  104.25859986885075
curr_Factors:  [1.04258600e+02 3.57896794e-02]
mat_Sqrt:  [[ 1.97238092e+01  0.00000000e+00]
 [-7.56726417e-03  1.73387804e-02]]
grads:  [-1.77770144e-03 -3.53662706e+00]
Stock Position:  -0.0017777014437449607
Bond Position:  [9.83618349]


portfolio before change:  [9.65166411]
curr_Stock_Price:  104.48828760689614
curr_Factors:  [1.04488288e+02 3.62386758e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.65166411]
Stock Price:  104.64635890950974
PL:  [5.0053052]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48934751e+00  3.65612847e-01]
 [ 1.11368259e+00  6.71874537e-02]
 [ 1.10252522e-01 -4.83085039e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.23957282e-01 -6.75480060e-01]
 [-4.27114713e-01  2.75270552e-01]
 [ 2.04250659e-01 -2.16587521e-01]
 [ 5.30664577e-01  5.86302694e-01]
 [-7.92206513e-02  6.90798891e-02]
 [ 1.81925796e-01  4.75038036e-02]
 [-1.04574936e-01 -3.22982888e-03]
 [-1.69025079e-04 -1.36171835e-01]
 [-8.31912631e-02 -2.17814620e-02]
 [-3.59273931e-02 -4.30516572e-02]
 [ 2.89264709e-01  1.70199039e-01]
 [ 1.36490760e-01 -4.65658576e-01]
 [ 3.94226532e-02  7.40522817e-02]
 [-6.36592887e-04 -3.44252685e-02]
 [-1.13959225e-01 -4.69287644e-01]
 [-5.11046131e-02 -5.41376588e-02]
 [ 1.66232694e-01 -3.66726754e-02]
 [ 6.11077740e-01 -1.62060957e-01]
 [ 2.99749738e-02 -4.06041163e-01]
 [ 4.66415944e-02  2.42071417e-02]
 [ 4.40058834e-01 -4.01739623e-01]
 [-1.79087392e-01  7.57744269e-04]
 [-1.65230785e-01  6.88753419e-02]
 [ 9.07498672e-03  2.79499019e-01]
 [-4.31680870e-02  1.95899938e-01]
 [-6.70661848e-01 -5.08802730e-02]
 [-1.64551674e-01 -5.29375017e-02]
 [ 5.36757895e-02 -3.15616269e-02]
 [-2.63687852e-01  1.43447267e-01]
 [ 6.73472746e-02  6.31749125e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.84032283e-01  3.91204133e-02]
 [-2.55509774e-02 -1.94718147e-01]
 [-5.86501342e-03 -5.86144110e-02]
 [-1.60831648e-02 -3.51222838e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.17521386]
curr_Stock_Price:  99.29501774339647
curr_Factors:  [9.92950177e+01 4.02511484e-02]
mat_Sqrt:  [[ 1.99212505e+01  0.00000000e+00]
 [-8.02507554e-03  1.83877581e-02]]
grads:  [ 0.08277161 19.88349238]
Stock Position:  0.08277161338920018
Bond Position:  [-10.39402268]


portfolio before change:  [-2.26220705]
curr_Stock_Price:  98.25971287794539
curr_Factors:  [9.82597129e+01 4.00644462e-02]
mat_Sqrt:  [[ 1.96677674e+01  0.00000000e+00]
 [-8.00644203e-03  1.83450633e-02]]
grads:  [0.05811568 3.66242692]
Stock Position:  0.05811567592400637
Bond Position:  [-7.97263668]


portfolio before change:  [-2.20487884]
curr_Stock_Price:  99.26331209022885
curr_Factors:  [9.92633121e+01 3.64228552e-02]
mat_Sqrt:  [[ 1.89441776e+01  0.00000000e+00]
 [-7.63390911e-03  1.74914832e-02]]
grads:  [ 0.00470693 -2.76183005]
Stock Position:  0.004706932339362705
Bond Position:  [-2.67210454]


portfolio before change:  [-2.19593559]
curr_Stock_Price:  101.2342963177654
curr_Factors:  [1.01234296e+02 3.37623922e-02]
mat_Sqrt:  [[ 1.86013418e+01  0.00000000e+00]
 [-7.34981820e-03  1.68405491e-02]]
grads:  [-8.76354357e-04 -8.98942258e+00]
Stock Position:  -0.0008763543571265131
Bond Position:  [-2.10721847]


portfolio before change:  [-2.19817054]
curr_Stock_Price:  103.48399378326258
curr_Factors:  [1.03483994e+02 3.40812892e-02]
mat_Sqrt:  [[ 1.91043026e+01  0.00000000e+00]
 [-7.38444735e-03  1.69198945e-02]]
grads:  [-2.19197192e-02 -3.99222383e+01]
Stock Position:  -0.021919719246931195
Bond Position:  [0.07016955]


portfolio before change:  [-2.19764057]
curr_Stock_Price:  103.46021625149777
curr_Factors:  [1.03460216e+02 3.46401467e-02]
mat_Sqrt:  [[ 1.92558743e+01  0.00000000e+00]
 [-7.44474545e-03  1.70580548e-02]]
grads:  [-1.59419816e-02  1.61372768e+01]
Stock Position:  -0.01594198161010917
Bond Position:  [-0.5482797]


portfolio before change:  [-2.17383693]
curr_Stock_Price:  101.96277533425186
curr_Factors:  [1.01962775e+02 3.41165620e-02]
mat_Sqrt:  [[ 1.88332069e+01  0.00000000e+00]
 [-7.38826768e-03  1.69286479e-02]]
grads:  [ 5.82609831e-03 -1.27941417e+01]
Stock Position:  0.0058260983074304
Bond Position:  [-2.76788209]


portfolio before change:  [-2.18898913]
curr_Stock_Price:  99.42141889866328
curr_Factors:  [9.94214189e+01 3.53514373e-02]
mat_Sqrt:  [[ 1.86931932e+01  0.00000000e+00]
 [-7.52079117e-03  1.72322974e-02]]
grads:  [ 0.04207671 34.02347815]
Stock Position:  0.04207670897400479
Bond Position:  [-6.37231524]


portfolio before change:  [-2.16496951]
curr_Stock_Price:  100.01120391618218
curr_Factors:  [1.00011204e+02 3.51753334e-02]
mat_Sqrt:  [[ 1.87571895e+01  0.00000000e+00]
 [-7.50203528e-03  1.71893223e-02]]
grads:  [-2.61615505e-03  4.01876746e+00]
Stock Position:  -0.002616155046598417
Bond Position:  [-1.90332469]


portfolio before change:  [-2.16378541]
curr_Stock_Price:  99.46764728827824
curr_Factors:  [9.94676473e+01 3.56595627e-02]
mat_Sqrt:  [[ 1.87832116e+01  0.00000000e+00]
 [-7.55349590e-03  1.73072334e-02]]
grads:  [0.01078932 2.74473699]
Stock Position:  0.010789323980511306
Bond Position:  [-3.23697408]


portfolio before change:  [-2.15951362]
curr_Stock_Price:  99.90107948660817
curr_Factors:  [9.99010795e+01 3.61917216e-02]
mat_Sqrt:  [[ 1.90053032e+01  0.00000000e+00]
 [-7.60964878e-03  1.74358958e-02]]
grads:  [-0.00557658 -0.1852402 ]
Stock Position:  -0.0055765776606401096
Bond Position:  [-1.60240749]


portfolio before change:  [-2.16620319]
curr_Stock_Price:  101.06474282699938
curr_Factors:  [1.01064743e+02 3.65005436e-02]
mat_Sqrt:  [[ 1.93085358e+01  0.00000000e+00]
 [-7.64204618e-03  1.75101275e-02]]
grads:  [-3.08668077e-03 -7.77674717e+00]
Stock Position:  -0.00308668076756658
Bond Position:  [-1.85424859]


portfolio before change:  [-2.16593604]
curr_Stock_Price:  100.90309996182687
curr_Factors:  [1.00903100e+02 3.75477356e-02]
mat_Sqrt:  [[ 1.95522339e+01  0.00000000e+00]
 [-7.75089523e-03  1.77595321e-02]]
grads:  [-0.00474102 -1.22646599]
Stock Position:  -0.004741016955268611
Bond Position:  [-1.68755274]


portfolio before change:  [-2.16869107]
curr_Stock_Price:  101.43970876663853
curr_Factors:  [1.01439709e+02 3.62512853e-02]
mat_Sqrt:  [[ 1.93138875e+01  0.00000000e+00]
 [-7.61590812e-03  1.74502377e-02]]
grads:  [-0.00283302 -2.46711007]
Stock Position:  -0.0028330224355664992
Bond Position:  [-1.8813101]


portfolio before change:  [-2.17030486]
curr_Stock_Price:  101.92633027279923
curr_Factors:  [1.01926330e+02 3.64890967e-02]
mat_Sqrt:  [[ 1.94700893e+01  0.00000000e+00]
 [-7.64084777e-03  1.75073816e-02]]
grads:  [0.01867201 9.72155872]
Stock Position:  0.01867200776990889
Bond Position:  [-4.07347409]


portfolio before change:  [-2.17577096]
curr_Stock_Price:  101.66085919388861
curr_Factors:  [1.01660859e+02 3.75088864e-02]
mat_Sqrt:  [[ 1.96888732e+01  0.00000000e+00]
 [-7.74688442e-03  1.77503421e-02]]
grads:  [-3.38969645e-03 -2.62337803e+01]
Stock Position:  -0.0033896964545338457
Bond Position:  [-1.8311715]


portfolio before change:  [-2.17090789]
curr_Stock_Price:  100.15866571604587
curr_Factors:  [1.00158666e+02 3.65614207e-02]
mat_Sqrt:  [[ 1.91513795e+01  0.00000000e+00]
 [-7.64841638e-03  1.75247235e-02]]
grads:  [3.74603399e-03 4.22558916e+00]
Stock Position:  0.003746033989269257
Bond Position:  [-2.54610565]


portfolio before change:  [-2.17389745]
curr_Stock_Price:  99.4455690273408
curr_Factors:  [9.94455690e+01 3.76637925e-02]
mat_Sqrt:  [[ 1.92995624e+01  0.00000000e+00]
 [-7.76286467e-03  1.77869575e-02]]
grads:  [-8.11469788e-04 -1.93542198e+00]
Stock Position:  -0.000811469788434322
Bond Position:  [-2.09320038]


portfolio before change:  [-2.17481228]
curr_Stock_Price:  100.25047374130516
curr_Factors:  [1.00250474e+02 3.65814506e-02]
mat_Sqrt:  [[ 1.91741842e+01  0.00000000e+00]
 [-7.65051115e-03  1.75295232e-02]]
grads:  [-1.66251216e-02 -2.67712726e+01]
Stock Position:  -0.016625121645227232
Bond Position:  [-0.50813596]


portfolio before change:  [-2.17893519]
curr_Stock_Price:  100.49464580047365
curr_Factors:  [1.00494646e+02 3.77164942e-02]
mat_Sqrt:  [[ 1.95167987e+01  0.00000000e+00]
 [-7.76829393e-03  1.77993975e-02]]
grads:  [-0.00382912 -3.04154446]
Stock Position:  -0.003829123087114416
Bond Position:  [-1.79412882]


portfolio before change:  [-2.18428264]
curr_Stock_Price:  101.83259526842309
curr_Factors:  [1.01832595e+02 3.62249125e-02]
mat_Sqrt:  [[ 1.93816383e+01  0.00000000e+00]
 [-7.61313733e-03  1.74438890e-02]]
grads:  [ 0.00775102 -2.10232221]
Stock Position:  0.007751017953497919
Bond Position:  [-2.97358892]


portfolio before change:  [-2.18695535]
curr_Stock_Price:  101.5357325657464
curr_Factors:  [1.01535733e+02 3.50104894e-02]
mat_Sqrt:  [[ 1.89984424e+01  0.00000000e+00]
 [-7.48443605e-03  1.71489974e-02]]
grads:  [ 0.02844173 -9.45017098]
Stock Position:  0.028441728383314796
Bond Position:  [-5.07480708]


portfolio before change:  [-2.15678492]
curr_Stock_Price:  102.61881811232543
curr_Factors:  [1.02618818e+02 3.46246166e-02]
mat_Sqrt:  [[ 1.90949926e+01  0.00000000e+00]
 [-7.44307642e-03  1.70542305e-02]]
grads:  [-7.71070829e-03 -2.38088234e+01]
Stock Position:  -0.00771070829274064
Bond Position:  [-1.36552114]


portfolio before change:  [-2.16147569]
curr_Stock_Price:  103.20502482857194
curr_Factors:  [1.03205025e+02 3.35585116e-02]
mat_Sqrt:  [[ 1.89061103e+01  0.00000000e+00]
 [-7.32759296e-03  1.67896247e-02]]
grads:  [0.00302582 1.44179171]
Stock Position:  0.003025818437144103
Bond Position:  [-2.47375535]


portfolio before change:  [-2.15713774]
curr_Stock_Price:  104.74086790699769
curr_Factors:  [1.04740868e+02 3.38344225e-02]
mat_Sqrt:  [[ 1.92661773e+01  0.00000000e+00]
 [-7.35765424e-03  1.68585038e-02]]
grads:  [ 1.37404159e-02 -2.38300877e+01]
Stock Position:  0.013740415886931489
Bond Position:  [-3.59632083]


portfolio before change:  [-2.17152222]
curr_Stock_Price:  103.72671328090397
curr_Factors:  [1.03726713e+02 3.44918810e-02]
mat_Sqrt:  [[ 1.92641147e+01  0.00000000e+00]
 [-7.42879597e-03  1.70215099e-02]]
grads:  [-0.00927926  0.04451687]
Stock Position:  -0.00927925772182906
Bond Position:  [-1.20901531]


portfolio before change:  [-2.16089173]
curr_Stock_Price:  102.56480744519246
curr_Factors:  [1.02564807e+02 3.40674229e-02]
mat_Sqrt:  [[ 1.89307583e+01  0.00000000e+00]
 [-7.38294499e-03  1.69164521e-02]]
grads:  [-0.00714029  4.07150042]
Stock Position:  -0.0071402909326105735
Bond Position:  [-1.42854917]


portfolio before change:  [-2.15738014]
curr_Stock_Price:  102.04799800328277
curr_Factors:  [1.02047998e+02 3.32303555e-02]
mat_Sqrt:  [[ 1.86025287e+01  0.00000000e+00]
 [-7.29167805e-03  1.67073333e-02]]
grads:  [7.04519055e-03 1.67291221e+01]
Stock Position:  0.0070451905503005775
Bond Position:  [-2.87632773]


portfolio before change:  [-2.15170815]
curr_Stock_Price:  102.90412144139655
curr_Factors:  [1.02904121e+02 3.35276392e-02]
mat_Sqrt:  [[ 1.88423149e+01  0.00000000e+00]
 [-7.32422165e-03  1.67819001e-02]]
grads:  [2.24652097e-03 1.16732871e+01]
Stock Position:  0.002246520967865961
Bond Position:  [-2.38288442]


portfolio before change:  [-2.15114771]
curr_Stock_Price:  103.28618739556069
curr_Factors:  [1.03286187e+02 3.39748858e-02]
mat_Sqrt:  [[ 1.90379968e+01  0.00000000e+00]
 [-7.37291105e-03  1.68934615e-02]]
grads:  [-0.03639395 -3.0118323 ]
Stock Position:  -0.03639394559374072
Bond Position:  [1.60784417]


portfolio before change:  [-2.11660954]
curr_Stock_Price:  102.34270133855586
curr_Factors:  [1.02342701e+02 3.48608564e-02]
mat_Sqrt:  [[ 1.91084694e+01  0.00000000e+00]
 [-7.46842488e-03  1.71123112e-02]]
grads:  [-0.00982054 -3.09353314]
Stock Position:  -0.009820540284637047
Bond Position:  [-1.11154892]


portfolio before change:  [-2.12186925]
curr_Stock_Price:  102.86413518548403
curr_Factors:  [1.02864135e+02 3.64557852e-02]
mat_Sqrt:  [[ 1.96402589e+01  0.00000000e+00]
 [-7.63735926e-03  1.74993884e-02]]
grads:  [ 0.0020316  -1.80358456]
Stock Position:  0.0020316008296551607
Bond Position:  [-2.33084811]


portfolio before change:  [-2.1247124]
curr_Stock_Price:  101.60809585025298
curr_Factors:  [1.01608096e+02 3.67699801e-02]
mat_Sqrt:  [[ 1.94838605e+01  0.00000000e+00]
 [-7.67020001e-03  1.75746361e-02]]
grads:  [-0.01032046  8.16217567]
Stock Position:  -0.010320456400416317
Bond Position:  [-1.07607047]


portfolio before change:  [-2.12881067]
curr_Stock_Price:  101.99216351480413
curr_Factors:  [1.01992164e+02 3.60848447e-02]
mat_Sqrt:  [[ 1.93744429e+01  0.00000000e+00]
 [-7.59840453e-03  1.74101320e-02]]
grads:  [0.00489919 3.62862916]
Stock Position:  0.0048991894705670115
Bond Position:  [-2.6284896]


portfolio before change:  [-2.13209553]
curr_Stock_Price:  101.38874180269173
curr_Factors:  [1.01388742e+02 3.47867653e-02]
mat_Sqrt:  [[ 1.89102277e+01  0.00000000e+00]
 [-7.46048420e-03  1.70941168e-02]]
grads:  [-0.00500616  4.75749331]
Stock Position:  -0.005006159232756384
Bond Position:  [-1.62452734]


portfolio before change:  [-2.13959005]
curr_Stock_Price:  102.84523677198028
curr_Factors:  [1.02845237e+02 3.33589746e-02]
mat_Sqrt:  [[ 1.87841059e+01  0.00000000e+00]
 [-7.30577575e-03  1.67396352e-02]]
grads:  [-0.01421195  2.33699318]
Stock Position:  -0.014211947900283841
Bond Position:  [-0.6779589]


portfolio before change:  [-2.14015879]
curr_Stock_Price:  102.87929174259094
curr_Factors:  [1.02879292e+02 3.40595485e-02]
mat_Sqrt:  [[ 1.89866091e+01  0.00000000e+00]
 [-7.38209168e-03  1.69144970e-02]]
grads:  [-5.82162636e-03 -1.15119088e+01]
Stock Position:  -0.0058216263589644995
Bond Position:  [-1.54123399]


portfolio before change:  [-2.14429923]
curr_Stock_Price:  103.55741423388618
curr_Factors:  [1.03557414e+02 3.37042020e-02]
mat_Sqrt:  [[ 1.90117994e+01  0.00000000e+00]
 [-7.34348168e-03  1.68260303e-02]]
grads:  [-1.65404857e-03 -3.48355553e+00]
Stock Position:  -0.0016540485749498546
Bond Position:  [-1.97301024]


portfolio before change:  [-2.14358535]
curr_Stock_Price:  102.97670149095214
curr_Factors:  [1.02976701e+02 3.46035708e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.14358535]
Stock Price:  102.36658780028844
PL:  [-4.51017315]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.06949092e+00  2.70691684e-01]
 [-1.46571045e-01 -2.90074014e-02]
 [-6.00227660e-02 -7.28096450e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.48101473e-02  1.97526595e-01]
 [-9.74009880e-03 -1.05716545e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 6.73001437e-01  6.75638456e-01]
 [-1.50233218e-02  2.92308527e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-6.93641255e-02  1.32558861e-02]
 [ 6.53505749e-02 -1.25035741e-01]
 [-1.02564816e-01  3.82909421e-02]
 [-1.16238112e-01  2.04520630e-01]
 [ 4.52811532e-01  2.96237962e-01]
 [ 1.32810373e-01 -5.68231993e-02]
 [ 3.95813163e-02  5.48243925e-02]
 [ 1.04035569e-01  8.49951250e-02]
 [-6.14498498e-02 -4.26350195e-02]
 [-3.34113032e-01  1.20737993e-01]
 [ 1.51348743e-01 -3.32025961e-03]
 [ 1.29445952e+00  1.34663176e-01]
 [ 1.62603061e-02  3.74436110e-01]
 [-1.32665525e-01  1.10116113e-01]
 [-1.66602774e-01  1.81921796e-01]
 [ 2.03017143e-01 -7.71130515e-02]
 [-1.36677029e-01 -4.51845100e-01]
 [ 6.35448375e-02  6.69715013e-02]
 [ 1.82852597e-01  2.76421522e-02]
 [-5.29675641e-01 -1.12139417e-01]
 [-1.68133500e-01 -6.33420063e-02]
 [ 1.14248812e-02 -6.70500138e-02]
 [-2.19606389e-01  1.40441320e-01]
 [ 4.51089464e-03  1.30982832e-02]
 [ 7.04415625e-02 -4.05571028e-02]
 [-7.36772421e-02  1.18957414e-01]
 [-4.65198139e-02  1.51360734e-02]
 [-2.22376400e-01 -9.08850092e-02]
 [ 1.32299500e-01 -1.30017199e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.37787898]
curr_Stock_Price:  101.1171614972767
curr_Factors:  [1.01117161e+02 3.89843881e-02]
mat_Sqrt:  [[ 1.99650421e+01  0.00000000e+00]
 [-7.89778582e-03  1.80961007e-02]]
grads:  [ 0.0594855 14.9585642]
Stock Position:  0.05948549704578555
Bond Position:  [4.36287437]


portfolio before change:  [10.38156059]
curr_Stock_Price:  101.16988378590982
curr_Factors:  [1.01169884e+02 3.89756117e-02]
mat_Sqrt:  [[ 1.99732032e+01  0.00000000e+00]
 [-7.89689678e-03  1.80940636e-02]]
grads:  [-0.00797223 -1.60314466]
Stock Position:  -0.00797222716000849
Bond Position:  [11.18810988]


portfolio before change:  [10.38272093]
curr_Stock_Price:  101.19976931726451
curr_Factors:  [1.01199769e+02 3.98308536e-02]
mat_Sqrt:  [[ 2.01971146e+01  0.00000000e+00]
 [-7.98306744e-03  1.82915054e-02]]
grads:  [-0.00454518 -3.98051682]
Stock Position:  -0.0045451789583058596
Bond Position:  [10.842692]


portfolio before change:  [10.38637961]
curr_Stock_Price:  100.69302201045312
curr_Factors:  [1.00693022e+02 4.01852196e-02]
mat_Sqrt:  [[ 2.01851764e+01  0.00000000e+00]
 [-8.01850057e-03  1.83726929e-02]]
grads:  [-8.07591010e-04 -8.23977264e+00]
Stock Position:  -0.0008075910095130491
Bond Position:  [10.46769839]


portfolio before change:  [10.3891535]
curr_Stock_Price:  98.87855771265944
curr_Factors:  [9.88785577e+01 3.97211630e-02]
mat_Sqrt:  [[ 1.97066635e+01  0.00000000e+00]
 [-7.97206754e-03  1.82663015e-02]]
grads:  [5.78359011e-04 1.08137159e+01]
Stock Position:  0.0005783590105684067
Bond Position:  [10.3319662]


portfolio before change:  [10.390029]
curr_Stock_Price:  98.15914933615055
curr_Factors:  [9.81591493e+01 3.93688029e-02]
mat_Sqrt:  [[ 1.94763195e+01  0.00000000e+00]
 [-7.93662930e-03  1.81851023e-02]]
grads:  [-2.86905241e-03 -5.81335993e+00]
Stock Position:  -0.0028690524138984797
Bond Position:  [10.67165275]


portfolio before change:  [10.39091512]
curr_Stock_Price:  98.31527027840393
curr_Factors:  [9.83152703e+01 3.78881739e-02]
mat_Sqrt:  [[ 1.91369541e+01  0.00000000e+00]
 [-7.78595390e-03  1.78398616e-02]]
grads:  [0.00676042 5.38888078]
Stock Position:  0.0067604163554503445
Bond Position:  [9.72626296]


portfolio before change:  [10.39592903]
curr_Stock_Price:  98.87707683118123
curr_Factors:  [9.88770768e+01 3.57354329e-02]
mat_Sqrt:  [[ 1.86915425e+01  0.00000000e+00]
 [-7.56152714e-03  1.73256352e-02]]
grads:  [ 0.0517814  38.99646081]
Stock Position:  0.05178139972793299
Bond Position:  [5.27593559]


portfolio before change:  [10.36985848]
curr_Stock_Price:  98.36086679257215
curr_Factors:  [9.83608668e+01 3.66956038e-02]
mat_Sqrt:  [[ 1.88421027e+01  0.00000000e+00]
 [-7.66243865e-03  1.75568526e-02]]
grads:  [5.97335554e-03 1.66492557e+01]
Stock Position:  0.0059733555369784605
Bond Position:  [9.78231405]


portfolio before change:  [10.36770723]
curr_Stock_Price:  97.79600572870993
curr_Factors:  [9.77960057e+01 3.70663464e-02]
mat_Sqrt:  [[ 1.88282956e+01  0.00000000e+00]
 [-7.70104890e-03  1.76453198e-02]]
grads:  [0.0130885  6.40830174]
Stock Position:  0.013088502139941033
Bond Position:  [9.087704]


portfolio before change:  [10.36969573]
curr_Stock_Price:  97.86113622940917
curr_Factors:  [9.78611362e+01 3.58442959e-02]
mat_Sqrt:  [[ 1.85276476e+01  0.00000000e+00]
 [-7.57303595e-03  1.73520052e-02]]
grads:  [-0.00343156  0.76393973]
Stock Position:  -0.003431562603807009
Bond Position:  [10.70551234]


portfolio before change:  [10.37289898]
curr_Stock_Price:  97.31765779462442
curr_Factors:  [9.73176578e+01 3.63190029e-02]
mat_Sqrt:  [[ 1.85463566e+01  0.00000000e+00]
 [-7.62301808e-03  1.74665287e-02]]
grads:  [ 5.81273388e-04 -7.15859136e+00]
Stock Position:  0.0005812733881087123
Bond Position:  [10.31633081]


portfolio before change:  [10.37316333]
curr_Stock_Price:  95.5538179768873
curr_Factors:  [9.55538180e+01 3.66237426e-02]
mat_Sqrt:  [[ 1.82864501e+01  0.00000000e+00]
 [-7.65493228e-03  1.75396533e-02]]
grads:  [-0.00469491  2.18310713]
Stock Position:  -0.00469491226887079
Bond Position:  [10.82178012]


portfolio before change:  [10.36801902]
curr_Stock_Price:  96.93768198597502
curr_Factors:  [9.69376820e+01 3.65707748e-02]
mat_Sqrt:  [[ 1.85378648e+01  0.00000000e+00]
 [-7.64939472e-03  1.75269652e-02]]
grads:  [-1.45529120e-03  1.16689129e+01]
Stock Position:  -0.0014552912006378543
Bond Position:  [10.50909157]


portfolio before change:  [10.36905228]
curr_Stock_Price:  97.13039207365986
curr_Factors:  [9.71303921e+01 3.61495221e-02]
mat_Sqrt:  [[ 1.84674283e+01  0.00000000e+00]
 [-7.60521106e-03  1.74257277e-02]]
grads:  [ 0.03152038 17.00003392]
Stock Position:  0.031520381115470834
Bond Position:  [7.30746531]


portfolio before change:  [10.3253834]
curr_Stock_Price:  95.71599373777107
curr_Factors:  [9.57159937e+01 3.58437754e-02]
mat_Sqrt:  [[ 1.81213849e+01  0.00000000e+00]
 [-7.57298096e-03  1.73518792e-02]]
grads:  [ 0.0059604  -3.27475765]
Stock Position:  0.005960399577455924
Bond Position:  [9.75487783]


portfolio before change:  [10.3224331]
curr_Stock_Price:  95.01642092017626
curr_Factors:  [9.50164209e+01 3.70945548e-02]
mat_Sqrt:  [[ 1.83001120e+01  0.00000000e+00]
 [-7.70397869e-03  1.76520327e-02]]
grads:  [0.0034704  3.10584017]
Stock Position:  0.003470396394222896
Bond Position:  [9.99268846]


portfolio before change:  [10.33029796]
curr_Stock_Price:  96.92274302144413
curr_Factors:  [9.69227430e+01 3.63846078e-02]
mat_Sqrt:  [[ 1.84877707e+01  0.00000000e+00]
 [-7.62989990e-03  1.74822969e-02]]
grads:  [0.00763372 4.86178249]
Stock Position:  0.007633720968481277
Bond Position:  [9.59041678]


portfolio before change:  [10.33362836]
curr_Stock_Price:  97.20196798146513
curr_Factors:  [9.72019680e+01 3.61083899e-02]
mat_Sqrt:  [[ 1.84705199e+01  0.00000000e+00]
 [-7.60088310e-03  1.74158111e-02]]
grads:  [-0.00433433 -2.44806397]
Stock Position:  -0.004334328341675369
Bond Position:  [10.75493361]


portfolio before change:  [10.33573509]
curr_Stock_Price:  97.02609717406695
curr_Factors:  [9.70260972e+01 3.62101995e-02]
mat_Sqrt:  [[ 1.84630745e+01  0.00000000e+00]
 [-7.61159111e-03  1.74403462e-02]]
grads:  [-0.01524224  6.92291266]
Stock Position:  -0.015242242133508468
Bond Position:  [11.81463036]


portfolio before change:  [10.32716979]
curr_Stock_Price:  97.68493900640127
curr_Factors:  [9.76849390e+01 3.53388326e-02]
mat_Sqrt:  [[ 1.83634260e+01  0.00000000e+00]
 [-7.51945025e-03  1.72292250e-02]]
grads:  [ 0.00816295 -0.19271091]
Stock Position:  0.008162946438981664
Bond Position:  [9.52977286]


portfolio before change:  [10.32028245]
curr_Stock_Price:  96.69526806974014
curr_Factors:  [9.66952681e+01 3.49817800e-02]
mat_Sqrt:  [[ 1.80853190e+01  0.00000000e+00]
 [-7.48136672e-03  1.71419647e-02]]
grads:  [0.07482485 7.85576092]
Stock Position:  0.07482485387747267
Bond Position:  [3.08507315]


portfolio before change:  [10.32044752]
curr_Stock_Price:  96.69231988977106
curr_Factors:  [9.66923199e+01 3.46378085e-02]
mat_Sqrt:  [[ 1.79956353e+01  0.00000000e+00]
 [-7.44449418e-03  1.70574790e-02]]
grads:  [9.98451118e-03 2.19514331e+01]
Stock Position:  0.009984511176066904
Bond Position:  [9.35502197]


portfolio before change:  [10.32158967]
curr_Stock_Price:  96.68958597005673
curr_Factors:  [9.66895860e+01 3.28089427e-02]
mat_Sqrt:  [[ 1.75136158e+01  0.00000000e+00]
 [-7.24529560e-03  1.66010578e-02]]
grads:  [-4.83092207e-03  6.63307809e+00]
Stock Position:  -0.004830922073056969
Bond Position:  [10.78868952]


portfolio before change:  [10.32334963]
curr_Stock_Price:  96.60444927253549
curr_Factors:  [9.66044493e+01 3.27060959e-02]
mat_Sqrt:  [[ 1.74707473e+01  0.00000000e+00]
 [-7.23393070e-03  1.65750175e-02]]
grads:  [-4.99152049e-03  1.09756623e+01]
Stock Position:  -0.00499152048631598
Bond Position:  [10.80555272]


portfolio before change:  [10.33141494]
curr_Stock_Price:  95.25926126729777
curr_Factors:  [9.52592613e+01 3.19526054e-02]
mat_Sqrt:  [[ 1.70278709e+01  0.00000000e+00]
 [-7.15011669e-03  1.63829755e-02]]
grads:  [ 0.00994618 -4.70690148]
Stock Position:  0.009946178781863652
Bond Position:  [9.3839493]


portfolio before change:  [10.34477318]
curr_Stock_Price:  96.4843718962001
curr_Factors:  [9.64843719e+01 3.26513232e-02]
mat_Sqrt:  [[ 1.74344145e+01  0.00000000e+00]
 [-7.22787086e-03  1.65611327e-02]]
grads:  [-1.91505369e-02 -2.72834660e+01]
Stock Position:  -0.019150536895544277
Bond Position:  [12.1925007]


portfolio before change:  [10.33715826]
curr_Stock_Price:  96.9615949122769
curr_Factors:  [9.69615949e+01 3.25728291e-02]
mat_Sqrt:  [[ 1.74995746e+01  0.00000000e+00]
 [-7.21917770e-03  1.65412141e-02]]
grads:  [0.00530148 4.04876576]
Stock Position:  0.005301477271358019
Bond Position:  [9.82311857]


portfolio before change:  [10.34539561]
curr_Stock_Price:  98.28375111813952
curr_Factors:  [9.82837511e+01 3.29063007e-02]
mat_Sqrt:  [[ 1.78287647e+01  0.00000000e+00]
 [-7.25603756e-03  1.66256707e-02]]
grads:  [0.0109327  1.66261877]
Stock Position:  0.010932704760338212
Bond Position:  [9.27088837]


portfolio before change:  [10.3586708]
curr_Stock_Price:  99.39200929273389
curr_Factors:  [9.93920093e+01 3.12450823e-02]
mat_Sqrt:  [[ 1.75688084e+01  0.00000000e+00]
 [-7.07051142e-03  1.62005769e-02]]
grads:  [-0.03293435 -6.92193975]
Stock Position:  -0.03293435056557393
Bond Position:  [13.63208208]


portfolio before change:  [10.32776866]
curr_Stock_Price:  100.38204712521798
curr_Factors:  [1.00382047e+02 3.11790919e-02]
mat_Sqrt:  [[ 1.77250627e+01  0.00000000e+00]
 [-7.06304092e-03  1.61834598e-02]]
grads:  [-0.01104528 -3.91399657]
Stock Position:  -0.011045276516907093
Bond Position:  [11.43651613]


portfolio before change:  [10.32328638]
curr_Stock_Price:  100.91729300607285
curr_Factors:  [1.00917293e+02 3.02655847e-02]
mat_Sqrt:  [[ 1.75565884e+01  0.00000000e+00]
 [-6.95880274e-03  1.59446201e-02]]
grads:  [-1.01603703e-03 -4.20518101e+00]
Stock Position:  -0.001016037028574688
Bond Position:  [10.42582208]


portfolio before change:  [10.32514186]
curr_Stock_Price:  100.37383807353588
curr_Factors:  [1.00373838e+02 3.17695669e-02]
mat_Sqrt:  [[ 1.78906524e+01  0.00000000e+00]
 [-7.12960777e-03  1.63359837e-02]]
grads:  [-0.00884891  8.59705318]
Stock Position:  -0.008848909921315666
Bond Position:  [11.21334091]


portfolio before change:  [10.3409774]
curr_Stock_Price:  98.74270069913663
curr_Factors:  [9.87427007e+01 3.32633207e-02]
mat_Sqrt:  [[ 1.80089256e+01  0.00000000e+00]
 [-7.29529390e-03  1.67156183e-02]]
grads:  [5.67910288e-04 7.83595500e-01]
Stock Position:  0.0005679102883422665
Bond Position:  [10.2849004]


portfolio before change:  [10.34154845]
curr_Stock_Price:  97.48433034975606
curr_Factors:  [9.74843303e+01 3.44094823e-02]
mat_Sqrt:  [[ 1.80831416e+01  0.00000000e+00]
 [-7.41991723e-03  1.70011662e-02]]
grads:  [ 0.00291658 -2.38554828]
Stock Position:  0.0029165834663979965
Bond Position:  [10.05722727]


portfolio before change:  [10.3435166]
curr_Stock_Price:  97.72808069045232
curr_Factors:  [9.77280807e+01 3.35817204e-02]
mat_Sqrt:  [[ 1.79089795e+01  0.00000000e+00]
 [-7.33012638e-03  1.67954295e-02]]
grads:  [-1.21503127e-03  7.08272535e+00]
Stock Position:  -0.0012150312724417377
Bond Position:  [10.46225928]


portfolio before change:  [10.3463531]
curr_Stock_Price:  96.46997526297574
curr_Factors:  [9.64699753e+01 3.48936686e-02]
mat_Sqrt:  [[ 1.80204438e+01  0.00000000e+00]
 [-7.47193882e-03  1.71203626e-02]]
grads:  [-0.00221492  0.88409771]
Stock Position:  -0.0022149226873375634
Bond Position:  [10.56002664]


portfolio before change:  [10.34771633]
curr_Stock_Price:  96.45049563043833
curr_Factors:  [9.64504956e+01 3.52314232e-02]
mat_Sqrt:  [[ 1.81037922e+01  0.00000000e+00]
 [-7.50801419e-03  1.72030217e-02]]
grads:  [-0.01447442 -5.28308404]
Stock Position:  -0.014474418730138952
Bond Position:  [11.7437812]


portfolio before change:  [10.33101761]
curr_Stock_Price:  97.70559162222665
curr_Factors:  [9.77055916e+01 3.56102919e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.33101761]
Stock Price:  96.56835718188852
PL:  [10.33101761]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.38246446e+00  3.41448731e-01]
 [-2.39587099e-01 -8.94342132e-02]
 [ 1.11745738e-01 -3.72793705e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.97848108e-02  1.74742676e-01]
 [-2.14536613e-01  2.94340041e-02]
 [ 9.23735882e-02  6.39166518e-02]
 [ 2.69106826e-01  4.62143339e-01]
 [-1.09052336e-01 -5.72017619e-02]
 [ 7.57000546e-02 -9.85633816e-02]
 [-9.61955423e-02 -6.01022330e-03]
 [ 2.58842277e-02 -1.33820494e-01]
 [-1.17149748e-01 -2.79986256e-02]
 [-1.28216033e-01  2.68847512e-01]
 [ 3.26001863e-01  2.40210119e-01]
 [ 1.31188497e-01  4.58410055e-02]
 [ 3.98877056e-02  1.24066890e-01]
 [ 1.78210281e-01  7.66280258e-02]
 [ 1.24561581e-02  2.45505624e-02]
 [-4.85245627e-01  2.06468411e-01]
 [ 1.13249767e-01  5.88662639e-02]
 [ 1.38111810e+00  1.50402427e-01]
 [ 1.55440414e-02  4.52119175e-01]
 [-1.45469320e-01  1.60489463e-01]
 [-1.87657728e-01  1.09654799e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 8.36924518e-02 -4.53430629e-01]
 [ 9.10437661e-02  8.43351480e-03]
 [ 3.61042362e-01 -1.44876275e-01]
 [-5.33266352e-01 -1.71142015e-01]
 [-1.64081510e-01 -5.78347528e-02]
 [-1.49983520e-02 -2.06676862e-02]
 [ 2.77964577e-02  1.79969133e-01]
 [ 9.71552605e-03  4.11774886e-03]
 [ 1.16843096e-01 -6.80120828e-02]
 [-6.83823830e-02  1.18793690e-01]
 [-3.99114444e-02 -7.00786065e-02]
 [-8.47719394e-02 -5.47789488e-02]
 [-1.26721945e-03 -1.07880257e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.00226744]
curr_Stock_Price:  99.75624493123028
curr_Factors:  [9.97562449e+01 3.91747666e-02]
mat_Sqrt:  [[ 1.97443709e+01  0.00000000e+00]
 [-7.91704658e-03  1.81402326e-02]]
grads:  [ 0.07756565 18.82273167]
Stock Position:  0.07756564690361169
Bond Position:  [-6.73539023]


portfolio before change:  [1.14637987]
curr_Stock_Price:  101.62504138667371
curr_Factors:  [1.01625041e+02 3.80696912e-02]
mat_Sqrt:  [[ 1.98285251e+01  0.00000000e+00]
 [-7.80458236e-03  1.78825447e-02]]
grads:  [-0.01405144 -5.00120171]
Stock Position:  -0.014051442918190597
Bond Position:  [2.57435834]


portfolio before change:  [1.17200393]
curr_Stock_Price:  99.824355292635
curr_Factors:  [9.98243553e+01 3.87444786e-02]
mat_Sqrt:  [[ 1.96490440e+01  0.00000000e+00]
 [-7.87344688e-03  1.80403332e-02]]
grads:  [ 0.00485905 -2.06644579]
Stock Position:  0.0048590499735345774
Bond Position:  [0.6869524]


portfolio before change:  [1.16037589]
curr_Stock_Price:  97.41361434151781
curr_Factors:  [9.74136143e+01 4.04233009e-02]
mat_Sqrt:  [[ 1.95855398e+01  0.00000000e+00]
 [-8.04221869e-03  1.84270380e-02]]
grads:  [-8.32316452e-04 -8.21547190e+00]
Stock Position:  -0.0008323164521068165
Bond Position:  [1.24145484]


portfolio before change:  [1.15875432]
curr_Stock_Price:  99.54832802608952
curr_Factors:  [9.9548328e+01 3.9732573e-02]
mat_Sqrt:  [[ 1.98429992e+01  0.00000000e+00]
 [-7.97321245e-03  1.82689248e-02]]
grads:  [-1.77435603e-04  9.56502248e+00]
Stock Position:  -0.00017743560333842158
Bond Position:  [1.17641774]


portfolio before change:  [1.15874295]
curr_Stock_Price:  100.4412282337916
curr_Factors:  [1.00441228e+02 3.96462006e-02]
mat_Sqrt:  [[ 1.99992082e+01  0.00000000e+00]
 [-7.96454148e-03  1.82490571e-02]]
grads:  [-0.01008493  1.61290547]
Stock Position:  -0.010084927278610219
Bond Position:  [2.17168544]


portfolio before change:  [1.16351469]
curr_Stock_Price:  99.99499171498795
curr_Factors:  [9.99949917e+01 4.10059066e-02]
mat_Sqrt:  [[ 2.02489010e+01  0.00000000e+00]
 [-8.09996608e-03  1.85593538e-02]]
grads:  [0.00593954 3.44390502]
Stock Position:  0.005939537255612935
Bond Position:  [0.56959072]


portfolio before change:  [1.16622401]
curr_Stock_Price:  100.4391531666069
curr_Factors:  [1.00439153e+02 4.10979774e-02]
mat_Sqrt:  [[ 2.03616640e+01  0.00000000e+00]
 [-8.10905443e-03  1.85801779e-02]]
grads:  [2.31220157e-02 2.48729233e+01]
Stock Position:  0.023122015723996962
Bond Position:  [-1.15613167]


portfolio before change:  [1.17763291]
curr_Stock_Price:  100.93882497819985
curr_Factors:  [1.00938825e+02 4.05293027e-02]
mat_Sqrt:  [[ 2.03208940e+01  0.00000000e+00]
 [-8.05275631e-03  1.84511827e-02]]
grads:  [-0.00659505 -3.10016777]
Stock Position:  -0.006595046032249763
Bond Position:  [1.8433291]


portfolio before change:  [1.1765574]
curr_Stock_Price:  101.13684263935943
curr_Factors:  [1.01136843e+02 4.18781189e-02]
mat_Sqrt:  [[ 2.06967891e+01  0.00000000e+00]
 [-8.18565759e-03  1.87556978e-02]]
grads:  [ 1.57915646e-03 -5.25511675e+00]
Stock Position:  0.0015791564588663934
Bond Position:  [1.0168465]


portfolio before change:  [1.17536466]
curr_Stock_Price:  100.30104682007607
curr_Factors:  [1.00301047e+02 4.11287027e-02]
mat_Sqrt:  [[ 2.03412656e+01  0.00000000e+00]
 [-8.11208508e-03  1.85871220e-02]]
grads:  [-0.00485804 -0.32335417]
Stock Position:  -0.004858036888202283
Bond Position:  [1.66263085]


portfolio before change:  [1.18311783]
curr_Stock_Price:  98.74788384620541
curr_Factors:  [9.87478838e+01 4.09201405e-02]
mat_Sqrt:  [[ 1.99754401e+01  0.00000000e+00]
 [-8.09149089e-03  1.85399347e-02]]
grads:  [-1.62799038e-03 -7.21795929e+00]
Stock Position:  -0.00162799037562589
Bond Position:  [1.34387843]


portfolio before change:  [1.18534575]
curr_Stock_Price:  97.48256217840498
curr_Factors:  [9.74825622e+01 4.15125882e-02]
mat_Sqrt:  [[ 1.98617193e+01  0.00000000e+00]
 [-8.14985528e-03  1.86736644e-02]]
grads:  [-0.0065135 -1.4993643]
Stock Position:  -0.006513502048748521
Bond Position:  [1.82029862]


portfolio before change:  [1.19372725]
curr_Stock_Price:  96.23071010002369
curr_Factors:  [9.62307101e+01 4.17438173e-02]
mat_Sqrt:  [[ 1.96611887e+01  0.00000000e+00]
 [-8.17252150e-03  1.87255992e-02]]
grads:  [-5.53443596e-04  1.43572181e+01]
Stock Position:  -0.0005534435961777032
Bond Position:  [1.24698552]


portfolio before change:  [1.19412001]
curr_Stock_Price:  95.80269522018301
curr_Factors:  [9.58026952e+01 4.41029186e-02]
mat_Sqrt:  [[ 2.01192317e+01  0.00000000e+00]
 [-8.40027795e-03  1.92474548e-02]]
grads:  [ 0.02141424 12.48009784]
Stock Position:  0.021414244852239556
Bond Position:  [-0.85742236]


portfolio before change:  [1.21878063]
curr_Stock_Price:  96.95929937507262
curr_Factors:  [9.69592994e+01 4.32430938e-02]
mat_Sqrt:  [[ 2.01626610e+01  0.00000000e+00]
 [-8.31798955e-03  1.90589084e-02]]
grads:  [0.00749877 2.40522724]
Stock Position:  0.007498769757622405
Bond Position:  [0.49170517]


portfolio before change:  [1.22582333]
curr_Stock_Price:  97.89028321995505
curr_Factors:  [9.78902832e+01 4.29262226e-02]
mat_Sqrt:  [[ 2.02815397e+01  0.00000000e+00]
 [-8.28745776e-03  1.89889513e-02]]
grads:  [4.63647913e-03 6.53363569e+00]
Stock Position:  0.004636479127820771
Bond Position:  [0.77195708]


portfolio before change:  [1.21670686]
curr_Stock_Price:  95.9032219597698
curr_Factors:  [9.59032220e+01 4.49783741e-02]
mat_Sqrt:  [[ 2.03392565e+01  0.00000000e+00]
 [-8.48324222e-03  1.94375498e-02]]
grads:  [0.01040616 3.94226775]
Stock Position:  0.010406156810869533
Bond Position:  [0.2187229]


portfolio before change:  [1.2221872]
curr_Stock_Price:  96.42723783691262
curr_Factors:  [9.64272378e+01 4.32450104e-02]
mat_Sqrt:  [[ 2.00524633e+01  0.00000000e+00]
 [-8.31817388e-03  1.90593307e-02]]
grads:  [1.15551400e-03 1.28811252e+00]
Stock Position:  0.0011555139952222002
Bond Position:  [1.11076417]


portfolio before change:  [1.22120242]
curr_Stock_Price:  95.45483150520165
curr_Factors:  [9.54548315e+01 4.35425636e-02]
mat_Sqrt:  [[ 1.99184212e+01  0.00000000e+00]
 [-8.34674198e-03  1.91247885e-02]]
grads:  [-0.01983769 10.7958533 ]
Stock Position:  -0.01983768797093244
Bond Position:  [3.11480559]


portfolio before change:  [1.21197923]
curr_Stock_Price:  95.9393923048769
curr_Factors:  [9.59393923e+01 4.20990577e-02]
mat_Sqrt:  [[ 1.96848972e+01  0.00000000e+00]
 [-8.20722196e-03  1.88051079e-02]]
grads:  [0.00705826 3.13033374]
Stock Position:  0.0070582594289410085
Bond Position:  [0.53481411]


portfolio before change:  [1.21298231]
curr_Stock_Price:  96.07203500001124
curr_Factors:  [9.60720350e+01 4.14968317e-02]
mat_Sqrt:  [[ 1.95706144e+01  0.00000000e+00]
 [-8.14830846e-03  1.86701201e-02]]
grads:  [0.07392507 8.05578248]
Stock Position:  0.07392507322358664
Bond Position:  [-5.88914991]


portfolio before change:  [1.08753193]
curr_Stock_Price:  94.38499994613474
curr_Factors:  [9.43849999e+01 4.13884173e-02]
mat_Sqrt:  [[ 1.92018198e+01  0.00000000e+00]
 [-8.13765738e-03  1.86457155e-02]]
grads:  [1.10856694e-02 2.42478856e+01]
Stock Position:  0.011085669410655094
Bond Position:  [0.04121103]


portfolio before change:  [1.08980044]
curr_Stock_Price:  94.58916967621798
curr_Factors:  [9.45891697e+01 4.19707844e-02]
mat_Sqrt:  [[ 1.93782679e+01  0.00000000e+00]
 [-8.19470897e-03  1.87764371e-02]]
grads:  [-3.8922971e-03  8.5473864e+00]
Stock Position:  -0.0038922971048866075
Bond Position:  [1.4579696]


portfolio before change:  [1.0921011]
curr_Stock_Price:  94.04491573526799
curr_Factors:  [9.40449157e+01 4.17651537e-02]
mat_Sqrt:  [[ 1.92195123e+01  0.00000000e+00]
 [-8.17460983e-03  1.87303842e-02]]
grads:  [-0.00727388  5.85438065]
Stock Position:  -0.0072738812504678976
Bond Position:  [1.77617265]


portfolio before change:  [1.09767911]
curr_Stock_Price:  93.30858666259701
curr_Factors:  [9.33085867e+01 4.20387214e-02]
mat_Sqrt:  [[ 1.91313827e+01  0.00000000e+00]
 [-8.20133856e-03  1.87916274e-02]]
grads:  [ 0.00959045 -3.8844713 ]
Stock Position:  0.009590451729325647
Bond Position:  [0.20280761]


portfolio before change:  [1.10538376]
curr_Stock_Price:  94.10931083085772
curr_Factors:  [9.41093108e+01 4.15538145e-02]
mat_Sqrt:  [[ 1.91839503e+01  0.00000000e+00]
 [-8.15390110e-03  1.86829345e-02]]
grads:  [-5.95293966e-03 -2.42697757e+01]
Stock Position:  -0.005952939660844276
Bond Position:  [1.66561081]


portfolio before change:  [1.10541162]
curr_Stock_Price:  94.13960855087207
curr_Factors:  [9.41396086e+01 4.17612369e-02]
mat_Sqrt:  [[ 1.92379621e+01  0.00000000e+00]
 [-8.17422651e-03  1.87295059e-02]]
grads:  [0.00492383 0.45027962]
Stock Position:  0.004923829941793771
Bond Position:  [0.6418842]


portfolio before change:  [1.11620553]
curr_Stock_Price:  96.31549077531346
curr_Factors:  [9.63154908e+01 4.15329112e-02]
mat_Sqrt:  [[ 1.96287358e+01  0.00000000e+00]
 [-8.15184996e-03  1.86782348e-02]]
grads:  [ 0.01517231 -7.75642223]
Stock Position:  0.015172305329966248
Bond Position:  [-0.3451225]


portfolio before change:  [1.1312416]
curr_Stock_Price:  97.30935499782201
curr_Factors:  [9.73093550e+01 3.98746706e-02]
mat_Sqrt:  [[ 1.94313578e+01  0.00000000e+00]
 [-7.98745722e-03  1.83015637e-02]]
grads:  [-0.03128751 -9.35122368]
Stock Position:  -0.031287512622869086
Bond Position:  [4.17580927]


portfolio before change:  [1.11432538]
curr_Stock_Price:  97.86670922229857
curr_Factors:  [9.78667092e+01 4.01720535e-02]
mat_Sqrt:  [[ 1.96153925e+01  0.00000000e+00]
 [-8.01718689e-03  1.83696829e-02]]
grads:  [-0.00965174 -3.14838058]
Stock Position:  -0.00965173986240436
Bond Position:  [2.0589094]


portfolio before change:  [1.11821967]
curr_Stock_Price:  97.48989531009924
curr_Factors:  [9.74898953e+01 3.91392021e-02]
mat_Sqrt:  [[ 1.92870403e+01  0.00000000e+00]
 [-7.91345205e-03  1.81319965e-02]]
grads:  [-0.00124532 -1.13984614]
Stock Position:  -0.001245316513897514
Bond Position:  [1.23962545]


portfolio before change:  [1.117879]
curr_Stock_Price:  97.88789312296561
curr_Factors:  [9.78878931e+01 3.94181601e-02]
mat_Sqrt:  [[ 1.94346693e+01  0.00000000e+00]
 [-7.94160287e-03  1.81964982e-02]]
grads:  [5.47173841e-03 9.89031689e+00]
Stock Position:  0.005471738414797869
Bond Position:  [0.58226206]


portfolio before change:  [1.11456622]
curr_Stock_Price:  97.26915546957623
curr_Factors:  [9.72691555e+01 3.95585117e-02]
mat_Sqrt:  [[ 1.93461752e+01  0.00000000e+00]
 [-7.95572868e-03  1.82288644e-02]]
grads:  [0.00059509 0.22589168]
Stock Position:  0.0005950870828847342
Bond Position:  [1.0566826]


portfolio before change:  [1.11448384]
curr_Stock_Price:  96.90874367460006
curr_Factors:  [9.69087437e+01 4.01621514e-02]
mat_Sqrt:  [[ 1.94209937e+01  0.00000000e+00]
 [-8.01619874e-03  1.83674188e-02]]
grads:  [ 0.00448794 -3.70286559]
Stock Position:  0.0044879366295432176
Bond Position:  [0.67956354]


portfolio before change:  [1.1179146]
curr_Stock_Price:  97.65425553587453
curr_Factors:  [9.76542555e+01 3.94265228e-02]
mat_Sqrt:  [[ 1.93903394e+01  0.00000000e+00]
 [-7.94244524e-03  1.81984283e-02]]
grads:  [-8.52825006e-04  6.52768953e+00]
Stock Position:  -0.0008528250064486044
Bond Position:  [1.20119659]


portfolio before change:  [1.11812702]
curr_Stock_Price:  97.58124750072915
curr_Factors:  [9.75812475e+01 3.99309713e-02]
mat_Sqrt:  [[ 1.94994025e+01  0.00000000e+00]
 [-7.99309415e-03  1.83144795e-02]]
grads:  [-3.61530339e-03 -3.82640449e+00]
Stock Position:  -0.003615303387070028
Bond Position:  [1.47091283]


portfolio before change:  [1.11526177]
curr_Stock_Price:  98.42464072271623
curr_Factors:  [9.84246407e+01 3.95467639e-02]
mat_Sqrt:  [[ 1.95730864e+01  0.00000000e+00]
 [-7.95454727e-03  1.82261575e-02]]
grads:  [-0.00555249 -3.00551275]
Stock Position:  -0.005552493370419901
Bond Position:  [1.66176394]


portfolio before change:  [1.1064312]
curr_Stock_Price:  100.05243254299863
curr_Factors:  [1.00052433e+02 3.73178226e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.1064312]
Stock Price:  98.81867312055098
PL:  [1.1064312]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.43048875e+00  3.59208236e-01]
 [ 1.05972142e+00  7.17476446e-02]
 [ 5.05494560e-02  3.02689331e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.70984682e-02  4.07002806e-01]
 [-1.38696999e-02 -1.13891530e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.08995301e-01  8.00024580e-01]
 [ 3.60680976e-02  4.28725693e-01]
 [ 1.78182902e-01  7.95239008e-02]
 [ 7.33960628e-03  1.89332984e-02]
 [ 6.67225409e-02 -1.01039367e-01]
 [-1.14914779e-01 -8.48978054e-03]
 [-8.21828486e-02  8.44131426e-02]
 [ 4.53146822e-01  2.96386407e-01]
 [ 1.29929947e-01 -4.81437132e-02]
 [ 4.00471579e-02  1.26478059e-01]
 [ 2.77980962e-02  6.45643587e-02]
 [-9.38293502e-02 -7.21155452e-02]
 [-3.52475738e-01  1.29925187e-01]
 [ 1.34246030e-01  2.45954062e-02]
 [ 1.13430700e+00  1.05306574e-01]
 [ 2.06515930e-02  8.57188333e-02]
 [-6.35932590e-02  6.19358222e-02]
 [ 1.37379813e-01 -5.93603118e-02]
 [ 1.54485130e-01 -9.47921993e-02]
 [-2.24937697e-01 -4.41276242e-01]
 [ 5.91136795e-02  7.64042712e-02]
 [ 1.52451419e-01  4.98218875e-02]
 [-5.39248790e-01 -1.43145477e-01]
 [-1.37647393e-01 -4.77123760e-02]
 [ 2.09057484e-03 -5.24118339e-02]
 [-8.51914110e-02  1.61916942e-01]
 [ 1.26445480e-02  1.48317861e-02]
 [-9.79497543e-02  9.00421384e-02]
 [-2.22829030e-01  8.01050873e-02]
 [-2.10714342e-02 -2.34897884e-01]
 [ 1.77177484e-02 -2.97542292e-02]
 [ 9.24902575e-03 -1.09618982e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.92891031]
curr_Stock_Price:  98.31468516996644
curr_Factors:  [9.83146852e+01 4.15758670e-02]
mat_Sqrt:  [[ 2.00465227e+01  0.00000000e+00]
 [-8.15606444e-03  1.86878913e-02]]
grads:  [ 0.07917882 19.22144288]
Stock Position:  0.07917882302417835
Bond Position:  [-16.71335137]


portfolio before change:  [-8.9226237]
curr_Stock_Price:  98.42046991378537
curr_Factors:  [9.84204699e+01 4.16321014e-02]
mat_Sqrt:  [[ 2.00816596e+01  0.00000000e+00]
 [-8.16157842e-03  1.87005254e-02]]
grads:  [0.05432991 3.83666463]
Stock Position:  0.054329905302871156
Bond Position:  [-14.26979851]


portfolio before change:  [-8.93875666]
curr_Stock_Price:  98.15635898261046
curr_Factors:  [9.81563590e+01 3.96234418e-02]
mat_Sqrt:  [[ 1.95386494e+01  0.00000000e+00]
 [-7.96225514e-03  1.82438184e-02]]
grads:  [0.00326327 1.65913365]
Stock Position:  0.003263270675695354
Bond Position:  [-9.25906743]


portfolio before change:  [-8.94133315]
curr_Stock_Price:  97.72150804282103
curr_Factors:  [9.77215080e+01 3.99673186e-02]
mat_Sqrt:  [[ 1.95363158e+01  0.00000000e+00]
 [-7.99673119e-03  1.83228130e-02]]
grads:  [-8.34413568e-04 -8.26220365e+00]
Stock Position:  -0.0008344135678765364
Bond Position:  [-8.859793]


portfolio before change:  [-8.94302762]
curr_Stock_Price:  98.42491165599168
curr_Factors:  [9.84249117e+01 4.12041862e-02]
mat_Sqrt:  [[ 1.99790901e+01  0.00000000e+00]
 [-8.11952572e-03  1.86041706e-02]]
grads:  [4.53134346e-03 2.18769659e+01]
Stock Position:  0.00453134345907512
Bond Position:  [-9.3890247]


portfolio before change:  [-8.94473485]
curr_Stock_Price:  98.30716998609458
curr_Factors:  [9.830717e+01 4.041439e-02]
mat_Sqrt:  [[ 1.97630154e+01  0.00000000e+00]
 [-8.04133223e-03  1.84250068e-02]]
grads:  [-3.21691997e-03 -6.18135621e+00]
Stock Position:  -0.0032169199689199798
Bond Position:  [-8.62848855]


portfolio before change:  [-8.9439846]
curr_Stock_Price:  97.73864930326694
curr_Factors:  [9.77386493e+01 4.05889164e-02]
mat_Sqrt:  [[ 1.96911038e+01  0.00000000e+00]
 [-8.05867645e-03  1.84647474e-02]]
grads:  [0.00657016 5.20650973]
Stock Position:  0.006570163795155421
Bond Position:  [-9.58614353]


portfolio before change:  [-8.94275541]
curr_Stock_Price:  98.10812721239579
curr_Factors:  [9.81081272e+01 4.07000344e-02]
mat_Sqrt:  [[ 1.97925784e+01  0.00000000e+00]
 [-8.06969981e-03  1.84900051e-02]]
grads:  [ 0.05851459 43.26794799]
Stock Position:  0.058514592181125646
Bond Position:  [-14.68351246]


portfolio before change:  [-9.01644665]
curr_Stock_Price:  96.88013107400091
curr_Factors:  [9.68801311e+01 4.10073075e-02]
mat_Sqrt:  [[ 1.96184795e+01  0.00000000e+00]
 [-8.10010444e-03  1.85596709e-02]]
grads:  [1.13759749e-02 2.30998543e+01]
Stock Position:  0.011375974892414112
Bond Position:  [-10.11855259]


portfolio before change:  [-9.02193275]
curr_Stock_Price:  96.50906822306963
curr_Factors:  [9.65090682e+01 4.05771354e-02]
mat_Sqrt:  [[ 1.94405620e+01  0.00000000e+00]
 [-8.05750685e-03  1.84620675e-02]]
grads:  [0.01095081 4.30742119]
Stock Position:  0.010950813995985981
Bond Position:  [-10.07878561]


portfolio before change:  [-9.03551058]
curr_Stock_Price:  95.38422934151714
curr_Factors:  [9.53842293e+01 4.00889332e-02]
mat_Sqrt:  [[ 1.90980412e+01  0.00000000e+00]
 [-8.00888838e-03  1.83506686e-02]]
grads:  [8.16983009e-04 1.03174978e+00]
Stock Position:  0.0008169830091879519
Bond Position:  [-9.11343788]


portfolio before change:  [-9.03614026]
curr_Stock_Price:  96.00795578938221
curr_Factors:  [9.60079558e+01 3.89650421e-02]
mat_Sqrt:  [[ 1.89515527e+01  0.00000000e+00]
 [-7.89582595e-03  1.80916100e-02]]
grads:  [ 1.19385182e-03 -5.58487428e+00]
Stock Position:  0.00119385181807203
Bond Position:  [-9.15075953]


portfolio before change:  [-9.03737857]
curr_Stock_Price:  95.92888595560791
curr_Factors:  [9.59288860e+01 3.84631422e-02]
mat_Sqrt:  [[ 1.88135946e+01  0.00000000e+00]
 [-7.84480895e-03  1.79747154e-02]]
grads:  [-0.00630502 -0.47231794]
Stock Position:  -0.006305016456188619
Bond Position:  [-8.43254537]


portfolio before change:  [-9.05294675]
curr_Stock_Price:  98.23086980681069
curr_Factors:  [9.82308698e+01 3.72571481e-02]
mat_Sqrt:  [[ 1.89606313e+01  0.00000000e+00]
 [-7.72084431e-03  1.76906767e-02]]
grads:  [-2.39137253e-03  4.77161749e+00]
Stock Position:  -0.002391372527193299
Bond Position:  [-8.81804015]


portfolio before change:  [-9.05142591]
curr_Stock_Price:  97.13394017195525
curr_Factors:  [9.71339402e+01 3.62056413e-02]
mat_Sqrt:  [[ 1.84824325e+01  0.00000000e+00]
 [-7.61111202e-03  1.74392485e-02]]
grads:  [ 0.03151644 16.99536581]
Stock Position:  0.031516438947064906
Bond Position:  [-12.11274181]


portfolio before change:  [-9.0027932]
curr_Stock_Price:  98.72507467929618
curr_Factors:  [9.87250747e+01 3.42738290e-02]
mat_Sqrt:  [[ 1.82771629e+01  0.00000000e+00]
 [-7.40527693e-03  1.69676210e-02]]
grads:  [ 0.00595926 -2.83738734]
Stock Position:  0.005959256804658114
Bond Position:  [-9.59112128]


portfolio before change:  [-9.01068788]
curr_Stock_Price:  97.60149285495895
curr_Factors:  [9.76014929e+01 3.49760607e-02]
mat_Sqrt:  [[ 1.82533217e+01  0.00000000e+00]
 [-7.48075512e-03  1.71405633e-02]]
grads:  [5.21804798e-03 7.37887413e+00]
Stock Position:  0.005218047980445271
Bond Position:  [-9.51997715]


portfolio before change:  [-9.00955128]
curr_Stock_Price:  98.04738246288821
curr_Factors:  [9.80473825e+01 3.41316994e-02]
mat_Sqrt:  [[ 1.81140249e+01  0.00000000e+00]
 [-7.38990656e-03  1.69324031e-02]]
grads:  [3.09021838e-03 3.81306530e+00]
Stock Position:  0.0030902183751308006
Bond Position:  [-9.3125391]


portfolio before change:  [-9.01229321]
curr_Stock_Price:  97.53680624949567
curr_Factors:  [9.75368062e+01 3.44934157e-02]
mat_Sqrt:  [[ 1.81149288e+01  0.00000000e+00]
 [-7.42896124e-03  1.70218886e-02]]
grads:  [-0.00691712 -4.23663595]
Stock Position:  -0.006917120991225835
Bond Position:  [-8.33761932]


portfolio before change:  [-9.00834238]
curr_Stock_Price:  96.81496039864896
curr_Factors:  [9.68149604e+01 3.49890945e-02]
mat_Sqrt:  [[ 1.81095986e+01  0.00000000e+00]
 [-7.48214884e-03  1.71437567e-02]]
grads:  [-0.01633232  7.57857157]
Stock Position:  -0.01633231882907584
Bond Position:  [-7.42712958]


portfolio before change:  [-9.01065272]
curr_Stock_Price:  96.89957117722405
curr_Factors:  [9.68995712e+01 3.58565968e-02]
mat_Sqrt:  [[ 1.83487460e+01  0.00000000e+00]
 [-7.57433528e-03  1.73549824e-02]]
grads:  [0.00790138 1.41719569]
Stock Position:  0.007901376199527589
Bond Position:  [-9.77629269]


portfolio before change:  [-9.004402]
curr_Stock_Price:  97.84533463780082
curr_Factors:  [9.78453346e+01 3.59173109e-02]
mat_Sqrt:  [[ 1.85435137e+01  0.00000000e+00]
 [-7.58074518e-03  1.73696693e-02]]
grads:  [0.06364848 6.06267004]
Stock Position:  0.06364848490994716
Bond Position:  [-15.23210931]


portfolio before change:  [-8.97804827]
curr_Stock_Price:  98.28930222081918
curr_Factors:  [9.82893022e+01 3.68905843e-02]
mat_Sqrt:  [[ 1.88783494e+01  0.00000000e+00]
 [-7.68276870e-03  1.76034345e-02]]
grads:  [3.07560570e-03 4.86943801e+00]
Stock Position:  0.003075605702231675
Bond Position:  [-9.28034741]


portfolio before change:  [-8.97759308]
curr_Stock_Price:  98.81450338546554
curr_Factors:  [9.88145034e+01 3.78030019e-02]
mat_Sqrt:  [[ 1.92124980e+01  0.00000000e+00]
 [-7.77719763e-03  1.78197984e-02]]
grads:  [-1.90304509e-03  3.47567468e+00]
Stock Position:  -0.0019030450919559404
Bond Position:  [-8.78954462]


portfolio before change:  [-8.98102405]
curr_Stock_Price:  100.04001775563216
curr_Factors:  [1.00040018e+02 3.66948276e-02]
mat_Sqrt:  [[ 1.91635598e+01  0.00000000e+00]
 [-7.66235761e-03  1.75566669e-02]]
grads:  [ 0.00581692 -3.38106955]
Stock Position:  0.005816917642267937
Bond Position:  [-9.56294859]


portfolio before change:  [-8.98312058]
curr_Stock_Price:  99.88510999734953
curr_Factors:  [9.98851100e+01 3.72654827e-02]
mat_Sqrt:  [[ 1.92820910e+01  0.00000000e+00]
 [-7.72170787e-03  1.76926554e-02]]
grads:  [ 0.00586629 -5.35771467]
Stock Position:  0.00586629438397488
Bond Position:  [-9.56907604]


portfolio before change:  [-8.99739202]
curr_Stock_Price:  97.65623497782484
curr_Factors:  [9.76562350e+01 3.78463583e-02]
mat_Sqrt:  [[ 1.89981812e+01  0.00000000e+00]
 [-7.78165620e-03  1.78300143e-02]]
grads:  [-2.19771795e-02 -2.47490683e+01]
Stock Position:  -0.02197717950780594
Bond Position:  [-6.85118342]


portfolio before change:  [-8.99413738]
curr_Stock_Price:  97.46917309201368
curr_Factors:  [9.74691731e+01 3.76634119e-02]
mat_Sqrt:  [[ 1.89159045e+01  0.00000000e+00]
 [-7.76282546e-03  1.77868676e-02]]
grads:  [0.00488791 4.29554392]
Stock Position:  0.004887909931415681
Bond Position:  [-9.47055792]


portfolio before change:  [-8.98993715]
curr_Stock_Price:  98.57069176665496
curr_Factors:  [9.85706918e+01 3.77165737e-02]
mat_Sqrt:  [[ 1.91431729e+01  0.00000000e+00]
 [-7.76830213e-03  1.77994163e-02]]
grads:  [0.00909961 2.79907424]
Stock Position:  0.009099613478404094
Bond Position:  [-9.88689235]


portfolio before change:  [-8.99569664]
curr_Stock_Price:  98.07357784494457
curr_Factors:  [9.80735778e+01 3.95296446e-02]
mat_Sqrt:  [[ 1.94990509e+01  0.00000000e+00]
 [-7.95282537e-03  1.82222121e-02]]
grads:  [-0.03085907 -7.85554881]
Stock Position:  -0.03085907099085498
Bond Position:  [-5.96923713]


portfolio before change:  [-8.97794223]
curr_Stock_Price:  97.47405856014613
curr_Factors:  [9.74740586e+01 3.89634673e-02]
mat_Sqrt:  [[ 1.92405662e+01  0.00000000e+00]
 [-7.89566638e-03  1.80912444e-02]]
grads:  [-0.00823628 -2.63731863]
Stock Position:  -0.008236284687954303
Bond Position:  [-8.17511813]


portfolio before change:  [-8.98702318]
curr_Stock_Price:  98.45253325720739
curr_Factors:  [9.84525333e+01 3.98597929e-02]
mat_Sqrt:  [[ 1.96559670e+01  0.00000000e+00]
 [-7.98596698e-03  1.82981491e-02]]
grads:  [-1.05737992e-03 -2.86432434e+00]
Stock Position:  -0.0010573799181360863
Bond Position:  [-8.88292145]


portfolio before change:  [-8.98872672]
curr_Stock_Price:  99.0134594120183
curr_Factors:  [9.90134594e+01 3.92650264e-02]
mat_Sqrt:  [[ 1.96199177e+01  0.00000000e+00]
 [-7.92616189e-03  1.81611184e-02]]
grads:  [-7.40322362e-04  8.91558212e+00]
Stock Position:  -0.0007403223617805272
Bond Position:  [-8.91542485]


portfolio before change:  [-8.99012096]
curr_Stock_Price:  99.39131386880123
curr_Factors:  [9.93913139e+01 3.89390539e-02]
mat_Sqrt:  [[ 1.96128691e+01  0.00000000e+00]
 [-7.89319240e-03  1.80855758e-02]]
grads:  [0.00097475 0.82008924]
Stock Position:  0.0009747513260111186
Bond Position:  [-9.08700277]


portfolio before change:  [-8.99036566]
curr_Stock_Price:  100.30564268890048
curr_Factors:  [1.00305643e+02 3.86257433e-02]
mat_Sqrt:  [[ 1.97135024e+01  0.00000000e+00]
 [-7.86137325e-03  1.80126690e-02]]
grads:  [-2.97522694e-03  4.99882269e+00]
Stock Position:  -0.002975226935524407
Bond Position:  [-8.69193361]


portfolio before change:  [-8.99326552]
curr_Stock_Price:  100.91511017843372
curr_Factors:  [1.00915110e+02 3.88640238e-02]
mat_Sqrt:  [[ 1.98943649e+01  0.00000000e+00]
 [-7.88558419e-03  1.80681432e-02]]
grads:  [-0.00944329  4.43349858]
Stock Position:  -0.00944329230288553
Bond Position:  [-8.04029464]


portfolio before change:  [-8.99699803]
curr_Stock_Price:  101.20392991330468
curr_Factors:  [1.01203930e+02 3.93195986e-02]
mat_Sqrt:  [[ 2.00678994e+01  0.00000000e+00]
 [-7.93166803e-03  1.81737346e-02]]
grads:  [-6.15855566e-03 -1.29251301e+01]
Stock Position:  -0.006158555664089179
Bond Position:  [-8.373728]


portfolio before change:  [-8.9979211]
curr_Stock_Price:  101.1838416185332
curr_Factors:  [1.01183842e+02 3.87634814e-02]
mat_Sqrt:  [[ 1.99215237e+01  0.00000000e+00]
 [-7.87537747e-03  1.80447567e-02]]
grads:  [ 2.37528929e-04 -1.64891274e+00]
Stock Position:  0.00023752892900305087
Bond Position:  [-9.02195519]


portfolio before change:  [-8.99935072]
curr_Stock_Price:  99.91323381680098
curr_Factors:  [9.99132338e+01 3.99126217e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.99935072]
Stock Price:  100.90667522699115
PL:  [-9.90602595]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.49232924e+00  3.66286957e-01]
 [ 9.53785156e-01  8.22004300e-02]
 [ 1.12083455e-01 -4.59360299e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.37055941e-02  3.68702726e-01]
 [-1.98067657e-02 -1.14421616e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.23349509e-01  8.16427083e-01]
 [ 1.41525330e-02  3.70251897e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-8.50025284e-02  1.02763182e-02]
 [ 5.20410400e-02 -1.32636050e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-7.36366695e-02  5.41978205e-02]
 [ 4.74328427e-01  3.08353602e-01]
 [ 1.31845510e-01  7.04266156e-03]
 [ 4.01879395e-02  1.28572681e-01]
 [ 1.95218284e-01  7.45559862e-02]
 [ 1.68001160e-01  1.76555674e-01]
 [-6.01859384e-01  2.75018407e-01]
 [ 9.81448155e-02  8.35211117e-02]
 [ 1.42711139e+00  1.58996938e-01]
 [ 1.60698812e-02  4.02561052e-01]
 [-1.35847486e-01  1.22634750e-01]
 [-1.02116626e-01  6.91273075e-02]
 [ 1.42268181e-01 -9.88275323e-02]
 [-2.03203466e-01 -4.49094706e-01]
 [ 6.19047451e-02  7.04628265e-02]
 [ 2.95857496e-01 -6.57528243e-02]
 [-5.33947825e-01 -1.63548383e-01]
 [-4.53493240e-02 -1.37656116e-02]
 [-3.34688916e-02  1.08635239e-02]
 [ 9.99523469e-02  1.91497555e-01]
 [ 4.00598531e-03  7.82997705e-03]
 [ 5.39294812e-02 -3.41816860e-02]
 [-1.00059779e-01  1.18563127e-01]
 [-4.39334182e-02 -3.19828969e-02]
 [-1.02228567e-01 -5.87514599e-02]
 [ 1.21926470e-01 -1.29803876e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.15007613]
curr_Stock_Price:  99.15351164485617
curr_Factors:  [9.91535116e+01 3.97624382e-02]
mat_Sqrt:  [[ 1.97717269e+01  0.00000000e+00]
 [-7.97620844e-03  1.82757895e-02]]
grads:  [ 0.08356326 20.04219611]
Stock Position:  0.08356326098973062
Bond Position:  [-11.4356669]


portfolio before change:  [-3.18477929]
curr_Stock_Price:  98.7553268605302
curr_Factors:  [9.87553269e+01 3.94850041e-02]
mat_Sqrt:  [[ 1.96235070e+01  0.00000000e+00]
 [-7.94833358e-03  1.82119201e-02]]
grads:  [0.05043239 4.51355098]
Stock Position:  0.05043239032944708
Bond Position:  [-8.16524648]


portfolio before change:  [-3.14854374]
curr_Stock_Price:  99.49406383684244
curr_Factors:  [9.94940638e+01 3.89636946e-02]
mat_Sqrt:  [[ 1.96393557e+01  0.00000000e+00]
 [-7.89568941e-03  1.80912972e-02]]
grads:  [ 0.00468627 -2.53912306]
Stock Position:  0.004686270241003847
Bond Position:  [-3.61479981]


portfolio before change:  [-3.15383703]
curr_Stock_Price:  98.46095782961476
curr_Factors:  [9.84609578e+01 3.76306858e-02]
mat_Sqrt:  [[ 1.91000772e+01  0.00000000e+00]
 [-7.75945212e-03  1.77791384e-02]]
grads:  [-8.53471260e-04 -8.51485654e+00]
Stock Position:  -0.0008534712599090926
Bond Position:  [-3.06980344]


portfolio before change:  [-3.15427666]
curr_Stock_Price:  98.526425107766
curr_Factors:  [9.85264251e+01 3.80545991e-02]
mat_Sqrt:  [[ 1.92201291e+01  0.00000000e+00]
 [-7.80303521e-03  1.78789998e-02]]
grads:  [4.01711496e-03 2.06221115e+01]
Stock Position:  0.0040171149556199656
Bond Position:  [-3.55006863]


portfolio before change:  [-3.1553514]
curr_Stock_Price:  98.36935851648099
curr_Factors:  [9.83693585e+01 3.75490621e-02]
mat_Sqrt:  [[ 1.90616015e+01  0.00000000e+00]
 [-7.75103215e-03  1.77598458e-02]]
grads:  [-3.65889786e-03 -6.44271451e+00]
Stock Position:  -0.0036588978595676344
Bond Position:  [-2.79542796]


portfolio before change:  [-3.15367226]
curr_Stock_Price:  97.81493119575639
curr_Factors:  [9.78149312e+01 3.84615684e-02]
mat_Sqrt:  [[ 1.91830937e+01  0.00000000e+00]
 [-7.84464846e-03  1.79743477e-02]]
grads:  [0.00674416 5.34856056]
Stock Position:  0.0067441560267219106
Bond Position:  [-3.81335141]


portfolio before change:  [-3.15288562]
curr_Stock_Price:  98.00225434118198
curr_Factors:  [9.80022543e+01 3.74526813e-02]
mat_Sqrt:  [[ 1.89660776e+01  0.00000000e+00]
 [-7.74107810e-03  1.77370382e-02]]
grads:  [ 0.06219881 46.02950475]
Stock Position:  0.062198812232918115
Bond Position:  [-9.24850943]


portfolio before change:  [-3.18419331]
curr_Stock_Price:  97.51749339400777
curr_Factors:  [9.75174934e+01 3.74791157e-02]
mat_Sqrt:  [[ 1.88789222e+01  0.00000000e+00]
 [-7.74380947e-03  1.77432965e-02]]
grads:  [9.30899054e-03 2.08671425e+01]
Stock Position:  0.009308990542859297
Bond Position:  [-4.09198273]


portfolio before change:  [-3.18204413]
curr_Stock_Price:  97.80331493700677
curr_Factors:  [9.78033149e+01 3.68525202e-02]
mat_Sqrt:  [[ 1.87753124e+01  0.00000000e+00]
 [-7.67880409e-03  1.75943505e-02]]
grads:  [0.01312544 6.42686602]
Stock Position:  0.013125437380822677
Bond Position:  [-4.46575541]


portfolio before change:  [-3.17660632]
curr_Stock_Price:  98.26014281298703
curr_Factors:  [9.82601428e+01 3.52604082e-02]
mat_Sqrt:  [[ 1.84510489e+01  0.00000000e+00]
 [-7.51110199e-03  1.72100967e-02]]
grads:  [-0.00436385  0.59710985]
Stock Position:  -0.0043638481491799705
Bond Position:  [-2.74781397]


portfolio before change:  [-3.17385888]
curr_Stock_Price:  97.55183886410968
curr_Factors:  [9.75518389e+01 3.52025480e-02]
mat_Sqrt:  [[ 1.83030097e+01  0.00000000e+00]
 [-7.50493683e-03  1.71959705e-02]]
grads:  [-3.19405288e-04 -7.71320524e+00]
Stock Position:  -0.0003194052878917203
Bond Position:  [-3.14270031]


portfolio before change:  [-3.17467057]
curr_Stock_Price:  98.86310085720805
curr_Factors:  [9.88631009e+01 3.57648763e-02]
mat_Sqrt:  [[ 1.86965981e+01  0.00000000e+00]
 [-7.56464157e-03  1.73327713e-02]]
grads:  [-0.00691831 -1.61840277]
Stock Position:  -0.006918311439635475
Bond Position:  [-2.49070485]


portfolio before change:  [-3.17286163]
curr_Stock_Price:  98.55662488106964
curr_Factors:  [9.85566249e+01 3.56402126e-02]
mat_Sqrt:  [[ 1.86061263e+01  0.00000000e+00]
 [-7.55144623e-03  1.73025370e-02]]
grads:  [-2.68636257e-03  3.13236265e+00]
Stock Position:  -0.00268636257349523
Bond Position:  [-2.9081028]


portfolio before change:  [-3.17038616]
curr_Stock_Price:  97.49980351507047
curr_Factors:  [9.74998035e+01 3.57519968e-02]
mat_Sqrt:  [[ 1.84354563e+01  0.00000000e+00]
 [-7.56327937e-03  1.73296501e-02]]
grads:  [ 0.03302902 17.79341184]
Stock Position:  0.03302901542796551
Bond Position:  [-6.39070868]


portfolio before change:  [-3.20504801]
curr_Stock_Price:  96.4745545535662
curr_Factors:  [9.64745546e+01 3.52267564e-02]
mat_Sqrt:  [[ 1.81071087e+01  0.00000000e+00]
 [-7.50751691e-03  1.72018823e-02]]
grads:  [0.00745117 0.40941226]
Stock Position:  0.00745117186516642
Bond Position:  [-3.9238965]


portfolio before change:  [-3.19911513]
curr_Stock_Price:  97.3366212070161
curr_Factors:  [9.73366212e+01 3.50455789e-02]
mat_Sqrt:  [[ 1.82218676e+01  0.00000000e+00]
 [-7.48818578e-03  1.71575891e-02]]
grads:  [5.28494993e-03 7.49363329e+00]
Stock Position:  0.005284949928597973
Bond Position:  [-3.71353429]


portfolio before change:  [-3.2082233]
curr_Stock_Price:  95.7010425109435
curr_Factors:  [9.57010425e+01 3.49510207e-02]
mat_Sqrt:  [[ 1.78914937e+01  0.00000000e+00]
 [-7.47807683e-03  1.71344266e-02]]
grads:  [0.01272991 4.35123907]
Stock Position:  0.012729914406983265
Bond Position:  [-4.42648938]


portfolio before change:  [-3.21995288]
curr_Stock_Price:  94.82309192203965
curr_Factors:  [9.48230919e+01 3.51329131e-02]
mat_Sqrt:  [[ 1.77734277e+01  0.00000000e+00]
 [-7.49751031e-03  1.71789543e-02]]
grads:  [ 0.01378779 10.27744014]
Stock Position:  0.013787794724434956
Bond Position:  [-4.52735421]


portfolio before change:  [-3.22838941]
curr_Stock_Price:  94.25225515919611
curr_Factors:  [9.42522552e+01 3.50476984e-02]
mat_Sqrt:  [[ 1.76449935e+01  0.00000000e+00]
 [-7.48841221e-03  1.71581079e-02]]
grads:  [-0.02730698 16.02848104]
Stock Position:  -0.027306981545072755
Bond Position:  [-0.65464482]


portfolio before change:  [-3.25542043]
curr_Stock_Price:  95.2391523353129
curr_Factors:  [9.52391523e+01 3.32513233e-02]
mat_Sqrt:  [[ 1.73668074e+01  0.00000000e+00]
 [-7.29397815e-03  1.67126035e-02]]
grads:  [0.00775021 4.99749256]
Stock Position:  0.007750210724665096
Bond Position:  [-3.99354393]


portfolio before change:  [-3.25201627]
curr_Stock_Price:  95.74280179050396
curr_Factors:  [9.57428018e+01 3.33321431e-02]
mat_Sqrt:  [[ 1.74798520e+01  0.00000000e+00]
 [-7.30283705e-03  1.67329018e-02]]
grads:  [0.08561304 9.50205408]
Stock Position:  0.08561304415600968
Bond Position:  [-11.44884898]


portfolio before change:  [-3.23188084]
curr_Stock_Price:  95.99470990508536
curr_Factors:  [9.59947099e+01 3.27844237e-02]
mat_Sqrt:  [[ 1.73812529e+01  0.00000000e+00]
 [-7.24258780e-03  1.65948534e-02]]
grads:  [1.10326873e-02 2.42581867e+01]
Stock Position:  0.01103268732656923
Bond Position:  [-4.29096046]


portfolio before change:  [-3.23052482]
curr_Stock_Price:  96.16623867460575
curr_Factors:  [9.61662387e+01 3.29526843e-02]
mat_Sqrt:  [[ 1.74569364e+01  0.00000000e+00]
 [-7.26114970e-03  1.66373841e-02]]
grads:  [-4.71590730e-03  7.37103556e+00]
Stock Position:  -0.004715907298339441
Bond Position:  [-2.77701376]


portfolio before change:  [-3.24228151]
curr_Stock_Price:  98.58561257303752
curr_Factors:  [9.85856126e+01 3.08742328e-02]
mat_Sqrt:  [[ 1.73225422e+01  0.00000000e+00]
 [-7.02842604e-03  1.61041472e-02]]
grads:  [-4.15337398e-03  4.29251588e+00]
Stock Position:  -0.004153373975696403
Bond Position:  [-2.8328186]


portfolio before change:  [-3.23626509]
curr_Stock_Price:  97.05178874427921
curr_Factors:  [9.70517887e+01 3.12157001e-02]
mat_Sqrt:  [[ 1.71470764e+01  0.00000000e+00]
 [-7.06718616e-03  1.61929578e-02]]
grads:  [ 5.78152843e-03 -6.10311802e+00]
Stock Position:  0.005781528429241471
Bond Position:  [-3.79737277]


portfolio before change:  [-3.23567021]
curr_Stock_Price:  97.23678989241708
curr_Factors:  [9.72367899e+01 3.16941507e-02]
mat_Sqrt:  [[ 1.73109209e+01  0.00000000e+00]
 [-7.12114044e-03  1.63165826e-02]]
grads:  [-2.30608450e-02 -2.75238215e+01]
Stock Position:  -0.023060845049700605
Bond Position:  [-0.99330766]


portfolio before change:  [-3.23388618]
curr_Stock_Price:  97.15404381825006
curr_Factors:  [9.71540438e+01 3.33677542e-02]
mat_Sqrt:  [[ 1.77469764e+01  0.00000000e+00]
 [-7.30673708e-03  1.67418379e-02]]
grads:  [0.00522102 4.20878681]
Stock Position:  0.0052210157901465964
Bond Position:  [-3.74112898]


portfolio before change:  [-3.23454432]
curr_Stock_Price:  97.11756246278796
curr_Factors:  [9.71175625e+01 3.35881462e-02]
mat_Sqrt:  [[ 1.77988028e+01  0.00000000e+00]
 [-7.33082764e-03  1.67970363e-02]]
grads:  [ 0.01501003 -3.91454916]
Stock Position:  0.015010032631446485
Bond Position:  [-4.6922821]


portfolio before change:  [-3.22910205]
curr_Stock_Price:  97.51921705901242
curr_Factors:  [9.75192171e+01 3.25340304e-02]
mat_Sqrt:  [[ 1.75897287e+01  0.00000000e+00]
 [-7.21487690e-03  1.65313598e-02]]
grads:  [-0.03441362 -9.89322022]
Stock Position:  -0.03441361732304763
Bond Position:  [0.12688697]


portfolio before change:  [-3.20447803]
curr_Stock_Price:  96.80414683155885
curr_Factors:  [9.68041468e+01 3.23414896e-02]
mat_Sqrt:  [[ 1.74090059e+01  0.00000000e+00]
 [-7.19349591e-03  1.64823698e-02]]
grads:  [-0.00295003 -0.83517187]
Stock Position:  -0.0029500322932238016
Bond Position:  [-2.91890267]


portfolio before change:  [-3.20513553]
curr_Stock_Price:  96.9033374269791
curr_Factors:  [9.69033374e+01 3.25168938e-02]
mat_Sqrt:  [[ 1.74740374e+01  0.00000000e+00]
 [-7.21297651e-03  1.65270054e-02]]
grads:  [-0.00164402  0.65731956]
Stock Position:  -0.0016440196597876408
Bond Position:  [-3.04582454]


portfolio before change:  [-3.20598873]
curr_Stock_Price:  97.19071017612437
curr_Factors:  [9.71907102e+01 3.21126558e-02]
mat_Sqrt:  [[ 1.74165796e+01  0.00000000e+00]
 [-7.16800177e-03  1.64239553e-02]]
grads:  [1.05375875e-02 1.16596490e+01]
Stock Position:  0.010537587549619632
Bond Position:  [-4.23014435]


portfolio before change:  [-3.20164029]
curr_Stock_Price:  97.65355250615238
curr_Factors:  [9.76535525e+01 3.11246100e-02]
mat_Sqrt:  [[ 1.72282040e+01  0.00000000e+00]
 [-7.05686729e-03  1.61693143e-02]]
grads:  [4.30878776e-04 4.84249172e-01]
Stock Position:  0.0004308787758243478
Bond Position:  [-3.24371713]


portfolio before change:  [-3.20205136]
curr_Stock_Price:  97.64060890251183
curr_Factors:  [9.76406089e+01 3.09063125e-02]
mat_Sqrt:  [[ 1.71654058e+01  0.00000000e+00]
 [-7.03207651e-03  1.61125114e-02]]
grads:  [ 0.00227267 -2.1214375 ]
Stock Position:  0.0022726739365449187
Bond Position:  [-3.42395662]


portfolio before change:  [-3.20144283]
curr_Stock_Price:  98.09670072769018
curr_Factors:  [9.80967007e+01 3.09550915e-02]
mat_Sqrt:  [[ 1.72591915e+01  0.00000000e+00]
 [-7.03762364e-03  1.61252215e-02]]
grads:  [-2.79935408e-03  7.35265105e+00]
Stock Position:  -0.0027993540786202414
Bond Position:  [-2.92683543]


portfolio before change:  [-3.1988387]
curr_Stock_Price:  97.03573930397536
curr_Factors:  [9.70357393e+01 3.14223956e-02]
mat_Sqrt:  [[ 1.72009077e+01  0.00000000e+00]
 [-7.09054532e-03  1.62464803e-02]]
grads:  [-0.00336563 -1.96860466]
Stock Position:  -0.003365630454393017
Bond Position:  [-2.87225226]


portfolio before change:  [-3.20297655]
curr_Stock_Price:  98.15849870330337
curr_Factors:  [9.81584987e+01 3.17383913e-02]
mat_Sqrt:  [[ 1.74872034e+01  0.00000000e+00]
 [-7.12610876e-03  1.63279664e-02]]
grads:  [-0.00731219 -3.59821049]
Stock Position:  -0.00731219296145555
Bond Position:  [-2.48522267]


portfolio before change:  [-3.20511598]
curr_Stock_Price:  98.40859573163655
curr_Factors:  [9.84085957e+01 3.26686630e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.20511598]
Stock Price:  96.94553421886509
PL:  [-3.20511598]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.15741304e+00  2.90569114e-01]
 [-2.66404879e-01 -1.00611891e-01]
 [-3.80612958e-01 -1.52391771e-01]
 [-4.36633696e-02 -1.30591437e-01]
 [-1.25960201e-01 -8.11780382e-01]
 [-1.60428007e-01  3.20577824e-02]
 [ 4.93770438e-01 -6.00155972e-01]
 [-8.70979112e-01  3.86567957e-02]
 [-9.55919559e-02 -1.96031852e-01]
 [-6.17089139e-01 -8.10921094e-01]
 [-3.59503050e-03 -2.19004195e-02]
 [-3.40090682e-01 -2.96887199e-01]
 [-1.74993296e-02  1.26746180e-02]
 [ 2.27061256e-02 -1.94994848e-01]
 [-1.94099005e-01 -1.28437620e-01]
 [ 8.21602165e-02 -1.16822062e+00]
 [ 1.86135832e-02 -2.97630112e-01]
 [ 3.83066995e-02 -1.60369897e-01]
 [-1.20064101e-01 -4.08676619e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.46571329e-01 -3.02927749e-02]
 [ 4.62415946e-01 -2.91872757e-01]
 [ 3.05040310e-02 -4.08961745e-01]
 [ 2.39895619e-02  1.93707565e-02]
 [ 2.36887755e-01 -1.47160681e-01]
 [ 1.32507265e-01 -8.71081156e-02]
 [-9.25448413e-02 -5.81900210e-02]
 [ 5.51558894e-02  2.61618958e-01]
 [-2.27213415e-02  1.85771791e-01]
 [-5.69803623e-01 -8.91484235e-02]
 [-1.68410036e-01 -6.36440577e-02]
 [ 1.37889569e-02 -6.39237198e-02]
 [-2.58692553e-01  1.36149345e-01]
 [ 1.86783120e-02  2.05058091e-02]
 [-7.63781916e-02  9.40676513e-02]
 [-1.64389540e-01  1.05542944e-01]
 [-3.38892132e-02 -1.20329853e-01]
 [-5.25758413e-02 -4.37319210e-02]
 [-6.36961997e-03 -1.07146672e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.77457535]
curr_Stock_Price:  100.73927904938638
curr_Factors:  [1.00739279e+02 4.03054639e-02]
mat_Sqrt:  [[ 2.02246400e+01  0.00000000e+00]
 [-8.03048829e-03  1.84001602e-02]]
grads:  [ 0.06349818 15.79166217]
Stock Position:  0.06349817834884276
Bond Position:  [1.37781464]


portfolio before change:  [7.85645581]
curr_Stock_Price:  102.02605963671216
curr_Factors:  [1.02026060e+02 3.97328516e-02]
mat_Sqrt:  [[ 2.03369575e+01  0.00000000e+00]
 [-7.97324041e-03  1.82689888e-02]]
grads:  [-0.0152587  -5.50725011]
Stock Position:  -0.015258698707704672
Bond Position:  [9.41324072]


portfolio before change:  [7.85307766]
curr_Stock_Price:  102.32456993319738
curr_Factors:  [1.02324570e+02 3.81877046e-02]
mat_Sqrt:  [[ 1.99959345e+01  0.00000000e+00]
 [-7.81666984e-03  1.79102406e-02]]
grads:  [-0.02236065 -8.50863896]
Stock Position:  -0.02236065432457095
Bond Position:  [10.141122]


portfolio before change:  [7.83750123]
curr_Stock_Price:  103.0778640718636
curr_Factors:  [1.03077864e+02 3.67119582e-02]
mat_Sqrt:  [[ 1.97500949e+01  0.00000000e+00]
 [-7.66414595e-03  1.75607645e-02]]
grads:  [-5.09659047e-03 -7.43654622e+00]
Stock Position:  -0.005096590467042581
Bond Position:  [8.36284689]


portfolio before change:  [7.83312695]
curr_Stock_Price:  104.14126075224772
curr_Factors:  [1.04141261e+02 3.69748684e-02]
mat_Sqrt:  [[ 2.00251671e+01  0.00000000e+00]
 [-7.69154012e-03  1.76235324e-02]]
grads:  [-2.39823320e-02 -4.60622969e+01]
Stock Position:  -0.023982331965962677
Bond Position:  [10.33067724]


portfolio before change:  [7.80396376]
curr_Stock_Price:  105.4111378066783
curr_Factors:  [1.05411138e+02 3.55894416e-02]
mat_Sqrt:  [[ 1.98859841e+01  0.00000000e+00]
 [-7.54606563e-03  1.72902085e-02]]
grads:  [-0.00736382  1.8541004 ]
Stock Position:  -0.007363821836315569
Bond Position:  [8.5801926]


portfolio before change:  [7.80153924]
curr_Stock_Price:  105.88604178940254
curr_Factors:  [1.05886042e+02 3.50693677e-02]
mat_Sqrt:  [[ 1.98290853e+01  0.00000000e+00]
 [-7.49072682e-03  1.71634113e-02]]
grads:  [ 1.16919613e-02 -3.49671730e+01]
Stock Position:  0.011691961292038361
Bond Position:  [6.56352374]


portfolio before change:  [7.80367311]
curr_Stock_Price:  105.99837351614423
curr_Factors:  [1.05998374e+02 3.46737955e-02]
mat_Sqrt:  [[ 1.97378522e+01  0.00000000e+00]
 [-7.44836041e-03  1.70663377e-02]]
grads:  [-0.04327259  2.26509028]
Stock Position:  -0.043272585790421085
Bond Position:  [12.39049682]


portfolio before change:  [7.77969808]
curr_Stock_Price:  106.58821436884212
curr_Factors:  [1.06588214e+02 3.35556867e-02]
mat_Sqrt:  [[ 1.95250544e+01  0.00000000e+00]
 [-7.32728453e-03  1.67889180e-02]]
grads:  [-9.27768327e-03 -1.16762648e+01]
Stock Position:  -0.00927768327082436
Bond Position:  [8.76858977]


portfolio before change:  [7.78333651]
curr_Stock_Price:  106.31419288425742
curr_Factors:  [1.06314193e+02 3.45194548e-02]
mat_Sqrt:  [[ 1.97525518e+01  0.00000000e+00]
 [-7.43176477e-03  1.70283123e-02]]
grads:  [ -0.04915841 -47.62192982]
Stock Position:  -0.04915841394980875
Bond Position:  [13.00957361]


portfolio before change:  [7.76283976]
curr_Stock_Price:  106.76422865791702
curr_Factors:  [1.06764229e+02 3.30827403e-02]
mat_Sqrt:  [[ 1.94189840e+01  0.00000000e+00]
 [-7.27546455e-03  1.66701835e-02]]
grads:  [-6.77334981e-04 -1.31374796e+00]
Stock Position:  -0.0006773349809316978
Bond Position:  [7.83515491]


portfolio before change:  [7.76402932]
curr_Stock_Price:  106.45403286978656
curr_Factors:  [1.06454033e+02 3.37402066e-02]
mat_Sqrt:  [[ 1.95540170e+01  0.00000000e+00]
 [-7.34740298e-03  1.68350152e-02]]
grads:  [ -0.02401874 -17.63510136]
Stock Position:  -0.024018741497207105
Bond Position:  [10.32092122]


portfolio before change:  [7.77458259]
curr_Stock_Price:  106.0683728456698
curr_Factors:  [1.06068373e+02 3.32829842e-02]
mat_Sqrt:  [[ 1.93507159e+01  0.00000000e+00]
 [-7.29744988e-03  1.67205582e-02]]
grads:  [-6.18461500e-04  7.58026011e-01]
Stock Position:  -0.0006184614995844226
Bond Position:  [7.84018179]


portfolio before change:  [7.77600903]
curr_Stock_Price:  105.3466454423977
curr_Factors:  [1.05346645e+02 3.39043075e-02]
mat_Sqrt:  [[ 1.93976067e+01  0.00000000e+00]
 [-7.36524894e-03  1.68759054e-02]]
grads:  [-3.21671657e-03 -1.15546303e+01]
Stock Position:  -0.0032167165738908065
Bond Position:  [8.11487933]


portfolio before change:  [7.77165541]
curr_Stock_Price:  107.01544018972719
curr_Factors:  [1.07015440e+02 3.47993063e-02]
mat_Sqrt:  [[ 1.99632725e+01  0.00000000e+00]
 [-7.46182887e-03  1.70971978e-02]]
grads:  [-0.0125307  -7.51220297]
Stock Position:  -0.012530699963655996
Bond Position:  [9.11263379]


portfolio before change:  [7.76857518]
curr_Stock_Price:  107.35216437902416
curr_Factors:  [1.07352164e+02 3.42383998e-02]
mat_Sqrt:  [[ 1.98640379e+01  0.00000000e+00]
 [-7.40144848e-03  1.69588490e-02]]
grads:  [-2.15310232e-02 -6.88856078e+01]
Stock Position:  -0.021531023243118962
Bond Position:  [10.07997712]


portfolio before change:  [7.81565912]
curr_Stock_Price:  105.22389238084618
curr_Factors:  [1.05223892e+02 3.55911500e-02]
mat_Sqrt:  [[ 1.98511364e+01  0.00000000e+00]
 [-7.54624675e-03  1.72906235e-02]]
grads:  [-5.60586783e-03 -1.72133823e+01]
Stock Position:  -0.005605867827586208
Bond Position:  [8.40553036]


portfolio before change:  [7.8182432]
curr_Stock_Price:  104.95037230519024
curr_Factors:  [1.04950372e+02 3.62159054e-02]
mat_Sqrt:  [[ 1.99725564e+01  0.00000000e+00]
 [-7.61219079e-03  1.74417203e-02]]
grads:  [-1.58639990e-03 -9.19461466e+00]
Stock Position:  -0.0015863999000845148
Bond Position:  [7.98473646]


portfolio before change:  [7.82077555]
curr_Stock_Price:  103.98328081134727
curr_Factors:  [1.03983281e+02 3.58653616e-02]
mat_Sqrt:  [[ 1.96925122e+01  0.00000000e+00]
 [-7.57526096e-03  1.73571034e-02]]
grads:  [-1.51542473e-02 -2.35452086e+01]
Stock Position:  -0.015154247309471966
Bond Position:  [9.3965639]


portfolio before change:  [7.82994402]
curr_Stock_Price:  103.45578306455899
curr_Factors:  [1.03455783e+02 3.61457593e-02]
mat_Sqrt:  [[ 1.96690529e+01  0.00000000e+00]
 [-7.60481524e-03  1.74248207e-02]]
grads:  [-2.46382326e-04 -6.26080410e+00]
Stock Position:  -0.0002463823262232504
Bond Position:  [7.8554337]


portfolio before change:  [7.83100149]
curr_Stock_Price:  103.1494300786238
curr_Factors:  [1.03149430e+02 3.61148867e-02]
mat_Sqrt:  [[ 1.96024322e+01  0.00000000e+00]
 [-7.60156686e-03  1.74173778e-02]]
grads:  [ 0.00680275 -1.73922707]
Stock Position:  0.006802751672122963
Bond Position:  [7.12930154]


portfolio before change:  [7.83090425]
curr_Stock_Price:  103.00412663462838
curr_Factors:  [1.03004127e+02 3.64836711e-02]
mat_Sqrt:  [[ 1.96745084e+01  0.00000000e+00]
 [-7.64027969e-03  1.75060800e-02]]
grads:  [  0.01702875 -16.67265071]
Stock Position:  0.017028747282671855
Bond Position:  [6.07687301]


portfolio before change:  [7.80757855]
curr_Stock_Price:  101.58973308830123
curr_Factors:  [1.01589733e+02 3.56627233e-02]
mat_Sqrt:  [[ 1.91847910e+01  0.00000000e+00]
 [-7.55383064e-03  1.73080003e-02]]
grads:  [-7.71348031e-03 -2.36284803e+01]
Stock Position:  -0.007713480312527991
Bond Position:  [8.59118896]


portfolio before change:  [7.81522181]
curr_Stock_Price:  100.73806972051679
curr_Factors:  [1.00738070e+02 3.62462434e-02]
mat_Sqrt:  [[ 1.91789632e+01  0.00000000e+00]
 [-7.61537848e-03  1.74490242e-02]]
grads:  [0.00169163 1.11013408]
Stock Position:  0.0016916270579821397
Bond Position:  [7.64481056]


portfolio before change:  [7.81680874]
curr_Stock_Price:  101.11124205723054
curr_Factors:  [1.01111242e+02 3.47049636e-02]
mat_Sqrt:  [[ 1.88362845e+01  0.00000000e+00]
 [-7.45170730e-03  1.70740064e-02]]
grads:  [ 0.00916643 -8.61898946]
Stock Position:  0.009166434525059065
Bond Position:  [6.88997916]


portfolio before change:  [7.82028499]
curr_Stock_Price:  101.3965163021435
curr_Factors:  [1.01396516e+02 3.42791473e-02]
mat_Sqrt:  [[ 1.87731884e+01  0.00000000e+00]
 [-7.40585144e-03  1.69689374e-02]]
grads:  [ 5.03325084e-03 -5.13338658e+00]
Stock Position:  0.0050332508414188196
Bond Position:  [7.30993089]


portfolio before change:  [7.82107672]
curr_Stock_Price:  101.37226367346017
curr_Factors:  [1.01372264e+02 3.45644334e-02]
mat_Sqrt:  [[ 1.88466370e+01  0.00000000e+00]
 [-7.43660497e-03  1.70394026e-02]]
grads:  [-0.00625794 -3.41502707]
Stock Position:  -0.006257936027569983
Bond Position:  [8.45545786]


portfolio before change:  [7.82362479]
curr_Stock_Price:  101.13399345799354
curr_Factors:  [1.01133993e+02 3.41112397e-02]
mat_Sqrt:  [[ 1.86786682e+01  0.00000000e+00]
 [-7.38769135e-03  1.69273274e-02]]
grads:  [9.06573004e-03 1.54554202e+01]
Stock Position:  0.009065730044134296
Bond Position:  [6.90677131]


portfolio before change:  [7.82712073]
curr_Stock_Price:  101.42437647451783
curr_Factors:  [1.01424376e+02 3.41852376e-02]
mat_Sqrt:  [[ 1.87526068e+01  0.00000000e+00]
 [-7.39570012e-03  1.69456778e-02]]
grads:  [3.11189350e-03 1.09627832e+01]
Stock Position:  0.0031118934978074725
Bond Position:  [7.51149887]


portfolio before change:  [7.82765576]
curr_Stock_Price:  101.29456229646291
curr_Factors:  [1.01294562e+02 3.48098406e-02]
mat_Sqrt:  [[ 1.88989271e+01  0.00000000e+00]
 [-7.46295819e-03  1.70997854e-02]]
grads:  [-0.03220877 -5.21342353]
Stock Position:  -0.03220876944142833
Bond Position:  [11.09022896]


portfolio before change:  [7.84231524]
curr_Stock_Price:  100.88246589529871
curr_Factors:  [1.00882466e+02 3.50399718e-02]
mat_Sqrt:  [[ 1.88841553e+01  0.00000000e+00]
 [-7.48758672e-03  1.71562164e-02]]
grads:  [-0.01038895 -3.70967911]
Stock Position:  -0.010388951856057543
Bond Position:  [8.89037832]


portfolio before change:  [7.83667712]
curr_Stock_Price:  101.53214486643567
curr_Factors:  [1.01532145e+02 3.55352226e-02]
mat_Sqrt:  [[ 1.91396098e+01  0.00000000e+00]
 [-7.54031538e-03  1.72770330e-02]]
grads:  [-7.37195885e-04 -3.69992462e+00]
Stock Position:  -0.0007371958845850988
Bond Position:  [7.9115262]


portfolio before change:  [7.83817071]
curr_Stock_Price:  100.84767747318173
curr_Factors:  [1.00847677e+02 3.67888634e-02]
mat_Sqrt:  [[ 1.93430113e+01  0.00000000e+00]
 [-7.67216928e-03  1.75791482e-02]]
grads:  [-0.01030202  7.74493412]
Stock Position:  -0.010302020907440087
Bond Position:  [8.87710559]


portfolio before change:  [7.8527403]
curr_Stock_Price:  99.54114983047778
curr_Factors:  [9.95411498e+01 3.80420932e-02]
mat_Sqrt:  [[ 1.94148865e+01  0.00000000e+00]
 [-7.80175295e-03  1.78760617e-02]]
grads:  [0.00142302 1.14710999]
Stock Position:  0.0014230204635022592
Bond Position:  [7.7110912]


portfolio before change:  [7.85434082]
curr_Stock_Price:  99.9884900305372
curr_Factors:  [9.99884900e+01 3.66915144e-02]
mat_Sqrt:  [[ 1.91528245e+01  0.00000000e+00]
 [-7.66201169e-03  1.75558743e-02]]
grads:  [-1.84430776e-03  5.35818666e+00]
Stock Position:  -0.0018443077578839764
Bond Position:  [8.03875036]


portfolio before change:  [7.85629715]
curr_Stock_Price:  99.47261972825336
curr_Factors:  [9.94726197e+01 3.43624166e-02]
mat_Sqrt:  [[ 1.84393414e+01  0.00000000e+00]
 [-7.41484096e-03  1.69895350e-02]]
grads:  [-0.00641709  6.21223268]
Stock Position:  -0.00641708507736267
Bond Position:  [8.49462141]


portfolio before change:  [7.8606723]
curr_Stock_Price:  98.95630102571818
curr_Factors:  [9.89563010e+01 3.60078814e-02]
mat_Sqrt:  [[ 1.87776931e+01  0.00000000e+00]
 [-7.59029711e-03  1.73915555e-02]]
grads:  [-4.60149530e-03 -6.91886664e+00]
Stock Position:  -0.004601495299509142
Bond Position:  [8.31601926]


portfolio before change:  [7.8597315]
curr_Stock_Price:  99.38667674529577
curr_Factors:  [9.93866767e+01 3.52037681e-02]
mat_Sqrt:  [[ 1.86475914e+01  0.00000000e+00]
 [-7.50506689e-03  1.71962685e-02]]
grads:  [-0.00384296 -2.54310526]
Stock Position:  -0.0038429636710050437
Bond Position:  [8.24167089]


portfolio before change:  [7.85794733]
curr_Stock_Price:  100.11903828472383
curr_Factors:  [1.00119038e+02 3.35792365e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.85794733]
Stock Price:  98.13496611600642
PL:  [7.85794733]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.40587398e+00  3.46741153e-01]
 [-1.74415367e-01 -4.21496710e-02]
 [-2.28788688e-01 -1.16461371e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.22831054e-02  1.63300507e-01]
 [-5.97897930e-02 -1.15817879e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 6.66504526e-01  6.71187192e-01]
 [-4.44456852e-02  2.00900484e-01]
 [ 1.81458814e-01  4.54836279e-02]
 [-7.13670974e-02 -1.26017790e-02]
 [ 2.87705748e-02 -1.35728929e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-7.41897588e-02  5.62906387e-02]
 [ 3.81757808e-01  2.64849367e-01]
 [ 1.30029855e-01  7.91400134e-02]
 [ 3.99733029e-02  1.25392065e-01]
 [ 1.29230562e-01  8.21655908e-02]
 [ 3.49563206e-03  1.64750945e-02]
 [-3.91402224e-01  1.52105516e-01]
 [ 1.26780422e-01  3.67810410e-02]
 [ 1.37228426e+00  1.48799230e-01]
 [ 1.85341365e-02  2.22182399e-01]
 [-7.11979039e-02  6.56552145e-02]
 [-1.49330706e-01  9.64016614e-02]
 [ 1.25833720e-01 -1.04735081e-01]
 [-1.98369902e-01 -4.46915246e-01]
 [ 7.26066632e-02  4.76812577e-02]
 [ 4.24994851e-01 -2.20073526e-01]
 [-5.20778419e-01 -2.28574347e-01]
 [ 1.02579324e-01  4.08995175e-02]
 [-1.27369007e-01  1.71785504e-01]
 [ 5.01435936e-01  2.30468410e-01]
 [ 5.17018259e-02 -7.12582083e-02]
 [ 2.74776093e-01 -3.18509053e-01]
 [ 1.04319433e-01  5.80084401e-02]
 [-5.82696001e-02  2.10565029e-01]
 [-3.49297262e-01 -1.27962414e-01]
 [ 1.35436966e-01 -2.96311909e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.28275275]
curr_Stock_Price:  99.65180380095964
curr_Factors:  [9.96518038e+01 3.84317084e-02]
mat_Sqrt:  [[ 1.95357464e+01  0.00000000e+00]
 [-7.84160273e-03  1.79673690e-02]]
grads:  [ 0.07971051 19.2983821 ]
Stock Position:  0.07971050545214606
Bond Position:  [-7.6605429]


portfolio before change:  [0.40775978]
curr_Stock_Price:  101.23208058461437
curr_Factors:  [1.01232081e+02 3.68390527e-02]
mat_Sqrt:  [[ 1.94299816e+01  0.00000000e+00]
 [-7.67740089e-03  1.75911353e-02]]
grads:  [-0.00992337 -2.39607451]
Stock Position:  -0.009923374899406562
Bond Position:  [1.41232367]


portfolio before change:  [0.40245931]
curr_Stock_Price:  101.78401201979688
curr_Factors:  [1.01784012e+02 3.74233048e-02]
mat_Sqrt:  [[ 1.96902229e+01  0.00000000e+00]
 [-7.73804159e-03  1.77300807e-02]]
grads:  [-0.01420078 -6.56857536]
Stock Position:  -0.014200783726393914
Bond Position:  [1.84787206]


portfolio before change:  [0.41843075]
curr_Stock_Price:  100.67559178324086
curr_Factors:  [1.00675592e+02 3.92005044e-02]
mat_Sqrt:  [[ 1.99328785e+01  0.00000000e+00]
 [-7.91964690e-03  1.81461907e-02]]
grads:  [-8.17812991e-04 -8.34262215e+00]
Stock Position:  -0.0008178129911397881
Bond Position:  [0.50076455]


portfolio before change:  [0.4191578]
curr_Stock_Price:  99.86311916772786
curr_Factors:  [9.98631192e+01 3.91008213e-02]
mat_Sqrt:  [[ 1.97468609e+01  0.00000000e+00]
 [-7.90957104e-03  1.81231040e-02]]
grads:  [-5.57704910e-04  9.01062571e+00]
Stock Position:  -0.0005577049095148118
Bond Position:  [0.47485195]


portfolio before change:  [0.41988514]
curr_Stock_Price:  98.66538799141435
curr_Factors:  [9.86653880e+01 3.94119838e-02]
mat_Sqrt:  [[ 1.95874985e+01  0.00000000e+00]
 [-7.94098067e-03  1.81950725e-02]]
grads:  [-5.63302453e-03 -6.36534307e+00]
Stock Position:  -0.005633024525550133
Bond Position:  [0.97566969]


portfolio before change:  [0.4195323]
curr_Stock_Price:  98.74967688423733
curr_Factors:  [9.87496769e+01 3.91973163e-02]
mat_Sqrt:  [[ 1.95507692e+01  0.00000000e+00]
 [-7.91932485e-03  1.81454528e-02]]
grads:  [0.00661732 5.29812556]
Stock Position:  0.0066173241372977564
Bond Position:  [-0.23392632]


portfolio before change:  [0.42051952]
curr_Stock_Price:  98.90328275112437
curr_Factors:  [9.89032828e+01 4.04099852e-02]
mat_Sqrt:  [[ 1.98817703e+01  0.00000000e+00]
 [-8.04089400e-03  1.84240027e-02]]
grads:  [ 0.048257   36.43004201]
Stock Position:  0.04825700209306946
Bond Position:  [-4.3522564]


portfolio before change:  [0.43333021]
curr_Stock_Price:  99.18002499033393
curr_Factors:  [9.91800250e+01 3.87042731e-02]
mat_Sqrt:  [[ 1.95120846e+01  0.00000000e+00]
 [-7.86936064e-03  1.80309704e-02]]
grads:  [2.21577935e-03 1.11419674e+01]
Stock Position:  0.0022157793531794863
Bond Position:  [0.21356915]


portfolio before change:  [0.43452549]
curr_Stock_Price:  99.70741690131152
curr_Factors:  [9.97074169e+01 3.79203486e-02]
mat_Sqrt:  [[ 1.94161727e+01  0.00000000e+00]
 [-7.78925913e-03  1.78474348e-02]]
grads:  [0.01036813 2.54846864]
Stock Position:  0.010368134844363103
Bond Position:  [-0.59925446]


portfolio before change:  [0.45101376]
curr_Stock_Price:  101.30492514975127
curr_Factors:  [1.01304925e+02 3.74852489e-02]
mat_Sqrt:  [[ 1.96137556e+01  0.00000000e+00]
 [-7.74444306e-03  1.77447483e-02]]
grads:  [-0.00391903 -0.7101695 ]
Stock Position:  -0.003919033466535134
Bond Position:  [0.84803115]


portfolio before change:  [0.45710928]
curr_Stock_Price:  99.77661089563281
curr_Factors:  [9.97766109e+01 3.76213330e-02]
mat_Sqrt:  [[ 1.93528904e+01  0.00000000e+00]
 [-7.75848779e-03  1.77769288e-02]]
grads:  [-1.57425508e-03 -7.63511686e+00]
Stock Position:  -0.0015742550826375443
Bond Position:  [0.61418312]


portfolio before change:  [0.45714088]
curr_Stock_Price:  99.80531264847127
curr_Factors:  [9.98053126e+01 3.87588521e-02]
mat_Sqrt:  [[ 1.96489394e+01  0.00000000e+00]
 [-7.87490720e-03  1.80436792e-02]]
grads:  [-0.006583   -1.55463888]
Stock Position:  -0.006582995941669464
Bond Position:  [1.11415884]


portfolio before change:  [0.465654]
curr_Stock_Price:  98.53327080026365
curr_Factors:  [9.85332708e+01 3.90518765e-02]
mat_Sqrt:  [[ 1.94716992e+01  0.00000000e+00]
 [-7.90461905e-03  1.81117576e-02]]
grads:  [-2.54844271e-03  3.10796114e+00]
Stock Position:  -0.002548442707686797
Bond Position:  [0.7167604]


portfolio before change:  [0.47121312]
curr_Stock_Price:  96.38705108717255
curr_Factors:  [9.63870511e+01 4.18185942e-02]
mat_Sqrt:  [[ 1.97107617e+01  0.00000000e+00]
 [-8.17983807e-03  1.87423636e-02]]
grads:  [ 0.02523228 14.13105481]
Stock Position:  0.025232284501415972
Bond Position:  [-1.96085238]


portfolio before change:  [0.51098161]
curr_Stock_Price:  97.97286121086098
curr_Factors:  [9.79728612e+01 3.96443578e-02]
mat_Sqrt:  [[ 1.95072695e+01  0.00000000e+00]
 [-7.96435637e-03  1.82486330e-02]]
grads:  [0.00843631 4.33676394]
Stock Position:  0.008436310776827273
Bond Position:  [-0.31554789]


portfolio before change:  [0.50891322]
curr_Stock_Price:  97.73235994103091
curr_Factors:  [9.77323599e+01 3.99870493e-02]
mat_Sqrt:  [[ 1.95433075e+01  0.00000000e+00]
 [-7.99870482e-03  1.83273352e-02]]
grads:  [4.84559160e-03 6.84180562e+00]
Stock Position:  0.004845591601293817
Bond Position:  [0.03534212]


portfolio before change:  [0.50330404]
curr_Stock_Price:  96.57386313611273
curr_Factors:  [9.65738631e+01 4.02827722e-02]
mat_Sqrt:  [[ 1.93829234e+01  0.00000000e+00]
 [-8.02822742e-03  1.83949799e-02]]
grads:  [0.00851732 4.4667399 ]
Stock Position:  0.008517320213726304
Bond Position:  [-0.31924648]


portfolio before change:  [0.50287579]
curr_Stock_Price:  96.52826865263827
curr_Factors:  [9.65282687e+01 4.00382585e-02]
mat_Sqrt:  [[ 1.93148841e+01  0.00000000e+00]
 [-8.00382494e-03  1.83390668e-02]]
grads:  [5.53249646e-04 8.98360568e-01]
Stock Position:  0.0005532496455294393
Bond Position:  [0.44947155]


portfolio before change:  [0.50287083]
curr_Stock_Price:  96.41776043584792
curr_Factors:  [9.64177604e+01 4.06620738e-02]
mat_Sqrt:  [[ 1.94424863e+01  0.00000000e+00]
 [-8.06593566e-03  1.84813803e-02]]
grads:  [-0.01671689  8.23020322]
Stock Position:  -0.01671689153142669
Bond Position:  [2.11467608]


portfolio before change:  [0.50076171]
curr_Stock_Price:  96.55974114599651
curr_Factors:  [9.65597411e+01 4.02991473e-02]
mat_Sqrt:  [[ 1.93840277e+01  0.00000000e+00]
 [-8.02985900e-03  1.83987184e-02]]
grads:  [0.00736859 1.99910886]
Stock Position:  0.007368591638207785
Bond Position:  [-0.21074759]


portfolio before change:  [0.49760985]
curr_Stock_Price:  96.13557435426986
curr_Factors:  [9.61355744e+01 4.07729689e-02]
mat_Sqrt:  [[ 1.94120005e+01  0.00000000e+00]
 [-8.07692703e-03  1.85065648e-02]]
grads:  [0.07403799 8.0403485 ]
Stock Position:  0.07403799353953237
Bond Position:  [-6.62007518]


portfolio before change:  [0.61193356]
curr_Stock_Price:  97.69087401624759
curr_Factors:  [9.76908740e+01 4.02506068e-02]
mat_Sqrt:  [[ 1.95992842e+01  0.00000000e+00]
 [-8.02502155e-03  1.83876344e-02]]
grads:  [5.89319914e-03 1.20832509e+01]
Stock Position:  0.005893199142809753
Bond Position:  [0.03622178]


portfolio before change:  [0.61757711]
curr_Stock_Price:  98.64774378559684
curr_Factors:  [9.86477438e+01 3.98754747e-02]
mat_Sqrt:  [[ 1.96988145e+01  0.00000000e+00]
 [-7.98753776e-03  1.83017482e-02]]
grads:  [-2.15970455e-03  3.58737394e+00]
Stock Position:  -0.0021597045455585963
Bond Position:  [0.83062709]


portfolio before change:  [0.61842666]
curr_Stock_Price:  98.30245566058467
curr_Factors:  [9.83024557e+01 4.00362861e-02]
mat_Sqrt:  [[ 1.96694067e+01  0.00000000e+00]
 [-8.00362779e-03  1.83386151e-02]]
grads:  [-0.00545302  5.25675799]
Stock Position:  -0.005453015120805706
Bond Position:  [1.15447144]


portfolio before change:  [0.62165746]
curr_Stock_Price:  97.73644315140466
curr_Factors:  [9.77364432e+01 3.95825483e-02]
mat_Sqrt:  [[ 1.94450205e+01  0.00000000e+00]
 [-7.95814534e-03  1.82344017e-02]]
grads:  [ 4.12051935e-03 -5.74381781e+00]
Stock Position:  0.004120519350226946
Bond Position:  [0.21893255]


portfolio before change:  [0.61940778]
curr_Stock_Price:  97.18383275378763
curr_Factors:  [9.71838328e+01 4.00323755e-02]
mat_Sqrt:  [[ 1.94446309e+01  0.00000000e+00]
 [-8.00323689e-03  1.83377194e-02]]
grads:  [-2.02328194e-02 -2.43713646e+01]
Stock Position:  -0.02023281944643394
Bond Position:  [2.58571072]


portfolio before change:  [0.65398808]
curr_Stock_Price:  95.4906895478847
curr_Factors:  [9.54906895e+01 4.00063863e-02]
mat_Sqrt:  [[ 1.90996624e+01  0.00000000e+00]
 [-8.00063860e-03  1.83317660e-02]]
grads:  [0.004891   2.60101824]
Stock Position:  0.004891001110015854
Bond Position:  [0.18694301]


portfolio before change:  [0.65438624]
curr_Stock_Price:  95.56731786322248
curr_Factors:  [9.55673179e+01 3.93616778e-02]
mat_Sqrt:  [[ 1.89603434e+01  0.00000000e+00]
 [-7.93591107e-03  1.81834566e-02]]
grads:  [  0.01734921 -12.10295329]
Stock Position:  0.017349205277643637
Bond Position:  [-1.00363078]


portfolio before change:  [0.65729505]
curr_Stock_Price:  95.7422123051303
curr_Factors:  [9.57422123e+01 3.89230098e-02]
mat_Sqrt:  [[ 1.88888999e+01  0.00000000e+00]
 [-7.89156611e-03  1.80818495e-02]]
grads:  [ -0.03285191 -12.64109331]
Stock Position:  -0.032851910056168165
Bond Position:  [3.8026096]


portfolio before change:  [0.67589933]
curr_Stock_Price:  95.19037477899504
curr_Factors:  [9.51903748e+01 3.90510865e-02]
mat_Sqrt:  [[ 1.88109010e+01  0.00000000e+00]
 [-7.90453910e-03  1.81115744e-02]]
grads:  [0.0064021 2.2581978]
Stock Position:  0.006402103605690233
Bond Position:  [0.06648069]


portfolio before change:  [0.66751979]
curr_Stock_Price:  93.88020444394303
curr_Factors:  [9.38802044e+01 3.98659078e-02]
mat_Sqrt:  [[ 1.87445430e+01  0.00000000e+00]
 [-7.98657953e-03  1.82995526e-02]]
grads:  [-2.79524908e-03  9.38741548e+00]
Stock Position:  -0.002795249075705149
Bond Position:  [0.92993835]


portfolio before change:  [0.66938224]
curr_Stock_Price:  93.25550060200764
curr_Factors:  [9.32555006e+01 3.98730396e-02]
mat_Sqrt:  [[ 1.86214772e+01  0.00000000e+00]
 [-7.98729387e-03  1.83011894e-02]]
grads:  [ 0.03232937 12.59308371]
Stock Position:  0.03232936835176545
Bond Position:  [-2.34550919]


portfolio before change:  [0.65327781]
curr_Stock_Price:  92.76643374233642
curr_Factors:  [9.27664337e+01 3.95909711e-02]
mat_Sqrt:  [[ 1.84581826e+01  0.00000000e+00]
 [-7.95899201e-03  1.82363417e-02]]
grads:  [ 1.11615507e-03 -3.90748372e+00]
Stock Position:  0.0011161550730883858
Bond Position:  [0.54973609]


portfolio before change:  [0.65249581]
curr_Stock_Price:  92.00424325563665
curr_Factors:  [9.20042433e+01 4.12964346e-02]
mat_Sqrt:  [[ 1.86966646e+01  0.00000000e+00]
 [-8.12860969e-03  1.86249846e-02]]
grads:  [ 7.26158108e-03 -1.71011714e+01]
Stock Position:  0.0072615810805643005
Bond Position:  [-0.01560046]


portfolio before change:  [0.65771469]
curr_Stock_Price:  92.72320841575635
curr_Factors:  [9.27232084e+01 4.13222612e-02]
mat_Sqrt:  [[ 1.88486604e+01  0.00000000e+00]
 [-8.13115108e-03  1.86308076e-02]]
grads:  [0.00687775 3.11357624]
Stock Position:  0.006877750924077227
Bond Position:  [0.01998755]


portfolio before change:  [0.66805309]
curr_Stock_Price:  94.22601107457045
curr_Factors:  [9.42260111e+01 4.04666101e-02]
mat_Sqrt:  [[ 1.89548005e+01  0.00000000e+00]
 [-8.04652572e-03  1.84369066e-02]]
grads:  [1.77414226e-03 1.14208437e+01]
Stock Position:  0.0017741422567726945
Bond Position:  [0.50088274]


portfolio before change:  [0.66837634]
curr_Stock_Price:  94.37292071130764
curr_Factors:  [9.43729207e+01 3.84533162e-02]
mat_Sqrt:  [[ 1.85060741e+01  0.00000000e+00]
 [-7.84380685e-03  1.79724193e-02]]
grads:  [-0.02189252 -7.1199326 ]
Stock Position:  -0.021892522231426403
Bond Position:  [2.73443761]


portfolio before change:  [0.64477508]
curr_Stock_Price:  95.46658555265965
curr_Factors:  [9.54665856e+01 3.77222662e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.64477508]
Stock Price:  95.54687484373606
PL:  [0.64477508]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.51012836e+00  6.42916274e-01]
 [ 1.46991637e+00  3.33389186e-02]
 [-4.20291290e-01  3.54525537e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.48089639e-01  1.10118188e+00]
 [ 4.83585943e-02  1.98786789e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.04530436e+00  1.06131562e+00]
 [ 7.42572828e-02  5.30748967e-01]
 [ 1.21814937e-01 -2.05411598e-02]
 [-5.18206948e-03  1.95011932e-02]
 [ 6.04663225e-02 -9.49925062e-02]
 [-7.56216024e-02  1.40349791e-01]
 [-1.39903666e-01  4.80250742e-01]
 [ 7.00913644e-02  1.27077203e-01]
 [ 1.31503636e-01 -1.06128761e-01]
 [ 3.77916741e-02 -2.80566926e-02]
 [ 3.28536997e-01  6.49216843e-02]
 [ 4.55604107e-01  4.69182060e-01]
 [-8.42996735e-01  4.14584535e-01]
 [-1.70279694e-01  3.09738407e-01]
 [ 1.88142594e+00  3.10917651e-01]
 [ 1.39695334e-02  3.89815684e-01]
 [-1.66635913e-01  2.43764159e-01]
 [-1.51372500e-01  5.46851074e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 5.88724595e-01 -4.08806728e-01]
 [ 1.49669010e-01 -1.16364209e-01]
 [ 7.67112624e-01 -3.22007101e-01]
 [-7.62640040e-01 -3.52086299e-01]
 [ 4.46573488e-01  1.67951510e-01]
 [-1.39474117e-01  1.92664692e-01]
 [ 3.96809917e-01  2.21238386e-01]
 [ 5.29587177e-02 -6.99416127e-02]
 [ 2.79053645e-01 -2.77079618e-01]
 [ 1.04594927e-01  5.76608681e-02]
 [-7.52479959e-02  4.82344110e-01]
 [-3.94251113e-01 -1.45199235e-01]
 [-1.62443341e-01  5.94893586e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.86342965]
curr_Stock_Price:  97.01779532659475
curr_Factors:  [9.70177953e+01 4.16445221e-02]
mat_Sqrt:  [[ 1.97984113e+01  0.00000000e+00]
 [-8.16279580e-03  1.87033148e-02]]
grads:  [ 0.09044766 34.37445607]
Stock Position:  0.09044766248853672
Bond Position:  [-26.63846246]


portfolio before change:  [-17.85476695]
curr_Stock_Price:  97.1503882016248
curr_Factors:  [9.71503882e+01 4.27528842e-02]
mat_Sqrt:  [[ 2.00875629e+01  0.00000000e+00]
 [-8.27070824e-03  1.89505733e-02]]
grads:  [0.07389979 1.75925647]
Stock Position:  0.07389978937902107
Bond Position:  [-25.03416018]


portfolio before change:  [-18.02337616]
curr_Stock_Price:  94.91114303969822
curr_Factors:  [9.4911143e+01 4.3059499e-02]
mat_Sqrt:  [[ 1.96948052e+01  0.00000000e+00]
 [-8.30031315e-03  1.90184067e-02]]
grads:  [-1.34839445e-02  1.86411798e+01]
Stock Position:  -0.013483944509912542
Bond Position:  [-16.74359958]


portfolio before change:  [-18.01982191]
curr_Stock_Price:  94.49232389140123
curr_Factors:  [9.44923239e+01 4.32458764e-02]
mat_Sqrt:  [[ 1.96502862e+01  0.00000000e+00]
 [-8.31825716e-03  1.90595215e-02]]
grads:  [-8.29574020e-04 -7.94284432e+00]
Stock Position:  -0.0008295740200142759
Bond Position:  [-17.94143353]


portfolio before change:  [-18.02360284]
curr_Stock_Price:  96.34642370593818
curr_Factors:  [9.63464237e+01 4.23532843e-02]
mat_Sqrt:  [[ 1.98280107e+01  0.00000000e+00]
 [-8.23196544e-03  1.88618024e-02]]
grads:  [1.67694852e-02 5.83815828e+01]
Stock Position:  0.016769485205844113
Bond Position:  [-19.63928277]


portfolio before change:  [-18.03428745]
curr_Stock_Price:  95.85567841125273
curr_Factors:  [9.58556784e+01 4.28498211e-02]
mat_Sqrt:  [[ 1.98423156e+01  0.00000000e+00]
 [-8.28007934e-03  1.89720452e-02]]
grads:  [0.00287438 1.04778787]
Stock Position:  0.002874380304505439
Bond Position:  [-18.30981313]


portfolio before change:  [-18.03621862]
curr_Stock_Price:  95.9801238552056
curr_Factors:  [9.59801239e+01 4.12703767e-02]
mat_Sqrt:  [[ 1.94984695e+01  0.00000000e+00]
 [-8.12604472e-03  1.86191075e-02]]
grads:  [0.00663507 5.16334562]
Stock Position:  0.006635073460581886
Bond Position:  [-18.67305379]


portfolio before change:  [-18.03558323]
curr_Stock_Price:  96.42769474682336
curr_Factors:  [9.64276947e+01 4.08517662e-02]
mat_Sqrt:  [[ 1.94897920e+01  0.00000000e+00]
 [-8.08472795e-03  1.85244389e-02]]
grads:  [ 0.07739952 57.29272703]
Stock Position:  0.07739951631837544
Bond Position:  [-25.49904016]


portfolio before change:  [-18.08919204]
curr_Stock_Price:  95.77625363262872
curr_Factors:  [9.57762536e+01 4.20021910e-02]
mat_Sqrt:  [[ 1.96288031e+01  0.00000000e+00]
 [-8.19777443e-03  1.87834609e-02]]
grads:  [1.55839926e-02 2.82561861e+01]
Stock Position:  0.015583992627786007
Bond Position:  [-19.58176847]


portfolio before change:  [-18.09184745]
curr_Stock_Price:  95.7629362661834
curr_Factors:  [9.57629363e+01 4.24091131e-02]
mat_Sqrt:  [[ 1.97209144e+01  0.00000000e+00]
 [-8.23738921e-03  1.88742298e-02]]
grads:  [ 0.00572235 -1.08831777]
Stock Position:  0.00572235330190433
Bond Position:  [-18.6398368]


portfolio before change:  [-18.09475972]
curr_Stock_Price:  95.66120390593875
curr_Factors:  [9.56612039e+01 4.18916657e-02]
mat_Sqrt:  [[ 1.95794125e+01  0.00000000e+00]
 [-8.18698144e-03  1.87587311e-02]]
grads:  [1.70022925e-04 1.03957955e+00]
Stock Position:  0.00017002292549989765
Bond Position:  [-18.11102432]


portfolio before change:  [-18.0970787]
curr_Stock_Price:  95.33794514619491
curr_Factors:  [9.53379451e+01 4.32052030e-02]
mat_Sqrt:  [[ 1.98168130e+01  0.00000000e+00]
 [-8.31434452e-03  1.90505566e-02]]
grads:  [ 9.59195300e-04 -4.98633759e+00]
Stock Position:  0.0009591952996741928
Bond Position:  [-18.18852641]


portfolio before change:  [-18.09992866]
curr_Stock_Price:  94.73718260169544
curr_Factors:  [9.47371826e+01 4.50772458e-02]
mat_Sqrt:  [[ 2.01140327e+01  0.00000000e+00]
 [-8.49256105e-03  1.94589019e-02]]
grads:  [-7.14323784e-04  7.21262644e+00]
Stock Position:  -0.0007143237840470518
Bond Position:  [-18.03225564]


portfolio before change:  [-18.10155065]
curr_Stock_Price:  93.85217248225457
curr_Factors:  [9.38521725e+01 4.43306792e-02]
mat_Sqrt:  [[ 1.97604360e+01  0.00000000e+00]
 [-8.42194079e-03  1.92970906e-02]]
grads:  [3.52699411e-03 2.48872098e+01]
Stock Position:  0.0035269941063887115
Bond Position:  [-18.43256671]


portfolio before change:  [-18.10645372]
curr_Stock_Price:  93.11532536544958
curr_Factors:  [9.31153254e+01 4.37720750e-02]
mat_Sqrt:  [[ 1.94813807e+01  0.00000000e+00]
 [-8.36871078e-03  1.91751253e-02]]
grads:  [6.44473843e-03 6.62719023e+00]
Stock Position:  0.00644473842805237
Bond Position:  [-18.70655763]


portfolio before change:  [-18.10371678]
curr_Stock_Price:  93.90285131849612
curr_Factors:  [9.39028513e+01 4.32789820e-02]
mat_Sqrt:  [[ 1.95351746e+01  0.00000000e+00]
 [-8.32144045e-03  1.90668154e-02]]
grads:  [ 4.36060843e-03 -5.56615033e+00]
Stock Position:  0.004360608428553927
Bond Position:  [-18.51319035]


portfolio before change:  [-18.10811823]
curr_Stock_Price:  93.42421252554344
curr_Factors:  [9.34242125e+01 4.48828517e-02]
mat_Sqrt:  [[ 1.97924550e+01  0.00000000e+00]
 [-8.47422932e-03  1.94168987e-02]]
grads:  [ 1.29073071e-03 -1.44496261e+00]
Stock Position:  0.0012907307114720836
Bond Position:  [-18.22870373]


portfolio before change:  [-18.11046424]
curr_Stock_Price:  93.3720890825458
curr_Factors:  [9.33720891e+01 4.50355286e-02]
mat_Sqrt:  [[ 1.98150288e+01  0.00000000e+00]
 [-8.48863038e-03  1.94498956e-02]]
grads:  [0.01801012 3.33789371]
Stock Position:  0.018010124855370162
Bond Position:  [-19.79210722]


portfolio before change:  [-18.14250865]
curr_Stock_Price:  91.73022175321148
curr_Factors:  [9.17302218e+01 4.40507211e-02]
mat_Sqrt:  [[ 1.92525808e+01  0.00000000e+00]
 [-8.39530546e-03  1.92360614e-02]]
grads:  [ 0.03430044 24.39075497]
Stock Position:  0.034300437550925905
Bond Position:  [-21.28889539]


portfolio before change:  [-18.1435077]
curr_Stock_Price:  91.77868234114682
curr_Factors:  [9.17786823e+01 4.39425969e-02]
mat_Sqrt:  [[ 1.92390967e+01  0.00000000e+00]
 [-8.38499583e-03  1.92124390e-02]]
grads:  [-0.03441207 21.57896424]
Stock Position:  -0.03441207347046793
Bond Position:  [-14.98521295]


portfolio before change:  [-18.14278014]
curr_Stock_Price:  91.70310337772365
curr_Factors:  [9.17031034e+01 4.32684608e-02]
mat_Sqrt:  [[ 1.90752288e+01  0.00000000e+00]
 [-8.32042891e-03  1.90644977e-02]]
grads:  [-1.84001834e-03  1.62468696e+01]
Stock Position:  -0.0018400183405854183
Bond Position:  [-17.97404475]


portfolio before change:  [-18.14449439]
curr_Stock_Price:  91.41362091514382
curr_Factors:  [9.14136209e+01 4.49857946e-02]
mat_Sqrt:  [[ 1.93886964e+01  0.00000000e+00]
 [-8.48394198e-03  1.94391531e-02]]
grads:  [ 0.10403595 15.99440307]
Stock Position:  0.10403595385133853
Bond Position:  [-27.65479763]


portfolio before change:  [-18.09041845]
curr_Stock_Price:  91.96663172464446
curr_Factors:  [9.19666317e+01 4.50048984e-02]
mat_Sqrt:  [[ 1.95101305e+01  0.00000000e+00]
 [-8.48574319e-03  1.94432802e-02]]
grads:  [9.43607455e-03 2.00488641e+01]
Stock Position:  0.009436074551502648
Bond Position:  [-18.95822244]


portfolio before change:  [-18.10087514]
curr_Stock_Price:  91.10962602519764
curr_Factors:  [9.11096260e+01 4.57430331e-02]
mat_Sqrt:  [[ 1.94861815e+01  0.00000000e+00]
 [-8.55504839e-03  1.96020784e-02]]
grads:  [-3.09185828e-03  1.24356282e+01]
Stock Position:  -0.0030918582763461103
Bond Position:  [-17.81917709]


portfolio before change:  [-18.10361723]
curr_Stock_Price:  91.27604702331912
curr_Factors:  [9.1276047e+01 4.5896870e-02]
mat_Sqrt:  [[ 1.95545739e+01  0.00000000e+00]
 [-8.56942191e-03  1.96350123e-02]]
grads:  [-0.00652052  2.7850814 ]
Stock Position:  -0.006520518569911996
Bond Position:  [-17.50845007]


portfolio before change:  [-18.10451161]
curr_Stock_Price:  91.0775491580785
curr_Factors:  [9.10775492e+01 4.54843581e-02]
mat_Sqrt:  [[ 1.94241655e+01  0.00000000e+00]
 [-8.53082487e-03  1.95465754e-02]]
grads:  [ 0.00944589 -3.73444124]
Stock Position:  0.009445893687414336
Bond Position:  [-18.96482046]


portfolio before change:  [-18.11984335]
curr_Stock_Price:  89.70542011644847
curr_Factors:  [8.97054201e+01 4.63972198e-02]
mat_Sqrt:  [[ 1.93225600e+01  0.00000000e+00]
 [-8.61600556e-03  1.97417488e-02]]
grads:  [  0.02123459 -20.70772613]
Stock Position:  0.021234593801885963
Bond Position:  [-20.02470151]


portfolio before change:  [-18.12623859]
curr_Stock_Price:  89.52213462802814
curr_Factors:  [8.95221346e+01 4.75575321e-02]
mat_Sqrt:  [[ 1.95227091e+01  0.00000000e+00]
 [-8.72307579e-03  1.99870776e-02]]
grads:  [ 5.06505037e-03 -5.82197218e+00]
Stock Position:  0.005065050367438676
Bond Position:  [-18.57967271]


portfolio before change:  [-18.1219214]
curr_Stock_Price:  90.83303853441232
curr_Factors:  [9.08330385e+01 4.77818788e-02]
mat_Sqrt:  [[ 1.98552543e+01  0.00000000e+00]
 [-8.74362660e-03  2.00341654e-02]]
grads:  [  0.03155725 -16.07289823]
Stock Position:  0.03155724899642644
Bond Position:  [-20.98836221]


portfolio before change:  [-18.13640902]
curr_Stock_Price:  90.45708942421952
curr_Factors:  [9.04570894e+01 4.91282355e-02]
mat_Sqrt:  [[ 2.00497145e+01  0.00000000e+00]
 [-8.86595606e-03  2.03144574e-02]]
grads:  [ -0.04570155 -17.33180921]
Stock Position:  -0.045701553445907164
Bond Position:  [-14.00237952]


portfolio before change:  [-18.18935588]
curr_Stock_Price:  91.57732378596698
curr_Factors:  [9.15773238e+01 5.01752913e-02]
mat_Sqrt:  [[ 2.05131757e+01  0.00000000e+00]
 [-8.95993672e-03  2.05297941e-02]]
grads:  [0.0253434  8.18086674]
Stock Position:  0.025343396093903483
Bond Position:  [-20.51023627]


portfolio before change:  [-18.14365807]
curr_Stock_Price:  93.48163633043247
curr_Factors:  [9.34816363e+01 4.96146884e-02]
mat_Sqrt:  [[ 2.08224314e+01  0.00000000e+00]
 [-8.90974194e-03  2.04147834e-02]]
grads:  [-2.66003285e-03  9.43750846e+00]
Stock Position:  -0.002660032848642515
Bond Position:  [-17.89499385]


portfolio before change:  [-18.14792736]
curr_Stock_Price:  94.24563979352405
curr_Factors:  [9.42456398e+01 4.88864737e-02]
mat_Sqrt:  [[ 2.08379803e+01  0.00000000e+00]
 [-8.84411431e-03  2.02644116e-02]]
grads:  [ 0.0236763  10.91758251]
Stock Position:  0.023676299603503446
Bond Position:  [-20.37931537]


portfolio before change:  [-18.18469787]
curr_Stock_Price:  92.8001885664127
curr_Factors:  [9.28001886e+01 5.00716710e-02]
mat_Sqrt:  [[ 2.07656200e+01  0.00000000e+00]
 [-8.95068007e-03  2.05085845e-02]]
grads:  [ 1.08032871e-03 -3.41035788e+00]
Stock Position:  0.00108032870742571
Bond Position:  [-18.28495258]


portfolio before change:  [-18.18699864]
curr_Stock_Price:  92.786295032804
curr_Factors:  [9.27862950e+01 4.86343156e-02]
mat_Sqrt:  [[ 2.04623372e+01  0.00000000e+00]
 [-8.82127570e-03  2.02120818e-02]]
grads:  [ 7.72766980e-03 -1.37086135e+01]
Stock Position:  0.007727669802903189
Bond Position:  [-18.90402049]


portfolio before change:  [-18.1899192]
curr_Stock_Price:  92.71416339664128
curr_Factors:  [9.27141634e+01 4.79894200e-02]
mat_Sqrt:  [[ 2.03104167e+01  0.00000000e+00]
 [-8.76259505e-03  2.00776276e-02]]
grads:  [0.00638885 2.87189649]
Stock Position:  0.006388849364977568
Bond Position:  [-18.78225603]


portfolio before change:  [-18.20212904]
curr_Stock_Price:  91.17055167119568
curr_Factors:  [9.11705517e+01 4.73138263e-02]
mat_Sqrt:  [[ 1.98311828e+01  0.00000000e+00]
 [-8.70069664e-03  1.99358005e-02]]
grads:  [6.82078490e-03 2.41948705e+01]
Stock Position:  0.006820784903210962
Bond Position:  [-18.82398376]


portfolio before change:  [-18.21187876]
curr_Stock_Price:  90.08613344050758
curr_Factors:  [9.00861334e+01 4.81164326e-02]
mat_Sqrt:  [[ 1.97608061e+01  0.00000000e+00]
 [-8.77418328e-03  2.01041795e-02]]
grads:  [-0.02315803 -7.22234078]
Stock Position:  -0.023158025631715637
Bond Position:  [-16.12566178]


portfolio before change:  [-18.21946435]
curr_Stock_Price:  90.32664401242363
curr_Factors:  [9.03266440e+01 4.89499784e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.21946435]
Stock Price:  89.90340145111112
PL:  [-18.21946435]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.19831419e+00  2.99816044e-01]
 [ 5.79342994e-01  1.18960362e-01]
 [ 2.09344913e-02  5.04390523e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.52221029e-02  2.07006135e-01]
 [ 5.00759892e-03 -7.57540448e-02]
 [ 8.74374595e-02  9.61044250e-02]
 [ 4.59444169e-01  5.39032565e-01]
 [-9.72999809e-02 -4.10426494e-03]
 [ 5.15605302e-02 -1.31837437e-01]
 [-6.17015878e-02 -1.47191992e-02]
 [-2.11974723e-02 -1.35778014e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.72938573e-02 -4.20457369e-02]
 [ 2.87410572e-01  1.68850809e-01]
 [ 1.34071712e-01 -3.54195782e-01]
 [ 3.94841237e-02  1.06945175e-01]
 [ 8.03298415e-03  5.01276043e-02]
 [-9.96004492e-02 -3.77410405e-01]
 [-3.68190702e-02 -6.25009916e-02]
 [ 1.78745147e-01 -4.48432704e-02]
 [ 7.03265373e-01 -9.18773215e-02]
 [ 2.86579418e-02 -3.18032612e-01]
 [-8.09826033e-03  3.49891898e-02]
 [ 5.53268842e-02 -8.98646046e-03]
 [ 1.56155118e-01 -9.42057858e-02]
 [ 2.77050141e-02 -1.09031504e-01]
 [ 5.00609721e-02  1.62970406e-01]
 [-3.40916429e-02  1.90452274e-01]
 [-5.19170399e-01 -1.05340105e-01]
 [-1.68058652e-01 -6.32602522e-02]
 [ 9.69694516e-03 -6.26775927e-02]
 [ 5.64447137e-02  1.84546295e-01]
 [ 5.53095775e-03  1.42739268e-02]
 [ 3.51650119e-02  1.19333415e-02]
 [-1.63604125e-01  1.05405914e-01]
 [-2.85388433e-02 -1.67874234e-01]
 [-5.29430028e-02 -4.43530232e-02]
 [ 1.42843448e-01 -1.33114308e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.52946105]
curr_Stock_Price:  100.5585445267378
curr_Factors:  [1.00558545e+02 3.95062052e-02]
mat_Sqrt:  [[ 1.99871852e+01  0.00000000e+00]
 [-7.95046718e-03  1.82168088e-02]]
grads:  [ 0.06650084 16.45820885]
Stock Position:  0.06650084170458435
Bond Position:  [-0.1577668]


portfolio before change:  [6.46610403]
curr_Stock_Price:  99.60611591394576
curr_Factors:  [9.96061159e+01 3.93717167e-02]
mat_Sqrt:  [[ 1.97641518e+01  0.00000000e+00]
 [-7.93692301e-03  1.81857752e-02]]
grads:  [0.03193972 6.54139628]
Stock Position:  0.03193972389719139
Bond Position:  [3.28471218]


portfolio before change:  [6.41378937]
curr_Stock_Price:  97.95534167378847
curr_Factors:  [9.79553417e+01 3.85327730e-02]
mat_Sqrt:  [[ 1.92284048e+01  0.00000000e+00]
 [-7.85190657e-03  1.79909781e-02]]
grads:  [2.23356534e-03 2.80357477e+00]
Stock Position:  0.002233565340635354
Bond Position:  [6.19499971]


portfolio before change:  [6.4174298]
curr_Stock_Price:  99.23849581930247
curr_Factors:  [9.92384958e+01 3.73049948e-02]
mat_Sqrt:  [[ 1.91674203e+01  0.00000000e+00]
 [-7.72580040e-03  1.77020326e-02]]
grads:  [-8.50472663e-04 -8.55194520e+00]
Stock Position:  -0.0008504726634563053
Bond Position:  [6.50182943]


portfolio before change:  [6.41856926]
curr_Stock_Price:  98.85437872116302
curr_Factors:  [9.88543787e+01 3.72485727e-02]
mat_Sqrt:  [[ 1.90787857e+01  0.00000000e+00]
 [-7.71995572e-03  1.76886407e-02]]
grads:  [7.92649037e-04 1.17027723e+01]
Stock Position:  0.0007926490367678288
Bond Position:  [6.34021243]


portfolio before change:  [6.41837905]
curr_Stock_Price:  97.61450079724472
curr_Factors:  [9.76145008e+01 3.69547084e-02]
mat_Sqrt:  [[ 1.87650285e+01  0.00000000e+00]
 [-7.68944299e-03  1.76187273e-02]]
grads:  [-1.49502447e-03 -4.29963207e+00]
Stock Position:  -0.0014950244707507738
Bond Position:  [6.56431511]


portfolio before change:  [6.41716079]
curr_Stock_Price:  98.97825875426201
curr_Factors:  [9.89782588e+01 3.71999957e-02]
mat_Sqrt:  [[ 1.90902341e+01  0.00000000e+00]
 [-7.71492016e-03  1.76771028e-02]]
grads:  [0.00677733 5.43666154]
Stock Position:  0.0067773327737390785
Bond Position:  [5.74635219]


portfolio before change:  [6.42322802]
curr_Stock_Price:  99.76749158877274
curr_Factors:  [9.97674916e+01 3.56718229e-02]
mat_Sqrt:  [[ 1.88430719e+01  0.00000000e+00]
 [-7.55479428e-03  1.73102083e-02]]
grads:  [ 0.03686752 31.13957696]
Stock Position:  0.03686751668011421
Bond Position:  [2.74504836]


portfolio before change:  [6.45125792]
curr_Stock_Price:  100.51847098703612
curr_Factors:  [1.00518471e+02 3.63991796e-02]
mat_Sqrt:  [[ 1.91774859e+01  0.00000000e+00]
 [-7.63142761e-03  1.74857973e-02]]
grads:  [-0.00516706 -0.23471992]
Stock Position:  -0.00516706046146834
Bond Position:  [6.97064293]


portfolio before change:  [6.4482148]
curr_Stock_Price:  101.27605778152267
curr_Factors:  [1.01276058e+02 3.54978601e-02]
mat_Sqrt:  [[ 1.90812963e+01  0.00000000e+00]
 [-7.53635032e-03  1.72679479e-02]]
grads:  [-3.13293416e-04 -7.63480627e+00]
Stock Position:  -0.0003132934163592215
Bond Position:  [6.47994393]


portfolio before change:  [6.44881396]
curr_Stock_Price:  101.94918555727631
curr_Factors:  [1.01949186e+02 3.51270624e-02]
mat_Sqrt:  [[ 1.91075356e+01  0.00000000e+00]
 [-7.49688601e-03  1.71775238e-02]]
grads:  [-0.00356538 -0.85688714]
Stock Position:  -0.0035653772677051647
Bond Position:  [6.81230127]


portfolio before change:  [6.44973636]
curr_Stock_Price:  101.92932501984336
curr_Factors:  [1.01929325e+02 3.64997409e-02]
mat_Sqrt:  [[ 1.94735011e+01  0.00000000e+00]
 [-7.64196215e-03  1.75099350e-02]]
grads:  [-4.13155578e-03 -7.75434143e+00]
Stock Position:  -0.00413155577821156
Bond Position:  [6.87086305]


portfolio before change:  [6.45002943]
curr_Stock_Price:  102.06628157723078
curr_Factors:  [1.02066282e+02 3.75277906e-02]
mat_Sqrt:  [[ 1.97723729e+01  0.00000000e+00]
 [-7.74883636e-03  1.77548146e-02]]
grads:  [-0.00331318 -1.00761418]
Stock Position:  -0.0033131845906814806
Bond Position:  [6.78819386]


portfolio before change:  [6.45364062]
curr_Stock_Price:  101.23245793371542
curr_Factors:  [1.01232458e+02 3.64715817e-02]
mat_Sqrt:  [[ 1.93329034e+01  0.00000000e+00]
 [-7.63901373e-03  1.75031793e-02]]
grads:  [-0.00287821 -2.40217712]
Stock Position:  -0.0028782082106490864
Bond Position:  [6.74500871]


portfolio before change:  [6.45242962]
curr_Stock_Price:  101.94615991826777
curr_Factors:  [1.01946160e+02 3.66517883e-02]
mat_Sqrt:  [[ 1.95172424e+01  0.00000000e+00]
 [-7.65786271e-03  1.75463678e-02]]
grads:  [0.01850175 9.62312038]
Stock Position:  0.018501748325148754
Bond Position:  [4.56624742]


portfolio before change:  [6.43339052]
curr_Stock_Price:  100.88626467299788
curr_Factors:  [1.00886265e+02 3.80902951e-02]
mat_Sqrt:  [[ 1.96897051e+01  0.00000000e+00]
 [-7.80669406e-03  1.78873832e-02]]
grads:  [-1.04176269e-03 -1.98014308e+01]
Stock Position:  -0.0010417626874026991
Bond Position:  [6.53849006]


portfolio before change:  [6.43618766]
curr_Stock_Price:  98.98585128956275
curr_Factors:  [9.89858513e+01 3.90192101e-02]
mat_Sqrt:  [[ 1.95529531e+01  0.00000000e+00]
 [-7.90131231e-03  1.81041809e-02]]
grads:  [4.40643539e-03 5.90720871e+00]
Stock Position:  0.004406435387869299
Bond Position:  [6.0000129]


portfolio before change:  [6.43420334]
curr_Stock_Price:  98.36531100099884
curr_Factors:  [9.83653110e+01 3.94525501e-02]
mat_Sqrt:  [[ 1.95379732e+01  0.00000000e+00]
 [-7.94506640e-03  1.82044341e-02]]
grads:  [1.53088880e-03 2.75359311e+00]
Stock Position:  0.0015308887956118917
Bond Position:  [6.28361698]


portfolio before change:  [6.43723023]
curr_Stock_Price:  99.82942352859108
curr_Factors:  [9.98294235e+01 4.10675715e-02]
mat_Sqrt:  [[ 2.02305679e+01  0.00000000e+00]
 [-8.10605418e-03  1.85733034e-02]]
grads:  [-1.30651722e-02 -2.03200474e+01]
Stock Position:  -0.013065172237511835
Bond Position:  [7.74151884]


portfolio before change:  [6.42520039]
curr_Stock_Price:  100.82425092614535
curr_Factors:  [1.00824251e+02 3.92514198e-02]
mat_Sqrt:  [[ 1.99752714e+01  0.00000000e+00]
 [-7.92478844e-03  1.81579714e-02]]
grads:  [-3.20880442e-03 -3.44206906e+00]
Stock Position:  -0.0032088044163521246
Bond Position:  [6.74872569]


portfolio before change:  [6.42814844]
curr_Stock_Price:  100.16842845795404
curr_Factors:  [1.00168428e+02 3.86055670e-02]
mat_Sqrt:  [[ 1.96813928e+01  0.00000000e+00]
 [-7.85931977e-03  1.80079639e-02]]
grads:  [ 0.00808753 -2.49019104]
Stock Position:  0.008087534320458447
Bond Position:  [5.61803284]


portfolio before change:  [6.4336254]
curr_Stock_Price:  100.75880107960346
curr_Factors:  [1.00758801e+02 3.93716904e-02]
mat_Sqrt:  [[ 1.99928645e+01  0.00000000e+00]
 [-7.93692035e-03  1.81857692e-02]]
grads:  [ 0.03317018 -5.05215483]
Stock Position:  0.033170175460536515
Bond Position:  [3.09143829]


portfolio before change:  [6.44086996]
curr_Stock_Price:  100.96555621495865
curr_Factors:  [1.00965556e+02 3.96847390e-02]
mat_Sqrt:  [[ 2.01133776e+01  0.00000000e+00]
 [-7.96841153e-03  1.82579245e-02]]
grads:  [-5.47610013e-03 -1.74188809e+01]
Stock Position:  -0.005476100127068195
Bond Position:  [6.99376745]


portfolio before change:  [6.44684775]
curr_Stock_Price:  100.03359330012374
curr_Factors:  [1.00033593e+02 3.87759976e-02]
mat_Sqrt:  [[ 1.96982370e+01  0.00000000e+00]
 [-7.87664879e-03  1.80476696e-02]]
grads:  [3.64107409e-04 1.93870957e+00]
Stock Position:  0.000364107408716358
Bond Position:  [6.41042478]


portfolio before change:  [6.4474472]
curr_Stock_Price:  99.47905800981214
curr_Factors:  [9.94790580e+01 3.97652358e-02]
mat_Sqrt:  [[ 1.98373404e+01  0.00000000e+00]
 [-7.97648903e-03  1.82764324e-02]]
grads:  [ 0.00259132 -0.49169664]
Stock Position:  0.002591318710659356
Bond Position:  [6.18966525]


portfolio before change:  [6.44944716]
curr_Stock_Price:  99.95225643669556
curr_Factors:  [9.99522564e+01 4.01332605e-02]
mat_Sqrt:  [[ 2.00237228e+01  0.00000000e+00]
 [-8.01331496e-03  1.83608112e-02]]
grads:  [ 0.0057452  -5.13080739]
Stock Position:  0.005745202487354139
Bond Position:  [5.87520121]


portfolio before change:  [6.45456326]
curr_Stock_Price:  100.71491973287644
curr_Factors:  [1.00714920e+02 3.98141608e-02]
mat_Sqrt:  [[ 2.00961375e+01  0.00000000e+00]
 [-7.98139445e-03  1.82876721e-02]]
grads:  [-9.89256546e-04 -5.96202206e+00]
Stock Position:  -0.000989256546491871
Bond Position:  [6.55419616]


portfolio before change:  [6.45634218]
curr_Stock_Price:  99.7449035273853
curr_Factors:  [9.97449035e+01 4.11007089e-02]
mat_Sqrt:  [[ 2.02215933e+01  0.00000000e+00]
 [-8.10932391e-03  1.85807953e-02]]
grads:  [5.99295450e-03 8.77090582e+00]
Stock Position:  0.005992954498861246
Bond Position:  [5.85857551]


portfolio before change:  [6.47159796]
curr_Stock_Price:  102.16831745729124
curr_Factors:  [1.02168317e+02 4.06703705e-02]
mat_Sqrt:  [[ 2.06041786e+01  0.00000000e+00]
 [-8.06675851e-03  1.84832657e-02]]
grads:  [2.37954373e-03 1.03040381e+01]
Stock Position:  0.002379543727724999
Bond Position:  [6.22848398]


portfolio before change:  [6.46832416]
curr_Stock_Price:  100.46529644253296
curr_Factors:  [1.00465296e+02 4.05844577e-02]
mat_Sqrt:  [[ 2.02393213e+01  0.00000000e+00]
 [-8.05823383e-03  1.84637332e-02]]
grads:  [-0.0279231  -5.70524407]
Stock Position:  -0.027923099928481993
Bond Position:  [9.27362667]


portfolio before change:  [6.47563296]
curr_Stock_Price:  100.24506568883136
curr_Factors:  [1.00245066e+02 4.10668269e-02]
mat_Sqrt:  [[ 2.03146142e+01  0.00000000e+00]
 [-8.10598069e-03  1.85731351e-02]]
grads:  [-0.00963187 -3.4060083 ]
Stock Position:  -0.009631868379765677
Bond Position:  [7.44118024]


portfolio before change:  [6.48298478]
curr_Stock_Price:  99.57836050449502
curr_Factors:  [9.95783605e+01 4.24884784e-02]
mat_Sqrt:  [[ 2.05258221e+01  0.00000000e+00]
 [-8.24509342e-03  1.88918823e-02]]
grads:  [-8.60272432e-04 -3.31769971e+00]
Stock Position:  -0.0008602724324367645
Bond Position:  [6.5686493]


portfolio before change:  [6.485515]
curr_Stock_Price:  97.59167918734389
curr_Factors:  [9.75916792e+01 4.31633624e-02]
mat_Sqrt:  [[ 2.02754464e+01  0.00000000e+00]
 [-8.31031767e-03  1.90413299e-02]]
grads:  [6.75631585e-03 9.69188056e+00]
Stock Position:  0.006756315854890629
Bond Position:  [5.82615479]


portfolio before change:  [6.494021]
curr_Stock_Price:  98.74285150905905
curr_Factors:  [9.87428515e+01 4.30568178e-02]
mat_Sqrt:  [[ 2.04892768e+01  0.00000000e+00]
 [-8.30005473e-03  1.90178145e-02]]
grads:  [5.73988544e-04 7.50555582e-01]
Stock Position:  0.000573988544236206
Bond Position:  [6.43734373]


portfolio before change:  [6.49461405]
curr_Stock_Price:  98.37408990466389
curr_Factors:  [9.83740899e+01 4.35985708e-02]
mat_Sqrt:  [[ 2.05407763e+01  0.00000000e+00]
 [-8.35210831e-03  1.91370843e-02]]
grads:  [0.00196551 0.62357156]
Stock Position:  0.001965512329511004
Bond Position:  [6.30125856]


portfolio before change:  [6.49752569]
curr_Stock_Price:  99.4546898317819
curr_Factors:  [9.94546898e+01 4.28121321e-02]
mat_Sqrt:  [[ 2.05782622e+01  0.00000000e+00]
 [-8.27643712e-03  1.89636998e-02]]
grads:  [-0.00571483  5.55829903]
Stock Position:  -0.0057148272098385255
Bond Position:  [7.06589206]


portfolio before change:  [6.49649299]
curr_Stock_Price:  99.78995739373433
curr_Factors:  [9.97899574e+01 4.01696663e-02]
mat_Sqrt:  [[ 2.00002742e+01  0.00000000e+00]
 [-8.01694868e-03  1.83691371e-02]]
grads:  [-5.09018849e-03 -9.13892868e+00]
Stock Position:  -0.005090188493070437
Bond Position:  [7.00444268]


portfolio before change:  [6.4993546]
curr_Stock_Price:  99.39979389908112
curr_Factors:  [9.93997939e+01 4.08298118e-02]
mat_Sqrt:  [[ 2.00851081e+01  0.00000000e+00]
 [-8.08255522e-03  1.85194605e-02]]
grads:  [-0.00359969 -2.39494142]
Stock Position:  -0.0035996943030027996
Bond Position:  [6.85716347]


portfolio before change:  [6.50477194]
curr_Stock_Price:  98.13298072586205
curr_Factors:  [9.81329807e+01 4.11631979e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.50477194]
Stock Price:  97.94012098734302
PL:  [6.50477194]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.32585183e+00  3.28649748e-01]
 [ 6.37190971e-01  1.12869082e-01]
 [ 1.10226368e-01 -1.65240874e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.13875066e-02  1.67402343e-01]
 [-1.69399927e-01 -1.93051301e-02]
 [ 8.80249852e-02  9.41135096e-02]
 [ 2.44818897e-01  4.55894750e-01]
 [-1.18113825e-01 -9.81418444e-02]
 [-2.49868649e-01 -5.11577683e-01]
 [-6.10962068e-02 -1.46860218e-02]
 [-8.17449930e-02 -1.53009330e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.54111258e-02 -4.34317065e-02]
 [ 1.47206400e-01  8.45219602e-02]
 [ 1.36206739e-01 -4.18109200e-01]
 [ 3.62952651e-02 -8.07028784e-02]
 [ 9.90654019e-03 -9.01460734e-02]
 [-4.41906004e-02 -3.05115559e-02]
 [-3.33465370e-01  1.20221556e-01]
 [ 1.68654190e-01 -3.15668347e-02]
 [ 7.73189305e-01 -4.90766081e-02]
 [ 3.02321515e-02 -4.12712155e-01]
 [ 5.24614177e-02  1.69323553e-02]
 [ 4.25149561e-01 -3.55535447e-01]
 [-2.80692809e-01  2.39412420e-02]
 [-1.51914080e-01  1.09126652e-01]
 [-3.83047299e-02  1.11351520e-01]
 [-2.24654770e-02  1.84989112e-01]
 [-5.07242880e-01 -1.09001886e-01]
 [-1.68301409e-01 -6.35254082e-02]
 [ 9.00614292e-03 -6.07867871e-02]
 [-2.78301562e-02  1.71081610e-01]
 [ 1.11505413e-02  2.99587574e-03]
 [ 8.40049756e-02 -3.93883763e-02]
 [-4.70650571e-02  1.19147209e-01]
 [-3.94726163e-02 -7.33593433e-02]
 [-9.28068287e-02 -5.68735013e-02]
 [ 1.30421299e-01 -1.31007338e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.75607947]
curr_Stock_Price:  100.01081945426688
curr_Factors:  [1.00010819e+02 4.15431214e-02]
mat_Sqrt:  [[ 2.03843350e+01  0.00000000e+00]
 [-8.15285191e-03  1.86805305e-02]]
grads:  [ 0.07207919 17.59316998]
Stock Position:  0.07207918898622322
Bond Position:  [-4.45261929]


portfolio before change:  [2.71841097]
curr_Stock_Price:  99.4959428841487
curr_Factors:  [9.94959429e+01 4.02760149e-02]
mat_Sqrt:  [[ 1.99677264e+01  0.00000000e+00]
 [-8.02755404e-03  1.83934370e-02]]
grads:  [0.03437803 6.136378  ]
Stock Position:  0.03437802892089104
Bond Position:  [-0.70206343]


portfolio before change:  [2.7449028]
curr_Stock_Price:  100.26909945141058
curr_Factors:  [1.00269099e+02 4.00247605e-02]
mat_Sqrt:  [[ 2.00600257e+01  0.00000000e+00]
 [-8.00247567e-03  1.83359753e-02]]
grads:  [ 0.00513532 -0.90118399]
Stock Position:  0.005135320671807681
Bond Position:  [2.22998883]


portfolio before change:  [2.74193398]
curr_Stock_Price:  99.63669612987366
curr_Factors:  [9.96366961e+01 4.10551989e-02]
mat_Sqrt:  [[ 2.01884696e+01  0.00000000e+00]
 [-8.10483301e-03  1.85705054e-02]]
grads:  [-8.07459271e-04 -8.15200283e+00]
Stock Position:  -0.0008074592713871346
Bond Position:  [2.82238655]


portfolio before change:  [2.74221735]
curr_Stock_Price:  99.72269890676921
curr_Factors:  [9.97226989e+01 4.13240709e-02]
mat_Sqrt:  [[ 2.02719522e+01  0.00000000e+00]
 [-8.13132913e-03  1.86312156e-02]]
grads:  [-4.10771222e-04  8.98504671e+00]
Stock Position:  -0.000410771221956028
Bond Position:  [2.78318057]


portfolio before change:  [2.74246324]
curr_Stock_Price:  99.97109518116567
curr_Factors:  [9.99710952e+01 4.17160637e-02]
mat_Sqrt:  [[ 2.04186070e+01  0.00000000e+00]
 [-8.16980428e-03  1.87193733e-02]]
grads:  [-0.00870899 -1.03129148]
Stock Position:  -0.008708986652811253
Bond Position:  [3.61311017]


portfolio before change:  [2.74685485]
curr_Stock_Price:  99.51869583097772
curr_Factors:  [9.95186958e+01 4.15798160e-02]
mat_Sqrt:  [[ 2.02929861e+01  0.00000000e+00]
 [-8.15645178e-03  1.86887788e-02]]
grads:  [0.00636178 5.03582981]
Stock Position:  0.006361778775713513
Bond Position:  [2.11373892]


portfolio before change:  [2.75340431]
curr_Stock_Price:  100.506662550859
curr_Factors:  [1.00506663e+02 4.21653137e-02]
mat_Sqrt:  [[ 2.06382334e+01  0.00000000e+00]
 [-8.21367773e-03  1.88199000e-02]]
grads:  [2.15031815e-02 2.42240793e+01]
Stock Position:  0.02150318147631248
Bond Position:  [0.5921913]


portfolio before change:  [2.79123162]
curr_Stock_Price:  102.26236948971766
curr_Factors:  [1.02262369e+02 4.04988032e-02]
mat_Sqrt:  [[ 2.05796008e+01  0.00000000e+00]
 [-8.04972578e-03  1.84442389e-02]]
grads:  [-0.00782068 -5.32100268]
Stock Position:  -0.007820678284432144
Bond Position:  [3.59099271]


portfolio before change:  [2.78575758]
curr_Stock_Price:  103.01971281366853
curr_Factors:  [1.03019713e+02 3.99277324e-02]
mat_Sqrt:  [[ 2.05853217e+01  0.00000000e+00]
 [-7.99276997e-03  1.83137367e-02]]
grads:  [-2.29843119e-02 -2.79340962e+01]
Stock Position:  -0.022984311918516354
Bond Position:  [5.1535948]


portfolio before change:  [2.80656085]
curr_Stock_Price:  102.14263528420854
curr_Factors:  [1.02142635e+02 3.96285741e-02]
mat_Sqrt:  [[ 2.03334598e+01  0.00000000e+00]
 [-7.96277078e-03  1.82449999e-02]]
grads:  [-0.00331993 -0.80493406]
Stock Position:  -0.0033199324085216053
Bond Position:  [3.14566749]


portfolio before change:  [2.80390559]
curr_Stock_Price:  103.0608721373946
curr_Factors:  [1.03060872e+02 3.84433068e-02]
mat_Sqrt:  [[ 2.02071089e+01  0.00000000e+00]
 [-7.84278591e-03  1.79700800e-02]]
grads:  [-7.35007369e-03 -8.51467160e+00]
Stock Position:  -0.007350073690662713
Bond Position:  [3.5614106]


portfolio before change:  [2.80438789]
curr_Stock_Price:  103.0558263673461
curr_Factors:  [1.03055826e+02 3.88405247e-02]
mat_Sqrt:  [[ 2.03102418e+01  0.00000000e+00]
 [-7.88319983e-03  1.80626800e-02]]
grads:  [-0.00322544 -0.99044012]
Stock Position:  -0.0032254426911085326
Bond Position:  [3.13678855]


portfolio before change:  [2.80976196]
curr_Stock_Price:  101.51124791812424
curr_Factors:  [1.01511248e+02 3.90182881e-02]
mat_Sqrt:  [[ 2.00515649e+01  0.00000000e+00]
 [-7.90121895e-03  1.81039670e-02]]
grads:  [-0.00271132 -2.39901601]
Stock Position:  -0.002711323371390454
Bond Position:  [3.08499178]


portfolio before change:  [2.80598263]
curr_Stock_Price:  103.04738834130367
curr_Factors:  [1.03047388e+02 3.96581959e-02]
mat_Sqrt:  [[ 2.05212337e+01  0.00000000e+00]
 [-7.96574625e-03  1.82518176e-02]]
grads:  [0.00897094 4.63087908]
Stock Position:  0.008970942519757996
Bond Position:  [1.88155043]


portfolio before change:  [2.79101007]
curr_Stock_Price:  101.3521627460096
curr_Factors:  [1.01352163e+02 4.05654526e-02]
mat_Sqrt:  [[ 2.04132044e+01  0.00000000e+00]
 [-8.05634682e-03  1.84594096e-02]]
grads:  [-2.26672284e-03 -2.26501936e+01]
Stock Position:  -0.0022667228434115833
Bond Position:  [3.02074733]


portfolio before change:  [2.79107598]
curr_Stock_Price:  101.48967854560516
curr_Factors:  [1.01489679e+02 4.05429307e-02]
mat_Sqrt:  [[ 2.04352261e+01  0.00000000e+00]
 [-8.05411008e-03  1.84542845e-02]]
grads:  [ 5.25387567e-05 -4.37312420e+00]
Stock Position:  5.253875673960976e-05
Bond Position:  [2.78574383]


portfolio before change:  [2.79135268]
curr_Stock_Price:  100.1281614600363
curr_Factors:  [1.00128161e+02 3.95042549e-02]
mat_Sqrt:  [[ 1.99011503e+01  0.00000000e+00]
 [-7.95027093e-03  1.82163592e-02]]
grads:  [-1.47913218e-03 -4.94863285e+00]
Stock Position:  -0.0014791321756923012
Bond Position:  [2.93945547]


portfolio before change:  [2.79359209]
curr_Stock_Price:  98.8625859857212
curr_Factors:  [9.88625860e+01 3.99736409e-02]
mat_Sqrt:  [[ 1.97660013e+01  0.00000000e+00]
 [-7.99736365e-03  1.83242622e-02]]
grads:  [-0.00290939 -1.66509056]
Stock Position:  -0.002909386386979961
Bond Position:  [3.08122155]


portfolio before change:  [2.79928887]
curr_Stock_Price:  97.03690677655146
curr_Factors:  [9.70369068e+01 3.99414540e-02]
mat_Sqrt:  [[ 1.93931733e+01  0.00000000e+00]
 [-7.99414325e-03  1.83168833e-02]]
grads:  [-0.01448945  6.56342865]
Stock Position:  -0.01448944822078589
Bond Position:  [4.20530011]


portfolio before change:  [2.77886903]
curr_Stock_Price:  98.48247866606587
curr_Factors:  [9.84824787e+01 3.88436593e-02]
mat_Sqrt:  [[ 1.94097096e+01  0.00000000e+00]
 [-7.88351792e-03  1.80634088e-02]]
grads:  [ 0.00797937 -1.7475569 ]
Stock Position:  0.007979371990407762
Bond Position:  [1.9930407]


portfolio before change:  [2.79359916]
curr_Stock_Price:  100.29728109639655
curr_Factors:  [1.00297281e+02 3.85018395e-02]
mat_Sqrt:  [[ 1.96802178e+01  0.00000000e+00]
 [-7.84875425e-03  1.79837552e-02]]
grads:  [ 0.0381993  -2.72894106]
Stock Position:  0.038199298694684344
Bond Position:  [-1.03768664]


portfolio before change:  [2.87377163]
curr_Stock_Price:  102.39947121879662
curr_Factors:  [1.02399471e+02 3.74333868e-02]
mat_Sqrt:  [[ 1.98119524e+01  0.00000000e+00]
 [-7.73908385e-03  1.77324688e-02]]
grads:  [-7.56564508e-03 -2.32743765e+01]
Stock Position:  -0.007565645084705336
Bond Position:  [3.64848969]


portfolio before change:  [2.87236563]
curr_Stock_Price:  102.64559560167613
curr_Factors:  [1.02645596e+02 3.97071519e-02]
mat_Sqrt:  [[ 2.04538322e+01  0.00000000e+00]
 [-7.97066139e-03  1.82630796e-02]]
grads:  [0.00292617 0.92713582]
Stock Position:  0.0029261657646382755
Bond Position:  [2.5720076]


portfolio before change:  [2.87580078]
curr_Stock_Price:  103.70966004207114
curr_Factors:  [1.03709660e+02 3.94223968e-02]
mat_Sqrt:  [[ 2.05916299e+01  0.00000000e+00]
 [-7.94202965e-03  1.81974760e-02]]
grads:  [ 1.31112093e-02 -1.95376242e+01]
Stock Position:  0.013111209349001524
Bond Position:  [1.51604172]


portfolio before change:  [2.88742463]
curr_Stock_Price:  104.58176401929812
curr_Factors:  [1.04581764e+02 3.77233255e-02]
mat_Sqrt:  [[ 2.03123863e+01  0.00000000e+00]
 [-7.76899741e-03  1.78010094e-02]]
grads:  [-0.01330439  1.34493733]
Stock Position:  -0.013304394152493775
Bond Position:  [4.27882164]


portfolio before change:  [2.89600728]
curr_Stock_Price:  103.97686921975937
curr_Factors:  [1.03976869e+02 3.75215203e-02]
mat_Sqrt:  [[ 2.01408108e+01  0.00000000e+00]
 [-7.74818898e-03  1.77533312e-02]]
grads:  [-5.17790996e-03  6.14682679e+00]
Stock Position:  -0.00517790995908117
Bond Position:  [3.43439015]


portfolio before change:  [2.8976407]
curr_Stock_Price:  103.74432465630082
curr_Factors:  [1.03744325e+02 3.75880758e-02]
mat_Sqrt:  [[ 2.01135808e+01  0.00000000e+00]
 [-7.75505779e-03  1.77690697e-02]]
grads:  [5.11746652e-04 6.26659257e+00]
Stock Position:  0.0005117466517748959
Bond Position:  [2.84454989]


portfolio before change:  [2.89677175]
curr_Stock_Price:  101.35145557737482
curr_Factors:  [1.01351456e+02 3.89151777e-02]
mat_Sqrt:  [[ 1.99935309e+01  0.00000000e+00]
 [-7.89077210e-03  1.80800302e-02]]
grads:  [2.91446222e-03 1.02316816e+01]
Stock Position:  0.0029144622166184134
Bond Position:  [2.60138676]


portfolio before change:  [2.89396775]
curr_Stock_Price:  100.2777791584968
curr_Factors:  [1.00277779e+02 3.91010250e-02]
mat_Sqrt:  [[ 1.98289071e+01  0.00000000e+00]
 [-7.90959164e-03  1.81231512e-02]]
grads:  [-0.02798012 -6.01451065]
Stock Position:  -0.027980120176520122
Bond Position:  [5.69975206]


portfolio before change:  [2.88327824]
curr_Stock_Price:  100.68528384290035
curr_Factors:  [1.00685284e+02 3.78728243e-02]
mat_Sqrt:  [[ 1.95943042e+01  0.00000000e+00]
 [-7.78437659e-03  1.78362475e-02]]
grads:  [-0.01000424 -3.56159042]
Stock Position:  -0.010004242505244532
Bond Position:  [3.89055823]


portfolio before change:  [2.89701727]
curr_Stock_Price:  99.36057789277652
curr_Factors:  [9.93605779e+01 3.91604284e-02]
mat_Sqrt:  [[ 1.96624588e+01  0.00000000e+00]
 [-7.91559760e-03  1.81369126e-02]]
grads:  [-8.91210307e-04 -3.35155097e+00]
Stock Position:  -0.0008912103067419654
Bond Position:  [2.98556844]


portfolio before change:  [2.89821044]
curr_Stock_Price:  98.44053268240363
curr_Factors:  [9.84405327e+01 3.98575569e-02]
mat_Sqrt:  [[ 1.96530198e+01  0.00000000e+00]
 [-7.98574299e-03  1.82976359e-02]]
grads:  [2.38314419e-03 9.34992978e+00]
Stock Position:  0.002383144185775186
Bond Position:  [2.66361246]


portfolio before change:  [2.89549666]
curr_Stock_Price:  97.16207248913584
curr_Factors:  [9.71620725e+01 4.09159032e-02]
mat_Sqrt:  [[ 1.96536330e+01  0.00000000e+00]
 [-8.09107194e-03  1.85389748e-02]]
grads:  [0.00063388 0.16159878]
Stock Position:  0.0006338801929983624
Bond Position:  [2.83390754]


portfolio before change:  [2.89603189]
curr_Stock_Price:  97.44756749625786
curr_Factors:  [9.74475675e+01 4.00347738e-02]
mat_Sqrt:  [[ 1.94979832e+01  0.00000000e+00]
 [-8.00347663e-03  1.83382687e-02]]
grads:  [ 0.00342674 -2.14787867]
Stock Position:  0.0034267379403701433
Bond Position:  [2.56210461]


portfolio before change:  [2.89603971]
curr_Stock_Price:  97.35638491228727
curr_Factors:  [9.73563849e+01 4.07839972e-02]
mat_Sqrt:  [[ 1.96611689e+01  0.00000000e+00]
 [-8.07801928e-03  1.85090674e-02]]
grads:  [2.51004810e-04 6.43723457e+00]
Stock Position:  0.0002510048102072158
Bond Position:  [2.87160279]


portfolio before change:  [2.8964928]
curr_Stock_Price:  97.73132826871876
curr_Factors:  [9.77313283e+01 4.03181525e-02]
mat_Sqrt:  [[ 1.96238454e+01  0.00000000e+00]
 [-8.03175224e-03  1.84030563e-02]]
grads:  [-3.6429791e-03 -3.9862587e+00]
Stock Position:  -0.0036429790999240436
Bond Position:  [3.25252598]


portfolio before change:  [2.89479489]
curr_Stock_Price:  98.30901360642001
curr_Factors:  [9.83090136e+01 3.91308768e-02]
mat_Sqrt:  [[ 1.94470230e+01  0.00000000e+00]
 [-7.91261037e-03  1.81300680e-02]]
grads:  [-0.00604866 -3.13697121]
Stock Position:  -0.0060486615113920904
Bond Position:  [3.48943284]


portfolio before change:  [2.89529858]
curr_Stock_Price:  98.29785725164423
curr_Factors:  [9.82978573e+01 3.92954482e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.89529858]
Stock Price:  98.99478173079088
PL:  [2.89529858]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.30047284e+00  3.22912069e-01]
 [ 2.89087832e-01  1.07550814e-01]
 [-2.91811931e-01 -1.32206461e-01]
 [ 4.83019172e-02 -1.51060226e-01]
 [-1.18908337e-01 -3.97796818e-01]
 [-3.95006090e-01  2.35234147e-01]
 [ 2.60064340e-01 -2.92054206e-01]
 [-6.25062885e-01  1.48589734e-01]
 [-1.07832463e-01 -8.13841913e-02]
 [-2.89604261e-01 -5.36633024e-01]
 [-8.01674268e-02 -1.04041242e-02]
 [-1.16735350e-01 -1.72865791e-01]
 [-4.88650441e-02 -3.04047556e-02]
 [ 2.26637114e-02 -1.94603449e-01]
 [-6.18596200e-02 -9.68482019e-02]
 [ 1.14262337e-01 -7.20031675e-01]
 [ 2.80318307e-02 -1.47738100e-01]
 [ 3.27630112e-02 -1.54325445e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.21855316e-01 -2.22046887e-02]
 [ 3.68279048e-01 -3.67261135e-01]
 [ 2.71065905e-02 -3.32107139e-01]
 [ 3.04724953e-02  6.43099448e-02]
 [ 4.36546321e-01 -3.90521111e-01]
 [-2.84227516e-01  2.48499974e-02]
 [-1.23697335e-01 -4.52388423e-02]
 [ 5.01877682e-02  1.65700879e-01]
 [ 1.94352175e-01  1.83850090e-02]
 [-5.29242497e-01 -1.95538703e-01]
 [-5.39230497e-02 -1.66551855e-02]
 [-7.03604341e-05 -4.76096065e-02]
 [ 3.93048816e-02  1.81807846e-01]
 [ 1.64826168e-02  1.26065948e-04]
 [ 1.11717024e-01 -4.02716537e-02]
 [ 3.84732558e-02  1.13764588e-01]
 [-5.05990898e-02  8.65971540e-02]
 [-3.51402899e-01 -1.28131714e-01]
 [-2.85936374e-02  4.60942835e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.47978778]
curr_Stock_Price:  100.11586930945533
curr_Factors:  [1.00115869e+02 4.00103230e-02]
mat_Sqrt:  [[ 2.00257574e+01  0.00000000e+00]
 [-8.00103224e-03  1.83326679e-02]]
grads:  [ 0.07197746 17.61402487]
Stock Position:  0.07197746339680709
Bond Position:  [-3.72629854]


portfolio before change:  [3.49882097]
curr_Stock_Price:  100.38677357891511
curr_Factors:  [1.00386774e+02 4.04689503e-02]
mat_Sqrt:  [[ 2.01947028e+01  0.00000000e+00]
 [-8.04675838e-03  1.84374397e-02]]
grads:  [0.01663936 5.83328355]
Stock Position:  0.016639356310558285
Bond Position:  [1.82844967]


portfolio before change:  [3.52596402]
curr_Stock_Price:  102.0042929046257
curr_Factors:  [1.02004293e+02 3.95665070e-02]
mat_Sqrt:  [[ 2.02900121e+01  0.00000000e+00]
 [-7.95653261e-03  1.82307065e-02]]
grads:  [-0.01722579 -7.25185615]
Stock Position:  -0.01722579362204918
Bond Position:  [5.28306892]


portfolio before change:  [3.51846073]
curr_Stock_Price:  102.47821659227259
curr_Factors:  [1.02478217e+02 3.97894596e-02]
mat_Sqrt:  [[ 2.04416326e+01  0.00000000e+00]
 [-7.97891818e-03  1.82819983e-02]]
grads:  [-8.62268233e-04 -8.26278527e+00]
Stock Position:  -0.000862268232570512
Bond Position:  [3.60682444]


portfolio before change:  [3.51919542]
curr_Stock_Price:  102.14907487111245
curr_Factors:  [1.02149075e+02 3.93859115e-02]
mat_Sqrt:  [[ 2.02723870e+01  0.00000000e+00]
 [-7.93835364e-03  1.81890532e-02]]
grads:  [-1.44295342e-02 -2.18701223e+01]
Stock Position:  -0.014429534196985654
Bond Position:  [4.99315899]


portfolio before change:  [3.51106516]
curr_Stock_Price:  102.75577844401411
curr_Factors:  [1.02755778e+02 3.84067894e-02]
mat_Sqrt:  [[ 2.01377180e+01  0.00000000e+00]
 [-7.83906008e-03  1.79615431e-02]]
grads:  [-0.01451711 13.09654443]
Stock Position:  -0.014517111158386666
Bond Position:  [5.00278221]


portfolio before change:  [3.51290967]
curr_Stock_Price:  102.67179981343072
curr_Factors:  [1.02671800e+02 3.84067433e-02]
mat_Sqrt:  [[ 2.01212481e+01  0.00000000e+00]
 [-7.83905538e-03  1.79615323e-02]]
grads:  [ 6.59011976e-03 -1.62599827e+01]
Stock Position:  0.006590119764395225
Bond Position:  [2.83629021]


portfolio before change:  [3.51793913]
curr_Stock_Price:  103.38118088691668
curr_Factors:  [1.03381181e+02 3.85919485e-02]
mat_Sqrt:  [[ 2.03090609e+01  0.00000000e+00]
 [-7.85793342e-03  1.80047873e-02]]
grads:  [-0.02758439  8.25279025]
Stock Position:  -0.027584387645662293
Bond Position:  [6.3696457]


portfolio before change:  [3.50271147]
curr_Stock_Price:  103.96208610602055
curr_Factors:  [1.03962086e+02 3.75694512e-02]
mat_Sqrt:  [[ 2.01508055e+01  0.00000000e+00]
 [-7.75313626e-03  1.77646669e-02]]
grads:  [-0.00711393 -4.58123937]
Stock Position:  -0.007113930837751619
Bond Position:  [4.24229056]


portfolio before change:  [3.50776323]
curr_Stock_Price:  103.32651115219493
curr_Factors:  [1.03326511e+02 3.84056952e-02]
mat_Sqrt:  [[ 2.02492798e+01  0.00000000e+00]
 [-7.83894842e-03  1.79612873e-02]]
grads:  [-2.58680862e-02 -2.98772029e+01]
Stock Position:  -0.02586808615368851
Bond Position:  [6.18062232]


portfolio before change:  [3.50612203]
curr_Stock_Price:  103.41982423715078
curr_Factors:  [1.03419824e+02 3.97201926e-02]
mat_Sqrt:  [[ 2.06114938e+01  0.00000000e+00]
 [-7.97197016e-03  1.82660783e-02]]
grads:  [-0.00410975 -0.56958719]
Stock Position:  -0.004109753499070365
Bond Position:  [3.93115201]


portfolio before change:  [3.50627961]
curr_Stock_Price:  103.50105656137971
curr_Factors:  [1.03501057e+02 4.17727575e-02]
mat_Sqrt:  [[ 2.11539442e+01  0.00000000e+00]
 [-8.17535393e-03  1.87320891e-02]]
grads:  [-9.08483848e-03 -9.22832420e+00]
Stock Position:  -0.009084838478204921
Bond Position:  [4.44656999]


portfolio before change:  [3.49909142]
curr_Stock_Price:  104.35347057059079
curr_Factors:  [1.04353471e+02 4.08519235e-02]
mat_Sqrt:  [[ 2.10917761e+01  0.00000000e+00]
 [-8.08474351e-03  1.85244745e-02]]
grads:  [-0.00294592 -1.64132891]
Stock Position:  -0.002945923904192308
Bond Position:  [3.8065088]


portfolio before change:  [3.49622074]
curr_Stock_Price:  105.48945337682633
curr_Factors:  [1.05489453e+02 3.99654610e-02]
mat_Sqrt:  [[ 2.10887800e+01  0.00000000e+00]
 [-7.99654535e-03  1.83223872e-02]]
grads:  [-2.95266948e-03 -1.06210750e+01]
Stock Position:  -0.002952669479977032
Bond Position:  [3.80769623]


portfolio before change:  [3.49678603]
curr_Stock_Price:  105.45921199856333
curr_Factors:  [1.05459212e+02 4.19257935e-02]
mat_Sqrt:  [[ 2.15936057e+01  0.00000000e+00]
 [-8.19031560e-03  1.87663706e-02]]
grads:  [-4.82215161e-03 -5.16073161e+00]
Stock Position:  -0.0048221516104978894
Bond Position:  [4.00532634]


portfolio before change:  [3.50615987]
curr_Stock_Price:  103.61913088749861
curr_Factors:  [1.03619131e+02 4.19380956e-02]
mat_Sqrt:  [[ 2.12199472e+01  0.00000000e+00]
 [-8.19151714e-03  1.87691237e-02]]
grads:  [-9.42439904e-03 -3.83625623e+01]
Stock Position:  -0.0094243990438465
Bond Position:  [4.48270791]


portfolio before change:  [3.51636634]
curr_Stock_Price:  102.59560712992514
curr_Factors:  [1.02595607e+02 4.41911472e-02]
mat_Sqrt:  [[ 2.15673310e+01  0.00000000e+00]
 [-8.40867621e-03  1.92666976e-02]]
grads:  [-1.68988746e-03 -7.66805516e+00]
Stock Position:  -0.001689887463369075
Bond Position:  [3.68974137]


portfolio before change:  [3.51630426]
curr_Stock_Price:  102.90529009704547
curr_Factors:  [1.02905290e+02 4.58446144e-02]
mat_Sqrt:  [[ 2.20334175e+01  0.00000000e+00]
 [-8.56454219e-03  1.96238314e-02]]
grads:  [-1.56989423e-03 -7.86418522e+00]
Stock Position:  -0.001569894225890547
Bond Position:  [3.67785468]


portfolio before change:  [3.51674156]
curr_Stock_Price:  102.9195964094701
curr_Factors:  [1.02919596e+02 4.40068343e-02]
mat_Sqrt:  [[ 2.15902732e+01  0.00000000e+00]
 [-8.39112239e-03  1.92264768e-02]]
grads:  [-1.47646647e-02 -2.44084057e+01]
Stock Position:  -0.014764664673788876
Bond Position:  [5.03631489]


portfolio before change:  [3.50274146]
curr_Stock_Price:  103.91045385258124
curr_Factors:  [1.03910454e+02 4.31614257e-02]
mat_Sqrt:  [[ 2.15877377e+01  0.00000000e+00]
 [-8.31013123e-03  1.90409027e-02]]
grads:  [-2.24484245e-04 -5.72942318e+00]
Stock Position:  -0.00022448424543012005
Bond Position:  [3.52606772]


portfolio before change:  [3.50298101]
curr_Stock_Price:  104.80689286659722
curr_Factors:  [1.04806893e+02 4.17158179e-02]
mat_Sqrt:  [[ 2.14062320e+01  0.00000000e+00]
 [-8.16978020e-03  1.87193181e-02]]
grads:  [ 0.0052398  -1.18619111]
Stock Position:  0.005239800969985673
Bond Position:  [2.95381375]


portfolio before change:  [3.49984432]
curr_Stock_Price:  104.1377947758678
curr_Factors:  [1.04137795e+02 4.21481123e-02]
mat_Sqrt:  [[ 2.13794949e+01  0.00000000e+00]
 [-8.21200217e-03  1.88160608e-02]]
grads:  [ 9.72862779e-03 -1.95184922e+01]
Stock Position:  0.009728627789143917
Bond Position:  [2.48672648]


portfolio before change:  [3.50935778]
curr_Stock_Price:  105.08372419220069
curr_Factors:  [1.05083724e+02 4.21303874e-02]
mat_Sqrt:  [[ 2.15691575e+01  0.00000000e+00]
 [-8.21027526e-03  1.88121039e-02]]
grads:  [-5.46321050e-03 -1.76539073e+01]
Stock Position:  -0.005463210503229491
Bond Position:  [4.08345228]


portfolio before change:  [3.5104258]
curr_Stock_Price:  104.98166664292002
curr_Factors:  [1.04981667e+02 4.26403353e-02]
mat_Sqrt:  [[ 2.16782274e+01  0.00000000e+00]
 [-8.25981455e-03  1.89256127e-02]]
grads:  [2.70038943e-03 3.39803767e+00]
Stock Position:  0.0027003894282818523
Bond Position:  [3.22693442]


portfolio before change:  [3.50955727]
curr_Stock_Price:  104.51065290890628
curr_Factors:  [1.04510653e+02 4.36404070e-02]
mat_Sqrt:  [[ 2.18325748e+01  0.00000000e+00]
 [-8.35611460e-03  1.91462638e-02]]
grads:  [ 1.21886190e-02 -2.03967267e+01]
Stock Position:  0.012188618963214576
Bond Position:  [2.23571675]


portfolio before change:  [3.51110422]
curr_Stock_Price:  104.61464078200966
curr_Factors:  [1.04614641e+02 4.29696395e-02]
mat_Sqrt:  [[ 2.16856939e+01  0.00000000e+00]
 [-8.29164780e-03  1.89985518e-02]]
grads:  [-0.01260656  1.30799429]
Stock Position:  -0.012606564007819315
Bond Position:  [4.82993539]


portfolio before change:  [3.5512588]
curr_Stock_Price:  101.47732310289425
curr_Factors:  [1.01477323e+02 4.47140086e-02]
mat_Sqrt:  [[ 2.14580773e+01  0.00000000e+00]
 [-8.45827487e-03  1.93803424e-02]]
grads:  [-0.00668472 -2.33426435]
Stock Position:  -0.006684717478173769
Bond Position:  [4.22960604]


portfolio before change:  [3.56323034]
curr_Stock_Price:  99.76553762713864
curr_Factors:  [9.97655376e+01 4.54179702e-02]
mat_Sqrt:  [[ 2.12615248e+01  0.00000000e+00]
 [-8.52459691e-03  1.95323053e-02]]
grads:  [5.76184266e-03 8.48342665e+00]
Stock Position:  0.005761842660823694
Bond Position:  [2.98839701]


portfolio before change:  [3.55415055]
curr_Stock_Price:  98.12485495240315
curr_Factors:  [9.81248550e+01 4.74858356e-02]
mat_Sqrt:  [[ 2.13826275e+01  0.00000000e+00]
 [-8.71649798e-03  1.99720059e-02]]
grads:  [0.00946451 0.92053893]
Stock Position:  0.009464508079892225
Bond Position:  [2.62544707]


portfolio before change:  [3.54042665]
curr_Stock_Price:  96.64013928211943
curr_Factors:  [9.66401393e+01 4.93333534e-02]
mat_Sqrt:  [[ 2.14648504e+01  0.00000000e+00]
 [-8.88444514e-03  2.03568212e-02]]
grads:  [-0.02863205 -9.60556177]
Stock Position:  -0.028632045974719883
Bond Position:  [6.30743156]


portfolio before change:  [3.55056618]
curr_Stock_Price:  96.31354548969392
curr_Factors:  [9.63135455e+01 5.06882067e-02]
mat_Sqrt:  [[ 2.16840717e+01  0.00000000e+00]
 [-9.00561662e-03  2.06344599e-02]]
grads:  [-0.00282198 -0.80715393]
Stock Position:  -0.002821977787934002
Bond Position:  [3.82236086]


portfolio before change:  [3.5456775]
curr_Stock_Price:  98.2152267696548
curr_Factors:  [9.82152268e+01 5.00044305e-02]
mat_Sqrt:  [[ 2.19625653e+01  0.00000000e+00]
 [-8.94466818e-03  2.04948095e-02]]
grads:  [-9.49292392e-04 -2.32300800e+00]
Stock Position:  -0.0009492923917903551
Bond Position:  [3.63891247]


portfolio before change:  [3.54657918]
curr_Stock_Price:  97.74457043377079
curr_Factors:  [9.77445704e+01 4.92529103e-02]
mat_Sqrt:  [[ 2.16924493e+01  0.00000000e+00]
 [-8.87719868e-03  2.03402175e-02]]
grads:  [5.46975259e-03 8.93834328e+00]
Stock Position:  0.0054697525898065626
Bond Position:  [3.01194057]


portfolio before change:  [3.54198706]
curr_Stock_Price:  96.83618568798298
curr_Factors:  [9.68361857e+01 5.12021408e-02]
mat_Sqrt:  [[ 2.19119856e+01  0.00000000e+00]
 [-9.05115602e-03  2.07388038e-02]]
grads:  [0.00075473 0.00607875]
Stock Position:  0.0007547301631157184
Bond Position:  [3.46890187]


portfolio before change:  [3.54279013]
curr_Stock_Price:  97.32567428575881
curr_Factors:  [9.73256743e+01 5.01249068e-02]
mat_Sqrt:  [[ 2.17898485e+01  0.00000000e+00]
 [-8.95543694e-03  2.05194838e-02]]
grads:  [ 0.00432041 -1.96260559]
Stock Position:  0.00432040788413056
Bond Position:  [3.12230352]


portfolio before change:  [3.53725649]
curr_Stock_Price:  95.95451769813232
curr_Factors:  [9.59545177e+01 5.14231341e-02]
mat_Sqrt:  [[ 2.17592889e+01  0.00000000e+00]
 [-9.07066781e-03  2.07835109e-02]]
grads:  [4.04995738e-03 5.47379067e+00]
Stock Position:  0.004049957383122835
Bond Position:  [3.14864478]


portfolio before change:  [3.5363403]
curr_Stock_Price:  95.63110873987539
curr_Factors:  [9.56311087e+01 5.26012792e-02]
mat_Sqrt:  [[ 2.19329649e+01  0.00000000e+00]
 [-9.17398751e-03  2.10202461e-02]]
grads:  [-5.83824093e-04  4.11970220e+00]
Stock Position:  -0.0005838240929852032
Bond Position:  [3.59217205]


portfolio before change:  [3.53748296]
curr_Stock_Price:  94.44306773141395
curr_Factors:  [9.44430677e+01 5.17407106e-02]
mat_Sqrt:  [[ 2.14825722e+01  0.00000000e+00]
 [-9.09863380e-03  2.08475890e-02]]
grads:  [-0.01896068 -6.14611665]
Stock Position:  -0.01896067936420291
Bond Position:  [5.32818768]


portfolio before change:  [3.58426804]
curr_Stock_Price:  92.01071706238496
curr_Factors:  [9.20107171e+01 5.39646242e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.58426804]
Stock Price:  93.01450462753671
PL:  [3.58426804]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.12026769e+00  2.82171294e-01]
 [ 1.97063903e-01  9.28555515e-02]
 [-1.40167760e-03 -5.76244649e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.22948718e-02  1.63246617e-01]
 [-3.50715004e-01  1.80007369e-01]
 [ 1.66071409e-01 -1.67237026e-01]
 [-2.36133141e-01  3.26174610e-01]
 [-1.10498351e-01 -6.37349025e-02]
 [-1.15004861e-01 -3.68858574e-01]
 [-7.67490441e-02 -1.12572154e-02]
 [ 6.68179097e-03 -1.36057846e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 2.33151805e-02 -2.00615207e-01]
 [ 1.80694493e-01  1.02425102e-01]
 [ 1.25362599e-01 -5.92566882e-01]
 [ 3.22787423e-02 -1.12787641e-01]
 [ 3.30651651e-02 -1.54654893e-01]
 [-1.14722568e-01 -4.61708954e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.48175899e-01 -3.07342744e-02]
 [ 5.15803211e-01 -2.44508618e-01]
 [ 2.96406171e-02 -3.97224106e-01]
 [ 3.56005494e-02  3.83271519e-02]
 [ 4.38931950e-01 -3.97947885e-01]
 [-3.38179268e-01  3.71284967e-02]
 [-1.41175858e-01  1.41584197e-01]
 [-5.00071937e-02  6.75170203e-02]
 [-7.88604242e-02  2.11999367e-01]
 [-7.01701849e-01  1.62894166e-01]
 [-1.16204413e-01  3.30107644e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.22272059e-01 -5.79353448e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.79359765e-01 -5.20194875e-02]
 [-3.04775249e-02 -1.49100902e-01]
 [-6.31755918e-03 -6.45083788e-02]
 [ 2.06720343e-01 -2.27213180e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.86296195]
curr_Stock_Price:  100.89726376825739
curr_Factors:  [1.00897264e+02 3.92717932e-02]
mat_Sqrt:  [[ 1.99949239e+01  0.00000000e+00]
 [-7.92684484e-03  1.81626832e-02]]
grads:  [ 0.06218665 15.53577135]
Stock Position:  0.062186650218330634
Bond Position:  [2.5884991]


portfolio before change:  [8.84744343]
curr_Stock_Price:  100.64251292043714
curr_Factors:  [1.00642513e+02 3.89527532e-02]
mat_Sqrt:  [[ 1.98632611e+01  0.00000000e+00]
 [-7.89458075e-03  1.80887569e-02]]
grads:  [0.01196125 5.13332961]
Stock Position:  0.011961247787752087
Bond Position:  [7.6436334]


portfolio before change:  [8.85263789]
curr_Stock_Price:  100.99690280161873
curr_Factors:  [1.00996903e+02 4.08887566e-02]
mat_Sqrt:  [[ 2.04225519e+01  0.00000000e+00]
 [-8.08838738e-03  1.85328237e-02]]
grads:  [-1.30008513e-03 -3.10931921e+00]
Stock Position:  -0.00130008512582247
Bond Position:  [8.98394246]


portfolio before change:  [8.8557619]
curr_Stock_Price:  99.45781423166086
curr_Factors:  [9.94578142e+01 4.23056645e-02]
mat_Sqrt:  [[ 2.04568222e+01  0.00000000e+00]
 [-8.22733634e-03  1.88511958e-02]]
grads:  [-7.9686702e-04 -8.0306212e+00]
Stock Position:  -0.0007968670196147121
Bond Position:  [8.93501655]


portfolio before change:  [8.85655858]
curr_Stock_Price:  99.85971524077735
curr_Factors:  [9.98597152e+01 4.21690825e-02]
mat_Sqrt:  [[ 2.05063044e+01  0.00000000e+00]
 [-8.21404480e-03  1.88207410e-02]]
grads:  [-5.38771239e-04  8.67376141e+00]
Stock Position:  -0.0005387712389124272
Bond Position:  [8.91036013]


portfolio before change:  [8.85667213]
curr_Stock_Price:  101.71638053928798
curr_Factors:  [1.01716381e+02 4.06363511e-02]
mat_Sqrt:  [[ 2.05044559e+01  0.00000000e+00]
 [-8.06338401e-03  1.84755338e-02]]
grads:  [-0.01327289  9.74301314]
Stock Position:  -0.013272888044959215
Bond Position:  [10.20674226]


portfolio before change:  [8.86140351]
curr_Stock_Price:  101.45604086050658
curr_Factors:  [1.01456041e+02 4.09992163e-02]
mat_Sqrt:  [[ 2.05430862e+01  0.00000000e+00]
 [-8.09930528e-03  1.85578398e-02]]
grads:  [ 4.5311199e-03 -9.0116645e+00]
Stock Position:  0.004531119901809732
Bond Position:  [8.40169403]


portfolio before change:  [8.86424084]
curr_Stock_Price:  101.85043471090871
curr_Factors:  [1.01850435e+02 4.11539786e-02]
mat_Sqrt:  [[ 2.06618308e+01  0.00000000e+00]
 [-8.11457736e-03  1.85928325e-02]]
grads:  [-4.53874930e-03  1.75430296e+01]
Stock Position:  -0.0045387492984810904
Bond Position:  [9.32651442]


portfolio before change:  [8.86930849]
curr_Stock_Price:  100.99077741611431
curr_Factors:  [1.00990777e+02 4.06552009e-02]
mat_Sqrt:  [[ 2.03629067e+01  0.00000000e+00]
 [-8.06525396e-03  1.84798184e-02]]
grads:  [-0.00679248 -3.44889225]
Stock Position:  -0.006792475404488966
Bond Position:  [9.55528586]


portfolio before change:  [8.86259022]
curr_Stock_Price:  102.15570774383283
curr_Factors:  [1.02155708e+02 4.04195449e-02]
mat_Sqrt:  [[ 2.05380093e+01  0.00000000e+00]
 [-8.04184505e-03  1.84261818e-02]]
grads:  [-1.34379110e-02 -2.00181772e+01]
Stock Position:  -0.01343791095941449
Bond Position:  [10.23534952]


portfolio before change:  [8.87808366]
curr_Stock_Price:  101.09795851271713
curr_Factors:  [1.01097959e+02 4.15623952e-02]
mat_Sqrt:  [[ 2.06106966e+01  0.00000000e+00]
 [-8.15474293e-03  1.86848634e-02]]
grads:  [-0.00396212 -0.6024778 ]
Stock Position:  -0.0039621220692980935
Bond Position:  [9.27864611]


portfolio before change:  [8.88062451]
curr_Stock_Price:  100.74941949031036
curr_Factors:  [1.00749419e+02 4.06034710e-02]
mat_Sqrt:  [[ 2.03013133e+01  0.00000000e+00]
 [-8.06012119e-03  1.84680577e-02]]
grads:  [-2.59582818e-03 -7.36719843e+00]
Stock Position:  -0.0025958281847607055
Bond Position:  [9.1421527]


portfolio before change:  [8.87677486]
curr_Stock_Price:  102.67269651084749
curr_Factors:  [1.02672697e+02 4.06439714e-02]
mat_Sqrt:  [[ 2.06991750e+01  0.00000000e+00]
 [-8.06414002e-03  1.84772660e-02]]
grads:  [-0.00316484 -0.96821699]
Stock Position:  -0.003164837295520283
Bond Position:  [9.20171724]


portfolio before change:  [8.8757664]
curr_Stock_Price:  103.3548000521372
curr_Factors:  [1.03354800e+02 4.14281023e-02]
mat_Sqrt:  [[ 2.10367270e+01  0.00000000e+00]
 [-8.14155782e-03  1.86546525e-02]]
grads:  [-3.05372950e-03 -1.07541648e+01]
Stock Position:  -0.003053729500129678
Bond Position:  [9.191384]


portfolio before change:  [8.87850219]
curr_Stock_Price:  102.83517369616442
curr_Factors:  [1.02835174e+02 4.07970924e-02]
mat_Sqrt:  [[ 2.07709467e+01  0.00000000e+00]
 [-8.07931605e-03  1.85120387e-02]]
grads:  [0.01085153 5.53289155]
Stock Position:  0.01085152621659425
Bond Position:  [7.76258361]


portfolio before change:  [8.87736476]
curr_Stock_Price:  102.64093291960002
curr_Factors:  [1.02640933e+02 4.16104879e-02]
mat_Sqrt:  [[ 2.09373636e+01  0.00000000e+00]
 [-8.15945958e-03  1.86956706e-02]]
grads:  [-6.36444936e-03 -3.16954066e+01]
Stock Position:  -0.006364449357413816
Bond Position:  [9.53061778]


portfolio before change:  [8.88257242]
curr_Stock_Price:  102.0098883144109
curr_Factors:  [1.02009888e+02 4.10113656e-02]
mat_Sqrt:  [[ 2.06582908e+01  0.00000000e+00]
 [-8.10050523e-03  1.85605892e-02]]
grads:  [-8.20291479e-04 -6.07672743e+00]
Stock Position:  -0.0008202914790453117
Bond Position:  [8.96625026]


portfolio before change:  [8.88286839]
curr_Stock_Price:  103.01548191725573
curr_Factors:  [1.03015482e+02 4.09633164e-02]
mat_Sqrt:  [[ 2.08497117e+01  0.00000000e+00]
 [-8.09575853e-03  1.85497131e-02]]
grads:  [-1.65142637e-03 -8.33731991e+00]
Stock Position:  -0.001651426372184855
Bond Position:  [9.05299087]


portfolio before change:  [8.88318629]
curr_Stock_Price:  103.5082623928566
curr_Factors:  [1.03508262e+02 4.14005751e-02]
mat_Sqrt:  [[ 2.10609620e+01  0.00000000e+00]
 [-8.13885251e-03  1.86484538e-02]]
grads:  [-1.50149302e-02 -2.47585649e+01]
Stock Position:  -0.015014930225247794
Bond Position:  [10.43735563]


portfolio before change:  [8.86523145]
curr_Stock_Price:  104.7909584724898
curr_Factors:  [1.04790958e+02 4.15181603e-02]
mat_Sqrt:  [[ 2.13522115e+01  0.00000000e+00]
 [-8.15040223e-03  1.86749176e-02]]
grads:  [-2.26960425e-04 -5.84170660e+00]
Stock Position:  -0.00022696042517149744
Bond Position:  [8.88901485]


portfolio before change:  [8.86673905]
curr_Stock_Price:  103.04439464890648
curr_Factors:  [1.03044395e+02 4.28048582e-02]
mat_Sqrt:  [[ 2.13192000e+01  0.00000000e+00]
 [-8.27573399e-03  1.89620887e-02]]
grads:  [ 0.00632117 -1.62082747]
Stock Position:  0.006321173486947482
Bond Position:  [8.21537755]


portfolio before change:  [8.86415043]
curr_Stock_Price:  102.4724108334896
curr_Factors:  [1.02472411e+02 4.23627317e-02]
mat_Sqrt:  [[ 2.10910855e+01  0.00000000e+00]
 [-8.23288350e-03  1.88639059e-02]]
grads:  [  0.01939639 -12.96171741]
Stock Position:  0.019396389120072324
Bond Position:  [6.87655567]


portfolio before change:  [8.87272216]
curr_Stock_Price:  102.8700163542119
curr_Factors:  [1.02870016e+02 4.02050934e-02]
mat_Sqrt:  [[ 2.06266807e+01  0.00000000e+00]
 [-8.02048312e-03  1.83772355e-02]]
grads:  [-6.96778108e-03 -2.16150088e+01]
Stock Position:  -0.006967781078354036
Bond Position:  [9.58949791]


portfolio before change:  [8.86399235]
curr_Stock_Price:  104.29494174991873
curr_Factors:  [1.04294942e+02 4.18913565e-02]
mat_Sqrt:  [[ 2.13464400e+01  0.00000000e+00]
 [-8.18695123e-03  1.87586619e-02]]
grads:  [0.00245136 2.04317089]
Stock Position:  0.0024513637779563103
Bond Position:  [8.60832751]


portfolio before change:  [8.86599858]
curr_Stock_Price:  104.67437008793068
curr_Factors:  [1.04674370e+02 4.18885999e-02]
mat_Sqrt:  [[ 2.14233942e+01  0.00000000e+00]
 [-8.18668186e-03  1.87580447e-02]]
grads:  [ 1.23814766e-02 -2.12147850e+01]
Stock Position:  0.0123814766166612
Bond Position:  [7.56997531]


portfolio before change:  [8.87181481]
curr_Stock_Price:  105.06769364191018
curr_Factors:  [1.05067694e+02 4.30899913e-02]
mat_Sqrt:  [[ 2.18100872e+01  0.00000000e+00]
 [-8.30325153e-03  1.90251393e-02]]
grads:  [-0.01476267  1.95154927]
Stock Position:  -0.014762667408661811
Bond Position:  [10.42289423]


portfolio before change:  [8.87240054]
curr_Stock_Price:  105.11627657972201
curr_Factors:  [1.05116277e+02 4.31948271e-02]
mat_Sqrt:  [[ 2.18466997e+01  0.00000000e+00]
 [-8.31334610e-03  1.90482689e-02]]
grads:  [-3.63365860e-03  7.43291673e+00]
Stock Position:  -0.0036336585992991924
Bond Position:  [9.2543572]


portfolio before change:  [8.87692975]
curr_Stock_Price:  104.18819112613842
curr_Factors:  [1.04188191e+02 4.22747391e-02]
mat_Sqrt:  [[ 2.14219483e+01  0.00000000e+00]
 [-8.22432870e-03  1.88443044e-02]]
grads:  [-9.58846041e-04  3.58288737e+00]
Stock Position:  -0.0009588460413411258
Bond Position:  [8.97683019]


portfolio before change:  [8.87693207]
curr_Stock_Price:  105.35611205617234
curr_Factors:  [1.05356112e+02 4.37568786e-02]
mat_Sqrt:  [[ 2.20385442e+01  0.00000000e+00]
 [-8.36725796e-03  1.91717965e-02]]
grads:  [6.19990363e-04 1.10578770e+01]
Stock Position:  0.0006199903629488041
Bond Position:  [8.8116123]


portfolio before change:  [8.87815407]
curr_Stock_Price:  105.55043735619627
curr_Factors:  [1.05550437e+02 4.45714566e-02]
mat_Sqrt:  [[ 2.22837589e+01  0.00000000e+00]
 [-8.44478127e-03  1.93494247e-02]]
grads:  [-0.02829904  8.41855347]
Stock Position:  -0.028299040971617458
Bond Position:  [11.86513022]


portfolio before change:  [8.82936416]
curr_Stock_Price:  107.32693397009851
curr_Factors:  [1.07326934e+02 4.35483838e-02]
mat_Sqrt:  [[ 2.23972524e+01  0.00000000e+00]
 [-8.34729981e-03  1.91260666e-02]]
grads:  [-0.00454508  1.72595678]
Stock Position:  -0.004545081351376416
Bond Position:  [9.3171738]


portfolio before change:  [8.83555584]
curr_Stock_Price:  106.22091136352061
curr_Factors:  [1.06220911e+02 4.26707723e-02]
mat_Sqrt:  [[ 2.19419527e+01  0.00000000e+00]
 [-8.26276199e-03  1.89323661e-02]]
grads:  [ 0.00330611 -0.63104575]
Stock Position:  0.0033061139845984478
Bond Position:  [8.4843774]


portfolio before change:  [8.83692024]
curr_Stock_Price:  106.31279806309104
curr_Factors:  [1.06312798e+02 4.27479892e-02]
mat_Sqrt:  [[ 2.19807949e+01  0.00000000e+00]
 [-8.27023474e-03  1.89494884e-02]]
grads:  [-0.01126243 -3.05735668]
Stock Position:  -0.011262427849515987
Bond Position:  [10.03426046]


portfolio before change:  [8.83296917]
curr_Stock_Price:  106.77499203480328
curr_Factors:  [1.06774992e+02 4.22942597e-02]
mat_Sqrt:  [[ 2.19588839e+01  0.00000000e+00]
 [-8.22622730e-03  1.88486546e-02]]
grads:  [0.00462096 2.83039092]
Stock Position:  0.004620962175808266
Bond Position:  [8.33956597]


portfolio before change:  [8.83050711]
curr_Stock_Price:  106.01658495751613
curr_Factors:  [1.06016585e+02 4.24768212e-02]
mat_Sqrt:  [[ 2.18499182e+01  0.00000000e+00]
 [-8.24396227e-03  1.88892906e-02]]
grads:  [-0.00433263  4.30535736]
Stock Position:  -0.004332629993361801
Bond Position:  [9.28983775]


portfolio before change:  [8.82960137]
curr_Stock_Price:  106.49367206837869
curr_Factors:  [1.06493672e+02 4.16199517e-02]
mat_Sqrt:  [[ 2.17257405e+01  0.00000000e+00]
 [-8.16038742e-03  1.86977965e-02]]
grads:  [-0.01850629 -2.7821186 ]
Stock Position:  -0.01850629348587024
Bond Position:  [10.80040452]


portfolio before change:  [8.82069862]
curr_Stock_Price:  107.04769384590367
curr_Factors:  [1.07047694e+02 4.08337565e-02]
mat_Sqrt:  [[ 2.16315173e+01  0.00000000e+00]
 [-8.08294565e-03  1.85203551e-02]]
grads:  [-4.41718869e-03 -8.05065027e+00]
Stock Position:  -0.004417188690121279
Bond Position:  [9.29354848]


portfolio before change:  [8.82594939]
curr_Stock_Price:  106.12199006960192
curr_Factors:  [1.06121990e+02 4.06247346e-02]
mat_Sqrt:  [[ 2.13895011e+01  0.00000000e+00]
 [-8.06223141e-03  1.84728929e-02]]
grads:  [-1.61160018e-03 -3.49205613e+00]
Stock Position:  -0.00161160018341302
Bond Position:  [8.99697561]


portfolio before change:  [8.82429715]
curr_Stock_Price:  107.84508242710248
curr_Factors:  [1.07845082e+02 4.05986514e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.82429715]
Stock Price:  108.58649102210939
PL:  [0.23780613]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.35718777e+00  3.35734178e-01]
 [-2.42120410e-01 -9.08525000e-02]
 [-2.67091910e-01 -1.26095188e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.04615230e-01 -1.56797552e-01]
 [-3.62527917e-01  1.94736950e-01]
 [ 1.93569299e-01 -2.03556929e-01]
 [-6.17531088e-01  1.61345866e-01]
 [-1.11809943e-01 -9.68423926e-02]
 [-1.70315468e-01 -4.47563343e-01]
 [-6.90214905e-02 -1.27569606e-02]
 [-8.32463796e-02 -1.53754695e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 2.32275232e-02 -1.99806305e-01]
 [ 4.14495046e-02 -1.70466482e-02]
 [ 1.14879567e-01 -7.11659680e-01]
 [ 2.00326090e-02 -2.67103009e-01]
 [ 3.25389981e-02 -1.54081197e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.27280510e-01 -2.39205367e-02]
 [ 3.67710080e-01 -3.66747828e-01]
 [ 2.72739615e-02 -3.34370208e-01]
 [ 2.80966142e-02  7.51301744e-02]
 [ 4.50241218e-01 -4.32673939e-01]
 [-2.66034633e-01  2.07840809e-02]
 [-1.57557775e-01  9.20679187e-02]
 [-2.71404066e-02  1.59696988e-01]
 [-4.74985118e-02  1.96036688e-01]
 [-5.36824873e-01 -1.00182746e-01]
 [-1.68526898e-01 -6.37717021e-02]
 [ 1.15407768e-02 -6.68687118e-02]
 [-8.91363403e-02  1.61286657e-01]
 [ 9.37602106e-03  6.46464097e-03]
 [ 1.81032040e-01 -1.14090070e-01]
 [ 4.42959522e-02  1.10843600e-01]
 [-6.20725789e-02  2.70928831e-01]
 [-3.39816158e-01 -1.24234035e-01]
 [ 1.27384807e-01 -6.12014705e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.76360987]
curr_Stock_Price:  99.86675756477084
curr_Factors:  [9.98667576e+01 3.93312084e-02]
mat_Sqrt:  [[ 1.98056725e+01  0.00000000e+00]
 [-7.93283892e-03  1.81764174e-02]]
grads:  [ 0.07592341 18.47086641]
Stock Position:  0.07592340916639236
Bond Position:  [-5.81861482]


portfolio before change:  [1.89815306]
curr_Stock_Price:  101.64842887729617
curr_Factors:  [1.01648429e+02 3.93069540e-02]
mat_Sqrt:  [[ 2.01527986e+01  0.00000000e+00]
 [-7.93039258e-03  1.81708121e-02]]
grads:  [-0.01398176 -4.99991411]
Stock Position:  -0.013981764841662154
Bond Position:  [3.31937749]


portfolio before change:  [1.89480637]
curr_Stock_Price:  101.91746808537579
curr_Factors:  [1.01917468e+02 3.95475682e-02]
mat_Sqrt:  [[ 2.02678890e+01  0.00000000e+00]
 [-7.95462816e-03  1.82263428e-02]]
grads:  [-0.01589334 -6.91829344]
Stock Position:  -0.01589333554878286
Bond Position:  [3.51461488]


portfolio before change:  [1.89499086]
curr_Stock_Price:  101.93350392815539
curr_Factors:  [1.01933504e+02 3.86343661e-02]
mat_Sqrt:  [[ 2.00356690e+01  0.00000000e+00]
 [-7.86225068e-03  1.80146794e-02]]
grads:  [-8.13617302e-04 -8.40352519e+00]
Stock Position:  -0.0008136173015371999
Bond Position:  [1.97792572]


portfolio before change:  [1.89584169]
curr_Stock_Price:  101.19166342580213
curr_Factors:  [1.01191663e+02 3.87591418e-02]
mat_Sqrt:  [[ 1.99219484e+01  0.00000000e+00]
 [-7.87493662e-03  1.80437466e-02]]
grads:  [-8.68626341e-03 -8.68985558e+00]
Stock Position:  -0.008686263409949772
Bond Position:  [2.77481913]


portfolio before change:  [1.88884554]
curr_Stock_Price:  102.03702320494037
curr_Factors:  [1.02037023e+02 3.89092891e-02]
mat_Sqrt:  [[ 2.01272494e+01  0.00000000e+00]
 [-7.89017506e-03  1.80786622e-02]]
grads:  [-0.01378915 10.771646  ]
Stock Position:  -0.013789154157081396
Bond Position:  [3.29584979]


portfolio before change:  [1.89233856]
curr_Stock_Price:  101.81358577172773
curr_Factors:  [1.01813586e+02 3.93952631e-02]
mat_Sqrt:  [[ 2.02082049e+01  0.00000000e+00]
 [-7.93929600e-03  1.81912124e-02]]
grads:  [ 5.18253715e-03 -1.11898495e+01]
Stock Position:  0.005182537147689265
Bond Position:  [1.36468587]


portfolio before change:  [1.90002179]
curr_Stock_Price:  103.26319017615076
curr_Factors:  [1.03263190e+02 4.01563048e-02]
mat_Sqrt:  [[ 2.06929500e+01  0.00000000e+00]
 [-8.01561524e-03  1.83660818e-02]]
grads:  [-0.02643963  8.78499115]
Stock Position:  -0.026439631774157916
Bond Position:  [4.63026251]


portfolio before change:  [1.88999178]
curr_Stock_Price:  103.66443734525504
curr_Factors:  [1.03664437e+02 4.09791557e-02]
mat_Sqrt:  [[ 2.09851123e+01  0.00000000e+00]
 [-8.09732358e-03  1.85532991e-02]]
grads:  [-0.00734213 -5.21968583]
Stock Position:  -0.007342130272753752
Bond Position:  [2.65110958]


portfolio before change:  [1.89925569]
curr_Stock_Price:  102.44782821222769
curr_Factors:  [1.02447828e+02 4.20422991e-02]
mat_Sqrt:  [[ 2.10061269e+01  0.00000000e+00]
 [-8.20168754e-03  1.87924270e-02]]
grads:  [-1.74067369e-02 -2.38161544e+01]
Stock Position:  -0.017406736946657286
Bond Position:  [3.68253809]


portfolio before change:  [1.89222251]
curr_Stock_Price:  102.87832398211026
curr_Factors:  [1.02878324e+02 4.20950887e-02]
mat_Sqrt:  [[ 2.11076359e+01  0.00000000e+00]
 [-8.20683507e-03  1.88042215e-02]]
grads:  [-0.00353375 -0.6784094 ]
Stock Position:  -0.0035337488647598243
Bond Position:  [2.25576867]


portfolio before change:  [1.89181965]
curr_Stock_Price:  103.07212699235727
curr_Factors:  [1.03072127e+02 4.41372737e-02]
mat_Sqrt:  [[ 2.16542921e+01  0.00000000e+00]
 [-8.40354913e-03  1.92549500e-02]]
grads:  [-6.94321613e-03 -7.98520355e+00]
Stock Position:  -0.006943216128101687
Bond Position:  [2.6074717]


portfolio before change:  [1.89201066]
curr_Stock_Price:  103.09156245272095
curr_Factors:  [1.03091562e+02 4.44683012e-02]
mat_Sqrt:  [[ 2.17394419e+01  0.00000000e+00]
 [-8.43500337e-03  1.93270207e-02]]
grads:  [-0.00301339 -0.92564721]
Stock Position:  -0.00301339479072465
Bond Position:  [2.20266624]


portfolio before change:  [1.89061938]
curr_Stock_Price:  103.64463576346522
curr_Factors:  [1.03644636e+02 4.54279422e-02]
mat_Sqrt:  [[ 2.20906432e+01  0.00000000e+00]
 [-8.52553269e-03  1.95344494e-02]]
grads:  [-2.89602691e-03 -1.02284073e+01]
Stock Position:  -0.0028960269135173307
Bond Position:  [2.19077704]


portfolio before change:  [1.8899514]
curr_Stock_Price:  103.96985555679898
curr_Factors:  [1.03969856e+02 4.48475966e-02]
mat_Sqrt:  [[ 2.20179574e+01  0.00000000e+00]
 [-8.47090046e-03  1.94092713e-02]]
grads:  [ 0.00154464 -0.87827348]
Stock Position:  0.0015446363488105417
Bond Position:  [1.72935578]


portfolio before change:  [1.88954278]
curr_Stock_Price:  103.5653560699998
curr_Factors:  [1.03565356e+02 4.59014835e-02]
mat_Sqrt:  [[ 2.21884959e+01  0.00000000e+00]
 [-8.56985260e-03  1.96359991e-02]]
grads:  [-8.82052492e-03 -3.62426009e+01]
Stock Position:  -0.008820524921897749
Bond Position:  [2.80304358]


portfolio before change:  [1.87944406]
curr_Stock_Price:  104.74999343781575
curr_Factors:  [1.04749993e+02 4.42779538e-02]
mat_Sqrt:  [[ 2.20418365e+01  0.00000000e+00]
 [-8.41693092e-03  1.92856115e-02]]
grads:  [-4.37988464e-03 -1.38498594e+01]
Stock Position:  -0.004379884642975982
Bond Position:  [2.33823694]


portfolio before change:  [1.88817967]
curr_Stock_Price:  102.82224422581443
curr_Factors:  [1.02822244e+02 4.48422032e-02]
mat_Sqrt:  [[ 2.17736155e+01  0.00000000e+00]
 [-8.47039109e-03  1.94081042e-02]]
grads:  [-1.59401865e-03 -7.93901329e+00]
Stock Position:  -0.001594018653316477
Bond Position:  [2.05208025]


portfolio before change:  [1.88864028]
curr_Stock_Price:  102.69421806132102
curr_Factors:  [1.02694218e+02 4.58838522e-02]
mat_Sqrt:  [[ 2.19976318e+01  0.00000000e+00]
 [-8.56820655e-03  1.96322276e-02]]
grads:  [-1.44912483e-02 -2.39039428e+01]
Stock Position:  -0.014491248300314287
Bond Position:  [3.37680769]


portfolio before change:  [1.85690324]
curr_Stock_Price:  104.91343063081814
curr_Factors:  [1.04913431e+02 4.54441439e-02]
mat_Sqrt:  [[ 2.23650592e+01  0.00000000e+00]
 [-8.52705285e-03  1.95379326e-02]]
grads:  [-2.16682056e-04 -5.58367109e+00]
Stock Position:  -0.0002166820559344624
Bond Position:  [1.8796361]


portfolio before change:  [1.85723973]
curr_Stock_Price:  104.44490544457683
curr_Factors:  [1.04444905e+02 4.55074455e-02]
mat_Sqrt:  [[ 2.22806825e+01  0.00000000e+00]
 [-8.53298968e-03  1.95515356e-02]]
grads:  [ 0.00524404 -1.22346077]
Stock Position:  0.005244037369162115
Bond Position:  [1.30952675]


portfolio before change:  [1.85593073]
curr_Stock_Price:  104.16407047043305
curr_Factors:  [1.04164070e+02 4.49650411e-02]
mat_Sqrt:  [[ 2.20879515e+01  0.00000000e+00]
 [-8.48198478e-03  1.94346686e-02]]
grads:  [ 9.40097164e-03 -1.88708043e+01]
Stock Position:  0.009400971641071239
Bond Position:  [0.87668725]


portfolio before change:  [1.85765752]
curr_Stock_Price:  104.33609513748708
curr_Factors:  [1.04336095e+02 4.66965209e-02]
mat_Sqrt:  [[ 2.25463810e+01  0.00000000e+00]
 [-8.64375113e-03  1.98053219e-02]]
grads:  [-5.26280299e-03 -1.68828464e+01]
Stock Position:  -0.00526280298841832
Bond Position:  [2.40675783]


portfolio before change:  [1.85311689]
curr_Stock_Price:  105.25604092897328
curr_Factors:  [1.05256041e+02 4.76407159e-02]
mat_Sqrt:  [[ 2.29739764e+01  0.00000000e+00]
 [-8.73070131e-03  2.00045498e-02]]
grads:  [2.65022082e-03 3.75565434e+00]
Stock Position:  0.002650220819017681
Bond Position:  [1.57416514]


portfolio before change:  [1.85387772]
curr_Stock_Price:  105.46887092055489
curr_Factors:  [1.05468871e+02 4.58455792e-02]
mat_Sqrt:  [[ 2.25825525e+01  0.00000000e+00]
 [-8.56463232e-03  1.96240380e-02]]
grads:  [ 1.15756104e-02 -2.20481605e+01]
Stock Position:  0.011575610419564045
Bond Position:  [0.63301116]


portfolio before change:  [1.84232658]
curr_Stock_Price:  104.46414903166612
curr_Factors:  [1.04464149e+02 4.66688887e-02]
mat_Sqrt:  [[ 2.25673726e+01  0.00000000e+00]
 [-8.64119331e-03  1.97994612e-02]]
grads:  [-0.01138651  1.04972962]
Stock Position:  -0.011386514526298757
Bond Position:  [3.03180913]


portfolio before change:  [1.85503431]
curr_Stock_Price:  103.38140076686561
curr_Factors:  [1.03381401e+02 4.73523743e-02]
mat_Sqrt:  [[ 2.24964138e+01  0.00000000e+00]
 [-8.70424028e-03  1.99439200e-02]]
grads:  [-0.00521754  4.61634016]
Stock Position:  -0.005217544556145595
Bond Position:  [2.39443137]


portfolio before change:  [1.85550981]
curr_Stock_Price:  103.34763461489308
curr_Factors:  [1.03347635e+02 4.69880934e-02]
mat_Sqrt:  [[ 2.24023951e+01  0.00000000e+00]
 [-8.67069487e-03  1.98670578e-02]]
grads:  [1.89966621e-03 8.03828074e+00]
Stock Position:  0.0018996662083808405
Bond Position:  [1.6591838]


portfolio before change:  [1.85515361]
curr_Stock_Price:  103.0509484953107
curr_Factors:  [1.03050948e+02 4.78448806e-02]
mat_Sqrt:  [[ 2.25408210e+01  0.00000000e+00]
 [-8.74938906e-03  2.00473688e-02]]
grads:  [1.68844397e-03 9.77867421e+00]
Stock Position:  0.0016884439685503501
Bond Position:  [1.68115786]


portfolio before change:  [1.8514439]
curr_Stock_Price:  100.72936015133726
curr_Factors:  [1.00729360e+02 4.76790186e-02]
mat_Sqrt:  [[ 2.19947854e+01  0.00000000e+00]
 [-8.73421031e-03  2.00125899e-02]]
grads:  [-0.02639481 -5.00598607]
Stock Position:  -0.026394811197920667
Bond Position:  [4.51017634]


portfolio before change:  [1.84242274]
curr_Stock_Price:  101.09249835929863
curr_Factors:  [1.01092498e+02 4.69195485e-02]
mat_Sqrt:  [[ 2.18975659e+01  0.00000000e+00]
 [-8.66436828e-03  1.98525617e-02]]
grads:  [-0.00896717 -3.21226565]
Stock Position:  -0.008967167922269781
Bond Position:  [2.74893615]


portfolio before change:  [1.84441426]
curr_Stock_Price:  100.90872998089831
curr_Factors:  [1.00908730e+02 4.78684055e-02]
mat_Sqrt:  [[ 2.20776692e+01  0.00000000e+00]
 [-8.75153980e-03  2.00522968e-02]]
grads:  [-7.99138780e-04 -3.33471584e+00]
Stock Position:  -0.0007991387803410436
Bond Position:  [1.92505434]


portfolio before change:  [1.84616048]
curr_Stock_Price:  99.02473717927634
curr_Factors:  [9.90247372e+01 4.88539694e-02]
mat_Sqrt:  [[ 2.18873724e+01  0.00000000e+00]
 [-8.84117362e-03  2.02576737e-02]]
grads:  [-8.56433195e-04  7.96175610e+00]
Stock Position:  -0.0008564331949447145
Bond Position:  [1.93096855]


portfolio before change:  [1.84778488]
curr_Stock_Price:  97.40988549999071
curr_Factors:  [9.74098855e+01 4.76396849e-02]
mat_Sqrt:  [[ 2.12611853e+01  0.00000000e+00]
 [-8.73060684e-03  2.00043334e-02]]
grads:  [0.00057369 0.32316203]
Stock Position:  0.0005736943403634557
Bond Position:  [1.79190138]


portfolio before change:  [1.84720723]
curr_Stock_Price:  96.01254036694218
curr_Factors:  [9.60125404e+01 4.68762976e-02]
mat_Sqrt:  [[ 2.07876125e+01  0.00000000e+00]
 [-8.66037391e-03  1.98434095e-02]]
grads:  [ 0.00631333 -5.7495195 ]
Stock Position:  0.006313329684381663
Bond Position:  [1.24104841]


portfolio before change:  [1.84584034]
curr_Stock_Price:  95.77145749037392
curr_Factors:  [9.57714575e+01 4.72695894e-02]
mat_Sqrt:  [[ 2.08222191e+01  0.00000000e+00]
 [-8.69662826e-03  1.99264786e-02]]
grads:  [4.45063348e-03 5.56262861e+00]
Stock Position:  0.004450633476873485
Bond Position:  [1.41959668]


portfolio before change:  [1.83614116]
curr_Stock_Price:  93.55230382583379
curr_Factors:  [9.35523038e+01 4.85865061e-02]
mat_Sqrt:  [[ 2.06211234e+01  0.00000000e+00]
 [-8.81693880e-03  2.02021447e-02]]
grads:  [2.72392806e-03 1.34108945e+01]
Stock Position:  0.0027239280565542717
Bond Position:  [1.58131141]


portfolio before change:  [1.83933714]
curr_Stock_Price:  94.65303197671052
curr_Factors:  [9.46530320e+01 4.76800686e-02]
mat_Sqrt:  [[ 2.06682148e+01  0.00000000e+00]
 [-8.73430648e-03  2.00128103e-02]]
grads:  [-0.01906485 -6.2077256 ]
Stock Position:  -0.01906484618422392
Bond Position:  [3.64388263]


portfolio before change:  [1.81069409]
curr_Stock_Price:  96.17932623686791
curr_Factors:  [9.61793262e+01 4.61158699e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.81069409]
Stock Price:  96.49818770639673
PL:  [1.81069409]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48842851e+00  3.65405079e-01]
 [ 1.34675641e+00  4.53919972e-02]
 [-1.18450552e-01  1.46549944e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.04164570e-01  7.02968226e-01]
 [ 8.34494814e-04 -8.29315238e-02]
 [ 8.74188032e-02  9.61329120e-02]
 [ 5.95477183e-01  6.27138276e-01]
 [-1.12185649e-01 -7.13581655e-02]
 [-1.78554182e-03 -2.07848277e-01]
 [-6.25590403e-02 -1.47661913e-02]
 [-6.19563879e-02 -1.41775021e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 2.30636266e-02 -1.98293867e-01]
 [ 2.44232523e-01  1.37444540e-01]
 [ 1.21807172e-01 -6.34871360e-01]
 [ 2.68807627e-02 -1.59847860e-01]
 [ 2.89528467e-02 -1.50171107e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 5.50240659e-03 -8.72776905e-02]
 [ 1.64944446e-01 -3.62472402e-02]
 [ 6.70447491e-01 -1.12269503e-01]
 [ 2.77022815e-02 -2.70936108e-01]
 [ 5.78124833e-02  9.63782508e-03]
 [ 2.52304359e-01 -1.60735269e-01]
 [ 1.02524194e-01 -8.85523814e-02]
 [-1.88458222e-01 -9.61188931e-03]
 [ 4.66874044e-04  2.62206082e-01]
 [-2.66857000e-02  1.87676973e-01]
 [-5.96613528e-01 -8.07019590e-02]
 [-1.68479271e-01 -6.37196807e-02]
 [ 1.97364433e-02 -6.07837924e-02]
 [-2.52689680e-01  1.35155568e-01]
 [ 4.10131243e-02  4.15096192e-02]
 [ 9.43314806e-03  1.44221970e-02]
 [-1.79617369e-01  1.01454528e-01]
 [-3.35469130e-02 -1.23374416e-01]
 [ 1.53213896e-02 -1.97746975e-02]
 [ 3.34783504e-02 -1.14107673e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.09464795]
curr_Stock_Price:  99.16155731981134
curr_Factors:  [9.91615573e+01 3.86483737e-02]
mat_Sqrt:  [[ 1.94943586e+01  0.00000000e+00]
 [-7.86367585e-03  1.80179449e-02]]
grads:  [ 0.08453237 20.28006414]
Stock Position:  0.08453237123857656
Bond Position:  [-11.47700953]


portfolio before change:  [-3.23329075]
curr_Stock_Price:  97.53841479699153
curr_Factors:  [9.75384148e+01 4.06020917e-02]
mat_Sqrt:  [[ 1.96539523e+01  0.00000000e+00]
 [-8.05998429e-03  1.84677441e-02]]
grads:  [0.06953141 2.45790699]
Stock Position:  0.06953141461027514
Bond Position:  [-10.01527471]


portfolio before change:  [-3.27246652]
curr_Stock_Price:  96.99299543015093
curr_Factors:  [9.69929954e+01 4.02457464e-02]
mat_Sqrt:  [[ 1.94580970e+01  0.00000000e+00]
 [-8.02453701e-03  1.83865241e-02]]
grads:  [-2.80042353e-03  7.97050833e+00]
Stock Position:  -0.002800423534591243
Bond Position:  [-3.00084505]


portfolio before change:  [-3.27561393]
curr_Stock_Price:  97.98294762815426
curr_Factors:  [9.79829476e+01 3.98446042e-02]
mat_Sqrt:  [[ 1.95584871e+01  0.00000000e+00]
 [-7.98444530e-03  1.82946625e-02]]
grads:  [-8.33467683e-04 -8.27491693e+00]
Stock Position:  -0.0008334676826818625
Bond Position:  [-3.19394831]


portfolio before change:  [-3.27586934]
curr_Stock_Price:  97.81034207210465
curr_Factors:  [9.78103421e+01 3.94684226e-02]
mat_Sqrt:  [[ 1.94316492e+01  0.00000000e+00]
 [-7.94666446e-03  1.82080957e-02]]
grads:  [1.04281378e-02 3.86074545e+01]
Stock Position:  0.010428137822110505
Bond Position:  [-4.29584907]


portfolio before change:  [-3.27712475]
curr_Stock_Price:  97.7414519873251
curr_Factors:  [9.77414520e+01 3.98740227e-02]
mat_Sqrt:  [[ 1.95174831e+01  0.00000000e+00]
 [-7.98739233e-03  1.83014150e-02]]
grads:  [-1.81169823e-03 -4.53142688e+00]
Stock Position:  -0.0018116982262875254
Bond Position:  [-3.10004674]


portfolio before change:  [-3.27969633]
curr_Stock_Price:  98.94697651121454
curr_Factors:  [9.89469765e+01 3.83369435e-02]
mat_Sqrt:  [[ 1.93736420e+01  0.00000000e+00]
 [-7.83192885e-03  1.79452034e-02]]
grads:  [0.00667787 5.35702549]
Stock Position:  0.006677869119269088
Bond Position:  [-3.94045129]


portfolio before change:  [-3.27874405]
curr_Stock_Price:  99.16334294162509
curr_Factors:  [9.91633429e+01 3.84991360e-02]
mat_Sqrt:  [[ 1.94570346e+01  0.00000000e+00]
 [-7.84847868e-03  1.79831238e-02]]
grads:  [ 0.0446719  34.87371173]
Stock Position:  0.04467190321536396
Bond Position:  [-7.70855931]


portfolio before change:  [-3.19530447]
curr_Stock_Price:  101.05274559460791
curr_Factors:  [1.01052746e+02 3.85816430e-02]
mat_Sqrt:  [[ 1.98489929e+01  0.00000000e+00]
 [-7.85688417e-03  1.80023832e-02]]
grads:  [-0.00722097 -3.96381772]
Stock Position:  -0.007220966123444004
Bond Position:  [-2.46560601]


portfolio before change:  [-3.1992517]
curr_Stock_Price:  101.55669599708229
curr_Factors:  [1.01556696e+02 3.77321093e-02]
mat_Sqrt:  [[ 1.97271390e+01  0.00000000e+00]
 [-7.76990186e-03  1.78030817e-02]]
grads:  [-4.68886881e-03 -1.16748483e+01]
Stock Position:  -0.004688868813152957
Bond Position:  [-2.72306567]


portfolio before change:  [-3.20017151]
curr_Stock_Price:  101.68026672140603
curr_Factors:  [1.01680267e+02 3.74960976e-02]
mat_Sqrt:  [[ 1.96892744e+01  0.00000000e+00]
 [-7.74556364e-03  1.77473158e-02]]
grads:  [-0.00350463 -0.83202392]
Stock Position:  -0.0035046255648367576
Bond Position:  [-2.84382024]


portfolio before change:  [-3.2044919]
curr_Stock_Price:  102.81159927955531
curr_Factors:  [1.02811599e+02 3.67995986e-02]
mat_Sqrt:  [[ 1.97225768e+01  0.00000000e+00]
 [-7.67328859e-03  1.75817129e-02]]
grads:  [-6.2786968e-03 -8.0637775e+00]
Stock Position:  -0.006278696799402683
Bond Position:  [-2.55896904]


portfolio before change:  [-3.20780105]
curr_Stock_Price:  103.28769349726046
curr_Factors:  [1.03287693e+02 3.76910825e-02]
mat_Sqrt:  [[ 2.00524704e+01  0.00000000e+00]
 [-7.76567653e-03  1.77934003e-02]]
grads:  [-0.00326691 -1.00542913]
Stock Position:  -0.00326690525593337
Bond Position:  [-2.87036994]


portfolio before change:  [-3.21106471]
curr_Stock_Price:  104.17686783573774
curr_Factors:  [1.04176868e+02 3.73384384e-02]
mat_Sqrt:  [[ 2.01302594e+01  0.00000000e+00]
 [-7.72926267e-03  1.77099656e-02]]
grads:  [-3.15340755e-03 -1.11967392e+01]
Stock Position:  -0.003153407552446004
Bond Position:  [-2.88255259]


portfolio before change:  [-3.20584374]
curr_Stock_Price:  102.40693630588959
curr_Factors:  [1.02406936e+02 3.65807372e-02]
mat_Sqrt:  [[ 1.95864442e+01  0.00000000e+00]
 [-7.65043656e-03  1.75293523e-02]]
grads:  [0.01553208 7.84082248]
Stock Position:  0.01553208098652972
Bond Position:  [-4.79643657]


portfolio before change:  [-3.19795344]
curr_Stock_Price:  102.9535400877808
curr_Factors:  [1.02953540e+02 3.71353437e-02]
mat_Sqrt:  [[ 1.98396958e+01  0.00000000e+00]
 [-7.70821314e-03  1.76617351e-02]]
grads:  [-7.82640052e-03 -3.59461489e+01]
Stock Position:  -0.007826400524838559
Bond Position:  [-2.3921978]


portfolio before change:  [-3.19754147]
curr_Stock_Price:  102.86269233088315
curr_Factors:  [1.02862692e+02 3.81180088e-02]
mat_Sqrt:  [[ 2.00827411e+01  0.00000000e+00]
 [-7.80953354e-03  1.78938893e-02]]
grads:  [-2.13529432e-03 -8.93309765e+00]
Stock Position:  -0.0021352943173563827
Bond Position:  [-2.97789935]


portfolio before change:  [-3.19499433]
curr_Stock_Price:  101.49547855788776
curr_Factors:  [1.01495479e+02 3.79892799e-02]
mat_Sqrt:  [[ 1.97823202e+01  0.00000000e+00]
 [-7.79633554e-03  1.78636489e-02]]
grads:  [-1.84948971e-03 -8.40651920e+00]
Stock Position:  -0.0018494897138361989
Bond Position:  [-3.00727948]


portfolio before change:  [-3.19301657]
curr_Stock_Price:  100.22286495924737
curr_Factors:  [1.00222865e+02 3.76990562e-02]
mat_Sqrt:  [[ 1.94595168e+01  0.00000000e+00]
 [-7.76649792e-03  1.77952823e-02]]
grads:  [-1.63813494e-02 -2.63714639e+01]
Stock Position:  -0.0163813494339813
Bond Position:  [-1.5512308]


portfolio before change:  [-3.21902859]
curr_Stock_Price:  101.79893139405156
curr_Factors:  [1.01798931e+02 3.71950755e-02]
mat_Sqrt:  [[ 1.96329672e+01  0.00000000e+00]
 [-7.71440994e-03  1.76759338e-02]]
grads:  [-1.65989685e-03 -4.93765657e+00]
Stock Position:  -0.0016598968471057424
Bond Position:  [-3.05005286]


portfolio before change:  [-3.21960934]
curr_Stock_Price:  101.91910434993731
curr_Factors:  [1.01919104e+02 3.68432666e-02]
mat_Sqrt:  [[ 1.95629643e+01  0.00000000e+00]
 [-7.67783997e-03  1.75921414e-02]]
grads:  [ 0.00762281 -2.06042229]
Stock Position:  0.0076228147884488395
Bond Position:  [-3.9965198]


portfolio before change:  [-3.22729199]
curr_Stock_Price:  100.97679433937138
curr_Factors:  [1.00976794e+02 3.66484114e-02]
mat_Sqrt:  [[ 1.93307701e+01  0.00000000e+00]
 [-7.65750992e-03  1.75455594e-02]]
grads:  [ 0.03214818 -6.39874173]
Stock Position:  0.03214817925163466
Bond Position:  [-6.47351208]


portfolio before change:  [-3.23887915]
curr_Stock_Price:  100.64153668537206
curr_Factors:  [1.00641537e+02 3.62298619e-02]
mat_Sqrt:  [[ 1.91562545e+01  0.00000000e+00]
 [-7.61365740e-03  1.74450807e-02]]
grads:  [-4.72659883e-03 -1.55308028e+01]
Stock Position:  -0.004726598825294381
Bond Position:  [-2.76318698]


portfolio before change:  [-3.24593448]
curr_Stock_Price:  102.06114203410411
curr_Factors:  [1.02061142e+02 3.48002944e-02]
mat_Sqrt:  [[ 1.90393397e+01  0.00000000e+00]
 [-7.46193480e-03  1.70974405e-02]]
grads:  [0.0032574  0.56369987]
Stock Position:  0.003257401570662216
Bond Position:  [-3.5783886]


portfolio before change:  [-3.2489341]
curr_Stock_Price:  101.27760590140049
curr_Factors:  [1.01277606e+02 3.48113129e-02]
mat_Sqrt:  [[ 1.88961631e+01  0.00000000e+00]
 [-7.46311601e-03  1.71001470e-02]]
grads:  [ 0.00963972 -9.39964251]
Stock Position:  0.009639720839598956
Bond Position:  [-4.22522195]


portfolio before change:  [-3.24611185]
curr_Stock_Price:  101.62517099830136
curr_Factors:  [1.01625171e+02 3.39814618e-02]
mat_Sqrt:  [[ 1.87336464e+01  0.00000000e+00]
 [-7.37362454e-03  1.68950963e-02]]
grads:  [ 3.40973483e-03 -5.24130670e+00]
Stock Position:  0.0034097348315446727
Bond Position:  [-3.59262674]


portfolio before change:  [-3.24577427]
curr_Stock_Price:  101.85588818415353
curr_Factors:  [1.01855888e+02 3.26718222e-02]
mat_Sqrt:  [[ 1.84108067e+01  0.00000000e+00]
 [-7.23013938e-03  1.65663305e-02]]
grads:  [-0.01046414 -0.5802063 ]
Stock Position:  -0.010464136519264257
Bond Position:  [-2.17994036]


portfolio before change:  [-3.2506607]
curr_Stock_Price:  102.29681496736237
curr_Factors:  [1.02296815e+02 3.40171815e-02]
mat_Sqrt:  [[ 1.88673661e+01  0.00000000e+00]
 [-7.37749893e-03  1.69039736e-02]]
grads:  [6.09003873e-03 1.55115056e+01]
Stock Position:  0.006090038734149812
Bond Position:  [-3.87365227]


portfolio before change:  [-3.25474044]
curr_Stock_Price:  101.70642494691563
curr_Factors:  [1.01706425e+02 3.44790919e-02]
mat_Sqrt:  [[ 1.88854048e+01  0.00000000e+00]
 [-7.42741860e-03  1.70183540e-02]]
grads:  [2.92412298e-03 1.10279157e+01]
Stock Position:  0.0029241229830693515
Bond Position:  [-3.55214253]


portfolio before change:  [-3.25512393]
curr_Stock_Price:  101.7271335926243
curr_Factors:  [1.01727134e+02 3.41195720e-02]
mat_Sqrt:  [[ 1.87905112e+01  0.00000000e+00]
 [-7.38859358e-03  1.69293947e-02]]
grads:  [-0.0336252 -4.7669725]
Stock Position:  -0.03362520292610589
Bond Position:  [0.16547158]


portfolio before change:  [-3.23092273]
curr_Stock_Price:  101.00801494450859
curr_Factors:  [1.01008015e+02 3.41434966e-02]
mat_Sqrt:  [[ 1.86642195e+01  0.00000000e+00]
 [-7.39118357e-03  1.69353291e-02]]
grads:  [-0.01051685 -3.76252982]
Stock Position:  -0.010516851208771777
Bond Position:  [-2.16863647]


portfolio before change:  [-3.23858128]
curr_Stock_Price:  101.71045454002855
curr_Factors:  [1.01710455e+02 3.26334058e-02]
mat_Sqrt:  [[ 1.83737074e+01  0.00000000e+00]
 [-7.22588743e-03  1.65565881e-02]]
grads:  [-3.69646609e-04 -3.67127527e+00]
Stock Position:  -0.000369646608646294
Bond Position:  [-3.20098436]


portfolio before change:  [-3.23860724]
curr_Stock_Price:  100.69815597573043
curr_Factors:  [1.00698156e+02 3.35231072e-02]
mat_Sqrt:  [[ 1.84371441e+01  0.00000000e+00]
 [-7.32372661e-03  1.67807658e-02]]
grads:  [-0.01050613  8.05419549]
Stock Position:  -0.010506125715938919
Bond Position:  [-2.18065975]


portfolio before change:  [-3.23258997]
curr_Stock_Price:  100.0994701946152
curr_Factors:  [1.0009947e+02 3.3441673e-02]
mat_Sqrt:  [[ 1.83052547e+01  0.00000000e+00]
 [-7.31482582e-03  1.67603715e-02]]
grads:  [0.00323019 2.47665269]
Stock Position:  0.003230187626751661
Bond Position:  [-3.55593004]


portfolio before change:  [-3.2381651]
curr_Stock_Price:  98.51113737078867
curr_Factors:  [9.85111374e+01 3.49452226e-02]
mat_Sqrt:  [[ 1.84153187e+01  0.00000000e+00]
 [-7.47745653e-03  1.71330053e-02]]
grads:  [0.00085405 0.84177859]
Stock Position:  0.0008540450020645604
Bond Position:  [-3.32229804]


portfolio before change:  [-3.23746616]
curr_Stock_Price:  99.8158151688559
curr_Factors:  [9.98158152e+01 3.49087928e-02]
mat_Sqrt:  [[ 1.86494820e+01  0.00000000e+00]
 [-7.47355795e-03  1.71240725e-02]]
grads:  [-0.00725698  5.9246729 ]
Stock Position:  -0.0072569834900257455
Bond Position:  [-2.51310444]


portfolio before change:  [-3.23193679]
curr_Stock_Price:  99.01058734774722
curr_Factors:  [9.90105873e+01 3.42520921e-02]
mat_Sqrt:  [[ 1.83242070e+01  0.00000000e+00]
 [-7.40292830e-03  1.69622396e-02]]
grads:  [-4.76920626e-03 -7.27347442e+00]
Stock Position:  -0.0047692062613844816
Bond Position:  [-2.75973488]


portfolio before change:  [-3.23777788]
curr_Stock_Price:  100.16300070026838
curr_Factors:  [1.00163001e+02 3.43594228e-02]
mat_Sqrt:  [[ 1.85665092e+01  0.00000000e+00]
 [-7.41451795e-03  1.69887949e-02]]
grads:  [ 3.60380296e-04 -1.16398471e+00]
Stock Position:  0.000360380295786589
Bond Position:  [-3.27387465]


portfolio before change:  [-3.2383942]
curr_Stock_Price:  99.58843103149856
curr_Factors:  [9.95884310e+01 3.50133248e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.2383942]
Stock Price:  99.13037812060185
PL:  [-3.2383942]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.34688514e+00  3.33404960e-01]
 [ 4.16184380e-01  1.20384497e-01]
 [ 1.12462632e-01 -4.56505266e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.02811034e-01  6.66903965e-01]
 [-1.10178153e-03 -8.57327229e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.25877507e+00  1.29707364e+00]
 [ 1.20584444e-01  6.54568120e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-8.68844747e-02  9.79864965e-03]
 [ 2.59552790e-02 -1.33851948e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.26286010e-02 -3.81185744e-02]
 [ 4.46410822e-01  2.83581488e-01]
 [ 1.31669030e-01 -2.10393403e-01]
 [ 3.94927448e-02  8.35977704e-02]
 [ 1.10751012e-03 -5.65458780e-02]
 [-9.46510563e-02 -3.45740815e-01]
 [-5.81275328e-02 -5.00261584e-02]
 [ 1.80790915e-01 -4.61813798e-02]
 [ 6.48427054e-01 -1.29194256e-01]
 [ 3.01846294e-02 -4.11488912e-01]
 [ 5.80778201e-02  7.50089574e-03]
 [ 2.53948398e-01 -1.62093603e-01]
 [-2.71931734e-02 -4.08276566e-02]
 [-1.64151351e-01  7.21380588e-02]
 [-4.10163284e-02  9.90587422e-02]
 [-4.39678338e-02  1.96058590e-01]
 [-6.57173252e-01 -5.72600966e-02]
 [-1.68287177e-01 -6.18115359e-02]
 [ 6.23013658e-02 -2.25655203e-02]
 [-2.30265867e-01  1.38738244e-01]
 [ 5.39801915e-02  5.37004171e-02]
 [-4.93715788e-02  7.52935603e-02]
 [-1.33732406e-01  1.13545947e-01]
 [-2.83001108e-02 -1.69998882e-01]
 [ 2.26410231e-02 -1.75906897e-02]
 [-3.93324928e-02 -9.42287713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.09962539]
curr_Stock_Price:  99.91553188555365
curr_Factors:  [9.99155319e+01 4.04615137e-02]
mat_Sqrt:  [[ 2.00980567e+01  0.00000000e+00]
 [-8.04601901e-03  1.84357456e-02]]
grads:  [ 0.07425569 18.08470174]
Stock Position:  0.07425568639168544
Bond Position:  [-5.31967101]


portfolio before change:  [2.10477223]
curr_Stock_Price:  99.99379979306829
curr_Factors:  [9.99937998e+01 4.10345644e-02]
mat_Sqrt:  [[ 2.0255734e+01  0.0000000e+00]
 [-8.1027960e-03  1.8565838e-02]]
grads:  [0.02314034 6.48419407]
Stock Position:  0.023140335532563557
Bond Position:  [-0.20911785]


portfolio before change:  [2.09376768]
curr_Stock_Price:  99.51937271051195
curr_Factors:  [9.95193727e+01 4.22136734e-02]
mat_Sqrt:  [[ 2.04472169e+01  0.00000000e+00]
 [-8.21838655e-03  1.88306892e-02]]
grads:  [ 0.00452576 -2.42426212]
Stock Position:  0.004525755722326681
Bond Position:  [1.64336731]


portfolio before change:  [2.08963805]
curr_Stock_Price:  98.56150701280606
curr_Factors:  [9.85615070e+01 4.23765567e-02]
mat_Sqrt:  [[ 2.02894450e+01  0.00000000e+00]
 [-8.23422678e-03  1.88669838e-02]]
grads:  [-8.03440752e-04 -8.02390113e+00]
Stock Position:  -0.0008034407515078081
Bond Position:  [2.16882638]


portfolio before change:  [2.09044242]
curr_Stock_Price:  97.89780165838454
curr_Factors:  [9.78978017e+01 4.26794120e-02]
mat_Sqrt:  [[ 2.02247030e+01  0.00000000e+00]
 [-8.26359844e-03  1.89342827e-02]]
grads:  [9.30791012e-03 3.52220349e+01]
Stock Position:  0.009307910124418322
Bond Position:  [1.17921848]


portfolio before change:  [2.08957998]
curr_Stock_Price:  97.78930759702148
curr_Factors:  [9.77893076e+01 4.21380153e-02]
mat_Sqrt:  [[ 2.00737453e+01  0.00000000e+00]
 [-8.21101848e-03  1.88138069e-02]]
grads:  [-1.91885514e-03 -4.55690459e+00]
Stock Position:  -0.001918855140786794
Bond Position:  [2.27722349]


portfolio before change:  [2.09383467]
curr_Stock_Price:  95.72035192981463
curr_Factors:  [9.57203519e+01 4.19484340e-02]
mat_Sqrt:  [[ 1.96047886e+01  0.00000000e+00]
 [-8.19252675e-03  1.87714370e-02]]
grads:  [0.00659909 5.12144527]
Stock Position:  0.006599090661061402
Bond Position:  [1.46216739]


portfolio before change:  [2.08868092]
curr_Stock_Price:  94.91167468047725
curr_Factors:  [9.49116747e+01 4.27082825e-02]
mat_Sqrt:  [[ 1.96144299e+01  0.00000000e+00]
 [-8.26639293e-03  1.89406857e-02]]
grads:  [ 0.09303683 68.48081789]
Stock Position:  0.09303683213192786
Bond Position:  [-6.74160062]


portfolio before change:  [2.04395773]
curr_Stock_Price:  94.44002880913791
curr_Factors:  [9.44400288e+01 4.10114059e-02]
mat_Sqrt:  [[ 1.91253081e+01  0.00000000e+00]
 [-8.10050921e-03  1.85605983e-02]]
grads:  [2.12420836e-02 3.52665420e+01]
Stock Position:  0.021242083576730016
Bond Position:  [0.03785475]


portfolio before change:  [2.09792222]
curr_Stock_Price:  96.9802576370679
curr_Factors:  [9.69802576e+01 3.93333339e-02]
mat_Sqrt:  [[ 1.92337388e+01  0.00000000e+00]
 [-7.93305327e-03  1.81769086e-02]]
grads:  [0.0128126  6.22088916]
Stock Position:  0.012812599252623454
Bond Position:  [0.85535304]


portfolio before change:  [2.11491945]
curr_Stock_Price:  98.29851541246157
curr_Factors:  [9.82985154e+01 3.93613458e-02]
mat_Sqrt:  [[ 1.95021247e+01  0.00000000e+00]
 [-7.93587760e-03  1.81833799e-02]]
grads:  [-0.00423585  0.53887944]
Stock Position:  -0.004235845826262638
Bond Position:  [2.53129681]


portfolio before change:  [2.11355434]
curr_Stock_Price:  98.69549561747348
curr_Factors:  [9.86954956e+01 3.86217290e-02]
mat_Sqrt:  [[ 1.93960452e+01  0.00000000e+00]
 [-7.86096473e-03  1.80117329e-02]]
grads:  [-1.67366595e-03 -7.43137533e+00]
Stock Position:  -0.0016736659452680964
Bond Position:  [2.27873763]


portfolio before change:  [2.11178583]
curr_Stock_Price:  99.92236420936385
curr_Factors:  [9.99223642e+01 3.89826013e-02]
mat_Sqrt:  [[ 1.97286836e+01  0.00000000e+00]
 [-7.89760483e-03  1.80956860e-02]]
grads:  [-0.00655639 -1.55017086]
Stock Position:  -0.0065563871607256016
Bond Position:  [2.76691553]


portfolio before change:  [2.10887861]
curr_Stock_Price:  100.4185370080263
curr_Factors:  [1.00418537e+02 3.93560727e-02]
mat_Sqrt:  [[ 1.99213959e+01  0.00000000e+00]
 [-7.93534601e-03  1.81821619e-02]]
grads:  [-0.00297494 -2.09648196]
Stock Position:  -0.0029749376499687594
Bond Position:  [2.4076175]


portfolio before change:  [2.11051936]
curr_Stock_Price:  99.96818135336719
curr_Factors:  [9.99681814e+01 3.80643074e-02]
mat_Sqrt:  [[ 1.95038684e+01  0.00000000e+00]
 [-7.80403049e-03  1.78812802e-02]]
grads:  [ 0.02923399 15.85912665]
Stock Position:  0.029233991908507923
Bond Position:  [-0.81194964]


portfolio before change:  [2.10693656]
curr_Stock_Price:  99.84909735875884
curr_Factors:  [9.98490974e+01 3.79902844e-02]
mat_Sqrt:  [[ 1.94616839e+01  0.00000000e+00]
 [-7.79643861e-03  1.78638850e-02]]
grads:  [ 2.04739841e-03 -1.17775838e+01]
Stock Position:  0.0020473984139322996
Bond Position:  [1.90250568]


portfolio before change:  [2.10747203]
curr_Stock_Price:  99.99446917289802
curr_Factors:  [9.99944692e+01 3.88025447e-02]
mat_Sqrt:  [[ 1.96972721e+01  0.00000000e+00]
 [-7.87934462e-03  1.80538466e-02]]
grads:  [3.85727540e-03 4.63046864e+00]
Stock Position:  0.003857275399622399
Bond Position:  [1.72176582]


portfolio before change:  [2.10660968]
curr_Stock_Price:  99.71510611928133
curr_Factors:  [9.97151061e+01 3.82310203e-02]
mat_Sqrt:  [[ 1.94970498e+01  0.00000000e+00]
 [-7.82110174e-03  1.79203954e-02]]
grads:  [-1.20895903e-03 -3.15539232e+00]
Stock Position:  -0.0012089590261597318
Bond Position:  [2.22716116]


portfolio before change:  [2.10682881]
curr_Stock_Price:  99.76414426899923
curr_Factors:  [9.97641443e+01 3.73104548e-02]
mat_Sqrt:  [[ 1.92703567e+01  0.00000000e+00]
 [-7.72636575e-03  1.77033280e-02]]
grads:  [-1.27420952e-02 -1.95297074e+01]
Stock Position:  -0.01274209515403192
Bond Position:  [3.37803303]


portfolio before change:  [2.10041571]
curr_Stock_Price:  100.30058493781965
curr_Factors:  [1.00300585e+02 3.71597697e-02]
mat_Sqrt:  [[ 1.93348128e+01  0.00000000e+00]
 [-7.71074779e-03  1.76675427e-02]]
grads:  [-0.00413558 -2.83152894]
Stock Position:  -0.004135583777833966
Bond Position:  [2.51521718]


portfolio before change:  [2.1024015]
curr_Stock_Price:  99.89644059702162
curr_Factors:  [9.98964406e+01 3.87221307e-02]
mat_Sqrt:  [[ 1.96575612e+01  0.00000000e+00]
 [-7.87117584e-03  1.80351296e-02]]
grads:  [ 0.0081717  -2.56063477]
Stock Position:  0.008171700788343245
Bond Position:  [1.28607768]


portfolio before change:  [2.11293125]
curr_Stock_Price:  101.1653292309342
curr_Factors:  [1.01165329e+02 3.68145749e-02]
mat_Sqrt:  [[ 1.94107177e+01  0.00000000e+00]
 [-7.67484983e-03  1.75852901e-02]]
grads:  [ 0.03050078 -7.346723  ]
Stock Position:  0.03050078138474992
Bond Position:  [-0.97269034]


portfolio before change:  [2.151666]
curr_Stock_Price:  102.43927513454597
curr_Factors:  [1.02439275e+02 3.54322724e-02]
mat_Sqrt:  [[ 1.92826181e+01  0.00000000e+00]
 [-7.52938482e-03  1.72519879e-02]]
grads:  [-7.74811047e-03 -2.38516810e+01]
Stock Position:  -0.007748110472047346
Bond Position:  [2.94537682]


portfolio before change:  [2.15691954]
curr_Stock_Price:  101.8087550420684
curr_Factors:  [1.01808755e+02 3.50112276e-02]
mat_Sqrt:  [[ 1.90497287e+01  0.00000000e+00]
 [-7.48451495e-03  1.71491782e-02]]
grads:  [0.0032206  0.43739097]
Stock Position:  0.003220595960731104
Bond Position:  [1.82903467]


portfolio before change:  [2.15549879]
curr_Stock_Price:  101.2966167337476
curr_Factors:  [1.01296617e+02 3.61361308e-02]
mat_Sqrt:  [[ 1.92559862e+01  0.00000000e+00]
 [-7.60380229e-03  1.74224998e-02]]
grads:  [ 0.00951418 -9.30369378]
Stock Position:  0.009514181654189133
Bond Position:  [1.19174438]


portfolio before change:  [2.16689793]
curr_Stock_Price:  102.47907852734693
curr_Factors:  [1.02479079e+02 3.52649110e-02]
mat_Sqrt:  [[ 1.92444989e+01  0.00000000e+00]
 [-7.51158157e-03  1.72111956e-02]]
grads:  [-2.33894495e-03 -2.37215692e+00]
Stock Position:  -0.0023389449486412293
Bond Position:  [2.40659085]


portfolio before change:  [2.16673024]
curr_Stock_Price:  102.67939296520646
curr_Factors:  [1.02679393e+02 3.48252124e-02]
mat_Sqrt:  [[ 1.91615298e+01  0.00000000e+00]
 [-7.46460581e-03  1.71035606e-02]]
grads:  [-0.00692365  4.21772171]
Stock Position:  -0.00692364974755964
Bond Position:  [2.8776464]


portfolio before change:  [2.15906531]
curr_Stock_Price:  103.83841508155733
curr_Factors:  [1.03838415e+02 3.41348127e-02]
mat_Sqrt:  [[ 1.91847795e+01  0.00000000e+00]
 [-7.39024359e-03  1.69331753e-02]]
grads:  [1.15531748e-04 5.84998031e+00]
Stock Position:  0.00011553174837822774
Bond Position:  [2.14706867]


portfolio before change:  [2.15923018]
curr_Stock_Price:  102.94230157084587
curr_Factors:  [1.02942302e+02 3.52115172e-02]
mat_Sqrt:  [[ 1.93168471e+01  0.00000000e+00]
 [-7.50589285e-03  1.71981611e-02]]
grads:  [2.15351655e-03 1.13999741e+01]
Stock Position:  0.002153516548121626
Bond Position:  [1.93754223]


portfolio before change:  [2.1597506]
curr_Stock_Price:  103.07148944983194
curr_Factors:  [1.03071489e+02 3.43099662e-02]
mat_Sqrt:  [[ 1.90918801e+01  0.00000000e+00]
 [-7.40917985e-03  1.69765637e-02]]
grads:  [-0.03573056 -3.37289085]
Stock Position:  -0.03573056211974945
Bond Position:  [5.84255285]


portfolio before change:  [2.20625135]
curr_Stock_Price:  101.79050241844607
curr_Factors:  [1.01790502e+02 3.56933279e-02]
mat_Sqrt:  [[ 1.92309518e+01  0.00000000e+00]
 [-7.55707116e-03  1.73154253e-02]]
grads:  [-0.01015363 -3.56973824]
Stock Position:  -0.01015362866366107
Bond Position:  [3.23979431]


portfolio before change:  [2.1925326]
curr_Stock_Price:  103.18150716009161
curr_Factors:  [1.03181507e+02 3.65302035e-02]
mat_Sqrt:  [[ 1.97209537e+01  0.00000000e+00]
 [-7.64515046e-03  1.75172403e-02]]
grads:  [ 0.00265976 -1.28818923]
Stock Position:  0.0026597580524654304
Bond Position:  [1.91809476]


portfolio before change:  [2.18554819]
curr_Stock_Price:  100.4654003717175
curr_Factors:  [1.00465400e+02 3.67628969e-02]
mat_Sqrt:  [[ 1.92628872e+01  0.00000000e+00]
 [-7.66946119e-03  1.75729432e-02]]
grads:  [-0.00881049  7.89499188]
Stock Position:  -0.00881049302398723
Bond Position:  [3.0706979]


portfolio before change:  [2.18648175]
curr_Stock_Price:  100.403008832741
curr_Factors:  [1.00403009e+02 3.79366965e-02]
mat_Sqrt:  [[ 1.95558403e+01  0.00000000e+00]
 [-7.79093797e-03  1.78512815e-02]]
grads:  [0.00395876 3.00821076]
Stock Position:  0.003958764932045248
Bond Position:  [1.78900984]


portfolio before change:  [2.18357999]
curr_Stock_Price:  99.6135190738806
curr_Factors:  [9.96135191e+01 3.88408730e-02]
mat_Sqrt:  [[ 1.96319199e+01  0.00000000e+00]
 [-7.88323517e-03  1.80627610e-02]]
grads:  [-8.41016830e-04  4.16844138e+00]
Stock Position:  -0.0008410168303783074
Bond Position:  [2.26735663]


portfolio before change:  [2.18456314]
curr_Stock_Price:  98.78153830393053
curr_Factors:  [9.87815383e+01 3.88165913e-02]
mat_Sqrt:  [[ 1.94618662e+01  0.00000000e+00]
 [-7.88077065e-03  1.80571140e-02]]
grads:  [-4.32522202e-03  6.28815587e+00]
Stock Position:  -0.00432522202048681
Bond Position:  [2.61181522]


portfolio before change:  [2.1803624]
curr_Stock_Price:  99.82824402205982
curr_Factors:  [9.98282440e+01 3.80411731e-02]
mat_Sqrt:  [[ 1.94706470e+01  0.00000000e+00]
 [-7.80165860e-03  1.78758455e-02]]
grads:  [-5.26401130e-03 -9.50997714e+00]
Stock Position:  -0.005264011303271229
Bond Position:  [2.7058594]


portfolio before change:  [2.17842401]
curr_Stock_Price:  100.26073614346974
curr_Factors:  [1.00260736e+02 3.88279104e-02]
mat_Sqrt:  [[ 1.97561765e+01  0.00000000e+00]
 [-7.88191960e-03  1.80597466e-02]]
grads:  [ 7.57424731e-04 -9.74027491e-01]
Stock Position:  0.000757424731243388
Bond Position:  [2.10248405]


portfolio before change:  [2.17907932]
curr_Stock_Price:  100.7789220465312
curr_Factors:  [1.00778922e+02 3.79676010e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.17907932]
Stock Price:  101.19232313689126
PL:  [0.98675619]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.19905990e+00  2.99984635e-01]
 [-6.65730540e-02 -5.32858218e-04]
 [ 3.75999568e-02 -4.70420263e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.03540532e-02  4.43753112e-01]
 [-1.10416123e-02 -1.07846001e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 9.27930384e-01  9.31297238e-01]
 [ 6.18187756e-02  4.97479207e-01]
 [ 3.32837586e-04 -2.36197581e-01]
 [ 1.08676853e-01  1.40694057e-02]
 [ 5.16858208e-02 -8.32262609e-02]
 [-2.46383247e-02  3.33470575e-01]
 [-1.43799461e-01  5.05392226e-01]
 [ 1.26594755e-01  1.52081490e-01]
 [ 1.32836811e-01 -5.76064678e-02]
 [ 4.06100415e-02  1.24961409e-01]
 [ 1.17653016e-01  8.36188137e-02]
 [ 8.45895047e-02  9.16871030e-02]
 [-6.61926052e-01  3.08545140e-01]
 [ 1.63331861e-02  1.60570593e-01]
 [ 1.79726900e+00  2.66961265e-01]
 [ 1.48599951e-02  4.25051370e-01]
 [-1.54351858e-01  1.95435600e-01]
 [-1.76494031e-01  9.28606236e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 2.90788870e-01 -4.33844813e-01]
 [ 1.03116742e-01 -1.72666759e-02]
 [ 5.11946821e-01 -3.01987707e-01]
 [-5.18396642e-01 -2.45709979e-01]
 [ 8.15110623e-02  3.32772735e-02]
 [-1.45485625e-01  2.02957866e-01]
 [ 4.92692968e-01  2.29697112e-01]
 [ 5.88917932e-02 -1.05822584e-01]
 [ 2.82582141e-01 -3.08472127e-01]
 [ 1.11022371e-01  4.95518115e-02]
 [-6.86504962e-02  3.76590492e-01]
 [-3.73078218e-01 -1.40177207e-01]
 [ 1.05351076e-01  3.29123309e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.5272872]
curr_Stock_Price:  100.55822898203135
curr_Factors:  [1.00558229e+02 4.03436090e-02]
mat_Sqrt:  [[ 2.01978429e+01  0.00000000e+00]
 [-8.03428743e-03  1.84088651e-02]]
grads:  [ 0.06584782 16.29566152]
Stock Position:  0.06584782051187067
Bond Position:  [-0.09425301]


portfolio before change:  [6.5594323]
curr_Stock_Price:  101.04658047481266
curr_Factors:  [1.01046580e+02 3.92914602e-02]
mat_Sqrt:  [[ 2.00295276e+01  0.00000000e+00]
 [-7.92882944e-03  1.81672305e-02]]
grads:  [-0.00333536 -0.02933073]
Stock Position:  -0.003335356372083782
Bond Position:  [6.89645866]


portfolio before change:  [6.5609765]
curr_Stock_Price:  100.84207973429957
curr_Factors:  [1.00842080e+02 3.83611856e-02]
mat_Sqrt:  [[ 1.97509416e+01  0.00000000e+00]
 [-7.83440469e-03  1.79508763e-02]]
grads:  [ 8.64218715e-04 -2.62059777e+00]
Stock Position:  0.0008642187146577537
Bond Position:  [6.47382689]


portfolio before change:  [6.56100166]
curr_Stock_Price:  99.93477140120183
curr_Factors:  [9.99347714e+01 3.93010287e-02]
mat_Sqrt:  [[ 1.98115558e+01  0.00000000e+00]
 [-7.92979483e-03  1.81694425e-02]]
grads:  [-8.22821140e-04 -8.33194592e+00]
Stock Position:  -0.0008228211403050518
Bond Position:  [6.64323011]


portfolio before change:  [6.56315886]
curr_Stock_Price:  98.32234041256142
curr_Factors:  [9.83223404e+01 4.04184652e-02]
mat_Sqrt:  [[ 1.97670616e+01  0.00000000e+00]
 [-8.04173764e-03  1.84259357e-02]]
grads:  [5.22665860e-03 2.40830707e+01]
Stock Position:  0.005226658598420762
Bond Position:  [6.04926156]


portfolio before change:  [6.56325716]
curr_Stock_Price:  98.19646549201309
curr_Factors:  [9.81964655e+01 4.04667624e-02]
mat_Sqrt:  [[ 1.97535468e+01  0.00000000e+00]
 [-8.04654086e-03  1.84369413e-02]]
grads:  [-2.94172316e-03 -5.84945191e+00]
Stock Position:  -0.0029417231595370544
Bond Position:  [6.85212398]


portfolio before change:  [6.56764172]
curr_Stock_Price:  96.99717370324596
curr_Factors:  [9.69971737e+01 4.21725057e-02]
mat_Sqrt:  [[ 1.99192867e+01  0.00000000e+00]
 [-8.21437820e-03  1.88215049e-02]]
grads:  [0.0064949  5.10782147]
Stock Position:  0.006494900095415947
Bond Position:  [5.93765476]


portfolio before change:  [6.57011729]
curr_Stock_Price:  97.26404837023182
curr_Factors:  [9.72640484e+01 4.22238934e-02]
mat_Sqrt:  [[ 1.99862576e+01  0.00000000e+00]
 [-8.21938133e-03  1.88329686e-02]]
grads:  [ 0.06676497 49.45036865]
Stock Position:  0.06676496664667622
Bond Position:  [0.07628635]


portfolio before change:  [6.49465915]
curr_Stock_Price:  96.1336999212032
curr_Factors:  [9.61336999e+01 4.32740713e-02]
mat_Sqrt:  [[ 1.99981368e+01  0.00000000e+00]
 [-8.32096834e-03  1.90657336e-02]]
grads:  [1.39481245e-02 2.60928437e+01]
Stock Position:  0.013948124471020885
Bond Position:  [5.15377434]


portfolio before change:  [6.46768306]
curr_Stock_Price:  94.15347978857886
curr_Factors:  [9.41534798e+01 4.47212989e-02]
mat_Sqrt:  [[ 1.99110233e+01  0.00000000e+00]
 [-8.45896437e-03  1.93819223e-02]]
grads:  [-5.16057043e-03 -1.21864889e+01]
Stock Position:  -0.0051605704250209565
Bond Position:  [6.95356872]


portfolio before change:  [6.47397079]
curr_Stock_Price:  93.10350278961235
curr_Factors:  [9.31035028e+01 4.74240723e-02]
mat_Sqrt:  [[ 2.02752138e+01  0.00000000e+00]
 [-8.71082749e-03  1.99590132e-02]]
grads:  [0.00566294 0.7049149 ]
Stock Position:  0.005662936362415335
Bond Position:  [5.94673158]


portfolio before change:  [6.48095512]
curr_Stock_Price:  94.20557048865048
curr_Factors:  [9.42055705e+01 4.62648997e-02]
mat_Sqrt:  [[ 2.02629371e+01  0.00000000e+00]
 [-8.60371080e-03  1.97135780e-02]]
grads:  [ 7.58177483e-04 -4.22177349e+00]
Stock Position:  0.0007581774832239913
Bond Position:  [6.40953057]


portfolio before change:  [6.48098648]
curr_Stock_Price:  93.19013981822144
curr_Factors:  [9.31901398e+01 4.75669469e-02]
mat_Sqrt:  [[ 2.03246278e+01  0.00000000e+00]
 [-8.72393920e-03  1.99890559e-02]]
grads:  [5.94845658e-03 1.66826576e+01]
Stock Position:  0.005948456575421755
Bond Position:  [5.92664898]


portfolio before change:  [6.48320896]
curr_Stock_Price:  93.43921396697418
curr_Factors:  [9.34392140e+01 4.91722438e-02]
mat_Sqrt:  [[ 2.07199732e+01  0.00000000e+00]
 [-8.86992616e-03  2.03235540e-02]]
grads:  [3.70520699e-03 2.48673153e+01]
Stock Position:  0.003705206992985065
Bond Position:  [6.13699734]


portfolio before change:  [6.48498608]
curr_Stock_Price:  93.71178752423154
curr_Factors:  [9.37117875e+01 5.02194711e-02]
mat_Sqrt:  [[ 2.10005316e+01  0.00000000e+00]
 [-8.96388051e-03  2.05388305e-02]]
grads:  [0.00918875 7.40458374]
Stock Position:  0.009188746380321963
Bond Position:  [5.62389223]


portfolio before change:  [6.50400485]
curr_Stock_Price:  95.70506672811727
curr_Factors:  [9.57050667e+01 5.03846656e-02]
mat_Sqrt:  [[ 2.14824654e+01  0.00000000e+00]
 [-8.97861153e-03  2.05725835e-02]]
grads:  [ 0.00501317 -2.8001572 ]
Stock Position:  0.0050131717034578955
Bond Position:  [6.02421891]


portfolio before change:  [6.51021433]
curr_Stock_Price:  96.79348219610748
curr_Factors:  [9.67934822e+01 5.00926726e-02]
mat_Sqrt:  [[ 2.16637291e+01  0.00000000e+00]
 [-8.95255696e-03  2.05128850e-02]]
grads:  [4.39202647e-03 6.09184953e+00]
Stock Position:  0.004392026466149045
Bond Position:  [6.0850948]


portfolio before change:  [6.51057625]
curr_Stock_Price:  96.70268753424413
curr_Factors:  [9.67026875e+01 5.04509834e-02]
mat_Sqrt:  [[ 2.17206772e+01  0.00000000e+00]
 [-8.98451854e-03  2.05861182e-02]]
grads:  [0.0070968  4.06190293]
Stock Position:  0.0070967979736348795
Bond Position:  [5.82429681]


portfolio before change:  [6.50386838]
curr_Stock_Price:  95.65489888028975
curr_Factors:  [9.56548989e+01 5.31453881e-02]
mat_Sqrt:  [[ 2.20515950e+01  0.00000000e+00]
 [-9.22131341e-03  2.11286834e-02]]
grads:  [0.00565061 4.33946127]
Stock Position:  0.0056506133369910614
Bond Position:  [5.96335954]


portfolio before change:  [6.49324853]
curr_Stock_Price:  93.64355519098584
curr_Factors:  [9.36435552e+01 5.22755593e-02]
mat_Sqrt:  [[ 2.14105211e+01  0.00000000e+00]
 [-9.14553962e-03  2.09550638e-02]]
grads:  [-0.02462649 14.72413271]
Stock Position:  -0.024626486679199523
Bond Position:  [8.79936029]


portfolio before change:  [6.48962717]
curr_Stock_Price:  93.83527316318774
curr_Factors:  [9.38352732e+01 5.01967830e-02]
mat_Sqrt:  [[ 2.10234538e+01  0.00000000e+00]
 [-8.96185544e-03  2.05341905e-02]]
grads:  [4.11026366e-03 7.81967001e+00]
Stock Position:  0.004110263660813456
Bond Position:  [6.10393946]


portfolio before change:  [6.48472086]
curr_Stock_Price:  92.45595584234022
curr_Factors:  [9.24559558e+01 5.13641108e-02]
mat_Sqrt:  [[ 2.09538958e+01  0.00000000e+00]
 [-9.06546068e-03  2.07715799e-02]]
grads:  [ 0.09133292 12.85223687]
Stock Position:  0.09133291779508934
Bond Position:  [-1.95955136]


portfolio before change:  [6.56458649]
curr_Stock_Price:  93.33308309157833
curr_Factors:  [9.33330831e+01 4.86318675e-02]
mat_Sqrt:  [[ 2.05824034e+01  0.00000000e+00]
 [-8.82105368e-03  2.02115731e-02]]
grads:  [9.73489915e-03 2.10300983e+01]
Stock Position:  0.009734899152250485
Bond Position:  [5.65599834]


portfolio before change:  [6.56334165]
curr_Stock_Price:  93.13257981441913
curr_Factors:  [9.31325798e+01 4.92037164e-02]
mat_Sqrt:  [[ 2.06585857e+01  0.00000000e+00]
 [-8.87276429e-03  2.03300570e-02]]
grads:  [-3.34276365e-03  9.61313584e+00]
Stock Position:  -0.0033427636519377975
Bond Position:  [6.87466186]


portfolio before change:  [6.56394699]
curr_Stock_Price:  93.20857917559803
curr_Factors:  [9.32085792e+01 4.93873547e-02]
mat_Sqrt:  [[ 2.07139904e+01  0.00000000e+00]
 [-8.88930636e-03  2.03679596e-02]]
grads:  [-0.00656399  4.55915199]
Stock Position:  -0.006563985510142336
Bond Position:  [7.17576675]


portfolio before change:  [6.5663703]
curr_Stock_Price:  92.97605512267668
curr_Factors:  [9.29760551e+01 4.82624809e-02]
mat_Sqrt:  [[ 2.04256524e+01  0.00000000e+00]
 [-8.78748937e-03  2.01346676e-02]]
grads:  [ 0.00898275 -3.62536589]
Stock Position:  0.00898275360610391
Bond Position:  [5.73118931]


portfolio before change:  [6.56105563]
curr_Stock_Price:  92.30464501807435
curr_Factors:  [9.23046450e+01 4.79592735e-02]
mat_Sqrt:  [[ 2.02143534e+01  0.00000000e+00]
 [-8.75984233e-03  2.00713203e-02]]
grads:  [ 5.01838809e-03 -2.16151607e+01]
Stock Position:  0.0050183880895061945
Bond Position:  [6.0978351]


portfolio before change:  [6.56684071]
curr_Stock_Price:  93.30552330046363
curr_Factors:  [9.33055233e+01 4.94261198e-02]
mat_Sqrt:  [[ 2.07436708e+01  0.00000000e+00]
 [-8.89279436e-03  2.03759517e-02]]
grads:  [ 0.00460772 -0.84740463]
Stock Position:  0.004607716155281751
Bond Position:  [6.13691534]


portfolio before change:  [6.57226833]
curr_Stock_Price:  94.31697071581955
curr_Factors:  [9.43169707e+01 4.90054059e-02]
mat_Sqrt:  [[ 2.08791031e+01  0.00000000e+00]
 [-8.85486586e-03  2.02890465e-02]]
grads:  [  0.01820713 -14.88427298]
Stock Position:  0.018207131714919646
Bond Position:  [4.85502682]


portfolio before change:  [6.59024455]
curr_Stock_Price:  95.27095406114564
curr_Factors:  [9.52709541e+01 4.89890674e-02]
mat_Sqrt:  [[ 2.10867719e+01  0.00000000e+00]
 [-8.85338963e-03  2.02856641e-02]]
grads:  [ -0.02966947 -12.11249372]
Stock Position:  -0.029669466282943553
Bond Position:  [9.41688291]


portfolio before change:  [6.59714442]
curr_Stock_Price:  95.07807276104296
curr_Factors:  [9.50780728e+01 4.90693011e-02]
mat_Sqrt:  [[ 2.10613064e+01  0.00000000e+00]
 [-8.86063664e-03  2.03022691e-02]]
grads:  [0.00455976 1.63909135]
Stock Position:  0.004559757754850274
Bond Position:  [6.16361144]


portfolio before change:  [6.58975579]
curr_Stock_Price:  93.28869459286625
curr_Factors:  [9.32886946e+01 4.94879214e-02]
mat_Sqrt:  [[ 2.07528918e+01  0.00000000e+00]
 [-8.89835234e-03  2.03886866e-02]]
grads:  [-2.74215041e-03  9.95443551e+00]
Stock Position:  -0.002742150408271801
Bond Position:  [6.84556742]


portfolio before change:  [6.59053215]
curr_Stock_Price:  93.31764481212032
curr_Factors:  [9.33176448e+01 4.76781660e-02]
mat_Sqrt:  [[ 2.03762162e+01  0.00000000e+00]
 [-8.73413222e-03  2.00124110e-02]]
grads:  [ 0.02909966 11.47773309]
Stock Position:  0.029099662101537818
Bond Position:  [3.87502022]


portfolio before change:  [6.5381585]
curr_Stock_Price:  91.50119565855428
curr_Factors:  [9.15011957e+01 4.64886737e-02]
mat_Sqrt:  [[ 1.97287853e+01  0.00000000e+00]
 [-8.62449291e-03  1.97611958e-02]]
grads:  [ 6.44085844e-04 -5.35506984e+00]
Stock Position:  0.0006440858437358598
Bond Position:  [6.47922388]


portfolio before change:  [6.5394004]
curr_Stock_Price:  92.17182938412199
curr_Factors:  [9.21718294e+01 4.71753757e-02]
mat_Sqrt:  [[ 2.00196228e+01  0.00000000e+00]
 [-8.68795724e-03  1.99066108e-02]]
grads:  [ 7.39044229e-03 -1.54959641e+01]
Stock Position:  0.007390442288376966
Bond Position:  [5.85820982]


portfolio before change:  [6.54068614]
curr_Stock_Price:  92.24671257130814
curr_Factors:  [9.22467126e+01 4.71690006e-02]
mat_Sqrt:  [[ 2.00345336e+01  0.00000000e+00]
 [-8.68737020e-03  1.99052658e-02]]
grads:  [0.006621   2.48938206]
Stock Position:  0.0066209954172113976
Bond Position:  [5.92992108]


portfolio before change:  [6.54218332]
curr_Stock_Price:  92.3608780299445
curr_Factors:  [9.23608780e+01 4.65209863e-02]
mat_Sqrt:  [[ 1.99210630e+01  0.00000000e+00]
 [-8.62748967e-03  1.97680622e-02]]
grads:  [4.80431536e-03 1.90504505e+01]
Stock Position:  0.004804315360158032
Bond Position:  [6.09845253]


portfolio before change:  [6.54177678]
curr_Stock_Price:  92.1175768057434
curr_Factors:  [9.21175768e+01 4.68284731e-02]
mat_Sqrt:  [[ 1.99341400e+01  0.00000000e+00]
 [-8.65595500e-03  1.98332845e-02]]
grads:  [-0.02178456 -7.06777576]
Stock Position:  -0.021784564944977023
Bond Position:  [8.54851811]


portfolio before change:  [6.50929973]
curr_Stock_Price:  93.65745952885479
curr_Factors:  [9.36574595e+01 4.62045919e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.50929973]
Stock Price:  92.87314082341418
PL:  [6.50929973]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48008714e+00  3.63519262e-01]
 [ 4.16741639e-01  1.20473607e-01]
 [ 1.02902838e-01 -2.27617986e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.37782832e-02  3.69523269e-01]
 [ 3.81396056e-02 -3.53409529e-03]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.24734226e+00  1.28445024e+00]
 [ 1.20982320e-01  6.55580636e-01]
 [-8.34786583e-02 -3.84980713e-01]
 [ 1.12254529e-01  1.39528318e-02]
 [ 4.43963252e-02 -5.24993405e-02]
 [ 2.57219301e-02  5.24231396e-01]
 [-1.68190441e-01  5.86512773e-01]
 [-6.95900349e-02  6.53225042e-02]
 [ 1.29966875e-01 -1.42861706e-01]
 [ 3.50744889e-02 -1.54473787e-01]
 [ 4.23787620e-01  6.11391802e-02]
 [ 5.12887839e-01  5.27466342e-01]
 [-8.80483423e-01  4.36606157e-01]
 [-1.34899751e-01  2.81457676e-01]
 [ 1.76376588e+00  2.48940141e-01]
 [ 1.36698127e-02  3.77955695e-01]
 [-1.66713945e-01  2.44071159e-01]
 [-1.39778565e-01  3.63418154e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 3.38881379e-01 -4.31782804e-01]
 [ 1.28541629e-01 -7.13895719e-02]
 [ 7.35837915e-01 -3.19789369e-01]
 [-6.97919706e-01 -3.36587396e-01]
 [ 4.34424151e-01  1.63303990e-01]
 [-1.59440430e-01  2.26683797e-01]
 [ 5.88785675e-01  2.38174334e-01]
 [ 5.15480336e-02 -7.13846610e-02]
 [ 2.63807777e-01 -2.84265085e-01]
 [ 1.14867788e-01  4.47003179e-02]
 [-6.93731967e-02  3.88708265e-01]
 [-3.67427514e-01 -1.38836909e-01]
 [ 9.28345279e-02  3.42666986e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.9077359]
curr_Stock_Price:  99.33384349726407
curr_Factors:  [9.93338435e+01 3.98333277e-02]
mat_Sqrt:  [[ 1.98253350e+01  0.00000000e+00]
 [-7.98331537e-03  1.82920735e-02]]
grads:  [ 0.08265888 19.87304839]
Stock Position:  0.0826588781060164
Bond Position:  [-10.11855996]


portfolio before change:  [-1.85431354]
curr_Stock_Price:  99.99544518182434
curr_Factors:  [9.99954452e+01 4.01664940e-02]
mat_Sqrt:  [[ 2.00406674e+01  0.00000000e+00]
 [-8.01663211e-03  1.83684117e-02]]
grads:  [0.02341841 6.55873841]
Stock Position:  0.023418413262184926
Bond Position:  [-4.1960482]


portfolio before change:  [-1.8442199]
curr_Stock_Price:  100.44885679141349
curr_Factors:  [1.00448857e+02 4.09413185e-02]
mat_Sqrt:  [[ 2.03247827e+01  0.00000000e+00]
 [-8.09358447e-03  1.85447317e-02]]
grads:  [ 0.00457416 -1.22739972]
Stock Position:  0.004574158337810716
Bond Position:  [-2.30368888]


portfolio before change:  [-1.84988821]
curr_Stock_Price:  99.27261309891153
curr_Factors:  [9.92726131e+01 4.06254320e-02]
mat_Sqrt:  [[ 2.00091412e+01  0.00000000e+00]
 [-8.06230061e-03  1.84730514e-02]]
grads:  [-8.14695981e-04 -8.19500845e+00]
Stock Position:  -0.0008146959812772358
Bond Position:  [-1.76901121]


portfolio before change:  [-1.84950224]
curr_Stock_Price:  98.5274192627493
curr_Factors:  [9.85274193e+01 4.04581959e-02]
mat_Sqrt:  [[ 1.98180246e+01  0.00000000e+00]
 [-8.04568912e-03  1.84349897e-02]]
grads:  [3.91032379e-03 2.00446691e+01]
Stock Position:  0.0039103237913234844
Bond Position:  [-2.23477635]


portfolio before change:  [-1.85853674]
curr_Stock_Price:  96.28843893925028
curr_Factors:  [9.62884389e+01 3.99654020e-02]
mat_Sqrt:  [[ 1.92493575e+01  0.00000000e+00]
 [-7.99653945e-03  1.83223737e-02]]
grads:  [ 0.00190122 -0.19288414]
Stock Position:  0.0019012166998868172
Bond Position:  [-2.04160193]


portfolio before change:  [-1.85943823]
curr_Stock_Price:  95.94851310896007
curr_Factors:  [9.59485131e+01 4.01939527e-02]
mat_Sqrt:  [[ 1.92361700e+01  0.00000000e+00]
 [-8.01937181e-03  1.83746892e-02]]
grads:  [0.00672555 5.23202794]
Stock Position:  0.0067255475989764415
Bond Position:  [-2.50474452]


portfolio before change:  [-1.86617873]
curr_Stock_Price:  94.99284612037044
curr_Factors:  [9.49928461e+01 4.25901768e-02]
mat_Sqrt:  [[ 1.96040419e+01  0.00000000e+00]
 [-8.25495505e-03  1.89144782e-02]]
grads:  [ 0.09222192 67.90830946]
Stock Position:  0.09222191598605575
Bond Position:  [-10.626601]


portfolio before change:  [-1.91979312]
curr_Stock_Price:  94.42588780671035
curr_Factors:  [9.44258878e+01 4.30330526e-02]
mat_Sqrt:  [[ 1.95880929e+01  0.00000000e+00]
 [-8.29776381e-03  1.90125654e-02]]
grads:  [2.07830936e-02 3.44814402e+01]
Stock Position:  0.02078309356201411
Bond Position:  [-3.88225518]


portfolio before change:  [-1.949075]
curr_Stock_Price:  93.04031118885624
curr_Factors:  [9.30403112e+01 4.31031779e-02]
mat_Sqrt:  [[ 1.93163826e+01  0.00000000e+00]
 [-8.30452194e-03  1.90280502e-02]]
grads:  [-1.30199334e-02 -2.02322733e+01]
Stock Position:  -0.013019933432072143
Bond Position:  [-0.73769634]


portfolio before change:  [-1.9490466]
curr_Stock_Price:  93.03104707998345
curr_Factors:  [9.30310471e+01 4.31709667e-02]
mat_Sqrt:  [[ 1.93296413e+01  0.00000000e+00]
 [-8.31104967e-03  1.90430071e-02]]
grads:  [0.00612241 0.73270108]
Stock Position:  0.006122412841660746
Bond Position:  [-2.51862108]


portfolio before change:  [-1.95523186]
curr_Stock_Price:  92.0722065001588
curr_Factors:  [9.20722065e+01 4.32257722e-02]
mat_Sqrt:  [[ 1.91425562e+01  0.00000000e+00]
 [-8.31632343e-03  1.90550908e-02]]
grads:  [ 1.12230228e-03 -2.75513463e+00]
Stock Position:  0.0011223022838836871
Bond Position:  [-2.05856471]


portfolio before change:  [-1.9559507]
curr_Stock_Price:  91.66100129674162
curr_Factors:  [9.16610013e+01 4.23678561e-02]
mat_Sqrt:  [[ 1.88669997e+01  0.00000000e+00]
 [-8.23338143e-03  1.88650468e-02]]
grads:  [1.34899705e-02 2.77885023e+01]
Stock Position:  0.013489970494255082
Bond Position:  [-3.1924549]


portfolio before change:  [-1.95705872]
curr_Stock_Price:  91.60844823576151
curr_Factors:  [9.16084482e+01 4.21341973e-02]
mat_Sqrt:  [[ 1.88041146e+01  0.00000000e+00]
 [-8.21064648e-03  1.88129545e-02]]
grads:  [4.66837822e-03 3.11760055e+01]
Stock Position:  0.0046683782189250655
Bond Position:  [-2.3847216]


portfolio before change:  [-1.95717234]
curr_Stock_Price:  91.64796726804406
curr_Factors:  [9.16479673e+01 4.24955124e-02]
mat_Sqrt:  [[ 1.88927149e+01  0.00000000e+00]
 [-8.24577588e-03  1.88934461e-02]]
grads:  [-2.17443374e-03  3.45741608e+00]
Stock Position:  -0.0021744337384357547
Bond Position:  [-1.75788991]


portfolio before change:  [-1.95842701]
curr_Stock_Price:  92.12391578004596
curr_Factors:  [9.21239158e+01 4.20176557e-02]
mat_Sqrt:  [[ 1.88837525e+01  0.00000000e+00]
 [-8.19928345e-03  1.87869185e-02]]
grads:  [ 3.58069269e-03 -7.60431819e+00]
Stock Position:  0.0035806926919183225
Bond Position:  [-2.28829444]


portfolio before change:  [-1.96275397]
curr_Stock_Price:  90.9953877762644
curr_Factors:  [9.09953878e+01 4.42358178e-02]
mat_Sqrt:  [[ 1.91384345e+01  0.00000000e+00]
 [-8.41292508e-03  1.92764330e-02]]
grads:  [-1.68997098e-03 -8.01360847e+00]
Stock Position:  -0.0016899709768356838
Bond Position:  [-1.80897441]


portfolio before change:  [-1.96372327]
curr_Stock_Price:  91.4351334696379
curr_Factors:  [9.14351335e+01 4.35913119e-02]
mat_Sqrt:  [[ 1.90903140e+01  0.00000000e+00]
 [-8.35141299e-03  1.91354911e-02]]
grads:  [0.02359683 3.19506721]
Stock Position:  0.023596832638440673
Bond Position:  [-4.12130281]


portfolio before change:  [-1.97159017]
curr_Stock_Price:  91.12357874929945
curr_Factors:  [9.11235787e+01 4.28621926e-02]
mat_Sqrt:  [[ 1.88654843e+01  0.00000000e+00]
 [-8.28127455e-03  1.89747837e-02]]
grads:  [ 0.03938902 27.79827955]
Stock Position:  0.03938902446010044
Bond Position:  [-5.56085904]


portfolio before change:  [-1.96170502]
curr_Stock_Price:  91.39218902395834
curr_Factors:  [9.1392189e+01 4.1387281e-02]
mat_Sqrt:  [[ 1.85927028e+01  0.00000000e+00]
 [-8.13754567e-03  1.86454595e-02]]
grads:  [-0.03710772 23.41621866]
Stock Position:  -0.03710772347234618
Bond Position:  [1.42965106]


portfolio before change:  [-1.9879708]
curr_Stock_Price:  92.10483042078188
curr_Factors:  [9.21048304e+01 4.10474169e-02]
mat_Sqrt:  [[ 1.86605880e+01  0.00000000e+00]
 [-8.10406485e-03  1.85687453e-02]]
grads:  [-6.46365002e-04  1.51576033e+01]
Stock Position:  -0.0006463650015944172
Bond Position:  [-1.92843746]


portfolio before change:  [-1.98871591]
curr_Stock_Price:  92.88463394429628
curr_Factors:  [9.28846339e+01 4.14105866e-02]
mat_Sqrt:  [[ 1.89016434e+01  0.00000000e+00]
 [-8.13983652e-03  1.86507085e-02]]
grads:  [ 0.09906082 13.34748976]
Stock Position:  0.09906081867012802
Bond Position:  [-11.18994379]


portfolio before change:  [-2.12661083]
curr_Stock_Price:  91.50673208908144
curr_Factors:  [9.15067321e+01 4.36278101e-02]
mat_Sqrt:  [[ 1.91132594e+01  0.00000000e+00]
 [-8.35490850e-03  1.91435003e-02]]
grads:  [9.34551236e-03 1.97432909e+01]
Stock Position:  0.00934551236259768
Bond Position:  [-2.98178812]


portfolio before change:  [-2.13083685]
curr_Stock_Price:  91.09441938005283
curr_Factors:  [9.10944194e+01 4.20200718e-02]
mat_Sqrt:  [[ 1.86732610e+01  0.00000000e+00]
 [-8.19951919e-03  1.87874587e-02]]
grads:  [-3.22346260e-03  1.29911748e+01]
Stock Position:  -0.0032234626007040584
Bond Position:  [-1.83719739]


portfolio before change:  [-2.12871658]
curr_Stock_Price:  90.36541113698267
curr_Factors:  [9.03654111e+01 4.19901636e-02]
mat_Sqrt:  [[ 1.85172296e+01  0.00000000e+00]
 [-8.19660062e-03  1.87807714e-02]]
grads:  [-0.00669202  1.93505446]
Stock Position:  -0.006692021399077705
Bond Position:  [-1.52398931]


portfolio before change:  [-2.14443728]
curr_Stock_Price:  92.68611311913018
curr_Factors:  [9.26861131e+01 3.97920759e-02]
mat_Sqrt:  [[ 1.84889807e+01  0.00000000e+00]
 [-7.97918050e-03  1.82825993e-02]]
grads:  [ 0.00992367 -3.99262358]
Stock Position:  0.009923673240790548
Bond Position:  [-3.06422398]


portfolio before change:  [-2.15278812]
curr_Stock_Price:  91.88320528350884
curr_Factors:  [9.18832053e+01 4.09098791e-02]
mat_Sqrt:  [[ 1.85844723e+01  0.00000000e+00]
 [-8.09047629e-03  1.85376100e-02]]
grads:  [ 8.09471000e-03 -2.32922585e+01]
Stock Position:  0.008094710000120414
Bond Position:  [-2.89655603]


portfolio before change:  [-2.15691992]
curr_Stock_Price:  91.41750510332822
curr_Factors:  [9.14175051e+01 4.03832055e-02]
mat_Sqrt:  [[ 1.83708715e+01  0.00000000e+00]
 [-8.03822921e-03  1.84178969e-02]]
grads:  [ 0.00530104 -3.87609793]
Stock Position:  0.005301036759761971
Bond Position:  [-2.64152748]


portfolio before change:  [-2.15793792]
curr_Stock_Price:  91.28775956261063
curr_Factors:  [9.12877596e+01 4.05723973e-02]
mat_Sqrt:  [[ 1.83877201e+01  0.00000000e+00]
 [-8.05703640e-03  1.84609896e-02]]
grads:  [  0.03242764 -17.32243914]
Stock Position:  0.032427641420447996
Bond Position:  [-5.11818466]


portfolio before change:  [-2.15616961]
curr_Stock_Price:  91.36202091599235
curr_Factors:  [9.13620209e+01 4.07051814e-02]
mat_Sqrt:  [[ 1.84327675e+01  0.00000000e+00]
 [-8.07021005e-03  1.84911742e-02]]
grads:  [ -0.04583243 -18.2025972 ]
Stock Position:  -0.045832428003284034
Bond Position:  [2.03117363]


portfolio before change:  [-2.18702314]
curr_Stock_Price:  92.0407421034019
curr_Factors:  [9.20407421e+01 3.90115380e-02]
mat_Sqrt:  [[ 1.81792787e+01  0.00000000e+00]
 [-7.90053547e-03  1.81024009e-02]]
grads:  [0.02781716 9.02112326]
Stock Position:  0.027817157299976213
Bond Position:  [-4.74733494]


portfolio before change:  [-2.16505237]
curr_Stock_Price:  92.85190435691877
curr_Factors:  [9.28519044e+01 3.81495000e-02]
mat_Sqrt:  [[ 1.81357383e+01  0.00000000e+00]
 [-7.81275880e-03  1.79012793e-02]]
grads:  [-3.33636874e-03  1.26629942e+01]
Stock Position:  -0.0033363687442609113
Bond Position:  [-1.85526418]


portfolio before change:  [-2.16381444]
curr_Stock_Price:  92.41135162208653
curr_Factors:  [9.24113516e+01 3.83418222e-02]
mat_Sqrt:  [[ 1.80951296e+01  0.00000000e+00]
 [-7.83242718e-03  1.79463452e-02]]
grads:  [ 0.03828287 13.27146733]
Stock Position:  0.038282869132194496
Bond Position:  [-5.70158612]


portfolio before change:  [-2.15104579]
curr_Stock_Price:  92.76350373238762
curr_Factors:  [9.27635037e+01 3.83522263e-02]
mat_Sqrt:  [[ 1.81665489e+01  0.00000000e+00]
 [-7.83348977e-03  1.79487799e-02]]
grads:  [ 1.12256948e-03 -3.97713167e+00]
Stock Position:  0.0011225694783103827
Bond Position:  [-2.25517927]


portfolio before change:  [-2.15140177]
curr_Stock_Price:  92.6975301951637
curr_Factors:  [9.26975302e+01 3.85748909e-02]
mat_Sqrt:  [[ 1.82062506e+01  0.00000000e+00]
 [-7.85619662e-03  1.80008079e-02]]
grads:  [ 7.67562342e-03 -1.57917960e+01]
Stock Position:  0.007675623415765151
Bond Position:  [-2.8629131]


portfolio before change:  [-2.15745887]
curr_Stock_Price:  91.95502218012207
curr_Factors:  [9.19550222e+01 3.93461861e-02]
mat_Sqrt:  [[ 1.82400815e+01  0.00000000e+00]
 [-7.93434924e-03  1.81798780e-02]]
grads:  [0.00736711 2.45877986]
Stock Position:  0.007367105593913217
Bond Position:  [-2.83490123]


portfolio before change:  [-2.15586588]
curr_Stock_Price:  92.21935498189329
curr_Factors:  [9.22193550e+01 3.97442801e-02]
mat_Sqrt:  [[ 1.83848206e+01  0.00000000e+00]
 [-7.97438700e-03  1.82716160e-02]]
grads:  [5.45411894e-03 2.12738854e+01]
Stock Position:  0.005454118936314339
Bond Position:  [-2.65884121]


portfolio before change:  [-2.15455615]
curr_Stock_Price:  92.52043175436296
curr_Factors:  [9.25204318e+01 3.96048449e-02]
mat_Sqrt:  [[ 1.84124597e+01  0.00000000e+00]
 [-7.96038641e-03  1.82395366e-02]]
grads:  [-0.02324626 -7.61186601]
Stock Position:  -0.023246264510537403
Bond Position:  [-0.00380172]


portfolio before change:  [-2.17691804]
curr_Stock_Price:  93.48236772079612
curr_Factors:  [9.34823677e+01 3.98945296e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.17691804]
Stock Price:  93.21279587019957
PL:  [-2.17691804]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48143584e+00  3.63824176e-01]
 [ 2.47533015e-01  1.03435952e-01]
 [ 1.09859228e-01 -4.94700940e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.97049018e-02  1.75108659e-01]
 [-6.36148072e-02 -1.16893531e-01]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.37691185e-01  8.32058253e-01]
 [-3.11841288e-02  2.49089250e-01]
 [ 1.81950476e-01  4.76105695e-02]
 [-1.07390345e-01 -2.29563874e-03]
 [ 1.92969112e-02 -1.35874465e-01]
 [-1.15466131e-01 -2.70214213e-02]
 [-3.84211486e-02 -4.12158834e-02]
 [ 4.47468679e-01  2.84323516e-01]
 [ 1.33026328e-01 -3.04784277e-01]
 [ 3.64972106e-02 -7.41169629e-02]
 [ 2.87382348e-02 -1.49937109e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-3.04035710e-02 -6.62568835e-02]
 [ 1.63765112e-01 -3.58752224e-02]
 [ 6.41384643e-01 -1.35425490e-01]
 [ 3.05688462e-02 -4.12164759e-01]
 [ 5.48904275e-02  7.18767675e-03]
 [ 2.20134974e-01 -1.32205326e-01]
 [ 1.63426577e-01 -9.16530186e-02]
 [ 4.37880037e-02 -1.15831372e-01]
 [ 2.09817685e-02  2.78102009e-01]
 [-1.99044383e-02  1.83851006e-01]
 [-6.18691055e-01 -6.95759752e-02]
 [-1.64608273e-01 -5.30839770e-02]
 [ 1.32370887e-02 -6.42150743e-02]
 [-2.63795161e-01  1.43979778e-01]
 [ 6.49711290e-02  6.38134676e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.44140340e-01  6.89098410e-02]
 [-2.33909477e-02 -2.13633307e-01]
 [ 2.54149050e-02 -2.12874371e-02]
 [ 2.35675302e-02 -1.12392146e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.93430512]
curr_Stock_Price:  99.329986842876
curr_Factors:  [9.93299868e+01 4.04082919e-02]
mat_Sqrt:  [[ 1.99671290e+01  0.00000000e+00]
 [-8.04072553e-03  1.84236167e-02]]
grads:  [ 0.0821461  19.74770655]
Stock Position:  0.08214609738246426
Bond Position:  [-10.09387589]


portfolio before change:  [-1.83751761]
curr_Stock_Price:  100.5235837351685
curr_Factors:  [1.00523584e+02 3.81323173e-02]
mat_Sqrt:  [[ 1.96297407e+01  0.00000000e+00]
 [-7.81099914e-03  1.78972474e-02]]
grads:  [0.01490983 5.77943355]
Stock Position:  0.014909833505505428
Bond Position:  [-3.3363075]


portfolio before change:  [-1.85819018]
curr_Stock_Price:  99.16505043537134
curr_Factors:  [9.91650504e+01 3.82195012e-02]
mat_Sqrt:  [[ 1.93865775e+01  0.00000000e+00]
 [-7.81992340e-03  1.79176955e-02]]
grads:  [ 0.00455308 -2.76096299]
Stock Position:  0.004553083646637587
Bond Position:  [-2.30969695]


portfolio before change:  [-1.86156452]
curr_Stock_Price:  98.48735294425539
curr_Factors:  [9.84873529e+01 3.85593135e-02]
mat_Sqrt:  [[ 1.93394942e+01  0.00000000e+00]
 [-7.85461022e-03  1.79971729e-02]]
grads:  [-8.42905548e-04 -8.41169960e+00]
Stock Position:  -0.0008429055475135159
Bond Position:  [-1.77854898]


portfolio before change:  [-1.86267558]
curr_Stock_Price:  99.54171184970411
curr_Factors:  [9.95417118e+01 3.79429795e-02]
mat_Sqrt:  [[ 1.93896880e+01  0.00000000e+00]
 [-7.79158310e-03  1.78527597e-02]]
grads:  [-1.69224879e-04  9.80849247e+00]
Stock Position:  -0.00016922487862928632
Bond Position:  [-1.84583064]


portfolio before change:  [-1.86276498]
curr_Stock_Price:  98.70646927689455
curr_Factors:  [9.87064693e+01 3.81849765e-02]
mat_Sqrt:  [[ 1.92882080e+01  0.00000000e+00]
 [-7.81639063e-03  1.79096009e-02]]
grads:  [-5.94307809e-03 -6.52686409e+00]
Stock Position:  -0.005943078089334198
Bond Position:  [-1.27614472]


portfolio before change:  [-1.86137187]
curr_Stock_Price:  98.44521897223508
curr_Factors:  [9.84452190e+01 3.84309896e-02]
mat_Sqrt:  [[ 1.92990270e+01  0.00000000e+00]
 [-7.84152941e-03  1.79672010e-02]]
grads:  [0.00670364 5.35068801]
Stock Position:  0.006703642486293019
Bond Position:  [-2.52131343]


portfolio before change:  [-1.86532934]
curr_Stock_Price:  97.90189008591486
curr_Factors:  [9.79018901e+01 3.88525457e-02]
mat_Sqrt:  [[ 1.92974896e+01  0.00000000e+00]
 [-7.88441965e-03  1.80654749e-02]]
grads:  [ 0.06222733 46.05792302]
Stock Position:  0.062227325971977145
Bond Position:  [-7.95750217]


portfolio before change:  [-1.80884223]
curr_Stock_Price:  98.82562999305537
curr_Factors:  [9.88256300e+01 3.80823058e-02]
mat_Sqrt:  [[ 1.92855136e+01  0.00000000e+00]
 [-7.80587530e-03  1.78855072e-02]]
grads:  [4.01997758e-03 1.39268765e+01]
Stock Position:  0.004019977583096866
Bond Position:  [-2.20611904]


portfolio before change:  [-1.80657702]
curr_Stock_Price:  99.45772014952256
curr_Factors:  [9.94577201e+01 3.85726408e-02]
mat_Sqrt:  [[ 1.95334154e+01  0.00000000e+00]
 [-7.85596749e-03  1.80002828e-02]]
grads:  [0.0103786  2.64499008]
Stock Position:  0.010378596265423558
Bond Position:  [-2.83880854]


portfolio before change:  [-1.8037079]
curr_Stock_Price:  99.76835871696575
curr_Factors:  [9.97683587e+01 3.73989380e-02]
mat_Sqrt:  [[ 1.92940084e+01  0.00000000e+00]
 [-7.73552201e-03  1.77243076e-02]]
grads:  [-0.00561792 -0.12951923]
Stock Position:  -0.005617922515387807
Bond Position:  [-1.24321699]


portfolio before change:  [-1.80628214]
curr_Stock_Price:  100.19891456031641
curr_Factors:  [1.00198915e+02 3.70249936e-02]
mat_Sqrt:  [[ 1.92801547e+01  0.00000000e+00]
 [-7.69675190e-03  1.76354741e-02]]
grads:  [-2.07485716e-03 -7.70461084e+00]
Stock Position:  -0.002074857160622808
Bond Position:  [-1.59838371]


portfolio before change:  [-1.80629195]
curr_Stock_Price:  100.10734011873387
curr_Factors:  [1.00107340e+02 3.73394138e-02]
mat_Sqrt:  [[ 1.93441508e+01  0.00000000e+00]
 [-7.72936362e-03  1.77101969e-02]]
grads:  [-0.00657869 -1.52575499]
Stock Position:  -0.006578693833031266
Bond Position:  [-1.14771641]


portfolio before change:  [-1.81269751]
curr_Stock_Price:  101.05921415056193
curr_Factors:  [1.01059214e+02 3.76092526e-02]
mat_Sqrt:  [[ 1.95985196e+01  0.00000000e+00]
 [-7.75724204e-03  1.77740744e-02]]
grads:  [-0.00287824 -2.31887649]
Stock Position:  -0.0028782395762724606
Bond Position:  [-1.52182488]


portfolio before change:  [-1.80969695]
curr_Stock_Price:  99.95062008987006
curr_Factors:  [9.99506201e+01 3.87605277e-02]
mat_Sqrt:  [[ 1.96779718e+01  0.00000000e+00]
 [-7.87507741e-03  1.80440692e-02]]
grads:  [ 0.02904556 15.75717278]
Stock Position:  0.029045556168021618
Bond Position:  [-4.7128183]


portfolio before change:  [-1.79364148]
curr_Stock_Price:  100.52367188189149
curr_Factors:  [1.00523672e+02 3.71048015e-02]
mat_Sqrt:  [[ 1.93634795e+01  0.00000000e+00]
 [-7.70504266e-03  1.76544706e-02]]
grads:  [ 3.90642072e-07 -1.72638582e+01]
Stock Position:  3.906420723449838e-07
Bond Position:  [-1.79368075]


portfolio before change:  [-1.79386535]
curr_Stock_Price:  101.4318160863027
curr_Factors:  [1.01431816e+02 3.70737087e-02]
mat_Sqrt:  [[ 1.95302237e+01  0.00000000e+00]
 [-7.70181368e-03  1.76470721e-02]]
grads:  [ 2.12486867e-04 -4.19995808e+00]
Stock Position:  0.0002124868670541654
Bond Position:  [-1.81541828]


portfolio before change:  [-1.79409561]
curr_Stock_Price:  101.4162262153959
curr_Factors:  [1.01416226e+02 3.80835253e-02]
mat_Sqrt:  [[ 1.97913773e+01  0.00000000e+00]
 [-7.80600029e-03  1.78857936e-02]]
grads:  [-1.85432696e-03 -8.38302804e+00]
Stock Position:  -0.001854326961257691
Bond Position:  [-1.60603676]


portfolio before change:  [-1.79446518]
curr_Stock_Price:  101.50725999021203
curr_Factors:  [1.01507260e+02 3.70283489e-02]
mat_Sqrt:  [[ 1.95327899e+01  0.00000000e+00]
 [-7.69710064e-03  1.76362732e-02]]
grads:  [-1.63198983e-02 -2.66092297e+01]
Stock Position:  -0.01631989829339616
Bond Position:  [-0.13787702]


portfolio before change:  [-1.78573649]
curr_Stock_Price:  100.97135445811182
curr_Factors:  [1.00971354e+02 3.65459450e-02]
mat_Sqrt:  [[ 1.93026875e+01  0.00000000e+00]
 [-7.64679750e-03  1.75210142e-02]]
grads:  [-3.07317028e-03 -3.78156668e+00]
Stock Position:  -0.0030731702837695145
Bond Position:  [-1.47543433]


portfolio before change:  [-1.78907526]
curr_Stock_Price:  101.99776358668889
curr_Factors:  [1.01997764e+02 3.59367651e-02]
mat_Sqrt:  [[ 1.93357107e+01  0.00000000e+00]
 [-7.58279791e-03  1.73743727e-02]]
grads:  [ 0.00765981 -2.06483555]
Stock Position:  0.007659810584065411
Bond Position:  [-2.57035881]


portfolio before change:  [-1.79523636]
curr_Stock_Price:  101.235370899658
curr_Factors:  [1.01235371e+02 3.61820764e-02]
mat_Sqrt:  [[ 1.92565739e+01  0.00000000e+00]
 [-7.60863472e-03  1.74335723e-02]]
grads:  [ 0.03023799 -7.76808606]
Stock Position:  0.030237991240867974
Bond Position:  [-4.85639062]


portfolio before change:  [-1.78445428]
curr_Stock_Price:  101.61202192619022
curr_Factors:  [1.01612022e+02 3.78157590e-02]
mat_Sqrt:  [[ 1.97597527e+01  0.00000000e+00]
 [-7.77850978e-03  1.78228049e-02]]
grads:  [-7.55650157e-03 -2.31256954e+01]
Stock Position:  -0.007556501573020503
Bond Position:  [-1.01662287]


portfolio before change:  [-1.78316984]
curr_Stock_Price:  101.4252265156609
curr_Factors:  [1.01425227e+02 3.83163382e-02]
mat_Sqrt:  [[ 1.98535414e+01  0.00000000e+00]
 [-7.82982382e-03  1.79403802e-02]]
grads:  [0.00292277 0.40064239]
Stock Position:  0.0029227726057161
Bond Position:  [-2.07961272]


portfolio before change:  [-1.78486741]
curr_Stock_Price:  100.93336405325567
curr_Factors:  [1.00933364e+02 3.75944607e-02]
mat_Sqrt:  [[ 1.95702637e+01  0.00000000e+00]
 [-7.75571642e-03  1.77705788e-02]]
grads:  [ 0.00830014 -7.43956217]
Stock Position:  0.008300135448337206
Bond Position:  [-2.62262801]


portfolio before change:  [-1.79099572]
curr_Stock_Price:  100.23452543623466
curr_Factors:  [1.00234525e+02 3.83484408e-02]
mat_Sqrt:  [[ 1.96286845e+01  0.00000000e+00]
 [-7.83310317e-03  1.79478941e-02]]
grads:  [ 0.00628804 -5.10661686]
Stock Position:  0.006288038308503311
Bond Position:  [-2.42127425]


portfolio before change:  [-1.78875233]
curr_Stock_Price:  100.63943172961226
curr_Factors:  [1.00639432e+02 3.81064383e-02]
mat_Sqrt:  [[ 1.96456931e+01  0.00000000e+00]
 [-7.80834818e-03  1.78911733e-02]]
grads:  [-3.44347811e-04 -6.47421886e+00]
Stock Position:  -0.00034434781091303946
Bond Position:  [-1.75409736]


portfolio before change:  [-1.78938525]
curr_Stock_Price:  101.8406727222771
curr_Factors:  [1.01840673e+02 3.79596803e-02]
mat_Sqrt:  [[ 1.98418669e+01  0.00000000e+00]
 [-7.79329767e-03  1.78566882e-02]]
grads:  [7.17449807e-03 1.55741090e+01]
Stock Position:  0.0071744980701909
Bond Position:  [-2.52004096]


portfolio before change:  [-1.79446227]
curr_Stock_Price:  101.17693402313735
curr_Factors:  [1.01176934e+02 3.80582524e-02]
mat_Sqrt:  [[ 1.97381268e+01  0.00000000e+00]
 [-7.80340976e-03  1.78798579e-02]]
grads:  [3.05676013e-03 1.02825765e+01]
Stock Position:  0.0030567601299431105
Bond Position:  [-2.10373588]


portfolio before change:  [-1.79117915]
curr_Stock_Price:  102.33701870538813
curr_Factors:  [1.02337019e+02 3.62381310e-02]
mat_Sqrt:  [[ 1.94811978e+01  0.00000000e+00]
 [-7.61452623e-03  1.74470714e-02]]
grads:  [-0.03331707 -3.98783117]
Stock Position:  -0.03331707354394911
Bond Position:  [1.61839083]


portfolio before change:  [-1.79083085]
curr_Stock_Price:  102.33263687733884
curr_Factors:  [1.02332637e+02 3.54641184e-02]
mat_Sqrt:  [[ 1.92711996e+01  0.00000000e+00]
 [-7.53276772e-03  1.72597391e-02]]
grads:  [-0.00974387 -3.07559556]
Stock Position:  -0.00974386772919903
Bond Position:  [-0.79371517]


portfolio before change:  [-1.78258833]
curr_Stock_Price:  101.47653599677768
curr_Factors:  [1.01476536e+02 3.70214924e-02]
mat_Sqrt:  [[ 1.95250698e+01  0.00000000e+00]
 [-7.69638797e-03  1.76346402e-02]]
grads:  [-7.57419439e-04 -3.64141675e+00]
Stock Position:  -0.000757419438858184
Bond Position:  [-1.70572803]


portfolio before change:  [-1.78283376]
curr_Stock_Price:  101.51904361531305
curr_Factors:  [1.01519044e+02 3.58652607e-02]
mat_Sqrt:  [[ 1.92258041e+01  0.00000000e+00]
 [-7.57525030e-03  1.73570789e-02]]
grads:  [-0.01045247  8.29516181]
Stock Position:  -0.010452474852259419
Bond Position:  [-0.72170851]


portfolio before change:  [-1.78281133]
curr_Stock_Price:  101.50826670165851
curr_Factors:  [1.01508267e+02 3.61561199e-02]
mat_Sqrt:  [[ 1.93015560e+01  0.00000000e+00]
 [-7.60590506e-03  1.74273178e-02]]
grads:  [0.00480902 3.66169184]
Stock Position:  0.004809022108205914
Bond Position:  [-2.27096683]


portfolio before change:  [-1.78183091]
curr_Stock_Price:  101.77116998138716
curr_Factors:  [1.01771170e+02 3.58827709e-02]
mat_Sqrt:  [[ 1.92782564e+01  0.00000000e+00]
 [-7.57709927e-03  1.73613155e-02]]
grads:  [-0.00491059  4.68427328]
Stock Position:  -0.00491058986759737
Bond Position:  [-1.28207444]


portfolio before change:  [-1.78050903]
curr_Stock_Price:  101.4693422909222
curr_Factors:  [1.01469342e+02 3.47221610e-02]
mat_Sqrt:  [[ 1.89076789e+01  0.00000000e+00]
 [-7.45355336e-03  1.70782362e-02]]
grads:  [-0.01132162  4.03495069]
Stock Position:  -0.011321623393383908
Bond Position:  [-0.63171135]


portfolio before change:  [-1.77070898]
curr_Stock_Price:  100.59676232385596
curr_Factors:  [1.00596762e+02 3.41935750e-02]
mat_Sqrt:  [[ 1.86018551e+01  0.00000000e+00]
 [-7.39660192e-03  1.69477441e-02]]
grads:  [-6.26970622e-03 -1.26054126e+01]
Stock Position:  -0.006269706222697158
Bond Position:  [-1.13999683]


portfolio before change:  [-1.7718429]
curr_Stock_Price:  100.75488916208892
curr_Factors:  [1.00754889e+02 3.42040204e-02]
mat_Sqrt:  [[ 1.86339407e+01  0.00000000e+00]
 [-7.39773159e-03  1.69503325e-02]]
grads:  [ 8.65319154e-04 -1.25587136e+00]
Stock Position:  0.0008653191536490417
Bond Position:  [-1.85902803]


portfolio before change:  [-1.77297057]
curr_Stock_Price:  99.72026768776024
curr_Factors:  [9.97202677e+01 3.43009346e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.77297057]
Stock Price:  100.03464009079771
PL:  [-1.80761066]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.28034499e+00  3.18361564e-01]
 [ 1.14532030e-01  6.37250585e-02]
 [-2.18072862e-02 -6.30868032e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.21100939e-01 -4.81103516e-01]
 [-3.76540489e-01  2.12209296e-01]
 [ 2.40188835e-01 -2.64862089e-01]
 [-3.63467301e-01  2.90166332e-01]
 [-1.14259506e-01 -1.06116655e-01]
 [-3.76183338e-01 -6.02143709e-01]
 [-6.05561322e-02 -1.46564234e-02]
 [-3.55070298e-02 -1.34146598e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [-3.81604772e-03 -1.31604231e-01]
 [ 3.44281356e-01  2.10201453e-01]
 [ 1.33507074e-01 -3.40031308e-01]
 [ 3.91926849e-02  4.67493441e-02]
 [-1.63581474e-03  3.50428379e-02]
 [-7.71997594e-02 -5.75811387e-02]
 [-6.34904148e-02 -4.68865111e-02]
 [ 1.77941350e-01 -4.43175176e-02]
 [ 5.50927846e-01 -2.15240543e-01]
 [ 2.98817277e-02 -4.03648264e-01]
 [ 5.54193482e-02  1.30096481e-02]
 [ 3.68369993e-01 -2.74168835e-01]
 [-2.97482127e-02 -3.98574101e-02]
 [-1.71338437e-01  4.85429592e-02]
 [ 2.49802093e-02  2.73274295e-01]
 [-1.97370426e-02  1.84988473e-01]
 [-5.18055978e-01 -1.10856910e-01]
 [-1.64502831e-01 -5.90612099e-02]
 [ 7.76351614e-03 -6.99623345e-02]
 [-1.53137613e-01  1.51061106e-01]
 [ 1.32089636e-02  1.53320334e-02]
 [-1.05642114e-01  8.79604238e-02]
 [-2.01198155e-01  9.16528806e-02]
 [-3.31071085e-02 -1.27291956e-01]
 [ 2.00391491e-02 -2.74090801e-02]
 [ 1.50889481e-02 -1.11306281e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.07072119]
curr_Stock_Price:  100.20164622732423
curr_Factors:  [1.00201646e+02 3.94988629e-02]
mat_Sqrt:  [[ 1.99143967e+01  0.00000000e+00]
 [-7.94972834e-03  1.82151159e-02]]
grads:  [ 0.07126951 17.47787744]
Stock Position:  0.0712695135991722
Bond Position:  [-3.0706014]


portfolio before change:  [4.11073498]
curr_Stock_Price:  100.76847537122299
curr_Factors:  [1.00768475e+02 3.93797591e-02]
mat_Sqrt:  [[ 1.99968328e+01  0.00000000e+00]
 [-7.93773359e-03  1.81876325e-02]]
grads:  [0.00711832 3.50375775]
Stock Position:  0.007118323558538051
Bond Position:  [3.39343236]


portfolio before change:  [4.11328394]
curr_Stock_Price:  101.06696676602068
curr_Factors:  [1.01066967e+02 3.87966329e-02]
mat_Sqrt:  [[ 1.99070198e+01  0.00000000e+00]
 [-7.87874435e-03  1.80524712e-02]]
grads:  [-2.47855404e-03 -3.49463530e+00]
Stock Position:  -0.002478554035126939
Bond Position:  [4.36378388]


portfolio before change:  [4.11352809]
curr_Stock_Price:  101.18855052166407
curr_Factors:  [1.01188551e+02 3.98538085e-02]
mat_Sqrt:  [[ 2.02006940e+01  0.00000000e+00]
 [-7.98536747e-03  1.82967754e-02]]
grads:  [-8.06970640e-04 -8.27396133e+00]
Stock Position:  -0.0008069706404184961
Bond Position:  [4.19518428]


portfolio before change:  [4.11296694]
curr_Stock_Price:  102.53381598720688
curr_Factors:  [1.02533816e+02 3.75414564e-02]
mat_Sqrt:  [[ 1.98665603e+01  0.00000000e+00]
 [-7.75024710e-03  1.77580470e-02]]
grads:  [-1.66647735e-02 -2.70921412e+01]
Stock Position:  -0.016664773512644476
Bond Position:  [5.82166976]


portfolio before change:  [4.1168727]
curr_Stock_Price:  102.34311344053302
curr_Factors:  [1.02343113e+02 3.65546959e-02]
mat_Sqrt:  [[ 1.95672689e+01  0.00000000e+00]
 [-7.64771295e-03  1.75231117e-02]]
grads:  [-0.01451019 12.11025183]
Stock Position:  -0.014510188478793458
Bond Position:  [5.60189057]


portfolio before change:  [4.11642318]
curr_Stock_Price:  102.42235442735553
curr_Factors:  [1.02422354e+02 3.55047440e-02]
mat_Sqrt:  [[ 1.92991396e+01  0.00000000e+00]
 [-7.53708102e-03  1.72696222e-02]]
grads:  [ 6.45591176e-03 -1.53368780e+01]
Stock Position:  0.006455911762606134
Bond Position:  [3.4551935]


portfolio before change:  [4.11547213]
curr_Stock_Price:  102.20813541298688
curr_Factors:  [1.02208135e+02 3.47275856e-02]
mat_Sqrt:  [[ 1.90468324e+01  0.00000000e+00]
 [-7.45413556e-03  1.70795702e-02]]
grads:  [-1.24340009e-02  1.69890886e+01]
Stock Position:  -0.012434000927875716
Bond Position:  [5.38632818]


portfolio before change:  [4.10066041]
curr_Stock_Price:  103.45351523258809
curr_Factors:  [1.03453515e+02 3.47053953e-02]
mat_Sqrt:  [[ 1.92727528e+01  0.00000000e+00]
 [-7.45175366e-03  1.70741126e-02]]
grads:  [-0.00833159 -6.21506125]
Stock Position:  -0.00833158676531886
Bond Position:  [4.96259235]


portfolio before change:  [4.09602388]
curr_Stock_Price:  104.08447453246804
curr_Factors:  [1.04084475e+02 3.38276573e-02]
mat_Sqrt:  [[ 1.91435252e+01  0.00000000e+00]
 [-7.35691863e-03  1.68568183e-02]]
grads:  [-3.33784081e-02 -3.57210774e+01]
Stock Position:  -0.03337840809981917
Bond Position:  [7.57019795]


portfolio before change:  [4.15621182]
curr_Stock_Price:  102.30962632163968
curr_Factors:  [1.02309626e+02 3.40224997e-02]
mat_Sqrt:  [[ 1.88712039e+01  0.00000000e+00]
 [-7.37807560e-03  1.69052950e-02]]
grads:  [-0.00354788 -0.86697236]
Stock Position:  -0.0035478774975996473
Bond Position:  [4.51919384]


portfolio before change:  [4.15653054]
curr_Stock_Price:  102.37902568019602
curr_Factors:  [1.02379026e+02 3.31796628e-02]
mat_Sqrt:  [[ 1.86486319e+01  0.00000000e+00]
 [-7.28611423e-03  1.66945850e-02]]
grads:  [-5.04344799e-03 -8.03533589e+00]
Stock Position:  -0.0050434479876900066
Bond Position:  [4.67287383]


portfolio before change:  [4.1601655]
curr_Stock_Price:  101.77411751448713
curr_Factors:  [1.01774118e+02 3.26386678e-02]
mat_Sqrt:  [[ 1.83866902e+01  0.00000000e+00]
 [-7.22646999e-03  1.65579229e-02]]
grads:  [-0.00356288 -1.08044971]
Stock Position:  -0.0035628773048435253
Bond Position:  [4.5227742]


portfolio before change:  [4.15816123]
curr_Stock_Price:  102.49534930997658
curr_Factors:  [1.02495349e+02 3.10982224e-02]
mat_Sqrt:  [[ 1.80747352e+01  0.00000000e+00]
 [-7.05387523e-03  1.61624586e-02]]
grads:  [-3.38886532e-03 -8.14258737e+00]
Stock Position:  -0.003388865317285565
Bond Position:  [4.50550416]


portfolio before change:  [4.16264775]
curr_Stock_Price:  101.33764587899705
curr_Factors:  [1.01337646e+02 3.05411564e-02]
mat_Sqrt:  [[ 1.77097957e+01  0.00000000e+00]
 [-6.99041131e-03  1.60170445e-02]]
grads:  [ 0.02462032 13.12361049]
Stock Position:  0.0246203174567141
Bond Position:  [1.66768274]


portfolio before change:  [4.14866696]
curr_Stock_Price:  100.76132266689848
curr_Factors:  [1.00761323e+02 3.06066115e-02]
mat_Sqrt:  [[ 1.76279368e+01  0.00000000e+00]
 [-6.99789814e-03  1.60341990e-02]]
grads:  [-8.44951734e-04 -2.12066290e+01]
Stock Position:  -0.0008449517335816924
Bond Position:  [4.23380542]


portfolio before change:  [4.14950712]
curr_Stock_Price:  100.39337920670431
curr_Factors:  [1.00393379e+02 3.01006496e-02]
mat_Sqrt:  [[ 1.74177883e+01  0.00000000e+00]
 [-6.93981552e-03  1.59011150e-02]]
grads:  [0.00342155 2.94000416]
Stock Position:  0.003421546438315915
Bond Position:  [3.80600651]


portfolio before change:  [4.14380517]
curr_Stock_Price:  98.58784215465546
curr_Factors:  [9.85878422e+01 3.08772512e-02]
mat_Sqrt:  [[ 1.73237807e+01  0.00000000e+00]
 [-7.02876959e-03  1.61049343e-02]]
grads:  [7.88403746e-04 2.17590691e+00]
Stock Position:  0.0007884037455421946
Bond Position:  [4.06607814]


portfolio before change:  [4.1437889]
curr_Stock_Price:  97.922498868794
curr_Factors:  [9.79224989e+01 3.11550908e-02]
mat_Sqrt:  [[ 1.72841091e+01  0.00000000e+00]
 [-7.06032189e-03  1.61772297e-02]]
grads:  [-0.00592048 -3.55939426]
Stock Position:  -0.005920480382693144
Bond Position:  [4.72353713]


portfolio before change:  [4.13155415]
curr_Stock_Price:  100.08874756888174
curr_Factors:  [1.00088748e+02 3.09249315e-02]
mat_Sqrt:  [[ 1.76010926e+01  0.00000000e+00]
 [-7.03419437e-03  1.61173641e-02]]
grads:  [-0.00476978 -2.90906819]
Stock Position:  -0.00476978149915245
Bond Position:  [4.6089556]


portfolio before change:  [4.13117085]
curr_Stock_Price:  100.28989890851608
curr_Factors:  [1.00289899e+02 3.12728788e-02]
mat_Sqrt:  [[ 1.77354056e+01  0.00000000e+00]
 [-7.07365578e-03  1.62077815e-02]]
grads:  [ 0.00894254 -2.73433582]
Stock Position:  0.00894254147016566
Bond Position:  [3.23432427]


portfolio before change:  [4.1480636]
curr_Stock_Price:  102.13371828071996
curr_Factors:  [1.02133718e+02 2.99686540e-02]
mat_Sqrt:  [[ 1.76808346e+01  0.00000000e+00]
 [-6.92458276e-03  1.58662123e-02]]
grads:  [  0.02584658 -13.56596891]
Stock Position:  0.025846583709138744
Bond Position:  [1.5082559]


portfolio before change:  [4.16279444]
curr_Stock_Price:  102.69635714079858
curr_Factors:  [1.02696357e+02 2.95518853e-02]
mat_Sqrt:  [[ 1.76541834e+01  0.00000000e+00]
 [-6.87626471e-03  1.57555018e-02]]
grads:  [-8.28612765e-03 -2.56195118e+01]
Stock Position:  -0.008286127651512225
Bond Position:  [5.01374956]


portfolio before change:  [4.16636533]
curr_Stock_Price:  102.34104786560601
curr_Factors:  [1.02341048e+02 2.86953043e-02]
mat_Sqrt:  [[ 1.73362546e+01  0.00000000e+00]
 [-6.77587536e-03  1.55254809e-02]]
grads:  [0.00352425 0.8379546 ]
Stock Position:  0.0035242458982989227
Bond Position:  [3.80569032]


portfolio before change:  [4.16760818]
curr_Stock_Price:  102.55871298198839
curr_Factors:  [1.02558713e+02 2.91873901e-02]
mat_Sqrt:  [[ 1.75214560e+01  0.00000000e+00]
 [-6.83372695e-03  1.56580355e-02]]
grads:  [ 1.41947623e-02 -1.75097850e+01]
Stock Position:  0.014194762281138099
Bond Position:  [2.71181163]


portfolio before change:  [4.16700948]
curr_Stock_Price:  102.49265346143824
curr_Factors:  [1.02492653e+02 2.98827933e-02]
mat_Sqrt:  [[ 1.77175363e+01  0.00000000e+00]
 [-6.91465612e-03  1.58434675e-02]]
grads:  [-0.00266083 -2.51569993]
Stock Position:  -0.002660833408722668
Bond Position:  [4.43972535]


portfolio before change:  [4.16804368]
curr_Stock_Price:  102.31256024457993
curr_Factors:  [1.02312560e+02 2.95489016e-02]
mat_Sqrt:  [[ 1.75873183e+01  0.00000000e+00]
 [-6.87591758e-03  1.57547064e-02]]
grads:  [-0.00853755  3.08117194]
Stock Position:  -0.008537546786586499
Bond Position:  [5.04154195]


portfolio before change:  [4.17348593]
curr_Stock_Price:  101.74892928944155
curr_Factors:  [1.01748929e+02 2.92323557e-02]
mat_Sqrt:  [[ 1.73964949e+01  0.00000000e+00]
 [-6.83898890e-03  1.56700922e-02]]
grads:  [8.2917214e-03 1.7439227e+01]
Stock Position:  0.008291721400484267
Bond Position:  [3.32981216]


portfolio before change:  [4.16989819]
curr_Stock_Price:  101.26603873169164
curr_Factors:  [1.01266039e+02 2.92788100e-02]
mat_Sqrt:  [[ 1.73276845e+01  0.00000000e+00]
 [-6.84442080e-03  1.56825382e-02]]
grads:  [3.52029413e-03 1.17958248e+01]
Stock Position:  0.003520294126824418
Bond Position:  [3.81341195]


portfolio before change:  [4.16516846]
curr_Stock_Price:  99.78706135376584
curr_Factors:  [9.97870614e+01 2.90982836e-02]
mat_Sqrt:  [[ 1.70218955e+01  0.00000000e+00]
 [-6.82328761e-03  1.56341160e-02]]
grads:  [-0.03327702 -7.09070539]
Stock Position:  -0.033277016685648385
Bond Position:  [7.48578417]


portfolio before change:  [4.20479425]
curr_Stock_Price:  98.62439702457065
curr_Factors:  [9.8624397e+01 2.9448903e-02]
mat_Sqrt:  [[ 1.69246198e+01  0.00000000e+00]
 [-6.86427307e-03  1.57280255e-02]]
grads:  [-0.01124275 -3.75515731]
Stock Position:  -0.011242749232145672
Bond Position:  [5.31360361]


portfolio before change:  [4.19217987]
curr_Stock_Price:  99.80547946889963
curr_Factors:  [9.98054795e+01 2.93292552e-02]
mat_Sqrt:  [[ 1.70924730e+01  0.00000000e+00]
 [-6.85031446e-03  1.56960423e-02]]
grads:  [-1.33219751e-03 -4.45732327e+00]
Stock Position:  -0.0013321975076157574
Bond Position:  [4.32514048]


portfolio before change:  [4.19283686]
curr_Stock_Price:  99.71817560011661
curr_Factors:  [9.97181756e+01 2.96380535e-02]
mat_Sqrt:  [[ 1.71671880e+01  0.00000000e+00]
 [-6.88628242e-03  1.57784552e-02]]
grads:  [-5.07998988e-03  9.57388440e+00]
Stock Position:  -0.005079989884848474
Bond Position:  [4.69940418]


portfolio before change:  [4.19486855]
curr_Stock_Price:  99.43387806774281
curr_Factors:  [9.94338781e+01 2.89085504e-02]
mat_Sqrt:  [[ 1.69062597e+01  0.00000000e+00]
 [-6.80100586e-03  1.55830621e-02]]
grads:  [0.0011771  0.98389093]
Stock Position:  0.0011771031520937578
Bond Position:  [4.07782462]


portfolio before change:  [4.1962139]
curr_Stock_Price:  100.14375194413128
curr_Factors:  [1.00143752e+02 2.81222910e-02]
mat_Sqrt:  [[ 1.67938089e+01  0.00000000e+00]
 [-6.70788085e-03  1.53696859e-02]]
grads:  [-4.00463276e-03  5.72298123e+00]
Stock Position:  -0.004004632760375275
Bond Position:  [4.59725285]


portfolio before change:  [4.1959278]
curr_Stock_Price:  100.35870253636004
curr_Factors:  [1.00358703e+02 2.78408869e-02]
mat_Sqrt:  [[ 1.67454403e+01  0.00000000e+00]
 [-6.67423547e-03  1.52925946e-02]]
grads:  [-0.00962636  5.99328517]
Stock Position:  -0.00962635536387232
Bond Position:  [5.16201633]


portfolio before change:  [4.20886047]
curr_Stock_Price:  99.08227159466192
curr_Factors:  [9.90822716e+01 2.78854790e-02]
mat_Sqrt:  [[ 1.65456948e+01  0.00000000e+00]
 [-6.67957831e-03  1.53048366e-02]]
grads:  [-5.3586068e-03 -8.3171065e+00]
Stock Position:  -0.005358606800859735
Bond Position:  [4.7398034]


portfolio before change:  [4.19848921]
curr_Stock_Price:  101.12828235279136
curr_Factors:  [1.01128282e+02 2.68097319e-02]
mat_Sqrt:  [[ 1.65584189e+01  0.00000000e+00]
 [-6.54947105e-03  1.50067234e-02]]
grads:  [ 4.87778810e-04 -1.82645334e+00]
Stock Position:  0.00048777880995173536
Bond Position:  [4.14916098]


portfolio before change:  [4.19837453]
curr_Stock_Price:  99.82981737296971
curr_Factors:  [9.98298174e+01 2.50886036e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.19837453]
Stock Price:  100.038993902782
PL:  [4.15938062]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.14856027e+00  2.88567680e-01]
 [-1.07287681e-02  1.79280571e-02]
 [ 1.10497312e-01 -2.30335461e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-7.82015611e-02  1.81993947e-01]
 [-1.33210554e-01 -5.83200223e-02]
 [ 1.31887918e-01 -7.85155336e-02]
 [-1.20990805e-01  3.56177940e-01]
 [-1.16459153e-01 -9.06659879e-02]
 [ 1.75972809e-01  4.29196228e-02]
 [-1.14275002e-01 -1.12180181e-05]
 [ 7.15125437e-02 -1.12244108e-01]
 [-1.19271979e-01 -2.55943474e-02]
 [-1.29635755e-01  2.94381071e-01]
 [ 5.02162333e-01  3.28418779e-01]
 [ 1.30908910e-01  6.17934574e-02]
 [ 3.97125080e-02  1.16545636e-01]
 [ 1.62233499e-03 -6.14467749e-02]
 [-4.66178477e-02 -3.13208503e-02]
 [-3.18935425e-01  1.14246237e-01]
 [ 1.69821887e-01 -3.34727933e-02]
 [ 8.51310208e-01 -1.31784021e-03]
 [ 2.63041464e-02 -2.02061255e-01]
 [ 3.73267091e-03  2.92237414e-02]
 [-4.39035165e-02  4.01077548e-02]
 [ 1.65257237e-01 -9.10104359e-02]
 [ 3.09559385e-02 -2.88874240e-01]
 [ 5.29225311e-02  2.18141228e-01]
 [-1.27341292e-02  1.81196579e-01]
 [-5.76300241e-01 -8.69227404e-02]
 [-1.68559076e-01 -6.38068490e-02]
 [ 1.42871862e-02 -6.36606837e-02]
 [-2.52649706e-01  3.12155736e-02]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.15966086e-01  1.09399258e-02]
 [-2.83095462e-02 -1.69175247e-01]
 [-8.88177198e-03 -6.45904553e-02]
 [ 1.77157022e-01 -1.55858449e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.96379867]
curr_Stock_Price:  100.76674575367268
curr_Factors:  [1.00766746e+02 3.71467463e-02]
mat_Sqrt:  [[ 1.94212699e+01  0.00000000e+00]
 [-7.70939647e-03  1.76644465e-02]]
grads:  [ 0.06562401 16.33607259]
Stock Position:  0.06562400591628535
Bond Position:  [1.35108115]


portfolio before change:  [7.97715389]
curr_Stock_Price:  100.9676832853807
curr_Factors:  [1.00967683e+02 3.51766991e-02]
mat_Sqrt:  [[ 1.89369457e+01  0.00000000e+00]
 [-7.50218092e-03  1.71896560e-02]]
grads:  [-1.53368056e-04  1.04295613e+00]
Stock Position:  -0.00015336805574902231
Bond Position:  [7.99263911]


portfolio before change:  [7.97829615]
curr_Stock_Price:  100.03455351161867
curr_Factors:  [1.00034554e+02 3.66763637e-02]
mat_Sqrt:  [[ 1.91576914e+01  0.00000000e+00]
 [-7.66042962e-03  1.75522493e-02]]
grads:  [ 0.00524305 -1.31228458]
Stock Position:  0.005243045546128522
Bond Position:  [7.45381043]


portfolio before change:  [7.98444069]
curr_Stock_Price:  101.02877800863368
curr_Factors:  [1.01028778e+02 3.65491167e-02]
mat_Sqrt:  [[ 1.93145032e+01  0.00000000e+00]
 [-7.64712931e-03  1.75217745e-02]]
grads:  [-8.43996180e-04 -8.63992473e+00]
Stock Position:  -0.0008439961804915598
Bond Position:  [8.0697086]


portfolio before change:  [7.98682434]
curr_Stock_Price:  99.3997771749122
curr_Factors:  [9.93997772e+01 3.65171149e-02]
mat_Sqrt:  [[ 1.89947525e+01  0.00000000e+00]
 [-7.64378073e-03  1.75141019e-02]]
grads:  [6.46025457e-05 1.03912806e+01]
Stock Position:  6.460254572026457e-05
Bond Position:  [7.98040286]


portfolio before change:  [7.98783411]
curr_Stock_Price:  99.58790072529446
curr_Factors:  [9.95879007e+01 3.72817041e-02]
mat_Sqrt:  [[ 1.92289006e+01  0.00000000e+00]
 [-7.72338828e-03  1.76965057e-02]]
grads:  [-0.0082513  -3.29556711]
Stock Position:  -0.008251303666236887
Bond Position:  [8.80956412]


portfolio before change:  [7.97690614]
curr_Stock_Price:  101.04575956586426
curr_Factors:  [1.01045760e+02 3.75267566e-02]
mat_Sqrt:  [[ 1.95744067e+01  0.00000000e+00]
 [-7.74872961e-03  1.77545700e-02]]
grads:  [ 0.00498717 -4.42227177]
Stock Position:  0.004987171831686953
Bond Position:  [7.47297357]


portfolio before change:  [7.98025506]
curr_Stock_Price:  101.52994993848785
curr_Factors:  [1.01529950e+02 3.75020456e-02]
mat_Sqrt:  [[ 1.96617265e+01  0.00000000e+00]
 [-7.74617796e-03  1.77487234e-02]]
grads:  [1.75254151e-03 2.00678061e+01]
Stock Position:  0.0017525415086570965
Bond Position:  [7.80231961]


portfolio before change:  [7.98066396]
curr_Stock_Price:  101.2067358759194
curr_Factors:  [1.01206736e+02 3.82089007e-02]
mat_Sqrt:  [[ 1.97829790e+01  0.00000000e+00]
 [-7.81883886e-03  1.79152105e-02]]
grads:  [-0.00788703 -5.06083856]
Stock Position:  -0.00788703432782507
Bond Position:  [8.77888496]


portfolio before change:  [7.98672377]
curr_Stock_Price:  100.57755459898625
curr_Factors:  [1.00577555e+02 3.94854715e-02]
mat_Sqrt:  [[ 1.99857171e+01  0.00000000e+00]
 [-7.94838061e-03  1.82120279e-02]]
grads:  [0.00974218 2.35666358]
Stock Position:  0.009742180730827821
Bond Position:  [7.00687905]


portfolio before change:  [7.97656004]
curr_Stock_Price:  99.44437531975684
curr_Factors:  [9.94443753e+01 4.13238374e-02]
mat_Sqrt:  [[ 2.02153165e+01  0.00000000e+00]
 [-8.13130616e-03  1.86311630e-02]]
grads:  [-0.00565313 -0.00060211]
Stock Position:  -0.005653134226127923
Bond Position:  [8.53873244]


portfolio before change:  [7.99218303]
curr_Stock_Price:  96.86959454819343
curr_Factors:  [9.68695945e+01 4.07676641e-02]
mat_Sqrt:  [[ 1.95589437e+01  0.00000000e+00]
 [-8.07640158e-03  1.85053608e-02]]
grads:  [ 1.15165723e-03 -6.06549146e+00]
Stock Position:  0.0011516572286280528
Bond Position:  [7.88062246]


portfolio before change:  [7.99245083]
curr_Stock_Price:  96.24671530302903
curr_Factors:  [9.62467153e+01 4.08065637e-02]
mat_Sqrt:  [[ 1.94424472e+01  0.00000000e+00]
 [-8.08025383e-03  1.85141874e-02]]
grads:  [-0.00670915 -1.38241808]
Stock Position:  -0.006709148610332526
Bond Position:  [8.63818434]


portfolio before change:  [7.9955645]
curr_Stock_Price:  95.94357162000104
curr_Factors:  [9.59435716e+01 4.14635865e-02]
mat_Sqrt:  [[ 1.95366148e+01  0.00000000e+00]
 [-8.14504380e-03  1.86626399e-02]]
grads:  [-5.92386405e-05  1.57738173e+01]
Stock Position:  -5.923864054018449e-05
Bond Position:  [8.00124807]


portfolio before change:  [7.99642978]
curr_Stock_Price:  98.22144408459859
curr_Factors:  [9.82214441e+01 4.09562399e-02]
mat_Sqrt:  [[ 1.98777102e+01  0.00000000e+00]
 [-8.09505923e-03  1.85481108e-02]]
grads:  [ 0.03247336 17.70631964]
Stock Position:  0.03247336002345535
Bond Position:  [4.80684947]


portfolio before change:  [7.96257105]
curr_Stock_Price:  97.16027786821495
curr_Factors:  [9.71602779e+01 4.01820740e-02]
mat_Sqrt:  [[ 1.94762313e+01  0.00000000e+00]
 [-8.01818673e-03  1.83719738e-02]]
grads:  [0.00810618 3.36346317]
Stock Position:  0.008106177419240763
Bond Position:  [7.1749726]


portfolio before change:  [7.97328381]
curr_Stock_Price:  98.37118570160551
curr_Factors:  [9.83711857e+01 3.94377973e-02]
mat_Sqrt:  [[ 1.95354865e+01  0.00000000e+00]
 [-7.94358079e-03  1.82010301e-02]]
grads:  [4.63654659e-03 6.40324392e+00]
Stock Position:  0.004636546588647944
Bond Position:  [7.51718122]


portfolio before change:  [7.98072902]
curr_Stock_Price:  99.77427942976169
curr_Factors:  [9.97742794e+01 3.79662192e-02]
mat_Sqrt:  [[ 1.94409407e+01  0.00000000e+00]
 [-7.79396886e-03  1.78582261e-02]]
grads:  [-1.29598853e-03 -3.44081066e+00]
Stock Position:  -0.0012959885324232664
Bond Position:  [8.11003535]


portfolio before change:  [7.98328618]
curr_Stock_Price:  98.5834226698046
curr_Factors:  [9.85834227e+01 3.76791197e-02]
mat_Sqrt:  [[ 1.91361368e+01  0.00000000e+00]
 [-7.76444406e-03  1.77905763e-02]]
grads:  [-0.00315045 -1.76053039]
Stock Position:  -0.0031504471454933455
Bond Position:  [8.29386804]


portfolio before change:  [7.98862592]
curr_Stock_Price:  97.21760316889873
curr_Factors:  [9.72176032e+01 3.84103803e-02]
mat_Sqrt:  [[ 1.90532565e+01  0.00000000e+00]
 [-7.83942654e-03  1.79623828e-02]]
grads:  [-0.01412222  6.36030523]
Stock Position:  -0.014122220017139173
Bond Position:  [9.3615543]


portfolio before change:  [7.9711968]
curr_Stock_Price:  98.53463285555709
curr_Factors:  [9.85346329e+01 3.67430136e-02]
mat_Sqrt:  [[ 1.88875788e+01  0.00000000e+00]
 [-7.66738689e-03  1.75681904e-02]]
grads:  [ 0.00821774 -1.90530684]
Stock Position:  0.008217737404930824
Bond Position:  [7.16146506]


portfolio before change:  [7.98234199]
curr_Stock_Price:  99.78192866319793
curr_Factors:  [9.97819287e+01 3.69191707e-02]
mat_Sqrt:  [[ 1.91724610e+01  0.00000000e+00]
 [-7.68574480e-03  1.76102537e-02]]
grads:  [ 0.04437276 -0.07483369]
Stock Position:  0.04437276240893521
Bond Position:  [3.55474218]


portfolio before change:  [7.99993836]
curr_Stock_Price:  100.16847215544107
curr_Factors:  [1.00168472e+02 3.71655074e-02]
mat_Sqrt:  [[ 1.93108363e+01  0.00000000e+00]
 [-7.71134306e-03  1.76689067e-02]]
grads:  [-3.20455387e-03 -1.14359796e+01]
Stock Position:  -0.0032045538692709917
Bond Position:  [8.32093363]


portfolio before change:  [8.00057865]
curr_Stock_Price:  100.29326138755748
curr_Factors:  [1.00293261e+02 3.72790842e-02]
mat_Sqrt:  [[ 1.93644146e+01  0.00000000e+00]
 [-7.72311691e-03  1.76958839e-02]]
grads:  [8.51404891e-04 1.65144287e+00]
Stock Position:  0.0008514048914397345
Bond Position:  [7.91518848]


portfolio before change:  [8.00039737]
curr_Stock_Price:  98.9181918038318
curr_Factors:  [9.89181918e+01 3.64748491e-02]
mat_Sqrt:  [[ 1.88917818e+01  0.00000000e+00]
 [-7.63935589e-03  1.75039633e-02]]
grads:  [-1.39738313e-03  2.29135276e+00]
Stock Position:  -0.0013973831326246744
Bond Position:  [8.13862398]


portfolio before change:  [7.99947844]
curr_Stock_Price:  100.30386799535734
curr_Factors:  [1.00303868e+02 3.54666667e-02]
mat_Sqrt:  [[ 1.88898221e+01  0.00000000e+00]
 [-7.53303834e-03  1.72603592e-02]]
grads:  [ 0.00664575 -5.2728008 ]
Stock Position:  0.006645749527679243
Bond Position:  [7.33288406]


portfolio before change:  [7.99336635]
curr_Stock_Price:  99.24623539943592
curr_Factors:  [9.92462354e+01 3.48343983e-02]
mat_Sqrt:  [[ 1.85232931e+01  0.00000000e+00]
 [-7.46559022e-03  1.71058161e-02]]
grads:  [-5.13510828e-03 -1.68874865e+01]
Stock Position:  -0.005135108280691567
Bond Position:  [8.50300651]


portfolio before change:  [7.98780117]
curr_Stock_Price:  100.53698152828306
curr_Factors:  [1.00536982e+02 3.33412769e-02]
mat_Sqrt:  [[ 1.83576445e+01  0.00000000e+00]
 [-7.30383756e-03  1.67351942e-02]]
grads:  [8.06896375e-03 1.30348788e+01]
Stock Position:  0.008068963754065704
Bond Position:  [7.17657191]


portfolio before change:  [7.99027544]
curr_Stock_Price:  100.73243900785565
curr_Factors:  [1.00732439e+02 3.18294952e-02]
mat_Sqrt:  [[ 1.79714958e+01  0.00000000e+00]
 [-7.13632905e-03  1.63513840e-02]]
grads:  [3.69176511e-03 1.10814215e+01]
Stock Position:  0.0036917651103712144
Bond Position:  [7.61839493]


portfolio before change:  [7.99372393]
curr_Stock_Price:  101.40857410441518
curr_Factors:  [1.01408574e+02 3.13049107e-02]
mat_Sqrt:  [[ 1.79424155e+01  0.00000000e+00]
 [-7.07727752e-03  1.62160800e-02]]
grads:  [-0.03423376 -5.36028069]
Stock Position:  -0.034233764873783934
Bond Position:  [11.46532121]


portfolio before change:  [8.00390767]
curr_Stock_Price:  101.1529643035672
curr_Factors:  [1.01152964e+02 3.14530247e-02]
mat_Sqrt:  [[ 1.79394788e+01  0.00000000e+00]
 [-7.09400024e-03  1.62543965e-02]]
grads:  [-0.01094829 -3.92551325]
Stock Position:  -0.010948292834937572
Bond Position:  [9.11135994]


portfolio before change:  [8.00089091]
curr_Stock_Price:  101.53254364596116
curr_Factors:  [1.01532544e+02 3.05256077e-02]
mat_Sqrt:  [[ 1.77393387e+01  0.00000000e+00]
 [-6.98863165e-03  1.60129668e-02]]
grads:  [-7.60829599e-04 -3.97557084e+00]
Stock Position:  -0.0007608295990583804
Bond Position:  [8.07813988]


portfolio before change:  [7.99984609]
curr_Stock_Price:  104.2330901211418
curr_Factors:  [1.04233090e+02 3.00254961e-02]
mat_Sqrt:  [[ 1.80613708e+01  0.00000000e+00]
 [-6.93114664e-03  1.58812521e-02]]
grads:  [-0.01323411  1.96556125]
Stock Position:  -0.013234106962411623
Bond Position:  [9.37927795]


portfolio before change:  [8.00751305]
curr_Stock_Price:  103.74235200002335
curr_Factors:  [1.03742352e+02 2.99572052e-02]
mat_Sqrt:  [[ 1.79558818e+01  0.00000000e+00]
 [-6.92325995e-03  1.58631814e-02]]
grads:  [0.00565114 3.36307451]
Stock Position:  0.0056511383330438356
Bond Position:  [7.42125067]


portfolio before change:  [8.00945641]
curr_Stock_Price:  103.92207502463856
curr_Factors:  [1.03922075e+02 3.04915386e-02]
mat_Sqrt:  [[ 1.81466925e+01  0.00000000e+00]
 [-6.98473062e-03  1.60040284e-02]]
grads:  [-0.0052168   5.08154223]
Stock Position:  -0.00521679699113979
Bond Position:  [8.55159677]


portfolio before change:  [8.00997147]
curr_Stock_Price:  104.02826083669943
curr_Factors:  [1.04028261e+02 3.15052021e-02]
mat_Sqrt:  [[ 1.84647092e+01  0.00000000e+00]
 [-7.09988193e-03  1.62678732e-02]]
grads:  [-0.01685331  0.67248654]
Stock Position:  -0.01685331228764654
Bond Position:  [9.76319224]


portfolio before change:  [7.99599373]
curr_Stock_Price:  104.93005470886006
curr_Factors:  [1.04930055e+02 3.12112972e-02]
mat_Sqrt:  [[ 1.85376983e+01  0.00000000e+00]
 [-7.06668773e-03  1.61918157e-02]]
grads:  [-5.51005178e-03 -1.04481950e+01]
Stock Position:  -0.005510051783069884
Bond Position:  [8.57416377]


portfolio before change:  [7.99333199]
curr_Stock_Price:  105.60764858699781
curr_Factors:  [1.05607649e+02 3.15582289e-02]
mat_Sqrt:  [[ 1.87608143e+01  0.00000000e+00]
 [-7.10585437e-03  1.62815578e-02]]
grads:  [-1.97599940e-03 -3.96709309e+00]
Stock Position:  -0.0019759993996830414
Bond Position:  [8.20201264]


portfolio before change:  [7.99358195]
curr_Stock_Price:  106.00003640698087
curr_Factors:  [1.06000036e+02 3.22899598e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.99358195]
Stock Price:  107.31951155417987
PL:  [0.6740704]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.50138070e+00  3.68333310e-01]
 [ 1.19681575e+00  5.91197061e-02]
 [ 1.12725232e-01 -4.49770634e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.22821025e-02  4.77444944e-01]
 [ 4.94750670e-03 -7.50468718e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.16638437e-01  8.08384707e-01]
 [ 3.08375795e-02  4.14731433e-01]
 [ 1.87098965e-01  9.53517982e-02]
 [-5.50362011e-02  1.46005617e-02]
 [ 3.43287128e-02 -1.37558783e-01]
 [-1.18525225e-01 -2.63295882e-02]
 [-1.32157537e-01  3.40525973e-01]
 [ 2.55458172e-01  2.09024567e-01]
 [ 1.32461460e-01 -8.32340381e-02]
 [ 3.85267305e-02  6.05825528e-03]
 [ 3.25287623e-01  6.50471107e-02]
 [ 2.85844121e-01  2.96456948e-01]
 [-6.70734499e-01  3.14167701e-01]
 [ 1.18762422e-01  4.98683094e-02]
 [ 1.50987401e+00  1.73886083e-01]
 [ 1.59693731e-02  4.17405669e-01]
 [-1.42110005e-01  1.47273071e-01]
 [-2.01704539e-01  1.38595228e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 2.89691167e-01 -4.32958239e-01]
 [ 1.05900698e-01 -2.31929863e-02]
 [ 6.15265708e-01 -3.10081653e-01]
 [-6.54482470e-01 -3.26185263e-01]
 [ 2.68846022e-01  1.02387774e-01]
 [-1.24257700e-01  1.66580807e-01]
 [ 5.00874992e-01  2.30418924e-01]
 [ 2.46122380e-02 -8.85130971e-03]
 [ 1.38768200e-01 -7.35769199e-02]
 [ 5.61254903e-02  1.04568929e-01]
 [-5.07847998e-02  9.00472761e-02]
 [-2.49290210e-01 -9.88686864e-02]
 [ 1.27877431e-01 -5.93852412e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.96027696]
curr_Stock_Price:  99.18106193603438
curr_Factors:  [9.91810619e+01 4.09913419e-02]
mat_Sqrt:  [[ 2.00805138e+01  0.00000000e+00]
 [-8.09852746e-03  1.85560576e-02]]
grads:  [ 0.08277351 19.84976113]
Stock Position:  0.08277350616359191
Bond Position:  [-11.1698412]


portfolio before change:  [-3.05954412]
curr_Stock_Price:  97.99866855255408
curr_Factors:  [9.79986686e+01 4.12790737e-02]
mat_Sqrt:  [[ 1.99106366e+01  0.00000000e+00]
 [-8.12690088e-03  1.86210692e-02]]
grads:  [0.06140525 3.17488246]
Stock Position:  0.06140525424284692
Bond Position:  [-9.07717728]


portfolio before change:  [-2.96392712]
curr_Stock_Price:  99.57429474749807
curr_Factors:  [9.95742947e+01 3.96275003e-02]
mat_Sqrt:  [[ 1.98219136e+01  0.00000000e+00]
 [-7.96266290e-03  1.82447527e-02]]
grads:  [ 0.0046966  -2.46520542]
Stock Position:  0.004696601675609867
Bond Position:  [-3.43158792]


portfolio before change:  [-2.96639296]
curr_Stock_Price:  99.1406054694427
curr_Factors:  [9.91406055e+01 3.91088893e-02]
mat_Sqrt:  [[ 1.96060140e+01  0.00000000e+00]
 [-7.91038703e-03  1.81249737e-02]]
grads:  [-8.31447278e-04 -8.35238799e+00]
Stock Position:  -0.0008314472778917523
Bond Position:  [-2.88396277]


portfolio before change:  [-2.96601627]
curr_Stock_Price:  98.25395734834412
curr_Factors:  [9.82539573e+01 3.80419309e-02]
mat_Sqrt:  [[ 1.91637867e+01  0.00000000e+00]
 [-7.80173631e-03  1.78760236e-02]]
grads:  [6.05788179e-03 2.67086772e+01]
Stock Position:  0.006057881793853463
Bond Position:  [-3.56122713]


portfolio before change:  [-2.97042667]
curr_Stock_Price:  97.59940305580197
curr_Factors:  [9.75994031e+01 3.83900140e-02]
mat_Sqrt:  [[ 1.91230120e+01  0.00000000e+00]
 [-7.83734792e-03  1.79576200e-02]]
grads:  [-1.45404047e-03 -4.17911013e+00]
Stock Position:  -0.0014540404738159587
Bond Position:  [-2.82851318]


portfolio before change:  [-2.9715789]
curr_Stock_Price:  98.1486628907596
curr_Factors:  [9.81486629e+01 4.06726184e-02]
mat_Sqrt:  [[ 1.97940860e+01  0.00000000e+00]
 [-8.06698143e-03  1.84837765e-02]]
grads:  [0.00653598 5.20114961]
Stock Position:  0.00653598135619465
Bond Position:  [-3.61307673]


portfolio before change:  [-2.97264649]
curr_Stock_Price:  98.05442684811925
curr_Factors:  [9.80544268e+01 4.12633716e-02]
mat_Sqrt:  [[ 1.99181758e+01  0.00000000e+00]
 [-8.12535505e-03  1.86175273e-02]]
grads:  [ 0.05871253 43.42062697]
Stock Position:  0.05871252766260821
Bond Position:  [-8.72966974]


portfolio before change:  [-3.03387084]
curr_Stock_Price:  97.03023191261423
curr_Factors:  [9.70302319e+01 4.17013150e-02]
mat_Sqrt:  [[ 1.98144465e+01  0.00000000e+00]
 [-8.16835993e-03  1.87160638e-02]]
grads:  [1.06912508e-02 2.21591162e+01]
Stock Position:  0.0106912507791972
Bond Position:  [-4.07124538]


portfolio before change:  [-3.0386845]
curr_Stock_Price:  96.62759231396272
curr_Factors:  [9.66275923e+01 4.08673983e-02]
mat_Sqrt:  [[ 1.95339312e+01  0.00000000e+00]
 [-8.08627462e-03  1.85279828e-02]]
grads:  [0.01170854 5.14636695]
Stock Position:  0.011708544448471879
Bond Position:  [-4.17005296]


portfolio before change:  [-3.02910304]
curr_Stock_Price:  97.49044427025676
curr_Factors:  [9.74904443e+01 4.15429411e-02]
mat_Sqrt:  [[ 1.98705857e+01  0.00000000e+00]
 [-8.15283421e-03  1.86804900e-02]]
grads:  [-0.00244905  0.78159415]
Stock Position:  -0.0024490467580005567
Bond Position:  [-2.79034439]


portfolio before change:  [-3.03097181]
curr_Stock_Price:  98.11107401733554
curr_Factors:  [9.81110740e+01 4.12418704e-02]
mat_Sqrt:  [[ 1.99244897e+01  0.00000000e+00]
 [-8.12323781e-03  1.86126761e-02]]
grads:  [-1.29021433e-03 -7.39059673e+00]
Stock Position:  -0.0012902143278271869
Bond Position:  [-2.9043875]


portfolio before change:  [-3.0297846]
curr_Stock_Price:  96.90950481056181
curr_Factors:  [9.69095048e+01 4.34081417e-02]
mat_Sqrt:  [[ 2.01907277e+01  0.00000000e+00]
 [-8.33384825e-03  1.90952452e-02]]
grads:  [-0.00643941 -1.37885572]
Stock Position:  -0.0064394112830522526
Bond Position:  [-2.40574444]


portfolio before change:  [-3.02051867]
curr_Stock_Price:  95.42386110712695
curr_Factors:  [9.54238611e+01 4.41850141e-02]
mat_Sqrt:  [[ 2.00583167e+01  0.00000000e+00]
 [-8.40809269e-03  1.92653606e-02]]
grads:  [8.20616319e-04 1.76755567e+01]
Stock Position:  0.0008206163190907363
Bond Position:  [-3.09882504]


portfolio before change:  [-3.02120303]
curr_Stock_Price:  95.0619507885534
curr_Factors:  [9.50619508e+01 4.41136012e-02]
mat_Sqrt:  [[ 1.99660879e+01  0.00000000e+00]
 [-8.40129525e-03  1.92497857e-02]]
grads:  [ 0.01736364 10.85853993]
Stock Position:  0.01736364046671122
Bond Position:  [-4.67182457]


portfolio before change:  [-3.02287438]
curr_Stock_Price:  94.99932929195637
curr_Factors:  [9.49993293e+01 4.44321380e-02]
mat_Sqrt:  [[ 2.00248441e+01  0.00000000e+00]
 [-8.43157285e-03  1.93191604e-02]]
grads:  [ 0.00480079 -4.30836726]
Stock Position:  0.004800793810267047
Bond Position:  [-3.47894658]


portfolio before change:  [-3.02772462]
curr_Stock_Price:  94.07961895976855
curr_Factors:  [9.40796190e+01 4.32611864e-02]
mat_Sqrt:  [[ 1.95679244e+01  0.00000000e+00]
 [-8.31972945e-03  1.90628950e-02]]
grads:  [0.00210399 0.31780353]
Stock Position:  0.002103992685257769
Bond Position:  [-3.22566745]


portfolio before change:  [-3.0294762]
curr_Stock_Price:  93.43876635493541
curr_Factors:  [9.34387664e+01 4.49428365e-02]
mat_Sqrt:  [[ 1.98087621e+01  0.00000000e+00]
 [-8.47989023e-03  1.94298694e-02]]
grads:  [0.01785455 3.34778939]
Stock Position:  0.017854548862190307
Bond Position:  [-4.69778322]


portfolio before change:  [-3.02836997]
curr_Stock_Price:  93.53361594319678
curr_Factors:  [9.35336159e+01 4.58000500e-02]
mat_Sqrt:  [[ 2.00170789e+01  0.00000000e+00]
 [-8.56037850e-03  1.96142912e-02]]
grads:  [ 0.02074371 15.11433399]
Stock Position:  0.020743713090075284
Bond Position:  [-4.96860446]


portfolio before change:  [-3.02865037]
curr_Stock_Price:  93.55004071172105
curr_Factors:  [9.35500407e+01 4.62459148e-02]
mat_Sqrt:  [[ 2.01178084e+01  0.00000000e+00]
 [-8.60194534e-03  1.97095328e-02]]
grads:  [-0.02652478 15.93988571]
Stock Position:  -0.026524781539301007
Bond Position:  [-0.54725598]


portfolio before change:  [-3.09888]
curr_Stock_Price:  96.19516021187405
curr_Factors:  [9.61951602e+01 4.56244845e-02]
mat_Sqrt:  [[ 2.05471792e+01  0.00000000e+00]
 [-8.54395548e-03  1.95766614e-02]]
grads:  [0.00683922 2.54733473]
Stock Position:  0.00683922283410955
Bond Position:  [-3.75678013]


portfolio before change:  [-3.10652044]
curr_Stock_Price:  95.14667584022573
curr_Factors:  [9.51466758e+01 4.64257844e-02]
mat_Sqrt:  [[ 2.05009150e+01  0.00000000e+00]
 [-8.61865738e-03  1.97478249e-02]]
grads:  [0.07735089 8.80532835]
Stock Position:  0.07735089490276459
Bond Position:  [-10.46620097]


portfolio before change:  [-3.07098302]
curr_Stock_Price:  95.62302170648404
curr_Factors:  [9.56230217e+01 4.75515501e-02]
mat_Sqrt:  [[ 2.08518601e+01  0.00000000e+00]
 [-8.72252716e-03  1.99858205e-02]]
grads:  [9.50227658e-03 2.08850905e+01]
Stock Position:  0.009502276577431041
Bond Position:  [-3.97961942]


portfolio before change:  [-3.07601313]
curr_Stock_Price:  95.14601698643231
curr_Factors:  [9.5146017e+01 4.8620590e-02]
mat_Sqrt:  [[ 2.09797701e+01  0.00000000e+00]
 [-8.82003084e-03  2.02092295e-02]]
grads:  [-3.70999141e-03  7.28741643e+00]
Stock Position:  -0.003709991410285227
Bond Position:  [-2.72302223]


portfolio before change:  [-3.07747516]
curr_Stock_Price:  95.44834270047383
curr_Factors:  [9.54483427e+01 4.95999586e-02]
mat_Sqrt:  [[ 2.12573464e+01  0.00000000e+00]
 [-8.90841927e-03  2.04117528e-02]]
grads:  [-6.64319152e-03  6.78997188e+00]
Stock Position:  -0.006643191519698797
Bond Position:  [-2.44339354]


portfolio before change:  [-3.0677836]
curr_Stock_Price:  93.94349375300715
curr_Factors:  [9.39434938e+01 5.10811747e-02]
mat_Sqrt:  [[ 2.12323051e+01  0.00000000e+00]
 [-9.04045792e-03  2.07142914e-02]]
grads:  [ 0.00864148 -3.52392152]
Stock Position:  0.008641482975073276
Bond Position:  [-3.87959471]


portfolio before change:  [-3.0823399]
curr_Stock_Price:  92.3151487240502
curr_Factors:  [9.23151487e+01 5.13259365e-02]
mat_Sqrt:  [[ 2.09142076e+01  0.00000000e+00]
 [-9.06209128e-03  2.07638596e-02]]
grads:  [ 4.81647223e-03 -2.08515299e+01]
Stock Position:  0.004816472227186679
Bond Position:  [-3.52697325]


portfolio before change:  [-3.07893462]
curr_Stock_Price:  93.11369491774333
curr_Factors:  [9.31136949e+01 5.07635523e-02]
mat_Sqrt:  [[ 2.09792309e+01  0.00000000e+00]
 [-9.01230735e-03  2.06497903e-02]]
grads:  [ 0.00456539 -1.12315844]
Stock Position:  0.004565393728954721
Bond Position:  [-3.5040353]


portfolio before change:  [-3.08032599]
curr_Stock_Price:  92.90487687261698
curr_Factors:  [9.29048769e+01 4.88868594e-02]
mat_Sqrt:  [[ 2.05416148e+01  0.00000000e+00]
 [-8.84414919e-03  2.02644916e-02]]
grads:  [  0.02336403 -15.30172379]
Stock Position:  0.02336403368892983
Bond Position:  [-5.25095866]


portfolio before change:  [-3.1026299]
curr_Stock_Price:  91.9783461012468
curr_Factors:  [9.19783461e+01 5.07182575e-02]
mat_Sqrt:  [[ 2.07141806e+01  0.00000000e+00]
 [-9.00828574e-03  2.06405756e-02]]
grads:  [ -0.0384684  -15.80310882]
Stock Position:  -0.038468400252065375
Bond Position:  [0.43562993]


portfolio before change:  [-3.15261047]
curr_Stock_Price:  93.27902491368143
curr_Factors:  [9.32790249e+01 4.97205007e-02]
mat_Sqrt:  [[ 2.07994449e+01  0.00000000e+00]
 [-8.91923770e-03  2.04365409e-02]]
grads:  [0.01507404 5.01003446]
Stock Position:  0.015074042229747307
Bond Position:  [-4.55870243]


portfolio before change:  [-3.14273486]
curr_Stock_Price:  93.97197041572151
curr_Factors:  [9.39719704e+01 4.79872704e-02]
mat_Sqrt:  [[ 2.05854970e+01  0.00000000e+00]
 [-8.76239879e-03  2.00771779e-02]]
grads:  [-2.50447563e-03  8.29702302e+00]
Stock Position:  -0.0025044756345320718
Bond Position:  [-2.90738435]


portfolio before change:  [-3.14124761]
curr_Stock_Price:  93.233015238413
curr_Factors:  [9.32330152e+01 4.94379144e-02]
mat_Sqrt:  [[ 2.07300238e+01  0.00000000e+00]
 [-8.89385535e-03  2.03783827e-02]]
grads:  [ 0.0290129  11.30702703]
Stock Position:  0.029012897468793424
Bond Position:  [-5.84620752]


portfolio before change:  [-3.05925752]
curr_Stock_Price:  96.08419223144199
curr_Factors:  [9.60841922e+01 4.83087023e-02]
mat_Sqrt:  [[ 2.11185759e+01  0.00000000e+00]
 [-8.79169629e-03  2.01443069e-02]]
grads:  [ 0.00098251 -0.4393951 ]
Stock Position:  0.0009825098901402982
Bond Position:  [-3.15366119]


portfolio before change:  [-3.05900475]
curr_Stock_Price:  96.74271520878469
curr_Factors:  [9.67427152e+01 4.60579434e-02]
mat_Sqrt:  [[ 2.07620649e+01  0.00000000e+00]
 [-8.58444579e-03  1.96694363e-02]]
grads:  [ 0.00513709 -3.74067252]
Stock Position:  0.005137090174132506
Bond Position:  [-3.5559808]


portfolio before change:  [-3.06634571]
curr_Stock_Price:  95.40023749484351
curr_Factors:  [9.54002375e+01 4.66045277e-02]
mat_Sqrt:  [[ 2.05950813e+01  0.00000000e+00]
 [-8.63523273e-03  1.97858038e-02]]
grads:  [4.94113671e-03 5.28504831e+00]
Stock Position:  0.004941136711515891
Bond Position:  [-3.53773132]


portfolio before change:  [-3.06586156]
curr_Stock_Price:  95.58772325592152
curr_Factors:  [9.55877233e+01 4.65327111e-02]
mat_Sqrt:  [[ 2.06196503e+01  0.00000000e+00]
 [-8.62857681e-03  1.97705532e-02]]
grads:  [-5.56990365e-04  4.55461591e+00]
Stock Position:  -0.000556990365009563
Bond Position:  [-3.01262012]


portfolio before change:  [-3.06651691]
curr_Stock_Price:  96.08818082749725
curr_Factors:  [9.60881808e+01 4.53964547e-02]
mat_Sqrt:  [[ 2.04729742e+01  0.00000000e+00]
 [-8.52257751e-03  1.95276783e-02]]
grads:  [-0.0142842  -5.06300262]
Stock Position:  -0.014284199213910597
Bond Position:  [-1.69397419]


portfolio before change:  [-3.06751443]
curr_Stock_Price:  96.1431902726761
curr_Factors:  [9.61431903e+01 4.73992299e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.06751443]
Stock Price:  96.45536638140813
PL:  [-3.06751443]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.09384749e+00  2.76198216e-01]
 [-2.67175626e-01 -9.98573093e-02]
 [-4.60618191e-01 -1.70118423e-01]
 [ 4.68282268e-02 -1.50732225e-01]
 [-1.24691328e-01 -7.25432477e-01]
 [-4.09524610e-01  2.53337363e-01]
 [ 2.25807136e-01 -2.47110978e-01]
 [ 3.46904157e-01  4.83786073e-01]
 [-5.55322641e-02  1.58874866e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-1.12343978e-01 -6.51957375e-04]
 [ 2.56629117e-02 -1.33722520e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-4.47578950e-02 -3.65510982e-02]
 [ 4.97551230e-01  3.25096418e-01]
 [ 1.34737202e-01 -3.70095852e-01]
 [ 3.74004828e-02 -3.49529955e-02]
 [ 2.77157021e-02 -1.48822211e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 3.65778701e-02 -1.05470520e-01]
 [ 1.36701146e-01 -2.70314465e-02]
 [ 3.66228012e-01 -3.65410748e-01]
 [ 2.71008800e-02 -3.31742558e-01]
 [ 2.42219370e-02  9.36625761e-02]
 [ 4.30908215e-01 -3.73140228e-01]
 [-3.92915735e-01  4.95975535e-02]
 [-1.36322068e-01  1.56255347e-01]
 [-5.85230395e-02  3.45487425e-02]
 [-7.82317766e-02  2.11691487e-01]
 [-5.90903111e-01  4.60587061e-01]
 [-1.08040755e-01  4.88132889e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.02770752e-01 -1.15166883e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.35496460e-01 -1.06502007e-01]
 [-3.28350171e-02 -1.27271761e-01]
 [ 1.35032327e-02 -6.33111886e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.67240426]
curr_Stock_Price:  101.01475833794797
curr_Factors:  [1.01014758e+02 4.00021396e-02]
mat_Sqrt:  [[ 2.02034920e+01  0.00000000e+00]
 [-8.00021395e-03  1.83307930e-02]]
grads:  [ 0.06010794 15.06744504]
Stock Position:  0.060107939401994916
Bond Position:  [3.60061528]


portfolio before change:  [9.73687812]
curr_Stock_Price:  102.07990482278655
curr_Factors:  [1.02079905e+02 3.95307456e-02]
mat_Sqrt:  [[ 2.02958741e+01  0.00000000e+00]
 [-7.95293613e-03  1.82224659e-02]]
grads:  [-0.01531134 -5.47990101]
Stock Position:  -0.015311335092749418
Bond Position:  [11.29985775]


portfolio before change:  [9.73010421]
curr_Stock_Price:  102.61457274682768
curr_Factors:  [1.02614573e+02 4.13563485e-02]
mat_Sqrt:  [[ 2.08679667e+01  0.00000000e+00]
 [-8.13450414e-03  1.86384905e-02]]
grads:  [-0.02563086 -9.12726398]
Stock Position:  -0.02563086124341929
Bond Position:  [12.36020409]


portfolio before change:  [9.73511733]
curr_Stock_Price:  102.47926708883028
curr_Factors:  [1.02479267e+02 4.18340588e-02]
mat_Sqrt:  [[ 2.09604698e+01  0.00000000e+00]
 [-8.18135038e-03  1.87458287e-02]]
grads:  [-9.04402899e-04 -8.04084087e+00]
Stock Position:  -0.0009044028991358633
Bond Position:  [9.82779988]


portfolio before change:  [9.73522798]
curr_Stock_Price:  103.71533815288663
curr_Factors:  [1.03715338e+02 4.07692711e-02]
mat_Sqrt:  [[ 2.09415808e+01  0.00000000e+00]
 [-8.07656076e-03  1.85057255e-02]]
grads:  [-2.10727176e-02 -3.92004343e+01]
Stock Position:  -0.02107271758501992
Bond Position:  [11.92079201]


portfolio before change:  [9.75006771]
curr_Stock_Price:  103.0818395209786
curr_Factors:  [1.03081840e+02 4.07176028e-02]
mat_Sqrt:  [[ 2.08004754e+01  0.00000000e+00]
 [-8.07144129e-03  1.84939953e-02]]
grads:  [-0.01437271 13.69835768]
Stock Position:  -0.014372706106616933
Bond Position:  [11.23163269]


portfolio before change:  [9.76380907]
curr_Stock_Price:  102.22345407964046
curr_Factors:  [1.02223454e+02 4.17207089e-02]
mat_Sqrt:  [[ 2.08798027e+01  0.00000000e+00]
 [-8.17025912e-03  1.87204154e-02]]
grads:  [ 5.64943379e-03 -1.32000798e+01]
Stock Position:  0.005649433794360303
Bond Position:  [9.18630444]


portfolio before change:  [9.75364483]
curr_Stock_Price:  100.22102334020659
curr_Factors:  [1.00221023e+02 4.37023741e-02]
mat_Sqrt:  [[ 2.09513180e+01  0.00000000e+00]
 [-8.36204512e-03  1.91598524e-02]]
grads:  [ 0.02663535 25.24998961]
Stock Position:  0.026635351083248205
Bond Position:  [7.08422269]


portfolio before change:  [9.73375291]
curr_Stock_Price:  99.44095093293343
curr_Factors:  [9.94409509e+01 4.39840320e-02]
mat_Sqrt:  [[ 2.08551246e+01  0.00000000e+00]
 [-8.38894816e-03  1.92214950e-02]]
grads:  [6.62015332e-04 8.26547917e+00]
Stock Position:  0.0006620153321172392
Bond Position:  [9.66792148]


portfolio before change:  [9.73393582]
curr_Stock_Price:  97.8916527178626
curr_Factors:  [9.78916527e+01 4.49339989e-02]
mat_Sqrt:  [[ 2.07507212e+01  0.00000000e+00]
 [-8.47905645e-03  1.94279590e-02]]
grads:  [0.01187593 5.82029916]
Stock Position:  0.011875933564905424
Bond Position:  [8.57138106]


portfolio before change:  [9.75455303]
curr_Stock_Price:  99.5374788317002
curr_Factors:  [9.95374788e+01 4.40647773e-02]
mat_Sqrt:  [[ 2.08945213e+01  0.00000000e+00]
 [-8.39664479e-03  1.92391302e-02]]
grads:  [-0.00539034 -0.03388705]
Stock Position:  -0.005390337207929592
Bond Position:  [10.29109361]


portfolio before change:  [9.75923969]
curr_Stock_Price:  98.90668539998438
curr_Factors:  [9.89066854e+01 4.46526337e-02]
mat_Sqrt:  [[ 2.09001396e+01  0.00000000e+00]
 [-8.45246792e-03  1.93670370e-02]]
grads:  [-1.56450537e-03 -6.90464524e+00]
Stock Position:  -0.0015645053679211021
Bond Position:  [9.91397973]


portfolio before change:  [9.76002425]
curr_Stock_Price:  99.19735896434607
curr_Factors:  [9.91973590e+01 4.47665706e-02]
mat_Sqrt:  [[ 2.09882884e+01  0.00000000e+00]
 [-8.46324482e-03  1.93917300e-02]]
grads:  [-0.00616291 -1.44656537]
Stock Position:  -0.006162907899233138
Bond Position:  [10.37136844]


portfolio before change:  [9.75585413]
curr_Stock_Price:  100.08437851062081
curr_Factors:  [1.00084379e+02 4.44237550e-02]
mat_Sqrt:  [[ 2.10947280e+01  0.00000000e+00]
 [-8.43077743e-03  1.93173379e-02]]
grads:  [-0.00287798 -1.89213951]
Stock Position:  -0.0028779751119507348
Bond Position:  [10.04389449]


portfolio before change:  [9.76281082]
curr_Stock_Price:  98.10343182620022
curr_Factors:  [9.81034318e+01 4.54566419e-02]
mat_Sqrt:  [[ 2.09162043e+01  0.00000000e+00]
 [-8.52822532e-03  1.95406190e-02]]
grads:  [ 0.03057127 16.63695594]
Stock Position:  0.03057127047479606
Bond Position:  [6.76366427]


portfolio before change:  [9.85279157]
curr_Stock_Price:  101.0190855786565
curr_Factors:  [1.01019086e+02 4.28962268e-02]
mat_Sqrt:  [[ 2.09224712e+01  0.00000000e+00]
 [-8.28456172e-03  1.89823156e-02]]
grads:  [-1.28024410e-03 -1.94968759e+01]
Stock Position:  -0.0012802441048646261
Bond Position:  [9.98212065]


portfolio before change:  [9.85395376]
curr_Stock_Price:  101.08598902352554
curr_Factors:  [1.01085989e+02 4.27521258e-02]
mat_Sqrt:  [[ 2.09011327e+01  0.00000000e+00]
 [-8.27063488e-03  1.89504052e-02]]
grads:  [ 1.05954760e-03 -1.84444581e+00]
Stock Position:  0.0010595476018031747
Bond Position:  [9.74684834]


portfolio before change:  [9.85512358]
curr_Stock_Price:  101.04011419253354
curr_Factors:  [1.01040114e+02 4.36331242e-02]
mat_Sqrt:  [[ 2.11058080e+01  0.00000000e+00]
 [-8.35541733e-03  1.91446662e-02]]
grads:  [-1.76423644e-03 -7.77355997e+00]
Stock Position:  -0.0017642364400480778
Bond Position:  [10.03338223]


portfolio before change:  [9.85756808]
curr_Stock_Price:  100.36546399759064
curr_Factors:  [1.00365464e+02 4.27416275e-02]
mat_Sqrt:  [[ 2.07496045e+01  0.00000000e+00]
 [-8.26961933e-03  1.89480783e-02]]
grads:  [-1.53628540e-02 -2.47670311e+01]
Stock Position:  -0.01536285397463856
Bond Position:  [11.39946804]


portfolio before change:  [9.82594942]
curr_Stock_Price:  102.51634571214723
curr_Factors:  [1.02516346e+02 4.20910360e-02]
mat_Sqrt:  [[ 2.10323560e+01  0.00000000e+00]
 [-8.20644001e-03  1.88033163e-02]]
grads:  [-4.49461703e-04 -5.60914460e+00]
Stock Position:  -0.0004494617032673606
Bond Position:  [9.87202659]


portfolio before change:  [9.82660102]
curr_Stock_Price:  103.81229195262564
curr_Factors:  [1.03812292e+02 4.10017035e-02]
mat_Sqrt:  [[ 2.10208237e+01  0.00000000e+00]
 [-8.09955095e-03  1.85584027e-02]]
grads:  [ 0.0059419  -1.45656105]
Stock Position:  0.005941901105413639
Bond Position:  [9.20975865]


portfolio before change:  [9.83052054]
curr_Stock_Price:  104.2781749974325
curr_Factors:  [1.04278175e+02 4.22371345e-02]
mat_Sqrt:  [[ 2.14309116e+01  0.00000000e+00]
 [-8.22067000e-03  1.88359213e-02]]
grads:  [ 9.64726517e-03 -1.93996748e+01]
Stock Position:  0.009647265174312105
Bond Position:  [8.82452134]


portfolio before change:  [9.83881791]
curr_Stock_Price:  105.0239031110218
curr_Factors:  [1.05023903e+02 4.24243686e-02]
mat_Sqrt:  [[ 2.16319588e+01  0.00000000e+00]
 [-8.23887066e-03  1.88776242e-02]]
grads:  [-5.44025823e-03 -1.75733214e+01]
Stock Position:  -0.005440258227762665
Bond Position:  [10.41017507]


portfolio before change:  [9.83634295]
curr_Stock_Price:  105.71804612185794
curr_Factors:  [1.05718046e+02 4.19568479e-02]
mat_Sqrt:  [[ 2.16546194e+01  0.00000000e+00]
 [-8.19334832e-03  1.87733194e-02]]
grads:  [3.00627018e-03 4.98913239e+00]
Stock Position:  0.003006270177041277
Bond Position:  [9.51852594]


portfolio before change:  [9.83272022]
curr_Stock_Price:  104.11718513596617
curr_Factors:  [1.04117185e+02 4.34159753e-02]
mat_Sqrt:  [[ 2.16943778e+01  0.00000000e+00]
 [-8.33460020e-03  1.90969682e-02]]
grads:  [ 1.23560340e-02 -1.95392391e+01]
Stock Position:  0.012356033961905283
Bond Position:  [8.54624474]


portfolio before change:  [9.85121697]
curr_Stock_Price:  105.52770259815144
curr_Factors:  [1.05527703e+02 4.38131712e-02]
mat_Sqrt:  [[ 2.20886324e+01  0.00000000e+00]
 [-8.37263840e-03  1.91841246e-02]]
grads:  [-0.01680817  2.58534359]
Stock Position:  -0.01680817452377152
Bond Position:  [11.62494501]


portfolio before change:  [9.85093679]
curr_Stock_Price:  105.63082995066516
curr_Factors:  [1.05630830e+02 4.39699356e-02]
mat_Sqrt:  [[ 2.21497387e+01  0.00000000e+00]
 [-8.38760376e-03  1.92184146e-02]]
grads:  [-3.07573126e-03  8.13050143e+00]
Stock Position:  -0.0030757312626058246
Bond Position:  [10.17582884]


portfolio before change:  [9.85566606]
curr_Stock_Price:  104.50680321285975
curr_Factors:  [1.04506803e+02 4.34110364e-02]
mat_Sqrt:  [[ 2.17743220e+01  0.00000000e+00]
 [-8.33412612e-03  1.90958819e-02]]
grads:  [-0.00199523  1.80922477]
Stock Position:  -0.001995227781295326
Bond Position:  [10.06418093]


portfolio before change:  [9.85531978]
curr_Stock_Price:  105.31090802735947
curr_Factors:  [1.05310908e+02 4.37517864e-02]
mat_Sqrt:  [[ 2.20278065e+01  0.00000000e+00]
 [-8.36677107e-03  1.91706809e-02]]
grads:  [6.42731396e-04 1.10424605e+01]
Stock Position:  0.000642731396189048
Bond Position:  [9.78763316]


portfolio before change:  [9.85759483]
curr_Stock_Price:  106.94692109988016
curr_Factors:  [1.06946921e+02 4.33512118e-02]
mat_Sqrt:  [[ 2.22673690e+01  0.00000000e+00]
 [-8.32838152e-03  1.90827194e-02]]
grads:  [-1.75093176e-02  2.41363431e+01]
Stock Position:  -0.0175093176437562
Bond Position:  [11.73016244]


portfolio before change:  [9.84005625]
curr_Stock_Price:  108.032339940169
curr_Factors:  [1.08032340e+02 4.32647657e-02]
mat_Sqrt:  [[ 2.24709256e+01  0.00000000e+00]
 [-8.32007362e-03  1.90636836e-02]]
grads:  [-0.00385996  2.56053814]
Stock Position:  -0.0038599606774831993
Bond Position:  [10.25705683]


portfolio before change:  [9.83918098]
curr_Stock_Price:  108.59127840880087
curr_Factors:  [1.08591278e+02 4.33654844e-02]
mat_Sqrt:  [[ 2.26134615e+01  0.00000000e+00]
 [-8.32975240e-03  1.90858604e-02]]
grads:  [ 0.00320794 -0.62597068]
Stock Position:  0.003207938625110545
Bond Position:  [9.49082683]


portfolio before change:  [9.83735415]
curr_Stock_Price:  107.65196419187816
curr_Factors:  [1.07651964e+02 4.33686571e-02]
mat_Sqrt:  [[ 2.24186752e+01  0.00000000e+00]
 [-8.33005711e-03  1.90865586e-02]]
grads:  [-0.01128674 -6.03392603]
Stock Position:  -0.011286737403167236
Bond Position:  [11.0523936]


portfolio before change:  [9.82712469]
curr_Stock_Price:  108.68070180893528
curr_Factors:  [1.08680702e+02 4.54020064e-02]
mat_Sqrt:  [[ 2.31574085e+01  0.00000000e+00]
 [-8.52309863e-03  1.95288723e-02]]
grads:  [0.0043818  2.73180448]
Stock Position:  0.004381801688521062
Bond Position:  [9.35090741]


portfolio before change:  [9.82965101]
curr_Stock_Price:  108.99047933184886
curr_Factors:  [1.08990479e+02 4.62120276e-02]
mat_Sqrt:  [[ 2.34296648e+01  0.00000000e+00]
 [-8.59879318e-03  1.97023103e-02]]
grads:  [-4.04050215e-03  4.12769593e+00]
Stock Position:  -0.0040405021454421
Bond Position:  [10.27002728]


portfolio before change:  [9.83127057]
curr_Stock_Price:  108.90738866400021
curr_Factors:  [1.08907389e+02 4.60347462e-02]
mat_Sqrt:  [[ 2.33668527e+01  0.00000000e+00]
 [-8.58228373e-03  1.96644824e-02]]
grads:  [-0.02062656 -5.41595782]
Stock Position:  -0.020626558126958967
Bond Position:  [12.07765516]


portfolio before change:  [9.81232782]
curr_Stock_Price:  109.89895280407758
curr_Factors:  [1.09898953e+02 4.78883707e-02]
mat_Sqrt:  [[ 2.40496403e+01  0.00000000e+00]
 [-8.75336468e-03  2.00564781e-02]]
grads:  [-3.67493927e-03 -6.34566849e+00]
Stock Position:  -0.0036749392697533914
Bond Position:  [10.2161998]


portfolio before change:  [9.8138917]
curr_Stock_Price:  109.82091764643556
curr_Factors:  [1.09820918e+02 5.02766019e-02]
mat_Sqrt:  [[ 2.46245343e+01  0.00000000e+00]
 [-8.96897781e-03  2.05505099e-02]]
grads:  [-5.73738172e-04 -3.08075999e+00]
Stock Position:  -0.0005737381718595863
Bond Position:  [9.87690015]


portfolio before change:  [9.81538271]
curr_Stock_Price:  109.37415161051584
curr_Factors:  [1.09374152e+02 5.03476030e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.81538271]
Stock Price:  109.42117832514262
PL:  [0.39420439]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.40134730e+00  3.45717764e-01]
 [ 1.28516400e+00  5.13222413e-02]
 [-9.38152293e-02  1.29643028e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.48231072e-01  1.10252170e+00]
 [ 6.47334490e-02  5.46643585e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 1.07650849e+00  1.09577313e+00]
 [ 5.51271291e-02  4.79625041e-01]
 [ 1.28176170e-01 -9.24862539e-03]
 [ 7.65596703e-02  1.56414255e-02]
 [ 4.74174931e-02 -6.64660268e-02]
 [-9.30577688e-02  7.43029160e-02]
 [-1.25443350e-01  2.37332343e-01]
 [ 4.95000642e-01  3.23256968e-01]
 [ 1.31902932e-01  4.36823005e-03]
 [ 4.01255892e-02  1.27901818e-01]
 [-2.03447271e-03 -9.64879668e-03]
 [-1.04056442e-01 -4.05922887e-01]
 [-2.36078446e-02 -7.02353758e-02]
 [ 1.74957886e-01 -4.23660739e-02]
 [ 7.00913157e-01 -9.29540994e-02]
 [ 2.98403125e-02 -4.02491074e-01]
 [ 5.46708835e-02  1.41764389e-02]
 [ 3.77281319e-01 -2.83868008e-01]
 [-8.19571617e-02 -2.12040843e-02]
 [-1.66000662e-01  6.65482992e-02]
 [-6.38256275e-02  1.31355711e-02]
 [-6.62516341e-02  2.06187617e-01]
 [-6.60419651e-01 -5.63120142e-02]
 [-1.55591418e-01 -3.24100502e-02]
 [ 3.35515340e-02 -5.34524382e-02]
 [-2.57008848e-01  1.35763907e-01]
 [ 2.59496247e-02  2.73401140e-02]
 [-1.02532706e-01  8.88018951e-02]
 [-2.29758193e-01  7.63731449e-02]
 [-2.20708180e-02 -2.26942598e-01]
 [-1.20530184e-03 -5.21772152e-02]
 [-4.28258620e-02 -3.78259505e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.4346027]
curr_Stock_Price:  99.67384557565963
curr_Factors:  [9.96738456e+01 3.91032580e-02]
mat_Sqrt:  [[ 1.97100482e+01  0.00000000e+00]
 [-7.90981750e-03  1.81236687e-02]]
grads:  [ 0.07875328 19.07548462]
Stock Position:  0.07875327812533385
Bond Position:  [-7.41503938]


portfolio before change:  [0.28068728]
curr_Stock_Price:  97.73121544781607
curr_Factors:  [9.77312154e+01 3.98660723e-02]
mat_Sqrt:  [[ 1.95134934e+01  0.00000000e+00]
 [-7.98659601e-03  1.82995904e-02]]
grads:  [0.06700814 2.80455684]
Stock Position:  0.06700813816208256
Bond Position:  [-6.26809951]


portfolio before change:  [0.24176036]
curr_Stock_Price:  97.16198081327771
curr_Factors:  [9.71619808e+01 4.04076874e-02]
mat_Sqrt:  [[ 1.95311744e+01  0.00000000e+00]
 [-8.04066538e-03  1.84234789e-02]]
grads:  [-1.90640728e-03  7.03683758e+00]
Stock Position:  -0.0019064072756019702
Bond Position:  [0.42699067]


portfolio before change:  [0.2419401]
curr_Stock_Price:  97.09569833983188
curr_Factors:  [9.70956983e+01 4.11687246e-02]
mat_Sqrt:  [[ 1.97007925e+01  0.00000000e+00]
 [-8.11603101e-03  1.85961632e-02]]
grads:  [-8.27447271e-04 -8.14075520e+00]
Stock Position:  -0.0008274472706736138
Bond Position:  [0.32228167]


portfolio before change:  [0.24260373]
curr_Stock_Price:  96.34236794016451
curr_Factors:  [9.63423679e+01 4.28104776e-02]
mat_Sqrt:  [[ 1.99339036e+01  0.00000000e+00]
 [-8.27627719e-03  1.89633334e-02]]
grads:  [1.67026415e-02 5.81396571e+01]
Stock Position:  0.016702641529364508
Bond Position:  [-1.36656831]


portfolio before change:  [0.22367389]
curr_Stock_Price:  95.21925162263778
curr_Factors:  [9.52192516e+01 4.27776048e-02]
mat_Sqrt:  [[ 1.96939575e+01  0.00000000e+00]
 [-8.27309904e-03  1.89560513e-02]]
grads:  [0.00449838 2.88374186]
Stock Position:  0.0044983813482576875
Bond Position:  [-0.20465862]


portfolio before change:  [0.22651943]
curr_Stock_Price:  95.8575087692348
curr_Factors:  [9.58575088e+01 4.17768362e-02]
mat_Sqrt:  [[ 1.95926830e+01  0.00000000e+00]
 [-8.17575305e-03  1.87330036e-02]]
grads:  [0.00660317 5.13195263]
Stock Position:  0.006603167994164152
Bond Position:  [-0.40644381]


portfolio before change:  [0.22877057]
curr_Stock_Price:  96.20612214928865
curr_Factors:  [9.62061221e+01 4.11505945e-02]
mat_Sqrt:  [[ 1.95159981e+01  0.00000000e+00]
 [-8.11424372e-03  1.85920680e-02]]
grads:  [ 0.07966506 58.9376681 ]
Stock Position:  0.07966505699947163
Bond Position:  [-7.43549563]


portfolio before change:  [0.23757558]
curr_Stock_Price:  96.32831499348244
curr_Factors:  [9.63283150e+01 4.21934489e-02]
mat_Sqrt:  [[ 1.97868416e+01  0.00000000e+00]
 [-8.21641760e-03  1.88261778e-02]]
grads:  [1.33650768e-02 2.54764958e+01]
Stock Position:  0.013365076837550298
Bond Position:  [-1.04985975]


portfolio before change:  [0.23101171]
curr_Stock_Price:  95.84701408189174
curr_Factors:  [9.58470141e+01 4.20589262e-02]
mat_Sqrt:  [[ 1.96565673e+01  0.00000000e+00]
 [-8.20330921e-03  1.87961427e-02]]
grads:  [ 0.00631543 -0.49204912]
Stock Position:  0.006315433262086478
Bond Position:  [-0.37430371]


portfolio before change:  [0.21823166]
curr_Stock_Price:  93.83080056790106
curr_Factors:  [9.38308006e+01 4.26046437e-02]
mat_Sqrt:  [[ 1.93675145e+01  0.00000000e+00]
 [-8.25635694e-03  1.89176903e-02]]
grads:  [0.00430546 0.82681476]
Stock Position:  0.004305464595526882
Bond Position:  [-0.18575353]


portfolio before change:  [0.21471925]
curr_Stock_Price:  93.02039004272787
curr_Factors:  [9.30203900e+01 4.24807822e-02]
mat_Sqrt:  [[ 1.91723085e+01  0.00000000e+00]
 [-8.24434664e-03  1.88901713e-02]]
grads:  [ 9.60204707e-04 -3.51855078e+00]
Stock Position:  0.000960204706827964
Bond Position:  [0.12540063]


portfolio before change:  [0.21689138]
curr_Stock_Price:  95.26622220534196
curr_Factors:  [9.52662222e+01 4.38771897e-02]
mat_Sqrt:  [[ 1.99553039e+01  0.00000000e+00]
 [-8.37875310e-03  1.91981351e-02]]
grads:  [-3.03825580e-03  3.87031946e+00]
Stock Position:  -0.0030382558005634095
Bond Position:  [0.50633453]


portfolio before change:  [0.21295579]
curr_Stock_Price:  96.58240119361427
curr_Factors:  [9.65824012e+01 4.47233189e-02]
mat_Sqrt:  [[ 2.04251385e+01  0.00000000e+00]
 [-8.45915541e-03  1.93823600e-02]]
grads:  [-1.07039780e-03  1.22447598e+01]
Stock Position:  -0.0010703978037103796
Bond Position:  [0.31633738]


portfolio before change:  [0.21143873]
curr_Stock_Price:  98.03663228546705
curr_Factors:  [9.80366323e+01 4.26396329e-02]
mat_Sqrt:  [[ 2.02439433e+01  0.00000000e+00]
 [-8.25974652e-03  1.89254568e-02]]
grads:  [ 0.03142083 17.08053712]
Stock Position:  0.031420832343368045
Bond Position:  [-2.86895386]


portfolio before change:  [0.16088104]
curr_Stock_Price:  96.4389965803692
curr_Factors:  [9.64389966e+01 4.28382190e-02]
mat_Sqrt:  [[ 1.99603608e+01  0.00000000e+00]
 [-8.27895829e-03  1.89694765e-02]]
grads:  [0.00670376 0.23027678]
Stock Position:  0.006703755769379373
Bond Position:  [-0.48562244]


portfolio before change:  [0.16749771]
curr_Stock_Price:  97.43506196606968
curr_Factors:  [9.74350620e+01 4.26930354e-02]
mat_Sqrt:  [[ 2.01323180e+01  0.00000000e+00]
 [-8.26491722e-03  1.89373044e-02]]
grads:  [4.76579592e-03 6.75396116e+00]
Stock Position:  0.004765795920655404
Bond Position:  [-0.29685791]


portfolio before change:  [0.17555129]
curr_Stock_Price:  99.13271857483412
curr_Factors:  [9.91327186e+01 4.14815533e-02]
mat_Sqrt:  [[ 2.01903813e+01  0.00000000e+00]
 [-8.14680829e-03  1.86666828e-02]]
grads:  [-3.09333079e-04 -5.16899375e-01]
Stock Position:  -0.0003093330785796907
Bond Position:  [0.20621632]


portfolio before change:  [0.1753432]
curr_Stock_Price:  99.88877265204731
curr_Factors:  [9.98887727e+01 4.20177946e-02]
mat_Sqrt:  [[ 2.04754429e+01  0.00000000e+00]
 [-8.19929701e-03  1.87869496e-02]]
grads:  [-1.37342921e-02 -2.16066416e+01]
Stock Position:  -0.013734292146207042
Bond Position:  [1.54724478]


portfolio before change:  [0.15849602]
curr_Stock_Price:  101.12950577954756
curr_Factors:  [1.01129506e+02 4.22855170e-02]
mat_Sqrt:  [[ 2.07957078e+01  0.00000000e+00]
 [-8.22537703e-03  1.88467064e-02]]
grads:  [-2.60924399e-03 -3.72666577e+00]
Stock Position:  -0.002609243985103453
Bond Position:  [0.42236758]


portfolio before change:  [0.15976712]
curr_Stock_Price:  100.66259095946512
curr_Factors:  [1.00662591e+02 4.30596169e-02]
mat_Sqrt:  [[ 2.08883043e+01  0.00000000e+00]
 [-8.30032452e-03  1.90184327e-02]]
grads:  [ 0.00749069 -2.22763224]
Stock Position:  0.007490690168441046
Bond Position:  [-0.59426516]


portfolio before change:  [0.16051742]
curr_Stock_Price:  100.77267390263438
curr_Factors:  [1.00772674e+02 4.31376873e-02]
mat_Sqrt:  [[ 2.09300956e+01  0.00000000e+00]
 [-8.30784567e-03  1.90356658e-02]]
grads:  [ 0.03155001 -4.88315462]
Stock Position:  0.031550007036081844
Bond Position:  [-3.01886115]


portfolio before change:  [0.22214828]
curr_Stock_Price:  102.73806917580788
curr_Factors:  [1.02738069e+02 4.21128605e-02]
mat_Sqrt:  [[ 2.10833088e+01  0.00000000e+00]
 [-8.20856728e-03  1.88081904e-02]]
grads:  [-6.91642828e-03 -2.13997766e+01]
Stock Position:  -0.0069164282792582125
Bond Position:  [0.93272877]


portfolio before change:  [0.22436973]
curr_Stock_Price:  102.43374232713964
curr_Factors:  [1.02433742e+02 4.24128503e-02]
mat_Sqrt:  [[ 2.10955945e+01  0.00000000e+00]
 [-8.23775215e-03  1.88750614e-02]]
grads:  [0.00288487 0.75106717]
Stock Position:  0.0028848671991201355
Bond Position:  [-0.07113801]


portfolio before change:  [0.22505827]
curr_Stock_Price:  102.67549672379255
curr_Factors:  [1.02675497e+02 4.15986959e-02]
mat_Sqrt:  [[ 2.09414462e+01  0.00000000e+00]
 [-8.15830334e-03  1.86930213e-02]]
grads:  [ 1.20999840e-02 -1.51857746e+01]
Stock Position:  0.012099983974719923
Bond Position:  [-1.0173136]


portfolio before change:  [0.22783471]
curr_Stock_Price:  102.91546479315345
curr_Factors:  [1.02915465e+02 4.14741306e-02]
mat_Sqrt:  [[ 2.09589386e+01  0.00000000e+00]
 [-8.14607936e-03  1.86650126e-02]]
grads:  [-0.00435191 -1.13603375]
Stock Position:  -0.004351908490290029
Bond Position:  [0.67571339]


portfolio before change:  [0.22979108]
curr_Stock_Price:  102.4853304053625
curr_Factors:  [1.0248533e+02 4.2071815e-02]
mat_Sqrt:  [[ 2.10211916e+01  0.00000000e+00]
 [-8.20456605e-03  1.87990225e-02]]
grads:  [-0.00651517  3.53998721]
Stock Position:  -0.0065151684010718745
Bond Position:  [0.89750027]


portfolio before change:  [0.21546413]
curr_Stock_Price:  104.70156630296827
curr_Factors:  [1.04701566e+02 4.22383062e-02]
mat_Sqrt:  [[ 2.15182241e+01  0.00000000e+00]
 [-8.22078402e-03  1.88361825e-02]]
grads:  [-0.0026997   0.69735845]
Stock Position:  -0.0026997020784106564
Bond Position:  [0.49812716]


portfolio before change:  [0.21612565]
curr_Stock_Price:  104.47959500168261
curr_Factors:  [1.04479595e+02 4.10388465e-02]
mat_Sqrt:  [[ 2.11655254e+01  0.00000000e+00]
 [-8.10321877e-03  1.85668067e-02]]
grads:  [1.12144721e-03 1.11051739e+01]
Stock Position:  0.00112144721276243
Bond Position:  [0.0989573]


portfolio before change:  [0.2145946]
curr_Stock_Price:  103.10332233348575
curr_Factors:  [1.03103322e+02 4.16078722e-02]
mat_Sqrt:  [[ 2.10310237e+01  0.00000000e+00]
 [-8.15920312e-03  1.86950829e-02]]
grads:  [-0.03257075 -3.01212968]
Stock Position:  -0.03257075059605233
Bond Position:  [3.5727472]


portfolio before change:  [0.20002656]
curr_Stock_Price:  103.5643085634828
curr_Factors:  [1.03564309e+02 4.02746677e-02]
mat_Sqrt:  [[ 2.07838545e+01  0.00000000e+00]
 [-8.02741978e-03  1.83931294e-02]]
grads:  [-0.00816674 -1.76207373]
Stock Position:  -0.00816673942571152
Bond Position:  [1.04580928]


portfolio before change:  [0.21154144]
curr_Stock_Price:  102.17034402702036
curr_Factors:  [1.02170344e+02 4.08460634e-02]
mat_Sqrt:  [[ 2.06490445e+01  0.00000000e+00]
 [-8.08416362e-03  1.85231459e-02]]
grads:  [ 4.95082351e-04 -2.88571059e+00]
Stock Position:  0.0004950823506561152
Bond Position:  [0.1609587]


portfolio before change:  [0.21087364]
curr_Stock_Price:  100.78083142131095
curr_Factors:  [1.00780831e+02 4.28973523e-02]
mat_Sqrt:  [[ 2.08733993e+01  0.00000000e+00]
 [-8.28467041e-03  1.89825646e-02]]
grads:  [-0.0094741   7.15203188]
Stock Position:  -0.00947409755352942
Bond Position:  [1.16568106]


portfolio before change:  [0.22124663]
curr_Stock_Price:  99.70133284827776
curr_Factors:  [9.97013328e+01 4.40491400e-02]
mat_Sqrt:  [[ 2.09252031e+01  0.00000000e+00]
 [-8.39515479e-03  1.92357162e-02]]
grads:  [0.00181034 1.42132031]
Stock Position:  0.0018103446149617462
Bond Position:  [0.04075286]


portfolio before change:  [0.22265891]
curr_Stock_Price:  100.478635389958
curr_Factors:  [1.00478635e+02 4.38996426e-02]
mat_Sqrt:  [[ 2.10525264e+01  0.00000000e+00]
 [-8.38089662e-03  1.92030466e-02]]
grads:  [-3.02939325e-03  4.62436493e+00]
Stock Position:  -0.0030293932528419882
Bond Position:  [0.52704821]


portfolio before change:  [0.22086589]
curr_Stock_Price:  101.09225963716027
curr_Factors:  [1.01092260e+02 4.50963383e-02]
mat_Sqrt:  [[ 2.14678496e+01  0.00000000e+00]
 [-8.49435938e-03  1.94630224e-02]]
grads:  [-0.00914979  3.92401259]
Stock Position:  -0.009149785553686077
Bond Position:  [1.14583838]


portfolio before change:  [0.21288105]
curr_Stock_Price:  101.98059436038153
curr_Factors:  [1.01980594e+02 4.35938491e-02]
mat_Sqrt:  [[ 2.12926712e+01  0.00000000e+00]
 [-8.35165603e-03  1.91360480e-02]]
grads:  [-5.68818666e-03 -1.18594288e+01]
Stock Position:  -0.005688186657539427
Bond Position:  [0.79296571]


portfolio before change:  [0.21192928]
curr_Stock_Price:  102.16534625338396
curr_Factors:  [1.02165346e+02 4.38774226e-02]
mat_Sqrt:  [[ 2.14005121e+01  0.00000000e+00]
 [-8.37877534e-03  1.91981861e-02]]
grads:  [-1.12040802e-03 -2.71782005e+00]
Stock Position:  -0.0011204080242254867
Bond Position:  [0.32639615]


portfolio before change:  [0.21150697]
curr_Stock_Price:  102.57868381732514
curr_Factors:  [1.02578684e+02 4.46330631e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.21150697]
Stock Price:  104.60662443638076
PL:  [-4.39511747]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.48315675e+00  3.64213240e-01]
 [ 9.41745898e-01  8.27342054e-02]
 [ 8.50820941e-02 -7.22645814e-03]
 [ 4.97692547e-02 -1.51386812e-01]
 [-8.55095645e-02  3.89066644e-01]
 [-1.25754405e-01 -6.64092520e-02]
 [ 1.06783360e-01 -2.97212967e-03]
 [ 6.75869781e-01  6.77111969e-01]
 [-2.33713313e-02  2.69885914e-01]
 [ 1.92016066e-01  9.11545272e-02]
 [-6.41711901e-02  1.37091119e-02]
 [ 3.65445672e-02 -1.38539720e-01]
 [-1.18344646e-01 -2.65487077e-02]
 [-1.01964880e-01  1.54350357e-01]
 [ 4.71305237e-01  3.06176499e-01]
 [ 1.30523592e-01  8.43313564e-02]
 [ 3.95262974e-02  1.03422497e-01]
 [ 1.10598615e-01  8.43374794e-02]
 [ 7.52348360e-02  8.21690403e-02]
 [-3.62738907e-01  1.35158005e-01]
 [ 1.31485533e-01  2.91011887e-02]
 [ 1.28472478e+00  1.32713480e-01]
 [ 1.66052364e-02  3.46789448e-01]
 [-7.22269421e-02  6.61857222e-02]
 [ 1.20608074e-01 -4.42860638e-02]
 [ 1.82681287e-01 -8.48930564e-02]
 [ 1.42805683e-01 -1.62949933e-01]
 [ 5.50486267e-02  2.59924145e-01]
 [-4.16253655e-02  1.94209649e-01]
 [-5.30542809e-01 -1.01753567e-01]
 [-1.67388616e-01 -6.25283919e-02]
 [ 1.32370887e-02 -6.42150743e-02]
 [-2.27180023e-01  1.39231273e-01]
 [ 6.24089955e-02  6.15814150e-02]
 [-8.12121193e-02  9.45716955e-02]
 [-2.23733400e-01  7.96409341e-02]
 [-2.15334465e-02 -2.31918376e-01]
 [ 6.81199262e-04 -2.51447604e-02]
 [ 3.58102194e-02 -1.14458118e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.94951829]
curr_Stock_Price:  99.32777857633882
curr_Factors:  [9.93277786e+01 4.19176007e-02]
mat_Sqrt:  [[ 2.03361591e+01  0.00000000e+00]
 [-8.18951531e-03  1.87645369e-02]]
grads:  [ 0.08074841 19.40965781]
Stock Position:  0.08074840656424086
Bond Position:  [-9.97007813]


portfolio before change:  [-1.99459439]
curr_Stock_Price:  98.78498442055124
curr_Factors:  [9.87849844e+01 4.15191024e-02]
mat_Sqrt:  [[ 2.01286623e+01  0.00000000e+00]
 [-8.15049470e-03  1.86751295e-02]]
grads:  [0.04858018 4.43018109]
Stock Position:  0.04858018135578086
Bond Position:  [-6.79358685]


portfolio before change:  [-2.00937367]
curr_Stock_Price:  98.49824134030358
curr_Factors:  [9.84982413e+01 4.06065533e-02]
mat_Sqrt:  [[ 1.98484474e+01  0.00000000e+00]
 [-8.06042712e-03  1.84687587e-02]]
grads:  [ 0.00412769 -0.39128012]
Stock Position:  0.004127688558632999
Bond Position:  [-2.41594373]


portfolio before change:  [-2.00597039]
curr_Stock_Price:  99.39590830035769
curr_Factors:  [9.93959083e+01 4.02900085e-02]
mat_Sqrt:  [[ 1.99511157e+01  0.00000000e+00]
 [-8.02894847e-03  1.83966321e-02]]
grads:  [-8.17065433e-04 -8.22905040e+00]
Stock Position:  -0.0008170654333322955
Bond Position:  [-1.92475743]


portfolio before change:  [-2.00545959]
curr_Stock_Price:  98.47626339990269
curr_Factors:  [9.84762634e+01 4.25396297e-02]
mat_Sqrt:  [[ 2.03108647e+01  0.00000000e+00]
 [-8.25005501e-03  1.89032508e-02]]
grads:  [4.15014531e-03 2.05819966e+01]
Stock Position:  0.00415014530503946
Bond Position:  [-2.41415039]


portfolio before change:  [-2.00145453]
curr_Stock_Price:  99.5140213919508
curr_Factors:  [9.95140214e+01 4.13086656e-02]
mat_Sqrt:  [[ 2.02257605e+01  0.00000000e+00]
 [-8.12981334e-03  1.86277425e-02]]
grads:  [-0.00765053 -3.56507247]
Stock Position:  -0.007650529589604674
Bond Position:  [-1.24011957]


portfolio before change:  [-2.00991705]
curr_Stock_Price:  100.59989301779447
curr_Factors:  [1.00599893e+02 4.11459909e-02]
mat_Sqrt:  [[ 2.04061597e+01  0.00000000e+00]
 [-8.11378983e-03  1.85910280e-02]]
grads:  [ 0.00516933 -0.15986903]
Stock Position:  0.005169332096973036
Bond Position:  [-2.52995131]


portfolio before change:  [-2.01917967]
curr_Stock_Price:  98.86923363048996
curr_Factors:  [9.88692336e+01 4.10310196e-02]
mat_Sqrt:  [[ 2.00270657e+01  0.00000000e+00]
 [-8.10244602e-03  1.85650361e-02]]
grads:  [ 0.04850364 36.47242943]
Stock Position:  0.048503644296865975
Bond Position:  [-6.81469781]


portfolio before change:  [-2.03329172]
curr_Stock_Price:  98.59584868167615
curr_Factors:  [9.85958487e+01 4.12937652e-02]
mat_Sqrt:  [[ 2.00355317e+01  0.00000000e+00]
 [-8.12834696e-03  1.86243826e-02]]
grads:  [4.71245485e-03 1.44909993e+01]
Stock Position:  0.004712454853501857
Bond Position:  [-2.49792021]


portfolio before change:  [-2.03367224]
curr_Stock_Price:  98.58136401583346
curr_Factors:  [9.85813640e+01 4.10451368e-02]
mat_Sqrt:  [[ 1.99721894e+01  0.00000000e+00]
 [-8.10383977e-03  1.85682296e-02]]
grads:  [0.0116061  4.90916632]
Stock Position:  0.011606096779351956
Bond Position:  [-3.17781709]


portfolio before change:  [-2.04410724]
curr_Stock_Price:  97.71649574221468
curr_Factors:  [9.77164957e+01 4.21523571e-02]
mat_Sqrt:  [[ 2.00622120e+01  0.00000000e+00]
 [-8.21241568e-03  1.88170082e-02]]
grads:  [-0.00290038  0.72854897]
Stock Position:  -0.0029003802296696155
Bond Position:  [-1.76069225]


portfolio before change:  [-2.04508064]
curr_Stock_Price:  97.9762210453968
curr_Factors:  [9.79762210e+01 4.25606575e-02]
mat_Sqrt:  [[ 2.02127241e+01  0.00000000e+00]
 [-8.25209380e-03  1.89079222e-02]]
grads:  [-1.18336961e-03 -7.32707263e+00]
Stock Position:  -0.0011833696071596063
Bond Position:  [-1.92913856]


portfolio before change:  [-2.0441485]
curr_Stock_Price:  96.98473076703497
curr_Factors:  [9.69847308e+01 4.30991482e-02]
mat_Sqrt:  [[ 2.01343544e+01  0.00000000e+00]
 [-8.30413374e-03  1.90271607e-02]]
grads:  [-0.00645322 -1.3953058 ]
Stock Position:  -0.006453221660219449
Bond Position:  [-1.41828453]


portfolio before change:  [-2.04750177]
curr_Stock_Price:  97.47688468274501
curr_Factors:  [9.74768847e+01 4.09308816e-02]
mat_Sqrt:  [[ 1.97209209e+01  0.00000000e+00]
 [-8.09255279e-03  1.85423679e-02]]
grads:  [-1.75452566e-03  8.32419882e+00]
Stock Position:  -0.001754525663638019
Bond Position:  [-1.87647608]


portfolio before change:  [-2.04764259]
curr_Stock_Price:  97.42344582454722
curr_Factors:  [9.74234458e+01 4.22408710e-02]
mat_Sqrt:  [[ 2.00230356e+01  0.00000000e+00]
 [-8.22103361e-03  1.88367544e-02]]
grads:  [ 0.03021178 16.25420666]
Stock Position:  0.03021178354851415
Bond Position:  [-4.99097865]


portfolio before change:  [-2.04769047]
curr_Stock_Price:  97.44251221255665
curr_Factors:  [9.74425122e+01 4.23754792e-02]
mat_Sqrt:  [[ 2.00588386e+01  0.00000000e+00]
 [-8.23412210e-03  1.88667439e-02]]
grads:  [0.0083419  4.46984158]
Stock Position:  0.008341899387915326
Bond Position:  [-2.8605461]


portfolio before change:  [-2.03321837]
curr_Stock_Price:  99.22024777563524
curr_Factors:  [9.92202478e+01 4.44876401e-02]
mat_Sqrt:  [[ 2.09276273e+01  0.00000000e+00]
 [-8.43683733e-03  1.93312228e-02]]
grads:  [4.04554108e-03 5.35002355e+00]
Stock Position:  0.004045541079528003
Bond Position:  [-2.43461796]


portfolio before change:  [-2.04325115]
curr_Stock_Price:  96.8155163775405
curr_Factors:  [9.68155164e+01 4.36079606e-02]
mat_Sqrt:  [[ 2.02175188e+01  0.00000000e+00]
 [-8.35300766e-03  1.91391449e-02]]
grads:  [0.00729103 4.40654374]
Stock Position:  0.007291028667633141
Bond Position:  [-2.74913586]


portfolio before change:  [-2.05113066]
curr_Stock_Price:  95.78193930582931
curr_Factors:  [9.57819393e+01 4.45016359e-02]
mat_Sqrt:  [[ 2.02055936e+01  0.00000000e+00]
 [-8.43816434e-03  1.93342634e-02]]
grads:  [0.0054983  4.24991832]
Stock Position:  0.0054982965271469335
Bond Position:  [-2.57776816]


portfolio before change:  [-2.04632848]
curr_Stock_Price:  96.71394107813009
curr_Factors:  [9.67139411e+01 4.39391678e-02]
mat_Sqrt:  [[ 2.02728588e+01  0.00000000e+00]
 [-8.38466865e-03  1.92116894e-02]]
grads:  [-0.01498314  7.03519625]
Stock Position:  -0.014983141786527448
Bond Position:  [-0.59724979]


portfolio before change:  [-2.04737955]
curr_Stock_Price:  96.77910871513814
curr_Factors:  [9.67791087e+01 4.48098490e-02]
mat_Sqrt:  [[ 2.04865278e+01  0.00000000e+00]
 [-8.46733479e-03  1.94011013e-02]]
grads:  [0.0070381  1.49997613]
Stock Position:  0.007038104947877826
Bond Position:  [-2.72852108]


portfolio before change:  [-2.04782616]
curr_Stock_Price:  96.76411639052739
curr_Factors:  [9.67641164e+01 4.30080370e-02]
mat_Sqrt:  [[ 2.00673093e+01  0.00000000e+00]
 [-8.29535166e-03  1.90070385e-02]]
grads:  [0.06690711 6.98233345]
Stock Position:  0.06690711093516086
Bond Position:  [-8.52203363]


portfolio before change:  [-2.03357244]
curr_Stock_Price:  96.99307612360666
curr_Factors:  [9.69930761e+01 4.12909323e-02]
mat_Sqrt:  [[ 1.97091583e+01  0.00000000e+00]
 [-8.12806814e-03  1.86237437e-02]]
grads:  [8.52175203e-03 1.86208236e+01]
Stock Position:  0.008521752027348924
Bond Position:  [-2.86012339]


portfolio before change:  [-2.02001905]
curr_Stock_Price:  98.6254786524582
curr_Factors:  [9.86254787e+01 4.23942507e-02]
mat_Sqrt:  [[ 2.03068521e+01  0.00000000e+00]
 [-8.23594568e-03  1.88709222e-02]]
grads:  [-2.13431036e-03  3.50728604e+00]
Stock Position:  -0.0021343103558681266
Bond Position:  [-1.80952167]


portfolio before change:  [-2.02288734]
curr_Stock_Price:  99.86338872338216
curr_Factors:  [9.98633887e+01 4.10879044e-02]
mat_Sqrt:  [[ 2.02424603e+01  0.00000000e+00]
 [-8.10806063e-03  1.85779008e-02]]
grads:  [ 0.00500335 -2.38380344]
Stock Position:  0.005003346934827292
Bond Position:  [-2.52253852]


portfolio before change:  [-2.01758265]
curr_Stock_Price:  100.98664267887061
curr_Factors:  [1.00986643e+02 4.02259082e-02]
mat_Sqrt:  [[ 2.02542825e+01  0.00000000e+00]
 [-8.02255901e-03  1.83819920e-02]]
grads:  [ 0.00719013 -4.61827295]
Stock Position:  0.007190129777127624
Bond Position:  [-2.74368972]


portfolio before change:  [-2.02448393]
curr_Stock_Price:  100.07451799443632
curr_Factors:  [1.00074518e+02 4.05053423e-02]
mat_Sqrt:  [[ 2.01409365e+01  0.00000000e+00]
 [-8.05037563e-03  1.84457278e-02]]
grads:  [ 3.55934300e-03 -8.83402024e+00]
Stock Position:  0.0035593430024193125
Bond Position:  [-2.38068346]


portfolio before change:  [-2.02118338]
curr_Stock_Price:  101.08541988359302
curr_Factors:  [1.0108542e+02 4.0487747e-02]
mat_Sqrt:  [[ 2.03399708e+01  0.00000000e+00]
 [-8.04862692e-03  1.84417210e-02]]
grads:  [8.28363155e-03 1.40943540e+01]
Stock Position:  0.00828363155297891
Bond Position:  [-2.85853776]


portfolio before change:  [-2.0080364]
curr_Stock_Price:  102.71566143659862
curr_Factors:  [1.02715661e+02 4.02437913e-02]
mat_Sqrt:  [[ 2.06056402e+01  0.00000000e+00]
 [-8.02434210e-03  1.83860775e-02]]
grads:  [2.09334309e-03 1.05628647e+01]
Stock Position:  0.0020933430879847273
Bond Position:  [-2.22305552]


portfolio before change:  [-2.01264059]
curr_Stock_Price:  100.64897543281512
curr_Factors:  [1.00648975e+02 4.02234060e-02]
mat_Sqrt:  [[ 2.01859308e+01  0.00000000e+00]
 [-8.02230950e-03  1.83814203e-02]]
grads:  [-0.02848279 -5.53567489]
Stock Position:  -0.028482793889506582
Bond Position:  [0.85412344]


portfolio before change:  [-1.99279902]
curr_Stock_Price:  99.956108131422
curr_Factors:  [9.99561081e+01 3.98789484e-02]
mat_Sqrt:  [[ 1.99609491e+01  0.00000000e+00]
 [-7.98788567e-03  1.83025454e-02]]
grads:  [-0.00975296 -3.41637683]
Stock Position:  -0.009752955242278882
Bond Position:  [-1.01793157]


portfolio before change:  [-2.00740334]
curr_Stock_Price:  101.44048619458768
curr_Factors:  [1.01440486e+02 3.99138025e-02]
mat_Sqrt:  [[ 2.02662257e+01  0.00000000e+00]
 [-7.99137560e-03  1.83105418e-02]]
grads:  [-7.29719862e-04 -3.50700023e+00]
Stock Position:  -0.0007297198616722408
Bond Position:  [-1.9333802]


portfolio before change:  [-2.00690446]
curr_Stock_Price:  100.42561630082366
curr_Factors:  [1.00425616e+02 3.98635111e-02]
mat_Sqrt:  [[ 2.00508265e+01  0.00000000e+00]
 [-7.98633945e-03  1.82990025e-02]]
grads:  [-0.00829963  7.608681  ]
Stock Position:  -0.008299633595145491
Bond Position:  [-1.17340864]


portfolio before change:  [-2.0098683]
curr_Stock_Price:  100.76504761959326
curr_Factors:  [1.00765048e+02 4.01654673e-02]
mat_Sqrt:  [[ 2.01946498e+01  0.00000000e+00]
 [-8.01652966e-03  1.83681770e-02]]
grads:  [0.00442124 3.35261442]
Stock Position:  0.004421236772935419
Bond Position:  [-2.45537443]


portfolio before change:  [-2.01301072]
curr_Stock_Price:  100.12371583312003
curr_Factors:  [1.00123716e+02 3.94543533e-02]
mat_Sqrt:  [[ 1.98876937e+01  0.00000000e+00]
 [-7.94524797e-03  1.82048501e-02]]
grads:  [-2.00815882e-03  5.19486263e+00]
Stock Position:  -0.0020081588197951084
Bond Position:  [-1.81194639]


portfolio before change:  [-2.01487443]
curr_Stock_Price:  100.93899276261591
curr_Factors:  [1.00938993e+02 3.77870480e-02]
mat_Sqrt:  [[ 1.96214207e+01  0.00000000e+00]
 [-7.77555637e-03  1.78160378e-02]]
grads:  [-0.00963107  4.47018214]
Stock Position:  -0.009631068478165002
Bond Position:  [-1.04272408]


portfolio before change:  [-2.02437128]
curr_Stock_Price:  101.91152283685996
curr_Factors:  [1.01911523e+02 3.64526638e-02]
mat_Sqrt:  [[ 1.94575397e+01  0.00000000e+00]
 [-7.63703228e-03  1.74986392e-02]]
grads:  [-6.30865596e-03 -1.32535092e+01]
Stock Position:  -0.006308655964140103
Bond Position:  [-1.38144655]


portfolio before change:  [-2.01250253]
curr_Stock_Price:  100.00280556065606
curr_Factors:  [1.00002806e+02 3.68783524e-02]
mat_Sqrt:  [[ 1.92042760e+01  0.00000000e+00]
 [-7.68149489e-03  1.76005159e-02]]
grads:  [-5.35967817e-04 -1.42863769e+00]
Stock Position:  -0.0005359678165988299
Bond Position:  [-1.95890425]


portfolio before change:  [-2.01250894]
curr_Stock_Price:  99.55786258511066
curr_Factors:  [9.95578626e+01 3.63796931e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.01250894]
Stock Price:  100.30902753205548
PL:  [-2.32153647]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.00950188e+00  2.57129365e-01]
 [-2.71599419e-01 -9.55263046e-02]
 [-2.28706277e-01 -1.16321155e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.17965105e-01 -3.74571492e-01]
 [-4.04579961e-01  2.47171856e-01]
 [ 2.66262391e-01 -3.00599639e-01]
 [-6.95312137e-01  5.63687835e-02]
 [-1.04418122e-01 -8.17053114e-02]
 [-5.13915395e-01 -7.22474866e-01]
 [-4.30856030e-02 -1.59714516e-02]
 [-2.27037668e-01 -2.35735836e-01]
 [-4.96483265e-02 -2.92954441e-02]
 [ 2.31386739e-02 -1.98986404e-01]
 [ 3.28306413e-02 -2.87880777e-02]
 [ 9.90131499e-02 -8.97145905e-01]
 [ 2.06144023e-02 -2.58175361e-01]
 [ 3.84739257e-02 -1.60552229e-01]
 [-1.22688678e-01 -3.46893293e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.41720010e-01 -2.87334949e-02]
 [ 4.15941690e-01 -3.32575276e-01]
 [ 2.82188123e-02 -3.59509585e-01]
 [ 5.63454124e-02  1.19733551e-02]
 [ 2.29042424e-01 -1.40009898e-01]
 [ 1.81184138e-01 -8.54187228e-02]
 [ 7.45204975e-02 -2.49086855e-01]
 [ 5.20459260e-02  9.14496595e-02]
 [ 2.78679479e-01 -4.67243083e-02]
 [-5.35291325e-01 -1.61692496e-01]
 [-1.52864360e-01 -5.33040318e-02]
 [-1.90093216e-03 -4.37797287e-02]
 [-3.26030879e-02  1.70319034e-01]
 [ 4.62920278e-03  1.22001022e-02]
 [-4.10994128e-03  4.74356983e-02]
 [-8.32518561e-02  1.18294031e-01]
 [-3.73821555e-02 -8.92771292e-02]
 [-7.54369184e-02 -5.25360603e-02]
 [ 7.75045311e-02 -1.21601086e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.78839096]
curr_Stock_Price:  101.61221424420658
curr_Factors:  [1.01612214e+02 3.91286500e-02]
mat_Sqrt:  [[ 2.00998746e+01  0.00000000e+00]
 [-7.91238523e-03  1.81295521e-02]]
grads:  [ 0.05580743 14.18288565]
Stock Position:  0.05580742959704956
Bond Position:  [8.11767446]


portfolio before change:  [13.83276083]
curr_Stock_Price:  102.38908384584624
curr_Factors:  [1.02389084e+02 3.78339123e-02]
mat_Sqrt:  [[ 1.99156408e+01  0.00000000e+00]
 [-7.78037658e-03  1.78270823e-02]]
grads:  [-0.01573088 -5.3584935 ]
Stock Position:  -0.01573087804338702
Bond Position:  [15.44343102]


portfolio before change:  [13.84420832]
curr_Stock_Price:  101.784098974125
curr_Factors:  [1.01784099e+02 3.85859218e-02]
mat_Sqrt:  [[ 1.99937555e+01  0.00000000e+00]
 [-7.85731983e-03  1.80033814e-02]]
grads:  [-0.01397801 -6.46107261]
Stock Position:  -0.013978013866053568
Bond Position:  [15.26694786]


portfolio before change:  [13.84114898]
curr_Stock_Price:  102.13950214665198
curr_Factors:  [1.02139502e+02 3.91805871e-02]
mat_Sqrt:  [[ 2.02175817e+01  0.00000000e+00]
 [-7.91763471e-03  1.81415802e-02]]
grads:  [-8.06296580e-04 -8.34474235e+00]
Stock Position:  -0.0008062965796908117
Bond Position:  [13.92350371]


portfolio before change:  [13.84296127]
curr_Stock_Price:  102.05051861891573
curr_Factors:  [1.02050519e+02 3.94351634e-02]
mat_Sqrt:  [[ 2.02654867e+01  0.00000000e+00]
 [-7.94331552e-03  1.82004223e-02]]
grads:  [-1.38877250e-02 -2.05803737e+01]
Stock Position:  -0.013887725010695377
Bond Position:  [15.26021081]


portfolio before change:  [13.83207594]
curr_Stock_Price:  102.97168972768239
curr_Factors:  [1.02971690e+02 4.04091743e-02]
mat_Sqrt:  [[ 2.06994034e+01  0.00000000e+00]
 [-8.04081332e-03  1.84238179e-02]]
grads:  [-0.014334   13.41588689]
Stock Position:  -0.01433400345691139
Bond Position:  [15.3080725]


portfolio before change:  [13.83718219]
curr_Stock_Price:  102.74895917015188
curr_Factors:  [1.02748959e+02 3.95957463e-02]
mat_Sqrt:  [[ 2.04456865e+01  0.00000000e+00]
 [-7.95947197e-03  1.82374414e-02]]
grads:  [ 6.60628113e-03 -1.64825555e+01]
Stock Position:  0.006606281132397161
Bond Position:  [13.15839368]


portfolio before change:  [13.8489316]
curr_Stock_Price:  104.2784885891049
curr_Factors:  [1.04278489e+02 3.90818537e-02]
mat_Sqrt:  [[ 2.06149509e+01  0.00000000e+00]
 [-7.90765236e-03  1.81187078e-02]]
grads:  [-0.03253516  3.11108189]
Stock Position:  -0.03253516272706932
Bond Position:  [17.24164919]


portfolio before change:  [13.8480041]
curr_Stock_Price:  104.3732425828059
curr_Factors:  [1.04373243e+02 3.72059654e-02]
mat_Sqrt:  [[ 2.01323960e+01  0.00000000e+00]
 [-7.71553916e-03  1.76785211e-02]]
grads:  [-0.0069578  -4.62172774]
Stock Position:  -0.006957802884525496
Bond Position:  [14.57421255]


portfolio before change:  [13.84305569]
curr_Stock_Price:  105.34629388786114
curr_Factors:  [1.05346294e+02 3.76845317e-02]
mat_Sqrt:  [[ 2.04503537e+01  0.00000000e+00]
 [-7.76500165e-03  1.77918539e-02]]
grads:  [-4.05484077e-02 -4.06070592e+01]
Stock Position:  -0.04054840765669671
Bond Position:  [18.11468016]


portfolio before change:  [13.85773713]
curr_Stock_Price:  105.04006824984532
curr_Factors:  [1.05040068e+02 3.76152388e-02]
mat_Sqrt:  [[ 2.03721520e+01  0.00000000e+00]
 [-7.75785938e-03  1.77754889e-02]]
grads:  [-0.00245709 -0.89850983]
Stock Position:  -0.002457085338526229
Bond Position:  [14.11582954]


portfolio before change:  [13.85982529]
curr_Stock_Price:  104.90837870245292
curr_Factors:  [1.04908379e+02 3.79405809e-02]
mat_Sqrt:  [[ 2.04344128e+01  0.00000000e+00]
 [-7.79133682e-03  1.78521954e-02]]
grads:  [ -0.01614537 -13.20486536]
Stock Position:  -0.01614537321263216
Bond Position:  [15.55361022]


portfolio before change:  [13.87208484]
curr_Stock_Price:  104.26948186131261
curr_Factors:  [1.04269482e+02 3.81155260e-02]
mat_Sqrt:  [[ 2.03567374e+01  0.00000000e+00]
 [-7.80927920e-03  1.78933065e-02]]
grads:  [-0.00306699 -1.63722921]
Stock Position:  -0.00306698982970904
Bond Position:  [14.19187828]


portfolio before change:  [13.87489793]
curr_Stock_Price:  103.9307152790795
curr_Factors:  [1.03930715e+02 3.71105321e-02]
mat_Sqrt:  [[ 2.00213108e+01  0.00000000e+00]
 [-7.70563763e-03  1.76558339e-02]]
grads:  [-3.18191518e-03 -1.12702921e+01]
Stock Position:  -0.0031819151785751365
Bond Position:  [14.20559665]


portfolio before change:  [13.87623441]
curr_Stock_Price:  104.06878766523597
curr_Factors:  [1.04068788e+02 3.60350065e-02]
mat_Sqrt:  [[ 1.97552622e+01  0.00000000e+00]
 [-7.59315550e-03  1.73981049e-02]]
grads:  [ 1.02587827e-03 -1.65466744e+00]
Stock Position:  0.0010258782700952943
Bond Position:  [13.7694725]


portfolio before change:  [13.87887201]
curr_Stock_Price:  104.96198237750781
curr_Factors:  [1.04961982e+02 3.61655825e-02]
mat_Sqrt:  [[ 1.99608834e+01  0.00000000e+00]
 [-7.60690029e-03  1.74295982e-02]]
grads:  [-1.46553345e-02 -5.14725523e+01]
Stock Position:  -0.014655334541292473
Bond Position:  [15.41712497]


portfolio before change:  [13.88615839]
curr_Stock_Price:  104.59630501332676
curr_Factors:  [1.04596305e+02 3.58518186e-02]
mat_Sqrt:  [[ 1.98048674e+01  0.00000000e+00]
 [-7.57383059e-03  1.73538260e-02]]
grads:  [-4.64848166e-03 -1.48771436e+01]
Stock Position:  -0.004648481656342713
Bond Position:  [14.3723724]


portfolio before change:  [13.88602429]
curr_Stock_Price:  105.01165915902659
curr_Factors:  [1.05011659e+02 3.45457384e-02]
mat_Sqrt:  [[ 1.95179751e+01  0.00000000e+00]
 [-7.43459357e-03  1.70347939e-02]]
grads:  [-1.61885704e-03 -9.42495868e+00]
Stock Position:  -0.0016188570417171465
Bond Position:  [14.05602315]


portfolio before change:  [13.88853933]
curr_Stock_Price:  104.5434723504848
curr_Factors:  [1.04543472e+02 3.41861088e-02]
mat_Sqrt:  [[ 1.93295505e+01  0.00000000e+00]
 [-7.39579435e-03  1.69458937e-02]]
grads:  [-1.41796014e-02 -2.04706402e+01]
Stock Position:  -0.01417960143256345
Bond Position:  [15.3709241]


portfolio before change:  [13.90062217]
curr_Stock_Price:  103.82685424342225
curr_Factors:  [1.03826854e+02 3.48054529e-02]
mat_Sqrt:  [[ 1.93701659e+01  0.00000000e+00]
 [-7.46248783e-03  1.70987077e-02]]
grads:  [-2.50184073e-04 -6.38021254e+00]
Stock Position:  -0.00025018407324162395
Bond Position:  [13.926598]


portfolio before change:  [13.90245141]
curr_Stock_Price:  103.47389251319592
curr_Factors:  [1.03473893e+02 3.48285554e-02]
mat_Sqrt:  [[ 1.93107222e+01  0.00000000e+00]
 [-7.46496407e-03  1.71043815e-02]]
grads:  [ 0.00668953 -1.67989091]
Stock Position:  0.006689531523446839
Bond Position:  [13.21025954]


portfolio before change:  [13.90403584]
curr_Stock_Price:  103.46388409539338
curr_Factors:  [1.03463884e+02 3.59043619e-02]
mat_Sqrt:  [[ 1.96047986e+01  0.00000000e+00]
 [-7.57937854e-03  1.73665379e-02]]
grads:  [ 1.38126357e-02 -1.91503498e+01]
Stock Position:  0.013812635687582977
Bond Position:  [12.47492691]


portfolio before change:  [13.90949066]
curr_Stock_Price:  103.74589756962821
curr_Factors:  [1.03745898e+02 3.64959979e-02]
mat_Sqrt:  [[ 1.98195392e+01  0.00000000e+00]
 [-7.64157030e-03  1.75090372e-02]]
grads:  [-6.49278636e-03 -2.05328015e+01]
Stock Position:  -0.006492786361496106
Bond Position:  [14.58309061]


portfolio before change:  [13.92094235]
curr_Stock_Price:  102.26291444593011
curr_Factors:  [1.02262914e+02 3.72845030e-02]
mat_Sqrt:  [[ 1.97461461e+01  0.00000000e+00]
 [-7.72367819e-03  1.76971700e-02]]
grads:  [0.00311813 0.67656892]
Stock Position:  0.0031181281056587126
Bond Position:  [13.60207348]


portfolio before change:  [13.91879844]
curr_Stock_Price:  101.03003510749555
curr_Factors:  [1.01030035e+02 3.82237264e-02]
mat_Sqrt:  [[ 1.97522701e+01  0.00000000e+00]
 [-7.82035563e-03  1.79186858e-02]]
grads:  [ 0.00850217 -7.81362535]
Stock Position:  0.008502166776874353
Bond Position:  [13.05982423]


portfolio before change:  [13.91955822]
curr_Stock_Price:  100.92737889865316
curr_Factors:  [1.00927379e+02 3.89735719e-02]
mat_Sqrt:  [[ 1.99248059e+01  0.00000000e+00]
 [-7.89669013e-03  1.80935901e-02]]
grads:  [ 0.00722237 -4.72093831]
Stock Position:  0.007222371549899489
Bond Position:  [13.19062319]


portfolio before change:  [13.91088711]
curr_Stock_Price:  99.49847967061952
curr_Factors:  [9.94984797e+01 3.84513975e-02]
mat_Sqrt:  [[ 1.95106846e+01  0.00000000e+00]
 [-7.84361116e-03  1.79719709e-02]]
grads:  [-1.75236898e-03 -1.38597406e+01]
Stock Position:  -0.0017523689844404161
Bond Position:  [14.08524516]


portfolio before change:  [13.91472561]
curr_Stock_Price:  98.31280751192118
curr_Factors:  [9.83128075e+01 3.76879037e-02]
mat_Sqrt:  [[ 1.90858317e+01  0.00000000e+00]
 [-7.76534905e-03  1.77926499e-02]]
grads:  [4.81812012e-03 5.13974365e+00]
Stock Position:  0.004818120117512414
Bond Position:  [13.44104269]


portfolio before change:  [13.91152544]
curr_Stock_Price:  97.29987973444763
curr_Factors:  [9.72998797e+01 3.89687385e-02]
mat_Sqrt:  [[ 1.92074839e+01  0.00000000e+00]
 [-7.89620045e-03  1.80924681e-02]]
grads:  [ 0.01344722 -2.58252815]
Stock Position:  0.01344722300267281
Bond Position:  [12.60311226]


portfolio before change:  [13.91669676]
curr_Stock_Price:  97.56728320983238
curr_Factors:  [9.75672832e+01 3.98025123e-02]
mat_Sqrt:  [[ 1.94652262e+01  0.00000000e+00]
 [-7.98022680e-03  1.82849967e-02]]
grads:  [-0.03112523 -8.84290543]
Stock Position:  -0.031125233743393384
Bond Position:  [16.95350125]


portfolio before change:  [13.91861063]
curr_Stock_Price:  97.57388401208256
curr_Factors:  [9.7573884e+01 4.0395888e-02]
mat_Sqrt:  [[ 1.96111099e+01  0.00000000e+00]
 [-8.03949133e-03  1.84207888e-02]]
grads:  [-0.00898104 -2.89368889]
Stock Position:  -0.008981039237842627
Bond Position:  [14.79492551]


portfolio before change:  [13.9163954]
curr_Stock_Price:  98.02647166964071
curr_Factors:  [9.80264717e+01 4.06974107e-02]
mat_Sqrt:  [[ 1.97754676e+01  0.00000000e+00]
 [-8.06943970e-03  1.84894091e-02]]
grads:  [-1.06232493e-03 -2.36782735e+00]
Stock Position:  -0.0010623249314297256
Bond Position:  [14.02053137]


portfolio before change:  [13.91766414]
curr_Stock_Price:  98.48201878236341
curr_Factors:  [9.84820188e+01 4.19263723e-02]
mat_Sqrt:  [[ 2.01651096e+01  0.00000000e+00]
 [-8.19037214e-03  1.87665001e-02]]
grads:  [2.06942752e-03 9.07569514e+00]
Stock Position:  0.0020694275221209706
Bond Position:  [13.71386274]


portfolio before change:  [13.91882104]
curr_Stock_Price:  98.21265100623349
curr_Factors:  [9.82126510e+01 4.25510279e-02]
mat_Sqrt:  [[ 2.02592079e+01  0.00000000e+00]
 [-8.25116020e-03  1.89057831e-02]]
grads:  [4.91320487e-04 6.45310599e-01]
Stock Position:  0.0004913204872527902
Bond Position:  [13.87056715]


portfolio before change:  [13.92095983]
curr_Stock_Price:  99.03666503441114
curr_Factors:  [9.90366650e+01 4.39900976e-02]
mat_Sqrt:  [[ 2.07717683e+01  0.00000000e+00]
 [-8.38952658e-03  1.92228203e-02]]
grads:  [7.98809925e-04 2.46767631e+00]
Stock Position:  0.0007988099252979967
Bond Position:  [13.84184835]


portfolio before change:  [13.92175198]
curr_Stock_Price:  97.86219100937052
curr_Factors:  [9.78621910e+01 4.40209061e-02]
mat_Sqrt:  [[ 2.05326226e+01  0.00000000e+00]
 [-8.39246387e-03  1.92295505e-02]]
grads:  [-1.54018847e-03  6.15167946e+00]
Stock Position:  -0.001540188466065097
Bond Position:  [14.0724782]


portfolio before change:  [13.92267143]
curr_Stock_Price:  98.40740185124864
curr_Factors:  [9.84074019e+01 4.31804012e-02]
mat_Sqrt:  [[ 2.04489542e+01  0.00000000e+00]
 [-8.31195777e-03  1.90450878e-02]]
grads:  [-3.73348623e-03 -4.68767222e+00]
Stock Position:  -0.0037334862336429117
Bond Position:  [14.29007411]


portfolio before change:  [13.92382818]
curr_Stock_Price:  98.57604163003035
curr_Factors:  [9.85760416e+01 4.25752681e-02]
mat_Sqrt:  [[ 2.03399589e+01  0.00000000e+00]
 [-8.25351010e-03  1.89111674e-02]]
grads:  [-0.00483607 -2.77804428]
Stock Position:  -0.004836073440592726
Bond Position:  [14.40054916]


portfolio before change:  [13.9235594]
curr_Stock_Price:  99.0038610091681
curr_Factors:  [9.90038610e+01 4.10480187e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.9235594]
Stock Price:  99.94422428277501
PL:  [13.9235594]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.00851099e+00  2.56905345e-01]
 [-2.04329115e-01 -6.61944305e-02]
 [-7.12096092e-01 -2.25155702e-01]
 [-5.03114568e-02 -1.29111767e-01]
 [-1.29003182e-01 -1.01885777e+00]
 [-2.54860106e-01  1.15635506e-01]
 [ 4.22047643e-01 -5.05875202e-01]
 [-9.22792070e-01  5.50343895e-02]
 [-9.11659164e-02 -2.14730769e-01]
 [-7.57396116e-01 -9.31979250e-01]
 [ 9.67996364e-03 -2.38934778e-02]
 [-4.34101720e-01 -3.37006051e-01]
 [ 4.08181212e-02  1.45689098e-01]
 [ 2.15398914e-02 -1.84232839e-01]
 [-3.72976791e-01 -1.71168046e-01]
 [ 6.66945304e-02 -1.45736831e+00]
 [-3.92158092e-04 -6.73765354e-01]
 [ 1.06817477e-01 -2.24626044e-01]
 [-9.83336766e-02 -6.78753030e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 6.61596264e-02 -4.28713776e-03]
 [ 2.75663005e-01 -5.26760363e-01]
 [ 2.73651400e-02 -3.48614062e-01]
 [ 1.40794716e-02  1.42165452e-01]
 [ 4.77266164e-01 -5.16761127e-01]
 [-5.53440453e-01  8.14413246e-02]
 [-1.19721819e-01  2.06431558e-01]
 [-1.20026430e-01 -2.14776622e-01]
 [-7.49815171e-02  2.29323098e-01]
 [-5.16746134e-01  6.52503142e-01]
 [-1.14848675e-01  3.74066406e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-2.07838656e-01 -1.00293832e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-3.58821016e-01 -3.18012456e-02]
 [-2.93030220e-02 -1.59976182e-01]
 [-2.71547592e-03 -6.41494022e-02]
 [ 1.12935922e-01 -2.20785502e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.59700351]
curr_Stock_Price:  101.58443340650088
curr_Factors:  [1.01584433e+02 3.74501680e-02]
mat_Sqrt:  [[ 1.96586662e+01  0.00000000e+00]
 [-7.74081835e-03  1.77364430e-02]]
grads:  [ 0.05700456 14.48460351]
Stock Position:  0.057004563211093304
Bond Position:  [7.80622726]


portfolio before change:  [13.58528099]
curr_Stock_Price:  101.36167295103604
curr_Factors:  [1.01361673e+02 3.79350076e-02]
mat_Sqrt:  [[ 1.97421232e+01  0.00000000e+00]
 [-7.79076454e-03  1.78508841e-02]]
grads:  [-0.01181325 -3.70818779]
Stock Position:  -0.011813254850791537
Bond Position:  [14.78269226]


portfolio before change:  [13.5616309]
curr_Stock_Price:  103.52009922329411
curr_Factors:  [1.03520099e+02 3.68644517e-02]
mat_Sqrt:  [[ 1.98759808e+01  0.00000000e+00]
 [-7.68004705e-03  1.75971985e-02]]
grads:  [ -0.04077092 -12.7949743 ]
Stock Position:  -0.04077092366347532
Bond Position:  [17.78224097]


portfolio before change:  [13.58022171]
curr_Stock_Price:  103.11863938575799
curr_Factors:  [1.03118639e+02 3.71189122e-02]
mat_Sqrt:  [[ 1.98671145e+01  0.00000000e+00]
 [-7.70650761e-03  1.76578272e-02]]
grads:  [-5.36869365e-03 -7.31187166e+00]
Stock Position:  -0.005368693653926022
Bond Position:  [14.13383409]


portfolio before change:  [13.57109188]
curr_Stock_Price:  105.14830743932214
curr_Factors:  [1.05148307e+02 3.63673799e-02]
mat_Sqrt:  [[ 2.00520276e+01  0.00000000e+00]
 [-7.62809333e-03  1.74781575e-02]]
grads:  [-2.86090354e-02 -5.82932019e+01]
Stock Position:  -0.028609035416772868
Bond Position:  [16.57928354]


portfolio before change:  [13.58055779]
curr_Stock_Price:  104.88987985473047
curr_Factors:  [1.04889880e+02 3.64386475e-02]
mat_Sqrt:  [[ 2.00223345e+01  0.00000000e+00]
 [-7.63556390e-03  1.74952748e-02]]
grads:  [-0.01020823  6.60952787]
Stock Position:  -0.010208231876129232
Bond Position:  [14.651298]


portfolio before change:  [13.58246666]
curr_Stock_Price:  104.88230318660503
curr_Factors:  [1.04882303e+02 3.61669601e-02]
mat_Sqrt:  [[ 1.99461104e+01  0.00000000e+00]
 [-7.60704516e-03  1.74299301e-02]]
grads:  [ 1.00904688e-02 -2.90233637e+01]
Stock Position:  0.010090468774593428
Bond Position:  [12.52415505]


portfolio before change:  [13.59891602]
curr_Stock_Price:  106.35733358789072
curr_Factors:  [1.06357334e+02 3.37890256e-02]
mat_Sqrt:  [[ 1.95503832e+01  0.00000000e+00]
 [-7.35271657e-03  1.68471901e-02]]
grads:  [-0.04597215  3.26668062]
Stock Position:  -0.04597214706672672
Bond Position:  [18.48839101]


portfolio before change:  [13.56524785]
curr_Stock_Price:  107.13996756757975
curr_Factors:  [1.07139968e+02 3.39069884e-02]
mat_Sqrt:  [[ 1.97285933e+01  0.00000000e+00]
 [-7.36554013e-03  1.68765726e-02]]
grads:  [-9.37127673e-03 -1.27236006e+01]
Stock Position:  -0.009371276725623382
Bond Position:  [14.56928614]


portfolio before change:  [13.56257056]
curr_Stock_Price:  107.62000558943653
curr_Factors:  [1.07620006e+02 3.30024831e-02]
mat_Sqrt:  [[ 1.95508804e+01  0.00000000e+00]
 [-7.26663422e-03  1.66499507e-02]]
grads:  [ -0.05954439 -55.97489551]
Stock Position:  -0.05954438795246143
Bond Position:  [19.97073792]


portfolio before change:  [13.58150919]
curr_Stock_Price:  107.34387318983175
curr_Factors:  [1.07343873e+02 3.16582782e-02]
mat_Sqrt:  [[ 1.90994520e+01  0.00000000e+00]
 [-7.11710932e-03  1.63073461e-02]]
grads:  [-3.91636894e-05 -1.46519720e+00]
Stock Position:  -3.9163689401113024e-05
Bond Position:  [13.58571317]


portfolio before change:  [13.58317897]
curr_Stock_Price:  108.07268797045639
curr_Factors:  [1.08072688e+02 3.12754857e-02]
mat_Sqrt:  [[ 1.91125214e+01  0.00000000e+00]
 [-7.07395061e-03  1.62084571e-02]]
grads:  [ -0.03040851 -20.79198837]
Stock Position:  -0.030408505803257137
Bond Position:  [16.86950793]


portfolio before change:  [13.5849596]
curr_Stock_Price:  108.08348057670112
curr_Factors:  [1.08083481e+02 3.30802859e-02]
mat_Sqrt:  [[ 1.96582090e+01  0.00000000e+00]
 [-7.27519467e-03  1.66695651e-02]]
grads:  [5.31086307e-03 8.73982597e+00]
Stock Position:  0.0053108630746101755
Bond Position:  [13.01094304]


portfolio before change:  [13.59395331]
curr_Stock_Price:  109.47068234814236
curr_Factors:  [1.09470682e+02 3.23763445e-02]
mat_Sqrt:  [[ 1.96975282e+01  0.00000000e+00]
 [-7.19737113e-03  1.64912490e-02]]
grads:  [-2.98849229e-03 -1.11715516e+01]
Stock Position:  -0.002988492292652892
Bond Position:  [13.9211056]


portfolio before change:  [13.59677015]
curr_Stock_Price:  109.11043778531844
curr_Factors:  [1.09110438e+02 3.07930868e-02]
mat_Sqrt:  [[ 1.91466550e+01  0.00000000e+00]
 [-7.01918364e-03  1.60829702e-02]]
grads:  [ -0.02338166 -10.64281309]
Stock Position:  -0.023381663835893993
Bond Position:  [16.14795372]


portfolio before change:  [13.57389539]
curr_Stock_Price:  110.17509144994926
curr_Factors:  [1.10175091e+02 3.01756366e-02]
mat_Sqrt:  [[ 1.91386650e+01  0.00000000e+00]
 [-6.94845441e-03  1.59209091e-02]]
grads:  [-2.97488432e-02 -9.15380079e+01]
Stock Position:  -0.029748843205754372
Bond Position:  [16.85147691]


portfolio before change:  [13.54549217]
curr_Stock_Price:  111.20067034126403
curr_Factors:  [1.11200670e+02 2.85872214e-02]
mat_Sqrt:  [[ 1.88015380e+01  0.00000000e+00]
 [-6.76310241e-03  1.54962144e-02]]
grads:  [-1.56608180e-02 -4.34793517e+01]
Stock Position:  -0.015660818041777668
Bond Position:  [15.28698564]


portfolio before change:  [13.56785689]
curr_Stock_Price:  109.89462605779948
curr_Factors:  [1.09894626e+02 2.75746107e-02]
mat_Sqrt:  [[ 1.82486672e+01  0.00000000e+00]
 [-6.64224188e-03  1.52192881e-02]]
grads:  [ 4.81275357e-04 -1.47593003e+01]
Stock Position:  0.000481275357392876
Bond Position:  [13.51496731]


portfolio before change:  [13.56902554]
curr_Stock_Price:  108.81246040879655
curr_Factors:  [1.08812460e+02 2.80143059e-02]
mat_Sqrt:  [[ 1.82124580e+01  0.00000000e+00]
 [-6.69498988e-03  1.53401490e-02]]
grads:  [-0.00702579 -4.42468344]
Stock Position:  -0.0070257890081870805
Bond Position:  [14.33351893]


portfolio before change:  [13.56812439]
curr_Stock_Price:  109.19575560209115
curr_Factors:  [1.09195756e+02 2.81043727e-02]
mat_Sqrt:  [[ 1.83059683e+01  0.00000000e+00]
 [-6.70574353e-03  1.53647887e-02]]
grads:  [-2.64728253e-04 -7.10022062e+00]
Stock Position:  -0.0002647282531168787
Bond Position:  [13.5970316]


portfolio before change:  [13.56999974]
curr_Stock_Price:  108.53238955845292
curr_Factors:  [1.08532390e+02 2.83150236e-02]
mat_Sqrt:  [[ 1.82628196e+01  0.00000000e+00]
 [-6.73082742e-03  1.54222631e-02]]
grads:  [ 0.00352019 -0.2779837 ]
Stock Position:  0.0035201884200732436
Bond Position:  [13.18794528]


portfolio before change:  [13.56744831]
curr_Stock_Price:  107.33926516329822
curr_Factors:  [1.07339265e+02 2.82294887e-02]
mat_Sqrt:  [[ 1.80347499e+01  0.00000000e+00]
 [-6.72065338e-03  1.53989514e-02]]
grads:  [ 2.53765285e-03 -3.42075476e+01]
Stock Position:  0.002537652846064278
Bond Position:  [13.29505852]


portfolio before change:  [13.57025465]
curr_Stock_Price:  107.79021503713383
curr_Factors:  [1.07790215e+02 2.80091948e-02]
mat_Sqrt:  [[ 1.80397141e+01  0.00000000e+00]
 [-6.69437911e-03  1.53387495e-02]]
grads:  [-6.91710022e-03 -2.27276716e+01]
Stock Position:  -0.006917100216950988
Bond Position:  [14.31585037]


portfolio before change:  [13.57801331]
curr_Stock_Price:  106.92727169862717
curr_Factors:  [1.06927272e+02 2.72045358e-02]
mat_Sqrt:  [[ 1.76363677e+01  0.00000000e+00]
 [-6.59751902e-03  1.51168152e-02]]
grads:  [4.31639682e-03 9.40445792e+00]
Stock Position:  0.004316396822199318
Bond Position:  [13.11647278]


portfolio before change:  [13.58137066]
curr_Stock_Price:  107.32521681548052
curr_Factors:  [1.07325217e+02 2.71477564e-02]
mat_Sqrt:  [[ 1.76835211e+01  0.00000000e+00]
 [-6.59063049e-03  1.51010315e-02]]
grads:  [ 1.42354634e-02 -3.42202535e+01]
Stock Position:  0.01423546340685132
Bond Position:  [12.05354647]


portfolio before change:  [13.57953772]
curr_Stock_Price:  107.09061038545688
curr_Factors:  [1.07090610e+02 2.67883408e-02]
mat_Sqrt:  [[ 1.75276746e+01  0.00000000e+00]
 [-6.54685767e-03  1.50007354e-02]]
grads:  [-0.02954736  5.42915546]
Stock Position:  -0.029547361904018393
Bond Position:  [16.74378274]


portfolio before change:  [13.57291629]
curr_Stock_Price:  107.38554483028267
curr_Factors:  [1.07385545e+02 2.72787798e-02]
mat_Sqrt:  [[ 1.77361068e+01  0.00000000e+00]
 [-6.60651555e-03  1.51374288e-02]]
grads:  [-1.67047372e-03  1.36371613e+01]
Stock Position:  -0.0016704737171860057
Bond Position:  [13.75230102]


portfolio before change:  [13.57567725]
curr_Stock_Price:  106.76187735351213
curr_Factors:  [1.06761877e+02 2.77699293e-02]
mat_Sqrt:  [[ 1.77911323e+01  0.00000000e+00]
 [-6.66572478e-03  1.52730942e-02]]
grads:  [-1.20151224e-02 -1.40624172e+01]
Stock Position:  -0.012015122399922558
Bond Position:  [14.85843428]


portfolio before change:  [13.5607075]
curr_Stock_Price:  108.16237738474406
curr_Factors:  [1.08162377e+02 2.78923595e-02]
mat_Sqrt:  [[ 1.80642049e+01  0.00000000e+00]
 [-6.68040232e-03  1.53067247e-02]]
grads:  [1.38967025e-03 1.49818530e+01]
Stock Position:  0.0013896702483005652
Bond Position:  [13.41039746]


portfolio before change:  [13.56194176]
curr_Stock_Price:  107.84421389037404
curr_Factors:  [1.07844214e+02 2.80244531e-02]
mat_Sqrt:  [[ 1.80536668e+01  0.00000000e+00]
 [-6.69620228e-03  1.53429269e-02]]
grads:  [-1.28489364e-02  4.25279444e+01]
Stock Position:  -0.01284893641245587
Bond Position:  [14.9476252]


portfolio before change:  [13.56868873]
curr_Stock_Price:  107.4645403266006
curr_Factors:  [1.07464540e+02 2.83283889e-02]
mat_Sqrt:  [[ 1.80873992e+01  0.00000000e+00]
 [-6.73241577e-03  1.54259024e-02]]
grads:  [-0.00544706  2.42492397]
Stock Position:  -0.005447056162560056
Bond Position:  [14.15405412]


portfolio before change:  [13.56924771]
curr_Stock_Price:  107.68674937395257
curr_Factors:  [1.07686749e+02 2.79700035e-02]
mat_Sqrt:  [[ 1.80097850e+01  0.00000000e+00]
 [-6.68969398e-03  1.53280145e-02]]
grads:  [ 0.00402795 -0.77943488]
Stock Position:  0.004027954628911871
Bond Position:  [13.13549037]


portfolio before change:  [13.56938217]
curr_Stock_Price:  107.31246901035918
curr_Factors:  [1.07312469e+02 2.74150586e-02]
mat_Sqrt:  [[ 1.77682549e+01  0.00000000e+00]
 [-6.62299734e-03  1.51751933e-02]]
grads:  [-0.01416067 -6.60906453]
Stock Position:  -0.01416067439577238
Bond Position:  [15.0889991]


portfolio before change:  [13.56460393]
curr_Stock_Price:  107.78310170278614
curr_Factors:  [1.07783102e+02 2.74103626e-02]
mat_Sqrt:  [[ 1.78446514e+01  0.00000000e+00]
 [-6.62243008e-03  1.51738936e-02]]
grads:  [0.00568636 3.5158452 ]
Stock Position:  0.005686363355751724
Bond Position:  [12.95171005]


portfolio before change:  [13.56357753]
curr_Stock_Price:  107.31787207921087
curr_Factors:  [1.07317872e+02 2.82790666e-02]
mat_Sqrt:  [[ 1.80469821e+01  0.00000000e+00]
 [-6.72655235e-03  1.54124676e-02]]
grads:  [-5.24562003e-03  5.27658179e+00]
Stock Position:  -0.00524562002647681
Bond Position:  [14.12652631]


portfolio before change:  [13.57379258]
curr_Stock_Price:  105.70717200287898
curr_Factors:  [1.05707172e+02 2.92434306e-02]
mat_Sqrt:  [[ 1.80766777e+01  0.00000000e+00]
 [-6.84028428e-03  1.56730602e-02]]
grads:  [-0.02061774 -2.02903869]
Stock Position:  -0.0206177387537939
Bond Position:  [15.75323544]


portfolio before change:  [13.57652337]
curr_Stock_Price:  105.67023735862485
curr_Factors:  [1.05670237e+02 2.81132447e-02]
mat_Sqrt:  [[ 1.77177337e+01  0.00000000e+00]
 [-6.70680188e-03  1.53672136e-02]]
grads:  [-5.59452771e-03 -1.04102270e+01]
Stock Position:  -0.005594527714894299
Bond Position:  [14.16769844]


portfolio before change:  [13.57239551]
curr_Stock_Price:  106.72464776378011
curr_Factors:  [1.06724648e+02 2.71940519e-02]
mat_Sqrt:  [[ 1.75995552e+01  0.00000000e+00]
 [-6.59624764e-03  1.51139021e-02]]
grads:  [-1.74507651e-03 -4.24439711e+00]
Stock Position:  -0.0017450765134692642
Bond Position:  [13.75863819]


portfolio before change:  [13.57714892]
curr_Stock_Price:  104.98634265819975
curr_Factors:  [1.04986343e+02 2.88083006e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.57714892]
Stock Price:  105.90283411460086
PL:  [7.67431481]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.47797886e+00  3.63042622e-01]
 [ 9.42663149e-01  8.20161321e-02]
 [ 9.49112122e-02 -3.01604513e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-9.12083258e-02  3.96343156e-02]
 [-3.13451067e-01  1.38102702e-01]
 [ 2.46376030e-01 -2.75339363e-01]
 [-6.24405554e-01  1.48513770e-01]
 [-1.13464176e-01 -1.03319553e-01]
 [-3.36231575e-01 -5.70575631e-01]
 [-6.87412330e-02 -1.28156411e-02]
 [-1.81197238e-02 -1.36128905e-01]
 [-9.38345842e-02 -2.36061331e-02]
 [-3.62233429e-02 -4.28337943e-02]
 [ 3.61948184e-01  2.23089965e-01]
 [ 1.35286975e-01 -3.83721206e-01]
 [ 3.84961166e-02  1.28979058e-02]
 [ 1.33104568e-02 -1.01990382e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [-3.22229462e-01  1.15055930e-01]
 [ 1.38678401e-01  1.73607301e-02]
 [ 1.56524242e+00  1.84013842e-01]
 [ 1.61084534e-02  3.96864109e-01]
 [-1.40594388e-01  1.41310254e-01]
 [-1.82769361e-01  1.02351992e-01]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 2.63827880e-01 -4.35755518e-01]
 [ 1.29249152e-01 -7.28957023e-02]
 [ 8.10264529e-01 -3.25346581e-01]
 [-8.56968883e-01 -3.74675701e-01]
 [ 7.05163116e-01  2.63303494e-01]
 [-2.32478718e-01  3.51926488e-01]
 [ 6.91071423e-01  2.19599426e-01]
 [ 6.42616205e-02 -1.34947221e-01]
 [ 3.21773469e-01 -4.61090774e-01]
 [ 1.47174169e-01  3.94161866e-03]
 [-8.41843619e-02  6.25737720e-01]
 [-4.11497117e-01 -1.49289839e-01]
 [-6.38044933e-01  1.53093831e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.79160784]
curr_Stock_Price:  99.35070006229294
curr_Factors:  [9.93507001e+01 4.20306034e-02]
mat_Sqrt:  [[ 2.03682513e+01  0.00000000e+00]
 [-8.20054666e-03  1.87898129e-02]]
grads:  [ 0.08034188 19.32124734]
Stock Position:  0.08034188237987931
Bond Position:  [-9.77363009]


portfolio before change:  [-1.83916049]
curr_Stock_Price:  98.77402856496373
curr_Factors:  [9.87740286e+01 4.37232448e-02]
mat_Sqrt:  [[ 2.06537521e+01  0.00000000e+00]
 [-8.36404159e-03  1.91644269e-02]]
grads:  [0.04737434 4.27960266]
Stock Position:  0.04737434246086745
Bond Position:  [-6.51851514]


portfolio before change:  [-1.84351704]
curr_Stock_Price:  98.6992688996836
curr_Factors:  [9.86992689e+01 4.50642428e-02]
mat_Sqrt:  [[ 2.09522166e+01  0.00000000e+00]
 [-8.49133608e-03  1.94560952e-02]]
grads:  [ 0.00390165 -1.55018009]
Stock Position:  0.0039016450478657158
Bond Position:  [-2.22860656]


portfolio before change:  [-1.84339285]
curr_Stock_Price:  98.80250338130583
curr_Factors:  [9.88025034e+01 4.51015027e-02]
mat_Sqrt:  [[ 2.09828007e+01  0.00000000e+00]
 [-8.49484575e-03  1.94641368e-02]]
grads:  [-7.76891857e-04 -7.77773059e+00]
Stock Position:  -0.0007768918565421116
Bond Position:  [-1.76663399]


portfolio before change:  [-1.84487441]
curr_Stock_Price:  100.42527037928623
curr_Factors:  [1.00425270e+02 4.45814826e-02]
mat_Sqrt:  [[ 2.12041205e+01  0.00000000e+00]
 [-8.44573100e-03  1.93516008e-02]]
grads:  [-0.00348567  2.04811561]
Stock Position:  -0.003485666496363394
Bond Position:  [-1.49482541]


portfolio before change:  [-1.84814914]
curr_Stock_Price:  101.31114477397958
curr_Factors:  [1.01311145e+02 4.62134282e-02]
mat_Sqrt:  [[ 2.17791696e+01  0.00000000e+00]
 [-8.59892349e-03  1.97026089e-02]]
grads:  [-0.01162478  7.0093612 ]
Stock Position:  -0.011624782345981513
Bond Position:  [-0.67042913]


portfolio before change:  [-1.86182952]
curr_Stock_Price:  102.48076391844333
curr_Factors:  [1.02480764e+02 4.51025243e-02]
mat_Sqrt:  [[ 2.17642035e+01  0.00000000e+00]
 [-8.49494196e-03  1.94643573e-02]]
grads:  [ 5.79888349e-03 -1.41458235e+01]
Stock Position:  0.005798883494564873
Bond Position:  [-2.45610353]


portfolio before change:  [-1.85688034]
curr_Stock_Price:  103.3871813449342
curr_Factors:  [1.03387181e+02 4.42817119e-02]
mat_Sqrt:  [[ 2.17559923e+01  0.00000000e+00]
 [-8.41728810e-03  1.92864299e-02]]
grads:  [-0.02572114  7.70042824]
Stock Position:  -0.025721135766906822
Bond Position:  [0.80235539]


portfolio before change:  [-1.86086628]
curr_Stock_Price:  103.54604855440118
curr_Factors:  [1.03546049e+02 4.40358141e-02]
mat_Sqrt:  [[ 2.17288402e+01  0.00000000e+00]
 [-8.39388483e-03  1.92328063e-02]]
grads:  [-0.00729705 -5.37204772]
Stock Position:  -0.007297054288449492
Bond Position:  [-1.10528514]


portfolio before change:  [-1.86193632]
curr_Stock_Price:  103.67375360792522
curr_Factors:  [1.03673754e+02 4.46416688e-02]
mat_Sqrt:  [[ 2.19047869e+01  0.00000000e+00]
 [-8.45143006e-03  1.93646590e-02]]
grads:  [-2.67179588e-02 -2.94647911e+01]
Stock Position:  -0.026717958831059388
Bond Position:  [0.90801476]


portfolio before change:  [-1.8402806]
curr_Stock_Price:  102.86747146864687
curr_Factors:  [1.02867471e+02 4.56581782e-02]
mat_Sqrt:  [[ 2.19804892e+01  0.00000000e+00]
 [-8.54710975e-03  1.95838887e-02]]
grads:  [-0.00338184 -0.65439716]
Stock Position:  -0.0033818372547241974
Bond Position:  [-1.49239955]


portfolio before change:  [-1.83688385]
curr_Stock_Price:  101.80789586041489
curr_Factors:  [1.01807896e+02 4.59229489e-02]
mat_Sqrt:  [[ 2.18170660e+01  0.00000000e+00]
 [-8.57185617e-03  1.96405899e-02]]
grads:  [-3.55369730e-03 -6.93099881e+00]
Stock Position:  -0.003553697303571743
Bond Position:  [-1.47508941]


portfolio before change:  [-1.83289722]
curr_Stock_Price:  100.63418151400711
curr_Factors:  [1.00634182e+02 4.62879958e-02]
mat_Sqrt:  [[ 2.16510871e+01  0.00000000e+00]
 [-8.60585808e-03  1.97184980e-02]]
grads:  [-0.00480979 -1.19715675]
Stock Position:  -0.004809788291373092
Bond Position:  [-1.34886811]


portfolio before change:  [-1.83661963]
curr_Stock_Price:  101.3730469357744
curr_Factors:  [1.01373047e+02 4.54763432e-02]
mat_Sqrt:  [[ 2.16179878e+01  0.00000000e+00]
 [-8.53007322e-03  1.95448531e-02]]
grads:  [-0.00254036 -2.19156389]
Stock Position:  -0.002540363322250678
Bond Position:  [-1.57909526]


portfolio before change:  [-1.83625844]
curr_Stock_Price:  101.15316122300447
curr_Factors:  [1.01153161e+02 4.61192609e-02]
mat_Sqrt:  [[ 2.17230414e+01  0.00000000e+00]
 [-8.59015818e-03  1.96825250e-02]]
grads:  [ 0.02114403 11.33441797]
Stock Position:  0.021144029486136334
Bond Position:  [-3.97504386]


portfolio before change:  [-1.83724948]
curr_Stock_Price:  101.12979150581198
curr_Factors:  [1.01129792e+02 4.58142827e-02]
mat_Sqrt:  [[ 2.16460949e+01  0.00000000e+00]
 [-8.56170849e-03  1.96173386e-02]]
grads:  [-1.48676652e-03 -1.95603091e+01]
Stock Position:  -0.0014867665160902266
Bond Position:  [-1.68689309]


portfolio before change:  [-1.83677074]
curr_Stock_Price:  100.66595530942222
curr_Factors:  [1.00665955e+02 4.75657067e-02]
mat_Sqrt:  [[ 2.19548056e+01  0.00000000e+00]
 [-8.72382546e-03  1.99887953e-02]]
grads:  [0.00200982 0.64525679]
Stock Position:  0.0020098207659143036
Bond Position:  [-2.03909126]


portfolio before change:  [-1.83783301]
curr_Stock_Price:  100.26424493014392
curr_Factors:  [1.00264245e+02 4.69754649e-02]
mat_Sqrt:  [[ 2.17310960e+01  0.00000000e+00]
 [-8.66952962e-03  1.98643879e-02]]
grads:  [-1.43581323e-03 -5.13433300e+00]
Stock Position:  -0.001435813232493482
Bond Position:  [-1.69387228]


portfolio before change:  [-1.83784917]
curr_Stock_Price:  100.12802521328155
curr_Factors:  [1.00128025e+02 4.57458413e-02]
mat_Sqrt:  [[ 2.14156599e+01  0.00000000e+00]
 [-8.55531099e-03  1.96026801e-02]]
grads:  [-1.48850489e-02 -2.39399736e+01]
Stock Position:  -0.014885048914064015
Bond Position:  [-0.34743861]


portfolio before change:  [-1.79405042]
curr_Stock_Price:  97.18264166943165
curr_Factors:  [9.71826417e+01 4.70366534e-02]
mat_Sqrt:  [[ 2.10769084e+01  0.00000000e+00]
 [-8.67517408e-03  1.98773210e-02]]
grads:  [-0.01290583  5.78830165]
Stock Position:  -0.012905827209804889
Bond Position:  [-0.53982804]


portfolio before change:  [-1.79319333]
curr_Stock_Price:  97.11100130818689
curr_Factors:  [9.71110013e+01 4.68320753e-02]
mat_Sqrt:  [[ 2.10155197e+01  0.00000000e+00]
 [-8.65628791e-03  1.98340473e-02]]
grads:  [0.00695939 0.87529942]
Stock Position:  0.006959392244351138
Bond Position:  [-2.46902688]


portfolio before change:  [-1.80994053]
curr_Stock_Price:  94.74893393391717
curr_Factors:  [9.47489339e+01 4.71386126e-02]
mat_Sqrt:  [[ 2.05713470e+01  0.00000000e+00]
 [-8.68457139e-03  1.98988529e-02]]
grads:  [0.07999246 9.24745981]
Stock Position:  0.07999245940152865
Bond Position:  [-9.38914078]


portfolio before change:  [-1.70040178]
curr_Stock_Price:  96.13297016466551
curr_Factors:  [9.61329702e+01 4.69323737e-02]
mat_Sqrt:  [[ 2.08261322e+01  0.00000000e+00]
 [-8.66555237e-03  1.98552748e-02]]
grads:  [9.09022130e-03 1.99878426e+01]
Stock Position:  0.009090221295626161
Bond Position:  [-2.57427175]


portfolio before change:  [-1.70743742]
curr_Stock_Price:  95.39439287394853
curr_Factors:  [9.53943929e+01 4.71346828e-02]
mat_Sqrt:  [[ 2.07106220e+01  0.00000000e+00]
 [-8.68420938e-03  1.98980234e-02]]
grads:  [-3.81067922e-03  7.10172318e+00]
Stock Position:  -0.003810679216909418
Bond Position:  [-1.34391999]


portfolio before change:  [-1.70109307]
curr_Stock_Price:  93.68542038998947
curr_Factors:  [9.36854204e+01 4.78479289e-02]
mat_Sqrt:  [[ 2.04929076e+01  0.00000000e+00]
 [-8.74966778e-03  2.00480074e-02]]
grads:  [-0.00673888  5.10534486]
Stock Position:  -0.006738882166619324
Bond Position:  [-1.06975806]


portfolio before change:  [-1.70047762]
curr_Stock_Price:  93.57424853584122
curr_Factors:  [9.35742485e+01 4.82045960e-02]
mat_Sqrt:  [[ 2.05447363e+01  0.00000000e+00]
 [-8.78221803e-03  2.01225895e-02]]
grads:  [ 0.00893069 -3.62754194]
Stock Position:  0.00893068666312964
Bond Position:  [-2.53615992]


portfolio before change:  [-1.7100295]
curr_Stock_Price:  92.54019207386358
curr_Factors:  [9.25401921e+01 4.93197590e-02]
mat_Sqrt:  [[ 2.05513743e+01  0.00000000e+00]
 [-8.88322095e-03  2.03540162e-02]]
grads:  [ 3.58363288e-03 -2.14088224e+01]
Stock Position:  0.0035836328785150812
Bond Position:  [-2.04165957]


portfolio before change:  [-1.71455009]
curr_Stock_Price:  91.34995578265351
curr_Factors:  [9.13499558e+01 4.84168456e-02]
mat_Sqrt:  [[ 2.01004873e+01  0.00000000e+00]
 [-8.80153128e-03  2.01668417e-02]]
grads:  [ 0.00484739 -3.61463156]
Stock Position:  0.004847387888115461
Bond Position:  [-2.15735876]


portfolio before change:  [-1.72020768]
curr_Stock_Price:  90.23845061573041
curr_Factors:  [9.02384506e+01 4.90116043e-02]
mat_Sqrt:  [[ 1.99774977e+01  0.00000000e+00]
 [-8.85542584e-03  2.02903296e-02]]
grads:  [  0.03345122 -16.03456363]
Stock Position:  0.03345121848674075
Bond Position:  [-4.7387938]


portfolio before change:  [-1.7578505]
curr_Stock_Price:  89.13085466385733
curr_Factors:  [8.91308547e+01 4.86458573e-02]
mat_Sqrt:  [[ 1.96585283e+01  0.00000000e+00]
 [-8.82232235e-03  2.02144800e-02]]
grads:  [ -0.05191084 -18.53501556]
Stock Position:  -0.05191084246178295
Bond Position:  [2.86900726]


portfolio before change:  [-1.76051337]
curr_Stock_Price:  89.18906062172204
curr_Factors:  [8.91890606e+01 4.80248890e-02]
mat_Sqrt:  [[ 1.95454095e+01  0.00000000e+00]
 [-8.76583267e-03  2.00850459e-02]]
grads:  [ 0.04195758 13.10942957]
Stock Position:  0.04195758499069301
Bond Position:  [-5.50267096]


portfolio before change:  [-1.70638131]
curr_Stock_Price:  90.49561655556079
curr_Factors:  [9.04956166e+01 4.86494070e-02]
mat_Sqrt:  [[ 1.99602657e+01  0.00000000e+00]
 [-8.82264423e-03  2.02152175e-02]]
grads:  [-3.95212205e-03  1.74089884e+01]
Stock Position:  -0.003952122053537267
Bond Position:  [-1.34873159]


portfolio before change:  [-1.70985395]
curr_Stock_Price:  91.33163303463067
curr_Factors:  [9.13316330e+01 4.86861347e-02]
mat_Sqrt:  [[ 2.01522653e+01  0.00000000e+00]
 [-8.82597392e-03  2.02228468e-02]]
grads:  [ 0.03904834 10.8589769 ]
Stock Position:  0.03904833821135414
Bond Position:  [-5.27620245]


portfolio before change:  [-1.74526877]
curr_Stock_Price:  90.44157592447748
curr_Factors:  [9.04415759e+01 4.74680986e-02]
mat_Sqrt:  [[ 1.97046643e+01  0.00000000e+00]
 [-8.71486993e-03  1.99682756e-02]]
grads:  [ 2.72312413e-04 -6.75808088e+00]
Stock Position:  0.0002723124129935298
Bond Position:  [-1.76989714]


portfolio before change:  [-1.74564334]
curr_Stock_Price:  89.87855755975495
curr_Factors:  [8.98785576e+01 4.70531890e-02]
mat_Sqrt:  [[ 1.94962294e+01  0.00000000e+00]
 [-8.67669882e-03  1.98808146e-02]]
grads:  [ 6.18257790e-03 -2.31927506e+01]
Stock Position:  0.006182577900000337
Bond Position:  [-2.30132452]


portfolio before change:  [-1.74751136]
curr_Stock_Price:  89.62294648355675
curr_Factors:  [8.96229465e+01 4.58824248e-02]
mat_Sqrt:  [[ 1.91973993e+01  0.00000000e+00]
 [-8.56807328e-03  1.96319222e-02]]
grads:  [0.00775597 0.20077599]
Stock Position:  0.007755968896507642
Bond Position:  [-2.44262414]


portfolio before change:  [-1.74834273]
curr_Stock_Price:  89.5551247946781
curr_Factors:  [8.95551248e+01 4.64640173e-02]
mat_Sqrt:  [[ 1.93040672e+01  0.00000000e+00]
 [-8.62220550e-03  1.97559547e-02]]
grads:  [9.78601899e-03 3.16733729e+01]
Stock Position:  0.009786018988671033
Bond Position:  [-2.62473088]


portfolio before change:  [-1.76037523]
curr_Stock_Price:  88.3590933188656
curr_Factors:  [8.83590933e+01 4.55916373e-02]
mat_Sqrt:  [[ 1.88666088e+01  0.00000000e+00]
 [-8.54087932e-03  1.95696130e-02]]
grads:  [-0.02526435 -7.62865565]
Stock Position:  -0.025264346595399556
Bond Position:  [0.47195953]


portfolio before change:  [-1.72620893]
curr_Stock_Price:  87.009076432087
curr_Factors:  [8.70090764e+01 4.64645162e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.72620893]
Stock Price:  88.05497965729948
PL:  [-1.72620893]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.32382254e+00  3.28190967e-01]
 [ 1.13987986e+00  6.40836080e-02]
 [-9.93623227e-02  1.33614229e-01]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.03387131e-01  6.80325898e-01]
 [ 1.06327779e-02 -5.99247980e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 9.87790101e-01  9.97564404e-01]
 [ 2.13708906e-02  3.89403899e-01]
 [ 1.95146189e-01  1.09637323e-01]
 [-1.09985921e-01  2.94604068e-03]
 [ 3.38371457e-02 -1.37341171e-01]
 [-1.17106251e-01 -2.80514051e-02]
 [-6.74800708e-02  3.26959090e-02]
 [ 5.18233371e-01  3.39844877e-01]
 [ 1.29957079e-01 -9.07836652e-02]
 [ 3.96075232e-02  9.91112057e-02]
 [ 2.78230449e-02 -1.48939250e-01]
 [-1.13959225e-01 -4.69287644e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.55210013e-01 -3.30631285e-02]
 [ 3.42500222e-01 -3.76187656e-01]
 [ 2.72722372e-02 -3.42682744e-01]
 [ 1.21700731e-02  1.50599354e-01]
 [ 4.57868516e-01 -4.56575253e-01]
 [-4.69548007e-01  6.62905267e-02]
 [-1.21862254e-01  1.99961839e-01]
 [-1.01292993e-01 -1.36160338e-01]
 [-8.12321728e-02  2.22799016e-01]
 [-5.20881526e-01  6.44817471e-01]
 [-9.91307606e-02  6.62985016e-02]
 [ 7.77567776e-02 -1.19471891e-02]
 [-1.90513739e-01 -1.51138201e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.14897965e-01 -8.96454033e-02]
 [-3.06156846e-02 -1.47821615e-01]
 [ 3.63800189e-04 -6.40087542e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.81417167]
curr_Stock_Price:  100.01925182637837
curr_Factors:  [1.00019252e+02 4.14298955e-02]
mat_Sqrt:  [[ 2.03582536e+01  0.00000000e+00]
 [-8.14173402e-03  1.86550562e-02]]
grads:  [ 0.07206202 17.59260134]
Stock Position:  0.07206201695724535
Bond Position:  [-4.39341735]


portfolio before change:  [2.68037916]
curr_Stock_Price:  98.17024311649865
curr_Factors:  [9.81702431e+01 4.24026828e-02]
mat_Sqrt:  [[ 2.02151298e+01  0.00000000e+00]
 [-8.23676469e-03  1.88727988e-02]]
grads:  [0.057771   3.39555402]
Stock Position:  0.0577709986784393
Bond Position:  [-2.99101382]


portfolio before change:  [2.61942795]
curr_Stock_Price:  97.12166655324684
curr_Factors:  [9.71216666e+01 4.13255113e-02]
mat_Sqrt:  [[ 1.97435500e+01  0.00000000e+00]
 [-8.13147085e-03  1.86315403e-02]]
grads:  [-2.07907355e-03  7.17140001e+00]
Stock Position:  -0.002079073549679701
Bond Position:  [2.82135104]


portfolio before change:  [2.62051323]
curr_Stock_Price:  96.76930465622198
curr_Factors:  [9.67693047e+01 4.23286941e-02]
mat_Sqrt:  [[ 1.99092571e+01  0.00000000e+00]
 [-8.22957536e-03  1.88563260e-02]]
grads:  [-8.18783285e-04 -8.02843631e+00]
Stock Position:  -0.0008187832849998716
Bond Position:  [2.69974632]


portfolio before change:  [2.61995118]
curr_Stock_Price:  97.86792974756288
curr_Factors:  [9.78679297e+01 4.33873164e-02]
mat_Sqrt:  [[ 2.03855201e+01  0.00000000e+00]
 [-8.33184891e-03  1.90906642e-02]]
grads:  [9.49357347e-03 3.56365757e+01]
Stock Position:  0.009493573465161938
Bond Position:  [1.6908348]


portfolio before change:  [2.61491193]
curr_Stock_Price:  97.31485886378215
curr_Factors:  [9.73148589e+01 4.35985863e-02]
mat_Sqrt:  [[ 2.03196097e+01  0.00000000e+00]
 [-8.35210980e-03  1.91370877e-02]]
grads:  [-7.63821172e-04 -3.13134365e+00]
Stock Position:  -0.0007638211716044306
Bond Position:  [2.68924308]


portfolio before change:  [2.61568335]
curr_Stock_Price:  96.74503479585769
curr_Factors:  [9.67450348e+01 4.35064680e-02]
mat_Sqrt:  [[ 2.01792768e+01  0.00000000e+00]
 [-8.34328165e-03  1.91168599e-02]]
grads:  [0.00641122 5.02890578]
Stock Position:  0.006411219699009918
Bond Position:  [1.99542968]


portfolio before change:  [2.61652759]
curr_Stock_Price:  96.83780920686586
curr_Factors:  [9.68378092e+01 4.17762136e-02]
mat_Sqrt:  [[ 1.97929029e+01  0.00000000e+00]
 [-8.17569213e-03  1.87328640e-02]]
grads:  [ 0.07190269 53.25210298]
Stock Position:  0.07190268704283062
Bond Position:  [-4.3463711]


portfolio before change:  [2.64935583]
curr_Stock_Price:  97.30193057159883
curr_Factors:  [9.73019306e+01 4.29331026e-02]
mat_Sqrt:  [[ 2.01612565e+01  0.00000000e+00]
 [-8.28812187e-03  1.89904729e-02]]
grads:  [9.48952191e-03 2.05052239e+01]
Stock Position:  0.009489521909828515
Bond Position:  [1.72600703]


portfolio before change:  [2.64421084]
curr_Stock_Price:  96.73701716053512
curr_Factors:  [9.67370172e+01 4.39502923e-02]
mat_Sqrt:  [[ 2.02802627e+01  0.00000000e+00]
 [-8.38573001e-03  1.92141213e-02]]
grads:  [0.01198189 5.70608051]
Stock Position:  0.011981888169825023
Bond Position:  [1.48511872]


portfolio before change:  [2.67026583]
curr_Stock_Price:  98.8960541376452
curr_Factors:  [9.88960541e+01 4.06792974e-02]
mat_Sqrt:  [[ 1.99464533e+01  0.00000000e+00]
 [-8.06764376e-03  1.84852941e-02]]
grads:  [-0.0054496   0.15937213]
Stock Position:  -0.005449598580319498
Bond Position:  [3.20920963]


portfolio before change:  [2.67479143]
curr_Stock_Price:  98.13922329949688
curr_Factors:  [9.81392233e+01 4.02605476e-02]
mat_Sqrt:  [[ 1.96916657e+01  0.00000000e+00]
 [-8.02601247e-03  1.83899048e-02]]
grads:  [-1.32560932e-03 -7.46829157e+00]
Stock Position:  -0.0013256093153953933
Bond Position:  [2.8048857]


portfolio before change:  [2.67297733]
curr_Stock_Price:  99.77223431350853
curr_Factors:  [9.97722343e+01 4.12108295e-02]
mat_Sqrt:  [[ 2.02542131e+01  0.00000000e+00]
 [-8.12018024e-03  1.86056703e-02]]
grads:  [-0.00638627 -1.50768044]
Stock Position:  -0.006386270712329474
Bond Position:  [3.31014983]


portfolio before change:  [2.67968365]
curr_Stock_Price:  98.78691340470124
curr_Factors:  [9.87869134e+01 4.08549370e-02]
mat_Sqrt:  [[ 1.99674078e+01  0.00000000e+00]
 [-8.08504169e-03  1.85251578e-02]]
grads:  [-0.00266486  1.76494632]
Stock Position:  -0.002664862993207981
Bond Position:  [2.94293724]


portfolio before change:  [2.68027065]
curr_Stock_Price:  98.7046926264968
curr_Factors:  [9.87046926e+01 4.04223078e-02]
mat_Sqrt:  [[ 1.98448743e+01  0.00000000e+00]
 [-8.04211990e-03  1.84268116e-02]]
grads:  [ 0.03358821 18.44295608]
Stock Position:  0.033588211447764194
Bond Position:  [-0.63504344]


portfolio before change:  [2.69006485]
curr_Stock_Price:  98.99865260093675
curr_Factors:  [9.89986526e+01 4.09995398e-02]
mat_Sqrt:  [[ 2.00455868e+01  0.00000000e+00]
 [-8.09933723e-03  1.85579130e-02]]
grads:  [ 4.50652007e-03 -4.89191135e+00]
Stock Position:  0.004506520070333867
Bond Position:  [2.24392544]


portfolio before change:  [2.69263175]
curr_Stock_Price:  99.50600361203009
curr_Factors:  [9.95060036e+01 4.07466118e-02]
mat_Sqrt:  [[ 2.00860729e+01  0.00000000e+00]
 [-8.07431600e-03  1.85005821e-02]]
grads:  [4.12540569e-03 5.35719390e+00]
Stock Position:  0.004125405692298357
Bond Position:  [2.28212911]


portfolio before change:  [2.69940444]
curr_Stock_Price:  101.0785542684325
curr_Factors:  [1.01078554e+02 3.94822092e-02]
mat_Sqrt:  [[ 2.00844408e+01  0.00000000e+00]
 [-7.94805226e-03  1.82112756e-02]]
grads:  [-1.85115300e-03 -8.17840845e+00]
Stock Position:  -0.0018511530031066637
Bond Position:  [2.88651631]


portfolio before change:  [2.69923845]
curr_Stock_Price:  101.36314751092871
curr_Factors:  [1.01363148e+02 3.92494480e-02]
mat_Sqrt:  [[ 2.00815331e+01  0.00000000e+00]
 [-7.92458938e-03  1.81575153e-02]]
grads:  [-1.58739447e-02 -2.58453668e+01]
Stock Position:  -0.01587394466253615
Bond Position:  [4.30827145]


portfolio before change:  [2.67196312]
curr_Stock_Price:  103.11532037128099
curr_Factors:  [1.03115320e+02 3.82468964e-02]
mat_Sqrt:  [[ 2.01660712e+01  0.00000000e+00]
 [-7.82272550e-03  1.79241159e-02]]
grads:  [-2.40309923e-04 -6.08640281e+00]
Stock Position:  -0.00024030992303629341
Bond Position:  [2.69674276]


portfolio before change:  [2.67243084]
curr_Stock_Price:  102.57185542592461
curr_Factors:  [1.02571855e+02 3.89317898e-02]
mat_Sqrt:  [[ 2.02385967e+01  0.00000000e+00]
 [-7.89245613e-03  1.80838888e-02]]
grads:  [ 0.00695602 -1.82831961]
Stock Position:  0.0069560198597853
Bond Position:  [1.95893897]


portfolio before change:  [2.69036044]
curr_Stock_Price:  105.1142174164742
curr_Factors:  [1.05114217e+02 3.66512770e-02]
mat_Sqrt:  [[ 2.01236158e+01  0.00000000e+00]
 [-7.65780929e-03  1.75462454e-02]]
grads:  [ 8.86115453e-03 -2.14397809e+01]
Stock Position:  0.008861154531301551
Bond Position:  [1.75892712]


portfolio before change:  [2.70572698]
curr_Stock_Price:  106.82354961351523
curr_Factors:  [1.06823550e+02 3.54589228e-02]
mat_Sqrt:  [[ 2.01154510e+01  0.00000000e+00]
 [-7.53221591e-03  1.72584748e-02]]
grads:  [-6.07924593e-03 -1.98559113e+01]
Stock Position:  -0.006079245930029948
Bond Position:  [3.35513361]


portfolio before change:  [2.70420147]
curr_Stock_Price:  107.14347773590421
curr_Factors:  [1.07143478e+02 3.53117602e-02]
mat_Sqrt:  [[ 2.01337848e+01  0.00000000e+00]
 [-7.51656945e-03  1.72226242e-02]]
grads:  [3.86897052e-03 8.74427451e+00]
Stock Position:  0.003868970516147129
Bond Position:  [2.28966652]


portfolio before change:  [2.70001071]
curr_Stock_Price:  105.98632399171268
curr_Factors:  [1.05986324e+02 3.62558463e-02]
mat_Sqrt:  [[ 2.01808221e+01  0.00000000e+00]
 [-7.61638721e-03  1.74513355e-02]]
grads:  [ 1.28142817e-02 -2.61627687e+01]
Stock Position:  0.012814281697041135
Bond Position:  [1.34187209]


portfolio before change:  [2.70288837]
curr_Stock_Price:  106.19780068532643
curr_Factors:  [1.06197801e+02 3.65535584e-02]
mat_Sqrt:  [[ 2.03039415e+01  0.00000000e+00]
 [-7.64759396e-03  1.75228391e-02]]
grads:  [-0.02170103  3.78309281]
Stock Position:  -0.02170103027116846
Bond Position:  [5.00749006]


portfolio before change:  [2.68260222]
curr_Stock_Price:  107.1614474427022
curr_Factors:  [1.07161447e+02 3.76244983e-02]
mat_Sqrt:  [[ 2.07861439e+01  0.00000000e+00]
 [-7.75881417e-03  1.77776766e-02]]
grads:  [-1.66417365e-03  1.12479175e+01]
Stock Position:  -0.0016641736474670328
Bond Position:  [2.86093748]


portfolio before change:  [2.68474965]
curr_Stock_Price:  106.08596480811555
curr_Factors:  [1.06085965e+02 3.82166702e-02]
mat_Sqrt:  [[ 2.07388348e+01  0.00000000e+00]
 [-7.81963377e-03  1.79170318e-02]]
grads:  [-0.00774963 -7.59949187]
Stock Position:  -0.007749627105837738
Bond Position:  [3.50687632]


portfolio before change:  [2.67527109]
curr_Stock_Price:  107.36563184879965
curr_Factors:  [1.07365632e+02 3.60385444e-02]
mat_Sqrt:  [[ 2.03820989e+01  0.00000000e+00]
 [-7.59352824e-03  1.73989590e-02]]
grads:  [7.85262087e-04 1.28053073e+01]
Stock Position:  0.0007852620869599861
Bond Position:  [2.59096093]


portfolio before change:  [2.67594358]
curr_Stock_Price:  107.80955764833995
curr_Factors:  [1.07809558e+02 3.48521882e-02]
mat_Sqrt:  [[ 2.01266868e+01  0.00000000e+00]
 [-7.46749630e-03  1.71101835e-02]]
grads:  [-1.18976418e-02  3.76861809e+01]
Stock Position:  -0.011897641754801914
Bond Position:  [3.95862308]


portfolio before change:  [2.66499296]
curr_Stock_Price:  108.77155323040537
curr_Factors:  [1.08771553e+02 3.42568030e-02]
mat_Sqrt:  [[ 2.01320845e+01  0.00000000e+00]
 [-7.40343737e-03  1.69634061e-02]]
grads:  [-3.48675877e-03  3.90832486e+00]
Stock Position:  -0.0034867587708426848
Bond Position:  [3.04425313]


portfolio before change:  [2.66387848]
curr_Stock_Price:  109.20032918099874
curr_Factors:  [1.09200329e+02 3.42715568e-02]
mat_Sqrt:  [[ 2.02157968e+01  0.00000000e+00]
 [-7.40503146e-03  1.69670586e-02]]
grads:  [ 0.00358841 -0.70414026]
Stock Position:  0.003588411447440353
Bond Position:  [2.27202277]


portfolio before change:  [2.66164454]
curr_Stock_Price:  108.49863734595304
curr_Factors:  [1.08498637e+02 3.45345672e-02]
mat_Sqrt:  [[ 2.01628209e+01  0.00000000e+00]
 [-7.43339139e-03  1.70320394e-02]]
grads:  [-0.01272024 -8.87375831]
Stock Position:  -0.012720236822406814
Bond Position:  [4.0417729]


portfolio before change:  [2.6648423]
curr_Stock_Price:  108.2869662001639
curr_Factors:  [1.08286966e+02 3.49766045e-02]
mat_Sqrt:  [[ 2.02518644e+01  0.00000000e+00]
 [-7.48081327e-03  1.71406965e-02]]
grads:  [0.00501046 3.11242082]
Stock Position:  0.005010460762415272
Bond Position:  [2.12227471]


portfolio before change:  [2.67108778]
curr_Stock_Price:  109.48050368810449
curr_Factors:  [1.09480504e+02 3.41404615e-02]
mat_Sqrt:  [[ 2.02288634e+01  0.00000000e+00]
 [-7.39085506e-03  1.69345764e-02]]
grads:  [-4.67982848e-03  4.80231358e+00]
Stock Position:  -0.004679828476506888
Bond Position:  [3.18343775]


portfolio before change:  [2.6792811]
curr_Stock_Price:  107.81476460941073
curr_Factors:  [1.07814765e+02 3.37277289e-02]
mat_Sqrt:  [[ 1.98003008e+01  0.00000000e+00]
 [-7.34604426e-03  1.68319019e-02]]
grads:  [-0.02293008 -5.32592239]
Stock Position:  -0.022930077221135377
Bond Position:  [5.15148198]


portfolio before change:  [2.69362403]
curr_Stock_Price:  107.21734181415255
curr_Factors:  [1.07217342e+02 3.44587380e-02]
mat_Sqrt:  [[ 1.99028248e+01  0.00000000e+00]
 [-7.42522598e-03  1.70133300e-02]]
grads:  [-4.77973995e-03 -8.68857626e+00]
Stock Position:  -0.004779739949944157
Bond Position:  [3.20609504]


portfolio before change:  [2.69352648]
curr_Stock_Price:  107.32160156271713
curr_Factors:  [1.07321602e+02 3.35625129e-02]
mat_Sqrt:  [[ 1.96613973e+01  0.00000000e+00]
 [-7.32802979e-03  1.67906256e-02]]
grads:  [-1.40233728e-03 -3.81217208e+00]
Stock Position:  -0.001402337277236461
Bond Position:  [2.84402756]


portfolio before change:  [2.69230915]
curr_Stock_Price:  108.44320024713484
curr_Factors:  [1.08443200e+02 3.32021691e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.69230915]
Stock Price:  108.1780461179059
PL:  [-5.48573697]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.35742877e+00  3.35788664e-01]
 [ 1.65281915e-01  8.19352900e-02]
 [-2.75448467e-01 -1.28239030e-01]
 [ 1.02508520e-02 -1.42591169e-01]
 [-1.22457585e-01 -5.73424455e-01]
 [-3.93213630e-01  2.32999120e-01]
 [ 3.18779318e-01 -3.70806485e-01]
 [-5.89318521e-01  2.01819224e-01]
 [-1.18138413e-01 -9.82529357e-02]
 [-3.25866090e-01 -5.59558604e-01]
 [-4.41478481e-02 -1.58119700e-02]
 [-2.16928407e-01 -2.29973092e-01]
 [-4.17030994e-02 -3.78517690e-02]
 [ 2.27736796e-02 -1.95618236e-01]
 [-6.06013643e-03 -8.35187901e-02]
 [ 8.63420245e-02 -1.09558702e+00]
 [ 9.95771344e-03 -4.68036683e-01]
 [ 7.70571016e-02 -2.01179292e-01]
 [-9.94016975e-02 -6.63855116e-02]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 6.15106509e-02 -1.10001731e-01]
 [ 3.77841214e-01 -9.59871820e-01]
 [ 2.64779943e-02 -2.91974832e-01]
 [-3.27283881e-02  3.61387699e-01]
 [ 5.48934469e-01 -7.72830615e-01]
 [-1.21456714e+00  2.02368749e-01]
 [-3.43231177e-01  2.87294063e-01]
 [-1.01779306e-01 -4.32081552e-01]
 [-5.79889886e-02  2.91518077e-01]
 [-5.62866500e-01  1.32803994e+00]
 [-6.77758539e-02  1.37559150e-01]
 [ 7.77567776e-02 -1.19471891e-02]
 [-1.07751405e-01 -2.88052955e-01]
 [ 7.81877327e-02  5.33490609e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-4.62491387e-01 -1.29107447e-01]
 [-3.42561070e-02 -1.14113214e-01]
 [ 1.98705734e-02 -6.27251989e-02]
 [ 1.97162676e-01 -2.93504559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.78270049]
curr_Stock_Price:  99.86952866241622
curr_Factors:  [9.98695287e+01 4.04233518e-02]
mat_Sqrt:  [[ 2.00793274e+01  0.00000000e+00]
 [-8.04222375e-03  1.84270495e-02]]
grads:  [ 0.07490186 18.22259515]
Stock Position:  0.07490185964158788
Bond Position:  [-5.69771293]


portfolio before change:  [1.84340649]
curr_Stock_Price:  100.68951177140671
curr_Factors:  [1.00689512e+02 4.00278771e-02]
mat_Sqrt:  [[ 2.01449185e+01  0.00000000e+00]
 [-8.00278722e-03  1.83366891e-02]]
grads:  [0.00997976 4.46837973]
Stock Position:  0.009979757829960632
Bond Position:  [0.83854955]


portfolio before change:  [1.85605528]
curr_Stock_Price:  101.94645236205847
curr_Factors:  [1.01946452e+02 3.96002975e-02]
mat_Sqrt:  [[ 2.02871641e+01  0.00000000e+00]
 [-7.95992940e-03  1.82384895e-02]]
grads:  [-0.01633627 -7.03123087]
Stock Position:  -0.01633626893948449
Bond Position:  [3.52147994]


portfolio before change:  [1.84391421]
curr_Stock_Price:  102.71659653309908
curr_Factors:  [1.02716597e+02 4.08959242e-02]
mat_Sqrt:  [[ 2.07721110e+01  0.00000000e+00]
 [-8.08909628e-03  1.85344480e-02]]
grads:  [-2.50244360e-03 -7.69330541e+00]
Stock Position:  -0.002502443603051217
Bond Position:  [2.1009567]


portfolio before change:  [1.84352171]
curr_Stock_Price:  102.97839253703168
curr_Factors:  [1.02978393e+02 3.98632363e-02]
mat_Sqrt:  [[ 2.05604391e+01  0.00000000e+00]
 [-7.98631192e-03  1.82989395e-02]]
grads:  [-1.81280435e-02 -3.13364857e+01]
Stock Position:  -0.018128043523123426
Bond Position:  [3.7103185]


portfolio before change:  [1.84861319]
curr_Stock_Price:  102.72311632092578
curr_Factors:  [1.02723116e+02 4.21659484e-02]
mat_Sqrt:  [[ 2.10935231e+01  0.00000000e+00]
 [-8.21373956e-03  1.88200416e-02]]
grads:  [-0.01382057 12.38037217]
Stock Position:  -0.013820568313921403
Bond Position:  [3.26830504]


portfolio before change:  [1.83924585]
curr_Stock_Price:  103.43046078026205
curr_Factors:  [1.03430461e+02 4.06709563e-02]
mat_Sqrt:  [[ 2.08588639e+01  0.00000000e+00]
 [-8.06681660e-03  1.84833988e-02]]
grads:  [ 7.52419216e-03 -2.00615963e+01]
Stock Position:  0.007524192159557146
Bond Position:  [1.06101519]


portfolio before change:  [1.83578396]
curr_Stock_Price:  102.95273181418641
curr_Factors:  [1.02952732e+02 4.00559692e-02]
mat_Sqrt:  [[ 2.06049468e+01  0.00000000e+00]
 [-8.00559497e-03  1.83431225e-02]]
grads:  [-0.02432607 11.00244654]
Stock Position:  -0.024326070618218273
Bond Position:  [4.34021939]


portfolio before change:  [1.85054487]
curr_Stock_Price:  102.36824169910403
curr_Factors:  [1.02368242e+02 3.91148736e-02]
mat_Sqrt:  [[ 2.02458591e+01  0.00000000e+00]
 [-7.91099221e-03  1.81263603e-02]]
grads:  [-0.00795321 -5.42044481]
Stock Position:  -0.007953207082476377
Bond Position:  [2.6647007]


portfolio before change:  [1.84103269]
curr_Stock_Price:  103.60614329522748
curr_Factors:  [1.03606143e+02 3.71536884e-02]
mat_Sqrt:  [[ 1.99703867e+01  0.00000000e+00]
 [-7.71011682e-03  1.76660970e-02]]
grads:  [-2.85461416e-02 -3.16741499e+01]
Stock Position:  -0.028546141587656868
Bond Position:  [4.79858833]


portfolio before change:  [1.80204881]
curr_Stock_Price:  104.99280146584226
curr_Factors:  [1.04992801e+02 3.62067469e-02]
mat_Sqrt:  [[ 1.99781043e+01  0.00000000e+00]
 [-7.61122822e-03  1.74395147e-02]]
grads:  [-0.00255524 -0.90667489]
Stock Position:  -0.0025552353079057164
Bond Position:  [2.07033013]


portfolio before change:  [1.80285304]
curr_Stock_Price:  104.77934870560186
curr_Factors:  [1.04779349e+02 3.83268819e-02]
mat_Sqrt:  [[ 2.05129178e+01  0.00000000e+00]
 [-7.83090104e-03  1.79428484e-02]]
grads:  [ -0.01546815 -12.81697794]
Stock Position:  -0.015468150179685737
Bond Position:  [3.42359574]


portfolio before change:  [1.79747958]
curr_Stock_Price:  105.15440590987778
curr_Factors:  [1.05154406e+02 3.69056261e-02]
mat_Sqrt:  [[ 2.02010416e+01  0.00000000e+00]
 [-7.68433483e-03  1.76070230e-02]]
grads:  [-0.00288218 -2.14981085]
Stock Position:  -0.0028821764220298834
Bond Position:  [2.10055313]


portfolio before change:  [1.79781921]
curr_Stock_Price:  105.12767240198872
curr_Factors:  [1.05127672e+02 3.78806523e-02]
mat_Sqrt:  [[ 2.04609490e+01  0.00000000e+00]
 [-7.78518103e-03  1.78380907e-02]]
grads:  [-3.05954127e-03 -1.09663214e+01]
Stock Position:  -0.0030595412729946974
Bond Position:  [2.11946167]


portfolio before change:  [1.79903485]
curr_Stock_Price:  104.81694491855121
curr_Factors:  [1.04816945e+02 3.68899388e-02]
mat_Sqrt:  [[ 2.01319325e+01  0.00000000e+00]
 [-7.68270149e-03  1.76032806e-02]]
grads:  [-2.11160676e-03 -4.74450145e+00]
Stock Position:  -0.0021116067640977736
Bond Position:  [2.02036702]


portfolio before change:  [1.79531236]
curr_Stock_Price:  106.69941987888093
curr_Factors:  [1.06699420e+02 3.56464763e-02]
mat_Sqrt:  [[ 2.01451433e+01  0.00000000e+00]
 [-7.55210978e-03  1.73040574e-02]]
grads:  [-1.94494200e-02 -6.33138807e+01]
Stock Position:  -0.01944941997946413
Bond Position:  [3.87055419]


portfolio before change:  [1.77175018]
curr_Stock_Price:  107.93575637877144
curr_Factors:  [1.07935756e+02 3.54026060e-02]
mat_Sqrt:  [[ 2.03087389e+01  0.00000000e+00]
 [-7.52623210e-03  1.72447642e-02]]
grads:  [-9.56781428e-03 -2.71407993e+01]
Stock Position:  -0.00956781428147255
Bond Position:  [2.80445945]


portfolio before change:  [1.76747985]
curr_Stock_Price:  108.4187209632546
curr_Factors:  [1.08418721e+02 3.66931190e-02]
mat_Sqrt:  [[ 2.07680918e+01  0.00000000e+00]
 [-7.66217922e-03  1.75562581e-02]]
grads:  [-5.17367687e-04 -1.14591213e+01]
Stock Position:  -0.0005173676870063395
Bond Position:  [1.82357219]


portfolio before change:  [1.76697044]
curr_Stock_Price:  109.84394484787151
curr_Factors:  [1.09843945e+02 3.48793799e-02]
mat_Sqrt:  [[ 2.05144794e+01  0.00000000e+00]
 [-7.47040882e-03  1.71168569e-02]]
grads:  [-0.00625776 -3.87837042]
Stock Position:  -0.0062577610621507886
Bond Position:  [2.4543476]


portfolio before change:  [1.76263767]
curr_Stock_Price:  110.58535813583578
curr_Factors:  [1.10585358e+02 3.52564782e-02]
mat_Sqrt:  [[ 2.07642903e+01  0.00000000e+00]
 [-7.51068340e-03  1.72091376e-02]]
grads:  [-2.33386594e-04 -6.33927114e+00]
Stock Position:  -0.00023338659445957296
Bond Position:  [1.78844681]


portfolio before change:  [1.76231688]
curr_Stock_Price:  112.91777835891895
curr_Factors:  [1.12917778e+02 3.46071933e-02]
mat_Sqrt:  [[ 2.10061041e+01  0.00000000e+00]
 [-7.44120348e-03  1.70499391e-02]]
grads:  [ 6.42763626e-04 -6.45173746e+00]
Stock Position:  0.0006427636259416477
Bond Position:  [1.68973744]


portfolio before change:  [1.76227046]
curr_Stock_Price:  112.51692446133596
curr_Factors:  [1.12516924e+02 3.23708392e-02]
mat_Sqrt:  [[ 2.02439302e+01  0.00000000e+00]
 [-7.19675918e-03  1.64898469e-02]]
grads:  [-2.02930917e-03 -5.82098687e+01]
Stock Position:  -0.0020293091739153556
Bond Position:  [1.99060209]


portfolio before change:  [1.76102255]
curr_Stock_Price:  113.25449016182127
curr_Factors:  [1.13254490e+02 3.13563746e-02]
mat_Sqrt:  [[ 2.00548008e+01  0.00000000e+00]
 [-7.08309251e-03  1.62294038e-02]]
grads:  [-5.03372088e-03 -1.79904842e+01]
Stock Position:  -0.005033720880392441
Bond Position:  [2.33111404]


portfolio before change:  [1.76545378]
curr_Stock_Price:  112.4320732437253
curr_Factors:  [1.12432073e+02 3.12592928e-02]
mat_Sqrt:  [[ 1.98783253e+01  0.00000000e+00]
 [-7.07211909e-03  1.62042605e-02]]
grads:  [6.28796101e-03 2.23020173e+01]
Stock Position:  0.006287961014159981
Bond Position:  [1.05848528]


portfolio before change:  [1.7666624]
curr_Stock_Price:  112.60324192942676
curr_Factors:  [1.12603242e+02 3.20948508e-02]
mat_Sqrt:  [[ 2.01729111e+01  0.00000000e+00]
 [-7.16601433e-03  1.64194015e-02]]
grads:  [ 1.04914722e-02 -4.70681354e+01]
Stock Position:  0.010491472189971405
Bond Position:  [0.58528861]


portfolio before change:  [1.78331106]
curr_Stock_Price:  114.18314422593848
curr_Factors:  [1.14183144e+02 3.25817620e-02]
mat_Sqrt:  [[ 2.06105358e+01  0.00000000e+00]
 [-7.22016753e-03  1.65434821e-02]]
grads:  [-0.0546442  12.23253654]
Stock Position:  -0.054644197057744696
Bond Position:  [8.0227573]


portfolio before change:  [1.78115336]
curr_Stock_Price:  114.24098397234212
curr_Factors:  [1.14240984e+02 3.20800920e-02]
mat_Sqrt:  [[ 2.04616069e+01  0.00000000e+00]
 [-7.16436649e-03  1.64156259e-02]]
grads:  [-1.06465621e-02  1.75012555e+01]
Stock Position:  -0.01064656206029079
Bond Position:  [2.99742709]


portfolio before change:  [1.79395352]
curr_Stock_Price:  113.07389756741938
curr_Factors:  [1.13073898e+02 3.18358949e-02]
mat_Sqrt:  [[ 2.01753414e+01  0.00000000e+00]
 [-7.13704644e-03  1.63530278e-02]]
grads:  [-1.43915857e-02 -2.64221133e+01]
Stock Position:  -0.014391585700815007
Bond Position:  [3.42126621]


portfolio before change:  [1.80794233]
curr_Stock_Price:  112.1316021410277
curr_Factors:  [1.12131602e+02 3.28352083e-02]
mat_Sqrt:  [[ 2.03187934e+01  0.00000000e+00]
 [-7.24819517e-03  1.66077015e-02]]
grads:  [3.40767926e-03 1.75531862e+01]
Stock Position:  0.003407679263535295
Bond Position:  [1.4258338]


portfolio before change:  [1.80948854]
curr_Stock_Price:  112.53303856531971
curr_Factors:  [1.12533039e+02 3.21614820e-02]
mat_Sqrt:  [[ 2.01812504e+01  0.00000000e+00]
 [-7.17344904e-03  1.64364366e-02]]
grads:  [8.29366330e-04 8.07985316e+01]
Stock Position:  0.0008293663299380957
Bond Position:  [1.71615743]


portfolio before change:  [1.80983617]
curr_Stock_Price:  112.69351413004249
curr_Factors:  [1.12693514e+02 3.18570627e-02]
mat_Sqrt:  [[ 2.01141547e+01  0.00000000e+00]
 [-7.13941877e-03  1.63584635e-02]]
grads:  [-3.84809555e-04  8.40905078e+00]
Stock Position:  -0.0003848095554944806
Bond Position:  [1.85320171]


portfolio before change:  [1.81016017]
curr_Stock_Price:  112.45356603718855
curr_Factors:  [1.12453566e+02 3.16130473e-02]
mat_Sqrt:  [[ 1.99943096e+01  0.00000000e+00]
 [-7.11202332e-03  1.62956926e-02]]
grads:  [ 0.00362816 -0.73315013]
Stock Position:  0.003628162123366448
Bond Position:  [1.4021604]


portfolio before change:  [1.80858126]
curr_Stock_Price:  111.9700734709243
curr_Factors:  [1.11970073e+02 3.15766628e-02]
mat_Sqrt:  [[ 1.98968844e+01  0.00000000e+00]
 [-7.10792941e-03  1.62863123e-02]]
grads:  [-1.17338984e-02 -1.76868127e+01]
Stock Position:  -0.01173389843120754
Bond Position:  [3.12242673]


portfolio before change:  [1.83520026]
curr_Stock_Price:  109.73478269017627
curr_Factors:  [1.09734783e+02 3.30857382e-02]
mat_Sqrt:  [[ 1.99601924e+01  0.00000000e+00]
 [-7.27579419e-03  1.66709388e-02]]
grads:  [0.00508368 3.20012337]
Stock Position:  0.0050836770435170615
Bond Position:  [1.27734406]


portfolio before change:  [1.83741498]
curr_Stock_Price:  110.1390251192588
curr_Factors:  [1.10139025e+02 3.40646438e-02]
mat_Sqrt:  [[ 2.03279299e+01  0.00000000e+00]
 [-7.38264384e-03  1.69157621e-02]]
grads:  [-4.65702171e-03  4.80765488e+00]
Stock Position:  -0.0046570217119876415
Bond Position:  [2.35033481]


portfolio before change:  [1.83655101]
curr_Stock_Price:  110.38763420132572
curr_Factors:  [1.10387634e+02 3.28079907e-02]
mat_Sqrt:  [[ 1.99944859e+01  0.00000000e+00]
 [-7.24519048e-03  1.66008169e-02]]
grads:  [-0.02594908 -7.77717433]
Stock Position:  -0.025949079106205915
Bond Position:  [4.70100846]


portfolio before change:  [1.80502236]
curr_Stock_Price:  111.62530079557429
curr_Factors:  [1.11625301e+02 3.18739140e-02]
mat_Sqrt:  [[ 1.99287629e+01  0.00000000e+00]
 [-7.14130677e-03  1.63627894e-02]]
grads:  [-4.21798367e-03 -6.97394625e+00]
Stock Position:  -0.004217983674298071
Bond Position:  [2.27585606]


portfolio before change:  [1.8083235]
curr_Stock_Price:  110.91011513310866
curr_Factors:  [1.10910115e+02 3.17506529e-02]
mat_Sqrt:  [[ 1.97627550e+01  0.00000000e+00]
 [-7.12748516e-03  1.63311201e-02]]
grads:  [-3.79752102e-04 -3.84083874e+00]
Stock Position:  -0.0003797521023896442
Bond Position:  [1.85044185]


portfolio before change:  [1.80794082]
curr_Stock_Price:  112.52697472985079
curr_Factors:  [1.12526975e+02 3.25055142e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.80794082]
Stock Price:  112.8373902630352
PL:  [-11.02944945]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.34748680e+00  3.33540982e-01]
 [ 1.25520346e-01  6.71679310e-02]
 [-1.78992867e-01 -1.03531711e-01]
 [ 4.80885717e-02 -1.51012741e-01]
 [-1.24739747e-01 -7.28727473e-01]
 [-3.70856339e-01  2.05121701e-01]
 [ 2.31606217e-01 -2.53817194e-01]
 [-3.74548820e-01  2.87833078e-01]
 [-1.18201263e-01 -9.85368937e-02]
 [-1.39617090e-01 -4.03115899e-01]
 [-6.06009435e-02 -1.46588793e-02]
 [-7.08006684e-02 -1.46849654e-01]
 [-5.77016837e-02 -1.78900029e-02]
 [ 2.31794594e-02 -1.99362773e-01]
 [ 8.20796812e-02  2.89865468e-02]
 [ 1.11642595e-01 -7.52767041e-01]
 [ 1.97163126e-02 -2.76161907e-01]
 [ 3.71835584e-02 -1.59145302e-01]
 [-1.23330497e-01 -3.76246856e-01]
 [ 4.27661515e-02 -1.09093389e-01]
 [ 1.33077107e-01 -2.58870385e-02]
 [ 3.61156725e-01 -3.60835574e-01]
 [ 2.98551812e-02 -4.02896144e-01]
 [ 4.96956182e-02  8.80918051e-03]
 [ 2.61271255e-01 -1.68317976e-01]
 [-7.17219035e-02 -2.35914203e-02]
 [-1.59021262e-01  8.76443578e-02]
 [-3.51998964e-02  1.24280396e-01]
 [-6.09952403e-02  2.03770987e-01]
 [-7.10908935e-01 -3.23820759e-02]
 [-1.51341880e-01 -2.55679077e-02]
 [ 7.53440776e-02 -1.31464416e-02]
 [-2.60429537e-01  5.40474614e-02]
 [ 7.77371503e-02  5.35997943e-02]
 [-1.30160814e-01  8.13251462e-02]
 [-2.02818821e-01  9.06765028e-02]
 [-2.80858485e-02 -1.71905340e-01]
 [ 1.96891857e-02 -2.76090784e-02]
 [-4.56896040e-02 -7.91633290e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.03755682]
curr_Stock_Price:  99.90652232465617
curr_Factors:  [9.99065223e+01 3.86338039e-02]
mat_Sqrt:  [[ 1.96371102e+01  0.00000000e+00]
 [-7.86219347e-03  1.80145484e-02]]
grads:  [ 0.07603237 18.51508991]
Stock Position:  0.07603236951376256
Bond Position:  [-5.5585728]


portfolio before change:  [2.101291]
curr_Stock_Price:  100.7539119384131
curr_Factors:  [1.00753912e+02 3.79896836e-02]
mat_Sqrt:  [[ 1.96378869e+01  0.00000000e+00]
 [-7.79637696e-03  1.78637438e-02]]
grads:  [0.0078845  3.76001424]
Stock Position:  0.00788449564152662
Bond Position:  [1.30689722]


portfolio before change:  [2.10821824]
curr_Stock_Price:  101.61178229442777
curr_Factors:  [1.01611782e+02 3.86205791e-02]
mat_Sqrt:  [[ 1.99688686e+01  0.00000000e+00]
 [-7.86084770e-03  1.80114648e-02]]
grads:  [-0.01122637 -5.74810059]
Stock Position:  -0.01122636509940885
Bond Position:  [3.24894921]


portfolio before change:  [2.09879807]
curr_Stock_Price:  102.48707142767314
curr_Factors:  [1.02487071e+02 3.79562489e-02]
mat_Sqrt:  [[ 1.99669038e+01  0.00000000e+00]
 [-7.79294542e-03  1.78558811e-02]]
grads:  [-8.92416376e-04 -8.45731108e+00]
Stock Position:  -0.0008924163756419192
Bond Position:  [2.19025921]


portfolio before change:  [2.09795673]
curr_Stock_Price:  103.73665059810197
curr_Factors:  [1.03736651e+02 3.76387347e-02]
mat_Sqrt:  [[ 2.01256413e+01  0.00000000e+00]
 [-7.76028192e-03  1.77810397e-02]]
grads:  [-2.20009133e-02 -4.09834007e+01]
Stock Position:  -0.02200091331399049
Bond Position:  [4.38025778]


portfolio before change:  [2.13188103]
curr_Stock_Price:  102.21958929311508
curr_Factors:  [1.02219589e+02 3.78508451e-02]
mat_Sqrt:  [[ 1.98871213e+01  0.00000000e+00]
 [-7.78211745e-03  1.78310712e-02]]
grads:  [-0.01414654 11.50361073]
Stock Position:  -0.014146536646783784
Bond Position:  [3.57793419]


portfolio before change:  [2.13107797]
curr_Stock_Price:  102.3079730603347
curr_Factors:  [1.02307973e+02 3.72636303e-02]
mat_Sqrt:  [[ 1.97493161e+01  0.00000000e+00]
 [-7.72151595e-03  1.76922157e-02]]
grads:  [ 6.11825295e-03 -1.43462638e+01]
Stock Position:  0.006118252947579177
Bond Position:  [1.50513192]


portfolio before change:  [2.13084007]
curr_Stock_Price:  102.23833628531182
curr_Factors:  [1.02238336e+02 3.71302918e-02]
mat_Sqrt:  [[ 1.97005320e+01  0.00000000e+00]
 [-7.70768881e-03  1.76605337e-02]]
grads:  [-1.26356063e-02  1.62980962e+01]
Stock Position:  -0.012635606285642283
Bond Position:  [3.42268344]


portfolio before change:  [2.12619822]
curr_Stock_Price:  102.63956087315071
curr_Factors:  [1.02639561e+02 3.58297363e-02]
mat_Sqrt:  [[ 1.94283801e+01  0.00000000e+00]
 [-7.57149774e-03  1.73484808e-02]]
grads:  [-0.00829746 -5.67985722]
Stock Position:  -0.008297464248680067
Bond Position:  [2.9778463]


portfolio before change:  [2.12943747]
curr_Stock_Price:  102.29403353711719
curr_Factors:  [1.02294034e+02 3.61004419e-02]
mat_Sqrt:  [[ 1.94359853e+01  0.00000000e+00]
 [-7.60004651e-03  1.74138942e-02]]
grads:  [-1.62354152e-02 -2.31490954e+01]
Stock Position:  -0.01623541523306531
Bond Position:  [3.79022358]


portfolio before change:  [2.12986254]
curr_Stock_Price:  102.29703551697216
curr_Factors:  [1.02297036e+02 3.66647762e-02]
mat_Sqrt:  [[ 1.95878860e+01  0.00000000e+00]
 [-7.65921941e-03  1.75494763e-02]]
grads:  [-0.00342041 -0.8352887 ]
Stock Position:  -0.0034204100889557976
Bond Position:  [2.47976035]


portfolio before change:  [2.12801833]
curr_Stock_Price:  102.9268444831525
curr_Factors:  [1.02926844e+02 3.47446728e-02]
mat_Sqrt:  [[ 1.91854845e+01  0.00000000e+00]
 [-7.45596919e-03  1.70837716e-02]]
grads:  [-7.03089419e-03 -8.59585679e+00]
Stock Position:  -0.00703089419438759
Bond Position:  [2.85168608]


portfolio before change:  [2.12563333]
curr_Stock_Price:  103.31676310338908
curr_Factors:  [1.03316763e+02 3.53626235e-02]
mat_Sqrt:  [[ 1.94286681e+01  0.00000000e+00]
 [-7.52198096e-03  1.72350236e-02]]
grads:  [-0.0033718  -1.03800281]
Stock Position:  -0.0033717968036201303
Bond Position:  [2.47399646]


portfolio before change:  [2.12432715]
curr_Stock_Price:  103.79587048104176
curr_Factors:  [1.03795870e+02 3.52669346e-02]
mat_Sqrt:  [[ 1.94923379e+01  0.00000000e+00]
 [-7.51179708e-03  1.72116894e-02]]
grads:  [-3.27459887e-03 -1.15829869e+01]
Stock Position:  -0.0032745988726073268
Bond Position:  [2.46421699]


portfolio before change:  [2.12533741]
curr_Stock_Price:  103.58142831658175
curr_Factors:  [1.03581428e+02 3.42247239e-02]
mat_Sqrt:  [[ 1.91624870e+01  0.00000000e+00]
 [-7.39997015e-03  1.69554617e-02]]
grads:  [0.00494354 1.70956989]
Stock Position:  0.004943536171810519
Bond Position:  [1.61327887]


portfolio before change:  [2.12686043]
curr_Stock_Price:  103.84871633766942
curr_Factors:  [1.03848716e+02 3.37913680e-02]
mat_Sqrt:  [[ 1.90899161e+01  0.00000000e+00]
 [-7.35297142e-03  1.68477741e-02]]
grads:  [-1.13615940e-02 -4.46805043e+01]
Stock Position:  -0.011361594005678736
Bond Position:  [3.30674738]


portfolio before change:  [2.11554385]
curr_Stock_Price:  104.88113750500544
curr_Factors:  [1.04881138e+02 3.48099377e-02]
mat_Sqrt:  [[ 1.95681159e+01  0.00000000e+00]
 [-7.46296860e-03  1.70998093e-02]]
grads:  [-5.15177983e-03 -1.61499993e+01]
Stock Position:  -0.005151779830477264
Bond Position:  [2.65586838]


portfolio before change:  [2.11765954]
curr_Stock_Price:  104.53490951755256
curr_Factors:  [1.04534910e+02 3.42915418e-02]
mat_Sqrt:  [[ 1.93577490e+01  0.00000000e+00]
 [-7.40719021e-03  1.69720049e-02]]
grads:  [-1.66719517e-03 -9.37692999e+00]
Stock Position:  -0.0016671951741621786
Bond Position:  [2.29193964]


portfolio before change:  [2.11836493]
curr_Stock_Price:  104.28366093791416
curr_Factors:  [1.04283661e+02 3.41159296e-02]
mat_Sqrt:  [[ 1.92617115e+01  0.00000000e+00]
 [-7.38819919e-03  1.69284910e-02]]
grads:  [-1.49279615e-02 -2.22256583e+01]
Stock Position:  -0.014927961520815363
Bond Position:  [3.67510741]


portfolio before change:  [2.12620253]
curr_Stock_Price:  103.78940837916501
curr_Factors:  [1.03789408e+02 3.61498520e-02]
mat_Sqrt:  [[ 1.97335990e+01  0.00000000e+00]
 [-7.60524576e-03  1.74258072e-02]]
grads:  [-2.45576441e-04 -6.26044969e+00]
Stock Position:  -0.0002455764412788772
Bond Position:  [2.15169077]


portfolio before change:  [2.12640652]
curr_Stock_Price:  104.05404548487074
curr_Factors:  [1.04054045e+02 3.83185439e-02]
mat_Sqrt:  [[ 2.03687074e+01  0.00000000e+00]
 [-7.83004919e-03  1.79408965e-02]]
grads:  [ 0.00597873 -1.44290662]
Stock Position:  0.0059787336801102155
Bond Position:  [1.5042951]


portfolio before change:  [2.13012185]
curr_Stock_Price:  104.64401609653888
curr_Factors:  [1.04644016e+02 3.83252455e-02]
mat_Sqrt:  [[ 2.04859860e+01  0.00000000e+00]
 [-7.83073386e-03  1.79424653e-02]]
grads:  [ 9.94217068e-03 -2.01107021e+01]
Stock Position:  0.009942170677271987
Bond Position:  [1.08973318]


portfolio before change:  [2.11116789]
curr_Stock_Price:  102.72389363274657
curr_Factors:  [1.02723894e+02 3.92321228e-02]
mat_Sqrt:  [[ 2.03466248e+01  0.00000000e+00]
 [-7.92284018e-03  1.81535074e-02]]
grads:  [-7.17480730e-03 -2.21938458e+01]
Stock Position:  -0.0071748072954841355
Bond Position:  [2.84819203]


portfolio before change:  [2.12167799]
curr_Stock_Price:  101.30865623997849
curr_Factors:  [1.01308656e+02 3.98629700e-02]
mat_Sqrt:  [[ 2.02269957e+01  0.00000000e+00]
 [-7.98628524e-03  1.82988783e-02]]
grads:  [0.00264697 0.48140549]
Stock Position:  0.0026469704501705335
Bond Position:  [1.85351697]


portfolio before change:  [2.12209541]
curr_Stock_Price:  101.37881838243422
curr_Factors:  [1.01378818e+02 3.94755152e-02]
mat_Sqrt:  [[ 2.01423959e+01  0.00000000e+00]
 [-7.94737845e-03  1.82097317e-02]]
grads:  [ 0.00932418 -9.24329798]
Stock Position:  0.009324177133297942
Bond Position:  [1.17682135]


portfolio before change:  [2.13575253]
curr_Stock_Price:  102.82774043139885
curr_Factors:  [1.02827740e+02 3.85404458e-02]
mat_Sqrt:  [[ 2.01868548e+01  0.00000000e+00]
 [-7.85268828e-03  1.79927692e-02]]
grads:  [-0.00406294 -1.31116117]
Stock Position:  -0.004062943148293759
Bond Position:  [2.55353579]


portfolio before change:  [2.13446078]
curr_Stock_Price:  103.22424246202448
curr_Factors:  [1.03224242e+02 3.94662782e-02]
mat_Sqrt:  [[ 2.05066534e+01  0.00000000e+00]
 [-7.94644859e-03  1.82076011e-02]]
grads:  [-0.00588931  4.81361369]
Stock Position:  -0.005889314361557987
Bond Position:  [2.74238079]


portfolio before change:  [2.13240285]
curr_Stock_Price:  103.63188724148573
curr_Factors:  [1.03631887e+02 3.91052781e-02]
mat_Sqrt:  [[ 2.04932622e+01  0.00000000e+00]
 [-7.91002181e-03  1.81241368e-02]]
grads:  [9.29110990e-04 6.85717598e+00]
Stock Position:  0.0009291109899875288
Bond Position:  [2.03611732]


portfolio before change:  [2.13310597]
curr_Stock_Price:  104.11470325346808
curr_Factors:  [1.04114703e+02 3.98611723e-02]
mat_Sqrt:  [[ 2.07867742e+01  0.00000000e+00]
 [-7.98610516e-03  1.82984657e-02]]
grads:  [1.34401372e-03 1.11359603e+01]
Stock Position:  0.0013440137169508368
Bond Position:  [1.99317438]


portfolio before change:  [2.13307817]
curr_Stock_Price:  103.90863420488468
curr_Factors:  [1.03908634e+02 3.97310209e-02]
mat_Sqrt:  [[ 2.07117358e+01  0.00000000e+00]
 [-7.97305672e-03  1.82685680e-02]]
grads:  [-0.03500632 -1.77255688]
Stock Position:  -0.03500631899151026
Bond Position:  [5.77053696]


portfolio before change:  [2.12558914]
curr_Stock_Price:  104.14317455164324
curr_Factors:  [1.04143175e+02 3.94409777e-02]
mat_Sqrt:  [[ 2.06825769e+01  0.00000000e+00]
 [-7.94390108e-03  1.82017640e-02]]
grads:  [-0.00785689 -1.40469395]
Stock Position:  -0.007856885070253644
Bond Position:  [2.94383009]


portfolio before change:  [2.12911543]
curr_Stock_Price:  103.74119689768433
curr_Factors:  [1.03741197e+02 3.89736724e-02]
mat_Sqrt:  [[ 2.04803285e+01  0.00000000e+00]
 [-7.89670031e-03  1.80936135e-02]]
grads:  [ 0.0033987  -0.72657911]
Stock Position:  0.003398700367287576
Bond Position:  [1.77653019]


portfolio before change:  [2.12917979]
curr_Stock_Price:  103.69478912382718
curr_Factors:  [1.03694789e+02 3.72943630e-02]
mat_Sqrt:  [[ 2.00252769e+01  0.00000000e+00]
 [-7.72469940e-03  1.76995099e-02]]
grads:  [-0.01182712  3.05361346]
Stock Position:  -0.011827116912530468
Bond Position:  [3.35559018]


portfolio before change:  [2.14004066]
curr_Stock_Price:  102.81195371822538
curr_Factors:  [1.02811954e+02 3.59811867e-02]
mat_Sqrt:  [[ 1.95020989e+01  0.00000000e+00]
 [-7.58748303e-03  1.73851077e-02]]
grads:  [0.0051856  3.08308671]
Stock Position:  0.005185596642826507
Bond Position:  [1.60689934]


portfolio before change:  [2.13880133]
curr_Stock_Price:  102.53422278614855
curr_Factors:  [1.02534223e+02 3.62845034e-02]
mat_Sqrt:  [[ 1.95312229e+01  0.00000000e+00]
 [-7.61939666e-03  1.74582310e-02]]
grads:  [-0.00484699  4.65826958]
Stock Position:  -0.004846988407234313
Bond Position:  [2.63578352]


portfolio before change:  [2.14949139]
curr_Stock_Price:  100.39669726183618
curr_Factors:  [1.00396697e+02 3.78335427e-02]
mat_Sqrt:  [[ 1.95280074e+01  0.00000000e+00]
 [-7.78033858e-03  1.78269952e-02]]
grads:  [-0.0083595   5.08647148]
Stock Position:  -0.00835949860486669
Bond Position:  [2.98875744]


portfolio before change:  [2.1543309]
curr_Stock_Price:  99.86246692584201
curr_Factors:  [9.98624669e+01 3.64269044e-02]
mat_Sqrt:  [[ 1.90595843e+01  0.00000000e+00]
 [-7.63433344e-03  1.74924554e-02]]
grads:  [-5.40995482e-03 -9.82739906e+00]
Stock Position:  -0.0054099548221728765
Bond Position:  [2.69458234]


portfolio before change:  [2.14806868]
curr_Stock_Price:  101.08226829160098
curr_Factors:  [1.01082268e+02 3.64072038e-02]
mat_Sqrt:  [[ 1.92871759e+01  0.00000000e+00]
 [-7.63226874e-03  1.74877246e-02]]
grads:  [ 3.96097180e-04 -1.57876905e+00]
Stock Position:  0.0003960971800865249
Bond Position:  [2.10803027]


portfolio before change:  [2.14837158]
curr_Stock_Price:  101.1817008098063
curr_Factors:  [1.01181701e+02 3.46369728e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.14837158]
Stock Price:  102.12790186991911
PL:  [0.02046971]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.09553090e+00  2.76578802e-01]
 [ 2.91321682e-01  1.07809051e-01]
 [-2.44916945e-02 -6.36441946e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.07147218e-01 -1.93895099e-01]
 [-3.18050210e-01  1.43255485e-01]
 [ 1.68411061e-01 -1.70367868e-01]
 [ 5.36010714e-01  5.88942283e-01]
 [-4.62924764e-02  1.93899899e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-4.24072285e-02  1.58169959e-02]
 [ 6.15831840e-02 -1.27249322e-01]
 [-1.17899521e-01 -2.70888329e-02]
 [-1.28234945e-01  2.69241689e-01]
 [ 1.46437652e-01  1.60822497e-01]
 [ 1.31010829e-01 -1.17908238e-01]
 [ 3.74551538e-02 -4.37684143e-02]
 [ 4.13847436e-01  6.15474406e-02]
 [ 4.55917107e-01  4.69500527e-01]
 [-8.63554623e-01  4.26492694e-01]
 [-2.21377918e-01  3.50583446e-01]
 [ 1.93160693e+00  3.37315483e-01]
 [ 1.37553199e-02  3.81339228e-01]
 [-1.63463814e-01  2.31284326e-01]
 [-1.56398105e-01  6.23053373e-02]
 [ 2.15336467e-01 -7.29955372e-02]
 [ 3.62830935e-01 -4.28311505e-01]
 [ 1.29791779e-01 -7.40508123e-02]
 [ 7.13059029e-01 -3.17811114e-01]
 [-6.80759537e-01 -3.32477964e-01]
 [ 5.07239133e-01  1.90285499e-01]
 [-2.61152988e-01  4.01025508e-01]
 [ 8.94277803e-01  1.47374419e-01]
 [ 7.07352749e-02 -1.71105331e-01]
 [ 3.38303177e-01 -5.15536997e-01]
 [ 1.59698387e-01 -1.18593115e-02]
 [-8.84221464e-02  6.93493555e-01]
 [-4.14338103e-01 -1.49963696e-01]
 [-7.76039334e-01  1.84525457e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.6131512]
curr_Stock_Price:  101.00615746277448
curr_Factors:  [1.01006157e+02 3.96369357e-02]
mat_Sqrt:  [[ 2.01093432e+01  0.00000000e+00]
 [-7.96361081e-03  1.82469247e-02]]
grads:  [ 0.06048133 15.15755709]
Stock Position:  0.06048132829845806
Bond Position:  [3.50416463]


portfolio before change:  [9.57591303]
curr_Stock_Price:  100.38321777043359
curr_Factors:  [1.00383218e+02 3.96128102e-02]
mat_Sqrt:  [[ 1.99792389e+01  0.00000000e+00]
 [-7.96118687e-03  1.82413707e-02]]
grads:  [0.01693625 5.9101398 ]
Stock Position:  0.016936251246644846
Bond Position:  [7.87579763]


portfolio before change:  [9.58864236]
curr_Stock_Price:  101.07668850924928
curr_Factors:  [1.01076689e+02 4.00959672e-02]
mat_Sqrt:  [[ 2.02395733e+01  0.00000000e+00]
 [-8.00959097e-03  1.83522785e-02]]
grads:  [-2.58248025e-03 -3.46791788e+00]
Stock Position:  -0.0025824802466924254
Bond Position:  [9.84967091]


portfolio before change:  [9.58883651]
curr_Stock_Price:  101.47829278357115
curr_Factors:  [1.01478293e+02 4.03458839e-02]
mat_Sqrt:  [[ 2.03832190e+01  0.00000000e+00]
 [-8.03451394e-03  1.84093842e-02]]
grads:  [-7.99744485e-04 -8.22335017e+00]
Stock Position:  -0.000799744485474615
Bond Position:  [9.66999321]


portfolio before change:  [9.59016205]
curr_Stock_Price:  101.33235252310988
curr_Factors:  [1.01332353e+02 4.00493842e-02]
mat_Sqrt:  [[ 2.02789772e+01  0.00000000e+00]
 [-8.00493690e-03  1.83416146e-02]]
grads:  [-9.45659020e-03 -1.05713212e+01]
Stock Position:  -0.009456590197655738
Bond Position:  [10.54842058]


portfolio before change:  [9.59138822]
curr_Stock_Price:  101.34213050521986
curr_Factors:  [1.01342131e+02 4.07005318e-02]
mat_Sqrt:  [[ 2.04451392e+01  0.00000000e+00]
 [-8.06974912e-03  1.84901181e-02]]
grads:  [-0.01249825  7.74767823]
Stock Position:  -0.012498246540395056
Bond Position:  [10.85798715]


portfolio before change:  [9.5909465]
curr_Stock_Price:  101.48607456966968
curr_Factors:  [1.01486075e+02 4.10380247e-02]
mat_Sqrt:  [[ 2.05588907e+01  0.00000000e+00]
 [-8.10313763e-03  1.85666208e-02]]
grads:  [ 4.57497579e-03 -9.17602995e+00]
Stock Position:  0.004574975788255142
Bond Position:  [9.12665017]


portfolio before change:  [9.58258307]
curr_Stock_Price:  99.40861219031834
curr_Factors:  [9.94086122e+01 4.30004716e-02]
mat_Sqrt:  [[ 2.06139216e+01  0.00000000e+00]
 [-8.29462202e-03  1.90053666e-02]]
grads:  [ 0.03847139 30.98820948]
Stock Position:  0.03847138909301653
Bond Position:  [5.75819567]


portfolio before change:  [9.57613901]
curr_Stock_Price:  99.22239922575018
curr_Factors:  [9.92223992e+01 4.13034996e-02]
mat_Sqrt:  [[ 2.01652286e+01  0.00000000e+00]
 [-8.12930497e-03  1.86265777e-02]]
grads:  [1.90091459e-03 1.04098510e+01]
Stock Position:  0.0019009145889771685
Bond Position:  [9.38752571]


portfolio before change:  [9.5728408]
curr_Stock_Price:  96.86999194755772
curr_Factors:  [9.68699919e+01 4.27535789e-02]
mat_Sqrt:  [[ 2.00297487e+01  0.00000000e+00]
 [-8.27077543e-03  1.89507272e-02]]
grads:  [0.01230341 5.9668704 ]
Stock Position:  0.012303408795240453
Bond Position:  [8.38100969]


portfolio before change:  [9.57761793]
curr_Stock_Price:  97.17311444558274
curr_Factors:  [9.71731144e+01 4.26868973e-02]
mat_Sqrt:  [[ 2.00767503e+01  0.00000000e+00]
 [-8.26432307e-03  1.89359430e-02]]
grads:  [-0.00176842  0.83528958]
Stock Position:  -0.0017684199399304323
Bond Position:  [9.74946081]


portfolio before change:  [9.57844029]
curr_Stock_Price:  97.39727109174596
curr_Factors:  [9.73972711e+01 4.22655025e-02]
mat_Sqrt:  [[ 2.00234915e+01  0.00000000e+00]
 [-8.22343019e-03  1.88422457e-02]]
grads:  [ 3.01996625e-04 -6.75340531e+00]
Stock Position:  0.00030199662528353617
Bond Position:  [9.54902664]


portfolio before change:  [9.57956537]
curr_Stock_Price:  97.17003252917314
curr_Factors:  [9.71700325e+01 4.13526571e-02]
mat_Sqrt:  [[ 1.97598689e+01  0.00000000e+00]
 [-8.13414109e-03  1.86376586e-02]]
grads:  [-0.00656492 -1.45344613]
Stock Position:  -0.006564924983341265
Bond Position:  [10.21747934]


portfolio before change:  [9.58703867]
curr_Stock_Price:  96.22622363296546
curr_Factors:  [9.62262236e+01 4.19600433e-02]
mat_Sqrt:  [[ 1.97111247e+01  0.00000000e+00]
 [-8.19366031e-03  1.87740343e-02]]
grads:  [-5.44273275e-04  1.43411738e+01]
Stock Position:  -0.0005442732747229495
Bond Position:  [9.63941203]


portfolio before change:  [9.58950088]
curr_Stock_Price:  93.91633129509658
curr_Factors:  [9.39163313e+01 4.23891489e-02]
mat_Sqrt:  [[ 1.93360815e+01  0.00000000e+00]
 [-8.23545010e-03  1.88697867e-02]]
grads:  [0.01120322 8.52275119]
Stock Position:  0.011203218395347443
Bond Position:  [8.53733571]


portfolio before change:  [9.58401902]
curr_Stock_Price:  93.33175853015523
curr_Factors:  [9.33317585e+01 4.37499049e-02]
mat_Sqrt:  [[ 1.95217167e+01  0.00000000e+00]
 [-8.36659117e-03  1.91702687e-02]]
grads:  [ 4.07502354e-03 -6.15057829e+00]
Stock Position:  0.004075023540699935
Bond Position:  [9.2036899]


portfolio before change:  [9.58431609]
curr_Stock_Price:  93.12232228574615
curr_Factors:  [9.31223223e+01 4.36178544e-02]
mat_Sqrt:  [[ 1.94484927e+01  0.00000000e+00]
 [-8.35395518e-03  1.91413160e-02]]
grads:  [ 9.43674764e-04 -2.28659379e+00]
Stock Position:  0.0009436747642826588
Bond Position:  [9.49643891]


portfolio before change:  [9.58409969]
curr_Stock_Price:  91.63502208720412
curr_Factors:  [9.16350221e+01 4.42739517e-02]
mat_Sqrt:  [[ 1.92812698e+01  0.00000000e+00]
 [-8.41655052e-03  1.92847399e-02]]
grads:  [0.02285684 3.19151002]
Stock Position:  0.02285684219832729
Bond Position:  [7.48961246]


portfolio before change:  [9.58712681]
curr_Stock_Price:  91.72649809482017
curr_Factors:  [9.17264981e+01 4.41734276e-02]
mat_Sqrt:  [[ 1.92785943e+01  0.00000000e+00]
 [-8.40699020e-03  1.92628345e-02]]
grads:  [ 0.0342776 24.3733874]
Stock Position:  0.03427759966074162
Bond Position:  [6.44296263]


portfolio before change:  [9.58249048]
curr_Stock_Price:  91.56774286804314
curr_Factors:  [9.15677429e+01 4.45844835e-02]
mat_Sqrt:  [[ 1.93345638e+01  0.00000000e+00]
 [-8.44601525e-03  1.93522521e-02]]
grads:  [-0.03503663 22.03840108]
Stock Position:  -0.03503662960285621
Bond Position:  [12.79071557]


portfolio before change:  [9.59972297]
curr_Stock_Price:  91.12153711021854
curr_Factors:  [9.11215371e+01 4.45569102e-02]
mat_Sqrt:  [[ 1.92343968e+01  0.00000000e+00]
 [-8.44340313e-03  1.93462670e-02]]
grads:  [-3.55460891e-03  1.81215035e+01]
Stock Position:  -0.003554608905680475
Bond Position:  [9.92362439]


portfolio before change:  [9.60215205]
curr_Stock_Price:  90.78716772560762
curr_Factors:  [9.07871677e+01 4.56719208e-02]
mat_Sqrt:  [[ 1.94021164e+01  0.00000000e+00]
 [-8.54839595e-03  1.95868358e-02]]
grads:  [ 0.10714416 17.22154039]
Stock Position:  0.10714416061701991
Bond Position:  [-0.12516283]


portfolio before change:  [9.69324043]
curr_Stock_Price:  91.63746166152491
curr_Factors:  [9.16374617e+01 4.61682976e-02]
mat_Sqrt:  [[ 1.96899667e+01  0.00000000e+00]
 [-8.59472374e-03  1.96929861e-02]]
grads:  [9.15112790e-03 1.93642156e+01]
Stock Position:  0.00915112790498952
Bond Position:  [8.8546543]


portfolio before change:  [9.69429332]
curr_Stock_Price:  91.63155976103444
curr_Factors:  [9.16315598e+01 4.59274795e-02]
mat_Sqrt:  [[ 1.96372824e+01  0.00000000e+00]
 [-8.57227900e-03  1.96415587e-02]]
grads:  [-3.18389569e-03  1.17752532e+01]
Stock Position:  -0.0031838956888543797
Bond Position:  [9.98603865]


portfolio before change:  [9.69544972]
curr_Stock_Price:  91.66043515044618
curr_Factors:  [9.16604352e+01 4.56890481e-02]
mat_Sqrt:  [[ 1.95924149e+01  0.00000000e+00]
 [-8.54999866e-03  1.95905080e-02]]
grads:  [-0.00659469  3.18038395]
Stock Position:  -0.006594686078838127
Bond Position:  [10.29992152]


portfolio before change:  [9.68843329]
curr_Stock_Price:  92.91963146913717
curr_Factors:  [9.29196315e+01 4.56558594e-02]
mat_Sqrt:  [[ 1.98543530e+01  0.00000000e+00]
 [-8.54689271e-03  1.95833914e-02]]
grads:  [ 0.00924123 -3.72742063]
Stock Position:  0.009241227983099032
Bond Position:  [8.82974179]


portfolio before change:  [9.67804114]
curr_Stock_Price:  91.67564837414533
curr_Factors:  [9.16756484e+01 4.57926374e-02]
mat_Sqrt:  [[ 1.96178685e+01  0.00000000e+00]
 [-8.55968573e-03  1.96127039e-02]]
grads:  [ 8.96633949e-03 -2.18384730e+01]
Stock Position:  0.008966339489481464
Bond Position:  [8.85604616]


portfolio before change:  [9.67580287]
curr_Stock_Price:  91.30254825785168
curr_Factors:  [9.13025483e+01 4.61684761e-02]
mat_Sqrt:  [[ 1.96180424e+01  0.00000000e+00]
 [-8.59474036e-03  1.96930241e-02]]
grads:  [ 0.00496856 -3.76025601]
Stock Position:  0.00496855661951666
Bond Position:  [9.22216099]


portfolio before change:  [9.67831603]
curr_Stock_Price:  91.576332959878
curr_Factors:  [9.15763330e+01 4.66418326e-02]
mat_Sqrt:  [[ 1.97774845e+01  0.00000000e+00]
 [-8.63868810e-03  1.97937211e-02]]
grads:  [  0.02904085 -16.05615807]
Stock Position:  0.029040846354457014
Bond Position:  [7.01886182]


portfolio before change:  [9.68006475]
curr_Stock_Price:  91.60633564119966
curr_Factors:  [9.16063356e+01 4.61116215e-02]
mat_Sqrt:  [[ 1.96711934e+01  0.00000000e+00]
 [-8.58944669e-03  1.96808948e-02]]
grads:  [ -0.04198346 -16.89343738]
Stock Position:  -0.04198346278344928
Bond Position:  [13.52601593]


portfolio before change:  [9.70334874]
curr_Stock_Price:  91.09201095608746
curr_Factors:  [9.10920110e+01 4.72659284e-02]
mat_Sqrt:  [[ 1.98040670e+01  0.00000000e+00]
 [-8.69629147e-03  1.99257070e-02]]
grads:  [0.02980633 9.54974892]
Stock Position:  0.029806328904690437
Bond Position:  [6.9882303]


portfolio before change:  [9.65901162]
curr_Stock_Price:  89.57519554817972
curr_Factors:  [8.95751955e+01 4.81532525e-02]
mat_Sqrt:  [[ 1.96562460e+01  0.00000000e+00]
 [-8.77753974e-03  2.01118701e-02]]
grads:  [-4.38186967e-03  1.99397423e+01]
Stock Position:  -0.004381869666796878
Bond Position:  [10.05151845]


portfolio before change:  [9.6623875]
curr_Stock_Price:  89.09152871575819
curr_Factors:  [8.90915287e+01 4.69982569e-02]
mat_Sqrt:  [[ 1.93142250e+01  0.00000000e+00]
 [-8.67163254e-03  1.98692063e-02]]
grads:  [0.04963167 7.4172273 ]
Stock Position:  0.049631671637657665
Bond Position:  [5.24062601]


portfolio before change:  [9.66484694]
curr_Stock_Price:  89.12788286414873
curr_Factors:  [8.91278829e+01 4.73297724e-02]
mat_Sqrt:  [[ 1.93901335e+01  0.00000000e+00]
 [-8.70216271e-03  1.99391597e-02]]
grads:  [-2.03258724e-04 -8.58137123e+00]
Stock Position:  -0.00020325872437353362
Bond Position:  [9.68296296]


portfolio before change:  [9.66606693]
curr_Stock_Price:  89.0809418082155
curr_Factors:  [8.90809418e+01 4.83138373e-02]
mat_Sqrt:  [[ 1.95803552e+01  0.00000000e+00]
 [-8.79216354e-03  2.01453775e-02]]
grads:  [ 5.78663585e-03 -2.55908333e+01]
Stock Position:  0.005786635852222767
Bond Position:  [9.15058796]


portfolio before change:  [9.66512304]
curr_Stock_Price:  88.72014841384642
curr_Factors:  [8.87201484e+01 4.91956677e-02]
mat_Sqrt:  [[ 1.96782145e+01  0.00000000e+00]
 [-8.87203856e-03  2.03283941e-02]]
grads:  [ 0.00785247 -0.58338654]
Stock Position:  0.007852468514923132
Bond Position:  [8.96845087]


portfolio before change:  [9.66682529]
curr_Stock_Price:  88.79415310174645
curr_Factors:  [8.87941531e+01 4.92006961e-02]
mat_Sqrt:  [[ 1.96956353e+01  0.00000000e+00]
 [-8.87249197e-03  2.03294330e-02]]
grads:  [1.08777022e-02 3.41127839e+01]
Stock Position:  0.010877702182799811
Bond Position:  [8.70094894]


portfolio before change:  [9.66078409]
curr_Stock_Price:  88.13878656090216
curr_Factors:  [8.81387866e+01 4.83460847e-02]
mat_Sqrt:  [[ 1.93797300e+01  0.00000000e+00]
 [-8.79509724e-03  2.01520994e-02]]
grads:  [-0.02475719 -7.44159172]
Stock Position:  -0.02475718841164322
Bond Position:  [11.84285264]


portfolio before change:  [9.70769829]
curr_Stock_Price:  86.30361248908574
curr_Factors:  [8.63036125e+01 4.95430760e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.70769829]
Stock Price:  87.06387997183607
PL:  [9.70769829]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.59287344e+02 -4.92708515e+01]
 [ 1.42102076e+00  3.57685003e-01]
 [ 1.45238534e+00  3.54314286e-02]
 [ 9.57453872e-02 -3.13638922e-02]
 [ 4.97692547e-02 -1.51386812e-01]
 [-1.05202867e-01  7.27977833e-01]
 [ 3.28703980e-02 -1.37204242e-02]
 [ 8.74161999e-02  9.61368871e-02]
 [ 8.70009592e-01  8.67143667e-01]
 [-1.69465040e-02  2.87026678e-01]
 [ 1.97083542e-01  1.13076533e-01]
 [-3.95926885e-02  1.60805116e-02]
 [ 6.88849821e-02 -1.02973153e-01]
 [-1.19313288e-01 -2.55634036e-02]
 [-7.39005431e-02  5.54418396e-02]
 [ 5.11689593e-01  3.35286785e-01]
 [ 1.30345462e-01 -1.17264697e-01]
 [ 3.94795476e-02  1.05903879e-01]
 [-2.88675524e-03  5.23936532e-03]
 [-1.13959225e-01 -4.69287644e-01]
 [-1.01155445e-01 -1.87995945e-02]
 [ 1.81027309e-01 -4.64616998e-02]
 [ 8.74757307e-01  1.34403638e-02]
 [ 2.64883814e-02 -2.11161457e-01]
 [ 1.11245146e-02  2.56987343e-02]
 [ 1.46995570e-01 -6.74403800e-02]
 [ 1.77181927e-01 -8.68236303e-02]
 [-1.85942912e-01 -8.61409590e-04]
 [ 5.19010891e-02  1.98932573e-01]
 [ 8.41255607e-02  9.99205371e-02]
 [-5.07437317e-01 -1.09684888e-01]
 [-1.66646461e-01 -6.17177590e-02]
 [ 9.61081372e-03 -6.98878633e-02]
 [-1.20879046e-01  1.56215092e-01]
 [ 4.13448905e-02  4.18155508e-02]
 [-9.82431875e-03  5.83851293e-02]
 [-1.38509143e-01  1.11955981e-01]
 [-2.89152992e-02 -1.64520851e-01]
 [-8.10958964e-02 -5.42092905e-02]
 [ 1.12594206e-01 -1.25068878e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28734402 -49.27085154]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88918907 -2687.94531851]
init_Out:  [2.76731651]
Stock Position:  6.8891890736904005
Bond position:  [-686.15159086]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.38751119]
curr_Stock_Price:  98.2481169750744
curr_Factors:  [9.82481170e+01 4.06038375e-02]
mat_Sqrt:  [[ 1.97973826e+01  0.00000000e+00]
 [-8.06015756e-03  1.84681411e-02]]
grads:  [ 0.07966342 19.36767764]
Stock Position:  0.07966342431523446
Bond Position:  [-17.21429262]


portfolio before change:  [-9.47232651]
curr_Stock_Price:  97.21045892098971
curr_Factors:  [9.72104589e+01 4.11343868e-02]
mat_Sqrt:  [[ 1.97158501e+01  0.00000000e+00]
 [-8.11264562e-03  1.85884063e-02]]
grads:  [0.0744502  1.90610362]
Stock Position:  0.07445019517977954
Bond Position:  [-16.70966415]


portfolio before change:  [-9.3615602]
curr_Stock_Price:  98.72630647624797
curr_Factors:  [9.87263065e+01 4.00589325e-02]
mat_Sqrt:  [[ 1.97598014e+01  0.00000000e+00]
 [-8.00589109e-03  1.83438010e-02]]
grads:  [ 0.00415273 -1.70978154]
Stock Position:  0.0041527270787534
Bond Position:  [-9.77154361]


portfolio before change:  [-9.36104646]
curr_Stock_Price:  99.14416718429094
curr_Factors:  [9.91441672e+01 3.97711963e-02]
mat_Sqrt:  [[ 1.97720407e+01  0.00000000e+00]
 [-7.97708682e-03  1.82778021e-02]]
grads:  [-8.24465576e-04 -8.28255015e+00]
Stock Position:  -0.0008244655763465715
Bond Position:  [-9.2793055]


portfolio before change:  [-9.36105979]
curr_Stock_Price:  97.75337913961692
curr_Factors:  [9.77533791e+01 3.98625966e-02]
mat_Sqrt:  [[ 1.95170678e+01  0.00000000e+00]
 [-7.98624784e-03  1.82987926e-02]]
grads:  [1.08885571e-02 3.97828342e+01]
Stock Position:  0.010888557082213847
Bond Position:  [-10.42545304]


portfolio before change:  [-9.37631325]
curr_Stock_Price:  96.47219896976337
curr_Factors:  [9.64721990e+01 4.17200388e-02]
mat_Sqrt:  [[ 1.97049134e+01  0.00000000e+00]
 [-8.17019352e-03  1.87202651e-02]]
grads:  [ 0.00136424 -0.73291826]
Stock Position:  0.0013642442078575867
Bond Position:  [-9.50792489]


portfolio before change:  [-9.37620252]
curr_Stock_Price:  97.42459033024394
curr_Factors:  [9.74245903e+01 4.21328896e-02]
mat_Sqrt:  [[ 1.99976614e+01  0.00000000e+00]
 [-8.21051907e-03  1.88126626e-02]]
grads:  [0.00646945 5.11022227]
Stock Position:  0.006469445330004159
Bond Position:  [-10.00648558]


portfolio before change:  [-9.3758223]
curr_Stock_Price:  97.67671636354692
curr_Factors:  [9.76767164e+01 4.28587664e-02]
mat_Sqrt:  [[ 2.02213844e+01  0.00000000e+00]
 [-8.28094356e-03  1.89740253e-02]]
grads:  [ 0.0617397  45.70161847]
Stock Position:  0.06173969557177312
Bond Position:  [-15.40635303]


portfolio before change:  [-9.33254247]
curr_Stock_Price:  98.40891525614416
curr_Factors:  [9.84089153e+01 4.23909722e-02]
mat_Sqrt:  [[ 2.02614785e+01  0.00000000e+00]
 [-8.23562721e-03  1.88701925e-02]]
grads:  [5.34621440e-03 1.52105855e+01]
Stock Position:  0.00534621439673279
Bond Position:  [-9.85865763]


portfolio before change:  [-9.33496512]
curr_Stock_Price:  98.18628388497659
curr_Factors:  [9.81862839e+01 4.32802816e-02]
mat_Sqrt:  [[ 2.04265895e+01  0.00000000e+00]
 [-8.32156539e-03  1.90671016e-02]]
grads:  [0.01206438 5.93045212]
Stock Position:  0.012064382376708385
Bond Position:  [-10.51952199]


portfolio before change:  [-9.34938419]
curr_Stock_Price:  97.10010711706585
curr_Factors:  [9.71001071e+01 4.38844941e-02]
mat_Sqrt:  [[ 2.03411385e+01  0.00000000e+00]
 [-8.37945050e-03  1.91997331e-02]]
grads:  [-0.00160141  0.83753829]
Stock Position:  -0.0016014136972533172
Bond Position:  [-9.19388675]


portfolio before change:  [-9.34917477]
curr_Stock_Price:  96.25164845803282
curr_Factors:  [9.62516485e+01 4.54502691e-02]
mat_Sqrt:  [[ 2.05199551e+01  0.00000000e+00]
 [-8.52762748e-03  1.95392492e-02]]
grads:  [ 1.16685507e-03 -5.27006703e+00]
Stock Position:  0.0011668550710314148
Bond Position:  [-9.46148649]


portfolio before change:  [-9.35042865]
curr_Stock_Price:  96.19069174208192
curr_Factors:  [9.61906917e+01 4.55069897e-02]
mat_Sqrt:  [[ 2.05197517e+01  0.00000000e+00]
 [-8.53294694e-03  1.95514376e-02]]
grads:  [-0.00635827 -1.30749483]
Stock Position:  -0.006358267561554209
Bond Position:  [-8.7388225]


portfolio before change:  [-9.36646764]
curr_Stock_Price:  98.5414210933954
curr_Factors:  [9.85414211e+01 4.31801448e-02]
mat_Sqrt:  [[ 2.04767425e+01  0.00000000e+00]
 [-8.31193309e-03  1.90450313e-02]]
grads:  [-2.42732655e-03  2.91109207e+00]
Stock Position:  -0.002427326545686106
Bond Position:  [-9.12727543]


portfolio before change:  [-9.3674313]
curr_Stock_Price:  98.46836768084543
curr_Factors:  [9.84683677e+01 4.24359000e-02]
mat_Sqrt:  [[ 2.02844598e+01  0.00000000e+00]
 [-8.23999029e-03  1.88801896e-02]]
grads:  [ 0.03243965 17.75865561]
Stock Position:  0.03243964827134014
Bond Position:  [-12.56171051]


portfolio before change:  [-9.34552559]
curr_Stock_Price:  99.19205068756038
curr_Factors:  [9.91920507e+01 4.25471688e-02]
mat_Sqrt:  [[ 2.04603096e+01  0.00000000e+00]
 [-8.25078603e-03  1.89049258e-02]]
grads:  [ 3.86929398e-03 -6.20286472e+00]
Stock Position:  0.003869293981191993
Bond Position:  [-9.72932879]


portfolio before change:  [-9.34727292]
curr_Stock_Price:  99.05479364422418
curr_Factors:  [9.90547936e+01 4.30142488e-02]
mat_Sqrt:  [[ 2.05438421e+01  0.00000000e+00]
 [-8.29595071e-03  1.90084110e-02]]
grads:  [4.17155608e-03 5.57142196e+00]
Stock Position:  0.004171556078843172
Bond Position:  [-9.76048554]


portfolio before change:  [-9.34894563]
curr_Stock_Price:  98.94630228103291
curr_Factors:  [9.89463023e+01 4.27250647e-02]
mat_Sqrt:  [[ 2.04522425e+01  0.00000000e+00]
 [-8.26801690e-03  1.89444066e-02]]
grads:  [-2.93419535e-05  2.76565290e-01]
Stock Position:  -2.934195354816022e-05
Bond Position:  [-9.34604235]


portfolio before change:  [-9.35015651]
curr_Stock_Price:  100.3964104729505
curr_Factors:  [1.00396410e+02 4.02565312e-02]
mat_Sqrt:  [[ 2.01435662e+01  0.00000000e+00]
 [-8.02561212e-03  1.83889875e-02]]
grads:  [-1.58250600e-02 -2.55200371e+01]
Stock Position:  -0.015825060019256168
Bond Position:  [-7.76137729]


portfolio before change:  [-9.33013824]
curr_Stock_Price:  99.0701280553377
curr_Factors:  [9.90701281e+01 4.00411517e-02]
mat_Sqrt:  [[ 1.98242152e+01  0.00000000e+00]
 [-8.00411411e-03  1.83397294e-02]]
grads:  [-0.0055165  -1.02507481]
Stock Position:  -0.005516498853934064
Bond Position:  [-8.783618]


portfolio before change:  [-9.33503209]
curr_Stock_Price:  99.75821453516376
curr_Factors:  [9.97582145e+01 3.98000162e-02]
mat_Sqrt:  [[ 1.99017053e+01  0.00000000e+00]
 [-7.97997656e-03  1.82844233e-02]]
grads:  [ 0.00807719 -2.5410536 ]
Stock Position:  0.008077185245406997
Bond Position:  [-10.14079767]


portfolio before change:  [-9.33737317]
curr_Stock_Price:  99.62532158697404
curr_Factors:  [9.96253216e+01 4.08080739e-02]
mat_Sqrt:  [[ 2.01253196e+01  0.00000000e+00]
 [-8.08040335e-03  1.85145300e-02]]
grads:  [0.04375698 0.725936  ]
Stock Position:  0.043756977906640196
Bond Position:  [-13.69667617]


portfolio before change:  [-9.31255313]
curr_Stock_Price:  100.23167597266925
curr_Factors:  [1.00231676e+02 4.23567874e-02]
mat_Sqrt:  [[ 2.06284453e+01  0.00000000e+00]
 [-8.23230586e-03  1.88625824e-02]]
grads:  [-3.18346985e-03 -1.11947268e+01]
Stock Position:  -0.003183469854212113
Bond Position:  [-8.99346861]


portfolio before change:  [-9.31439263]
curr_Stock_Price:  100.45635112022131
curr_Factors:  [1.00456351e+02 4.26931179e-02]
mat_Sqrt:  [[ 2.07566057e+01  0.00000000e+00]
 [-8.26492520e-03  1.89373227e-02]]
grads:  [1.07630130e-03 1.35704158e+00]
Stock Position:  0.00107630130195313
Bond Position:  [-9.42251393]


portfolio before change:  [-9.31590101]
curr_Stock_Price:  100.14928431887772
curr_Factors:  [1.00149284e+02 4.24518958e-02]
mat_Sqrt:  [[ 2.06346162e+01  0.00000000e+00]
 [-8.24154313e-03  1.88837476e-02]]
grads:  [ 0.00569733 -3.57134512]
Stock Position:  0.005697327929148441
Bond Position:  [-9.88648433]


portfolio before change:  [-9.31357584]
curr_Stock_Price:  100.77432436368979
curr_Factors:  [1.00774324e+02 4.32148900e-02]
mat_Sqrt:  [[ 2.09491594e+01  0.00000000e+00]
 [-8.31527655e-03  1.90526921e-02]]
grads:  [ 0.00664891 -4.55702689]
Stock Position:  0.006648905856347126
Bond Position:  [-9.98361484]


portfolio before change:  [-9.30745803]
curr_Stock_Price:  101.8821516113878
curr_Factors:  [1.01882152e+02 4.28773183e-02]
mat_Sqrt:  [[ 2.10965731e+01  0.00000000e+00]
 [-8.28273562e-03  1.89781315e-02]]
grads:  [-0.00883171 -0.04538959]
Stock Position:  -0.008831712192247154
Bond Position:  [-8.40766419]


portfolio before change:  [-9.29391526]
curr_Stock_Price:  100.2297207693765
curr_Factors:  [1.00229721e+02 4.40152321e-02]
mat_Sqrt:  [[ 2.10280024e+01  0.00000000e+00]
 [-8.39192298e-03  1.92283111e-02]]
grads:  [6.59703090e-03 1.03458162e+01]
Stock Position:  0.006597030898067972
Bond Position:  [-9.95513383]


portfolio before change:  [-9.30175418]
curr_Stock_Price:  99.23011277897928
curr_Factors:  [9.92301128e+01 4.37960356e-02]
mat_Sqrt:  [[ 2.07663842e+01  0.00000000e+00]
 [-8.37100096e-03  1.91803728e-02]]
grads:  [0.00615102 5.20952008]
Stock Position:  0.006151020652417937
Bond Position:  [-9.91212065]


portfolio before change:  [-9.2970151]
curr_Stock_Price:  100.20201213472552
curr_Factors:  [1.00202012e+02 4.18686133e-02]
mat_Sqrt:  [[ 2.05031567e+01  0.00000000e+00]
 [-8.18472854e-03  1.87535690e-02]]
grads:  [-0.02708401 -5.8487474 ]
Stock Position:  -0.027084011206689393
Bond Position:  [-6.58314268]


portfolio before change:  [-9.28165172]
curr_Stock_Price:  99.60437820687386
curr_Factors:  [9.96043782e+01 4.28330514e-02]
mat_Sqrt:  [[ 2.06142689e+01  0.00000000e+00]
 [-8.27845893e-03  1.89683323e-02]]
grads:  [-0.00939069 -3.25372615]
Stock Position:  -0.009390694387473576
Bond Position:  [-8.34629744]


portfolio before change:  [-9.29143181]
curr_Stock_Price:  100.5347396042305
curr_Factors:  [1.00534740e+02 4.30968962e-02]
mat_Sqrt:  [[ 2.08708028e+01  0.00000000e+00]
 [-8.30391679e-03  1.90266636e-02]]
grads:  [-1.00095577e-03 -3.67315388e+00]
Stock Position:  -0.0010009557676433634
Bond Position:  [-9.19080098]


portfolio before change:  [-9.29139733]
curr_Stock_Price:  99.35246705960581
curr_Factors:  [9.93524671e+01 4.48684723e-02]
mat_Sqrt:  [[ 2.10450178e+01  0.00000000e+00]
 [-8.47287175e-03  1.94137881e-02]]
grads:  [-2.50421221e-03  8.04660538e+00]
Stock Position:  -0.002504212211506283
Bond Position:  [-9.04259767]


portfolio before change:  [-9.29433027]
curr_Stock_Price:  100.07227031959933
curr_Factors:  [1.0007227e+02 4.5714618e-02]
mat_Sqrt:  [[ 2.13964292e+01  0.00000000e+00]
 [-8.55239082e-03  1.95959892e-02]]
grads:  [0.00278526 2.13388314]
Stock Position:  0.002785263493642337
Bond Position:  [-9.57305791]


portfolio before change:  [-9.29791251]
curr_Stock_Price:  99.21578470927334
curr_Factors:  [9.92157847e+01 4.65280943e-02]
mat_Sqrt:  [[ 2.14012137e+01  0.00000000e+00]
 [-8.62814875e-03  1.97695724e-02]]
grads:  [7.31595924e-04 2.95328236e+00]
Stock Position:  0.0007315959237010345
Bond Position:  [-9.37049837]


portfolio before change:  [-9.29932298]
curr_Stock_Price:  98.88899131444944
curr_Factors:  [9.88889913e+01 4.64811971e-02]
mat_Sqrt:  [[ 2.13199705e+01  0.00000000e+00]
 [-8.62379936e-03  1.97596067e-02]]
grads:  [-4.20486263e-03  5.66590128e+00]
Stock Position:  -0.004204862631002925
Bond Position:  [-8.88350835]


portfolio before change:  [-9.30396375]
curr_Stock_Price:  99.7285584826628
curr_Factors:  [9.97285585e+01 4.57040957e-02]
mat_Sqrt:  [[ 2.13204861e+01  0.00000000e+00]
 [-8.55140650e-03  1.95937338e-02]]
grads:  [-4.72400510e-03 -8.39660538e+00]
Stock Position:  -0.004724005099023035
Bond Position:  [-8.83284553]


portfolio before change:  [-9.29920552]
curr_Stock_Price:  98.4875775586739
curr_Factors:  [9.84875776e+01 4.43785487e-02]
mat_Sqrt:  [[ 2.07476065e+01  0.00000000e+00]
 [-8.42648669e-03  1.93075066e-02]]
grads:  [-0.00504901 -2.80767951]
Stock Position:  -0.005049005060269783
Bond Position:  [-8.80194125]


portfolio before change:  [-9.29570679]
curr_Stock_Price:  97.57669628346811
curr_Factors:  [9.75766963e+01 4.54673774e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.29570679]
Stock Price:  97.7180627576546
PL:  [-9.29570679]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  0.4580171681371481
FINAL STD P&L:  7.096878319118668
