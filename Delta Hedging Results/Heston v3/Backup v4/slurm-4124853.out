WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 01:03:39.338496: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 01:03:39.599172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-17 01:03:39.600823: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:03:39.621536: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:03:39.646382: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:03:39.695621: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:03:39.724190: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:03:39.741187: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:03:39.784330: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:03:39.831143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:03:39.831555: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 01:03:39.838297: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399990000 Hz
2019-12-17 01:03:39.838486: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561a4f192210 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:03:39.838504: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 01:03:39.860508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-17 01:03:39.860548: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:03:39.860562: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:03:39.860573: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:03:39.860584: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:03:39.860595: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:03:39.860606: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:03:39.860617: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:03:39.907388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:03:39.907429: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:03:40.701391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 01:03:40.701415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 01:03:40.701426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 01:03:40.771004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15215 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
2019-12-17 01:03:40.773142: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561a4f7cb440 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:03:40.773160: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: 4.0000e-02
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 01:03:49.868384: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 4.3248e+02,   Y0: 2.7367e+00,  elapsed time   9
INFO   step:     1,    loss: 3.6058e+02,   Y0: 2.7317e+00,  elapsed time  12
INFO   step:     2,    loss: 3.6057e+02,   Y0: 2.7268e+00,  elapsed time  12
INFO   step:     3,    loss: 3.6054e+02,   Y0: 2.7247e+00,  elapsed time  13
INFO   step:     4,    loss: 3.6052e+02,   Y0: 2.7249e+00,  elapsed time  14
INFO   step:     5,    loss: 3.6049e+02,   Y0: 2.7268e+00,  elapsed time  14
INFO   step:     6,    loss: 3.6045e+02,   Y0: 2.7298e+00,  elapsed time  15
INFO   step:     7,    loss: 3.6043e+02,   Y0: 2.7316e+00,  elapsed time  15
INFO   step:     8,    loss: 3.6040e+02,   Y0: 2.7332e+00,  elapsed time  16
INFO   step:     9,    loss: 3.6037e+02,   Y0: 2.7343e+00,  elapsed time  16
INFO   step:    10,    loss: 3.6035e+02,   Y0: 2.7357e+00,  elapsed time  17
INFO   step:    11,    loss: 3.6032e+02,   Y0: 2.7360e+00,  elapsed time  18
INFO   step:    12,    loss: 3.6030e+02,   Y0: 2.7369e+00,  elapsed time  18
INFO   step:    13,    loss: 3.6027e+02,   Y0: 2.7370e+00,  elapsed time  19
INFO   step:    14,    loss: 3.6024e+02,   Y0: 2.7371e+00,  elapsed time  19
INFO   step:    15,    loss: 3.6021e+02,   Y0: 2.7373e+00,  elapsed time  20
INFO   step:    16,    loss: 3.6018e+02,   Y0: 2.7377e+00,  elapsed time  20
INFO   step:    17,    loss: 3.6015e+02,   Y0: 2.7384e+00,  elapsed time  21
INFO   step:    18,    loss: 3.6011e+02,   Y0: 2.7392e+00,  elapsed time  21
INFO   step:    19,    loss: 3.6008e+02,   Y0: 2.7393e+00,  elapsed time  22
INFO   step:    20,    loss: 3.6005e+02,   Y0: 2.7395e+00,  elapsed time  23
INFO   step:    21,    loss: 3.6002e+02,   Y0: 2.7397e+00,  elapsed time  23
INFO   step:    22,    loss: 3.6000e+02,   Y0: 2.7402e+00,  elapsed time  24
INFO   step:    23,    loss: 3.5997e+02,   Y0: 2.7404e+00,  elapsed time  24
INFO   step:    24,    loss: 3.5994e+02,   Y0: 2.7411e+00,  elapsed time  25
INFO   step:    25,    loss: 3.5991e+02,   Y0: 2.7424e+00,  elapsed time  25
INFO   step:    26,    loss: 3.5988e+02,   Y0: 2.7436e+00,  elapsed time  26
INFO   step:    27,    loss: 3.5985e+02,   Y0: 2.7446e+00,  elapsed time  27
INFO   step:    28,    loss: 3.5982e+02,   Y0: 2.7448e+00,  elapsed time  27
INFO   step:    29,    loss: 3.5979e+02,   Y0: 2.7444e+00,  elapsed time  28
INFO   step:    30,    loss: 3.5976e+02,   Y0: 2.7446e+00,  elapsed time  28
INFO   step:    31,    loss: 3.5973e+02,   Y0: 2.7457e+00,  elapsed time  29
INFO   step:    32,    loss: 3.5970e+02,   Y0: 2.7461e+00,  elapsed time  29
INFO   step:    33,    loss: 3.5968e+02,   Y0: 2.7465e+00,  elapsed time  30
INFO   step:    34,    loss: 3.5965e+02,   Y0: 2.7474e+00,  elapsed time  30
INFO   step:    35,    loss: 3.5962e+02,   Y0: 2.7481e+00,  elapsed time  31
INFO   step:    36,    loss: 3.5960e+02,   Y0: 2.7489e+00,  elapsed time  32
INFO   step:    37,    loss: 3.5957e+02,   Y0: 2.7500e+00,  elapsed time  32
INFO   step:    38,    loss: 3.5954e+02,   Y0: 2.7511e+00,  elapsed time  33
INFO   step:    39,    loss: 3.5951e+02,   Y0: 2.7527e+00,  elapsed time  33
INFO   step:    40,    loss: 3.5948e+02,   Y0: 2.7540e+00,  elapsed time  34
INFO   step:    41,    loss: 3.5945e+02,   Y0: 2.7559e+00,  elapsed time  34
INFO   step:    42,    loss: 3.5942e+02,   Y0: 2.7582e+00,  elapsed time  35
INFO   step:    43,    loss: 3.5939e+02,   Y0: 2.7609e+00,  elapsed time  36
INFO   step:    44,    loss: 3.5936e+02,   Y0: 2.7629e+00,  elapsed time  36
INFO   step:    45,    loss: 3.5933e+02,   Y0: 2.7639e+00,  elapsed time  37
INFO   step:    46,    loss: 3.5930e+02,   Y0: 2.7650e+00,  elapsed time  37
INFO   step:    47,    loss: 3.5927e+02,   Y0: 2.7669e+00,  elapsed time  38
INFO   step:    48,    loss: 3.5924e+02,   Y0: 2.7683e+00,  elapsed time  38
INFO   step:    49,    loss: 3.5921e+02,   Y0: 2.7682e+00,  elapsed time  39
INFO   step:    50,    loss: 3.5918e+02,   Y0: 2.7684e+00,  elapsed time  39
INFO   step:    51,    loss: 3.5914e+02,   Y0: 2.7690e+00,  elapsed time  40
INFO   step:    52,    loss: 3.5911e+02,   Y0: 2.7693e+00,  elapsed time  41
INFO   step:    53,    loss: 3.5907e+02,   Y0: 2.7693e+00,  elapsed time  41
INFO   step:    54,    loss: 3.5903e+02,   Y0: 2.7687e+00,  elapsed time  42
INFO   step:    55,    loss: 3.5900e+02,   Y0: 2.7679e+00,  elapsed time  42
INFO   step:    56,    loss: 3.5897e+02,   Y0: 2.7676e+00,  elapsed time  43
INFO   step:    57,    loss: 3.5894e+02,   Y0: 2.7681e+00,  elapsed time  43
INFO   step:    58,    loss: 3.5891e+02,   Y0: 2.7684e+00,  elapsed time  44
INFO   step:    59,    loss: 3.5888e+02,   Y0: 2.7687e+00,  elapsed time  45
INFO   step:    60,    loss: 3.5885e+02,   Y0: 2.7690e+00,  elapsed time  45
INFO   step:    61,    loss: 3.5882e+02,   Y0: 2.7698e+00,  elapsed time  46
INFO   step:    62,    loss: 3.5879e+02,   Y0: 2.7705e+00,  elapsed time  46
INFO   step:    63,    loss: 3.5876e+02,   Y0: 2.7717e+00,  elapsed time  47
INFO   step:    64,    loss: 3.5874e+02,   Y0: 2.7727e+00,  elapsed time  47
INFO   step:    65,    loss: 3.5871e+02,   Y0: 2.7736e+00,  elapsed time  48
INFO   step:    66,    loss: 3.5868e+02,   Y0: 2.7747e+00,  elapsed time  48
INFO   step:    67,    loss: 3.5865e+02,   Y0: 2.7762e+00,  elapsed time  49
INFO   step:    68,    loss: 3.5862e+02,   Y0: 2.7783e+00,  elapsed time  50
INFO   step:    69,    loss: 3.5859e+02,   Y0: 2.7794e+00,  elapsed time  50
INFO   step:    70,    loss: 3.5856e+02,   Y0: 2.7795e+00,  elapsed time  51
INFO   step:    71,    loss: 3.5853e+02,   Y0: 2.7797e+00,  elapsed time  51
INFO   step:    72,    loss: 3.5850e+02,   Y0: 2.7806e+00,  elapsed time  52
INFO   step:    73,    loss: 3.5847e+02,   Y0: 2.7809e+00,  elapsed time  52
INFO   step:    74,    loss: 3.5845e+02,   Y0: 2.7801e+00,  elapsed time  53
INFO   step:    75,    loss: 3.5842e+02,   Y0: 2.7794e+00,  elapsed time  53
INFO   step:    76,    loss: 3.5839e+02,   Y0: 2.7784e+00,  elapsed time  54
INFO   step:    77,    loss: 3.5836e+02,   Y0: 2.7780e+00,  elapsed time  55
INFO   step:    78,    loss: 3.5834e+02,   Y0: 2.7780e+00,  elapsed time  55
INFO   step:    79,    loss: 3.5831e+02,   Y0: 2.7787e+00,  elapsed time  56
INFO   step:    80,    loss: 3.5828e+02,   Y0: 2.7790e+00,  elapsed time  56
INFO   step:    81,    loss: 3.5825e+02,   Y0: 2.7799e+00,  elapsed time  57
INFO   step:    82,    loss: 3.5822e+02,   Y0: 2.7816e+00,  elapsed time  57
INFO   step:    83,    loss: 3.5819e+02,   Y0: 2.7841e+00,  elapsed time  58
INFO   step:    84,    loss: 3.5815e+02,   Y0: 2.7863e+00,  elapsed time  59
INFO   step:    85,    loss: 3.5813e+02,   Y0: 2.7882e+00,  elapsed time  59
INFO   step:    86,    loss: 3.5810e+02,   Y0: 2.7896e+00,  elapsed time  60
INFO   step:    87,    loss: 3.5806e+02,   Y0: 2.7909e+00,  elapsed time  60
INFO   step:    88,    loss: 3.5804e+02,   Y0: 2.7924e+00,  elapsed time  61
INFO   step:    89,    loss: 3.5801e+02,   Y0: 2.7943e+00,  elapsed time  61
INFO   step:    90,    loss: 3.5798e+02,   Y0: 2.7960e+00,  elapsed time  62
INFO   step:    91,    loss: 3.5795e+02,   Y0: 2.7980e+00,  elapsed time  62
INFO   step:    92,    loss: 3.5792e+02,   Y0: 2.7997e+00,  elapsed time  63
INFO   step:    93,    loss: 3.5790e+02,   Y0: 2.8014e+00,  elapsed time  64
INFO   step:    94,    loss: 3.5787e+02,   Y0: 2.8026e+00,  elapsed time  64
INFO   step:    95,    loss: 3.5784e+02,   Y0: 2.8041e+00,  elapsed time  65
INFO   step:    96,    loss: 3.5781e+02,   Y0: 2.8054e+00,  elapsed time  65
INFO   step:    97,    loss: 3.5778e+02,   Y0: 2.8070e+00,  elapsed time  66
INFO   step:    98,    loss: 3.5775e+02,   Y0: 2.8093e+00,  elapsed time  66
INFO   step:    99,    loss: 3.5772e+02,   Y0: 2.8114e+00,  elapsed time  67
INFO   step:   100,    loss: 3.5770e+02,   Y0: 2.8136e+00,  elapsed time  68
INFO   step:   101,    loss: 3.5767e+02,   Y0: 2.8154e+00,  elapsed time  68
INFO   step:   102,    loss: 3.5764e+02,   Y0: 2.8168e+00,  elapsed time  69
INFO   step:   103,    loss: 3.5762e+02,   Y0: 2.8169e+00,  elapsed time  69
INFO   step:   104,    loss: 3.5759e+02,   Y0: 2.8171e+00,  elapsed time  70
INFO   step:   105,    loss: 3.5756e+02,   Y0: 2.8173e+00,  elapsed time  70
INFO   step:   106,    loss: 3.5753e+02,   Y0: 2.8174e+00,  elapsed time  71
INFO   step:   107,    loss: 3.5750e+02,   Y0: 2.8164e+00,  elapsed time  71
INFO   step:   108,    loss: 3.5747e+02,   Y0: 2.8153e+00,  elapsed time  72
INFO   step:   109,    loss: 3.5745e+02,   Y0: 2.8142e+00,  elapsed time  73
INFO   step:   110,    loss: 3.5742e+02,   Y0: 2.8123e+00,  elapsed time  73
INFO   step:   111,    loss: 3.5739e+02,   Y0: 2.8115e+00,  elapsed time  74
INFO   step:   112,    loss: 3.5737e+02,   Y0: 2.8110e+00,  elapsed time  74
INFO   step:   113,    loss: 3.5734e+02,   Y0: 2.8106e+00,  elapsed time  75
INFO   step:   114,    loss: 3.5731e+02,   Y0: 2.8106e+00,  elapsed time  75
INFO   step:   115,    loss: 3.5728e+02,   Y0: 2.8102e+00,  elapsed time  76
INFO   step:   116,    loss: 3.5725e+02,   Y0: 2.8102e+00,  elapsed time  76
INFO   step:   117,    loss: 3.5723e+02,   Y0: 2.8095e+00,  elapsed time  77
INFO   step:   118,    loss: 3.5720e+02,   Y0: 2.8080e+00,  elapsed time  78
INFO   step:   119,    loss: 3.5717e+02,   Y0: 2.8070e+00,  elapsed time  78
INFO   step:   120,    loss: 3.5714e+02,   Y0: 2.8054e+00,  elapsed time  79
INFO   step:   121,    loss: 3.5712e+02,   Y0: 2.8035e+00,  elapsed time  79
INFO   step:   122,    loss: 3.5709e+02,   Y0: 2.8019e+00,  elapsed time  80
INFO   step:   123,    loss: 3.5705e+02,   Y0: 2.8009e+00,  elapsed time  80
INFO   step:   124,    loss: 3.5702e+02,   Y0: 2.7999e+00,  elapsed time  81
INFO   step:   125,    loss: 3.5699e+02,   Y0: 2.7996e+00,  elapsed time  82
INFO   step:   126,    loss: 3.5696e+02,   Y0: 2.7985e+00,  elapsed time  82
INFO   step:   127,    loss: 3.5694e+02,   Y0: 2.7971e+00,  elapsed time  83
INFO   step:   128,    loss: 3.5691e+02,   Y0: 2.7962e+00,  elapsed time  83
INFO   step:   129,    loss: 3.5688e+02,   Y0: 2.7949e+00,  elapsed time  84
INFO   step:   130,    loss: 3.5686e+02,   Y0: 2.7934e+00,  elapsed time  84
INFO   step:   131,    loss: 3.5683e+02,   Y0: 2.7918e+00,  elapsed time  85
INFO   step:   132,    loss: 3.5680e+02,   Y0: 2.7905e+00,  elapsed time  85
INFO   step:   133,    loss: 3.5677e+02,   Y0: 2.7901e+00,  elapsed time  86
INFO   step:   134,    loss: 3.5675e+02,   Y0: 2.7896e+00,  elapsed time  87
INFO   step:   135,    loss: 3.5672e+02,   Y0: 2.7892e+00,  elapsed time  87
INFO   step:   136,    loss: 3.5669e+02,   Y0: 2.7894e+00,  elapsed time  88
INFO   step:   137,    loss: 3.5666e+02,   Y0: 2.7902e+00,  elapsed time  88
INFO   step:   138,    loss: 3.5663e+02,   Y0: 2.7918e+00,  elapsed time  89
INFO   step:   139,    loss: 3.5661e+02,   Y0: 2.7933e+00,  elapsed time  89
INFO   step:   140,    loss: 3.5658e+02,   Y0: 2.7951e+00,  elapsed time  90
INFO   step:   141,    loss: 3.5655e+02,   Y0: 2.7964e+00,  elapsed time  90
INFO   step:   142,    loss: 3.5652e+02,   Y0: 2.7973e+00,  elapsed time  91
INFO   step:   143,    loss: 3.5649e+02,   Y0: 2.7984e+00,  elapsed time  92
INFO   step:   144,    loss: 3.5646e+02,   Y0: 2.7983e+00,  elapsed time  92
INFO   step:   145,    loss: 3.5643e+02,   Y0: 2.7987e+00,  elapsed time  93
INFO   step:   146,    loss: 3.5640e+02,   Y0: 2.7998e+00,  elapsed time  93
INFO   step:   147,    loss: 3.5637e+02,   Y0: 2.8008e+00,  elapsed time  94
INFO   step:   148,    loss: 3.5634e+02,   Y0: 2.8023e+00,  elapsed time  94
INFO   step:   149,    loss: 3.5631e+02,   Y0: 2.8040e+00,  elapsed time  95
Delta:  160 ,  160.05
Other:  -50 ,  -50
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 2) dtype=float64>]
num_iterations:  150
total time intervals:  10
# of dimensions:  2
Loss out:  348.64582051596574
Output_Z_Vals:  [[[ 1.59279662e+02 -4.92953865e+01]
  [ 1.59279662e+02 -4.92953865e+01]
  [ 1.59279662e+02 -4.92953865e+01]
  ...
  [ 1.59279662e+02 -4.92953865e+01]
  [ 1.59279662e+02 -4.92953865e+01]
  [ 1.59279662e+02 -4.92953865e+01]]

 [[-4.97739424e-02 -1.90415654e-01]
  [-6.02819585e-02 -2.86330381e-01]
  [ 8.97530872e-02 -2.82099341e-01]
  ...
  [-8.06209472e-02 -4.71979941e-01]
  [-6.86030918e-02 -3.62283752e-01]
  [-6.67907114e-02 -3.45740764e-01]]

 [[-1.54578639e-02 -1.78193471e-01]
  [-2.36163432e-02 -8.46610358e-02]
  [-1.64029802e-02 -1.67358237e-01]
  ...
  [-4.13226453e-01 -8.73854303e-02]
  [-3.66764037e-01 -5.70693626e-02]
  [-1.36315430e-01  4.95868716e-02]]

 ...

 [[-4.70145304e-02 -4.20946173e-01]
  [ 1.54785595e-01 -2.51387407e-01]
  [ 2.37683811e-01 -1.57412312e-01]
  ...
  [ 1.44635993e-01  1.09219474e-01]
  [ 1.29073905e-01 -2.74546760e-01]
  [ 1.13065836e-01 -2.87425488e-01]]

 [[ 5.85962392e-02 -1.08248166e-01]
  [ 5.29351446e-02 -1.23088281e-01]
  [ 5.18449269e-02 -1.25946202e-01]
  ...
  [-3.66450464e-01 -3.91939459e-01]
  [ 5.41599877e-02 -1.19877451e-01]
  [ 5.27963922e-02 -1.23452010e-01]]

 [[ 4.94750720e-02  1.43899131e-01]
  [ 4.06005136e-02 -7.41217485e-02]
  [-2.42453962e-03 -2.17248768e-02]
  ...
  [ 3.99610653e-02 -5.26893905e-02]
  [ 2.69030741e-02  7.18666031e-02]
  [ 3.01489511e-02 -6.54048637e-02]]]
Z_Vals dimensionality:  (10, 200, 2)
X_test:  [[[1.00000000e+02 9.89221442e+01 9.76415302e+01 ... 8.72174685e+01
   8.77823594e+01 8.91101665e+01]
  [4.00000000e-02 4.01238364e-02 4.18124292e-02 ... 4.47955223e-02
   4.45868257e-02 4.24289680e-02]]

 [[1.00000000e+02 1.00179701e+02 9.80506186e+01 ... 9.64999959e+01
   9.89326976e+01 9.80166993e+01]
  [4.00000000e-02 3.81908492e-02 4.00017831e-02 ... 4.44202203e-02
   4.32690479e-02 4.26911126e-02]]

 [[1.00000000e+02 9.67178856e+01 9.76943663e+01 ... 9.68934729e+01
   9.55692217e+01 9.29384624e+01]
  [4.00000000e-02 3.93048177e-02 3.97761189e-02 ... 3.11687264e-02
   3.04615143e-02 3.34549172e-02]]

 ...

 [[1.00000000e+02 1.04241706e+02 1.02511481e+02 ... 1.06715445e+02
   1.02965563e+02 1.02625873e+02]
  [4.00000000e-02 3.88714344e-02 3.75024757e-02 ... 4.08980179e-02
   4.49075455e-02 4.27240149e-02]]

 [[1.00000000e+02 1.01759577e+02 1.02139752e+02 ... 9.42845931e+01
   9.11683023e+01 9.32620935e+01]
  [4.00000000e-02 3.99825347e-02 4.05298108e-02 ... 4.25444175e-02
   4.37626388e-02 4.44439710e-02]]

 [[1.00000000e+02 1.01385340e+02 1.00577524e+02 ... 9.54958710e+01
   9.82889741e+01 9.81377029e+01]
  [4.00000000e-02 4.16337819e-02 4.01551107e-02 ... 3.27681413e-02
   3.26791289e-02 3.32437925e-02]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-1.54578639e-02 -1.78193471e-01]
 [ 2.42778508e-01  1.56812126e-01]
 [ 2.27849595e-01  1.55654787e-01]
 [ 2.88426764e-01 -2.32413171e-01]
 [ 8.07935246e-02 -1.64570855e-01]
 [-4.70145304e-02 -4.20946173e-01]
 [ 5.85962392e-02 -1.08248166e-01]
 [ 4.94750720e-02  1.43899131e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.96158502]
curr_Stock_Price:  98.92214415054652
curr_Factors:  [9.89221442e+01 4.01238364e-02]
mat_Sqrt:  [[ 1.98150306e+01  0.00000000e+00]
 [-8.01237408e-03  1.83586553e-02]]
grads:  [-6.70592691e-03 -1.03719826e+01]
Stock Position:  -0.0067059269149252355
Bond Position:  [-4.29822035]


portfolio before change:  [-4.95514697]
curr_Stock_Price:  97.64153021351609
curr_Factors:  [9.76415302e+01 4.18124292e-02]
mat_Sqrt:  [[ 1.99658258e+01  0.00000000e+00]
 [-8.17923510e-03  1.87409820e-02]]
grads:  [-4.66937214e-03 -9.50822489e+00]
Stock Position:  -0.0046693721431684924
Bond Position:  [-4.49922233]


portfolio before change:  [-4.95915443]
curr_Stock_Price:  98.01787482397921
curr_Factors:  [9.80178748e+01 4.22058570e-02]
mat_Sqrt:  [[ 2.01368550e+01  0.00000000e+00]
 [-8.21762564e-03  1.88289458e-02]]
grads:  [0.01545509 8.32824778]
Stock Position:  0.015455091154632854
Bond Position:  [-6.47402962]


portfolio before change:  [-4.98709491]
curr_Stock_Price:  96.41952434380482
curr_Factors:  [9.64195243e+01 4.32838035e-02]
mat_Sqrt:  [[ 2.00598505e+01  0.00000000e+00]
 [-8.32190396e-03  1.90678774e-02]]
grads:  [0.01474502 8.16319422]
Stock Position:  0.014745020783144906
Bond Position:  [-6.4088028]


portfolio before change:  [-5.02757991]
curr_Stock_Price:  93.89122676571287
curr_Factors:  [9.38912268e+01 4.34267721e-02]
mat_Sqrt:  [[ 1.95660783e+01  0.00000000e+00]
 [-8.33563647e-03  1.90993425e-02]]
grads:  [ 9.55701683e-03 -1.21686477e+01]
Stock Position:  0.009557016828567686
Bond Position:  [-5.92489995]


portfolio before change:  [-5.07750139]
curr_Stock_Price:  88.9777388857318
curr_Factors:  [8.89777389e+01 4.92095392e-02]
mat_Sqrt:  [[ 1.97381304e+01  0.00000000e+00]
 [-8.87328928e-03  2.03312599e-02]]
grads:  [ 4.54395368e-04 -8.09447402e+00]
Stock Position:  0.0004543953679014722
Bond Position:  [-5.11793246]


portfolio before change:  [-5.08052428]
curr_Stock_Price:  87.95818243976444
curr_Factors:  [8.79581824e+01 4.75627369e-02]
mat_Sqrt:  [[ 1.91826969e+01  0.00000000e+00]
 [-8.72355312e-03  1.99881713e-02]]
grads:  [-1.20280533e-02 -2.10597642e+01]
Stock Position:  -0.01202805333574774
Bond Position:  [-4.02255857]


portfolio before change:  [-5.07362671]
curr_Stock_Price:  87.21746850815875
curr_Factors:  [8.72174685e+01 4.47955223e-02]
mat_Sqrt:  [[ 1.84595360e+01  0.00000000e+00]
 [-8.46598108e-03  1.93979996e-02]]
grads:  [ 6.15013649e-04 -5.58037777e+00]
Stock Position:  0.0006150136491156798
Bond Position:  [-5.12726665]


portfolio before change:  [-5.07584357]
curr_Stock_Price:  87.78235944862602
curr_Factors:  [8.77823594e+01 4.45868257e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.07584357]
Stock Price:  89.1101665358314
PL:  [-5.07584357]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.02819585e-02 -2.86330381e-01]
 [-2.36163432e-02 -8.46610358e-02]
 [ 2.38750263e-01  1.55440131e-01]
 [ 2.18497276e-01  1.52137087e-01]
 [ 2.34960459e-02 -5.91074998e-02]
 [ 7.93262228e-02 -5.96814275e-02]
 [ 1.54785595e-01 -2.51387407e-01]
 [ 5.29351446e-02 -1.23088281e-01]
 [ 4.06005136e-02 -7.41217485e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.70080897]
curr_Stock_Price:  100.17970149128494
curr_Factors:  [1.00179701e+02 3.81908492e-02]
mat_Sqrt:  [[ 1.95775973e+01  0.00000000e+00]
 [-7.81699167e-03  1.79109780e-02]]
grads:  [-9.46218166e-03 -1.59863063e+01]
Stock Position:  -0.00946218165987124
Bond Position:  [4.6487275]


portfolio before change:  [3.72327968]
curr_Stock_Price:  98.05061864862023
curr_Factors:  [9.80506186e+01 4.00017831e-02]
mat_Sqrt:  [[ 1.96105608e+01  0.00000000e+00]
 [-8.00017830e-03  1.83307113e-02]]
grads:  [-3.08840982e-03 -4.61853522e+00]
Stock Position:  -0.0030884098157481967
Bond Position:  [4.02610017]


portfolio before change:  [3.72413614]
curr_Stock_Price:  98.42527634914846
curr_Factors:  [9.84252763e+01 4.38066848e-02]
mat_Sqrt:  [[ 2.06004561e+01  0.00000000e+00]
 [-8.37201862e-03  1.91827045e-02]]
grads:  [0.01488268 8.10313951]
Stock Position:  0.01488267519311261
Bond Position:  [2.25930472]


portfolio before change:  [3.68322321]
curr_Stock_Price:  95.60032295506221
curr_Factors:  [9.56003230e+01 4.85223538e-02]
mat_Sqrt:  [[ 2.10586385e+01  0.00000000e+00]
 [-8.81111606e-03  2.01888031e-02]]
grads:  [0.01352867 7.53571602]
Stock Position:  0.013528668734812998
Bond Position:  [2.38987811]


portfolio before change:  [3.7161705]
curr_Stock_Price:  97.9473430718481
curr_Factors:  [9.79473431e+01 4.80352006e-02]
mat_Sqrt:  [[ 2.14670548e+01  0.00000000e+00]
 [-8.76677369e-03  2.00872020e-02]]
grads:  [-1.07168028e-04 -2.94254519e+00]
Stock Position:  -0.00010716802788319911
Bond Position:  [3.72666733]


portfolio before change:  [3.7178368]
curr_Stock_Price:  99.79031850296771
curr_Factors:  [9.97903185e+01 4.74530335e-02]
mat_Sqrt:  [[ 2.17380408e+01  0.00000000e+00]
 [-8.71348688e-03  1.99651066e-02]]
grads:  [ 2.45096203e-03 -2.98928669e+00]
Stock Position:  0.0024509620252733825
Bond Position:  [3.47325451]


portfolio before change:  [3.71204369]
curr_Stock_Price:  96.71798700421337
curr_Factors:  [9.67179870e+01 4.75411672e-02]
mat_Sqrt:  [[ 2.10883290e+01  0.00000000e+00]
 [-8.72157483e-03  1.99836384e-02]]
grads:  [ 2.13725494e-03 -1.25796615e+01]
Stock Position:  0.0021372549364644822
Bond Position:  [3.50533269]


portfolio before change:  [3.71333089]
curr_Stock_Price:  96.49999589078892
curr_Factors:  [9.64999959e+01 4.44202203e-02]
mat_Sqrt:  [[ 2.03384405e+01  0.00000000e+00]
 [-8.43044201e-03  1.93165693e-02]]
grads:  [-3.85961483e-05 -6.37216056e+00]
Stock Position:  -3.859614828415223e-05
Bond Position:  [3.71705542]


portfolio before change:  [3.71509599]
curr_Stock_Price:  98.93269758295848
curr_Factors:  [9.89326976e+01 4.32690479e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.71509599]
Stock Price:  98.01669927643802
PL:  [3.71509599]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.97530872e-02 -2.82099341e-01]
 [-1.64029802e-02 -1.67358237e-01]
 [ 2.39574394e-01  1.55720825e-01]
 [ 1.87288285e-01  1.61571780e-01]
 [-3.91663928e-03 -3.07769870e-02]
 [ 7.68462440e-02 -4.08172020e-02]
 [ 2.37683811e-01 -1.57412312e-01]
 [ 5.18449269e-02 -1.25946202e-01]
 [-2.42453962e-03 -2.17248768e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.14511233]
curr_Stock_Price:  96.71788557646775
curr_Factors:  [9.67178856e+01 3.93048177e-02]
mat_Sqrt:  [[ 1.91747490e+01  0.00000000e+00]
 [-7.93017707e-03  1.81703183e-02]]
grads:  [-1.74005714e-03 -1.55252833e+01]
Stock Position:  -0.0017400571363358737
Bond Position:  [-19.97681768]


portfolio before change:  [-20.15680237]
curr_Stock_Price:  97.69436632313172
curr_Factors:  [9.76943663e+01 3.97761189e-02]
mat_Sqrt:  [[ 1.94841167e+01  0.00000000e+00]
 [-7.97758048e-03  1.82789332e-02]]
grads:  [-4.59061627e-03 -9.15579895e+00]
Stock Position:  -0.004590616266194435
Bond Position:  [-19.70832502]


portfolio before change:  [-20.16959186]
curr_Stock_Price:  98.33324946326155
curr_Factors:  [9.83332495e+01 3.63013698e-02]
mat_Sqrt:  [[ 1.87353537e+01  0.00000000e+00]
 [-7.62116734e-03  1.74622881e-02]]
grads:  [0.01641477 8.91754985]
Stock Position:  0.016414770610226316
Bond Position:  [-21.7837096]


portfolio before change:  [-20.16016564]
curr_Stock_Price:  99.57120766206974
curr_Factors:  [9.95712077e+01 3.37259233e-02]
mat_Sqrt:  [[ 1.82858730e+01  0.00000000e+00]
 [-7.34584762e-03  1.68314514e-02]]
grads:  [0.01409853 9.59939677]
Stock Position:  0.014098533373244277
Bond Position:  [-21.56397364]


portfolio before change:  [-20.18338676]
curr_Stock_Price:  98.68909915517602
curr_Factors:  [9.86890992e+01 3.34389051e-02]
mat_Sqrt:  [[ 1.80465924e+01  0.00000000e+00]
 [-7.31452309e-03  1.67596779e-02]]
grads:  [-9.61334820e-04 -1.83637104e+00]
Stock Position:  -0.0009613348197122874
Bond Position:  [-20.08851349]


portfolio before change:  [-20.19342148]
curr_Stock_Price:  98.67655993383038
curr_Factors:  [9.86765599e+01 3.29893812e-02]
mat_Sqrt:  [[ 1.79226030e+01  0.00000000e+00]
 [-7.26519166e-03  1.66466454e-02]]
grads:  [ 0.00329373 -2.45197763]
Stock Position:  0.00329372673002681
Bond Position:  [-20.5184351]


portfolio before change:  [-20.20241418]
curr_Stock_Price:  99.0618627602407
curr_Factors:  [9.90618628e+01 3.14132776e-02]
mat_Sqrt:  [[ 1.75575177e+01  0.00000000e+00]
 [-7.08951649e-03  1.62441230e-02]]
grads:  [ 9.62456357e-03 -9.69041614e+00]
Stock Position:  0.009624563568737185
Bond Position:  [-21.15584137]


portfolio before change:  [-20.23386455]
curr_Stock_Price:  96.89347291955727
curr_Factors:  [9.68934729e+01 3.11687264e-02]
mat_Sqrt:  [[ 1.71062199e+01  0.00000000e+00]
 [-7.06186677e-03  1.61807695e-02]]
grads:  [-1.82536061e-04 -7.78369668e+00]
Stock Position:  -0.0001825360606339532
Bond Position:  [-20.21617799]


portfolio before change:  [-20.24373344]
curr_Stock_Price:  95.56922171842933
curr_Factors:  [9.55692217e+01 3.04615143e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.24373344]
Stock Price:  92.93846243044375
PL:  [-20.24373344]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.38566365e-02 -3.18959211e-01]
 [-1.79240778e-02  6.21334268e-02]
 [ 2.28278386e-01  1.51873476e-01]
 [ 1.59615390e-01  1.55701843e-01]
 [ 4.84462135e-02 -2.07034042e-02]
 [ 8.73417623e-02 -1.42501939e-01]
 [ 2.26593513e-01 -1.01699634e-01]
 [ 6.93264723e-02  4.48294845e-02]
 [ 3.58419624e-02 -7.01482994e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.83039685]
curr_Stock_Price:  100.77921169226968
curr_Factors:  [1.00779212e+02 3.96054252e-02]
mat_Sqrt:  [[ 2.00561836e+01  0.00000000e+00]
 [-7.96044473e-03  1.82396703e-02]]
grads:  [-1.01246505e-02 -1.74871150e+01]
Stock Position:  -0.010124650459340918
Bond Position:  [8.85075115]


portfolio before change:  [7.85400281]
curr_Stock_Price:  98.88487699597863
curr_Factors:  [9.88848770e+01 3.99829597e-02]
mat_Sqrt:  [[ 1.97727624e+01  0.00000000e+00]
 [-7.99829579e-03  1.83263979e-02]]
grads:  [4.64941246e-04 3.39037857e+00]
Stock Position:  0.00046494124597263535
Bond Position:  [7.80802715]


portfolio before change:  [7.85818141]
curr_Stock_Price:  99.47335177071479
curr_Factors:  [9.94733518e+01 3.88601997e-02]
mat_Sqrt:  [[ 1.96091725e+01  0.00000000e+00]
 [-7.88519623e-03  1.80672543e-02]]
grads:  [0.01502161 8.40600753]
Stock Position:  0.015021613258461864
Bond Position:  [6.36393119]


portfolio before change:  [7.87254438]
curr_Stock_Price:  100.21762670535333
curr_Factors:  [1.00217627e+02 4.06461741e-02]
mat_Sqrt:  [[ 2.02047718e+01  0.00000000e+00]
 [-8.06435854e-03  1.84777667e-02]]
grads:  [0.01126314 8.42644274]
Stock Position:  0.011263143542087909
Bond Position:  [6.74377887]


portfolio before change:  [7.87657372]
curr_Stock_Price:  100.27592349938406
curr_Factors:  [1.00275923e+02 4.44332398e-02]
mat_Sqrt:  [[ 2.11373559e+01  0.00000000e+00]
 [-8.43167740e-03  1.93194000e-02]]
grads:  [ 0.0018645  -1.07163806]
Stock Position:  0.0018644955981553125
Bond Position:  [7.6896097]


portfolio before change:  [7.88641158]
curr_Stock_Price:  103.48971509611107
curr_Factors:  [1.03489715e+02 4.07476216e-02]
mat_Sqrt:  [[ 2.08904754e+01  0.00000000e+00]
 [-8.07441605e-03  1.85008114e-02]]
grads:  [ 1.20384131e-03 -7.70246971e+00]
Stock Position:  0.0012038413072019318
Bond Position:  [7.76182639]


portfolio before change:  [7.88793703]
curr_Stock_Price:  101.53228161270052
curr_Factors:  [1.01532282e+02 4.43327171e-02]
mat_Sqrt:  [[ 2.13779630e+01  0.00000000e+00]
 [-8.42213437e-03  1.92975341e-02]]
grads:  [ 0.00852318 -5.2700844 ]
Stock Position:  0.008523176611785376
Bond Position:  [7.02255946]


portfolio before change:  [7.88037601]
curr_Stock_Price:  100.23309778746045
curr_Factors:  [1.00233098e+02 4.09497850e-02]
mat_Sqrt:  [[ 2.02832230e+01  0.00000000e+00]
 [-8.09442129e-03  1.85466491e-02]]
grads:  [0.00438252 2.41712043]
Stock Position:  0.0043825216190040775
Bond Position:  [7.4411023]


portfolio before change:  [7.87711508]
curr_Stock_Price:  98.63985627538605
curr_Factors:  [9.86398563e+01 3.76284324e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.87711508]
Stock Price:  100.38130367296304
PL:  [7.49581141]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.06759404e-02 -2.89926557e-01]
 [ 3.21951298e-02 -7.24508587e-01]
 [ 2.64013202e-01  1.64044529e-01]
 [ 2.17949708e-01  1.51931130e-01]
 [ 1.11327642e-01 -1.28584938e-01]
 [ 7.76145428e-02 -6.49046172e-02]
 [ 1.25920011e-01 -2.77396893e-01]
 [ 5.24859954e-02 -1.24265691e-01]
 [ 1.46946113e-02 -4.89696220e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.05911724]
curr_Stock_Price:  100.23171865938075
curr_Factors:  [1.00231719e+02 3.72533268e-02]
mat_Sqrt:  [[ 1.93458452e+01  0.00000000e+00]
 [-7.72044836e-03  1.76897695e-02]]
grads:  [-9.67702685e-03 -1.63895045e+01]
Stock Position:  -0.009677026851766614
Bond Position:  [5.02906228]


portfolio before change:  [4.10955522]
curr_Stock_Price:  95.27949370657792
curr_Factors:  [9.52794937e+01 4.31924945e-02]
mat_Sqrt:  [[ 1.98017505e+01  0.00000000e+00]
 [-8.31312163e-03  1.90477546e-02]]
grads:  [-1.43424866e-02 -3.80364302e+01]
Stock Position:  -0.014342486568861081
Bond Position:  [5.47610008]


portfolio before change:  [4.10363707]
curr_Stock_Price:  95.88307644162819
curr_Factors:  [9.58830764e+01 4.43541620e-02]
mat_Sqrt:  [[ 2.01933861e+01  0.00000000e+00]
 [-8.42417113e-03  1.93022009e-02]]
grads:  [0.0166197  8.49874735]
Stock Position:  0.01661970422802443
Bond Position:  [2.5100887]


portfolio before change:  [4.0997586]
curr_Stock_Price:  95.5741757706881
curr_Factors:  [9.55741758e+01 4.29258291e-02]
mat_Sqrt:  [[ 1.98015829e+01  0.00000000e+00]
 [-8.28741978e-03  1.89888642e-02]]
grads:  [0.01435531 8.00106461]
Stock Position:  0.014355311422589946
Bond Position:  [2.72776154]


portfolio before change:  [4.1128446]
curr_Stock_Price:  96.39072260984324
curr_Factors:  [9.63907226e+01 4.21618400e-02]
mat_Sqrt:  [[ 1.97922430e+01  0.00000000e+00]
 [-8.21333939e-03  1.88191247e-02]]
grads:  [ 2.78940463e-03 -6.83267366e+00]
Stock Position:  0.0027894046329199973
Bond Position:  [3.84397187]


portfolio before change:  [4.11589318]
curr_Stock_Price:  96.79443467539491
curr_Factors:  [9.67944347e+01 4.27744829e-02]
mat_Sqrt:  [[ 2.00190181e+01  0.00000000e+00]
 [-8.27279715e-03  1.89553596e-02]]
grads:  [ 2.46205110e-03 -3.42407734e+00]
Stock Position:  0.0024620511028126033
Bond Position:  [3.87758034]


portfolio before change:  [4.11480282]
curr_Stock_Price:  95.56390093544378
curr_Factors:  [9.55639009e+01 4.51445110e-02]
mat_Sqrt:  [[ 2.03046892e+01  0.00000000e+00]
 [-8.49889509e-03  1.94734150e-02]]
grads:  [ 2.39062116e-04 -1.42449022e+01]
Stock Position:  0.0002390621159562622
Bond Position:  [4.09195711]


portfolio before change:  [4.11720893]
curr_Stock_Price:  97.06818267465123
curr_Factors:  [9.70681827e+01 4.27996116e-02]
mat_Sqrt:  [[ 2.00815307e+01  0.00000000e+00]
 [-8.27522680e-03  1.89609266e-02]]
grads:  [-8.70450751e-05 -6.55377733e+00]
Stock Position:  -8.704507512423824e-05
Bond Position:  [4.12565824]


portfolio before change:  [4.11926973]
curr_Stock_Price:  97.09745496582534
curr_Factors:  [9.70974550e+01 4.10465935e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.11926973]
Stock Price:  96.23660839121426
PL:  [4.11926973]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.07988713e-02 -3.82326316e-01]
 [-5.94310555e-01 -2.05104889e-01]
 [-2.33591903e-01 -2.98181450e-01]
 [-1.16046626e-01  2.32646182e-02]
 [-1.39559107e-01 -1.01810090e-02]
 [ 3.36609382e-01  9.17075662e-02]
 [ 1.36119448e-01  1.62790759e-01]
 [-4.77098380e-01 -4.96157718e-01]
 [ 2.48729987e-02 -4.42464232e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.70548283]
curr_Stock_Price:  102.21282079312282
curr_Factors:  [1.02212821e+02 3.52156076e-02]
mat_Sqrt:  [[ 1.91810760e+01  0.00000000e+00]
 [-7.50632881e-03  1.71991600e-02]]
grads:  [-1.23903245e-02 -2.22293598e+01]
Stock Position:  -0.01239032445532702
Bond Position:  [18.97193284]


portfolio before change:  [17.69342072]
curr_Stock_Price:  103.95211753181574
curr_Factors:  [1.03952118e+02 3.23154502e-02]
mat_Sqrt:  [[ 1.86869510e+01  0.00000000e+00]
 [-7.19059944e-03  1.64757331e-02]]
grads:  [ -0.03659375 -12.44890818]
Stock Position:  -0.03659375294835048
Bond Position:  [21.49741882]


portfolio before change:  [17.71636785]
curr_Stock_Price:  103.61884371718584
curr_Factors:  [1.03618844e+02 3.26857443e-02]
mat_Sqrt:  [[ 1.87334572e+01  0.00000000e+00]
 [-7.23167968e-03  1.65698598e-02]]
grads:  [ -0.01941601 -17.99541181]
Stock Position:  -0.0194160081729281
Bond Position:  [19.72823217]


portfolio before change:  [17.72092742]
curr_Stock_Price:  103.89217566756483
curr_Factors:  [1.03892176e+02 3.59757783e-02]
mat_Sqrt:  [[ 1.97055219e+01  0.00000000e+00]
 [-7.58691277e-03  1.73838010e-02]]
grads:  [-0.00537378  1.33829294]
Stock Position:  -0.0053737787098407834
Bond Position:  [18.27922098]


portfolio before change:  [17.72366236]
curr_Stock_Price:  105.08443769406422
curr_Factors:  [1.05084438e+02 3.50942313e-02]
mat_Sqrt:  [[ 1.96859452e+01  0.00000000e+00]
 [-7.49338175e-03  1.71694945e-02]]
grads:  [-0.00731499 -0.5929708 ]
Stock Position:  -0.007314988526659795
Bond Position:  [18.49235382]


portfolio before change:  [17.72060733]
curr_Stock_Price:  106.7663984434148
curr_Factors:  [1.06766398e+02 3.21932213e-02]
mat_Sqrt:  [[ 1.91565285e+01  0.00000000e+00]
 [-7.17698782e-03  1.64445450e-02]]
grads:  [0.01966086 5.57677737]
Stock Position:  0.019660861060253283
Bond Position:  [15.621488]


portfolio before change:  [17.74652804]
curr_Stock_Price:  107.68741693649879
curr_Factors:  [1.07687417e+02 3.20860700e-02]
mat_Sqrt:  [[ 1.92896001e+01  0.00000000e+00]
 [-7.16503399e-03  1.64171553e-02]]
grads:  [0.01073984 9.91589322]
Stock Position:  0.01073983696362455
Bond Position:  [16.58998274]


portfolio before change:  [17.76703968]
curr_Stock_Price:  108.82473161577089
curr_Factors:  [1.08824732e+02 3.00896954e-02]
mat_Sqrt:  [[ 1.88771532e+01  0.00000000e+00]
 [-6.93855263e-03  1.58982213e-02]]
grads:  [ -0.03674491 -31.20837911]
Stock Position:  -0.03674491350346752
Bond Position:  [21.76579503]


portfolio before change:  [17.83475727]
curr_Stock_Price:  107.27806929927236
curr_Factors:  [1.07278069e+02 2.96008647e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.83475727]
Stock Price:  105.60695979453581
PL:  [12.22779748]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.06593810e-02 -3.81053081e-01]
 [-6.02078860e-01 -2.09464053e-01]
 [-3.03039465e-01 -2.20215576e-01]
 [-3.73887467e-01 -7.36450589e-02]
 [-1.24797958e-01 -1.07333205e-02]
 [ 7.68459447e-02 -3.21318756e-02]
 [ 1.77842824e-01 -2.25284674e-01]
 [-1.75807146e-02  1.18412713e-04]
 [ 3.91377605e-02 -5.07347494e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.50920686]
curr_Stock_Price:  102.18432655798789
curr_Factors:  [1.02184327e+02 4.06573464e-02]
mat_Sqrt:  [[ 2.06041073e+01  0.00000000e+00]
 [-8.06546677e-03  1.84803060e-02]]
grads:  [-1.15008419e-02 -2.06194140e+01]
Stock Position:  -0.011500841885551207
Bond Position:  [18.68441264]


portfolio before change:  [17.49765833]
curr_Stock_Price:  104.00098182543904
curr_Factors:  [1.04000982e+02 4.25854194e-02]
mat_Sqrt:  [[ 2.14618870e+01  0.00000000e+00]
 [-8.25449399e-03  1.89134218e-02]]
grads:  [ -0.03231293 -11.07488934]
Stock Position:  -0.03231293075439795
Bond Position:  [20.85823486]


portfolio before change:  [17.48917931]
curr_Stock_Price:  104.58621974243358
curr_Factors:  [1.04586220e+02 4.11273069e-02]
mat_Sqrt:  [[ 2.12099479e+01  0.00000000e+00]
 [-8.11194743e-03  1.85868066e-02]]
grads:  [ -0.01881897 -11.84795114]
Stock Position:  -0.018818972264650152
Bond Position:  [19.45738448]


portfolio before change:  [17.46123208]
curr_Stock_Price:  106.58836705245794
curr_Factors:  [1.06588367e+02 3.91575688e-02]
mat_Sqrt:  [[ 2.10919954e+01  0.00000000e+00]
 [-7.91530859e-03  1.81362504e-02]]
grads:  [-0.01925037 -4.06065517]
Stock Position:  -0.019250374256169447
Bond Position:  [19.51309803]


portfolio before change:  [17.5036326]
curr_Stock_Price:  104.89273580456727
curr_Factors:  [1.04892736e+02 3.98108072e-02]
mat_Sqrt:  [[ 2.09288760e+01  0.00000000e+00]
 [-7.98105830e-03  1.82869019e-02]]
grads:  [-0.00618678 -0.58694035]
Stock Position:  -0.0061867805689226766
Bond Position:  [18.15258094]


portfolio before change:  [17.54607399]
curr_Stock_Price:  99.50013629386747
curr_Factors:  [9.95001363e+01 4.08802508e-02]
mat_Sqrt:  [[ 2.01177984e+01  0.00000000e+00]
 [-8.08754606e-03  1.85308960e-02]]
grads:  [ 0.00312273 -1.73396233]
Stock Position:  0.0031227296000865623
Bond Position:  [17.23536197]


portfolio before change:  [17.54804082]
curr_Stock_Price:  97.36962591944483
curr_Factors:  [9.73696259e+01 4.39793081e-02]
mat_Sqrt:  [[ 2.04196220e+01  0.00000000e+00]
 [-8.38849765e-03  1.92204627e-02]]
grads:  [ 3.89431948e-03 -1.17210848e+01]
Stock Position:  0.0038943194799049992
Bond Position:  [17.16885239]


portfolio before change:  [17.57332528]
curr_Stock_Price:  101.65738098154463
curr_Factors:  [1.01657381e+02 4.20628174e-02]
mat_Sqrt:  [[ 2.08491376e+01  0.00000000e+00]
 [-8.20368868e-03  1.87970122e-02]]
grads:  [-0.00084076  0.00629955]
Stock Position:  -0.0008407558785089087
Bond Position:  [17.65879432]


portfolio before change:  [17.58090009]
curr_Stock_Price:  103.15222018968656
curr_Factors:  [1.03152220e+02 4.36850568e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.58090009]
Stock Price:  102.0423397504955
PL:  [15.53856034]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.56761218e-02 -3.35567049e-01]
 [-5.05952036e-01 -1.47178590e-01]
 [-5.43244988e-01  1.10731508e-01]
 [-7.46149443e-01 -2.26660851e-01]
 [-3.30355228e-01  4.73207687e-02]
 [ 7.89782095e-01  5.92940873e-01]
 [-1.74623581e-01  4.24511399e-01]
 [-8.14503236e-01 -8.01467456e-01]
 [ 2.34840602e-02  5.24739431e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.41994027]
curr_Stock_Price:  101.15514695120964
curr_Factors:  [1.01155147e+02 4.19238157e-02]
mat_Sqrt:  [[ 2.07118259e+01  0.00000000e+00]
 [-8.19012241e-03  1.87659279e-02]]
grads:  [-1.02419550e-02 -1.78817189e+01]
Stock Position:  -0.010241955001616924
Bond Position:  [11.45596673]


portfolio before change:  [10.404316]
curr_Stock_Price:  103.24006902090231
curr_Factors:  [1.03240069e+02 4.22281398e-02]
mat_Sqrt:  [[ 2.12153041e+01  0.00000000e+00]
 [-8.21979463e-03  1.88339155e-02]]
grads:  [-0.02687617 -7.81455083]
Stock Position:  -0.026876166183511054
Bond Position:  [13.17901326]


portfolio before change:  [10.28500177]
curr_Stock_Price:  107.92471741095207
curr_Factors:  [1.07924717e+02 4.22984704e-02]
mat_Sqrt:  [[ 2.21964362e+01  0.00000000e+00]
 [-8.22663677e-03  1.88495929e-02]]
grads:  [-0.02229717  5.87447744]
Stock Position:  -0.022297173780968106
Bond Position:  [12.69141795]


portfolio before change:  [10.23570837]
curr_Stock_Price:  110.42013208332438
curr_Factors:  [1.10420132e+02 4.31514501e-02]
mat_Sqrt:  [[ 2.29374936e+01  0.00000000e+00]
 [-8.30917085e-03  1.90387022e-02]]
grads:  [ -0.0368424  -11.90526794]
Stock Position:  -0.03684240152939204
Bond Position:  [14.30385121]


portfolio before change:  [10.21474939]
curr_Stock_Price:  111.1831846930992
curr_Factors:  [1.11183185e+02 4.09935051e-02]
mat_Sqrt:  [[ 2.25110958e+01  0.00000000e+00]
 [-8.09874114e-03  1.85565472e-02]]
grads:  [-0.01375778  2.55008479]
Stock Position:  -0.013757782120714475
Bond Position:  [11.74438342]


portfolio before change:  [10.21747527]
curr_Stock_Price:  111.41198501802374
curr_Factors:  [1.11411985e+02 3.98682636e-02]
mat_Sqrt:  [[ 2.22456742e+01  0.00000000e+00]
 [-7.98681549e-03  1.83000933e-02]]
grads:  [ 0.04713558 32.40097546]
Stock Position:  0.04713557785030302
Bond Position:  [4.96600698]


portfolio before change:  [10.3083911]
curr_Stock_Price:  113.28810945304625
curr_Factors:  [1.13288109e+02 3.89143060e-02]
mat_Sqrt:  [[ 2.23480160e+01  0.00000000e+00]
 [-7.89068372e-03  1.80798277e-02]]
grads:  [4.76479997e-04 2.34798365e+01]
Stock Position:  0.00047647999650816833
Bond Position:  [10.25441158]


portfolio before change:  [10.3144822]
curr_Stock_Price:  115.30835573553752
curr_Factors:  [1.15308356e+02 3.81728498e-02]
mat_Sqrt:  [[ 2.25288006e+01  0.00000000e+00]
 [-7.81514937e-03  1.79067568e-02]]
grads:  [ -0.05168017 -44.75782334]
Stock Position:  -0.05168017295243978
Bond Position:  [16.27363796]


portfolio before change:  [10.51593081]
curr_Stock_Price:  111.56785432068733
curr_Factors:  [1.11567854e+02 3.91026814e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.51593081]
Stock Price:  110.72724473276112
PL:  [-0.21131392]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.18344275e-02 -3.00500958e-01]
 [-3.63885274e-01 -5.54674015e-02]
 [ 1.21357273e-01  6.25964179e-02]
 [ 1.30134011e-01  1.44412068e-01]
 [ 1.25414356e-02 -4.41974007e-03]
 [ 8.85047412e-02 -1.63577085e-01]
 [ 1.93421369e-01 -4.28572402e-02]
 [-3.83700459e-02  2.69040669e-02]
 [ 3.40886288e-02 -3.87474024e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.13217601]
curr_Stock_Price:  100.38749925941688
curr_Factors:  [1.00387499e+02 3.85734895e-02]
mat_Sqrt:  [[ 1.97162402e+01  0.00000000e+00]
 [-7.85605392e-03  1.80004809e-02]]
grads:  [-9.78806282e-03 -1.66940516e+01]
Stock Position:  -0.009788062816536765
Bond Position:  [6.11477516]


portfolio before change:  [5.11825778]
curr_Stock_Price:  102.12189612157319
curr_Factors:  [1.02121896e+02 3.65197341e-02]
mat_Sqrt:  [[ 1.95156344e+01  0.00000000e+00]
 [-7.64405485e-03  1.75147300e-02]]
grads:  [-0.01988627 -3.16690018]
Stock Position:  -0.019886272984630155
Bond Position:  [7.14908168]


portfolio before change:  [5.14907934]
curr_Stock_Price:  100.751799214671
curr_Factors:  [1.00751799e+02 3.77393434e-02]
mat_Sqrt:  [[ 1.95726658e+01  0.00000000e+00]
 [-7.77064666e-03  1.78047883e-02]]
grads:  [0.00759613 3.51570695]
Stock Position:  0.007596133847743713
Bond Position:  [4.38375518]


portfolio before change:  [5.15092585]
curr_Stock_Price:  100.70626084474667
curr_Factors:  [1.00706261e+02 3.74386973e-02]
mat_Sqrt:  [[ 1.94857370e+01  0.00000000e+00]
 [-7.73963279e-03  1.77337266e-02]]
grads:  [0.00991292 8.14335711]
Stock Position:  0.009912922728081202
Bond Position:  [4.15263246]


portfolio before change:  [5.16221486]
curr_Stock_Price:  101.63557039027731
curr_Factors:  [1.01635570e+02 3.74490014e-02]
mat_Sqrt:  [[ 1.96682559e+01  0.00000000e+00]
 [-7.74069779e-03  1.77361668e-02]]
grads:  [ 0.00053958 -0.24919365]
Stock Position:  0.0005395751898978974
Bond Position:  [5.10737482]


portfolio before change:  [5.16475711]
curr_Stock_Price:  101.61319915425625
curr_Factors:  [1.01613199e+02 3.55276568e-02]
mat_Sqrt:  [[ 1.91528500e+01  0.00000000e+00]
 [-7.53951264e-03  1.72751937e-02]]
grads:  [ 8.93540568e-04 -9.46890020e+00]
Stock Position:  0.0008935405679141145
Bond Position:  [5.07396159]


portfolio before change:  [5.16802804]
curr_Stock_Price:  102.43388519922229
curr_Factors:  [1.02433885e+02 3.68533127e-02]
mat_Sqrt:  [[ 1.96644549e+01  0.00000000e+00]
 [-7.67888666e-03  1.75945397e-02]]
grads:  [ 0.00888491 -2.43582617]
Stock Position:  0.008884911253143116
Bond Position:  [4.25791206]


portfolio before change:  [5.16855223]
curr_Stock_Price:  102.25320762475974
curr_Factors:  [1.02253208e+02 3.46519334e-02]
mat_Sqrt:  [[ 1.90344651e+01  0.00000000e+00]
 [-7.44601192e-03  1.70609566e-02]]
grads:  [-1.39894388e-03  1.57693777e+00]
Stock Position:  -0.0013989438836129811
Bond Position:  [5.31159873]


portfolio before change:  [5.16835371]
curr_Stock_Price:  104.29401826764514
curr_Factors:  [1.04294018e+02 3.14309626e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.16835371]
Stock Price:  105.75897332889446
PL:  [-0.59061962]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.16632155e-02 -2.76783459e-01]
 [-9.15698202e-03  6.46798705e-02]
 [ 2.20405507e-01  1.55186071e-01]
 [-9.58033539e-02  3.08720997e-02]
 [-5.68439747e-02 -4.00794886e-03]
 [ 8.76601194e-02 -1.55110107e-01]
 [ 2.06220875e-01 -6.56175387e-02]
 [-8.67678322e-02  2.06773309e-02]
 [ 4.53386195e-02 -6.54564587e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.67405406]
curr_Stock_Price:  97.65731719725963
curr_Factors:  [9.76573172e+01 3.76336468e-02]
mat_Sqrt:  [[ 1.89449272e+01  0.00000000e+00]
 [-7.75975740e-03  1.77798378e-02]]
grads:  [-2.06572391e-03 -1.55672656e+01]
Stock Position:  -0.002065723913360628
Bond Position:  [-13.47232101]


portfolio before change:  [-13.68348432]
curr_Stock_Price:  98.9606932824122
curr_Factors:  [9.89606933e+01 3.63039942e-02]
mat_Sqrt:  [[ 1.88555816e+01  0.00000000e+00]
 [-7.62144283e-03  1.74629193e-02]]
grads:  [1.01145794e-03 3.70384065e+00]
Stock Position:  0.0010114579375516207
Bond Position:  [-13.7835789]


portfolio before change:  [-13.68952204]
curr_Stock_Price:  99.80679967946803
curr_Factors:  [9.98067997e+01 3.46192034e-02]
mat_Sqrt:  [[ 1.85702891e+01  0.00000000e+00]
 [-7.44249458e-03  1.70528974e-02]]
grads:  [0.01551587 9.10027593]
Stock Position:  0.015515873740980778
Bond Position:  [-15.23811174]


portfolio before change:  [-13.63704226]
curr_Stock_Price:  103.68029989619251
curr_Factors:  [1.03680300e+02 3.47372046e-02]
mat_Sqrt:  [[ 1.93238509e+01  0.00000000e+00]
 [-7.45516782e-03  1.70819354e-02]]
grads:  [-0.00426052  1.80729519]
Stock Position:  -0.004260520608045009
Bond Position:  [-13.1953102]


portfolio before change:  [-13.64205171]
curr_Stock_Price:  103.3071409671841
curr_Factors:  [1.03307141e+02 3.32119063e-02]
mat_Sqrt:  [[ 1.88268319e+01  0.00000000e+00]
 [-7.28965363e-03  1.67026948e-02]]
grads:  [-0.00311222 -0.23995822]
Stock Position:  -0.0031122170373205455
Bond Position:  [-13.32053747]


portfolio before change:  [-13.64193087]
curr_Stock_Price:  101.12773730949914
curr_Factors:  [1.01127737e+02 3.55826327e-02]
mat_Sqrt:  [[ 1.90760885e+01  0.00000000e+00]
 [-7.54534375e-03  1.72885545e-02]]
grads:  [ 1.04657298e-03 -8.97183783e+00]
Stock Position:  0.0010465729800497826
Bond Position:  [-13.74776842]


portfolio before change:  [-13.6478027]
curr_Stock_Price:  102.08683949129227
curr_Factors:  [1.02086839e+02 3.61463100e-02]
mat_Sqrt:  [[ 1.94089367e+01  0.00000000e+00]
 [-7.60487318e-03  1.74249535e-02]]
grads:  [ 0.00914955 -3.76572246]
Stock Position:  0.009149549810776434
Bond Position:  [-14.58185132]


portfolio before change:  [-13.6437046]
curr_Stock_Price:  103.33180169173532
curr_Factors:  [1.03331802e+02 3.52333095e-02]
mat_Sqrt:  [[ 1.93959351e+01  0.00000000e+00]
 [-7.50821519e-03  1.72034822e-02]]
grads:  [-0.00400824  1.20192707]
Stock Position:  -0.004008237028708916
Bond Position:  [-13.22952625]


portfolio before change:  [-13.64392661]
curr_Stock_Price:  101.7364826513185
curr_Factors:  [1.01736483e+02 3.68019415e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.64392661]
Stock Price:  99.19878813364187
PL:  [-13.64392661]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.21897394e-02 -2.12466486e-01]
 [-1.51628443e-02 -1.81575707e-01]
 [-2.22856928e-01 -3.10233158e-01]
 [ 1.93421277e-01  1.62872702e-01]
 [ 2.83992029e-02 -9.01421106e-03]
 [ 8.85312288e-02 -1.64057086e-01]
 [ 2.67102207e-01 -1.25580053e-01]
 [ 3.91060690e-02  2.81993722e-02]
 [ 4.61418520e-02 -6.73634454e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.62676572]
curr_Stock_Price:  99.40627434646568
curr_Factors:  [9.94062743e+01 4.24971014e-02]
mat_Sqrt:  [[ 2.04924296e+01  0.00000000e+00]
 [-8.24593004e-03  1.88937993e-02]]
grads:  [-7.07176840e-03 -1.12453024e+01]
Stock Position:  -0.007071768401226219
Bond Position:  [-0.92378757]


portfolio before change:  [-1.61461299]
curr_Stock_Price:  97.6224578685762
curr_Factors:  [9.76224579e+01 4.33133016e-02]
mat_Sqrt:  [[ 2.03170375e+01  0.00000000e+00]
 [-8.32473919e-03  1.90743737e-02]]
grads:  [-4.64678867e-03 -9.51935353e+00]
Stock Position:  -0.0046467886712980135
Bond Position:  [-1.16098206]


portfolio before change:  [-1.63778977]
curr_Stock_Price:  102.48520288129401
curr_Factors:  [1.02485203e+02 4.13310521e-02]
mat_Sqrt:  [[ 2.08352826e+01  0.00000000e+00]
 [-8.13201595e-03  1.86327893e-02]]
grads:  [ -0.01719457 -16.64985057]
Stock Position:  -0.017194572560279675
Bond Position:  [0.12439948]


portfolio before change:  [-1.58484821]
curr_Stock_Price:  99.40985199534703
curr_Factors:  [9.94098520e+01 4.21800234e-02]
mat_Sqrt:  [[ 2.04165725e+01  0.00000000e+00]
 [-8.21511032e-03  1.88231824e-02]]
grads:  [0.01295539 8.6527718 ]
Stock Position:  0.012955394539813885
Bond Position:  [-2.87274207]


portfolio before change:  [-1.56341719]
curr_Stock_Price:  101.17496670863237
curr_Factors:  [1.01174967e+02 4.26504762e-02]
mat_Sqrt:  [[ 2.08946457e+01  0.00000000e+00]
 [-8.26079669e-03  1.89278631e-02]]
grads:  [ 0.00117088 -0.47624029]
Stock Position:  0.0011708778864041199
Bond Position:  [-1.68188072]


portfolio before change:  [-1.56380715]
curr_Stock_Price:  101.56030390852185
curr_Factors:  [1.01560304e+02 4.45980789e-02]
mat_Sqrt:  [[ 2.14477662e+01  0.00000000e+00]
 [-8.44730290e-03  1.93552025e-02]]
grads:  [ 7.89399053e-04 -8.47612348e+00]
Stock Position:  0.000789399053393707
Bond Position:  [-1.64397876]


portfolio before change:  [-1.56588221]
curr_Stock_Price:  99.97320163430163
curr_Factors:  [9.99732016e+01 4.61602147e-02]
mat_Sqrt:  [[ 2.14791708e+01  0.00000000e+00]
 [-8.59397135e-03  1.96912621e-02]]
grads:  [ 0.00988374 -6.37745068]
Stock Position:  0.00988374183712934
Bond Position:  [-2.55399152]


portfolio before change:  [-1.55983006]
curr_Stock_Price:  100.71476880417573
curr_Factors:  [1.00714769e+02 4.67027573e-02]
mat_Sqrt:  [[ 2.17652882e+01  0.00000000e+00]
 [-8.64432830e-03  1.98066444e-02]]
grads:  [0.00236217 1.42373295]
Stock Position:  0.002362168771482084
Bond Position:  [-1.79773534]


portfolio before change:  [-1.55872709]
curr_Stock_Price:  101.5623246199667
curr_Factors:  [1.01562325e+02 5.09167521e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.55872709]
Stock Price:  103.0988669391914
PL:  [-4.65759402]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.00725403e-02 -2.84418861e-01]
 [-3.65610902e-01 -5.65007500e-02]
 [-1.96243448e-01 -2.81407233e-01]
 [-1.57886423e-01  7.53882754e-03]
 [-2.55979919e-01  2.27221009e-02]
 [ 6.82786442e-01  4.74427467e-01]
 [-1.67611917e-01  4.17584914e-01]
 [-4.72217641e-01 -4.91494118e-01]
 [ 2.08902899e-02  1.79965478e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.50755476]
curr_Stock_Price:  100.15164593946702
curr_Factors:  [1.00151646e+02 3.81032429e-02]
mat_Sqrt:  [[ 1.95496533e+01  0.00000000e+00]
 [-7.80802079e-03  1.78904231e-02]]
grads:  [-9.42232093e-03 -1.58978275e+01]
Stock Position:  -0.00942232092906483
Bond Position:  [4.45121571]


portfolio before change:  [3.49110285]
curr_Stock_Price:  102.13396821228265
curr_Factors:  [1.02133968e+02 3.78136367e-02]
mat_Sqrt:  [[ 1.98606944e+01  0.00000000e+00]
 [-7.77829150e-03  1.78223048e-02]]
grads:  [-0.01965036 -3.1702269 ]
Stock Position:  -0.019650362807498597
Bond Position:  [5.49807238]


portfolio before change:  [3.49099794]
curr_Stock_Price:  102.27923967408186
curr_Factors:  [1.02279240e+02 3.82733354e-02]
mat_Sqrt:  [[ 2.00094728e+01  0.00000000e+00]
 [-7.82542885e-03  1.79303100e-02]]
grads:  [ -0.01594543 -15.69449902]
Stock Position:  -0.015945429250467692
Bond Position:  [5.12188432]


portfolio before change:  [3.46086514]
curr_Stock_Price:  104.32963145789287
curr_Factors:  [1.04329631e+02 3.62153392e-02]
mat_Sqrt:  [[ 1.98542713e+01  0.00000000e+00]
 [-7.61213128e-03  1.74415839e-02]]
grads:  [-0.00778655  0.43223297]
Stock Position:  -0.007786546621588005
Bond Position:  [4.27323268]


portfolio before change:  [3.43321138]
curr_Stock_Price:  108.15557837367315
curr_Factors:  [1.08155578e+02 3.52781761e-02]
mat_Sqrt:  [[ 2.03143058e+01  0.00000000e+00]
 [-7.51299419e-03  1.72144323e-02]]
grads:  [-0.0121128   1.31994483]
Stock Position:  -0.012112802839497876
Bond Position:  [4.74327858]


portfolio before change:  [3.40949946]
curr_Stock_Price:  110.30901452774448
curr_Factors:  [1.10309015e+02 3.44669005e-02]
mat_Sqrt:  [[ 2.04791591e+01  0.00000000e+00]
 [-7.42610536e-03  1.70153450e-02]]
grads:  [ 0.04345118 27.88233022]
Stock Position:  0.04345117683793395
Bond Position:  [-1.38355703]


portfolio before change:  [3.53157188]
curr_Stock_Price:  113.13435500519459
curr_Factors:  [1.13134355e+02 3.06302216e-02]
mat_Sqrt:  [[ 1.98001999e+01  0.00000000e+00]
 [-7.00059673e-03  1.60403822e-02]]
grads:  [7.39239027e-04 2.60333518e+01]
Stock Position:  0.0007392390267698334
Bond Position:  [3.44793855]


portfolio before change:  [3.53004186]
curr_Stock_Price:  108.73196484497242
curr_Factors:  [1.08731965e+02 3.07849168e-02]
mat_Sqrt:  [[ 1.90777093e+01  0.00000000e+00]
 [-7.01825241e-03  1.60808364e-02]]
grads:  [ -0.03599611 -30.5639647 ]
Stock Position:  -0.035996106605233995
Bond Position:  [7.44396926]


portfolio before change:  [3.52018207]
curr_Stock_Price:  109.10930316820878
curr_Factors:  [1.09109303e+02 2.95904839e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.52018207]
Stock Price:  111.12471014298141
PL:  [-7.60452808]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.37760159e-02 -4.09501000e-01]
 [-5.26609820e-01 -1.60981867e-01]
 [ 4.47251946e-02 -2.04062737e-02]
 [ 3.28519398e-02  9.66140579e-02]
 [ 7.20736270e-03 -2.86369479e-02]
 [ 7.75383758e-02 -6.25166572e-02]
 [ 1.08817242e-01 -2.91403122e-01]
 [ 5.33997112e-02 -1.21870457e-01]
 [ 7.04564099e-03 -3.83468666e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.94225694]
curr_Stock_Price:  102.82789168305504
curr_Factors:  [1.02827892e+02 3.80523241e-02]
mat_Sqrt:  [[ 2.00586419e+01  0.00000000e+00]
 [-7.80280197e-03  1.78784653e-02]]
grads:  [-1.25879362e-02 -2.29047065e+01]
Stock Position:  -0.012587936212626842
Bond Position:  [23.23664788]


portfolio before change:  [21.94653277]
curr_Stock_Price:  103.41141865313159
curr_Factors:  [1.03411419e+02 3.59558905e-02]
mat_Sqrt:  [[ 1.96089130e+01  0.00000000e+00]
 [-7.58481541e-03  1.73789954e-02]]
grads:  [-0.03043861 -9.26301339]
Stock Position:  -0.03043861052958803
Bond Position:  [25.09423266]


portfolio before change:  [22.02882232]
curr_Stock_Price:  101.12027263153992
curr_Factors:  [1.01120273e+02 3.73452237e-02]
mat_Sqrt:  [[ 1.95414041e+01  0.00000000e+00]
 [-7.72996494e-03  1.77115747e-02]]
grads:  [ 0.00183299 -1.15214339]
Stock Position:  0.0018329883848742852
Bond Position:  [21.84347004]


portfolio before change:  [22.04140248]
curr_Stock_Price:  102.02354896997444
curr_Factors:  [1.02023549e+02 3.94515516e-02]
mat_Sqrt:  [[ 2.02643403e+01  0.00000000e+00]
 [-7.94496586e-03  1.82042037e-02]]
grads:  [3.70195971e-03 5.30723889e+00]
Stock Position:  0.003701959713972516
Bond Position:  [21.66371541]


portfolio before change:  [22.04084749]
curr_Stock_Price:  98.94691899801597
curr_Factors:  [9.89469190e+01 4.36569527e-02]
mat_Sqrt:  [[ 2.06742129e+01  0.00000000e+00]
 [-8.35769851e-03  1.91498930e-02]]
grads:  [-2.55914264e-04 -1.49541033e+00]
Stock Position:  -0.00025591426429018174
Bond Position:  [22.06616942]


portfolio before change:  [22.05238647]
curr_Stock_Price:  96.98086824109579
curr_Factors:  [9.69808682e+01 4.16225276e-02]
mat_Sqrt:  [[ 1.97856487e+01  0.00000000e+00]
 [-8.16063994e-03  1.86983751e-02]]
grads:  [ 2.53991520e-03 -3.34342727e+00]
Stock Position:  0.002539915196442024
Bond Position:  [21.80606329]


portfolio before change:  [22.05777757]
curr_Stock_Price:  94.80966982324125
curr_Factors:  [9.48096698e+01 4.19400822e-02]
mat_Sqrt:  [[ 1.94163357e+01  0.00000000e+00]
 [-8.19171115e-03  1.87695682e-02]]
grads:  [-9.45673147e-04 -1.55252971e+01]
Stock Position:  -0.0009456731468546325
Bond Position:  [22.14743653]


portfolio before change:  [22.06795581]
curr_Stock_Price:  95.75952059067424
curr_Factors:  [9.57595206e+01 4.46521532e-02]
mat_Sqrt:  [[ 2.02349980e+01  0.00000000e+00]
 [-8.45242244e-03  1.93669328e-02]]
grads:  [ 1.04315964e-05 -6.29270818e+00]
Stock Position:  1.0431596414638185e-05
Bond Position:  [22.06695688]


portfolio before change:  [22.07899824]
curr_Stock_Price:  96.35285410885307
curr_Factors:  [9.63528541e+01 4.18237350e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.07899824]
Stock Price:  92.28901524240466
PL:  [22.07899824]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.57567310e-02 -3.36302831e-01]
 [-2.74248349e-01  6.14776922e-04]
 [ 2.39345413e-01  1.55642835e-01]
 [ 2.27291947e-01  1.55445038e-01]
 [ 1.63354135e-01 -1.70435561e-01]
 [ 7.80947776e-02 -7.99607573e-02]
 [ 1.90800349e-01 -2.11137877e-01]
 [ 5.35948522e-02 -1.21358910e-01]
 [ 4.43931720e-02 -7.73236986e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.53466658]
curr_Stock_Price:  101.17180226860751
curr_Factors:  [1.01171802e+02 4.20290868e-02]
mat_Sqrt:  [[ 2.07412279e+01  0.00000000e+00]
 [-8.20039871e-03  1.87894739e-02]]
grads:  [-1.02468051e-02 -1.78984698e+01]
Stock Position:  -0.010246805082404864
Bond Position:  [11.57135432]


portfolio before change:  [10.53768951]
curr_Stock_Price:  101.44156384603136
curr_Factors:  [1.01441564e+02 4.62064565e-02]
mat_Sqrt:  [[ 2.18055612e+01  0.00000000e+00]
 [-8.59827485e-03  1.97011227e-02]]
grads:  [-0.01256469  0.03120517]
Stock Position:  -0.012564686432160516
Bond Position:  [11.81227095]


portfolio before change:  [10.58219547]
curr_Stock_Price:  98.36959307819191
curr_Factors:  [9.83695931e+01 4.72990970e-02]
mat_Sqrt:  [[ 2.13937689e+01  0.00000000e+00]
 [-8.69934222e-03  1.99326971e-02]]
grads:  [0.01436276 7.80841821]
Stock Position:  0.014362757530533909
Bond Position:  [9.16933686]


portfolio before change:  [10.55781104]
curr_Stock_Price:  96.35255357638206
curr_Factors:  [9.63525536e+01 5.07364808e-02]
mat_Sqrt:  [[ 2.17031813e+01  0.00000000e+00]
 [-9.00990396e-03  2.06442834e-02]]
grads:  [0.01359864 7.52968918]
Stock Position:  0.013598638754598096
Bond Position:  [9.24754747]


portfolio before change:  [10.5502407]
curr_Stock_Price:  95.4557530125033
curr_Factors:  [9.54557530e+01 5.60562489e-02]
mat_Sqrt:  [[ 2.26002958e+01  0.00000000e+00]
 [-9.47048036e-03  2.16995966e-02]]
grads:  [ 3.93667225e-03 -7.85431933e+00]
Stock Position:  0.003936672253176243
Bond Position:  [10.17446269]


portfolio before change:  [10.55598699]
curr_Stock_Price:  95.62284403674421
curr_Factors:  [9.56228440e+01 5.45828957e-02]
mat_Sqrt:  [[ 2.23403484e+01  0.00000000e+00]
 [-9.34519305e-03  2.14125273e-02]]
grads:  [ 1.93358856e-03 -3.73429798e+00]
Stock Position:  0.001933588556995675
Bond Position:  [10.37109175]


portfolio before change:  [10.56525136]
curr_Stock_Price:  97.7316343210743
curr_Factors:  [9.77316343e+01 5.56043321e-02]
mat_Sqrt:  [[ 2.30456773e+01  0.00000000e+00]
 [-9.43222833e-03  2.16119502e-02]]
grads:  [ 4.28072579e-03 -9.76949678e+00]
Stock Position:  0.00428072579294249
Bond Position:  [10.14688904]


portfolio before change:  [10.56602587]
curr_Stock_Price:  96.72708368522893
curr_Factors:  [9.67270837e+01 5.68363924e-02]
mat_Sqrt:  [[ 2.30601085e+01  0.00000000e+00]
 [-9.53615373e-03  2.18500731e-02]]
grads:  [ 2.72974357e-05 -5.55416491e+00]
Stock Position:  2.729743573750812e-05
Bond Position:  [10.56338547]


portfolio before change:  [10.57137541]
curr_Stock_Price:  99.16428082685063
curr_Factors:  [9.91642808e+01 5.38841912e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.57137541]
Stock Price:  96.74879355668148
PL:  [10.57137541]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-3.51609071e-02 -2.00017929e-01]
 [-3.17107931e-02  8.13733746e-03]
 [ 2.48115162e-01  1.58629757e-01]
 [ 2.27058190e-01  1.55357115e-01]
 [ 9.20309469e-03 -2.82530083e-02]
 [ 7.67696032e-02 -3.37451985e-02]
 [ 2.27186881e-01 -1.69374386e-01]
 [ 5.18582585e-02 -1.25911254e-01]
 [ 3.43362356e-03 -3.30147090e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.03526656]
curr_Stock_Price:  98.47592445871847
curr_Factors:  [9.84759245e+01 4.18810123e-02]
mat_Sqrt:  [[ 2.01529511e+01  0.00000000e+00]
 [-8.18594037e-03  1.87563457e-02]]
grads:  [-6.07632536e-03 -1.06640138e+01]
Stock Position:  -0.0060763253608915125
Bond Position:  [-7.4368948]


portfolio before change:  [-8.03880873]
curr_Stock_Price:  98.44676092997285
curr_Factors:  [9.84467609e+01 4.14709533e-02]
mat_Sqrt:  [[ 2.00481102e+01  0.00000000e+00]
 [-8.14576733e-03  1.86642977e-02]]
grads:  [-0.00140459  0.43598412]
Stock Position:  -0.0014045896371853762
Bond Position:  [-7.90053143]


portfolio before change:  [-8.04140123]
curr_Stock_Price:  97.47939713299874
curr_Factors:  [9.74793971e+01 4.11202571e-02]
mat_Sqrt:  [[ 1.97669992e+01  0.00000000e+00]
 [-8.11125215e-03  1.85852135e-02]]
grads:  [0.01605438 8.53526686]
Stock Position:  0.016054377294228196
Bond Position:  [-9.60637225]


portfolio before change:  [-8.06432666]
curr_Stock_Price:  96.35066803953909
curr_Factors:  [9.63506680e+01 3.96659599e-02]
mat_Sqrt:  [[ 1.91895024e+01  0.00000000e+00]
 [-7.96652596e-03  1.82536041e-02]]
grads:  [0.01536578 8.5110378 ]
Stock Position:  0.015365775870715739
Bond Position:  [-9.54482943]


portfolio before change:  [-8.02858977]
curr_Stock_Price:  98.98707920151146
curr_Factors:  [9.89870792e+01 3.86217478e-02]
mat_Sqrt:  [[ 1.94533532e+01  0.00000000e+00]
 [-7.86096664e-03  1.80117373e-02]]
grads:  [-1.60770691e-04 -1.56858874e+00]
Stock Position:  -0.0001607706909018926
Bond Position:  [-8.01267555]


portfolio before change:  [-8.03264852]
curr_Stock_Price:  99.30687518962874
curr_Factors:  [9.93068752e+01 3.59465763e-02]
mat_Sqrt:  [[ 1.88281688e+01  0.00000000e+00]
 [-7.58383294e-03  1.73767443e-02]]
grads:  [ 0.00329517 -1.94197475]
Stock Position:  0.00329516863125306
Bond Position:  [-8.35988142]


portfolio before change:  [-8.0386165]
curr_Stock_Price:  98.76456873983174
curr_Factors:  [9.87645687e+01 3.50874469e-02]
mat_Sqrt:  [[ 1.85002269e+01  0.00000000e+00]
 [-7.49265741e-03  1.71678349e-02]]
grads:  [ 8.28453831e-03 -9.86579773e+00]
Stock Position:  0.008284538305183147
Bond Position:  [-8.85683535]


portfolio before change:  [-8.05315769]
curr_Stock_Price:  97.54402230346493
curr_Factors:  [9.75440223e+01 3.75260088e-02]
mat_Sqrt:  [[ 1.88958681e+01  0.00000000e+00]
 [-7.74865241e-03  1.77543931e-02]]
grads:  [-1.63735150e-04 -7.09183655e+00]
Stock Position:  -0.00016373514967293413
Bond Position:  [-8.0371863]


portfolio before change:  [-8.05692943]
curr_Stock_Price:  96.03029480834815
curr_Factors:  [9.60302948e+01 3.73393907e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.05692943]
Stock Price:  97.221587167631
PL:  [-8.05692943]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-8.24172746e-02 -4.88376400e-01]
 [-5.49638814e-01 -1.75763207e-01]
 [-2.40480025e-01 -2.90448444e-01]
 [ 1.15729362e-01  1.38510089e-01]
 [ 4.67146910e-02 -2.10365151e-02]
 [ 8.65874890e-02 -1.42678673e-01]
 [ 2.11829028e-01 -7.55174250e-02]
 [-5.39890728e-03  5.95117050e-03]
 [ 5.12928634e-02 -7.95926691e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.23663341]
curr_Stock_Price:  104.6127196884835
curr_Factors:  [1.04612720e+02 3.88016362e-02]
mat_Sqrt:  [[ 2.06067505e+01  0.00000000e+00]
 [-7.87925237e-03  1.80536352e-02]]
grads:  [-1.43429800e-02 -2.70514162e+01]
Stock Position:  -0.014342980004393364
Bond Position:  [35.73709156]


portfolio before change:  [34.26915976]
curr_Stock_Price:  103.5910820532304
curr_Factors:  [1.03591082e+02 3.81725318e-02]
mat_Sqrt:  [[ 2.02394102e+01  0.00000000e+00]
 [-7.81511682e-03  1.79066822e-02]]
grads:  [-0.03094696 -9.81550937]
Stock Position:  -0.030946957446455467
Bond Position:  [37.47498856]


portfolio before change:  [34.28307106]
curr_Stock_Price:  103.74718394751328
curr_Factors:  [1.03747184e+02 3.73277722e-02]
mat_Sqrt:  [[ 2.00443673e+01  0.00000000e+00]
 [-7.72815861e-03  1.77074359e-02]]
grads:  [ -0.01832146 -16.40262573]
Stock Position:  -0.018321462186526753
Bond Position:  [36.18387116]


portfolio before change:  [34.3529821]
curr_Stock_Price:  100.91910247901558
curr_Factors:  [1.00919102e+02 4.09032933e-02]
mat_Sqrt:  [[ 2.04104471e+01  0.00000000e+00]
 [-8.08982505e-03  1.85361178e-02]]
grads:  [0.00863186 7.47244326]
Stock Position:  0.008631859940153903
Bond Position:  [33.48186255]


portfolio before change:  [34.36459841]
curr_Stock_Price:  100.32492995601216
curr_Factors:  [1.0032493e+02 4.1478298e-02]
mat_Sqrt:  [[ 2.04323975e+01  0.00000000e+00]
 [-8.14648862e-03  1.86659504e-02]]
grads:  [ 0.00183697 -1.12699941]
Stock Position:  0.0018369651991363475
Bond Position:  [34.180305]


portfolio before change:  [34.38286011]
curr_Stock_Price:  100.96037043667499
curr_Factors:  [1.00960370e+02 4.06891658e-02]
mat_Sqrt:  [[ 2.03652773e+01  0.00000000e+00]
 [-8.06862227e-03  1.84875361e-02]]
grads:  [ 1.19406236e-03 -7.71756018e+00]
Stock Position:  0.0011940623603195438
Bond Position:  [34.26230714]


portfolio before change:  [34.40115776]
curr_Stock_Price:  101.93369007390537
curr_Factors:  [1.01933690e+02 4.05045357e-02]
mat_Sqrt:  [[ 2.05149081e+01  0.00000000e+00]
 [-8.05029547e-03  1.84455442e-02]]
grads:  [ 0.00871905 -4.09407412]
Stock Position:  0.008719050612578239
Bond Position:  [33.51239275]


portfolio before change:  [34.41364872]
curr_Stock_Price:  101.44402407897272
curr_Factors:  [1.01444024e+02 4.36330105e-02]
mat_Sqrt:  [[ 2.11901513e+01  0.00000000e+00]
 [-8.35540644e-03  1.91446412e-02]]
grads:  [-1.32212531e-04  3.10853070e-01]
Stock Position:  -0.00013221253119686665
Bond Position:  [34.42706089]


portfolio before change:  [34.43100636]
curr_Stock_Price:  100.3865942312676
curr_Factors:  [1.00386594e+02 4.57080945e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.43100636]
Stock Price:  99.48283305401031
PL:  [34.43100636]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 9.29931294e-02 -2.84228384e-01]
 [ 3.66481649e-02 -7.75560161e-01]
 [ 2.66275179e-01  1.64814944e-01]
 [ 1.81594205e-01  1.38256688e-01]
 [ 4.14454917e-01 -2.78093184e-01]
 [ 7.88784441e-02 -1.04529974e-01]
 [ 7.63340814e-02 -3.18285297e-01]
 [ 5.64932480e-02 -1.13760992e-01]
 [ 3.85587813e-02  1.09062684e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.64092754]
curr_Stock_Price:  96.35555724823472
curr_Factors:  [9.63555572e+01 4.45721133e-02]
mat_Sqrt:  [[ 2.03426900e+01  0.00000000e+00]
 [-8.44484348e-03  1.93495672e-02]]
grads:  [-1.52655854e-03 -1.46891339e+01]
Stock Position:  -0.001526558536358402
Bond Position:  [-22.49383514]


portfolio before change:  [-22.65017687]
curr_Stock_Price:  95.0451593719739
curr_Factors:  [9.50451594e+01 4.78862848e-02]
mat_Sqrt:  [[ 2.07986705e+01  0.00000000e+00]
 [-8.75317403e-03  2.00560413e-02]]
grads:  [-1.45121795e-02 -3.86696532e+01]
Stock Position:  -0.014512179471067541
Bond Position:  [-21.27086446]


portfolio before change:  [-22.6697011]
curr_Stock_Price:  95.657482470056
curr_Factors:  [9.56574825e+01 4.60806484e-02]
mat_Sqrt:  [[ 2.05342213e+01  0.00000000e+00]
 [-8.58656144e-03  1.96742839e-02]]
grads:  [0.01647037 8.37717627]
Stock Position:  0.016470374679695234
Bond Position:  [-24.24521568]


portfolio before change:  [-22.72003923]
curr_Stock_Price:  93.33740872911956
curr_Factors:  [9.33374087e+01 4.65230852e-02]
mat_Sqrt:  [[ 2.01321424e+01  0.00000000e+00]
 [-8.62768430e-03  1.97685082e-02]]
grads:  [0.01201732 6.99378461]
Stock Position:  0.012017318683675718
Bond Position:  [-23.84170461]


portfolio before change:  [-22.74390965]
curr_Stock_Price:  92.34329444709788
curr_Factors:  [9.23432944e+01 4.63226479e-02]
mat_Sqrt:  [[ 1.98747673e+01  0.00000000e+00]
 [-8.60907873e-03  1.97258775e-02]]
grads:  [  0.01474659 -14.09788659]
Stock Position:  0.014746592830959119
Bond Position:  [-24.10565861]


portfolio before change:  [-22.73618606]
curr_Stock_Price:  93.68458272057482
curr_Factors:  [9.36845827e+01 4.28875958e-02]
mat_Sqrt:  [[ 1.94014406e+01  0.00000000e+00]
 [-8.28372822e-03  1.89804058e-02]]
grads:  [ 1.71419351e-03 -5.50725704e+00]
Stock Position:  0.00171419351046611
Bond Position:  [-22.89677956]


portfolio before change:  [-22.74815912]
curr_Stock_Price:  93.38017510772126
curr_Factors:  [9.33801751e+01 4.09221225e-02]
mat_Sqrt:  [[ 1.88900784e+01  0.00000000e+00]
 [-8.09168684e-03  1.85403837e-02]]
grads:  [-3.31269195e-03 -1.71671364e+01]
Stock Position:  -0.0033126919528476658
Bond Position:  [-22.43881937]


portfolio before change:  [-22.74952908]
curr_Stock_Price:  90.40607952567544
curr_Factors:  [9.04060795e+01 4.22013540e-02]
mat_Sqrt:  [[ 1.85720921e+01  0.00000000e+00]
 [-8.21718725e-03  1.88279413e-02]]
grads:  [ 3.68503488e-04 -6.04213654e+00]
Stock Position:  0.0003685034875897507
Bond Position:  [-22.78284403]


portfolio before change:  [-22.76128674]
curr_Stock_Price:  89.41994468063388
curr_Factors:  [8.94199447e+01 4.36319550e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.76128674]
Stock Price:  90.11282189255952
PL:  [-22.76128674]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.99506391e-02 -2.83306175e-01]
 [-3.89246039e-01 -7.16596539e-02]
 [-2.55035082e-01 -2.74108089e-01]
 [-1.12967177e-02  6.93219930e-02]
 [-9.18448528e-02 -6.03228491e-03]
 [ 8.78249755e-02 -1.51258580e-01]
 [ 1.86834325e-01 -2.42155025e-02]
 [ 4.36751254e-02  3.07062761e-02]
 [ 3.94226827e-02 -5.14111946e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.42072466]
curr_Stock_Price:  100.13904043695034
curr_Factors:  [1.00139040e+02 4.10488814e-02]
mat_Sqrt:  [[ 2.02886939e+01  0.00000000e+00]
 [-8.10420941e-03  1.85690765e-02]]
grads:  [-9.04915773e-03 -1.52568801e+01]
Stock Position:  -0.009049157725445142
Bond Position:  [4.32689863]


portfolio before change:  [3.40316959]
curr_Stock_Price:  102.31814526855925
curr_Factors:  [1.02318145e+02 4.02631855e-02]
mat_Sqrt:  [[ 2.05308403e+01  0.00000000e+00]
 [-8.02627540e-03  1.83905073e-02]]
grads:  [-0.0204824  -3.89655667]
Stock Position:  -0.020482399629234406
Bond Position:  [5.49889073]


portfolio before change:  [3.37265471]
curr_Stock_Price:  103.94222319581381
curr_Factors:  [1.03942223e+02 3.74595926e-02]
mat_Sqrt:  [[ 2.01174776e+01  0.00000000e+00]
 [-7.74179231e-03  1.77386746e-02]]
grads:  [ -0.01862389 -15.45256876]
Stock Position:  -0.01862388852644495
Bond Position:  [5.30846309]


portfolio before change:  [3.39847759]
curr_Stock_Price:  102.69823011298345
curr_Factors:  [1.02698230e+02 3.94613551e-02]
mat_Sqrt:  [[ 2.04008826e+01  0.00000000e+00]
 [-7.94595295e-03  1.82064654e-02]]
grads:  [9.29267659e-04 3.80754811e+00]
Stock Position:  0.0009292676591961639
Bond Position:  [3.30304345]


portfolio before change:  [3.40149023]
curr_Stock_Price:  104.16250118888885
curr_Factors:  [1.04162501e+02 4.13542354e-02]
mat_Sqrt:  [[ 2.11822163e+01  0.00000000e+00]
 [-8.13429632e-03  1.86380143e-02]]
grads:  [-0.00446023 -0.32365491]
Stock Position:  -0.00446023006256532
Bond Position:  [3.86607895]


portfolio before change:  [3.40992306]
curr_Stock_Price:  102.7053327370574
curr_Factors:  [1.02705333e+02 4.28288280e-02]
mat_Sqrt:  [[ 2.12549990e+01  0.00000000e+00]
 [-8.27805078e-03  1.89673972e-02]]
grads:  [ 1.02612656e-03 -7.97466193e+00]
Stock Position:  0.0010261265617958408
Bond Position:  [3.30453439]


portfolio before change:  [3.41159577]
curr_Stock_Price:  102.72485214504853
curr_Factors:  [1.02724852e+02 4.40186458e-02]
mat_Sqrt:  [[ 2.15523119e+01  0.00000000e+00]
 [-8.39224841e-03  1.92290568e-02]]
grads:  [ 0.00817851 -1.25931827]
Stock Position:  0.00817851069197329
Bond Position:  [2.57145946]


portfolio before change:  [3.39584997]
curr_Stock_Price:  100.64233995942533
curr_Factors:  [1.00642340e+02 4.52978893e-02]
mat_Sqrt:  [[ 2.14200119e+01  0.00000000e+00]
 [-8.51332032e-03  1.95064674e-02]]
grads:  [0.00266463 1.57415874]
Stock Position:  0.002664631707618622
Bond Position:  [3.1276752]


portfolio before change:  [3.40393276]
curr_Stock_Price:  103.0886658691915
curr_Factors:  [1.03088666e+02 4.58027650e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.40393276]
Stock Price:  101.5706917774243
PL:  [1.83324098]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.87440756e-02 -2.72292943e-01]
 [-4.88276495e-01 -1.36037866e-01]
 [-3.94204860e-01 -1.17867998e-01]
 [-8.99347676e-01 -3.01297444e-01]
 [-3.39441096e-01  5.00874096e-02]
 [ 4.31692014e-01  1.97185532e-01]
 [ 1.27361585e-01  1.89513070e-01]
 [-5.80026310e-01 -5.87279318e-01]
 [ 2.47181206e-02  1.21769783e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.63491397]
curr_Stock_Price:  100.0249608874296
curr_Factors:  [1.00024961e+02 3.96638480e-02]
mat_Sqrt:  [[ 1.99207559e+01  0.00000000e+00]
 [-7.96631388e-03  1.82531182e-02]]
grads:  [-8.91444382e-03 -1.49176125e+01]
Stock Position:  -0.008914443817673395
Bond Position:  [3.52658086]


portfolio before change:  [2.60921195]
curr_Stock_Price:  103.10599997587997
curr_Factors:  [1.03106000e+02 3.74215867e-02]
mat_Sqrt:  [[ 1.99455050e+01  0.00000000e+00]
 [-7.73786397e-03  1.77296737e-02]]
grads:  [-0.02745723 -7.67289168]
Stock Position:  -0.027457228385134452
Bond Position:  [5.44021694]


portfolio before change:  [2.53778327]
curr_Stock_Price:  105.80654475983388
curr_Factors:  [1.05806545e+02 3.79266336e-02]
mat_Sqrt:  [[ 2.06055723e+01  0.00000000e+00]
 [-7.78990460e-03  1.78489138e-02]]
grads:  [-0.02162748 -6.60365106]
Stock Position:  -0.021627483380642108
Bond Position:  [4.82611255]


portfolio before change:  [2.4075194]
curr_Stock_Price:  111.94121705226874
curr_Factors:  [1.11941217e+02 3.60885838e-02]
mat_Sqrt:  [[ 2.1265468e+01  0.0000000e+00]
 [-7.5987982e-03  1.7411034e-02]]
grads:  [ -0.04847505 -17.30497134]
Stock Position:  -0.0484750518172782
Bond Position:  [7.8338757]


portfolio before change:  [2.42087745]
curr_Stock_Price:  111.74647509883123
curr_Factors:  [1.11746475e+02 3.99060072e-02]
mat_Sqrt:  [[ 2.23230212e+01  0.00000000e+00]
 [-7.99059519e-03  1.83087537e-02]]
grads:  [-0.01422662  2.73570832]
Stock Position:  -0.014226620852075097
Bond Position:  [4.01065218]


portfolio before change:  [2.47970665]
curr_Stock_Price:  107.75231672658963
curr_Factors:  [1.07752317e+02 4.03614527e-02]
mat_Sqrt:  [[ 2.16476128e+01  0.00000000e+00]
 [-8.03606398e-03  1.84129357e-02]]
grads:  [ 0.02391723 10.70907623]
Stock Position:  0.023917225467173876
Bond Position:  [-0.0974298]


portfolio before change:  [2.50683766]
curr_Stock_Price:  108.88872514066706
curr_Factors:  [1.08888725e+02 4.00587143e-02]
mat_Sqrt:  [[ 2.17937225e+01  0.00000000e+00]
 [-8.00586928e-03  1.83437510e-02]]
grads:  [9.63909997e-03 1.03312060e+01]
Stock Position:  0.009639099966601556
Bond Position:  [1.45724835]


portfolio before change:  [2.52609496]
curr_Stock_Price:  110.81094776676694
curr_Factors:  [1.10810948e+02 3.91788958e-02]
mat_Sqrt:  [[ 2.19335417e+01  0.00000000e+00]
 [-7.91746382e-03  1.81411886e-02]]
grads:  [ -0.03813046 -32.37270337]
Stock Position:  -0.0381304591482524
Bond Position:  [6.75136728]


portfolio before change:  [2.34824131]
curr_Stock_Price:  115.56384570887454
curr_Factors:  [1.15563846e+02 3.64420993e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.34824131]
Stock Price:  118.16195155760178
PL:  [-15.81371025]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.76319758e-02 -2.62141955e-01]
 [-2.67032491e-01  4.20349535e-03]
 [-3.28672298e-01 -1.91438666e-01]
 [-3.38934188e-01 -6.05080499e-02]
 [-2.72298195e-01  2.83458027e-02]
 [ 3.24513221e-01  7.85438302e-02]
 [ 1.39377394e-01  1.42297430e-01]
 [-3.16393182e-01 -3.47182176e-01]
 [ 2.75978310e-02 -1.99227556e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.92998062]
curr_Stock_Price:  99.92262265204063
curr_Factors:  [9.99226227e+01 4.12284732e-02]
mat_Sqrt:  [[ 2.02890845e+01  0.00000000e+00]
 [-8.12191832e-03  1.86096527e-02]]
grads:  [-8.47944148e-03 -1.40863432e+01]
Stock Position:  -0.008479441483207985
Bond Position:  [2.77726865]


portfolio before change:  [1.91882293]
curr_Stock_Price:  101.40227940583686
curr_Factors:  [1.01402279e+02 4.20525974e-02]
mat_Sqrt:  [[ 2.07942916e+01  0.00000000e+00]
 [-8.20269199e-03  1.87947285e-02]]
grads:  [-0.0127534   0.22365289]
Stock Position:  -0.012753400810161178
Bond Position:  [3.21204685]


portfolio before change:  [1.87544214]
curr_Stock_Price:  104.92974809902792
curr_Factors:  [1.04929748e+02 4.17809434e-02]
mat_Sqrt:  [[ 2.14480469e+01  0.00000000e+00]
 [-8.17615493e-03  1.87339244e-02]]
grads:  [ -0.0192196  -10.21882344]
Stock Position:  -0.01921960458754374
Bond Position:  [3.89215041]


portfolio before change:  [1.85253626]
curr_Stock_Price:  106.22282540408817
curr_Factors:  [1.06222825e+02 3.85140412e-02]
mat_Sqrt:  [[ 2.08462237e+01  0.00000000e+00]
 [-7.84999783e-03  1.79866046e-02]]
grads:  [-0.01752558 -3.36406182]
Stock Position:  -0.017525575426197728
Bond Position:  [3.7141524]


portfolio before change:  [1.81202888]
curr_Stock_Price:  108.6401452719676
curr_Factors:  [1.08640145e+02 3.82891808e-02]
mat_Sqrt:  [[ 2.12582923e+01  0.00000000e+00]
 [-7.82704857e-03  1.79340213e-02]]
grads:  [-0.01222709  1.58056034]
Stock Position:  -0.012227090910394221
Bond Position:  [3.14038182]


portfolio before change:  [1.83793144]
curr_Stock_Price:  106.65013981127106
curr_Factors:  [1.06650140e+02 3.65205656e-02]
mat_Sqrt:  [[ 2.03812200e+01  0.00000000e+00]
 [-7.64414187e-03  1.75149294e-02]]
grads:  [0.01760408 4.4843932 ]
Stock Position:  0.01760407667178149
Bond Position:  [-0.03954579]


portfolio before change:  [1.84109572]
curr_Stock_Price:  106.8310100401605
curr_Factors:  [1.06831010e+02 3.57136563e-02]
mat_Sqrt:  [[ 2.01889853e+01  0.00000000e+00]
 [-7.55922284e-03  1.73203554e-02]]
grads:  [0.00997975 8.21561834]
Stock Position:  0.009979752856986216
Bond Position:  [0.77494864]


portfolio before change:  [1.83070815]
curr_Stock_Price:  105.75130997295
curr_Factors:  [1.0575131e+02 3.7929553e-02]
mat_Sqrt:  [[ 2.05956081e+01  0.00000000e+00]
 [-7.79020442e-03  1.78496007e-02]]
grads:  [ -0.02271921 -19.45041695]
Stock Position:  -0.022719208136104736
Bond Position:  [4.23329417]


portfolio before change:  [1.82675165]
curr_Stock_Price:  106.01864654837195
curr_Factors:  [1.06018647e+02 3.73045045e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.82675165]
Stock Price:  107.93097053783417
PL:  [-6.10421889]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.36204888e-02 -2.25526034e-01]
 [-1.23059535e-02 -2.14328374e-01]
 [ 2.46733081e-01  1.58159028e-01]
 [ 2.26941079e-01  1.55313066e-01]
 [ 1.54355109e-01 -1.62687288e-01]
 [ 7.99020858e-02 -1.36622804e-01]
 [ 2.64565881e-02 -3.59763245e-01]
 [ 5.70463638e-02 -1.12311042e-01]
 [ 5.68055006e-03  4.14052087e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.65834575]
curr_Stock_Price:  99.54686407701647
curr_Factors:  [9.95468641e+01 4.51921422e-02]
mat_Sqrt:  [[ 2.11621139e+01  0.00000000e+00]
 [-8.50337742e-03  1.94836853e-02]]
grads:  [-7.18492114e-03 -1.15751220e+01]
Stock Position:  -0.007184921139586671
Bond Position:  [0.05689062]


portfolio before change:  [-0.64342777]
curr_Stock_Price:  97.47453394245088
curr_Factors:  [9.74745339e+01 4.55143509e-02]
mat_Sqrt:  [[ 2.07953074e+01  0.00000000e+00]
 [-8.53363705e-03  1.95530189e-02]]
grads:  [-5.08992355e-03 -1.09613955e+01]
Stock Position:  -0.005089923550130872
Bond Position:  [-0.14728984]


portfolio before change:  [-0.64424067]
curr_Stock_Price:  97.61976865299023
curr_Factors:  [9.76197687e+01 4.21600343e-02]
mat_Sqrt:  [[ 2.00441780e+01  0.00000000e+00]
 [-8.21316351e-03  1.88187217e-02]]
grads:  [0.01575317 8.40434491]
Stock Position:  0.01575316977035458
Bond Position:  [-2.18206146]


portfolio before change:  [-0.66552023]
curr_Stock_Price:  96.33823253505783
curr_Factors:  [9.63382325e+01 4.03481396e-02]
mat_Sqrt:  [[ 1.93513127e+01  0.00000000e+00]
 [-8.03473854e-03  1.84098988e-02]]
grads:  [0.01523025 8.43638889]
Stock Position:  0.015230246229407034
Bond Position:  [-2.13277523]


portfolio before change:  [-0.67742026]
curr_Stock_Price:  95.62692544856986
curr_Factors:  [9.56269254e+01 4.09399837e-02]
mat_Sqrt:  [[ 1.93487996e+01  0.00000000e+00]
 [-8.09345254e-03  1.85444294e-02]]
grads:  [ 4.30789287e-03 -8.77283869e+00]
Stock Position:  0.004307892872727633
Bond Position:  [-1.08937081]


portfolio before change:  [-0.69718365]
curr_Stock_Price:  91.16568022163128
curr_Factors:  [9.11656802e+01 4.27289353e-02]
mat_Sqrt:  [[ 1.88448382e+01  0.00000000e+00]
 [-8.26839140e-03  1.89452647e-02]]
grads:  [ 1.07589175e-03 -7.21144864e+00]
Stock Position:  0.0010758917498151458
Bond Position:  [-0.79526805]


portfolio before change:  [-0.69755806]
curr_Stock_Price:  91.18735969601128
curr_Factors:  [9.11873597e+01 4.29886442e-02]
mat_Sqrt:  [[ 1.89065164e+01  0.00000000e+00]
 [-8.29348122e-03  1.90027527e-02]]
grads:  [-6.90539504e-03 -1.89321647e+01]
Stock Position:  -0.00690539503548309
Bond Position:  [-0.06787332]


portfolio before change:  [-0.68792299]
curr_Stock_Price:  89.7871487192415
curr_Factors:  [8.97871487e+01 4.49606875e-02]
mat_Sqrt:  [[ 1.90384090e+01  0.00000000e+00]
 [-8.48157415e-03  1.94337278e-02]]
grads:  [ 4.21768774e-04 -5.77918162e+00]
Stock Position:  0.0004217687740400874
Bond Position:  [-0.72579241]


portfolio before change:  [-0.68636061]
curr_Stock_Price:  94.35214046293157
curr_Factors:  [9.43521405e+01 4.04907803e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.68636061]
Stock Price:  97.25355963043599
PL:  [-0.68636061]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.46333772e-02 -3.26049120e-01]
 [-2.32966963e-01  2.22029340e-02]
 [ 5.99715294e-02 -3.89247355e-03]
 [ 4.98667170e-02  1.07132348e-01]
 [-6.90981469e-02 -3.84649835e-03]
 [ 3.61818700e-01  1.19727717e-01]
 [ 7.38553029e-03  2.86193961e-01]
 [-4.95620666e-01 -5.11456460e-01]
 [ 2.51429894e-02 -6.12740854e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.9356615]
curr_Stock_Price:  100.93966775887174
curr_Factors:  [1.00939668e+02 4.00583945e-02]
mat_Sqrt:  [[ 2.02026640e+01  0.00000000e+00]
 [-8.00583733e-03  1.83436778e-02]]
grads:  [-1.02428511e-02 -1.77744683e+01]
Stock Position:  -0.010242851111195973
Bond Position:  [9.96957149]


portfolio before change:  [8.9380167]
curr_Stock_Price:  101.19651329223797
curr_Factors:  [1.01196513e+02 4.09925764e-02]
mat_Sqrt:  [[ 2.04888771e+01  0.00000000e+00]
 [-8.09864941e-03  1.85563370e-02]]
grads:  [-0.01089746  1.19651492]
Stock Position:  -0.010897464370059501
Bond Position:  [10.0408021]


portfolio before change:  [8.94466506]
curr_Stock_Price:  101.04724008501078
curr_Factors:  [1.01047240e+02 3.93808326e-02]
mat_Sqrt:  [[ 2.00524251e+01  0.00000000e+00]
 [-7.93784178e-03  1.81878804e-02]]
grads:  [ 0.00290602 -0.21401469]
Stock Position:  0.002906018315845021
Bond Position:  [8.65101993]


portfolio before change:  [8.95107167]
curr_Stock_Price:  101.76300482438698
curr_Factors:  [1.01763005e+02 3.67938849e-02]
mat_Sqrt:  [[ 1.95199070e+01  0.00000000e+00]
 [-7.67269287e-03  1.75803479e-02]]
grads:  [4.94997783e-03 6.09386964e+00]
Stock Position:  0.004949977833508017
Bond Position:  [8.44734705]


portfolio before change:  [8.96440528]
curr_Stock_Price:  103.60318990316452
curr_Factors:  [1.03603190e+02 3.70817564e-02]
mat_Sqrt:  [[ 1.99504766e+01  0.00000000e+00]
 [-7.70264956e-03  1.76489873e-02]]
grads:  [-0.00354763 -0.21794442]
Stock Position:  -0.0035476293473749817
Bond Position:  [9.33195099]


portfolio before change:  [8.95691621]
curr_Stock_Price:  107.02976330523637
curr_Factors:  [1.07029763e+02 3.55107702e-02]
mat_Sqrt:  [[ 2.01690114e+01  0.00000000e+00]
 [-7.53772063e-03  1.72710877e-02]]
grads:  [0.02053012 6.93226272]
Stock Position:  0.020530116821549343
Bond Position:  [6.75958266]


portfolio before change:  [9.03514942]
curr_Stock_Price:  110.67575220298681
curr_Factors:  [1.10675752e+02 3.40709824e-02]
mat_Sqrt:  [[ 2.04288919e+01  0.00000000e+00]
 [-7.38333068e-03  1.69173358e-02]]
grads:  [6.47567258e-03 1.69172004e+01]
Stock Position:  0.00647567257898061
Bond Position:  [8.31844949]


portfolio before change:  [9.0296671]
curr_Stock_Price:  109.1867048757539
curr_Factors:  [1.09186705e+02 3.53367746e-02]
mat_Sqrt:  [[ 2.05250022e+01  0.00000000e+00]
 [-7.51923130e-03  1.72287233e-02]]
grads:  [ -0.03502258 -29.68626582]
Stock Position:  -0.03502258160163141
Bond Position:  [12.85366739]


portfolio before change:  [9.10755376]
curr_Stock_Price:  107.14635805376301
curr_Factors:  [1.07146358e+02 3.84897667e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.10755376]
Stock Price:  106.7400553097738
PL:  [2.36749845]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.40152185e-02 -3.20406710e-01]
 [-9.20904507e-04  8.15853050e-02]
 [ 2.37790236e-01  1.55113152e-01]
 [ 1.93765463e-01  1.62945710e-01]
 [ 2.82147041e-03 -3.23754666e-03]
 [ 8.81090603e-02 -1.56406677e-01]
 [ 1.85224025e-01 -1.98786533e-02]
 [ 1.15101789e-02  1.39380281e-02]
 [ 2.37531497e-02 -6.01401752e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.05633368]
curr_Stock_Price:  100.81201192201898
curr_Factors:  [1.00812012e+02 4.04027547e-02]
mat_Sqrt:  [[ 2.02636544e+01  0.00000000e+00]
 [-8.04017460e-03  1.84223543e-02]]
grads:  [-1.00599905e-02 -1.73922781e+01]
Stock Position:  -0.010059990504980928
Bond Position:  [9.07050156]


portfolio before change:  [8.07441974]
curr_Stock_Price:  99.4651246841523
curr_Factors:  [9.94651247e+01 4.07239705e-02]
mat_Sqrt:  [[ 2.00722422e+01  0.00000000e+00]
 [-8.07207240e-03  1.84954414e-02]]
grads:  [1.72805018e-03 4.41110343e+00]
Stock Position:  0.0017280501801983953
Bond Position:  [7.90253901]


portfolio before change:  [8.07673675]
curr_Stock_Price:  98.51882811642703
curr_Factors:  [9.85188281e+01 4.12585135e-02]
mat_Sqrt:  [[ 2.00113333e+01  0.00000000e+00]
 [-8.12487672e-03  1.86164313e-02]]
grads:  [0.01526571 8.3320562 ]
Stock Position:  0.015265707717078938
Bond Position:  [6.57277711]


portfolio before change:  [8.09362676]
curr_Stock_Price:  99.40989726938743
curr_Factors:  [9.94098973e+01 3.76307917e-02]
mat_Sqrt:  [[ 1.92841856e+01  0.00000000e+00]
 [-7.75946305e-03  1.77791634e-02]]
grads:  [0.01373565 9.16498189]
Stock Position:  0.01373564882874163
Bond Position:  [6.72816732]


portfolio before change:  [8.13104421]
curr_Stock_Price:  101.88903253415016
curr_Factors:  [1.01889033e+02 3.79989007e-02]
mat_Sqrt:  [[ 1.98615416e+01  0.00000000e+00]
 [-7.79732268e-03  1.78659107e-02]]
grads:  [ 7.09154018e-05 -1.81213637e-01]
Stock Position:  7.091540179254214e-05
Bond Position:  [8.12381871]


portfolio before change:  [8.13513273]
curr_Stock_Price:  102.24985025893214
curr_Factors:  [1.02249850e+02 3.89294677e-02]
mat_Sqrt:  [[ 2.01744597e+01  0.00000000e+00]
 [-7.89222074e-03  1.80833495e-02]]
grads:  [ 9.83797850e-04 -8.64920944e+00]
Stock Position:  0.000983797849546748
Bond Position:  [8.03453954]


portfolio before change:  [8.13968886]
curr_Stock_Price:  102.79656568839673
curr_Factors:  [1.02796566e+02 3.71285812e-02]
mat_Sqrt:  [[ 1.98076422e+01  0.00000000e+00]
 [-7.70751127e-03  1.76601269e-02]]
grads:  [ 0.00891314 -1.12562347]
Stock Position:  0.008913139033477848
Bond Position:  [7.22344878]


portfolio before change:  [8.1288098]
curr_Stock_Price:  101.17068685201356
curr_Factors:  [1.01170687e+02 3.74188516e-02]
mat_Sqrt:  [[ 1.95704101e+01  0.00000000e+00]
 [-7.73758118e-03  1.77290257e-02]]
grads:  [0.00089897 0.78617   ]
Stock Position:  0.0008989711012292919
Bond Position:  [8.03786028]


portfolio before change:  [8.12988179]
curr_Stock_Price:  97.89144067640896
curr_Factors:  [9.78914407e+01 3.83528819e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.12988179]
Stock Price:  98.2036833800287
PL:  [8.12988179]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.59135325e-02 -2.79576356e-01]
 [-7.40064352e-03 -2.70565030e-01]
 [ 2.10364892e-01  1.59003460e-01]
 [ 5.86453943e-02  1.12559200e-01]
 [-1.61776073e-02 -3.32619787e-03]
 [ 2.81764212e-01  3.12030075e-02]
 [ 1.40211978e-01  1.37047678e-01]
 [-1.29169096e-01 -5.07227125e-02]
 [ 3.72460542e-02 -4.62435733e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.98415155]
curr_Stock_Price:  97.17677597586584
curr_Factors:  [9.71767760e+01 4.28138971e-02]
mat_Sqrt:  [[ 2.01073514e+01  0.00000000e+00]
 [-8.27660772e-03  1.89640907e-02]]
grads:  [-1.79554195e-03 -1.47424077e+01]
Stock Position:  -0.0017955419456072074
Bond Position:  [-16.80966657]


portfolio before change:  [-16.99267143]
curr_Stock_Price:  97.23968188519594
curr_Factors:  [9.72396819e+01 4.28751625e-02]
mat_Sqrt:  [[ 2.01347582e+01  0.00000000e+00]
 [-8.28252739e-03  1.89776543e-02]]
grads:  [-6.23225281e-03 -1.42570322e+01]
Stock Position:  -0.006232252809102767
Bond Position:  [-16.38664915]


portfolio before change:  [-17.01804179]
curr_Stock_Price:  99.9955053353372
curr_Factors:  [9.99955053e+01 4.16677420e-02]
mat_Sqrt:  [[ 2.04117605e+01  0.00000000e+00]
 [-8.16507117e-03  1.87085284e-02]]
grads:  [0.01370581 8.49898276]
Stock Position:  0.013705809047051794
Bond Position:  [-18.3885611]


portfolio before change:  [-17.00483968]
curr_Stock_Price:  101.6297535645397
curr_Factors:  [1.01629754e+02 4.13760176e-02]
mat_Sqrt:  [[ 2.06726055e+01  0.00000000e+00]
 [-8.13643829e-03  1.86429222e-02]]
grads:  [5.21319178e-03 6.03763720e+00]
Stock Position:  0.00521319177793027
Bond Position:  [-17.53465508]


portfolio before change:  [-17.00989119]
curr_Stock_Price:  102.3429466115872
curr_Factors:  [1.02342947e+02 3.88529306e-02]
mat_Sqrt:  [[ 2.01729684e+01  0.00000000e+00]
 [-7.88445869e-03  1.80655644e-02]]
grads:  [-0.00087391 -0.18411813]
Stock Position:  -0.0008739060455251975
Bond Position:  [-16.92045307]


portfolio before change:  [-17.02173281]
curr_Stock_Price:  106.20981846372932
curr_Factors:  [1.06209818e+02 3.45727373e-02]
mat_Sqrt:  [[ 1.97483834e+01  0.00000000e+00]
 [-7.43749821e-03  1.70414493e-02]]
grads:  [0.01495729 1.83100668]
Stock Position:  0.014957291232936409
Bond Position:  [-18.610344]


portfolio before change:  [-17.02499168]
curr_Stock_Price:  106.61421221740606
curr_Factors:  [1.06614212e+02 3.54766415e-02]
mat_Sqrt:  [[ 2.00810470e+01  0.00000000e+00]
 [-7.53409758e-03  1.72627862e-02]]
grads:  [0.00996086 7.93890837]
Stock Position:  0.009960859548710099
Bond Position:  [-18.08696087]


portfolio before change:  [-17.06280278]
curr_Stock_Price:  103.72637280769787
curr_Factors:  [1.03726373e+02 3.91922263e-02]
mat_Sqrt:  [[ 2.05347376e+01  0.00000000e+00]
 [-7.91881065e-03  1.81442746e-02]]
grads:  [-0.00736831 -2.79552165]
Stock Position:  -0.0073683095053901455
Bond Position:  [-16.29851476]


portfolio before change:  [-17.06986161]
curr_Stock_Price:  103.57810790982056
curr_Factors:  [1.03578108e+02 3.60082277e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.06986161]
Stock Price:  105.59654425342481
PL:  [-22.66640587]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.16595610e-02 -3.90182492e-01]
 [-3.35494478e-01 -3.71257071e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [-1.26529535e-01  1.93217646e-02]
 [-4.16258701e-02 -3.87476139e-03]
 [ 8.84799089e-02 -1.64570465e-01]
 [ 1.91078761e-01 -3.67340516e-02]
 [-5.01305704e-02  6.15455626e-02]
 [ 4.88800483e-02 -7.38643075e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.93130158]
curr_Stock_Price:  102.39077822308826
curr_Factors:  [1.02390778e+02 3.84610148e-02]
mat_Sqrt:  [[ 2.00803470e+01  0.00000000e+00]
 [-7.84459200e-03  1.79742183e-02]]
grads:  [-1.20490528e-02 -2.17078976e+01]
Stock Position:  -0.012049052802432665
Bond Position:  [20.16501348]


portfolio before change:  [18.94732199]
curr_Stock_Price:  101.89817657557234
curr_Factors:  [1.01898177e+02 3.55918509e-02]
mat_Sqrt:  [[ 1.92239089e+01  0.00000000e+00]
 [-7.54632106e-03  1.72907937e-02]]
grads:  [-0.01829479 -2.14713724]
Stock Position:  -0.01829479461131118
Bond Position:  [20.81152821]


portfolio before change:  [18.93755781]
curr_Stock_Price:  103.00081516519685
curr_Factors:  [1.03000815e+02 3.50144713e-02]
mat_Sqrt:  [[ 1.92736713e+01  0.00000000e+00]
 [-7.48486166e-03  1.71499726e-02]]
grads:  [ -0.01858773 -18.08942591]
Stock Position:  -0.018587728981478417
Bond Position:  [20.85210905]


portfolio before change:  [18.92939126]
curr_Stock_Price:  104.00121774790772
curr_Factors:  [1.04001218e+02 3.31985556e-02]
mat_Sqrt:  [[ 1.89495115e+01  0.00000000e+00]
 [-7.28818832e-03  1.66993373e-02]]
grads:  [-0.00623218  1.15703781]
Stock Position:  -0.00623218310344891
Bond Position:  [19.5775459]


portfolio before change:  [18.94576819]
curr_Stock_Price:  102.94449234781415
curr_Factors:  [1.02944492e+02 3.34717678e-02]
mat_Sqrt:  [[ 1.88339946e+01  0.00000000e+00]
 [-7.31811646e-03  1.67679113e-02]]
grads:  [-0.00229993 -0.23108193]
Stock Position:  -0.00229993453359099
Bond Position:  [19.18253378]


portfolio before change:  [18.95923366]
curr_Stock_Price:  101.26104969721143
curr_Factors:  [1.01261050e+02 3.67791436e-02]
mat_Sqrt:  [[ 1.94197319e+01  0.00000000e+00]
 [-7.67115569e-03  1.75768258e-02]]
grads:  [ 8.57657034e-04 -9.36292288e+00]
Stock Position:  0.000857657033739245
Bond Position:  [18.87238641]


portfolio before change:  [18.96976222]
curr_Stock_Price:  102.53195938527118
curr_Factors:  [1.02531959e+02 3.32087866e-02]
mat_Sqrt:  [[ 1.86846841e+01  0.00000000e+00]
 [-7.28931125e-03  1.67019103e-02]]
grads:  [ 0.00936846 -2.19939222]
Stock Position:  0.00936845949130775
Bond Position:  [18.00919571]


portfolio before change:  [18.98107631]
curr_Stock_Price:  102.77823633413091
curr_Factors:  [1.02778236e+02 3.29883284e-02]
mat_Sqrt:  [[ 1.86672918e+01  0.00000000e+00]
 [-7.26507573e-03  1.66463797e-02]]
grads:  [-1.24655922e-03  3.69723409e+00]
Stock Position:  -0.0012465592232487515
Bond Position:  [19.10919546]


portfolio before change:  [18.99294073]
curr_Stock_Price:  100.92719346580517
curr_Factors:  [1.00927193e+02 3.16767647e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.99294073]
Stock Price:  103.08824262499293
PL:  [15.9046981]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.62291491e-02 -2.49337279e-01]
 [-4.16924384e-01 -8.97482927e-02]
 [-4.68495358e-01 -2.84083376e-02]
 [-3.60900061e-01 -6.87639926e-02]
 [-1.43945919e-01 -9.80484164e-03]
 [ 2.19983607e-01 -3.68653937e-02]
 [ 1.33910255e-01  1.76687157e-01]
 [-4.51997599e-01 -4.69053057e-01]
 [ 2.45564288e-02 -2.96795274e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.01864582]
curr_Stock_Price:  99.79032022389059
curr_Factors:  [9.97903202e+01 3.99555094e-02]
mat_Sqrt:  [[ 1.99469616e+01  0.00000000e+00]
 [-7.99554970e-03  1.83201059e-02]]
grads:  [-8.27438594e-03 -1.36100348e+01]
Stock Position:  -0.008274385944364306
Bond Position:  [1.84434945]


portfolio before change:  [0.99681523]
curr_Stock_Price:  102.54013113333093
curr_Factors:  [1.02540131e+02 3.80206702e-02]
mat_Sqrt:  [[ 1.99941871e+01  0.00000000e+00]
 [-7.79955590e-03  1.78710277e-02]]
grads:  [-0.02281132 -5.02199954]
Stock Position:  -0.022811317474923855
Bond Position:  [3.33589072]


portfolio before change:  [0.90099686]
curr_Stock_Price:  106.81374385485461
curr_Factors:  [1.06813744e+02 3.84832882e-02]
mat_Sqrt:  [[ 2.09538207e+01  0.00000000e+00]
 [-7.84686314e-03  1.79794221e-02]]
grads:  [-0.02295017 -1.58004731]
Stock Position:  -0.022950171202324378
Bond Position:  [3.35239057]


portfolio before change:  [0.91096391]
curr_Stock_Price:  106.45250762052618
curr_Factors:  [1.06452508e+02 3.87314090e-02]
mat_Sqrt:  [[ 2.09501697e+01  0.00000000e+00]
 [-7.87211880e-03  1.80372901e-02]]
grads:  [-0.01865909 -3.81232392]
Stock Position:  -0.01865909128438885
Bond Position:  [2.89727096]


portfolio before change:  [0.93673845]
curr_Stock_Price:  105.14882440055041
curr_Factors:  [1.05148824e+02 3.99001972e-02]
mat_Sqrt:  [[ 2.10035131e+01  0.00000000e+00]
 [-7.99001349e-03  1.83074208e-02]]
grads:  [-0.00705716 -0.53556652]
Stock Position:  -0.00705715763434922
Bond Position:  [1.67879028]


portfolio before change:  [0.93449288]
curr_Stock_Price:  105.58599423348468
curr_Factors:  [1.05585994e+02 3.90901018e-02]
mat_Sqrt:  [[ 2.08756359e+01  0.00000000e+00]
 [-7.90848676e-03  1.81206196e-02]]
grads:  [ 0.00976709 -2.03444444]
Stock Position:  0.009767090736450136
Bond Position:  [-0.09677511]


portfolio before change:  [0.96036737]
curr_Stock_Price:  108.24010065253255
curr_Factors:  [1.08240101e+02 4.22680436e-02]
mat_Sqrt:  [[ 2.22532917e+01  0.00000000e+00]
 [-8.22367739e-03  1.88428121e-02]]
grads:  [0.00948277 9.37689962]
Stock Position:  0.009482770236870563
Bond Position:  [-0.06604863]


portfolio before change:  [0.9614766]
curr_Stock_Price:  108.36055693270713
curr_Factors:  [1.08360557e+02 4.39201856e-02]
mat_Sqrt:  [[ 2.27092772e+01  0.00000000e+00]
 [-8.38285732e-03  1.92075391e-02]]
grads:  [ -0.0289181  -24.42025782]
Stock Position:  -0.028918099413668394
Bond Position:  [4.09505796]


portfolio before change:  [0.99100865]
curr_Stock_Price:  107.41014847184952
curr_Factors:  [1.07410148e+02 4.54243291e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.99100865]
Stock Price:  110.69178912937207
PL:  [-9.70078048]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-1.54004197e-02 -1.78852037e-01]
 [ 2.28792386e-01  1.52048541e-01]
 [ 1.36754945e-02  8.47594553e-02]
 [-6.01543044e-02 -3.49567341e-03]
 [ 3.75413911e-01  1.35024822e-01]
 [ 1.38833469e-01  1.45718860e-01]
 [-3.81861746e-01 -4.05575181e-01]
 [ 2.26902458e-02  3.26168965e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.20792601]
curr_Stock_Price:  99.03155610063594
curr_Factors:  [9.90315561e+01 4.08732271e-02]
mat_Sqrt:  [[ 2.00213366e+01  0.00000000e+00]
 [-8.08685126e-03  1.85293040e-02]]
grads:  [-6.63682698e-03 -1.02764601e+01]
Stock Position:  -0.0066368269775991685
Bond Position:  [-3.55067071]


portfolio before change:  [-4.20045329]
curr_Stock_Price:  97.6380439310545
curr_Factors:  [9.76380439e+01 4.20284072e-02]
mat_Sqrt:  [[ 2.00166104e+01  0.00000000e+00]
 [-8.20033240e-03  1.87893220e-02]]
grads:  [-4.66901470e-03 -9.51881273e+00]
Stock Position:  -0.004669014701510624
Bond Position:  [-3.74457983]


portfolio before change:  [-4.21065756]
curr_Stock_Price:  99.42247008254824
curr_Factors:  [9.94224701e+01 3.95677664e-02]
mat_Sqrt:  [[ 1.97767679e+01  0.00000000e+00]
 [-7.95665924e-03  1.82309966e-02]]
grads:  [0.01492417 8.34011129]
Stock Position:  0.014924168153484777
Bond Position:  [-5.69445523]


portfolio before change:  [-4.17030576]
curr_Stock_Price:  102.31708686266134
curr_Factors:  [1.02317087e+02 4.19023146e-02]
mat_Sqrt:  [[ 2.09443638e+01  0.00000000e+00]
 [-8.18802195e-03  1.87611152e-02]]
grads:  [2.41914980e-03 4.51782607e+00]
Stock Position:  0.002419149797876768
Bond Position:  [-4.41782612]


portfolio before change:  [-4.16990965]
curr_Stock_Price:  103.39414627309071
curr_Factors:  [1.03394146e+02 4.13720466e-02]
mat_Sqrt:  [[ 2.10304930e+01  0.00000000e+00]
 [-8.13604785e-03  1.86420276e-02]]
grads:  [-0.00293288 -0.18751573]
Stock Position:  -0.0029328813754150728
Bond Position:  [-3.86666689]


portfolio before change:  [-4.18294249]
curr_Stock_Price:  107.17848483956593
curr_Factors:  [1.07178485e+02 4.12165945e-02]
mat_Sqrt:  [[ 2.17592372e+01  0.00000000e+00]
 [-8.12074819e-03  1.86069717e-02]]
grads:  [0.01996134 7.2566791 ]
Stock Position:  0.019961341970012245
Bond Position:  [-6.32236887]


portfolio before change:  [-4.19055233]
curr_Stock_Price:  106.95566066893414
curr_Factors:  [1.06955661e+02 4.33716861e-02]
mat_Sqrt:  [[ 2.22744468e+01  0.00000000e+00]
 [-8.33034800e-03  1.90872251e-02]]
grads:  [0.00908801 7.63436589]
Stock Position:  0.009088009892017888
Bond Position:  [-5.16256643]


portfolio before change:  [-4.19261433]
curr_Stock_Price:  107.01287170728152
curr_Factors:  [1.07012872e+02 4.22846085e-02]
mat_Sqrt:  [[ 2.20052940e+01  0.00000000e+00]
 [-8.22528867e-03  1.88465040e-02]]
grads:  [ -0.02539704 -21.51991593]
Stock Position:  -0.02539703701653105
Bond Position:  [-1.47480446]


portfolio before change:  [-4.27879539]
curr_Stock_Price:  110.3771805860681
curr_Factors:  [1.10377181e+02 4.47040404e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.27879539]
Stock Price:  110.80912097278552
PL:  [-15.08791636]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.48700946e-02 -2.36932146e-01]
 [-1.46609301e-01  4.71808931e-02]
 [ 2.26795300e-01  1.51368346e-01]
 [ 2.11900575e-01  1.64372364e-01]
 [ 4.47369836e-02 -2.06288567e-02]
 [ 8.52305502e-02 -1.27027985e-01]
 [ 1.92634352e-01 -2.08498312e-01]
 [-3.23363281e-03  6.93994322e-03]
 [ 3.85794837e-02 -4.94093220e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.147204]
curr_Stock_Price:  99.66380923173472
curr_Factors:  [9.96638092e+01 4.16433950e-02]
mat_Sqrt:  [[ 2.03381079e+01  0.00000000e+00]
 [-8.16268535e-03  1.87030617e-02]]
grads:  [-7.78222643e-03 -1.26680941e+01]
Stock Position:  -0.007782226431731608
Bond Position:  [0.92281033]


portfolio before change:  [0.14003454]
curr_Stock_Price:  100.64437473485533
curr_Factors:  [1.00644375e+02 4.00555526e-02]
mat_Sqrt:  [[ 2.01428477e+01  0.00000000e+00]
 [-8.00555334e-03  1.83430271e-02]]
grads:  [-0.00625621  2.57214324]
Stock Position:  -0.006256209305104243
Bond Position:  [0.76968681]


portfolio before change:  [0.1467905]
curr_Stock_Price:  99.62602301238705
curr_Factors:  [9.96260230e+01 4.16643965e-02]
mat_Sqrt:  [[ 2.03355228e+01  0.00000000e+00]
 [-8.16474338e-03  1.87077773e-02]]
grads:  [0.01440129 8.09119885]
Stock Position:  0.014401294988572316
Bond Position:  [-1.28795324]


portfolio before change:  [0.13110412]
curr_Stock_Price:  98.58151696617465
curr_Factors:  [9.8581517e+01 4.3054598e-02]
mat_Sqrt:  [[ 2.04552723e+01  0.00000000e+00]
 [-8.29984077e-03  1.90173243e-02]]
grads:  [0.01386628 8.64329607]
Stock Position:  0.013866281084496323
Bond Position:  [-1.2358549]


portfolio before change:  [0.15567572]
curr_Stock_Price:  100.39813074527801
curr_Factors:  [1.00398131e+02 3.94537747e-02]
mat_Sqrt:  [[ 1.99420549e+01  0.00000000e+00]
 [-7.94518971e-03  1.82047166e-02]]
grads:  [ 0.00179188 -1.13316   ]
Stock Position:  0.001791882162291339
Bond Position:  [-0.0242259]


portfolio before change:  [0.15627368]
curr_Stock_Price:  100.73859987378489
curr_Factors:  [1.00738600e+02 3.76617081e-02]
mat_Sqrt:  [[ 1.95499620e+01  0.00000000e+00]
 [-7.76264987e-03  1.77864653e-02]]
grads:  [ 1.52383890e-03 -7.14183411e+00]
Stock Position:  0.0015238389027930422
Bond Position:  [0.00276429]


portfolio before change:  [0.15177881]
curr_Stock_Price:  97.78799134355457
curr_Factors:  [9.77879913e+01 4.06218418e-02]
mat_Sqrt:  [[ 1.97090336e+01  0.00000000e+00]
 [-8.06194436e-03  1.84722351e-02]]
grads:  [ 5.15693619e-03 -1.12871187e+01]
Stock Position:  0.005156936191898625
Bond Position:  [-0.35250762]


portfolio before change:  [0.17030138]
curr_Stock_Price:  101.41395426764167
curr_Factors:  [1.01413954e+02 3.65097269e-02]
mat_Sqrt:  [[ 1.93776902e+01  0.00000000e+00]
 [-7.64300746e-03  1.75123301e-02]]
grads:  [-1.05685082e-05  3.96288968e-01]
Stock Position:  -1.056850815659983e-05
Bond Position:  [0.17137317]


portfolio before change:  [0.17036741]
curr_Stock_Price:  103.2759868055467
curr_Factors:  [1.03275987e+02 3.82971436e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.17036741]
Stock Price:  101.97102939009764
PL:  [-1.80066199]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.97555711e-02 -2.82100973e-01]
 [ 2.62185160e-02 -6.55990028e-01]
 [ 2.77276844e-01  1.68562042e-01]
 [ 2.04594650e-01  1.46907875e-01]
 [ 1.48848113e-01 -1.58290687e-01]
 [ 7.86684738e-02 -9.79470633e-02]
 [ 1.30327175e-01 -2.73533200e-01]
 [ 5.34026960e-02 -1.21862632e-01]
 [ 6.63649779e-03  7.19125476e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.14965879]
curr_Stock_Price:  96.71722554759121
curr_Factors:  [9.67172255e+01 3.91825856e-02]
mat_Sqrt:  [[ 1.91447798e+01  0.00000000e+00]
 [-7.91783664e-03  1.81420429e-02]]
grads:  [-1.74268848e-03 -1.55495704e+01]
Stock Position:  -0.0017426884814615436
Bond Position:  [-19.98111079]


portfolio before change:  [-20.15767138]
curr_Stock_Price:  95.58078636595518
curr_Factors:  [9.55807864e+01 4.13263969e-02]
mat_Sqrt:  [[ 1.94305176e+01  0.00000000e+00]
 [-8.13155797e-03  1.86317400e-02]]
grads:  [-1.33850785e-02 -3.52082000e+01]
Stock Position:  -0.013385078492662251
Bond Position:  [-18.87831505]


portfolio before change:  [-20.15323914]
curr_Stock_Price:  94.54427722425454
curr_Factors:  [9.45442772e+01 4.12633265e-02]
mat_Sqrt:  [[ 1.92051350e+01  0.00000000e+00]
 [-8.12535060e-03  1.86175171e-02]]
grads:  [0.01826821 9.05394855]
Stock Position:  0.018268205381993457
Bond Position:  [-21.88039342]


portfolio before change:  [-20.16029783]
curr_Stock_Price:  94.75690077971909
curr_Factors:  [9.47569008e+01 4.09558501e-02]
mat_Sqrt:  [[ 1.91764768e+01  0.00000000e+00]
 [-8.09502070e-03  1.85480225e-02]]
grads:  [0.01401251 7.92040631]
Stock Position:  0.014012506339948647
Bond Position:  [-21.4880795]


portfolio before change:  [-20.15747521]
curr_Stock_Price:  95.72527435103663
curr_Factors:  [9.57252744e+01 4.02998955e-02]
mat_Sqrt:  [[ 1.92166898e+01  0.00000000e+00]
 [-8.02993355e-03  1.83988891e-02]]
grads:  [ 4.15078738e-03 -8.60327412e+00]
Stock Position:  0.00415078738405457
Bond Position:  [-20.55481047]


portfolio before change:  [-20.17408376]
curr_Stock_Price:  94.20060650483035
curr_Factors:  [9.42006065e+01 4.21513427e-02]
mat_Sqrt:  [[ 1.93401307e+01  0.00000000e+00]
 [-8.21231687e-03  1.88167818e-02]]
grads:  [ 1.85732306e-03 -5.20530366e+00]
Stock Position:  0.001857323057412346
Bond Position:  [-20.34904472]


portfolio before change:  [-20.18137284]
curr_Stock_Price:  95.75552282940664
curr_Factors:  [9.57555228e+01 4.13682988e-02]
mat_Sqrt:  [[ 1.94759057e+01  0.00000000e+00]
 [-8.13567932e-03  1.86411832e-02]]
grads:  [ 5.62104764e-04 -1.46735965e+01]
Stock Position:  0.0005621047635397433
Bond Position:  [-20.23519748]


portfolio before change:  [-20.19158116]
curr_Stock_Price:  95.5986297769624
curr_Factors:  [9.55986298e+01 4.31776890e-02]
mat_Sqrt:  [[ 1.98646705e+01  0.00000000e+00]
 [-8.31169673e-03  1.90444897e-02]]
grads:  [ 1.09482317e-05 -6.39883946e+00]
Stock Position:  1.0948231667590228e-05
Bond Position:  [-20.1926278]


portfolio before change:  [-20.20169522]
curr_Stock_Price:  94.20809979106248
curr_Factors:  [9.42080998e+01 4.54634861e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.20169522]
Stock Price:  95.90267624897915
PL:  [-20.20169522]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.81788052e-02 -2.81064875e-01]
 [-1.04025431e-01  5.71339881e-02]
 [ 1.71504341e-01  1.16912336e-01]
 [ 6.95616838e-02  1.18555228e-01]
 [ 1.01283648e-01 -1.20914968e-01]
 [ 7.75051995e-02 -6.14765254e-02]
 [ 2.59820560e-01 -1.30344152e-01]
 [ 6.28141634e-02  4.13373084e-02]
 [ 4.33201299e-02 -6.06642811e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.79815481]
curr_Stock_Price:  96.91342924773296
curr_Factors:  [9.69134292e+01 4.31849772e-02]
mat_Sqrt:  [[ 2.01395753e+01  0.00000000e+00]
 [-8.31239818e-03  1.90460969e-02]]
grads:  [-1.71244737e-03 -1.47570852e+01]
Stock Position:  -0.001712447367738975
Bond Position:  [-18.63219566]


portfolio before change:  [-18.8133831]
curr_Stock_Price:  100.3645493334487
curr_Factors:  [1.00364549e+02 4.32607085e-02]
mat_Sqrt:  [[ 2.08750321e+01  0.00000000e+00]
 [-8.31968350e-03  1.90627897e-02]]
grads:  [-0.00378874  2.99714727]
Stock Position:  -0.003788742177531177
Bond Position:  [-18.43312769]


portfolio before change:  [-18.82285486]
curr_Stock_Price:  100.43129765821985
curr_Factors:  [1.00431298e+02 4.49473821e-02]
mat_Sqrt:  [[ 2.12922362e+01  0.00000000e+00]
 [-8.48031906e-03  1.94308520e-02]]
grads:  [0.01045118 6.01684042]
Stock Position:  0.010451183504166753
Bond Position:  [-19.87248078]


portfolio before change:  [-18.82168893]
curr_Stock_Price:  101.49382305565938
curr_Factors:  [1.01493823e+02 4.48743205e-02]
mat_Sqrt:  [[ 2.15000047e+01  0.00000000e+00]
 [-8.47342391e-03  1.94150532e-02]]
grads:  [5.64201864e-03 6.10635604e+00]
Stock Position:  0.005642018637740431
Bond Position:  [-19.39431897]


portfolio before change:  [-18.85920478]
curr_Stock_Price:  96.56362542815639
curr_Factors:  [9.65636254e+01 4.97003031e-02]
mat_Sqrt:  [[ 2.15274744e+01  0.00000000e+00]
 [-8.91742592e-03  2.04323896e-02]]
grads:  [ 2.25349377e-03 -5.91780843e+00]
Stock Position:  0.002253493768963542
Bond Position:  [-19.07681031]


portfolio before change:  [-18.86760774]
curr_Stock_Price:  97.0685450116818
curr_Factors:  [9.70685450e+01 4.87073828e-02]
mat_Sqrt:  [[ 2.14227844e+01  0.00000000e+00]
 [-8.82789967e-03  2.02272592e-02]]
grads:  [ 2.36545554e-03 -3.03929093e+00]
Stock Position:  0.002365455542195932
Bond Position:  [-19.09721907]


portfolio before change:  [-18.8691006]
curr_Stock_Price:  100.47513465296124
curr_Factors:  [1.00475135e+02 4.58991135e-02]
mat_Sqrt:  [[ 2.15258716e+01  0.00000000e+00]
 [-8.56963136e-03  1.96354922e-02]]
grads:  [ 0.00942743 -6.63819123]
Stock Position:  0.00942743280618779
Bond Position:  [-19.81632318]


portfolio before change:  [-18.88036047]
curr_Stock_Price:  100.33201772422713
curr_Factors:  [1.00332018e+02 4.87872598e-02]
mat_Sqrt:  [[ 2.21611738e+01  0.00000000e+00]
 [-8.83513529e-03  2.02438381e-02]]
grads:  [0.00364851 2.04196992]
Stock Position:  0.0036485090880650655
Bond Position:  [-19.24642274]


portfolio before change:  [-18.88315716]
curr_Stock_Price:  102.20371927846118
curr_Factors:  [1.02203719e+02 4.94292863e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.88315716]
Stock Price:  102.33194845417401
PL:  [-21.21510562]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.66673304e-02 -2.53336897e-01]
 [-2.48009378e-01  1.40154493e-02]
 [-3.55090468e-01 -1.61780090e-01]
 [-3.01467521e-01 -4.64264269e-02]
 [-2.36095311e-01  1.61325969e-02]
 [ 1.48721424e-01 -1.15702953e-01]
 [ 1.82327291e-01 -1.16065059e-02]
 [-2.44988488e-01 -2.49702464e-01]
 [ 3.16780146e-02 -3.30242660e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.29503192]
curr_Stock_Price:  99.83044439391286
curr_Factors:  [9.98304444e+01 3.91384229e-02]
mat_Sqrt:  [[ 1.97498893e+01  0.00000000e+00]
 [-7.91337327e-03  1.81318160e-02]]
grads:  [-8.46752174e-03 -1.39719539e+01]
Stock Position:  -0.008467521737275828
Bond Position:  [2.14034838]


portfolio before change:  [1.28372685]
curr_Stock_Price:  101.29197220371962
curr_Factors:  [1.01291972e+02 3.72603626e-02]
mat_Sqrt:  [[ 1.95523321e+01  0.00000000e+00]
 [-7.72117738e-03  1.76914399e-02]]
grads:  [-0.01237154  0.79221643]
Stock Position:  -0.012371543893640107
Bond Position:  [2.53686493]


portfolio before change:  [1.23562543]
curr_Stock_Price:  105.28259495002249
curr_Factors:  [1.05282595e+02 3.78991420e-02]
mat_Sqrt:  [[ 2.04961018e+01  0.00000000e+00]
 [-7.78708079e-03  1.78424436e-02]]
grads:  [-0.02076966 -9.06714877]
Stock Position:  -0.020769661095492525
Bond Position:  [3.42230925]


portfolio before change:  [1.22594698]
curr_Stock_Price:  105.8309926934473
curr_Factors:  [1.05830993e+02 3.77937697e-02]
mat_Sqrt:  [[ 2.05742009e+01  0.00000000e+00]
 [-7.77624790e-03  1.78176223e-02]]
grads:  [-0.01563753 -2.6056466 ]
Stock Position:  -0.015637529598747264
Bond Position:  [2.88088226]


portfolio before change:  [1.2000984]
curr_Stock_Price:  107.57611388685397
curr_Factors:  [1.07576114e+02 3.67582790e-02]
mat_Sqrt:  [[ 2.06249753e+01  0.00000000e+00]
 [-7.66897949e-03  1.75718395e-02]]
grads:  [-0.01110568  0.9180938 ]
Stock Position:  -0.011105684524836993
Bond Position:  [2.39480478]


portfolio before change:  [1.23151783]
curr_Stock_Price:  104.85482887554969
curr_Factors:  [1.04854829e+02 3.75091617e-02]
mat_Sqrt:  [[ 2.03075305e+01  0.00000000e+00]
 [-7.74691285e-03  1.77504073e-02]]
grads:  [ 4.83685178e-03 -6.51832666e+00]
Stock Position:  0.0048368517837334545
Bond Position:  [0.72435056]


portfolio before change:  [1.22255666]
curr_Stock_Price:  102.92724460247173
curr_Factors:  [1.02927245e+02 3.72735400e-02]
mat_Sqrt:  [[ 1.98715008e+01  0.00000000e+00]
 [-7.72254259e-03  1.76945680e-02]]
grads:  [ 0.0089204 -0.6559361]
Stock Position:  0.00892040307397253
Bond Position:  [0.30440415]


portfolio before change:  [1.23930746]
curr_Stock_Price:  104.78798616421655
curr_Factors:  [1.04787986e+02 3.69552809e-02]
mat_Sqrt:  [[ 2.01441872e+01  0.00000000e+00]
 [-7.68950255e-03  1.76188637e-02]]
grads:  [ -0.0175717 -14.1724499]
Stock Position:  -0.017571698202261045
Bond Position:  [3.08061033]


portfolio before change:  [1.23982606]
curr_Stock_Price:  104.84615293492318
curr_Factors:  [1.04846153e+02 3.69677531e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.23982606]
Stock Price:  105.24677082468536
PL:  [-4.00694476]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.57665248e-02 -2.45114552e-01]
 [-1.72065330e-02 -1.58145951e-01]
 [ 7.71758028e-02  1.47420335e-02]
 [ 1.31971753e-01  1.45189546e-01]
 [ 3.68918413e-02 -1.50292340e-02]
 [ 8.42031017e-02 -1.15134890e-01]
 [ 2.44326691e-01 -1.33286631e-01]
 [-4.83049587e-02  5.18868805e-02]
 [ 4.68289868e-02 -6.89947997e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.70901214]
curr_Stock_Price:  99.74536935784212
curr_Factors:  [9.97453694e+01 3.82008043e-02]
mat_Sqrt:  [[ 1.94952584e+01  0.00000000e+00]
 [-7.81801042e-03  1.79133123e-02]]
grads:  [-8.34783936e-03 -1.36833740e+01]
Stock Position:  -0.008347839364636673
Bond Position:  [1.54167046]


portfolio before change:  [0.72651821]
curr_Stock_Price:  97.74065415969362
curr_Factors:  [9.77406542e+01 3.75867015e-02]
mat_Sqrt:  [[ 1.89492641e+01  0.00000000e+00]
 [-7.75491602e-03  1.77687448e-02]]
grads:  [-4.55041865e-03 -8.90023201e+00]
Stock Position:  -0.004550418646375619
Bond Position:  [1.1712791]


portfolio before change:  [0.71243581]
curr_Stock_Price:  100.9641347877994
curr_Factors:  [1.00964135e+02 3.67764628e-02]
mat_Sqrt:  [[ 1.93620843e+01  0.00000000e+00]
 [-7.67087612e-03  1.75761852e-02]]
grads:  [0.00431822 0.83875046]
Stock Position:  0.00431822072985082
Bond Position:  [0.27645039]


portfolio before change:  [0.71133659]
curr_Stock_Price:  100.6775643918628
curr_Factors:  [1.00677564e+02 3.84367129e-02]
mat_Sqrt:  [[ 1.97381216e+01  0.00000000e+00]
 [-7.84211328e-03  1.79685389e-02]]
grads:  [0.00989647 8.0802088 ]
Stock Position:  0.00989646684687921
Bond Position:  [-0.28501559]


portfolio before change:  [0.71213433]
curr_Stock_Price:  100.7725760227656
curr_Factors:  [1.00772576e+02 4.06612844e-02]
mat_Sqrt:  [[ 2.03204306e+01  0.00000000e+00]
 [-8.06585736e-03  1.84812010e-02]]
grads:  [ 0.00149271 -0.81321739]
Stock Position:  0.0014927117638156562
Bond Position:  [0.56170992]


portfolio before change:  [0.71212232]
curr_Stock_Price:  100.57633568633771
curr_Factors:  [1.00576336e+02 4.07134097e-02]
mat_Sqrt:  [[ 2.02938547e+01  0.00000000e+00]
 [-8.07102568e-03  1.84930431e-02]]
grads:  [ 1.67312306e-03 -6.22584880e+00]
Stock Position:  0.0016731230553433355
Bond Position:  [0.54384574]


portfolio before change:  [0.71319061]
curr_Stock_Price:  101.05226814397676
curr_Factors:  [1.01052268e+02 3.99107935e-02]
mat_Sqrt:  [[ 2.01879048e+01  0.00000000e+00]
 [-7.99107437e-03  1.83098516e-02]]
grads:  [ 0.00922115 -7.27950364]
Stock Position:  0.009221146927260606
Bond Position:  [-0.2186272]


portfolio before change:  [0.72749594]
curr_Stock_Price:  102.6154875883908
curr_Factors:  [1.02615488e+02 4.21907754e-02]
mat_Sqrt:  [[ 2.10776247e+01  0.00000000e+00]
 [-8.21615729e-03  1.88255814e-02]]
grads:  [-1.21738896e-03  2.75619007e+00]
Stock Position:  -0.0012173889606538484
Bond Position:  [0.85241891]


portfolio before change:  [0.72940277]
curr_Stock_Price:  101.39935281446694
curr_Factors:  [1.01399353e+02 4.02533710e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.72940277]
Stock Price:  102.01897382361767
PL:  [-1.28957106]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-5.02294219e-01 -1.44958250e-01]
 [-2.22856928e-01 -3.10233158e-01]
 [ 1.17473765e-01  1.39171693e-01]
 [ 4.24423721e-02 -1.89912260e-02]
 [ 8.75548220e-02 -1.46362942e-01]
 [ 1.43905887e-01  1.13812026e-01]
 [-3.43309783e-01 -3.72176282e-01]
 [ 3.63373883e-02 -4.40862729e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.95795526]
curr_Stock_Price:  98.92267109872957
curr_Factors:  [9.89226711e+01 3.90047652e-02]
mat_Sqrt:  [[ 1.95368557e+01  0.00000000e+00]
 [-7.89984964e-03  1.81008295e-02]]
grads:  [-6.80140904e-03 -1.05197198e+01]
Stock Position:  -0.006801409036422208
Bond Position:  [-4.28514171]


portfolio before change:  [-4.9892849]
curr_Stock_Price:  103.21391894734914
curr_Factors:  [1.03213919e+02 3.99403028e-02]
mat_Sqrt:  [[ 2.06273741e+01  0.00000000e+00]
 [-7.99402805e-03  1.83166193e-02]]
grads:  [-0.0274179  -7.91402865]
Stock Position:  -0.02741789545682982
Bond Position:  [-2.15937646]


portfolio before change:  [-4.9742724]
curr_Stock_Price:  102.62698637633785
curr_Factors:  [1.02626986e+02 3.91671116e-02]
mat_Sqrt:  [[ 2.03105811e+01  0.00000000e+00]
 [-7.91627302e-03  1.81384602e-02]]
grads:  [ -0.01763878 -17.10361049]
Stock Position:  -0.017638775421974145
Bond Position:  [-3.16405804]


portfolio before change:  [-4.94533418]
curr_Stock_Price:  100.89667076313945
curr_Factors:  [1.00896671e+02 3.73617444e-02]
mat_Sqrt:  [[ 1.95025055e+01  0.00000000e+00]
 [-7.73167453e-03  1.77154919e-02]]
grads:  [0.00913797 7.85593164]
Stock Position:  0.009137968018688932
Bond Position:  [-5.86732473]


portfolio before change:  [-4.95182818]
curr_Stock_Price:  100.50713104862434
curr_Factors:  [1.00507131e+02 4.02255026e-02]
mat_Sqrt:  [[ 2.01580081e+01  0.00000000e+00]
 [-8.02251857e-03  1.83818993e-02]]
grads:  [ 0.00169431 -1.03314819]
Stock Position:  0.0016943103363030532
Bond Position:  [-5.12211845]


portfolio before change:  [-4.94991307]
curr_Stock_Price:  103.14939170949762
curr_Factors:  [1.03149392e+02 3.66629797e-02]
mat_Sqrt:  [[ 1.97506117e+01  0.00000000e+00]
 [-7.65903176e-03  1.75490464e-02]]
grads:  [ 1.19878805e-03 -8.34022194e+00]
Stock Position:  0.0011987880528091628
Bond Position:  [-5.07356733]


portfolio before change:  [-4.94945435]
curr_Stock_Price:  105.64869186840816
curr_Factors:  [1.05648692e+02 3.71158993e-02]
mat_Sqrt:  [[ 2.03537351e+01  0.00000000e+00]
 [-7.70619484e-03  1.76571106e-02]]
grads:  [0.00951066 6.4456767 ]
Stock Position:  0.009510663616200494
Bond Position:  [-5.95424352]


portfolio before change:  [-4.94656211]
curr_Stock_Price:  106.26590482664284
curr_Factors:  [1.06265905e+02 3.64780595e-02]
mat_Sqrt:  [[ 2.02959698e+01  0.00000000e+00]
 [-7.63969209e-03  1.75047336e-02]]
grads:  [ -0.02491829 -21.26146505]
Stock Position:  -0.024918288394651402
Bond Position:  [-2.29859765]


portfolio before change:  [-4.88587331]
curr_Stock_Price:  103.78425791138172
curr_Factors:  [1.03784258e+02 3.48865555e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.88587331]
Stock Price:  103.2077915586957
PL:  [-8.09366487]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.80832254e-02 -2.66260857e-01]
 [-3.22229877e-01 -2.83967521e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [-2.54649391e-01 -2.88281991e-02]
 [-1.16973193e-01 -1.10287854e-02]
 [ 8.82568178e-02 -1.59084293e-01]
 [ 2.54373950e-01 -1.34515859e-01]
 [ 5.23493922e-02 -1.24623785e-01]
 [ 1.65471533e-02 -5.15627563e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.2101056]
curr_Stock_Price:  99.96328961209791
curr_Factors:  [9.99632896e+01 3.97258527e-02]
mat_Sqrt:  [[ 1.99240285e+01  0.00000000e+00]
 [-7.97253813e-03  1.82673797e-02]]
grads:  [-8.74767824e-03 -1.45757553e+01]
Stock Position:  -0.00874767823734013
Bond Position:  [3.08455229]


portfolio before change:  [2.19566296]
curr_Stock_Price:  101.79066570678607
curr_Factors:  [1.01790666e+02 3.75798626e-02]
mat_Sqrt:  [[ 1.97326562e+01  0.00000000e+00]
 [-7.75421047e-03  1.77671282e-02]]
grads:  [-0.01695784 -1.59827473]
Stock Position:  -0.01695784051959283
Bond Position:  [3.92181284]


portfolio before change:  [2.17487448]
curr_Stock_Price:  103.13222070174837
curr_Factors:  [1.03132221e+02 3.92032114e-02]
mat_Sqrt:  [[ 2.04199743e+01  0.00000000e+00]
 [-7.91992034e-03  1.81468172e-02]]
grads:  [ -0.01754428 -17.09573386]
Stock Position:  -0.0175442815508709
Bond Position:  [3.9842552]


portfolio before change:  [2.13810254]
curr_Stock_Price:  105.34174803794988
curr_Factors:  [1.05341748e+02 3.88489302e-02]
mat_Sqrt:  [[ 2.07629975e+01  0.00000000e+00]
 [-7.88405278e-03  1.80646343e-02]]
grads:  [-0.01287054 -1.5958363 ]
Stock Position:  -0.012870542795082368
Bond Position:  [3.49390802]


portfolio before change:  [2.14697806]
curr_Stock_Price:  104.78791504126002
curr_Factors:  [1.04787915e+02 4.11186935e-02]
mat_Sqrt:  [[ 2.12486260e+01  0.00000000e+00]
 [-8.11109793e-03  1.85848601e-02]]
grads:  [-0.0057315  -0.59342849]
Stock Position:  -0.00573150234781466
Bond Position:  [2.74757024]


portfolio before change:  [2.16429469]
curr_Stock_Price:  102.00635855213889
curr_Factors:  [1.02006359e+02 4.28614288e-02]
mat_Sqrt:  [[ 2.11183784e+01  0.00000000e+00]
 [-8.28120076e-03  1.89746147e-02]]
grads:  [ 8.91486074e-04 -8.38405922e+00]
Stock Position:  0.0008914860739212728
Bond Position:  [2.07335744]


portfolio before change:  [2.16416191]
curr_Stock_Price:  100.6942551609439
curr_Factors:  [1.00694255e+02 4.25518971e-02]
mat_Sqrt:  [[ 2.07713229e+01  0.00000000e+00]
 [-8.25124447e-03  1.89059762e-02]]
grads:  [ 0.00942003 -7.11499145]
Stock Position:  0.009420026703657132
Bond Position:  [1.21561933]


portfolio before change:  [2.1347463]
curr_Stock_Price:  97.50704951068037
curr_Factors:  [9.75070495e+01 4.48218313e-02]
mat_Sqrt:  [[ 2.06433803e+01  0.00000000e+00]
 [-8.46846680e-03  1.94036951e-02]]
grads:  [-9.88639869e-05 -6.42268315e+00]
Stock Position:  -9.886398692738714e-05
Bond Position:  [2.14438624]


portfolio before change:  [2.13584175]
curr_Stock_Price:  97.27458137499784
curr_Factors:  [9.72745814e+01 4.76896278e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.13584175]
Stock Price:  96.51224238157066
PL:  [2.13584175]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.66635548e-02 -3.44580109e-01]
 [-3.80034097e-01 -6.57191241e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [-6.48035503e-02  4.28061386e-02]
 [-6.16936678e-02 -3.66095238e-03]
 [ 9.27534047e-02 -1.77531495e-01]
 [ 1.47187426e-01  9.31702917e-02]
 [-2.99953037e-01 -3.31002429e-01]
 [ 3.35555072e-02 -3.74816970e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.82352504]
curr_Stock_Price:  101.35891144566212
curr_Factors:  [1.01358911e+02 3.87921102e-02]
mat_Sqrt:  [[ 1.99633601e+01  0.00000000e+00]
 [-7.87828512e-03  1.80514189e-02]]
grads:  [-1.08724505e-02 -1.90888101e+01]
Stock Position:  -0.010872450459226852
Bond Position:  [12.92554478]


portfolio before change:  [11.82034724]
curr_Stock_Price:  102.24575714627314
curr_Factors:  [1.02245757e+02 3.97982858e-02]
mat_Sqrt:  [[ 2.03975252e+01  0.00000000e+00]
 [-7.97980308e-03  1.82840258e-02]]
grads:  [-0.02003754 -3.59434649]
Stock Position:  -0.020037542298646915
Bond Position:  [13.86910092]


portfolio before change:  [11.81118795]
curr_Stock_Price:  103.04902803043036
curr_Factors:  [1.03049028e+02 3.86374844e-02]
mat_Sqrt:  [[ 2.02557497e+01  0.00000000e+00]
 [-7.86256797e-03  1.80154064e-02]]
grads:  [ -0.01768652 -17.22043623]
Stock Position:  -0.017686522806454327
Bond Position:  [13.63376693]


portfolio before change:  [11.81255709]
curr_Stock_Price:  103.35714115959223
curr_Factors:  [1.03357141e+02 3.84217049e-02]
mat_Sqrt:  [[ 2.02595038e+01  0.00000000e+00]
 [-7.84058211e-03  1.79650305e-02]]
grads:  [-2.27653255e-03  2.38274789e+00]
Stock Position:  -0.002276532546909852
Bond Position:  [12.04785298]


portfolio before change:  [11.81841995]
curr_Stock_Price:  103.42855199194916
curr_Factors:  [1.03428552e+02 3.90411865e-02]
mat_Sqrt:  [[ 2.04362849e+01  0.00000000e+00]
 [-7.90353708e-03  1.81092785e-02]]
grads:  [-0.00309701 -0.20215893]
Stock Position:  -0.003097012921296962
Bond Position:  [12.13873951]


portfolio before change:  [11.82184216]
curr_Stock_Price:  104.2837872547098
curr_Factors:  [1.04283787e+02 3.81421398e-02]
mat_Sqrt:  [[ 2.03666369e+01  0.00000000e+00]
 [-7.81200510e-03  1.78995523e-02]]
grads:  [ 7.49868920e-04 -9.91820866e+00]
Stock Position:  0.0007498689203532773
Bond Position:  [11.74364299]


portfolio before change:  [11.82809359]
curr_Stock_Price:  104.78805560785815
curr_Factors:  [1.04788056e+02 3.98804992e-02]
mat_Sqrt:  [[ 2.09262821e+01  0.00000000e+00]
 [-7.98804098e-03  1.83029012e-02]]
grads:  [0.00897676 5.09046575]
Stock Position:  0.00897676303695688
Bond Position:  [10.88743605]


portfolio before change:  [11.83939807]
curr_Stock_Price:  105.44078534419171
curr_Factors:  [1.05440785e+02 4.18191716e-02]
mat_Sqrt:  [[ 2.15623626e+01  0.00000000e+00]
 [-8.17989453e-03  1.87424929e-02]]
grads:  [ -0.02061065 -17.66053376]
Stock Position:  -0.02061065147635674
Bond Position:  [14.01260135]


portfolio before change:  [11.86742448]
curr_Stock_Price:  104.4210037845415
curr_Factors:  [1.04421004e+02 4.05852976e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.86742448]
Stock Price:  104.21795103293857
PL:  [7.64947345]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.89801787e-02 -2.81591460e-01]
 [ 1.39593657e-02 -5.15445676e-01]
 [ 2.39494289e-01  1.55693542e-01]
 [ 2.24094084e-01  1.58095743e-01]
 [-1.29217852e-03 -3.92999098e-02]
 [ 7.90638367e-02 -1.10342332e-01]
 [ 6.37148082e-02 -3.28905218e-01]
 [ 5.45727508e-02 -1.18795425e-01]
 [ 8.78617132e-03  1.40512505e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.46338945]
curr_Stock_Price:  96.81685424658603
curr_Factors:  [9.68168542e+01 4.21891134e-02]
mat_Sqrt:  [[ 1.98861709e+01  0.00000000e+00]
 [-8.21599546e-03  1.88252106e-02]]
grads:  [-1.70552743e-03 -1.49582104e+01]
Stock Position:  -0.0017055274332183096
Bond Position:  [-19.29826565]


portfolio before change:  [-19.47195335]
curr_Stock_Price:  96.17913336178954
curr_Factors:  [9.61791334e+01 4.40934237e-02]
mat_Sqrt:  [[ 2.01961120e+01  0.00000000e+00]
 [-8.39937366e-03  1.92453828e-02]]
grads:  [-1.04475342e-02 -2.67828227e+01]
Stock Position:  -0.01044753417335799
Bond Position:  [-18.46711856]


portfolio before change:  [-19.50385479]
curr_Stock_Price:  98.34859945375108
curr_Factors:  [9.83485995e+01 4.23290827e-02]
mat_Sqrt:  [[ 2.02342731e+01  0.00000000e+00]
 [-8.22961313e-03  1.88564126e-02]]
grads:  [0.01519425 8.25679546]
Stock Position:  0.015194245903369574
Bond Position:  [-20.99818759]


portfolio before change:  [-19.53481362]
curr_Stock_Price:  97.00222669891527
curr_Factors:  [9.70022267e+01 4.39618269e-02]
mat_Sqrt:  [[ 2.03385304e+01  0.00000000e+00]
 [-8.38683034e-03  1.92166424e-02]]
grads:  [0.01441071 8.22702214]
Stock Position:  0.014410712886083674
Bond Position:  [-20.93268486]


portfolio before change:  [-19.52527862]
curr_Stock_Price:  98.3903582710592
curr_Factors:  [9.83903583e+01 4.47171800e-02]
mat_Sqrt:  [[ 2.08060552e+01  0.00000000e+00]
 [-8.45857482e-03  1.93810297e-02]]
grads:  [-8.86475845e-04 -2.02775139e+00]
Stock Position:  -0.0008864758447869356
Bond Position:  [-19.43805794]


portfolio before change:  [-19.53042638]
curr_Stock_Price:  93.23094415157024
curr_Factors:  [9.32309442e+01 4.58623458e-02]
mat_Sqrt:  [[ 1.99658689e+01  0.00000000e+00]
 [-8.56619830e-03  1.96276261e-02]]
grads:  [ 1.54796643e-03 -5.62178697e+00]
Stock Position:  0.001547966428601286
Bond Position:  [-19.67474475]


portfolio before change:  [-19.54089192]
curr_Stock_Price:  92.82673229926372
curr_Factors:  [9.28267323e+01 4.37196170e-02]
mat_Sqrt:  [[ 1.94093610e+01  0.00000000e+00]
 [-8.36369459e-03  1.91636318e-02]]
grads:  [-4.11302554e-03 -1.71629899e+01]
Stock Position:  -0.004113025536528884
Bond Position:  [-19.1590932]


portfolio before change:  [-19.55282113]
curr_Stock_Price:  93.39742300755357
curr_Factors:  [9.33974230e+01 4.05832108e-02]
mat_Sqrt:  [[ 1.88151678e+01  0.00000000e+00]
 [-8.05811003e-03  1.84634496e-02]]
grads:  [ 1.44892501e-04 -6.43408614e+00]
Stock Position:  0.0001448925008060595
Bond Position:  [-19.56635371]


portfolio before change:  [-19.56253588]
curr_Stock_Price:  93.88655338816775
curr_Factors:  [9.38865534e+01 3.84842537e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.56253588]
Stock Price:  94.06335399494863
PL:  [-19.56253588]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-2.04465023e-02 -1.21001502e-01]
 [ 2.59878009e-01  1.62636108e-01]
 [ 2.18869888e-01  1.52277238e-01]
 [ 4.69139134e-01 -2.97916065e-01]
 [ 7.96281807e-02 -1.28035431e-01]
 [ 3.25096258e-02 -3.54774766e-01]
 [ 5.40320873e-02 -1.20212732e-01]
 [ 1.99888929e-02  4.98018170e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.91687302]
curr_Stock_Price:  98.92863518667126
curr_Factors:  [9.89286352e+01 4.07547036e-02]
mat_Sqrt:  [[ 1.99715093e+01  0.00000000e+00]
 [-8.07511769e-03  1.85024190e-02]]
grads:  [-6.65338532e-03 -1.02913923e+01]
Stock Position:  -0.006653385321527105
Bond Position:  [-4.25866269]


portfolio before change:  [-4.9121052]
curr_Stock_Price:  97.89191755416671
curr_Factors:  [9.78919176e+01 4.06236396e-02]
mat_Sqrt:  [[ 1.97304164e+01  0.00000000e+00]
 [-8.06212276e-03  1.84726439e-02]]
grads:  [-3.71284041e-03 -6.55030773e+00]
Stock Position:  -0.003712840408028364
Bond Position:  [-4.54864813]


portfolio before change:  [-4.90845893]
curr_Stock_Price:  96.2971392014291
curr_Factors:  [9.62971392e+01 4.25603845e-02]
mat_Sqrt:  [[ 1.98662619e+01  0.00000000e+00]
 [-8.25206733e-03  1.89078616e-02]]
grads:  [0.01665428 8.60150722]
Stock Position:  0.01665427683133029
Bond Position:  [-6.51221815]


portfolio before change:  [-4.92280433]
curr_Stock_Price:  95.63133589306187
curr_Factors:  [9.56313359e+01 4.24255831e-02]
mat_Sqrt:  [[ 1.96976371e+01  0.00000000e+00]
 [-8.23898859e-03  1.88778944e-02]]
grads:  [0.01448545 8.06643128]
Stock Position:  0.014485449262078615
Bond Position:  [-6.30806719]


portfolio before change:  [-4.98333004]
curr_Stock_Price:  91.67074828144153
curr_Factors:  [9.16707483e+01 4.59551081e-02]
mat_Sqrt:  [[ 1.96515890e+01  0.00000000e+00]
 [-8.57485702e-03  1.96474657e-02]]
grads:  [  0.01725651 -15.16307853]
Stock Position:  0.0172565131311979
Bond Position:  [-6.56524751]


portfolio before change:  [-4.98365175]
curr_Stock_Price:  91.84237864575859
curr_Factors:  [9.18423786e+01 4.59281054e-02]
mat_Sqrt:  [[ 1.96825965e+01  0.00000000e+00]
 [-8.57233741e-03  1.96416925e-02]]
grads:  [ 1.20659575e-03 -6.51855390e+00]
Stock Position:  0.0012065957484731905
Bond Position:  [-5.09446837]


portfolio before change:  [-4.98666828]
curr_Stock_Price:  91.45396125380124
curr_Factors:  [9.14539613e+01 4.35553862e-02]
mat_Sqrt:  [[ 1.90863751e+01  0.00000000e+00]
 [-8.34797089e-03  1.91276042e-02]]
grads:  [-6.40911514e-03 -1.85477889e+01]
Stock Position:  -0.006409115135919039
Bond Position:  [-4.40052931]


portfolio before change:  [-5.00624741]
curr_Stock_Price:  94.16546186899643
curr_Factors:  [9.41654619e+01 3.94272620e-02]
mat_Sqrt:  [[ 1.86977759e+01  0.00000000e+00]
 [-7.94251970e-03  1.81985989e-02]]
grads:  [ 8.38040726e-05 -6.60560370e+00]
Stock Position:  8.380407261313996e-05
Bond Position:  [-5.01413886]


portfolio before change:  [-5.00891935]
curr_Stock_Price:  92.20559764193627
curr_Factors:  [9.22055976e+01 4.25551611e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.00891935]
Stock Price:  92.85412355219984
PL:  [-5.00891935]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.80937243e-02 -2.81008968e-01]
 [ 1.73263976e-02 -5.54046827e-01]
 [ 2.48327373e-01  1.58702034e-01]
 [ 1.94740385e-01  1.63152510e-01]
 [-9.77143840e-03 -3.19033352e-02]
 [ 8.75534137e-02 -1.46337421e-01]
 [ 1.41576253e-01  1.28466034e-01]
 [-4.45804349e-01 -4.64054038e-01]
 [ 2.60651794e-02 -1.14365883e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.66828164]
curr_Stock_Price:  96.93228349904287
curr_Factors:  [9.69322835e+01 4.61318064e-02]
mat_Sqrt:  [[ 2.08194223e+01  0.00000000e+00]
 [-8.59132646e-03  1.96852019e-02]]
grads:  [-1.65944297e-03 -1.42751377e+01]
Stock Position:  -0.0016594429671072633
Bond Position:  [-18.50742805]


portfolio before change:  [-18.6760073]
curr_Stock_Price:  96.0100660227879
curr_Factors:  [9.60100660e+01 4.49195655e-02]
mat_Sqrt:  [[ 2.03486003e+01  0.00000000e+00]
 [-8.47769455e-03  1.94248385e-02]]
grads:  [-1.10316905e-02 -2.85225963e+01]
Stock Position:  -0.011031690532757984
Bond Position:  [-17.61685397]


portfolio before change:  [-18.70085413]
curr_Stock_Price:  97.46371479935326
curr_Factors:  [9.74637148e+01 4.58170233e-02]
mat_Sqrt:  [[ 2.08620218e+01  0.00000000e+00]
 [-8.56196457e-03  1.96179254e-02]]
grads:  [0.01522339 8.08964411]
Stock Position:  0.015223386425224536
Bond Position:  [-20.18458193]


portfolio before change:  [-18.68182833]
curr_Stock_Price:  99.37660170388453
curr_Factors:  [9.93766017e+01 4.31953402e-02]
mat_Sqrt:  [[ 2.06539248e+01  0.00000000e+00]
 [-8.31339547e-03  1.90483820e-02]]
grads:  [0.01287629 8.56516366]
Stock Position:  0.012876292569565868
Bond Position:  [-19.96143053]


portfolio before change:  [-18.70222735]
curr_Stock_Price:  98.5676881336192
curr_Factors:  [9.85676881e+01 4.41594983e-02]
mat_Sqrt:  [[ 2.07131732e+01  0.00000000e+00]
 [-8.40566460e-03  1.92597971e-02]]
grads:  [-1.14396743e-03 -1.65647306e+00]
Stock Position:  -0.0011439674256709636
Bond Position:  [-18.58946913]


portfolio before change:  [-18.71676036]
curr_Stock_Price:  103.14469662260534
curr_Factors:  [1.03144697e+02 4.29733654e-02]
mat_Sqrt:  [[ 2.13819144e+01  0.00000000e+00]
 [-8.29200727e-03  1.89993755e-02]]
grads:  [ 1.10778327e-03 -7.70222269e+00]
Stock Position:  0.0011077832745703057
Bond Position:  [-18.83102233]


portfolio before change:  [-18.72274447]
curr_Stock_Price:  106.24435923946234
curr_Factors:  [1.06244359e+02 4.20586592e-02]
mat_Sqrt:  [[ 2.17888141e+01  0.00000000e+00]
 [-8.20328317e-03  1.87960830e-02]]
grads:  [0.00907087 6.83472371]
Stock Position:  0.009070866632005396
Bond Position:  [-19.68647288]


portfolio before change:  [-18.71449665]
curr_Stock_Price:  108.23904342263847
curr_Factors:  [1.08239043e+02 4.17832677e-02]
mat_Sqrt:  [[ 2.21250951e+01  0.00000000e+00]
 [-8.17638235e-03  1.87344455e-02]]
grads:  [ -0.02930311 -24.77009728]
Stock Position:  -0.02930311176411842
Bond Position:  [-15.54275587]


portfolio before change:  [-18.67768312]
curr_Stock_Price:  106.71746931557236
curr_Factors:  [1.06717469e+02 4.42090558e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.67768312]
Stock Price:  106.76969245491483
PL:  [-25.44737557]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 9.94105788e-04 -2.23775511e-01]
 [-2.25971845e-03  8.09689767e-02]
 [ 2.33377592e-01  1.53610233e-01]
 [ 1.66161011e-01  1.57090291e-01]
 [ 4.53125359e-02 -2.13062621e-02]
 [ 7.66929301e-02 -3.60105628e-02]
 [ 2.35542537e-01 -1.60020998e-01]
 [ 8.66717538e-02  5.43741245e-02]
 [ 5.33255941e-02 -8.44186569e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.40129894]
curr_Stock_Price:  98.27761160735963
curr_Factors:  [9.82776116e+01 4.16452455e-02]
mat_Sqrt:  [[ 2.00556761e+01  0.00000000e+00]
 [-8.16286671e-03  1.87034773e-02]]
grads:  [-4.82005861e-03 -1.19643801e+01]
Stock Position:  -0.004820058607084336
Bond Position:  [-8.92759509]


portfolio before change:  [-9.41250773]
curr_Stock_Price:  99.67673892172468
curr_Factors:  [9.96767389e+01 3.92839279e-02]
mat_Sqrt:  [[ 1.97561026e+01  0.00000000e+00]
 [-7.92806942e-03  1.81654891e-02]]
grads:  [1.67432012e-03 4.45729681e+00]
Stock Position:  0.001674320116927345
Bond Position:  [-9.5793985]


portfolio before change:  [-9.41850009]
curr_Stock_Price:  98.95915820773355
curr_Factors:  [9.89591582e+01 3.80918977e-02]
mat_Sqrt:  [[ 1.93140031e+01  0.00000000e+00]
 [-7.80685829e-03  1.78877595e-02]]
grads:  [0.01555444 8.58744959]
Stock Position:  0.01555444474989701
Bond Position:  [-10.95775485]


portfolio before change:  [-9.40664926]
curr_Stock_Price:  100.0733783645621
curr_Factors:  [1.00073378e+02 3.42328797e-02]
mat_Sqrt:  [[ 1.85157061e+01  0.00000000e+00]
 [-7.40085181e-03  1.69574818e-02]]
grads:  [0.01267685 9.26377472]
Stock Position:  0.012676850314310595
Bond Position:  [-10.6752645]


portfolio before change:  [-9.41377355]
curr_Stock_Price:  99.93254528267347
curr_Factors:  [9.99325453e+01 3.39200093e-02]
mat_Sqrt:  [[ 1.84049622e+01  0.00000000e+00]
 [-7.36695425e-03  1.68798127e-02]]
grads:  [ 0.00195674 -1.26223332]
Stock Position:  0.001956739728969032
Bond Position:  [-9.60931553]


portfolio before change:  [-9.42029509]
curr_Stock_Price:  99.0557368356004
curr_Factors:  [9.90557368e+01 3.52562549e-02]
mat_Sqrt:  [[ 1.85993481e+01  0.00000000e+00]
 [-7.51065962e-03  1.72090831e-02]]
grads:  [ 0.00327843 -2.09253233]
Stock Position:  0.003278428459157341
Bond Position:  [-9.74504224]


portfolio before change:  [-9.42535201]
curr_Stock_Price:  98.9998638613867
curr_Factors:  [9.89998639e+01 3.65605456e-02]
mat_Sqrt:  [[ 1.89295780e+01  0.00000000e+00]
 [-7.64832485e-03  1.75245138e-02]]
grads:  [ 8.75368951e-03 -9.13126604e+00]
Stock Position:  0.008753689506039643
Bond Position:  [-10.29196608]


portfolio before change:  [-9.4221238]
curr_Stock_Price:  99.95665781742069
curr_Factors:  [9.99566578e+01 3.76213135e-02]
mat_Sqrt:  [[ 1.93878077e+01  0.00000000e+00]
 [-7.75848579e-03  1.77769242e-02]]
grads:  [0.00569443 3.05869136]
Stock Position:  0.005694432752827795
Bond Position:  [-9.99132026]


portfolio before change:  [-9.42733778]
curr_Stock_Price:  99.9185385446546
curr_Factors:  [9.99185385e+01 3.70193281e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.42733778]
Stock Price:  95.4552248290315
PL:  [-9.42733778]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-1.73942630e-02 -2.11692452e-01]
 [-2.06121677e-02 -1.19102241e-01]
 [ 2.47331640e-01  1.58362894e-01]
 [ 2.16709533e-01  1.62413310e-01]
 [ 3.53238288e-02 -2.32278929e-02]
 [ 8.82777506e-02 -1.59463631e-01]
 [ 2.28049115e-01 -1.04387853e-01]
 [-3.33558670e-02  1.71555131e-02]
 [ 3.63747333e-02 -7.06359495e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.71008081]
curr_Stock_Price:  98.37795874480743
curr_Factors:  [9.83779587e+01 3.91620652e-02]
mat_Sqrt:  [[ 1.94684152e+01  0.00000000e+00]
 [-7.91576303e-03  1.81372916e-02]]
grads:  [-5.63910426e-03 -1.16716683e+01]
Stock Position:  -0.005639104261713485
Bond Position:  [-8.15531724]


portfolio before change:  [-8.7114895]
curr_Stock_Price:  97.90448253772891
curr_Factors:  [9.79044825e+01 3.91585827e-02]
mat_Sqrt:  [[ 1.93738556e+01  0.00000000e+00]
 [-7.91541106e-03  1.81364852e-02]]
grads:  [-3.74693858e-03 -6.56699683e+00]
Stock Position:  -0.0037469385790890515
Bond Position:  [-8.34464742]


portfolio before change:  [-8.71435774]
curr_Stock_Price:  97.55616420269288
curr_Factors:  [9.75561642e+01 3.93840207e-02]
mat_Sqrt:  [[ 1.93604185e+01  0.00000000e+00]
 [-7.93816309e-03  1.81886166e-02]]
grads:  [0.01634504 8.70670361]
Stock Position:  0.01634504299449746
Bond Position:  [-10.30891744]


portfolio before change:  [-8.71161929]
curr_Stock_Price:  98.03913607018515
curr_Factors:  [9.80391361e+01 4.03975223e-02]
mat_Sqrt:  [[ 1.97050182e+01  0.00000000e+00]
 [-8.03965395e-03  1.84211614e-02]]
grads:  [0.01459489 8.8166705 ]
Stock Position:  0.014594886932961824
Bond Position:  [-10.1424894]


portfolio before change:  [-8.69367786]
curr_Stock_Price:  99.61598612286372
curr_Factors:  [9.96159861e+01 4.31915527e-02]
mat_Sqrt:  [[ 2.07027695e+01  0.00000000e+00]
 [-8.31303099e-03  1.90475469e-02]]
grads:  [ 1.21656889e-03 -1.21946900e+00]
Stock Position:  0.001216568885356054
Bond Position:  [-8.81486757]


portfolio before change:  [-8.69521398]
curr_Stock_Price:  101.97706255527952
curr_Factors:  [1.01977063e+02 3.87140421e-02]
mat_Sqrt:  [[ 2.00648888e+01  0.00000000e+00]
 [-7.87035370e-03  1.80332458e-02]]
grads:  [ 9.31084974e-04 -8.84275812e+00]
Stock Position:  0.0009310849737599211
Bond Position:  [-8.79016329]


portfolio before change:  [-8.70005964]
curr_Stock_Price:  101.4943128776394
curr_Factors:  [1.01494313e+02 3.78350399e-02]
mat_Sqrt:  [[ 1.97418936e+01  0.00000000e+00]
 [-7.78049252e-03  1.78273480e-02]]
grads:  [ 0.00924382 -5.85548974]
Stock Position:  0.009243820511173688
Bond Position:  [-9.63825485]


portfolio before change:  [-8.69918787]
curr_Stock_Price:  102.11008681520008
curr_Factors:  [1.02110087e+02 4.10980272e-02]
mat_Sqrt:  [[ 2.07004189e+01  0.00000000e+00]
 [-8.10905935e-03  1.85801891e-02]]
grads:  [-0.00124966  0.92332285]
Stock Position:  -0.0012496649192785703
Bond Position:  [-8.57158448]


portfolio before change:  [-8.69917631]
curr_Stock_Price:  98.67042423607815
curr_Factors:  [9.86704242e+01 4.57325077e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.69917631]
Stock Price:  96.22641553928368
PL:  [-8.69917631]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.94741130e-02 -2.78956555e-01]
 [-9.68460192e-02  5.88120266e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [-4.46968608e-01 -1.01111220e-01]
 [-3.02411535e-01  3.86860914e-02]
 [ 3.94512344e-01  1.56173617e-01]
 [-5.22484335e-02  3.31889058e-01]
 [-6.71536414e-01 -6.71003353e-01]
 [ 2.38145472e-02  7.10287425e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.10146347]
curr_Stock_Price:  100.09269190363995
curr_Factors:  [1.00092692e+02 3.91940284e-02]
mat_Sqrt:  [[ 1.98158324e+01  0.00000000e+00]
 [-7.91899271e-03  1.81446917e-02]]
grads:  [-9.14524967e-03 -1.53740036e+01]
Stock Position:  -0.009145249674306804
Bond Position:  [4.01683613]


portfolio before change:  [3.10136558]
curr_Stock_Price:  100.32306443529079
curr_Factors:  [1.00323064e+02 3.89495625e-02]
mat_Sqrt:  [[ 1.97994024e+01  0.00000000e+00]
 [-7.89425740e-03  1.80880161e-02]]
grads:  [-0.00359497  3.251436  ]
Stock Position:  -0.00359497449630084
Bond Position:  [3.46202443]


portfolio before change:  [3.09350655]
curr_Stock_Price:  102.99080897323805
curr_Factors:  [1.02990809e+02 4.09109496e-02]
mat_Sqrt:  [[ 2.08313900e+01  0.00000000e+00]
 [-8.09058214e-03  1.85378525e-02]]
grads:  [ -0.01719779 -16.73511844]
Stock Position:  -0.017197785589389863
Bond Position:  [4.8647204]


portfolio before change:  [3.020922]
curr_Stock_Price:  107.35285409793823
curr_Factors:  [1.07352854e+02 4.15328229e-02]
mat_Sqrt:  [[ 2.18780858e+01  0.00000000e+00]
 [-8.15184130e-03  1.86782149e-02]]
grads:  [-0.02244699 -5.41332349]
Stock Position:  -0.022446989531717698
Bond Position:  [5.43067039]


portfolio before change:  [2.97470516]
curr_Stock_Price:  109.53278334242643
curr_Factors:  [1.09532783e+02 4.31111288e-02]
mat_Sqrt:  [[ 2.27425323e+01  0.00000000e+00]
 [-8.30528784e-03  1.90298051e-02]]
grads:  [-0.01255478  2.03292105]
Stock Position:  -0.012554782227013462
Bond Position:  [4.34986541]


portfolio before change:  [3.00396909]
curr_Stock_Price:  107.3751633101907
curr_Factors:  [1.07375163e+02 4.20643687e-02]
mat_Sqrt:  [[ 2.20222164e+01  0.00000000e+00]
 [-8.20383995e-03  1.87973588e-02]]
grads:  [0.02100933 8.3082745 ]
Stock Position:  0.021009333966161305
Bond Position:  [0.74808842]


portfolio before change:  [3.09193156]
curr_Stock_Price:  111.54418330684577
curr_Factors:  [1.11544183e+02 3.75651618e-02]
mat_Sqrt:  [[ 2.16191971e+01  0.00000000e+00]
 [-7.75269366e-03  1.77636528e-02]]
grads:  [4.28322228e-03 1.86836042e+01]
Stock Position:  0.004283222281138314
Bond Position:  [2.61416303]


portfolio before change:  [3.09761401]
curr_Stock_Price:  112.56561994217125
curr_Factors:  [1.12565620e+02 3.83521298e-02]
mat_Sqrt:  [[ 2.20445131e+01  0.00000000e+00]
 [-7.83347992e-03  1.79487573e-02]]
grads:  [ -0.04374723 -37.38439049]
Stock Position:  -0.04374722554119876
Bond Position:  [8.02204757]


portfolio before change:  [3.09844559]
curr_Stock_Price:  112.63832053995573
curr_Factors:  [1.12638321e+02 3.89493838e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.09844559]
Stock Price:  114.11430429416022
PL:  [-11.01585871]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.30400996e-02 -4.02783727e-01]
 [-3.60558963e-02  3.52101865e-02]
 [ 2.67573620e-01  1.65257185e-01]
 [ 2.08099186e-01  1.64426092e-01]
 [ 1.63652630e-02 -5.31113936e-02]
 [ 7.68959538e-02 -4.23756840e-02]
 [ 2.23567831e-01 -9.63471981e-02]
 [-3.06428534e-02  1.18821157e-02]
 [ 4.82355464e-02 -7.23341696e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.89668578]
curr_Stock_Price:  102.67610157930874
curr_Factors:  [1.02676102e+02 4.16240756e-02]
mat_Sqrt:  [[ 2.09479569e+01  0.00000000e+00]
 [-8.16079168e-03  1.86987228e-02]]
grads:  [-1.18784534e-02 -2.15407079e+01]
Stock Position:  -0.011878453390886957
Bond Position:  [22.11631907]


portfolio before change:  [20.95675265]
curr_Stock_Price:  98.55048495302465
curr_Factors:  [9.85504850e+01 4.28735571e-02]
mat_Sqrt:  [[ 2.04057952e+01  0.00000000e+00]
 [-8.28237233e-03  1.89772991e-02]]
grads:  [-1.01387429e-03  1.85538450e+00]
Stock Position:  -0.0010138742850387091
Bond Position:  [21.05667045]


portfolio before change:  [20.97035313]
curr_Stock_Price:  95.52297708002942
curr_Factors:  [9.55229771e+01 4.29292063e-02]
mat_Sqrt:  [[ 1.97917537e+01  0.00000000e+00]
 [-8.28774578e-03  1.89896112e-02]]
grads:  [0.0171636  8.70250491]
Stock Position:  0.01716360118432038
Bond Position:  [19.33083485]


portfolio before change:  [21.03630382]
curr_Stock_Price:  98.80217539337035
curr_Factors:  [9.88021754e+01 4.01923098e-02]
mat_Sqrt:  [[ 1.98078797e+01  0.00000000e+00]
 [-8.01920792e-03  1.83743137e-02]]
grads:  [0.01412875 8.94869299]
Stock Position:  0.014128751784126887
Bond Position:  [19.64035241]


portfolio before change:  [21.03592747]
curr_Stock_Price:  98.08031518865013
curr_Factors:  [9.80803152e+01 3.96408199e-02]
mat_Sqrt:  [[ 1.95277932e+01  0.00000000e+00]
 [-7.96400100e-03  1.82478187e-02]]
grads:  [-3.48961579e-04 -2.91056123e+00]
Stock Position:  -0.0003489615788032847
Bond Position:  [21.07015373]


portfolio before change:  [21.04629679]
curr_Stock_Price:  98.56286326148272
curr_Factors:  [9.85628633e+01 4.30937900e-02]
mat_Sqrt:  [[ 2.04607080e+01  0.00000000e+00]
 [-8.30361752e-03  1.90259779e-02]]
grads:  [ 0.00285433 -2.22725392]
Stock Position:  0.002854333736952182
Bond Position:  [20.76496548]


portfolio before change:  [21.06539293]
curr_Stock_Price:  101.6147384202964
curr_Factors:  [1.01614738e+02 4.27076481e-02]
mat_Sqrt:  [[ 2.09995279e+01  0.00000000e+00]
 [-8.26633153e-03  1.89405450e-02]]
grads:  [ 0.00864393 -5.08682291]
Stock Position:  0.008643930809250392
Bond Position:  [20.18704217]


portfolio before change:  [21.07910225]
curr_Stock_Price:  102.03275058833603
curr_Factors:  [1.02032751e+02 4.44957922e-02]
mat_Sqrt:  [[ 2.15228147e+01  0.00000000e+00]
 [-8.43761029e-03  1.93329939e-02]]
grads:  [-0.00118279  0.61460298]
Stock Position:  -0.001182794786002379
Bond Position:  [21.19978605]


portfolio before change:  [21.09082961]
curr_Stock_Price:  101.08177023674546
curr_Factors:  [1.01081770e+02 4.44690569e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.09082961]
Stock Price:  100.33264583280298
PL:  [20.75818377]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.13349429e-02 -3.87219453e-01]
 [-2.84747729e-02 -2.89618370e-02]
 [ 2.28081952e-01  1.51806571e-01]
 [ 2.14180429e-01  1.63891084e-01]
 [ 4.52859254e-02 -2.10188929e-02]
 [ 8.76572489e-02 -1.48219090e-01]
 [ 1.55030359e-01  6.62049535e-02]
 [-1.50676438e-01 -8.82168548e-02]
 [ 3.55008054e-02 -4.21001078e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.46885577]
curr_Stock_Price:  102.32364295701606
curr_Factors:  [1.02323643e+02 3.69487927e-02]
mat_Sqrt:  [[ 1.96687210e+01  0.00000000e+00]
 [-7.68882749e-03  1.76173170e-02]]
grads:  [-1.22189626e-02 -2.19794792e+01]
Stock Position:  -0.012218962644273171
Bond Position:  [19.71914454]


portfolio before change:  [18.52781628]
curr_Stock_Price:  98.30542331004813
curr_Factors:  [9.83054233e+01 3.51701449e-02]
mat_Sqrt:  [[ 1.84359090e+01  0.00000000e+00]
 [-7.50148198e-03  1.71880545e-02]]
grads:  [-0.00223015 -1.68499797]
Stock Position:  -0.002230145244392574
Bond Position:  [18.74705166]


portfolio before change:  [18.53455489]
curr_Stock_Price:  99.48797724339417
curr_Factors:  [9.94879772e+01 3.46028621e-02]
mat_Sqrt:  [[ 1.85065989e+01  0.00000000e+00]
 [-7.44073783e-03  1.70488722e-02]]
grads:  [0.01590437 8.90420023]
Stock Position:  0.015904368672903423
Bond Position:  [16.95226142]


portfolio before change:  [18.52573254]
curr_Stock_Price:  98.40018820375731
curr_Factors:  [9.84001882e+01 3.58414523e-02]
mat_Sqrt:  [[ 1.86289651e+01  0.00000000e+00]
 [-7.57273555e-03  1.73513169e-02]]
grads:  [0.01533678 9.44545502]
Stock Position:  0.015336781206032782
Bond Position:  [17.01659038]


portfolio before change:  [18.56455687]
curr_Stock_Price:  100.37673789486716
curr_Factors:  [1.00376738e+02 3.55032953e-02]
mat_Sqrt:  [[ 1.89133043e+01  0.00000000e+00]
 [-7.53692726e-03  1.72692698e-02]]
grads:  [ 0.00190937 -1.2171269 ]
Stock Position:  0.0019093717234616389
Bond Position:  [18.37290037]


portfolio before change:  [18.57872791]
curr_Stock_Price:  102.98612398090638
curr_Factors:  [1.02986124e+02 3.43914858e-02]
mat_Sqrt:  [[ 1.90987165e+01  0.00000000e+00]
 [-7.41797663e-03  1.69967197e-02]]
grads:  [ 1.20265331e-03 -8.72045269e+00]
Stock Position:  0.001202653308080889
Bond Position:  [18.4548713]


portfolio before change:  [18.58936723]
curr_Stock_Price:  104.15817983621933
curr_Factors:  [1.0415818e+02 3.4913292e-02]
mat_Sqrt:  [[ 1.94620589e+01  0.00000000e+00]
 [-7.47403955e-03  1.71251760e-02]]
grads:  [0.00945042 3.86594295]
Stock Position:  0.009450416841065573
Bond Position:  [17.60502901]


portfolio before change:  [18.59593319]
curr_Stock_Price:  103.92128515506475
curr_Factors:  [1.03921285e+02 3.69789462e-02]
mat_Sqrt:  [[ 1.99839702e+01  0.00000000e+00]
 [-7.69196424e-03  1.76245042e-02]]
grads:  [-0.00946646 -5.00535242]
Stock Position:  -0.009466458751646532
Bond Position:  [19.57969975]


portfolio before change:  [18.6052061]
curr_Stock_Price:  103.97615170811055
curr_Factors:  [1.03976152e+02 3.72636326e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.6052061]
Stock Price:  102.82804107197836
PL:  [15.77716502]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.18915615e-02 -3.92300139e-01]
 [-5.69738822e-01 -1.88640459e-01]
 [-6.17037235e-02 -1.35682890e-01]
 [ 4.14479470e-03  7.88677138e-02]
 [ 2.29226682e-02 -2.56136322e-02]
 [ 7.70012807e-02 -4.56778544e-02]
 [ 1.69271414e-01 -2.35162407e-01]
 [ 5.51543632e-02 -1.17270774e-01]
 [ 1.75354615e-02  4.19724223e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.26247073]
curr_Stock_Price:  102.43885548544016
curr_Factors:  [1.02438855e+02 4.12019895e-02]
mat_Sqrt:  [[ 2.07933187e+01  0.00000000e+00]
 [-8.11930928e-03  1.86036747e-02]]
grads:  [-1.16915141e-02 -2.10872392e+01]
Stock Position:  -0.011691514070015483
Bond Position:  [20.46013605]


portfolio before change:  [19.25740398]
curr_Stock_Price:  103.74744339627948
curr_Factors:  [1.03747443e+02 4.04732067e-02]
mat_Sqrt:  [[ 2.08718628e+01  0.00000000e+00]
 [-8.04718154e-03  1.84384093e-02]]
grads:  [ -0.0312415  -10.23084236]
Stock Position:  -0.031241498418106892
Bond Position:  [22.49862957]


portfolio before change:  [19.33471422]
curr_Stock_Price:  101.63300843076608
curr_Factors:  [1.01633008e+02 4.37832036e-02]
mat_Sqrt:  [[ 2.12661342e+01  0.00000000e+00]
 [-8.36977454e-03  1.91775627e-02]]
grads:  [-5.68606361e-03 -7.07508521e+00]
Stock Position:  -0.00568606360904159
Bond Position:  [19.91260597]


portfolio before change:  [19.33995097]
curr_Stock_Price:  102.46346739744216
curr_Factors:  [1.02463467e+02 4.56136551e-02]
mat_Sqrt:  [[ 2.18834850e+01  0.00000000e+00]
 [-8.54294142e-03  1.95743379e-02]]
grads:  [1.76231011e-03 4.02913827e+00]
Stock Position:  0.0017623101133707993
Bond Position:  [19.15937857]


portfolio before change:  [19.34395824]
curr_Stock_Price:  99.30010877283492
curr_Factors:  [9.93001088e+01 4.56483125e-02]
mat_Sqrt:  [[ 2.12159307e+01  0.00000000e+00]
 [-8.54618628e-03  1.95817728e-02]]
grads:  [ 5.53544540e-04 -1.30803439e+00]
Stock Position:  0.0005535445401971269
Bond Position:  [19.28899121]


portfolio before change:  [19.35305501]
curr_Stock_Price:  98.30626627250572
curr_Factors:  [9.83062663e+01 4.61066000e-02]
mat_Sqrt:  [[ 2.11087614e+01  0.00000000e+00]
 [-8.58897898e-03  1.96798232e-02]]
grads:  [ 0.00270342 -2.32105004]
Stock Position:  0.0027034191935796804
Bond Position:  [19.08729196]


portfolio before change:  [19.35941024]
curr_Stock_Price:  97.12598339357021
curr_Factors:  [9.71259834e+01 4.98482422e-02]
mat_Sqrt:  [[ 2.16850463e+01  0.00000000e+00]
 [-8.93068797e-03  2.04627768e-02]]
grads:  [ 3.07299901e-03 -1.14922041e+01]
Stock Position:  0.003072999008016854
Bond Position:  [19.06094219]


portfolio before change:  [19.35774195]
curr_Stock_Price:  93.48096335219485
curr_Factors:  [9.34809634e+01 5.04267206e-02]
mat_Sqrt:  [[ 2.09919867e+01  0.00000000e+00]
 [-8.98235787e-03  2.05811674e-02]]
grads:  [ 1.89272299e-04 -5.69796510e+00]
Stock Position:  0.00018927229852998745
Bond Position:  [19.3400486]


portfolio before change:  [19.36724254]
curr_Stock_Price:  92.57300092752668
curr_Factors:  [9.25730009e+01 4.72845354e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.36724254]
Stock Price:  93.07900587743302
PL:  [19.36724254]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.46825235e-02 -4.17775391e-01]
 [-6.13476251e-01 -2.17103993e-01]
 [-2.62442245e-01 -2.65792377e-01]
 [ 1.39736046e-01  1.48500782e-01]
 [ 2.95940889e-03 -2.73511957e-03]
 [ 7.71709883e-02 -3.55209401e-02]
 [ 2.27530535e-01 -1.69443089e-01]
 [ 9.33064608e-02  5.81417770e-02]
 [ 3.43561034e-02 -6.89645875e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.23239719]
curr_Stock_Price:  103.01518694379929
curr_Factors:  [1.03015187e+02 3.91393248e-02]
mat_Sqrt:  [[ 2.03801755e+01  0.00000000e+00]
 [-7.91346445e-03  1.81320249e-02]]
grads:  [-1.26110127e-02 -2.30407465e+01]
Stock Position:  -0.012611012711759653
Bond Position:  [24.53152302]


portfolio before change:  [23.23103618]
curr_Stock_Price:  104.09597536595237
curr_Factors:  [1.04095975e+02 3.87551494e-02]
mat_Sqrt:  [[ 2.04926747e+01  0.00000000e+00]
 [-7.87453104e-03  1.80428173e-02]]
grads:  [ -0.03456007 -12.03271028]
Stock Position:  -0.03456006652044976
Bond Position:  [26.82860001]


portfolio before change:  [23.2463215]
curr_Stock_Price:  104.04193413738405
curr_Factors:  [1.04041934e+02 3.93134614e-02]
mat_Sqrt:  [[ 2.06290419e+01  0.00000000e+00]
 [-7.93104900e-03  1.81723162e-02]]
grads:  [ -0.01834518 -14.62622454]
Stock Position:  -0.018345182964247763
Bond Position:  [25.15498982]


portfolio before change:  [23.32287684]
curr_Stock_Price:  100.55465894438484
curr_Factors:  [1.00554659e+02 4.42085088e-02]
mat_Sqrt:  [[ 2.11424412e+01  0.00000000e+00]
 [-8.41032783e-03  1.92704819e-02]]
grads:  [0.00967472 7.70612705]
Stock Position:  0.00967471537094981
Bond Position:  [22.35003914]


portfolio before change:  [23.34700529]
curr_Stock_Price:  101.89326484356265
curr_Factors:  [1.01893265e+02 4.56102691e-02]
mat_Sqrt:  [[ 2.17608971e+01  0.00000000e+00]
 [-8.54262433e-03  1.95736113e-02]]
grads:  [ 8.11411788e-05 -1.39735051e-01]
Stock Position:  8.11411788342945e-05
Bond Position:  [23.33873755]


portfolio before change:  [23.35848829]
curr_Stock_Price:  99.56046380004435
curr_Factors:  [9.95604638e+01 4.54840425e-02]
mat_Sqrt:  [[ 2.12332484e+01  0.00000000e+00]
 [-8.53079528e-03  1.95465075e-02]]
grads:  [ 0.00290433 -1.81725252]
Stock Position:  0.002904330888905136
Bond Position:  [23.06933176]


portfolio before change:  [23.36773182]
curr_Stock_Price:  98.7706042143222
curr_Factors:  [9.87706042e+01 4.69787532e-02]
mat_Sqrt:  [[ 2.14081162e+01  0.00000000e+00]
 [-8.66983305e-03  1.98650831e-02]]
grads:  [ 7.17389174e-03 -8.52969442e+00]
Stock Position:  0.0071738917423822945
Bond Position:  [22.6591622]


portfolio before change:  [23.38676965]
curr_Stock_Price:  99.84469482176954
curr_Factors:  [9.98446948e+01 4.47658662e-02]
mat_Sqrt:  [[ 2.11250862e+01  0.00000000e+00]
 [-8.46317824e-03  1.93915775e-02]]
grads:  [0.00561804 2.99830053]
Stock Position:  0.005618041573206612
Bond Position:  [22.825838]


portfolio before change:  [23.39088627]
curr_Stock_Price:  98.54546027810859
curr_Factors:  [9.85454603e+01 4.58233461e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.39088627]
Stock Price:  98.30673604233994
PL:  [23.39088627]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.42389826e-02 -3.22449178e-01]
 [-8.50181704e-01 -2.85050455e-01]
 [-4.14013530e-01 -9.56296325e-02]
 [-3.00143266e-01 -4.59298128e-02]
 [-2.07039236e-01  6.38373670e-03]
 [ 7.83660398e-01  5.85934680e-01]
 [-1.89587749e-01  4.69420008e-01]
 [-8.37543436e-01 -8.24928369e-01]
 [ 2.47483034e-02  1.23492202e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.37485833]
curr_Stock_Price:  100.85825352784714
curr_Factors:  [1.00858254e+02 4.08304699e-02]
mat_Sqrt:  [[ 2.03799743e+01  0.00000000e+00]
 [-8.08262036e-03  1.85196098e-02]]
grads:  [-1.00572914e-02 -1.74112296e+01]
Stock Position:  -0.010057291426768583
Bond Position:  [9.38921918]


portfolio before change:  [8.32240411]
curr_Stock_Price:  106.54069848409665
curr_Factors:  [1.06540698e+02 3.85426884e-02]
mat_Sqrt:  [[ 2.09163809e+01  0.00000000e+00]
 [-7.85291675e-03  1.79932927e-02]]
grads:  [ -0.04659448 -15.84203954]
Stock Position:  -0.04659448148392512
Bond Position:  [13.28661271]


portfolio before change:  [8.35091405]
curr_Stock_Price:  106.07143738510901
curr_Factors:  [1.06071437e+02 3.62382453e-02]
mat_Sqrt:  [[ 2.01921254e+01  0.00000000e+00]
 [-7.61453823e-03  1.74470989e-02]]
grads:  [-0.02257067 -5.48111941]
Stock Position:  -0.022570666258033046
Bond Position:  [10.74501706]


portfolio before change:  [8.36203251]
curr_Stock_Price:  105.81692093731208
curr_Factors:  [1.05816921e+02 3.66449922e-02]
mat_Sqrt:  [[ 2.02564080e+01  0.00000000e+00]
 [-7.65715270e-03  1.75447409e-02]]
grads:  [-0.01580678 -2.61786783]
Stock Position:  -0.015806784672770066
Bond Position:  [10.03465779]


portfolio before change:  [8.35270736]
curr_Stock_Price:  106.72436233713906
curr_Factors:  [1.06724362e+02 3.65728795e-02]
mat_Sqrt:  [[ 2.04100067e+01  0.00000000e+00]
 [-7.64961484e-03  1.75274695e-02]]
grads:  [-0.0100075   0.36421325]
Stock Position:  -0.010007500145624796
Bond Position:  [9.42075143]


portfolio before change:  [8.31122023]
curr_Stock_Price:  111.34076848567167
curr_Factors:  [1.11340768e+02 3.48112737e-02]
mat_Sqrt:  [[ 2.07737151e+01  0.00000000e+00]
 [-7.46311181e-03  1.71001374e-02]]
grads:  [ 0.05003358 34.26491066]
Stock Position:  0.05003357617349439
Bond Position:  [2.74044341]


portfolio before change:  [8.45405038]
curr_Stock_Price:  114.1680616927657
curr_Factors:  [1.14168062e+02 3.26147787e-02]
mat_Sqrt:  [[ 2.06182521e+01  0.00000000e+00]
 [-7.22382489e-03  1.65518622e-02]]
grads:  [7.41281975e-04 2.83605556e+01]
Stock Position:  0.0007412819746370178
Bond Position:  [8.36941966]


portfolio before change:  [8.45940161]
curr_Stock_Price:  115.74029360834272
curr_Factors:  [1.15740294e+02 3.01398495e-02]
mat_Sqrt:  [[ 2.00934782e+01  0.00000000e+00]
 [-6.94433288e-03  1.59114655e-02]]
grads:  [ -0.05960002 -51.8449018 ]
Stock Position:  -0.05960001959460199
Bond Position:  [15.35752537]


portfolio before change:  [8.47195305]
curr_Stock_Price:  115.65856948454052
curr_Factors:  [1.15658569e+02 3.11390556e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.47195305]
Stock Price:  119.74206626234472
PL:  [-11.27011321]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.51234739e-02 -2.79057206e-01]
 [ 3.69470978e-02 -7.78987262e-01]
 [ 2.80845402e-01  1.69777470e-01]
 [ 2.24863089e-01  1.54531468e-01]
 [ 1.89791911e-01 -1.90945356e-01]
 [ 7.91378118e-02 -1.12661572e-01]
 [ 9.04485323e-02 -3.06865480e-01]
 [ 5.54120429e-02 -1.16595287e-01]
 [ 1.83194799e-02 -5.40125802e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.43901893]
curr_Stock_Price:  97.25591524420258
curr_Factors:  [9.72559152e+01 3.84867005e-02]
mat_Sqrt:  [[ 1.90796922e+01  0.00000000e+00]
 [-7.84721102e-03  1.79802192e-02]]
grads:  [-1.92178549e-03 -1.55202338e+01]
Stock Position:  -0.0019217854894859087
Bond Position:  [-16.25211393]


portfolio before change:  [-16.44290756]
curr_Stock_Price:  95.04991184330422
curr_Factors:  [9.50499118e+01 4.13306132e-02]
mat_Sqrt:  [[ 1.93235824e+01  0.00000000e+00]
 [-8.13197277e-03  1.86326904e-02]]
grads:  [-1.56819170e-02 -4.18075568e+01]
Stock Position:  -0.015681917030057817
Bond Position:  [-14.95234272]


portfolio before change:  [-16.43680558]
curr_Stock_Price:  94.18394552849358
curr_Factors:  [9.41839455e+01 4.03240084e-02]
mat_Sqrt:  [[ 1.89129262e+01  0.00000000e+00]
 [-8.03233549e-03  1.84043927e-02]]
grads:  [0.01876718 9.22483415]
Stock Position:  0.018767183942937957
Bond Position:  [-18.20437301]


portfolio before change:  [-16.40924239]
curr_Stock_Price:  96.13776345759865
curr_Factors:  [9.61377635e+01 4.15123724e-02]
mat_Sqrt:  [[ 1.95876706e+01  0.00000000e+00]
 [-8.14983410e-03  1.86736158e-02]]
grads:  [0.01492297 8.27539079]
Stock Position:  0.014922966455910121
Bond Position:  [-17.84390301]


portfolio before change:  [-16.4352247]
curr_Stock_Price:  94.99468440074158
curr_Factors:  [9.49946844e+01 4.42230893e-02]
mat_Sqrt:  [[ 1.99767044e+01  0.00000000e+00]
 [-8.41171462e-03  1.92736595e-02]]
grads:  [ 5.32903346e-03 -9.90706284e+00]
Stock Position:  0.005329033464913752
Bond Position:  [-16.94145455]


portfolio before change:  [-16.45406965]
curr_Stock_Price:  93.04834574215491
curr_Factors:  [9.30483457e+01 4.51874890e-02]
mat_Sqrt:  [[ 1.97796117e+01  0.00000000e+00]
 [-8.50293963e-03  1.94826822e-02]]
grads:  [ 1.51510915e-03 -5.78265205e+00]
Stock Position:  0.001515109145161971
Bond Position:  [-16.59504805]


portfolio before change:  [-16.46092115]
curr_Stock_Price:  94.00411638167242
curr_Factors:  [9.40041164e+01 4.60830162e-02]
mat_Sqrt:  [[ 2.01798215e+01  0.00000000e+00]
 [-8.58678205e-03  1.96747894e-02]]
grads:  [-2.15455538e-03 -1.55968877e+01]
Stock Position:  -0.0021545553777137147
Bond Position:  [-16.25838408]


portfolio before change:  [-16.46644446]
curr_Stock_Price:  92.79369650977195
curr_Factors:  [9.27936965e+01 4.79410951e-02]
mat_Sqrt:  [[ 2.03176021e+01  0.00000000e+00]
 [-8.75818202e-03  2.00675160e-02]]
grads:  [ 2.22747148e-04 -5.81015042e+00]
Stock Position:  0.0002227471482107603
Bond Position:  [-16.48711399]


portfolio before change:  [-16.47365314]
curr_Stock_Price:  97.44893410287837
curr_Factors:  [9.74489341e+01 4.36329213e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.47365314]
Stock Price:  96.98187484045344
PL:  [-16.47365314]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-1.43963085e-03 -2.22176295e-01]
 [-1.92892721e-02 -1.34268503e-01]
 [ 2.32916376e-01  1.53453146e-01]
 [ 1.19963751e-01  1.40140440e-01]
 [ 4.06355710e-02 -1.76977498e-02]
 [ 7.67843506e-02 -3.88767445e-02]
 [ 2.60023832e-01 -1.29275359e-01]
 [ 5.53475551e-02  3.69559194e-02]
 [ 4.06811995e-02 -5.43990902e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.31092676]
curr_Stock_Price:  98.29073132857636
curr_Factors:  [9.82907313e+01 4.04997250e-02]
mat_Sqrt:  [[ 1.97805609e+01  0.00000000e+00]
 [-8.04981739e-03  1.84444487e-02]]
grads:  [-4.97484959e-03 -1.20456999e+01]
Stock Position:  -0.004974849586726026
Bond Position:  [-8.82194516]


portfolio before change:  [-9.31309984]
curr_Stock_Price:  97.84066672878195
curr_Factors:  [9.78406667e+01 3.86076341e-02]
mat_Sqrt:  [[ 1.92245418e+01  0.00000000e+00]
 [-7.85953017e-03  1.80084460e-02]]
grads:  [-4.05153226e-03 -7.45586286e+00]
Stock Position:  -0.004051532256346772
Bond Position:  [-8.91669522]


portfolio before change:  [-9.32227332]
curr_Stock_Price:  99.00418184288415
curr_Factors:  [9.90041818e+01 3.69334548e-02]
mat_Sqrt:  [[ 1.90267016e+01  0.00000000e+00]
 [-7.68723147e-03  1.76136601e-02]]
grads:  [0.01576147 8.71216688]
Stock Position:  0.015761471766492015
Bond Position:  [-10.88272494]


portfolio before change:  [-9.29841647]
curr_Stock_Price:  100.86311817944743
curr_Factors:  [1.00863118e+02 3.37381684e-02]
mat_Sqrt:  [[ 1.85264898e+01  0.00000000e+00]
 [-7.34718106e-03  1.68345067e-02]]
grads:  [0.0097766  8.32459438]
Stock Position:  0.009776598570856748
Bond Position:  [-10.28451469]


portfolio before change:  [-9.30609601]
curr_Stock_Price:  100.60372292912233
curr_Factors:  [1.00603723e+02 3.21780220e-02]
mat_Sqrt:  [[ 1.80465307e+01  0.00000000e+00]
 [-7.17529339e-03  1.64406626e-02]]
grads:  [ 0.00182371 -1.07646208]
Stock Position:  0.0018237100669420633
Bond Position:  [-9.48956804]


portfolio before change:  [-9.31407794]
curr_Stock_Price:  98.82934488470573
curr_Factors:  [9.88293449e+01 3.35643995e-02]
mat_Sqrt:  [[ 1.81061185e+01  0.00000000e+00]
 [-7.32823575e-03  1.67910975e-02]]
grads:  [ 0.0033037  -2.31531885]
Stock Position:  0.0033036980515725677
Bond Position:  [-9.64058025]


portfolio before change:  [-9.31349761]
curr_Stock_Price:  100.464429145181
curr_Factors:  [1.00464429e+02 3.21018930e-02]
mat_Sqrt:  [[ 1.80002129e+01  0.00000000e+00]
 [-7.16680046e-03  1.64212028e-02]]
grads:  [ 0.01131117 -7.87246591]
Stock Position:  0.011311168416344112
Bond Position:  [-10.44986769]


portfolio before change:  [-9.31871115]
curr_Stock_Price:  100.46555148685553
curr_Factors:  [1.00465551e+02 3.05575387e-02]
mat_Sqrt:  [[ 1.75620964e+01  0.00000000e+00]
 [-6.99228588e-03  1.60213397e-02]]
grads:  [0.00406993 2.30666849]
Stock Position:  0.0040699264373595286
Bond Position:  [-9.72759856]


portfolio before change:  [-9.31410536]
curr_Stock_Price:  102.79257237276471
curr_Factors:  [1.02792572e+02 3.01682179e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.31410536]
Stock Price:  102.37170645457095
PL:  [-11.68581182]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.06829434e-02 -2.89990478e-01]
 [-4.57096895e-01 -1.15708097e-01]
 [ 1.16217071e-01  5.70288986e-02]
 [-8.87741516e-02  3.35174746e-02]
 [ 3.92026125e-02 -1.66774808e-02]
 [ 8.83472420e-02 -1.60722932e-01]
 [ 2.17532881e-01 -1.80361986e-01]
 [ 1.02911694e-01  4.57337284e-02]
 [ 4.88504728e-02 -7.37940912e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.0786397]
curr_Stock_Price:  100.23455281901741
curr_Factors:  [1.00234553e+02 3.99911659e-02]
mat_Sqrt:  [[ 2.00446967e+01  0.00000000e+00]
 [-7.99911654e-03  1.83282785e-02]]
grads:  [-9.34138175e-03 -1.58220249e+01]
Stock Position:  -0.009341381746543418
Bond Position:  [5.01496892]


portfolio before change:  [4.05665226]
curr_Stock_Price:  102.85681434979543
curr_Factors:  [1.02856814e+02 3.92332599e-02]
mat_Sqrt:  [[ 2.03732478e+01  0.00000000e+00]
 [-7.92295499e-03  1.81537705e-02]]
grads:  [-0.02491483 -6.37377765]
Stock Position:  -0.02491483213263494
Bond Position:  [6.61931253]


portfolio before change:  [4.11178589]
curr_Stock_Price:  100.77680273135933
curr_Factors:  [1.00776803e+02 3.97448161e-02]
mat_Sqrt:  [[ 2.00909661e+01  0.00000000e+00]
 [-7.97444078e-03  1.82717393e-02]]
grads:  [0.00702338 3.12115326]
Stock Position:  0.007023381651051527
Bond Position:  [3.40399194]


portfolio before change:  [4.13336934]
curr_Stock_Price:  103.60749394653888
curr_Factors:  [1.03607494e+02 3.81699705e-02]
mat_Sqrt:  [[ 2.02419376e+01  0.00000000e+00]
 [-7.81485463e-03  1.79060814e-02]]
grads:  [-0.00366299  1.87184866]
Stock Position:  -0.0036629856241837417
Bond Position:  [4.5128821]


portfolio before change:  [4.14640362]
curr_Stock_Price:  100.66528202416005
curr_Factors:  [1.00665282e+02 3.78948568e-02]
mat_Sqrt:  [[ 1.95961092e+01  0.00000000e+00]
 [-7.78664054e-03  1.78414348e-02]]
grads:  [ 0.0016291  -0.93476119]
Stock Position:  0.0016290970253778842
Bond Position:  [3.98241011]


portfolio before change:  [4.15035529]
curr_Stock_Price:  101.86838438374336
curr_Factors:  [1.01868384e+02 3.52813604e-02]
mat_Sqrt:  [[ 1.91342780e+01  0.00000000e+00]
 [-7.51333326e-03  1.72152092e-02]]
grads:  [ 9.51277257e-04 -9.33610104e+00]
Stock Position:  0.0009512772571731914
Bond Position:  [4.05345022]


portfolio before change:  [4.14916994]
curr_Stock_Price:  98.4912597380123
curr_Factors:  [9.84912597e+01 3.81041166e-02]
mat_Sqrt:  [[ 1.92257655e+01  0.00000000e+00]
 [-7.80811030e-03  1.78906282e-02]]
grads:  [ 7.22033445e-03 -1.00813668e+01]
Stock Position:  0.007220334447081585
Bond Position:  [3.43803011]


portfolio before change:  [4.1586056]
curr_Stock_Price:  99.55993704609875
curr_Factors:  [9.95599370e+01 3.59977065e-02]
mat_Sqrt:  [[ 1.88895681e+01  0.00000000e+00]
 [-7.58922462e-03  1.73890981e-02]]
grads:  [0.00650473 2.63002302]
Stock Position:  0.006504729418662599
Bond Position:  [3.51099515]


portfolio before change:  [4.16931218]
curr_Stock_Price:  100.93595868629806
curr_Factors:  [1.00935959e+02 3.49818195e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.16931218]
Stock Price:  99.61149383898297
PL:  [4.16931218]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 9.38375260e-02 -2.84783240e-01]
 [ 4.11489295e-02 -8.27158929e-01]
 [ 2.70539571e-01  1.66267369e-01]
 [ 2.27880565e-01  1.55666435e-01]
 [ 2.65739607e-01 -2.24279418e-01]
 [ 7.91088702e-02 -1.11754207e-01]
 [ 2.11589859e-01 -1.87207397e-01]
 [ 1.63702688e-03  9.27053970e-03]
 [ 4.67863911e-02 -6.88936716e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.13488491]
curr_Stock_Price:  96.13867297124692
curr_Factors:  [9.61386730e+01 3.95449324e-02]
mat_Sqrt:  [[ 1.91180478e+01  0.00000000e+00]
 [-7.95436307e-03  1.82257354e-02]]
grads:  [-1.59284409e-03 -1.56253360e+01]
Stock Position:  -0.001592844090670261
Bond Position:  [-23.98175099]


portfolio before change:  [-24.14481645]
curr_Stock_Price:  94.84392296511423
curr_Factors:  [9.48439230e+01 4.06857985e-02]
mat_Sqrt:  [[ 1.91307031e+01  0.00000000e+00]
 [-8.06828840e-03  1.84867712e-02]]
grads:  [-1.67193449e-02 -4.47432881e+01]
Stock Position:  -0.0167193449061685
Bond Position:  [-22.55908819]


portfolio before change:  [-24.16247585]
curr_Stock_Price:  95.22533973715429
curr_Factors:  [9.52253397e+01 4.36760882e-02]
mat_Sqrt:  [[ 1.99009770e+01  0.00000000e+00]
 [-8.35952996e-03  1.91540894e-02]]
grads:  [0.01724059 8.68051545]
Stock Position:  0.017240590749002884
Bond Position:  [-25.80421696]


portfolio before change:  [-24.15472619]
curr_Stock_Price:  96.42338421937902
curr_Factors:  [9.64233842e+01 4.27937155e-02]
mat_Sqrt:  [[ 1.99467602e+01  0.00000000e+00]
 [-8.27465678e-03  1.89596205e-02]]
grads:  [0.01483043 8.21041936]
Stock Position:  0.01483042675748246
Bond Position:  [-25.58472613]


portfolio before change:  [-24.20152496]
curr_Stock_Price:  94.13058379053368
curr_Factors:  [9.41305838e+01 4.32752533e-02]
mat_Sqrt:  [[ 1.95817076e+01  0.00000000e+00]
 [-8.32108198e-03  1.90659940e-02]]
grads:  [ 8.57208406e-03 -1.17633215e+01]
Stock Position:  0.008572084060676437
Bond Position:  [-25.00842024]


portfolio before change:  [-24.22269323]
curr_Stock_Price:  93.12021829225162
curr_Factors:  [9.31202183e+01 4.59601395e-02]
mat_Sqrt:  [[ 1.99634067e+01  0.00000000e+00]
 [-8.57532642e-03  1.96485412e-02]]
grads:  [ 1.51954705e-03 -5.68765924e+00]
Stock Position:  0.0015195470477886428
Bond Position:  [-24.36419379]


portfolio before change:  [-24.22697348]
curr_Stock_Price:  98.32235614553296
curr_Factors:  [9.83223561e+01 4.20857840e-02]
mat_Sqrt:  [[ 2.01706544e+01  0.00000000e+00]
 [-8.20592800e-03  1.88021431e-02]]
grads:  [ 6.43934747e-03 -9.95670525e+00]
Stock Position:  0.006439347473364034
Bond Position:  [-24.8601053]


portfolio before change:  [-24.2200338]
curr_Stock_Price:  101.33086696331414
curr_Factors:  [1.01330867e+02 4.03037787e-02]
mat_Sqrt:  [[ 2.03429832e+01  0.00000000e+00]
 [-8.03032041e-03  1.83997756e-02]]
grads:  [2.79360310e-04 5.03839825e-01]
Stock Position:  0.00027936031010965473
Bond Position:  [-24.24834162]


portfolio before change:  [-24.23213908]
curr_Stock_Price:  101.4093265299629
curr_Factors:  [1.01409327e+02 4.07047533e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.23213908]
Stock Price:  101.34711979828852
PL:  [-25.57925888]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.54185981e-02 -2.41938758e-01]
 [-4.48027124e-04  7.77901011e-02]
 [ 2.21269255e-01  1.54575495e-01]
 [ 1.52999552e-01  1.53856048e-01]
 [-5.10572911e-02 -3.81509568e-03]
 [ 2.66594490e-01  1.43129877e-02]
 [ 1.42067076e-01  1.25378627e-01]
 [-2.73934984e-01 -3.00950448e-01]
 [ 2.73880927e-02 -1.86621792e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.48606307]
curr_Stock_Price:  99.71300287377932
curr_Factors:  [9.97130029e+01 3.83370193e-02]
mat_Sqrt:  [[ 1.95236479e+01  0.00000000e+00]
 [-7.83193659e-03  1.79452211e-02]]
grads:  [-8.24688754e-03 -1.34820717e+01]
Stock Position:  -0.008246887540556375
Bond Position:  [1.30838499]


portfolio before change:  [0.49184551]
curr_Stock_Price:  99.09118253751333
curr_Factors:  [9.90911825e+01 3.62221029e-02]
mat_Sqrt:  [[ 1.88591381e+01  0.00000000e+00]
 [-7.61284209e-03  1.74432126e-02]]
grads:  [1.77645215e-03 4.45962009e+00]
Stock Position:  0.0017764521452406055
Bond Position:  [0.31581477]


portfolio before change:  [0.4932445]
curr_Stock_Price:  99.78978944587452
curr_Factors:  [9.97897894e+01 3.57948708e-02]
mat_Sqrt:  [[ 1.88797616e+01  0.00000000e+00]
 [-7.56781298e-03  1.73400379e-02]]
grads:  [0.01529318 8.91436892]
Stock Position:  0.015293176779872637
Bond Position:  [-1.03285839]


portfolio before change:  [0.50150425]
curr_Stock_Price:  100.36366040491275
curr_Factors:  [1.0036366e+02 3.6366613e-02]
mat_Sqrt:  [[ 1.91393824e+01  0.00000000e+00]
 [-7.62801290e-03  1.74779733e-02]]
grads:  [0.01150235 8.80285404]
Stock Position:  0.01150234796070902
Bond Position:  [-0.65291349]


portfolio before change:  [0.53347305]
curr_Stock_Price:  103.17137728630853
curr_Factors:  [1.03171377e+02 3.54695865e-02]
mat_Sqrt:  [[ 1.94306483e+01  0.00000000e+00]
 [-7.53334842e-03  1.72610697e-02]]
grads:  [-0.00271336 -0.22102313]
Stock Position:  -0.0027133595621167054
Bond Position:  [0.81341409]


portfolio before change:  [0.5260683]
curr_Stock_Price:  106.0502999491682
curr_Factors:  [1.0605030e+02 3.1968443e-02]
mat_Sqrt:  [[ 1.89614980e+01  0.00000000e+00]
 [-7.15188848e-03  1.63870352e-02]]
grads:  [0.01438922 0.87343364]
Stock Position:  0.014389221266158762
Bond Position:  [-0.99991293]


portfolio before change:  [0.52689233]
curr_Stock_Price:  106.14232059027141
curr_Factors:  [1.06142321e+02 3.04402302e-02]
mat_Sqrt:  [[ 1.85187874e+01  0.00000000e+00]
 [-6.97885151e-03  1.59905577e-02]]
grads:  [0.01062633 7.8407914 ]
Stock Position:  0.010626332673139513
Bond Position:  [-0.60101128]


portfolio before change:  [0.51495362]
curr_Stock_Price:  105.04710470176158
curr_Factors:  [1.05047105e+02 3.13826973e-02]
mat_Sqrt:  [[ 1.86092650e+01  0.00000000e+00]
 [-7.08606490e-03  1.62362144e-02]]
grads:  [ -0.02177843 -18.53575229]
Stock Position:  -0.021778427406716493
Bond Position:  [2.80271436]


portfolio before change:  [0.49302444]
curr_Stock_Price:  106.11838905617924
curr_Factors:  [1.06118389e+02 3.34229488e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.49302444]
Stock Price:  104.25465280920099
PL:  [-3.76162837]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 2.33005957e-02 -2.38433182e-01]
 [ 5.63146310e-02 -1.00102528e+00]
 [ 3.16365372e-01  1.81875348e-01]
 [ 1.36363961e-01  1.21244179e-01]
 [ 5.24991478e-01 -3.18163539e-01]
 [ 8.04320467e-02 -1.53237935e-01]
 [ 3.90596688e-02 -3.49453993e-01]
 [ 5.37680683e-02 -1.20904837e-01]
 [ 3.30055000e-02 -6.78385057e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.24822906]
curr_Stock_Price:  98.15465908494494
curr_Factors:  [9.81546591e+01 3.84643879e-02]
mat_Sqrt:  [[ 1.92504254e+01  0.00000000e+00]
 [-7.84493599e-03  1.79750065e-02]]
grads:  [-4.19524111e-03 -1.32647063e+01]
Stock Position:  -0.0041952411086686545
Bond Position:  [-9.8364466]


portfolio before change:  [-10.2360965]
curr_Stock_Price:  94.09004981588352
curr_Factors:  [9.40900498e+01 4.18456086e-02]
mat_Sqrt:  [[ 1.92472480e+01  0.00000000e+00]
 [-8.18247969e-03  1.87484163e-02]]
grads:  [-1.97726249e-02 -5.33925245e+01]
Stock Position:  -0.019772624941224226
Bond Position:  [-8.37568923]


portfolio before change:  [-10.17152096]
curr_Stock_Price:  90.6122906533838
curr_Factors:  [9.06122907e+01 4.33321387e-02]
mat_Sqrt:  [[ 1.88621924e+01  0.00000000e+00]
 [-8.32654922e-03  1.90785210e-02]]
grads:  [0.02098071 9.53298988]
Stock Position:  0.020980714842958468
Bond Position:  [-12.0726316]


portfolio before change:  [-10.17858441]
curr_Stock_Price:  90.56340673276105
curr_Factors:  [9.05634067e+01 4.44183991e-02]
mat_Sqrt:  [[ 1.90868474e+01  0.00000000e+00]
 [-8.43026918e-03  1.93161733e-02]]
grads:  [0.00991674 6.27682186]
Stock Position:  0.009916737650105428
Bond Position:  [-11.07667795]


portfolio before change:  [-10.17995967]
curr_Stock_Price:  90.98334930697416
curr_Factors:  [9.09833493e+01 4.46931831e-02]
mat_Sqrt:  [[ 1.92345736e+01  0.00000000e+00]
 [-8.45630492e-03  1.93758287e-02]]
grads:  [  0.02007497 -16.42064162]
Stock Position:  0.020074971921311385
Bond Position:  [-12.00644786]


portfolio before change:  [-10.20837844]
curr_Stock_Price:  89.86683247698286
curr_Factors:  [8.98668325e+01 4.87910275e-02]
mat_Sqrt:  [[ 1.98504070e+01  0.00000000e+00]
 [-8.83547645e-03  2.02446198e-02]]
grads:  [ 6.82783419e-04 -7.56931653e+00]
Stock Position:  0.0006827834185752943
Bond Position:  [-10.26973802]


portfolio before change:  [-10.21223338]
curr_Stock_Price:  91.74328350774404
curr_Factors:  [9.17432835e+01 4.55666581e-02]
mat_Sqrt:  [[ 1.95838407e+01  0.00000000e+00]
 [-8.53853928e-03  1.95642513e-02]]
grads:  [-5.79327411e-03 -1.78618639e+01]
Stock Position:  -0.005793274112252092
Bond Position:  [-9.6807394]


portfolio before change:  [-10.2366098]
curr_Stock_Price:  95.1152696286263
curr_Factors:  [9.51152696e+01 4.42960479e-02]
mat_Sqrt:  [[ 2.00185554e+01  0.00000000e+00]
 [-8.41865053e-03  1.92895516e-02]]
grads:  [ 4.99971811e-05 -6.26789256e+00]
Stock Position:  4.9997181072353166e-05
Bond Position:  [-10.2413653]


portfolio before change:  [-10.24156443]
curr_Stock_Price:  98.46225653619506
curr_Factors:  [9.84622565e+01 4.45173806e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.24156443]
Stock Price:  102.74955276771142
PL:  [-12.9911172]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-1.42663566e-02 -1.91853442e-01]
 [ 2.31998843e-01  1.53140640e-01]
 [-7.20767803e-02  3.97959228e-02]
 [-3.72769487e-02 -3.47505526e-03]
 [ 8.77890907e-02 -1.50608286e-01]
 [ 1.62754092e-01  4.42807652e-02]
 [-2.78888872e-01 -3.07367142e-01]
 [ 2.17032397e-02  1.33179708e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.35642303]
curr_Stock_Price:  98.57447512034642
curr_Factors:  [9.85744751e+01 3.92540754e-02]
mat_Sqrt:  [[ 1.95302071e+01  0.00000000e+00]
 [-7.92505650e-03  1.81585857e-02]]
grads:  [-6.80372441e-03 -1.04862602e+01]
Stock Position:  -0.00680372440614477
Bond Position:  [-6.68574947]


portfolio before change:  [-7.35304271]
curr_Stock_Price:  97.58618785263332
curr_Factors:  [9.75861879e+01 4.05999369e-02]
mat_Sqrt:  [[ 1.96630567e+01  0.00000000e+00]
 [-8.05977041e-03  1.84672540e-02]]
grads:  [-4.98386718e-03 -1.03888451e+01]
Stock Position:  -0.004983867180209927
Bond Position:  [-6.86668611]


portfolio before change:  [-7.36402455]
curr_Stock_Price:  99.10060201563019
curr_Factors:  [9.91006020e+01 4.02960817e-02]
mat_Sqrt:  [[ 1.98933398e+01  0.00000000e+00]
 [-8.02955358e-03  1.83980185e-02]]
grads:  [0.01502186 8.32375723]
Stock Position:  0.015021856552295897
Bond Position:  [-8.85269958]


portfolio before change:  [-7.30336466]
curr_Stock_Price:  103.43344503758662
curr_Factors:  [1.03433445e+02 4.07522983e-02]
mat_Sqrt:  [[ 2.08803148e+01  0.00000000e+00]
 [-8.07487939e-03  1.85018730e-02]]
grads:  [-0.0026201   2.15091319]
Stock Position:  -0.002620095343159693
Bond Position:  [-7.03235917]


portfolio before change:  [-7.3053433]
curr_Stock_Price:  102.84628267468139
curr_Factors:  [1.02846283e+02 3.90361541e-02]
mat_Sqrt:  [[ 2.03199255e+01  0.00000000e+00]
 [-7.90302769e-03  1.81081113e-02]]
grads:  [-0.00190914 -0.191906  ]
Stock Position:  -0.0019091402279075124
Bond Position:  [-7.10899532]


portfolio before change:  [-7.30875153]
curr_Stock_Price:  102.76920591724341
curr_Factors:  [1.02769206e+02 3.75869467e-02]
mat_Sqrt:  [[ 1.99242290e+01  0.00000000e+00]
 [-7.75494131e-03  1.77688028e-02]]
grads:  [ 1.10710661e-03 -8.47599515e+00]
Stock Position:  0.0011071066131786676
Bond Position:  [-7.422528]


portfolio before change:  [-7.31131122]
curr_Stock_Price:  103.81021380748665
curr_Factors:  [1.03810214e+02 3.80521109e-02]
mat_Sqrt:  [[ 2.02502068e+01  0.00000000e+00]
 [-7.80278011e-03  1.78784152e-02]]
grads:  [0.0089915  2.47677239]
Stock Position:  0.008991503344210812
Bond Position:  [-8.2447211]


portfolio before change:  [-7.30382778]
curr_Stock_Price:  105.10108065345952
curr_Factors:  [1.05101081e+02 3.82062112e-02]
mat_Sqrt:  [[ 2.05434873e+01  0.00000000e+00]
 [-7.81856368e-03  1.79145799e-02]]
grads:  [ -0.02010539 -17.15737368]
Stock Position:  -0.02010539324198802
Bond Position:  [-5.19072922]


portfolio before change:  [-7.37941057]
curr_Stock_Price:  108.7312894890122
curr_Factors:  [1.08731289e+02 3.45500432e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.37941057]
Stock Price:  107.50057384515688
PL:  [-14.87998441]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.37680685e-02 -3.18150783e-01]
 [-3.66157408e-01 -5.67060676e-02]
 [ 6.44299292e-02  9.36564044e-04]
 [-2.90977155e-02  5.83176722e-02]
 [ 4.26284026e-02 -1.91246941e-02]
 [ 8.09189202e-02 -7.71843875e-02]
 [ 2.60717123e-01 -1.31884589e-01]
 [-6.67070437e-03  5.33046381e-03]
 [ 5.31520051e-02 -8.48593260e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.7048084]
curr_Stock_Price:  100.76097947108981
curr_Factors:  [1.00760979e+02 4.06513173e-02]
mat_Sqrt:  [[ 2.03156018e+01  0.00000000e+00]
 [-8.06486873e-03  1.84789357e-02]]
grads:  [-9.97363777e-03 -1.72169430e+01]
Stock Position:  -0.009973637765615788
Bond Position:  [8.70976191]


portfolio before change:  [7.69545532]
curr_Stock_Price:  102.13550789215961
curr_Factors:  [1.02135508e+02 4.00754199e-02]
mat_Sqrt:  [[ 2.04463501e+01  0.00000000e+00]
 [-8.00753844e-03  1.83475755e-02]]
grads:  [-0.01911862 -3.09065727]
Stock Position:  -0.019118618352053852
Bond Position:  [9.64814512]


portfolio before change:  [7.72148789]
curr_Stock_Price:  101.02626002499588
curr_Factors:  [1.01026260e+02 4.26351054e-02]
mat_Sqrt:  [[ 2.08601749e+01  0.00000000e+00]
 [-8.25930800e-03  1.89244520e-02]]
grads:  [0.00310825 0.04948963]
Stock Position:  0.003108251942644499
Bond Position:  [7.40747282]


portfolio before change:  [7.73123553]
curr_Stock_Price:  102.97043434690951
curr_Factors:  [1.02970434e+02 4.03207462e-02]
mat_Sqrt:  [[ 2.06764905e+01  0.00000000e+00]
 [-8.03201058e-03  1.84036482e-02]]
grads:  [-1.76325703e-04  3.16881042e+00]
Stock Position:  -0.00017632570278305318
Bond Position:  [7.74939187]


portfolio before change:  [7.73554743]
curr_Stock_Price:  100.4964028679761
curr_Factors:  [1.00496403e+02 4.16836515e-02]
mat_Sqrt:  [[ 2.05179230e+01  0.00000000e+00]
 [-8.16662980e-03  1.87120996e-02]]
grads:  [ 0.00167082 -1.02204961]
Stock Position:  0.0016708173547737388
Bond Position:  [7.5676363]


portfolio before change:  [7.73858474]
curr_Stock_Price:  100.04904012472686
curr_Factors:  [1.00049040e+02 4.23171263e-02]
mat_Sqrt:  [[ 2.05812150e+01  0.00000000e+00]
 [-8.22845077e-03  1.88537493e-02]]
grads:  [ 2.29495157e-03 -4.09384820e+00]
Stock Position:  0.002294951568776013
Bond Position:  [7.50897703]


portfolio before change:  [7.74155847]
curr_Stock_Price:  99.70842452235509
curr_Factors:  [9.97084245e+01 4.21528698e-02]
mat_Sqrt:  [[ 2.04713002e+01  0.00000000e+00]
 [-8.21246563e-03  1.88171227e-02]]
grads:  [ 0.00992404 -7.00875429]
Stock Position:  0.009924038402617383
Bond Position:  [6.75204823]


portfolio before change:  [7.76239231]
curr_Stock_Price:  101.4674838924446
curr_Factors:  [1.01467484e+02 4.03785175e-02]
mat_Sqrt:  [[ 2.03892887e+01  0.00000000e+00]
 [-8.03776262e-03  1.84168278e-02]]
grads:  [-2.13067719e-04  2.89434416e-01]
Stock Position:  -0.000213067718641901
Bond Position:  [7.78401175]


portfolio before change:  [7.76665055]
curr_Stock_Price:  99.7531686838659
curr_Factors:  [9.97531687e+01 3.83189704e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.76665055]
Stock Price:  102.86980437696587
PL:  [4.89684617]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.28416212e-02 -2.18416712e-01]
 [-3.06054082e-01 -1.76801814e-02]
 [-7.05675952e-02 -1.45283637e-01]
 [-2.90822274e-02  5.83272467e-02]
 [-7.61947266e-02 -3.59259583e-03]
 [ 8.81084408e-02 -1.56395451e-01]
 [ 2.66416567e-01 -1.26234587e-01]
 [ 6.32443223e-02  4.15388583e-02]
 [ 5.23847003e-02 -8.40809322e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.2003204]
curr_Stock_Price:  99.46818326389253
curr_Factors:  [9.94681833e+01 4.15568735e-02]
mat_Sqrt:  [[ 2.02770895e+01  0.00000000e+00]
 [-8.15420122e-03  1.86836222e-02]]
grads:  [-7.30708859e-03 -1.16902767e+01]
Stock Position:  -0.007307088588480863
Bond Position:  [-0.47349758]


portfolio before change:  [-1.21655996]
curr_Stock_Price:  101.65821358994607
curr_Factors:  [1.01658214e+02 4.10956014e-02]
mat_Sqrt:  [[ 2.06082040e+01  0.00000000e+00]
 [-8.10882002e-03  1.85796408e-02]]
grads:  [-0.01522551 -0.95158898]
Stock Position:  -0.015225506635070033
Bond Position:  [0.33123785]


portfolio before change:  [-1.2166507]
curr_Stock_Price:  101.67505394272752
curr_Factors:  [1.01675054e+02 3.96757745e-02]
mat_Sqrt:  [[ 2.02524290e+01  0.00000000e+00]
 [-7.96751148e-03  1.82558622e-02]]
grads:  [-6.61523479e-03 -7.95819094e+00]
Stock Position:  -0.006615234793148756
Bond Position:  [-0.54404634]


portfolio before change:  [-1.22549073]
curr_Stock_Price:  102.97023627475254
curr_Factors:  [1.02970236e+02 4.05164054e-02]
mat_Sqrt:  [[ 2.07265569e+01  0.00000000e+00]
 [-8.05147494e-03  1.84482467e-02]]
grads:  [-1.74950906e-04  3.16166884e+00]
Stock Position:  -0.00017495090637099052
Bond Position:  [-1.20747599]


portfolio before change:  [-1.22623577]
curr_Stock_Price:  103.77704281064102
curr_Factors:  [1.03777043e+02 4.17579381e-02]
mat_Sqrt:  [[ 2.12065887e+01  0.00000000e+00]
 [-8.17390365e-03  1.87287661e-02]]
grads:  [-0.00366691 -0.19182234]
Stock Position:  -0.0036669105527754368
Bond Position:  [-0.84569463]


portfolio before change:  [-1.22104723]
curr_Stock_Price:  102.24673818784052
curr_Factors:  [1.02246738e+02 4.26524006e-02]
mat_Sqrt:  [[ 2.11164643e+01  0.00000000e+00]
 [-8.26098305e-03  1.89282901e-02]]
grads:  [ 9.40113350e-04 -8.26252401e+00]
Stock Position:  0.000940113350323883
Bond Position:  [-1.31717075]


portfolio before change:  [-1.22387643]
curr_Stock_Price:  99.93802728588287
curr_Factors:  [9.99380273e+01 4.65862295e-02]
mat_Sqrt:  [[ 2.15704673e+01  0.00000000e+00]
 [-8.63353736e-03  1.97819192e-02]]
grads:  [ 0.00979688 -6.3813114 ]
Stock Position:  0.009796879873491104
Bond Position:  [-2.20295728]


portfolio before change:  [-1.22116711]
curr_Stock_Price:  100.32703572473451
curr_Factors:  [1.00327036e+02 4.61700798e-02]
mat_Sqrt:  [[ 2.15574950e+01  0.00000000e+00]
 [-8.59488962e-03  1.96933661e-02]]
grads:  [0.00377471 2.10928177]
Stock Position:  0.003774713460928447
Bond Position:  [-1.59987293]


portfolio before change:  [-1.22440435]
curr_Stock_Price:  99.6813985086982
curr_Factors:  [9.96813985e+01 4.67695846e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.22440435]
Stock Price:  98.70373846992953
PL:  [-1.22440435]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.07985742e-02 -2.76215300e-01]
 [-2.77492154e-02 -3.72799506e-02]
 [ 6.14672386e-02 -2.27242238e-03]
 [ 3.12551292e-02  9.56269326e-02]
 [-1.75353182e-01 -3.83170763e-03]
 [ 2.94270144e-01  4.55480099e-02]
 [ 1.40541840e-01  1.34972760e-01]
 [-4.86294677e-01 -4.99199079e-01]
 [ 2.11622567e-02  1.60710073e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.87802635]
curr_Stock_Price:  97.77287999615972
curr_Factors:  [9.7772880e+01 4.2461677e-02]
mat_Sqrt:  [[ 2.01473058e+01  0.00000000e+00]
 [-8.24249254e-03  1.88859230e-02]]
grads:  [-1.97305119e-03 -1.46254594e+01]
Stock Position:  -0.0019730511882293305
Bond Position:  [-12.68511545]


portfolio before change:  [-12.88529739]
curr_Stock_Price:  98.24265893104612
curr_Factors:  [9.82426589e+01 4.41808392e-02]
mat_Sqrt:  [[ 2.06498589e+01  0.00000000e+00]
 [-8.40769544e-03  1.92644504e-02]]
grads:  [-0.00213171 -1.93516814]
Stock Position:  -0.002131710439262781
Bond Position:  [-12.67587249]


portfolio before change:  [-12.89760154]
curr_Stock_Price:  101.04070700186621
curr_Factors:  [1.01040707e+02 4.40420623e-02]
mat_Sqrt:  [[ 2.12046056e+01  0.00000000e+00]
 [-8.39448031e-03  1.92341707e-02]]
grads:  [ 0.002852   -0.11814507]
Stock Position:  0.002851997020882593
Bond Position:  [-13.18576934]


portfolio before change:  [-12.90132054]
curr_Stock_Price:  102.04895901796719
curr_Factors:  [1.02048959e+02 4.45567485e-02]
mat_Sqrt:  [[ 2.15409734e+01  0.00000000e+00]
 [-8.44338781e-03  1.93462319e-02]]
grads:  [3.38843295e-03 4.94292290e+00]
Stock Position:  0.003388432954509414
Bond Position:  [-13.2471066]


portfolio before change:  [-12.8951919]
curr_Stock_Price:  105.81289668354934
curr_Factors:  [1.05812897e+02 4.45042344e-02]
mat_Sqrt:  [[ 2.23223170e+01  0.00000000e+00]
 [-8.43841070e-03  1.93348279e-02]]
grads:  [-0.00793043 -0.19817645]
Stock Position:  -0.007930425694246374
Bond Position:  [-12.05605059]


portfolio before change:  [-12.90553214]
curr_Stock_Price:  106.3564619099896
curr_Factors:  [1.06356462e+02 4.55804093e-02]
mat_Sqrt:  [[ 2.27066461e+01  0.00000000e+00]
 [-8.53982757e-03  1.95672031e-02]]
grads:  [0.01383511 2.32777314]
Stock Position:  0.013835109043129628
Bond Position:  [-14.37698539]


portfolio before change:  [-12.91076677]
curr_Stock_Price:  106.4978169660098
curr_Factors:  [1.06497817e+02 4.92273529e-02]
mat_Sqrt:  [[ 2.36289241e+01  0.00000000e+00]
 [-8.87489519e-03  2.03349395e-02]]
grads:  [0.00844087 6.6374803 ]
Stock Position:  0.008440874462315399
Bond Position:  [-13.80970147]


portfolio before change:  [-12.89635614]
curr_Stock_Price:  109.0232906435844
curr_Factors:  [1.09023291e+02 4.76620141e-02]
mat_Sqrt:  [[ 2.38015632e+01  0.00000000e+00]
 [-8.73265266e-03  2.00090209e-02]]
grads:  [ -0.02958474 -24.94870092]
Stock Position:  -0.02958473817830402
Bond Position:  [-9.67093063]


portfolio before change:  [-12.89955465]
curr_Stock_Price:  108.9679187955675
curr_Factors:  [1.08967919e+02 4.87693464e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.89955465]
Stock Price:  110.12091696061238
PL:  [-23.02047161]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.26028346e-02 -3.07514799e-01]
 [-4.96744577e-06  8.18692414e-02]
 [ 2.45737685e-01  1.57820003e-01]
 [ 2.18418745e-01  1.61413766e-01]
 [ 4.63369764e-02 -7.69269601e-02]
 [ 7.67345798e-02 -3.44946400e-02]
 [ 1.80396826e-01 -2.22254927e-01]
 [ 5.47670743e-02 -1.18286021e-01]
 [ 8.99278432e-04 -1.11176820e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.04639373]
curr_Stock_Price:  100.52022021349418
curr_Factors:  [1.00520220e+02 3.91153694e-02]
mat_Sqrt:  [[ 1.98804930e+01  0.00000000e+00]
 [-7.91104235e-03  1.81264752e-02]]
grads:  [-9.89981968e-03 -1.69649529e+01]
Stock Position:  -0.009899819683221596
Bond Position:  [7.04152578]


portfolio before change:  [6.06090726]
curr_Stock_Price:  99.40990754967152
curr_Factors:  [9.94099075e+01 4.32345481e-02]
mat_Sqrt:  [[ 2.06702216e+01  0.00000000e+00]
 [-8.31716760e-03  1.90570251e-02]]
grads:  [1.72836555e-03 4.29601373e+00]
Stock Position:  0.0017283655470968025
Bond Position:  [5.88909061]


portfolio before change:  [6.06093347]
curr_Stock_Price:  97.72098568420083
curr_Factors:  [9.77209857e+01 4.30075891e-02]
mat_Sqrt:  [[ 2.02656430e+01  0.00000000e+00]
 [-8.29530846e-03  1.90069395e-02]]
grads:  [0.0155246  8.30328328]
Stock Position:  0.015524598987359042
Bond Position:  [4.54385436]


portfolio before change:  [6.06443992]
curr_Stock_Price:  97.80046921757912
curr_Factors:  [9.78004692e+01 4.04716612e-02]
mat_Sqrt:  [[ 1.96750776e+01  0.00000000e+00]
 [-8.04702789e-03  1.84380572e-02]]
grads:  [0.0146818  8.75438035]
Stock Position:  0.014681796608596712
Bond Position:  [4.62855332]


portfolio before change:  [6.06303555]
curr_Stock_Price:  97.5471470010128
curr_Factors:  [9.75471470e+01 4.03080844e-02]
mat_Sqrt:  [[ 1.95844172e+01  0.00000000e+00]
 [-8.03074935e-03  1.84007584e-02]]
grads:  [ 6.51706835e-04 -4.18064074e+00]
Stock Position:  0.0006517068347983493
Bond Position:  [5.9994634]


portfolio before change:  [6.0671287]
curr_Stock_Price:  99.22377224860186
curr_Factors:  [9.92237722e+01 4.12262133e-02]
mat_Sqrt:  [[ 2.01466321e+01  0.00000000e+00]
 [-8.12169572e-03  1.86091427e-02]]
grads:  [ 0.00306155 -1.8536394 ]
Stock Position:  0.0030615481638059418
Bond Position:  [5.76335034]


portfolio before change:  [6.06455892]
curr_Stock_Price:  97.44291831284703
curr_Factors:  [9.74429183e+01 3.99733792e-02]
mat_Sqrt:  [[ 1.94820976e+01  0.00000000e+00]
 [-7.99733748e-03  1.83242022e-02]]
grads:  [ 4.28069018e-03 -1.21290371e+01]
Stock Position:  0.0042806901768949945
Bond Position:  [5.64743598]


portfolio before change:  [6.04908899]
curr_Stock_Price:  93.16922599797275
curr_Factors:  [9.31692260e+01 4.14510039e-02]
mat_Sqrt:  [[ 1.89688068e+01  0.00000000e+00]
 [-8.14380785e-03  1.86598079e-02]]
grads:  [ 1.65683717e-04 -6.33908031e+00]
Stock Position:  0.00016568371676897175
Bond Position:  [6.03365237]


portfolio before change:  [6.05242146]
curr_Stock_Price:  95.06972754794599
curr_Factors:  [9.50697275e+01 3.75030973e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.05242146]
Stock Price:  96.1145743444746
PL:  [6.05242146]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.32249594e-02 -2.77809686e-01]
 [ 1.74673614e-03  8.26357362e-02]
 [ 2.63784877e-01  1.63966763e-01]
 [ 2.01807226e-01  1.45859437e-01]
 [ 2.23473240e-01 -2.09188477e-01]
 [ 7.77392219e-02 -6.88135090e-02]
 [ 1.28674300e-01 -2.74883234e-01]
 [ 5.26836553e-02 -1.23747541e-01]
 [ 1.08897990e-02 -4.36880793e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.82682493]
curr_Stock_Price:  97.48996444562734
curr_Factors:  [9.74899644e+01 4.25820509e-02]
mat_Sqrt:  [[ 2.01174625e+01  0.00000000e+00]
 [-8.25416752e-03  1.89126737e-02]]
grads:  [-1.88995644e-03 -1.46890752e+01]
Stock Position:  -0.0018899564359282305
Bond Position:  [-14.64257315]


portfolio before change:  [-14.83725646]
curr_Stock_Price:  99.13466203939066
curr_Factors:  [9.91346620e+01 4.32821256e-02]
mat_Sqrt:  [[ 2.06243287e+01  0.00000000e+00]
 [-8.32174267e-03  1.90675078e-02]]
grads:  [1.83336528e-03 4.33385091e+00]
Stock Position:  0.0018333652821465156
Bond Position:  [-15.01900651]


portfolio before change:  [-14.85069004]
curr_Stock_Price:  95.9044290219877
curr_Factors:  [9.59044290e+01 4.30061051e-02]
mat_Sqrt:  [[ 1.98885774e+01  0.00000000e+00]
 [-8.29516535e-03  1.90066116e-02]]
grads:  [0.01686123 8.62682768]
Stock Position:  0.016861228036760878
Bond Position:  [-16.46775648]


portfolio before change:  [-14.88122304]
curr_Stock_Price:  94.58204238667265
curr_Factors:  [9.45820424e+01 4.37510002e-02]
mat_Sqrt:  [[ 1.97834797e+01  0.00000000e+00]
 [-8.36669590e-03  1.91705086e-02]]
grads:  [0.01341854 7.60853247]
Stock Position:  0.013418544556667605
Bond Position:  [-16.15037639]


portfolio before change:  [-14.88974236]
curr_Stock_Price:  94.54909409910404
curr_Factors:  [9.45490941e+01 4.45630021e-02]
mat_Sqrt:  [[ 1.99592672e+01  0.00000000e+00]
 [-8.44398031e-03  1.93475895e-02]]
grads:  [ 6.62228241e-03 -1.08121209e+01]
Stock Position:  0.006622282414875104
Bond Position:  [-15.51587317]


portfolio before change:  [-14.88466272]
curr_Stock_Price:  96.48793044994613
curr_Factors:  [9.64879304e+01 4.31032628e-02]
mat_Sqrt:  [[ 2.00321731e+01  0.00000000e+00]
 [-8.30453012e-03  1.90280689e-02]]
grads:  [ 2.38149621e-03 -3.61642104e+00]
Stock Position:  0.0023814962132575846
Bond Position:  [-15.11444836]


portfolio before change:  [-14.89413974]
curr_Stock_Price:  95.68259267109445
curr_Factors:  [9.56825927e+01 4.09938591e-02]
mat_Sqrt:  [[ 1.93727974e+01  0.00000000e+00]
 [-8.09877612e-03  1.85566273e-02]]
grads:  [ 4.49363153e-04 -1.48132109e+01]
Stock Position:  0.00044936315290544665
Bond Position:  [-14.93713597]


portfolio before change:  [-14.90114126]
curr_Stock_Price:  96.72610203177479
curr_Factors:  [9.67261020e+01 4.26427789e-02]
mat_Sqrt:  [[ 1.99740639e+01  0.00000000e+00]
 [-8.26005122e-03  1.89261550e-02]]
grads:  [-6.62959396e-05 -6.53844064e+00]
Stock Position:  -6.629593960709932e-05
Bond Position:  [-14.89472871]


portfolio before change:  [-14.90859052]
curr_Stock_Price:  96.726672986533
curr_Factors:  [9.67266730e+01 4.22766885e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.90859052]
Stock Price:  97.24050439682844
PL:  [-14.90859052]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 7.21704169e-02 -2.70545708e-01]
 [-1.27682936e-03  8.17173544e-02]
 [-3.14888348e-02 -1.02956163e-01]
 [-2.76079598e-02  5.92386178e-02]
 [-1.09223692e-01 -9.87007562e-03]
 [ 1.54943457e-01 -1.09224584e-01]
 [ 2.14425976e-01 -8.03061789e-02]
 [ 1.01962440e-01  2.31553963e-02]
 [ 1.85642325e-02 -5.43082465e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.09084611]
curr_Stock_Price:  97.88715836902115
curr_Factors:  [9.78871584e+01 4.09481083e-02]
mat_Sqrt:  [[ 1.98080919e+01  0.00000000e+00]
 [-8.09425557e-03  1.85462694e-02]]
grads:  [-2.31750794e-03 -1.45876080e+01]
Stock Position:  -0.002317507943161166
Bond Position:  [-11.86399184]


portfolio before change:  [-12.10012098]
curr_Stock_Price:  99.32896208967296
curr_Factors:  [9.93289621e+01 3.70637112e-02]
mat_Sqrt:  [[ 1.91227501e+01  0.00000000e+00]
 [-7.70077516e-03  1.76446925e-02]]
grads:  [1.79825328e-03 4.63127109e+00]
Stock Position:  0.0017982532756152167
Bond Position:  [-12.27873961]


portfolio before change:  [-12.1023825]
curr_Stock_Price:  101.48626926255834
curr_Factors:  [1.01486269e+02 3.36569071e-02]
mat_Sqrt:  [[ 1.86184872e+01  0.00000000e+00]
 [-7.33832755e-03  1.68142207e-02]]
grads:  [-4.10466154e-03 -6.12315996e+00]
Stock Position:  -0.004104661542950316
Bond Position:  [-11.68581571]


portfolio before change:  [-12.11421681]
curr_Stock_Price:  102.94557217020741
curr_Factors:  [1.02945572e+02 2.97023344e-02]
mat_Sqrt:  [[ 1.77420159e+01  0.00000000e+00]
 [-6.89374609e-03  1.57955566e-02]]
grads:  [-9.88674228e-05  3.75033430e+00]
Stock Position:  -9.886742275461827e-05
Bond Position:  [-12.10403885]


portfolio before change:  [-12.12043217]
curr_Stock_Price:  104.58235473496688
curr_Factors:  [1.04582355e+02 3.02461295e-02]
mat_Sqrt:  [[ 1.81883507e+01  0.00000000e+00]
 [-6.95656577e-03  1.59394946e-02]]
grads:  [-0.00624198 -0.61922137]
Stock Position:  -0.006241981349632294
Bond Position:  [-11.46763106]


portfolio before change:  [-12.12817574]
curr_Stock_Price:  104.90409927393027
curr_Factors:  [1.04904099e+02 2.91185733e-02]
mat_Sqrt:  [[ 1.79010088e+01  0.00000000e+00]
 [-6.82566607e-03  1.56395657e-02]]
grads:  [ 5.99261985e-03 -6.98386298e+00]
Stock Position:  0.005992619845524731
Bond Position:  [-12.75682613]


portfolio before change:  [-12.15276289]
curr_Stock_Price:  101.8658400214212
curr_Factors:  [1.01865840e+02 2.93821791e-02]
mat_Sqrt:  [[ 1.74610587e+01  0.00000000e+00]
 [-6.85649230e-03  1.57101975e-02]]
grads:  [ 0.010273   -5.11172307]
Stock Position:  0.010273001751833044
Bond Position:  [-13.19923084]


portfolio before change:  [-12.18459142]
curr_Stock_Price:  99.41015366377077
curr_Factors:  [9.94101537e+01 2.84594392e-02]
mat_Sqrt:  [[ 1.67704190e+01  0.00000000e+00]
 [-6.74797027e-03  1.54615423e-02]]
grads:  [0.0066825  1.49761233]
Stock Position:  0.006682497517337276
Bond Position:  [-12.84889953]


portfolio before change:  [-12.20391745]
curr_Stock_Price:  97.47974104154156
curr_Factors:  [9.74797410e+01 2.87613881e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.20391745]
Stock Price:  99.3272787642745
PL:  [-12.20391745]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.09194127e-02 -3.83426590e-01]
 [-1.15565298e-01  5.44367841e-02]
 [ 4.12370339e-02 -2.41844138e-02]
 [ 1.06009279e-01  1.34373214e-01]
 [-4.68093568e-03 -3.67324960e-03]
 [ 8.78042349e-02 -1.46994835e-01]
 [ 2.61392483e-01 -1.30987303e-01]
 [ 5.24539197e-02 -1.24349775e-01]
 [ 8.03458688e-03 -3.97149186e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.87700442]
curr_Stock_Price:  102.23772132667466
curr_Factors:  [1.02237721e+02 3.52785505e-02]
mat_Sqrt:  [[ 1.92028871e+01  0.00000000e+00]
 [-7.51303406e-03  1.72145236e-02]]
grads:  [-1.24075351e-02 -2.22734359e+01]
Stock Position:  -0.012407535115838392
Bond Position:  [19.14552254]


portfolio before change:  [17.90879095]
curr_Stock_Price:  100.44756902125125
curr_Factors:  [1.00447569e+02 3.62645159e-02]
mat_Sqrt:  [[ 1.91284761e+01  0.00000000e+00]
 [-7.61729777e-03  1.74534218e-02]]
grads:  [-0.0047995   3.11897487]
Stock Position:  -0.004799500855970013
Bond Position:  [18.39088914]


portfolio before change:  [17.91468272]
curr_Stock_Price:  101.13638470667068
curr_Factors:  [1.01136385e+02 3.26638489e-02]
mat_Sqrt:  [[ 1.82785232e+01  0.00000000e+00]
 [-7.22925710e-03  1.65643089e-02]]
grads:  [ 0.00167859 -1.46003156]
Stock Position:  0.0016785869429916625
Bond Position:  [17.74491651]


portfolio before change:  [17.92345006]
curr_Stock_Price:  101.0724356531911
curr_Factors:  [1.01072436e+02 3.41740064e-02]
mat_Sqrt:  [[ 1.86844655e+01  0.00000000e+00]
 [-7.39448512e-03  1.69428939e-02]]
grads:  [0.00881238 7.93094819]
Stock Position:  0.008812377167712871
Bond Position:  [17.03276163]


portfolio before change:  [17.94069131]
curr_Stock_Price:  102.06226400888991
curr_Factors:  [1.02062264e+02 3.22531792e-02]
mat_Sqrt:  [[ 1.83295356e+01  0.00000000e+00]
 [-7.18366805e-03  1.64598513e-02]]
grads:  [-0.00034284 -0.2231642 ]
Stock Position:  -0.0003428386495150581
Bond Position:  [17.9756822]


portfolio before change:  [17.94911177]
curr_Stock_Price:  103.72376441607109
curr_Factors:  [1.03723764e+02 3.43471120e-02]
mat_Sqrt:  [[ 1.92230982e+01  0.00000000e+00]
 [-7.41318955e-03  1.69857511e-02]]
grads:  [ 1.23031310e-03 -8.65400851e+00]
Stock Position:  0.001230313099555265
Bond Position:  [17.82149906]


portfolio before change:  [17.95310942]
curr_Stock_Price:  99.72857748105024
curr_Factors:  [9.97285775e+01 3.85853195e-02]
mat_Sqrt:  [[ 1.95898303e+01  0.00000000e+00]
 [-7.85725850e-03  1.80032409e-02]]
grads:  [ 0.01042505 -7.27576239]
Stock Position:  0.010425048799740391
Bond Position:  [16.91343413]


portfolio before change:  [17.9320838]
curr_Stock_Price:  96.90034674618069
curr_Factors:  [9.69003467e+01 4.07137179e-02]
mat_Sqrt:  [[ 1.95522037e+01  0.00000000e+00]
 [-8.07105623e-03  1.84931131e-02]]
grads:  [-9.29190009e-05 -6.72411261e+00]
Stock Position:  -9.29190009432018e-05
Bond Position:  [17.94108769]


portfolio before change:  [17.94109844]
curr_Stock_Price:  96.4499733064003
curr_Factors:  [9.64499733e+01 3.99182725e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.94109844]
Stock Price:  96.46630983679044
PL:  [17.94109844]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.08983921e-02 -2.00679369e-01]
 [-3.43941427e-02  2.56603944e-02]
 [ 2.52183517e-01  1.60015413e-01]
 [ 2.04898166e-01  1.64471334e-01]
 [ 7.20446467e-02 -9.72271263e-02]
 [ 7.78838052e-02 -7.33464299e-02]
 [ 1.51514134e-01 -2.54825676e-01]
 [ 5.38098531e-02 -1.20795302e-01]
 [ 1.30348537e-02 -4.66600280e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.51427932]
curr_Stock_Price:  99.27743014310245
curr_Factors:  [9.92774301e+01 3.80928185e-02]
mat_Sqrt:  [[ 1.93763549e+01  0.00000000e+00]
 [-7.80695265e-03  1.78879757e-02]]
grads:  [-7.14696081e-03 -1.12186740e+01]
Stock Position:  -0.007146960809121447
Bond Position:  [-1.80474742]


portfolio before change:  [-2.50983927]
curr_Stock_Price:  98.52988808532939
curr_Factors:  [9.85298881e+01 3.72099793e-02]
mat_Sqrt:  [[ 1.90063054e+01  0.00000000e+00]
 [-7.71595535e-03  1.76794747e-02]]
grads:  [-1.22038597e-03  1.45142290e+00]
Stock Position:  -0.0012203859694611167
Bond Position:  [-2.38959478]


portfolio before change:  [-2.50924722]
curr_Stock_Price:  97.06547714439276
curr_Factors:  [9.70654771e+01 3.74670799e-02]
mat_Sqrt:  [[ 1.87883965e+01  0.00000000e+00]
 [-7.74256597e-03  1.77404473e-02]]
grads:  [0.0171393 9.0198071]
Stock Position:  0.017139300236667224
Bond Position:  [-4.17288158]


portfolio before change:  [-2.47828683]
curr_Stock_Price:  98.99363953070704
curr_Factors:  [9.89936395e+01 3.46699112e-02]
mat_Sqrt:  [[ 1.84324751e+01  0.00000000e+00]
 [-7.44794320e-03  1.70653818e-02]]
grads:  [0.01501043 9.63771783]
Stock Position:  0.015010428015748407
Bond Position:  [-3.96422373]


portfolio before change:  [-2.50881098]
curr_Stock_Price:  97.09219184407165
curr_Factors:  [9.70921918e+01 3.77060844e-02]
mat_Sqrt:  [[ 1.88534148e+01  0.00000000e+00]
 [-7.76722183e-03  1.77969410e-02]]
grads:  [ 1.57060407e-03 -5.46313697e+00]
Stock Position:  0.0015706040686417312
Bond Position:  [-2.66130437]


portfolio before change:  [-2.5116561]
curr_Stock_Price:  96.12814385680342
curr_Factors:  [9.61281439e+01 3.83836745e-02]
mat_Sqrt:  [[ 1.88331875e+01  0.00000000e+00]
 [-7.83670078e-03  1.79561373e-02]]
grads:  [ 2.43574269e-03 -4.08475547e+00]
Stock Position:  0.0024357426908318794
Bond Position:  [-2.74579953]


portfolio before change:  [-2.51181265]
curr_Stock_Price:  96.62766062328295
curr_Factors:  [9.66276606e+01 4.11238098e-02]
mat_Sqrt:  [[ 1.95951294e+01  0.00000000e+00]
 [-8.11160254e-03  1.85860163e-02]]
grads:  [ 2.05658715e-03 -1.37106130e+01]
Stock Position:  0.00205658714516209
Bond Position:  [-2.71053586]


portfolio before change:  [-2.51697941]
curr_Stock_Price:  94.7745165680818
curr_Factors:  [9.47745166e+01 4.17253040e-02]
mat_Sqrt:  [[ 1.93593750e+01  0.00000000e+00]
 [-8.17070905e-03  1.87214463e-02]]
grads:  [ 5.63273039e-05 -6.45224195e+00]
Stock Position:  5.6327303851052546e-05
Bond Position:  [-2.5223178]


portfolio before change:  [-2.5181191]
curr_Stock_Price:  96.93660154418923
curr_Factors:  [9.69366015e+01 3.96877193e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.5181191]
Stock Price:  96.06798513354724
PL:  [-2.5181191]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.05311391e-02 -3.79882518e-01]
 [-6.56063842e-01 -2.44841710e-01]
 [-2.71022081e-01 -2.56160154e-01]
 [-6.06404262e-02  4.45431540e-02]
 [-2.71629280e-02 -3.04221768e-03]
 [ 8.80414704e-02 -1.55181834e-01]
 [ 1.47689834e-01  9.00100157e-02]
 [-4.46974577e-02  3.89184031e-02]
 [ 4.60587596e-02 -6.71661724e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.32526431]
curr_Stock_Price:  102.15762282008683
curr_Factors:  [1.02157623e+02 3.69360107e-02]
mat_Sqrt:  [[ 1.96334116e+01  0.00000000e+00]
 [-7.68749745e-03  1.76142695e-02]]
grads:  [-1.20369025e-02 -2.15667484e+01]
Stock Position:  -0.012036902546044042
Bond Position:  [18.55492566]


portfolio before change:  [17.30712231]
curr_Stock_Price:  104.43576548555106
curr_Factors:  [1.04435765e+02 3.67408967e-02]
mat_Sqrt:  [[ 2.00181588e+01  0.00000000e+00]
 [-7.66716602e-03  1.75676843e-02]]
grads:  [ -0.03811147 -13.93705086]
Stock Position:  -0.03811147329726998
Bond Position:  [21.2873232]


portfolio before change:  [17.32838776]
curr_Stock_Price:  104.15713218621552
curr_Factors:  [1.04157132e+02 4.03328709e-02]
mat_Sqrt:  [[ 2.09179241e+01  0.00000000e+00]
 [-8.03321813e-03  1.84064151e-02]]
grads:  [ -0.01830103 -13.91689543]
Stock Position:  -0.018301029154665492
Bond Position:  [19.23457047]


portfolio before change:  [17.35343225]
curr_Stock_Price:  103.31429457531536
curr_Factors:  [1.03314295e+02 4.12383705e-02]
mat_Sqrt:  [[ 2.09802743e+01  0.00000000e+00]
 [-8.12289313e-03  1.86118863e-02]]
grads:  [-1.96375888e-03  2.39326381e+00]
Stock Position:  -0.0019637588800382635
Bond Position:  [17.55631661]


portfolio before change:  [17.36359482]
curr_Stock_Price:  102.61043033484653
curr_Factors:  [1.0261043e+02 4.4435986e-02]
mat_Sqrt:  [[ 2.16301195e+01  0.00000000e+00]
 [-8.43193795e-03  1.93199970e-02]]
grads:  [-0.00131718 -0.15746471]
Stock Position:  -0.0013171753691446555
Bond Position:  [17.49875075]


portfolio before change:  [17.37268721]
curr_Stock_Price:  102.35167217596367
curr_Factors:  [1.02351672e+02 4.57810435e-02]
mat_Sqrt:  [[ 2.18996809e+01  0.00000000e+00]
 [-8.55860208e-03  1.96102209e-02]]
grads:  [ 9.27619253e-04 -7.91331389e+00]
Stock Position:  0.0009276192529137894
Bond Position:  [17.27774383]


portfolio before change:  [17.38345149]
curr_Stock_Price:  104.64059447825032
curr_Factors:  [1.04640594e+02 4.73804596e-02]
mat_Sqrt:  [[ 2.27771737e+01  0.00000000e+00]
 [-8.70682120e-03  1.99498336e-02]]
grads:  [0.00820881 4.51181787]
Stock Position:  0.008208807132357101
Bond Position:  [16.52447703]


portfolio before change:  [17.37340632]
curr_Stock_Price:  102.4101270560587
curr_Factors:  [1.02410127e+02 4.74363664e-02]
mat_Sqrt:  [[ 2.23048143e+01  0.00000000e+00]
 [-8.71195651e-03  1.99616001e-02]]
grads:  [-1.24242568e-03  1.94966350e+00]
Stock Position:  -0.0012424256768887533
Bond Position:  [17.50064329]


portfolio before change:  [17.38319096]
curr_Stock_Price:  101.57939053014903
curr_Factors:  [1.01579391e+02 4.79116629e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.38319096]
Stock Price:  104.33601273383347
PL:  [13.04717822]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.87535735e-02 -2.72379639e-01]
 [-2.82082197e-02 -3.20177218e-02]
 [ 2.32588792e-01  1.53341573e-01]
 [ 1.71422659e-01  1.58206385e-01]
 [ 4.26915878e-02 -2.18104810e-02]
 [ 7.68070351e-02 -3.95879398e-02]
 [ 2.66885497e-01 -1.25846330e-01]
 [ 5.72444710e-02  3.82602288e-02]
 [ 4.72459374e-02 -7.96528446e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.67411481]
curr_Stock_Price:  100.03065184381654
curr_Factors:  [1.00030652e+02 4.45212045e-02]
mat_Sqrt:  [[ 2.11065160e+01  0.00000000e+00]
 [-8.44001939e-03  1.93385139e-02]]
grads:  [-8.41587467e-03 -1.40848278e+01]
Stock Position:  -0.008415874673125478
Bond Position:  [3.51596024]


portfolio before change:  [2.69082092]
curr_Stock_Price:  98.25452234992822
curr_Factors:  [9.82545223e+01 4.78198044e-02]
mat_Sqrt:  [[ 2.14860433e+01  0.00000000e+00]
 [-8.74709592e-03  2.00421146e-02]]
grads:  [-0.00196322 -1.59752214]
Stock Position:  -0.0019632232190605137
Bond Position:  [2.88371647]


portfolio before change:  [2.69071028]
curr_Stock_Price:  99.0454960547069
curr_Factors:  [9.90454961e+01 4.38330143e-02]
mat_Sqrt:  [[ 2.07364973e+01  0.00000000e+00]
 [-8.37453419e-03  1.91884684e-02]]
grads:  [0.01444374 7.99133987]
Stock Position:  0.014443738307121423
Bond Position:  [1.26012305]


portfolio before change:  [2.70407607]
curr_Stock_Price:  99.9272328110037
curr_Factors:  [9.99272328e+01 4.57443711e-02]
mat_Sqrt:  [[ 2.13723704e+01  0.00000000e+00]
 [-8.55517350e-03  1.96023651e-02]]
grads:  [0.01125142 8.07078046]
Stock Position:  0.011251423316205253
Bond Position:  [1.57975247]


portfolio before change:  [2.70415745]
curr_Stock_Price:  99.86424584055385
curr_Factors:  [9.98642458e+01 4.64885211e-02]
mat_Sqrt:  [[ 2.15319267e+01  0.00000000e+00]
 [-8.62447875e-03  1.97611634e-02]]
grads:  [ 0.00154063 -1.1037043 ]
Stock Position:  0.0015406291310174495
Bond Position:  [2.55030368]


portfolio before change:  [2.7037708]
curr_Stock_Price:  98.78538509427658
curr_Factors:  [9.87853851e+01 4.74655932e-02]
mat_Sqrt:  [[ 2.15219765e+01  0.00000000e+00]
 [-8.71463993e-03  1.99677486e-02]]
grads:  [ 0.00276598 -1.98259407]
Stock Position:  0.0027659839503701897
Bond Position:  [2.43053201]


portfolio before change:  [2.70824523]
curr_Stock_Price:  99.96357720716712
curr_Factors:  [9.99635772e+01 4.74342925e-02]
mat_Sqrt:  [[ 2.17714825e+01  0.00000000e+00]
 [-8.71176607e-03  1.99611637e-02]]
grads:  [ 0.00973575 -6.30455876]
Stock Position:  0.009735747477720843
Bond Position:  [1.73502508]


portfolio before change:  [2.71357056]
curr_Stock_Price:  100.42143628033965
curr_Factors:  [1.00421436e+02 4.89744096e-02]
mat_Sqrt:  [[ 2.22234271e+01  0.00000000e+00]
 [-8.85206503e-03  2.02826290e-02]]
grads:  [0.00332724 1.88635451]
Stock Position:  0.0033272367680116277
Bond Position:  [2.37944466]


portfolio before change:  [2.71117099]
curr_Stock_Price:  99.34258619799436
curr_Factors:  [9.93425862e+01 4.80170433e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.71117099]
Stock Price:  100.83689277106578
PL:  [1.87427822]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.60920924e-02 -2.79693689e-01]
 [ 1.15918654e-02 -4.88303599e-01]
 [ 2.40026581e-01  1.55874837e-01]
 [ 2.27953882e-01  1.55836419e-01]
 [ 8.61616113e-02 -1.08440968e-01]
 [ 7.79079821e-02 -7.41044136e-02]
 [ 1.19753392e-01 -2.82145420e-01]
 [ 5.44556822e-02 -1.19102311e-01]
 [ 2.60050147e-02  6.90006677e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.15015689]
curr_Stock_Price:  97.15267625974057
curr_Factors:  [9.71526763e+01 4.17393934e-02]
mat_Sqrt:  [[ 1.98485066e+01  0.00000000e+00]
 [-8.17208844e-03  1.87246069e-02]]
grads:  [-1.81254145e-03 -1.49372262e+01]
Stock Position:  -0.001812541453215385
Bond Position:  [-16.97406364]


portfolio before change:  [-17.15712366]
curr_Stock_Price:  96.3127615392918
curr_Factors:  [9.63127615e+01 3.85649525e-02]
mat_Sqrt:  [[ 1.89138629e+01  0.00000000e+00]
 [-7.85518453e-03  1.79984889e-02]]
grads:  [-1.06546874e-02 -2.71302554e+01]
Stock Position:  -0.010654687443835338
Bond Position:  [-16.13094129]


portfolio before change:  [-17.1862423]
curr_Stock_Price:  98.28852549081287
curr_Factors:  [9.82885255e+01 3.69559001e-02]
mat_Sqrt:  [[ 1.88949050e+01  0.00000000e+00]
 [-7.68956696e-03  1.76190113e-02]]
grads:  [0.01630365 8.84696842]
Stock Position:  0.01630365105102246
Bond Position:  [-18.78870412]


portfolio before change:  [-17.22517779]
curr_Stock_Price:  96.47673576675467
curr_Factors:  [9.64767358e+01 3.65446526e-02]
mat_Sqrt:  [[ 1.84431254e+01  0.00000000e+00]
 [-7.64666228e-03  1.75207044e-02]]
grads:  [0.01604752 8.89441517]
Stock Position:  0.016047522524319242
Bond Position:  [-18.77339038]


portfolio before change:  [-17.22871921]
curr_Stock_Price:  96.84112980089905
curr_Factors:  [9.68411298e+01 3.79325484e-02]
mat_Sqrt:  [[ 1.88610496e+01  0.00000000e+00]
 [-7.79051202e-03  1.78503055e-02]]
grads:  [ 2.05895714e-03 -6.07502026e+00]
Stock Position:  0.002058957143908755
Bond Position:  [-17.42811094]


portfolio before change:  [-17.23902701]
curr_Stock_Price:  96.06813359222332
curr_Factors:  [9.60681336e+01 3.77730796e-02]
mat_Sqrt:  [[ 1.86711277e+01  0.00000000e+00]
 [-7.77411907e-03  1.78127446e-02]]
grads:  [ 2.44046129e-03 -4.16019066e+00]
Stock Position:  0.0024404612888805164
Bond Position:  [-17.47347757]


portfolio before change:  [-17.24966808]
curr_Stock_Price:  95.28871332780076
curr_Factors:  [9.52887133e+01 3.85348621e-02]
mat_Sqrt:  [[ 1.87054589e+01  0.00000000e+00]
 [-7.85211942e-03  1.79914658e-02]]
grads:  [-1.80961317e-04 -1.56821808e+01]
Stock Position:  -0.0001809613166392934
Bond Position:  [-17.2324245]


portfolio before change:  [-17.25794862]
curr_Stock_Price:  93.42187119630846
curr_Factors:  [9.34218712e+01 3.89919520e-02]
mat_Sqrt:  [[ 1.84474376e+01  0.00000000e+00]
 [-7.89855196e-03  1.80978561e-02]]
grads:  [ 1.34174304e-04 -6.58101768e+00]
Stock Position:  0.000134174304144011
Bond Position:  [-17.27048343]


portfolio before change:  [-17.26687029]
curr_Stock_Price:  91.30315821270852
curr_Factors:  [9.13031582e+01 4.26440294e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.26687029]
Stock Price:  92.84432530246873
PL:  [-17.26687029]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-1.35655109e-03  7.48850084e-02]
 [ 2.29387113e-01  1.52251101e-01]
 [ 1.72793543e-01  1.34946484e-01]
 [ 4.44645383e-01 -2.89032935e-01]
 [ 7.98682006e-02 -1.35560445e-01]
 [-5.28883871e-02 -4.26108076e-01]
 [ 5.98035868e-02 -1.05083198e-01]
 [ 4.41306237e-02  1.26843890e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.2699929]
curr_Stock_Price:  99.02254558095986
curr_Factors:  [9.90225456e+01 4.13744359e-02]
mat_Sqrt:  [[ 2.01418858e+01  0.00000000e+00]
 [-8.13628278e-03  1.86425659e-02]]
grads:  [-6.59710556e-03 -1.02140261e+01]
Stock Position:  -0.006597105559830604
Bond Position:  [-3.61673072]


portfolio before change:  [-4.27199468]
curr_Stock_Price:  99.05179531341201
curr_Factors:  [9.90517953e+01 4.26851666e-02]
mat_Sqrt:  [[ 2.04644861e+01  0.00000000e+00]
 [-8.26415553e-03  1.89355591e-02]]
grads:  [1.53074677e-03 3.95472919e+00]
Stock Position:  0.001530746772961136
Bond Position:  [-4.4236179]


portfolio before change:  [-4.27371813]
curr_Stock_Price:  99.3711910330424
curr_Factors:  [9.93711910e+01 4.66681105e-02]
mat_Sqrt:  [[ 2.14669628e+01  0.00000000e+00]
 [-8.64112127e-03  1.97992962e-02]]
grads:  [0.01378094 7.6897229 ]
Stock Position:  0.01378094068457723
Bond Position:  [-5.64314662]


portfolio before change:  [-4.36720737]
curr_Stock_Price:  92.79203527771816
curr_Factors:  [9.27920353e+01 5.03263939e-02]
mat_Sqrt:  [[ 2.08165430e+01  0.00000000e+00]
 [-8.97341798e-03  2.05606836e-02]]
grads:  [0.01113004 6.56332673]
Stock Position:  0.011130042946683955
Bond Position:  [-5.3999867]


portfolio before change:  [-4.37901534]
curr_Stock_Price:  91.97377186819467
curr_Factors:  [9.19737719e+01 4.93674949e-02]
mat_Sqrt:  [[ 2.04354658e+01  0.00000000e+00]
 [-8.88751888e-03  2.03638640e-02]]
grads:  [  0.0155857  -14.19342296]
Stock Position:  0.015585701411505068
Bond Position:  [-5.81249109]


portfolio before change:  [-4.39311535]
curr_Stock_Price:  91.25561115207225
curr_Factors:  [9.12556112e+01 5.04113741e-02]
mat_Sqrt:  [[ 2.04891455e+01  0.00000000e+00]
 [-8.98099095e-03  2.05780354e-02]]
grads:  [ 1.01052393e-03 -6.58762814e+00]
Stock Position:  0.0010105239327538428
Bond Position:  [-4.48533133]


portfolio before change:  [-4.39894866]
curr_Stock_Price:  87.70292229867246
curr_Factors:  [8.77029223e+01 5.28196157e-02]
mat_Sqrt:  [[ 2.01563404e+01  0.00000000e+00]
 [-9.19300741e-03  2.10638262e-02]]
grads:  [-1.18502265e-02 -2.02293768e+01]
Stock Position:  -0.011850226458653086
Bond Position:  [-3.35964917]


portfolio before change:  [-4.38399509]
curr_Stock_Price:  86.29925173051558
curr_Factors:  [8.62992517e+01 5.49098902e-02]
mat_Sqrt:  [[ 2.02223824e+01  0.00000000e+00]
 [-9.37314378e-03  2.14765704e-02]]
grads:  [ 6.89410327e-04 -4.89292266e+00]
Stock Position:  0.0006894103271667925
Bond Position:  [-4.44349068]


portfolio before change:  [-4.384643]
curr_Stock_Price:  88.58291758534348
curr_Factors:  [8.85829176e+01 5.31767737e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.384643]
Stock Price:  88.1073636718706
PL:  [-4.384643]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.69094259e-02 -3.46824363e-01]
 [-5.57145295e-01 -1.80481464e-01]
 [-5.09437866e-01  4.77990623e-02]
 [-3.36128096e-01 -5.94517523e-02]
 [-3.85667544e-02 -3.44800125e-03]
 [ 9.30041115e-02 -1.77265344e-01]
 [ 2.24275556e-01 -9.76278736e-02]
 [-4.51694507e-02  3.99305614e-02]
 [ 4.60458943e-02 -6.71356282e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.17352419]
curr_Stock_Price:  101.40972234174228
curr_Factors:  [1.01409722e+02 3.92762042e-02]
mat_Sqrt:  [[ 2.00976069e+01  0.00000000e+00]
 [-7.92728999e-03  1.81637032e-02]]
grads:  [-1.08607949e-02 -1.90943641e+01]
Stock Position:  -0.01086079492681115
Bond Position:  [13.27491439]


portfolio before change:  [12.15585627]
curr_Stock_Price:  103.64777517537905
curr_Factors:  [1.03647775e+02 4.04113228e-02]
mat_Sqrt:  [[ 2.08358642e+01  0.00000000e+00]
 [-8.04102708e-03  1.84243076e-02]]
grads:  [-0.03052016 -9.79583425]
Stock Position:  -0.030520157842866068
Bond Position:  [15.31920273]


portfolio before change:  [12.04832169]
curr_Stock_Price:  107.42220182941001
curr_Factors:  [1.07422202e+02 4.03949419e-02]
mat_Sqrt:  [[ 2.15902437e+01  0.00000000e+00]
 [-8.03939718e-03  1.84205731e-02]]
grads:  [-0.02262951  2.59487379]
Stock Position:  -0.022629510459286767
Bond Position:  [14.47923353]


portfolio before change:  [12.08336099]
curr_Stock_Price:  106.19381166348039
curr_Factors:  [1.06193812e+02 4.01406934e-02]
mat_Sqrt:  [[ 2.12760815e+01  0.00000000e+00]
 [-8.01405699e-03  1.83625114e-02]]
grads:  [-0.01701793 -3.23767   ]
Stock Position:  -0.017017934821501907
Bond Position:  [13.89056035]


portfolio before change:  [12.14674318]
curr_Stock_Price:  102.87759406157582
curr_Factors:  [1.02877594e+02 3.95962032e-02]
mat_Sqrt:  [[ 2.04714013e+01  0.00000000e+00]
 [-7.95951790e-03  1.82375466e-02]]
grads:  [-0.00195744 -0.18906059]
Stock Position:  -0.0019574422347551084
Bond Position:  [12.34812013]


portfolio before change:  [12.15016199]
curr_Stock_Price:  104.28595651910062
curr_Factors:  [1.04285957e+02 3.79117635e-02]
mat_Sqrt:  [[ 2.03054595e+01  0.00000000e+00]
 [-7.78837734e-03  1.78454144e-02]]
grads:  [ 7.70195459e-04 -9.93338347e+00]
Stock Position:  0.0007701954592162338
Bond Position:  [12.06984142]


portfolio before change:  [12.15412654]
curr_Stock_Price:  101.59588211823475
curr_Factors:  [1.01595882e+02 4.12425932e-02]
mat_Sqrt:  [[ 2.06323686e+01  0.00000000e+00]
 [-8.12330900e-03  1.86128392e-02]]
grads:  [ 0.00880496 -5.24518976]
Stock Position:  0.008804963826528182
Bond Position:  [11.25957847]


portfolio before change:  [12.16711434]
curr_Stock_Price:  102.43138804574582
curr_Factors:  [1.02431388e+02 3.99505434e-02]
mat_Sqrt:  [[ 2.04736089e+01  0.00000000e+00]
 [-7.99505281e-03  1.83189673e-02]]
grads:  [-1.35502857e-03  2.17973866e+00]
Stock Position:  -0.0013550285686160489
Bond Position:  [12.30591179]


portfolio before change:  [12.17442576]
curr_Stock_Price:  101.57758736210955
curr_Factors:  [1.01577587e+02 4.02191077e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.17442576]
Stock Price:  100.10068887455003
PL:  [12.07373688]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 7.72929404e-02 -2.73911736e-01]
 [-1.78012338e-02 -1.51328036e-01]
 [ 2.34049890e-01  1.53839214e-01]
 [ 2.34920601e-03  7.77577067e-02]
 [-5.01750248e-02 -3.87909492e-03]
 [ 2.48985513e-01 -4.94404501e-03]
 [ 1.40280497e-01  1.36616675e-01]
 [-5.03765122e-01 -5.20110445e-01]
 [ 2.27982798e-02  7.21378696e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.28531982]
curr_Stock_Price:  97.85892577675132
curr_Factors:  [9.78589258e+01 4.02306115e-02]
mat_Sqrt:  [[ 1.96281226e+01  0.00000000e+00]
 [-8.02302801e-03  1.83830666e-02]]
grads:  [-2.15262268e-03 -1.49002200e+01]
Stock Position:  -0.0021526226824467977
Bond Position:  [-12.07466647]


portfolio before change:  [-12.29116604]
curr_Stock_Price:  97.76944399375685
curr_Factors:  [9.77694440e+01 3.78002418e-02]
mat_Sqrt:  [[ 1.90086132e+01  0.00000000e+00]
 [-7.77691372e-03  1.78191479e-02]]
grads:  [-4.41095846e-03 -8.49243955e+00]
Stock Position:  -0.004410958463437171
Bond Position:  [-11.85990908]


portfolio before change:  [-12.30204212]
curr_Stock_Price:  98.8904351098651
curr_Factors:  [9.88904351e+01 3.72213759e-02]
mat_Sqrt:  [[ 1.90787756e+01  0.00000000e+00]
 [-7.71713687e-03  1.76821819e-02]]
grads:  [0.0157867  8.70023928]
Stock Position:  0.01578669588102426
Bond Position:  [-13.86319535]


portfolio before change:  [-12.25217158]
curr_Stock_Price:  102.48864672704686
curr_Factors:  [1.02488647e+02 3.41588200e-02]
mat_Sqrt:  [[ 1.89420591e+01  0.00000000e+00]
 [-7.39284194e-03  1.69391289e-02]]
grads:  [1.91560227e-03 4.59041945e+00]
Stock Position:  0.0019156022654476894
Bond Position:  [-12.44849906]


portfolio before change:  [-12.25713188]
curr_Stock_Price:  103.1492768434744
curr_Factors:  [1.03149277e+02 3.43958600e-02]
mat_Sqrt:  [[ 1.91301896e+01  0.00000000e+00]
 [-7.41844836e-03  1.69978006e-02]]
grads:  [-0.00271132 -0.22821158]
Stock Position:  -0.00271131660038165
Bond Position:  [-11.97746154]


portfolio before change:  [-12.27051967]
curr_Stock_Price:  105.87767815724794
curr_Factors:  [1.05877678e+02 3.62902844e-02]
mat_Sqrt:  [[ 2.01697073e+01  0.00000000e+00]
 [-7.62000361e-03  1.74596217e-02]]
grads:  [ 0.01223755 -0.28317023]
Stock Position:  0.01223754769185921
Bond Position:  [-13.56620281]


portfolio before change:  [-12.26849691]
curr_Stock_Price:  106.59739364398386
curr_Factors:  [1.06597394e+02 3.50151473e-02]
mat_Sqrt:  [[ 1.99468612e+01  0.00000000e+00]
 [-7.48493391e-03  1.71501381e-02]]
grads:  [0.01002187 7.96592272]
Stock Position:  0.010021872642378412
Bond Position:  [-13.33680242]


portfolio before change:  [-12.247702]
curr_Stock_Price:  109.33789760455709
curr_Factors:  [1.09337898e+02 3.13114705e-02]
mat_Sqrt:  [[ 1.93473929e+01  0.00000000e+00]
 [-7.07801899e-03  1.62177789e-02]]
grads:  [ -0.03777046 -32.07038695]
Stock Position:  -0.03777045999617542
Bond Position:  [-8.11795931]


portfolio before change:  [-12.2099275]
curr_Stock_Price:  108.23029929780357
curr_Factors:  [1.08230299e+02 3.16119893e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.2099275]
Stock Price:  109.67402412839469
PL:  [-21.88395163]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.17861901e-02 -2.08782982e-01]
 [-9.95031268e-02  5.81909829e-02]
 [ 2.28046702e-01  1.51794565e-01]
 [-5.09341298e-02  4.85929941e-02]
 [-2.26531100e-01  1.30302333e-02]
 [ 1.89872521e-01 -7.00546645e-02]
 [ 6.71677908e-02  2.42030270e-01]
 [-6.07653879e-01 -6.13526146e-01]
 [ 2.08225749e-02  1.81831790e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.93604695]
curr_Stock_Price:  99.36137464694083
curr_Factors:  [9.93613746e+01 3.64394250e-02]
mat_Sqrt:  [[ 1.89672055e+01  0.00000000e+00]
 [-7.63564536e-03  1.74954614e-02]]
grads:  [-7.53440215e-03 -1.19335511e+01]
Stock Position:  -0.007534402153528938
Bond Position:  [-1.1874184]


portfolio before change:  [-1.94403568]
curr_Stock_Price:  100.34285598694704
curr_Factors:  [1.00342856e+02 3.67625897e-02]
mat_Sqrt:  [[ 1.92393106e+01  0.00000000e+00]
 [-7.66942915e-03  1.75728698e-02]]
grads:  [-0.00385183  3.31141035]
Stock Position:  -0.0038518271886637304
Bond Position:  [-1.55753234]


portfolio before change:  [-1.94156212]
curr_Stock_Price:  99.4984444829421
curr_Factors:  [9.94984445e+01 4.03262633e-02]
mat_Sqrt:  [[ 1.99806808e+01  0.00000000e+00]
 [-8.03256007e-03  1.84049073e-02]]
grads:  [0.01472899 8.24750503]
Stock Position:  0.01472899167729612
Bond Position:  [-3.40707388]


portfolio before change:  [-1.8885601]
curr_Stock_Price:  103.2126145400118
curr_Factors:  [1.03212615e+02 3.87690215e-02]
mat_Sqrt:  [[ 2.03224095e+01  0.00000000e+00]
 [-7.87594022e-03  1.80460461e-02]]
grads:  [-1.46274035e-03  2.69272248e+00]
Stock Position:  -0.0014627403544489204
Bond Position:  [-1.73758684]


portfolio before change:  [-1.89540819]
curr_Stock_Price:  107.30020423996969
curr_Factors:  [1.07300204e+02 3.87825399e-02]
mat_Sqrt:  [[ 2.11309330e+01  0.00000000e+00]
 [-7.87731324e-03  1.80491921e-02]]
grads:  [-0.01045123  0.72192889]
Stock Position:  -0.01045122995472011
Bond Position:  [-0.77398909]


portfolio before change:  [-1.87469694]
curr_Stock_Price:  105.28146134043082
curr_Factors:  [1.05281461e+02 4.10056397e-02]
mat_Sqrt:  [[ 2.13193373e+01  0.00000000e+00]
 [-8.09993972e-03  1.85592934e-02]]
grads:  [ 0.007472  -3.7746407]
Stock Position:  0.007472003327328992
Bond Position:  [-2.66136037]


portfolio before change:  [-1.84181827]
curr_Stock_Price:  109.8598423164846
curr_Factors:  [1.09859842e+02 3.89040475e-02]
mat_Sqrt:  [[ 2.16688750e+01  0.00000000e+00]
 [-7.88964359e-03  1.80774445e-02]]
grads:  [7.97450077e-03 1.33885224e+01]
Stock Position:  0.007974500774458427
Bond Position:  [-2.71789567]


portfolio before change:  [-1.83140049]
curr_Stock_Price:  111.33668396754099
curr_Factors:  [1.11336684e+02 3.57418391e-02]
mat_Sqrt:  [[ 2.10487704e+01  0.00000000e+00]
 [-7.56220488e-03  1.73271881e-02]]
grads:  [ -0.04159001 -35.40829252]
Stock Position:  -0.04159001340508882
Bond Position:  [2.79909369]


portfolio before change:  [-1.73832358]
curr_Stock_Price:  109.13238060611276
curr_Factors:  [1.09132381e+02 3.90503341e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.73832358]
Stock Price:  109.21741539789541
PL:  [-10.95573898]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-2.05937519e-02 -2.09590056e-01]
 [-1.18591063e-02  6.37509060e-02]
 [ 2.57313743e-01  1.61762735e-01]
 [ 9.49025055e-02  1.29750479e-01]
 [ 3.34734861e-02 -1.25859035e-02]
 [ 8.82083865e-02 -1.58206636e-01]
 [ 2.07860467e-01 -6.85972500e-02]
 [-2.64405191e-01 -2.84528210e-01]
 [ 3.09788913e-02 -3.13644492e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.59025796]
curr_Stock_Price:  98.39535394701451
curr_Factors:  [9.83953539e+01 3.84024668e-02]
mat_Sqrt:  [[ 1.92820921e+01  0.00000000e+00]
 [-7.83861894e-03  1.79605323e-02]]
grads:  [-5.81193945e-03 -1.16694791e+01]
Stock Position:  -0.005811939446012559
Bond Position:  [-8.01839012]


portfolio before change:  [-8.59743436]
curr_Stock_Price:  98.94012955811162
curr_Factors:  [9.89401296e+01 3.59929782e-02]
mat_Sqrt:  [[ 1.87707388e+01  0.00000000e+00]
 [-7.58872618e-03  1.73879561e-02]]
grads:  [8.50476390e-04 3.66638297e+00]
Stock Position:  0.0008504763897624446
Bond Position:  [-8.68158061]


portfolio before change:  [-8.60381003]
curr_Stock_Price:  96.54877995825335
curr_Factors:  [9.65487800e+01 3.72104946e-02]
mat_Sqrt:  [[ 1.86242808e+01  0.00000000e+00]
 [-7.71600877e-03  1.76795971e-02]]
grads:  [0.01760674 9.14968446]
Stock Position:  0.01760673558617631
Bond Position:  [-10.30371887]


portfolio before change:  [-8.52634711]
curr_Stock_Price:  101.241078587379
curr_Factors:  [1.01241079e+02 3.26150537e-02]
mat_Sqrt:  [[ 1.82837726e+01  0.00000000e+00]
 [-7.22385534e-03  1.65519319e-02]]
grads:  [0.00828769 7.838993  ]
Stock Position:  0.008287690938118862
Bond Position:  [-9.36540188]


portfolio before change:  [-8.53348526]
curr_Stock_Price:  100.94494320231105
curr_Factors:  [1.00944943e+02 3.37813184e-02]
mat_Sqrt:  [[ 1.85533726e+01  0.00000000e+00]
 [-7.35187796e-03  1.68452686e-02]]
grads:  [ 0.00150811 -0.74714769]
Stock Position:  0.0015081111190368202
Bond Position:  [-8.68572145]


portfolio before change:  [-8.53609367]
curr_Stock_Price:  102.09574501122172
curr_Factors:  [1.02095745e+02 3.29084588e-02]
mat_Sqrt:  [[ 1.85208713e+01  0.00000000e+00]
 [-7.25627550e-03  1.66262159e-02]]
grads:  [ 1.03458144e-03 -9.51549274e+00]
Stock Position:  0.0010345814374168106
Bond Position:  [-8.64172004]


portfolio before change:  [-8.54046982]
curr_Stock_Price:  102.04334649181932
curr_Factors:  [1.02043346e+02 3.19319792e-02]
mat_Sqrt:  [[ 1.82346575e+01  0.00000000e+00]
 [-7.14780852e-03  1.63776868e-02]]
grads:  [ 0.00975736 -4.1884578 ]
Stock Position:  0.009757363001474144
Bond Position:  [-9.5361438]


portfolio before change:  [-8.51678065]
curr_Stock_Price:  104.95995767031128
curr_Factors:  [1.04959958e+02 3.17315816e-02]
mat_Sqrt:  [[ 1.86968957e+01  0.00000000e+00]
 [-7.12534424e-03  1.63262147e-02]]
grads:  [ -0.02078332 -17.42769015]
Stock Position:  -0.020783315482808675
Bond Position:  [-6.33536474]


portfolio before change:  [-8.5207966]
curr_Stock_Price:  105.00073401356593
curr_Factors:  [1.05000734e+02 2.95533930e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.5207966]
Stock Price:  106.28258394870748
PL:  [-14.80338054]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.02597612e-02 -1.94850094e-01]
 [-1.12418662e-01  5.51722449e-02]
 [ 2.46366333e-01  1.58034116e-01]
 [ 1.63843865e-01  1.56598782e-01]
 [ 2.15711662e-02 -7.05629581e-03]
 [ 8.46445459e-02 -1.20236241e-01]
 [ 1.47756551e-01  8.95903502e-02]
 [-3.37415730e-03  6.92176123e-03]
 [ 4.41900784e-02 -6.27296610e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.91462213]
curr_Stock_Price:  99.21931063962033
curr_Factors:  [9.92193106e+01 4.15698997e-02]
mat_Sqrt:  [[ 2.02295254e+01  0.00000000e+00]
 [-8.15547911e-03  1.86865502e-02]]
grads:  [-6.68821002e-03 -1.04272909e+01]
Stock Position:  -0.006688210017556984
Bond Position:  [-2.25102255]


portfolio before change:  [-2.92380286]
curr_Stock_Price:  100.42365829919343
curr_Factors:  [1.00423658e+02 3.92574635e-02]
mat_Sqrt:  [[ 1.98974378e+01  0.00000000e+00]
 [-7.92539851e-03  1.81593693e-02]]
grads:  [-0.00443974  3.03822473]
Stock Position:  -0.004439743488185254
Bond Position:  [-2.47794757]


portfolio before change:  [-2.91273321]
curr_Stock_Price:  97.65121586280745
curr_Factors:  [9.76512159e+01 3.76368671e-02]
mat_Sqrt:  [[ 1.89445541e+01  0.00000000e+00]
 [-7.76008939e-03  1.77805985e-02]]
grads:  [0.01664532 8.88800882]
Stock Position:  0.016645315270086274
Bond Position:  [-4.53816848]


portfolio before change:  [-2.87382623]
curr_Stock_Price:  100.12498266979374
curr_Factors:  [1.00124983e+02 3.62048299e-02]
mat_Sqrt:  [[ 1.90513480e+01  0.00000000e+00]
 [-7.61102672e-03  1.74390530e-02]]
grads:  [0.01218755 8.97977552]
Stock Position:  0.012187545812132002
Bond Position:  [-4.09410404]


portfolio before change:  [-2.86066325]
curr_Stock_Price:  101.37302228018217
curr_Factors:  [1.01373022e+02 3.98753081e-02]
mat_Sqrt:  [[ 2.02429788e+01  0.00000000e+00]
 [-7.98752108e-03  1.83017100e-02]]
grads:  [ 0.00091348 -0.38555391]
Stock Position:  0.0009134795023430176
Bond Position:  [-2.95326543]


portfolio before change:  [-2.8628033]
curr_Stock_Price:  100.64718247001774
curr_Factors:  [1.00647182e+02 4.04697046e-02]
mat_Sqrt:  [[ 2.02472777e+01  0.00000000e+00]
 [-8.04683337e-03  1.84376115e-02]]
grads:  [ 1.58881350e-03 -6.52124822e+00]
Stock Position:  0.001588813497156529
Bond Position:  [-3.0227129]


portfolio before change:  [-2.8579705]
curr_Stock_Price:  104.6404322657446
curr_Factors:  [1.04640432e+02 3.96211748e-02]
mat_Sqrt:  [[ 2.08287496e+01  0.00000000e+00]
 [-7.96202736e-03  1.82432965e-02]]
grads:  [0.00897111 4.91086411]
Stock Position:  0.008971109100103474
Bond Position:  [-3.79671123]


portfolio before change:  [-2.8888568]
curr_Stock_Price:  101.40922981582223
curr_Factors:  [1.01409230e+02 4.55368264e-02]
mat_Sqrt:  [[ 2.16400801e+01  0.00000000e+00]
 [-8.53574380e-03  1.95578460e-02]]
grads:  [-1.63240172e-05  3.53912246e-01]
Stock Position:  -1.632401723219689e-05
Bond Position:  [-2.88720139]


portfolio before change:  [-2.8903105]
curr_Stock_Price:  102.00588659012091
curr_Factors:  [1.02005887e+02 4.97446828e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.8903105]
Stock Price:  102.45374443989962
PL:  [-5.34405494]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.41550936e-02 -4.12961133e-01]
 [-3.16014753e-01 -2.42426593e-02]
 [ 2.27165001e-01  1.51494264e-01]
 [ 2.20051860e-01  1.60459186e-01]
 [ 6.59539579e-03 -2.87546783e-02]
 [ 8.83258969e-02 -1.60336124e-01]
 [ 1.93012022e-01 -4.18666741e-02]
 [-4.52312370e-02  3.99454757e-02]
 [ 3.95162115e-02 -5.16332451e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.48286995]
curr_Stock_Price:  102.90637482104049
curr_Factors:  [1.02906375e+02 4.12789620e-02]
mat_Sqrt:  [[ 2.09077194e+01  0.00000000e+00]
 [-8.12688989e-03  1.86210440e-02]]
grads:  [-1.21670902e-02 -2.21771203e+01]
Stock Position:  -0.012167090200493799
Bond Position:  [23.7349411]


portfolio before change:  [22.50894284]
curr_Stock_Price:  101.73909035276102
curr_Factors:  [1.01739090e+02 3.94855177e-02]
mat_Sqrt:  [[ 2.02165372e+01  0.00000000e+00]
 [-7.94838527e-03  1.82120386e-02]]
grads:  [-0.01615485 -1.33113376]
Stock Position:  -0.016154849578265608
Bond Position:  [24.15252254]


portfolio before change:  [22.55577233]
curr_Stock_Price:  99.5880210900237
curr_Factors:  [9.95880211e+01 4.10114591e-02]
mat_Sqrt:  [[ 2.01678551e+01  0.00000000e+00]
 [-8.10051446e-03  1.85606103e-02]]
grads:  [0.01454208 8.16213805]
Stock Position:  0.01454207782204882
Bond Position:  [21.10755557]


portfolio before change:  [22.53697501]
curr_Stock_Price:  97.56948355201177
curr_Factors:  [9.75694836e+01 4.22000304e-02]
mat_Sqrt:  [[ 2.00433536e+01  0.00000000e+00]
 [-8.21705839e-03  1.88276460e-02]]
grads:  [0.01447273 8.52253041]
Stock Position:  0.014472727249648366
Bond Position:  [21.12487849]


portfolio before change:  [22.56727702]
curr_Stock_Price:  98.93321567202011
curr_Factors:  [9.89332157e+01 4.36359512e-02]
mat_Sqrt:  [[ 2.06663771e+01  0.00000000e+00]
 [-8.35568800e-03  1.91452864e-02]]
grads:  [-2.88109262e-04 -1.50191946e+00]
Stock Position:  -0.0002881092623531435
Bond Position:  [22.59578059]


portfolio before change:  [22.57772423]
curr_Stock_Price:  101.89564453614439
curr_Factors:  [1.01895645e+02 4.18744670e-02]
mat_Sqrt:  [[ 2.08511622e+01  0.00000000e+00]
 [-8.18530068e-03  1.87548800e-02]]
grads:  [ 8.80021712e-04 -8.54903493e+00]
Stock Position:  0.0008800217122852907
Bond Position:  [22.48805385]


portfolio before change:  [22.5894555]
curr_Stock_Price:  102.44612645593095
curr_Factors:  [1.02446126e+02 4.34526892e-02]
mat_Sqrt:  [[ 2.13552112e+01  0.00000000e+00]
 [-8.33812345e-03  1.91050409e-02]]
grads:  [ 0.00818254 -2.19139411]
Stock Position:  0.008182541753269688
Bond Position:  [21.75118579]


portfolio before change:  [22.6001567]
curr_Stock_Price:  102.42448104282515
curr_Factors:  [1.02424481e+02 4.75289525e-02]
mat_Sqrt:  [[ 2.23297003e+01  0.00000000e+00]
 [-8.72045435e-03  1.99810711e-02]]
grads:  [-1.24487126e-03  1.99916589e+00]
Stock Position:  -0.0012448712611968817
Bond Position:  [22.72766199]


portfolio before change:  [22.61072274]
curr_Stock_Price:  103.06762329183309
curr_Factors:  [1.03067623e+02 4.62050001e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.61072274]
Stock Price:  103.38109137680325
PL:  [19.22963137]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.04689252e-02 -3.79314645e-01]
 [ 5.83976037e-04  7.93384025e-02]
 [ 2.59225393e-01  1.62413831e-01]
 [ 1.97021721e-01  1.44059459e-01]
 [ 3.75922466e-01 -2.64140094e-01]
 [ 7.75554580e-02 -6.30522119e-02]
 [ 6.93913282e-02 -3.23940621e-01]
 [ 5.48721325e-02 -1.18010619e-01]
 [ 2.68722837e-02  7.17682858e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.23774633]
curr_Stock_Price:  102.14491745545362
curr_Factors:  [1.02144917e+02 3.94198553e-02]
mat_Sqrt:  [[ 2.02802953e+01  0.00000000e+00]
 [-7.94177363e-03  1.81968894e-02]]
grads:  [-1.16376712e-02 -2.08450267e+01]
Stock Position:  -0.011637671188172735
Bond Position:  [18.4264753]


portfolio before change:  [17.2823911]
curr_Stock_Price:  99.10056081832687
curr_Factors:  [9.91005608e+01 3.85894278e-02]
mat_Sqrt:  [[ 1.94675044e+01  0.00000000e+00]
 [-7.85767678e-03  1.80041993e-02]]
grads:  [1.80865985e-03 4.40666097e+00]
Stock Position:  0.001808659853775588
Bond Position:  [17.10315189]


portfolio before change:  [17.28598531]
curr_Stock_Price:  96.35847233318458
curr_Factors:  [9.63584723e+01 3.89567476e-02]
mat_Sqrt:  [[ 1.90187186e+01  0.00000000e+00]
 [-7.89498551e-03  1.80896844e-02]]
grads:  [0.01735704 8.97825677]
Stock Position:  0.01735703687730361
Bond Position:  [15.61348775]


portfolio before change:  [17.25801836]
curr_Stock_Price:  94.29731183057358
curr_Factors:  [9.42973118e+01 3.69591523e-02]
mat_Sqrt:  [[ 1.81284350e+01  0.00000000e+00]
 [-7.68990531e-03  1.76197866e-02]]
grads:  [0.01433629 8.17600478]
Stock Position:  0.014336285726536746
Bond Position:  [15.90614516]


portfolio before change:  [17.24466415]
curr_Stock_Price:  92.8109247397713
curr_Factors:  [9.28109247e+01 3.51527319e-02]
mat_Sqrt:  [[ 1.74011777e+01  0.00000000e+00]
 [-7.49962473e-03  1.71837990e-02]]
grads:  [ 1.49784275e-02 -1.53714609e+01]
Stock Position:  0.014978427480977947
Bond Position:  [15.85450245]


portfolio before change:  [17.31434343]
curr_Stock_Price:  96.93352307478474
curr_Factors:  [9.69335231e+01 3.53940520e-02]
mat_Sqrt:  [[ 1.82364013e+01  0.00000000e+00]
 [-7.52532280e-03  1.72426807e-02]]
grads:  [ 2.74380981e-03 -3.65675228e+00]
Stock Position:  0.002743809806873483
Bond Position:  [17.04837628]


portfolio before change:  [17.31227905]
curr_Stock_Price:  93.07367341050796
curr_Factors:  [9.30736734e+01 3.90713557e-02]
mat_Sqrt:  [[ 1.83973849e+01  0.00000000e+00]
 [-7.90659024e-03  1.81162741e-02]]
grads:  [-3.91294468e-03 -1.78811945e+01]
Stock Position:  -0.003912944682991327
Bond Position:  [17.67647119]


portfolio before change:  [17.32204489]
curr_Stock_Price:  92.83717817660849
curr_Factors:  [9.28371782e+01 3.99475101e-02]
mat_Sqrt:  [[ 1.85552491e+01  0.00000000e+00]
 [-7.99474928e-03  1.83182719e-02]]
grads:  [ 1.81516066e-04 -6.44223538e+00]
Stock Position:  0.00018151606565346324
Bond Position:  [17.30519345]


portfolio before change:  [17.33039765]
curr_Stock_Price:  91.1733812005195
curr_Factors:  [9.11733812e+01 4.02251505e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.33039765]
Stock Price:  92.60152140647757
PL:  [17.33039765]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.92052086e-02 -3.67779733e-01]
 [-9.53847611e-03 -2.46055966e-01]
 [ 2.62194404e-01  1.63425058e-01]
 [ 2.13681182e-01  1.50325604e-01]
 [ 5.22020368e-01 -3.17080315e-01]
 [ 7.94384371e-02 -1.22086662e-01]
 [ 1.25897573e-01 -2.77440296e-01]
 [ 5.27798870e-02 -1.23495277e-01]
 [ 4.69892411e-02 -7.94227192e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.44084689]
curr_Stock_Price:  101.88405376180008
curr_Factors:  [1.01884054e+02 4.19498833e-02]
mat_Sqrt:  [[ 2.08675563e+01  0.00000000e+00]
 [-8.19266826e-03  1.87717612e-02]]
grads:  [-1.10083538e-02 -1.95921804e+01]
Stock Position:  -0.011008353815827803
Bond Position:  [16.5624226]


portfolio before change:  [15.49921991]
curr_Stock_Price:  97.33389621463148
curr_Factors:  [9.73338962e+01 4.67554204e-02]
mat_Sqrt:  [[ 2.10465101e+01  0.00000000e+00]
 [-8.64920069e-03  1.98178084e-02]]
grads:  [-5.55560534e-03 -1.24159019e+01]
Stock Position:  -0.0055556053413528894
Bond Position:  [16.03996863]


portfolio before change:  [15.51428173]
curr_Stock_Price:  96.0667385628793
curr_Factors:  [9.60667386e+01 4.48417476e-02]
mat_Sqrt:  [[ 2.03429678e+01  0.00000000e+00]
 [-8.47034806e-03  1.94080056e-02]]
grads:  [0.0163948  8.42049725]
Stock Position:  0.01639480282416856
Bond Position:  [13.93928649]


portfolio before change:  [15.5088429]
curr_Stock_Price:  95.30977825509967
curr_Factors:  [9.53097783e+01 4.46796713e-02]
mat_Sqrt:  [[ 2.01461677e+01  0.00000000e+00]
 [-8.45502656e-03  1.93728996e-02]]
grads:  [0.01386312 7.75958204]
Stock Position:  0.013863115762522433
Bond Position:  [14.18755241]


portfolio before change:  [15.45650363]
curr_Stock_Price:  91.02251519042187
curr_Factors:  [9.10225152e+01 4.94982302e-02]
mat_Sqrt:  [[ 2.02508691e+01  0.00000000e+00]
 [-8.89927909e-03  2.03908100e-02]]
grads:  [  0.01894413 -15.55015787]
Stock Position:  0.01894413375328522
Bond Position:  [13.73216092]


portfolio before change:  [15.48777163]
curr_Stock_Price:  92.31052387592936
curr_Factors:  [9.23105239e+01 4.74090334e-02]
mat_Sqrt:  [[ 2.00993386e+01  0.00000000e+00]
 [-8.70944622e-03  1.99558483e-02]]
grads:  [ 1.30130897e-03 -6.11783875e+00]
Stock Position:  0.001301308965175774
Bond Position:  [15.36764712]


portfolio before change:  [15.49969009]
curr_Stock_Price:  95.56318026304822
curr_Factors:  [9.55631803e+01 4.55929091e-02]
mat_Sqrt:  [[ 2.04051244e+01  0.00000000e+00]
 [-8.54099845e-03  1.95698860e-02]]
grads:  [ 2.35857465e-04 -1.41768989e+01]
Stock Position:  0.00023585746456606543
Bond Position:  [15.4771508]


portfolio before change:  [15.50777571]
curr_Stock_Price:  97.02639152003988
curr_Factors:  [9.70263915e+01 4.69794770e-02]
mat_Sqrt:  [[ 2.10302274e+01  0.00000000e+00]
 [-8.66989984e-03  1.98652361e-02]]
grads:  [-5.31554186e-05 -6.21665286e+00]
Stock Position:  -5.3155418567817276e-05
Bond Position:  [15.51293319]


portfolio before change:  [15.51541179]
curr_Stock_Price:  99.32760757348252
curr_Factors:  [9.93276076e+01 4.49562502e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.51541179]
Stock Price:  97.40754936208803
PL:  [15.51541179]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-3.62794683e-01 -5.43868189e-02]
 [ 2.14910292e-01  1.59169780e-01]
 [ 1.70002979e-01  1.57905245e-01]
 [ 3.93543231e-02 -1.67871125e-02]
 [ 9.06339840e-02 -1.77952620e-01]
 [ 1.66756476e-01  3.29722089e-02]
 [-5.08779880e-02  6.35211250e-02]
 [ 3.78250559e-02 -4.76182045e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.05371683]
curr_Stock_Price:  98.90876897567999
curr_Factors:  [9.89087690e+01 4.19013624e-02]
mat_Sqrt:  [[ 2.02464492e+01  0.00000000e+00]
 [-8.18792891e-03  1.87609020e-02]]
grads:  [-6.56303461e-03 -1.01496001e+01]
Stock Position:  -0.0065630346086973535
Bond Position:  [-4.40457516]


portfolio before change:  [-5.07690492]
curr_Stock_Price:  102.10626094621398
curr_Factors:  [1.02106261e+02 4.21947367e-02]
mat_Sqrt:  [[ 2.09740121e+01  0.00000000e+00]
 [-8.21654300e-03  1.88264651e-02]]
grads:  [-0.01842905 -2.88884921]
Stock Position:  -0.01842904613893675
Bond Position:  [-3.19518393]


portfolio before change:  [-5.03829322]
curr_Stock_Price:  99.9243959841517
curr_Factors:  [9.99243960e+01 4.11078341e-02]
mat_Sqrt:  [[ 2.02597382e+01  0.00000000e+00]
 [-8.11002680e-03  1.85824058e-02]]
grads:  [0.01403659 8.56561748]
Stock Position:  0.014036591973110857
Bond Position:  [-6.4408912]


portfolio before change:  [-5.04085542]
curr_Stock_Price:  99.97134838672986
curr_Factors:  [9.99713484e+01 4.00532487e-02]
mat_Sqrt:  [[ 2.00075736e+01  0.00000000e+00]
 [-8.00532310e-03  1.83424995e-02]]
grads:  [0.0119414  8.60870921]
Stock Position:  0.011941401907128666
Bond Position:  [-6.23465347]


portfolio before change:  [-5.03581681]
curr_Stock_Price:  100.6544105558026
curr_Factors:  [1.00654411e+02 4.07906622e-02]
mat_Sqrt:  [[ 2.03288676e+01  0.00000000e+00]
 [-8.07867931e-03  1.85105797e-02]]
grads:  [ 0.00157549 -0.90689286]
Stock Position:  0.001575485028404097
Bond Position:  [-5.19439633]


portfolio before change:  [-5.03276952]
curr_Stock_Price:  104.23752226645695
curr_Factors:  [1.04237522e+02 3.90307800e-02]
mat_Sqrt:  [[ 2.05933829e+01  0.00000000e+00]
 [-7.90248366e-03  1.81068648e-02]]
grads:  [ 6.29769939e-04 -9.82790903e+00]
Stock Position:  0.0006297699385996359
Bond Position:  [-5.09841518]


portfolio before change:  [-5.03570191]
curr_Stock_Price:  103.6300867618642
curr_Factors:  [1.03630087e+02 4.10746641e-02]
mat_Sqrt:  [[ 2.10025909e+01  0.00000000e+00]
 [-8.10675414e-03  1.85749072e-02]]
grads:  [0.00862497 1.77509414]
Stock Position:  0.008624970529654863
Bond Position:  [-5.92950835]


portfolio before change:  [-5.0458478]
curr_Stock_Price:  102.79757371443677
curr_Factors:  [1.02797574e+02 4.42106348e-02]
mat_Sqrt:  [[ 2.16145521e+01  0.00000000e+00]
 [-8.41053005e-03  1.92709453e-02]]
grads:  [-1.07127347e-03  3.29621220e+00]
Stock Position:  -0.0010712734705033311
Bond Position:  [-4.93572349]


portfolio before change:  [-5.04901708]
curr_Stock_Price:  103.45174589584443
curr_Factors:  [1.03451746e+02 4.48463156e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.04901708]
Stock Price:  106.18172820218057
PL:  [-11.23074528]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.87823700e-02 -3.63920161e-01]
 [-2.12183439e-01  3.18543006e-02]
 [ 2.41118362e-01  1.56246691e-01]
 [ 2.09531389e-01  1.48764737e-01]
 [ 4.79251695e-02 -7.78356284e-02]
 [ 7.70331205e-02 -4.66760829e-02]
 [ 2.65507758e-01 -1.26377219e-01]
 [ 6.28904657e-02  4.11310081e-02]
 [ 8.25655611e-03 -3.99969847e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.83677781]
curr_Stock_Price:  101.7963584315914
curr_Factors:  [1.01796358e+02 3.57355140e-02]
mat_Sqrt:  [[ 1.92434200e+01  0.00000000e+00]
 [-7.56153572e-03  1.73256549e-02]]
grads:  [-1.18279469e-02 -2.10046987e+01]
Stock Position:  -0.011827946862001238
Bond Position:  [16.04081973]


portfolio before change:  [14.8533263]
curr_Stock_Price:  101.07551680835086
curr_Factors:  [1.01075517e+02 3.49120621e-02]
mat_Sqrt:  [[ 1.88857276e+01  0.00000000e+00]
 [-7.47390790e-03  1.71248743e-02]]
grads:  [-0.01049899  1.8601188 ]
Stock Position:  -0.0104989909187514
Bond Position:  [15.91451723]


portfolio before change:  [14.89171367]
curr_Stock_Price:  98.17732233994428
curr_Factors:  [9.81773223e+01 3.58730609e-02]
mat_Sqrt:  [[ 1.85949665e+01  0.00000000e+00]
 [-7.57607401e-03  1.73589663e-02]]
grads:  [0.01663407 9.00092135]
Stock Position:  0.01663407182180333
Bond Position:  [13.25862504]


portfolio before change:  [14.84663397]
curr_Stock_Price:  95.06860244552237
curr_Factors:  [9.50686024e+01 3.44962931e-02]
mat_Sqrt:  [[ 1.76572605e+01  0.00000000e+00]
 [-7.42927109e-03  1.70225986e-02]]
grads:  [0.01554361 8.73924955]
Stock Position:  0.015543614113135335
Bond Position:  [13.3689243]


portfolio before change:  [14.89150839]
curr_Stock_Price:  97.52544983244182
curr_Factors:  [9.75254498e+01 3.15253779e-02]
mat_Sqrt:  [[ 1.73160214e+01  0.00000000e+00]
 [-7.10215493e-03  1.62730813e-02]]
grads:  [ 8.05896228e-04 -4.78309098e+00]
Stock Position:  0.0008058962280497884
Bond Position:  [14.812913]


portfolio before change:  [14.89947367]
curr_Stock_Price:  98.21657586790046
curr_Factors:  [9.82165759e+01 3.28055081e-02]
mat_Sqrt:  [[ 1.77892719e+01  0.00000000e+00]
 [-7.24491635e-03  1.66001888e-02]]
grads:  [ 0.00318518 -2.81178025]
Stock Position:  0.0031851785765798597
Bond Position:  [14.58663634]


portfolio before change:  [14.9120454]
curr_Stock_Price:  99.87318053086993
curr_Factors:  [9.98731805e+01 3.32443352e-02]
mat_Sqrt:  [[ 1.82099061e+01  0.00000000e+00]
 [-7.29321166e-03  1.67108472e-02]]
grads:  [ 0.01155153 -7.56258595]
Stock Position:  0.011551526758069223
Bond Position:  [13.75835768]


portfolio before change:  [14.92436538]
curr_Stock_Price:  100.34403457834041
curr_Factors:  [1.00344035e+02 3.08713690e-02]
mat_Sqrt:  [[ 1.76306979e+01  0.00000000e+00]
 [-7.02810006e-03  1.61034003e-02]]
grads:  [0.00458527 2.55418157]
Stock Position:  0.004585269959002407
Bond Position:  [14.46426089]


portfolio before change:  [14.91386203]
curr_Stock_Price:  96.47571558830485
curr_Factors:  [9.64757156e+01 3.11032557e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.91386203]
Stock Price:  96.47303313577738
PL:  [14.91386203]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.70302558e-02 -3.47927270e-01]
 [-7.23965152e-01 -2.88725073e-01]
 [-3.93632560e-01 -1.18510495e-01]
 [-1.14642136e-01  2.37917135e-02]
 [-5.36620286e-02 -3.85147229e-03]
 [ 8.72804917e-02 -1.41391612e-01]
 [ 1.44640345e-01  1.09192098e-01]
 [-2.86261082e-01 -3.22240820e-01]
 [ 2.56144894e-02 -8.59059759e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.34572705]
curr_Stock_Price:  101.43472177946227
curr_Factors:  [1.01434722e+02 4.00152752e-02]
mat_Sqrt:  [[ 2.02908176e+01  0.00000000e+00]
 [-8.00152737e-03  1.83338024e-02]]
grads:  [-1.07870550e-02 -1.89773655e+01]
Stock Position:  -0.010787055011794219
Bond Position:  [13.43990898]


portfolio before change:  [12.31430125]
curr_Stock_Price:  104.97113042791882
curr_Factors:  [1.04971130e+02 3.87147877e-02]
mat_Sqrt:  [[ 2.06541970e+01  0.00000000e+00]
 [-7.87042949e-03  1.80334194e-02]]
grads:  [ -0.04115266 -16.01055605]
Stock Position:  -0.04115265791076312
Bond Position:  [16.63414228]


portfolio before change:  [12.28858829]
curr_Stock_Price:  105.79810294215599
curr_Factors:  [1.05798103e+02 3.49974654e-02]
mat_Sqrt:  [[ 1.97922960e+01  0.00000000e+00]
 [-7.48304381e-03  1.71458073e-02]]
grads:  [-0.02250142 -6.91192268]
Stock Position:  -0.022501420800620273
Bond Position:  [14.66919592]


portfolio before change:  [12.33914483]
curr_Stock_Price:  103.87733066840985
curr_Factors:  [1.03877331e+02 3.51580352e-02]
mat_Sqrt:  [[ 1.94774940e+01  0.00000000e+00]
 [-7.50019042e-03  1.71850952e-02]]
grads:  [-0.00535277  1.38443886]
Stock Position:  -0.005352771807325794
Bond Position:  [12.89517647]


portfolio before change:  [12.34904167]
curr_Stock_Price:  103.23324465181798
curr_Factors:  [1.03233245e+02 3.52189479e-02]
mat_Sqrt:  [[ 1.93734857e+01  0.00000000e+00]
 [-7.50668479e-03  1.71999756e-02]]
grads:  [-0.00285663 -0.22392312]
Stock Position:  -0.002856633533290704
Bond Position:  [12.64394122]


portfolio before change:  [12.35432106]
curr_Stock_Price:  103.59876772851838
curr_Factors:  [1.03598768e+02 3.18028924e-02]
mat_Sqrt:  [[ 1.84751469e+01  0.00000000e+00]
 [-7.13334619e-03  1.63445494e-02]]
grads:  [ 1.38413693e-03 -8.65068888e+00]
Stock Position:  0.0013841369310270575
Bond Position:  [12.21092618]


portfolio before change:  [12.36301782]
curr_Stock_Price:  105.4698038802385
curr_Factors:  [1.05469804e+02 3.15422277e-02]
mat_Sqrt:  [[ 1.87315761e+01  0.00000000e+00]
 [-7.10405267e-03  1.62774296e-02]]
grads:  [0.01026586 6.70819048]
Stock Position:  0.010265857111615755
Bond Position:  [11.28027988]


portfolio before change:  [12.36550639]
curr_Stock_Price:  105.16267157258068
curr_Factors:  [1.05162672e+02 2.95688332e-02]
mat_Sqrt:  [[ 1.80833423e+01  0.00000000e+00]
 [-6.87823619e-03  1.57600190e-02]]
grads:  [ -0.02360728 -20.44672792]
Stock Position:  -0.023607278894393176
Bond Position:  [14.84811091]


portfolio before change:  [12.33103388]
curr_Stock_Price:  106.93748120668717
curr_Factors:  [1.06937481e+02 2.91960873e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.33103388]
Stock Price:  108.41201901095818
PL:  [3.91901487]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.48816133e-02 -3.28314961e-01]
 [-5.18128759e-02  6.93375883e-02]
 [ 2.28324199e-01  1.51889079e-01]
 [ 5.61836566e-02  1.11037390e-01]
 [-6.88926068e-02 -3.49050593e-03]
 [ 8.81521555e-02 -1.57187636e-01]
 [ 2.58290597e-01 -1.31233278e-01]
 [-5.90245447e-02  6.88990363e-02]
 [ 2.40715125e-02  3.67449686e-07]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.28846554]
curr_Stock_Price:  100.99088585309453
curr_Factors:  [1.00990886e+02 3.91447336e-02]
mat_Sqrt:  [[ 1.99810751e+01  0.00000000e+00]
 [-7.91401123e-03  1.81332778e-02]]
grads:  [-1.04183588e-02 -1.81056600e+01]
Stock Position:  -0.010418358784796149
Bond Position:  [10.34062482]


portfolio before change:  [9.30364938]
curr_Stock_Price:  100.02986695174448
curr_Factors:  [1.00029867e+02 4.00186539e-02]
mat_Sqrt:  [[ 2.00106377e+01  0.00000000e+00]
 [-8.00186517e-03  1.83345764e-02]]
grads:  [-1.07700073e-03  3.78179385e+00]
Stock Position:  -0.0010770007317610067
Bond Position:  [9.41138162]


portfolio before change:  [9.30895963]
curr_Stock_Price:  99.46963208360566
curr_Factors:  [9.94696321e+01 3.95977900e-02]
mat_Sqrt:  [[ 1.97936545e+01  0.00000000e+00]
 [-7.95967738e-03  1.82379121e-02]]
grads:  [0.01488427 8.32820549]
Stock Position:  0.014884266464128076
Bond Position:  [7.82842712]


portfolio before change:  [9.34558545]
curr_Stock_Price:  101.6672971090672
curr_Factors:  [1.01667297e+02 4.09874120e-02]
mat_Sqrt:  [[ 2.05828982e+01  0.00000000e+00]
 [-8.09813924e-03  1.85551680e-02]]
grads:  [5.08404333e-03 5.98417591e+00]
Stock Position:  0.005084043334535841
Bond Position:  [8.82870451]


portfolio before change:  [9.35984518]
curr_Stock_Price:  103.60360554520524
curr_Factors:  [1.03603606e+02 4.24622744e-02]
mat_Sqrt:  [[ 2.13489488e+01  0.00000000e+00]
 [-8.24255052e-03  1.88860558e-02]]
grads:  [-0.00329834 -0.18481921]
Stock Position:  -0.00329833515969514
Bond Position:  [9.7015646]


portfolio before change:  [9.36940004]
curr_Stock_Price:  102.17777463722182
curr_Factors:  [1.02177775e+02 4.10338288e-02]
mat_Sqrt:  [[ 2.06979561e+01  0.00000000e+00]
 [-8.10272337e-03  1.85656716e-02]]
grads:  [ 9.44530311e-04 -8.46657420e+00]
Stock Position:  0.0009445303106209097
Bond Position:  [9.27289004]


portfolio before change:  [9.37248685]
curr_Stock_Price:  100.53590336406354
curr_Factors:  [1.00535903e+02 4.06483020e-02]
mat_Sqrt:  [[ 2.02694698e+01  0.00000000e+00]
 [-8.06456962e-03  1.84782504e-02]]
grads:  [ 0.00991717 -7.10204025]
Stock Position:  0.009917166127694244
Bond Position:  [8.3754556]


portfolio before change:  [9.40190375]
curr_Stock_Price:  103.07978766407965
curr_Factors:  [1.03079788e+02 3.76136154e-02]
mat_Sqrt:  [[ 1.99915310e+01  0.00000000e+00]
 [-7.75769197e-03  1.77751053e-02]]
grads:  [-1.44834030e-03  3.87615347e+00]
Stock Position:  -0.0014483402994833674
Bond Position:  [9.55119836]


portfolio before change:  [9.40007148]
curr_Stock_Price:  107.64298414916006
curr_Factors:  [1.07642984e+02 3.38316191e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.40007148]
Stock Price:  109.67045683823234
PL:  [-0.27038536]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.59116823e-02 -2.46439516e-01]
 [-5.66461483e-01 -1.86510289e-01]
 [-2.66302847e-01 -2.61458241e-01]
 [-9.04564231e-02  3.28885275e-02]
 [ 1.24708533e-02 -4.06929323e-03]
 [ 8.48170936e-02 -1.22177099e-01]
 [ 1.68197582e-01  2.90359753e-02]
 [-2.40117770e-01 -2.37712493e-01]
 [ 2.69336370e-02 -1.63811612e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.824234]
curr_Stock_Price:  99.76209661503538
curr_Factors:  [9.97620966e+01 4.14037049e-02]
mat_Sqrt:  [[ 2.02994920e+01  0.00000000e+00]
 [-8.13916014e-03  1.86491587e-02]]
grads:  [-8.05274854e-03 -1.32145111e+01]
Stock Position:  -0.008052748542592839
Bond Position:  [1.62759307]


portfolio before change:  [0.79316491]
curr_Stock_Price:  103.72137703294062
curr_Factors:  [1.03721377e+02 4.05614866e-02]
mat_Sqrt:  [[ 2.08893634e+01  0.00000000e+00]
 [-8.05595298e-03  1.84585072e-02]]
grads:  [ -0.03101393 -10.10429972]
Stock Position:  -0.031013929601045067
Bond Position:  [4.00997239]


portfolio before change:  [0.78361672]
curr_Stock_Price:  104.09390891070478
curr_Factors:  [1.04093909e+02 4.03007773e-02]
mat_Sqrt:  [[ 2.08969079e+01  0.00000000e+00]
 [-8.03002140e-03  1.83990905e-02]]
grads:  [ -0.01820425 -14.21038943]
Stock Position:  -0.018204252045811303
Bond Position:  [2.67856847]


portfolio before change:  [0.79347863]
curr_Stock_Price:  103.62576032598825
curr_Factors:  [1.03625760e+02 4.15998961e-02]
mat_Sqrt:  [[ 2.11355646e+01  0.00000000e+00]
 [-8.15842103e-03  1.86932910e-02]]
grads:  [-0.00360069  1.759376  ]
Stock Position:  -0.003600693640892202
Bond Position:  [1.16660325]


portfolio before change:  [0.80120495]
curr_Stock_Price:  101.64201263293255
curr_Factors:  [1.01642013e+02 4.61005158e-02]
mat_Sqrt:  [[ 2.18235877e+01  0.00000000e+00]
 [-8.58841227e-03  1.96785247e-02]]
grads:  [ 0.00049006 -0.20678853]
Stock Position:  0.0004900600323764305
Bond Position:  [0.75139426]


portfolio before change:  [0.80111023]
curr_Stock_Price:  100.68191197072264
curr_Factors:  [1.00681912e+02 4.70234641e-02]
mat_Sqrt:  [[ 2.18327662e+01  0.00000000e+00]
 [-8.67395772e-03  1.98745339e-02]]
grads:  [ 1.44253988e-03 -6.14741960e+00]
Stock Position:  0.001442539877793977
Bond Position:  [0.65587256]


portfolio before change:  [0.80559825]
curr_Stock_Price:  103.56571221641191
curr_Factors:  [1.03565712e+02 4.57740649e-02]
mat_Sqrt:  [[ 2.21577540e+01  0.00000000e+00]
 [-8.55794975e-03  1.96087263e-02]]
grads:  [0.00816283 1.48076805]
Stock Position:  0.008162827363338754
Bond Position:  [-0.03979078]


portfolio before change:  [0.81531209]
curr_Stock_Price:  104.75815959245162
curr_Factors:  [1.04758160e+02 4.90164979e-02]
mat_Sqrt:  [[ 2.31931106e+01  0.00000000e+00]
 [-8.85586792e-03  2.02913425e-02]]
grads:  [ -0.01482613 -11.7149712 ]
Stock Position:  -0.014826127179751628
Bond Position:  [2.36846988]


portfolio before change:  [0.79340197]
curr_Stock_Price:  106.31585866465775
curr_Factors:  [1.06315859e+02 4.69084001e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.79340197]
Stock Price:  107.80798453944153
PL:  [-7.01458257]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.67980224e-02 -2.80157558e-01]
 [-2.31168948e-02 -9.03869344e-02]
 [ 2.64344613e-01  1.64157405e-01]
 [ 1.61438443e-01  1.30675476e-01]
 [ 3.68909227e-01 -2.61585320e-01]
 [ 7.98350673e-02 -1.34521664e-01]
 [ 8.02443807e-02 -3.15186554e-01]
 [ 5.51599120e-02 -1.17256228e-01]
 [ 3.54306458e-02  9.90800949e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.6520655]
curr_Stock_Price:  97.07981200743157
curr_Factors:  [9.70798120e+01 4.48949426e-02]
mat_Sqrt:  [[ 2.05696848e+01  0.00000000e+00]
 [-8.47537068e-03  1.94195138e-02]]
grads:  [-1.72451646e-03 -1.44266000e+01]
Stock Position:  -0.0017245164556659214
Bond Position:  [-17.48464977]


portfolio before change:  [-17.66241992]
curr_Stock_Price:  98.01335190481197
curr_Factors:  [9.80133519e+01 4.42126181e-02]
mat_Sqrt:  [[ 2.06090683e+01  0.00000000e+00]
 [-8.41071870e-03  1.92713775e-02]]
grads:  [-3.03579891e-03 -4.69021658e+00]
Stock Position:  -0.0030357989124438797
Bond Position:  [-17.36487109]


portfolio before change:  [-17.66453069]
curr_Stock_Price:  95.84791457690392
curr_Factors:  [9.58479146e+01 4.28623342e-02]
mat_Sqrt:  [[ 1.98436052e+01  0.00000000e+00]
 [-8.28128822e-03  1.89748151e-02]]
grads:  [0.01693184 8.65133097]
Stock Position:  0.016931841528459095
Bond Position:  [-19.28741239]


portfolio before change:  [-17.73765128]
curr_Stock_Price:  92.09909210946914
curr_Factors:  [9.20990921e+01 4.71959683e-02]
mat_Sqrt:  [[ 2.00081898e+01  0.00000000e+00]
 [-8.68985324e-03  1.99109551e-02]]
grads:  [0.01091902 6.56299385]
Stock Position:  0.010919023582952329
Bond Position:  [-18.74328344]


portfolio before change:  [-17.73825323]
curr_Stock_Price:  92.90246405825609
curr_Factors:  [9.29024641e+01 4.48344776e-02]
mat_Sqrt:  [[ 1.96713103e+01  0.00000000e+00]
 [-8.46966140e-03  1.94064322e-02]]
grads:  [ 1.29500287e-02 -1.34793102e+01]
Stock Position:  0.012950028685609573
Bond Position:  [-18.9413428]


portfolio before change:  [-17.76806647]
curr_Stock_Price:  91.33179541463613
curr_Factors:  [9.13317954e+01 4.41472332e-02]
mat_Sqrt:  [[ 1.91899455e+01  0.00000000e+00]
 [-8.40449720e-03  1.92571223e-02]]
grads:  [ 1.10083689e-03 -6.98555382e+00]
Stock Position:  0.0011008368875678137
Bond Position:  [-17.86860788]


portfolio before change:  [-17.77455702]
curr_Stock_Price:  93.55373182012953
curr_Factors:  [9.35537318e+01 4.35279422e-02]
mat_Sqrt:  [[ 1.95184436e+01  0.00000000e+00]
 [-8.34534046e-03  1.91215772e-02]]
grads:  [-2.93641801e-03 -1.64832927e+01]
Stock Position:  -0.00293641800530696
Bond Position:  [-17.49984416]


portfolio before change:  [-17.78082748]
curr_Stock_Price:  92.70860260482402
curr_Factors:  [9.27086026e+01 4.32118417e-02]
mat_Sqrt:  [[ 1.92717620e+01  0.00000000e+00]
 [-8.31498327e-03  1.90520201e-02]]
grads:  [ 2.06784344e-04 -6.15452992e+00]
Stock Position:  0.00020678434383679715
Bond Position:  [-17.79999816]


portfolio before change:  [-17.79031275]
curr_Stock_Price:  89.88899815478592
curr_Factors:  [8.98889982e+01 4.49526505e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.79031275]
Stock Price:  91.42128177560551
PL:  [-17.79031275]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.28775274e-02 -4.01299806e-01]
 [-7.24864556e-01 -2.89418549e-01]
 [-2.42301758e-01 -2.88403260e-01]
 [-2.30862991e-01 -1.98894679e-02]
 [-1.97262246e-01  3.14917221e-03]
 [ 1.62183452e-01 -1.00785083e-01]
 [ 1.42460012e-01  1.22906961e-01]
 [-1.55431213e-01 -9.64122698e-02]
 [ 3.63399076e-02 -4.40922541e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.66397241]
curr_Stock_Price:  102.64231756817918
curr_Factors:  [1.02642318e+02 3.80810315e-02]
mat_Sqrt:  [[ 2.00299932e+01  0.00000000e+00]
 [-7.80574470e-03  1.78852080e-02]]
grads:  [-1.23823867e-02 -2.24375253e+01]
Stock Position:  -0.012382386717248561
Bond Position:  [21.93492927]


portfolio before change:  [20.64599253]
curr_Stock_Price:  104.98032297717285
curr_Factors:  [1.04980323e+02 3.70367885e-02]
mat_Sqrt:  [[ 2.02034048e+01  0.00000000e+00]
 [-7.69797776e-03  1.76382829e-02]]
grads:  [ -0.04213038 -16.40854448]
Stock Position:  -0.0421303822527475
Bond Position:  [25.06885366]


portfolio before change:  [20.70947149]
curr_Stock_Price:  103.77118594171631
curr_Factors:  [1.03771186e+02 3.56749443e-02]
mat_Sqrt:  [[ 1.96001065e+01  0.00000000e+00]
 [-7.55512481e-03  1.73109657e-02]]
grads:  [ -0.01878415 -16.66014859]
Stock Position:  -0.01878414585731971
Bond Position:  [22.65872458]


portfolio before change:  [20.69597954]
curr_Stock_Price:  105.09273385176868
curr_Factors:  [1.05092734e+02 3.71192097e-02]
mat_Sqrt:  [[ 2.0247530e+01  0.0000000e+00]
 [-7.7065385e-03  1.7657898e-02]]
grads:  [-0.01183075 -1.126378  ]
Stock Position:  -0.011830750055307215
Bond Position:  [21.9393054]


portfolio before change:  [20.69101663]
curr_Stock_Price:  106.43967347484454
curr_Factors:  [1.06439673e+02 3.74063388e-02]
mat_Sqrt:  [[ 2.05861975e+01  0.00000000e+00]
 [-7.73628736e-03  1.77260612e-02]]
grads:  [-0.00951549  0.17765775]
Stock Position:  -0.009515493782593112
Bond Position:  [21.70384268]


portfolio before change:  [20.71562905]
curr_Stock_Price:  104.99384374331306
curr_Factors:  [1.04993844e+02 3.83297309e-02]
mat_Sqrt:  [[ 2.05556739e+01  0.00000000e+00]
 [-7.83119208e-03  1.79435153e-02]]
grads:  [ 0.0057501  -5.61679704]
Stock Position:  0.005750102640353319
Bond Position:  [20.11190367]


portfolio before change:  [20.73161606]
curr_Stock_Price:  106.0248777876576
curr_Factors:  [1.06024878e+02 3.72585220e-02]
mat_Sqrt:  [[ 2.04654167e+01  0.00000000e+00]
 [-7.72098667e-03  1.76910029e-02]]
grads:  [0.00958207 6.94742755]
Stock Position:  0.009582067639993946
Bond Position:  [19.71567851]


portfolio before change:  [20.72173617]
curr_Stock_Price:  103.96475900879213
curr_Factors:  [1.03964759e+02 3.67991344e-02]
mat_Sqrt:  [[ 1.99436642e+01  0.00000000e+00]
 [-7.67324019e-03  1.75816020e-02]]
grads:  [-0.00990334 -5.48370222]
Stock Position:  -0.009903344536786284
Bond Position:  [21.751335]


portfolio before change:  [20.73439116]
curr_Stock_Price:  103.78536474906494
curr_Factors:  [1.03785365e+02 3.76183072e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.73439116]
Stock Price:  102.02563235138746
PL:  [18.70875881]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 3.71476505e-02 -2.47532129e-01]
 [ 2.65652115e-02 -6.59964699e-01]
 [ 2.58341093e-01  1.62112644e-01]
 [ 2.22879020e-01  1.58805070e-01]
 [ 2.61045450e-01 -2.22603399e-01]
 [ 8.01302694e-02 -1.43776729e-01]
 [-9.46996190e-03 -3.89564810e-01]
 [ 5.53797634e-02 -1.16679905e-01]
 [ 2.08618905e-02  5.25877550e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.7626493]
curr_Stock_Price:  98.07997846530466
curr_Factors:  [9.80799785e+01 4.48084290e-02]
mat_Sqrt:  [[ 2.07615714e+01  0.00000000e+00]
 [-8.46720062e-03  1.94007939e-02]]
grads:  [-3.41420339e-03 -1.27588660e+01]
Stock Position:  -0.003414203391139178
Bond Position:  [-10.42778431]


portfolio before change:  [-10.75924784]
curr_Stock_Price:  95.55620949569642
curr_Factors:  [9.55562095e+01 4.38159680e-02]
mat_Sqrt:  [[ 2.00020781e+01  0.00000000e+00]
 [-8.37290563e-03  1.91847369e-02]]
grads:  [-1.30719916e-02 -3.44005082e+01]
Stock Position:  -0.01307199159265422
Bond Position:  [-9.51013787]


portfolio before change:  [-10.77572161]
curr_Stock_Price:  96.45259242058974
curr_Factors:  [9.64525924e+01 4.31838251e-02]
mat_Sqrt:  [[ 2.00435415e+01  0.00000000e+00]
 [-8.31228730e-03  1.90458429e-02]]
grads:  [0.0164189  8.51170752]
Stock Position:  0.016418897393446485
Bond Position:  [-12.35936683]


portfolio before change:  [-10.76996332]
curr_Stock_Price:  97.17977380396081
curr_Factors:  [9.71797738e+01 3.94729922e-02]
mat_Sqrt:  [[ 1.93074940e+01  0.00000000e+00]
 [-7.94712448e-03  1.82091498e-02]]
grads:  [0.01513336 8.72116888]
Stock Position:  0.015133358834644712
Bond Position:  [-12.24061971]


portfolio before change:  [-10.82152606]
curr_Stock_Price:  94.17707606481805
curr_Factors:  [9.41770761e+01 4.28545336e-02]
mat_Sqrt:  [[ 1.94959135e+01  0.00000000e+00]
 [-8.28053463e-03  1.89730884e-02]]
grads:  [ 8.40654950e-03 -1.17325864e+01]
Stock Position:  0.00840654949569508
Bond Position:  [-11.61323031]


portfolio before change:  [-10.8573649]
curr_Stock_Price:  90.60476923401598
curr_Factors:  [9.06047692e+01 4.33810312e-02]
mat_Sqrt:  [[ 1.88712642e+01  0.00000000e+00]
 [-8.33124540e-03  1.90892814e-02]]
grads:  [ 9.21027885e-04 -7.53180417e+00]
Stock Position:  0.0009210278853273054
Bond Position:  [-10.94081442]


portfolio before change:  [-10.86375558]
curr_Stock_Price:  89.6070800448832
curr_Factors:  [8.96070800e+01 4.31239323e-02]
mat_Sqrt:  [[ 1.86080774e+01  0.00000000e+00]
 [-8.30652104e-03  1.90326307e-02]]
grads:  [-9.64581026e-03 -2.04682588e+01]
Stock Position:  -0.009645810263682233
Bond Position:  [-9.99942269]


portfolio before change:  [-10.894883]
curr_Stock_Price:  92.31566168135272
curr_Factors:  [9.23156617e+01 4.29196672e-02]
mat_Sqrt:  [[ 1.91250932e+01  0.00000000e+00]
 [-8.28682494e-03  1.89875013e-02]]
grads:  [ 2.33017329e-04 -6.14509003e+00]
Stock Position:  0.00023301732897830642
Bond Position:  [-10.91639415]


portfolio before change:  [-10.90039872]
curr_Stock_Price:  92.07465618543831
curr_Factors:  [9.20746562e+01 4.24815425e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.90039872]
Stock Price:  89.62583822884514
PL:  [-10.90039872]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.25860545e-02 -3.07361634e-01]
 [-1.69101562e-03  8.11330581e-02]
 [ 2.31013307e-01  1.52804972e-01]
 [ 9.18001242e-02  1.28593744e-01]
 [ 2.57189501e-02 -8.39272022e-03]
 [ 7.67378441e-02 -3.44228091e-02]
 [ 2.36466255e-01 -1.59036359e-01]
 [ 1.02940439e-01  2.88852237e-02]
 [ 5.19267908e-02 -8.10977017e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.0232456]
curr_Stock_Price:  100.51685969879894
curr_Factors:  [1.00516860e+02 4.09261027e-02]
mat_Sqrt:  [[ 2.03347626e+01  0.00000000e+00]
 [-8.09208034e-03  1.85412853e-02]]
grads:  [-9.67454958e-03 -1.65771481e+01]
Stock Position:  -0.009674549577363415
Bond Position:  [6.99570094]


portfolio before change:  [6.03512695]
curr_Stock_Price:  99.65039729438557
curr_Factors:  [9.96503973e+01 4.09780209e-02]
mat_Sqrt:  [[ 2.01722585e+01  0.00000000e+00]
 [-8.09721146e-03  1.85530422e-02]]
grads:  [1.67152101e-03 4.37303258e+00]
Stock Position:  0.0016715210116049631
Bond Position:  [5.86855922]


portfolio before change:  [6.03731]
curr_Stock_Price:  99.20053025273636
curr_Factors:  [9.92005303e+01 4.08985281e-02]
mat_Sqrt:  [[ 2.00617047e+01  0.00000000e+00]
 [-8.08935380e-03  1.85350381e-02]]
grads:  [0.01483936 8.24411431]
Stock Position:  0.014839360329285088
Bond Position:  [4.56523759]


portfolio before change:  [6.07044703]
curr_Stock_Price:  101.27971958827885
curr_Factors:  [1.01279720e+02 4.00839141e-02]
mat_Sqrt:  [[ 2.02771798e+01  0.00000000e+00]
 [-8.00838701e-03  1.83495198e-02]]
grads:  [0.00729505 7.00801685]
Stock Position:  0.007295049755956925
Bond Position:  [5.33160644]


portfolio before change:  [6.07290219]
curr_Stock_Price:  101.25075339290521
curr_Factors:  [1.01250753e+02 3.76952850e-02]
mat_Sqrt:  [[ 1.96581108e+01  0.00000000e+00]
 [-7.76610945e-03  1.77943922e-02]]
grads:  [ 0.00112198 -0.47164973]
Stock Position:  0.0011219830310347843
Bond Position:  [5.95930057]


portfolio before change:  [6.07361571]
curr_Stock_Price:  99.23033202023065
curr_Factors:  [9.92303320e+01 3.91256964e-02]
mat_Sqrt:  [[ 1.96279745e+01  0.00000000e+00]
 [-7.91208660e-03  1.81288679e-02]]
grads:  [ 0.00314421 -1.89878427]
Stock Position:  0.0031442112648010206
Bond Position:  [5.76161458]


portfolio before change:  [6.07585314]
curr_Stock_Price:  99.02547910802598
curr_Factors:  [9.90254791e+01 3.80118815e-02]
mat_Sqrt:  [[ 1.93066372e+01  0.00000000e+00]
 [-7.79865439e-03  1.78689620e-02]]
grads:  [ 8.65283247e-03 -8.90014534e+00]
Stock Position:  0.008652832467891058
Bond Position:  [5.21900226]


portfolio before change:  [6.08193279]
curr_Stock_Price:  99.42644556344621
curr_Factors:  [9.94264456e+01 3.82813794e-02]
mat_Sqrt:  [[ 1.94534083e+01  0.00000000e+00]
 [-7.82625115e-03  1.79321941e-02]]
grads:  [0.00593968 1.61080253]
Stock Position:  0.005939678156943057
Bond Position:  [5.4913717]


portfolio before change:  [6.08949763]
curr_Stock_Price:  100.23768014791924
curr_Factors:  [1.00237680e+02 3.82085945e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.08949763]
Stock Price:  100.69532818828195
PL:  [5.39416944]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-1.03210925e-01  5.73243620e-02]
 [-2.64720452e-01 -2.63234730e-01]
 [-2.83486223e-01 -3.96725212e-02]
 [-1.20335411e-01 -1.11115323e-02]
 [ 3.79331029e-01  1.38845792e-01]
 [ 1.36692691e-01  1.59184908e-01]
 [-2.51625931e-01 -2.62800766e-01]
 [ 3.74296816e-02 -4.66795304e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.80763198]
curr_Stock_Price:  99.08966852357543
curr_Factors:  [9.90896685e+01 3.83071722e-02]
mat_Sqrt:  [[ 1.93940461e+01  0.00000000e+00]
 [-7.82888725e-03  1.79382342e-02]]
grads:  [-6.85149177e-03 -1.06150723e+01]
Stock Position:  -0.006851491768932639
Bond Position:  [-3.12871993]


portfolio before change:  [-3.81795794]
curr_Stock_Price:  100.36839945592558
curr_Factors:  [1.00368399e+02 3.54786917e-02]
mat_Sqrt:  [[ 1.89051791e+01  0.00000000e+00]
 [-7.53431528e-03  1.72632850e-02]]
grads:  [-0.00413604  3.32059408]
Stock Position:  -0.0041360371131354936
Bond Position:  [-3.40283052]


portfolio before change:  [-3.83497299]
curr_Stock_Price:  104.07078535258461
curr_Factors:  [1.04070785e+02 3.30243658e-02]
mat_Sqrt:  [[ 1.89123752e+01  0.00000000e+00]
 [-7.26904295e-03  1.66554698e-02]]
grads:  [ -0.0200718  -15.80470161]
Stock Position:  -0.02007180497486937
Bond Position:  [-1.74608448]


portfolio before change:  [-3.86738496]
curr_Stock_Price:  105.64207943443182
curr_Factors:  [1.05642079e+02 3.30966526e-02]
mat_Sqrt:  [[ 1.92189199e+01  0.00000000e+00]
 [-7.27699417e-03  1.66736883e-02]]
grads:  [-0.01565128 -2.37934886]
Stock Position:  -0.015651281767437686
Bond Position:  [-2.21395101]


portfolio before change:  [-3.85574133]
curr_Stock_Price:  104.82739313891071
curr_Factors:  [1.04827393e+02 3.50521483e-02]
mat_Sqrt:  [[ 1.96260141e+01  0.00000000e+00]
 [-7.48888758e-03  1.71591971e-02]]
grads:  [-0.00637852 -0.64755549]
Stock Position:  -0.006378517843987072
Bond Position:  [-3.18709793]


portfolio before change:  [-3.87247053]
curr_Stock_Price:  107.200241295275
curr_Factors:  [1.07200241e+02 3.05123074e-02]
mat_Sqrt:  [[ 1.87254942e+01  0.00000000e+00]
 [-6.98710898e-03  1.60094779e-02]]
grads:  [0.02349355 8.67272457]
Stock Position:  0.0234935481941033
Bond Position:  [-6.39098456]


portfolio before change:  [-3.86766024]
curr_Stock_Price:  107.5410402732546
curr_Factors:  [1.0754104e+02 3.0781135e-02]
mat_Sqrt:  [[ 1.88675951e+01  0.00000000e+00]
 [-7.01782132e-03  1.60798487e-02]]
grads:  [0.01092702 9.89965212]
Stock Position:  0.010927024857872954
Bond Position:  [-5.04276386]


portfolio before change:  [-3.89967593]
curr_Stock_Price:  104.84189057200167
curr_Factors:  [1.04841891e+02 3.12265746e-02]
mat_Sqrt:  [[ 1.85266551e+01  0.00000000e+00]
 [-7.06841704e-03  1.61957781e-02]]
grads:  [ -0.01977268 -16.22649838]
Stock Position:  -0.019772678139667398
Bond Position:  [-1.82667097]


portfolio before change:  [-3.87474502]
curr_Stock_Price:  103.53481062802213
curr_Factors:  [1.03534811e+02 3.35726698e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.87474502]
Stock Price:  104.266843434041
PL:  [-8.14158846]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 6.17012217e-02 -2.63666364e-01]
 [ 4.49114266e-02 -8.70293869e-01]
 [ 2.94485102e-01  1.74423066e-01]
 [ 1.46267356e-01  1.24969156e-01]
 [ 2.31927415e-01 -2.12206987e-01]
 [ 7.78509704e-02 -7.23170048e-02]
 [ 1.72105108e-01 -2.31696779e-01]
 [-4.50563114e-02  3.97186266e-02]
 [ 3.78700602e-02 -4.77250510e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.69882776]
curr_Stock_Price:  97.94406937430004
curr_Factors:  [9.79440694e+01 3.84188814e-02]
mat_Sqrt:  [[ 1.91977575e+01  0.00000000e+00]
 [-7.84029401e-03  1.79643704e-02]]
grads:  [-2.78012751e-03 -1.46771837e+01]
Stock Position:  -0.0027801275076483386
Bond Position:  [-11.42653076]


portfolio before change:  [-11.69537665]
curr_Stock_Price:  94.64716634927318
curr_Factors:  [9.46471663e+01 4.42360536e-02]
mat_Sqrt:  [[ 1.99065411e+01  0.00000000e+00]
 [-8.41294751e-03  1.92764844e-02]]
grads:  [-1.68244175e-02 -4.51479560e+01]
Stock Position:  -0.01682441748259243
Bond Position:  [-10.10299321]


portfolio before change:  [-11.66964578]
curr_Stock_Price:  92.8174668747723
curr_Factors:  [9.28174669e+01 4.56481395e-02]
mat_Sqrt:  [[ 1.98308465e+01  0.00000000e+00]
 [-8.54617009e-03  1.95817357e-02]]
grads:  [0.01868854 8.90743644]
Stock Position:  0.018688540048031433
Bond Position:  [-13.40426873]


portfolio before change:  [-11.70709529]
curr_Stock_Price:  91.17230362196143
curr_Factors:  [9.11723036e+01 4.37442632e-02]
mat_Sqrt:  [[ 1.90688051e+01  0.00000000e+00]
 [-8.36605170e-03  1.91690326e-02]]
grads:  [0.01053073 6.51932512]
Stock Position:  0.010530726276839507
Bond Position:  [-12.66720586]


portfolio before change:  [-11.67875129]
curr_Stock_Price:  94.4654461199617
curr_Factors:  [9.44654461e+01 4.13413305e-02]
mat_Sqrt:  [[ 1.92072507e+01  0.00000000e+00]
 [-8.13302704e-03  1.86351060e-02]]
grads:  [ 7.25313037e-03 -1.13874848e+01]
Stock Position:  0.007253130368132768
Bond Position:  [-12.36392149]


portfolio before change:  [-11.67226046]
curr_Stock_Price:  96.21287609358762
curr_Factors:  [9.62128761e+01 4.30016241e-02]
mat_Sqrt:  [[ 1.99515034e+01  0.00000000e+00]
 [-8.29473318e-03  1.90056213e-02]]
grads:  [ 2.32008792e-03 -3.80503239e+00]
Stock Position:  0.0023200879166669144
Bond Position:  [-11.89548279]


portfolio before change:  [-11.67590059]
curr_Stock_Price:  97.20813819883246
curr_Factors:  [9.72081382e+01 4.26874948e-02]
mat_Sqrt:  [[ 2.00841270e+01  0.00000000e+00]
 [-8.26438090e-03  1.89360755e-02]]
grads:  [ 3.53435043e-03 -1.22357338e+01]
Stock Position:  0.0035343504297149922
Bond Position:  [-12.01946822]


portfolio before change:  [-11.66346011]
curr_Stock_Price:  102.42882047874896
curr_Factors:  [1.02428820e+02 3.95114977e-02]
mat_Sqrt:  [[ 2.03602880e+01  0.00000000e+00]
 [-7.95099971e-03  1.82180290e-02]]
grads:  [-1.36155646e-03  2.18018242e+00]
Stock Position:  -0.0013615564556919493
Bond Position:  [-11.52399749]


portfolio before change:  [-11.6705961]
curr_Stock_Price:  103.43689125450807
curr_Factors:  [1.03436891e+02 3.73511548e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.6705961]
Stock Price:  103.24389367582039
PL:  [-14.91448977]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.90288502e-02 -2.74892300e-01]
 [-3.70482589e-01 -5.99428141e-02]
 [-3.30105075e-01 -1.89830147e-01]
 [-3.46576364e-01 -6.33883774e-02]
 [-1.58680528e-01 -9.39615933e-03]
 [ 8.73042423e-02 -1.41822013e-01]
 [ 1.54431638e-01  6.76734626e-02]
 [-2.22563310e-01 -2.13438816e-01]
 [ 2.23457567e-02  9.74701205e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.78688587]
curr_Stock_Price:  100.04702330794902
curr_Factors:  [1.00047023e+02 3.50736720e-02]
mat_Sqrt:  [[ 1.87367728e+01  0.00000000e+00]
 [-7.49118650e-03  1.71644646e-02]]
grads:  [-9.55349611e-03 -1.60151980e+01]
Stock Position:  -0.00955349610660981
Bond Position:  [3.74268472]


portfolio before change:  [2.76840058]
curr_Stock_Price:  102.17787652084846
curr_Factors:  [1.02177877e+02 3.34965088e-02]
mat_Sqrt:  [[ 1.87006475e+01  0.00000000e+00]
 [-7.32082059e-03  1.67741072e-02]]
grads:  [-0.02121016 -3.57353231]
Stock Position:  -0.02121016276555904
Bond Position:  [4.93560998]


portfolio before change:  [2.71215158]
curr_Stock_Price:  104.94623948139464
curr_Factors:  [1.04946239e+02 3.15832323e-02]
mat_Sqrt:  [[ 1.86507014e+01  0.00000000e+00]
 [-7.10866877e-03  1.62880064e-02]]
grads:  [ -0.02214146 -11.65459679]
Stock Position:  -0.022141459189811398
Bond Position:  [5.03581445]


portfolio before change:  [2.68467115]
curr_Stock_Price:  106.30111686192612
curr_Factors:  [1.06301117e+02 3.04222482e-02]
mat_Sqrt:  [[ 1.85410139e+01  0.00000000e+00]
 [-6.97678989e-03  1.59858339e-02]]
grads:  [-0.02018451 -3.96528438]
Stock Position:  -0.020184512070554182
Bond Position:  [4.83030733]


portfolio before change:  [2.70658361]
curr_Stock_Price:  105.33519302676471
curr_Factors:  [1.05335193e+02 3.10160560e-02]
mat_Sqrt:  [[ 1.85509768e+01  0.00000000e+00]
 [-7.04455034e-03  1.61410926e-02]]
grads:  [-0.00877481 -0.5821266 ]
Stock Position:  -0.008774812772413883
Bond Position:  [3.63088021]


portfolio before change:  [2.72397117]
curr_Stock_Price:  103.5606057504551
curr_Factors:  [1.03560606e+02 3.15510062e-02]
mat_Sqrt:  [[ 1.83950592e+01  0.00000000e+00]
 [-7.10504116e-03  1.62796945e-02]]
grads:  [ 1.38124272e-03 -8.71158932e+00]
Stock Position:  0.0013812427168224059
Bond Position:  [2.58092884]


portfolio before change:  [2.72612348]
curr_Stock_Price:  104.1843311052598
curr_Factors:  [1.04184331e+02 2.85163269e-02]
mat_Sqrt:  [[ 1.75933766e+01  0.00000000e+00]
 [-6.75471118e-03  1.54769876e-02]]
grads:  [0.01045659 4.37252159]
Stock Position:  0.010456591817624792
Bond Position:  [1.63671045]


portfolio before change:  [2.73100802]
curr_Stock_Price:  104.57317487419242
curr_Factors:  [1.04573175e+02 2.99107326e-02]
mat_Sqrt:  [[ 1.80856374e+01  0.00000000e+00]
 [-6.91788784e-03  1.58508723e-02]]
grads:  [ -0.01745671 -13.46543023]
Stock Position:  -0.017456705534151486
Bond Position:  [4.55651114]


portfolio before change:  [2.66582366]
curr_Stock_Price:  108.43777488909396
curr_Factors:  [1.08437775e+02 3.23067249e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.66582366]
Stock Price:  109.51786441586647
PL:  [-6.85204076]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.90849466e-02 -4.57959685e-01]
 [-7.90058775e-01 -2.35044608e-01]
 [-4.42113135e-01 -6.40833801e-02]
 [-4.25069884e-01 -9.28877787e-02]
 [-2.65410710e-01  2.57903304e-02]
 [ 7.59256654e-01  5.58870006e-01]
 [ 1.04642584e-01  2.09959248e-01]
 [-4.67601621e-01 -4.85476740e-01]
 [ 2.81487409e-02 -2.29754431e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.49551579]
curr_Stock_Price:  103.92443106024231
curr_Factors:  [1.03924431e+02 3.84177492e-02]
mat_Sqrt:  [[ 2.03696522e+01  0.00000000e+00]
 [-7.84017849e-03  1.79641057e-02]]
grads:  [-1.36946344e-02 -2.54930411e+01]
Stock Position:  -0.013694634352693347
Bond Position:  [30.91872287]


portfolio before change:  [29.48882541]
curr_Stock_Price:  105.5421162032559
curr_Factors:  [1.05542116e+02 3.46558373e-02]
mat_Sqrt:  [[ 1.96478030e+01  0.00000000e+00]
 [-7.44643133e-03  1.70619176e-02]]
grads:  [ -0.04543208 -13.77597833]
Stock Position:  -0.04543208470818695
Bond Position:  [34.28382377]


portfolio before change:  [29.46484285]
curr_Stock_Price:  106.44739615022402
curr_Factors:  [1.06447396e+02 3.45798534e-02]
mat_Sqrt:  [[ 1.97945948e+01  0.00000000e+00]
 [-7.43826361e-03  1.70432030e-02]]
grads:  [-0.02374797 -3.76005497]
Stock Position:  -0.023747968546284803
Bond Position:  [31.99275226]


portfolio before change:  [29.46481316]
curr_Stock_Price:  107.1224038230421
curr_Factors:  [1.07122404e+02 3.38928773e-02]
mat_Sqrt:  [[ 1.97212541e+01  0.00000000e+00]
 [-7.36400731e-03  1.68730605e-02]]
grads:  [-0.02360952 -5.50509369]
Stock Position:  -0.023609524587664295
Bond Position:  [31.99392219]


portfolio before change:  [29.44998912]
curr_Stock_Price:  108.42802128830066
curr_Factors:  [1.08428021e+02 3.34610094e-02]
mat_Sqrt:  [[ 1.98340339e+01  0.00000000e+00]
 [-7.31694028e-03  1.67652163e-02]]
grads:  [-0.01281408  1.53832375]
Stock Position:  -0.012814079464648525
Bond Position:  [30.8393944]


portfolio before change:  [29.43132774]
curr_Stock_Price:  111.0879804335751
curr_Factors:  [1.11087980e+02 3.28647085e-02]
mat_Sqrt:  [[ 2.01387247e+01  0.00000000e+00]
 [-7.25145045e-03  1.66151603e-02]]
grads:  [ 0.04981286 33.63614893]
Stock Position:  0.049812862463914
Bond Position:  [23.89771745]


portfolio before change:  [29.35306491]
curr_Stock_Price:  109.27690855314594
curr_Factors:  [1.09276909e+02 3.58887702e-02]
mat_Sqrt:  [[ 2.07017800e+01  0.00000000e+00]
 [-7.57773266e-03  1.73627668e-02]]
grads:  [9.48113220e-03 1.20924995e+01]
Stock Position:  0.009481132199219693
Bond Position:  [28.3169961]


portfolio before change:  [29.36129145]
curr_Stock_Price:  108.65087579555372
curr_Factors:  [1.08650876e+02 3.67225465e-02]
mat_Sqrt:  [[ 2.08209061e+01  0.00000000e+00]
 [-7.66525110e-03  1.75632967e-02]]
grads:  [ -0.03263456 -27.64154979]
Stock Position:  -0.032634556688250306
Bond Position:  [32.90706462]


portfolio before change:  [29.47185141]
curr_Stock_Price:  105.76735840185499
curr_Factors:  [1.05767358e+02 3.49366276e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.47185141]
Stock Price:  107.15284567115626
PL:  [22.31900574]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.08896546e-02 -2.76275149e-01]
 [-2.90008195e-04 -3.52084516e-01]
 [ 2.68693489e-01  1.65638605e-01]
 [ 2.14877566e-01  1.50775601e-01]
 [ 1.16122736e-01 -1.32125924e-01]
 [ 7.73819466e-02 -5.76123487e-02]
 [ 9.23851787e-02 -3.04690929e-01]
 [ 5.27208656e-02 -1.23649997e-01]
 [ 2.43052071e-03 -6.23113492e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.98333061]
curr_Stock_Price:  97.7575925197277
curr_Factors:  [9.77575925e+01 4.09244017e-02]
mat_Sqrt:  [[ 1.97761463e+01  0.00000000e+00]
 [-8.09191218e-03  1.85409000e-02]]
grads:  [-2.00679672e-03 -1.49008488e+01]
Stock Position:  -0.0020067967247279273
Bond Position:  [-12.78715099]


portfolio before change:  [-12.98799242]
curr_Stock_Price:  96.89384395542247
curr_Factors:  [9.68938440e+01 4.08612065e-02]
mat_Sqrt:  [[ 1.95862719e+01  0.00000000e+00]
 [-8.08566203e-03  1.85265792e-02]]
grads:  [-7.86021401e-03 -1.90042918e+01]
Stock Position:  -0.007860214009388149
Bond Position:  [-12.22638607]


portfolio before change:  [-12.98240739]
curr_Stock_Price:  95.40536655887978
curr_Factors:  [9.54053666e+01 3.88849729e-02]
mat_Sqrt:  [[ 1.88132447e+01  0.00000000e+00]
 [-7.88770922e-03  1.80730123e-02]]
grads:  [0.01812468 9.16496944]
Stock Position:  0.018124683340165388
Bond Position:  [-14.71159945]


portfolio before change:  [-12.9900429]
curr_Stock_Price:  95.3900353244095
curr_Factors:  [9.53900353e+01 3.95790233e-02]
mat_Sqrt:  [[ 1.89773491e+01  0.00000000e+00]
 [-7.95779098e-03  1.82335898e-02]]
grads:  [0.01479034 8.26911227]
Stock Position:  0.01479033935112435
Bond Position:  [-14.40089389]


portfolio before change:  [-12.98363239]
curr_Stock_Price:  96.31041717472075
curr_Factors:  [9.63104172e+01 3.55497691e-02]
mat_Sqrt:  [[ 1.81589886e+01  0.00000000e+00]
 [-7.54185856e-03  1.72805689e-02]]
grads:  [ 3.21924621e-03 -7.64592446e+00]
Stock Position:  0.0032192462102563065
Bond Position:  [-13.29367933]


portfolio before change:  [-12.98690795]
curr_Stock_Price:  97.3581590990759
curr_Factors:  [9.73581591e+01 3.26916724e-02]
mat_Sqrt:  [[ 1.76031716e+01  0.00000000e+00]
 [-7.23233543e-03  1.65713623e-02]]
grads:  [ 2.96752525e-03 -3.47662116e+00]
Stock Position:  0.002967525252708147
Bond Position:  [-13.27582075]


portfolio before change:  [-13.00326604]
curr_Stock_Price:  94.08319960753994
curr_Factors:  [9.40831996e+01 3.58022721e-02]
mat_Sqrt:  [[ 1.78019416e+01  0.00000000e+00]
 [-7.56859534e-03  1.73418305e-02]]
grads:  [-2.28024816e-03 -1.75697098e+01]
Stock Position:  -0.0022802481646597857
Bond Position:  [-12.788733]


portfolio before change:  [-13.01347663]
curr_Stock_Price:  95.75609733441026
curr_Factors:  [9.57560973e+01 3.40524042e-02]
mat_Sqrt:  [[ 1.76701537e+01  0.00000000e+00]
 [-7.38131741e-03  1.69127229e-02]]
grads:  [-7.04248172e-05 -7.31106386e+00]
Stock Position:  -7.042481720035067e-05
Bond Position:  [-13.00673303]


portfolio before change:  [-13.01991711]
curr_Stock_Price:  94.84007422321129
curr_Factors:  [9.48400742e+01 3.72305707e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.01991711]
Stock Price:  96.68542038709919
PL:  [-13.01991711]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.04966889e-02 -1.97012715e-01]
 [-1.16241090e-01  5.42788318e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [ 1.59851738e-01  1.55751977e-01]
 [ 9.51123940e-03 -3.21241758e-03]
 [ 8.58882936e-02 -1.34578115e-01]
 [ 2.64004365e-01 -1.28168788e-01]
 [-4.87067311e-02  5.42798138e-02]
 [ 4.27529832e-02 -5.93177952e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.75884852]
curr_Stock_Price:  99.2419249716877
curr_Factors:  [9.92419250e+01 4.13427123e-02]
mat_Sqrt:  [[ 2.01787687e+01  0.00000000e+00]
 [-8.13316296e-03  1.86354174e-02]]
grads:  [-6.76354881e-03 -1.05719507e+01]
Stock Position:  -0.006763548811743379
Bond Position:  [-2.08762091]


portfolio before change:  [-2.76803447]
curr_Stock_Price:  100.44571259978346
curr_Factors:  [1.00445713e+02 4.15808137e-02]
mat_Sqrt:  [[ 2.04822610e+01  0.00000000e+00]
 [-8.15654964e-03  1.86890031e-02]]
grads:  [-0.00451864  2.90431927]
Stock Position:  -0.00451863517878001
Bond Position:  [-2.31415693]


portfolio before change:  [-2.78064419]
curr_Stock_Price:  102.98018565946049
curr_Factors:  [1.02980186e+02 4.02644969e-02]
mat_Sqrt:  [[ 2.06640198e+01  0.00000000e+00]
 [-8.02640611e-03  1.83908068e-02]]
grads:  [ -0.01733708 -16.86892595]
Stock Position:  -0.01733708069354623
Bond Position:  [-0.9952684]


portfolio before change:  [-2.73308141]
curr_Stock_Price:  100.20806175187441
curr_Factors:  [1.00208062e+02 4.28194395e-02]
mat_Sqrt:  [[ 2.07359125e+01  0.00000000e+00]
 [-8.27714342e-03  1.89653181e-02]]
grads:  [0.0109871  8.21246319]
Stock Position:  0.010987096595359375
Bond Position:  [-3.83407707]


portfolio before change:  [-2.71829956]
curr_Stock_Price:  101.72796922286108
curr_Factors:  [1.01727969e+02 4.51136172e-02]
mat_Sqrt:  [[ 2.16069865e+01  0.00000000e+00]
 [-8.49598655e-03  1.94667507e-02]]
grads:  [ 0.00037531 -0.16502074]
Stock Position:  0.0003753057116287201
Bond Position:  [-2.75647865]


portfolio before change:  [-2.72000732]
curr_Stock_Price:  100.85088951406662
curr_Factors:  [1.00850890e+02 4.36563588e-02]
mat_Sqrt:  [[ 2.10718899e+01  0.00000000e+00]
 [-8.35764166e-03  1.91497628e-02]]
grads:  [ 1.28861668e-03 -7.02766490e+00]
Stock Position:  0.00128861667773664
Bond Position:  [-2.84996546]


portfolio before change:  [-2.72278039]
curr_Stock_Price:  99.8050128634028
curr_Factors:  [9.98050129e+01 4.10149072e-02]
mat_Sqrt:  [[ 2.02126484e+01  0.00000000e+00]
 [-8.10085498e-03  1.85613906e-02]]
grads:  [ 0.0102939  -6.90512858]
Stock Position:  0.010293896956148626
Bond Position:  [-3.75016291]


portfolio before change:  [-2.69529075]
curr_Stock_Price:  102.65769300064909
curr_Factors:  [1.02657693e+02 3.81406948e-02]
mat_Sqrt:  [[ 2.00486807e+01  0.00000000e+00]
 [-7.81185712e-03  1.78992133e-02]]
grads:  [-1.24781668e-03  3.03252512e+00]
Stock Position:  -0.0012478166767519974
Bond Position:  [-2.56719277]


portfolio before change:  [-2.6961621]
curr_Stock_Price:  102.32706410527348
curr_Factors:  [1.02327064e+02 4.00731701e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.6961621]
Stock Price:  103.24156564915585
PL:  [-5.93772775]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.29980532e-02 -3.11122262e-01]
 [-2.79830245e-01 -2.54405603e-03]
 [-2.22856928e-01 -3.10233158e-01]
 [ 1.35318974e-01  1.46625950e-01]
 [ 4.22311679e-02 -1.88416584e-02]
 [ 8.82497902e-02 -1.58956942e-01]
 [ 2.39108839e-01 -1.23897768e-01]
 [ 7.19139645e-02 -6.94444090e-02]
 [ 8.69137347e-03 -4.06667560e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.608765]
curr_Stock_Price:  100.60186209320945
curr_Factors:  [1.00601862e+02 3.93315759e-02]
mat_Sqrt:  [[ 1.99515524e+01  0.00000000e+00]
 [-7.93287599e-03  1.81765024e-02]]
grads:  [-9.96328186e-03 -1.71167288e+01]
Stock Position:  -0.009963281864571023
Bond Position:  [7.61108971]


portfolio before change:  [6.6038293]
curr_Stock_Price:  101.47930350167896
curr_Factors:  [1.01479304e+02 4.27049677e-02]
mat_Sqrt:  [[ 2.09708810e+01  0.00000000e+00]
 [-8.26607213e-03  1.89399506e-02]]
grads:  [-0.0133967  -0.13432221]
Stock Position:  -0.013396698108167605
Bond Position:  [7.9633169]


portfolio before change:  [6.59040345]
curr_Stock_Price:  102.77876613991654
curr_Factors:  [1.02778766e+02 4.23035419e-02]
mat_Sqrt:  [[ 2.11393566e+01  0.00000000e+00]
 [-8.22712994e-03  1.88507228e-02]]
grads:  [ -0.01694724 -16.45736136]
Stock Position:  -0.016947241364290246
Bond Position:  [8.33222001]


portfolio before change:  [6.63108763]
curr_Stock_Price:  100.62401821997898
curr_Factors:  [1.00624018e+02 4.14488957e-02]
mat_Sqrt:  [[ 2.04860457e+01  0.00000000e+00]
 [-8.14360074e-03  1.86593334e-02]]
grads:  [0.00972915 7.85804865]
Stock Position:  0.009729148669167232
Bond Position:  [5.6521016]


portfolio before change:  [6.63284418]
curr_Stock_Price:  100.51401792983289
curr_Factors:  [1.00514018e+02 4.28261167e-02]
mat_Sqrt:  [[ 2.08008452e+01  0.00000000e+00]
 [-8.27778876e-03  1.89667968e-02]]
grads:  [ 0.00163493 -0.99340224]
Stock Position:  0.0016349332765988752
Bond Position:  [6.46851047]


portfolio before change:  [6.63853537]
curr_Stock_Price:  102.01629854419448
curr_Factors:  [1.02016299e+02 4.41589942e-02]
mat_Sqrt:  [[ 2.14377473e+01  0.00000000e+00]
 [-8.40561661e-03  1.92596872e-02]]
grads:  [ 8.80469988e-04 -8.25335014e+00]
Stock Position:  0.0008804699884260437
Bond Position:  [6.54871309]


portfolio before change:  [6.64108486]
curr_Stock_Price:  101.19208824600113
curr_Factors:  [1.01192088e+02 4.72940958e-02]
mat_Sqrt:  [[ 2.20064516e+01  0.00000000e+00]
 [-8.69888230e-03  1.99316433e-02]]
grads:  [ 0.00840824 -6.21613414]
Stock Position:  0.008408235123268907
Bond Position:  [5.79023799]


portfolio before change:  [6.62284453]
curr_Stock_Price:  98.67834208008435
curr_Factors:  [9.86783421e+01 5.14100309e-02]
mat_Sqrt:  [[ 2.23741104e+01  0.00000000e+00]
 [-9.06951209e-03  2.07808628e-02]]
grads:  [ 1.85955727e-03 -3.34174811e+00]
Stock Position:  0.0018595572708689086
Bond Position:  [6.4393465]


portfolio before change:  [6.62202847]
curr_Stock_Price:  96.50764418045159
curr_Factors:  [9.65076442e+01 5.31753237e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.62202847]
Stock Price:  97.08474162955365
PL:  [6.62202847]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.83158773e-02 -4.50939799e-01]
 [-1.39868962e-01  4.87563075e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [-2.54220512e-01 -2.86695565e-02]
 [-2.78260031e-01  3.02431371e-02]
 [ 6.47102777e-01  4.35097335e-01]
 [ 1.35903656e-01  1.64148143e-01]
 [-3.87419538e-01 -4.11517441e-01]
 [ 2.62013572e-02 -1.21815240e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.40234666]
curr_Stock_Price:  103.76573095243171
curr_Factors:  [1.03765731e+02 4.09142150e-02]
mat_Sqrt:  [[ 2.09889668e+01  0.00000000e+00]
 [-8.09090502e-03  1.85385923e-02]]
grads:  [-1.31079411e-02 -2.43243818e+01]
Stock Position:  -0.013107941067075949
Bond Position:  [29.76250175]


portfolio before change:  [28.4587782]
curr_Stock_Price:  100.59615814830715
curr_Factors:  [1.00596158e+02 4.39079920e-02]
mat_Sqrt:  [[ 2.10791543e+01  0.00000000e+00]
 [-8.38169358e-03  1.92048726e-02]]
grads:  [-0.00562594  2.53874673]
Stock Position:  -0.005625935593998455
Bond Position:  [29.02472571]


portfolio before change:  [28.45872265]
curr_Stock_Price:  103.18622512976017
curr_Factors:  [1.03186225e+02 4.02378785e-02]
mat_Sqrt:  [[ 2.06985185e+01  0.00000000e+00]
 [-8.02375259e-03  1.83847268e-02]]
grads:  [ -0.01730818 -16.87450464]
Stock Position:  -0.01730818454551626
Bond Position:  [30.24468887]


portfolio before change:  [28.43662715]
curr_Stock_Price:  105.3367468082292
curr_Factors:  [1.05336747e+02 3.62356202e-02]
mat_Sqrt:  [[ 2.00515408e+01  0.00000000e+00]
 [-7.61426243e-03  1.74464670e-02]]
grads:  [-0.01330237 -1.64328724]
Stock Position:  -0.013302365847963703
Bond Position:  [29.83785509]


portfolio before change:  [28.40533925]
curr_Stock_Price:  108.81060661668893
curr_Factors:  [1.08810607e+02 3.63130503e-02]
mat_Sqrt:  [[ 2.07349311e+01  0.00000000e+00]
 [-7.62239336e-03  1.74650973e-02]]
grads:  [-0.0127833  1.7316329]
Stock Position:  -0.01278329991989154
Bond Position:  [29.79629787]


portfolio before change:  [28.40569928]
curr_Stock_Price:  109.94817246197691
curr_Factors:  [1.09948172e+02 3.67661610e-02]
mat_Sqrt:  [[ 2.10820169e+01  0.00000000e+00]
 [-7.66980167e-03  1.75737234e-02]]
grads:  [ 0.03970184 24.75840356]
Stock Position:  0.03970183810649279
Bond Position:  [24.04055473]


portfolio before change:  [28.32949627]
curr_Stock_Price:  107.72595070461747
curr_Factors:  [1.07725951e+02 4.00469291e-02]
mat_Sqrt:  [[ 2.15578251e+01  0.00000000e+00]
 [-8.00469153e-03  1.83410524e-02]]
grads:  [0.00962731 8.94976685]
Stock Position:  0.009627305997030535
Bond Position:  [27.29238558]


portfolio before change:  [28.33727267]
curr_Stock_Price:  107.11589382573301
curr_Factors:  [1.07115894e+02 3.94169135e-02]
mat_Sqrt:  [[ 2.12664610e+01  0.00000000e+00]
 [-7.94147730e-03  1.81962104e-02]]
grads:  [ -0.02666266 -22.6155574 ]
Stock Position:  -0.02666266258293233
Bond Position:  [31.19326761]


portfolio before change:  [28.36514177]
curr_Stock_Price:  106.65575372119619
curr_Factors:  [1.06655754e+02 4.31546333e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.36514177]
Stock Price:  107.12443397048085
PL:  [21.2407078]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-1.45970019e-02 -1.88062776e-01]
 [ 2.33606230e-01  1.53688106e-01]
 [ 1.70827679e-01  1.58080179e-01]
 [ 8.57082749e-03 -3.26777465e-03]
 [ 8.82323584e-02 -1.51660340e-01]
 [ 1.42118513e-01  1.25055076e-01]
 [-4.22165821e-01 -4.44999148e-01]
 [ 2.53111944e-02 -7.01296763e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.6158679]
curr_Stock_Price:  98.9723334055848
curr_Factors:  [9.89723334e+01 4.19942096e-02]
mat_Sqrt:  [[ 2.02818943e+01  0.00000000e+00]
 [-8.19699551e-03  1.87816762e-02]]
grads:  [-6.55156490e-03 -1.01383738e+01]
Stock Position:  -0.006551564901922319
Bond Position:  [-3.96744424]


portfolio before change:  [-4.60885875]
curr_Stock_Price:  97.5996281160169
curr_Factors:  [9.75996281e+01 4.15795414e-02]
mat_Sqrt:  [[ 1.99016008e+01  0.00000000e+00]
 [-8.15642484e-03  1.86887171e-02]]
grads:  [-4.85761560e-03 -1.00629045e+01]
Stock Position:  -0.004857615595698507
Bond Position:  [-4.13475728]


portfolio before change:  [-4.61742341]
curr_Stock_Price:  98.93706587345332
curr_Factors:  [9.89370659e+01 3.88540510e-02]
mat_Sqrt:  [[ 1.95019114e+01  0.00000000e+00]
 [-7.88457237e-03  1.80658249e-02]]
grads:  [0.01541804 8.5071181 ]
Stock Position:  0.015418038361908786
Bond Position:  [-6.14283889]


portfolio before change:  [-4.60477383]
curr_Stock_Price:  99.95676564727037
curr_Factors:  [9.99567656e+01 3.72626694e-02]
mat_Sqrt:  [[ 1.92951952e+01  0.00000000e+00]
 [-7.72141639e-03  1.76919875e-02]]
grads:  [0.01242898 8.93512831]
Stock Position:  0.01242897634150861
Bond Position:  [-5.8471341]


portfolio before change:  [-4.58539991]
curr_Stock_Price:  101.75081654279643
curr_Factors:  [1.01750817e+02 3.68743102e-02]
mat_Sqrt:  [[ 1.95388885e+01  0.00000000e+00]
 [-7.68107390e-03  1.75995513e-02]]
grads:  [ 0.00036566 -0.18567375]
Stock Position:  0.0003656632616098098
Bond Position:  [-4.62260644]


portfolio before change:  [-4.58696082]
curr_Stock_Price:  103.80452828157928
curr_Factors:  [1.03804528e+02 3.64442839e-02]
mat_Sqrt:  [[ 1.98166852e+01  0.00000000e+00]
 [-7.63615441e-03  1.74966278e-02]]
grads:  [ 1.11231314e-03 -8.66797546e+00]
Stock Position:  0.0011123131409162027
Bond Position:  [-4.70242396]


portfolio before change:  [-4.58674298]
curr_Stock_Price:  106.11470431789073
curr_Factors:  [1.06114704e+02 3.68522300e-02]
mat_Sqrt:  [[ 2.03707705e+01  0.00000000e+00]
 [-7.67877386e-03  1.75942812e-02]]
grads:  [0.00965585 7.10771157]
Stock Position:  0.009655846020862929
Bond Position:  [-5.61137023]


portfolio before change:  [-4.57351643]
curr_Stock_Price:  107.77514273363852
curr_Factors:  [1.07775143e+02 3.35433295e-02]
mat_Sqrt:  [[ 1.97388429e+01  0.00000000e+00]
 [-7.32593524e-03  1.67858264e-02]]
grads:  [ -0.03122672 -26.51041048]
Stock Position:  -0.03122672254982689
Bond Position:  [-1.20805195]


portfolio before change:  [-4.55215001]
curr_Stock_Price:  107.07155955120685
curr_Factors:  [1.07071560e+02 3.55063493e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.55215001]
Stock Price:  109.2623776730601
PL:  [-13.81452768]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-8.12224201e-02 -4.77470046e-01]
 [-6.86696212e-01 -2.64579091e-01]
 [-4.41452304e-01 -6.48252675e-02]
 [-5.40024941e-01 -1.36092062e-01]
 [-3.15056809e-01  4.23542005e-02]
 [ 3.54512623e-01  1.11750403e-01]
 [ 1.33817228e-01  1.77272318e-01]
 [-4.22069721e-01 -4.45016675e-01]
 [ 2.09466971e-02  2.65271518e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.53641747]
curr_Stock_Price:  104.36589195955028
curr_Factors:  [1.04365892e+02 3.81159331e-02]
mat_Sqrt:  [[ 2.03756685e+01  0.00000000e+00]
 [-7.80932090e-03  1.78934021e-02]]
grads:  [-1.42133953e-02 -2.66841400e+01]
Stock Position:  -0.014213395342316122
Bond Position:  [34.01981116]


portfolio before change:  [32.54902158]
curr_Stock_Price:  104.67616610753099
curr_Factors:  [1.04676166e+02 3.85388948e-02]
mat_Sqrt:  [[ 2.05493191e+01  0.00000000e+00]
 [-7.85253028e-03  1.79924072e-02]]
grads:  [ -0.03903623 -14.7050413 ]
Stock Position:  -0.03903623235130859
Bond Position:  [36.63518473]


portfolio before change:  [32.49852787]
curr_Stock_Price:  106.43903812684955
curr_Factors:  [1.06439038e+02 3.64446667e-02]
mat_Sqrt:  [[ 2.03197300e+01  0.00000000e+00]
 [-7.63619451e-03  1.74967197e-02]]
grads:  [-0.02311765 -3.70499548]
Stock Position:  -0.02311764826118312
Bond Position:  [34.95914812]


portfolio before change:  [32.47241737]
curr_Stock_Price:  108.32480301430294
curr_Factors:  [1.08324803e+02 3.70109141e-02]
mat_Sqrt:  [[ 2.08397648e+01  0.00000000e+00]
 [-7.69528834e-03  1.76321207e-02]]
grads:  [-0.0287633 -7.7184171]
Stock Position:  -0.028763298950349837
Bond Position:  [35.58819606]


portfolio before change:  [32.43643331]
curr_Stock_Price:  110.19463748092936
curr_Factors:  [1.10194637e+02 3.64109515e-02]
mat_Sqrt:  [[ 2.10269593e+01  0.00000000e+00]
 [-7.63266156e-03  1.74886247e-02]]
grads:  [-0.01410437  2.42181425]
Stock Position:  -0.014104365534831053
Bond Position:  [33.99065876]


portfolio before change:  [32.49907525]
curr_Stock_Price:  106.95859285404057
curr_Factors:  [1.06958593e+02 3.75681955e-02]
mat_Sqrt:  [[ 2.07312672e+01  0.00000000e+00]
 [-7.75300669e-03  1.77643700e-02]]
grads:  [0.01945296 6.29070455]
Stock Position:  0.019452959356702118
Bond Position:  [30.41841409]


portfolio before change:  [32.54005937]
curr_Stock_Price:  108.28338412136571
curr_Factors:  [1.08283384e+02 3.36751725e-02]
mat_Sqrt:  [[ 1.98708633e+01  0.00000000e+00]
 [-7.34031852e-03  1.68187826e-02]]
grads:  [ 0.01062788 10.54013969]
Stock Position:  0.010627883060115464
Bond Position:  [31.38923622]


portfolio before change:  [32.55033216]
curr_Stock_Price:  107.77286385868884
curr_Factors:  [1.07772864e+02 3.31976615e-02]
mat_Sqrt:  [[ 1.96364588e+01  0.00000000e+00]
 [-7.28809018e-03  1.66991124e-02]]
grads:  [ -0.03138503 -26.64912137]
Stock Position:  -0.03138503373971112
Bond Position:  [35.93278713]


portfolio before change:  [32.50372212]
curr_Stock_Price:  109.83056196045696
curr_Factors:  [1.09830562e+02 3.28948782e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [32.50372212]
Stock Price:  109.5718949602635
PL:  [22.93182716]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.61912062e-02 -3.40268620e-01]
 [-4.29916476e-01 -9.81012992e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [ 7.50022167e-02  1.20895333e-01]
 [ 3.38120478e-02 -1.28285228e-02]
 [ 8.72666833e-02 -1.41141382e-01]
 [ 2.51782556e-01 -1.36246728e-01]
 [-4.61248141e-02  4.23360848e-02]
 [ 3.94490743e-02 -5.14738521e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.15152748]
curr_Stock_Price:  101.26135464280563
curr_Factors:  [1.01261355e+02 3.88458424e-02]
mat_Sqrt:  [[ 1.99579534e+01  0.00000000e+00]
 [-7.88373946e-03  1.80639164e-02]]
grads:  [-1.0757446e-02 -1.8836924e+01]
Stock Position:  -0.010757446027529694
Bond Position:  [12.24084104]


portfolio before change:  [11.14279989]
curr_Stock_Price:  102.64175133052848
curr_Factors:  [1.02641751e+02 3.90596461e-02]
mat_Sqrt:  [[ 2.02856163e+01  0.00000000e+00]
 [-7.90540535e-03  1.81135592e-02]]
grads:  [-0.02330377 -5.41590408]
Stock Position:  -0.02330377282064449
Bond Position:  [13.53473994]


portfolio before change:  [11.14254271]
curr_Stock_Price:  102.9432579530375
curr_Factors:  [1.02943258e+02 3.64285339e-02]
mat_Sqrt:  [[ 1.96480183e+01  0.00000000e+00]
 [-7.63450419e-03  1.74928467e-02]]
grads:  [ -0.01823358 -17.73485835]
Stock Position:  -0.01823358326710103
Bond Position:  [13.01956717]


portfolio before change:  [11.17627975]
curr_Stock_Price:  101.45009953742998
curr_Factors:  [1.01450100e+02 3.64715598e-02]
mat_Sqrt:  [[ 1.93744617e+01  0.00000000e+00]
 [-7.63901143e-03  1.75031741e-02]]
grads:  [6.5945195e-03 6.9070520e+00]
Stock Position:  0.006594519504691989
Bond Position:  [10.50726509]


portfolio before change:  [11.1780797]
curr_Stock_Price:  100.9261812622544
curr_Factors:  [1.00926181e+02 3.58218808e-02]
mat_Sqrt:  [[ 1.91019645e+01  0.00000000e+00]
 [-7.57066769e-03  1.73465789e-02]]
grads:  [ 0.00147698 -0.73954195]
Stock Position:  0.001476980097958487
Bond Position:  [11.02901374]


portfolio before change:  [11.18757453]
curr_Stock_Price:  103.6201496226128
curr_Factors:  [1.03620150e+02 3.26777803e-02]
mat_Sqrt:  [[ 1.87314108e+01  0.00000000e+00]
 [-7.23079861e-03  1.65678410e-02]]
grads:  [ 1.37029370e-03 -8.51899664e+00]
Stock Position:  0.0013702937011964337
Bond Position:  [11.04558449]


portfolio before change:  [11.18923126]
curr_Stock_Price:  100.79780555380061
curr_Factors:  [1.00797806e+02 3.70873509e-02]
mat_Sqrt:  [[ 1.94117185e+01  0.00000000e+00]
 [-7.70323058e-03  1.76503186e-02]]
grads:  [ 0.0099074  -7.71922201]
Stock Position:  0.009907397394338767
Bond Position:  [10.19058734]


portfolio before change:  [11.21088047]
curr_Stock_Price:  102.46854163453365
curr_Factors:  [1.02468542e+02 3.81538795e-02]
mat_Sqrt:  [[ 2.00151988e+01  0.00000000e+00]
 [-7.81320723e-03  1.79023068e-02]]
grads:  [-1.38134186e-03  2.36483965e+00]
Stock Position:  -0.0013813418585871056
Bond Position:  [11.35242456]


portfolio before change:  [11.21571681]
curr_Stock_Price:  103.07758325743201
curr_Factors:  [1.03077583e+02 3.75520122e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.21571681]
Stock Price:  102.13257228050232
PL:  [9.08314453]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.31770047e-02 -3.12755690e-01]
 [-2.94648876e-02 -1.76107218e-02]
 [ 9.33395023e-02  3.22494612e-02]
 [ 2.02079321e-01  1.64511175e-01]
 [ 3.04911079e-02 -1.04624287e-02]
 [ 8.79188432e-02 -1.52959622e-01]
 [ 1.40716496e-01  1.33874131e-01]
 [-3.33645078e-01 -3.60867763e-01]
 [ 3.32342403e-02 -3.67189642e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.86462191]
curr_Stock_Price:  100.63900595091819
curr_Factors:  [1.00639006e+02 4.24759120e-02]
mat_Sqrt:  [[ 2.07413822e+01  0.00000000e+00]
 [-8.24387404e-03  1.88890884e-02]]
grads:  [-9.62687907e-03 -1.65574793e+01]
Stock Position:  -0.009626879066845237
Bond Position:  [7.83346145]


portfolio before change:  [6.89083338]
curr_Stock_Price:  98.32322330459965
curr_Factors:  [9.83232233e+01 4.56329083e-02]
mat_Sqrt:  [[ 2.10036698e+01  0.00000000e+00]
 [-8.54474419e-03  1.95784685e-02]]
grads:  [-0.00176878 -0.89949435]
Stock Position:  -0.0017687783660548112
Bond Position:  [7.06474537]


portfolio before change:  [6.88983068]
curr_Stock_Price:  100.8876799425836
curr_Factors:  [1.00887680e+02 4.58006605e-02]
mat_Sqrt:  [[ 2.15910620e+01  0.00000000e+00]
 [-8.56043555e-03  1.96144219e-02]]
grads:  [0.00497494 1.64417087]
Stock Position:  0.004974943836336116
Bond Position:  [6.38792014]


portfolio before change:  [6.88440491]
curr_Stock_Price:  99.15489014102438
curr_Factors:  [9.91548901e+01 4.71514603e-02]
mat_Sqrt:  [[ 2.15308766e+01  0.00000000e+00]
 [-8.68575480e-03  1.99015644e-02]]
grads:  [0.01272024 8.26624335]
Stock Position:  0.012720238453393954
Bond Position:  [5.62313106]


portfolio before change:  [6.91161736]
curr_Stock_Price:  101.0731081136052
curr_Factors:  [1.01073108e+02 4.56445421e-02]
mat_Sqrt:  [[ 2.15938484e+01  0.00000000e+00]
 [-8.54583333e-03  1.95809641e-02]]
grads:  [ 0.00120057 -0.53431632]
Stock Position:  0.0012005701430130604
Bond Position:  [6.79027201]


portfolio before change:  [6.91678292]
curr_Stock_Price:  102.54704881687292
curr_Factors:  [1.02547049e+02 4.85821521e-02]
mat_Sqrt:  [[ 2.26027635e+01  0.00000000e+00]
 [-8.81654373e-03  2.02012395e-02]]
grads:  [ 9.36247962e-04 -7.57179388e+00]
Stock Position:  0.0009362479622136979
Bond Position:  [6.82077345]


portfolio before change:  [6.92385822]
curr_Stock_Price:  106.46060317778468
curr_Factors:  [1.06460603e+02 4.55006586e-02]
mat_Sqrt:  [[ 2.27089871e+01  0.00000000e+00]
 [-8.53235335e-03  1.95500776e-02]]
grads:  [0.00876939 6.84775448]
Stock Position:  0.008769389645796138
Bond Position:  [5.9902637]


portfolio before change:  [6.92361105]
curr_Stock_Price:  106.0907889540607
curr_Factors:  [1.06090789e+02 4.46697403e-02]
mat_Sqrt:  [[ 2.24225186e+01  0.00000000e+00]
 [-8.45408685e-03  1.93707465e-02]]
grads:  [ -0.0219039  -18.62952281]
Stock Position:  -0.021903903413874326
Bond Position:  [9.24741345]


portfolio before change:  [6.96310166]
curr_Stock_Price:  104.49902942634277
curr_Factors:  [1.04499029e+02 4.85441791e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.96310166]
Stock Price:  100.89677826140007
PL:  [6.0663234]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.03254950e-02 -3.78005447e-01]
 [ 7.26627518e-04  8.22088193e-02]
 [ 2.27946410e-01  1.51760407e-01]
 [ 1.72339990e-01  1.58400968e-01]
 [ 4.67414816e-02 -2.10313611e-02]
 [ 7.71977303e-02 -5.18368671e-02]
 [ 1.28838212e-01 -2.75365203e-01]
 [ 5.31037744e-02 -1.22646232e-01]
 [ 3.57702971e-03 -2.57210104e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.03425552]
curr_Stock_Price:  102.11537581093475
curr_Factors:  [1.02115376e+02 4.08431252e-02]
mat_Sqrt:  [[ 2.06371929e+01  0.00000000e+00]
 [-8.08387286e-03  1.85224796e-02]]
grads:  [-1.14017734e-02 -2.04079289e+01]
Stock Position:  -0.011401773424131546
Bond Position:  [18.1985519]


portfolio before change:  [17.07554332]
curr_Stock_Price:  99.2924596743126
curr_Factors:  [9.92924597e+01 4.39906089e-02]
mat_Sqrt:  [[ 2.08255393e+01  0.00000000e+00]
 [-8.38957534e-03  1.92229320e-02]]
grads:  [1.75772148e-03 4.27660147e+00]
Stock Position:  0.001757721481892762
Bond Position:  [16.90101483]


portfolio before change:  [17.08438822]
curr_Stock_Price:  99.51563283195057
curr_Factors:  [9.95156328e+01 4.61938721e-02]
mat_Sqrt:  [[ 2.13886559e+01  0.00000000e+00]
 [-8.59710389e-03  1.96984397e-02]]
grads:  [0.01375402 7.70418416]
Stock Position:  0.013754023809180385
Bond Position:  [15.71564784]


portfolio before change:  [17.0976209]
curr_Stock_Price:  99.90627396766641
curr_Factors:  [9.99062740e+01 4.52558811e-02]
mat_Sqrt:  [[ 2.12534910e+01  0.00000000e+00]
 [-8.50937188e-03  1.94974204e-02]]
grads:  [0.01136151 8.12420131]
Stock Position:  0.011361514243707366
Bond Position:  [15.96253434]


portfolio before change:  [17.10691489]
curr_Stock_Price:  100.02163973177305
curr_Factors:  [1.00021640e+02 4.66331827e-02]
mat_Sqrt:  [[ 2.15993906e+01  0.00000000e+00]
 [-8.63788703e-03  1.97918856e-02]]
grads:  [ 0.00173906 -1.06262544]
Stock Position:  0.0017390603198306693
Bond Position:  [16.93297122]


portfolio before change:  [17.11156267]
curr_Stock_Price:  97.82457820679768
curr_Factors:  [9.78245782e+01 4.80933102e-02]
mat_Sqrt:  [[ 2.14531129e+01  0.00000000e+00]
 [-8.77207480e-03  2.00993484e-02]]
grads:  [ 2.54388568e-03 -2.57903222e+00]
Stock Position:  0.0025438856766616964
Bond Position:  [16.86270813]


portfolio before change:  [17.11458239]
curr_Stock_Price:  95.69644109130114
curr_Factors:  [9.56964411e+01 5.21683972e-02]
mat_Sqrt:  [[ 2.18574520e+01  0.00000000e+00]
 [-9.13616088e-03  2.09335744e-02]]
grads:  [ 3.96157087e-04 -1.31542372e+01]
Stock Position:  0.00039615708694539875
Bond Position:  [17.07667157]


portfolio before change:  [17.12363515]
curr_Stock_Price:  96.9895870334177
curr_Factors:  [9.6989587e+01 5.1673417e-02]
mat_Sqrt:  [[ 2.20474670e+01  0.00000000e+00]
 [-9.09271506e-03  2.08340275e-02]]
grads:  [-1.92053539e-05 -5.88682296e+00]
Stock Position:  -1.920535385234313e-05
Bond Position:  [17.12549787]


portfolio before change:  [17.13224467]
curr_Stock_Price:  94.6660638429334
curr_Factors:  [9.46660638e+01 5.28499397e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.13224467]
Stock Price:  95.57862264259387
PL:  [17.13224467]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.86408398e-03 -2.18611868e-01]
 [ 4.73735166e-02 -8.98520363e-01]
 [ 2.82543180e-01  1.70355722e-01]
 [ 1.72012960e-01  1.34652882e-01]
 [ 3.72478846e-01 -2.62875833e-01]
 [ 7.77858828e-02 -7.02764045e-02]
 [ 1.27849361e-01 -2.75747771e-01]
 [ 5.38039141e-02 -1.20810870e-01]
 [ 1.36471398e-02 -4.75267773e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.10567271]
curr_Stock_Price:  98.32052895149387
curr_Factors:  [9.83205290e+01 4.07583005e-02]
mat_Sqrt:  [[ 1.98496220e+01  0.00000000e+00]
 [-8.07547403e-03  1.85032355e-02]]
grads:  [-5.15244701e-03 -1.18147914e+01]
Stock Position:  -0.005152447006880856
Bond Position:  [-8.59908139]


portfolio before change:  [-9.09045812]
curr_Stock_Price:  94.5329696666731
curr_Factors:  [9.45329697e+01 4.16766391e-02]
mat_Sqrt:  [[ 1.92987707e+01  0.00000000e+00]
 [-8.16594284e-03  1.87105256e-02]]
grads:  [-1.78650198e-02 -4.80221872e+01]
Stock Position:  -0.017865019755248006
Bond Position:  [-7.40162475]


portfolio before change:  [-9.08495632]
curr_Stock_Price:  94.01779840922616
curr_Factors:  [9.40177984e+01 4.42482314e-02]
mat_Sqrt:  [[ 1.97768917e+01  0.00000000e+00]
 [-8.41410544e-03  1.92791375e-02]]
grads:  [0.01804594 8.836273  ]
Stock Position:  0.018045935499701536
Bond Position:  [-10.78159544]


portfolio before change:  [-9.11320033]
curr_Stock_Price:  92.75148187891469
curr_Factors:  [9.27514819e+01 4.48054130e-02]
mat_Sqrt:  [[ 1.96329744e+01  0.00000000e+00]
 [-8.46691566e-03  1.94001410e-02]]
grads:  [0.01175473 6.9408198 ]
Stock Position:  0.011754729162007772
Bond Position:  [-10.20346888]


portfolio before change:  [-9.11702741]
curr_Stock_Price:  92.8600280063701
curr_Factors:  [9.28600280e+01 4.74822883e-02]
mat_Sqrt:  [[ 2.02346003e+01  0.00000000e+00]
 [-8.71617240e-03  1.99712599e-02]]
grads:  [ 1.27381032e-02 -1.31627065e+01]
Stock Position:  0.012738103161624204
Bond Position:  [-10.29988802]


portfolio before change:  [-9.0774118]
curr_Stock_Price:  96.37443163496198
curr_Factors:  [9.63744316e+01 4.46446531e-02]
mat_Sqrt:  [[ 2.03632248e+01  0.00000000e+00]
 [-8.45171255e-03  1.93653063e-02]]
grads:  [ 2.31371729e-03 -3.62898493e+00]
Stock Position:  0.002313717290103746
Bond Position:  [-9.30039499]


portfolio before change:  [-9.08374336]
curr_Stock_Price:  95.64824289717201
curr_Factors:  [9.56482429e+01 4.42565319e-02]
mat_Sqrt:  [[ 2.01217470e+01  0.00000000e+00]
 [-8.41489459e-03  1.92809457e-02]]
grads:  [ 3.72888453e-04 -1.43015688e+01]
Stock Position:  0.00037288845306703645
Bond Position:  [-9.11940948]


portfolio before change:  [-9.08853923]
curr_Stock_Price:  95.01795657999944
curr_Factors:  [9.50179566e+01 4.39341319e-02]
mat_Sqrt:  [[ 1.99162107e+01  0.00000000e+00]
 [-8.38418816e-03  1.92105884e-02]]
grads:  [ 5.41130857e-05 -6.28876469e+00]
Stock Position:  5.411308568766202e-05
Bond Position:  [-9.09368094]


portfolio before change:  [-9.0929803]
curr_Stock_Price:  96.99361494526852
curr_Factors:  [9.69936149e+01 4.51347741e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.0929803]
Stock Price:  97.47679888988459
PL:  [-9.0929803]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.02036962e-02 -2.85616021e-01]
 [-3.74383781e-01 -6.16279122e-02]
 [-2.43027081e-01 -2.87588971e-01]
 [ 5.96430872e-03  7.99925112e-02]
 [-1.23350126e-01 -1.05403786e-02]
 [ 1.83629524e-01 -7.66861246e-02]
 [ 1.45489595e-01  1.03850091e-01]
 [-3.51862399e-01 -3.77192869e-01]
 [ 2.52668239e-02 -6.97899059e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.65968725]
curr_Stock_Price:  100.17373167355142
curr_Factors:  [1.00173732e+02 4.46707860e-02]
mat_Sqrt:  [[ 2.11721835e+01  0.00000000e+00]
 [-8.45418580e-03  1.93709732e-02]]
grads:  [-8.73111397e-03 -1.47445365e+01]
Stock Position:  -0.00873111397116813
Bond Position:  [4.53431552]


portfolio before change:  [3.64432472]
curr_Stock_Price:  102.1929769638927
curr_Factors:  [1.02192977e+02 4.63091468e-02]
mat_Sqrt:  [[ 2.19914791e+01  0.00000000e+00]
 [-8.60782405e-03  1.97230026e-02]]
grads:  [-0.01824709 -3.1246719 ]
Stock Position:  -0.018247085847696243
Bond Position:  [5.50904874]


portfolio before change:  [3.61805478]
curr_Stock_Price:  103.783649860664
curr_Factors:  [1.03783650e+02 4.60510781e-02]
mat_Sqrt:  [[ 2.22714678e+01  0.00000000e+00]
 [-8.58380597e-03  1.96679703e-02]]
grads:  [ -0.01654768 -14.62219874]
Stock Position:  -0.016547683363849604
Bond Position:  [5.33543376]


portfolio before change:  [3.64302661]
curr_Stock_Price:  102.43582145460917
curr_Factors:  [1.02435821e+02 4.64235408e-02]
mat_Sqrt:  [[ 2.20709479e+01  0.00000000e+00]
 [-8.61844912e-03  1.97473477e-02]]
grads:  [1.85202298e-03 4.05079772e+00]
Stock Position:  0.0018520229833260847
Bond Position:  [3.45331311]


portfolio before change:  [3.64928514]
curr_Stock_Price:  104.88257557087856
curr_Factors:  [1.04882576e+02 4.75083585e-02]
mat_Sqrt:  [[ 2.28606385e+01  0.00000000e+00]
 [-8.71856489e-03  1.99767418e-02]]
grads:  [-0.00559697 -0.52763252]
Stock Position:  -0.005596970716999917
Bond Position:  [4.23630984]


portfolio before change:  [3.64947439]
curr_Stock_Price:  105.22730397930742
curr_Factors:  [1.05227304e+02 4.66608713e-02]
mat_Sqrt:  [[ 2.27302842e+01  0.00000000e+00]
 [-8.64045103e-03  1.97977604e-02]]
grads:  [ 0.00660621 -3.87347472]
Stock Position:  0.0066062067090913515
Bond Position:  [2.95432107]


portfolio before change:  [3.65091422]
curr_Stock_Price:  105.22159789789146
curr_Factors:  [1.05221598e+02 4.37435347e-02]
mat_Sqrt:  [[ 2.20070500e+01  0.00000000e+00]
 [-8.36598205e-03  1.91688730e-02]]
grads:  [0.00867056 5.41764199]
Stock Position:  0.008670561982610299
Bond Position:  [2.73858384]


portfolio before change:  [3.66286122]
curr_Stock_Price:  106.44151486339466
curr_Factors:  [1.06441515e+02 4.56297421e-02]
mat_Sqrt:  [[ 2.27370991e+01  0.00000000e+00]
 [-8.54444775e-03  1.95777893e-02]]
grads:  [ -0.02271542 -19.26636674]
Stock Position:  -0.022715424763989064
Bond Position:  [6.08072545]


portfolio before change:  [3.65133019]
curr_Stock_Price:  107.08302403564244
curr_Factors:  [1.07083024e+02 4.59986127e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.65133019]
Stock Price:  107.98185985922329
PL:  [-4.33052967]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.53790879e-02 -3.32855793e-01]
 [-6.20392022e-01 -2.21599293e-01]
 [-2.66772754e-01 -2.60930696e-01]
 [-3.01083980e-01 -4.62814850e-02]
 [-9.37332257e-02 -6.46812354e-03]
 [ 3.17050683e-01  7.04392106e-02]
 [ 1.34337676e-01  1.73998566e-01]
 [-4.71499594e-02  4.55980755e-02]
 [ 2.72903172e-02 -1.84092620e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.99632156]
curr_Stock_Price:  101.09364838484227
curr_Factors:  [1.01093648e+02 3.93690019e-02]
mat_Sqrt:  [[ 2.00586210e+01  0.00000000e+00]
 [-7.93664936e-03  1.81851482e-02]]
grads:  [-1.05016823e-02 -1.83037163e+01]
Stock Position:  -0.010501682339394693
Bond Position:  [11.05797494]


portfolio before change:  [9.96974475]
curr_Stock_Price:  104.15098494214355
curr_Factors:  [1.04150985e+02 3.85648894e-02]
mat_Sqrt:  [[ 2.04531134e+01  0.00000000e+00]
 [-7.85517811e-03  1.79984741e-02]]
grads:  [ -0.03506096 -12.31211553]
Stock Position:  -0.03506096445247586
Bond Position:  [13.62137874]


portfolio before change:  [9.9783672]
curr_Stock_Price:  104.09935902143698
curr_Factors:  [1.04099359e+02 3.71127530e-02]
mat_Sqrt:  [[ 2.00543985e+01  0.00000000e+00]
 [-7.70586820e-03  1.76563622e-02]]
grads:  [ -0.01898099 -14.77828183]
Stock Position:  -0.018980985417744452
Bond Position:  [11.95427562]


portfolio before change:  [9.95155082]
curr_Stock_Price:  105.82714153830366
curr_Factors:  [1.05827142e+02 3.85941594e-02]
mat_Sqrt:  [[ 2.07901613e+01  0.00000000e+00]
 [-7.85815850e-03  1.80053031e-02]]
grads:  [-0.0154536  -2.57043632]
Stock Position:  -0.015453601913765212
Bond Position:  [11.58696134]


portfolio before change:  [9.98237508]
curr_Stock_Price:  104.20749735104147
curr_Factors:  [1.04207497e+02 3.96080774e-02]
mat_Sqrt:  [[ 2.07391450e+01  0.00000000e+00]
 [-7.96071127e-03  1.82402810e-02]]
grads:  [-0.00465574 -0.35460657]
Stock Position:  -0.004655743835305373
Bond Position:  [10.4675385]


portfolio before change:  [9.976569]
curr_Stock_Price:  106.57901080830968
curr_Factors:  [1.06579011e+02 3.95385328e-02]
mat_Sqrt:  [[ 2.11924887e+01  0.00000000e+00]
 [-7.95371941e-03  1.82242606e-02]]
grads:  [0.01641114 3.86513407]
Stock Position:  0.016411138885686283
Bond Position:  [8.22748605]


portfolio before change:  [10.0061068]
curr_Stock_Price:  108.12814283974488
curr_Factors:  [1.08128143e+02 4.25648821e-02]
mat_Sqrt:  [[ 2.23081965e+01  0.00000000e+00]
 [-8.25250334e-03  1.89088606e-02]]
grads:  [0.00942599 9.20195929]
Stock Position:  0.009425991744203862
Bond Position:  [8.98689181]


portfolio before change:  [9.95762845]
curr_Stock_Price:  102.50826559490666
curr_Factors:  [1.02508266e+02 4.93620140e-02]
mat_Sqrt:  [[ 2.27748393e+01  0.00000000e+00]
 [-8.88702551e-03  2.03627336e-02]]
grads:  [-1.19646630e-03  2.23929048e+00]
Stock Position:  -0.0011964663006956945
Bond Position:  [10.08027613]


portfolio before change:  [9.95831141]
curr_Stock_Price:  106.15102525417794
curr_Factors:  [1.06151025e+02 4.78876326e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.95831141]
Stock Price:  108.74585245205729
PL:  [1.21245896]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.42118374e-02 -3.22201402e-01]
 [-1.46057407e-04  8.18624704e-02]
 [-2.90138814e-01 -2.34698597e-01]
 [-1.52278599e-02  6.68918174e-02]
 [ 3.44686374e-02 -1.32978527e-02]
 [ 8.54984463e-02 -1.30153367e-01]
 [ 1.36862758e-01 -2.67882002e-01]
 [ 5.18275150e-02 -1.25991846e-01]
 [ 3.91289482e-03 -3.38327906e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.33618422]
curr_Stock_Price:  100.85263904019794
curr_Factors:  [1.00852639e+02 4.06954884e-02]
mat_Sqrt:  [[ 2.03451267e+01  0.00000000e+00]
 [-8.06924913e-03  1.84889725e-02]]
grads:  [-1.00678684e-02 -1.74266797e+01]
Stock Position:  -0.010067868358527698
Bond Position:  [9.35155532]


portfolio before change:  [8.35554278]
curr_Stock_Price:  99.3943744505166
curr_Factors:  [9.93943745e+01 4.24383798e-02]
mat_Sqrt:  [[ 2.04758152e+01  0.00000000e+00]
 [-8.24023104e-03  1.88807412e-02]]
grads:  [1.73774052e-03 4.33576571e+00]
Stock Position:  0.001737740516184285
Bond Position:  [8.18282115]


portfolio before change:  [8.36835566]
curr_Stock_Price:  104.4126395086812
curr_Factors:  [1.04412640e+02 3.82038337e-02]
mat_Sqrt:  [[ 2.04082867e+01  0.00000000e+00]
 [-7.81832040e-03  1.79140225e-02]]
grads:  [ -0.0192358  -13.10139011]
Stock Position:  -0.01923579790759578
Bond Position:  [10.37681609]


portfolio before change:  [8.4053768]
curr_Stock_Price:  102.7578378070754
curr_Factors:  [1.02757838e+02 3.70903207e-02]
mat_Sqrt:  [[ 1.97899753e+01  0.00000000e+00]
 [-7.70353900e-03  1.76510253e-02]]
grads:  [7.05717035e-04 3.78968453e+00]
Stock Position:  0.0007057170349861351
Bond Position:  [8.33285884]


portfolio before change:  [8.40822823]
curr_Stock_Price:  100.8930177605544
curr_Factors:  [1.00893018e+02 3.71880896e-02]
mat_Sqrt:  [[ 1.94564251e+01  0.00000000e+00]
 [-7.71368546e-03  1.76742738e-02]]
grads:  [ 0.00147329 -0.75238467]
Stock Position:  0.0014732911398863003
Bond Position:  [8.25958344]


portfolio before change:  [8.41218913]
curr_Stock_Price:  100.77767715229636
curr_Factors:  [1.00777677e+02 3.38130555e-02]
mat_Sqrt:  [[ 1.85313284e+01  0.00000000e+00]
 [-7.35533064e-03  1.68531797e-02]]
grads:  [ 1.54845131e-03 -7.72277811e+00]
Stock Position:  0.0015484513143433915
Bond Position:  [8.2561398]


portfolio before change:  [8.40898299]
curr_Stock_Price:  96.04053039427124
curr_Factors:  [9.60405304e+01 3.71870705e-02]
mat_Sqrt:  [[ 1.85204073e+01  0.00000000e+00]
 [-7.71357976e-03  1.76740316e-02]]
grads:  [ 1.07716137e-03 -1.51568136e+01]
Stock Position:  0.0010771613746557776
Bond Position:  [8.30553184]


portfolio before change:  [8.41450135]
curr_Stock_Price:  97.30733695450333
curr_Factors:  [9.73073370e+01 3.48100071e-02]
mat_Sqrt:  [[ 1.81550581e+01  0.00000000e+00]
 [-7.46297604e-03  1.70998263e-02]]
grads:  [-1.74047058e-04 -7.36801902e+00]
Stock Position:  -0.0001740470575638288
Bond Position:  [8.4314374]


portfolio before change:  [8.41893464]
curr_Stock_Price:  96.06332705894324
curr_Factors:  [9.60633271e+01 3.76628741e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.41893464]
Stock Price:  96.83012441047688
PL:  [8.41893464]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.71915380e-02 -4.40677091e-01]
 [-6.01028052e-01 -2.09132593e-01]
 [-4.01010092e-01 -1.10228049e-01]
 [-9.27661645e-02  3.20179713e-02]
 [-3.02954140e-02 -3.24855544e-03]
 [ 8.83539689e-02 -1.63060387e-01]
 [ 1.84688601e-01 -1.82710426e-02]
 [ 1.03474189e-01  4.51104303e-02]
 [ 3.24245580e-04 -1.29526522e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.80178551]
curr_Stock_Price:  103.53337054246761
curr_Factors:  [1.03533371e+02 3.85592973e-02]
mat_Sqrt:  [[ 2.03303525e+01  0.00000000e+00]
 [-7.85460856e-03  1.79971691e-02]]
grads:  [-1.32569659e-02 -2.44859115e+01]
Stock Position:  -0.013256965851631148
Bond Position:  [28.17432387]


portfolio before change:  [26.80970062]
curr_Stock_Price:  103.999207110157
curr_Factors:  [1.03999207e+02 3.72748587e-02]
mat_Sqrt:  [[ 2.00788128e+01  0.00000000e+00]
 [-7.72267919e-03  1.76948810e-02]]
grads:  [ -0.03447918 -11.81881888]
Stock Position:  -0.0344791798948574
Bond Position:  [30.39550799]


portfolio before change:  [26.75944903]
curr_Stock_Price:  105.89754527931784
curr_Factors:  [1.05897545e+02 3.73358170e-02]
mat_Sqrt:  [[ 2.04620303e+01  0.00000000e+00]
 [-7.72899135e-03  1.77093439e-02]]
grads:  [-0.02194883 -6.22428753]
Stock Position:  -0.02194882668462678
Bond Position:  [29.0837759]


portfolio before change:  [26.82333828]
curr_Stock_Price:  103.64941936295428
curr_Factors:  [1.03649419e+02 3.91367473e-02]
mat_Sqrt:  [[ 2.05049747e+01  0.00000000e+00]
 [-7.91320388e-03  1.81314279e-02]]
grads:  [-0.0038426   1.76588251]
Stock Position:  -0.003842598069779188
Bond Position:  [27.22162134]


portfolio before change:  [26.84066838]
curr_Stock_Price:  102.68239348964514
curr_Factors:  [1.02682393e+02 4.16662754e-02]
mat_Sqrt:  [[ 2.09598574e+01  0.00000000e+00]
 [-8.16492748e-03  1.87081991e-02]]
grads:  [-0.00151304 -0.17364341]
Stock Position:  -0.001513044635709146
Bond Position:  [26.99603143]


portfolio before change:  [26.85633995]
curr_Stock_Price:  101.24808680913321
curr_Factors:  [1.01248087e+02 4.36975197e-02]
mat_Sqrt:  [[ 2.11648512e+01  0.00000000e+00]
 [-8.36158068e-03  1.91587882e-02]]
grads:  [ 8.12128637e-04 -8.51099689e+00]
Stock Position:  0.0008121286374868821
Bond Position:  [26.77411347]


portfolio before change:  [26.87100776]
curr_Stock_Price:  102.82099973380346
curr_Factors:  [1.02821000e+02 3.92496513e-02]
mat_Sqrt:  [[ 2.03704078e+01  0.00000000e+00]
 [-7.92460990e-03  1.81575624e-02]]
grads:  [ 0.00867506 -1.00624975]
Stock Position:  0.008675057769551093
Bond Position:  [25.97902964]


portfolio before change:  [26.85552426]
curr_Stock_Price:  99.53845548053624
curr_Factors:  [9.95384555e+01 4.21062040e-02]
mat_Sqrt:  [[ 2.04250883e+01  0.00000000e+00]
 [-8.20791852e-03  1.88067040e-02]]
grads:  [0.00602994 2.39863564]
Stock Position:  0.0060299369660164895
Bond Position:  [26.25531365]


portfolio before change:  [26.84222467]
curr_Stock_Price:  95.1552380206657
curr_Factors:  [9.51552380e+01 4.32319716e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.84222467]
Stock Price:  94.54950469724514
PL:  [26.84222467]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 1.65899739e-02 -2.34023609e-01]
 [-6.56828276e-02  6.60957753e-02]
 [ 2.43310190e-01  1.56993213e-01]
 [ 2.05605396e-01  1.64461338e-01]
 [ 6.77622928e-02 -9.38214336e-02]
 [ 7.80139091e-02 -7.74253988e-02]
 [ 2.04179066e-01 -1.95343688e-01]
 [ 8.92332290e-02 -1.77005595e-02]
 [ 4.01919011e-02 -5.32374270e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.99227187]
curr_Stock_Price:  98.19181750243352
curr_Factors:  [9.81918175e+01 4.02802099e-02]
mat_Sqrt:  [[ 1.97070293e+01  0.00000000e+00]
 [-8.02797209e-03  1.83943949e-02]]
grads:  [-4.34090302e-03 -1.27225500e+01]
Stock Position:  -0.004340903019836039
Bond Position:  [-9.56603071]


portfolio before change:  [-10.00542495]
curr_Stock_Price:  100.1197272424986
curr_Factors:  [1.00119727e+02 4.00668398e-02]
mat_Sqrt:  [[ 2.00406684e+01  0.00000000e+00]
 [-8.00668119e-03  1.83456113e-02]]
grads:  [-1.83807573e-03  3.60281127e+00]
Stock Position:  -0.0018380757337565041
Bond Position:  [-9.82139731]


portfolio before change:  [-10.0063722]
curr_Stock_Price:  97.96275638327627
curr_Factors:  [9.79627564e+01 4.08811033e-02]
mat_Sqrt:  [[ 1.98071641e+01  0.00000000e+00]
 [-8.08763039e-03  1.85310892e-02]]
grads:  [0.01574317 8.47188266]
Stock Position:  0.015743174719652097
Bond Position:  [-11.54861699]


portfolio before change:  [-9.99668206]
curr_Stock_Price:  98.94514308059591
curr_Factors:  [9.89451431e+01 3.92990068e-02]
mat_Sqrt:  [[ 1.96148625e+01  0.00000000e+00]
 [-7.92959084e-03  1.81689751e-02]]
grads:  [0.01414143 9.05176748]
Stock Position:  0.014141430164681819
Bond Position:  [-11.39590789]


portfolio before change:  [-10.02750677]
curr_Stock_Price:  97.16842516231206
curr_Factors:  [9.71684252e+01 3.75376661e-02]
mat_Sqrt:  [[ 1.88260322e+01  0.00000000e+00]
 [-7.74985586e-03  1.77571505e-02]]
grads:  [ 1.42437142e-03 -5.28358609e+00]
Stock Position:  0.0014243714164166089
Bond Position:  [-10.1659107]


portfolio before change:  [-10.03452984]
curr_Stock_Price:  95.80723670085142
curr_Factors:  [9.58072367e+01 3.74760531e-02]
mat_Sqrt:  [[ 1.85470668e+01  0.00000000e+00]
 [-7.74349307e-03  1.77425716e-02]]
grads:  [ 2.38434978e-03 -4.36382058e+00]
Stock Position:  0.0023843497812919556
Bond Position:  [-10.2629678]


portfolio before change:  [-10.03416021]
curr_Stock_Price:  98.1149487869019
curr_Factors:  [9.81149488e+01 3.66196377e-02]
mat_Sqrt:  [[ 1.87755299e+01  0.00000000e+00]
 [-7.65450327e-03  1.75386703e-02]]
grads:  [ 6.33399384e-03 -1.11378847e+01]
Stock Position:  0.0063339938350020246
Bond Position:  [-10.65561969]


portfolio before change:  [-10.03325647]
curr_Stock_Price:  99.09898663921602
curr_Factors:  [9.90989866e+01 3.39790660e-02]
mat_Sqrt:  [[ 1.82673240e+01  0.00000000e+00]
 [-7.37336460e-03  1.68945007e-02]]
grads:  [ 0.00446196 -1.04771131]
Stock Position:  0.004461960135320463
Bond Position:  [-10.47543219]


portfolio before change:  [-10.02151431]
curr_Stock_Price:  102.90475363883999
curr_Factors:  [1.02904754e+02 3.14722121e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.02151431]
Stock Price:  104.5761512257575
PL:  [-14.59766554]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.82777255e-02 -3.59313884e-01]
 [-5.22574654e-01 -1.58013097e-01]
 [-3.33645610e-01 -1.85855336e-01]
 [-5.41588306e-02  4.72475249e-02]
 [-8.06814327e-02 -3.88388655e-03]
 [ 4.65489333e-01  2.34283688e-01]
 [ 1.33503829e-01  1.79243681e-01]
 [-4.90002335e-01 -5.05797096e-01]
 [ 2.07715793e-02  1.84737549e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.12106414]
curr_Stock_Price:  101.69245517125978
curr_Factors:  [1.01692455e+02 4.13613541e-02]
mat_Sqrt:  [[ 2.06816939e+01  0.00000000e+00]
 [-8.13499641e-03  1.86396184e-02]]
grads:  [-1.08837874e-02 -1.92768905e+01]
Stock Position:  -0.010883787446785996
Bond Position:  [15.22786321]


portfolio before change:  [14.11039097]
curr_Stock_Price:  103.37284494489732
curr_Factors:  [1.03372845e+02 4.13199650e-02]
mat_Sqrt:  [[ 2.10129217e+01  0.00000000e+00]
 [-8.13092516e-03  1.86302900e-02]]
grads:  [-0.02815112 -8.48151568]
Stock Position:  -0.02815111735498187
Bond Position:  [17.02045206]


portfolio before change:  [14.07320482]
curr_Stock_Price:  104.99617304607757
curr_Factors:  [1.04996173e+02 4.10512999e-02]
mat_Sqrt:  [[ 2.12734010e+01  0.00000000e+00]
 [-8.10444815e-03  1.85696236e-02]]
grads:  [ -0.01949663 -10.00856776]
Stock Position:  -0.01949662531509797
Bond Position:  [16.12027587]


portfolio before change:  [14.11537274]
curr_Stock_Price:  103.24685691836584
curr_Factors:  [1.03246857e+02 4.19274166e-02]
mat_Sqrt:  [[ 2.11410178e+01  0.00000000e+00]
 [-8.19047413e-03  1.87667338e-02]]
grads:  [-1.58640992e-03  2.51762109e+00]
Stock Position:  -0.0015864099154295867
Bond Position:  [14.27916458]


portfolio before change:  [14.12150605]
curr_Stock_Price:  103.88228994668212
curr_Factors:  [1.03882290e+02 3.94162124e-02]
mat_Sqrt:  [[ 2.06242877e+01  0.00000000e+00]
 [-7.94140667e-03  1.81960486e-02]]
grads:  [-0.00399415 -0.2134467 ]
Stock Position:  -0.0039941500424092785
Bond Position:  [14.5364275]


portfolio before change:  [14.1119755]
curr_Stock_Price:  108.08858563687511
curr_Factors:  [1.08088586e+02 3.49652538e-02]
mat_Sqrt:  [[ 2.02114828e+01  0.00000000e+00]
 [-7.47959933e-03  1.71379151e-02]]
grads:  [ 0.02808993 13.67048953]
Stock Position:  0.028089929005900707
Bond Position:  [11.07577481]


portfolio before change:  [14.12519463]
curr_Stock_Price:  108.36198808114261
curr_Factors:  [1.08361988e+02 3.50296671e-02]
mat_Sqrt:  [[ 2.02812617e+01  0.00000000e+00]
 [-7.48648565e-03  1.71536936e-02]]
grads:  [1.04397935e-02 1.04492761e+01]
Stock Position:  0.01043979353592607
Bond Position:  [12.99391785]


portfolio before change:  [14.13920083]
curr_Stock_Price:  109.08112260186412
curr_Factors:  [1.09081123e+02 3.70933202e-02]
mat_Sqrt:  [[ 2.10086165e+01  0.00000000e+00]
 [-7.70385048e-03  1.76517390e-02]]
grads:  [ -0.03383137 -28.65423606]
Stock Position:  -0.03383137039913481
Bond Position:  [17.82956469]


portfolio before change:  [14.14558556]
curr_Stock_Price:  109.1559726857824
curr_Factors:  [1.09155973e+02 3.88805577e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.14558556]
Stock Price:  106.2069848260245
PL:  [7.93860074]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.13455680e-02 -2.76574731e-01]
 [-2.70474527e-01  2.19220572e-03]
 [ 2.50512158e-01  1.59446158e-01]
 [ 2.01925106e-01  1.64513354e-01]
 [ 2.90673094e-02 -9.44501248e-03]
 [ 8.47629237e-02 -1.21570328e-01]
 [ 2.23128432e-01 -9.55219146e-02]
 [-1.56559102e-01 -9.64315337e-02]
 [ 2.68741338e-02 -1.59142849e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.37151808]
curr_Stock_Price:  97.70123765983814
curr_Factors:  [9.77012377e+01 3.98914615e-02]
mat_Sqrt:  [[ 1.95137187e+01  0.00000000e+00]
 [-7.98913878e-03  1.83054166e-02]]
grads:  [-2.01712146e-03 -1.51089012e+01]
Stock Position:  -0.002017121461499172
Bond Position:  [-13.17444281]


portfolio before change:  [-13.3856218]
curr_Stock_Price:  101.4267692671951
curr_Factors:  [1.01426769e+02 3.87808416e-02]
mat_Sqrt:  [[ 1.99738235e+01  0.00000000e+00]
 [-7.87714076e-03  1.80487969e-02]]
grads:  [-0.01349355  0.12145994]
Stock Position:  -0.013493549217679852
Bond Position:  [-12.01701469]


portfolio before change:  [-13.33511858]
curr_Stock_Price:  97.23860320097891
curr_Factors:  [9.72386032e+01 4.15153923e-02]
mat_Sqrt:  [[ 1.98126827e+01  0.00000000e+00]
 [-8.15013053e-03  1.86742950e-02]]
grads:  [0.01615633 8.53826921]
Stock Position:  0.016156326305728757
Bond Position:  [-14.90613718]


portfolio before change:  [-13.31129628]
curr_Stock_Price:  99.17451572064866
curr_Factors:  [9.91745157e+01 4.22142140e-02]
mat_Sqrt:  [[ 2.03764931e+01  0.00000000e+00]
 [-8.21843917e-03  1.88308098e-02]]
grads:  [0.01343335 8.73639296]
Stock Position:  0.01343335274868585
Bond Position:  [-14.64354253]


portfolio before change:  [-13.29216075]
curr_Stock_Price:  101.14417518446234
curr_Factors:  [1.01144175e+02 4.33631499e-02]
mat_Sqrt:  [[ 2.10620815e+01  0.00000000e+00]
 [-8.32952819e-03  1.90853467e-02]]
grads:  [ 0.00118436 -0.49488294]
Stock Position:  0.0011843638542590577
Bond Position:  [-13.41195226]


portfolio before change:  [-13.2994292]
curr_Stock_Price:  100.6706717112659
curr_Factors:  [1.00670672e+02 4.46473615e-02]
mat_Sqrt:  [[ 2.12716347e+01  0.00000000e+00]
 [-8.45196891e-03  1.93658936e-02]]
grads:  [ 1.49049582e-03 -6.27754806e+00]
Stock Position:  0.0014904958222716554
Bond Position:  [-13.44947842]


portfolio before change:  [-13.30473172]
curr_Stock_Price:  101.62599289333285
curr_Factors:  [1.01625993e+02 4.55558563e-02]
mat_Sqrt:  [[ 2.16908669e+01  0.00000000e+00]
 [-8.53752716e-03  1.95619322e-02]]
grads:  [ 0.00836478 -4.88305109]
Stock Position:  0.008364776357425333
Bond Position:  [-14.15481042]


portfolio before change:  [-13.29209551]
curr_Stock_Price:  103.98294655007079
curr_Factors:  [1.03982947e+02 4.31160127e-02]
mat_Sqrt:  [[ 2.15914304e+01  0.00000000e+00]
 [-8.30575826e-03  1.90308830e-02]]
grads:  [-0.00920019 -5.0671077 ]
Stock Position:  -0.009200190506557964
Bond Position:  [-12.33543259]


portfolio before change:  [-13.32002996]
curr_Stock_Price:  106.34867986136071
curr_Factors:  [1.06348680e+02 4.04957883e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.32002996]
Stock Price:  103.25891474446435
PL:  [-16.57894471]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 6.38361369e-02 -2.65069224e-01]
 [ 3.75407275e-02 -7.85792896e-01]
 [ 2.69737015e-01  1.65994023e-01]
 [ 2.11627831e-01  1.49553274e-01]
 [ 1.44949314e-01 -1.55619311e-01]
 [ 7.69557434e-02 -4.42501880e-02]
 [ 2.55354819e-01 -1.38317849e-01]
 [ 6.80649438e-03  1.17705102e-02]
 [ 3.31945611e-02 -3.66247602e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.76891668]
curr_Stock_Price:  97.93389426143062
curr_Factors:  [9.79338943e+01 4.61731363e-02]
mat_Sqrt:  [[ 2.10439718e+01  0.00000000e+00]
 [-8.59517411e-03  1.96940180e-02]]
grads:  [-2.46386744e-03 -1.34593776e+01]
Stock Position:  -0.0024638674398506357
Bond Position:  [-11.52762055]


portfolio before change:  [-11.76745327]
curr_Stock_Price:  95.0000245239626
curr_Factors:  [9.50000245e+01 4.82116116e-02]
mat_Sqrt:  [[ 2.08592910e+01  0.00000000e+00]
 [-8.78285708e-03  2.01240537e-02]]
grads:  [-1.46413130e-02 -3.90474458e+01]
Stock Position:  -0.014641313014525915
Bond Position:  [-10.37652817]


portfolio before change:  [-11.77723161]
curr_Stock_Price:  95.31343743445287
curr_Factors:  [9.53134374e+01 4.97276023e-02]
mat_Sqrt:  [[ 2.12545978e+01  0.00000000e+00]
 [-8.91987464e-03  2.04380004e-02]]
grads:  [0.01609923 8.12183288]
Stock Position:  0.01609923408819792
Bond Position:  [-13.31170495]


portfolio before change:  [-11.7860643]
curr_Stock_Price:  95.17832682730022
curr_Factors:  [9.51783268e+01 4.87184230e-02]
mat_Sqrt:  [[ 2.10079985e+01  0.00000000e+00]
 [-8.82890009e-03  2.02295515e-02]]
grads:  [0.01318061 7.39281215]
Stock Position:  0.013180609810475934
Bond Position:  [-13.04057269]


portfolio before change:  [-11.78456729]
curr_Stock_Price:  95.78671495539932
curr_Factors:  [9.57867150e+01 5.08606657e-02]
mat_Sqrt:  [[ 2.16021163e+01  0.00000000e+00]
 [-9.02092374e-03  2.06695329e-02]]
grads:  [ 3.56592280e-03 -7.52892245e+00]
Stock Position:  0.0035659227959169574
Bond Position:  [-12.12613532]


portfolio before change:  [-11.78123572]
curr_Stock_Price:  98.42169987094744
curr_Factors:  [9.84216999e+01 5.00749133e-02]
mat_Sqrt:  [[ 2.20242417e+01  0.00000000e+00]
 [-8.95096985e-03  2.05092484e-02]]
grads:  [ 0.00261727 -2.15757238]
Stock Position:  0.0026172695938141946
Bond Position:  [-12.03883184]


portfolio before change:  [-11.78429321]
curr_Stock_Price:  99.55396297045826
curr_Factors:  [9.95539630e+01 5.24448859e-02]
mat_Sqrt:  [[ 2.27987022e+01  0.00000000e+00]
 [-9.16033938e-03  2.09889743e-02]]
grads:  [ 0.00855259 -6.5900242 ]
Stock Position:  0.00855259038120493
Bond Position:  [-12.63573747]


portfolio before change:  [-11.7762025]
curr_Stock_Price:  101.23885068050502
curr_Factors:  [1.01238851e+02 4.92463965e-02]
mat_Sqrt:  [[ 2.24664490e+01  0.00000000e+00]
 [-8.87661165e-03  2.03388724e-02]]
grads:  [5.31617887e-04 5.78719898e-01]
Stock Position:  0.0005316178869007437
Bond Position:  [-11.83002288]


portfolio before change:  [-11.78038097]
curr_Stock_Price:  104.50815799217557
curr_Factors:  [1.04508158e+02 4.87008664e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.78038097]
Stock Price:  105.97668426876987
PL:  [-17.75706524]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.70555400e-02 -3.48158058e-01]
 [-6.44412722e-01 -2.37099096e-01]
 [-4.30653780e-01 -7.69483186e-02]
 [-2.02717933e-01 -9.31104432e-03]
 [-1.09497116e-01 -9.70121880e-03]
 [ 2.09144891e-01 -4.91144923e-02]
 [ 1.35695936e-01  1.65454756e-01]
 [-4.33116698e-01 -4.54253713e-01]
 [ 2.38307218e-02  1.29053769e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.38157357]
curr_Stock_Price:  101.43992577421838
curr_Factors:  [1.01439926e+02 3.97011449e-02]
mat_Sqrt:  [[ 2.02120535e+01  0.00000000e+00]
 [-7.97005846e-03  1.82616981e-02]]
grads:  [-1.08353253e-02 -1.90649334e+01]
Stock Position:  -0.010835325289856017
Bond Position:  [13.48070817]


portfolio before change:  [12.35689324]
curr_Stock_Price:  104.33991947046081
curr_Factors:  [1.04339919e+02 3.96327080e-02]
mat_Sqrt:  [[ 2.07719549e+01  0.00000000e+00]
 [-7.96318609e-03  1.82459515e-02]]
grads:  [ -0.03600486 -12.99461394]
Stock Position:  -0.03600485631417781
Bond Position:  [16.11363705]


portfolio before change:  [12.29458205]
curr_Stock_Price:  106.29437868001348
curr_Factors:  [1.06294379e+02 3.64002249e-02]
mat_Sqrt:  [[ 2.02797376e+01  0.00000000e+00]
 [-7.63153719e-03  1.74860484e-02]]
grads:  [-0.02289166 -4.40055505]
Stock Position:  -0.02289165615163886
Bond Position:  [14.72783642]


portfolio before change:  [12.33619225]
curr_Stock_Price:  104.79844311087768
curr_Factors:  [1.04798443e+02 3.68558960e-02]
mat_Sqrt:  [[ 2.01190893e+01  0.00000000e+00]
 [-7.67915579e-03  1.75951563e-02]]
grads:  [-0.01027788 -0.52918224]
Stock Position:  -0.010277881042911932
Bond Position:  [13.41329818]


portfolio before change:  [12.34497542]
curr_Stock_Price:  104.59656849939844
curr_Factors:  [1.04596568e+02 3.66362030e-02]
mat_Sqrt:  [[ 2.00203961e+01  0.00000000e+00]
 [-7.65623437e-03  1.75426368e-02]]
grads:  [-0.00568076 -0.55300802]
Stock Position:  -0.005680760497422205
Bond Position:  [12.93916347]


portfolio before change:  [12.34651042]
curr_Stock_Price:  105.46550058741174
curr_Factors:  [1.05465501e+02 3.34136220e-02]
mat_Sqrt:  [[ 1.92784537e+01  0.00000000e+00]
 [-7.31175732e-03  1.67533407e-02]]
grads:  [ 0.00973675 -2.9316238 ]
Stock Position:  0.009736754425267455
Bond Position:  [11.31961874]


portfolio before change:  [12.37480933]
curr_Stock_Price:  107.79047217377502
curr_Factors:  [1.07790472e+02 3.53438779e-02]
mat_Sqrt:  [[ 2.02645738e+01  0.00000000e+00]
 [-7.51998702e-03  1.72304549e-02]]
grads:  [0.01025959 9.60246016]
Stock Position:  0.010259594615039475
Bond Position:  [11.26892278]


portfolio before change:  [12.38247467]
curr_Stock_Price:  107.98828437485216
curr_Factors:  [1.07988284e+02 3.59569571e-02]
mat_Sqrt:  [[ 2.04770838e+01  0.00000000e+00]
 [-7.58492790e-03  1.73792531e-02]]
grads:  [ -0.03083297 -26.13770049]
Stock Position:  -0.03083296811214141
Bond Position:  [15.712074]


portfolio before change:  [12.39764914]
curr_Stock_Price:  107.75099081489809
curr_Factors:  [1.07750991e+02 3.70102801e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.39764914]
Stock Price:  108.7569643618723
PL:  [3.64068477]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.76064299e-02 -3.53186453e-01]
 [-5.51051402e-02  6.85680899e-02]
 [ 2.41094890e-01  1.56238696e-01]
 [-1.12558590e-01  2.45840961e-02]
 [-8.13272470e-02 -3.78227313e-03]
 [ 2.16379522e-01 -4.04707866e-02]
 [ 1.83778464e-01 -1.53900194e-02]
 [-5.17107456e-02  6.67454552e-02]
 [ 3.69454425e-02 -4.55298788e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.16555671]
curr_Stock_Price:  101.55374000917313
curr_Factors:  [1.01553740e+02 4.02556705e-02]
mat_Sqrt:  [[ 2.03755553e+01  0.00000000e+00]
 [-8.02552632e-03  1.83887909e-02]]
grads:  [-1.08831210e-02 -1.92066164e+01]
Stock Position:  -0.010883121045171723
Bond Position:  [14.27077835]


portfolio before change:  [13.18911452]
curr_Stock_Price:  100.04492314508438
curr_Factors:  [1.00044923e+02 4.53772147e-02]
mat_Sqrt:  [[ 2.13114977e+01  0.00000000e+00]
 [-8.52077130e-03  1.95235397e-02]]
grads:  [-1.18150177e-03  3.51207265e+00]
Stock Position:  -0.0011815017730591687
Bond Position:  [13.30731777]


portfolio before change:  [13.19796213]
curr_Stock_Price:  98.18940818956487
curr_Factors:  [9.81894082e+01 4.39160576e-02]
mat_Sqrt:  [[ 2.05767279e+01  0.00000000e+00]
 [-8.38246337e-03  1.92066365e-02]]
grads:  [0.01503072 8.13462037]
Stock Position:  0.015030720554654558
Bond Position:  [11.72210458]


portfolio before change:  [13.28901898]
curr_Stock_Price:  103.85742180608825
curr_Factors:  [1.03857422e+02 4.46165204e-02]
mat_Sqrt:  [[ 2.19374117e+01  0.00000000e+00]
 [-8.44904921e-03  1.93592038e-02]]
grads:  [-0.00464181  1.2698919 ]
Stock Position:  -0.004641806069858554
Bond Position:  [13.77110499]


portfolio before change:  [13.29568077]
curr_Stock_Price:  103.90599780516015
curr_Factors:  [1.03905998e+02 4.59975985e-02]
mat_Sqrt:  [[ 2.22847721e+01  0.00000000e+00]
 [-8.57882029e-03  1.96565467e-02]]
grads:  [-0.00372353 -0.19241799]
Stock Position:  -0.0037235277144823374
Bond Position:  [13.68257764]


portfolio before change:  [13.29635482]
curr_Stock_Price:  105.56274772412023
curr_Factors:  [1.05562748e+02 4.70488969e-02]
mat_Sqrt:  [[ 2.28973598e+01  0.00000000e+00]
 [-8.67630307e-03  1.98799078e-02]]
grads:  [ 0.00867858 -2.03576329]
Stock Position:  0.00867858236148128
Bond Position:  [12.38021982]


portfolio before change:  [13.27911703]
curr_Stock_Price:  102.86306173115801
curr_Factors:  [1.02863062e+02 4.68067824e-02]
mat_Sqrt:  [[ 2.22542950e+01  0.00000000e+00]
 [-8.65395007e-03  1.98286906e-02]]
grads:  [ 0.00795629 -0.77614905]
Stock Position:  0.00795629376705149
Bond Position:  [12.46070829]


portfolio before change:  [13.28519389]
curr_Stock_Price:  102.8435737467908
curr_Factors:  [1.02843574e+02 4.89632143e-02]
mat_Sqrt:  [[ 2.27568486e+01  0.00000000e+00]
 [-8.85105321e-03  2.02803107e-02]]
grads:  [-9.9225693e-04  3.2911456e+00]
Stock Position:  -0.0009922569298330154
Bond Position:  [13.38724114]


portfolio before change:  [13.29108348]
curr_Stock_Price:  103.65556670809742
curr_Factors:  [1.03655567e+02 5.06894003e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.29108348]
Stock Price:  103.9707786339999
PL:  [9.32030484]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-1.41847722e-04  8.21191380e-02]
 [ 9.20693569e-02  3.08737254e-02]
 [ 1.32731635e-01  1.45497656e-01]
 [-2.73078460e-02 -3.48820480e-03]
 [ 7.67736940e-02 -3.85426423e-02]
 [ 2.43392655e-01 -1.31610800e-01]
 [-3.14326727e-02  1.34475173e-02]
 [ 3.79417072e-02 -4.78951510e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.33439393]
curr_Stock_Price:  98.722847521946
curr_Factors:  [9.87228475e+01 3.81804499e-02]
mat_Sqrt:  [[ 1.92902650e+01  0.00000000e+00]
 [-7.81592731e-03  1.79085393e-02]]
grads:  [-6.88835259e-03 -1.06326737e+01]
Stock Position:  -0.006888352587089324
Bond Position:  [-5.65435615]


portfolio before change:  [-6.34070191]
curr_Stock_Price:  99.22806173829531
curr_Factors:  [9.92280617e+01 3.96215009e-02]
mat_Sqrt:  [[ 1.97514948e+01  0.00000000e+00]
 [-7.96206012e-03  1.82433716e-02]]
grads:  [1.80735092e-03 4.50131367e+00]
Stock Position:  0.001807350918878247
Bond Position:  [-6.52004184]


portfolio before change:  [-6.34095432]
curr_Stock_Price:  100.89260903778867
curr_Factors:  [1.00892609e+02 3.74717391e-02]
mat_Sqrt:  [[ 1.95304063e+01  0.00000000e+00]
 [-7.74304736e-03  1.77415503e-02]]
grads:  [0.00540407 1.74019321]
Stock Position:  0.005404073727016308
Bond Position:  [-6.88618542]


portfolio before change:  [-6.34561997]
curr_Stock_Price:  100.6665400234424
curr_Factors:  [1.00666540e+02 3.80638605e-02]
mat_Sqrt:  [[ 1.96400034e+01  0.00000000e+00]
 [-7.80398468e-03  1.78811753e-02]]
grads:  [0.00999145 8.13691793]
Stock Position:  0.009991445220109774
Bond Position:  [-7.35142419]


portfolio before change:  [-6.32990648]
curr_Stock_Price:  102.60721198652578
curr_Factors:  [1.02607212e+02 3.76822404e-02]
mat_Sqrt:  [[ 1.99180237e+01  0.00000000e+00]
 [-7.76476559e-03  1.77913130e-02]]
grads:  [-0.00144744 -0.19606225]
Stock Position:  -0.0014474439733988534
Bond Position:  [-6.18138829]


portfolio before change:  [-6.32757347]
curr_Stock_Price:  98.8595825118707
curr_Factors:  [9.88595825e+01 3.82725838e-02]
mat_Sqrt:  [[ 1.93402758e+01  0.00000000e+00]
 [-7.82535201e-03  1.79301340e-02]]
grads:  [ 0.00309987 -2.14960147]
Stock Position:  0.00309986819324508
Bond Position:  [-6.63402514]


portfolio before change:  [-6.32401646]
curr_Stock_Price:  101.07736979176937
curr_Factors:  [1.01077370e+02 4.09208541e-02]
mat_Sqrt:  [[ 2.04468437e+01  0.00000000e+00]
 [-8.09156144e-03  1.85400964e-02]]
grads:  [ 0.00909446 -7.09871174]
Stock Position:  0.009094459526623794
Bond Position:  [-7.24326051]


portfolio before change:  [-6.31872294]
curr_Stock_Price:  102.05775348984443
curr_Factors:  [1.02057753e+02 4.13087128e-02]
mat_Sqrt:  [[ 2.07427740e+01  0.00000000e+00]
 [-8.12981799e-03  1.86277532e-02]]
grads:  [-0.00123241  0.72190764]
Stock Position:  -0.0012324144786260175
Bond Position:  [-6.19294548]


portfolio before change:  [-6.3235037]
curr_Stock_Price:  103.42378404496142
curr_Factors:  [1.03423784e+02 4.25564980e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.3235037]
Stock Price:  100.89556567612861
PL:  [-7.21906938]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.12653022e-02 -3.86583789e-01]
 [-5.05995828e-01 -1.47425988e-01]
 [-4.98023038e-02 -1.22792076e-01]
 [-1.96090498e-01 -6.81932738e-03]
 [ 2.98186487e-03 -3.12172961e-03]
 [ 8.87751132e-02 -1.57575908e-01]
 [ 1.60766072e-01  5.00142127e-02]
 [ 9.07970841e-02 -1.34578706e-02]
 [ 2.84389826e-02 -6.40442040e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.37006146]
curr_Stock_Price:  102.30930055734915
curr_Factors:  [1.02309301e+02 3.76596253e-02]
mat_Sqrt:  [[ 1.98542329e+01  0.00000000e+00]
 [-7.76243521e-03  1.77859735e-02]]
grads:  [-1.20873116e-02 -2.17353180e+01]
Stock Position:  -0.012087311599163958
Bond Position:  [19.60670585]


portfolio before change:  [18.36856301]
curr_Stock_Price:  103.24451714576749
curr_Factors:  [1.03244517e+02 3.89019161e-02]
mat_Sqrt:  [[ 2.03635032e+01  0.00000000e+00]
 [-7.88942747e-03  1.80769493e-02]]
grads:  [-0.02800784 -8.15546838]
Stock Position:  -0.02800784310896767
Bond Position:  [21.26021924]


portfolio before change:  [18.42594481]
curr_Stock_Price:  101.57537625837755
curr_Factors:  [1.01575376e+02 4.09762306e-02]
mat_Sqrt:  [[ 2.05614833e+01  0.00000000e+00]
 [-8.09703458e-03  1.85526369e-02]]
grads:  [-5.02848737e-03 -6.61857807e+00]
Stock Position:  -0.005028487371567556
Bond Position:  [18.93671531]


portfolio before change:  [18.41955606]
curr_Stock_Price:  104.72930124283714
curr_Factors:  [1.04729301e+02 3.75816467e-02]
mat_Sqrt:  [[ 2.03028081e+01  0.00000000e+00]
 [-7.75439454e-03  1.77675500e-02]]
grads:  [-0.00980488 -0.38380798]
Stock Position:  -0.009804884900419222
Bond Position:  [19.44641481]


portfolio before change:  [18.45715086]
curr_Stock_Price:  101.88692677141174
curr_Factors:  [1.01886927e+02 3.97385465e-02]
mat_Sqrt:  [[ 2.03106794e+01  0.00000000e+00]
 [-7.97381178e-03  1.82702980e-02]]
grads:  [ 7.97329490e-05 -1.70863639e-01]
Stock Position:  7.97329490421872e-05
Bond Position:  [18.44902711]


portfolio before change:  [18.46653872]
curr_Stock_Price:  103.90677381365886
curr_Factors:  [1.03906774e+02 3.90375183e-02]
mat_Sqrt:  [[ 2.05298115e+01  0.00000000e+00]
 [-7.90316578e-03  1.81084277e-02]]
grads:  [ 9.74356182e-04 -8.70179955e+00]
Stock Position:  0.0009743561818420982
Bond Position:  [18.36529652]


portfolio before change:  [18.47571716]
curr_Stock_Price:  103.90009870368382
curr_Factors:  [1.03900099e+02 3.96513870e-02]
mat_Sqrt:  [[ 2.06892693e+01  0.00000000e+00]
 [-7.96506241e-03  1.82502507e-02]]
grads:  [0.00882554 2.74046716]
Stock Position:  0.008825544370110855
Bond Position:  [17.55874223]


portfolio before change:  [18.44219308]
curr_Stock_Price:  99.10655236201347
curr_Factors:  [9.91065524e+01 4.26371086e-02]
mat_Sqrt:  [[ 2.04642692e+01  0.00000000e+00]
 [-8.25950202e-03  1.89248966e-02]]
grads:  [ 0.00414985 -0.7111199 ]
Stock Position:  0.004149847070788289
Bond Position:  [18.03091604]


portfolio before change:  [18.44736681]
curr_Stock_Price:  98.18025809993466
curr_Factors:  [9.81802581e+01 4.23877047e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.44736681]
Stock Price:  99.9901498743071
PL:  [18.44736681]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.47692474e-02 -3.27289311e-01]
 [-8.17120381e-02  6.23492803e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [-2.86301687e-01 -4.07201682e-02]
 [-1.06976682e-01 -8.94792214e-03]
 [ 8.82096257e-02 -1.58229094e-01]
 [ 1.67481590e-01  3.11029189e-02]
 [-8.32961550e-02  2.98961594e-02]
 [ 2.83216712e-02 -2.42116177e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.12969891]
curr_Stock_Price:  100.96783701177519
curr_Factors:  [1.00967837e+02 4.18871440e-02]
mat_Sqrt:  [[ 2.06644299e+01  0.00000000e+00]
 [-8.18653959e-03  1.87577187e-02]]
grads:  [-1.00467332e-02 -1.74482471e+01]
Stock Position:  -0.010046733186619871
Bond Position:  [10.14409583]


portfolio before change:  [9.14229959]
curr_Stock_Price:  100.21860182411682
curr_Factors:  [1.00218602e+02 4.43628474e-02]
mat_Sqrt:  [[ 2.11085327e+01  0.00000000e+00]
 [-8.42499589e-03  1.93040907e-02]]
grads:  [-2.58192183e-03  3.22984808e+00]
Stock Position:  -0.0025819218252142954
Bond Position:  [9.40105618]


portfolio before change:  [9.13995074]
curr_Stock_Price:  102.94933839389627
curr_Factors:  [1.02949338e+02 4.46609194e-02]
mat_Sqrt:  [[ 2.17564178e+01  0.00000000e+00]
 [-8.45325210e-03  1.93688338e-02]]
grads:  [ -0.01646658 -16.01713149]
Stock Position:  -0.01646657930469172
Bond Position:  [10.83517419]


portfolio before change:  [9.10050951]
curr_Stock_Price:  105.67365505844354
curr_Factors:  [1.05673655e+02 4.39106623e-02]
mat_Sqrt:  [[ 2.21437782e+01  0.00000000e+00]
 [-8.38194845e-03  1.92054566e-02]]
grads:  [-0.01373178 -2.12023952]
Stock Position:  -0.013731777055918234
Bond Position:  [10.55159658]


portfolio before change:  [9.12132343]
curr_Stock_Price:  104.54220605755928
curr_Factors:  [1.04542206e+02 4.38804145e-02]
mat_Sqrt:  [[ 2.18991380e+01  0.00000000e+00]
 [-8.37906100e-03  1.91988406e-02]]
grads:  [-0.0050633  -0.46606575]
Stock Position:  -0.005063298633889374
Bond Position:  [9.65065184]


portfolio before change:  [9.13861711]
curr_Stock_Price:  102.07994915537792
curr_Factors:  [1.02079949e+02 4.53856613e-02]
mat_Sqrt:  [[ 2.17470213e+01  0.00000000e+00]
 [-8.52156430e-03  1.95253567e-02]]
grads:  [ 8.80708561e-04 -8.10377479e+00]
Stock Position:  0.0008807085609599894
Bond Position:  [9.04871442]


portfolio before change:  [9.14447964]
curr_Stock_Price:  103.59809178649144
curr_Factors:  [1.03598092e+02 4.64039003e-02]
mat_Sqrt:  [[ 2.23166498e+01  0.00000000e+00]
 [-8.61662582e-03  1.97431700e-02]]
grads:  [0.00811305 1.57537613]
Stock Position:  0.008113046437546415
Bond Position:  [8.30398351]


portfolio before change:  [9.1463221]
curr_Stock_Price:  103.31329502647873
curr_Factors:  [1.03313295e+02 4.60530600e-02]
mat_Sqrt:  [[ 2.21710090e+01  0.00000000e+00]
 [-8.58399068e-03  1.96683935e-02]]
grads:  [-0.00316848  1.52001023]
Stock Position:  -0.003168480119230058
Bond Position:  [9.47366822]


portfolio before change:  [9.14357086]
curr_Stock_Price:  105.67696963421844
curr_Factors:  [1.05676970e+02 4.77060864e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.14357086]
Stock Price:  105.5512985013848
PL:  [3.59227236]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.39358814e-02 -2.78276835e-01]
 [-3.39324956e-02  4.54515250e-02]
 [ 2.34660951e-01  1.54047337e-01]
 [ 2.27104777e-01  1.56336116e-01]
 [ 1.52518623e-01 -1.61526775e-01]
 [ 7.84760454e-02 -9.19141200e-02]
 [ 1.11526915e-01 -2.89793854e-01]
 [ 5.66651241e-02 -1.13310432e-01]
 [ 3.11374833e-02  8.53798131e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.43805984]
curr_Stock_Price:  97.40122882116981
curr_Factors:  [9.74012288e+01 4.06874417e-02]
mat_Sqrt:  [[ 1.96469268e+01  0.00000000e+00]
 [-8.06845132e-03  1.84871445e-02]]
grads:  [-1.90941243e-03 -1.50524509e+01]
Stock Position:  -0.0019094124309784449
Bond Position:  [-15.25208072]


portfolio before change:  [-15.44804845]
curr_Stock_Price:  98.63756010994355
curr_Factors:  [9.86375601e+01 4.11071784e-02]
mat_Sqrt:  [[ 1.99986719e+01  0.00000000e+00]
 [-8.10996211e-03  1.85822576e-02]]
grads:  [-7.04837998e-04  2.44596356e+00]
Stock Position:  -0.0007048379984802418
Bond Position:  [-15.37852495]


portfolio before change:  [-15.45587804]
curr_Stock_Price:  98.83391910877154
curr_Factors:  [9.88339191e+01 4.13497154e-02]
mat_Sqrt:  [[ 2.00975112e+01  0.00000000e+00]
 [-8.13385177e-03  1.86369957e-02]]
grads:  [0.0150214  8.26567432]
Stock Position:  0.015021398302451047
Bond Position:  [-16.9405017]


portfolio before change:  [-15.49827757]
curr_Stock_Price:  96.57533015571592
curr_Factors:  [9.65753302e+01 4.77492682e-02]
mat_Sqrt:  [[ 2.11032606e+01  0.00000000e+00]
 [-8.74064238e-03  2.00273277e-02]]
grads:  [0.01399478 7.80613963]
Stock Position:  0.013994778247502487
Bond Position:  [-16.8498279]


portfolio before change:  [-15.51959768]
curr_Stock_Price:  95.65405163016065
curr_Factors:  [9.56540516e+01 4.83556813e-02]
mat_Sqrt:  [[ 2.10342545e+01  0.00000000e+00]
 [-8.79597010e-03  2.01540994e-02]]
grads:  [ 3.89947544e-03 -8.01458662e+00]
Stock Position:  0.0038994754387356965
Bond Position:  [-15.89259831]


portfolio before change:  [-15.53133962]
curr_Stock_Price:  94.68118958686854
curr_Factors:  [9.46811896e+01 5.04689315e-02]
mat_Sqrt:  [[ 2.12704051e+01  0.00000000e+00]
 [-8.98611654e-03  2.05897796e-02]]
grads:  [ 1.80351218e-03 -4.46406526e+00]
Stock Position:  0.0018035121801091524
Bond Position:  [-15.7020983]


portfolio before change:  [-15.53873359]
curr_Stock_Price:  94.93571744195755
curr_Factors:  [9.49357174e+01 5.34758927e-02]
mat_Sqrt:  [[ 2.19537472e+01  0.00000000e+00]
 [-9.24994207e-03  2.11942799e-02]]
grads:  [-6.80953990e-04 -1.36732107e+01]
Stock Position:  -0.0006809539897377338
Bond Position:  [-15.47408673]


portfolio before change:  [-15.54429265]
curr_Stock_Price:  91.73445237333307
curr_Factors:  [9.17344524e+01 5.74342281e-02]
mat_Sqrt:  [[ 2.19845645e+01  0.00000000e+00]
 [-9.58617572e-03  2.19646879e-02]]
grads:  [ 3.28066405e-04 -5.15875449e+00]
Stock Position:  0.0003280664045463144
Bond Position:  [-15.57438764]


portfolio before change:  [-15.55247648]
curr_Stock_Price:  90.53137475844144
curr_Factors:  [9.05313748e+01 5.72856324e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.55247648]
Stock Price:  90.37495757262892
PL:  [-15.55247648]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.30884894e-02 -4.03225418e-01]
 [-2.54629558e-01  1.07515071e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [ 8.23454076e-02  1.24334399e-01]
 [ 8.46508565e-03 -3.21358239e-03]
 [ 8.82424384e-02 -1.58823714e-01]
 [ 2.24463924e-01 -1.72643662e-01]
 [ 5.28631239e-02 -1.23277078e-01]
 [ 1.69422551e-02 -5.20935815e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.96499746]
curr_Stock_Price:  102.68601868152022
curr_Factors:  [1.02686019e+02 4.02921045e-02]
mat_Sqrt:  [[ 2.06120550e+01  0.00000000e+00]
 [-8.02915732e-03  1.83971106e-02]]
grads:  [-1.20837292e-02 -2.19178667e+01]
Stock Position:  -0.012083729151372654
Bond Position:  [22.20582749]


portfolio before change:  [20.99251953]
curr_Stock_Price:  101.32746586601513
curr_Factors:  [1.01327466e+02 4.15717133e-02]
mat_Sqrt:  [[ 2.06598014e+01  0.00000000e+00]
 [-8.15565701e-03  1.86869578e-02]]
grads:  [-0.01209775  0.57534818]
Stock Position:  -0.012097754984928506
Bond Position:  [22.21835438]


portfolio before change:  [20.98477334]
curr_Stock_Price:  102.88627949507794
curr_Factors:  [1.02886279e+02 3.78555259e-02]
mat_Sqrt:  [[ 2.00180654e+01  0.00000000e+00]
 [-7.78259863e-03  1.78321737e-02]]
grads:  [ -0.01789652 -17.39738317]
Stock Position:  -0.01789652350278661
Bond Position:  [22.82608006]


portfolio before change:  [21.02310138]
curr_Stock_Price:  101.38251531864442
curr_Factors:  [1.01382515e+02 3.87839582e-02]
mat_Sqrt:  [[ 1.99659108e+01  0.00000000e+00]
 [-7.87745727e-03  1.80495221e-02]]
grads:  [6.84213153e-03 6.88851472e+00]
Stock Position:  0.0068421315345826355
Bond Position:  [20.32942888]


portfolio before change:  [21.0358115]
curr_Stock_Price:  101.75416326506048
curr_Factors:  [1.01754163e+02 3.77092456e-02]
mat_Sqrt:  [[ 1.97595072e+01  0.00000000e+00]
 [-7.76754743e-03  1.77976870e-02]]
grads:  [ 0.00035743 -0.1805618 ]
Stock Position:  0.00035742608495165773
Bond Position:  [20.99944191]


portfolio before change:  [21.04641362]
curr_Stock_Price:  102.03329832269841
curr_Factors:  [1.02033298e+02 3.95438343e-02]
mat_Sqrt:  [[ 2.02899658e+01  0.00000000e+00]
 [-7.95425263e-03  1.82254824e-02]]
grads:  [ 9.32780612e-04 -8.71437643e+00]
Stock Position:  0.0009327806118003365
Bond Position:  [20.95123894]


portfolio before change:  [21.05376967]
curr_Stock_Price:  98.68611374948361
curr_Factors:  [9.86861137e+01 4.03787283e-02]
mat_Sqrt:  [[ 1.98304407e+01  0.00000000e+00]
 [-8.03778360e-03  1.84168759e-02]]
grads:  [ 7.51955315e-03 -9.37421001e+00]
Stock Position:  0.007519553151144429
Bond Position:  [20.31169419]


portfolio before change:  [21.04796403]
curr_Stock_Price:  96.56311182267365
curr_Factors:  [9.65631118e+01 4.38957395e-02]
mat_Sqrt:  [[ 2.02312370e+01  0.00000000e+00]
 [-8.38052404e-03  1.92021929e-02]]
grads:  [-4.64333421e-05 -6.41994791e+00]
Stock Position:  -4.643334208858706e-05
Bond Position:  [21.05244778]


portfolio before change:  [21.05845793]
curr_Stock_Price:  97.31586534478213
curr_Factors:  [9.73158653e+01 4.16475938e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.05845793]
Stock Price:  98.76704217601892
PL:  [21.05845793]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-2.58476174e-02 -5.90807162e-02]
 [ 2.47919223e-01  1.58563021e-01]
 [ 1.59303223e-01  1.55635627e-01]
 [ 4.87894962e-02 -2.06373634e-02]
 [ 8.35614792e-02 -1.07702781e-01]
 [ 2.39200015e-01 -1.24130083e-01]
 [ 4.77325658e-02  3.29416266e-02]
 [ 4.47265061e-02 -6.40032155e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.35176482]
curr_Stock_Price:  98.72032571375001
curr_Factors:  [9.87203257e+01 3.96663304e-02]
mat_Sqrt:  [[ 1.96615428e+01  0.00000000e+00]
 [-7.96656316e-03  1.82536894e-02]]
grads:  [-6.75827673e-03 -1.04316256e+01]
Stock Position:  -0.006758276730314228
Bond Position:  [-5.68458554]


portfolio before change:  [-6.35077835]
curr_Stock_Price:  98.15368972326756
curr_Factors:  [9.81536897e+01 4.24621085e-02]
mat_Sqrt:  [[ 2.02258791e+01  0.00000000e+00]
 [-8.24253442e-03  1.88860189e-02]]
grads:  [-2.55279662e-03 -3.12827793e+00]
Stock Position:  -0.0025527966189872113
Bond Position:  [-6.10021194]


portfolio before change:  [-6.35216938]
curr_Stock_Price:  97.50348641144772
curr_Factors:  [9.75034864e+01 4.47324561e-02]
mat_Sqrt:  [[ 2.06220349e+01  0.00000000e+00]
 [-8.46001949e-03  1.93843398e-02]]
grads:  [0.01537781 8.17995465]
Stock Position:  0.015377813108140742
Bond Position:  [-7.85155977]


portfolio before change:  [-6.31439891]
curr_Stock_Price:  100.21500535051628
curr_Factors:  [1.00215005e+02 4.61965567e-02]
mat_Sqrt:  [[ 2.15395962e+01  0.00000000e+00]
 [-8.59735371e-03  1.96990121e-02]]
grads:  [0.01054932 7.90068183]
Stock Position:  0.010549324016291665
Bond Position:  [-7.37159947]


portfolio before change:  [-6.31891238]
curr_Stock_Price:  100.13663511617486
curr_Factors:  [1.00136635e+02 4.24452136e-02]
mat_Sqrt:  [[ 2.06303861e+01  0.00000000e+00]
 [-8.24089447e-03  1.88822614e-02]]
grads:  [ 0.00192835 -1.09294978]
Stock Position:  0.0019283503585782417
Bond Position:  [-6.5120109]


portfolio before change:  [-6.32151541]
curr_Stock_Price:  100.47567931810649
curr_Factors:  [1.00475679e+02 4.32565113e-02]
mat_Sqrt:  [[ 2.08971325e+01  0.00000000e+00]
 [-8.31927990e-03  1.90618649e-02]]
grads:  [ 1.74933723e-03 -5.65017019e+00]
Stock Position:  0.0017493372309198335
Bond Position:  [-6.49728125]


portfolio before change:  [-6.3235141]
curr_Stock_Price:  101.19066937960325
curr_Factors:  [1.01190669e+02 4.27781694e-02]
mat_Sqrt:  [[ 2.09291489e+01  0.00000000e+00]
 [-8.27315364e-03  1.89561764e-02]]
grads:  [ 0.00884055 -6.54826589]
Stock Position:  0.00884055089161227
Bond Position:  [-7.21809536]


portfolio before change:  [-6.33254451]
curr_Stock_Price:  100.5775333380843
curr_Factors:  [1.00577533e+02 4.47103961e-02]
mat_Sqrt:  [[ 2.12669514e+01  0.00000000e+00]
 [-8.45793319e-03  1.93795595e-02]]
grads:  [0.00292047 1.69981297]
Stock Position:  0.002920468905274917
Bond Position:  [-6.62627807]


portfolio before change:  [-6.33205136]
curr_Stock_Price:  101.88113250317299
curr_Factors:  [1.01881133e+02 4.54415551e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.33205136]
Stock Price:  100.8630684736975
PL:  [-7.19511983]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.72846425e-02 -4.41526927e-01]
 [-6.40956203e-01 -2.34893976e-01]
 [-2.47550954e-01 -2.82510207e-01]
 [ 5.03645196e-03  7.94189235e-02]
 [ 1.46787595e-02 -5.15731011e-03]
 [ 7.73171806e-02 -5.55818299e-02]
 [ 2.20487066e-01 -1.76998525e-01]
 [ 5.35543518e-02 -1.21465078e-01]
 [ 1.82943905e-02  4.43942298e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.93343073]
curr_Stock_Price:  103.55248205053759
curr_Factors:  [1.03552482e+02 3.65213506e-02]
mat_Sqrt:  [[ 1.97894593e+01  0.00000000e+00]
 [-7.64422403e-03  1.75151176e-02]]
grads:  [-1.36427574e-02 -2.52083336e+01]
Stock Position:  -0.013642757376858753
Bond Position:  [28.34617212]


portfolio before change:  [26.937229]
curr_Stock_Price:  104.31320534776442
curr_Factors:  [1.04313205e+02 3.90953654e-02]
mat_Sqrt:  [[ 2.06253786e+01  0.00000000e+00]
 [-7.90901920e-03  1.81218396e-02]]
grads:  [ -0.03604648 -12.9619278 ]
Stock Position:  -0.036046482019194644
Bond Position:  [30.69735308]


portfolio before change:  [26.96956634]
curr_Stock_Price:  103.84201305000008
curr_Factors:  [1.03842013e+02 3.76134808e-02]
mat_Sqrt:  [[ 2.01393227e+01  0.00000000e+00]
 [-7.75767809e-03  1.77750735e-02]]
grads:  [ -0.01841415 -15.8936168 ]
Stock Position:  -0.018414150357399402
Bond Position:  [28.88172878]


portfolio before change:  [27.00968186]
curr_Stock_Price:  102.44791945579412
curr_Factors:  [1.02447919e+02 3.58773559e-02]
mat_Sqrt:  [[ 1.94049871e+01  0.00000000e+00]
 [-7.57652754e-03  1.73600055e-02]]
grads:  [2.04574791e-03 4.57482134e+00]
Stock Position:  0.0020457479137777146
Bond Position:  [26.80009925]


portfolio before change:  [27.02129318]
curr_Stock_Price:  101.57191499134707
curr_Factors:  [1.01571915e+02 3.50396867e-02]
mat_Sqrt:  [[ 1.90131357e+01  0.00000000e+00]
 [-7.48755626e-03  1.71561467e-02]]
grads:  [ 0.00065365 -0.30061005]
Stock Position:  0.0006536494025095659
Bond Position:  [26.95490076]


portfolio before change:  [27.03212699]
curr_Stock_Price:  97.52232839122544
curr_Factors:  [9.75223284e+01 3.83265430e-02]
mat_Sqrt:  [[ 1.90921082e+01  0.00000000e+00]
 [-7.83086642e-03  1.79427691e-02]]
grads:  [ 2.77912114e-03 -3.09772866e+00]
Stock Position:  0.0027791211359517484
Bond Position:  [26.76110062]


portfolio before change:  [27.04843612]
curr_Stock_Price:  98.57490354490245
curr_Factors:  [9.85749035e+01 3.71500309e-02]
mat_Sqrt:  [[ 1.89996653e+01  0.00000000e+00]
 [-7.70973732e-03  1.76652274e-02]]
grads:  [ 7.53900525e-03 -1.00196007e+01]
Stock Position:  0.007539005254891487
Bond Position:  [26.3052794]


portfolio before change:  [27.03233553]
curr_Stock_Price:  94.69421747050724
curr_Factors:  [9.46942175e+01 3.69889097e-02]
mat_Sqrt:  [[ 1.82120664e+01  0.00000000e+00]
 [-7.69300042e-03  1.76268784e-02]]
grads:  [ 2.97959369e-05 -6.89090125e+00]
Stock Position:  2.979593691264741e-05
Bond Position:  [27.02951403]


portfolio before change:  [27.0457871]
curr_Stock_Price:  92.46005070671531
curr_Factors:  [9.24600507e+01 4.04414357e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.0457871]
Stock Price:  92.4599463637442
PL:  [27.0457871]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.30301350e-02 -3.11415098e-01]
 [-2.79630403e-01 -2.75685284e-03]
 [ 1.95138588e-02 -4.77134900e-02]
 [ 2.15539582e-01  1.63097446e-01]
 [-6.56248906e-03 -3.12859965e-02]
 [ 7.68292642e-02 -4.02848592e-02]
 [ 2.61861377e-01 -1.30391624e-01]
 [ 1.02777672e-01  2.75106940e-02]
 [ 5.13965413e-02 -8.30221471e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.65260289]
curr_Stock_Price:  100.60822622920136
curr_Factors:  [1.00608226e+02 3.48233421e-02]
mat_Sqrt:  [[ 1.87745146e+01  0.00000000e+00]
 [-7.46440536e-03  1.71031013e-02]]
grads:  [-1.05964298e-02 -1.82081070e+01]
Stock Position:  -0.010596429820465443
Bond Position:  [7.7186909]


portfolio before change:  [6.64718089]
curr_Stock_Price:  101.48421119583658
curr_Factors:  [1.01484211e+02 3.71130536e-02]
mat_Sqrt:  [[ 1.95506781e+01  0.00000000e+00]
 [-7.70589942e-03  1.76564337e-02]]
grads:  [-0.01436439 -0.15613871]
Stock Position:  -0.014364391409580351
Bond Position:  [8.10493982]


portfolio before change:  [6.6547179]
curr_Stock_Price:  101.24169969944165
curr_Factors:  [1.01241700e+02 3.86444268e-02]
mat_Sqrt:  [[ 1.99022814e+01  0.00000000e+00]
 [-7.86327431e-03  1.80170249e-02]]
grads:  [-6.58223756e-05 -2.64824467e+00]
Stock Position:  -6.58223756328471e-05
Bond Position:  [6.66138187]


portfolio before change:  [6.65824945]
curr_Stock_Price:  98.20281818588961
curr_Factors:  [9.82028182e+01 4.01692743e-02]
mat_Sqrt:  [[ 1.96820778e+01  0.00000000e+00]
 [-8.01690956e-03  1.83690474e-02]]
grads:  [0.01456763 8.8789278 ]
Stock Position:  0.014567625746258122
Bond Position:  [5.22766755]


portfolio before change:  [6.6671626]
curr_Stock_Price:  98.63519202130996
curr_Factors:  [9.86351920e+01 3.93653972e-02]
mat_Sqrt:  [[ 1.95699273e+01  0.00000000e+00]
 [-7.93628600e-03  1.81843157e-02]]
grads:  [-1.03305531e-03 -1.72049347e+00]
Stock Position:  -0.0010330553092543074
Bond Position:  [6.76905821]


portfolio before change:  [6.6704571]
curr_Stock_Price:  98.72315556534996
curr_Factors:  [9.87231556e+01 3.86346688e-02]
mat_Sqrt:  [[ 1.94047309e+01  0.00000000e+00]
 [-7.86228148e-03  1.80147500e-02]]
grads:  [ 0.00305325 -2.23621528]
Stock Position:  0.0030532508003093006
Bond Position:  [6.36903055]


portfolio before change:  [6.67675427]
curr_Stock_Price:  99.74235019083306
curr_Factors:  [9.97423502e+01 3.68206581e-02]
mat_Sqrt:  [[ 1.91392701e+01  0.00000000e+00]
 [-7.67548389e-03  1.75867430e-02]]
grads:  [ 0.01070855 -7.41419966]
Stock Position:  0.010708548798812733
Bond Position:  [5.60865844]


portfolio before change:  [6.6761119]
curr_Stock_Price:  99.42042030725554
curr_Factors:  [9.94204203e+01 3.66960709e-02]
mat_Sqrt:  [[ 1.90451930e+01  0.00000000e+00]
 [-7.66248742e-03  1.75569643e-02]]
grads:  [0.00602694 1.56693911]
Stock Position:  0.0060269446077431685
Bond Position:  [6.07691053]


portfolio before change:  [6.68025163]
curr_Stock_Price:  99.60301952636247
curr_Factors:  [9.96030195e+01 3.60804029e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.68025163]
Stock Price:  99.14350655244158
PL:  [6.68025163]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 9.38906287e-02 -2.84818133e-01]
 [ 6.11927694e-02 -1.05695042e+00]
 [ 2.90182298e-01  1.72957558e-01]
 [ 2.01842373e-01  1.45872657e-01]
 [ 3.24315286e-01 -2.45426562e-01]
 [ 7.91973211e-02 -1.14527285e-01]
 [-9.01677721e-04 -3.82146296e-01]
 [ 5.67329376e-02 -1.13132665e-01]
 [ 3.96929737e-02  1.12682086e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.0107909]
curr_Stock_Price:  96.15668823711243
curr_Factors:  [9.61566882e+01 3.90975231e-02]
mat_Sqrt:  [[ 1.90131520e+01  0.00000000e+00]
 [-7.90923744e-03  1.81223396e-02]]
grads:  [-1.59963986e-03 -1.57164108e+01]
Stock Position:  -0.0015996398550810916
Bond Position:  [-23.85697483]


portfolio before change:  [-24.01905749]
curr_Stock_Price:  93.86562479562627
curr_Factors:  [9.38656248e+01 3.61598455e-02]
mat_Sqrt:  [[ 1.78492453e+01  0.00000000e+00]
 [-7.60629691e-03  1.74282157e-02]]
grads:  [-2.24154135e-02 -6.06459344e+01]
Stock Position:  -0.022415413485953554
Bond Position:  [-21.9150207]


portfolio before change:  [-24.01604526]
curr_Stock_Price:  93.24228226848274
curr_Factors:  [9.32422823e+01 3.87933903e-02]
mat_Sqrt:  [[ 1.83650351e+01  0.00000000e+00]
 [-7.87841510e-03  1.80517168e-02]]
grads:  [0.01991105 9.58122489]
Stock Position:  0.019911051786952405
Bond Position:  [-25.87259717]


portfolio before change:  [-24.00212807]
curr_Stock_Price:  94.5911172503499
curr_Factors:  [9.45911173e+01 3.85684126e-02]
mat_Sqrt:  [[ 1.85766003e+01  0.00000000e+00]
 [-7.85553691e-03  1.79992962e-02]]
grads:  [0.01429252 8.10435337]
Stock Position:  0.01429251936394893
Bond Position:  [-25.35407345]


portfolio before change:  [-24.03114352]
curr_Stock_Price:  93.44819453623676
curr_Factors:  [9.34481945e+01 4.01793869e-02]
mat_Sqrt:  [[ 1.87315005e+01  0.00000000e+00]
 [-8.01791862e-03  1.83713595e-02]]
grads:  [ 1.15955662e-02 -1.33591943e+01]
Stock Position:  0.0115955661711485
Bond Position:  [-25.11472825]


portfolio before change:  [-24.05008864]
curr_Stock_Price:  92.89758676621462
curr_Factors:  [9.28975868e+01 4.01102934e-02]
mat_Sqrt:  [[ 1.86051147e+01  0.00000000e+00]
 [-8.01102175e-03  1.83555568e-02]]
grads:  [ 1.57018737e-03 -6.23937951e+00]
Stock Position:  0.0015701873688629602
Bond Position:  [-24.19595525]


portfolio before change:  [-24.06676981]
curr_Stock_Price:  89.98062688588075
curr_Factors:  [8.99806269e+01 3.74672552e-02]
mat_Sqrt:  [[ 1.74170643e+01  0.00000000e+00]
 [-7.74258409e-03  1.77404888e-02]]
grads:  [-9.62756939e-03 -2.15409113e+01]
Stock Position:  -0.009627569394754634
Bond Position:  [-23.20047508]


portfolio before change:  [-24.07344518]
curr_Stock_Price:  89.46878699867392
curr_Factors:  [8.94687870e+01 3.70721477e-02]
mat_Sqrt:  [[ 1.72264355e+01  0.00000000e+00]
 [-7.70165153e-03  1.76467006e-02]]
grads:  [ 4.27122307e-04 -6.41098114e+00]
Stock Position:  0.0004271223065285616
Bond Position:  [-24.11165929]


portfolio before change:  [-24.08559731]
curr_Stock_Price:  89.25037514196086
curr_Factors:  [8.92503751e+01 3.93191301e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.08559731]
Stock Price:  91.43039724775724
PL:  [-24.08559731]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.17055438e-02 -2.76811273e-01]
 [-2.82834102e-02 -3.11557044e-02]
 [ 2.36932574e-01  1.54821037e-01]
 [ 2.25619355e-01  1.54815924e-01]
 [ 2.52396030e-01 -2.19515178e-01]
 [ 7.99383041e-02 -1.37758306e-01]
 [ 2.57416104e-02 -3.60183144e-01]
 [ 5.52973215e-02 -1.16896020e-01]
 [ 3.03976060e-03 -4.28687491e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.62454292]
curr_Stock_Price:  97.66450494569857
curr_Factors:  [9.76645049e+01 4.16403163e-02]
mat_Sqrt:  [[ 1.99293789e+01  0.00000000e+00]
 [-8.16238361e-03  1.87023704e-02]]
grads:  [-1.96216853e-03 -1.48008657e+01]
Stock Position:  -0.001962168530093528
Bond Position:  [-13.4329087]


portfolio before change:  [-13.63244835]
curr_Stock_Price:  98.26960242494972
curr_Factors:  [9.82696024e+01 4.40094492e-02]
mat_Sqrt:  [[ 2.06154190e+01  0.00000000e+00]
 [-8.39137168e-03  1.92270480e-02]]
grads:  [-0.00203153 -1.62041019]
Stock Position:  -0.0020315315644163293
Bond Position:  [-13.43281055]


portfolio before change:  [-13.63985195]
curr_Stock_Price:  98.60703904041415
curr_Factors:  [9.86070390e+01 4.28154808e-02]
mat_Sqrt:  [[ 2.04036719e+01  0.00000000e+00]
 [-8.27676080e-03  1.89644414e-02]]
grads:  [0.01492388 8.16375415]
Stock Position:  0.014923883114104128
Bond Position:  [-15.11145188]


portfolio before change:  [-13.68319893]
curr_Stock_Price:  96.20891202690542
curr_Factors:  [9.62089120e+01 4.20699357e-02]
mat_Sqrt:  [[ 1.97333686e+01  0.00000000e+00]
 [-8.20438280e-03  1.87986026e-02]]
grads:  [0.0148574 8.2355017]
Stock Position:  0.014857400663957816
Bond Position:  [-15.11261329]


portfolio before change:  [-13.71967206]
curr_Stock_Price:  94.26274818428563
curr_Factors:  [9.42627482e+01 4.18074510e-02]
mat_Sqrt:  [[ 1.92737820e+01  0.00000000e+00]
 [-8.17874817e-03  1.87398663e-02]]
grads:  [ 8.1245991e-03 -1.1713807e+01]
Stock Position:  0.008124599097145472
Bond Position:  [-14.4855191]


portfolio before change:  [-13.7528053]
curr_Stock_Price:  91.07629425803798
curr_Factors:  [9.10762943e+01 4.24154406e-02]
mat_Sqrt:  [[ 1.87571712e+01  0.00000000e+00]
 [-8.23800370e-03  1.88756378e-02]]
grads:  [ 1.05643063e-03 -7.29820671e+00]
Stock Position:  0.001056430631352753
Bond Position:  [-13.84902108]


portfolio before change:  [-13.75964939]
curr_Stock_Price:  91.15404987227832
curr_Factors:  [9.11540499e+01 3.98593643e-02]
mat_Sqrt:  [[ 1.81987330e+01  0.00000000e+00]
 [-7.98592404e-03  1.82980507e-02]]
grads:  [-7.22331612e-03 -1.96842358e+01]
Stock Position:  -0.007223316123820325
Bond Position:  [-13.10121488]


portfolio before change:  [-13.77254942]
curr_Stock_Price:  92.03283958729796
curr_Factors:  [9.20328396e+01 3.89627539e-02]
mat_Sqrt:  [[ 1.81663486e+01  0.00000000e+00]
 [-7.89559411e-03  1.80910788e-02]]
grads:  [ 2.35584817e-04 -6.46152841e+00]
Stock Position:  0.00023558481691281813
Bond Position:  [-13.79423096]


portfolio before change:  [-13.77880851]
curr_Stock_Price:  94.74842294556424
curr_Factors:  [9.47484229e+01 3.92621406e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.77880851]
Stock Price:  93.76460109425774
PL:  [-13.77880851]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.38057855e-02 -3.18495055e-01]
 [-2.25925210e-02 -9.63985888e-02]
 [ 2.74452467e-01  1.67600077e-01]
 [ 1.76987302e-01  1.36523888e-01]
 [ 6.32294324e-01 -3.57056532e-01]
 [ 8.10481809e-02 -1.72554742e-01]
 [-2.59718524e-02 -4.03320230e-01]
 [ 5.73536055e-02 -1.11505632e-01]
 [ 1.68788066e-02  3.98768232e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.75840383]
curr_Stock_Price:  100.76876015296945
curr_Factors:  [1.00768760e+02 4.04884574e-02]
mat_Sqrt:  [[ 2.02764318e+01  0.00000000e+00]
 [-8.04869752e-03  1.84418828e-02]]
grads:  [-1.00021752e-02 -1.72702027e+01]
Stock Position:  -0.010002175216556752
Bond Position:  [8.76631063]


portfolio before change:  [7.7905682]
curr_Stock_Price:  97.99135318610924
curr_Factors:  [9.79913532e+01 4.28883787e-02]
mat_Sqrt:  [[ 2.02935287e+01  0.00000000e+00]
 [-8.28380383e-03  1.89805791e-02]]
grads:  [-3.18645000e-03 -5.07880126e+00]
Stock Position:  -0.003186449995570316
Bond Position:  [8.10281274]


portfolio before change:  [7.80470174]
curr_Stock_Price:  94.82760489130047
curr_Factors:  [9.48276049e+01 4.04672934e-02]
mat_Sqrt:  [[ 1.90759801e+01  0.00000000e+00]
 [-8.04659365e-03  1.84370622e-02]]
grads:  [0.01822182 9.09038947]
Stock Position:  0.018221823222894694
Bond Position:  [6.07676989]


portfolio before change:  [7.77551979]
curr_Stock_Price:  93.05933525450361
curr_Factors:  [9.30593353e+01 4.29587922e-02]
mat_Sqrt:  [[ 1.92879458e+01  0.00000000e+00]
 [-8.29060115e-03  1.89961537e-02]]
grads:  [0.01226524 7.18692269]
Stock Position:  0.012265236216059216
Bond Position:  [6.63412506]


portfolio before change:  [7.73720969]
curr_Stock_Price:  89.66535338046037
curr_Factors:  [8.96653534e+01 4.70568256e-02]
mat_Sqrt:  [[ 1.94507332e+01  0.00000000e+00]
 [-8.67703411e-03  1.98815828e-02]]
grads:  [  0.02449584 -17.95916027]
Stock Position:  0.02449584144430764
Bond Position:  [5.54078141]


portfolio before change:  [7.7077359]
curr_Stock_Price:  88.34901277413555
curr_Factors:  [8.83490128e+01 4.67237621e-02]
mat_Sqrt:  [[ 1.90972399e+01  0.00000000e+00]
 [-8.64627199e-03  1.98110979e-02]]
grads:  [ 3.00520773e-04 -8.71000400e+00]
Stock Position:  0.00030052077279554693
Bond Position:  [7.68118519]


portfolio before change:  [7.71173761]
curr_Stock_Price:  88.88193971629796
curr_Factors:  [8.88819397e+01 4.43954974e-02]
mat_Sqrt:  [[ 1.87276372e+01  0.00000000e+00]
 [-8.42809563e-03  1.93111931e-02]]
grads:  [-1.07859432e-02 -2.08853088e+01]
Stock Position:  -0.010785943247459968
Bond Position:  [8.67041317]


portfolio before change:  [7.70945985]
curr_Stock_Price:  89.49515009753806
curr_Factors:  [8.94951501e+01 4.69831158e-02]
mat_Sqrt:  [[ 1.93986009e+01  0.00000000e+00]
 [-8.67023559e-03  1.98660055e-02]]
grads:  [ 4.47896105e-04 -5.61288643e+00]
Stock Position:  0.0004478961048737148
Bond Position:  [7.66937532]


portfolio before change:  [7.71471839]
curr_Stock_Price:  92.67197702903763
curr_Factors:  [9.26719770e+01 4.36197093e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.71471839]
Stock Price:  91.48850443935443
PL:  [7.71471839]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-1.46945425e-02 -2.13466447e-01]
 [ 6.33359784e-04  8.22631814e-02]
 [ 1.41888708e-01  8.48346823e-02]
 [ 7.48661698e-02  1.21090469e-01]
 [ 1.70364853e-03 -2.46883760e-03]
 [ 8.84280806e-02 -1.62187865e-01]
 [ 2.51691417e-01 -1.37479093e-01]
 [ 5.29920898e-02 -1.22939004e-01]
 [-4.20014896e-04 -1.53275682e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.8111938]
curr_Stock_Price:  98.36327973280066
curr_Factors:  [9.83632797e+01 3.97980241e-02]
mat_Sqrt:  [[ 1.96229256e+01  0.00000000e+00]
 [-7.97977685e-03  1.82839657e-02]]
grads:  [-5.49657785e-03 -1.16750627e+01]
Stock Position:  -0.005496577847143696
Bond Position:  [-8.27053237]


portfolio before change:  [-8.82017066]
curr_Stock_Price:  99.24392992698094
curr_Factors:  [9.92439299e+01 4.28126062e-02]
mat_Sqrt:  [[ 2.05347673e+01  0.00000000e+00]
 [-8.27648294e-03  1.89638048e-02]]
grads:  [1.77922423e-03 4.33790488e+00]
Stock Position:  0.0017792242284148838
Bond Position:  [-8.99674787]


portfolio before change:  [-8.82217739]
curr_Stock_Price:  100.64497228678584
curr_Factors:  [1.00644972e+02 4.64771488e-02]
mat_Sqrt:  [[ 2.16976062e+01  0.00000000e+00]
 [-8.62342380e-03  1.97587462e-02]]
grads:  [0.00824578 4.29352559]
Stock Position:  0.008245775920424112
Bond Position:  [-9.65207328]


portfolio before change:  [-8.8204206]
curr_Stock_Price:  101.44344557828853
curr_Factors:  [1.01443446e+02 4.90250999e-02]
mat_Sqrt:  [[ 2.24612145e+01  0.00000000e+00]
 [-8.85664496e-03  2.02931230e-02]]
grads:  [5.68599632e-03 5.96706920e+00]
Stock Position:  0.005685996322385475
Bond Position:  [-9.39722766]


portfolio before change:  [-8.82236892]
curr_Stock_Price:  101.92734940116529
curr_Factors:  [1.01927349e+02 4.97980930e-02]
mat_Sqrt:  [[ 2.27455837e+01  0.00000000e+00]
 [-8.92619453e-03  2.04524811e-02]]
grads:  [ 2.75288368e-05 -1.20710910e-01]
Stock Position:  2.7528836842271712e-05
Bond Position:  [-8.82517486]


portfolio before change:  [-8.82678828]
curr_Stock_Price:  101.72129714243694
curr_Factors:  [1.01721297e+02 4.99838897e-02]
mat_Sqrt:  [[ 2.27419088e+01  0.00000000e+00]
 [-8.94283084e-03  2.04905996e-02]]
grads:  [ 7.75814074e-04 -7.91523276e+00]
Stock Position:  0.0007758140737246744
Bond Position:  [-8.90570509]


portfolio before change:  [-8.83195336]
curr_Stock_Price:  100.80469043924118
curr_Factors:  [1.00804690e+02 5.47569908e-02]
mat_Sqrt:  [[ 2.35885110e+01  0.00000000e+00]
 [-9.36008468e-03  2.14466483e-02]]
grads:  [ 0.00812644 -6.41028337]
Stock Position:  0.008126440133528956
Bond Position:  [-9.65113664]


portfolio before change:  [-8.86472519]
curr_Stock_Price:  97.36590887035764
curr_Factors:  [9.73659089e+01 5.34922890e-02]
mat_Sqrt:  [[ 2.25191769e+01  0.00000000e+00]
 [-9.25136003e-03  2.11975288e-02]]
grads:  [-2.94367057e-05 -5.79968567e+00]
Stock Position:  -2.9436705674053975e-05
Bond Position:  [-8.86185906]


portfolio before change:  [-8.86909539]
curr_Stock_Price:  95.2653469849959
curr_Factors:  [9.52653470e+01 5.50013844e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.86909539]
Stock Price:  97.36798766297429
PL:  [-8.86909539]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-2.73213979e-02 -2.05169297e-01]
 [ 1.25804025e-02 -4.99636628e-01]
 [ 2.65364690e-01  1.64504837e-01]
 [ 1.94430778e-01  1.63086836e-01]
 [ 3.22475990e-02 -2.38196990e-02]
 [ 8.86199853e-02 -1.66205495e-01]
 [ 1.72860126e-01  1.52273582e-02]
 [-1.85542099e-01 -1.49184489e-01]
 [ 2.83159847e-02 -2.38550221e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.32902898]
curr_Stock_Price:  98.43327769313726
curr_Factors:  [9.84332777e+01 4.36188261e-02]
mat_Sqrt:  [[ 2.05579087e+01  0.00000000e+00]
 [-8.35404823e-03  1.91415292e-02]]
grads:  [-5.68465508e-03 -1.07185427e+01]
Stock Position:  -0.005684655082197489
Bond Position:  [-7.76946974]


portfolio before change:  [-8.32048461]
curr_Stock_Price:  96.24667628890397
curr_Factors:  [9.62466763e+01 4.43247640e-02]
mat_Sqrt:  [[ 2.02632432e+01  0.00000000e+00]
 [-8.42137889e-03  1.92958031e-02]]
grads:  [-1.01404744e-02 -2.58935389e+01]
Stock Position:  -0.010140474421159755
Bond Position:  [-7.34449765]


portfolio before change:  [-8.31907277]
curr_Stock_Price:  95.74521989267953
curr_Factors:  [9.57452199e+01 4.28474340e-02]
mat_Sqrt:  [[ 1.98188983e+01  0.00000000e+00]
 [-8.27984869e-03  1.89715167e-02]]
grads:  [0.01701207 8.67114842]
Stock Position:  0.01701207003036304
Bond Position:  [-9.94789716]


portfolio before change:  [-8.26204093]
curr_Stock_Price:  99.39010457475199
curr_Factors:  [9.93901046e+01 3.98112604e-02]
mat_Sqrt:  [[ 1.98310683e+01  0.00000000e+00]
 [-7.98110372e-03  1.82870060e-02]]
grads:  [0.01339351 8.91818138]
Stock Position:  0.013393514864123865
Bond Position:  [-9.59322377]


portfolio before change:  [-8.26528622]
curr_Stock_Price:  99.506020400082
curr_Factors:  [9.95060204e+01 3.74821273e-02]
mat_Sqrt:  [[ 1.92646655e+01  0.00000000e+00]
 [-7.74412058e-03  1.77440094e-02]]
grads:  [ 1.13429585e-03 -1.34240793e+00]
Stock Position:  0.001134295848340321
Bond Position:  [-8.37815548]


portfolio before change:  [-8.26746257]
curr_Stock_Price:  101.28137056683873
curr_Factors:  [1.01281371e+02 3.46612417e-02]
mat_Sqrt:  [[ 1.88560894e+01  0.00000000e+00]
 [-7.44701194e-03  1.70632480e-02]]
grads:  [ 8.52878874e-04 -9.74055442e+00]
Stock Position:  0.0008528788740283834
Bond Position:  [-8.35384331]


portfolio before change:  [-8.26987316]
curr_Stock_Price:  103.35361561984666
curr_Factors:  [1.03353616e+02 3.23835323e-02]
mat_Sqrt:  [[ 1.85989225e+01  0.00000000e+00]
 [-7.19817003e-03  1.64930795e-02]]
grads:  [0.00965141 0.92325743]
Stock Position:  0.00965141342940702
Bond Position:  [-9.26738164]


portfolio before change:  [-8.26598694]
curr_Stock_Price:  104.23649881071218
curr_Factors:  [1.04236499e+02 3.27774582e-02]
mat_Sqrt:  [[ 1.88715448e+01  0.00000000e+00]
 [-7.24181836e-03  1.65930904e-02]]
grads:  [-0.01328198 -8.99075975]
Stock Position:  -0.013281983580451212
Bond Position:  [-6.88151948]


portfolio before change:  [-8.28877413]
curr_Stock_Price:  105.69302541602889
curr_Factors:  [1.05693025e+02 3.19255540e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.28877413]
Stock Price:  104.26389769163339
PL:  [-12.55267182]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-1.70555923e-02 -2.11914993e-01]
 [-1.23289638e-02 -2.14064573e-01]
 [ 2.55639307e-01  1.61192433e-01]
 [ 1.99903195e-01  1.64247638e-01]
 [ 8.17649809e-03 -4.66450727e-02]
 [ 7.77127064e-02 -6.79822047e-02]
 [ 7.67907291e-02 -3.18146112e-01]
 [ 5.48108348e-02 -1.18171306e-01]
 [ 2.95104514e-02  8.01874782e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.72219198]
curr_Stock_Price:  98.3762005130082
curr_Factors:  [9.83762005e+01 3.96628813e-02]
mat_Sqrt:  [[ 1.95921535e+01  0.00000000e+00]
 [-7.96621679e-03  1.82528957e-02]]
grads:  [-5.59116065e-03 -1.16099383e+01]
Stock Position:  -0.005591160645907417
Bond Position:  [-8.17215484]


portfolio before change:  [-8.72137431]
curr_Stock_Price:  97.49896450882937
curr_Factors:  [9.74989645e+01 3.77014859e-02]
mat_Sqrt:  [[ 1.89312477e+01  0.00000000e+00]
 [-7.76674819e-03  1.77958557e-02]]
grads:  [-5.58623525e-03 -1.20289002e+01]
Stock Position:  -0.005586235252266261
Bond Position:  [-8.17672216]


portfolio before change:  [-8.72111826]
curr_Stock_Price:  96.72108161853161
curr_Factors:  [9.67210816e+01 4.03206993e-02]
mat_Sqrt:  [[ 1.94216075e+01  0.00000000e+00]
 [-8.03200590e-03  1.84036375e-02]]
grads:  [0.01678489 8.75872679]
Stock Position:  0.016784885219315697
Bond Position:  [-10.34457051]


portfolio before change:  [-8.68364906]
curr_Stock_Price:  99.26162767349123
curr_Factors:  [9.92616277e+01 3.87988904e-02]
mat_Sqrt:  [[ 1.95519935e+01  0.00000000e+00]
 [-7.87897358e-03  1.80529964e-02]]
grads:  [0.01389049 9.09808178]
Stock Position:  0.013890488469192502
Bond Position:  [-10.06244156]


portfolio before change:  [-8.70307755]
curr_Stock_Price:  98.22523438412479
curr_Factors:  [9.82252344e+01 4.04689081e-02]
mat_Sqrt:  [[ 1.97598579e+01  0.00000000e+00]
 [-8.04675419e-03  1.84374301e-02]]
grads:  [-6.16455881e-04 -2.52991184e+00]
Stock Position:  -0.0006164558805252753
Bond Position:  [-8.64252603]


portfolio before change:  [-8.70636798]
curr_Stock_Price:  96.55128996806842
curr_Factors:  [9.65512900e+01 4.08940902e-02]
mat_Sqrt:  [[ 1.95248792e+01  0.00000000e+00]
 [-8.08891490e-03  1.85340324e-02]]
grads:  [ 2.46059601e-03 -3.66796622e+00]
Stock Position:  0.0024605960075365038
Bond Position:  [-8.9439417]


portfolio before change:  [-8.71858815]
curr_Stock_Price:  93.40283554746385
curr_Factors:  [9.34028355e+01 4.52536711e-02]
mat_Sqrt:  [[ 1.98695014e+01  0.00000000e+00]
 [-8.50916410e-03  1.94969443e-02]]
grads:  [-3.12336059e-03 -1.63177422e+01]
Stock Position:  -0.003123360586064224
Bond Position:  [-8.42685741]


portfolio before change:  [-8.72394492]
curr_Stock_Price:  93.76855952166487
curr_Factors:  [9.37685595e+01 4.77978105e-02]
mat_Sqrt:  [[ 2.05003486e+01  0.00000000e+00]
 [-8.74508415e-03  2.00375050e-02]]
grads:  [ 1.57882607e-04 -5.89750601e+00]
Stock Position:  0.00015788260726122322
Bond Position:  [-8.73874934]


portfolio before change:  [-8.72878782]
curr_Stock_Price:  90.77619557868576
curr_Factors:  [9.07761956e+01 5.14179077e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.72878782]
Stock Price:  94.6000877386321
PL:  [-8.72878782]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.25402769e-02 -3.06943787e-01]
 [-1.29951533e-01  5.10743005e-02]
 [ 2.28764784e-01  1.52039140e-01]
 [ 1.61064639e-01  1.56009256e-01]
 [-3.34282085e-02 -3.81470219e-03]
 [ 8.82675987e-02 -1.59279661e-01]
 [ 1.79980288e-01 -5.06801103e-03]
 [ 9.66475840e-02  4.17839526e-03]
 [ 4.66735116e-02 -6.86256798e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.95653383]
curr_Stock_Price:  100.50717486249805
curr_Factors:  [1.00507175e+02 3.69731696e-02]
mat_Sqrt:  [[ 1.93259302e+01  0.00000000e+00]
 [-7.69136343e-03  1.76231276e-02]]
grads:  [-1.01677656e-02 -1.74171007e+01]
Stock Position:  -0.010167765575932346
Bond Position:  [6.97846722]


portfolio before change:  [5.95969409]
curr_Stock_Price:  100.5396149659779
curr_Factors:  [1.00539615e+02 3.73025240e-02]
mat_Sqrt:  [[ 1.94180818e+01  0.00000000e+00]
 [-7.72554453e-03  1.77014463e-02]]
grads:  [-0.00554436  2.88531794]
Stock Position:  -0.00554436228340967
Bond Position:  [6.51712214]


portfolio before change:  [5.96915827]
curr_Stock_Price:  99.42049564240567
curr_Factors:  [9.94204956e+01 3.56363880e-02]
mat_Sqrt:  [[ 1.87682061e+01  0.00000000e+00]
 [-7.55104104e-03  1.73016086e-02]]
grads:  [0.01572447 8.78757251]
Stock Position:  0.01572447062727768
Bond Position:  [4.40582361]


portfolio before change:  [5.98349188]
curr_Stock_Price:  100.19191364827888
curr_Factors:  [1.00191914e+02 3.57901536e-02]
mat_Sqrt:  [[ 1.89545925e+01  0.00000000e+00]
 [-7.56731430e-03  1.73388953e-02]]
grads:  [0.01208956 8.99764681]
Stock Position:  0.012089558763895347
Bond Position:  [4.77221585]


portfolio before change:  [6.01679222]
curr_Stock_Price:  102.74896611854177
curr_Factors:  [1.02748966e+02 3.34343446e-02]
mat_Sqrt:  [[ 1.87877109e+01  0.00000000e+00]
 [-7.31402429e-03  1.67585350e-02]]
grads:  [-0.00186787 -0.22762743]
Stock Position:  -0.0018678742364489534
Bond Position:  [6.20871436]


portfolio before change:  [6.021303]
curr_Stock_Price:  101.99642743172583
curr_Factors:  [1.01996427e+02 3.60593510e-02]
mat_Sqrt:  [[ 1.93684075e+01  0.00000000e+00]
 [-7.59571995e-03  1.74039808e-02]]
grads:  [ 9.68187773e-04 -9.15190973e+00]
Stock Position:  0.0009681877729947101
Bond Position:  [5.9225513]


portfolio before change:  [6.02526817]
curr_Stock_Price:  103.03254089198785
curr_Factors:  [1.03032541e+02 3.30273303e-02]
mat_Sqrt:  [[ 1.87245395e+01  0.00000000e+00]
 [-7.26936919e-03  1.66562173e-02]]
grads:  [ 0.00949387 -0.30427143]
Stock Position:  0.00949387442195696
Bond Position:  [5.04709016]


portfolio before change:  [5.9919741]
curr_Stock_Price:  99.25976704150914
curr_Factors:  [9.92597670e+01 3.30082844e-02]
mat_Sqrt:  [[ 1.80336953e+01  0.00000000e+00]
 [-7.26727287e-03  1.66514140e-02]]
grads:  [0.0054604  0.25093336]
Stock Position:  0.0054603997393701245
Bond Position:  [5.44997609]


portfolio before change:  [6.00654901]
curr_Stock_Price:  101.42979787799624
curr_Factors:  [1.01429798e+02 3.22127599e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.00654901]
Stock Price:  102.37776811223182
PL:  [3.62878089]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-2.27356859e-02 -2.08182584e-01]
 [-8.96182010e-02  6.05013790e-02]
 [ 2.29221673e-01  1.52194753e-01]
 [ 2.26050408e-01  1.54978056e-01]
 [ 1.66746188e-02 -5.33753018e-02]
 [ 8.39263601e-02 -1.11944037e-01]
 [ 2.59855641e-01 -1.30113176e-01]
 [-4.66575752e-02  4.39990895e-02]
 [ 5.29606498e-02 -8.35522279e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.50450804]
curr_Stock_Price:  98.40780263601144
curr_Factors:  [9.84078026e+01 4.19589432e-02]
mat_Sqrt:  [[ 2.01577384e+01  0.00000000e+00]
 [-8.19355290e-03  1.87737882e-02]]
grads:  [-5.63525592e-03 -1.10890025e+01]
Stock Position:  -0.005635255915224234
Bond Position:  [-7.94995489]


portfolio before change:  [-8.5190003]
curr_Stock_Price:  100.27396314068885
curr_Factors:  [1.00273963e+02 4.08625225e-02]
mat_Sqrt:  [[ 2.02698608e+01  0.00000000e+00]
 [-8.08579223e-03  1.85268775e-02]]
grads:  [-3.11858256e-03  3.26560043e+00]
Stock Position:  -0.0031185825622735033
Bond Position:  [-8.20628767]


portfolio before change:  [-8.52030822]
curr_Stock_Price:  99.37732102178127
curr_Factors:  [9.93773210e+01 3.79639663e-02]
mat_Sqrt:  [[ 1.93630191e+01  0.00000000e+00]
 [-7.79373762e-03  1.78576963e-02]]
grads:  [0.01526853 8.52264203]
Stock Position:  0.015268533604987016
Bond Position:  [-10.03765418]


portfolio before change:  [-8.57309729]
curr_Stock_Price:  96.24873074776745
curr_Factors:  [9.62487307e+01 4.27857206e-02]
mat_Sqrt:  [[ 1.99087703e+01  0.00000000e+00]
 [-8.27388379e-03  1.89578494e-02]]
grads:  [0.01475171 8.17487539]
Stock Position:  0.014751708529858416
Bond Position:  [-9.99293051]


portfolio before change:  [-8.55116213]
curr_Stock_Price:  98.07447633874614
curr_Factors:  [9.80744763e+01 4.00992932e-02]
mat_Sqrt:  [[ 1.96392255e+01  0.00000000e+00]
 [-8.00992316e-03  1.83530396e-02]]
grads:  [-3.37094389e-04 -2.90825405e+00]
Stock Position:  -0.0003370943889240195
Bond Position:  [-8.51810178]


portfolio before change:  [-8.55625032]
curr_Stock_Price:  100.53096932308249
curr_Factors:  [1.00530969e+02 3.99663093e-02]
mat_Sqrt:  [[ 2.00977247e+01  0.00000000e+00]
 [-7.99663022e-03  1.83225816e-02]]
grads:  [ 1.74497250e-03 -6.10962142e+00]
Stock Position:  0.0017449724969575012
Bond Position:  [-8.7316741]


portfolio before change:  [-8.56071813]
curr_Stock_Price:  100.4731583084182
curr_Factors:  [1.00473158e+02 4.28086346e-02]
mat_Sqrt:  [[ 2.07881452e+01  0.00000000e+00]
 [-8.27609904e-03  1.89629252e-02]]
grads:  [ 0.00976853 -6.8614507 ]
Stock Position:  0.009768528788400416
Bond Position:  [-9.54219307]


portfolio before change:  [-8.54580432]
curr_Stock_Price:  102.4884156061928
curr_Factors:  [1.02488416e+02 4.42228240e-02]
mat_Sqrt:  [[ 2.15525179e+01  0.00000000e+00]
 [-8.41168939e-03  1.92736017e-02]]
grads:  [-1.27385572e-03  2.28286805e+00]
Stock Position:  -0.0012738557172435007
Bond Position:  [-8.41524886]


portfolio before change:  [-8.54685063]
curr_Stock_Price:  100.00589822328422
curr_Factors:  [1.00005898e+02 4.39893368e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.54685063]
Stock Price:  100.07619473594679
PL:  [-8.62304536]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.54714523e-02 -3.33698874e-01]
 [-2.96101827e-01 -1.11894260e-02]
 [ 2.22476116e-01  1.53759949e-01]
 [ 2.25569472e-01  1.57232695e-01]
 [ 1.17743083e-01 -1.33688455e-01]
 [ 7.74346967e-02 -5.92661510e-02]
 [ 1.38613452e-01 -2.66879821e-01]
 [ 5.48703314e-02 -1.18015341e-01]
 [ 1.78084668e-02  4.28436559e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.12825071]
curr_Stock_Price:  101.11280111168246
curr_Factors:  [1.01112801e+02 4.06690720e-02]
mat_Sqrt:  [[ 2.03909882e+01  0.00000000e+00]
 [-8.06662973e-03  1.84829707e-02]]
grads:  [-1.03530824e-02 -1.80543961e+01]
Stock Position:  -0.010353082391104142
Bond Position:  [11.17507987]


portfolio before change:  [10.12901815]
curr_Stock_Price:  101.57850761208081
curr_Factors:  [1.01578508e+02 4.23719686e-02]
mat_Sqrt:  [[ 2.09093797e+01  0.00000000e+00]
 [-8.23378101e-03  1.88659624e-02]]
grads:  [-0.01439475 -0.59310126]
Stock Position:  -0.01439474998846399
Bond Position:  [11.59121537]


portfolio before change:  [10.16085435]
curr_Stock_Price:  99.76957416452008
curr_Factors:  [9.97695742e+01 4.27293027e-02]
mat_Sqrt:  [[ 2.06234359e+01  0.00000000e+00]
 [-8.26842695e-03  1.89453462e-02]]
grads:  [0.01404143 8.11597464]
Stock Position:  0.014041426483638332
Bond Position:  [8.75994721]


portfolio before change:  [10.12350679]
curr_Stock_Price:  96.79775157991843
curr_Factors:  [9.67977516e+01 4.31580392e-02]
mat_Sqrt:  [[ 2.01092615e+01  0.00000000e+00]
 [-8.30980522e-03  1.90401557e-02]]
grads:  [0.01462965 8.25795218]
Stock Position:  0.014629649421358283
Bond Position:  [8.70738962]


portfolio before change:  [10.1202357]
curr_Stock_Price:  96.27649044813927
curr_Factors:  [9.62764904e+01 4.24493900e-02]
mat_Sqrt:  [[ 1.98360858e+01  0.00000000e+00]
 [-8.24129990e-03  1.88831903e-02]]
grads:  [ 2.99437391e-03 -7.07975998e+00]
Stock Position:  0.0029943739141234478
Bond Position:  [9.83194789]


portfolio before change:  [10.12803028]
curr_Stock_Price:  97.23741556612853
curr_Factors:  [9.72374156e+01 4.33051531e-02]
mat_Sqrt:  [[ 2.02349994e+01  0.00000000e+00]
 [-8.32395609e-03  1.90725794e-02]]
grads:  [ 2.54849663e-03 -3.10740093e+00]
Stock Position:  0.0025484966307244756
Bond Position:  [9.88022105]


portfolio before change:  [10.13012994]
curr_Stock_Price:  96.12237196333201
curr_Factors:  [9.61223720e+01 4.53193477e-02]
mat_Sqrt:  [[ 2.04628586e+01  0.00000000e+00]
 [-8.51533654e-03  1.95110871e-02]]
grads:  [ 1.08184049e-03 -1.36783675e+01]
Stock Position:  0.0010818404935395288
Bond Position:  [10.02614086]


portfolio before change:  [10.13233007]
curr_Stock_Price:  93.52107556603745
curr_Factors:  [9.35210756e+01 4.63844684e-02]
mat_Sqrt:  [[ 2.01416843e+01  0.00000000e+00]
 [-8.61482149e-03  1.97390358e-02]]
grads:  [ 1.67027440e-04 -5.97877941e+00]
Stock Position:  0.0001670274402070661
Bond Position:  [10.11670949]


portfolio before change:  [10.13722449]
curr_Stock_Price:  92.53196869909243
curr_Factors:  [9.25319687e+01 4.79071459e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.13722449]
Stock Price:  92.84900561984199
PL:  [10.13722449]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.41904692e-02 -3.22006358e-01]
 [-4.59169156e-01 -1.17067220e-01]
 [-2.15298851e-01 -3.02046758e-01]
 [-2.54387083e-02  6.05796178e-02]
 [ 3.72124450e-02 -1.52570127e-02]
 [ 8.65885244e-02 -1.42723780e-01]
 [ 1.89085566e-01 -3.09762255e-02]
 [-4.02614688e-01 -4.28301054e-01]
 [ 3.35655012e-02 -3.75054240e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.30576814]
curr_Stock_Price:  100.84822340540636
curr_Factors:  [1.00848223e+02 4.06576135e-02]
mat_Sqrt:  [[ 2.03347667e+01  0.00000000e+00]
 [-8.06549327e-03  1.84803667e-02]]
grads:  [-1.00677607e-02 -1.74242407e+01]
Stock Position:  -0.010067760736671266
Bond Position:  [9.32108392]


portfolio before change:  [8.2900396]
curr_Stock_Price:  102.87352488517301
curr_Factors:  [1.02873525e+02 3.89918988e-02]
mat_Sqrt:  [[ 2.03137832e+01  0.00000000e+00]
 [-7.89854658e-03  1.80978438e-02]]
grads:  [-0.02511898 -6.46857278]
Stock Position:  -0.02511897830648204
Bond Position:  [10.87411744]


portfolio before change:  [8.30810126]
curr_Stock_Price:  102.37098677580897
curr_Factors:  [1.02370987e+02 3.90382535e-02]
mat_Sqrt:  [[ 2.02265624e+01  0.00000000e+00]
 [-7.90324020e-03  1.81085982e-02]]
grads:  [ -0.01716173 -16.67974267]
Stock Position:  -0.017161732956011578
Bond Position:  [10.0649648]


portfolio before change:  [8.30381682]
curr_Stock_Price:  102.91394922494331
curr_Factors:  [1.02913949e+02 3.74417720e-02]
mat_Sqrt:  [[ 1.99137221e+01  0.00000000e+00]
 [-7.73995060e-03  1.77344547e-02]]
grads:  [5.02369429e-05 3.41592785e+00]
Stock Position:  5.023694294061637e-05
Bond Position:  [8.29864674]


portfolio before change:  [8.30785898]
curr_Stock_Price:  100.76013004314872
curr_Factors:  [1.00760130e+02 3.83152172e-02]
mat_Sqrt:  [[ 1.97230631e+01  0.00000000e+00]
 [-7.82970928e-03  1.79401177e-02]]
grads:  [ 0.00154914 -0.85044106]
Stock Position:  0.0015491376027084562
Bond Position:  [8.15176768]


portfolio before change:  [8.31223954]
curr_Stock_Price:  100.95614523014768
curr_Factors:  [1.00956145e+02 3.65396541e-02]
mat_Sqrt:  [[ 1.92981188e+01  0.00000000e+00]
 [-7.64613933e-03  1.75195061e-02]]
grads:  [ 1.25912585e-03 -8.14656411e+00]
Stock Position:  0.001259125845021086
Bond Position:  [8.18512305]


portfolio before change:  [8.31843079]
curr_Stock_Price:  102.62211190687596
curr_Factors:  [1.02622112e+02 3.50640746e-02]
mat_Sqrt:  [[ 1.92164048e+01  0.00000000e+00]
 [-7.49016151e-03  1.71621160e-02]]
grads:  [ 0.00913628 -1.80491878]
Stock Position:  0.009136278855115903
Bond Position:  [7.38084655]


portfolio before change:  [8.36573164]
curr_Stock_Price:  107.39533643245439
curr_Factors:  [1.07395336e+02 2.98108009e-02]
mat_Sqrt:  [[ 1.85426690e+01  0.00000000e+00]
 [-6.90632185e-03  1.58243713e-02]]
grads:  [ -0.03179373 -27.06591277]
Stock Position:  -0.03179372901937695
Bond Position:  [11.78022987]


portfolio before change:  [8.46646084]
curr_Stock_Price:  104.41243333700272
curr_Factors:  [1.04412433e+02 3.03503973e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.46646084]
Stock Price:  105.48538671700545
PL:  [2.98107413]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.18257867e-02 -2.76890285e-01]
 [-5.90267562e-03 -2.87738400e-01]
 [ 2.43074372e-01  1.56912895e-01]
 [ 2.19701753e-01  1.60663874e-01]
 [-4.90552374e-03 -3.09672289e-02]
 [ 7.83635343e-02 -8.83867167e-02]
 [ 7.14224129e-02 -3.22448723e-01]
 [ 5.42963792e-02 -1.19519912e-01]
 [-7.74377434e-04 -2.58290996e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.81669095]
curr_Stock_Price:  97.63660998141157
curr_Factors:  [9.76366100e+01 3.70631602e-02]
mat_Sqrt:  [[ 1.87967998e+01  0.00000000e+00]
 [-7.70071791e-03  1.76445614e-02]]
grads:  [-2.07583425e-03 -1.56926703e+01]
Stock Position:  -0.002075834248950815
Bond Position:  [-13.61401353]


portfolio before change:  [-13.82256329]
curr_Stock_Price:  97.18552993575142
curr_Factors:  [9.71855299e+01 3.61768862e-02]
mat_Sqrt:  [[ 1.84849040e+01  0.00000000e+00]
 [-7.60808898e-03  1.74323218e-02]]
grads:  [-7.11293978e-03 -1.65060285e+01]
Stock Position:  -0.007112939775098613
Bond Position:  [-13.13128847]


portfolio before change:  [-13.83480945]
curr_Stock_Price:  97.98391662242632
curr_Factors:  [9.79839166e+01 3.87500560e-02]
mat_Sqrt:  [[ 1.92881672e+01  0.00000000e+00]
 [-7.87401356e-03  1.80416316e-02]]
grads:  [0.01615274 8.69726745]
Stock Position:  0.01615274122274106
Bond Position:  [-15.4175183]


portfolio before change:  [-13.84841919]
curr_Stock_Price:  97.61871251053999
curr_Factors:  [9.76187125e+01 4.19925713e-02]
mat_Sqrt:  [[ 2.00041135e+01  0.00000000e+00]
 [-8.19683561e-03  1.87813098e-02]]
grads:  [0.01448808 8.55445524]
Stock Position:  0.014488080988220313
Bond Position:  [-15.262727]


portfolio before change:  [-13.8407594]
curr_Stock_Price:  98.67427375172127
curr_Factors:  [9.86742738e+01 4.16519598e-02]
mat_Sqrt:  [[ 2.01382468e+01  0.00000000e+00]
 [-8.16352471e-03  1.87049850e-02]]
grads:  [-9.14713710e-04 -1.65556021e+00]
Stock Position:  -0.0009147137104860422
Bond Position:  [-13.75050069]


portfolio before change:  [-13.84423113]
curr_Stock_Price:  94.95152924097577
curr_Factors:  [9.49515292e+01 4.28435417e-02]
mat_Sqrt:  [[ 1.96537146e+01  0.00000000e+00]
 [-8.27947261e-03  1.89706550e-02]]
grads:  [ 2.02447269e-03 -4.65912837e+00]
Stock Position:  0.0020244726935515307
Bond Position:  [-14.0364579]


portfolio before change:  [-13.85486772]
curr_Stock_Price:  93.16508601902125
curr_Factors:  [9.31650860e+01 4.25525041e-02]
mat_Sqrt:  [[ 1.92183346e+01  0.00000000e+00]
 [-8.25130333e-03  1.89061110e-02]]
grads:  [-3.60623065e-03 -1.70552644e+01]
Stock Position:  -0.0036062306455613906
Bond Position:  [-13.51889293]


portfolio before change:  [-13.86463783]
curr_Stock_Price:  93.99946954881402
curr_Factors:  [9.39994695e+01 4.19722627e-02]
mat_Sqrt:  [[ 1.92577965e+01  0.00000000e+00]
 [-8.19485329e-03  1.87767677e-02]]
grads:  [ 1.10792183e-04 -6.36530808e+00]
Stock Position:  0.00011079218337379069
Bond Position:  [-13.87505224]


portfolio before change:  [-13.87138431]
curr_Stock_Price:  95.73949594665974
curr_Factors:  [9.57394959e+01 3.95088626e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.87138431]
Stock Price:  95.39161067971996
PL:  [-13.87138431]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.48029634e-02 -2.78846598e-01]
 [-1.68644164e-02 -1.62068129e-01]
 [ 2.52688720e-01  1.60187482e-01]
 [ 2.23577712e-01  1.54047998e-01]
 [ 1.83352847e-01 -1.85706673e-01]
 [ 7.97426941e-02 -1.31625613e-01]
 [ 7.32307662e-02 -3.20759583e-01]
 [ 5.26650702e-02 -1.23796260e-01]
 [ 1.68027449e-03 -8.62532608e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.18044065]
curr_Stock_Price:  97.29345417576253
curr_Factors:  [9.72934542e+01 3.85261432e-02]
mat_Sqrt:  [[ 1.90968347e+01  0.00000000e+00]
 [-7.85123106e-03  1.79894303e-02]]
grads:  [-1.93203060e-03 -1.55005797e+01]
Stock Position:  -0.001932030598761205
Bond Position:  [-15.99246672]


portfolio before change:  [-16.18926649]
curr_Stock_Price:  97.72181485209511
curr_Factors:  [9.77218149e+01 3.82277119e-02]
mat_Sqrt:  [[ 1.91064797e+01  0.00000000e+00]
 [-7.82076333e-03  1.79196200e-02]]
grads:  [-4.58466175e-03 -9.04417219e+00]
Stock Position:  -0.004584661754853058
Bond Position:  [-15.74124502]


portfolio before change:  [-16.19390986]
curr_Stock_Price:  97.0174614189688
curr_Factors:  [9.70174614e+01 3.98128589e-02]
mat_Sqrt:  [[ 1.93580492e+01  0.00000000e+00]
 [-7.98126395e-03  1.82873731e-02]]
grads:  [0.01666492 8.75945827]
Stock Position:  0.016664916240733976
Bond Position:  [-17.81069773]


portfolio before change:  [-16.21941299]
curr_Stock_Price:  96.02162344650425
curr_Factors:  [9.60216234e+01 3.79701410e-02]
mat_Sqrt:  [[ 1.87107049e+01  0.00000000e+00]
 [-7.79437141e-03  1.78591485e-02]]
grads:  [0.01554243 8.62571908]
Stock Position:  0.015542427256162662
Bond Position:  [-17.71182209]


portfolio before change:  [-16.2424167]
curr_Stock_Price:  95.11149634300445
curr_Factors:  [9.51114963e+01 4.10300285e-02]
mat_Sqrt:  [[ 1.92656614e+01  0.00000000e+00]
 [-8.10234815e-03  1.85648119e-02]]
grads:  [ 5.31016339e-03 -1.00031541e+01]
Stock Position:  0.005310163387901667
Bond Position:  [-16.74747429]


portfolio before change:  [-16.2696636]
curr_Stock_Price:  91.55773168172949
curr_Factors:  [9.15577317e+01 4.25565419e-02]
mat_Sqrt:  [[ 1.88876615e+01  0.00000000e+00]
 [-8.25169480e-03  1.89070080e-02]]
grads:  [ 1.18048320e-03 -6.96173677e+00]
Stock Position:  0.0011804831984608237
Bond Position:  [-16.37774597]


portfolio before change:  [-16.27586557]
curr_Stock_Price:  93.24259760363557
curr_Factors:  [9.32425976e+01 3.91261383e-02]
mat_Sqrt:  [[ 1.84436918e+01  0.00000000e+00]
 [-7.91213127e-03  1.81289702e-02]]
grads:  [-3.61967623e-03 -1.76932048e+01]
Stock Position:  -0.0036196762330846844
Bond Position:  [-15.93835755]


portfolio before change:  [-16.29450355]
curr_Stock_Price:  96.18949516313262
curr_Factors:  [9.61894952e+01 3.72808351e-02]
mat_Sqrt:  [[ 1.85725040e+01  0.00000000e+00]
 [-7.72329827e-03  1.76962995e-02]]
grads:  [-7.34444518e-05 -6.99560157e+00]
Stock Position:  -7.344445183378637e-05
Bond Position:  [-16.28743897]


portfolio before change:  [-16.30255845]
curr_Stock_Price:  94.9524561477686
curr_Factors:  [9.49524561e+01 3.84311479e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.30255845]
Stock Price:  97.63995401205284
PL:  [-16.30255845]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.01118507e-02 -2.84777677e-01]
 [-9.45501851e-02  5.93486301e-02]
 [-2.92164309e-01 -2.32424659e-01]
 [-3.14897684e-01 -5.14776110e-02]
 [-2.07916487e-01  6.62850201e-03]
 [ 6.47969926e-01  4.35913404e-01]
 [ 1.34983770e-01  1.69934470e-01]
 [-3.49724896e-01 -3.78447912e-01]
 [ 3.27545917e-02 -3.55802112e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.54023737]
curr_Stock_Price:  100.15639061513886
curr_Factors:  [1.00156391e+02 3.73671497e-02]
mat_Sqrt:  [[ 1.93608157e+01  0.00000000e+00]
 [-7.73223380e-03  1.77167733e-02]]
grads:  [-9.52434138e-03 -1.60739019e+01]
Stock Position:  -0.009524341378066821
Bond Position:  [4.49416102]


portfolio before change:  [3.54104804]
curr_Stock_Price:  100.30726437543713
curr_Factors:  [1.00307264e+02 3.97307177e-02]
mat_Sqrt:  [[ 1.99938114e+01  0.00000000e+00]
 [-7.97302629e-03  1.82684982e-02]]
grads:  [-0.00343348  3.24868686]
Stock Position:  -0.003433478388521703
Bond Position:  [3.88545086]


portfolio before change:  [3.52880214]
curr_Stock_Price:  104.43983863411046
curr_Factors:  [1.04439839e+02 3.84581192e-02]
mat_Sqrt:  [[ 2.04814270e+01  0.00000000e+00]
 [-7.84429670e-03  1.79735417e-02]]
grads:  [ -0.01921755 -12.93148912]
Stock Position:  -0.019217545020188215
Bond Position:  [5.53587944]


portfolio before change:  [3.50215077]
curr_Stock_Price:  105.970731582497
curr_Factors:  [1.05970732e+02 3.44366736e-02]
mat_Sqrt:  [[ 1.96651168e+01  0.00000000e+00]
 [-7.42284836e-03  1.70078822e-02]]
grads:  [-0.01715547 -3.0266914 ]
Stock Position:  -0.017155471757111677
Bond Position:  [5.32012866]


portfolio before change:  [3.49147699]
curr_Stock_Price:  106.74800616556716
curr_Factors:  [1.06748006e+02 3.56089048e-02]
mat_Sqrt:  [[ 2.01436924e+01  0.00000000e+00]
 [-7.54812875e-03  1.72949357e-02]]
grads:  [-0.01017805  0.3832626 ]
Stock Position:  -0.01017805314106168
Bond Position:  [4.57796387]


portfolio before change:  [3.46115697]
curr_Stock_Price:  109.95191719869801
curr_Factors:  [1.09951917e+02 3.37692116e-02]
mat_Sqrt:  [[ 2.02052053e+01  0.00000000e+00]
 [-7.35056043e-03  1.68422498e-02]]
grads:  [ 0.04148526 25.88213626]
Stock Position:  0.041485256915838084
Bond Position:  [-1.10022657]


portfolio before change:  [3.37883089]
curr_Stock_Price:  107.98071521380157
curr_Factors:  [1.07980715e+02 3.31813213e-02]
mat_Sqrt:  [[ 1.96694872e+01  0.00000000e+00]
 [-7.28629632e-03  1.66950022e-02]]
grads:  [ 0.01063318 10.17876295]
Stock Position:  0.010633182787416824
Bond Position:  [2.23065221]


portfolio before change:  [3.36300287]
curr_Stock_Price:  106.38724793306709
curr_Factors:  [1.06387248e+02 3.50978979e-02]
mat_Sqrt:  [[ 1.99310477e+01  0.00000000e+00]
 [-7.49377319e-03  1.71703914e-02]]
grads:  [ -0.02583372 -22.0407271 ]
Stock Position:  -0.025833720057300336
Bond Position:  [6.11138125]


portfolio before change:  [3.41219593]
curr_Stock_Price:  104.60134169926131
curr_Factors:  [1.04601342e+02 3.73748412e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.41219593]
Stock Price:  107.28306863268561
PL:  [-3.87087271]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.81202840e-02 -2.66599119e-01]
 [-8.31956001e-03  6.49804694e-02]
 [ 2.30951035e-01  1.52783763e-01]
 [ 1.69997824e-01  1.57904151e-01]
 [-1.14776975e-01 -1.08710122e-02]
 [ 1.82648715e-01 -7.83671095e-02]
 [ 1.40823118e-01  1.33203451e-01]
 [-2.27950165e-01 -2.21555481e-01]
 [ 3.83461527e-02 -4.88553614e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.22321425]
curr_Stock_Price:  99.96519265102197
curr_Factors:  [9.99651927e+01 3.81496942e-02]
mat_Sqrt:  [[ 1.95251481e+01  0.00000000e+00]
 [-7.81277868e-03  1.79013248e-02]]
grads:  [-8.93584404e-03 -1.48927033e+01]
Stock Position:  -0.008935844043106256
Bond Position:  [3.11648762]


portfolio before change:  [2.23369419]
curr_Stock_Price:  98.96681914209613
curr_Factors:  [9.89668191e+01 3.65277221e-02]
mat_Sqrt:  [[ 1.89147631e+01  0.00000000e+00]
 [-7.64489080e-03  1.75166454e-02]]
grads:  [1.05950266e-03 3.70964120e+00]
Stock Position:  0.0010595026604849668
Bond Position:  [2.12883858]


portfolio before change:  [2.23500466]
curr_Stock_Price:  99.19879917493515
curr_Factors:  [9.91987992e+01 3.42817179e-02]
mat_Sqrt:  [[ 1.83669779e+01  0.00000000e+00]
 [-7.40612912e-03  1.69695737e-02]]
grads:  [0.0162047  9.00339431]
Stock Position:  0.01620469829605294
Bond Position:  [0.62751805]


portfolio before change:  [2.24800527]
curr_Stock_Price:  99.98170627253128
curr_Factors:  [9.99817063e+01 3.44032937e-02]
mat_Sqrt:  [[ 1.85447317e+01  0.00000000e+00]
 [-7.41924995e-03  1.69996373e-02]]
grads:  [0.01288306 9.28867768]
Stock Position:  0.012883057529663742
Bond Position:  [0.95993519]


portfolio before change:  [2.30958056]
curr_Stock_Price:  104.72399674274983
curr_Factors:  [1.04723997e+02 3.31516080e-02]
mat_Sqrt:  [[ 1.90677087e+01  0.00000000e+00]
 [-7.28303321e-03  1.66875255e-02]]
grads:  [-0.00626827 -0.65144543]
Stock Position:  -0.006268266181164946
Bond Position:  [2.96601844]


portfolio before change:  [2.3081065]
curr_Stock_Price:  105.19580846125474
curr_Factors:  [1.05195808e+02 3.40928077e-02]
mat_Sqrt:  [[ 1.94236042e+01  0.00000000e+00]
 [-7.38569512e-03  1.69227535e-02]]
grads:  [ 0.00764258 -4.63087226]
Stock Position:  0.007642582829537688
Bond Position:  [1.50413882]


portfolio before change:  [2.31853375]
curr_Stock_Price:  106.46174199999035
curr_Factors:  [1.06461742e+02 3.24699986e-02]
mat_Sqrt:  [[ 1.91838029e+01  0.00000000e+00]
 [-7.20777343e-03  1.65150837e-02]]
grads:  [0.01037114 8.06556318]
Stock Position:  0.010371138136253307
Bond Position:  [1.21440432]


portfolio before change:  [2.3001149]
curr_Stock_Price:  104.6272075716649
curr_Factors:  [1.04627208e+02 3.35668229e-02]
mat_Sqrt:  [[ 1.91690131e+01  0.00000000e+00]
 [-7.32850030e-03  1.67917037e-02]]
grads:  [ -0.01693592 -13.19434196]
Stock Position:  -0.01693592169099014
Bond Position:  [4.07207309]


portfolio before change:  [2.32417467]
curr_Stock_Price:  103.32682192341363
curr_Factors:  [1.03326822e+02 3.45935222e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.32417467]
Stock Price:  103.89857707633591
PL:  [-1.5744024]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.76704231e-02 -3.53770568e-01]
 [-8.66454929e-01 -2.98585330e-01]
 [-7.09708641e-01  4.20232559e-01]
 [-8.24645602e-01 -2.64894027e-01]
 [-3.45831961e-01  5.16558009e-02]
 [ 6.93094865e-01  4.85665600e-01]
 [ 1.22087629e-01  1.94482032e-01]
 [-6.47185176e-01 -6.52067544e-01]
 [ 2.33554236e-02  4.53186877e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.25515055]
curr_Stock_Price:  101.56674673622462
curr_Factors:  [1.01566747e+02 3.66341381e-02]
mat_Sqrt:  [[ 1.94399226e+01  0.00000000e+00]
 [-7.65601861e-03  1.75421424e-02]]
grads:  [-1.14233252e-02 -2.01668964e+01]
Stock Position:  -0.011423325170987672
Bond Position:  [14.41538052]


portfolio before change:  [13.20236105]
curr_Stock_Price:  106.8190697368618
curr_Factors:  [1.06819070e+02 3.37343506e-02]
mat_Sqrt:  [[ 1.96193660e+01  0.00000000e+00]
 [-7.34676535e-03  1.68335542e-02]]
grads:  [ -0.05080532 -17.73750969]
Stock Position:  -0.050805324216840794
Bond Position:  [18.62933852]


portfolio before change:  [13.0300905]
curr_Stock_Price:  110.39325306335996
curr_Factors:  [1.10393253e+02 3.25012360e-02]
mat_Sqrt:  [[ 1.99018051e+01  0.00000000e+00]
 [-7.21123967e-03  1.65230258e-02]]
grads:  [-0.02644504 25.43314787]
Stock Position:  -0.026445044190073437
Bond Position:  [15.94944496]


portfolio before change:  [13.01679333]
curr_Stock_Price:  111.19770980363766
curr_Factors:  [1.11197710e+02 3.00055946e-02]
mat_Sqrt:  [[ 1.92618041e+01  0.00000000e+00]
 [-6.92884921e-03  1.58759880e-02]]
grads:  [ -0.04881447 -16.68519947]
Stock Position:  -0.04881447387378196
Bond Position:  [18.44485103]


portfolio before change:  [12.98228798]
curr_Stock_Price:  112.09355227134623
curr_Factors:  [1.12093552e+02 3.12829868e-02]
mat_Sqrt:  [[ 1.98259834e+01  0.00000000e+00]
 [-7.07479885e-03  1.62104006e-02]]
grads:  [-0.01630625  3.18658385]
Stock Position:  -0.01630625401184123
Bond Position:  [14.81011392]


portfolio before change:  [13.01716677]
curr_Stock_Price:  110.40880712294761
curr_Factors:  [1.10408807e+02 3.11984145e-02]
mat_Sqrt:  [[ 1.95015881e+01  0.00000000e+00]
 [-7.06522917e-03  1.61884737e-02]]
grads:  [ 0.04640938 30.00070344]
Stock Position:  0.04640938493259515
Bond Position:  [7.89316194]


portfolio before change:  [12.95469508]
curr_Stock_Price:  108.97764701479888
curr_Factors:  [1.08977647e+02 2.95996787e-02]
mat_Sqrt:  [[ 1.87491216e+01  0.00000000e+00]
 [-6.88182287e-03  1.57682371e-02]]
grads:  [1.10387330e-02 1.23337841e+01]
Stock Position:  0.011038732979099596
Bond Position:  [11.75171993]


portfolio before change:  [12.99487214]
curr_Stock_Price:  112.08486342386685
curr_Factors:  [1.12084863e+02 2.75844257e-02]
mat_Sqrt:  [[ 1.86156815e+01  0.00000000e+00]
 [-6.64342390e-03  1.52219965e-02]]
grads:  [ -0.050053   -42.83718929]
Stock Position:  -0.05005300410965065
Bond Position:  [18.60505627]


portfolio before change:  [13.05127564]
curr_Stock_Price:  111.14388791029904
curr_Factors:  [1.11143888e+02 2.64536207e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.05127564]
Stock Price:  114.67101271775387
PL:  [-1.61973707]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.60683666e-02 -4.30425044e-01]
 [-1.14814987e-01  5.46121535e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [ 6.79702931e-02  1.17565745e-01]
 [ 5.02427513e-02 -2.03577857e-02]
 [ 7.97776853e-02 -6.44619352e-02]
 [ 2.62357530e-01 -1.27339585e-01]
 [ 1.02623965e-01  5.71063657e-02]
 [ 4.66514576e-02 -7.90679215e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.20386293]
curr_Stock_Price:  103.30139318477063
curr_Factors:  [1.03301393e+02 3.86440022e-02]
mat_Sqrt:  [[ 2.03070682e+01  0.00000000e+00]
 [-7.86323111e-03  1.80169259e-02]]
grads:  [-1.29965219e-02 -2.38900380e+01]
Stock Position:  -0.012996521872424102
Bond Position:  [26.54642175]


portfolio before change:  [25.25428035]
curr_Stock_Price:  100.44363725148172
curr_Factors:  [1.00443637e+02 3.54698345e-02]
mat_Sqrt:  [[ 1.89169890e+01  0.00000000e+00]
 [-7.53337476e-03  1.72611300e-02]]
grads:  [-0.00480945  3.16388055]
Stock Position:  -0.00480944876987839
Bond Position:  [25.73735888]


portfolio before change:  [25.2532178]
curr_Stock_Price:  103.34094387975946
curr_Factors:  [1.03340944e+02 3.15812962e-02]
mat_Sqrt:  [[ 1.83648506e+01  0.00000000e+00]
 [-7.10845088e-03  1.62875071e-02]]
grads:  [ -0.01950758 -19.04730758]
Stock Position:  -0.01950757927082048
Bond Position:  [27.26914945]


portfolio before change:  [25.30245743]
curr_Stock_Price:  101.51592767416841
curr_Factors:  [1.01515928e+02 3.24907167e-02]
mat_Sqrt:  [[ 1.82984302e+01  0.00000000e+00]
 [-7.21007259e-03  1.65203517e-02]]
grads:  [6.51860239e-03 7.11641902e+00]
Stock Position:  0.0065186023934900835
Bond Position:  [24.64071546]


portfolio before change:  [25.30649567]
curr_Stock_Price:  100.24491958644991
curr_Factors:  [1.00244920e+02 3.14008744e-02]
mat_Sqrt:  [[ 1.77636923e+01  0.00000000e+00]
 [-7.08811675e-03  1.62409158e-02]]
grads:  [ 0.00232823 -1.25348755]
Stock Position:  0.0023282257121831733
Bond Position:  [25.07310288]


portfolio before change:  [25.31812135]
curr_Stock_Price:  99.85234040258754
curr_Factors:  [9.98523404e+01 3.31270161e-02]
mat_Sqrt:  [[ 1.81739533e+01  0.00000000e+00]
 [-7.28033143e-03  1.66813349e-02]]
grads:  [ 2.84165968e-03 -3.86431515e+00]
Stock Position:  0.0028416596770804475
Bond Position:  [25.03437498]


portfolio before change:  [25.33211305]
curr_Stock_Price:  100.37013240760388
curr_Factors:  [1.00370132e+02 3.12744378e-02]
mat_Sqrt:  [[ 1.77500366e+01  0.00000000e+00]
 [-7.07383209e-03  1.62081855e-02]]
grads:  [ 0.01164966 -7.85649848]
Stock Position:  0.011649664924419812
Bond Position:  [24.16283464]


portfolio before change:  [25.3359008]
curr_Stock_Price:  99.65794949515272
curr_Factors:  [9.96579495e+01 3.15771653e-02]
mat_Sqrt:  [[ 1.77091827e+01  0.00000000e+00]
 [-7.10798596e-03  1.62864419e-02]]
grads:  [0.00720232 3.50637458]
Stock Position:  0.00720232143257132
Bond Position:  [24.61813221]


portfolio before change:  [25.34571117]
curr_Stock_Price:  99.31059323737483
curr_Factors:  [9.93105932e+01 3.18492920e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.34571117]
Stock Price:  99.72103058156247
PL:  [25.34571117]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.77758246e-02 -2.80800075e-01]
 [-3.54462153e-02  4.34068003e-02]
 [ 1.62970198e-01  1.07668729e-01]
 [ 9.27306451e-02  1.28958241e-01]
 [-9.42541923e-02 -6.68234543e-03]
 [ 9.56527450e-02 -1.74472998e-01]
 [ 1.44215593e-01  1.11863897e-01]
 [-5.24927959e-02  7.17912394e-02]
 [ 5.05516222e-02 -8.23516191e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.5188403]
curr_Stock_Price:  96.95397854715091
curr_Factors:  [9.69539785e+01 4.10383425e-02]
mat_Sqrt:  [[ 1.96408619e+01  0.00000000e+00]
 [-8.10316901e-03  1.85666927e-02]]
grads:  [-1.77056259e-03 -1.51238608e+01]
Stock Position:  -0.0017705625884708804
Bond Position:  [-18.34717721]


portfolio before change:  [-18.53095201]
curr_Stock_Price:  98.61211087189045
curr_Factors:  [9.86121109e+01 4.02699366e-02]
mat_Sqrt:  [[ 1.97888578e+01  0.00000000e+00]
 [-8.02694827e-03  1.83920490e-02]]
grads:  [-8.33900302e-04  2.36008507e+00]
Stock Position:  -0.0008339003019219053
Bond Position:  [-18.44871934]


portfolio before change:  [-18.54174526]
curr_Stock_Price:  100.4907285721957
curr_Factors:  [1.00490729e+02 3.83992437e-02]
mat_Sqrt:  [[ 1.96918868e+01  0.00000000e+00]
 [-7.83828999e-03  1.79597786e-02]]
grads:  [0.01066229 5.99499198]
Stock Position:  0.010662293882209517
Bond Position:  [-19.61320694]


portfolio before change:  [-18.54327721]
curr_Stock_Price:  101.26702528882194
curr_Factors:  [1.01267025e+02 3.88749909e-02]
mat_Sqrt:  [[ 1.99665580e+01  0.00000000e+00]
 [-7.88669674e-03  1.80706924e-02]]
grads:  [0.00746311 7.13631985]
Stock Position:  0.0074631108642640555
Bond Position:  [-19.29904424]


portfolio before change:  [-18.53091471]
curr_Stock_Price:  104.21679178042687
curr_Factors:  [1.04216792e+02 3.64349087e-02]
mat_Sqrt:  [[ 1.98928287e+01  0.00000000e+00]
 [-7.63517216e-03  1.74943772e-02]]
grads:  [-0.00488471 -0.38197104]
Stock Position:  -0.004884705361923875
Bond Position:  [-18.02184639]


portfolio before change:  [-18.54037426]
curr_Stock_Price:  104.30817441578239
curr_Factors:  [1.04308174e+02 3.50683363e-02]
mat_Sqrt:  [[ 1.95333137e+01  0.00000000e+00]
 [-7.49061667e-03  1.71631589e-02]]
grads:  [ 9.98626558e-04 -1.01655528e+01]
Stock Position:  0.000998626557745236
Bond Position:  [-18.64453918]


portfolio before change:  [-18.54843618]
curr_Stock_Price:  105.57259747157238
curr_Factors:  [1.05572597e+02 3.50636002e-02]
mat_Sqrt:  [[ 1.97687614e+01  0.00000000e+00]
 [-7.49011083e-03  1.71619999e-02]]
grads:  [0.00976475 6.51811546]
Stock Position:  0.009764749359861062
Bond Position:  [-19.57932613]


portfolio before change:  [-18.58398378]
curr_Stock_Price:  102.93499841672
curr_Factors:  [1.02934998e+02 3.81409720e-02]
mat_Sqrt:  [[ 2.01029106e+01  0.00000000e+00]
 [-7.81188551e-03  1.78992783e-02]]
grads:  [-1.05261028e-03  4.01084547e+00]
Stock Position:  -0.0010526102791941275
Bond Position:  [-18.47563334]


portfolio before change:  [-18.58965999]
curr_Stock_Price:  99.54920845472459
curr_Factors:  [9.95492085e+01 4.11906995e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.58965999]
Stock Price:  99.5026430189809
PL:  [-18.58965999]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-1.30764384e-02 -2.14529709e-01]
 [-2.89192485e-02 -2.38661711e-02]
 [ 2.31267120e-01  1.52891420e-01]
 [ 2.24632445e-01  1.57779779e-01]
 [ 1.62015158e-01 -1.68731140e-01]
 [ 7.75014689e-02 -6.13595674e-02]
 [ 1.66686382e-01 -2.37915500e-01]
 [ 5.44164427e-02 -1.19205174e-01]
 [ 1.75624117e-02  4.20584287e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.87094993]
curr_Stock_Price:  98.35460467542396
curr_Factors:  [9.83546047e+01 4.08014038e-02]
mat_Sqrt:  [[ 1.98669981e+01  0.00000000e+00]
 [-8.07974294e-03  1.85130168e-02]]
grads:  [-5.37096137e-03 -1.15880470e+01]
Stock Position:  -0.00537096137338831
Bond Position:  [-8.34269115]


portfolio before change:  [-8.87488154]
curr_Stock_Price:  98.3097754818338
curr_Factors:  [9.83097755e+01 4.10874788e-02]
mat_Sqrt:  [[ 1.99274373e+01  0.00000000e+00]
 [-8.10801863e-03  1.85778045e-02]]
grads:  [-0.00197393 -1.28466047]
Stock Position:  -0.0019739266525746245
Bond Position:  [-8.68082526]


portfolio before change:  [-8.88093031]
curr_Stock_Price:  99.17468537530594
curr_Factors:  [9.91746854e+01 4.06528033e-02]
mat_Sqrt:  [[ 1.99961359e+01  0.00000000e+00]
 [-8.06501614e-03  1.84792735e-02]]
grads:  [0.0149026 8.2736705]
Stock Position:  0.014902599547747471
Bond Position:  [-10.35889093]


portfolio before change:  [-8.91949949]
curr_Stock_Price:  96.93424150210141
curr_Factors:  [9.69342415e+01 3.99384169e-02]
mat_Sqrt:  [[ 1.93719188e+01  0.00000000e+00]
 [-7.99383931e-03  1.83161869e-02]]
grads:  [0.01515044 8.6142263 ]
Stock Position:  0.015150444802651633
Bond Position:  [-10.38809637]


portfolio before change:  [-8.94655369]
curr_Stock_Price:  95.49145521860859
curr_Factors:  [9.54914552e+01 4.00414682e-02]
mat_Sqrt:  [[ 1.91081881e+01  0.00000000e+00]
 [-8.00414575e-03  1.83398019e-02]]
grads:  [ 4.62497283e-03 -9.20027060e+00]
Stock Position:  0.0046249728320859025
Bond Position:  [-9.38819908]


portfolio before change:  [-8.94394099]
curr_Stock_Price:  97.0715663022075
curr_Factors:  [9.70715663e+01 4.14880150e-02]
mat_Sqrt:  [[ 1.97721258e+01  0.00000000e+00]
 [-8.14744279e-03  1.86681367e-02]]
grads:  [ 2.56532649e-03 -3.28686084e+00]
Stock Position:  0.002565326494193304
Bond Position:  [-9.19296125]


portfolio before change:  [-8.94858287]
curr_Stock_Price:  97.0543183870586
curr_Factors:  [9.70543184e+01 4.57233853e-02]
mat_Sqrt:  [[ 2.07531513e+01  0.00000000e+00]
 [-8.55321088e-03  1.95978682e-02]]
grads:  [ 3.02853019e-03 -1.21398664e+01]
Stock Position:  0.003028530186448063
Bond Position:  [-9.2425148]


portfolio before change:  [-8.96150876]
curr_Stock_Price:  94.3125672940029
curr_Factors:  [9.43125673e+01 4.68010217e-02]
mat_Sqrt:  [[ 2.04031506e+01  0.00000000e+00]
 [-8.65341752e-03  1.98274704e-02]]
grads:  [ 1.17189716e-04 -6.01212217e+00]
Stock Position:  0.00011718971601317046
Bond Position:  [-8.97256122]


portfolio before change:  [-8.9662005]
curr_Stock_Price:  92.56894164311521
curr_Factors:  [9.25689416e+01 4.74129892e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.9662005]
Stock Price:  92.07966674263393
PL:  [-8.9662005]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 3.69547859e-02 -2.47405397e-01]
 [-6.47223477e-02  6.63202675e-02]
 [-1.36157856e-01 -2.16326578e-01]
 [ 3.89542484e-02  1.00386417e-01]
 [ 1.57414840e-02 -2.69951508e-02]
 [ 7.71562490e-02 -3.53518862e-02]
 [ 2.08489879e-01 -1.90856704e-01]
 [ 5.33531399e-02 -1.21992539e-01]
 [ 3.40711489e-02 -6.87306356e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.75771644]
curr_Stock_Price:  98.08069459049288
curr_Factors:  [9.80806946e+01 4.30802433e-02]
mat_Sqrt:  [[ 2.03574139e+01  0.00000000e+00]
 [-8.30231229e-03  1.90229873e-02]]
grads:  [-3.48874282e-03 -1.30056018e+01]
Stock Position:  -0.0034887428216954833
Bond Position:  [-10.41553812]


portfolio before change:  [-10.76999691]
curr_Stock_Price:  100.10761379139876
curr_Factors:  [1.00107614e+02 4.50842518e-02]
mat_Sqrt:  [[ 2.12559022e+01  0.00000000e+00]
 [-8.49322100e-03  1.94604141e-02]]
grads:  [-1.68319414e-03  3.40795768e+00]
Stock Position:  -0.0016831941391175444
Bond Position:  [-10.60149636]


portfolio before change:  [-10.77846951]
curr_Stock_Price:  101.99125212572218
curr_Factors:  [1.01991252e+02 4.51138476e-02]
mat_Sqrt:  [[ 2.16629630e+01  0.00000000e+00]
 [-8.49600825e-03  1.94668005e-02]]
grads:  [-1.06435355e-02 -1.11125903e+01]
Stock Position:  -0.010643535480677159
Bond Position:  [-9.692922]


portfolio before change:  [-10.78268708]
curr_Stock_Price:  101.93205094288956
curr_Factors:  [1.01932051e+02 4.83555372e-02]
mat_Sqrt:  [[ 2.24147484e+01  0.00000000e+00]
 [-8.79595700e-03  2.01540694e-02]]
grads:  [3.69250064e-03 4.98095027e+00]
Stock Position:  0.0036925006355007653
Bond Position:  [-11.15907124]


portfolio before change:  [-10.79857743]
curr_Stock_Price:  99.14006067593557
curr_Factors:  [9.91400607e+01 4.62525954e-02]
mat_Sqrt:  [[ 2.13214744e+01  0.00000000e+00]
 [-8.60256663e-03  1.97109564e-02]]
grads:  [ 1.85720473e-04 -1.36955053e+00]
Stock Position:  0.0001857204728174921
Bond Position:  [-10.81698977]


portfolio before change:  [-10.80390925]
curr_Stock_Price:  99.56020037792791
curr_Factors:  [9.95602004e+01 4.69071576e-02]
mat_Sqrt:  [[ 2.15628082e+01  0.00000000e+00]
 [-8.66322412e-03  1.98499401e-02]]
grads:  [ 0.00286268 -1.78095682]
Stock Position:  0.002862680051252166
Bond Position:  [-11.08891825]


portfolio before change:  [-10.81325267]
curr_Stock_Price:  98.23362165985873
curr_Factors:  [9.82336217e+01 4.62143729e-02]
mat_Sqrt:  [[ 2.11178007e+01  0.00000000e+00]
 [-8.59901137e-03  1.97028103e-02]]
grads:  [ 5.92832494e-03 -9.68677573e+00]
Stock Position:  0.005928324937898059
Bond Position:  [-11.3956135]


portfolio before change:  [-10.83162283]
curr_Stock_Price:  96.09626802501244
curr_Factors:  [9.60962680e+01 4.71105219e-02]
mat_Sqrt:  [[ 2.08576550e+01  0.00000000e+00]
 [-8.68198336e-03  1.98929230e-02]]
grads:  [ 5.33284878e-06 -6.13245925e+00]
Stock Position:  5.33284878142625e-06
Bond Position:  [-10.83213529]


portfolio before change:  [-10.83702728]
curr_Stock_Price:  98.52771729560635
curr_Factors:  [9.85277173e+01 4.61823054e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.83702728]
Stock Price:  100.89355570544392
PL:  [-11.73058299]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.18850815e-02 -3.00963315e-01]
 [-2.31264438e-01  2.26702967e-02]
 [ 1.98635931e-01  1.46299441e-01]
 [ 2.05042820e-01  1.64469289e-01]
 [ 6.21260116e-03 -3.29869859e-03]
 [ 8.76082848e-02 -1.47331777e-01]
 [ 2.51428912e-01 -1.36673634e-01]
 [ 2.45418595e-02  2.01213663e-02]
 [ 5.12653938e-02 -7.95274523e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.16878767]
curr_Stock_Price:  100.3928143328301
curr_Factors:  [1.00392814e+02 3.64728150e-02]
mat_Sqrt:  [[ 1.91728763e+01  0.00000000e+00]
 [-7.63914288e-03  1.75034752e-02]]
grads:  [-1.00786255e-02 -1.71944891e+01]
Stock Position:  -0.0100786255233059
Bond Position:  [6.18060925]


portfolio before change:  [5.16379855]
curr_Stock_Price:  101.19453035876947
curr_Factors:  [1.01194530e+02 3.33570254e-02]
mat_Sqrt:  [[ 1.84820737e+01  0.00000000e+00]
 [-7.30556231e-03  1.67391461e-02]]
grads:  [-0.01197757  1.35432814]
Stock Position:  -0.01197756880206327
Bond Position:  [6.375863]


portfolio before change:  [5.17911707]
curr_Stock_Price:  100.18182182747702
curr_Factors:  [1.00181822e+02 3.33435907e-02]
mat_Sqrt:  [[ 1.82934285e+01  0.00000000e+00]
 [-7.30409099e-03  1.67357749e-02]]
grads:  [0.01434866 8.74171898]
Stock Position:  0.0143486630182586
Bond Position:  [3.74164187]


portfolio before change:  [5.16379438]
curr_Stock_Price:  98.98352325704379
curr_Factors:  [9.89835233e+01 3.57251296e-02]
mat_Sqrt:  [[ 1.87089673e+01  0.00000000e+00]
 [-7.56043699e-03  1.73231374e-02]]
grads:  [0.01479628 9.4941976 ]
Stock Position:  0.014796279196451585
Bond Position:  [3.69920653]


portfolio before change:  [5.2074193]
curr_Stock_Price:  101.80685896332834
curr_Factors:  [1.01806859e+02 3.66779057e-02]
mat_Sqrt:  [[ 1.94975168e+01  0.00000000e+00]
 [-7.66059065e-03  1.75526183e-02]]
grads:  [ 0.0002448 -0.187932 ]
Stock Position:  0.00024479686892028336
Bond Position:  [5.1824973]


portfolio before change:  [5.21031846]
curr_Stock_Price:  103.06200846998544
curr_Factors:  [1.03062008e+02 3.74353049e-02]
mat_Sqrt:  [[ 1.99406490e+01  0.00000000e+00]
 [-7.73928213e-03  1.77329231e-02]]
grads:  [ 1.16883987e-03 -8.30837513e+00]
Stock Position:  0.0011688398677432313
Bond Position:  [5.08985547]


portfolio before change:  [5.21023467]
curr_Stock_Price:  100.81246482438918
curr_Factors:  [1.00812465e+02 3.92491802e-02]
mat_Sqrt:  [[ 1.99723666e+01  0.00000000e+00]
 [-7.92456234e-03  1.81574534e-02]]
grads:  [ 0.00960225 -7.52713669]
Stock Position:  0.009602249581432756
Bond Position:  [4.24220822]


portfolio before change:  [5.2137343]
curr_Stock_Price:  100.95597254175128
curr_Factors:  [1.00955973e+02 3.78329343e-02]
mat_Sqrt:  [[ 1.96366333e+01  0.00000000e+00]
 [-7.78027601e-03  1.78268519e-02]]
grads:  [0.00169701 1.12871114]
Stock Position:  0.0016970090140847945
Bond Position:  [5.0424111]


portfolio before change:  [5.21529383]
curr_Stock_Price:  100.38891639999738
curr_Factors:  [1.00388916e+02 3.93176907e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.21529383]
Stock Price:  104.13336580644001
PL:  [1.08192803]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.03308350e-02 -3.78054190e-01]
 [-2.78091042e-01 -1.80714089e-03]
 [ 1.23549055e-01  6.49704085e-02]
 [ 5.14460396e-02  1.08108663e-01]
 [-1.02558403e-01 -8.02697768e-03]
 [ 8.80519913e-02 -1.55372492e-01]
 [ 1.81144230e-01 -8.02380784e-03]
 [-2.79013666e-02  6.64768873e-03]
 [ 4.97159183e-02 -7.58487800e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.04144926]
curr_Stock_Price:  102.11642015643724
curr_Factors:  [1.02116420e+02 3.98352627e-02]
mat_Sqrt:  [[ 2.03811847e+01  0.00000000e+00]
 [-7.98350927e-03  1.82925178e-02]]
grads:  [-1.15462969e-02 -2.06671490e+01]
Stock Position:  -0.011546296948089856
Bond Position:  [18.22051577]


portfolio before change:  [17.05799906]
curr_Stock_Price:  101.47229434430015
curr_Factors:  [1.01472294e+02 3.94572066e-02]
mat_Sqrt:  [[ 2.01562923e+01  0.00000000e+00]
 [-7.94553526e-03  1.82055084e-02]]
grads:  [-0.01383587 -0.09926341]
Stock Position:  -0.013835865167567159
Bond Position:  [18.46195604]


portfolio before change:  [17.07733526]
curr_Stock_Price:  100.74209699510288
curr_Factors:  [1.00742097e+02 4.36602316e-02]
mat_Sqrt:  [[ 2.10500923e+01  0.00000000e+00]
 [-8.35801235e-03  1.91506121e-02]]
grads:  [0.00721633 3.39260218]
Stock Position:  0.0072163325449292855
Bond Position:  [16.35034678]


portfolio before change:  [17.09271846]
curr_Stock_Price:  101.74066320143689
curr_Factors:  [1.01740663e+02 4.58812330e-02]
mat_Sqrt:  [[ 2.17927534e+01  0.00000000e+00]
 [-8.56796199e-03  1.96316672e-02]]
grads:  [4.52574883e-03 5.50685084e+00]
Stock Position:  0.0045257488343378215
Bond Position:  [16.63226577]


portfolio before change:  [17.11322445]
curr_Stock_Price:  104.43364822803714
curr_Factors:  [1.04433648e+02 4.51365581e-02]
mat_Sqrt:  [[ 2.21873109e+01  0.00000000e+00]
 [-8.49814644e-03  1.94716997e-02]]
grads:  [-0.00478028 -0.41223816]
Stock Position:  -0.004780284716307649
Bond Position:  [17.61244702]


portfolio before change:  [17.13206396]
curr_Stock_Price:  102.33521923679166
curr_Factors:  [1.02335219e+02 4.52605236e-02]
mat_Sqrt:  [[ 2.17713275e+01  0.00000000e+00]
 [-8.50980833e-03  1.94984204e-02]]
grads:  [ 9.29749307e-04 -7.96846557e+00]
Stock Position:  0.0009297493068400314
Bond Position:  [17.03691786]


portfolio before change:  [17.14118528]
curr_Stock_Price:  102.98134231028492
curr_Factors:  [1.02981342e+02 4.27741850e-02]
mat_Sqrt:  [[ 2.12985197e+01  0.00000000e+00]
 [-8.27276834e-03  1.89552936e-02]]
grads:  [ 0.0083406  -0.42330169]
Stock Position:  0.00834059624039728
Bond Position:  [16.28225949]


portfolio before change:  [17.14082966]
curr_Stock_Price:  101.96237538960438
curr_Factors:  [1.01962375e+02 4.10644052e-02]
mat_Sqrt:  [[ 2.06620169e+01  0.00000000e+00]
 [-8.10574169e-03  1.85725874e-02]]
grads:  [-0.00120995  0.35793014]
Stock Position:  -0.001209953385823849
Bond Position:  [17.26419938]


portfolio before change:  [17.15093862]
curr_Stock_Price:  100.74355913769709
curr_Factors:  [1.00743559e+02 4.24636456e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.15093862]
Stock Price:  104.16011918642255
PL:  [12.99081944]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.67562643e-02 -2.54148664e-01]
 [-8.32159646e-01 -2.70061027e-01]
 [-4.56947730e-01 -4.74292001e-02]
 [-3.63141382e-01 -6.96074449e-02]
 [-3.22563150e-02 -3.28838050e-03]
 [ 8.55479116e-02 -1.30652853e-01]
 [ 2.49023432e-01 -1.38724905e-01]
 [-2.10157324e-01 -1.88922466e-01]
 [ 2.92630595e-02 -2.72908237e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.35745652]
curr_Stock_Price:  99.83950684418286
curr_Factors:  [9.98395068e+01 3.99016416e-02]
mat_Sqrt:  [[ 1.99433361e+01  0.00000000e+00]
 [-7.99015811e-03  1.83077522e-02]]
grads:  [-8.40761214e-03 -1.38820245e+01]
Stock Position:  -0.008407612142670887
Bond Position:  [2.19686837]


portfolio before change:  [1.30471683]
curr_Stock_Price:  106.24303773741188
curr_Factors:  [1.06243038e+02 3.61693160e-02]
mat_Sqrt:  [[ 2.02055477e+01  0.00000000e+00]
 [-7.60729292e-03  1.74304978e-02]]
grads:  [ -0.04701798 -15.49359228]
Stock Position:  -0.04701797511843745
Bond Position:  [6.30004933]


portfolio before change:  [1.28889792]
curr_Stock_Price:  106.6464945558094
curr_Factors:  [1.06646495e+02 3.60410846e-02]
mat_Sqrt:  [[ 2.02462927e+01  0.00000000e+00]
 [-7.59379584e-03  1.73995721e-02]]
grads:  [-0.02359185 -2.72588313]
Stock Position:  -0.023591851510543712
Bond Position:  [3.80488618]


portfolio before change:  [1.29482944]
curr_Stock_Price:  106.475732114938
curr_Factors:  [1.06475732e+02 3.76858223e-02]
mat_Sqrt:  [[ 2.06699599e+01  0.00000000e+00]
 [-7.76513462e-03  1.77921586e-02]]
grads:  [-0.01903828 -3.91225407]
Stock Position:  -0.0190382837907771
Bond Position:  [3.32194464]


portfolio before change:  [1.36782633]
curr_Stock_Price:  102.72878191424265
curr_Factors:  [1.02728782e+02 4.12887382e-02]
mat_Sqrt:  [[ 2.08741089e+01  0.00000000e+00]
 [-8.12785218e-03  1.86232489e-02]]
grads:  [-0.00161403 -0.17657394]
Stock Position:  -0.0016140321098439023
Bond Position:  [1.53363388]


portfolio before change:  [1.37171424]
curr_Stock_Price:  100.7951742619733
curr_Factors:  [1.00795174e+02 4.28165284e-02]
mat_Sqrt:  [[ 2.08566938e+01  0.00000000e+00]
 [-8.27686206e-03  1.89646734e-02]]
grads:  [ 1.36773028e-03 -6.88927513e+00]
Stock Position:  0.001367730280073811
Bond Position:  [1.23385363]


portfolio before change:  [1.37248812]
curr_Stock_Price:  100.90981694359533
curr_Factors:  [1.00909817e+02 4.09552292e-02]
mat_Sqrt:  [[ 2.04215216e+01  0.00000000e+00]
 [-8.09495935e-03  1.85478820e-02]]
grads:  [ 0.00922943 -7.47928553]
Stock Position:  0.00922942587002248
Bond Position:  [0.44114845]


portfolio before change:  [1.40559086]
curr_Stock_Price:  104.47256350083687
curr_Factors:  [1.04472564e+02 4.07319646e-02]
mat_Sqrt:  [[ 2.10848216e+01  0.00000000e+00]
 [-8.07286463e-03  1.84972566e-02]]
grads:  [ -0.01387775 -10.21353975]
Stock Position:  -0.013877748355257376
Bond Position:  [2.8554348]


portfolio before change:  [1.39418499]
curr_Stock_Price:  105.39734887984706
curr_Factors:  [1.05397349e+02 3.93720145e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.39418499]
Stock Price:  106.89957698405644
PL:  [-5.50539199]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.55430206e-02 -3.34352133e-01]
 [-1.23197320e-02  7.85682903e-02]
 [ 2.08396734e-01  1.56871684e-01]
 [ 1.37126955e-01  1.47384689e-01]
 [ 2.67154791e-02 -2.48839700e-02]
 [ 7.67065574e-02 -3.64378013e-02]
 [ 2.65656969e-01 -1.26840501e-01]
 [ 1.36159016e-02  1.49713210e-02]
 [ 5.14120989e-02 -7.98757509e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.22888386]
curr_Stock_Price:  101.12741046320765
curr_Factors:  [1.01127410e+02 3.77018231e-02]
mat_Sqrt:  [[ 1.96358661e+01  0.00000000e+00]
 [-7.76678292e-03  1.77959353e-02]]
grads:  [-1.07693877e-02 -1.87881180e+01]
Stock Position:  -0.01076938767678185
Bond Position:  [11.31796415]


portfolio before change:  [10.24910511]
curr_Stock_Price:  99.77535110750733
curr_Factors:  [9.97753511e+01 3.87296868e-02]
mat_Sqrt:  [[ 1.96356489e+01  0.00000000e+00]
 [-7.87194378e-03  1.80368891e-02]]
grads:  [1.11889764e-03 4.35597790e+00]
Stock Position:  0.0011188976372459266
Bond Position:  [10.1374667]


portfolio before change:  [10.25445648]
curr_Stock_Price:  100.02682430016037
curr_Factors:  [1.00026824e+02 4.03697891e-02]
mat_Sqrt:  [[ 2.00976242e+01  0.00000000e+00]
 [-8.03689383e-03  1.84148372e-02]]
grads:  [0.01377581 8.51876572]
Stock Position:  0.013775814831769144
Bond Position:  [8.87650547]


portfolio before change:  [10.26673909]
curr_Stock_Price:  100.59617341257791
curr_Factors:  [1.00596173e+02 4.20694522e-02]
mat_Sqrt:  [[ 2.06331193e+01  0.00000000e+00]
 [-8.20433566e-03  1.87984946e-02]]
grads:  [0.00976347 7.8402389 ]
Stock Position:  0.009763473150770826
Bond Position:  [9.28457105]


portfolio before change:  [10.25955258]
curr_Stock_Price:  99.38451863714218
curr_Factors:  [9.93845186e+01 4.51927211e-02]
mat_Sqrt:  [[ 2.11277371e+01  0.00000000e+00]
 [-8.50343188e-03  1.94838101e-02]]
grads:  [ 7.50445924e-04 -1.27716139e+00]
Stock Position:  0.0007504459235777554
Bond Position:  [10.18496987]


portfolio before change:  [10.26438063]
curr_Stock_Price:  99.03044905791798
curr_Factors:  [9.90304491e+01 4.49205704e-02]
mat_Sqrt:  [[ 2.09889822e+01  0.00000000e+00]
 [-8.47778938e-03  1.94250558e-02]]
grads:  [ 0.00289694 -1.8758145 ]
Stock Position:  0.002896938808325805
Bond Position:  [9.97749548]


portfolio before change:  [10.27187825]
curr_Stock_Price:  99.89606181012942
curr_Factors:  [9.98960618e+01 4.47711679e-02]
mat_Sqrt:  [[ 2.11372060e+01  0.00000000e+00]
 [-8.46367938e-03  1.93927257e-02]]
grads:  [ 0.00994924 -6.54062263]
Stock Position:  0.009949244802401393
Bond Position:  [9.27798788]


portfolio before change:  [10.28880544]
curr_Stock_Price:  101.13103356538039
curr_Factors:  [1.01131034e+02 4.38474385e-02]
mat_Sqrt:  [[ 2.11766159e+01  0.00000000e+00]
 [-8.37591199e-03  1.91916253e-02]]
grads:  [0.00095152 0.78009656]
Stock Position:  0.0009515175521095767
Bond Position:  [10.19257749]


portfolio before change:  [10.29316995]
curr_Stock_Price:  100.36063187790211
curr_Factors:  [1.00360632e+02 4.76252788e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.29316995]
Stock Price:  98.6318646333633
PL:  [10.29316995]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.29222908e-02 -2.19153045e-01]
 [-6.25829632e-01 -2.25049454e-01]
 [-2.58991713e-01 -2.69666146e-01]
 [-1.22405619e-01  2.08816115e-02]
 [-1.62992979e-01 -8.00540777e-03]
 [ 2.60763788e-01  8.46387368e-03]
 [ 1.34002592e-01  1.76106334e-01]
 [-5.46028939e-01 -5.55460219e-01]
 [ 2.41524523e-02  8.99967712e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.14970998]
curr_Stock_Price:  99.47553059861545
curr_Factors:  [9.94755306e+01 4.11236102e-02]
mat_Sqrt:  [[ 2.01726002e+01  0.00000000e+00]
 [-8.11158285e-03  1.85859712e-02]]
grads:  [-7.36486717e-03 -1.17913152e+01]
Stock Position:  -0.007364867174682234
Bond Position:  [-0.41708591]


portfolio before change:  [-1.18465959]
curr_Stock_Price:  104.1926578310472
curr_Factors:  [1.04192658e+02 3.96959536e-02]
mat_Sqrt:  [[ 2.07591820e+01  0.00000000e+00]
 [-7.96953736e-03  1.82605041e-02]]
grads:  [ -0.03487851 -12.32438342]
Stock Position:  -0.03487850662662492
Bond Position:  [2.44942472]


portfolio before change:  [-1.17658159]
curr_Stock_Price:  103.99617621901989
curr_Factors:  [1.03996176e+02 4.10594610e-02]
mat_Sqrt:  [[ 2.10728848e+01  0.00000000e+00]
 [-8.10525370e-03  1.85714693e-02]]
grads:  [ -0.01787528 -14.52045292]
Stock Position:  -0.017875277686522105
Bond Position:  [0.68237894]


portfolio before change:  [-1.17559531]
curr_Stock_Price:  103.96009250139352
curr_Factors:  [1.03960093e+02 4.32345594e-02]
mat_Sqrt:  [[ 2.16163407e+01  0.00000000e+00]
 [-8.31716869e-03  1.90570275e-02]]
grads:  [-0.00524104  1.09574337]
Stock Position:  -0.005241041415567925
Bond Position:  [-0.63073616]


portfolio before change:  [-1.18371657]
curr_Stock_Price:  105.44945626613075
curr_Factors:  [1.05449456e+02 4.39046905e-02]
mat_Sqrt:  [[ 2.20952950e+01  0.00000000e+00]
 [-8.38137845e-03  1.92041506e-02]]
grads:  [-0.00753494 -0.41685821]
Stock Position:  -0.007534944650448407
Bond Position:  [-0.38916075]


portfolio before change:  [-1.18815073]
curr_Stock_Price:  106.01210556295486
curr_Factors:  [1.06012106e+02 4.45011125e-02]
mat_Sqrt:  [[ 2.23635577e+01  0.00000000e+00]
 [-8.43811472e-03  1.93341497e-02]]
grads:  [0.01182539 0.43776808]
Stock Position:  0.011825387013019967
Bond Position:  [-2.44178491]


portfolio before change:  [-1.16331184]
curr_Stock_Price:  108.21584660531444
curr_Factors:  [1.08215847e+02 4.23626165e-02]
mat_Sqrt:  [[ 2.22731812e+01  0.00000000e+00]
 [-8.23287230e-03  1.88638803e-02]]
grads:  [0.00946707 9.33563678]
Stock Position:  0.009467066952501484
Bond Position:  [-2.1877985]


portfolio before change:  [-1.1459815]
curr_Stock_Price:  110.16201584578188
curr_Factors:  [1.10162016e+02 4.18336614e-02]
mat_Sqrt:  [[ 2.25317443e+01  0.00000000e+00]
 [-8.18131153e-03  1.87457397e-02]]
grads:  [ -0.03499293 -29.63127775]
Stock Position:  -0.034992925718680123
Bond Position:  [2.70890974]


portfolio before change:  [-1.26959181]
curr_Stock_Price:  113.7331692403349
curr_Factors:  [1.13733169e+02 3.94100694e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.26959181]
Stock Price:  112.18133418905484
PL:  [-13.450926]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 1.40545080e-02 -2.32357546e-01]
 [ 5.46869800e-02 -9.82365161e-01]
 [ 2.85320997e-01  1.71301829e-01]
 [ 1.81379695e-01  1.38176004e-01]
 [ 2.18073629e-01 -2.07260579e-01]
 [ 7.74948555e-02 -6.11522248e-02]
 [ 2.25450836e-01 -1.71998531e-01]
 [ 1.04404605e-01  4.42971828e-02]
 [ 1.68037275e-02 -5.19282256e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.89304115]
curr_Stock_Price:  98.20622325572758
curr_Factors:  [9.82062233e+01 4.28196243e-02]
mat_Sqrt:  [[ 2.03217187e+01  0.00000000e+00]
 [-8.27716128e-03  1.89653590e-02]]
grads:  [-4.29858519e-03 -1.22516819e+01]
Stock Position:  -0.004298585188253451
Bond Position:  [-9.47089334]


portfolio before change:  [-9.88037283]
curr_Stock_Price:  94.15722716175998
curr_Factors:  [9.41572272e+01 4.63271738e-02]
mat_Sqrt:  [[ 2.02661645e+01  0.00000000e+00]
 [-8.60949929e-03  1.97268411e-02]]
grads:  [-1.84569866e-02 -4.97984019e+01]
Stock Position:  -0.018456986554264105
Bond Position:  [-8.14251415]


portfolio before change:  [-9.87677584]
curr_Stock_Price:  93.74170608973738
curr_Factors:  [9.37417061e+01 4.71525797e-02]
mat_Sqrt:  [[ 2.03556785e+01  0.00000000e+00]
 [-8.68585791e-03  1.99018007e-02]]
grads:  [0.01768957 8.60735329]
Stock Position:  0.01768957220716227
Bond Position:  [-11.53502652]


portfolio before change:  [-9.88991064]
curr_Stock_Price:  93.3253113252401
curr_Factors:  [9.33253113e+01 4.57198997e-02]
mat_Sqrt:  [[ 1.99550161e+01  0.00000000e+00]
 [-8.55288486e-03  1.95971211e-02]]
grads:  [0.01211147 7.05083176]
Stock Position:  0.012111473437742085
Bond Position:  [-11.02021767]


portfolio before change:  [-9.8799537]
curr_Stock_Price:  94.60248253931351
curr_Factors:  [9.46024825e+01 4.83532476e-02]
mat_Sqrt:  [[ 2.08024917e+01  0.00000000e+00]
 [-8.79574875e-03  2.01535922e-02]]
grads:  [ 6.13473127e-03 -1.02840514e+01]
Stock Position:  0.006134731269536964
Bond Position:  [-10.46031451]


portfolio before change:  [-9.86987853]
curr_Stock_Price:  97.09756080701085
curr_Factors:  [9.70975608e+01 5.28850006e-02]
mat_Sqrt:  [[ 2.23292727e+01  0.00000000e+00]
 [-9.19869561e-03  2.10768595e-02]]
grads:  [ 2.27530190e-03 -2.90139168e+00]
Stock Position:  0.002275301901386196
Bond Position:  [-10.09080479]


portfolio before change:  [-9.87125592]
curr_Stock_Price:  98.71021328720961
curr_Factors:  [9.87102133e+01 5.25461261e-02]
mat_Sqrt:  [[ 2.26272848e+01  0.00000000e+00]
 [-9.16917673e-03  2.10092232e-02]]
grads:  [ 6.64615859e-03 -8.18681059e+00]
Stock Position:  0.006646158591513785
Bond Position:  [-10.52729965]


portfolio before change:  [-9.87124102]
curr_Stock_Price:  99.5046373138397
curr_Factors:  [9.95046373e+01 5.21846702e-02]
mat_Sqrt:  [[ 2.27308038e+01  0.00000000e+00]
 [-9.13758569e-03  2.09368391e-02]]
grads:  [0.0054436  2.11575313]
Stock Position:  0.005443603411503875
Bond Position:  [-10.4129048]


portfolio before change:  [-9.88846021]
curr_Stock_Price:  97.29811518156507
curr_Factors:  [9.72981152e+01 5.07319615e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.88846021]
Stock Price:  95.49320316827517
PL:  [-9.88846021]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.85131831e-02 -2.70185410e-01]
 [-1.32580083e-02  7.83489877e-02]
 [ 2.49301028e-01  1.59033655e-01]
 [ 1.74114548e-01  1.58777385e-01]
 [ 2.70681375e-02 -2.48161255e-02]
 [ 7.75493512e-02 -6.28607554e-02]
 [ 1.28893389e-01 -2.74625038e-01]
 [ 5.24800281e-02 -1.24281334e-01]
 [ 6.89772338e-03 -3.81332755e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.48844157]
curr_Stock_Price:  100.00369685292038
curr_Factors:  [1.00003697e+02 3.99717835e-02]
mat_Sqrt:  [[ 1.99936837e+01  0.00000000e+00]
 [-7.99717785e-03  1.83238364e-02]]
grads:  [-8.82437503e-03 -1.47450241e+01]
Stock Position:  -0.008824375031154661
Bond Position:  [3.37091169]


portfolio before change:  [2.49210006]
curr_Stock_Price:  99.78015575752063
curr_Factors:  [9.97801558e+01 3.98189927e-02]
mat_Sqrt:  [[ 1.99108276e+01  0.00000000e+00]
 [-7.98187875e-03  1.82887818e-02]]
grads:  [1.05150292e-03 4.28399161e+00]
Stock Position:  0.0010515029164341824
Bond Position:  [2.38718093]


portfolio before change:  [2.49075106]
curr_Stock_Price:  97.36182357381564
curr_Factors:  [9.73618236e+01 4.26015312e-02]
mat_Sqrt:  [[ 2.00956151e+01  0.00000000e+00]
 [-8.25605535e-03  1.89169993e-02]]
grads:  [0.01585963 8.40691764]
Stock Position:  0.015859629247199067
Bond Position:  [0.94662864]


portfolio before change:  [2.53105416]
curr_Stock_Price:  99.87321028201814
curr_Factors:  [9.98732103e+01 4.01814123e-02]
mat_Sqrt:  [[ 2.00198864e+01  0.00000000e+00]
 [-8.01812071e-03  1.83718225e-02]]
grads:  [0.01215844 8.6424406 ]
Stock Position:  0.012158444611335964
Bond Position:  [1.31675126]


portfolio before change:  [2.52578484]
curr_Stock_Price:  99.38566012820951
curr_Factors:  [9.93856601e+01 3.75918899e-02]
mat_Sqrt:  [[ 1.92695160e+01  0.00000000e+00]
 [-7.75545123e-03  1.77699712e-02]]
grads:  [ 8.42651802e-04 -1.39652030e+00]
Stock Position:  0.0008426518019461729
Bond Position:  [2.44203734]


portfolio before change:  [2.52495454]
curr_Stock_Price:  96.9509307959688
curr_Factors:  [9.69509308e+01 3.81859986e-02]
mat_Sqrt:  [[ 1.89454122e+01  0.00000000e+00]
 [-7.81649524e-03  1.79098405e-02]]
grads:  [ 2.64521393e-03 -3.50984450e+00]
Stock Position:  0.0026452139338597864
Bond Position:  [2.26849859]


portfolio before change:  [2.52275737]
curr_Stock_Price:  95.69140823545443
curr_Factors:  [9.56914082e+01 3.96103166e-02]
mat_Sqrt:  [[ 1.90448301e+01  0.00000000e+00]
 [-7.96093628e-03  1.82407966e-02]]
grads:  [ 4.74522309e-04 -1.50555398e+01]
Stock Position:  0.0004745223086190458
Bond Position:  [2.47734966]


portfolio before change:  [2.52446887]
curr_Stock_Price:  96.68718130237426
curr_Factors:  [9.66871813e+01 3.91050499e-02]
mat_Sqrt:  [[ 1.91198870e+01  0.00000000e+00]
 [-7.90999872e-03  1.81240839e-02]]
grads:  [-9.20922197e-05 -6.85724774e+00]
Stock Position:  -9.209221971079119e-05
Bond Position:  [2.533373]


portfolio before change:  [2.52576787]
curr_Stock_Price:  96.33974334828163
curr_Factors:  [9.63397433e+01 3.90985061e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.52576787]
Stock Price:  95.45896522725309
PL:  [2.52576787]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.36011177e-02 -2.78056861e-01]
 [-1.21216282e-02 -2.16441561e-01]
 [ 2.28692068e-01  1.52014373e-01]
 [ 2.90822507e-02  9.42836903e-02]
 [ 3.06281902e-02 -1.05579221e-02]
 [ 8.75845907e-02 -1.46902401e-01]
 [ 1.45622919e-01  1.03011448e-01]
 [-2.49970229e-01 -2.58064488e-01]
 [ 4.18931575e-02 -5.72764484e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.1315277]
curr_Stock_Price:  97.44572942287415
curr_Factors:  [9.74457294e+01 4.24768029e-02]
mat_Sqrt:  [[ 2.00834686e+01  0.00000000e+00]
 [-8.24396050e-03  1.88892865e-02]]
grads:  [-1.87979706e-03 -1.47203475e+01]
Stock Position:  -0.0018797970649184355
Bond Position:  [-14.9483495]


portfolio before change:  [-15.13905625]
curr_Stock_Price:  97.47366371455774
curr_Factors:  [9.74736637e+01 4.27469111e-02]
mat_Sqrt:  [[ 2.01529979e+01  0.00000000e+00]
 [-8.27013045e-03  1.89492494e-02]]
grads:  [-5.28876501e-03 -1.14221707e+01]
Stock Position:  -0.005288765010248517
Bond Position:  [-14.62354095]


portfolio before change:  [-15.15674344]
curr_Stock_Price:  99.43510252573392
curr_Factors:  [9.94351025e+01 4.16645735e-02]
mat_Sqrt:  [[ 2.02965955e+01  0.00000000e+00]
 [-8.16476072e-03  1.87078170e-02]]
grads:  [0.01453626 8.12571413]
Stock Position:  0.014536259533025193
Bond Position:  [-16.6021579]


portfolio before change:  [-15.12658465]
curr_Stock_Price:  102.08103356505302
curr_Factors:  [1.02081034e+02 3.88245787e-02]
mat_Sqrt:  [[ 2.01139995e+01  0.00000000e+00]
 [-7.88158144e-03  1.80589718e-02]]
grads:  [3.49164902e-03 5.22087811e+00]
Stock Position:  0.0034916490221857405
Bond Position:  [-15.48301579]


portfolio before change:  [-15.1378481]
curr_Stock_Price:  101.0729116933765
curr_Factors:  [1.01072912e+02 4.05203187e-02]
mat_Sqrt:  [[ 2.03456329e+01  0.00000000e+00]
 [-8.05186375e-03  1.84491376e-02]]
grads:  [ 0.00127892 -0.57227185]
Stock Position:  0.0012789150096651084
Bond Position:  [-15.26711177]


portfolio before change:  [-15.14289229]
curr_Stock_Price:  103.09906794929259
curr_Factors:  [1.03099068e+02 3.86019205e-02]
mat_Sqrt:  [[ 2.02562568e+01  0.00000000e+00]
 [-7.85894858e-03  1.80071134e-02]]
grads:  [ 1.15870996e-03 -8.15802058e+00]
Stock Position:  0.001158709956363856
Bond Position:  [-15.2623542]


portfolio before change:  [-15.14808997]
curr_Stock_Price:  105.2008911494388
curr_Factors:  [1.05200891e+02 3.74270146e-02]
mat_Sqrt:  [[ 2.03522305e+01  0.00000000e+00]
 [-7.73842512e-03  1.77309594e-02]]
grads:  [0.00936412 5.80969397]
Stock Position:  0.009364123570398666
Bond Position:  [-16.13320411]


portfolio before change:  [-15.15958995]
curr_Stock_Price:  104.83445410962054
curr_Factors:  [1.04834454e+02 3.75089461e-02]
mat_Sqrt:  [[ 2.03035261e+01  0.00000000e+00]
 [-7.74689058e-03  1.77503562e-02]]
grads:  [ -0.01785891 -14.53855263]
Stock Position:  -0.017858908012908396
Bond Position:  [-13.28736108]


portfolio before change:  [-15.12493292]
curr_Stock_Price:  102.52174975494637
curr_Factors:  [1.02521750e+02 3.83876379e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.12493292]
Stock Price:  101.29165956518526
PL:  [-16.41659248]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.32179202e-02 -3.13129157e-01]
 [-1.07123413e-01  5.64098992e-02]
 [ 2.42086587e-01  1.56576462e-01]
 [ 2.16874396e-01  1.62319300e-01]
 [ 3.59513046e-02 -6.90284552e-02]
 [ 7.76900281e-02 -6.72712025e-02]
 [ 1.34807019e-01 -2.70142032e-01]
 [ 5.56548230e-02 -1.15958858e-01]
 [ 1.44182728e-02 -4.85962679e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.92380871]
curr_Stock_Price:  100.64759835555907
curr_Factors:  [1.00647598e+02 4.49117474e-02]
mat_Sqrt:  [[ 2.13296335e+01  0.00000000e+00]
 [-8.47695676e-03  1.94231480e-02]]
grads:  [-9.37093872e-03 -1.61214422e+01]
Stock Position:  -0.009370938718495491
Bond Position:  [7.86697119]


portfolio before change:  [6.93025775]
curr_Stock_Price:  100.3792609080606
curr_Factors:  [1.00379261e+02 4.78394994e-02]
mat_Sqrt:  [[ 2.19551954e+01  0.00000000e+00]
 [-8.74889702e-03  2.00462414e-02]]
grads:  [-0.00375784  2.81398882]
Stock Position:  -0.0037578401566592265
Bond Position:  [7.30746697]


portfolio before change:  [6.94250562]
curr_Stock_Price:  98.09251559210966
curr_Factors:  [9.80925156e+01 4.63376240e-02]
mat_Sqrt:  [[ 2.11155672e+01  0.00000000e+00]
 [-8.61047028e-03  1.97290659e-02]]
grads:  [0.0147011  7.93633427]
Stock Position:  0.014701104352085138
Bond Position:  [5.50043731]


portfolio before change:  [6.943909]
curr_Stock_Price:  98.0008542082798
curr_Factors:  [9.80008542e+01 4.89950199e-02]
mat_Sqrt:  [[ 2.16923114e+01  0.00000000e+00]
 [-8.85392748e-03  2.02868964e-02]]
grads:  [0.01326352 8.00118934]
Stock Position:  0.013263517249273965
Bond Position:  [5.64407298]


portfolio before change:  [6.94307734]
curr_Stock_Price:  97.72533081604169
curr_Factors:  [9.77253308e+01 4.89112170e-02]
mat_Sqrt:  [[ 2.16128174e+01  0.00000000e+00]
 [-8.84635220e-03  2.02695393e-02]]
grads:  [ 2.69507524e-04 -3.40552660e+00]
Stock Position:  0.0002695075237696145
Bond Position:  [6.91673963]


portfolio before change:  [6.94623676]
curr_Stock_Price:  96.61288687976494
curr_Factors:  [9.66128869e+01 4.76875841e-02]
mat_Sqrt:  [[ 2.10978267e+01  0.00000000e+00]
 [-8.73499483e-03  2.00143875e-02]]
grads:  [ 2.29077947e-03 -3.36114220e+00]
Stock Position:  0.002290779474826512
Bond Position:  [6.72491794]


portfolio before change:  [6.94809543]
curr_Stock_Price:  95.95606574723016
curr_Factors:  [9.59560657e+01 4.72275706e-02]
mat_Sqrt:  [[ 2.08530813e+01  0.00000000e+00]
 [-8.69276210e-03  1.99176202e-02]]
grads:  [ 8.10785250e-04 -1.35629674e+01]
Stock Position:  0.0008107852503752536
Bond Position:  [6.87029566]


portfolio before change:  [6.95348984]
curr_Stock_Price:  98.37150997461914
curr_Factors:  [9.83715100e+01 4.44189257e-02]
mat_Sqrt:  [[ 2.07325806e+01  0.00000000e+00]
 [-8.43031915e-03  1.93162878e-02]]
grads:  [ 2.43396063e-04 -6.00316472e+00]
Stock Position:  0.0002433960633956989
Bond Position:  [6.9295466]


portfolio before change:  [6.95663843]
curr_Stock_Price:  97.06891016281367
curr_Factors:  [9.70689102e+01 4.45713757e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.95663843]
Stock Price:  99.24405854484274
PL:  [6.95663843]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-2.82004122e-02  7.48565112e-02]
 [ 2.55448122e-01  1.61127317e-01]
 [ 2.26499313e-01  1.56686286e-01]
 [ 1.08014200e-01 -1.25646924e-01]
 [ 7.68179371e-02 -3.99297341e-02]
 [ 2.66845404e-01 -1.24260748e-01]
 [-4.26245330e-02  3.50432301e-02]
 [ 3.09775448e-02 -3.13612524e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.65544628]
curr_Stock_Price:  99.1117619815608
curr_Factors:  [9.91117620e+01 3.84633448e-02]
mat_Sqrt:  [[ 1.94378721e+01  0.00000000e+00]
 [-7.84482962e-03  1.79747628e-02]]
grads:  [-6.83604388e-03 -1.05935002e+01]
Stock Position:  -0.006836043878766275
Bond Position:  [-2.97791393]


portfolio before change:  [-3.66218482]
curr_Stock_Price:  99.87963465124595
curr_Factors:  [9.98796347e+01 3.75948595e-02]
mat_Sqrt:  [[ 1.93660558e+01  0.00000000e+00]
 [-7.75575755e-03  1.77706730e-02]]
grads:  [2.30798038e-04 4.21236220e+00]
Stock Position:  0.00023079803821070592
Bond Position:  [-3.68523685]


portfolio before change:  [-3.66475383]
curr_Stock_Price:  96.73433703478428
curr_Factors:  [9.67343370e+01 3.53671449e-02]
mat_Sqrt:  [[ 1.81920089e+01  0.00000000e+00]
 [-7.52246183e-03  1.72361254e-02]]
grads:  [0.0179073  9.34823304]
Stock Position:  0.017907304770692793
Bond Position:  [-5.39700509]


portfolio before change:  [-3.668342]
curr_Stock_Price:  96.68469320292189
curr_Factors:  [9.66846932e+01 3.37527571e-02]
mat_Sqrt:  [[ 1.77628378e+01  0.00000000e+00]
 [-7.34876937e-03  1.68381460e-02]]
grads:  [0.01660111 9.30543577]
Stock Position:  0.01660110941546215
Bond Position:  [-5.27341517]


portfolio before change:  [-3.67478709]
curr_Stock_Price:  96.45532722091282
curr_Factors:  [9.64553272e+01 3.44721160e-02]
mat_Sqrt:  [[ 1.79085404e+01  0.00000000e+00]
 [-7.42666719e-03  1.70166323e-02]]
grads:  [ 2.96938696e-03 -7.38377149e+00]
Stock Position:  0.002969386961850012
Bond Position:  [-3.96120028]


portfolio before change:  [-3.6699629]
curr_Stock_Price:  98.7471443827946
curr_Factors:  [9.87471444e+01 3.40827228e-02]
mat_Sqrt:  [[ 1.82302106e+01  0.00000000e+00]
 [-7.38460267e-03  1.69202503e-02]]
grads:  [ 0.00325784 -2.35987845]
Stock Position:  0.0032578434525198994
Bond Position:  [-3.99166563]


portfolio before change:  [-3.66730792]
curr_Stock_Price:  100.17487005488928
curr_Factors:  [1.00174870e+02 3.74786348e-02]
mat_Sqrt:  [[ 1.93932533e+01  0.00000000e+00]
 [-7.74375979e-03  1.77431827e-02]]
grads:  [ 0.01096327 -7.0032953 ]
Stock Position:  0.010963274928100527
Bond Position:  [-4.76555256]


portfolio before change:  [-3.64569419]
curr_Stock_Price:  102.36373309410773
curr_Factors:  [1.02363733e+02 3.88193075e-02]
mat_Sqrt:  [[ 2.01683332e+01  0.00000000e+00]
 [-7.88104638e-03  1.80577458e-02]]
grads:  [-1.35511513e-03  1.94062041e+00]
Stock Position:  -0.0013551151304494221
Bond Position:  [-3.50697954]


portfolio before change:  [-3.65102957]
curr_Stock_Price:  105.00664646195091
curr_Factors:  [1.05006646e+02 3.86672174e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.65102957]
Stock Price:  106.5319029431681
PL:  [-10.18293251]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.88384901e-02 -2.81498356e-01]
 [-1.09223403e-02 -2.30190732e-01]
 [ 2.32948006e-01  1.53463919e-01]
 [ 2.25258953e-01  1.57413991e-01]
 [ 4.63998486e-02 -2.10970846e-02]
 [ 7.72719225e-02 -5.41629149e-02]
 [ 1.57645829e-01 -2.47820419e-01]
 [ 5.43640381e-02 -1.19342549e-01]
 [ 1.40133094e-02  3.07322812e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.43466896]
curr_Stock_Price:  96.8210237246375
curr_Factors:  [9.68210237e+01 3.81021537e-02]
mat_Sqrt:  [[ 1.88992440e+01  0.00000000e+00]
 [-7.80790919e-03  1.78901674e-02]]
grads:  [-1.79993785e-03 -1.57348084e+01]
Stock Position:  -0.0017999378481149907
Bond Position:  [-19.26039714]


portfolio before change:  [-19.4453868]
curr_Stock_Price:  97.42395238234849
curr_Factors:  [9.74239524e+01 3.95164567e-02]
mat_Sqrt:  [[ 1.93666606e+01  0.00000000e+00]
 [-7.95149865e-03  1.82191722e-02]]
grads:  [-5.75142065e-03 -1.26345329e+01]
Stock Position:  -0.005751420646612447
Bond Position:  [-18.88506067]


portfolio before change:  [-19.46392855]
curr_Stock_Price:  99.00562438277308
curr_Factors:  [9.90056244e+01 4.07602694e-02]
mat_Sqrt:  [[ 1.99884165e+01  0.00000000e+00]
 [-8.07566907e-03  1.85036824e-02]]
grads:  [0.01500495 8.29369611]
Stock Position:  0.01500494806980842
Bond Position:  [-20.94950281]


portfolio before change:  [-19.50685616]
curr_Stock_Price:  96.84298882827972
curr_Factors:  [9.68429888e+01 4.20876087e-02]
mat_Sqrt:  [[ 1.98675955e+01  0.00000000e+00]
 [-8.20610589e-03  1.88025507e-02]]
grads:  [0.01479596 8.37194876]
Stock Position:  0.014795955092311474
Bond Position:  [-20.93974067]


portfolio before change:  [-19.47091885]
curr_Stock_Price:  99.97964320275214
curr_Factors:  [9.99796432e+01 4.14663975e-02]
mat_Sqrt:  [[ 2.03591544e+01  0.00000000e+00]
 [-8.14531989e-03  1.86632725e-02]]
grads:  [ 0.00182681 -1.1304065 ]
Stock Position:  0.0018268109406870496
Bond Position:  [-19.65356276]


portfolio before change:  [-19.48502954]
curr_Stock_Price:  97.63596954049181
curr_Factors:  [9.76359695e+01 4.09986983e-02]
mat_Sqrt:  [[ 1.97694632e+01  0.00000000e+00]
 [-8.09925412e-03  1.85577225e-02]]
grads:  [ 2.71293600e-03 -2.91861864e+00]
Stock Position:  0.002712936000826983
Bond Position:  [-19.74990967]


portfolio before change:  [-19.49717092]
curr_Stock_Price:  96.80146473684154
curr_Factors:  [9.68014647e+01 3.85154679e-02]
mat_Sqrt:  [[ 1.89976341e+01  0.00000000e+00]
 [-7.85014322e-03  1.79869378e-02]]
grads:  [ 2.60496288e-03 -1.37777993e+01]
Stock Position:  0.0026049628793935672
Bond Position:  [-19.74933514]


portfolio before change:  [-19.51519704]
curr_Stock_Price:  93.673210667963
curr_Factors:  [9.36732107e+01 3.99413092e-02]
mat_Sqrt:  [[ 1.87208927e+01  0.00000000e+00]
 [-7.99412876e-03  1.83168501e-02]]
grads:  [ 1.21718533e-04 -6.51545153e+00]
Stock Position:  0.00012171853262616419
Bond Position:  [-19.52659881]


portfolio before change:  [-19.52503226]
curr_Stock_Price:  93.1023721766647
curr_Factors:  [9.31023722e+01 3.92695063e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.52503226]
Stock Price:  94.06358779811445
PL:  [-19.52503226]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.67666823e-02 -3.45521432e-01]
 [-2.76405630e-01 -1.07046383e-03]
 [ 2.37362729e-01  1.54967546e-01]
 [ 2.06891081e-01  1.64443167e-01]
 [ 7.40360650e-03 -3.48761122e-03]
 [ 8.84867691e-02 -1.63251400e-01]
 [ 1.36586753e-01  1.59851288e-01]
 [-5.17934748e-01 -5.33334486e-01]
 [ 2.06134027e-02  1.95546845e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.97058854]
curr_Stock_Price:  101.38026129215363
curr_Factors:  [1.01380261e+02 3.96464606e-02]
mat_Sqrt:  [[ 2.01862486e+01  0.00000000e+00]
 [-7.96456759e-03  1.82491169e-02]]
grads:  [-1.07778618e-02 -1.89335974e+01]
Stock Position:  -0.010777861836145416
Bond Position:  [13.06325099]


portfolio before change:  [11.97620775]
curr_Stock_Price:  101.46506881118948
curr_Factors:  [1.01465069e+02 3.67055801e-02]
mat_Sqrt:  [[ 1.94393885e+01  0.00000000e+00]
 [-7.66348016e-03  1.75592390e-02]]
grads:  [-0.01424288 -0.060963  ]
Stock Position:  -0.014242876952180194
Bond Position:  [13.42136224]


portfolio before change:  [12.02435646]
curr_Stock_Price:  98.55580055307027
curr_Factors:  [9.85558006e+01 3.62468601e-02]
mat_Sqrt:  [[ 1.87636527e+01  0.00000000e+00]
 [-7.61544326e-03  1.74491726e-02]]
grads:  [0.01625462 8.88108273]
Stock Position:  0.016254623528286195
Bond Position:  [10.42236903]


portfolio before change:  [12.03486915]
curr_Stock_Price:  98.88187424441531
curr_Factors:  [9.88818742e+01 3.40148744e-02]
mat_Sqrt:  [[ 1.82369046e+01  0.00000000e+00]
 [-7.37724875e-03  1.69034004e-02]]
grads:  [0.01528    9.72840747]
Stock Position:  0.015280003344787537
Bond Position:  [10.52395378]


portfolio before change:  [12.08434685]
curr_Stock_Price:  101.77548673430542
curr_Factors:  [1.01775487e+02 3.36721226e-02]
mat_Sqrt:  [[ 1.86757665e+01  0.00000000e+00]
 [-7.33998611e-03  1.68180210e-02]]
grads:  [ 0.00031493 -0.20737346]
Stock Position:  0.00031492620026641856
Bond Position:  [12.05229509]


portfolio before change:  [12.09033334]
curr_Stock_Price:  101.64476774092441
curr_Factors:  [1.01644768e+02 3.32831885e-02]
mat_Sqrt:  [[ 1.85437468e+01  0.00000000e+00]
 [-7.29747227e-03  1.67206095e-02]]
grads:  [ 9.29586517e-04 -9.76348376e+00]
Stock Position:  0.0009295865169332011
Bond Position:  [11.99584574]


portfolio before change:  [12.10183504]
curr_Stock_Price:  107.56382434478459
curr_Factors:  [1.07563824e+02 3.29460814e-02]
mat_Sqrt:  [[ 1.95239694e+01  0.00000000e+00]
 [-7.26042219e-03  1.66357171e-02]]
grads:  [0.01056914 9.60892079]
Stock Position:  0.010569140432874219
Bond Position:  [10.96497787]


portfolio before change:  [12.12892957]
curr_Stock_Price:  109.60851929711608
curr_Factors:  [1.09608519e+02 3.03289323e-02]
mat_Sqrt:  [[ 1.90885470e+01  0.00000000e+00]
 [-6.96608152e-03  1.59612979e-02]]
grads:  [ -0.0393273 -33.4142304]
Stock Position:  -0.03932729925120776
Bond Position:  [16.43953661]


portfolio before change:  [12.15177843]
curr_Stock_Price:  109.2365884334173
curr_Factors:  [1.09236588e+02 2.96206997e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.15177843]
Stock Price:  110.43333973050034
PL:  [1.7184387]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.01208610e-02 -3.76137596e-01]
 [-9.83037047e-02  5.84713229e-02]
 [ 1.98192778e-01  1.45819448e-01]
 [ 4.31470189e-02  1.02978328e-01]
 [-9.45428422e-02 -6.74971054e-03]
 [ 8.75179451e-02 -1.45694670e-01]
 [ 2.25584222e-01 -9.99693185e-02]
 [-1.33783566e-01 -5.78778764e-02]
 [ 2.46774768e-02 -3.54316095e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.74165632]
curr_Stock_Price:  102.07289791415364
curr_Factors:  [1.02072898e+02 3.71909372e-02]
mat_Sqrt:  [[ 1.96847093e+01  0.00000000e+00]
 [-7.71398078e-03  1.76749504e-02]]
grads:  [-1.19016625e-02 -2.12808289e+01]
Stock Position:  -0.011901662466316637
Bond Position:  [17.9564935]


portfolio before change:  [16.77134197]
curr_Stock_Price:  100.33321150907453
curr_Factors:  [1.00333212e+02 3.83553993e-02]
mat_Sqrt:  [[ 1.96497925e+01  0.00000000e+00]
 [-7.83381381e-03  1.79495224e-02]]
grads:  [-0.0037041   3.25754199]
Stock Position:  -0.0037040964870624325
Bond Position:  [17.14298587]


portfolio before change:  [16.78043834]
curr_Stock_Price:  100.19208939677887
curr_Factors:  [1.00192089e+02 3.88910026e-02]
mat_Sqrt:  [[ 1.97586834e+01  0.00000000e+00]
 [-7.88832074e-03  1.80744135e-02]]
grads:  [0.01325157 8.06772783]
Stock Position:  0.01325157134337851
Bond Position:  [15.45273572]


portfolio before change:  [16.81034475]
curr_Stock_Price:  101.865710603637
curr_Factors:  [1.01865711e+02 3.68721161e-02]
mat_Sqrt:  [[ 1.95603693e+01  0.00000000e+00]
 [-7.68084538e-03  1.75990277e-02]]
grads:  [4.50351649e-03 5.85136461e+00]
Stock Position:  0.004503516489981768
Bond Position:  [16.35159084]


portfolio before change:  [16.82914158]
curr_Stock_Price:  104.22364502739521
curr_Factors:  [1.04223645e+02 3.61466799e-02]
mat_Sqrt:  [[ 1.98152915e+01  0.00000000e+00]
 [-7.60491209e-03  1.74250427e-02]]
grads:  [-0.00491987 -0.3873569 ]
Stock Position:  -0.0049198699714894795
Bond Position:  [17.34190836]


portfolio before change:  [16.84281883]
curr_Stock_Price:  103.20652021626496
curr_Factors:  [1.03206520e+02 3.89764463e-02]
mat_Sqrt:  [[ 2.03754991e+01  0.00000000e+00]
 [-7.89698133e-03  1.80942574e-02]]
grads:  [ 1.17452722e-03 -8.05198394e+00]
Stock Position:  0.0011745272188755508
Bond Position:  [16.72159996]


portfolio before change:  [16.84924856]
curr_Stock_Price:  101.56061439253385
curr_Factors:  [1.01560614e+02 4.02477430e-02]
mat_Sqrt:  [[ 2.03749281e+01  0.00000000e+00]
 [-8.02473606e-03  1.83869802e-02]]
grads:  [ 0.00893029 -5.43696231]
Stock Position:  0.008930290851726332
Bond Position:  [15.94228273]


portfolio before change:  [16.87696849]
curr_Stock_Price:  103.77183046202929
curr_Factors:  [1.03771830e+02 4.16557142e-02]
mat_Sqrt:  [[ 2.11795520e+01  0.00000000e+00]
 [-8.16389262e-03  1.87058279e-02]]
grads:  [-0.0075093  -3.09410931]
Stock Position:  -0.007509296803723203
Bond Position:  [17.65622197]


portfolio before change:  [16.85886251]
curr_Stock_Price:  107.35889085032325
curr_Factors:  [1.07358891e+02 4.02591085e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.85886251]
Stock Price:  107.01578726578809
PL:  [9.84307524]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-6.62267477e-02  6.59686452e-02]
 [ 2.06752427e-01  1.55090682e-01]
 [ 9.40442268e-02  1.29528288e-01]
 [-3.91210533e-02 -3.32550066e-03]
 [ 8.80606580e-02 -1.55529547e-01]
 [ 1.95953510e-01 -4.73209008e-02]
 [-1.58619429e-01 -1.02083623e-01]
 [ 2.49391560e-02 -4.87808499e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.0476653]
curr_Stock_Price:  98.76447316157592
curr_Factors:  [9.87644732e+01 4.03561796e-02]
mat_Sqrt:  [[ 1.98406445e+01  0.00000000e+00]
 [-8.03553902e-03  1.84117329e-02]]
grads:  [-6.69726970e-03 -1.03420821e+01]
Stock Position:  -0.006697269698944679
Bond Position:  [-5.38621299]


portfolio before change:  [-6.05945243]
curr_Stock_Price:  100.12224183711228
curr_Factors:  [1.00122242e+02 4.09290066e-02]
mat_Sqrt:  [[ 2.02556492e+01  0.00000000e+00]
 [-8.09236742e-03  1.85419431e-02]]
grads:  [-1.84815950e-03  3.55780647e+00]
Stock Position:  -0.0018481595037494717
Bond Position:  [-5.87441055]


portfolio before change:  [-6.06226335]
curr_Stock_Price:  100.05351788711705
curr_Factors:  [1.00053518e+02 4.02442767e-02]
mat_Sqrt:  [[ 2.00717124e+01  0.00000000e+00]
 [-8.02439049e-03  1.83861884e-02]]
grads:  [0.01367295 8.43517312]
Stock Position:  0.013672951492924993
Bond Position:  [-7.43029025]


portfolio before change:  [-6.04967998]
curr_Stock_Price:  101.24561229500559
curr_Factors:  [1.01245612e+02 4.04299998e-02]
mat_Sqrt:  [[ 2.03576705e+01  0.00000000e+00]
 [-8.04288503e-03  1.84285647e-02]]
grads:  [0.00739648 7.02866936]
Stock Position:  0.007396475273155689
Bond Position:  [-6.79854065]


portfolio before change:  [-6.04089735]
curr_Stock_Price:  102.89271360380614
curr_Factors:  [1.02892714e+02 4.15200638e-02]
mat_Sqrt:  [[ 2.09659057e+01  0.00000000e+00]
 [-8.15058906e-03  1.86753457e-02]]
grads:  [-0.00193516 -0.17806903]
Stock Position:  -0.0019351618508011209
Bond Position:  [-5.8417833]


portfolio before change:  [-6.04272407]
curr_Stock_Price:  102.32691892576887
curr_Factors:  [1.02326919e+02 4.00789915e-02]
mat_Sqrt:  [[ 2.04855812e+01  0.00000000e+00]
 [-8.00789525e-03  1.83483931e-02]]
grads:  [ 9.85180681e-04 -8.47646692e+00]
Stock Position:  0.000985180681405782
Bond Position:  [-6.14353457]


portfolio before change:  [-6.04575944]
curr_Stock_Price:  102.36464292066981
curr_Factors:  [1.02364643e+02 3.92223562e-02]
mat_Sqrt:  [[ 2.02729438e+01  0.00000000e+00]
 [-7.92185395e-03  1.81512477e-02]]
grads:  [ 0.00864704 -2.60703295]
Stock Position:  0.008647040991443292
Bond Position:  [-6.9309107]


portfolio before change:  [-6.03514366]
curr_Stock_Price:  103.99318904444381
curr_Factors:  [1.03993189e+02 3.60967628e-02]
mat_Sqrt:  [[ 1.97578200e+01  0.00000000e+00]
 [-7.59965923e-03  1.74130068e-02]]
grads:  [-0.01028314 -5.86249258]
Stock Position:  -0.010283137245241492
Bond Position:  [-4.96576742]


portfolio before change:  [-6.07105874]
curr_Stock_Price:  107.24429612072751
curr_Factors:  [1.07244296e+02 3.35391472e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.07105874]
Stock Price:  102.05629878034381
PL:  [-8.12735752]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-2.66689345e-02  5.52631060e-02]
 [ 1.50906767e-01  9.46024347e-02]
 [ 2.43701799e-02  9.13707559e-02]
 [ 1.04631336e-01 -1.23311863e-01]
 [ 7.71471483e-02 -5.02510417e-02]
 [ 2.14680714e-01 -1.83862070e-01]
 [ 5.25196129e-02 -1.24177565e-01]
 [ 4.77305464e-02 -8.00553920e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.93631298]
curr_Stock_Price:  99.07098734396025
curr_Factors:  [9.90709873e+01 4.18941616e-02]
mat_Sqrt:  [[ 2.02779124e+01  0.00000000e+00]
 [-8.18722533e-03  1.87592899e-02]]
grads:  [-6.55285141e-03 -1.01504724e+01]
Stock Position:  -0.006552851405750269
Bond Position:  [-3.28711552]


portfolio before change:  [-3.93603799]
curr_Stock_Price:  98.77814328049465
curr_Factors:  [9.87781433e+01 3.89308025e-02]
mat_Sqrt:  [[ 1.94898069e+01  0.00000000e+00]
 [-7.89235605e-03  1.80836595e-02]]
grads:  [-1.30844687e-04  3.05596918e+00]
Stock Position:  -0.00013084468721508025
Bond Position:  [-3.92311339]


portfolio before change:  [-3.93823555]
curr_Stock_Price:  100.57809743161705
curr_Factors:  [1.00578097e+02 4.01057468e-02]
mat_Sqrt:  [[ 2.01421915e+01  0.00000000e+00]
 [-8.01056770e-03  1.83545164e-02]]
grads:  [0.00954189 5.15417745]
Stock Position:  0.00954189393253774
Bond Position:  [-4.89794108]


portfolio before change:  [-3.92565558]
curr_Stock_Price:  102.15320958120765
curr_Factors:  [1.02153210e+02 3.96667139e-02]
mat_Sqrt:  [[ 2.03453483e+01  0.00000000e+00]
 [-7.96660167e-03  1.82537776e-02]]
grads:  [3.15785438e-03 5.00558065e+00]
Stock Position:  0.0031578543763116592
Bond Position:  [-4.24824054]


portfolio before change:  [-3.94560396]
curr_Stock_Price:  96.50895626601854
curr_Factors:  [9.65089563e+01 4.32062543e-02]
mat_Sqrt:  [[ 2.00604618e+01  0.00000000e+00]
 [-8.31444567e-03  1.90507883e-02]]
grads:  [ 2.53302378e-03 -6.47279584e+00]
Stock Position:  0.0025330237826672367
Bond Position:  [-4.19006344]


portfolio before change:  [-3.94406014]
curr_Stock_Price:  97.94572829334182
curr_Factors:  [9.79457283e+01 4.42110495e-02]
mat_Sqrt:  [[ 2.05944838e+01  0.00000000e+00]
 [-8.41056949e-03  1.92710357e-02]]
grads:  [ 0.0026811  -2.60759424]
Stock Position:  0.0026810963626639887
Bond Position:  [-4.20666207]


portfolio before change:  [-3.94492333]
curr_Stock_Price:  98.40847406349724
curr_Factors:  [9.84084741e+01 4.56210933e-02]
mat_Sqrt:  [[ 2.10191593e+01  0.00000000e+00]
 [-8.54363794e-03  1.95759338e-02]]
grads:  [ 6.39591367e-03 -9.39225028e+00]
Stock Position:  0.006395913673103723
Bond Position:  [-4.57433543]


portfolio before change:  [-3.95414445]
curr_Stock_Price:  97.32444045469533
curr_Factors:  [9.73244405e+01 4.57453723e-02]
mat_Sqrt:  [[ 2.08159147e+01  0.00000000e+00]
 [-8.55526713e-03  1.96025796e-02]]
grads:  [-8.05114633e-05 -6.33475633e+00]
Stock Position:  -8.051146328997637e-05
Bond Position:  [-3.94630872]


portfolio before change:  [-3.95628299]
curr_Stock_Price:  99.37251833013953
curr_Factors:  [9.93725183e+01 4.82234132e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.95628299]
Stock Price:  93.96077980211446
PL:  [-3.95628299]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.57007292e-02 -3.35791660e-01]
 [-9.50541289e-02  5.92308437e-02]
 [-8.42563462e-02 -1.60110368e-01]
 [ 2.10422058e-01  1.64393261e-01]
 [ 1.97917532e-03 -4.15385151e-02]
 [ 7.73108125e-02 -5.53821800e-02]
 [ 1.17105570e-01 -2.84203744e-01]
 [ 5.38086207e-02 -1.20798532e-01]
 [ 8.46849472e-03 -4.03182822e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.45371619]
curr_Stock_Price:  101.1600503492497
curr_Factors:  [1.01160050e+02 3.88438726e-02]
mat_Sqrt:  [[ 1.99374815e+01  0.00000000e+00]
 [-7.88353957e-03  1.80634584e-02]]
grads:  [-1.06458895e-02 -1.85895554e+01]
Stock Position:  -0.010645889479222587
Bond Position:  [11.53065491]


portfolio before change:  [10.46848571]
curr_Stock_Price:  100.31439584889682
curr_Factors:  [1.00314396e+02 3.64369617e-02]
mat_Sqrt:  [[ 1.91484815e+01  0.00000000e+00]
 [-7.63538726e-03  1.74948700e-02]]
grads:  [-0.00361406  3.3856121 ]
Stock Position:  -0.003614055209120071
Bond Position:  [10.83102747]


portfolio before change:  [10.46874972]
curr_Stock_Price:  101.74017735989459
curr_Factors:  [1.01740177e+02 3.46833537e-02]
mat_Sqrt:  [[ 1.89475487e+01  0.00000000e+00]
 [-7.44938695e-03  1.70686898e-02]]
grads:  [-8.13478522e-03 -9.38035489e+00]
Stock Position:  -0.00813478522243697
Bond Position:  [11.29638421]


portfolio before change:  [10.499315]
curr_Stock_Price:  98.67732145648215
curr_Factors:  [9.86773215e+01 3.64484362e-02]
mat_Sqrt:  [[ 1.88389547e+01  0.00000000e+00]
 [-7.63658941e-03  1.74976245e-02]]
grads:  [0.01497796 9.39517596]
Stock Position:  0.014977962586532383
Bond Position:  [9.02132977]


portfolio before change:  [10.49875731]
curr_Stock_Price:  98.3388585228688
curr_Factors:  [9.83388585e+01 3.57846363e-02]
mat_Sqrt:  [[ 1.86025922e+01  0.00000000e+00]
 [-7.56673100e-03  1.73375588e-02]]
grads:  [-8.68143467e-04 -2.39586874e+00]
Stock Position:  -0.0008681434673644527
Bond Position:  [10.58412955]


portfolio before change:  [10.50474707]
curr_Stock_Price:  97.53671513862226
curr_Factors:  [9.75367151e+01 3.68229585e-02]
mat_Sqrt:  [[ 1.87166218e+01  0.00000000e+00]
 [-7.67572365e-03  1.75872923e-02]]
grads:  [ 2.83919012e-03 -3.14898843e+00]
Stock Position:  0.0028391901174594065
Bond Position:  [10.2278218]


portfolio before change:  [10.50314487]
curr_Stock_Price:  95.17076175401016
curr_Factors:  [9.51707618e+01 3.60477032e-02]
mat_Sqrt:  [[ 1.80693423e+01  0.00000000e+00]
 [-7.59449308e-03  1.74011697e-02]]
grads:  [-3.83584143e-04 -1.63324506e+01]
Stock Position:  -0.00038358414341078836
Bond Position:  [10.53965087]


portfolio before change:  [10.50867791]
curr_Stock_Price:  94.48799454762785
curr_Factors:  [9.44879945e+01 3.89975792e-02]
mat_Sqrt:  [[ 1.86593047e+01  0.00000000e+00]
 [-7.89912190e-03  1.80991620e-02]]
grads:  [ 5.82990142e-05 -6.67426106e+00]
Stock Position:  5.8299014219856594e-05
Bond Position:  [10.50316936]


portfolio before change:  [10.51404765]
curr_Stock_Price:  96.49209280588339
curr_Factors:  [9.64920928e+01 4.01292430e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.51404765]
Stock Price:  95.87429016547397
PL:  [10.51404765]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.34813055e-02 -3.15533277e-01]
 [-2.71806868e-02  7.50948509e-02]
 [ 2.27445068e-01  1.51589653e-01]
 [ 2.14576347e-01  1.63662565e-01]
 [ 1.00112696e-02 -3.40048722e-03]
 [ 2.52889490e-01 -3.21737324e-04]
 [ 1.48260415e-01  8.64209120e-02]
 [-4.08223148e-01 -4.29242198e-01]
 [ 2.27557650e-02  7.17643549e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.29616736]
curr_Stock_Price:  100.70165527686885
curr_Factors:  [1.00701655e+02 3.90079507e-02]
mat_Sqrt:  [[ 1.98890105e+01  0.00000000e+00]
 [-7.90017222e-03  1.81015686e-02]]
grads:  [-1.01157027e-02 -1.74312671e+01]
Stock Position:  -0.01011570272243052
Bond Position:  [8.31483536]


portfolio before change:  [7.30872617]
curr_Stock_Price:  99.87122807706241
curr_Factors:  [9.98712281e+01 3.91254866e-02]
mat_Sqrt:  [[ 1.97546921e+01  0.00000000e+00]
 [-7.91206538e-03  1.81288192e-02]]
grads:  [2.83142508e-04 4.14229133e+00]
Stock Position:  0.0002831425079731623
Bond Position:  [7.28044838]


portfolio before change:  [7.31227906]
curr_Stock_Price:  99.55956238333029
curr_Factors:  [9.95595624e+01 4.07894406e-02]
mat_Sqrt:  [[ 2.01074433e+01  0.00000000e+00]
 [-8.07855835e-03  1.85103026e-02]]
grads:  [0.01460177 8.1894746 ]
Stock Position:  0.014601767669291402
Bond Position:  [5.85853346]


portfolio before change:  [7.29719325]
curr_Stock_Price:  98.32575271474775
curr_Factors:  [9.83257527e+01 4.66387310e-02]
mat_Sqrt:  [[ 2.12344317e+01  0.00000000e+00]
 [-8.63840087e-03  1.97930629e-02]]
grads:  [0.01346891 8.26868309]
Stock Position:  0.013468905123702107
Bond Position:  [5.97285302]


portfolio before change:  [7.34580119]
curr_Stock_Price:  101.71287045915156
curr_Factors:  [1.01712870e+02 4.41421365e-02]
mat_Sqrt:  [[ 2.13699047e+01  0.00000000e+00]
 [-8.40401204e-03  1.92560107e-02]]
grads:  [ 0.00039903 -0.17659355]
Stock Position:  0.0003990272985698012
Bond Position:  [7.30521498]


portfolio before change:  [7.35113692]
curr_Stock_Price:  105.92864304792711
curr_Factors:  [1.05928643e+02 4.27631112e-02]
mat_Sqrt:  [[ 2.19052421e+01  0.00000000e+00]
 [-8.27169741e-03  1.89528397e-02]]
grads:  [ 0.01153829 -0.01697568]
Stock Position:  0.01153829168188773
Bond Position:  [6.12890134]


portfolio before change:  [7.33766867]
curr_Stock_Price:  104.49572142273975
curr_Factors:  [1.04495721e+02 4.57101907e-02]
mat_Sqrt:  [[ 2.23411243e+01  0.00000000e+00]
 [-8.55197668e-03  1.95950402e-02]]
grads:  [0.00832445 4.41034624]
Stock Position:  0.00832445093950854
Bond Position:  [6.46779917]


portfolio before change:  [7.36608058]
curr_Stock_Price:  107.5202091897343
curr_Factors:  [1.07520209e+02 4.35300103e-02]
mat_Sqrt:  [[ 2.24328517e+01  0.00000000e+00]
 [-8.34553872e-03  1.91220314e-02]]
grads:  [ -0.02654856 -22.44752074]
Stock Position:  -0.026548555162006295
Bond Position:  [10.22058679]


portfolio before change:  [7.35212551]
curr_Stock_Price:  108.23838937301036
curr_Factors:  [1.08238389e+02 4.50641610e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.35212551]
Stock Price:  111.06129237917034
PL:  [-3.70916687]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.61742661e-02 -3.40113995e-01]
 [-4.38534818e-01 -1.03773743e-01]
 [ 2.34903374e-01  1.54129905e-01]
 [ 5.81456370e-02  1.12250258e-01]
 [ 4.25952370e-02 -1.90991156e-02]
 [ 8.39452087e-02 -1.12163128e-01]
 [ 1.87310353e-01 -2.58346842e-02]
 [-3.26459963e-01 -3.56815809e-01]
 [ 2.42469106e-02 -1.00530653e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.12679523]
curr_Stock_Price:  101.25776415512775
curr_Factors:  [1.01257764e+02 3.72695469e-02]
mat_Sqrt:  [[ 1.95481377e+01  0.00000000e+00]
 [-7.72212892e-03  1.76936202e-02]]
grads:  [-1.09786511e-02 -1.92224085e+01]
Stock Position:  -0.010978651057126981
Bond Position:  [12.23846889]


portfolio before change:  [11.11695459]
curr_Stock_Price:  102.71162300728295
curr_Factors:  [1.02711623e+02 3.77524291e-02]
mat_Sqrt:  [[ 1.99568523e+01  0.00000000e+00]
 [-7.77199373e-03  1.78078748e-02]]
grads:  [-0.02424357 -5.82740752]
Stock Position:  -0.024243572384567112
Bond Position:  [13.60705125]


portfolio before change:  [11.21847233]
curr_Stock_Price:  98.80491662593124
curr_Factors:  [9.88049166e+01 3.75436776e-02]
mat_Sqrt:  [[ 1.91446293e+01  0.00000000e+00]
 [-7.75047639e-03  1.77585724e-02]]
grads:  [0.0157836  8.67918331]
Stock Position:  0.01578360042157955
Bond Position:  [9.65897501]


portfolio before change:  [11.2679956]
curr_Stock_Price:  101.63649958983352
curr_Factors:  [1.01636500e+02 3.68603254e-02]
mat_Sqrt:  [[ 1.95132353e+01  0.00000000e+00]
 [-7.67961722e-03  1.75962136e-02]]
grads:  [5.49041018e-03 6.37922795e+00]
Stock Position:  0.0054904101822174705
Bond Position:  [10.70996953]


portfolio before change:  [11.26712926]
curr_Stock_Price:  100.50312909624569
curr_Factors:  [1.00503129e+02 3.75531217e-02]
mat_Sqrt:  [[ 1.94761273e+01  0.00000000e+00]
 [-7.75145113e-03  1.77608058e-02]]
grads:  [ 0.00175906 -1.07535186]
Stock Position:  0.0017590611795243172
Bond Position:  [11.0903381]


portfolio before change:  [11.27272981]
curr_Stock_Price:  100.53382536772818
curr_Factors:  [1.00533825e+02 3.97962876e-02]
mat_Sqrt:  [[ 2.00554998e+01  0.00000000e+00]
 [-7.97960276e-03  1.82835668e-02]]
grads:  [ 1.74481847e-03 -6.13464150e+00]
Stock Position:  0.001744818474712462
Bond Position:  [11.09731653]


portfolio before change:  [11.28206372]
curr_Stock_Price:  102.70245278223382
curr_Factors:  [1.02702453e+02 3.70736934e-02]
mat_Sqrt:  [[ 1.97748748e+01  0.00000000e+00]
 [-7.70181209e-03  1.76470684e-02]]
grads:  [ 0.00890196 -1.46396464]
Stock Position:  0.008901961427994282
Bond Position:  [10.36781044]


portfolio before change:  [11.31609245]
curr_Stock_Price:  105.94258544831402
curr_Factors:  [1.05942585e+02 3.64472764e-02]
mat_Sqrt:  [[ 2.02256789e+01  0.00000000e+00]
 [-7.63646791e-03  1.74973461e-02]]
grads:  [ -0.02384034 -20.39256731]
Stock Position:  -0.023840344374466957
Bond Position:  [13.84180017]


portfolio before change:  [11.28441767]
curr_Stock_Price:  107.56158117447495
curr_Factors:  [1.07561581e+02 3.47192078e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.28441767]
Stock Price:  108.84866164378197
PL:  [2.43575602]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-3.59305261e-02  4.27525958e-02]
 [ 2.54101088e-01  1.60668525e-01]
 [ 2.04088658e-01  1.64482775e-01]
 [ 3.34181854e-02 -1.25482738e-02]
 [ 8.14670222e-02 -8.35698977e-02]
 [ 2.53926946e-01 -1.39264706e-01]
 [ 5.15035073e-02 -1.26841206e-01]
 [ 5.00145125e-02 -7.65576847e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.38432442]
curr_Stock_Price:  98.86077323761849
curr_Factors:  [9.88607732e+01 3.95242770e-02]
mat_Sqrt:  [[ 1.96542271e+01  0.00000000e+00]
 [-7.95228541e-03  1.82209749e-02]]
grads:  [-6.76079228e-03 -1.04503549e+01]
Stock Position:  -0.006760792278884038
Bond Position:  [-4.71594726]


portfolio before change:  [-5.38495821]
curr_Stock_Price:  98.60566030302495
curr_Factors:  [9.86056603e+01 3.94345633e-02]
mat_Sqrt:  [[ 1.95812478e+01  0.00000000e+00]
 [-7.94325508e-03  1.82002838e-02]]
grads:  [-8.82056328e-04  2.34900709e+00]
Stock Position:  -0.0008820563284013078
Bond Position:  [-5.29798247]


portfolio before change:  [-5.38608017]
curr_Stock_Price:  96.87368215010137
curr_Factors:  [9.68736822e+01 3.84759858e-02]
mat_Sqrt:  [[ 1.90020600e+01  0.00000000e+00]
 [-7.84611861e-03  1.79777162e-02]]
grads:  [0.0170625 8.9370932]
Stock Position:  0.017062496456609483
Bond Position:  [-7.03898702]


portfolio before change:  [-5.35271605]
curr_Stock_Price:  99.03541116540279
curr_Factors:  [9.90354112e+01 3.69317942e-02]
mat_Sqrt:  [[ 1.90322754e+01  0.00000000e+00]
 [-7.68705865e-03  1.76132641e-02]]
grads:  [0.0144951 9.3385743]
Stock Position:  0.014495104803736914
Bond Position:  [-6.78824471]


portfolio before change:  [-5.32846595]
curr_Stock_Price:  100.94261117458373
curr_Factors:  [1.00942611e+02 3.77873661e-02]
mat_Sqrt:  [[ 1.96222067e+01  0.00000000e+00]
 [-7.77558909e-03  1.78161128e-02]]
grads:  [ 0.00142398 -0.70432164]
Stock Position:  0.0014239820344153456
Bond Position:  [-5.47220642]


portfolio before change:  [-5.33235965]
curr_Stock_Price:  100.13016537965521
curr_Factors:  [1.00130165e+02 3.55531737e-02]
mat_Sqrt:  [[ 1.88800926e+01  0.00000000e+00]
 [-7.54221969e-03  1.72813963e-02]]
grads:  [ 2.38315190e-03 -4.83583017e+00]
Stock Position:  0.0023831519035025822
Bond Position:  [-5.57098504]


portfolio before change:  [-5.33660237]
curr_Stock_Price:  99.51898730727666
curr_Factors:  [9.95189873e+01 3.51926240e-02]
mat_Sqrt:  [[ 1.86694607e+01  0.00000000e+00]
 [-7.50387889e-03  1.71935465e-02]]
grads:  [ 0.0103456  -8.09982432]
Stock Position:  0.010345603910900687
Bond Position:  [-6.36618639]


portfolio before change:  [-5.35451987]
curr_Stock_Price:  98.09484504155498
curr_Factors:  [9.80948450e+01 3.72107202e-02]
mat_Sqrt:  [[ 1.89225745e+01  0.00000000e+00]
 [-7.71603216e-03  1.76796507e-02]]
grads:  [-2.03700277e-04 -7.17441812e+00]
Stock Position:  -0.0002037002768127591
Bond Position:  [-5.33453792]


portfolio before change:  [-5.35771278]
curr_Stock_Price:  100.67205497477785
curr_Factors:  [1.00672055e+02 3.67165644e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.35771278]
Stock Price:  102.10003464494858
PL:  [-7.45774743]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.56063256e-02 -2.43652291e-01]
 [-1.05374109e-01  5.68187628e-02]
 [ 2.09599956e-01  1.58174933e-01]
 [-2.26293399e-02  6.23163290e-02]
 [ 3.89867688e-02 -1.65230165e-02]
 [ 8.20412810e-02 -9.01985253e-02]
 [ 2.63589141e-01 -1.26693313e-01]
 [-5.24856457e-02  7.26278002e-02]
 [ 3.97024716e-02 -5.20754528e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.62132799]
curr_Stock_Price:  99.73263986876002
curr_Factors:  [9.97326399e+01 4.04611130e-02]
mat_Sqrt:  [[ 2.00611686e+01  0.00000000e+00]
 [-8.04597917e-03  1.84356543e-02]]
grads:  [-8.07255583e-03 -1.32163625e+01]
Stock Position:  -0.008072555826123217
Bond Position:  [1.42642529]


portfolio before change:  [0.61683157]
curr_Stock_Price:  100.37801200009935
curr_Factors:  [1.00378012e+02 3.92382983e-02]
mat_Sqrt:  [[ 1.98835384e+01  0.00000000e+00]
 [-7.92346372e-03  1.81549361e-02]]
grads:  [-0.00405242  3.1296592 ]
Stock Position:  -0.0040524159245072374
Bond Position:  [1.02360503]


portfolio before change:  [0.61884462]
curr_Stock_Price:  100.00758818131494
curr_Factors:  [1.00007588e+02 4.10008455e-02]
mat_Sqrt:  [[ 2.02502020e+01  0.00000000e+00]
 [-8.09946621e-03  1.85582085e-02]]
grads:  [0.01375952 8.52317899]
Stock Position:  0.013759524750308354
Bond Position:  [-0.75721227]


portfolio before change:  [0.65786719]
curr_Stock_Price:  102.87115192399392
curr_Factors:  [1.02871152e+02 3.81279504e-02]
mat_Sqrt:  [[ 2.00870117e+01  0.00000000e+00]
 [-7.81055188e-03  1.78962226e-02]]
grads:  [2.27397479e-04 3.48209398e+00]
Stock Position:  0.00022739747852292363
Bond Position:  [0.63447455]


portfolio before change:  [0.65768549]
curr_Stock_Price:  100.67666795663366
curr_Factors:  [1.00676668e+02 3.70566030e-02]
mat_Sqrt:  [[ 1.93803509e+01  0.00000000e+00]
 [-7.70003668e-03  1.76430005e-02]]
grads:  [ 0.00163957 -0.93651965]
Stock Position:  0.0016395747072042706
Bond Position:  [0.49261857]


portfolio before change:  [0.65718857]
curr_Stock_Price:  100.22332608526199
curr_Factors:  [1.00223326e+02 3.61796840e-02]
mat_Sqrt:  [[ 1.90634367e+01  0.00000000e+00]
 [-7.60838317e-03  1.74329959e-02]]
grads:  [ 2.23860041e-03 -5.17401173e+00]
Stock Position:  0.0022386004126038646
Bond Position:  [0.43282859]


portfolio before change:  [0.6576246]
curr_Stock_Price:  100.321406266631
curr_Factors:  [1.00321406e+02 3.65605217e-02]
mat_Sqrt:  [[ 1.91822613e+01  0.00000000e+00]
 [-7.64832235e-03  1.75245080e-02]]
grads:  [ 0.01085876 -7.2294933 ]
Stock Position:  0.010858763825048036
Bond Position:  [-0.43174185]


portfolio before change:  [0.68600906]
curr_Stock_Price:  102.9552591475926
curr_Factors:  [1.02955259e+02 3.15532043e-02]
mat_Sqrt:  [[ 1.82881709e+01  0.00000000e+00]
 [-7.10528865e-03  1.62802615e-02]]
grads:  [-1.13670608e-03  4.46109542e+00]
Stock Position:  -0.0011367060802236152
Bond Position:  [0.80303893]


portfolio before change:  [0.6863428]
curr_Stock_Price:  103.01497672136797
curr_Factors:  [1.03014977e+02 2.95442068e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.6863428]
Stock Price:  102.45896004138731
PL:  [-1.77261724]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-1.96386582e-02 -1.30262986e-01]
 [ 2.32276724e-01  1.53235284e-01]
 [ 2.27552084e-01  1.56073686e-01]
 [ 3.65161442e-02 -6.93134777e-02]
 [ 7.75680179e-02 -6.34459867e-02]
 [ 1.02463470e-01 -2.96616993e-01]
 [ 5.38448239e-02 -1.20703628e-01]
 [ 1.40700127e-02  3.09132244e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.39824798]
curr_Stock_Price:  99.00392623457141
curr_Factors:  [9.90039262e+01 4.07099188e-02]
mat_Sqrt:  [[ 1.99757243e+01  0.00000000e+00]
 [-8.07067966e-03  1.84922502e-02]]
grads:  [-6.65198141e-03 -1.02970515e+01]
Stock Position:  -0.006651981408394091
Bond Position:  [-3.7396757]


portfolio before change:  [-4.39237921]
curr_Stock_Price:  97.84050134452418
curr_Factors:  [9.78405013e+01 4.44620485e-02]
mat_Sqrt:  [[ 2.06306734e+01  0.00000000e+00]
 [-8.43441033e-03  1.93256619e-02]]
grads:  [-3.70759038e-03 -6.74041525e+00]
Stock Position:  -0.0037075903820453344
Bond Position:  [-4.0296267]


portfolio before change:  [-4.39897912]
curr_Stock_Price:  99.07704502722399
curr_Factors:  [9.90770450e+01 4.39467349e-02]
mat_Sqrt:  [[ 2.07699931e+01  0.00000000e+00]
 [-8.38539062e-03  1.92133436e-02]]
grads:  [0.01440319 7.9754616 ]
Stock Position:  0.01440318651540616
Bond Position:  [-5.82600428]


portfolio before change:  [-4.43874771]
curr_Stock_Price:  96.51824629850046
curr_Factors:  [9.65182463e+01 4.47424830e-02]
mat_Sqrt:  [[ 2.04159439e+01  0.00000000e+00]
 [-8.46096760e-03  1.93865122e-02]]
grads:  [0.01448222 8.05063251]
Stock Position:  0.014482221683229818
Bond Position:  [-5.83654635]


portfolio before change:  [-4.42428695]
curr_Stock_Price:  97.71832196141483
curr_Factors:  [9.77183220e+01 4.48356322e-02]
mat_Sqrt:  [[ 2.06912939e+01  0.00000000e+00]
 [-8.46977045e-03  1.94066821e-02]]
grads:  [ 3.02797033e-04 -3.57162947e+00]
Stock Position:  0.0003027970334932003
Bond Position:  [-4.45387577]


portfolio before change:  [-4.42676028]
curr_Stock_Price:  96.90641695295166
curr_Factors:  [9.6906417e+01 3.9847609e-02]
mat_Sqrt:  [[ 1.93443290e+01  0.00000000e+00]
 [-7.98474636e-03  1.82953523e-02]]
grads:  [ 2.57842592e-03 -3.46787455e+00]
Stock Position:  0.002578425916433819
Bond Position:  [-4.6766263]


portfolio before change:  [-4.43522768]
curr_Stock_Price:  94.52958142459339
curr_Factors:  [9.45295814e+01 4.09391363e-02]
mat_Sqrt:  [[ 1.91265690e+01  0.00000000e+00]
 [-8.09336877e-03  1.85442375e-02]]
grads:  [-1.41116784e-03 -1.59951032e+01]
Stock Position:  -0.001411167843439111
Bond Position:  [-4.30183057]


portfolio before change:  [-4.43724124]
curr_Stock_Price:  94.43187028538973
curr_Factors:  [9.44318703e+01 3.90305920e-02]
mat_Sqrt:  [[ 1.86561129e+01  0.00000000e+00]
 [-7.90246462e-03  1.81068212e-02]]
grads:  [ 6.24696982e-05 -6.66619652e+00]
Stock Position:  6.246969822446758e-05
Bond Position:  [-4.44314037]


portfolio before change:  [-4.43954695]
curr_Stock_Price:  93.09394698040663
curr_Factors:  [9.30939470e+01 3.86517024e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.43954695]
Stock Price:  95.64345848822512
PL:  [-4.43954695]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.58934387e-02 -4.28828343e-01]
 [-5.42716194e-01 -1.71557125e-01]
 [-3.57874062e-01 -1.58655066e-01]
 [-3.89169572e-01 -7.93983359e-02]
 [-1.80317613e-01 -2.96925316e-03]
 [ 2.32596616e-01 -2.34214256e-02]
 [ 1.41820556e-01  1.26929303e-01]
 [-3.56641870e-01 -3.86610543e-01]
 [ 3.16450118e-02 -3.29459128e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.95373219]
curr_Stock_Price:  103.26508061838122
curr_Factors:  [1.03265081e+02 3.55035988e-02]
mat_Sqrt:  [[ 1.94576182e+01  0.00000000e+00]
 [-7.53695947e-03  1.72693436e-02]]
grads:  [-1.35190992e-02 -2.48317685e+01]
Stock Position:  -0.013519099246221727
Bond Position:  [26.34978306]


portfolio before change:  [24.9631732]
curr_Stock_Price:  103.54151733589826
curr_Factors:  [1.03541517e+02 3.39029032e-02]
mat_Sqrt:  [[ 1.90648314e+01  0.00000000e+00]
 [-7.36509641e-03  1.68755559e-02]]
grads:  [ -0.03239419 -10.16601325]
Stock Position:  -0.03239419468113498
Bond Position:  [28.31731727]


portfolio before change:  [24.91977758]
curr_Stock_Price:  105.31831144007575
curr_Factors:  [1.05318311e+02 3.19708259e-02]
mat_Sqrt:  [[ 1.88313222e+01  0.00000000e+00]
 [-7.15215502e-03  1.63876459e-02]]
grads:  [-0.02268119 -9.68138241]
Stock Position:  -0.022681190619688377
Bond Position:  [27.30852228]


portfolio before change:  [24.90104793]
curr_Stock_Price:  106.74624900814902
curr_Factors:  [1.06746249e+02 2.96515771e-02]
mat_Sqrt:  [[ 1.83813126e+01  0.00000000e+00]
 [-6.88785332e-03  1.57820546e-02]]
grads:  [-0.02305721 -5.03092518]
Stock Position:  -0.02305721335842199
Bond Position:  [27.36231897]


portfolio before change:  [24.93367167]
curr_Stock_Price:  105.92485064581292
curr_Factors:  [1.05924851e+02 2.88251423e-02]
mat_Sqrt:  [[ 1.79838881e+01  0.00000000e+00]
 [-6.79118751e-03  1.55605654e-02]]
grads:  [-0.01009868 -0.1908191 ]
Stock Position:  -0.01009867834906836
Bond Position:  [26.00337267]


portfolio before change:  [24.94897689]
curr_Stock_Price:  105.69706984310386
curr_Factors:  [1.05697070e+02 2.86357749e-02]
mat_Sqrt:  [[ 1.78861726e+01  0.00000000e+00]
 [-6.76884332e-03  1.55093684e-02]]
grads:  [ 0.01243277 -1.51014696]
Stock Position:  0.012432769874597151
Bond Position:  [23.63486955]


portfolio before change:  [24.96713865]
curr_Stock_Price:  106.20712261370261
curr_Factors:  [1.06207123e+02 3.01657572e-02]
mat_Sqrt:  [[ 1.84463633e+01  0.00000000e+00]
 [-6.94731686e-03  1.59183027e-02]]
grads:  [0.01069138 7.97379631]
Stock Position:  0.010691378129852082
Bond Position:  [23.83163814]


portfolio before change:  [24.98232012]
curr_Stock_Price:  106.51229115771066
curr_Factors:  [1.06512291e+02 2.90077850e-02]
mat_Sqrt:  [[ 1.81408240e+01  0.00000000e+00]
 [-6.81266879e-03  1.56097852e-02]]
grads:  [ -0.02896079 -24.76719176]
Stock Position:  -0.02896078715365644
Bond Position:  [28.06699992]


portfolio before change:  [25.04449405]
curr_Stock_Price:  104.850149754257
curr_Factors:  [1.04850150e+02 3.12522808e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.04449405]
Stock Price:  101.69827893404607
PL:  [23.34621512]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.84207594e-02 -2.69341788e-01]
 [-3.05461319e-02 -5.21485690e-03]
 [ 2.57658338e-01  1.61880102e-01]
 [ 1.90388247e-01  1.41564402e-01]
 [ 3.37155363e-01 -2.50078256e-01]
 [ 8.02342704e-02 -1.47037328e-01]
 [-1.10223612e-02 -3.90938194e-01]
 [ 5.75793635e-02 -1.10913825e-01]
 [ 3.73794226e-02  1.05299091e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.43924127]
curr_Stock_Price:  99.99655423202981
curr_Factors:  [9.99965542e+01 4.14794732e-02]
mat_Sqrt:  [[ 2.03658083e+01  0.00000000e+00]
 [-8.14660402e-03  1.86662148e-02]]
grads:  [-8.64051898e-03 -1.44293737e+01]
Stock Position:  -0.008640518980403931
Bond Position:  [3.30326339]


portfolio before change:  [2.45473693]
curr_Stock_Price:  98.39438030459327
curr_Factors:  [9.83943803e+01 3.97105809e-02]
mat_Sqrt:  [[ 1.96075538e+01  0.00000000e+00]
 [-7.97100554e-03  1.82638681e-02]]
grads:  [-0.00167395 -0.28552861]
Stock Position:  -0.0016739508852100075
Bond Position:  [2.61944429]


portfolio before change:  [2.45918386]
curr_Stock_Price:  96.52044035877655
curr_Factors:  [9.65204404e+01 4.24598040e-02]
mat_Sqrt:  [[ 1.98887866e+01  0.00000000e+00]
 [-8.24231074e-03  1.88855064e-02]]
grads:  [0.01650722 8.57165799]
Stock Position:  0.01650722159361027
Bond Position:  [0.86589956]


portfolio before change:  [2.4160733]
curr_Stock_Price:  93.88258745909425
curr_Factors:  [9.38825875e+01 4.25611347e-02]
mat_Sqrt:  [[ 1.93683065e+01  0.00000000e+00]
 [-8.25214005e-03  1.89080282e-02]]
grads:  [0.01301983 7.48699974]
Stock Position:  0.013019827896395022
Bond Position:  [1.19373817]


portfolio before change:  [2.40897396]
curr_Stock_Price:  93.2914619923835
curr_Factors:  [9.32914620e+01 4.22514181e-02]
mat_Sqrt:  [[ 1.91761997e+01  0.00000000e+00]
 [-8.22205989e-03  1.88391059e-02]]
grads:  [ 1.18903780e-02 -1.32744228e+01]
Stock Position:  0.011890378046431022
Bond Position:  [1.29970321]


portfolio before change:  [2.37465871]
curr_Stock_Price:  90.35082639670853
curr_Factors:  [9.03508264e+01 4.56804286e-02]
mat_Sqrt:  [[ 1.93106643e+01  0.00000000e+00]
 [-8.54919212e-03  1.95886600e-02]]
grads:  [ 8.31764210e-04 -7.50624738e+00]
Stock Position:  0.0008317642095217496
Bond Position:  [2.29950813]


portfolio before change:  [2.3751341]
curr_Stock_Price:  89.53971570550196
curr_Factors:  [8.95397157e+01 4.46786856e-02]
mat_Sqrt:  [[ 1.89263081e+01  0.00000000e+00]
 [-8.45493330e-03  1.93726859e-02]]
grads:  [-9.59731693e-03 -2.01798654e+01]
Stock Position:  -0.00959731693405879
Bond Position:  [3.23447513]


portfolio before change:  [2.38212645]
curr_Stock_Price:  88.97969305628783
curr_Factors:  [8.89796931e+01 4.56247229e-02]
mat_Sqrt:  [[ 1.90060131e+01  0.00000000e+00]
 [-8.54397780e-03  1.95767125e-02]]
grads:  [ 4.82615768e-04 -5.66560015e+00]
Stock Position:  0.0004826157679703892
Bond Position:  [2.33918345]


portfolio before change:  [2.38359413]
curr_Stock_Price:  89.59672142897169
curr_Factors:  [8.95967214e+01 4.46229682e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.38359413]
Stock Price:  86.60756122514644
PL:  [2.38359413]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.73485041e-02 -2.80519281e-01]
 [ 5.64645747e-02 -1.00274430e+00]
 [ 2.77300947e-01  1.68570251e-01]
 [ 1.94054463e-01  1.42943381e-01]
 [ 4.09048974e-01 -2.76137215e-01]
 [ 7.97245968e-02 -1.31058235e-01]
 [ 7.42360246e-02 -3.19973340e-01]
 [ 5.31314774e-02 -1.22573610e-01]
 [ 1.34751212e-02 -4.72650493e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.15600707]
curr_Stock_Price:  97.0066526228821
curr_Factors:  [9.70066526e+01 4.19581224e-02]
mat_Sqrt:  [[ 1.98705341e+01  0.00000000e+00]
 [-8.19347276e-03  1.87736046e-02]]
grads:  [-1.76543555e-03 -1.49422174e+01]
Stock Position:  -0.0017654355463833705
Bond Position:  [-17.98474807]


portfolio before change:  [-18.15981523]
curr_Stock_Price:  94.0688762219862
curr_Factors:  [9.40688762e+01 4.64592034e-02]
mat_Sqrt:  [[ 2.02759791e+01  0.00000000e+00]
 [-8.62175884e-03  1.97549313e-02]]
grads:  [-1.87990387e-02 -5.07591894e+01]
Stock Position:  -0.018799038652765984
Bond Position:  [-16.39141079]


portfolio before change:  [-18.17697067]
curr_Stock_Price:  94.54537295424238
curr_Factors:  [9.45453730e+01 4.41765815e-02]
mat_Sqrt:  [[ 1.98717600e+01  0.00000000e+00]
 [-8.40729032e-03  1.92635221e-02]]
grads:  [0.01765677 8.75074921]
Stock Position:  0.017656767049604484
Bond Position:  [-19.8463363]


portfolio before change:  [-18.1946491]
curr_Stock_Price:  94.10629052590689
curr_Factors:  [9.41062905e+01 4.35922404e-02]
mat_Sqrt:  [[ 1.96482217e+01  0.00000000e+00]
 [-8.35150194e-03  1.91356949e-02]]
grads:  [0.01305157 7.46998641]
Stock Position:  0.013051566355933185
Bond Position:  [-19.42288359]


portfolio before change:  [-18.22652535]
curr_Stock_Price:  92.40822747713298
curr_Factors:  [9.24082275e+01 4.35277424e-02]
mat_Sqrt:  [[ 1.92794088e+01  0.00000000e+00]
 [-8.34532132e-03  1.91215333e-02]]
grads:  [  0.01496585 -14.44116487]
Stock Position:  0.014965853782715529
Bond Position:  [-19.60949337]


portfolio before change:  [-18.2484011]
curr_Stock_Price:  91.60182155046193
curr_Factors:  [9.16018216e+01 4.20405880e-02]
mat_Sqrt:  [[ 1.87818558e+01  0.00000000e+00]
 [-8.20152064e-03  1.87920446e-02]]
grads:  [ 1.19935400e-03 -6.97413389e+00]
Stock Position:  0.0011993539968073216
Bond Position:  [-18.35826411]


portfolio before change:  [-18.25556101]
curr_Stock_Price:  93.28732702366794
curr_Factors:  [9.32873270e+01 3.99837661e-02]
mat_Sqrt:  [[ 1.86536790e+01  0.00000000e+00]
 [-7.99837645e-03  1.83265828e-02]]
grads:  [-3.50664283e-03 -1.74595201e+01]
Stock Position:  -0.0035066428311564483
Bond Position:  [-17.92843567]


portfolio before change:  [-18.2723617]
curr_Stock_Price:  95.52143851916291
curr_Factors:  [9.55214385e+01 3.82260072e-02]
mat_Sqrt:  [[ 1.86758477e+01  0.00000000e+00]
 [-7.82058895e-03  1.79192204e-02]]
grads:  [-1.94921258e-05 -6.84034280e+00]
Stock Position:  -1.949212577049958e-05
Bond Position:  [-18.27049978]


portfolio before change:  [-18.28152767]
curr_Stock_Price:  96.98047224213538
curr_Factors:  [9.69804722e+01 3.74904116e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.28152767]
Stock Price:  96.41726015642372
PL:  [-18.28152767]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 1.29243975e-02 -2.31614947e-01]
 [-4.71513037e-04 -3.50003663e-01]
 [ 2.72759976e-01  1.67023625e-01]
 [ 2.27738182e-01  1.55963164e-01]
 [ 2.52035593e-01 -2.19386486e-01]
 [ 7.88035699e-02 -1.02182545e-01]
 [ 4.75812507e-02 -3.41895137e-01]
 [ 5.49743433e-02 -1.17742682e-01]
 [ 1.29967115e-02  2.74880107e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.85585171]
curr_Stock_Price:  98.21162220903865
curr_Factors:  [9.82116222e+01 3.87796590e-02]
mat_Sqrt:  [[ 1.93403744e+01  0.00000000e+00]
 [-7.87702065e-03  1.80485217e-02]]
grads:  [-4.55837362e-03 -1.28329040e+01]
Stock Position:  -0.004558373619228168
Bond Position:  [-9.40816644]


portfolio before change:  [-9.85460062]
curr_Stock_Price:  96.90494082794122
curr_Factors:  [9.69049408e+01 4.01514959e-02]
mat_Sqrt:  [[ 1.94176552e+01  0.00000000e+00]
 [-8.01513527e-03  1.83649820e-02]]
grads:  [-7.89104726e-03 -1.90582089e+01]
Stock Position:  -0.007891047256040423
Bond Position:  [-9.08991916]


portfolio before change:  [-9.84410091]
curr_Stock_Price:  94.99824727093355
curr_Factors:  [9.49982473e+01 4.07016339e-02]
mat_Sqrt:  [[ 1.91655600e+01  0.00000000e+00]
 [-8.06985838e-03  1.84903684e-02]]
grads:  [0.01803522 9.03300685]
Stock Position:  0.018035218420559804
Bond Position:  [-11.55741505]


portfolio before change:  [-9.82274226]
curr_Stock_Price:  96.50301462966777
curr_Factors:  [9.65030146e+01 3.86970776e-02]
mat_Sqrt:  [[ 1.89836608e+01  0.00000000e+00]
 [-7.86862912e-03  1.80292943e-02]]
grads:  [0.01558214 8.6505418 ]
Stock Position:  0.015582141429846298
Bond Position:  [-11.32646588]


portfolio before change:  [-9.86325838]
curr_Stock_Price:  94.26638551048889
curr_Factors:  [9.42663855e+01 3.86015341e-02]
mat_Sqrt:  [[ 1.85207742e+01  0.00000000e+00]
 [-7.85890925e-03  1.80070233e-02]]
grads:  [ 8.43849610e-03 -1.21833844e+01]
Stock Position:  0.008438496100983506
Bond Position:  [-10.6587249]


portfolio before change:  [-9.87196434]
curr_Stock_Price:  93.86640076954143
curr_Factors:  [9.38664008e+01 4.00539180e-02]
mat_Sqrt:  [[ 1.87859286e+01  0.00000000e+00]
 [-8.00538999e-03  1.83426528e-02]]
grads:  [ 1.82090819e-03 -5.57076154e+00]
Stock Position:  0.0018209081862013037
Bond Position:  [-10.04288644]


portfolio before change:  [-9.88018009]
curr_Stock_Price:  92.11285218118084
curr_Factors:  [9.21128522e+01 3.66715049e-02]
mat_Sqrt:  [[ 1.76394320e+01  0.00000000e+00]
 [-7.65992218e-03  1.75510866e-02]]
grads:  [-5.76175130e-03 -1.94799983e+01]
Stock Position:  -0.005761751297539253
Bond Position:  [-9.34944875]


portfolio before change:  [-9.88633205]
curr_Stock_Price:  92.3690356037792
curr_Factors:  [9.23690356e+01 3.71131647e-02]
mat_Sqrt:  [[ 1.77946891e+01  0.00000000e+00]
 [-7.70591095e-03  1.76564601e-02]]
grads:  [ 2.01589591e-04 -6.66853271e+00]
Stock Position:  0.00020158959075754692
Bond Position:  [-9.90495269]


portfolio before change:  [-9.89110708]
curr_Stock_Price:  93.25541359290601
curr_Factors:  [9.32554136e+01 3.50413845e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.89110708]
Stock Price:  92.48111963472108
PL:  [-9.89110708]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.63902945e-02 -4.33363527e-01]
 [ 5.24631928e-04  8.20443664e-02]
 [ 8.70871748e-03 -5.94168893e-02]
 [ 2.11232912e-01  1.64381801e-01]
 [ 1.85142324e-01 -1.87300988e-01]
 [ 7.79217810e-02 -7.45370327e-02]
 [ 1.18732066e-01 -2.83257373e-01]
 [ 5.45909134e-02 -1.18747813e-01]
 [ 1.56120802e-02  3.58343843e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.66252186]
curr_Stock_Price:  103.36797869150816
curr_Factors:  [1.03367979e+02 4.02572182e-02]
mat_Sqrt:  [[ 2.07399595e+01  0.00000000e+00]
 [-8.02568060e-03  1.83891444e-02]]
grads:  [-1.28026115e-02 -2.35662692e+01]
Stock Position:  -0.01280261146855822
Bond Position:  [26.98590192]


portfolio before change:  [25.72719175]
curr_Stock_Price:  99.37085903808395
curr_Factors:  [9.93708590e+01 4.45648756e-02]
mat_Sqrt:  [[ 2.09775804e+01  0.00000000e+00]
 [-8.44415780e-03  1.93479961e-02]]
grads:  [1.73193135e-03 4.24045807e+00]
Stock Position:  0.0017319313474213718
Bond Position:  [25.55508824]


portfolio before change:  [25.74330387]
curr_Stock_Price:  101.29436631105874
curr_Factors:  [1.01294366e+02 4.36165557e-02]
mat_Sqrt:  [[ 2.11548999e+01  0.00000000e+00]
 [-8.35383080e-03  1.91410310e-02]]
grads:  [-8.14134741e-04 -3.10416348e+00]
Stock Position:  -0.000814134741247256
Bond Position:  [25.82577113]


portfolio before change:  [25.75839888]
curr_Stock_Price:  98.61802986612638
curr_Factors:  [9.86180299e+01 4.37861262e-02]
mat_Sqrt:  [[ 2.06359556e+01  0.00000000e+00]
 [-8.37005388e-03  1.91782027e-02]]
grads:  [0.01371272 8.57128289]
Stock Position:  0.013712716631382927
Bond Position:  [24.40607779]


portfolio before change:  [25.72204049]
curr_Stock_Price:  95.0764647106855
curr_Factors:  [9.50764647e+01 4.53725095e-02]
mat_Sqrt:  [[ 2.02520702e+01  0.00000000e+00]
 [-8.52032952e-03  1.95225275e-02]]
grads:  [ 5.10552599e-03 -9.59409522e+00]
Stock Position:  0.005105525991915287
Bond Position:  [25.23662513]


portfolio before change:  [25.73958261]
curr_Stock_Price:  96.04025301962265
curr_Factors:  [9.60402530e+01 4.48927945e-02]
mat_Sqrt:  [[ 2.03489318e+01  0.00000000e+00]
 [-8.47516791e-03  1.94190492e-02]]
grads:  [ 2.23064058e-03 -3.83834614e+00]
Stock Position:  0.0022306405795273917
Bond Position:  [25.52535132]


portfolio before change:  [25.75057819]
curr_Stock_Price:  95.2466330639267
curr_Factors:  [9.52466331e+01 4.33265916e-02]
mat_Sqrt:  [[ 1.98256254e+01  0.00000000e+00]
 [-8.32601625e-03  1.90772998e-02]]
grads:  [-2.46730526e-04 -1.48478755e+01]
Stock Position:  -0.00024673052568856453
Bond Position:  [25.77407845]


portfolio before change:  [25.76381139]
curr_Stock_Price:  93.85672003446979
curr_Factors:  [9.38567200e+01 4.52077549e-02]
mat_Sqrt:  [[ 1.99559241e+01  0.00000000e+00]
 [-8.50484614e-03  1.94870506e-02]]
grads:  [ 1.38561306e-04 -6.09367808e+00]
Stock Position:  0.0001385613060373345
Bond Position:  [25.75080648]


portfolio before change:  [25.7765522]
curr_Stock_Price:  92.86213886297888
curr_Factors:  [9.28621389e+01 4.24603055e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.7765522]
Stock Price:  92.3437286487938
PL:  [25.7765522]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.13004449e-02 -2.76545081e-01]
 [-3.46372176e-02  4.44995901e-02]
 [ 2.08384001e-01  1.56857893e-01]
 [ 2.06712283e-01  1.64445694e-01]
 [ 3.28661582e-02 -2.37007004e-02]
 [ 8.77173695e-02 -1.55707962e-01]
 [ 2.65046371e-01 -1.26003702e-01]
 [-1.09549099e-01 -1.62372941e-02]
 [ 4.58117109e-02 -6.65796440e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.29280457]
curr_Stock_Price:  97.71266484100362
curr_Factors:  [9.77126648e+01 4.19259418e-02]
mat_Sqrt:  [[ 2.00074745e+01  0.00000000e+00]
 [-8.19033009e-03  1.87664038e-02]]
grads:  [-1.96895032e-03 -1.47361787e+01]
Stock Position:  -0.001968950318832681
Bond Position:  [-13.10041319]


portfolio before change:  [-13.30113922]
curr_Stock_Price:  98.61812068400394
curr_Factors:  [9.86181207e+01 4.32637781e-02]
mat_Sqrt:  [[ 2.05125165e+01  0.00000000e+00]
 [-8.31997867e-03  1.90634660e-02]]
grads:  [-7.41791203e-04  2.33428644e+00]
Stock Position:  -0.0007417912027914184
Bond Position:  [-13.22798516]


portfolio before change:  [-13.30879954]
curr_Stock_Price:  100.02644306849206
curr_Factors:  [1.00026443e+02 3.93011635e-02]
mat_Sqrt:  [[ 1.98297633e+01  0.00000000e+00]
 [-7.92980843e-03  1.81694737e-02]]
grads:  [0.01396095 8.63304548]
Stock Position:  0.01396095324321088
Bond Position:  [-14.70526404]


portfolio before change:  [-13.33226764]
curr_Stock_Price:  98.87225028783587
curr_Factors:  [9.88722503e+01 4.48880370e-02]
mat_Sqrt:  [[ 2.09478630e+01  0.00000000e+00]
 [-8.47471883e-03  1.94180203e-02]]
grads:  [0.01329407 8.46871574]
Stock Position:  0.013294065740007365
Bond Position:  [-14.64668184]


portfolio before change:  [-13.3307648]
curr_Stock_Price:  99.53630726642938
curr_Factors:  [9.95363073e+01 4.42430628e-02]
mat_Sqrt:  [[ 2.09365017e+01  0.00000000e+00]
 [-8.41361400e-03  1.92780115e-02]]
grads:  [ 1.07574441e-03 -1.22941624e+00]
Stock Position:  0.0010757444055885911
Bond Position:  [-13.43784043]


portfolio before change:  [-13.33575446]
curr_Stock_Price:  101.14536969944048
curr_Factors:  [1.01145370e+02 4.35292305e-02]
mat_Sqrt:  [[ 2.11026260e+01  0.00000000e+00]
 [-8.34546397e-03  1.91218602e-02]]
grads:  [ 9.36416337e-04 -8.14292963e+00]
Stock Position:  0.000936416336506945
Bond Position:  [-13.43046864]


portfolio before change:  [-13.34329674]
curr_Stock_Price:  100.2639617138723
curr_Factors:  [1.00263962e+02 4.39592725e-02]
mat_Sqrt:  [[ 2.10218101e+01  0.00000000e+00]
 [-8.38658667e-03  1.92160841e-02]]
grads:  [ 0.00999219 -6.55719976]
Stock Position:  0.009992186486986075
Bond Position:  [-14.34515294]


portfolio before change:  [-13.31763923]
curr_Stock_Price:  103.54971651434361
curr_Factors:  [1.03549717e+02 4.21414313e-02]
mat_Sqrt:  [[ 2.12570775e+01  0.00000000e+00]
 [-8.21135129e-03  1.88145694e-02]]
grads:  [-0.00548691 -0.86301704]
Stock Position:  -0.0054869083239444125
Bond Position:  [-12.74947143]


portfolio before change:  [-13.31349603]
curr_Stock_Price:  101.63251098313606
curr_Factors:  [1.01632511e+02 4.28469221e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.31349603]
Stock Price:  99.17336594294228
PL:  [-13.31349603]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.00637322e-02 -3.75616137e-01]
 [-5.25227144e-01 -1.59972052e-01]
 [-4.06549605e-02 -1.12884292e-01]
 [-6.90269641e-02  4.10439679e-02]
 [-2.09204351e-01  7.00689778e-03]
 [ 3.73013021e-01  1.32048438e-01]
 [ 1.69744997e-01  2.43643655e-02]
 [ 3.65393105e-02  2.67141105e-02]
 [ 4.14007443e-02 -7.47694904e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.6602494]
curr_Stock_Price:  102.06107971895366
curr_Factors:  [1.02061080e+02 3.68695694e-02]
mat_Sqrt:  [[ 1.95972075e+01  0.00000000e+00]
 [-7.68058012e-03  1.75984199e-02]]
grads:  [-1.19402754e-02 -2.13437422e+01]
Stock Position:  -0.011940275373175768
Bond Position:  [17.8788868]


portfolio before change:  [16.65322382]
curr_Stock_Price:  103.39834070407406
curr_Factors:  [1.03398341e+02 3.76807186e-02]
mat_Sqrt:  [[ 2.00711916e+01  0.00000000e+00]
 [-7.76460880e-03  1.77909538e-02]]
grads:  [-0.0296467  -8.99176369]
Stock Position:  -0.029646703692885405
Bond Position:  [19.71864379]


portfolio before change:  [16.71843945]
curr_Stock_Price:  101.53122436176031
curr_Factors:  [1.01531224e+02 3.98343200e-02]
mat_Sqrt:  [[ 2.02641470e+01  0.00000000e+00]
 [-7.98341481e-03  1.82923013e-02]]
grads:  [-4.43747790e-03 -6.17113667e+00]
Stock Position:  -0.004437477896392822
Bond Position:  [17.16898201]


portfolio before change:  [16.71872861]
curr_Stock_Price:  103.40108737921838
curr_Factors:  [1.03401087e+02 3.79918672e-02]
mat_Sqrt:  [[ 2.01544256e+01  0.00000000e+00]
 [-7.79660103e-03  1.78642572e-02]]
grads:  [-0.00253611  2.29754686]
Stock Position:  -0.0025361133535212253
Bond Position:  [16.98096549]


portfolio before change:  [16.718643]
curr_Stock_Price:  106.78351377360117
curr_Factors:  [1.06783514e+02 3.45666078e-02]
mat_Sqrt:  [[ 1.98532947e+01  0.00000000e+00]
 [-7.43683887e-03  1.70399385e-02]]
grads:  [-0.01038348  0.4112044 ]
Stock Position:  -0.010383480122425433
Bond Position:  [17.82742749]


portfolio before change:  [16.72383316]
curr_Stock_Price:  107.14233244325698
curr_Factors:  [1.07142332e+02 3.44203079e-02]
mat_Sqrt:  [[ 1.98778071e+01  0.00000000e+00]
 [-7.42108433e-03  1.70038403e-02]]
grads:  [0.02166455 7.76580087]
Stock Position:  0.021664546910293892
Bond Position:  [14.40264307]


portfolio before change:  [16.65201859]
curr_Stock_Price:  103.4950052155981
curr_Factors:  [1.03495005e+02 3.89649380e-02]
mat_Sqrt:  [[ 2.04294364e+01  0.00000000e+00]
 [-7.89581540e-03  1.80915859e-02]]
grads:  [0.00882934 1.34672359]
Stock Position:  0.00882934187085305
Bond Position:  [15.7382258]


portfolio before change:  [16.63573748]
curr_Stock_Price:  100.75955878912495
curr_Factors:  [1.00759559e+02 4.19433494e-02]
mat_Sqrt:  [[ 2.06356337e+01  0.00000000e+00]
 [-8.19203021e-03  1.87702993e-02]]
grads:  [0.00233568 1.42321175]
Stock Position:  0.0023356832539453095
Bond Position:  [16.40039506]


portfolio before change:  [16.63979026]
curr_Stock_Price:  98.98300497162629
curr_Factors:  [9.89830050e+01 4.06436807e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.63979026]
Stock Price:  102.69093482230937
PL:  [13.94885543]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.12852921e-02 -2.04210902e-01]
 [-3.43194554e-02  7.34263120e-02]
 [ 2.26649613e-01  1.51318726e-01]
 [ 4.83796079e-03  7.92962191e-02]
 [ 1.09668964e-02 -4.87485399e-02]
 [ 7.71609452e-02 -5.06835957e-02]
 [ 2.05810561e-01 -1.93665420e-01]
 [ 5.15635540e-02 -1.26683799e-01]
 [ 1.53096012e-02 -4.98193903e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.2575287]
curr_Stock_Price:  99.31470374526167
curr_Factors:  [9.93147037e+01 3.80699077e-02]
mat_Sqrt:  [[ 1.93777997e+01  0.00000000e+00]
 [-7.80460456e-03  1.78825956e-02]]
grads:  [-7.24593288e-03 -1.14195336e+01]
Stock Position:  -0.007245932884766262
Bond Position:  [-1.53790103]


portfolio before change:  [-2.26266421]
curr_Stock_Price:  99.91729871957494
curr_Factors:  [9.99172987e+01 3.93035601e-02]
mat_Sqrt:  [[ 1.98087299e+01  0.00000000e+00]
 [-7.93005019e-03  1.81700276e-02]]
grads:  [-1.14776953e-04  4.04106771e+00]
Stock Position:  -0.00011477695328418652
Bond Position:  [-2.25119601]


portfolio before change:  [-2.26375834]
curr_Stock_Price:  99.64067289983583
curr_Factors:  [9.96406729e+01 4.16525114e-02]
mat_Sqrt:  [[ 2.03356120e+01  0.00000000e+00]
 [-8.16357876e-03  1.87051088e-02]]
grads:  [0.014393   8.08970038]
Stock Position:  0.014393002724842802
Bond Position:  [-3.69788682]


portfolio before change:  [-2.22515237]
curr_Stock_Price:  102.45143973626598
curr_Factors:  [1.02451440e+02 3.83445122e-02]
mat_Sqrt:  [[ 2.00617897e+01  0.00000000e+00]
 [-7.83270193e-03  1.79469747e-02]]
grads:  [1.96620883e-03 4.41836132e+00]
Stock Position:  0.0019662088262080183
Bond Position:  [-2.4265933]


portfolio before change:  [-2.23476902]
curr_Stock_Price:  98.17770704162497
curr_Factors:  [9.81777070e+01 3.76910985e-02]
mat_Sqrt:  [[ 1.90604119e+01  0.00000000e+00]
 [-7.76567818e-03  1.77934040e-02]]
grads:  [-5.40844067e-04 -2.73969724e+00]
Stock Position:  -0.000540844066560139
Bond Position:  [-2.18167019]


portfolio before change:  [-2.23571394]
curr_Stock_Price:  97.90741162850702
curr_Factors:  [9.79074116e+01 3.90900002e-02]
mat_Sqrt:  [[ 1.93574616e+01  0.00000000e+00]
 [-7.90847649e-03  1.81205961e-02]]
grads:  [ 0.00284339 -2.79701592]
Stock Position:  0.002843389890624309
Bond Position:  [-2.51410289]


portfolio before change:  [-2.23625395]
curr_Stock_Price:  98.1597025488105
curr_Factors:  [9.81597025e+01 4.07702185e-02]
mat_Sqrt:  [[ 1.98200503e+01  0.00000000e+00]
 [-8.07665460e-03  1.85059405e-02]]
grads:  [ 6.11946188e-03 -1.04650406e+01]
Stock Position:  0.00611946187751224
Bond Position:  [-2.8369385]


portfolio before change:  [-2.2377356]
curr_Stock_Price:  98.14943529393794
curr_Factors:  [9.81494353e+01 3.86615001e-02]
mat_Sqrt:  [[ 1.92986600e+01  0.00000000e+00]
 [-7.86501114e-03  1.80210044e-02]]
grads:  [-1.93059446e-04 -7.02978567e+00]
Stock Position:  -0.00019305944607927845
Bond Position:  [-2.21878692]


portfolio before change:  [-2.23865387]
curr_Stock_Price:  97.15800357763835
curr_Factors:  [9.71580036e+01 3.95348219e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.23865387]
Stock Price:  97.93270798649993
PL:  [-2.23865387]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.85783818e-02 -3.62058204e-01]
 [-1.95720848e-01  3.57020894e-02]
 [ 2.41810660e-01  1.56482483e-01]
 [ 2.20425905e-01  1.60239776e-01]
 [ 2.56180950e-01 -2.20866560e-01]
 [ 7.85304488e-02 -9.36197574e-02]
 [ 6.57796572e-02 -3.26633343e-01]
 [ 5.40114293e-02 -1.20266885e-01]
 [ 1.83632638e-02  4.46139750e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.54743702]
curr_Stock_Price:  101.75435357295146
curr_Factors:  [1.01754354e+02 3.79249040e-02]
mat_Sqrt:  [[ 1.98159658e+01  0.00000000e+00]
 [-7.78972698e-03  1.78485068e-02]]
grads:  [-1.14348974e-02 -2.02850697e+01]
Stock Position:  -0.01143489743270494
Bond Position:  [15.71098761]


portfolio before change:  [14.56434924]
curr_Stock_Price:  100.96249997311865
curr_Factors:  [1.00962500e+02 4.02750967e-02]
mat_Sqrt:  [[ 2.02618171e+01  0.00000000e+00]
 [-8.02746253e-03  1.83932273e-02]]
grads:  [-0.00889057  1.9410454 ]
Stock Position:  -0.008890573696422585
Bond Position:  [15.46196379]


portfolio before change:  [14.59740611]
curr_Stock_Price:  98.11409486403802
curr_Factors:  [9.81140949e+01 4.12136805e-02]
mat_Sqrt:  [[ 1.99182923e+01  0.00000000e+00]
 [-8.12046112e-03  1.86063139e-02]]
grads:  [0.01556887 8.41018183]
Stock Position:  0.015568865520636856
Bond Position:  [13.06988096]


portfolio before change:  [14.59471673]
curr_Stock_Price:  97.52150496771345
curr_Factors:  [9.75215050e+01 3.98231064e-02]
mat_Sqrt:  [[ 1.94611259e+01  0.00000000e+00]
 [-7.98229104e-03  1.82897265e-02]]
grads:  [0.01492001 8.76119039]
Stock Position:  0.014920014314768535
Bond Position:  [13.13969448]


portfolio before change:  [14.55210903]
curr_Stock_Price:  94.22531535947448
curr_Factors:  [9.42253154e+01 3.96012196e-02]
mat_Sqrt:  [[ 1.87508897e+01  0.00000000e+00]
 [-7.96002207e-03  1.82387018e-02]]
grads:  [ 8.52156258e-03 -1.21097741e+01]
Stock Position:  0.008521562583557319
Bond Position:  [13.74916211]


portfolio before change:  [14.56161422]
curr_Stock_Price:  94.533814408141
curr_Factors:  [9.45338144e+01 3.46301240e-02]
mat_Sqrt:  [[ 1.75919590e+01  0.00000000e+00]
 [-7.44366834e-03  1.70555868e-02]]
grads:  [ 2.14140090e-03 -5.48909624e+00]
Stock Position:  0.002141400901830146
Bond Position:  [14.35917943]


portfolio before change:  [14.56532169]
curr_Stock_Price:  92.9115516097644
curr_Factors:  [9.29115516e+01 3.36015357e-02]
mat_Sqrt:  [[ 1.70313579e+01  0.00000000e+00]
 [-7.33228866e-03  1.68003839e-02]]
grads:  [-4.50785082e-03 -1.94420166e+01]
Stock Position:  -0.004507850818323759
Bond Position:  [14.98415311]


portfolio before change:  [14.56941891]
curr_Stock_Price:  93.66506642978669
curr_Factors:  [9.36650664e+01 3.43753630e-02]
mat_Sqrt:  [[ 1.73660598e+01  0.00000000e+00]
 [-7.41623764e-03  1.69927352e-02]]
grads:  [ 8.76800676e-05 -7.07754720e+00]
Stock Position:  8.768006762315892e-05
Bond Position:  [14.56120635]


portfolio before change:  [14.5765948]
curr_Stock_Price:  92.45008078368964
curr_Factors:  [9.24500808e+01 3.76654503e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.5765948]
Stock Price:  93.43702699109805
PL:  [14.5765948]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.41545848e-02 -2.78420546e-01]
 [-2.72008102e-02 -4.35671127e-02]
 [ 2.59658866e-01  1.62561470e-01]
 [ 2.14930128e-01  1.50795371e-01]
 [ 1.18579434e-01 -1.34026448e-01]
 [ 7.72948430e-02 -5.48815099e-02]
 [ 2.11654503e-01 -1.86695814e-01]
 [ 5.25525258e-02 -1.24091287e-01]
 [ 8.62289736e-03 -4.05101137e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.67507205]
curr_Stock_Price:  97.36682072995539
curr_Factors:  [9.73668207e+01 3.77559916e-02]
mat_Sqrt:  [[ 1.89192506e+01  0.00000000e+00]
 [-7.77236043e-03  1.78087150e-02]]
grads:  [-1.97460799e-03 -1.56339492e+01]
Stock Position:  -0.001974607988630184
Bond Position:  [-15.48281074]


portfolio before change:  [-15.68451518]
curr_Stock_Price:  98.22764584672531
curr_Factors:  [9.82276458e+01 4.01145357e-02]
mat_Sqrt:  [[ 1.96736355e+01  0.00000000e+00]
 [-8.01144538e-03  1.83565274e-02]]
grads:  [-2.34908576e-03 -2.37338532e+00]
Stock Position:  -0.0023490857606382706
Bond Position:  [-15.45377002]


portfolio before change:  [-15.68775256]
curr_Stock_Price:  96.31565387697604
curr_Factors:  [9.63156539e+01 3.96294249e-02]
mat_Sqrt:  [[ 1.91736927e+01  0.00000000e+00]
 [-7.96285626e-03  1.82451958e-02]]
grads:  [0.01724271 8.90982324]
Stock Position:  0.017242714456519072
Bond Position:  [-17.34849588]


portfolio before change:  [-15.7123246]
curr_Stock_Price:  95.39377941345262
curr_Factors:  [9.53937794e+01 3.91915502e-02]
mat_Sqrt:  [[ 1.88849690e+01  0.00000000e+00]
 [-7.91874235e-03  1.81441181e-02]]
grads:  [0.01486593 8.31097826]
Stock Position:  0.014865929783704018
Bond Position:  [-17.13044183]


portfolio before change:  [-15.70790074]
curr_Stock_Price:  96.26767172065742
curr_Factors:  [9.62676717e+01 3.43173153e-02]
mat_Sqrt:  [[ 1.78335220e+01  0.00000000e+00]
 [-7.40997331e-03  1.69783818e-02]]
grads:  [ 3.36924454e-03 -7.89394710e+00]
Stock Position:  0.0033692445388122287
Bond Position:  [-16.03225007]


portfolio before change:  [-15.71152887]
curr_Stock_Price:  97.57063294637116
curr_Factors:  [9.75706329e+01 3.05195879e-02]
mat_Sqrt:  [[ 1.70454494e+01  0.00000000e+00]
 [-6.98794251e-03  1.60113878e-02]]
grads:  [ 3.12943281e-03 -3.42765478e+00]
Stock Position:  0.003129432808282972
Bond Position:  [-16.01686961]


portfolio before change:  [-15.71717011]
curr_Stock_Price:  98.32770450771508
curr_Factors:  [9.83277045e+01 3.06362586e-02]
mat_Sqrt:  [[ 1.72105109e+01  0.00000000e+00]
 [-7.00128658e-03  1.60419628e-02]]
grads:  [ 7.56362031e-03 -1.16379657e+01]
Stock Position:  0.007563620307375335
Bond Position:  [-16.46088353]


portfolio before change:  [-15.74442214]
curr_Stock_Price:  95.81309680020985
curr_Factors:  [9.58130968e+01 3.19707341e-02]
mat_Sqrt:  [[ 1.71317284e+01  0.00000000e+00]
 [-7.15214475e-03  1.63876224e-02]]
grads:  [-9.37063457e-05 -7.57225691e+00]
Stock Position:  -9.370634574333931e-05
Bond Position:  [-15.73544385]


portfolio before change:  [-15.7523572]
curr_Stock_Price:  96.51068955048159
curr_Factors:  [9.65106896e+01 3.25293964e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.7523572]
Stock Price:  95.77876602596598
PL:  [-15.7523572]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 2.25670797e-02 -2.37951186e-01]
 [ 6.69127074e-03 -4.32121003e-01]
 [ 2.47767696e-01  1.58511412e-01]
 [ 2.20080473e-01  1.60443416e-01]
 [ 2.41588343e-01 -2.15656361e-01]
 [ 7.96927829e-02 -1.30060817e-01]
 [ 1.37947364e-02 -3.70682825e-01]
 [ 5.78781007e-02 -1.10130709e-01]
 [ 6.43051444e-02  1.91225459e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.21291124]
curr_Stock_Price:  98.15978632609206
curr_Factors:  [9.81597863e+01 4.40552563e-02]
mat_Sqrt:  [[ 2.06030953e+01  0.00000000e+00]
 [-8.39573761e-03  1.92370516e-02]]
grads:  [-3.94520003e-03 -1.23694208e+01]
Stock Position:  -0.003945200028102253
Bond Position:  [-9.82565125]


portfolio before change:  [-10.2114026]
curr_Stock_Price:  96.53180846690458
curr_Factors:  [9.65318085e+01 4.64274146e-02]
mat_Sqrt:  [[ 2.07997298e+01  0.00000000e+00]
 [-8.61880870e-03  1.97481716e-02]]
grads:  [-8.74539229e-03 -2.18815701e+01]
Stock Position:  -0.00874539228756123
Bond Position:  [-9.36719407]


portfolio before change:  [-10.22471933]
curr_Stock_Price:  97.51883844583107
curr_Factors:  [9.75188384e+01 4.48151687e-02]
mat_Sqrt:  [[ 2.06443416e+01  0.00000000e+00]
 [-8.46783738e-03  1.94022529e-02]]
grads:  [0.01535277 8.16974259]
Stock Position:  0.015352766060670563
Bond Position:  [-11.72190325]


portfolio before change:  [-10.22995956]
curr_Stock_Price:  97.55936442821596
curr_Factors:  [9.75593644e+01 4.56482389e-02]
mat_Sqrt:  [[ 2.08439958e+01  0.00000000e+00]
 [-8.54617940e-03  1.95817570e-02]]
grads:  [0.01391786 8.19351483]
Stock Position:  0.013917855489626787
Bond Position:  [-11.5877767]


portfolio before change:  [-10.28014855]
curr_Stock_Price:  94.3696743657871
curr_Factors:  [9.43696744e+01 4.63069452e-02]
mat_Sqrt:  [[ 2.03074561e+01  0.00000000e+00]
 [-8.60761944e-03  1.97225338e-02]]
grads:  [ 7.26177571e-03 -1.09345160e+01]
Stock Position:  0.007261775706626801
Bond Position:  [-10.96543995]


portfolio before change:  [-10.30511647]
curr_Stock_Price:  91.68660747282492
curr_Factors:  [9.16866075e+01 4.96664308e-02]
mat_Sqrt:  [[ 2.04332467e+01  0.00000000e+00]
 [-8.91438664e-03  2.04254258e-02]]
grads:  [ 1.12217061e-03 -6.36759389e+00]
Stock Position:  0.0011221706097007602
Bond Position:  [-10.40800448]


portfolio before change:  [-10.31150198]
curr_Stock_Price:  90.63488382834552
curr_Factors:  [9.06348838e+01 5.05667900e-02]
mat_Sqrt:  [[ 2.03811214e+01  0.00000000e+00]
 [-8.99482429e-03  2.06097316e-02]]
grads:  [-7.26086211e-03 -1.79858153e+01]
Stock Position:  -0.007260862107613345
Bond Position:  [-9.65341459]


portfolio before change:  [-10.30464309]
curr_Stock_Price:  89.02532229402613
curr_Factors:  [8.90253223e+01 5.07064176e-02]
mat_Sqrt:  [[ 2.00467982e+01  0.00000000e+00]
 [-9.00723421e-03  2.06381663e-02]]
grads:  [ 4.89510525e-04 -5.33626426e+00]
Stock Position:  0.0004895105246422389
Bond Position:  [-10.34822193]


portfolio before change:  [-10.31151628]
curr_Stock_Price:  85.55699540768988
curr_Factors:  [8.55569954e+01 5.09626525e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.31151628]
Stock Price:  85.66867129577454
PL:  [-10.31151628]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.89981431e-02 -3.65889688e-01]
 [-3.70975412e-01 -6.00095386e-02]
 [ 1.03775223e-01  4.35527288e-02]
 [ 6.44783134e-02  1.16112120e-01]
 [-1.95736385e-02 -3.24589883e-03]
 [ 8.65825243e-02 -1.42608442e-01]
 [ 1.62004427e-01  4.66028353e-02]
 [-4.19628574e-01 -4.41144397e-01]
 [ 2.59120764e-02 -1.05482206e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.14427683]
curr_Stock_Price:  101.84099939965077
curr_Factors:  [1.01840999e+02 3.70204783e-02]
mat_Sqrt:  [[ 1.95949277e+01  0.00000000e+00]
 [-7.69628256e-03  1.76343987e-02]]
grads:  [-1.16706475e-02 -2.07486342e+01]
Stock Position:  -0.01167064753602873
Bond Position:  [16.33282724]


portfolio before change:  [15.14852339]
curr_Stock_Price:  102.17704730772927
curr_Factors:  [1.02177047e+02 3.73346761e-02]
mat_Sqrt:  [[ 1.97428362e+01  0.00000000e+00]
 [-7.72887326e-03  1.77090734e-02]]
grads:  [-0.02011695 -3.38863233]
Stock Position:  -0.020116953693643636
Bond Position:  [17.20401432]


portfolio before change:  [15.1841009]
curr_Stock_Price:  100.83622036189723
curr_Factors:  [1.00836220e+02 3.68055005e-02]
mat_Sqrt:  [[ 1.93451866e+01  0.00000000e+00]
 [-7.67390388e-03  1.75831227e-02]]
grads:  [0.00634696 2.47696211]
Stock Position:  0.006346963441470363
Bond Position:  [14.5440971]


portfolio before change:  [15.19585759]
curr_Stock_Price:  101.54251431067878
curr_Factors:  [1.01542514e+02 4.02373673e-02]
mat_Sqrt:  [[ 2.03686709e+01  0.00000000e+00]
 [-8.02370162e-03  1.83846100e-02]]
grads:  [5.65347625e-03 6.31572388e+00]
Stock Position:  0.005653476254718394
Bond Position:  [14.6217894]


portfolio before change:  [15.20816239]
curr_Stock_Price:  102.42552485294719
curr_Factors:  [1.02425525e+02 4.04651652e-02]
mat_Sqrt:  [[ 2.06038726e+01  0.00000000e+00]
 [-8.04638206e-03  1.84365774e-02]]
grads:  [-0.00101875 -0.17605756]
Stock Position:  -0.0010187533783061798
Bond Position:  [15.31250874]


portfolio before change:  [15.21731227]
curr_Stock_Price:  100.96127747184478
curr_Factors:  [1.00961277e+02 4.23016545e-02]
mat_Sqrt:  [[ 2.07650755e+01  0.00000000e+00]
 [-8.22694641e-03  1.88503023e-02]]
grads:  [ 1.17230962e-03 -7.56531324e+00]
Stock Position:  0.0011723096181229737
Bond Position:  [15.09895439]


portfolio before change:  [15.22824387]
curr_Stock_Price:  103.84467813572408
curr_Factors:  [1.03844678e+02 4.29186699e-02]
mat_Sqrt:  [[ 2.15133168e+01  0.00000000e+00]
 [-8.28672866e-03  1.89872807e-02]]
grads:  [0.00847585 2.45442389]
Stock Position:  0.008475846560075708
Bond Position:  [14.34807231]


portfolio before change:  [15.26837512]
curr_Stock_Price:  107.73283486786254
curr_Factors:  [1.07732835e+02 3.86053655e-02]
mat_Sqrt:  [[ 2.11676147e+01  0.00000000e+00]
 [-7.85929926e-03  1.80079169e-02]]
grads:  [ -0.02891964 -24.49724751]
Stock Position:  -0.02891963883072754
Bond Position:  [18.3839698]


portfolio before change:  [15.3048659]
curr_Stock_Price:  106.78896095349376
curr_Factors:  [1.06788961e+02 4.29225259e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.3048659]
Stock Price:  105.77532009147117
PL:  [9.52954581]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.14967704e-02 -2.06141226e-01]
 [-3.24900058e-01 -2.99937219e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [ 1.85271566e-01  1.61143996e-01]
 [ 1.23692158e-02 -4.98290718e-02]
 [ 7.68804008e-02 -4.18880739e-02]
 [ 1.21869087e-01 -2.80455877e-01]
 [ 5.37456233e-02 -1.20963675e-01]
 [ 4.54181212e-03  5.06520065e-04]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.09858846]
curr_Stock_Price:  99.33777779012009
curr_Factors:  [9.93377778e+01 4.07844592e-02]
mat_Sqrt:  [[ 2.00614257e+01  0.00000000e+00]
 [-8.07806504e-03  1.85091723e-02]]
grads:  [-7.05155153e-03 -1.11372472e+01]
Stock Position:  -0.00705155152971326
Bond Position:  [-1.398103]


portfolio before change:  [-2.11671581]
curr_Stock_Price:  101.80930821084486
curr_Factors:  [1.01809308e+02 3.96123864e-02]
mat_Sqrt:  [[ 2.02629648e+01  0.00000000e+00]
 [-7.96114428e-03  1.82412731e-02]]
grads:  [-0.0166802  -1.64427788]
Stock Position:  -0.01668020427122414
Bond Position:  [-0.41851576]


portfolio before change:  [-2.13464926]
curr_Stock_Price:  102.87189324378271
curr_Factors:  [1.02871893e+02 3.73179081e-02]
mat_Sqrt:  [[ 1.98726314e+01  0.00000000e+00]
 [-7.72713743e-03  1.77050961e-02]]
grads:  [ -0.0180275  -17.52225213]
Stock Position:  -0.018027495746539383
Bond Position:  [-0.28012664]


portfolio before change:  [-2.07605389]
curr_Stock_Price:  99.6137888841512
curr_Factors:  [9.96137889e+01 3.67297103e-02]
mat_Sqrt:  [[ 1.90909795e+01  0.00000000e+00]
 [-7.66599873e-03  1.75650097e-02]]
grads:  [0.01338855 9.17414786]
Stock Position:  0.013388552023277647
Bond Position:  [-3.40973829]


portfolio before change:  [-2.09731185]
curr_Stock_Price:  98.15338736600559
curr_Factors:  [9.81533874e+01 3.68798967e-02]
mat_Sqrt:  [[ 1.88495133e+01  0.00000000e+00]
 [-7.68165573e-03  1.76008844e-02]]
grads:  [-4.97518100e-04 -2.83105499e+00]
Stock Position:  -0.0004975180999411876
Bond Position:  [-2.04847876]


portfolio before change:  [-2.09855672]
curr_Stock_Price:  98.59634003850391
curr_Factors:  [9.85963400e+01 3.74750378e-02]
mat_Sqrt:  [[ 1.90867434e+01  0.00000000e+00]
 [-7.74338818e-03  1.77423312e-02]]
grads:  [ 0.00307014 -2.3609115 ]
Stock Position:  0.0030701385502815716
Bond Position:  [-2.40126115]


portfolio before change:  [-2.10962466]
curr_Stock_Price:  95.38247831104106
curr_Factors:  [9.53824783e+01 3.97106241e-02]
mat_Sqrt:  [[ 1.90073669e+01  0.00000000e+00]
 [-7.97100988e-03  1.82638781e-02]]
grads:  [-2.79835095e-05 -1.53557681e+01]
Stock Position:  -2.7983509545934322e-05
Bond Position:  [-2.10695552]


portfolio before change:  [-2.11065875]
curr_Stock_Price:  94.68031586202888
curr_Factors:  [9.46803159e+01 3.98349631e-02]
mat_Sqrt:  [[ 1.88969584e+01  0.00000000e+00]
 [-7.98347925e-03  1.82924490e-02]]
grads:  [ 5.04180340e-05 -6.61276546e+00]
Stock Position:  5.041803402245602e-05
Bond Position:  [-2.11543234]


portfolio before change:  [-2.11172465]
curr_Stock_Price:  94.52312935400535
curr_Factors:  [9.45231294e+01 3.91350900e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.11172465]
Stock Price:  95.61680201269665
PL:  [-2.11172465]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.81742466e-02 -1.91466819e-01]
 [ 2.64988564e-04  8.22457100e-02]
 [-6.77118635e-02 -1.42190502e-01]
 [ 2.10540873e-01  1.64391582e-01]
 [ 4.34847436e-02 -2.16578934e-02]
 [ 8.82138632e-02 -1.58305884e-01]
 [ 1.94908921e-01 -4.53414800e-02]
 [-3.75924221e-01 -4.00008552e-01]
 [ 2.09722877e-02  1.72687369e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.54452414]
curr_Stock_Price:  98.54716766660904
curr_Factors:  [9.85471677e+01 4.12781599e-02]
mat_Sqrt:  [[ 2.00218550e+01  0.00000000e+00]
 [-8.12681093e-03  1.86208631e-02]]
grads:  [-6.57967094e-03 -1.02823815e+01]
Stock Position:  -0.006579670935653588
Bond Position:  [-6.8961162]


portfolio before change:  [-7.5522898]
curr_Stock_Price:  99.20324005639144
curr_Factors:  [9.92032401e+01 4.07316014e-02]
mat_Sqrt:  [[ 2.00212689e+01  0.00000000e+00]
 [-8.07282864e-03  1.84971742e-02]]
grads:  [1.80607729e-03 4.44639323e+00]
Stock Position:  0.001806077291772577
Bond Position:  [-7.73145852]


portfolio before change:  [-7.5517165]
curr_Stock_Price:  101.66160454241198
curr_Factors:  [1.01661605e+02 4.16819911e-02]
mat_Sqrt:  [[ 2.07554039e+01  0.00000000e+00]
 [-8.16646715e-03  1.87117269e-02]]
grads:  [-6.25229395e-03 -7.59900473e+00]
Stock Position:  -0.006252293953862553
Bond Position:  [-6.91609826]


portfolio before change:  [-7.53638843]
curr_Stock_Price:  98.65679127602198
curr_Factors:  [9.86567913e+01 4.40405724e-02]
mat_Sqrt:  [[ 2.07039621e+01  0.00000000e+00]
 [-8.39433832e-03  1.92338454e-02]]
grads:  [0.01363446 8.54699508]
Stock Position:  0.013634455087722305
Bond Position:  [-8.88152002]


portfolio before change:  [-7.52405158]
curr_Stock_Price:  99.88740361373164
curr_Factors:  [9.98874036e+01 4.43938061e-02]
mat_Sqrt:  [[ 2.10461138e+01  0.00000000e+00]
 [-8.42793508e-03  1.93108252e-02]]
grads:  [ 0.00161704 -1.12154158]
Stock Position:  0.001617042662494542
Bond Position:  [-7.68557377]


portfolio before change:  [-7.52436189]
curr_Stock_Price:  102.07252605156411
curr_Factors:  [1.02072526e+02 4.58965732e-02]
mat_Sqrt:  [[ 2.18674929e+01  0.00000000e+00]
 [-8.56939421e-03  1.96349488e-02]]
grads:  [ 8.74517766e-04 -8.06245465e+00]
Stock Position:  0.0008745177662208867
Bond Position:  [-7.61362612]


portfolio before change:  [-7.52789102]
curr_Stock_Price:  102.39113624729792
curr_Factors:  [1.02391136e+02 4.71158552e-02]
mat_Sqrt:  [[ 2.22252115e+01  0.00000000e+00]
 [-8.68247478e-03  1.98940490e-02]]
grads:  [ 0.00787935 -2.27914791]
Stock Position:  0.007879352541073869
Bond Position:  [-8.33466688]


portfolio before change:  [-7.4965358]
curr_Stock_Price:  106.89957738685978
curr_Factors:  [1.06899577e+02 4.27795769e-02]
mat_Sqrt:  [[ 2.21102794e+01  0.00000000e+00]
 [-8.27328973e-03  1.89564882e-02]]
grads:  [ -0.02489802 -21.1014059 ]
Stock Position:  -0.024898023952656875
Bond Position:  [-4.83494756]


portfolio before change:  [-7.55275852]
curr_Stock_Price:  109.06057768664293
curr_Factors:  [1.09060578e+02 4.25324509e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.55275852]
Stock Price:  108.40820427940102
PL:  [-15.96096279]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.21686182e-02 -2.77115560e-01]
 [-2.12392703e-01  3.18053895e-02]
 [ 2.04275728e-01  1.52408089e-01]
 [ 2.20802321e-01  1.60020738e-01]
 [ 6.91369855e-03 -4.59227246e-02]
 [ 7.76979551e-02 -6.75197267e-02]
 [ 1.90328058e-01 -2.11310902e-01]
 [ 9.15469820e-02  5.72326236e-02]
 [ 3.18767835e-02 -6.69447746e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.02134074]
curr_Stock_Price:  97.60690008296916
curr_Factors:  [9.76069001e+01 4.04706384e-02]
mat_Sqrt:  [[ 1.96358881e+01  0.00000000e+00]
 [-8.04692621e-03  1.84378242e-02]]
grads:  [-1.97467655e-03 -1.50297322e+01]
Stock Position:  -0.0019746765468785506
Bond Position:  [-13.82859868]


portfolio before change:  [-14.03509679]
curr_Stock_Price:  101.07077181043948
curr_Factors:  [1.01070772e+02 4.01125702e-02]
mat_Sqrt:  [[ 2.02425783e+01  0.00000000e+00]
 [-8.01124911e-03  1.83560777e-02]]
grads:  [-0.00980664  1.73268985]
Stock Position:  -0.009806640752441776
Bond Position:  [-13.04393204]


portfolio before change:  [-14.03205271]
curr_Stock_Price:  100.09513927876037
curr_Factors:  [1.00095139e+02 4.26243914e-02]
mat_Sqrt:  [[ 2.06653176e+01  0.00000000e+00]
 [-8.25827017e-03  1.89220741e-02]]
grads:  [0.0131037  8.05451285]
Stock Position:  0.013103697560510693
Bond Position:  [-15.34366915]


portfolio before change:  [-14.07423009]
curr_Stock_Price:  97.46201793483243
curr_Factors:  [9.74620179e+01 4.37380223e-02]
mat_Sqrt:  [[ 2.03828529e+01  0.00000000e+00]
 [-8.36545490e-03  1.91676651e-02]]
grads:  [0.0142591  8.34847316]
Stock Position:  0.014259098004819469
Bond Position:  [-15.46395056]


portfolio before change:  [-14.07083527]
curr_Stock_Price:  98.24248339873722
curr_Factors:  [9.82424834e+01 4.74559226e-02]
mat_Sqrt:  [[ 2.14015162e+01  0.00000000e+00]
 [-8.71375213e-03  1.99657144e-02]]
grads:  [-6.13443527e-04 -2.30007921e+00]
Stock Position:  -0.0006134435273465887
Bond Position:  [-14.01056905]


portfolio before change:  [-14.07682988]
curr_Stock_Price:  96.59208358604924
curr_Factors:  [9.65920836e+01 4.61656767e-02]
mat_Sqrt:  [[ 2.07539677e+01  0.00000000e+00]
 [-8.59447978e-03  1.96924271e-02]]
grads:  [ 2.32388963e-03 -3.42871534e+00]
Stock Position:  0.0023238896309935825
Bond Position:  [-14.30129922]


portfolio before change:  [-14.08135839]
curr_Stock_Price:  97.72119140403672
curr_Factors:  [9.77211914e+01 4.62404640e-02]
mat_Sqrt:  [[ 2.10135702e+01  0.00000000e+00]
 [-8.60143839e-03  1.97083713e-02]]
grads:  [ 4.66862214e-03 -1.07218856e+01]
Stock Position:  0.004668622139707905
Bond Position:  [-14.53758171]


portfolio before change:  [-14.07859894]
curr_Stock_Price:  99.86958981309962
curr_Factors:  [9.98695898e+01 4.93602375e-02]
mat_Sqrt:  [[ 2.21881905e+01  0.00000000e+00]
 [-8.88686559e-03  2.03623671e-02]]
grads:  [0.00525168 2.81070581]
Stock Position:  0.00525168317324172
Bond Position:  [-14.60308238]


portfolio before change:  [-14.09367124]
curr_Stock_Price:  98.39026632323613
curr_Factors:  [9.83902663e+01 5.16967588e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.09367124]
Stock Price:  97.43420717054691
PL:  [-14.09367124]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.21999016e-02 -3.03836920e-01]
 [-3.82581853e-01 -6.74608882e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [ 1.25016097e-01  1.42310427e-01]
 [-2.82431389e-03 -3.78573718e-02]
 [ 8.50359797e-02 -1.24770176e-01]
 [ 2.64174388e-01 -1.28003263e-01]
 [ 5.19375285e-02 -1.25703454e-01]
 [ 3.28734309e-02 -6.77046763e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.47290848]
curr_Stock_Price:  100.43696487034259
curr_Factors:  [1.00436965e+02 3.85530899e-02]
mat_Sqrt:  [[ 1.97207386e+01  0.00000000e+00]
 [-7.85397630e-03  1.79957205e-02]]
grads:  [-9.87819014e-03 -1.68838431e+01]
Stock Position:  -0.009878190139023368
Bond Position:  [6.46504391]


portfolio before change:  [5.45805817]
curr_Stock_Price:  102.26762748729281
curr_Factors:  [1.02267627e+02 3.84265730e-02]
mat_Sqrt:  [[ 2.00472132e+01  0.00000000e+00]
 [-7.84107881e-03  1.79661686e-02]]
grads:  [-0.02055269 -3.75488452]
Stock Position:  -0.02055269206735851
Bond Position:  [7.55993323]


portfolio before change:  [5.45645597]
curr_Stock_Price:  102.52954549311525
curr_Factors:  [1.02529545e+02 3.90379461e-02]
mat_Sqrt:  [[ 2.02578109e+01  0.00000000e+00]
 [-7.90320908e-03  1.81085269e-02]]
grads:  [ -0.01768472 -17.13188263]
Stock Position:  -0.017684723233599323
Bond Position:  [7.2696626]


portfolio before change:  [5.49099342]
curr_Stock_Price:  100.7821778657324
curr_Factors:  [1.00782178e+02 3.83939632e-02]
mat_Sqrt:  [[ 1.97476404e+01  0.00000000e+00]
 [-7.83775102e-03  1.79585437e-02]]
grads:  [0.00947584 7.92438574]
Stock Position:  0.009475838905843864
Bond Position:  [4.53599774]


portfolio before change:  [5.47089533]
curr_Stock_Price:  98.42178996845797
curr_Factors:  [9.84217900e+01 3.90649363e-02]
mat_Sqrt:  [[ 1.94529208e+01  0.00000000e+00]
 [-7.90594068e-03  1.81147858e-02]]
grads:  [-9.94535766e-04 -2.08986031e+00]
Stock Position:  -0.0009945357656537942
Bond Position:  [5.56877932]


portfolio before change:  [5.47140609]
curr_Stock_Price:  100.708611180604
curr_Factors:  [1.00708611e+02 3.89384728e-02]
mat_Sqrt:  [[ 1.98726628e+01  0.00000000e+00]
 [-7.89313350e-03  1.80854409e-02]]
grads:  [ 1.53888841e-03 -6.89892921e+00]
Stock Position:  0.0015388884058664001
Bond Position:  [5.31642678]


portfolio before change:  [5.47268773]
curr_Stock_Price:  99.81365445563698
curr_Factors:  [9.98136545e+01 4.08475773e-02]
mat_Sqrt:  [[ 2.01731217e+01  0.00000000e+00]
 [-8.08431343e-03  1.85234891e-02]]
grads:  [ 0.01032608 -6.91032141]
Stock Position:  0.010326075806055756
Bond Position:  [4.44200437]


portfolio before change:  [5.45416378]
curr_Stock_Price:  97.80461407022852
curr_Factors:  [9.78046141e+01 4.12233977e-02]
mat_Sqrt:  [[ 1.98578047e+01  0.00000000e+00]
 [-8.12141836e-03  1.86085072e-02]]
grads:  [-1.47244705e-04 -6.75516056e+00]
Stock Position:  -0.00014724470460190272
Bond Position:  [5.468565]


portfolio before change:  [5.45680293]
curr_Stock_Price:  98.45535041610698
curr_Factors:  [9.84553504e+01 4.02472440e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.45680293]
Stock Price:  98.2270633631519
PL:  [5.45680293]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-5.18324631e-02  6.93330102e-02]
 [ 2.48806280e-01  1.58865147e-01]
 [ 1.46292915e-01  1.51160673e-01]
 [-5.89279397e-02 -3.56032418e-03]
 [ 9.07136886e-02 -1.78788139e-01]
 [ 2.53280109e-01 -1.35001533e-01]
 [ 7.44515552e-02 -6.12534548e-02]
 [-1.61660536e-04 -1.45034256e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.19061832]
curr_Stock_Price:  98.74372005135072
curr_Factors:  [9.87437201e+01 4.45966272e-02]
mat_Sqrt:  [[ 2.08526134e+01  0.00000000e+00]
 [-8.44716542e-03  1.93548875e-02]]
grads:  [-6.37225388e-03 -9.83811733e+00]
Stock Position:  -0.006372253883402211
Bond Position:  [-5.56139827]


portfolio before change:  [-6.20156372]
curr_Stock_Price:  100.0249002823268
curr_Factors:  [1.00024900e+02 4.43600493e-02]
mat_Sqrt:  [[ 2.10670699e+01  0.00000000e+00]
 [-8.42473020e-03  1.93034819e-02]]
grads:  [-1.02401790e-03  3.59173596e+00]
Stock Position:  -0.00102401789648117
Bond Position:  [-6.09913643]


portfolio before change:  [-6.20194028]
curr_Stock_Price:  97.4138416257826
curr_Factors:  [9.74138416e+01 4.44369379e-02]
mat_Sqrt:  [[ 2.05349067e+01  0.00000000e+00]
 [-8.43202827e-03  1.93202039e-02]]
grads:  [0.01549268 8.22274692]
Stock Position:  0.015492678893643969
Bond Position:  [-7.71114165]


portfolio before change:  [-6.15861216]
curr_Stock_Price:  100.45945177538638
curr_Factors:  [1.00459452e+02 4.10660192e-02]
mat_Sqrt:  [[ 2.03578592e+01  0.00000000e+00]
 [-8.10590099e-03  1.85729524e-02]]
grads:  [0.01042668 8.13875304]
Stock Position:  0.010426677898451305
Bond Position:  [-7.2060705]


portfolio before change:  [-6.13193348]
curr_Stock_Price:  103.36379098425502
curr_Factors:  [1.03363791e+02 4.02485871e-02]
mat_Sqrt:  [[ 2.07368960e+01  0.00000000e+00]
 [-8.02482021e-03  1.83871730e-02]]
grads:  [-0.00291663 -0.19363086]
Stock Position:  -0.0029166270884426683
Bond Position:  [-5.83045985]


portfolio before change:  [-6.13745772]
curr_Stock_Price:  104.25806889327642
curr_Factors:  [1.04258069e+02 4.19420161e-02]
mat_Sqrt:  [[ 2.13517919e+01  0.00000000e+00]
 [-8.19190001e-03  1.87700009e-02]]
grads:  [ 5.94055410e-04 -9.52520673e+00]
Stock Position:  0.0005940554100919553
Bond Position:  [-6.19939279]


portfolio before change:  [-6.14264973]
curr_Stock_Price:  100.73728629060565
curr_Factors:  [1.00737286e+02 3.65107327e-02]
mat_Sqrt:  [[ 1.92486609e+01  0.00000000e+00]
 [-7.64311274e-03  1.75125713e-02]]
grads:  [ 0.01009736 -7.70883558]
Stock Position:  0.010097357431439273
Bond Position:  [-7.15983011]


portfolio before change:  [-6.16596231]
curr_Stock_Price:  98.78313451236004
curr_Factors:  [9.87831345e+01 3.43372206e-02]
mat_Sqrt:  [[ 1.83048162e+01  0.00000000e+00]
 [-7.41212203e-03  1.69833051e-02]]
grads:  [ 2.60687435e-03 -3.60668635e+00]
Stock Position:  0.0026068743532641357
Bond Position:  [-6.42347753]


portfolio before change:  [-6.17843955]
curr_Stock_Price:  95.22918496951888
curr_Factors:  [9.52291850e+01 3.50829104e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.17843955]
Stock Price:  97.1799992789796
PL:  [-6.17843955]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-1.55364564e-02  7.78164478e-02]
 [ 2.72390560e-01  1.66897804e-01]
 [ 2.06616303e-01  1.47668282e-01]
 [ 5.85955571e-01 -3.40261434e-01]
 [ 7.99184134e-02 -1.37134698e-01]
 [ 3.58517990e-02 -3.51957376e-01]
 [ 5.54809602e-02 -1.16414625e-01]
 [ 2.17229918e-02  5.53356949e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.51946009]
curr_Stock_Price:  98.98632934681113
curr_Factors:  [9.89863293e+01 4.38124245e-02]
mat_Sqrt:  [[ 2.07192420e+01  0.00000000e+00]
 [-8.37256706e-03  1.91839612e-02]]
grads:  [-6.41327259e-03 -9.92577352e+00]
Stock Position:  -0.006413272588737565
Bond Position:  [-3.88463378]


portfolio before change:  [-4.5265804]
curr_Stock_Price:  99.7936415431578
curr_Factors:  [9.97936415e+01 4.09142633e-02]
mat_Sqrt:  [[ 2.01855338e+01  0.00000000e+00]
 [-8.09090979e-03  1.85386033e-02]]
grads:  [9.12803492e-04 4.19753563e+00]
Stock Position:  0.0009128034923830588
Bond Position:  [-4.61767239]


portfolio before change:  [-4.53323074]
curr_Stock_Price:  95.03804945297043
curr_Factors:  [9.50380495e+01 4.28675406e-02]
mat_Sqrt:  [[ 1.96771320e+01  0.00000000e+00]
 [-8.28179117e-03  1.89759675e-02]]
grads:  [0.01754477 8.79521977]
Stock Position:  0.017544768938137306
Bond Position:  [-6.20065136]


portfolio before change:  [-4.53914556]
curr_Stock_Price:  94.87767583787725
curr_Factors:  [9.48776758e+01 4.34582169e-02]
mat_Sqrt:  [[ 1.97788023e+01  0.00000000e+00]
 [-8.33865379e-03  1.91062561e-02]]
grads:  [0.01370477 7.72879213]
Stock Position:  0.013704774475482505
Bond Position:  [-5.83942271]


portfolio before change:  [-4.60570417]
curr_Stock_Price:  90.23417176897405
curr_Factors:  [9.02341718e+01 4.53828090e-02]
mat_Sqrt:  [[ 1.92228033e+01  0.00000000e+00]
 [-8.52129652e-03  1.95247432e-02]]
grads:  [  0.022757   -17.42719127]
Stock Position:  0.022756998494735718
Bond Position:  [-6.65916309]


portfolio before change:  [-4.58875556]
curr_Stock_Price:  91.12528369317164
curr_Factors:  [9.11252837e+01 4.24696938e-02]
mat_Sqrt:  [[ 1.87792593e+01  0.00000000e+00]
 [-8.24327059e-03  1.88877057e-02]]
grads:  [ 1.06862173e-03 -7.26052702e+00]
Stock Position:  0.0010686217277054244
Bond Position:  [-4.68613401]


portfolio before change:  [-4.5905914]
curr_Stock_Price:  91.6004878692162
curr_Factors:  [9.16004879e+01 4.27287979e-02]
mat_Sqrt:  [[ 1.89346867e+01  0.00000000e+00]
 [-8.26837811e-03  1.89452343e-02]]
grads:  [-6.21900932e-03 -1.85776207e+01]
Stock Position:  -0.006219009323418501
Bond Position:  [-4.02092711]


portfolio before change:  [-4.59499838]
curr_Stock_Price:  91.98576179296369
curr_Factors:  [9.19857618e+01 4.13763694e-02]
mat_Sqrt:  [[ 1.87109914e+01  0.00000000e+00]
 [-8.13647289e-03  1.86430014e-02]]
grads:  [ 2.49770433e-04 -6.24441432e+00]
Stock Position:  0.0002497704331521352
Bond Position:  [-4.61797371]


portfolio before change:  [-4.59731794]
curr_Stock_Price:  91.94576960401902
curr_Factors:  [9.19457696e+01 4.03296125e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.59731794]
Stock Price:  88.63248806880999
PL:  [-4.59731794]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.50086870e-02 -2.38197185e-01]
 [-2.92024711e-02 -2.06191817e-02]
 [ 2.24886880e-01  1.52029118e-01]
 [-1.09699290e-01  2.56537014e-02]
 [-1.76112730e-02 -3.22649863e-03]
 [ 8.83090928e-02 -1.60031606e-01]
 [ 1.72373993e-01  1.69512137e-02]
 [-5.14411324e-02  6.62120040e-02]
 [ 3.88169072e-02 -4.99729987e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.2307932]
curr_Stock_Price:  99.67594423872687
curr_Factors:  [9.96759442e+01 4.04063141e-02]
mat_Sqrt:  [[ 2.00361824e+01  0.00000000e+00]
 [-8.04052875e-03  1.84231658e-02]]
grads:  [-7.93396957e-03 -1.29292211e+01]
Stock Position:  -0.007933969565140985
Bond Position:  [1.02161911]


portfolio before change:  [0.24203114]
curr_Stock_Price:  98.32390989683954
curr_Factors:  [9.83239099e+01 4.10471422e-02]
mat_Sqrt:  [[ 1.99205169e+01  0.00000000e+00]
 [-8.10403773e-03  1.85686832e-02]]
grads:  [-0.00191769 -1.11042778]
Stock Position:  -0.0019176921929870167
Bond Position:  [0.43058613]


portfolio before change:  [0.23957003]
curr_Stock_Price:  99.7195755247241
curr_Factors:  [9.97195755e+01 4.22531708e-02]
mat_Sqrt:  [[ 2.04979332e+01  0.00000000e+00]
 [-8.22223043e-03  1.88394967e-02]]
grads:  [0.01420816 8.06970169]
Stock Position:  0.014208155724728543
Bond Position:  [-1.17726123]


portfolio before change:  [0.29733304]
curr_Stock_Price:  103.82649755504765
curr_Factors:  [1.03826498e+02 3.94052889e-02]
mat_Sqrt:  [[ 2.06103545e+01  0.00000000e+00]
 [-7.94030618e-03  1.81935271e-02]]
grads:  [-0.0047793   1.41004553]
Stock Position:  -0.004779301435181399
Bond Position:  [0.79355117]


portfolio before change:  [0.30464892]
curr_Stock_Price:  102.37879492237778
curr_Factors:  [1.02378795e+02 4.05324633e-02]
mat_Sqrt:  [[ 2.06115908e+01  0.00000000e+00]
 [-8.05307030e-03  1.84519021e-02]]
grads:  [-0.00092275 -0.17485995]
Stock Position:  -0.000922754222622929
Bond Position:  [0.39911939]


portfolio before change:  [0.30526852]
curr_Stock_Price:  101.9236472342776
curr_Factors:  [1.01923647e+02 4.11459027e-02]
mat_Sqrt:  [[ 2.06746542e+01  0.00000000e+00]
 [-8.11378113e-03  1.85910081e-02]]
grads:  [ 8.93150328e-04 -8.60801118e+00]
Stock Position:  0.0008931503284902194
Bond Position:  [0.21423538]


portfolio before change:  [0.3066735]
curr_Stock_Price:  103.37674065517534
curr_Factors:  [1.03376741e+02 4.13487983e-02]
mat_Sqrt:  [[ 2.10210440e+01  0.00000000e+00]
 [-8.13376157e-03  1.86367890e-02]]
grads:  [0.00855201 0.90955656]
Stock Position:  0.008552006690589475
Bond Position:  [-0.57740508]


portfolio before change:  [0.30180204]
curr_Stock_Price:  102.8408808378243
curr_Factors:  [1.02840881e+02 4.35576375e-02]
mat_Sqrt:  [[ 2.14633717e+01  0.00000000e+00]
 [-8.34818663e-03  1.91280986e-02]]
grads:  [-1.05034033e-03  3.46150474e+00]
Stock Position:  -0.0010503403254984102
Bond Position:  [0.40981997]


portfolio before change:  [0.30160521]
curr_Stock_Price:  103.22342188224174
curr_Factors:  [1.03223422e+02 4.07030405e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.30160521]
Stock Price:  104.18868522538473
PL:  [-3.88708002]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-6.51300405e-02  6.62249778e-02]
 [ 1.64133487e-01  1.08928724e-01]
 [ 9.44849195e-02  1.29688848e-01]
 [ 2.76154712e-02 -8.86398869e-03]
 [ 9.49937031e-02 -1.75064518e-01]
 [ 1.83973259e-01 -1.62633934e-02]
 [-2.62291703e-01 -2.79592378e-01]
 [ 3.70901013e-02 -4.58733192e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.49440483]
curr_Stock_Price:  98.84479238570242
curr_Factors:  [9.88447924e+01 4.31302342e-02]
mat_Sqrt:  [[ 2.05279084e+01  0.00000000e+00]
 [-8.30712795e-03  1.90340213e-02]]
grads:  [-6.47304850e-03 -1.00039635e+01]
Stock Position:  -0.006473048497417217
Bond Position:  [-4.8545777]


portfolio before change:  [-5.50503916]
curr_Stock_Price:  100.11257633765136
curr_Factors:  [1.00112576e+02 4.31072771e-02]
mat_Sqrt:  [[ 2.07856655e+01  0.00000000e+00]
 [-8.30491682e-03  1.90289550e-02]]
grads:  [-1.74288818e-03  3.48022147e+00]
Stock Position:  -0.0017428881775894212
Bond Position:  [-5.33055413]


portfolio before change:  [-5.5083502]
curr_Stock_Price:  100.48270850328466
curr_Factors:  [1.00482709e+02 3.95559167e-02]
mat_Sqrt:  [[ 1.99846736e+01  0.00000000e+00]
 [-7.95546772e-03  1.82282665e-02]]
grads:  [0.01059181 5.97581364]
Stock Position:  0.010591810664315637
Bond Position:  [-6.57264402]


portfolio before change:  [-5.50361244]
curr_Stock_Price:  101.24035961955921
curr_Factors:  [1.01240360e+02 3.91484249e-02]
mat_Sqrt:  [[ 2.00313780e+01  0.00000000e+00]
 [-7.91438437e-03  1.81341327e-02]]
grads:  [0.00754246 7.15164325]
Stock Position:  0.007542455301272418
Bond Position:  [-6.26721333]


portfolio before change:  [-5.50707607]
curr_Stock_Price:  101.19670811213844
curr_Factors:  [1.01196708e+02 4.03732892e-02]
mat_Sqrt:  [[ 2.03335614e+01  0.00000000e+00]
 [-8.03724223e-03  1.84156355e-02]]
grads:  [ 0.00116787 -0.4813295 ]
Stock Position:  0.0011678676915306736
Bond Position:  [-5.62526044]


portfolio before change:  [-5.50625775]
curr_Stock_Price:  104.3063606380648
curr_Factors:  [1.04306361e+02 3.79503291e-02]
mat_Sqrt:  [[ 2.03197596e+01  0.00000000e+00]
 [-7.79233768e-03  1.78544886e-02]]
grads:  [ 9.14837778e-04 -9.80507037e+00]
Stock Position:  0.0009148377784467503
Bond Position:  [-5.60168114]


portfolio before change:  [-5.51038874]
curr_Stock_Price:  102.85314555926335
curr_Factors:  [1.02853146e+02 3.83493051e-02]
mat_Sqrt:  [[ 2.01417095e+01  0.00000000e+00]
 [-7.83319144e-03  1.79480964e-02]]
grads:  [ 0.00878155 -0.90613473]
Stock Position:  0.008781545197820312
Bond Position:  [-6.41359829]


portfolio before change:  [-5.49521852]
curr_Stock_Price:  104.94592374162502
curr_Factors:  [1.04945924e+02 3.60835665e-02]
mat_Sqrt:  [[ 1.99351865e+01  0.00000000e+00]
 [-7.59826996e-03  1.74098236e-02]]
grads:  [ -0.01927827 -16.0594607 ]
Stock Position:  -0.01927826565635299
Bond Position:  [-3.47204312]


portfolio before change:  [-5.47127031]
curr_Stock_Price:  103.61361195518485
curr_Factors:  [1.03613612e+02 3.60154316e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.47127031]
Stock Price:  105.21313003027083
PL:  [-10.68440034]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 8.81159024e-02 -2.81023541e-01]
 [-1.43296717e-02 -1.91127569e-01]
 [ 2.61213471e-01  1.63090958e-01]
 [ 2.27001127e-01  1.56395374e-01]
 [ 1.74463657e-01 -1.78891550e-01]
 [ 7.72378080e-02 -5.30933701e-02]
 [ 1.05670305e-01 -2.94700137e-01]
 [ 5.51822546e-02 -1.17197659e-01]
 [ 1.79972515e-02  4.34461775e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.78646303]
curr_Stock_Price:  96.91512659434113
curr_Factors:  [9.69151266e+01 4.13197943e-02]
mat_Sqrt:  [[ 1.97002003e+01  0.00000000e+00]
 [-8.13090837e-03  1.86302515e-02]]
grads:  [-1.75291751e-03 -1.50842591e+01]
Stock Position:  -0.001752917509287046
Bond Position:  [-18.6165788]


portfolio before change:  [-18.79695359]
curr_Stock_Price:  97.58826227527976
curr_Factors:  [9.75882623e+01 4.09549842e-02]
mat_Sqrt:  [[ 1.97492663e+01  0.00000000e+00]
 [-8.09493513e-03  1.85478265e-02]]
grads:  [-4.94927659e-03 -1.03045804e+01]
Stock Position:  -0.004949276585536281
Bond Position:  [-18.31396229]


portfolio before change:  [-18.79906307]
curr_Stock_Price:  96.16385358210032
curr_Factors:  [9.61638536e+01 4.35004450e-02]
mat_Sqrt:  [[ 2.00566644e+01  0.00000000e+00]
 [-8.34270412e-03  1.91155366e-02]]
grads:  [0.01657266 8.53185353]
Stock Position:  0.0165726560387978
Bond Position:  [-20.39275354]


portfolio before change:  [-18.80205996]
curr_Stock_Price:  96.5984273138467
curr_Factors:  [9.65984273e+01 4.28904735e-02]
mat_Sqrt:  [[ 2.00055491e+01  0.00000000e+00]
 [-8.28400614e-03  1.89810426e-02]]
grads:  [0.01475879 8.23955656]
Stock Position:  0.014758788269026572
Bond Position:  [-20.22773569]


portfolio before change:  [-18.83185582]
curr_Stock_Price:  95.26502076291844
curr_Factors:  [9.52650208e+01 4.70277590e-02]
mat_Sqrt:  [[ 2.06590625e+01  0.00000000e+00]
 [-8.67435383e-03  1.98754415e-02]]
grads:  [ 4.66569983e-03 -9.00063277e+00]
Stock Position:  0.004665699825950094
Bond Position:  [-19.27633381]


portfolio before change:  [-18.83000821]
curr_Stock_Price:  97.72728520936897
curr_Factors:  [9.77272852e+01 4.96433122e-02]
mat_Sqrt:  [[ 2.17744006e+01  0.00000000e+00]
 [-8.91231168e-03  2.04206715e-02]]
grads:  [ 2.48300573e-03 -2.59998160e+00]
Stock Position:  0.002483005731887384
Bond Position:  [-19.07266562]


portfolio before change:  [-18.84711677]
curr_Stock_Price:  94.67862342685575
curr_Factors:  [9.46786234e+01 5.43686171e-02]
mat_Sqrt:  [[ 2.20762894e+01  0.00000000e+00]
 [-9.32683158e-03  2.13704559e-02]]
grads:  [-1.03945820e-03 -1.37900726e+01]
Stock Position:  -0.0010394581963299057
Bond Position:  [-18.7487023]


portfolio before change:  [-18.85530288]
curr_Stock_Price:  93.53323528937109
curr_Factors:  [9.35332353e+01 5.13550326e-02]
mat_Sqrt:  [[ 2.11961733e+01  0.00000000e+00]
 [-9.06465952e-03  2.07697442e-02]]
grads:  [ 1.90270333e-04 -5.64271074e+00]
Stock Position:  0.0001902703332313829
Bond Position:  [-18.87309948]


portfolio before change:  [-18.86493779]
curr_Stock_Price:  92.50313154028196
curr_Factors:  [9.25031315e+01 5.18972868e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.86493779]
Stock Price:  94.59620640409334
PL:  [-18.86493779]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.25197684e-02 -2.15478915e-01]
 [-4.72265291e-02  7.04095516e-02]
 [ 1.03943626e-01  4.37351321e-02]
 [ 4.00619351e-03  7.87820325e-02]
 [ 3.61880377e-02 -1.45277659e-02]
 [ 7.67105805e-02 -3.65639311e-02]
 [ 1.57003848e-01 -2.48874368e-01]
 [ 5.42165094e-02 -1.19729284e-01]
 [ 9.16827849e-03  1.52707546e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.40522561]
curr_Stock_Price:  99.4384362854438
curr_Factors:  [9.94384363e+01 4.28484153e-02]
mat_Sqrt:  [[ 2.05836159e+01  0.00000000e+00]
 [-8.27994351e-03  1.89717339e-02]]
grads:  [-7.12034647e-03 -1.13578925e+01]
Stock Position:  -0.007120346468837353
Bond Position:  [-0.69718949]


portfolio before change:  [-1.40957144]
curr_Stock_Price:  99.99980620789312
curr_Factors:  [9.99998062e+01 4.02983345e-02]
mat_Sqrt:  [[ 2.00744062e+01  0.00000000e+00]
 [-8.02977802e-03  1.83985328e-02]]
grads:  [-8.21806702e-04  3.82691122e+00]
Stock Position:  -0.0008218067021124586
Bond Position:  [-1.32739093]


portfolio before change:  [-1.41092239]
curr_Stock_Price:  100.83587288261855
curr_Factors:  [1.00835873e+02 4.00716249e-02]
mat_Sqrt:  [[ 2.01852224e+01  0.00000000e+00]
 [-8.00715929e-03  1.83467068e-02]]
grads:  [0.00609511 2.38381376]
Stock Position:  0.00609511256847715
Bond Position:  [-2.02552838]


portfolio before change:  [-1.40200951]
curr_Stock_Price:  102.46437418256036
curr_Factors:  [1.02464374e+02 3.94763471e-02]
mat_Sqrt:  [[ 2.03582935e+01  0.00000000e+00]
 [-7.94746219e-03  1.82099235e-02]]
grads:  [1.88569299e-03 4.32632418e+00]
Stock Position:  0.0018856929912509778
Bond Position:  [-1.59522586]


portfolio before change:  [-1.40593869]
curr_Stock_Price:  100.80377898247235
curr_Factors:  [1.00803779e+02 4.26908125e-02]
mat_Sqrt:  [[ 2.08278300e+01  0.00000000e+00]
 [-8.26470205e-03  1.89368114e-02]]
grads:  [ 0.00143306 -0.76717065]
Stock Position:  0.0014330634000042182
Bond Position:  [-1.5503969]


portfolio before change:  [-1.409267]
curr_Stock_Price:  99.02233538954933
curr_Factors:  [9.90223354e+01 4.70137731e-02]
mat_Sqrt:  [[ 2.14706760e+01  0.00000000e+00]
 [-8.67306387e-03  1.98724858e-02]]
grads:  [ 0.00282957 -1.83992739]
Stock Position:  0.0028295696289536727
Bond Position:  [-1.6894576]


portfolio before change:  [-1.41645483]
curr_Stock_Price:  96.78069321598872
curr_Factors:  [9.67806932e+01 4.71517986e-02]
mat_Sqrt:  [[ 2.10154097e+01  0.00000000e+00]
 [-8.68578596e-03  1.99016358e-02]]
grads:  [ 2.30241379e-03 -1.25052217e+01]
Stock Position:  0.0023024137863899273
Bond Position:  [-1.63928403]


portfolio before change:  [-1.42139392]
curr_Stock_Price:  94.99159551774632
curr_Factors:  [9.49915955e+01 5.01076862e-02]
mat_Sqrt:  [[ 2.12636276e+01  0.00000000e+00]
 [-8.95389848e-03  2.05159588e-02]]
grads:  [ 9.22874489e-05 -5.83590976e+00]
Stock Position:  9.228744885536234e-05
Bond Position:  [-1.43016045]


portfolio before change:  [-1.42221653]
curr_Stock_Price:  93.82835577146948
curr_Factors:  [9.38283558e+01 4.52550366e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.42221653]
Stock Price:  93.59028311261295
PL:  [-1.42221653]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 9.39498133e-02 -2.84857024e-01]
 [-8.60637504e-02  6.13321579e-02]
 [ 2.30108281e-01  1.52496726e-01]
 [ 2.22304653e-01  1.59141266e-01]
 [ 1.89272656e-02 -6.30322707e-03]
 [ 2.81849391e-01  3.14724619e-02]
 [ 1.42696128e-01  1.21421728e-01]
 [-4.58395134e-01 -4.77127511e-01]
 [ 2.69151898e-02 -1.61178811e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.90150365]
curr_Stock_Price:  96.17255394112527
curr_Factors:  [9.61725539e+01 4.23904360e-02]
mat_Sqrt:  [[ 1.98009073e+01  0.00000000e+00]
 [-8.23557512e-03  1.88700732e-02]]
grads:  [-1.53386831e-03 -1.50957032e+01]
Stock Position:  -0.0015338683108753642
Bond Position:  [-23.75398762]


portfolio before change:  [-23.91963949]
curr_Stock_Price:  100.25104980250978
curr_Factors:  [1.00251050e+02 4.07520333e-02]
mat_Sqrt:  [[ 2.02378126e+01  0.00000000e+00]
 [-8.07485314e-03  1.85018129e-02]]
grads:  [-2.92997091e-03  3.31492694e+00]
Stock Position:  -0.0029299709077412243
Bond Position:  [-23.62590683]


portfolio before change:  [-23.92864078]
curr_Stock_Price:  99.29041850276808
curr_Factors:  [9.92904185e+01 3.98993821e-02]
mat_Sqrt:  [[ 1.98330920e+01  0.00000000e+00]
 [-7.98993188e-03  1.83072338e-02]]
grads:  [0.014958   8.32986173]
Stock Position:  0.014957995887421928
Bond Position:  [-25.41382645]


portfolio before change:  [-23.9717514]
curr_Stock_Price:  97.25802500103396
curr_Factors:  [9.72580250e+01 4.05462081e-02]
mat_Sqrt:  [[ 1.95839625e+01  0.00000000e+00]
 [-8.05443561e-03  1.84550304e-02]]
grads:  [0.01489788 8.62319175]
Stock Position:  0.014897883718074323
Bond Position:  [-25.42069015]


portfolio before change:  [-23.92201866]
curr_Stock_Price:  101.44964450556778
curr_Factors:  [1.01449645e+02 3.86677068e-02]
mat_Sqrt:  [[ 1.99491657e+01  0.00000000e+00]
 [-7.86564244e-03  1.80224509e-02]]
grads:  [ 0.00081088 -0.34974306]
Stock Position:  0.0008108766049909451
Bond Position:  [-24.00428181]


portfolio before change:  [-23.93015807]
curr_Stock_Price:  106.21699431305281
curr_Factors:  [1.06216994e+02 3.82637297e-02]
mat_Sqrt:  [[ 2.07772305e+01  0.00000000e+00]
 [-7.82444679e-03  1.79280598e-02]]
grads:  [0.0142264  1.75548621]
Stock Position:  0.01422639553247048
Bond Position:  [-25.44124305]


portfolio before change:  [-23.946511]
curr_Stock_Price:  105.96189654438272
curr_Factors:  [1.05961897e+02 3.79335031e-02]
mat_Sqrt:  [[ 2.06376954e+01  0.00000000e+00]
 [-7.79061005e-03  1.78505301e-02]]
grads:  [0.00948211 6.80213567]
Stock Position:  0.009482110803771003
Bond Position:  [-24.95125344]


portfolio before change:  [-23.93516933]
curr_Stock_Price:  108.47403900160764
curr_Factors:  [1.08474039e+02 3.65627650e-02]
mat_Sqrt:  [[ 2.07417467e+01  0.00000000e+00]
 [-7.64855698e-03  1.75250457e-02]]
grads:  [ -0.03213956 -27.22546463]
Stock Position:  -0.032139561847008
Bond Position:  [-20.44886125]


portfolio before change:  [-23.87651814]
curr_Stock_Price:  106.33094266865099
curr_Factors:  [1.06330943e+02 3.91572512e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.87651814]
Stock Price:  108.39951633928067
PL:  [-32.27603448]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.31154431e-02 -3.12193770e-01]
 [-3.67991628e-01 -5.82140130e-02]
 [-2.92114518e-01 -2.32480558e-01]
 [-1.08349127e-01  2.61523000e-02]
 [ 2.99476297e-02 -1.00672686e-02]
 [ 7.68126578e-02 -3.28290087e-02]
 [ 1.62804302e-01 -2.41795553e-01]
 [ 5.26392045e-02 -1.23864065e-01]
 [ 6.58472855e-03  7.02586671e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.77504226]
curr_Stock_Price:  100.62600128407544
curr_Factors:  [1.00626001e+02 3.74949390e-02]
mat_Sqrt:  [[ 1.94848264e+01  0.00000000e+00]
 [-7.74544397e-03  1.77470417e-02]]
grads:  [-1.02319605e-02 -1.75913133e+01]
Stock Position:  -0.01023196054936599
Bond Position:  [7.80464353]


portfolio before change:  [6.76329057]
curr_Stock_Price:  102.15600936494722
curr_Factors:  [1.02156009e+02 3.52304674e-02]
mat_Sqrt:  [[ 1.91744591e+01  0.00000000e+00]
 [-7.50791235e-03  1.72027883e-02]]
grads:  [-0.02051679 -3.38398706]
Stock Position:  -0.020516787703446587
Bond Position:  [8.85920373]


portfolio before change:  [6.72091039]
curr_Stock_Price:  104.43759895345578
curr_Factors:  [1.04437599e+02 3.25199717e-02]
mat_Sqrt:  [[ 1.88335400e+01  0.00000000e+00]
 [-7.21331788e-03  1.65277876e-02]]
grads:  [ -0.02089768 -14.06604219]
Stock Position:  -0.02089768314741808
Bond Position:  [8.90341425]


portfolio before change:  [6.73846634]
curr_Stock_Price:  103.81058555717046
curr_Factors:  [1.03810586e+02 3.03324454e-02]
mat_Sqrt:  [[ 1.80798721e+01  0.00000000e+00]
 [-6.96648496e-03  1.59622223e-02]]
grads:  [-0.00536151  1.63838715]
Stock Position:  -0.005361505140891893
Bond Position:  [7.29504733]


portfolio before change:  [6.75654792]
curr_Stock_Price:  101.11859144425479
curr_Factors:  [1.01118591e+02 3.00135821e-02]
mat_Sqrt:  [[ 1.75182180e+01  0.00000000e+00]
 [-6.92977138e-03  1.58781009e-02]]
grads:  [ 0.00145871 -0.6340348 ]
Stock Position:  0.001458705073399474
Bond Position:  [6.60904571]


portfolio before change:  [6.75736398]
curr_Stock_Price:  99.41208897050997
curr_Factors:  [9.94120890e+01 3.36003459e-02]
mat_Sqrt:  [[ 1.82226307e+01  0.00000000e+00]
 [-7.33215885e-03  1.68000865e-02]]
grads:  [ 0.00342897 -1.9540976 ]
Stock Position:  0.003428972727937732
Bond Position:  [6.41648264]


portfolio before change:  [6.75212627]
curr_Stock_Price:  96.94873877618545
curr_Factors:  [9.69487388e+01 3.28902246e-02]
mat_Sqrt:  [[ 1.75822959e+01  0.00000000e+00]
 [-7.25426491e-03  1.66216090e-02]]
grads:  [ 3.25759909e-03 -1.45470606e+01]
Stock Position:  0.003257599085503463
Bond Position:  [6.43630614]


portfolio before change:  [6.75214732]
curr_Stock_Price:  95.96706390959886
curr_Factors:  [9.59670639e+01 3.47755120e-02]
mat_Sqrt:  [[ 1.78961238e+01  0.00000000e+00]
 [-7.45927739e-03  1.70913516e-02]]
grads:  [-7.93191600e-05 -7.24717786e+00]
Stock Position:  -7.931915995358085e-05
Bond Position:  [6.75975935]


portfolio before change:  [6.75566683]
curr_Stock_Price:  94.2172965639339
curr_Factors:  [9.42172966e+01 3.44625857e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.75566683]
Stock Price:  91.2291977345257
PL:  [6.75566683]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.90011781e-02 -2.74639715e-01]
 [-5.72890144e-02  6.80576547e-02]
 [ 2.40472363e-01  1.56026668e-01]
 [ 1.63280692e-01  1.56479322e-01]
 [-6.32157573e-02 -3.43934571e-03]
 [ 2.69193173e-01  1.75470869e-02]
 [-9.42981574e-02  3.64117943e-01]
 [-7.76580809e-01 -7.65935422e-01]
 [ 2.33537861e-02  4.51427682e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.78815135]
curr_Stock_Price:  100.04720702333118
curr_Factors:  [1.00047207e+02 3.78732645e-02]
mat_Sqrt:  [[ 1.94702416e+01  0.00000000e+00]
 [-7.78442183e-03  1.78363511e-02]]
grads:  [-9.18652067e-03 -1.53977522e+01]
Stock Position:  -0.009186520668206041
Bond Position:  [3.70723709]


portfolio before change:  [2.78985117]
curr_Stock_Price:  100.06399896030334
curr_Factors:  [1.00063999e+02 4.11854558e-02]
mat_Sqrt:  [[ 2.03071882e+01  0.00000000e+00]
 [-8.11768005e-03  1.85999416e-02]]
grads:  [-1.35844601e-03  3.65902518e+00]
Stock Position:  -0.001358446006141842
Bond Position:  [2.92578271]


portfolio before change:  [2.79377625]
curr_Stock_Price:  98.25176907787278
curr_Factors:  [9.82517691e+01 4.36678597e-02]
mat_Sqrt:  [[ 2.05315308e+01  0.00000000e+00]
 [-8.35874246e-03  1.91522850e-02]]
grads:  [0.01502898 8.14663459]
Stock Position:  0.015028980847995367
Bond Position:  [1.31715229]


portfolio before change:  [2.82263552]
curr_Stock_Price:  100.12817919709694
curr_Factors:  [1.00128179e+02 4.18430590e-02]
mat_Sqrt:  [[ 2.04817958e+01  0.00000000e+00]
 [-8.18223041e-03  1.87478451e-02]]
grads:  [0.01130633 8.3465231 ]
Stock Position:  0.011306326343377493
Bond Position:  [1.69055365]


portfolio before change:  [2.86124605]
curr_Stock_Price:  103.4683479359658
curr_Factors:  [1.03468348e+02 4.25816326e-02]
mat_Sqrt:  [[ 2.13510221e+01  0.00000000e+00]
 [-8.25412698e-03  1.89125808e-02]]
grads:  [-0.00303109 -0.18185491]
Stock Position:  -0.003031087254316832
Bond Position:  [3.17486764]


portfolio before change:  [2.85488778]
curr_Stock_Price:  106.08988063356021
curr_Factors:  [1.06089881e+02 3.95880170e-02]
mat_Sqrt:  [[ 2.11084252e+01  0.00000000e+00]
 [-7.95869507e-03  1.82356613e-02]]
grads:  [0.01311568 0.96224023]
Stock Position:  0.013115679918549174
Bond Position:  [1.46344687]


portfolio before change:  [2.93519149]
curr_Stock_Price:  112.15680249218654
curr_Factors:  [1.12156802e+02 4.00689502e-02]
mat_Sqrt:  [[ 2.24506853e+01  0.00000000e+00]
 [-8.00689205e-03  1.83460945e-02]]
grads:  [2.87812780e-03 1.98471639e+01]
Stock Position:  0.0028781277984706163
Bond Position:  [2.61238988]


portfolio before change:  [2.94348572]
curr_Stock_Price:  114.58466631731856
curr_Factors:  [1.14584666e+02 4.12634733e-02]
mat_Sqrt:  [[ 2.32760561e+01  0.00000000e+00]
 [-8.12536505e-03  1.86175502e-02]]
grads:  [ -0.04772554 -41.14050527]
Stock Position:  -0.047725543742730414
Bond Position:  [8.41210122]


portfolio before change:  [3.11172126]
curr_Stock_Price:  111.14775537089751
curr_Factors:  [1.11147755e+02 4.24099395e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.11172126]
Stock Price:  109.42325230352165
PL:  [-6.31153104]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.45236240e-02 -3.25047317e-01]
 [-1.39153302e-02 -1.95877764e-01]
 [ 2.60686039e-01  1.62911318e-01]
 [ 2.24539846e-01  1.57833399e-01]
 [ 1.48491726e-01 -1.57912119e-01]
 [ 7.77575647e-02 -6.93885852e-02]
 [ 2.23883963e-01 -9.69819578e-02]
 [-3.41402662e-02  1.86818268e-02]
 [ 2.60407688e-02 -1.11236533e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.77975852]
curr_Stock_Price:  100.91703464646965
curr_Factors:  [1.00917035e+02 4.06701522e-02]
mat_Sqrt:  [[ 2.03517791e+01  0.00000000e+00]
 [-8.06673686e-03  1.84832161e-02]]
grads:  [-1.01409269e-02 -1.75860800e+01]
Stock Position:  -0.010140926891416631
Bond Position:  [9.80315079]


portfolio before change:  [8.81864339]
curr_Stock_Price:  97.56605212021374
curr_Factors:  [9.75660521e+01 4.15279298e-02]
mat_Sqrt:  [[ 1.98824030e+01  0.00000000e+00]
 [-8.15136109e-03  1.86771146e-02]]
grads:  [-4.99956644e-03 -1.04875816e+01]
Stock Position:  -0.004999566440709372
Bond Position:  [9.30643135]


portfolio before change:  [8.83005649]
curr_Stock_Price:  96.21419001514307
curr_Factors:  [9.62141900e+01 4.12234375e-02]
mat_Sqrt:  [[ 1.95349017e+01  0.00000000e+00]
 [-8.12142229e-03  1.86085162e-02]]
grads:  [0.01698429 8.7546646 ]
Stock Position:  0.01698428650313856
Bond Position:  [7.19592712]


portfolio before change:  [8.84616187]
curr_Stock_Price:  96.95054803756673
curr_Factors:  [9.69505480e+01 3.80338187e-02]
mat_Sqrt:  [[ 1.89075490e+01  0.00000000e+00]
 [-7.80090443e-03  1.78741175e-02]]
grads:  [0.01551888 8.83027645]
Stock Position:  0.015518880265536859
Bond Position:  [7.34159792]


portfolio before change:  [8.83094456]
curr_Stock_Price:  95.73338382563368
curr_Factors:  [9.57333838e+01 3.79113869e-02]
mat_Sqrt:  [[ 1.86401004e+01  0.00000000e+00]
 [-7.78833866e-03  1.78453257e-02]]
grads:  [ 4.26892698e-03 -8.84893456e+00]
Stock Position:  0.004268926982964342
Bond Position:  [8.42226574]


portfolio before change:  [8.83817172]
curr_Stock_Price:  96.43964487803862
curr_Factors:  [9.64396449e+01 3.94087049e-02]
mat_Sqrt:  [[ 1.91448375e+01  0.00000000e+00]
 [-7.94065034e-03  1.81943156e-02]]
grads:  [ 2.47972350e-03 -3.81375077e+00]
Stock Position:  0.0024797234975547275
Bond Position:  [8.59902807]


portfolio before change:  [8.85528656]
curr_Stock_Price:  101.60725648393966
curr_Factors:  [1.01607256e+02 3.80234766e-02]
mat_Sqrt:  [[ 1.98130181e+01  0.00000000e+00]
 [-7.79984376e-03  1.78716872e-02]]
grads:  [ 0.00916355 -5.42656978]
Stock Position:  0.009163549226962704
Bond Position:  [7.92420346]


portfolio before change:  [8.8640635]
curr_Stock_Price:  102.1325821380097
curr_Factors:  [1.02132582e+02 3.99959666e-02]
mat_Sqrt:  [[ 2.04254865e+01  0.00000000e+00]
 [-7.99959665e-03  1.83293786e-02]]
grads:  [-0.00127228  1.0192286 ]
Stock Position:  -0.0012722756200951426
Bond Position:  [8.9940043]


portfolio before change:  [8.86270486]
curr_Stock_Price:  106.7359612694537
curr_Factors:  [1.06735961e+02 3.56759498e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.86270486]
Stock Price:  109.24063729467495
PL:  [-0.37793243]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 2.09578127e-02 -2.36893731e-01]
 [-1.09133187e-03  8.16543699e-02]
 [ 2.42722348e-01  1.56792998e-01]
 [ 1.21321501e-01  1.40765948e-01]
 [-4.69723107e-02 -3.74378091e-03]
 [ 1.19068987e-01 -1.48713399e-01]
 [ 2.64557914e-01 -1.25712245e-01]
 [-8.89610117e-02  1.56944457e-02]
 [ 2.69498969e-02 -1.61587785e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.15500175]
curr_Stock_Price:  98.16819329827302
curr_Factors:  [9.81681933e+01 4.19404624e-02]
mat_Sqrt:  [[ 2.01042282e+01  0.00000000e+00]
 [-8.19174828e-03  1.87696533e-02]]
grads:  [-4.10018663e-03 -1.26211032e+01]
Stock Position:  -0.004100186632393991
Bond Position:  [-9.75249384]


portfolio before change:  [-10.16491399]
curr_Stock_Price:  99.39613106329921
curr_Factors:  [9.93961311e+01 3.89066923e-02]
mat_Sqrt:  [[ 1.96056676e+01  0.00000000e+00]
 [-7.88991176e-03  1.80780589e-02]]
grads:  [1.76201890e-03 4.51676644e+00]
Stock Position:  0.0017620188978288568
Bond Position:  [-10.34005185]


portfolio before change:  [-10.17250887]
curr_Stock_Price:  98.02068566606047
curr_Factors:  [9.80206857e+01 3.98550327e-02]
mat_Sqrt:  [[ 1.95685804e+01  0.00000000e+00]
 [-7.98549011e-03  1.82970565e-02]]
grads:  [0.01590061 8.56930176]
Stock Position:  0.015900612929161954
Bond Position:  [-11.73109785]


portfolio before change:  [-10.13356772]
curr_Stock_Price:  100.83870104722418
curr_Factors:  [1.00838701e+02 3.74783477e-02]
mat_Sqrt:  [[ 1.95216922e+01  0.00000000e+00]
 [-7.74373013e-03  1.77431147e-02]]
grads:  [0.00936173 7.93355339]
Stock Position:  0.009361729258372982
Bond Position:  [-11.07759233]


portfolio before change:  [-10.11817634]
curr_Stock_Price:  103.0745654152022
curr_Factors:  [1.03074565e+02 3.60792283e-02]
mat_Sqrt:  [[ 1.95785323e+01  0.00000000e+00]
 [-7.59781319e-03  1.74087770e-02]]
grads:  [-0.00248263 -0.21505134]
Stock Position:  -0.0024826289265667263
Bond Position:  [-9.86228044]


portfolio before change:  [-10.12675475]
curr_Stock_Price:  104.54318431844105
curr_Factors:  [1.04543184e+02 3.25169648e-02]
mat_Sqrt:  [[ 1.88517089e+01  0.00000000e+00]
 [-7.21298439e-03  1.65270235e-02]]
grads:  [ 2.87322168e-03 -8.99819614e+00]
Stock Position:  0.00287322167623973
Bond Position:  [-10.42713049]


portfolio before change:  [-10.14421361]
curr_Stock_Price:  100.28177013785177
curr_Factors:  [1.00281770e+02 3.35109358e-02]
mat_Sqrt:  [[ 1.83575732e+01  0.00000000e+00]
 [-7.32239696e-03  1.67777192e-02]]
grads:  [ 0.01142267 -7.49280902]
Stock Position:  0.011422674942826854
Bond Position:  [-11.28969967]


portfolio before change:  [-10.1148475]
curr_Stock_Price:  103.34693372953653
curr_Factors:  [1.03346934e+02 3.11766801e-02]
mat_Sqrt:  [[ 1.82478847e+01  0.00000000e+00]
 [-7.06276774e-03  1.61828339e-02]]
grads:  [-0.00449978  0.9698206 ]
Stock Position:  -0.004499776015156092
Bond Position:  [-9.64980945]


portfolio before change:  [-10.13305796]
curr_Stock_Price:  106.32138203066945
curr_Factors:  [1.06321382e+02 3.16463239e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.13305796]
Stock Price:  104.96219934623439
PL:  [-15.09525731]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.27853845e-02 -2.17903397e-01]
 [ 5.76698201e-05  8.20293341e-02]
 [ 2.28809687e-01  1.52054433e-01]
 [ 2.20278643e-01  1.60327655e-01]
 [ 5.78786348e-03 -2.89100316e-02]
 [ 8.76889019e-02 -1.48792697e-01]
 [ 1.79606409e-01 -3.54288296e-03]
 [-2.65291825e-01 -2.81847072e-01]
 [ 4.34340702e-02 -6.09347914e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.25293586]
curr_Stock_Price:  99.46054484932775
curr_Factors:  [9.94605448e+01 3.93176606e-02]
mat_Sqrt:  [[ 1.97217145e+01  0.00000000e+00]
 [-7.93147255e-03  1.81732867e-02]]
grads:  [-7.49864943e-03 -1.19903131e+01]
Stock Position:  -0.007498649429378518
Bond Position:  [-0.5071161]


portfolio before change:  [-1.25209548]
curr_Stock_Price:  99.31465207775814
curr_Factors:  [9.93146521e+01 4.18481033e-02]
mat_Sqrt:  [[ 2.03166086e+01  0.00000000e+00]
 [-8.18272359e-03  1.87489751e-02]]
grads:  [1.76497007e-03 4.37513697e+00]
Stock Position:  0.0017649700736256419
Bond Position:  [-1.42738287]


portfolio before change:  [-1.25261456]
curr_Stock_Price:  99.42501981683053
curr_Factors:  [9.94250198e+01 4.31173714e-02]
mat_Sqrt:  [[ 2.06453298e+01  0.00000000e+00]
 [-8.30588913e-03  1.90311828e-02]]
grads:  [0.01429726 7.98975212]
Stock Position:  0.014297261662839384
Bond Position:  [-2.67412008]


portfolio before change:  [-1.28103294]
curr_Stock_Price:  97.53088181065444
curr_Factors:  [9.75308818e+01 4.61133852e-02]
mat_Sqrt:  [[ 2.09438083e+01  0.00000000e+00]
 [-8.58961095e-03  1.96812712e-02]]
grads:  [0.01385858 8.14620423]
Stock Position:  0.013858576451078141
Bond Position:  [-2.63267212]


portfolio before change:  [-1.26314368]
curr_Stock_Price:  98.91673329028475
curr_Factors:  [9.89167333e+01 4.54114710e-02]
mat_Sqrt:  [[ 2.10791236e+01  0.00000000e+00]
 [-8.52398695e-03  1.95309077e-02]]
grads:  [-3.23993960e-04 -1.48021956e+00]
Stock Position:  -0.00032399395969358866
Bond Position:  [-1.23109525]


portfolio before change:  [-1.26505677]
curr_Stock_Price:  102.92109834581365
curr_Factors:  [1.02921098e+02 4.68731640e-02]
mat_Sqrt:  [[ 2.22826350e+01  0.00000000e+00]
 [-8.66008444e-03  1.98427462e-02]]
grads:  [ 1.02099438e-03 -7.49859395e+00]
Stock Position:  0.0010209943808533262
Bond Position:  [-1.37013863]


portfolio before change:  [-1.26560934]
curr_Stock_Price:  103.0510354269757
curr_Factors:  [1.03051035e+02 4.52327339e-02]
mat_Sqrt:  [[ 2.19168825e+01  0.00000000e+00]
 [-8.50719544e-03  1.94924335e-02]]
grads:  [ 0.00812434 -0.18175683]
Stock Position:  0.008124338312295039
Bond Position:  [-2.10283082]


portfolio before change:  [-1.25094651]
curr_Stock_Price:  104.98528644179314
curr_Factors:  [1.04985286e+02 4.56058630e-02]
mat_Sqrt:  [[ 2.24201636e+01  0.00000000e+00]
 [-8.54221170e-03  1.95726659e-02]]
grads:  [ -0.01731923 -14.40003491]
Stock Position:  -0.01731923010775902
Bond Position:  [0.56731782]


portfolio before change:  [-1.20197884]
curr_Stock_Price:  102.17431033685999
curr_Factors:  [1.02174310e+02 4.37836221e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.20197884]
Stock Price:  101.88486677934318
PL:  [-3.08684562]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.69582096e-02 -4.38547324e-01]
 [-2.39106464e-01  1.92256076e-02]
 [ 2.35542279e-01  1.54347512e-01]
 [ 2.18369457e-01  1.52089011e-01]
 [ 1.63940736e-01 -1.70563217e-01]
 [ 7.86895114e-02 -9.86066261e-02]
 [ 1.04673407e-01 -2.95160489e-01]
 [ 5.53507865e-02 -1.16755865e-01]
 [ 8.37784590e-03 -4.02096347e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.47021121]
curr_Stock_Price:  103.48523446131539
curr_Factors:  [1.03485234e+02 3.95235575e-02]
mat_Sqrt:  [[ 2.05734157e+01  0.00000000e+00]
 [-7.95221303e-03  1.82208091e-02]]
grads:  [-1.30438211e-02 -2.40684880e+01]
Stock Position:  -0.013043821061053184
Bond Position:  [27.82005409]


portfolio before change:  [26.51356146]
curr_Stock_Price:  101.22847671686145
curr_Factors:  [1.01228477e+02 4.58615272e-02]
mat_Sqrt:  [[ 2.16783866e+01  0.00000000e+00]
 [-8.56612184e-03  1.96274509e-02]]
grads:  [-0.01064266  0.97952646]
Stock Position:  -0.010642661033470375
Bond Position:  [27.59090182]


portfolio before change:  [26.55372942]
curr_Stock_Price:  98.7508010359379
curr_Factors:  [9.87508010e+01 4.59759632e-02]
mat_Sqrt:  [[ 2.11741529e+01  0.00000000e+00]
 [-8.57680250e-03  1.96519233e-02]]
grads:  [0.01430542 7.85406645]
Stock Position:  0.014305415514270678
Bond Position:  [25.14105818]


portfolio before change:  [26.52115231]
curr_Stock_Price:  95.59459906782017
curr_Factors:  [9.55945991e+01 4.69315124e-02]
mat_Sqrt:  [[ 2.07093101e+01  0.00000000e+00]
 [-8.66547285e-03  1.98550926e-02]]
grads:  [0.01374969 7.65994968]
Stock Position:  0.013749687561763273
Bond Position:  [25.20675644]


portfolio before change:  [26.53179262]
curr_Stock_Price:  95.45159759768607
curr_Factors:  [9.54515976e+01 4.76219792e-02]
mat_Sqrt:  [[ 2.08298874e+01  0.00000000e+00]
 [-8.72898429e-03  2.00006156e-02]]
grads:  [ 4.29675128e-03 -8.52789836e+00]
Stock Position:  0.004296751283502447
Bond Position:  [26.12166084]


portfolio before change:  [26.53927667]
curr_Stock_Price:  94.1529322514873
curr_Factors:  [9.41529323e+01 4.69471327e-02]
mat_Sqrt:  [[ 2.04003861e+01  0.00000000e+00]
 [-8.66691481e-03  1.98583966e-02]]
grads:  [ 1.74771455e-03 -4.96548781e+00]
Stock Position:  0.0017477145493841296
Bond Position:  [26.37472422]


portfolio before change:  [26.55330257]
curr_Stock_Price:  94.63083521174254
curr_Factors:  [9.46308352e+01 4.77427466e-02]
mat_Sqrt:  [[ 2.06769450e+01  0.00000000e+00]
 [-8.74004545e-03  2.00259599e-02]]
grads:  [-1.16773494e-03 -1.47388934e+01]
Stock Position:  -0.0011677349387624692
Bond Position:  [26.6638063]


portfolio before change:  [26.56883334]
curr_Stock_Price:  92.75066775154966
curr_Factors:  [9.27506678e+01 4.65807770e-02]
mat_Sqrt:  [[ 2.00179873e+01  0.00000000e+00]
 [-8.63303210e-03  1.97807615e-02]]
grads:  [ 2.19520031e-04 -5.90249598e+00]
Stock Position:  0.00021952003137478966
Bond Position:  [26.54847271]


portfolio before change:  [26.58292968]
curr_Stock_Price:  96.48054745552277
curr_Factors:  [9.64805475e+01 4.59251777e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.58292968]
Stock Price:  94.69186083380752
PL:  [26.58292968]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-2.22341559e-03  8.10163639e-02]
 [-2.22856928e-01 -3.10233158e-01]
 [ 1.15586736e-01  1.38431277e-01]
 [ 3.45364898e-02 -6.75760839e-02]
 [ 7.70318208e-02 -4.66353374e-02]
 [ 2.39045416e-01 -1.23933947e-01]
 [ 7.91551071e-02 -4.74111098e-02]
 [ 5.04242133e-02 -7.75303718e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.6400116]
curr_Stock_Price:  98.82365401895882
curr_Factors:  [9.88236540e+01 3.89823922e-02]
mat_Sqrt:  [[ 1.95117019e+01  0.00000000e+00]
 [-7.89758365e-03  1.80956374e-02]]
grads:  [-6.81017719e-03 -1.05227381e+01]
Stock Position:  -0.006810177187948383
Bond Position:  [-4.96700501]


portfolio before change:  [-5.64813046]
curr_Stock_Price:  99.6510532637343
curr_Factors:  [9.96510533e+01 3.89832160e-02]
mat_Sqrt:  [[ 1.96752711e+01  0.00000000e+00]
 [-7.89766710e-03  1.80958287e-02]]
grads:  [1.68409493e-03 4.47707400e+00]
Stock Position:  0.0016840949335459566
Bond Position:  [-5.81595229]


portfolio before change:  [-5.64553328]
curr_Stock_Price:  102.92039426699914
curr_Factors:  [1.02920394e+02 3.86977074e-02]
mat_Sqrt:  [[ 2.02462250e+01  0.00000000e+00]
 [-7.86869314e-03  1.80294410e-02]]
grads:  [ -0.01769484 -17.20703145]
Stock Position:  -0.017694843278287256
Bond Position:  [-3.82437304]


portfolio before change:  [-5.61209338]
curr_Stock_Price:  100.92249211604947
curr_Factors:  [1.00922492e+02 3.97402978e-02]
mat_Sqrt:  [[ 2.01188672e+01  0.00000000e+00]
 [-7.97398749e-03  1.82707006e-02]]
grads:  [0.00874816 7.57668138]
Stock Position:  0.008748161448109653
Bond Position:  [-6.49497964]


portfolio before change:  [-5.64303753]
curr_Stock_Price:  97.75658757562445
curr_Factors:  [9.77565876e+01 4.06894769e-02]
mat_Sqrt:  [[ 1.97190999e+01  0.00000000e+00]
 [-8.06865311e-03  1.84876068e-02]]
grads:  [ 2.55785958e-04 -3.65520992e+00]
Stock Position:  0.00025578595798945227
Bond Position:  [-5.66804229]


portfolio before change:  [-5.64575284]
curr_Stock_Price:  98.22344699156933
curr_Factors:  [9.82234470e+01 3.71118622e-02]
mat_Sqrt:  [[ 1.89221963e+01  0.00000000e+00]
 [-7.70577572e-03  1.76561503e-02]]
grads:  [ 0.00299534 -2.64130836]
Stock Position:  0.002995344197760749
Bond Position:  [-5.93996587]


portfolio before change:  [-5.63981962]
curr_Stock_Price:  101.19604345023023
curr_Factors:  [1.01196043e+02 3.77235441e-02]
mat_Sqrt:  [[ 1.96548519e+01  0.00000000e+00]
 [-7.76901992e-03  1.78010609e-02]]
grads:  [ 0.00941021 -6.96216632]
Stock Position:  0.009410206051729127
Bond Position:  [-6.59209524]


portfolio before change:  [-5.66488752]
curr_Stock_Price:  98.88248816040623
curr_Factors:  [9.88824882e+01 3.46104435e-02]
mat_Sqrt:  [[ 1.83959817e+01  0.00000000e+00]
 [-7.44155290e-03  1.70507397e-02]]
grads:  [ 0.00317804 -2.78058961]
Stock Position:  0.0031780420015449992
Bond Position:  [-5.97914022]


portfolio before change:  [-5.66249293]
curr_Stock_Price:  100.57689987564198
curr_Factors:  [1.00576900e+02 3.36361558e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.66249293]
Stock Price:  99.81448902110844
PL:  [-5.66249293]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.47264834e-02 -2.35621297e-01]
 [-2.85535173e-01 -5.79371989e-03]
 [ 4.36113570e-02 -2.16127073e-02]
 [ 2.15172051e-01  1.63311654e-01]
 [ 1.61080751e-01 -1.67933586e-01]
 [ 7.85071931e-02 -9.28906509e-02]
 [ 7.70332705e-02 -3.17832390e-01]
 [ 5.56812408e-02 -1.15889605e-01]
 [ 1.55950538e-02  3.57800564e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.02695182]
curr_Stock_Price:  99.646351700943
curr_Factors:  [9.96463517e+01 3.79939803e-02]
mat_Sqrt:  [[ 1.94231113e+01  0.00000000e+00]
 [-7.79681784e-03  1.78647540e-02]]
grads:  [-8.11198810e-03 -1.31891711e+01]
Stock Position:  -0.00811198810396055
Bond Position:  [0.83528184]


portfolio before change:  [0.01218449]
curr_Stock_Price:  101.51828226589586
curr_Factors:  [1.01518282e+02 3.87542594e-02]
mat_Sqrt:  [[ 1.99849921e+01  0.00000000e+00]
 [-7.87444062e-03  1.80426101e-02]]
grads:  [-0.014414   -0.32111318]
Stock Position:  -0.014414004138045096
Bond Position:  [1.47546943]


portfolio before change:  [0.01857523]
curr_Stock_Price:  101.12610673873262
curr_Factors:  [1.01126107e+02 4.07186881e-02]
mat_Sqrt:  [[ 2.04061078e+01  0.00000000e+00]
 [-8.07154886e-03  1.84942418e-02]]
grads:  [ 0.00167493 -1.16861819]
Stock Position:  0.001674929810846326
Bond Position:  [-0.1508039]


portfolio before change:  [0.01369716]
curr_Stock_Price:  98.25873619508857
curr_Factors:  [9.82587362e+01 3.75653691e-02]
mat_Sqrt:  [[ 1.90442996e+01  0.00000000e+00]
 [-7.75271504e-03  1.77637018e-02]]
grads:  [0.01504109 9.19355979]
Stock Position:  0.015041094033256949
Bond Position:  [-1.46422173]


portfolio before change:  [-0.02839268]
curr_Stock_Price:  95.50909923783301
curr_Factors:  [9.55090992e+01 3.86461302e-02]
mat_Sqrt:  [[ 1.87757700e+01  0.00000000e+00]
 [-7.86344761e-03  1.80174219e-02]]
grads:  [ 4.67562852e-03 -9.32062236e+00]
Stock Position:  0.004675628522204104
Bond Position:  [-0.47495775]


portfolio before change:  [-0.03289545]
curr_Stock_Price:  94.59687214402847
curr_Factors:  [9.45968721e+01 4.14704364e-02]
mat_Sqrt:  [[ 1.92639827e+01  0.00000000e+00]
 [-8.14571655e-03  1.86641814e-02]]
grads:  [ 1.97084839e-03 -4.97694751e+00]
Stock Position:  0.001970848392851183
Bond Position:  [-0.21933154]


portfolio before change:  [-0.03533977]
curr_Stock_Price:  93.4122951550038
curr_Factors:  [9.34122952e+01 4.32176928e-02]
mat_Sqrt:  [[ 1.94193564e+01  0.00000000e+00]
 [-8.31554620e-03  1.90533099e-02]]
grads:  [-3.17622044e-03 -1.66812166e+01]
Stock Position:  -0.0031762204446102358
Bond Position:  [0.26135828]


portfolio before change:  [-0.03034799]
curr_Stock_Price:  91.8818398757139
curr_Factors:  [9.18818399e+01 4.35116860e-02]
mat_Sqrt:  [[ 1.91660510e+01  0.00000000e+00]
 [-8.34378198e-03  1.91180062e-02]]
grads:  [ 2.66245267e-04 -6.06180393e+00]
Stock Position:  0.0002662452668334152
Bond Position:  [-0.0548111]


portfolio before change:  [-0.03011374]
curr_Stock_Price:  92.86463431207812
curr_Factors:  [9.28646343e+01 4.29102590e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.03011374]
Stock Price:  94.22317193830851
PL:  [-0.03011374]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.52601122e-02 -1.93381707e-01]
 [-2.73572881e-02 -4.17731804e-02]
 [ 2.38976700e-01  1.55517254e-01]
 [ 2.27842144e-01  1.55651984e-01]
 [ 1.11547991e-01 -1.28739527e-01]
 [ 7.80633922e-02 -7.89767735e-02]
 [ 9.83666427e-02 -3.00347845e-01]
 [ 5.54439568e-02 -1.16511627e-01]
 [ 1.02506322e-02  1.87248574e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.65708974]
curr_Stock_Price:  98.53082602897301
curr_Factors:  [9.85308260e+01 3.94505181e-02]
mat_Sqrt:  [[ 1.95703449e+01  0.00000000e+00]
 [-7.94486180e-03  1.82039653e-02]]
grads:  [-6.62526946e-03 -1.06230540e+01]
Stock Position:  -0.006625269463703985
Bond Position:  [-7.00429647]


portfolio before change:  [-7.65861157]
curr_Stock_Price:  98.23178975668752
curr_Factors:  [9.82317898e+01 4.13216821e-02]
mat_Sqrt:  [[ 1.99682982e+01  0.00000000e+00]
 [-8.13109411e-03  1.86306771e-02]]
grads:  [-0.00228305 -2.24217188]
Stock Position:  -0.0022830487739983335
Bond Position:  [-7.4343436]


portfolio before change:  [-7.66270892]
curr_Stock_Price:  98.39790445846756
curr_Factors:  [9.83979045e+01 4.00184331e-02]
mat_Sqrt:  [[ 1.96841148e+01  0.00000000e+00]
 [-8.00184310e-03  1.83345259e-02]]
grads:  [0.01558871 8.48220757]
Stock Position:  0.015588711860912222
Bond Position:  [-9.1966055]


portfolio before change:  [-7.69804421]
curr_Stock_Price:  96.42623145239105
curr_Factors:  [9.64262315e+01 3.92628474e-02]
mat_Sqrt:  [[ 1.91067178e+01  0.00000000e+00]
 [-7.92594195e-03  1.81606145e-02]]
grads:  [0.01548012 8.5708545 ]
Stock Position:  0.015480117606761547
Bond Position:  [-9.19073362]


portfolio before change:  [-7.7032452]
curr_Stock_Price:  96.3871831659425
curr_Factors:  [9.63871832e+01 4.16551063e-02]
mat_Sqrt:  [[ 1.96722218e+01  0.00000000e+00]
 [-8.16383305e-03  1.87056915e-02]]
grads:  [ 2.81419430e-03 -6.88237201e+00]
Stock Position:  0.0028141943013777243
Bond Position:  [-7.97449746]


portfolio before change:  [-7.70918952]
curr_Stock_Price:  95.69210956782582
curr_Factors:  [9.56921096e+01 4.52495063e-02]
mat_Sqrt:  [[ 2.03555598e+01  0.00000000e+00]
 [-8.50877253e-03  1.94960471e-02]]
grads:  [ 2.14168034e-03 -4.05091212e+00]
Stock Position:  0.002141680343643658
Bond Position:  [-7.91413143]


portfolio before change:  [-7.71601563]
curr_Stock_Price:  94.35294859252106
curr_Factors:  [9.43529486e+01 4.69673176e-02]
mat_Sqrt:  [[ 2.04481186e+01  0.00000000e+00]
 [-8.66877778e-03  1.98626652e-02]]
grads:  [-1.59994688e-03 -1.51212258e+01]
Stock Position:  -0.0015999468799711273
Bond Position:  [-7.56505592]


portfolio before change:  [-7.71747968]
curr_Stock_Price:  92.90326110372422
curr_Factors:  [9.29032611e+01 4.94736223e-02]
mat_Sqrt:  [[ 2.06641627e+01  0.00000000e+00]
 [-8.89706669e-03  2.03857408e-02]]
grads:  [ 2.22322775e-04 -5.71534918e+00]
Stock Position:  0.0002223227753016005
Bond Position:  [-7.73813419]


portfolio before change:  [-7.72118024]
curr_Stock_Price:  93.66552899686637
curr_Factors:  [9.36655290e+01 4.88827455e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.72118024]
Stock Price:  91.03475718248416
PL:  [-7.72118024]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.29645349e-02 -3.10816315e-01]
 [-2.96802715e-01 -1.19485066e-02]
 [ 1.12379315e-01  5.28720999e-02]
 [-6.02302842e-03  7.25821118e-02]
 [-3.77780793e-03 -3.48629621e-03]
 [ 8.02406946e-02 -6.94034547e-02]
 [ 2.43842569e-01 -1.32497447e-01]
 [-1.03697010e-01 -8.24263403e-03]
 [ 4.36234713e-02 -6.13844562e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.56172525]
curr_Stock_Price:  100.595033127865
curr_Factors:  [1.00595033e+02 4.09477913e-02]
mat_Sqrt:  [[ 2.03559689e+01  0.00000000e+00]
 [-8.09422424e-03  1.85461976e-02]]
grads:  [-9.75713300e-03 -1.67590317e+01]
Stock Position:  -0.009757132999666414
Bond Position:  [7.54324437]


portfolio before change:  [6.55579074]
curr_Stock_Price:  101.58990283432996
curr_Factors:  [1.01589903e+02 3.70706232e-02]
mat_Sqrt:  [[ 1.95598486e+01  0.00000000e+00]
 [-7.70149317e-03  1.76463377e-02]]
grads:  [-0.01544069 -0.67710971]
Stock Position:  -0.015440685501137696
Bond Position:  [8.12440848]


portfolio before change:  [6.57213134]
curr_Stock_Price:  100.79477081775943
curr_Factors:  [1.00794771e+02 3.62980221e-02]
mat_Sqrt:  [[ 1.92034599e+01  0.00000000e+00]
 [-7.62081592e-03  1.74614829e-02]]
grads:  [0.00705366 3.02792725]
Stock Position:  0.007053655522558712
Bond Position:  [5.86115975]


portfolio before change:  [6.58791333]
curr_Stock_Price:  102.61661763791322
curr_Factors:  [1.02616618e+02 3.42932557e-02]
mat_Sqrt:  [[ 1.90029950e+01  0.00000000e+00]
 [-7.40737532e-03  1.69724291e-02]]
grads:  [1.35001889e-03 4.27647166e+00]
Stock Position:  0.0013500188869192847
Bond Position:  [6.44937896]


portfolio before change:  [6.59036501]
curr_Stock_Price:  102.04342853514461
curr_Factors:  [1.02043429e+02 3.49867462e-02]
mat_Sqrt:  [[ 1.90869625e+01  0.00000000e+00]
 [-7.48189775e-03  1.71431814e-02]]
grads:  [-0.00027764 -0.20336343]
Stock Position:  -0.0002776425190371913
Bond Position:  [6.61869661]


portfolio before change:  [6.59426122]
curr_Stock_Price:  99.9326827504993
curr_Factors:  [9.99326828e+01 3.55962989e-02]
mat_Sqrt:  [[ 1.88542807e+01  0.00000000e+00]
 [-7.54679258e-03  1.72918741e-02]]
grads:  [ 2.64929458e-03 -4.01364561e+00]
Stock Position:  0.002649294578149243
Bond Position:  [6.32951011]


portfolio before change:  [6.60043051]
curr_Stock_Price:  101.0664705158763
curr_Factors:  [1.01066471e+02 3.53298506e-02]
mat_Sqrt:  [[ 1.89966928e+01  0.00000000e+00]
 [-7.51849459e-03  1.72270353e-02]]
grads:  [ 0.00979202 -7.69125068]
Stock Position:  0.009792017192722678
Bond Position:  [5.61078589]


portfolio before change:  [6.62694483]
curr_Stock_Price:  103.4876500880241
curr_Factors:  [1.03487650e+02 3.54503759e-02]
mat_Sqrt:  [[ 1.94849344e+01  0.00000000e+00]
 [-7.53130808e-03  1.72563947e-02]]
grads:  [-0.00550653 -0.47765679]
Stock Position:  -0.005506530727198648
Bond Position:  [7.19680276]


portfolio before change:  [6.63804273]
curr_Stock_Price:  102.12588660850659
curr_Factors:  [1.02125887e+02 3.51504644e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.63804273]
Stock Price:  102.36654827760458
PL:  [4.27149445]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-4.97739424e-02 -1.90415654e-01]
 [-5.81811692e-02  6.78491321e-02]
 [ 1.97293447e-01  1.44845353e-01]
 [-3.04089727e-02  5.75070719e-02]
 [ 7.70118027e-03 -4.61263249e-02]
 [ 7.67031597e-02 -3.51588553e-02]
 [ 1.93931513e-01 -2.07077644e-01]
 [ 5.28126757e-02 -1.23409324e-01]
 [ 1.57270510e-02  3.62013160e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.57508251]
curr_Stock_Price:  99.12342874010145
curr_Factors:  [9.91234287e+01 3.93478449e-02]
mat_Sqrt:  [[ 1.96624120e+01  0.00000000e+00]
 [-7.93451649e-03  1.81802612e-02]]
grads:  [-6.75797796e-03 -1.04737579e+01]
Stock Position:  -0.006757977961001446
Bond Position:  [-2.90520856]


portfolio before change:  [-3.58294921]
curr_Stock_Price:  100.07249064982261
curr_Factors:  [1.00072491e+02 3.88774007e-02]
mat_Sqrt:  [[ 1.97316462e+01  0.00000000e+00]
 [-7.88694118e-03  1.80712525e-02]]
grads:  [-1.44789644e-03  3.75453401e+00]
Stock Position:  -0.0014478964402378316
Bond Position:  [-3.43805461]


portfolio before change:  [-3.58486311]
curr_Stock_Price:  100.20678213022997
curr_Factors:  [1.00206782e+02 3.89912853e-02]
mat_Sqrt:  [[ 1.97870427e+01  0.00000000e+00]
 [-7.89848444e-03  1.80977014e-02]]
grads:  [0.01316564 8.00352209]
Stock Position:  0.013165643024875079
Bond Position:  [-4.90414983]


portfolio before change:  [-3.55067378]
curr_Stock_Price:  102.98993679755925
curr_Factors:  [1.02989937e+02 3.76041935e-02]
mat_Sqrt:  [[ 1.99716033e+01  0.00000000e+00]
 [-7.75672029e-03  1.77728789e-02]]
grads:  [-2.65919004e-04  3.23566441e+00]
Stock Position:  -0.00026591900372054285
Bond Position:  [-3.5232868]


portfolio before change:  [-3.55117178]
curr_Stock_Price:  98.23630701970559
curr_Factors:  [9.82363070e+01 3.69377234e-02]
mat_Sqrt:  [[ 1.88802217e+01  0.00000000e+00]
 [-7.68767569e-03  1.76146779e-02]]
grads:  [-6.58360825e-04 -2.61863006e+00]
Stock Position:  -0.0006583608248982267
Bond Position:  [-3.48649684]


portfolio before change:  [-3.55351329]
curr_Stock_Price:  99.14435907346017
curr_Factors:  [9.91443591e+01 3.93693110e-02]
mat_Sqrt:  [[ 1.96719276e+01  0.00000000e+00]
 [-7.93668052e-03  1.81852196e-02]]
grads:  [ 0.00311909 -1.93337535]
Stock Position:  0.003119093286092412
Bond Position:  [-3.8627538]


portfolio before change:  [-3.55956264]
curr_Stock_Price:  97.82426727980814
curr_Factors:  [9.78242673e+01 4.16694941e-02]
mat_Sqrt:  [[ 1.99689724e+01  0.00000000e+00]
 [-8.16524284e-03  1.87089217e-02]]
grads:  [ 5.18581616e-03 -1.10683901e+01]
Stock Position:  0.005185816162942833
Bond Position:  [-4.06686131]


portfolio before change:  [-3.56858039]
curr_Stock_Price:  96.47755370663532
curr_Factors:  [9.64775537e+01 4.23016324e-02]
mat_Sqrt:  [[ 1.98428864e+01  0.00000000e+00]
 [-8.22694426e-03  1.88502974e-02]]
grads:  [-5.27931760e-05 -6.54681045e+00]
Stock Position:  -5.279317600458461e-05
Bond Position:  [-3.56348703]


portfolio before change:  [-3.57017078]
curr_Stock_Price:  92.84463102233829
curr_Factors:  [9.28446310e+01 4.44743242e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.57017078]
Stock Price:  89.22240256189568
PL:  [-3.57017078]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.30839053e-02 -3.11905900e-01]
 [-3.30451512e-01 -3.36267516e-02]
 [-2.26122820e-01 -3.06566678e-01]
 [ 1.05743065e-01  1.34418514e-01]
 [ 4.08843153e-02 -1.78785674e-02]
 [ 7.73268544e-02 -3.73152061e-02]
 [ 2.28076588e-01 -1.04506352e-01]
 [-4.61990953e-02  4.33972415e-02]
 [ 3.46181785e-02 -4.00046276e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.73173458]
curr_Stock_Price:  100.61971412072504
curr_Factors:  [1.00619714e+02 4.13944431e-02]
mat_Sqrt:  [[ 2.04717091e+01  0.00000000e+00]
 [-8.13824975e-03  1.86470727e-02]]
grads:  [-9.73102927e-03 -1.67268023e+01]
Stock Position:  -0.009731029270350024
Bond Position:  [7.71086797]


portfolio before change:  [6.72358083]
curr_Stock_Price:  101.85392535202163
curr_Factors:  [1.01853925e+02 3.90868779e-02]
mat_Sqrt:  [[ 2.01369301e+01  0.00000000e+00]
 [-7.90816063e-03  1.81198724e-02]]
grads:  [-0.01713903 -1.85579406]
Stock Position:  -0.017139029061150578
Bond Position:  [8.46925822]


portfolio before change:  [6.69986227]
curr_Stock_Price:  103.48495450474054
curr_Factors:  [1.03484955e+02 4.06556954e-02]
mat_Sqrt:  [[ 2.08659379e+01  0.00000000e+00]
 [-8.06530301e-03  1.84799308e-02]]
grads:  [ -0.01724914 -16.58916807]
Stock Position:  -0.017249140173543363
Bond Position:  [8.48488875]


portfolio before change:  [6.74581938]
curr_Stock_Price:  101.06665367405078
curr_Factors:  [1.01066654e+02 4.33101498e-02]
mat_Sqrt:  [[ 2.10330730e+01  0.00000000e+00]
 [-8.32443630e-03  1.90736797e-02]]
grads:  [0.00781665 7.04732991]
Stock Position:  0.007816647328095262
Bond Position:  [5.95581699]


portfolio before change:  [6.74501766]
curr_Stock_Price:  100.58302203663932
curr_Factors:  [1.00583022e+02 3.92385895e-02]
mat_Sqrt:  [[ 1.99242221e+01  0.00000000e+00]
 [-7.92349312e-03  1.81550035e-02]]
grads:  [ 0.00166036 -0.98477356]
Stock Position:  0.0016603643882275457
Bond Position:  [6.57801319]


portfolio before change:  [6.74662302]
curr_Stock_Price:  99.56850908678956
curr_Factors:  [9.95685091e+01 3.73720727e-02]
mat_Sqrt:  [[ 1.92484426e+01  0.00000000e+00]
 [-7.73274313e-03  1.77179404e-02]]
grads:  [ 0.00317123 -2.10606907]
Stock Position:  0.0031712260821800268
Bond Position:  [6.43086877]


portfolio before change:  [6.75594737]
curr_Stock_Price:  101.49461318184851
curr_Factors:  [1.01494613e+02 3.33572136e-02]
mat_Sqrt:  [[ 1.85369328e+01  0.00000000e+00]
 [-7.30558292e-03  1.67391934e-02]]
grads:  [ 0.00984339 -6.24321314]
Stock Position:  0.009843390962285951
Bond Position:  [5.75689622]


portfolio before change:  [6.76863567]
curr_Stock_Price:  102.49113282588401
curr_Factors:  [1.02491133e+02 3.27179008e-02]
mat_Sqrt:  [[ 1.85386886e+01  0.00000000e+00]
 [-7.23523609e-03  1.65780085e-02]]
grads:  [-1.47038375e-03  2.61775963e+00]
Stock Position:  -0.001470383748995648
Bond Position:  [6.91933697]


portfolio before change:  [6.76962097]
curr_Stock_Price:  104.17453144241759
curr_Factors:  [1.04174531e+02 3.31457145e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.76962097]
Stock Price:  103.69548375272399
PL:  [3.07413721]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.12598177e-02 -2.03978377e-01]
 [ 1.99443604e-02 -5.84060317e-01]
 [ 2.49942322e-01  1.59252076e-01]
 [ 2.16029254e-01  1.62808173e-01]
 [ 7.34035690e-02 -9.79114156e-02]
 [ 7.79147875e-02 -7.43177740e-02]
 [ 1.95029239e-01 -2.05237290e-01]
 [ 9.70593306e-02  5.77086410e-03]
 [-1.23941638e-03 -1.79429574e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.28667141]
curr_Stock_Price:  99.31047297247531
curr_Factors:  [9.93104730e+01 3.62772823e-02]
mat_Sqrt:  [[ 1.89152647e+01  0.00000000e+00]
 [-7.61863844e-03  1.74564937e-02]]
grads:  [-7.41640588e-03 -1.16849570e+01]
Stock Position:  -0.00741640587650852
Bond Position:  [-1.55014463]


portfolio before change:  [-2.26223616]
curr_Stock_Price:  95.91118294792689
curr_Factors:  [9.59111829e+01 3.46363833e-02]
mat_Sqrt:  [[ 1.78498888e+01  0.00000000e+00]
 [-7.44434102e-03  1.70571281e-02]]
grads:  [-1.31631330e-02 -3.42414217e+01]
Stock Position:  -0.013163132953221668
Bond Position:  [-0.99974451]


portfolio before change:  [-2.2807842]
curr_Stock_Price:  97.2822883852212
curr_Factors:  [9.72822884e+01 3.02058904e-02]
mat_Sqrt:  [[ 1.69075079e+01  0.00000000e+00]
 [-6.95193676e-03  1.59288882e-02]]
grads:  [0.01889371 9.99768932]
Stock Position:  0.01889371437943309
Bond Position:  [-4.11880797]


portfolio before change:  [-2.26639387]
curr_Stock_Price:  98.15296166589313
curr_Factors:  [9.81529617e+01 2.97662424e-02]
mat_Sqrt:  [[ 1.69342285e+01  0.00000000e+00]
 [-6.90115844e-03  1.58125405e-02]]
grads:  [ 0.01695292 10.29614269]
Stock Position:  0.016952916731174703
Bond Position:  [-3.93037285]


portfolio before change:  [-2.2866281]
curr_Stock_Price:  97.07535615256957
curr_Factors:  [9.70753562e+01 2.78650346e-02]
mat_Sqrt:  [[ 1.62046175e+01  0.00000000e+00]
 [-6.67712927e-03  1.52992252e-02]]
grads:  [ 1.89276445e-03 -6.39976304e+00]
Stock Position:  0.0018927644463305356
Bond Position:  [-2.47036888]


portfolio before change:  [-2.2898162]
curr_Stock_Price:  96.04374153244041
curr_Factors:  [9.60437415e+01 2.88084254e-02]
mat_Sqrt:  [[ 1.63015474e+01  0.00000000e+00]
 [-6.78921797e-03  1.55560526e-02]]
grads:  [ 2.78991010e-03 -4.77741853e+00]
Stock Position:  0.0027899100999653837
Bond Position:  [-2.5577696]


portfolio before change:  [-2.28602795]
curr_Stock_Price:  97.86009142207094
curr_Factors:  [9.78600914e+01 2.59052838e-02]
mat_Sqrt:  [[ 1.57506976e+01  0.00000000e+00]
 [-6.43804738e-03  1.47514197e-02]]
grads:  [ 6.69534421e-03 -1.39130533e+01]
Stock Position:  0.006695344206901553
Bond Position:  [-2.94123495]


portfolio before change:  [-2.2778889]
curr_Stock_Price:  99.29542266592584
curr_Factors:  [9.92954227e+01 2.39636087e-02]
mat_Sqrt:  [[ 1.53711138e+01  0.00000000e+00]
 [-6.19207347e-03  1.41878227e-02]]
grads:  [0.00647825 0.40674769]
Stock Position:  0.0064782515657844965
Bond Position:  [-2.92114963]


portfolio before change:  [-2.30463635]
curr_Stock_Price:  95.3921303328233
curr_Factors:  [9.53921303e+01 2.52428477e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.30463635]
Stock Price:  95.97541279374407
PL:  [-2.30463635]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.57368187e-02 -2.44843402e-01]
 [-3.80096588e-01 -6.58756459e-02]
 [ 2.34263639e-01  1.53912015e-01]
 [ 2.01256587e-01  1.64522803e-01]
 [ 4.00961875e-02 -7.19481625e-02]
 [ 7.85875767e-02 -9.54108075e-02]
 [ 1.24301623e-01 -2.78423384e-01]
 [ 5.58715871e-02 -1.15390627e-01]
 [ 1.44761978e-02  3.22094772e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.69638085]
curr_Stock_Price:  99.74353561807138
curr_Factors:  [9.97435356e+01 3.91525391e-02]
mat_Sqrt:  [[ 1.97362540e+01  0.00000000e+00]
 [-7.91480022e-03  1.81350856e-02]]
grads:  [-8.23840432e-03 -1.35010889e+01]
Stock Position:  -0.008238404316732137
Bond Position:  [1.51810842]


portfolio before change:  [0.6765038]
curr_Stock_Price:  102.2484246237644
curr_Factors:  [1.02248425e+02 3.80363244e-02]
mat_Sqrt:  [[ 1.99414116e+01  0.00000000e+00]
 [-7.80116139e-03  1.78747063e-02]]
grads:  [-0.02050241 -3.68541137]
Stock Position:  -0.02050241408271203
Bond Position:  [2.77284334]


portfolio before change:  [0.74708394]
curr_Stock_Price:  98.87353553410578
curr_Factors:  [9.88735355e+01 4.10392495e-02]
mat_Sqrt:  [[ 2.00299456e+01  0.00000000e+00]
 [-8.10325856e-03  1.85668979e-02]]
grads:  [0.01504928 8.28959238]
Stock Position:  0.015049284502657809
Bond Position:  [-0.74089202]


portfolio before change:  [0.75198252]
curr_Stock_Price:  99.22365951480334
curr_Factors:  [9.92236595e+01 4.06466421e-02]
mat_Sqrt:  [[ 2.00044943e+01  0.00000000e+00]
 [-8.06440496e-03  1.84778731e-02]]
grads:  [0.01364994 8.90377383]
Stock Position:  0.01364994389371739
Bond Position:  [-0.60241487]


portfolio before change:  [0.73031735]
curr_Stock_Price:  97.6585331182849
curr_Factors:  [9.76585331e+01 3.96735290e-02]
mat_Sqrt:  [[ 1.94518366e+01  0.00000000e+00]
 [-7.96728602e-03  1.82553456e-02]]
grads:  [ 4.47023857e-04 -3.94121065e+00]
Stock Position:  0.0004470238568393007
Bond Position:  [0.68666166]


portfolio before change:  [0.72920341]
curr_Stock_Price:  94.39839417670501
curr_Factors:  [9.43983942e+01 4.06656037e-02]
mat_Sqrt:  [[ 1.90361106e+01  0.00000000e+00]
 [-8.06628576e-03  1.84821825e-02]]
grads:  [ 1.94088421e-03 -5.16231280e+00]
Stock Position:  0.0019408842105227133
Bond Position:  [0.54598705]


portfolio before change:  [0.73159383]
curr_Stock_Price:  95.48931921784396
curr_Factors:  [9.54893192e+01 3.94361425e-02]
mat_Sqrt:  [[ 1.89627802e+01  0.00000000e+00]
 [-7.94341412e-03  1.82006482e-02]]
grads:  [ 1.47008839e-04 -1.52974433e+01]
Stock Position:  0.00014700883891491495
Bond Position:  [0.71755605]


portfolio before change:  [0.73131112]
curr_Stock_Price:  91.12515984494071
curr_Factors:  [9.11251598e+01 3.93217287e-02]
mat_Sqrt:  [[ 1.80698524e+01  0.00000000e+00]
 [-7.93188287e-03  1.81742268e-02]]
grads:  [ 3.04982492e-04 -6.34913543e+00]
Stock Position:  0.0003049824921549676
Bond Position:  [0.70351955]


portfolio before change:  [0.73224478]
curr_Stock_Price:  93.03285007895094
curr_Factors:  [9.30328501e+01 3.99466530e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.73224478]
Stock Price:  91.6930544938086
PL:  [0.73224478]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-7.51223170e-02 -4.21789723e-01]
 [-3.54739931e-01 -4.95180371e-02]
 [-4.76826057e-01 -1.29343849e-02]
 [-7.22503609e-01 -2.15131525e-01]
 [-3.57552929e-01  5.54791643e-02]
 [ 1.04471402e+00  8.74436297e-01]
 [-1.83922730e-01  4.30218307e-01]
 [-6.36474753e-01 -6.39785771e-01]
 [ 2.33952868e-02  4.75120591e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.85750676]
curr_Stock_Price:  103.10593681410563
curr_Factors:  [1.03105937e+02 3.76597752e-02]
mat_Sqrt:  [[ 2.00088687e+01  0.00000000e+00]
 [-7.76245067e-03  1.77860089e-02]]
grads:  [-1.29545777e-02 -2.37146920e+01]
Stock Position:  -0.012954577685302745
Bond Position:  [25.19320063]


portfolio before change:  [23.88379788]
curr_Stock_Price:  102.04906164679787
curr_Factors:  [1.02049062e+02 3.68446325e-02]
mat_Sqrt:  [[ 1.95882722e+01  0.00000000e+00]
 [-7.67798229e-03  1.75924675e-02]]
grads:  [-0.0192131  -2.81472949]
Stock Position:  -0.01921309699274313
Bond Position:  [25.8444764]


portfolio before change:  [23.80281]
curr_Stock_Price:  106.9370474829718
curr_Factors:  [1.06937047e+02 3.72191739e-02]
mat_Sqrt:  [[ 2.06305855e+01  0.00000000e+00]
 [-7.71690860e-03  1.76816589e-02]]
grads:  [-0.0233862  -0.73151422]
Stock Position:  -0.02338620415873752
Bond Position:  [26.30366163]


portfolio before change:  [23.74004154]
curr_Stock_Price:  110.18355929227123
curr_Factors:  [1.10183559e+02 3.47347602e-02]
mat_Sqrt:  [[ 2.05352006e+01  0.00000000e+00]
 [-7.45490552e-03  1.70813344e-02]]
grads:  [ -0.03975587 -12.59453857]
Stock Position:  -0.039755866988359756
Bond Position:  [28.12048446]


portfolio before change:  [23.64796739]
curr_Stock_Price:  112.85330115789418
curr_Factors:  [1.12853301e+02 3.51726621e-02]
mat_Sqrt:  [[ 2.11649325e+01  0.00000000e+00]
 [-7.50175042e-03  1.71886696e-02]]
grads:  [-0.01574963  3.22765901]
Stock Position:  -0.015749629089920225
Bond Position:  [25.42536503]


portfolio before change:  [23.64249172]
curr_Stock_Price:  114.00834615891826
curr_Factors:  [1.14008346e+02 3.42285059e-02]
mat_Sqrt:  [[ 2.10926243e+01  0.00000000e+00]
 [-7.40037901e-03  1.69563985e-02]]
grads:  [ 0.06762313 51.56969491]
Stock Position:  0.06762313142100078
Bond Position:  [15.93289035]


portfolio before change:  [23.60772424]
curr_Stock_Price:  113.37637428431978
curr_Factors:  [1.13376374e+02 3.22704100e-02]
mat_Sqrt:  [[ 2.03668941e+01  0.00000000e+00]
 [-7.18558668e-03  1.64642474e-02]]
grads:  [1.88537967e-04 2.61304568e+01]
Stock Position:  0.0001885379671801093
Bond Position:  [23.58634849]


portfolio before change:  [23.61924008]
curr_Stock_Price:  111.8897645616496
curr_Factors:  [1.11889765e+02 3.58398043e-02]
mat_Sqrt:  [[ 2.11823029e+01  0.00000000e+00]
 [-7.57256145e-03  1.73509180e-02]]
grads:  [ -0.04322949 -36.87330955]
Stock Position:  -0.04322949007921549
Bond Position:  [28.45617755]


portfolio before change:  [23.65992281]
curr_Stock_Price:  111.2778886296006
curr_Factors:  [1.11277889e+02 3.49275448e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.65992281]
Stock Price:  111.34425129725511
PL:  [12.31567152]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.29654511e-02 -2.19547003e-01]
 [-2.45206925e-02 -7.42931734e-02]
 [ 2.41255718e-01  1.56293473e-01]
 [ 2.15052422e-01  1.63382227e-01]
 [ 7.21002980e-02 -9.75315557e-02]
 [ 7.76364832e-02 -6.55924839e-02]
 [ 1.93881029e-01 -2.07184585e-01]
 [ 5.24657027e-02 -1.24318886e-01]
 [ 1.51213128e-02 -4.95616651e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.13601276]
curr_Stock_Price:  99.47751908315526
curr_Factors:  [9.94775191e+01 3.89300893e-02]
mat_Sqrt:  [[ 1.96276202e+01  0.00000000e+00]
 [-7.89228376e-03  1.80834939e-02]]
grads:  [-7.58031881e-03 -1.21407403e+01]
Stock Position:  -0.007580318808720149
Bond Position:  [-0.38194145]


portfolio before change:  [-1.12573425]
curr_Stock_Price:  98.09637222473253
curr_Factors:  [9.80963722e+01 3.96645452e-02]
mat_Sqrt:  [[ 1.95368340e+01  0.00000000e+00]
 [-7.96638389e-03  1.82532786e-02]]
grads:  [-2.91474513e-03 -4.07012762e+00]
Stock Position:  -0.002914745125892771
Bond Position:  [-0.83980833]


portfolio before change:  [-1.12635642]
curr_Stock_Price:  98.16573190572225
curr_Factors:  [9.81657319e+01 3.77220515e-02]
mat_Sqrt:  [[ 1.90659110e+01  0.00000000e+00]
 [-7.76886622e-03  1.78007088e-02]]
grads:  [0.01623147 8.78018259]
Stock Position:  0.016231471061636544
Bond Position:  [-2.71973066]


portfolio before change:  [-1.12599922]
curr_Stock_Price:  98.27153922768916
curr_Factors:  [9.82715392e+01 3.97562807e-02]
mat_Sqrt:  [[ 1.95943397e+01  0.00000000e+00]
 [-7.97559083e-03  1.82743744e-02]]
grads:  [0.01461434 8.94051002]
Stock Position:  0.014614336404111212
Bond Position:  [-2.56217255]


portfolio before change:  [-1.14460103]
curr_Stock_Price:  97.0863740079206
curr_Factors:  [9.70863740e+01 4.42016877e-02]
mat_Sqrt:  [[ 2.04116309e+01  0.00000000e+00]
 [-8.40967897e-03  1.92689952e-02]]
grads:  [ 1.44692198e-03 -5.06157973e+00]
Stock Position:  0.0014469219755107582
Bond Position:  [-1.28507744]


portfolio before change:  [-1.14574414]
curr_Stock_Price:  96.74052926708104
curr_Factors:  [9.67405293e+01 4.28694259e-02]
mat_Sqrt:  [[ 2.00300620e+01  0.00000000e+00]
 [-8.28197328e-03  1.89763847e-02]]
grads:  [ 2.44680103e-03 -3.45653215e+00]
Stock Position:  0.00244680103296505
Bond Position:  [-1.38244897]


portfolio before change:  [-1.14378832]
curr_Stock_Price:  97.82244058771822
curr_Factors:  [9.78224406e+01 4.29764502e-02]
mat_Sqrt:  [[ 2.02793375e+01  0.00000000e+00]
 [-8.29230488e-03  1.90000574e-02]]
grads:  [ 5.10165892e-03 -1.09044189e+01]
Stock Position:  0.0051016589154896375
Bond Position:  [-1.64284504]


portfolio before change:  [-1.14811681]
curr_Stock_Price:  97.1350432058808
curr_Factors:  [9.71350432e+01 4.31157653e-02]
mat_Sqrt:  [[ 2.01694468e+01  0.00000000e+00]
 [-8.30573444e-03  1.90308284e-02]]
grads:  [-8.88228377e-05 -6.53250000e+00]
Stock Position:  -8.88228377296753e-05
Bond Position:  [-1.139489]


portfolio before change:  [-1.14868706]
curr_Stock_Price:  97.13908003121472
curr_Factors:  [9.71390800e+01 4.08178866e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.14868706]
Stock Price:  95.40714443245886
PL:  [-1.14868706]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-8.16804065e-02 -4.81650439e-01]
 [-5.62157469e-01 -1.84088256e-01]
 [-2.22856928e-01 -3.10233158e-01]
 [-3.16269261e-02  5.67541506e-02]
 [-4.86875241e-02 -3.70612365e-03]
 [ 8.81068402e-02 -1.56366445e-01]
 [ 2.03604371e-01 -1.96318463e-01]
 [ 9.71147845e-02  6.02411253e-02]
 [ 4.33847695e-02 -6.08177446e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [33.1872053]
curr_Stock_Price:  104.4603696537919
curr_Factors:  [1.04460370e+02 3.61240778e-02]
mat_Sqrt:  [[ 1.98540880e+01  0.00000000e+00]
 [-7.60253408e-03  1.74195939e-02]]
grads:  [-1.47017527e-02 -2.76499235e+01]
Stock Position:  -0.014701752694101077
Bond Position:  [34.72295582]


portfolio before change:  [33.21583552]
curr_Stock_Price:  103.69417566030528
curr_Factors:  [1.03694176e+02 3.49754120e-02]
mat_Sqrt:  [[ 1.93925885e+01  0.00000000e+00]
 [-7.48068574e-03  1.71404043e-02]]
grads:  [ -0.03313122 -10.74001831]
Stock Position:  -0.03313122278176186
Bond Position:  [36.65135035]


portfolio before change:  [33.27402211]
curr_Stock_Price:  102.49119148957229
curr_Factors:  [1.02491191e+02 3.58940107e-02]
mat_Sqrt:  [[ 1.94176888e+01  0.00000000e+00]
 [-7.57828589e-03  1.73640344e-02]]
grads:  [ -0.01844987 -17.86642155]
Stock Position:  -0.01844986718154159
Bond Position:  [35.16497098]


portfolio before change:  [33.28207418]
curr_Stock_Price:  103.00798710800194
curr_Factors:  [1.03007987e+02 3.47545172e-02]
mat_Sqrt:  [[ 1.92033294e+01  0.00000000e+00]
 [-7.45702538e-03  1.70861916e-02]]
grads:  [-3.57093502e-04  3.32163842e+00]
Stock Position:  -0.000357093502470196
Bond Position:  [33.31885766]


portfolio before change:  [33.29869912]
curr_Stock_Price:  103.11622922730736
curr_Factors:  [1.03116229e+02 3.68495018e-02]
mat_Sqrt:  [[ 1.97944224e+01  0.00000000e+00]
 [-7.67848962e-03  1.75936300e-02]]
grads:  [-0.00254137 -0.21065145]
Stock Position:  -0.0025413729187090876
Bond Position:  [33.56075592]


portfolio before change:  [33.31768066]
curr_Stock_Price:  102.25174937775053
curr_Factors:  [1.02251749e+02 4.04622802e-02]
mat_Sqrt:  [[ 2.05681828e+01  0.00000000e+00]
 [-8.04609522e-03  1.84359202e-02]]
grads:  [ 9.65711400e-04 -8.48161869e+00]
Stock Position:  0.0009657114000895451
Bond Position:  [33.21893498]


portfolio before change:  [33.33028113]
curr_Stock_Price:  98.0961029986835
curr_Factors:  [9.80961030e+01 4.51672952e-02]
mat_Sqrt:  [[ 2.08479711e+01  0.00000000e+00]
 [-8.50103949e-03  1.94783285e-02]]
grads:  [ 5.65637626e-03 -1.00788147e+01]
Stock Position:  0.005656376257118028
Bond Position:  [32.77541266]


portfolio before change:  [33.35621919]
curr_Stock_Price:  99.78380093354048
curr_Factors:  [9.97838009e+01 4.43040393e-02]
mat_Sqrt:  [[ 2.10030180e+01  0.00000000e+00]
 [-8.41940989e-03  1.92912916e-02]]
grads:  [0.00587564 3.12271084]
Stock Position:  0.005875639729969616
Bond Position:  [32.76992552]


portfolio before change:  [33.38672305]
curr_Stock_Price:  102.1860594083946
curr_Factors:  [1.02186059e+02 4.46399579e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [33.38672305]
Stock Price:  100.99120394665316
PL:  [32.39551911]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-5.60049535e-02 -2.47290874e-01]
 [-2.21938366e-01  2.80177309e-02]
 [ 2.35078278e-01  1.54189476e-01]
 [ 2.09323361e-01  1.48686491e-01]
 [ 1.28503269e-01 -1.41847256e-01]
 [ 7.83209385e-02 -8.70512693e-02]
 [ 1.71337585e-01 -2.32080588e-01]
 [ 5.21373329e-02 -1.25179682e-01]
 [ 2.33967870e-03 -6.52118920e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.88344116]
curr_Stock_Price:  99.77069197617932
curr_Factors:  [9.97706920e+01 4.12849272e-02]
mat_Sqrt:  [[ 2.02721003e+01  0.00000000e+00]
 [-8.12747707e-03  1.86223894e-02]]
grads:  [-8.08655920e-03 -1.32792236e+01]
Stock Position:  -0.008086559195993106
Bond Position:  [1.69024277]


portfolio before change:  [0.87329326]
curr_Stock_Price:  101.13013650843985
curr_Factors:  [1.01130137e+02 4.04308203e-02]
mat_Sqrt:  [[ 2.03346579e+01  0.00000000e+00]
 [-8.04296665e-03  1.84287517e-02]]
grads:  [-0.01031296  1.52032711]
Stock Position:  -0.01031295567943431
Bond Position:  [1.91624388]


portfolio before change:  [0.89839968]
curr_Stock_Price:  98.78861038575955
curr_Factors:  [9.87886104e+01 3.86180378e-02]
mat_Sqrt:  [[ 1.94134168e+01  0.00000000e+00]
 [-7.86058906e-03  1.80108722e-02]]
grads:  [0.01557542 8.56091111]
Stock Position:  0.015575418058087494
Bond Position:  [-0.64027422]


portfolio before change:  [0.83988437]
curr_Stock_Price:  95.0522679792276
curr_Factors:  [9.50522680e+01 3.71658813e-02]
mat_Sqrt:  [[ 1.83246084e+01  0.00000000e+00]
 [-7.71138186e-03  1.76689955e-02]]
grads:  [0.01496433 8.41510717]
Stock Position:  0.014964328874617662
Bond Position:  [-0.58250903]


portfolio before change:  [0.85515697]
curr_Stock_Price:  96.09233631624802
curr_Factors:  [9.60923363e+01 3.29238289e-02]
mat_Sqrt:  [[ 1.74358820e+01  0.00000000e+00]
 [-7.25796985e-03  1.66300981e-02]]
grads:  [ 3.81948275e-03 -8.52955017e+00]
Stock Position:  0.003819482751702187
Bond Position:  [0.48813395]


portfolio before change:  [0.85141233]
curr_Stock_Price:  95.0480161832368
curr_Factors:  [9.50480162e+01 3.30848296e-02]
mat_Sqrt:  [[ 1.72885077e+01  0.00000000e+00]
 [-7.27569428e-03  1.66707099e-02]]
grads:  [ 2.33268542e-03 -5.22180938e+00]
Stock Position:  0.0023326854205044222
Bond Position:  [0.62969521]


portfolio before change:  [0.85672463]
curr_Stock_Price:  97.19034305203141
curr_Factors:  [9.71903431e+01 3.01481474e-02]
mat_Sqrt:  [[ 1.68753749e+01  0.00000000e+00]
 [-6.94528875e-03  1.59136557e-02]]
grads:  [ 4.15097812e-03 -1.45837382e+01]
Stock Position:  0.004150978119692279
Bond Position:  [0.45328965]


portfolio before change:  [0.85306084]
curr_Stock_Price:  96.25309652870696
curr_Factors:  [9.62530965e+01 2.96669399e-02]
mat_Sqrt:  [[ 1.65787234e+01  0.00000000e+00]
 [-6.88963742e-03  1.57861425e-02]]
grads:  [-1.50527837e-04 -7.92971951e+00]
Stock Position:  -0.000150527837139517
Bond Position:  [0.86754962]


portfolio before change:  [0.85370519]
curr_Stock_Price:  94.85494054746525
curr_Factors:  [9.48549405e+01 2.77009636e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.85370519]
Stock Price:  94.06256904848861
PL:  [0.85370519]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.17687214e-02 -2.99901207e-01]
 [-2.28775578e-02  7.61006179e-02]
 [-7.47282645e-02 -1.49790193e-01]
 [-6.00967339e-02  4.47700033e-02]
 [ 3.43450936e-02 -1.32118104e-02]
 [ 8.75910993e-02 -1.47020348e-01]
 [ 1.44622253e-01  1.09305900e-01]
 [-4.05786131e-01 -4.28202180e-01]
 [ 2.36257442e-02  2.33116560e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.06405904]
curr_Stock_Price:  100.37761042206684
curr_Factors:  [1.00377610e+02 3.69791031e-02]
mat_Sqrt:  [[ 1.93025657e+01  0.00000000e+00]
 [-7.69198056e-03  1.76245416e-02]]
grads:  [-9.98086689e-03 -1.70161139e+01]
Stock Position:  -0.009980866889241364
Bond Position:  [6.0659146]


portfolio before change:  [5.07244181]
curr_Stock_Price:  99.84167932178342
curr_Factors:  [9.98416793e+01 4.05336923e-02]
mat_Sqrt:  [[ 2.01011063e+01  0.00000000e+00]
 [-8.05319239e-03  1.84521819e-02]]
grads:  [5.14174426e-04 4.12420702e+00]
Stock Position:  0.0005141744258557854
Bond Position:  [5.02110577]


portfolio before change:  [5.075906]
curr_Stock_Price:  101.69515121973716
curr_Factors:  [1.01695151e+02 4.02996169e-02]
mat_Sqrt:  [[ 2.04150621e+01  0.00000000e+00]
 [-8.02990579e-03  1.83988256e-02]]
grads:  [-6.86268127e-03 -8.14129101e+00]
Stock Position:  -0.00686268127330402
Bond Position:  [5.77380741]


portfolio before change:  [5.06772052]
curr_Stock_Price:  103.30867489454883
curr_Factors:  [1.03308675e+02 4.14844303e-02]
mat_Sqrt:  [[ 2.10416289e+01  0.00000000e+00]
 [-8.14709080e-03  1.86673301e-02]]
grads:  [-1.92748873e-03  2.39830779e+00]
Stock Position:  -0.0019274887336226977
Bond Position:  [5.26684683]


portfolio before change:  [5.07501052]
curr_Stock_Price:  100.89314060269838
curr_Factors:  [1.00893141e+02 4.18498028e-02]
mat_Sqrt:  [[ 2.06399361e+01  0.00000000e+00]
 [-8.18288974e-03  1.87493558e-02]]
grads:  [ 0.00138465 -0.7046541 ]
Stock Position:  0.0013846451179117941
Bond Position:  [4.93530933]


portfolio before change:  [5.08051389]
curr_Stock_Price:  103.08511113341355
curr_Factors:  [1.03085111e+02 4.16987344e-02]
mat_Sqrt:  [[ 2.10502559e+01  0.00000000e+00]
 [-8.16810719e-03  1.87154847e-02]]
grads:  [ 1.11286814e-03 -7.85554581e+00]
Stock Position:  0.0011128681369810013
Bond Position:  [4.96579376]


portfolio before change:  [5.08563093]
curr_Stock_Price:  105.45153214387472
curr_Factors:  [1.05451532e+02 4.19038437e-02]
mat_Sqrt:  [[ 2.15863803e+01  0.00000000e+00]
 [-8.18817134e-03  1.87614575e-02]]
grads:  [0.00890966 5.82608789]
Stock Position:  0.008909657656699608
Bond Position:  [4.14609388]


portfolio before change:  [5.10567551]
curr_Stock_Price:  107.46855927024272
curr_Factors:  [1.07468559e+02 3.96425249e-02]
mat_Sqrt:  [[ 2.13974530e+01  0.00000000e+00]
 [-7.96417227e-03  1.82482111e-02]]
grads:  [ -0.0276981  -23.46543324]
Stock Position:  -0.027698104257030596
Bond Position:  [8.08235087]


portfolio before change:  [5.09941437]
curr_Stock_Price:  107.84054602461894
curr_Factors:  [1.07840546e+02 4.25191540e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.09941437]
Stock Price:  108.5534293837524
PL:  [-3.45401501]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [ 9.20731641e-02 -2.83623871e-01]
 [-2.63183656e-02  5.57366528e-02]
 [ 2.48525507e-01  1.58769517e-01]
 [ 2.22358339e-01  1.53589354e-01]
 [ 6.65002216e-03 -4.53103947e-02]
 [ 8.68721993e-02 -1.45996233e-01]
 [ 1.67656033e-01  3.02037655e-02]
 [ 1.83648136e-02  1.71748568e-02]
 [ 4.40848704e-02 -6.24798823e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-28.16476167]
curr_Stock_Price:  95.55363826714509
curr_Factors:  [9.55536383e+01 4.22325361e-02]
mat_Sqrt:  [[ 1.96368042e+01  0.00000000e+00]
 [-8.22022249e-03  1.88348959e-02]]
grads:  [-1.61484737e-03 -1.50584252e+01]
Stock Position:  -0.0016148473684342744
Bond Position:  [-28.01045713]


portfolio before change:  [-28.1839987]
curr_Stock_Price:  98.79127979859847
curr_Factors:  [9.87912798e+01 3.66953017e-02]
mat_Sqrt:  [[ 1.89244751e+01  0.00000000e+00]
 [-7.66240711e-03  1.75567803e-02]]
grads:  [-1.05307861e-04  3.17465115e+00]
Stock Position:  -0.00010530786096881172
Bond Position:  [-28.1735952]


portfolio before change:  [-28.19794597]
curr_Stock_Price:  97.43288422155034
curr_Factors:  [9.74328842e+01 3.68111513e-02]
mat_Sqrt:  [[ 1.86936996e+01  0.00000000e+00]
 [-7.67449296e-03  1.75844724e-02]]
grads:  [0.01700135 9.02896108]
Stock Position:  0.017001354031171378
Bond Position:  [-29.85443693]


portfolio before change:  [-28.23888193]
curr_Stock_Price:  95.9032992652084
curr_Factors:  [9.59032993e+01 3.90262948e-02]
mat_Sqrt:  [[ 1.89457677e+01  0.00000000e+00]
 [-7.90202959e-03  1.81058244e-02]]
grads:  [0.01527466 8.48286996]
Stock Position:  0.015274663577509652
Bond Position:  [-29.70377257]


portfolio before change:  [-28.21782148]
curr_Stock_Price:  98.25464763341263
curr_Factors:  [9.82546476e+01 3.73965522e-02]
mat_Sqrt:  [[ 1.90006686e+01  0.00000000e+00]
 [-7.73527527e-03  1.77237422e-02]]
grads:  [-6.90768075e-04 -2.55648012e+00]
Stock Position:  -0.0006907680746719054
Bond Position:  [-28.1499503]


portfolio before change:  [-28.23379805]
curr_Stock_Price:  101.00242823378085
curr_Factors:  [1.01002428e+02 3.70976825e-02]
mat_Sqrt:  [[ 1.94538340e+01  0.00000000e+00]
 [-7.70430348e-03  1.76527769e-02]]
grads:  [ 1.19021368e-03 -8.27044005e+00]
Stock Position:  0.0011902136765625964
Bond Position:  [-28.35401252]


portfolio before change:  [-28.24490027]
curr_Stock_Price:  103.58879517501603
curr_Factors:  [1.03588795e+02 3.57123533e-02]
mat_Sqrt:  [[ 1.95759126e+01  0.00000000e+00]
 [-7.55908495e-03  1.73200395e-02]]
grads:  [0.00923778 1.74386239]
Stock Position:  0.00923778323282579
Bond Position:  [-29.20183111]


portfolio before change:  [-28.2828652]
curr_Stock_Price:  101.06001121057669
curr_Factors:  [1.01060011e+02 3.47326075e-02]
mat_Sqrt:  [[ 1.88342372e+01  0.00000000e+00]
 [-7.45467451e-03  1.70808051e-02]]
grads:  [0.00137306 1.00550628]
Stock Position:  0.001373059887385485
Bond Position:  [-28.42162665]


portfolio before change:  [-28.29576199]
curr_Stock_Price:  102.01960410923076
curr_Factors:  [1.02019604e+02 3.31116642e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-28.29576199]
Stock Price:  100.57598225118753
PL:  [-28.87174424]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-8.06209472e-02 -4.71979941e-01]
 [-4.13226453e-01 -8.73854303e-02]
 [-3.29853958e-01 -1.90112065e-01]
 [-2.28360881e-01 -1.89487986e-02]
 [-1.87120601e-01 -1.39925026e-04]
 [ 1.25711970e-01 -1.41091137e-01]
 [ 1.44635993e-01  1.09219474e-01]
 [-3.66450464e-01 -3.91939459e-01]
 [ 3.99610653e-02 -5.26893905e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.68099356]
curr_Stock_Price:  104.24170635642716
curr_Factors:  [1.04241706e+02 3.88714344e-02]
mat_Sqrt:  [[ 2.05521280e+01  0.00000000e+00]
 [-7.88633597e-03  1.80698658e-02]]
grads:  [-1.39455088e-02 -2.61197259e+01]
Stock Position:  -0.013945508791592082
Bond Position:  [33.13469719]


portfolio before change:  [31.72169392]
curr_Stock_Price:  102.51148135193539
curr_Factors:  [1.02511481e+02 3.75024757e-02]
mat_Sqrt:  [[ 1.98519183e+01  0.00000000e+00]
 [-7.74622238e-03  1.77488252e-02]]
grads:  [-0.02273657 -4.9234487 ]
Stock Position:  -0.02273657263518037
Bond Position:  [34.05245366]


portfolio before change:  [31.68340022]
curr_Stock_Price:  104.94474984521949
curr_Factors:  [1.04944750e+02 3.86593491e-02]
mat_Sqrt:  [[ 2.06342166e+01  0.00000000e+00]
 [-7.86479234e-03  1.80205031e-02]]
grads:  [ -0.02000685 -10.54976457]
Stock Position:  -0.020006849457668695
Bond Position:  [33.78301403]


portfolio before change:  [31.69785771]
curr_Stock_Price:  105.06662022519347
curr_Factors:  [1.05066620e+02 3.73430706e-02]
mat_Sqrt:  [[ 2.03034470e+01  0.00000000e+00]
 [-7.72974211e-03  1.77110642e-02]]
grads:  [-0.01165471 -1.06988482]
Stock Position:  -0.011654711388625292
Bond Position:  [32.92237884]


portfolio before change:  [31.70172999]
curr_Stock_Price:  106.14712976015704
curr_Factors:  [1.06147130e+02 3.95639599e-02]
mat_Sqrt:  [[ 2.11133979e+01  0.00000000e+00]
 [-7.95627651e-03  1.82301197e-02]]
grads:  [-0.00886554 -0.00767549]
Stock Position:  -0.00886553978607672
Bond Position:  [32.64278159]


portfolio before change:  [31.73158396]
curr_Stock_Price:  104.62116526176138
curr_Factors:  [1.04621165e+02 3.84143825e-02]
mat_Sqrt:  [[ 2.05053167e+01  0.00000000e+00]
 [-7.83983494e-03  1.79633185e-02]]
grads:  [ 3.12771322e-03 -7.85440266e+00]
Stock Position:  0.0031277132175074676
Bond Position:  [31.40435895]


portfolio before change:  [31.74989074]
curr_Stock_Price:  105.45266067942434
curr_Factors:  [1.05452661e+02 3.97820366e-02]
mat_Sqrt:  [[ 2.10329916e+01  0.00000000e+00]
 [-7.97817389e-03  1.82802929e-02]]
grads:  [0.00914294 5.97471139]
Stock Position:  0.009142935189561273
Bond Position:  [30.7857439]


portfolio before change:  [31.77683302]
curr_Stock_Price:  106.71544548736493
curr_Factors:  [1.06715445e+02 4.08980179e-02]
mat_Sqrt:  [[ 2.15813403e+01  0.00000000e+00]
 [-8.08930335e-03  1.85349225e-02]]
grads:  [ -0.02490609 -21.14599941]
Stock Position:  -0.024906092986170365
Bond Position:  [34.43469783]


portfolio before change:  [31.8874496]
curr_Stock_Price:  102.9655629869509
curr_Factors:  [1.02965563e+02 4.49075455e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.8874496]
Stock Price:  102.62587291584389
PL:  [29.26157668]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.86030918e-02 -3.62283752e-01]
 [-3.66764037e-01 -5.70693626e-02]
 [ 1.84049270e-01  1.30500155e-01]
 [ 1.73084729e-01  1.58558941e-01]
 [ 9.74146688e-02 -1.17531258e-01]
 [ 7.89758660e-02 -1.07584310e-01]
 [ 1.29073905e-01 -2.74546760e-01]
 [ 5.41599877e-02 -1.19877451e-01]
 [ 2.69030741e-02  7.18666031e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.5834165]
curr_Stock_Price:  101.75957687077037
curr_Factors:  [1.01759577e+02 3.99825347e-02]
mat_Sqrt:  [[ 2.03474717e+01  0.00000000e+00]
 [-7.99825327e-03  1.83263005e-02]]
grads:  [-1.11422533e-02 -1.97685153e+01]
Stock Position:  -0.011142253291643579
Bond Position:  [15.71724748]


portfolio before change:  [14.58704108]
curr_Stock_Price:  102.13975230277829
curr_Factors:  [1.02139752e+02 4.05298108e-02]
mat_Sqrt:  [[ 2.05627923e+01  0.00000000e+00]
 [-8.05280680e-03  1.84512984e-02]]
grads:  [-0.01904757 -3.09297273]
Stock Position:  -0.019047566262431957
Bond Position:  [16.53255478]


portfolio before change:  [14.62959637]
curr_Stock_Price:  100.33968265291875
curr_Factors:  [1.00339683e+02 4.06968958e-02]
mat_Sqrt:  [[ 2.02419974e+01  0.00000000e+00]
 [-8.06938866e-03  1.84892922e-02]]
grads:  [0.01190615 7.05814773]
Stock Position:  0.011906147512264622
Bond Position:  [13.43493731]


portfolio before change:  [14.63103895]
curr_Stock_Price:  99.89650220093222
curr_Factors:  [9.98965022e+01 4.08606380e-02]
mat_Sqrt:  [[ 2.01930934e+01  0.00000000e+00]
 [-8.08560578e-03  1.85264503e-02]]
grads:  [0.01199844 8.55851709]
Stock Position:  0.011998435272877568
Bond Position:  [13.43243723]


portfolio before change:  [14.59866222]
curr_Stock_Price:  96.6381916529806
curr_Factors:  [9.66381917e+01 4.18917449e-02]
mat_Sqrt:  [[ 1.97793957e+01  0.00000000e+00]
 [-8.18698918e-03  1.87587488e-02]]
grads:  [ 2.33171038e-03 -6.26541030e+00]
Stock Position:  0.0023317103829762873
Bond Position:  [14.37332994]


portfolio before change:  [14.59840199]
curr_Stock_Price:  93.44367643645558
curr_Factors:  [9.34436764e+01 4.14920419e-02]
mat_Sqrt:  [[ 1.90340989e+01  0.00000000e+00]
 [-8.14783818e-03  1.86690426e-02]]
grads:  [ 1.68236091e-03 -5.76271167e+00]
Stock Position:  0.0016823609082507827
Bond Position:  [14.44119601]


portfolio before change:  [14.60942054]
curr_Stock_Price:  95.70011618864552
curr_Factors:  [9.57001162e+01 4.09020112e-02]
mat_Sqrt:  [[ 1.93546266e+01  0.00000000e+00]
 [-8.08969826e-03  1.85358273e-02]]
grads:  [ 4.78018798e-04 -1.48116810e+01]
Stock Position:  0.0004780187983025573
Bond Position:  [14.56367409]


portfolio before change:  [14.61602755]
curr_Stock_Price:  94.2845931090971
curr_Factors:  [9.42845931e+01 4.25444175e-02]
mat_Sqrt:  [[ 1.94474213e+01  0.00000000e+00]
 [-8.25051925e-03  1.89043145e-02]]
grads:  [ 9.46746996e-05 -6.34127469e+00]
Stock Position:  9.467469964366635e-05
Bond Position:  [14.60710119]


portfolio before change:  [14.6230379]
curr_Stock_Price:  91.1683023394864
curr_Factors:  [9.11683023e+01 4.37626388e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.6230379]
Stock Price:  93.2620934726507
PL:  [14.6230379]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.59279662e+02 -4.92953865e+01]
 [-6.67907114e-02 -3.45740764e-01]
 [-1.36315430e-01  4.95868716e-02]
 [ 2.43274789e-01  1.56981156e-01]
 [ 2.19959743e-01  1.52687167e-01]
 [ 6.59366919e-02 -9.22882287e-02]
 [ 7.84405435e-02 -9.08010796e-02]
 [ 1.13065836e-01 -2.87425488e-01]
 [ 5.27963922e-02 -1.23452010e-01]
 [ 3.01489511e-02 -6.54048637e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.27966233 -49.29538653]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88826959 -2689.28381198]
init_Out:  [2.80607286]
Stock Position:  6.888269591778899
Bond position:  [-686.02088632]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.00557107]
curr_Stock_Price:  101.38533985850822
curr_Factors:  [1.01385340e+02 4.16337819e-02]
mat_Sqrt:  [[ 2.06870276e+01  0.00000000e+00]
 [-8.16174314e-03  1.87009029e-02]]
grads:  [-1.05227467e-02 -1.84879183e+01]
Stock Position:  -0.010522746734360995
Bond Position:  [13.07242332]


portfolio before change:  [12.02060935]
curr_Stock_Price:  100.5775242966013
curr_Factors:  [1.00577524e+02 4.01551107e-02]
mat_Sqrt:  [[ 2.01544688e+01  0.00000000e+00]
 [-8.01549606e-03  1.83658087e-02]]
grads:  [-0.00568975  2.69995579]
Stock Position:  -0.005689752817088501
Bond Position:  [12.59287061]


portfolio before change:  [12.04175727]
curr_Stock_Price:  97.96758579853024
curr_Factors:  [9.79675858e+01 4.19284298e-02]
mat_Sqrt:  [[ 2.00602668e+01  0.00000000e+00]
 [-8.19057310e-03  1.87669606e-02]]
grads:  [0.01554251 8.36476185]
Stock Position:  0.015542514245573643
Bond Position:  [10.51909467]


portfolio before change:  [12.01183402]
curr_Stock_Price:  95.70385193121811
curr_Factors:  [9.57038519e+01 3.82247244e-02]
mat_Sqrt:  [[ 1.87111982e+01  0.00000000e+00]
 [-7.82045773e-03  1.79189198e-02]]
grads:  [0.01531692 8.52100287]
Stock Position:  0.01531691783057092
Bond Position:  [10.54594598]


portfolio before change:  [12.04006195]
curr_Stock_Price:  97.20243302543764
curr_Factors:  [9.72024330e+01 3.54359744e-02]
mat_Sqrt:  [[ 1.82978189e+01  0.00000000e+00]
 [-7.52977815e-03  1.72528892e-02]]
grads:  [ 1.40228772e-03 -5.34914632e+00]
Stock Position:  0.0014022877184343462
Bond Position:  [11.90375617]


portfolio before change:  [12.04258633]
curr_Stock_Price:  94.7571512406274
curr_Factors:  [9.47571512e+01 3.71111683e-02]
mat_Sqrt:  [[ 1.82542632e+01  0.00000000e+00]
 [-7.70570368e-03  1.76559852e-02]]
grads:  [ 2.12617200e-03 -5.14279314e+00]
Stock Position:  0.002126172004783668
Bond Position:  [11.84111633]


portfolio before change:  [12.04900701]
curr_Stock_Price:  94.99167963495357
curr_Factors:  [9.49916796e+01 3.37251019e-02]
mat_Sqrt:  [[ 1.74446476e+01  0.00000000e+00]
 [-7.34575816e-03  1.68312464e-02]]
grads:  [-7.09497356e-04 -1.70768986e+01]
Stock Position:  -0.0007094973556286015
Bond Position:  [12.11640336]


portfolio before change:  [12.05470901]
curr_Stock_Price:  95.49587098984927
curr_Factors:  [9.54958710e+01 3.27681413e-02]
mat_Sqrt:  [[ 1.72866364e+01  0.00000000e+00]
 [-7.24078905e-03  1.65907320e-02]]
grads:  [-6.26195913e-05 -7.44102251e+00]
Stock Position:  -6.26195912973182e-05
Bond Position:  [12.06068892]


portfolio before change:  [12.06056596]
curr_Stock_Price:  98.28897412001795
curr_Factors:  [9.82889741e+01 3.26791289e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.06056596]
Stock Price:  98.13770286276682
PL:  [12.06056596]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -1.314365850816542
FINAL STD P&L:  13.336069144050727
