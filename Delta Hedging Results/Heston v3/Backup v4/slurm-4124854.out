WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 01:04:10.321353: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 01:04:10.351905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-17 01:04:10.352636: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:04:10.354854: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:04:10.356807: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:04:10.357530: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:04:10.359932: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:04:10.361880: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:04:10.367104: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:04:10.369186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:04:10.369616: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 01:04:10.376625: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399875000 Hz
2019-12-17 01:04:10.376818: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d74c529460 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:04:10.376835: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 01:04:10.378022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-17 01:04:10.378061: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:04:10.378075: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:04:10.378086: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:04:10.378097: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:04:10.378107: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:04:10.378119: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:04:10.378130: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:04:10.380205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:04:10.380236: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:04:10.474499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 01:04:10.474533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 01:04:10.474544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 01:04:10.477888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-17 01:04:10.480230: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d74cb62770 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:04:10.480247: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: 4.0000e-02
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 01:04:28.191029: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 2.8209e+02,   Y0: 2.9188e+00,  elapsed time  17
INFO   step:     1,    loss: 1.9401e+02,   Y0: 2.9238e+00,  elapsed time  24
INFO   step:     2,    loss: 1.9401e+02,   Y0: 2.9220e+00,  elapsed time  26
INFO   step:     3,    loss: 1.9398e+02,   Y0: 2.9200e+00,  elapsed time  27
INFO   step:     4,    loss: 1.9396e+02,   Y0: 2.9175e+00,  elapsed time  28
INFO   step:     5,    loss: 1.9393e+02,   Y0: 2.9141e+00,  elapsed time  29
INFO   step:     6,    loss: 1.9392e+02,   Y0: 2.9109e+00,  elapsed time  30
INFO   step:     7,    loss: 1.9390e+02,   Y0: 2.9080e+00,  elapsed time  32
INFO   step:     8,    loss: 1.9388e+02,   Y0: 2.9052e+00,  elapsed time  33
INFO   step:     9,    loss: 1.9386e+02,   Y0: 2.9037e+00,  elapsed time  34
INFO   step:    10,    loss: 1.9385e+02,   Y0: 2.9034e+00,  elapsed time  35
INFO   step:    11,    loss: 1.9383e+02,   Y0: 2.9015e+00,  elapsed time  36
INFO   step:    12,    loss: 1.9382e+02,   Y0: 2.8993e+00,  elapsed time  37
INFO   step:    13,    loss: 1.9380e+02,   Y0: 2.8972e+00,  elapsed time  39
INFO   step:    14,    loss: 1.9378e+02,   Y0: 2.8946e+00,  elapsed time  40
INFO   step:    15,    loss: 1.9377e+02,   Y0: 2.8916e+00,  elapsed time  41
INFO   step:    16,    loss: 1.9375e+02,   Y0: 2.8884e+00,  elapsed time  42
INFO   step:    17,    loss: 1.9374e+02,   Y0: 2.8857e+00,  elapsed time  43
INFO   step:    18,    loss: 1.9372e+02,   Y0: 2.8824e+00,  elapsed time  45
INFO   step:    19,    loss: 1.9370e+02,   Y0: 2.8787e+00,  elapsed time  46
INFO   step:    20,    loss: 1.9369e+02,   Y0: 2.8756e+00,  elapsed time  47
INFO   step:    21,    loss: 1.9367e+02,   Y0: 2.8727e+00,  elapsed time  48
INFO   step:    22,    loss: 1.9366e+02,   Y0: 2.8697e+00,  elapsed time  49
INFO   step:    23,    loss: 1.9364e+02,   Y0: 2.8673e+00,  elapsed time  50
INFO   step:    24,    loss: 1.9362e+02,   Y0: 2.8653e+00,  elapsed time  52
INFO   step:    25,    loss: 1.9360e+02,   Y0: 2.8630e+00,  elapsed time  53
INFO   step:    26,    loss: 1.9359e+02,   Y0: 2.8606e+00,  elapsed time  54
INFO   step:    27,    loss: 1.9357e+02,   Y0: 2.8579e+00,  elapsed time  55
INFO   step:    28,    loss: 1.9356e+02,   Y0: 2.8550e+00,  elapsed time  56
INFO   step:    29,    loss: 1.9355e+02,   Y0: 2.8516e+00,  elapsed time  58
INFO   step:    30,    loss: 1.9354e+02,   Y0: 2.8481e+00,  elapsed time  59
INFO   step:    31,    loss: 1.9353e+02,   Y0: 2.8449e+00,  elapsed time  60
INFO   step:    32,    loss: 1.9352e+02,   Y0: 2.8418e+00,  elapsed time  61
INFO   step:    33,    loss: 1.9350e+02,   Y0: 2.8387e+00,  elapsed time  62
INFO   step:    34,    loss: 1.9348e+02,   Y0: 2.8361e+00,  elapsed time  63
INFO   step:    35,    loss: 1.9347e+02,   Y0: 2.8336e+00,  elapsed time  65
INFO   step:    36,    loss: 1.9346e+02,   Y0: 2.8318e+00,  elapsed time  66
INFO   step:    37,    loss: 1.9345e+02,   Y0: 2.8306e+00,  elapsed time  67
INFO   step:    38,    loss: 1.9343e+02,   Y0: 2.8293e+00,  elapsed time  68
INFO   step:    39,    loss: 1.9342e+02,   Y0: 2.8282e+00,  elapsed time  69
INFO   step:    40,    loss: 1.9341e+02,   Y0: 2.8276e+00,  elapsed time  70
INFO   step:    41,    loss: 1.9339e+02,   Y0: 2.8271e+00,  elapsed time  72
INFO   step:    42,    loss: 1.9338e+02,   Y0: 2.8265e+00,  elapsed time  73
INFO   step:    43,    loss: 1.9336e+02,   Y0: 2.8252e+00,  elapsed time  74
INFO   step:    44,    loss: 1.9335e+02,   Y0: 2.8236e+00,  elapsed time  75
INFO   step:    45,    loss: 1.9334e+02,   Y0: 2.8210e+00,  elapsed time  76
INFO   step:    46,    loss: 1.9332e+02,   Y0: 2.8176e+00,  elapsed time  78
INFO   step:    47,    loss: 1.9331e+02,   Y0: 2.8147e+00,  elapsed time  79
INFO   step:    48,    loss: 1.9330e+02,   Y0: 2.8118e+00,  elapsed time  80
INFO   step:    49,    loss: 1.9328e+02,   Y0: 2.8090e+00,  elapsed time  81
INFO   step:    50,    loss: 1.9327e+02,   Y0: 2.8062e+00,  elapsed time  82
INFO   step:    51,    loss: 1.9325e+02,   Y0: 2.8035e+00,  elapsed time  83
INFO   step:    52,    loss: 1.9324e+02,   Y0: 2.8007e+00,  elapsed time  85
INFO   step:    53,    loss: 1.9323e+02,   Y0: 2.7988e+00,  elapsed time  86
INFO   step:    54,    loss: 1.9321e+02,   Y0: 2.7966e+00,  elapsed time  87
INFO   step:    55,    loss: 1.9320e+02,   Y0: 2.7939e+00,  elapsed time  88
INFO   step:    56,    loss: 1.9318e+02,   Y0: 2.7922e+00,  elapsed time  89
INFO   step:    57,    loss: 1.9316e+02,   Y0: 2.7902e+00,  elapsed time  91
INFO   step:    58,    loss: 1.9314e+02,   Y0: 2.7881e+00,  elapsed time  92
INFO   step:    59,    loss: 1.9312e+02,   Y0: 2.7865e+00,  elapsed time  93
INFO   step:    60,    loss: 1.9310e+02,   Y0: 2.7838e+00,  elapsed time  94
INFO   step:    61,    loss: 1.9309e+02,   Y0: 2.7808e+00,  elapsed time  95
INFO   step:    62,    loss: 1.9307e+02,   Y0: 2.7791e+00,  elapsed time  96
INFO   step:    63,    loss: 1.9306e+02,   Y0: 2.7769e+00,  elapsed time  98
INFO   step:    64,    loss: 1.9304e+02,   Y0: 2.7744e+00,  elapsed time  99
INFO   step:    65,    loss: 1.9303e+02,   Y0: 2.7722e+00,  elapsed time 100
INFO   step:    66,    loss: 1.9301e+02,   Y0: 2.7699e+00,  elapsed time 101
INFO   step:    67,    loss: 1.9299e+02,   Y0: 2.7672e+00,  elapsed time 102
INFO   step:    68,    loss: 1.9297e+02,   Y0: 2.7643e+00,  elapsed time 104
INFO   step:    69,    loss: 1.9296e+02,   Y0: 2.7620e+00,  elapsed time 105
INFO   step:    70,    loss: 1.9294e+02,   Y0: 2.7598e+00,  elapsed time 106
INFO   step:    71,    loss: 1.9293e+02,   Y0: 2.7578e+00,  elapsed time 107
INFO   step:    72,    loss: 1.9291e+02,   Y0: 2.7559e+00,  elapsed time 108
INFO   step:    73,    loss: 1.9290e+02,   Y0: 2.7542e+00,  elapsed time 109
INFO   step:    74,    loss: 1.9289e+02,   Y0: 2.7530e+00,  elapsed time 111
INFO   step:    75,    loss: 1.9287e+02,   Y0: 2.7511e+00,  elapsed time 112
INFO   step:    76,    loss: 1.9286e+02,   Y0: 2.7495e+00,  elapsed time 113
INFO   step:    77,    loss: 1.9285e+02,   Y0: 2.7481e+00,  elapsed time 114
INFO   step:    78,    loss: 1.9283e+02,   Y0: 2.7470e+00,  elapsed time 115
INFO   step:    79,    loss: 1.9282e+02,   Y0: 2.7461e+00,  elapsed time 116
INFO   step:    80,    loss: 1.9280e+02,   Y0: 2.7451e+00,  elapsed time 118
INFO   step:    81,    loss: 1.9278e+02,   Y0: 2.7445e+00,  elapsed time 119
INFO   step:    82,    loss: 1.9277e+02,   Y0: 2.7432e+00,  elapsed time 120
INFO   step:    83,    loss: 1.9275e+02,   Y0: 2.7419e+00,  elapsed time 121
INFO   step:    84,    loss: 1.9274e+02,   Y0: 2.7406e+00,  elapsed time 122
INFO   step:    85,    loss: 1.9273e+02,   Y0: 2.7398e+00,  elapsed time 124
INFO   step:    86,    loss: 1.9272e+02,   Y0: 2.7397e+00,  elapsed time 125
INFO   step:    87,    loss: 1.9270e+02,   Y0: 2.7399e+00,  elapsed time 126
INFO   step:    88,    loss: 1.9269e+02,   Y0: 2.7401e+00,  elapsed time 127
INFO   step:    89,    loss: 1.9268e+02,   Y0: 2.7398e+00,  elapsed time 128
INFO   step:    90,    loss: 1.9266e+02,   Y0: 2.7404e+00,  elapsed time 129
INFO   step:    91,    loss: 1.9265e+02,   Y0: 2.7403e+00,  elapsed time 131
INFO   step:    92,    loss: 1.9264e+02,   Y0: 2.7392e+00,  elapsed time 132
INFO   step:    93,    loss: 1.9262e+02,   Y0: 2.7379e+00,  elapsed time 133
INFO   step:    94,    loss: 1.9261e+02,   Y0: 2.7370e+00,  elapsed time 134
INFO   step:    95,    loss: 1.9260e+02,   Y0: 2.7365e+00,  elapsed time 135
INFO   step:    96,    loss: 1.9259e+02,   Y0: 2.7362e+00,  elapsed time 137
INFO   step:    97,    loss: 1.9257e+02,   Y0: 2.7352e+00,  elapsed time 138
INFO   step:    98,    loss: 1.9256e+02,   Y0: 2.7345e+00,  elapsed time 139
INFO   step:    99,    loss: 1.9255e+02,   Y0: 2.7337e+00,  elapsed time 140
INFO   step:   100,    loss: 1.9253e+02,   Y0: 2.7327e+00,  elapsed time 141
INFO   step:   101,    loss: 1.9252e+02,   Y0: 2.7315e+00,  elapsed time 142
INFO   step:   102,    loss: 1.9250e+02,   Y0: 2.7310e+00,  elapsed time 144
INFO   step:   103,    loss: 1.9249e+02,   Y0: 2.7315e+00,  elapsed time 145
INFO   step:   104,    loss: 1.9247e+02,   Y0: 2.7317e+00,  elapsed time 146
INFO   step:   105,    loss: 1.9245e+02,   Y0: 2.7328e+00,  elapsed time 147
INFO   step:   106,    loss: 1.9243e+02,   Y0: 2.7336e+00,  elapsed time 148
INFO   step:   107,    loss: 1.9242e+02,   Y0: 2.7342e+00,  elapsed time 150
INFO   step:   108,    loss: 1.9240e+02,   Y0: 2.7356e+00,  elapsed time 151
INFO   step:   109,    loss: 1.9238e+02,   Y0: 2.7375e+00,  elapsed time 152
INFO   step:   110,    loss: 1.9237e+02,   Y0: 2.7396e+00,  elapsed time 153
INFO   step:   111,    loss: 1.9236e+02,   Y0: 2.7416e+00,  elapsed time 154
INFO   step:   112,    loss: 1.9234e+02,   Y0: 2.7430e+00,  elapsed time 156
INFO   step:   113,    loss: 1.9233e+02,   Y0: 2.7444e+00,  elapsed time 157
INFO   step:   114,    loss: 1.9232e+02,   Y0: 2.7455e+00,  elapsed time 158
INFO   step:   115,    loss: 1.9230e+02,   Y0: 2.7468e+00,  elapsed time 159
INFO   step:   116,    loss: 1.9229e+02,   Y0: 2.7483e+00,  elapsed time 160
INFO   step:   117,    loss: 1.9228e+02,   Y0: 2.7496e+00,  elapsed time 161
INFO   step:   118,    loss: 1.9226e+02,   Y0: 2.7506e+00,  elapsed time 163
INFO   step:   119,    loss: 1.9225e+02,   Y0: 2.7509e+00,  elapsed time 164
INFO   step:   120,    loss: 1.9224e+02,   Y0: 2.7512e+00,  elapsed time 165
INFO   step:   121,    loss: 1.9222e+02,   Y0: 2.7511e+00,  elapsed time 166
INFO   step:   122,    loss: 1.9221e+02,   Y0: 2.7510e+00,  elapsed time 167
INFO   step:   123,    loss: 1.9219e+02,   Y0: 2.7510e+00,  elapsed time 169
INFO   step:   124,    loss: 1.9218e+02,   Y0: 2.7513e+00,  elapsed time 170
INFO   step:   125,    loss: 1.9216e+02,   Y0: 2.7515e+00,  elapsed time 171
INFO   step:   126,    loss: 1.9215e+02,   Y0: 2.7517e+00,  elapsed time 172
INFO   step:   127,    loss: 1.9213e+02,   Y0: 2.7529e+00,  elapsed time 173
INFO   step:   128,    loss: 1.9212e+02,   Y0: 2.7540e+00,  elapsed time 174
INFO   step:   129,    loss: 1.9210e+02,   Y0: 2.7545e+00,  elapsed time 175
INFO   step:   130,    loss: 1.9208e+02,   Y0: 2.7551e+00,  elapsed time 177
INFO   step:   131,    loss: 1.9207e+02,   Y0: 2.7558e+00,  elapsed time 178
INFO   step:   132,    loss: 1.9206e+02,   Y0: 2.7561e+00,  elapsed time 179
INFO   step:   133,    loss: 1.9205e+02,   Y0: 2.7563e+00,  elapsed time 180
INFO   step:   134,    loss: 1.9204e+02,   Y0: 2.7569e+00,  elapsed time 181
INFO   step:   135,    loss: 1.9202e+02,   Y0: 2.7583e+00,  elapsed time 183
INFO   step:   136,    loss: 1.9201e+02,   Y0: 2.7598e+00,  elapsed time 184
INFO   step:   137,    loss: 1.9199e+02,   Y0: 2.7611e+00,  elapsed time 185
INFO   step:   138,    loss: 1.9198e+02,   Y0: 2.7620e+00,  elapsed time 186
INFO   step:   139,    loss: 1.9196e+02,   Y0: 2.7632e+00,  elapsed time 187
INFO   step:   140,    loss: 1.9195e+02,   Y0: 2.7638e+00,  elapsed time 188
INFO   step:   141,    loss: 1.9193e+02,   Y0: 2.7647e+00,  elapsed time 190
INFO   step:   142,    loss: 1.9192e+02,   Y0: 2.7665e+00,  elapsed time 191
INFO   step:   143,    loss: 1.9190e+02,   Y0: 2.7685e+00,  elapsed time 192
INFO   step:   144,    loss: 1.9188e+02,   Y0: 2.7712e+00,  elapsed time 193
INFO   step:   145,    loss: 1.9186e+02,   Y0: 2.7734e+00,  elapsed time 194
INFO   step:   146,    loss: 1.9184e+02,   Y0: 2.7751e+00,  elapsed time 196
INFO   step:   147,    loss: 1.9182e+02,   Y0: 2.7775e+00,  elapsed time 197
INFO   step:   148,    loss: 1.9180e+02,   Y0: 2.7802e+00,  elapsed time 198
INFO   step:   149,    loss: 1.9178e+02,   Y0: 2.7824e+00,  elapsed time 199
Delta:  160 ,  160.05
Other:  -50 ,  -50
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 2) dtype=float64>]
num_iterations:  150
total time intervals:  20
# of dimensions:  2
Loss out:  184.30314785254063
Output_Z_Vals:  [[[ 1.59289575e+02 -4.92723199e+01]
  [ 1.59289575e+02 -4.92723199e+01]
  [ 1.59289575e+02 -4.92723199e+01]
  ...
  [ 1.59289575e+02 -4.92723199e+01]
  [ 1.59289575e+02 -4.92723199e+01]
  [ 1.59289575e+02 -4.92723199e+01]]

 [[ 2.84611300e-02 -1.35083427e-03]
  [ 1.92169782e-02 -3.58271696e-04]
  [-1.04602848e-01  6.09599818e-02]
  ...
  [ 3.89193100e-02  2.89519025e-01]
  [-9.45630182e-02  4.17776242e-02]
  [ 2.84611300e-02 -1.35083427e-03]]

 [[-1.57235566e-01 -6.66519702e-02]
  [-1.57235566e-01 -6.66519702e-02]
  [-1.57235566e-01 -6.66519702e-02]
  ...
  [ 3.75306759e-02 -1.83531276e-02]
  [-1.57235566e-01 -6.66519702e-02]
  [-1.57235566e-01 -6.66519702e-02]]

 ...

 [[-2.46390031e-03 -5.41681713e-02]
  [-2.68601638e-02 -4.21057081e-02]
  [ 6.50310423e-02 -8.46443063e-02]
  ...
  [-5.18796402e-02 -1.67270001e-02]
  [ 4.95780904e-02 -7.25306197e-02]
  [-6.29510068e-02 -6.65734243e-03]]

 [[ 6.23331370e-01 -3.05594959e-01]
  [ 3.85126933e-01 -2.31928925e-01]
  [ 9.43619030e-01 -4.38458020e-01]
  ...
  [ 2.92861861e-01 -2.05085296e-01]
  [ 9.68629864e-01 -4.48897261e-01]
  [ 1.78525961e+00 -7.88423082e-01]]

 [[ 1.99670843e-01  1.33339383e-01]
  [ 2.02295726e-01  8.95747677e-02]
  [ 1.47527250e-01  1.66120249e-01]
  ...
  [ 8.44007234e-02 -8.96831340e-03]
  [ 1.44205959e-01  1.84426277e-01]
  [ 3.95346667e-01  3.28419208e-01]]]
Z_Vals dimensionality:  (20, 200, 2)
X_test:  [[[1.00000000e+02 9.93668269e+01 1.00603051e+02 ... 9.83081763e+01
   9.85762932e+01 9.84718805e+01]
  [4.00000000e-02 4.13967088e-02 4.16667953e-02 ... 4.75964053e-02
   4.50880287e-02 4.44124127e-02]]

 [[1.00000000e+02 9.94423032e+01 9.95624042e+01 ... 1.01978061e+02
   1.01704330e+02 1.01889265e+02]
  [4.00000000e-02 4.13834324e-02 4.15969480e-02 ... 3.77025338e-02
   3.52552125e-02 3.45121379e-02]]

 [[1.00000000e+02 1.00215604e+02 9.80191622e+01 ... 9.49218222e+01
   9.47873873e+01 9.38457614e+01]
  [4.00000000e-02 3.68798326e-02 3.67945825e-02 ... 4.12220314e-02
   4.31158699e-02 4.44136064e-02]]

 ...

 [[1.00000000e+02 1.01790487e+02 1.02125393e+02 ... 1.03464191e+02
   1.05454038e+02 1.03345224e+02]
  [4.00000000e-02 4.14777400e-02 4.02625977e-02 ... 3.69955581e-02
   3.57866173e-02 3.67158990e-02]]

 [[1.00000000e+02 1.00103439e+02 9.78973692e+01 ... 9.46534964e+01
   9.34773424e+01 9.38150731e+01]
  [4.00000000e-02 3.75157963e-02 3.92507121e-02 ... 4.28922383e-02
   4.35824508e-02 4.34841291e-02]]

 [[1.00000000e+02 9.84350645e+01 9.87276337e+01 ... 8.59699092e+01
   8.65380712e+01 8.71093545e+01]
  [4.00000000e-02 4.02108548e-02 3.96911215e-02 ... 4.82584713e-02
   4.74856733e-02 4.64054180e-02]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.77922090e-01 -6.74546584e-01]
 [-3.25264730e-02  2.76222256e-01]
 [-3.30686348e-01 -1.04856882e-01]
 [ 3.61638099e-01 -4.34637191e-01]
 [-5.34004735e-01  2.96211789e-01]
 [ 1.67187876e-01  1.45821608e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 3.04120597e-01  4.71433303e-03]
 [-9.84170084e-02 -2.59274436e-02]
 [-2.36527455e-01  6.79481535e-02]
 [-8.68527486e-02  3.32188535e-02]
 [-1.01685943e-01 -2.21665014e-01]
 [-9.49416118e-02 -1.22554425e-01]
 [ 8.80158712e-02  5.36028376e-02]
 [-2.46390031e-03 -5.41681713e-02]
 [ 6.23331370e-01 -3.05594959e-01]
 [ 1.99670843e-01  1.33339383e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.7490296]
curr_Stock_Price:  99.36682690999007
curr_Factors:  [9.93668269e+01 4.13967088e-02]
mat_Sqrt:  [[ 2.02173546e+01  0.00000000e+00]
 [-8.13847247e-03  1.86475831e-02]]
grads:  [ 0.0013786  -0.07244018]
Stock Position:  0.0013785966626658737
Bond Position:  [-1.88601637]


portfolio before change:  [-1.74779691]
curr_Stock_Price:  100.60305057314282
curr_Factors:  [1.00603051e+02 4.16667953e-02]
mat_Sqrt:  [[ 2.05355434e+01  0.00000000e+00]
 [-8.16497841e-03  1.87083158e-02]]
grads:  [-0.00907329 -3.56269217]
Stock Position:  -0.009073286572348021
Bond Position:  [-0.8349966]


portfolio before change:  [-1.74085103]
curr_Stock_Price:  99.81451052969273
curr_Factors:  [9.98145105e+01 4.08064813e-02]
mat_Sqrt:  [[ 2.01631442e+01  0.00000000e+00]
 [-8.08024567e-03  1.85141687e-02]]
grads:  [-2.34248365e-02 -3.64340735e+01]
Stock Position:  -0.023424836483547068
Bond Position:  [0.59728756]


portfolio before change:  [-1.71576459]
curr_Stock_Price:  98.74995248424881
curr_Factors:  [9.87499525e+01 4.12100547e-02]
mat_Sqrt:  [[ 2.00464969e+01  0.00000000e+00]
 [-8.12010391e-03  1.86054954e-02]]
grads:  [4.39113145e-03 1.48462726e+01]
Stock Position:  0.004391131446918705
Bond Position:  [-2.14938862]


portfolio before change:  [-1.70854327]
curr_Stock_Price:  100.5168630738506
curr_Factors:  [1.00516863e+02 4.37876983e-02]
mat_Sqrt:  [[ 2.10336666e+01  0.00000000e+00]
 [-8.37020414e-03  1.91785470e-02]]
grads:  [-0.01789748 -5.4674049 ]
Stock Position:  -0.017897480763437588
Bond Position:  [0.09045535]


portfolio before change:  [-1.70369523]
curr_Stock_Price:  100.24724856313215
curr_Factors:  [1.00247249e+02 4.36999428e-02]
mat_Sqrt:  [[ 2.09562174e+01  0.00000000e+00]
 [-8.36181251e-03  1.91593194e-02]]
grads:  [ 8.20505311e-03 -2.26854192e+01]
Stock Position:  0.008205053111573407
Bond Position:  [-2.52622923]


portfolio before change:  [-1.69782515]
curr_Stock_Price:  101.03965355536153
curr_Factors:  [1.01039654e+02 4.41687855e-02]
mat_Sqrt:  [[ 2.12348686e+01  0.00000000e+00]
 [-8.40654845e-03  1.92618223e-02]]
grads:  [-0.01905956 15.37818097]
Stock Position:  -0.019059562825833515
Bond Position:  [0.22794648]


portfolio before change:  [-1.692334]
curr_Stock_Price:  100.75453913648533
curr_Factors:  [1.00754539e+02 4.33200014e-02]
mat_Sqrt:  [[ 2.09705032e+01  0.00000000e+00]
 [-8.32538301e-03  1.90758489e-02]]
grads:  [0.01100735 7.64430502]
Stock Position:  0.011007348816035553
Bond Position:  [-2.80137435]


portfolio before change:  [-1.6885099]
curr_Stock_Price:  101.16558513951922
curr_Factors:  [1.01165585e+02 4.38085252e-02]
mat_Sqrt:  [[ 2.11744488e+01  0.00000000e+00]
 [-8.37219448e-03  1.91831075e-02]]
grads:  [-0.01027563 -2.7706101 ]
Stock Position:  -0.010275633257897291
Bond Position:  [-0.64896945]


portfolio before change:  [-1.67915583]
curr_Stock_Price:  100.23947876047328
curr_Factors:  [1.00239479e+02 4.60659084e-02]
mat_Sqrt:  [[ 2.15143693e+01  0.00000000e+00]
 [-8.58518802e-03  1.96711370e-02]]
grads:  [0.01423133 0.23965737]
Stock Position:  0.014231330505723066
Bond Position:  [-3.10569698]


portfolio before change:  [-1.73040524]
curr_Stock_Price:  96.69287535384186
curr_Factors:  [9.66928754e+01 4.93061659e-02]
mat_Sqrt:  [[ 2.14706450e+01  0.00000000e+00]
 [-8.88199671e-03  2.03512111e-02]]
grads:  [-0.00511082 -1.27400003]
Stock Position:  -0.005110823283538019
Bond Position:  [-1.23622504]


portfolio before change:  [-1.73696127]
curr_Stock_Price:  97.91517105704246
curr_Factors:  [9.79151711e+01 4.74538673e-02]
mat_Sqrt:  [[ 2.13297514e+01  0.00000000e+00]
 [-8.71356343e-03  1.99652820e-02]]
grads:  [-0.00969877  3.40331549]
Stock Position:  -0.009698774530271927
Bond Position:  [-0.7873041]


portfolio before change:  [-1.74053518]
curr_Stock_Price:  98.26336508348828
curr_Factors:  [9.82633651e+01 4.75718262e-02]
mat_Sqrt:  [[ 2.14321897e+01  0.00000000e+00]
 [-8.72438662e-03  1.99900810e-02]]
grads:  [-0.00337599  1.66176683]
Stock Position:  -0.0033759897320149272
Bond Position:  [-1.40879907]


portfolio before change:  [-1.73787791]
curr_Stock_Price:  97.37191899146444
curr_Factors:  [9.73719190e+01 4.85415216e-02]
mat_Sqrt:  [[ 2.14531180e+01  0.00000000e+00]
 [-8.81285621e-03  2.01927903e-02]]
grads:  [-9.24940077e-03 -1.09774336e+01]
Stock Position:  -0.009249400771395418
Bond Position:  [-0.83724601]


portfolio before change:  [-1.75297313]
curr_Stock_Price:  98.98130839394983
curr_Factors:  [9.89813084e+01 4.67202182e-02]
mat_Sqrt:  [[ 2.13946714e+01  0.00000000e+00]
 [-8.64594408e-03  1.98103466e-02]]
grads:  [-0.00693765 -6.18638467]
Stock Position:  -0.006937650251798509
Bond Position:  [-1.06627543]


portfolio before change:  [-1.73344943]
curr_Stock_Price:  96.1287127491299
curr_Factors:  [9.61287127e+01 4.88115474e-02]
mat_Sqrt:  [[ 2.12380390e+01  0.00000000e+00]
 [-8.83733421e-03  2.02488765e-02]]
grads:  [0.00524578 2.64720058]
Stock Position:  0.005245779390518292
Bond Position:  [-2.23771945]


portfolio before change:  [-1.71855001]
curr_Stock_Price:  99.07563666722405
curr_Factors:  [9.90756367e+01 4.84660901e-02]
mat_Sqrt:  [[ 2.18115166e+01  0.00000000e+00]
 [-8.80600614e-03  2.01770949e-02]]
grads:  [-1.19683692e-03 -2.68463680e+00]
Stock Position:  -0.001196836921715022
Bond Position:  [-1.59997263]


portfolio before change:  [-1.71803153]
curr_Stock_Price:  98.30817630114989
curr_Factors:  [9.83081763e+01 4.75964053e-02]
mat_Sqrt:  [[ 2.14475020e+01  0.00000000e+00]
 [-8.72664016e-03  1.99952445e-02]]
grads:  [  0.02284456 -15.28338195]
Stock Position:  0.022844562327157484
Bond Position:  [-3.96383879]


portfolio before change:  [-1.7128976]
curr_Stock_Price:  98.57629318497926
curr_Factors:  [9.85762932e+01 4.50880287e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.7128976]
Stock Price:  98.47188054244656
PL:  [-1.7128976]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.92169782e-02 -3.58271696e-04]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.01294502e-01 -8.34013225e-01]
 [ 1.10232205e-01  9.97843616e-02]
 [-2.22643365e-01 -9.18617568e-02]
 [ 1.75334953e-01 -1.77969903e-01]
 [-5.06441839e-01  2.30354930e-01]
 [ 2.01083886e-01  1.48484109e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.96467204e-01  6.99323707e-03]
 [ 1.03859716e-01  1.72684715e-01]
 [-2.38156926e-01  9.97113697e-02]
 [-2.75687429e-03  4.37207997e-02]
 [-2.02059590e-01 -2.65190524e-01]
 [-1.08437576e-01 -1.29027626e-01]
 [ 8.85678898e-02  6.60295502e-02]
 [-2.68601638e-02 -4.21057081e-02]
 [ 3.85126933e-01 -2.31928925e-01]
 [ 2.02295726e-01  8.95747677e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.22905296]
curr_Stock_Price:  99.4423032295915
curr_Factors:  [9.94423032e+01 4.13834324e-02]
mat_Sqrt:  [[ 2.02294665e+01  0.00000000e+00]
 [-8.13716731e-03  1.86445926e-02]]
grads:  [ 0.00094222 -0.01921585]
Stock Position:  0.0009422203784969897
Bond Position:  [-1.32274953]


portfolio before change:  [-1.22927053]
curr_Stock_Price:  99.56240423861506
curr_Factors:  [9.95624042e+01 4.15969480e-02]
mat_Sqrt:  [[ 2.03060808e+01  0.00000000e+00]
 [-8.15813195e-03  1.86926286e-02]]
grads:  [-0.00917582 -3.56568205]
Stock Position:  -0.009175816462100948
Bond Position:  [-0.31570418]


portfolio before change:  [-1.22058381]
curr_Stock_Price:  98.60710458375995
curr_Factors:  [9.86071046e+01 4.29075557e-02]
mat_Sqrt:  [[ 2.04256128e+01  0.00000000e+00]
 [-8.28565562e-03  1.89848220e-02]]
grads:  [-2.76754348e-02 -4.39305263e+01]
Stock Position:  -0.027675434829227998
Bond Position:  [1.50841069]


portfolio before change:  [-1.27723066]
curr_Stock_Price:  100.66756018355827
curr_Factors:  [1.00667560e+02 4.28459311e-02]
mat_Sqrt:  [[ 2.08374387e+01  0.00000000e+00]
 [-8.27970349e-03  1.89711840e-02]]
grads:  [0.00738007 5.25978567]
Stock Position:  0.007380065898242734
Bond Position:  [-2.02016389]


portfolio before change:  [-1.27127838]
curr_Stock_Price:  101.54253683653899
curr_Factors:  [1.01542537e+02 4.15225913e-02]
mat_Sqrt:  [[ 2.06914170e+01  0.00000000e+00]
 [-8.15083714e-03  1.86759141e-02]]
grads:  [-0.01269778 -4.91872882]
Stock Position:  -0.012697782971670166
Bond Position:  [0.01808671]


portfolio before change:  [-1.23608517]
curr_Stock_Price:  98.77128962211731
curr_Factors:  [9.87712896e+01 4.29037818e-02]
mat_Sqrt:  [[ 2.04587225e+01  0.00000000e+00]
 [-8.28529124e-03  1.89839871e-02]]
grads:  [ 4.77363723e-03 -9.37473786e+00]
Stock Position:  0.004773637232739503
Bond Position:  [-1.70758347]


portfolio before change:  [-1.2303325]
curr_Stock_Price:  100.06581998443939
curr_Factors:  [1.0006582e+02 4.0976185e-02]
mat_Sqrt:  [[ 2.02558988e+01  0.00000000e+00]
 [-8.09703008e-03  1.85526266e-02]]
grads:  [-0.02003894 12.4162974 ]
Stock Position:  -0.02003893818895168
Bond Position:  [0.77488029]


portfolio before change:  [-1.25070848]
curr_Stock_Price:  101.09230767542117
curr_Factors:  [1.01092308e+02 4.19802081e-02]
mat_Sqrt:  [[ 2.07128759e+01  0.00000000e+00]
 [-8.19562889e-03  1.87785449e-02]]
grads:  [0.01283683 7.90711476]
Stock Position:  0.01283682986406393
Bond Position:  [-2.54841323]


portfolio before change:  [-1.25250534]
curr_Stock_Price:  101.0019671018926
curr_Factors:  [1.01001967e+02 4.03550515e-02]
mat_Sqrt:  [[ 2.02898476e+01  0.00000000e+00]
 [-8.03542671e-03  1.84114756e-02]]
grads:  [-0.01072363 -2.88672741]
Stock Position:  -0.010723632571749957
Bond Position:  [-0.16939736]


portfolio before change:  [-1.25499471]
curr_Stock_Price:  101.23015524095683
curr_Factors:  [1.01230155e+02 3.84059971e-02]
mat_Sqrt:  [[ 1.98385271e+01  0.00000000e+00]
 [-7.83897923e-03  1.79613579e-02]]
grads:  [0.01509786 0.38934902]
Stock Position:  0.01509785990447375
Bond Position:  [-2.78335341]


portfolio before change:  [-1.26495453]
curr_Stock_Price:  100.61656522859738
curr_Factors:  [1.00616565e+02 3.70833718e-02]
mat_Sqrt:  [[ 1.93757756e+01  0.00000000e+00]
 [-7.70281733e-03  1.76493717e-02]]
grads:  [9.24997837e-03 9.78418484e+00]
Stock Position:  0.009249978365543905
Bond Position:  [-2.19565558]


portfolio before change:  [-1.25290498]
curr_Stock_Price:  101.97857132569035
curr_Factors:  [1.01978571e+02 3.62150439e-02]
mat_Sqrt:  [[ 1.94067777e+01  0.00000000e+00]
 [-7.61210025e-03  1.74415128e-02]]
grads:  [-0.01002945  5.71689915]
Stock Position:  -0.010029450496078493
Bond Position:  [-0.23011595]


portfolio before change:  [-1.25262384]
curr_Stock_Price:  101.94480302353757
curr_Factors:  [1.01944803e+02 3.75678116e-02]
mat_Sqrt:  [[ 1.97593675e+01  0.00000000e+00]
 [-7.75296708e-03  1.77642792e-02]]
grads:  [8.26162428e-04 2.46116373e+00]
Stock Position:  0.0008261624277344106
Bond Position:  [-1.33684681]


portfolio before change:  [-1.25497126]
curr_Stock_Price:  99.50803805020935
curr_Factors:  [9.95080381e+01 3.77289973e-02]
mat_Sqrt:  [[ 1.93283951e+01  0.00000000e+00]
 [-7.76958143e-03  1.78023475e-02]]
grads:  [ -0.01644204 -14.89637948]
Stock Position:  -0.016442038827980412
Bond Position:  [0.38114377]


portfolio before change:  [-1.23152831]
curr_Stock_Price:  98.0880405910608
curr_Factors:  [9.80880406e+01 3.99569442e-02]
mat_Sqrt:  [[ 1.96070471e+01  0.00000000e+00]
 [-7.99569326e-03  1.83204348e-02]]
grads:  [-0.00840258 -7.04282551]
Stock Position:  -0.008402583391064346
Bond Position:  [-0.40733537]


portfolio before change:  [-1.23455945]
curr_Stock_Price:  98.4366592081145
curr_Factors:  [9.84366592e+01 3.80536886e-02]
mat_Sqrt:  [[ 1.92023882e+01  0.00000000e+00]
 [-7.80294187e-03  1.78787859e-02]]
grads:  [0.00611307 3.69317865]
Stock Position:  0.0061130702393927825
Bond Position:  [-1.83630966]


portfolio before change:  [-1.22450675]
curr_Stock_Price:  100.15622586832872
curr_Factors:  [1.00156226e+02 3.76926407e-02]
mat_Sqrt:  [[ 1.94449232e+01  0.00000000e+00]
 [-7.76583705e-03  1.77937681e-02]]
grads:  [-2.32639650e-03 -2.36631769e+00]
Stock Position:  -0.0023263965023692774
Bond Position:  [-0.99150366]


portfolio before change:  [-1.22899297]
curr_Stock_Price:  101.97806097168548
curr_Factors:  [1.01978061e+02 3.77025338e-02]
mat_Sqrt:  [[ 1.98012232e+01  0.00000000e+00]
 [-7.76685612e-03  1.77961031e-02]]
grads:  [  0.01433774 -13.03256811]
Stock Position:  0.01433774310076004
Bond Position:  [-2.69112821]


portfolio before change:  [-1.23359053]
curr_Stock_Price:  101.70432965090751
curr_Factors:  [1.01704330e+02 3.52552125e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.23359053]
Stock Price:  101.88926525179716
PL:  [-3.12285578]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.04602848e-01  6.09599818e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.17199257e-01 -1.00025550e+00]
 [-2.58530629e-02  2.76921581e-01]
 [-4.28803148e-01 -9.53023382e-02]
 [ 3.37250040e-01 -3.96598924e-01]
 [-5.25699028e-01  2.94783967e-01]
 [ 2.10980031e-01  1.49261443e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.39717964e-01  5.74670635e-03]
 [-6.67009908e-02  1.24307299e-02]
 [-1.53803011e-01  3.17239322e-02]
 [-1.27285583e-01  3.02554590e-02]
 [-8.68859546e-02 -2.14660255e-01]
 [-1.80066577e-01 -1.40876792e-01]
 [ 8.80181072e-02  3.63940426e-02]
 [ 6.50310423e-02 -8.46443063e-02]
 [ 9.43619030e-01 -4.38458020e-01]
 [ 1.47527250e-01  1.66120249e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.09842224]
curr_Stock_Price:  100.21560378209193
curr_Factors:  [1.00215604e+02 3.68798326e-02]
mat_Sqrt:  [[ 1.92455274e+01  0.00000000e+00]
 [-7.68164905e-03  1.76008691e-02]]
grads:  [-0.00405277  3.4634643 ]
Stock Position:  -0.0040527717983692806
Bond Position:  [4.50457321]


portfolio before change:  [4.1084502]
curr_Stock_Price:  98.01916215678831
curr_Factors:  [9.80191622e+01 3.67945825e-02]
mat_Sqrt:  [[ 1.88019514e+01  0.00000000e+00]
 [-7.67276561e-03  1.75805146e-02]]
grads:  [-0.00990987 -3.79124114]
Stock Position:  -0.009909868725551918
Bond Position:  [5.07980723]


portfolio before change:  [4.11530994]
curr_Stock_Price:  97.45511477519887
curr_Factors:  [9.74551148e+01 3.72912113e-02]
mat_Sqrt:  [[ 1.88194914e+01  0.00000000e+00]
 [-7.72437299e-03  1.76987620e-02]]
grads:  [-3.47377371e-02 -5.65155630e+01]
Stock Position:  -0.034737737104935495
Bond Position:  [7.5006801]


portfolio before change:  [4.12900981]
curr_Stock_Price:  97.11472238230046
curr_Factors:  [9.71147224e+01 3.88665516e-02]
mat_Sqrt:  [[ 1.91457806e+01  0.00000000e+00]
 [-7.88584064e-03  1.80687308e-02]]
grads:  [4.96221207e-03 1.53260118e+01]
Stock Position:  0.004962212066119823
Bond Position:  [3.64710596]


portfolio before change:  [4.13669211]
curr_Stock_Price:  98.47911547479963
curr_Factors:  [9.84791155e+01 3.71223518e-02]
mat_Sqrt:  [[ 1.89741304e+01  0.00000000e+00]
 [-7.70686466e-03  1.76586453e-02]]
grads:  [-0.02479147 -5.39692238]
Stock Position:  -0.024791465498891354
Bond Position:  [6.5781337]


portfolio before change:  [4.10190721]
curr_Stock_Price:  99.94855817827353
curr_Factors:  [9.99485582e+01 3.65300437e-02]
mat_Sqrt:  [[ 1.91030024e+01  0.00000000e+00]
 [-7.64513375e-03  1.75172020e-02]]
grads:  [ 8.59341770e-03 -2.26405406e+01]
Stock Position:  0.008593417703331434
Bond Position:  [3.2430075]


portfolio before change:  [4.11258978]
curr_Stock_Price:  101.09731152926412
curr_Factors:  [1.01097312e+02 3.68839299e-02]
mat_Sqrt:  [[ 1.94159301e+01  0.00000000e+00]
 [-7.68207575e-03  1.76018468e-02]]
grads:  [-0.02044943 16.7473317 ]
Stock Position:  -0.020449432744774572
Bond Position:  [6.17997245]


portfolio before change:  [4.11235744]
curr_Stock_Price:  101.18423444562627
curr_Factors:  [1.01184234e+02 3.65521643e-02]
mat_Sqrt:  [[ 1.93450296e+01  0.00000000e+00]
 [-7.64744812e-03  1.75225050e-02]]
grads:  [0.01427359 8.51827084]
Stock Position:  0.014273592298185905
Bond Position:  [2.66809493]


portfolio before change:  [4.08461554]
curr_Stock_Price:  99.19391502323097
curr_Factors:  [9.91939150e+01 3.84223789e-02]
mat_Sqrt:  [[ 1.94436214e+01  0.00000000e+00]
 [-7.84065088e-03  1.79651881e-02]]
grads:  [-0.01119035 -2.9584389 ]
Stock Position:  -0.011190346993277943
Bond Position:  [5.19462987]


portfolio before change:  [4.09498091]
curr_Stock_Price:  98.38370362653608
curr_Factors:  [9.83837036e+01 3.98004789e-02]
mat_Sqrt:  [[ 1.96276053e+01  0.00000000e+00]
 [-7.98002294e-03  1.82845296e-02]]
grads:  [0.01234109 0.31429337]
Stock Position:  0.012341089416836365
Bond Position:  [2.88081882]


portfolio before change:  [4.08454253]
curr_Stock_Price:  97.47951482394143
curr_Factors:  [9.74795148e+01 4.16978942e-02]
mat_Sqrt:  [[ 1.99053776e+01  0.00000000e+00]
 [-8.16802490e-03  1.87152962e-02]]
grads:  [-0.00307835  0.66420161]
Stock Position:  -0.003078352831488455
Bond Position:  [4.38461887]


portfolio before change:  [4.09284745]
curr_Stock_Price:  95.13779613201095
curr_Factors:  [9.51377961e+01 4.15412039e-02]
mat_Sqrt:  [[ 1.93906616e+01  0.00000000e+00]
 [-8.15266375e-03  1.86800994e-02]]
grads:  [-0.00721778  1.69827427]
Stock Position:  -0.007217781150975579
Bond Position:  [4.77953125]


portfolio before change:  [4.08029667]
curr_Stock_Price:  97.04223405933537
curr_Factors:  [9.70422341e+01 3.85541474e-02]
mat_Sqrt:  [[ 1.90544465e+01  0.00000000e+00]
 [-7.85408403e-03  1.79959673e-02]]
grads:  [-0.00598711  1.68123549]
Stock Position:  -0.00598710744009434
Bond Position:  [4.66129895]


portfolio before change:  [4.08245754]
curr_Stock_Price:  96.87597625286959
curr_Factors:  [9.68759763e+01 3.54389890e-02]
mat_Sqrt:  [[ 1.82371409e+01  0.00000000e+00]
 [-7.53009843e-03  1.72536230e-02]]
grads:  [-9.90129820e-03 -1.24414597e+01]
Stock Position:  -0.009901298197643712
Bond Position:  [5.04165547]


portfolio before change:  [4.09166312]
curr_Stock_Price:  96.0735559571982
curr_Factors:  [9.60735560e+01 3.64524343e-02]
mat_Sqrt:  [[ 1.83428635e+01  0.00000000e+00]
 [-7.63700824e-03  1.74985842e-02]]
grads:  [-0.01316862 -8.05075372]
Stock Position:  -0.013168622749416907
Bond Position:  [5.35681953]


portfolio before change:  [4.10886121]
curr_Stock_Price:  94.86927513677321
curr_Factors:  [9.48692751e+01 4.10547241e-02]
mat_Sqrt:  [[ 1.92223797e+01  0.00000000e+00]
 [-8.10478616e-03  1.85703980e-02]]
grads:  [0.00540525 1.95978797]
Stock Position:  0.005405250089938147
Bond Position:  [3.59606905]


portfolio before change:  [4.110222]
curr_Stock_Price:  94.95468511908395
curr_Factors:  [9.49546851e+01 4.03897706e-02]
mat_Sqrt:  [[ 1.90832391e+01  0.00000000e+00]
 [-8.03888257e-03  1.84193939e-02]]
grads:  [ 1.47193243e-03 -4.59539041e+00]
Stock Position:  0.0014719324281442642
Bond Position:  [3.97045512]


portfolio before change:  [4.11116637]
curr_Stock_Price:  94.92182215796551
curr_Factors:  [9.49218222e+01 4.12220314e-02]
mat_Sqrt:  [[ 1.92721764e+01  0.00000000e+00]
 [-8.12128378e-03  1.86081988e-02]]
grads:  [  0.03903349 -23.56262548]
Stock Position:  0.03903348783392186
Bond Position:  [0.40603658]


portfolio before change:  [4.10602043]
curr_Stock_Price:  94.78738728047439
curr_Factors:  [9.47873873e+01 4.31158699e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.10602043]
Stock Price:  93.84576140931718
PL:  [4.10602043]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.74067258e-02  7.86896448e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.69231479e-01 -1.30275579e+00]
 [-1.13106613e-02  2.78445520e-01]
 [-4.40511295e-01 -3.02421032e-02]
 [ 3.45265071e-01 -1.73195807e-01]
 [-7.63634480e-02  2.37563739e-02]
 [-1.86869849e-01 -6.52188806e-01]
 [-2.55717407e-01  2.03442499e-01]
 [-2.69069885e-03  1.76495154e-02]
 [-8.46200773e-02  1.95250090e-02]
 [-4.38230399e-03 -4.69280194e-02]
 [ 2.84233562e-01 -4.23790844e-02]
 [ 1.37664114e-01  6.62518900e-02]
 [-2.78583861e-01 -1.09222124e-01]
 [ 8.35824565e-02  5.64804994e-02]
 [ 3.41839184e-02 -6.20723622e-02]
 [ 1.27536280e+00 -5.76030165e-01]
 [ 2.34362082e-01  2.45713627e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.35948518]
curr_Stock_Price:  99.81803805650289
curr_Factors:  [9.98180381e+01 4.04617250e-02]
mat_Sqrt:  [[ 2.00784982e+01  0.00000000e+00]
 [-8.04604002e-03  1.84357937e-02]]
grads:  [-0.00268807  0.42683079]
Stock Position:  -0.002688070967908566
Bond Position:  [1.62780315]


portfolio before change:  [1.3638475]
curr_Stock_Price:  98.34660409787877
curr_Factors:  [9.83466041e+01 4.10907963e-02]
mat_Sqrt:  [[ 1.99357072e+01  0.00000000e+00]
 [-8.10834595e-03  1.85785545e-02]]
grads:  [-0.00934629 -3.58757567]
Stock Position:  -0.009346288449514434
Bond Position:  [2.28302323]


portfolio before change:  [1.38818633]
curr_Stock_Price:  95.80356142407015
curr_Factors:  [9.58035614e+01 3.93375362e-02]
mat_Sqrt:  [[ 1.90013839e+01  0.00000000e+00]
 [-7.93347704e-03  1.81778795e-02]]
grads:  [-3.88287887e-02 -7.16670934e+01]
Stock Position:  -0.0388287886557368
Bond Position:  [5.10812257]


portfolio before change:  [1.39854771]
curr_Stock_Price:  95.56960662750252
curr_Factors:  [9.55696066e+01 4.08192669e-02]
mat_Sqrt:  [[ 1.93086717e+01  0.00000000e+00]
 [-8.08151144e-03  1.85170689e-02]]
grads:  [5.70794968e-03 1.50372352e+01]
Stock Position:  0.0057079496779415895
Bond Position:  [0.8530412]


portfolio before change:  [1.39465569]
curr_Stock_Price:  94.85038185326403
curr_Factors:  [9.48503819e+01 4.14542417e-02]
mat_Sqrt:  [[ 1.93118363e+01  0.00000000e+00]
 [-8.14412590e-03  1.86605367e-02]]
grads:  [-0.02349388 -1.62064487]
Stock Position:  -0.02349388346339419
Bond Position:  [3.62305951]


portfolio before change:  [1.41804545]
curr_Stock_Price:  93.89337205718103
curr_Factors:  [9.38933721e+01 4.01847292e-02]
mat_Sqrt:  [[ 1.88219866e+01  0.00000000e+00]
 [-8.01845164e-03  1.83725808e-02]]
grads:  [ 0.01432772 -9.42686325]
Stock Position:  0.0143277237241815
Bond Position:  [0.07276715]


portfolio before change:  [1.39316034]
curr_Stock_Price:  92.15525208374036
curr_Factors:  [9.21552521e+01 4.13573405e-02]
mat_Sqrt:  [[ 1.87411568e+01  0.00000000e+00]
 [-8.13460170e-03  1.86387140e-02]]
grads:  [-0.00352141  1.27457151]
Stock Position:  -0.003521411046641615
Bond Position:  [1.71767686]


portfolio before change:  [1.40116462]
curr_Stock_Price:  90.00417949455208
curr_Factors:  [9.00041795e+01 4.37525447e-02]
mat_Sqrt:  [[ 1.88262723e+01  0.00000000e+00]
 [-8.36684358e-03  1.91708470e-02]]
grads:  [-2.50452332e-02 -3.40198222e+01]
Stock Position:  -0.025045233184104267
Bond Position:  [3.65534029]


portfolio before change:  [1.40056759]
curr_Stock_Price:  90.06450953318877
curr_Factors:  [9.00645095e+01 4.32828554e-02]
mat_Sqrt:  [[ 1.87374998e+01  0.00000000e+00]
 [-8.32181282e-03  1.90676686e-02]]
grads:  [-8.90875640e-03  1.06695005e+01]
Stock Position:  -0.008908756403618493
Bond Position:  [2.20293037]


portfolio before change:  [1.39150717]
curr_Stock_Price:  91.14336044360137
curr_Factors:  [9.11433604e+01 4.36303057e-02]
mat_Sqrt:  [[ 1.90379054e+01  0.00000000e+00]
 [-8.35514746e-03  1.91440478e-02]]
grads:  [2.63273772e-04 9.21932264e-01]
Stock Position:  0.00026327377199591713
Bond Position:  [1.36751152]


portfolio before change:  [1.39135084]
curr_Stock_Price:  89.250811399002
curr_Factors:  [8.92508114e+01 4.45336719e-02]
mat_Sqrt:  [[ 1.88346011e+01  0.00000000e+00]
 [-8.44120104e-03  1.93412214e-02]]
grads:  [-0.00404037  1.00950238]
Stock Position:  -0.004040365097689732
Bond Position:  [1.7519567]


portfolio before change:  [1.38788471]
curr_Stock_Price:  90.21710316018843
curr_Factors:  [9.02171032e+01 4.11098282e-02]
mat_Sqrt:  [[ 1.82920217e+01  0.00000000e+00]
 [-8.11022350e-03  1.85828565e-02]]
grads:  [-1.35924673e-03 -2.52533938e+00]
Stock Position:  -0.0013592467304987003
Bond Position:  [1.51051201]


portfolio before change:  [1.38648278]
curr_Stock_Price:  91.52636367366844
curr_Factors:  [9.15263637e+01 3.75224487e-02]
mat_Sqrt:  [[ 1.77293084e+01  0.00000000e+00]
 [-7.74828483e-03  1.77535509e-02]]
grads:  [ 0.01498862 -2.38707652]
Stock Position:  0.014988617030019406
Bond Position:  [0.01462916]


portfolio before change:  [1.38372138]
curr_Stock_Price:  91.3418867685698
curr_Factors:  [9.13418868e+01 3.72329188e-02]
mat_Sqrt:  [[ 1.76251783e+01  0.00000000e+00]
 [-7.71833337e-03  1.76849235e-02]]
grads:  [0.00945118 3.74623561]
Stock Position:  0.009451184331256954
Bond Position:  [0.52043237]


portfolio before change:  [1.39083017]
curr_Stock_Price:  92.08027764876351
curr_Factors:  [9.20802776e+01 3.63616260e-02]
mat_Sqrt:  [[ 1.75585346e+01  0.00000000e+00]
 [-7.62748986e-03  1.74767748e-02]]
grads:  [-0.01858084 -6.24955834]
Stock Position:  -0.018580838930198428
Bond Position:  [3.10175898]


portfolio before change:  [1.41029533]
curr_Stock_Price:  91.07442288320614
curr_Factors:  [9.10744229e+01 3.45249370e-02]
mat_Sqrt:  [[ 1.69224358e+01  0.00000000e+00]
 [-7.43235489e-03  1.70296644e-02]]
grads:  [0.0063958  3.31659497]
Stock Position:  0.006395803095284149
Bond Position:  [0.82780126]


portfolio before change:  [1.41901249]
curr_Stock_Price:  92.40501024974623
curr_Factors:  [9.24050102e+01 3.27766512e-02]
mat_Sqrt:  [[ 1.67293015e+01  0.00000000e+00]
 [-7.24172921e-03  1.65928861e-02]]
grads:  [ 4.24005661e-04 -3.74090207e+00]
Stock Position:  0.00042400566146508673
Bond Position:  [1.37983224]


portfolio before change:  [1.41893855]
curr_Stock_Price:  91.41696334480571
curr_Factors:  [9.14169633e+01 3.31599200e-02]
mat_Sqrt:  [[ 1.66469060e+01  0.00000000e+00]
 [-7.28394618e-03  1.66896174e-02]]
grads:  [  0.06151069 -34.51428226]
Stock Position:  0.0615106871317631
Bond Position:  [-4.20418168]


portfolio before change:  [1.349016]
curr_Stock_Price:  90.29729818279992
curr_Factors:  [9.02972982e+01 3.52395027e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.349016]
Stock Price:  89.71263465637804
PL:  [1.349016]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.02902136e-01  3.85669682e-01]
 [ 1.60941208e-01 -2.29350966e-02]
 [-1.26795065e-01 -3.25714173e-01]
 [ 3.05994359e-01 -2.17925037e-01]
 [-8.61723198e-02 -5.93035566e-02]
 [ 9.90130272e-01 -1.41153060e+00]
 [-7.13615275e-01  9.39945554e-01]
 [ 1.09775556e+00  2.18916884e-01]
 [ 3.68895904e-01 -2.13212293e-01]
 [-2.44113883e-01  3.71746475e-02]
 [ 4.69979989e-01  7.24446517e-01]
 [-1.70528985e-01  1.46669391e-01]
 [-1.48805153e-01  1.58900946e-01]
 [-2.44541282e-01 -5.27906427e-02]
 [ 2.07280408e-01  1.69756175e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.31986438e-02  2.12739285e-01]
 [ 1.09391180e-01  1.22199968e-01]
 [-3.90555306e-02 -2.52497250e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.52553259]
curr_Stock_Price:  102.45489960624576
curr_Factors:  [1.02454900e+02 4.07459188e-02]
mat_Sqrt:  [[ 2.06811550e+01  0.00000000e+00]
 [-8.07424734e-03  1.85004248e-02]]
grads:  [1.31144602e-02 2.08465312e+01]
Stock Position:  0.013114460238423036
Bond Position:  [18.18189188]


portfolio before change:  [19.53683046]
curr_Stock_Price:  102.96973768528481
curr_Factors:  [1.02969738e+02 4.23226659e-02]
mat_Sqrt:  [[ 2.11834218e+01  0.00000000e+00]
 [-8.22898933e-03  1.88549833e-02]]
grads:  [ 0.00712498 -1.21639443]
Stock Position:  0.0071249825886308404
Bond Position:  [18.80317287]


portfolio before change:  [19.53960537]
curr_Stock_Price:  102.69935646667307
curr_Factors:  [1.02699356e+02 4.10177470e-02]
mat_Sqrt:  [[ 2.07995349e+01  0.00000000e+00]
 [-8.10113542e-03  1.85620331e-02]]
grads:  [-1.29305000e-02 -1.75473328e+01]
Stock Position:  -0.012930499953813462
Bond Position:  [20.8675594]


portfolio before change:  [19.52704868]
curr_Stock_Price:  104.07395429781006
curr_Factors:  [1.04073954e+02 4.16942879e-02]
mat_Sqrt:  [[ 2.12510472e+01  0.00000000e+00]
 [-8.16767168e-03  1.87144869e-02]]
grads:  [ 9.92346743e-03 -1.16447241e+01]
Stock Position:  0.00992346743156689
Bond Position:  [18.49427418]


portfolio before change:  [19.55375162]
curr_Stock_Price:  106.29886195606058
curr_Factors:  [1.06298862e+02 3.87409218e-02]
mat_Sqrt:  [[ 2.09225006e+01  0.00000000e+00]
 [-7.87308547e-03  1.80395051e-02]]
grads:  [-0.00535569 -3.28742703]
Stock Position:  -0.005355694128168032
Bond Position:  [20.12305582]


portfolio before change:  [19.55177725]
curr_Stock_Price:  107.60695901503281
curr_Factors:  [1.07606959e+02 3.82531108e-02]
mat_Sqrt:  [[ 2.10462022e+01  0.00000000e+00]
 [-7.82336100e-03  1.79255720e-02]]
grads:  [ 1.77745995e-02 -7.87439641e+01]
Stock Position:  0.017774599480657592
Bond Position:  [17.63910665]


portfolio before change:  [19.61205988]
curr_Stock_Price:  110.75033824905023
curr_Factors:  [1.10750338e+02 3.69930345e-02]
mat_Sqrt:  [[ 2.13012476e+01  0.00000000e+00]
 [-7.69342935e-03  1.76278612e-02]]
grads:  [-1.42427998e-02  5.33215882e+01]
Stock Position:  -0.014242799759439866
Bond Position:  [21.18945478]


portfolio before change:  [19.62707959]
curr_Stock_Price:  110.06776994590297
curr_Factors:  [1.10067770e+02 3.68689095e-02]
mat_Sqrt:  [[ 2.11344190e+01  0.00000000e+00]
 [-7.68051139e-03  1.75982624e-02]]
grads:  [ 0.05646234 12.43968746]
Stock Position:  0.05646233865164096
Bond Position:  [13.41239589]


portfolio before change:  [19.57428319]
curr_Stock_Price:  109.07330319462943
curr_Factors:  [1.09073303e+02 3.61264689e-02]
mat_Sqrt:  [[ 2.07315237e+01  0.00000000e+00]
 [-7.60278569e-03  1.74201705e-02]]
grads:  [  0.01330546 -12.23939189]
Stock Position:  0.013305458593562112
Bond Position:  [18.12301287]


portfolio before change:  [19.60610495]
curr_Stock_Price:  111.12437418018922
curr_Factors:  [1.11124374e+02 3.42126336e-02]
mat_Sqrt:  [[ 2.05542948e+01  0.00000000e+00]
 [-7.39866297e-03  1.69524666e-02]]
grads:  [-0.0110872   2.19287544]
Stock Position:  -0.011087198023516862
Bond Position:  [20.8381629]


portfolio before change:  [19.59608124]
curr_Stock_Price:  112.49838266369423
curr_Factors:  [1.12498383e+02 3.21516630e-02]
mat_Sqrt:  [[ 2.01719554e+01  0.00000000e+00]
 [-7.17235392e-03  1.64339274e-02]]
grads:  [3.89726407e-02 4.40823730e+01]
Stock Position:  0.03897264070692337
Bond Position:  [15.21172219]


portfolio before change:  [19.60836265]
curr_Stock_Price:  112.71591989724209
curr_Factors:  [1.12715920e+02 3.39750549e-02]
mat_Sqrt:  [[ 2.07761630e+01  0.00000000e+00]
 [-7.37292939e-03  1.68935035e-02]]
grads:  [-5.12689544e-03  8.68199959e+00]
Stock Position:  -0.005126895436625585
Bond Position:  [20.18624538]


portfolio before change:  [19.63083939]
curr_Stock_Price:  109.31628874434033
curr_Factors:  [1.09316289e+02 3.61517186e-02]
mat_Sqrt:  [[ 2.07849677e+01  0.00000000e+00]
 [-7.60544212e-03  1.74262571e-02]]
grads:  [-3.82271921e-03  9.11847821e+00]
Stock Position:  -0.0038227192113150957
Bond Position:  [20.04872487]


portfolio before change:  [19.64321337]
curr_Stock_Price:  107.39065215565742
curr_Factors:  [1.07390652e+02 3.62870263e-02]
mat_Sqrt:  [[ 2.04570106e+01  0.00000000e+00]
 [-7.61966154e-03  1.74588379e-02]]
grads:  [-0.01308016 -3.02372031]
Stock Position:  -0.013080161752552779
Bond Position:  [21.04790047]


portfolio before change:  [19.66401414]
curr_Stock_Price:  106.20273602040979
curr_Factors:  [1.06202736e+02 3.66174914e-02]
mat_Sqrt:  [[ 2.03226342e+01  0.00000000e+00]
 [-7.65427895e-03  1.75381563e-02]]
grads:  [0.01384506 9.67924862]
Stock Position:  0.013845059383446464
Bond Position:  [18.19363095]


portfolio before change:  [19.69474117]
curr_Stock_Price:  108.0935225224371
curr_Factors:  [1.08093523e+02 3.74185221e-02]
mat_Sqrt:  [[ 2.09094681e+01  0.00000000e+00]
 [-7.73754712e-03  1.77289477e-02]]
grads:  [0.00459103 0.98883792]
Stock Position:  0.0045910268890268615
Bond Position:  [19.1984809]


portfolio before change:  [19.69568156]
curr_Stock_Price:  107.25278908450707
curr_Factors:  [1.07252789e+02 3.86834030e-02]
mat_Sqrt:  [[ 2.10945823e+01  0.00000000e+00]
 [-7.86723870e-03  1.80261084e-02]]
grads:  [1.87955331e-03 1.18017311e+01]
Stock Position:  0.0018795533144654855
Bond Position:  [19.49409422]


portfolio before change:  [19.70302885]
curr_Stock_Price:  108.56861082031013
curr_Factors:  [1.08568611e+02 3.95849360e-02]
mat_Sqrt:  [[ 2.16007711e+01  0.00000000e+00]
 [-7.95838536e-03  1.82349517e-02]]
grads:  [0.00753323 6.70141441]
Stock Position:  0.007533231906705804
Bond Position:  [18.88515632]


portfolio before change:  [19.72255764]
curr_Stock_Price:  110.53415726900788
curr_Factors:  [1.10534157e+02 3.75743805e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.72255764]
Stock Price:  112.31600003666469
PL:  [7.40655761]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-3.52615777e-02  5.49119685e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.51772901e-01 -4.96134389e-01]
 [ 4.88218063e-02  1.94645006e-01]
 [-4.26755230e-01 -1.19297836e-01]
 [ 3.72605537e-01 -4.51743199e-01]
 [-5.41442828e-01  3.16862334e-01]
 [ 3.46189518e-01  1.59882030e-01]
 [ 9.61935682e-02 -1.03200185e-01]
 [ 8.25981629e-02  1.97073224e-02]
 [ 2.53346239e-01  3.78594574e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.44744871e-01  1.55901389e-01]
 [-2.44401620e-01 -5.23122789e-02]
 [ 2.84097484e-01  4.68754378e-01]
 [ 4.60579686e-02  5.77923543e-02]
 [-5.39060415e-02  2.91502573e-01]
 [ 1.77284202e-01  1.88752517e-01]
 [-1.09602990e-02 -2.66999211e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.60856622]
curr_Stock_Price:  99.7090396993654
curr_Factors:  [9.97090397e+01 3.98933958e-02]
mat_Sqrt:  [[ 1.99152167e+01  0.00000000e+00]
 [-7.98933247e-03  1.83058604e-02]]
grads:  [-0.00165025  0.29996934]
Stock Position:  -0.001650246815381274
Bond Position:  [0.77311074]


portfolio before change:  [0.60759373]
curr_Stock_Price:  100.41547273148586
curr_Factors:  [1.00415473e+02 4.06285035e-02]
mat_Sqrt:  [[ 2.02402583e+01  0.00000000e+00]
 [-8.06260538e-03  1.84737497e-02]]
grads:  [-0.00920566 -3.60792861]
Stock Position:  -0.00920565675179912
Bond Position:  [1.53198411]


portfolio before change:  [0.59995185]
curr_Stock_Price:  101.28721093658632
curr_Factors:  [1.01287211e+02 4.09781674e-02]
mat_Sqrt:  [[ 2.05036358e+01  0.00000000e+00]
 [-8.09722594e-03  1.85530754e-02]]
grads:  [-1.79628484e-02 -2.67413558e+01]
Stock Position:  -0.017962848359022083
Bond Position:  [2.41935866]


portfolio before change:  [0.62457505]
curr_Stock_Price:  99.95010222675705
curr_Factors:  [9.99501022e+01 4.18555119e-02]
mat_Sqrt:  [[ 2.04484113e+01  0.00000000e+00]
 [-8.18344787e-03  1.87506347e-02]]
grads:  [6.54191906e-03 1.03807156e+01]
Stock Position:  0.006541919059499907
Bond Position:  [-0.02929043]


portfolio before change:  [0.62169001]
curr_Stock_Price:  99.51021304979048
curr_Factors:  [9.9510213e+01 4.1405585e-02]
mat_Sqrt:  [[ 2.02486987e+01  0.00000000e+00]
 [-8.13934494e-03  1.86495821e-02]]
grads:  [-0.023647   -6.39681016]
Stock Position:  -0.023647004719540236
Bond Position:  [2.97480848]


portfolio before change:  [0.60144474]
curr_Stock_Price:  100.39781237605489
curr_Factors:  [1.00397812e+02 4.30163213e-02]
mat_Sqrt:  [[ 2.08228842e+01  0.00000000e+00]
 [-8.29615055e-03  1.90088689e-02]]
grads:  [ 8.42576079e-03 -2.37648647e+01]
Stock Position:  0.0084257607920609
Bond Position:  [-0.24448322]


portfolio before change:  [0.60950188]
curr_Stock_Price:  101.36131837983841
curr_Factors:  [1.01361318e+02 4.35881546e-02]
mat_Sqrt:  [[ 2.11619894e+01  0.00000000e+00]
 [-8.35111055e-03  1.91347981e-02]]
grads:  [-0.0190508  16.55948144]
Stock Position:  -0.019050797180129374
Bond Position:  [2.5405158]


portfolio before change:  [0.58749996]
curr_Stock_Price:  102.54956943398996
curr_Factors:  [1.02549569e+02 4.47613015e-02]
mat_Sqrt:  [[ 2.16962759e+01  0.00000000e+00]
 [-8.46274674e-03  1.93905888e-02]]
grads:  [0.01917231 8.24534168]
Stock Position:  0.01917231138428182
Bond Position:  [-1.37861232]


portfolio before change:  [0.62336818]
curr_Stock_Price:  104.4383827299354
curr_Factors:  [1.04438383e+02 4.36881032e-02]
mat_Sqrt:  [[ 2.18293967e+01  0.00000000e+00]
 [-8.36067970e-03  1.91567238e-02]]
grads:  [ 2.34332243e-03 -5.38715212e+00]
Stock Position:  0.0023433224327597466
Bond Position:  [0.37863537]


portfolio before change:  [0.62428182]
curr_Stock_Price:  104.78787447775461
curr_Factors:  [1.04787874e+02 4.24051174e-02]
mat_Sqrt:  [[ 2.15784460e+01  0.00000000e+00]
 [-8.23700114e-03  1.88733406e-02]]
grads:  [0.0042264  1.04418835]
Stock Position:  0.004226399964061041
Bond Position:  [0.18140635]


portfolio before change:  [0.62783914]
curr_Stock_Price:  105.61883191511224
curr_Factors:  [1.05618832e+02 4.12814147e-02]
mat_Sqrt:  [[ 2.14594529e+01  0.00000000e+00]
 [-8.12713132e-03  1.86215972e-02]]
grads:  [1.95055512e-02 2.03309399e+01]
Stock Position:  0.019505551189207628
Bond Position:  [-1.4323144]


portfolio before change:  [0.66027104]
curr_Stock_Price:  107.29989299780043
curr_Factors:  [1.07299893e+02 4.16790780e-02]
mat_Sqrt:  [[ 2.19057608e+01  0.00000000e+00]
 [-8.16618178e-03  1.87110731e-02]]
grads:  [-0.00862823  6.11045254]
Stock Position:  -0.008628230983765521
Bond Position:  [1.5860793]


portfolio before change:  [0.64487393]
curr_Stock_Price:  109.13035846872346
curr_Factors:  [1.09130358e+02 4.19750833e-02]
mat_Sqrt:  [[ 2.23584331e+01  0.00000000e+00]
 [-8.19512863e-03  1.87773986e-02]]
grads:  [-3.43064858e-03  8.30260844e+00]
Stock Position:  -0.0034306485808959343
Bond Position:  [1.01926184]


portfolio before change:  [0.65107695]
curr_Stock_Price:  107.3965249450726
curr_Factors:  [1.07396525e+02 4.29238740e-02]
mat_Sqrt:  [[ 2.22504954e+01  0.00000000e+00]
 [-8.28723104e-03  1.89884318e-02]]
grads:  [-0.01201019 -2.7549552 ]
Stock Position:  -0.01201018517078664
Bond Position:  [1.9409291]


portfolio before change:  [0.59764035]
curr_Stock_Price:  111.88620530248124
curr_Factors:  [1.11886205e+02 4.08929149e-02]
mat_Sqrt:  [[ 2.26256247e+01  0.00000000e+00]
 [-8.08879867e-03  1.85337661e-02]]
grads:  [2.15984607e-02 2.52919118e+01]
Stock Position:  0.021598460728374243
Bond Position:  [-1.81892946]


portfolio before change:  [0.56147775]
curr_Stock_Price:  110.23294818349346
curr_Factors:  [1.10232948e+02 4.30487040e-02]
mat_Sqrt:  [[ 2.28713323e+01  0.00000000e+00]
 [-8.29927264e-03  1.90160225e-02]]
grads:  [0.00311659 3.03913997]
Stock Position:  0.003116592376838541
Bond Position:  [0.21792658]


portfolio before change:  [0.55832955]
curr_Stock_Price:  109.20532381682096
curr_Factors:  [1.09205324e+02 4.36520120e-02]
mat_Sqrt:  [[ 2.28163381e+01  0.00000000e+00]
 [-8.35722557e-03  1.91488094e-02]]
grads:  [3.21331631e-03 1.52230129e+01]
Stock Position:  0.0032133163095062187
Bond Position:  [0.2074183]


portfolio before change:  [0.56798257]
curr_Stock_Price:  112.19325095936632
curr_Factors:  [1.12193251e+02 4.33881342e-02]
mat_Sqrt:  [[ 2.33696506e+01  0.00000000e+00]
 [-8.33192743e-03  1.90908441e-02]]
grads:  [0.0111111  9.88707028]
Stock Position:  0.011111101243283652
Bond Position:  [-0.678608]


portfolio before change:  [0.57183513]
curr_Stock_Price:  112.55525240056224
curr_Factors:  [1.12555252e+02 4.35300820e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.57183513]
Stock Price:  111.83498997917508
PL:  [-11.26315485]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.06968844e-02  7.14851575e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.99023876e-01 -8.18521062e-01]
 [ 4.50874970e-02  2.00401689e-01]
 [-2.09817139e-01 -9.03257485e-02]
 [ 7.21390938e-01 -9.92485538e-01]
 [-6.11766355e-01  5.37496568e-01]
 [ 3.69905935e-01  1.61744933e-01]
 [ 2.23167597e-01 -1.74270125e-01]
 [ 8.04932376e-02  1.98214810e-02]
 [ 2.29683553e-01  3.40817514e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-7.26016686e-03  5.43337641e-02]
 [-2.69906423e-01 -2.57095513e-01]
 [-1.34112105e-02 -8.77015335e-02]
 [ 9.39101831e-02  5.17017425e-02]
 [-2.90103854e-02 -4.10376375e-02]
 [ 5.10450001e-01 -2.68392457e-01]
 [ 2.18442825e-01  1.02749391e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.12932543]
curr_Stock_Price:  99.78462961284411
curr_Factors:  [9.97846296e+01 3.95040162e-02]
mat_Sqrt:  [[ 1.98328111e+01  0.00000000e+00]
 [-7.95024690e-03  1.82163041e-02]]
grads:  [-0.0023989   0.39242405]
Stock Position:  -0.002398904328215745
Bond Position:  [1.36869921]


portfolio before change:  [1.12965372]
curr_Stock_Price:  99.79043607996371
curr_Factors:  [9.97904361e+01 3.94465297e-02]
mat_Sqrt:  [[ 1.98195286e+01  0.00000000e+00]
 [-7.94446018e-03  1.82030451e-02]]
grads:  [-0.00940107 -3.66158354]
Stock Position:  -0.009401074745010903
Bond Position:  [2.06779107]


portfolio before change:  [1.14032136]
curr_Stock_Price:  98.7107060366552
curr_Factors:  [9.87107060e+01 4.00441285e-02]
mat_Sqrt:  [[ 1.97530281e+01  0.00000000e+00]
 [-8.00441163e-03  1.83404111e-02]]
grads:  [-2.81605307e-02 -4.46293738e+01]
Stock Position:  -0.028160530708022723
Bond Position:  [3.92006723]


portfolio before change:  [1.10759066]
curr_Stock_Price:  99.90780134458194
curr_Factors:  [9.99078013e+01 3.98567521e-02]
mat_Sqrt:  [[ 1.99457492e+01  0.00000000e+00]
 [-7.98566237e-03  1.82974511e-02]]
grads:  [6.64552446e-03 1.09524374e+01]
Stock Position:  0.006645524463179748
Bond Position:  [0.44365092]


portfolio before change:  [1.11937439]
curr_Stock_Price:  101.66429291265337
curr_Factors:  [1.01664293e+02 4.08427160e-02]
mat_Sqrt:  [[ 2.05459275e+01  0.00000000e+00]
 [-8.08383236e-03  1.85223869e-02]]
grads:  [-0.0121308  -4.87657175]
Stock Position:  -0.012130799523685154
Bond Position:  [2.35264355]


portfolio before change:  [1.08502808]
curr_Stock_Price:  104.54411507321134
curr_Factors:  [1.04544115e+02 4.17228026e-02]
mat_Sqrt:  [[ 2.13543486e+01  0.00000000e+00]
 [-8.17046414e-03  1.87208852e-02]]
grads:  [ 1.34977069e-02 -5.30148830e+01]
Stock Position:  0.013497706865135031
Bond Position:  [-0.32607774]


portfolio before change:  [1.08767369]
curr_Stock_Price:  104.74615949408937
curr_Factors:  [1.04746159e+02 3.90345460e-02]
mat_Sqrt:  [[ 2.06948687e+01  0.00000000e+00]
 [-7.90286489e-03  1.81077383e-02]]
grads:  [-1.82259490e-02  2.96832525e+01]
Stock Position:  -0.018225948994836937
Bond Position:  [2.99677185]


portfolio before change:  [1.12426165]
curr_Stock_Price:  102.7798053152093
curr_Factors:  [1.02779805e+02 3.92330876e-02]
mat_Sqrt:  [[ 2.03579496e+01  0.00000000e+00]
 [-7.92293760e-03  1.81537306e-02]]
grads:  [0.0216376  8.90973523]
Stock Position:  0.02163760201459268
Bond Position:  [-1.09964688]


portfolio before change:  [1.20578816]
curr_Stock_Price:  106.56032865297185
curr_Factors:  [1.06560329e+02 3.89107599e-02]
mat_Sqrt:  [[ 2.10198885e+01  0.00000000e+00]
 [-7.89032419e-03  1.80790039e-02]]
grads:  [ 6.99860416e-03 -9.63936538e+00]
Stock Position:  0.006998604162553559
Bond Position:  [0.4600146]


portfolio before change:  [1.19369475]
curr_Stock_Price:  104.81591974934194
curr_Factors:  [1.04815920e+02 3.73006247e-02]
mat_Sqrt:  [[ 2.02434860e+01  0.00000000e+00]
 [-7.72534786e-03  1.77009957e-02]]
grads:  [0.00440359 1.11979469]
Stock Position:  0.004403591407209315
Bond Position:  [0.73212827]


portfolio before change:  [1.19395013]
curr_Stock_Price:  104.83234377606638
curr_Factors:  [1.04832344e+02 3.63477553e-02]
mat_Sqrt:  [[ 1.99863779e+01  0.00000000e+00]
 [-7.62603492e-03  1.74734411e-02]]
grads:  [1.89343218e-02 1.95048881e+01]
Stock Position:  0.018934321829021362
Bond Position:  [-0.79097921]


portfolio before change:  [1.18552097]
curr_Stock_Price:  104.39760973166095
curr_Factors:  [1.04397610e+02 3.56167848e-02]
mat_Sqrt:  [[ 1.97023446e+01  0.00000000e+00]
 [-7.54896388e-03  1.72968492e-02]]
grads:  [-0.00959317  6.61005497]
Stock Position:  -0.009593171144771784
Bond Position:  [2.1870251]


portfolio before change:  [1.20345514]
curr_Stock_Price:  102.58513814691293
curr_Factors:  [1.02585138e+02 3.70703200e-02]
mat_Sqrt:  [[ 1.97513878e+01  0.00000000e+00]
 [-7.70146168e-03  1.76462655e-02]]
grads:  [8.33006374e-04 3.07905171e+00]
Stock Position:  0.0008330063736245153
Bond Position:  [1.11800107]


portfolio before change:  [1.20345789]
curr_Stock_Price:  102.25286380250662
curr_Factors:  [1.02252864e+02 3.71048232e-02]
mat_Sqrt:  [[ 1.96965727e+01  0.00000000e+00]
 [-7.70504492e-03  1.76544758e-02]]
grads:  [ -0.01939993 -14.56262516]
Stock Position:  -0.019399928571668903
Bond Position:  [3.18715614]


portfolio before change:  [1.23108424]
curr_Stock_Price:  100.86989675697009
curr_Factors:  [1.00869897e+02 3.81101806e-02]
mat_Sqrt:  [[ 1.96916487e+01  0.00000000e+00]
 [-7.80873158e-03  1.78920518e-02]]
grads:  [-2.62483343e-03 -4.90170354e+00]
Stock Position:  -0.0026248334258095873
Bond Position:  [1.49585092]


portfolio before change:  [1.2349702]
curr_Stock_Price:  99.53192556939145
curr_Factors:  [9.95319256e+01 3.98611360e-02]
mat_Sqrt:  [[ 1.98718016e+01  0.00000000e+00]
 [-7.98610153e-03  1.82984574e-02]]
grads:  [0.0058613  2.82547001]
Stock Position:  0.005861304170954239
Bond Position:  [0.65158331]


portfolio before change:  [1.23931587]
curr_Stock_Price:  100.24554642676559
curr_Factors:  [1.00245546e+02 4.10960053e-02]
mat_Sqrt:  [[ 2.03219272e+01  0.00000000e+00]
 [-8.10885987e-03  1.85797321e-02]]
grads:  [-0.00230887 -2.20873139]
Stock Position:  -0.002308869537063877
Bond Position:  [1.47076975]


portfolio before change:  [1.24035284]
curr_Stock_Price:  99.95569307237149
curr_Factors:  [9.99556931e+01 3.99078966e-02]
mat_Sqrt:  [[ 1.99681097e+01  0.00000000e+00]
 [-7.99078435e-03  1.83091871e-02]]
grads:  [  0.0196971  -14.65889534]
Stock Position:  0.019697103803508673
Bond Position:  [-0.72848482]


portfolio before change:  [1.26503405]
curr_Stock_Price:  101.21797797875148
curr_Factors:  [1.01217978e+02 3.89390451e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.26503405]
Stock Price:  98.85966967735578
PL:  [1.26503405]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.38851791e-04  2.31241410e-01]
 [ 1.62455612e-01 -2.28659832e-02]
 [-1.39708780e-01 -4.13822606e-01]
 [ 2.37265285e-01 -1.02837014e-01]
 [-1.60780909e-01 -8.27874571e-02]
 [ 4.48643066e-01 -5.70339593e-01]
 [-5.48790343e-01  3.58018931e-01]
 [ 3.63940347e-01  1.61276342e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.92768552e-01  7.22209409e-03]
 [ 1.20324795e-01  1.87396127e-01]
 [-2.37583220e-01  8.85281500e-02]
 [-1.00085527e-02  5.63641501e-02]
 [-2.64827197e-01 -2.66166387e-01]
 [-3.67729705e-03 -8.36214316e-02]
 [ 8.87659995e-02  1.63101681e-02]
 [-5.21276795e-02  4.35617327e-02]
 [ 3.11284304e-01 -2.10443961e-01]
 [ 9.18571660e-02 -2.56145379e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.16326104]
curr_Stock_Price:  101.3862416684272
curr_Factors:  [1.01386242e+02 3.87583564e-02]
mat_Sqrt:  [[ 1.99600535e+01  0.00000000e+00]
 [-7.87485684e-03  1.80435638e-02]]
grads:  [5.06315662e-03 1.28157282e+01]
Stock Position:  0.005063156622159495
Bond Position:  [11.64992662]


portfolio before change:  [12.17436578]
curr_Stock_Price:  103.00418366739362
curr_Factors:  [1.03004184e+02 3.68599057e-02]
mat_Sqrt:  [[ 1.97757050e+01  0.00000000e+00]
 [-7.67957349e-03  1.75961134e-02]]
grads:  [ 0.00771027 -1.29949056]
Stock Position:  0.0077102727554716
Bond Position:  [11.38017543]


portfolio before change:  [12.16901631]
curr_Stock_Price:  101.94133287459525
curr_Factors:  [1.01941333e+02 3.60490861e-02]
mat_Sqrt:  [[ 1.93551899e+01  0.00000000e+00]
 [-7.59463875e-03  1.74015035e-02]]
grads:  [-1.65493479e-02 -2.37808536e+01]
Stock Position:  -0.01654934790818274
Bond Position:  [13.85607889]


portfolio before change:  [12.16123627]
curr_Stock_Price:  102.62078511046869
curr_Factors:  [1.02620785e+02 3.54955103e-02]
mat_Sqrt:  [[ 1.93340147e+01  0.00000000e+00]
 [-7.53610088e-03  1.72673764e-02]]
grads:  [ 0.00995052 -5.95556684]
Stock Position:  0.009950521657049804
Bond Position:  [11.14010593]


portfolio before change:  [12.16352225]
curr_Stock_Price:  102.57059731153946
curr_Factors:  [1.02570597e+02 3.49607425e-02]
mat_Sqrt:  [[ 1.91784369e+01  0.00000000e+00]
 [-7.47911679e-03  1.71368094e-02]]
grads:  [-0.01026738 -4.83097262]
Stock Position:  -0.010267380912783274
Bond Position:  [13.21665364]


portfolio before change:  [12.17832481]
curr_Stock_Price:  101.450741711311
curr_Factors:  [1.01450742e+02 3.60951587e-02]
mat_Sqrt:  [[ 1.92743484e+01  0.00000000e+00]
 [-7.59949037e-03  1.74126199e-02]]
grads:  [ 1.03622938e-02 -3.27543813e+01]
Stock Position:  0.01036229380114606
Bond Position:  [11.12706242]


portfolio before change:  [12.18765147]
curr_Stock_Price:  102.08231495083966
curr_Factors:  [1.02082315e+02 3.51647006e-02]
mat_Sqrt:  [[ 1.91427343e+01  0.00000000e+00]
 [-7.50090135e-03  1.71867241e-02]]
grads:  [-2.05058517e-02  2.08311328e+01]
Stock Position:  -0.02050585167296476
Bond Position:  [14.28093628]


portfolio before change:  [12.17827544]
curr_Stock_Price:  102.71368184191006
curr_Factors:  [1.02713682e+02 3.44391508e-02]
mat_Sqrt:  [[ 1.90613877e+01  0.00000000e+00]
 [-7.42311534e-03  1.70084940e-02]]
grads:  [0.0227857  9.48210595]
Stock Position:  0.02278570275411801
Bond Position:  [9.83787201]


portfolio before change:  [12.13529541]
curr_Stock_Price:  100.7194574477616
curr_Factors:  [1.00719457e+02 3.49496483e-02]
mat_Sqrt:  [[ 1.88293264e+01  0.00000000e+00]
 [-7.47793002e-03  1.71340902e-02]]
grads:  [-0.01155543 -3.1019395 ]
Stock Position:  -0.011555425110807852
Bond Position:  [13.29915156]


portfolio before change:  [12.13207965]
curr_Stock_Price:  101.28550863320372
curr_Factors:  [1.01285509e+02 3.53438939e-02]
mat_Sqrt:  [[ 1.90416470e+01  0.00000000e+00]
 [-7.51998871e-03  1.72304588e-02]]
grads:  [0.0155407  0.41914694]
Stock Position:  0.01554070040628003
Bond Position:  [10.5580319]


portfolio before change:  [12.13399626]
curr_Stock_Price:  101.23897071585213
curr_Factors:  [1.01238971e+02 3.46499147e-02]
mat_Sqrt:  [[ 1.88451156e+01  0.00000000e+00]
 [-7.44579503e-03  1.70604597e-02]]
grads:  [1.07248570e-02 1.09842367e+01]
Stock Position:  0.010724856987077293
Bond Position:  [11.04822277]


portfolio before change:  [12.13646731]
curr_Stock_Price:  101.21180557874473
curr_Factors:  [1.01211806e+02 3.43798389e-02]
mat_Sqrt:  [[ 1.87664917e+01  0.00000000e+00]
 [-7.41672046e-03  1.69938414e-02]]
grads:  [-0.01060115  5.20942544]
Stock Position:  -0.010601148626815998
Bond Position:  [13.20942871]


portfolio before change:  [12.12386916]
curr_Stock_Price:  102.71172991371809
curr_Factors:  [1.02711730e+02 3.37251138e-02]
mat_Sqrt:  [[ 1.88623915e+01  0.00000000e+00]
 [-7.34575946e-03  1.68312494e-02]]
grads:  [7.73538133e-04 3.34877993e+00]
Stock Position:  0.0007735381327224245
Bond Position:  [12.04441772]


portfolio before change:  [12.1260524]
curr_Stock_Price:  101.6410083002266
curr_Factors:  [1.01641008e+02 3.62018308e-02]
mat_Sqrt:  [[ 1.93390097e+01  0.00000000e+00]
 [-7.61071149e-03  1.74383307e-02]]
grads:  [ -0.01970068 -15.26329506]
Stock Position:  -0.019700684645978957
Bond Position:  [14.12844985]


portfolio before change:  [12.1415834]
curr_Stock_Price:  101.03197127594893
curr_Factors:  [1.01031971e+02 3.77214752e-02]
mat_Sqrt:  [[ 1.96224468e+01  0.00000000e+00]
 [-7.76880688e-03  1.78005728e-02]]
grads:  [-2.04728198e-03 -4.69768207e+00]
Stock Position:  -0.0020472819796869732
Bond Position:  [12.34842434]


portfolio before change:  [12.14247623]
curr_Stock_Price:  102.10396141491904
curr_Factors:  [1.02103961e+02 3.60376353e-02]
mat_Sqrt:  [[ 1.93829884e+01  0.00000000e+00]
 [-7.59343246e-03  1.73987395e-02]]
grads:  [0.00494683 0.93743389]
Stock Position:  0.004946829591718424
Bond Position:  [11.63738533]


portfolio before change:  [12.15012641]
curr_Stock_Price:  103.06224644348653
curr_Factors:  [1.03062246e+02 3.57810276e-02]
mat_Sqrt:  [[ 1.94951243e+01  0.00000000e+00]
 [-7.56634947e-03  1.73366846e-02]]
grads:  [-1.69866989e-03  2.51269108e+00]
Stock Position:  -0.0016986698905065959
Bond Position:  [12.32519514]


portfolio before change:  [12.15302564]
curr_Stock_Price:  103.16965591720093
curr_Factors:  [1.03169656e+02 3.64100248e-02]
mat_Sqrt:  [[ 1.96862261e+01  0.00000000e+00]
 [-7.63256443e-03  1.74884021e-02]]
grads:  [ 1.11468307e-02 -1.20333441e+01]
Stock Position:  0.011146830673106012
Bond Position:  [11.00301096]


portfolio before change:  [12.17843256]
curr_Stock_Price:  105.20214617577358
curr_Factors:  [1.05202146e+02 3.37188879e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.17843256]
Stock Price:  104.26346744686168
PL:  [7.91496511]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.47500150e-02  1.18701621e-01]
 [-5.30555810e-03 -2.49407906e-02]
 [-1.56840237e-01 -5.30708100e-01]
 [ 1.23031809e-01  7.99676995e-02]
 [-1.80938332e-01 -8.61063604e-02]
 [ 4.57328469e-01 -5.83881125e-01]
 [-5.49290072e-01  3.55911173e-01]
 [ 6.73677913e-02  1.37980827e-01]
 [-1.95785386e-01 -4.76918554e-02]
 [ 2.89162514e-01  4.52254161e-03]
 [ 7.83602902e-02  1.50555765e-01]
 [-2.36004238e-01  5.77491075e-02]
 [-3.26030910e-02  3.71949077e-02]
 [-1.95056393e-01 -2.63226835e-01]
 [-9.90434471e-02 -1.24521828e-01]
 [ 9.04698135e-02  5.48277795e-02]
 [ 3.40136383e-02 -7.22286660e-02]
 [ 6.98617176e-01 -3.36703164e-01]
 [ 1.80689053e-01  1.40826622e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.80075783]
curr_Stock_Price:  100.60785668408639
curr_Factors:  [1.00607857e+02 3.81326812e-02]
mat_Sqrt:  [[ 1.96462908e+01  0.00000000e+00]
 [-7.81103642e-03  1.78973328e-02]]
grads:  [-1.16787341e-03  6.63236370e+00]
Stock Position:  -0.0011678734059218474
Bond Position:  [6.91825507]


portfolio before change:  [6.80093805]
curr_Stock_Price:  101.93467543226886
curr_Factors:  [1.01934675e+02 3.72770138e-02]
mat_Sqrt:  [[ 1.96807888e+01  0.00000000e+00]
 [-7.72290244e-03  1.76953925e-02]]
grads:  [-8.22660698e-04 -1.40945111e+00]
Stock Position:  -0.0008226606982728002
Bond Position:  [6.8847957]


portfolio before change:  [6.80345139]
curr_Stock_Price:  100.97203479692055
curr_Factors:  [1.00972035e+02 3.58882085e-02]
mat_Sqrt:  [[ 1.91283275e+01  0.00000000e+00]
 [-7.57767336e-03  1.73626309e-02]]
grads:  [-2.03081133e-02 -3.05661108e+01]
Stock Position:  -0.02030811326075054
Bond Position:  [8.85400291]


portfolio before change:  [6.80870777]
curr_Stock_Price:  100.82221271233992
curr_Factors:  [1.00822213e+02 3.55810009e-02]
mat_Sqrt:  [[ 1.90180202e+01  0.00000000e+00]
 [-7.54517074e-03  1.72881580e-02]]
grads:  [0.00830436 4.62557662]
Stock Position:  0.00830436463928161
Bond Position:  [5.97144336]


portfolio before change:  [6.82120577]
curr_Stock_Price:  102.14741349392374
curr_Factors:  [1.02147413e+02 3.59826723e-02]
mat_Sqrt:  [[ 1.93764442e+01  0.00000000e+00]
 [-7.58763967e-03  1.73854666e-02]]
grads:  [-0.01127752 -4.95277823]
Stock Position:  -0.011277519595501672
Bond Position:  [7.97317523]


portfolio before change:  [6.82971638]
curr_Stock_Price:  101.56953234255116
curr_Factors:  [1.01569532e+02 3.54485313e-02]
mat_Sqrt:  [[ 1.91232885e+01  0.00000000e+00]
 [-7.53111214e-03  1.72559457e-02]]
grads:  [ 1.05892799e-02 -3.38365184e+01]
Stock Position:  0.010589279913109834
Bond Position:  [5.75416817]


portfolio before change:  [6.8360976]
curr_Stock_Price:  102.03627786938392
curr_Factors:  [1.02036278e+02 3.64291141e-02]
mat_Sqrt:  [[ 1.94750649e+01  0.00000000e+00]
 [-7.63456499e-03  1.74929860e-02]]
grads:  [-2.02288261e-02  2.03459360e+01]
Stock Position:  -0.02022882614631481
Bond Position:  [8.90017173]


portfolio before change:  [6.88459882]
curr_Stock_Price:  99.7486562989658
curr_Factors:  [9.97486563e+01 3.88358418e-02]
mat_Sqrt:  [[ 1.96572796e+01  0.00000000e+00]
 [-7.88272458e-03  1.80615910e-02]]
grads:  [6.49060113e-03 7.63946138e+00]
Stock Position:  0.006490601131300773
Bond Position:  [6.23717008]


portfolio before change:  [6.88041965]
curr_Stock_Price:  98.86450742129828
curr_Factors:  [9.88645074e+01 3.88227762e-02]
mat_Sqrt:  [[ 1.94797645e+01  0.00000000e+00]
 [-7.88139848e-03  1.80585526e-02]]
grads:  [-0.01111922 -2.6409567 ]
Stock Position:  -0.01111922159636304
Bond Position:  [7.97971602]


portfolio before change:  [6.8716849]
curr_Stock_Price:  99.82949704396025
curr_Factors:  [9.98294970e+01 3.76187491e-02]
mat_Sqrt:  [[ 1.93624834e+01  0.00000000e+00]
 [-7.75822136e-03  1.77763183e-02]]
grads:  [0.0150361  0.25441385]
Stock Position:  0.015036103921467842
Bond Position:  [5.3706382]


portfolio before change:  [6.87661323]
curr_Stock_Price:  100.06795681756006
curr_Factors:  [1.00067957e+02 3.92201476e-02]
mat_Sqrt:  [[ 1.98175355e+01  0.00000000e+00]
 [-7.92163091e-03  1.81507366e-02]]
grads:  [7.26973407e-03 8.29474680e+00]
Stock Position:  0.007269734066035879
Bond Position:  [6.14914579]


portfolio before change:  [6.86962946]
curr_Stock_Price:  98.89580336350812
curr_Factors:  [9.88958034e+01 4.19258830e-02]
mat_Sqrt:  [[ 2.02497176e+01  0.00000000e+00]
 [-8.19032434e-03  1.87663906e-02]]
grads:  [-0.01041004  3.07726236]
Stock Position:  -0.01041004446498444
Bond Position:  [7.89913917]


portfolio before change:  [6.86171306]
curr_Stock_Price:  99.84598483109278
curr_Factors:  [9.98459848e+01 4.13800901e-02]
mat_Sqrt:  [[ 2.03107669e+01  0.00000000e+00]
 [-8.13683871e-03  1.86438396e-02]]
grads:  [-8.05971659e-04  1.99502401e+00]
Stock Position:  -0.0008059716586276954
Bond Position:  [6.9421861]


portfolio before change:  [6.86392266]
curr_Stock_Price:  99.25808666632038
curr_Factors:  [9.92580867e+01 4.03090635e-02]
mat_Sqrt:  [[ 1.99281624e+01  0.00000000e+00]
 [-8.03084688e-03  1.84009819e-02]]
grads:  [ -0.01555276 -14.30504292]
Stock Position:  -0.015552763796645764
Bond Position:  [8.40766023]


portfolio before change:  [6.87466284]
curr_Stock_Price:  98.70268693030972
curr_Factors:  [9.87026869e+01 4.13479051e-02]
mat_Sqrt:  [[ 2.00703863e+01  0.00000000e+00]
 [-8.13367372e-03  1.86365878e-02]]
grads:  [-0.00764256 -6.68157871]
Stock Position:  -0.007642564827851627
Bond Position:  [7.62900452]


portfolio before change:  [6.87401235]
curr_Stock_Price:  99.03738782793651
curr_Factors:  [9.90373878e+01 4.35003618e-02]
mat_Sqrt:  [[ 2.06559708e+01  0.00000000e+00]
 [-8.34269614e-03  1.91155183e-02]]
grads:  [0.00553828 2.868234  ]
Stock Position:  0.005538283295076596
Bond Position:  [6.32551524]


portfolio before change:  [6.86702138]
curr_Stock_Price:  97.48951746666788
curr_Factors:  [9.74895175e+01 4.28173287e-02]
mat_Sqrt:  [[ 2.01728707e+01  0.00000000e+00]
 [-8.27693941e-03  1.89648507e-02]]
grads:  [ 1.23456106e-04 -3.80855443e+00]
Stock Position:  0.00012345610563583816
Bond Position:  [6.85498571]


portfolio before change:  [6.86873906]
curr_Stock_Price:  97.51959935495634
curr_Factors:  [9.75195994e+01 4.19688886e-02]
mat_Sqrt:  [[ 1.99781672e+01  0.00000000e+00]
 [-8.19452389e-03  1.87760130e-02]]
grads:  [  0.02761354 -17.93262305]
Stock Position:  0.027613537491051936
Bond Position:  [4.17587795]


portfolio before change:  [6.86899371]
curr_Stock_Price:  97.4910100545632
curr_Factors:  [9.74910101e+01 4.35165511e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.86899371]
Stock Price:  97.49832845544171
PL:  [6.86899371]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 4.70809701e-03  2.38107876e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.89144642e-01 -7.51116456e-01]
 [-3.74381283e-02  2.75707550e-01]
 [-4.15085358e-01 -6.61590987e-02]
 [-4.27717390e-02  1.15052600e-01]
 [-3.86603335e-01  1.52050916e-01]
 [ 1.46967197e-02  1.65854342e-01]
 [-2.02667240e-01 -2.08786159e-02]
 [ 2.44830793e-01  5.42632568e-03]
 [ 3.44372084e-02  1.12014512e-01]
 [-2.36206300e-01  6.16878985e-02]
 [-1.17577646e-01  3.09669710e-02]
 [-1.07672246e-01 -2.24467131e-01]
 [-1.65965723e-01 -1.43999804e-01]
 [ 8.80284475e-02  3.53231491e-02]
 [ 4.68447849e-02 -7.06833987e-02]
 [ 1.04550967e+00 -4.80910980e-01]
 [ 1.84318043e-01  2.20035132e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.48500423]
curr_Stock_Price:  101.43294375052123
curr_Factors:  [1.01432944e+02 3.71745937e-02]
mat_Sqrt:  [[ 1.95569959e+01  0.00000000e+00]
 [-7.71228565e-03  1.76710664e-02]]
grads:  [5.55437524e-03 1.34744486e+01]
Stock Position:  0.005554375236703578
Bond Position:  [11.9216076]


portfolio before change:  [12.47743014]
curr_Stock_Price:  99.53266443806062
curr_Factors:  [9.95326644e+01 4.00083225e-02]
mat_Sqrt:  [[ 1.99086037e+01  0.00000000e+00]
 [-8.00083220e-03  1.83322096e-02]]
grads:  [-0.00935901 -3.63578486]
Stock Position:  -0.0093590124781254
Bond Position:  [13.40895759]


portfolio before change:  [12.48358978]
curr_Stock_Price:  99.23274125742012
curr_Factors:  [9.92327413e+01 4.14234789e-02]
mat_Sqrt:  [[ 2.01966004e+01  0.00000000e+00]
 [-8.14110350e-03  1.86536115e-02]]
grads:  [-2.55963245e-02 -4.02665433e+01]
Stock Position:  -0.025596324497860527
Bond Position:  [15.02358323]


portfolio before change:  [12.51016045]
curr_Stock_Price:  98.3414295361403
curr_Factors:  [9.83414295e+01 4.07242007e-02]
mat_Sqrt:  [[ 1.98455346e+01  0.00000000e+00]
 [-8.07209522e-03  1.84954937e-02]]
grads:  [4.17678401e-03 1.49067419e+01]
Stock Position:  0.004176784005905069
Bond Position:  [12.09940954]


portfolio before change:  [12.50891252]
curr_Stock_Price:  97.31835587345586
curr_Factors:  [9.73183559e+01 4.07328798e-02]
mat_Sqrt:  [[ 1.96411685e+01  0.00000000e+00]
 [-8.07295532e-03  1.84974644e-02]]
grads:  [-0.02260352 -3.57665771]
Stock Position:  -0.022603520570879394
Bond Position:  [14.70864998]


portfolio before change:  [12.52446866]
curr_Stock_Price:  96.79283960075263
curr_Factors:  [9.67928396e+01 4.02866883e-02]
mat_Sqrt:  [[ 1.94278175e+01  0.00000000e+00]
 [-8.02861765e-03  1.83958740e-02]]
grads:  [3.83024616e-04 6.25426113e+00]
Stock Position:  0.0003830246163553052
Bond Position:  [12.48739462]


portfolio before change:  [12.52815639]
curr_Stock_Price:  98.26920931970716
curr_Factors:  [9.82692093e+01 3.87087405e-02]
mat_Sqrt:  [[ 1.93340119e+01  0.00000000e+00]
 [-7.86981479e-03  1.80320110e-02]]
grads:  [-0.01656371  8.43227727]
Stock Position:  -0.01656370523587709
Bond Position:  [14.1558586]


portfolio before change:  [12.53737353]
curr_Stock_Price:  97.92642738564669
curr_Factors:  [9.79264274e+01 3.76441370e-02]
mat_Sqrt:  [[ 1.89997805e+01  0.00000000e+00]
 [-7.76083882e-03  1.77823157e-02]]
grads:  [4.58328921e-03 9.32692598e+00]
Stock Position:  0.004583289211322217
Bond Position:  [12.0885484]


portfolio before change:  [12.54147998]
curr_Stock_Price:  98.16292472409609
curr_Factors:  [9.81629247e+01 3.68612461e-02]
mat_Sqrt:  [[ 1.88465776e+01  0.00000000e+00]
 [-7.67971313e-03  1.75964334e-02]]
grads:  [-0.01123702 -1.18652544]
Stock Position:  -0.011237022443434991
Bond Position:  [13.64453897]


portfolio before change:  [12.54030334]
curr_Stock_Price:  98.57123637471439
curr_Factors:  [9.85712364e+01 3.66801180e-02]
mat_Sqrt:  [[ 1.88784166e+01  0.00000000e+00]
 [-7.66082168e-03  1.75531476e-02]]
grads:  [0.01309427 0.3091369 ]
Stock Position:  0.013094267403870609
Bond Position:  [11.24958521]


portfolio before change:  [12.55202078]
curr_Stock_Price:  99.25128160341548
curr_Factors:  [9.92512816e+01 3.82299126e-02]
mat_Sqrt:  [[ 1.94060782e+01  0.00000000e+00]
 [-7.82098844e-03  1.79201358e-02]]
grads:  [4.29372431e-03 6.25076247e+00]
Stock Position:  0.004293724306594992
Bond Position:  [12.12586314]


portfolio before change:  [12.55186258]
curr_Stock_Price:  98.50832543729038
curr_Factors:  [9.85083254e+01 3.76631095e-02]
mat_Sqrt:  [[ 1.91174967e+01  0.00000000e+00]
 [-7.76279429e-03  1.77867962e-02]]
grads:  [-0.01094722  3.46818492]
Stock Position:  -0.010947222715678414
Bond Position:  [13.63025515]


portfolio before change:  [12.5681531]
curr_Stock_Price:  97.33153969938647
curr_Factors:  [9.73315397e+01 3.94447102e-02]
mat_Sqrt:  [[ 1.93307177e+01  0.00000000e+00]
 [-7.94427696e-03  1.82026252e-02]]
grads:  [-0.00538327  1.70123653]
Stock Position:  -0.005383274093027072
Bond Position:  [13.09211546]


portfolio before change:  [12.57013148]
curr_Stock_Price:  97.57211121921435
curr_Factors:  [9.75721112e+01 3.98535188e-02]
mat_Sqrt:  [[ 1.94786583e+01  0.00000000e+00]
 [-7.98533845e-03  1.82967089e-02]]
grads:  [-1.05570790e-02 -1.22681697e+01]
Stock Position:  -0.010557078970652065
Bond Position:  [13.60020796]


portfolio before change:  [12.58608017]
curr_Stock_Price:  96.38350429316293
curr_Factors:  [9.63835043e+01 3.88578090e-02]
mat_Sqrt:  [[ 1.89994866e+01  0.00000000e+00]
 [-7.88495367e-03  1.80666985e-02]]
grads:  [-0.01204308 -7.97045481]
Stock Position:  -0.012043082729693616
Bond Position:  [13.74683469]


portfolio before change:  [12.60866519]
curr_Stock_Price:  94.79355595544719
curr_Factors:  [9.47935560e+01 4.03093002e-02]
mat_Sqrt:  [[ 1.90318692e+01  0.00000000e+00]
 [-8.03087046e-03  1.84010359e-02]]
grads:  [0.00543534 1.91962829]
Stock Position:  0.005435342821497288
Bond Position:  [12.09342971]


portfolio before change:  [12.60274479]
curr_Stock_Price:  93.14800512969393
curr_Factors:  [9.31480051e+01 4.36632119e-02]
mat_Sqrt:  [[ 1.94639687e+01  0.00000000e+00]
 [-8.35829761e-03  1.91512657e-02]]
grads:  [ 8.21827286e-04 -3.69079515e+00]
Stock Position:  0.0008218272861126038
Bond Position:  [12.52619322]


portfolio before change:  [12.60643989]
curr_Stock_Price:  93.83325187174785
curr_Factors:  [9.38332519e+01 4.54896175e-02]
mat_Sqrt:  [[ 2.00130329e+01  0.00000000e+00]
 [-8.53131807e-03  1.95477054e-02]]
grads:  [  0.04175394 -24.60191463]
Stock Position:  0.041753936972913144
Bond Position:  [8.6885322]


portfolio before change:  [12.51099068]
curr_Stock_Price:  91.49523022875425
curr_Factors:  [9.14952302e+01 4.49133106e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.51099068]
Stock Price:  89.42669826227853
PL:  [12.51099068]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.97274729e-01 -8.06586883e-01]
 [-2.05262378e-02  2.77479794e-01]
 [-4.11133599e-01 -7.35658478e-02]
 [-3.09918479e-02  9.22605480e-02]
 [-3.96758697e-01  1.56085012e-01]
 [ 3.60080012e-02  1.38955858e-01]
 [-2.05455547e-01 -1.00147508e-02]
 [ 2.75723604e-01  4.65120112e-03]
 [ 1.33397415e-01  1.98247629e-01]
 [-2.38769306e-01  1.11648480e-01]
 [-1.18205691e-02  3.87180958e-02]
 [-2.47900450e-01 -2.73686456e-01]
 [-4.95409052e-02 -1.02840837e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.21492803e-02  4.95368484e-02]
 [ 3.54315832e-01 -2.22964474e-01]
 [ 1.50917557e-01  4.64604842e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.96391472]
curr_Stock_Price:  98.46471588683066
curr_Factors:  [9.84647159e+01 4.08097039e-02]
mat_Sqrt:  [[ 1.98912627e+01  0.00000000e+00]
 [-8.08056472e-03  1.85148997e-02]]
grads:  [ 0.0014012  -0.07295931]
Stock Position:  0.0014011969970322618
Bond Position:  [-8.10188319]


portfolio before change:  [-7.96710903]
curr_Stock_Price:  97.63072840596985
curr_Factors:  [9.76307284e+01 4.14054267e-02]
mat_Sqrt:  [[ 1.98662164e+01  0.00000000e+00]
 [-8.13932937e-03  1.86495465e-02]]
grads:  [-0.00937898 -3.57391909]
Stock Position:  -0.009378981208745888
Bond Position:  [-7.05143226]


portfolio before change:  [-7.97996144]
curr_Stock_Price:  98.8130891317094
curr_Factors:  [9.88130891e+01 4.22210631e-02]
mat_Sqrt:  [[ 2.03038810e+01  0.00000000e+00]
 [-8.21910585e-03  1.88323374e-02]]
grads:  [-2.70538477e-02 -4.28298871e+01]
Stock Position:  -0.0270538477467619
Bond Position:  [-5.30668718]


portfolio before change:  [-7.91992777]
curr_Stock_Price:  96.54500089805205
curr_Factors:  [9.65450009e+01 4.26346257e-02]
mat_Sqrt:  [[ 1.99347603e+01  0.00000000e+00]
 [-8.25926154e-03  1.89243456e-02]]
grads:  [5.04525116e-03 1.46625833e+01]
Stock Position:  0.005045251161774489
Bond Position:  [-8.40702155]


portfolio before change:  [-7.91569789]
curr_Stock_Price:  97.80002196026386
curr_Factors:  [9.78000220e+01 4.30607901e-02]
mat_Sqrt:  [[ 2.02945745e+01  0.00000000e+00]
 [-8.30043759e-03  1.90186918e-02]]
grads:  [-0.02184034 -3.86808139]
Stock Position:  -0.021840338070923147
Bond Position:  [-5.77971235]


portfolio before change:  [-7.90943783]
curr_Stock_Price:  97.44722646765979
curr_Factors:  [9.74472265e+01 4.28226939e-02]
mat_Sqrt:  [[ 2.01653830e+01  0.00000000e+00]
 [-8.27745796e-03  1.89660388e-02]]
grads:  [4.5989488e-04 4.8645133e+00]
Stock Position:  0.0004598948802158316
Bond Position:  [-7.95425331]


portfolio before change:  [-7.9110153]
curr_Stock_Price:  98.34164260770818
curr_Factors:  [9.83416426e+01 4.14287691e-02]
mat_Sqrt:  [[ 2.00165153e+01  0.00000000e+00]
 [-8.14162334e-03  1.86548026e-02]]
grads:  [-0.01641832  8.36701491]
Stock Position:  -0.016418322988638795
Bond Position:  [-6.29641045]


portfolio before change:  [-7.92099333]
curr_Stock_Price:  98.85349343858739
curr_Factors:  [9.88534934e+01 4.10348258e-02]
mat_Sqrt:  [[ 2.00248061e+01  0.00000000e+00]
 [-8.10282181e-03  1.85658972e-02]]
grads:  [4.82667893e-03 7.48446773e+00]
Stock Position:  0.0048266789279976935
Bond Position:  [-8.39812741]


portfolio before change:  [-7.92806776]
curr_Stock_Price:  97.82283950569946
curr_Factors:  [9.78228395e+01 4.02385114e-02]
mat_Sqrt:  [[ 1.96228109e+01  0.00000000e+00]
 [-8.02381569e-03  1.83848714e-02]]
grads:  [-0.01069298 -0.54472781]
Stock Position:  -0.0106929809304085
Bond Position:  [-6.88205]


portfolio before change:  [-7.94786339]
curr_Stock_Price:  99.51319096748088
curr_Factors:  [9.95131910e+01 4.12013576e-02]
mat_Sqrt:  [[ 2.01993045e+01  0.00000000e+00]
 [-8.11924702e-03  1.86035320e-02]]
grads:  [0.01375065 0.2500171 ]
Stock Position:  0.013750649460605734
Bond Position:  [-9.31623439]


portfolio before change:  [-7.91930522]
curr_Stock_Price:  101.75944927266455
curr_Factors:  [1.01759449e+02 3.86436654e-02]
mat_Sqrt:  [[ 2.00038645e+01  0.00000000e+00]
 [-7.86319684e-03  1.80168474e-02]]
grads:  [1.09938644e-02 1.10034583e+01]
Stock Position:  0.010993864383685735
Bond Position:  [-9.03803481]


portfolio before change:  [-7.9101627]
curr_Stock_Price:  102.79660175143327
curr_Factors:  [1.02796602e+02 3.90264356e-02]
mat_Sqrt:  [[ 2.03075814e+01  0.00000000e+00]
 [-7.90204384e-03  1.81058570e-02]]
grads:  [-0.00935818  6.1664289 ]
Stock Position:  -0.009358175720331952
Bond Position:  [-6.94817404]


portfolio before change:  [-7.89108607]
curr_Stock_Price:  100.57246231664536
curr_Factors:  [1.00572462e+02 3.83503972e-02]
mat_Sqrt:  [[ 1.96953642e+01  0.00000000e+00]
 [-7.83330298e-03  1.79483519e-02]]
grads:  [2.57796363e-04 2.15719504e+00]
Stock Position:  0.0002577963629528042
Bond Position:  [-7.91701329]


portfolio before change:  [-7.89296887]
curr_Stock_Price:  100.94758837173559
curr_Factors:  [1.00947588e+02 3.74158989e-02]
mat_Sqrt:  [[ 1.95264835e+01  0.00000000e+00]
 [-7.73727589e-03  1.77283262e-02]]
grads:  [ -0.01881276 -15.43780573]
Stock Position:  -0.01881275814930944
Bond Position:  [-5.9938663]


portfolio before change:  [-7.88166858]
curr_Stock_Price:  100.26725537762752
curr_Factors:  [1.00267255e+02 3.72166073e-02]
mat_Sqrt:  [[ 1.93431642e+01  0.00000000e+00]
 [-7.71664252e-03  1.76810492e-02]]
grads:  [-4.88153465e-03 -5.81644423e+00]
Stock Position:  -0.004881534650002055
Bond Position:  [-7.3922105]


portfolio before change:  [-7.89578895]
curr_Stock_Price:  102.78123683004027
curr_Factors:  [1.02781237e+02 3.56577453e-02]
mat_Sqrt:  [[ 1.94084467e+01  0.00000000e+00]
 [-7.55330341e-03  1.73067923e-02]]
grads:  [0.00494609 1.01295812]
Stock Position:  0.004946090320427825
Bond Position:  [-8.40415424]


portfolio before change:  [-7.89576892]
curr_Stock_Price:  103.21012926183245
curr_Factors:  [1.03210129e+02 3.56024505e-02]
mat_Sqrt:  [[ 1.94743184e+01  0.00000000e+00]
 [-7.54744465e-03  1.72933682e-02]]
grads:  [-1.56768656e-03  2.86449972e+00]
Stock Position:  -0.0015676865555151699
Bond Position:  [-7.73396778]


portfolio before change:  [-7.89654993]
curr_Stock_Price:  102.47483101532823
curr_Factors:  [1.02474831e+02 3.73044551e-02]
mat_Sqrt:  [[ 1.97923591e+01  0.00000000e+00]
 [-7.72574450e-03  1.77019045e-02]]
grads:  [  0.01298512 -12.59550766]
Stock Position:  0.012985120013936771
Bond Position:  [-9.22719791]


portfolio before change:  [-7.88745685]
curr_Stock_Price:  103.35277199013768
curr_Factors:  [1.03352772e+02 3.74654598e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.88745685]
Stock Price:  104.62818544426737
PL:  [-12.51564229]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.96236508e-01 -7.99503251e-01]
 [-3.66025787e-02  2.75795109e-01]
 [-4.18728240e-01 -6.04371357e-02]
 [ 1.13263604e-03  4.85126293e-02]
 [-3.46506108e-01  1.32891640e-01]
 [ 2.22505218e-02  1.56320151e-01]
 [-2.28693192e-01  8.05242966e-02]
 [ 1.26755235e-01  1.28251899e-02]
 [-1.05320686e-01 -4.86708413e-02]
 [-1.76090282e-01  4.49546041e-02]
 [ 3.73689253e-02  3.60302409e-04]
 [-1.37874633e-02 -1.58551085e-01]
 [-2.26791364e-01 -1.30528334e-01]
 [ 8.79778599e-02  3.73145029e-02]
 [ 6.37204884e-02 -8.21132827e-02]
 [ 1.26193255e+00 -5.70697164e-01]
 [ 1.42675695e-01  1.88321919e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.05967219]
curr_Stock_Price:  98.4508163757876
curr_Factors:  [9.84508164e+01 4.02927866e-02]
mat_Sqrt:  [[ 1.97620946e+01  0.00000000e+00]
 [-8.02922528e-03  1.83972663e-02]]
grads:  [ 0.00141036 -0.07342581]
Stock Position:  0.0014103554406229134
Bond Position:  [-8.19852283]


portfolio before change:  [-8.06257772]
curr_Stock_Price:  97.8441298120124
curr_Factors:  [9.78441298e+01 4.18574404e-02]
mat_Sqrt:  [[ 2.00180195e+01  0.00000000e+00]
 [-8.18363639e-03  1.87510666e-02]]
grads:  [-0.00930786 -3.55456954]
Stock Position:  -0.009307857346627202
Bond Position:  [-7.15185851]


portfolio before change:  [-8.07391477]
curr_Stock_Price:  98.87002320239388
curr_Factors:  [9.88700232e+01 4.27684253e-02]
mat_Sqrt:  [[ 2.04468432e+01  0.00000000e+00]
 [-8.27221134e-03  1.89540173e-02]]
grads:  [-2.66627141e-02 -4.21812029e+01]
Stock Position:  -0.026662714079087095
Bond Position:  [-5.43777162]


portfolio before change:  [-8.05882932]
curr_Stock_Price:  98.25324157794188
curr_Factors:  [9.82532416e+01 4.03576248e-02]
mat_Sqrt:  [[ 1.97382973e+01  0.00000000e+00]
 [-8.03568290e-03  1.84120626e-02]]
grads:  [4.24374371e-03 1.49790448e+01]
Stock Position:  0.0042437437101151615
Bond Position:  [-8.47579089]


portfolio before change:  [-8.06654793]
curr_Stock_Price:  96.93379215627753
curr_Factors:  [9.69337922e+01 4.00659099e-02]
mat_Sqrt:  [[ 1.94027241e+01  0.00000000e+00]
 [-8.00658828e-03  1.83453984e-02]]
grads:  [-0.02294034 -3.294403  ]
Stock Position:  -0.02294034416394074
Bond Position:  [-5.84285338]


portfolio before change:  [-8.08806752]
curr_Stock_Price:  97.80817707233352
curr_Factors:  [9.78081771e+01 4.05974964e-02]
mat_Sqrt:  [[ 1.97071940e+01  0.00000000e+00]
 [-8.05952817e-03  1.84666990e-02]]
grads:  [1.13183456e-03 2.62703309e+00]
Stock Position:  0.0011318345625926079
Bond Position:  [-8.1987702]


portfolio before change:  [-8.09060722]
curr_Stock_Price:  97.37547095497307
curr_Factors:  [9.73754710e+01 4.13410972e-02]
mat_Sqrt:  [[ 1.97988776e+01  0.00000000e+00]
 [-8.13300409e-03  1.86350534e-02]]
grads:  [-0.01457191  7.13127229]
Stock Position:  -0.014571908916609373
Bond Position:  [-6.67166073]


portfolio before change:  [-8.08105575]
curr_Stock_Price:  96.60552433566586
curr_Factors:  [9.66055243e+01 3.99833945e-02]
mat_Sqrt:  [[ 1.93170940e+01  0.00000000e+00]
 [-7.99833928e-03  1.83264976e-02]]
grads:  [4.68363559e-03 8.52973409e+00]
Stock Position:  0.004683635589792114
Bond Position:  [-8.53352082]


portfolio before change:  [-8.08912222]
curr_Stock_Price:  95.33881149308908
curr_Factors:  [9.53388115e+01 4.22111861e-02]
mat_Sqrt:  [[ 1.95877031e+01  0.00000000e+00]
 [-8.21814443e-03  1.88301345e-02]]
grads:  [-0.00988117  4.27635271]
Stock Position:  -0.00988117427537273
Bond Position:  [-7.14706281]


portfolio before change:  [-8.08079445]
curr_Stock_Price:  94.31517176282505
curr_Factors:  [9.43151718e+01 4.21968873e-02]
mat_Sqrt:  [[ 1.93741103e+01  0.00000000e+00]
 [-8.21675238e-03  1.88269449e-02]]
grads:  [0.00683142 0.68121461]
Stock Position:  0.0068314159899315165
Bond Position:  [-8.72510062]


portfolio before change:  [-8.07219548]
curr_Stock_Price:  95.89325146605088
curr_Factors:  [9.58932515e+01 4.21966833e-02]
mat_Sqrt:  [[ 1.96982299e+01  0.00000000e+00]
 [-8.21673252e-03  1.88268994e-02]]
grads:  [-0.00642506 -2.58517563]
Stock Position:  -0.006425063738462362
Bond Position:  [-7.45607522]


portfolio before change:  [-8.07439795]
curr_Stock_Price:  95.9458918564267
curr_Factors:  [9.59458919e+01 4.15830528e-02]
mat_Sqrt:  [[ 1.95652125e+01  0.00000000e+00]
 [-8.15676925e-03  1.86895062e-02]]
grads:  [-0.00799738  2.40533931]
Stock Position:  -0.007997382332753426
Bond Position:  [-7.30708197]


portfolio before change:  [-8.0667586]
curr_Stock_Price:  94.76221177385607
curr_Factors:  [9.47622118e+01 4.25095730e-02]
mat_Sqrt:  [[ 1.95379305e+01  0.00000000e+00]
 [-8.24713992e-03  1.88965715e-02]]
grads:  [0.00192068 0.01906708]
Stock Position:  0.0019206831633799921
Bond Position:  [-8.24876679]


portfolio before change:  [-8.06899004]
curr_Stock_Price:  94.67422849425782
curr_Factors:  [9.46742285e+01 4.25464200e-02]
mat_Sqrt:  [[ 1.95282482e+01  0.00000000e+00]
 [-8.25071342e-03  1.89047594e-02]]
grads:  [-4.24947640e-03 -8.38683432e+00]
Stock Position:  -0.004249476399767221
Bond Position:  [-7.66667414]


portfolio before change:  [-8.07253254]
curr_Stock_Price:  95.05676902897298
curr_Factors:  [9.5056769e+01 4.1633111e-02]
mat_Sqrt:  [[ 1.93955670e+01  0.00000000e+00]
 [-8.16167738e-03  1.87007522e-02]]
grads:  [-0.01463007 -6.97984404]
Stock Position:  -0.014630074958850896
Bond Position:  [-6.68184489]


portfolio before change:  [-8.07229293]
curr_Stock_Price:  94.92619628098555
curr_Factors:  [9.49261963e+01 4.25030646e-02]
mat_Sqrt:  [[ 1.95702422e+01  0.00000000e+00]
 [-8.24650856e-03  1.88951248e-02]]
grads:  [0.00532764 1.97482172]
Stock Position:  0.0053276419761933
Bond Position:  [-8.57802571]


portfolio before change:  [-8.07875958]
curr_Stock_Price:  94.11497904295705
curr_Factors:  [9.41149790e+01 4.30194336e-02]
mat_Sqrt:  [[ 1.95205070e+01  0.00000000e+00]
 [-8.29645067e-03  1.90095566e-02]]
grads:  [ 1.42841135e-03 -4.31957906e+00]
Stock Position:  0.0014284113476088866
Bond Position:  [-8.21319448]


portfolio before change:  [-8.08448481]
curr_Stock_Price:  91.54451433869528
curr_Factors:  [9.15445143e+01 4.14780039e-02]
mat_Sqrt:  [[ 1.86440925e+01  0.00000000e+00]
 [-8.14645973e-03  1.86658842e-02]]
grads:  [  0.05432605 -30.57434397]
Stock Position:  0.05432604912241518
Bond Position:  [-13.05773659]


portfolio before change:  [-7.99896189]
curr_Stock_Price:  93.17886406235827
curr_Factors:  [9.31788641e+01 3.95337896e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.99896189]
Stock Price:  94.98484249682599
PL:  [-7.99896189]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.89785076e-02  1.42402368e-01]
 [ 8.37353634e-02 -2.11018378e-02]
 [-1.28144191e-01 -3.34919064e-01]
 [ 3.26903948e-01 -2.52938507e-01]
 [-8.54807949e-02 -6.40731632e-02]
 [ 8.05985183e-01 -1.12336180e+00]
 [-6.59379158e-01  7.24948894e-01]
 [ 1.21510637e+00  2.28134687e-01]
 [ 5.03031017e-01 -2.32154507e-01]
 [-2.16487675e-01  3.57904734e-02]
 [ 4.58400621e-01  7.05960261e-01]
 [-1.62540055e-01  1.50447389e-01]
 [-2.23097888e-01  2.13785135e-01]
 [-1.50830070e-01  2.68184330e-01]
 [ 2.69901679e-01  3.95899352e-01]
 [ 4.22805089e-02  6.13888784e-02]
 [-5.42084025e-02  4.05417222e-01]
 [ 1.68523320e-01  1.83140755e-01]
 [-1.49696333e-02 -2.64935563e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.93003351]
curr_Stock_Price:  100.77177476432433
curr_Factors:  [1.00771775e+02 3.82462102e-02]
mat_Sqrt:  [[ 1.97075715e+01  0.00000000e+00]
 [-7.82265532e-03  1.79239551e-02]]
grads:  [1.60901664e-04 7.94480724e+00]
Stock Position:  0.00016090166368933523
Bond Position:  [7.91381916]


portfolio before change:  [7.9322665]
curr_Stock_Price:  102.352185524228
curr_Factors:  [1.02352186e+02 3.78001772e-02]
mat_Sqrt:  [[ 1.98995859e+01  0.00000000e+00]
 [-7.77690707e-03  1.78191327e-02]]
grads:  [ 0.00374509 -1.18422362]
Stock Position:  0.003745091320038714
Bond Position:  [7.54894822]


portfolio before change:  [7.93511338]
curr_Stock_Price:  102.60836235746724
curr_Factors:  [1.02608362e+02 3.84081724e-02]
mat_Sqrt:  [[ 2.01091900e+01  0.00000000e+00]
 [-7.83920122e-03  1.79618665e-02]]
grads:  [-1.36412682e-02 -1.86461170e+01]
Stock Position:  -0.013641268202650547
Bond Position:  [9.33482157]


portfolio before change:  [7.91140921]
curr_Stock_Price:  104.51714107001354
curr_Factors:  [1.04517141e+02 3.91235990e-02]
mat_Sqrt:  [[ 2.06731626e+01  0.00000000e+00]
 [-7.91187452e-03  1.81283819e-02]]
grads:  [ 1.04731210e-02 -1.39526245e+01]
Stock Position:  0.010473121006015015
Bond Position:  [6.81678855]


portfolio before change:  [7.92166271]
curr_Stock_Price:  105.33342917821298
curr_Factors:  [1.05333429e+02 3.97780923e-02]
mat_Sqrt:  [[ 2.10081688e+01  0.00000000e+00]
 [-7.97777837e-03  1.82793866e-02]]
grads:  [-0.00540002 -3.50521407]
Stock Position:  -0.005400024001220345
Bond Position:  [8.49046575]


portfolio before change:  [7.92281432]
curr_Stock_Price:  105.51329286595987
curr_Factors:  [1.05513293e+02 3.88775932e-02]
mat_Sqrt:  [[ 2.08044799e+01  0.00000000e+00]
 [-7.88696071e-03  1.80712972e-02]]
grads:  [ 1.51750922e-02 -6.21627646e+01]
Stock Position:  0.015175092238425869
Bond Position:  [6.32164037]


portfolio before change:  [7.95516913]
curr_Stock_Price:  107.54123429258757
curr_Factors:  [1.07541234e+02 3.82304300e-02]
mat_Sqrt:  [[ 2.10271110e+01  0.00000000e+00]
 [-7.82104136e-03  1.79202570e-02]]
grads:  [-1.63115856e-02  4.04541571e+01]
Stock Position:  -0.016311585588435484
Bond Position:  [9.70933717]


portfolio before change:  [7.8971775]
curr_Stock_Price:  111.24530459760425
curr_Factors:  [1.11245305e+02 3.83709182e-02]
mat_Sqrt:  [[ 2.17912822e+01  0.00000000e+00]
 [-7.83539846e-03  1.79531533e-02]]
grads:  [ 0.0603302  12.70722103]
Stock Position:  0.060330204152987704
Bond Position:  [1.18572557]


portfolio before change:  [7.90724333]
curr_Stock_Price:  111.40723598789332
curr_Factors:  [1.11407236e+02 4.25805349e-02]
mat_Sqrt:  [[ 2.29889405e+01  0.00000000e+00]
 [-8.25402058e-03  1.89123371e-02]]
grads:  [  0.01747408 -12.27529451]
Stock Position:  0.01747407556111207
Bond Position:  [5.96050487]


portfolio before change:  [7.88995741]
curr_Stock_Price:  110.33271668632187
curr_Factors:  [1.10332717e+02 3.97822298e-02]
mat_Sqrt:  [[ 2.20063934e+01  0.00000000e+00]
 [-7.97819326e-03  1.82803373e-02]]
grads:  [-0.00912769  1.95786723]
Stock Position:  -0.009127685223498282
Bond Position:  [8.89703972]


portfolio before change:  [7.87543503]
curr_Stock_Price:  112.16745559669019
curr_Factors:  [1.12167456e+02 3.88671726e-02]
mat_Sqrt:  [[ 2.21135437e+01  0.00000000e+00]
 [-7.88590364e-03  1.80688752e-02]]
grads:  [3.46623296e-02 3.90705151e+01]
Stock Position:  0.034662329583144844
Bond Position:  [3.98744971]


portfolio before change:  [7.90845799]
curr_Stock_Price:  113.09139756042026
curr_Factors:  [1.13091398e+02 3.89160806e-02]
mat_Sqrt:  [[ 2.23097199e+01  0.00000000e+00]
 [-7.89086364e-03  1.80802400e-02]]
grads:  [-4.34247637e-03  8.32109472e+00]
Stock Position:  -0.0043424763744818315
Bond Position:  [8.39955472]


portfolio before change:  [7.91584405]
curr_Stock_Price:  111.87414210454858
curr_Factors:  [1.11874142e+02 3.96701236e-02]
mat_Sqrt:  [[ 2.22823758e+01  0.00000000e+00]
 [-7.96694406e-03  1.82545621e-02]]
grads:  [-5.82498054e-03  1.17113264e+01]
Stock Position:  -0.005824980539203746
Bond Position:  [8.56750875]


portfolio before change:  [7.91671232]
curr_Stock_Price:  112.09283358859486
curr_Factors:  [1.12092834e+02 3.97241382e-02]
mat_Sqrt:  [[ 2.23411276e+01  0.00000000e+00]
 [-7.97236609e-03  1.82669855e-02]]
grads:  [-1.51222595e-03  1.46813676e+01]
Stock Position:  -0.0015122259477677947
Bond Position:  [8.08622201]


portfolio before change:  [7.92096714]
curr_Stock_Price:  110.6161955304016
curr_Factors:  [1.10616196e+02 4.03786825e-02]
mat_Sqrt:  [[ 2.22277135e+01  0.00000000e+00]
 [-8.03777904e-03  1.84168654e-02]]
grads:  [1.99159631e-02 2.14965654e+01]
Stock Position:  0.019915963134933677
Bond Position:  [5.71793907]


portfolio before change:  [7.9178925]
curr_Stock_Price:  110.39003015914939
curr_Factors:  [1.10390030e+02 3.97803959e-02]
mat_Sqrt:  [[ 2.20173174e+01  0.00000000e+00]
 [-7.97800936e-03  1.82799159e-02]]
grads:  [3.13720381e-03 3.35826919e+00]
Stock Position:  0.0031372038121044283
Bond Position:  [7.57157648]


portfolio before change:  [7.92491131]
curr_Stock_Price:  112.0238681969257
curr_Factors:  [1.12023868e+02 3.83511483e-02]
mat_Sqrt:  [[ 2.19381373e+01  0.00000000e+00]
 [-7.83337968e-03  1.79485277e-02]]
grads:  [5.59437556e-03 2.25877704e+01]
Stock Position:  0.005594375557655576
Bond Position:  [7.29820772]


portfolio before change:  [7.9238705]
curr_Stock_Price:  111.51163990213107
curr_Factors:  [1.11511640e+02 3.95557426e-02]
mat_Sqrt:  [[ 2.21781325e+01  0.00000000e+00]
 [-7.95545022e-03  1.82282264e-02]]
grads:  [ 0.01120259 10.04709677]
Stock Position:  0.011202588787091974
Bond Position:  [6.67465145]


portfolio before change:  [7.93400804]
curr_Stock_Price:  112.26759687283784
curr_Factors:  [1.12267597e+02 4.01443723e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.93400804]
Stock Price:  114.39542876805181
PL:  [-6.46142072]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.92829975e-01 -7.76260963e-01]
 [ 3.92045612e-02  2.09479112e-01]
 [-3.15781287e-01 -1.03167820e-01]
 [ 4.56121769e-01 -5.82004191e-01]
 [-6.04144837e-01  5.14129466e-01]
 [ 6.25944507e-01  1.81856539e-01]
 [ 1.94910442e-01 -1.59032641e-01]
 [-5.70435263e-02  2.72806509e-02]
 [ 3.16468295e-01  4.79367817e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-9.39525452e-02  1.18378263e-01]
 [-2.58817028e-01 -1.01687217e-01]
 [ 2.16269884e-01  1.97472196e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.29388151e-02  2.20010690e-01]
 [ 9.56333299e-02  9.52583174e-02]
 [-5.72215738e-02 -2.43123174e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.24265322]
curr_Stock_Price:  98.71456265665137
curr_Factors:  [9.87145627e+01 3.97844244e-02]
mat_Sqrt:  [[ 1.96896395e+01  0.00000000e+00]
 [-7.97841332e-03  1.82808415e-02]]
grads:  [ 0.00141555 -0.07389344]
Stock Position:  0.001415545345919358
Bond Position:  [-6.38238816]


portfolio before change:  [-6.24339729]
curr_Stock_Price:  99.31625906992032
curr_Factors:  [9.93162591e+01 4.02764562e-02]
mat_Sqrt:  [[ 1.99317751e+01  0.00000000e+00]
 [-8.02759802e-03  1.83935378e-02]]
grads:  [-0.00934813 -3.62366234]
Stock Position:  -0.009348132277004538
Bond Position:  [-5.31497576]


portfolio before change:  [-6.24200785]
curr_Stock_Price:  99.02546802977754
curr_Factors:  [9.90254680e+01 3.84755663e-02]
mat_Sqrt:  [[ 1.94240333e+01  0.00000000e+00]
 [-7.84607584e-03  1.79776182e-02]]
grads:  [-2.73690858e-02 -4.31792995e+01]
Stock Position:  -0.027369085801278947
Bond Position:  [-3.53177132]


portfolio before change:  [-6.26518934]
curr_Stock_Price:  99.84019885172575
curr_Factors:  [9.98401989e+01 3.81143210e-02]
mat_Sqrt:  [[ 1.94916916e+01  0.00000000e+00]
 [-7.80915575e-03  1.78930237e-02]]
grads:  [6.70176523e-03 1.17073065e+01]
Stock Position:  0.006701765225917185
Bond Position:  [-6.93429491]


portfolio before change:  [-6.26144061]
curr_Stock_Price:  100.65826903307602
curr_Factors:  [1.00658269e+02 3.71120125e-02]
mat_Sqrt:  [[ 1.93912904e+01  0.00000000e+00]
 [-7.70579133e-03  1.76561860e-02]]
grads:  [-0.01860667 -5.84315433]
Stock Position:  -0.018606673773737488
Bond Position:  [-4.38852504]


portfolio before change:  [-6.27901839]
curr_Stock_Price:  101.54399986531372
curr_Factors:  [1.01544000e+02 3.78935765e-02]
mat_Sqrt:  [[ 1.97668317e+01  0.00000000e+00]
 [-7.78650900e-03  1.78411334e-02]]
grads:  [ 1.02249222e-02 -3.26214808e+01]
Stock Position:  0.010224922169511584
Bond Position:  [-7.31729788]


portfolio before change:  [-6.25151524]
curr_Stock_Price:  104.41274584957826
curr_Factors:  [1.04412746e+02 3.77099024e-02]
mat_Sqrt:  [[ 2.02759505e+01  0.00000000e+00]
 [-7.76761507e-03  1.77978420e-02]]
grads:  [-1.87295951e-02  2.88871800e+01]
Stock Position:  -0.01872959511239518
Bond Position:  [-4.29590678]


portfolio before change:  [-6.26999755]
curr_Stock_Price:  105.34219487184723
curr_Factors:  [1.05342195e+02 3.74019455e-02]
mat_Sqrt:  [[ 2.03727408e+01  0.00000000e+00]
 [-7.73583304e-03  1.77250202e-02]]
grads:  [ 0.03462044 10.25987766]
Stock Position:  0.034620437926090826
Bond Position:  [-9.91699047]


portfolio before change:  [-6.2466149]
curr_Stock_Price:  106.08921629830488
curr_Factors:  [1.06089216e+02 3.81997586e-02]
mat_Sqrt:  [[ 2.07348812e+01  0.00000000e+00]
 [-7.81790341e-03  1.79130671e-02]]
grads:  [ 6.05274300e-03 -8.87802409e+00]
Stock Position:  0.006052743001539036
Bond Position:  [-6.88874566]


portfolio before change:  [-6.24167645]
curr_Stock_Price:  107.18968422612637
curr_Factors:  [1.07189684e+02 3.82797071e-02]
mat_Sqrt:  [[ 2.09718766e+01  0.00000000e+00]
 [-7.82608020e-03  1.79318025e-02]]
grads:  [-0.00215228  1.52135576]
Stock Position:  -0.0021522763504832764
Bond Position:  [-6.01097463]


portfolio before change:  [-6.24409594]
curr_Stock_Price:  107.61553946114056
curr_Factors:  [1.07615539e+02 3.72952693e-02]
mat_Sqrt:  [[ 2.07826949e+01  0.00000000e+00]
 [-7.72479326e-03  1.76997249e-02]]
grads:  [2.52941962e-02 2.70833484e+01]
Stock Position:  0.025294196234592666
Bond Position:  [-8.96614451]


portfolio before change:  [-6.23985351]
curr_Stock_Price:  107.87189266332179
curr_Factors:  [1.07871893e+02 3.49159627e-02]
mat_Sqrt:  [[ 2.01567407e+01  0.00000000e+00]
 [-7.47432540e-03  1.71258310e-02]]
grads:  [-0.00937691  6.67606285]
Stock Position:  -0.009376911017287336
Bond Position:  [-5.22834837]


portfolio before change:  [-6.23022562]
curr_Stock_Price:  106.70571504311225
curr_Factors:  [1.06705715e+02 3.48338975e-02]
mat_Sqrt:  [[ 1.99153854e+01  0.00000000e+00]
 [-7.46553655e-03  1.71056932e-02]]
grads:  [-2.12338526e-03  6.92040137e+00]
Stock Position:  -0.0021233852603860567
Bond Position:  [-6.00364827]


portfolio before change:  [-6.2316605]
curr_Stock_Price:  106.67453013689779
curr_Factors:  [1.06674530e+02 3.46109179e-02]
mat_Sqrt:  [[ 1.98457400e+01  0.00000000e+00]
 [-7.44160390e-03  1.70508566e-02]]
grads:  [-0.01527769 -5.96376001]
Stock Position:  -0.01527768515929136
Bond Position:  [-4.60192061]


portfolio before change:  [-6.23413786]
curr_Stock_Price:  106.76137188414286
curr_Factors:  [1.06761372e+02 3.46465354e-02]
mat_Sqrt:  [[ 1.98721132e+01  0.00000000e+00]
 [-7.44543193e-03  1.70596277e-02]]
grads:  [ 0.01522001 11.57541067]
Stock Position:  0.015220012741627641
Bond Position:  [-7.8590473]


portfolio before change:  [-6.25008651]
curr_Stock_Price:  105.84260550346893
curr_Factors:  [1.05842606e+02 3.28089113e-02]
mat_Sqrt:  [[ 1.91715149e+01  0.00000000e+00]
 [-7.24529213e-03  1.66010498e-02]]
grads:  [0.00500722 1.05602091]
Stock Position:  0.005007216726635982
Bond Position:  [-6.78006337]


portfolio before change:  [-6.24383022]
curr_Stock_Price:  107.43061532790875
curr_Factors:  [1.07430615e+02 3.35091029e-02]
mat_Sqrt:  [[ 1.96657025e+01  0.00000000e+00]
 [-7.32219671e-03  1.67772603e-02]]
grads:  [2.19070345e-03 1.31136244e+01]
Stock Position:  0.0021907034484898685
Bond Position:  [-6.47917884]


portfolio before change:  [-6.24461083]
curr_Stock_Price:  107.81377702299272
curr_Factors:  [1.07813777e+02 3.35145412e-02]
mat_Sqrt:  [[ 1.97374435e+01  0.00000000e+00]
 [-7.32279086e-03  1.67786217e-02]]
grads:  [0.00695163 5.67736249]
Stock Position:  0.006951633217085781
Bond Position:  [-6.99409266]


portfolio before change:  [-6.23653052]
curr_Stock_Price:  109.22769657991886
curr_Factors:  [1.09227697e+02 3.25455574e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.23653052]
Stock Price:  107.7030817320821
PL:  [-13.93961225]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-9.14648581e-02  9.35832687e-02]
 [ 3.31433305e-02 -1.81294790e-02]
 [-1.23088819e-01 -3.00426984e-01]
 [ 2.33819725e-01 -9.70673640e-02]
 [-2.38557228e-01 -9.37766798e-02]
 [ 5.74591438e-01 -7.65346674e-01]
 [-5.84583433e-01  4.30795821e-01]
 [ 2.09461996e-01  1.49142203e-01]
 [-1.58361076e-01 -3.85026582e-02]
 [ 2.70364408e-01  8.93882268e-03]
 [ 9.56156120e-02  1.64689424e-01]
 [-2.36111889e-01  5.98475599e-02]
 [-1.33602917e-02  3.86052467e-02]
 [-2.62065101e-01 -2.70716151e-01]
 [-9.77304753e-02 -1.23892075e-01]
 [ 9.06043073e-02  5.50509797e-02]
 [-1.14743141e-02 -4.97201639e-02]
 [ 4.91174897e-01 -2.62783984e-01]
 [ 2.27021913e-01  1.14336705e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.61571525]
curr_Stock_Price:  100.43584385513218
curr_Factors:  [1.00435844e+02 4.15221532e-02]
mat_Sqrt:  [[ 2.04657972e+01  0.00000000e+00]
 [-8.15079414e-03  1.86758156e-02]]
grads:  [-2.47348152e-03  5.01093344e+00]
Stock Position:  -0.0024734815215019753
Bond Position:  [5.86414145]


portfolio before change:  [5.61305888]
curr_Stock_Price:  102.10255701532657
curr_Factors:  [1.02102557e+02 3.95235181e-02]
mat_Sqrt:  [[ 2.02985220e+01  0.00000000e+00]
 [-7.95220906e-03  1.82208000e-02]]
grads:  [ 0.001243   -0.99498809]
Stock Position:  0.0012429957801246853
Bond Position:  [5.48614584]


portfolio before change:  [5.61541733]
curr_Stock_Price:  102.8963958986764
curr_Factors:  [1.02896396e+02 3.88100146e-02]
mat_Sqrt:  [[ 2.02708550e+01  0.00000000e+00]
 [-7.88010300e-03  1.80555842e-02]]
grads:  [-1.25404629e-02 -1.66390065e+01]
Stock Position:  -0.012540462896724218
Bond Position:  [6.90578577]


portfolio before change:  [5.6215318]
curr_Stock_Price:  102.54650394792759
curr_Factors:  [1.02546504e+02 4.10532055e-02]
mat_Sqrt:  [[ 2.07775528e+01  0.00000000e+00]
 [-8.10463625e-03  1.85700545e-02]]
grads:  [ 0.00921456 -5.22709095]
Stock Position:  0.009214562244908733
Bond Position:  [4.67661066]


portfolio before change:  [5.6120579]
curr_Stock_Price:  101.39146259000184
curr_Factors:  [1.01391463e+02 4.18043344e-02]
mat_Sqrt:  [[ 2.07306082e+01  0.00000000e+00]
 [-8.17844332e-03  1.87391678e-02]]
grads:  [-0.01348174 -5.00431401]
Stock Position:  -0.013481742731592304
Bond Position:  [6.97899151]


portfolio before change:  [5.59374066]
curr_Stock_Price:  102.879564570586
curr_Factors:  [1.02879565e+02 4.14913297e-02]
mat_Sqrt:  [[ 2.09559713e+01  0.00000000e+00]
 [-8.14776826e-03  1.86688824e-02]]
grads:  [ 1.14796285e-02 -4.09958485e+01]
Stock Position:  0.011479628495644899
Bond Position:  [4.41272148]


portfolio before change:  [5.59760489]
curr_Stock_Price:  103.12007004411919
curr_Factors:  [1.0312007e+02 4.1951023e-02]
mat_Sqrt:  [[ 2.11210000e+01  0.00000000e+00]
 [-8.19277956e-03  1.87720162e-02]]
grads:  [-1.87760391e-02  2.29488307e+01]
Stock Position:  -0.01877603910928714
Bond Position:  [7.53379136]


portfolio before change:  [5.63596826]
curr_Stock_Price:  101.17718495845232
curr_Factors:  [1.01177185e+02 4.26966082e-02]
mat_Sqrt:  [[ 2.09064012e+01  0.00000000e+00]
 [-8.26526304e-03  1.89380968e-02]]
grads:  [0.01313248 7.87524768]
Stock Position:  0.013132484500141263
Bond Position:  [4.30726044]


portfolio before change:  [5.64326865]
curr_Stock_Price:  101.65108202511665
curr_Factors:  [1.01651082e+02 4.19730097e-02]
mat_Sqrt:  [[ 2.08255779e+01  0.00000000e+00]
 [-8.19492621e-03  1.87769348e-02]]
grads:  [-0.00841105 -2.05052947]
Stock Position:  -0.008411051766639642
Bond Position:  [6.49826117]


portfolio before change:  [5.64515133]
curr_Stock_Price:  101.62041874831439
curr_Factors:  [1.01620419e+02 4.17351690e-02]
mat_Sqrt:  [[ 2.07602256e+01  0.00000000e+00]
 [-8.17167489e-03  1.87236594e-02]]
grads:  [0.01321111 0.47740789]
Stock Position:  0.013211110277554117
Bond Position:  [4.30263277]


portfolio before change:  [5.63012065]
curr_Stock_Price:  100.40125759672047
curr_Factors:  [1.00401258e+02 4.33347543e-02]
mat_Sqrt:  [[ 2.09005311e+01  0.00000000e+00]
 [-8.32680052e-03  1.90790968e-02]]
grads:  [8.01376618e-03 8.63192976e+00]
Stock Position:  0.00801376618019121
Bond Position:  [4.82552845]


portfolio before change:  [5.61763667]
curr_Stock_Price:  98.6928834606579
curr_Factors:  [9.86928835e+01 4.22203162e-02]
mat_Sqrt:  [[ 2.02790020e+01  0.00000000e+00]
 [-8.21903315e-03  1.88321708e-02]]
grads:  [-0.01035516  3.17794271]
Stock Position:  -0.010355158152856135
Bond Position:  [6.63961709]


portfolio before change:  [5.60058557]
curr_Stock_Price:  100.49982965376303
curr_Factors:  [1.00499830e+02 4.08867868e-02]
mat_Sqrt:  [[ 2.03215494e+01  0.00000000e+00]
 [-8.08819256e-03  1.85323773e-02]]
grads:  [1.71661089e-04 2.08312437e+00]
Stock Position:  0.00017166108853975003
Bond Position:  [5.58333366]


portfolio before change:  [5.60212457]
curr_Stock_Price:  101.33281358937704
curr_Factors:  [1.01332814e+02 3.96228671e-02]
mat_Sqrt:  [[ 2.01707966e+01  0.00000000e+00]
 [-7.96219739e-03  1.82436861e-02]]
grads:  [ -0.01884979 -14.83889543]
Stock Position:  -0.018849791746658653
Bond Position:  [7.512227]


portfolio before change:  [5.65202275]
curr_Stock_Price:  98.78531138628367
curr_Factors:  [9.87853114e+01 4.00157647e-02]
mat_Sqrt:  [[ 1.97609552e+01  0.00000000e+00]
 [-8.00157631e-03  1.83339146e-02]]
grads:  [-0.00768189 -6.75753528]
Stock Position:  -0.007681886228899738
Bond Position:  [6.41088027]


portfolio before change:  [5.65163702]
curr_Stock_Price:  99.04418692096638
curr_Factors:  [9.90441869e+01 3.86713214e-02]
mat_Sqrt:  [[ 1.94770643e+01  0.00000000e+00]
 [-7.86601005e-03  1.80232932e-02]]
grads:  [0.00588541 3.05443511]
Stock Position:  0.005885410811613644
Bond Position:  [5.06872129]


portfolio before change:  [5.65548857]
curr_Stock_Price:  99.48327490225647
curr_Factors:  [9.94832749e+01 3.82088867e-02]
mat_Sqrt:  [[ 1.94460888e+01  0.00000000e+00]
 [-7.81883743e-03  1.79152072e-02]]
grads:  [-1.70594575e-03 -2.77530499e+00]
Stock Position:  -0.0017059457518425673
Bond Position:  [5.82520164]


portfolio before change:  [5.65560766]
curr_Stock_Price:  100.26723234943162
curr_Factors:  [1.00267232e+02 3.94059318e-02]
mat_Sqrt:  [[ 1.99039755e+01  0.00000000e+00]
 [-7.94037096e-03  1.81936755e-02]]
grads:  [  0.01891514 -14.44369962]
Stock Position:  0.01891514409166461
Bond Position:  [3.75903852]


portfolio before change:  [5.66732742]
curr_Stock_Price:  100.83713980442383
curr_Factors:  [1.00837140e+02 3.82762041e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.66732742]
Stock Price:  98.43231004352904
PL:  [5.66732742]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.32279030e-01 -5.88224458e-02]
 [-1.57318289e-01 -5.33969779e-01]
 [ 1.90649111e-01 -2.47774248e-02]
 [-2.05711876e-01 -8.98839296e-02]
 [ 3.60342635e-01 -4.32616645e-01]
 [-4.07587514e-01  1.58520742e-01]
 [ 2.36793353e-02  1.54516744e-01]
 [-2.16322750e-01  3.23262980e-02]
 [ 1.31274833e-01  1.25419824e-02]
 [-7.43233165e-02  5.25833221e-03]
 [-2.36023152e-01  5.81178107e-02]
 [-7.10852714e-02  3.43744800e-02]
 [-1.40326265e-01 -2.39407868e-01]
 [-1.06286850e-01 -1.27996052e-01]
 [ 8.83465196e-02  6.08449596e-02]
 [ 5.25071299e-02 -8.13809697e-02]
 [ 9.27407410e-01 -4.31814231e-01]
 [ 1.80478680e-01  1.40906730e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.55625784]
curr_Stock_Price:  98.81419520474346
curr_Factors:  [9.88141952e+01 4.12243236e-02]
mat_Sqrt:  [[ 2.00630108e+01  0.00000000e+00]
 [-8.12150957e-03  1.86087162e-02]]
grads:  [ 0.0013892  -0.07259148]
Stock Position:  0.001389202143242991
Bond Position:  [-5.69353073]


portfolio before change:  [-5.55429729]
curr_Stock_Price:  101.25020199968168
curr_Factors:  [1.01250202e+02 3.94588420e-02]
mat_Sqrt:  [[ 2.01125930e+01  0.00000000e+00]
 [-7.94569992e-03  1.82058857e-02]]
grads:  [-0.00785335 -3.23095766]
Stock Position:  -0.007853350878947726
Bond Position:  [-4.75914393]


portfolio before change:  [-5.55327954]
curr_Stock_Price:  100.9690879228186
curr_Factors:  [1.00969088e+02 4.01529112e-02]
mat_Sqrt:  [[ 2.02323790e+01  0.00000000e+00]
 [-8.01527653e-03  1.83653057e-02]]
grads:  [-1.92939152e-02 -2.90749191e+01]
Stock Position:  -0.01929391521802488
Bond Position:  [-3.60519052]


portfolio before change:  [-5.56699721]
curr_Stock_Price:  101.63335231179163
curr_Factors:  [1.01633352e+02 3.87035534e-02]
mat_Sqrt:  [[ 1.99945517e+01  0.00000000e+00]
 [-7.86928748e-03  1.80308028e-02]]
grads:  [ 0.00899422 -1.37417203]
Stock Position:  0.00899421797896282
Bond Position:  [-6.48110974]


portfolio before change:  [-5.56798929]
curr_Stock_Price:  101.70321951072496
curr_Factors:  [1.01703220e+02 3.75681994e-02]
mat_Sqrt:  [[ 1.97126446e+01  0.00000000e+00]
 [-7.75300710e-03  1.77643709e-02]]
grads:  [-0.01242555 -5.0597868 ]
Stock Position:  -0.012425549425112325
Bond Position:  [-4.30427091]


portfolio before change:  [-5.55102979]
curr_Stock_Price:  100.25171795670477
curr_Factors:  [1.00251718e+02 3.84259556e-02]
mat_Sqrt:  [[ 1.96518826e+01  0.00000000e+00]
 [-7.84101581e-03  1.79660242e-02]]
grads:  [ 8.72859129e-03 -2.40797095e+01]
Stock Position:  0.008728591294109035
Bond Position:  [-6.42608606]


portfolio before change:  [-5.56790105]
curr_Stock_Price:  98.5029200246752
curr_Factors:  [9.85029200e+01 3.85007682e-02]
mat_Sqrt:  [[ 1.93278614e+01  0.00000000e+00]
 [-7.84864505e-03  1.79835050e-02]]
grads:  [-0.01750858  8.81478567]
Stock Position:  -0.017508579116777424
Bond Position:  [-3.84325489]


portfolio before change:  [-5.56711189]
curr_Stock_Price:  98.40296361976237
curr_Factors:  [9.84029636e+01 4.00944312e-02]
mat_Sqrt:  [[ 1.97038098e+01  0.00000000e+00]
 [-8.00943755e-03  1.83519269e-02]]
grads:  [4.62428190e-03 8.41964687e+00]
Stock Position:  0.004624281904307252
Bond Position:  [-6.02215494]


portfolio before change:  [-5.57664942]
curr_Stock_Price:  96.66608789062545
curr_Factors:  [9.66660879e+01 4.07936011e-02]
mat_Sqrt:  [[ 1.95240614e+01  0.00000000e+00]
 [-8.07897034e-03  1.85112466e-02]]
grads:  [-0.01035719  1.74630584]
Stock Position:  -0.010357189149509935
Bond Position:  [-4.57546047]


portfolio before change:  [-5.55474663]
curr_Stock_Price:  94.44088904862424
curr_Factors:  [9.44408890e+01 4.16520125e-02]
mat_Sqrt:  [[ 1.92742755e+01  0.00000000e+00]
 [-8.16352987e-03  1.87049968e-02]]
grads:  [0.00709488 0.67051508]
Stock Position:  0.007094876424843676
Bond Position:  [-6.22479306]


portfolio before change:  [-5.53572731]
curr_Stock_Price:  97.34096911513718
curr_Factors:  [9.73409691e+01 3.95157526e-02]
mat_Sqrt:  [[ 1.93499922e+01  0.00000000e+00]
 [-7.95142780e-03  1.82190099e-02]]
grads:  [-0.0037224   0.28861789]
Stock Position:  -0.003722399026034277
Bond Position:  [-5.17338538]


portfolio before change:  [-5.54365219]
curr_Stock_Price:  99.12244655647166
curr_Factors:  [9.91224466e+01 3.80252536e-02]
mat_Sqrt:  [[ 1.93289415e+01  0.00000000e+00]
 [-7.80002601e-03  1.78721048e-02]]
grads:  [-0.0108986   3.25187275]
Stock Position:  -0.010898602998697337
Bond Position:  [-4.46335599]


portfolio before change:  [-5.54021969]
curr_Stock_Price:  98.70510171750597
curr_Factors:  [9.87051017e+01 3.97911091e-02]
mat_Sqrt:  [[ 1.96894064e+01  0.00000000e+00]
 [-7.97908356e-03  1.82823772e-02]]
grads:  [-0.00284839  1.88019751]
Stock Position:  -0.002848385439512907
Bond Position:  [-5.25906952]


portfolio before change:  [-5.54011932]
curr_Stock_Price:  98.20822463466679
curr_Factors:  [9.82082246e+01 4.34016394e-02]
mat_Sqrt:  [[ 2.04597785e+01  0.00000000e+00]
 [-8.33322405e-03  1.90938150e-02]]
grads:  [-1.19655462e-02 -1.25385036e+01]
Stock Position:  -0.011965546205831946
Bond Position:  [-4.36500427]


portfolio before change:  [-5.54156244]
curr_Stock_Price:  98.23761970510922
curr_Factors:  [9.82376197e+01 4.43967014e-02]
mat_Sqrt:  [[ 2.06991820e+01  0.00000000e+00]
 [-8.42820991e-03  1.93114549e-02]]
grads:  [-0.00783359 -6.62798594]
Stock Position:  -0.007833590057555236
Bond Position:  [-4.7720092]


portfolio before change:  [-5.53106325]
curr_Stock_Price:  96.74502980358406
curr_Factors:  [9.67450298e+01 4.35361946e-02]
mat_Sqrt:  [[ 2.01861686e+01  0.00000000e+00]
 [-8.34613152e-03  1.91233897e-02]]
grads:  [0.00569209 3.18170369]
Stock Position:  0.005692087462963564
Bond Position:  [-6.08174442]


portfolio before change:  [-5.53295122]
curr_Stock_Price:  96.6804945310961
curr_Factors:  [9.66804945e+01 4.35474003e-02]
mat_Sqrt:  [[ 2.01752990e+01  0.00000000e+00]
 [-8.34720555e-03  1.91258506e-02]]
grads:  [ 8.42097201e-04 -4.25502485e+00]
Stock Position:  0.0008420972008515793
Bond Position:  [-5.61436559]


portfolio before change:  [-5.53569577]
curr_Stock_Price:  95.08830192743412
curr_Factors:  [9.50883019e+01 4.42886081e-02]
mat_Sqrt:  [[ 2.00111989e+01  0.00000000e+00]
 [-8.41794351e-03  1.92879317e-02]]
grads:  [  0.03692673 -22.38779349]
Stock Position:  0.03692673456813966
Bond Position:  [-9.04699625]


portfolio before change:  [-5.44966977]
curr_Stock_Price:  97.47919930778109
curr_Factors:  [9.74791993e+01 4.34799586e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.44966977]
Stock Price:  97.25979006765981
PL:  [-5.44966977]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.04394388e-01  7.41533243e-02]
 [-1.25876999e-01 -5.68139595e-02]
 [-1.65882060e-01 -5.92399170e-01]
 [ 1.45196847e-01  4.57790352e-02]
 [-3.27924401e-01 -1.04495513e-01]
 [ 3.19218676e-01 -3.68475249e-01]
 [-5.53846949e-01  3.53119241e-01]
 [ 2.69384198e-01  1.53849039e-01]
 [ 1.25743746e-01 -1.19946960e-01]
 [ 5.39173320e-02  2.12627988e-02]
 [ 2.24932167e-01  3.33232010e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.14281071e-01  1.33396079e-01]
 [-2.64512926e-01 -1.21196524e-01]
 [ 1.90238043e-01  1.17185678e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.26410378e-02  1.72912719e-01]
 [ 1.08601220e-01  7.33381226e-02]
 [-4.82063292e-03 -1.44167753e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.68974083]
curr_Stock_Price:  100.30143562124461
curr_Factors:  [1.00301436e+02 4.13722236e-02]
mat_Sqrt:  [[ 2.04014756e+01  0.00000000e+00]
 [-8.13606525e-03  1.86420674e-02]]
grads:  [-3.53068694e-03  3.97774145e+00]
Stock Position:  -0.003530686944005876
Bond Position:  [5.0438738]


portfolio before change:  [4.68736955]
curr_Stock_Price:  101.3302444617899
curr_Factors:  [1.01330244e+02 4.32453971e-02]
mat_Sqrt:  [[ 2.10721590e+01  0.00000000e+00]
 [-8.31821107e-03  1.90594159e-02]]
grads:  [-0.00715032 -2.9808867 ]
Stock Position:  -0.00715031826422574
Bond Position:  [5.41191305]


portfolio before change:  [4.6945532]
curr_Stock_Price:  100.51482590347338
curr_Factors:  [1.00514826e+02 4.54354880e-02]
mat_Sqrt:  [[ 2.14253400e+01  0.00000000e+00]
 [-8.52624072e-03  1.95360717e-02]]
grads:  [-1.98095457e-02 -3.03233515e+01]
Stock Position:  -0.019809545748795437
Bond Position:  [6.68570624]


portfolio before change:  [4.68511743]
curr_Stock_Price:  101.07553566731629
curr_Factors:  [1.01075536e+02 4.41644307e-02]
mat_Sqrt:  [[ 2.12413625e+01  0.00000000e+00]
 [-8.40613401e-03  1.92608727e-02]]
grads:  [0.00777617 2.37678925]
Stock Position:  0.007776170483440237
Bond Position:  [3.89913683]


portfolio before change:  [4.68195209]
curr_Stock_Price:  100.54310833349355
curr_Factors:  [1.00543108e+02 4.55200100e-02]
mat_Sqrt:  [[ 2.14512934e+01  0.00000000e+00]
 [-8.53416757e-03  1.95542344e-02]]
grads:  [-0.01741294 -5.34388158]
Stock Position:  -0.01741293522047153
Bond Position:  [6.43270272]


portfolio before change:  [4.6987965]
curr_Stock_Price:  99.66812460726044
curr_Factors:  [9.96681246e+01 4.55690328e-02]
mat_Sqrt:  [[ 2.12760593e+01  0.00000000e+00]
 [-8.53876176e-03  1.95647611e-02]]
grads:  [ 7.44512368e-03 -1.88336187e+01]
Stock Position:  0.007445123678174769
Bond Position:  [3.95675499]


portfolio before change:  [4.71666135]
curr_Stock_Price:  101.93478103169687
curr_Factors:  [1.01934781e+02 4.18077206e-02]
mat_Sqrt:  [[ 2.08425398e+01  0.00000000e+00]
 [-8.17877454e-03  1.87399267e-02]]
grads:  [-0.01917871 18.84314949]
Stock Position:  -0.019178712431728525
Bond Position:  [6.67163921]


portfolio before change:  [4.72134774]
curr_Stock_Price:  101.77740505945381
curr_Factors:  [1.01777405e+02 4.26666095e-02]
mat_Sqrt:  [[ 2.10230363e+01  0.00000000e+00]
 [-8.26235894e-03  1.89314426e-02]]
grads:  [0.01600765 8.12664107]
Stock Position:  0.01600765079299518
Bond Position:  [3.09213058]


portfolio before change:  [4.77262833]
curr_Stock_Price:  104.9326125403141
curr_Factors:  [1.04932613e+02 4.19417669e-02]
mat_Sqrt:  [[ 2.14898729e+01  0.00000000e+00]
 [-8.19187567e-03  1.87699452e-02]]
grads:  [ 3.41531106e-03 -6.39037349e+00]
Stock Position:  0.0034153110584061014
Bond Position:  [4.41425082]


portfolio before change:  [4.77491766]
curr_Stock_Price:  105.2797650540126
curr_Factors:  [1.05279765e+02 4.06838822e-02]
mat_Sqrt:  [[ 2.12351876e+01  0.00000000e+00]
 [-8.06809839e-03  1.84863358e-02]]
grads:  [0.00297606 1.15019001]
Stock Position:  0.0029760593378432977
Bond Position:  [4.46159884]


portfolio before change:  [4.77431554]
curr_Stock_Price:  104.70260490072067
curr_Factors:  [1.04702605e+02 4.01275099e-02]
mat_Sqrt:  [[ 2.09738710e+01  0.00000000e+00]
 [-8.01274084e-03  1.83594957e-02]]
grads:  [1.76584732e-02 1.81503901e+01]
Stock Position:  0.017658473233755315
Bond Position:  [2.92542739]


portfolio before change:  [4.74949147]
curr_Stock_Price:  103.25539506674627
curr_Factors:  [1.03255395e+02 3.94170137e-02]
mat_Sqrt:  [[ 2.05000354e+01  0.00000000e+00]
 [-7.94148738e-03  1.81962335e-02]]
grads:  [-0.00921988  6.28334011]
Stock Position:  -0.009219884743975762
Bond Position:  [5.70149431]


portfolio before change:  [4.71019587]
curr_Stock_Price:  107.67206122633428
curr_Factors:  [1.07672061e+02 3.43991517e-02]
mat_Sqrt:  [[ 1.99699461e+01  0.00000000e+00]
 [-7.41880332e-03  1.69986139e-02]]
grads:  [-2.80733100e-03  7.84746802e+00]
Stock Position:  -0.002807331002615667
Bond Position:  [5.01246699]


portfolio before change:  [4.71505087]
curr_Stock_Price:  106.38909037730569
curr_Factors:  [1.06389090e+02 3.22671955e-02]
mat_Sqrt:  [[ 1.91107489e+01  0.00000000e+00]
 [-7.18522879e-03  1.64634274e-02]]
grads:  [-0.01660884 -7.36156092]
Stock Position:  -0.016608842872963946
Bond Position:  [6.48205055]


portfolio before change:  [4.73731867]
curr_Stock_Price:  105.14595205783966
curr_Factors:  [1.05145952e+02 3.28601377e-02]
mat_Sqrt:  [[ 1.90601909e+01  0.00000000e+00]
 [-7.25094617e-03  1.66140048e-02]]
grads:  [0.0126642  7.05342747]
Stock Position:  0.012664199759852264
Bond Position:  [3.40572933]


portfolio before change:  [4.74198808]
curr_Stock_Price:  105.44742151029078
curr_Factors:  [1.05447422e+02 3.24959310e-02]
mat_Sqrt:  [[ 1.90086142e+01  0.00000000e+00]
 [-7.21065112e-03  1.65216773e-02]]
grads:  [0.00505013 1.06109419]
Stock Position:  0.005050127760429539
Bond Position:  [4.20946513]


portfolio before change:  [4.74716439]
curr_Stock_Price:  106.26399728044332
curr_Factors:  [1.06263997e+02 3.27075522e-02]
mat_Sqrt:  [[ 1.92180877e+01  0.00000000e+00]
 [-7.23409176e-03  1.65753865e-02]]
grads:  [1.18764468e-03 1.04318966e+01]
Stock Position:  0.0011876446830075898
Bond Position:  [4.62096052]


portfolio before change:  [4.74982949]
curr_Stock_Price:  107.53517840673936
curr_Factors:  [1.07535178e+02 3.18232800e-02]
mat_Sqrt:  [[ 1.91832873e+01  0.00000000e+00]
 [-7.13563228e-03  1.63497875e-02]]
grads:  [0.00732974 4.48557038]
Stock Position:  0.007329744821337587
Bond Position:  [3.96162407]


portfolio before change:  [4.75098116]
curr_Stock_Price:  107.5571633123603
curr_Factors:  [1.07557163e+02 3.22354896e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.75098116]
Stock Price:  106.6015799757948
PL:  [-1.85059882]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 9.78215432e-02  3.78034784e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.94104224e-01 -7.84954982e-01]
 [-3.63335086e-02  2.75823306e-01]
 [-4.39563191e-01 -1.21401336e-01]
 [ 4.83782709e-01 -6.24831390e-01]
 [-5.49008717e-01  3.48789318e-01]
 [ 1.71262425e-01  1.46141660e-01]
 [-9.71497573e-02 -2.45003520e-02]
 [ 3.07826707e-01  6.09896007e-03]
 [ 1.52871943e-01  2.18189140e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-5.18934162e-02  8.73068365e-02]
 [-2.44498362e-01 -2.73718919e-01]
 [ 7.71587416e-02 -4.86214820e-02]
 [ 9.09561380e-02  1.47227880e-02]
 [-3.62165096e-02 -3.74839872e-02]
 [ 5.13964837e-01 -2.69399757e-01]
 [ 2.06395288e-01  1.28426173e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.15883029]
curr_Stock_Price:  102.40167156081606
curr_Factors:  [1.02401672e+02 3.98391102e-02]
mat_Sqrt:  [[ 2.04391043e+01  0.00000000e+00]
 [-7.98389481e-03  1.82934012e-02]]
grads:  [1.28581686e-02 2.06650902e+01]
Stock Position:  0.012858168573315362
Bond Position:  [17.84213233]


portfolio before change:  [19.11791387]
curr_Stock_Price:  98.8725910623653
curr_Factors:  [9.88725911e+01 4.11484206e-02]
mat_Sqrt:  [[ 2.00563777e+01  0.00000000e+00]
 [-8.11402939e-03  1.85915769e-02]]
grads:  [-0.00929006 -3.58506276]
Stock Position:  -0.0092900558890989
Bond Position:  [20.03644577]


portfolio before change:  [19.12207598]
curr_Stock_Price:  98.96383072118228
curr_Factors:  [9.89638307e+01 3.94035036e-02]
mat_Sqrt:  [[ 1.96446329e+01  0.00000000e+00]
 [-7.94012630e-03  1.81931149e-02]]
grads:  [-2.73197605e-02 -4.31457167e+01]
Stock Position:  -0.027319760452730033
Bond Position:  [21.82574413]


portfolio before change:  [19.14770775]
curr_Stock_Price:  98.22536731457772
curr_Factors:  [9.82253673e+01 3.98126162e-02]
mat_Sqrt:  [[ 1.95990048e+01  0.00000000e+00]
 [-7.98123962e-03  1.82873174e-02]]
grads:  [4.28826116e-03 1.50827648e+01]
Stock Position:  0.004288261161469266
Bond Position:  [18.72649172]


portfolio before change:  [19.15730171]
curr_Stock_Price:  99.3707640229009
curr_Factors:  [9.93707640e+01 3.96857977e-02]
mat_Sqrt:  [[ 1.97959426e+01  0.00000000e+00]
 [-7.96851783e-03  1.82581681e-02]]
grads:  [-0.02488121 -6.64915208]
Stock Position:  -0.024881213673242687
Bond Position:  [21.62976693]


portfolio before change:  [19.10086073]
curr_Stock_Price:  101.85653910258266
curr_Factors:  [1.01856539e+02 3.93614461e-02]
mat_Sqrt:  [[ 2.02080514e+01  0.00000000e+00]
 [-7.93588771e-03  1.81834031e-02]]
grads:  [ 1.04455362e-02 -3.43627311e+01]
Stock Position:  0.010445536226184318
Bond Position:  [18.03691456]


portfolio before change:  [19.10583719]
curr_Stock_Price:  101.90121548812292
curr_Factors:  [1.01901215e+02 3.88282175e-02]
mat_Sqrt:  [[ 2.00795091e+01  0.00000000e+00]
 [-7.88195078e-03  1.80598180e-02]]
grads:  [-0.01976067 19.31300292]
Stock Position:  -0.01976067123414017
Bond Position:  [21.11947361]


portfolio before change:  [19.13311014]
curr_Stock_Price:  100.78827681981652
curr_Factors:  [1.00788277e+02 3.79881615e-02]
mat_Sqrt:  [[ 1.96441915e+01  0.00000000e+00]
 [-7.79622078e-03  1.78633859e-02]]
grads:  [0.01196506 8.18107274]
Stock Position:  0.011965057170360885
Bond Position:  [17.92717264]


portfolio before change:  [19.15724296]
curr_Stock_Price:  102.43059803882502
curr_Factors:  [1.02430598e+02 3.53738712e-02]
mat_Sqrt:  [[ 1.92650883e+01  0.00000000e+00]
 [-7.52317712e-03  1.72377643e-02]]
grads:  [-0.00559782 -1.42131843]
Stock Position:  -0.005597824727600511
Bond Position:  [19.73063149]


portfolio before change:  [19.1698465]
curr_Stock_Price:  101.06037471049088
curr_Factors:  [1.01060375e+02 3.33655122e-02]
mat_Sqrt:  [[ 1.84599195e+01  0.00000000e+00]
 [-7.30649160e-03  1.67412754e-02]]
grads:  [0.0168196  0.36430678]
Stock Position:  0.016819602671660862
Bond Position:  [17.47005115]


portfolio before change:  [19.19589365]
curr_Stock_Price:  102.34929265238141
curr_Factors:  [1.02349293e+02 3.21757326e-02]
mat_Sqrt:  [[ 1.83590019e+01  0.00000000e+00]
 [-7.17503813e-03  1.64400777e-02]]
grads:  [ 0.01351367 13.27178281]
Stock Position:  0.013513669862732017
Bond Position:  [17.8127791]


portfolio before change:  [19.2124369]
curr_Stock_Price:  103.2439051573182
curr_Factors:  [1.03243905e+02 3.02420888e-02]
mat_Sqrt:  [[ 1.79543760e+01  0.00000000e+00]
 [-6.95610107e-03  1.59384298e-02]]
grads:  [-0.01052713  7.17342455]
Stock Position:  -0.01052712521209091
Bond Position:  [20.29929841]


portfolio before change:  [19.20218721]
curr_Stock_Price:  104.69968164799826
curr_Factors:  [1.04699682e+02 3.03127683e-02]
mat_Sqrt:  [[ 1.82288034e+01  0.00000000e+00]
 [-6.96422496e-03  1.59570440e-02]]
grads:  [-7.56472521e-04  5.47136652e+00]
Stock Position:  -0.000756472521214716
Bond Position:  [19.28138965]


portfolio before change:  [19.20990073]
curr_Stock_Price:  100.8759272006244
curr_Factors:  [1.00875927e+02 3.00509150e-02]
mat_Sqrt:  [[ 1.74870435e+01  0.00000000e+00]
 [-6.93407989e-03  1.58879730e-02]]
grads:  [ -0.02081307 -17.22805791]
Stock Position:  -0.0208130718592095
Bond Position:  [21.30943865]


portfolio before change:  [19.19398983]
curr_Stock_Price:  101.89638809463642
curr_Factors:  [1.01896388e+02 3.03884278e-02]
mat_Sqrt:  [[ 1.77628605e+01  0.00000000e+00]
 [-6.97291076e-03  1.59769457e-02]]
grads:  [ 0.00314919 -3.04322759]
Stock Position:  0.003149187998595073
Bond Position:  [18.87309895]


portfolio before change:  [19.19672843]
curr_Stock_Price:  101.26756960376629
curr_Factors:  [1.01267570e+02 3.00632681e-02]
mat_Sqrt:  [[ 1.75585433e+01  0.00000000e+00]
 [-6.93550496e-03  1.58912382e-02]]
grads:  [0.00554611 0.92647205]
Stock Position:  0.005546114388019147
Bond Position:  [18.6350869]


portfolio before change:  [19.19755209]
curr_Stock_Price:  100.57597081847315
curr_Factors:  [1.00575971e+02 2.96472847e-02]
mat_Sqrt:  [[ 1.73175598e+01  0.00000000e+00]
 [-6.88735476e-03  1.57809123e-02]]
grads:  [-0.00303599 -2.37527379]
Stock Position:  -0.0030359856407421305
Bond Position:  [19.5028993]


portfolio before change:  [19.20439588]
curr_Stock_Price:  99.92792753433025
curr_Factors:  [9.99279275e+01 3.03981027e-02]
mat_Sqrt:  [[ 1.74224858e+01  0.00000000e+00]
 [-6.97402067e-03  1.59794888e-02]]
grads:  [  0.02275158 -16.85909733]
Stock Position:  0.022751583680362435
Bond Position:  [16.93087727]


portfolio before change:  [19.1905166]
curr_Stock_Price:  99.13182782896172
curr_Factors:  [9.91318278e+01 3.05523181e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.1905166]
Stock Price:  98.31060700444725
PL:  [19.1905166]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 7.44982915e-02  3.42985598e-01]
 [-1.53327244e-01 -6.54258265e-02]
 [-2.22012609e-01 -9.75369920e-01]
 [-1.36398969e-02  2.78201433e-01]
 [-3.53911313e-01 -1.07597321e-01]
 [ 4.10148644e-01 -5.10299509e-01]
 [-5.23439391e-01  2.51296084e-01]
 [ 2.29471824e-01  1.50713957e-01]
 [-1.63891750e-01 -4.07512788e-02]
 [ 3.13025362e-01  5.92917419e-03]
 [ 9.21636531e-02  1.60987605e-01]
 [-2.36383007e-01  6.51324340e-02]
 [-7.80946638e-02  3.38607492e-02]
 [-9.61487856e-02 -2.19057113e-01]
 [-9.57709873e-02 -1.22952226e-01]
 [ 9.15690219e-02  5.33543737e-02]
 [ 3.36883329e-03 -5.70556641e-02]
 [ 7.67861914e-01 -3.65726611e-01]
 [ 1.64054725e-01  1.48725002e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.49022388]
curr_Stock_Price:  102.15946785063497
curr_Factors:  [1.02159468e+02 4.00858115e-02]
mat_Sqrt:  [[ 2.04537980e+01  0.00000000e+00]
 [-8.00857655e-03  1.83499541e-02]]
grads:  [1.09607751e-02 1.86913600e+01]
Stock Position:  0.010960775070331918
Bond Position:  [16.37047693]


portfolio before change:  [17.48172466]
curr_Stock_Price:  101.01061169332473
curr_Factors:  [1.01010612e+02 4.32544405e-02]
mat_Sqrt:  [[ 2.10078859e+01  0.00000000e+00]
 [-8.31908077e-03  1.90614087e-02]]
grads:  [-0.00865777 -3.43237101]
Stock Position:  -0.008657768625730311
Bond Position:  [18.35625116]


portfolio before change:  [17.51559529]
curr_Stock_Price:  97.62856265137201
curr_Factors:  [9.76285627e+01 4.65717791e-02]
mat_Sqrt:  [[ 2.10687277e+01  0.00000000e+00]
 [-8.63219824e-03  1.97788509e-02]]
grads:  [-3.07421953e-02 -4.93137808e+01]
Stock Position:  -0.030742195326364862
Bond Position:  [20.51691163]


portfolio before change:  [17.57674547]
curr_Stock_Price:  95.80630144407493
curr_Factors:  [9.58063014e+01 4.92819243e-02]
mat_Sqrt:  [[ 2.12685510e+01  0.00000000e+00]
 [-8.87981300e-03  2.03462076e-02]]
grads:  [5.06744265e-03 1.36733802e+01]
Stock Position:  0.005067442651335527
Bond Position:  [17.09125253]


portfolio before change:  [17.60377229]
curr_Stock_Price:  100.29643021239357
curr_Factors:  [1.00296430e+02 4.75273044e-02]
mat_Sqrt:  [[ 2.18653819e+01  0.00000000e+00]
 [-8.72030315e-03  1.99807246e-02]]
grads:  [-0.01833358 -5.38505601]
Stock Position:  -0.01833357568665063
Bond Position:  [19.44256448]


portfolio before change:  [17.59797903]
curr_Stock_Price:  100.8775774575989
curr_Factors:  [1.00877577e+02 4.92510295e-02]
mat_Sqrt:  [[ 2.23873300e+01  0.00000000e+00]
 [-8.87702918e-03  2.03398291e-02]]
grads:  [ 8.37239991e-03 -2.50886822e+01]
Stock Position:  0.008372399906291666
Bond Position:  [16.75339161]


portfolio before change:  [17.59742356]
curr_Stock_Price:  100.31091318106776
curr_Factors:  [1.00310913e+02 4.85869688e-02]
mat_Sqrt:  [[ 2.21109848e+01  0.00000000e+00]
 [-8.81698078e-03  2.02022409e-02]]
grads:  [-0.01871309 12.43902027]
Stock Position:  -0.018713087225558173
Bond Position:  [19.47455043]


portfolio before change:  [17.5821455]
curr_Stock_Price:  101.3875558290499
curr_Factors:  [1.01387556e+02 5.01734471e-02]
mat_Sqrt:  [[ 2.27102347e+01  0.00000000e+00]
 [-8.95977206e-03  2.05294168e-02]]
grads:  [0.01300069 7.34136573]
Stock Position:  0.01300069291472
Bond Position:  [16.26403702]


portfolio before change:  [17.58861041]
curr_Stock_Price:  101.57203796333309
curr_Factors:  [1.01572038e+02 4.98769048e-02]
mat_Sqrt:  [[ 2.26842233e+01  0.00000000e+00]
 [-8.93325516e-03  2.04686590e-02]]
grads:  [-0.00800896 -1.99091102]
Stock Position:  -0.008008961294652893
Bond Position:  [18.40209693]


portfolio before change:  [17.59793394]
curr_Stock_Price:  100.98239493082818
curr_Factors:  [1.00982395e+02 4.91323078e-02]
mat_Sqrt:  [[ 2.23835645e+01  0.00000000e+00]
 [-8.86632351e-03  2.03152993e-02]]
grads:  [0.01410021 0.29185759]
Stock Position:  0.01410021470222153
Bond Position:  [16.17406049]


portfolio before change:  [17.59302662]
curr_Stock_Price:  100.34755755339005
curr_Factors:  [1.00347558e+02 4.86600039e-02]
mat_Sqrt:  [[ 2.21356804e+01  0.00000000e+00]
 [-8.82360506e-03  2.02174190e-02]]
grads:  [7.33767388e-03 7.96281683e+00]
Stock Position:  0.007337673880970153
Bond Position:  [16.85670897]


portfolio before change:  [17.59174545]
curr_Stock_Price:  99.5985642769408
curr_Factors:  [9.95985643e+01 4.88684164e-02]
mat_Sqrt:  [[ 2.20174597e+01  0.00000000e+00]
 [-8.84248077e-03  2.02606687e-02]]
grads:  [-0.00944509  3.21472281]
Stock Position:  -0.0094450896867484
Bond Position:  [18.53246283]


portfolio before change:  [17.60649399]
curr_Stock_Price:  98.52765399300266
curr_Factors:  [9.85276540e+01 4.94536295e-02]
mat_Sqrt:  [[ 2.19107492e+01  0.00000000e+00]
 [-8.89526881e-03  2.03816213e-02]]
grads:  [-0.00288975  1.66133737]
Stock Position:  -0.00288975154095297
Bond Position:  [17.89121443]


portfolio before change:  [17.61484285]
curr_Stock_Price:  97.1865378282207
curr_Factors:  [9.71865378e+01 4.93866156e-02]
mat_Sqrt:  [[ 2.15978611e+01  0.00000000e+00]
 [-8.88923984e-03  2.03678072e-02]]
grads:  [-8.87833970e-03 -1.07550661e+01]
Stock Position:  -0.008878339699722917
Bond Position:  [18.47769794]


portfolio before change:  [17.60394923]
curr_Stock_Price:  98.93389363571566
curr_Factors:  [9.89338936e+01 4.97839788e-02]
mat_Sqrt:  [[ 2.20744506e+01  0.00000000e+00]
 [-8.92492947e-03  2.04495824e-02]]
grads:  [-0.00676944 -6.01245656]
Stock Position:  -0.006769443141595957
Bond Position:  [18.2736766]


portfolio before change:  [17.60663142]
curr_Stock_Price:  99.21261698927142
curr_Factors:  [9.92126170e+01 4.87777892e-02]
mat_Sqrt:  [[ 2.19117953e+01  0.00000000e+00]
 [-8.83427772e-03  2.02418732e-02]]
grads:  [0.00524169 2.63584171]
Stock Position:  0.005241687323651129
Bond Position:  [17.0865899]


portfolio before change:  [17.60885388]
curr_Stock_Price:  98.82157428991448
curr_Factors:  [9.88215743e+01 4.78886044e-02]
mat_Sqrt:  [[ 2.16255847e+01  0.00000000e+00]
 [-8.75338603e-03  2.00565270e-02]]
grads:  [-9.95686374e-04 -2.84474296e+00]
Stock Position:  -0.0009956863740542509
Bond Position:  [17.70724917]


portfolio before change:  [17.61532462]
curr_Stock_Price:  96.76934882928293
curr_Factors:  [9.67693488e+01 5.06987122e-02]
mat_Sqrt:  [[ 2.17889490e+01  0.00000000e+00]
 [-9.00654981e-03  2.06365981e-02]]
grads:  [  0.02791533 -17.72223351]
Stock Position:  0.027915331508622698
Bond Position:  [14.91397616]


portfolio before change:  [17.60982541]
curr_Stock_Price:  96.4387717687105
curr_Factors:  [9.64387718e+01 5.10653808e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.60982541]
Stock Price:  96.60603978871416
PL:  [17.60982541]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-4.44480977e-02  6.47757137e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.37286358e-01 -3.97294766e-01]
 [ 1.98426910e-01 -3.78014831e-02]
 [-1.04965188e-01 -7.35219447e-02]
 [ 6.82033296e-01 -9.31567294e-01]
 [-5.77896256e-01  4.26038622e-01]
 [ 3.18032640e-01  1.57670332e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.85800742e-01  4.55782005e-03]
 [ 9.39484514e-02  1.64214161e-01]
 [-2.38074135e-01  9.80975381e-02]
 [-2.54033745e-02  6.77371642e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [-3.62984390e-02 -9.72958134e-02]
 [ 9.49250825e-02  2.73587249e-02]
 [-5.18864825e-02 -3.22736146e-03]
 [ 3.52502232e-01 -2.22433539e-01]
 [ 1.34617782e-01  3.31240933e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.91983373]
curr_Stock_Price:  99.75422120262127
curr_Factors:  [9.97542212e+01 4.00582834e-02]
mat_Sqrt:  [[ 1.99653740e+01  0.00000000e+00]
 [-8.00582622e-03  1.83436523e-02]]
grads:  [-0.00208466  0.35312332]
Stock Position:  -0.0020846618673486263
Bond Position:  [1.12778755]


portfolio before change:  [0.92049868]
curr_Stock_Price:  99.5705133550846
curr_Factors:  [9.95705134e+01 3.91130685e-02]
mat_Sqrt:  [[ 1.96920845e+01  0.00000000e+00]
 [-7.91080967e-03  1.81259421e-02]]
grads:  [-0.00946192 -3.67715895]
Stock Position:  -0.00946191705580074
Bond Position:  [1.86262662]


portfolio before change:  [0.89714953]
curr_Stock_Price:  102.08743131671015
curr_Factors:  [1.02087431e+02 3.76727437e-02]
mat_Sqrt:  [[ 1.98146270e+01  0.00000000e+00]
 [-7.76378708e-03  1.77890710e-02]]
grads:  [-1.56793266e-02 -2.23336433e+01]
Stock Position:  -0.015679326627919588
Bond Position:  [2.49781171]


portfolio before change:  [0.9023058]
curr_Stock_Price:  101.79840437558889
curr_Factors:  [1.01798404e+02 3.69322403e-02]
mat_Sqrt:  [[ 1.95633758e+01  0.00000000e+00]
 [-7.68710508e-03  1.76133704e-02]]
grads:  [ 0.00929947 -2.14618112]
Stock Position:  0.009299468143026068
Bond Position:  [-0.04436521]


portfolio before change:  [0.92037381]
curr_Stock_Price:  103.74250475419647
curr_Factors:  [1.03742505e+02 3.67529040e-02]
mat_Sqrt:  [[ 1.98885243e+01  0.00000000e+00]
 [-7.66841877e-03  1.75705547e-02]]
grads:  [-0.00689105 -4.18438381]
Stock Position:  -0.00689104898673018
Bond Position:  [1.63526849]


portfolio before change:  [0.91823065]
curr_Stock_Price:  104.11284398685156
curr_Factors:  [1.04112844e+02 3.71780513e-02]
mat_Sqrt:  [[ 2.00746333e+01  0.00000000e+00]
 [-7.71264430e-03  1.76718882e-02]]
grads:  [ 1.3721994e-02 -5.2714644e+01]
Stock Position:  0.01372199395358635
Bond Position:  [-0.51040516]


portfolio before change:  [0.90416993]
curr_Stock_Price:  103.09745905438358
curr_Factors:  [1.03097459e+02 3.73733101e-02]
mat_Sqrt:  [[ 1.99309841e+01  0.00000000e+00]
 [-7.73287114e-03  1.77182337e-02]]
grads:  [-1.96657503e-02  2.40452084e+01]
Stock Position:  -0.019665750306614382
Bond Position:  [2.93165882]


portfolio before change:  [0.92141469]
curr_Stock_Price:  102.25783906654581
curr_Factors:  [1.02257839e+02 3.74743761e-02]
mat_Sqrt:  [[ 1.97953788e+01  0.00000000e+00]
 [-7.74331981e-03  1.77421746e-02]]
grads:  [0.01954222 8.88675347]
Stock Position:  0.019542218312462542
Bond Position:  [-1.07693032]


portfolio before change:  [0.88804564]
curr_Stock_Price:  100.56408096139538
curr_Factors:  [1.00564081e+02 3.74758055e-02]
mat_Sqrt:  [[ 1.94678673e+01  0.00000000e+00]
 [-7.74346749e-03  1.77425130e-02]]
grads:  [-0.01117641 -2.9955684 ]
Stock Position:  -0.011176410205267067
Bond Position:  [2.01199106]


portfolio before change:  [0.89763997]
curr_Stock_Price:  99.75064667940889
curr_Factors:  [9.97506467e+01 3.87065227e-02]
mat_Sqrt:  [[ 1.96249156e+01  0.00000000e+00]
 [-7.86958934e-03  1.80314944e-02]]
grads:  [0.01466452 0.25276996]
Stock Position:  0.01466451845069419
Bond Position:  [-0.56515523]


portfolio before change:  [0.90637355]
curr_Stock_Price:  100.3558410788577
curr_Factors:  [1.00355841e+02 3.66767590e-02]
mat_Sqrt:  [[ 1.92193250e+01  0.00000000e+00]
 [-7.66047090e-03  1.75523439e-02]]
grads:  [8.61723224e-03 9.35568279e+00]
Stock Position:  0.008617232244466637
Bond Position:  [0.04158396]


portfolio before change:  [0.91940966]
curr_Stock_Price:  101.86743021082003
curr_Factors:  [1.01867430e+02 3.69338299e-02]
mat_Sqrt:  [[ 1.95770623e+01  0.00000000e+00]
 [-7.68727051e-03  1.76137495e-02]]
grads:  [-0.00997396  5.56937285]
Stock Position:  -0.009973961191469018
Bond Position:  [1.93543146]


portfolio before change:  [0.9041145]
curr_Stock_Price:  103.44945796730248
curr_Factors:  [1.03449458e+02 3.81858072e-02]
mat_Sqrt:  [[ 2.02152542e+01  0.00000000e+00]
 [-7.81647565e-03  1.79097957e-02]]
grads:  [2.05762817e-04 3.78212937e+00]
Stock Position:  0.00020576281692878185
Bond Position:  [0.88282845]


portfolio before change:  [0.90432343]
curr_Stock_Price:  103.39210322737311
curr_Factors:  [1.03392103e+02 4.09174742e-02]
mat_Sqrt:  [[ 2.09142251e+01  0.00000000e+00]
 [-8.09122727e-03  1.85393307e-02]]
grads:  [ -0.01964407 -13.45622404]
Stock Position:  -0.019644073787856212
Bond Position:  [2.93536554]


portfolio before change:  [0.96208649]
curr_Stock_Price:  100.48898223784218
curr_Factors:  [1.00488982e+02 3.93958347e-02]
mat_Sqrt:  [[ 1.99454391e+01  0.00000000e+00]
 [-7.93935359e-03  1.81913444e-02]]
grads:  [-3.94886335e-03 -5.34846745e+00]
Stock Position:  -0.003948863348596871
Bond Position:  [1.35890375]


portfolio before change:  [0.9606231]
curr_Stock_Price:  100.94560950753466
curr_Factors:  [1.00945610e+02 3.71446081e-02]
mat_Sqrt:  [[ 1.94551832e+01  0.00000000e+00]
 [-7.70917460e-03  1.76639381e-02]]
grads:  [0.0054929  1.54884629]
Stock Position:  0.0054929016959738165
Bond Position:  [0.40613879]


portfolio before change:  [0.96598727]
curr_Stock_Price:  101.90368777374759
curr_Factors:  [1.01903688e+02 3.59311583e-02]
mat_Sqrt:  [[ 1.93163697e+01  0.00000000e+00]
 [-7.58220636e-03  1.73730173e-02]]
grads:  [-0.00275906 -0.18576862]
Stock Position:  -0.0027590597609651562
Bond Position:  [1.24714564]


portfolio before change:  [0.9646256]
curr_Stock_Price:  102.51023389422609
curr_Factors:  [1.02510234e+02 3.52439781e-02]
mat_Sqrt:  [[ 1.92446353e+01  0.00000000e+00]
 [-7.50935183e-03  1.72060866e-02]]
grads:  [  0.01327249 -12.9276078 ]
Stock Position:  0.01327249244252071
Bond Position:  [-0.3959407]


portfolio before change:  [0.98226705]
curr_Stock_Price:  103.84686606527026
curr_Factors:  [1.03846866e+02 3.41807542e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.98226705]
Stock Price:  104.30642323671549
PL:  [-3.32415619]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.58051629e-01 -5.38973256e-01]
 [-3.00413097e-02  2.76482683e-01]
 [-4.13191352e-01 -7.30633118e-02]
 [-2.30686429e-02  7.93386597e-02]
 [-3.55022961e-01  1.37561633e-01]
 [-4.80559339e-02  1.52177565e-01]
 [-2.15581359e-01  2.94376707e-02]
 [ 2.60210472e-01  4.88781715e-03]
 [ 4.95582209e-02  1.24185010e-01]
 [-2.36643165e-01  7.02036948e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.67093532e-01 -2.63468647e-01]
 [ 2.70676662e-02 -7.04721010e-02]
 [ 8.81232502e-02  6.52809487e-02]
 [ 1.28507683e-02 -6.17486009e-02]
 [ 5.34667462e-01 -2.75450437e-01]
 [ 2.18014776e-01  1.01661165e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.29689569]
curr_Stock_Price:  98.27122931409137
curr_Factors:  [9.82712293e+01 4.33778976e-02]
mat_Sqrt:  [[ 2.04673039e+01  0.00000000e+00]
 [-8.33094449e-03  1.90885919e-02]]
grads:  [ 0.00136176 -0.07076657]
Stock Position:  0.0013617610670771379
Bond Position:  [-9.43071762]


portfolio before change:  [-9.29809239]
curr_Stock_Price:  99.12400350728649
curr_Factors:  [9.91240035e+01 4.33906023e-02]
mat_Sqrt:  [[ 2.06479373e+01  0.00000000e+00]
 [-8.33216440e-03  1.90913870e-02]]
grads:  [-0.0090239  -3.49120627]
Stock Position:  -0.009023897503863757
Bond Position:  [-8.40360754]


portfolio before change:  [-9.31675422]
curr_Stock_Price:  100.95920533100154
curr_Factors:  [1.00959205e+02 4.57452405e-02]
mat_Sqrt:  [[ 2.15932932e+01  0.00000000e+00]
 [-8.55525481e-03  1.96025514e-02]]
grads:  [-1.82130090e-02 -2.74950564e+01]
Stock Position:  -0.018213008974952944
Bond Position:  [-7.47798331]


portfolio before change:  [-9.2564746]
curr_Stock_Price:  97.54684464115574
curr_Factors:  [9.75468446e+01 4.87808292e-02]
mat_Sqrt:  [[ 2.15445692e+01  0.00000000e+00]
 [-8.83455300e-03  2.02425039e-02]]
grads:  [4.20642552e-03 1.36585219e+01]
Stock Position:  0.00420642552278995
Bond Position:  [-9.66679814]


portfolio before change:  [-9.25812308]
curr_Stock_Price:  97.72954673907664
curr_Factors:  [9.77295467e+01 4.63346604e-02]
mat_Sqrt:  [[ 2.10367612e+01  0.00000000e+00]
 [-8.61019492e-03  1.97284350e-02]]
grads:  [-0.02115719 -3.70345199]
Stock Position:  -0.021157192032338807
Bond Position:  [-7.19044029]


portfolio before change:  [-9.25846534]
curr_Stock_Price:  97.66074855440247
curr_Factors:  [9.76607486e+01 4.82217035e-02]
mat_Sqrt:  [[ 2.14457542e+01  0.00000000e+00]
 [-8.78377628e-03  2.01261598e-02]]
grads:  [5.38921920e-04 3.94206646e+00]
Stock Position:  0.0005389219200136545
Bond Position:  [-9.31109685]


portfolio before change:  [-9.26096519]
curr_Stock_Price:  97.3419758084075
curr_Factors:  [9.73419758e+01 4.87720109e-02]
mat_Sqrt:  [[ 2.14973778e+01  0.00000000e+00]
 [-8.83375444e-03  2.02406742e-02]]
grads:  [-0.01372196  6.79629698]
Stock Position:  -0.013721959259586665
Bond Position:  [-7.92524257]


portfolio before change:  [-9.2346034]
curr_Stock_Price:  95.27642839900564
curr_Factors:  [9.52764284e+01 5.04203545e-02]
mat_Sqrt:  [[ 2.13938239e+01  0.00000000e+00]
 [-8.98179087e-03  2.05798683e-02]]
grads:  [8.58182269e-04 7.39448682e+00]
Stock Position:  0.0008581822690019388
Bond Position:  [-9.31636794]


portfolio before change:  [-9.23577876]
curr_Stock_Price:  96.62114885916418
curr_Factors:  [9.66211489e+01 5.00117236e-02]
mat_Sqrt:  [[ 2.16076784e+01  0.00000000e+00]
 [-8.94532044e-03  2.04963040e-02]]
grads:  [-0.00938248  1.43624288]
Stock Position:  -0.00938248440132857
Bond Position:  [-8.32923234]


portfolio before change:  [-9.26164336]
curr_Stock_Price:  99.15587452916004
curr_Factors:  [9.91558745e+01 5.07918910e-02]
mat_Sqrt:  [[ 2.23468154e+01  0.00000000e+00]
 [-9.01482255e-03  2.06555534e-02]]
grads:  [0.01173965 0.23663453]
Stock Position:  0.011739645520269246
Bond Position:  [-10.42569817]


portfolio before change:  [-9.2595895]
curr_Stock_Price:  99.55287173089003
curr_Factors:  [9.95528717e+01 5.18957612e-02]
mat_Sqrt:  [[ 2.26787825e+01  0.00000000e+00]
 [-9.11225647e-03  2.08788025e-02]]
grads:  [4.57506934e-03 5.94789905e+00]
Stock Position:  0.004575069342511484
Bond Position:  [-9.71505079]


portfolio before change:  [-9.2602242]
curr_Stock_Price:  99.94507620757632
curr_Factors:  [9.99450762e+01 5.20947829e-02]
mat_Sqrt:  [[ 2.28117456e+01  0.00000000e+00]
 [-9.12971262e-03  2.09187996e-02]]
grads:  [-0.0090306   3.35600972]
Stock Position:  -0.009030600483422578
Bond Position:  [-8.35766015]


portfolio before change:  [-9.27495767]
curr_Stock_Price:  101.34518134753445
curr_Factors:  [1.01345181e+02 5.06747847e-02]
mat_Sqrt:  [[ 2.28138751e+01  0.00000000e+00]
 [-9.00442422e-03  2.06317278e-02]]
grads:  [2.91161081e-04 1.90801775e+00]
Stock Position:  0.000291161080673767
Bond Position:  [-9.30446544]


portfolio before change:  [-9.27714634]
curr_Stock_Price:  101.81823074908488
curr_Factors:  [1.01818231e+02 5.16304277e-02]
mat_Sqrt:  [[ 2.31354743e+01  0.00000000e+00]
 [-9.08893197e-03  2.08253594e-02]]
grads:  [ -0.01651493 -12.65133737]
Stock Position:  -0.016514927325453056
Bond Position:  [-7.59562566]


portfolio before change:  [-9.27254763]
curr_Stock_Price:  101.42477729671926
curr_Factors:  [1.01424777e+02 4.85980270e-02]
mat_Sqrt:  [[ 2.23590518e+01  0.00000000e+00]
 [-8.81798408e-03  2.02045398e-02]]
grads:  [-1.64983749e-04 -3.48793399e+00]
Stock Position:  -0.00016498374863819056
Bond Position:  [-9.25581419]


portfolio before change:  [-9.27436921]
curr_Stock_Price:  98.43863581495337
curr_Factors:  [9.84386358e+01 4.88810450e-02]
mat_Sqrt:  [[ 2.17638552e+01  0.00000000e+00]
 [-8.84362324e-03  2.02632864e-02]]
grads:  [0.00535816 3.22163677]
Stock Position:  0.005358158792245359
Bond Position:  [-9.80181905]


portfolio before change:  [-9.27698817]
curr_Stock_Price:  98.40724528890054
curr_Factors:  [9.84072453e+01 4.79164826e-02]
mat_Sqrt:  [[ 2.15411825e+01  0.00000000e+00]
 [-8.75593354e-03  2.00623641e-02]]
grads:  [-6.54491948e-04 -3.07783273e+00]
Stock Position:  -0.0006544919484905046
Bond Position:  [-9.21258142]


portfolio before change:  [-9.28003477]
curr_Stock_Price:  99.54273025688292
curr_Factors:  [9.95427303e+01 4.76596687e-02]
mat_Sqrt:  [[ 2.17312675e+01  0.00000000e+00]
 [-8.73243780e-03  2.00085286e-02]]
grads:  [  0.01907165 -13.76665135]
Stock Position:  0.01907164573925668
Bond Position:  [-11.17847845]


portfolio before change:  [-9.24944298]
curr_Stock_Price:  101.2933268042238
curr_Factors:  [1.01293327e+02 4.74625537e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.24944298]
Stock Price:  100.93677531740265
PL:  [-10.18621829]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-4.67412893e-02  1.60791937e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.64069606e-01 -5.80033059e-01]
 [ 1.67626369e-01  1.11083929e-02]
 [-1.69933248e-01 -8.42280251e-02]
 [ 5.79588933e-01 -7.73065698e-01]
 [-5.07072689e-01  2.36799883e-01]
 [ 1.11440061e-01  1.41442665e-01]
 [-2.14787398e-01  2.63442228e-02]
 [ 2.46934322e-01  5.29451411e-03]
 [ 1.13616861e-01  1.81453273e-01]
 [-2.36137688e-01  6.03504469e-02]
 [-3.50550192e-02  3.70152015e-02]
 [-1.00751123e-01 -2.21194561e-01]
 [-1.11143863e-01 -1.30325669e-01]
 [ 8.87488808e-02  6.99317461e-02]
 [ 5.49659454e-02 -8.26044830e-02]
 [ 9.11915621e-01 -4.25138363e-01]
 [ 1.51780876e-01  1.51627979e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.80865285]
curr_Stock_Price:  100.89930925231863
curr_Factors:  [1.00899309e+02 3.90515018e-02]
mat_Sqrt:  [[ 1.99391694e+01  0.00000000e+00]
 [-7.90458113e-03  1.81116707e-02]]
grads:  [1.17527790e-03 8.87780811e+00]
Stock Position:  0.0011752778981031255
Bond Position:  [8.69006812]


portfolio before change:  [8.80964377]
curr_Stock_Price:  99.89370449395557
curr_Factors:  [9.98937045e+01 4.06920594e-02]
mat_Sqrt:  [[ 2.01508307e+01  0.00000000e+00]
 [-8.06890916e-03  1.84881935e-02]]
grads:  [-0.00924651 -3.60510994]
Stock Position:  -0.009246510635036091
Bond Position:  [9.73331197]


portfolio before change:  [8.80561695]
curr_Stock_Price:  100.59239546434439
curr_Factors:  [1.00592395e+02 4.10278315e-02]
mat_Sqrt:  [[ 2.03753197e+01  0.00000000e+00]
 [-8.10213123e-03  1.85643148e-02]]
grads:  [-2.04765762e-02 -3.12445175e+01]
Stock Position:  -0.020476576213742763
Bond Position:  [10.8654048]


portfolio before change:  [8.79301966]
curr_Stock_Price:  101.3402735304545
curr_Factors:  [1.01340274e+02 4.05913744e-02]
mat_Sqrt:  [[ 2.04173301e+01  0.00000000e+00]
 [-8.05892047e-03  1.84653065e-02]]
grads:  [0.00844745 0.60158183]
Stock Position:  0.008447454595351086
Bond Position:  [7.9369523]


portfolio before change:  [8.80377498]
curr_Stock_Price:  102.37855498171783
curr_Factors:  [1.02378555e+02 3.94869375e-02]
mat_Sqrt:  [[ 2.03439707e+01  0.00000000e+00]
 [-7.94852817e-03  1.82123660e-02]]
grads:  [-0.01015993 -4.62477117]
Stock Position:  -0.010159932615260634
Bond Position:  [9.8439342]


portfolio before change:  [8.80047369]
curr_Stock_Price:  102.94574169395594
curr_Factors:  [1.02945742e+02 3.86574627e-02]
mat_Sqrt:  [[ 2.02406782e+01  0.00000000e+00]
 [-7.86460046e-03  1.80200634e-02]]
grads:  [ 1.19657750e-02 -4.29002761e+01]
Stock Position:  0.011965775037205736
Bond Position:  [7.56864811]


portfolio before change:  [8.76940895]
curr_Stock_Price:  100.19145790851081
curr_Factors:  [1.00191458e+02 3.88528675e-02]
mat_Sqrt:  [[ 1.97488693e+01  0.00000000e+00]
 [-7.88445230e-03  1.80655497e-02]]
grads:  [-0.02044293 13.10781494]
Stock Position:  -0.02044292979263747
Bond Position:  [10.81761589]


portfolio before change:  [8.77218692]
curr_Stock_Price:  100.18787607945222
curr_Factors:  [1.00187876e+02 3.71287461e-02]
mat_Sqrt:  [[ 1.93050225e+01  0.00000000e+00]
 [-7.70752838e-03  1.76601661e-02]]
grads:  [0.00897024 8.00913562]
Stock Position:  0.008970240846821097
Bond Position:  [7.87347754]


portfolio before change:  [8.7445143]
curr_Stock_Price:  96.88347980480094
curr_Factors:  [9.68834798e+01 3.66824589e-02]
mat_Sqrt:  [[ 1.85557686e+01  0.00000000e+00]
 [-7.66106613e-03  1.75537077e-02]]
grads:  [-0.01095561  1.50077825]
Stock Position:  -0.01095561388642289
Bond Position:  [9.8059323]


portfolio before change:  [8.72755102]
curr_Stock_Price:  98.65563722091991
curr_Factors:  [9.86556372e+01 3.65912675e-02]
mat_Sqrt:  [[ 1.88716830e+01  0.00000000e+00]
 [-7.65153763e-03  1.75318752e-02]]
grads:  [0.01320736 0.3019936 ]
Stock Position:  0.013207356065283185
Bond Position:  [7.42457089]


portfolio before change:  [8.76015617]
curr_Stock_Price:  100.98379292095866
curr_Factors:  [1.00983793e+02 3.52793042e-02]
mat_Sqrt:  [[ 1.89675695e+01  0.00000000e+00]
 [-7.51311431e-03  1.72147075e-02]]
grads:  [1.01652224e-02 1.05405958e+01]
Stock Position:  0.010165222364050945
Bond Position:  [7.73363346]


portfolio before change:  [8.73821596]
curr_Stock_Price:  98.63521047019287
curr_Factors:  [9.86352105e+01 3.56900122e-02]
mat_Sqrt:  [[ 1.86339671e+01  0.00000000e+00]
 [-7.55672016e-03  1.73146211e-02]]
grads:  [-0.01125893  3.48551936]
Stock Position:  -0.011258933349477125
Bond Position:  [9.84874322]


portfolio before change:  [8.72809593]
curr_Stock_Price:  99.75276948093861
curr_Factors:  [9.97527695e+01 3.45514935e-02]
mat_Sqrt:  [[ 1.85420767e+01  0.00000000e+00]
 [-7.43521281e-03  1.70362128e-02]]
grads:  [-1.01931737e-03  2.17273651e+00]
Stock Position:  -0.001019317366679307
Bond Position:  [8.82977566]


portfolio before change:  [8.7327628]
curr_Stock_Price:  97.34022791606121
curr_Factors:  [9.73402279e+01 3.51453975e-02]
mat_Sqrt:  [[ 1.82484755e+01  0.00000000e+00]
 [-7.49884232e-03  1.71820063e-02]]
grads:  [-1.08112233e-02 -1.28736166e+01]
Stock Position:  -0.010811223284708522
Bond Position:  [9.78512974]


portfolio before change:  [8.72838198]
curr_Stock_Price:  97.97173931569287
curr_Factors:  [9.79717393e+01 3.76161175e-02]
mat_Sqrt:  [[ 1.90014963e+01  0.00000000e+00]
 [-7.75794998e-03  1.77756965e-02]]
grads:  [-0.0088426  -7.33167718]
Stock Position:  -0.008842600871578071
Bond Position:  [9.59470696]


portfolio before change:  [8.72796701]
curr_Stock_Price:  98.28996448171019
curr_Factors:  [9.82899645e+01 3.59414313e-02]
mat_Sqrt:  [[ 1.86340331e+01  0.00000000e+00]
 [-7.58329019e-03  1.73755007e-02]]
grads:  [0.00640063 4.02473273]
Stock Position:  0.006400632454665565
Bond Position:  [8.09884908]


portfolio before change:  [8.71905321]
curr_Stock_Price:  96.58095047178679
curr_Factors:  [9.65809505e+01 3.77470202e-02]
mat_Sqrt:  [[ 1.87643192e+01  0.00000000e+00]
 [-7.77143696e-03  1.78065991e-02]]
grads:  [ 1.00799785e-03 -4.63898147e+00]
Stock Position:  0.0010079978472025063
Bond Position:  [8.62169982]


portfolio before change:  [8.71988467]
curr_Stock_Price:  95.2672250884374
curr_Factors:  [9.52672251e+01 3.61639935e-02]
mat_Sqrt:  [[ 1.81168091e+01  0.00000000e+00]
 [-7.60673318e-03  1.74292153e-02]]
grads:  [  0.04009371 -24.39228364]
Stock Position:  0.04009370667413732
Bond Position:  [4.90026849]


portfolio before change:  [8.74582594]
curr_Stock_Price:  95.88368217304155
curr_Factors:  [9.58836822e+01 3.71093312e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.74582594]
Stock Price:  95.29154186146165
PL:  [8.74582594]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 4.30100745e-03  1.24328510e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.86157152e-01 -1.20226642e+00]
 [-2.71011321e-02  2.76790793e-01]
 [-4.31110358e-01 -4.47803688e-02]
 [ 1.95081736e-01 -2.13322134e-02]
 [-1.76636942e-01  3.97483457e-02]
 [-9.62784441e-02 -6.60996409e-03]
 [-2.19741050e-01  4.56447549e-02]
 [ 1.50644047e-01  1.13282665e-02]
 [-1.03132465e-01 -4.14619911e-02]
 [-1.51173007e-01  3.01223572e-02]
 [ 2.82068722e-02  1.97912121e-03]
 [-7.09987996e-02 -2.07188132e-01]
 [-1.07888631e-01 -1.28764330e-01]
 [ 8.84834684e-02  7.02608676e-02]
 [ 5.63196791e-02 -8.30837248e-02]
 [ 8.27943925e-01 -3.90500328e-01]
 [ 1.44156677e-01  1.88517368e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.72674881]
curr_Stock_Price:  99.51521432965218
curr_Factors:  [9.95152143e+01 4.07289427e-02]
mat_Sqrt:  [[ 2.00835763e+01  0.00000000e+00]
 [-8.07256517e-03  1.84965705e-02]]
grads:  [0.00024117 0.06721706]
Stock Position:  0.00024117325895682727
Bond Position:  [-0.75074922]


portfolio before change:  [-0.7271125]
curr_Stock_Price:  98.78553784025151
curr_Factors:  [9.87855378e+01 4.20071170e-02]
mat_Sqrt:  [[ 2.02467261e+01  0.00000000e+00]
 [-8.19825513e-03  1.87845624e-02]]
grads:  [-0.00920272 -3.5482312 ]
Stock Position:  -0.009202716014288943
Bond Position:  [0.18198275]


portfolio before change:  [-0.70483998]
curr_Stock_Price:  96.37027104838174
curr_Factors:  [9.63702710e+01 4.36388342e-02]
mat_Sqrt:  [[ 2.01316629e+01  0.00000000e+00]
 [-8.35596402e-03  1.91459188e-02]]
grads:  [-3.53110043e-02 -6.27949192e+01]
Stock Position:  -0.035311004334325435
Bond Position:  [2.69809108]


portfolio before change:  [-0.73500101]
curr_Stock_Price:  97.24352964554012
curr_Factors:  [9.72435296e+01 4.17902166e-02]
mat_Sqrt:  [[ 1.98791598e+01  0.00000000e+00]
 [-8.17706222e-03  1.87360033e-02]]
grads:  [4.71349264e-03 1.47732037e+01]
Stock Position:  0.004713492641342859
Bond Position:  [-1.19335768]


portfolio before change:  [-0.74195951]
curr_Stock_Price:  95.83054044808212
curr_Factors:  [9.58305404e+01 4.28704991e-02]
mat_Sqrt:  [[ 1.98418977e+01  0.00000000e+00]
 [-8.28207694e-03  1.89766223e-02]]
grads:  [-0.02271225 -2.35976499]
Stock Position:  -0.022712248552034034
Bond Position:  [1.43456755]


portfolio before change:  [-0.72360721]
curr_Stock_Price:  95.03829790476689
curr_Factors:  [9.50382979e+01 4.36535074e-02]
mat_Sqrt:  [[ 1.98567524e+01  0.00000000e+00]
 [-8.35736872e-03  1.91491374e-02]]
grads:  [ 0.00935559 -1.11400388]
Stock Position:  0.009355587973046751
Bond Position:  [-1.61274637]


portfolio before change:  [-0.74161655]
curr_Stock_Price:  93.15641674098741
curr_Factors:  [9.31564167e+01 4.53679262e-02]
mat_Sqrt:  [[ 1.98420820e+01  0.00000000e+00]
 [-8.51989917e-03  1.95215414e-02]]
grads:  [-0.00802785  2.03612741]
Stock Position:  -0.008027854240113931
Bond Position:  [0.00622958]


portfolio before change:  [-0.74851117]
curr_Stock_Price:  94.01544764571354
curr_Factors:  [9.40154476e+01 4.63340425e-02]
mat_Sqrt:  [[ 2.02371483e+01  0.00000000e+00]
 [-8.61013751e-03  1.97283035e-02]]
grads:  [-0.00490006 -0.3350498 ]
Stock Position:  -0.004900061378712761
Bond Position:  [-0.2878297]


portfolio before change:  [-0.75942343]
curr_Stock_Price:  96.2277260489541
curr_Factors:  [9.6227726e+01 4.6535991e-02]
mat_Sqrt:  [[ 2.07584397e+01  0.00000000e+00]
 [-8.62888090e-03  1.97712499e-02]]
grads:  [-0.00962597  2.30864285]
Stock Position:  -0.009625966527738807
Bond Position:  [0.16686144]


portfolio before change:  [-0.74752733]
curr_Stock_Price:  94.99622571115017
curr_Factors:  [9.49962257e+01 4.75126062e-02]
mat_Sqrt:  [[ 2.07066946e+01  0.00000000e+00]
 [-8.71895464e-03  1.99776348e-02]]
grads:  [0.0075139  0.56704743]
Stock Position:  0.007513903625719914
Bond Position:  [-1.46131982]


portfolio before change:  [-0.75882692]
curr_Stock_Price:  93.54102832513968
curr_Factors:  [9.35410283e+01 4.70095588e-02]
mat_Sqrt:  [[ 2.02812738e+01  0.00000000e+00]
 [-8.67267514e-03  1.98715951e-02]]
grads:  [-0.00597733 -2.08649536]
Stock Position:  -0.005977334713700968
Bond Position:  [-0.19970089]


portfolio before change:  [-0.76777196]
curr_Stock_Price:  95.0291674954186
curr_Factors:  [9.50291675e+01 4.50037858e-02]
mat_Sqrt:  [[ 2.01595786e+01  0.00000000e+00]
 [-8.48563829e-03  1.94430399e-02]]
grads:  [-0.0068467   1.54926171]
Stock Position:  -0.0068466973114630555
Bond Position:  [-0.11713601]


portfolio before change:  [-0.7668187]
curr_Stock_Price:  94.8856613693409
curr_Factors:  [9.48856614e+01 4.36643151e-02]
mat_Sqrt:  [[ 1.98273154e+01  0.00000000e+00]
 [-8.35840320e-03  1.91515077e-02]]
grads:  [0.00146619 0.10334023]
Stock Position:  0.0014661910042584412
Bond Position:  [-0.90593921]


portfolio before change:  [-0.76490669]
curr_Stock_Price:  96.3442187914642
curr_Factors:  [9.63442188e+01 4.25491492e-02]
mat_Sqrt:  [[ 1.98733508e+01  0.00000000e+00]
 [-8.25097804e-03  1.89053657e-02]]
grads:  [-8.12259166e-03 -1.09592237e+01]
Stock Position:  -0.008122591659853146
Bond Position:  [0.01765805]


portfolio before change:  [-0.77940443]
curr_Stock_Price:  98.12962777574086
curr_Factors:  [9.81296278e+01 4.26759354e-02]
mat_Sqrt:  [[ 2.02717703e+01  0.00000000e+00]
 [-8.26326186e-03  1.89335115e-02]]
grads:  [-0.00809431 -6.80086892]
Stock Position:  -0.008094309943214037
Bond Position:  [0.0148872]


portfolio before change:  [-0.77406228]
curr_Stock_Price:  97.4700993943862
curr_Factors:  [9.74700994e+01 4.42219174e-02]
mat_Sqrt:  [[ 2.04969949e+01  0.00000000e+00]
 [-8.41160316e-03  1.92734041e-02]]
grads:  [0.00581294 3.64548303]
Stock Position:  0.005812941140014642
Bond Position:  [-1.34065023]


portfolio before change:  [-0.78074995]
curr_Stock_Price:  96.37728482891582
curr_Factors:  [9.63772848e+01 4.49426549e-02]
mat_Sqrt:  [[ 2.04316786e+01  0.00000000e+00]
 [-8.47987310e-03  1.94298302e-02]]
grads:  [ 9.81758239e-04 -4.27609114e+00]
Stock Position:  0.0009817582389418465
Bond Position:  [-0.87536914]


portfolio before change:  [-0.78119864]
curr_Stock_Price:  96.14319227386605
curr_Factors:  [9.61431923e+01 4.44414032e-02]
mat_Sqrt:  [[ 2.02680711e+01  0.00000000e+00]
 [-8.43245190e-03  1.93211746e-02]]
grads:  [  0.03244096 -20.21100356]
Stock Position:  0.032440956308435874
Bond Position:  [-3.90017574]


portfolio before change:  [-0.87761677]
curr_Stock_Price:  93.20114072654846
curr_Factors:  [9.32011407e+01 4.71773215e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.87761677]
Stock Price:  90.94880645768974
PL:  [-0.87761677]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.90458158e-01 -7.60078390e-01]
 [-2.87352506e-02  2.76619549e-01]
 [-4.08483865e-01 -7.44392231e-02]
 [ 3.37512997e-02  6.22527749e-03]
 [-2.80869861e-01  9.69017288e-02]
 [ 2.25090738e-02  1.55993814e-01]
 [-2.15414204e-01  2.87863978e-02]
 [ 2.09560913e-01  7.63641099e-03]
 [-1.22745133e-02  6.67166481e-02]
 [-2.36116983e-01  5.99468389e-02]
 [-1.07433471e-01  3.17104557e-02]
 [-8.88585814e-02 -2.15588913e-01]
 [-1.94940848e-01 -1.37582485e-01]
 [ 8.85441907e-02  4.59135490e-02]
 [ 3.83051326e-02 -7.43671474e-02]
 [ 5.99594049e-01 -2.95232650e-01]
 [ 2.22385000e-01  1.22108633e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.44610099]
curr_Stock_Price:  98.53987825390269
curr_Factors:  [9.85398783e+01 4.06741762e-02]
mat_Sqrt:  [[ 1.98733648e+01  0.00000000e+00]
 [-8.06713591e-03  1.84841305e-02]]
grads:  [ 0.00140246 -0.07308076]
Stock Position:  0.0014024589159363312
Bond Position:  [-7.58429912]


portfolio before change:  [-7.44637104]
curr_Stock_Price:  99.69945335382823
curr_Factors:  [9.96994534e+01 3.95697895e-02]
mat_Sqrt:  [[ 1.98323714e+01  0.00000000e+00]
 [-7.95686265e-03  1.82314627e-02]]
grads:  [-0.00939499 -3.65587618]
Stock Position:  -0.009394986933607644
Bond Position:  [-6.50969598]


portfolio before change:  [-7.44288938]
curr_Stock_Price:  99.15562216235378
curr_Factors:  [9.91556222e+01 3.97431264e-02]
mat_Sqrt:  [[ 1.97673457e+01  0.00000000e+00]
 [-7.97427126e-03  1.82713508e-02]]
grads:  [-2.64164735e-02 -4.15994634e+01]
Stock Position:  -0.026416473464768157
Bond Position:  [-4.82354752]


portfolio before change:  [-7.39822447]
curr_Stock_Price:  97.41916967149488
curr_Factors:  [9.74191697e+01 3.99298531e-02]
mat_Sqrt:  [[ 1.94667423e+01  0.00000000e+00]
 [-7.99298223e-03  1.83142231e-02]]
grads:  [4.72556818e-03 1.51040832e+01]
Stock Position:  0.004725568183191011
Bond Position:  [-7.8585854]


portfolio before change:  [-7.39790329]
curr_Stock_Price:  97.90293658243802
curr_Factors:  [9.79029366e+01 3.91476961e-02]
mat_Sqrt:  [[ 1.93708565e+01  0.00000000e+00]
 [-7.91431069e-03  1.81339639e-02]]
grads:  [-0.0227647  -4.10496147]
Stock Position:  -0.0227647036104609
Bond Position:  [-5.16917196]


portfolio before change:  [-7.40120252]
curr_Stock_Price:  97.99108966740759
curr_Factors:  [9.79910897e+01 3.95288151e-02]
mat_Sqrt:  [[ 1.94824462e+01  0.00000000e+00]
 [-7.95274193e-03  1.82220209e-02]]
grads:  [0.00187185 0.34163486]
Stock Position:  0.0018718508546975618
Bond Position:  [-7.58462723]


portfolio before change:  [-7.40708811]
curr_Stock_Price:  95.85994042786639
curr_Factors:  [9.58599404e+01 3.93246093e-02]
mat_Sqrt:  [[ 1.90094418e+01  0.00000000e+00]
 [-7.93217341e-03  1.81748925e-02]]
grads:  [-0.01255053  5.33162596]
Stock Position:  -0.01255052529599297
Bond Position:  [-6.2039955]


portfolio before change:  [-7.41729659]
curr_Stock_Price:  96.54973502556754
curr_Factors:  [9.65497350e+01 3.86780391e-02]
mat_Sqrt:  [[ 1.89881787e+01  0.00000000e+00]
 [-7.86669324e-03  1.80248586e-02]]
grads:  [4.77088179e-03 8.65437103e+00]
Stock Position:  0.0047708817852324835
Bond Position:  [-7.87792396]


portfolio before change:  [-7.41796551]
curr_Stock_Price:  96.82239046530326
curr_Factors:  [9.68223905e+01 3.62936944e-02]
mat_Sqrt:  [[ 1.84455407e+01  0.00000000e+00]
 [-7.62036161e-03  1.74604419e-02]]
grads:  [-0.01099728  1.64866375]
Stock Position:  -0.010997280771799385
Bond Position:  [-6.35318249]


portfolio before change:  [-7.42299682]
curr_Stock_Price:  97.13545130469936
curr_Factors:  [9.71354513e+01 3.47667636e-02]
mat_Sqrt:  [[ 1.81117283e+01  0.00000000e+00]
 [-7.45833907e-03  1.70892017e-02]]
grads:  [0.01175447 0.44685592]
Stock Position:  0.0117544671637925
Bond Position:  [-8.56477229]


portfolio before change:  [-7.4100099]
curr_Stock_Price:  98.42248354775487
curr_Factors:  [9.84224835e+01 3.47215708e-02]
mat_Sqrt:  [[ 1.83397750e+01  0.00000000e+00]
 [-7.45349001e-03  1.70780911e-02]]
grads:  [9.18387446e-04 3.90656355e+00]
Stock Position:  0.0009183874461156619
Bond Position:  [-7.50039988]


portfolio before change:  [-7.41165537]
curr_Stock_Price:  98.67277644470121
curr_Factors:  [9.86727764e+01 3.45657058e-02]
mat_Sqrt:  [[ 1.83450991e+01  0.00000000e+00]
 [-7.43674184e-03  1.70397162e-02]]
grads:  [-0.01144469  3.51806557]
Stock Position:  -0.01144469351776234
Bond Position:  [-6.28237569]


portfolio before change:  [-7.40117293]
curr_Stock_Price:  97.6196045289141
curr_Factors:  [9.76196045e+01 3.57070951e-02]
mat_Sqrt:  [[ 1.84465139e+01  0.00000000e+00]
 [-7.55852844e-03  1.73187644e-02]]
grads:  [-0.0050738   1.83098835]
Stock Position:  -0.005073798411461578
Bond Position:  [-6.90587074]


portfolio before change:  [-7.39946165]
curr_Stock_Price:  96.94201338131028
curr_Factors:  [9.69420134e+01 3.49523245e-02]
mat_Sqrt:  [[ 1.81238337e+01  0.00000000e+00]
 [-7.47821631e-03  1.71347462e-02]]
grads:  [-1.00944039e-02 -1.25819730e+01]
Stock Position:  -0.010094403893789159
Bond Position:  [-6.42088982]


portfolio before change:  [-7.389004]
curr_Stock_Price:  95.74698709955308
curr_Factors:  [9.57469871e+01 3.44018848e-02]
mat_Sqrt:  [[ 1.77589071e+01  0.00000000e+00]
 [-7.41909804e-03  1.69992892e-02]]
grads:  [-0.01435825 -8.09342577]
Stock Position:  -0.014358246604620255
Bond Position:  [-6.01424515]


portfolio before change:  [-7.3898791]
curr_Stock_Price:  95.70320385882003
curr_Factors:  [9.57032039e+01 3.17650570e-02]
mat_Sqrt:  [[ 1.70569469e+01  0.00000000e+00]
 [-7.12910171e-03  1.63348241e-02]]
grads:  [0.00636588 2.81077706]
Stock Position:  0.006365881720177336
Bond Position:  [-7.99911437]


portfolio before change:  [-7.38159051]
curr_Stock_Price:  97.31941643894294
curr_Factors:  [9.73194164e+01 3.00183472e-02]
mat_Sqrt:  [[ 1.68613710e+01  0.00000000e+00]
 [-6.93032146e-03  1.58793613e-02]]
grads:  [ 3.46866730e-04 -4.68325809e+00]
Stock Position:  0.00034686672969464063
Bond Position:  [-7.41534738]


portfolio before change:  [-7.38300371]
curr_Stock_Price:  98.59040936112103
curr_Factors:  [9.85904094e+01 3.06454433e-02]
mat_Sqrt:  [[ 1.72590793e+01  0.00000000e+00]
 [-7.00233598e-03  1.60443673e-02]]
grads:  [  0.02727515 -18.40101539]
Stock Position:  0.027275148863715945
Bond Position:  [-10.0720718]


portfolio before change:  [-7.33462745]
curr_Stock_Price:  100.45637883117799
curr_Factors:  [1.00456379e+02 3.04611862e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.33462745]
Stock Price:  99.5651697771947
PL:  [-7.33462745]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.57712398e-02  1.92304831e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.60831911e-01 -5.57942726e-01]
 [ 5.52302253e-02  1.84756572e-01]
 [-3.83563482e-01 -1.12250853e-01]
 [ 3.80641622e-01 -4.64277152e-01]
 [-5.48052870e-01  3.31072067e-01]
 [ 3.59347657e-01  1.60915590e-01]
 [-2.13307810e-02 -5.07854674e-02]
 [ 1.29919697e-01  1.71408860e-02]
 [ 2.09925139e-01  3.09273556e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.18033959e-01  1.36168547e-01]
 [-2.09643770e-01  6.67385771e-02]
 [ 2.28758921e-01  2.36004721e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.29994571e-02  1.72911437e-01]
 [ 2.31884667e-01 -1.30234411e-01]
 [ 1.03043751e-01  6.35465186e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.31241127]
curr_Stock_Price:  101.11758473542929
curr_Factors:  [1.01117585e+02 3.98745308e-02]
mat_Sqrt:  [[ 2.01917742e+01  0.00000000e+00]
 [-7.98744323e-03  1.83015316e-02]]
grads:  [2.88025553e-03 1.05075813e+01]
Stock Position:  0.002880255532672769
Bond Position:  [10.02116679]


portfolio before change:  [10.31251666]
curr_Stock_Price:  100.28424899440564
curr_Factors:  [1.00284249e+02 4.25514984e-02]
mat_Sqrt:  [[ 2.06866495e+01  0.00000000e+00]
 [-8.25120582e-03  1.89058876e-02]]
grads:  [-0.00900701 -3.52546104]
Stock Position:  -0.00900701056198776
Bond Position:  [11.21577795]


portfolio before change:  [10.31081316]
curr_Stock_Price:  100.78472498796336
curr_Factors:  [1.00784725e+02 4.26773758e-02]
mat_Sqrt:  [[ 2.08206157e+01  0.00000000e+00]
 [-8.26340131e-03  1.89338310e-02]]
grads:  [-1.94200828e-02 -2.94680314e+01]
Stock Position:  -0.019420082768095245
Bond Position:  [12.26806086]


portfolio before change:  [10.32865848]
curr_Stock_Price:  100.0237642555076
curr_Factors:  [1.00023764e+02 4.37228217e-02]
mat_Sqrt:  [[ 2.09149719e+01  0.00000000e+00]
 [-8.36400112e-03  1.91643341e-02]]
grads:  [6.49604526e-03 9.64064659e+00]
Stock Position:  0.006496045263784175
Bond Position:  [9.67889958]


portfolio before change:  [10.33079814]
curr_Stock_Price:  99.98060369657983
curr_Factors:  [9.99806037e+01 4.40225947e-02]
mat_Sqrt:  [[ 2.09774924e+01  0.00000000e+00]
 [-8.39262483e-03  1.92299193e-02]]
grads:  [-0.0206199  -5.83730235]
Stock Position:  -0.020619898780535603
Bond Position:  [12.39238806]


portfolio before change:  [10.32313823]
curr_Stock_Price:  100.50235149657486
curr_Factors:  [1.00502351e+02 4.39067649e-02]
mat_Sqrt:  [[ 2.10592036e+01  0.00000000e+00]
 [-8.38157646e-03  1.92046043e-02]]
grads:  [ 8.45304813e-03 -2.41753043e+01]
Stock Position:  0.008453048127035871
Bond Position:  [9.47358702]


portfolio before change:  [10.33451388]
curr_Stock_Price:  101.56787880129693
curr_Factors:  [1.01567879e+02 4.45531886e-02]
mat_Sqrt:  [[ 2.14385683e+01  0.00000000e+00]
 [-8.44305050e-03  1.93454590e-02]]
grads:  [-0.01882407 17.1136837 ]
Stock Position:  -0.0188240729949363
Bond Position:  [12.24643504]


portfolio before change:  [10.31663885]
curr_Stock_Price:  102.68012602418715
curr_Factors:  [1.02680126e+02 4.38176891e-02]
mat_Sqrt:  [[ 2.14936973e+01  0.00000000e+00]
 [-8.37307008e-03  1.91851137e-02]]
grads:  [0.01998618 8.38752338]
Stock Position:  0.01998618351809625
Bond Position:  [8.26445501]


portfolio before change:  [10.32703836]
curr_Stock_Price:  103.09707126905114
curr_Factors:  [1.03097071e+02 4.26295035e-02]
mat_Sqrt:  [[ 2.12863631e+01  0.00000000e+00]
 [-8.25876538e-03  1.89232088e-02]]
grads:  [-2.04334465e-03 -2.68376617e+00]
Stock Position:  -0.00204334465211748
Bond Position:  [10.53770121]


portfolio before change:  [10.32788986]
curr_Stock_Price:  103.96978450874238
curr_Factors:  [1.03969785e+02 4.12267755e-02]
mat_Sqrt:  [[ 2.11104178e+01  0.00000000e+00]
 [-8.12175109e-03  1.86092696e-02]]
grads:  [0.00650866 0.92109397]
Stock Position:  0.006508662899059242
Bond Position:  [9.65118559]


portfolio before change:  [10.33192362]
curr_Stock_Price:  104.21878452738869
curr_Factors:  [1.04218785e+02 3.95331806e-02]
mat_Sqrt:  [[ 2.07217716e+01  0.00000000e+00]
 [-7.95318106e-03  1.82230271e-02]]
grads:  [1.66444835e-02 1.69715797e+01]
Stock Position:  0.01664448348366374
Bond Position:  [8.59725578]


portfolio before change:  [10.36547705]
curr_Stock_Price:  106.10552654934149
curr_Factors:  [1.06105527e+02 3.92329189e-02]
mat_Sqrt:  [[ 2.10166414e+01  0.00000000e+00]
 [-7.92292056e-03  1.81536916e-02]]
grads:  [-0.00899325  6.29806469]
Stock Position:  -0.008993252534602961
Bond Position:  [11.31971084]


portfolio before change:  [10.35256878]
curr_Stock_Price:  107.85556677832005
curr_Factors:  [1.07855567e+02 3.84557152e-02]
mat_Sqrt:  [[ 2.11506156e+01  0.00000000e+00]
 [-7.84405152e-03  1.79729799e-02]]
grads:  [-2.77084764e-03  7.57629218e+00]
Stock Position:  -0.002770847641232301
Bond Position:  [10.65142012]


portfolio before change:  [10.35166819]
curr_Stock_Price:  109.14173355407384
curr_Factors:  [1.09141734e+02 3.74718569e-02]
mat_Sqrt:  [[ 2.11272735e+01  0.00000000e+00]
 [-7.74305954e-03  1.77415782e-02]]
grads:  [-0.00854425  3.76170464]
Stock Position:  -0.008544248091364448
Bond Position:  [11.28420224]


portfolio before change:  [10.36821675]
curr_Stock_Price:  107.53513757354708
curr_Factors:  [1.07535138e+02 3.95969836e-02]
mat_Sqrt:  [[ 2.13984072e+01  0.00000000e+00]
 [-7.95959634e-03  1.82377264e-02]]
grads:  [ 0.01550395 12.94046835]
Stock Position:  0.015503949564157878
Bond Position:  [8.7009974]


portfolio before change:  [10.35821919]
curr_Stock_Price:  106.7499776847574
curr_Factors:  [1.06749978e+02 3.94029499e-02]
mat_Sqrt:  [[ 2.11900588e+01  0.00000000e+00]
 [-7.94007052e-03  1.81929871e-02]]
grads:  [0.00453023 0.96361613]
Stock Position:  0.004530234260352427
Bond Position:  [9.87461679]


portfolio before change:  [10.35849855]
curr_Stock_Price:  106.26664569291502
curr_Factors:  [1.06266646e+02 3.89173167e-02]
mat_Sqrt:  [[ 2.09637232e+01  0.00000000e+00]
 [-7.89098896e-03  1.80805271e-02]]
grads:  [1.07162648e-03 9.56340686e+00]
Stock Position:  0.001071626476514304
Bond Position:  [10.2446204]


portfolio before change:  [10.35942677]
curr_Stock_Price:  104.74255978207732
curr_Factors:  [1.04742560e+02 3.84494089e-02]
mat_Sqrt:  [[ 2.05384666e+01  0.00000000e+00]
 [-7.84340833e-03  1.79715062e-02]]
grads:  [ 0.00852282 -7.24671654]
Stock Position:  0.008522822706007896
Bond Position:  [9.46672451]


portfolio before change:  [10.36299115]
curr_Stock_Price:  104.88305304669488
curr_Factors:  [1.04883053e+02 3.87346170e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.36299115]
Stock Price:  104.9222358413956
PL:  [5.44075531]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.64966297e-01 -5.86151052e-01]
 [ 2.53932876e-01 -1.30747184e-01]
 [-8.52503129e-02 -6.56628504e-02]
 [ 7.43941647e-01 -1.02732733e+00]
 [-6.07884607e-01  5.56514467e-01]
 [ 7.00632873e-01  1.87723245e-01]
 [ 1.92667996e-01 -1.59739693e-01]
 [-2.54832754e-02  2.55690120e-02]
 [ 3.96756384e-01  6.07546328e-01]
 [-2.14631510e-01  1.25813120e-01]
 [-1.58101239e-01  1.65768483e-01]
 [-1.88672454e-01  1.38568484e-01]
 [ 2.76323240e-01  4.27461953e-01]
 [-1.32651129e-02  1.14273935e-01]
 [-5.37779014e-02  4.40475788e-01]
 [ 2.10554063e-01  2.08564489e-01]
 [-6.89891056e-04 -2.72342782e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.683142]
curr_Stock_Price:  99.37639071123637
curr_Factors:  [9.93763907e+01 4.04815283e-02]
mat_Sqrt:  [[ 1.99945516e+01  0.00000000e+00]
 [-8.04800878e-03  1.84403047e-02]]
grads:  [ 0.00139396 -0.07325444]
Stock Position:  0.001393958621583929
Bond Position:  [-1.82166858]


portfolio before change:  [-1.68361583]
curr_Stock_Price:  99.36322434723641
curr_Factors:  [9.93632243e+01 4.08745483e-02]
mat_Sqrt:  [[ 2.00887151e+01  0.00000000e+00]
 [-8.08698197e-03  1.85296035e-02]]
grads:  [-0.0092751  -3.59705323]
Stock Position:  -0.009275101440436369
Bond Position:  [-0.76201184]


portfolio before change:  [-1.69464705]
curr_Stock_Price:  100.53201910947978
curr_Factors:  [1.00532019e+02 3.93115466e-02]
mat_Sqrt:  [[ 1.99326238e+01  0.00000000e+00]
 [-7.93085586e-03  1.81718736e-02]]
grads:  [-2.11102960e-02 -3.22559503e+01]
Stock Position:  -0.021110296015874518
Bond Position:  [0.42761364]


portfolio before change:  [-1.74608405]
curr_Stock_Price:  102.97366752450449
curr_Factors:  [1.02973668e+02 3.50613402e-02]
mat_Sqrt:  [[ 1.92814831e+01  0.00000000e+00]
 [-7.48986944e-03  1.71614468e-02]]
grads:  [ 0.01021032 -7.61865742]
Stock Position:  0.010210320717796728
Bond Position:  [-2.79747822]


portfolio before change:  [-1.72561322]
curr_Stock_Price:  105.0470883847804
curr_Factors:  [1.05047088e+02 3.32173505e-02]
mat_Sqrt:  [[ 1.91454912e+01  0.00000000e+00]
 [-7.29025108e-03  1.67040637e-02]]
grads:  [-0.0059496  -3.93095067]
Stock Position:  -0.0059495955910932
Bond Position:  [-1.10062552]


portfolio before change:  [-1.72462868]
curr_Stock_Price:  104.8353547553704
curr_Factors:  [1.04835355e+02 3.11397689e-02]
mat_Sqrt:  [[ 1.84997330e+01  0.00000000e+00]
 [-7.05858557e-03  1.61732513e-02]]
grads:  [ 1.59774869e-02 -6.35201485e+01]
Stock Position:  0.015977486948499292
Bond Position:  [-3.39963419]


portfolio before change:  [-1.72113398]
curr_Stock_Price:  105.10728203321722
curr_Factors:  [1.05107282e+02 3.15912333e-02]
mat_Sqrt:  [[ 1.86816872e+01  0.00000000e+00]
 [-7.10956914e-03  1.62900694e-02]]
grads:  [-1.95379452e-02  3.41628052e+01]
Stock Position:  -0.01953794519985013
Bond Position:  [0.33244634]


portfolio before change:  [-1.74013937]
curr_Stock_Price:  106.08427919869227
curr_Factors:  [1.06084279e+02 3.28123494e-02]
mat_Sqrt:  [[ 1.92162966e+01  0.00000000e+00]
 [-7.24567175e-03  1.66019196e-02]]
grads:  [ 0.04072387 11.30732163]
Stock Position:  0.04072387251111922
Bond Position:  [-6.06030203]


portfolio before change:  [-1.74282622]
curr_Stock_Price:  106.05551033792712
curr_Factors:  [1.06055510e+02 3.22676412e-02]
mat_Sqrt:  [[ 1.90509592e+01  0.00000000e+00]
 [-7.18527842e-03  1.64635411e-02]]
grads:  [ 6.45384184e-03 -9.70263275e+00]
Stock Position:  0.006453841840215354
Bond Position:  [-2.42729171]


portfolio before change:  [-1.73971439]
curr_Stock_Price:  106.6317134385883
curr_Factors:  [1.06631713e+02 2.98551217e-02]
mat_Sqrt:  [[ 1.84245042e+01  0.00000000e+00]
 [-6.91145388e-03  1.58361303e-02]]
grads:  [-7.77445271e-04  1.61459975e+00]
Stock Position:  -0.0007774452711931794
Bond Position:  [-1.65681407]


portfolio before change:  [-1.74284603]
curr_Stock_Price:  110.12698707050673
curr_Factors:  [1.10126987e+02 2.74413024e-02]
mat_Sqrt:  [[ 1.82429941e+01  0.00000000e+00]
 [-6.62616661e-03  1.51824550e-02]]
grads:  [3.6283043e-02 4.0016343e+01]
Stock Position:  0.036283043006331575
Bond Position:  [-5.73858824]


portfolio before change:  [-1.72271123]
curr_Stock_Price:  110.72146925513685
curr_Factors:  [1.10721469e+02 2.60753434e-02]
mat_Sqrt:  [[ 1.78791496e+01  0.00000000e+00]
 [-6.45914464e-03  1.47997596e-02]]
grads:  [-0.00893343  8.50102456]
Stock Position:  -0.008933431761380315
Bond Position:  [-0.73358854]


portfolio before change:  [-1.71420362]
curr_Stock_Price:  109.74860250976698
curr_Factors:  [1.09748603e+02 2.81845812e-02]
mat_Sqrt:  [[ 1.84248852e+01  0.00000000e+00]
 [-6.71530564e-03  1.53866982e-02]]
grads:  [-4.65424563e-03  1.07734928e+01]
Stock Position:  -0.004654245628374973
Bond Position:  [-1.20340666]


portfolio before change:  [-1.71658716]
curr_Stock_Price:  110.19607687189328
curr_Factors:  [1.10196077e+02 2.62172807e-02]
mat_Sqrt:  [[ 1.78426746e+01  0.00000000e+00]
 [-6.47670048e-03  1.48399851e-02]]
grads:  [-7.18480901e-03  9.33750831e+00]
Stock Position:  -0.007184809013217003
Bond Position:  [-0.92484939]


portfolio before change:  [-1.72394333]
curr_Stock_Price:  111.18774190201243
curr_Factors:  [1.11187742e+02 2.77305469e-02]
mat_Sqrt:  [[ 1.85155291e+01  0.00000000e+00]
 [-6.66099656e-03  1.52622605e-02]]
grads:  [2.49997139e-02 2.80077747e+01]
Stock Position:  0.024999713873031834
Bond Position:  [-4.50360506]


portfolio before change:  [-1.68128468]
curr_Stock_Price:  112.93914939313468
curr_Factors:  [1.12939149e+02 2.61072139e-02]
mat_Sqrt:  [[ 1.82483993e+01  0.00000000e+00]
 [-6.46309077e-03  1.48088013e-02]]
grads:  [2.00610041e-03 7.71662289e+00]
Stock Position:  0.002006100405317314
Bond Position:  [-1.90785196]


portfolio before change:  [-1.68186553]
curr_Stock_Price:  112.88739325603737
curr_Factors:  [1.12887393e+02 2.76490874e-02]
mat_Sqrt:  [[ 1.87709324e+01  0.00000000e+00]
 [-6.65120589e-03  1.52398272e-02]]
grads:  [7.37637800e-03 2.89029384e+01]
Stock Position:  0.0073763780032009224
Bond Position:  [-2.51456562]


portfolio before change:  [-1.67197432]
curr_Stock_Price:  114.31355807218469
curr_Factors:  [1.14313558e+02 2.69420930e-02]
mat_Sqrt:  [[ 1.87634808e+01  0.00000000e+00]
 [-6.56561869e-03  1.50437223e-02]]
grads:  [ 0.01607266 13.86388849]
Stock Position:  0.016072661107403585
Bond Position:  [-3.5092974]


portfolio before change:  [-1.68914873]
curr_Stock_Price:  113.29960206424379
curr_Factors:  [1.13299602e+02 2.73995082e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.68914873]
Stock Price:  115.07553646054006
PL:  [-16.76468519]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 5.40819006e-02  3.12304718e-01]
 [-1.28424234e-01 -5.76130945e-02]
 [-1.64127762e-01 -5.80429849e-01]
 [ 3.69335845e-02  2.12982057e-01]
 [-3.26663166e-01 -1.04504167e-01]
 [ 4.66016378e-01 -5.97322059e-01]
 [-5.23164087e-01  2.93441215e-01]
 [ 3.25052032e-01  1.58221699e-01]
 [-6.17354010e-02 -3.80001069e-02]
 [ 1.40947027e-01  1.65428297e-02]
 [ 2.43729942e-01  3.63242326e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.47792712e-01  1.58152999e-01]
 [-1.77778653e-01  1.75881386e-01]
 [ 2.55745132e-01  3.32614379e-01]
 [ 8.59156086e-02  1.98438446e-02]
 [-5.28444253e-02  2.26421233e-01]
 [ 1.05714748e-01  1.13539558e-01]
 [-2.84330313e-02 -1.83351856e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.01884202]
curr_Stock_Price:  101.94589193328585
curr_Factors:  [1.01945892e+02 3.71013538e-02]
mat_Sqrt:  [[ 1.96365238e+01  0.00000000e+00]
 [-7.70468468e-03  1.76536504e-02]]
grads:  [9.69534404e-03 1.76906595e+01]
Stock Position:  0.00969534404482938
Bond Position:  [15.03044153]


portfolio before change:  [16.0162588]
curr_Stock_Price:  101.29183569002174
curr_Factors:  [1.01291836e+02 3.72162032e-02]
mat_Sqrt:  [[ 1.95407161e+01  0.00000000e+00]
 [-7.71660062e-03  1.76809532e-02]]
grads:  [-0.00785891 -3.25848351]
Stock Position:  -0.00785890596999034
Bond Position:  [16.81230182]


portfolio before change:  [16.0261607]
curr_Stock_Price:  100.56676079413853
curr_Factors:  [1.00566761e+02 3.70693369e-02]
mat_Sqrt:  [[ 1.93625196e+01  0.00000000e+00]
 [-7.70135956e-03  1.76460316e-02]]
grads:  [-2.15595968e-02 -3.28929395e+01]
Stock Position:  -0.021559596810791146
Bond Position:  [18.19433952]


portfolio before change:  [16.04693395]
curr_Stock_Price:  99.81423752782887
curr_Factors:  [9.98142375e+01 3.72443187e-02]
mat_Sqrt:  [[ 1.92629373e+01  0.00000000e+00]
 [-7.71951487e-03  1.76876306e-02]]
grads:  [6.74282291e-03 1.20412995e+01]
Stock Position:  0.006742822914757485
Bond Position:  [15.37390422]


portfolio before change:  [16.05577234]
curr_Stock_Price:  100.55494108159363
curr_Factors:  [1.00554941e+02 3.56521659e-02]
mat_Sqrt:  [[ 1.89865639e+01  0.00000000e+00]
 [-7.55271246e-03  1.73054383e-02]]
grads:  [-0.01960716 -6.03880499]
Stock Position:  -0.019607156191238123
Bond Position:  [18.02736878]


portfolio before change:  [16.03843237]
curr_Stock_Price:  101.66919641218394
curr_Factors:  [1.01669196e+02 3.51179051e-02]
mat_Sqrt:  [[ 1.90525755e+01  0.00000000e+00]
 [-7.49590876e-03  1.71752847e-02]]
grads:  [ 1.07766879e-02 -3.47780006e+01]
Stock Position:  0.010776687865228887
Bond Position:  [14.94277517]


portfolio before change:  [16.03600931]
curr_Stock_Price:  101.09766426672971
curr_Factors:  [1.01097664e+02 3.49761769e-02]
mat_Sqrt:  [[ 1.89072031e+01  0.00000000e+00]
 [-7.48076755e-03  1.71405918e-02]]
grads:  [-0.02089658 17.11966651]
Stock Position:  -0.020896577800220202
Bond Position:  [18.14860451]


portfolio before change:  [16.01495385]
curr_Stock_Price:  102.32241842397187
curr_Factors:  [1.02322418e+02 3.31535778e-02]
mat_Sqrt:  [[ 1.86309928e+01  0.00000000e+00]
 [-7.28324958e-03  1.66880213e-02]]
grads:  [0.02115323 9.48115395]
Stock Position:  0.021153228230146603
Bond Position:  [13.85050438]


portfolio before change:  [16.027234]
curr_Stock_Price:  102.73923814168408
curr_Factors:  [1.02739238e+02 3.47452570e-02]
mat_Sqrt:  [[ 1.91506758e+01  0.00000000e+00]
 [-7.45603186e-03  1.70839152e-02]]
grads:  [-0.00408967 -2.22432074]
Stock Position:  -0.004089673283367333
Bond Position:  [16.44740391]


portfolio before change:  [16.02714429]
curr_Stock_Price:  103.76672202838245
curr_Factors:  [1.03766722e+02 3.32746730e-02]
mat_Sqrt:  [[ 1.89284475e+01  0.00000000e+00]
 [-7.29653869e-03  1.67184704e-02]]
grads:  [0.00782774 0.98949421]
Stock Position:  0.007827737025286328
Bond Position:  [15.21488567]


portfolio before change:  [16.04265442]
curr_Stock_Price:  105.26216481311911
curr_Factors:  [1.05262165e+02 3.30063696e-02]
mat_Sqrt:  [[ 1.91236672e+01  0.00000000e+00]
 [-7.26706208e-03  1.66509310e-02]]
grads:  [2.10347674e-02 2.18151360e+01]
Stock Position:  0.02103476739023766
Bond Position:  [13.82848926]


portfolio before change:  [16.02241319]
curr_Stock_Price:  104.13551687706587
curr_Factors:  [1.04135517e+02 3.47796688e-02]
mat_Sqrt:  [[ 1.94205532e+01  0.00000000e+00]
 [-7.45972319e-03  1.70923731e-02]]
grads:  [-0.00973237  6.68913108]
Stock Position:  -0.009732367637902348
Bond Position:  [17.03589833]


portfolio before change:  [15.97675667]
curr_Stock_Price:  109.26438484858271
curr_Factors:  [1.09264385e+02 3.31143991e-02]
mat_Sqrt:  [[ 1.98832359e+01  0.00000000e+00]
 [-7.27894488e-03  1.66781579e-02]]
grads:  [-3.96158276e-03  9.48264186e+00]
Stock Position:  -0.003961582762118968
Bond Position:  [16.40961658]


portfolio before change:  [15.97500598]
curr_Stock_Price:  110.74197819202749
curr_Factors:  [1.10741978e+02 3.08283846e-02]
mat_Sqrt:  [[ 1.94440917e+01  0.00000000e+00]
 [-7.02320549e-03  1.60921854e-02]]
grads:  [-5.19529144e-03  1.09296147e+01]
Stock Position:  -0.005195291440104846
Bond Position:  [16.55034283]


portfolio before change:  [15.9859751]
curr_Stock_Price:  109.42713090269075
curr_Factors:  [1.09427131e+02 3.13893211e-02]
mat_Sqrt:  [[ 1.93872394e+01  0.00000000e+00]
 [-7.08681266e-03  1.62379277e-02]]
grads:  [ 0.02067906 20.48379475]
Stock Position:  0.020679063108941596
Bond Position:  [13.72312455]


portfolio before change:  [15.96512051]
curr_Stock_Price:  108.25271584917262
curr_Factors:  [1.08252716e+02 3.11530608e-02]
mat_Sqrt:  [[ 1.91068530e+01  0.00000000e+00]
 [-7.06009187e-03  1.61767027e-02]]
grads:  [0.00494986 1.22669279]
Stock Position:  0.004949856077349186
Bond Position:  [15.42928514]


portfolio before change:  [15.96569002]
curr_Stock_Price:  107.58839577362802
curr_Factors:  [1.07588396e+02 3.12806931e-02]
mat_Sqrt:  [[ 1.90284588e+01  0.00000000e+00]
 [-7.07453948e-03  1.62098063e-02]]
grads:  [2.41606021e-03 1.39681640e+01]
Stock Position:  0.002416060210163538
Bond Position:  [15.70574998]


portfolio before change:  [15.97134165]
curr_Stock_Price:  108.30224633818816
curr_Factors:  [1.08302246e+02 3.15895678e-02]
mat_Sqrt:  [[ 1.92490503e+01  0.00000000e+00]
 [-7.10938172e-03  1.62896399e-02]]
grads:  [0.00806624 6.97004712]
Stock Position:  0.008066240754777783
Bond Position:  [15.09774966]


portfolio before change:  [15.97329626]
curr_Stock_Price:  108.07657671219503
curr_Factors:  [1.08076577e+02 3.15672968e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.97329626]
Stock Price:  108.18264229202019
PL:  [7.79065397]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.66622128e-01 -5.97448549e-01]
 [-2.14406279e-02  2.77383973e-01]
 [-4.41835219e-01 -1.21731037e-01]
 [ 2.47623304e-01 -2.71610556e-01]
 [-5.14217719e-01  2.57028518e-01]
 [ 2.76430084e-01  1.54402487e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.70945500e-01  8.80405207e-03]
 [ 1.74936828e-01  2.53415338e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-6.11501559e-02  9.41453067e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 1.64746847e-01  3.85627460e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.22419014e-02  8.77973806e-02]
 [ 3.31166441e-01 -2.16226930e-01]
 [ 1.38459431e-01  3.60739492e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.46037891]
curr_Stock_Price:  98.97326563712318
curr_Factors:  [9.89732656e+01 4.02760568e-02]
mat_Sqrt:  [[ 1.98628413e+01  0.00000000e+00]
 [-8.02755821e-03  1.83934466e-02]]
grads:  [ 0.0014032  -0.07344106]
Stock Position:  0.0014032019495490591
Bond Position:  [-4.59925839]


portfolio before change:  [-4.46108254]
curr_Stock_Price:  99.29134496570977
curr_Factors:  [9.92913450e+01 4.04212562e-02]
mat_Sqrt:  [[ 1.99625629e+01  0.00000000e+00]
 [-8.04201529e-03  1.84265719e-02]]
grads:  [-0.00933371 -3.61716604]
Stock Position:  -0.00933371488552409
Bond Position:  [-3.53432543]


portfolio before change:  [-4.47280854]
curr_Stock_Price:  100.4529738151009
curr_Factors:  [1.00452974e+02 4.18895466e-02]
mat_Sqrt:  [[ 2.05596458e+01  0.00000000e+00]
 [-8.18677437e-03  1.87582566e-02]]
grads:  [-2.07868392e-02 -3.18498974e+01]
Stock Position:  -0.020786839242822396
Bond Position:  [-2.38470872]


portfolio before change:  [-4.44276983]
curr_Stock_Price:  98.97920669703362
curr_Factors:  [9.89792067e+01 4.14884237e-02]
mat_Sqrt:  [[ 2.01607849e+01  0.00000000e+00]
 [-8.14748292e-03  1.86682286e-02]]
grads:  [4.94125914e-03 1.48586124e+01]
Stock Position:  0.004941259137571631
Bond Position:  [-4.93185174]


portfolio before change:  [-4.44219101]
curr_Stock_Price:  99.3459032009458
curr_Factors:  [9.93459032e+01 4.23502517e-02]
mat_Sqrt:  [[ 2.04445691e+01  0.00000000e+00]
 [-8.23167072e-03  1.88611271e-02]]
grads:  [-0.02421    -6.45407012]
Stock Position:  -0.024209999139187935
Bond Position:  [-2.03702678]


portfolio before change:  [-4.43864163]
curr_Stock_Price:  99.1782575521406
curr_Factors:  [9.91782576e+01 3.96006208e-02]
mat_Sqrt:  [[ 1.97363788e+01  0.00000000e+00]
 [-7.95996189e-03  1.82385639e-02]]
grads:  [ 6.54034567e-03 -1.48921021e+01]
Stock Position:  0.006540345670786561
Bond Position:  [-5.08730171]


portfolio before change:  [-4.43119712]
curr_Stock_Price:  100.51098320033391
curr_Factors:  [1.00510983e+02 3.82206202e-02]
mat_Sqrt:  [[ 1.96499924e+01  0.00000000e+00]
 [-7.82003787e-03  1.79179577e-02]]
grads:  [-0.02046012 14.34474408]
Stock Position:  -0.02046012381277276
Bond Position:  [-2.37472996]


portfolio before change:  [-4.4590675]
curr_Stock_Price:  101.84414344129334
curr_Factors:  [1.01844143e+02 3.97722027e-02]
mat_Sqrt:  [[ 2.03107463e+01  0.00000000e+00]
 [-7.97718775e-03  1.82780333e-02]]
grads:  [0.01692783 8.44743438]
Stock Position:  0.01692782967182892
Bond Position:  [-6.18306782]


portfolio before change:  [-4.47432112]
curr_Stock_Price:  101.03437323638943
curr_Factors:  [1.01034373e+02 3.81204672e-02]
mat_Sqrt:  [[ 1.97264193e+01  0.00000000e+00]
 [-7.80978537e-03  1.78944663e-02]]
grads:  [-0.01102992 -2.97013112]
Stock Position:  -0.011029922247943582
Bond Position:  [-3.35991984]


portfolio before change:  [-4.48153059]
curr_Stock_Price:  101.61183777431067
curr_Factors:  [1.01611838e+02 3.47586241e-02]
mat_Sqrt:  [[ 1.89441705e+01  0.00000000e+00]
 [-7.45746596e-03  1.70872011e-02]]
grads:  [0.01450514 0.51524249]
Stock Position:  0.014505143032507961
Bond Position:  [-5.95542483]


portfolio before change:  [-4.46190381]
curr_Stock_Price:  103.06758494592944
curr_Factors:  [1.03067585e+02 3.42224145e-02]
mat_Sqrt:  [[ 1.90667830e+01  0.00000000e+00]
 [-7.39972049e-03  1.69548896e-02]]
grads:  [ 0.01497559 14.94644573]
Stock Position:  0.014975591258511679
Bond Position:  [-6.00540184]


portfolio before change:  [-4.45190126]
curr_Stock_Price:  103.83577460366223
curr_Factors:  [1.03835775e+02 3.13812897e-02]
mat_Sqrt:  [[ 1.83942634e+01  0.00000000e+00]
 [-7.08590597e-03  1.62358502e-02]]
grads:  [-0.01027538  7.04201641]
Stock Position:  -0.010275375527876255
Bond Position:  [-3.38494968]


portfolio before change:  [-4.46615559]
curr_Stock_Price:  105.14064060043032
curr_Factors:  [1.05140641e+02 3.08652075e-02]
mat_Sqrt:  [[ 1.84716299e+01  0.00000000e+00]
 [-7.02739867e-03  1.61017932e-02]]
grads:  [-1.08608582e-03  5.84688337e+00]
Stock Position:  -0.0010860858240070762
Bond Position:  [-4.35196383]


portfolio before change:  [-4.46573935]
curr_Stock_Price:  103.75552041800087
curr_Factors:  [1.03755520e+02 3.17350627e-02]
mat_Sqrt:  [[ 1.84833588e+01  0.00000000e+00]
 [-7.12573507e-03  1.63271102e-02]]
grads:  [ -0.02222759 -15.27945759]
Stock Position:  -0.02222759329693505
Bond Position:  [-2.15950384]


portfolio before change:  [-4.46203159]
curr_Stock_Price:  103.56441968357709
curr_Factors:  [1.03564420e+02 3.00043667e-02]
mat_Sqrt:  [[ 1.79391891e+01  0.00000000e+00]
 [-6.92870744e-03  1.58756632e-02]]
grads:  [0.01012181 2.42904789]
Stock Position:  0.01012180697564756
Bond Position:  [-5.51029065]


portfolio before change:  [-4.464364]
curr_Stock_Price:  103.47010172143676
curr_Factors:  [1.03470102e+02 3.15804371e-02]
mat_Sqrt:  [[ 1.83875533e+01  0.00000000e+00]
 [-7.10835419e-03  1.62872856e-02]]
grads:  [0.0052207  1.07636448]
Stock Position:  0.005220701676182922
Bond Position:  [-5.00455054]


portfolio before change:  [-4.46203063]
curr_Stock_Price:  104.1567274341931
curr_Factors:  [1.04156727e+02 3.36672835e-02]
mat_Sqrt:  [[ 1.91113499e+01  0.00000000e+00]
 [-7.33945868e-03  1.68168125e-02]]
grads:  [-7.28571403e-04  5.22080988e+00]
Stock Position:  -0.0007285714030089066
Bond Position:  [-4.38614502]


portfolio before change:  [-4.46217695]
curr_Stock_Price:  102.85232398256194
curr_Factors:  [1.02852324e+02 3.55993033e-02]
mat_Sqrt:  [[ 1.94059478e+01  0.00000000e+00]
 [-7.54711105e-03  1.72926038e-02]]
grads:  [ 1.22023039e-02 -1.25040122e+01]
Stock Position:  0.01220230387205811
Bond Position:  [-5.71721226]


portfolio before change:  [-4.45269229]
curr_Stock_Price:  103.7467566783503
curr_Factors:  [1.03746757e+02 3.72107379e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.45269229]
Stock Price:  105.5389976976107
PL:  [-9.99168999]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.04982481e-01 -8.59175775e-01]
 [-1.21148842e-02  2.78361243e-01]
 [-4.24510415e-01 -5.49366360e-02]
 [-3.80312274e-02  1.05880530e-01]
 [-3.33882799e-01  1.25969981e-01]
 [ 2.40138941e-02  1.54094474e-01]
 [-2.18992181e-01  4.27269965e-02]
 [ 1.61693931e-01  1.06358573e-02]
 [-1.04488803e-01 -4.59302956e-02]
 [-1.59818806e-01  3.52906977e-02]
 [ 8.54229493e-02 -8.00171542e-03]
 [ 7.68277257e-02 -2.40441522e-02]
 [-2.58889818e-01 -1.17641038e-01]
 [ 8.85937912e-02  2.45842543e-02]
 [ 2.29435389e-02 -5.44955107e-02]
 [ 1.24479395e+00 -5.63628714e-01]
 [ 2.16083057e-01  2.36339955e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.39919475]
curr_Stock_Price:  97.8209203981786
curr_Factors:  [9.78209204e+01 4.05532075e-02]
mat_Sqrt:  [[ 1.96990077e+01  0.00000000e+00]
 [-8.05513079e-03  1.84566233e-02]]
grads:  [ 0.00141487 -0.07318968]
Stock Position:  0.0014148721629432463
Bond Position:  [-12.53759885]


portfolio before change:  [-12.40045361]
curr_Stock_Price:  99.14678952235641
curr_Factors:  [9.91467895e+01 4.05326821e-02]
mat_Sqrt:  [[ 1.99609555e+01  0.00000000e+00]
 [-8.05309203e-03  1.84519519e-02]]
grads:  [-0.00933447 -3.61219076]
Stock Position:  -0.009334466478402062
Bond Position:  [-11.47497122]


portfolio before change:  [-12.3963975]
curr_Stock_Price:  98.40489239824625
curr_Factors:  [9.84048924e+01 4.09689563e-02]
mat_Sqrt:  [[ 1.99179272e+01  0.00000000e+00]
 [-8.09631583e-03  1.85509901e-02]]
grads:  [-2.91173637e-02 -4.63142814e+01]
Stock Position:  -0.029117363700211625
Bond Position:  [-9.53110645]


portfolio before change:  [-12.31867325]
curr_Stock_Price:  95.65370501580571
curr_Factors:  [9.56537050e+01 4.18094086e-02]
mat_Sqrt:  [[ 1.95586470e+01  0.00000000e+00]
 [-8.17893965e-03  1.87403050e-02]]
grads:  [5.59199837e-03 1.48536133e+01]
Stock Position:  0.005591998371054804
Bond Position:  [-12.85356861]


portfolio before change:  [-12.31706534]
curr_Stock_Price:  96.51595563587557
curr_Factors:  [9.65159556e+01 4.37974521e-02]
mat_Sqrt:  [[ 2.01987055e+01  0.00000000e+00]
 [-8.37113632e-03  1.91806829e-02]]
grads:  [-0.02220374 -2.86416475]
Stock Position:  -0.02220373614630814
Bond Position:  [-10.17405052]


portfolio before change:  [-12.33123907]
curr_Stock_Price:  97.03973693531307
curr_Factors:  [9.70397369e+01 4.32982694e-02]
mat_Sqrt:  [[ 2.01922577e+01  0.00000000e+00]
 [-8.32329448e-03  1.90710635e-02]]
grads:  [4.05047543e-04 5.55189437e+00]
Stock Position:  0.0004050475426553636
Bond Position:  [-12.37054478]


portfolio before change:  [-12.33433271]
curr_Stock_Price:  97.03820814675045
curr_Factors:  [9.70382081e+01 4.23797516e-02]
mat_Sqrt:  [[ 1.99766183e+01  0.00000000e+00]
 [-8.23453718e-03  1.88676950e-02]]
grads:  [-0.01396157  6.67649021]
Stock Position:  -0.013961571875044964
Bond Position:  [-10.97952679]


portfolio before change:  [-12.32767866]
curr_Stock_Price:  96.36498312789874
curr_Factors:  [9.63649831e+01 4.30056702e-02]
mat_Sqrt:  [[ 1.99839857e+01  0.00000000e+00]
 [-8.29512340e-03  1.90065154e-02]]
grads:  [4.56696864e-03 8.10745526e+00]
Stock Position:  0.0045669686439181335
Bond Position:  [-12.76777451]


portfolio before change:  [-12.33090738]
curr_Stock_Price:  96.35701641532097
curr_Factors:  [9.63570164e+01 4.27927090e-02]
mat_Sqrt:  [[ 1.99327966e+01  0.00000000e+00]
 [-8.27455947e-03  1.89593976e-02]]
grads:  [-0.010051    2.25360518]
Stock Position:  -0.010051002658171689
Bond Position:  [-11.36242275]


portfolio before change:  [-12.32312028]
curr_Stock_Price:  95.29960360578401
curr_Factors:  [9.52996036e+01 4.42079297e-02]
mat_Sqrt:  [[ 2.00373914e+01  0.00000000e+00]
 [-8.41027274e-03  1.92703557e-02]]
grads:  [0.00830127 0.55192844]
Stock Position:  0.008301270157150343
Bond Position:  [-13.11422804]


portfolio before change:  [-12.33831638]
curr_Stock_Price:  93.86402482276559
curr_Factors:  [9.38640248e+01 4.39927576e-02]
mat_Sqrt:  [[ 1.96874635e+01  0.00000000e+00]
 [-8.38978022e-03  1.92234015e-02]]
grads:  [-0.00632557 -2.38929077]
Stock Position:  -0.006325569971508315
Bond Position:  [-11.74457292]


portfolio before change:  [-12.35068066]
curr_Stock_Price:  95.35444695358026
curr_Factors:  [9.53544470e+01 4.19368757e-02]
mat_Sqrt:  [[ 1.95271556e+01  0.00000000e+00]
 [-8.19139799e-03  1.87688507e-02]]
grads:  [-0.00739568  1.88028017]
Stock Position:  -0.00739568454036108
Bond Position:  [-11.64546925]


portfolio before change:  [-12.34456714]
curr_Stock_Price:  94.13410742084783
curr_Factors:  [9.41341074e+01 4.25039636e-02]
mat_Sqrt:  [[ 1.94071483e+01  0.00000000e+00]
 [-8.24659577e-03  1.88953247e-02]]
grads:  [ 0.00422168 -0.42347594]
Stock Position:  0.004221677143168488
Bond Position:  [-12.74197095]


portfolio before change:  [-12.35388895]
curr_Stock_Price:  92.68067710503645
curr_Factors:  [9.26806771e+01 4.25355798e-02]
mat_Sqrt:  [[ 1.91146071e+01  0.00000000e+00]
 [-8.24966227e-03  1.89023509e-02]]
grads:  [ 0.00347033 -1.27201914]
Stock Position:  0.003470330146974903
Bond Position:  [-12.6755215]


portfolio before change:  [-12.35499362]
curr_Stock_Price:  93.27560657717561
curr_Factors:  [9.32756066e+01 4.36759364e-02]
mat_Sqrt:  [[ 1.94934718e+01  0.00000000e+00]
 [-8.35951543e-03  1.91540561e-02]]
grads:  [-0.01591469 -6.14183423]
Stock Position:  -0.015914690757588966
Bond Position:  [-10.87054119]


portfolio before change:  [-12.34318426]
curr_Stock_Price:  92.36278095435038
curr_Factors:  [9.23627810e+01 4.50072466e-02]
mat_Sqrt:  [[ 1.95946822e+01  0.00000000e+00]
 [-8.48596456e-03  1.94437875e-02]]
grads:  [0.00506889 1.2643758 ]
Stock Position:  0.005068887497170769
Bond Position:  [-12.81136081]


portfolio before change:  [-12.34934836]
curr_Stock_Price:  91.77865672839542
curr_Factors:  [9.17786567e+01 4.46965916e-02]
mat_Sqrt:  [[ 1.94034475e+01  0.00000000e+00]
 [-8.45662738e-03  1.93765675e-02]]
grads:  [-4.33042561e-05 -2.81244398e+00]
Stock Position:  -4.330425605212213e-05
Bond Position:  [-12.34537395]


portfolio before change:  [-12.35243269]
curr_Stock_Price:  91.7232284674247
curr_Factors:  [9.17232285e+01 4.32067212e-02]
mat_Sqrt:  [[ 1.90657980e+01  0.00000000e+00]
 [-8.31449059e-03  1.90508913e-02]]
grads:  [  0.05238733 -29.58542496]
Stock Position:  0.05238732784325103
Bond Position:  [-17.15756753]


portfolio before change:  [-12.40822707]
curr_Stock_Price:  90.74008133471263
curr_Factors:  [9.07400813e+01 4.11758064e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.40822707]
Stock Price:  90.14964134938242
PL:  [-12.40822707]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.01172068e-01 -8.33177876e-01]
 [ 7.30712623e-02  1.57179727e-01]
 [-4.07288541e-01 -7.88990052e-02]
 [-2.99953848e-02  9.03325644e-02]
 [-2.57865607e-01  8.42879501e-02]
 [ 2.28761403e-02  1.55530514e-01]
 [-2.12116984e-01  1.59396954e-02]
 [ 2.31689305e-01  6.24979909e-03]
 [ 1.22817306e-03  7.89326550e-02]
 [-1.76440741e-01  4.51531017e-02]
 [-2.66597698e-03  7.44160258e-03]
 [-3.86843973e-02 -1.91962566e-01]
 [-2.03081289e-01 -1.35779566e-01]
 [ 8.81118987e-02  4.69235653e-02]
 [ 5.96815984e-02 -7.93804910e-02]
 [ 8.93229037e-01 -4.17698698e-01]
 [ 1.49861128e-01  1.56832870e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.25491179]
curr_Stock_Price:  98.8579365758575
curr_Factors:  [9.88579366e+01 4.11498222e-02]
mat_Sqrt:  [[ 2.00537466e+01  0.00000000e+00]
 [-8.11416758e-03  1.85918936e-02]]
grads:  [ 0.00138984 -0.07265716]
Stock Position:  0.0013898439110752855
Bond Position:  [-5.39230889]


portfolio before change:  [-5.25873753]
curr_Stock_Price:  97.0753617724885
curr_Factors:  [9.70753618e+01 4.16992456e-02]
mat_Sqrt:  [[ 1.98231705e+01  0.00000000e+00]
 [-8.16815726e-03  1.87155995e-02]]
grads:  [-0.00939935 -3.56130565]
Stock Position:  -0.009399347595806936
Bond Position:  [-4.34629246]


portfolio before change:  [-5.2742033]
curr_Stock_Price:  98.60515490242574
curr_Factors:  [9.86051549e+01 4.12901274e-02]
mat_Sqrt:  [[ 2.00365402e+01  0.00000000e+00]
 [-8.12798892e-03  1.86235622e-02]]
grads:  [-2.81885346e-02 -4.47378362e+01]
Stock Position:  -0.02818853458371653
Bond Position:  [-2.49466848]


portfolio before change:  [-5.32074797]
curr_Stock_Price:  100.23421872565889
curr_Factors:  [1.00234219e+02 4.10633878e-02]
mat_Sqrt:  [[ 2.03115655e+01  0.00000000e+00]
 [-8.10564128e-03  1.85723574e-02]]
grads:  [6.97484981e-03 8.46310048e+00]
Stock Position:  0.006974849810417549
Bond Position:  [-6.01986659]


portfolio before change:  [-5.33666502]
curr_Stock_Price:  98.16795200317453
curr_Factors:  [9.81679520e+01 4.28200749e-02]
mat_Sqrt:  [[ 2.03139062e+01  0.00000000e+00]
 [-8.27720483e-03  1.89654588e-02]]
grads:  [-0.02174485 -4.16014217]
Stock Position:  -0.021744852338075004
Bond Position:  [-3.2020174]


portfolio before change:  [-5.32262072]
curr_Stock_Price:  97.48526628785446
curr_Factors:  [9.74852663e+01 4.51337326e-02]
mat_Sqrt:  [[ 2.07104535e+01  0.00000000e+00]
 [-8.49788045e-03  1.94710902e-02]]
grads:  [4.55276288e-04 4.63931723e+00]
Stock Position:  0.00045527628838705454
Bond Position:  [-5.36700345]


portfolio before change:  [-5.32504188]
curr_Stock_Price:  95.11476413079008
curr_Factors:  [9.51147641e+01 4.52844724e-02]
mat_Sqrt:  [[ 2.02405631e+01  0.00000000e+00]
 [-8.51205943e-03  1.95035783e-02]]
grads:  [-0.01092259  4.32166593]
Stock Position:  -0.010922587873342004
Bond Position:  [-4.28614251]


portfolio before change:  [-5.34146252]
curr_Stock_Price:  96.52001472604539
curr_Factors:  [9.65200147e+01 4.33062269e-02]
mat_Sqrt:  [[ 2.00859581e+01  0.00000000e+00]
 [-8.32405928e-03  1.90728159e-02]]
grads:  [4.51834166e-03 8.15456483e+00]
Stock Position:  0.004518341660768618
Bond Position:  [-5.77757292]


portfolio before change:  [-5.34030263]
curr_Stock_Price:  97.09643390123406
curr_Factors:  [9.70964339e+01 4.18741551e-02]
mat_Sqrt:  [[ 1.98690137e+01  0.00000000e+00]
 [-8.18527019e-03  1.87548101e-02]]
grads:  [-0.01032564  0.84989905]
Stock Position:  -0.010325642448617316
Bond Position:  [-4.33771957]


portfolio before change:  [-5.3515451]
curr_Stock_Price:  98.0801888307416
curr_Factors:  [9.80801888e+01 4.32107485e-02]
mat_Sqrt:  [[ 2.03881203e+01  0.00000000e+00]
 [-8.31487809e-03  1.90517791e-02]]
grads:  [0.01149772 0.32804281]
Stock Position:  0.011497722073109473
Bond Position:  [-6.47924385]


portfolio before change:  [-5.34632278]
curr_Stock_Price:  98.67529255691751
curr_Factors:  [9.86752926e+01 4.21825153e-02]
mat_Sqrt:  [[ 2.02663090e+01  0.00000000e+00]
 [-8.21535298e-03  1.88237384e-02]]
grads:  [1.76041962e-03 4.19325073e+00]
Stock Position:  0.0017604196212383848
Bond Position:  [-5.5200327]


portfolio before change:  [-5.35249102]
curr_Stock_Price:  95.95545403584379
curr_Factors:  [9.59554540e+01 4.24054919e-02]
mat_Sqrt:  [[ 1.97597169e+01  0.00000000e+00]
 [-8.23703752e-03  1.88734240e-02]]
grads:  [-0.00793201  2.39241707]
Stock Position:  -0.007932012005658363
Bond Position:  [-4.5913712]


portfolio before change:  [-5.34836837]
curr_Stock_Price:  95.29097855364606
curr_Factors:  [9.52909786e+01 4.36329165e-02]
mat_Sqrt:  [[ 1.99048499e+01  0.00000000e+00]
 [-8.35539744e-03  1.91446206e-02]]
grads:  [2.92292910e-05 3.88704625e-01]
Stock Position:  2.9229290975113505e-05
Bond Position:  [-5.35115366]


portfolio before change:  [-5.34970717]
curr_Stock_Price:  95.26227014396363
curr_Factors:  [9.52622701e+01 4.47590980e-02]
mat_Sqrt:  [[ 2.01540156e+01  0.00000000e+00]
 [-8.46253844e-03  1.93901115e-02]]
grads:  [-6.07639351e-03 -9.90002382e+00]
Stock Position:  -0.00607639351249844
Bond Position:  [-4.77085613]


portfolio before change:  [-5.35281129]
curr_Stock_Price:  95.57680888723048
curr_Factors:  [9.55768089e+01 4.42333535e-02]
mat_Sqrt:  [[ 2.01014534e+01  0.00000000e+00]
 [-8.41269075e-03  1.92758961e-02]]
grads:  [-0.01305082 -7.04400799]
Stock Position:  -0.01305081503033947
Bond Position:  [-4.10545604]


portfolio before change:  [-5.3549842]
curr_Stock_Price:  95.66465120387552
curr_Factors:  [9.56646512e+01 4.33501487e-02]
mat_Sqrt:  [[ 1.99180486e+01  0.00000000e+00]
 [-8.32827941e-03  1.90824854e-02]]
grads:  [0.00545189 2.45898604]
Stock Position:  0.00545189057131877
Bond Position:  [-5.87653741]


portfolio before change:  [-5.36615657]
curr_Stock_Price:  93.88489186536563
curr_Factors:  [9.38848919e+01 4.40427817e-02]
mat_Sqrt:  [[ 1.97030328e+01  0.00000000e+00]
 [-8.39454887e-03  1.92343278e-02]]
grads:  [ 1.27072375e-03 -4.12702184e+00]
Stock Position:  0.001270723754611847
Bond Position:  [-5.48545833]


portfolio before change:  [-5.36554453]
curr_Stock_Price:  95.44587563228555
curr_Factors:  [9.54458756e+01 4.70806800e-02]
mat_Sqrt:  [[ 2.07099252e+01  0.00000000e+00]
 [-8.67923315e-03  1.98866214e-02]]
grads:  [  0.034328  -21.0040051]
Stock Position:  0.03432800324668803
Bond Position:  [-8.64201086]


portfolio before change:  [-5.36696154]
curr_Stock_Price:  95.46754190514964
curr_Factors:  [9.54675419e+01 4.61475303e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.36696154]
Stock Price:  94.17037556239708
PL:  [-5.36696154]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 4.96302050e-02  3.05614900e-01]
 [ 2.12246951e-01  6.51433308e-04]
 [-1.03474626e-01 -1.66602134e-01]
 [ 3.28660595e-01 -2.55880042e-01]
 [-1.03641715e-01 -7.33474228e-02]
 [ 5.62825915e-01 -7.47100345e-01]
 [-5.97817617e-01  5.23763518e-01]
 [ 8.10247053e-01  1.96333343e-01]
 [ 3.11760015e-01 -2.05094116e-01]
 [-2.10586138e-01  3.55004465e-02]
 [ 3.70122254e-01  5.65025412e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.04142398e-01  1.25906076e-01]
 [-2.27669200e-01  4.99877117e-03]
 [ 2.46245151e-01  2.89921171e-01]
 [ 6.30421331e-02  4.16217096e-02]
 [-5.39910006e-02  3.68084137e-01]
 [ 1.20110104e-01  1.41124537e-01]
 [ 3.78861767e-03 -1.31304260e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.70116768]
curr_Stock_Price:  101.89978045724963
curr_Factors:  [1.0189978e+02 3.7390294e-02]
mat_Sqrt:  [[ 1.97039224e+01  0.00000000e+00]
 [-7.73462801e-03  1.77222592e-02]]
grads:  [9.28807366e-03 1.72446920e+01]
Stock Position:  0.00928807365838626
Bond Position:  [14.75471501]


portfolio before change:  [15.7232043]
curr_Stock_Price:  103.87516095320493
curr_Factors:  [1.03875161e+02 3.64814014e-02]
mat_Sqrt:  [[ 1.98402649e+01  0.00000000e+00]
 [-7.64004203e-03  1.75055355e-02]]
grads:  [0.01071212 0.03721299]
Stock Position:  0.010712118054657296
Bond Position:  [14.61048131]


portfolio before change:  [15.72796911]
curr_Stock_Price:  103.97894383761336
curr_Factors:  [1.03978944e+02 3.41719819e-02]
mat_Sqrt:  [[ 1.92211995e+01  0.00000000e+00]
 [-7.39426610e-03  1.69423920e-02]]
grads:  [-9.16622079e-03 -9.83344816e+00]
Stock Position:  -0.009166220793663185
Bond Position:  [16.68106307]


portfolio before change:  [15.72685667]
curr_Stock_Price:  104.55532448482009
curr_Factors:  [1.04555324e+02 3.50069588e-02]
mat_Sqrt:  [[ 1.95624545e+01  0.00000000e+00]
 [-7.48405866e-03  1.71481327e-02]]
grads:  [ 1.10919307e-02 -1.49217438e+01]
Stock Position:  0.01109193066395937
Bond Position:  [14.56713626]


portfolio before change:  [15.72179062]
curr_Stock_Price:  103.77022339010097
curr_Factors:  [1.03770223e+02 3.40297907e-02]
mat_Sqrt:  [[ 1.91426646e+01  0.00000000e+00]
 [-7.37886611e-03  1.69071063e-02]]
grads:  [-0.00708643 -4.33826   ]
Stock Position:  -0.007086430106171935
Bond Position:  [16.45715105]


portfolio before change:  [15.73295288]
curr_Stock_Price:  102.77572277648873
curr_Factors:  [1.02775723e+02 3.26385123e-02]
mat_Sqrt:  [[ 1.85675977e+01  0.00000000e+00]
 [-7.22645277e-03  1.65578834e-02]]
grads:  [ 1.27514930e-02 -4.51205221e+01]
Stock Position:  0.012751493032936222
Bond Position:  [14.42240897]


portfolio before change:  [15.7602611]
curr_Stock_Price:  104.63449889750967
curr_Factors:  [1.04634499e+02 3.02544721e-02]
mat_Sqrt:  [[ 1.81999288e+01  0.00000000e+00]
 [-6.95752508e-03  1.59416927e-02]]
grads:  [-2.02873583e-02  3.28549502e+01]
Stock Position:  -0.020287358342889906
Bond Position:  [17.88301868]


portfolio before change:  [15.71314464]
curr_Stock_Price:  107.17735225966018
curr_Factors:  [1.07177352e+02 2.90706490e-02]
mat_Sqrt:  [[ 1.82738640e+01  0.00000000e+00]
 [-6.82004680e-03  1.56266904e-02]]
grads:  [ 0.04902816 12.56397472]
Stock Position:  0.04902816123332456
Bond Position:  [10.45843613]


portfolio before change:  [15.76026245]
curr_Stock_Price:  108.08505251191148
curr_Factors:  [1.08085053e+02 2.87129994e-02]
mat_Sqrt:  [[ 1.83149155e+01  0.00000000e+00]
 [-6.77796422e-03  1.55302670e-02]]
grads:  [ 1.21348965e-02 -1.32060907e+01]
Stock Position:  0.012134896532132724
Bond Position:  [14.44866152]


portfolio before change:  [15.78870442]
curr_Stock_Price:  110.13116450769616
curr_Factors:  [1.10131165e+02 3.08664420e-02]
mat_Sqrt:  [[ 1.93487769e+01  0.00000000e+00]
 [-7.02753920e-03  1.61021152e-02]]
grads:  [-0.01008294  2.20470703]
Stock Position:  -0.010082935664348827
Bond Position:  [16.89914987]


portfolio before change:  [15.80126603]
curr_Stock_Price:  109.30439207270058
curr_Factors:  [1.09304392e+02 3.24928428e-02]
mat_Sqrt:  [[ 1.97029596e+01  0.00000000e+00]
 [-7.21030849e-03  1.65208922e-02]]
grads:  [3.13008589e-02 3.42006596e+01]
Stock Position:  0.03130085893621304
Bond Position:  [12.37994468]


portfolio before change:  [15.73541804]
curr_Stock_Price:  107.10178905253021
curr_Factors:  [1.07101789e+02 3.32825982e-02]
mat_Sqrt:  [[ 1.95391351e+01  0.00000000e+00]
 [-7.29740756e-03  1.67204613e-02]]
grads:  [-0.0096733   6.83791685]
Stock Position:  -0.009673302454272273
Bond Position:  [16.77144604]


portfolio before change:  [15.73876695]
curr_Stock_Price:  107.18908856027645
curr_Factors:  [1.07189089e+02 3.37928741e-02]
mat_Sqrt:  [[ 1.97043968e+01  0.00000000e+00]
 [-7.35313529e-03  1.68481495e-02]]
grads:  [-2.49652311e-03  7.47299134e+00]
Stock Position:  -0.002496523105098245
Bond Position:  [16.00636699]


portfolio before change:  [15.7401513]
curr_Stock_Price:  108.23764513646253
curr_Factors:  [1.08237645e+02 3.45897948e-02]
mat_Sqrt:  [[ 2.01303965e+01  0.00000000e+00]
 [-7.43933275e-03  1.70456527e-02]]
grads:  [-0.01120135  0.29325783]
Stock Position:  -0.011201347070444286
Bond Position:  [16.95255873]


portfolio before change:  [15.74009051]
curr_Stock_Price:  108.62147918029366
curr_Factors:  [1.08621479e+02 3.67822117e-02]
mat_Sqrt:  [[ 2.08321758e+01  0.00000000e+00]
 [-7.67147565e-03  1.75775589e-02]]
grads:  [ 0.0178943  16.49382444]
Stock Position:  0.017894296149805974
Bond Position:  [13.79638559]


portfolio before change:  [15.75727402]
curr_Stock_Price:  109.38898533702995
curr_Factors:  [1.09388985e+02 3.79589040e-02]
mat_Sqrt:  [[ 2.13123052e+01  0.00000000e+00]
 [-7.79321797e-03  1.78565056e-02]]
grads:  [0.00381035 2.33089891]
Stock Position:  0.0038103497404473564
Bond Position:  [15.34046373]


portfolio before change:  [15.76762638]
curr_Stock_Price:  111.09926599960299
curr_Factors:  [1.11099266e+02 3.80386687e-02]
mat_Sqrt:  [[ 2.16682503e+01  0.00000000e+00]
 [-7.80140179e-03  1.78752571e-02]]
grads:  [4.92213655e-03 2.05918233e+01]
Stock Position:  0.004922136552630307
Bond Position:  [15.22078062]


portfolio before change:  [15.76155276]
curr_Stock_Price:  109.09215133878297
curr_Factors:  [1.09092151e+02 4.01459575e-02]
mat_Sqrt:  [[ 2.18582011e+01  0.00000000e+00]
 [-8.01458246e-03  1.83637154e-02]]
grads:  [0.00831276 7.68496646]
Stock Position:  0.008312756406163135
Bond Position:  [14.85469628]


portfolio before change:  [15.75142816]
curr_Stock_Price:  107.42739219441647
curr_Factors:  [1.07427392e+02 4.17169621e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.75142816]
Stock Price:  108.0615727012023
PL:  [7.68985546]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.11237194e-02  3.97318749e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.56521796e-01 -5.28535423e-01]
 [-3.77927224e-02  2.75670391e-01]
 [-4.27106537e-01 -1.19368022e-01]
 [ 2.03383721e-01 -2.14205625e-01]
 [-3.15940723e-01  1.16131914e-01]
 [ 1.93355125e-02  1.59999392e-01]
 [-2.09058463e-01  4.02301567e-03]
 [ 1.73503240e-01  9.89586104e-03]
 [-5.15055946e-03  7.24534885e-02]
 [-2.37100863e-01  7.91255770e-02]
 [-8.16380107e-02  3.36010510e-02]
 [-2.01094798e-01 -2.64928223e-01]
 [-9.96302915e-02 -1.24803302e-01]
 [ 8.83111630e-02  5.97980413e-02]
 [ 4.88145980e-02 -7.95522939e-02]
 [ 7.17417865e-01 -3.44577536e-01]
 [ 1.83273254e-01  1.39982921e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.13176897]
curr_Stock_Price:  99.63983101058824
curr_Factors:  [9.96398310e+01 4.03061941e-02]
mat_Sqrt:  [[ 2.00040936e+01  0.00000000e+00]
 [-8.03056103e-03  1.84003269e-02]]
grads:  [-0.00096929  0.21593027]
Stock Position:  -0.0009692855152405184
Bond Position:  [0.22834842]


portfolio before change:  [0.13098177]
curr_Stock_Price:  100.51088759761406
curr_Factors:  [1.00510888e+02 4.06520563e-02]
mat_Sqrt:  [[ 2.02653621e+01  0.00000000e+00]
 [-8.06494204e-03  1.84791037e-02]]
grads:  [-0.00919425 -3.60688328]
Stock Position:  -0.009194253203895589
Bond Position:  [1.05510432]


portfolio before change:  [0.12667631]
curr_Stock_Price:  101.00785751410123
curr_Factors:  [1.01007858e+02 3.90451514e-02]
mat_Sqrt:  [[ 1.99589971e+01  0.00000000e+00]
 [-7.90393841e-03  1.81101980e-02]]
grads:  [-1.93994500e-02 -2.91844088e+01]
Stock Position:  -0.01939944995654396
Bond Position:  [2.08617318]


portfolio before change:  [0.17817195]
curr_Stock_Price:  98.38025549221922
curr_Factors:  [9.83802555e+01 3.97402369e-02]
mat_Sqrt:  [[ 1.96120581e+01  0.00000000e+00]
 [-7.97398138e-03  1.82706866e-02]]
grads:  [4.20760020e-03 1.50881243e+01]
Stock Position:  0.004207600202388842
Bond Position:  [-0.23577283]


portfolio before change:  [0.18285146]
curr_Stock_Price:  99.50642368724282
curr_Factors:  [9.95064237e+01 4.05047253e-02]
mat_Sqrt:  [[ 2.00264497e+01  0.00000000e+00]
 [-8.05031431e-03  1.84455874e-02]]
grads:  [-0.02392851 -6.47135924]
Stock Position:  -0.023928505601052943
Bond Position:  [2.56389148]


portfolio before change:  [0.1972546]
curr_Stock_Price:  98.93129021958693
curr_Factors:  [9.89312902e+01 4.04024319e-02]
mat_Sqrt:  [[ 1.98855417e+01  0.00000000e+00]
 [-8.04014248e-03  1.84222807e-02]]
grads:  [ 5.52646356e-03 -1.16275302e+01]
Stock Position:  0.005526463556498508
Bond Position:  [-0.34948557]


portfolio before change:  [0.18478158]
curr_Stock_Price:  96.69013907077841
curr_Factors:  [9.66901391e+01 3.97660279e-02]
mat_Sqrt:  [[ 1.92813879e+01  0.00000000e+00]
 [-7.97656847e-03  1.82766144e-02]]
grads:  [-0.01375713  6.35412619]
Stock Position:  -0.013757132091607083
Bond Position:  [1.51496059]


portfolio before change:  [0.17931502]
curr_Stock_Price:  97.11503487596802
curr_Factors:  [9.71150349e+01 3.90511495e-02]
mat_Sqrt:  [[ 1.91912552e+01  0.00000000e+00]
 [-7.90454548e-03  1.81115890e-02]]
grads:  [4.64612506e-03 8.83408914e+00]
Stock Position:  0.004646125058792945
Bond Position:  [-0.27189358]


portfolio before change:  [0.18078024]
curr_Stock_Price:  97.44503004434631
curr_Factors:  [9.74450300e+01 3.99965454e-02]
mat_Sqrt:  [[ 1.94881644e+01  0.00000000e+00]
 [-7.99965454e-03  1.83295112e-02]]
grads:  [-0.01063736  0.21948298]
Stock Position:  -0.010637362808409965
Bond Position:  [1.21733837]


portfolio before change:  [0.19938672]
curr_Stock_Price:  95.72448056020737
curr_Factors:  [9.57244806e+01 4.21916793e-02]
mat_Sqrt:  [[ 1.96623954e+01  0.00000000e+00]
 [-8.21624531e-03  1.88257830e-02]]
grads:  [0.00904377 0.52565469]
Stock Position:  0.009043768293749425
Bond Position:  [-0.6663233]


portfolio before change:  [0.22492304]
curr_Stock_Price:  98.56653955302333
curr_Factors:  [9.85665396e+01 4.38585544e-02]
mat_Sqrt:  [[ 2.06422325e+01  0.00000000e+00]
 [-8.37697362e-03  1.91940579e-02]]
grads:  [1.28235816e-03 3.77478744e+00]
Stock Position:  0.001282358161182431
Bond Position:  [0.09852543]


portfolio before change:  [0.22750602]
curr_Stock_Price:  100.5615732420766
curr_Factors:  [1.00561573e+02 4.39772760e-02]
mat_Sqrt:  [[ 2.10885258e+01  0.00000000e+00]
 [-8.38830386e-03  1.92200187e-02]]
grads:  [-0.00960559  4.11683143]
Stock Position:  -0.009605585122103494
Bond Position:  [1.19345877]


portfolio before change:  [0.24849145]
curr_Stock_Price:  98.40792741154253
curr_Factors:  [9.84079274e+01 4.44963068e-02]
mat_Sqrt:  [[ 2.07583136e+01  0.00000000e+00]
 [-8.43765908e-03  1.93331057e-02]]
grads:  [-0.00322634  1.73800586]
Stock Position:  -0.0032263367430766863
Bond Position:  [0.56598856]


portfolio before change:  [0.24521695]
curr_Stock_Price:  99.46671866359429
curr_Factors:  [9.94667187e+01 4.47519308e-02]
mat_Sqrt:  [[ 2.10418384e+01  0.00000000e+00]
 [-8.46186087e-03  1.93885590e-02]]
grads:  [ -0.01505187 -13.6641523 ]
Stock Position:  -0.01505186707829063
Bond Position:  [1.74237678]


portfolio before change:  [0.25765873]
curr_Stock_Price:  98.66906773581503
curr_Factors:  [9.86690677e+01 4.34832948e-02]
mat_Sqrt:  [[ 2.05751138e+01  0.00000000e+00]
 [-8.34105939e-03  1.91117680e-02]]
grads:  [-0.00748958 -6.53018087]
Stock Position:  -0.007489577901659961
Bond Position:  [0.9966484]


portfolio before change:  [0.27296119]
curr_Stock_Price:  96.65917328413568
curr_Factors:  [9.66591733e+01 4.39783717e-02]
mat_Sqrt:  [[ 2.02704154e+01  0.00000000e+00]
 [-8.38840835e-03  1.92202581e-02]]
grads:  [0.00564415 3.11119866]
Stock Position:  0.0056441451989317866
Bond Position:  [-0.27259722]


portfolio before change:  [0.27391649]
curr_Stock_Price:  96.84050426129691
curr_Factors:  [9.68405043e+01 4.45230734e-02]
mat_Sqrt:  [[ 2.04338222e+01  0.00000000e+00]
 [-8.44019653e-03  1.93389197e-02]]
grads:  [ 6.89794128e-04 -4.11358519e+00]
Stock Position:  0.0006897941281658975
Bond Position:  [0.20711648]


portfolio before change:  [0.27429644]
curr_Stock_Price:  97.31625029059768
curr_Factors:  [9.73162503e+01 4.41429479e-02]
mat_Sqrt:  [[ 2.04463614e+01  0.00000000e+00]
 [-8.40408928e-03  1.92561876e-02]]
grads:  [  0.02773266 -17.89437987]
Stock Position:  0.02773265559646715
Bond Position:  [-2.42454161]


portfolio before change:  [0.2822658]
curr_Stock_Price:  97.62547322820603
curr_Factors:  [9.76254732e+01 4.49028834e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.2822658]
Stock Price:  97.22151573002036
PL:  [0.2822658]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 7.00989642e-03  2.41566922e-01]
 [ 8.82600050e-02 -2.12980446e-02]
 [-1.36068920e-01 -3.88988360e-01]
 [ 2.74339663e-01 -1.64918701e-01]
 [-8.62751803e-02 -5.85941045e-02]
 [ 1.02571267e+00 -1.46770432e+00]
 [-6.71698614e-01  7.76010293e-01]
 [ 7.33206259e-01  1.90281856e-01]
 [ 9.03059192e-02 -1.02509590e-01]
 [-6.33371073e-02  2.76219770e-02]
 [ 3.25861536e-01  4.94363959e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.02756622e-01  1.24882325e-01]
 [-2.52730612e-01 -8.08403289e-02]
 [ 1.98894327e-01  1.43876750e-01]
 [ 6.82303394e-02  3.66820118e-02]
 [-5.33410570e-02  3.50519633e-01]
 [ 1.56961654e-01  1.78444662e-01]
 [-4.55007125e-02 -2.11351401e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.66037217]
curr_Stock_Price:  101.45839898485276
curr_Factors:  [1.01458399e+02 4.03361557e-02]
mat_Sqrt:  [[ 2.03767660e+01  0.00000000e+00]
 [-8.03354524e-03  1.84071646e-02]]
grads:  [5.5179681e-03 1.3123527e+01]
Stock Position:  0.005517968098402274
Bond Position:  [12.10052796]


portfolio before change:  [12.66846614]
curr_Stock_Price:  102.37693548273265
curr_Factors:  [1.02376935e+02 3.94594029e-02]
mat_Sqrt:  [[ 2.03365547e+01  0.00000000e+00]
 [-7.94575640e-03  1.82060151e-02]]
grads:  [ 0.0038829 -1.1698356]
Stock Position:  0.0038828984179836343
Bond Position:  [12.2709469]


portfolio before change:  [12.67067383]
curr_Stock_Price:  102.15534139559753
curr_Factors:  [1.02155341e+02 3.75118978e-02]
mat_Sqrt:  [[ 1.97854348e+01  0.00000000e+00]
 [-7.74719539e-03  1.77510547e-02]]
grads:  [-1.54577022e-02 -2.19135351e+01]
Stock Position:  -0.015457702187648557
Bond Position:  [14.24976068]


portfolio before change:  [12.65492594]
curr_Stock_Price:  103.40460677118676
curr_Factors:  [1.03404607e+02 3.90785354e-02]
mat_Sqrt:  [[ 2.04413242e+01  0.00000000e+00]
 [-7.90731666e-03  1.81179386e-02]]
grads:  [ 0.00989971 -9.10250914]
Stock Position:  0.009899712877444327
Bond Position:  [11.63125003]


portfolio before change:  [12.6879466]
curr_Stock_Price:  106.44635945118138
curr_Factors:  [1.06446359e+02 3.77371840e-02]
mat_Sqrt:  [[ 2.06783346e+01  0.00000000e+00]
 [-7.77042434e-03  1.78042789e-02]]
grads:  [-0.00540893 -3.29101251]
Stock Position:  -0.005408933858077596
Bond Position:  [13.26370792]


portfolio before change:  [12.68278288]
curr_Stock_Price:  108.01414714368799
curr_Factors:  [1.08014147e+02 3.74648744e-02]
mat_Sqrt:  [[ 2.09070511e+01  0.00000000e+00]
 [-7.74233809e-03  1.77399252e-02]]
grads:  [ 1.84222054e-02 -8.27345273e+01]
Stock Position:  0.018422205371550614
Bond Position:  [10.69292408]


portfolio before change:  [12.69087705]
curr_Stock_Price:  108.30839027617218
curr_Factors:  [1.08308390e+02 3.74620553e-02]
mat_Sqrt:  [[ 2.09632156e+01  0.00000000e+00]
 [-7.74204679e-03  1.77392577e-02]]
grads:  [-1.58859195e-02  4.37453644e+01]
Stock Position:  -0.015885919512830485
Bond Position:  [14.41145542]


portfolio before change:  [12.72451677]
curr_Stock_Price:  106.41763382787718
curr_Factors:  [1.06417634e+02 3.81277664e-02]
mat_Sqrt:  [[ 2.07794611e+01  0.00000000e+00]
 [-7.81053303e-03  1.78961794e-02]]
grads:  [ 0.03928168 10.63254068]
Stock Position:  0.03928167650398084
Bond Position:  [8.54425371]


portfolio before change:  [12.64523633]
curr_Stock_Price:  104.34499380926165
curr_Factors:  [1.04344994e+02 3.59226497e-02]
mat_Sqrt:  [[ 1.97767899e+01  0.00000000e+00]
 [-7.58130856e-03  1.73709602e-02]]
grads:  [ 2.30406788e-03 -5.90120460e+00]
Stock Position:  0.0023040678791052508
Bond Position:  [12.40481838]


portfolio before change:  [12.65512784]
curr_Stock_Price:  107.29191995974838
curr_Factors:  [1.07291920e+02 3.43779535e-02]
mat_Sqrt:  [[ 1.98933089e+01  0.00000000e+00]
 [-7.41651708e-03  1.69933755e-02]]
grads:  [-0.00257785  1.62545558]
Stock Position:  -0.00257784606765843
Bond Position:  [12.93170989]


portfolio before change:  [12.65680389]
curr_Stock_Price:  107.89602295858293
curr_Factors:  [1.07896023e+02 3.38843648e-02]
mat_Sqrt:  [[ 1.98611829e+01  0.00000000e+00]
 [-7.36308249e-03  1.68709414e-02]]
grads:  [2.72702617e-02 2.93026896e+01]
Stock Position:  0.02727026169963234
Bond Position:  [9.7144511]


portfolio before change:  [12.6380207]
curr_Stock_Price:  107.11817572416014
curr_Factors:  [1.07118176e+02 3.35654426e-02]
mat_Sqrt:  [[ 1.96249861e+01  0.00000000e+00]
 [-7.32834962e-03  1.67913584e-02]]
grads:  [-0.00963099  6.80904552]
Stock Position:  -0.00963098589151432
Bond Position:  [13.66967434]


portfolio before change:  [12.64139988]
curr_Stock_Price:  107.12219132517265
curr_Factors:  [1.07122191e+02 3.29943220e-02]
mat_Sqrt:  [[ 1.94580382e+01  0.00000000e+00]
 [-7.26573570e-03  1.66478919e-02]]
grads:  [-2.47987520e-03  7.50138971e+00]
Stock Position:  -0.002479875202288732
Bond Position:  [12.90704954]


portfolio before change:  [12.64497872]
curr_Stock_Price:  106.98037810979902
curr_Factors:  [1.06980378e+02 3.22185512e-02]
mat_Sqrt:  [[ 1.92024716e+01  0.00000000e+00]
 [-7.17981072e-03  1.64510130e-02]]
grads:  [-0.01499871 -4.91400309]
Stock Position:  -0.014998705872088045
Bond Position:  [14.24954595]


portfolio before change:  [12.66799038]
curr_Stock_Price:  105.68367792281637
curr_Factors:  [1.05683678e+02 3.16324508e-02]
mat_Sqrt:  [[ 1.87963853e+01  0.00000000e+00]
 [-7.11420560e-03  1.63006928e-02]]
grads:  [0.01392221 8.82641931]
Stock Position:  0.013922213452900926
Bond Position:  [11.19663965]


portfolio before change:  [12.71818825]
curr_Stock_Price:  109.08819137337439
curr_Factors:  [1.09088191e+02 3.02275690e-02]
mat_Sqrt:  [[ 1.89661575e+01  0.00000000e+00]
 [-6.95443099e-03  1.59346032e-02]]
grads:  [0.00444158 2.30203484]
Stock Position:  0.004441578746186326
Bond Position:  [12.23366446]


portfolio before change:  [12.72822908]
curr_Stock_Price:  110.66016315868627
curr_Factors:  [1.10660163e+02 2.84033927e-02]
mat_Sqrt:  [[ 1.86498960e+01  0.00000000e+00]
 [-6.74132244e-03  1.54463102e-02]]
grads:  [5.34256344e-03 2.26927745e+01]
Stock Position:  0.005342563440682014
Bond Position:  [12.13702014]


portfolio before change:  [12.73180368]
curr_Stock_Price:  110.76123110177103
curr_Factors:  [1.10761231e+02 2.88817686e-02]
mat_Sqrt:  [[ 1.88234691e+01  0.00000000e+00]
 [-6.79785479e-03  1.55758421e-02]]
grads:  [ 0.01247598 11.45650173]
Stock Position:  0.012475983455214903
Bond Position:  [11.34994839]


portfolio before change:  [12.70566269]
curr_Stock_Price:  108.43846203628343
curr_Factors:  [1.08438462e+02 2.89828069e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.70566269]
Stock Price:  106.68060040237971
PL:  [6.02506229]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.79325253e-02  4.70426222e-03]
 [-1.39376305e-01 -6.10490484e-02]
 [-1.10984830e-01 -2.17843189e-01]
 [ 2.64151197e-01 -1.47857939e-01]
 [-8.55606448e-02 -6.35224201e-02]
 [ 6.04608968e-01 -8.11764694e-01]
 [-5.42620732e-01  3.40254338e-01]
 [ 1.18434279e-01  1.41992055e-01]
 [-4.70915579e-02 -4.33729456e-02]
 [ 3.04993065e-01  4.58568191e-03]
 [ 1.20735859e-01  1.87343077e-01]
 [-2.36344479e-01  6.43814149e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.71165734e-01 -2.54937716e-01]
 [ 7.43020262e-03 -7.89667808e-02]
 [ 9.42477486e-02  5.15127206e-02]
 [-3.44112184e-02 -3.83694583e-02]
 [ 2.63609163e-01 -1.76488946e-01]
 [ 1.21921084e-01  2.24005378e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.36375245]
curr_Stock_Price:  99.67350417586218
curr_Factors:  [9.96735042e+01 4.08099033e-02]
mat_Sqrt:  [[ 2.01355042e+01  0.00000000e+00]
 [-8.08058446e-03  1.85149450e-02]]
grads:  [-0.00128526  0.25407919]
Stock Position:  -0.001285262917898733
Bond Position:  [0.49185911]


portfolio before change:  [0.36195628]
curr_Stock_Price:  101.16670589652338
curr_Factors:  [1.01166706e+02 3.88719417e-02]
mat_Sqrt:  [[ 1.99459959e+01  0.00000000e+00]
 [-7.88638743e-03  1.80699837e-02]]
grads:  [-0.00832349 -3.37847834]
Stock Position:  -0.008323489826977608
Bond Position:  [1.20401632]


portfolio before change:  [0.34219053]
curr_Stock_Price:  103.57756877317605
curr_Factors:  [1.03577569e+02 3.82734179e-02]
mat_Sqrt:  [[ 2.02634942e+01  0.00000000e+00]
 [-7.82543728e-03  1.79303293e-02]]
grads:  [-1.01689961e-02 -1.21494249e+01]
Stock Position:  -0.010168996059414001
Bond Position:  [1.39547041]


portfolio before change:  [0.34648342]
curr_Stock_Price:  103.18972492031014
curr_Factors:  [1.03189725e+02 3.59545522e-02]
mat_Sqrt:  [[ 1.95665112e+01  0.00000000e+00]
 [-7.58467425e-03  1.73786719e-02]]
grads:  [ 0.01020216 -8.50801143]
Stock Position:  0.01020216121668951
Bond Position:  [-0.70627479]


portfolio before change:  [0.36945303]
curr_Stock_Price:  105.45847982648029
curr_Factors:  [1.05458480e+02 3.37160563e-02]
mat_Sqrt:  [[ 1.93642148e+01  0.00000000e+00]
 [-7.34477298e-03  1.68289891e-02]]
grads:  [-0.00585018 -3.77458324]
Stock Position:  -0.005850177907669275
Bond Position:  [0.9864039]


portfolio before change:  [0.38268281]
curr_Stock_Price:  103.23920611589568
curr_Factors:  [1.03239206e+02 3.57795867e-02]
mat_Sqrt:  [[ 1.95282046e+01  0.00000000e+00]
 [-7.56619712e-03  1.73363355e-02]]
grads:  [ 1.28186802e-02 -4.68244684e+01]
Stock Position:  0.012818680220249864
Bond Position:  [-0.94070756]


portfolio before change:  [0.36402831]
curr_Stock_Price:  101.80229601894997
curr_Factors:  [1.01802296e+02 3.59495337e-02]
mat_Sqrt:  [[ 1.93020841e+01  0.00000000e+00]
 [-7.58414491e-03  1.73774591e-02]]
grads:  [-0.0204186  19.58021231]
Stock Position:  -0.02041860152861849
Bond Position:  [2.44268883]


portfolio before change:  [0.39616524]
curr_Stock_Price:  100.25830274425854
curr_Factors:  [1.00258303e+02 3.74024318e-02]
mat_Sqrt:  [[ 1.93896633e+01  0.00000000e+00]
 [-7.73588332e-03  1.77251354e-02]]
grads:  [0.00930417 8.01077405]
Stock Position:  0.009304168399482324
Bond Position:  [-0.53665489]


portfolio before change:  [0.42030914]
curr_Stock_Price:  102.86767916359042
curr_Factors:  [1.02867679e+02 3.51793177e-02]
mat_Sqrt:  [[ 1.92940166e+01  0.00000000e+00]
 [-7.50246015e-03  1.71902958e-02]]
grads:  [-0.00342184 -2.52310642]
Stock Position:  -0.003421841324485827
Bond Position:  [0.77230602]


portfolio before change:  [0.42944402]
curr_Stock_Price:  100.25453065198657
curr_Factors:  [1.00254531e+02 3.68594269e-02]
mat_Sqrt:  [[ 1.92476759e+01  0.00000000e+00]
 [-7.67952362e-03  1.75959991e-02]]
grads:  [0.01594969 0.26060935]
Stock Position:  0.015949687760558617
Bond Position:  [-1.16958444]


portfolio before change:  [0.4453138]
curr_Stock_Price:  101.26785494696539
curr_Factors:  [1.01267855e+02 3.75945747e-02]
mat_Sqrt:  [[ 1.96351489e+01  0.00000000e+00]
 [-7.75572817e-03  1.77706057e-02]]
grads:  [1.03130912e-02 1.05423012e+01]
Stock Position:  0.010313091195582885
Bond Position:  [-0.59907083]


portfolio before change:  [0.42746559]
curr_Stock_Price:  99.55174296183787
curr_Factors:  [9.95517430e+01 3.93761406e-02]
mat_Sqrt:  [[ 1.97544727e+01  0.00000000e+00]
 [-7.93736889e-03  1.81867969e-02]]
grads:  [-0.01054172  3.54000847]
Stock Position:  -0.010541720302877446
Bond Position:  [1.47691222]


portfolio before change:  [0.41536387]
curr_Stock_Price:  100.73475566844687
curr_Factors:  [1.00734756e+02 3.93101827e-02]
mat_Sqrt:  [[ 1.99724742e+01  0.00000000e+00]
 [-7.93071828e-03  1.81715584e-02]]
grads:  [3.32583358e-04 2.16633610e+00]
Stock Position:  0.00033258335837548495
Bond Position:  [0.38186117]


portfolio before change:  [0.41601255]
curr_Stock_Price:  102.39809245665765
curr_Factors:  [1.02398092e+02 3.83437801e-02]
mat_Sqrt:  [[ 2.00511520e+01  0.00000000e+00]
 [-7.83262715e-03  1.79468034e-02]]
grads:  [ -0.0190727  -14.20518798]
Stock Position:  -0.019072703405796032
Bond Position:  [2.369021]


portfolio before change:  [0.43912814]
curr_Stock_Price:  101.21717649579941
curr_Factors:  [1.01217176e+02 3.78484416e-02]
mat_Sqrt:  [[ 1.96914737e+01  0.00000000e+00]
 [-7.78187038e-03  1.78305050e-02]]
grads:  [-1.37286454e-03 -4.42874617e+00]
Stock Position:  -0.0013728645410711333
Bond Position:  [0.57808561]


portfolio before change:  [0.44152555]
curr_Stock_Price:  99.57617805166561
curr_Factors:  [9.95761781e+01 3.79069782e-02]
mat_Sqrt:  [[ 1.93871976e+01  0.00000000e+00]
 [-7.78788580e-03  1.78442881e-02]]
grads:  [0.00602097 2.88679046]
Stock Position:  0.0060209704199712276
Bond Position:  [-0.15801968]


portfolio before change:  [0.44697259]
curr_Stock_Price:  100.48741887309954
curr_Factors:  [1.00487419e+02 3.67608016e-02]
mat_Sqrt:  [[ 1.92665599e+01  0.00000000e+00]
 [-7.66924263e-03  1.75724424e-02]]
grads:  [-0.00265522 -2.18350172]
Stock Position:  -0.0026552235108793266
Bond Position:  [0.71378915]


portfolio before change:  [0.43769906]
curr_Stock_Price:  104.04719495397325
curr_Factors:  [1.04047195e+02 3.49100808e-02]
mat_Sqrt:  [[ 1.94404272e+01  0.00000000e+00]
 [-7.47369582e-03  1.71243884e-02]]
grads:  [ 9.59768374e-03 -1.03062920e+01]
Stock Position:  0.009597683736293553
Bond Position:  [-0.56091301]


portfolio before change:  [0.43960191]
curr_Stock_Price:  104.26006896481165
curr_Factors:  [1.04260069e+02 3.55325102e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.43960191]
Stock Price:  102.54661377498881
PL:  [-2.10701186]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 9.26669516e-02  3.70288684e-01]
 [ 2.26849054e-01  1.79914454e-02]
 [-1.53350601e-01 -5.06898814e-01]
 [ 3.03023019e-01 -2.12949477e-01]
 [-2.76601967e-01 -9.84219907e-02]
 [ 4.40888147e-01 -5.58244178e-01]
 [-5.39694720e-01  3.26587042e-01]
 [ 3.32194406e-01  1.58782726e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 3.19119283e-01  4.93230115e-03]
 [ 1.09959069e-01  1.77578396e-01]
 [-2.36856831e-01  7.43686830e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.19793250e-01 -2.70174207e-01]
 [ 6.41165193e-02 -5.43202886e-02]
 [ 8.84406205e-02  6.52082255e-02]
 [-1.42840582e-02 -4.83271359e-02]
 [ 4.70743302e-01 -2.56843316e-01]
 [ 1.97308870e-01  8.49567167e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.78915786]
curr_Stock_Price:  102.34801239193392
curr_Factors:  [1.02348012e+02 3.96255973e-02]
mat_Sqrt:  [[ 2.03735788e+01  0.00000000e+00]
 [-7.96247171e-03  1.82443147e-02]]
grads:  [1.24805850e-02 2.02961137e+01]
Stock Position:  0.012480585004614577
Bond Position:  [17.5117948]


portfolio before change:  [18.81412814]
curr_Stock_Price:  103.99791711421234
curr_Factors:  [1.03997917e+02 3.68384970e-02]
mat_Sqrt:  [[ 1.99606920e+01  0.00000000e+00]
 [-7.67734298e-03  1.75910027e-02]]
grads:  [0.01175817 1.02276406]
Stock Position:  0.011758167725444288
Bond Position:  [17.59130318]


portfolio before change:  [18.78527118]
curr_Stock_Price:  101.16964173384937
curr_Factors:  [1.01169642e+02 3.59499081e-02]
mat_Sqrt:  [[ 1.91822304e+01  0.00000000e+00]
 [-7.58418439e-03  1.73775495e-02]]
grads:  [-1.95274153e-02 -2.91697522e+01]
Stock Position:  -0.019527415323810384
Bond Position:  [20.76085279]


portfolio before change:  [18.73495328]
curr_Stock_Price:  104.01224804698569
curr_Factors:  [1.04012248e+02 3.68383470e-02]
mat_Sqrt:  [[ 1.99634019e+01  0.00000000e+00]
 [-7.67732735e-03  1.75909669e-02]]
grads:  [ 1.05234693e-02 -1.21056153e+01]
Stock Position:  0.010523469327823942
Bond Position:  [17.64038358]


portfolio before change:  [18.70798281]
curr_Stock_Price:  101.03023547667784
curr_Factors:  [1.01030235e+02 3.83432100e-02]
mat_Sqrt:  [[ 1.97831571e+01  0.00000000e+00]
 [-7.83256893e-03  1.79466700e-02]]
grads:  [-0.01615298 -5.48413665]
Stock Position:  -0.01615297519551059
Bond Position:  [20.3399217]


portfolio before change:  [18.70815443]
curr_Stock_Price:  101.334451991872
curr_Factors:  [1.01334452e+02 3.89434023e-02]
mat_Sqrt:  [[ 1.99974246e+01  0.00000000e+00]
 [-7.89363311e-03  1.80865856e-02]]
grads:  [ 9.86379080e-03 -3.08650947e+01]
Stock Position:  0.009863790801494507
Bond Position:  [17.70861259]


portfolio before change:  [18.71488504]
curr_Stock_Price:  101.56792324788518
curr_Factors:  [1.01567923e+02 3.82846060e-02]
mat_Sqrt:  [[ 1.98732394e+01  0.00000000e+00]
 [-7.82658097e-03  1.79329499e-02]]
grads:  [-0.01998469 18.21156277]
Stock Position:  -0.01998468601488148
Bond Position:  [20.7446881]


portfolio before change:  [18.70344717]
curr_Stock_Price:  102.39979499172503
curr_Factors:  [1.02399795e+02 3.75444071e-02]
mat_Sqrt:  [[ 1.98413726e+01  0.00000000e+00]
 [-7.75055168e-03  1.77587449e-02]]
grads:  [0.02023514 8.94110068]
Stock Position:  0.020235135804190157
Bond Position:  [16.63137341]


portfolio before change:  [18.67014524]
curr_Stock_Price:  100.54854532325238
curr_Factors:  [1.00548545e+02 3.97158738e-02]
mat_Sqrt:  [[ 2.00381606e+01  0.00000000e+00]
 [-7.97153675e-03  1.82650853e-02]]
grads:  [-0.01085833 -2.90986384]
Stock Position:  -0.010858325520832643
Bond Position:  [19.76193408]


portfolio before change:  [18.67336469]
curr_Stock_Price:  100.70710204298128
curr_Factors:  [1.00707102e+02 4.01541064e-02]
mat_Sqrt:  [[ 2.01801821e+01  0.00000000e+00]
 [-8.01539582e-03  1.83655790e-02]]
grads:  [0.01592017 0.26856225]
Stock Position:  0.015920169290765014
Bond Position:  [17.07009057]


portfolio before change:  [18.68014307]
curr_Stock_Price:  100.86478432284139
curr_Factors:  [1.00864784e+02 4.01576651e-02]
mat_Sqrt:  [[ 2.02126749e+01  0.00000000e+00]
 [-8.01575100e-03  1.83663929e-02]]
grads:  [9.27441005e-03 9.66865933e+00]
Stock Position:  0.009274410046402101
Bond Position:  [17.7446817]


portfolio before change:  [18.67875523]
curr_Stock_Price:  100.2367592643722
curr_Factors:  [1.00236759e+02 4.05142472e-02]
mat_Sqrt:  [[ 2.01758065e+01  0.00000000e+00]
 [-8.05126049e-03  1.84477553e-02]]
grads:  [-0.01013093  4.03131339]
Stock Position:  -0.010130929704236175
Bond Position:  [19.69424679]


portfolio before change:  [18.67902734]
curr_Stock_Price:  100.69595442822971
curr_Factors:  [1.00695954e+02 4.10370702e-02]
mat_Sqrt:  [[ 2.03985922e+01  0.00000000e+00]
 [-8.10304340e-03  1.85664049e-02]]
grads:  [3.25635832e-04 2.12026524e+00]
Stock Position:  0.0003256358315908625
Bond Position:  [18.64623713]


portfolio before change:  [18.68350571]
curr_Stock_Price:  100.13161019046363
curr_Factors:  [1.00131610e+02 4.02606887e-02]
mat_Sqrt:  [[ 2.00914740e+01  0.00000000e+00]
 [-8.02602654e-03  1.83899371e-02]]
grads:  [ -0.01680847 -14.6914155 ]
Stock Position:  -0.016808470100498216
Bond Position:  [20.36656488]


portfolio before change:  [18.66096793]
curr_Stock_Price:  101.77542734603125
curr_Factors:  [1.01775427e+02 4.01219245e-02]
mat_Sqrt:  [[ 2.03860842e+01  0.00000000e+00]
 [-8.01218318e-03  1.83582179e-02]]
grads:  [ 1.98219537e-03 -2.95890858e+00]
Stock Position:  0.0019821953741221343
Bond Position:  [18.45922915]


portfolio before change:  [18.65901515]
curr_Stock_Price:  98.46184304812209
curr_Factors:  [9.84618430e+01 4.07655318e-02]
mat_Sqrt:  [[ 1.98799147e+01  0.00000000e+00]
 [-8.07619037e-03  1.85048768e-02]]
grads:  [0.0058803  3.52384002]
Stock Position:  0.0058802980300108705
Bond Position:  [18.08003016]


portfolio before change:  [18.6702471]
curr_Stock_Price:  99.60317573395359
curr_Factors:  [9.96031757e+01 4.03151578e-02]
mat_Sqrt:  [[ 1.99989580e+01  0.00000000e+00]
 [-8.03145395e-03  1.84023728e-02]]
grads:  [-1.76887964e-03 -2.62613611e+00]
Stock Position:  -0.001768879636050165
Bond Position:  [18.84643312]


portfolio before change:  [18.67321489]
curr_Stock_Price:  100.58934076971173
curr_Factors:  [1.00589341e+02 4.15591360e-02]
mat_Sqrt:  [[ 2.05062013e+01  0.00000000e+00]
 [-8.15442319e-03  1.86841308e-02]]
grads:  [  0.01748972 -13.74660236]
Stock Position:  0.017489718493591537
Bond Position:  [16.91393563]


portfolio before change:  [18.7003836]
curr_Stock_Price:  101.90095175870309
curr_Factors:  [1.01900952e+02 4.05248079e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.7003836]
Stock Price:  104.0411242374426
PL:  [14.65925937]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.59979978e-02  1.46881351e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.65188306e-01 -5.87665789e-01]
 [-3.70594165e-02  2.75747236e-01]
 [-4.06516985e-01 -7.85304224e-02]
 [-3.16434690e-02  9.35213222e-02]
 [-3.77412671e-01  1.49838442e-01]
 [ 3.04433082e-02  1.45979453e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.13607251e-01  7.38285889e-03]
 [-1.03455120e-01 -4.25249396e-02]
 [-2.04383535e-01  6.17357528e-02]
 [-4.38767394e-02  3.63686419e-02]
 [-1.89402334e-01 -2.61447837e-01]
 [-9.06209037e-02 -1.20482041e-01]
 [ 9.17000646e-02  5.38919786e-02]
 [-4.21121798e-02 -3.45573790e-02]
 [ 3.38946255e-01 -2.18490657e-01]
 [ 1.80915779e-01  7.16526075e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.15443573]
curr_Stock_Price:  100.80434748570627
curr_Factors:  [1.00804347e+02 4.15429047e-02]
mat_Sqrt:  [[ 2.05460193e+01  0.00000000e+00]
 [-8.15283064e-03  1.86804818e-02]]
grads:  [3.94542564e-04 7.86282456e+00]
Stock Position:  0.0003945425638624502
Bond Position:  [8.11466413]


portfolio before change:  [8.15623886]
curr_Stock_Price:  100.2320666008897
curr_Factors:  [1.00232067e+02 4.17553180e-02]
mat_Sqrt:  [[ 2.04815388e+01  0.00000000e+00]
 [-8.17364721e-03  1.87281785e-02]]
grads:  [-0.00909721 -3.55891365]
Stock Position:  -0.00909721052060754
Bond Position:  [9.06807107]


portfolio before change:  [8.15576313]
curr_Stock_Price:  100.53359153122176
curr_Factors:  [1.00533592e+02 4.18130397e-02]
mat_Sqrt:  [[ 2.05573471e+01  0.00000000e+00]
 [-8.17929480e-03  1.87411188e-02]]
grads:  [-2.05117266e-02 -3.13570281e+01]
Stock Position:  -0.02051172663390145
Bond Position:  [10.21788068]


portfolio before change:  [8.20412121]
curr_Stock_Price:  98.30056216124483
curr_Factors:  [9.83005622e+01 4.12873945e-02]
mat_Sqrt:  [[ 1.99739860e+01  0.00000000e+00]
 [-8.12771993e-03  1.86229459e-02]]
grads:  [4.16975079e-03 1.48068537e+01]
Stock Position:  0.004169750790656451
Bond Position:  [7.79423236]


portfolio before change:  [8.20550237]
curr_Stock_Price:  98.1644302267865
curr_Factors:  [9.81644302e+01 4.08475874e-02]
mat_Sqrt:  [[ 1.98398030e+01  0.00000000e+00]
 [-8.08431443e-03  1.85234914e-02]]
grads:  [-0.02221748 -4.23950435]
Stock Position:  -0.022217482260703567
Bond Position:  [10.38646886]


portfolio before change:  [8.22471648]
curr_Stock_Price:  97.41649828300486
curr_Factors:  [9.74164983e+01 4.20200770e-02]
mat_Sqrt:  [[ 1.99692124e+01  0.00000000e+00]
 [-8.19951969e-03  1.87874598e-02]]
grads:  [4.59336206e-04 4.97785880e+00]
Stock Position:  0.0004593362055041621
Bond Position:  [8.17996955]


portfolio before change:  [8.2270734]
curr_Stock_Price:  98.09502915791825
curr_Factors:  [9.80950292e+01 4.21058734e-02]
mat_Sqrt:  [[ 2.01288211e+01  0.00000000e+00]
 [-8.20788630e-03  1.88066301e-02]]
grads:  [-0.01550105  7.96732011]
Stock Position:  -0.015501047549047372
Bond Position:  [9.74764911]


portfolio before change:  [8.22083956]
curr_Stock_Price:  98.65441438075274
curr_Factors:  [9.86544144e+01 4.05683912e-02]
mat_Sqrt:  [[ 1.98705741e+01  0.00000000e+00]
 [-8.05663863e-03  1.84600782e-02]]
grads:  [4.73836155e-03 7.90784586e+00]
Stock Position:  0.0047383615545527735
Bond Position:  [7.75337928]


portfolio before change:  [8.23138476]
curr_Stock_Price:  100.4707844140057
curr_Factors:  [1.00470784e+02 4.15489275e-02]
mat_Sqrt:  [[ 2.04795166e+01  0.00000000e+00]
 [-8.15342162e-03  1.86818359e-02]]
grads:  [-0.01062432 -2.84495119]
Stock Position:  -0.010624316697937682
Bond Position:  [9.2988182]


portfolio before change:  [8.26689805]
curr_Stock_Price:  97.34698001789606
curr_Factors:  [9.73469800e+01 4.27056097e-02]
mat_Sqrt:  [[ 2.01170802e+01  0.00000000e+00]
 [-8.26613425e-03  1.89400930e-02]]
grads:  [0.01077837 0.38980056]
Stock Position:  0.010778373038942954
Bond Position:  [7.21765598]


portfolio before change:  [8.25533842]
curr_Stock_Price:  96.10706477691615
curr_Factors:  [9.61070648e+01 4.38108647e-02]
mat_Sqrt:  [[ 2.01162130e+01  0.00000000e+00]
 [-8.37241802e-03  1.91836197e-02]]
grads:  [-0.00606548 -2.21673179]
Stock Position:  -0.006065481835966176
Bond Position:  [8.83827407]


portfolio before change:  [8.25233333]
curr_Stock_Price:  96.96683718599566
curr_Factors:  [9.69668372e+01 4.29208695e-02]
mat_Sqrt:  [[ 2.00889615e+01  0.00000000e+00]
 [-8.28694100e-03  1.89877672e-02]]
grads:  [-0.0088327   3.25134347]
Stock Position:  -0.0088327036389801
Bond Position:  [9.10881266]


portfolio before change:  [8.23215686]
curr_Stock_Price:  99.50897561546773
curr_Factors:  [9.95089756e+01 4.00037026e-02]
mat_Sqrt:  [[ 1.99027162e+01  0.00000000e+00]
 [-8.00037026e-03  1.83311511e-02]]
grads:  [-1.40705231e-03  1.98398025e+00]
Stock Position:  -0.0014070523092739023
Bond Position:  [8.3721712]


portfolio before change:  [8.23485725]
curr_Stock_Price:  99.07751992156915
curr_Factors:  [9.90775199e+01 4.13524790e-02]
mat_Sqrt:  [[ 2.01477198e+01  0.00000000e+00]
 [-8.13412358e-03  1.86376185e-02]]
grads:  [ -0.01506411 -14.02796375]
Stock Position:  -0.015064112863755192
Bond Position:  [9.72737219]


portfolio before change:  [8.23468195]
curr_Stock_Price:  99.25060984636094
curr_Factors:  [9.92506098e+01 4.11279588e-02]
mat_Sqrt:  [[ 2.01280527e+01  0.00000000e+00]
 [-8.11201171e-03  1.85869539e-02]]
grads:  [-0.00711463 -6.48207567]
Stock Position:  -0.007114626503056768
Bond Position:  [8.94081297]


portfolio before change:  [8.23722325]
curr_Stock_Price:  99.20762495340506
curr_Factors:  [9.92076250e+01 3.97288235e-02]
mat_Sqrt:  [[ 1.97741537e+01  0.00000000e+00]
 [-7.97283624e-03  1.82680628e-02]]
grads:  [0.00582682 2.95006533]
Stock Position:  0.005826820921070573
Bond Position:  [7.65915819]


portfolio before change:  [8.24855191]
curr_Stock_Price:  100.82319358056677
curr_Factors:  [1.00823194e+02 3.72761790e-02]
mat_Sqrt:  [[ 1.94659742e+01  0.00000000e+00]
 [-7.72281596e-03  1.76951944e-02]]
grads:  [-0.00293817 -1.95292452]
Stock Position:  -0.0029381656353482002
Bond Position:  [8.54478715]


portfolio before change:  [8.24509611]
curr_Stock_Price:  102.72651280490759
curr_Factors:  [1.02726513e+02 3.58242991e-02]
mat_Sqrt:  [[ 1.94433636e+01  0.00000000e+00]
 [-7.57092323e-03  1.73471644e-02]]
grads:  [ 1.25281366e-02 -1.25951800e+01]
Stock Position:  0.012528136602304419
Bond Position:  [6.95812432]


portfolio before change:  [8.2426036]
curr_Stock_Price:  102.38869323348648
curr_Factors:  [1.02388693e+02 3.59539504e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.2426036]
Stock Price:  102.04694481252682
PL:  [6.19565879]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-4.05935567e-02  1.70030487e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.53564492e-01 -5.08358160e-01]
 [ 2.06183340e-01 -5.07897606e-02]
 [-3.69925705e-01 -1.10139116e-01]
 [ 4.55940668e-01 -5.81721725e-01]
 [-4.95998480e-01  2.18564024e-01]
 [ 1.73990094e-02  1.62443590e-01]
 [-2.10676667e-01  1.03278975e-02]
 [ 2.50403657e-01  5.07711820e-03]
 [ 7.91081407e-03  8.62456553e-02]
 [-2.35987699e-01  5.74267121e-02]
 [-4.62429618e-02  3.61952172e-02]
 [-2.22205788e-01 -2.70851733e-01]
 [-3.70622704e-02 -9.76181106e-02]
 [ 9.67357274e-02  4.89076943e-02]
 [-3.07749757e-02 -4.01672900e-02]
 [ 4.54711708e-01 -2.52174830e-01]
 [ 2.25408708e-01  1.22293485e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.24935278]
curr_Stock_Price:  100.96327829777134
curr_Factors:  [1.00963278e+02 3.92472383e-02]
mat_Sqrt:  [[ 2.00017500e+01  0.00000000e+00]
 [-7.92436630e-03  1.81570042e-02]]
grads:  [1.68054453e-03 9.36445709e+00]
Stock Position:  0.0016805445262306317
Bond Position:  [9.0796795]


portfolio before change:  [9.24968417]
curr_Stock_Price:  99.80959725721543
curr_Factors:  [9.98095973e+01 4.04324188e-02]
mat_Sqrt:  [[ 2.00695283e+01  0.00000000e+00]
 [-8.04312564e-03  1.84291160e-02]]
grads:  [-0.00928397 -3.61666669]
Stock Position:  -0.009283968592893741
Bond Position:  [10.17631334]


portfolio before change:  [9.239614]
curr_Stock_Price:  101.16834473223751
curr_Factors:  [1.01168345e+02 3.78618357e-02]
mat_Sqrt:  [[ 1.96854559e+01  0.00000000e+00]
 [-7.78324721e-03  1.78336597e-02]]
grads:  [-1.90714497e-02 -2.85055433e+01]
Stock Position:  -0.01907144969466976
Bond Position:  [11.169041]


portfolio before change:  [9.22726878]
curr_Stock_Price:  101.96208786761545
curr_Factors:  [1.01962088e+02 3.89208797e-02]
mat_Sqrt:  [[ 2.01154635e+01  0.00000000e+00]
 [-7.89135017e-03  1.80813548e-02]]
grads:  [ 0.00914803 -2.80895769]
Stock Position:  0.009148030397908602
Bond Position:  [8.2945165]


portfolio before change:  [9.21257766]
curr_Stock_Price:  100.1294520887379
curr_Factors:  [1.00129452e+02 3.71012797e-02]
mat_Sqrt:  [[ 1.92866271e+01  0.00000000e+00]
 [-7.70467699e-03  1.76536328e-02]]
grads:  [-0.02167276 -6.23889244]
Stock Position:  -0.021672755595658618
Bond Position:  [11.3826588]


portfolio before change:  [9.18464958]
curr_Stock_Price:  101.54939614236318
curr_Factors:  [1.01549396e+02 3.60081758e-02]
mat_Sqrt:  [[ 1.92698310e+01  0.00000000e+00]
 [-7.59032814e-03  1.73916266e-02]]
grads:  [ 1.04856391e-02 -3.34483794e+01]
Stock Position:  0.010485639055969791
Bond Position:  [8.11983926]


portfolio before change:  [9.16977642]
curr_Stock_Price:  99.93734682065931
curr_Factors:  [9.99373468e+01 3.58436092e-02]
mat_Sqrt:  [[ 1.89205467e+01  0.00000000e+00]
 [-7.57296340e-03  1.73518390e-02]]
grads:  [-0.02117324 12.59601499]
Stock Position:  -0.021173242239890613
Bond Position:  [11.28577408]


portfolio before change:  [9.21156131]
curr_Stock_Price:  98.09714267382476
curr_Factors:  [9.80971427e+01 3.56709395e-02]
mat_Sqrt:  [[ 1.85273639e+01  0.00000000e+00]
 [-7.55470074e-03  1.73099940e-02]]
grads:  [4.76566471e-03 9.38438165e+00]
Stock Position:  0.004765664714573884
Bond Position:  [8.74406322]


portfolio before change:  [9.20997145]
curr_Stock_Price:  97.30477700571134
curr_Factors:  [9.73047770e+01 3.76881196e-02]
mat_Sqrt:  [[ 1.88901931e+01  0.00000000e+00]
 [-7.76537130e-03  1.77927009e-02]]
grads:  [-0.01091409  0.58045698]
Stock Position:  -0.010914086596153935
Bond Position:  [10.27196421]


portfolio before change:  [9.19621978]
curr_Stock_Price:  98.8000907327496
curr_Factors:  [9.88000907e+01 3.73108199e-02]
mat_Sqrt:  [[ 1.90842343e+01  0.00000000e+00]
 [-7.72640356e-03  1.77034146e-02]]
grads:  [0.01323708 0.28678751]
Stock Position:  0.01323707774652416
Bond Position:  [7.8883953]


portfolio before change:  [9.19794355]
curr_Stock_Price:  98.78131196361265
curr_Factors:  [9.8781312e+01 3.6570654e-02]
mat_Sqrt:  [[ 1.88904000e+01  0.00000000e+00]
 [-7.64938209e-03  1.75269362e-02]]
grads:  [2.41135730e-03 4.92074908e+00]
Stock Position:  0.002411357303801888
Bond Position:  [8.95974651]


portfolio before change:  [9.200524]
curr_Stock_Price:  98.92241119484471
curr_Factors:  [9.89224112e+01 3.85468045e-02]
mat_Sqrt:  [[ 1.94217735e+01  0.00000000e+00]
 [-7.85333606e-03  1.79942535e-02]]
grads:  [-0.01086021  3.19139175]
Stock Position:  -0.010860214546257328
Bond Position:  [10.27484261]


portfolio before change:  [9.19755401]
curr_Stock_Price:  99.43244053038478
curr_Factors:  [9.94324405e+01 3.78134813e-02]
mat_Sqrt:  [[ 1.93353229e+01  0.00000000e+00]
 [-7.77827552e-03  1.78222682e-02]]
grads:  [-1.57463488e-03  2.03089847e+00]
Stock Position:  -0.0015746348808494796
Bond Position:  [9.3541238]


portfolio before change:  [9.1986577]
curr_Stock_Price:  100.2168348446683
curr_Factors:  [1.00216835e+02 4.02254022e-02]
mat_Sqrt:  [[ 2.00997604e+01  0.00000000e+00]
 [-8.02250856e-03  1.83818764e-02]]
grads:  [ -0.01693628 -14.73471627]
Stock Position:  -0.01693628029281437
Bond Position:  [10.8959581]


portfolio before change:  [9.19698052]
curr_Stock_Price:  100.47672128310418
curr_Factors:  [1.00476721e+02 4.04303788e-02]
mat_Sqrt:  [[ 2.02031626e+01  0.00000000e+00]
 [-8.04292273e-03  1.84286511e-02]]
grads:  [-3.94325918e-03 -5.29708387e+00]
Stock Position:  -0.003943259184951884
Bond Position:  [9.59318627]


portfolio before change:  [9.20147066]
curr_Stock_Price:  99.94630985003904
curr_Factors:  [9.99463099e+01 3.99478302e-02]
mat_Sqrt:  [[ 1.99762223e+01  0.00000000e+00]
 [-7.99478132e-03  1.83183453e-02]]
grads:  [0.00591107 2.66987512]
Stock Position:  0.005911067347263639
Bond Position:  [8.61068129]


portfolio before change:  [9.20586961]
curr_Stock_Price:  100.32627577543656
curr_Factors:  [1.00326276e+02 3.84270045e-02]
mat_Sqrt:  [[ 1.96667663e+01  0.00000000e+00]
 [-7.84112283e-03  1.79662694e-02]]
grads:  [-0.0024562  -2.23570565]
Stock Position:  -0.0024561952710801783
Bond Position:  [9.45229053]


portfolio before change:  [9.20693292]
curr_Stock_Price:  100.85557214455653
curr_Factors:  [1.00855572e+02 3.87891619e-02]
mat_Sqrt:  [[ 1.98634689e+01  0.00000000e+00]
 [-7.87798573e-03  1.80507330e-02]]
grads:  [  0.01735113 -13.97033742]
Stock Position:  0.017351127855907336
Bond Position:  [7.45697499]


portfolio before change:  [9.20437954]
curr_Stock_Price:  100.6009573265308
curr_Factors:  [1.00600957e+02 3.87920991e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.20437954]
Stock Price:  99.5679624949667
PL:  [9.20437954]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.34147364e-02  2.66219414e-01]
 [-3.21733951e-02 -3.18330887e-02]
 [-1.68727573e-01 -6.11813703e-01]
 [ 1.99845255e-01 -4.01765273e-02]
 [-4.13886973e-01 -1.17207923e-01]
 [ 3.83800260e-01 -4.69203706e-01]
 [-3.77665567e-01  1.49977111e-01]
 [ 1.80239604e-01  1.46846809e-01]
 [-1.61534510e-01 -3.97928896e-02]
 [ 2.34563222e-01  1.14656483e-02]
 [ 1.31801337e-01  1.95567615e-01]
 [-2.37837949e-01  9.34935639e-02]
 [ 2.47387190e-03  4.71426864e-02]
 [-2.19145421e-01 -2.70001004e-01]
 [-1.08837253e-01 -1.29219327e-01]
 [ 8.83763491e-02  7.58588177e-02]
 [ 5.86397251e-02 -8.34993453e-02]
 [ 7.31061542e-01 -3.50325032e-01]
 [ 1.86950754e-01  1.38454692e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.83123202]
curr_Stock_Price:  101.62835314423072
curr_Factors:  [1.01628353e+02 3.93326323e-02]
mat_Sqrt:  [[ 2.01553987e+01  0.00000000e+00]
 [-7.93298252e-03  1.81767464e-02]]
grads:  [6.92630378e-03 1.46461533e+01]
Stock Position:  0.006926303776803373
Bond Position:  [13.12732318]


portfolio before change:  [13.83590141]
curr_Stock_Price:  101.82862477389637
curr_Factors:  [1.01828625e+02 3.90952445e-02]
mat_Sqrt:  [[ 2.01340826e+01  0.00000000e+00]
 [-7.90900697e-03  1.81218116e-02]]
grads:  [-0.00228799 -1.75661736]
Stock Position:  -0.002287985749913663
Bond Position:  [14.06888385]


portfolio before change:  [13.84286384]
curr_Stock_Price:  100.32303148194723
curr_Factors:  [1.00323031e+02 3.99538419e-02]
mat_Sqrt:  [[ 2.00530261e+01  0.00000000e+00]
 [-7.99538285e-03  1.83197236e-02]]
grads:  [-2.17296363e-02 -3.33964484e+01]
Stock Position:  -0.021729636254352046
Bond Position:  [16.02284682]


portfolio before change:  [13.81417644]
curr_Stock_Price:  101.82759496406028
curr_Factors:  [1.01827595e+02 4.03351258e-02]
mat_Sqrt:  [[ 2.04506537e+01  0.00000000e+00]
 [-8.03344268e-03  1.84069296e-02]]
grads:  [ 0.00891467 -2.1826849 ]
Stock Position:  0.00891466766818542
Bond Position:  [12.90641727]


portfolio before change:  [13.79799435]
curr_Stock_Price:  99.65038543404435
curr_Factors:  [9.96503854e+01 4.15278880e-02]
mat_Sqrt:  [[ 2.03071467e+01  0.00000000e+00]
 [-8.15135700e-03  1.86771052e-02]]
grads:  [-0.02290035 -6.27548659]
Stock Position:  -0.022900346987378774
Bond Position:  [16.08002275]


portfolio before change:  [13.78127316]
curr_Stock_Price:  100.55612243192697
curr_Factors:  [1.00556122e+02 4.12054189e-02]
mat_Sqrt:  [[ 2.04120059e+01  0.00000000e+00]
 [-8.11964717e-03  1.86044489e-02]]
grads:  [ 8.77047436e-03 -2.52199734e+01]
Stock Position:  0.008770474364822712
Bond Position:  [12.89934827]


portfolio before change:  [13.76205508]
curr_Stock_Price:  97.99715926003996
curr_Factors:  [9.79971593e+01 4.53442522e-02]
mat_Sqrt:  [[ 2.08677012e+01  0.00000000e+00]
 [-8.51767595e-03  1.95164474e-02]]
grads:  [-0.01496141  7.68465223]
Stock Position:  -0.014961407903008662
Bond Position:  [15.22823056]


portfolio before change:  [13.72260202]
curr_Stock_Price:  100.88863846921896
curr_Factors:  [1.00888638e+02 4.58479315e-02]
mat_Sqrt:  [[ 2.16024065e+01  0.00000000e+00]
 [-8.56485204e-03  1.96245414e-02]]
grads:  [0.01131026 7.48281482]
Stock Position:  0.011310258655372255
Bond Position:  [12.58152542]


portfolio before change:  [13.7338247]
curr_Stock_Price:  101.60276061237049
curr_Factors:  [1.01602761e+02 4.78103766e-02]
mat_Sqrt:  [[ 2.22160370e+01  0.00000000e+00]
 [-8.74623362e-03  2.00401388e-02]]
grads:  [-0.00805281 -1.98565938]
Stock Position:  -0.008052811169376319
Bond Position:  [14.55201254]


portfolio before change:  [13.73284462]
curr_Stock_Price:  102.17629164811007
curr_Factors:  [1.02176292e+02 4.82458355e-02]
mat_Sqrt:  [[ 2.24429557e+01  0.00000000e+00]
 [-8.78597386e-03  2.01311951e-02]]
grads:  [0.0106745  0.56954633]
Stock Position:  0.01067449599296443
Bond Position:  [12.6421642]


portfolio before change:  [13.73133691]
curr_Stock_Price:  101.73892689859244
curr_Factors:  [1.01738927e+02 4.78452880e-02]
mat_Sqrt:  [[ 2.22539311e+01  0.00000000e+00]
 [-8.74942631e-03  2.00474542e-02]]
grads:  [0.00975801 9.75523444]
Stock Position:  0.009758008178383208
Bond Position:  [12.73856762]


portfolio before change:  [13.73264494]
curr_Stock_Price:  101.54657133021472
curr_Factors:  [1.01546571e+02 4.65916010e-02]
mat_Sqrt:  [[ 2.19189165e+01  0.00000000e+00]
 [-8.63403507e-03  1.97830596e-02]]
grads:  [-0.00898922  4.72594056]
Stock Position:  -0.008989222278898612
Bond Position:  [14.64546964]


portfolio before change:  [13.73102027]
curr_Stock_Price:  102.13466320545757
curr_Factors:  [1.02134663e+02 4.71997548e-02]
mat_Sqrt:  [[ 2.21892709e+01  0.00000000e+00]
 [-8.69020182e-03  1.99117538e-02]]
grads:  [1.03872845e-03 2.36758082e+00]
Stock Position:  0.0010387284531171445
Bond Position:  [13.62493009]


portfolio before change:  [13.73231494]
curr_Stock_Price:  100.10141707336179
curr_Factors:  [1.00101417e+02 4.73474225e-02]
mat_Sqrt:  [[ 2.17815307e+01  0.00000000e+00]
 [-8.70378515e-03  1.99428771e-02]]
grads:  [ -0.01547107 -13.5387187 ]
Stock Position:  -0.015471066964476149
Bond Position:  [15.28099067]


portfolio before change:  [13.76741654]
curr_Stock_Price:  98.07952200557433
curr_Factors:  [9.80795220e+01 4.80996222e-02]
mat_Sqrt:  [[ 2.15104340e+01  0.00000000e+00]
 [-8.77265043e-03  2.01006673e-02]]
grads:  [-0.00768154 -6.4286088 ]
Stock Position:  -0.007681536832451611
Bond Position:  [14.520818]


portfolio before change:  [13.77279415]
curr_Stock_Price:  97.85210039164238
curr_Factors:  [9.78521004e+01 4.94851873e-02]
mat_Sqrt:  [[ 2.17674603e+01  0.00000000e+00]
 [-8.89810652e-03  2.03881233e-02]]
grads:  [0.00558098 3.72073567]
Stock Position:  0.005580984168975918
Bond Position:  [13.22668312]


portfolio before change:  [13.76468309]
curr_Stock_Price:  95.80620005986889
curr_Factors:  [9.58062001e+01 4.97427028e-02]
mat_Sqrt:  [[ 2.13677259e+01  0.00000000e+00]
 [-8.92122887e-03  2.04411033e-02]]
grads:  [ 1.03883882e-03 -4.08487468e+00]
Stock Position:  0.0010388388164381506
Bond Position:  [13.66515589]


portfolio before change:  [13.76951312]
curr_Stock_Price:  97.16667500331344
curr_Factors:  [9.71666750e+01 4.68379495e-02]
mat_Sqrt:  [[ 2.10288866e+01  0.00000000e+00]
 [-8.65683078e-03  1.98352912e-02]]
grads:  [  0.02749395 -17.66170354]
Stock Position:  0.027493950310469705
Bond Position:  [11.09801739]


portfolio before change:  [13.79084462]
curr_Stock_Price:  97.84161069385188
curr_Factors:  [9.78416107e+01 4.46888720e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.79084462]
Stock Price:  96.54799038411086
PL:  [13.79084462]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.20512332e-01 -9.65133738e-01]
 [-3.73307513e-02  2.75718802e-01]
 [-4.09302277e-01 -7.06744308e-02]
 [ 8.93156043e-02 -6.56182926e-02]
 [-3.80241034e-01  1.48297643e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.54974000e-01  4.79073084e-03]
 [ 5.53836205e-02  1.31687365e-01]
 [-2.36514644e-01  6.76984423e-02]
 [-8.27563999e-02  3.35190822e-02]
 [-1.09406517e-01 -2.25270424e-01]
 [-1.35518166e-01 -1.42016553e-01]
 [ 8.83234546e-02  3.94278792e-02]
 [ 6.32263276e-02 -8.43210039e-02]
 [ 1.03477314e+00 -4.76204487e-01]
 [ 1.45110549e-01  1.71832239e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.0681344]
curr_Stock_Price:  99.17535450868495
curr_Factors:  [9.91753545e+01 3.96404807e-02]
mat_Sqrt:  [[ 1.97457311e+01  0.00000000e+00]
 [-7.96396693e-03  1.82477406e-02]]
grads:  [ 0.00141152 -0.07402748]
Stock Position:  0.0014115242178422947
Bond Position:  [-3.20812281]


portfolio before change:  [-3.06967349]
curr_Stock_Price:  98.65324768043585
curr_Factors:  [9.86532477e+01 3.97500958e-02]
mat_Sqrt:  [[ 1.96689183e+01  0.00000000e+00]
 [-7.97497042e-03  1.82729528e-02]]
grads:  [-0.00947306 -3.64757524]
Stock Position:  -0.009473061370696695
Bond Position:  [-2.13512522]


portfolio before change:  [-3.06076214]
curr_Stock_Price:  97.65618832243912
curr_Factors:  [9.76561883e+01 3.75126269e-02]
mat_Sqrt:  [[ 1.89142231e+01  0.00000000e+00]
 [-7.74727068e-03  1.77512272e-02]]
grads:  [-3.39285005e-02 -5.43699728e+01]
Stock Position:  -0.03392850046768561
Bond Position:  [0.2525659]


portfolio before change:  [-3.08376532]
curr_Stock_Price:  98.33603965390142
curr_Factors:  [9.83360397e+01 3.58409097e-02]
mat_Sqrt:  [[ 1.86166796e+01  0.00000000e+00]
 [-7.57267822e-03  1.73511856e-02]]
grads:  [4.45851789e-03 1.58904878e+01]
Stock Position:  0.0044585178922338835
Bond Position:  [-3.52219832]


portfolio before change:  [-3.08755648]
curr_Stock_Price:  97.68324590421024
curr_Factors:  [9.76832459e+01 3.56820297e-02]
mat_Sqrt:  [[ 1.84520600e+01  0.00000000e+00]
 [-7.55587504e-03  1.73126847e-02]]
grads:  [-0.02385355 -4.08223405]
Stock Position:  -0.02385354954035771
Bond Position:  [-0.75746433]


portfolio before change:  [-3.10261858]
curr_Stock_Price:  98.30674698930235
curr_Factors:  [9.83067470e+01 3.53328195e-02]
mat_Sqrt:  [[ 1.84787450e+01  0.00000000e+00]
 [-7.51881049e-03  1.72277591e-02]]
grads:  [ 3.28363390e-03 -3.80886987e+00]
Stock Position:  0.0032836338991793397
Bond Position:  [-3.42542195]


portfolio before change:  [-3.103566]
curr_Stock_Price:  98.27904660857533
curr_Factors:  [9.82790466e+01 3.31752653e-02]
mat_Sqrt:  [[ 1.79006226e+01  0.00000000e+00]
 [-7.28563137e-03  1.66934786e-02]]
grads:  [-0.01762613  8.88356741]
Stock Position:  -0.017626126361974026
Bond Position:  [-1.37128711]


portfolio before change:  [-3.1202296]
curr_Stock_Price:  99.2049865761291
curr_Factors:  [9.92049866e+01 3.36588250e-02]
mat_Sqrt:  [[ 1.82004857e+01  0.00000000e+00]
 [-7.33853664e-03  1.68146998e-02]]
grads:  [5.37376595e-03 8.07144856e+00]
Stock Position:  0.005373765945245628
Bond Position:  [-3.65333398]


portfolio before change:  [-3.11578126]
curr_Stock_Price:  100.20275692121075
curr_Factors:  [1.00202757e+02 3.23590907e-02]
mat_Sqrt:  [[ 1.80251059e+01  0.00000000e+00]
 [-7.19545309e-03  1.64868542e-02]]
grads:  [-0.01207099 -3.22371451]
Stock Position:  -0.012070989844953023
Bond Position:  [-1.9062348]


portfolio before change:  [-3.10130855]
curr_Stock_Price:  98.9643060035259
curr_Factors:  [9.89643060e+01 3.39575795e-02]
mat_Sqrt:  [[ 1.82367291e+01  0.00000000e+00]
 [-7.37103298e-03  1.68891583e-02]]
grads:  [0.014096   0.28365717]
Stock Position:  0.014095995248981212
Bond Position:  [-4.49630894]


portfolio before change:  [-3.09312157]
curr_Stock_Price:  99.6248624838149
curr_Factors:  [9.96248625e+01 3.40819063e-02]
mat_Sqrt:  [[ 1.83920303e+01  0.00000000e+00]
 [-7.38451420e-03  1.69200477e-02]]
grads:  [6.13617401e-03 7.78291925e+00]
Stock Position:  0.006136174009134931
Bond Position:  [-3.70443706]


portfolio before change:  [-3.09308138]
curr_Stock_Price:  99.78235649970293
curr_Factors:  [9.97823565e+01 3.35327016e-02]
mat_Sqrt:  [[ 1.82720817e+01  0.00000000e+00]
 [-7.32477457e-03  1.67831670e-02]]
grads:  [-0.01132704  4.03371083]
Stock Position:  -0.011327041184628262
Bond Position:  [-1.96284252]


portfolio before change:  [-3.07726028]
curr_Stock_Price:  98.3422738976604
curr_Factors:  [9.83422739e+01 3.37978421e-02]
mat_Sqrt:  [[ 1.80794299e+01  0.00000000e+00]
 [-7.35367577e-03  1.68493879e-02]]
grads:  [-0.00376823  1.9893353 ]
Stock Position:  -0.0037682312678861862
Bond Position:  [-2.70668385]


portfolio before change:  [-3.07525301]
curr_Stock_Price:  97.62999727880175
curr_Factors:  [9.76299973e+01 3.35229521e-02]
mat_Sqrt:  [[ 1.78753439e+01  0.00000000e+00]
 [-7.32370968e-03  1.67807270e-02]]
grads:  [-1.16206206e-02 -1.34243543e+01]
Stock Position:  -0.011620620638808874
Bond Position:  [-1.94073185]


portfolio before change:  [-3.07047576]
curr_Stock_Price:  97.17713864526726
curr_Factors:  [9.71771386e+01 3.38519775e-02]
mat_Sqrt:  [[ 1.78795313e+01  0.00000000e+00]
 [-7.35956276e-03  1.68628767e-02]]
grads:  [-0.01104611 -8.42184615]
Stock Position:  -0.011046110129892291
Bond Position:  [-1.99704638]


portfolio before change:  [-3.04881372]
curr_Stock_Price:  95.17087893068745
curr_Factors:  [9.51708789e+01 3.45481770e-02]
mat_Sqrt:  [[ 1.76895444e+01  0.00000000e+00]
 [-7.43485596e-03  1.70353951e-02]]
grads:  [0.00596574 2.31446814]
Stock Position:  0.005965738256056705
Bond Position:  [-3.61657827]


portfolio before change:  [-3.04950778]
curr_Stock_Price:  95.20611280546395
curr_Factors:  [9.52061128e+01 3.81755495e-02]
mat_Sqrt:  [[ 1.86019076e+01  0.00000000e+00]
 [-7.81542572e-03  1.79073900e-02]]
grads:  [ 1.42058680e-03 -4.70872662e+00]
Stock Position:  0.0014205868035483868
Bond Position:  [-3.18475633]


portfolio before change:  [-3.0520713]
curr_Stock_Price:  93.9620937390053
curr_Factors:  [9.39620937e+01 3.71614869e-02]
mat_Sqrt:  [[ 1.81133687e+01  0.00000000e+00]
 [-7.71092596e-03  1.76679509e-02]]
grads:  [  0.0456536  -26.95301161]
Stock Position:  0.04565359885274371
Bond Position:  [-7.34177904]


portfolio before change:  [-3.03639821]
curr_Stock_Price:  94.34560723262578
curr_Factors:  [9.43456072e+01 3.63083480e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.03639821]
Stock Price:  95.90499829775271
PL:  [-3.03639821]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.77989422e-01 -1.25573381e+00]
 [-3.99037649e-02  2.75449169e-01]
 [-4.29210184e-01 -9.41332085e-02]
 [ 3.16690825e-01 -3.64532539e-01]
 [-3.87187800e-01  1.55198378e-01]
 [ 1.54592908e-02  1.64891847e-01]
 [-1.97095564e-01 -4.25871075e-02]
 [ 2.39626376e-01  5.75244544e-03]
 [-9.92854210e-02 -2.87883324e-02]
 [-2.36516561e-01  6.77358000e-02]
 [-3.58205850e-02  3.69590918e-02]
 [-2.01208581e-01 -2.64960711e-01]
 [-1.04165178e-01 -1.26978414e-01]
 [ 8.83084109e-02  6.76997798e-02]
 [ 6.10848390e-02 -8.39373708e-02]
 [ 9.30518140e-01 -4.33307294e-01]
 [ 1.48344407e-01  1.71621834e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.05019611]
curr_Stock_Price:  98.74249843912324
curr_Factors:  [9.87424984e+01 4.24846442e-02]
mat_Sqrt:  [[ 2.03526097e+01  0.00000000e+00]
 [-8.24472139e-03  1.88910299e-02]]
grads:  [ 0.00136944 -0.07150665]
Stock Position:  0.0013694350748908574
Bond Position:  [-6.18541755]


portfolio before change:  [-6.05131959]
curr_Stock_Price:  99.05143773864835
curr_Factors:  [9.90514377e+01 4.34002722e-02]
mat_Sqrt:  [[ 2.06351206e+01  0.00000000e+00]
 [-8.33309279e-03  1.90935143e-02]]
grads:  [-0.0090295  -3.49081732]
Stock Position:  -0.009029502383726531
Bond Position:  [-5.1569344]


portfolio before change:  [-6.02581469]
curr_Stock_Price:  96.08402114590501
curr_Factors:  [9.60840211e+01 4.55619839e-02]
mat_Sqrt:  [[ 2.05093777e+01  0.00000000e+00]
 [-8.53810133e-03  1.95632478e-02]]
grads:  [-3.54002251e-02 -6.41884120e+01]
Stock Position:  -0.035400225096208736
Bond Position:  [-2.62441871]


portfolio before change:  [-6.11541274]
curr_Stock_Price:  98.59648722852695
curr_Factors:  [9.85964872e+01 4.60190695e-02]
mat_Sqrt:  [[ 2.11509734e+01  0.00000000e+00]
 [-8.58082229e-03  1.96611338e-02]]
grads:  [3.79708804e-03 1.40098313e+01]
Stock Position:  0.0037970880422741153
Bond Position:  [-6.48979228]


portfolio before change:  [-6.11766416]
curr_Stock_Price:  98.43089488007664
curr_Factors:  [9.84308949e+01 5.00929842e-02]
mat_Sqrt:  [[ 2.20302734e+01  0.00000000e+00]
 [-8.95258481e-03  2.05129488e-02]]
grads:  [-0.02134759 -4.58896522]
Stock Position:  -0.021347591869642833
Bond Position:  [-4.01640159]


portfolio before change:  [-6.14380986]
curr_Stock_Price:  99.60861440171246
curr_Factors:  [9.96086144e+01 5.16957276e-02]
mat_Sqrt:  [[ 2.26477063e+01  0.00000000e+00]
 [-9.09467779e-03  2.08385247e-02]]
grads:  [ 6.95857585e-03 -1.74932028e+01]
Stock Position:  0.00695857584720523
Bond Position:  [-6.83694396]


portfolio before change:  [-6.15684268]
curr_Stock_Price:  97.98136070675633
curr_Factors:  [9.79813607e+01 5.29779267e-02]
mat_Sqrt:  [[ 2.25523055e+01  0.00000000e+00]
 [-9.20677374e-03  2.10953688e-02]]
grads:  [-0.01416501  7.35698812]
Stock Position:  -0.014165011885017025
Bond Position:  [-4.76893554]


portfolio before change:  [-6.15685406]
curr_Stock_Price:  97.89798636909735
curr_Factors:  [9.78979864e+01 5.16210027e-02]
mat_Sqrt:  [[ 2.22426730e+01  0.00000000e+00]
 [-9.08810235e-03  2.08234585e-02]]
grads:  [3.93046253e-03 7.91856199e+00]
Stock Position:  0.003930462525784789
Bond Position:  [-6.54163843]


portfolio before change:  [-6.15587585]
curr_Stock_Price:  98.56300292625157
curr_Factors:  [9.85630029e+01 5.09995213e-02]
mat_Sqrt:  [[ 2.22585555e+01  0.00000000e+00]
 [-9.03322944e-03  2.06977288e-02]]
grads:  [-0.00968985 -2.05757394]
Stock Position:  -0.009689851697933632
Bond Position:  [-5.20081497]


portfolio before change:  [-6.15598507]
curr_Stock_Price:  98.44007481334741
curr_Factors:  [9.84400748e+01 4.97067792e-02]
mat_Sqrt:  [[ 2.19472316e+01  0.00000000e+00]
 [-8.91800688e-03  2.04337208e-02]]
grads:  [0.01103269 0.28151728]
Stock Position:  0.01103268755281164
Bond Position:  [-7.24204365]


portfolio before change:  [-6.1780043]
curr_Stock_Price:  96.60838162989799
curr_Factors:  [9.66083816e+01 5.05905079e-02]
mat_Sqrt:  [[ 2.17294797e+01  0.00000000e+00]
 [-8.99693351e-03  2.06145644e-02]]
grads:  [-0.00514737 -1.39650452]
Stock Position:  -0.005147370351752081
Bond Position:  [-5.68072518]


portfolio before change:  [-6.19573378]
curr_Stock_Price:  99.7768182755083
curr_Factors:  [9.97768183e+01 4.97831161e-02]
mat_Sqrt:  [[ 2.22623338e+01  0.00000000e+00]
 [-8.92485214e-03  2.04494053e-02]]
grads:  [-0.00929616  3.31236039]
Stock Position:  -0.009296160782644568
Bond Position:  [-5.26819243]


portfolio before change:  [-6.19696433]
curr_Stock_Price:  99.76749629543598
curr_Factors:  [9.97674963e+01 4.67872265e-02]
mat_Sqrt:  [[ 2.15800638e+01  0.00000000e+00]
 [-8.65214207e-03  1.98245480e-02]]
grads:  [-9.12430800e-04  1.86430943e+00]
Stock Position:  -0.000912430800395998
Bond Position:  [-6.1059334]


portfolio before change:  [-6.19821983]
curr_Stock_Price:  99.47029107407904
curr_Factors:  [9.94702911e+01 4.51831816e-02]
mat_Sqrt:  [[ 2.11437392e+01  0.00000000e+00]
 [-8.50253436e-03  1.94817537e-02]]
grads:  [ -0.01498538 -13.60045484]
Stock Position:  -0.014985377583978181
Bond Position:  [-4.70761996]


portfolio before change:  [-6.18313876]
curr_Stock_Price:  98.38535863212577
curr_Factors:  [9.83853586e+01 4.88604693e-02]
mat_Sqrt:  [[ 2.17474975e+01  0.00000000e+00]
 [-8.84176175e-03  2.02590213e-02]]
grads:  [-0.007338   -6.26774671]
Stock Position:  -0.0073379983665758566
Bond Position:  [-5.46118716]


portfolio before change:  [-6.17607771]
curr_Stock_Price:  97.23701846889873
curr_Factors:  [9.72370185e+01 4.75844970e-02]
mat_Sqrt:  [[ 2.12111578e+01  0.00000000e+00]
 [-8.72554842e-03  1.99927431e-02]]
grads:  [0.00555627 3.38621767]
Stock Position:  0.0055562745876526175
Bond Position:  [-6.71635328]


portfolio before change:  [-6.18748554]
curr_Stock_Price:  95.48610918037205
curr_Factors:  [9.54861092e+01 4.91592323e-02]
mat_Sqrt:  [[ 2.11710668e+01  0.00000000e+00]
 [-8.86875254e-03  2.03208649e-02]]
grads:  [ 1.15495205e-03 -4.13060030e+00]
Stock Position:  0.0011549520524087335
Bond Position:  [-6.29776741]


portfolio before change:  [-6.1895718]
curr_Stock_Price:  95.04312263598769
curr_Factors:  [9.50431226e+01 5.10763645e-02]
mat_Sqrt:  [[ 2.14798224e+01  0.00000000e+00]
 [-9.04003226e-03  2.07133160e-02]]
grads:  [  0.03451646 -20.91926242]
Stock Position:  0.03451645552553451
Bond Position:  [-9.47012352]


portfolio before change:  [-6.2128579]
curr_Stock_Price:  94.4370850533197
curr_Factors:  [9.44370851e+01 5.24001181e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.2128579]
Stock Price:  95.663625421051
PL:  [-6.2128579]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.78554859e-01 -1.24238170e+00]
 [-2.45424281e-02  2.77058926e-01]
 [-4.24791220e-01 -5.01959256e-02]
 [-2.95409873e-02  8.94533837e-02]
 [-3.74606052e-01  1.48299507e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-1.98246786e-01 -3.81016914e-02]
 [ 2.26402503e-01  6.58108127e-03]
 [-5.50012262e-02  2.44904187e-02]
 [-2.36023417e-01  5.81229692e-02]
 [-8.52130373e-02  3.33390309e-02]
 [-1.09125794e-01 -2.25143459e-01]
 [-1.15518488e-01 -1.32423913e-01]
 [ 8.88562833e-02  7.62399373e-02]
 [-5.16803165e-02 -2.96112230e-02]
 [ 4.93892231e-01 -2.63567498e-01]
 [ 1.99804689e-01  1.31768394e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.21630896]
curr_Stock_Price:  98.42808003227165
curr_Factors:  [9.8428080e+01 3.9950547e-02]
mat_Sqrt:  [[ 1.96734433e+01  0.00000000e+00]
 [-7.99505317e-03  1.83189682e-02]]
grads:  [ 0.00141671 -0.07373965]
Stock Position:  0.0014167106961986448
Bond Position:  [-8.35575308]


portfolio before change:  [-8.21874543]
curr_Stock_Price:  98.18295582542903
curr_Factors:  [9.81829558e+01 3.76962480e-02]
mat_Sqrt:  [[ 1.90627330e+01  0.00000000e+00]
 [-7.76620865e-03  1.77946195e-02]]
grads:  [-0.0097743  -3.74562492]
Stock Position:  -0.009774299942918497
Bond Position:  [-7.25907577]


portfolio before change:  [-8.20048075]
curr_Stock_Price:  96.12862194960219
curr_Factors:  [9.61286219e+01 3.76715064e-02]
mat_Sqrt:  [[ 1.86577474e+01  0.00000000e+00]
 [-7.76365959e-03  1.77887789e-02]]
grads:  [-3.86313883e-02 -6.98407525e+01]
Stock Position:  -0.0386313883324627
Bond Position:  [-4.48689863]


portfolio before change:  [-8.23440955]
curr_Stock_Price:  96.97785187566939
curr_Factors:  [9.69778519e+01 3.71033041e-02]
mat_Sqrt:  [[ 1.86800852e+01  0.00000000e+00]
 [-7.70488718e-03  1.76541144e-02]]
grads:  [5.15929128e-03 1.56937312e+01]
Stock Position:  0.00515929127553605
Bond Position:  [-8.73474653]


portfolio before change:  [-8.24032214]
curr_Stock_Price:  96.25515022578077
curr_Factors:  [9.62551502e+01 3.79956675e-02]
mat_Sqrt:  [[ 1.87625134e+01  0.00000000e+00]
 [-7.79699095e-03  1.78651506e-02]]
grads:  [-0.02380803 -2.80971186]
Stock Position:  -0.023808031911223763
Bond Position:  [-5.94867645]


portfolio before change:  [-8.27297073]
curr_Stock_Price:  97.56400403109579
curr_Factors:  [9.75640040e+01 3.87542319e-02]
mat_Sqrt:  [[ 1.92065421e+01  0.00000000e+00]
 [-7.87443782e-03  1.80426037e-02]]
grads:  [4.94605952e-04 4.95789772e+00]
Stock Position:  0.0004946059521334739
Bond Position:  [-8.32122646]


portfolio before change:  [-8.27476872]
curr_Stock_Price:  98.13531875038883
curr_Factors:  [9.81353188e+01 3.87459022e-02]
mat_Sqrt:  [[ 1.93169353e+01  0.00000000e+00]
 [-7.87359152e-03  1.80406646e-02]]
grads:  [-0.01604203  8.22029067]
Stock Position:  -0.0160420292155349
Bond Position:  [-6.70047907]


portfolio before change:  [-8.29403644]
curr_Stock_Price:  99.23196258903822
curr_Factors:  [9.92319626e+01 3.81557029e-02]
mat_Sqrt:  [[ 1.93834603e+01  0.00000000e+00]
 [-7.81339392e-03  1.79027345e-02]]
grads:  [5.04580444e-03 7.58090806e+00]
Stock Position:  0.00504580444310912
Bond Position:  [-8.79474152]


portfolio before change:  [-8.29936238]
curr_Stock_Price:  98.61224409499033
curr_Factors:  [9.86122441e+01 3.82207164e-02]
mat_Sqrt:  [[ 1.92788113e+01  0.00000000e+00]
 [-7.82004771e-03  1.79179803e-02]]
grads:  [-0.01114569 -2.12645012]
Stock Position:  -0.011145693754640295
Bond Position:  [-7.2002605]


portfolio before change:  [-8.29243091]
curr_Stock_Price:  97.82882388816874
curr_Factors:  [9.78288239e+01 3.69627956e-02]
mat_Sqrt:  [[ 1.88082868e+01  0.00000000e+00]
 [-7.69028432e-03  1.76206550e-02]]
grads:  [0.01219009 0.37348676]
Stock Position:  0.012190090762541917
Bond Position:  [-9.48497315]


portfolio before change:  [-8.29666124]
curr_Stock_Price:  97.67633942561292
curr_Factors:  [9.76763394e+01 3.73335379e-02]
mat_Sqrt:  [[ 1.88729135e+01  0.00000000e+00]
 [-7.72875544e-03  1.77088034e-02]]
grads:  [-0.00234795  1.38295164]
Stock Position:  -0.0023479539209925377
Bond Position:  [-8.0673217]


portfolio before change:  [-8.30144358]
curr_Stock_Price:  98.85406644769208
curr_Factors:  [9.88540664e+01 3.79023480e-02]
mat_Sqrt:  [[ 1.92454290e+01  0.00000000e+00]
 [-7.78741014e-03  1.78431982e-02]]
grads:  [-0.01094579  3.25743   ]
Stock Position:  -0.010945792562501439
Bond Position:  [-7.21940747]


portfolio before change:  [-8.29692832]
curr_Stock_Price:  98.2766448794813
curr_Factors:  [9.82766449e+01 3.60575376e-02]
mat_Sqrt:  [[ 1.86615775e+01  0.00000000e+00]
 [-7.59552895e-03  1.74035432e-02]]
grads:  [-0.00378653  1.91564617]
Stock Position:  -0.003786533648888725
Bond Position:  [-7.92480049]


portfolio before change:  [-8.29642588]
curr_Stock_Price:  97.62066734745119
curr_Factors:  [9.76206673e+01 3.59219379e-02]
mat_Sqrt:  [[ 1.85021267e+01  0.00000000e+00]
 [-7.58123345e-03  1.73707881e-02]]
grads:  [-1.12087901e-02 -1.29610388e+01]
Stock Position:  -0.011208790114773565
Bond Position:  [-7.20221631]


portfolio before change:  [-8.30054985]
curr_Stock_Price:  97.82793217145603
curr_Factors:  [9.78279322e+01 3.54095725e-02]
mat_Sqrt:  [[ 1.84087040e+01  0.00000000e+00]
 [-7.52697257e-03  1.72464608e-02]]
grads:  [-0.00941473 -7.67832394]
Stock Position:  -0.009414732370885668
Bond Position:  [-7.37952605]


portfolio before change:  [-8.30406116]
curr_Stock_Price:  98.0049103770187
curr_Factors:  [9.80049104e+01 3.72955199e-02]
mat_Sqrt:  [[ 1.89267554e+01  0.00000000e+00]
 [-7.72481921e-03  1.76997844e-02]]
grads:  [0.00645278 4.30739356]
Stock Position:  0.006452776369931335
Bond Position:  [-8.93646493]


portfolio before change:  [-8.2853566]
curr_Stock_Price:  101.24986452404784
curr_Factors:  [1.01249865e+02 3.48003286e-02]
mat_Sqrt:  [[ 1.88880065e+01  0.00000000e+00]
 [-7.46193848e-03  1.70974489e-02]]
grads:  [-0.00342036 -1.73190884]
Stock Position:  -0.0034203563898007236
Bond Position:  [-7.93904598]


portfolio before change:  [-8.28387651]
curr_Stock_Price:  100.23678373275371
curr_Factors:  [1.00236784e+02 3.50234519e-02]
mat_Sqrt:  [[ 1.87588667e+01  0.00000000e+00]
 [-7.48582147e-03  1.71521718e-02]]
grads:  [  0.02019642 -15.36642132]
Stock Position:  0.020196419690179577
Bond Position:  [-10.30830066]


portfolio before change:  [-8.31751525]
curr_Stock_Price:  98.69882099689659
curr_Factors:  [9.86988210e+01 3.49640961e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.31751525]
Stock Price:  97.96114377949257
PL:  [-8.31751525]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.28281637e-01 -5.75683579e-02]
 [-1.34745671e-01 -1.69833730e+00]
 [ 5.11251060e-03  2.80166550e-01]
 [-4.47135016e-01 -2.27105889e-02]
 [ 5.61617244e-01 -4.48135584e-01]
 [-1.29298754e-02  1.65410427e-02]
 [-1.17248554e-01 -1.52120627e-01]
 [-2.41570312e-01  1.37941903e-01]
 [ 9.96718500e-02  1.45222921e-02]
 [-9.71558422e-02 -2.17726722e-02]
 [-6.09233709e-02 -2.34167150e-02]
 [ 1.57834696e-01 -2.05112962e-02]
 [ 8.60411656e-02 -1.03690434e-02]
 [-2.97933362e-01 -1.01123119e-01]
 [ 7.81747689e-02  9.43275666e-02]
 [ 1.51413508e-02 -5.00832496e-02]
 [ 1.39809644e+00 -6.27482909e-01]
 [ 2.67652307e-01  2.62835059e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.08208376]
curr_Stock_Price:  99.02817642200804
curr_Factors:  [9.90281764e+01 4.09525424e-02]
mat_Sqrt:  [[ 2.00400692e+01  0.00000000e+00]
 [-8.09469380e-03  1.85472735e-02]]
grads:  [ 0.00139079 -0.07283196]
Stock Position:  0.0013907924867886325
Bond Position:  [-4.21981141]


portfolio before change:  [-4.08923367]
curr_Stock_Price:  94.64591230304876
curr_Factors:  [9.46459123e+01 4.32483927e-02]
mat_Sqrt:  [[ 1.96827986e+01  0.00000000e+00]
 [-8.31849916e-03  1.90600760e-02]]
grads:  [-0.00779394 -3.0203635 ]
Stock Position:  -0.0077939388372525705
Bond Position:  [-3.35156922]


portfolio before change:  [-4.08166441]
curr_Stock_Price:  93.56722039896412
curr_Factors:  [9.35672204e+01 4.49971139e-02]
mat_Sqrt:  [[ 1.98479683e+01  0.00000000e+00]
 [-8.48500926e-03  1.94415986e-02]]
grads:  [-4.41335266e-02 -8.73558465e+01]
Stock Position:  -0.04413352663267934
Bond Position:  [0.04778701]


portfolio before change:  [-4.07747711]
curr_Stock_Price:  93.47261316814921
curr_Factors:  [9.34726132e+01 4.41510554e-02]
mat_Sqrt:  [[ 1.96406080e+01  0.00000000e+00]
 [-8.40486101e-03  1.92579559e-02]]
grads:  [6.48591007e-03 1.45480939e+01]
Stock Position:  0.006485910069515298
Bond Position:  [-4.68373207]


portfolio before change:  [-4.07324564]
curr_Stock_Price:  94.30557927335191
curr_Factors:  [9.43055793e+01 4.40832478e-02]
mat_Sqrt:  [[ 1.98004098e+01  0.00000000e+00]
 [-8.39840440e-03  1.92431619e-02]]
grads:  [-0.02308269 -1.18019008]
Stock Position:  -0.02308269044822754
Bond Position:  [-1.89641915]


portfolio before change:  [-4.01660088]
curr_Stock_Price:  91.83104405897365
curr_Factors:  [9.18310441e+01 4.58781991e-02]
mat_Sqrt:  [[ 1.96694720e+01  0.00000000e+00]
 [-8.56767871e-03  1.96310181e-02]]
grads:  [ 1.86092865e-02 -2.28279339e+01]
Stock Position:  0.018609286485036593
Bond Position:  [-5.72551108]


portfolio before change:  [-4.02527216]
curr_Stock_Price:  91.4420056437682
curr_Factors:  [9.14420056e+01 4.42861518e-02]
mat_Sqrt:  [[ 1.92433073e+01  0.00000000e+00]
 [-8.41771007e-03  1.92873968e-02]]
grads:  [-2.96766684e-04  8.57608878e-01]
Stock Position:  -0.0002967666835906029
Bond Position:  [-3.99813522]


portfolio before change:  [-4.02676637]
curr_Stock_Price:  93.10846612128988
curr_Factors:  [9.31084661e+01 4.20578565e-02]
mat_Sqrt:  [[ 1.90946956e+01  0.00000000e+00]
 [-8.20320489e-03  1.87959037e-02]]
grads:  [-0.0096173  -8.09328616]
Stock Position:  -0.009617301168920274
Bond Position:  [-3.13131421]


portfolio before change:  [-4.02639714]
curr_Stock_Price:  92.9886661930311
curr_Factors:  [9.29886662e+01 4.22795920e-02]
mat_Sqrt:  [[ 1.91203313e+01  0.00000000e+00]
 [-8.22480073e-03  1.88453860e-02]]
grads:  [-0.00948559  7.31966452]
Stock Position:  -0.009485585120441037
Bond Position:  [-3.14434524]


portfolio before change:  [-4.03252847]
curr_Stock_Price:  93.55216741766776
curr_Factors:  [9.35521674e+01 4.06857228e-02]
mat_Sqrt:  [[ 1.88701291e+01  0.00000000e+00]
 [-8.06828089e-03  1.84867540e-02]]
grads:  [0.00561787 0.78555122]
Stock Position:  0.005617868178349757
Bond Position:  [-4.55809221]


portfolio before change:  [-4.04140233]
curr_Stock_Price:  92.17545422765689
curr_Factors:  [9.21754542e+01 3.90151877e-02]
mat_Sqrt:  [[ 1.82067378e+01  0.00000000e+00]
 [-7.90090503e-03  1.81032477e-02]]
grads:  [-0.00585817 -1.20269427]
Stock Position:  -0.005858172774669292
Bond Position:  [-3.50142259]


portfolio before change:  [-4.039897]
curr_Stock_Price:  91.76904852451129
curr_Factors:  [9.17690485e+01 4.16546989e-02]
mat_Sqrt:  [[ 1.87295882e+01  0.00000000e+00]
 [-8.16379312e-03  1.87056000e-02]]
grads:  [-0.00379844 -1.25185587]
Stock Position:  -0.003798442469853898
Bond Position:  [-3.69131755]


portfolio before change:  [-4.0461827]
curr_Stock_Price:  93.18088013003901
curr_Factors:  [9.31808801e+01 3.93622599e-02]
mat_Sqrt:  [[ 1.84870161e+01  0.00000000e+00]
 [-7.93596974e-03  1.81835910e-02]]
grads:  [ 0.00805337 -1.1280113 ]
Stock Position:  0.008053372776516566
Bond Position:  [-4.79660307]


portfolio before change:  [-4.05304314]
curr_Stock_Price:  92.477927907479
curr_Factors:  [9.24779279e+01 4.18096869e-02]
mat_Sqrt:  [[ 1.89093477e+01  0.00000000e+00]
 [-8.17896687e-03  1.87403674e-02]]
grads:  [ 0.00431087 -0.5532999 ]
Stock Position:  0.004310870221692966
Bond Position:  [-4.45170348]


portfolio before change:  [-4.06075064]
curr_Stock_Price:  90.94820622449603
curr_Factors:  [9.09482062e+01 4.20375165e-02]
mat_Sqrt:  [[ 1.86471585e+01  0.00000000e+00]
 [-8.20122103e-03  1.87913581e-02]]
grads:  [-0.01834419 -5.38136302]
Stock Position:  -0.018344194858635123
Bond Position:  [-2.39237902]


portfolio before change:  [-4.03506426]
curr_Stock_Price:  89.51535274461064
curr_Factors:  [8.95153527e+01 4.52871495e-02]
mat_Sqrt:  [[ 1.90495631e+01  0.00000000e+00]
 [-8.51231104e-03  1.95041548e-02]]
grads:  [0.00626485 4.83628065]
Stock Position:  0.006264852023059324
Bond Position:  [-4.5958647]


portfolio before change:  [-4.02419303]
curr_Stock_Price:  91.43404741060178
curr_Factors:  [9.14340474e+01 4.67397775e-02]
mat_Sqrt:  [[ 1.97674780e+01  0.00000000e+00]
 [-8.64775369e-03  1.98144929e-02]]
grads:  [-3.39788988e-04 -2.52760692e+00]
Stock Position:  -0.00033978898820449647
Bond Position:  [-3.99312475]


portfolio before change:  [-4.02473358]
curr_Stock_Price:  90.08657894520667
curr_Factors:  [9.00865789e+01 4.89643202e-02]
mat_Sqrt:  [[ 1.99342527e+01  0.00000000e+00]
 [-8.85115316e-03  2.02805397e-02]]
grads:  [  0.05639742 -30.94014848]
Stock Position:  0.05639742149489068
Bond Position:  [-9.10538435]


portfolio before change:  [-4.05799151]
curr_Stock_Price:  89.5372400359073
curr_Factors:  [8.95372400e+01 4.57314089e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.05799151]
Stock Price:  91.71649618975162
PL:  [-4.05799151]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-8.33208356e-02  2.02980207e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.49177479e-01 -4.78426193e-01]
 [ 1.23958096e-01  7.85505715e-02]
 [-2.11391933e-01 -9.06025207e-02]
 [ 4.03279468e-01 -4.99585596e-01]
 [-5.28230498e-01  3.03839498e-01]
 [ 3.79835584e-01  1.62524899e-01]
 [-9.33644783e-02 -2.60328575e-02]
 [ 1.53534051e-01  1.58601849e-02]
 [ 2.33274386e-01  3.46550216e-01]
 [-2.38907030e-01  1.14333124e-01]
 [ 1.58449412e-03  4.77997194e-02]
 [-2.83908436e-01 -2.49411899e-01]
 [ 8.93932540e-02 -4.33102769e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.25225986e-02  1.18053087e-01]
 [ 2.34077328e-01 -1.32036291e-01]
 [ 9.28078417e-02 -1.67482116e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.46602479]
curr_Stock_Price:  99.97865592171253
curr_Factors:  [9.99786559e+01 3.98994370e-02]
mat_Sqrt:  [[ 1.99705800e+01  0.00000000e+00]
 [-7.98993737e-03  1.83072464e-02]]
grads:  [-0.00372859  1.10874242]
Stock Position:  -0.0037285874136047635
Bond Position:  [2.83880395]


portfolio before change:  [2.46533678]
curr_Stock_Price:  100.35354191433274
curr_Factors:  [1.00353542e+02 4.05190319e-02]
mat_Sqrt:  [[ 2.02005054e+01  0.00000000e+00]
 [-8.05173591e-03  1.84488446e-02]]
grads:  [-0.00922377 -3.61279915]
Stock Position:  -0.009223772688914245
Bond Position:  [3.39097504]


portfolio before change:  [2.45627249]
curr_Stock_Price:  101.42817184983473
curr_Factors:  [1.01428172e+02 3.99595480e-02]
mat_Sqrt:  [[ 2.02753744e+01  0.00000000e+00]
 [-7.99595378e-03  1.83210317e-02]]
grads:  [-1.76558904e-02 -2.61134962e+01]
Stock Position:  -0.01765589042290948
Bond Position:  [4.24707718]


portfolio before change:  [2.46786951]
curr_Stock_Price:  100.83148048552195
curr_Factors:  [1.00831480e+02 3.78660212e-02]
mat_Sqrt:  [[ 1.96209929e+01  0.00000000e+00]
 [-7.78367741e-03  1.78346455e-02]]
grads:  [0.00806485 4.40438089]
Stock Position:  0.00806485057585567
Bond Position:  [1.65467868]


portfolio before change:  [2.47487855]
curr_Stock_Price:  101.64926658537188
curr_Factors:  [1.01649267e+02 3.55141074e-02]
mat_Sqrt:  [[ 1.91559944e+01  0.00000000e+00]
 [-7.53807481e-03  1.72718992e-02]]
grads:  [-0.01309951 -5.24566058]
Stock Position:  -0.013099508697713865
Bond Position:  [3.806434]


portfolio before change:  [2.48637998]
curr_Stock_Price:  100.84391602148003
curr_Factors:  [1.00843916e+02 3.50878772e-02]
mat_Sqrt:  [[ 1.88898387e+01  0.00000000e+00]
 [-7.49270335e-03  1.71679401e-02]]
grads:  [ 9.80645954e-03 -2.90999149e+01]
Stock Position:  0.009806459537729243
Bond Position:  [1.49745819]


portfolio before change:  [2.49070166]
curr_Stock_Price:  101.24643343836507
curr_Factors:  [1.01246433e+02 3.59004720e-02]
mat_Sqrt:  [[ 1.91835868e+01  0.00000000e+00]
 [-7.57896795e-03  1.73655972e-02]]
grads:  [-0.02062305 17.49663404]
Stock Position:  -0.020623049948489264
Bond Position:  [4.57871191]


portfolio before change:  [2.45828956]
curr_Stock_Price:  102.87358962645605
curr_Factors:  [1.02873590e+02 3.49514386e-02]
mat_Sqrt:  [[ 1.92325302e+01  0.00000000e+00]
 [-7.47812154e-03  1.71345290e-02]]
grads:  [0.02343775 9.4852271 ]
Stock Position:  0.02343775165581535
Bond Position:  [0.04716391]


portfolio before change:  [2.44868361]
curr_Stock_Price:  102.46323697631321
curr_Factors:  [1.02463237e+02 3.50096773e-02]
mat_Sqrt:  [[ 1.91717663e+01  0.00000000e+00]
 [-7.48434925e-03  1.71487985e-02]]
grads:  [-0.00546252 -1.51805723]
Stock Position:  -0.005462519591560753
Bond Position:  [3.00839104]


portfolio before change:  [2.44348259]
curr_Stock_Price:  103.55306583207624
curr_Factors:  [1.03553066e+02 3.54005227e-02]
mat_Sqrt:  [[ 1.94835369e+01  0.00000000e+00]
 [-7.52601065e-03  1.72442568e-02]]
grads:  [0.00823547 0.91973723]
Stock Position:  0.008235465879280883
Bond Position:  [1.59067485]


portfolio before change:  [2.45532737]
curr_Stock_Price:  104.94303729498333
curr_Factors:  [1.04943037e+02 3.56312691e-02]
mat_Sqrt:  [[ 1.98093067e+01  0.00000000e+00]
 [-7.55049870e-03  1.73003659e-02]]
grads:  [1.94111438e-02 2.00313807e+01]
Stock Position:  0.01941114378833914
Bond Position:  [0.41826298]


portfolio before change:  [2.42973162]
curr_Stock_Price:  103.61903861066601
curr_Factors:  [1.03619039e+02 3.58101794e-02]
mat_Sqrt:  [[ 1.96084293e+01  0.00000000e+00]
 [-7.56943109e-03  1.73437455e-02]]
grads:  [-0.00963912  6.59218184]
Stock Position:  -0.009639118000285607
Bond Position:  [3.42852776]


portfolio before change:  [2.44459395]
curr_Stock_Price:  102.16609501007713
curr_Factors:  [1.02166095e+02 3.83942359e-02]
mat_Sqrt:  [[ 2.00188815e+01  0.00000000e+00]
 [-7.83777886e-03  1.79586075e-02]]
grads:  [1.12124156e-03 2.66166068e+00]
Stock Position:  0.0011212415624895693
Bond Position:  [2.33004108]


portfolio before change:  [2.44585066]
curr_Stock_Price:  102.76732799192779
curr_Factors:  [1.02767328e+02 3.94302890e-02]
mat_Sqrt:  [[ 2.04065715e+01  0.00000000e+00]
 [-7.94282458e-03  1.81992974e-02]]
grads:  [ -0.01924678 -13.70447952]
Stock Position:  -0.019246776132099182
Bond Position:  [4.42379042]


portfolio before change:  [2.46140764]
curr_Stock_Price:  102.01650640160098
curr_Factors:  [1.02016506e+02 3.93693429e-02]
mat_Sqrt:  [[ 2.02418187e+01  0.00000000e+00]
 [-7.93668373e-03  1.81852270e-02]]
grads:  [ 0.00348245 -2.38161871]
Stock Position:  0.003482448917965778
Bond Position:  [2.10614037]


portfolio before change:  [2.46789781]
curr_Stock_Price:  103.72897076805127
curr_Factors:  [1.03728971e+02 3.65382782e-02]
mat_Sqrt:  [[ 1.98277807e+01  0.00000000e+00]
 [-7.64599537e-03  1.75191763e-02]]
grads:  [0.00484149 1.00067808]
Stock Position:  0.004841486369395925
Bond Position:  [1.96569541]


portfolio before change:  [2.47409189]
curr_Stock_Price:  104.90683064376577
curr_Factors:  [1.04906831e+02 3.57311532e-02]
mat_Sqrt:  [[ 1.98302086e+01  0.00000000e+00]
 [-7.56107433e-03  1.73245977e-02]]
grads:  [-5.04284924e-05  6.81418920e+00]
Stock Position:  -5.042849240565824e-05
Bond Position:  [2.47938218]


portfolio before change:  [2.47472168]
curr_Stock_Price:  104.71112727092158
curr_Factors:  [1.04711127e+02 3.51378884e-02]
mat_Sqrt:  [[ 1.96282086e+01  0.00000000e+00]
 [-7.49804117e-03  1.71801706e-02]]
grads:  [ 0.00898971 -7.68538879]
Stock Position:  0.008989713236624125
Bond Position:  [1.53339868]


portfolio before change:  [2.47917748]
curr_Stock_Price:  105.16413340715984
curr_Factors:  [1.05164133e+02 3.26412272e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.47917748]
Stock Price:  109.47165804924757
PL:  [-6.99248057]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.68906138e-03  2.22483471e-01]
 [ 5.29428555e-02 -1.93234622e-02]
 [-1.49018668e-01 -4.77342649e-01]
 [ 2.16672658e-01 -6.83543044e-02]
 [-4.03831231e-01 -1.15640903e-01]
 [ 4.08432740e-01 -5.07623199e-01]
 [-5.12559793e-01  2.67306257e-01]
 [ 1.65252162e-01  1.45669559e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.41147435e-01  5.65713264e-03]
 [-3.25525720e-02  4.66804849e-02]
 [-2.36415222e-01  6.57604082e-02]
 [-1.03029429e-01  3.20332357e-02]
 [-1.90878839e-01 -2.62052064e-01]
 [ 1.39259065e-03 -8.14977700e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.20951536e-02  6.02928177e-02]
 [ 2.69526063e-01 -1.84878850e-01]
 [ 1.88610400e-01  7.80636276e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.74145951]
curr_Stock_Price:  101.32501578923925
curr_Factors:  [1.01325016e+02 3.73725331e-02]
mat_Sqrt:  [[ 1.95881287e+01  0.00000000e+00]
 [-7.73279076e-03  1.77180495e-02]]
grads:  [4.66663699e-03 1.25568828e+01]
Stock Position:  0.004666636994043693
Bond Position:  [11.26861245]


portfolio before change:  [11.74835643]
curr_Stock_Price:  102.19918052277968
curr_Factors:  [1.02199181e+02 3.80486764e-02]
mat_Sqrt:  [[ 1.99350436e+01  0.00000000e+00]
 [-7.80242797e-03  1.78776084e-02]]
grads:  [ 0.00223272 -1.08087512]
Stock Position:  0.0022327217369740473
Bond Position:  [11.5201741]


portfolio before change:  [11.74951564]
curr_Stock_Price:  101.42828430477736
curr_Factors:  [1.01428284e+02 3.83893052e-02]
mat_Sqrt:  [[ 1.98730354e+01  0.00000000e+00]
 [-7.83727556e-03  1.79574543e-02]]
grads:  [-1.79815551e-02 -2.65818663e+01]
Stock Position:  -0.017981555060159502
Bond Position:  [13.57335392]


portfolio before change:  [11.73931747]
curr_Stock_Price:  102.18416600929896
curr_Factors:  [1.02184166e+02 3.86446935e-02]
mat_Sqrt:  [[ 2.00876225e+01  0.00000000e+00]
 [-7.86330144e-03  1.80170870e-02]]
grads:  [ 0.00930127 -3.79385992]
Stock Position:  0.009301269665573413
Bond Position:  [10.78887499]


portfolio before change:  [11.71946823]
curr_Stock_Price:  99.76010969978822
curr_Factors:  [9.97601097e+01 3.71041061e-02]
mat_Sqrt:  [[ 1.92162175e+01  0.00000000e+00]
 [-7.70497046e-03  1.76543052e-02]]
grads:  [-0.02364154 -6.55029475]
Stock Position:  -0.023641544395585367
Bond Position:  [14.07795129]


portfolio before change:  [11.69577731]
curr_Stock_Price:  100.91108538413349
curr_Factors:  [1.00911085e+02 3.56271422e-02]
mat_Sqrt:  [[ 1.90471223e+01  0.00000000e+00]
 [-7.55006142e-03  1.72993640e-02]]
grads:  [ 9.81186606e-03 -2.93434602e+01]
Stock Position:  0.009811866059024505
Bond Position:  [10.70565126]


portfolio before change:  [11.69655604]
curr_Stock_Price:  100.71764459197894
curr_Factors:  [1.00717645e+02 3.35058327e-02]
mat_Sqrt:  [[ 1.84359605e+01  0.00000000e+00]
 [-7.32183941e-03  1.67764417e-02]]
grads:  [-0.02147421 15.9334299 ]
Stock Position:  -0.0214742149261046
Bond Position:  [13.85938839]


portfolio before change:  [11.69991913]
curr_Stock_Price:  100.72240364194236
curr_Factors:  [1.00722404e+02 3.37198636e-02]
mat_Sqrt:  [[ 1.84956239e+01  0.00000000e+00]
 [-7.34518766e-03  1.68299392e-02]]
grads:  [0.01237198 8.65538235]
Stock Position:  0.012371984352480693
Bond Position:  [10.45378312]


portfolio before change:  [11.6831653]
curr_Stock_Price:  99.15696406354907
curr_Factors:  [9.91569641e+01 3.63757289e-02]
mat_Sqrt:  [[ 1.89116348e+01  0.00000000e+00]
 [-7.62896888e-03  1.74801637e-02]]
grads:  [-0.01150513 -3.04052709]
Stock Position:  -0.01150513282271839
Bond Position:  [12.82397935]


portfolio before change:  [11.69488953]
curr_Stock_Price:  98.41661360274911
curr_Factors:  [9.84166136e+01 3.57087154e-02]
mat_Sqrt:  [[ 1.85975413e+01  0.00000000e+00]
 [-7.55869993e-03  1.73191573e-02]]
grads:  [0.01309939 0.32664018]
Stock Position:  0.013099388091953485
Bond Position:  [10.40569211]


portfolio before change:  [11.69292856]
curr_Stock_Price:  98.06829842232449
curr_Factors:  [9.80682984e+01 3.59291465e-02]
mat_Sqrt:  [[ 1.85888315e+01  0.00000000e+00]
 [-7.58199409e-03  1.73725309e-02]]
grads:  [-6.55207300e-04  2.68702845e+00]
Stock Position:  -0.000655207299811299
Bond Position:  [11.75718363]


portfolio before change:  [11.69584007]
curr_Stock_Price:  98.11126523414148
curr_Factors:  [9.81112652e+01 3.58629043e-02]
mat_Sqrt:  [[ 1.85798244e+01  0.00000000e+00]
 [-7.57500144e-03  1.73565087e-02]]
grads:  [-0.0111796   3.78880391]
Stock Position:  -0.011179601195741936
Bond Position:  [12.79268489]


portfolio before change:  [11.7029897]
curr_Stock_Price:  97.75784845831667
curr_Factors:  [9.77578485e+01 3.84054754e-02]
mat_Sqrt:  [[ 1.91579135e+01  0.00000000e+00]
 [-7.83892599e-03  1.79612359e-02]]
grads:  [-0.00464816  1.78346501]
Stock Position:  -0.004648156451322169
Bond Position:  [12.15738348]


portfolio before change:  [11.69973595]
curr_Stock_Price:  99.11182265837544
curr_Factors:  [9.91118227e+01 3.91004709e-02]
mat_Sqrt:  [[ 1.95982122e+01  0.00000000e+00]
 [-7.90953560e-03  1.81230228e-02]]
grads:  [ -0.01557528 -14.45962225]
Stock Position:  -0.015575284711456075
Bond Position:  [13.2434308]


portfolio before change:  [11.67182069]
curr_Stock_Price:  101.1166993149924
curr_Factors:  [1.01116699e+02 3.82038932e-02]
mat_Sqrt:  [[ 1.97640842e+01  0.00000000e+00]
 [-7.81832649e-03  1.79140365e-02]]
grads:  [-1.72919483e-03 -4.54938060e+00]
Stock Position:  -0.0017291948284532002
Bond Position:  [11.84667117]


portfolio before change:  [11.67130675]
curr_Stock_Price:  103.12687008744498
curr_Factors:  [1.03126870e+02 3.56098408e-02]
mat_Sqrt:  [[ 1.94606281e+01  0.00000000e+00]
 [-7.54822796e-03  1.72951630e-02]]
grads:  [0.00493283 1.01363923]
Stock Position:  0.004932827948607931
Bond Position:  [11.16259965]


portfolio before change:  [11.67581818]
curr_Stock_Price:  103.47564166809043
curr_Factors:  [1.03475642e+02 3.36695666e-02]
mat_Sqrt:  [[ 1.89870236e+01  0.00000000e+00]
 [-7.33970752e-03  1.68173827e-02]]
grads:  [-1.35783318e-03  3.58514871e+00]
Stock Position:  -0.001357833179857717
Bond Position:  [11.81632084]


portfolio before change:  [11.67816882]
curr_Stock_Price:  103.92032789697728
curr_Factors:  [1.03920328e+02 3.37289824e-02]
mat_Sqrt:  [[ 1.90854378e+01  0.00000000e+00]
 [-7.34618076e-03  1.68322147e-02]]
grads:  [ 9.89436656e-03 -1.09836319e+01]
Stock Position:  0.009894366558841707
Bond Position:  [10.64994301]


portfolio before change:  [11.66327282]
curr_Stock_Price:  102.14570008736945
curr_Factors:  [1.02145700e+02 3.61591842e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.66327282]
Stock Price:  103.59966649876804
PL:  [8.06360632]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [ 4.22858583e-02 -1.87325866e-02]
 [-1.17721674e-01 -2.63807711e-01]
 [ 2.13470434e-01 -6.29921257e-02]
 [-3.61386063e-01 -1.08743039e-01]
 [ 3.62105065e-01 -4.35365522e-01]
 [-5.42337875e-01  3.36963157e-01]
 [ 1.59818501e-01  1.45242750e-01]
 [-1.81303335e-01 -4.78303523e-02]
 [ 2.99285307e-01  6.76827841e-03]
 [-8.52496278e-02 -5.48556530e-03]
 [-2.19068046e-01  7.04153755e-02]
 [-3.16699386e-02  3.72633001e-02]
 [-2.43525052e-01 -2.73834383e-01]
 [-2.97671962e-02 -9.45518704e-02]
 [ 9.72922474e-02  4.86207500e-02]
 [-3.98929554e-02 -3.56583775e-02]
 [ 3.64260534e-01 -2.25853597e-01]
 [ 1.76614869e-01  6.80606688e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.77388678]
curr_Stock_Price:  99.2180655179706
curr_Factors:  [9.92180655e+01 3.98437630e-02]
mat_Sqrt:  [[ 1.98048214e+01  0.00000000e+00]
 [-7.98436102e-03  1.82944694e-02]]
grads:  [ 0.00140731 -0.0738384 ]
Stock Position:  0.0014073127498041328
Bond Position:  [-2.91351763]


portfolio before change:  [-2.77049562]
curr_Stock_Price:  102.14537007970694
curr_Factors:  [1.02145370e+02 3.74938729e-02]
mat_Sqrt:  [[ 1.97787498e+01  0.00000000e+00]
 [-7.74533386e-03  1.77467893e-02]]
grads:  [ 0.00172459 -1.05554792]
Stock Position:  0.0017245926821303583
Bond Position:  [-2.94665478]


portfolio before change:  [-2.76944365]
curr_Stock_Price:  103.18255612986101
curr_Factors:  [1.03182556e+02 3.57582524e-02]
mat_Sqrt:  [[ 1.95116692e+01  0.00000000e+00]
 [-7.56394102e-03  1.73311661e-02]]
grads:  [-1.19342325e-02 -1.52215788e+01]
Stock Position:  -0.01193423253826472
Bond Position:  [-1.53803903]


portfolio before change:  [-2.75710975]
curr_Stock_Price:  102.11684400678963
curr_Factors:  [1.02116844e+02 3.67800893e-02]
mat_Sqrt:  [[ 1.95841070e+01  0.00000000e+00]
 [-7.67125432e-03  1.75770518e-02]]
grads:  [ 0.0094964  -3.58377084]
Stock Position:  0.00949639505187846
Bond Position:  [-3.72685164]


portfolio before change:  [-2.77603152]
curr_Stock_Price:  100.22244729664833
curr_Factors:  [1.00222447e+02 3.78090242e-02]
mat_Sqrt:  [[ 1.94877966e+01  0.00000000e+00]
 [-7.77781709e-03  1.78212178e-02]]
grads:  [-0.02097956 -6.10188601]
Stock Position:  -0.020979560929057
Bond Position:  [-0.67340858]


portfolio before change:  [-2.77732806]
curr_Stock_Price:  100.27622185255915
curr_Factors:  [1.00276222e+02 3.82417967e-02]
mat_Sqrt:  [[ 1.96095265e+01  0.00000000e+00]
 [-7.82220395e-03  1.79229209e-02]]
grads:  [ 8.77614121e-03 -2.42909917e+01]
Stock Position:  0.008776141213547115
Bond Position:  [-3.65736634]


portfolio before change:  [-2.76538329]
curr_Stock_Price:  101.74147028298158
curr_Factors:  [1.01741470e+02 3.69128829e-02]
mat_Sqrt:  [[ 1.95473096e+01  0.00000000e+00]
 [-7.68509029e-03  1.76087540e-02]]
grads:  [-0.02022146 19.13611592]
Stock Position:  -0.020221457790861173
Bond Position:  [-0.70802244]


portfolio before change:  [-2.74395441]
curr_Stock_Price:  100.67300578811547
curr_Factors:  [1.00673006e+02 3.75109113e-02]
mat_Sqrt:  [[ 1.94980798e+01  0.00000000e+00]
 [-7.74709353e-03  1.77508212e-02]]
grads:  [0.01144767 8.18231154]
Stock Position:  0.011447672620629866
Bond Position:  [-3.89642602]


portfolio before change:  [-2.73699298]
curr_Stock_Price:  101.36621740555897
curr_Factors:  [1.01366217e+02 3.68921467e-02]
mat_Sqrt:  [[ 1.94697423e+01  0.00000000e+00]
 [-7.68293139e-03  1.76038073e-02]]
grads:  [-0.01038423 -2.71704589]
Stock Position:  -0.01038422638594982
Bond Position:  [-1.68438323]


portfolio before change:  [-2.73556388]
curr_Stock_Price:  101.18803916254028
curr_Factors:  [1.01188039e+02 3.69213139e-02]
mat_Sqrt:  [[ 1.94432005e+01  0.00000000e+00]
 [-7.68596788e-03  1.76107648e-02]]
grads:  [0.01554473 0.38432621]
Stock Position:  0.015544726079117522
Bond Position:  [-4.30850423]


portfolio before change:  [-2.7994216]
curr_Stock_Price:  97.14934067099415
curr_Factors:  [9.71493407e+01 3.97840526e-02]
mat_Sqrt:  [[ 1.93773493e+01  0.00000000e+00]
 [-7.97837604e-03  1.82807561e-02]]
grads:  [-0.004523   -0.30007322]
Stock Position:  -0.004522998654229204
Bond Position:  [-2.36001527]


portfolio before change:  [-2.80169487]
curr_Stock_Price:  97.52147962801077
curr_Factors:  [9.75214796e+01 3.83785068e-02]
mat_Sqrt:  [[ 1.91048802e+01  0.00000000e+00]
 [-7.83617323e-03  1.79549285e-02]]
grads:  [-0.00985802  3.92178535]
Stock Position:  -0.009858018221650647
Bond Position:  [-1.84032634]


portfolio before change:  [-2.82519593]
curr_Stock_Price:  99.85875735332245
curr_Factors:  [9.98587574e+01 3.65368385e-02]
mat_Sqrt:  [[ 1.90876138e+01  0.00000000e+00]
 [-7.64584473e-03  1.75188311e-02]]
grads:  [-8.07167481e-04  2.12704260e+00]
Stock Position:  -0.0008071674805517394
Bond Position:  [-2.74459319]


portfolio before change:  [-2.8266818]
curr_Stock_Price:  100.84942139044101
curr_Factors:  [1.00849421e+02 3.75043786e-02]
mat_Sqrt:  [[ 1.95305466e+01  0.00000000e+00]
 [-7.74641890e-03  1.77492755e-02]]
grads:  [ -0.01858812 -15.42791891]
Stock Position:  -0.01858812155856915
Bond Position:  [-0.95208049]


portfolio before change:  [-2.82221628]
curr_Stock_Price:  100.59637977286786
curr_Factors:  [1.00596380e+02 3.61684425e-02]
mat_Sqrt:  [[ 1.91314222e+01  0.00000000e+00]
 [-7.60720106e-03  1.74302873e-02]]
grads:  [-3.71289781e-03 -5.42457325e+00]
Stock Position:  -0.0037128978119042888
Bond Position:  [-2.4487122]


portfolio before change:  [-2.82068244]
curr_Stock_Price:  100.01837007278796
curr_Factors:  [1.00018370e+02 3.63912378e-02]
mat_Sqrt:  [[ 1.90799919e+01  0.00000000e+00]
 [-7.63059503e-03  1.74838897e-02]]
grads:  [0.00621133 2.78088863]
Stock Position:  0.006211327698257426
Bond Position:  [-3.44192931]


portfolio before change:  [-2.81712669]
curr_Stock_Price:  100.72938429652584
curr_Factors:  [1.00729384e+02 3.49565419e-02]
mat_Sqrt:  [[ 1.88330392e+01  0.00000000e+00]
 [-7.47866746e-03  1.71357799e-02]]
grads:  [-0.00294459 -2.08093112]
Stock Position:  -0.0029445883138811803
Bond Position:  [-2.52052012]


portfolio before change:  [-2.82244812]
curr_Stock_Price:  102.32254988201656
curr_Factors:  [1.02322550e+02 3.47690832e-02]
mat_Sqrt:  [[ 1.90795433e+01  0.00000000e+00]
 [-7.45858788e-03  1.70897718e-02]]
grads:  [  0.01392538 -13.21571755]
Stock Position:  0.013925382788856052
Bond Position:  [-4.24732879]


portfolio before change:  [-2.82068765]
curr_Stock_Price:  102.52523254208754
curr_Factors:  [1.02525233e+02 3.59383816e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.82068765]
Stock Price:  106.08151828062209
PL:  [-8.90220593]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-4.44717956e-02  6.48011586e-03]
 [-8.19887262e-03 -2.56829806e-02]
 [-1.43207040e-01 -4.37690742e-01]
 [ 3.01351769e-01 -2.10150940e-01]
 [-1.13497623e-01 -7.48825073e-02]
 [ 5.81392333e-01 -7.75856827e-01]
 [-6.05646191e-01  5.23314369e-01]
 [ 3.06597865e-01  1.56772140e-01]
 [-1.58144205e-01 -3.84144846e-02]
 [ 2.13558729e-01  1.26048061e-02]
 [ 1.05176620e-01  1.73631499e-01]
 [-2.36462426e-01  6.66805550e-02]
 [-2.67781144e-02  3.76218306e-02]
 [-2.01129678e-01 -2.64931128e-01]
 [ 1.08032639e-01 -3.51889585e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.32112275e-02  2.41121029e-01]
 [ 1.17153719e-01  1.34887231e-01]
 [-5.19922400e-02 -2.45817319e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.925072]
curr_Stock_Price:  99.75498155434893
curr_Factors:  [9.97549816e+01 4.13804033e-02]
mat_Sqrt:  [[ 2.02923317e+01  0.00000000e+00]
 [-8.13686950e-03  1.86439102e-02]]
grads:  [-0.00205219  0.34757279]
Stock Position:  -0.0020521861098441014
Bond Position:  [1.12978778]


portfolio before change:  [0.92089041]
curr_Stock_Price:  101.9302548622663
curr_Factors:  [1.01930255e+02 4.22955615e-02]
mat_Sqrt:  [[ 2.09628587e+01  0.00000000e+00]
 [-8.22635390e-03  1.88489447e-02]]
grads:  [-9.25820497e-04 -1.36256862e+00]
Stock Position:  -0.0009258204972166412
Bond Position:  [1.01525953]


portfolio before change:  [0.92127729]
curr_Stock_Price:  101.78656417555858
curr_Factors:  [1.01786564e+02 4.36619176e-02]
mat_Sqrt:  [[ 2.12687447e+01  0.00000000e+00]
 [-8.35817374e-03  1.91509819e-02]]
grads:  [-1.57146529e-02 -2.28547415e+01]
Stock Position:  -0.015714652926546925
Bond Position:  [2.52081782]


portfolio before change:  [0.88750438]
curr_Stock_Price:  103.9758074068835
curr_Factors:  [1.03975807e+02 4.12204127e-02]
mat_Sqrt:  [[ 2.11100115e+01  0.00000000e+00]
 [-8.12112433e-03  1.86078335e-02]]
grads:  [ 9.93056681e-03 -1.12936812e+01]
Stock Position:  0.009930566812202528
Bond Position:  [-0.14503433]


portfolio before change:  [0.8833731]
curr_Stock_Price:  103.56344295405786
curr_Factors:  [1.03563443e+02 3.98971435e-02]
mat_Sqrt:  [[ 2.06860410e+01  0.00000000e+00]
 [-7.98970773e-03  1.83067202e-02]]
grads:  [-0.00706655 -4.09043818]
Stock Position:  -0.007066554109548134
Bond Position:  [1.61520977]


portfolio before change:  [0.88800135]
curr_Stock_Price:  102.96564172631662
curr_Factors:  [1.02965642e+02 3.88242259e-02]
mat_Sqrt:  [[ 2.02882101e+01  0.00000000e+00]
 [-7.88154562e-03  1.80588897e-02]]
grads:  [ 1.19665881e-02 -4.29625984e+01]
Stock Position:  0.01196658810857529
Bond Position:  [-0.34414607]


portfolio before change:  [0.90695966]
curr_Stock_Price:  104.55710290004107
curr_Factors:  [1.04557103e+02 3.69678078e-02]
mat_Sqrt:  [[ 2.01032091e+01  0.00000000e+00]
 [-7.69080571e-03  1.76218497e-02]]
grads:  [-1.87658136e-02  2.96969035e+01]
Stock Position:  -0.018765813644357324
Bond Position:  [2.86905877]


portfolio before change:  [0.95298469]
curr_Stock_Price:  102.14272985335656
curr_Factors:  [1.02142730e+02 3.70499875e-02]
mat_Sqrt:  [[ 1.96608139e+01  0.00000000e+00]
 [-7.69934932e-03  1.76414255e-02]]
grads:  [0.01907443 8.88659138]
Stock Position:  0.019074430844864005
Bond Position:  [-0.99532975]


portfolio before change:  [0.94348838]
curr_Stock_Price:  101.65792150192243
curr_Factors:  [1.01657922e+02 3.70046444e-02]
mat_Sqrt:  [[ 1.95555189e+01  0.00000000e+00]
 [-7.69463651e-03  1.76306271e-02]]
grads:  [-0.00894426 -2.17884958]
Stock Position:  -0.008944260812422387
Bond Position:  [1.85274335]


portfolio before change:  [0.93623746]
curr_Stock_Price:  102.52039323913174
curr_Factors:  [1.02520393e+02 3.70132144e-02]
mat_Sqrt:  [[ 1.97237126e+01  0.00000000e+00]
 [-7.69552747e-03  1.76326686e-02]]
grads:  [0.01110642 0.71485527]
Stock Position:  0.011106424125591464
Bond Position:  [-0.20239751]


portfolio before change:  [0.91567607]
curr_Stock_Price:  100.67364421347934
curr_Factors:  [1.00673644e+02 3.85322604e-02]
mat_Sqrt:  [[ 1.97618698e+01  0.00000000e+00]
 [-7.85185435e-03  1.79908584e-02]]
grads:  [9.15680657e-03 9.65109581e+00]
Stock Position:  0.009156806570877566
Bond Position:  [-0.00617301]


portfolio before change:  [0.90685421]
curr_Stock_Price:  99.71039136503462
curr_Factors:  [9.97103914e+01 3.77272790e-02]
mat_Sqrt:  [[ 1.93672591e+01  0.00000000e+00]
 [-7.76940451e-03  1.78019421e-02]]
grads:  [-0.01070676  3.74568991]
Stock Position:  -0.010706762632129335
Bond Position:  [1.9744297]


portfolio before change:  [0.90421735]
curr_Stock_Price:  100.00277910551564
curr_Factors:  [1.00002779e+02 3.64089321e-02]
mat_Sqrt:  [[ 1.90816550e+01  0.00000000e+00]
 [-7.63244989e-03  1.74881397e-02]]
grads:  [-5.42856548e-04  2.15127688e+00]
Stock Position:  -0.0005428565483262239
Bond Position:  [0.95850452]


portfolio before change:  [0.90474421]
curr_Stock_Price:  99.47371834075577
curr_Factors:  [9.94737183e+01 3.91660849e-02]
mat_Sqrt:  [[ 1.96862698e+01  0.00000000e+00]
 [-7.91616926e-03  1.81382224e-02]]
grads:  [ -0.01609015 -14.60623439]
Stock Position:  -0.01609015345640841
Bond Position:  [2.5052916]


portfolio before change:  [0.86160373]
curr_Stock_Price:  102.19382167725094
curr_Factors:  [1.02193822e+02 3.75627259e-02]
mat_Sqrt:  [[ 1.98062926e+01  0.00000000e+00]
 [-7.75244228e-03  1.77630768e-02]]
grads:  [ 0.00467906 -1.98101708]
Stock Position:  0.0046790643805283425
Bond Position:  [0.38343226]


portfolio before change:  [0.86710825]
curr_Stock_Price:  103.34974749992445
curr_Factors:  [1.03349747e+02 3.84073006e-02]
mat_Sqrt:  [[ 2.02542568e+01  0.00000000e+00]
 [-7.83911226e-03  1.79616626e-02]]
grads:  [0.00473954 0.97602633]
Stock Position:  0.0047395434516852375
Bond Position:  [0.37727764]


portfolio before change:  [0.88902728]
curr_Stock_Price:  107.9545579601058
curr_Factors:  [1.07954558e+02 3.62755601e-02]
mat_Sqrt:  [[ 2.05611805e+01  0.00000000e+00]
 [-7.61845759e-03  1.74560793e-02]]
grads:  [2.53013765e-03 1.38130118e+01]
Stock Position:  0.0025301376525404956
Bond Position:  [0.61588739]


portfolio before change:  [0.89159118]
curr_Stock_Price:  108.90703759251194
curr_Factors:  [1.08907038e+02 3.63309287e-02]
mat_Sqrt:  [[ 2.07584152e+01  0.00000000e+00]
 [-7.62426953e-03  1.74693961e-02]]
grads:  [0.00847961 7.72134481]
Stock Position:  0.008479613263616603
Bond Position:  [-0.03189838]


portfolio before change:  [0.89748653]
curr_Stock_Price:  109.6032158945406
curr_Factors:  [1.09603216e+02 3.58574433e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.89748653]
Stock Price:  108.5483848447641
PL:  [-7.65089832]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.14886559e-01 -9.26749895e-01]
 [-2.26876642e-02  2.77253292e-01]
 [-4.15826977e-01 -6.04691670e-02]
 [ 2.15947079e-01 -3.56617139e-02]
 [-2.90304085e-01  1.02074738e-01]
 [-3.19784351e-03  1.56118059e-01]
 [-2.28251519e-01  7.88034397e-02]
 [ 2.38877631e-01  5.79936341e-03]
 [-1.30177239e-02  6.64075689e-02]
 [-2.36306423e-01  6.36395879e-02]
 [-1.25486417e-01  3.03873231e-02]
 [-1.96726639e-01 -2.63682103e-01]
 [-7.13814261e-02 -1.11976277e-01]
 [ 9.62878171e-02  5.02410533e-02]
 [-5.12918439e-02 -2.90438641e-02]
 [ 4.50200595e-01 -2.50845985e-01]
 [ 2.22683904e-01  1.21700344e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.57361933]
curr_Stock_Price:  99.24713499756837
curr_Factors:  [9.92471350e+01 3.60863867e-02]
mat_Sqrt:  [[ 1.88533998e+01  0.00000000e+00]
 [-7.59856688e-03  1.74105040e-02]]
grads:  [ 0.00147833 -0.07758732]
Stock Position:  0.0014783316464431957
Bond Position:  [-2.72033951]


portfolio before change:  [-2.57352471]
curr_Stock_Price:  99.77123211999371
curr_Factors:  [9.97712321e+01 3.40667051e-02]
mat_Sqrt:  [[ 1.84149439e+01  0.00000000e+00]
 [-7.38286721e-03  1.69162739e-02]]
grads:  [-0.01011813 -3.94010942]
Stock Position:  -0.010118133984466154
Bond Position:  [-1.56402601]


portfolio before change:  [-2.55485605]
curr_Stock_Price:  97.88751343340414
curr_Factors:  [9.78875134e+01 3.34109605e-02]
mat_Sqrt:  [[ 1.78925309e+01  0.00000000e+00]
 [-7.31146612e-03  1.67526735e-02]]
grads:  [-3.46151908e-02 -5.53195224e+01]
Stock Position:  -0.034615190823657424
Bond Position:  [0.83353891]


portfolio before change:  [-2.5164241]
curr_Stock_Price:  96.7832716755041
curr_Factors:  [9.67832717e+01 3.53289038e-02]
mat_Sqrt:  [[ 1.81913689e+01  0.00000000e+00]
 [-7.51839385e-03  1.72268045e-02]]
grads:  [5.40451868e-03 1.60942961e+01]
Stock Position:  0.005404518675382238
Bond Position:  [-3.0394911]


portfolio before change:  [-2.51603012]
curr_Stock_Price:  96.99678554106727
curr_Factors:  [9.69967855e+01 3.45452627e-02]
mat_Sqrt:  [[ 1.80281678e+01  0.00000000e+00]
 [-7.43454237e-03  1.70346766e-02]]
grads:  [-0.02452927 -3.54976901]
Stock Position:  -0.024529274988817715
Bond Position:  [-0.1367693]


portfolio before change:  [-2.46535993]
curr_Stock_Price:  94.92968839212635
curr_Factors:  [9.49296884e+01 3.49773432e-02]
mat_Sqrt:  [[ 1.77539693e+01  0.00000000e+00]
 [-7.48089227e-03  1.71408775e-02]]
grads:  [ 0.01128666 -2.08050689]
Stock Position:  0.011286660868552885
Bond Position:  [-3.53679913]


portfolio before change:  [-2.45168794]
curr_Stock_Price:  96.21937844177808
curr_Factors:  [9.62193784e+01 3.52034153e-02]
mat_Sqrt:  [[ 1.80532313e+01  0.00000000e+00]
 [-7.50502928e-03  1.71961824e-02]]
grads:  [-0.0136128   5.93589528]
Stock Position:  -0.013612799472143784
Bond Position:  [-1.14187284]


portfolio before change:  [-2.44609302]
curr_Stock_Price:  95.78740050375806
curr_Factors:  [9.57874005e+01 3.45262338e-02]
mat_Sqrt:  [[ 1.77984831e+01  0.00000000e+00]
 [-7.43249448e-03  1.70299843e-02]]
grads:  [3.64849425e-03 9.16724621e+00]
Stock Position:  0.0036484942479728076
Bond Position:  [-2.7955728]


portfolio before change:  [-2.44784452]
curr_Stock_Price:  95.49891896901465
curr_Factors:  [9.54989190e+01 3.37369006e-02]
mat_Sqrt:  [[ 1.75408666e+01  0.00000000e+00]
 [-7.34704300e-03  1.68341903e-02]]
grads:  [-0.01105184  4.68115413]
Stock Position:  -0.011051841522427842
Bond Position:  [-1.3924056]


portfolio before change:  [-2.47914822]
curr_Stock_Price:  98.29985999102007
curr_Factors:  [9.82998600e+01 3.15693977e-02]
mat_Sqrt:  [[ 1.74657020e+01  0.00000000e+00]
 [-7.10711167e-03  1.62844386e-02]]
grads:  [0.01382187 0.35612916]
Stock Position:  0.013821870982203683
Bond Position:  [-3.83783621]


portfolio before change:  [-2.47868093]
curr_Stock_Price:  98.40309262187253
curr_Factors:  [9.84030926e+01 3.16432139e-02]
mat_Sqrt:  [[ 1.75044730e+01  0.00000000e+00]
 [-7.11541581e-03  1.63034658e-02]]
grads:  [9.12047753e-04 4.07321792e+00]
Stock Position:  0.0009120477529238655
Bond Position:  [-2.56842925]


portfolio before change:  [-2.47940825]
curr_Stock_Price:  98.30975919333486
curr_Factors:  [9.83097592e+01 3.07562967e-02]
mat_Sqrt:  [[ 1.72410477e+01  0.00000000e+00]
 [-7.01498928e-03  1.60733597e-02]]
grads:  [-0.01209508  3.95932083]
Stock Position:  -0.012095078754566157
Bond Position:  [-1.29034397]


portfolio before change:  [-2.46473314]
curr_Stock_Price:  97.06977292967929
curr_Factors:  [9.70697729e+01 3.01709047e-02]
mat_Sqrt:  [[ 1.68608001e+01  0.00000000e+00]
 [-6.94790958e-03  1.59196608e-02]]
grads:  [-0.00665593  1.90879212]
Stock Position:  -0.006655929766607763
Bond Position:  [-1.81864355]


portfolio before change:  [-2.48022271]
curr_Stock_Price:  99.32863850359296
curr_Factors:  [9.93286385e+01 2.91002539e-02]
mat_Sqrt:  [[ 1.69442703e+01  0.00000000e+00]
 [-6.82351861e-03  1.56346453e-02]]
grads:  [ -0.01840191 -16.86524369]
Stock Position:  -0.018401910340485144
Bond Position:  [-0.65238601]


portfolio before change:  [-2.49088982]
curr_Stock_Price:  99.89944841512995
curr_Factors:  [9.98994484e+01 2.89724417e-02]
mat_Sqrt:  [[ 1.70041779e+01  0.00000000e+00]
 [-6.80851722e-03  1.56002728e-02]]
grads:  [-7.07190202e-03 -7.17784096e+00]
Stock Position:  -0.007071902018797268
Bond Position:  [-1.78441071]


portfolio before change:  [-2.49097433]
curr_Stock_Price:  99.84830935338609
curr_Factors:  [9.98483094e+01 2.78517852e-02]
mat_Sqrt:  [[ 1.66635387e+01  0.00000000e+00]
 [-6.67554165e-03  1.52955875e-02]]
grads:  [0.00709422 3.28467628]
Stock Position:  0.0070942200513394865
Bond Position:  [-3.19932021]


portfolio before change:  [-2.48175242]
curr_Stock_Price:  101.2609863627113
curr_Factors:  [1.01260986e+02 2.80175153e-02]
mat_Sqrt:  [[ 1.69495028e+01  0.00000000e+00]
 [-6.69537336e-03  1.53410276e-02]]
grads:  [-0.00377401 -1.89321503]
Stock Position:  -0.003774011915229142
Bond Position:  [-2.09959225]


portfolio before change:  [-2.48113807]
curr_Stock_Price:  100.95910384312036
curr_Factors:  [1.00959104e+02 2.85495001e-02]
mat_Sqrt:  [[ 1.70586532e+01  0.00000000e+00]
 [-6.75863893e-03  1.54859873e-02]]
grads:  [  0.01997358 -16.19825597]
Stock Position:  0.019973583323930233
Bond Position:  [-4.49765314]


portfolio before change:  [-2.49062038]
curr_Stock_Price:  100.54066332749792
curr_Factors:  [1.00540663e+02 2.76749828e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.49062038]
Stock Price:  100.20301187439483
PL:  [-2.69363226]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.31050426e-03  2.23052350e-01]
 [-6.46026471e-02 -4.01520394e-02]
 [-1.24172578e-01 -3.07821313e-01]
 [ 2.15865930e-01 -6.70034246e-02]
 [-2.30315519e-01 -9.29061392e-02]
 [ 3.26086413e-01 -3.79186919e-01]
 [-4.91229757e-01  2.08347389e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.82631055e-01  4.50264154e-03]
 [-3.96142983e-03  7.50373241e-02]
 [-2.36317521e-01  6.38559209e-02]
 [-6.05069124e-02  3.51497868e-02]
 [-2.23054337e-01 -2.71080167e-01]
 [ 1.01148064e-01 -3.81763618e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.19442631e-02  8.92664986e-02]
 [ 2.30404033e-01 -1.23045246e-01]
 [ 2.50311535e-02 -9.40415835e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.78404398]
curr_Stock_Price:  101.33119706490447
curr_Factors:  [1.01331197e+02 4.19878786e-02]
mat_Sqrt:  [[ 2.07637188e+01  0.00000000e+00]
 [-8.19637760e-03  1.87802604e-02]]
grads:  [4.43261262e-03 1.18769573e+01]
Stock Position:  0.004432612624352157
Bond Position:  [11.33488204]


portfolio before change:  [11.78850771]
curr_Stock_Price:  101.69884691218243
curr_Factors:  [1.01698847e+02 4.00664466e-02]
mat_Sqrt:  [[ 2.03566562e+01  0.00000000e+00]
 [-8.00664191e-03  1.83455213e-02]]
grads:  [-0.00403438 -2.18865622]
Stock Position:  -0.004034377394732275
Bond Position:  [12.19879924]


portfolio before change:  [11.78699676]
curr_Stock_Price:  102.82938724240363
curr_Factors:  [1.02829387e+02 3.77920096e-02]
mat_Sqrt:  [[ 1.99902047e+01  0.00000000e+00]
 [-7.77606683e-03  1.78172074e-02]]
grads:  [-1.29321744e-02 -1.72766307e+01]
Stock Position:  -0.0129321743757498
Bond Position:  [13.11680433]


portfolio before change:  [11.7988294]
curr_Stock_Price:  102.16801145336001
curr_Factors:  [1.02168011e+02 3.48688709e-02]
mat_Sqrt:  [[ 1.90780456e+01  0.00000000e+00]
 [-7.46928333e-03  1.71142781e-02]]
grads:  [ 0.00978209 -3.91505994]
Stock Position:  0.009782094141561061
Bond Position:  [10.79941229]


portfolio before change:  [11.79469764]
curr_Stock_Price:  101.46959706293465
curr_Factors:  [1.01469597e+02 3.42206350e-02]
mat_Sqrt:  [[ 1.87706784e+01  0.00000000e+00]
 [-7.39952809e-03  1.69544488e-02]]
grads:  [-0.01443012 -5.47974991]
Stock Position:  -0.014430116895116663
Bond Position:  [13.25891578]


portfolio before change:  [11.8220355]
curr_Stock_Price:  99.80483443713734
curr_Factors:  [9.98048344e+01 3.49319630e-02]
mat_Sqrt:  [[ 1.86536178e+01  0.00000000e+00]
 [-7.47603777e-03  1.71297545e-02]]
grads:  [ 8.60935804e-03 -2.21361561e+01]
Stock Position:  0.008609358038152213
Bond Position:  [10.96277994]


portfolio before change:  [11.82455682]
curr_Stock_Price:  99.77931359850949
curr_Factors:  [9.97793136e+01 3.55512233e-02]
mat_Sqrt:  [[ 1.88134215e+01  0.00000000e+00]
 [-7.54201281e-03  1.72809223e-02]]
grads:  [-0.02127734 12.05649705]
Stock Position:  -0.021277336574192354
Bond Position:  [13.94759486]


portfolio before change:  [11.83709883]
curr_Stock_Price:  99.35375875973921
curr_Factors:  [9.93537588e+01 3.56047958e-02]
mat_Sqrt:  [[ 1.87472924e+01  0.00000000e+00]
 [-7.54769325e-03  1.72939378e-02]]
grads:  [5.21702806e-03 7.84777800e+00]
Stock Position:  0.005217028062932764
Bond Position:  [11.31876748]


portfolio before change:  [11.84461363]
curr_Stock_Price:  100.25173323981396
curr_Factors:  [1.00251733e+02 3.58131187e-02]
mat_Sqrt:  [[ 1.89719932e+01  0.00000000e+00]
 [-7.56974173e-03  1.73444572e-02]]
grads:  [-0.01146853 -3.06431677]
Stock Position:  -0.011468529849501766
Bond Position:  [12.99435362]


portfolio before change:  [11.85455189]
curr_Stock_Price:  99.66846152495184
curr_Factors:  [9.96684615e+01 3.42559616e-02]
mat_Sqrt:  [[ 1.84470038e+01  0.00000000e+00]
 [-7.40334644e-03  1.69631977e-02]]
grads:  [0.01542777 0.26543589]
Stock Position:  0.015427772039490585
Bond Position:  [10.31688959]


portfolio before change:  [11.84012406]
curr_Stock_Price:  98.56607428042125
curr_Factors:  [9.85660743e+01 3.34426183e-02]
mat_Sqrt:  [[ 1.80250964e+01  0.00000000e+00]
 [-7.31492921e-03  1.67606084e-02]]
grads:  [1.59708124e-03 4.47700479e+00]
Stock Position:  0.0015970812396927053
Bond Position:  [11.68270603]


portfolio before change:  [11.84260709]
curr_Stock_Price:  98.2918188609117
curr_Factors:  [9.82918189e+01 3.29609459e-02]
mat_Sqrt:  [[ 1.78450268e+01  0.00000000e+00]
 [-7.26205987e-03  1.66394695e-02]]
grads:  [-0.01168104  3.83761759]
Stock Position:  -0.011681042237526331
Bond Position:  [12.99075798]


portfolio before change:  [11.83766639]
curr_Stock_Price:  98.99285179256992
curr_Factors:  [9.89928518e+01 3.17487543e-02]
mat_Sqrt:  [[ 1.76387246e+01  0.00000000e+00]
 [-7.12727205e-03  1.63306318e-02]]
grads:  [-0.00256063  2.15238377]
Stock Position:  -0.0025606322836187983
Bond Position:  [12.09115068]


portfolio before change:  [11.83745748]
curr_Stock_Price:  100.25507079139022
curr_Factors:  [1.00255071e+02 3.22135819e-02]
mat_Sqrt:  [[ 1.79939230e+01  0.00000000e+00]
 [-7.17925700e-03  1.64497443e-02]]
grads:  [ -0.01897104 -16.47929366]
Stock Position:  -0.01897103940368126
Bond Position:  [13.73940038]


portfolio before change:  [11.80539969]
curr_Stock_Price:  102.12597873732875
curr_Factors:  [1.02125979e+02 3.18272825e-02]
mat_Sqrt:  [[ 1.82194814e+01  0.00000000e+00]
 [-7.13608100e-03  1.63508157e-02]]
grads:  [ 0.00463715 -2.3348292 ]
Stock Position:  0.004637153580470402
Bond Position:  [11.33182584]


portfolio before change:  [11.81237899]
curr_Stock_Price:  103.02005831799197
curr_Factors:  [1.03020058e+02 3.05910834e-02]
mat_Sqrt:  [[ 1.80185243e+01  0.00000000e+00]
 [-6.99612275e-03  1.60301310e-02]]
grads:  [0.00532762 1.09363147]
Stock Position:  0.005327624417951396
Bond Position:  [11.26352681]


portfolio before change:  [11.82143261]
curr_Stock_Price:  104.19082245631758
curr_Factors:  [1.04190822e+02 2.83747526e-02]
mat_Sqrt:  [[ 1.75507431e+01  0.00000000e+00]
 [-6.73792284e-03  1.54385207e-02]]
grads:  [-7.39864351e-04  5.78206294e+00]
Stock Position:  -0.0007398643513175454
Bond Position:  [11.89851969]


portfolio before change:  [11.82393103]
curr_Stock_Price:  104.8349733252262
curr_Factors:  [1.04834973e+02 2.75556050e-02]
mat_Sqrt:  [[ 1.74024808e+01  0.00000000e+00]
 [-6.63995241e-03  1.52140423e-02]]
grads:  [ 0.01015388 -8.0876104 ]
Stock Position:  0.010153878984967732
Bond Position:  [10.7594494]


portfolio before change:  [11.84734428]
curr_Stock_Price:  106.87587356775153
curr_Factors:  [1.06875874e+02 2.92640480e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.84734428]
Stock Price:  107.04757751720192
PL:  [4.79976676]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.26530583e-01  4.22242019e-01]
 [ 1.50880338e-01 -2.42352433e-02]
 [-1.58888229e-01 -5.44681259e-01]
 [ 9.85170460e-02  1.17874558e-01]
 [-4.15966257e-01 -1.17536707e-01]
 [ 3.56655644e-01 -4.26866013e-01]
 [-4.57581365e-01  1.75184575e-01]
 [ 1.73634759e-01  1.46328004e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.54696025e-01  4.80814935e-03]
 [ 8.78295129e-02  1.58129956e-01]
 [-2.36001380e-01  5.76933943e-02]
 [-3.30212405e-02  3.71642607e-02]
 [-1.91175488e-01 -2.62141761e-01]
 [-8.20785226e-02 -1.16487192e-01]
 [ 9.63301113e-02  3.18285645e-02]
 [-2.02717635e-02 -4.53637695e-02]
 [ 5.35092046e-01 -2.75563654e-01]
 [ 1.89225189e-01  1.37010888e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.29372069]
curr_Stock_Price:  102.71155792640052
curr_Factors:  [1.02711558e+02 4.04399672e-02]
mat_Sqrt:  [[ 2.06549769e+01  0.00000000e+00]
 [-8.04387640e-03  1.84308362e-02]]
grads:  [1.50478071e-02 2.29095421e+01]
Stock Position:  0.015047807110210918
Bond Position:  [19.74813698]


portfolio before change:  [21.29923327]
curr_Stock_Price:  102.74976502963226
curr_Factors:  [1.02749765e+02 3.97744797e-02]
mat_Sqrt:  [[ 2.04919407e+01  0.00000000e+00]
 [-7.97741609e-03  1.82785565e-02]]
grads:  [ 0.00684675 -1.32588387]
Stock Position:  0.006846750737976839
Bond Position:  [20.59573125]


portfolio before change:  [21.29167308]
curr_Stock_Price:  100.89344394374407
curr_Factors:  [1.00893444e+02 4.24733921e-02]
mat_Sqrt:  [[ 2.07932043e+01  0.00000000e+00]
 [-8.24362950e-03  1.88885281e-02]]
grads:  [-1.90738577e-02 -2.88366175e+01]
Stock Position:  -0.01907385769467293
Bond Position:  [23.21610028]


portfolio before change:  [21.30438348]
curr_Stock_Price:  100.531396027299
curr_Factors:  [1.00531396e+02 4.16284679e-02]
mat_Sqrt:  [[ 2.05114766e+01  0.00000000e+00]
 [-8.16122225e-03  1.86997094e-02]]
grads:  [0.00731111 6.30355027]
Stock Position:  0.007311112858534584
Bond Position:  [20.5693871]


portfolio before change:  [21.30291953]
curr_Stock_Price:  99.62771067110504
curr_Factors:  [9.96277107e+01 4.21171522e-02]
mat_Sqrt:  [[ 2.04460609e+01  0.00000000e+00]
 [-8.20898553e-03  1.88091488e-02]]
grads:  [-0.02285347 -6.24891153]
Stock Position:  -0.022853472077868787
Bond Position:  [23.57975863]


portfolio before change:  [21.29593329]
curr_Stock_Price:  100.19138510140772
curr_Factors:  [1.00191385e+02 4.09938568e-02]
mat_Sqrt:  [[ 2.02856894e+01  0.00000000e+00]
 [-8.09877589e-03  1.85566268e-02]]
grads:  [ 8.39784339e-03 -2.30034272e+01]
Stock Position:  0.008397843389927315
Bond Position:  [20.45454173]


portfolio before change:  [21.29107134]
curr_Stock_Price:  99.00343481860237
curr_Factors:  [9.90034348e+01 4.19091407e-02]
mat_Sqrt:  [[ 2.02677081e+01  0.00000000e+00]
 [-8.18868885e-03  1.87626432e-02]]
grads:  [-0.01880452  9.3368814 ]
Stock Position:  -0.018804521316168173
Bond Position:  [23.15278354]


portfolio before change:  [21.26279491]
curr_Stock_Price:  100.814985958937
curr_Factors:  [1.00814986e+02 4.02062849e-02]
mat_Sqrt:  [[ 2.02149219e+01  0.00000000e+00]
 [-8.02060196e-03  1.83775078e-02]]
grads:  [0.01174862 7.96234212]
Stock Position:  0.011748624967638583
Bond Position:  [20.07835745]


portfolio before change:  [21.2629326]
curr_Stock_Price:  100.3994033564152
curr_Factors:  [1.00399403e+02 4.10190621e-02]
mat_Sqrt:  [[ 2.03340551e+01  0.00000000e+00]
 [-8.10126530e-03  1.85623307e-02]]
grads:  [-0.01070032 -2.86326712]
Stock Position:  -0.010700318752658271
Bond Position:  [22.33723822]


portfolio before change:  [21.2835059]
curr_Stock_Price:  98.99866996825754
curr_Factors:  [9.89986700e+01 4.14757623e-02]
mat_Sqrt:  [[ 2.01616721e+01  0.00000000e+00]
 [-8.14623960e-03  1.86653798e-02]]
grads:  [0.01273676 0.25759719]
Stock Position:  0.01273676466972028
Bond Position:  [20.02258314]


portfolio before change:  [21.30449546]
curr_Stock_Price:  100.25356326221089
curr_Factors:  [1.00253563e+02 4.27576036e-02]
mat_Sqrt:  [[ 2.07303434e+01  0.00000000e+00]
 [-8.27116472e-03  1.89516192e-02]]
grads:  [7.56587002e-03 8.34387574e+00]
Stock Position:  0.007565870020686079
Bond Position:  [20.54599003]


portfolio before change:  [21.29942262]
curr_Stock_Price:  98.90408502747114
curr_Factors:  [9.8904085e+01 4.4030454e-02]
mat_Sqrt:  [[ 2.07534743e+01  0.00000000e+00]
 [-8.39337395e-03  1.92316357e-02]]
grads:  [-0.01015839  2.99992133]
Stock Position:  -0.010158391561348292
Bond Position:  [22.30412904]


portfolio before change:  [21.29549919]
curr_Stock_Price:  99.83928762541372
curr_Factors:  [9.98392876e+01 4.32311678e-02]
mat_Sqrt:  [[ 2.07586907e+01  0.00000000e+00]
 [-8.31684246e-03  1.90562800e-02]]
grads:  [-8.09368359e-04  1.95023691e+00]
Stock Position:  -0.0008093683591097956
Bond Position:  [21.37630595]


portfolio before change:  [21.30142857]
curr_Stock_Price:  99.11695492276095
curr_Factors:  [9.91169549e+01 4.42743009e-02]
mat_Sqrt:  [[ 2.08556537e+01  0.00000000e+00]
 [-8.41658372e-03  1.92848160e-02]]
grads:  [ -0.01465231 -13.5931689 ]
Stock Position:  -0.014652311342133762
Bond Position:  [22.75372105]


portfolio before change:  [21.29817682]
curr_Stock_Price:  99.72715851845891
curr_Factors:  [9.97271585e+01 4.21847800e-02]
mat_Sqrt:  [[ 2.04828950e+01  0.00000000e+00]
 [-8.21557350e-03  1.88242437e-02]]
grads:  [-0.0064892  -6.18814726]
Stock Position:  -0.006489204828214096
Bond Position:  [21.94532678]


portfolio before change:  [21.29649854]
curr_Stock_Price:  100.8313464625469
curr_Factors:  [1.00831346e+02 4.00095990e-02]
mat_Sqrt:  [[ 2.01686889e+01  0.00000000e+00]
 [-8.00095985e-03  1.83325021e-02]]
grads:  [0.00546497 1.73618224]
Stock Position:  0.005464967828338022
Bond Position:  [20.74545847]


portfolio before change:  [21.29640453]
curr_Stock_Price:  99.86500575297867
curr_Factors:  [9.98650058e+01 4.01598774e-02]
mat_Sqrt:  [[ 2.00128767e+01  0.00000000e+00]
 [-8.01597180e-03  1.83668988e-02]]
grads:  [-2.00221768e-03 -2.46986549e+00]
Stock Position:  -0.0020022176784765607
Bond Position:  [21.49635601]


portfolio before change:  [21.30239933]
curr_Stock_Price:  99.55532636218457
curr_Factors:  [9.95553264e+01 4.12381350e-02]
mat_Sqrt:  [[ 2.02168742e+01  0.00000000e+00]
 [-8.12286993e-03  1.86118332e-02]]
grads:  [  0.02051881 -14.80583085]
Stock Position:  0.020518810390902392
Bond Position:  [19.25964247]


portfolio before change:  [21.27556846]
curr_Stock_Price:  98.01301544955396
curr_Factors:  [9.80130154e+01 4.12277750e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.27556846]
Stock Price:  97.32123985577442
PL:  [21.27556846]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 5.05877834e-03  2.38634865e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.88165158e-01 -1.18931972e+00]
 [-2.20597277e-02  2.77319095e-01]
 [-4.38413746e-01 -3.45226055e-02]
 [ 2.36068581e-02  9.49622884e-02]
 [-3.42390625e-01  1.30635024e-01]
 [ 2.48731224e-02  1.53009980e-01]
 [-2.35818043e-01  1.11471277e-01]
 [ 1.24669501e-01  1.29558864e-02]
 [-1.05273544e-01 -4.85155380e-02]
 [-1.26444418e-01  1.54585814e-02]
 [ 1.17660449e-01 -1.35898076e-02]
 [ 7.17092991e-02 -3.16412931e-02]
 [-2.76094758e-01 -1.10365948e-01]
 [ 7.52587575e-02  1.13678989e-01]
 [-1.92140262e-02 -3.10445992e-02]
 [ 1.44007133e+00 -6.44759531e-01]
 [ 2.09491085e-01  2.32954850e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.51702247]
curr_Stock_Price:  101.43759130376735
curr_Factors:  [1.01437591e+02 3.92358563e-02]
mat_Sqrt:  [[ 2.00928016e+01  0.00000000e+00]
 [-7.92321715e-03  1.81543712e-02]]
grads:  [5.43515903e-03 1.31447607e+01]
Stock Position:  0.005435159027044726
Bond Position:  [11.96569303]


portfolio before change:  [12.51321101]
curr_Stock_Price:  100.18587800252389
curr_Factors:  [1.00185878e+02 4.22155568e-02]
mat_Sqrt:  [[ 2.05846160e+01  0.00000000e+00]
 [-8.21856988e-03  1.88311093e-02]]
grads:  [-0.00905166 -3.53946064]
Stock Position:  -0.00905165635555838
Bond Position:  [13.42005915]


portfolio before change:  [12.55047161]
curr_Stock_Price:  96.44013590163358
curr_Factors:  [9.64401359e+01 4.33252385e-02]
mat_Sqrt:  [[ 2.00737400e+01  0.00000000e+00]
 [-8.32588623e-03  1.90770019e-02]]
grads:  [-3.52314437e-02 -6.23431148e+01]
Stock Position:  -0.035231443651275215
Bond Position:  [15.94819682]


portfolio before change:  [12.5450706]
curr_Stock_Price:  96.70661816941269
curr_Factors:  [9.67066182e+01 4.34983733e-02]
mat_Sqrt:  [[ 2.01693872e+01  0.00000000e+00]
 [-8.34250546e-03  1.91150814e-02]]
grads:  [4.90705280e-03 1.45078689e+01]
Stock Position:  0.004907052797909978
Bond Position:  [12.07052612]


portfolio before change:  [12.54032661]
curr_Stock_Price:  95.12481257987207
curr_Factors:  [9.51248126e+01 4.31567364e-02]
mat_Sqrt:  [[ 1.97614183e+01  0.00000000e+00]
 [-8.30967980e-03  1.90398683e-02]]
grads:  [-0.02294778 -1.81317459]
Stock Position:  -0.022947778288664213
Bond Position:  [14.72322972]


portfolio before change:  [12.52430437]
curr_Stock_Price:  95.98343646439442
curr_Factors:  [9.59834365e+01 4.26154331e-02]
mat_Sqrt:  [[ 1.98143463e+01  0.00000000e+00]
 [-8.25740232e-03  1.89200856e-02]]
grads:  [3.28306560e-03 5.01912573e+00]
Stock Position:  0.003283065599702723
Bond Position:  [12.20918445]


portfolio before change:  [12.53145485]
curr_Stock_Price:  97.23160172985277
curr_Factors:  [9.72316017e+01 4.27361640e-02]
mat_Sqrt:  [[ 2.01004236e+01  0.00000000e+00]
 [-8.26909079e-03  1.89468672e-02]]
grads:  [-0.01419755  6.89480863]
Stock Position:  -0.014197552908299011
Bond Position:  [13.91190566]


portfolio before change:  [12.54888027]
curr_Stock_Price:  96.24924893198632
curr_Factors:  [9.62492489e+01 4.27593388e-02]
mat_Sqrt:  [[ 1.99027386e+01  0.00000000e+00]
 [-8.27133254e-03  1.89520037e-02]]
grads:  [4.60500207e-03 8.07355162e+00]
Stock Position:  0.0046050020718564335
Bond Position:  [12.10565228]


portfolio before change:  [12.54206682]
curr_Stock_Price:  94.11238920744523
curr_Factors:  [9.41123892e+01 4.50962913e-02]
mat_Sqrt:  [[ 1.99856010e+01  0.00000000e+00]
 [-8.49435495e-03  1.94630123e-02]]
grads:  [-0.00936514  5.72733939]
Stock Position:  -0.009365141886599364
Bond Position:  [13.42344269]


portfolio before change:  [12.54399772]
curr_Stock_Price:  94.26458943828219
curr_Factors:  [9.42645894e+01 4.61273395e-02]
mat_Sqrt:  [[ 2.02454663e+01  0.00000000e+00]
 [-8.59091050e-03  1.96842488e-02]]
grads:  [0.00643719 0.65818546]
Stock Position:  0.006437190009237578
Bond Position:  [11.93719865]


portfolio before change:  [12.54554632]
curr_Stock_Price:  94.04149942675151
curr_Factors:  [9.40414994e+01 4.57168450e-02]
mat_Sqrt:  [[ 2.01074812e+01  0.00000000e+00]
 [-8.55259913e-03  1.95964665e-02]]
grads:  [-0.00628858 -2.47572888]
Stock Position:  -0.006288577876344473
Bond Position:  [13.13693361]


portfolio before change:  [12.54822488]
curr_Stock_Price:  94.13787776763843
curr_Factors:  [9.41378778e+01 4.35661991e-02]
mat_Sqrt:  [[ 1.96489451e+01  0.00000000e+00]
 [-8.34900704e-03  1.91299784e-02]]
grads:  [-0.00609182  0.80808149]
Stock Position:  -0.006091815089054553
Bond Position:  [13.12169543]


portfolio before change:  [12.55407972]
curr_Stock_Price:  93.71534324102684
curr_Factors:  [9.37153432e+01 4.32809167e-02]
mat_Sqrt:  [[ 1.94966020e+01  0.00000000e+00]
 [-8.32162644e-03  1.90672415e-02]]
grads:  [ 0.00573071 -0.71273066]
Stock Position:  0.005730709940523807
Bond Position:  [12.01702427]


portfolio before change:  [12.55180043]
curr_Stock_Price:  92.79330831883628
curr_Factors:  [9.27933083e+01 4.28841619e-02]
mat_Sqrt:  [[ 1.92160943e+01  0.00000000e+00]
 [-8.28339659e-03  1.89796459e-02]]
grads:  [ 0.00301309 -1.66711714]
Stock Position:  0.0030130944187181756
Bond Position:  [12.27220543]


portfolio before change:  [12.55323461]
curr_Stock_Price:  92.25092167866808
curr_Factors:  [9.22509217e+01 4.32297589e-02]
mat_Sqrt:  [[ 1.91805970e+01  0.00000000e+00]
 [-8.31670693e-03  1.90559695e-02]]
grads:  [-0.01690575 -5.79167322]
Stock Position:  -0.016905751495952633
Bond Position:  [14.11280576]


portfolio before change:  [12.61634286]
curr_Stock_Price:  88.72670045923476
curr_Factors:  [8.87267005e+01 4.42843543e-02]
mat_Sqrt:  [[ 1.86715121e+01  0.00000000e+00]
 [-8.41753924e-03  1.92870054e-02]]
grads:  [0.00668785 5.89407151]
Stock Position:  0.006687853415456924
Bond Position:  [12.02295169]


portfolio before change:  [12.62750944]
curr_Stock_Price:  89.94689249141932
curr_Factors:  [8.99468925e+01 4.33386429e-02]
mat_Sqrt:  [[ 1.87250859e+01  0.00000000e+00]
 [-8.32717411e-03  1.90799528e-02]]
grads:  [-0.00174968 -1.62707945]
Stock Position:  -0.001749684902753159
Bond Position:  [12.78488816]


portfolio before change:  [12.63122377]
curr_Stock_Price:  89.65100642343282
curr_Factors:  [8.96510064e+01 4.35466818e-02]
mat_Sqrt:  [[ 1.87082301e+01  0.00000000e+00]
 [-8.34713669e-03  1.91256929e-02]]
grads:  [  0.06193398 -33.71169537]
Stock Position:  0.061933982440562654
Bond Position:  [7.07877991]


portfolio before change:  [12.71006502]
curr_Stock_Price:  90.89541750137396
curr_Factors:  [9.08954175e+01 4.13196224e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.71006502]
Stock Price:  92.22175828169823
PL:  [12.71006502]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.62162553e-01 -1.36749734e+00]
 [-1.44730538e-02  2.78114124e-01]
 [-4.34847884e-01 -3.64040706e-02]
 [ 9.40460789e-02  5.31380586e-02]
 [-1.90402322e-01  4.72962300e-02]
 [-1.30126497e-01 -2.38035332e-01]
 [-2.47668841e-01  1.65929658e-01]
 [ 1.45345479e-01  1.16602859e-02]
 [-1.06004474e-01 -5.09235030e-02]
 [-7.52762718e-02 -1.48351555e-02]
 [ 3.79364616e-02  2.70571626e-04]
 [ 5.76161806e-02 -5.25698133e-02]
 [-2.70342785e-01 -1.12713148e-01]
 [ 8.79217709e-02  1.87357966e-02]
 [ 3.60985146e-02 -6.33832724e-02]
 [ 1.39692187e+00 -6.26723915e-01]
 [ 1.47430026e-01  2.01081394e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.0160939]
curr_Stock_Price:  99.18290835768538
curr_Factors:  [9.91829084e+01 4.01448735e-02]
mat_Sqrt:  [[ 1.98724716e+01  0.00000000e+00]
 [-8.01447425e-03  1.83634675e-02]]
grads:  [ 0.00140252 -0.07356096]
Stock Position:  0.001402521947510141
Bond Position:  [-3.15520011]


portfolio before change:  [-3.01873702]
curr_Stock_Price:  97.86084562152928
curr_Factors:  [9.78608456e+01 4.12448125e-02]
mat_Sqrt:  [[ 1.98743819e+01  0.00000000e+00]
 [-8.12352756e-03  1.86133400e-02]]
grads:  [-0.00937513 -3.58087104]
Stock Position:  -0.00937512778821136
Bond Position:  [-2.10127909]


portfolio before change:  [-2.99657326]
curr_Stock_Price:  95.4407033336206
curr_Factors:  [9.54407033e+01 3.99443203e-02]
mat_Sqrt:  [[ 1.90748508e+01  0.00000000e+00]
 [-7.99443009e-03  1.83175405e-02]]
grads:  [-3.97899482e-02 -7.46550741e+01]
Stock Position:  -0.0397899481823296
Bond Position:  [0.80100738]


portfolio before change:  [-3.01488043]
curr_Stock_Price:  95.90583196313392
curr_Factors:  [9.5905832e+01 4.0212137e-02]
mat_Sqrt:  [[ 1.92319621e+01  0.00000000e+00]
 [-8.02118564e-03  1.83788452e-02]]
grads:  [5.55876206e-03 1.51322959e+01]
Stock Position:  0.005558762056028776
Bond Position:  [-3.54799813]


portfolio before change:  [-3.01912814]
curr_Stock_Price:  95.30127275824537
curr_Factors:  [9.53012728e+01 3.88350936e-02]
mat_Sqrt:  [[ 1.87806612e+01  0.00000000e+00]
 [-7.88264865e-03  1.80614171e-02]]
grads:  [-0.024      -2.01557112]
Stock Position:  -0.02400000286614267
Bond Position:  [-0.73189732]


portfolio before change:  [-3.02662747]
curr_Stock_Price:  95.60611975497638
curr_Factors:  [9.56061198e+01 3.91544159e-02]
mat_Sqrt:  [[ 1.89180369e+01  0.00000000e+00]
 [-7.91498992e-03  1.81355202e-02]]
grads:  [0.00619712 2.93005428]
Stock Position:  0.006197124463110804
Bond Position:  [-3.61911049]


portfolio before change:  [-3.03948641]
curr_Stock_Price:  93.6771521251474
curr_Factors:  [9.36771521e+01 3.94705191e-02]
mat_Sqrt:  [[ 1.86110167e+01  0.00000000e+00]
 [-7.94687552e-03  1.82085793e-02]]
grads:  [-0.00912151  2.59746953]
Stock Position:  -0.00912150891711632
Bond Position:  [-2.18500943]


portfolio before change:  [-3.02993727]
curr_Stock_Price:  92.57037667816427
curr_Factors:  [9.25703767e+01 3.62057453e-02]
mat_Sqrt:  [[ 1.76141129e+01  0.00000000e+00]
 [-7.61112294e-03  1.74392735e-02]]
grads:  [-1.32855758e-02 -1.36493835e+01]
Stock Position:  -0.013285575827147008
Bond Position:  [-1.80008651]


portfolio before change:  [-3.0205243]
curr_Stock_Price:  91.82798892819626
curr_Factors:  [9.18279889e+01 3.77767499e-02]
mat_Sqrt:  [[ 1.78479101e+01  0.00000000e+00]
 [-7.77449676e-03  1.78136099e-02]]
grads:  [-0.00981914  9.31476877]
Stock Position:  -0.009819144155975531
Bond Position:  [-2.11885204]


portfolio before change:  [-3.05046759]
curr_Stock_Price:  94.82351575430366
curr_Factors:  [9.48235158e+01 3.56193454e-02]
mat_Sqrt:  [[ 1.78961256e+01  0.00000000e+00]
 [-7.54923523e-03  1.72974709e-02]]
grads:  [0.00840598 0.67410351]
Stock Position:  0.008405978358708825
Bond Position:  [-3.84755201]


portfolio before change:  [-3.05255368]
curr_Stock_Price:  94.68979121580806
curr_Factors:  [9.46897912e+01 3.64052367e-02]
mat_Sqrt:  [[ 1.80669602e+01  0.00000000e+00]
 [-7.63206255e-03  1.74872522e-02]]
grads:  [-0.00709745 -2.91203572]
Stock Position:  -0.007097448097314203
Bond Position:  [-2.3804978]


portfolio before change:  [-3.03625538]
curr_Stock_Price:  92.30956954980502
curr_Factors:  [9.23095695e+01 3.64263240e-02]
mat_Sqrt:  [[ 1.76179105e+01  0.00000000e+00]
 [-7.63427262e-03  1.74923161e-02]]
grads:  [-0.00464021 -0.84809556]
Stock Position:  -0.004640213412049327
Bond Position:  [-2.60791928]


portfolio before change:  [-3.04818444]
curr_Stock_Price:  94.73984463511326
curr_Factors:  [9.47398446e+01 3.70235771e-02]
mat_Sqrt:  [[ 1.82293783e+01  0.00000000e+00]
 [-7.69660466e-03  1.76351367e-02]]
grads:  [0.00208754 0.01534276]
Stock Position:  0.002087539583795521
Bond Position:  [-3.24595761]


portfolio before change:  [-3.05241315]
curr_Stock_Price:  93.10293082259318
curr_Factors:  [9.31029308e+01 3.68826959e-02]
mat_Sqrt:  [[ 1.78802951e+01  0.00000000e+00]
 [-7.68194724e-03  1.76015524e-02]]
grads:  [ 1.93916448e-03 -2.98665778e+00]
Stock Position:  0.0019391644798767047
Bond Position:  [-3.23295505]


portfolio before change:  [-3.05424981]
curr_Stock_Price:  92.57264054022829
curr_Factors:  [9.25726405e+01 3.70443955e-02]
mat_Sqrt:  [[ 1.78173827e+01  0.00000000e+00]
 [-7.69876827e-03  1.76400942e-02]]
grads:  [-0.01793388 -6.38960015]
Stock Position:  -0.01793388185482692
Bond Position:  [-1.39406301]


portfolio before change:  [-3.07214909]
curr_Stock_Price:  93.55127516550921
curr_Factors:  [9.35512752e+01 3.56354355e-02]
mat_Sqrt:  [[ 1.76600019e+01  0.00000000e+00]
 [-7.55094013e-03  1.73013774e-02]]
grads:  [0.0054416  1.08290781]
Stock Position:  0.00544160432579162
Bond Position:  [-3.58121811]


portfolio before change:  [-3.07864738]
curr_Stock_Price:  92.521638220871
curr_Factors:  [9.25216382e+01 3.71930527e-02]
mat_Sqrt:  [[ 1.78432609e+01  0.00000000e+00]
 [-7.71420017e-03  1.76754531e-02]]
grads:  [ 4.72771582e-04 -3.58594894e+00]
Stock Position:  0.0004727715819515185
Bond Position:  [-3.12238898]


portfolio before change:  [-3.08056564]
curr_Stock_Price:  90.11547772876229
curr_Factors:  [9.01154777e+01 3.98027096e-02]
mat_Sqrt:  [[ 1.79785933e+01  0.00000000e+00]
 [-7.98024657e-03  1.82850420e-02]]
grads:  [  0.06248526 -34.27522426]
Stock Position:  0.06248526266543123
Bond Position:  [-8.71145494]


portfolio before change:  [-2.94285507]
curr_Stock_Price:  92.35422486649395
curr_Factors:  [9.23542249e+01 4.10064996e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.94285507]
Stock Price:  90.21299132013498
PL:  [-2.94285507]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.95899982e-02  1.31697867e-02]
 [-8.36430033e-03 -2.57254207e-02]
 [-1.14506293e-01 -2.41869628e-01]
 [ 2.50578216e-01 -1.25129748e-01]
 [-1.04732657e-01 -7.33840372e-02]
 [ 8.00269244e-01 -1.11453850e+00]
 [-6.24394582e-01  5.64420343e-01]
 [ 3.27206085e-01  1.58390898e-01]
 [-1.21646208e-01 -2.35753986e-02]
 [ 3.17085477e-01  4.98040443e-03]
 [ 1.97526301e-01  2.89479030e-01]
 [-2.38489448e-01  1.06193214e-01]
 [-8.37650221e-03  5.51584633e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 1.42719077e-01  1.51517486e-04]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.25348489e-02  1.24282779e-02]
 [ 4.87115845e-01 -2.61611601e-01]
 [ 2.07002083e-01  1.30347537e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.18141959]
curr_Stock_Price:  99.93734454059704
curr_Factors:  [9.99373445e+01 4.08941916e-02]
mat_Sqrt:  [[ 2.02096419e+01  0.00000000e+00]
 [-8.08892493e-03  1.85340554e-02]]
grads:  [-0.00365381  0.71057232]
Stock Position:  -0.0036538119927349215
Bond Position:  [2.54657186]


portfolio before change:  [2.17478156]
curr_Stock_Price:  101.92834800672715
curr_Factors:  [1.01928348e+02 4.14428328e-02]
mat_Sqrt:  [[ 2.07500765e+01  0.00000000e+00]
 [-8.14300513e-03  1.86579687e-02]]
grads:  [-9.44179381e-04 -1.37879000e+00]
Stock Position:  -0.0009441793809468968
Bond Position:  [2.2710202]


portfolio before change:  [2.17396236]
curr_Stock_Price:  103.39737786772491
curr_Factors:  [1.03397378e+02 4.16153982e-02]
mat_Sqrt:  [[ 2.10929126e+01  0.00000000e+00]
 [-8.15994100e-03  1.86967736e-02]]
grads:  [-1.04332132e-02 -1.29364367e+01]
Stock Position:  -0.010433213173344457
Bond Position:  [3.25272924]


portfolio before change:  [2.17996012]
curr_Stock_Price:  102.90045722230352
curr_Factors:  [1.02900457e+02 4.41195258e-02]
mat_Sqrt:  [[ 2.16138793e+01  0.00000000e+00]
 [-8.40185940e-03  1.92510783e-02]]
grads:  [ 0.00906673 -6.49988255]
Stock Position:  0.009066725781086497
Bond Position:  [1.24698989]


portfolio before change:  [2.18795216]
curr_Stock_Price:  103.74753865516523
curr_Factors:  [1.03747539e+02 4.28396690e-02]
mat_Sqrt:  [[ 2.14734021e+01  0.00000000e+00]
 [-8.27909841e-03  1.89697976e-02]]
grads:  [-0.00636881 -3.86846707]
Stock Position:  -0.006368812749628404
Bond Position:  [2.84870081]


portfolio before change:  [2.17792514]
curr_Stock_Price:  105.43376959409783
curr_Factors:  [1.05433770e+02 4.32639649e-02]
mat_Sqrt:  [[ 2.19302152e+01  0.00000000e+00]
 [-8.31999662e-03  1.90635071e-02]]
grads:  [ 1.43110663e-02 -5.84645047e+01]
Stock Position:  0.014311066252779364
Bond Position:  [0.66905547]


portfolio before change:  [2.17325975]
curr_Stock_Price:  105.09608192834028
curr_Factors:  [1.05096082e+02 4.38111640e-02]
mat_Sqrt:  [[ 2.19977834e+01  0.00000000e+00]
 [-8.37244662e-03  1.91836852e-02]]
grads:  [-1.71863384e-02  2.94218935e+01]
Stock Position:  -0.017186338386447425
Bond Position:  [3.97947658]


portfolio before change:  [2.22126556]
curr_Stock_Price:  102.3607220196827
curr_Factors:  [1.02360722e+02 4.57523868e-02]
mat_Sqrt:  [[ 2.18947615e+01  0.00000000e+00]
 [-8.55592303e-03  1.96040825e-02]]
grads:  [0.01810175 8.07948538]
Stock Position:  0.018101751892287365
Bond Position:  [0.36835717]


portfolio before change:  [2.21764683]
curr_Stock_Price:  102.15572318047046
curr_Factors:  [1.02155723e+02 4.47266803e-02]
mat_Sqrt:  [[ 2.16045903e+01  0.00000000e+00]
 [-8.45947330e-03  1.93830884e-02]]
grads:  [-0.00610682 -1.21628701]
Stock Position:  -0.006106820529814659
Bond Position:  [2.84149349]


portfolio before change:  [2.22755022]
curr_Stock_Price:  100.65036888178183
curr_Factors:  [1.00650369e+02 4.58256458e-02]
mat_Sqrt:  [[ 2.15461495e+01  0.00000000e+00]
 [-8.56277019e-03  1.96197713e-02]]
grads:  [0.01481746 0.2538462 ]
Stock Position:  0.014817455154939938
Bond Position:  [0.73616789]


portfolio before change:  [2.27533298]
curr_Stock_Price:  103.86270857518193
curr_Factors:  [1.03862709e+02 4.64312723e-02]
mat_Sqrt:  [[ 2.23802501e+01  0.00000000e+00]
 [-8.61916676e-03  1.97489921e-02]]
grads:  [1.44710316e-02 1.46579142e+01]
Stock Position:  0.014471031603108786
Bond Position:  [0.77233244]


portfolio before change:  [2.25463143]
curr_Stock_Price:  102.41881310272744
curr_Factors:  [1.02418813e+02 4.56601743e-02]
mat_Sqrt:  [[ 2.18850993e+01  0.00000000e+00]
 [-8.54729658e-03  1.95843168e-02]]
grads:  [-0.00877962  5.4223599 ]
Stock Position:  -0.008779623399280012
Bond Position:  [3.15383004]


portfolio before change:  [2.25339567]
curr_Stock_Price:  102.64938360414601
curr_Factors:  [1.02649384e+02 4.61025134e-02]
mat_Sqrt:  [[ 2.20403581e+01  0.00000000e+00]
 [-8.58859834e-03  1.96789510e-02]]
grads:  [7.12176485e-04 2.80291685e+00]
Stock Position:  0.0007121764852338917
Bond Position:  [2.18029119]


portfolio before change:  [2.25506395]
curr_Stock_Price:  104.22643927148891
curr_Factors:  [1.04226439e+02 4.34408529e-02]
mat_Sqrt:  [[ 2.17233637e+01  0.00000000e+00]
 [-8.33698774e-03  1.91024387e-02]]
grads:  [ -0.01891238 -13.05955703]
Stock Position:  -0.01891238336544214
Bond Position:  [4.22623433]


portfolio before change:  [2.28064764]
curr_Stock_Price:  102.92956411707924
curr_Factors:  [1.02929564e+02 4.46027659e-02]
mat_Sqrt:  [[ 2.17380723e+01  0.00000000e+00]
 [-8.44774676e-03  1.93562195e-02]]
grads:  [0.00656844 0.00782785]
Stock Position:  0.006568439109893523
Bond Position:  [1.60456107]


portfolio before change:  [2.29296322]
curr_Stock_Price:  104.74344846928712
curr_Factors:  [1.04743448e+02 4.45673449e-02]
mat_Sqrt:  [[ 2.21123678e+01  0.00000000e+00]
 [-8.44439174e-03  1.93485322e-02]]
grads:  [0.00434128 0.90606644]
Stock Position:  0.004341277750217742
Bond Position:  [1.83824282]


portfolio before change:  [2.28279599]
curr_Stock_Price:  102.29558645173732
curr_Factors:  [1.02295586e+02 4.57157162e-02]
mat_Sqrt:  [[ 2.18720586e+01  0.00000000e+00]
 [-8.55249355e-03  1.95962245e-02]]
grads:  [-0.00215392  0.63421798]
Stock Position:  -0.0021539217956746282
Bond Position:  [2.50313268]


portfolio before change:  [2.28768469]
curr_Stock_Price:  100.31648015503245
curr_Factors:  [1.00316480e+02 4.47077608e-02]
mat_Sqrt:  [[ 2.12111270e+01  0.00000000e+00]
 [-8.45768391e-03  1.93789884e-02]]
grads:  [  0.01758224 -13.49975532]
Stock Position:  0.017582242604478004
Bond Position:  [0.523896]


portfolio before change:  [2.26472228]
curr_Stock_Price:  99.00302977938675
curr_Factors:  [9.90030298e+01 4.50268150e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.26472228]
Stock Price:  97.36555224388874
PL:  [2.26472228]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-4.44856993e-02  6.48160873e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.57154128e-01 -5.32849737e-01]
 [ 3.25737653e-01 -2.50985525e-01]
 [-8.49246111e-02 -6.79092909e-02]
 [ 6.70154793e-01 -9.13210822e-01]
 [-6.13981622e-01  5.35463821e-01]
 [ 6.68980409e-01  1.85236971e-01]
 [ 1.17168892e-01 -1.15279670e-01]
 [-3.31957113e-02  2.59872883e-02]
 [ 3.08853464e-01  4.67210873e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.41979524e-01  1.53858472e-01]
 [-2.20747871e-01  2.87053638e-02]
 [ 2.60014338e-01  3.51245756e-01]
 [-1.14485244e-02  1.12544359e-01]
 [-5.53081787e-02  5.13361400e-01]
 [ 2.48951403e-01  2.33068628e-01]
 [ 3.07986592e-02 -2.88578461e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.92340036]
curr_Stock_Price:  99.75473891046508
curr_Factors:  [9.97547389e+01 4.07421301e-02]
mat_Sqrt:  [[ 2.01351747e+01  0.00000000e+00]
 [-8.07387195e-03  1.84995647e-02]]
grads:  [-0.00206886  0.35036547]
Stock Position:  -0.002068861779949057
Bond Position:  [1.12977912]


portfolio before change:  [0.92529763]
curr_Stock_Price:  98.9742146493657
curr_Factors:  [9.89742146e+01 4.19067368e-02]
mat_Sqrt:  [[ 2.02611451e+01  0.00000000e+00]
 [-8.18845400e-03  1.87621051e-02]]
grads:  [-0.00919617 -3.55247824]
Stock Position:  -0.00919616681568682
Bond Position:  [1.83548102]


portfolio before change:  [0.90715018]
curr_Stock_Price:  100.99749101275994
curr_Factors:  [1.00997491e+02 4.35403787e-02]
mat_Sqrt:  [[ 2.10744712e+01  0.00000000e+00]
 [-8.34653257e-03  1.91243086e-02]]
grads:  [-1.84919857e-02 -2.78624314e+01]
Stock Position:  -0.018491985675930266
Bond Position:  [2.77479433]


portfolio before change:  [0.84322864]
curr_Stock_Price:  104.49172475108277
curr_Factors:  [1.04491725e+02 4.21239202e-02]
mat_Sqrt:  [[ 2.14459994e+01  0.00000000e+00]
 [-8.20964508e-03  1.88106600e-02]]
grads:  [ 1.00810686e-02 -1.33427283e+01]
Stock Position:  0.010081068553193132
Bond Position:  [-0.2101596]


portfolio before change:  [0.84413513]
curr_Stock_Price:  104.58685678487531
curr_Factors:  [1.04586857e+02 4.18725849e-02]
mat_Sqrt:  [[ 2.14013908e+01  0.00000000e+00]
 [-8.18511673e-03  1.87544585e-02]]
grads:  [-0.00535305 -3.62096783]
Stock Position:  -0.005353047223550602
Bond Position:  [1.40399351]


portfolio before change:  [0.84783084]
curr_Stock_Price:  103.96203967390069
curr_Factors:  [1.03962040e+02 4.19742401e-02]
mat_Sqrt:  [[ 2.12993433e+01  0.00000000e+00]
 [-8.19504632e-03  1.87772100e-02]]
grads:  [ 1.27514220e-02 -4.86339994e+01]
Stock Position:  0.012751422039310059
Bond Position:  [-0.477833]


portfolio before change:  [0.85701348]
curr_Stock_Price:  104.69153525618191
curr_Factors:  [1.04691535e+02 4.13514069e-02]
mat_Sqrt:  [[ 2.12890712e+01  0.00000000e+00]
 [-8.13401814e-03  1.86373769e-02]]
grads:  [-1.78629705e-02  2.87306429e+01]
Stock Position:  -0.017862970533882506
Bond Position:  [2.72711529]


portfolio before change:  [0.83825264]
curr_Stock_Price:  105.77997147405381
curr_Factors:  [1.05779971e+02 4.24278103e-02]
mat_Sqrt:  [[ 2.17885713e+01  0.00000000e+00]
 [-8.23920484e-03  1.88783899e-02]]
grads:  [0.03441366 9.81211703]
Stock Position:  0.034413658392594706
Bond Position:  [-2.80202317]


portfolio before change:  [0.80346859]
curr_Stock_Price:  104.7895665488394
curr_Factors:  [1.04789567e+02 4.18589490e-02]
mat_Sqrt:  [[ 2.14393791e+01  0.00000000e+00]
 [-8.18378387e-03  1.87514045e-02]]
grads:  [ 3.11840743e-03 -6.14778855e+00]
Stock Position:  0.0031184074306263923
Bond Position:  [0.47669202]


portfolio before change:  [0.80982049]
curr_Stock_Price:  106.7882520732867
curr_Factors:  [1.06788252e+02 4.43890479e-02]
mat_Sqrt:  [[ 2.24989056e+01  0.00000000e+00]
 [-8.42748341e-03  1.93097903e-02]]
grads:  [-9.71332973e-04  1.34580893e+00]
Stock Position:  -0.0009713329726230124
Bond Position:  [0.91354744]


portfolio before change:  [0.80942668]
curr_Stock_Price:  107.42884275720867
curr_Factors:  [1.07428843e+02 4.69461212e-02]
mat_Sqrt:  [[ 2.32766649e+01  0.00000000e+00]
 [-8.66682144e-03  1.98581826e-02]]
grads:  [2.20289722e-02 2.35273732e+01]
Stock Position:  0.022028972233200366
Bond Position:  [-1.55712032]


portfolio before change:  [0.79688088]
curr_Stock_Price:  106.87700256965336
curr_Factors:  [1.06877003e+02 4.69889855e-02]
mat_Sqrt:  [[ 2.31676669e+01  0.00000000e+00]
 [-8.67077718e-03  1.98672464e-02]]
grads:  [-0.00815826  5.75485509]
Stock Position:  -0.008158264921923128
Bond Position:  [1.66881178]


portfolio before change:  [0.77996265]
curr_Stock_Price:  109.00190120035586
curr_Factors:  [1.09001901e+02 4.44625595e-02]
mat_Sqrt:  [[ 2.29843011e+01  0.00000000e+00]
 [-8.43445880e-03  1.93257729e-02]]
grads:  [-3.25570838e-03  7.96131016e+00]
Stock Position:  -0.003255708376885691
Bond Position:  [1.13484105]


portfolio before change:  [0.78161013]
curr_Stock_Price:  108.58302676327072
curr_Factors:  [1.08583027e+02 4.60169623e-02]
mat_Sqrt:  [[ 2.32927581e+01  0.00000000e+00]
 [-8.58062583e-03  1.96606837e-02]]
grads:  [-0.00893925  1.46003894]
Stock Position:  -0.008939251491837523
Bond Position:  [1.75226111]


portfolio before change:  [0.77141103]
curr_Stock_Price:  109.77297140043306
curr_Factors:  [1.09772971e+02 4.93599076e-02]
mat_Sqrt:  [[ 2.43883595e+01  0.00000000e+00]
 [-8.88683589e-03  2.03622991e-02]]
grads:  [1.69470420e-02 1.72498083e+01]
Stock Position:  0.016947041982338852
Bond Position:  [-1.08891612]


portfolio before change:  [0.8260041]
curr_Stock_Price:  113.01042915513895
curr_Factors:  [1.13010429e+02 4.87752352e-02]
mat_Sqrt:  [[ 2.49584845e+01  0.00000000e+00]
 [-8.83404643e-03  2.02413432e-02]]
grads:  [1.50930081e-03 5.56012306e+00]
Stock Position:  0.0015093008104571759
Bond Position:  [0.65543737]


portfolio before change:  [0.82871921]
curr_Stock_Price:  114.7007688439823
curr_Factors:  [1.14700769e+02 4.74179571e-02]
mat_Sqrt:  [[ 2.49768548e+01  0.00000000e+00]
 [-8.71026586e-03  1.99577263e-02]]
grads:  [6.75589886e-03 2.57224391e+01]
Stock Position:  0.006755898860061747
Bond Position:  [0.05381242]


portfolio before change:  [0.84610672]
curr_Stock_Price:  117.27245594711123
curr_Factors:  [1.17272456e+02 4.18529617e-02]
mat_Sqrt:  [[ 2.39915948e+01  0.00000000e+00]
 [-8.18319856e-03  1.87500634e-02]]
grads:  [ 0.01461641 12.43028478]
Stock Position:  0.014616406030829565
Bond Position:  [-0.86799511]


portfolio before change:  [0.82089593]
curr_Stock_Price:  115.56247527505936
curr_Factors:  [1.15562475e+02 4.17900747e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.82089593]
Stock Price:  116.49747159624589
PL:  [-15.67657567]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.91698920e-02  3.76340125e-03]
 [-1.44611280e-01 -6.26913983e-02]
 [-1.47630574e-01 -4.67871878e-01]
 [ 2.41576736e-01 -1.10056614e-01]
 [-2.41744452e-01 -9.42288473e-02]
 [ 3.92577331e-01 -4.82893380e-01]
 [-5.24858743e-01  2.91214448e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.44061055e-01  5.47455908e-03]
 [ 1.51658123e-02  9.29241840e-02]
 [-2.36562832e-01  6.86377658e-02]
 [-7.41776766e-02  3.41478322e-02]
 [-2.29179762e-01 -2.72806338e-01]
 [ 5.60874843e-03 -7.97312835e-02]
 [ 8.93795463e-02  5.61816716e-02]
 [ 3.72751533e-02 -7.38451066e-02]
 [ 6.38996730e-01 -3.11838409e-01]
 [ 1.79118228e-01  1.41068856e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.06805027]
curr_Stock_Price:  99.63058203099536
curr_Factors:  [9.9630582e+01 4.1011033e-02]
mat_Sqrt:  [[ 2.01763695e+01  0.00000000e+00]
 [-8.10047238e-03  1.85605139e-02]]
grads:  [-0.00086871  0.20276385]
Stock Position:  -0.0008687097609184999
Bond Position:  [0.15460033]


portfolio before change:  [0.06680732]
curr_Stock_Price:  101.10587613802407
curr_Factors:  [1.01105876e+02 3.89609895e-02]
mat_Sqrt:  [[ 1.99568221e+01  0.00000000e+00]
 [-7.89541533e-03  1.80906692e-02]]
grads:  [-0.00861721 -3.46539963]
Stock Position:  -0.008617206111975811
Bond Position:  [0.9380575]


portfolio before change:  [0.0635685]
curr_Stock_Price:  101.50894984280718
curr_Factors:  [1.01508950e+02 3.87791315e-02]
mat_Sqrt:  [[ 1.99895664e+01  0.00000000e+00]
 [-7.87696708e-03  1.80483989e-02]]
grads:  [-1.76005119e-02 -2.59231791e+01]
Stock Position:  -0.017600511915854874
Bond Position:  [1.85017798]


portfolio before change:  [0.04286881]
curr_Stock_Price:  102.71131744979776
curr_Factors:  [1.02711317e+02 3.84554520e-02]
mat_Sqrt:  [[ 2.01417527e+01  0.00000000e+00]
 [-7.84402468e-03  1.79729184e-02]]
grads:  [ 0.0096091  -6.12346929]
Stock Position:  0.00960909880448221
Bond Position:  [-0.94409438]


portfolio before change:  [0.02965882]
curr_Stock_Price:  101.36114538562856
curr_Factors:  [1.01361145e+02 3.76476106e-02]
mat_Sqrt:  [[ 1.96670951e+01  0.00000000e+00]
 [-7.76119688e-03  1.77831361e-02]]
grads:  [-0.01438287 -5.29877558]
Stock Position:  -0.014382870996675547
Bond Position:  [1.4875231]


portfolio before change:  [0.03964085]
curr_Stock_Price:  100.69298240263667
curr_Factors:  [1.00692982e+02 3.67203135e-02]
mat_Sqrt:  [[ 1.92953382e+01  0.00000000e+00]
 [-7.66501804e-03  1.75627627e-02]]
grads:  [ 9.42328040e-03 -2.74952972e+01]
Stock Position:  0.009423280396647766
Bond Position:  [-0.90921735]


portfolio before change:  [0.04266452]
curr_Stock_Price:  101.03797950266484
curr_Factors:  [1.01037980e+02 3.73419434e-02]
mat_Sqrt:  [[ 1.95246434e+01  0.00000000e+00]
 [-7.72962544e-03  1.77107968e-02]]
grads:  [-0.02037232 16.44276376]
Stock Position:  -0.020372322804051074
Bond Position:  [2.10104286]


portfolio before change:  [0.08397176]
curr_Stock_Price:  99.03615013480042
curr_Factors:  [9.90361501e+01 4.07791518e-02]
mat_Sqrt:  [[ 1.99992101e+01  0.00000000e+00]
 [-8.07753941e-03  1.85079679e-02]]
grads:  [4.89045065e-03 7.33300303e+00]
Stock Position:  0.004890450652168623
Bond Position:  [-0.40035964]


portfolio before change:  [0.08517107]
curr_Stock_Price:  99.30185371056561
curr_Factors:  [9.93018537e+01 4.12744062e-02]
mat_Sqrt:  [[ 2.01742674e+01  0.00000000e+00]
 [-8.12644140e-03  1.86200164e-02]]
grads:  [-0.01078507 -2.85439658]
Stock Position:  -0.010785069240301922
Bond Position:  [1.15614844]


portfolio before change:  [0.09347394]
curr_Stock_Price:  98.5588080788753
curr_Factors:  [9.85588081e+01 3.97563255e-02]
mat_Sqrt:  [[ 1.96516292e+01  0.00000000e+00]
 [-7.97559533e-03  1.82743846e-02]]
grads:  [0.01254096 0.29957556]
Stock Position:  0.01254096265863522
Bond Position:  [-1.14254839]


portfolio before change:  [0.09766047]
curr_Stock_Price:  98.91541508141992
curr_Factors:  [9.89154151e+01 3.97360063e-02]
mat_Sqrt:  [[ 1.97176923e+01  0.00000000e+00]
 [-7.97355693e-03  1.82697141e-02]]
grads:  [2.82595195e-03 5.08624183e+00]
Stock Position:  0.0028259519513402645
Bond Position:  [-0.18186974]


portfolio before change:  [0.09456821]
curr_Stock_Price:  97.83727034777836
curr_Factors:  [9.78372703e+01 3.93649059e-02]
mat_Sqrt:  [[ 1.94114929e+01  0.00000000e+00]
 [-7.93623648e-03  1.81842022e-02]]
grads:  [-0.01064353  3.77458219]
Stock Position:  -0.010643532504036433
Bond Position:  [1.13590238]


portfolio before change:  [0.08664145]
curr_Stock_Price:  98.6087026579071
curr_Factors:  [9.86087027e+01 3.81167510e-02]
mat_Sqrt:  [[ 1.92518816e+01  0.00000000e+00]
 [-7.80940469e-03  1.78935941e-02]]
grads:  [-0.00307889  1.90838308]
Stock Position:  -0.0030788855851877827
Bond Position:  [0.39024637]


portfolio before change:  [0.08101912]
curr_Stock_Price:  100.46648803430145
curr_Factors:  [1.00466488e+02 3.69348286e-02]
mat_Sqrt:  [[ 1.93080878e+01  0.00000000e+00]
 [-7.68737443e-03  1.76139876e-02]]
grads:  [ -0.01803608 -15.48805096]
Stock Position:  -0.018036079617144075
Bond Position:  [1.8930407]


portfolio before change:  [0.06849603]
curr_Stock_Price:  101.1870666869674
curr_Factors:  [1.01187067e+02 3.84005868e-02]
mat_Sqrt:  [[ 1.98286861e+01  0.00000000e+00]
 [-7.83842706e-03  1.79600927e-02]]
grads:  [-1.47205097e-03 -4.43935814e+00]
Stock Position:  -0.0014720509697715347
Bond Position:  [0.21744854]


portfolio before change:  [0.07196315]
curr_Stock_Price:  98.86869799744947
curr_Factors:  [9.88686980e+01 3.97556674e-02]
mat_Sqrt:  [[ 1.97132550e+01  0.00000000e+00]
 [-7.97552932e-03  1.82742334e-02]]
grads:  [0.0057778  3.07436544]
Stock Position:  0.005777799659865027
Bond Position:  [-0.49928038]


portfolio before change:  [0.06306158]
curr_Stock_Price:  97.34965374063039
curr_Factors:  [9.73496537e+01 4.08756352e-02]
mat_Sqrt:  [[ 1.96818840e+01  0.00000000e+00]
 [-8.08708948e-03  1.85298499e-02]]
grads:  [ 2.56403633e-04 -3.98519725e+00]
Stock Position:  0.00025640363349492415
Bond Position:  [0.03810078]


portfolio before change:  [0.06327837]
curr_Stock_Price:  98.1580082649597
curr_Factors:  [9.81580083e+01 3.86684867e-02]
mat_Sqrt:  [[ 1.93020895e+01  0.00000000e+00]
 [-7.86572176e-03  1.80226327e-02]]
grads:  [  0.02605414 -17.30260026]
Stock Position:  0.026054137289875632
Bond Position:  [-2.49414385]


portfolio before change:  [0.04368067]
curr_Stock_Price:  97.42975193531393
curr_Factors:  [9.74297519e+01 4.08673119e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.04368067]
Stock Price:  97.2342896129972
PL:  [0.04368067]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 5.50603307e-02 -2.95349614e-03]
 [-1.34784465e-01 -5.96084669e-02]
 [-1.86476819e-01 -1.19900477e+00]
 [-2.10378654e-02  2.77426179e-01]
 [-4.07775939e-01 -7.89717002e-02]
 [ 3.36602323e-01 -3.95588675e-01]
 [-5.09367328e-01  2.33105433e-01]
 [ 1.36872010e-01  1.43440323e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.99845290e-01  4.56735992e-03]
 [ 7.86934745e-02  1.50305773e-01]
 [-2.36862565e-01  7.44804541e-02]
 [-1.09345229e-01  3.15703395e-02]
 [-9.02674058e-02 -2.16279258e-01]
 [-1.39835343e-01 -1.44087243e-01]
 [ 9.64931177e-02  4.87718740e-02]
 [ 1.97845216e-02 -6.51815405e-02]
 [ 6.34948503e-01 -3.10366202e-01]
 [ 1.53846522e-01  1.52083416e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.70857944]
curr_Stock_Price:  96.0341727120493
curr_Factors:  [9.60341727e+01 4.24205898e-02]
mat_Sqrt:  [[ 1.97794472e+01  0.00000000e+00]
 [-8.23850372e-03  1.88767835e-02]]
grads:  [ 0.00271855 -0.15646183]
Stock Position:  0.0027185450940307326
Bond Position:  [-24.96965267]


portfolio before change:  [-24.71763292]
curr_Stock_Price:  95.0004253303474
curr_Factors:  [9.50004253e+01 4.23508840e-02]
mat_Sqrt:  [[ 1.95504514e+01  0.00000000e+00]
 [-8.23173216e-03  1.88612679e-02]]
grads:  [-0.00822486 -3.16036373]
Stock Position:  -0.00822486035663298
Bond Position:  [-23.93626769]


portfolio before change:  [-24.73500137]
curr_Stock_Price:  96.3844765671406
curr_Factors:  [9.63844766e+01 4.26238591e-02]
mat_Sqrt:  [[ 1.98991019e+01  0.00000000e+00]
 [-8.25821861e-03  1.89219559e-02]]
grads:  [-3.56682127e-02 -6.33657942e+01]
Stock Position:  -0.03566821266880772
Bond Position:  [-21.29713936]


portfolio before change:  [-24.7480214]
curr_Stock_Price:  96.60021732191358
curr_Factors:  [9.66002173e+01 4.18689604e-02]
mat_Sqrt:  [[ 1.97662458e+01  0.00000000e+00]
 [-8.18476246e-03  1.87536468e-02]]
grads:  [5.06119607e-03 1.47931857e+01]
Stock Position:  0.005061196069306068
Bond Position:  [-25.23693404]


portfolio before change:  [-24.74642913]
curr_Stock_Price:  98.16156704067417
curr_Factors:  [9.81615670e+01 4.38519354e-02]
mat_Sqrt:  [[ 2.05558702e+01  0.00000000e+00]
 [-8.37634148e-03  1.91926094e-02]]
grads:  [-0.02151415 -4.11469323]
Stock Position:  -0.02151414710350804
Bond Position:  [-22.63456673]


portfolio before change:  [-24.78983339]
curr_Stock_Price:  99.91598978953297
curr_Factors:  [9.99159898e+01 4.22674382e-02]
mat_Sqrt:  [[ 2.05417745e+01  0.00000000e+00]
 [-8.22361850e-03  1.88426771e-02]]
grads:  [ 7.98145607e-03 -2.09942925e+01]
Stock Position:  0.007981456069186961
Bond Position:  [-25.58730847]


portfolio before change:  [-24.79483857]
curr_Stock_Price:  100.09044896836056
curr_Factors:  [1.00090449e+02 4.26484780e-02]
mat_Sqrt:  [[ 2.06701870e+01  0.00000000e+00]
 [-8.26060317e-03  1.89274197e-02]]
grads:  [-0.01972076 12.3157534 ]
Stock Position:  -0.019720759005908074
Bond Position:  [-22.82097895]


portfolio before change:  [-24.8076308]
curr_Stock_Price:  100.44977956713657
curr_Factors:  [1.00449780e+02 4.25096431e-02]
mat_Sqrt:  [[ 2.07106017e+01  0.00000000e+00]
 [-8.24714671e-03  1.88965870e-02]]
grads:  [0.00963152 7.59080581]
Stock Position:  0.00963151632716447
Bond Position:  [-25.7751145]


portfolio before change:  [-24.82457605]
curr_Stock_Price:  99.3595395497905
curr_Factors:  [9.93595395e+01 4.16859136e-02]
mat_Sqrt:  [[ 2.02863649e+01  0.00000000e+00]
 [-8.16685140e-03  1.87126074e-02]]
grads:  [-0.01072547 -2.84027288]
Stock Position:  -0.010725473586717308
Bond Position:  [-23.75889794]


portfolio before change:  [-24.83844642]
curr_Stock_Price:  100.0988913281922
curr_Factors:  [1.00098891e+02 4.24307162e-02]
mat_Sqrt:  [[ 2.06190878e+01  0.00000000e+00]
 [-8.23948700e-03  1.88790364e-02]]
grads:  [0.0146388 0.2419276]
Stock Position:  0.014638797373935235
Bond Position:  [-26.30377381]


portfolio before change:  [-24.8452682]
curr_Stock_Price:  100.08215355112222
curr_Factors:  [1.00082154e+02 4.29765792e-02]
mat_Sqrt:  [[ 2.07478244e+01  0.00000000e+00]
 [-8.29231733e-03  1.90000859e-02]]
grads:  [6.95457456e-03 7.91079438e+00]
Stock Position:  0.006954574561580899
Bond Position:  [-25.541297]


portfolio before change:  [-24.85053505]
curr_Stock_Price:  100.24309448922511
curr_Factors:  [1.00243094e+02 4.31964745e-02]
mat_Sqrt:  [[ 2.08342858e+01  0.00000000e+00]
 [-8.31350463e-03  1.90486321e-02]]
grads:  [-0.00980867  3.91001588]
Stock Position:  -0.009808669836311094
Bond Position:  [-23.86728363]


portfolio before change:  [-24.83052731]
curr_Stock_Price:  97.5948952529053
curr_Factors:  [9.75948953e+01 4.61074128e-02]
mat_Sqrt:  [[ 2.09561973e+01  0.00000000e+00]
 [-8.58905469e-03  1.96799966e-02]]
grads:  [-0.00456031  1.60418419]
Stock Position:  -0.004560312247061111
Bond Position:  [-24.38546411]


portfolio before change:  [-24.83386378]
curr_Stock_Price:  96.98953005882287
curr_Factors:  [9.69895301e+01 4.67699267e-02]
mat_Sqrt:  [[ 2.09753009e+01  0.00000000e+00]
 [-8.65054233e-03  1.98208825e-02]]
grads:  [-8.80365976e-03 -1.09116866e+01]
Stock Position:  -0.008803659756919643
Bond Position:  [-23.98000096]


portfolio before change:  [-24.84036433]
curr_Stock_Price:  97.04687016985902
curr_Factors:  [9.70468702e+01 4.66042400e-02]
mat_Sqrt:  [[ 2.09504931e+01  0.00000000e+00]
 [-8.63520608e-03  1.97857428e-02]]
grads:  [-0.00967615 -7.28237724]
Stock Position:  -0.009676152737357436
Bond Position:  [-23.90132399]


portfolio before change:  [-24.87418348]
curr_Stock_Price:  99.92436357816956
curr_Factors:  [9.99243636e+01 4.50385668e-02]
mat_Sqrt:  [[ 2.12062400e+01  0.00000000e+00]
 [-8.48891670e-03  1.94505517e-02]]
grads:  [0.00555397 2.50748024]
Stock Position:  0.005553974146383954
Bond Position:  [-25.42916081]


portfolio before change:  [-24.89064242]
curr_Stock_Price:  98.10569095391227
curr_Factors:  [9.8105691e+01 4.6887113e-02]
mat_Sqrt:  [[ 2.12432494e+01  0.00000000e+00]
 [-8.66137292e-03  1.98456985e-02]]
grads:  [-4.07801780e-04 -3.28441654e+00]
Stock Position:  -0.00040780178031768336
Bond Position:  [-24.85063475]


portfolio before change:  [-24.89688953]
curr_Stock_Price:  98.18825039768824
curr_Factors:  [9.81882504e+01 4.57487412e-02]
mat_Sqrt:  [[ 2.10014411e+01  0.00000000e+00]
 [-8.55558215e-03  1.96033014e-02]]
grads:  [  0.02378378 -15.83234351]
Stock Position:  0.02378377685569901
Bond Position:  [-27.23217696]


portfolio before change:  [-24.95798672]
curr_Stock_Price:  95.9056736218483
curr_Factors:  [9.59056736e+01 4.57599323e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.95798672]
Stock Price:  96.76407138495223
PL:  [-24.95798672]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.71072749e-02  2.71768403e-01]
 [ 2.35323379e-02 -1.75442205e-02]
 [-1.33883258e-01 -3.74075901e-01]
 [ 1.23533287e-01  7.92410855e-02]
 [-2.30998112e-01 -9.28470654e-02]
 [ 6.61355829e-01 -8.99595253e-01]
 [-6.35464574e-01  6.10980932e-01]
 [ 6.97056725e-01  1.87442341e-01]
 [ 2.88748360e-01 -2.02015227e-01]
 [-1.31928204e-01  3.13419470e-02]
 [ 3.61489707e-01  5.51243703e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.34995052e-01  1.48698653e-01]
 [-2.49760136e-01 -7.06660024e-02]
 [ 2.19462808e-01  2.07366585e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.30433683e-02  6.02948422e-02]
 [ 2.18235285e-01 -1.15285795e-01]
 [ 1.29345463e-01  2.71402255e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.0986482]
curr_Stock_Price:  101.66716948151769
curr_Factors:  [1.01667169e+02 4.02597634e-02]
mat_Sqrt:  [[ 2.03993506e+01  0.00000000e+00]
 [-8.02593431e-03  1.83897257e-02]]
grads:  [7.14320437e-03 1.47782739e+01]
Stock Position:  0.007143204366066059
Bond Position:  [13.37241883]


portfolio before change:  [14.10476816]
curr_Stock_Price:  102.05585232439175
curr_Factors:  [1.02055852e+02 4.03873847e-02]
mat_Sqrt:  [[ 2.05097695e+01  0.00000000e+00]
 [-8.03864513e-03  1.84188499e-02]]
grads:  [ 7.74041481e-04 -9.52514442e-01]
Stock Position:  0.0007740414805143298
Bond Position:  [14.0257727]


portfolio before change:  [14.10846767]
curr_Stock_Price:  102.30471426895755
curr_Factors:  [1.02304714e+02 4.20862365e-02]
mat_Sqrt:  [[ 2.09877408e+01  0.00000000e+00]
 [-8.20597212e-03  1.88022442e-02]]
grads:  [-1.41579491e-02 -1.98952794e+01]
Stock Position:  -0.014157949071667786
Bond Position:  [15.5568926]


portfolio before change:  [14.13334069]
curr_Stock_Price:  100.822627401899
curr_Factors:  [1.00822627e+02 4.35415915e-02]
mat_Sqrt:  [[ 2.10382766e+01  0.00000000e+00]
 [-8.34664881e-03  1.91245750e-02]]
grads:  [0.00751568 4.14341681]
Stock Position:  0.0075156789304505036
Bond Position:  [13.37559019]


portfolio before change:  [14.14149965]
curr_Stock_Price:  101.46324068985871
curr_Factors:  [1.01463241e+02 4.28993423e-02]
mat_Sqrt:  [[ 2.10152251e+01  0.00000000e+00]
 [-8.28486257e-03  1.89830049e-02]]
grads:  [-0.01292015 -4.8910626 ]
Stock Position:  -0.0129201515335684
Bond Position:  [15.45242009]


portfolio before change:  [14.11435673]
curr_Stock_Price:  103.86309705972958
curr_Factors:  [1.03863097e+02 4.17128797e-02]
mat_Sqrt:  [[ 2.12127198e+01  0.00000000e+00]
 [-8.16949249e-03  1.87186589e-02]]
grads:  [ 1.26688268e-02 -4.80587450e+01]
Stock Position:  0.012668826797650884
Bond Position:  [12.79853314]


portfolio before change:  [14.14205797]
curr_Stock_Price:  105.79707282956583
curr_Factors:  [1.05797073e+02 4.29723080e-02]
mat_Sqrt:  [[ 2.19314826e+01  0.00000000e+00]
 [-8.29190525e-03  1.89991417e-02]]
grads:  [-1.68164935e-02  3.21583438e+01]
Stock Position:  -0.016816493477581854
Bond Position:  [15.92119375]


portfolio before change:  [14.14155843]
curr_Stock_Price:  106.06349755299387
curr_Factors:  [1.06063498e+02 4.41426863e-02]
mat_Sqrt:  [[ 2.22841116e+01  0.00000000e+00]
 [-8.40406438e-03  1.92561306e-02]]
grads:  [0.03495151 9.73416443]
Stock Position:  0.03495150647938075
Bond Position:  [10.43447941]


portfolio before change:  [14.20011846]
curr_Stock_Price:  107.66431783144873
curr_Factors:  [1.07664318e+02 4.36653537e-02]
mat_Sqrt:  [[ 2.24978121e+01  0.00000000e+00]
 [-8.35850262e-03  1.91517355e-02]]
grads:  [ 8.91560859e-03 -1.05481421e+01]
Stock Position:  0.00891560858947199
Bond Position:  [13.24022554]


portfolio before change:  [14.21078217]
curr_Stock_Price:  108.48907815941662
curr_Factors:  [1.08489078e+02 4.31077701e-02]
mat_Sqrt:  [[ 2.25249480e+01  0.00000000e+00]
 [-8.30496431e-03  1.90290638e-02]]
grads:  [-0.00524971  1.6470567 ]
Stock Position:  -0.0052497105145211265
Bond Position:  [14.78031842]


portfolio before change:  [14.2113345]
curr_Stock_Price:  109.08781790466266
curr_Factors:  [1.09087818e+02 4.25998554e-02]
mat_Sqrt:  [[ 2.25154337e+01  0.00000000e+00]
 [-8.25589296e-03  1.89166272e-02]]
grads:  [2.67404213e-02 2.91406970e+01]
Stock Position:  0.026740421266207275
Bond Position:  [11.2942803]


portfolio before change:  [14.19033859]
curr_Stock_Price:  108.19703772743914
curr_Factors:  [1.08197038e+02 4.18658803e-02]
mat_Sqrt:  [[ 2.21383620e+01  0.00000000e+00]
 [-8.18446140e-03  1.87529569e-02]]
grads:  [-0.00853758  6.09680512]
Stock Position:  -0.008537576722377857
Bond Position:  [15.1140791]


portfolio before change:  [14.19010246]
curr_Stock_Price:  108.66732587205
curr_Factors:  [1.08667326e+02 4.25394997e-02]
mat_Sqrt:  [[ 2.24127511e+01  0.00000000e+00]
 [-8.25004240e-03  1.89032219e-02]]
grads:  [-3.12757852e-03  7.86631261e+00]
Stock Position:  -0.0031275785177026626
Bond Position:  [14.52996805]


portfolio before change:  [14.19855176]
curr_Stock_Price:  107.12736279647301
curr_Factors:  [1.07127363e+02 4.43978597e-02]
mat_Sqrt:  [[ 2.25725920e+01  0.00000000e+00]
 [-8.42831985e-03  1.93117069e-02]]
grads:  [-0.01243106 -3.65923131]
Stock Position:  -0.012431062779218493
Bond Position:  [15.53025873]


portfolio before change:  [14.20457241]
curr_Stock_Price:  106.95540662973288
curr_Factors:  [1.06955407e+02 4.83237812e-02]
mat_Sqrt:  [[ 2.35116549e+01  0.00000000e+00]
 [-8.79306829e-03  2.01474505e-02]]
grads:  [ 0.01318346 10.29244793]
Stock Position:  0.013183461876195965
Bond Position:  [12.79452988]


portfolio before change:  [14.17296937]
curr_Stock_Price:  104.31557859416256
curr_Factors:  [1.04315579e+02 4.83512072e-02]
mat_Sqrt:  [[ 2.29378565e+01  0.00000000e+00]
 [-8.79556317e-03  2.01531670e-02]]
grads:  [0.00418504 0.86989086]
Stock Position:  0.0041850436225835804
Bond Position:  [13.73640412]


portfolio before change:  [14.17291861]
curr_Stock_Price:  103.48278207492544
curr_Factors:  [1.03482782e+02 5.00972827e-02]
mat_Sqrt:  [[ 2.31619533e+01  0.00000000e+00]
 [-8.95296891e-03  2.05138289e-02]]
grads:  [-1.15398479e-03  2.93922907e+00]
Stock Position:  -0.001153984788421176
Bond Position:  [14.29233616]


portfolio before change:  [14.17476124]
curr_Stock_Price:  104.98271001619504
curr_Factors:  [1.04982710e+02 5.08594618e-02]
mat_Sqrt:  [[ 2.36757453e+01  0.00000000e+00]
 [-9.02081697e-03  2.06692883e-02]]
grads:  [ 0.00709251 -5.57763739]
Stock Position:  0.00709250907442342
Bond Position:  [13.43017042]


portfolio before change:  [14.17219785]
curr_Stock_Price:  104.14783585172337
curr_Factors:  [1.04147836e+02 5.26020921e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.17219785]
Stock Price:  103.72070706559396
PL:  [10.45149079]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.10907477e-02  9.33824453e-03]
 [ 1.66607324e-01 -2.23526203e-02]
 [-1.03400155e-01 -1.66094026e-01]
 [ 3.71193071e-01 -3.27101408e-01]
 [-8.58508786e-02 -6.15206107e-02]
 [ 9.15710020e-01 -1.29404399e+00]
 [-6.29834920e-01  6.20117636e-01]
 [ 7.46584264e-01  1.91332686e-01]
 [ 2.88211061e-01 -2.01825904e-01]
 [-1.20178804e-02  2.48387296e-02]
 [ 3.00112788e-01  4.53256540e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.16104308e-01  1.34743006e-01]
 [-2.52409588e-01 -7.97407720e-02]
 [ 2.39516740e-01  2.69156078e-01]
 [ 5.39729812e-02  5.02564607e-02]
 [-5.32406307e-02  2.84062453e-01]
 [ 1.31755574e-01  1.58990239e-01]
 [-5.02689889e-02 -2.46717013e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.81911138]
curr_Stock_Price:  99.88475431168443
curr_Factors:  [9.98847543e+01 3.95062787e-02]
mat_Sqrt:  [[ 1.98532800e+01  0.00000000e+00]
 [-7.95047458e-03  1.82168258e-02]]
grads:  [-0.00337552  0.51261645]
Stock Position:  -0.0033755230190867986
Bond Position:  [2.15627466]


portfolio before change:  [1.80881357]
curr_Stock_Price:  103.09520156305618
curr_Factors:  [1.03095202e+02 3.68420820e-02]
mat_Sqrt:  [[ 1.97883933e+01  0.00000000e+00]
 [-7.67771653e-03  1.75918586e-02]]
grads:  [ 0.00792646 -1.27062301]
Stock Position:  0.007926456574182318
Bond Position:  [0.99163393]


portfolio before change:  [1.81617297]
curr_Stock_Price:  103.99238091373147
curr_Factors:  [1.03992381e+02 3.58064858e-02]
mat_Sqrt:  [[ 1.96780641e+01  0.00000000e+00]
 [-7.56904071e-03  1.73428510e-02]]
grads:  [-8.93835539e-03 -9.57708891e+00]
Stock Position:  -0.008938355386014058
Bond Position:  [2.74569382]


portfolio before change:  [1.80378069]
curr_Stock_Price:  105.45560094026278
curr_Factors:  [1.05455601e+02 3.47662439e-02]
mat_Sqrt:  [[ 1.96629438e+01  0.00000000e+00]
 [-7.45828333e-03  1.70890740e-02]]
grads:  [ 1.16175032e-02 -1.91409674e+01]
Stock Position:  0.011617503224512913
Bond Position:  [0.57864991]


portfolio before change:  [1.80864994]
curr_Stock_Price:  105.86227778976311
curr_Factors:  [1.05862278e+02 3.44855116e-02]
mat_Sqrt:  [[ 1.96589162e+01  0.00000000e+00]
 [-7.42811002e-03  1.70199382e-02]]
grads:  [-0.0057328  -3.61462009]
Stock Position:  -0.00573280201950456
Bond Position:  [2.41553742]


portfolio before change:  [1.80402571]
curr_Stock_Price:  106.7742573647235
curr_Factors:  [1.06774257e+02 3.42524934e-02]
mat_Sqrt:  [[ 1.97611700e+01  0.00000000e+00]
 [-7.40297166e-03  1.69623390e-02]]
grads:  [ 1.77592176e-02 -7.62892426e+01]
Stock Position:  0.01775921763804801
Bond Position:  [-0.09220157]


portfolio before change:  [1.79032484]
curr_Stock_Price:  106.00407638410006
curr_Factors:  [1.06004076e+02 3.62151866e-02]
mat_Sqrt:  [[ 2.01728811e+01  0.00000000e+00]
 [-7.61211525e-03  1.74415472e-02]]
grads:  [-1.78057558e-02  3.55540498e+01]
Stock Position:  -0.017805755818053364
Bond Position:  [3.67780754]


portfolio before change:  [1.7815478]
curr_Stock_Price:  106.54865332764928
curr_Factors:  [1.06548653e+02 3.58738136e-02]
mat_Sqrt:  [[ 2.01807238e+01  0.00000000e+00]
 [-7.57615350e-03  1.73591484e-02]]
grads:  [ 0.04113275 11.02200877]
Stock Position:  0.04113275133494381
Bond Position:  [-2.60109146]


portfolio before change:  [1.82695896]
curr_Stock_Price:  107.66847898330406
curr_Factors:  [1.07668479e+02 3.29699115e-02]
mat_Sqrt:  [[ 1.95500318e+01  0.00000000e+00]
 [-7.26304746e-03  1.66417324e-02]]
grads:  [ 1.02366593e-02 -1.21276980e+01]
Stock Position:  0.010236659327952459
Bond Position:  [0.72479342]


portfolio before change:  [1.81419693]
curr_Stock_Price:  106.40407741960526
curr_Factors:  [1.06404077e+02 3.27040155e-02]
mat_Sqrt:  [[ 1.92423810e+01  0.00000000e+00]
 [-7.23370063e-03  1.65744903e-02]]
grads:  [-6.11862962e-05  1.49861197e+00]
Stock Position:  -6.118629623542552e-05
Bond Position:  [1.8207074]


portfolio before change:  [1.81461193]
curr_Stock_Price:  107.06173593420678
curr_Factors:  [1.07061736e+02 3.21608683e-02]
mat_Sqrt:  [[ 1.91998645e+01  0.00000000e+00]
 [-7.17338060e-03  1.64362798e-02]]
grads:  [2.59340456e-02 2.75765895e+01]
Stock Position:  0.02593404556429331
Bond Position:  [-0.96193201]


portfolio before change:  [1.79802963]
curr_Stock_Price:  106.43160735629446
curr_Factors:  [1.06431607e+02 3.24948626e-02]
mat_Sqrt:  [[ 1.91857143e+01  0.00000000e+00]
 [-7.21053258e-03  1.65214057e-02]]
grads:  [-0.00985149  6.92030244]
Stock Position:  -0.009851494755097416
Bond Position:  [2.84654005]


portfolio before change:  [1.78568463]
curr_Stock_Price:  107.75696215895773
curr_Factors:  [1.07756962e+02 3.29268336e-02]
mat_Sqrt:  [[ 1.95533117e+01  0.00000000e+00]
 [-7.25830103e-03  1.66308569e-02]]
grads:  [-2.93032912e-03  8.10198815e+00]
Stock Position:  -0.0029303291203993977
Bond Position:  [2.10144799]


portfolio before change:  [1.78843901]
curr_Stock_Price:  106.9963133234641
curr_Factors:  [1.06996313e+02 3.32407580e-02]
mat_Sqrt:  [[ 1.95076194e+01  0.00000000e+00]
 [-7.29281926e-03  1.67099482e-02]]
grads:  [-0.01472303 -4.77205383]
Stock Position:  -0.014723032478614166
Bond Position:  [3.3637492]


portfolio before change:  [1.77148259]
curr_Stock_Price:  108.20513089525156
curr_Factors:  [1.08205131e+02 3.24283854e-02]
mat_Sqrt:  [[ 1.94854535e+01  0.00000000e+00]
 [-7.20315325e-03  1.65044975e-02]]
grads:  [ 0.01832065 16.3080444 ]
Stock Position:  0.018320645365417026
Bond Position:  [-0.21090524]


portfolio before change:  [1.80039965]
curr_Stock_Price:  109.78639574691366
curr_Factors:  [1.09786396e+02 3.30259270e-02]
mat_Sqrt:  [[ 1.99515222e+01  0.00000000e+00]
 [-7.26921475e-03  1.66558634e-02]]
grads:  [0.00380456 3.01734347]
Stock Position:  0.003804556768977565
Bond Position:  [1.38271107]


portfolio before change:  [1.79781591]
curr_Stock_Price:  109.01640792729603
curr_Factors:  [1.09016408e+02 3.28120646e-02]
mat_Sqrt:  [[ 1.97473420e+01  0.00000000e+00]
 [-7.24564030e-03  1.66018476e-02]]
grads:  [3.58197006e-03 1.71102916e+01]
Stock Position:  0.0035819700592471223
Bond Position:  [1.4073224]


portfolio before change:  [1.80009034]
curr_Stock_Price:  109.553139348606
curr_Factors:  [1.09553139e+02 3.10638079e-02]
mat_Sqrt:  [[ 1.93086617e+01  0.00000000e+00]
 [-7.04997111e-03  1.61535131e-02]]
grads:  [0.01041732 9.8424558 ]
Stock Position:  0.010417324957308283
Bond Position:  [0.65883969]


portfolio before change:  [1.80208201]
curr_Stock_Price:  109.72851477002949
curr_Factors:  [1.09728515e+02 3.18055933e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.80208201]
Stock Price:  109.89007795958955
PL:  [-8.08799595]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 4.22358382e-02  2.94502962e-01]
 [-1.39070553e-01 -6.09531259e-02]
 [-1.47890989e-01 -4.69648654e-01]
 [ 3.58327936e-02  2.14730524e-01]
 [-4.44334548e-01 -1.04887983e-01]
 [-3.75530867e-02  1.04955410e-01]
 [-5.08927762e-01  2.30622535e-01]
 [ 1.42021395e-01  1.43844802e-01]
 [-1.95513282e-01 -4.87520309e-02]
 [ 2.25108199e-01  6.66218513e-03]
 [-1.75965015e-02  6.03121494e-02]
 [-2.35993209e-01  5.75341290e-02]
 [-4.56709362e-02  3.62371420e-02]
 [-1.75765181e-01 -2.55323556e-01]
 [ 9.64571474e-03 -7.80425304e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.21401794e-02  3.15672237e-02]
 [ 3.03377991e-01 -2.08146391e-01]
 [ 7.90265414e-02 -1.37056459e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.18077872]
curr_Stock_Price:  101.82424428696923
curr_Factors:  [1.01824244e+02 4.00382192e-02]
mat_Sqrt:  [[ 2.03745756e+01  0.00000000e+00]
 [-8.00382101e-03  1.83390578e-02]]
grads:  [8.38139999e-03 1.60587837e+01]
Stock Position:  0.008381399994631377
Bond Position:  [14.327349]


portfolio before change:  [15.17890969]
curr_Stock_Price:  101.17383827758167
curr_Factors:  [1.01173838e+02 4.13340000e-02]
mat_Sqrt:  [[ 2.05694152e+01  0.00000000e+00]
 [-8.13230595e-03  1.86334538e-02]]
grads:  [-0.00805432 -3.27116629]
Stock Position:  -0.00805432127137116
Bond Position:  [15.99379629]


portfolio before change:  [15.18014667]
curr_Stock_Price:  101.51675556939915
curr_Factors:  [1.01516756e+02 4.27693201e-02]
mat_Sqrt:  [[ 2.09944210e+01  0.00000000e+00]
 [-8.27229788e-03  1.89542156e-02]]
grads:  [-1.68074397e-02 -2.47780580e+01]
Stock Position:  -0.01680743967997044
Bond Position:  [16.88638342]


portfolio before change:  [15.21329153]
curr_Stock_Price:  99.79592651372475
curr_Factors:  [9.97959265e+01 4.51884079e-02]
mat_Sqrt:  [[ 2.12141842e+01  0.00000000e+00]
 [-8.50302609e-03  1.94828803e-02]]
grads:  [6.10671032e-03 1.10214979e+01]
Stock Position:  0.0061067103221593404
Bond Position:  [14.60386671]


portfolio before change:  [15.20967677]
curr_Stock_Price:  98.60605804212304
curr_Factors:  [9.86060580e+01 4.39633402e-02]
mat_Sqrt:  [[ 2.06751628e+01  0.00000000e+00]
 [-8.38697468e-03  1.92169732e-02]]
grads:  [-0.02370532 -5.45809075]
Stock Position:  -0.023705323239995225
Bond Position:  [17.54716525]


portfolio before change:  [15.25063603]
curr_Stock_Price:  97.0632855290146
curr_Factors:  [9.70632855e+01 4.37659866e-02]
mat_Sqrt:  [[ 2.03059517e+01  0.00000000e+00]
 [-8.36812874e-03  1.91737917e-02]]
grads:  [4.06442893e-04 5.47389959e+00]
Stock Position:  0.0004064428934220996
Bond Position:  [15.21118535]


portfolio before change:  [15.25565087]
curr_Stock_Price:  100.04419222726366
curr_Factors:  [1.00044192e+02 4.32757034e-02]
mat_Sqrt:  [[ 2.08120064e+01  0.00000000e+00]
 [-8.32112525e-03  1.90660932e-02]]
grads:  [-0.01961732 12.09595134]
Stock Position:  -0.019617322292182392
Bond Position:  [17.21825003]


portfolio before change:  [15.25099189]
curr_Stock_Price:  100.50113935335328
curr_Factors:  [1.00501139e+02 4.23414701e-02]
mat_Sqrt:  [[ 2.06801627e+01  0.00000000e+00]
 [-8.23081723e-03  1.88591715e-02]]
grads:  [0.00990323 7.62731293]
Stock Position:  0.009903230281311612
Bond Position:  [14.25570596]


portfolio before change:  [15.23795762]
curr_Stock_Price:  98.82505547658775
curr_Factors:  [9.88250555e+01 4.39217215e-02]
mat_Sqrt:  [[ 2.07112706e+01  0.00000000e+00]
 [-8.38300390e-03  1.92078750e-02]]
grads:  [-0.01046727 -2.53812725]
Stock Position:  -0.010467267631460627
Bond Position:  [16.27238592]


portfolio before change:  [15.25263739]
curr_Stock_Price:  97.8113076364733
curr_Factors:  [9.78113076e+01 4.26931011e-02]
mat_Sqrt:  [[ 2.02100746e+01  0.00000000e+00]
 [-8.26492358e-03  1.89373190e-02]]
grads:  [0.01128228 0.35180192]
Stock Position:  0.011282284691596504
Bond Position:  [14.14910237]


portfolio before change:  [15.26221669]
curr_Stock_Price:  98.34680016038355
curr_Factors:  [9.83468002e+01 4.34532530e-02]
mat_Sqrt:  [[ 2.05008270e+01  0.00000000e+00]
 [-8.33817755e-03  1.91051649e-02]]
grads:  [4.25635437e-04 3.15685050e+00]
Stock Position:  0.0004256354370783653
Bond Position:  [15.22035681]


portfolio before change:  [15.26626592]
curr_Stock_Price:  98.91928255069878
curr_Factors:  [9.89192826e+01 4.38596595e-02]
mat_Sqrt:  [[ 2.07163665e+01  0.00000000e+00]
 [-8.37707916e-03  1.91942997e-02]]
grads:  [-0.01017955  2.99745914]
Stock Position:  -0.010179548457678942
Bond Position:  [16.27321955]


portfolio before change:  [15.26475294]
curr_Stock_Price:  99.46761735878121
curr_Factors:  [9.94676174e+01 4.38088954e-02]
mat_Sqrt:  [[ 2.08191439e+01  0.00000000e+00]
 [-8.37222985e-03  1.91831885e-02]]
grads:  [-1.43405276e-03  1.88900515e+00]
Stock Position:  -0.0014340527636829544
Bond Position:  [15.40739475]


portfolio before change:  [15.26951122]
curr_Stock_Price:  98.83587315528906
curr_Factors:  [9.88358732e+01 4.20042162e-02]
mat_Sqrt:  [[ 2.02563432e+01  0.00000000e+00]
 [-8.19797206e-03  1.87839138e-02]]
grads:  [ -0.01417815 -13.59267078]
Stock Position:  -0.01417815218786214
Bond Position:  [16.67082127]


portfolio before change:  [15.2393805]
curr_Stock_Price:  101.25501427988233
curr_Factors:  [1.01255014e+02 3.98426311e-02]
mat_Sqrt:  [[ 2.02111276e+01  0.00000000e+00]
 [-7.98424760e-03  1.82942095e-02]]
grads:  [-1.20798989e-03 -4.26596899e+00]
Stock Position:  -0.0012079898937860506
Bond Position:  [15.36169553]


portfolio before change:  [15.24173973]
curr_Stock_Price:  102.48156807588119
curr_Factors:  [1.02481568e+02 3.70651318e-02]
mat_Sqrt:  [[ 1.97300659e+01  0.00000000e+00]
 [-7.70092273e-03  1.76450307e-02]]
grads:  [0.00486546 0.99354068]
Stock Position:  0.0048654642403615535
Bond Position:  [14.74311933]


portfolio before change:  [15.24680891]
curr_Stock_Price:  102.7658026608995
curr_Factors:  [1.02765803e+02 3.71073126e-02]
mat_Sqrt:  [[ 1.97960422e+01  0.00000000e+00]
 [-7.70530337e-03  1.76550680e-02]]
grads:  [-0.00193792  1.78799786]
Stock Position:  -0.0019379183582688014
Bond Position:  [15.44596064]


portfolio before change:  [15.2496513]
curr_Stock_Price:  103.29192451133186
curr_Factors:  [1.03291925e+02 3.80287273e-02]
mat_Sqrt:  [[ 2.01429124e+01  0.00000000e+00]
 [-7.80038228e-03  1.78729211e-02]]
grads:  [ 1.05513768e-02 -1.16459078e+01]
Stock Position:  0.010551376754591037
Bond Position:  [14.15977929]


portfolio before change:  [15.27802724]
curr_Stock_Price:  105.64569847001565
curr_Factors:  [1.05645698e+02 3.86725736e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.27802724]
Stock Price:  101.79081627544689
PL:  [13.48721097]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.60637024e-01 -5.56613038e-01]
 [ 2.08677166e-01 -5.49657146e-02]
 [-1.83475228e-01 -8.64454114e-02]
 [ 5.57166737e-01 -7.38386022e-01]
 [-6.25154569e-01  5.90266186e-01]
 [ 9.37192837e-01  2.06304823e-01]
 [ 2.76055516e-01 -2.00171050e-01]
 [-1.93040956e-01  3.46197922e-02]
 [ 3.75070205e-01  5.72924727e-01]
 [-2.36952366e-01  1.15257493e-01]
 [-1.38527918e-01  1.51308578e-01]
 [-1.80846219e-01  1.65374513e-01]
 [ 2.52893180e-01  3.19523999e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.41926130e-02  3.47697513e-01]
 [ 1.54087498e-01  1.77470363e-01]
 [-2.87009219e-02 -2.57831171e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.29417785]
curr_Stock_Price:  98.8522369778328
curr_Factors:  [9.88522370e+01 4.02041906e-02]
mat_Sqrt:  [[ 1.98208449e+01  0.00000000e+00]
 [-8.02039307e-03  1.83770292e-02]]
grads:  [ 0.00140618 -0.07350667]
Stock Position:  0.0014061750517146076
Bond Position:  [-5.4331814]


portfolio before change:  [-5.29471847]
curr_Stock_Price:  99.43384231477658
curr_Factors:  [9.94338423e+01 4.01083671e-02]
mat_Sqrt:  [[ 1.99136886e+01  0.00000000e+00]
 [-8.01082938e-03  1.83551160e-02]]
grads:  [-0.00935662 -3.63124756]
Stock Position:  -0.009356622652764369
Bond Position:  [-4.36435353]


portfolio before change:  [-5.30837586]
curr_Stock_Price:  100.77686518058391
curr_Factors:  [1.00776865e+02 3.93337335e-02]
mat_Sqrt:  [[ 1.99868075e+01  0.00000000e+00]
 [-7.93309358e-03  1.81770009e-02]]
grads:  [-2.01914622e-02 -3.06218304e+01]
Stock Position:  -0.02019146223645815
Bond Position:  [-3.27354359]


portfolio before change:  [-5.33418489]
curr_Stock_Price:  102.01454417833857
curr_Factors:  [1.02014544e+02 4.02608697e-02]
mat_Sqrt:  [[ 2.04693320e+01  0.00000000e+00]
 [-8.02604458e-03  1.83899784e-02]]
grads:  [ 0.00902268 -2.98889501]
Stock Position:  0.009022676534570194
Bond Position:  [-6.25462913]


portfolio before change:  [-5.33502937]
curr_Stock_Price:  102.09427418581386
curr_Factors:  [1.02094274e+02 4.09258198e-02]
mat_Sqrt:  [[ 2.06538054e+01  0.00000000e+00]
 [-8.09205238e-03  1.85412213e-02]]
grads:  [-0.01071004 -4.66233643]
Stock Position:  -0.010710040803517902
Bond Position:  [-4.24159553]


portfolio before change:  [-5.34238348]
curr_Stock_Price:  102.68190747705425
curr_Factors:  [1.02681907e+02 4.14876025e-02]
mat_Sqrt:  [[ 2.09147702e+01  0.00000000e+00]
 [-8.14740229e-03  1.86680439e-02]]
grads:  [ 1.12317111e-02 -3.95534758e+01]
Stock Position:  0.011231711127701985
Bond Position:  [-6.495677]


portfolio before change:  [-5.31198343]
curr_Stock_Price:  105.53313540642606
curr_Factors:  [1.05533135e+02 3.87952987e-02]
mat_Sqrt:  [[ 2.07863574e+01  0.00000000e+00]
 [-7.87860888e-03  1.80521608e-02]]
grads:  [-1.76818515e-02  3.26978135e+01]
Stock Position:  -0.017681851495813035
Bond Position:  [-3.4459622]


portfolio before change:  [-5.36456085]
curr_Stock_Price:  108.4579322418859
curr_Factors:  [1.08457932e+02 3.57922297e-02]
mat_Sqrt:  [[ 2.05189767e+01  0.00000000e+00]
 [-7.56753378e-03  1.73393982e-02]]
grads:  [ 0.05006252 11.89803824]
Stock Position:  0.05006251824280777
Bond Position:  [-10.79423806]


portfolio before change:  [-5.4177382]
curr_Stock_Price:  107.44962402718797
curr_Factors:  [1.07449624e+02 3.81897907e-02]
mat_Sqrt:  [[ 2.09980294e+01  0.00000000e+00]
 [-7.81688334e-03  1.79107298e-02]]
grads:  [ 8.98625791e-03 -1.11760409e+01]
Stock Position:  0.008986257905735543
Bond Position:  [-6.38330823]


portfolio before change:  [-5.39967411]
curr_Stock_Price:  109.63742122327365
curr_Factors:  [1.09637421e+02 3.72174708e-02]
mat_Sqrt:  [[ 2.11510650e+01  0.00000000e+00]
 [-7.71673203e-03  1.76812543e-02]]
grads:  [-0.00841242  1.95799413]
Stock Position:  -0.008412419897134189
Bond Position:  [-4.47735809]


portfolio before change:  [-5.39954341]
curr_Stock_Price:  109.48880925447592
curr_Factors:  [1.09488809e+02 3.69027223e-02]
mat_Sqrt:  [[ 2.10328893e+01  0.00000000e+00]
 [-7.68403251e-03  1.76063303e-02]]
grads:  [2.97208362e-02 3.25408371e+01]
Stock Position:  0.02972083615491998
Bond Position:  [-8.65364237]


portfolio before change:  [-5.39303021]
curr_Stock_Price:  109.78075533770304
curr_Factors:  [1.09780755e+02 3.90669384e-02]
mat_Sqrt:  [[ 2.16985595e+01  0.00000000e+00]
 [-7.90614327e-03  1.81152500e-02]]
grads:  [-0.00860195  6.36245666]
Stock Position:  -0.008601947600908417
Bond Position:  [-4.4487019]


portfolio before change:  [-5.38599442]
curr_Stock_Price:  108.83351639596079
curr_Factors:  [1.08833516e+02 4.10467087e-02]
mat_Sqrt:  [[ 2.20496567e+01  0.00000000e+00]
 [-8.10399494e-03  1.85685851e-02]]
grads:  [-3.28764486e-03  8.14863260e+00]
Stock Position:  -0.0032876448613817777
Bond Position:  [-5.02818847]


portfolio before change:  [-5.39301395]
curr_Stock_Price:  110.58623713444995
curr_Factors:  [1.10586237e+02 4.13415642e-02]
mat_Sqrt:  [[ 2.24850850e+01  0.00000000e+00]
 [-8.13305003e-03  1.86351587e-02]]
grads:  [-4.83301996e-03  8.87432812e+00]
Stock Position:  -0.004833019963408476
Bond Position:  [-4.85854846]


portfolio before change:  [-5.38742268]
curr_Stock_Price:  109.17799715361276
curr_Factors:  [1.09177997e+02 4.10551118e-02]
mat_Sqrt:  [[ 2.21217124e+01  0.00000000e+00]
 [-8.10482442e-03  1.85704857e-02]]
grads:  [ 0.01773574 17.20601195]
Stock Position:  0.017735737568943907
Bond Position:  [-7.32377499]


portfolio before change:  [-5.40770829]
curr_Stock_Price:  108.13747493635034
curr_Factors:  [1.08137475e+02 4.35184164e-02]
mat_Sqrt:  [[ 2.25586323e+01  0.00000000e+00]
 [-8.34442726e-03  1.91194848e-02]]
grads:  [0.0042554  0.91692093]
Stock Position:  0.004255396727875296
Bond Position:  [-5.86787614]


portfolio before change:  [-5.3987102]
curr_Stock_Price:  110.59676016046748
curr_Factors:  [1.10596760e+02 4.34177769e-02]
mat_Sqrt:  [[ 2.30449726e+01  0.00000000e+00]
 [-8.33477312e-03  1.90973644e-02]]
grads:  [4.23324532e-03 1.82065706e+01]
Stock Position:  0.004233245319947045
Bond Position:  [-5.86689342]


portfolio before change:  [-5.39939525]
curr_Stock_Price:  110.78145620412052
curr_Factors:  [1.10781456e+02 4.31745292e-02]
mat_Sqrt:  [[ 2.30187044e+01  0.00000000e+00]
 [-8.31139259e-03  1.90437928e-02]]
grads:  [0.01005886 9.31906601]
Stock Position:  0.010058859534143191
Bond Position:  [-6.51373035]


portfolio before change:  [-5.396033]
curr_Stock_Price:  111.27762428385664
curr_Factors:  [1.11277624e+02 4.44607349e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.396033]
Stock Price:  110.73134309885982
PL:  [-16.1273761]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.84977596e-02  2.58830392e-01]
 [-1.13766495e-01 -5.30145744e-02]
 [-1.55650031e-01 -5.22587497e-01]
 [ 7.11269146e-02  1.60171567e-01]
 [-4.06014592e-01 -1.15949157e-01]
 [ 4.11228645e-01 -5.11983997e-01]
 [-5.19987024e-01  2.66683544e-01]
 [ 2.12785365e-01  1.49403250e-01]
 [-6.75715392e-02 -3.45300712e-02]
 [ 3.96660621e-02  2.20357023e-02]
 [ 2.42485841e-01  3.61256141e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-6.09497290e-02  9.39972402e-02]
 [-2.78181007e-01 -1.68011754e-01]
 [ 1.79904036e-01  8.53274689e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.21444704e-02  5.85373897e-02]
 [ 3.20230161e-01 -2.13042624e-01]
 [ 1.33426891e-01  3.22210723e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.47632201]
curr_Stock_Price:  101.5768367882365
curr_Factors:  [1.01576837e+02 3.84499441e-02]
mat_Sqrt:  [[ 1.99178538e+01  0.00000000e+00]
 [-7.84346292e-03  1.79716313e-02]]
grads:  [6.60013899e-03 1.44021646e+01]
Stock Position:  0.006600138992269174
Bond Position:  [12.80590077]


portfolio before change:  [13.47879006]
curr_Stock_Price:  101.46565320048748
curr_Factors:  [1.01465653e+02 3.93767952e-02]
mat_Sqrt:  [[ 2.01344254e+01  0.00000000e+00]
 [-7.93743487e-03  1.81869481e-02]]
grads:  [-0.0067995  -2.91497915]
Stock Position:  -0.006799496356750809
Bond Position:  [14.1687054]


portfolio before change:  [13.4851707]
curr_Stock_Price:  101.0482667570069
curr_Factors:  [1.01048267e+02 3.74741392e-02]
mat_Sqrt:  [[ 1.95611643e+01  0.00000000e+00]
 [-7.74329534e-03  1.77421185e-02]]
grads:  [-1.96167215e-02 -2.94546278e+01]
Stock Position:  -0.0196167215214425
Bond Position:  [15.4674064]


portfolio before change:  [13.50542681]
curr_Stock_Price:  100.21281729271698
curr_Factors:  [1.00212817e+02 3.91120176e-02]
mat_Sqrt:  [[ 1.98188468e+01  0.00000000e+00]
 [-7.91070339e-03  1.81256985e-02]]
grads:  [7.11603045e-03 8.83671141e+00]
Stock Position:  0.007116030446979871
Bond Position:  [12.79230935]


portfolio before change:  [13.50523363]
curr_Stock_Price:  99.73619464791012
curr_Factors:  [9.97361946e+01 4.02510665e-02]
mat_Sqrt:  [[ 2.00097420e+01  0.00000000e+00]
 [-8.02506737e-03  1.83877393e-02]]
grads:  [-0.02281983 -6.30578639]
Stock Position:  -0.02281983205519955
Bond Position:  [15.78119684]


portfolio before change:  [13.48191141]
curr_Stock_Price:  100.93112061870364
curr_Factors:  [1.00931121e+02 3.98676955e-02]
mat_Sqrt:  [[ 2.01528124e+01  0.00000000e+00]
 [-7.98675860e-03  1.82999629e-02]]
grads:  [ 9.31783151e-03 -2.79773243e+01]
Stock Position:  0.009317831510594675
Bond Position:  [12.54145223]


portfolio before change:  [13.48226353]
curr_Stock_Price:  100.63237848400246
curr_Factors:  [1.00632378e+02 4.05051555e-02]
mat_Sqrt:  [[ 2.02531645e+01  0.00000000e+00]
 [-8.05035706e-03  1.84456853e-02]]
grads:  [-0.01992759 14.45777369]
Stock Position:  -0.019927591264100226
Bond Position:  [15.48762444]


portfolio before change:  [13.47466575]
curr_Stock_Price:  101.20797111099124
curr_Factors:  [1.01207971e+02 4.08096214e-02]
mat_Sqrt:  [[ 2.04454184e+01  0.00000000e+00]
 [-8.08055656e-03  1.85148810e-02]]
grads:  [0.0135967  8.06936053]
Stock Position:  0.01359670338131954
Bond Position:  [12.09857099]


portfolio before change:  [13.49788559]
curr_Stock_Price:  102.69324400843595
curr_Factors:  [1.02693244e+02 3.89778516e-02]
mat_Sqrt:  [[ 2.02745312e+01  0.00000000e+00]
 [-7.89712369e-03  1.80945835e-02]]
grads:  [-0.00407613 -1.9083098 ]
Stock Position:  -0.004076133586201006
Bond Position:  [13.91647697]


portfolio before change:  [13.48983638]
curr_Stock_Price:  105.52159950512865
curr_Factors:  [1.05521600e+02 3.82329634e-02]
mat_Sqrt:  [[ 2.06329035e+01  0.00000000e+00]
 [-7.82130049e-03  1.79208508e-02]]
grads:  [0.00238857 1.22961251]
Stock Position:  0.0023885746929791984
Bond Position:  [13.23779016]


portfolio before change:  [13.49248724]
curr_Stock_Price:  105.2456992813126
curr_Factors:  [1.05245699e+02 3.69588615e-02]
mat_Sqrt:  [[ 2.02331569e+01  0.00000000e+00]
 [-7.68987505e-03  1.76197173e-02]]
grads:  [1.97769902e-02 2.05029476e+01]
Stock Position:  0.019776990224423967
Bond Position:  [11.41104407]


portfolio before change:  [13.52214654]
curr_Stock_Price:  106.601122219868
curr_Factors:  [1.06601122e+02 3.51805500e-02]
mat_Sqrt:  [[ 1.99946170e+01  0.00000000e+00]
 [-7.50259155e-03  1.71905968e-02]]
grads:  [-0.00945294  6.65091067]
Stock Position:  -0.009452942468445873
Bond Position:  [14.52984082]


portfolio before change:  [13.53961906]
curr_Stock_Price:  105.13706929055141
curr_Factors:  [1.05137069e+02 3.56947242e-02]
mat_Sqrt:  [[ 1.98635964e+01  0.00000000e+00]
 [-7.55721898e-03  1.73157640e-02]]
grads:  [-1.00314010e-03  5.42842003e+00]
Stock Position:  -0.0010031401027870061
Bond Position:  [13.64508627]


portfolio before change:  [13.54246318]
curr_Stock_Price:  105.70287273101765
curr_Factors:  [1.05702873e+02 3.40408849e-02]
mat_Sqrt:  [[ 1.95023619e+01  0.00000000e+00]
 [-7.38006883e-03  1.69098620e-02]]
grads:  [-0.01802383 -9.9357259 ]
Stock Position:  -0.018023834738932994
Bond Position:  [15.44763429]


portfolio before change:  [13.56794322]
curr_Stock_Price:  104.50348055757769
curr_Factors:  [1.04503481e+02 3.60506445e-02]
mat_Sqrt:  [[ 1.98420834e+01  0.00000000e+00]
 [-7.59480291e-03  1.74018796e-02]]
grads:  [0.01094361 4.90334784]
Stock Position:  0.010943608652652623
Bond Position:  [12.42429803]


portfolio before change:  [13.56795869]
curr_Stock_Price:  104.221033138097
curr_Factors:  [1.04221033e+02 3.58049005e-02]
mat_Sqrt:  [[ 1.97208945e+01  0.00000000e+00]
 [-7.56887315e-03  1.73424671e-02]]
grads:  [0.00486773 1.01087439]
Stock Position:  0.004867726982179923
Bond Position:  [13.06063915]


portfolio before change:  [13.56738643]
curr_Stock_Price:  103.43261143030033
curr_Factors:  [1.03432611e+02 3.46863958e-02]
mat_Sqrt:  [[ 1.92635834e+01  0.00000000e+00]
 [-7.44971364e-03  1.70694383e-02]]
grads:  [-1.38067038e-03  3.42936824e+00]
Stock Position:  -0.0013806703837701232
Bond Position:  [13.71019278]


portfolio before change:  [13.57136588]
curr_Stock_Price:  103.03319061714019
curr_Factors:  [1.03033191e+02 3.39571619e-02]
mat_Sqrt:  [[ 1.89864094e+01  0.00000000e+00]
 [-7.37098766e-03  1.68890544e-02]]
grads:  [ 1.19691266e-02 -1.26142422e+01]
Stock Position:  0.011969126552700634
Bond Position:  [12.33814858]


portfolio before change:  [13.58454968]
curr_Stock_Price:  103.87693438722337
curr_Factors:  [1.03876934e+02 3.31082646e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.58454968]
Stock Price:  103.81296899930669
PL:  [9.77158068]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.02435266e-01 -8.41796490e-01]
 [-3.16345614e-02  2.76315722e-01]
 [-4.13012832e-01 -6.97799228e-02]
 [ 1.03484642e-01  4.59561577e-02]
 [-3.50899910e-01  1.35300866e-01]
 [-3.02174310e-02  1.54132054e-01]
 [-2.16697523e-01  3.37864970e-02]
 [ 1.86853081e-01  9.05933175e-03]
 [-1.06004474e-01 -5.09235030e-02]
 [-1.34225689e-01  2.00797685e-02]
 [ 1.15881158e-01 -1.33062830e-02]
 [ 8.68474140e-02 -9.15980394e-03]
 [-2.49442398e-01 -1.21726605e-01]
 [ 8.75525893e-02  2.70967093e-02]
 [ 3.76108910e-02 -6.44453557e-02]
 [ 9.56226711e-01 -4.43898532e-01]
 [ 1.47658857e-01  1.71157603e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.18786102]
curr_Stock_Price:  97.85159618523545
curr_Factors:  [9.78515962e+01 4.06371339e-02]
mat_Sqrt:  [[ 1.97255649e+01  0.00000000e+00]
 [-8.06346168e-03  1.84757118e-02]]
grads:  [ 0.00141297 -0.07311406]
Stock Position:  0.0014129672711314027
Bond Position:  [-12.32612212]


portfolio before change:  [-12.18983873]
curr_Stock_Price:  98.63307658322312
curr_Factors:  [9.86330766e+01 3.88329213e-02]
mat_Sqrt:  [[ 1.94367036e+01  0.00000000e+00]
 [-7.88242819e-03  1.80609119e-02]]
grads:  [-0.00958624 -3.69039894]
Stock Position:  -0.009586238193245989
Bond Position:  [-11.24431856]


portfolio before change:  [-12.19164732]
curr_Stock_Price:  98.52846478110881
curr_Factors:  [9.85284648e+01 3.91838732e-02]
mat_Sqrt:  [[ 1.95036276e+01  0.00000000e+00]
 [-7.91796673e-03  1.81423409e-02]]
grads:  [-2.92163788e-02 -4.63995519e+01]
Stock Position:  -0.029216378834777297
Bond Position:  [-9.31300237]


portfolio before change:  [-12.17052952]
curr_Stock_Price:  97.72595805333582
curr_Factors:  [9.77259581e+01 4.05662684e-02]
mat_Sqrt:  [[ 1.96830532e+01  0.00000000e+00]
 [-8.05642783e-03  1.84595952e-02]]
grads:  [4.51959894e-03 1.49686772e+01]
Stock Position:  0.004519598936478927
Bond Position:  [-12.61221166]


portfolio before change:  [-12.17444753]
curr_Stock_Price:  97.55679181970136
curr_Factors:  [9.75567918e+01 4.16011007e-02]
mat_Sqrt:  [[ 1.98980226e+01  0.00000000e+00]
 [-8.15853915e-03  1.86935616e-02]]
grads:  [-0.022287   -3.73283188]
Stock Position:  -0.022287002816469812
Bond Position:  [-10.00019904]


portfolio before change:  [-12.13224971]
curr_Stock_Price:  95.55121971450274
curr_Factors:  [9.55512197e+01 4.16338217e-02]
mat_Sqrt:  [[ 1.94966221e+01  0.00000000e+00]
 [-8.16174704e-03  1.87009118e-02]]
grads:  [0.00633656 2.45742871]
Stock Position:  0.006336561913316661
Bond Position:  [-12.73771593]


portfolio before change:  [-12.12312528]
curr_Stock_Price:  97.49379559382103
curr_Factors:  [9.74937956e+01 4.09504967e-02]
mat_Sqrt:  [[ 1.97290678e+01  0.00000000e+00]
 [-8.09449163e-03  1.85468103e-02]]
grads:  [-0.01479288  7.29510164]
Stock Position:  -0.014792881928190239
Bond Position:  [-10.68091107]


portfolio before change:  [-12.09607516]
curr_Stock_Price:  95.48467510365185
curr_Factors:  [9.54846751e+01 4.01713548e-02]
mat_Sqrt:  [[ 1.91377957e+01  0.00000000e+00]
 [-8.01711716e-03  1.83695231e-02]]
grads:  [1.93602821e-03 8.39063992e+00]
Stock Position:  0.001936028208237619
Bond Position:  [-12.28093618]


portfolio before change:  [-12.09692732]
curr_Stock_Price:  96.63055730188137
curr_Factors:  [9.66305573e+01 4.04867751e-02]
mat_Sqrt:  [[ 1.94433492e+01  0.00000000e+00]
 [-8.04853031e-03  1.84414997e-02]]
grads:  [-0.01038668  1.83209053]
Stock Position:  -0.010386682084447896
Bond Position:  [-11.09325644]


portfolio before change:  [-12.09582548]
curr_Stock_Price:  96.25743524923848
curr_Factors:  [9.62574352e+01 4.11846654e-02]
mat_Sqrt:  [[ 1.95344891e+01  0.00000000e+00]
 [-8.11760215e-03  1.85997632e-02]]
grads:  [0.00976769 0.48706705]
Stock Position:  0.009767693276609776
Bond Position:  [-13.03603858]


portfolio before change:  [-12.11203659]
curr_Stock_Price:  94.9314621641488
curr_Factors:  [9.49314622e+01 4.27095429e-02]
mat_Sqrt:  [[ 1.96188087e+01  0.00000000e+00]
 [-8.26651490e-03  1.89409651e-02]]
grads:  [-0.00653604 -2.68853792]
Stock Position:  -0.0065360397110883145
Bond Position:  [-11.49156079]


portfolio before change:  [-12.11157106]
curr_Stock_Price:  94.42063616799801
curr_Factors:  [9.44206362e+01 4.34178146e-02]
mat_Sqrt:  [[ 1.96743731e+01  0.00000000e+00]
 [-8.33477674e-03  1.90973727e-02]]
grads:  [-0.00637693  1.05144141]
Stock Position:  -0.006376933048511121
Bond Position:  [-11.50945699]


portfolio before change:  [-12.11014579]
curr_Stock_Price:  93.74586144479214
curr_Factors:  [9.37458614e+01 4.61099702e-02]
mat_Sqrt:  [[ 2.01302665e+01  0.00000000e+00]
 [-8.58929289e-03  1.96805424e-02]]
grads:  [ 0.00546808 -0.67611363]
Stock Position:  0.005468075631593534
Bond Position:  [-12.62275525]


portfolio before change:  [-12.12032879]
curr_Stock_Price:  92.46078113055691
curr_Factors:  [9.24607811e+01 5.00816296e-02]
mat_Sqrt:  [[ 2.06917291e+01  0.00000000e+00]
 [-8.95157011e-03  2.05106238e-02]]
grads:  [ 0.004004   -0.44658827]
Stock Position:  0.004004003113290156
Bond Position:  [-12.49054205]


portfolio before change:  [-12.11784722]
curr_Stock_Price:  93.86053050195844
curr_Factors:  [9.38605305e+01 5.06817664e-02]
mat_Sqrt:  [[ 2.11304563e+01  0.00000000e+00]
 [-9.00504449e-03  2.06331490e-02]]
grads:  [-0.01431906 -5.89956504]
Stock Position:  -0.014319058639599777
Bond Position:  [-10.77385278]


portfolio before change:  [-12.12350286]
curr_Stock_Price:  94.06737624505445
curr_Factors:  [9.40673762e+01 4.88839893e-02]
mat_Sqrt:  [[ 2.07980372e+01  0.00000000e+00]
 [-8.84388958e-03  2.02638967e-02]]
grads:  [0.00477827 1.33719144]
Stock Position:  0.004778266421019876
Bond Position:  [-12.57298184]


portfolio before change:  [-12.13353016]
curr_Stock_Price:  92.62675583325384
curr_Factors:  [9.26267558e+01 4.91071993e-02]
mat_Sqrt:  [[ 2.05262227e+01  0.00000000e+00]
 [-8.86405770e-03  2.03101077e-02]]
grads:  [ 4.62073904e-04 -3.17306814e+00]
Stock Position:  0.00046207390433096045
Bond Position:  [-12.17633057]


portfolio before change:  [-12.13558163]
curr_Stock_Price:  94.77575483962099
curr_Factors:  [9.47757548e+01 4.80872812e-02]
mat_Sqrt:  [[ 2.07831974e+01  0.00000000e+00]
 [-8.77152495e-03  2.00980885e-02]]
grads:  [  0.03668798 -22.0866045 ]
Stock Position:  0.03668797885182444
Bond Position:  [-15.61271252]


portfolio before change:  [-12.15136691]
curr_Stock_Price:  94.45189894114567
curr_Factors:  [9.44518989e+01 4.85108089e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.15136691]
Stock Price:  94.46321029482183
PL:  [-12.15136691]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-6.26336251e-02  1.36909614e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.00314458e-01 -8.27326524e-01]
 [-3.55349106e-02  2.75906993e-01]
 [-4.24744739e-01 -4.94435392e-02]
 [ 1.72165152e-01 -3.89852366e-03]
 [-2.26299543e-01  6.69795283e-02]
 [-8.09489345e-02  1.11578520e-01]
 [-2.35079464e-01  1.07796556e-01]
 [ 1.06419603e-01  1.40994636e-02]
 [-1.06004474e-01 -5.09235030e-02]
 [-1.84236298e-01  4.98609515e-02]
 [-1.07992175e-01  3.16695073e-02]
 [-1.75838624e-01 -2.55342996e-01]
 [-9.02725685e-02 -1.20314966e-01]
 [ 8.83750337e-02  4.52682513e-02]
 [ 5.96474995e-02 -8.36798812e-02]
 [ 9.53233011e-01 -4.42291483e-01]
 [ 1.57033910e-01  1.49333048e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.67807032]
curr_Stock_Price:  100.73520147823429
curr_Factors:  [1.00735201e+02 4.11257870e-02]
mat_Sqrt:  [[ 2.04285890e+01  0.00000000e+00]
 [-8.11179753e-03  1.85864631e-02]]
grads:  [-1.41046013e-04  7.36609289e+00]
Stock Position:  -0.00014104601253733101
Bond Position:  [7.69227861]


portfolio before change:  [7.68010032]
curr_Stock_Price:  99.97873302111675
curr_Factors:  [9.99787330e+01 3.99216377e-02]
mat_Sqrt:  [[ 1.99761506e+01  0.00000000e+00]
 [-7.99215993e-03  1.83123389e-02]]
grads:  [-0.00932737 -3.63973005]
Stock Position:  -0.009327366117120518
Bond Position:  [8.61263857]


portfolio before change:  [7.69474684]
curr_Stock_Price:  98.63933129675873
curr_Factors:  [9.86393313e+01 3.92469206e-02]
mat_Sqrt:  [[ 1.95412757e+01  0.00000000e+00]
 [-7.92433423e-03  1.81569307e-02]]
grads:  [-2.87283882e-02 -4.55653291e+01]
Stock Position:  -0.028728388220379344
Bond Position:  [10.52849585]


portfolio before change:  [7.71167324]
curr_Stock_Price:  98.1417765575374
curr_Factors:  [9.81417766e+01 3.88949646e-02]
mat_Sqrt:  [[ 1.93553311e+01  0.00000000e+00]
 [-7.88872254e-03  1.80753341e-02]]
grads:  [4.38539505e-03 1.52642818e+01]
Stock Position:  0.004385395052887944
Bond Position:  [7.28128278]


portfolio before change:  [7.7050471]
curr_Stock_Price:  96.21568124498279
curr_Factors:  [9.62156812e+01 3.69002891e-02]
mat_Sqrt:  [[ 1.84825012e+01  0.00000000e+00]
 [-7.68377918e-03  1.76057499e-02]]
grads:  [-0.02414845 -2.80837452]
Stock Position:  -0.02414844524061809
Bond Position:  [10.02850621]


portfolio before change:  [7.73276838]
curr_Stock_Price:  95.17156262083013
curr_Factors:  [9.51715626e+01 3.76681480e-02]
mat_Sqrt:  [[ 1.84711670e+01  0.00000000e+00]
 [-7.76331352e-03  1.77879859e-02]]
grads:  [ 0.00922864 -0.21916611]
Stock Position:  0.009228637089233284
Bond Position:  [6.85446457]


portfolio before change:  [7.7296716]
curr_Stock_Price:  94.65029299052028
curr_Factors:  [9.46502930e+01 3.60789527e-02]
mat_Sqrt:  [[ 1.79783125e+01  0.00000000e+00]
 [-7.59778418e-03  1.74087105e-02]]
grads:  [-0.01096139  3.84747211]
Stock Position:  -0.010961389212951686
Bond Position:  [8.7671703]


portfolio before change:  [7.73084426]
curr_Stock_Price:  94.7432933768822
curr_Factors:  [9.47432934e+01 3.83926137e-02]
mat_Sqrt:  [[ 1.85640324e+01  0.00000000e+00]
 [-7.83761328e-03  1.79582281e-02]]
grads:  [-1.73734216e-03  6.21322548e+00]
Stock Position:  -0.0017373421562468028
Bond Position:  [7.89544577]


portfolio before change:  [7.73347092]
curr_Stock_Price:  94.36768921888334
curr_Factors:  [9.43676892e+01 3.99716826e-02]
mat_Sqrt:  [[ 1.88668560e+01  0.00000000e+00]
 [-7.99716776e-03  1.83238133e-02]]
grads:  [-0.00996632  5.88286697]
Stock Position:  -0.00996632347595437
Bond Position:  [8.67396983]


portfolio before change:  [7.7418893]
curr_Stock_Price:  93.74061545835542
curr_Factors:  [9.37406155e+01 4.02445011e-02]
mat_Sqrt:  [[ 1.88053350e+01  0.00000000e+00]
 [-8.02441286e-03  1.83862397e-02]]
grads:  [0.00598623 0.76684868]
Stock Position:  0.005986232827242742
Bond Position:  [7.18073615]


portfolio before change:  [7.74970759]
curr_Stock_Price:  94.74673801481481
curr_Factors:  [9.47467380e+01 3.78174325e-02]
mat_Sqrt:  [[ 1.84251184e+01  0.00000000e+00]
 [-7.77868189e-03  1.78231993e-02]]
grads:  [-0.00695948 -2.85714715]
Stock Position:  -0.006959483779963857
Bond Position:  [8.40909598]


portfolio before change:  [7.74124745]
curr_Stock_Price:  96.26447757587808
curr_Factors:  [9.62644776e+01 3.55290299e-02]
mat_Sqrt:  [[ 1.81450318e+01  0.00000000e+00]
 [-7.53965834e-03  1.72755275e-02]]
grads:  [-0.00895425  2.88621876]
Stock Position:  -0.008954252450486049
Bond Position:  [8.60322388]


portfolio before change:  [7.7314308]
curr_Stock_Price:  97.6010179292139
curr_Factors:  [9.76010179e+01 3.50210004e-02]
mat_Sqrt:  [[ 1.82649556e+01  0.00000000e+00]
 [-7.48555947e-03  1.71515715e-02]]
grads:  [-0.0051558   1.84644931]
Stock Position:  -0.005155800575773216
Bond Position:  [8.23464219]


portfolio before change:  [7.72707147]
curr_Stock_Price:  98.84587878485726
curr_Factors:  [9.88458788e+01 3.39361395e-02]
mat_Sqrt:  [[ 1.82091547e+01  0.00000000e+00]
 [-7.36870567e-03  1.68838257e-02]]
grads:  [ -0.01577665 -15.12352711]
Stock Position:  -0.015776649086211167
Bond Position:  [9.28652821]


portfolio before change:  [7.72291309]
curr_Stock_Price:  99.25663141284333
curr_Factors:  [9.92566314e+01 3.33787658e-02]
mat_Sqrt:  [[ 1.81340442e+01  0.00000000e+00]
 [-7.30794262e-03  1.67446001e-02]]
grads:  [-0.00787372 -7.18529945]
Stock Position:  -0.007873716595266467
Bond Position:  [8.50443167]


portfolio before change:  [7.75373679]
curr_Stock_Price:  95.61193175988434
curr_Factors:  [9.56119318e+01 3.58328038e-02]
mat_Sqrt:  [[ 1.80989128e+01  0.00000000e+00]
 [-7.57182184e-03  1.73492234e-02]]
grads:  [0.00597449 2.60923791]
Stock Position:  0.00597448693342764
Bond Position:  [7.18250456]


portfolio before change:  [7.7559079]
curr_Stock_Price:  95.67474115183806
curr_Factors:  [9.56747412e+01 3.53302490e-02]
mat_Sqrt:  [[ 1.79833520e+01  0.00000000e+00]
 [-7.51853699e-03  1.72271324e-02]]
grads:  [ 1.28600081e-03 -4.85744691e+00]
Stock Position:  0.0012860008116324971
Bond Position:  [7.6328701]


portfolio before change:  [7.75672944]
curr_Stock_Price:  94.82955351567895
curr_Factors:  [9.48295535e+01 3.58036774e-02]
mat_Sqrt:  [[ 1.79435150e+01  0.00000000e+00]
 [-7.56874387e-03  1.73421709e-02]]
grads:  [  0.04236635 -25.50381304]
Stock Position:  0.04236634684286818
Bond Position:  [3.73914769]


portfolio before change:  [7.81576289]
curr_Stock_Price:  96.20089064338389
curr_Factors:  [9.62008906e+01 3.60561598e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.81576289]
Stock Price:  94.7945614696882
PL:  [7.81576289]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-9.82708139e-02  4.88618341e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.70382798e-01 -6.23107069e-01]
 [ 1.90793491e-01 -2.50191911e-02]
 [-4.26160744e-01 -1.19283080e-01]
 [ 3.86669800e-01 -4.73679352e-01]
 [-4.64778874e-01  1.76480269e-01]
 [ 4.87902073e-02  1.36521574e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.78791585e-01  4.61905182e-03]
 [-5.86307013e-02  2.05123196e-02]
 [-1.68600517e-01  4.05211523e-02]
 [-8.39588742e-02  2.18308942e-02]
 [-7.88952674e-02 -2.10910665e-01]
 [-1.76802397e-01 -1.41599732e-01]
 [ 8.79575189e-02  4.08590133e-02]
 [ 4.13139281e-02 -6.69458473e-02]
 [ 1.12183018e+00 -5.12657167e-01]
 [ 1.43890341e-01  1.89870740e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.61747145]
curr_Stock_Price:  100.14579219326541
curr_Factors:  [1.00145792e+02 3.91896141e-02]
mat_Sqrt:  [[ 1.98252284e+01  0.00000000e+00]
 [-7.91854674e-03  1.81436699e-02]]
grads:  [-0.0038812   2.69305131]
Stock Position:  -0.0038812042685242806
Bond Position:  [4.00615773]


portfolio before change:  [3.6229831]
curr_Stock_Price:  98.98378566757141
curr_Factors:  [9.89837857e+01 3.76100978e-02]
mat_Sqrt:  [[ 1.91962453e+01  0.00000000e+00]
 [-7.75732921e-03  1.77742741e-02]]
grads:  [-0.00970632 -3.74991235]
Stock Position:  -0.009706318464931512
Bond Position:  [4.58375125]


portfolio before change:  [3.61229665]
curr_Stock_Price:  100.20283976644767
curr_Factors:  [1.00202840e+02 3.52372954e-02]
mat_Sqrt:  [[ 1.88096759e+01  0.00000000e+00]
 [-7.50863986e-03  1.72044553e-02]]
grads:  [-2.35160361e-02 -3.62177738e+01]
Stock Position:  -0.02351603612927419
Bond Position:  [5.96867025]


portfolio before change:  [3.58005695]
curr_Stock_Price:  101.63726766464323
curr_Factors:  [1.01637268e+02 3.51767402e-02]
mat_Sqrt:  [[ 1.90625404e+01  0.00000000e+00]
 [-7.50218531e-03  1.71896660e-02]]
grads:  [ 0.009436   -1.45547861]
Stock Position:  0.009436004681241882
Bond Position:  [2.62100722]


portfolio before change:  [3.56070469]
curr_Stock_Price:  99.51692160738071
curr_Factors:  [9.95169216e+01 3.58203072e-02]
mat_Sqrt:  [[ 1.88348249e+01  0.00000000e+00]
 [-7.57050141e-03  1.73461979e-02]]
grads:  [-0.02539021 -6.87661244]
Stock Position:  -0.02539020943350417
Bond Position:  [6.08746017]


portfolio before change:  [3.53448992]
curr_Stock_Price:  100.60934364568779
curr_Factors:  [1.00609344e+02 3.76993901e-02]
mat_Sqrt:  [[ 1.95346430e+01  0.00000000e+00]
 [-7.76653231e-03  1.77953611e-02]]
grads:  [ 9.21128594e-03 -2.66181366e+01]
Stock Position:  0.009211285935640252
Bond Position:  [2.60774849]


portfolio before change:  [3.52147096]
curr_Stock_Price:  99.12518903373368
curr_Factors:  [9.91251890e+01 3.89532984e-02]
mat_Sqrt:  [[ 1.95639321e+01  0.00000000e+00]
 [-7.89463599e-03  1.80888835e-02]]
grads:  [-0.01981997  9.75628312]
Stock Position:  -0.019819971131814447
Bond Position:  [5.48612935]


portfolio before change:  [3.51413226]
curr_Stock_Price:  99.5646651636994
curr_Factors:  [9.95646652e+01 4.04225680e-02]
mat_Sqrt:  [[ 2.00178388e+01  0.00000000e+00]
 [-8.04214579e-03  1.84268709e-02]]
grads:  [5.41382654e-03 7.40883110e+00]
Stock Position:  0.0054138265432077315
Bond Position:  [2.97510644]


portfolio before change:  [3.52277178]
curr_Stock_Price:  101.0230880831715
curr_Factors:  [1.01023088e+02 3.93698846e-02]
mat_Sqrt:  [[ 2.00448454e+01  0.00000000e+00]
 [-7.93673833e-03  1.81853521e-02]]
grads:  [-0.0108547  -2.92262206]
Stock Position:  -0.010854704361950877
Bond Position:  [4.61934754]


portfolio before change:  [3.53953511]
curr_Stock_Price:  99.58515454960929
curr_Factors:  [9.95851545e+01 4.02115009e-02]
mat_Sqrt:  [[ 1.99696174e+01  0.00000000e+00]
 [-8.02112220e-03  1.83786998e-02]]
grads:  [0.01406174 0.25132637]
Stock Position:  0.014061736877708142
Bond Position:  [2.13919487]


portfolio before change:  [3.51242035]
curr_Stock_Price:  97.61885258333
curr_Factors:  [9.76188526e+01 4.04274420e-02]
mat_Sqrt:  [[ 1.96278093e+01  0.00000000e+00]
 [-8.04263061e-03  1.84279818e-02]]
grads:  [-0.00253102  1.11310722]
Stock Position:  -0.002531020674177873
Bond Position:  [3.75949569]


portfolio before change:  [3.51827132]
curr_Stock_Price:  95.67853921939422
curr_Factors:  [9.56785392e+01 4.04681823e-02]
mat_Sqrt:  [[ 1.92473696e+01  0.00000000e+00]
 [-8.04668203e-03  1.84372648e-02]]
grads:  [-0.00784084  2.19778546]
Stock Position:  -0.007840844723484758
Bond Position:  [4.26847189]


portfolio before change:  [3.51407206]
curr_Stock_Price:  96.35021526016102
curr_Factors:  [9.63502153e+01 4.05984457e-02]
mat_Sqrt:  [[ 1.94136588e+01  0.00000000e+00]
 [-8.05962239e-03  1.84669148e-02]]
grads:  [-0.00383395  1.1821625 ]
Stock Position:  -0.0038339548264819316
Bond Position:  [3.88347443]


portfolio before change:  [3.51405229]
curr_Stock_Price:  96.60863333101355
curr_Factors:  [9.66086333e+01 4.28869862e-02]
mat_Sqrt:  [[ 2.00068494e+01  0.00000000e+00]
 [-8.28366936e-03  1.89802709e-02]]
grads:  [-8.54428525e-03 -1.11120998e+01]
Stock Position:  -0.008544285247484178
Bond Position:  [4.33950401]


portfolio before change:  [3.5190496]
curr_Stock_Price:  96.15074868307582
curr_Factors:  [9.61507487e+01 4.39850108e-02]
mat_Sqrt:  [[ 2.01653155e+01  0.00000000e+00]
 [-8.38904150e-03  1.92217089e-02]]
grads:  [-0.01183228 -7.36665678]
Stock Position:  -0.011832276371930272
Bond Position:  [4.65673183]


portfolio before change:  [3.53169501]
curr_Stock_Price:  95.18042977618255
curr_Factors:  [9.51804298e+01 4.46127439e-02]
mat_Sqrt:  [[ 2.01037525e+01  0.00000000e+00]
 [-8.44869163e-03  1.93583845e-02]]
grads:  [0.00526219 2.11066235]
Stock Position:  0.005262194417048316
Bond Position:  [3.03083708]


portfolio before change:  [3.52011196]
curr_Stock_Price:  92.83523834970144
curr_Factors:  [9.28352383e+01 4.65657973e-02]
mat_Sqrt:  [[ 2.00330179e+01  0.00000000e+00]
 [-8.63164385e-03  1.97775807e-02]]
grads:  [ 6.03821405e-04 -3.38493613e+00]
Stock Position:  0.000603821405345123
Bond Position:  [3.46405605]


portfolio before change:  [3.52109029]
curr_Stock_Price:  93.02107478225257
curr_Factors:  [9.30210748e+01 4.68976334e-02]
mat_Sqrt:  [[ 2.01445150e+01  0.00000000e+00]
 [-8.66234457e-03  1.98479248e-02]]
grads:  [  0.04458227 -25.82925776]
Stock Position:  0.044582271921756504
Bond Position:  [-0.62600056]


portfolio before change:  [3.52462146]
curr_Stock_Price:  93.1037913412945
curr_Factors:  [9.31037913e+01 4.71070829e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.52462146]
Stock Price:  94.0730313377959
PL:  [3.52462146]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 9.02473697e-02  3.66652640e-01]
 [ 2.26128059e-01  1.69802446e-02]
 [-8.86002933e-02 -6.51166793e-02]
 [ 1.68691414e-01  9.45969504e-03]
 [-2.98461800e-01 -1.01033362e-01]
 [ 5.29203868e-01 -6.95098133e-01]
 [-5.38977854e-01  3.29667006e-01]
 [ 1.14068791e-01  1.41649150e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.72920930e-01  4.60949510e-03]
 [-1.81972784e-02  6.04660847e-02]
 [-2.36159376e-01  6.07732213e-02]
 [-7.97855815e-02  3.37368188e-02]
 [-1.27780584e-01 -2.33748257e-01]
 [-1.47711380e-01 -1.47864903e-01]
 [ 8.86587735e-02  6.61722993e-02]
 [ 3.01032102e-02 -7.03010936e-02]
 [ 5.43562209e-01 -2.78016362e-01]
 [ 1.86424587e-01  1.37006662e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.61237328]
curr_Stock_Price:  102.32235152802976
curr_Factors:  [1.02322352e+02 3.85541668e-02]
mat_Sqrt:  [[ 2.00912137e+01  0.00000000e+00]
 [-7.85408600e-03  1.79959718e-02]]
grads:  [1.24565745e-02 2.03741506e+01]
Stock Position:  0.012456574511361734
Bond Position:  [17.33778728]


portfolio before change:  [18.63752986]
curr_Stock_Price:  103.99388616275694
curr_Factors:  [1.03993886e+02 3.81140375e-02]
mat_Sqrt:  [[ 2.03025359e+01  0.00000000e+00]
 [-7.80912672e-03  1.78929571e-02]]
grads:  [0.01150294 0.9489904 ]
Stock Position:  0.011502939692538025
Bond Position:  [17.44129446]


portfolio before change:  [18.65159757]
curr_Stock_Price:  104.83774286194387
curr_Factors:  [1.04837743e+02 3.73599990e-02]
mat_Sqrt:  [[ 2.02638093e+01  0.00000000e+00]
 [-7.73149393e-03  1.77150781e-02]]
grads:  [-0.0057748  -3.67577715]
Stock Position:  -0.005774804738104014
Bond Position:  [19.25701506]


portfolio before change:  [18.67653546]
curr_Stock_Price:  101.35311578780164
curr_Factors:  [1.01353116e+02 4.00252293e-02]
mat_Sqrt:  [[ 2.02770148e+01  0.00000000e+00]
 [-8.00252253e-03  1.83360826e-02]]
grads:  [0.00852295 0.515906  ]
Stock Position:  0.008522949026546848
Bond Position:  [17.81270802]


portfolio before change:  [18.67646876]
curr_Stock_Price:  100.82273133502693
curr_Factors:  [1.00822731e+02 3.98983536e-02]
mat_Sqrt:  [[ 2.01389093e+01  0.00000000e+00]
 [-7.98982889e-03  1.83069978e-02]]
grads:  [-0.01700968 -5.51883836]
Stock Position:  -0.01700967860060227
Bond Position:  [20.39143101]


portfolio before change:  [18.65507573]
curr_Stock_Price:  102.38016936057201
curr_Factors:  [1.02380169e+02 3.68627121e-02]
mat_Sqrt:  [[ 1.96566491e+01  0.00000000e+00]
 [-7.67986584e-03  1.75967833e-02]]
grads:  [ 1.14891490e-02 -3.95014318e+01]
Stock Position:  0.011489149034072955
Bond Position:  [17.47881471]


portfolio before change:  [18.65088526]
curr_Stock_Price:  101.63505597047934
curr_Factors:  [1.01635056e+02 3.64496882e-02]
mat_Sqrt:  [[ 1.94039631e+01  0.00000000e+00]
 [-7.63672058e-03  1.74979250e-02]]
grads:  [-0.02036179 18.84034852]
Stock Position:  -0.020361787690371485
Bond Position:  [20.72035669]


portfolio before change:  [18.68505427]
curr_Stock_Price:  100.2113954424178
curr_Factors:  [1.00211395e+02 3.50094757e-02]
mat_Sqrt:  [[ 1.87503731e+01  0.00000000e+00]
 [-7.48432770e-03  1.71487491e-02]]
grads:  [0.00938059 8.26002813]
Stock Position:  0.009380589279047195
Bond Position:  [17.74501233]


portfolio before change:  [18.69681676]
curr_Stock_Price:  100.99233565218931
curr_Factors:  [1.00992336e+02 3.65693756e-02]
mat_Sqrt:  [[ 1.93128865e+01  0.00000000e+00]
 [-7.64924839e-03  1.75266299e-02]]
grads:  [-0.0112661  -3.03246611]
Stock Position:  -0.011266097920100407
Bond Position:  [19.8346063]


portfolio before change:  [18.71925184]
curr_Stock_Price:  99.44114981844874
curr_Factors:  [9.94411498e+01 3.77047192e-02]
mat_Sqrt:  [[ 1.93091872e+01  0.00000000e+00]
 [-7.76708122e-03  1.77966188e-02]]
grads:  [0.01423844 0.2590096 ]
Stock Position:  0.014238438723134239
Bond Position:  [17.30336512]


portfolio before change:  [18.70768656]
curr_Stock_Price:  98.32503956888313
curr_Factors:  [9.83250396e+01 3.79999963e-02]
mat_Sqrt:  [[ 1.91670779e+01  0.00000000e+00]
 [-7.79743510e-03  1.78661683e-02]]
grads:  [4.27414367e-04 3.38439019e+00]
Stock Position:  0.00042741436700030296
Bond Position:  [18.66566102]


portfolio before change:  [18.71246929]
curr_Stock_Price:  98.5958202978527
curr_Factors:  [9.85958203e+01 3.68383088e-02]
mat_Sqrt:  [[ 1.89237999e+01  0.00000000e+00]
 [-7.67732337e-03  1.75909577e-02]]
grads:  [-0.01107789  3.45479889]
Stock Position:  -0.011077889725994043
Bond Position:  [19.80470292]


portfolio before change:  [18.71916475]
curr_Stock_Price:  98.43841985710253
curr_Factors:  [9.84384199e+01 3.65658206e-02]
mat_Sqrt:  [[ 1.88235831e+01  0.00000000e+00]
 [-7.64887658e-03  1.75257780e-02]]
grads:  [-0.00345639  1.92498267]
Stock Position:  -0.003456389055663451
Bond Position:  [19.05940623]


portfolio before change:  [18.72540482]
curr_Stock_Price:  98.01178476038727
curr_Factors:  [9.80117848e+01 3.81025279e-02]
mat_Sqrt:  [[ 1.91317718e+01  0.00000000e+00]
 [-7.80794753e-03  1.78902553e-02]]
grads:  [-1.20112601e-02 -1.30656748e+01]
Stock Position:  -0.012011260086896377
Bond Position:  [19.90264985]


portfolio before change:  [18.745101]
curr_Stock_Price:  96.78627643627674
curr_Factors:  [9.67862764e+01 4.04727778e-02]
mat_Sqrt:  [[ 1.94713152e+01  0.00000000e+00]
 [-8.04713890e-03  1.84383116e-02]]
grads:  [-0.01090039 -8.01943838]
Stock Position:  -0.010900389206250428
Bond Position:  [19.80010908]


portfolio before change:  [18.74536356]
curr_Stock_Price:  97.21636022055598
curr_Factors:  [9.72163602e+01 3.78778943e-02]
mat_Sqrt:  [[ 1.89204853e+01  0.00000000e+00]
 [-7.78489761e-03  1.78374413e-02]]
grads:  [0.00621225 3.70974167]
Stock Position:  0.006212247252135982
Bond Position:  [18.1414315]


portfolio before change:  [18.7527165]
curr_Stock_Price:  97.66982027790827
curr_Factors:  [9.76698203e+01 3.58716077e-02]
mat_Sqrt:  [[ 1.84984700e+01  0.00000000e+00]
 [-7.57592056e-03  1.73586147e-02]]
grads:  [-3.12837994e-05 -4.04992534e+00]
Stock Position:  -3.12837994114979e-05
Bond Position:  [18.75577198]


portfolio before change:  [18.75735062]
curr_Stock_Price:  99.4407631280178
curr_Factors:  [9.94407631e+01 3.40741968e-02]
mat_Sqrt:  [[ 1.83559667e+01  0.00000000e+00]
 [-7.38367895e-03  1.69181339e-02]]
grads:  [  0.02300211 -16.43303953]
Stock Position:  0.023002107521031673
Bond Position:  [16.4700035]


portfolio before change:  [18.72687425]
curr_Stock_Price:  97.93679707653988
curr_Factors:  [9.79367971e+01 3.35932042e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.72687425]
Stock Price:  98.13487803385347
PL:  [18.72687425]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 6.26660234e-02  3.25204571e-01]
 [ 2.97264075e-01  1.01401825e-01]
 [-1.00126032e-01 -1.43755153e-01]
 [ 3.40511484e-01 -2.75724561e-01]
 [-9.05972077e-02 -7.11191635e-02]
 [ 6.69820172e-01 -9.12667454e-01]
 [-5.44838648e-01  3.44238114e-01]
 [ 3.04199336e-01  1.56583738e-01]
 [ 2.57931502e-02 -7.03413627e-02]
 [ 3.20445438e-01  4.87283150e-03]
 [ 1.11711942e-01  1.79941637e-01]
 [-2.36625097e-01  6.98514858e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.18661245e-01 -2.69849896e-01]
 [-4.77939274e-02 -1.02101408e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.18794743e-02  2.40938248e-02]
 [ 4.65710100e-01 -2.55365536e-01]
 [ 2.19214093e-01  1.23539635e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.64333073]
curr_Stock_Price:  102.0365385233966
curr_Factors:  [1.02036539e+02 4.00972085e-02]
mat_Sqrt:  [[ 2.04320897e+01  0.00000000e+00]
 [-8.00971495e-03  1.83525625e-02]]
grads:  [1.00135100e-02 1.77198454e+01]
Stock Position:  0.010013509984513636
Bond Position:  [15.62158683]


portfolio before change:  [16.67283172]
curr_Stock_Price:  104.59259628181188
curr_Factors:  [1.04592596e+02 4.02917288e-02]
mat_Sqrt:  [[ 2.09946623e+01  0.00000000e+00]
 [-8.02911988e-03  1.83970248e-02]]
grads:  [0.01626697 5.51186   ]
Stock Position:  0.016266966076282263
Bond Position:  [14.97142751]


portfolio before change:  [16.67031226]
curr_Stock_Price:  104.20759565936682
curr_Factors:  [1.04207596e+02 4.11450645e-02]
mat_Sqrt:  [[ 2.11377253e+01  0.00000000e+00]
 [-8.11369850e-03  1.85908188e-02]]
grads:  [-7.70498821e-03 -7.73258859e+00]
Stock Position:  -0.007704988212354716
Bond Position:  [17.47323055]


portfolio before change:  [16.6700773]
curr_Stock_Price:  104.80510640351635
curr_Factors:  [1.04805106e+02 3.93037548e-02]
mat_Sqrt:  [[ 2.07777953e+01  0.00000000e+00]
 [-7.93006984e-03  1.81700726e-02]]
grads:  [ 1.05966690e-02 -1.51746537e+01]
Stock Position:  0.010596669038429608
Bond Position:  [15.55949227]


portfolio before change:  [16.6659046]
curr_Stock_Price:  104.04420199708423
curr_Factors:  [1.04044202e+02 3.82959578e-02]
mat_Sqrt:  [[ 2.03607772e+01  0.00000000e+00]
 [-7.82774121e-03  1.79356083e-02]]
grads:  [-0.00597404 -3.96524959]
Stock Position:  -0.005974042845725842
Bond Position:  [17.28746912]


portfolio before change:  [16.67063241]
curr_Stock_Price:  103.97634229447598
curr_Factors:  [1.03976342e+02 3.65665405e-02]
mat_Sqrt:  [[ 1.98827510e+01  0.00000000e+00]
 [-7.64895188e-03  1.75259505e-02]]
grads:  [ 1.36550239e-02 -5.20752044e+01]
Stock Position:  0.013655023889106112
Bond Position:  [15.25083297]


portfolio before change:  [16.6454979]
curr_Stock_Price:  101.85641209201304
curr_Factors:  [1.01856412e+02 3.65669382e-02]
mat_Sqrt:  [[ 1.94774758e+01  0.00000000e+00]
 [-7.64899347e-03  1.75260458e-02]]
grads:  [-0.02025934 19.64151632]
Stock Position:  -0.020259340702423835
Bond Position:  [18.70904165]


portfolio before change:  [16.64490166]
curr_Stock_Price:  102.11674026555353
curr_Factors:  [1.02116740e+02 3.55715283e-02]
mat_Sqrt:  [[ 1.92596418e+01  0.00000000e+00]
 [-7.54416631e-03  1.72858566e-02]]
grads:  [0.01934294 9.05848876]
Stock Position:  0.019342939262963436
Bond Position:  [14.66966376]


portfolio before change:  [16.67389224]
curr_Stock_Price:  103.42588472920608
curr_Factors:  [1.03425885e+02 3.52714265e-02]
mat_Sqrt:  [[ 1.94240933e+01  0.00000000e+00]
 [-7.51227544e-03  1.72127854e-02]]
grads:  [-2.52590289e-04 -4.08657640e+00]
Stock Position:  -0.00025259028870147014
Bond Position:  [16.70001661]


portfolio before change:  [16.67874577]
curr_Stock_Price:  100.74167927477897
curr_Factors:  [1.00741679e+02 3.46936127e-02]
mat_Sqrt:  [[ 1.87643683e+01  0.00000000e+00]
 [-7.45048860e-03  1.70712140e-02]]
grads:  [0.01719067 0.28544142]
Stock Position:  0.017190672814533424
Bond Position:  [14.94692852]


portfolio before change:  [16.68530327]
curr_Stock_Price:  100.90573915226403
curr_Factors:  [1.00905739e+02 3.41995145e-02]
mat_Sqrt:  [[ 1.86606101e+01  0.00000000e+00]
 [-7.39724429e-03  1.69492160e-02]]
grads:  [1.01949995e-02 1.06165169e+01]
Stock Position:  0.010194999542747938
Bond Position:  [15.6565693]


portfolio before change:  [16.67926644]
curr_Stock_Price:  99.92962690556645
curr_Factors:  [9.99296269e+01 3.45895088e-02]
mat_Sqrt:  [[ 1.85851668e+01  0.00000000e+00]
 [-7.43930199e-03  1.70455823e-02]]
grads:  [-0.01109161  4.09792313]
Stock Position:  -0.011091609288634681
Bond Position:  [17.78764681]


portfolio before change:  [16.66766073]
curr_Stock_Price:  101.37695276780175
curr_Factors:  [1.01376953e+02 3.50940109e-02]
mat_Sqrt:  [[ 1.89913456e+01  0.00000000e+00]
 [-7.49335822e-03  1.71694406e-02]]
grads:  [3.49765240e-04 2.29277725e+00]
Stock Position:  0.0003497652403089276
Bond Position:  [16.6322026]


portfolio before change:  [16.67137161]
curr_Stock_Price:  100.09698169791015
curr_Factors:  [1.00096982e+02 3.50861758e-02]
mat_Sqrt:  [[ 1.87494702e+01  0.00000000e+00]
 [-7.49252169e-03  1.71675239e-02]]
grads:  [ -0.01794362 -15.71862649]
Stock Position:  -0.017943621430210617
Bond Position:  [18.46747396]


portfolio before change:  [16.6724394]
curr_Stock_Price:  100.29480431822229
curr_Factors:  [1.00294804e+02 3.37669993e-02]
mat_Sqrt:  [[ 1.84299718e+01  0.00000000e+00]
 [-7.35031965e-03  1.68416981e-02]]
grads:  [-5.01111105e-03 -6.06241766e+00]
Stock Position:  -0.005011111045225804
Bond Position:  [17.17502781]


portfolio before change:  [16.66431723]
curr_Stock_Price:  102.77259236201039
curr_Factors:  [1.02772592e+02 3.26821125e-02]
mat_Sqrt:  [[ 1.85794294e+01  0.00000000e+00]
 [-7.23127790e-03  1.65689392e-02]]
grads:  [0.00516679 1.05806748]
Stock Position:  0.005166785708770931
Bond Position:  [16.13331327]


portfolio before change:  [16.66735128]
curr_Stock_Price:  102.57909024068766
curr_Factors:  [1.02579090e+02 3.32820069e-02]
mat_Sqrt:  [[ 1.87138695e+01  0.00000000e+00]
 [-7.29734274e-03  1.67203127e-02]]
grads:  [-0.00221034  1.44099128]
Stock Position:  -0.002210342824191278
Bond Position:  [16.89408623]


portfolio before change:  [16.67573826]
curr_Stock_Price:  100.69570037157052
curr_Factors:  [1.00695700e+02 3.31605957e-02]
mat_Sqrt:  [[ 1.83367384e+01  0.00000000e+00]
 [-7.28402040e-03  1.66897874e-02]]
grads:  [  0.01931965 -15.30070634]
Stock Position:  0.019319654089338008
Bond Position:  [14.73033216]


portfolio before change:  [16.66684719]
curr_Stock_Price:  100.04485434289873
curr_Factors:  [1.00044854e+02 3.40429323e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.66684719]
Stock Price:  99.21662420994566
PL:  [16.66684719]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.55438841e-01 -6.60882901e-02]
 [-1.59343283e-01 -1.40857333e+00]
 [-2.26893297e-03  2.79393028e-01]
 [-4.65697149e-01  3.29594124e-03]
 [ 4.96169851e-01 -3.65307839e-01]
 [-1.93213337e-01  4.88375764e-02]
 [-1.09597101e-01 -9.90644308e-02]
 [-2.38979866e-01  1.26022776e-01]
 [ 1.58632496e-01  1.08276933e-02]
 [-1.01396821e-01 -3.57441034e-02]
 [-1.87441019e-01  5.17041006e-02]
 [-1.12618326e-01  2.69029470e-02]
 [-5.92147513e-02 -2.01629102e-01]
 [-1.72166246e-01 -1.42626532e-01]
 [ 8.80964135e-02  3.90075186e-02]
 [ 5.97293191e-02 -8.36945386e-02]
 [ 7.86245746e-01 -3.72960460e-01]
 [ 1.48821902e-01  1.52904197e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.21218655]
curr_Stock_Price:  97.99321854402605
curr_Factors:  [9.79932185e+01 4.04604969e-02]
mat_Sqrt:  [[ 1.97111348e+01  0.00000000e+00]
 [-8.04591791e-03  1.84355139e-02]]
grads:  [ 0.001414   -0.07327348]
Stock Position:  0.001414001674712934
Bond Position:  [-11.35074912]


portfolio before change:  [-11.21763335]
curr_Stock_Price:  96.14827214625338
curr_Factors:  [9.61482721e+01 4.41451452e-02]
mat_Sqrt:  [[ 2.02014694e+01  0.00000000e+00]
 [-8.40429845e-03  1.92566669e-02]]
grads:  [-0.00912221 -3.43196933]
Stock Position:  -0.009122214427574623
Bond Position:  [-10.34054819]


portfolio before change:  [-11.21182059]
curr_Stock_Price:  95.22763787324341
curr_Factors:  [9.52276379e+01 4.55962281e-02]
mat_Sqrt:  [[ 2.03342178e+01  0.00000000e+00]
 [-8.54130933e-03  1.95705983e-02]]
grads:  [-3.80685942e-02 -7.19739537e+01]
Stock Position:  -0.038068594220850016
Bond Position:  [-7.58663828]


portfolio before change:  [-11.19000788]
curr_Stock_Price:  94.60482508595408
curr_Factors:  [9.46048251e+01 4.53752580e-02]
mat_Sqrt:  [[ 2.01522175e+01  0.00000000e+00]
 [-8.52058759e-03  1.95231188e-02]]
grads:  [5.93821407e-03 1.43108809e+01]
Stock Position:  0.005938214068389727
Bond Position:  [-11.75179158]


portfolio before change:  [-11.20514458]
curr_Stock_Price:  92.55060626175187
curr_Factors:  [9.25506063e+01 4.55536000e-02]
mat_Sqrt:  [[ 1.97533437e+01  0.00000000e+00]
 [-8.53731573e-03  1.95614478e-02]]
grads:  [-0.02350279  0.16849168]
Stock Position:  -0.023502789680796537
Bond Position:  [-9.02994715]


portfolio before change:  [-11.20509269]
curr_Stock_Price:  92.45233431644891
curr_Factors:  [9.24523343e+01 4.47536482e-02]
mat_Sqrt:  [[ 1.95583450e+01  0.00000000e+00]
 [-8.46202323e-03  1.93889310e-02]]
grads:  [ 1.72170211e-02 -1.88410511e+01]
Stock Position:  0.017217021109145532
Bond Position:  [-12.79684648]


portfolio before change:  [-11.18871696]
curr_Stock_Price:  93.5893100780474
curr_Factors:  [9.35893101e+01 4.43150773e-02]
mat_Sqrt:  [[ 1.97016229e+01  0.00000000e+00]
 [-8.42045863e-03  1.92936945e-02]]
grads:  [-0.00872511  2.53127136]
Stock Position:  -0.008725112264118979
Bond Position:  [-10.37213972]


portfolio before change:  [-11.19000058]
curr_Stock_Price:  93.43919791784006
curr_Factors:  [9.34391979e+01 4.36526792e-02]
mat_Sqrt:  [[ 1.95224606e+01  0.00000000e+00]
 [-8.35728944e-03  1.91489557e-02]]
grads:  [-0.00782854 -5.17335943]
Stock Position:  -0.007828539999924968
Bond Position:  [-10.45850808]


portfolio before change:  [-11.1930454]
curr_Stock_Price:  93.49410871990493
curr_Factors:  [9.34941087e+01 4.35781401e-02]
mat_Sqrt:  [[ 1.95172485e+01  0.00000000e+00]
 [-8.35015115e-03  1.91325998e-02]]
grads:  [-0.00942648  6.58680875]
Stock Position:  -0.009426483305270182
Bond Position:  [-10.31172475]


portfolio before change:  [-11.2118132]
curr_Stock_Price:  95.21156192428307
curr_Factors:  [9.52115619e+01 4.31495061e-02]
mat_Sqrt:  [[ 1.97777829e+01  0.00000000e+00]
 [-8.30898368e-03  1.90382733e-02]]
grads:  [0.00825968 0.56873295]
Stock Position:  0.008259676542434017
Bond Position:  [-11.9982299]


portfolio before change:  [-11.2056045]
curr_Stock_Price:  96.32645168388957
curr_Factors:  [9.63264517e+01 4.33556688e-02]
mat_Sqrt:  [[ 2.00571170e+01  0.00000000e+00]
 [-8.32880964e-03  1.90837003e-02]]
grads:  [-0.00583318 -1.87301743]
Stock Position:  -0.005833182629360156
Bond Position:  [-10.64371472]


portfolio before change:  [-11.20846812]
curr_Stock_Price:  96.36114278165853
curr_Factors:  [9.63611428e+01 4.06390771e-02]
mat_Sqrt:  [[ 1.94255740e+01  0.00000000e+00]
 [-8.06365447e-03  1.84761535e-02]]
grads:  [-0.00848755  2.79842342]
Stock Position:  -0.008487548416550146
Bond Position:  [-10.39059826]


portfolio before change:  [-11.21415266]
curr_Stock_Price:  96.72480081902579
curr_Factors:  [9.67248008e+01 3.99539885e-02]
mat_Sqrt:  [[ 1.93338308e+01  0.00000000e+00]
 [-7.99539753e-03  1.83197572e-02]]
grads:  [-0.00521764  1.46852094]
Stock Position:  -0.005217637321137917
Bond Position:  [-10.70947773]


portfolio before change:  [-11.21278553]
curr_Stock_Price:  95.94957805883193
curr_Factors:  [9.59495781e+01 4.03287482e-02]
mat_Sqrt:  [[ 1.92686124e+01  0.00000000e+00]
 [-8.03280755e-03  1.84054743e-02]]
grads:  [-7.64003671e-03 -1.09548441e+01]
Stock Position:  -0.007640036711924593
Bond Position:  [-10.47972724]


portfolio before change:  [-11.21768348]
curr_Stock_Price:  96.24770257762384
curr_Factors:  [9.62477026e+01 3.84291714e-02]
mat_Sqrt:  [[ 1.88677834e+01  0.00000000e+00]
 [-7.84134391e-03  1.79667760e-02]]
grads:  [-0.01242401 -7.93834863]
Stock Position:  -0.012424012026850135
Bond Position:  [-10.02190086]


portfolio before change:  [-11.20569429]
curr_Stock_Price:  95.08101206471963
curr_Factors:  [9.50810121e+01 4.02073036e-02]
mat_Sqrt:  [[ 1.90654153e+01  0.00000000e+00]
 [-8.02070357e-03  1.83777406e-02]]
grads:  [0.00551368 2.12254158]
Stock Position:  0.005513684783084763
Bond Position:  [-11.72994102]


portfolio before change:  [-11.20541337]
curr_Stock_Price:  95.66388405273702
curr_Factors:  [9.56638841e+01 3.97219081e-02]
mat_Sqrt:  [[ 1.90661524e+01  0.00000000e+00]
 [-7.97214231e-03  1.82664728e-02]]
grads:  [ 1.21692239e-03 -4.58186644e+00]
Stock Position:  0.001216922391915092
Bond Position:  [-11.32182889]


portfolio before change:  [-11.2071065]
curr_Stock_Price:  96.59876452938175
curr_Factors:  [9.65987645e+01 3.70764457e-02]
mat_Sqrt:  [[ 1.86003287e+01  0.00000000e+00]
 [-7.70209797e-03  1.76477235e-02]]
grads:  [  0.03351943 -21.13363011]
Stock Position:  0.033519432161472885
Bond Position:  [-14.44504224]


portfolio before change:  [-11.24061653]
curr_Stock_Price:  95.7067948605438
curr_Factors:  [9.57067949e+01 3.72222601e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.24061653]
Stock Price:  96.20008714423916
PL:  [-11.24061653]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 6.07422087e-02  3.22313545e-01]
 [ 1.48986478e-01 -2.44561375e-02]
 [-8.46929991e-02 -3.84577675e-02]
 [ 3.08160602e-01 -2.21552449e-01]
 [-2.18788934e-01 -9.14510416e-02]
 [ 5.78650098e-01 -7.71613069e-01]
 [-4.98242633e-01  2.16812260e-01]
 [ 2.22428313e-01  1.50160695e-01]
 [-5.98353380e-02 -3.92185467e-02]
 [ 2.59533270e-01  9.63179310e-03]
 [ 1.17934694e-01  1.85219873e-01]
 [-2.36340802e-01  6.43097415e-02]
 [-4.96390791e-02  3.59463097e-02]
 [-1.20880948e-01 -2.30613697e-01]
 [-9.33881645e-02 -1.21809330e-01]
 [ 8.88743147e-02  7.15299739e-02]
 [ 3.04145869e-02 -7.04563223e-02]
 [ 6.81542857e-01 -3.29356213e-01]
 [ 2.14679677e-01  1.25365366e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.50713402]
curr_Stock_Price:  102.01676912256899
curr_Factors:  [1.02016769e+02 4.05460786e-02]
mat_Sqrt:  [[ 2.05421546e+01  0.00000000e+00]
 [-8.05442274e-03  1.84550009e-02]]
grads:  [9.80478318e-03 1.74648349e+01]
Stock Position:  0.00980478317611849
Bond Position:  [15.50688172]


portfolio before change:  [16.51778963]
curr_Stock_Price:  102.7081059264412
curr_Factors:  [1.02708106e+02 4.03960728e-02]
mat_Sqrt:  [[ 2.06430704e+01  0.00000000e+00]
 [-8.03950972e-03  1.84208309e-02]]
grads:  [ 0.00670021 -1.32763487]
Stock Position:  0.006700211854656537
Bond Position:  [15.82962356]


portfolio before change:  [16.53752979]
curr_Stock_Price:  105.06359253580003
curr_Factors:  [1.05063593e+02 3.82424981e-02]
mat_Sqrt:  [[ 2.05459096e+01  0.00000000e+00]
 [-7.82227569e-03  1.79230852e-02]]
grads:  [-0.00493905 -2.14571135]
Stock Position:  -0.004939053400266647
Bond Position:  [17.05644448]


portfolio before change:  [16.54645185]
curr_Stock_Price:  104.12061422749943
curr_Factors:  [1.04120614e+02 3.83686177e-02]
mat_Sqrt:  [[ 2.03950511e+01  0.00000000e+00]
 [-7.83516358e-03  1.79526151e-02]]
grads:  [ 1.03685539e-02 -1.23409569e+01]
Stock Position:  0.010368553870654692
Bond Position:  [15.46687166]


portfolio before change:  [16.52396704]
curr_Stock_Price:  101.57908142228172
curr_Factors:  [1.01579081e+02 3.81959887e-02]
mat_Sqrt:  [[ 1.98524065e+01  0.00000000e+00]
 [-7.81751764e-03  1.79121832e-02]]
grads:  [-0.01303124 -5.1055218 ]
Stock Position:  -0.013031238315438204
Bond Position:  [17.84766825]


portfolio before change:  [16.510759]
curr_Stock_Price:  102.93509334125707
curr_Factors:  [1.02935093e+02 3.86568678e-02]
mat_Sqrt:  [[ 2.02384288e+01  0.00000000e+00]
 [-7.86453994e-03  1.80199248e-02]]
grads:  [ 1.19520418e-02 -4.28199939e+01]
Stock Position:  0.011952041754147958
Bond Position:  [15.28047446]


portfolio before change:  [16.47802716]
curr_Stock_Price:  99.87683485875543
curr_Factors:  [9.98768349e+01 3.87656002e-02]
mat_Sqrt:  [[ 1.96647318e+01  0.00000000e+00]
 [-7.87559269e-03  1.80452498e-02]]
grads:  [-0.02052497 12.0149215 ]
Stock Position:  -0.02052496873431182
Bond Position:  [18.52799607]


portfolio before change:  [16.45348618]
curr_Stock_Price:  101.29820420852593
curr_Factors:  [1.01298204e+02 3.60163347e-02]
mat_Sqrt:  [[ 1.92243429e+01  0.00000000e+00]
 [-7.59118802e-03  1.73935969e-02]]
grads:  [0.01497912 8.63310197]
Stock Position:  0.014979123882128489
Bond Position:  [14.93612783]


portfolio before change:  [16.47902521]
curr_Stock_Price:  102.75386560253084
curr_Factors:  [1.02753866e+02 3.30731475e-02]
mat_Sqrt:  [[ 1.86868428e+01  0.00000000e+00]
 [-7.27440966e-03  1.66677665e-02]]
grads:  [-0.00411796 -2.35295754]
Stock Position:  -0.004117962340069321
Bond Position:  [16.90216176]


portfolio before change:  [16.48725137]
curr_Stock_Price:  101.78248902381188
curr_Factors:  [1.01782489e+02 3.44877260e-02]
mat_Sqrt:  [[ 1.89018950e+01  0.00000000e+00]
 [-7.42834851e-03  1.70204847e-02]]
grads:  [0.01395294 0.56589417]
Stock Position:  0.013952935909949497
Bond Position:  [15.06708682]


portfolio before change:  [16.48219233]
curr_Stock_Price:  101.14991397718671
curr_Factors:  [1.01149914e+02 3.52942997e-02]
mat_Sqrt:  [[ 1.90028090e+01  0.00000000e+00]
 [-7.51471087e-03  1.72183657e-02]]
grads:  [1.04600996e-02 1.07571111e+01]
Stock Position:  0.010460099560090266
Bond Position:  [15.42415416]


portfolio before change:  [16.46929971]
curr_Stock_Price:  99.54867265881144
curr_Factors:  [9.95486727e+01 3.56663055e-02]
mat_Sqrt:  [[ 1.88002895e+01  0.00000000e+00]
 [-7.55421001e-03  1.73088696e-02]]
grads:  [-0.01107822  3.71542123]
Stock Position:  -0.011078219298000624
Bond Position:  [17.57212173]


portfolio before change:  [16.47625206]
curr_Stock_Price:  99.31769898833363
curr_Factors:  [9.93176990e+01 3.30655091e-02]
mat_Sqrt:  [[ 1.80598549e+01  0.00000000e+00]
 [-7.27356959e-03  1.66658416e-02]]
grads:  [-1.87990565e-03  2.15688536e+00]
Stock Position:  -0.0018799056548307943
Bond Position:  [16.66295997]


portfolio before change:  [16.48302483]
curr_Stock_Price:  97.93119130107421
curr_Factors:  [9.79311913e+01 3.51225564e-02]
mat_Sqrt:  [[ 1.83532972e+01  0.00000000e+00]
 [-7.49640515e-03  1.71764220e-02]]
grads:  [-1.20702572e-02 -1.34261778e+01]
Stock Position:  -0.012070257168249963
Bond Position:  [17.66507949]


portfolio before change:  [16.47385848]
curr_Stock_Price:  99.05653360593335
curr_Factors:  [9.90565336e+01 3.46626963e-02]
mat_Sqrt:  [[ 1.84422667e+01  0.00000000e+00]
 [-7.44716820e-03  1.70636060e-02]]
grads:  [-0.00794643 -7.13854561]
Stock Position:  -0.007946426378230889
Bond Position:  [17.26100393]


portfolio before change:  [16.48471717]
curr_Stock_Price:  98.23315738108461
curr_Factors:  [9.82331574e+01 3.37718806e-02]
mat_Sqrt:  [[ 1.80524323e+01  0.00000000e+00]
 [-7.35085090e-03  1.68429153e-02]]
grads:  [0.00665243 4.24688793]
Stock Position:  0.006652430674096252
Bond Position:  [15.8312279]


portfolio before change:  [16.48484635]
curr_Stock_Price:  97.65755965129784
curr_Factors:  [9.76575597e+01 3.48831413e-02]
mat_Sqrt:  [[ 1.82395308e+01  0.00000000e+00]
 [-7.47081161e-03  1.71177798e-02]]
grads:  [-1.83707083e-05 -4.11597316e+00]
Stock Position:  -1.837070826732419e-05
Bond Position:  [16.48664038]


portfolio before change:  [16.48896745]
curr_Stock_Price:  97.71614041615439
curr_Factors:  [9.77161404e+01 3.33819483e-02]
mat_Sqrt:  [[ 1.78534497e+01  0.00000000e+00]
 [-7.30829099e-03  1.67453983e-02]]
grads:  [  0.03012303 -19.66846094]
Stock Position:  0.030123031086740984
Bond Position:  [13.54546111]


portfolio before change:  [16.54879548]
curr_Stock_Price:  99.58983115696742
curr_Factors:  [9.95898312e+01 3.26194739e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.54879548]
Stock Price:  98.99000769605236
PL:  [16.54879548]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.65245804e-01 -1.33818548e+00]
 [-1.90784279e-02  2.77631514e-01]
 [-4.40745921e-01 -3.48959155e-02]
 [ 2.20254747e-01 -4.03770468e-02]
 [-2.09222470e-01  5.76157639e-02]
 [ 2.23926194e-02  1.56140800e-01]
 [-2.25568163e-01  6.83484893e-02]
 [ 2.10276819e-01  7.59155075e-03]
 [-9.81021116e-02 -2.48900511e-02]
 [-1.91374177e-01  5.38671399e-02]
 [-1.02875421e-01  3.20445233e-02]
 [-2.27029405e-01 -2.72223739e-01]
 [-9.64418315e-02 -1.23273990e-01]
 [ 8.77374129e-02  6.13913350e-02]
 [-1.15380933e-02 -4.96684212e-02]
 [ 9.10170366e-01 -4.25071471e-01]
 [ 1.66340212e-01  1.48802719e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.07307509]
curr_Stock_Price:  98.44887090049902
curr_Factors:  [9.84488709e+01 4.04148067e-02]
mat_Sqrt:  [[ 1.97916040e+01  0.00000000e+00]
 [-8.04137368e-03  1.84251018e-02]]
grads:  [ 0.00140825 -0.07331489]
Stock Position:  0.0014082525923107324
Bond Position:  [-8.21171597]


portfolio before change:  [-8.07550376]
curr_Stock_Price:  98.18223875171766
curr_Factors:  [9.81822388e+01 4.17323860e-02]
mat_Sqrt:  [[ 2.00571646e+01  0.00000000e+00]
 [-8.17140243e-03  1.87230351e-02]]
grads:  [-0.00928969 -3.55989133]
Stock Position:  -0.009289691431655882
Bond Position:  [-7.16342106]


portfolio before change:  [-8.05357187]
curr_Stock_Price:  95.62855130561891
curr_Factors:  [9.56285513e+01 4.51179470e-02]
mat_Sqrt:  [[ 2.03124468e+01  0.00000000e+00]
 [-8.49639425e-03  1.94676849e-02]]
grads:  [-3.68876205e-02 -6.87388095e+01]
Stock Position:  -0.036887620485082324
Bond Position:  [-4.52606216]


portfolio before change:  [-8.08265734]
curr_Stock_Price:  96.38636146554435
curr_Factors:  [9.63863615e+01 4.67439509e-02]
mat_Sqrt:  [[ 2.08390681e+01  0.00000000e+00]
 [-8.64813977e-03  1.98153776e-02]]
grads:  [4.89896659e-03 1.40109121e+01]
Stock Position:  0.004898966591783781
Bond Position:  [-8.55485091]


portfolio before change:  [-8.09111957]
curr_Stock_Price:  95.09563006052895
curr_Factors:  [9.50956301e+01 4.81282026e-02]
mat_Sqrt:  [[ 2.08622133e+01  0.00000000e+00]
 [-8.77525636e-03  2.01066383e-02]]
grads:  [-0.02185654 -1.73554202]
Stock Position:  -0.021856537484495994
Bond Position:  [-6.01265837]


portfolio before change:  [-8.08818934]
curr_Stock_Price:  94.8927807313276
curr_Factors:  [9.48927807e+01 4.92635257e-02]
mat_Sqrt:  [[ 2.10618210e+01  0.00000000e+00]
 [-8.87815527e-03  2.03424093e-02]]
grads:  [ 0.00962086 -1.98487044]
Stock Position:  0.009620856538919715
Bond Position:  [-9.00113917]


portfolio before change:  [-8.10154204]
curr_Stock_Price:  93.73881538138669
curr_Factors:  [9.37388154e+01 5.16645112e-02]
mat_Sqrt:  [[ 2.13066721e+01  0.00000000e+00]
 [-9.09193147e-03  2.08322321e-02]]
grads:  [-0.0086394   2.76570286]
Stock Position:  -0.008639401206627824
Bond Position:  [-7.29169481]


portfolio before change:  [-8.12885141]
curr_Stock_Price:  96.68881339962648
curr_Factors:  [9.66888134e+01 5.41912273e-02]
mat_Sqrt:  [[ 2.25081978e+01  0.00000000e+00]
 [-9.31160371e-03  2.13355644e-02]]
grads:  [4.02244781e-03 7.31833461e+00]
Stock Position:  0.004022447811572692
Bond Position:  [-8.51777711]


portfolio before change:  [-8.1358751]
curr_Stock_Price:  95.47214717430913
curr_Factors:  [9.54721472e+01 5.69460601e-02]
mat_Sqrt:  [[ 2.27828752e+01  0.00000000e+00]
 [-9.54534945e-03  2.18711432e-02]]
grads:  [-0.00859147  3.12505335]
Stock Position:  -0.00859147212361414
Bond Position:  [-7.3156288]


portfolio before change:  [-8.15316572]
curr_Stock_Price:  97.27177925848342
curr_Factors:  [9.72717793e+01 5.24818240e-02]
mat_Sqrt:  [[ 2.22839061e+01  0.00000000e+00]
 [-9.16356472e-03  2.09963645e-02]]
grads:  [0.00958495 0.36156501]
Stock Position:  0.009584946312064005
Bond Position:  [-9.0855105]


portfolio before change:  [-8.16048322]
curr_Stock_Price:  96.74534517974071
curr_Factors:  [9.67453452e+01 5.17963391e-02]
mat_Sqrt:  [[ 2.20180884e+01  0.00000000e+00]
 [-9.10352364e-03  2.08587931e-02]]
grads:  [-0.00494889 -1.1932642 ]
Stock Position:  -0.004948886496268646
Bond Position:  [-7.68170149]


portfolio before change:  [-8.16092819]
curr_Stock_Price:  96.44715715674506
curr_Factors:  [9.64471572e+01 5.54355083e-02]
mat_Sqrt:  [[ 2.27082386e+01  0.00000000e+00]
 [-9.41789856e-03  2.15791165e-02]]
grads:  [-0.00739223  2.49626253]
Stock Position:  -0.007392234730311336
Bond Position:  [-7.44796817]


portfolio before change:  [-8.17289159]
curr_Stock_Price:  97.81361469430273
curr_Factors:  [9.78136147e+01 5.51951662e-02]
mat_Sqrt:  [[ 2.29799898e+01  0.00000000e+00]
 [-9.39746061e-03  2.15322873e-02]]
grads:  [-0.00386815  1.48820805]
Stock Position:  -0.003868149886588667
Bond Position:  [-7.79453387]


portfolio before change:  [-8.18473938]
curr_Stock_Price:  100.37269752264666
curr_Factors:  [1.00372698e+02 5.42307708e-02]
mat_Sqrt:  [[ 2.33742931e+01  0.00000000e+00]
 [-9.31500045e-03  2.13433473e-02]]
grads:  [ -0.01479564 -12.75450073]
Stock Position:  -0.014795638292444208
Bond Position:  [-6.69966126]


portfolio before change:  [-8.16458709]
curr_Stock_Price:  98.89743713475625
curr_Factors:  [9.88974371e+01 5.31436861e-02]
mat_Sqrt:  [[ 2.27987415e+01  0.00000000e+00]
 [-9.22116575e-03  2.11283450e-02]]
grads:  [-0.00658997 -5.83453127]
Stock Position:  -0.006589969508143201
Bond Position:  [-7.51285599]


portfolio before change:  [-8.16431924]
curr_Stock_Price:  98.57174474883006
curr_Factors:  [9.85717447e+01 5.62095314e-02]
mat_Sqrt:  [[ 2.33699308e+01  0.00000000e+00]
 [-9.48341975e-03  2.17292444e-02]]
grads:  [0.00490078 2.82528623]
Stock Position:  0.004900775668986572
Bond Position:  [-8.64739724]


portfolio before change:  [-8.16211953]
curr_Stock_Price:  99.46177281470798
curr_Factors:  [9.94617728e+01 5.60690800e-02]
mat_Sqrt:  [[ 2.35514641e+01  0.00000000e+00]
 [-9.47156418e-03  2.17020799e-02]]
grads:  [-1.41032291e-03 -2.28864797e+00]
Stock Position:  -0.001410322912888009
Bond Position:  [-8.02184631]


portfolio before change:  [-8.1581794]
curr_Stock_Price:  95.24582907346516
curr_Factors:  [9.52458291e+01 5.84076669e-02]
mat_Sqrt:  [[ 2.30187055e+01  0.00000000e+00]
 [-9.66707128e-03  2.21500429e-02]]
grads:  [  0.03148109 -19.1905484 ]
Stock Position:  0.031481091256309365
Bond Position:  [-11.15662203]


portfolio before change:  [-8.12163256]
curr_Stock_Price:  96.49535172303952
curr_Factors:  [9.64953517e+01 5.77915150e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.12163256]
Stock Price:  95.53609821303523
PL:  [-8.12163256]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.31749970e-02  1.21068490e-01]
 [-1.56106428e-01 -6.62977299e-02]
 [-2.18046170e-01 -9.48307469e-01]
 [-2.80209981e-02  2.76694397e-01]
 [-4.17686676e-01 -6.39397065e-02]
 [ 8.52744249e-02  5.91146678e-02]
 [-2.39851148e-01  7.44101947e-02]
 [ 1.70030546e-02  1.62943353e-01]
 [-2.16220660e-01  3.19285309e-02]
 [ 2.03648256e-01  8.00691057e-03]
 [-1.51428261e-02  6.23832557e-02]
 [-1.76948606e-01  4.53777423e-02]
 [ 6.20869236e-02 -4.03011412e-03]
 [-5.18521543e-03 -1.45769001e-01]
 [-2.13325344e-01 -1.33510745e-01]
 [ 8.74030364e-02  2.28784412e-02]
 [ 5.80649378e-02 -8.33963760e-02]
 [ 6.69274339e-01 -3.24724715e-01]
 [ 1.69259826e-01  1.46764997e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.91314552]
curr_Stock_Price:  100.62417012784127
curr_Factors:  [1.00624170e+02 3.80286464e-02]
mat_Sqrt:  [[ 1.96226540e+01  0.00000000e+00]
 [-7.80037398e-03  1.78729021e-02]]
grads:  [-1.03637235e-03  6.77385741e+00]
Stock Position:  -0.0010363723458309295
Bond Position:  [7.01742963]


portfolio before change:  [6.91454126]
curr_Stock_Price:  100.97041749787697
curr_Factors:  [1.00970417e+02 3.78562739e-02]
mat_Sqrt:  [[ 1.96454999e+01  0.00000000e+00]
 [-7.78267552e-03  1.78323498e-02]]
grads:  [-0.00941901 -3.71783475]
Stock Position:  -0.009419008448734249
Bond Position:  [7.86558247]


portfolio before change:  [6.94660615]
curr_Stock_Price:  97.77493759701593
curr_Factors:  [9.77749376e+01 3.97701178e-02]
mat_Sqrt:  [[ 1.94987147e+01  0.00000000e+00]
 [-7.97697865e-03  1.82775542e-02]]
grads:  [-3.24083658e-02 -5.18837179e+01]
Stock Position:  -0.03240836581886139
Bond Position:  [10.1153321]


portfolio before change:  [6.96319924]
curr_Stock_Price:  97.34097752965599
curr_Factors:  [9.73409775e+01 4.19002184e-02]
mat_Sqrt:  [[ 1.99252531e+01  0.00000000e+00]
 [-8.18781713e-03  1.87606459e-02]]
grads:  [4.65431162e-03 1.47486605e+01]
Stock Position:  0.004654311624971702
Bond Position:  [6.51014399]


portfolio before change:  [6.96391064]
curr_Stock_Price:  97.14409772194843
curr_Factors:  [9.71440977e+01 4.27529606e-02]
mat_Sqrt:  [[ 2.00862802e+01  0.00000000e+00]
 [-8.27071562e-03  1.89505902e-02]]
grads:  [-0.02218391 -3.37402191]
Stock Position:  -0.022183911026252005
Bond Position:  [9.11894666]


portfolio before change:  [6.99930481]
curr_Stock_Price:  95.65138754800705
curr_Factors:  [9.56513875e+01 4.32357292e-02]
mat_Sqrt:  [[ 1.98889872e+01  0.00000000e+00]
 [-8.31728121e-03  1.90572854e-02]]
grads:  [0.00558471 3.10194588]
Stock Position:  0.005584707754883848
Bond Position:  [6.46511976]


portfolio before change:  [6.99584071]
curr_Stock_Price:  94.7416571935833
curr_Factors:  [9.47416572e+01 4.33964086e-02]
mat_Sqrt:  [[ 1.97363970e+01  0.00000000e+00]
 [-8.33272187e-03  1.90926644e-02]]
grads:  [-0.01050728  3.89731854]
Stock Position:  -0.010507281371144692
Bond Position:  [7.99131796]


portfolio before change:  [6.96835907]
curr_Stock_Price:  97.54730430603772
curr_Factors:  [9.75473043e+01 4.15249998e-02]
mat_Sqrt:  [[ 1.98778812e+01  0.00000000e+00]
 [-8.15107353e-03  1.86764557e-02]]
grads:  [4.43293542e-03 8.72453292e+00]
Stock Position:  0.004432935423898037
Bond Position:  [6.53593817]


portfolio before change:  [6.96599953]
curr_Stock_Price:  96.64638207177096
curr_Factors:  [9.66463821e+01 4.30731477e-02]
mat_Sqrt:  [[ 2.00580591e+01  0.00000000e+00]
 [-8.30162853e-03  1.90214206e-02]]
grads:  [-0.01008502  1.6785566 ]
Stock Position:  -0.010085018987073367
Bond Position:  [7.94068013]


portfolio before change:  [6.96489228]
curr_Stock_Price:  96.95304124612503
curr_Factors:  [9.69530412e+01 4.40581122e-02]
mat_Sqrt:  [[ 2.03504669e+01  0.00000000e+00]
 [-8.39600973e-03  1.92376751e-02]]
grads:  [0.01017877 0.41620989]
Stock Position:  0.010178771745260651
Bond Position:  [5.9780294]


portfolio before change:  [6.98106416]
curr_Stock_Price:  98.39498209701098
curr_Factors:  [9.83949821e+01 4.59013210e-02]
mat_Sqrt:  [[ 2.10807250e+01  0.00000000e+00]
 [-8.56983743e-03  1.96359644e-02]]
grads:  [5.73199395e-04 3.17698966e+00]
Stock Position:  0.0005731993947587375
Bond Position:  [6.92466422]


portfolio before change:  [6.98139326]
curr_Stock_Price:  95.94855971737111
curr_Factors:  [9.59485597e+01 4.90199518e-02]
mat_Sqrt:  [[ 2.12434427e+01  0.00000000e+00]
 [-8.85617993e-03  2.02920574e-02]]
grads:  [-0.0073973   2.23623171]
Stock Position:  -0.007397300770697046
Bond Position:  [7.69115361]


portfolio before change:  [6.99431764]
curr_Stock_Price:  94.46134816880353
curr_Factors:  [9.44613482e+01 5.12334589e-02]
mat_Sqrt:  [[ 2.13811460e+01  0.00000000e+00]
 [-9.05392369e-03  2.07451453e-02]]
grads:  [ 0.00282155 -0.19426782]
Stock Position:  0.002821553050334686
Bond Position:  [6.72778993]


portfolio before change:  [6.99606822]
curr_Stock_Price:  94.48559938614088
curr_Factors:  [9.44855994e+01 5.12534045e-02]
mat_Sqrt:  [[ 2.13907978e+01  0.00000000e+00]
 [-9.05568591e-03  2.07491831e-02]]
grads:  [-3.21652441e-03 -7.02528867e+00]
Stock Position:  -0.003216524405141447
Bond Position:  [7.29998346]


portfolio before change:  [6.99508745]
curr_Stock_Price:  95.35796721168593
curr_Factors:  [9.53579672e+01 5.05992136e-02]
mat_Sqrt:  [[ 2.14500776e+01  0.00000000e+00]
 [-8.99770758e-03  2.06163380e-02]]
grads:  [-0.01266169 -6.47596799]
Stock Position:  -0.012661688949709335
Bond Position:  [8.20248037]


portfolio before change:  [7.01788289]
curr_Stock_Price:  93.71959503954562
curr_Factors:  [9.37195950e+01 5.08483022e-02]
mat_Sqrt:  [[ 2.11333639e+01  0.00000000e+00]
 [-9.01982724e-03  2.06670205e-02]]
grads:  [0.00460826 1.10700239]
Stock Position:  0.004608258636737617
Bond Position:  [6.58599875]


portfolio before change:  [7.02954139]
curr_Stock_Price:  95.89217175132272
curr_Factors:  [9.58921718e+01 4.92967225e-02]
mat_Sqrt:  [[ 2.12908097e+01  0.00000000e+00]
 [-8.88114610e-03  2.03492621e-02]]
grads:  [ 1.01770556e-03 -4.09825062e+00]
Stock Position:  0.0010177055580368889
Bond Position:  [6.93195139]


portfolio before change:  [7.03323461]
curr_Stock_Price:  97.81809189109343
curr_Factors:  [9.78180919e+01 4.90987633e-02]
mat_Sqrt:  [[ 2.16747683e+01  0.00000000e+00]
 [-8.86329630e-03  2.03083631e-02]]
grads:  [  0.02433949 -15.989704  ]
Stock Position:  0.02433949221515264
Bond Position:  [4.65239193]


portfolio before change:  [7.00789789]
curr_Stock_Price:  96.72932788145528
curr_Factors:  [9.67293279e+01 5.21178878e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.00789789]
Stock Price:  96.4538683221445
PL:  [7.00789789]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.77768347e-02  1.14153045e-01]
 [-1.29344177e-01 -5.79017049e-02]
 [-1.36492103e-01 -3.91875679e-01]
 [ 1.93303450e-01 -2.92221615e-02]
 [-3.43863357e-01 -1.06521139e-01]
 [ 3.33147367e-01 -3.90199950e-01]
 [-5.95834094e-01  4.81323597e-01]
 [ 3.82054871e-01  1.62699222e-01]
 [ 1.77856598e-01 -1.50793144e-01]
 [-2.68072202e-02  2.56408148e-02]
 [ 2.66822822e-01  4.00109698e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.52823697e-01  1.61869668e-01]
 [-2.11731593e-01  5.95874699e-02]
 [ 2.09945568e-01  1.77968454e-01]
 [ 8.28089558e-02  2.28016926e-02]
 [-5.27231953e-02  1.88899417e-01]
 [ 1.43166317e-01  1.16423782e-02]
 [-1.25737306e-02 -1.57375599e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.58308822]
curr_Stock_Price:  100.5762612246353
curr_Factors:  [1.00576261e+02 3.78300469e-02]
mat_Sqrt:  [[ 1.95620303e+01  0.00000000e+00]
 [-7.77997911e-03  1.78261716e-02]]
grads:  [-1.42911348e-03  6.40367702e+00]
Stock Position:  -0.0014291134824960623
Bond Position:  [6.72682311]


portfolio before change:  [6.58376344]
curr_Stock_Price:  101.2806803695335
curr_Factors:  [1.01280680e+02 3.69108658e-02]
mat_Sqrt:  [[ 1.94582476e+01  0.00000000e+00]
 [-7.68488030e-03  1.76082728e-02]]
grads:  [-0.00794596 -3.28832393]
Stock Position:  -0.007945964913858794
Bond Position:  [7.38853618]


portfolio before change:  [6.5789174]
curr_Stock_Price:  102.12304657680203
curr_Factors:  [1.02123047e+02 3.60286489e-02]
mat_Sqrt:  [[ 1.93841941e+01  0.00000000e+00]
 [-7.59248564e-03  1.73965701e-02]]
grads:  [-1.58645064e-02 -2.25260311e+01]
Stock Position:  -0.015864506368980957
Bond Position:  [8.19904912]


portfolio before change:  [6.58784006]
curr_Stock_Price:  101.68983792924837
curr_Factors:  [1.01689838e+02 3.74503421e-02]
mat_Sqrt:  [[ 1.96791098e+01  0.00000000e+00]
 [-7.74083635e-03  1.77364843e-02]]
grads:  [ 0.0091747 -1.6475735]
Stock Position:  0.009174696141556618
Bond Position:  [5.65486669]


portfolio before change:  [6.57734394]
curr_Stock_Price:  100.3917015923305
curr_Factors:  [1.00391702e+02 3.91932775e-02]
mat_Sqrt:  [[ 1.98748384e+01  0.00000000e+00]
 [-7.91891684e-03  1.81445179e-02]]
grads:  [-0.01964056 -5.87070646]
Stock Position:  -0.01964056184132374
Bond Position:  [8.54909337]


portfolio before change:  [6.5895171]
curr_Stock_Price:  99.88073771778944
curr_Factors:  [9.98807377e+01 3.95524072e-02]
mat_Sqrt:  [[ 1.98640684e+01  0.00000000e+00]
 [-7.95511480e-03  1.82274579e-02]]
grads:  [ 8.19822730e-03 -2.14072611e+01]
Stock Position:  0.008198227299663748
Bond Position:  [5.77067211]


portfolio before change:  [6.62410251]
curr_Stock_Price:  103.92338702157848
curr_Factors:  [1.03923387e+02 3.78691625e-02]
mat_Sqrt:  [[ 2.02234918e+01  0.00000000e+00]
 [-7.78400025e-03  1.78353852e-02]]
grads:  [-1.90752051e-02  2.69870032e+01]
Stock Position:  -0.019075205149426414
Bond Position:  [8.60646243]


portfolio before change:  [6.64578758]
curr_Stock_Price:  102.89937759839226
curr_Factors:  [1.02899378e+02 3.76305234e-02]
mat_Sqrt:  [[ 1.99610268e+01  0.00000000e+00]
 [-7.75943538e-03  1.77791000e-02]]
grads:  [0.02269736 9.15115061]
Stock Position:  0.022697361118065983
Bond Position:  [4.31024325]


portfolio before change:  [6.71285443]
curr_Stock_Price:  105.80672675262488
curr_Factors:  [1.05806727e+02 3.48372917e-02]
mat_Sqrt:  [[ 1.97485617e+01  0.00000000e+00]
 [-7.46590027e-03  1.71065266e-02]]
grads:  [ 5.67358150e-03 -8.81494814e+00]
Stock Position:  0.005673581503409914
Bond Position:  [6.11255134]


portfolio before change:  [6.71923182]
curr_Stock_Price:  106.66140065027203
curr_Factors:  [1.06661401e+02 3.40898825e-02]
mat_Sqrt:  [[ 1.96933697e+01  0.00000000e+00]
 [-7.38537826e-03  1.69220274e-02]]
grads:  [-7.92990302e-04  1.51523302e+00]
Stock Position:  -0.0007929903023733389
Bond Position:  [6.80381328]


portfolio before change:  [6.72144905]
curr_Stock_Price:  106.01062069879744
curr_Factors:  [1.06010621e+02 3.45896407e-02]
mat_Sqrt:  [[ 1.97161631e+01  0.00000000e+00]
 [-7.43931618e-03  1.70456147e-02]]
grads:  [2.23900060e-02 2.34728817e+01]
Stock Position:  0.022390005967017224
Bond Position:  [4.34787062]


portfolio before change:  [6.72278951]
curr_Stock_Price:  106.02193621832325
curr_Factors:  [1.06021936e+02 3.42322638e-02]
mat_Sqrt:  [[ 1.96161395e+01  0.00000000e+00]
 [-7.40078523e-03  1.69573293e-02]]
grads:  [-0.00963533  6.7424016 ]
Stock Position:  -0.009635329312311149
Bond Position:  [7.74434578]


portfolio before change:  [6.69118136]
curr_Stock_Price:  109.50334083160101
curr_Factors:  [1.09503341e+02 3.28454012e-02]
mat_Sqrt:  [[ 1.98456193e+01  0.00000000e+00]
 [-7.24932011e-03  1.66102791e-02]]
grads:  [-4.14086256e-03  9.74515042e+00]
Stock Position:  -0.004140862563295299
Bond Position:  [7.14461964]


portfolio before change:  [6.69489658]
curr_Stock_Price:  109.03753285884183
curr_Factors:  [1.09037533e+02 3.41190792e-02]
mat_Sqrt:  [[ 2.01407050e+01  0.00000000e+00]
 [-7.38854023e-03  1.69292724e-02]]
grads:  [-0.0092214   3.51978917]
Stock Position:  -0.009221399605121423
Bond Position:  [7.70037524]


portfolio before change:  [6.72143153]
curr_Stock_Price:  106.3687819658399
curr_Factors:  [1.06368782e+02 3.46425065e-02]
mat_Sqrt:  [[ 1.97978869e+01  0.00000000e+00]
 [-7.44499902e-03  1.70586358e-02]]
grads:  [ 0.01452768 10.43274836]
Stock Position:  0.014527680149325258
Bond Position:  [5.17613989]


portfolio before change:  [6.75248255]
curr_Stock_Price:  108.4170661953394
curr_Factors:  [1.08417066e+02 3.35176519e-02]
mat_Sqrt:  [[ 1.98488086e+01  0.00000000e+00]
 [-7.32313068e-03  1.67794003e-02]]
grads:  [0.00467335 1.35890986]
Stock Position:  0.004673350034299158
Bond Position:  [6.24581165]


portfolio before change:  [6.7458321]
curr_Stock_Price:  106.65984677454571
curr_Factors:  [1.06659847e+02 3.26518617e-02]
mat_Sqrt:  [[ 1.92732489e+01  0.00000000e+00]
 [-7.22793046e-03  1.65612692e-02]]
grads:  [1.54199582e-03 1.14060954e+01]
Stock Position:  0.0015419958248229838
Bond Position:  [6.58136306]


portfolio before change:  [6.74763292]
curr_Stock_Price:  106.76054874183174
curr_Factors:  [1.06760549e+02 3.33578636e-02]
mat_Sqrt:  [[ 1.94988910e+01  0.00000000e+00]
 [-7.30565410e-03  1.67393564e-02]]
grads:  [0.00760287 0.6955093 ]
Stock Position:  0.007602866606236725
Bond Position:  [5.93594671]


portfolio before change:  [6.75657915]
curr_Stock_Price:  107.74202716103709
curr_Factors:  [1.07742027e+02 3.42345068e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.75657915]
Stock Price:  107.37602827124662
PL:  [-0.61944913]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.54622798e-01 -5.15578829e-01]
 [ 1.29444343e-01  7.01036820e-02]
 [-1.82687066e-01 -8.63289264e-02]
 [ 7.08320862e-01 -9.72253670e-01]
 [-6.04580623e-01  5.02901337e-01]
 [ 2.65394312e-01  1.53535637e-01]
 [-1.66719516e-01 -4.19009709e-02]
 [ 2.99394681e-01  4.61430345e-03]
 [ 9.67336040e-02  1.65257660e-01]
 [-2.38386181e-01  1.04180226e-01]
 [-1.05380887e-02  3.93657029e-02]
 [-2.00204844e-01 -2.64676590e-01]
 [-1.36048688e-01 -1.42271013e-01]
 [ 8.84542797e-02  6.84384017e-02]
 [ 5.82545794e-02 -8.34303490e-02]
 [ 1.06883831e+00 -4.90539320e-01]
 [ 1.74775543e-01  2.15134091e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.90750854]
curr_Stock_Price:  99.3438231701301
curr_Factors:  [9.93438232e+01 4.27953115e-02]
mat_Sqrt:  [[ 2.05512842e+01  0.00000000e+00]
 [-8.27481108e-03  1.89599741e-02]]
grads:  [ 0.0013562  -0.07124663]
Stock Position:  0.0013561963966022906
Bond Position:  [-2.04223827]


portfolio before change:  [-1.90605472]
curr_Stock_Price:  100.79231812774523
curr_Factors:  [1.00792318e+02 4.05890575e-02]
mat_Sqrt:  [[ 2.03063523e+01  0.00000000e+00]
 [-8.05869046e-03  1.84647795e-02]]
grads:  [-0.00917569 -3.60968134]
Stock Position:  -0.009175693756331336
Bond Position:  [-0.98121528]


portfolio before change:  [-1.90938753]
curr_Stock_Price:  101.12880224039976
curr_Factors:  [1.01128802e+02 4.14542030e-02]
mat_Sqrt:  [[ 2.05901328e+01  0.00000000e+00]
 [-8.14412210e-03  1.86605280e-02]]
grads:  [-1.84379503e-02 -2.76293805e+01]
Stock Position:  -0.018437950329095464
Bond Position:  [-0.0447797]


portfolio before change:  [-1.90504058]
curr_Stock_Price:  100.89243400843053
curr_Factors:  [1.00892434e+02 4.25446930e-02]
mat_Sqrt:  [[ 2.08104416e+01  0.00000000e+00]
 [-8.25054597e-03  1.89043757e-02]]
grads:  [0.00769037 3.70833097]
Stock Position:  0.007690374915174539
Bond Position:  [-2.68094122]


portfolio before change:  [-1.8963412]
curr_Stock_Price:  102.11080051953763
curr_Factors:  [1.02110801e+02 4.00725798e-02]
mat_Sqrt:  [[ 2.04406797e+01  0.00000000e+00]
 [-8.00725469e-03  1.83469254e-02]]
grads:  [-0.01078066 -4.70536205]
Stock Position:  -0.010780663935791551
Bond Position:  [-0.79551898]


portfolio before change:  [-1.92124289]
curr_Stock_Price:  104.40219783721368
curr_Factors:  [1.04402198e+02 3.98247274e-02]
mat_Sqrt:  [[ 2.08346422e+01  0.00000000e+00]
 [-7.98245350e-03  1.82900987e-02]]
grads:  [ 1.36308831e-02 -5.31573769e+01]
Stock Position:  0.013630883071764946
Bond Position:  [-3.34433704]


portfolio before change:  [-1.9246163]
curr_Stock_Price:  104.21606027962065
curr_Factors:  [1.04216060e+02 4.05361395e-02]
mat_Sqrt:  [[ 2.09824330e+01  0.00000000e+00]
 [-8.05343550e-03  1.84527389e-02]]
grads:  [-1.83532809e-02  2.72534793e+01]
Stock Position:  -0.01835328088630886
Bond Position:  [-0.01190967]


portfolio before change:  [-1.87916824]
curr_Stock_Price:  101.7396072091948
curr_Factors:  [1.01739607e+02 4.43012678e-02]
mat_Sqrt:  [[ 2.14140165e+01  0.00000000e+00]
 [-8.41914654e-03  1.92906881e-02]]
grads:  [0.01552267 7.95905444]
Stock Position:  0.015522672142864643
Bond Position:  [-3.45843881]


portfolio before change:  [-1.88310997]
curr_Stock_Price:  101.54138023406105
curr_Factors:  [1.01541380e+02 4.39315861e-02]
mat_Sqrt:  [[ 2.12829343e+01  0.00000000e+00]
 [-8.38394523e-03  1.92100318e-02]]
grads:  [-0.00869272 -2.18120257]
Stock Position:  -0.008692720488613599
Bond Position:  [-1.00043913]


portfolio before change:  [-1.87073881]
curr_Stock_Price:  100.08944091855594
curr_Factors:  [1.00089441e+02 4.59627232e-02]
mat_Sqrt:  [[ 2.14580938e+01  0.00000000e+00]
 [-8.57556745e-03  1.96490935e-02]]
grads:  [0.01404638 0.23483544]
Stock Position:  0.014046379469948621
Bond Position:  [-3.27663308]


portfolio before change:  [-1.8668024]
curr_Stock_Price:  100.42801021342892
curr_Factors:  [1.00428010e+02 4.60449317e-02]
mat_Sqrt:  [[ 2.15499256e+01  0.00000000e+00]
 [-8.58323311e-03  1.96666577e-02]]
grads:  [7.83566325e-03 8.40293568e+00]
Stock Position:  0.00783566324862656
Bond Position:  [-2.65372246]


portfolio before change:  [-1.8529394]
curr_Stock_Price:  102.28190707094356
curr_Factors:  [1.02281907e+02 4.30988283e-02]
mat_Sqrt:  [[ 2.12339871e+01  0.00000000e+00]
 [-8.30410292e-03  1.90270901e-02]]
grads:  [-0.00908535  5.47536303]
Stock Position:  -0.00908534990641654
Bond Position:  [-0.92367248]


portfolio before change:  [-1.8407904]
curr_Stock_Price:  100.91928023659494
curr_Factors:  [1.00919280e+02 4.37829069e-02]
mat_Sqrt:  [[ 2.11167190e+01  0.00000000e+00]
 [-8.36974618e-03  1.91774977e-02]]
grads:  [3.14561772e-04 2.05270278e+00]
Stock Position:  0.00031456177166600815
Bond Position:  [-1.87253575]


portfolio before change:  [-1.84172496]
curr_Stock_Price:  99.43670494706987
curr_Factors:  [9.94367049e+01 4.33853932e-02]
mat_Sqrt:  [[ 2.07118310e+01  0.00000000e+00]
 [-8.33166424e-03  1.90902410e-02]]
grads:  [ -0.01524342 -13.86449704]
Stock Position:  -0.015243421927272367
Bond Position:  [-0.32596931]


portfolio before change:  [-1.80721905]
curr_Stock_Price:  97.16769934120924
curr_Factors:  [9.71676993e+01 4.38372016e-02]
mat_Sqrt:  [[ 2.03443272e+01  0.00000000e+00]
 [-8.37493418e-03  1.91893849e-02]]
grads:  [-0.00973937 -7.41404758]
Stock Position:  -0.009739366025178144
Bond Position:  [-0.86086726]


portfolio before change:  [-1.80900587]
curr_Stock_Price:  97.32906288414839
curr_Factors:  [9.73290629e+01 4.41582656e-02]
mat_Sqrt:  [[ 2.04526010e+01  0.00000000e+00]
 [-8.40554728e-03  1.92595283e-02]]
grads:  [0.00578524 3.55348275]
Stock Position:  0.00578524203660086
Bond Position:  [-2.37207806]


portfolio before change:  [-1.81811605]
curr_Stock_Price:  95.85685420717796
curr_Factors:  [9.58568542e+01 4.27504823e-02]
mat_Sqrt:  [[ 1.98195451e+01  0.00000000e+00]
 [-8.27047590e-03  1.89500409e-02]]
grads:  [ 1.10207322e-03 -4.40264743e+00]
Stock Position:  0.0011020732224198576
Bond Position:  [-1.92375732]


portfolio before change:  [-1.82109576]
curr_Stock_Price:  93.58956970551503
curr_Factors:  [9.35895697e+01 4.33711118e-02]
mat_Sqrt:  [[ 1.94907131e+01  0.00000000e+00]
 [-8.33029284e-03  1.90870988e-02]]
grads:  [  0.04385419 -25.70004622]
Stock Position:  0.043854188327442874
Bond Position:  [-5.92539038]


portfolio before change:  [-1.90459355]
curr_Stock_Price:  91.71936622714627
curr_Factors:  [9.17193662e+01 4.47870205e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.90459355]
Stock Price:  89.88894640735006
PL:  [-1.90459355]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.04248862e-01  6.02836475e-02]
 [ 1.36950580e-01 -2.42126809e-02]
 [-1.53889892e-01 -5.10578314e-01]
 [ 4.26574472e-01 -4.19838522e-01]
 [-8.66153168e-02 -5.62481041e-02]
 [ 8.69275018e-01 -1.22129960e+00]
 [-6.47186649e-01  6.63767128e-01]
 [ 6.84093488e-01  1.86424091e-01]
 [ 3.12694202e-01 -2.05371960e-01]
 [-1.85719955e-01  3.42520532e-02]
 [ 3.42901948e-01  5.21568676e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-8.43352966e-02  1.11273464e-01]
 [-2.79478829e-01 -1.72456991e-01]
 [ 2.07158607e-01  1.69397718e-01]
 [ 8.48431562e-02  2.08649278e-02]
 [-5.34063313e-02  2.08410274e-01]
 [ 1.09253768e-01  1.22648991e-01]
 [-4.60503683e-02 -2.48877952e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.07410876]
curr_Stock_Price:  100.21207460070187
curr_Factors:  [1.00212075e+02 3.77758676e-02]
mat_Sqrt:  [[ 1.94772338e+01  0.00000000e+00]
 [-7.77440597e-03  1.78134019e-02]]
grads:  [-0.00400154  3.38417377]
Stock Position:  -0.004001539568752219
Bond Position:  [4.47511134]


portfolio before change:  [4.06561107]
curr_Stock_Price:  102.6153016015359
curr_Factors:  [1.02615302e+02 3.63946160e-02]
mat_Sqrt:  [[ 1.95763038e+01  0.00000000e+00]
 [-7.63094920e-03  1.74847012e-02]]
grads:  [ 0.00645593 -1.38479238]
Stock Position:  0.006455932656085496
Bond Position:  [3.40313359]


portfolio before change:  [4.05703083]
curr_Stock_Price:  101.15445431422903
curr_Factors:  [1.01154454e+02 3.86595535e-02]
mat_Sqrt:  [[ 1.98890220e+01  0.00000000e+00]
 [-7.86481313e-03  1.80205508e-02]]
grads:  [-1.89413304e-02 -2.83331137e+01]
Stock Position:  -0.018941330353451566
Bond Position:  [5.97303076]


portfolio before change:  [3.9548604]
curr_Stock_Price:  106.62734721845621
curr_Factors:  [1.06627347e+02 3.65078935e-02]
mat_Sqrt:  [[ 2.03733287e+01  0.00000000e+00]
 [-7.64281555e-03  1.75118904e-02]]
grads:  [ 1.19441414e-02 -2.39744832e+01]
Stock Position:  0.011944141415272514
Bond Position:  [2.68128828]


portfolio before change:  [3.95899125]
curr_Stock_Price:  106.91706670143293
curr_Factors:  [1.06917067e+02 3.95894751e-02]
mat_Sqrt:  [[ 2.12734001e+01  0.00000000e+00]
 [-7.95884164e-03  1.82359971e-02]]
grads:  [-0.00522549 -3.08445454]
Stock Position:  -0.005225492952907088
Bond Position:  [4.51768563]


portfolio before change:  [3.96374743]
curr_Stock_Price:  106.22304421379356
curr_Factors:  [1.06223044e+02 4.13343072e-02]
mat_Sqrt:  [[ 2.15960376e+01  0.00000000e+00]
 [-8.13233617e-03  1.86335230e-02]]
grads:  [ 1.55702718e-02 -6.55431394e+01]
Stock Position:  0.015570271754149352
Bond Position:  [2.30982576]


portfolio before change:  [3.97018124]
curr_Stock_Price:  106.59916397393808
curr_Factors:  [1.06599164e+02 4.13215723e-02]
mat_Sqrt:  [[ 2.16691670e+01  0.00000000e+00]
 [-8.13108330e-03  1.86306524e-02]]
grads:  [-1.64978618e-02  3.56276912e+01]
Stock Position:  -0.01649786183549933
Bond Position:  [5.72883952]


portfolio before change:  [3.98266148]
curr_Stock_Price:  105.92951053360366
curr_Factors:  [1.05929511e+02 4.10316454e-02]
mat_Sqrt:  [[ 2.14573671e+01  0.00000000e+00]
 [-8.10250780e-03  1.85651777e-02]]
grads:  [ 0.03567332 10.04160014]
Stock Position:  0.03567332497448527
Bond Position:  [0.20380363]


portfolio before change:  [4.05956774]
curr_Stock_Price:  108.08393001234319
curr_Factors:  [1.08083930e+02 4.24816333e-02]
mat_Sqrt:  [[ 2.22772578e+01  0.00000000e+00]
 [-8.24442923e-03  1.88903605e-02]]
grads:  [ 1.00130156e-02 -1.08717861e+01]
Stock Position:  0.010013015619512755
Bond Position:  [2.97732166]


portfolio before change:  [4.07382001]
curr_Stock_Price:  109.4329585440297
curr_Factors:  [1.09432959e+02 4.03533577e-02]
mat_Sqrt:  [[ 2.19830516e+01  0.00000000e+00]
 [-8.03525808e-03  1.84110892e-02]]
grads:  [-0.00776831  1.86040342]
Stock Position:  -0.007768308811226853
Bond Position:  [4.92392903]


portfolio before change:  [4.082435]
curr_Stock_Price:  108.48244838941669
curr_Factors:  [1.08482448e+02 4.08299477e-02]
mat_Sqrt:  [[ 2.19204210e+01  0.00000000e+00]
 [-8.08256868e-03  1.85194914e-02]]
grads:  [2.60274737e-02 2.81632289e+01]
Stock Position:  0.026027473683321662
Bond Position:  [1.25891093]


portfolio before change:  [4.04262032]
curr_Stock_Price:  106.94063709288467
curr_Factors:  [1.06940637e+02 3.91208896e-02]
mat_Sqrt:  [[ 2.11517901e+01  0.00000000e+00]
 [-7.91160056e-03  1.81277542e-02]]
grads:  [-0.00893579  6.30707602]
Stock Position:  -0.00893579044211468
Bond Position:  [4.99821944]


portfolio before change:  [4.04999799]
curr_Stock_Price:  106.25485931438736
curr_Factors:  [1.06254859e+02 4.01547983e-02]
mat_Sqrt:  [[ 2.12920523e+01  0.00000000e+00]
 [-8.01546489e-03  1.83657373e-02]]
grads:  [-1.68004356e-03  6.05875291e+00]
Stock Position:  -0.0016800435598594797
Bond Position:  [4.22851079]


portfolio before change:  [4.0520942]
curr_Stock_Price:  105.63645674521969
curr_Factors:  [1.05636457e+02 4.15574154e-02]
mat_Sqrt:  [[ 2.15346635e+01  0.00000000e+00]
 [-8.15425439e-03  1.86837440e-02]]
grads:  [-0.01647322 -9.23032293]
Stock Position:  -0.01647321909708506
Bond Position:  [5.79226669]


portfolio before change:  [4.04436331]
curr_Stock_Price:  106.19367214678157
curr_Factors:  [1.06193672e+02 4.15460476e-02]
mat_Sqrt:  [[ 2.16452944e+01  0.00000000e+00]
 [-8.15313904e-03  1.86811884e-02]]
grads:  [0.01298619 9.06782346]
Stock Position:  0.012986186636615122
Bond Position:  [2.66531247]


portfolio before change:  [4.07328325]
curr_Stock_Price:  108.36933189022898
curr_Factors:  [1.08369332e+02 4.05733981e-02]
mat_Sqrt:  [[ 2.18286605e+01  0.00000000e+00]
 [-8.05713578e-03  1.84612173e-02]]
grads:  [0.00430395 1.13020325]
Stock Position:  0.004303945132473028
Bond Position:  [3.60686759]


portfolio before change:  [4.06892559]
curr_Stock_Price:  107.14731702934746
curr_Factors:  [1.07147317e+02 4.26821239e-02]
mat_Sqrt:  [[ 2.21362633e+01  0.00000000e+00]
 [-8.26386098e-03  1.89348842e-02]]
grads:  [1.69637345e-03 1.10066833e+01]
Stock Position:  0.0016963734532867735
Bond Position:  [3.88716373]


portfolio before change:  [4.0723441]
curr_Stock_Price:  108.58956926010752
curr_Factors:  [1.08589569e+02 4.20652171e-02]
mat_Sqrt:  [[ 2.22715107e+01  0.00000000e+00]
 [-8.20392268e-03  1.87975483e-02]]
grads:  [0.00730899 6.5247334 ]
Stock Position:  0.0073089867231023575
Bond Position:  [3.27866438]


portfolio before change:  [4.08369067]
curr_Stock_Price:  110.02982280223335
curr_Factors:  [1.10029823e+02 3.98852749e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.08369067]
Stock Price:  109.46742778633683
PL:  [-5.38373712]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-6.37531618e-02  1.35227222e-01]
 [-1.56253073e-01 -6.63437364e-02]
 [-1.62048201e-01 -5.66241297e-01]
 [ 2.26970597e-02  2.40856767e-01]
 [-4.16994844e-01 -6.60715526e-02]
 [-2.37513666e-02  1.16099952e-01]
 [-3.13281005e-01  1.14673528e-01]
 [ 2.12818930e-02  1.57542726e-01]
 [-2.26890597e-01  7.35009847e-02]
 [ 1.24335160e-01  1.29768369e-02]
 [-9.83273747e-02 -2.56321554e-02]
 [-8.34301417e-02 -1.01375750e-02]
 [ 2.86989964e-01 -4.29803512e-02]
 [-8.31251102e-03 -1.50413197e-01]
 [-2.19091054e-01 -1.32233774e-01]
 [ 8.77421544e-02  3.67100684e-02]
 [ 5.78293756e-02 -8.33541767e-02]
 [ 9.18007398e-01 -4.28052958e-01]
 [ 1.50057150e-01  1.58852032e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.59849729]
curr_Stock_Price:  100.72365119172476
curr_Factors:  [1.00723651e+02 4.12930496e-02]
mat_Sqrt:  [[ 2.04677423e+01  0.00000000e+00]
 [-8.12827653e-03  1.86242212e-02]]
grads:  [-2.31347634e-04  7.26082557e+00]
Stock Position:  -0.00023134763407912218
Bond Position:  [7.62179947]


portfolio before change:  [7.60034529]
curr_Stock_Price:  100.97299044903751
curr_Factors:  [1.00972990e+02 4.08066971e-02]
mat_Sqrt:  [[ 2.03972181e+01  0.00000000e+00]
 [-8.08026703e-03  1.85142177e-02]]
grads:  [-0.00908005 -3.583394  ]
Stock Position:  -0.009080054560873732
Bond Position:  [8.51718556]


portfolio before change:  [7.60487814]
curr_Stock_Price:  100.70831335026966
curr_Factors:  [1.00708313e+02 4.13207954e-02]
mat_Sqrt:  [[ 2.04714997e+01  0.00000000e+00]
 [-8.13100687e-03  1.86304772e-02]]
grads:  [-1.99876008e-02 -3.03932793e+01]
Stock Position:  -0.01998760078419998
Bond Position:  [9.6177957]


portfolio before change:  [7.63030303]
curr_Stock_Price:  99.55659224632541
curr_Factors:  [9.95565922e+01 4.19482875e-02]
mat_Sqrt:  [[ 2.03904655e+01  0.00000000e+00]
 [-8.19251243e-03  1.87714042e-02]]
grads:  [6.26839886e-03 1.28310469e+01]
Stock Position:  0.0062683988631868125
Bond Position:  [7.0062426]


portfolio before change:  [7.61774237]
curr_Stock_Price:  97.27332300166549
curr_Factors:  [9.72733230e+01 4.42774421e-02]
mat_Sqrt:  [[ 2.04684527e+01  0.00000000e+00]
 [-8.41688228e-03  1.92855001e-02]]
grads:  [-0.02178136 -3.42597041]
Stock Position:  -0.021781364699612126
Bond Position:  [9.73648809]


portfolio before change:  [7.64297555]
curr_Stock_Price:  96.22661389228624
curr_Factors:  [9.62266139e+01 4.64163053e-02]
mat_Sqrt:  [[ 2.07314886e+01  0.00000000e+00]
 [-8.61777747e-03  1.97458088e-02]]
grads:  [1.29845025e-03 5.87972634e+00]
Stock Position:  0.0012984502505796933
Bond Position:  [7.51803008]


portfolio before change:  [7.64513417]
curr_Stock_Price:  96.44139377663686
curr_Factors:  [9.64413938e+01 4.55198551e-02]
mat_Sqrt:  [[ 2.05761404e+01  0.00000000e+00]
 [-8.53415305e-03  1.95542012e-02]]
grads:  [-0.01279314  5.86439339]
Stock Position:  -0.012793136595037887
Bond Position:  [8.87892209]


portfolio before change:  [7.64253682]
curr_Stock_Price:  96.81795178450692
curr_Factors:  [9.68179518e+01 4.53217674e-02]
mat_Sqrt:  [[ 2.06114863e+01  0.00000000e+00]
 [-8.51556386e-03  1.95116080e-02]]
grads:  [4.36839802e-03 8.07430770e+00]
Stock Position:  0.0043683980181379815
Bond Position:  [7.21959747]


portfolio before change:  [7.63855105]
curr_Stock_Price:  95.49231730417148
curr_Factors:  [9.54923173e+01 4.49865822e-02]
mat_Sqrt:  [[ 2.02539593e+01  0.00000000e+00]
 [-8.48401623e-03  1.94393233e-02]]
grads:  [-0.00961847  3.78104647]
Stock Position:  -0.009618471861033168
Bond Position:  [8.55704121]


portfolio before change:  [7.65257635]
curr_Stock_Price:  94.25659353558454
curr_Factors:  [9.42565935e+01 4.68129951e-02]
mat_Sqrt:  [[ 2.03936496e+01  0.00000000e+00]
 [-8.65452437e-03  1.98300065e-02]]
grads:  [0.00637447 0.65440407]
Stock Position:  0.006374470413709193
Bond Position:  [7.05174048]


portfolio before change:  [7.64263082]
curr_Stock_Price:  92.4197851829534
curr_Factors:  [9.24197852e+01 4.91974622e-02]
mat_Sqrt:  [[ 2.04991713e+01  0.00000000e+00]
 [-8.87220037e-03  2.03287649e-02]]
grads:  [-0.00534237 -1.2608811 ]
Stock Position:  -0.005342370320950416
Bond Position:  [8.13637154]


portfolio before change:  [7.64392596]
curr_Stock_Price:  92.55815226452071
curr_Factors:  [9.25581523e+01 4.87395555e-02]
mat_Sqrt:  [[ 2.04340974e+01  0.00000000e+00]
 [-8.83081473e-03  2.02339385e-02]]
grads:  [-0.00429941 -0.50101838]
Stock Position:  -0.00429940900132133
Bond Position:  [8.04187132]


portfolio before change:  [7.65036883]
curr_Stock_Price:  91.52727732747448
curr_Factors:  [9.15272773e+01 5.18294643e-02]
mat_Sqrt:  [[ 2.08371781e+01  0.00000000e+00]
 [-9.10643415e-03  2.08654619e-02]]
grads:  [ 0.01287275 -2.05988017]
Stock Position:  0.0128727508052371
Bond Position:  [6.472161]


portfolio before change:  [7.69095319]
curr_Stock_Price:  94.5543001530052
curr_Factors:  [9.45543002e+01 4.98491028e-02]
mat_Sqrt:  [[ 2.11110560e+01  0.00000000e+00]
 [-8.93076505e-03  2.04629534e-02]]
grads:  [-3.50329288e-03 -7.35051261e+00]
Stock Position:  -0.0035032928804381125
Bond Position:  [8.02220459]


portfolio before change:  [7.69058776]
curr_Stock_Price:  95.231156683412
curr_Factors:  [9.52311567e+01 4.95189088e-02]
mat_Sqrt:  [[ 2.11916412e+01  0.00000000e+00]
 [-8.90113780e-03  2.03950689e-02]]
grads:  [-0.01306188 -6.48361499]
Stock Position:  -0.013061876684515486
Bond Position:  [8.93448539]


portfolio before change:  [7.69818435]
curr_Stock_Price:  94.82059667467257
curr_Factors:  [9.48205967e+01 4.83029778e-02]
mat_Sqrt:  [[ 2.08396124e+01  0.00000000e+00]
 [-8.79117538e-03  2.01431133e-02]]
grads:  [0.00497916 1.82246249]
Stock Position:  0.004979158916973877
Bond Position:  [7.22605753]


portfolio before change:  [7.70565128]
curr_Stock_Price:  95.95737368280122
curr_Factors:  [9.59573737e+01 4.92313919e-02]
mat_Sqrt:  [[ 2.12911643e+01  0.00000000e+00]
 [-8.87525927e-03  2.03357737e-02]]
grads:  [ 1.00748978e-03 -4.09889380e+00]
Stock Position:  0.0010074897816034294
Bond Position:  [7.60897521]


portfolio before change:  [7.70676987]
curr_Stock_Price:  95.17931314466661
curr_Factors:  [9.51793131e+01 4.91426700e-02]
mat_Sqrt:  [[ 2.10994892e+01  0.00000000e+00]
 [-8.86725843e-03  2.03174415e-02]]
grads:  [  0.03465438 -21.06825107]
Stock Position:  0.03465438262610193
Bond Position:  [4.40838954]


portfolio before change:  [7.71331903]
curr_Stock_Price:  95.33649149759475
curr_Factors:  [9.53364915e+01 4.90316944e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.71331903]
Stock Price:  95.10889880629767
PL:  [7.71331903]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.79347533e-02  2.04081168e-01]
 [ 1.77477914e-01 -2.09974249e-02]
 [-8.30599671e-02 -2.73158222e-02]
 [ 4.26445597e-01 -4.19622719e-01]
 [-8.49076657e-02 -6.80261671e-02]
 [ 6.06754416e-01 -8.15074902e-01]
 [-5.90787006e-01  4.80209866e-01]
 [ 7.29417782e-01  1.89984274e-01]
 [ 2.57539698e-01 -1.94595619e-01]
 [-7.60918562e-02  2.83137181e-02]
 [ 4.01580926e-01  6.15248624e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.32412922e-01  1.46791089e-01]
 [-2.42081726e-01 -4.43662940e-02]
 [ 2.24062078e-01  2.21498426e-01]
 [ 4.41419805e-02  5.96165689e-02]
 [-5.39087815e-02  4.20091656e-01]
 [ 1.57449343e-01  1.78609981e-01]
 [-3.65454653e-02 -2.53807063e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.87223225]
curr_Stock_Price:  101.19884459177587
curr_Factors:  [1.01198845e+02 3.95467612e-02]
mat_Sqrt:  [[ 2.01247741e+01  0.00000000e+00]
 [-7.95454699e-03  1.82261569e-02]]
grads:  [3.53462703e-03 1.11971586e+01]
Stock Position:  0.0035346270327539773
Bond Position:  [10.51453208]


portfolio before change:  [10.88240607]
curr_Stock_Price:  103.33340095479406
curr_Factors:  [1.03333401e+02 3.73051406e-02]
mat_Sqrt:  [[ 1.99583697e+01  0.00000000e+00]
 [-7.72581549e-03  1.77020671e-02]]
grads:  [ 0.00843325 -1.18615666]
Stock Position:  0.008433248255250669
Bond Position:  [10.01096985]


portfolio before change:  [10.90018887]
curr_Stock_Price:  105.14524634283764
curr_Factors:  [1.05145246e+02 3.63548385e-02]
mat_Sqrt:  [[ 2.00479861e+01  0.00000000e+00]
 [-7.62677793e-03  1.74751436e-02]]
grads:  [-0.00473771 -1.56312433]
Stock Position:  -0.004737711242987192
Bond Position:  [11.39833668]


portfolio before change:  [10.89602821]
curr_Stock_Price:  106.6249891579749
curr_Factors:  [1.06624989e+02 3.49911393e-02]
mat_Sqrt:  [[ 1.99451837e+01  0.00000000e+00]
 [-7.48236746e-03  1.71442576e-02]]
grads:  [ 1.21987960e-02 -2.44759923e+01]
Stock Position:  0.012198796034509617
Bond Position:  [9.59533172]


portfolio before change:  [10.87358292]
curr_Stock_Price:  104.58835960961069
curr_Factors:  [1.04588360e+02 3.41172719e-02]
mat_Sqrt:  [[ 1.93183709e+01  0.00000000e+00]
 [-7.38834454e-03  1.69288240e-02]]
grads:  [-0.00593201 -4.01836341]
Stock Position:  -0.0059320074010832625
Bond Position:  [11.49400184]


portfolio before change:  [10.88427633]
curr_Stock_Price:  103.27016263190666
curr_Factors:  [1.03270163e+02 3.38021642e-02]
mat_Sqrt:  [[ 1.89865962e+01  0.00000000e+00]
 [-7.35414596e-03  1.68504653e-02]]
grads:  [ 1.32212515e-02 -4.83710622e+01]
Stock Position:  0.01322125154063104
Bond Position:  [9.51891554]


portfolio before change:  [10.89563391]
curr_Stock_Price:  103.94918720428343
curr_Factors:  [1.03949187e+02 3.38482722e-02]
mat_Sqrt:  [[ 1.91244674e+01  0.00000000e+00]
 [-7.35915997e-03  1.68619538e-02]]
grads:  [-1.99329074e-02  2.84788982e+01]
Stock Position:  -0.01993290738312729
Bond Position:  [12.96764344]


portfolio before change:  [10.85053285]
curr_Stock_Price:  106.37449210494249
curr_Factors:  [1.06374492e+02 3.42173532e-02]
mat_Sqrt:  [[ 1.96770825e+01  0.00000000e+00]
 [-7.39917327e-03  1.69536358e-02]]
grads:  [ 0.04128324 11.20610803]
Stock Position:  0.04128323995597567
Bond Position:  [6.45904917]


portfolio before change:  [10.88361962]
curr_Stock_Price:  107.13683070607769
curr_Factors:  [1.07136831e+02 3.42853839e-02]
mat_Sqrt:  [[ 1.98377907e+01  0.00000000e+00]
 [-7.40652511e-03  1.69704810e-02]]
grads:  [ 8.70113061e-03 -1.14667121e+01]
Stock Position:  0.008701130607541864
Bond Position:  [9.95140807]


portfolio before change:  [10.88933381]
curr_Stock_Price:  107.50758969181437
curr_Factors:  [1.07507590e+02 3.17086876e-02]
mat_Sqrt:  [[ 1.91438049e+01  0.00000000e+00]
 [-7.12277335e-03  1.63203240e-02]]
grads:  [-0.00332926  1.73487476]
Stock Position:  -0.0033292617107166574
Bond Position:  [11.24725471]


portfolio before change:  [10.88286324]
curr_Stock_Price:  110.29581703502228
curr_Factors:  [1.10295817e+02 2.98815154e-02]
mat_Sqrt:  [[ 1.90660335e+01  0.00000000e+00]
 [-6.91450827e-03  1.58431288e-02]]
grads:  [3.51461378e-02 3.88337830e+01]
Stock Position:  0.035146137771339916
Bond Position:  [7.00639125]


portfolio before change:  [10.85435373]
curr_Stock_Price:  109.43480280920181
curr_Factors:  [1.09434803e+02 3.08716189e-02]
mat_Sqrt:  [[ 1.92280464e+01  0.00000000e+00]
 [-7.02812850e-03  1.61034654e-02]]
grads:  [-0.00982981  7.09990806]
Stock Position:  -0.009829805895384723
Bond Position:  [11.9300766]


portfolio before change:  [10.86623977]
curr_Stock_Price:  108.529072389605
curr_Factors:  [1.08529072e+02 3.00314008e-02]
mat_Sqrt:  [[ 1.88076219e+01  0.00000000e+00]
 [-6.93182814e-03  1.58828136e-02]]
grads:  [-3.63406062e-03  9.24213388e+00]
Stock Position:  -0.003634060623365251
Bond Position:  [11.260641]


portfolio before change:  [10.87274065]
curr_Stock_Price:  107.51495510018603
curr_Factors:  [1.07514955e+02 3.11837988e-02]
mat_Sqrt:  [[ 1.89859961e+01  0.00000000e+00]
 [-7.06357403e-03  1.61846813e-02]]
grads:  [-0.0137704  -2.74125224]
Stock Position:  -0.013770400144875041
Bond Position:  [12.3532646]


portfolio before change:  [10.87954037]
curr_Stock_Price:  107.24546267507841
curr_Factors:  [1.07245463e+02 3.34038512e-02]
mat_Sqrt:  [[ 1.96009535e+01  0.00000000e+00]
 [-7.31068820e-03  1.67508910e-02]]
grads:  [ 0.01636308 13.2230832 ]
Stock Position:  0.01636307727479463
Bond Position:  [9.12467458]


portfolio before change:  [10.9310583]
curr_Stock_Price:  110.25446092836297
curr_Factors:  [1.10254461e+02 3.30338618e-02]
mat_Sqrt:  [[ 2.00389907e+01  0.00000000e+00]
 [-7.27008795e-03  1.66578642e-02]]
grads:  [3.50121347e-03 3.57888432e+00]
Stock Position:  0.003501213474803088
Bond Position:  [10.54503389]


portfolio before change:  [10.94115233]
curr_Stock_Price:  112.38442013529863
curr_Factors:  [1.12384420e+02 3.18025201e-02]
mat_Sqrt:  [[ 2.00418071e+01  0.00000000e+00]
 [-7.13330444e-03  1.63444538e-02]]
grads:  [6.45821248e-03 2.57023980e+01]
Stock Position:  0.006458212476539057
Bond Position:  [10.21534986]


portfolio before change:  [10.9336422]
curr_Stock_Price:  110.82605067015068
curr_Factors:  [1.10826051e+02 3.24925254e-02]
mat_Sqrt:  [[ 1.99771528e+01  0.00000000e+00]
 [-7.21027327e-03  1.65208115e-02]]
grads:  [ 0.01178352 10.81121112]
Stock Position:  0.011783517512178704
Bond Position:  [9.62772149]


portfolio before change:  [10.93475947]
curr_Stock_Price:  110.7165785061771
curr_Factors:  [1.10716579e+02 3.19624510e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.93475947]
Stock Price:  111.85016394435118
PL:  [-0.91540448]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.05272360e-01  7.28339446e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.61603068e-01 -5.63204217e-01]
 [ 1.27027734e-01  7.38164919e-02]
 [-4.12788204e-01 -1.17049346e-01]
 [ 4.04151954e-01 -5.00946420e-01]
 [-5.73497987e-01  4.10086782e-01]
 [ 2.51067695e-01  1.52410294e-01]
 [-1.60624879e-01 -3.94230584e-02]
 [ 2.80866592e-01  4.59745501e-03]
 [ 1.01678449e-01  1.70331389e-01]
 [-2.36406161e-01  6.55837772e-02]
 [-1.49991077e-02  3.84851350e-02]
 [-2.12570448e-01 -2.68149436e-01]
 [-1.14821708e-01 -1.32089709e-01]
 [ 8.80044829e-02  4.86853878e-02]
 [ 3.46207807e-02 -7.25224597e-02]
 [ 7.32241334e-01 -3.50841578e-01]
 [ 1.89061312e-01  1.37982586e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.62358441]
curr_Stock_Price:  100.29183279903313
curr_Factors:  [1.00291833e+02 4.03850298e-02]
mat_Sqrt:  [[ 2.01546737e+01  0.00000000e+00]
 [-8.03841077e-03  1.84183129e-02]]
grads:  [-3.64605361e-03  3.95443084e+00]
Stock Position:  -0.0036460536059341455
Bond Position:  [4.98925381]


portfolio before change:  [4.62703739]
curr_Stock_Price:  99.68692793877699
curr_Factors:  [9.96869279e+01 4.08305312e-02]
mat_Sqrt:  [[ 2.01433050e+01  0.00000000e+00]
 [-8.08262643e-03  1.85196237e-02]]
grads:  [-0.00924997 -3.5989916 ]
Stock Position:  -0.009249965215713479
Bond Position:  [5.54913801]


portfolio before change:  [4.61886176]
curr_Stock_Price:  100.72077968775167
curr_Factors:  [1.00720780e+02 3.90719388e-02]
mat_Sqrt:  [[ 1.99090969e+01  0.00000000e+00]
 [-7.90664923e-03  1.81164093e-02]]
grads:  [-2.04632858e-02 -3.10880709e+01]
Stock Position:  -0.020463285815914417
Bond Position:  [6.67993986]


portfolio before change:  [4.61755039]
curr_Stock_Price:  100.86648248879587
curr_Factors:  [1.00866482e+02 3.91726521e-02]
mat_Sqrt:  [[ 1.99635772e+01  0.00000000e+00]
 [-7.91683291e-03  1.81397430e-02]]
grads:  [0.00797672 4.06932401]
Stock Position:  0.007976721350347262
Bond Position:  [3.81296657]


portfolio before change:  [4.60889921]
curr_Stock_Price:  99.66241077888363
curr_Factors:  [9.96624108e+01 4.01799918e-02]
mat_Sqrt:  [[ 1.99772779e+01  0.00000000e+00]
 [-8.01797898e-03  1.83714978e-02]]
grads:  [-0.02322002 -6.37124677]
Stock Position:  -0.023220016754820317
Bond Position:  [6.92306206]


portfolio before change:  [4.58348851]
curr_Stock_Price:  100.83130244968392
curr_Factors:  [1.00831302e+02 4.09506624e-02]
mat_Sqrt:  [[ 2.04044946e+01  0.00000000e+00]
 [-8.09450800e-03  1.85468478e-02]]
grads:  [ 9.09216405e-03 -2.70097876e+01]
Stock Position:  0.009092164052346146
Bond Position:  [3.66671376]


portfolio before change:  [4.6026154]
curr_Stock_Price:  102.83413704434919
curr_Factors:  [1.02834137e+02 3.91637920e-02]
mat_Sqrt:  [[ 2.03507151e+01  0.00000000e+00]
 [-7.91593754e-03  1.81376915e-02]]
grads:  [-1.93861218e-02  2.26096459e+01]
Stock Position:  -0.019386121774598135
Bond Position:  [6.5961705]


portfolio before change:  [4.62842654]
curr_Stock_Price:  101.58778733046223
curr_Factors:  [1.01587787e+02 3.80450418e-02]
mat_Sqrt:  [[ 1.98148384e+01  0.00000000e+00]
 [-7.80205530e-03  1.78767545e-02]]
grads:  [0.01602764 8.52561319]
Stock Position:  0.01602763519214171
Bond Position:  [3.00021454]


portfolio before change:  [4.62973943]
curr_Stock_Price:  101.6228986013382
curr_Factors:  [1.01622899e+02 3.80152809e-02]
mat_Sqrt:  [[ 1.98139325e+01  0.00000000e+00]
 [-7.79900310e-03  1.78697610e-02]]
grads:  [-0.00897502 -2.20613238]
Stock Position:  -0.008975023602577053
Bond Position:  [5.54180735]


portfolio before change:  [4.64897691]
curr_Stock_Price:  99.63383963563278
curr_Factors:  [9.96338396e+01 3.95511286e-02]
mat_Sqrt:  [[ 1.98146455e+01  0.00000000e+00]
 [-7.95498622e-03  1.82271633e-02]]
grads:  [0.01427596 0.25223097]
Stock Position:  0.014275959925791807
Bond Position:  [3.22660821]


portfolio before change:  [4.66281918]
curr_Stock_Price:  100.54694894692554
curr_Factors:  [1.00546949e+02 4.02971261e-02]
mat_Sqrt:  [[ 2.01839394e+01  0.00000000e+00]
 [-8.02965763e-03  1.83982570e-02]]
grads:  [8.72065450e-03 9.25801772e+00]
Stock Position:  0.00872065449600584
Bond Position:  [3.78598397]


portfolio before change:  [4.65580019]
curr_Stock_Price:  99.6335318556092
curr_Factors:  [9.96335319e+01 4.08767013e-02]
mat_Sqrt:  [[ 2.01438949e+01  0.00000000e+00]
 [-8.08719494e-03  1.85300915e-02]]
grads:  [-0.01031494  3.53931211]
Stock Position:  -0.010314939341782793
Bond Position:  [5.68351403]


portfolio before change:  [4.64907412]
curr_Stock_Price:  100.4233698585467
curr_Factors:  [1.00423370e+02 4.25330396e-02]
mat_Sqrt:  [[ 2.07108537e+01  0.00000000e+00]
 [-8.24941594e-03  1.89017865e-02]]
grads:  [8.67748987e-05 2.03605807e+00]
Stock Position:  8.677489872812939e-05
Bond Position:  [4.64035989]


portfolio before change:  [4.65018663]
curr_Stock_Price:  99.87340564717785
curr_Factors:  [9.98734056e+01 4.33237591e-02]
mat_Sqrt:  [[ 2.07880104e+01  0.00000000e+00]
 [-8.32574409e-03  1.90766762e-02]]
grads:  [ -0.01585532 -14.05640233]
Stock Position:  -0.015855315154701104
Bond Position:  [6.23371095]


portfolio before change:  [4.68371683]
curr_Stock_Price:  97.85694773514624
curr_Factors:  [9.78569477e+01 4.35914242e-02]
mat_Sqrt:  [[ 2.04311209e+01  0.00000000e+00]
 [-8.35142375e-03  1.91355157e-02]]
grads:  [-0.00844155 -6.90285596]
Stock Position:  -0.008441552635621815
Bond Position:  [5.50978141]


portfolio before change:  [4.70274786]
curr_Stock_Price:  95.76569564233886
curr_Factors:  [9.57656956e+01 4.69047669e-02]
mat_Sqrt:  [[ 2.07404635e+01  0.00000000e+00]
 [-8.66300335e-03  1.98494343e-02]]
grads:  [0.0052676  2.45273427]
Stock Position:  0.005267603007377672
Bond Position:  [4.1982922]


portfolio before change:  [4.71269573]
curr_Stock_Price:  97.4549190874901
curr_Factors:  [9.74549191e+01 4.87519351e-02]
mat_Sqrt:  [[ 2.15178906e+01  0.00000000e+00]
 [-8.83193615e-03  2.02365080e-02]]
grads:  [ 1.37996076e-04 -3.58374379e+00]
Stock Position:  0.0001379960757301785
Bond Position:  [4.69924733]


portfolio before change:  [4.71382896]
curr_Stock_Price:  97.15255541169138
curr_Factors:  [9.71525554e+01 4.77317454e-02]
mat_Sqrt:  [[ 2.12254979e+01  0.00000000e+00]
 [-8.73903843e-03  2.00236525e-02]]
grads:  [  0.02728424 -17.52135765]
Stock Position:  0.027284237090164445
Bond Position:  [2.0630956]


portfolio before change:  [4.73569355]
curr_Stock_Price:  97.93501265057245
curr_Factors:  [9.79350127e+01 4.72694558e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.73569355]
Stock Price:  96.37871148789743
PL:  [4.73569355]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-3.35624858e-02  5.30876204e-03]
 [ 2.29129962e-02 -1.77019677e-02]
 [-1.56647394e-01 -5.29392359e-01]
 [-3.77079790e-02  2.75679271e-01]
 [-4.11315754e-01 -7.05248261e-02]
 [ 1.12923880e-01 -9.65384229e-02]
 [-5.07318367e-01  2.43026681e-01]
 [ 3.45798467e-01  1.59851313e-01]
 [-1.41229164e-01 -3.15372918e-02]
 [ 2.72326962e-01  8.69430571e-03]
 [ 9.43209418e-02  1.64994522e-01]
 [-2.38905041e-01  1.14294357e-01]
 [-8.77177810e-03  5.54504757e-02]
 [-2.77659351e-01 -2.50750383e-01]
 [ 1.40006349e-01 -4.80466971e-03]
 [ 8.91261268e-02  1.52664275e-02]
 [-5.18599478e-02  3.08251266e-02]
 [ 4.54408452e-01 -2.52078096e-01]
 [ 2.25325962e-01  1.18077271e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.55796856]
curr_Stock_Price:  99.70169528257891
curr_Factors:  [9.97016953e+01 4.19407469e-02]
mat_Sqrt:  [[ 2.04183490e+01  0.00000000e+00]
 [-8.19177606e-03  1.87697169e-02]]
grads:  [-0.00153027  0.28283655]
Stock Position:  -0.0015302682953658839
Bond Position:  [0.7105389]


portfolio before change:  [0.55454256]
curr_Stock_Price:  102.05661590193397
curr_Factors:  [1.02056616e+02 4.26420219e-02]
mat_Sqrt:  [[ 2.10746348e+01  0.00000000e+00]
 [-8.25997791e-03  1.89259870e-02]]
grads:  [ 7.20639967e-04 -9.35325999e-01]
Stock Position:  0.0007206399666622766
Bond Position:  [0.48099648]


portfolio before change:  [0.55391318]
curr_Stock_Price:  101.0163771284551
curr_Factors:  [1.01016377e+02 4.18118787e-02]
mat_Sqrt:  [[ 2.06557814e+01  0.00000000e+00]
 [-8.17918125e-03  1.87408586e-02]]
grads:  [-1.87692323e-02 -2.82480312e+01]
Stock Position:  -0.01876923234502363
Bond Position:  [2.44991303]


portfolio before change:  [0.60418484]
curr_Stock_Price:  98.37060550374171
curr_Factors:  [9.83706055e+01 4.02773520e-02]
mat_Sqrt:  [[ 1.97422115e+01  0.00000000e+00]
 [-8.02768729e-03  1.83937423e-02]]
grads:  [4.18434982e-03 1.49876663e+01]
Stock Position:  0.004184349819039972
Bond Position:  [0.19256781]


portfolio before change:  [0.60114525]
curr_Stock_Price:  97.63268039739003
curr_Factors:  [9.76326804e+01 3.93430091e-02]
mat_Sqrt:  [[ 1.93655127e+01  0.00000000e+00]
 [-7.93402890e-03  1.81791440e-02]]
grads:  [-0.022829   -3.87943602]
Stock Position:  -0.022829001148851193
Bond Position:  [2.83000182]


portfolio before change:  [0.58359535]
curr_Stock_Price:  98.43243010572162
curr_Factors:  [9.84324301e+01 3.84671328e-02]
mat_Sqrt:  [[ 1.93055916e+01  0.00000000e+00]
 [-7.84521590e-03  1.79756479e-02]]
grads:  [ 3.66686809e-03 -5.37051146e+00]
Stock Position:  0.003666868093384266
Bond Position:  [0.22265661]


portfolio before change:  [0.59056081]
curr_Stock_Price:  100.31681370645155
curr_Factors:  [1.00316814e+02 3.64482592e-02]
mat_Sqrt:  [[ 1.91519115e+01  0.00000000e+00]
 [-7.63657088e-03  1.74975820e-02]]
grads:  [-0.02095106 13.88915798]
Stock Position:  -0.02095105906382595
Bond Position:  [2.6923043]


portfolio before change:  [0.54480923]
curr_Stock_Price:  102.53267959610262
curr_Factors:  [1.02532680e+02 3.49896236e-02]
mat_Sqrt:  [[ 1.91792642e+01  0.00000000e+00]
 [-7.48220541e-03  1.71438863e-02]]
grads:  [0.02166732 9.32410015]
Stock Position:  0.02166732230144375
Bond Position:  [-1.67679938]


portfolio before change:  [0.53053709]
curr_Stock_Price:  101.89333459861219
curr_Factors:  [1.01893335e+02 3.45037562e-02]
mat_Sqrt:  [[ 1.89268772e+01  0.00000000e+00]
 [-7.43007469e-03  1.70244398e-02]]
grads:  [-0.00818905 -1.85247163]
Stock Position:  -0.008189051196625241
Bond Position:  [1.36494682]


portfolio before change:  [0.53335263]
curr_Stock_Price:  101.59119142791289
curr_Factors:  [1.01591191e+02 3.40708650e-02]
mat_Sqrt:  [[ 1.87520017e+01  0.00000000e+00]
 [-7.38331795e-03  1.69173067e-02]]
grads:  [0.01472491 0.51392966]
Stock Position:  0.014724906315584107
Bond Position:  [-0.96256814]


portfolio before change:  [0.51492362]
curr_Stock_Price:  100.35598214463519
curr_Factors:  [1.00355982e+02 3.34236113e-02]
mat_Sqrt:  [[ 1.83472066e+01  0.00000000e+00]
 [-7.31285020e-03  1.67558448e-02]]
grads:  [9.06571003e-03 9.84698321e+00]
Stock Position:  0.009065710029072914
Bond Position:  [-0.39487462]


portfolio before change:  [0.53863009]
curr_Stock_Price:  102.98183278376703
curr_Factors:  [1.02981833e+02 3.18008216e-02]
mat_Sqrt:  [[ 1.83645287e+01  0.00000000e+00]
 [-7.13311394e-03  1.63440173e-02]]
grads:  [-0.01029283  6.99303938]
Stock Position:  -0.010292825794178805
Bond Position:  [1.59860415]


portfolio before change:  [0.54244575]
curr_Stock_Price:  102.64995454552383
curr_Factors:  [1.02649955e+02 3.13346208e-02]
mat_Sqrt:  [[ 1.81706717e+01  0.00000000e+00]
 [-7.08063509e-03  1.62237731e-02]]
grads:  [8.49104192e-04 3.41785325e+00]
Stock Position:  0.000849104191549306
Bond Position:  [0.45528525]


portfolio before change:  [0.54258158]
curr_Stock_Price:  102.67585147014299
curr_Factors:  [1.02675851e+02 3.23348777e-02]
mat_Sqrt:  [[ 1.84630703e+01  0.00000000e+00]
 [-7.19276055e-03  1.64806848e-02]]
grads:  [ -0.02096595 -15.21480362]
Stock Position:  -0.0209659489367854
Bond Position:  [2.69527824]


portfolio before change:  [0.53956444]
curr_Stock_Price:  102.85190104707662
curr_Factors:  [1.02851901e+02 3.19184163e-02]
mat_Sqrt:  [[ 1.83752388e+01  0.00000000e+00]
 [-7.14629037e-03  1.63742083e-02]]
grads:  [ 0.00750518 -0.29342913]
Stock Position:  0.007505177015663028
Bond Position:  [-0.23235729]


portfolio before change:  [0.53240945]
curr_Stock_Price:  101.90630236428831
curr_Factors:  [1.01906302e+02 3.28767137e-02]
mat_Sqrt:  [[ 1.84775865e+01  0.00000000e+00]
 [-7.25277477e-03  1.66181947e-02]]
grads:  [0.00518406 0.9186574 ]
Stock Position:  0.005184061355222808
Bond Position:  [0.00412093]


portfolio before change:  [0.53676021]
curr_Stock_Price:  102.74536052427807
curr_Factors:  [1.02745361e+02 3.23209330e-02]
mat_Sqrt:  [[ 1.84715851e+01  0.00000000e+00]
 [-7.19120941e-03  1.64771307e-02]]
grads:  [-0.00207923  1.87078243]
Stock Position:  -0.0020792346431047623
Bond Position:  [0.75039193]


portfolio before change:  [0.54083367]
curr_Stock_Price:  100.87648485360648
curr_Factors:  [1.00876485e+02 3.34882877e-02]
mat_Sqrt:  [[ 1.84602004e+01  0.00000000e+00]
 [-7.31992216e-03  1.67720487e-02]]
grads:  [  0.01865595 -15.02965444]
Stock Position:  0.01865594865475742
Bond Position:  [-1.34111286]


portfolio before change:  [0.53752038]
curr_Stock_Price:  100.7168592644197
curr_Factors:  [1.00716859e+02 3.39750863e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.53752038]
Stock Price:  99.54252600545466
PL:  [0.53752038]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.75630228e-02  2.87480855e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.55576435e-01 -5.22085361e-01]
 [-3.94359619e-02  2.75498191e-01]
 [-4.16577061e-01 -6.40917580e-02]
 [-4.96089795e-02  1.28281478e-01]
 [-2.66004479e-01  8.87506867e-02]
 [-3.79883205e-02  1.53490475e-01]
 [-2.31149142e-01  9.00932279e-02]
 [ 1.86088317e-01  9.10725346e-03]
 [-5.75836055e-02  2.13504886e-02]
 [-2.36267815e-01  6.28870047e-02]
 [-1.13198924e-01  3.12878953e-02]
 [-9.76593995e-02 -2.19754243e-01]
 [-1.84456572e-01 -1.39904509e-01]
 [ 8.86327546e-02  7.12813154e-02]
 [ 4.13904441e-02 -7.58803493e-02]
 [ 8.03920954e-01 -3.80466070e-01]
 [ 1.66541420e-01  1.46571100e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.84522757]
curr_Stock_Price:  101.77553793468302
curr_Factors:  [1.01775538e+02 3.97164313e-02]
mat_Sqrt:  [[ 2.02828284e+01  0.00000000e+00]
 [-7.97159269e-03  1.82652135e-02]]
grads:  [8.03783137e-03 1.57392551e+01]
Stock Position:  0.008037831366384229
Bond Position:  [14.02717296]


portfolio before change:  [14.83292844]
curr_Stock_Price:  99.80904155414464
curr_Factors:  [9.98090416e+01 3.97019442e-02]
mat_Sqrt:  [[ 1.98872976e+01  0.00000000e+00]
 [-7.97013869e-03  1.82618819e-02]]
grads:  [-0.00936904 -3.6497865 ]
Stock Position:  -0.009369039171462824
Bond Position:  [15.76804326]


portfolio before change:  [14.82515867]
curr_Stock_Price:  101.05914508114635
curr_Factors:  [1.01059145e+02 3.86641623e-02]
mat_Sqrt:  [[ 1.98714667e+01  0.00000000e+00]
 [-7.86528192e-03  1.80216249e-02]]
grads:  [-1.92956652e-02 -2.89699383e+01]
Stock Position:  -0.019295665172375624
Bond Position:  [16.7751621]


portfolio before change:  [14.87767892]
curr_Stock_Price:  98.55464840587753
curr_Factors:  [9.85546484e+01 3.96820468e-02]
mat_Sqrt:  [[ 1.96324340e+01  0.00000000e+00]
 [-7.96814124e-03  1.82573052e-02]]
grads:  [4.11570498e-03 1.50897511e+01]
Stock Position:  0.004115704982030172
Bond Position:  [14.47205706]


portfolio before change:  [14.87562207]
curr_Stock_Price:  97.17570626690438
curr_Factors:  [9.71757063e+01 4.08285064e-02]
mat_Sqrt:  [[ 1.96353864e+01  0.00000000e+00]
 [-8.08242601e-03  1.85191645e-02]]
grads:  [-0.0226402  -3.46083421]
Stock Position:  -0.022640196028031374
Bond Position:  [17.07569911]


portfolio before change:  [14.89729474]
curr_Stock_Price:  96.40701972580494
curr_Factors:  [9.64070197e+01 3.95416141e-02]
mat_Sqrt:  [[ 1.91706066e+01  0.00000000e+00]
 [-7.95402933e-03  1.82249707e-02]]
grads:  [3.32678441e-04 7.03877553e+00]
Stock Position:  0.00033267844141637805
Bond Position:  [14.8652222]


portfolio before change:  [14.90070033]
curr_Stock_Price:  95.47163933874326
curr_Factors:  [9.54716393e+01 4.02716156e-02]
mat_Sqrt:  [[ 1.91590472e+01  0.00000000e+00]
 [-8.02711561e-03  1.83924324e-02]]
grads:  [-0.01186231  4.82539147]
Stock Position:  -0.011862307213841402
Bond Position:  [16.03321424]


portfolio before change:  [14.90559817]
curr_Stock_Price:  95.39669300169604
curr_Factors:  [9.53966930e+01 4.25086313e-02]
mat_Sqrt:  [[ 1.96685290e+01  0.00000000e+00]
 [-8.24704857e-03  1.88963622e-02]]
grads:  [1.47445773e-03 8.12275261e+00]
Stock Position:  0.0014744577339813832
Bond Position:  [14.76493978]


portfolio before change:  [14.90876986]
curr_Stock_Price:  95.0440196499505
curr_Factors:  [9.50440196e+01 4.48304357e-02]
mat_Sqrt:  [[ 2.01238594e+01  0.00000000e+00]
 [-8.46927961e-03  1.94055574e-02]]
grads:  [-0.00953243  4.64265086]
Stock Position:  -0.009532427647861516
Bond Position:  [15.8147701]


portfolio before change:  [14.90131476]
curr_Stock_Price:  96.24091192321416
curr_Factors:  [9.62409119e+01 4.35524210e-02]
mat_Sqrt:  [[ 2.00847246e+01  0.00000000e+00]
 [-8.34768672e-03  1.91269531e-02]]
grads:  [0.00946306 0.47614763]
Stock Position:  0.009463064739939301
Bond Position:  [13.99058078]


portfolio before change:  [14.91805347]
curr_Stock_Price:  97.64010232883557
curr_Factors:  [9.76401023e+01 4.18074661e-02]
mat_Sqrt:  [[ 1.99643488e+01  0.00000000e+00]
 [-8.17874965e-03  1.87398697e-02]]
grads:  [-0.00241758  1.13930827]
Stock Position:  -0.0024175839045630218
Bond Position:  [15.15410661]


portfolio before change:  [14.92001129]
curr_Stock_Price:  98.39754437280786
curr_Factors:  [9.83975444e+01 4.16064151e-02]
mat_Sqrt:  [[ 2.00707873e+01  0.00000000e+00]
 [-8.15906025e-03  1.86947556e-02]]
grads:  [-0.01040426  3.36388483]
Stock Position:  -0.01040425929879365
Bond Position:  [15.94376486]


portfolio before change:  [14.93367934]
curr_Stock_Price:  97.46700188306099
curr_Factors:  [9.74670019e+01 4.14762596e-02]
mat_Sqrt:  [[ 1.98498578e+01  0.00000000e+00]
 [-8.14628844e-03  1.86654917e-02]]
grads:  [-0.00501484  1.67624276]
Stock Position:  -0.005014835302269277
Bond Position:  [15.4224603]


portfolio before change:  [14.93868923]
curr_Stock_Price:  97.23692521449831
curr_Factors:  [9.72369252e+01 4.27202244e-02]
mat_Sqrt:  [[ 2.00977750e+01  0.00000000e+00]
 [-8.26754855e-03  1.89433335e-02]]
grads:  [-9.63131561e-03 -1.16006110e+01]
Stock Position:  -0.009631315613883914
Bond Position:  [15.87520875]


portfolio before change:  [14.95475327]
curr_Stock_Price:  95.98115264307276
curr_Factors:  [9.59811526e+01 4.09480120e-02]
mat_Sqrt:  [[ 1.94223767e+01  0.00000000e+00]
 [-8.09424606e-03  1.85462476e-02]]
grads:  [-0.01264088 -7.54354801]
Stock Position:  -0.012640878611116263
Bond Position:  [16.16803937]


portfolio before change:  [14.93853858]
curr_Stock_Price:  97.58366835352858
curr_Factors:  [9.75836684e+01 4.08337642e-02]
mat_Sqrt:  [[ 1.97190890e+01  0.00000000e+00]
 [-8.08294641e-03  1.85203569e-02]]
grads:  [0.00607241 3.84880895]
Stock Position:  0.0060724139326997035
Bond Position:  [14.34597015]


portfolio before change:  [14.93960114]
curr_Stock_Price:  97.16795525546164
curr_Factors:  [9.71679553e+01 4.22657211e-02]
mat_Sqrt:  [[ 1.99763991e+01  0.00000000e+00]
 [-8.22345145e-03  1.88422944e-02]]
grads:  [ 4.14165964e-04 -4.02712896e+00]
Stock Position:  0.000414165964042508
Bond Position:  [14.89935748]


portfolio before change:  [14.94300895]
curr_Stock_Price:  96.40136496906554
curr_Factors:  [9.64013650e+01 4.25890799e-02]
mat_Sqrt:  [[ 1.98944672e+01  0.00000000e+00]
 [-8.25484875e-03  1.89142346e-02]]
grads:  [  0.03206278 -20.11532996]
Stock Position:  0.03206278117904969
Bond Position:  [11.85211308]


portfolio before change:  [14.95457615]
curr_Stock_Price:  96.66970745868949
curr_Factors:  [9.66697075e+01 4.34403672e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.95457615]
Stock Price:  98.37936909863618
PL:  [14.95457615]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.26098758e-01 -5.68835312e-02]
 [-1.11709877e-01 -2.22790081e-01]
 [ 2.01246203e-01 -4.25224394e-02]
 [-2.88218140e-01 -9.98120956e-02]
 [ 3.80112611e-01 -4.63452049e-01]
 [-4.18930956e-01  1.62460418e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-2.09289392e-01  4.92276377e-03]
 [ 2.34448696e-01  6.07688981e-03]
 [-6.47928133e-04  7.68101142e-02]
 [-2.35963825e-01  5.69613488e-02]
 [-4.46087928e-02  3.63149884e-02]
 [-2.02216311e-01 -2.65244216e-01]
 [-9.54635036e-02 -1.22804745e-01]
 [ 9.35117121e-02  5.15013642e-02]
 [-4.61442949e-03 -5.31041991e-02]
 [ 5.47288057e-01 -2.79120552e-01]
 [ 1.89930307e-01  7.84241544e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.481577]
curr_Stock_Price:  98.38957550346683
curr_Factors:  [9.83895755e+01 4.02406616e-02]
mat_Sqrt:  [[ 1.97370228e+01  0.00000000e+00]
 [-8.02403007e-03  1.83853626e-02]]
grads:  [ 0.00141215 -0.07347335]
Stock Position:  0.0014121470035094465
Bond Position:  [-8.62051755]


portfolio before change:  [-8.47959133]
curr_Stock_Price:  101.32204016508494
curr_Factors:  [1.01322040e+02 3.93703734e-02]
mat_Sqrt:  [[ 2.01042878e+01  0.00000000e+00]
 [-7.93678760e-03  1.81854650e-02]]
grads:  [-0.00750709 -3.12796683]
Stock Position:  -0.007507093402669874
Bond Position:  [-7.71895731]


portfolio before change:  [-8.49827013]
curr_Stock_Price:  103.55310575687606
curr_Factors:  [1.03553106e+02 4.11999973e-02]
mat_Sqrt:  [[ 2.10189841e+01  0.00000000e+00]
 [-8.11911298e-03  1.86032249e-02]]
grads:  [-9.94070118e-03 -1.19758850e+01]
Stock Position:  -0.009940701180925276
Bond Position:  [-7.46887965]


portfolio before change:  [-8.48328348]
curr_Stock_Price:  101.85764106523065
curr_Factors:  [1.01857641e+02 3.87166020e-02]
mat_Sqrt:  [[ 2.00420541e+01  0.00000000e+00]
 [-7.87061390e-03  1.80338420e-02]]
grads:  [ 0.00911523 -2.35792459]
Stock Position:  0.009115227818977355
Bond Position:  [-9.41173908]


portfolio before change:  [-8.49418382]
curr_Stock_Price:  100.91996699109227
curr_Factors:  [1.00919967e+02 3.90198999e-02]
mat_Sqrt:  [[ 1.99351806e+01  0.00000000e+00]
 [-7.90138215e-03  1.81043409e-02]]
grads:  [-0.01664292 -5.51315821]
Stock Position:  -0.016642924693720012
Bond Position:  [-6.81458041]


portfolio before change:  [-8.48919275]
curr_Stock_Price:  100.51769857008802
curr_Factors:  [1.00517699e+02 3.84994354e-02]
mat_Sqrt:  [[ 1.97228521e+01  0.00000000e+00]
 [-7.84850920e-03  1.79831938e-02]]
grads:  [ 9.01723313e-03 -2.57713983e+01]
Stock Position:  0.009017233126089368
Bond Position:  [-9.39558427]


portfolio before change:  [-8.50875008]
curr_Stock_Price:  98.60933699175946
curr_Factors:  [9.86093370e+01 3.97698612e-02]
mat_Sqrt:  [[ 1.96650510e+01  0.00000000e+00]
 [-7.97695292e-03  1.82774953e-02]]
grads:  [-0.01769776  8.88854928]
Stock Position:  -0.017697763299640273
Bond Position:  [-6.76358538]


portfolio before change:  [-8.52313332]
curr_Stock_Price:  99.32649681290971
curr_Factors:  [9.93264968e+01 4.11247385e-02]
mat_Sqrt:  [[ 2.01426540e+01  0.00000000e+00]
 [-8.11169413e-03  1.85862262e-02]]
grads:  [4.85562380e-03 7.30212703e+00]
Stock Position:  0.004855623800006894
Bond Position:  [-9.00542542]


portfolio before change:  [-8.53481912]
curr_Stock_Price:  97.38356064843752
curr_Factors:  [9.73835606e+01 4.27650824e-02]
mat_Sqrt:  [[ 2.01386478e+01  0.00000000e+00]
 [-8.27188805e-03  1.89532766e-02]]
grads:  [-0.01028574  0.25973154]
Stock Position:  -0.010285741306133557
Bond Position:  [-7.53315701]


portfolio before change:  [-8.54501767]
curr_Stock_Price:  98.19196368025449
curr_Factors:  [9.81919637e+01 4.32687651e-02]
mat_Sqrt:  [[ 2.04250532e+01  0.00000000e+00]
 [-8.32045817e-03  1.90645647e-02]]
grads:  [0.01160834 0.31875314]
Stock Position:  0.01160833543087194
Bond Position:  [-9.68486292]


portfolio before change:  [-8.5421619]
curr_Stock_Price:  98.64657548788196
curr_Factors:  [9.86465755e+01 4.42681107e-02]
mat_Sqrt:  [[ 2.07552279e+01  0.00000000e+00]
 [-8.41599531e-03  1.92834678e-02]]
grads:  [1.58392643e-03 3.98321065e+00]
Stock Position:  0.00158392642755269
Bond Position:  [-8.69841082]


portfolio before change:  [-8.54371525]
curr_Stock_Price:  99.03896883238825
curr_Factors:  [9.90389688e+01 4.62310082e-02]
mat_Sqrt:  [[ 2.12947621e+01  0.00000000e+00]
 [-8.60055889e-03  1.97063561e-02]]
grads:  [-0.00991342  2.89050643]
Stock Position:  -0.009913416903903167
Bond Position:  [-7.56190067]


portfolio before change:  [-8.5502785]
curr_Stock_Price:  99.51030370520627
curr_Factors:  [9.95103037e+01 4.75230742e-02]
mat_Sqrt:  [[ 2.16930349e+01  0.00000000e+00]
 [-8.71991506e-03  1.99798354e-02]]
grads:  [-1.32575422e-03  1.81758196e+00]
Stock Position:  -0.001325754215465213
Bond Position:  [-8.4183523]


portfolio before change:  [-8.55237695]
curr_Stock_Price:  99.50547213668791
curr_Factors:  [9.95054721e+01 4.55729889e-02]
mat_Sqrt:  [[ 2.12422600e+01  0.00000000e+00]
 [-8.53913240e-03  1.95656103e-02]]
grads:  [ -0.01496914 -13.55665437]
Stock Position:  -0.014969140642978081
Bond Position:  [-7.06286554]


portfolio before change:  [-8.54575125]
curr_Stock_Price:  98.944876092872
curr_Factors:  [9.89448761e+01 4.55797604e-02]
mat_Sqrt:  [[ 2.11241541e+01  0.00000000e+00]
 [-8.53976678e-03  1.95670638e-02]]
grads:  [-0.00705637 -6.27609465]
Stock Position:  -0.007056371920829684
Bond Position:  [-7.8475594]


portfolio before change:  [-8.55159566]
curr_Stock_Price:  99.49505657037685
curr_Factors:  [9.94950566e+01 4.79143621e-02]
mat_Sqrt:  [[ 2.17788207e+01  0.00000000e+00]
 [-8.75573979e-03  2.00619202e-02]]
grads:  [0.00532576 2.56712038]
Stock Position:  0.0053257590016453915
Bond Position:  [-9.08148235]


portfolio before change:  [-8.55559702]
curr_Stock_Price:  99.17008789101205
curr_Factors:  [9.91700879e+01 4.81066217e-02]
mat_Sqrt:  [[ 2.17511953e+01  0.00000000e+00]
 [-8.77328871e-03  2.01021298e-02]]
grads:  [-1.27767701e-03 -2.64172004e+00]
Stock Position:  -0.0012776770057919757
Bond Position:  [-8.42888968]


portfolio before change:  [-8.55792505]
curr_Stock_Price:  99.34269963973557
curr_Factors:  [9.93426996e+01 4.66814601e-02]
mat_Sqrt:  [[ 2.14638771e+01  0.00000000e+00]
 [-8.64235710e-03  1.98021278e-02]]
grads:  [  0.0198226  -14.09548281]
Stock Position:  0.019822600470187076
Bond Position:  [-10.52715569]


portfolio before change:  [-8.50458225]
curr_Stock_Price:  102.16649248537938
curr_Factors:  [1.02166492e+02 4.48181187e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.50458225]
Stock Price:  102.80263549915092
PL:  [-11.30721775]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.86123841e-02 -1.35413710e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.10160166e-01 -8.94502386e-01]
 [-2.45320183e-02  2.77060017e-01]
 [-4.12684155e-01 -6.84754248e-02]
 [-3.56263786e-02  1.01227563e-01]
 [-3.48617330e-01  1.34049274e-01]
 [ 2.06727056e-02  1.58311625e-01]
 [-2.10998265e-01  1.15809153e-02]
 [ 2.75538086e-01  4.59646003e-03]
 [ 6.15416273e-02  1.36329409e-01]
 [-2.38310726e-01  1.02709395e-01]
 [-1.05380887e-02  3.93657029e-02]
 [-1.79151793e-01 -2.56835995e-01]
 [-1.24111133e-01 -1.36545286e-01]
 [ 8.87085272e-02  7.00962678e-02]
 [ 3.33429132e-02 -7.19029580e-02]
 [ 8.28558900e-01 -3.90534917e-01]
 [ 1.52763945e-01  1.51529554e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.28298383]
curr_Stock_Price:  97.40232892497012
curr_Factors:  [9.74023289e+01 4.13706970e-02]
mat_Sqrt:  [[ 1.98114271e+01  0.00000000e+00]
 [-8.13591514e-03  1.86417235e-02]]
grads:  [ 0.00141441 -0.07264012]
Stock Position:  0.001414405438587366
Bond Position:  [-15.42075022]


portfolio before change:  [-15.28697138]
curr_Stock_Price:  97.30909020620682
curr_Factors:  [9.73090902e+01 3.94582139e-02]
mat_Sqrt:  [[ 1.93295669e+01  0.00000000e+00]
 [-7.94563668e-03  1.82057408e-02]]
grads:  [-0.00963937 -3.66104138]
Stock Position:  -0.00963937118539493
Bond Position:  [-14.34897294]


portfolio before change:  [-15.29845462]
curr_Stock_Price:  98.12818353481663
curr_Factors:  [9.81281835e+01 3.96420108e-02]
mat_Sqrt:  [[ 1.95376173e+01  0.00000000e+00]
 [-7.96412062e-03  1.82480928e-02]]
grads:  [-3.07382935e-02 -4.90189521e+01]
Stock Position:  -0.030738293490105668
Bond Position:  [-12.28216171]


portfolio before change:  [-15.26602566]
curr_Stock_Price:  96.97327627358197
curr_Factors:  [9.69732763e+01 3.99280057e-02]
mat_Sqrt:  [[ 1.93771936e+01  0.00000000e+00]
 [-7.99279732e-03  1.83137994e-02]]
grads:  [4.97424388e-03 1.51284838e+01]
Stock Position:  0.004974243876769381
Bond Position:  [-15.74839439]


portfolio before change:  [-15.26737504]
curr_Stock_Price:  97.4935992794858
curr_Factors:  [9.74935993e+01 3.92261822e-02]
mat_Sqrt:  [[ 1.93091931e+01  0.00000000e+00]
 [-7.92224031e-03  1.81521329e-02]]
grads:  [-0.02292013 -3.77230737]
Stock Position:  -0.022920133366437435
Bond Position:  [-13.03280874]


portfolio before change:  [-15.26431709]
curr_Stock_Price:  97.21800940024977
curr_Factors:  [9.72180094e+01 3.84060220e-02]
mat_Sqrt:  [[ 1.90522551e+01  0.00000000e+00]
 [-7.83898177e-03  1.79613637e-02]]
grads:  [4.48920721e-04 5.63585067e+00]
Stock Position:  0.0004489207206048484
Bond Position:  [-15.30796027]


portfolio before change:  [-15.26799532]
curr_Stock_Price:  97.5504595870878
curr_Factors:  [9.75504596e+01 3.74734746e-02]
mat_Sqrt:  [[ 1.88838830e+01  0.00000000e+00]
 [-7.74322668e-03  1.77419612e-02]]
grads:  [-0.01536302  7.55549358]
Stock Position:  -0.015363017794782169
Bond Position:  [-13.76932587]


portfolio before change:  [-15.26093124]
curr_Stock_Price:  96.86655461796761
curr_Factors:  [9.68665546e+01 3.75463032e-02]
mat_Sqrt:  [[ 1.87697049e+01  0.00000000e+00]
 [-7.75074739e-03  1.77591933e-02]]
grads:  [4.78247068e-03 8.91434776e+00]
Stock Position:  0.004782470679576176
Bond Position:  [-15.72419269]


portfolio before change:  [-15.26295877]
curr_Stock_Price:  97.26467525939486
curr_Factors:  [9.72646753e+01 3.81431836e-02]
mat_Sqrt:  [[ 1.89960634e+01  0.00000000e+00]
 [-7.81211199e-03  1.78997973e-02]]
grads:  [-0.0108414   0.64698584]
Stock Position:  -0.010841400918041724
Bond Position:  [-14.20847344]


portfolio before change:  [-15.29078674]
curr_Stock_Price:  99.50381435945127
curr_Factors:  [9.95038144e+01 3.77513326e-02]
mat_Sqrt:  [[ 1.93332948e+01  0.00000000e+00]
 [-7.77188086e-03  1.78076162e-02]]
grads:  [0.01435576 0.25811765]
Stock Position:  0.01435576032137152
Bond Position:  [-16.71923965]


portfolio before change:  [-15.29143613]
curr_Stock_Price:  99.74977480526529
curr_Factors:  [9.97497748e+01 3.83765480e-02]
mat_Sqrt:  [[ 1.95409142e+01  0.00000000e+00]
 [-7.83597325e-03  1.79544703e-02]]
grads:  [6.19421683e-03 7.59306219e+00]
Stock Position:  0.006194216831210943
Bond Position:  [-15.90930786]


portfolio before change:  [-15.28033286]
curr_Stock_Price:  102.18447912578237
curr_Factors:  [1.02184479e+02 3.60024118e-02]
mat_Sqrt:  [[ 1.93887912e+01  0.00000000e+00]
 [-7.58972061e-03  1.73902346e-02]]
grads:  [-0.0099792  5.9061535]
Stock Position:  -0.009979202385529403
Bond Position:  [-14.26061327]


portfolio before change:  [-15.26902159]
curr_Stock_Price:  100.69369174942196
curr_Factors:  [1.00693692e+02 3.57453591e-02]
mat_Sqrt:  [[ 1.90375956e+01  0.00000000e+00]
 [-7.56257725e-03  1.73280413e-02]]
grads:  [3.48915520e-04 2.27179184e+00]
Stock Position:  0.0003489155195300686
Bond Position:  [-15.30415518]


portfolio before change:  [-15.2734735]
curr_Stock_Price:  98.90131287152917
curr_Factors:  [9.89013129e+01 3.68115698e-02]
mat_Sqrt:  [[ 1.89755436e+01  0.00000000e+00]
 [-7.67453658e-03  1.75845724e-02]]
grads:  [ -0.0153484  -14.60575721]
Stock Position:  -0.015348398840340612
Bond Position:  [-13.7554967]


portfolio before change:  [-15.25618805]
curr_Stock_Price:  97.5510255465937
curr_Factors:  [9.75510255e+01 3.82001258e-02]
mat_Sqrt:  [[ 1.90662040e+01  0.00000000e+00]
 [-7.81794099e-03  1.79131532e-02]]
grads:  [-0.00963508 -7.62262708]
Stock Position:  -0.009635078964237835
Bond Position:  [-14.31627622]


portfolio before change:  [-15.2667982]
curr_Stock_Price:  98.28071675018604
curr_Factors:  [9.82807168e+01 3.70723752e-02]
mat_Sqrt:  [[ 1.89231539e+01  0.00000000e+00]
 [-7.70167517e-03  1.76467547e-02]]
grads:  [0.0063045 3.9721903]
Stock Position:  0.0063045012079545855
Bond Position:  [-15.8864091]


portfolio before change:  [-15.27552616]
curr_Stock_Price:  97.52635831746994
curr_Factors:  [9.75263583e+01 3.72765818e-02]
mat_Sqrt:  [[ 1.88295547e+01  0.00000000e+00]
 [-7.72285769e-03  1.76952900e-02]]
grads:  [ 1.04192033e-04 -4.06339529e+00]
Stock Position:  0.00010419203333725552
Bond Position:  [-15.28568763]


portfolio before change:  [-15.27949145]
curr_Stock_Price:  96.15006338748823
curr_Factors:  [9.61500634e+01 3.69758142e-02]
mat_Sqrt:  [[ 1.84887882e+01  0.00000000e+00]
 [-7.69163849e-03  1.76237578e-02]]
grads:  [  0.03559538 -22.15957127]
Stock Position:  0.03559538253464527
Bond Position:  [-18.70198974]


portfolio before change:  [-15.29242806]
curr_Stock_Price:  95.91799600904906
curr_Factors:  [9.59179960e+01 3.91222655e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.29242806]
Stock Price:  94.43930570797524
PL:  [-15.29242806]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.56396854e-02  2.54535400e-01]
 [-2.24048507e-02 -2.93271978e-02]
 [-1.71344576e-01 -6.29669143e-01]
 [ 4.86231223e-02  1.94927313e-01]
 [-4.62333929e-01 -1.17515379e-01]
 [ 1.66900348e-01 -1.66626577e-01]
 [-3.12504719e-01  1.14247872e-01]
 [-3.72162940e-02  1.53723507e-01]
 [-2.28094178e-01  7.81904066e-02]
 [ 1.44590584e-01  1.17075892e-02]
 [-1.03302037e-01 -4.20206262e-02]
 [-1.75328095e-01  4.44579585e-02]
 [-7.27326293e-04  7.09676882e-03]
 [-1.06783447e-01 -2.24057032e-01]
 [-9.00198478e-02 -1.20193751e-01]
 [ 9.43061603e-02  5.08818908e-02]
 [-5.22842260e-02 -2.03246285e-02]
 [ 3.55758687e-01 -2.23392409e-01]
 [ 1.92974774e-01  8.10297407e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.27369923]
curr_Stock_Price:  101.54742542516271
curr_Factors:  [1.01547425e+02 3.90318581e-02]
mat_Sqrt:  [[ 2.00621988e+01  0.00000000e+00]
 [-7.90259280e-03  1.81071149e-02]]
grads:  [6.31675732e-03 1.40572036e+01]
Stock Position:  0.006316757317056183
Bond Position:  [12.63224879]


portfolio before change:  [13.27888958]
curr_Stock_Price:  101.86909205497442
curr_Factors:  [1.01869092e+02 3.97499027e-02]
mat_Sqrt:  [[ 2.03100256e+01  0.00000000e+00]
 [-7.97495106e-03  1.82729084e-02]]
grads:  [-0.00173335 -1.60495511]
Stock Position:  -0.0017333453889762046
Bond Position:  [13.4554639]


portfolio before change:  [13.28520269]
curr_Stock_Price:  100.16785953687688
curr_Factors:  [1.00167860e+02 3.86712743e-02]
mat_Sqrt:  [[ 1.96980228e+01  0.00000000e+00]
 [-7.86600527e-03  1.80232823e-02]]
grads:  [-2.26497210e-02 -3.49364302e+01]
Stock Position:  -0.022649720993530034
Bond Position:  [15.55397676]


portfolio before change:  [13.29401321]
curr_Stock_Price:  99.95057003110988
curr_Factors:  [9.99505700e+01 3.77781966e-02]
mat_Sqrt:  [[ 1.94270066e+01  0.00000000e+00]
 [-7.77464563e-03  1.78139510e-02]]
grads:  [6.88198545e-03 1.09423964e+01]
Stock Position:  0.006881985450131252
Bond Position:  [12.60615485]


portfolio before change:  [13.28930395]
curr_Stock_Price:  98.80828424030078
curr_Factors:  [9.88082842e+01 3.82154599e-02]
mat_Sqrt:  [[ 1.93158090e+01  0.00000000e+00]
 [-7.81950995e-03  1.79167481e-02]]
grads:  [-0.02659075 -6.55896808]
Stock Position:  -0.02659074979335112
Bond Position:  [15.91669032]


portfolio before change:  [13.29529311]
curr_Stock_Price:  98.73271352649782
curr_Factors:  [9.87327135e+01 3.80951994e-02]
mat_Sqrt:  [[ 1.92706427e+01  0.00000000e+00]
 [-7.80719662e-03  1.78885347e-02]]
grads:  [ 4.88715135e-03 -9.31471354e+00]
Stock Position:  0.004887151352987364
Bond Position:  [12.81277139]


portfolio before change:  [13.28809815]
curr_Stock_Price:  96.60498237592252
curr_Factors:  [9.66049824e+01 3.98417606e-02]
mat_Sqrt:  [[ 1.92827418e+01  0.00000000e+00]
 [-7.98416038e-03  1.82940096e-02]]
grads:  [-0.01362062  6.24509739]
Stock Position:  -0.013620617975168179
Bond Position:  [14.60391771]


portfolio before change:  [13.30805813]
curr_Stock_Price:  95.407640582394
curr_Factors:  [9.54076406e+01 4.05601097e-02]
mat_Sqrt:  [[ 1.92146605e+01  0.00000000e+00]
 [-8.05581625e-03  1.84581939e-02]]
grads:  [1.55475788e-03 8.32819876e+00]
Stock Position:  0.0015547578842137317
Bond Position:  [13.15972234]


portfolio before change:  [13.31135738]
curr_Stock_Price:  95.41337605526014
curr_Factors:  [9.54133761e+01 4.13732592e-02]
mat_Sqrt:  [[ 1.94074792e+01  0.00000000e+00]
 [-8.13616708e-03  1.86423008e-02]]
grads:  [-0.00999455  4.1942466 ]
Stock Position:  -0.009994553380948191
Bond Position:  [14.26497146]


portfolio before change:  [13.32089355]
curr_Stock_Price:  94.81610314702293
curr_Factors:  [9.48161031e+01 4.24332101e-02]
mat_Sqrt:  [[ 1.95314752e+01  0.00000000e+00]
 [-8.23972913e-03  1.88795912e-02]]
grads:  [0.00766456 0.62011879]
Stock Position:  0.007664561608019349
Bond Position:  [12.59416969]


portfolio before change:  [13.31460072]
curr_Stock_Price:  93.58423063517466
curr_Factors:  [9.35842306e+01 4.55915522e-02]
mat_Sqrt:  [[ 1.99822719e+01  0.00000000e+00]
 [-8.54087135e-03  1.95695947e-02]]
grads:  [-0.00608746 -2.14724049]
Stock Position:  -0.006087463059850373
Bond Position:  [13.88429127]


portfolio before change:  [13.3039525]
curr_Stock_Price:  95.90370721048384
curr_Factors:  [9.59037072e+01 4.53835201e-02]
mat_Sqrt:  [[ 2.04307582e+01  0.00000000e+00]
 [-8.52136328e-03  1.95248961e-02]]
grads:  [-0.00763188  2.27698822]
Stock Position:  -0.007631877835171708
Bond Position:  [14.03587788]


portfolio before change:  [13.31231305]
curr_Stock_Price:  95.2680658137357
curr_Factors:  [9.52680658e+01 4.45688090e-02]
mat_Sqrt:  [[ 2.01123520e+01  0.00000000e+00]
 [-8.44453044e-03  1.93488500e-02]]
grads:  [1.17835922e-04 3.66779877e-01]
Stock Position:  0.000117835921914271
Bond Position:  [13.30108705]


portfolio before change:  [13.31590674]
curr_Stock_Price:  97.54246574391968
curr_Factors:  [9.75424657e+01 4.38077110e-02]
mat_Sqrt:  [[ 2.04159226e+01  0.00000000e+00]
 [-8.37211668e-03  1.91829292e-02]]
grads:  [-1.00201180e-02 -1.16800218e+01]
Stock Position:  -0.010020117954839973
Bond Position:  [14.29329375]


portfolio before change:  [13.30190953]
curr_Stock_Price:  99.29603609216609
curr_Factors:  [9.92960361e+01 4.40544648e-02]
mat_Sqrt:  [[ 2.08413994e+01  0.00000000e+00]
 [-8.39566219e-03  1.92368787e-02]]
grads:  [-0.00683623 -6.24809007]
Stock Position:  -0.006836234869348906
Bond Position:  [13.98072055]


portfolio before change:  [13.30328931]
curr_Stock_Price:  99.60553953660819
curr_Factors:  [9.96055395e+01 4.56846833e-02]
mat_Sqrt:  [[ 2.12896637e+01  0.00000000e+00]
 [-8.54959024e-03  1.95895722e-02]]
grads:  [0.00547274 2.59739673]
Stock Position:  0.005472742062692255
Bond Position:  [12.75817388]


portfolio before change:  [13.31675942]
curr_Stock_Price:  101.48397046674671
curr_Factors:  [1.0148397e+02 4.4403927e-02]
mat_Sqrt:  [[ 2.13849451e+01  0.00000000e+00]
 [-8.42889573e-03  1.93130264e-02]]
grads:  [-0.0028597  -1.05237927]
Stock Position:  -0.002859704373944361
Bond Position:  [13.60697357]


portfolio before change:  [13.31743841]
curr_Stock_Price:  102.43622944545281
curr_Factors:  [1.02436229e+02 4.23936115e-02]
mat_Sqrt:  [[ 2.10913215e+01  0.00000000e+00]
 [-8.23588358e-03  1.88707800e-02]]
grads:  [  0.01224495 -11.83800614]
Stock Position:  0.012244953273001014
Bond Position:  [12.06311156]


portfolio before change:  [13.31590298]
curr_Stock_Price:  102.06451846213037
curr_Factors:  [1.02064518e+02 4.40944402e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.31590298]
Stock Price:  99.47043703188048
PL:  [13.31590298]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-6.94465011e-02  1.26671515e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.79096812e-01 -6.82561541e-01]
 [-3.79669987e-02  2.75652128e-01]
 [-4.11054854e-01 -7.28392421e-02]
 [ 1.10132707e-01 -9.32144304e-02]
 [-3.26609013e-01  1.21981591e-01]
 [ 2.00969270e-02  1.59038356e-01]
 [-2.04705424e-01 -1.29373973e-02]
 [ 2.10697717e-01  7.56517643e-03]
 [ 5.15162562e-02  1.27747589e-01]
 [-2.36194261e-01  6.14532255e-02]
 [-8.69199563e-02  3.32139278e-02]
 [-1.19391457e-01 -2.29942532e-01]
 [-1.54418501e-01 -1.46557246e-01]
 [ 8.85208419e-02  5.81531932e-02]
 [ 4.75387080e-02 -7.89256321e-02]
 [ 7.71458358e-01 -3.66919128e-01]
 [ 2.10226844e-01  1.28172643e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.18579757]
curr_Stock_Price:  100.66374646906566
curr_Factors:  [1.00663746e+02 3.97490682e-02]
mat_Sqrt:  [[ 2.00695006e+01  0.00000000e+00]
 [-7.97486735e-03  1.82727166e-02]]
grads:  [-7.05673746e-04  6.93227599e+00]
Stock Position:  -0.0007056737457721
Bond Position:  [7.25683333]


portfolio before change:  [7.18767726]
curr_Stock_Price:  100.57127075309876
curr_Factors:  [1.00571271e+02 4.03798938e-02]
mat_Sqrt:  [[ 2.02095445e+01  0.00000000e+00]
 [-8.03789961e-03  1.84171417e-02]]
grads:  [-0.00921965 -3.61901816]
Stock Position:  -0.00921964721465629
Bond Position:  [8.1149089]


portfolio before change:  [7.19720027]
curr_Stock_Price:  99.75843770136935
curr_Factors:  [9.97584377e+01 4.18075812e-02]
mat_Sqrt:  [[ 2.03975103e+01  0.00000000e+00]
 [-8.17876090e-03  1.87398955e-02]]
grads:  [-2.33847702e-02 -3.64229108e+01]
Stock Position:  -0.02338477022346804
Bond Position:  [9.53002842]


portfolio before change:  [7.23149431]
curr_Stock_Price:  98.39382169171806
curr_Factors:  [9.83938217e+01 4.37452056e-02]
mat_Sqrt:  [[ 2.05794167e+01  0.00000000e+00]
 [-8.36614182e-03  1.91692391e-02]]
grads:  [4.00096146e-03 1.43799202e+01]
Stock Position:  0.004000961458939311
Bond Position:  [6.83782442]


portfolio before change:  [7.23067857]
curr_Stock_Price:  97.76262040528714
curr_Factors:  [9.77626204e+01 4.19380210e-02]
mat_Sqrt:  [[ 2.00205867e+01  0.00000000e+00]
 [-8.19150985e-03  1.87691070e-02]]
grads:  [-0.02211946 -3.88080489]
Stock Position:  -0.022119456962252034
Bond Position:  [9.39313464]


portfolio before change:  [7.2186966]
curr_Stock_Price:  98.41049094509728
curr_Factors:  [9.84104909e+01 4.22241777e-02]
mat_Sqrt:  [[ 2.02219019e+01  0.00000000e+00]
 [-8.21940900e-03  1.88330320e-02]]
grads:  [ 3.43442446e-03 -4.94951799e+00]
Stock Position:  0.003434424457414633
Bond Position:  [6.8807132]


portfolio before change:  [7.21520093]
curr_Stock_Price:  96.89173037175345
curr_Factors:  [9.68917304e+01 4.14873934e-02]
mat_Sqrt:  [[ 1.97353479e+01  0.00000000e+00]
 [-8.14738175e-03  1.86679968e-02]]
grads:  [-0.01385189  6.53426248]
Stock Position:  -0.013851890698999704
Bond Position:  [8.55733459]


portfolio before change:  [7.21586987]
curr_Stock_Price:  96.99790033913703
curr_Factors:  [9.69979003e+01 4.13840630e-02]
mat_Sqrt:  [[ 1.97323539e+01  0.00000000e+00]
 [-8.13722931e-03  1.86447346e-02]]
grads:  [4.53605061e-03 8.52993403e+00]
Stock Position:  0.004536050611822925
Bond Position:  [6.77588249]


portfolio before change:  [7.22162227]
curr_Stock_Price:  97.89255774897036
curr_Factors:  [9.78925577e+01 4.09570847e-02]
mat_Sqrt:  [[ 1.98113556e+01  0.00000000e+00]
 [-8.09514271e-03  1.85483021e-02]]
grads:  [-0.01061774 -0.69749766]
Stock Position:  -0.010617737155246068
Bond Position:  [8.26101971]


portfolio before change:  [7.23087534]
curr_Stock_Price:  97.21561892697484
curr_Factors:  [9.72156189e+01 4.04173712e-02]
mat_Sqrt:  [[ 1.95442981e+01  0.00000000e+00]
 [-8.04162881e-03  1.84256864e-02]]
grads:  [0.01094946 0.41057773]
Stock Position:  0.010949455940543432
Bond Position:  [6.1664172]


portfolio before change:  [7.25810457]
curr_Stock_Price:  99.56162020009727
curr_Factors:  [9.95616202e+01 3.85887465e-02]
mat_Sqrt:  [[ 1.95579032e+01  0.00000000e+00]
 [-7.85760743e-03  1.80040404e-02]]
grads:  [5.48473291e-03 7.09549560e+00]
Stock Position:  0.005484732909996935
Bond Position:  [6.71203568]


portfolio before change:  [7.2541495]
curr_Stock_Price:  98.53453379750721
curr_Factors:  [9.85345338e+01 4.01960541e-02]
mat_Sqrt:  [[ 1.97551430e+01  0.00000000e+00]
 [-8.01958145e-03  1.83751695e-02]]
grads:  [-0.01059845  3.34436237]
Stock Position:  -0.010598448962665057
Bond Position:  [8.29846272]


portfolio before change:  [7.25937895]
curr_Stock_Price:  98.23688812280389
curr_Factors:  [9.82368881e+01 3.95431170e-02]
mat_Sqrt:  [[ 1.95348485e+01  0.00000000e+00]
 [-7.95418048e-03  1.82253171e-02]]
grads:  [-0.00370744  1.82240603]
Stock Position:  -0.003707436479241745
Bond Position:  [7.62358598]


portfolio before change:  [7.26249462]
curr_Stock_Price:  97.91064423976316
curr_Factors:  [9.79106442e+01 3.81614296e-02]
mat_Sqrt:  [[ 1.91267960e+01  0.00000000e+00]
 [-7.81398025e-03  1.79040780e-02]]
grads:  [-1.14889397e-02 -1.28430256e+01]
Stock Position:  -0.011488939655483976
Bond Position:  [8.3873841]


portfolio before change:  [7.27925551]
curr_Stock_Price:  96.63430544871154
curr_Factors:  [9.66343054e+01 3.69622197e-02]
mat_Sqrt:  [[ 1.85784874e+01  0.00000000e+00]
 [-7.69022441e-03  1.76205177e-02]]
grads:  [-0.01175453 -8.31741998]
Stock Position:  -0.011754526765762826
Bond Position:  [8.41514604]


portfolio before change:  [7.28184146]
curr_Stock_Price:  96.59330799347495
curr_Factors:  [9.65933080e+01 3.78424139e-02]
mat_Sqrt:  [[ 1.87904186e+01  0.00000000e+00]
 [-7.78125068e-03  1.78290851e-02]]
grads:  [0.00606165 3.26170371]
Stock Position:  0.0060616518739017725
Bond Position:  [6.69632645]


portfolio before change:  [7.28538729]
curr_Stock_Price:  96.9020592392075
curr_Factors:  [9.69020592e+01 4.02523449e-02]
mat_Sqrt:  [[ 1.94414476e+01  0.00000000e+00]
 [-8.02519481e-03  1.83880313e-02]]
grads:  [ 6.73444611e-04 -4.29222849e+00]
Stock Position:  0.0006734446113493611
Bond Position:  [7.22012912]


portfolio before change:  [7.2870898]
curr_Stock_Price:  96.74947956058928
curr_Factors:  [9.67494796e+01 4.05084636e-02]
mat_Sqrt:  [[ 1.94724915e+01  0.00000000e+00]
 [-8.05068580e-03  1.84464385e-02]]
grads:  [  0.03139412 -19.89105525]
Stock Position:  0.03139411927686758
Bond Position:  [4.2497251]


portfolio before change:  [7.36683371]
curr_Stock_Price:  99.25572451335806
curr_Factors:  [9.92557245e+01 3.92662377e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.36683371]
Stock Price:  96.23883896900995
PL:  [7.36683371]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.16677335e-01 -9.38968100e-01]
 [-3.67678527e-02  2.75777790e-01]
 [-4.13513885e-01 -6.57652868e-02]
 [ 1.17704114e-01 -1.02494384e-01]
 [-3.28282728e-01  1.22899329e-01]
 [ 1.65375152e-01  1.45679220e-01]
 [-1.90469814e-01 -5.15571916e-02]
 [ 3.18488478e-01  4.80925510e-03]
 [ 1.74342777e-01  2.52466946e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-5.04724154e-02  8.62570639e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 1.98998890e-01  1.44202254e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.25280303e-02  1.55327879e-01]
 [ 1.59894717e-01 -1.71497973e-02]
 [ 9.59541037e-02  8.76750913e-04]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.61497738]
curr_Stock_Price:  99.3862850304856
curr_Factors:  [9.93862850e+01 4.01126616e-02]
mat_Sqrt:  [[ 1.99052299e+01  0.00000000e+00]
 [-8.01125824e-03  1.83560986e-02]]
grads:  [ 0.00140021 -0.07359049]
Stock Position:  0.0014002138031119307
Bond Position:  [-1.75413943]


portfolio before change:  [-1.61522444]
curr_Stock_Price:  99.5230731870128
curr_Factors:  [9.95230732e+01 3.99944681e-02]
mat_Sqrt:  [[ 1.99032382e+01  0.00000000e+00]
 [-7.99944679e-03  1.83290352e-02]]
grads:  [-0.00936154 -3.63641454]
Stock Position:  -0.009361535459691246
Bond Position:  [-0.68353566]


portfolio before change:  [-1.59966233]
curr_Stock_Price:  97.84247159086651
curr_Factors:  [9.78424716e+01 4.14025429e-02]
mat_Sqrt:  [[ 1.99086093e+01  0.00000000e+00]
 [-8.13904593e-03  1.86488970e-02]]
grads:  [-3.14676230e-02 -5.03497927e+01]
Stock Position:  -0.03146762297759549
Bond Position:  [1.47920768]


portfolio before change:  [-1.61283003]
curr_Stock_Price:  98.27267714122249
curr_Factors:  [9.82726771e+01 3.88093881e-02]
mat_Sqrt:  [[ 1.93598142e+01  0.00000000e+00]
 [-7.88003940e-03  1.80554385e-02]]
grads:  [4.31778122e-03 1.52739458e+01]
Stock Position:  0.004317781224568802
Bond Position:  [-2.03714995]


portfolio before change:  [-1.61740805]
curr_Stock_Price:  97.33037100972737
curr_Factors:  [9.73303710e+01 3.71927231e-02]
mat_Sqrt:  [[ 1.87705659e+01  0.00000000e+00]
 [-7.71416599e-03  1.76753748e-02]]
grads:  [-0.02355902 -3.72072941]
Stock Position:  -0.023559023761018004
Bond Position:  [0.67560047]


portfolio before change:  [-1.64395539]
curr_Stock_Price:  98.4643849157909
curr_Factors:  [9.84643849e+01 3.53085135e-02]
mat_Sqrt:  [[ 1.85020091e+01  0.00000000e+00]
 [-7.51622390e-03  1.72218325e-02]]
grads:  [ 3.94399855e-03 -5.95142152e+00]
Stock Position:  0.003943998551048637
Bond Position:  [-2.03229878]


portfolio before change:  [-1.64967469]
curr_Stock_Price:  97.14309595526527
curr_Factors:  [9.71430960e+01 3.49124547e-02]
mat_Sqrt:  [[ 1.81510659e+01  0.00000000e+00]
 [-7.47394993e-03  1.71249706e-02]]
grads:  [-0.01513107  7.17661544]
Stock Position:  -0.015131070833336337
Bond Position:  [-0.17979562]


portfolio before change:  [-1.7038913]
curr_Stock_Price:  100.72325599081282
curr_Factors:  [1.00723256e+02 3.34338680e-02]
mat_Sqrt:  [[ 1.84171773e+01  0.00000000e+00]
 [-7.31397216e-03  1.67584155e-02]]
grads:  [0.01243159 8.69289936]
Stock Position:  0.01243158885340842
Bond Position:  [-2.95604141]


portfolio before change:  [-1.69800854]
curr_Stock_Price:  101.25592022506441
curr_Factors:  [1.01255920e+02 3.27457406e-02]
mat_Sqrt:  [[ 1.83230528e+01  0.00000000e+00]
 [-7.23831368e-03  1.65850602e-02]]
grads:  [-0.01162313 -3.10865267]
Stock Position:  -0.011623129580956458
Bond Position:  [-0.52109786]


portfolio before change:  [-1.69141747]
curr_Stock_Price:  100.67764534576419
curr_Factors:  [1.00677645e+02 3.32615779e-02]
mat_Sqrt:  [[ 1.83613443e+01  0.00000000e+00]
 [-7.29510279e-03  1.67151804e-02]]
grads:  [0.01745991 0.28771781]
Stock Position:  0.017459909499731363
Bond Position:  [-3.44924004]


portfolio before change:  [-1.65102202]
curr_Stock_Price:  103.04065123897057
curr_Factors:  [1.03040651e+02 3.28818087e-02]
mat_Sqrt:  [[ 1.86847136e+01  0.00000000e+00]
 [-7.25333675e-03  1.66194823e-02]]
grads:  [ 0.01522787 15.19102345]
Stock Position:  0.015227869829258632
Bond Position:  [-3.22011164]


portfolio before change:  [-1.65095797]
curr_Stock_Price:  103.09772899187165
curr_Factors:  [1.03097729e+02 3.27150466e-02]
mat_Sqrt:  [[ 1.86475968e+01  0.00000000e+00]
 [-7.23492049e-03  1.65772854e-02]]
grads:  [-0.01013578  6.89697506]
Stock Position:  -0.010135781347044816
Bond Position:  [-0.60598193]


portfolio before change:  [-1.66669824]
curr_Stock_Price:  104.63572131077461
curr_Factors:  [1.04635721e+02 3.32506489e-02]
mat_Sqrt:  [[ 1.90800731e+01  0.00000000e+00]
 [-7.29390418e-03  1.67124340e-02]]
grads:  [-6.72258767e-04  5.16125083e+00]
Stock Position:  -0.00067225876651788
Bond Position:  [-1.59635596]


portfolio before change:  [-1.66684133]
curr_Stock_Price:  104.25484618307274
curr_Factors:  [1.04254846e+02 3.26378836e-02]
mat_Sqrt:  [[ 1.88346367e+01  0.00000000e+00]
 [-7.22638317e-03  1.65577239e-02]]
grads:  [ -0.02181303 -15.06664735]
Stock Position:  -0.021813034629673697
Bond Position:  [0.60727324]


portfolio before change:  [-1.69799244]
curr_Stock_Price:  105.68990285151534
curr_Factors:  [1.05689903e+02 3.25047418e-02]
mat_Sqrt:  [[ 1.90549081e+01  0.00000000e+00]
 [-7.21162858e-03  1.65239169e-02]]
grads:  [0.01374627 8.72688085]
Stock Position:  0.013746270106223667
Bond Position:  [-3.15083439]


portfolio before change:  [-1.69545662]
curr_Stock_Price:  105.93168642345367
curr_Factors:  [1.05931686e+02 3.22982520e-02]
mat_Sqrt:  [[ 1.90377402e+01  0.00000000e+00]
 [-7.18868577e-03  1.64713484e-02]]
grads:  [0.0050424  1.06433641]
Stock Position:  0.005042401531057324
Bond Position:  [-2.22960672]


portfolio before change:  [-1.69653487]
curr_Stock_Price:  105.82840665116673
curr_Factors:  [1.05828407e+02 3.23766236e-02]
mat_Sqrt:  [[ 1.90422401e+01  0.00000000e+00]
 [-7.19740216e-03  1.64913201e-02]]
grads:  [8.01513571e-04 9.41876564e+00]
Stock Position:  0.0008015135710713252
Bond Position:  [-1.78135777]


portfolio before change:  [-1.69652524]
curr_Stock_Price:  106.39610793938895
curr_Factors:  [1.06396108e+02 3.21289357e-02]
mat_Sqrt:  [[ 1.90710195e+01  0.00000000e+00]
 [-7.16981848e-03  1.64281180e-02]]
grads:  [ 0.0079917  -1.04392952]
Stock Position:  0.007991703406089514
Bond Position:  [-2.54681138]


portfolio before change:  [-1.70775447]
curr_Stock_Price:  105.070678067189
curr_Factors:  [1.05070678e+02 3.35398867e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.70775447]
Stock Price:  103.55273124646077
PL:  [-5.26048572]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 8.39757250e-02  3.57227880e-01]
 [ 2.19477836e-01  9.12932952e-03]
 [-1.33051996e-01 -3.68404322e-01]
 [ 2.44039432e-01 -1.14180442e-01]
 [-1.77993139e-01 -8.56095794e-02]
 [ 6.99386564e-01 -9.58410900e-01]
 [-6.21876580e-01  6.03781982e-01]
 [ 5.89824142e-01  1.79019316e-01]
 [ 1.19465487e-01 -1.18534257e-01]
 [ 7.90772739e-02  1.98982744e-02]
 [ 1.72623050e-01  2.49721431e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-3.28055413e-02  7.32055579e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 1.94434329e-01  1.30154569e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.22095763e-02 -3.61018610e-03]
 [ 3.05709489e-01 -2.08830200e-01]
 [ 2.00623859e-01  8.75602675e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.16483833]
curr_Stock_Price:  102.2573903580045
curr_Factors:  [1.0225739e+02 3.8964662e-02]
mat_Sqrt:  [[ 2.01850654e+01  0.00000000e+00]
 [-7.89578743e-03  1.80915218e-02]]
grads:  [1.18841702e-02 1.97455960e+01]
Stock Position:  0.011884170225689916
Bond Position:  [16.9495941]


portfolio before change:  [18.18904147]
curr_Stock_Price:  103.93737392605982
curr_Factors:  [1.03937374e+02 3.75657345e-02]
mat_Sqrt:  [[ 2.01450190e+01  0.00000000e+00]
 [-7.75275274e-03  1.77637881e-02]]
grads:  [0.01109268 0.5139292 ]
Stock Position:  0.011092677624132173
Bond Position:  [17.03609769]


portfolio before change:  [18.17543213]
curr_Stock_Price:  102.32650058537628
curr_Factors:  [1.02326501e+02 3.76219998e-02]
mat_Sqrt:  [[ 1.98476485e+01  0.00000000e+00]
 [-7.75855655e-03  1.77770863e-02]]
grads:  [-1.48046165e-02 -2.07235491e+01]
Stock Position:  -0.014804616453924535
Bond Position:  [19.69033672]


portfolio before change:  [18.17388751]
curr_Stock_Price:  102.76337906384443
curr_Factors:  [1.02763379e+02 3.87114731e-02]
mat_Sqrt:  [[ 2.02189326e+01  0.00000000e+00]
 [-7.87009256e-03  1.80326474e-02]]
grads:  [ 0.00960521 -6.33187345]
Stock Position:  0.009605205471642847
Bond Position:  [17.18682414]


portfolio before change:  [18.17286235]
curr_Stock_Price:  102.20926282855392
curr_Factors:  [1.02209263e+02 3.65592262e-02]
mat_Sqrt:  [[ 1.95428885e+01  0.00000000e+00]
 [-7.64818684e-03  1.75241976e-02]]
grads:  [-0.01101967 -4.88522109]
Stock Position:  -0.011019672089228777
Bond Position:  [19.29917492]


portfolio before change:  [18.15449097]
curr_Stock_Price:  104.31429666342021
curr_Factors:  [1.04314297e+02 3.58055690e-02]
mat_Sqrt:  [[ 1.97387263e+01  0.00000000e+00]
 [-7.56894381e-03  1.73426290e-02]]
grads:  [ 1.42411294e-02 -5.52632995e+01]
Stock Position:  0.014241129399803234
Bond Position:  [16.66893757]


portfolio before change:  [18.17973711]
curr_Stock_Price:  105.79440307681085
curr_Factors:  [1.05794403e+02 3.30666450e-02]
mat_Sqrt:  [[ 1.92379042e+01  0.00000000e+00]
 [-7.27369452e-03  1.66661279e-02]]
grads:  [-1.86280436e-02  3.62280901e+01]
Stock Position:  -0.018628043646086737
Bond Position:  [20.15047987]


portfolio before change:  [18.20001273]
curr_Stock_Price:  104.9764227344386
curr_Factors:  [1.04976423e+02 3.44319624e-02]
mat_Sqrt:  [[ 1.94792691e+01  0.00000000e+00]
 [-7.42234059e-03  1.70067188e-02]]
grads:  [ 0.03429054 10.52638772]
Stock Position:  0.03429053591838817
Bond Position:  [14.60031494]


portfolio before change:  [18.19870164]
curr_Stock_Price:  104.83172879808339
curr_Factors:  [1.04831729e+02 3.57347694e-02]
mat_Sqrt:  [[ 1.98170151e+01  0.00000000e+00]
 [-7.56145693e-03  1.73254744e-02]]
grads:  [ 3.41791615e-03 -6.84161681e+00]
Stock Position:  0.0034179161535968605
Bond Position:  [17.84039558]


portfolio before change:  [18.20318638]
curr_Stock_Price:  104.83877668362047
curr_Factors:  [1.04838777e+02 3.63334168e-02]
mat_Sqrt:  [[ 1.99836615e+01  0.00000000e+00]
 [-7.62453060e-03  1.74699943e-02]]
grads:  [0.00439167 1.13899719]
Stock Position:  0.0043916672965143115
Bond Position:  [17.74276936]


portfolio before change:  [18.19961599]
curr_Stock_Price:  103.01563438152846
curr_Factors:  [1.03015634e+02 3.79634481e-02]
mat_Sqrt:  [[ 2.00717836e+01  0.00000000e+00]
 [-7.79368443e-03  1.78575744e-02]]
grads:  [ 0.01403016 13.98406219]
Stock Position:  0.01403016404986087
Bond Position:  [16.75428974]


portfolio before change:  [18.21539681]
curr_Stock_Price:  103.8418342694781
curr_Factors:  [1.03841834e+02 3.80937207e-02]
mat_Sqrt:  [[ 2.02674471e+01  0.00000000e+00]
 [-7.80704510e-03  1.78881876e-02]]
grads:  [-0.00932569  6.39154322]
Stock Position:  -0.009325691746702955
Bond Position:  [19.18379375]


portfolio before change:  [18.22056359]
curr_Stock_Price:  103.80213460023018
curr_Factors:  [1.03802135e+02 3.86786796e-02]
mat_Sqrt:  [[ 2.04146578e+01  0.00000000e+00]
 [-7.86675837e-03  1.80250079e-02]]
grads:  [-4.19314623e-05  4.06133293e+00]
Stock Position:  -4.193146226213445e-05
Bond Position:  [18.22491616]


portfolio before change:  [18.22509245]
curr_Stock_Price:  104.46832577147815
curr_Factors:  [1.04468326e+02 3.96103200e-02]
mat_Sqrt:  [[ 2.07916430e+01  0.00000000e+00]
 [-7.96093663e-03  1.82407974e-02]]
grads:  [ -0.01975989 -13.6764519 ]
Stock Position:  -0.019759890107922597
Bond Position:  [20.28937509]


portfolio before change:  [18.21167652]
curr_Stock_Price:  105.40400452289622
curr_Factors:  [1.05404005e+02 4.08556134e-02]
mat_Sqrt:  [[ 2.13050706e+01  0.00000000e+00]
 [-8.08510862e-03  1.85253111e-02]]
grads:  [0.01179242 7.02576966]
Stock Position:  0.011792424619995365
Bond Position:  [16.96870774]


portfolio before change:  [18.18384557]
curr_Stock_Price:  102.68415187363317
curr_Factors:  [1.02684152e+02 4.35256886e-02]
mat_Sqrt:  [[ 2.14228006e+01  0.00000000e+00]
 [-8.34512443e-03  1.91210822e-02]]
grads:  [0.00448102 0.91684433]
Stock Position:  0.004481016836464834
Bond Position:  [17.72371615]


portfolio before change:  [18.18474819]
curr_Stock_Price:  101.89663925722279
curr_Factors:  [1.01896639e+02 4.15642073e-02]
mat_Sqrt:  [[ 2.07739753e+01  0.00000000e+00]
 [-8.15492071e-03  1.86852707e-02]]
grads:  [-0.00258907 -0.19321026]
Stock Position:  -0.0025890658795615406
Bond Position:  [18.44856531]


portfolio before change:  [18.1858724]
curr_Stock_Price:  103.24403946211197
curr_Factors:  [1.03244039e+02 4.14618602e-02]
mat_Sqrt:  [[ 2.10227429e+01  0.00000000e+00]
 [-8.14487423e-03  1.86622514e-02]]
grads:  [ 1.02064949e-02 -1.11899789e+01]
Stock Position:  0.010206494888497954
Bond Position:  [17.13211264]


portfolio before change:  [18.17551594]
curr_Stock_Price:  101.80965639261916
curr_Factors:  [1.01809656e+02 4.24616212e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.17551594]
Stock Price:  100.67356607647402
PL:  [17.50194987]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.02702464e-02  1.25433626e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.06089817e-01 -8.66730977e-01]
 [ 7.24547098e-02  1.58147069e-01]
 [-2.46453068e-01 -9.47206483e-02]
 [ 4.83051341e-01 -6.23708157e-01]
 [-5.49359386e-01  3.48697187e-01]
 [ 1.54863739e-01  1.44853557e-01]
 [-1.12114324e-01 -1.96999953e-02]
 [ 1.68145017e-01  1.50677737e-02]
 [ 2.00012956e-01  2.93448931e-01]
 [-2.38742388e-01  1.11123769e-01]
 [-1.05380887e-02  3.93657029e-02]
 [-2.34786692e-01 -2.74063285e-01]
 [-6.80312621e-02 -1.10579209e-01]
 [ 9.49492427e-02  2.74835323e-02]
 [-5.16449424e-02  1.16102297e-02]
 [ 3.09795154e-01 -2.09999395e-01]
 [ 1.11795646e-01  1.44425653e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.12837205]
curr_Stock_Price:  100.65541096685908
curr_Factors:  [1.00655411e+02 4.02069702e-02]
mat_Sqrt:  [[ 2.01830967e+01  0.00000000e+00]
 [-8.02067031e-03  1.83776644e-02]]
grads:  [-7.69283541e-04  6.82533007e+00]
Stock Position:  -0.0007692835410909068
Bond Position:  [7.2058046]


portfolio before change:  [7.13134162]
curr_Stock_Price:  99.13726043029169
curr_Factors:  [9.91372604e+01 3.86594465e-02]
mat_Sqrt:  [[ 1.94923737e+01  0.00000000e+00]
 [-7.86480225e-03  1.80205258e-02]]
grads:  [-0.00955886 -3.69866955]
Stock Position:  -0.009558859931951307
Bond Position:  [8.0789808]


portfolio before change:  [7.14096929]
curr_Stock_Price:  98.3413832619056
curr_Factors:  [9.83413833e+01 3.98445003e-02]
mat_Sqrt:  [[ 1.96300093e+01  0.00000000e+00]
 [-7.98443489e-03  1.82946386e-02]]
grads:  [-2.97688207e-02 -4.73762283e+01]
Stock Position:  -0.029768820743997823
Bond Position:  [10.0684763]


portfolio before change:  [7.08740415]
curr_Stock_Price:  100.22532017653022
curr_Factors:  [1.00225320e+02 4.35299684e-02]
mat_Sqrt:  [[ 2.09108472e+01  0.00000000e+00]
 [-8.34553470e-03  1.91220222e-02]]
grads:  [6.76566320e-03 8.27041548e+00]
Stock Position:  0.006765663197533927
Bond Position:  [6.40931339]


portfolio before change:  [7.0963893]
curr_Stock_Price:  101.31651080519289
curr_Factors:  [1.01316511e+02 4.23210659e-02]
mat_Sqrt:  [[ 2.08429182e+01  0.00000000e+00]
 [-8.22883378e-03  1.88546268e-02]]
grads:  [-0.01380769 -5.02373498]
Stock Position:  -0.013807689792811996
Bond Position:  [8.49533626]


portfolio before change:  [7.09125322]
curr_Stock_Price:  101.84231829516942
curr_Factors:  [1.01842318e+02 4.11314856e-02]
mat_Sqrt:  [[ 2.06545375e+01  0.00000000e+00]
 [-8.11235952e-03  1.85877508e-02]]
grads:  [ 1.02080613e-02 -3.35547944e+01]
Stock Position:  0.010208061288445555
Bond Position:  [6.05164059]


portfolio before change:  [7.09331208]
curr_Stock_Price:  101.89578264661587
curr_Factors:  [1.01895783e+02 3.91961722e-02]
mat_Sqrt:  [[ 2.01733507e+01  0.00000000e+00]
 [-7.91920927e-03  1.81451880e-02]]
grads:  [-0.01968813 19.21706117]
Stock Position:  -0.019688125355315035
Bond Position:  [9.09944903]


portfolio before change:  [7.12059499]
curr_Stock_Price:  100.62558767501892
curr_Factors:  [1.00625588e+02 3.91796242e-02]
mat_Sqrt:  [[ 1.99176714e+01  0.00000000e+00]
 [-7.91753741e-03  1.81413573e-02]]
grads:  [0.01094922 7.98471445]
Stock Position:  0.010949222453857066
Bond Position:  [6.01882304]


portfolio before change:  [7.14036172]
curr_Stock_Price:  102.29345423541551
curr_Factors:  [1.02293454e+02 3.67650618e-02]
mat_Sqrt:  [[ 1.96139694e+01  0.00000000e+00]
 [-7.66968701e-03  1.75734606e-02]]
grads:  [-0.00615439 -1.12100831]
Stock Position:  -0.006154394541324277
Bond Position:  [7.769916]


portfolio before change:  [7.1360979]
curr_Stock_Price:  103.30192886732637
curr_Factors:  [1.03301929e+02 3.59364852e-02]
mat_Sqrt:  [[ 1.95828650e+01  0.00000000e+00]
 [-7.58276838e-03  1.73743050e-02]]
grads:  [0.00892214 0.86724468]
Stock Position:  0.008922143560951709
Bond Position:  [6.21442326]


portfolio before change:  [7.14274939]
curr_Stock_Price:  103.8732823013557
curr_Factors:  [1.03873282e+02 3.47506391e-02]
mat_Sqrt:  [[ 1.93635621e+01  0.00000000e+00]
 [-7.45660932e-03  1.70852383e-02]]
grads:  [1.69433995e-02 1.71755831e+01]
Stock Position:  0.016943399509566966
Bond Position:  [5.38278287]


portfolio before change:  [7.12527045]
curr_Stock_Price:  102.76224163203803
curr_Factors:  [1.02762242e+02 3.56990719e-02]
mat_Sqrt:  [[ 1.94161014e+01  0.00000000e+00]
 [-7.55767921e-03  1.73168185e-02]]
grads:  [-0.00979826  6.41710075]
Stock Position:  -0.009798259453081767
Bond Position:  [8.13216156]


portfolio before change:  [7.14590405]
curr_Stock_Price:  100.86391446659405
curr_Factors:  [1.00863914e+02 3.58017145e-02]
mat_Sqrt:  [[ 1.90848052e+01  0.00000000e+00]
 [-7.56853640e-03  1.73416955e-02]]
grads:  [3.48052415e-04 2.27000313e+00]
Stock Position:  0.0003480524152400517
Bond Position:  [7.11079812]


portfolio before change:  [7.14761]
curr_Stock_Price:  100.65712867940414
curr_Factors:  [1.00657129e+02 3.16904414e-02]
mat_Sqrt:  [[ 1.79187901e+01  0.00000000e+00]
 [-7.12072371e-03  1.63156277e-02]]
grads:  [ -0.01977799 -16.79759369]
Stock Position:  -0.019777993639807433
Bond Position:  [9.13840605]


portfolio before change:  [7.16374642]
curr_Stock_Price:  99.95677781692517
curr_Factors:  [9.99567778e+01 3.22369224e-02]
mat_Sqrt:  [[ 1.79468831e+01  0.00000000e+00]
 [-7.18185741e-03  1.64557026e-02]]
grads:  [-6.47978729e-03 -6.71981082e+00]
Stock Position:  -0.006479787287501921
Bond Position:  [7.81144508]


portfolio before change:  [7.15927822]
curr_Stock_Price:  100.94775263248468
curr_Factors:  [1.00947753e+02 3.20735637e-02]
mat_Sqrt:  [[ 1.80788276e+01  0.00000000e+00]
 [-7.16363748e-03  1.64139555e-02]]
grads:  [0.00591543 1.67440032]
Stock Position:  0.00591543002251188
Bond Position:  [6.56212885]


portfolio before change:  [7.16873297]
curr_Stock_Price:  102.26870770177682
curr_Factors:  [1.02268708e+02 3.03736928e-02]
mat_Sqrt:  [[ 1.78234415e+01  0.00000000e+00]
 [-6.97122001e-03  1.59730717e-02]]
grads:  [-0.00261329  0.72686268]
Stock Position:  -0.002613290067382814
Bond Position:  [7.43599077]


portfolio before change:  [7.16811937]
curr_Stock_Price:  103.21496008375969
curr_Factors:  [1.03214960e+02 2.93512828e-02]
mat_Sqrt:  [[ 1.76830100e+01  0.00000000e+00]
 [-6.85288643e-03  1.57019354e-02]]
grads:  [ 1.23363559e-02 -1.33741090e+01]
Stock Position:  0.012336355850444701
Bond Position:  [5.89482289]


portfolio before change:  [7.18593198]
curr_Stock_Price:  104.53939681655778
curr_Factors:  [1.04539397e+02 2.96817126e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.18593198]
Stock Price:  102.92750461235434
PL:  [4.25842737]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-6.44863392e-02  1.34125434e-01]
 [-1.54058512e-01 -6.56552444e-02]
 [-1.10677013e-01 -2.15742997e-01]
 [ 3.21407186e-01 -2.43734083e-01]
 [-8.50735774e-02 -6.68818361e-02]
 [ 6.91080349e-01 -9.45560691e-01]
 [-6.12828891e-01  5.66657417e-01]
 [ 6.29326559e-01  1.82122196e-01]
 [ 7.52189289e-02 -9.39037642e-02]
 [ 1.06718511e-01  1.83991793e-02]
 [ 1.89410528e-01  2.76522344e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.49466843e-02  6.00122235e-02]
 [-2.92005129e-01 -2.15361448e-01]
 [ 2.11120058e-01  1.81593560e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.26125107e-02  1.58335523e-01]
 [ 2.67497543e-01 -1.83899698e-01]
 [ 1.72877762e-01  6.47056903e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.54653611]
curr_Stock_Price:  100.71610885500345
curr_Factors:  [1.00716109e+02 4.14474906e-02]
mat_Sqrt:  [[ 2.05044469e+01  0.00000000e+00]
 [-8.14346271e-03  1.86590171e-02]]
grads:  [-2.90141974e-04  7.18823682e+00]
Stock Position:  -0.00029014197362497047
Bond Position:  [7.57575808]


portfolio before change:  [7.54834793]
curr_Stock_Price:  100.99995596251333
curr_Factors:  [1.00999956e+02 4.17791182e-02]
mat_Sqrt:  [[ 2.06443312e+01  0.00000000e+00]
 [-8.17597634e-03  1.87335152e-02]]
grads:  [-0.00885051 -3.50469432]
Stock Position:  -0.008850507546509843
Bond Position:  [8.4422488]


portfolio before change:  [7.5273343]
curr_Stock_Price:  103.61273912271882
curr_Factors:  [1.03612739e+02 4.14211788e-02]
mat_Sqrt:  [[ 2.10874654e+01  0.00000000e+00]
 [-8.14087748e-03  1.86530936e-02]]
grads:  [-9.71358923e-03 -1.15660705e+01]
Stock Position:  -0.009713589230706164
Bond Position:  [8.53378588]


portfolio before change:  [7.52181437]
curr_Stock_Price:  104.40067061796259
curr_Factors:  [1.04400671e+02 3.96535683e-02]
mat_Sqrt:  [[ 2.07895182e+01  0.00000000e+00]
 [-7.96528150e-03  1.82507527e-02]]
grads:  [ 1.03433331e-02 -1.33547414e+01]
Stock Position:  0.01034333305643034
Bond Position:  [6.44196346]


portfolio before change:  [7.52756723]
curr_Stock_Price:  104.80113799859264
curr_Factors:  [1.04801138e+02 3.66934420e-02]
mat_Sqrt:  [[ 2.00752159e+01  0.00000000e+00]
 [-7.66221294e-03  1.75563354e-02]]
grads:  [-0.00569175 -3.80955562]
Stock Position:  -0.005691754664798906
Bond Position:  [8.12406959]


portfolio before change:  [7.53291267]
curr_Stock_Price:  104.21886237765422
curr_Factors:  [1.04218862e+02 3.61661470e-02]
mat_Sqrt:  [[ 1.98197170e+01  0.00000000e+00]
 [-7.60695965e-03  1.74297342e-02]]
grads:  [ 1.40468116e-02 -5.42498629e+01]
Stock Position:  0.014046811605147033
Bond Position:  [6.06896994]


portfolio before change:  [7.54873793]
curr_Stock_Price:  105.23744436633444
curr_Factors:  [1.05237444e+02 3.35486255e-02]
mat_Sqrt:  [[ 1.92755890e+01  0.00000000e+00]
 [-7.32651355e-03  1.67871515e-02]]
grads:  [-1.89628093e-02  3.37554241e+01]
Stock Position:  -0.018962809306512934
Bond Position:  [9.54433552]


portfolio before change:  [7.54859564]
curr_Stock_Price:  105.37079353652284
curr_Factors:  [1.05370794e+02 3.34244161e-02]
mat_Sqrt:  [[ 1.92642526e+01  0.00000000e+00]
 [-7.31293825e-03  1.67560465e-02]]
grads:  [ 0.03679412 10.86904336]
Stock Position:  0.03679411885989423
Bond Position:  [3.67157013]


portfolio before change:  [7.502482]
curr_Stock_Price:  104.09255537244562
curr_Factors:  [1.04092555e+02 3.69849658e-02]
mat_Sqrt:  [[ 2.00185345e+01  0.00000000e+00]
 [-7.69259028e-03  1.76259386e-02]]
grads:  [ 1.71021342e-03 -5.32758942e+00]
Stock Position:  0.0017102134173420313
Bond Position:  [7.32446151]


portfolio before change:  [7.5047739]
curr_Stock_Price:  104.36185434440259
curr_Factors:  [1.04361854e+02 3.62239638e-02]
mat_Sqrt:  [[ 1.98627681e+01  0.00000000e+00]
 [-7.61303763e-03  1.74436606e-02]]
grads:  [0.00577707 1.05477742]
Stock Position:  0.00577706847033777
Bond Position:  [6.90186832]


portfolio before change:  [7.5018098]
curr_Stock_Price:  103.55006194092283
curr_Factors:  [1.03550062e+02 3.74784189e-02]
mat_Sqrt:  [[ 2.00466124e+01  0.00000000e+00]
 [-7.74373749e-03  1.77431316e-02]]
grads:  [1.54686870e-02 1.55847541e+01]
Stock Position:  0.015468687023102416
Bond Position:  [5.9000263]


portfolio before change:  [7.50180085]
curr_Stock_Price:  103.45411680849698
curr_Factors:  [1.03454117e+02 3.63099989e-02]
mat_Sqrt:  [[ 1.97133710e+01  0.00000000e+00]
 [-7.62207309e-03  1.74643635e-02]]
grads:  [-0.00958781  6.5466528 ]
Stock Position:  -0.009587805345496945
Bond Position:  [8.49369878]


portfolio before change:  [7.50876019]
curr_Stock_Price:  102.94976194997642
curr_Factors:  [1.02949762e+02 3.62853591e-02]
mat_Sqrt:  [[ 1.96106080e+01  0.00000000e+00]
 [-7.61948650e-03  1.74584368e-02]]
grads:  [5.73403808e-04 3.43743396e+00]
Stock Position:  0.0005734038080718479
Bond Position:  [7.44972841]


portfolio before change:  [7.5118036]
curr_Stock_Price:  105.00894039228649
curr_Factors:  [1.05008940e+02 3.51368009e-02]
mat_Sqrt:  [[ 1.96837294e+01  0.00000000e+00]
 [-7.49792514e-03  1.71799048e-02]]
grads:  [ -0.01960993 -12.53566015]
Stock Position:  -0.01960993077405726
Bond Position:  [9.57102165]


portfolio before change:  [7.48610579]
curr_Stock_Price:  106.44142213689179
curr_Factors:  [1.06441422e+02 3.55215505e-02]
mat_Sqrt:  [[ 2.00611870e+01  0.00000000e+00]
 [-7.53886469e-03  1.72737091e-02]]
grads:  [ 0.01447442 10.51271381]
Stock Position:  0.01447441697535492
Bond Position:  [5.94542826]


portfolio before change:  [7.48790544]
curr_Stock_Price:  106.46305396816864
curr_Factors:  [1.06463054e+02 3.38227100e-02]
mat_Sqrt:  [[ 1.95795687e+01  0.00000000e+00]
 [-7.35638063e-03  1.68555855e-02]]
grads:  [0.00490286 1.04007397]
Stock Position:  0.0049028623490259245
Bond Position:  [6.96593174]


portfolio before change:  [7.48690321]
curr_Stock_Price:  105.9033955996531
curr_Factors:  [1.05903396e+02 3.35619879e-02]
mat_Sqrt:  [[ 1.94014292e+01  0.00000000e+00]
 [-7.32797248e-03  1.67904943e-02]]
grads:  [8.49977438e-04 9.43006922e+00]
Stock Position:  0.0008499774375300616
Bond Position:  [7.39688771]


portfolio before change:  [7.48708485]
curr_Stock_Price:  103.94120867768882
curr_Factors:  [1.03941209e+02 3.83047787e-02]
mat_Sqrt:  [[ 2.03429645e+01  0.00000000e+00]
 [-7.82864266e-03  1.79376738e-02]]
grads:  [ 9.20402403e-03 -1.02521487e+01]
Stock Position:  0.009204024030712786
Bond Position:  [6.53040747]


portfolio before change:  [7.4769589]
curr_Stock_Price:  102.66364183011117
curr_Factors:  [1.02663642e+02 3.86536547e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.4769589]
Stock Price:  103.64449408511882
PL:  [3.83246481]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.67815325e-01 -6.05589567e-01]
 [ 5.27615815e-02  1.88560483e-01]
 [-2.39448520e-01 -9.38974792e-02]
 [ 4.91497174e-01 -6.36779848e-01]
 [-5.55504838e-01  3.57674464e-01]
 [ 3.14123305e-01  1.57363257e-01]
 [-5.70930713e-02 -3.67191860e-02]
 [-2.04088533e-02  2.52938057e-02]
 [ 3.25571780e-01  4.93901370e-01]
 [-2.35501530e-01  1.15943599e-01]
 [-1.14901654e-01  1.33854538e-01]
 [-2.38405212e-01 -3.17736814e-02]
 [ 2.04508341e-01  1.61232354e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.34940009e-02  2.16237776e-01]
 [ 1.32660193e-01  2.46972073e-02]
 [-3.74301305e-02 -2.00244840e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.13674462]
curr_Stock_Price:  98.72993563911157
curr_Factors:  [9.87299356e+01 3.96012004e-02]
mat_Sqrt:  [[ 1.96473069e+01  0.00000000e+00]
 [-7.96002014e-03  1.82386974e-02]]
grads:  [ 0.0014186  -0.07406419]
Stock Position:  0.00141859532031388
Bond Position:  [-6.27680244]


portfolio before change:  [-6.13707345]
curr_Stock_Price:  99.60443802041742
curr_Factors:  [9.96044380e+01 4.10871231e-02]
mat_Sqrt:  [[ 2.01897786e+01  0.00000000e+00]
 [-8.10798354e-03  1.85777241e-02]]
grads:  [-0.00922867 -3.58773602]
Stock Position:  -0.009228673279108039
Bond Position:  [-5.21785663]


portfolio before change:  [-6.14552443]
curr_Stock_Price:  100.37880214559134
curr_Factors:  [1.00378802e+02 4.06985264e-02]
mat_Sqrt:  [[ 2.02502948e+01  0.00000000e+00]
 [-8.06955031e-03  1.84896626e-02]]
grads:  [-2.13387649e-02 -3.27528729e+01]
Stock Position:  -0.021338764891323362
Bond Position:  [-4.00356477]


portfolio before change:  [-6.13835669]
curr_Stock_Price:  99.99598916211824
curr_Factors:  [9.99959892e+01 4.21257152e-02]
mat_Sqrt:  [[ 2.05237268e+01  0.00000000e+00]
 [-8.20981999e-03  1.88110608e-02]]
grads:  [6.58048729e-03 1.00239155e+01]
Stock Position:  0.0065804872912908945
Bond Position:  [-6.79637903]


portfolio before change:  [-6.13092886]
curr_Stock_Price:  101.38298947107609
curr_Factors:  [1.01382989e+02 4.09885103e-02]
mat_Sqrt:  [[ 2.05256141e+01  0.00000000e+00]
 [-8.09824774e-03  1.85554166e-02]]
grads:  [-0.01366238 -5.06038108]
Stock Position:  -0.01366237999884478
Bond Position:  [-4.74579593]


portfolio before change:  [-6.13966383]
curr_Stock_Price:  101.93548248912151
curr_Factors:  [1.01935482e+02 4.19224310e-02]
mat_Sqrt:  [[ 2.08712573e+01  0.00000000e+00]
 [-8.18998715e-03  1.87656180e-02]]
grads:  [ 1.02333875e-02 -3.39333267e+01]
Stock Position:  0.010233387521892307
Bond Position:  [-7.18280912]


portfolio before change:  [-6.14074022]
curr_Stock_Price:  102.0057946903276
curr_Factors:  [1.02005795e+02 4.16786174e-02]
mat_Sqrt:  [[ 2.08248315e+01  0.00000000e+00]
 [-8.16613665e-03  1.87109697e-02]]
grads:  [-0.01917917 19.1157631 ]
Stock Position:  -0.019179166214603017
Bond Position:  [-4.18435413]


portfolio before change:  [-6.14601986]
curr_Stock_Price:  102.22652505463486
curr_Factors:  [1.02226525e+02 4.33852290e-02]
mat_Sqrt:  [[ 2.12928868e+01  0.00000000e+00]
 [-8.33164848e-03  1.90902049e-02]]
grads:  [0.01797794 8.24314131]
Stock Position:  0.017977940888917614
Bond Position:  [-7.98384229]


portfolio before change:  [-6.13785679]
curr_Stock_Price:  102.79162230787998
curr_Factors:  [1.02791622e+02 4.47772059e-02]
mat_Sqrt:  [[ 2.17513499e+01  0.00000000e+00]
 [-8.46425008e-03  1.93940334e-02]]
grads:  [-0.00336157 -1.89332386]
Stock Position:  -0.003361567815924747
Bond Position:  [-5.79231578]


portfolio before change:  [-6.15200336]
curr_Stock_Price:  106.5691183783696
curr_Factors:  [1.06569118e+02 4.52598266e-02]
mat_Sqrt:  [[ 2.26718947e+01  0.00000000e+00]
 [-8.50974280e-03  1.94982703e-02]]
grads:  [-4.13275186e-04  1.29723331e+00]
Stock Position:  -0.00041327518568903316
Bond Position:  [-6.10796099]


portfolio before change:  [-6.15410224]
curr_Stock_Price:  107.95245207303009
curr_Factors:  [1.07952452e+02 4.50047324e-02]
mat_Sqrt:  [[ 2.29013774e+01  0.00000000e+00]
 [-8.48572754e-03  1.94432444e-02]]
grads:  [2.36286229e-02 2.54022096e+01]
Stock Position:  0.023628622894741467
Bond Position:  [-8.70487002]


portfolio before change:  [-6.11107138]
curr_Stock_Price:  109.86569698846101
curr_Factors:  [1.09865697e+02 4.41070750e-02]
mat_Sqrt:  [[ 2.30736470e+01  0.00000000e+00]
 [-8.40067378e-03  1.92483617e-02]]
grads:  [-0.00801345  6.02355674]
Stock Position:  -0.00801345340212322
Bond Position:  [-5.23066774]


portfolio before change:  [-6.09512695]
curr_Stock_Price:  107.71278469451931
curr_Factors:  [1.07712785e+02 4.34778437e-02]
mat_Sqrt:  [[ 2.24595604e+01  0.00000000e+00]
 [-8.34053655e-03  1.91105700e-02]]
grads:  [-2.51486418e-03  7.00421485e+00]
Stock Position:  -0.0025148641822192903
Bond Position:  [-5.82424393]


portfolio before change:  [-6.0965441]
curr_Stock_Price:  107.69723982046098
curr_Factors:  [1.07697240e+02 4.41315187e-02]
mat_Sqrt:  [[ 2.26245010e+01  0.00000000e+00]
 [-8.40300125e-03  1.92536946e-02]]
grads:  [-0.01115041 -1.65026412]
Stock Position:  -0.011150406495833919
Bond Position:  [-4.8956761]


portfolio before change:  [-6.07916065]
curr_Stock_Price:  106.02846475894425
curr_Factors:  [1.06028465e+02 4.38030707e-02]
mat_Sqrt:  [[ 2.21908916e+01  0.00000000e+00]
 [-8.37167325e-03  1.91819132e-02]]
grads:  [0.01238688 8.40543652]
Stock Position:  0.0123868799113161
Bond Position:  [-7.39252251]


portfolio before change:  [-6.07604598]
curr_Stock_Price:  106.42913314589791
curr_Factors:  [1.06429133e+02 4.44248909e-02]
mat_Sqrt:  [[ 2.24322951e+01  0.00000000e+00]
 [-8.43088521e-03  1.93175848e-02]]
grads:  [0.00427936 0.90751799]
Stock Position:  0.004279362844617331
Bond Position:  [-6.53149486]


portfolio before change:  [-6.07377476]
curr_Stock_Price:  107.34148996564652
curr_Factors:  [1.07341490e+02 4.34768132e-02]
mat_Sqrt:  [[ 2.23818753e+01  0.00000000e+00]
 [-8.34043770e-03  1.91103436e-02]]
grads:  [1.82647349e-03 1.13152218e+01]
Stock Position:  0.0018264734884244033
Bond Position:  [-6.26983114]


portfolio before change:  [-6.07607545]
curr_Stock_Price:  106.94014757710916
curr_Factors:  [1.06940148e+02 4.34237792e-02]
mat_Sqrt:  [[ 2.22845869e+01  0.00000000e+00]
 [-8.33534923e-03  1.90986844e-02]]
grads:  [0.00643669 1.29313657]
Stock Position:  0.00643668819596249
Bond Position:  [-6.76441584]


portfolio before change:  [-6.06864895]
curr_Stock_Price:  108.35668521711207
curr_Factors:  [1.08356685e+02 4.40503976e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.06864895]
Stock Price:  109.86812130743803
PL:  [-15.93677026]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-8.38825377e-02  1.04977656e-01]
 [ 1.76000414e-01 -2.10942859e-02]
 [-1.43116672e-01 -4.37074171e-01]
 [ 5.04498651e-02  1.92145141e-01]
 [-1.34569585e-01 -7.83224323e-02]
 [ 4.87093166e-01 -6.29972864e-01]
 [-5.97098842e-01  4.70880538e-01]
 [ 3.86408791e-01  1.63041218e-01]
 [ 9.47205462e-02 -1.03255821e-01]
 [ 2.02719751e-01  1.31926473e-02]
 [ 1.93503365e-01  2.83056486e-01]
 [-2.36673257e-01  7.07902684e-02]
 [-3.07838183e-02  3.73282454e-02]
 [-2.13591623e-01 -2.68429038e-01]
 [-8.08136036e-02 -1.15949415e-01]
 [ 9.24537854e-02  5.31820173e-02]
 [-3.61796222e-02 -3.74946793e-02]
 [ 4.75645768e-01 -2.58261301e-01]
 [ 2.25408836e-01  1.22059301e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.15278916]
curr_Stock_Price:  100.51380189984656
curr_Factors:  [1.00513802e+02 3.98372191e-02]
mat_Sqrt:  [[ 2.00618144e+01  0.00000000e+00]
 [-7.98370532e-03  1.82929670e-02]]
grads:  [-1.89746211e-03  5.73868941e+00]
Stock Position:  -0.0018974621056318563
Bond Position:  [6.34351029]


portfolio before change:  [6.14908833]
curr_Stock_Price:  103.30010470521988
curr_Factors:  [1.03300105e+02 4.12755293e-02]
mat_Sqrt:  [[ 2.09868417e+01  0.00000000e+00]
 [-8.12655196e-03  1.86202698e-02]]
grads:  [ 0.00794756 -1.13286683]
Stock Position:  0.00794755662829285
Bond Position:  [5.3281049]


portfolio before change:  [6.13837376]
curr_Stock_Price:  101.7843230500996
curr_Factors:  [1.01784323e+02 4.23600828e-02]
mat_Sqrt:  [[ 2.09488069e+01  0.00000000e+00]
 [-8.23262610e-03  1.88633161e-02]]
grads:  [-1.59374938e-02 -2.31705904e+01]
Stock Position:  -0.015937493777694784
Bond Position:  [7.76056078]


portfolio before change:  [6.16927098]
curr_Stock_Price:  99.96742259260316
curr_Factors:  [9.99674226e+01 4.43654351e-02]
mat_Sqrt:  [[ 2.10562422e+01  0.00000000e+00]
 [-8.42524161e-03  1.93046537e-02]]
grads:  [6.37857782e-03 9.95330677e+00]
Stock Position:  0.006378577820683809
Bond Position:  [5.531621]


portfolio before change:  [6.19077007]
curr_Stock_Price:  103.12110450422873
curr_Factors:  [1.03121105e+02 4.27747951e-02]
mat_Sqrt:  [[ 2.13275773e+01  0.00000000e+00]
 [-8.27282733e-03  1.89554287e-02]]
grads:  [-0.0079124  -4.13192618]
Stock Position:  -0.007912398791400545
Bond Position:  [7.00670537]


portfolio before change:  [6.20233854]
curr_Stock_Price:  101.88044724424464
curr_Factors:  [1.01880447e+02 4.34388620e-02]
mat_Sqrt:  [[ 2.12339144e+01  0.00000000e+00]
 [-8.33679670e-03  1.91020010e-02]]
grads:  [ 9.99111437e-03 -3.29794175e+01]
Stock Position:  0.009991114372941357
Bond Position:  [5.18443934]


portfolio before change:  [6.22214192]
curr_Stock_Price:  103.73280376052388
curr_Factors:  [1.03732804e+02 4.12239941e-02]
mat_Sqrt:  [[ 2.10615898e+01  0.00000000e+00]
 [-8.12147711e-03  1.86086418e-02]]
grads:  [-1.85926006e-02  2.53044012e+01]
Stock Position:  -0.018592600584125835
Bond Position:  [8.1508045]


portfolio before change:  [6.23878888]
curr_Stock_Price:  102.9470605325328
curr_Factors:  [1.02947061e+02 4.06950240e-02]
mat_Sqrt:  [[ 2.07675185e+01  0.00000000e+00]
 [-8.06920308e-03  1.84888670e-02]]
grads:  [0.02203276 8.81834558]
Stock Position:  0.022032762981595812
Bond Position:  [3.9705807]


portfolio before change:  [6.27213447]
curr_Stock_Price:  104.41545663998937
curr_Factors:  [1.04415457e+02 4.10449087e-02]
mat_Sqrt:  [[ 2.11540945e+01  0.00000000e+00]
 [-8.10381725e-03  1.85681780e-02]]
grads:  [ 2.34734752e-03 -5.56090218e+00]
Stock Position:  0.0023473475210904144
Bond Position:  [6.02703511]


portfolio before change:  [6.26964103]
curr_Stock_Price:  102.71123840720901
curr_Factors:  [1.02711238e+02 3.94226371e-02]
mat_Sqrt:  [[ 2.03934547e+01  0.00000000e+00]
 [-7.94205385e-03  1.81975315e-02]]
grads:  [0.01022276 0.72496906]
Stock Position:  0.010222764975051086
Bond Position:  [5.21964818]


portfolio before change:  [6.28100369]
curr_Stock_Price:  103.69508035891351
curr_Factors:  [1.0369508e+02 3.9852136e-02]
mat_Sqrt:  [[ 2.07006487e+01  0.00000000e+00]
 [-7.98519991e-03  1.82963915e-02]]
grads:  [1.53154304e-02 1.54706181e+01]
Stock Position:  0.015315430388071599
Bond Position:  [4.6928689]


portfolio before change:  [6.22544774]
curr_Stock_Price:  99.99101754633061
curr_Factors:  [9.99910175e+01 4.07121312e-02]
mat_Sqrt:  [[ 2.01754350e+01  0.00000000e+00]
 [-8.07089895e-03  1.84927527e-02]]
grads:  [-0.01019943  3.8280006 ]
Stock Position:  -0.010199425740570532
Bond Position:  [7.2452987]


portfolio before change:  [6.22827977]
curr_Stock_Price:  99.89096482422032
curr_Factors:  [9.98909648e+01 3.85194340e-02]
mat_Sqrt:  [[ 1.96049688e+01  0.00000000e+00]
 [-7.85054739e-03  1.79878638e-02]]
grads:  [-7.39222617e-04  2.07519057e+00]
Stock Position:  -0.0007392226167077135
Bond Position:  [6.30212143]


portfolio before change:  [6.22983737]
curr_Stock_Price:  99.91549031784997
curr_Factors:  [9.99154903e+01 3.74877808e-02]
mat_Sqrt:  [[ 1.93453989e+01  0.00000000e+00]
 [-7.74470460e-03  1.77453475e-02]]
grads:  [ -0.01709676 -15.12672758]
Stock Position:  -0.01709676090040495
Bond Position:  [7.93806861]


portfolio before change:  [6.23470973]
curr_Stock_Price:  99.74659271932751
curr_Factors:  [9.97465927e+01 3.85606948e-02]
mat_Sqrt:  [[ 1.95871160e+01  0.00000000e+00]
 [-7.85475090e-03  1.79974953e-02]]
grads:  [-0.00670941 -6.44253063]
Stock Position:  -0.006709414344702618
Bond Position:  [6.90395095]


portfolio before change:  [6.23931906]
curr_Stock_Price:  99.31687993394672
curr_Factors:  [9.93168799e+01 3.92721821e-02]
mat_Sqrt:  [[ 1.96818349e+01  0.00000000e+00]
 [-7.92688409e-03  1.81627732e-02]]
grads:  [0.0058767  2.92807804]
Stock Position:  0.005876704144519668
Bond Position:  [5.65566314]


portfolio before change:  [6.24806946]
curr_Stock_Price:  100.56525216647296
curr_Factors:  [1.00565252e+02 3.63438683e-02]
mat_Sqrt:  [[ 1.91718279e+01  0.00000000e+00]
 [-7.62562714e-03  1.74725068e-02]]
grads:  [-0.00274067 -2.14592444]
Stock Position:  -0.002740669388446722
Bond Position:  [6.52368557]


portfolio before change:  [6.24980791]
curr_Stock_Price:  100.52609380909466
curr_Factors:  [1.00526094e+02 3.64006754e-02]
mat_Sqrt:  [[ 1.91793343e+01  0.00000000e+00]
 [-7.63158442e-03  1.74861566e-02]]
grads:  [  0.01892304 -14.76947202]
Stock Position:  0.018923039282559978
Bond Position:  [4.34754869]


portfolio before change:  [6.25258837]
curr_Stock_Price:  100.6155846479379
curr_Factors:  [1.00615585e+02 3.81047640e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.25258837]
Stock Price:  101.65884715198624
PL:  [4.59374122]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.51857455e-02  1.93184687e-01]
 [-1.22932802e-01 -5.58902870e-02]
 [-1.59967029e-01 -5.52041758e-01]
 [-3.66216569e-02  2.75793110e-01]
 [-4.45138516e-01 -1.06148768e-01]
 [ 7.24528766e-02 -4.37674669e-02]
 [-3.95723998e-01  1.53883792e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 3.14961242e-01  4.77941538e-03]
 [ 1.72090744e-01  2.48871615e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-8.35702905e-02  1.10708312e-01]
 [-2.56737897e-01 -9.45658816e-02]
 [ 2.35795328e-01  2.57686813e-01]
 [ 6.59773453e-02  3.88270904e-02]
 [-5.35102150e-02  3.21892483e-01]
 [ 1.43754922e-01  1.73967763e-01]
 [-3.04117419e-02 -2.56975588e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.3516028]
curr_Stock_Price:  101.12327351441841
curr_Factors:  [1.01123274e+02 3.90648690e-02]
mat_Sqrt:  [[ 1.99868478e+01  0.00000000e+00]
 [-7.90593387e-03  1.81147702e-02]]
grads:  [2.95829360e-03 1.06644845e+01]
Stock Position:  0.0029582936007202317
Bond Position:  [10.05245047]


portfolio before change:  [10.3548005]
curr_Stock_Price:  101.35458120356098
curr_Factors:  [1.01354581e+02 3.63892464e-02]
mat_Sqrt:  [[ 1.93343651e+01  0.00000000e+00]
 [-7.63038625e-03  1.74834113e-02]]
grads:  [-0.00761987 -3.19676098]
Stock Position:  -0.007619868670785076
Bond Position:  [11.1271091]


portfolio before change:  [10.36175328]
curr_Stock_Price:  100.80724180769029
curr_Factors:  [1.00807242e+02 3.80058952e-02]
mat_Sqrt:  [[ 1.96524733e+01  0.00000000e+00]
 [-7.79804028e-03  1.78675549e-02]]
grads:  [-2.03993563e-02 -3.08963235e+01]
Stock Position:  -0.02039935625369925
Bond Position:  [12.41815612]


portfolio before change:  [10.40855012]
curr_Stock_Price:  98.66541375679617
curr_Factors:  [9.86654138e+01 3.82161883e-02]
mat_Sqrt:  [[ 1.92880634e+01  0.00000000e+00]
 [-7.81958447e-03  1.79169189e-02]]
grads:  [4.34176944e-03 1.53928872e+01]
Stock Position:  0.004341769443203437
Bond Position:  [9.98016764]


portfolio before change:  [10.41093678]
curr_Stock_Price:  98.64037789025289
curr_Factors:  [9.86403779e+01 3.74316710e-02]
mat_Sqrt:  [[ 1.90842165e+01  0.00000000e+00]
 [-7.73890649e-03  1.77320624e-02]]
grads:  [-0.02575247 -5.98626183]
Stock Position:  -0.025752465981105505
Bond Position:  [12.95116975]


portfolio before change:  [10.42520759]
curr_Stock_Price:  98.2119679867943
curr_Factors:  [9.82119680e+01 3.60132496e-02]
mat_Sqrt:  [[ 1.86378396e+01  0.00000000e+00]
 [-7.59086289e-03  1.73928519e-02]]
grads:  [ 0.00286252 -2.51640543]
Stock Position:  0.0028625199719726937
Bond Position:  [10.14407387]


portfolio before change:  [10.4283248]
curr_Stock_Price:  98.41489423903036
curr_Factors:  [9.84148942e+01 3.55596515e-02]
mat_Sqrt:  [[ 1.85583593e+01  0.00000000e+00]
 [-7.54290676e-03  1.72829706e-02]]
grads:  [-0.01770435  8.90378141]
Stock Position:  -0.017704345533976554
Bond Position:  [12.17069609]


portfolio before change:  [10.41915035]
curr_Stock_Price:  99.10497913546007
curr_Factors:  [9.91049791e+01 3.51001227e-02]
mat_Sqrt:  [[ 1.85673443e+01  0.00000000e+00]
 [-7.49401070e-03  1.71709356e-02]]
grads:  [5.26758962e-03 7.90399472e+00]
Stock Position:  0.005267589618123273
Bond Position:  [9.897106]


portfolio before change:  [10.43013716]
curr_Stock_Price:  100.72094033344816
curr_Factors:  [1.00720940e+02 3.45905169e-02]
mat_Sqrt:  [[ 1.87326103e+01  0.00000000e+00]
 [-7.43941040e-03  1.70458306e-02]]
grads:  [-0.01161509 -3.11800066]
Stock Position:  -0.011615085537240121
Bond Position:  [11.6000195]


portfolio before change:  [10.43479634]
curr_Stock_Price:  100.56951588856488
curr_Factors:  [1.00569516e+02 3.59950543e-02]
mat_Sqrt:  [[ 1.90804132e+01  0.00000000e+00]
 [-7.58894505e-03  1.73884576e-02]]
grads:  [0.01661637 0.27486138]
Stock Position:  0.016616367038195114
Bond Position:  [8.76369635]


portfolio before change:  [10.47700487]
curr_Stock_Price:  102.97782396206215
curr_Factors:  [1.02977824e+02 3.44474566e-02]
mat_Sqrt:  [[ 1.91127109e+01  0.00000000e+00]
 [-7.42401041e-03  1.70105448e-02]]
grads:  [ 0.01468694 14.63043176]
Stock Position:  0.014686939130604692
Bond Position:  [8.96457583]


portfolio before change:  [10.48777278]
curr_Stock_Price:  103.55837319490935
curr_Factors:  [1.03558373e+02 3.49401524e-02]
mat_Sqrt:  [[ 1.93574264e+01  0.00000000e+00]
 [-7.47691406e-03  1.71317623e-02]]
grads:  [-0.00976411  6.67375147]
Stock Position:  -0.009764106029572861
Bond Position:  [11.49892772]


portfolio before change:  [10.46472764]
curr_Stock_Price:  106.21301803155244
curr_Factors:  [1.06213018e+02 3.57353279e-02]
mat_Sqrt:  [[ 2.00782860e+01  0.00000000e+00]
 [-7.56151603e-03  1.73256098e-02]]
grads:  [-1.75578843e-03  6.38986522e+00]
Stock Position:  -0.0017557884274086804
Bond Position:  [10.65121523]


portfolio before change:  [10.46639752]
curr_Stock_Price:  106.7787209028896
curr_Factors:  [1.06778721e+02 3.54731689e-02]
mat_Sqrt:  [[ 2.01110482e+01  0.00000000e+00]
 [-7.53372884e-03  1.72619413e-02]]
grads:  [-0.01481821 -5.47828774]
Stock Position:  -0.014818214742345768
Bond Position:  [12.04866754]


portfolio before change:  [10.45170587]
curr_Stock_Price:  107.97347966182534
curr_Factors:  [1.07973480e+02 3.45242045e-02]
mat_Sqrt:  [[ 2.00622177e+01  0.00000000e+00]
 [-7.43227605e-03  1.70294838e-02]]
grads:  [ 0.01735895 15.13180414]
Stock Position:  0.01735895197892929
Bond Position:  [8.57739942]


portfolio before change:  [10.47542334]
curr_Stock_Price:  109.21623055608828
curr_Factors:  [1.09216231e+02 3.32139957e-02]
mat_Sqrt:  [[ 1.99043384e+01  0.00000000e+00]
 [-7.28988293e-03  1.67032202e-02]]
grads:  [0.00416607 2.32452725]
Stock Position:  0.004166070494381512
Bond Position:  [10.02042083]


portfolio before change:  [10.48100105]
curr_Stock_Price:  109.95368615400966
curr_Factors:  [1.09953686e+02 3.39826322e-02]
mat_Sqrt:  [[ 2.02692790e+01  0.00000000e+00]
 [-7.37375152e-03  1.68953873e-02]]
grads:  [4.29098548e-03 1.90520926e+01]
Stock Position:  0.004290985480160793
Bond Position:  [10.00919138]


portfolio before change:  [10.48442292]
curr_Stock_Price:  110.16791501641258
curr_Factors:  [1.10167915e+02 3.38668642e-02]
mat_Sqrt:  [[ 2.02741485e+01  0.00000000e+00]
 [-7.36118079e-03  1.68665841e-02]]
grads:  [ 0.01083551 10.31434477]
Stock Position:  0.010835507008334506
Bond Position:  [9.2906977]


portfolio before change:  [10.49747553]
curr_Stock_Price:  111.15814497099629
curr_Factors:  [1.11158145e+02 3.21923954e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.49747553]
Stock Price:  111.40044149045825
PL:  [-0.90296597]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.09282209e-01 -1.05407000e+00]
 [-2.61206840e-02  2.76893536e-01]
 [-4.43216011e-01 -2.74884629e-02]
 [ 2.43866296e-01 -5.68456189e-02]
 [-2.46265466e-01  7.79273178e-02]
 [-6.95003228e-02  1.51857996e-01]
 [-2.16043344e-01  3.12376700e-02]
 [ 1.89975123e-01  8.86369799e-03]
 [-1.06004474e-01 -5.09235030e-02]
 [-1.32953936e-01  1.93237586e-02]
 [ 5.37906637e-02 -2.52743410e-03]
 [-5.78087590e-02 -2.00971963e-01]
 [-2.30533092e-01 -1.29642236e-01]
 [ 8.80507569e-02  4.52181492e-02]
 [ 3.78825738e-02 -7.41426478e-02]
 [ 7.57931967e-01 -3.61387099e-01]
 [ 1.54494111e-01  1.51310376e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.620691]
curr_Stock_Price:  98.0790760694822
curr_Factors:  [9.80790761e+01 4.09122015e-02]
mat_Sqrt:  [[ 1.98382241e+01  0.00000000e+00]
 [-8.09070593e-03  1.85381362e-02]]
grads:  [ 0.00140494 -0.07286786]
Stock Position:  0.0014049431808446386
Bond Position:  [-10.75848653]


portfolio before change:  [-10.6231213]
curr_Stock_Price:  98.26389108811772
curr_Factors:  [9.82638911e+01 4.11069684e-02]
mat_Sqrt:  [[ 1.99228600e+01  0.00000000e+00]
 [-8.10994140e-03  1.85822102e-02]]
grads:  [-0.00935232 -3.58686989]
Stock Position:  -0.009352315413764295
Bond Position:  [-9.7041264]


portfolio before change:  [-10.61534102]
curr_Stock_Price:  97.172544579591
curr_Factors:  [9.71725446e+01 4.07534171e-02]
mat_Sqrt:  [[ 1.96166837e+01  0.00000000e+00]
 [-8.07499024e-03  1.85021270e-02]]
grads:  [-3.41197361e-02 -5.69702066e+01]
Stock Position:  -0.03411973605782098
Bond Position:  [-7.29983945]


portfolio before change:  [-10.61606003]
curr_Stock_Price:  97.14012420109235
curr_Factors:  [9.71401242e+01 4.12983935e-02]
mat_Sqrt:  [[ 1.97408220e+01  0.00000000e+00]
 [-8.12880247e-03  1.86254263e-02]]
grads:  [4.79846090e-03 1.48664268e+01]
Stock Position:  0.004798460898610925
Bond Position:  [-11.08218312]


portfolio before change:  [-10.63080264]
curr_Stock_Price:  94.64521726328509
curr_Factors:  [9.46452173e+01 4.29580906e-02]
mat_Sqrt:  [[ 1.96164835e+01  0.00000000e+00]
 [-8.29053346e-03  1.89959986e-02]]
grads:  [-0.02320564 -1.44706596]
Stock Position:  -0.023205635181334467
Bond Position:  [-8.43450025]


portfolio before change:  [-10.6357559]
curr_Stock_Price:  94.76779000695231
curr_Factors:  [9.47677900e+01 4.17612922e-02]
mat_Sqrt:  [[ 1.93663474e+01  0.00000000e+00]
 [-8.17423192e-03  1.87295183e-02]]
grads:  [ 0.01131121 -3.03508174]
Stock Position:  0.01131121062018097
Bond Position:  [-11.70769434]


portfolio before change:  [-10.63666715]
curr_Stock_Price:  94.94602442770535
curr_Factors:  [9.49460244e+01 4.18408839e-02]
mat_Sqrt:  [[ 1.94212514e+01  0.00000000e+00]
 [-8.18201774e-03  1.87473578e-02]]
grads:  [-0.01092902  4.15670937]
Stock Position:  -0.010929017500445613
Bond Position:  [-9.59900038]


portfolio before change:  [-10.64023139]
curr_Stock_Price:  95.05254717552002
curr_Factors:  [9.50525472e+01 4.21605731e-02]
mat_Sqrt:  [[ 1.95171775e+01  0.00000000e+00]
 [-8.21321600e-03  1.88188420e-02]]
grads:  [-1.65190880e-04  8.06946549e+00]
Stock Position:  -0.00016519087963767133
Bond Position:  [-10.62452957]


portfolio before change:  [-10.64315615]
curr_Stock_Price:  96.67673984879197
curr_Factors:  [9.66767398e+01 4.22059027e-02]
mat_Sqrt:  [[ 1.98613422e+01  0.00000000e+00]
 [-8.21763009e-03  1.88289560e-02]]
grads:  [-0.01019116  1.65902294]
Stock Position:  -0.010191159580304088
Bond Position:  [-9.65790807]


portfolio before change:  [-10.64263549]
curr_Stock_Price:  96.38870229258893
curr_Factors:  [9.63887023e+01 4.20422676e-02]
mat_Sqrt:  [[ 1.97637431e+01  0.00000000e+00]
 [-8.20168447e-03  1.87924200e-02]]
grads:  [0.00980804 0.47166347]
Stock Position:  0.009808038765996145
Bond Position:  [-11.58801962]


portfolio before change:  [-10.65972946]
curr_Stock_Price:  94.94125710078154
curr_Factors:  [9.49412571e+01 4.40501605e-02]
mat_Sqrt:  [[ 1.99263946e+01  0.00000000e+00]
 [-8.39525204e-03  1.92359390e-02]]
grads:  [-0.00643515 -2.64731049]
Stock Position:  -0.00643514872571148
Bond Position:  [-10.04876835]


portfolio before change:  [-10.65859275]
curr_Stock_Price:  94.3741811216768
curr_Factors:  [9.43741811e+01 4.35052191e-02]
mat_Sqrt:  [[ 1.96844768e+01  0.00000000e+00]
 [-8.34316190e-03  1.91165855e-02]]
grads:  [-0.00632581  1.01083735]
Stock Position:  -0.006325814903258747
Bond Position:  [-10.06159915]


portfolio before change:  [-10.66220584]
curr_Stock_Price:  94.54765738749043
curr_Factors:  [9.45476574e+01 4.27683595e-02]
mat_Sqrt:  [[ 1.95529401e+01  0.00000000e+00]
 [-8.27220498e-03  1.89540027e-02]]
grads:  [ 0.00269461 -0.13334566]
Stock Position:  0.002694612722456141
Bond Position:  [-10.91697516]


portfolio before change:  [-10.66128446]
curr_Stock_Price:  95.90257218021355
curr_Factors:  [9.59025722e+01 4.28131790e-02]
mat_Sqrt:  [[ 1.98435328e+01  0.00000000e+00]
 [-8.27653831e-03  1.89639316e-02]]
grads:  [-7.33337738e-03 -1.05975895e+01]
Stock Position:  -0.0073333773777977404
Bond Position:  [-9.9579947]


portfolio before change:  [-10.65691382]
curr_Stock_Price:  94.96706273629279
curr_Factors:  [9.49670627e+01 4.52003585e-02]
mat_Sqrt:  [[ 2.01903546e+01  0.00000000e+00]
 [-8.50415037e-03  1.94854564e-02]]
grads:  [-0.01422033 -6.65328197]
Stock Position:  -0.01422033486521277
Bond Position:  [-9.30645039]


portfolio before change:  [-10.6671587]
curr_Stock_Price:  95.52386911008622
curr_Factors:  [9.55238691e+01 4.41617829e-02]
mat_Sqrt:  [[ 2.00740594e+01  0.00000000e+00]
 [-8.40588203e-03  1.92602953e-02]]
grads:  [0.0053694  2.34773914]
Stock Position:  0.005369396054994804
Bond Position:  [-11.18006418]


portfolio before change:  [-10.66031321]
curr_Stock_Price:  97.31938901966443
curr_Factors:  [9.73193890e+01 4.36146518e-02]
mat_Sqrt:  [[ 2.03242991e+01  0.00000000e+00]
 [-8.35364848e-03  1.91406132e-02]]
grads:  [ 2.71796307e-04 -3.87357745e+00]
Stock Position:  0.00027179630720479544
Bond Position:  [-10.68676426]


portfolio before change:  [-10.66310256]
curr_Stock_Price:  96.88769849952044
curr_Factors:  [9.68876985e+01 4.34493102e-02]
mat_Sqrt:  [[ 2.01957545e+01  0.00000000e+00]
 [-8.33779925e-03  1.91042981e-02]]
grads:  [  0.0297196  -18.91653371]
Stock Position:  0.02971959810344675
Bond Position:  [-13.54256602]


portfolio before change:  [-10.69340966]
curr_Stock_Price:  95.9818642430987
curr_Factors:  [9.59818642e+01 4.23581828e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.69340966]
Stock Price:  93.58843241160343
PL:  [-10.69340966]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-6.09022490e-02  1.39511452e-01]
 [ 1.85532813e-01 -2.00044377e-02]
 [-1.20587480e-01 -2.83360702e-01]
 [ 2.22401490e-01 -7.79473324e-02]
 [-1.44541834e-01 -8.00142721e-02]
 [ 6.06773015e-01 -8.15132531e-01]
 [-5.70517340e-01  3.94720032e-01]
 [ 6.25770904e-01  1.81842903e-01]
 [ 2.33160063e-01 -1.79181655e-01]
 [-3.43794998e-03  2.43734056e-02]
 [ 3.45898555e-01  5.26352705e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.15077429e-01  1.33984394e-01]
 [-2.22621400e-01  2.22882457e-02]
 [ 2.22033006e-01  2.15253842e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.32731936e-02  2.36050195e-01]
 [ 1.76477255e-01 -4.75242603e-02]
 [ 7.54371863e-02 -1.68527338e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.79620724]
curr_Stock_Price:  100.75234944133817
curr_Factors:  [1.00752349e+02 3.93998947e-02]
mat_Sqrt:  [[ 1.99987436e+01  0.00000000e+00]
 [-7.93976269e-03  1.81922818e-02]]
grads:  [-7.23029768e-07  7.66871652e+00]
Stock Position:  -7.230297681698632e-07
Bond Position:  [7.79628009]


portfolio before change:  [7.79815456]
curr_Stock_Price:  103.51002008467026
curr_Factors:  [1.03510020e+02 3.71316263e-02]
mat_Sqrt:  [[ 1.99459340e+01  0.00000000e+00]
 [-7.70782733e-03  1.76608511e-02]]
grads:  [ 0.00886407 -1.13269953]
Stock Position:  0.008864070265013872
Bond Position:  [6.88063447]


portfolio before change:  [7.79563499]
curr_Stock_Price:  103.03169107499983
curr_Factors:  [1.03031691e+02 3.77298386e-02]
mat_Sqrt:  [[ 2.00130510e+01  0.00000000e+00]
 [-7.76966806e-03  1.78025460e-02]]
grads:  [-1.22048472e-02 -1.59168639e+01]
Stock Position:  -0.012204847196065344
Bond Position:  [9.05312104]


portfolio before change:  [7.80676341]
curr_Stock_Price:  102.30535189301929
curr_Factors:  [1.02305352e+02 3.89206830e-02]
mat_Sqrt:  [[ 2.01831329e+01  0.00000000e+00]
 [-7.89133023e-03  1.80813090e-02]]
grads:  [ 0.00933366 -4.31093414]
Stock Position:  0.009333659250352584
Bond Position:  [6.85188012]


portfolio before change:  [7.81413578]
curr_Stock_Price:  102.91167141307291
curr_Factors:  [1.02911671e+02 4.02245813e-02]
mat_Sqrt:  [[ 2.06400335e+01  0.00000000e+00]
 [-8.02242669e-03  1.83816888e-02]]
grads:  [-0.0086949  -4.35293367]
Stock Position:  -0.008694895075735145
Bond Position:  [8.70894196]


portfolio before change:  [7.81337161]
curr_Stock_Price:  103.24999321388323
curr_Factors:  [1.03249993e+02 3.98916373e-02]
mat_Sqrt:  [[ 2.06220086e+01  0.00000000e+00]
 [-7.98915638e-03  1.83054569e-02]]
grads:  [ 1.21724328e-02 -4.45294829e+01]
Stock Position:  0.012172432752878957
Bond Position:  [6.55656801]


portfolio before change:  [7.8067022]
curr_Stock_Price:  102.56740491059334
curr_Factors:  [1.02567405e+02 4.20832407e-02]
mat_Sqrt:  [[ 2.10408827e+01  0.00000000e+00]
 [-8.20568005e-03  1.88015750e-02]]
grads:  [-1.89273140e-02  2.09939876e+01]
Stock Position:  -0.018927314034762263
Bond Position:  [9.74802768]


portfolio before change:  [7.75662746]
curr_Stock_Price:  105.34181056183513
curr_Factors:  [1.05341811e+02 3.84224073e-02]
mat_Sqrt:  [[ 2.06487166e+01  0.00000000e+00]
 [-7.84065378e-03  1.79651947e-02]]
grads:  [ 0.03414903 10.12195556]
Stock Position:  0.03414903042429968
Bond Position:  [4.15930677]


portfolio before change:  [7.8049365]
curr_Stock_Price:  106.72601032286134
curr_Factors:  [1.06726010e+02 4.06242792e-02]
mat_Sqrt:  [[ 2.15111243e+01  0.00000000e+00]
 [-8.06218623e-03  1.84727893e-02]]
grads:  [ 7.20365776e-03 -9.69976173e+00]
Stock Position:  0.007203657764552098
Bond Position:  [7.03611885]


portfolio before change:  [7.80342814]
curr_Stock_Price:  106.27240657570948
curr_Factors:  [1.06272407e+02 4.27851497e-02]
mat_Sqrt:  [[ 2.19819919e+01  0.00000000e+00]
 [-8.27382859e-03  1.89577229e-02]]
grads:  [3.27517013e-04 1.28567158e+00]
Stock Position:  0.00032751701314126974
Bond Position:  [7.76862212]


portfolio before change:  [7.80612776]
curr_Stock_Price:  108.58439534844646
curr_Factors:  [1.08584395e+02 4.18520233e-02]
mat_Sqrt:  [[ 2.22139427e+01  0.00000000e+00]
 [-8.18310682e-03  1.87498532e-02]]
grads:  [2.59124514e-02 2.80723641e+01]
Stock Position:  0.02591245136301191
Bond Position:  [4.99243989]


portfolio before change:  [7.79286525]
curr_Stock_Price:  108.02440323911493
curr_Factors:  [1.08024403e+02 3.96482460e-02]
mat_Sqrt:  [[ 2.15096758e+01  0.00000000e+00]
 [-7.96474693e-03  1.82495278e-02]]
grads:  [-0.00878711  6.2649908 ]
Stock Position:  -0.008787113543580253
Bond Position:  [8.74208795]


portfolio before change:  [7.79776636]
curr_Stock_Price:  107.71539331377024
curr_Factors:  [1.07715393e+02 3.88182898e-02]
mat_Sqrt:  [[ 2.12224721e+01  0.00000000e+00]
 [-7.88094307e-03  1.80575091e-02]]
grads:  [-2.66707130e-03  7.41987131e+00]
Stock Position:  -0.0026670712955532204
Bond Position:  [8.08505099]


portfolio before change:  [7.79772049]
curr_Stock_Price:  108.49054381909536
curr_Factors:  [1.08490544e+02 3.70338101e-02]
mat_Sqrt:  [[ 2.08781053e+01  0.00000000e+00]
 [-7.69766823e-03  1.76375737e-02]]
grads:  [-0.010197    1.26367981]
Stock Position:  -0.010196998650893673
Bond Position:  [8.90399842]


portfolio before change:  [7.81393879]
curr_Stock_Price:  107.11837342881925
curr_Factors:  [1.07118373e+02 3.71148700e-02]
mat_Sqrt:  [[ 2.06365903e+01  0.00000000e+00]
 [-7.70608798e-03  1.76568657e-02]]
grads:  [ 0.01531152 12.19094292]
Stock Position:  0.015311516123437547
Bond Position:  [6.17379408]


portfolio before change:  [7.8220682]
curr_Stock_Price:  107.54849247479761
curr_Factors:  [1.07548492e+02 3.73621134e-02]
mat_Sqrt:  [[ 2.07883511e+01  0.00000000e+00]
 [-7.73171271e-03  1.77155794e-02]]
grads:  [0.00461778 0.9895841 ]
Stock Position:  0.004617775097016248
Bond Position:  [7.32543345]


portfolio before change:  [7.82519814]
curr_Stock_Price:  107.82965634583562
curr_Factors:  [1.07829656e+02 3.78182773e-02]
mat_Sqrt:  [[ 2.09695491e+01  0.00000000e+00]
 [-7.77876878e-03  1.78233984e-02]]
grads:  [2.37237135e-03 1.32438377e+01]
Stock Position:  0.00237237134981901
Bond Position:  [7.56938615]


portfolio before change:  [7.82270261]
curr_Stock_Price:  105.97998124714054
curr_Factors:  [1.05979981e+02 4.03972511e-02]
mat_Sqrt:  [[ 2.13009879e+01  0.00000000e+00]
 [-8.03962696e-03  1.84210996e-02]]
grads:  [ 0.00731121 -2.57988184]
Stock Position:  0.00731120866895468
Bond Position:  [7.04786085]


portfolio before change:  [7.82294622]
curr_Stock_Price:  105.77227595348629
curr_Factors:  [1.05772276e+02 4.04026447e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.82294622]
Stock Price:  108.12278623206728
PL:  [-0.29984001]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.82916099e-01 -7.08619997e-01]
 [ 1.25758952e-01  7.57600094e-02]
 [-1.48449738e-01 -8.07304547e-02]
 [ 5.28442090e-01 -6.93917960e-01]
 [-6.10843909e-01  5.49468145e-01]
 [ 5.70093337e-01  1.77469479e-01]
 [ 2.33521585e-01 -1.81262976e-01]
 [-6.82297936e-02  2.78873270e-02]
 [ 3.19551222e-01  4.84289654e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-4.88989346e-02  8.50946458e-02]
 [-2.99949084e-01 -2.42570688e-01]
 [ 1.77094711e-01  7.66793049e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.24524091e-02  3.58621937e-02]
 [ 3.50629797e-01 -2.21902544e-01]
 [ 1.86973295e-01  7.58961834e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.1693842]
curr_Stock_Price:  98.8703511865813
curr_Factors:  [9.88703512e+01 4.10278402e-02]
mat_Sqrt:  [[ 2.00265161e+01  0.00000000e+00]
 [-8.10213209e-03  1.85643168e-02]]
grads:  [ 0.00139173 -0.07276509]
Stock Position:  0.0013917337116768989
Bond Position:  [-5.3069854]


portfolio before change:  [-5.17023719]
curr_Stock_Price:  99.210878363634
curr_Factors:  [9.92108784e+01 3.97315924e-02]
mat_Sqrt:  [[ 1.97754912e+01  0.00000000e+00]
 [-7.97311406e-03  1.82686994e-02]]
grads:  [-0.00942201 -3.64842449]
Stock Position:  -0.009422009700328995
Bond Position:  [-4.23547133]


portfolio before change:  [-5.17441647]
curr_Stock_Price:  99.54204820859296
curr_Factors:  [9.95420482e+01 3.84453260e-02]
mat_Sqrt:  [[ 1.95176869e+01  0.00000000e+00]
 [-7.84299188e-03  1.79705520e-02]]
grads:  [-2.52172926e-02 -3.94322889e+01]
Stock Position:  -0.025217292587522658
Bond Position:  [-2.66423552]


portfolio before change:  [-5.20815426]
curr_Stock_Price:  100.85351528203081
curr_Factors:  [1.00853515e+02 3.64410423e-02]
mat_Sqrt:  [[ 1.92524691e+01  0.00000000e+00]
 [-7.63581480e-03  1.74958497e-02]]
grads:  [0.0082495  4.33017034]
Stock Position:  0.008249504518387431
Bond Position:  [-6.04014579]


portfolio before change:  [-5.19336345]
curr_Stock_Price:  102.8295179783289
curr_Factors:  [1.02829518e+02 3.59691831e-02]
mat_Sqrt:  [[ 1.95021767e+01  0.00000000e+00]
 [-7.58621730e-03  1.73822075e-02]]
grads:  [-0.00941861 -4.6444305 ]
Stock Position:  -0.00941861002270626
Bond Position:  [-4.22485232]


portfolio before change:  [-5.19011615]
curr_Stock_Price:  102.37258823897247
curr_Factors:  [1.02372588e+02 3.65458007e-02]
mat_Sqrt:  [[ 1.95705227e+01  0.00000000e+00]
 [-7.64678241e-03  1.75209796e-02]]
grads:  [ 1.15271047e-02 -3.96049751e+01]
Stock Position:  0.011527104693398349
Bond Position:  [-6.37017569]


portfolio before change:  [-5.16188418]
curr_Stock_Price:  104.95994319688106
curr_Factors:  [1.04959943e+02 3.56343380e-02]
mat_Sqrt:  [[ 1.98133511e+01  0.00000000e+00]
 [-7.55082385e-03  1.73011109e-02]]
grads:  [-1.87265823e-02  3.17591250e+01]
Stock Position:  -0.018726582342890947
Bond Position:  [-3.19634316]


portfolio before change:  [-5.15934063]
curr_Stock_Price:  104.78144124007952
curr_Factors:  [1.04781441e+02 3.64418842e-02]
mat_Sqrt:  [[ 2.00025231e+01  0.00000000e+00]
 [-7.63590301e-03  1.74960518e-02]]
grads:  [ 0.03237328 10.14340154]
Stock Position:  0.032373284379894035
Bond Position:  [-8.55146003]


portfolio before change:  [-5.09821425]
curr_Stock_Price:  106.73566111972984
curr_Factors:  [1.06735661e+02 3.48493737e-02]
mat_Sqrt:  [[ 1.99253993e+01  0.00000000e+00]
 [-7.46719479e-03  1.71094927e-02]]
grads:  [ 7.74950275e-03 -1.05942929e+01]
Stock Position:  0.007749502748990945
Bond Position:  [-5.92536255]


portfolio before change:  [-5.09473663]
curr_Stock_Price:  107.3755922736921
curr_Factors:  [1.07375592e+02 3.39361913e-02]
mat_Sqrt:  [[ 1.97804935e+01  0.00000000e+00]
 [-7.36871129e-03  1.68838386e-02]]
grads:  [-0.00283404  1.65171722]
Stock Position:  -0.0028340428589773915
Bond Position:  [-4.7904296]


portfolio before change:  [-5.09684432]
curr_Stock_Price:  107.69666537903349
curr_Factors:  [1.07696665e+02 3.43257394e-02]
mat_Sqrt:  [[ 1.99531840e+01  0.00000000e+00]
 [-7.41088274e-03  1.69804656e-02]]
grads:  [2.66079116e-02 2.85203991e+01]
Stock Position:  0.02660791157704766
Bond Position:  [-7.96242767]


portfolio before change:  [-5.14095335]
curr_Stock_Price:  106.11374603264753
curr_Factors:  [1.06113746e+02 3.45120484e-02]
mat_Sqrt:  [[ 1.97131949e+01  0.00000000e+00]
 [-7.43096747e-03  1.70264855e-02]]
grads:  [-0.00958789  6.7150161 ]
Stock Position:  -0.009587891013577526
Bond Position:  [-4.12354632]


portfolio before change:  [-5.12714785]
curr_Stock_Price:  104.56632362818596
curr_Factors:  [1.04566324e+02 3.76589114e-02]
mat_Sqrt:  [[ 2.02920405e+01  0.00000000e+00]
 [-7.76236164e-03  1.77858049e-02]]
grads:  [-5.79566480e-04  4.78441355e+00]
Stock Position:  -0.0005795664796531427
Bond Position:  [-5.06654472]


portfolio before change:  [-5.12843975]
curr_Stock_Price:  104.60964162554947
curr_Factors:  [1.04609642e+02 3.88886296e-02]
mat_Sqrt:  [[ 2.06292308e+01  0.00000000e+00]
 [-7.88808008e-03  1.80738620e-02]]
grads:  [ -0.01967187 -13.42107666]
Stock Position:  -0.01967187319347073
Bond Position:  [-3.07057215]


portfolio before change:  [-5.12366162]
curr_Stock_Price:  104.32772294995586
curr_Factors:  [1.04327723e+02 4.05258442e-02]
mat_Sqrt:  [[ 2.10022471e+01  0.00000000e+00]
 [-8.05241273e-03  1.84503954e-02]]
grads:  [0.01002561 4.15597081]
Stock Position:  0.01002560830384042
Bond Position:  [-6.16961051]


portfolio before change:  [-5.13903664]
curr_Stock_Price:  102.94801391730351
curr_Factors:  [1.02948014e+02 4.34407145e-02]
mat_Sqrt:  [[ 2.14568741e+01  0.00000000e+00]
 [-8.33697446e-03  1.91024083e-02]]
grads:  [0.0044739  0.91774061]
Stock Position:  0.004473900993381559
Bond Position:  [-5.59961586]


portfolio before change:  [-5.14076641]
curr_Stock_Price:  102.87432085447718
curr_Factors:  [1.02874321e+02 4.21193518e-02]
mat_Sqrt:  [[ 2.11128966e+01  0.00000000e+00]
 [-8.20919989e-03  1.88096400e-02]]
grads:  [-1.74305143e-03  1.90658586e+00]
Stock Position:  -0.001743051429805595
Bond Position:  [-4.96145118]


portfolio before change:  [-5.14137964]
curr_Stock_Price:  102.51444044399365
curr_Factors:  [1.02514440e+02 4.38091767e-02]
mat_Sqrt:  [[ 2.14569303e+01  0.00000000e+00]
 [-8.37225672e-03  1.91832501e-02]]
grads:  [  0.01182758 -11.56751554]
Stock Position:  0.011827581275092983
Bond Position:  [-6.35387752]


portfolio before change:  [-5.145915]
curr_Stock_Price:  102.26530329024837
curr_Factors:  [1.02265303e+02 4.54887161e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.145915]
Stock Price:  102.07369537200866
PL:  [-7.21961037]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.92284388e-02 -1.58595274e-03]
 [-1.55405290e-01 -6.60777645e-02]
 [-2.06402958e-01 -1.07276847e+00]
 [-3.92850907e-02  2.75514002e-01]
 [-4.35465324e-01 -1.20778469e-01]
 [ 7.67148779e-02 -4.92271898e-02]
 [-3.39624826e-01  1.29118470e-01]
 [ 1.65296950e-02  1.63540813e-01]
 [-2.06453535e-01 -6.12636557e-03]
 [ 2.47980436e-01  5.22896238e-03]
 [-7.12038448e-02  9.21449835e-03]
 [-1.52648549e-01  3.11419081e-02]
 [-1.25046499e-01  3.04195654e-02]
 [-8.81785129e-02 -2.15261045e-01]
 [-2.02496168e-01 -1.35909157e-01]
 [ 8.89016711e-02  6.60817937e-02]
 [ 3.90477151e-02 -7.47319719e-02]
 [ 7.54510734e-01 -3.59609163e-01]
 [ 2.10453751e-01  1.26916870e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.91754836]
curr_Stock_Price:  96.8747599259104
curr_Factors:  [9.68747599e+01 4.26183715e-02]
mat_Sqrt:  [[ 1.99990361e+01  0.00000000e+00]
 [-8.25768699e-03  1.89207378e-02]]
grads:  [ 0.00192691 -0.08382087]
Stock Position:  0.0019269064816525116
Bond Position:  [-19.10421696]


portfolio before change:  [-18.92375307]
curr_Stock_Price:  96.13364393875361
curr_Factors:  [9.61336439e+01 4.14273330e-02]
mat_Sqrt:  [[ 1.95667588e+01  0.00000000e+00]
 [-8.14148222e-03  1.86544793e-02]]
grads:  [-0.00941617 -3.54219292]
Stock Position:  -0.009416173248278033
Bond Position:  [-18.01854203]


portfolio before change:  [-18.9370942]
curr_Stock_Price:  97.07202128497906
curr_Factors:  [9.70720213e+01 4.13110978e-02]
mat_Sqrt:  [[ 1.97300161e+01  0.00000000e+00]
 [-8.13005267e-03  1.86282909e-02]]
grads:  [-3.41914318e-02 -5.75881317e+01]
Stock Position:  -0.03419143179310661
Bond Position:  [-15.6180628]


portfolio before change:  [-18.99121642]
curr_Stock_Price:  98.5407290882202
curr_Factors:  [9.85407291e+01 3.79848456e-02]
mat_Sqrt:  [[ 1.92052937e+01  0.00000000e+00]
 [-7.79588051e-03  1.78626063e-02]]
grads:  [4.21545636e-03 1.54240651e+01]
Stock Position:  0.004215456357337089
Bond Position:  [-19.40661057]


portfolio before change:  [-18.99238103]
curr_Stock_Price:  99.4155230713312
curr_Factors:  [9.94155231e+01 3.68086909e-02]
mat_Sqrt:  [[ 1.90734558e+01  0.00000000e+00]
 [-7.67423647e-03  1.75838848e-02]]
grads:  [-0.02559459 -6.86870225]
Stock Position:  -0.02559459460136617
Bond Position:  [-16.44788102]


portfolio before change:  [-18.96633655]
curr_Stock_Price:  98.23726805380615
curr_Factors:  [9.82372681e+01 3.50571402e-02]
mat_Sqrt:  [[ 1.83935060e+01  0.00000000e+00]
 [-7.48942083e-03  1.71604189e-02]]
grads:  [ 0.00300271 -2.86864732]
Stock Position:  0.0030027103491370253
Bond Position:  [-19.26131461]


portfolio before change:  [-18.9737762]
curr_Stock_Price:  97.36348446802234
curr_Factors:  [9.73634845e+01 3.65536212e-02]
mat_Sqrt:  [[ 1.86149259e+01  0.00000000e+00]
 [-7.64760053e-03  1.75228542e-02]]
grads:  [-0.01521751  7.3685753 ]
Stock Position:  -0.01521751456325002
Bond Position:  [-17.49214596]


portfolio before change:  [-18.98142994]
curr_Stock_Price:  97.57903593221816
curr_Factors:  [9.75790359e+01 3.46928022e-02]
mat_Sqrt:  [[ 1.81750751e+01  0.00000000e+00]
 [-7.45040157e-03  1.70710146e-02]]
grads:  [4.83655541e-03 9.58002893e+00]
Stock Position:  0.004836555412119759
Bond Position:  [-19.45337636]


portfolio before change:  [-18.98514757]
curr_Stock_Price:  97.81604805339023
curr_Factors:  [9.78160481e+01 3.28582427e-02]
mat_Sqrt:  [[ 1.77309612e+01  0.00000000e+00]
 [-7.25073709e-03  1.66135258e-02]]
grads:  [-0.01179447 -0.3687577 ]
Stock Position:  -0.01179447059077268
Bond Position:  [-17.83145907]


portfolio before change:  [-18.99972037]
curr_Stock_Price:  98.67360050767218
curr_Factors:  [9.86736005e+01 3.25874227e-02]
mat_Sqrt:  [[ 1.78125453e+01  0.00000000e+00]
 [-7.22079472e-03  1.65449192e-02]]
grads:  [0.01404979 0.31604641]
Stock Position:  0.014049791175341511
Bond Position:  [-20.38606385]


portfolio before change:  [-19.02296026]
curr_Stock_Price:  97.3822834139762
curr_Factors:  [9.73822834e+01 3.29131163e-02]
mat_Sqrt:  [[ 1.76670670e+01  0.00000000e+00]
 [-7.25678896e-03  1.66273924e-02]]
grads:  [-0.00380269  0.55417579]
Stock Position:  -0.003802685987241742
Bond Position:  [-18.65264601]


portfolio before change:  [-19.01905913]
curr_Stock_Price:  95.12996114228949
curr_Factors:  [9.51299611e+01 3.26481483e-02]
mat_Sqrt:  [[ 1.71888411e+01  0.00000000e+00]
 [-7.22751944e-03  1.65603275e-02]]
grads:  [-0.00808996  1.88051282]
Stock Position:  -0.008089964052070735
Bond Position:  [-18.24946116]


portfolio before change:  [-19.03943208]
curr_Stock_Price:  97.08423618054482
curr_Factors:  [9.70842362e+01 3.06548716e-02]
mat_Sqrt:  [[ 1.69980252e+01  0.00000000e+00]
 [-7.00341306e-03  1.60468352e-02]]
grads:  [-0.00657549  1.89567382]
Stock Position:  -0.006575488120355669
Bond Position:  [-18.40105584]


portfolio before change:  [-19.04294737]
curr_Stock_Price:  96.91914626063506
curr_Factors:  [9.69191463e+01 3.16599375e-02]
mat_Sqrt:  [[ 1.72450559e+01  0.00000000e+00]
 [-7.11729583e-03  1.63077735e-02]]
grads:  [-1.05610638e-02 -1.31999041e+01]
Stock Position:  -0.010561063768698881
Bond Position:  [-18.01937809]


portfolio before change:  [-19.03331452]
curr_Stock_Price:  95.58043045760958
curr_Factors:  [9.55804305e+01 3.24921513e-02]
mat_Sqrt:  [[ 1.72289264e+01  0.00000000e+00]
 [-7.21023176e-03  1.65207164e-02]]
grads:  [-0.01519606 -8.22658978]
Stock Position:  -0.015196059284751552
Bond Position:  [-17.58086863]


portfolio before change:  [-19.06342989]
curr_Stock_Price:  97.27294842912032
curr_Factors:  [9.72729484e+01 3.15818385e-02]
mat_Sqrt:  [[ 1.72866478e+01  0.00000000e+00]
 [-7.10851191e-03  1.62876469e-02]]
grads:  [0.00681116 4.05717253]
Stock Position:  0.006811160362110383
Bond Position:  [-19.72597154]


portfolio before change:  [-19.06828869]
curr_Stock_Price:  97.2837113863807
curr_Factors:  [9.72837114e+01 3.24152500e-02]
mat_Sqrt:  [[ 1.75151886e+01  0.00000000e+00]
 [-7.20169425e-03  1.65011545e-02]]
grads:  [ 3.67224627e-04 -4.52889353e+00]
Stock Position:  0.0003672246267759964
Bond Position:  [-19.10401366]


portfolio before change:  [-19.07318944]
curr_Stock_Price:  96.94562538042923
curr_Factors:  [9.69456254e+01 3.13927141e-02]
mat_Sqrt:  [[ 1.71768154e+01  0.00000000e+00]
 [-7.08719568e-03  1.62388053e-02]]
grads:  [  0.03478901 -22.14505045]
Stock Position:  0.03478901143197396
Bond Position:  [-22.44583191]


portfolio before change:  [-18.99491419]
curr_Stock_Price:  99.35694459717521
curr_Factors:  [9.93569446e+01 3.14993450e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.99491419]
Stock Price:  98.36710986769903
PL:  [-18.99491419]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.00882393e-02  9.23060326e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.22718820e-01 -2.97902533e-01]
 [ 2.47457794e-01 -1.19904547e-01]
 [-1.77746659e-01 -8.55281603e-02]
 [ 5.53353046e-01 -7.32470494e-01]
 [-5.84334438e-01  4.36265636e-01]
 [ 2.03267108e-01  1.48655600e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.96565143e-01  7.00707655e-03]
 [ 1.32951655e-01  1.97955712e-01]
 [-2.36152108e-01  6.06315415e-02]
 [-1.00231064e-01  3.22383329e-02]
 [-1.16230881e-01 -2.28505968e-01]
 [-8.49516825e-02 -1.17762857e-01]
 [ 8.85551722e-02  7.27491841e-02]
 [ 5.78099499e-02 -8.33506967e-02]
 [ 7.78583474e-01 -3.69977858e-01]
 [ 1.93680169e-01  1.35140114e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.78870295]
curr_Stock_Price:  99.88034042792677
curr_Factors:  [9.98803404e+01 4.05490321e-02]
mat_Sqrt:  [[ 2.01126946e+01  0.00000000e+00]
 [-8.05471609e-03  1.84556731e-02]]
grads:  [-0.00328448  0.50014991]
Stock Position:  -0.0032844765468761227
Bond Position:  [2.11675758]


portfolio before change:  [1.78742539]
curr_Stock_Price:  100.43044802890786
curr_Factors:  [1.00430448e+02 4.04566347e-02]
mat_Sqrt:  [[ 2.02004143e+01  0.00000000e+00]
 [-8.04553388e-03  1.84346340e-02]]
grads:  [-0.00922381 -3.61558413]
Stock Position:  -0.00922381429126166
Bond Position:  [2.71377719]


portfolio before change:  [1.76511626]
curr_Stock_Price:  102.9226547425666
curr_Factors:  [1.02922655e+02 3.97566098e-02]
mat_Sqrt:  [[ 2.05218095e+01  0.00000000e+00]
 [-7.97562384e-03  1.82744500e-02]]
grads:  [-1.23153928e-02 -1.63015868e+01]
Stock Position:  -0.01231539281217954
Bond Position:  [3.03264918]


portfolio before change:  [1.76694407]
curr_Stock_Price:  102.83580801770968
curr_Factors:  [1.02835808e+02 3.83918538e-02]
mat_Sqrt:  [[ 2.01494830e+01  0.00000000e+00]
 [-7.83753572e-03  1.79580503e-02]]
grads:  [ 0.00968398 -6.67692453]
Stock Position:  0.009683978479672433
Bond Position:  [0.77108432]


portfolio before change:  [1.76112013]
curr_Stock_Price:  102.21449978975008
curr_Factors:  [1.02214500e+02 3.90466221e-02]
mat_Sqrt:  [[ 2.01978081e+01  0.00000000e+00]
 [-7.90408726e-03  1.81105391e-02]]
grads:  [-0.01064839 -4.72256292]
Stock Position:  -0.010648393478644637
Bond Position:  [2.84954034]


portfolio before change:  [1.75720531]
curr_Stock_Price:  102.64905333308131
curr_Factors:  [1.02649053e+02 3.83774350e-02]
mat_Sqrt:  [[ 2.01091133e+01  0.00000000e+00]
 [-7.83606381e-03  1.79546778e-02]]
grads:  [ 1.16204385e-02 -4.07955244e+01]
Stock Position:  0.011620438477821304
Bond Position:  [0.5643783]


portfolio before change:  [1.76408147]
curr_Stock_Price:  103.228640272539
curr_Factors:  [1.03228640e+02 3.96661757e-02]
mat_Sqrt:  [[ 2.05593970e+01  0.00000000e+00]
 [-7.96654763e-03  1.82536538e-02]]
grads:  [-1.91607032e-02  2.39001814e+01]
Stock Position:  -0.01916070324350919
Bond Position:  [3.74201482]


portfolio before change:  [1.8055644]
curr_Stock_Price:  101.1124703585217
curr_Factors:  [1.01112470e+02 4.06941294e-02]
mat_Sqrt:  [[ 2.03972022e+01  0.00000000e+00]
 [-8.06911439e-03  1.84886638e-02]]
grads:  [0.0131462  8.04036471]
Stock Position:  0.013146201512414385
Bond Position:  [0.47631949]


portfolio before change:  [1.78142039]
curr_Stock_Price:  99.26683418338364
curr_Factors:  [9.92668342e+01 4.08784285e-02]
mat_Sqrt:  [[ 2.0070180e+01  0.0000000e+00]
 [-8.0873658e-03  1.8530483e-02]]
grads:  [-0.010841   -2.86818812]
Stock Position:  -0.010841002452800943
Bond Position:  [2.85757238]


portfolio before change:  [1.76086664]
curr_Stock_Price:  101.22866623823636
curr_Factors:  [1.01228666e+02 3.99889073e-02]
mat_Sqrt:  [[ 2.02429258e+01  0.00000000e+00]
 [-7.99889066e-03  1.83277610e-02]]
grads:  [0.01480138 0.38232038]
Stock Position:  0.014801382205999731
Bond Position:  [0.26254247]


portfolio before change:  [1.76848922]
curr_Stock_Price:  101.73922184541647
curr_Factors:  [1.01739222e+02 3.79490290e-02]
mat_Sqrt:  [[ 1.98193198e+01  0.00000000e+00]
 [-7.79220420e-03  1.78541828e-02]]
grads:  [1.10673128e-02 1.10873577e+01]
Stock Position:  0.011067312765715952
Bond Position:  [0.64250943]


portfolio before change:  [1.74159738]
curr_Stock_Price:  99.29486335740978
curr_Factors:  [9.92948634e+01 3.83064320e-02]
mat_Sqrt:  [[ 1.94340195e+01  0.00000000e+00]
 [-7.82881161e-03  1.79380609e-02]]
grads:  [-0.01078986  3.38004993]
Stock Position:  -0.010789859211292717
Bond Position:  [2.81297498]


portfolio before change:  [1.75790963]
curr_Stock_Price:  97.84823512792927
curr_Factors:  [9.78482351e+01 4.09543910e-02]
mat_Sqrt:  [[ 1.98017345e+01  0.00000000e+00]
 [-8.09487650e-03  1.85476922e-02]]
grads:  [-0.00435119  1.73813177]
Stock Position:  -0.004351189641379477
Bond Position:  [2.18366586]


portfolio before change:  [1.75840985]
curr_Stock_Price:  97.8587526506906
curr_Factors:  [9.78587527e+01 4.20812264e-02]
mat_Sqrt:  [[ 2.00744599e+01  0.00000000e+00]
 [-8.20548367e-03  1.88011250e-02]]
grads:  [-1.07579014e-02 -1.21538455e+01]
Stock Position:  -0.01075790143908056
Bond Position:  [2.81116467]


portfolio before change:  [1.74013954]
curr_Stock_Price:  99.62240398104615
curr_Factors:  [9.96224040e+01 4.23692681e-02]
mat_Sqrt:  [[ 2.05060730e+01  0.00000000e+00]
 [-8.23351863e-03  1.88653612e-02]]
grads:  [-0.00664913 -6.24227951]
Stock Position:  -0.006649133031475273
Bond Position:  [2.40254216]


portfolio before change:  [1.75371571]
curr_Stock_Price:  97.6709538978243
curr_Factors:  [9.76709539e+01 4.34885389e-02]
mat_Sqrt:  [[ 2.03682088e+01  0.00000000e+00]
 [-8.34156234e-03  1.91129204e-02]]
grads:  [0.00590653 3.806283  ]
Stock Position:  0.005906534078286908
Bond Position:  [1.17681889]


portfolio before change:  [1.74392919]
curr_Stock_Price:  95.96424073983135
curr_Factors:  [9.59642407e+01 4.63963108e-02]
mat_Sqrt:  [[ 2.06705083e+01  0.00000000e+00]
 [-8.61592115e-03  1.97415554e-02]]
grads:  [ 1.03687453e-03 -4.22209369e+00]
Stock Position:  0.0010368745265297002
Bond Position:  [1.64442631]


portfolio before change:  [1.74506995]
curr_Stock_Price:  96.66789676235095
curr_Factors:  [9.66678968e+01 4.38500093e-02]
mat_Sqrt:  [[ 2.02426383e+01  0.00000000e+00]
 [-8.37615753e-03  1.91921880e-02]]
grads:  [  0.03048574 -19.27752371]
Stock Position:  0.03048574451592376
Bond Position:  [-1.20192285]


portfolio before change:  [1.7938034]
curr_Stock_Price:  98.27631962273952
curr_Factors:  [9.82763196e+01 4.08386548e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.7938034]
Stock Price:  96.87621563060766
PL:  [1.7938034]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-8.60893807e-02  2.55876743e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.88401935e-01 -7.46049073e-01]
 [ 1.69680281e-02  2.48427831e-01]
 [-4.39549104e-01 -1.02036212e-01]
 [-1.20313994e-02  6.56658924e-02]
 [-4.87154372e-01  1.92017545e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-2.08960921e-01  3.64296745e-03]
 [ 1.85732221e-01  9.12956723e-03]
 [-1.03652388e-01 -4.31748198e-02]
 [-1.34801445e-01  2.04765231e-02]
 [ 1.49004474e-01 -1.89943960e-02]
 [ 2.02890242e-02 -1.07971670e-01]
 [-2.52232235e-01 -1.20383390e-01]
 [ 8.49117140e-02  4.82752393e-02]
 [ 2.76604869e-02 -5.76670214e-02]
 [ 9.74753347e-01 -4.51248661e-01]
 [ 1.42525230e-01  1.87721563e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.68652757]
curr_Stock_Price:  100.01066262618856
curr_Factors:  [1.00010663e+02 4.19342702e-02]
mat_Sqrt:  [[ 2.04800423e+01  0.00000000e+00]
 [-8.19114353e-03  1.87682676e-02]]
grads:  [-0.00365829  1.36334769]
Stock Position:  -0.003658293425851903
Bond Position:  [3.05239592]


portfolio before change:  [2.6899274]
curr_Stock_Price:  99.28993406628483
curr_Factors:  [9.92899341e+01 4.28271921e-02]
mat_Sqrt:  [[ 2.05477855e+01  0.00000000e+00]
 [-8.27789269e-03  1.89670349e-02]]
grads:  [-0.00906788 -3.5140954 ]
Stock Position:  -0.009067880839191739
Bond Position:  [3.59027669]


portfolio before change:  [2.69095817]
curr_Stock_Price:  99.27525695519202
curr_Factors:  [9.92752570e+01 4.21619819e-02]
mat_Sqrt:  [[ 2.03845688e+01  0.00000000e+00]
 [-8.21335321e-03  1.88191564e-02]]
grads:  [-2.52153700e-02 -3.96430667e+01]
Stock Position:  -0.025215370031438724
Bond Position:  [5.19422051]


portfolio before change:  [2.68720331]
curr_Stock_Price:  99.47567366300328
curr_Factors:  [9.94756737e+01 4.16161588e-02]
mat_Sqrt:  [[ 2.02930761e+01  0.00000000e+00]
 [-8.16001557e-03  1.86969445e-02]]
grads:  [6.17899531e-03 1.32870818e+01]
Stock Position:  0.006178995306312685
Bond Position:  [2.07254359]


portfolio before change:  [2.68212929]
curr_Stock_Price:  98.5706362170485
curr_Factors:  [9.85706362e+01 4.09396301e-02]
mat_Sqrt:  [[ 1.99443330e+01  0.00000000e+00]
 [-8.09341758e-03  1.85443494e-02]]
grads:  [-0.02427162 -5.50228052]
Stock Position:  -0.024271624337863687
Bond Position:  [5.07459874]


portfolio before change:  [2.70365074]
curr_Stock_Price:  97.73621981900207
curr_Factors:  [9.77362198e+01 3.99435360e-02]
mat_Sqrt:  [[ 1.95334426e+01  0.00000000e+00]
 [-7.99435160e-03  1.83173607e-02]]
grads:  [8.51234772e-04 3.58489924e+00]
Stock Position:  0.0008512347718075863
Bond Position:  [2.62045427]


portfolio before change:  [2.70579712]
curr_Stock_Price:  99.48801222016563
curr_Factors:  [9.94880122e+01 3.85267415e-02]
mat_Sqrt:  [[ 1.95277359e+01  0.00000000e+00]
 [-7.85129202e-03  1.79895700e-02]]
grads:  [-0.02065529 10.67382626]
Stock Position:  -0.020655289858964896
Bond Position:  [4.76075085]


portfolio before change:  [2.71298988]
curr_Stock_Price:  99.1974123916803
curr_Factors:  [9.91974124e+01 3.83294983e-02]
mat_Sqrt:  [[ 1.94207908e+01  0.00000000e+00]
 [-7.83116833e-03  1.79434608e-02]]
grads:  [5.03610543e-03 7.56370168e+00]
Stock Position:  0.0050361054328542446
Bond Position:  [2.21342125]


portfolio before change:  [2.70490881]
curr_Stock_Price:  97.48289339274463
curr_Factors:  [9.74828934e+01 3.79378936e-02]
mat_Sqrt:  [[ 1.89873789e+01  0.00000000e+00]
 [-7.79106088e-03  1.78515631e-02]]
grads:  [-0.01092152  0.20406994]
Stock Position:  -0.010921517915678015
Bond Position:  [3.76956997]


portfolio before change:  [2.71989204]
curr_Stock_Price:  96.19729132232791
curr_Factors:  [9.61972913e+01 3.87300749e-02]
mat_Sqrt:  [[ 1.89315866e+01  0.00000000e+00]
 [-7.87198323e-03  1.80369795e-02]]
grads:  [0.01002117 0.50615832]
Stock Position:  0.010021172268889695
Bond Position:  [1.75588241]


portfolio before change:  [2.69510939]
curr_Stock_Price:  93.68045269763142
curr_Factors:  [9.36804527e+01 4.00928749e-02]
mat_Sqrt:  [[ 1.87578293e+01  0.00000000e+00]
 [-8.00928211e-03  1.83515708e-02]]
grads:  [-0.00653036 -2.35264983]
Stock Position:  -0.006530362459882649
Bond Position:  [3.30687671]


portfolio before change:  [2.69084802]
curr_Stock_Price:  94.45961219080674
curr_Factors:  [9.44596122e+01 3.86890552e-02]
mat_Sqrt:  [[ 1.85797652e+01  0.00000000e+00]
 [-7.86781344e-03  1.80274253e-02]]
grads:  [-0.00677429  1.13585399]
Stock Position:  -0.006774292189514296
Bond Position:  [3.33074504]


portfolio before change:  [2.69953859]
curr_Stock_Price:  93.29967148835125
curr_Factors:  [9.32996715e+01 4.07344883e-02]
mat_Sqrt:  [[ 1.88304738e+01  0.00000000e+00]
 [-8.07311472e-03  1.84978297e-02]]
grads:  [ 0.00747271 -1.02684457]
Stock Position:  0.007472708390028482
Bond Position:  [2.00233735]


portfolio before change:  [2.70470767]
curr_Stock_Price:  93.92440296400844
curr_Factors:  [9.39244030e+01 4.06337268e-02]
mat_Sqrt:  [[ 1.89331018e+01  0.00000000e+00]
 [-8.06312364e-03  1.84749372e-02]]
grads:  [-1.41728895e-03 -5.84422395e+00]
Stock Position:  -0.0014172889515711164
Bond Position:  [2.83782569]


portfolio before change:  [2.70580009]
curr_Stock_Price:  93.65425805686152
curr_Factors:  [9.36542581e+01 3.84242674e-02]
mat_Sqrt:  [[ 1.83582097e+01  0.00000000e+00]
 [-7.84084357e-03  1.79656296e-02]]
grads:  [-0.01660139 -6.70076097]
Stock Position:  -0.01660139297095224
Bond Position:  [4.26059123]


portfolio before change:  [2.74422957]
curr_Stock_Price:  91.40359177105866
curr_Factors:  [9.14035918e+01 3.89487657e-02]
mat_Sqrt:  [[ 1.80389025e+01  0.00000000e+00]
 [-7.89417666e-03  1.80878311e-02]]
grads:  [0.00587512 2.66893467]
Stock Position:  0.005875122146579292
Bond Position:  [2.2072223]


portfolio before change:  [2.74850608]
curr_Stock_Price:  92.03755946686023
curr_Factors:  [9.20375595e+01 3.71376644e-02]
mat_Sqrt:  [[ 1.77366823e+01  0.00000000e+00]
 [-7.70845400e-03  1.76622870e-02]]
grads:  [ 1.40529970e-04 -3.26498044e+00]
Stock Position:  0.00014052997021895574
Bond Position:  [2.73557204]


portfolio before change:  [2.74955019]
curr_Stock_Price:  94.60020148433017
curr_Factors:  [9.46002015e+01 3.63901170e-02]
mat_Sqrt:  [[ 1.80461178e+01  0.00000000e+00]
 [-7.63047752e-03  1.74836204e-02]]
grads:  [  0.04310136 -25.80979514]
Stock Position:  0.04310136372393498
Bond Position:  [-1.32784751]


portfolio before change:  [2.68954104]
curr_Stock_Price:  93.21562472958718
curr_Factors:  [9.32156247e+01 3.82119122e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.68954104]
Stock Price:  94.0203999645307
PL:  [2.68954104]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.88257610e-02  1.17096155e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.06560279e-01 -1.87655107e-01]
 [ 3.39874881e-01 -2.74658557e-01]
 [-1.11315443e-01 -7.44739737e-02]
 [ 7.26055625e-01 -9.99703484e-01]
 [-6.46612890e-01  6.75239304e-01]
 [ 6.27515524e-01  1.81979941e-01]
 [ 4.56677949e-02 -7.68441043e-02]
 [ 3.96673083e-02  2.20356347e-02]
 [ 2.28713100e-01  3.39268203e-01]
 [-2.37648434e-01  8.97993664e-02]
 [-1.44752531e-02  3.85235292e-02]
 [-2.59320104e-01 -2.72177932e-01]
 [-9.72653468e-02 -1.23668980e-01]
 [ 9.39771661e-02  5.14737486e-02]
 [-5.20011457e-02 -2.07122938e-02]
 [ 3.53815070e-01 -2.22822381e-01]
 [ 1.92525418e-01  8.11594177e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.12560556]
curr_Stock_Price:  99.92924295028153
curr_Factors:  [9.99292430e+01 4.18386083e-02]
mat_Sqrt:  [[ 2.04400151e+01  0.00000000e+00]
 [-8.18179523e-03  1.87468480e-02]]
grads:  [-0.00360642  0.62461783]
Stock Position:  -0.003606419347807948
Bond Position:  [2.48599231]


portfolio before change:  [2.12589111]
curr_Stock_Price:  100.02241483424896
curr_Factors:  [1.00022415e+02 4.14735260e-02]
mat_Sqrt:  [[ 2.03696147e+01  0.00000000e+00]
 [-8.14601998e-03  1.86648766e-02]]
grads:  [-0.0091472  -3.57098371]
Stock Position:  -0.009147196574321982
Bond Position:  [3.0408158]


portfolio before change:  [2.09166841]
curr_Stock_Price:  103.84686553839461
curr_Factors:  [1.03846866e+02 4.16726756e-02]
mat_Sqrt:  [[ 2.11991811e+01  0.00000000e+00]
 [-8.16555454e-03  1.87096359e-02]]
grads:  [-8.88995106e-03 -1.00298642e+01]
Stock Position:  -0.00888995105685218
Bond Position:  [3.01486196]


portfolio before change:  [2.08402853]
curr_Stock_Price:  104.79104332480048
curr_Factors:  [1.04791043e+02 4.17210396e-02]
mat_Sqrt:  [[ 2.14043343e+01  0.00000000e+00]
 [-8.17029151e-03  1.87204897e-02]]
grads:  [ 1.02784817e-02 -1.46715477e+01]
Stock Position:  0.010278481733572858
Bond Position:  [1.0069357]


portfolio before change:  [2.07213408]
curr_Stock_Price:  103.6093307150889
curr_Factors:  [1.03609331e+02 4.28008243e-02]
mat_Sqrt:  [[ 2.14350714e+01  0.00000000e+00]
 [-8.27534404e-03  1.89611952e-02]]
grads:  [-0.0067095 -3.9277046]
Stock Position:  -0.006709497130069347
Bond Position:  [2.76730059]


portfolio before change:  [2.06620108]
curr_Stock_Price:  104.59672392146878
curr_Factors:  [1.04596724e+02 4.18149419e-02]
mat_Sqrt:  [[ 2.13886725e+01  0.00000000e+00]
 [-8.17948085e-03  1.87415451e-02]]
grads:  [ 1.35468555e-02 -5.33415724e+01]
Stock Position:  0.013546855464066403
Bond Position:  [0.64924438]


portfolio before change:  [2.09622806]
curr_Stock_Price:  106.8012683616151
curr_Factors:  [1.06801268e+02 3.83253253e-02]
mat_Sqrt:  [[ 2.09083295e+01  0.00000000e+00]
 [-7.83074201e-03  1.79424840e-02]]
grads:  [-1.68312967e-02  3.76335463e+01]
Stock Position:  -0.01683129671407653
Bond Position:  [3.89383189]


portfolio before change:  [2.12146003]
curr_Stock_Price:  105.36000151744665
curr_Factors:  [1.05360002e+02 3.89606335e-02]
mat_Sqrt:  [[ 2.07964293e+01  0.00000000e+00]
 [-7.89537925e-03  1.80905865e-02]]
grads:  [ 0.03399324 10.05937208]
Stock Position:  0.03399324341900333
Bond Position:  [-1.46006815]


portfolio before change:  [2.06118895]
curr_Stock_Price:  103.59770960796715
curr_Factors:  [1.03597710e+02 3.96890654e-02]
mat_Sqrt:  [[ 2.06388545e+01  0.00000000e+00]
 [-7.96884588e-03  1.82589197e-02]]
grads:  [ 5.87739897e-04 -4.20857890e+00]
Stock Position:  0.000587739896896033
Bond Position:  [2.00030044]


portfolio before change:  [2.06282003]
curr_Stock_Price:  105.5219420100119
curr_Factors:  [1.05521942e+02 3.84579153e-02]
mat_Sqrt:  [[ 2.06935807e+01  0.00000000e+00]
 [-7.84427590e-03  1.79734941e-02]]
grads:  [0.00238163 1.22600729]
Stock Position:  0.002381629765771586
Bond Position:  [1.81150583]


portfolio before change:  [2.0615884]
curr_Stock_Price:  104.81462589238245
curr_Factors:  [1.04814626e+02 3.86059253e-02]
mat_Sqrt:  [[ 2.05943871e+01  0.00000000e+00]
 [-7.85935624e-03  1.80080474e-02]]
grads:  [1.82953676e-02 1.88398106e+01]
Stock Position:  0.01829536763341262
Bond Position:  [0.14396629]


portfolio before change:  [1.99726397]
curr_Stock_Price:  101.29677224403963
curr_Factors:  [1.01296772e+02 3.89865608e-02]
mat_Sqrt:  [[ 2.00010626e+01  0.00000000e+00]
 [-7.89800591e-03  1.80966050e-02]]
grads:  [-0.00992231  4.96222173]
Stock Position:  -0.009922311693432833
Bond Position:  [3.00236212]


portfolio before change:  [2.00642388]
curr_Stock_Price:  100.44926589541822
curr_Factors:  [1.00449266e+02 4.01976360e-02]
mat_Sqrt:  [[ 2.01394230e+01  0.00000000e+00]
 [-8.01973925e-03  1.83755311e-02]]
grads:  [1.16080457e-04 2.09645801e+00]
Stock Position:  0.00011608045659693156
Bond Position:  [1.99476368]


portfolio before change:  [2.00701371]
curr_Stock_Price:  101.23392202187608
curr_Factors:  [1.01233922e+02 3.90980887e-02]
mat_Sqrt:  [[ 2.00172229e+01  0.00000000e+00]
 [-7.90929465e-03  1.81224707e-02]]
grads:  [ -0.01888915 -15.01880931]
Stock Position:  -0.01888914824489689
Bond Position:  [3.91923627]


portfolio before change:  [2.05361858]
curr_Stock_Price:  98.81851747761509
curr_Factors:  [9.88185175e+01 4.13747023e-02]
mat_Sqrt:  [[ 2.01004498e+01  0.00000000e+00]
 [-8.13630897e-03  1.86426259e-02]]
grads:  [-0.00752416 -6.63366745]
Stock Position:  -0.007524155754556127
Bond Position:  [2.7971445]


portfolio before change:  [2.04883208]
curr_Stock_Price:  99.54761877258333
curr_Factors:  [9.95476188e+01 4.20580623e-02]
mat_Sqrt:  [[ 2.04152878e+01  0.00000000e+00]
 [-8.20322496e-03  1.87959497e-02]]
grads:  [0.00570367 2.73855535]
Stock Position:  0.005703674275514725
Bond Position:  [1.48104489]


portfolio before change:  [2.06017997]
curr_Stock_Price:  101.47226955860309
curr_Factors:  [1.01472270e+02 3.95354011e-02]
mat_Sqrt:  [[ 2.01762499e+01  0.00000000e+00]
 [-7.95340441e-03  1.82235389e-02]]
grads:  [-0.00302538 -1.13656815]
Stock Position:  -0.0030253754817063127
Bond Position:  [2.36717169]


portfolio before change:  [2.05773483]
curr_Stock_Price:  102.47611358878171
curr_Factors:  [1.02476114e+02 3.95430273e-02]
mat_Sqrt:  [[ 2.03778145e+01  0.00000000e+00]
 [-7.95417147e-03  1.82252964e-02]]
grads:  [  0.01259053 -12.2259949 ]
Stock Position:  0.012590526374058976
Bond Position:  [0.76750662]


portfolio before change:  [2.05238681]
curr_Stock_Price:  102.03610634496083
curr_Factors:  [1.02036106e+02 3.82017691e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.05238681]
Stock Price:  103.28426513415545
PL:  [-1.23187833]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.51813026e-02  3.33513864e-03]
 [ 5.02789282e-03 -2.22899788e-02]
 [-1.55131356e-01 -5.19048652e-01]
 [ 8.60948094e-02  1.37064730e-01]
 [-3.30890997e-01 -1.04889175e-01]
 [ 2.78271879e-01 -3.11831744e-01]
 [-4.96586852e-01  2.03881916e-01]
 [ 3.73850136e-02  1.37217833e-01]
 [-2.02522389e-01 -2.14429890e-02]
 [ 2.82086259e-01  4.61351495e-03]
 [-6.76810445e-03  7.10939421e-02]
 [-2.36241038e-01  6.23650435e-02]
 [-3.74164404e-02  3.68421287e-02]
 [-2.22309327e-01 -2.70879942e-01]
 [ 5.37720041e-02 -5.88222714e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.28510371e-02  2.01574453e-01]
 [ 1.29312101e-01  3.66584288e-02]
 [-3.59213621e-02 -1.95905050e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.07309666]
curr_Stock_Price:  99.61009409001622
curr_Factors:  [9.96100941e+01 3.91511021e-02]
mat_Sqrt:  [[ 1.97094882e+01  0.00000000e+00]
 [-7.91465498e-03  1.81347528e-02]]
grads:  [-0.0006964   0.18390869]
Stock Position:  -0.0006964020913365613
Bond Position:  [-0.00372798]


portfolio before change:  [-0.074748]
curr_Stock_Price:  101.98000358323605
curr_Factors:  [1.01980004e+02 3.97062641e-02]
mat_Sqrt:  [[ 2.03209748e+01  0.00000000e+00]
 [-7.97057229e-03  1.82628754e-02]]
grads:  [-2.31300493e-04 -1.22050763e+00]
Stock Position:  -0.00023130049261948138
Bond Position:  [-0.05115998]


portfolio before change:  [-0.07455698]
curr_Stock_Price:  101.09882682308648
curr_Factors:  [1.01098827e+02 4.12366590e-02]
mat_Sqrt:  [[ 2.05299481e+01  0.00000000e+00]
 [-8.12272457e-03  1.86115001e-02]]
grads:  [-1.85905370e-02 -2.78885984e+01]
Stock Position:  -0.018590536999409945
Bond Position:  [1.80492451]


portfolio before change:  [-0.06085557]
curr_Stock_Price:  100.3860920726222
curr_Factors:  [1.00386092e+02 4.16836267e-02]
mat_Sqrt:  [[ 2.04953952e+01  0.00000000e+00]
 [-8.16662738e-03  1.87120941e-02]]
grads:  [7.11939245e-03 7.32492736e+00]
Stock Position:  0.00711939244538582
Bond Position:  [-0.77554355]


portfolio before change:  [-0.06013235]
curr_Stock_Price:  100.51491357761952
curr_Factors:  [1.00514914e+02 4.33207082e-02]
mat_Sqrt:  [[ 2.09207995e+01  0.00000000e+00]
 [-8.32545092e-03  1.90760045e-02]]
grads:  [-0.01800449 -5.49848765]
Stock Position:  -0.018004492890176783
Bond Position:  [1.7495877]


portfolio before change:  [-0.03853591]
curr_Stock_Price:  99.3397075353101
curr_Factors:  [9.93397075e+01 4.46686125e-02]
mat_Sqrt:  [[ 2.09953978e+01  0.00000000e+00]
 [-8.45398012e-03  1.93705019e-02]]
grads:  [ 6.77183397e-03 -1.60982790e+01]
Stock Position:  0.006771833966211378
Bond Position:  [-0.71124791]


portfolio before change:  [-0.03675451]
curr_Stock_Price:  99.62902831159825
curr_Factors:  [9.96290283e+01 4.26468640e-02]
mat_Sqrt:  [[ 2.05745074e+01  0.00000000e+00]
 [-8.26044687e-03  1.89270615e-02]]
grads:  [-0.01981119 10.77197933]
Stock Position:  -0.019811190697826157
Bond Position:  [1.93701517]


portfolio before change:  [-0.02188792]
curr_Stock_Price:  98.9030609929532
curr_Factors:  [9.89030610e+01 4.13672387e-02]
mat_Sqrt:  [[ 2.01158320e+01  0.00000000e+00]
 [-8.13557509e-03  1.86409443e-02]]
grads:  [4.83558352e-03 7.36109879e+00]
Stock Position:  0.004835583515507579
Bond Position:  [-0.50014193]


portfolio before change:  [-0.02582861]
curr_Stock_Price:  98.11398569554866
curr_Factors:  [9.81139857e+01 4.16634164e-02]
mat_Sqrt:  [[ 2.00266523e+01  0.00000000e+00]
 [-8.16464735e-03  1.87075572e-02]]
grads:  [-0.01057994 -1.14622068]
Stock Position:  -0.010579944806533797
Bond Position:  [1.01221195]


portfolio before change:  [-0.04198522]
curr_Stock_Price:  99.66500524624058
curr_Factors:  [9.96650052e+01 4.09434046e-02]
mat_Sqrt:  [[ 2.01666922e+01  0.00000000e+00]
 [-8.09379067e-03  1.85452042e-02]]
grads:  [0.01408757 0.24877132]
Stock Position:  0.014087573648258418
Bond Position:  [-1.44602332]


portfolio before change:  [-0.05827019]
curr_Stock_Price:  98.53468904685417
curr_Factors:  [9.85346890e+01 4.22021465e-02]
mat_Sqrt:  [[ 2.02421398e+01  0.00000000e+00]
 [-8.21726441e-03  1.88281181e-02]]
grads:  [1.19848177e-03 3.77594520e+00]
Stock Position:  0.0011984817737769713
Bond Position:  [-0.17636222]


portfolio before change:  [-0.058417]
curr_Stock_Price:  98.44897905026392
curr_Factors:  [9.84489791e+01 4.22346807e-02]
mat_Sqrt:  [[ 2.02323265e+01  0.00000000e+00]
 [-8.22043120e-03  1.88353741e-02]]
grads:  [-0.01033113  3.31105945]
Stock Position:  -0.010331125373614155
Bond Position:  [0.95867174]


portfolio before change:  [-0.07117147]
curr_Stock_Price:  99.70674726035774
curr_Factors:  [9.97067473e+01 4.23168425e-02]
mat_Sqrt:  [[ 2.05107328e+01  0.00000000e+00]
 [-8.22842318e-03  1.88536860e-02]]
grads:  [-1.04029522e-03  1.95410747e+00]
Stock Position:  -0.0010402952196544432
Bond Position:  [0.03255298]


portfolio before change:  [-0.07169853]
curr_Stock_Price:  100.2212191749144
curr_Factors:  [1.00221219e+02 3.95201100e-02]
mat_Sqrt:  [[ 1.99236431e+01  0.00000000e+00]
 [-7.95186619e-03  1.82200144e-02]]
grads:  [ -0.01709181 -14.86716401]
Stock Position:  -0.01709180516123774
Bond Position:  [1.64126302]


portfolio before change:  [-0.0961534]
curr_Stock_Price:  101.67602361989717
curr_Factors:  [1.01676024e+02 3.84086144e-02]
mat_Sqrt:  [[ 1.99265849e+01  0.00000000e+00]
 [-7.83924633e-03  1.79619698e-02]]
grads:  [ 1.41016940e-03 -3.27482297e+00]
Stock Position:  0.0014101693989395853
Bond Position:  [-0.23953382]


portfolio before change:  [-0.09166843]
curr_Stock_Price:  104.89894111442767
curr_Factors:  [1.04898941e+02 3.71017314e-02]
mat_Sqrt:  [[ 2.02054344e+01  0.00000000e+00]
 [-7.70472389e-03  1.76537402e-02]]
grads:  [0.004751   0.99305051]
Stock Position:  0.004750995605712003
Bond Position:  [-0.59004284]


portfolio before change:  [-0.08195658]
curr_Stock_Price:  106.97416445589036
curr_Factors:  [1.06974164e+02 3.36940475e-02]
mat_Sqrt:  [[ 1.96361118e+01  0.00000000e+00]
 [-7.34237537e-03  1.68234955e-02]]
grads:  [1.78870781e-03 1.19817224e+01]
Stock Position:  0.0017887078073638301
Bond Position:  [-0.2733021]


portfolio before change:  [-0.08184661]
curr_Stock_Price:  107.07384986920235
curr_Factors:  [1.07073850e+02 3.22114026e-02]
mat_Sqrt:  [[ 1.92171171e+01  0.00000000e+00]
 [-7.17901415e-03  1.64491879e-02]]
grads:  [0.00756155 2.22858594]
Stock Position:  0.007561547892710893
Bond Position:  [-0.89149065]


portfolio before change:  [-0.0732017]
curr_Stock_Price:  108.24660007665368
curr_Factors:  [1.08246600e+02 3.21765588e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.0732017]
Stock Price:  109.19742309366141
PL:  [-9.2706248]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.00103057e-01  5.23625641e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.06123953e-01 -8.66963881e-01]
 [-3.12047115e-02  2.76360767e-01]
 [-4.26953944e-01 -4.96175297e-02]
 [-3.08412881e-02  9.19692409e-02]
 [-2.21592236e-01  6.43984000e-02]
 [-1.09376568e-01 -9.57324161e-02]
 [-2.48285847e-01  1.69098500e-01]
 [ 5.66383887e-02  1.72188599e-02]
 [-9.55899818e-02 -1.66141194e-02]
 [-6.15703855e-02 -2.30483559e-02]
 [ 2.94769744e-01 -4.42538229e-02]
 [ 1.95386372e-01  1.51943122e-01]
 [-2.93100585e-01 -1.03183746e-01]
 [ 9.00380696e-02  1.37331743e-02]
 [ 6.54287111e-02 -8.47155460e-02]
 [ 1.15624181e+00 -5.26799176e-01]
 [ 1.43992534e-01  1.86684540e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.76876627]
curr_Stock_Price:  100.16775313360459
curr_Factors:  [1.00167753e+02 4.21348740e-02]
mat_Sqrt:  [[ 2.05612154e+01  0.00000000e+00]
 [-8.21071242e-03  1.88131056e-02]]
grads:  [-0.00375708  2.78330252]
Stock Position:  -0.0037570814084631455
Bond Position:  [4.14510467]


portfolio before change:  [3.77905325]
curr_Stock_Price:  97.70558207345165
curr_Factors:  [9.77055821e+01 4.24004136e-02]
mat_Sqrt:  [[ 2.01189088e+01  0.00000000e+00]
 [-8.23654428e-03  1.88722938e-02]]
grads:  [-0.00926118 -3.53173657]
Stock Position:  -0.009261181692185412
Bond Position:  [4.6839224]


portfolio before change:  [3.77426836]
curr_Stock_Price:  98.34869876384907
curr_Factors:  [9.83486988e+01 4.16101560e-02]
mat_Sqrt:  [[ 2.00617258e+01  0.00000000e+00]
 [-8.15942704e-03  1.86955960e-02]]
grads:  [-2.91349816e-02 -4.63726259e+01]
Stock Position:  -0.029134981559667393
Bond Position:  [6.63965588]


portfolio before change:  [3.79539651]
curr_Stock_Price:  97.68049734166442
curr_Factors:  [9.76804973e+01 4.04527675e-02]
mat_Sqrt:  [[ 1.96463547e+01  0.00000000e+00]
 [-8.04514935e-03  1.84337529e-02]]
grads:  [4.55092137e-03 1.49921054e+01]
Stock Position:  0.0045509213665293575
Bond Position:  [3.35086025]


portfolio before change:  [3.78939831]
curr_Stock_Price:  96.17837967432506
curr_Factors:  [9.61783797e+01 4.13693759e-02]
mat_Sqrt:  [[ 1.95621660e+01  0.00000000e+00]
 [-8.13578524e-03  1.86414258e-02]]
grads:  [-0.02293247 -2.66168104]
Stock Position:  -0.022932471200395266
Bond Position:  [5.99500624]


portfolio before change:  [3.7610069]
curr_Stock_Price:  97.4817869940033
curr_Factors:  [9.74817870e+01 3.96831555e-02]
mat_Sqrt:  [[ 1.94189875e+01  0.00000000e+00]
 [-7.96825256e-03  1.82575603e-02]]
grads:  [4.7877776e-04 5.0373237e+00]
Stock Position:  0.0004787777599707585
Bond Position:  [3.71433479]


portfolio before change:  [3.76042568]
curr_Stock_Price:  94.32807895713998
curr_Factors:  [9.43280790e+01 4.25857158e-02]
mat_Sqrt:  [[ 1.94658318e+01  0.00000000e+00]
 [-8.25452272e-03  1.89134876e-02]]
grads:  [-0.0099398   3.40489292]
Stock Position:  -0.009939799743952756
Bond Position:  [4.69802789]


portfolio before change:  [3.77024258]
curr_Stock_Price:  93.4586198147802
curr_Factors:  [9.34586198e+01 4.20102989e-02]
mat_Sqrt:  [[ 1.91556657e+01  0.00000000e+00]
 [-8.19856562e-03  1.87852738e-02]]
grads:  [-0.00789101 -5.09614165]
Stock Position:  -0.007891013654365743
Bond Position:  [4.50772583]


portfolio before change:  [3.78623421]
curr_Stock_Price:  91.57488752628677
curr_Factors:  [9.15748875e+01 4.40258992e-02]
mat_Sqrt:  [[ 1.92145630e+01  0.00000000e+00]
 [-8.39293981e-03  1.92306410e-02]]
grads:  [-0.00908088  8.79318063]
Stock Position:  -0.009080883687426228
Bond Position:  [4.61781511]


portfolio before change:  [3.78037495]
curr_Stock_Price:  92.34726322511402
curr_Factors:  [9.23472632e+01 4.19723861e-02]
mat_Sqrt:  [[ 1.89193346e+01  0.00000000e+00]
 [-8.19486533e-03  1.87767953e-02]]
grads:  [0.00339089 0.91702868]
Stock Position:  0.003390886439368281
Bond Position:  [3.46723587]


portfolio before change:  [3.77940583]
curr_Stock_Price:  91.80579863038002
curr_Factors:  [9.18057986e+01 4.13038344e-02]
mat_Sqrt:  [[ 1.86580090e+01  0.00000000e+00]
 [-8.12933792e-03  1.86266532e-02]]
grads:  [-0.00551189 -0.89195408]
Stock Position:  -0.005511894540242501
Bond Position:  [4.28542971]


portfolio before change:  [3.78057914]
curr_Stock_Price:  91.787325743399
curr_Factors:  [9.17873257e+01 4.30101382e-02]
mat_Sqrt:  [[ 1.90356686e+01  0.00000000e+00]
 [-8.29555430e-03  1.90075027e-02]]
grads:  [-0.00376291 -1.21259253]
Stock Position:  -0.0037629102590595763
Bond Position:  [4.12596661]


portfolio before change:  [3.7830536]
curr_Stock_Price:  91.40388781512439
curr_Factors:  [9.14038878e+01 4.33567086e-02]
mat_Sqrt:  [[ 1.90323678e+01  0.00000000e+00]
 [-8.32890951e-03  1.90839292e-02]]
grads:  [ 0.01447302 -2.31890522]
Stock Position:  0.014473017520000775
Bond Position:  [2.46016353]


portfolio before change:  [3.76439877]
curr_Stock_Price:  90.07244815144746
curr_Factors:  [9.00724482e+01 4.36948334e-02]
mat_Sqrt:  [[ 1.88281223e+01  0.00000000e+00]
 [-8.36132367e-03  1.91581993e-02]]
grads:  [0.01389941 7.93097094]
Stock Position:  0.013899409774103273
Bond Position:  [2.5124449]


portfolio before change:  [3.78125841]
curr_Stock_Price:  91.24022764482329
curr_Factors:  [9.12402276e+01 4.34363850e-02]
mat_Sqrt:  [[ 1.90157385e+01  0.00000000e+00]
 [-8.33655900e-03  1.91014563e-02]]
grads:  [-0.01778178 -5.40187848]
Stock Position:  -0.01778177917603285
Bond Position:  [5.40367199]


portfolio before change:  [3.75459241]
curr_Stock_Price:  92.81583407224535
curr_Factors:  [9.28158341e+01 4.08674604e-02]
mat_Sqrt:  [[ 1.87633723e+01  0.00000000e+00]
 [-8.08628077e-03  1.85279969e-02]]
grads:  [0.00511804 0.74121204]
Stock Position:  0.005118041494303718
Bond Position:  [3.27955712]


portfolio before change:  [3.76600435]
curr_Stock_Price:  94.88536718153006
curr_Factors:  [9.48853672e+01 4.15629730e-02]
mat_Sqrt:  [[ 1.93442789e+01  0.00000000e+00]
 [-8.15479961e-03  1.86849933e-02]]
grads:  [ 1.47101972e-03 -4.53388154e+00]
Stock Position:  0.0014710197170149165
Bond Position:  [3.62642611]


portfolio before change:  [3.76364531]
curr_Stock_Price:  92.66529726368279
curr_Factors:  [9.26652973e+01 4.17253230e-02]
mat_Sqrt:  [[ 1.89285339e+01  0.00000000e+00]
 [-8.17071092e-03  1.87214506e-02]]
grads:  [  0.04893817 -28.13880114]
Stock Position:  0.04893816956158944
Bond Position:  [-0.77122472]


portfolio before change:  [3.79551333]
curr_Stock_Price:  93.32042711406316
curr_Factors:  [9.33204271e+01 4.46287729e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.79551333]
Stock Price:  94.17508471914005
PL:  [3.79551333]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.04256278e-01  3.87704629e-01]
 [ 8.94146572e-02 -2.14660308e-02]
 [-1.72077069e-01 -6.34666837e-01]
 [ 9.30317381e-02  1.26322826e-01]
 [-2.83304563e-01 -9.92119247e-02]
 [ 4.92376662e-01 -6.38119365e-01]
 [-5.28549687e-01  3.00253240e-01]
 [ 2.10907769e-01  1.49255767e-01]
 [ 1.18185400e-01 -1.17754479e-01]
 [-4.36703428e-02  2.65553695e-02]
 [ 3.25205584e-01  4.93316745e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.10486848e-01  1.30593075e-01]
 [-2.23214282e-01  2.02575335e-02]
 [ 2.52994784e-01  3.20036770e-01]
 [ 8.12806715e-02  2.42567741e-02]
 [-5.38950285e-02  3.66655545e-01]
 [ 1.30067940e-01  1.57486308e-01]
 [-4.14401677e-02 -2.51266775e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.6119326]
curr_Stock_Price:  102.46744085202353
curr_Factors:  [1.02467441e+02 3.76089625e-02]
mat_Sqrt:  [[ 1.98715419e+01  0.00000000e+00]
 [-7.75721212e-03  1.77740059e-02]]
grads:  [1.37616121e-02 2.18130135e+01]
Stock Position:  0.01376161209417807
Bond Position:  [18.20181543]


portfolio before change:  [19.61526853]
curr_Stock_Price:  102.37914488624308
curr_Factors:  [1.02379145e+02 3.68116640e-02]
mat_Sqrt:  [[ 1.96428374e+01  0.00000000e+00]
 [-7.67454640e-03  1.75845949e-02]]
grads:  [ 0.00407508 -1.22072933]
Stock Position:  0.004075078947198126
Bond Position:  [19.19806543]


portfolio before change:  [19.61086335]
curr_Stock_Price:  100.12021954669957
curr_Factors:  [1.0012022e+02 3.7566947e-02]
mat_Sqrt:  [[ 1.94054959e+01  0.00000000e+00]
 [-7.75287787e-03  1.77640748e-02]]
grads:  [-2.31412992e-02 -3.57275480e+01]
Stock Position:  -0.023141299187064764
Bond Position:  [21.9277753]


portfolio before change:  [19.60824853]
curr_Stock_Price:  100.4701327140567
curr_Factors:  [1.00470133e+02 3.74183682e-02]
mat_Sqrt:  [[ 1.94347697e+01  0.00000000e+00]
 [-7.73753120e-03  1.77289112e-02]]
grads:  [0.00762363 7.12524444]
Stock Position:  0.007623632376736344
Bond Position:  [18.84230117]


portfolio before change:  [19.61674474]
curr_Stock_Price:  100.9666206050841
curr_Factors:  [1.00966621e+02 3.94802246e-02]
mat_Sqrt:  [[ 2.00616952e+01  0.00000000e+00]
 [-7.94785250e-03  1.82108178e-02]]
grads:  [-0.01627999 -5.44796645]
Stock Position:  -0.01627998998238169
Bond Position:  [21.26048031]


portfolio before change:  [19.60588025]
curr_Stock_Price:  101.96049513543976
curr_Factors:  [1.01960495e+02 3.74299545e-02]
mat_Sqrt:  [[ 1.97261161e+01  0.00000000e+00]
 [-7.73872904e-03  1.77316558e-02]]
grads:  [ 1.08424050e-02 -3.59875791e+01]
Stock Position:  0.010842404960069775
Bond Position:  [18.50038327]


portfolio before change:  [19.60197439]
curr_Stock_Price:  101.17362778667427
curr_Factors:  [1.01173628e+02 3.75468039e-02]
mat_Sqrt:  [[ 1.96044115e+01  0.00000000e+00]
 [-7.75079907e-03  1.77593117e-02]]
grads:  [-0.02027648 16.9068061 ]
Stock Position:  -0.020276478578109942
Bond Position:  [21.65341929]


portfolio before change:  [19.60720265]
curr_Stock_Price:  101.18278958100659
curr_Factors:  [1.01182790e+02 3.60090724e-02]
mat_Sqrt:  [[ 1.92005034e+01  0.00000000e+00]
 [-7.59042264e-03  1.73918432e-02]]
grads:  [0.01437714 8.58194071]
Stock Position:  0.014377140011351056
Bond Position:  [18.15248352]


portfolio before change:  [19.66389334]
curr_Stock_Price:  104.81021486510555
curr_Factors:  [1.04810215e+02 3.59769834e-02]
mat_Sqrt:  [[ 1.98799819e+01  0.00000000e+00]
 [-7.58703984e-03  1.73840922e-02]]
grads:  [ 3.35981855e-03 -6.77369158e+00]
Stock Position:  0.003359818546367807
Bond Position:  [19.31175004]


portfolio before change:  [19.67592337]
curr_Stock_Price:  106.95363100265918
curr_Factors:  [1.06953631e+02 3.49438525e-02]
mat_Sqrt:  [[ 1.99931362e+01  0.00000000e+00]
 [-7.47730995e-03  1.71326694e-02]]
grads:  [-0.00160458  1.54998435]
Stock Position:  -0.0016045821452759742
Bond Position:  [19.84753926]


portfolio before change:  [19.67940999]
curr_Stock_Price:  107.87342682369483
curr_Factors:  [1.07873427e+02 3.36132193e-02]
mat_Sqrt:  [[ 1.97774151e+01  0.00000000e+00]
 [-7.33356331e-03  1.68033045e-02]]
grads:  [2.73294897e-02 2.93583173e+01]
Stock Position:  0.027329489688981197
Bond Position:  [16.73128429]


portfolio before change:  [19.66848145]
curr_Stock_Price:  107.32047503349959
curr_Factors:  [1.07320475e+02 3.61569473e-02]
mat_Sqrt:  [[ 2.04069671e+01  0.00000000e+00]
 [-7.60599209e-03  1.74275172e-02]]
grads:  [-0.00926193  6.56049409]
Stock Position:  -0.00926193309241904
Bond Position:  [20.6624765]


portfolio before change:  [19.6720201]
curr_Stock_Price:  107.49620617890491
curr_Factors:  [1.07496206e+02 3.81329777e-02]
mat_Sqrt:  [[ 2.09915011e+01  0.00000000e+00]
 [-7.81106679e-03  1.78974024e-02]]
grads:  [-2.54823879e-03  7.29676139e+00]
Stock Position:  -0.0025482387904451065
Bond Position:  [19.9459461]


portfolio before change:  [19.67454994]
curr_Stock_Price:  108.46050902743035
curr_Factors:  [1.08460509e+02 3.86801038e-02]
mat_Sqrt:  [[ 2.13312081e+01  0.00000000e+00]
 [-7.86690320e-03  1.80253397e-02]]
grads:  [-0.01004974  1.12383643]
Stock Position:  -0.010049743468352398
Bond Position:  [20.76455023]


portfolio before change:  [19.67242884]
curr_Stock_Price:  109.18817727463701
curr_Factors:  [1.09188177e+02 3.91491358e-02]
mat_Sqrt:  [[ 2.16041262e+01  0.00000000e+00]
 [-7.91445623e-03  1.81342974e-02]]
grads:  [ 0.01817571 17.64814836]
Stock Position:  0.01817570761095212
Bond Position:  [17.68785646]


portfolio before change:  [19.66487294]
curr_Stock_Price:  108.52914254579002
curr_Factors:  [1.08529143e+02 3.91676615e-02]
mat_Sqrt:  [[ 2.14788089e+01  0.00000000e+00]
 [-7.91632859e-03  1.81385875e-02]]
grads:  [0.00427711 1.33730226]
Stock Position:  0.004277108483582148
Bond Position:  [19.20068202]


portfolio before change:  [19.68051227]
curr_Stock_Price:  111.06322963466941
curr_Factors:  [1.1106323e+02 3.6508117e-02]
mat_Sqrt:  [[ 2.12209594e+01  0.00000000e+00]
 [-7.64283894e-03  1.75119440e-02]]
grads:  [5.00102602e-03 2.09374553e+01]
Stock Position:  0.00500102601905076
Bond Position:  [19.12508217]


portfolio before change:  [19.67762515]
curr_Stock_Price:  109.52974667092859
curr_Factors:  [1.09529747e+02 3.62826728e-02]
mat_Sqrt:  [[ 2.08632384e+01  0.00000000e+00]
 [-7.61920446e-03  1.74577906e-02]]
grads:  [0.00952875 9.02097588]
Stock Position:  0.009528750844742986
Bond Position:  [18.63394349]


portfolio before change:  [19.6902209]
curr_Stock_Price:  110.36266609612555
curr_Factors:  [1.10362666e+02 3.68926139e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.6902209]
Stock Price:  114.33602303198032
PL:  [5.35419787]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-3.61980719e-02  1.76635833e-01]
 [ 1.41472348e-01 -2.44140569e-02]
 [-1.20990573e-01 -2.86110950e-01]
 [ 4.00283067e-01 -3.75813110e-01]
 [-1.06491845e-01 -7.37503680e-02]
 [ 4.30621890e-01 -5.42231808e-01]
 [-5.52178225e-01  3.58459644e-01]
 [ 2.11455168e-01  1.49298764e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.37494795e-01  1.12369310e-02]
 [ 1.15835752e-01  1.83471314e-01]
 [-2.37693689e-01  9.06815132e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.34060611e-01 -2.74104435e-01]
 [-3.04789699e-03 -8.33455022e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.18874572e-02  4.23646152e-02]
 [ 4.00335889e-01 -2.36344671e-01]
 [ 1.76038598e-01  6.81860141e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.56546529]
curr_Stock_Price:  101.00916306811325
curr_Factors:  [1.01009163e+02 3.96918477e-02]
mat_Sqrt:  [[ 2.01238666e+01  0.00000000e+00]
 [-7.96912519e-03  1.82595597e-02]]
grads:  [2.03202131e-03 9.67360858e+00]
Stock Position:  0.002032021313542356
Bond Position:  [9.36021252]


portfolio before change:  [9.57111923]
curr_Stock_Price:  102.63985148131538
curr_Factors:  [1.02639851e+02 3.79149089e-02]
mat_Sqrt:  [[ 1.99857764e+01  0.00000000e+00]
 [-7.78870042e-03  1.78461546e-02]]
grads:  [ 0.00654551 -1.36802899]
Stock Position:  0.006545514067959496
Bond Position:  [8.89928864]


portfolio before change:  [9.57570186]
curr_Stock_Price:  103.00002706454299
curr_Factors:  [1.03000027e+02 3.61571678e-02]
mat_Sqrt:  [[ 1.95854945e+01  0.00000000e+00]
 [-7.60601528e-03  1.74275704e-02]]
grads:  [-1.25531489e-02 -1.64171450e+01]
Stock Position:  -0.012553148924651104
Bond Position:  [10.86867654]


portfolio before change:  [9.5398675]
curr_Stock_Price:  106.07111899852777
curr_Factors:  [1.06071119e+02 3.55212125e-02]
mat_Sqrt:  [[ 1.99913002e+01  0.00000000e+00]
 [-7.53882882e-03  1.72736269e-02]]
grads:  [ 1.18183798e-02 -2.17564680e+01]
Stock Position:  0.011818379827373313
Bond Position:  [8.28627872]


portfolio before change:  [9.51404051]
curr_Stock_Price:  103.71048924046542
curr_Factors:  [1.03710489e+02 3.82345982e-02]
mat_Sqrt:  [[ 2.02792061e+01  0.00000000e+00]
 [-7.82146771e-03  1.79212339e-02]]
grads:  [-0.00683849 -4.11525057]
Stock Position:  -0.006838489815868339
Bond Position:  [10.22326363]


portfolio before change:  [9.53378554]
curr_Stock_Price:  101.19693691630172
curr_Factors:  [1.01196937e+02 3.87597354e-02]
mat_Sqrt:  [[ 1.99231392e+01  0.00000000e+00]
 [-7.87499693e-03  1.80438848e-02]]
grads:  [ 9.73604238e-03 -3.00507244e+01]
Stock Position:  0.00973604238112356
Bond Position:  [8.54852788]


portfolio before change:  [9.54428304]
curr_Stock_Price:  102.05561226383712
curr_Factors:  [1.02055612e+02 3.82212830e-02]
mat_Sqrt:  [[ 1.99521418e+01  0.00000000e+00]
 [-7.82010567e-03  1.79181131e-02]]
grads:  [-1.98341418e-02  2.00054348e+01]
Stock Position:  -0.019834141807016616
Bond Position:  [11.56846853]


portfolio before change:  [9.56440797]
curr_Stock_Price:  101.18678474838676
curr_Factors:  [1.01186785e+02 3.48879976e-02]
mat_Sqrt:  [[ 1.89000006e+01  0.00000000e+00]
 [-7.47133162e-03  1.71189713e-02]]
grads:  [0.01463569 8.72124625]
Stock Position:  0.014635686859934433
Bond Position:  [8.08346987]


portfolio before change:  [9.560953]
curr_Stock_Price:  100.81262473937595
curr_Factors:  [1.00812625e+02 3.67085108e-02]
mat_Sqrt:  [[ 1.93151598e+01  0.00000000e+00]
 [-7.66378609e-03  1.75599399e-02]]
grads:  [-0.01126477 -3.02671372]
Stock Position:  -0.011264771975916512
Bond Position:  [10.69658423]


portfolio before change:  [9.54898997]
curr_Stock_Price:  102.11203064077075
curr_Factors:  [1.02112031e+02 3.44675207e-02]
mat_Sqrt:  [[ 1.89575380e+01  0.00000000e+00]
 [-7.42617217e-03  1.70154980e-02]]
grads:  [0.01278642 0.66039389]
Stock Position:  0.012786417384425508
Bond Position:  [8.24334293]


portfolio before change:  [9.53768303]
curr_Stock_Price:  101.06654394783033
curr_Factors:  [1.01066544e+02 3.46976745e-02]
mat_Sqrt:  [[ 1.88259803e+01  0.00000000e+00]
 [-7.45092473e-03  1.70722133e-02]]
grads:  [1.04063212e-02 1.07467797e+01]
Stock Position:  0.010406321217063934
Bond Position:  [8.48595211]


portfolio before change:  [9.54285007]
curr_Stock_Price:  101.35918207194784
curr_Factors:  [1.01359182e+02 3.52679018e-02]
mat_Sqrt:  [[ 1.90350012e+01  0.00000000e+00]
 [-7.51190008e-03  1.72119254e-02]]
grads:  [-0.01040804  5.26852814]
Stock Position:  -0.010408038843136708
Bond Position:  [10.59780038]


portfolio before change:  [9.54472613]
curr_Stock_Price:  101.43352117667943
curr_Factors:  [1.01433521e+02 3.45389524e-02]
mat_Sqrt:  [[ 1.88510733e+01  0.00000000e+00]
 [-7.43386332e-03  1.70331207e-02]]
grads:  [3.52367869e-04 2.31112687e+00]
Stock Position:  0.00035236786938934927
Bond Position:  [9.50898422]


portfolio before change:  [9.54682403]
curr_Stock_Price:  100.63989940747784
curr_Factors:  [1.00639899e+02 3.32000265e-02]
mat_Sqrt:  [[ 1.83374697e+01  0.00000000e+00]
 [-7.28834977e-03  1.66997073e-02]]
grads:  [ -0.01928781 -16.41372693]
Stock Position:  -0.019287807940614344
Bond Position:  [11.48794708]


portfolio before change:  [9.54198224]
curr_Stock_Price:  101.03984817244012
curr_Factors:  [1.01039848e+02 3.19803836e-02]
mat_Sqrt:  [[ 1.80690167e+01  0.00000000e+00]
 [-7.15322401e-03  1.63900952e-02]]
grads:  [-2.18179312e-03 -5.08511396e+00]
Stock Position:  -0.0021817931182497507
Bond Position:  [9.76243028]


portfolio before change:  [9.53868738]
curr_Stock_Price:  103.6687727485103
curr_Factors:  [1.03668773e+02 3.13913818e-02]
mat_Sqrt:  [[ 1.83676322e+01  0.00000000e+00]
 [-7.08704529e-03  1.62384607e-02]]
grads:  [0.00522636 1.07960083]
Stock Position:  0.0052263639219634825
Bond Position:  [8.99687665]


portfolio before change:  [9.53760289]
curr_Stock_Price:  103.0308541260739
curr_Factors:  [1.03030854e+02 3.17299114e-02]
mat_Sqrt:  [[ 1.83527746e+01  0.00000000e+00]
 [-7.12515671e-03  1.63257850e-02]]
grads:  [-1.81978061e-03  2.59495119e+00]
Stock Position:  -0.0018197806115556466
Bond Position:  [9.72509644]


portfolio before change:  [9.54236473]
curr_Stock_Price:  101.75033610976818
curr_Factors:  [1.01750336e+02 3.21170568e-02]
mat_Sqrt:  [[ 1.82349141e+01  0.00000000e+00]
 [-7.16849293e-03  1.64250807e-02]]
grads:  [  0.01629767 -14.38925477]
Stock Position:  0.016297670270855238
Bond Position:  [7.8840713]


portfolio before change:  [9.55642758]
curr_Stock_Price:  102.49225732337817
curr_Factors:  [1.02492257e+02 2.88592125e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.55642758]
Stock Price:  102.01442281269705
PL:  [7.54200477]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-3.72212528e-02  1.75098241e-01]
 [ 2.80218909e-01  8.11514078e-02]
 [-1.21118301e-01 -2.86982417e-01]
 [ 3.00214002e-01 -2.08245729e-01]
 [-1.69926235e-01 -8.43038697e-02]
 [ 6.75956785e-01 -9.22163449e-01]
 [-5.93721753e-01  4.75288138e-01]
 [ 3.82994000e-01  1.62772990e-01]
 [ 1.10416406e-01 -1.12572827e-01]
 [-1.64077327e-02  2.50768089e-02]
 [ 3.22297609e-01  4.88674214e-01]
 [-2.04396806e-01  1.30653155e-01]
 [-2.73412977e-01  2.50955700e-01]
 [-1.52874553e-01  2.61181672e-01]
 [ 2.44033533e-01  2.83107438e-01]
 [ 7.12983918e-02  3.37609153e-02]
 [-5.39896569e-02  3.55178597e-01]
 [ 1.77190138e-01  1.88474968e-01]
 [-2.67358356e-02 -2.58856928e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.49227135]
curr_Stock_Price:  100.99853872755642
curr_Factors:  [1.00998539e+02 3.97047875e-02]
mat_Sqrt:  [[ 2.01250296e+01  0.00000000e+00]
 [-7.97042408e-03  1.82625358e-02]]
grads:  [1.94771810e-03 9.58783832e+00]
Stock Position:  0.0019477181046558096
Bond Position:  [9.29555467]


portfolio before change:  [9.50131688]
curr_Stock_Price:  104.44942324920717
curr_Factors:  [1.04449423e+02 3.99521758e-02]
mat_Sqrt:  [[ 2.08773929e+01  0.00000000e+00]
 [-7.99521615e-03  1.83193416e-02]]
grads:  [0.01511857 4.4298212 ]
Stock Position:  0.015118568161042555
Bond Position:  [7.92219116]


portfolio before change:  [9.48149533]
curr_Stock_Price:  103.00733254807339
curr_Factors:  [1.03007333e+02 3.87301545e-02]
mat_Sqrt:  [[ 2.02718207e+01  0.00000000e+00]
 [-7.87199131e-03  1.80369980e-02]]
grads:  [-1.21532101e-02 -1.59107639e+01]
Stock Position:  -0.012153210121825268
Bond Position:  [10.73336509]


portfolio before change:  [9.47268607]
curr_Stock_Price:  103.95300321892485
curr_Factors:  [1.03953003e+02 3.59798749e-02]
mat_Sqrt:  [[ 1.97181817e+01  0.00000000e+00]
 [-7.58734472e-03  1.73847907e-02]]
grads:  [ 1.06159948e-02 -1.19786158e+01]
Stock Position:  0.010615994770902278
Bond Position:  [8.36912153]


portfolio before change:  [9.4580646]
curr_Stock_Price:  102.37858459344098
curr_Factors:  [1.02378585e+02 3.47729009e-02]
mat_Sqrt:  [[ 1.90910398e+01  0.00000000e+00]
 [-7.45899735e-03  1.70907100e-02]]
grads:  [-0.01082809 -4.9327307 ]
Stock Position:  -0.010828088070287196
Bond Position:  [10.56662893]


portfolio before change:  [9.44265997]
curr_Stock_Price:  104.04523260856777
curr_Factors:  [1.04045233e+02 3.67830893e-02]
mat_Sqrt:  [[ 1.99547498e+01  0.00000000e+00]
 [-7.67156718e-03  1.75777686e-02]]
grads:  [ 1.37055921e-02 -5.24619175e+01]
Stock Position:  0.013705592101217808
Bond Position:  [8.01665845]


portfolio before change:  [9.44183168]
curr_Stock_Price:  103.83854992093016
curr_Factors:  [1.03838550e+02 3.74055228e-02]
mat_Sqrt:  [[ 2.00829025e+01  0.00000000e+00]
 [-7.73620297e-03  1.77258679e-02]]
grads:  [-1.92347199e-02  2.68132507e+01]
Stock Position:  -0.019234719892463035
Bond Position:  [11.4391371]


portfolio before change:  [9.46253011]
curr_Stock_Price:  102.91114938140714
curr_Factors:  [1.02911149e+02 3.94113947e-02]
mat_Sqrt:  [[ 2.04302335e+01  0.00000000e+00]
 [-7.94092133e-03  1.81949365e-02]]
grads:  [0.02222363 8.94605976]
Stock Position:  0.022223630321716478
Bond Position:  [7.17547077]


portfolio before change:  [9.50360741]
curr_Stock_Price:  104.67878172685417
curr_Factors:  [1.04678782e+02 3.88240120e-02]
mat_Sqrt:  [[ 2.06257080e+01  0.00000000e+00]
 [-7.88152392e-03  1.80588400e-02]]
grads:  [ 2.97132082e-03 -6.23366881e+00]
Stock Position:  0.00297132082450783
Bond Position:  [9.19257317]


portfolio before change:  [9.51127905]
curr_Stock_Price:  106.48713781782531
curr_Factors:  [1.06487138e+02 3.72438323e-02]
mat_Sqrt:  [[ 2.05505919e+01  0.00000000e+00]
 [-7.71946447e-03  1.76875151e-02]]
grads:  [-2.65847138e-04  1.41776890e+00]
Stock Position:  -0.0002658471379136729
Bond Position:  [9.53958835]


portfolio before change:  [9.51331327]
curr_Stock_Price:  107.8073505723435
curr_Factors:  [1.07807351e+02 3.81822218e-02]
mat_Sqrt:  [[ 2.10658492e+01  0.00000000e+00]
 [-7.81610868e-03  1.79089548e-02]]
grads:  [2.54237328e-02 2.72865848e+01]
Stock Position:  0.025423732796688494
Bond Position:  [6.77244799]


portfolio before change:  [9.60184735]
curr_Stock_Price:  111.22308674776667
curr_Factors:  [1.11223087e+02 3.74968359e-02]
mat_Sqrt:  [[ 2.15373495e+01  0.00000000e+00]
 [-7.74563990e-03  1.77474906e-02]]
grads:  [-6.84276841e-03  7.36178190e+00]
Stock Position:  -0.006842768410642527
Bond Position:  [10.36292118]


portfolio before change:  [9.5892237]
curr_Stock_Price:  113.44655874266715
curr_Factors:  [1.13446559e+02 3.66352901e-02]
mat_Sqrt:  [[ 2.17140655e+01  0.00000000e+00]
 [-7.65613899e-03  1.75424182e-02]]
grads:  [-7.54750096e-03  1.43056503e+01]
Stock Position:  -0.007547500957757836
Bond Position:  [10.44546171]


portfolio before change:  [9.60282321]
curr_Stock_Price:  111.99073688423407
curr_Factors:  [1.11990737e+02 3.67862320e-02]
mat_Sqrt:  [[ 2.14795291e+01  0.00000000e+00]
 [-7.67189489e-03  1.75785195e-02]]
grads:  [-1.81035281e-03  1.48580016e+01]
Stock Position:  -0.001810352809933553
Bond Position:  [9.80556596]


portfolio before change:  [9.61162407]
curr_Stock_Price:  108.48360014874157
curr_Factors:  [1.08483600e+02 3.87157338e-02]
mat_Sqrt:  [[ 2.13455739e+01  0.00000000e+00]
 [-7.87052565e-03  1.80336398e-02]]
grads:  [ 0.01722098 15.69885177]
Stock Position:  0.0172209821808541
Bond Position:  [7.74342992]


portfolio before change:  [9.62253949]
curr_Stock_Price:  109.00501759670699
curr_Factors:  [1.09005018e+02 3.92629803e-02]
mat_Sqrt:  [[ 2.15992226e+01  0.00000000e+00]
 [-7.92595537e-03  1.81606452e-02]]
grads:  [0.00398315 1.85901519]
Stock Position:  0.003983146280798503
Bond Position:  [9.18835656]


portfolio before change:  [9.63190766]
curr_Stock_Price:  110.78019551999284
curr_Factors:  [1.10780196e+02 3.92094007e-02]
mat_Sqrt:  [[ 2.19359895e+01  0.00000000e+00]
 [-7.92054551e-03  1.81482497e-02]]
grads:  [4.60535374e-03 1.95709561e+01]
Stock Position:  0.004605353740485589
Bond Position:  [9.12172567]


portfolio before change:  [9.64034975]
curr_Stock_Price:  112.1180683912478
curr_Factors:  [1.12118068e+02 3.88531197e-02]
mat_Sqrt:  [[ 2.20998108e+01  0.00000000e+00]
 [-7.88447788e-03  1.80656084e-02]]
grads:  [ 0.0117398  10.43280493]
Stock Position:  0.011739799963466616
Bond Position:  [8.32410605]


portfolio before change:  [9.6342415]
curr_Stock_Price:  111.42048137376668
curr_Factors:  [1.11420481e+02 3.99257882e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.6342415]
Stock Price:  108.73316971368395
PL:  [0.90107179]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.09891987e-02  3.95874374e-03]
 [ 1.40179928e-01 -2.42614822e-02]
 [-1.39007152e-01 -4.09035501e-01]
 [ 3.27461939e-01 -2.53872872e-01]
 [-1.70040187e-01 -8.42283116e-02]
 [ 6.47438696e-01 -8.78049245e-01]
 [-6.29332091e-01  6.16509862e-01]
 [ 6.64198107e-01  1.84861326e-01]
 [ 1.63416561e-01 -1.42937660e-01]
 [ 3.39748200e-02  2.23443612e-02]
 [ 2.90216723e-01  4.37457647e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.36525619e-02  5.90561831e-02]
 [-2.96578821e-01 -2.49452243e-01]
 [ 8.94104402e-02 -4.32938041e-02]
 [ 9.00325005e-02  1.26395258e-02]
 [-5.19502736e-02  1.17264971e-02]
 [ 3.71196476e-01 -2.27876851e-01]
 [ 2.13840476e-01  1.26791548e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.13029623]
curr_Stock_Price:  99.63961723718498
curr_Factors:  [9.96396172e+01 4.12231593e-02]
mat_Sqrt:  [[ 2.02303170e+01  0.00000000e+00]
 [-8.12139489e-03  1.86084534e-02]]
grads:  [-0.00095211  0.212739  ]
Stock Position:  -0.0009521087230190924
Bond Position:  [0.22516398]


portfolio before change:  [0.12749951]
curr_Stock_Price:  102.63614369595469
curr_Factors:  [1.02636144e+02 3.99551296e-02]
mat_Sqrt:  [[ 2.05157122e+01  0.00000000e+00]
 [-7.99551170e-03  1.83200188e-02]]
grads:  [ 0.00631669 -1.32431536]
Stock Position:  0.0063166878222564145
Bond Position:  [-0.52082097]


portfolio before change:  [0.1233537]
curr_Stock_Price:  102.0004322235643
curr_Factors:  [1.02000432e+02 3.94923219e-02]
mat_Sqrt:  [[ 2.02702146e+01  0.00000000e+00]
 [-7.94907008e-03  1.82136077e-02]]
grads:  [-1.56646038e-02 -2.24576871e+01]
Stock Position:  -0.015664603790196067
Bond Position:  [1.72115006]


portfolio before change:  [0.0841767]
curr_Stock_Price:  104.52889299162416
curr_Factors:  [1.04528893e+02 3.93623908e-02]
mat_Sqrt:  [[ 2.07384878e+01  0.00000000e+00]
 [-7.93598294e-03  1.81836213e-02]]
grads:  [ 1.04473738e-02 -1.39616234e+01]
Stock Position:  0.010447373816211188
Bond Position:  [-1.00787572]


portfolio before change:  [0.06143614]
curr_Stock_Price:  102.37633636896787
curr_Factors:  [1.02376336e+02 4.05526987e-02]
mat_Sqrt:  [[ 2.06162401e+01  0.00000000e+00]
 [-8.05508025e-03  1.84565075e-02]]
grads:  [-0.01003095 -4.56361051]
Stock Position:  -0.010030948128352962
Bond Position:  [1.08836786]


portfolio before change:  [0.04828967]
curr_Stock_Price:  103.71405613699324
curr_Factors:  [1.03714056e+02 3.90721574e-02]
mat_Sqrt:  [[ 2.05008239e+01  0.00000000e+00]
 [-7.90667135e-03  1.81164600e-02]]
grads:  [ 1.28885839e-02 -4.84669326e+01]
Stock Position:  0.012888583891107945
Bond Position:  [-1.28843765]


portfolio before change:  [0.07674185]
curr_Stock_Price:  105.94660035912777
curr_Factors:  [1.05946600e+02 3.65801002e-02]
mat_Sqrt:  [[ 2.02632672e+01  0.00000000e+00]
 [-7.65036994e-03  1.75291997e-02]]
grads:  [-1.77792221e-02  3.51704512e+01]
Stock Position:  -0.01777922214406874
Bond Position:  [1.96038999]


portfolio before change:  [0.08117325]
curr_Stock_Price:  105.7249234883802
curr_Factors:  [1.05724923e+02 3.70479348e-02]
mat_Sqrt:  [[ 2.03497642e+01  0.00000000e+00]
 [-7.69913603e-03  1.76409368e-02]]
grads:  [ 0.03660378 10.47911047]
Stock Position:  0.03660377571474209
Bond Position:  [-3.78875813]


portfolio before change:  [0.0744031]
curr_Stock_Price:  105.56584569414113
curr_Factors:  [1.05565846e+02 3.46848793e-02]
mat_Sqrt:  [[ 1.96604532e+01  0.00000000e+00]
 [-7.44955079e-03  1.70690652e-02]]
grads:  [ 5.13891776e-03 -8.37407663e+00]
Stock Position:  0.005138917760919375
Bond Position:  [-0.4680911]


portfolio before change:  [0.07454041]
curr_Stock_Price:  105.61534163938637
curr_Factors:  [1.05615342e+02 3.55025150e-02]
mat_Sqrt:  [[ 1.99001600e+01  0.00000000e+00]
 [-7.53684443e-03  1.72690801e-02]]
grads:  [0.0021973  1.29389412]
Stock Position:  0.0021973038779303415
Bond Position:  [-0.15752858]


portfolio before change:  [0.07698671]
curr_Stock_Price:  106.7465828608142
curr_Factors:  [1.06746583e+02 3.24276809e-02]
mat_Sqrt:  [[ 1.92225911e+01  0.00000000e+00]
 [-7.20307500e-03  1.65043182e-02]]
grads:  [2.50298667e-02 2.65056479e+01]
Stock Position:  0.02502986670877257
Bond Position:  [-2.59486603]


portfolio before change:  [0.0179823]
curr_Stock_Price:  104.41514375917738
curr_Factors:  [1.04415144e+02 3.23581440e-02]
mat_Sqrt:  [[ 1.87825819e+01  0.00000000e+00]
 [-7.19534783e-03  1.64866130e-02]]
grads:  [-0.01006294  6.93490674]
Stock Position:  -0.010062938334729075
Bond Position:  [1.06870545]


portfolio before change:  [0.03363461]
curr_Stock_Price:  102.88625605691487
curr_Factors:  [1.02886256e+02 3.47026250e-02]
mat_Sqrt:  [[ 1.91663108e+01  0.00000000e+00]
 [-7.45145623e-03  1.70734311e-02]]
grads:  [6.32446670e-04 3.45895226e+00]
Stock Position:  0.0006324466696466423
Bond Position:  [-0.03143546]


portfolio before change:  [0.03378234]
curr_Stock_Price:  103.13225753186806
curr_Factors:  [1.03132258e+02 3.41049890e-02]
mat_Sqrt:  [[ 1.90459869e+01  0.00000000e+00]
 [-7.38701444e-03  1.69257764e-02]]
grads:  [ -0.02128788 -14.73800888]
Stock Position:  -0.02128788113144399
Bond Position:  [2.22924958]


portfolio before change:  [0.05812489]
curr_Stock_Price:  102.01494700302484
curr_Factors:  [1.02014947e+02 3.46743871e-02]
mat_Sqrt:  [[ 1.89962644e+01  0.00000000e+00]
 [-7.44842395e-03  1.70664833e-02]]
grads:  [ 0.00371207 -2.53677359]
Stock Position:  0.0037120706283211395
Bond Position:  [-0.3205618]


portfolio before change:  [0.05579114]
curr_Stock_Price:  101.40784663629832
curr_Factors:  [1.01407847e+02 3.71008459e-02]
mat_Sqrt:  [[ 1.95327534e+01  0.00000000e+00]
 [-7.70463195e-03  1.76535296e-02]]
grads:  [0.00489172 0.71597726]
Stock Position:  0.004891724166434191
Bond Position:  [-0.44026807]


portfolio before change:  [0.05991739]
curr_Stock_Price:  102.27386529153199
curr_Factors:  [1.02273865e+02 3.56528253e-02]
mat_Sqrt:  [[ 1.93113060e+01  0.00000000e+00]
 [-7.55278230e-03  1.73055983e-02]]
grads:  [-0.00242513  0.67761293]
Stock Position:  -0.0024251291263550122
Bond Position:  [0.30794472]


portfolio before change:  [0.06017152]
curr_Stock_Price:  102.20082438548222
curr_Factors:  [1.02200824e+02 3.81303370e-02]
mat_Sqrt:  [[ 1.99567456e+01  0.00000000e+00]
 [-7.81079633e-03  1.78967827e-02]]
grads:  [  0.01361659 -12.73283893]
Stock Position:  0.013616592090461456
Bond Position:  [-1.33145542]


portfolio before change:  [0.02250408]
curr_Stock_Price:  99.4589835226959
curr_Factors:  [9.94589835e+01 3.98609872e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.02250408]
Stock Price:  98.86177188221359
PL:  [0.02250408]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.02221694e-01 -8.40339319e-01]
 [ 3.92382340e-03  2.62011257e-01]
 [-4.66177408e-01 -1.25668509e-01]
 [ 1.18010324e-01 -1.03489287e-01]
 [-3.81211548e-01  1.51271314e-01]
 [ 1.35788722e-01  1.43355231e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.49125118e-01  5.15723420e-03]
 [-9.84741728e-02 -2.61157655e-02]
 [-2.36339700e-01  6.42882527e-02]
 [-1.23025342e-01  2.87398681e-02]
 [-8.90638375e-02 -2.15701399e-01]
 [-2.15102974e-01 -1.33117041e-01]
 [ 8.77435313e-02  2.44042148e-02]
 [ 6.00101880e-02 -8.37448544e-02]
 [ 7.97978844e-01 -3.77980919e-01]
 [ 1.71291198e-01  1.44646747e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.36486821]
curr_Stock_Price:  97.82590300892433
curr_Factors:  [9.78259030e+01 4.17223963e-02]
mat_Sqrt:  [[ 1.99819785e+01  0.00000000e+00]
 [-8.17042435e-03  1.87207940e-02]]
grads:  [ 0.00139484 -0.07215689]
Stock Position:  0.0013948357320498106
Bond Position:  [-12.50131927]


portfolio before change:  [-12.36925784]
curr_Stock_Price:  96.91976558804294
curr_Factors:  [9.69197656e+01 4.27358841e-02]
mat_Sqrt:  [[ 2.00358929e+01  0.00000000e+00]
 [-8.26906371e-03  1.89468052e-02]]
grads:  [-0.00929955 -3.51784744]
Stock Position:  -0.009299554112363188
Bond Position:  [-11.46794724]


portfolio before change:  [-12.38745097]
curr_Stock_Price:  98.56777825626845
curr_Factors:  [9.85677783e+01 4.46550496e-02]
mat_Sqrt:  [[ 2.08290880e+01  0.00000000e+00]
 [-8.45269657e-03  1.93675609e-02]]
grads:  [-2.73164067e-02 -4.33890112e+01]
Stock Position:  -0.027316406706577423
Bond Position:  [-9.69493345]


portfolio before change:  [-12.41058918]
curr_Stock_Price:  99.32608334039418
curr_Factors:  [9.93260833e+01 4.34750778e-02]
mat_Sqrt:  [[ 2.07101619e+01  0.00000000e+00]
 [-8.34027124e-03  1.91099621e-02]]
grads:  [5.71096023e-03 1.37107157e+01]
Stock Position:  0.005710960228373127
Bond Position:  [-12.97783649]


portfolio before change:  [-12.41523541]
curr_Stock_Price:  99.08070135626656
curr_Factors:  [9.90807014e+01 4.32059828e-02]
mat_Sqrt:  [[ 2.05949630e+01  0.00000000e+00]
 [-8.31441955e-03  1.90507285e-02]]
grads:  [-0.0252986  -6.59651988]
Stock Position:  -0.025298595647719097
Bond Position:  [-9.90863281]


portfolio before change:  [-12.40184146]
curr_Stock_Price:  98.45333793696528
curr_Factors:  [9.84533379e+01 4.27400734e-02]
mat_Sqrt:  [[ 2.03539206e+01  0.00000000e+00]
 [-8.26946899e-03  1.89477338e-02]]
grads:  [ 3.57886313e-03 -5.46182925e+00]
Stock Position:  0.003578863127807609
Bond Position:  [-12.75419248]


portfolio before change:  [-12.40604659]
curr_Stock_Price:  98.16939703099672
curr_Factors:  [9.81693970e+01 4.15197198e-02]
mat_Sqrt:  [[ 2.00033775e+01  0.00000000e+00]
 [-8.15055530e-03  1.86752683e-02]]
grads:  [-0.01575691  8.10008788]
Stock Position:  -0.0157569057462391
Bond Position:  [-10.85920066]


portfolio before change:  [-12.44450395]
curr_Stock_Price:  100.43774975094163
curr_Factors:  [1.00437750e+02 4.16221694e-02]
mat_Sqrt:  [[ 2.04908196e+01  0.00000000e+00]
 [-8.16060482e-03  1.86982946e-02]]
grads:  [0.00968014 7.66675433]
Stock Position:  0.009680143519245097
Bond Position:  [-13.41675579]


portfolio before change:  [-12.45749375]
curr_Stock_Price:  99.44239428960194
curr_Factors:  [9.94423943e+01 4.20657005e-02]
mat_Sqrt:  [[ 2.03955600e+01  0.00000000e+00]
 [-8.20396982e-03  1.87976563e-02]]
grads:  [-0.01066805 -2.82742222]
Stock Position:  -0.010668050804848533
Bond Position:  [-11.39663723]


portfolio before change:  [-12.4531547]
curr_Stock_Price:  98.76855391177192
curr_Factors:  [9.87685539e+01 4.06239559e-02]
mat_Sqrt:  [[ 1.99071826e+01  0.00000000e+00]
 [-8.06215414e-03  1.84727158e-02]]
grads:  [0.0126274  0.27918116]
Stock Position:  0.012627398040351014
Bond Position:  [-13.70034454]


portfolio before change:  [-12.4834881]
curr_Stock_Price:  96.6376409661668
curr_Factors:  [9.66376410e+01 4.26652378e-02]
mat_Sqrt:  [[ 1.99610510e+01  0.00000000e+00]
 [-8.26222613e-03  1.89311383e-02]]
grads:  [-0.00550432 -1.37951374]
Stock Position:  -0.0055043207431477535
Bond Position:  [-11.95156353]


portfolio before change:  [-12.49540807]
curr_Stock_Price:  98.26031390545396
curr_Factors:  [9.82603139e+01 4.05402912e-02]
mat_Sqrt:  [[ 1.97843406e+01  0.00000000e+00]
 [-8.05384789e-03  1.84536838e-02]]
grads:  [-0.01052762  3.48376256]
Stock Position:  -0.010527619319726789
Bond Position:  [-11.4609609]


portfolio before change:  [-12.48361204]
curr_Stock_Price:  96.86763094991501
curr_Factors:  [9.68676309e+01 4.22241573e-02]
mat_Sqrt:  [[ 1.99048621e+01  0.00000000e+00]
 [-8.21940702e-03  1.88330274e-02]]
grads:  [-0.00555051  1.52603548]
Stock Position:  -0.005550514966577666
Bond Position:  [-11.9459468]


portfolio before change:  [-12.48705105]
curr_Stock_Price:  96.94909165042245
curr_Factors:  [9.69490917e+01 4.20175840e-02]
mat_Sqrt:  [[ 1.98728101e+01  0.00000000e+00]
 [-8.19927646e-03  1.87869025e-02]]
grads:  [-9.21880926e-03 -1.14814775e+01]
Stock Position:  -0.00921880925866974
Bond Position:  [-11.59329586]


portfolio before change:  [-12.47486391]
curr_Stock_Price:  95.31267358369651
curr_Factors:  [9.53126736e+01 4.23251421e-02]
mat_Sqrt:  [[ 1.96087480e+01  0.00000000e+00]
 [-8.22923006e-03  1.88555348e-02]]
grads:  [-0.01393256 -7.05983906]
Stock Position:  -0.01393255777855391
Bond Position:  [-11.14691457]


portfolio before change:  [-12.45824645]
curr_Stock_Price:  93.91992645754952
curr_Factors:  [9.39199265e+01 4.27618608e-02]
mat_Sqrt:  [[ 1.94216463e+01  0.00000000e+00]
 [-8.27157647e-03  1.89525626e-02]]
grads:  [0.00506622 1.28764723]
Stock Position:  0.005066223641870313
Bond Position:  [-12.93406581]


portfolio before change:  [-12.45283197]
curr_Stock_Price:  95.62699824389082
curr_Factors:  [9.56269982e+01 4.31929214e-02]
mat_Sqrt:  [[ 1.98740699e+01  0.00000000e+00]
 [-8.31316271e-03  1.90478487e-02]]
grads:  [ 1.18047975e-03 -4.39655185e+00]
Stock Position:  0.0011804797515061424
Bond Position:  [-12.5657177]


portfolio before change:  [-12.45498405]
curr_Stock_Price:  96.4654162546535
curr_Factors:  [9.64654163e+01 4.20239134e-02]
mat_Sqrt:  [[ 1.97751547e+01  0.00000000e+00]
 [-8.19989399e-03  1.87883175e-02]]
grads:  [  0.03201059 -20.11786953]
Stock Position:  0.03201059393560011
Bond Position:  [-15.54289932]


portfolio before change:  [-12.44351459]
curr_Stock_Price:  96.94512230444457
curr_Factors:  [9.69451223e+01 4.34942397e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.44351459]
Stock Price:  96.0058630742312
PL:  [-12.44351459]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-8.04203007e-02  1.10180558e-01]
 [ 1.59333894e-01 -2.32188129e-02]
 [-1.01693510e-01 -1.54449836e-01]
 [ 3.58192424e-01 -3.05331601e-01]
 [-8.49786199e-02 -6.75367797e-02]
 [ 7.07970964e-01 -9.71696830e-01]
 [-6.47114700e-01  6.80210789e-01]
 [ 1.00049048e+00  2.11276797e-01]
 [ 2.56897572e-01 -1.94302170e-01]
 [-2.11692332e-01  3.55538423e-02]
 [ 4.42254336e-01  6.80183003e-01]
 [-2.17131952e-01  1.24630650e-01]
 [-1.61345138e-01  1.68164932e-01]
 [-1.63931674e-01  2.23309369e-01]
 [ 2.58762576e-01  3.46026478e-01]
 [ 4.43591329e-02  5.94098178e-02]
 [-5.37821729e-02  3.65204690e-01]
 [ 1.10988855e-01  1.24146844e-01]
 [ 3.35258442e-03 -1.31296333e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.40000495]
curr_Stock_Price:  100.54968608603522
curr_Factors:  [1.00549686e+02 3.96570561e-02]
mat_Sqrt:  [[ 2.00235444e+01  0.00000000e+00]
 [-7.96563178e-03  1.82515553e-02]]
grads:  [-1.61477720e-03  6.03677636e+00]
Stock Position:  -0.001614777203603285
Bond Position:  [6.5623703]


portfolio before change:  [6.39779336]
curr_Stock_Price:  102.93539650296093
curr_Factors:  [1.02935397e+02 3.84053675e-02]
mat_Sqrt:  [[ 2.01725455e+01  0.00000000e+00]
 [-7.83891497e-03  1.79612106e-02]]
grads:  [ 0.00739621 -1.29271982]
Stock Position:  0.007396209528900075
Bond Position:  [5.6364616]


portfolio before change:  [6.40779934]
curr_Stock_Price:  104.09770702275989
curr_Factors:  [1.04097707e+02 3.73749545e-02]
mat_Sqrt:  [[ 2.01247966e+01  0.00000000e+00]
 [-7.73304127e-03  1.77186235e-02]]
grads:  [-8.40261635e-03 -8.71680781e+00]
Stock Position:  -0.008402616347211591
Bond Position:  [7.28249244]


portfolio before change:  [6.40052649]
curr_Stock_Price:  105.17995398662308
curr_Factors:  [1.05179954e+02 3.67472676e-02]
mat_Sqrt:  [[ 2.01625521e+01  0.00000000e+00]
 [-7.66783073e-03  1.75692074e-02]]
grads:  [ 1.11560673e-02 -1.73787920e+01]
Stock Position:  0.011156067349652932
Bond Position:  [5.22713184]


portfolio before change:  [6.39616881]
curr_Stock_Price:  104.67219206080604
curr_Factors:  [1.04672192e+02 3.75293478e-02]
mat_Sqrt:  [[ 2.02776129e+01  0.00000000e+00]
 [-7.74899713e-03  1.77551830e-02]]
grads:  [-0.00564436 -3.8037783 ]
Stock Position:  -0.005644357038974606
Bond Position:  [6.98697603]


portfolio before change:  [6.39940049]
curr_Stock_Price:  104.40914695340014
curr_Factors:  [1.04409147e+02 3.65624042e-02]
mat_Sqrt:  [[ 1.99643843e+01  0.00000000e+00]
 [-7.64851925e-03  1.75249592e-02]]
grads:  [ 1.42197073e-02 -5.54464531e+01]
Stock Position:  0.014219707254538645
Bond Position:  [4.91473299]


portfolio before change:  [6.435795]
curr_Stock_Price:  106.88217075054601
curr_Factors:  [1.06882171e+02 3.76610142e-02]
mat_Sqrt:  [[ 2.07420306e+01  0.00000000e+00]
 [-7.76257836e-03  1.77863015e-02]]
grads:  [-1.68858286e-02  3.82435208e+01]
Stock Position:  -0.01688582858515636
Bond Position:  [8.24058902]


portfolio before change:  [6.4005784]
curr_Stock_Price:  109.08976190050777
curr_Factors:  [1.09089762e+02 3.41025808e-02]
mat_Sqrt:  [[ 2.01454799e+01  0.00000000e+00]
 [-7.38675364e-03  1.69251788e-02]]
grads:  [ 0.05424042 12.48298756]
Stock Position:  0.05424041710021164
Bond Position:  [0.48350422]


portfolio before change:  [6.29419631]
curr_Stock_Price:  107.12622640613448
curr_Factors:  [1.07126226e+02 3.41072883e-02]
mat_Sqrt:  [[ 1.97842414e+01  0.00000000e+00]
 [-7.38726345e-03  1.69263470e-02]]
grads:  [ 8.69869855e-03 -1.14792737e+01]
Stock Position:  0.008698698552223745
Bond Position:  [5.36233756]


portfolio before change:  [6.32205295]
curr_Stock_Price:  110.17448560113289
curr_Factors:  [1.10174486e+02 3.42641262e-02]
mat_Sqrt:  [[ 2.03939271e+01  0.00000000e+00]
 [-7.40422865e-03  1.69652191e-02]]
grads:  [-0.0096193   2.09569013]
Stock Position:  -0.009619302949501002
Bond Position:  [7.3818547]


portfolio before change:  [6.31004155]
curr_Stock_Price:  111.61503584389139
curr_Factors:  [1.11615036e+02 3.28336231e-02]
mat_Sqrt:  [[ 2.02247009e+01  0.00000000e+00]
 [-7.24802022e-03  1.66073006e-02]]
grads:  [3.65449427e-02 4.09568669e+01]
Stock Position:  0.0365449426995605
Bond Position:  [2.23107647]


portfolio before change:  [6.27488763]
curr_Stock_Price:  110.63783446514852
curr_Factors:  [1.10637834e+02 3.29084276e-02]
mat_Sqrt:  [[ 2.00704557e+01  0.00000000e+00]
 [-7.25627206e-03  1.66262080e-02]]
grads:  [-0.00810837  7.49603581]
Stock Position:  -0.008108369820796631
Bond Position:  [7.1719801]


portfolio before change:  [6.28258368]
curr_Stock_Price:  109.90984175837413
curr_Factors:  [1.09909842e+02 3.38149275e-02]
mat_Sqrt:  [[ 2.02111401e+01  0.00000000e+00]
 [-7.35553425e-03  1.68536462e-02]]
grads:  [-4.35165677e-03  9.97795551e+00]
Stock Position:  -0.004351656768005981
Bond Position:  [6.76087359]


portfolio before change:  [6.27763117]
curr_Stock_Price:  111.43637253130277
curr_Factors:  [1.11436373e+02 3.37348385e-02]
mat_Sqrt:  [[ 2.04675700e+01  0.00000000e+00]
 [-7.34681847e-03  1.68336759e-02]]
grads:  [-3.24764864e-03  1.32656331e+01]
Stock Position:  -0.0032476486426311728
Bond Position:  [6.63953735]


portfolio before change:  [6.28500049]
curr_Stock_Price:  109.67841427574511
curr_Factors:  [1.09678414e+02 3.58956397e-02]
mat_Sqrt:  [[ 2.07798310e+01  0.00000000e+00]
 [-7.57845786e-03  1.73644284e-02]]
grads:  [1.97201272e-02 1.99273175e+01]
Stock Position:  0.019720127242199965
Bond Position:  [4.12212821]


portfolio before change:  [6.29748922]
curr_Stock_Price:  110.25944817540162
curr_Factors:  [1.10259448e+02 3.52358553e-02]
mat_Sqrt:  [[ 2.06970393e+01  0.00000000e+00]
 [-7.50848643e-03  1.72041037e-02]]
grads:  [3.39602695e-03 3.45323528e+00]
Stock Position:  0.0033960269482109715
Bond Position:  [5.92304516]


portfolio before change:  [6.30157515]
curr_Stock_Price:  111.02651663310286
curr_Factors:  [1.11026517e+02 3.46871148e-02]
mat_Sqrt:  [[ 2.06781082e+01  0.00000000e+00]
 [-7.44979085e-03  1.70696152e-02]]
grads:  [5.10715101e-03 2.13950159e+01]
Stock Position:  0.005107151006303078
Bond Position:  [5.73454596]


portfolio before change:  [6.29067605]
curr_Stock_Price:  108.61168472399552
curr_Factors:  [1.08611685e+02 3.65256579e-02]
mat_Sqrt:  [[ 2.07575252e+01  0.00000000e+00]
 [-7.64467479e-03  1.75161505e-02]]
grads:  [0.00795716 7.0875644 ]
Stock Position:  0.007957161464478212
Bond Position:  [5.42643534]


portfolio before change:  [6.28244176]
curr_Stock_Price:  107.40634689258995
curr_Factors:  [1.07406347e+02 3.69568341e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.28244176]
Stock Price:  106.99146239936798
PL:  [-0.70902064]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-3.89290503e-02  5.88498051e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.61606948e-01 -5.63230694e-01]
 [ 9.90178838e-02  1.17077795e-01]
 [-3.59854780e-01 -1.08465127e-01]
 [ 3.51367961e-01 -4.18618768e-01]
 [-5.21446601e-01  2.67688161e-01]
 [ 2.42620741e-02  1.53781228e-01]
 [-1.99664942e-01 -3.25762369e-02]
 [ 2.75771543e-01  4.67365407e-03]
 [ 4.71209264e-02  1.23146334e-01]
 [-2.36992862e-01  7.70203128e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.15201780e-01 -2.68889004e-01]
 [-1.08901674e-01 -1.29250225e-01]
 [ 8.84748371e-02  7.67644793e-02]
 [-3.64481920e-02 -3.73486253e-02]
 [ 4.65492945e-01 -2.55328725e-01]
 [ 1.88934131e-01  1.38796604e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.72689082]
curr_Stock_Price:  99.72621490496269
curr_Factors:  [9.97262149e+01 3.81889531e-02]
mat_Sqrt:  [[ 1.94884910e+01  0.00000000e+00]
 [-7.81679762e-03  1.79105334e-02]]
grads:  [-0.00186575  0.32857651]
Stock Position:  -0.001865749083875558
Bond Position:  [0.91295492]


portfolio before change:  [0.72636784]
curr_Stock_Price:  100.1288666048975
curr_Factors:  [1.00128867e+02 3.74074914e-02]
mat_Sqrt:  [[ 1.93659405e+01  0.00000000e+00]
 [-7.73640654e-03  1.77263343e-02]]
grads:  [-0.00962127 -3.76005378]
Stock Position:  -0.009621266291442533
Bond Position:  [1.68973433]


portfolio before change:  [0.72117631]
curr_Stock_Price:  100.7123677066254
curr_Factors:  [1.00712368e+02 3.76207360e-02]
mat_Sqrt:  [[ 1.95342369e+01  0.00000000e+00]
 [-7.75842624e-03  1.77767878e-02]]
grads:  [-2.08567644e-02 -3.16834910e+01]
Stock Position:  -0.020856764367716992
Bond Position:  [2.82171043]


portfolio before change:  [0.7254796]
curr_Stock_Price:  100.5398683798536
curr_Factors:  [1.00539868e+02 3.78077954e-02]
mat_Sqrt:  [[ 1.95492000e+01  0.00000000e+00]
 [-7.77769070e-03  1.78209282e-02]]
grads:  [0.00767882 6.56967998]
Stock Position:  0.007678821783064449
Bond Position:  [-0.04654813]


portfolio before change:  [0.72315799]
curr_Stock_Price:  100.23904417825186
curr_Factors:  [1.00239044e+02 3.98208296e-02]
mat_Sqrt:  [[ 2.00028588e+01  0.00000000e+00]
 [-7.98206285e-03  1.82892036e-02]]
grads:  [-0.02035673 -5.93055496]
Stock Position:  -0.02035673235500943
Bond Position:  [2.76369738]


portfolio before change:  [0.72618337]
curr_Stock_Price:  100.12437095986783
curr_Factors:  [1.00124371e+02 3.99816204e-02]
mat_Sqrt:  [[ 2.00202730e+01  0.00000000e+00]
 [-7.99816183e-03  1.83260910e-02]]
grads:  [ 8.42484774e-03 -2.28427747e+01]
Stock Position:  0.008424847742454918
Bond Position:  [-0.11734921]


portfolio before change:  [0.73046846]
curr_Stock_Price:  100.63647840640017
curr_Factors:  [1.00636478e+02 4.15302328e-02]
mat_Sqrt:  [[ 2.05086755e+01  0.00000000e+00]
 [-8.15158712e-03  1.86776325e-02]]
grads:  [-0.01972911 14.33201777]
Stock Position:  -0.01972910973872788
Bond Position:  [2.71593658]


portfolio before change:  [0.77465286]
curr_Stock_Price:  98.43134428845742
curr_Factors:  [9.84313443e+01 4.25816400e-02]
mat_Sqrt:  [[ 2.03116221e+01  0.00000000e+00]
 [-8.25412770e-03  1.89125825e-02]]
grads:  [4.49878911e-03 8.13115967e+00]
Stock Position:  0.004498789105670553
Bond Position:  [0.331831]


portfolio before change:  [0.77463477]
curr_Stock_Price:  98.4088815027667
curr_Factors:  [9.84088815e+01 4.22097010e-02]
mat_Sqrt:  [[ 2.02181043e+01  0.00000000e+00]
 [-8.21799985e-03  1.88298032e-02]]
grads:  [-0.01057876 -1.73003597]
Stock Position:  -0.01057875526294507
Bond Position:  [1.81567825]


portfolio before change:  [0.76337311]
curr_Stock_Price:  99.5163503749058
curr_Factors:  [9.95163504e+01 4.26072571e-02]
mat_Sqrt:  [[ 2.05416927e+01  0.00000000e+00]
 [-8.25661016e-03  1.89182705e-02]]
grads:  [0.01352426 0.24704447]
Stock Position:  0.013524264849849768
Bond Position:  [-0.58251237]


portfolio before change:  [0.76289245]
curr_Stock_Price:  99.49157913891777
curr_Factors:  [9.94915791e+01 4.45802044e-02]
mat_Sqrt:  [[ 2.10066767e+01  0.00000000e+00]
 [-8.44560993e-03  1.93513234e-02]]
grads:  [4.80163494e-03 6.36371640e+00]
Stock Position:  0.004801634935246702
Bond Position:  [0.28517021]


portfolio before change:  [0.76740579]
curr_Stock_Price:  100.41668992390962
curr_Factors:  [1.00416690e+02 4.47109452e-02]
mat_Sqrt:  [[ 2.12330717e+01  0.00000000e+00]
 [-8.45798513e-03  1.93796785e-02]]
grads:  [-0.00957838  3.97428227]
Stock Position:  -0.009578380540122739
Bond Position:  [1.72923506]


portfolio before change:  [0.76450954]
curr_Stock_Price:  100.76420335551643
curr_Factors:  [1.00764203e+02 4.26705897e-02]
mat_Sqrt:  [[ 2.08147212e+01  0.00000000e+00]
 [-8.26274430e-03  1.89323256e-02]]
grads:  [3.19125704e-04 2.07928512e+00]
Stock Position:  0.00031912570354847395
Bond Position:  [0.73235309]


portfolio before change:  [0.76443788]
curr_Stock_Price:  99.96585995210394
curr_Factors:  [9.99658600e+01 4.37688996e-02]
mat_Sqrt:  [[ 2.09138756e+01  0.00000000e+00]
 [-8.36840721e-03  1.91744298e-02]]
grads:  [ -0.01590114 -14.02331166]
Stock Position:  -0.01590114474537873
Bond Position:  [2.35400949]


portfolio before change:  [0.79517449]
curr_Stock_Price:  98.06989358708687
curr_Factors:  [9.80698936e+01 4.55718761e-02]
mat_Sqrt:  [[ 2.09355396e+01  0.00000000e+00]
 [-8.53902815e-03  1.95653714e-02]]
grads:  [-0.00789619 -6.60607062]
Stock Position:  -0.007896194711007557
Bond Position:  [1.56955347]


portfolio before change:  [0.79656066]
curr_Stock_Price:  97.94404434369963
curr_Factors:  [9.79440443e+01 4.73539310e-02]
mat_Sqrt:  [[ 2.13135627e+01  0.00000000e+00]
 [-8.70438335e-03  1.99442478e-02]]
grads:  [0.005723   3.84895335]
Stock Position:  0.005723003898545573
Bond Position:  [0.23602651]


portfolio before change:  [0.81159756]
curr_Stock_Price:  100.56118179286608
curr_Factors:  [1.00561182e+02 4.79656436e-02]
mat_Sqrt:  [[ 2.20239649e+01  0.00000000e+00]
 [-8.76042407e-03  2.00726532e-02]]
grads:  [-0.00239505 -1.86067208]
Stock Position:  -0.0023950486938147195
Bond Position:  [1.05244649]


portfolio before change:  [0.81164917]
curr_Stock_Price:  100.64950494409229
curr_Factors:  [1.00649505e+02 4.95864429e-02]
mat_Sqrt:  [[ 2.24126454e+01  0.00000000e+00]
 [-8.90720543e-03  2.04089716e-02]]
grads:  [  0.01579726 -12.51061202]
Stock Position:  0.015797258521511877
Bond Position:  [-0.77833708]


portfolio before change:  [0.76754511]
curr_Stock_Price:  97.869943695969
curr_Factors:  [9.78699437e+01 5.23581747e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.76754511]
Stock Price:  98.45892585688098
PL:  [0.76754511]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.17225120e-02  1.98389086e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.55830210e-01 -5.23816828e-01]
 [ 2.49380495e-01 -1.23124144e-01]
 [-2.17909750e-01 -9.13709560e-02]
 [ 3.82321137e-01 -4.66896706e-01]
 [-4.98709736e-01  2.21839355e-01]
 [ 1.46378386e-01  1.44187040e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.73756030e-01  4.58214125e-03]
 [-7.95906585e-03  7.03819536e-02]
 [-2.36520948e-01  6.78213173e-02]
 [-9.50837924e-02  3.26155856e-02]
 [-4.72555460e-02 -1.95993731e-01]
 [-1.48935573e-01 -1.47771588e-01]
 [ 8.80929817e-02  3.67410301e-02]
 [ 6.40333068e-02 -8.44655688e-02]
 [ 8.17990115e-01 -3.86170964e-01]
 [ 1.46191326e-01  1.70059931e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.60558494]
curr_Stock_Price:  101.16013985727044
curr_Factors:  [1.0116014e+02 4.0879776e-02]
mat_Sqrt:  [[ 2.04533135e+01  0.00000000e+00]
 [-8.08749910e-03  1.85307884e-02]]
grads:  [3.17120176e-03 1.07059172e+01]
Stock Position:  0.0031712017601409387
Bond Position:  [10.28478572]


portfolio before change:  [10.60442203]
curr_Stock_Price:  99.98253276740738
curr_Factors:  [9.99825328e+01 4.05240733e-02]
mat_Sqrt:  [[ 2.01270757e+01  0.00000000e+00]
 [-8.05223678e-03  1.84499923e-02]]
grads:  [-0.00925742 -3.61257442]
Stock Position:  -0.009257423828101683
Bond Position:  [11.53000271]


portfolio before change:  [10.59744085]
curr_Stock_Price:  101.04805997278292
curr_Factors:  [1.0104806e+02 3.9241624e-02]
mat_Sqrt:  [[ 2.00171142e+01  0.00000000e+00]
 [-7.92379949e-03  1.81557055e-02]]
grads:  [-1.92056963e-02 -2.88513618e+01]
Stock Position:  -0.019205696339863285
Bond Position:  [12.53813921]


portfolio before change:  [10.56545566]
curr_Stock_Price:  102.8766900201419
curr_Factors:  [1.02876690e+02 3.76236396e-02]
mat_Sqrt:  [[ 1.99548003e+01  0.00000000e+00]
 [-7.75872562e-03  1.77774737e-02]]
grads:  [ 0.00980439 -6.92585153]
Stock Position:  0.009804393475687914
Bond Position:  [9.55681211]


portfolio before change:  [10.55520451]
curr_Stock_Price:  101.58740522354363
curr_Factors:  [1.01587405e+02 3.66026864e-02]
mat_Sqrt:  [[ 1.94355282e+01  0.00000000e+00]
 [-7.65273143e-03  1.75346105e-02]]
grads:  [-0.01326371 -5.21089168]
Stock Position:  -0.013263714856631664
Bond Position:  [11.90263089]


portfolio before change:  [10.57185266]
curr_Stock_Price:  100.55661412836014
curr_Factors:  [1.00556614e+02 3.62933162e-02]
mat_Sqrt:  [[ 1.91568442e+01  0.00000000e+00]
 [-7.62032191e-03  1.74603510e-02]]
grads:  [ 9.32046568e-03 -2.67403964e+01]
Stock Position:  0.00932046567773875
Bond Position:  [9.63461819]


portfolio before change:  [10.56884168]
curr_Stock_Price:  99.97510549029907
curr_Factors:  [9.99751055e+01 3.70851703e-02]
mat_Sqrt:  [[ 1.92527162e+01  0.00000000e+00]
 [-7.70300412e-03  1.76497997e-02]]
grads:  [-0.02087451 12.5689446 ]
Stock Position:  -0.020874514507175222
Bond Position:  [12.65577347]


portfolio before change:  [10.56026713]
curr_Stock_Price:  100.53746089938211
curr_Factors:  [1.00537461e+02 3.68247388e-02]
mat_Sqrt:  [[ 1.92929105e+01  0.00000000e+00]
 [-7.67590921e-03  1.75877175e-02]]
grads:  [0.0108489  8.19816673]
Stock Position:  0.010848895441103049
Bond Position:  [9.46954672]


portfolio before change:  [10.54771878]
curr_Stock_Price:  99.16257185463556
curr_Factors:  [9.91625719e+01 3.65530520e-02]
mat_Sqrt:  [[ 1.89587458e+01  0.00000000e+00]
 [-7.64754099e-03  1.75227177e-02]]
grads:  [-0.01147654 -3.03314315]
Stock Position:  -0.011476543473205165
Bond Position:  [11.68576235]


portfolio before change:  [10.54723759]
curr_Stock_Price:  99.45908909248355
curr_Factors:  [9.94590891e+01 3.62834131e-02]
mat_Sqrt:  [[ 1.89451716e+01  0.00000000e+00]
 [-7.61928218e-03  1.74579687e-02]]
grads:  [0.01455547 0.26246703]
Stock Position:  0.014555468030138663
Bond Position:  [9.099564]


portfolio before change:  [10.53565295]
curr_Stock_Price:  98.50688215729525
curr_Factors:  [9.85068822e+01 3.88604122e-02]
mat_Sqrt:  [[ 1.94187055e+01  0.00000000e+00]
 [-7.88521778e-03  1.80673037e-02]]
grads:  [1.17196983e-03 3.89554274e+00]
Stock Position:  0.0011719698336232216
Bond Position:  [10.42020586]


portfolio before change:  [10.5375649]
curr_Stock_Price:  97.91520481623547
curr_Factors:  [9.79152048e+01 3.85088548e-02]
mat_Sqrt:  [[ 1.92145598e+01  0.00000000e+00]
 [-7.84946926e-03  1.79853935e-02]]
grads:  [-0.01076898  3.77091094]
Stock Position:  -0.01076898460287572
Bond Position:  [11.59201223]


portfolio before change:  [10.53961203]
curr_Stock_Price:  97.99425007808043
curr_Factors:  [9.79942501e+01 3.90079038e-02]
mat_Sqrt:  [[ 1.93542747e+01  0.00000000e+00]
 [-7.90016747e-03  1.81015577e-02]]
grads:  [-0.00417733  1.80181099]
Stock Position:  -0.004177329564335713
Bond Position:  [10.94896631]


portfolio before change:  [10.55256359]
curr_Stock_Price:  95.54915348591162
curr_Factors:  [9.55491535e+01 4.08968911e-02]
mat_Sqrt:  [[ 1.93228860e+01  0.00000000e+00]
 [-8.08919191e-03  1.85346671e-02]]
grads:  [-6.87238039e-03 -1.05744403e+01]
Stock Position:  -0.006872380390018366
Bond Position:  [11.20921372]


portfolio before change:  [10.54706816]
curr_Stock_Price:  96.75660756931211
curr_Factors:  [9.67566076e+01 4.01822794e-02]
mat_Sqrt:  [[ 1.93953632e+01  0.00000000e+00]
 [-8.01820722e-03  1.83720208e-02]]
grads:  [-0.01100409 -8.04329527]
Stock Position:  -0.011004093001799565
Bond Position:  [11.61178686]


portfolio before change:  [10.57024585]
curr_Stock_Price:  94.91416775899164
curr_Factors:  [9.49141678e+01 3.92816547e-02]
mat_Sqrt:  [[ 1.88116085e+01  0.00000000e+00]
 [-7.92784003e-03  1.81649635e-02]]
grads:  [0.00553531 2.02263165]
Stock Position:  0.005535309864179444
Bond Position:  [10.04486652]


portfolio before change:  [10.57378883]
curr_Stock_Price:  95.1005077248327
curr_Factors:  [9.51005077e+01 3.68684392e-02]
mat_Sqrt:  [[ 1.82603968e+01  0.00000000e+00]
 [-7.68046240e-03  1.75981502e-02]]
grads:  [ 1.48789266e-03 -4.79968451e+00]
Stock Position:  0.0014878926572324419
Bond Position:  [10.43228948]


portfolio before change:  [10.57812328]
curr_Stock_Price:  96.2605784706697
curr_Factors:  [9.62605785e+01 3.78700724e-02]
mat_Sqrt:  [[ 1.87325342e+01  0.00000000e+00]
 [-7.78409377e-03  1.78355995e-02]]
grads:  [  0.0346697  -21.65169526]
Stock Position:  0.03466969716270203
Bond Position:  [7.24079818]


portfolio before change:  [10.51856895]
curr_Stock_Price:  94.49059574617259
curr_Factors:  [9.44905957e+01 4.00875015e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.51856895]
Stock Price:  93.46745823245583
PL:  [10.51856895]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.05280966e-02  5.74670419e-04]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.10363617e-01 -1.05393266e+00]
 [-3.11135745e-02  2.76370318e-01]
 [-4.21844759e-01 -5.89751864e-02]
 [-3.70521091e-02  1.03986106e-01]
 [-2.55505719e-01  8.29939677e-02]
 [ 2.44674700e-02  1.53521983e-01]
 [-2.21936812e-01  5.41999341e-02]
 [ 1.94195662e-01  8.59923009e-03]
 [-1.06004474e-01 -5.09235030e-02]
 [-1.57882290e-01  3.41291779e-02]
 [ 1.31367035e-02  4.64477505e-03]
 [-4.38539072e-02 -1.94401523e-01]
 [-1.89485319e-01 -1.38790758e-01]
 [ 8.80839866e-02  5.22855446e-02]
 [ 5.59278552e-02 -8.30135322e-02]
 [ 7.71033535e-01 -3.66921366e-01]
 [ 2.19445591e-01  1.25373594e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.92744378]
curr_Stock_Price:  99.4860827948255
curr_Factors:  [9.94860828e+01 4.36858940e-02]
mat_Sqrt:  [[ 2.07937561e+01  0.00000000e+00]
 [-8.36046831e-03  1.91562394e-02]]
grads:  [0.00051837 0.02999912]
Stock Position:  0.0005183721177020159
Bond Position:  [-0.97901459]


portfolio before change:  [-0.92755064]
curr_Stock_Price:  99.75215683686184
curr_Factors:  [9.97521568e+01 4.56406960e-02]
mat_Sqrt:  [[ 2.13107348e+01  0.00000000e+00]
 [-8.54547328e-03  1.95801391e-02]]
grads:  [-0.00874324 -3.4040601 ]
Stock Position:  -0.008743240071301199
Bond Position:  [-0.05539358]


portfolio before change:  [-0.90518581]
curr_Stock_Price:  97.19261672522651
curr_Factors:  [9.71926167e+01 4.60786711e-02]
mat_Sqrt:  [[ 2.08633118e+01  0.00000000e+00]
 [-8.58637722e-03  1.96738618e-02]]
grads:  [-3.21299680e-02 -5.35701973e+01]
Stock Position:  -0.03212996798267566
Bond Position:  [2.21760985]


portfolio before change:  [-0.91978313]
curr_Stock_Price:  97.66419474695509
curr_Factors:  [9.76641947e+01 4.58514089e-02]
mat_Sqrt:  [[ 2.09127775e+01  0.00000000e+00]
 [-8.56517684e-03  1.96252856e-02]]
grads:  [4.27988682e-03 1.40823590e+01]
Stock Position:  0.004279886823604225
Bond Position:  [-1.33777483]


portfolio before change:  [-0.92386174]
curr_Stock_Price:  96.78937603572635
curr_Factors:  [9.67893760e+01 4.40869526e-02]
mat_Sqrt:  [[ 2.03227620e+01  0.00000000e+00]
 [-8.39875730e-03  1.92439705e-02]]
grads:  [-0.02202376 -3.06460594]
Stock Position:  -0.02202376041478293
Bond Position:  [1.20780429]


portfolio before change:  [-0.93044306]
curr_Stock_Price:  97.1019162997861
curr_Factors:  [9.71019163e+01 4.25660484e-02]
mat_Sqrt:  [[ 2.00336217e+01  0.00000000e+00]
 [-8.25261640e-03  1.89091197e-02]]
grads:  [4.15858306e-04 5.49925683e+00]
Stock Position:  0.0004158583059815758
Bond Position:  [-0.9708237]


portfolio before change:  [-0.93148388]
curr_Stock_Price:  95.18280244238409
curr_Factors:  [9.51828024e+01 4.13951527e-02]
mat_Sqrt:  [[ 1.93657014e+01  0.00000000e+00]
 [-8.13831951e-03  1.86472326e-02]]
grads:  [-0.01132333  4.45073913]
Stock Position:  -0.011323327617407964
Bond Position:  [0.14630218]


portfolio before change:  [-0.94417553]
curr_Stock_Price:  96.30687392966833
curr_Factors:  [9.63068739e+01 4.34459698e-02]
mat_Sqrt:  [[ 2.00739128e+01  0.00000000e+00]
 [-8.33747874e-03  1.91035637e-02]]
grads:  [4.55665805e-03 8.03630074e+00]
Stock Position:  0.00455665804931231
Bond Position:  [-1.38301302]


portfolio before change:  [-0.94577869]
curr_Stock_Price:  96.03093298334917
curr_Factors:  [9.60309330e+01 4.38880562e-02]
mat_Sqrt:  [[ 2.01179777e+01  0.00000000e+00]
 [-8.37979057e-03  1.92005123e-02]]
grads:  [-0.00985596  2.82283791]
Stock Position:  -0.009855961905708359
Bond Position:  [0.00069853]


portfolio before change:  [-0.95107742]
curr_Stock_Price:  96.56856734268796
curr_Factors:  [9.65685673e+01 4.35992977e-02]
mat_Sqrt:  [[ 2.01639464e+01  0.00000000e+00]
 [-8.35217794e-03  1.91372438e-02]]
grads:  [0.00981696 0.44934528]
Stock Position:  0.009816960896700075
Bond Position:  [-1.89908727]


portfolio before change:  [-0.96271239]
curr_Stock_Price:  95.43174481458352
curr_Factors:  [9.54317448e+01 4.31401832e-02]
mat_Sqrt:  [[ 1.98213786e+01  0.00000000e+00]
 [-8.30808601e-03  1.90362165e-02]]
grads:  [-0.00646924 -2.6750853 ]
Stock Position:  -0.00646924288764921
Bond Position:  [-0.34534126]


portfolio before change:  [-0.96181905]
curr_Stock_Price:  95.28030645635245
curr_Factors:  [9.52803065e+01 4.29591463e-02]
mat_Sqrt:  [[ 1.97483569e+01  0.00000000e+00]
 [-8.29063532e-03  1.89962320e-02]]
grads:  [-0.00724046  1.79662882]
Stock Position:  -0.007240455302015201
Bond Position:  [-0.27194625]


portfolio before change:  [-0.96047008]
curr_Stock_Price:  95.0846050758661
curr_Factors:  [9.50846051e+01 4.40512219e-02]
mat_Sqrt:  [[ 1.99567210e+01  0.00000000e+00]
 [-8.39535318e-03  1.92361707e-02]]
grads:  [0.00075984 0.24146048]
Stock Position:  0.000759836724156545
Bond Position:  [-1.03271885]


portfolio before change:  [-0.96046174]
curr_Stock_Price:  95.43539762189226
curr_Factors:  [9.54353976e+01 4.58598138e-02]
mat_Sqrt:  [[ 2.04373993e+01  0.00000000e+00]
 [-8.56596183e-03  1.96270843e-02]]
grads:  [-6.29716556e-03 -9.90475814e+00]
Stock Position:  -0.006297165564936138
Bond Position:  [-0.35948924]


portfolio before change:  [-0.96332547]
curr_Stock_Price:  95.87588883034344
curr_Factors:  [9.58758888e+01 4.68465421e-02]
mat_Sqrt:  [[ 2.07514369e+01  0.00000000e+00]
 [-8.65762481e-03  1.98371105e-02]]
grads:  [-0.01205018 -6.9965209 ]
Stock Position:  -0.012050181092384916
Bond Position:  [0.19199635]


portfolio before change:  [-0.9653754]
curr_Stock_Price:  96.04998847063231
curr_Factors:  [9.60499885e+01 4.64679522e-02]
mat_Sqrt:  [[ 2.07049451e+01  0.00000000e+00]
 [-8.62257059e-03  1.97567912e-02]]
grads:  [0.00535637 2.64645934]
Stock Position:  0.005356366234025996
Bond Position:  [-1.47985432]


portfolio before change:  [-0.96341284]
curr_Stock_Price:  96.48546387377684
curr_Factors:  [9.64854639e+01 4.53561955e-02]
mat_Sqrt:  [[ 2.05485035e+01  0.00000000e+00]
 [-8.51879762e-03  1.95190175e-02]]
grads:  [ 9.58599222e-04 -4.25295650e+00]
Stock Position:  0.0009585992224678408
Bond Position:  [-1.05590374]


portfolio before change:  [-0.96342984]
curr_Stock_Price:  96.74314828780217
curr_Factors:  [9.67431483e+01 4.65488939e-02]
mat_Sqrt:  [[ 2.08725206e+01  0.00000000e+00]
 [-8.63007707e-03  1.97739907e-02]]
grads:  [  0.02926795 -18.55575696]
Stock Position:  0.029267951546760772
Bond Position:  [-3.79490361]


portfolio before change:  [-0.87560087]
curr_Stock_Price:  99.77642568797258
curr_Factors:  [9.97764257e+01 4.60011699e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.87560087]
Stock Price:  98.4396455966402
PL:  [-0.87560087]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-8.79795923e-02  2.91991613e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.79789989e-01 -6.87290992e-01]
 [-1.67431254e-02  2.75520015e-01]
 [-4.35844811e-01 -1.20770195e-01]
 [ 2.78160053e-01 -3.11277496e-01]
 [-5.06024361e-01  2.32816942e-01]
 [ 3.00409149e-02  1.46487342e-01]
 [-2.07021560e-01 -3.91321388e-03]
 [ 2.29453507e-01  6.38989893e-03]
 [ 1.12935020e-01  1.80498947e-01]
 [-2.38557057e-01  1.07511108e-01]
 [-7.71433952e-03  5.46692868e-02]
 [-2.70767308e-01 -2.55435449e-01]
 [ 6.41187276e-02 -5.43097600e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.28392152e-02  1.99683465e-01]
 [ 1.99875975e-01 -8.05608734e-02]
 [ 5.44255136e-02 -4.59611520e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.82562461]
curr_Stock_Price:  100.03085301858516
curr_Factors:  [1.00030853e+02 3.99114449e-02]
mat_Sqrt:  [[ 1.99840127e+01  0.00000000e+00]
 [-7.99113958e-03  1.83100010e-02]]
grads:  [-0.00376481  1.59471107]
Stock Position:  -0.0037648111341920033
Bond Position:  [3.20222188]


portfolio before change:  [2.82739008]
curr_Stock_Price:  99.77458124102915
curr_Factors:  [9.97745812e+01 4.09456877e-02]
mat_Sqrt:  [[ 2.01894272e+01  0.00000000e+00]
 [-8.09401633e-03  1.85457212e-02]]
grads:  [-0.00922883 -3.5939271 ]
Stock Position:  -0.009228833885378325
Bond Position:  [3.74819311]


portfolio before change:  [2.82879951]
curr_Stock_Price:  99.72340864747783
curr_Factors:  [9.97234086e+01 4.20213460e-02]
mat_Sqrt:  [[ 2.04424100e+01  0.00000000e+00]
 [-8.19964350e-03  1.87877435e-02]]
grads:  [-2.34682882e-02 -3.65818807e+01]
Stock Position:  -0.023468288210001787
Bond Position:  [5.1691372]


portfolio before change:  [2.84591405]
curr_Stock_Price:  99.04921808667262
curr_Factors:  [9.90492181e+01 4.16138015e-02]
mat_Sqrt:  [[ 2.02055068e+01  0.00000000e+00]
 [-8.15978446e-03  1.86964150e-02]]
grads:  [5.12254746e-03 1.47365158e+01]
Stock Position:  0.005122547455986029
Bond Position:  [2.33852973]


portfolio before change:  [2.84835298]
curr_Stock_Price:  99.41119031596779
curr_Factors:  [9.94111903e+01 4.15834212e-02]
mat_Sqrt:  [[ 2.02719433e+01  0.00000000e+00]
 [-8.15680537e-03  1.86895890e-02]]
grads:  [-0.02409997 -6.4618968 ]
Stock Position:  -0.024099971028908367
Bond Position:  [5.24415978]


portfolio before change:  [2.85119147]
curr_Stock_Price:  99.34781734784758
curr_Factors:  [9.93478173e+01 3.95785794e-02]
mat_Sqrt:  [[ 1.97646183e+01  0.00000000e+00]
 [-7.95774636e-03  1.82334875e-02]]
grads:  [ 7.20010949e-03 -1.70717475e+01]
Stock Position:  0.007200109486102758
Bond Position:  [2.1358763]


portfolio before change:  [2.85729251]
curr_Stock_Price:  100.12100068410125
curr_Factors:  [1.00121001e+02 3.95258853e-02]
mat_Sqrt:  [[ 1.99051743e+01  0.00000000e+00]
 [-7.95244720e-03  1.82213456e-02]]
grads:  [-0.02031706 12.77715416]
Stock Position:  -0.02031706488142316
Bond Position:  [4.89145737]


portfolio before change:  [2.88856776]
curr_Stock_Price:  98.64183843934934
curr_Factors:  [9.86418384e+01 4.18319353e-02]
mat_Sqrt:  [[ 2.01750740e+01  0.00000000e+00]
 [-8.18114274e-03  1.87453529e-02]]
grads:  [4.65788786e-03 7.81459504e+00]
Stock Position:  0.004657887861480173
Bond Position:  [2.42910514]


portfolio before change:  [2.88448259]
curr_Stock_Price:  97.63440225267655
curr_Factors:  [9.76344023e+01 4.19434812e-02]
mat_Sqrt:  [[ 1.99956307e+01  0.00000000e+00]
 [-8.19204309e-03  1.87703288e-02]]
grads:  [-0.01043875 -0.20847871]
Stock Position:  -0.010438751804707748
Bond Position:  [3.90366388]


portfolio before change:  [2.88194151]
curr_Stock_Price:  97.97133039490697
curr_Factors:  [9.79713304e+01 4.01470002e-02]
mat_Sqrt:  [[ 1.96302376e+01  0.00000000e+00]
 [-8.01468654e-03  1.83639539e-02]]
grads:  [0.01183084 0.34795878]
Stock Position:  0.011830844463857194
Bond Position:  [1.72285794]


portfolio before change:  [2.91783695]
curr_Stock_Price:  100.96897532007787
curr_Factors:  [1.00968975e+02 3.78476295e-02]
mat_Sqrt:  [[ 1.96429762e+01  0.00000000e+00]
 [-7.78178689e-03  1.78303137e-02]]
grads:  [9.75978469e-03 1.01231503e+01]
Stock Position:  0.009759784693752481
Bond Position:  [1.93240149]


portfolio before change:  [2.93339363]
curr_Stock_Price:  102.51342740316328
curr_Factors:  [1.02513427e+02 3.73442305e-02]
mat_Sqrt:  [[ 1.98103665e+01  0.00000000e+00]
 [-7.72986214e-03  1.77113392e-02]]
grads:  [-0.00967349  6.07018515]
Stock Position:  -0.009673488979353925
Bond Position:  [3.92505614]


portfolio before change:  [2.93348467]
curr_Stock_Price:  102.6054681991811
curr_Factors:  [1.02605468e+02 3.60401051e-02]
mat_Sqrt:  [[ 1.94788598e+01  0.00000000e+00]
 [-7.59369265e-03  1.73993357e-02]]
grads:  [8.28862343e-04 3.14203299e+00]
Stock Position:  0.0008288623430461766
Bond Position:  [2.84843886]


portfolio before change:  [2.93399777]
curr_Stock_Price:  102.3652710717957
curr_Factors:  [1.02365271e+02 3.58926536e-02]
mat_Sqrt:  [[ 1.93934656e+01  0.00000000e+00]
 [-7.57814263e-03  1.73637061e-02]]
grads:  [ -0.01971017 -14.710883  ]
Stock Position:  -0.019710168636730946
Bond Position:  [4.95163453]


portfolio before change:  [2.9468975]
curr_Stock_Price:  101.77361391619009
curr_Factors:  [1.01773614e+02 3.51245541e-02]
mat_Sqrt:  [[ 1.90739485e+01  0.00000000e+00]
 [-7.49661834e-03  1.71769105e-02]]
grads:  [ 2.11891130e-03 -3.16178861e+00]
Stock Position:  0.0021189113008679506
Bond Position:  [2.73124824]


portfolio before change:  [2.95444359]
curr_Stock_Price:  105.01263195123398
curr_Factors:  [1.05012632e+02 3.27207863e-02]
mat_Sqrt:  [[ 1.89956172e+01  0.00000000e+00]
 [-7.23555514e-03  1.65787396e-02]]
grads:  [0.00505358 1.05744201]
Stock Position:  0.00505358310534596
Bond Position:  [2.42375353]


portfolio before change:  [2.96472567]
curr_Stock_Price:  106.92732563361791
curr_Factors:  [1.06927326e+02 3.36641842e-02]
mat_Sqrt:  [[ 1.96188141e+01  0.00000000e+00]
 [-7.33912084e-03  1.68160384e-02]]
grads:  [1.74882097e-03 1.18745842e+01]
Stock Position:  0.001748820971879722
Bond Position:  [2.77772892]


portfolio before change:  [2.96288902]
curr_Stock_Price:  105.47996769215233
curr_Factors:  [1.05479968e+02 3.54149265e-02]
mat_Sqrt:  [[ 1.98501211e+01  0.00000000e+00]
 [-7.52754159e-03  1.72477646e-02]]
grads:  [ 0.008298   -4.67080085]
Stock Position:  0.008298001154318392
Bond Position:  [2.08761612]


portfolio before change:  [2.96987152]
curr_Stock_Price:  106.25853313854938
curr_Factors:  [1.06258533e+02 3.46305135e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.96987152]
Stock Price:  107.82099087824466
PL:  [-4.85111936]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.09572233e-02  1.24401266e-01]
 [-1.56074829e-01 -6.62878165e-02]
 [-9.19197122e-02 -8.77646017e-02]
 [ 4.54182768e-01 -4.66069091e-01]
 [-8.67495386e-02 -5.53223455e-02]
 [ 9.40655579e-01 -1.33342530e+00]
 [-6.37350368e-01  6.53250701e-01]
 [ 7.42911370e-01  1.91044184e-01]
 [ 2.61312551e-01 -1.97369671e-01]
 [-6.45851902e-02  2.76896655e-02]
 [ 1.94825471e-01  2.85167204e-01]
 [-2.37685730e-01  9.05263628e-02]
 [-6.63706845e-03  4.15490794e-02]
 [-2.65560309e-01 -2.64823028e-01]
 [ 3.40768538e-02 -6.73972593e-02]
 [ 9.69259038e-02  3.37362834e-02]
 [-2.75325649e-02 -4.17682648e-02]
 [ 4.40452506e-01 -2.48032739e-01]
 [ 2.16173828e-01  1.26375828e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.07714349]
curr_Stock_Price:  100.64797497226468
curr_Factors:  [1.00647975e+02 3.95942802e-02]
mat_Sqrt:  [[ 2.00272476e+01  0.00000000e+00]
 [-7.95932461e-03  1.82371038e-02]]
grads:  [-8.32069391e-04  6.82132797e+00]
Stock Position:  -0.0008320693914090399
Bond Position:  [7.16088959]


portfolio before change:  [7.07866582]
curr_Stock_Price:  100.97019956764886
curr_Factors:  [1.00970200e+02 3.74524471e-02]
mat_Sqrt:  [[ 1.95403939e+01  0.00000000e+00]
 [-7.74105390e-03  1.77369827e-02]]
grads:  [-0.00946783 -3.73726566]
Stock Position:  -0.009467833907400358
Bond Position:  [8.0346349]


portfolio before change:  [7.04590004]
curr_Stock_Price:  104.64313022024947
curr_Factors:  [1.04643130e+02 3.61243287e-02]
mat_Sqrt:  [[ 1.98888932e+01  0.00000000e+00]
 [-7.60256048e-03  1.74196544e-02]]
grads:  [-0.00654754 -5.03825159]
Stock Position:  -0.006547540053819288
Bond Position:  [7.73105512]


portfolio before change:  [7.03101307]
curr_Stock_Price:  107.21202918672827
curr_Factors:  [1.07212029e+02 3.51097144e-02]
mat_Sqrt:  [[ 2.00889466e+01  0.00000000e+00]
 [-7.49503456e-03  1.71732816e-02]]
grads:  [ 1.24831603e-02 -2.71391981e+01]
Stock Position:  0.012483160283184812
Bond Position:  [5.69266813]


portfolio before change:  [7.03123603]
curr_Stock_Price:  107.1158684949187
curr_Factors:  [1.07115868e+02 3.63569247e-02]
mat_Sqrt:  [[ 2.04243095e+01  0.00000000e+00]
 [-7.62699675e-03  1.74756450e-02]]
grads:  [-0.00542952 -3.16568262]
Stock Position:  -0.00542951963882929
Bond Position:  [7.61282374]


portfolio before change:  [7.03349372]
curr_Stock_Price:  107.05062391900371
curr_Factors:  [1.07050624e+02 3.64153729e-02]
mat_Sqrt:  [[ 2.04282697e+01  0.00000000e+00]
 [-7.63312496e-03  1.74896865e-02]]
grads:  [ 1.75590528e-02 -7.62406635e+01]
Stock Position:  0.017559052838593495
Bond Position:  [5.15378616]


portfolio before change:  [7.02522158]
curr_Stock_Price:  106.50613279501754
curr_Factors:  [1.06506133e+02 3.53122872e-02]
mat_Sqrt:  [[ 2.00141679e+01  0.00000000e+00]
 [-7.51662554e-03  1.72227527e-02]]
grads:  [-1.75999517e-02  3.79295175e+01]
Stock Position:  -0.01759995165155144
Bond Position:  [8.89972436]


portfolio before change:  [7.02744895]
curr_Stock_Price:  106.50600966678715
curr_Factors:  [1.06506010e+02 3.14664258e-02]
mat_Sqrt:  [[ 1.88928650e+01  0.00000000e+00]
 [-7.09551134e-03  1.62578589e-02]]
grads:  [ 0.04373555 11.75088212]
Stock Position:  0.04373555241079676
Bond Position:  [2.36934979]


portfolio before change:  [7.05844386]
curr_Stock_Price:  107.20115348161194
curr_Factors:  [1.07201153e+02 3.21126534e-02]
mat_Sqrt:  [[ 1.92104507e+01  0.00000000e+00]
 [-7.16800150e-03  1.64239547e-02]]
grads:  [ 9.11864936e-03 -1.20171831e+01]
Stock Position:  0.009118649356672143
Bond Position:  [6.08091413]


portfolio before change:  [7.06093628]
curr_Stock_Price:  107.30774817785604
curr_Factors:  [1.07307748e+02 3.08564319e-02]
mat_Sqrt:  [[ 1.88496779e+01  0.00000000e+00]
 [-7.02639958e-03  1.60995040e-02]]
grads:  [-0.00278522  1.71990799]
Stock Position:  -0.0027852162591751003
Bond Position:  [7.35981157]


portfolio before change:  [7.07282568]
curr_Stock_Price:  103.69969102741523
curr_Factors:  [1.03699691e+02 3.34706294e-02]
mat_Sqrt:  [[ 1.89718378e+01  0.00000000e+00]
 [-7.31799201e-03  1.67676262e-02]]
grads:  [1.68292943e-02 1.70070111e+01]
Stock Position:  0.016829294342418977
Bond Position:  [5.32763306]


portfolio before change:  [7.03461244]
curr_Stock_Price:  101.34990023626398
curr_Factors:  [1.01349900e+02 3.25231127e-02]
mat_Sqrt:  [[ 1.82776088e+01  0.00000000e+00]
 [-7.21366622e-03  1.65285858e-02]]
grads:  [-0.0108426   5.47695756]
Stock Position:  -0.010842599158080031
Bond Position:  [8.13350878]


portfolio before change:  [7.03142843]
curr_Stock_Price:  101.83111714272871
curr_Factors:  [1.01831117e+02 3.50225562e-02]
mat_Sqrt:  [[ 1.90569954e+01  0.00000000e+00]
 [-7.48572575e-03  1.71519524e-02]]
grads:  [6.03265952e-04 2.42241107e+00]
Stock Position:  0.0006032659522713807
Bond Position:  [6.96999718]


portfolio before change:  [7.03311119]
curr_Stock_Price:  101.73174160967393
curr_Factors:  [1.01731742e+02 3.59524085e-02]
mat_Sqrt:  [[ 1.92894780e+01  0.00000000e+00]
 [-7.58444814e-03  1.73781539e-02]]
grads:  [ -0.01975888 -15.23884699]
Stock Position:  -0.019758883826670067
Bond Position:  [9.04321686]


portfolio before change:  [7.04019921]
curr_Stock_Price:  101.48745004706262
curr_Factors:  [1.01487450e+02 3.70081652e-02]
mat_Sqrt:  [[ 1.95236547e+01  0.00000000e+00]
 [-7.69500256e-03  1.76314658e-02]]
grads:  [ 2.38801515e-04 -3.82255564e+00]
Stock Position:  0.00023880151497016606
Bond Position:  [7.01596385]


portfolio before change:  [7.04178542]
curr_Stock_Price:  100.78394917156979
curr_Factors:  [1.00783949e+02 3.99093067e-02]
mat_Sqrt:  [[ 2.01339258e+01  0.00000000e+00]
 [-7.99092552e-03  1.83095105e-02]]
grads:  [0.00554535 1.84255518]
Stock Position:  0.005545347995240377
Bond Position:  [6.48290335]


portfolio before change:  [7.0400573]
curr_Stock_Price:  100.18001106100421
curr_Factors:  [1.00180011e+02 4.18059179e-02]
mat_Sqrt:  [[ 2.04833015e+01  0.00000000e+00]
 [-8.17859820e-03  1.87395227e-02]]
grads:  [-0.0022341  -2.22888627]
Stock Position:  -0.002234099331157628
Bond Position:  [7.2638694]


portfolio before change:  [7.03987842]
curr_Stock_Price:  101.0730258057555
curr_Factors:  [1.01073026e+02 4.27202041e-02]
mat_Sqrt:  [[ 2.08906487e+01  0.00000000e+00]
 [-8.26754659e-03  1.89433290e-02]]
grads:  [  0.01590195 -13.09340815]
Stock Position:  0.015901954447881957
Bond Position:  [5.43261976]


portfolio before change:  [7.01708456]
curr_Stock_Price:  99.55420777612535
curr_Factors:  [9.95542078e+01 4.34230923e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.01708456]
Stock Price:  101.36722753634685
PL:  [5.64985703]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-8.20166805e-02  1.07781586e-01]
 [-1.39412303e-01 -6.10603418e-02]
 [-1.64282175e-01 -5.81483387e-01]
 [ 2.13575430e-02  2.43908710e-01]
 [-4.54308469e-01 -1.23791621e-01]
 [ 4.12607166e-01 -5.14134087e-01]
 [-3.70391905e-01  1.45988790e-01]
 [ 2.37867582e-02  1.54381158e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 3.07772072e-01  6.21653575e-03]
 [ 1.98502236e-02  9.67818755e-02]
 [-2.38057967e-01  9.77823680e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 1.70906950e-01  5.76021966e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.25737199e-02  5.06748517e-02]
 [ 2.83042824e-01 -2.02236114e-01]
 [ 5.82911758e-02 -4.02907778e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.2849454]
curr_Stock_Price:  100.53298481369231
curr_Factors:  [1.00532985e+02 3.94205377e-02]
mat_Sqrt:  [[ 1.99604280e+01  0.00000000e+00]
 [-7.94184237e-03  1.81970469e-02]]
grads:  [-1.75231412e-03  5.92302624e+00]
Stock Position:  -0.0017523141160910051
Bond Position:  [6.46111077]


portfolio before change:  [6.28545134]
curr_Stock_Price:  101.16617055896718
curr_Factors:  [1.01166171e+02 3.87918747e-02]
mat_Sqrt:  [[ 1.99253379e+01  0.00000000e+00]
 [-7.87826120e-03  1.80513641e-02]]
grads:  [-0.00833417 -3.38258878]
Stock Position:  -0.008334173369022696
Bond Position:  [7.12858775]


portfolio before change:  [6.29216509]
curr_Stock_Price:  100.57446470037205
curr_Factors:  [1.00574465e+02 3.99800976e-02]
mat_Sqrt:  [[ 2.01098881e+01  0.00000000e+00]
 [-7.99800951e-03  1.83257420e-02]]
grads:  [-2.07888939e-02 -3.17304143e+01]
Stock Position:  -0.020788893906064615
Bond Position:  [8.38299697]


portfolio before change:  [6.31604484]
curr_Stock_Price:  99.52661016711542
curr_Factors:  [9.95266102e+01 3.92115245e-02]
mat_Sqrt:  [[ 1.97081599e+01  0.00000000e+00]
 [-7.92076002e-03  1.81487412e-02]]
grads:  [6.48503118e-03 1.34394285e+01]
Stock Position:  0.006485031176348643
Bond Position:  [5.67061167]


portfolio before change:  [6.3154103]
curr_Stock_Price:  99.21013273891916
curr_Factors:  [9.92101327e+01 3.98513440e-02]
mat_Sqrt:  [[ 1.98051218e+01  0.00000000e+00]
 [-7.98512056e-03  1.82962097e-02]]
grads:  [-0.02566687 -6.76597083]
Stock Position:  -0.025666873819330114
Bond Position:  [8.86182426]


portfolio before change:  [6.27297634]
curr_Stock_Price:  100.94971730197724
curr_Factors:  [1.00949717e+02 3.98606932e-02]
mat_Sqrt:  [[ 2.01547553e+01  0.00000000e+00]
 [-7.98605717e-03  1.82983557e-02]]
grads:  [ 9.33877148e-03 -2.80972834e+01]
Stock Position:  0.009338771478083338
Bond Position:  [5.33023]


portfolio before change:  [6.24608238]
curr_Stock_Price:  97.927190553094
curr_Factors:  [9.79271906e+01 4.20686804e-02]
mat_Sqrt:  [[ 2.00855043e+01  0.00000000e+00]
 [-8.20426039e-03  1.87983221e-02]]
grads:  [-0.01526858  7.76605426]
Stock Position:  -0.015268582222793202
Bond Position:  [7.74129174]


portfolio before change:  [6.27132997]
curr_Stock_Price:  96.40039347999787
curr_Factors:  [9.64003935e+01 4.39908620e-02]
mat_Sqrt:  [[ 2.02190172e+01  0.00000000e+00]
 [-8.38959946e-03  1.92229873e-02]]
grads:  [4.50883534e-03 8.03107007e+00]
Stock Position:  0.004508835335961811
Bond Position:  [5.83667647]


portfolio before change:  [6.28756927]
curr_Stock_Price:  99.67839180947412
curr_Factors:  [9.96783918e+01 4.32872943e-02]
mat_Sqrt:  [[ 2.07386863e+01  0.00000000e+00]
 [-8.32223954e-03  1.90686463e-02]]
grads:  [-0.01049155 -2.78724091]
Stock Position:  -0.010491545470180249
Bond Position:  [7.33334965]


portfolio before change:  [6.27489653]
curr_Stock_Price:  101.06105883700789
curr_Factors:  [1.01061059e+02 4.19386472e-02]
mat_Sqrt:  [[ 2.06962210e+01  0.00000000e+00]
 [-8.19157101e-03  1.87692471e-02]]
grads:  [0.01500202 0.33120858]
Stock Position:  0.015002023336139004
Bond Position:  [4.75877616]


portfolio before change:  [6.24529913]
curr_Stock_Price:  99.00885324991704
curr_Factors:  [9.90088532e+01 4.51171231e-02]
mat_Sqrt:  [[ 2.10302643e+01  0.00000000e+00]
 [-8.49631667e-03  1.94675071e-02]]
grads:  [2.95237835e-03 4.97145704e+00]
Stock Position:  0.00295237835138647
Bond Position:  [5.95298754]


portfolio before change:  [6.25515066]
curr_Stock_Price:  101.84151713162073
curr_Factors:  [1.01841517e+02 4.55135786e-02]
mat_Sqrt:  [[ 2.17267793e+01  0.00000000e+00]
 [-8.53356466e-03  1.95528530e-02]]
grads:  [-0.00899269  5.00092585]
Stock Position:  -0.008992692389066151
Bond Position:  [7.1709801]


portfolio before change:  [6.25840424]
curr_Stock_Price:  101.67909559888773
curr_Factors:  [1.01679096e+02 4.63045051e-02]
mat_Sqrt:  [[ 2.18797975e+01  0.00000000e+00]
 [-8.60739265e-03  1.97220142e-02]]
grads:  [3.03591134e-04 1.99602853e+00]
Stock Position:  0.0003035911344156545
Bond Position:  [6.22753537]


portfolio before change:  [6.26044698]
curr_Stock_Price:  103.27882089526727
curr_Factors:  [1.03278821e+02 4.34560541e-02]
mat_Sqrt:  [[ 2.15296225e+01  0.00000000e+00]
 [-8.33844629e-03  1.91057806e-02]]
grads:  [ -0.01908257 -13.05727268]
Stock Position:  -0.01908257245361187
Bond Position:  [8.23127256]


portfolio before change:  [6.24982837]
curr_Stock_Price:  103.94312768759355
curr_Factors:  [1.03943128e+02 4.21030951e-02]
mat_Sqrt:  [[ 2.13281306e+01  0.00000000e+00]
 [-8.20761550e-03  1.88060096e-02]]
grads:  [0.00919193 3.06296751]
Stock Position:  0.009191926512252374
Bond Position:  [5.29439078]


portfolio before change:  [6.25927216]
curr_Stock_Price:  104.82651383658788
curr_Factors:  [1.04826514e+02 4.25679608e-02]
mat_Sqrt:  [[ 2.16278110e+01  0.00000000e+00]
 [-8.25280179e-03  1.89095444e-02]]
grads:  [0.00443854 0.9271009 ]
Stock Position:  0.0044385411988085224
Bond Position:  [5.79399536]


portfolio before change:  [6.25368541]
curr_Stock_Price:  103.24143761535188
curr_Factors:  [1.03241438e+02 4.28506178e-02]
mat_Sqrt:  [[ 2.13713810e+01  0.00000000e+00]
 [-8.28015630e-03  1.89722215e-02]]
grads:  [-1.42514896e-03  2.67100253e+00]
Stock Position:  -0.001425148963051169
Bond Position:  [6.40081984]


portfolio before change:  [6.2547633]
curr_Stock_Price:  103.60807732988651
curr_Factors:  [1.03608077e+02 4.16380134e-02]
mat_Sqrt:  [[ 2.11416371e+01  0.00000000e+00]
 [-8.16215789e-03  1.87018532e-02]]
grads:  [ 9.21308724e-03 -1.08136938e+01]
Stock Position:  0.009213087238215805
Bond Position:  [5.30021304]


portfolio before change:  [6.28001127]
curr_Stock_Price:  106.20468261614594
curr_Factors:  [1.06204683e+02 3.95725231e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.28001127]
Stock Price:  107.07237867681815
PL:  [-0.79236741]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 4.60156934e-02  3.00183167e-01]
 [-1.42967812e-01 -6.21757990e-02]
 [-1.63839003e-01 -5.78459687e-01]
 [ 2.15892274e-01 -6.70475372e-02]
 [-1.33127775e-01 -7.80859210e-02]
 [ 4.26563685e-01 -5.35902190e-01]
 [-5.71331916e-01  3.99120579e-01]
 [ 6.08848436e-01  1.80513658e-01]
 [-1.43169917e-01 -3.23263489e-02]
 [ 2.99738098e-01  4.54737046e-03]
 [ 9.15095180e-02  1.61232614e-01]
 [-2.36772372e-01  7.27223181e-02]
 [-9.55699628e-02  3.25799533e-02]
 [-6.11646261e-02 -2.02551611e-01]
 [-2.17920908e-01 -1.32492934e-01]
 [ 8.89395238e-02  2.17394194e-02]
 [ 5.74352670e-02 -7.78531032e-02]
 [ 9.13869262e-01 -4.26049678e-01]
 [ 1.53334188e-01  1.51260597e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.44836665]
curr_Stock_Price:  101.86308555644223
curr_Factors:  [1.01863086e+02 3.91540841e-02]
mat_Sqrt:  [[ 2.01560470e+01  0.00000000e+00]
 [-7.91495639e-03  1.81354434e-02]]
grads:  [8.78279199e-03 1.65522927e+01]
Stock Position:  0.0087827919904704
Bond Position:  [14.55372436]


portfolio before change:  [15.44553858]
curr_Stock_Price:  101.12676402660163
curr_Factors:  [1.01126764e+02 4.01674930e-02]
mat_Sqrt:  [[ 2.02676536e+01  0.00000000e+00]
 [-8.01673180e-03  1.83686402e-02]]
grads:  [-0.00839286 -3.38488851]
Stock Position:  -0.00839285881041566
Bond Position:  [16.29428123]


portfolio before change:  [15.45395159]
curr_Stock_Price:  100.60978499933854
curr_Factors:  [1.00609785e+02 4.17991212e-02]
mat_Sqrt:  [[ 2.05695029e+01  0.00000000e+00]
 [-8.17793335e-03  1.87379993e-02]]
grads:  [-2.02386762e-02 -3.08709419e+01]
Stock Position:  -0.02023867617392813
Bond Position:  [17.49016045]


portfolio before change:  [15.42681837]
curr_Stock_Price:  102.1665224512174
curr_Factors:  [1.02166522e+02 4.32666797e-02]
mat_Sqrt:  [[ 2.12512948e+01  0.00000000e+00]
 [-8.32025766e-03  1.90641053e-02]]
grads:  [ 0.00878207 -3.51695169]
Stock Position:  0.008782068643353088
Bond Position:  [14.52958496]


portfolio before change:  [15.43910024]
curr_Stock_Price:  103.15137243033644
curr_Factors:  [1.03151372e+02 4.26477416e-02]
mat_Sqrt:  [[ 2.13021299e+01  0.00000000e+00]
 [-8.26053186e-03  1.89272563e-02]]
grads:  [-0.00784932 -4.12558059]
Stock Position:  -0.007849321431069778
Bond Position:  [16.24876852]


portfolio before change:  [15.45903289]
curr_Stock_Price:  101.12954837224657
curr_Factors:  [1.01129548e+02 4.18222870e-02]
mat_Sqrt:  [[ 2.06814963e+01  0.00000000e+00]
 [-8.18019922e-03  1.87431911e-02]]
grads:  [ 9.31638558e-03 -2.85918331e+01]
Stock Position:  0.00931638557588848
Bond Position:  [14.51687103]


portfolio before change:  [15.47677359]
curr_Stock_Price:  102.6441940318912
curr_Factors:  [1.02644194e+02 4.12101310e-02]
mat_Sqrt:  [[ 2.08370573e+01  0.00000000e+00]
 [-8.12011143e-03  1.86055126e-02]]
grads:  [-1.90593810e-02  2.14517378e+01]
Stock Position:  -0.019059380987918904
Bond Position:  [17.43310839]


portfolio before change:  [15.43291225]
curr_Stock_Price:  105.17418982571719
curr_Factors:  [1.05174190e+02 3.98513733e-02]
mat_Sqrt:  [[ 2.09957224e+01  0.00000000e+00]
 [-7.98512350e-03  1.82962164e-02]]
grads:  [0.03275101 9.86617415]
Stock Position:  0.032751007234411676
Bond Position:  [11.9883516]


portfolio before change:  [15.32740455]
curr_Stock_Price:  101.86115672246976
curr_Factors:  [1.01861157e+02 4.14663894e-02]
mat_Sqrt:  [[ 2.07422906e+01  0.00000000e+00]
 [-8.14531909e-03  1.86632706e-02]]
grads:  [-0.00758249 -1.73208381]
Stock Position:  -0.007582493905797156
Bond Position:  [16.09976615]


portfolio before change:  [15.34482971]
curr_Stock_Price:  100.09396485059253
curr_Factors:  [1.00093965e+02 4.13171440e-02]
mat_Sqrt:  [[ 2.03457189e+01  0.00000000e+00]
 [-8.13064760e-03  1.86296540e-02]]
grads:  [0.01482979 0.24409312]
Stock Position:  0.014829789745023421
Bond Position:  [13.86045726]


portfolio before change:  [15.35169675]
curr_Stock_Price:  100.32333349560956
curr_Factors:  [1.00323333e+02 4.30134731e-02]
mat_Sqrt:  [[ 2.08067481e+01  0.00000000e+00]
 [-8.29587590e-03  1.90082396e-02]]
grads:  [7.78003361e-03 8.48224859e+00]
Stock Position:  0.007780033613898398
Bond Position:  [14.57117784]


portfolio before change:  [15.35378273]
curr_Stock_Price:  100.12317099804125
curr_Factors:  [1.00123171e+02 4.16619728e-02]
mat_Sqrt:  [[ 2.04364055e+01  0.00000000e+00]
 [-8.16450589e-03  1.87072331e-02]]
grads:  [-0.01003277  3.88739038]
Stock Position:  -0.010032769722741643
Bond Position:  [16.35829545]


portfolio before change:  [15.37931848]
curr_Stock_Price:  97.98560859358375
curr_Factors:  [9.79856086e+01 4.08798857e-02]
mat_Sqrt:  [[ 1.98114896e+01  0.00000000e+00]
 [-8.08750995e-03  1.85308133e-02]]
grads:  [-0.00410625  1.75815022]
Stock Position:  -0.004106248801418659
Bond Position:  [15.78167177]


portfolio before change:  [15.39135656]
curr_Stock_Price:  96.01491306049124
curr_Factors:  [9.60149131e+01 4.18947800e-02]
mat_Sqrt:  [[ 1.96525382e+01  0.00000000e+00]
 [-8.18728575e-03  1.87594283e-02]]
grads:  [-7.61048749e-03 -1.07973232e+01]
Stock Position:  -0.007610487490430609
Bond Position:  [16.12207686]


portfolio before change:  [15.40120522]
curr_Stock_Price:  95.25048900347576
curr_Factors:  [9.52504890e+01 4.15316466e-02]
mat_Sqrt:  [[ 1.94113969e+01  0.00000000e+00]
 [-8.15172587e-03  1.86779504e-02]]
grads:  [-0.01420534 -7.09354782]
Stock Position:  -0.014205343740219345
Bond Position:  [16.75427116]


portfolio before change:  [15.44470186]
curr_Stock_Price:  92.48339337201607
curr_Factors:  [9.24833934e+01 4.15817199e-02]
mat_Sqrt:  [[ 1.88588402e+01  0.00000000e+00]
 [-8.15663852e-03  1.86892067e-02]]
grads:  [0.00521916 1.16320718]
Stock Position:  0.005219164231967043
Bond Position:  [14.96201584]


portfolio before change:  [15.45507051]
curr_Stock_Price:  93.75326770039777
curr_Factors:  [9.37532677e+01 4.22412003e-02]
mat_Sqrt:  [[ 1.92687942e+01  0.00000000e+00]
 [-8.22106565e-03  1.88368278e-02]]
grads:  [ 1.21737701e-03 -4.13302621e+00]
Stock Position:  0.0012173770144445106
Bond Position:  [15.34093744]


portfolio before change:  [15.46071669]
curr_Stock_Price:  95.24045066930748
curr_Factors:  [9.52404507e+01 3.95353800e-02]
mat_Sqrt:  [[ 1.89371405e+01  0.00000000e+00]
 [-7.95340229e-03  1.82235340e-02]]
grads:  [  0.03843906 -23.37909198]
Stock Position:  0.03843906315128554
Bond Position:  [11.79976299]


portfolio before change:  [15.49109252]
curr_Stock_Price:  95.95393112412467
curr_Factors:  [9.59539311e+01 3.88755501e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.49109252]
Stock Price:  95.30564508114591
PL:  [15.49109252]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.97409865e-02  4.89844023e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.15064625e-01 -9.27964813e-01]
 [ 7.01762951e-02  1.61638641e-01]
 [-3.90776180e-01 -1.13502019e-01]
 [ 2.37569047e-01 -2.58200979e-01]
 [-3.52427451e-01  1.36138453e-01]
 [ 2.35656318e-02  1.54660257e-01]
 [-2.12806604e-01  1.86266086e-02]
 [ 1.73872782e-01  9.87270474e-03]
 [-1.06004474e-01 -5.09235030e-02]
 [-1.26641711e-01  1.56440061e-02]
 [ 2.26252668e-02  2.97684928e-03]
 [-6.29448555e-02 -2.03384154e-01]
 [-1.90820984e-01 -1.38494939e-01]
 [ 8.85798319e-02  5.81068075e-02]
 [ 6.52091043e-02 -8.46762049e-02]
 [ 9.27536751e-01 -4.31617410e-01]
 [ 1.46810036e-01  1.63375708e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.42359724]
curr_Stock_Price:  99.68219084307346
curr_Factors:  [9.96821908e+01 4.04158036e-02]
mat_Sqrt:  [[ 2.00397908e+01  0.00000000e+00]
 [-8.04147286e-03  1.84253290e-02]]
grads:  [-0.00137742  0.26585361]
Stock Position:  -0.0013774161723486104
Bond Position:  [0.5609011]


portfolio before change:  [0.4258288]
curr_Stock_Price:  98.16389929644458
curr_Factors:  [9.81638993e+01 4.23281200e-02]
mat_Sqrt:  [[ 2.01960432e+01  0.00000000e+00]
 [-8.22951954e-03  1.88561981e-02]]
grads:  [-0.00922581 -3.53475127]
Stock Position:  -0.009225810640035087
Bond Position:  [1.33147035]


portfolio before change:  [0.42847797]
curr_Stock_Price:  97.91283593906965
curr_Factors:  [9.79128359e+01 4.11741531e-02]
mat_Sqrt:  [[ 1.98679001e+01  0.00000000e+00]
 [-8.11656608e-03  1.85973892e-02]]
grads:  [-3.12092204e-02 -4.98975852e+01]
Stock Position:  -0.03120922041652307
Bond Position:  [3.48426125]


portfolio before change:  [0.35791036]
curr_Stock_Price:  100.20186400240937
curr_Factors:  [1.00201864e+02 3.88734799e-02]
mat_Sqrt:  [[ 1.97561589e+01  0.00000000e+00]
 [-7.88654346e-03  1.80703412e-02]]
grads:  [7.12290190e-03 8.94496898e+00]
Stock Position:  0.007122901900043753
Bond Position:  [-0.35581768]


portfolio before change:  [0.35568738]
curr_Stock_Price:  99.90226374861493
curr_Factors:  [9.99022637e+01 3.85019040e-02]
mat_Sqrt:  [[ 1.96027243e+01  0.00000000e+00]
 [-7.84876082e-03  1.79837703e-02]]
grads:  [-0.0224618  -6.31135834]
Stock Position:  -0.022461802484441597
Bond Position:  [2.59967229]


portfolio before change:  [0.37368641]
curr_Stock_Price:  99.12988413174888
curr_Factors:  [9.91298841e+01 3.52619280e-02]
mat_Sqrt:  [[ 1.86147679e+01  0.00000000e+00]
 [-7.51126386e-03  1.72104676e-02]]
grads:  [ 6.70870040e-03 -1.50025545e+01]
Stock Position:  0.006708700401628088
Bond Position:  [-0.29134628]


portfolio before change:  [0.36415083]
curr_Stock_Price:  97.71936728612316
curr_Factors:  [9.77193673e+01 3.50694259e-02]
mat_Sqrt:  [[ 1.82997423e+01  0.00000000e+00]
 [-7.49073304e-03  1.71634256e-02]]
grads:  [-0.0160118   7.93189288]
Stock Position:  -0.016011796969348128
Bond Position:  [1.9288135]


portfolio before change:  [0.38937851]
curr_Stock_Price:  96.17391834938726
curr_Factors:  [9.61739183e+01 3.48310667e-02]
mat_Sqrt:  [[ 1.79490182e+01  0.00000000e+00]
 [-7.46523320e-03  1.71049981e-02]]
grads:  [5.07353109e-03 9.04181668e+00]
Stock Position:  0.0050735310876801765
Bond Position:  [-0.09856285]


portfolio before change:  [0.39421102]
curr_Stock_Price:  97.13126988866222
curr_Factors:  [9.71312699e+01 3.38202409e-02]
mat_Sqrt:  [[ 1.78627128e+01  0.00000000e+00]
 [-7.35611212e-03  1.68549703e-02]]
grads:  [-0.01145835  1.10511073]
Stock Position:  -0.011458353959273682
Bond Position:  [1.50717549]


portfolio before change:  [0.41099786]
curr_Stock_Price:  95.69912702053047
curr_Factors:  [9.56991270e+01 3.55496813e-02]
mat_Sqrt:  [[ 1.80437097e+01  0.00000000e+00]
 [-7.54184925e-03  1.72805475e-02]]
grads:  [0.009875   0.57131898]
Stock Position:  0.00987499723779804
Bond Position:  [-0.53403075]


portfolio before change:  [0.4111539]
curr_Stock_Price:  95.72845000534986
curr_Factors:  [9.57284500e+01 3.55063754e-02]
mat_Sqrt:  [[ 1.80382415e+01  0.00000000e+00]
 [-7.53725418e-03  1.72700189e-02]]
grads:  [-0.00710875 -2.94866516]
Stock Position:  -0.007108747960966337
Bond Position:  [1.09166332]


portfolio before change:  [0.42252307]
curr_Stock_Price:  94.1675253119356
curr_Factors:  [9.41675253e+01 3.76885324e-02]
mat_Sqrt:  [[ 1.82812451e+01  0.00000000e+00]
 [-7.76541382e-03  1.77927983e-02]]
grads:  [-0.00655394  0.87923247]
Stock Position:  -0.006553935819112978
Bond Position:  [1.03969099]


portfolio before change:  [0.41768898]
curr_Stock_Price:  94.9447751955572
curr_Factors:  [9.49447752e+01 3.84484374e-02]
mat_Sqrt:  [[ 1.86170308e+01  0.00000000e+00]
 [-7.84330924e-03  1.79712791e-02]]
grads:  [0.00128509 0.16564482]
Stock Position:  0.001285085178520976
Bond Position:  [0.29567686]


portfolio before change:  [0.41921462]
curr_Stock_Price:  96.07443704691308
curr_Factors:  [9.60744370e+01 3.89696368e-02]
mat_Sqrt:  [[ 1.89657939e+01  0.00000000e+00]
 [-7.89629146e-03  1.80926767e-02]]
grads:  [-7.99908394e-03 -1.12412418e+01]
Stock Position:  -0.007999083935242299
Bond Position:  [1.18772211]


portfolio before change:  [0.42139006]
curr_Stock_Price:  95.839600522655
curr_Factors:  [9.58396005e+01 3.77387355e-02]
mat_Sqrt:  [[ 1.86182418e+01  0.00000000e+00]
 [-7.77058407e-03  1.78046448e-02]]
grads:  [-0.01349564 -7.77858479]
Stock Position:  -0.013495642281593685
Bond Position:  [1.71480703]


portfolio before change:  [0.4114857]
curr_Stock_Price:  96.60526402224279
curr_Factors:  [9.66052640e+01 3.63024376e-02]
mat_Sqrt:  [[ 1.84063928e+01  0.00000000e+00]
 [-7.62127943e-03  1.74625449e-02]]
grads:  [0.00619023 3.32751084]
Stock Position:  0.0061902254884055015
Bond Position:  [-0.18652267]


portfolio before change:  [0.40102768]
curr_Stock_Price:  94.92335757866583
curr_Factors:  [9.49233576e+01 3.70174845e-02]
mat_Sqrt:  [[ 1.82631860e+01  0.00000000e+00]
 [-7.69597137e-03  1.76336857e-02]]
grads:  [ 1.54701259e-03 -4.80195726e+00]
Stock Position:  0.0015470125898983831
Bond Position:  [0.25418005]


portfolio before change:  [0.40136779]
curr_Stock_Price:  95.10212434914378
curr_Factors:  [9.51021243e+01 3.58201296e-02]
mat_Sqrt:  [[ 1.79992245e+01  0.00000000e+00]
 [-7.57048263e-03  1.73461549e-02]]
grads:  [  0.04106641 -24.88259866]
Stock Position:  0.04106640644851101
Bond Position:  [-3.5041347]


portfolio before change:  [0.394439]
curr_Stock_Price:  94.95473758725392
curr_Factors:  [9.49547376e+01 3.69249768e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.394439]
Stock Price:  96.23102231792993
PL:  [0.394439]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.86881810e-01 -1.19913661e+00]
 [-1.40372953e-02  2.78159788e-01]
 [-4.78957193e-01  2.16414054e-02]
 [ 5.15812769e-01 -3.91288330e-01]
 [-1.84688897e-01  4.41634239e-02]
 [-1.82072542e-01 -8.34307546e-01]
 [-2.68621399e-01  2.63534868e-01]
 [-1.19169168e-01 -6.36014356e-02]
 [-7.23755118e-02  5.98633660e-02]
 [ 1.44926651e-01 -1.23845171e-01]
 [ 5.94504692e-01 -9.62134387e-02]
 [ 2.02144491e-01  1.61985675e-01]
 [-3.01208675e-01 -9.98537361e-02]
 [ 8.30255330e-02  6.27546870e-02]
 [-2.32107096e-02 -2.88297652e-02]
 [ 1.59199671e+00 -7.08274065e-01]
 [ 2.76989088e-01  2.67656223e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.27156459]
curr_Stock_Price:  99.00067265586588
curr_Factors:  [9.90006727e+01 4.10200534e-02]
mat_Sqrt:  [[ 2.00510101e+01  0.00000000e+00]
 [-8.10136318e-03  1.85625550e-02]]
grads:  [ 0.00139003 -0.072772  ]
Stock Position:  0.0013900335921437088
Bond Position:  [-4.40917886]


portfolio before change:  [-4.27408796]
curr_Stock_Price:  97.97844190705727
curr_Factors:  [9.79784419e+01 4.22978108e-02]
mat_Sqrt:  [[ 2.01506692e+01  0.00000000e+00]
 [-8.22657263e-03  1.88494459e-02]]
grads:  [-0.00924658 -3.53601748]
Stock Position:  -0.009246584724860245
Bond Position:  [-3.368122]


portfolio before change:  [-4.26025652]
curr_Stock_Price:  96.39152295366605
curr_Factors:  [9.63915230e+01 4.47655054e-02]
mat_Sqrt:  [[ 2.03943838e+01  0.00000000e+00]
 [-8.46314413e-03  1.93914993e-02]]
grads:  [-3.48246821e-02 -6.18382619e+01]
Stock Position:  -0.0348246821141252
Bond Position:  [-0.90345237]


portfolio before change:  [-4.24173536]
curr_Stock_Price:  95.85319659359172
curr_Factors:  [9.58531966e+01 4.54268350e-02]
mat_Sqrt:  [[ 2.04297400e+01  0.00000000e+00]
 [-8.52542878e-03  1.95342114e-02]]
grads:  [5.25516178e-03 1.42396221e+01]
Stock Position:  0.005255161782825566
Bond Position:  [-4.74545942]


portfolio before change:  [-4.26677241]
curr_Stock_Price:  91.31470105576338
curr_Factors:  [9.13147011e+01 4.70133139e-02]
mat_Sqrt:  [[ 1.97993592e+01  0.00000000e+00]
 [-8.67302152e-03  1.98723888e-02]]
grads:  [-0.0237135   1.08901882]
Stock Position:  -0.023713500281426807
Bond Position:  [-2.10138122]


portfolio before change:  [-4.28965365]
curr_Stock_Price:  92.2574480083247
curr_Factors:  [9.22574480e+01 4.70471066e-02]
mat_Sqrt:  [[ 2.00109588e+01  0.00000000e+00]
 [-8.67613800e-03  1.98795296e-02]]
grads:  [ 1.72425792e-02 -1.96829773e+01]
Stock Position:  0.017242579224642778
Bond Position:  [-5.88041]


portfolio before change:  [-4.27261568]
curr_Stock_Price:  93.33085198358917
curr_Factors:  [9.33308520e+01 4.59730068e-02]
mat_Sqrt:  [[ 2.00113637e+01  0.00000000e+00]
 [-8.57652674e-03  1.96512915e-02]]
grads:  [-0.00826602  2.24735478]
Stock Position:  -0.008266023327323423
Bond Position:  [-3.50114068]


portfolio before change:  [-4.23655314]
curr_Stock_Price:  88.86220591535447
curr_Factors:  [8.88622059e+01 4.84309677e-02]
mat_Sqrt:  [[ 1.95559385e+01  0.00000000e+00]
 [-8.80281479e-03  2.01697826e-02]]
grads:  [-2.79298386e-02 -4.13642311e+01]
Stock Position:  -0.02792983861003031
Bond Position:  [-1.75464607]


portfolio before change:  [-4.19217489]
curr_Stock_Price:  87.25757893598325
curr_Factors:  [8.72575789e+01 5.11026631e-02]
mat_Sqrt:  [[ 1.97253594e+01  0.00000000e+00]
 [-9.04235926e-03  2.07186479e-02]]
grads:  [-7.78720175e-03  1.27196943e+01]
Stock Position:  -0.007787201746264003
Bond Position:  [-3.51268251]


portfolio before change:  [-4.18623121]
curr_Stock_Price:  86.38153149277662
curr_Factors:  [8.63815315e+01 4.94575890e-02]
mat_Sqrt:  [[ 1.92104426e+01  0.00000000e+00]
 [-8.89562491e-03  2.03824372e-02]]
grads:  [-0.00764829 -3.12040385]
Stock Position:  -0.007648293857231036
Bond Position:  [-3.52555987]


portfolio before change:  [-4.18722805]
curr_Stock_Price:  86.39661172816812
curr_Factors:  [8.63966117e+01 4.89995609e-02]
mat_Sqrt:  [[ 1.91246196e+01  0.00000000e+00]
 [-8.85433778e-03  2.02878365e-02]]
grads:  [-2.41829631e-03  2.95070230e+00]
Stock Position:  -0.0024182963110643634
Bond Position:  [-3.97829544]


portfolio before change:  [-4.19181357]
curr_Stock_Price:  87.88147088387679
curr_Factors:  [8.78814709e+01 5.06439995e-02]
mat_Sqrt:  [[ 1.97770411e+01  0.00000000e+00]
 [-9.00168869e-03  2.06254599e-02]]
grads:  [ 4.59503455e-03 -6.00448048e+00]
Stock Position:  0.004595034550478413
Bond Position:  [-4.59563197]


portfolio before change:  [-4.19466368]
curr_Stock_Price:  87.51127668764347
curr_Factors:  [8.75112767e+01 5.09440251e-02]
mat_Sqrt:  [[ 1.97519805e+01  0.00000000e+00]
 [-9.02831325e-03  2.06864644e-02]]
grads:  [ 0.02797257 -4.65103348]
Stock Position:  0.027972572468608244
Bond Position:  [-6.64257921]


portfolio before change:  [-4.12882639]
curr_Stock_Price:  89.92428821947446
curr_Factors:  [8.99242882e+01 5.09737955e-02]
mat_Sqrt:  [[ 2.03025456e+01  0.00000000e+00]
 [-9.03095083e-03  2.06925079e-02]]
grads:  [0.01343875 7.82822825]
Stock Position:  0.013438750021005702
Bond Position:  [-5.33729642]


portfolio before change:  [-4.11864118]
curr_Stock_Price:  90.78148878320094
curr_Factors:  [9.07814888e+01 5.05644416e-02]
mat_Sqrt:  [[ 2.04136145e+01  0.00000000e+00]
 [-8.99461542e-03  2.06092530e-02]]
grads:  [-0.01689012 -4.84509245]
Stock Position:  -0.016890120998534822
Bond Position:  [-2.58533085]


portfolio before change:  [-4.11954677]
curr_Stock_Price:  90.79683371287811
curr_Factors:  [9.07968337e+01 5.09350633e-02]
mat_Sqrt:  [[ 2.04917538e+01  0.00000000e+00]
 [-9.02751911e-03  2.06846448e-02]]
grads:  [0.00538821 3.03387791]
Stock Position:  0.005388212497934229
Bond Position:  [-4.60877941]


portfolio before change:  [-4.1261298]
curr_Stock_Price:  89.78895079206869
curr_Factors:  [8.97889508e+01 5.57219738e-02]
mat_Sqrt:  [[ 2.11951328e+01  0.00000000e+00]
 [-9.44220091e-03  2.16348002e-02]]
grads:  [-0.00168874 -1.33256443]
Stock Position:  -0.0016887391524928002
Bond Position:  [-3.97449968]


portfolio before change:  [-4.12412759]
curr_Stock_Price:  88.01487177867739
curr_Factors:  [8.80148718e+01 5.71595406e-02]
mat_Sqrt:  [[ 2.10426497e+01  0.00000000e+00]
 [-9.56322461e-03  2.19121003e-02]]
grads:  [  0.06096573 -32.32342197]
Stock Position:  0.06096573316562769
Bond Position:  [-9.49001878]


portfolio before change:  [-4.04559709]
curr_Stock_Price:  89.34190079954325
curr_Factors:  [8.93419008e+01 5.68696656e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.04559709]
Stock Price:  90.83382271767063
PL:  [-4.04559709]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.66522206e-01 -5.96766798e-01]
 [ 1.14642676e-01  9.29792513e-02]
 [-3.63504120e-01 -1.08958771e-01]
 [ 3.24319173e-01 -3.76430539e-01]
 [-5.24314026e-01  2.63384353e-01]
 [ 2.18913768e-02  1.56773454e-01]
 [-2.23180300e-01  5.90448422e-02]
 [ 1.80746585e-01  9.44197770e-03]
 [-1.04419938e-01 -4.57034272e-02]
 [-7.81651695e-02 -1.32948674e-02]
 [ 3.06886574e-01 -4.64236280e-02]
 [ 1.91662115e-01  1.46425107e-01]
 [-3.43603062e-01 -8.19348305e-02]
 [ 7.74098432e-02  9.97776702e-02]
 [-8.94089258e-02  1.19853231e-02]
 [ 1.73932167e+00 -7.69083768e-01]
 [ 3.73876953e-01  3.17383550e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.65927238]
curr_Stock_Price:  99.08954888581492
curr_Factors:  [9.90895489e+01 4.13514340e-02]
mat_Sqrt:  [[ 2.01499113e+01  0.00000000e+00]
 [-8.13402080e-03  1.86373830e-02]]
grads:  [ 0.00138321 -0.07247983]
Stock Position:  0.0013832109333967017
Bond Position:  [-3.79633412]


portfolio before change:  [-3.65867797]
curr_Stock_Price:  100.20550657229943
curr_Factors:  [1.00205507e+02 4.27938883e-02]
mat_Sqrt:  [[ 2.07291962e+01  0.00000000e+00]
 [-8.27467348e-03  1.89596588e-02]]
grads:  [-0.00898852 -3.51546254]
Stock Position:  -0.008988523646789962
Bond Position:  [-2.75797841]


portfolio before change:  [-3.66176639]
curr_Stock_Price:  100.47238436616954
curr_Factors:  [1.00472384e+02 4.43273334e-02]
mat_Sqrt:  [[ 2.11535135e+01  0.00000000e+00]
 [-8.42162297e-03  1.92963624e-02]]
grads:  [-2.01844762e-02 -3.09263885e+01]
Stock Position:  -0.02018447619812643
Bond Position:  [-1.63378394]


portfolio before change:  [-3.66713675]
curr_Stock_Price:  100.7182097743741
curr_Factors:  [1.00718210e+02 4.41995494e-02]
mat_Sqrt:  [[ 2.11746831e+01  0.00000000e+00]
 [-8.40947556e-03  1.92685291e-02]]
grads:  [0.00733055 4.82544623]
Stock Position:  0.0073305535398469615
Bond Position:  [-4.40545698]


portfolio before change:  [-3.67204427]
curr_Stock_Price:  100.1990103485941
curr_Factors:  [1.00199010e+02 4.65559469e-02]
mat_Sqrt:  [[ 2.16197673e+01  0.00000000e+00]
 [-8.63073086e-03  1.97754887e-02]]
grads:  [-0.01901305 -5.50978904]
Stock Position:  -0.0190130458545559
Bond Position:  [-1.76695589]


portfolio before change:  [-3.66357141]
curr_Stock_Price:  99.7301399433972
curr_Factors:  [9.97301399e+01 4.71774232e-02]
mat_Sqrt:  [[ 2.16617499e+01  0.00000000e+00]
 [-8.68814578e-03  1.99070428e-02]]
grads:  [ 7.38774190e-03 -1.89094152e+01]
Stock Position:  0.007387741896865203
Bond Position:  [-4.40035194]


portfolio before change:  [-3.65877457]
curr_Stock_Price:  100.52836230059236
curr_Factors:  [1.00528362e+02 4.54958651e-02]
mat_Sqrt:  [[ 2.14424582e+01  0.00000000e+00]
 [-8.53190390e-03  1.95490477e-02]]
grads:  [-0.01909127 13.47300168]
Stock Position:  -0.019091265931235113
Bond Position:  [-1.73956087]


portfolio before change:  [-3.61697114]
curr_Stock_Price:  98.31591753634022
curr_Factors:  [9.83159175e+01 4.81698300e-02]
mat_Sqrt:  [[ 2.15780102e+01  0.00000000e+00]
 [-8.77905052e-03  2.01153318e-02]]
grads:  [4.18541472e-03 7.79372945e+00]
Stock Position:  0.004185414718713229
Bond Position:  [-4.02846403]


portfolio before change:  [-3.62847965]
curr_Stock_Price:  95.80690430756883
curr_Factors:  [9.58069043e+01 5.08019833e-02]
mat_Sqrt:  [[ 2.15942011e+01  0.00000000e+00]
 [-9.01571813e-03  2.06576054e-02]]
grads:  [-0.00914185  2.8582617 ]
Stock Position:  -0.009141853300165507
Bond Position:  [-2.75262698]


portfolio before change:  [-3.63156143]
curr_Stock_Price:  96.06872686577985
curr_Factors:  [9.60687269e+01 5.07281375e-02]
mat_Sqrt:  [[ 2.16374708e+01  0.00000000e+00]
 [-9.00916311e-03  2.06425860e-02]]
grads:  [0.00854385 0.45740285]
Stock Position:  0.008543854507405343
Bond Position:  [-4.45235866]


portfolio before change:  [-3.65182766]
curr_Stock_Price:  93.82699839063586
curr_Factors:  [9.38269984e+01 5.17572218e-02]
mat_Sqrt:  [[ 2.13458425e+01  0.00000000e+00]
 [-9.10008543e-03  2.08509152e-02]]
grads:  [-0.00582627 -2.19191469]
Stock Position:  -0.005826265651582585
Bond Position:  [-3.10516665]


portfolio before change:  [-3.64403822]
curr_Stock_Price:  92.35678766313484
curr_Factors:  [9.23567877e+01 5.14646793e-02]
mat_Sqrt:  [[ 2.09519020e+01  0.00000000e+00]
 [-9.07433120e-03  2.07919048e-02]]
grads:  [-0.00400763 -0.63942518]
Stock Position:  -0.004007632592306679
Bond Position:  [-3.27390614]


portfolio before change:  [-3.64048991]
curr_Stock_Price:  91.26714698503523
curr_Factors:  [9.12671470e+01 5.16597896e-02]
mat_Sqrt:  [[ 2.07439182e+01  0.00000000e+00]
 [-9.09151601e-03  2.08312802e-02]]
grads:  [ 0.01381733 -2.22855377]
Stock Position:  0.013817333783578127
Bond Position:  [-4.90155855]


portfolio before change:  [-3.65708423]
curr_Stock_Price:  90.1548650559589
curr_Factors:  [9.01548651e+01 5.04510539e-02]
mat_Sqrt:  [[ 2.02499656e+01  0.00000000e+00]
 [-8.98452482e-03  2.05861325e-02]]
grads:  [0.01262063 7.11280308]
Stock Position:  0.012620627432761567
Bond Position:  [-4.79489519]


portfolio before change:  [-3.68221738]
curr_Stock_Price:  88.2584236909611
curr_Factors:  [8.82584237e+01 5.00247514e-02]
mat_Sqrt:  [[ 1.97400676e+01  0.00000000e+00]
 [-8.94648547e-03  2.04989734e-02]]
grads:  [-0.01921789 -3.99702116]
Stock Position:  -0.019217885228868976
Bond Position:  [-1.98607712]


portfolio before change:  [-3.70253991]
curr_Stock_Price:  89.29006399583153
curr_Factors:  [8.9290064e+01 4.7431342e-02]
mat_Sqrt:  [[ 1.94462489e+01  0.00000000e+00]
 [-8.71149512e-03  1.99605429e-02]]
grads:  [0.00622004 4.99874531]
Stock Position:  0.006220037037997504
Bond Position:  [-4.25792741]


portfolio before change:  [-3.72534192]
curr_Stock_Price:  85.7953258167246
curr_Factors:  [8.57953258e+01 4.69975050e-02]
mat_Sqrt:  [[ 1.85994897e+01  0.00000000e+00]
 [-8.67156318e-03  1.98690473e-02]]
grads:  [-0.00452583  0.60321579]
Stock Position:  -0.004525828570263045
Bond Position:  [-3.33704699]


portfolio before change:  [-3.72925545]
curr_Stock_Price:  86.47567781113929
curr_Factors:  [8.64756778e+01 4.39440116e-02]
mat_Sqrt:  [[ 1.81277467e+01  0.00000000e+00]
 [-8.38513080e-03  1.92127483e-02]]
grads:  [  0.07743191 -40.02986744]
Stock Position:  0.07743190676905125
Bond Position:  [-10.42523207]


portfolio before change:  [-3.68861536]
curr_Stock_Price:  87.0341907722934
curr_Factors:  [8.70341908e+01 4.34487166e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.68861536]
Stock Price:  90.74881932209999
PL:  [-3.68861536]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.01968639e-01  7.77986357e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.87858951e-01 -7.42344373e-01]
 [ 1.94282598e-02  2.45740105e-01]
 [-3.06997298e-01 -1.02019949e-01]
 [ 3.68310997e-01 -4.45044969e-01]
 [-5.25740184e-01  2.84367190e-01]
 [ 2.24505299e-01  1.50323841e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 3.00737512e-01  4.54543426e-03]
 [-1.78750624e-02  6.03293228e-02]
 [-2.36700782e-01  7.13268111e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.49503046e-01 -2.73686855e-01]
 [ 7.40051476e-03 -7.89889813e-02]
 [ 8.95358103e-02  1.40790604e-02]
 [-5.23325636e-02  2.81824770e-02]
 [ 2.92931739e-01 -2.05115552e-01]
 [-4.03361089e-02 -2.04846256e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.86501144]
curr_Stock_Price:  100.32687672741045
curr_Factors:  [1.00326877e+02 4.18609651e-02]
mat_Sqrt:  [[ 2.05268312e+01  0.00000000e+00]
 [-8.18398094e-03  1.87518561e-02]]
grads:  [-3.31344522e-03  4.14884987e+00]
Stock Position:  -0.003313445217885131
Bond Position:  [5.19743905]


portfolio before change:  [4.86965813]
curr_Stock_Price:  99.31669993123198
curr_Factors:  [9.93166999e+01 4.34066290e-02]
mat_Sqrt:  [[ 2.06918971e+01  0.00000000e+00]
 [-8.33370304e-03  1.90949125e-02]]
grads:  [-0.00900473 -3.4905617 ]
Stock Position:  -0.00900472630795474
Bond Position:  [5.76397783]


portfolio before change:  [4.87108856]
curr_Stock_Price:  99.31789314356637
curr_Factors:  [9.93178931e+01 4.49448905e-02]
mat_Sqrt:  [[ 2.10556019e+01  0.00000000e+00]
 [-8.48008401e-03  1.94303134e-02]]
grads:  [-2.43091885e-02 -3.82054760e+01]
Stock Position:  -0.024309188534491533
Bond Position:  [7.28542595]


portfolio before change:  [4.86842403]
curr_Stock_Price:  99.5024372311835
curr_Factors:  [9.95024372e+01 4.55819132e-02]
mat_Sqrt:  [[ 2.12436919e+01  0.00000000e+00]
 [-8.53996845e-03  1.95675259e-02]]
grads:  [5.96308943e-03 1.25585680e+01]
Stock Position:  0.0059630894284808805
Bond Position:  [4.27508209]


portfolio before change:  [4.87688299]
curr_Stock_Price:  100.74173719650416
curr_Factors:  [1.00741737e+02 4.25347241e-02]
mat_Sqrt:  [[ 2.07769237e+01  0.00000000e+00]
 [-8.24957930e-03  1.89021608e-02]]
grads:  [-0.01691889 -5.39726384]
Stock Position:  -0.01691888840467179
Bond Position:  [6.5813212]


portfolio before change:  [4.88527614]
curr_Stock_Price:  100.34291553830487
curr_Factors:  [1.00342916e+02 4.23071595e-02]
mat_Sqrt:  [[ 2.06392376e+01  0.00000000e+00]
 [-8.22748171e-03  1.88515289e-02]]
grads:  [ 8.43429650e-03 -2.36078979e+01]
Stock Position:  0.008434296496635445
Bond Position:  [4.03895424]


portfolio before change:  [4.89100581]
curr_Stock_Price:  100.90251221848322
curr_Factors:  [1.00902512e+02 4.02786035e-02]
mat_Sqrt:  [[ 2.02506600e+01  0.00000000e+00]
 [-8.02781200e-03  1.83940281e-02]]
grads:  [-0.01983304 15.45975621]
Stock Position:  -0.019833040927582604
Bond Position:  [6.89220947]


portfolio before change:  [4.88435666]
curr_Stock_Price:  101.32465697734484
curr_Factors:  [1.01324657e+02 4.02699345e-02]
mat_Sqrt:  [[ 2.03331940e+01  0.00000000e+00]
 [-8.02694806e-03  1.83920485e-02]]
grads:  [0.0142679  8.17330601]
Stock Position:  0.014267901143194055
Bond Position:  [3.43866648]


portfolio before change:  [4.86145626]
curr_Stock_Price:  99.65936779226975
curr_Factors:  [9.96593678e+01 3.84837606e-02]
mat_Sqrt:  [[ 1.95504555e+01  0.00000000e+00]
 [-7.84691130e-03  1.79795325e-02]]
grads:  [-0.0111292 -2.9560786]
Stock Position:  -0.01112919700585576
Bond Position:  [5.97058499]


portfolio before change:  [4.85778134]
curr_Stock_Price:  100.12370917559008
curr_Factors:  [1.00123709e+02 3.98910300e-02]
mat_Sqrt:  [[ 1.99974470e+01  0.00000000e+00]
 [-7.98909557e-03  1.83053176e-02]]
grads:  [0.015138   0.24831223]
Stock Position:  0.015137997429820155
Bond Position:  [3.34210889]


portfolio before change:  [4.83157776]
curr_Stock_Price:  98.33752741182879
curr_Factors:  [9.83375274e+01 4.13227408e-02]
mat_Sqrt:  [[ 1.99900483e+01  0.00000000e+00]
 [-8.13119827e-03  1.86309158e-02]]
grads:  [4.22951089e-04 3.23812976e+00]
Stock Position:  0.0004229510887209061
Bond Position:  [4.7899858]


portfolio before change:  [4.83349059]
curr_Stock_Price:  100.02846248084906
curr_Factors:  [1.00028462e+02 3.94816408e-02]
mat_Sqrt:  [[ 1.98756431e+01  0.00000000e+00]
 [-7.94799505e-03  1.82111445e-02]]
grads:  [-0.01034287  3.91665726]
Stock Position:  -0.010342870814608416
Bond Position:  [5.86807205]


portfolio before change:  [4.82544805]
curr_Stock_Price:  100.94791159567345
curr_Factors:  [1.00947912e+02 3.93028345e-02]
mat_Sqrt:  [[ 2.00128654e+01  0.00000000e+00]
 [-7.92997700e-03  1.81698599e-02]]
grads:  [3.31912118e-04 2.16653860e+00]
Stock Position:  0.00033191211756737664
Bond Position:  [4.79194221]


portfolio before change:  [4.82665698]
curr_Stock_Price:  100.98045794044498
curr_Factors:  [1.00980458e+02 4.22981597e-02]
mat_Sqrt:  [[ 2.07681625e+01  0.00000000e+00]
 [-8.22660656e-03  1.88495236e-02]]
grads:  [ -0.01776516 -14.51956349]
Stock Position:  -0.017765162564764465
Bond Position:  [6.62059124]


portfolio before change:  [4.82407852]
curr_Stock_Price:  101.21877962294771
curr_Factors:  [1.01218780e+02 4.24555565e-02]
mat_Sqrt:  [[ 2.08558726e+01  0.00000000e+00]
 [-8.24189847e-03  1.88845618e-02]]
grads:  [-1.29810454e-03 -4.18272778e+00]
Stock Position:  -0.0012981045409074896
Bond Position:  [4.95547107]


portfolio before change:  [4.82471844]
curr_Stock_Price:  101.68029829100907
curr_Factors:  [1.01680298e+02 4.34544213e-02]
mat_Sqrt:  [[ 2.11959944e+01  0.00000000e+00]
 [-8.33828964e-03  1.91054217e-02]]
grads:  [0.00451408 0.7369144 ]
Stock Position:  0.004514080066157308
Bond Position:  [4.36572543]


portfolio before change:  [4.83033882]
curr_Stock_Price:  102.68356098127377
curr_Factors:  [1.02683561e+02 4.07535405e-02]
mat_Sqrt:  [[ 2.07292502e+01  0.00000000e+00]
 [-8.07500246e-03  1.85021550e-02]]
grads:  [-0.00193122  1.5231997 ]
Stock Position:  -0.0019312190222064275
Bond Position:  [5.02864326]


portfolio before change:  [4.83012687]
curr_Stock_Price:  103.44435900181622
curr_Factors:  [1.03444359e+02 4.31801582e-02]
mat_Sqrt:  [[ 2.14955681e+01  0.00000000e+00]
 [-8.31193438e-03  1.90450342e-02]]
grads:  [ 9.46297264e-03 -1.07700280e+01]
Stock Position:  0.009462972635788354
Bond Position:  [3.85123573]


portfolio before change:  [4.87809234]
curr_Stock_Price:  108.4113547492525
curr_Factors:  [1.08411355e+02 4.25339695e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.87809234]
Stock Price:  108.42858790636836
PL:  [-3.55049557]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.82459236e-01 -7.05502886e-01]
 [-3.85558821e-02  2.75590417e-01]
 [-4.39410027e-01 -1.21373430e-01]
 [ 4.36144355e-01 -5.50845245e-01]
 [-5.28026370e-01  3.01011195e-01]
 [ 2.02237755e-01  1.48574745e-01]
 [-1.00339764e-01 -2.34360463e-02]
 [ 1.61824207e-01  1.54105766e-02]
 [ 1.62245884e-01  2.33154470e-01]
 [-2.38032007e-01  9.72763331e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.60535426e-01 -2.71530742e-01]
 [-8.68123884e-02 -1.18655326e-01]
 [ 9.80163572e-02  4.78858222e-02]
 [ 4.15564907e-03 -5.74576098e-02]
 [ 5.92310985e-01 -2.92323378e-01]
 [ 2.20121680e-01  1.04725211e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.08821754]
curr_Stock_Price:  98.15636634344852
curr_Factors:  [9.81563663e+01 4.15969689e-02]
mat_Sqrt:  [[ 2.00193197e+01  0.00000000e+00]
 [-8.15813399e-03  1.86926333e-02]]
grads:  [ 0.00139223 -0.0722656 ]
Stock Position:  0.0013922340028762535
Bond Position:  [-10.22487417]


portfolio before change:  [-10.08960994]
curr_Stock_Price:  98.99253378396644
curr_Factors:  [9.89925338e+01 4.01102400e-02]
mat_Sqrt:  [[ 1.98257703e+01  0.00000000e+00]
 [-8.01101642e-03  1.83555446e-02]]
grads:  [-0.00939812 -3.63116278]
Stock Position:  -0.009398115033334152
Bond Position:  [-9.15926672]


portfolio before change:  [-10.0973069]
curr_Stock_Price:  99.567846613282
curr_Factors:  [9.95678466e+01 3.88308049e-02]
mat_Sqrt:  [[ 1.96203753e+01  0.00000000e+00]
 [-7.88221338e-03  1.80604197e-02]]
grads:  [-2.49926890e-02 -3.90634823e+01]
Stock Position:  -0.02499268903172926
Bond Position:  [-7.60883867]


portfolio before change:  [-10.0715819]
curr_Stock_Price:  98.46242559507907
curr_Factors:  [9.84624256e+01 3.87547452e-02]
mat_Sqrt:  [[ 1.93835346e+01  0.00000000e+00]
 [-7.87448997e-03  1.80427232e-02]]
grads:  [4.21603379e-03 1.52743250e+01]
Stock Position:  0.004216033792669633
Bond Position:  [-10.48670282]


portfolio before change:  [-10.07036732]
curr_Stock_Price:  99.37242379015599
curr_Factors:  [9.93724238e+01 3.98944204e-02]
mat_Sqrt:  [[ 1.98482382e+01  0.00000000e+00]
 [-7.98943506e-03  1.83060955e-02]]
grads:  [-0.02480733 -6.63021945]
Stock Position:  -0.02480732701045129
Bond Position:  [-7.60520311]


portfolio before change:  [-10.11947927]
curr_Stock_Price:  101.27550706858167
curr_Factors:  [1.01275507e+02 3.77522802e-02]
mat_Sqrt:  [[ 1.96777764e+01  0.00000000e+00]
 [-7.77197841e-03  1.78078397e-02]]
grads:  [ 9.94704773e-03 -3.09327383e+01]
Stock Position:  0.009947047726385707
Bond Position:  [-11.12687157]


portfolio before change:  [-10.12307451]
curr_Stock_Price:  101.19375719875744
curr_Factors:  [1.01193757e+02 3.67653698e-02]
mat_Sqrt:  [[ 1.94031924e+01  0.00000000e+00]
 [-7.66971914e-03  1.75735343e-02]]
grads:  [-0.02044273 17.1286658 ]
Stock Position:  -0.020442734679207
Bond Position:  [-8.05439738]


portfolio before change:  [-10.1231316]
curr_Stock_Price:  101.09803807840828
curr_Factors:  [1.01098038e+02 3.75900191e-02]
mat_Sqrt:  [[ 1.96010349e+01  0.00000000e+00]
 [-7.75525826e-03  1.77695290e-02]]
grads:  [0.01362587 8.36120894]
Stock Position:  0.013625866753485382
Bond Position:  [-11.50067999]


portfolio before change:  [-10.10823674]
curr_Stock_Price:  102.40220369407575
curr_Factors:  [1.02402204e+02 3.49274980e-02]
mat_Sqrt:  [[ 1.91378454e+01  0.00000000e+00]
 [-7.47555996e-03  1.71286597e-02]]
grads:  [-0.00577746 -1.36823585]
Stock Position:  -0.005777457749983237
Bond Position:  [-9.51661233]


portfolio before change:  [-10.1164285]
curr_Stock_Price:  103.4082371448808
curr_Factors:  [1.03408237e+02 3.42613345e-02]
mat_Sqrt:  [[ 1.91406760e+01  0.00000000e+00]
 [-7.40392702e-03  1.69645280e-02]]
grads:  [0.00880585 0.90839996]
Stock Position:  0.008805850611058017
Bond Position:  [-11.02702599]


portfolio before change:  [-10.12565647]
curr_Stock_Price:  102.67339996728326
curr_Factors:  [1.02673400e+02 3.62528093e-02]
mat_Sqrt:  [[ 1.95491904e+01  0.00000000e+00]
 [-7.61606820e-03  1.74506045e-02]]
grads:  [ 0.01350454 13.36082484]
Stock Position:  0.013504540671354856
Bond Position:  [-11.51221358]


portfolio before change:  [-10.14016416]
curr_Stock_Price:  101.81226177820719
curr_Factors:  [1.01812262e+02 3.45194787e-02]
mat_Sqrt:  [[ 1.89161261e+01  0.00000000e+00]
 [-7.43176735e-03  1.70283182e-02]]
grads:  [-0.01033917  5.71262128]
Stock Position:  -0.010339174830725384
Bond Position:  [-9.08750939]


portfolio before change:  [-10.13911557]
curr_Stock_Price:  101.49108022652865
curr_Factors:  [1.01491080e+02 3.45150152e-02]
mat_Sqrt:  [[ 1.88552333e+01  0.00000000e+00]
 [-7.43128685e-03  1.70272173e-02]]
grads:  [3.52290128e-04 2.31192815e+00]
Stock Position:  0.0003522901283571829
Bond Position:  [-10.17486988]


portfolio before change:  [-10.14173428]
curr_Stock_Price:  101.27911043466864
curr_Factors:  [1.01279110e+02 3.49918423e-02]
mat_Sqrt:  [[ 1.89453783e+01  0.00000000e+00]
 [-7.48244262e-03  1.71444299e-02]]
grads:  [ -0.02000705 -15.83784028]
Stock Position:  -0.020007051360891634
Bond Position:  [-8.11543792]


portfolio before change:  [-10.10789712]
curr_Stock_Price:  99.48642861454674
curr_Factors:  [9.94864286e+01 3.54735617e-02]
mat_Sqrt:  [[ 1.87376982e+01  0.00000000e+00]
 [-7.53377055e-03  1.72620369e-02]]
grads:  [-0.00739674 -6.87377316]
Stock Position:  -0.007396736622085283
Bond Position:  [-9.37202221]


portfolio before change:  [-10.11496561]
curr_Stock_Price:  100.12525089520011
curr_Factors:  [1.00125251e+02 3.66697651e-02]
mat_Sqrt:  [[ 1.91733359e+01  0.00000000e+00]
 [-7.65974048e-03  1.75506703e-02]]
grads:  [0.00620213 2.72843267]
Stock Position:  0.006202125901927011
Bond Position:  [-10.73595503]


portfolio before change:  [-10.12585524]
curr_Stock_Price:  98.80226924220007
curr_Factors:  [9.88022692e+01 3.68049909e-02]
mat_Sqrt:  [[ 1.89548467e+01  0.00000000e+00]
 [-7.67385076e-03  1.75830010e-02]]
grads:  [-1.10372339e-03 -3.26779313e+00]
Stock Position:  -0.0011037233905665828
Bond Position:  [-10.01680486]


portfolio before change:  [-10.12820342]
curr_Stock_Price:  98.66062487346287
curr_Factors:  [9.86606249e+01 3.45731735e-02]
mat_Sqrt:  [[ 1.83448213e+01  0.00000000e+00]
 [-7.43754514e-03  1.70415568e-02]]
grads:  [  0.02533307 -17.15356067]
Stock Position:  0.025333067912379374
Bond Position:  [-12.62757973]


portfolio before change:  [-10.06915366]
curr_Stock_Price:  101.11619179075063
curr_Factors:  [1.01116192e+02 3.22520076e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.06915366]
Stock Price:  99.99086295273555
PL:  [-10.06915366]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.73109328e-02  2.72074452e-01]
 [ 1.73235378e-01 -2.15155335e-02]
 [-1.38749907e-01 -4.07280352e-01]
 [ 8.59270416e-02  1.37320798e-01]
 [-2.43445849e-01 -9.43775110e-02]
 [ 5.23919321e-01 -6.86941890e-01]
 [-5.76004261e-01  4.16306037e-01]
 [ 3.28508432e-01  1.58493196e-01]
 [ 5.20084881e-02 -8.04810676e-02]
 [ 6.30043466e-02  2.07699736e-02]
 [ 1.83704410e-01  2.67412627e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-5.75498380e-02  9.14855510e-02]
 [-2.99607163e-01 -2.41399558e-01]
 [ 2.97785840e-02 -6.92760249e-02]
 [ 8.95521534e-02  1.40316939e-02]
 [-4.58585147e-02 -3.26986006e-02]
 [ 4.66080902e-01 -2.55487228e-01]
 [ 2.25025859e-01  1.22765411e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.10777098]
curr_Stock_Price:  101.66849368368224
curr_Factors:  [1.01668494e+02 3.86343079e-02]
mat_Sqrt:  [[ 1.99835645e+01  0.00000000e+00]
 [-7.86224476e-03  1.80146659e-02]]
grads:  [7.30870402e-03 1.51029419e+01]
Stock Position:  0.007308704024031013
Bond Position:  [13.36470605]


portfolio before change:  [14.12260061]
curr_Stock_Price:  103.24032353227234
curr_Factors:  [1.03240324e+02 3.76228426e-02]
mat_Sqrt:  [[ 2.00251215e+01  0.00000000e+00]
 [-7.75864345e-03  1.77772855e-02]]
grads:  [ 0.00818198 -1.21028228]
Stock Position:  0.008181984289989256
Bond Position:  [13.27788991]


portfolio before change:  [14.11586461]
curr_Stock_Price:  102.01129540161351
curr_Factors:  [1.02011295e+02 3.88407936e-02]
mat_Sqrt:  [[ 2.01044553e+01  0.00000000e+00]
 [-7.88322712e-03  1.80627425e-02]]
grads:  [-1.57428600e-02 -2.25480905e+01]
Stock Position:  -0.0157428600108807
Bond Position:  [15.72181415]


portfolio before change:  [14.14540626]
curr_Stock_Price:  100.3844815392092
curr_Factors:  [1.00384482e+02 4.11703865e-02]
mat_Sqrt:  [[ 2.03685002e+01  0.00000000e+00]
 [-8.11619482e-03  1.85965386e-02]]
grads:  [7.16099613e-03 7.38421280e+00]
Stock Position:  0.007160996126745504
Bond Position:  [13.42655338]


portfolio before change:  [14.15564189]
curr_Stock_Price:  101.34504268456698
curr_Factors:  [1.01345043e+02 4.11187343e-02]
mat_Sqrt:  [[ 2.05504993e+01  0.00000000e+00]
 [-8.11110195e-03  1.85848693e-02]]
grads:  [-0.01385054 -5.07819072]
Stock Position:  -0.01385054287336184
Bond Position:  [15.55932575]


portfolio before change:  [14.14622459]
curr_Stock_Price:  102.30584371939814
curr_Factors:  [1.02305844e+02 4.11583049e-02]
mat_Sqrt:  [[ 2.07553079e+01  0.00000000e+00]
 [-8.11500387e-03  1.85938097e-02]]
grads:  [ 1.07978789e-02 -3.69446552e+01]
Stock Position:  0.010797878877667207
Bond Position:  [13.04153848]


portfolio before change:  [14.15620948]
curr_Stock_Price:  102.92856692305796
curr_Factors:  [1.02928567e+02 3.92183673e-02]
mat_Sqrt:  [[ 2.03835903e+01  0.00000000e+00]
 [-7.92145111e-03  1.81503247e-02]]
grads:  [-1.93446496e-02  2.29365614e+01]
Stock Position:  -0.019344649591557257
Bond Position:  [16.14732654]


portfolio before change:  [14.17111669]
curr_Stock_Price:  102.36666069936162
curr_Factors:  [1.02366661e+02 4.03987154e-02]
mat_Sqrt:  [[ 2.05751170e+01  0.00000000e+00]
 [-8.03977267e-03  1.84214334e-02]]
grads:  [0.01932823 8.6037385 ]
Stock Position:  0.01932822707822039
Bond Position:  [12.19255063]


portfolio before change:  [14.20001055]
curr_Stock_Price:  103.70384200741518
curr_Factors:  [1.03703842e+02 3.91808311e-02]
mat_Sqrt:  [[ 2.05272924e+01  0.00000000e+00]
 [-7.91765936e-03  1.81416367e-02]]
grads:  [ 8.22498664e-04 -4.43626278e+00]
Stock Position:  0.0008224986642994584
Bond Position:  [14.11471428]


portfolio before change:  [14.20470343]
curr_Stock_Price:  105.11874390399534
curr_Factors:  [1.05118744e+02 3.80314845e-02]
mat_Sqrt:  [[ 2.04999028e+01  0.00000000e+00]
 [-7.80066505e-03  1.78735690e-02]]
grads:  [0.00351558 1.16204959]
Stock Position:  0.003515582826180293
Bond Position:  [13.83514978]


portfolio before change:  [14.20204476]
curr_Stock_Price:  103.37852436373576
curr_Factors:  [1.03378524e+02 3.93554511e-02]
mat_Sqrt:  [[ 2.05084471e+01  0.00000000e+00]
 [-7.93528334e-03  1.81820183e-02]]
grads:  [1.46482495e-02 1.47075326e+01]
Stock Position:  0.014648249460773921
Bond Position:  [12.68773035]


portfolio before change:  [14.217927]
curr_Stock_Price:  104.24619827022951
curr_Factors:  [1.04246198e+02 3.84301592e-02]
mat_Sqrt:  [[ 2.04360199e+01  0.00000000e+00]
 [-7.84144468e-03  1.79670069e-02]]
grads:  [-0.00924877  6.3635042 ]
Stock Position:  -0.009248765886820994
Bond Position:  [15.18207568]


portfolio before change:  [14.2149325]
curr_Stock_Price:  104.98040357020997
curr_Factors:  [1.04980404e+02 3.97799635e-02]
mat_Sqrt:  [[ 2.09382523e+01  0.00000000e+00]
 [-7.97796601e-03  1.82798166e-02]]
grads:  [-8.41630423e-04  5.00473025e+00]
Stock Position:  -0.0008416304228637703
Bond Position:  [14.3032872]


portfolio before change:  [14.2188064]
curr_Stock_Price:  104.62676520234959
curr_Factors:  [1.04626765e+02 3.90945856e-02]
mat_Sqrt:  [[ 2.06871710e+01  0.00000000e+00]
 [-7.90894032e-03  1.81216588e-02]]
grads:  [ -0.01957554 -13.3210519 ]
Stock Position:  -0.019575541141292053
Bond Position:  [16.26693194]


portfolio before change:  [14.28510542]
curr_Stock_Price:  101.44770712319902
curr_Factors:  [1.01447707e+02 4.05472307e-02]
mat_Sqrt:  [[ 2.04278582e+01  0.00000000e+00]
 [-8.05453718e-03  1.84552632e-02]]
grads:  [-2.23201096e-05 -3.75372729e+00]
Stock Position:  -2.2320109617552546e-05
Bond Position:  [14.28736974]


portfolio before change:  [14.28867271]
curr_Stock_Price:  101.67154951500433
curr_Factors:  [1.01671550e+02 4.05732257e-02]
mat_Sqrt:  [[ 2.04794935e+01  0.00000000e+00]
 [-8.05711866e-03  1.84611781e-02]]
grads:  [0.0046718  0.76006492]
Stock Position:  0.004671799465724314
Bond Position:  [13.81368362]


portfolio before change:  [14.2889022]
curr_Stock_Price:  100.98137267296575
curr_Factors:  [1.00981373e+02 4.13265769e-02]
mat_Sqrt:  [[ 2.05284419e+01  0.00000000e+00]
 [-8.13157568e-03  1.86317805e-02]]
grads:  [-0.00292908 -1.75499065]
Stock Position:  -0.002929075396958667
Bond Position:  [14.58468425]


portfolio before change:  [14.29347931]
curr_Stock_Price:  100.66370009370803
curr_Factors:  [1.00663700e+02 4.17676431e-02]
mat_Sqrt:  [[ 2.05727749e+01  0.00000000e+00]
 [-8.17485345e-03  1.87309424e-02]]
grads:  [  0.01723526 -13.63984914]
Stock Position:  0.017235260483930284
Bond Position:  [12.55851422]


portfolio before change:  [14.29382162]
curr_Stock_Price:  100.50137503307701
curr_Factors:  [1.00501375e+02 4.19289727e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.29382162]
Stock Price:  100.64921523250999
PL:  [13.64460639]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.56422548e-01 -5.27858268e-01]
 [ 1.25695607e-01  7.58909433e-02]
 [-4.78175663e-01 -1.27628211e-01]
 [ 3.39183258e-02  5.54648624e-03]
 [-3.47104259e-01  1.33219621e-01]
 [-9.08608402e-02  3.00836412e-02]
 [-2.23168721e-01  5.89997281e-02]
 [ 1.23289811e-01  1.30423408e-02]
 [-1.00800294e-01 -3.37789137e-02]
 [-9.88401155e-02 -9.99638741e-04]
 [ 3.34789666e-01 -5.12351009e-02]
 [ 1.77833702e-01  1.25897706e-01]
 [-3.14680395e-01 -9.41480348e-02]
 [ 8.04530289e-02  7.96771941e-02]
 [ 3.46466429e-02 -6.24309097e-02]
 [ 1.22506969e+00 -5.55510861e-01]
 [ 1.41951631e-01  1.96719684e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.80269767]
curr_Stock_Price:  98.77842365243689
curr_Factors:  [9.87784237e+01 4.11503728e-02]
mat_Sqrt:  [[ 2.00377511e+01  0.00000000e+00]
 [-8.11422186e-03  1.85920179e-02]]
grads:  [ 0.00139095 -0.07265668]
Stock Position:  0.0013909533782715496
Bond Position:  [-5.94009385]


portfolio before change:  [-5.80371426]
curr_Stock_Price:  99.11532532174284
curr_Factors:  [9.91153253e+01 4.20801860e-02]
mat_Sqrt:  [[ 2.03319782e+01  0.00000000e+00]
 [-8.20538224e-03  1.88008926e-02]]
grads:  [-0.00916413 -3.54514924]
Stock Position:  -0.009164128937210097
Bond Position:  [-4.89540864]


portfolio before change:  [-5.82247138]
curr_Stock_Price:  101.0285583228952
curr_Factors:  [1.01028558e+02 4.17182332e-02]
mat_Sqrt:  [[ 2.06351253e+01  0.00000000e+00]
 [-8.17001671e-03  1.87198600e-02]]
grads:  [-1.87446782e-02 -2.81977679e+01]
Stock Position:  -0.01874467822096478
Bond Position:  [-3.92872357]


portfolio before change:  [-5.82008838]
curr_Stock_Price:  100.84902420777075
curr_Factors:  [1.00849024e+02 4.19193654e-02]
mat_Sqrt:  [[ 2.06480503e+01  0.00000000e+00]
 [-8.18968771e-03  1.87649319e-02]]
grads:  [0.00769163 4.04429622]
Stock Position:  0.007691628400366789
Bond Position:  [-6.5957816]


portfolio before change:  [-5.83634383]
curr_Stock_Price:  98.95003735916104
curr_Factors:  [9.89500374e+01 4.23342972e-02]
mat_Sqrt:  [[ 2.03592671e+01  0.00000000e+00]
 [-8.23012002e-03  1.88575740e-02]]
grads:  [-0.02622281 -6.76800796]
Stock Position:  -0.026222809399143357
Bond Position:  [-3.24159586]


portfolio before change:  [-5.81177383]
curr_Stock_Price:  97.98215839752183
curr_Factors:  [9.79821584e+01 4.52764220e-02]
mat_Sqrt:  [[ 2.08488955e+01  0.00000000e+00]
 [-8.51130279e-03  1.95018447e-02]]
grads:  [0.00174297 0.28440829]
Stock Position:  0.0017429705543185977
Bond Position:  [-5.98255384]


portfolio before change:  [-5.81450595]
curr_Stock_Price:  97.27285250749718
curr_Factors:  [9.72728525e+01 4.49863338e-02]
mat_Sqrt:  [[ 2.06315545e+01  0.00000000e+00]
 [-8.48399282e-03  1.94392696e-02]]
grads:  [-0.01400585  6.85311864]
Stock Position:  -0.014005849608431575
Bond Position:  [-4.45211701]


portfolio before change:  [-5.77320915]
curr_Stock_Price:  94.24483427026092
curr_Factors:  [9.42448343e+01 4.82806268e-02]
mat_Sqrt:  [[ 2.07082789e+01  0.00000000e+00]
 [-8.78914119e-03  2.01384524e-02]]
grads:  [-0.00375363  1.49384077]
Stock Position:  -0.0037536322187251767
Bond Position:  [-5.4194487]


portfolio before change:  [-5.78059032]
curr_Stock_Price:  95.85024955855545
curr_Factors:  [9.58502496e+01 4.76542257e-02]
mat_Sqrt:  [[ 2.09239636e+01  0.00000000e+00]
 [-8.73193914e-03  2.00073860e-02]]
grads:  [-0.00943507  2.94889737]
Stock Position:  -0.009435073219879452
Bond Position:  [-4.8762362]


portfolio before change:  [-5.7665033]
curr_Stock_Price:  94.22798036597162
curr_Factors:  [9.42279804e+01 4.71687891e-02]
mat_Sqrt:  [[ 2.04647878e+01  0.00000000e+00]
 [-8.68735072e-03  1.99052211e-02]]
grads:  [0.00630263 0.6552221 ]
Stock Position:  0.0063026284881188945
Bond Position:  [-6.36038726]


portfolio before change:  [-5.77586292]
curr_Stock_Price:  92.99526954673146
curr_Factors:  [9.29952695e+01 4.86466215e-02]
mat_Sqrt:  [[ 2.05110172e+01  0.00000000e+00]
 [-8.82239164e-03  2.02146388e-02]]
grads:  [-0.0056332  -1.67101248]
Stock Position:  -0.005633197984401356
Bond Position:  [-5.25200215]


portfolio before change:  [-5.77784249]
curr_Stock_Price:  93.11357041051585
curr_Factors:  [9.31135704e+01 4.96358797e-02]
mat_Sqrt:  [[ 2.07448759e+01  0.00000000e+00]
 [-8.91164449e-03  2.04191427e-02]]
grads:  [-0.00478559 -0.04895596]
Stock Position:  -0.004785586283236289
Bond Position:  [-5.33223947]


portfolio before change:  [-5.76856893]
curr_Stock_Price:  90.89716627268906
curr_Factors:  [9.08971663e+01 4.94157065e-02]
mat_Sqrt:  [[ 2.02061163e+01  0.00000000e+00]
 [-8.89185753e-03  2.03738051e-02]]
grads:  [ 0.01546209 -2.51475366]
Stock Position:  0.015462092277383556
Bond Position:  [-7.1740293]


portfolio before change:  [-5.77713681]
curr_Stock_Price:  90.45905257362392
curr_Factors:  [9.04590526e+01 4.98897804e-02]
mat_Sqrt:  [[ 2.02049524e+01  0.00000000e+00]
 [-8.93440813e-03  2.04713008e-02]]
grads:  [0.01152094 6.14996122]
Stock Position:  0.011520936099506444
Bond Position:  [-6.81930978]


portfolio before change:  [-5.78439683]
curr_Stock_Price:  89.97688867084719
curr_Factors:  [8.99768887e+01 4.95295773e-02]
mat_Sqrt:  [[ 2.00245739e+01  0.00000000e+00]
 [-8.90209659e-03  2.03972657e-02]]
grads:  [-0.01776667 -4.6157184 ]
Stock Position:  -0.017766668542546188
Bond Position:  [-4.18580728]


portfolio before change:  [-5.7877806]
curr_Stock_Price:  90.10843762349558
curr_Factors:  [9.01084376e+01 4.90889872e-02]
mat_Sqrt:  [[ 1.99644567e+01  0.00000000e+00]
 [-8.86241387e-03  2.03063412e-02]]
grads:  [0.00577161 3.92375925]
Stock Position:  0.005771607469083301
Bond Position:  [-6.30785113]


portfolio before change:  [-5.77582242]
curr_Stock_Price:  92.45359697285211
curr_Factors:  [9.24535970e+01 4.70747234e-02]
mat_Sqrt:  [[ 2.00593890e+01  0.00000000e+00]
 [-8.67868408e-03  1.98853634e-02]]
grads:  [ 3.68882626e-04 -3.13954080e+00]
Stock Position:  0.0003688826262499675
Bond Position:  [-5.80992695]


portfolio before change:  [-5.77746902]
curr_Stock_Price:  91.92787389131274
curr_Factors:  [9.19278739e+01 4.57708264e-02]
mat_Sqrt:  [[ 1.96671574e+01  0.00000000e+00]
 [-8.55764700e-03  1.96080326e-02]]
grads:  [  0.04996273 -28.33078018]
Stock Position:  0.04996272977221621
Bond Position:  [-10.37043654]


portfolio before change:  [-5.74663007]
curr_Stock_Price:  92.59701019176241
curr_Factors:  [9.25970102e+01 4.37753142e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.74663007]
Stock Price:  94.5665477295371
PL:  [-5.74663007]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-9.69225587e-02  8.53816695e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.77184515e-01 -6.69514214e-01]
 [-2.24045241e-02  2.77282963e-01]
 [-4.16611407e-01 -6.48972779e-02]
 [ 2.65086336e-01 -7.42506610e-02]
 [-2.22111977e-01  6.46833864e-02]
 [-5.15233486e-02  1.52710408e-01]
 [-2.39898016e-01  1.30359488e-01]
 [ 1.30955638e-01  1.25619838e-02]
 [-1.05259093e-01 -4.84679290e-02]
 [-1.16987044e-01  9.80496616e-03]
 [ 1.25186901e-01 -1.49366897e-02]
 [ 3.33274315e-02 -8.86053894e-02]
 [-1.38784083e-01 -1.43583017e-01]
 [ 9.84468646e-02  4.68266687e-02]
 [-4.77542881e-02 -3.17576988e-02]
 [ 3.55668012e-01 -2.23367089e-01]
 [ 2.03451464e-01  8.98323536e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.22301544]
curr_Stock_Price:  100.37884218626101
curr_Factors:  [1.00378842e+02 4.09118892e-02]
mat_Sqrt:  [[ 2.03033148e+01  0.00000000e+00]
 [-8.09067504e-03  1.85380654e-02]]
grads:  [-2.93838438e-03  4.60574864e+00]
Stock Position:  -0.002938384378940986
Bond Position:  [5.51796707]


portfolio before change:  [5.22333254]
curr_Stock_Price:  100.74045733595864
curr_Factors:  [1.00740457e+02 4.02068272e-02]
mat_Sqrt:  [[ 2.02001140e+01  0.00000000e+00]
 [-8.02065605e-03  1.83776317e-02]]
grads:  [-0.00922395 -3.62679866]
Stock Position:  -0.009223951430300574
Bond Position:  [6.15255763]


portfolio before change:  [5.23306731]
curr_Stock_Price:  99.85185439686775
curr_Factors:  [9.98518544e+01 4.05928526e-02]
mat_Sqrt:  [[ 2.01178201e+01  0.00000000e+00]
 [-8.05906721e-03  1.84656427e-02]]
grads:  [-2.33317760e-02 -3.62572927e+01]
Stock Position:  -0.023331776047002067
Bond Position:  [7.56278841]


portfolio before change:  [5.25578526]
curr_Stock_Price:  98.95920829847206
curr_Factors:  [9.89592083e+01 4.27252729e-02]
mat_Sqrt:  [[ 2.04549600e+01  0.00000000e+00]
 [-8.26803705e-03  1.89444528e-02]]
grads:  [4.82091787e-03 1.46366309e+01]
Stock Position:  0.004820917870038549
Bond Position:  [4.77871104]


portfolio before change:  [5.24858725]
curr_Stock_Price:  97.21828814255272
curr_Factors:  [9.72182881e+01 4.19716762e-02]
mat_Sqrt:  [[ 1.99171010e+01  0.00000000e+00]
 [-8.19479603e-03  1.87766366e-02]]
grads:  [-0.02233934 -3.45627811]
Stock Position:  -0.02233934043830779
Bond Position:  [7.42037969]


portfolio before change:  [5.30813939]
curr_Stock_Price:  94.63554336492626
curr_Factors:  [9.46355434e+01 4.32139096e-02]
mat_Sqrt:  [[ 1.96727947e+01  0.00000000e+00]
 [-8.31518222e-03  1.90524760e-02]]
grads:  [ 0.01182754 -3.89716597]
Stock Position:  0.011827536179681216
Bond Position:  [4.18883408]


portfolio before change:  [5.30552564]
curr_Stock_Price:  94.32600354010373
curr_Factors:  [9.43260035e+01 4.30401649e-02]
mat_Sqrt:  [[ 1.95689894e+01  0.00000000e+00]
 [-8.29844949e-03  1.90141365e-02]]
grads:  [-0.00990761  3.40185769]
Stock Position:  -0.009907605790191456
Bond Position:  [6.2400705]


portfolio before change:  [5.29795259]
curr_Stock_Price:  95.24784731419685
curr_Factors:  [9.52478473e+01 4.31588855e-02]
mat_Sqrt:  [[ 1.97874705e+01  0.00000000e+00]
 [-8.30988669e-03  1.90403424e-02]]
grads:  [7.64369424e-04 8.02036039e+00]
Stock Position:  0.0007643694237252957
Bond Position:  [5.22514805]


portfolio before change:  [5.29774712]
curr_Stock_Price:  93.26985095779303
curr_Factors:  [9.32698510e+01 4.53471601e-02]
mat_Sqrt:  [[ 1.98616960e+01  0.00000000e+00]
 [-8.51794905e-03  1.95170732e-02]]
grads:  [-0.00921394  6.67925393]
Stock Position:  -0.009213939812904358
Bond Position:  [6.15712991]


portfolio before change:  [5.28852689]
curr_Stock_Price:  94.437614658351
curr_Factors:  [9.44376147e+01 4.44638117e-02]
mat_Sqrt:  [[ 1.99135346e+01  0.00000000e+00]
 [-8.43457756e-03  1.93260451e-02]]
grads:  [0.00685153 0.65000282]
Stock Position:  0.006851527871320119
Bond Position:  [4.64148494]


portfolio before change:  [5.28694735]
curr_Stock_Price:  94.03769606387044
curr_Factors:  [9.40376961e+01 4.58825257e-02]
mat_Sqrt:  [[ 2.01430689e+01  0.00000000e+00]
 [-8.56808270e-03  1.96319438e-02]]
grads:  [-0.00627572 -2.46882986]
Stock Position:  -0.006275718555611936
Bond Position:  [5.87710147]


portfolio before change:  [5.29002134]
curr_Stock_Price:  93.78202293400372
curr_Factors:  [9.37820229e+01 4.69318772e-02]
mat_Sqrt:  [[ 2.03167183e+01  0.00000000e+00]
 [-8.66550654e-03  1.98551698e-02]]
grads:  [-0.00554754  0.49382434]
Stock Position:  -0.005547539925752656
Bond Position:  [5.81028086]


portfolio before change:  [5.29231669]
curr_Stock_Price:  93.63013597076325
curr_Factors:  [9.36301360e+01 4.83338082e-02]
mat_Sqrt:  [[ 2.05845398e+01  0.00000000e+00]
 [-8.79398051e-03  2.01495407e-02]]
grads:  [ 0.00576491 -0.74129182]
Stock Position:  0.005764908816717714
Bond Position:  [4.7525475]


portfolio before change:  [5.29355114]
curr_Stock_Price:  93.63814300706652
curr_Factors:  [9.36381430e+01 4.88571853e-02]
mat_Sqrt:  [[ 2.06974582e+01  0.00000000e+00]
 [-8.84146461e-03  2.02583404e-02]]
grads:  [-2.58153960e-04 -4.37377335e+00]
Stock Position:  -0.0002581539601774177
Bond Position:  [5.3177242]


portfolio before change:  [5.29399191]
curr_Stock_Price:  97.08114054988278
curr_Factors:  [9.70811405e+01 4.67657981e-02]
mat_Sqrt:  [[ 2.09941862e+01  0.00000000e+00]
 [-8.65016052e-03  1.98200077e-02]]
grads:  [-0.00959546 -7.24434719]
Stock Position:  -0.00959545880835598
Bond Position:  [6.22553]


portfolio before change:  [5.26551247]
curr_Stock_Price:  100.21137347593773
curr_Factors:  [1.00211373e+02 4.52781184e-02]
mat_Sqrt:  [[ 2.13236330e+01  0.00000000e+00]
 [-8.51146224e-03  1.95022100e-02]]
grads:  [0.00557521 2.4010955 ]
Stock Position:  0.0055752084166378075
Bond Position:  [4.70681318]


portfolio before change:  [5.2714265]
curr_Stock_Price:  101.06105979579668
curr_Factors:  [1.01061060e+02 4.36386544e-02]
mat_Sqrt:  [[ 2.11115210e+01  0.00000000e+00]
 [-8.35594680e-03  1.91458794e-02]]
grads:  [-0.00291852 -1.65872239]
Stock Position:  -0.0029185241643958607
Bond Position:  [5.56637564]


portfolio before change:  [5.26880637]
curr_Stock_Price:  102.4356910795077
curr_Factors:  [1.02435691e+02 4.30537045e-02]
mat_Sqrt:  [[ 2.12547776e+01  0.00000000e+00]
 [-8.29975465e-03  1.90171270e-02]]
grads:  [  0.01214704 -11.74557488]
Stock Position:  0.012147039474883345
Bond Position:  [4.02451599]


portfolio before change:  [5.26120955]
curr_Stock_Price:  101.72744625279398
curr_Factors:  [1.01727446e+02 4.35149613e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.26120955]
Stock Price:  102.8868520159824
PL:  [2.37435753]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.76465842e-01 -6.64610808e-01]
 [-1.17662436e-02  2.73371406e-01]
 [-3.93634163e-01 -1.13884604e-01]
 [ 2.36092639e-01 -2.57126552e-01]
 [-3.86470151e-01  1.54379323e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.42512641e-01  5.57158598e-03]
 [-9.85038848e-03  6.71207522e-02]
 [-2.36688519e-01  7.10877854e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.20883536e-01 -2.70488099e-01]
 [-1.04668666e-01 -1.27219907e-01]
 [ 8.92450574e-02  1.49217364e-02]
 [-5.25684145e-02  1.50988934e-02]
 [ 3.61710721e-01 -2.25124337e-01]
 [ 1.31777689e-01  3.01565239e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.26830893]
curr_Stock_Price:  99.29145180644299
curr_Factors:  [9.92914518e+01 4.07488003e-02]
mat_Sqrt:  [[ 2.00433022e+01  0.00000000e+00]
 [-8.07453284e-03  1.85010790e-02]]
grads:  [ 0.00139057 -0.07301381]
Stock Position:  0.001390568147614503
Bond Position:  [-2.40638046]


portfolio before change:  [-2.26889115]
curr_Stock_Price:  99.3054386353884
curr_Factors:  [9.93054386e+01 4.21746289e-02]
mat_Sqrt:  [[ 2.03938241e+01  0.00000000e+00]
 [-8.21458497e-03  1.88219787e-02]]
grads:  [-0.00913634 -3.54117764]
Stock Position:  -0.009136338013766907
Bond Position:  [-1.3616031]


portfolio before change:  [-2.27466812]
curr_Stock_Price:  99.90048244224675
curr_Factors:  [9.99004824e+01 4.25882098e-02]
mat_Sqrt:  [[ 2.06163737e+01  0.00000000e+00]
 [-8.25476442e-03  1.89140414e-02]]
grads:  [-2.26288961e-02 -3.51384875e+01]
Stock Position:  -0.022628896098945566
Bond Position:  [-0.01403048]


portfolio before change:  [-2.25704015]
curr_Stock_Price:  99.12132504886921
curr_Factors:  [9.91213250e+01 4.30447791e-02]
mat_Sqrt:  [[ 2.05649350e+01  0.00000000e+00]
 [-8.29889430e-03  1.90151557e-02]]
grads:  [5.22942666e-03 1.43765011e+01]
Stock Position:  0.005229426662284308
Bond Position:  [-2.77538785]


portfolio before change:  [-2.25381424]
curr_Stock_Price:  99.87089980426633
curr_Factors:  [9.98708998e+01 4.40507951e-02]
mat_Sqrt:  [[ 2.09611854e+01  0.00000000e+00]
 [-8.39531251e-03  1.92360775e-02]]
grads:  [-0.0211504  -5.92036518]
Stock Position:  -0.021150401146349973
Bond Position:  [-0.14150465]


portfolio before change:  [-2.23762265]
curr_Stock_Price:  99.10368163279304
curr_Factors:  [9.91036816e+01 4.57598187e-02]
mat_Sqrt:  [[ 2.11998084e+01  0.00000000e+00]
 [-8.55661790e-03  1.96056746e-02]]
grads:  [ 5.84313825e-03 -1.31149046e+01]
Stock Position:  0.005843138253680688
Bond Position:  [-2.81669916]


portfolio before change:  [-2.24383511]
curr_Stock_Price:  98.16100355380013
curr_Factors:  [9.81610036e+01 4.61114969e-02]
mat_Sqrt:  [[ 2.10786892e+01  0.00000000e+00]
 [-8.58943508e-03  1.96808682e-02]]
grads:  [-0.0151382   7.84413174]
Stock Position:  -0.015138203692630862
Bond Position:  [-0.75785384]


portfolio before change:  [-2.26145729]
curr_Stock_Price:  99.31257334272723
curr_Factors:  [9.93125733e+01 4.78802496e-02]
mat_Sqrt:  [[ 2.17311364e+01  0.00000000e+00]
 [-8.75262243e-03  2.00547774e-02]]
grads:  [4.50069193e-03 6.76741416e+00]
Stock Position:  0.00450069192780871
Bond Position:  [-2.70843259]


portfolio before change:  [-2.2585464]
curr_Stock_Price:  100.10980373997808
curr_Factors:  [1.00109804e+02 4.72214994e-02]
mat_Sqrt:  [[ 2.17543693e+01  0.00000000e+00]
 [-8.69220335e-03  1.99163399e-02]]
grads:  [-0.01000171 -2.66860836]
Stock Position:  -0.010001708980132218
Bond Position:  [-1.25727728]


portfolio before change:  [-2.24322617]
curr_Stock_Price:  98.54661255883309
curr_Factors:  [9.85466126e+01 4.80562513e-02]
mat_Sqrt:  [[ 2.16031283e+01  0.00000000e+00]
 [-8.76869443e-03  2.00916030e-02]]
grads:  [0.01133837 0.27730918]
Stock Position:  0.011338370844894332
Bond Position:  [-3.36058421]


portfolio before change:  [-2.2446535]
curr_Stock_Price:  98.49483468142485
curr_Factors:  [9.84948347e+01 4.91973708e-02]
mat_Sqrt:  [[ 2.18466274e+01  0.00000000e+00]
 [-8.87219214e-03  2.03287460e-02]]
grads:  [8.90000502e-04 3.30176550e+00]
Stock Position:  0.000890000501743758
Bond Position:  [-2.33231395]


portfolio before change:  [-2.24388967]
curr_Stock_Price:  100.00829829902838
curr_Factors:  [1.00008298e+02 4.70146767e-02]
mat_Sqrt:  [[ 2.16846674e+01  0.00000000e+00]
 [-8.67314722e-03  1.98726768e-02]]
grads:  [-0.00948427  3.57716205]
Stock Position:  -0.009484271215563264
Bond Position:  [-1.29538384]


portfolio before change:  [-2.25627555]
curr_Stock_Price:  101.28008769200306
curr_Factors:  [1.01280088e+02 4.63062689e-02]
mat_Sqrt:  [[ 2.17943521e+01  0.00000000e+00]
 [-8.60755658e-03  1.97223898e-02]]
grads:  [3.04781372e-04 1.99599051e+00]
Stock Position:  0.0003047813720196465
Bond Position:  [-2.28714384]


portfolio before change:  [-2.25718767]
curr_Stock_Price:  100.16367822053321
curr_Factors:  [1.00163678e+02 4.64882094e-02]
mat_Sqrt:  [[ 2.15964155e+01  0.00000000e+00]
 [-8.62444984e-03  1.97610971e-02]]
grads:  [ -0.015694   -13.68790903]
Stock Position:  -0.015694003548486202
Bond Position:  [-0.68521855]


portfolio before change:  [-2.22885279]
curr_Stock_Price:  98.34730269219904
curr_Factors:  [9.83473027e+01 4.64073250e-02]
mat_Sqrt:  [[ 2.11863294e+01  0.00000000e+00]
 [-8.61694377e-03  1.97438986e-02]]
grads:  [-0.0075611  -6.44350488]
Stock Position:  -0.00756110140570853
Bond Position:  [-1.48523886]


portfolio before change:  [-2.25563174]
curr_Stock_Price:  101.83986162747841
curr_Factors:  [1.01839862e+02 4.62412212e-02]
mat_Sqrt:  [[ 2.18994117e+01  0.00000000e+00]
 [-8.60150881e-03  1.97085326e-02]]
grads:  [0.0043726  0.75712062]
Stock Position:  0.00437260317385993
Bond Position:  [-2.70093704]


portfolio before change:  [-2.25402456]
curr_Stock_Price:  102.361862403863
curr_Factors:  [1.02361862e+02 4.60501605e-02]
mat_Sqrt:  [[ 2.19661403e+01  0.00000000e+00]
 [-8.58372045e-03  1.96677744e-02]]
grads:  [-0.00209316  0.7676971 ]
Stock Position:  -0.002093163229265329
Bond Position:  [-2.03976447]


portfolio before change:  [-2.2544886]
curr_Stock_Price:  102.33990431792847
curr_Factors:  [1.02339904e+02 4.25895093e-02]
mat_Sqrt:  [[ 2.11201172e+01  0.00000000e+00]
 [-8.25489036e-03  1.89143300e-02]]
grads:  [  0.01247429 -11.90231626]
Stock Position:  0.012474287057621401
Bond Position:  [-3.53110594]


portfolio before change:  [-2.23482051]
curr_Stock_Price:  103.98737130124478
curr_Factors:  [1.03987371e+02 4.11194618e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.23482051]
Stock Price:  103.40487247268196
PL:  [-5.63969298]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-4.77341881e-02  1.59299851e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.99292668e-01 -8.20354993e-01]
 [ 1.03378741e-01  1.10363676e-01]
 [-2.90812428e-01 -1.00084216e-01]
 [ 3.89503328e-01 -4.78098830e-01]
 [-4.97373475e-01  2.11097748e-01]
 [ 2.59340385e-01  1.53060106e-01]
 [-1.82700488e-01 -4.83983966e-02]
 [ 2.38332838e-01  1.12295963e-02]
 [ 1.04814908e-01  1.73328588e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-2.31319404e-02  6.60591291e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 1.85421776e-01  1.02354947e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.24652072e-02  9.46961213e-02]
 [ 1.69094274e-01 -3.46995823e-02]
 [ 7.07447847e-02 -2.04345900e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.74119169]
curr_Stock_Price:  100.88951704310145
curr_Factors:  [1.00889517e+02 4.01268600e-02]
mat_Sqrt:  [[ 2.02098752e+01  0.00000000e+00]
 [-8.01267595e-03  1.83593470e-02]]
grads:  [1.07818413e-03 8.67677105e+00]
Stock Position:  0.0010781841264308103
Bond Position:  [8.63241421]


portfolio before change:  [8.74262143]
curr_Stock_Price:  100.2137183610884
curr_Factors:  [1.00213718e+02 4.09550681e-02]
mat_Sqrt:  [[ 2.02806095e+01  0.00000000e+00]
 [-8.09494342e-03  1.85478455e-02]]
grads:  [-0.00918734 -3.5935155 ]
Stock Position:  -0.009187340759158705
Bond Position:  [9.66331901]


portfolio before change:  [8.75890631]
curr_Stock_Price:  98.7041685467807
curr_Factors:  [9.87041685e+01 4.14948673e-02]
mat_Sqrt:  [[ 2.01063244e+01  0.00000000e+00]
 [-8.14811559e-03  1.86696782e-02]]
grads:  [-2.77188873e-02 -4.39404998e+01]
Stock Position:  -0.02771888733353918
Bond Position:  [11.49487603]


portfolio before change:  [8.70955405]
curr_Stock_Price:  100.58831095500442
curr_Factors:  [1.00588311e+02 4.15378401e-02]
mat_Sqrt:  [[ 2.05007368e+01  0.00000000e+00]
 [-8.15233367e-03  1.86793431e-02]]
grads:  [0.00739219 5.90832749]
Stock Position:  0.007392192765912707
Bond Position:  [7.96598587]


portfolio before change:  [8.71381567]
curr_Stock_Price:  100.8953738418165
curr_Factors:  [1.00895374e+02 4.15239459e-02]
mat_Sqrt:  [[ 2.05598794e+01  0.00000000e+00]
 [-8.15097009e-03  1.86762187e-02]]
grads:  [-0.0162692  -5.35891218]
Stock Position:  -0.016269198621058217
Bond Position:  [10.35530254]


portfolio before change:  [8.72067482]
curr_Stock_Price:  100.63291467437105
curr_Factors:  [1.00632915e+02 4.12110933e-02]
mat_Sqrt:  [[ 2.04290005e+01  0.00000000e+00]
 [-8.12020623e-03  1.86057299e-02]]
grads:  [ 8.85231225e-03 -2.56963223e+01]
Stock Position:  0.008852312248209612
Bond Position:  [7.82984083]


portfolio before change:  [8.71498326]
curr_Stock_Price:  99.76881722051182
curr_Factors:  [9.97688172e+01 4.03475406e-02]
mat_Sqrt:  [[ 2.00402603e+01  0.00000000e+00]
 [-8.03467890e-03  1.84097621e-02]]
grads:  [-0.02022144 11.46662006]
Stock Position:  -0.020221437206473663
Bond Position:  [10.73245213]


portfolio before change:  [8.6791936]
curr_Stock_Price:  101.67140763460154
curr_Factors:  [1.01671408e+02 3.86100696e-02]
mat_Sqrt:  [[ 1.99778675e+01  0.00000000e+00]
 [-7.85977807e-03  1.80090140e-02]]
grads:  [0.01632513 8.4990831 ]
Stock Position:  0.016325130411147432
Bond Position:  [7.01939461]


portfolio before change:  [8.67564179]
curr_Stock_Price:  101.34633374939966
curr_Factors:  [1.01346334e+02 4.05167126e-02]
mat_Sqrt:  [[ 2.03997640e+01  0.00000000e+00]
 [-8.05150546e-03  1.84483166e-02]]
grads:  [-0.00999145 -2.62345869]
Stock Position:  -0.009991452868389518
Bond Position:  [9.68823891]


portfolio before change:  [8.67053956]
curr_Stock_Price:  102.09943657055996
curr_Factors:  [1.02099437e+02 3.85212758e-02]
mat_Sqrt:  [[ 2.00388907e+01  0.00000000e+00]
 [-7.85073508e-03  1.79882939e-02]]
grads:  [0.01213809 0.62427245]
Stock Position:  0.012138088842805584
Bond Position:  [7.43124753]


portfolio before change:  [8.65491743]
curr_Stock_Price:  100.6593271558735
curr_Factors:  [1.00659327e+02 3.84407405e-02]
mat_Sqrt:  [[ 1.97355801e+01  0.00000000e+00]
 [-7.84252413e-03  1.79694802e-02]]
grads:  [9.14397780e-03 9.64572074e+00]
Stock Position:  0.009143977795049574
Bond Position:  [7.73449078]


portfolio before change:  [8.68051444]
curr_Stock_Price:  103.24716630917857
curr_Factors:  [1.03247166e+02 3.93654556e-02]
mat_Sqrt:  [[ 2.04849912e+01  0.00000000e+00]
 [-7.93629189e-03  1.81843292e-02]]
grads:  [-0.00922666  6.28745349]
Stock Position:  -0.009226655840427261
Bond Position:  [9.63314051]


portfolio before change:  [8.68202022]
curr_Stock_Price:  103.34501406493239
curr_Factors:  [1.03345014e+02 4.10957189e-02]
mat_Sqrt:  [[ 2.09501829e+01  0.00000000e+00]
 [-8.10883162e-03  1.85796674e-02]]
grads:  [2.72008467e-04 3.55545273e+00]
Stock Position:  0.0002720084668640439
Bond Position:  [8.6539095]


portfolio before change:  [8.68420279]
curr_Stock_Price:  103.41420860883534
curr_Factors:  [1.03414209e+02 4.08659167e-02]
mat_Sqrt:  [[ 2.09055133e+01  0.00000000e+00]
 [-8.08612805e-03  1.85276469e-02]]
grads:  [ -0.01965226 -13.46470972]
Stock Position:  -0.019652259929423745
Bond Position:  [10.71652569]


portfolio before change:  [8.65876349]
curr_Stock_Price:  104.8450246091816
curr_Factors:  [1.04845025e+02 3.92570739e-02]
mat_Sqrt:  [[ 2.07733620e+01  0.00000000e+00]
 [-7.92535919e-03  1.81592792e-02]]
grads:  [0.01107636 5.63650935]
Stock Position:  0.011076355267760393
Bond Position:  [7.49746274]


portfolio before change:  [8.64620279]
curr_Stock_Price:  103.54177130627897
curr_Factors:  [1.03541771e+02 3.77020836e-02]
mat_Sqrt:  [[ 2.01047310e+01  0.00000000e+00]
 [-7.76680975e-03  1.77959968e-02]]
grads:  [0.00477479 0.98511232]
Stock Position:  0.004774793072501555
Bond Position:  [8.15181226]


portfolio before change:  [8.65199963]
curr_Stock_Price:  104.3289530672922
curr_Factors:  [1.04328953e+02 3.68978114e-02]
mat_Sqrt:  [[ 2.00403431e+01  0.00000000e+00]
 [-7.68352121e-03  1.76051588e-02]]
grads:  [-5.55700646e-04  5.37888482e+00]
Stock Position:  -0.0005557006462597009
Bond Position:  [8.70997529]


portfolio before change:  [8.65315634]
curr_Stock_Price:  106.16636481614123
curr_Factors:  [1.06166365e+02 3.66916212e-02]
mat_Sqrt:  [[ 2.03362278e+01  0.00000000e+00]
 [-7.66202283e-03  1.75558998e-02]]
grads:  [ 0.00757024 -1.97651973]
Stock Position:  0.007570240501123573
Bond Position:  [7.84945143]


portfolio before change:  [8.65304768]
curr_Stock_Price:  105.89275821030267
curr_Factors:  [1.05892758e+02 3.64536234e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.65304768]
Stock Price:  106.4645369345261
PL:  [2.18851075]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-9.88995544e-02  5.00631220e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.99097364e-01 -8.19022465e-01]
 [-2.09982306e-02  2.77325848e-01]
 [-4.30093017e-01 -9.55059373e-02]
 [-4.25255353e-02  1.14576239e-01]
 [-2.72876571e-01  9.25188181e-02]
 [-5.42106685e-02  1.52272410e-01]
 [-2.11106109e-01  1.20011017e-02]
 [ 1.96474048e-01  8.45646161e-03]
 [-4.49839017e-02  3.26042682e-02]
 [-2.34396045e-01  6.94926446e-02]
 [-3.78924067e-02  3.68072443e-02]
 [-2.31749986e-01 -2.73544852e-01]
 [-8.77840137e-02 -1.19121356e-01]
 [ 9.14055011e-02  5.34318638e-02]
 [-3.91346219e-03 -5.34485938e-02]
 [ 6.59470293e-01 -3.20726124e-01]
 [ 1.61961142e-01  1.50140720e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.67225583]
curr_Stock_Price:  100.15374432559112
curr_Factors:  [1.00153744e+02 4.10546452e-02]
mat_Sqrt:  [[ 2.02930975e+01  0.00000000e+00]
 [-8.10477837e-03  1.85703802e-02]]
grads:  [-0.00379687  2.69585876]
Stock Position:  -0.0037968682040989067
Bond Position:  [4.05252639]


portfolio before change:  [3.67480281]
curr_Stock_Price:  99.74979938638583
curr_Factors:  [9.97497994e+01 4.05002329e-02]
mat_Sqrt:  [[ 2.00743176e+01  0.00000000e+00]
 [-8.04986787e-03  1.84445644e-02]]
grads:  [-0.00928175 -3.61363753]
Stock Position:  -0.009281753618457303
Bond Position:  [4.60065587]


portfolio before change:  [3.68552512]
curr_Stock_Price:  98.71852867023904
curr_Factors:  [9.87185287e+01 4.23064540e-02]
mat_Sqrt:  [[ 2.03049529e+01  0.00000000e+00]
 [-8.22741310e-03  1.88513717e-02]]
grads:  [-2.74094737e-02 -4.34463062e+01]
Stock Position:  -0.027409473718465617
Bond Position:  [6.39134804]


portfolio before change:  [3.67976084]
curr_Stock_Price:  98.98713353846584
curr_Factors:  [9.89871335e+01 4.18625821e-02]
mat_Sqrt:  [[ 2.02531115e+01  0.00000000e+00]
 [-8.18413901e-03  1.87522183e-02]]
grads:  [4.93932462e-03 1.47889623e+01]
Stock Position:  0.004939324623392244
Bond Position:  [3.19083125]


portfolio before change:  [3.67799524]
curr_Stock_Price:  98.46815553150016
curr_Factors:  [9.84681555e+01 4.30262520e-02]
mat_Sqrt:  [[ 2.04250233e+01  0.00000000e+00]
 [-8.29710812e-03  1.90110630e-02]]
grads:  [-0.0230979  -5.02370316]
Stock Position:  -0.02309790384489319
Bond Position:  [5.95240323]


portfolio before change:  [3.71843372]
curr_Stock_Price:  96.78184726301555
curr_Factors:  [9.67818473e+01 4.33266891e-02]
mat_Sqrt:  [[ 2.01452035e+01  0.00000000e+00]
 [-8.32602562e-03  1.90773213e-02]]
grads:  [3.71286138e-04 6.00588713e+00]
Stock Position:  0.00037128613781892936
Bond Position:  [3.68249996]


portfolio before change:  [3.71887442]
curr_Stock_Price:  95.48894968194081
curr_Factors:  [9.54889497e+01 4.48863585e-02]
mat_Sqrt:  [[ 2.02306717e+01  0.00000000e+00]
 [-8.47456038e-03  1.94176572e-02]]
grads:  [-0.01149235  4.7646746 ]
Stock Position:  -0.0114923543564931
Bond Position:  [4.81626727]


portfolio before change:  [3.72323151]
curr_Stock_Price:  95.2146042693516
curr_Factors:  [9.52146043e+01 4.61583038e-02]
mat_Sqrt:  [[ 2.04563661e+01  0.00000000e+00]
 [-8.59379347e-03  1.96908545e-02]]
grads:  [5.98662508e-04 7.73315395e+00]
Stock Position:  0.0005986625078811608
Bond Position:  [3.6662301]


portfolio before change:  [3.72528574]
curr_Stock_Price:  97.11475797247012
curr_Factors:  [9.71147580e+01 4.84944196e-02]
mat_Sqrt:  [[ 2.13860765e+01  0.00000000e+00]
 [-8.80857942e-03  2.01829910e-02]]
grads:  [-0.00962628  0.59461463]
Stock Position:  -0.009626281834805442
Bond Position:  [4.66013977]


portfolio before change:  [3.73054034]
curr_Stock_Price:  96.68993960211269
curr_Factors:  [9.66899396e+01 4.84431533e-02]
mat_Sqrt:  [[ 2.12812675e+01  0.00000000e+00]
 [-8.80392215e-03  2.01723198e-02]]
grads:  [0.00940568 0.41921116]
Stock Position:  0.009405678029651025
Bond Position:  [2.8211059]


portfolio before change:  [3.74242205]
curr_Stock_Price:  97.87819476321572
curr_Factors:  [9.78781948e+01 4.98362950e-02]
mat_Sqrt:  [[ 2.18503715e+01  0.00000000e+00]
 [-8.92961769e-03  2.04603245e-02]]
grads:  [-1.40749243e-03  1.59353622e+00]
Stock Position:  -0.0014074924296264486
Bond Position:  [3.88018487]


portfolio before change:  [3.74355038]
curr_Stock_Price:  97.76581957662665
curr_Factors:  [9.77658196e+01 5.14515025e-02]
mat_Sqrt:  [[ 2.21761462e+01  0.00000000e+00]
 [-9.07316945e-03  2.07892429e-02]]
grads:  [-0.00920209  3.34272128]
Stock Position:  -0.009202093412359405
Bond Position:  [4.64320059]


portfolio before change:  [3.7267977]
curr_Stock_Price:  99.71250984253584
curr_Factors:  [9.97125098e+01 4.88116916e-02]
mat_Sqrt:  [[ 2.20298519e+01  0.00000000e+00]
 [-8.83734726e-03  2.02489064e-02]]
grads:  [-9.90855880e-04  1.81773986e+00]
Stock Position:  -0.0009908558798614304
Bond Position:  [3.82559843]


portfolio before change:  [3.72693103]
curr_Stock_Price:  100.54330007143717
curr_Factors:  [1.00543300e+02 5.04385337e-02]
mat_Sqrt:  [[ 2.25805420e+01  0.00000000e+00]
 [-8.98340992e-03  2.05835780e-02]]
grads:  [ -0.01555032 -13.2894705 ]
Stock Position:  -0.015550324157327497
Bond Position:  [5.29041194]


portfolio before change:  [3.74514536]
curr_Stock_Price:  99.45704874082575
curr_Factors:  [9.94570487e+01 5.12350941e-02]
mat_Sqrt:  [[ 2.25122725e+01  0.00000000e+00]
 [-9.05406818e-03  2.07454764e-02]]
grads:  [-0.00620874 -5.74204004]
Stock Position:  -0.0062087395079566485
Bond Position:  [4.36264827]


portfolio before change:  [3.74788369]
curr_Stock_Price:  99.19169127634132
curr_Factors:  [9.91916913e+01 4.99153800e-02]
mat_Sqrt:  [[ 2.21611598e+01  0.00000000e+00]
 [-8.93670006e-03  2.04765522e-02]]
grads:  [0.00517685 2.60941701]
Stock Position:  0.005176853517274934
Bond Position:  [3.23438284]


portfolio before change:  [3.74840617]
curr_Stock_Price:  99.13640225944748
curr_Factors:  [9.91364023e+01 5.03556172e-02]
mat_Sqrt:  [[ 2.22462655e+01  0.00000000e+00]
 [-8.97602293e-03  2.05666523e-02]]
grads:  [-1.22449051e-03 -2.59879893e+00]
Stock Position:  -0.0012244905077102163
Bond Position:  [3.86979775]


portfolio before change:  [3.75086614]
curr_Stock_Price:  97.91760272306806
curr_Factors:  [9.79176027e+01 5.16045413e-02]
mat_Sqrt:  [[ 2.22435824e+01  0.00000000e+00]
 [-9.08665318e-03  2.08201380e-02]]
grads:  [  0.02335478 -15.40461085]
Stock Position:  0.023354778368012582
Bond Position:  [1.46402223]


portfolio before change:  [3.71285637]
curr_Stock_Price:  96.27443472639008
curr_Factors:  [9.62744347e+01 5.48301695e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.71285637]
Stock Price:  96.26896044986071
PL:  [3.71285637]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.34535255e-02  1.50705075e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.53847104e-01 -5.10286380e-01]
 [ 2.63125840e-02  2.31915498e-01]
 [-4.18111405e-01 -6.01772851e-02]
 [-3.67137949e-02  1.03331526e-01]
 [-3.86293835e-01  1.52109940e-01]
 [ 1.48896262e-02  1.65610861e-01]
 [-2.03723122e-01 -1.67646634e-02]
 [ 2.08043893e-01  7.73147067e-03]
 [-9.15245286e-02 -1.12914935e-02]
 [-2.35987962e-01  5.74318476e-02]
 [-9.55319106e-02  3.25827423e-02]
 [-1.14286425e-01 -2.27568409e-01]
 [-9.07084064e-02 -1.20524011e-01]
 [ 8.87800756e-02  6.47532559e-02]
 [-1.69033896e-02 -4.70417869e-02]
 [ 4.87078151e-01 -2.61579487e-01]
 [ 2.23433727e-01  1.06475035e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.32207738]
curr_Stock_Price:  100.82868122173308
curr_Factors:  [1.00828681e+02 3.72259055e-02]
mat_Sqrt:  [[ 1.94539019e+01  0.00000000e+00]
 [-7.71760642e-03  1.76832578e-02]]
grads:  [6.33269442e-04 8.52247232e+00]
Stock Position:  0.0006332694420734489
Bond Position:  [8.25822565]


portfolio before change:  [8.32392855]
curr_Stock_Price:  100.49132327481438
curr_Factors:  [1.00491323e+02 3.93652264e-02]
mat_Sqrt:  [[ 1.99381538e+01  0.00000000e+00]
 [-7.93626878e-03  1.81842762e-02]]
grads:  [-0.00934514 -3.66536283]
Stock Position:  -0.009345141586736069
Bond Position:  [9.2630342]


portfolio before change:  [8.32010322]
curr_Stock_Price:  101.14849701381529
curr_Factors:  [1.01148497e+02 3.71758760e-02]
mat_Sqrt:  [[ 1.95024889e+01  0.00000000e+00]
 [-7.71241866e-03  1.76713712e-02]]
grads:  [-1.93080145e-02 -2.88764452e+01]
Stock Position:  -0.019308014501575984
Bond Position:  [10.27307987]


portfolio before change:  [8.35155746]
curr_Stock_Price:  99.65245255925974
curr_Factors:  [9.96524526e+01 3.66239310e-02]
mat_Sqrt:  [[ 1.90708684e+01  0.00000000e+00]
 [-7.65495197e-03  1.75396984e-02]]
grads:  [6.68710005e-03 1.32223196e+01]
Stock Position:  0.0066871000484453845
Bond Position:  [7.68517154]


portfolio before change:  [8.33529273]
curr_Stock_Price:  96.93284863698321
curr_Factors:  [9.69328486e+01 3.85355354e-02]
mat_Sqrt:  [[ 1.90283738e+01  0.00000000e+00]
 [-7.85218801e-03  1.79916230e-02]]
grads:  [-0.02335328 -3.34473912]
Stock Position:  -0.02335327914184263
Bond Position:  [10.5989926]


portfolio before change:  [8.33289682]
curr_Stock_Price:  97.14892062864159
curr_Factors:  [9.71489206e+01 3.92230936e-02]
mat_Sqrt:  [[ 1.92401699e+01  0.00000000e+00]
 [-7.92192841e-03  1.81514183e-02]]
grads:  [4.35743569e-04 5.69275217e+00]
Stock Position:  0.00043574356919441186
Bond Position:  [8.2905648]


portfolio before change:  [8.33545334]
curr_Stock_Price:  98.25880580567767
curr_Factors:  [9.82588058e+01 3.91942544e-02]
mat_Sqrt:  [[ 1.94528252e+01  0.00000000e+00]
 [-7.91901553e-03  1.81447441e-02]]
grads:  [-0.0164453   8.38314059]
Stock Position:  -0.01644530347400734
Bond Position:  [9.95134922]


portfolio before change:  [8.34387949]
curr_Stock_Price:  97.89773031435307
curr_Factors:  [9.78977303e+01 3.83634567e-02]
mat_Sqrt:  [[ 1.91748285e+01  0.00000000e+00]
 [-7.83463660e-03  1.79514076e-02]]
grads:  [4.54596668e-03 9.22550835e+00]
Stock Position:  0.00454596668162627
Bond Position:  [7.89883967]


portfolio before change:  [8.34648591]
curr_Stock_Price:  98.03663634561134
curr_Factors:  [9.80366363e+01 3.79536370e-02]
mat_Sqrt:  [[ 1.90991967e+01  0.00000000e+00]
 [-7.79267728e-03  1.78552667e-02]]
grads:  [-0.01104967 -0.93891979]
Stock Position:  -0.01104967000762209
Bond Position:  [9.42975839]


portfolio before change:  [8.35929711]
curr_Stock_Price:  97.09059242690618
curr_Factors:  [9.70905924e+01 3.74709841e-02]
mat_Sqrt:  [[ 1.87942371e+01  0.00000000e+00]
 [-7.74296936e-03  1.77413716e-02]]
grads:  [0.0112491  0.43578765]
Stock Position:  0.0112490963169432
Bond Position:  [7.26711569]


portfolio before change:  [8.36047526]
curr_Stock_Price:  97.03380034772889
curr_Factors:  [9.70338003e+01 3.72638087e-02]
mat_Sqrt:  [[ 1.87312458e+01  0.00000000e+00]
 [-7.72153443e-03  1.76922580e-02]]
grads:  [-0.00514929 -0.63821664]
Stock Position:  -0.005149285939263173
Bond Position:  [8.86013004]


portfolio before change:  [8.35299835]
curr_Stock_Price:  98.91604574473416
curr_Factors:  [9.89160457e+01 3.42640438e-02]
mat_Sqrt:  [[ 1.83099035e+01  0.00000000e+00]
 [-7.40421975e-03  1.69651987e-02]]
grads:  [-0.01151959  3.38527408]
Stock Position:  -0.011519593699838826
Bond Position:  [9.49247101]


portfolio before change:  [8.36635325]
curr_Stock_Price:  97.96275780839528
curr_Factors:  [9.79627578e+01 3.30212346e-02]
mat_Sqrt:  [[ 1.78015433e+01  0.00000000e+00]
 [-7.26869832e-03  1.66546801e-02]]
grads:  [-0.00456767  1.95637154]
Stock Position:  -0.004567673405348165
Bond Position:  [8.81381514]


portfolio before change:  [8.36933069]
curr_Stock_Price:  97.79336933244173
curr_Factors:  [9.77933693e+01 3.26149324e-02]
mat_Sqrt:  [[ 1.76610960e+01  0.00000000e+00]
 [-7.22384190e-03  1.65519012e-02]]
grads:  [-1.20946866e-02 -1.37487776e+01]
Stock Position:  -0.012094686615410136
Bond Position:  [9.55211085]


portfolio before change:  [8.3543951]
curr_Stock_Price:  99.22572705739326
curr_Factors:  [9.92257271e+01 3.22033917e-02]
mat_Sqrt:  [[ 1.78063578e+01  0.00000000e+00]
 [-7.17812139e-03  1.64471423e-02]]
grads:  [-0.00804822 -7.32796062]
Stock Position:  -0.008048215052547667
Bond Position:  [9.15298509]


portfolio before change:  [8.36250866]
curr_Stock_Price:  98.5019613927486
curr_Factors:  [9.85019614e+01 3.18446588e-02]
mat_Sqrt:  [[ 1.75777457e+01  0.00000000e+00]
 [-7.13802872e-03  1.63552785e-02]]
grads:  [0.00665846 3.9591656 ]
Stock Position:  0.0066584598028401575
Bond Position:  [7.70663731]


portfolio before change:  [8.37261861]
curr_Stock_Price:  99.73093247249791
curr_Factors:  [9.97309325e+01 3.05271078e-02]
mat_Sqrt:  [[ 1.74249969e+01  0.00000000e+00]
 [-6.98880337e-03  1.60133602e-02]]
grads:  [-2.14829929e-03 -2.93765870e+00]
Stock Position:  -0.0021482992937404024
Bond Position:  [8.5868705]


portfolio before change:  [8.37342074]
curr_Stock_Price:  100.35694347220038
curr_Factors:  [1.00356943e+02 3.15318600e-02]
mat_Sqrt:  [[ 1.78205958e+01  0.00000000e+00]
 [-7.10288505e-03  1.62747542e-02]]
grads:  [  0.0209261  -16.07271504]
Stock Position:  0.0209260962526832
Bond Position:  [6.27334168]


portfolio before change:  [8.38952008]
curr_Stock_Price:  101.05133034585059
curr_Factors:  [1.01051330e+02 3.13038063e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.38952008]
Stock Price:  100.60155737042498
PL:  [7.78796271]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.05759219e-02  2.00112133e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.18817333e-01 -2.71283237e-01]
 [ 6.57960723e-02  1.68399821e-01]
 [-8.48959636e-02 -6.81068795e-02]
 [ 7.78381606e-01 -1.08062627e+00]
 [-5.74801332e-01  4.31181948e-01]
 [ 3.19947732e-01  1.57820760e-01]
 [-9.46094533e-02 -2.59832664e-02]
 [ 2.89104061e-01  7.47838771e-03]
 [ 4.06166390e-02  1.18378870e-01]
 [-2.37037683e-01  7.78940175e-02]
 [-4.65172634e-02  3.61751132e-02]
 [-2.90970795e-01 -2.49434386e-01]
 [ 1.39426669e-01 -5.70405103e-03]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.22236670e-02  7.08797408e-02]
 [ 2.78439337e-01 -1.99590657e-01]
 [ 1.79763913e-01  7.06197460e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.67893339]
curr_Stock_Price:  101.17078662573837
curr_Factors:  [1.01170787e+02 3.82805850e-02]
mat_Sqrt:  [[ 1.97944943e+01  0.00000000e+00]
 [-7.82616995e-03  1.79320081e-02]]
grads:  [3.37266374e-03 1.11594938e+01]
Stock Position:  0.0033726637380754954
Bond Position:  [10.33771834]


portfolio before change:  [10.67652926]
curr_Stock_Price:  99.69157538522992
curr_Factors:  [9.96915754e+01 3.99697035e-02]
mat_Sqrt:  [[ 1.99307629e+01  0.00000000e+00]
 [-7.99696978e-03  1.83233597e-02]]
grads:  [-0.00934861 -3.6375409 ]
Stock Position:  -0.009348607036033872
Bond Position:  [11.60850662]


portfolio before change:  [10.64727058]
curr_Stock_Price:  103.1317842757879
curr_Factors:  [1.03131784e+02 3.77355200e-02]
mat_Sqrt:  [[ 2.00340014e+01  0.00000000e+00]
 [-7.77025302e-03  1.78038863e-02]]
grads:  [-1.18406223e-02 -1.52373045e+01]
Stock Position:  -0.011840622284605718
Bond Position:  [11.86841509]


portfolio before change:  [10.68552943]
curr_Stock_Price:  100.15125116020661
curr_Factors:  [1.00151251e+02 3.79828810e-02]
mat_Sqrt:  [[ 1.95186749e+01  0.00000000e+00]
 [-7.79567891e-03  1.78621443e-02]]
grads:  [7.1363338e-03 9.4277494e+00]
Stock Position:  0.007136333797495706
Bond Position:  [9.97081667]


portfolio before change:  [10.71958035]
curr_Stock_Price:  104.57339757772664
curr_Factors:  [1.04573398e+02 3.39208213e-02]
mat_Sqrt:  [[ 1.92599164e+01  0.00000000e+00]
 [-7.36704243e-03  1.68800148e-02]]
grads:  [-0.00595123 -4.03476421]
Stock Position:  -0.0059512326114978436
Bond Position:  [11.34192097]


portfolio before change:  [10.71857916]
curr_Stock_Price:  105.2181436411927
curr_Factors:  [1.05218144e+02 3.35018410e-02]
mat_Sqrt:  [[ 1.92586115e+01  0.00000000e+00]
 [-7.32140325e-03  1.67754423e-02]]
grads:  [ 1.59283361e-02 -6.44171552e+01]
Stock Position:  0.015928336106049153
Bond Position:  [9.0426292]


portfolio before change:  [10.68916125]
curr_Stock_Price:  103.2293075605368
curr_Factors:  [1.03229308e+02 3.25044648e-02]
mat_Sqrt:  [[ 1.86112063e+01  0.00000000e+00]
 [-7.21159786e-03  1.65238465e-02]]
grads:  [-2.07734037e-02  2.60945263e+01]
Stock Position:  -0.020773403683915087
Bond Position:  [12.83358532]


portfolio before change:  [10.71232474]
curr_Stock_Price:  102.26871873145868
curr_Factors:  [1.02268719e+02 3.12189947e-02]
mat_Sqrt:  [[ 1.80697553e+01  0.00000000e+00]
 [-7.06755909e-03  1.61938123e-02]]
grads:  [0.02151808 9.74574473]
Stock Position:  0.021518075496420503
Bond Position:  [8.51169873]


portfolio before change:  [10.71836937]
curr_Stock_Price:  102.45072544961936
curr_Factors:  [1.02450725e+02 3.36226989e-02]
mat_Sqrt:  [[ 1.87858705e+01  0.00000000e+00]
 [-7.33459734e-03  1.68056738e-02]]
grads:  [-0.00563985 -1.54610085]
Stock Position:  -0.005639849408084641
Bond Position:  [11.29617603]


portfolio before change:  [10.72745631]
curr_Stock_Price:  101.34031621641851
curr_Factors:  [1.01340316e+02 3.45402557e-02]
mat_Sqrt:  [[ 1.88341068e+01  0.00000000e+00]
 [-7.43400357e-03  1.70334420e-02]]
grads:  [0.01552332 0.43904149]
Stock Position:  0.015523321574023719
Bond Position:  [9.15431799]


portfolio before change:  [10.69893137]
curr_Stock_Price:  99.35531585227899
curr_Factors:  [9.93553159e+01 3.59627893e-02]
mat_Sqrt:  [[ 1.88416006e+01  0.00000000e+00]
 [-7.58554302e-03  1.73806625e-02]]
grads:  [4.89774810e-03 6.81095265e+00]
Stock Position:  0.004897748097184713
Bond Position:  [10.21231406]


portfolio before change:  [10.70699587]
curr_Stock_Price:  100.48054705414823
curr_Factors:  [1.00480547e+02 3.69273805e-02]
mat_Sqrt:  [[ 1.93088426e+01  0.00000000e+00]
 [-7.68659930e-03  1.76122116e-02]]
grads:  [-0.01051549  4.42272779]
Stock Position:  -0.01051549030238898
Bond Position:  [11.76359809]


portfolio before change:  [10.72105054]
curr_Stock_Price:  99.42368680135127
curr_Factors:  [9.94236868e+01 3.75984303e-02]
mat_Sqrt:  [[ 1.92785657e+01  0.00000000e+00]
 [-7.75612587e-03  1.77715169e-02]]
grads:  [-1.59395414e-03  2.03556698e+00]
Stock Position:  -0.0015939541402496143
Bond Position:  [10.87952734]


portfolio before change:  [10.71811635]
curr_Stock_Price:  102.97109942612686
curr_Factors:  [1.02971099e+02 3.62590001e-02]
mat_Sqrt:  [[ 1.96075468e+01  0.00000000e+00]
 [-7.61671846e-03  1.74520944e-02]]
grads:  [ -0.02039179 -14.29251871]
Stock Position:  -0.02039178533055663
Bond Position:  [12.8178809]


portfolio before change:  [10.72405763]
curr_Stock_Price:  102.83690766288167
curr_Factors:  [1.02836908e+02 3.44512987e-02]
mat_Sqrt:  [[ 1.90876212e+01  0.00000000e+00]
 [-7.42442442e-03  1.70114934e-02]]
grads:  [ 0.00717414 -0.33530572]
Stock Position:  0.007174137385543045
Bond Position:  [9.98629153]


portfolio before change:  [10.72633231]
curr_Stock_Price:  102.80593433965927
curr_Factors:  [1.02805934e+02 3.44615600e-02]
mat_Sqrt:  [[ 1.90847138e+01  0.00000000e+00]
 [-7.42553001e-03  1.70140267e-02]]
grads:  [0.00502999 1.0303884 ]
Stock Position:  0.005029990564215488
Bond Position:  [10.20921943]


portfolio before change:  [10.73357493]
curr_Stock_Price:  103.73834049570151
curr_Factors:  [1.03738340e+02 3.49165779e-02]
mat_Sqrt:  [[ 1.93845236e+01  0.00000000e+00]
 [-7.47439126e-03  1.71259819e-02]]
grads:  [-1.09825820e-03  4.13872567e+00]
Stock Position:  -0.0010982581974803458
Bond Position:  [10.84750641]


portfolio before change:  [10.7363243]
curr_Stock_Price:  103.7045029375294
curr_Factors:  [1.03704503e+02 3.65075161e-02]
mat_Sqrt:  [[ 1.98147573e+01  0.00000000e+00]
 [-7.64277605e-03  1.75117999e-02]]
grads:  [ 9.65597659e-03 -1.13974953e+01]
Stock Position:  0.009655976590445875
Bond Position:  [9.73495605]


portfolio before change:  [10.72646385]
curr_Stock_Price:  102.43125092267327
curr_Factors:  [1.02431251e+02 3.67765948e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.72646385]
Stock Price:  103.10593091447763
PL:  [7.62053294]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.22862035e-02  2.79551076e-01]
 [-3.70236536e-02 -3.30773047e-02]
 [-1.05062878e-01 -1.77438548e-01]
 [ 3.03378541e-01 -2.13544805e-01]
 [-1.08182811e-01 -7.40235422e-02]
 [ 5.32049410e-01 -6.99502823e-01]
 [-5.13516675e-01  2.52657919e-01]
 [ 2.03328833e-01  1.48660448e-01]
 [-2.03749312e-01 -1.66626210e-02]
 [ 2.14137182e-01  7.34965224e-03]
 [-1.04982725e-01 -4.75574653e-02]
 [-2.36422702e-01  6.59062190e-02]
 [-7.83100298e-02  3.38449646e-02]
 [-1.68162801e-01 -2.51912603e-01]
 [-9.46718405e-02 -1.22425032e-01]
 [ 8.83353799e-02  6.54122938e-02]
 [-2.07464627e-02 -4.51232826e-02]
 [ 5.37779190e-01 -2.76350924e-01]
 [ 2.23982550e-01  1.23482888e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.46601195]
curr_Stock_Price:  101.72049353888268
curr_Factors:  [1.01720494e+02 3.92662021e-02]
mat_Sqrt:  [[ 2.01566292e+01  0.00000000e+00]
 [-7.92628056e-03  1.81613903e-02]]
grads:  [7.65466753e-03 1.53926033e+01]
Stock Position:  0.007654667532677812
Bond Position:  [13.68737539]


portfolio before change:  [14.47011867]
curr_Stock_Price:  101.80990986236331
curr_Factors:  [1.01809910e+02 3.97195067e-02]
mat_Sqrt:  [[ 2.02904639e+01  0.00000000e+00]
 [-7.97190132e-03  1.82659206e-02]]
grads:  [-0.00253616 -1.81087531]
Stock Position:  -0.0025361555677743276
Bond Position:  [14.72832444]


portfolio before change:  [14.46845481]
curr_Stock_Price:  103.91798574446513
curr_Factors:  [1.03917986e+02 3.92772001e-02]
mat_Sqrt:  [[ 2.05949613e+01  0.00000000e+00]
 [-7.92739050e-03  1.81639335e-02]]
grads:  [-8.86155628e-03 -9.76872924e+00]
Stock Position:  -0.00886155628319309
Bond Position:  [15.38932988]


portfolio before change:  [14.47140413]
curr_Stock_Price:  104.01937751338653
curr_Factors:  [1.04019378e+02 3.84604356e-02]
mat_Sqrt:  [[ 2.03995858e+01  0.00000000e+00]
 [-7.84453293e-03  1.79740830e-02]]
grads:  [ 1.03031478e-02 -1.18807065e+01]
Stock Position:  0.010303147784406965
Bond Position:  [13.39967711]


portfolio before change:  [14.47120627]
curr_Stock_Price:  103.67499720571675
curr_Factors:  [1.03674997e+02 3.86412224e-02]
mat_Sqrt:  [[ 2.03797786e+01  0.00000000e+00]
 [-7.86294829e-03  1.80162779e-02]]
grads:  [-0.00689357 -4.1087034 ]
Stock Position:  -0.006893565238660965
Bond Position:  [15.18589662]


portfolio before change:  [14.48371583]
curr_Stock_Price:  102.4111212041007
curr_Factors:  [1.02411121e+02 3.72596859e-02]
mat_Sqrt:  [[ 1.97681813e+01  0.00000000e+00]
 [-7.72110727e-03  1.76912792e-02]]
grads:  [ 1.14710274e-02 -3.95394145e+01]
Stock Position:  0.011471027410027009
Bond Position:  [13.30895505]


portfolio before change:  [14.46439898]
curr_Stock_Price:  100.43706100798687
curr_Factors:  [1.00437061e+02 3.89371671e-02]
mat_Sqrt:  [[ 1.98187460e+01  0.00000000e+00]
 [-7.89300117e-03  1.80851376e-02]]
grads:  [-0.02034678 13.97047253]
Stock Position:  -0.0203467827539825
Bond Position:  [16.50797004]


portfolio before change:  [14.45479324]
curr_Stock_Price:  101.11202017525167
curr_Factors:  [1.01112020e+02 3.98892781e-02]
mat_Sqrt:  [[ 2.01943963e+01  0.00000000e+00]
 [-7.98892013e-03  1.83049156e-02]]
grads:  [0.01328139 8.12134025]
Stock Position:  0.01328138591928038
Bond Position:  [13.11188548]


portfolio before change:  [14.41673094]
curr_Stock_Price:  97.99934197953203
curr_Factors:  [9.79993420e+01 4.05337181e-02]
mat_Sqrt:  [[ 1.97301952e+01  0.00000000e+00]
 [-8.05319496e-03  1.84521877e-02]]
grads:  [-0.01069536 -0.90301601]
Stock Position:  -0.010695356758714757
Bond Position:  [15.46486887]


portfolio before change:  [14.42733795]
curr_Stock_Price:  97.36913350631814
curr_Factors:  [9.73691335e+01 4.28301306e-02]
mat_Sqrt:  [[ 2.01509722e+01  0.00000000e+00]
 [-8.27817667e-03  1.89676856e-02]]
grads:  [0.01078582 0.38748282]
Stock Position:  0.010785823684408708
Bond Position:  [13.37713164]


portfolio before change:  [14.41540797]
curr_Stock_Price:  95.9529526351258
curr_Factors:  [9.59529526e+01 4.53279990e-02]
mat_Sqrt:  [[ 2.04287417e+01  0.00000000e+00]
 [-8.51614927e-03  1.95129493e-02]]
grads:  [-0.00615498 -2.43722589]
Stock Position:  -0.006154980385274707
Bond Position:  [15.00599651]


portfolio before change:  [14.40587338]
curr_Stock_Price:  98.11162073419972
curr_Factors:  [9.81116207e+01 4.64338743e-02]
mat_Sqrt:  [[ 2.11416029e+01  0.00000000e+00]
 [-8.61940827e-03  1.97495454e-02]]
grads:  [-0.00982229  3.33710056]
Stock Position:  -0.009822286006423306
Bond Position:  [15.36955378]


portfolio before change:  [14.40582997]
curr_Stock_Price:  98.50728017992165
curr_Factors:  [9.85072802e+01 4.48592333e-02]
mat_Sqrt:  [[ 2.08638404e+01  0.00000000e+00]
 [-8.47199937e-03  1.94117892e-02]]
grads:  [-0.00304541  1.74352628]
Stock Position:  -0.0030454065571092676
Bond Position:  [14.70582469]


portfolio before change:  [14.40892267]
curr_Stock_Price:  98.69911397741292
curr_Factors:  [9.86991140e+01 4.42641109e-02]
mat_Sqrt:  [[ 2.07653438e+01  0.00000000e+00]
 [-8.41561510e-03  1.92825966e-02]]
grads:  [ -0.01339282 -13.06424689]
Stock Position:  -0.0133928181618304
Bond Position:  [15.73078196]


portfolio before change:  [14.40893506]
curr_Stock_Price:  98.99186770570604
curr_Factors:  [9.89918677e+01 4.34613866e-02]
mat_Sqrt:  [[ 2.06372254e+01  0.00000000e+00]
 [-8.33895788e-03  1.91069529e-02]]
grads:  [-0.00717647 -6.40735509]
Stock Position:  -0.0071764736751058775
Bond Position:  [15.1193476]


portfolio before change:  [14.42646061]
curr_Stock_Price:  97.07654864239528
curr_Factors:  [9.70765486e+01 4.58665155e-02]
mat_Sqrt:  [[ 2.07903692e+01  0.00000000e+00]
 [-8.56658770e-03  1.96285183e-02]]
grads:  [0.00562201 3.33251307]
Stock Position:  0.005622009132633734
Bond Position:  [13.88069537]


portfolio before change:  [14.44568706]
curr_Stock_Price:  99.87907704772708
curr_Factors:  [9.98790770e+01 4.50642048e-02]
mat_Sqrt:  [[ 2.12026613e+01  0.00000000e+00]
 [-8.49133250e-03  1.94560870e-02]]
grads:  [-1.90730197e-03 -2.31923730e+00]
Stock Position:  -0.0019073019739508082
Bond Position:  [14.63618662]


portfolio before change:  [14.45006627]
curr_Stock_Price:  99.50173170824733
curr_Factors:  [9.95017317e+01 4.46677673e-02]
mat_Sqrt:  [[ 2.10294426e+01  0.00000000e+00]
 [-8.45390014e-03  1.93703187e-02]]
grads:  [  0.01983741 -14.26672058]
Stock Position:  0.019837413985710105
Bond Position:  [12.47620923]


portfolio before change:  [14.46948344]
curr_Stock_Price:  100.32329644502293
curr_Factors:  [1.00323296e+02 4.56657895e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.46948344]
Stock Price:  99.92478339375204
PL:  [14.46948344]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.38089795e-02  2.81839439e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.68881384e-01 -6.12863131e-01]
 [ 1.63012634e-02  2.49232215e-01]
 [-4.04916289e-01 -7.78886439e-02]
 [-4.92392446e-02  1.27566105e-01]
 [-3.08881642e-01  1.12261253e-01]
 [ 6.20013516e-03  1.56114715e-01]
 [-2.31443793e-01  9.12412505e-02]
 [ 1.02361376e-01  1.43537608e-02]
 [-9.99061357e-02 -3.08332076e-02]
 [ 4.21125011e-03 -5.13550258e-02]
 [ 3.71620710e-01 -5.75310539e-02]
 [ 1.69050137e-01  1.12844972e-01]
 [-2.68782009e-01 -1.13379551e-01]
 [ 8.84377051e-02  2.44120678e-02]
 [ 3.60126491e-02 -6.33259551e-02]
 [ 1.19288243e+00 -5.41975691e-01]
 [ 1.47137887e-01  2.00927115e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.57265894]
curr_Stock_Price:  101.73597370077931
curr_Factors:  [1.01735974e+02 3.85657863e-02]
mat_Sqrt:  [[ 1.99790872e+01  0.00000000e+00]
 [-7.85526945e-03  1.79986834e-02]]
grads:  [7.84889688e-03 1.56588919e+01]
Stock Position:  0.007848896883169547
Bond Position:  [13.77414377]


portfolio before change:  [14.56912589]
curr_Stock_Price:  100.84705628161291
curr_Factors:  [1.00847056e+02 3.74185283e-02]
mat_Sqrt:  [[ 1.95077228e+01  0.00000000e+00]
 [-7.73754775e-03  1.77289491e-02]]
grads:  [-0.00955134 -3.7594992 ]
Stock Position:  -0.009551338804517015
Bond Position:  [15.53235029]


portfolio before change:  [14.57825195]
curr_Stock_Price:  100.29818163300958
curr_Factors:  [1.00298182e+02 3.70921511e-02]
mat_Sqrt:  [[ 1.93167505e+01  0.00000000e+00]
 [-7.70372908e-03  1.76514608e-02]]
grads:  [-2.25895543e-02 -3.47202499e+01]
Stock Position:  -0.022589554269132513
Bond Position:  [16.84394316]


portfolio before change:  [14.60118761]
curr_Stock_Price:  99.46929607823301
curr_Factors:  [9.94692961e+01 3.79347476e-02]
mat_Sqrt:  [[ 1.93734802e+01  0.00000000e+00]
 [-7.79073784e-03  1.78508229e-02]]
grads:  [6.45599646e-03 1.39619454e+01]
Stock Position:  0.0064559964571012495
Bond Position:  [13.95901419]


portfolio before change:  [14.59624908]
curr_Stock_Price:  98.16373106856794
curr_Factors:  [9.81637311e+01 3.69197608e-02]
mat_Sqrt:  [[ 1.88616854e+01  0.00000000e+00]
 [-7.68580622e-03  1.76103944e-02]]
grads:  [-0.02326991 -4.42287902]
Stock Position:  -0.02326990784687008
Bond Position:  [16.88051006]


portfolio before change:  [14.64064059]
curr_Stock_Price:  96.43743049062607
curr_Factors:  [9.64374305e+01 3.84259458e-02]
mat_Sqrt:  [[ 1.89041830e+01  0.00000000e+00]
 [-7.84101481e-03  1.79660220e-02]]
grads:  [3.40409739e-04 7.10040905e+00]
Stock Position:  0.00034040973882027223
Bond Position:  [14.60781235]


portfolio before change:  [14.64432987]
curr_Stock_Price:  96.54574522842515
curr_Factors:  [9.65457452e+01 3.89697802e-02]
mat_Sqrt:  [[ 1.90588687e+01  0.00000000e+00]
 [-7.89630599e-03  1.80927100e-02]]
grads:  [-0.013636    6.20477823]
Stock Position:  -0.01363600427318381
Bond Position:  [15.96082807]


portfolio before change:  [14.65734895]
curr_Stock_Price:  95.8836470807786
curr_Factors:  [9.58836471e+01 3.95998298e-02]
mat_Sqrt:  [[ 1.90805639e+01  0.00000000e+00]
 [-7.95988240e-03  1.82383818e-02]]
grads:  [3.89580639e-03 8.55968017e+00]
Stock Position:  0.0038958063913310703
Bond Position:  [14.28380483]


portfolio before change:  [14.65777049]
curr_Stock_Price:  95.07512159338826
curr_Factors:  [9.50751216e+01 4.01772996e-02]
mat_Sqrt:  [[ 1.90571197e+01  0.00000000e+00]
 [-8.01771035e-03  1.83708823e-02]]
grads:  [-0.01005518  4.96662322]
Stock Position:  -0.01005518407237993
Bond Position:  [15.61376834]


portfolio before change:  [14.67620662]
curr_Stock_Price:  93.62987741137822
curr_Factors:  [9.36298774e+01 4.17955889e-02]
mat_Sqrt:  [[ 1.91416636e+01  0.00000000e+00]
 [-8.17758780e-03  1.87372076e-02]]
grads:  [0.00567484 0.76605656]
Stock Position:  0.005674839588168087
Bond Position:  [14.14487208]


portfolio before change:  [14.675055]
curr_Stock_Price:  92.80372543665564
curr_Factors:  [9.28037254e+01 4.27427304e-02]
mat_Sqrt:  [[ 1.91865346e+01  0.00000000e+00]
 [-8.26972603e-03  1.89483228e-02]]
grads:  [-0.00590846 -1.62722622]
Stock Position:  -0.005908458880289821
Bond Position:  [15.22338199]


portfolio before change:  [14.69497133]
curr_Stock_Price:  90.07712481808582
curr_Factors:  [9.00771248e+01 4.30223978e-02]
mat_Sqrt:  [[ 1.86836542e+01  0.00000000e+00]
 [-8.29673649e-03  1.90102115e-02]]
grads:  [-9.74216310e-04 -2.70144421e+00]
Stock Position:  -0.0009742163100632732
Bond Position:  [14.78272593]


portfolio before change:  [14.69836028]
curr_Stock_Price:  90.39244495435892
curr_Factors:  [9.03924450e+01 4.01086004e-02]
mat_Sqrt:  [[ 1.81030140e+01  0.00000000e+00]
 [-8.01085268e-03  1.83551694e-02]]
grads:  [ 0.01914113 -3.13432433]
Stock Position:  0.019141127565605064
Bond Position:  [12.96814696]


portfolio before change:  [14.70656323]
curr_Stock_Price:  90.6515992364413
curr_Factors:  [9.06515992e+01 4.01824429e-02]
mat_Sqrt:  [[ 1.81716197e+01  0.00000000e+00]
 [-8.01822354e-03  1.83720581e-02]]
grads:  [0.01201322 6.14220633]
Stock Position:  0.01201322305047352
Bond Position:  [13.61754535]


portfolio before change:  [14.73418159]
curr_Stock_Price:  92.66717411531619
curr_Factors:  [9.26671741e+01 3.75640313e-02]
mat_Sqrt:  [[ 1.79602351e+01  0.00000000e+00]
 [-7.75257699e-03  1.77633855e-02]]
grads:  [-0.01772053 -6.38276705]
Stock Position:  -0.017720531008595285
Bond Position:  [16.37629312]


portfolio before change:  [14.74336409]
curr_Stock_Price:  92.38005421592185
curr_Factors:  [9.23800542e+01 3.71751627e-02]
mat_Sqrt:  [[ 1.78116705e+01  0.00000000e+00]
 [-7.71234467e-03  1.76712016e-02]]
grads:  [0.00556332 1.38146054]
Stock Position:  0.005563319012472574
Bond Position:  [14.22942438]


portfolio before change:  [14.74768448]
curr_Stock_Price:  92.5171284891331
curr_Factors:  [9.25171285e+01 3.74624649e-02]
mat_Sqrt:  [[ 1.79068963e+01  0.00000000e+00]
 [-7.74208911e-03  1.77393547e-02]]
grads:  [ 4.67693359e-04 -3.56980038e+00]
Stock Position:  0.0004676933591558792
Bond Position:  [14.70441483]


portfolio before change:  [14.75124981]
curr_Stock_Price:  92.27929008536142
curr_Factors:  [9.22792901e+01 4.02221510e-02]
mat_Sqrt:  [[ 1.85070369e+01  0.00000000e+00]
 [-8.02218435e-03  1.83811335e-02]]
grads:  [  0.05167466 -29.48543359]
Stock Position:  0.05167466024506711
Bond Position:  [9.98274885]


portfolio before change:  [14.75776913]
curr_Stock_Price:  92.35714888175129
curr_Factors:  [9.23571489e+01 3.91927431e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.75776913]
Stock Price:  91.9169812773181
PL:  [14.75776913]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.69229285e-01 -6.15236812e-01]
 [-2.49971538e-02  2.77011274e-01]
 [-4.07866319e-01 -7.87483879e-02]
 [ 3.74035398e-02  1.34541238e-03]
 [-3.32248201e-01  1.25073692e-01]
 [ 1.50532066e-02  1.65404395e-01]
 [-2.12913780e-01  1.90441901e-02]
 [ 2.49959054e-01  5.10497799e-03]
 [ 2.88757814e-02  1.06600295e-01]
 [-1.84045654e-01  4.96934500e-02]
 [ 4.01307530e-02 -1.28303342e-04]
 [-4.25485571e-02 -1.93777147e-01]
 [-2.64182491e-01 -1.15388967e-01]
 [ 8.75413457e-02  1.41792249e-02]
 [ 6.48983170e-02 -8.46205295e-02]
 [ 1.01554366e+00 -4.68404893e-01]
 [ 1.47665702e-01  1.64053008e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.16259491]
curr_Stock_Price:  98.5810300937452
curr_Factors:  [9.85810301e+01 4.23611235e-02]
mat_Sqrt:  [[ 2.02897683e+01  0.00000000e+00]
 [-8.23272723e-03  1.88635478e-02]]
grads:  [ 0.00137368 -0.07161083]
Stock Position:  0.001373676488519621
Bond Position:  [-7.29801335]


portfolio before change:  [-7.16268471]
curr_Stock_Price:  99.84401477639284
curr_Factors:  [9.98440148e+01 4.32885314e-02]
mat_Sqrt:  [[ 2.07734420e+01  0.00000000e+00]
 [-8.32235846e-03  1.90689188e-02]]
grads:  [-0.00896938 -3.49531984]
Stock Position:  -0.008969378789675634
Bond Position:  [-6.26714592]


portfolio before change:  [-7.168449]
curr_Stock_Price:  100.31197456788598
curr_Factors:  [1.00311975e+02 4.30188783e-02]
mat_Sqrt:  [[ 2.08056994e+01  0.00000000e+00]
 [-8.29639713e-03  1.90094339e-02]]
grads:  [-2.10394582e-02 -3.23648150e+01]
Stock Position:  -0.021039458180297316
Bond Position:  [-5.05793941]


portfolio before change:  [-7.14012319]
curr_Stock_Price:  98.90554804722005
curr_Factors:  [9.89055480e+01 4.35300696e-02]
mat_Sqrt:  [[ 2.06355161e+01  0.00000000e+00]
 [-8.34554440e-03  1.91220445e-02]]
grads:  [4.64735060e-03 1.44864883e+01]
Stock Position:  0.004647350596482317
Bond Position:  [-7.59977195]


portfolio before change:  [-7.14554558]
curr_Stock_Price:  98.14765235794845
curr_Factors:  [9.81476524e+01 4.37265904e-02]
mat_Sqrt:  [[ 2.05235613e+01  0.00000000e+00]
 [-8.36436158e-03  1.91651601e-02]]
grads:  [-0.02154767 -4.10893453]
Stock Position:  -0.02154767032536355
Bond Position:  [-5.03069232]


portfolio before change:  [-7.14380443]
curr_Stock_Price:  98.00847371727525
curr_Factors:  [9.80084737e+01 4.12143154e-02]
mat_Sqrt:  [[ 1.98970033e+01  0.00000000e+00]
 [-8.12052366e-03  1.86064572e-02]]
grads:  [0.00190937 0.0723089 ]
Stock Position:  0.0019093692373696688
Bond Position:  [-7.3309388]


portfolio before change:  [-7.14738084]
curr_Stock_Price:  97.09537540318391
curr_Factors:  [9.70953754e+01 3.93730288e-02]
mat_Sqrt:  [[ 1.92662840e+01  0.00000000e+00]
 [-7.93705526e-03  1.81860783e-02]]
grads:  [-0.01441179  6.87744162]
Stock Position:  -0.014411786239086817
Bond Position:  [-5.74806305]


portfolio before change:  [-7.15990881]
curr_Stock_Price:  97.86493814888864
curr_Factors:  [9.78649381e+01 3.78656311e-02]
mat_Sqrt:  [[ 1.90436296e+01  0.00000000e+00]
 [-7.78363730e-03  1.78345536e-02]]
grads:  [4.58114364e-03 9.27437819e+00]
Stock Position:  0.004581143644366158
Bond Position:  [-7.60824215]


portfolio before change:  [-7.1655459]
curr_Stock_Price:  97.04968478611245
curr_Factors:  [9.70496848e+01 3.90701654e-02]
mat_Sqrt:  [[ 1.91830100e+01  0.00000000e+00]
 [-7.90646979e-03  1.81159982e-02]]
grads:  [-0.0106658   1.05123603]
Stock Position:  -0.010665803431874048
Bond Position:  [-6.13043304]


portfolio before change:  [-7.18557176]
curr_Stock_Price:  98.78354943388119
curr_Factors:  [9.87835494e+01 3.75436126e-02]
mat_Sqrt:  [[ 1.91404726e+01  0.00000000e+00]
 [-7.75046967e-03  1.77585570e-02]]
grads:  [0.01317559 0.28746581]
Stock Position:  0.013175591537842906
Bond Position:  [-8.48710346]


portfolio before change:  [-7.18282707]
curr_Stock_Price:  99.15292450898623
curr_Factors:  [9.91529245e+01 3.79673055e-02]
mat_Sqrt:  [[ 1.93201466e+01  0.00000000e+00]
 [-7.79408037e-03  1.78584816e-02]]
grads:  [3.90266007e-03 5.96916902e+00]
Stock Position:  0.0039026600658530627
Bond Position:  [-7.56978722]


portfolio before change:  [-7.19608918]
curr_Stock_Price:  96.23967391316486
curr_Factors:  [9.62396739e+01 4.02039198e-02]
mat_Sqrt:  [[ 1.92969353e+01  0.00000000e+00]
 [-8.02036605e-03  1.83769673e-02]]
grads:  [-0.00841365  2.70411593]
Stock Position:  -0.008413649707109205
Bond Position:  [-6.38636227]


portfolio before change:  [-7.18494937]
curr_Stock_Price:  94.72587231950406
curr_Factors:  [9.47258723e+01 4.24827602e-02]
mat_Sqrt:  [[ 1.95242777e+01  0.00000000e+00]
 [-8.24453858e-03  1.88906111e-02]]
grads:  [ 0.00205256 -0.00679191]
Stock Position:  0.0020525602760713326
Bond Position:  [-7.37937993]


portfolio before change:  [-7.18542806]
curr_Stock_Price:  95.3915701488228
curr_Factors:  [9.53915701e+01 4.17602658e-02]
mat_Sqrt:  [[ 1.94935809e+01  0.00000000e+00]
 [-8.17413147e-03  1.87292881e-02]]
grads:  [-6.52111268e-03 -1.03462099e+01]
Stock Position:  -0.006521112676665669
Bond Position:  [-6.56336888]


portfolio before change:  [-7.17119259]
curr_Stock_Price:  92.95693618439574
curr_Factors:  [9.29569362e+01 4.24903158e-02]
mat_Sqrt:  [[ 1.91613799e+01  0.00000000e+00]
 [-8.24527169e-03  1.88922908e-02]]
grads:  [-0.01641543 -6.10772763]
Stock Position:  -0.016415433912147417
Bond Position:  [-5.64526414]


portfolio before change:  [-7.17525849]
curr_Stock_Price:  93.11863816745269
curr_Factors:  [9.31186382e+01 4.33942569e-02]
mat_Sqrt:  [[ 1.93978119e+01  0.00000000e+00]
 [-8.33251529e-03  1.90921910e-02]]
grads:  [0.00483197 0.74267143]
Stock Position:  0.004831971112985333
Bond Position:  [-7.62520506]


portfolio before change:  [-7.16818039]
curr_Stock_Price:  94.97805230272338
curr_Factors:  [9.49780523e+01 4.31189626e-02]
mat_Sqrt:  [[ 1.97222932e+01  0.00000000e+00]
 [-8.30604239e-03  1.90315340e-02]]
grads:  [ 1.41803440e-03 -4.44633257e+00]
Stock Position:  0.0014180343981659734
Bond Position:  [-7.30286254]


portfolio before change:  [-7.17117394]
curr_Stock_Price:  94.15465434783687
curr_Factors:  [9.41546543e+01 4.35354983e-02]
mat_Sqrt:  [[ 1.96455211e+01  0.00000000e+00]
 [-8.34606478e-03  1.91232368e-02]]
grads:  [  0.04128753 -24.49401731]
Stock Position:  0.04128752814580316
Bond Position:  [-11.05858688]


portfolio before change:  [-7.14194053]
curr_Stock_Price:  94.92966823743693
curr_Factors:  [9.49296682e+01 4.18713362e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.14194053]
Stock Price:  94.31032672588503
PL:  [-7.14194053]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.58974629e-02 -1.51321646e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.62582954e-01 -1.36436400e+00]
 [ 2.18887543e-02  2.42842439e-01]
 [-4.06584279e-01 -7.86733397e-02]
 [-3.25339818e-02  9.52443105e-02]
 [-2.60223284e-01  8.55807204e-02]
 [-1.28869705e-02  1.54967771e-01]
 [-2.39112823e-01  1.26447677e-01]
 [ 1.32338053e-01  1.24753588e-02]
 [-1.01858767e-01 -3.72659327e-02]
 [-1.83580130e-01  4.94273995e-02]
 [-1.09873406e-01  3.15316285e-02]
 [-2.04088491e-01 -2.65761126e-01]
 [-1.00277081e-01 -1.25113528e-01]
 [ 9.51563580e-02  2.81035981e-02]
 [-2.72513536e-02 -4.19133206e-02]
 [ 6.51148955e-01 -3.16933922e-01]
 [ 1.65422633e-01  1.46545730e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.76924241]
curr_Stock_Price:  97.04144031267586
curr_Factors:  [9.70414403e+01 3.96072004e-02]
mat_Sqrt:  [[ 1.93127584e+01  0.00000000e+00]
 [-7.96062313e-03  1.82400790e-02]]
grads:  [ 0.00182455 -0.08296107]
Stock Position:  0.0018245472983624209
Bond Position:  [-17.94629911]


portfolio before change:  [-17.77450733]
curr_Stock_Price:  96.61515073134808
curr_Factors:  [9.66151507e+01 3.96073818e-02]
mat_Sqrt:  [[ 1.92279641e+01  0.00000000e+00]
 [-7.96064137e-03  1.82401208e-02]]
grads:  [-0.00969031 -3.65414083]
Stock Position:  -0.009690306726789862
Bond Position:  [-16.83827689]


portfolio before change:  [-17.76756066]
curr_Stock_Price:  95.46381836390118
curr_Factors:  [9.54638184e+01 4.12777185e-02]
mat_Sqrt:  [[ 1.93953064e+01  0.00000000e+00]
 [-8.12676747e-03  1.86207636e-02]]
grads:  [-3.90836942e-02 -7.32711094e+01]
Stock Position:  -0.03908369420975458
Bond Position:  [-14.03648198]


portfolio before change:  [-17.93025108]
curr_Stock_Price:  99.53663840197981
curr_Factors:  [9.95366384e+01 4.09872734e-02]
mat_Sqrt:  [[ 2.01515049e+01  0.00000000e+00]
 [-8.09812555e-03  1.85551367e-02]]
grads:  [6.34562453e-03 1.30876125e+01]
Stock Position:  0.00634562452550663
Bond Position:  [-18.56187321]


portfolio before change:  [-17.9435599]
curr_Stock_Price:  98.1706927304989
curr_Factors:  [9.81706927e+01 4.11677688e-02]
mat_Sqrt:  [[ 1.99186784e+01  0.00000000e+00]
 [-8.11593680e-03  1.85959474e-02]]
grads:  [-0.02213601 -4.23067124]
Stock Position:  -0.02213601371037284
Bond Position:  [-15.7704521]


portfolio before change:  [-17.92970634]
curr_Stock_Price:  97.36672368855851
curr_Factors:  [9.73667237e+01 4.18653621e-02]
mat_Sqrt:  [[ 1.99222315e+01  0.00000000e+00]
 [-8.18441075e-03  1.87528409e-02]]
grads:  [4.53465425e-04 5.07892703e+00]
Stock Position:  0.000453465424536322
Bond Position:  [-17.97385878]


portfolio before change:  [-17.9351584]
curr_Stock_Price:  95.2540259706224
curr_Factors:  [9.52540260e+01 4.27145997e-02]
mat_Sqrt:  [[ 1.96866360e+01  0.00000000e+00]
 [-8.26700427e-03  1.89420864e-02]]
grads:  [-0.01132102  4.51801974]
Stock Position:  -0.011321019772228332
Bond Position:  [-16.85678569]


portfolio before change:  [-17.94411785]
curr_Stock_Price:  95.67313355034125
curr_Factors:  [9.56731336e+01 4.09922309e-02]
mat_Sqrt:  [[ 1.93704975e+01  0.00000000e+00]
 [-8.09861528e-03  1.85562588e-02]]
grads:  [2.82628308e-03 8.35124000e+00]
Stock Position:  0.0028262830779103958
Bond Position:  [-18.21451721]


portfolio before change:  [-17.95469145]
curr_Stock_Price:  93.54334057996398
curr_Factors:  [9.35433406e+01 3.97964988e-02]
mat_Sqrt:  [[ 1.86610170e+01  0.00000000e+00]
 [-7.97962393e-03  1.82836153e-02]]
grads:  [-0.00985619  6.91590118]
Stock Position:  -0.00985619017963005
Bond Position:  [-17.03271049]


portfolio before change:  [-17.96803033]
curr_Stock_Price:  94.46460668769335
curr_Factors:  [9.44646067e+01 3.86255212e-02]
mat_Sqrt:  [[ 1.85654849e+01  0.00000000e+00]
 [-7.86135064e-03  1.80126172e-02]]
grads:  [0.00742145 0.69259001]
Stock Position:  0.0074214460964592945
Bond Position:  [-18.66909432]


portfolio before change:  [-17.95952376]
curr_Stock_Price:  96.23978926109689
curr_Factors:  [9.62397893e+01 3.83905907e-02]
mat_Sqrt:  [[ 1.88567594e+01  0.00000000e+00]
 [-7.83740679e-03  1.79577549e-02]]
grads:  [-0.00626422 -2.07519998]
Stock Position:  -0.006264223362722689
Bond Position:  [-17.35665623]


portfolio before change:  [-17.96377827]
curr_Stock_Price:  96.22618837152952
curr_Factors:  [9.62261884e+01 3.93162702e-02]
mat_Sqrt:  [[ 1.90800469e+01  0.00000000e+00]
 [-7.93133232e-03  1.81729653e-02]]
grads:  [-0.00849098  2.71983127]
Stock Position:  -0.00849097723551195
Bond Position:  [-17.1467239]


portfolio before change:  [-17.97938341]
curr_Stock_Price:  97.55912343260847
curr_Factors:  [9.75591234e+01 3.94926374e-02]
mat_Sqrt:  [[ 1.93876851e+01  0.00000000e+00]
 [-7.94910182e-03  1.82136804e-02]]
grads:  [-0.00495737  1.73120576]
Stock Position:  -0.004957367212339513
Bond Position:  [-17.49574701]


portfolio before change:  [-17.99377131]
curr_Stock_Price:  99.57902894907411
curr_Factors:  [9.95790289e+01 3.83593040e-02]
mat_Sqrt:  [[ 1.95030820e+01  0.00000000e+00]
 [-7.83421256e-03  1.79504360e-02]]
grads:  [ -0.01641157 -14.80527411]
Stock Position:  -0.016411567987113487
Bond Position:  [-16.3595233]


portfolio before change:  [-17.98207721]
curr_Stock_Price:  98.61723827763568
curr_Factors:  [9.86172383e+01 3.89633326e-02]
mat_Sqrt:  [[ 1.94661867e+01  0.00000000e+00]
 [-7.89565273e-03  1.80912132e-02]]
grads:  [-0.00795642 -6.9157069 ]
Stock Position:  -0.007956417105006868
Bond Position:  [-17.19743732]


portfolio before change:  [-18.00475916]
curr_Stock_Price:  100.92758196085316
curr_Factors:  [1.00927582e+02 3.66430031e-02]
mat_Sqrt:  [[ 1.93199233e+01  0.00000000e+00]
 [-7.65694489e-03  1.75442648e-02]]
grads:  [0.00556016 1.6018681 ]
Stock Position:  0.005560155286120636
Bond Position:  [-18.56593219]


portfolio before change:  [-18.01358683]
curr_Stock_Price:  100.17479525635088
curr_Factors:  [1.00174795e+02 3.66063697e-02]
mat_Sqrt:  [[ 1.91662344e+01  0.00000000e+00]
 [-7.65311646e-03  1.75354927e-02]]
grads:  [-2.37625323e-03 -2.39019919e+00]
Stock Position:  -0.0023762532334486077
Bond Position:  [-17.77554615]


portfolio before change:  [-18.01292572]
curr_Stock_Price:  98.02622086213921
curr_Factors:  [9.80262209e+01 4.02679191e-02]
mat_Sqrt:  [[ 1.96707923e+01  0.00000000e+00]
 [-8.02674719e-03  1.83915883e-02]]
grads:  [  0.02607051 -17.23254768]
Stock Position:  0.026070513203615704
Bond Position:  [-20.56851961]


portfolio before change:  [-18.05418057]
curr_Stock_Price:  96.64105160440634
curr_Factors:  [9.66410516e+01 4.02324114e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.05418057]
Stock Price:  97.2404997689648
PL:  [-18.05418057]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.62256384e-01 -1.36991519e+00]
 [-1.38060570e-02  2.78184021e-01]
 [-4.50523977e-01 -1.81045910e-02]
 [ 6.51231836e-01 -5.64239741e-01]
 [-1.83824311e-01  4.36893504e-02]
 [-1.02964805e-01 -5.19096951e-02]
 [-2.27423643e-01  7.55778505e-02]
 [ 1.38868761e-01  1.20661308e-02]
 [-1.03305459e-01 -4.20318999e-02]
 [-1.30122678e-01  1.76338955e-02]
 [ 1.74172475e-01 -2.33851185e-02]
 [ 7.33158765e-02 -2.92548217e-02]
 [-3.00800770e-01 -9.99562698e-02]
 [ 8.29082558e-02  6.25360822e-02]
 [ 1.82829186e-02 -5.18242060e-02]
 [ 1.38349356e+00 -6.21235478e-01]
 [ 2.40383615e-01  2.48819559e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.8808396]
curr_Stock_Price:  98.33162122423332
curr_Factors:  [9.83316212e+01 4.16215296e-02]
mat_Sqrt:  [[ 2.00609834e+01  0.00000000e+00]
 [-8.16054210e-03  1.86981509e-02]]
grads:  [ 0.00138934 -0.07224427]
Stock Position:  0.0013893425420567216
Bond Position:  [-9.0174559]


portfolio before change:  [-8.88486422]
curr_Stock_Price:  97.05765725757367
curr_Factors:  [9.70576573e+01 4.17983353e-02]
mat_Sqrt:  [[ 1.98430898e+01  0.00000000e+00]
 [-8.17785647e-03  1.87378232e-02]]
grads:  [-0.00938991 -3.55708182]
Stock Position:  -0.009389912174107654
Bond Position:  [-7.97350134]


portfolio before change:  [-8.87163854]
curr_Stock_Price:  95.43684299517751
curr_Factors:  [9.54368430e+01 4.25093442e-02]
mat_Sqrt:  [[ 1.96769720e+01  0.00000000e+00]
 [-8.24711772e-03  1.88965206e-02]]
grads:  [-3.86307604e-02 -7.24956314e+01]
Stock Position:  -0.03863076044759834
Bond Position:  [-5.18484072]


portfolio before change:  [-8.88826312]
curr_Stock_Price:  95.83363077735669
curr_Factors:  [9.58336308e+01 4.13867562e-02]
mat_Sqrt:  [[ 1.94961401e+01  0.00000000e+00]
 [-8.13749408e-03  1.86453413e-02]]
grads:  [5.51921574e-03 1.49197602e+01]
Stock Position:  0.005519215737797173
Bond Position:  [-9.41718961]


portfolio before change:  [-8.90081311]
curr_Stock_Price:  93.98637581041913
curr_Factors:  [9.39863758e+01 4.44218540e-02]
mat_Sqrt:  [[ 1.98090315e+01  0.00000000e+00]
 [-8.43059703e-03  1.93169245e-02]]
grads:  [-0.02314225 -0.93723983]
Stock Position:  -0.023142245355416362
Bond Position:  [-6.72575735]


portfolio before change:  [-8.83243295]
curr_Stock_Price:  90.95893358177169
curr_Factors:  [9.09589336e+01 4.55888554e-02]
mat_Sqrt:  [[ 1.94211393e+01  0.00000000e+00]
 [-8.54061875e-03  1.95690160e-02]]
grads:  [ 2.08524030e-02 -2.88333222e+01]
Stock Position:  0.020852403006578427
Bond Position:  [-10.72914529]


portfolio before change:  [-8.78471743]
curr_Stock_Price:  93.37583236523213
curr_Factors:  [9.33758324e+01 4.39234109e-02]
mat_Sqrt:  [[ 1.95696255e+01  0.00000000e+00]
 [-8.38316512e-03  1.92082444e-02]]
grads:  [-0.008419    2.27451034]
Stock Position:  -0.008419001919238823
Bond Position:  [-7.99858612]


portfolio before change:  [-8.78971818]
curr_Stock_Price:  93.73227043451686
curr_Factors:  [9.37322704e+01 4.39435679e-02]
mat_Sqrt:  [[ 1.96488345e+01  0.00000000e+00]
 [-8.38508846e-03  1.92126513e-02]]
grads:  [-0.00639326 -2.70184965]
Stock Position:  -0.0063932572210758315
Bond Position:  [-8.19046366]


portfolio before change:  [-8.80282165]
curr_Stock_Price:  95.46153083255534
curr_Factors:  [9.54615308e+01 4.30742762e-02]
mat_Sqrt:  [[ 1.98124137e+01  0.00000000e+00]
 [-8.30173728e-03  1.90216697e-02]]
grads:  [-0.00981399  3.97325006]
Stock Position:  -0.009813986685244169
Bond Position:  [-7.86596346]


portfolio before change:  [-8.79688607]
curr_Stock_Price:  94.65632061498614
curr_Factors:  [9.46563206e+01 4.28141834e-02]
mat_Sqrt:  [[ 1.95858963e+01  0.00000000e+00]
 [-8.27663540e-03  1.89641541e-02]]
grads:  [0.00735911 0.6362599 ]
Stock Position:  0.007359114426151385
Bond Position:  [-9.49347276]


portfolio before change:  [-8.80712127]
curr_Stock_Price:  93.5880491171287
curr_Factors:  [9.35880491e+01 4.44756391e-02]
mat_Sqrt:  [[ 1.97370160e+01  0.00000000e+00]
 [-8.43569930e-03  1.93286153e-02]]
grads:  [-0.00616353 -2.17459447]
Stock Position:  -0.0061635296896096195
Bond Position:  [-8.23028855]


portfolio before change:  [-8.81337323]
curr_Stock_Price:  94.26852549978577
curr_Factors:  [9.42685255e+01 4.42836783e-02]
mat_Sqrt:  [[ 1.98375739e+01  0.00000000e+00]
 [-8.41747500e-03  1.92868582e-02]]
grads:  [-0.00617145  0.91429591]
Stock Position:  -0.006171450965139273
Bond Position:  [-8.23159965]


portfolio before change:  [-8.80748602]
curr_Stock_Price:  92.98108691242436
curr_Factors:  [9.29810869e+01 4.45782332e-02]
mat_Sqrt:  [[ 1.96316157e+01  0.00000000e+00]
 [-8.44542321e-03  1.93508956e-02]]
grads:  [ 0.00835216 -1.20847732]
Stock Position:  0.008352158809955735
Bond Position:  [-9.58407883]


portfolio before change:  [-8.81174523]
curr_Stock_Price:  92.75804426483275
curr_Factors:  [9.27580443e+01 4.40173812e-02]
mat_Sqrt:  [[ 1.94609342e+01  0.00000000e+00]
 [-8.39212785e-03  1.92287806e-02]]
grads:  [ 0.00311126 -1.52140806]
Stock Position:  0.0031112599770055024
Bond Position:  [-9.10033962]


portfolio before change:  [-8.82014798]
curr_Stock_Price:  90.78862375873395
curr_Factors:  [9.07886238e+01 4.53631084e-02]
mat_Sqrt:  [[ 1.93367212e+01  0.00000000e+00]
 [-8.51944678e-03  1.95205049e-02]]
grads:  [-0.01781198 -5.1205781 ]
Stock Position:  -0.017811978526521763
Bond Position:  [-7.20302296]


portfolio before change:  [-8.82240464]
curr_Stock_Price:  90.81420626275778
curr_Factors:  [9.08142063e+01 4.44757755e-02]
mat_Sqrt:  [[ 1.91520628e+01  0.00000000e+00]
 [-8.43571223e-03  1.93286449e-02]]
grads:  [0.00575401 3.23540954]
Stock Position:  0.00575401412747025
Bond Position:  [-9.34495086]


portfolio before change:  [-8.82042501]
curr_Stock_Price:  91.56431756297908
curr_Factors:  [9.15643176e+01 4.21984134e-02]
mat_Sqrt:  [[ 1.88093732e+01  0.00000000e+00]
 [-8.21690097e-03  1.88272853e-02]]
grads:  [-2.30471217e-04 -2.75261170e+00]
Stock Position:  -0.00023047121683946473
Bond Position:  [-8.79932208]


portfolio before change:  [-8.82232278]
curr_Stock_Price:  90.25248346746662
curr_Factors:  [9.02524835e+01 4.28397936e-02]
mat_Sqrt:  [[ 1.86802570e+01  0.00000000e+00]
 [-8.27911045e-03  1.89698252e-02]]
grads:  [  0.05954758 -32.74861381]
Stock Position:  0.05954758387184676
Bond Position:  [-14.19664011]


portfolio before change:  [-8.83089167]
curr_Stock_Price:  90.16819308769361
curr_Factors:  [9.01681931e+01 4.09862028e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.83089167]
Stock Price:  91.42173457532611
PL:  [-8.83089167]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-3.39142372e-02  1.80067883e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.57183968e-01 -5.33053329e-01]
 [ 2.16119032e-01 -6.74272475e-02]
 [-1.04000061e-01 -7.34060861e-02]
 [ 6.97829072e-01 -9.55992636e-01]
 [-6.10125225e-01  5.52658207e-01]
 [ 4.06740439e-01  1.64638251e-01]
 [-3.39871906e-02 -4.88274492e-02]
 [ 3.07856045e-02  2.25173251e-02]
 [ 2.57221788e-01  3.84781819e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-5.68663198e-02  9.09805980e-02]
 [-2.71909166e-01 -2.53159172e-01]
 [ 1.43460350e-01  1.08554914e-03]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.22374950e-02  7.82677157e-02]
 [ 2.28997150e-01 -1.24953699e-01]
 [ 1.08023792e-01  1.05587554e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.73539906]
curr_Stock_Price:  101.03382951433302
curr_Factors:  [1.01033830e+02 4.16172443e-02]
mat_Sqrt:  [[ 2.06112094e+01  0.00000000e+00]
 [-8.16012199e-03  1.86971884e-02]]
grads:  [2.16745311e-03 9.63074657e+00]
Stock Position:  0.0021674531054709594
Bond Position:  [9.51641297]


portfolio before change:  [9.73753713]
curr_Stock_Price:  100.92248717096079
curr_Factors:  [1.00922487e+02 3.68682611e-02]
mat_Sqrt:  [[ 1.93782374e+01  0.00000000e+00]
 [-7.68044385e-03  1.75981077e-02]]
grads:  [-0.00961516 -3.78745098]
Stock Position:  -0.009615160878154725
Bond Position:  [10.70792308]


portfolio before change:  [9.73986926]
curr_Stock_Price:  100.95838738397187
curr_Factors:  [1.00958387e+02 3.69125267e-02]
mat_Sqrt:  [[ 1.93967644e+01  0.00000000e+00]
 [-7.68505320e-03  1.76086690e-02]]
grads:  [-2.00975536e-02 -3.02722102e+01]
Stock Position:  -0.020097553639973807
Bond Position:  [11.76888587]


portfolio before change:  [9.71839771]
curr_Stock_Price:  102.17316889910649
curr_Factors:  [1.02173169e+02 3.56877139e-02]
mat_Sqrt:  [[ 1.93017296e+01  0.00000000e+00]
 [-7.55647684e-03  1.73140636e-02]]
grads:  [ 0.00967226 -3.89436294]
Stock Position:  0.009672261083905832
Bond Position:  [8.73015215]


portfolio before change:  [9.73595489]
curr_Stock_Price:  103.76270081112018
curr_Factors:  [1.03762701e+02 3.40686542e-02]
mat_Sqrt:  [[ 1.91522039e+01  0.00000000e+00]
 [-7.38307841e-03  1.69167578e-02]]
grads:  [-0.00710295 -4.33925264]
Stock Position:  -0.007102947753487464
Bond Position:  [10.47297594]


portfolio before change:  [9.73473881]
curr_Stock_Price:  104.3025689006012
curr_Factors:  [1.04302569e+02 3.40305239e-02]
mat_Sqrt:  [[ 1.92410746e+01  0.00000000e+00]
 [-7.37894560e-03  1.69072884e-02]]
grads:  [ 1.45833684e-02 -5.65432265e+01]
Stock Position:  0.014583368437148303
Bond Position:  [8.21365602]


portfolio before change:  [9.74727136]
curr_Stock_Price:  105.02111924870306
curr_Factors:  [1.05021119e+02 3.43287098e-02]
mat_Sqrt:  [[ 1.94583219e+01  0.00000000e+00]
 [-7.41120338e-03  1.69812002e-02]]
grads:  [-1.89597752e-02  3.25452971e+01]
Stock Position:  -0.018959775216429605
Bond Position:  [11.73844818]


portfolio before change:  [9.78582019]
curr_Stock_Price:  103.14272954979882
curr_Factors:  [1.03142730e+02 3.46692409e-02]
mat_Sqrt:  [[ 1.92048441e+01  0.00000000e+00]
 [-7.44787121e-03  1.70652168e-02]]
grads:  [0.02492051 9.64759215]
Stock Position:  0.02492050752014935
Bond Position:  [7.21545102]


portfolio before change:  [9.78357122]
curr_Stock_Price:  102.98009004823054
curr_Factors:  [1.02980090e+02 3.34242232e-02]
mat_Sqrt:  [[ 1.88271216e+01  0.00000000e+00]
 [-7.31291714e-03  1.67559982e-02]]
grads:  [-0.00293711 -2.91402808]
Stock Position:  -0.00293710517898893
Bond Position:  [10.08603458]


portfolio before change:  [9.77821246]
curr_Stock_Price:  105.66320407241331
curr_Factors:  [1.05663204e+02 3.10875585e-02]
mat_Sqrt:  [[ 1.86301814e+01  0.00000000e+00]
 [-7.05266571e-03  1.61596872e-02]]
grads:  [0.00217996 1.3934258 ]
Stock Position:  0.002179955737781062
Bond Position:  [9.54787135]


portfolio before change:  [9.78063386]
curr_Stock_Price:  105.67886572274831
curr_Factors:  [1.05678866e+02 3.04483467e-02]
mat_Sqrt:  [[ 1.84403857e+01  0.00000000e+00]
 [-6.97978186e-03  1.59926894e-02]]
grads:  [2.3055610e-02 2.4059857e+01]
Stock Position:  0.02305560998072916
Bond Position:  [7.34414315]


portfolio before change:  [9.79579655]
curr_Stock_Price:  106.25687763391326
curr_Factors:  [1.06256878e+02 2.94854188e-02]
mat_Sqrt:  [[ 1.82457072e+01  0.00000000e+00]
 [-6.86852750e-03  1.57377736e-02]]
grads:  [-0.01035904  7.26488554]
Stock Position:  -0.01035903745425743
Bond Position:  [10.89651552]


portfolio before change:  [9.81220991]
curr_Stock_Price:  104.9354327375448
curr_Factors:  [1.04935433e+02 2.96853931e-02]
mat_Sqrt:  [[ 1.80797974e+01  0.00000000e+00]
 [-6.89177981e-03  1.57910513e-02]]
grads:  [-9.49077644e-04  5.76152886e+00]
Stock Position:  -0.0009490776441260068
Bond Position:  [9.91180179]


portfolio before change:  [9.81698094]
curr_Stock_Price:  102.5196461226106
curr_Factors:  [1.02519646e+02 3.34564796e-02]
mat_Sqrt:  [[ 1.87519838e+01  0.00000000e+00]
 [-7.31644500e-03  1.67640815e-02]]
grads:  [ -0.02039234 -15.10128496]
Stock Position:  -0.020392343050971654
Bond Position:  [11.90759673]


portfolio before change:  [9.81125225]
curr_Stock_Price:  102.94656922088448
curr_Factors:  [1.02946569e+02 3.42699528e-02]
mat_Sqrt:  [[ 1.90576186e+01  0.00000000e+00]
 [-7.40485817e-03  1.69666615e-02]]
grads:  [0.00755258 0.0639813 ]
Stock Position:  0.0075525765287331615
Bond Position:  [9.03374041]


portfolio before change:  [9.81793323]
curr_Stock_Price:  103.5320999989662
curr_Factors:  [1.03532100e+02 3.51255884e-02]
mat_Sqrt:  [[ 1.94038017e+01  0.00000000e+00]
 [-7.49672871e-03  1.71771634e-02]]
grads:  [0.00494727 1.02060249]
Stock Position:  0.004947274345405692
Bond Position:  [9.30573153]


portfolio before change:  [9.82218442]
curr_Stock_Price:  103.92109495784645
curr_Factors:  [1.03921095e+02 3.44726195e-02]
mat_Sqrt:  [[ 1.92948256e+01  0.00000000e+00]
 [-7.42672143e-03  1.70167566e-02]]
grads:  [-9.36969515e-04  4.59944970e+00]
Stock Position:  -0.0009369695151599988
Bond Position:  [9.91955532]


portfolio before change:  [9.82382367]
curr_Stock_Price:  104.81861297671797
curr_Factors:  [1.04818613e+02 3.64177062e-02]
mat_Sqrt:  [[ 2.00029801e+01  0.00000000e+00]
 [-7.63336950e-03  1.74902468e-02]]
grads:  [ 0.00872184 -7.14419305]
Stock Position:  0.008721844618241794
Bond Position:  [8.90961202]


portfolio before change:  [9.82520131]
curr_Stock_Price:  104.72115181056714
curr_Factors:  [1.04721152e+02 3.82278584e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.82520131]
Stock Price:  104.50801426913704
PL:  [5.31718705]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.46463830e-02  2.53042708e-01]
 [ 1.79958839e-01 -2.06597692e-02]
 [-1.07374390e-01 -1.93209671e-01]
 [ 4.50082030e-01 -4.59202335e-01]
 [-8.71925007e-02 -5.22671339e-02]
 [ 7.68107236e-01 -1.06472567e+00]
 [-6.33184807e-01  6.43413499e-01]
 [ 6.97448562e-01  1.87473120e-01]
 [ 2.30587714e-01 -1.80018039e-01]
 [ 3.44196783e-02  2.23202347e-02]
 [ 2.21522055e-01  3.27787826e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-8.46071661e-02  1.11474309e-01]
 [-2.82980226e-01 -1.84449799e-01]
 [ 1.85051278e-01  1.01200332e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.23283348e-02  6.61338299e-02]
 [ 4.01453047e-01 -2.36679903e-01]
 [ 2.23381830e-01  1.22646283e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.20468083]
curr_Stock_Price:  101.53740717761481
curr_Factors:  [1.01537407e+02 3.96517763e-02]
mat_Sqrt:  [[ 2.02188939e+01  0.00000000e+00]
 [-7.96510151e-03  1.82503403e-02]]
grads:  [6.18645487e-03 1.38650953e+01]
Stock Position:  0.006186454874385402
Bond Position:  [12.57652425]


portfolio before change:  [13.21927065]
curr_Stock_Price:  103.38746454166277
curr_Factors:  [1.03387465e+02 3.87209527e-02]
mat_Sqrt:  [[ 2.03442134e+01  0.00000000e+00]
 [-7.87105611e-03  1.80348552e-02]]
grads:  [ 0.0084025  -1.14554672]
Stock Position:  0.00840249623515172
Bond Position:  [12.35055787]


portfolio before change:  [13.22558638]
curr_Stock_Price:  103.77160043256809
curr_Factors:  [1.03771600e+02 3.64922021e-02]
mat_Sqrt:  [[ 1.98234185e+01  0.00000000e+00]
 [-7.64117291e-03  1.75081266e-02]]
grads:  [-9.67027981e-03 -1.10354280e+01]
Stock Position:  -0.00967027980887456
Bond Position:  [14.22908679]


portfolio before change:  [13.1967119]
curr_Stock_Price:  107.12540200424752
curr_Factors:  [1.07125402e+02 3.44258501e-02]
mat_Sqrt:  [[ 1.98762660e+01  0.00000000e+00]
 [-7.42168176e-03  1.70052092e-02]]
grads:  [ 1.25611974e-02 -2.70036275e+01]
Stock Position:  0.012561197377038577
Bond Position:  [11.85108858]


portfolio before change:  [13.20564276]
curr_Stock_Price:  107.6004939080363
curr_Factors:  [1.07600494e+02 3.38099399e-02]
mat_Sqrt:  [[ 1.97850187e+01  0.00000000e+00]
 [-7.35499177e-03  1.68524033e-02]]
grads:  [-0.00555995 -3.1014647 ]
Stock Position:  -0.005559951696097182
Bond Position:  [13.80389631]


portfolio before change:  [13.22297451]
curr_Stock_Price:  105.10400769498443
curr_Factors:  [1.05104008e+02 3.27791503e-02]
mat_Sqrt:  [[ 1.90290945e+01  0.00000000e+00]
 [-7.24200528e-03  1.65935187e-02]]
grads:  [ 1.59452074e-02 -6.41651533e+01]
Stock Position:  0.01594520737452689
Bond Position:  [11.54706931]


portfolio before change:  [13.24611654]
curr_Stock_Price:  106.37428914924966
curr_Factors:  [1.06374289e+02 3.39459705e-02]
mat_Sqrt:  [[ 1.95988589e+01  0.00000000e+00]
 [-7.36977291e-03  1.68862711e-02]]
grads:  [-1.79794210e-02  3.81027578e+01]
Stock Position:  -0.01797942097686885
Bond Position:  [15.15866466]


portfolio before change:  [13.25561328]
curr_Stock_Price:  106.05689276803803
curr_Factors:  [1.06056893e+02 3.62109248e-02]
mat_Sqrt:  [[ 2.01817447e+01  0.00000000e+00]
 [-7.61166734e-03  1.74405209e-02]]
grads:  [ 0.03861255 10.74928445]
Stock Position:  0.038612545707502985
Bond Position:  [9.16048666]


portfolio before change:  [13.28224896]
curr_Stock_Price:  106.68739424598999
curr_Factors:  [1.06687394e+02 3.37418319e-02]
mat_Sqrt:  [[ 1.95973539e+01  0.00000000e+00]
 [-7.34757994e-03  1.68354206e-02]]
grads:  [ 7.75724114e-03 -1.06928150e+01]
Stock Position:  0.007757241140474351
Bond Position:  [12.45464911]


portfolio before change:  [13.27695392]
curr_Stock_Price:  105.60336272595117
curr_Factors:  [1.05603363e+02 3.28412876e-02]
mat_Sqrt:  [[ 1.91376160e+01  0.00000000e+00]
 [-7.24886612e-03  1.66092389e-02]]
grads:  [0.00230755 1.34384453]
Stock Position:  0.002307551131340386
Bond Position:  [13.03326876]


portfolio before change:  [13.27781176]
curr_Stock_Price:  104.56291935346485
curr_Factors:  [1.04562919e+02 3.49580586e-02]
mat_Sqrt:  [[ 1.95502067e+01  0.00000000e+00]
 [-7.47882970e-03  1.71361516e-02]]
grads:  [1.86484162e-02 1.91284387e+01]
Stock Position:  0.018648416176425105
Bond Position:  [11.32787893]


portfolio before change:  [13.28952753]
curr_Stock_Price:  105.03928363517332
curr_Factors:  [1.05039284e+02 3.62541486e-02]
mat_Sqrt:  [[ 2.00000281e+01  0.00000000e+00]
 [-7.61620888e-03  1.74509268e-02]]
grads:  [-0.00945038  6.5516935 ]
Stock Position:  -0.009450384908975748
Bond Position:  [14.28218919]


portfolio before change:  [13.2815579]
curr_Stock_Price:  106.26046330548226
curr_Factors:  [1.06260463e+02 3.42192116e-02]
mat_Sqrt:  [[ 1.96565233e+01  0.00000000e+00]
 [-7.39937420e-03  1.69540962e-02]]
grads:  [-1.82920389e-03  6.57506647e+00]
Stock Position:  -0.0018292038913570864
Bond Position:  [13.47592996]


portfolio before change:  [13.28638779]
curr_Stock_Price:  105.46203801905507
curr_Factors:  [1.05462038e+02 3.39966940e-02]
mat_Sqrt:  [[ 1.94452935e+01  0.00000000e+00]
 [-7.37527698e-03  1.68988825e-02]]
grads:  [ -0.01869248 -10.91491105]
Stock Position:  -0.018692477826386302
Bond Position:  [15.2577346]


portfolio before change:  [13.30214644]
curr_Stock_Price:  104.82307828759843
curr_Factors:  [1.04823078e+02 3.58043234e-02]
mat_Sqrt:  [[ 1.98346547e+01  0.00000000e+00]
 [-7.56881215e-03  1.73423273e-02]]
grads:  [0.01155648 5.83545275]
Stock Position:  0.011556476645544786
Bond Position:  [12.09076098]


portfolio before change:  [13.28119984]
curr_Stock_Price:  102.74894588107193
curr_Factors:  [1.02748946e+02 3.70693624e-02]
mat_Sqrt:  [[ 1.97826712e+01  0.00000000e+00]
 [-7.70136221e-03  1.76460376e-02]]
grads:  [0.00485253 0.99348398]
Stock Position:  0.004852526191791108
Bond Position:  [12.78260789]


portfolio before change:  [13.2886314]
curr_Stock_Price:  103.62179118720073
curr_Factors:  [1.03621791e+02 3.71690454e-02]
mat_Sqrt:  [[ 1.99775303e+01  0.00000000e+00]
 [-7.71171010e-03  1.76697476e-02]]
grads:  [-1.17457788e-03  3.74277161e+00]
Stock Position:  -0.0011745778750446518
Bond Position:  [13.41034326]


portfolio before change:  [13.2942263]
curr_Stock_Price:  101.71310891119298
curr_Factors:  [1.01713109e+02 3.84836170e-02]
mat_Sqrt:  [[ 1.99533064e+01  0.00000000e+00]
 [-7.84689666e-03  1.79794990e-02]]
grads:  [  0.01494276 -13.16387645]
Stock Position:  0.014942760030150446
Bond Position:  [11.77435172]


portfolio before change:  [13.27793463]
curr_Stock_Price:  100.42582142703331
curr_Factors:  [1.00425821e+02 3.72417631e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.27793463]
Stock Price:  100.64924600098396
PL:  [12.62868863]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-3.61112413e-02  5.58242688e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.14125784e-01 -1.02506898e+00]
 [-2.95755257e-02  2.76531494e-01]
 [-3.85325387e-01 -1.12619159e-01]
 [ 5.79308162e-01 -7.72624455e-01]
 [-5.64584741e-01  4.00600892e-01]
 [ 3.07248480e-01  1.56823245e-01]
 [-1.23044159e-01 -2.41437669e-02]
 [ 1.77995154e-01  1.45335613e-02]
 [ 1.65929894e-01  2.39035927e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-3.73053806e-02  7.65298404e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 1.87354362e-01  1.08285046e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.16667382e-02 -2.35552760e-02]
 [ 3.20894825e-01 -2.13234056e-01]
 [ 2.04621287e-01  9.17383751e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.6397636]
curr_Stock_Price:  99.71356810181669
curr_Factors:  [9.97135681e+01 4.06262656e-02]
mat_Sqrt:  [[ 2.00982252e+01  0.00000000e+00]
 [-8.06238333e-03  1.84732409e-02]]
grads:  [-0.00167551  0.3021899 ]
Stock Position:  -0.001675514633686278
Bond Position:  [0.80683514]


portfolio before change:  [0.64239553]
curr_Stock_Price:  98.2631498285138
curr_Factors:  [9.82631498e+01 3.98593047e-02]
mat_Sqrt:  [[ 1.96180366e+01  0.00000000e+00]
 [-7.98591808e-03  1.82980370e-02]]
grads:  [-0.00949763 -3.64257489]
Stock Position:  -0.009497630874707749
Bond Position:  [1.57566266]


portfolio before change:  [0.65160144]
curr_Stock_Price:  97.33534563118
curr_Factors:  [9.73353456e+01 4.17879799e-02]
mat_Sqrt:  [[ 1.98973969e+01  0.00000000e+00]
 [-8.17684339e-03  1.87355019e-02]]
grads:  [-3.32456836e-02 -5.47126511e+01]
Stock Position:  -0.033245683592807496
Bond Position:  [3.88758154]


portfolio before change:  [0.64681244]
curr_Stock_Price:  97.50863184322695
curr_Factors:  [9.75086318e+01 3.96674857e-02]
mat_Sqrt:  [[ 1.94204997e+01  0.00000000e+00]
 [-7.96667917e-03  1.82539552e-02]]
grads:  [4.69157407e-03 1.51491275e+01]
Stock Position:  0.004691574069489283
Bond Position:  [0.18934347]


portfolio before change:  [0.65836827]
curr_Stock_Price:  99.96164540984365
curr_Factors:  [9.99616454e+01 3.83899699e-02]
mat_Sqrt:  [[ 1.95858436e+01  0.00000000e+00]
 [-7.83734342e-03  1.79576097e-02]]
grads:  [-0.02218319 -6.27138919]
Stock Position:  -0.022183186333085997
Bond Position:  [2.87583608]


portfolio before change:  [0.59285442]
curr_Stock_Price:  102.94737077224289
curr_Factors:  [1.02947371e+02 3.72190224e-02]
mat_Sqrt:  [[ 1.98608458e+01  0.00000000e+00]
 [-7.71689289e-03  1.76816229e-02]]
grads:  [ 1.21901759e-02 -4.36964672e+01]
Stock Position:  0.012190175904800628
Bond Position:  [-0.66209214]


portfolio before change:  [0.59019831]
curr_Stock_Price:  102.74306174988018
curr_Factors:  [1.02743062e+02 3.42398415e-02]
mat_Sqrt:  [[ 1.90115872e+01  0.00000000e+00]
 [-7.40160432e-03  1.69592060e-02]]
grads:  [-2.05005596e-02  2.36214414e+01]
Stock Position:  -0.0205005596312178
Bond Position:  [2.69648858]


portfolio before change:  [0.60318024]
curr_Stock_Price:  102.14270127610202
curr_Factors:  [1.02142701e+02 3.21191599e-02]
mat_Sqrt:  [[ 1.83058301e+01  0.00000000e+00]
 [-7.16872763e-03  1.64256185e-02]]
grads:  [0.02052307 9.54747885]
Stock Position:  0.02052306577294317
Bond Position:  [-1.49310113]


portfolio before change:  [0.6028591]
curr_Stock_Price:  102.14524372557023
curr_Factors:  [1.02145244e+02 3.33375517e-02]
mat_Sqrt:  [[ 1.86502647e+01  0.00000000e+00]
 [-7.30342952e-03  1.67342593e-02]]
grads:  [-0.00716244 -1.44277476]
Stock Position:  -0.007162437874386372
Bond Position:  [1.33446806]


portfolio before change:  [0.59616147]
curr_Stock_Price:  103.12693340220271
curr_Factors:  [1.03126933e+02 3.27820941e-02]
mat_Sqrt:  [[ 1.86719833e+01  0.00000000e+00]
 [-7.24233046e-03  1.65942638e-02]]
grads:  [0.00987244 0.87581838]
Stock Position:  0.009872444573166552
Bond Position:  [-0.42195347]


portfolio before change:  [0.5925269]
curr_Stock_Price:  102.76946654720665
curr_Factors:  [1.02769467e+02 3.25559388e-02]
mat_Sqrt:  [[ 1.85429665e+01  0.00000000e+00]
 [-7.21730574e-03  1.65369249e-02]]
grads:  [ 0.01457446 14.45467814]
Stock Position:  0.014574460103897466
Bond Position:  [-0.90528259]


portfolio before change:  [0.61381664]
curr_Stock_Price:  104.24575396251575
curr_Factors:  [1.04245754e+02 3.11896671e-02]
mat_Sqrt:  [[ 1.84104220e+01  0.00000000e+00]
 [-7.06423862e-03  1.61862041e-02]]
grads:  [-0.01026636  7.0636156 ]
Stock Position:  -0.010266356930063615
Bond Position:  [1.68404076]


portfolio before change:  [0.61668664]
curr_Stock_Price:  104.00721382972938
curr_Factors:  [1.04007214e+02 3.14314403e-02]
mat_Sqrt:  [[ 1.84393498e+01  0.00000000e+00]
 [-7.09156573e-03  1.62488184e-02]]
grads:  [-2.11776447e-04  4.70987112e+00]
Stock Position:  -0.00021177644665252478
Bond Position:  [0.63871292]


portfolio before change:  [0.61694657]
curr_Stock_Price:  103.53393978782798
curr_Factors:  [1.03533940e+02 3.10104032e-02]
mat_Sqrt:  [[ 1.82320896e+01  0.00000000e+00]
 [-7.04390838e-03  1.61396217e-02]]
grads:  [ -0.02253393 -15.45695388]
Stock Position:  -0.02253392725490777
Bond Position:  [2.94997283]


portfolio before change:  [0.58537802]
curr_Stock_Price:  104.9676060676686
curr_Factors:  [1.04967606e+02 3.06868081e-02]
mat_Sqrt:  [[ 1.83878584e+01  0.00000000e+00]
 [-7.00706022e-03  1.60551919e-02]]
grads:  [0.01275917 6.74455005]
Stock Position:  0.012759170997362526
Bond Position:  [-0.75392162]


portfolio before change:  [0.57740309]
curr_Stock_Price:  104.35734502453757
curr_Factors:  [1.04357345e+02 3.18016756e-02]
mat_Sqrt:  [[ 1.86100707e+01  0.00000000e+00]
 [-7.13320972e-03  1.63442367e-02]]
grads:  [0.00515828 1.07261391]
Stock Position:  0.005158278641888032
Bond Position:  [0.03909883]


portfolio before change:  [0.56215539]
curr_Stock_Price:  101.39948265823136
curr_Factors:  [1.01399483e+02 3.40047918e-02]
mat_Sqrt:  [[ 1.86984583e+01  0.00000000e+00]
 [-7.37615530e-03  1.69008950e-02]]
grads:  [-0.00331295 -1.39372951]
Stock Position:  -0.0033129524653452624
Bond Position:  [0.89808705]


portfolio before change:  [0.55699086]
curr_Stock_Price:  103.02615165465805
curr_Factors:  [1.03026152e+02 3.27500535e-02]
mat_Sqrt:  [[ 1.86446178e+01  0.00000000e+00]
 [-7.23879034e-03  1.65861523e-02]]
grads:  [ 1.22197117e-02 -1.28561496e+01]
Stock Position:  0.012219711668730718
Bond Position:  [-0.70195901]


portfolio before change:  [0.53953225]
curr_Stock_Price:  101.6117892345025
curr_Factors:  [1.01611789e+02 3.26807432e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.53953225]
Stock Price:  101.91282279563073
PL:  [-1.37329055]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-9.07667225e-02  3.45243239e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.87026849e-01 -7.36667060e-01]
 [ 2.22590805e-01 -7.82643444e-02]
 [-1.69985134e-01 -8.42602066e-02]
 [ 4.54538968e-01 -5.79535483e-01]
 [-5.47361449e-01  3.51863868e-01]
 [ 1.49901414e-01  1.44463771e-01]
 [-2.04728038e-01 -1.28492878e-02]
 [ 2.01938849e-01  8.11402559e-03]
 [-9.73792722e-02 -2.25087374e-02]
 [-2.16885547e-01  6.92269722e-02]
 [-1.02535147e-01  2.51195409e-02]
 [-8.48518697e-02 -2.13712947e-01]
 [-2.47114021e-01 -1.22615916e-01]
 [ 9.00928354e-02  1.43726035e-02]
 [ 6.12309168e-02 -8.04295923e-02]
 [ 9.02663756e-01 -4.21507242e-01]
 [ 1.49434314e-01  1.56744414e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.03501637]
curr_Stock_Price:  100.061246922356
curr_Factors:  [1.00061247e+02 3.82078285e-02]
mat_Sqrt:  [[ 1.95587947e+01  0.00000000e+00]
 [-7.81872916e-03  1.79149591e-02]]
grads:  [-0.00387033  1.92712267]
Stock Position:  -0.0038703342057209026
Bond Position:  [3.42228684]


portfolio before change:  [3.03354493]
curr_Stock_Price:  100.66251824592074
curr_Factors:  [1.00662518e+02 3.66736725e-02]
mat_Sqrt:  [[ 1.92772461e+01  0.00000000e+00]
 [-7.66014856e-03  1.75516053e-02]]
grads:  [-0.00966553 -3.7974857 ]
Stock Position:  -0.009665533610258889
Bond Position:  [4.00650188]


portfolio before change:  [3.04746797]
curr_Stock_Price:  99.32567675745837
curr_Factors:  [9.93256768e+01 3.80359033e-02]
mat_Sqrt:  [[ 1.93712836e+01  0.00000000e+00]
 [-7.80111820e-03  1.78746073e-02]]
grads:  [-2.62519884e-02 -4.12130486e+01]
Stock Position:  -0.026251988389749417
Bond Position:  [5.65496448]


portfolio before change:  [2.97054155]
curr_Stock_Price:  102.30984449673078
curr_Factors:  [1.02309844e+02 3.69278418e-02]
mat_Sqrt:  [[ 1.96604923e+01  0.00000000e+00]
 [-7.68664731e-03  1.76123216e-02]]
grads:  [ 0.00958437 -4.44372675]
Stock Position:  0.009584370650272022
Bond Position:  [1.98996608]


portfolio before change:  [2.97168686]
curr_Stock_Price:  102.37742957017372
curr_Factors:  [1.02377430e+02 3.80424922e-02]
mat_Sqrt:  [[ 1.99681901e+01  0.00000000e+00]
 [-7.80179387e-03  1.78761555e-02]]
grads:  [-0.01035443 -4.71355302]
Stock Position:  -0.010354433861975841
Bond Position:  [4.03174719]


portfolio before change:  [2.98155415]
curr_Stock_Price:  101.52183243819994
curr_Factors:  [1.01521832e+02 3.80977059e-02]
mat_Sqrt:  [[ 1.98156745e+01  0.00000000e+00]
 [-7.80745346e-03  1.78891232e-02]]
grads:  [ 1.01742157e-02 -3.23959691e+01]
Stock Position:  0.010174215726709443
Bond Position:  [1.94864912]


portfolio before change:  [2.98668172]
curr_Stock_Price:  101.97792159509203
curr_Factors:  [1.01977922e+02 3.61105913e-02]
mat_Sqrt:  [[ 1.93786472e+01  0.00000000e+00]
 [-7.60111479e-03  1.74163419e-02]]
grads:  [-0.0203211 20.2030868]
Stock Position:  -0.020321102056535915
Bond Position:  [5.05898547]


portfolio before change:  [3.0165339]
curr_Stock_Price:  100.57114391130212
curr_Factors:  [1.00571144e+02 3.56132808e-02]
mat_Sqrt:  [[ 1.89792647e+01  0.00000000e+00]
 [-7.54859254e-03  1.72959984e-02]]
grads:  [0.01122017 8.35243899]
Stock Position:  0.011220169814766276
Bond Position:  [1.88810859]


portfolio before change:  [2.98767475]
curr_Stock_Price:  97.95699124728493
curr_Factors:  [9.79569912e+01 3.59631102e-02]
mat_Sqrt:  [[ 1.85765072e+01  0.00000000e+00]
 [-7.58557686e-03  1.73807401e-02]]
grads:  [-0.01132268 -0.73928312]
Stock Position:  -0.01132268434569155
Bond Position:  [4.09681084]


portfolio before change:  [3.00130369]
curr_Stock_Price:  96.84377362027799
curr_Factors:  [9.68437736e+01 3.74215543e-02]
mat_Sqrt:  [[ 1.87340905e+01  0.00000000e+00]
 [-7.73786061e-03  1.77296660e-02]]
grads:  [0.01096825 0.45765248]
Stock Position:  0.010968245299116037
Bond Position:  [1.93909743]


portfolio before change:  [3.00043608]
curr_Stock_Price:  96.7204676964076
curr_Factors:  [9.67204677e+01 3.78365587e-02]
mat_Sqrt:  [[ 1.88136995e+01  0.00000000e+00]
 [-7.78064868e-03  1.78277058e-02]]
grads:  [-0.00569813 -1.26257061]
Stock Position:  -0.005698129210230408
Bond Position:  [3.5515618]


portfolio before change:  [2.99720686]
curr_Stock_Price:  97.44302320602078
curr_Factors:  [9.74430232e+01 3.69639192e-02]
mat_Sqrt:  [[ 1.87343986e+01  0.00000000e+00]
 [-7.69040121e-03  1.76209228e-02]]
grads:  [-0.00996415  3.92868029]
Stock Position:  -0.009964153313854703
Bond Position:  [3.96814409]


portfolio before change:  [3.0066837]
curr_Stock_Price:  96.59150284295197
curr_Factors:  [9.65915028e+01 3.96258462e-02]
mat_Sqrt:  [[ 1.92277381e+01  0.00000000e+00]
 [-7.96249672e-03  1.82443720e-02]]
grads:  [-0.0047625  1.3768378]
Stock Position:  -0.0047624988654755744
Bond Position:  [3.46670063]


portfolio before change:  [3.00651934]
curr_Stock_Price:  96.80801592166573
curr_Factors:  [9.68080159e+01 4.05553301e-02]
mat_Sqrt:  [[ 1.94955409e+01  0.00000000e+00]
 [-8.05534160e-03  1.84571063e-02]]
grads:  [-9.13664551e-03 -1.15788978e+01]
Stock Position:  -0.00913664551309734
Bond Position:  [3.89101987]


portfolio before change:  [3.03336881]
curr_Stock_Price:  93.97583996874981
curr_Factors:  [9.39758400e+01 4.36457464e-02]
mat_Sqrt:  [[ 1.96330231e+01  0.00000000e+00]
 [-8.35662577e-03  1.91474351e-02]]
grads:  [-0.01531236 -6.40377761]
Stock Position:  -0.01531236383594653
Bond Position:  [4.47236106]


portfolio before change:  [3.05278]
curr_Stock_Price:  92.78118681700775
curr_Factors:  [9.27811868e+01 4.38254551e-02]
mat_Sqrt:  [[ 1.94233055e+01  0.00000000e+00]
 [-8.37381205e-03  1.91868138e-02]]
grads:  [0.00496134 0.74908756]
Stock Position:  0.004961336464741639
Bond Position:  [2.59246132]


portfolio before change:  [3.05934389]
curr_Stock_Price:  93.97354558468234
curr_Factors:  [9.39735456e+01 4.39046395e-02]
mat_Sqrt:  [[ 1.96906848e+01  0.00000000e+00]
 [-8.38137359e-03  1.92041395e-02]]
grads:  [ 1.32695054e-03 -4.18813832e+00]
Stock Position:  0.001326950539647798
Bond Position:  [2.93464564]


portfolio before change:  [3.06190745]
curr_Stock_Price:  95.35250388599447
curr_Factors:  [9.53525039e+01 4.33370170e-02]
mat_Sqrt:  [[ 1.98500502e+01  0.00000000e+00]
 [-8.32701791e-03  1.90795949e-02]]
grads:  [  0.0362066  -22.09204354]
Stock Position:  0.03620660440023178
Bond Position:  [-0.39048293]


portfolio before change:  [3.06582071]
curr_Stock_Price:  95.46328165324816
curr_Factors:  [9.54632817e+01 4.39145112e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.06582071]
Stock Price:  93.61688113776832
PL:  [3.06582071]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 8.26189640e-02  3.55188998e-01]
 [ 1.84609279e-01 -2.00630718e-02]
 [-1.41749538e-01 -4.27746413e-01]
 [ 1.55756245e-01  2.94588803e-02]
 [-4.28887723e-01 -9.43688056e-02]
 [ 3.29530599e-01 -3.84558845e-01]
 [-4.50491710e-01  1.73376060e-01]
 [ 2.74451123e-02  1.49763689e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 1.38294859e-01  1.66866674e-02]
 [ 1.75810480e-01  2.54810108e-01]
 [-2.38613575e-01  1.08612823e-01]
 [-1.07607571e-02  5.69198455e-02]
 [-2.56233315e-01 -2.73480258e-01]
 [-9.92747143e-02 -1.24632753e-01]
 [ 8.82651678e-02  6.30521107e-02]
 [ 6.76050027e-02 -8.51054138e-02]
 [ 1.28531413e+00 -5.80590481e-01]
 [ 1.43507110e-01  1.90035861e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.07171885]
curr_Stock_Price:  102.24387375823456
curr_Factors:  [1.02243874e+02 4.01551180e-02]
mat_Sqrt:  [[ 2.04883860e+01  0.00000000e+00]
 [-8.01549679e-03  1.83658104e-02]]
grads:  [1.15985784e-02 1.93396855e+01]
Stock Position:  0.011598578376722953
Bond Position:  [16.88583526]


portfolio before change:  [18.0903847]
curr_Stock_Price:  103.48918762025289
curr_Factors:  [1.03489188e+02 3.97016005e-02]
mat_Sqrt:  [[ 2.06204902e+01  0.00000000e+00]
 [-7.97010419e-03  1.82618029e-02]]
grads:  [ 0.00852807 -1.09863588]
Stock Position:  0.008528072580947944
Bond Position:  [17.2078214]


portfolio before change:  [18.08073624]
curr_Stock_Price:  101.85330142891921
curr_Factors:  [1.01853301e+02 4.08895789e-02]
mat_Sqrt:  [[ 2.05959311e+01  0.00000000e+00]
 [-8.08846872e-03  1.85330101e-02]]
grads:  [-1.59465176e-02 -2.30802450e+01]
Stock Position:  -0.015946517625596863
Bond Position:  [19.70494171]


portfolio before change:  [18.09608213]
curr_Stock_Price:  101.19992751654503
curr_Factors:  [1.01199928e+02 4.28354650e-02]
mat_Sqrt:  [[ 2.09450762e+01  0.00000000e+00]
 [-8.27869217e-03  1.89688668e-02]]
grads:  [0.00805025 1.55301214]
Stock Position:  0.008050252600089977
Bond Position:  [17.28139715]


portfolio before change:  [18.07821737]
curr_Stock_Price:  98.44403239507054
curr_Factors:  [9.84440324e+01 4.60369047e-02]
mat_Sqrt:  [[ 2.11223606e+01  0.00000000e+00]
 [-8.58248492e-03  1.96649434e-02]]
grads:  [-0.02225479 -4.79883433]
Stock Position:  -0.022254787466130185
Bond Position:  [20.26906839]


portfolio before change:  [18.0527621]
curr_Stock_Price:  99.81556496653887
curr_Factors:  [9.98155650e+01 4.35124751e-02]
mat_Sqrt:  [[ 2.08211716e+01  0.00000000e+00]
 [-8.34385763e-03  1.91181796e-02]]
grads:  [ 7.76591070e-03 -2.01148254e+01]
Stock Position:  0.007765910698699555
Bond Position:  [17.27760334]


portfolio before change:  [18.05002992]
curr_Stock_Price:  98.90747734542981
curr_Factors:  [9.89074773e+01 4.31581601e-02]
mat_Sqrt:  [[ 2.05475756e+01  0.00000000e+00]
 [-8.30981686e-03  1.90401824e-02]]
grads:  [-0.01824177  9.10579829]
Stock Position:  -0.018241772251561563
Bond Position:  [19.85427759]


portfolio before change:  [18.06144887]
curr_Stock_Price:  98.55363237545933
curr_Factors:  [9.85536324e+01 4.49360918e-02]
mat_Sqrt:  [[ 2.08915318e+01  0.00000000e+00]
 [-8.47925391e-03  1.94284114e-02]]
grads:  [4.44234274e-03 7.70848865e+00]
Stock Position:  0.0044423427432409325
Bond Position:  [17.62363985]


portfolio before change:  [18.07400032]
curr_Stock_Price:  100.38712277070505
curr_Factors:  [1.00387123e+02 4.38468734e-02]
mat_Sqrt:  [[ 2.10207072e+01  0.00000000e+00]
 [-8.37585801e-03  1.91915017e-02]]
grads:  [-0.01035079 -2.76939825]
Stock Position:  -0.01035078738503184
Bond Position:  [19.11308608]


portfolio before change:  [18.04317901]
curr_Stock_Price:  103.82649190144451
curr_Factors:  [1.03826492e+02 4.19429866e-02]
mat_Sqrt:  [[ 2.12636520e+01  0.00000000e+00]
 [-8.19199478e-03  1.87702181e-02]]
grads:  [0.00684631 0.88899699]
Stock Position:  0.006846308343311757
Bond Position:  [17.33235083]


portfolio before change:  [18.04293687]
curr_Stock_Price:  103.15813653910956
curr_Factors:  [1.03158137e+02 4.48158857e-02]
mat_Sqrt:  [[ 2.18383328e+01  0.00000000e+00]
 [-8.46790512e-03  1.94024081e-02]]
grads:  [ 0.01314289 13.13291149]
Stock Position:  0.01314288646900037
Bond Position:  [16.6871412]


portfolio before change:  [18.03957892]
curr_Stock_Price:  102.5851835248284
curr_Factors:  [1.02585184e+02 4.51096637e-02]
mat_Sqrt:  [[ 2.17881037e+01  0.00000000e+00]
 [-8.49561427e-03  1.94658977e-02]]
grads:  [-0.00877594  5.57964623]
Stock Position:  -0.00877593826373143
Bond Position:  [18.93986016]


portfolio before change:  [18.0427698]
curr_Stock_Price:  102.76119666327325
curr_Factors:  [1.02761197e+02 4.48153103e-02]
mat_Sqrt:  [[ 2.17541619e+01  0.00000000e+00]
 [-8.46785076e-03  1.94022835e-02]]
grads:  [6.47283041e-04 2.93366734e+00]
Stock Position:  0.0006472830408954613
Bond Position:  [17.97625422]


portfolio before change:  [18.04620876]
curr_Stock_Price:  101.1302747100333
curr_Factors:  [1.01130275e+02 4.40479664e-02]
mat_Sqrt:  [[ 2.12248250e+01  0.00000000e+00]
 [-8.39504295e-03  1.92354599e-02]]
grads:  [ -0.01769578 -14.21750555]
Stock Position:  -0.017695782392326817
Bond Position:  [19.83578809]


portfolio before change:  [18.09421225]
curr_Stock_Price:  98.69783464407776
curr_Factors:  [9.86978346e+01 4.60952963e-02]
mat_Sqrt:  [[ 2.11902427e+01  0.00000000e+00]
 [-8.58792606e-03  1.96774106e-02]]
grads:  [-0.00725187 -6.33379845]
Stock Position:  -0.007251871039192719
Bond Position:  [18.80995622]


portfolio before change:  [18.11205841]
curr_Stock_Price:  96.88546422887269
curr_Factors:  [9.68854642e+01 4.66188037e-02]
mat_Sqrt:  [[ 2.09189165e+01  0.00000000e+00]
 [-8.63655521e-03  1.97888340e-02]]
grads:  [0.00553486 3.18624689]
Stock Position:  0.005534864333041693
Bond Position:  [17.57581051]


portfolio before change:  [18.10328206]
curr_Stock_Price:  94.50584965068052
curr_Factors:  [9.45058497e+01 4.57410866e-02]
mat_Sqrt:  [[ 2.02121229e+01  0.00000000e+00]
 [-8.55486637e-03  1.96016614e-02]]
grads:  [ 1.50711309e-03 -4.34174493e+00]
Stock Position:  0.0015071130909715968
Bond Position:  [17.96085106]


portfolio before change:  [18.10291946]
curr_Stock_Price:  91.28553491797722
curr_Factors:  [9.12855349e+01 4.75721940e-02]
mat_Sqrt:  [[ 1.99103344e+01  0.00000000e+00]
 [-8.72442034e-03  1.99901583e-02]]
grads:  [  0.05182855 -29.04381606]
Stock Position:  0.051828545132061504
Bond Position:  [13.37172299]


portfolio before change:  [18.19945011]
curr_Stock_Price:  93.08352667963648
curr_Factors:  [9.30835267e+01 4.53318041e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.19945011]
Stock Price:  92.3539733283603
PL:  [18.19945011]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.30132355e-01  4.28071257e-01]
 [-5.72111205e-02 -3.82559295e-02]
 [-2.14955515e-01 -9.27220368e-01]
 [-2.92037059e-02  2.76570458e-01]
 [-4.16897729e-01 -6.24555193e-02]
 [-3.85594223e-02  1.06902496e-01]
 [-3.44465923e-01  1.31772958e-01]
 [ 2.11770693e-02  1.57675032e-01]
 [-2.33159727e-01  9.88459182e-02]
 [ 3.52779364e-02  1.82504366e-02]
 [-9.89954554e-02 -2.78330729e-02]
 [-1.81696004e-02 -3.98254342e-02]
 [ 4.11569614e-01 -6.44601330e-02]
 [ 2.27531035e-01  1.98918502e-01]
 [-3.38002861e-01 -8.41762970e-02]
 [ 7.88095835e-02  8.94451476e-02]
 [-5.62792720e-02 -1.05042262e-02]
 [ 1.59504952e+00 -7.09216960e-01]
 [ 3.89160222e-01  3.25240238e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.57020962]
curr_Stock_Price:  102.75169120418607
curr_Factors:  [1.02751691e+02 3.69168462e-02]
mat_Sqrt:  [[ 1.97424604e+01  0.00000000e+00]
 [-7.68550284e-03  1.76096993e-02]]
grads:  [1.60546336e-02 2.43088341e+01]
Stock Position:  0.01605463364626608
Bond Position:  [19.92056886]


portfolio before change:  [21.5587074]
curr_Stock_Price:  101.7250102866108
curr_Factors:  [1.01725010e+02 3.74910653e-02]
mat_Sqrt:  [[ 1.96966167e+01  0.00000000e+00]
 [-7.74504387e-03  1.77461249e-02]]
grads:  [-0.00375229 -2.15573427]
Stock Position:  -0.003752287927480288
Bond Position:  [21.94040893]


portfolio before change:  [21.57850093]
curr_Stock_Price:  97.91193946397823
curr_Factors:  [9.79119395e+01 3.98358810e-02]
mat_Sqrt:  [[ 1.95421736e+01  0.00000000e+00]
 [-7.98357123e-03  1.82926597e-02]]
grads:  [-3.17072028e-02 -5.06881110e+01]
Stock Position:  -0.03170720275133804
Bond Position:  [24.68301464]


portfolio before change:  [21.59874072]
curr_Stock_Price:  97.46824630291209
curr_Factors:  [9.74682463e+01 4.04335405e-02]
mat_Sqrt:  [[ 1.95990056e+01  0.00000000e+00]
 [-8.04323721e-03  1.84293717e-02]]
grads:  [4.66868266e-03 1.50070476e+01]
Stock Position:  0.004668682662017142
Bond Position:  [21.14369241]


portfolio before change:  [21.60221921]
curr_Stock_Price:  97.08096491061593
curr_Factors:  [9.70809649e+01 3.92551062e-02]
mat_Sqrt:  [[ 1.92345559e+01  0.00000000e+00]
 [-7.92516056e-03  1.81588241e-02]]
grads:  [-0.02309154 -3.43940329]
Stock Position:  -0.023091541885921198
Bond Position:  [23.84396838]


portfolio before change:  [21.60887276]
curr_Stock_Price:  97.05100549535275
curr_Factors:  [9.70510055e+01 3.82673746e-02]
mat_Sqrt:  [[ 1.89851649e+01  0.00000000e+00]
 [-7.82481945e-03  1.79289137e-02]]
grads:  [4.26472561e-04 5.96257518e+00]
Stock Position:  0.00042647256075712086
Bond Position:  [21.56748317]


portfolio before change:  [21.61445302]
curr_Stock_Price:  97.49117277638345
curr_Factors:  [9.74911728e+01 3.62068007e-02]
mat_Sqrt:  [[ 1.85507029e+01  0.00000000e+00]
 [-7.61123387e-03  1.74395277e-02]]
grads:  [-0.01546871  7.55599353]
Stock Position:  -0.015468712426438585
Bond Position:  [23.12251594]


portfolio before change:  [21.6310419]
curr_Stock_Price:  96.79250248657858
curr_Factors:  [9.67925025e+01 3.95550677e-02]
mat_Sqrt:  [[ 1.92505342e+01  0.00000000e+00]
 [-7.95538235e-03  1.82280709e-02]]
grads:  [4.67478430e-03 8.65012171e+00]
Stock Position:  0.004674784303013537
Bond Position:  [21.17855783]


portfolio before change:  [21.62697389]
curr_Stock_Price:  94.78956238001378
curr_Factors:  [9.47895624e+01 3.85966216e-02]
mat_Sqrt:  [[ 1.86223791e+01  0.00000000e+00]
 [-7.85840916e-03  1.80058774e-02]]
grads:  [-0.01020384  5.4896474 ]
Stock Position:  -0.010203842930579247
Bond Position:  [22.5941917]


portfolio before change:  [21.66319865]
curr_Stock_Price:  91.79309231269384
curr_Factors:  [9.17930923e+01 3.92081004e-02]
mat_Sqrt:  [[ 1.81759827e+01  0.00000000e+00]
 [-7.92041417e-03  1.81479487e-02]]
grads:  [0.00237913 1.00564735]
Stock Position:  0.002379132978707691
Bond Position:  [21.44481068]


portfolio before change:  [21.67048092]
curr_Stock_Price:  92.6002759597076
curr_Factors:  [9.26002760e+01 3.98168361e-02]
mat_Sqrt:  [[ 1.84776040e+01  0.00000000e+00]
 [-7.98166260e-03  1.82882865e-02]]
grads:  [-0.006015   -1.52190709]
Stock Position:  -0.006015000887276051
Bond Position:  [22.22747167]


portfolio before change:  [21.68910159]
curr_Stock_Price:  90.42852163259867
curr_Factors:  [9.04285216e+01 4.12751908e-02]
mat_Sqrt:  [[ 1.83717267e+01  0.00000000e+00]
 [-8.12651864e-03  1.86201934e-02]]
grads:  [-1.93508457e-03 -2.13883032e+00]
Stock Position:  -0.0019350845705529602
Bond Position:  [21.86408843]


portfolio before change:  [21.69563983]
curr_Stock_Price:  89.87478318901033
curr_Factors:  [8.98747832e+01 4.15652336e-02]
mat_Sqrt:  [[ 1.83232695e+01  0.00000000e+00]
 [-8.15502138e-03  1.86855014e-02]]
grads:  [ 0.02092623 -3.44974061]
Stock Position:  0.020926227543992246
Bond Position:  [19.81489966]


portfolio before change:  [21.68508468]
curr_Stock_Price:  89.13363229958674
curr_Factors:  [8.91336323e+01 4.16691197e-02]
mat_Sqrt:  [[ 1.81948621e+01  0.00000000e+00]
 [-8.16520615e-03  1.87088376e-02]]
grads:  [ 0.01727665 10.63232823]
Stock Position:  0.01727664575941472
Bond Position:  [20.14515449]


portfolio before change:  [21.68022686]
curr_Stock_Price:  88.56090916044076
curr_Factors:  [8.85609092e+01 4.07389952e-02]
mat_Sqrt:  [[ 1.78750483e+01  0.00000000e+00]
 [-8.07356131e-03  1.84988529e-02]]
grads:  [-0.02096444 -4.55035225]
Stock Position:  -0.02096444178566168
Bond Position:  [23.53685689]


portfolio before change:  [21.66181176]
curr_Stock_Price:  89.72001698908443
curr_Factors:  [8.9720017e+01 4.1193764e-02]
mat_Sqrt:  [[ 1.82097962e+01  0.00000000e+00]
 [-8.11849878e-03  1.86018176e-02]]
grads:  [0.00647161 4.80840903]
Stock Position:  0.006471607094225264
Bond Position:  [21.08117907]


portfolio before change:  [21.6582156]
curr_Stock_Price:  88.3498607074976
curr_Factors:  [8.83498607e+01 4.59689408e-02]
mat_Sqrt:  [[ 1.89425358e+01  0.00000000e+00]
 [-8.57614746e-03  1.96504225e-02]]
grads:  [-0.00321307 -0.53455472]
Stock Position:  -0.0032130699232559906
Bond Position:  [21.94208988]


portfolio before change:  [21.66481883]
curr_Stock_Price:  88.00221238599246
curr_Factors:  [8.80022124e+01 4.61652187e-02]
mat_Sqrt:  [[ 1.89082371e+01  0.00000000e+00]
 [-8.59443715e-03  1.96923294e-02]]
grads:  [  0.0679874  -36.01488407]
Stock Position:  0.06798739923931191
Bond Position:  [15.68177728]


portfolio before change:  [21.57897438]
curr_Stock_Price:  86.68188850134634
curr_Factors:  [8.66818885e+01 4.67184726e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.57897438]
Stock Price:  88.45254517951301
PL:  [21.57897438]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.19892074e-01 -5.49363304e-02]
 [-1.36565844e-01 -3.92378802e-01]
 [-1.94159147e-02  2.76570880e-01]
 [-4.20252233e-01 -6.54432575e-02]
 [ 3.16339848e-02  8.02388727e-03]
 [-4.87727032e-01  1.87680149e-01]
 [ 4.16798569e-02  1.35963063e-01]
 [-2.17933853e-01  3.86035133e-02]
 [ 1.55543551e-01  1.10212531e-02]
 [-1.06004474e-01 -5.09235030e-02]
 [-2.36243884e-01  6.24205222e-02]
 [-7.11791213e-02  3.43676016e-02]
 [-1.22525426e-01 -2.31383332e-01]
 [-2.27689806e-01 -1.30329350e-01]
 [ 8.82872311e-02  7.27793432e-02]
 [ 3.41995703e-02 -7.23110674e-02]
 [ 4.55760107e-01 -2.52495281e-01]
 [ 2.20206617e-01  1.03484995e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.13924711]
curr_Stock_Price:  98.4392658139568
curr_Factors:  [9.84392658e+01 4.25036457e-02]
mat_Sqrt:  [[ 2.02946449e+01  0.00000000e+00]
 [-8.24656493e-03  1.88952540e-02]]
grads:  [ 0.00137335 -0.07149066]
Stock Position:  0.0013733464028479895
Bond Position:  [-8.27443832]


portfolio before change:  [-8.13725194]
curr_Stock_Price:  101.39848550032657
curr_Factors:  [1.01398486e+02 4.22454552e-02]
mat_Sqrt:  [[ 2.08411397e+01  0.00000000e+00]
 [-8.22147969e-03  1.88377765e-02]]
grads:  [-0.00690309 -2.91628528]
Stock Position:  -0.00690308956556833
Bond Position:  [-7.43728912]


portfolio before change:  [-8.14436981]
curr_Stock_Price:  102.16021832840053
curr_Factors:  [1.02160218e+02 4.33514400e-02]
mat_Sqrt:  [[ 2.12707879e+01  0.00000000e+00]
 [-8.32840345e-03  1.90827696e-02]]
grads:  [-1.44712078e-02 -2.05619420e+01]
Stock Position:  -0.014471207841264185
Bond Position:  [-6.66598806]


portfolio before change:  [-8.10043539]
curr_Stock_Price:  99.00905608853792
curr_Factors:  [9.90090561e+01 4.57112267e-02]
mat_Sqrt:  [[ 2.11683183e+01  0.00000000e+00]
 [-8.55207359e-03  1.95952623e-02]]
grads:  [4.78495796e-03 1.41141709e+01]
Stock Position:  0.00478495795630903
Bond Position:  [-8.57418956]


portfolio before change:  [-8.11137541]
curr_Stock_Price:  97.17075168507088
curr_Factors:  [9.71707517e+01 4.96835522e-02]
mat_Sqrt:  [[ 2.16591736e+01  0.00000000e+00]
 [-8.91592304e-03  2.04289461e-02]]
grads:  [-0.02072166 -3.20345735]
Stock Position:  -0.020721659116514343
Bond Position:  [-6.09783622]


portfolio before change:  [-8.1292342]
curr_Stock_Price:  97.95901548095291
curr_Factors:  [9.79590155e+01 5.13756447e-02]
mat_Sqrt:  [[ 2.22035826e+01  0.00000000e+00]
 [-9.06647845e-03  2.07739119e-02]]
grads:  [0.00158244 0.38624826]
Stock Position:  0.0015824426591964887
Bond Position:  [-8.28424872]


portfolio before change:  [-8.12934964]
curr_Stock_Price:  99.19500241606248
curr_Factors:  [9.91950024e+01 5.16094960e-02]
mat_Sqrt:  [[ 2.25348464e+01  0.00000000e+00]
 [-9.08708939e-03  2.08211375e-02]]
grads:  [-0.01800841  9.0139239 ]
Stock Position:  -0.01800840766707406
Bond Position:  [-6.3430056]


portfolio before change:  [-8.13657145]
curr_Stock_Price:  99.50795931262876
curr_Factors:  [9.95079593e+01 5.13604834e-02]
mat_Sqrt:  [[ 2.25513410e+01  0.00000000e+00]
 [-9.06514056e-03  2.07708464e-02]]
grads:  [4.47951199e-03 6.54586047e+00]
Stock Position:  0.004479511991621603
Bond Position:  [-8.58231854]


portfolio before change:  [-8.15294176]
curr_Stock_Price:  96.33251000234081
curr_Factors:  [9.63325100e+01 5.29888368e-02]
mat_Sqrt:  [[ 2.21750736e+01  0.00000000e+00]
 [-9.20772170e-03  2.10975408e-02]]
grads:  [-0.00906811  1.82976365]
Stock Position:  -0.009068105135933128
Bond Position:  [-7.27938843]


portfolio before change:  [-8.14402162]
curr_Stock_Price:  95.1481158460714
curr_Factors:  [9.51481158e+01 5.46442698e-02]
mat_Sqrt:  [[ 2.22419319e+01  0.00000000e+00]
 [-9.35044553e-03  2.14245622e-02]]
grads:  [0.00720952 0.51442139]
Stock Position:  0.007209518559510654
Bond Position:  [-8.82999373]


portfolio before change:  [-8.14229145]
curr_Stock_Price:  95.69433068820761
curr_Factors:  [9.56943307e+01 5.26931541e-02]
mat_Sqrt:  [[ 2.19666235e+01  0.00000000e+00]
 [-9.18199578e-03  2.10385954e-02]]
grads:  [-0.00583746 -2.42048018]
Stock Position:  -0.005837461201184324
Bond Position:  [-7.58367951]


portfolio before change:  [-8.16030569]
curr_Stock_Price:  98.455477304852
curr_Factors:  [9.84554773e+01 5.09009135e-02]
mat_Sqrt:  [[ 2.22127675e+01  0.00000000e+00]
 [-9.02449231e-03  2.06777096e-02]]
grads:  [-0.00940906  3.01873484]
Stock Position:  -0.009409063278642682
Bond Position:  [-7.23393188]


portfolio before change:  [-8.16475066]
curr_Stock_Price:  98.73566019446166
curr_Factors:  [9.87356602e+01 5.07162696e-02]
mat_Sqrt:  [[ 2.22355402e+01  0.00000000e+00]
 [-9.00810920e-03  2.06401711e-02]]
grads:  [-0.00252658  1.66508317]
Stock Position:  -0.002526579954858448
Bond Position:  [-7.91528712]


portfolio before change:  [-8.16471325]
curr_Stock_Price:  97.93755246139402
curr_Factors:  [9.79375525e+01 5.08579348e-02]
mat_Sqrt:  [[ 2.20865868e+01  0.00000000e+00]
 [-9.02068155e-03  2.06689780e-02]]
grads:  [-1.01196891e-02 -1.11947157e+01]
Stock Position:  -0.010119689078274539
Bond Position:  [-7.17361567]


portfolio before change:  [-8.13723774]
curr_Stock_Price:  95.04525625559538
curr_Factors:  [9.50452563e+01 5.20340026e-02]
mat_Sqrt:  [[ 2.16807381e+01  0.00000000e+00]
 [-9.12438514e-03  2.09065928e-02]]
grads:  [-0.01312548 -6.23388762]
Stock Position:  -0.013125484741275634
Bond Position:  [-6.88972267]


portfolio before change:  [-8.17253765]
curr_Stock_Price:  97.60342949009392
curr_Factors:  [9.76034295e+01 5.04025635e-02]
mat_Sqrt:  [[ 2.19124728e+01  0.00000000e+00]
 [-8.98020610e-03  2.05762371e-02]]
grads:  [0.00547865 3.53705796]
Stock Position:  0.0054786486918377226
Bond Position:  [-8.70727255]


portfolio before change:  [-8.1754468]
curr_Stock_Price:  97.46980851294646
curr_Factors:  [9.74698085e+01 5.13361592e-02]
mat_Sqrt:  [[ 2.20842065e+01  0.00000000e+00]
 [-9.06299369e-03  2.07659273e-02]]
grads:  [ 1.19562056e-04 -3.48219785e+00]
Stock Position:  0.00011956205585843435
Bond Position:  [-8.18710049]


portfolio before change:  [-8.17709452]
curr_Stock_Price:  100.80960674790681
curr_Factors:  [1.00809607e+02 4.84099802e-02]
mat_Sqrt:  [[ 2.21804000e+01  0.00000000e+00]
 [-8.80090724e-03  2.01654118e-02]]
grads:  [  0.01557962 -12.52120629]
Stock Position:  0.015579616804859288
Bond Position:  [-9.74766956]


portfolio before change:  [-8.17307082]
curr_Stock_Price:  101.22430978747869
curr_Factors:  [1.01224310e+02 4.75486854e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.17307082]
Stock Price:  101.15184255140612
PL:  [-9.32491337]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.95890410e-02  2.01595175e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.20915595e-01 -9.67885149e-01]
 [-3.17911444e-02  2.76299313e-01]
 [-4.10789831e-01 -7.27700947e-02]
 [-2.13288430e-02  7.74619207e-02]
 [-5.18404100e-01  2.59470392e-01]
 [ 3.26844922e-02  1.43150695e-01]
 [-1.97047321e-01 -4.27750719e-02]
 [ 2.45739127e-01  5.36940753e-03]
 [ 2.85214608e-02  1.05620632e-01]
 [-2.37221859e-01  8.14841578e-02]
 [-1.13267825e-02  3.87542863e-02]
 [-2.25779859e-01 -2.71858216e-01]
 [-7.75959630e-02 -1.14616293e-01]
 [ 8.91407298e-02  1.52241042e-02]
 [-5.24779600e-02  2.31714514e-02]
 [ 4.50374639e-01 -2.50921139e-01]
 [ 2.20882811e-01  1.04271751e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.75749757]
curr_Stock_Price:  101.1821904757549
curr_Factors:  [1.01182190e+02 4.06422192e-02]
mat_Sqrt:  [[ 2.03982441e+01  0.00000000e+00]
 [-8.06396619e-03  1.84768677e-02]]
grads:  [3.35295069e-03 1.09106791e+01]
Stock Position:  0.003352950694739131
Bond Position:  [10.41823867]


portfolio before change:  [10.75317884]
curr_Stock_Price:  99.11725899353986
curr_Factors:  [9.91172590e+01 4.10285961e-02]
mat_Sqrt:  [[ 2.00767131e+01  0.00000000e+00]
 [-8.10220672e-03  1.85644878e-02]]
grads:  [-0.00928065 -3.59029405]
Stock Position:  -0.009280646172612308
Bond Position:  [11.67305105]


portfolio before change:  [10.76967341]
curr_Stock_Price:  97.6544367989306
curr_Factors:  [9.76544368e+01 4.12744492e-02]
mat_Sqrt:  [[ 1.98395868e+01  0.00000000e+00]
 [-8.12644564e-03  1.86200261e-02]]
grads:  [-3.24268500e-02 -5.19808695e+01]
Stock Position:  -0.03242685000501461
Bond Position:  [13.93629918]


portfolio before change:  [10.77033867]
curr_Stock_Price:  97.74137855103218
curr_Factors:  [9.77413786e+01 4.15349794e-02]
mat_Sqrt:  [[ 1.99198223e+01  0.00000000e+00]
 [-8.15205293e-03  1.86786998e-02]]
grads:  [4.45765834e-03 1.47922134e+01]
Stock Position:  0.004457658337961908
Bond Position:  [10.334641]


portfolio before change:  [10.77302572]
curr_Stock_Price:  97.7644998068789
curr_Factors:  [9.77644998e+01 4.13373323e-02]
mat_Sqrt:  [[ 1.98770718e+01  0.00000000e+00]
 [-8.13263375e-03  1.86342049e-02]]
grads:  [-0.02226431 -3.90518915]
Stock Position:  -0.0222643108478393
Bond Position:  [12.94968493]


portfolio before change:  [10.77817626]
curr_Stock_Price:  97.67859025379597
curr_Factors:  [9.76785903e+01 4.34507217e-02]
mat_Sqrt:  [[ 2.03609426e+01  0.00000000e+00]
 [-8.33793468e-03  1.91046084e-02]]
grads:  [6.12855263e-04 4.05461965e+00]
Stock Position:  0.0006128552625704379
Bond Position:  [10.71831342]


portfolio before change:  [10.78259424]
curr_Stock_Price:  100.51460769423869
curr_Factors:  [1.00514608e+02 4.12974391e-02]
mat_Sqrt:  [[ 2.04263487e+01  0.00000000e+00]
 [-8.12870854e-03  1.86252111e-02]]
grads:  [-0.01983526 13.93113834]
Stock Position:  -0.019835259957422913
Bond Position:  [12.77632762]


portfolio before change:  [10.82105099]
curr_Stock_Price:  98.73685082510812
curr_Factors:  [9.87368508e+01 4.23653080e-02]
mat_Sqrt:  [[ 2.03228427e+01  0.00000000e+00]
 [-8.23313384e-03  1.88644795e-02]]
grads:  [4.68244423e-03 7.58837237e+00]
Stock Position:  0.004682444228500844
Bond Position:  [10.3587212]


portfolio before change:  [10.82339641]
curr_Stock_Price:  98.68461477828708
curr_Factors:  [9.86846148e+01 4.22925296e-02]
mat_Sqrt:  [[ 2.02946367e+01  0.00000000e+00]
 [-8.22605904e-03  1.88482691e-02]]
grads:  [-0.01062921 -2.26944297]
Stock Position:  -0.010629206946559791
Bond Position:  [11.8723356]


portfolio before change:  [10.82684687]
curr_Stock_Price:  98.63926708622424
curr_Factors:  [9.86392671e+01 4.18505953e-02]
mat_Sqrt:  [[ 2.01790472e+01  0.00000000e+00]
 [-8.18296722e-03  1.87495333e-02]]
grads:  [0.01229407 0.28637553]
Stock Position:  0.012294065517685533
Bond Position:  [9.61416926]


portfolio before change:  [10.83560623]
curr_Stock_Price:  99.15622480398208
curr_Factors:  [9.91562248e+01 4.26111714e-02]
mat_Sqrt:  [[ 2.04682975e+01  0.00000000e+00]
 [-8.25698942e-03  1.89191395e-02]]
grads:  [3.64554423e-03 5.58273973e+00]
Stock Position:  0.0036455442256560122
Bond Position:  [10.47412782]


portfolio before change:  [10.84394309]
curr_Stock_Price:  100.72471694082832
curr_Factors:  [1.00724717e+02 4.14962188e-02]
mat_Sqrt:  [[ 2.05182501e+01  0.00000000e+00]
 [-8.14824829e-03  1.86699823e-02]]
grads:  [-0.00982829  4.36444752]
Stock Position:  -0.009828287343277562
Bond Position:  [11.83389455]


portfolio before change:  [10.84820264]
curr_Stock_Price:  100.59237422608695
curr_Factors:  [1.00592374e+02 4.17403424e-02]
mat_Sqrt:  [[ 2.05514781e+01  0.00000000e+00]
 [-8.17218134e-03  1.87248198e-02]]
grads:  [2.71852695e-04 2.06967473e+00]
Stock Position:  0.00027185269459331526
Bond Position:  [10.82085633]


portfolio before change:  [10.85083979]
curr_Stock_Price:  100.34078329223718
curr_Factors:  [1.00340783e+02 4.24083717e-02]
mat_Sqrt:  [[ 2.06634715e+01  0.00000000e+00]
 [-8.23731720e-03  1.88740648e-02]]
grads:  [ -0.01666847 -14.40379793]
Stock Position:  -0.016668472720732592
Bond Position:  [12.5233674]


portfolio before change:  [10.86292637]
curr_Stock_Price:  99.80352092285122
curr_Factors:  [9.98035209e+01 4.57950337e-02]
mat_Sqrt:  [[ 2.13577281e+01  0.00000000e+00]
 [-8.55990969e-03  1.96132170e-02]]
grads:  [-0.00597529 -5.84382933]
Stock Position:  -0.005975289760966017
Bond Position:  [11.45928133]


portfolio before change:  [10.85328017]
curr_Stock_Price:  101.89737408521479
curr_Factors:  [1.01897374e+02 4.40473861e-02]
mat_Sqrt:  [[ 2.13856799e+01  0.00000000e+00]
 [-8.39498765e-03  1.92353332e-02]]
grads:  [0.00447894 0.79146558]
Stock Position:  0.004478935152797731
Bond Position:  [10.39688844]


portfolio before change:  [10.85885099]
curr_Stock_Price:  102.56076186047368
curr_Factors:  [1.02560762e+02 4.37361611e-02]
mat_Sqrt:  [[ 2.14487293e+01  0.00000000e+00]
 [-8.36527691e-03  1.91672573e-02]]
grads:  [-0.00197518  1.20890804]
Stock Position:  -0.0019751803858130508
Bond Position:  [11.06142699]


portfolio before change:  [10.86487706]
curr_Stock_Price:  100.91009403771123
curr_Factors:  [1.00910094e+02 4.38257110e-02]
mat_Sqrt:  [[ 2.11251157e+01  0.00000000e+00]
 [-8.37383649e-03  1.91868698e-02]]
grads:  [  0.01613547 -13.07775276]
Stock Position:  0.016135470231976843
Bond Position:  [9.23664524]


portfolio before change:  [10.87160737]
curr_Stock_Price:  101.18407789858055
curr_Factors:  [1.01184078e+02 4.49608859e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.87160737]
Stock Price:  101.81069493633181
PL:  [9.06091243]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.00693736e-01  3.82350993e-01]
 [-9.47463129e-02 -4.78846770e-02]
 [-1.36026532e-01 -3.88699151e-01]
 [ 1.82047979e-01 -1.11609321e-02]
 [-1.31050295e-01 -7.77503803e-02]
 [ 6.03531697e-01 -8.10121617e-01]
 [-5.37052372e-01  3.14090626e-01]
 [ 5.21738321e-02  1.36787355e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.38620959e-01  5.81544699e-03]
 [ 1.53251033e-02  9.26704287e-02]
 [-2.36038534e-01  5.84176515e-02]
 [-6.35201519e-02  1.82058987e-02]
 [-7.66079425e-02 -2.09833186e-01]
 [-1.77745601e-01 -1.41390834e-01]
 [ 8.81613667e-02  5.69258137e-02]
 [ 2.57997880e-02 -6.81619206e-02]
 [ 6.94402409e-01 -3.35031625e-01]
 [ 1.54194920e-01  1.51903793e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.36402556]
curr_Stock_Price:  102.43145633011193
curr_Factors:  [1.02431456e+02 3.97226375e-02]
mat_Sqrt:  [[ 2.04151411e+01  0.00000000e+00]
 [-7.97221550e-03  1.82666405e-02]]
grads:  [1.31062229e-02 2.09316537e+01]
Stock Position:  0.013106222901849915
Bond Position:  [18.02153607]


portfolio before change:  [19.35735065]
curr_Stock_Price:  101.5783607051256
curr_Factors:  [1.01578361e+02 4.10691177e-02]
mat_Sqrt:  [[ 2.05853799e+01  0.00000000e+00]
 [-8.10620678e-03  1.85736531e-02]]
grads:  [-0.00561782 -2.57809688]
Stock Position:  -0.00561781710209284
Bond Position:  [19.9279993]


portfolio before change:  [19.35897898]
curr_Stock_Price:  102.17544191178196
curr_Factors:  [1.02175442e+02 4.06479800e-02]
mat_Sqrt:  [[ 2.05999425e+01  0.00000000e+00]
 [-8.06453768e-03  1.84781772e-02]]
grads:  [-1.48383302e-02 -2.10355787e+01]
Stock Position:  -0.014838330177403608
Bond Position:  [20.87509192]


portfolio before change:  [19.37410385]
curr_Stock_Price:  101.5078840705722
curr_Factors:  [1.01507884e+02 4.21053429e-02]
mat_Sqrt:  [[ 2.08289981e+01  0.00000000e+00]
 [-8.20783459e-03  1.88065117e-02]]
grads:  [ 0.00850626 -0.59346105]
Stock Position:  0.008506263668375836
Bond Position:  [18.51065102]


portfolio before change:  [19.39308295]
curr_Stock_Price:  103.19497698628821
curr_Factors:  [1.03194977e+02 4.21436035e-02]
mat_Sqrt:  [[ 2.11848012e+01  0.00000000e+00]
 [-8.21156292e-03  1.88150543e-02]]
grads:  [-0.00778782 -4.13234949]
Stock Position:  -0.007787816435382572
Bond Position:  [20.19674649]


portfolio before change:  [19.39801413]
curr_Stock_Price:  103.21021020475017
curr_Factors:  [1.03210210e+02 4.07918338e-02]
mat_Sqrt:  [[ 2.08453541e+01  0.00000000e+00]
 [-8.07879534e-03  1.85108456e-02]]
grads:  [ 1.19914315e-02 -4.37647008e+01]
Stock Position:  0.011991431520118603
Bond Position:  [18.16037596]


portfolio before change:  [19.38028761]
curr_Stock_Price:  101.35328604402011
curr_Factors:  [1.01353286e+02 4.04510051e-02]
mat_Sqrt:  [[ 2.03846140e+01  0.00000000e+00]
 [-8.04497409e-03  1.84333514e-02]]
grads:  [-0.01962127 17.03925781]
Stock Position:  -0.019621268470001348
Bond Position:  [21.36896765]


portfolio before change:  [19.42004963]
curr_Stock_Price:  99.5991128124057
curr_Factors:  [9.95991128e+01 4.08389638e-02]
mat_Sqrt:  [[ 2.01276387e+01  0.00000000e+00]
 [-8.08346103e-03  1.85215360e-02]]
grads:  [5.55816457e-03 7.38531378e+00]
Stock Position:  0.005558164573961114
Bond Position:  [18.86646137]


portfolio before change:  [19.43032093]
curr_Stock_Price:  100.59838181434355
curr_Factors:  [1.00598382e+02 4.07744560e-02]
mat_Sqrt:  [[ 2.03135152e+01  0.00000000e+00]
 [-8.07707432e-03  1.85069022e-02]]
grads:  [-0.01071114 -2.87184265]
Stock Position:  -0.010711138315386963
Bond Position:  [20.50784412]


portfolio before change:  [19.45961533]
curr_Stock_Price:  98.34215203705591
curr_Factors:  [9.83421520e+01 4.02531684e-02]
mat_Sqrt:  [[ 1.97305750e+01  0.00000000e+00]
 [-8.02527691e-03  1.83882195e-02]]
grads:  [0.01222261 0.31625939]
Stock Position:  0.012222605151901163
Bond Position:  [18.25761803]


portfolio before change:  [19.47129682]
curr_Stock_Price:  98.92439420743317
curr_Factors:  [9.89243942e+01 4.27454597e-02]
mat_Sqrt:  [[ 2.04525939e+01  0.00000000e+00]
 [-8.26999005e-03  1.89489277e-02]]
grads:  [2.72678343e-03 4.89053682e+00]
Stock Position:  0.0027267834300843427
Bond Position:  [19.20155142]


portfolio before change:  [19.47584379]
curr_Stock_Price:  98.83123932055787
curr_Factors:  [9.88312393e+01 4.20810093e-02]
mat_Sqrt:  [[ 2.02739007e+01  0.00000000e+00]
 [-8.20546250e-03  1.88010765e-02]]
grads:  [-0.01038493  3.10714397]
Stock Position:  -0.01038492710749331
Bond Position:  [20.50219901]


portfolio before change:  [19.5093961]
curr_Stock_Price:  96.09399143995162
curr_Factors:  [9.60939914e+01 4.50728512e-02]
mat_Sqrt:  [[ 2.04011077e+01  0.00000000e+00]
 [-8.49214707e-03  1.94579534e-02]]
grads:  [-0.00272409  0.93565332]
Stock Position:  -0.002724089650131687
Bond Position:  [19.77116475]


portfolio before change:  [19.51314619]
curr_Stock_Price:  96.5320523993512
curr_Factors:  [9.65320524e+01 4.31510231e-02]
mat_Sqrt:  [[ 2.00524337e+01  0.00000000e+00]
 [-8.30912974e-03  1.90386080e-02]]
grads:  [-8.38734368e-03 -1.10214563e+01]
Stock Position:  -0.008387343683287599
Bond Position:  [20.32279369]


portfolio before change:  [19.5215746]
curr_Stock_Price:  96.13298988061395
curr_Factors:  [9.61329899e+01 4.76348180e-02]
mat_Sqrt:  [[ 2.09814117e+01  0.00000000e+00]
 [-8.73016087e-03  2.00033115e-02]]
grads:  [-0.01141266 -7.06837135]
Stock Position:  -0.011412655356826725
Bond Position:  [20.61870728]


portfolio before change:  [19.52356981]
curr_Stock_Price:  96.409885146755
curr_Factors:  [9.64098851e+01 4.65511748e-02]
mat_Sqrt:  [[ 2.08011281e+01  0.00000000e+00]
 [-8.63028851e-03  1.97744752e-02]]
grads:  [0.00543268 2.87875219]
Stock Position:  0.005432677885665902
Bond Position:  [18.99980596]


portfolio before change:  [19.5361262]
curr_Stock_Price:  97.84671693914449
curr_Factors:  [9.78467169e+01 4.40567993e-02]
mat_Sqrt:  [[ 2.05377437e+01  0.00000000e+00]
 [-8.39588464e-03  1.92373884e-02]]
grads:  [-1.92256419e-04 -3.54320031e+00]
Stock Position:  -0.00019225641901006256
Bond Position:  [19.55493786]


portfolio before change:  [19.54107077]
curr_Stock_Price:  97.55950100127725
curr_Factors:  [9.7559501e+01 4.4650220e-02]
mat_Sqrt:  [[ 2.06149066e+01  0.00000000e+00]
 [-8.45223946e-03  1.93665136e-02]]
grads:  [  0.02659156 -17.29953221]
Stock Position:  0.026591564552052936
Bond Position:  [16.946811]


portfolio before change:  [19.50194474]
curr_Stock_Price:  95.92878630867912
curr_Factors:  [9.59287863e+01 4.55070653e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.50194474]
Stock Price:  96.64381245094278
PL:  [19.50194474]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-8.57448846e-02  2.49294710e-02]
 [-7.19783957e-02 -4.20441285e-02]
 [-1.88594187e-01 -7.47360779e-01]
 [-3.11634771e-02  2.76365088e-01]
 [-4.06098204e-01 -1.15990264e-01]
 [-4.86696373e-02  1.26464013e-01]
 [-3.74360257e-01  1.48164732e-01]
 [ 2.94949403e-02  1.47176455e-01]
 [-1.98700344e-01 -3.63345270e-02]
 [ 2.08905773e-01  7.67746342e-03]
 [-1.04012686e-01 -4.43617818e-02]
 [-9.53331461e-02 -2.96806533e-03]
 [ 3.03549076e-01 -4.57551274e-02]
 [ 2.01804508e-01  1.61466082e-01]
 [-2.98906191e-01 -1.00711434e-01]
 [ 8.41051193e-02  5.37497712e-02]
 [ 3.61870158e-02 -6.34434718e-02]
 [ 1.25224681e+00 -5.66544845e-01]
 [ 1.43071789e-01  1.84881544e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.64477581]
curr_Stock_Price:  100.00460222047924
curr_Factors:  [1.00004602e+02 3.74155561e-02]
mat_Sqrt:  [[ 1.93439913e+01  0.00000000e+00]
 [-7.73724045e-03  1.77282450e-02]]
grads:  [-0.00387018  1.40620073]
Stock Position:  -0.0038701822247594756
Bond Position:  [3.03181184]


portfolio before change:  [2.63911353]
curr_Stock_Price:  101.6635217642268
curr_Factors:  [1.01663522e+02 3.62854471e-02]
mat_Sqrt:  [[ 1.93656193e+01  0.00000000e+00]
 [-7.61949574e-03  1.74584580e-02]]
grads:  [-0.00466435 -2.40823837]
Stock Position:  -0.00466434646046651
Bond Position:  [3.11330742]


portfolio before change:  [2.6511746]
curr_Stock_Price:  99.24461082354014
curr_Factors:  [9.92446108e+01 3.81577434e-02]
mat_Sqrt:  [[ 1.93864493e+01  0.00000000e+00]
 [-7.81360285e-03  1.79032132e-02]]
grads:  [-2.65530403e-02 -4.17445052e+01]
Stock Position:  -0.026553040347227552
Bond Position:  [5.28642075]


portfolio before change:  [2.69412497]
curr_Stock_Price:  97.67685811015753
curr_Factors:  [9.76768581e+01 3.98546112e-02]
mat_Sqrt:  [[ 1.94998365e+01  0.00000000e+00]
 [-7.98544788e-03  1.82969597e-02]]
grads:  [4.58732748e-03 1.51044268e+01]
Stock Position:  0.004587327481172447
Bond Position:  [2.24604923]


portfolio before change:  [2.70412958]
curr_Stock_Price:  99.7353622592685
curr_Factors:  [9.97353623e+01 3.83685751e-02]
mat_Sqrt:  [[ 1.95360611e+01  0.00000000e+00]
 [-7.83515923e-03  1.79526051e-02]]
grads:  [-0.02337833 -6.46091547]
Stock Position:  -0.02337833112101769
Bond Position:  [5.03577591]


portfolio before change:  [2.78224855]
curr_Stock_Price:  96.44770809980398
curr_Factors:  [9.64477081e+01 4.11354552e-02]
mat_Sqrt:  [[ 1.95614059e+01  0.00000000e+00]
 [-8.11275097e-03  1.85886477e-02]]
grads:  [3.33502771e-04 6.80329281e+00]
Stock Position:  0.0003335027705681869
Bond Position:  [2.75008298]


portfolio before change:  [2.78349356]
curr_Stock_Price:  98.11906162366796
curr_Factors:  [9.81190616e+01 3.90679797e-02]
mat_Sqrt:  [[ 1.93938424e+01  0.00000000e+00]
 [-7.90624864e-03  1.81154914e-02]]
grads:  [-0.01596877  8.17889662]
Stock Position:  -0.015968772988374055
Bond Position:  [4.35033458]


portfolio before change:  [2.77657533]
curr_Stock_Price:  98.62041172170332
curr_Factors:  [9.86204117e+01 4.04358404e-02]
mat_Sqrt:  [[ 1.98312481e+01  0.00000000e+00]
 [-8.04346596e-03  1.84298958e-02]]
grads:  [4.72627900e-03 7.98574538e+00]
Stock Position:  0.004726278997194529
Bond Position:  [2.31046775]


portfolio before change:  [2.77688584]
curr_Stock_Price:  98.5638807951977
curr_Factors:  [9.85638808e+01 3.82502070e-02]
mat_Sqrt:  [[ 1.92767888e+01  0.00000000e+00]
 [-7.82306406e-03  1.79248916e-02]]
grads:  [-0.01113038 -2.02704305]
Stock Position:  -0.011130382432893673
Bond Position:  [3.87393953]


portfolio before change:  [2.79375473]
curr_Stock_Price:  97.13533325021983
curr_Factors:  [9.71353333e+01 3.91099755e-02]
mat_Sqrt:  [[ 1.92097188e+01  0.00000000e+00]
 [-7.91049688e-03  1.81252254e-02]]
grads:  [0.01104943 0.42357892]
Stock Position:  0.011049432596448918
Bond Position:  [1.72046441]


portfolio before change:  [2.75692219]
curr_Stock_Price:  93.76296904068363
curr_Factors:  [9.37629690e+01 4.05034823e-02]
mat_Sqrt:  [[ 1.88702447e+01  0.00000000e+00]
 [-8.05019078e-03  1.84453043e-02]]
grads:  [-0.00653801 -2.40504472]
Stock Position:  -0.006538005052340388
Bond Position:  [3.36994495]


portfolio before change:  [2.76259761]
curr_Stock_Price:  93.02377923882301
curr_Factors:  [9.30237792e+01 3.98652323e-02]
mat_Sqrt:  [[ 1.85733879e+01  0.00000000e+00]
 [-7.98651185e-03  1.82993976e-02]]
grads:  [-0.00520253 -0.1621947 ]
Stock Position:  -0.005202525065077221
Bond Position:  [3.24655615]


portfolio before change:  [2.77246193]
curr_Stock_Price:  91.28374286583046
curr_Factors:  [9.12837429e+01 4.12019228e-02]
mat_Sqrt:  [[ 1.85290085e+01  0.00000000e+00]
 [-8.11930271e-03  1.86036596e-02]]
grads:  [ 0.01530465 -2.45946918]
Stock Position:  0.01530464520056533
Bond Position:  [1.37539663]


portfolio before change:  [2.75210349]
curr_Stock_Price:  89.93106019067716
curr_Factors:  [8.99310602e+01 4.10654570e-02]
mat_Sqrt:  [[ 1.82241820e+01  0.00000000e+00]
 [-8.10584550e-03  1.85728253e-02]]
grads:  [0.01494026 8.69367368]
Stock Position:  0.014940263657893632
Bond Position:  [1.40850974]


portfolio before change:  [2.76678527]
curr_Stock_Price:  90.89018699672896
curr_Factors:  [9.08901870e+01 4.19880247e-02]
mat_Sqrt:  [[ 1.86242897e+01  0.00000000e+00]
 [-8.19639186e-03  1.87802931e-02]]
grads:  [-0.01840931 -5.3626125 ]
Stock Position:  -0.018409306870263712
Bond Position:  [4.44001062]


portfolio before change:  [2.76257032]
curr_Stock_Price:  91.17944774668466
curr_Factors:  [9.11794477e+01 3.94553744e-02]
mat_Sqrt:  [[ 1.81113174e+01  0.00000000e+00]
 [-7.94535079e-03  1.82050857e-02]]
grads:  [0.00593902 2.95245911]
Stock Position:  0.005939018138266546
Bond Position:  [2.22105393]


portfolio before change:  [2.77112782]
curr_Stock_Price:  92.52683537475528
curr_Factors:  [9.25268354e+01 3.72714356e-02]
mat_Sqrt:  [[ 1.78630564e+01  0.00000000e+00]
 [-7.72232458e-03  1.76940685e-02]]
grads:  [ 4.75731276e-04 -3.58557852e+00]
Stock Position:  0.0004757312758274628
Bond Position:  [2.72710991]


portfolio before change:  [2.77139495]
curr_Stock_Price:  91.65507332739637
curr_Factors:  [9.16550733e+01 3.71267209e-02]
mat_Sqrt:  [[ 1.76603703e+01  0.00000000e+00]
 [-7.70731817e-03  1.76596845e-02]]
grads:  [  0.0569063  -32.08125527]
Stock Position:  0.05690630228112607
Bond Position:  [-2.44435635]


portfolio before change:  [2.87119733]
curr_Stock_Price:  93.41961494206016
curr_Factors:  [9.34196149e+01 3.82971379e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.87119733]
Stock Price:  90.32193909484621
PL:  [2.87119733]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-8.19173119e-02  1.76164122e-02]
 [-1.41400490e-01 -6.16840886e-02]
 [-1.29658013e-01 -3.45247653e-01]
 [-3.40110798e-02  2.76066680e-01]
 [-4.42139880e-01 -3.08649354e-02]
 [ 1.57468645e-01  6.06301515e-03]
 [-2.42132588e-01  7.56611625e-02]
 [-1.97240751e-02  1.54122881e-01]
 [-2.02127439e-01 -2.29818012e-02]
 [ 2.18027923e-01  1.23624238e-02]
 [ 1.24559036e-01  1.90130863e-01]
 [-2.36377903e-01  6.50329567e-02]
 [-2.98206208e-03  4.35947635e-02]
 [-2.72171371e-01 -2.53357138e-01]
 [-2.68683289e-02 -9.33499782e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.26408254e-02  5.39893693e-02]
 [ 2.69880352e-01 -1.89661135e-01]
 [ 7.36381396e-02 -1.84730029e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.36020353]
curr_Stock_Price:  99.96329561802358
curr_Factors:  [9.99632956e+01 4.06449288e-02]
mat_Sqrt:  [[ 2.01531877e+01  0.00000000e+00]
 [-8.06423500e-03  1.84774836e-02]]
grads:  [-0.00368323  0.95339888]
Stock Position:  -0.0036832326739084705
Bond Position:  [2.72839161]


portfolio before change:  [2.35653601]
curr_Stock_Price:  101.14424306505246
curr_Factors:  [1.01144243e+02 3.96355700e-02]
mat_Sqrt:  [[ 2.01364878e+01  0.00000000e+00]
 [-7.96347361e-03  1.82466103e-02]]
grads:  [-0.00835904 -3.38057796]
Stock Position:  -0.00835903634373576
Bond Position:  [3.20200441]


portfolio before change:  [2.34561297]
curr_Stock_Price:  102.54675388211476
curr_Factors:  [1.02546754e+02 4.26529223e-02]
mat_Sqrt:  [[ 2.11785544e+01  0.00000000e+00]
 [-8.26103357e-03  1.89284058e-02]]
grads:  [-1.32368072e-02 -1.82396582e+01]
Stock Position:  -0.013236807193321366
Bond Position:  [3.70300458]


portfolio before change:  [2.40705752]
curr_Stock_Price:  97.97475393385578
curr_Factors:  [9.79747539e+01 4.32635343e-02]
mat_Sqrt:  [[ 2.03786391e+01  0.00000000e+00]
 [-8.31995522e-03  1.90634123e-02]]
grads:  [4.24337938e-03 1.44814934e+01]
Stock Position:  0.004243379380066014
Bond Position:  [1.99131347]


portfolio before change:  [2.39429366]
curr_Stock_Price:  94.84947342319325
curr_Factors:  [9.48494734e+01 4.54102094e-02]
mat_Sqrt:  [[ 2.02121111e+01  0.00000000e+00]
 [-8.52386855e-03  1.95306364e-02]]
grads:  [-0.02254146 -1.58033434]
Stock Position:  -0.02254145745942552
Bond Position:  [4.53233903]


portfolio before change:  [2.38646655]
curr_Stock_Price:  95.24697806327376
curr_Factors:  [9.52469781e+01 4.49820099e-02]
mat_Sqrt:  [[ 2.02008961e+01  0.00000000e+00]
 [-8.48358509e-03  1.94383354e-02]]
grads:  [0.00792612 0.3119102 ]
Stock Position:  0.007926121731619329
Bond Position:  [1.63152741]


portfolio before change:  [2.38294811]
curr_Stock_Price:  94.75160610079189
curr_Factors:  [9.47516061e+01 4.47975413e-02]
mat_Sqrt:  [[ 2.00545845e+01  0.00000000e+00]
 [-8.46617186e-03  1.93984367e-02]]
grads:  [-0.01042711  3.90037422]
Stock Position:  -0.010427109517352479
Bond Position:  [3.37093348]


portfolio before change:  [2.37502735]
curr_Stock_Price:  95.59206876122926
curr_Factors:  [9.55920688e+01 4.58914435e-02]
mat_Sqrt:  [[ 2.04780085e+01  0.00000000e+00]
 [-8.56891531e-03  1.96338515e-02]]
grads:  [2.32154728e-03 7.84985469e+00]
Stock Position:  0.0023215472765590645
Bond Position:  [2.15310584]


portfolio before change:  [2.3814643]
curr_Stock_Price:  98.13287848820758
curr_Factors:  [9.81328785e+01 4.33730882e-02]
mat_Sqrt:  [[ 2.04373560e+01  0.00000000e+00]
 [-8.33048264e-03  1.90875336e-02]]
grads:  [-0.01038087 -1.20402151]
Stock Position:  -0.01038086917900334
Bond Position:  [3.40016888]


portfolio before change:  [2.33750652]
curr_Stock_Price:  102.44927314424353
curr_Factors:  [1.02449273e+02 4.06982520e-02]
mat_Sqrt:  [[ 2.06679194e+01  0.00000000e+00]
 [-8.06952311e-03  1.84896002e-02]]
grads:  [0.01081015 0.66861499]
Stock Position:  0.010810150857276655
Bond Position:  [1.23001442]


portfolio before change:  [2.32682067]
curr_Stock_Price:  101.4323217658661
curr_Factors:  [1.01432322e+02 4.15211542e-02]
mat_Sqrt:  [[ 2.06686007e+01  0.00000000e+00]
 [-8.15069609e-03  1.86755909e-02]]
grads:  [1.00412674e-02 1.01807147e+01]
Stock Position:  0.010041267424805756
Bond Position:  [1.3083116]


portfolio before change:  [2.30870052]
curr_Stock_Price:  99.59517673697955
curr_Factors:  [9.95951767e+01 4.19669633e-02]
mat_Sqrt:  [[ 2.04029084e+01  0.00000000e+00]
 [-8.19433593e-03  1.87755823e-02]]
grads:  [-0.01019439  3.46369852]
Stock Position:  -0.010194389459999372
Bond Position:  [3.32401254]


portfolio before change:  [2.28559502]
curr_Stock_Price:  101.94319459718034
curr_Factors:  [1.01943195e+02 4.14620190e-02]
mat_Sqrt:  [[ 2.07579022e+01  0.00000000e+00]
 [-8.14488984e-03  1.86622871e-02]]
grads:  [7.72922638e-04 2.33598183e+00]
Stock Position:  0.000772922638019398
Bond Position:  [2.20680082]


portfolio before change:  [2.28658021]
curr_Stock_Price:  102.50394923480803
curr_Factors:  [1.02503949e+02 4.09202392e-02]
mat_Sqrt:  [[ 2.07352693e+01  0.00000000e+00]
 [-8.09150065e-03  1.85399571e-02]]
grads:  [ -0.01845867 -13.66546516]
Stock Position:  -0.01845866990229435
Bond Position:  [4.17866677]


portfolio before change:  [2.32189284]
curr_Stock_Price:  100.64748668897357
curr_Factors:  [1.00647487e+02 4.22877665e-02]
mat_Sqrt:  [[ 2.06971386e+01  0.00000000e+00]
 [-8.22559581e-03  1.88472077e-02]]
grads:  [-3.26661577e-03 -4.95298718e+00]
Stock Position:  -0.0032666157743279594
Bond Position:  [2.6506695]


portfolio before change:  [2.31673063]
curr_Stock_Price:  102.4306633716366
curr_Factors:  [1.02430663e+02 4.17748495e-02]
mat_Sqrt:  [[ 2.09356974e+01  0.00000000e+00]
 [-8.17555865e-03  1.87325582e-02]]
grads:  [0.00458528 0.93586021]
Stock Position:  0.0045852750183594995
Bond Position:  [1.84705787]


portfolio before change:  [2.32128811]
curr_Stock_Price:  103.32388339301004
curr_Factors:  [1.03323883e+02 4.37065698e-02]
mat_Sqrt:  [[ 2.16010112e+01  0.00000000e+00]
 [-8.36244652e-03  1.91607721e-02]]
grads:  [-1.34613758e-03  2.81770322e+00]
Stock Position:  -0.0013461375779373645
Bond Position:  [2.46037628]


portfolio before change:  [2.32117929]
curr_Stock_Price:  103.8617169322181
curr_Factors:  [1.03861717e+02 4.30673883e-02]
mat_Sqrt:  [[ 2.15540936e+01  0.00000000e+00]
 [-8.30107350e-03  1.90201488e-02]]
grads:  [ 8.68073832e-03 -9.97159047e+00]
Stock Position:  0.008680738321510494
Bond Position:  [1.4195829]


portfolio before change:  [2.33870149]
curr_Stock_Price:  105.83934407929372
curr_Factors:  [1.05839344e+02 4.17702089e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.33870149]
Stock Price:  103.78263185320718
PL:  [-1.44393036]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.98844738e-01 -8.17298829e-01]
 [ 8.29379828e-03  2.57549084e-01]
 [-4.09525181e-01 -7.38646446e-02]
 [ 5.09826272e-02  8.31177506e-02]
 [-3.18866570e-01  1.17736226e-01]
 [ 1.48781445e-02  1.65625353e-01]
 [-2.26159207e-01  7.06513260e-02]
 [ 2.01635676e-01  8.13302305e-03]
 [-6.53248042e-02  1.41494141e-02]
 [-1.30402739e-01  1.78367621e-02]
 [-1.13027482e-01  2.69739366e-02]
 [-6.04883456e-02 -2.02226432e-01]
 [-2.26444185e-01 -1.30605226e-01]
 [ 8.80796470e-02  3.23849348e-02]
 [ 6.34450105e-02 -8.43601795e-02]
 [ 7.10595721e-01 -3.41482405e-01]
 [ 1.88244156e-01  1.36369700e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.17159565]
curr_Stock_Price:  98.43457031662645
curr_Factors:  [9.84345703e+01 3.99060261e-02]
mat_Sqrt:  [[ 1.96637748e+01  0.00000000e+00]
 [-7.99059708e-03  1.83087580e-02]]
grads:  [ 0.00141741 -0.07378077]
Stock Position:  0.001417407285599267
Bond Position:  [-8.31111753]


portfolio before change:  [-8.17324845]
curr_Stock_Price:  98.73458684148241
curr_Factors:  [9.87345868e+01 3.86739211e-02]
mat_Sqrt:  [[ 1.94168340e+01  0.00000000e+00]
 [-7.86627445e-03  1.80238991e-02]]
grads:  [-0.00959605 -3.69797733]
Stock Position:  -0.00959604797841093
Bond Position:  [-7.22578661]


portfolio before change:  [-8.17483925]
curr_Stock_Price:  98.7120912477693
curr_Factors:  [9.87120912e+01 3.85003439e-02]
mat_Sqrt:  [[ 1.93687974e+01  0.00000000e+00]
 [-7.84860180e-03  1.79834059e-02]]
grads:  [-2.86823791e-02 -4.54473882e+01]
Stock Position:  -0.028682379093840544
Bond Position:  [-5.34354163]


portfolio before change:  [-8.19525271]
curr_Stock_Price:  99.3772177188721
curr_Factors:  [9.93772177e+01 3.98173613e-02]
mat_Sqrt:  [[ 1.98300163e+01  0.00000000e+00]
 [-7.98171523e-03  1.82884071e-02]]
grads:  [6.08660286e-03 1.40826417e+01]
Stock Position:  0.0060866028577349915
Bond Position:  [-8.80012237]


portfolio before change:  [-8.20674825]
curr_Stock_Price:  97.85005411223844
curr_Factors:  [9.78500541e+01 4.03760862e-02]
mat_Sqrt:  [[ 1.96617957e+01  0.00000000e+00]
 [-8.03752063e-03  1.84162733e-02]]
grads:  [-0.02246806 -4.01083559]
Stock Position:  -0.022468057386115965
Bond Position:  [-6.00824762]


portfolio before change:  [-8.16320063]
curr_Stock_Price:  95.84499072005487
curr_Factors:  [9.58449907e+01 3.82678822e-02]
mat_Sqrt:  [[ 1.87493680e+01  0.00000000e+00]
 [-7.82487134e-03  1.79290326e-02]]
grads:  [0.00465393 4.63593058]
Stock Position:  0.004653926867086206
Bond Position:  [-8.6092562]


portfolio before change:  [-8.16103541]
curr_Stock_Price:  96.77276510427306
curr_Factors:  [9.67727651e+01 3.93865170e-02]
mat_Sqrt:  [[ 1.92055584e+01  0.00000000e+00]
 [-7.93841465e-03  1.81891930e-02]]
grads:  [-0.01392734  6.47286692]
Stock Position:  -0.013927336167534715
Bond Position:  [-6.81324858]


portfolio before change:  [-8.17836503]
curr_Stock_Price:  97.89473799389692
curr_Factors:  [9.78947380e+01 3.77049883e-02]
mat_Sqrt:  [[ 1.90089774e+01  0.00000000e+00]
 [-7.76710894e-03  1.77966823e-02]]
grads:  [4.58535843e-03 9.30652971e+00]
Stock Position:  0.004585358429816358
Bond Position:  [-8.62724749]


portfolio before change:  [-8.19087894]
curr_Stock_Price:  95.63606493102859
curr_Factors:  [9.56360649e+01 4.00247374e-02]
mat_Sqrt:  [[ 1.91331265e+01  0.00000000e+00]
 [-8.00247335e-03  1.83359699e-02]]
grads:  [-0.0102087   3.85315455]
Stock Position:  -0.01020870477624919
Bond Position:  [-7.21455859]


portfolio before change:  [-8.20501599]
curr_Stock_Price:  96.84416940758479
curr_Factors:  [9.68441694e+01 3.95057034e-02]
mat_Sqrt:  [[ 1.92487875e+01  0.00000000e+00]
 [-7.95041668e-03  1.82166931e-02]]
grads:  [0.01065964 0.4464599 ]
Stock Position:  0.010659643813721621
Bond Position:  [-9.23734034]


portfolio before change:  [-8.20035449]
curr_Stock_Price:  97.49814224747618
curr_Factors:  [9.74981422e+01 3.89805277e-02]
mat_Sqrt:  [[ 1.92495330e+01  0.00000000e+00]
 [-7.89739478e-03  1.80952047e-02]]
grads:  [-0.00307278  0.78194275]
Stock Position:  -0.0030727755151376203
Bond Position:  [-7.90076459]


portfolio before change:  [-8.19247429]
curr_Stock_Price:  94.29073665561253
curr_Factors:  [9.42907367e+01 4.11336292e-02]
mat_Sqrt:  [[ 1.91235072e+01  0.00000000e+00]
 [-8.11257090e-03  1.85882351e-02]]
grads:  [-0.00641191  0.95957265]
Stock Position:  -0.006411906413861314
Bond Position:  [-7.58789091]


portfolio before change:  [-8.21002551]
curr_Stock_Price:  96.73213258741833
curr_Factors:  [9.67321326e+01 4.06745609e-02]
mat_Sqrt:  [[ 1.95088738e+01  0.00000000e+00]
 [-8.06717407e-03  1.84842179e-02]]
grads:  [-0.00519021  1.45929553]
Stock Position:  -0.005190206855470381
Bond Position:  [-7.70796573]


portfolio before change:  [-8.20811225]
curr_Stock_Price:  95.99218456962988
curr_Factors:  [9.59921846e+01 3.90077917e-02]
mat_Sqrt:  [[ 1.89588311e+01  0.00000000e+00]
 [-7.90015612e-03  1.81015317e-02]]
grads:  [-7.84579995e-03 -1.11717856e+01]
Stock Position:  -0.00784579994814356
Bond Position:  [-7.45497678]


portfolio before change:  [-8.20266909]
curr_Stock_Price:  95.06083951052618
curr_Factors:  [9.50608395e+01 3.71291308e-02]
mat_Sqrt:  [[ 1.83171978e+01  0.00000000e+00]
 [-7.70756831e-03  1.76602576e-02]]
grads:  [-0.01547425 -7.39543153]
Stock Position:  -0.015474254381414934
Bond Position:  [-6.73167347]


portfolio before change:  [-8.19709334]
curr_Stock_Price:  94.59174619432102
curr_Factors:  [9.45917462e+01 3.76761518e-02]
mat_Sqrt:  [[ 1.83605849e+01  0.00000000e+00]
 [-7.76413826e-03  1.77898756e-02]]
grads:  [0.00556701 1.82041378]
Stock Position:  0.005567011723740672
Bond Position:  [-8.7236867]


portfolio before change:  [-8.19601313]
curr_Stock_Price:  95.17759138926193
curr_Factors:  [9.51775914e+01 3.49081893e-02]
mat_Sqrt:  [[ 1.77827274e+01  0.00000000e+00]
 [-7.47349336e-03  1.71239245e-02]]
grads:  [ 1.49736366e-03 -4.92645126e+00]
Stock Position:  0.0014973636567529205
Bond Position:  [-8.3385286]


portfolio before change:  [-8.19476359]
curr_Stock_Price:  97.40445915294214
curr_Factors:  [9.74044592e+01 3.53171141e-02]
mat_Sqrt:  [[ 1.83050721e+01  0.00000000e+00]
 [-7.51713926e-03  1.72239298e-02]]
grads:  [  0.03067787 -19.82604483]
Stock Position:  0.0306778677704839
Bond Position:  [-11.18292471]


portfolio before change:  [-8.1782246]
curr_Stock_Price:  98.03472054984371
curr_Factors:  [9.80347205e+01 3.42829334e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.1782246]
Stock Price:  96.5446569922289
PL:  [-8.1782246]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-6.12943642e-02  1.38922198e-01]
 [ 1.07099331e-01 -2.22541201e-02]
 [-1.20410322e-01 -2.82151979e-01]
 [ 2.26096133e-01 -8.41340762e-02]
 [-1.01885733e-01 -7.28977655e-02]
 [ 5.00594031e-01 -6.50869189e-01]
 [-6.01169099e-01  4.86551176e-01]
 [ 2.18786295e-01  1.49874618e-01]
 [-1.10107486e-01 -1.88840702e-02]
 [ 1.54492308e-01  1.58082148e-02]
 [ 2.47092959e-01  3.68611322e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-6.77206694e-02  9.89993118e-02]
 [-2.43734882e-01 -5.00286040e-02]
 [ 2.49251572e-01  3.03299701e-01]
 [ 5.63440580e-02  4.79989555e-02]
 [-5.35741738e-02  3.08011438e-01]
 [ 1.22096206e-01  1.43177341e-01]
 [-5.62273768e-02 -2.43630036e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.77751328]
curr_Stock_Price:  100.74963595159477
curr_Factors:  [1.00749636e+02 4.21929621e-02]
mat_Sqrt:  [[ 2.06949077e+01  0.00000000e+00]
 [-8.21637020e-03  1.88260692e-02]]
grads:  [-3.20729364e-05  7.37924610e+00]
Stock Position:  -3.2072936367285345e-05
Bond Position:  [7.78074462]


portfolio before change:  [7.77940337]
curr_Stock_Price:  102.47514203561668
curr_Factors:  [1.02475142e+02 4.27443609e-02]
mat_Sqrt:  [[ 2.11864378e+01  0.00000000e+00]
 [-8.26988376e-03  1.89486842e-02]]
grads:  [ 0.00459666 -1.17444145]
Stock Position:  0.004596659302842835
Bond Position:  [7.30836005]


portfolio before change:  [7.7839772]
curr_Stock_Price:  103.07264485602197
curr_Factors:  [1.03072645e+02 4.32103322e-02]
mat_Sqrt:  [[ 2.14258087e+01  0.00000000e+00]
 [-8.31483804e-03  1.90516873e-02]]
grads:  [-1.13672042e-02 -1.48098158e+01]
Stock Position:  -0.011367204157241836
Bond Position:  [8.955625]


portfolio before change:  [7.79406636]
curr_Stock_Price:  102.38206393011912
curr_Factors:  [1.02382064e+02 4.50209067e-02]
mat_Sqrt:  [[ 2.17235601e+01  0.00000000e+00]
 [-8.48725225e-03  1.94467379e-02]]
grads:  [ 0.00871759 -4.32638505]
Stock Position:  0.008717586400308706
Bond Position:  [6.90154187]


portfolio before change:  [7.80821688]
curr_Stock_Price:  103.80733359630686
curr_Factors:  [1.03807334e+02 4.37683543e-02]
mat_Sqrt:  [[ 2.17174157e+01  0.00000000e+00]
 [-8.36835509e-03  1.91743103e-02]]
grads:  [-0.00615639 -3.8018455 ]
Stock Position:  -0.006156392086106178
Bond Position:  [8.44729552]


portfolio before change:  [7.82127877]
curr_Stock_Price:  102.0287255246177
curr_Factors:  [1.02028726e+02 4.48964945e-02]
mat_Sqrt:  [[ 2.16186554e+01  0.00000000e+00]
 [-8.47551716e-03  1.94198495e-02]]
grads:  [ 1.00159526e-02 -3.35156660e+01]
Stock Position:  0.010015952638822363
Bond Position:  [6.79936389]


portfolio before change:  [7.84237913]
curr_Stock_Price:  103.96566597779605
curr_Factors:  [1.03965666e+02 4.12327545e-02]
mat_Sqrt:  [[ 2.11111122e+01  0.00000000e+00]
 [-8.12234000e-03  1.86106189e-02]]
grads:  [-1.84178244e-02  2.61437396e+01]
Stock Position:  -0.018417824372011875
Bond Position:  [9.75720051]


portfolio before change:  [7.89450081]
curr_Stock_Price:  101.26816642909714
curr_Factors:  [1.01268166e+02 4.08714461e-02]
mat_Sqrt:  [[ 2.04730689e+01  0.00000000e+00]
 [-8.08667507e-03  1.85289003e-02]]
grads:  [0.0138815  8.08869471]
Stock Position:  0.013881501689502375
Bond Position:  [6.48874658]


portfolio before change:  [7.91069818]
curr_Stock_Price:  102.31812396943674
curr_Factors:  [1.02318124e+02 4.06799221e-02]
mat_Sqrt:  [[ 2.06368128e+01  0.00000000e+00]
 [-8.06770571e-03  1.84854360e-02]]
grads:  [-0.00573486 -1.02156477]
Stock Position:  -0.005734856980726952
Bond Position:  [8.49747799]


portfolio before change:  [7.90578691]
curr_Stock_Price:  103.54499169864769
curr_Factors:  [1.03544992e+02 4.06248138e-02]
mat_Sqrt:  [[ 2.08701125e+01  0.00000000e+00]
 [-8.06223927e-03  1.84729109e-02]]
grads:  [0.00773314 0.85575116]
Stock Position:  0.007733143697995864
Bond Position:  [7.10505861]


portfolio before change:  [7.92194407]
curr_Stock_Price:  105.40460780637036
curr_Factors:  [1.05404608e+02 3.88976428e-02]
mat_Sqrt:  [[ 2.07884083e+01  0.00000000e+00]
 [-7.88899414e-03  1.80759564e-02]]
grads:  [1.96247891e-02 2.03923551e+01]
Stock Position:  0.01962478908904604
Bond Position:  [5.85340088]


portfolio before change:  [7.9033171]
curr_Stock_Price:  104.38087681400002
curr_Factors:  [1.04380877e+02 3.98670610e-02]
mat_Sqrt:  [[ 2.08414558e+01  0.00000000e+00]
 [-7.98669503e-03  1.82998173e-02]]
grads:  [-0.00906885  6.24777407]
Stock Position:  -0.009068846536280572
Bond Position:  [8.84993126]


portfolio before change:  [7.89570909]
curr_Stock_Price:  105.46379025868161
curr_Factors:  [1.05463790e+02 3.94825284e-02]
mat_Sqrt:  [[ 2.09558776e+01  0.00000000e+00]
 [-7.94808439e-03  1.82113492e-02]]
grads:  [-1.16978291e-03  5.43613276e+00]
Stock Position:  -0.001169782908942861
Bond Position:  [8.01907882]


portfolio before change:  [7.89541287]
curr_Stock_Price:  107.43102323449753
curr_Factors:  [1.07431023e+02 3.68535871e-02]
mat_Sqrt:  [[ 2.06238431e+01  0.00000000e+00]
 [-7.67891525e-03  1.75946052e-02]]
grads:  [-0.0128768  -2.84340589]
Stock Position:  -0.012876802559517224
Bond Position:  [9.27878095]


portfolio before change:  [7.87915617]
curr_Stock_Price:  108.87367065907509
curr_Factors:  [1.08873671e+02 3.68911920e-02]
mat_Sqrt:  [[ 2.09114530e+01  0.00000000e+00]
 [-7.68283198e-03  1.76035795e-02]]
grads:  [ 0.01824945 17.22943336]
Stock Position:  0.01824944514636264
Bond Position:  [5.89227209]


portfolio before change:  [7.89582771]
curr_Stock_Price:  109.7064788693585
curr_Factors:  [1.09706479e+02 3.77617852e-02]
mat_Sqrt:  [[ 2.13185928e+01  0.00000000e+00]
 [-7.77295673e-03  1.78100813e-02]]
grads:  [0.00362559 2.69504415]
Stock Position:  0.0036255919967640928
Bond Position:  [7.49807678]


portfolio before change:  [7.89735625]
curr_Stock_Price:  109.61098680009133
curr_Factors:  [1.09610987e+02 3.63749869e-02]
mat_Sqrt:  [[ 2.09052570e+01  0.00000000e+00]
 [-7.62889108e-03  1.74799854e-02]]
grads:  [3.86759362e-03 1.76208063e+01]
Stock Position:  0.003867593619922074
Bond Position:  [7.47342549]


portfolio before change:  [7.89736844]
curr_Stock_Price:  109.13099888583609
curr_Factors:  [1.09130999e+02 3.50215447e-02]
mat_Sqrt:  [[ 2.04228233e+01  0.00000000e+00]
 [-7.48561764e-03  1.71517047e-02]]
grads:  [0.00903812 8.34770323]
Stock Position:  0.009038119650161216
Bond Position:  [6.91102941]


portfolio before change:  [7.90060933]
curr_Stock_Price:  109.29839144405439
curr_Factors:  [1.09298391e+02 3.54903685e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.90060933]
Stock Price:  109.70730368592606
PL:  [-1.80669436]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-8.40701826e-02  2.17297422e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.04884634e-01 -8.58508179e-01]
 [-3.10287325e-02  2.76379208e-01]
 [-4.09588985e-01 -8.07086259e-02]
 [ 2.41357086e-01 -2.64290892e-01]
 [-4.25444305e-01  1.68051529e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-2.13899734e-01  2.28856874e-02]
 [ 2.07424166e-01  7.77030406e-03]
 [-2.29132835e-02  5.39314142e-02]
 [-2.36344502e-01  6.43818655e-02]
 [-1.22694087e-01  3.05919779e-02]
 [-4.44888349e-02 -1.94735338e-01]
 [-1.97771601e-01 -1.36955539e-01]
 [ 8.74276519e-02  5.18799184e-02]
 [ 2.89776029e-02 -6.97135970e-02]
 [ 6.45716544e-01 -3.15382812e-01]
 [ 1.74414432e-01  1.46767017e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.52333612]
curr_Stock_Price:  99.98697485052718
curr_Factors:  [9.99869749e+01 3.97436680e-02]
mat_Sqrt:  [[ 1.99332173e+01  0.00000000e+00]
 [-7.97432560e-03  1.82714753e-02]]
grads:  [-0.00374182  1.18927135]
Stock Position:  -0.0037418217173745185
Bond Position:  [2.89746956]


portfolio before change:  [2.52252768]
curr_Stock_Price:  100.39664267630351
curr_Factors:  [1.00396643e+02 4.45382375e-02]
mat_Sqrt:  [[ 2.11877921e+01  0.00000000e+00]
 [-8.44163373e-03  1.93422128e-02]]
grads:  [-0.00879397 -3.44593304]
Stock Position:  -0.008793972917226021
Bond Position:  [3.40541303]


portfolio before change:  [2.54054105]
curr_Stock_Price:  98.4450890393682
curr_Factors:  [9.84450890e+01 4.77826206e-02]
mat_Sqrt:  [[ 2.15193445e+01  0.00000000e+00]
 [-8.74369447e-03  2.00343209e-02]]
grads:  [-2.69324338e-02 -4.28518732e+01]
Stock Position:  -0.02693243375745768
Bond Position:  [5.19190688]


portfolio before change:  [2.56323438]
curr_Stock_Price:  97.65068643157386
curr_Factors:  [9.76506864e+01 4.95196656e-02]
mat_Sqrt:  [[ 2.17302214e+01  0.00000000e+00]
 [-8.90120582e-03  2.03952247e-02]]
grads:  [4.12296963e-03 1.35511725e+01]
Stock Position:  0.004122969626215522
Bond Position:  [2.16062357]


portfolio before change:  [2.5661081]
curr_Stock_Price:  98.21666007866534
curr_Factors:  [9.82166601e+01 4.96516248e-02]
mat_Sqrt:  [[ 2.18852693e+01  0.00000000e+00]
 [-8.91305782e-03  2.04223811e-02]]
grads:  [-0.02032477 -3.95196944]
Stock Position:  -0.02032477242562851
Bond Position:  [4.56233936]


portfolio before change:  [2.54876757]
curr_Stock_Price:  99.12595675708644
curr_Factors:  [9.91259568e+01 4.98117275e-02]
mat_Sqrt:  [[ 2.21234674e+01  0.00000000e+00]
 [-8.92741642e-03  2.04552808e-02]]
grads:  [ 5.69581082e-03 -1.29204236e+01]
Stock Position:  0.005695810823139002
Bond Position:  [1.98416488]


portfolio before change:  [2.54581512]
curr_Stock_Price:  98.5205021891004
curr_Factors:  [9.85205022e+01 5.08971620e-02]
mat_Sqrt:  [[ 2.22266188e+01  0.00000000e+00]
 [-9.02415975e-03  2.06769476e-02]]
grads:  [-0.01584139  8.12748248]
Stock Position:  -0.015841393091369876
Bond Position:  [4.10651713]


portfolio before change:  [2.53714336]
curr_Stock_Price:  99.13272879863811
curr_Factors:  [9.91327288e+01 4.93898154e-02]
mat_Sqrt:  [[ 2.20310787e+01  0.00000000e+00]
 [-8.88952781e-03  2.03684670e-02]]
grads:  [4.43941722e-03 6.66319092e+00]
Stock Position:  0.004439417221061924
Bond Position:  [2.09705182]


portfolio before change:  [2.52726409]
curr_Stock_Price:  96.78926791294053
curr_Factors:  [9.67892679e+01 5.07389276e-02]
mat_Sqrt:  [[ 2.18020759e+01  0.00000000e+00]
 [-9.01012120e-03  2.06447812e-02]]
grads:  [-0.00935285  1.10854589]
Stock Position:  -0.009352852575254117
Bond Position:  [3.43251984]


portfolio before change:  [2.52469239]
curr_Stock_Price:  97.15599373525549
curr_Factors:  [9.71559937e+01 5.23834416e-02]
mat_Sqrt:  [[ 2.22365093e+01  0.00000000e+00]
 [-9.15497169e-03  2.09766754e-02]]
grads:  [0.0094806  0.37042591]
Stock Position:  0.009480597948911157
Bond Position:  [1.60359548]


portfolio before change:  [2.53566357]
curr_Stock_Price:  98.27092706897193
curr_Factors:  [9.82709271e+01 5.20479070e-02]
mat_Sqrt:  [[ 2.24195395e+01  0.00000000e+00]
 [-9.12560416e-03  2.09093859e-02]]
grads:  [2.78469283e-05 2.57929212e+00]
Stock Position:  2.784692830954374e-05
Bond Position:  [2.53292703]


portfolio before change:  [2.53629676]
curr_Stock_Price:  98.26639794114064
curr_Factors:  [9.82663979e+01 5.16009769e-02]
mat_Sqrt:  [[ 2.23220460e+01  0.00000000e+00]
 [-9.08633936e-03  2.08194190e-02]]
grads:  [-0.00932916  3.09239492]
Stock Position:  -0.009329160615316384
Bond Position:  [3.45303977]


portfolio before change:  [2.54676416]
curr_Stock_Price:  97.23693396075303
curr_Factors:  [9.72369340e+01 5.79446491e-02]
mat_Sqrt:  [[ 2.34065780e+01  0.00000000e+00]
 [-9.62867792e-03  2.20620727e-02]]
grads:  [-0.00467145  1.38663209]
Stock Position:  -0.004671449775231326
Bond Position:  [3.00100162]


portfolio before change:  [2.55582887]
curr_Stock_Price:  95.45710856647288
curr_Factors:  [9.54571086e+01 6.13687457e-02]
mat_Sqrt:  [[ 2.36473184e+01  0.00000000e+00]
 [-9.90908639e-03  2.27045692e-02]]
grads:  [-5.47539058e-03 -8.57692283e+00]
Stock Position:  -0.005475390575617857
Bond Position:  [3.07849382]


portfolio before change:  [2.55522913]
curr_Stock_Price:  95.70722147093531
curr_Factors:  [9.57072215e+01 6.26974505e-02]
mat_Sqrt:  [[ 2.39645704e+01  0.00000000e+00]
 [-1.00157836e-02  2.29490432e-02]]
grads:  [-0.01074686 -5.96781041]
Stock Position:  -0.010746860619271157
Bond Position:  [3.58378129]


portfolio before change:  [2.5545964]
curr_Stock_Price:  95.84947525156133
curr_Factors:  [9.58494753e+01 6.31896581e-02]
mat_Sqrt:  [[ 2.40942128e+01  0.00000000e+00]
 [-1.00550213e-02  2.30389481e-02]]
grads:  [0.00456831 2.25183538]
Stock Position:  0.004568312953808827
Bond Position:  [2.116726]


portfolio before change:  [2.56349909]
curr_Stock_Price:  97.68241512010555
curr_Factors:  [9.76824151e+01 6.27742520e-02]
mat_Sqrt:  [[ 2.44741243e+01  0.00000000e+00]
 [-1.00219161e-02  2.29630947e-02]]
grads:  [-5.91606563e-05 -3.03589730e+00]
Stock Position:  -5.9160656289820235e-05
Bond Position:  [2.56927805]


portfolio before change:  [2.56412027]
curr_Stock_Price:  98.0410611826521
curr_Factors:  [9.80410612e+01 6.41162143e-02]
mat_Sqrt:  [[ 2.48251533e+01  0.00000000e+00]
 [-1.01284719e-02  2.32072446e-02]]
grads:  [  0.02046602 -13.5898431 ]
Stock Position:  0.02046602465082413
Bond Position:  [0.5576095]


portfolio before change:  [2.54029367]
curr_Stock_Price:  96.87004606197203
curr_Factors:  [9.68700461e+01 6.61311523e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.54029367]
Stock Price:  95.31848485761319
PL:  [2.54029367]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-6.77332725e-02  1.29246082e-01]
 [ 2.44075284e-02 -1.76480996e-02]
 [-1.46711886e-01 -4.61603805e-01]
 [ 8.32780698e-02  1.41404569e-01]
 [-4.71433670e-01 -1.23309076e-01]
 [-3.16419394e-02  9.35183628e-02]
 [-4.39635464e-01  1.69540366e-01]
 [ 1.30347560e-01  1.42927833e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.72898144e-01  4.62035843e-03]
 [ 1.44245812e-02  9.22551365e-02]
 [-2.20604602e-01  7.04453416e-02]
 [-4.14891982e-02  1.43169365e-02]
 [-1.05488838e-01 -2.23434943e-01]
 [-1.90267880e-01 -1.38617439e-01]
 [ 8.83669032e-02  5.35340701e-02]
 [ 6.08423928e-02 -8.01520176e-02]
 [ 8.93676359e-01 -4.17657272e-01]
 [ 1.45356296e-01  1.73399377e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.30422274]
curr_Stock_Price:  100.68093627269721
curr_Factors:  [1.00680936e+02 3.84961561e-02]
mat_Sqrt:  [[ 1.97540400e+01  0.00000000e+00]
 [-7.84817493e-03  1.79824279e-02]]
grads:  [-5.73333760e-04  7.18735438e+00]
Stock Position:  -0.0005733337598674615
Bond Position:  [7.36194652]


portfolio before change:  [7.30527374]
curr_Stock_Price:  102.0583436355604
curr_Factors:  [1.02058344e+02 3.89912239e-02]
mat_Sqrt:  [[ 2.01526401e+01  0.00000000e+00]
 [-7.89847823e-03  1.80976872e-02]]
grads:  [ 8.28936862e-04 -9.75157736e-01]
Stock Position:  0.0008289368620276893
Bond Position:  [7.22067382]


portfolio before change:  [7.30666589]
curr_Stock_Price:  101.5598180808978
curr_Factors:  [1.01559818e+02 3.85909431e-02]
mat_Sqrt:  [[ 1.99509973e+01  0.00000000e+00]
 [-7.85783106e-03  1.80045528e-02]]
grads:  [-1.74513734e-02 -2.56381711e+01]
Stock Position:  -0.017451373356760554
Bond Position:  [9.07902419]


portfolio before change:  [7.32997123]
curr_Stock_Price:  100.35445149316709
curr_Factors:  [1.00354451e+02 3.97868254e-02]
mat_Sqrt:  [[ 2.00173363e+01  0.00000000e+00]
 [-7.97865406e-03  1.82813931e-02]]
grads:  [7.24332553e-03 7.73489022e+00]
Stock Position:  0.0072433255289785685
Bond Position:  [6.60307127]


portfolio before change:  [7.3210082]
curr_Stock_Price:  98.8891020947873
curr_Factors:  [9.88891021e+01 4.06247167e-02]
mat_Sqrt:  [[ 1.99316662e+01  0.00000000e+00]
 [-8.06222964e-03  1.84728888e-02]]
grads:  [-0.02635255 -6.67513768]
Stock Position:  -0.026352546565822286
Bond Position:  [9.92698787]


portfolio before change:  [7.36246783]
curr_Stock_Price:  97.41002036528032
curr_Factors:  [9.74100204e+01 4.28150525e-02]
mat_Sqrt:  [[ 2.01558851e+01  0.00000000e+00]
 [-8.27671940e-03  1.89643466e-02]]
grads:  [4.55093892e-04 4.93127261e+00]
Stock Position:  0.0004550938915310717
Bond Position:  [7.31813713]


portfolio before change:  [7.36493407]
curr_Stock_Price:  98.8085687634602
curr_Factors:  [9.88085688e+01 4.17398300e-02]
mat_Sqrt:  [[ 2.01869146e+01  0.00000000e+00]
 [-8.17213118e-03  1.87247049e-02]]
grads:  [-0.01811282  9.05436789]
Stock Position:  -0.018112821512220482
Bond Position:  [9.15463604]


portfolio before change:  [7.33873739]
curr_Stock_Price:  100.3812457566228
curr_Factors:  [1.00381246e+02 4.01170649e-02]
mat_Sqrt:  [[ 2.01056055e+01  0.00000000e+00]
 [-8.01169794e-03  1.83571061e-02]]
grads:  [0.0095857  7.78596757]
Stock Position:  0.009585703871205224
Bond Position:  [6.3765125]


portfolio before change:  [7.33329083]
curr_Stock_Price:  99.64672605969368
curr_Factors:  [9.96467261e+01 3.99191022e-02]
mat_Sqrt:  [[ 1.99091820e+01  0.00000000e+00]
 [-7.99190613e-03  1.83117574e-02]]
grads:  [-0.01092867 -2.90244732]
Stock Position:  -0.010928669518557033
Bond Position:  [8.42229697]


portfolio before change:  [7.33763889]
curr_Stock_Price:  99.44155719782839
curr_Factors:  [9.94415572e+01 3.83699319e-02]
mat_Sqrt:  [[ 1.94788553e+01  0.00000000e+00]
 [-7.83529777e-03  1.79529226e-02]]
grads:  [0.01411349 0.25735968]
Stock Position:  0.014113490246314137
Bond Position:  [5.93417145]


portfolio before change:  [7.33150072]
curr_Stock_Price:  98.90151373076898
curr_Factors:  [9.89015137e+01 3.93150474e-02]
mat_Sqrt:  [[ 1.96102143e+01  0.00000000e+00]
 [-7.93120898e-03  1.81726828e-02]]
grads:  [2.78875196e-03 5.07658323e+00]
Stock Position:  0.0027887519611796267
Bond Position:  [7.05568893]


portfolio before change:  [7.32967418]
curr_Stock_Price:  97.61395261280849
curr_Factors:  [9.76139526e+01 4.04328301e-02]
mat_Sqrt:  [[ 1.96281320e+01  0.00000000e+00]
 [-8.04316655e-03  1.84292098e-02]]
grads:  [-0.00967284  3.82248303]
Stock Position:  -0.00967283770056477
Bond Position:  [8.2738781]


portfolio before change:  [7.34936557]
curr_Stock_Price:  95.79208141730705
curr_Factors:  [9.57920814e+01 4.04332296e-02]
mat_Sqrt:  [[ 1.92618868e+01  0.00000000e+00]
 [-8.04320629e-03  1.84293008e-02]]
grads:  [-0.00182956  0.77685728]
Stock Position:  -0.001829559856409431
Bond Position:  [7.52462292]


portfolio before change:  [7.34812412]
curr_Stock_Price:  97.49896170111936
curr_Factors:  [9.74989617e+01 3.84625778e-02]
mat_Sqrt:  [[ 1.91213779e+01  0.00000000e+00]
 [-7.84475140e-03  1.79745836e-02]]
grads:  [-1.06165907e-02 -1.24306047e+01]
Stock Position:  -0.010616590650965752
Bond Position:  [8.38323069]


portfolio before change:  [7.36769039]
curr_Stock_Price:  95.85340556539194
curr_Factors:  [9.58534056e+01 3.99441875e-02]
mat_Sqrt:  [[ 1.91573019e+01  0.00000000e+00]
 [-7.99441680e-03  1.83175101e-02]]
grads:  [-0.01308981 -7.56748264]
Stock Position:  -0.013089812526199545
Bond Position:  [8.6223935]


portfolio before change:  [7.36511259]
curr_Stock_Price:  96.21503497269171
curr_Factors:  [9.62150350e+01 3.97403343e-02]
mat_Sqrt:  [[ 1.91804459e+01  0.00000000e+00]
 [-7.97399115e-03  1.82707090e-02]]
grads:  [0.00582526 2.93004886]
Stock Position:  0.005825260124685948
Bond Position:  [6.80463499]


portfolio before change:  [7.35358593]
curr_Stock_Price:  93.94422894236735
curr_Factors:  [9.39442289e+01 3.93442414e-02]
mat_Sqrt:  [[ 1.86341975e+01  0.00000000e+00]
 [-7.93415315e-03  1.81794287e-02]]
grads:  [ 1.38783462e-03 -4.40894040e+00]
Stock Position:  0.0013878346187523956
Bond Position:  [7.22320688]


portfolio before change:  [7.35748853]
curr_Stock_Price:  95.45491158771094
curr_Factors:  [9.54549116e+01 3.93997990e-02]
mat_Sqrt:  [[ 1.89472106e+01  0.00000000e+00]
 [-7.93975305e-03  1.81922597e-02]]
grads:  [  0.0375462  -22.95796564]
Stock Position:  0.03754620115591572
Bond Position:  [3.77351922]


portfolio before change:  [7.313047]
curr_Stock_Price:  94.24613328664846
curr_Factors:  [9.42461333e+01 3.90183595e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.313047]
Stock Price:  95.83717021553721
PL:  [7.313047]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.97481598e-01 -1.13007653e+00]
 [ 1.73887083e-01  1.44590979e-03]
 [-1.36942202e-01 -7.87108491e-02]
 [ 5.45217491e-01 -7.19904164e-01]
 [-6.10856843e-01  5.25727883e-01]
 [ 7.41196363e-01  1.90909471e-01]
 [ 3.53961917e-01 -2.11147078e-01]
 [-1.90042908e-01  3.44684754e-02]
 [ 3.21771253e-01  4.87833896e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.52988375e-01  1.61991325e-01]
 [-2.25119013e-01  1.37335441e-02]
 [ 2.61638844e-01  3.58608362e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.30724375e-02  1.32308035e-01]
 [ 2.03904371e-01 -9.08244541e-02]
 [ 9.93927125e-02  2.72617783e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.86703074]
curr_Stock_Price:  98.91423878503171
curr_Factors:  [9.89142388e+01 4.12051866e-02]
mat_Sqrt:  [[ 2.00786614e+01  0.00000000e+00]
 [-8.11962429e-03  1.86043965e-02]]
grads:  [ 0.00138812 -0.07260834]
Stock Position:  0.0013881193105516978
Bond Position:  [-5.00433551]


portfolio before change:  [-4.86879097]
curr_Stock_Price:  98.54756929255457
curr_Factors:  [9.85475693e+01 4.20744544e-02]
mat_Sqrt:  [[ 2.02141351e+01  0.00000000e+00]
 [-8.20482340e-03  1.87996121e-02]]
grads:  [-0.00921755 -3.54539071]
Stock Position:  -0.009217553444756365
Bond Position:  [-3.96042348]


portfolio before change:  [-4.85332414]
curr_Stock_Price:  96.76216557153933
curr_Factors:  [9.67621656e+01 4.25333530e-02]
mat_Sqrt:  [[ 1.99558573e+01  0.00000000e+00]
 [-8.24944633e-03  1.89018561e-02]]
grads:  [-3.46107622e-02 -5.97865375e+01]
Stock Position:  -0.03461076218374781
Bond Position:  [-1.50431184]


portfolio before change:  [-5.01465051]
curr_Stock_Price:  101.41246030706048
curr_Factors:  [1.01412460e+02 4.20905552e-02]
mat_Sqrt:  [[ 2.08057630e+01  0.00000000e+00]
 [-8.20639314e-03  1.88032089e-02]]
grads:  [0.00838797 0.07689697]
Stock Position:  0.008387970702148346
Bond Position:  [-5.86529526]


portfolio before change:  [-5.00220274]
curr_Stock_Price:  103.07129732377923
curr_Factors:  [1.03071297e+02 4.30317621e-02]
mat_Sqrt:  [[ 2.13812114e+01  0.00000000e+00]
 [-8.29763938e-03  1.90122803e-02]]
grads:  [-0.00801145 -4.14000046]
Stock Position:  -0.008011446584193192
Bond Position:  [-4.17645255]


portfolio before change:  [-4.99900296]
curr_Stock_Price:  102.54155181666675
curr_Factors:  [1.02541552e+02 4.29220469e-02]
mat_Sqrt:  [[ 2.12441861e+01  0.00000000e+00]
 [-8.28705467e-03  1.89880276e-02]]
grads:  [ 1.08747661e-02 -3.79135831e+01]
Stock Position:  0.01087476608710235
Bond Position:  [-6.11411835]


portfolio before change:  [-4.97866672]
curr_Stock_Price:  104.5521663242255
curr_Factors:  [1.04552166e+02 4.08423655e-02]
mat_Sqrt:  [[ 2.11294640e+01  0.00000000e+00]
 [-8.08379767e-03  1.85223074e-02]]
grads:  [-1.80511150e-02  2.83834985e+01]
Stock Position:  -0.018051115039161878
Bond Position:  [-3.09138353]


portfolio before change:  [-5.01463066]
curr_Stock_Price:  106.50168598850253
curr_Factors:  [1.06501686e+02 4.11503806e-02]
mat_Sqrt:  [[ 2.16044598e+01  0.00000000e+00]
 [-8.11422263e-03  1.85920197e-02]]
grads:  [ 0.03816416 10.26835569]
Stock Position:  0.03816416128745011
Bond Position:  [-9.07917818]


portfolio before change:  [-4.92887278]
curr_Stock_Price:  108.80824680360006
curr_Factors:  [1.08808247e+02 3.95201658e-02]
mat_Sqrt:  [[ 2.16307308e+01  0.00000000e+00]
 [-7.95187181e-03  1.82200272e-02]]
grads:  [  0.0121036  -11.58873561]
Stock Position:  0.012103602957511398
Bond Position:  [-6.2458446]


portfolio before change:  [-4.92136176]
curr_Stock_Price:  109.55783160341089
curr_Factors:  [1.09557832e+02 3.97916145e-02]
mat_Sqrt:  [[ 2.18544161e+01  0.00000000e+00]
 [-7.97913424e-03  1.82824933e-02]]
grads:  [-0.00800752  1.88532685]
Stock Position:  -0.00800751807597823
Bond Position:  [-4.04407544]


portfolio before change:  [-4.90842041]
curr_Stock_Price:  107.81540748549867
curr_Factors:  [1.07815407e+02 4.23971557e-02]
mat_Sqrt:  [[ 2.21998065e+01  0.00000000e+00]
 [-8.23622784e-03  1.88715688e-02]]
grads:  [2.40848685e-02 2.58502036e+01]
Stock Position:  0.024084868469227135
Bond Position:  [-7.50514032]


portfolio before change:  [-4.90422586]
curr_Stock_Price:  108.06747761537407
curr_Factors:  [1.08067478e+02 4.45190741e-02]
mat_Sqrt:  [[ 2.28017446e+01  0.00000000e+00]
 [-8.43981745e-03  1.93380512e-02]]
grads:  [-0.00828919  5.91233951]
Stock Position:  -0.008289188713706364
Bond Position:  [-4.00843414]


portfolio before change:  [-4.91732957]
curr_Stock_Price:  109.52738887974822
curr_Factors:  [1.09527389e+02 4.59817059e-02]
mat_Sqrt:  [[ 2.34863362e+01  0.00000000e+00]
 [-8.57733813e-03  1.96531506e-02]]
grads:  [-3.50372080e-03  8.24251175e+00]
Stock Position:  -0.003503720797225741
Bond Position:  [-4.53357618]


portfolio before change:  [-4.91438459]
curr_Stock_Price:  108.36333458354832
curr_Factors:  [1.08363335e+02 4.79586150e-02]
mat_Sqrt:  [[ 2.37309802e+01  0.00000000e+00]
 [-8.75978219e-03  2.00711825e-02]]
grads:  [-0.00923372  0.6842419 ]
Stock Position:  -0.00923371900860125
Bond Position:  [-3.913788]


portfolio before change:  [-4.92966535]
curr_Stock_Price:  109.91224375789452
curr_Factors:  [1.09912244e+02 4.70113132e-02]
mat_Sqrt:  [[ 2.38312743e+01  0.00000000e+00]
 [-8.67283697e-03  1.98719660e-02]]
grads:  [1.75462025e-02 1.80459429e+01]
Stock Position:  0.017546202515932516
Bond Position:  [-6.85820784]


portfolio before change:  [-4.98585862]
curr_Stock_Price:  106.80738382233147
curr_Factors:  [1.06807384e+02 4.62129855e-02]
mat_Sqrt:  [[ 2.29606031e+01  0.00000000e+00]
 [-8.59888230e-03  1.97025145e-02]]
grads:  [0.0041809  0.88978773]
Stock Position:  0.004180897599831902
Bond Position:  [-5.43240935]


portfolio before change:  [-4.99367228]
curr_Stock_Price:  105.26336364294885
curr_Factors:  [1.05263364e+02 4.39383051e-02]
mat_Sqrt:  [[ 2.20647440e+01  0.00000000e+00]
 [-8.38458635e-03  1.92115008e-02]]
grads:  [2.11718888e-04 6.88691823e+00]
Stock Position:  0.0002117188877224496
Bond Position:  [-5.01595852]


portfolio before change:  [-4.99491034]
curr_Stock_Price:  105.33934143188961
curr_Factors:  [1.05339341e+02 4.46169673e-02]
mat_Sqrt:  [[ 2.22505434e+01  0.00000000e+00]
 [-8.44909153e-03  1.93593007e-02]]
grads:  [ 0.00738253 -4.69151522]
Stock Position:  0.00738253114543963
Bond Position:  [-5.77258131]


portfolio before change:  [-4.99850509]
curr_Stock_Price:  105.04792011827341
curr_Factors:  [1.05047920e+02 4.54794953e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.99850509]
Stock Price:  104.0996964875607
PL:  [-9.09820158]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.30395304e-02  9.54748913e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.87098597e-01 -7.37156581e-01]
 [ 1.49052428e-01  3.97613973e-02]
 [-2.43958009e-01 -9.45743008e-02]
 [ 3.79991021e-01 -4.63262402e-01]
 [-5.17416900e-01  2.90398723e-01]
 [ 2.16613387e-01  1.49703938e-01]
 [ 8.12734519e-02 -9.94182063e-02]
 [ 1.22758743e-01  1.75292532e-02]
 [ 2.41398558e-01  3.59520312e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-2.89683280e-02  7.03707943e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 1.27190912e-01 -2.64185836e-02]
 [ 9.02671008e-02  1.24832348e-02]
 [-5.19142509e-02  2.21404607e-02]
 [ 3.09559161e-01 -2.09937120e-01]
 [ 2.15870896e-01  1.00944328e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.88302239]
curr_Stock_Price:  99.89403120569145
curr_Factors:  [9.98940312e+01 3.89095907e-02]
mat_Sqrt:  [[ 1.97046112e+01  0.00000000e+00]
 [-7.89020565e-03  1.80787323e-02]]
grads:  [-0.00349526  0.52810612]
Stock Position:  -0.003495256201193552
Bond Position:  [2.23217762]


portfolio before change:  [1.88054558]
curr_Stock_Price:  100.76232840734444
curr_Factors:  [1.00762328e+02 3.70229695e-02]
mat_Sqrt:  [[ 1.93880361e+01  0.00000000e+00]
 [-7.69654151e-03  1.76349920e-02]]
grads:  [-0.0096103  -3.77952936]
Stock Position:  -0.009610301401111953
Bond Position:  [2.84890193]


portfolio before change:  [1.89509022]
curr_Stock_Price:  99.32300639290729
curr_Factors:  [9.93230064e+01 3.82434921e-02]
mat_Sqrt:  [[ 1.94235509e+01  0.00000000e+00]
 [-7.82237734e-03  1.79233181e-02]]
grads:  [-2.61960394e-02 -4.11283544e+01]
Stock Position:  -0.026196039404347896
Bond Position:  [4.49695961]


portfolio before change:  [1.84894137]
curr_Stock_Price:  101.12760081070863
curr_Factors:  [1.01127601e+02 3.39715117e-02]
mat_Sqrt:  [[ 1.86391945e+01  0.00000000e+00]
 [-7.37254492e-03  1.68926226e-02]]
grads:  [0.00892773 2.3537729 ]
Stock Position:  0.008927731516140978
Bond Position:  [0.9461013]


portfolio before change:  [1.85107472]
curr_Stock_Price:  101.34006227960488
curr_Factors:  [1.01340062e+02 3.28324414e-02]
mat_Sqrt:  [[ 1.83625400e+01  0.00000000e+00]
 [-7.24788978e-03  1.66070018e-02]]
grads:  [-0.01553345 -5.69484498]
Stock Position:  -0.015533451104408433
Bond Position:  [3.42523563]


portfolio before change:  [1.86435888]
curr_Stock_Price:  100.53999908659105
curr_Factors:  [1.00539999e+02 3.27394003e-02]
mat_Sqrt:  [[ 1.81917399e+01  0.00000000e+00]
 [-7.23761290e-03  1.65834545e-02]]
grads:  [ 9.77403667e-03 -2.79352172e+01]
Stock Position:  0.009774036667988035
Bond Position:  [0.88167724]


portfolio before change:  [1.87003812]
curr_Stock_Price:  101.0984984746776
curr_Factors:  [1.01098498e+02 3.06502762e-02]
mat_Sqrt:  [[ 1.76995368e+01  0.00000000e+00]
 [-7.00288811e-03  1.60456324e-02]]
grads:  [-0.0220727  18.09830335]
Stock Position:  -0.02207269658470888
Bond Position:  [4.1015546]


portfolio before change:  [1.86812406]
curr_Stock_Price:  101.23167569207381
curr_Factors:  [1.01231676e+02 2.97804625e-02]
mat_Sqrt:  [[ 1.74695672e+01  0.00000000e+00]
 [-6.90280668e-03  1.58163171e-02]]
grads:  [0.01613947 9.46515788]
Stock Position:  0.01613946921835751
Bond Position:  [0.23429855]


portfolio before change:  [1.91605463]
curr_Stock_Price:  104.19781935872783
curr_Factors:  [1.04197819e+02 3.02396366e-02]
mat_Sqrt:  [[ 1.81195294e+01  0.00000000e+00]
 [-6.95581904e-03  1.59377836e-02]]
grads:  [ 2.09077116e-03 -6.23789408e+00]
Stock Position:  0.0020907711588336268
Bond Position:  [1.69820083]


portfolio before change:  [1.91622287]
curr_Stock_Price:  104.07520500138006
curr_Factors:  [1.04075205e+02 3.00478150e-02]
mat_Sqrt:  [[ 1.80407141e+01  0.00000000e+00]
 [-6.93372224e-03  1.58871535e-02]]
grads:  [0.0072286  1.10336022]
Stock Position:  0.007228601671249075
Bond Position:  [1.16390467]


portfolio before change:  [1.92444881]
curr_Stock_Price:  105.17291730016902
curr_Factors:  [1.05172917e+02 3.05301796e-02]
mat_Sqrt:  [[ 1.83767455e+01  0.00000000e+00]
 [-6.98915498e-03  1.60141659e-02]]
grads:  [2.16744628e-02 2.24501429e+01]
Stock Position:  0.021674462811745496
Bond Position:  [-0.35511768]


portfolio before change:  [1.91730275]
curr_Stock_Price:  104.84731431086772
curr_Factors:  [1.04847314e+02 3.12378542e-02]
mat_Sqrt:  [[ 1.85309595e+01  0.00000000e+00]
 [-7.06969354e-03  1.61987029e-02]]
grads:  [-0.01019958  7.05816538]
Stock Position:  -0.010199577828958428
Bond Position:  [2.98670109]


portfolio before change:  [1.93066782]
curr_Stock_Price:  103.61017455844468
curr_Factors:  [1.03610175e+02 3.10221771e-02]
mat_Sqrt:  [[ 1.82489778e+01  0.00000000e+00]
 [-7.04524545e-03  1.61426853e-02]]
grads:  [9.55672473e-05 4.35929916e+00]
Stock Position:  9.556724725380265e-05
Bond Position:  [1.92076608]


portfolio before change:  [1.93115296]
curr_Stock_Price:  103.66130180843663
curr_Factors:  [1.03661302e+02 2.97786600e-02]
mat_Sqrt:  [[ 1.78883068e+01  0.00000000e+00]
 [-6.90259778e-03  1.58158384e-02]]
grads:  [ -0.02296699 -15.77339002]
Stock Position:  -0.022966991042129143
Bond Position:  [4.31194115]


portfolio before change:  [1.95883225]
curr_Stock_Price:  102.50306684636138
curr_Factors:  [1.02503067e+02 3.10949680e-02]
mat_Sqrt:  [[ 1.80751503e+01  0.00000000e+00]
 [-7.05350614e-03  1.61616129e-02]]
grads:  [ 0.00639889 -1.63465019]
Stock Position:  0.006398889925813322
Bond Position:  [1.30292641]


portfolio before change:  [1.95158473]
curr_Stock_Price:  101.31953462873152
curr_Factors:  [1.01319535e+02 3.37318580e-02]
mat_Sqrt:  [[ 1.86085836e+01  0.00000000e+00]
 [-7.34649392e-03  1.68329322e-02]]
grads:  [0.00514361 0.74159597]
Stock Position:  0.0051436064714971185
Bond Position:  [1.43043691]


portfolio before change:  [1.95817398]
curr_Stock_Price:  102.53105775289295
curr_Factors:  [1.02531058e+02 3.40652377e-02]
mat_Sqrt:  [[ 1.89239220e+01  0.00000000e+00]
 [-7.38270819e-03  1.69159096e-02]]
grads:  [-0.0022327   1.30885429]
Stock Position:  -0.0022326958243079576
Bond Position:  [2.18709465]


portfolio before change:  [1.95721225]
curr_Stock_Price:  103.20672942144509
curr_Factors:  [1.03206729e+02 3.33269474e-02]
mat_Sqrt:  [[ 1.88410796e+01  0.00000000e+00]
 [-7.30226785e-03  1.67315976e-02]]
grads:  [ 1.15670171e-02 -1.25473445e+01]
Stock Position:  0.011567017133417117
Bond Position:  [0.76341825]


portfolio before change:  [1.93500843]
curr_Stock_Price:  101.27064682601791
curr_Factors:  [1.01270647e+02 3.49292907e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.93500843]
Stock Price:  102.93596162564282
PL:  [-1.00095319]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-9.26897083e-02  3.81984301e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.79383641e-01 -6.84518534e-01]
 [ 3.33297228e-02  2.18573496e-01]
 [-4.18381181e-01 -6.18429019e-02]
 [-4.08061138e-02  1.11249455e-01]
 [-5.02115456e-01  2.23748058e-01]
 [ 1.31188479e-01  1.42993886e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.93428954e-01  7.21545337e-03]
 [ 1.45032707e-01  2.08667080e-01]
 [-2.38682766e-01  1.09961561e-01]
 [-1.30680427e-02  5.86243661e-02]
 [-2.69231433e-01 -2.58312022e-01]
 [-3.62929040e-02 -9.72907256e-02]
 [ 9.10377489e-02  5.45040458e-02]
 [-5.20045752e-02 -2.25192913e-02]
 [ 3.68636554e-01 -2.27130450e-01]
 [ 1.68065721e-01  6.07499714e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.19608997]
curr_Stock_Price:  100.08462728488811
curr_Factors:  [1.00084627e+02 4.19801074e-02]
mat_Sqrt:  [[ 2.05063870e+01  0.00000000e+00]
 [-8.19561906e-03  1.87785224e-02]]
grads:  [-0.00370707  2.03415526]
Stock Position:  -0.00370706681317969
Bond Position:  [3.56711037]


portfolio before change:  [3.20201577]
curr_Stock_Price:  98.72670449810198
curr_Factors:  [9.87267045e+01 4.16287637e-02]
mat_Sqrt:  [[ 2.01433360e+01  0.00000000e+00]
 [-8.16125125e-03  1.86997758e-02]]
grads:  [-0.00924995 -3.56431921]
Stock Position:  -0.009249950960343457
Bond Position:  [4.11523294]


portfolio before change:  [3.193709]
curr_Stock_Price:  99.73597549725524
curr_Factors:  [9.97359755e+01 4.03492065e-02]
mat_Sqrt:  [[ 2.00340770e+01  0.00000000e+00]
 [-8.03484477e-03  1.84101422e-02]]
grads:  [-2.38659371e-02 -3.71815996e+01]
Stock Position:  -0.02386593705405837
Bond Position:  [5.57400151]


portfolio before change:  [3.19430616]
curr_Stock_Price:  99.7693498696592
curr_Factors:  [9.97693499e+01 4.12525610e-02]
mat_Sqrt:  [[ 2.02638797e+01  0.00000000e+00]
 [-8.12429059e-03  1.86150883e-02]]
grads:  [6.35233819e-03 1.17417383e+01]
Stock Position:  0.006352338186207243
Bond Position:  [2.56053751]


portfolio before change:  [3.17746061]
curr_Stock_Price:  97.01669995891112
curr_Factors:  [9.70167000e+01 4.12804669e-02]
mat_Sqrt:  [[ 1.97114602e+01  0.00000000e+00]
 [-8.12703803e-03  1.86213835e-02]]
grads:  [-0.02259455 -3.32106914]
Stock Position:  -0.02259455312968732
Bond Position:  [5.3695096]


portfolio before change:  [3.18173424]
curr_Stock_Price:  96.88697486848103
curr_Factors:  [9.68869749e+01 4.25330470e-02]
mat_Sqrt:  [[ 1.99815256e+01  0.00000000e+00]
 [-8.24941666e-03  1.89017881e-02]]
grads:  [3.87714592e-04 5.88565772e+00]
Stock Position:  0.0003877145921735028
Bond Position:  [3.14416975]


portfolio before change:  [3.1837185]
curr_Stock_Price:  99.97718412154822
curr_Factors:  [9.99771841e+01 3.95809461e-02]
mat_Sqrt:  [[ 1.98904215e+01  0.00000000e+00]
 [-7.95798428e-03  1.82340327e-02]]
grads:  [-0.0203346  12.27090362]
Stock Position:  -0.020334601662554824
Bond Position:  [5.21671471]


portfolio before change:  [3.17666043]
curr_Stock_Price:  100.38842470230486
curr_Factors:  [1.00388425e+02 3.91794010e-02]
mat_Sqrt:  [[ 1.98706711e+01  0.00000000e+00]
 [-7.91751486e-03  1.81413056e-02]]
grads:  [0.00974281 7.88222688]
Stock Position:  0.009742807706704402
Bond Position:  [2.19859531]


portfolio before change:  [3.1785026]
curr_Stock_Price:  100.52108192702721
curr_Factors:  [1.00521082e+02 3.70771986e-02]
mat_Sqrt:  [[ 1.93557770e+01  0.00000000e+00]
 [-7.70217617e-03  1.76479027e-02]]
grads:  [-0.01124113 -3.01162763]
Stock Position:  -0.011241133339594011
Bond Position:  [4.30847348]


portfolio before change:  [3.17109838]
curr_Stock_Price:  101.2755851446797
curr_Factors:  [1.01275585e+02 3.84734088e-02]
mat_Sqrt:  [[ 1.98648411e+01  0.00000000e+00]
 [-7.84585585e-03  1.79771142e-02]]
grads:  [0.0149298  0.40136884]
Stock Position:  0.0149297965958636
Bond Position:  [1.65907449]


portfolio before change:  [3.18452686]
curr_Stock_Price:  102.14724216917028
curr_Factors:  [1.02147242e+02 3.66294201e-02]
mat_Sqrt:  [[ 1.95497707e+01  0.00000000e+00]
 [-7.65552560e-03  1.75410128e-02]]
grads:  [ 0.012077   11.89595394]
Stock Position:  0.012076995200133363
Bond Position:  [1.95089511]


portfolio before change:  [3.19147623]
curr_Stock_Price:  102.68227446775717
curr_Factors:  [1.02682274e+02 3.60730133e-02]
mat_Sqrt:  [[ 1.95023385e+01  0.00000000e+00]
 [-7.59715877e-03  1.74072776e-02]]
grads:  [-0.00977788  6.31698784]
Stock Position:  -0.00977788414486917
Bond Position:  [4.19549161]


portfolio before change:  [3.19078903]
curr_Stock_Price:  102.85983930334783
curr_Factors:  [1.02859839e+02 3.58243459e-02]
mat_Sqrt:  [[ 1.94686114e+01  0.00000000e+00]
 [-7.57092818e-03  1.73471757e-02]]
grads:  [6.42969757e-04 3.37947612e+00]
Stock Position:  0.0006429697565429859
Bond Position:  [3.12465326]


portfolio before change:  [3.19112724]
curr_Stock_Price:  102.17076804124181
curr_Factors:  [1.02170768e+02 3.71079484e-02]
mat_Sqrt:  [[ 1.96815877e+01  0.00000000e+00]
 [-7.70536939e-03  1.76552192e-02]]
grads:  [ -0.01940738 -14.63091556]
Stock Position:  -0.0194073795035918
Bond Position:  [5.1739941]


portfolio before change:  [3.22506971]
curr_Stock_Price:  100.48847937488314
curr_Factors:  [1.00488479e+02 3.80889614e-02]
mat_Sqrt:  [[ 1.96117270e+01  0.00000000e+00]
 [-7.80655739e-03  1.78870701e-02]]
grads:  [-4.01566153e-03 -5.43916500e+00]
Stock Position:  -0.00401566153049707
Bond Position:  [3.62859743]


portfolio before change:  [3.23150426]
curr_Stock_Price:  99.11204756102508
curr_Factors:  [9.91120476e+01 4.02901430e-02]
mat_Sqrt:  [[ 1.98941713e+01  0.00000000e+00]
 [-8.02896188e-03  1.83966628e-02]]
grads:  [0.0057718  2.96271375]
Stock Position:  0.005771804363980994
Bond Position:  [2.65944891]


portfolio before change:  [3.24553424]
curr_Stock_Price:  101.4276212553935
curr_Factors:  [1.01427621e+02 3.97620000e-02]
mat_Sqrt:  [[ 2.02250848e+01  0.00000000e+00]
 [-7.97616450e-03  1.82756888e-02]]
grads:  [-0.00305723 -1.23219932]
Stock Position:  -0.0030572331493564776
Bond Position:  [3.55562213]


portfolio before change:  [3.24392402]
curr_Stock_Price:  102.24510416374022
curr_Factors:  [1.02245104e+02 3.71035645e-02]
mat_Sqrt:  [[ 1.96947439e+01  0.00000000e+00]
 [-7.70491422e-03  1.76541763e-02]]
grads:  [  0.0136843  -12.86553653]
Stock Position:  0.013684295633245917
Bond Position:  [1.84477179]


portfolio before change:  [3.25213019]
curr_Stock_Price:  102.81107523356123
curr_Factors:  [1.02811075e+02 3.79001479e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.25213019]
Stock Price:  102.27697108884706
PL:  [0.9751591]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.42882003e-02  1.19395616e-01]
 [-1.36293242e-02 -2.70760406e-02]
 [-1.72120855e-01 -6.34965579e-01]
 [-1.79384151e-02  2.75970853e-01]
 [-4.25210134e-01 -1.18995456e-01]
 [ 2.57872243e-01 -2.85409817e-01]
 [-4.93344597e-01  1.89797025e-01]
 [ 3.02274529e-01  1.56432546e-01]
 [-6.32033400e-02 -3.43806654e-02]
 [ 6.49332985e-02  2.06653588e-02]
 [ 2.57665022e-01  3.85489434e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.42843084e-01  1.54496433e-01]
 [-2.19960698e-01  3.14015482e-02]
 [ 2.38561001e-01  2.66237289e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.27172757e-02  1.01546577e-01]
 [ 3.44756717e-01 -2.20188788e-01]
 [ 1.60840468e-01  5.45588659e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.84099233]
curr_Stock_Price:  100.6136968541187
curr_Factors:  [1.00613697e+02 4.02718808e-02]
mat_Sqrt:  [[ 2.01910109e+01  0.00000000e+00]
 [-8.02714203e-03  1.83924930e-02]]
grads:  [-1.09849287e-03  6.49154066e+00]
Stock Position:  -0.0010984928655827508
Bond Position:  [6.95151576]


portfolio before change:  [6.84131083]
curr_Stock_Price:  101.90600871127594
curr_Factors:  [1.01906009e+02 4.07259579e-02]
mat_Sqrt:  [[ 2.05653188e+01  0.00000000e+00]
 [-8.07226936e-03  1.84958927e-02]]
grads:  [-1.23733930e-03 -1.46389477e+00]
Stock Position:  -0.0012373392963469325
Bond Position:  [6.96740314]


portfolio before change:  [6.8452321]
curr_Stock_Price:  100.14480434665985
curr_Factors:  [1.00144804e+02 4.23602053e-02]
mat_Sqrt:  [[ 2.06113980e+01  0.00000000e+00]
 [-8.23263800e-03  1.88633434e-02]]
grads:  [-2.17958312e-02 -3.36613487e+01]
Stock Position:  -0.02179583121087314
Bond Position:  [9.02797136]


portfolio before change:  [6.87176588]
curr_Stock_Price:  99.03099061740502
curr_Factors:  [9.90309906e+01 4.43490723e-02]
mat_Sqrt:  [[ 2.08551536e+01  0.00000000e+00]
 [-8.42368777e-03  1.93010934e-02]]
grads:  [4.91509875e-03 1.42981979e+01]
Stock Position:  0.00491509874530722
Bond Position:  [6.38501878]


portfolio before change:  [6.87579976]
curr_Stock_Price:  99.52689711282599
curr_Factors:  [9.95268971e+01 4.49366912e-02]
mat_Sqrt:  [[ 2.10979865e+01  0.00000000e+00]
 [-8.47931046e-03  1.94285410e-02]]
grads:  [-0.02261562 -6.12477571]
Stock Position:  -0.02261561826508397
Bond Position:  [9.12666207]


portfolio before change:  [6.88491401]
curr_Stock_Price:  99.2247917955238
curr_Factors:  [9.92247918e+01 4.56416637e-02]
mat_Sqrt:  [[ 2.11982949e+01  0.00000000e+00]
 [-8.54556388e-03  1.95803467e-02]]
grads:  [ 6.28867500e-03 -1.45763413e+01]
Stock Position:  0.006288675002374106
Bond Position:  [6.26092154]


portfolio before change:  [6.88742276]
curr_Stock_Price:  99.3747958057674
curr_Factors:  [9.93747958e+01 4.54781934e-02]
mat_Sqrt:  [[ 2.11922882e+01  0.00000000e+00]
 [-8.53024674e-03  1.95452507e-02]]
grads:  [-0.01937074  9.71064672]
Stock Position:  -0.01937074375500543
Bond Position:  [8.81238647]


portfolio before change:  [6.83666465]
curr_Stock_Price:  102.1088923308578
curr_Factors:  [1.02108892e+02 4.41838790e-02]
mat_Sqrt:  [[ 2.14632501e+01  0.00000000e+00]
 [-8.40798468e-03  1.92651131e-02]]
grads:  [0.01726427 8.11999103]
Stock Position:  0.01726426744611571
Bond Position:  [5.07382942]


portfolio before change:  [6.84880138]
curr_Stock_Price:  102.73840706501093
curr_Factors:  [1.02738407e+02 4.49165673e-02]
mat_Sqrt:  [[ 2.17738941e+01  0.00000000e+00]
 [-8.47741161e-03  1.94241902e-02]]
grads:  [-0.00359184 -1.76999221]
Stock Position:  -0.0035918376416007106
Bond Position:  [7.21782105]


portfolio before change:  [6.84213401]
curr_Stock_Price:  105.09710097273934
curr_Factors:  [1.05097101e+02 4.52169298e-02]
mat_Sqrt:  [[ 2.23481343e+01  0.00000000e+00]
 [-8.50570912e-03  1.94890279e-02]]
grads:  [0.00330911 1.06035862]
Stock Position:  0.0033091084762987017
Bond Position:  [6.4943563]


portfolio before change:  [6.8460294]
curr_Stock_Price:  105.7835689091836
curr_Factors:  [1.05783569e+02 4.57685932e-02]
mat_Sqrt:  [[ 2.26309089e+01  0.00000000e+00]
 [-8.55743823e-03  1.96075542e-02]]
grads:  [1.88196773e-02 1.96602508e+01]
Stock Position:  0.018819677343731196
Bond Position:  [4.85521677]


portfolio before change:  [6.88523189]
curr_Stock_Price:  107.80212304984735
curr_Factors:  [1.07802123e+02 4.40191153e-02]
mat_Sqrt:  [[ 2.26176755e+01  0.00000000e+00]
 [-8.39229316e-03  1.92291593e-02]]
grads:  [-0.00835665  5.9458202 ]
Stock Position:  -0.008356648493025642
Bond Position:  [7.78609634]


portfolio before change:  [6.87683944]
curr_Stock_Price:  109.03936833216244
curr_Factors:  [1.09039368e+02 4.15410901e-02]
mat_Sqrt:  [[ 2.22240022e+01  0.00000000e+00]
 [-8.15265259e-03  1.86800738e-02]]
grads:  [-3.39341729e-03  8.27065430e+00]
Stock Position:  -0.003393417288186594
Bond Position:  [7.24685551]


portfolio before change:  [6.88006306]
curr_Stock_Price:  108.62336129968092
curr_Factors:  [1.08623361e+02 4.11598272e-02]
mat_Sqrt:  [[ 2.20373825e+01  0.00000000e+00]
 [-8.11515394e-03  1.85941536e-02]]
grads:  [-0.00935937  1.6887861 ]
Stock Position:  -0.009359366482668554
Bond Position:  [7.89670891]


portfolio before change:  [6.88653061]
curr_Stock_Price:  108.1432946028449
curr_Factors:  [1.08143295e+02 4.06509266e-02]
mat_Sqrt:  [[ 2.18039321e+01  0.00000000e+00]
 [-8.06482997e-03  1.84788469e-02]]
grads:  [ 0.0162703  14.40767871]
Stock Position:  0.016270298325707186
Bond Position:  [5.12700694]


portfolio before change:  [6.84877304]
curr_Stock_Price:  105.74386220523483
curr_Factors:  [1.05743862e+02 4.17974160e-02]
mat_Sqrt:  [[ 2.16187155e+01  0.00000000e+00]
 [-8.17776654e-03  1.87376171e-02]]
grads:  [0.00444041 0.93560754]
Stock Position:  0.004440408607625956
Bond Position:  [6.37922708]


portfolio before change:  [6.84484568]
curr_Stock_Price:  104.50020002960609
curr_Factors:  [1.04500200e+02 4.06311209e-02]
mat_Sqrt:  [[ 2.10642754e+01  0.00000000e+00]
 [-8.06286509e-03  1.84743448e-02]]
grads:  [-3.98718497e-04  5.49662669e+00]
Stock Position:  -0.0003987184967325677
Bond Position:  [6.88651184]


portfolio before change:  [6.84731777]
curr_Stock_Price:  102.61853683294015
curr_Factors:  [1.02618537e+02 4.06244656e-02]
mat_Sqrt:  [[ 2.06832913e+01  0.00000000e+00]
 [-8.06220472e-03  1.84728317e-02]]
grads:  [  0.01202219 -11.91960126]
Stock Position:  0.012022189667643072
Bond Position:  [5.61361826]


portfolio before change:  [6.8539531]
curr_Stock_Price:  103.05371135768347
curr_Factors:  [1.03053711e+02 3.97041830e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.8539531]
Stock Price:  105.67285752364442
PL:  [1.18109558]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.97319800e-01 -8.06894394e-01]
 [-2.67132306e-02  2.76831442e-01]
 [-4.15498427e-01 -6.25728267e-02]
 [-4.00404014e-02  1.09767934e-01]
 [-2.57320267e-01  8.39889277e-02]
 [ 2.00539692e-02  1.59092576e-01]
 [-2.09663798e-01  6.38153632e-03]
 [ 1.78262420e-01  9.59764073e-03]
 [ 2.80584701e-03  8.10668523e-02]
 [-2.36159059e-01  6.07670395e-02]
 [-5.51247402e-02  3.55442558e-02]
 [-1.64842098e-01 -2.50414757e-01]
 [-9.68265393e-02 -1.23458511e-01]
 [ 9.95118617e-02  4.61178702e-02]
 [-2.89187275e-03 -5.39640862e-02]
 [ 6.40274950e-01 -3.12447057e-01]
 [ 1.63303329e-01  1.47682894e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.82808076]
curr_Stock_Price:  97.46835960265322
curr_Factors:  [9.74683596e+01 3.93929542e-02]
mat_Sqrt:  [[ 1.93451870e+01  0.00000000e+00]
 [-7.93906334e-03  1.81906794e-02]]
grads:  [ 0.00144075 -0.07425969]
Stock Position:  0.0014407499695427467
Bond Position:  [-14.9685083]


portfolio before change:  [-14.82692383]
curr_Stock_Price:  100.86903613228569
curr_Factors:  [1.00869036e+02 3.62654436e-02]
mat_Sqrt:  [[ 1.92089828e+01  0.00000000e+00]
 [-7.61739520e-03  1.74536451e-02]]
grads:  [-0.00969988 -3.81879945]
Stock Position:  -0.009699882192274505
Bond Position:  [-13.84850606]


portfolio before change:  [-14.81018714]
curr_Stock_Price:  98.78661414079406
curr_Factors:  [9.87866141e+01 3.75372761e-02]
mat_Sqrt:  [[ 1.91394511e+01  0.00000000e+00]
 [-7.74981560e-03  1.77570583e-02]]
grads:  [-2.87091506e-02 -4.54407695e+01]
Stock Position:  -0.028709150641251492
Bond Position:  [-11.97410736]


portfolio before change:  [-14.76793253]
curr_Stock_Price:  97.21051323870631
curr_Factors:  [9.72105132e+01 3.51715327e-02]
mat_Sqrt:  [[ 1.82309325e+01  0.00000000e+00]
 [-7.50162997e-03  1.71883936e-02]]
grads:  [5.16188164e-03 1.61057193e+01]
Stock Position:  0.005161881642503729
Bond Position:  [-15.26972169]


portfolio before change:  [-14.77223405]
curr_Stock_Price:  97.11682334058064
curr_Factors:  [9.71168233e+01 3.67286804e-02]
mat_Sqrt:  [[ 1.86121752e+01  0.00000000e+00]
 [-7.66589125e-03  1.75647635e-02]]
grads:  [-0.02379128 -3.56240645]
Stock Position:  -0.023791278763201033
Bond Position:  [-12.46170063]


portfolio before change:  [-14.77209814]
curr_Stock_Price:  96.98014618345334
curr_Factors:  [9.69801462e+01 3.65669019e-02]
mat_Sqrt:  [[ 1.85450034e+01  0.00000000e+00]
 [-7.64898967e-03  1.75260371e-02]]
grads:  [4.24171001e-04 6.26313488e+00]
Stock Position:  0.0004241710005814304
Bond Position:  [-14.81323431]


portfolio before change:  [-14.77649481]
curr_Stock_Price:  95.34661141765662
curr_Factors:  [9.53466114e+01 3.76532822e-02]
mat_Sqrt:  [[ 1.85014890e+01  0.00000000e+00]
 [-7.76178146e-03  1.77844755e-02]]
grads:  [-0.01192685  4.72259795]
Stock Position:  -0.011926850532675719
Bond Position:  [-13.63931003]


portfolio before change:  [-14.7993122]
curr_Stock_Price:  96.97379152500109
curr_Factors:  [9.69737915e+01 3.72290774e-02]
mat_Sqrt:  [[ 1.87109360e+01  0.00000000e+00]
 [-7.71793520e-03  1.76840111e-02]]
grads:  [4.78263953e-03 8.99640784e+00]
Stock Position:  0.004782639525036763
Bond Position:  [-15.26310289]


portfolio before change:  [-14.80105188]
curr_Stock_Price:  97.40798078251261
curr_Factors:  [9.74079808e+01 3.79809170e-02]
mat_Sqrt:  [[ 1.89835427e+01  0.00000000e+00]
 [-7.79547736e-03  1.78616825e-02]]
grads:  [-0.01089779  0.35727521]
Stock Position:  -0.010897790297455705
Bond Position:  [-13.73952013]


portfolio before change:  [-14.78796096]
curr_Stock_Price:  95.89150574538705
curr_Factors:  [9.58915057e+01 3.80443343e-02]
mat_Sqrt:  [[ 1.87035969e+01  0.00000000e+00]
 [-7.80198276e-03  1.78765883e-02]]
grads:  [0.00975487 0.53688325]
Stock Position:  0.009754870968395416
Bond Position:  [-15.72337023]


portfolio before change:  [-14.7645526]
curr_Stock_Price:  98.69417717530057
curr_Factors:  [9.86941772e+01 3.78639660e-02]
mat_Sqrt:  [[ 1.92045697e+01  0.00000000e+00]
 [-7.78346617e-03  1.78341614e-02]]
grads:  [1.98839768e-03 4.54559372e+00]
Stock Position:  0.001988397684811703
Bond Position:  [-14.96079587]


portfolio before change:  [-14.76708068]
curr_Stock_Price:  99.30400903812678
curr_Factors:  [9.93040090e+01 3.86186784e-02]
mat_Sqrt:  [[ 1.95148621e+01  0.00000000e+00]
 [-7.86065427e-03  1.80110216e-02]]
grads:  [-0.01074249  3.37388078]
Stock Position:  -0.01074248684955776
Bond Position:  [-13.70030866]


portfolio before change:  [-14.76914406]
curr_Stock_Price:  99.17721121415619
curr_Factors:  [9.91772112e+01 4.00983603e-02]
mat_Sqrt:  [[ 1.98598150e+01  0.00000000e+00]
 [-8.00982999e-03  1.83528261e-02]]
grads:  [-0.00199458  1.93671839]
Stock Position:  -0.0019945782527007005
Bond Position:  [-14.57132735]


portfolio before change:  [-14.77172479]
curr_Stock_Price:  98.64448758703725
curr_Factors:  [9.86444876e+01 4.05170310e-02]
mat_Sqrt:  [[ 1.98559938e+01  0.00000000e+00]
 [-8.05153710e-03  1.84483891e-02]]
grads:  [ -0.01380601 -13.5738007 ]
Stock Position:  -0.013806010477108933
Bond Position:  [-13.40983796]


portfolio before change:  [-14.7778787]
curr_Stock_Price:  98.8473726700918
curr_Factors:  [9.88473727e+01 4.15069179e-02]
mat_Sqrt:  [[ 2.01384190e+01  0.00000000e+00]
 [-8.14929866e-03  1.86723890e-02]]
grads:  [-0.00748362 -6.61182193]
Stock Position:  -0.0074836187777753155
Bond Position:  [-14.03814264]


portfolio before change:  [-14.79267169]
curr_Stock_Price:  100.35506751440965
curr_Factors:  [1.00355068e+02 4.06386585e-02]
mat_Sqrt:  [[ 2.02306105e+01  0.00000000e+00]
 [-8.06361293e-03  1.84760583e-02]]
grads:  [0.00591378 2.49608815]
Stock Position:  0.005913778542843438
Bond Position:  [-15.38614933]


portfolio before change:  [-14.80391933]
curr_Stock_Price:  99.10364721039859
curr_Factors:  [9.91036472e+01 4.16192508e-02]
mat_Sqrt:  [[ 2.02179336e+01  0.00000000e+00]
 [-8.16031870e-03  1.86976391e-02]]
grads:  [-1.30793440e-03 -2.88614439e+00]
Stock Position:  -0.0013079343959965615
Bond Position:  [-14.67429826]


portfolio before change:  [-14.80632763]
curr_Stock_Price:  98.13973859201674
curr_Factors:  [9.81397386e+01 4.12933165e-02]
mat_Sqrt:  [[ 1.99427378e+01  0.00000000e+00]
 [-8.12830280e-03  1.86242814e-02]]
grads:  [  0.02526794 -16.77632819]
Stock Position:  0.025267938650385888
Bond Position:  [-17.28611652]


portfolio before change:  [-14.85215608]
curr_Stock_Price:  96.49708857029067
curr_Factors:  [9.64970886e+01 4.20678012e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.85215608]
Stock Price:  95.57388102134777
PL:  [-14.85215608]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.60926293e-01 -5.58586682e-01]
 [ 1.27104522e-01  7.36893534e-02]
 [-3.65099239e-01 -1.09369439e-01]
 [ 4.14259931e-01 -5.16711920e-01]
 [-3.96193690e-01  1.55021932e-01]
 [ 2.63332368e-02  1.51167066e-01]
 [-2.02576355e-01 -2.12327235e-02]
 [ 2.46618172e-01  5.31432471e-03]
 [ 8.56113321e-02  1.57192012e-01]
 [-2.37016532e-01  7.74817153e-02]
 [-2.20097351e-02  3.79713136e-02]
 [-2.67890878e-01 -2.60855632e-01]
 [-1.42428388e-02 -8.80517941e-02]
 [ 1.00065885e-01  4.57603743e-02]
 [-5.19662276e-02  4.78364815e-03]
 [ 4.24480957e-01 -2.43376041e-01]
 [ 2.23165610e-01  1.22628840e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.33150455]
curr_Stock_Price:  98.70166559418202
curr_Factors:  [9.87016656e+01 3.84378826e-02]
mat_Sqrt:  [[ 1.93510355e+01  0.00000000e+00]
 [-7.84223260e-03  1.79688123e-02]]
grads:  [ 0.00144031 -0.0751766 ]
Stock Position:  0.001440314530916638
Bond Position:  [-6.47366599]


portfolio before change:  [-6.33205101]
curr_Stock_Price:  99.44605777058577
curr_Factors:  [9.94460578e+01 3.93837601e-02]
mat_Sqrt:  [[ 1.97354103e+01  0.00000000e+00]
 [-7.93813682e-03  1.81885564e-02]]
grads:  [-0.00944114 -3.66450028]
Stock Position:  -0.009441144982137781
Bond Position:  [-5.39316636]


portfolio before change:  [-6.34580919]
curr_Stock_Price:  100.7604874032776
curr_Factors:  [1.00760487e+02 3.93290837e-02]
mat_Sqrt:  [[ 1.99823782e+01  0.00000000e+00]
 [-7.93262465e-03  1.81759265e-02]]
grads:  [-2.02535206e-02 -3.07322261e+01]
Stock Position:  -0.02025352059358348
Bond Position:  [-4.30505458]


portfolio before change:  [-6.34907011]
curr_Stock_Price:  100.8683461309005
curr_Factors:  [1.00868346e+02 3.77620112e-02]
mat_Sqrt:  [[ 1.96011909e+01  0.00000000e+00]
 [-7.77297999e-03  1.78101346e-02]]
grads:  [0.00812528 4.13749559]
Stock Position:  0.008125281412742958
Bond Position:  [-7.1686538]


portfolio before change:  [-6.35643871]
curr_Stock_Price:  100.18206659211316
curr_Factors:  [1.00182067e+02 3.61777882e-02]
mat_Sqrt:  [[ 1.90550895e+01  0.00000000e+00]
 [-7.60818382e-03  1.74325391e-02]]
grads:  [-0.02166518 -6.27386738]
Stock Position:  -0.02166518168180194
Bond Position:  [-4.18597603]


portfolio before change:  [-6.37493864]
curr_Stock_Price:  100.98765897205494
curr_Factors:  [1.00987659e+02 3.60877093e-02]
mat_Sqrt:  [[ 1.91843886e+01  0.00000000e+00]
 [-7.59870613e-03  1.74108230e-02]]
grads:  [ 9.83864357e-03 -2.96776275e+01]
Stock Position:  0.009838643570289787
Bond Position:  [-7.36852022]


portfolio before change:  [-6.40248223]
curr_Stock_Price:  98.3753854193936
curr_Factors:  [9.83753854e+01 3.86578137e-02]
mat_Sqrt:  [[ 1.93421653e+01  0.00000000e+00]
 [-7.86463616e-03  1.80201453e-02]]
grads:  [-0.01698551  8.60270159]
Stock Position:  -0.016985511485594993
Bond Position:  [-4.73152599]


portfolio before change:  [-6.4058558]
curr_Stock_Price:  98.50435095307073
curr_Factors:  [9.85043510e+01 3.80682002e-02]
mat_Sqrt:  [[ 1.92192566e+01  0.00000000e+00]
 [-7.80442953e-03  1.78821945e-02]]
grads:  [4.80288884e-03 8.45349634e+00]
Stock Position:  0.004802888843289684
Bond Position:  [-6.87896125]


portfolio before change:  [-6.40918184]
curr_Stock_Price:  98.16995226992888
curr_Factors:  [9.81699523e+01 3.70543912e-02]
mat_Sqrt:  [[ 1.88972418e+01  0.00000000e+00]
 [-7.69980688e-03  1.76424739e-02]]
grads:  [-0.01121026 -1.20350035]
Stock Position:  -0.011210264289149754
Bond Position:  [-5.30867073]


portfolio before change:  [-6.4158454]
curr_Stock_Price:  98.64596544266531
curr_Factors:  [9.86459654e+01 3.71015457e-02]
mat_Sqrt:  [[ 1.90009506e+01  0.00000000e+00]
 [-7.70470461e-03  1.76536960e-02]]
grads:  [0.01310132 0.30103185]
Stock Position:  0.013101319963382946
Bond Position:  [-7.70823776]


portfolio before change:  [-6.3974433]
curr_Stock_Price:  100.19767173730507
curr_Factors:  [1.00197672e+02 3.60480007e-02]
mat_Sqrt:  [[ 1.90238416e+01  0.00000000e+00]
 [-7.59452442e-03  1.74012415e-02]]
grads:  [8.10643579e-03 9.03337915e+00]
Stock Position:  0.008106435790364873
Bond Position:  [-7.2096893]


portfolio before change:  [-6.39718633]
curr_Stock_Price:  100.45174435037977
curr_Factors:  [1.00451744e+02 3.79299518e-02]
mat_Sqrt:  [[ 1.95635934e+01  0.00000000e+00]
 [-7.79024537e-03  1.78496945e-02]]
grads:  [-0.01038668  4.34078662]
Stock Position:  -0.01038667767729208
Bond Position:  [-5.35382644]


portfolio before change:  [-6.39536749]
curr_Stock_Price:  100.1477530427112
curr_Factors:  [1.00147753e+02 3.77877172e-02]
mat_Sqrt:  [[ 1.94677848e+01  0.00000000e+00]
 [-7.77562521e-03  1.78161956e-02]]
grads:  [-2.79317613e-04  2.13128069e+00]
Stock Position:  -0.0002793176128890623
Bond Position:  [-6.36739446]


portfolio before change:  [-6.39747653]
curr_Stock_Price:  101.99866847590083
curr_Factors:  [1.01998668e+02 3.85344906e-02]
mat_Sqrt:  [[ 2.00225466e+01  0.00000000e+00]
 [-7.85208157e-03  1.79913791e-02]]
grads:  [ -0.01906539 -14.49892367]
Stock Position:  -0.01906538748511973
Bond Position:  [-4.4528324]


portfolio before change:  [-6.37681227]
curr_Stock_Price:  100.8564092303385
curr_Factors:  [1.00856409e+02 3.89328426e-02]
mat_Sqrt:  [[ 1.99003887e+01  0.00000000e+00]
 [-7.89256284e-03  1.80841333e-02]]
grads:  [-2.64677204e-03 -4.86900824e+00]
Stock Position:  -0.002646772037286254
Bond Position:  [-6.10986834]


portfolio before change:  [-6.37720976]
curr_Stock_Price:  100.4294112581046
curr_Factors:  [1.00429411e+02 3.80727988e-02]
mat_Sqrt:  [[ 1.95960401e+01  0.00000000e+00]
 [-7.80490090e-03  1.78832746e-02]]
grads:  [0.00612559 2.55883642]
Stock Position:  0.00612559216327822
Bond Position:  [-6.99239937]


portfolio before change:  [-6.36871041]
curr_Stock_Price:  102.10233826654564
curr_Factors:  [1.02102338e+02 3.65715779e-02]
mat_Sqrt:  [[ 1.95257416e+01  0.00000000e+00]
 [-7.64947871e-03  1.75271576e-02]]
grads:  [-0.0025545   0.27292778]
Stock Position:  -0.0025544982356252564
Bond Position:  [-6.10789016]


portfolio before change:  [-6.36831316]
curr_Stock_Price:  101.34899671391447
curr_Factors:  [1.01348997e+02 3.64112912e-02]
mat_Sqrt:  [[ 1.93391550e+01  0.00000000e+00]
 [-7.63269716e-03  1.74887063e-02]]
grads:  [  0.01645692 -13.91618323]
Stock Position:  0.01645692091294874
Bond Position:  [-8.03620558]


portfolio before change:  [-6.38567382]
curr_Stock_Price:  100.4161760083383
curr_Factors:  [1.00416176e+02 3.66102848e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.38567382]
Stock Price:  101.09022903112674
PL:  [-7.47590285]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.08306498e-01  6.82743715e-02]
 [-1.23681846e-01 -5.61252819e-02]
 [-1.16615096e-01 -2.56257692e-01]
 [ 2.51430587e-01 -1.26557058e-01]
 [-1.02199904e-01 -7.30739509e-02]
 [ 4.75844422e-01 -6.12535519e-01]
 [-5.31312003e-01  3.10143436e-01]
 [ 8.74794576e-02  1.39560581e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.54951154e-01  9.97448121e-03]
 [ 1.58791131e-01  2.27639019e-01]
 [-2.37329324e-01  8.35789592e-02]
 [-1.97263852e-02  3.81386644e-02]
 [-1.84692633e-01 -2.59325028e-01]
 [-8.41574458e-02 -1.17381910e-01]
 [ 9.40645307e-02  5.16884790e-02]
 [-3.06626366e-02 -4.02241853e-02]
 [ 5.00414584e-01 -2.65466062e-01]
 [ 2.26876856e-01  1.13022251e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.4016819]
curr_Stock_Price:  100.25962292064972
curr_Factors:  [1.00259623e+02 3.89771201e-02]
mat_Sqrt:  [[ 1.97938803e+01  0.00000000e+00]
 [-7.89704958e-03  1.80944137e-02]]
grads:  [-0.00396633  3.77322927]
Stock Position:  -0.003966332947809846
Bond Position:  [4.79934495]


portfolio before change:  [4.39856254]
curr_Stock_Price:  101.34862604178292
curr_Factors:  [1.01348626e+02 3.82965115e-02]
mat_Sqrt:  [[ 1.98334138e+01  0.00000000e+00]
 [-7.82779780e-03  1.79357380e-02]]
grads:  [-0.00747108 -3.12924296]
Stock Position:  -0.007471075236586378
Bond Position:  [5.15574575]


portfolio before change:  [4.3855829]
curr_Stock_Price:  103.25848981414248
curr_Factors:  [1.03258490e+02 3.81287121e-02]
mat_Sqrt:  [[ 2.01628462e+01  0.00000000e+00]
 [-7.81062989e-03  1.78964014e-02]]
grads:  [-1.13304997e-02 -1.43189509e+01]
Stock Position:  -0.011330499680191576
Bond Position:  [5.55555319]


portfolio before change:  [4.3908055]
curr_Stock_Price:  102.92015234555139
curr_Factors:  [1.02920152e+02 3.73312331e-02]
mat_Sqrt:  [[ 1.98855033e+01  0.00000000e+00]
 [-7.72851686e-03  1.77082568e-02]]
grads:  [ 0.00986631 -7.14678243]
Stock Position:  0.009866310934057862
Bond Position:  [3.37536327]


portfolio before change:  [4.4003357]
curr_Stock_Price:  103.80054781143488
curr_Factors:  [1.03800548e+02 3.61653413e-02]
mat_Sqrt:  [[ 1.97399446e+01  0.00000000e+00]
 [-7.60687492e-03  1.74295401e-02]]
grads:  [-0.00679293 -4.19253466]
Stock Position:  -0.006792926375097004
Bond Position:  [5.10544518]


portfolio before change:  [4.41536594]
curr_Stock_Price:  101.7758357621587
curr_Factors:  [1.01775836e+02 3.65676662e-02]
mat_Sqrt:  [[ 1.94622613e+01  0.00000000e+00]
 [-7.64906961e-03  1.75262203e-02]]
grads:  [ 1.07136577e-02 -3.49496645e+01]
Stock Position:  0.010713657652065797
Bond Position:  [3.32497448]


portfolio before change:  [4.41149061]
curr_Stock_Price:  101.33652038088817
curr_Factors:  [1.01336520e+02 3.64703365e-02]
mat_Sqrt:  [[ 1.93524464e+01  0.00000000e+00]
 [-7.63888332e-03  1.75028805e-02]]
grads:  [-0.02046017 17.7195654 ]
Stock Position:  -0.020460168323720888
Bond Position:  [6.48485288]


portfolio before change:  [4.44151192]
curr_Stock_Price:  99.94846256707329
curr_Factors:  [9.99484626e+01 3.75863788e-02]
mat_Sqrt:  [[ 1.93772152e+01  0.00000000e+00]
 [-7.75488273e-03  1.77686686e-02]]
grads:  [7.65789550e-03 7.85430718e+00]
Stock Position:  0.007657895497967359
Bond Position:  [3.67611704]


portfolio before change:  [4.44798993]
curr_Stock_Price:  100.67436222741624
curr_Factors:  [1.00674362e+02 3.60879672e-02]
mat_Sqrt:  [[ 1.91249407e+01  0.00000000e+00]
 [-7.59873328e-03  1.74108852e-02]]
grads:  [-0.01137681 -3.05262544]
Stock Position:  -0.011376812835606548
Bond Position:  [5.59334331]


portfolio before change:  [4.43600211]
curr_Stock_Price:  101.85099499399705
curr_Factors:  [1.01850995e+02 3.51595036e-02]
mat_Sqrt:  [[ 1.90979452e+01  0.00000000e+00]
 [-7.50034704e-03  1.71854540e-02]]
grads:  [0.01357761 0.58040254]
Stock Position:  0.013577605961606908
Bond Position:  [3.05310944]


portfolio before change:  [4.44638617]
curr_Stock_Price:  102.55956473702011
curr_Factors:  [1.02559565e+02 3.57004019e-02]
mat_Sqrt:  [[ 1.93781682e+01  0.00000000e+00]
 [-7.55781999e-03  1.73171411e-02]]
grads:  [ 0.01332123 13.14530022]
Stock Position:  0.013321225264667494
Bond Position:  [3.0801671]


portfolio before change:  [4.42466465]
curr_Stock_Price:  100.87115714654409
curr_Factors:  [1.00871157e+02 3.61996555e-02]
mat_Sqrt:  [[ 1.91919552e+01  0.00000000e+00]
 [-7.61048282e-03  1.74378068e-02]]
grads:  [-0.01046545  4.79297426]
Stock Position:  -0.010465451452662474
Bond Position:  [5.48032684]


portfolio before change:  [4.43296862]
curr_Stock_Price:  100.20862272548968
curr_Factors:  [1.00208623e+02 3.56448156e-02]
mat_Sqrt:  [[ 1.89192223e+01  0.00000000e+00]
 [-7.55193385e-03  1.73036543e-02]]
grads:  [-1.62866498e-04  2.20408151e+00]
Stock Position:  -0.00016286649754884607
Bond Position:  [4.44928925]


portfolio before change:  [4.43427808]
curr_Stock_Price:  98.99904005320566
curr_Factors:  [9.89990401e+01 3.69683732e-02]
mat_Sqrt:  [[ 1.90347051e+01  0.00000000e+00]
 [-7.69086453e-03  1.76219844e-02]]
grads:  [ -0.01564886 -14.7159946 ]
Stock Position:  -0.01564885571097512
Bond Position:  [5.98349978]


portfolio before change:  [4.42533553]
curr_Stock_Price:  99.66609283412262
curr_Factors:  [9.96660928e+01 3.86365870e-02]
mat_Sqrt:  [[ 1.95905582e+01  0.00000000e+00]
 [-7.86247666e-03  1.80151972e-02]]
grads:  [-0.00691083 -6.51571606]
Stock Position:  -0.006910834787208832
Bond Position:  [5.11411143]


portfolio before change:  [4.42741994]
curr_Stock_Price:  99.54950453346122
curr_Factors:  [9.95495045e+01 3.79748635e-02]
mat_Sqrt:  [[ 1.93993516e+01  0.00000000e+00]
 [-7.79485610e-03  1.78602591e-02]]
grads:  [0.00601171 2.89404979]
Stock Position:  0.006011707759835267
Bond Position:  [3.82895741]


portfolio before change:  [4.43302688]
curr_Stock_Price:  100.32292563645197
curr_Factors:  [1.00322926e+02 3.72811744e-02]
mat_Sqrt:  [[ 1.93706851e+01  0.00000000e+00]
 [-7.72333342e-03  1.76963800e-02]]
grads:  [-0.00248922 -2.27301772]
Stock Position:  -0.0024892206983929835
Bond Position:  [4.68275279]


portfolio before change:  [4.43467811]
curr_Stock_Price:  100.1299380717253
curr_Factors:  [1.00129938e+02 3.56648149e-02]
mat_Sqrt:  [[ 1.89096694e+01  0.00000000e+00]
 [-7.55405215e-03  1.73085079e-02]]
grads:  [  0.02033646 -15.33731642]
Stock Position:  0.02033645794379751
Bond Position:  [2.39838983]


portfolio before change:  [4.45030568]
curr_Stock_Price:  100.86890156568282
curr_Factors:  [1.00868902e+02 3.63702013e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.45030568]
Stock Price:  99.27613776861571
PL:  [4.45030568]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-7.51170945e-02  9.77056123e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.00749421e-01 -8.30294209e-01]
 [ 1.24972554e-01  7.69811534e-02]
 [-4.34980979e-01 -1.20680358e-01]
 [ 3.48663684e-01 -4.14400884e-01]
 [-4.99012224e-01  2.24472576e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-2.11511050e-01  1.35788417e-02]
 [ 2.15853016e-01  7.24213447e-03]
 [-8.98742682e-02 -9.70291614e-03]
 [-2.35965987e-01  5.70034811e-02]
 [-1.21318237e-01  3.06928164e-02]
 [-4.90456387e-02 -1.96831540e-01]
 [-1.96522754e-01 -1.37232130e-01]
 [ 8.78978737e-02  2.64561963e-02]
 [ 5.34980456e-02 -7.51770961e-02]
 [ 8.86856509e-01 -4.14808842e-01]
 [ 1.56585029e-01  1.50103862e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.95538794]
curr_Stock_Price:  99.90453530365245
curr_Factors:  [9.99045353e+01 3.95343156e-02]
mat_Sqrt:  [[ 1.98642566e+01  0.00000000e+00]
 [-7.95329523e-03  1.82232887e-02]]
grads:  [-0.00356685  0.53615796]
Stock Position:  -0.0035668524353363856
Bond Position:  [2.31173268]


portfolio before change:  [1.95818227]
curr_Stock_Price:  99.28316895943591
curr_Factors:  [9.92831690e+01 4.00581752e-02]
mat_Sqrt:  [[ 1.98710681e+01  0.00000000e+00]
 [-8.00581541e-03  1.83436275e-02]]
grads:  [-0.00937669 -3.63352178]
Stock Position:  -0.009376691246650411
Bond Position:  [2.88912989]


portfolio before change:  [1.96513906]
curr_Stock_Price:  98.61828487040967
curr_Factors:  [9.86182849e+01 3.95623767e-02]
mat_Sqrt:  [[ 1.96154661e+01  0.00000000e+00]
 [-7.95611731e-03  1.82297549e-02]]
grads:  [-2.87079348e-02 -4.55460983e+01]
Stock Position:  -0.028707934805336073
Bond Position:  [4.79626635]


portfolio before change:  [1.90245399]
curr_Stock_Price:  100.84360286438435
curr_Factors:  [1.00843603e+02 3.74872931e-02]
mat_Sqrt:  [[ 1.95249708e+01  0.00000000e+00]
 [-7.74465421e-03  1.77452321e-02]]
grads:  [0.00812139 4.33813168]
Stock Position:  0.00812138899012181
Bond Position:  [1.08346386]


portfolio before change:  [1.89116929]
curr_Stock_Price:  99.42074361181244
curr_Factors:  [9.94207436e+01 3.81426904e-02]
mat_Sqrt:  [[ 1.94170240e+01  0.00000000e+00]
 [-7.81206148e-03  1.78996815e-02]]
grads:  [-0.02511457 -6.74203942]
Stock Position:  -0.02511456977608839
Bond Position:  [4.3880785]


portfolio before change:  [1.87537687]
curr_Stock_Price:  100.09324495298026
curr_Factors:  [1.00093245e+02 3.87066994e-02]
mat_Sqrt:  [[ 1.96923633e+01  0.00000000e+00]
 [-7.86960729e-03  1.80315356e-02]]
grads:  [ 8.52128861e-03 -2.29820074e+01]
Stock Position:  0.008521288608332822
Bond Position:  [1.02245344]


portfolio before change:  [1.87505907]
curr_Stock_Price:  100.0259492393003
curr_Factors:  [1.00025949e+02 3.62610735e-02]
mat_Sqrt:  [[ 1.90472819e+01  0.00000000e+00]
 [-7.61693624e-03  1.74525934e-02]]
grads:  [-0.0210552  12.86184641]
Stock Position:  -0.02105520151950315
Bond Position:  [3.98112559]


portfolio before change:  [1.89540836]
curr_Stock_Price:  99.10675182407607
curr_Factors:  [9.91067518e+01 3.79637305e-02]
mat_Sqrt:  [[ 1.93102405e+01  0.00000000e+00]
 [-7.79371341e-03  1.78576408e-02]]
grads:  [5.06493693e-03 7.60005120e+00]
Stock Position:  0.005064936927730769
Bond Position:  [1.39343891]


portfolio before change:  [1.88616077]
curr_Stock_Price:  97.21215975944273
curr_Factors:  [9.72121598e+01 3.80148625e-02]
mat_Sqrt:  [[ 1.89538441e+01  0.00000000e+00]
 [-7.79896019e-03  1.78696627e-02]]
grads:  [-0.0108466   0.75988237]
Stock Position:  -0.010846599604750205
Bond Position:  [2.94058215]


portfolio before change:  [1.88479115]
curr_Stock_Price:  97.40621665081942
curr_Factors:  [9.74062167e+01 3.75196493e-02]
mat_Sqrt:  [[ 1.88675739e+01  0.00000000e+00]
 [-7.74799580e-03  1.77528886e-02]]
grads:  [0.01160794 0.40794119]
Stock Position:  0.011607944056111938
Bond Position:  [0.75410524]


portfolio before change:  [1.88099865]
curr_Stock_Price:  97.063257484033
curr_Factors:  [9.70632575e+01 3.74739092e-02]
mat_Sqrt:  [[ 1.87896791e+01  0.00000000e+00]
 [-7.74327157e-03  1.77420641e-02]]
grads:  [-0.00500855 -0.54688767]
Stock Position:  -0.005008545789380998
Bond Position:  [2.36714442]


portfolio before change:  [1.87165902]
curr_Stock_Price:  99.04616786537375
curr_Factors:  [9.90461679e+01 3.75933857e-02]
mat_Sqrt:  [[ 1.92040752e+01  0.00000000e+00]
 [-7.75560553e-03  1.77703247e-02]]
grads:  [-0.01099181  3.20779063]
Stock Position:  -0.010991814289929156
Bond Position:  [2.9603561]


portfolio before change:  [1.89249612]
curr_Stock_Price:  97.21781423997535
curr_Factors:  [9.72178142e+01 3.83632570e-02]
mat_Sqrt:  [[ 1.90416066e+01  0.00000000e+00]
 [-7.83461621e-03  1.79513609e-02]]
grads:  [-0.00566774  1.70977658]
Stock Position:  -0.005667735724242941
Bond Position:  [2.443501]


portfolio before change:  [1.90222532]
curr_Stock_Price:  95.6090157978937
curr_Factors:  [9.56090158e+01 3.82489740e-02]
mat_Sqrt:  [[ 1.86985850e+01  0.00000000e+00]
 [-7.82293796e-03  1.79246027e-02]]
grads:  [-7.21712182e-03 -1.09810825e+01]
Stock Position:  -0.007217121819082785
Bond Position:  [2.59224723]


portfolio before change:  [1.9021084]
curr_Stock_Price:  95.71502200548909
curr_Factors:  [9.57150220e+01 3.77285903e-02]
mat_Sqrt:  [[ 1.85915412e+01  0.00000000e+00]
 [-7.76953953e-03  1.78022515e-02]]
grads:  [-0.01379207 -7.70869514]
Stock Position:  -0.013792066139822675
Bond Position:  [3.22221631]


portfolio before change:  [1.92504594]
curr_Stock_Price:  94.11033971351301
curr_Factors:  [9.41103397e+01 3.97049994e-02]
mat_Sqrt:  [[ 1.87525330e+01  0.00000000e+00]
 [-7.97044535e-03  1.82625846e-02]]
grads:  [0.00530298 1.44865565]
Stock Position:  0.00530297984027421
Bond Position:  [1.42598071]


portfolio before change:  [1.92228837]
curr_Stock_Price:  93.52310215151364
curr_Factors:  [9.35231022e+01 3.94315333e-02]
mat_Sqrt:  [[ 1.85712329e+01  0.00000000e+00]
 [-7.94294991e-03  1.81995846e-02]]
grads:  [ 1.11398479e-03 -4.13070395e+00]
Stock Position:  0.0011139847911444758
Bond Position:  [1.81810506]


portfolio before change:  [1.92497659]
curr_Stock_Price:  95.52819287124704
curr_Factors:  [9.55281929e+01 3.88800945e-02]
mat_Sqrt:  [[ 1.88362835e+01  0.00000000e+00]
 [-7.88721441e-03  1.80718785e-02]]
grads:  [  0.03747125 -22.95327743]
Stock Position:  0.03747125001120612
Bond Position:  [-1.6545842]


portfolio before change:  [1.94712456]
curr_Stock_Price:  96.13029893039034
curr_Factors:  [9.61302989e+01 3.99827343e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.94712456]
Stock Price:  94.42626516493549
PL:  [1.94712456]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.66113248e-02 -1.52880458e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.89677702e-01 -7.54753448e-01]
 [ 8.38085913e-02  1.40582084e-01]
 [-3.47137173e-01 -1.06893313e-01]
 [ 3.68325726e-01 -4.45067942e-01]
 [-4.93916229e-01  2.04371013e-01]
 [ 1.53693225e-02  1.65005402e-01]
 [-2.04095714e-01 -1.53129609e-02]
 [ 2.69412487e-01  4.64465397e-03]
 [-9.14168638e-02 -1.14580548e-02]
 [-2.19547214e-01  7.04213434e-02]
 [-4.63193461e-02  1.51727723e-02]
 [-1.05973370e-01 -2.23666259e-01]
 [-1.71425725e-01 -1.42790540e-01]
 [ 8.84929125e-02  5.99146740e-02]
 [ 5.68566521e-02 -8.31799199e-02]
 [ 8.68934630e-01 -4.07364927e-01]
 [ 1.55930389e-01  1.50233735e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.01522512]
curr_Stock_Price:  97.00573511243171
curr_Factors:  [9.70057351e+01 4.02157358e-02]
mat_Sqrt:  [[ 1.94533957e+01  0.00000000e+00]
 [-8.02154457e-03  1.83796676e-02]]
grads:  [ 0.0018477  -0.08317912]
Stock Position:  0.0018477031140256318
Bond Position:  [-18.19446292]


portfolio before change:  [-18.01875025]
curr_Stock_Price:  97.559968154704
curr_Factors:  [9.75599682e+01 3.95616221e-02]
mat_Sqrt:  [[ 1.94047787e+01  0.00000000e+00]
 [-7.95604144e-03  1.82295811e-02]]
grads:  [-0.00960201 -3.65625353]
Stock Position:  -0.009602009522121613
Bond Position:  [-17.08197851]


portfolio before change:  [-18.0386577]
curr_Stock_Price:  99.18842130888868
curr_Factors:  [9.91884213e+01 3.82132655e-02]
mat_Sqrt:  [[ 1.93895645e+01  0.00000000e+00]
 [-7.81928544e-03  1.79162337e-02]]
grads:  [-2.67710558e-02 -4.21267918e+01]
Stock Position:  -0.026771055780564632
Bond Position:  [-15.38327894]


portfolio before change:  [-18.07389486]
curr_Stock_Price:  100.36098835494356
curr_Factors:  [1.00360988e+02 3.93005093e-02]
mat_Sqrt:  [[ 1.98959197e+01  0.00000000e+00]
 [-7.92974242e-03  1.81693224e-02]]
grads:  [7.29615143e-03 7.73733222e+00]
Stock Position:  0.007296151434465454
Bond Position:  [-18.80614383]


portfolio before change:  [-18.07859951]
curr_Stock_Price:  100.36064149916604
curr_Factors:  [1.00360641e+02 4.05870925e-02]
mat_Sqrt:  [[ 2.02188942e+01  0.00000000e+00]
 [-8.05849539e-03  1.84643326e-02]]
grads:  [-0.0194763  -5.78917826]
Stock Position:  -0.019476299550981815
Bond Position:  [-16.1239456]


portfolio before change:  [-18.08248303]
curr_Stock_Price:  100.35304360027958
curr_Factors:  [1.00353044e+02 3.99178756e-02]
mat_Sqrt:  [[ 2.00499946e+01  0.00000000e+00]
 [-7.99178334e-03  1.83114761e-02]]
grads:  [ 8.68240394e-03 -2.43054105e+01]
Stock Position:  0.008682403942831776
Bond Position:  [-18.95378869]


portfolio before change:  [-18.09316788]
curr_Stock_Price:  99.66823131258644
curr_Factors:  [9.96682313e+01 3.98468590e-02]
mat_Sqrt:  [[ 1.98954514e+01  0.00000000e+00]
 [-7.98467121e-03  1.82951801e-02]]
grads:  [-0.02034241 11.17075708]
Stock Position:  -0.020342408815367283
Bond Position:  [-16.06567598]


portfolio before change:  [-18.06321474]
curr_Stock_Price:  97.99831789162482
curr_Factors:  [9.79983179e+01 3.97224637e-02]
mat_Sqrt:  [[ 1.95315500e+01  0.00000000e+00]
 [-7.97219806e-03  1.82666005e-02]]
grads:  [4.47397078e-03 9.03317516e+00]
Stock Position:  0.004473970782015355
Bond Position:  [-18.50165635]


portfolio before change:  [-18.06792081]
curr_Stock_Price:  97.98042030732613
curr_Factors:  [9.79804203e+01 3.92099101e-02]
mat_Sqrt:  [[ 1.94015855e+01  0.00000000e+00]
 [-7.92059696e-03  1.81483676e-02]]
grads:  [-0.010864   -0.84376519]
Stock Position:  -0.010864000710322232
Bond Position:  [-17.00346145]


portfolio before change:  [-18.08714597]
curr_Stock_Price:  99.35871223570064
curr_Factors:  [9.93587122e+01 3.87372441e-02]
mat_Sqrt:  [[ 1.95555626e+01  0.00000000e+00]
 [-7.87271177e-03  1.80386488e-02]]
grads:  [0.01388043 0.25748347]
Stock Position:  0.013880428079723655
Bond Position:  [-19.46628743]


portfolio before change:  [-18.12420072]
curr_Stock_Price:  97.03979470600615
curr_Factors:  [9.70397947e+01 3.92615386e-02]
mat_Sqrt:  [[ 1.92279740e+01  0.00000000e+00]
 [-7.92580985e-03  1.81603118e-02]]
grads:  [-0.00501444 -0.63093932]
Stock Position:  -0.005014442437796537
Bond Position:  [-17.63760025]


portfolio before change:  [-18.13119146]
curr_Stock_Price:  97.55446575135142
curr_Factors:  [9.75544658e+01 3.81223562e-02]
mat_Sqrt:  [[ 1.90474579e+01  0.00000000e+00]
 [-7.80997887e-03  1.78949097e-02]]
grads:  [-0.00991276  3.93527236]
Stock Position:  -0.009912756894437767
Bond Position:  [-17.16415775]


portfolio before change:  [-18.11862474]
curr_Stock_Price:  95.85379926786156
curr_Factors:  [9.58537993e+01 3.98047721e-02]
mat_Sqrt:  [[ 1.91239193e+01  0.00000000e+00]
 [-7.98045333e-03  1.82855157e-02]]
grads:  [-0.0020758   0.82976999]
Stock Position:  -0.00207579862734263
Bond Position:  [-17.91965155]


portfolio before change:  [-18.126554]
curr_Stock_Price:  97.51522415646787
curr_Factors:  [9.75152242e+01 3.97844513e-02]
mat_Sqrt:  [[ 1.94504257e+01  0.00000000e+00]
 [-7.97841602e-03  1.82808477e-02]]
grads:  [-1.04670886e-02 -1.22350048e+01]
Stock Position:  -0.010467088561073512
Bond Position:  [-17.10585351]


portfolio before change:  [-18.11774794]
curr_Stock_Price:  96.26530154708568
curr_Factors:  [9.62653015e+01 4.02492608e-02]
mat_Sqrt:  [[ 1.93129551e+01  0.00000000e+00]
 [-8.02488737e-03  1.83873269e-02]]
grads:  [-0.012103   -7.76570411]
Stock Position:  -0.012102996386366995
Bond Position:  [-16.95264935]


portfolio before change:  [-18.1274295]
curr_Stock_Price:  96.7150140493322
curr_Factors:  [9.67150140e+01 3.93497922e-02]
mat_Sqrt:  [[ 1.91851465e+01  0.00000000e+00]
 [-7.93471282e-03  1.81807111e-02]]
grads:  [0.00597555 3.29550774]
Stock Position:  0.005975550918626369
Bond Position:  [-18.705355]


portfolio before change:  [-18.1349907]
curr_Stock_Price:  96.23233447767863
curr_Factors:  [9.62323345e+01 3.81037235e-02]
mat_Sqrt:  [[ 1.87847202e+01  0.00000000e+00]
 [-7.80807003e-03  1.78905360e-02]]
grads:  [ 1.09418499e-03 -4.64938111e+00]
Stock Position:  0.0010941849893616729
Bond Position:  [-18.24028668]


portfolio before change:  [-18.14011385]
curr_Stock_Price:  95.71825356357682
curr_Factors:  [9.57182536e+01 3.89161310e-02]
mat_Sqrt:  [[ 1.88825044e+01  0.00000000e+00]
 [-7.89086875e-03  1.80802517e-02]]
grads:  [  0.03660245 -22.53093232]
Stock Position:  0.03660245410560954
Bond Position:  [-21.64363683]


portfolio before change:  [-18.13145809]
curr_Stock_Price:  96.10258123953882
curr_Factors:  [9.61025812e+01 3.90717433e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.13145809]
Stock Price:  96.91493174188894
PL:  [-18.13145809]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.27324521e-01  4.23516178e-01]
 [ 2.65141479e-01  6.31136102e-02]
 [-6.46317011e-02  9.84176130e-02]
 [ 3.74402461e-01 -3.32475587e-01]
 [-1.59189871e-01 -8.23622824e-02]
 [ 4.33754237e-01 -5.47117357e-01]
 [-4.39090080e-01  1.70281007e-01]
 [ 8.32161586e-02  1.39225703e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.72374200e-01  4.70306272e-03]
 [-3.73503729e-02  4.09241461e-02]
 [-2.36255706e-01  6.26509711e-02]
 [-1.15932848e-02  3.87347538e-02]
 [-2.70271128e-01 -2.57171604e-01]
 [-5.46012919e-03 -8.43837091e-02]
 [ 9.86441823e-02  3.91885291e-02]
 [ 3.35875196e-02 -7.20136333e-02]
 [ 1.09780940e+00 -5.02699700e-01]
 [ 1.54622412e-01  1.51967630e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.35119962]
curr_Stock_Price:  102.71990118263767
curr_Factors:  [1.02719901e+02 3.88652306e-02]
mat_Sqrt:  [[ 2.02504751e+01  0.00000000e+00]
 [-7.88570662e-03  1.80684237e-02]]
grads:  [1.54150524e-02 2.34395752e+01]
Stock Position:  0.015415052372317597
Bond Position:  [19.76776697]


portfolio before change:  [21.38087588]
curr_Stock_Price:  104.32441737648381
curr_Factors:  [1.04324417e+02 4.06957243e-02]
mat_Sqrt:  [[ 2.10455538e+01  0.00000000e+00]
 [-8.06927251e-03  1.84890260e-02]]
grads:  [0.01390729 3.41357138]
Stock Position:  0.013907285079139457
Bond Position:  [19.93000647]


portfolio before change:  [21.41216684]
curr_Stock_Price:  106.21607555967846
curr_Factors:  [1.06216076e+02 4.15156141e-02]
mat_Sqrt:  [[ 2.16419298e+01  0.00000000e+00]
 [-8.15015231e-03  1.86743449e-02]]
grads:  [-1.00170057e-03  5.27020430e+00]
Stock Position:  -0.0010017005658952774
Bond Position:  [21.51856354]


portfolio before change:  [21.41824287]
curr_Stock_Price:  105.52154112469303
curr_Factors:  [1.05521541e+02 4.29233345e-02]
mat_Sqrt:  [[ 2.18618974e+01  0.00000000e+00]
 [-8.28717897e-03  1.89883125e-02]]
grads:  [ 1.04884866e-02 -1.75094858e+01]
Stock Position:  0.01048848662447757
Bond Position:  [20.31148159]


portfolio before change:  [21.39272339]
curr_Stock_Price:  102.60424876804639
curr_Factors:  [1.02604249e+02 4.48714417e-02]
mat_Sqrt:  [[ 2.17345352e+01  0.00000000e+00]
 [-8.47315212e-03  1.94144305e-02]]
grads:  [-0.00897814 -4.24232287]
Stock Position:  -0.008978140845556391
Bond Position:  [22.31391879]


portfolio before change:  [21.41080298]
curr_Stock_Price:  101.21193286544329
curr_Factors:  [1.01211933e+02 4.53032424e-02]
mat_Sqrt:  [[ 2.15425129e+01  0.00000000e+00]
 [-8.51382334e-03  1.95076200e-02]]
grads:  [ 9.05059902e-03 -2.80463408e+01]
Stock Position:  0.00905059901944429
Bond Position:  [20.49477436]


portfolio before change:  [21.39374999]
curr_Stock_Price:  98.76156196327157
curr_Factors:  [9.87615620e+01 4.45840018e-02]
mat_Sqrt:  [[ 2.08534288e+01  0.00000000e+00]
 [-8.44596962e-03  1.93521475e-02]]
grads:  [-0.01749225  8.79907548]
Stock Position:  -0.017492248383355828
Bond Position:  [23.12131176]


portfolio before change:  [21.37935608]
curr_Stock_Price:  99.9149276718905
curr_Factors:  [9.99149277e+01 4.44952144e-02]
mat_Sqrt:  [[ 2.10759437e+01  0.00000000e+00]
 [-8.43755551e-03  1.93328684e-02]]
grads:  [6.83144911e-03 7.20150263e+00]
Stock Position:  0.0068314491059107045
Bond Position:  [20.69679233]


portfolio before change:  [21.3881129]
curr_Stock_Price:  100.43926465702964
curr_Factors:  [1.00439265e+02 4.40457203e-02]
mat_Sqrt:  [[ 2.10792611e+01  0.00000000e+00]
 [-8.39482891e-03  1.92349695e-02]]
grads:  [-0.01032204 -2.76313988]
Stock Position:  -0.010322035006564513
Bond Position:  [22.42485051]


portfolio before change:  [21.40407439]
curr_Stock_Price:  99.4361122394093
curr_Factors:  [9.94361122e+01 4.33199759e-02]
mat_Sqrt:  [[ 2.06960869e+01  0.00000000e+00]
 [-8.32538056e-03  1.90758433e-02]]
grads:  [0.01325984 0.24654547]
Stock Position:  0.01325983920555094
Bond Position:  [20.08556753]


portfolio before change:  [21.39005125]
curr_Stock_Price:  97.99980792272879
curr_Factors:  [9.79998079e+01 4.36734000e-02]
mat_Sqrt:  [[ 2.04801780e+01  0.00000000e+00]
 [-8.35927269e-03  1.91534999e-02]]
grads:  [-9.51632903e-04  2.13664063e+00]
Stock Position:  -0.0009516329034435444
Bond Position:  [21.48331109]


portfolio before change:  [21.39406021]
curr_Stock_Price:  99.43159231418757
curr_Factors:  [9.94315923e+01 4.21096985e-02]
mat_Sqrt:  [[ 2.04040068e+01  0.00000000e+00]
 [-8.20825911e-03  1.88074843e-02]]
grads:  [-0.0102388   3.33117231]
Stock Position:  -0.010238801735551707
Bond Position:  [22.41212057]


portfolio before change:  [21.38791895]
curr_Stock_Price:  100.5786985455096
curr_Factors:  [1.00578699e+02 4.35518698e-02]
mat_Sqrt:  [[ 2.09898538e+01  0.00000000e+00]
 [-8.34763389e-03  1.91268321e-02]]
grads:  [2.53072162e-04 2.02515260e+00]
Stock Position:  0.00025307216180610906
Bond Position:  [21.36246528]


portfolio before change:  [21.39368197]
curr_Stock_Price:  102.24517251602647
curr_Factors:  [1.02245173e+02 4.52678811e-02]
mat_Sqrt:  [[ 2.17539384e+01  0.00000000e+00]
 [-8.51049997e-03  1.95000051e-02]]
grads:  [ -0.01758348 -13.18828391]
Stock Position:  -0.0175834834910449
Bond Position:  [23.19150827]


portfolio before change:  [21.42127822]
curr_Stock_Price:  101.00550645652442
curr_Factors:  [1.01005506e+02 4.48641943e-02]
mat_Sqrt:  [[ 2.13941476e+01  0.00000000e+00]
 [-8.47246782e-03  1.94128626e-02]]
grads:  [-1.97662463e-03 -4.34679372e+00]
Stock Position:  -0.0019766246341771177
Bond Position:  [21.62092819]


portfolio before change:  [21.42740067]
curr_Stock_Price:  100.64299984875606
curr_Factors:  [1.00643000e+02 4.49230593e-02]
mat_Sqrt:  [[ 2.13313448e+01  0.00000000e+00]
 [-8.47802424e-03  1.94255939e-02]]
grads:  [0.00542617 2.01736582]
Stock Position:  0.005426167908906515
Bond Position:  [20.88129485]


portfolio before change:  [21.41558436]
curr_Stock_Price:  97.50316329068842
curr_Factors:  [9.75031633e+01 4.64736998e-02]
mat_Sqrt:  [[ 2.10194975e+01  0.00000000e+00]
 [-8.62310383e-03  1.97580130e-02]]
grads:  [ 1.02675781e-04 -3.64478114e+00]
Stock Position:  0.00010267578132280443
Bond Position:  [21.40557315]


portfolio before change:  [21.42050226]
curr_Stock_Price:  93.27462251220027
curr_Factors:  [9.32746225e+01 4.76100025e-02]
mat_Sqrt:  [[ 2.03522581e+01  0.00000000e+00]
 [-8.72788657e-03  1.99981004e-02]]
grads:  [  0.04316048 -25.13737251]
Stock Position:  0.04316048171091162
Bond Position:  [17.39472462]


portfolio before change:  [21.53970224]
curr_Stock_Price:  95.93563905282848
curr_Factors:  [9.59356391e+01 4.70942778e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.53970224]
Stock Price:  96.62858446669632
PL:  [21.53970224]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [ 1.64767697e-01 -2.24890816e-02]
 [-1.40521998e-01 -4.19371081e-01]
 [ 2.04926223e-01 -4.86846951e-02]
 [-1.29354770e-01 -7.74447629e-02]
 [ 6.30833312e-01 -8.52375629e-01]
 [-5.74438723e-01  4.05467478e-01]
 [ 4.39209484e-01  1.67188667e-01]
 [ 6.91024672e-02 -8.83565067e-02]
 [ 8.18479361e-02  1.97480102e-02]
 [ 1.77397046e-01  2.57343031e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-7.18664363e-02  1.02062021e-01]
 [-3.01261917e-01 -2.47067337e-01]
 [ 1.71605128e-01  5.97352308e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.23885343e-02  1.10602934e-01]
 [ 2.97499185e-01 -2.06427848e-01]
 [ 1.64828262e-01  5.84574618e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.65810911]
curr_Stock_Price:  99.08971773823197
curr_Factors:  [9.90897177e+01 4.07067095e-02]
mat_Sqrt:  [[ 1.99922462e+01  0.00000000e+00]
 [-8.07036153e-03  1.84915213e-02]]
grads:  [ 0.00139412 -0.07305155]
Stock Position:  0.0013941193698795067
Bond Position:  [-3.796252]


portfolio before change:  [-3.65353173]
curr_Stock_Price:  103.05391182904708
curr_Factors:  [1.03053912e+02 4.10531185e-02]
mat_Sqrt:  [[ 2.08803396e+01  0.00000000e+00]
 [-8.10462766e-03  1.85700349e-02]]
grads:  [ 0.00742098 -1.21104143]
Stock Position:  0.0074209835652343644
Bond Position:  [-4.41829311]


portfolio before change:  [-3.66294797]
curr_Stock_Price:  101.93390758040908
curr_Factors:  [1.01933908e+02 4.28765048e-02]
mat_Sqrt:  [[ 2.11070899e+01  0.00000000e+00]
 [-8.28265705e-03  1.89779514e-02]]
grads:  [-1.53289982e-02 -2.20978056e+01]
Stock Position:  -0.01532899818857211
Bond Position:  [-2.10040329]


portfolio before change:  [-3.66348827]
curr_Stock_Price:  101.93489460586248
curr_Factors:  [1.01934895e+02 4.13247635e-02]
mat_Sqrt:  [[ 2.07218281e+01  0.00000000e+00]
 [-8.13139727e-03  1.86313718e-02]]
grads:  [ 0.00886401 -2.61304942]
Stock Position:  0.008864009426750877
Bond Position:  [-4.56704014]


portfolio before change:  [-3.65314491]
curr_Stock_Price:  103.23061313652921
curr_Factors:  [1.03230613e+02 4.36768778e-02]
mat_Sqrt:  [[ 2.15741801e+01  0.00000000e+00]
 [-8.35960552e-03  1.91542625e-02]]
grads:  [-0.00756249 -4.04321298]
Stock Position:  -0.007562486044991454
Bond Position:  [-2.87246484]


portfolio before change:  [-3.65599137]
curr_Stock_Price:  103.51203524881197
curr_Factors:  [1.03512035e+02 4.31494028e-02]
mat_Sqrt:  [[ 2.15019695e+01  0.00000000e+00]
 [-8.30897373e-03  1.90382505e-02]]
grads:  [ 1.20373201e-02 -4.47717414e+01]
Stock Position:  0.01203732007616533
Bond Position:  [-4.90199887]


portfolio before change:  [-3.66657225]
curr_Stock_Price:  102.73485017258561
curr_Factors:  [1.02734850e+02 4.17879696e-02]
mat_Sqrt:  [[ 2.10011669e+01  0.00000000e+00]
 [-8.17684238e-03  1.87354996e-02]]
grads:  [-1.89264820e-02  2.16416689e+01]
Stock Position:  -0.0189264819799438
Bond Position:  [-1.72216296]


portfolio before change:  [-3.6810526]
curr_Stock_Price:  103.4771832661494
curr_Factors:  [1.03477183e+02 4.15998765e-02]
mat_Sqrt:  [[ 2.11052557e+01  0.00000000e+00]
 [-8.15841911e-03  1.86932866e-02]]
grads:  [0.02426773 8.94378128]
Stock Position:  0.02426772771874814
Bond Position:  [-6.1922087]


portfolio before change:  [-3.67024671]
curr_Stock_Price:  103.98625984814639
curr_Factors:  [1.03986260e+02 4.37269439e-02]
mat_Sqrt:  [[ 2.17445548e+01  0.00000000e+00]
 [-8.36439539e-03  1.91652375e-02]]
grads:  [ 1.40451375e-03 -4.61024846e+00]
Stock Position:  0.001404513750779737
Bond Position:  [-3.81629684]


portfolio before change:  [-3.67005316]
curr_Stock_Price:  104.80344262036392
curr_Factors:  [1.04803443e+02 4.40295535e-02]
mat_Sqrt:  [[ 2.19911373e+01  0.00000000e+00]
 [-8.39328813e-03  1.92314391e-02]]
grads:  [0.00411378 1.02686076]
Stock Position:  0.004113778804385395
Bond Position:  [-4.10119134]


portfolio before change:  [-3.67769365]
curr_Stock_Price:  103.19541641985559
curr_Factors:  [1.03195416e+02 4.25311346e-02]
mat_Sqrt:  [[ 2.12820712e+01  0.00000000e+00]
 [-8.24923120e-03  1.89013632e-02]]
grads:  [1.36129021e-02 1.36150514e+01]
Stock Position:  0.01361290211978449
Bond Position:  [-5.08248275]


portfolio before change:  [-3.66623548]
curr_Stock_Price:  104.13048165329278
curr_Factors:  [1.04130482e+02 4.13315083e-02]
mat_Sqrt:  [[ 2.11698853e+01  0.00000000e+00]
 [-8.13206082e-03  1.86328921e-02]]
grads:  [-0.00892815  6.13609112]
Stock Position:  -0.008928152494322491
Bond Position:  [-2.73654266]


portfolio before change:  [-3.68058868]
curr_Stock_Price:  105.66147926824942
curr_Factors:  [1.05661479e+02 3.98912070e-02]
mat_Sqrt:  [[ 2.11035382e+01  0.00000000e+00]
 [-7.98911330e-03  1.83053582e-02]]
grads:  [-1.29470794e-03  5.57552713e+00]
Stock Position:  -0.0012947079376751758
Bond Position:  [-3.54378792]


portfolio before change:  [-3.68002801]
curr_Stock_Price:  104.54406802239134
curr_Factors:  [1.04544068e+02 3.70826246e-02]
mat_Sqrt:  [[ 2.01318937e+01  0.00000000e+00]
 [-7.70273973e-03  1.76491939e-02]]
grads:  [ -0.02032054 -13.99878871]
Stock Position:  -0.0203205396230222
Bond Position:  [-1.55563614]


portfolio before change:  [-3.66912199]
curr_Stock_Price:  103.98822747888299
curr_Factors:  [1.03988227e+02 3.63335948e-02]
mat_Sqrt:  [[ 1.98215841e+01  0.00000000e+00]
 [-7.62454928e-03  1.74700371e-02]]
grads:  [0.00997275 3.41929616]
Stock Position:  0.00997275088381523
Bond Position:  [-4.70617068]


portfolio before change:  [-3.6551651]
curr_Stock_Price:  105.50572063241692
curr_Factors:  [1.05505721e+02 3.37521134e-02]
mat_Sqrt:  [[ 1.93832454e+01  0.00000000e+00]
 [-7.34869930e-03  1.68379854e-02]]
grads:  [0.00495252 1.04116112]
Stock Position:  0.004952521021731642
Bond Position:  [-4.1776844]


portfolio before change:  [-3.66009283]
curr_Stock_Price:  104.72163989339283
curr_Factors:  [1.04721640e+02 3.40977602e-02]
mat_Sqrt:  [[ 1.93374570e+01  0.00000000e+00]
 [-7.38623154e-03  1.69239826e-02]]
grads:  [-2.12926478e-04  6.53527817e+00]
Stock Position:  -0.00021292647750866163
Bond Position:  [-3.63779482]


portfolio before change:  [-3.6607214]
curr_Stock_Price:  103.40199530480392
curr_Factors:  [1.03401995e+02 3.28994463e-02]
mat_Sqrt:  [[ 1.87552654e+01  0.00000000e+00]
 [-7.25528181e-03  1.66239390e-02]]
grads:  [ 1.10585844e-02 -1.24175051e+01]
Stock Position:  0.011058584422446617
Bond Position:  [-4.8042011]


portfolio before change:  [-3.66770516]
curr_Stock_Price:  102.87909344727208
curr_Factors:  [1.02879093e+02 3.30902784e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.66770516]
Stock Price:  104.84465747743062
PL:  [-8.51236264]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.81634384e-01 -6.99875038e-01]
 [ 9.50041428e-02  1.23301461e-01]
 [-3.32623089e-01 -1.05103688e-01]
 [ 3.21027540e-01 -3.71296551e-01]
 [-4.82611219e-01  1.83374762e-01]
 [ 8.58135840e-02  1.39429728e-01]
 [-2.05441314e-01 -1.00702065e-02]
 [ 2.14219182e-01  7.34451399e-03]
 [ 2.27569300e-02  1.00021487e-01]
 [-2.37312654e-01  8.32540081e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-1.47009013e-01 -2.42406669e-01]
 [-7.20293364e-03 -8.51072993e-02]
 [ 9.04944830e-02  1.31361032e-02]
 [-1.99240270e-02 -4.55318184e-02]
 [ 4.10431363e-01 -2.39297041e-01]
 [ 2.24163549e-01  1.22775930e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.02791141]
curr_Stock_Price:  98.45542655640405
curr_Factors:  [9.84554266e+01 4.04485202e-02]
mat_Sqrt:  [[ 1.98011757e+01  0.00000000e+00]
 [-8.04472699e-03  1.84327852e-02]]
grads:  [ 0.00140757 -0.07328433]
Stock Position:  0.001407571856059329
Bond Position:  [-8.1664945]


portfolio before change:  [-8.0277878]
curr_Stock_Price:  99.99388434210996
curr_Factors:  [9.99938843e+01 4.11314192e-02]
mat_Sqrt:  [[ 2.02796421e+01  0.00000000e+00]
 [-8.11235297e-03  1.85877358e-02]]
grads:  [-0.00918778 -3.58580362]
Stock Position:  -0.009187779008863292
Bond Position:  [-7.10906609]


portfolio before change:  [-8.0262801]
curr_Stock_Price:  99.63632324413497
curr_Factors:  [9.96363232e+01 4.37781350e-02]
mat_Sqrt:  [[ 2.08471322e+01  0.00000000e+00]
 [-8.36929005e-03  1.91764526e-02]]
grads:  [-2.33645994e-02 -3.64965853e+01]
Stock Position:  -0.02336459937444192
Bond Position:  [-5.69831732]


portfolio before change:  [-8.04765758]
curr_Stock_Price:  100.49029565675647
curr_Factors:  [1.00490296e+02 4.16581547e-02]
mat_Sqrt:  [[ 2.05104004e+01  0.00000000e+00]
 [-8.16413176e-03  1.87063759e-02]]
grads:  [0.0072557  6.59141362]
Stock Position:  0.007255700008592467
Bond Position:  [-8.77678502]


portfolio before change:  [-8.04979278]
curr_Stock_Price:  100.49846506220099
curr_Factors:  [1.00498465e+02 4.29776453e-02]
mat_Sqrt:  [[ 2.08343875e+01  0.00000000e+00]
 [-8.29242018e-03  1.90003216e-02]]
grads:  [-0.0181668  -5.53167944]
Stock Position:  -0.018166797534809077
Bond Position:  [-6.22405751]


portfolio before change:  [-8.03690058]
curr_Stock_Price:  99.7031457677933
curr_Factors:  [9.97031458e+01 4.30046968e-02]
mat_Sqrt:  [[ 2.06760134e+01  0.00000000e+00]
 [-8.29502953e-03  1.90063003e-02]]
grads:  [ 7.68912444e-03 -1.95354458e+01]
Stock Position:  0.007689124443442315
Bond Position:  [-8.80353048]


portfolio before change:  [-8.04250222]
curr_Stock_Price:  99.26089979440482
curr_Factors:  [9.92608998e+01 4.31385731e-02]
mat_Sqrt:  [[ 2.06163176e+01  0.00000000e+00]
 [-8.30793097e-03  1.90358613e-02]]
grads:  [-0.01952725  9.63312137]
Stock Position:  -0.01952724629768386
Bond Position:  [-6.10421018]


portfolio before change:  [-8.05723314]
curr_Stock_Price:  99.93711776741769
curr_Factors:  [9.99371178e+01 4.16108781e-02]
mat_Sqrt:  [[ 2.03859174e+01  0.00000000e+00]
 [-8.15949784e-03  1.86957582e-02]]
grads:  [7.19446190e-03 7.45782687e+00]
Stock Position:  0.007194461904386644
Bond Position:  [-8.77622693]


portfolio before change:  [-8.07492807]
curr_Stock_Price:  97.78259996135067
curr_Factors:  [9.7782600e+01 4.3358185e-02]
mat_Sqrt:  [[ 2.03609074e+01  0.00000000e+00]
 [-8.32905133e-03  1.90842541e-02]]
grads:  [-0.01030584 -0.52767095]
Stock Position:  -0.010305842876701247
Bond Position:  [-7.06719596]


portfolio before change:  [-8.07259326]
curr_Stock_Price:  97.38458982219993
curr_Factors:  [9.73845898e+01 4.48330483e-02]
mat_Sqrt:  [[ 2.06200338e+01  0.00000000e+00]
 [-8.46952639e-03  1.94061229e-02]]
grads:  [0.01054434 0.37846375]
Stock Position:  0.01054433722642702
Bond Position:  [-9.09944921]


portfolio before change:  [-8.05726471]
curr_Stock_Price:  99.05408277840495
curr_Factors:  [9.90540828e+01 4.22449876e-02]
mat_Sqrt:  [[ 2.03591656e+01  0.00000000e+00]
 [-8.22143420e-03  1.88376723e-02]]
grads:  [3.26191590e-03 5.30965216e+00]
Stock Position:  0.00326191589736461
Bond Position:  [-8.3803708]


portfolio before change:  [-8.05351395]
curr_Stock_Price:  100.84631652597005
curr_Factors:  [1.00846317e+02 4.12819444e-02]
mat_Sqrt:  [[ 2.04899129e+01  0.00000000e+00]
 [-8.12718346e-03  1.86217167e-02]]
grads:  [-0.00980861  4.47080199]
Stock Position:  -0.009808612987973047
Bond Position:  [-7.06435146]


portfolio before change:  [-8.05492869]
curr_Stock_Price:  100.81047434024514
curr_Factors:  [1.00810474e+02 4.12466903e-02]
mat_Sqrt:  [[ 2.04738827e+01  0.00000000e+00]
 [-8.12371248e-03  1.86137637e-02]]
grads:  [3.24438341e-04 2.11487067e+00]
Stock Position:  0.00032443834113220595
Bond Position:  [-8.08763548]


portfolio before change:  [-8.05775622]
curr_Stock_Price:  98.3281454104051
curr_Factors:  [9.83281454e+01 4.16885693e-02]
mat_Sqrt:  [[ 2.00764233e+01  0.00000000e+00]
 [-8.16711154e-03  1.87132034e-02]]
grads:  [-1.25920814e-02 -1.29537773e+01]
Stock Position:  -0.012592081440884136
Bond Position:  [-6.8196002]


portfolio before change:  [-8.09279072]
curr_Stock_Price:  100.97499809926003
curr_Factors:  [1.00974998e+02 4.16622465e-02]
mat_Sqrt:  [[ 2.06103419e+01  0.00000000e+00]
 [-8.16453271e-03  1.87072946e-02]]
grads:  [-2.15167727e-03 -4.54941782e+00]
Stock Position:  -0.002151677273767795
Bond Position:  [-7.87552511]


portfolio before change:  [-8.09544839]
curr_Stock_Price:  101.29500208173185
curr_Factors:  [1.01295002e+02 4.17250676e-02]
mat_Sqrt:  [[ 2.06912412e+01  0.00000000e+00]
 [-8.17068591e-03  1.87213933e-02]]
grads:  [0.00465064 0.70166269]
Stock Position:  0.004650641677707007
Bond Position:  [-8.56653515]


portfolio before change:  [-8.10433407]
curr_Stock_Price:  99.84492582516833
curr_Factors:  [9.98449258e+01 4.37529756e-02]
mat_Sqrt:  [[ 2.08847748e+01  0.00000000e+00]
 [-8.36688478e-03  1.91709414e-02]]
grads:  [-1.90549059e-03 -2.37504343e+00]
Stock Position:  -0.001905490589016979
Bond Position:  [-7.91408051]


portfolio before change:  [-8.10957919]
curr_Stock_Price:  101.55910079000618
curr_Factors:  [1.01559101e+02 4.16574578e-02]
mat_Sqrt:  [[ 2.07283736e+01  0.00000000e+00]
 [-8.16406348e-03  1.87062194e-02]]
grads:  [  0.01476206 -12.79237859]
Stock Position:  0.014762063703474252
Bond Position:  [-9.6088011]


portfolio before change:  [-8.12835773]
curr_Stock_Price:  100.44976773826095
curr_Factors:  [1.00449768e+02 4.00882643e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.12835773]
Stock Price:  100.20736934761989
PL:  [-8.33572708]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.42004817e-01 -4.29488139e-01]
 [ 1.19087457e-01  8.61085138e-02]
 [-4.75689531e-01 -1.25513062e-01]
 [ 3.32947911e-01 -3.89888857e-01]
 [-5.43884772e-01  3.24138475e-01]
 [ 1.81210922e-02  1.61532198e-01]
 [-2.26374217e-01  7.14890524e-02]
 [ 1.54322705e-01  1.10977540e-02]
 [-1.06004474e-01 -5.09235030e-02]
 [-7.97679530e-02 -1.22704120e-02]
 [ 3.67827031e-01 -5.69295439e-02]
 [ 1.79665433e-01  1.28611739e-01]
 [-3.18397560e-01 -9.25398488e-02]
 [ 8.98743649e-02  1.60266810e-02]
 [ 1.74191877e-02 -5.13455539e-02]
 [ 1.21315105e+00 -5.50534132e-01]
 [ 1.86932280e-01  2.21376681e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.5000107]
curr_Stock_Price:  98.09659321168692
curr_Factors:  [9.80965932e+01 4.06655117e-02]
mat_Sqrt:  [[ 1.97818564e+01  0.00000000e+00]
 [-8.06627663e-03  1.84821616e-02]]
grads:  [ 0.00140895 -0.07308854]
Stock Position:  0.0014089465113000996
Bond Position:  [-10.63822355]


portfolio before change:  [-10.50281173]
curr_Stock_Price:  97.99641453255768
curr_Factors:  [9.79964145e+01 4.27206273e-02]
mat_Sqrt:  [[ 2.02548484e+01  0.00000000e+00]
 [-8.26758753e-03  1.89434228e-02]]
grads:  [-0.00919903 -3.51847555]
Stock Position:  -0.009199025670406558
Bond Position:  [-9.6013402]


portfolio before change:  [-10.54058605]
curr_Stock_Price:  101.84178717251228
curr_Factors:  [1.01841787e+02 4.14060786e-02]
mat_Sqrt:  [[ 2.07232594e+01  0.00000000e+00]
 [-8.13939345e-03  1.86496933e-02]]
grads:  [-1.58975382e-02 -2.30292333e+01]
Stock Position:  -0.01589753818587425
Bond Position:  [-8.92155235]


portfolio before change:  [-10.52578894]
curr_Stock_Price:  100.77069194743183
curr_Factors:  [1.00770692e+02 4.34622928e-02]
mat_Sqrt:  [[ 2.10082829e+01  0.00000000e+00]
 [-8.33904482e-03  1.91071521e-02]]
grads:  [0.00745745 4.50661164]
Stock Position:  0.007457453505230455
Bond Position:  [-11.27728169]


portfolio before change:  [-10.54249547]
curr_Stock_Price:  98.9085479129069
curr_Factors:  [9.89085479e+01 4.63054794e-02]
mat_Sqrt:  [[ 2.12838416e+01  0.00000000e+00]
 [-8.60748320e-03  1.97222216e-02]]
grads:  [-0.0249235  -6.36404274]
Stock Position:  -0.024923504497339682
Bond Position:  [-8.07734783]


portfolio before change:  [-10.56793293]
curr_Stock_Price:  99.8481377545892
curr_Factors:  [9.98481378e+01 4.67501971e-02]
mat_Sqrt:  [[ 2.15889586e+01  0.00000000e+00]
 [-8.64871756e-03  1.98167014e-02]]
grads:  [ 7.54026478e-03 -1.96747606e+01]
Stock Position:  0.007540264775049426
Bond Position:  [-11.32081432]


portfolio before change:  [-10.55848222]
curr_Stock_Price:  101.47689507863282
curr_Factors:  [1.01476895e+02 4.31858255e-02]
mat_Sqrt:  [[ 2.10881161e+01  0.00000000e+00]
 [-8.31247982e-03  1.90462840e-02]]
grads:  [-0.01908275 17.01846277]
Stock Position:  -0.019082745098868707
Bond Position:  [-8.6220245]


portfolio before change:  [-10.48259328]
curr_Stock_Price:  97.38708937275831
curr_Factors:  [9.73870894e+01 4.64937641e-02]
mat_Sqrt:  [[ 2.09990061e+01  0.00000000e+00]
 [-8.62496508e-03  1.97622777e-02]]
grads:  [4.22017702e-03 8.17376421e+00]
Stock Position:  0.004220177019980331
Bond Position:  [-10.89358404]


portfolio before change:  [-10.49312124]
curr_Stock_Price:  95.53782581633361
curr_Factors:  [9.55378258e+01 4.56669608e-02]
mat_Sqrt:  [[ 2.04162704e+01  0.00000000e+00]
 [-8.54793176e-03  1.95857722e-02]]
grads:  [-0.00955972  3.65005024]
Stock Position:  -0.00955972039277766
Bond Position:  [-9.57980633]


portfolio before change:  [-10.49126359]
curr_Stock_Price:  95.09294940015366
curr_Factors:  [9.50929494e+01 4.42969521e-02]
mat_Sqrt:  [[ 2.00140620e+01  0.00000000e+00]
 [-8.41873644e-03  1.92897485e-02]]
grads:  [0.00795272 0.57531875]
Stock Position:  0.007952716539584518
Bond Position:  [-11.24751086]


portfolio before change:  [-10.49759405]
curr_Stock_Price:  94.6505558820748
curr_Factors:  [9.46505559e+01 4.35748910e-02]
mat_Sqrt:  [[ 1.97579246e+01  0.00000000e+00]
 [-8.34983986e-03  1.91318866e-02]]
grads:  [-0.00649002 -2.66170839]
Stock Position:  -0.006490019325648926
Bond Position:  [-9.88331011]


portfolio before change:  [-10.48571172]
curr_Stock_Price:  92.43893419534133
curr_Factors:  [9.24389342e+01 4.51876305e-02]
mat_Sqrt:  [[ 1.96500977e+01  0.00000000e+00]
 [-8.50295295e-03  1.94827128e-02]]
grads:  [-0.00433195 -0.62981024]
Stock Position:  -0.004331947919581923
Bond Position:  [-10.08527107]


portfolio before change:  [-10.47965381]
curr_Stock_Price:  90.45840621626903
curr_Factors:  [9.04584062e+01 4.64866410e-02]
mat_Sqrt:  [[ 1.95035207e+01  0.00000000e+00]
 [-8.62430435e-03  1.97607638e-02]]
grads:  [ 0.01758559 -2.88093844]
Stock Position:  0.017585591213938576
Bond Position:  [-12.07041836]


portfolio before change:  [-10.48337322]
curr_Stock_Price:  90.41851981827315
curr_Factors:  [9.04185198e+01 4.66089244e-02]
mat_Sqrt:  [[ 1.95205448e+01  0.00000000e+00]
 [-8.63564005e-03  1.97867371e-02]]
grads:  [0.01207939 6.49989626]
Stock Position:  0.012079386104115434
Bond Position:  [-11.57557343]


portfolio before change:  [-10.49438413]
curr_Stock_Price:  89.7465772375454
curr_Factors:  [8.97465772e+01 4.67219565e-02]
mat_Sqrt:  [[ 1.93989581e+01  0.00000000e+00]
 [-8.64610493e-03  1.98107152e-02]]
grads:  [-0.01849508 -4.67120182]
Stock Position:  -0.01849507895584876
Bond Position:  [-8.83451409]


portfolio before change:  [-10.55143954]
curr_Stock_Price:  92.71204210490811
curr_Factors:  [9.27120421e+01 4.50654874e-02]
mat_Sqrt:  [[ 1.96814995e+01  0.00000000e+00]
 [-8.49145334e-03  1.94563638e-02]]
grads:  [0.00492183 0.82372437]
Stock Position:  0.004921829356316966
Bond Position:  [-11.00775239]


portfolio before change:  [-10.56000742]
curr_Stock_Price:  91.53044806030547
curr_Factors:  [9.15304481e+01 4.50981930e-02]
mat_Sqrt:  [[ 1.94377127e+01  0.00000000e+00]
 [-8.49453406e-03  1.94634227e-02]]
grads:  [-2.56709689e-04 -2.63805369e+00]
Stock Position:  -0.000256709688991224
Bond Position:  [-10.53651067]


portfolio before change:  [-10.56277676]
curr_Stock_Price:  92.05586433585242
curr_Factors:  [9.20558643e+01 4.49064573e-02]
mat_Sqrt:  [[ 1.95076905e+01  0.00000000e+00]
 [-8.47645749e-03  1.94220040e-02]]
grads:  [  0.04987152 -28.34589732]
Stock Position:  0.04987152409898124
Bond Position:  [-15.15374302]


portfolio before change:  [-10.5976399]
curr_Stock_Price:  91.43277869295976
curr_Factors:  [9.14327787e+01 4.44662915e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.5976399]
Stock Price:  92.30934129189413
PL:  [-10.5976399]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.07441654e-02  5.51470693e-04]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.55681752e-01 -5.22803923e-01]
 [-3.94361672e-02  2.75498170e-01]
 [-4.15702567e-01 -6.71038424e-02]
 [ 1.02758935e-01 -8.35727248e-02]
 [-4.03077597e-01  1.58851816e-01]
 [ 2.35997951e-02  1.54617137e-01]
 [-1.96157470e-01 -4.62421324e-02]
 [ 2.27276401e-01  6.52632101e-03]
 [-1.06004474e-01 -5.09235030e-02]
 [-2.14980289e-01  6.79946605e-02]
 [-1.25426185e-01  2.91552612e-02]
 [-1.31124104e-01 -2.35274189e-01]
 [-1.16585477e-01 -1.32935683e-01]
 [ 8.83890978e-02  6.42340136e-02]
 [ 5.56190753e-02 -8.29231677e-02]
 [ 5.11029644e-01 -2.68558345e-01]
 [ 2.08581957e-01  1.28870529e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.95035397]
curr_Stock_Price:  99.4827573046152
curr_Factors:  [9.94827573e+01 3.90365561e-02]
mat_Sqrt:  [[ 1.96554758e+01  0.00000000e+00]
 [-7.90306838e-03  1.81082045e-02]]
grads:  [0.00055887 0.03045419]
Stock Position:  0.0005588695511877467
Bond Position:  [-1.00595186]


portfolio before change:  [-0.94989133]
curr_Stock_Price:  100.7606209593849
curr_Factors:  [1.00760621e+02 4.05714535e-02]
mat_Sqrt:  [[ 2.02955637e+01  0.00000000e+00]
 [-8.05694270e-03  1.84607749e-02]]
grads:  [-0.00918057 -3.61046438]
Stock Position:  -0.009180571316532424
Bond Position:  [-0.02485127]


portfolio before change:  [-0.95275658]
curr_Stock_Price:  101.07204307743106
curr_Factors:  [1.01072043e+02 4.20033830e-02]
mat_Sqrt:  [[ 2.07144392e+01  0.00000000e+00]
 [-8.19789075e-03  1.87837275e-02]]
grads:  [-1.85306533e-02 -2.78328103e+01]
Stock Position:  -0.018530653256785233
Bond Position:  [0.9201744]


portfolio before change:  [-0.9058086]
curr_Stock_Price:  98.55092830803312
curr_Factors:  [9.85509283e+01 4.27269394e-02]
mat_Sqrt:  [[ 2.03709654e+01  0.00000000e+00]
 [-8.26819830e-03  1.89448223e-02]]
grads:  [3.96648317e-03 1.45421354e+01]
Stock Position:  0.0039664831687423845
Bond Position:  [-1.2967092]


portfolio before change:  [-0.91087203]
curr_Stock_Price:  97.35611345028785
curr_Factors:  [9.73561135e+01 4.31799522e-02]
mat_Sqrt:  [[ 2.02303924e+01  0.00000000e+00]
 [-8.31191455e-03  1.90449888e-02]]
grads:  [-0.02199607 -3.52343827]
Stock Position:  -0.021996067890993405
Bond Position:  [1.23057965]


portfolio before change:  [-0.9328856]
curr_Stock_Price:  98.3708971394865
curr_Factors:  [9.83708971e+01 4.14423482e-02]
mat_Sqrt:  [[ 2.00257509e+01  0.00000000e+00]
 [-8.14295752e-03  1.86578596e-02]]
grads:  [ 3.30997863e-03 -4.47922359e+00]
Stock Position:  0.0033099786313218423
Bond Position:  [-1.25849117]


portfolio before change:  [-0.93318619]
curr_Stock_Price:  98.37515043706034
curr_Factors:  [9.83751504e+01 4.39230716e-02]
mat_Sqrt:  [[ 2.06172986e+01  0.00000000e+00]
 [-8.38313274e-03  1.92081702e-02]]
grads:  [-0.01618781  8.27001295]
Stock Position:  -0.016187813312800222
Bond Position:  [0.65929238]


portfolio before change:  [-0.90154741]
curr_Stock_Price:  96.43085237122665
curr_Factors:  [9.64308524e+01 4.50523444e-02]
mat_Sqrt:  [[ 2.04679668e+01  0.00000000e+00]
 [-8.49021502e-03  1.94535265e-02]]
grads:  [4.44989222e-03 7.94802615e+00]
Stock Position:  0.004449892219500489
Bond Position:  [-1.33065431]


portfolio before change:  [-0.89148494]
curr_Stock_Price:  98.7669031344848
curr_Factors:  [9.87669031e+01 4.31760884e-02]
mat_Sqrt:  [[ 2.05226332e+01  0.00000000e+00]
 [-8.31154267e-03  1.90441367e-02]]
grads:  [-0.01054149 -2.42815587]
Stock Position:  -0.010541492821056242
Bond Position:  [0.14966566]


portfolio before change:  [-0.88241582]
curr_Stock_Price:  97.91012722791208
curr_Factors:  [9.79101272e+01 4.45514377e-02]
mat_Sqrt:  [[ 2.06660976e+01  0.00000000e+00]
 [-8.44288460e-03  1.93450789e-02]]
grads:  [0.01113537 0.33736337]
Stock Position:  0.011135373736986419
Bond Position:  [-1.97268168]


portfolio before change:  [-0.90662279]
curr_Stock_Price:  95.78054099853036
curr_Factors:  [9.57805410e+01 4.64566871e-02]
mat_Sqrt:  [[ 2.06443590e+01  0.00000000e+00]
 [-8.62152535e-03  1.97543963e-02]]
grads:  [-0.00621135 -2.5778314 ]
Stock Position:  -0.0062113486902178145
Bond Position:  [-0.31169645]


portfolio before change:  [-0.91639074]
curr_Stock_Price:  97.34059139472707
curr_Factors:  [9.73405914e+01 4.56753571e-02]
mat_Sqrt:  [[ 2.08034305e+01  0.00000000e+00]
 [-8.54871753e-03  1.95875726e-02]]
grads:  [-0.00890742  3.47131633]
Stock Position:  -0.008907424495929597
Bond Position:  [-0.04933677]


portfolio before change:  [-0.91258785]
curr_Stock_Price:  96.91227105887893
curr_Factors:  [9.69122711e+01 4.70477539e-02]
mat_Sqrt:  [[ 2.10207505e+01  0.00000000e+00]
 [-8.67619768e-03  1.98796663e-02]]
grads:  [-0.00536145  1.46658705]
Stock Position:  -0.005361453948024834
Bond Position:  [-0.39299717]


portfolio before change:  [-0.91876927]
curr_Stock_Price:  98.04688081338689
curr_Factors:  [9.80468808e+01 4.41766027e-02]
mat_Sqrt:  [[ 2.06077197e+01  0.00000000e+00]
 [-8.40729233e-03  1.92635267e-02]]
grads:  [-1.13455628e-02 -1.22134536e+01]
Stock Position:  -0.011345562821120472
Bond Position:  [0.19362778]


portfolio before change:  [-0.91591584]
curr_Stock_Price:  97.79964609014625
curr_Factors:  [9.77996461e+01 4.35716399e-02]
mat_Sqrt:  [[ 2.04145230e+01  0.00000000e+00]
 [-8.34952836e-03  1.91311729e-02]]
grads:  [-0.0085529 -6.9486426]
Stock Position:  -0.008552899584551207
Bond Position:  [-0.07944528]


portfolio before change:  [-0.90913281]
curr_Stock_Price:  97.00425582532809
curr_Factors:  [9.70042558e+01 4.39559051e-02]
mat_Sqrt:  [[ 2.03375860e+01  0.00000000e+00]
 [-8.38626545e-03  1.92153481e-02]]
grads:  [0.00572453 3.34284933]
Stock Position:  0.005724529931534278
Bond Position:  [-1.46443657]


portfolio before change:  [-0.91211707]
curr_Stock_Price:  96.5469070820687
curr_Factors:  [9.65469071e+01 4.17960242e-02]
mat_Sqrt:  [[ 1.97381230e+01  0.00000000e+00]
 [-8.17763039e-03  1.87373051e-02]]
grads:  [ 9.84310303e-04 -4.42556532e+00]
Stock Position:  0.0009843103032807978
Bond Position:  [-1.00714918]


portfolio before change:  [-0.90901767]
curr_Stock_Price:  99.95154612576512
curr_Factors:  [9.99515461e+01 3.81968086e-02]
mat_Sqrt:  [[ 1.95345340e+01  0.00000000e+00]
 [-7.81760153e-03  1.79123754e-02]]
grads:  [  0.02016025 -14.99289398]
Stock Position:  0.020160254311841434
Bond Position:  [-2.92406626]


portfolio before change:  [-0.92574757]
curr_Stock_Price:  99.15796514848387
curr_Factors:  [9.91579651e+01 3.94576447e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.92574757]
Stock Price:  99.2179642026643
PL:  [-0.92574757]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.07261986e-01  6.98440204e-02]
 [-1.54031960e-01 -6.56469145e-02]
 [-1.19599452e-01 -2.76619524e-01]
 [ 2.62947356e-01 -1.45842086e-01]
 [-1.86002789e-01 -8.67977006e-02]
 [ 6.19677420e-01 -8.35113940e-01]
 [-5.65619640e-01  3.78171290e-01]
 [ 3.20751456e-01  1.57883892e-01]
 [ 2.39110213e-02 -6.75274657e-02]
 [ 1.78747323e-01  1.44927681e-02]
 [ 1.18007350e-01  1.84346261e-01]
 [-2.37422194e-01  8.53892675e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.64351947e-01 -2.67283444e-01]
 [ 1.33397339e-01 -1.56936505e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.25926253e-02  6.39813271e-02]
 [ 2.49793814e-01 -1.58906101e-01]
 [ 7.33443118e-02 -1.87511847e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.48575066]
curr_Stock_Price:  100.27182577759328
curr_Factors:  [1.00271826e+02 4.17498079e-02]
mat_Sqrt:  [[ 2.04883113e+01  0.00000000e+00]
 [-8.17310789e-03  1.87269428e-02]]
grads:  [-0.00374748  3.72960078]
Stock Position:  -0.0037474809486449834
Bond Position:  [4.86151742]


portfolio before change:  [4.484229]
curr_Stock_Price:  101.00223367263206
curr_Factors:  [1.01002234e+02 4.31359459e-02]
mat_Sqrt:  [[ 2.09773508e+01  0.00000000e+00]
 [-8.30767798e-03  1.90352816e-02]]
grads:  [-0.00870856 -3.44869679]
Stock Position:  -0.008708564968986266
Bond Position:  [5.36381352]


portfolio before change:  [4.46704095]
curr_Stock_Price:  103.12992979042342
curr_Factors:  [1.03129930e+02 4.52383274e-02]
mat_Sqrt:  [[ 2.19350178e+01  0.00000000e+00]
 [-8.50772143e-03  1.94936387e-02]]
grads:  [-1.09562760e-02 -1.41902457e+01]
Stock Position:  -0.010956275995386879
Bond Position:  [5.59696092]


portfolio before change:  [4.4680876]
curr_Stock_Price:  103.16212646355733
curr_Factors:  [1.03162126e+02 4.46480824e-02]
mat_Sqrt:  [[ 2.17982531e+01  0.00000000e+00]
 [-8.45203714e-03  1.93660500e-02]]
grads:  [ 0.00914278 -7.53081221]
Stock Position:  0.009142780844167989
Bond Position:  [3.52489889]


portfolio before change:  [4.45872154]
curr_Stock_Price:  102.04130826102133
curr_Factors:  [1.02041308e+02 4.49640097e-02]
mat_Sqrt:  [[ 2.16375724e+01  0.00000000e+00]
 [-8.48188750e-03  1.94344457e-02]]
grads:  [-0.01034702 -4.46617834]
Stock Position:  -0.010347020778386198
Bond Position:  [5.51454508]


portfolio before change:  [4.44618805]
curr_Stock_Price:  103.38587874665151
curr_Factors:  [1.03385879e+02 4.30303802e-02]
mat_Sqrt:  [[ 2.14461241e+01  0.00000000e+00]
 [-8.29750615e-03  1.90119750e-02]]
grads:  [ 1.18997640e-02 -4.39256805e+01]
Stock Position:  0.011899764010065525
Bond Position:  [3.2159205]


portfolio before change:  [4.43404322]
curr_Stock_Price:  102.29771288786478
curr_Factors:  [1.02297713e+02 4.36223037e-02]
mat_Sqrt:  [[ 2.13658523e+01  0.00000000e+00]
 [-8.35438124e-03  1.91422922e-02]]
grads:  [-1.87482414e-02  1.97557997e+01]
Stock Position:  -0.018748241406299736
Bond Position:  [6.35194543]


portfolio before change:  [4.43568619]
curr_Stock_Price:  102.29479063888246
curr_Factors:  [1.02294791e+02 4.47932653e-02]
mat_Sqrt:  [[ 2.16500986e+01  0.00000000e+00]
 [-8.46576780e-03  1.93975109e-02]]
grads:  [0.01799796 8.13938929]
Stock Position:  0.01799796126065693
Bond Position:  [2.59458851]


portfolio before change:  [4.45651628]
curr_Stock_Price:  103.41610440791177
curr_Factors:  [1.03416104e+02 4.22299367e-02]
mat_Sqrt:  [[ 2.12519306e+01  0.00000000e+00]
 [-8.21996951e-03  1.88343163e-02]]
grads:  [-2.61641214e-04 -3.58534203e+00]
Stock Position:  -0.0002616412142618242
Bond Position:  [4.4835742]


portfolio before change:  [4.45771279]
curr_Stock_Price:  103.12764142723468
curr_Factors:  [1.03127641e+02 4.12370832e-02]
mat_Sqrt:  [[ 2.09420434e+01  0.00000000e+00]
 [-8.12276634e-03  1.86115958e-02]]
grads:  [0.00883737 0.77869562]
Stock Position:  0.008837365212894856
Bond Position:  [3.54633616]


portfolio before change:  [4.44140919]
curr_Stock_Price:  101.18245846702129
curr_Factors:  [1.01182458e+02 4.19941391e-02]
mat_Sqrt:  [[ 2.07347865e+01  0.00000000e+00]
 [-8.19698862e-03  1.87816604e-02]]
grads:  [9.57148290e-03 9.81522704e+00]
Stock Position:  0.009571482903999019
Bond Position:  [3.47294302]


portfolio before change:  [4.44046276]
curr_Stock_Price:  100.99285644536067
curr_Factors:  [1.00992856e+02 4.13554000e-02]
mat_Sqrt:  [[ 2.05379347e+01  0.00000000e+00]
 [-8.13441086e-03  1.86382767e-02]]
grads:  [-0.00974564  4.58139284]
Stock Position:  -0.009745637283207799
Bond Position:  [5.42470251]


portfolio before change:  [4.43545353]
curr_Stock_Price:  101.64602845493827
curr_Factors:  [1.01646028e+02 3.94589690e-02]
mat_Sqrt:  [[ 2.01912535e+01  0.00000000e+00]
 [-7.94571270e-03  1.82059150e-02]]
grads:  [3.28979701e-04 2.16224798e+00]
Stock Position:  0.0003289797013125924
Bond Position:  [4.40201405]


portfolio before change:  [4.43652742]
curr_Stock_Price:  101.5647159236318
curr_Factors:  [1.01564716e+02 3.91045139e-02]
mat_Sqrt:  [[ 2.00842817e+01  0.00000000e+00]
 [-7.90994451e-03  1.81239597e-02]]
grads:  [ -0.01897026 -14.74751918]
Stock Position:  -0.01897025800004441
Bond Position:  [6.36323629]


portfolio before change:  [4.41706387]
curr_Stock_Price:  102.67458809683076
curr_Factors:  [1.02674588e+02 3.99469350e-02]
mat_Sqrt:  [[ 2.05212920e+01  0.00000000e+00]
 [-7.99469174e-03  1.83181400e-02]]
grads:  [ 0.00616667 -0.85672729]
Stock Position:  0.006166671581801663
Bond Position:  [3.7839034]


portfolio before change:  [4.4189693]
curr_Stock_Price:  102.83015588458548
curr_Factors:  [1.02830156e+02 3.95838929e-02]
mat_Sqrt:  [[ 2.04587806e+01  0.00000000e+00]
 [-7.95828051e-03  1.82347114e-02]]
grads:  [0.00469216 0.9614112 ]
Stock Position:  0.0046921628411757035
Bond Position:  [3.93647346]


portfolio before change:  [4.4234276]
curr_Stock_Price:  103.57055165266
curr_Factors:  [1.03570552e+02 4.19470507e-02]
mat_Sqrt:  [[ 2.12122631e+01  0.00000000e+00]
 [-8.19239166e-03  1.87711275e-02]]
grads:  [-1.16295394e-03  3.40849676e+00]
Stock Position:  -0.0011629539389619065
Bond Position:  [4.54387538]


portfolio before change:  [4.42369272]
curr_Stock_Price:  104.31949740536338
curr_Factors:  [1.04319497e+02 4.20794403e-02]
mat_Sqrt:  [[ 2.13993442e+01  0.00000000e+00]
 [-8.20530953e-03  1.88007260e-02]]
grads:  [ 8.43210451e-03 -8.45212576e+00]
Stock Position:  0.008432104512552952
Bond Position:  [3.54405981]


portfolio before change:  [4.43749637]
curr_Stock_Price:  105.85144335452833
curr_Factors:  [1.05851443e+02 4.21516756e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.43749637]
Stock Price:  105.80237932405727
PL:  [-1.36488295]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.34067883e-02  2.81235043e-01]
 [ 1.54975560e-01 -2.37395248e-02]
 [-1.22177298e-01 -2.94207803e-01]
 [ 2.26957378e-01 -8.55762455e-02]
 [-1.62100045e-01 -8.29034396e-02]
 [ 3.55259476e-01 -4.24688397e-01]
 [-4.93614161e-01  1.97434461e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-1.98357765e-01 -3.76692913e-02]
 [ 3.07386998e-01  6.22819503e-03]
 [ 9.68295290e-02  1.66061147e-01]
 [-2.36144251e-01  6.04783796e-02]
 [-9.65223295e-02  3.25101527e-02]
 [-1.92672980e-01 -2.62564590e-01]
 [-8.91944664e-02 -1.19797865e-01]
 [ 9.12349141e-02  5.35396272e-02]
 [ 1.29165946e-02 -6.17746395e-02]
 [ 5.56214709e-01 -2.81729547e-01]
 [ 2.17247950e-01  1.27119862e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.55366169]
curr_Stock_Price:  101.73321618673819
curr_Factors:  [1.01733216e+02 4.14833923e-02]
mat_Sqrt:  [[ 2.07204845e+01  0.00000000e+00]
 [-8.14698887e-03  1.86670966e-02]]
grads:  [7.53591567e-03 1.50658160e+01]
Stock Position:  0.007535915665950878
Bond Position:  [13.78700875]


portfolio before change:  [14.56544691]
curr_Stock_Price:  102.8396569171621
curr_Factors:  [1.02839657e+02 3.92646126e-02]
mat_Sqrt:  [[ 2.03779868e+01  0.00000000e+00]
 [-7.92612012e-03  1.81610227e-02]]
grads:  [ 0.00709662 -1.30716894]
Stock Position:  0.007096617700933444
Bond Position:  [13.83563318]


portfolio before change:  [14.56968852]
curr_Stock_Price:  102.94988722502806
curr_Factors:  [1.02949887e+02 3.91582197e-02]
mat_Sqrt:  [[ 2.03721725e+01  0.00000000e+00]
 [-7.91537438e-03  1.81364011e-02]]
grads:  [-1.23001172e-02 -1.62219506e+01]
Stock Position:  -0.012300117239284643
Bond Position:  [15.8359842]


portfolio before change:  [14.58039059]
curr_Stock_Price:  102.40171508252004
curr_Factors:  [1.02401715e+02 3.91837082e-02]
mat_Sqrt:  [[ 2.02702917e+01  0.00000000e+00]
 [-7.91795006e-03  1.81423027e-02]]
grads:  [ 0.00935403 -4.71694507]
Stock Position:  0.009354026351438763
Bond Position:  [13.62252225]


portfolio before change:  [14.58511877]
curr_Stock_Price:  102.54305804833216
curr_Factors:  [1.02543058e+02 4.12235405e-02]
mat_Sqrt:  [[ 2.08199129e+01  0.00000000e+00]
 [-8.12143243e-03  1.86085394e-02]]
grads:  [-0.00952367 -4.45512878]
Stock Position:  -0.009523674403865402
Bond Position:  [15.56170547]


portfolio before change:  [14.61172209]
curr_Stock_Price:  100.15822160193532
curr_Factors:  [1.00158222e+02 4.44487394e-02]
mat_Sqrt:  [[ 2.11162273e+01  0.00000000e+00]
 [-8.43314787e-03  1.93227692e-02]]
grads:  [ 8.04643087e-03 -2.19786508e+01]
Stock Position:  0.008046430872295741
Bond Position:  [13.80580588]


portfolio before change:  [14.61011015]
curr_Stock_Price:  99.52889679948223
curr_Factors:  [9.95288968e+01 4.24979982e-02]
mat_Sqrt:  [[ 2.05179245e+01  0.00000000e+00]
 [-8.24601705e-03  1.88939987e-02]]
grads:  [-0.01985809 10.44958583]
Stock Position:  -0.019858085473217824
Bond Position:  [16.58656349]


portfolio before change:  [14.61667387]
curr_Stock_Price:  99.40720533821134
curr_Factors:  [9.94072053e+01 4.27051483e-02]
mat_Sqrt:  [[ 2.05427217e+01  0.00000000e+00]
 [-8.26608960e-03  1.89399906e-02]]
grads:  [4.76106097e-03 7.16573663e+00]
Stock Position:  0.004761060970951504
Bond Position:  [14.14339011]


portfolio before change:  [14.61607945]
curr_Stock_Price:  98.53960248620946
curr_Factors:  [9.85396025e+01 4.27722160e-02]
mat_Sqrt:  [[ 2.03794135e+01  0.00000000e+00]
 [-8.27257793e-03  1.89548573e-02]]
grads:  [-0.01053995 -1.98731601]
Stock Position:  -0.010539949615247632
Bond Position:  [15.6546819]


portfolio before change:  [14.5933567]
curr_Stock_Price:  101.06683600758878
curr_Factors:  [1.01066836e+02 4.07015621e-02]
mat_Sqrt:  [[ 2.03898583e+01  0.00000000e+00]
 [-8.06985126e-03  1.84903521e-02]]
grads:  [0.0152088  0.33683485]
Stock Position:  0.01520879645568358
Bond Position:  [13.05625176]


portfolio before change:  [14.58676994]
curr_Stock_Price:  100.41910369822996
curr_Factors:  [1.00419104e+02 4.09702601e-02]
mat_Sqrt:  [[ 2.03259429e+01  0.00000000e+00]
 [-8.09644466e-03  1.85512853e-02]]
grads:  [8.32948101e-03 8.95146320e+00]
Stock Position:  0.008329481013316148
Bond Position:  [13.75033092]


portfolio before change:  [14.57532291]
curr_Stock_Price:  98.63207280605708
curr_Factors:  [9.86320728e+01 4.24471193e-02]
mat_Sqrt:  [[ 2.03208688e+01  0.00000000e+00]
 [-8.24107947e-03  1.88826852e-02]]
grads:  [-0.01032187  3.20284847]
Stock Position:  -0.010321867861513291
Bond Position:  [15.59339014]


portfolio before change:  [14.58607238]
curr_Stock_Price:  97.96837185281066
curr_Factors:  [9.79683719e+01 4.44457145e-02]
mat_Sqrt:  [[ 2.06538413e+01  0.00000000e+00]
 [-8.43286091e-03  1.93221117e-02]]
grads:  [-0.00398636  1.68253621]
Stock Position:  -0.00398636429429908
Bond Position:  [14.97661]


portfolio before change:  [14.58503506]
curr_Stock_Price:  99.16794629617007
curr_Factors:  [9.91679463e+01 4.61007297e-02]
mat_Sqrt:  [[ 2.12924296e+01  0.00000000e+00]
 [-8.58843219e-03  1.96785703e-02]]
grads:  [ -0.01443074 -13.34266595]
Stock Position:  -0.014430742199581185
Bond Position:  [16.01610213]


portfolio before change:  [14.58621077]
curr_Stock_Price:  99.36397326990598
curr_Factors:  [9.93639733e+01 5.06581711e-02]
mat_Sqrt:  [[ 2.23642173e+01  0.00000000e+00]
 [-9.00294806e-03  2.06283455e-02]]
grads:  [-0.00632611 -5.80743935]
Stock Position:  -0.006326111912764988
Bond Position:  [15.21479839]


portfolio before change:  [14.5912491]
curr_Stock_Price:  99.1688842778366
curr_Factors:  [9.91688843e+01 5.07367910e-02]
mat_Sqrt:  [[ 2.23376214e+01  0.00000000e+00]
 [-9.00993150e-03  2.06443466e-02]]
grads:  [0.00513043 2.59342804]
Stock Position:  0.00513042643268594
Bond Position:  [14.08247044]


portfolio before change:  [14.59080747]
curr_Stock_Price:  98.39649437626575
curr_Factors:  [9.83964944e+01 5.37070260e-02]
mat_Sqrt:  [[ 2.28031675e+01  0.00000000e+00]
 [-9.26991055e-03  2.12400334e-02]]
grads:  [-6.15882348e-04 -2.90840595e+00]
Stock Position:  -0.0006158823480180025
Bond Position:  [14.65140813]


portfolio before change:  [14.59399036]
curr_Stock_Price:  99.1765428075639
curr_Factors:  [9.91765428e+01 5.41461028e-02]
mat_Sqrt:  [[ 2.30777023e+01  0.00000000e+00]
 [-9.30772607e-03  2.13266796e-02]]
grads:  [  0.01877387 -13.21019267]
Stock Position:  0.018773873100455057
Bond Position:  [12.73206253]


portfolio before change:  [14.60375819]
curr_Stock_Price:  99.52726483324152
curr_Factors:  [9.95272648e+01 5.13073276e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.60375819]
Stock Price:  98.67115521394742
PL:  [14.60375819]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.18492447e-02  1.98198638e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.83688150e-01 -7.13887589e-01]
 [-5.34114805e-03  2.70714331e-01]
 [-4.55986330e-01 -1.24056691e-01]
 [-2.84165115e-02  8.72777174e-02]
 [-2.90820930e-01  1.02358136e-01]
 [ 1.99504970e-02  1.59223176e-01]
 [-2.26674037e-01  7.26572199e-02]
 [ 1.76685984e-01  9.69642354e-03]
 [ 4.14514909e-02  1.18340077e-01]
 [-2.36444179e-01  6.63248594e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.37647433e-01 -2.74097550e-01]
 [-5.74781758e-02 -1.06180281e-01]
 [ 8.84432679e-02  7.04466287e-02]
 [ 2.78359424e-02 -6.91707844e-02]
 [ 7.77397719e-01 -3.69524383e-01]
 [ 1.48649744e-01  1.62975767e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.59010837]
curr_Stock_Price:  101.15789338317644
curr_Factors:  [1.01157893e+02 3.89710446e-02]
mat_Sqrt:  [[ 1.99696660e+01  0.00000000e+00]
 [-7.89643410e-03  1.80930035e-02]]
grads:  [3.23749694e-03 1.09544354e+01]
Stock Position:  0.0032374969428442344
Bond Position:  [10.26261]


portfolio before change:  [10.58698833]
curr_Stock_Price:  99.40159339995009
curr_Factors:  [9.94015934e+01 3.87287913e-02]
mat_Sqrt:  [[ 1.95618677e+01  0.00000000e+00]
 [-7.87185277e-03  1.80366806e-02]]
grads:  [-0.0095249 -3.6953568]
Stock Position:  -0.009524901865809078
Bond Position:  [11.53377875]


portfolio before change:  [10.58887425]
curr_Stock_Price:  99.50635964994454
curr_Factors:  [9.95063596e+01 3.93291777e-02]
mat_Sqrt:  [[ 1.97336886e+01  0.00000000e+00]
 [-7.93263414e-03  1.81759482e-02]]
grads:  [-2.50968912e-02 -3.92764978e+01]
Stock Position:  -0.02509689121239588
Bond Position:  [13.08617453]


portfolio before change:  [10.59943224]
curr_Stock_Price:  99.21604345032715
curr_Factors:  [9.92160435e+01 3.93778555e-02]
mat_Sqrt:  [[ 1.96882871e+01  0.00000000e+00]
 [-7.93754174e-03  1.81871929e-02]]
grads:  [5.72971489e-03 1.48848881e+01]
Stock Position:  0.0057297148944993
Bond Position:  [10.03095259]


portfolio before change:  [10.60180158]
curr_Stock_Price:  99.1918348432803
curr_Factors:  [9.91918348e+01 4.03431845e-02]
mat_Sqrt:  [[ 1.99232880e+01  0.00000000e+00]
 [-8.03424516e-03  1.84087683e-02]]
grads:  [-0.02560466 -6.73900008]
Stock Position:  -0.02560466472480145
Bond Position:  [13.14157525]


portfolio before change:  [10.64579246]
curr_Stock_Price:  97.60208262342235
curr_Factors:  [9.76020826e+01 4.19491796e-02]
mat_Sqrt:  [[ 1.99903695e+01  0.00000000e+00]
 [-8.19259955e-03  1.87716038e-02]]
grads:  [4.83963405e-04 4.64945449e+00]
Stock Position:  0.00048396340451027663
Bond Position:  [10.59855662]


portfolio before change:  [10.64768804]
curr_Stock_Price:  96.04331635945016
curr_Factors:  [9.60433164e+01 4.10754895e-02]
mat_Sqrt:  [[ 1.94651844e+01  0.00000000e+00]
 [-8.10683559e-03  1.85750939e-02]]
grads:  [-0.01264556  5.51050437]
Stock Position:  -0.012645561031151062
Bond Position:  [11.86220966]


portfolio before change:  [10.6381819]
curr_Stock_Price:  97.02959606423377
curr_Factors:  [9.70295961e+01 4.21363992e-02]
mat_Sqrt:  [[ 1.99174132e+01  0.00000000e+00]
 [-8.21086102e-03  1.88134461e-02]]
grads:  [4.49060263e-03 8.46326481e+00]
Stock Position:  0.004490602628336408
Bond Position:  [10.20246054]


portfolio before change:  [10.63404245]
curr_Stock_Price:  95.53973247918424
curr_Factors:  [9.55397325e+01 4.31547790e-02]
mat_Sqrt:  [[ 1.98471645e+01  0.00000000e+00]
 [-8.30949135e-03  1.90394365e-02]]
grads:  [-0.00982326  3.81614339]
Stock Position:  -0.009823258461315244
Bond Position:  [11.57255394]


portfolio before change:  [10.63380322]
curr_Stock_Price:  95.85864232287042
curr_Factors:  [9.58586423e+01 4.31224338e-02]
mat_Sqrt:  [[ 1.99059499e+01  0.00000000e+00]
 [-8.30637671e-03  1.90323000e-02]]
grads:  [0.00908863 0.50947198]
Stock Position:  0.009088631884147385
Bond Position:  [9.76257931]


portfolio before change:  [10.66827499]
curr_Stock_Price:  99.3829153864746
curr_Factors:  [9.93829154e+01 4.22548932e-02]
mat_Sqrt:  [[ 2.04291472e+01  0.00000000e+00]
 [-8.22239801e-03  1.88398806e-02]]
grads:  [4.55718167e-03 6.28136023e+00]
Stock Position:  0.00455718166553664
Bond Position:  [10.21536899]


portfolio before change:  [10.6721954]
curr_Stock_Price:  99.68271787933
curr_Factors:  [9.96827179e+01 4.42583692e-02]
mat_Sqrt:  [[ 2.09709244e+01  0.00000000e+00]
 [-8.41506926e-03  1.92813459e-02]]
grads:  [-0.00989454  3.43984593]
Stock Position:  -0.009894539365350775
Bond Position:  [11.65850998]


portfolio before change:  [10.6638922]
curr_Stock_Price:  100.81649411419069
curr_Factors:  [1.00816494e+02 4.34184136e-02]
mat_Sqrt:  [[ 2.10072192e+01  0.00000000e+00]
 [-8.33483423e-03  1.90975044e-02]]
grads:  [3.16201421e-04 2.06130090e+00]
Stock Position:  0.0003162014205677096
Bond Position:  [10.63201388]


portfolio before change:  [10.6665181]
curr_Stock_Price:  100.71390576067407
curr_Factors:  [1.00713906e+02 4.34267460e-02]
mat_Sqrt:  [[ 2.09878563e+01  0.00000000e+00]
 [-8.33563397e-03  1.90993368e-02]]
grads:  [ -0.01702286 -14.35115535]
Stock Position:  -0.017022863385419397
Bond Position:  [12.38095716]


portfolio before change:  [10.67942124]
curr_Stock_Price:  100.13776807041546
curr_Factors:  [1.00137768e+02 4.34016664e-02]
mat_Sqrt:  [[ 2.08617679e+01  0.00000000e+00]
 [-8.33322664e-03  1.90938209e-02]]
grads:  [-4.97652213e-03 -5.56097608e+00]
Stock Position:  -0.004976522132159365
Bond Position:  [11.17775906]


portfolio before change:  [10.69161266]
curr_Stock_Price:  98.24957664356857
curr_Factors:  [9.82495766e+01 4.40400897e-02]
mat_Sqrt:  [[ 2.06183917e+01  0.00000000e+00]
 [-8.39429232e-03  1.92337400e-02]]
grads:  [0.0057807  3.66265889]
Stock Position:  0.005780698086635709
Bond Position:  [10.12366152]


portfolio before change:  [10.69130841]
curr_Stock_Price:  97.75906880983226
curr_Factors:  [9.77590688e+01 4.30884453e-02]
mat_Sqrt:  [[ 2.02925894e+01  0.00000000e+00]
 [-8.30310258e-03  1.90247980e-02]]
grads:  [-1.15937044e-04 -3.63582227e+00]
Stock Position:  -0.00011593704434221672
Bond Position:  [10.70264231]


portfolio before change:  [10.69410973]
curr_Stock_Price:  96.67810454486525
curr_Factors:  [9.66781045e+01 4.51716631e-02]
mat_Sqrt:  [[ 2.05476031e+01  0.00000000e+00]
 [-8.50145052e-03  1.94792703e-02]]
grads:  [  0.0299852  -18.97013481]
Stock Position:  0.02998520336611755
Bond Position:  [7.7951971]


portfolio before change:  [10.64650862]
curr_Stock_Price:  95.02561766705335
curr_Factors:  [9.50256177e+01 4.58161586e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.64650862]
Stock Price:  96.13674854876639
PL:  [10.64650862]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.56051891e-01  4.70377832e-01]
 [ 1.49407332e-01 -2.44577978e-02]
 [-8.63173310e-02 -4.95403529e-02]
 [ 3.49590126e-01 -2.90926903e-01]
 [-8.55064413e-02 -6.38962738e-02]
 [ 7.16133625e-01 -9.84325248e-01]
 [-6.20813259e-01  5.87549010e-01]
 [ 5.92220669e-01  1.79207561e-01]
 [-2.88884025e-02 -4.89676979e-02]
 [ 2.93092761e-01  7.25739200e-03]
 [-3.02516902e-02  4.85483990e-02]
 [-2.36763205e-01  7.25436295e-02]
 [-2.74487695e-02  3.75726771e-02]
 [-2.10575536e-01 -2.67582580e-01]
 [-9.70468473e-02 -1.23564179e-01]
 [ 8.83853384e-02  5.45497813e-02]
 [ 5.81272745e-02 -8.34075432e-02]
 [ 7.27206695e-01 -3.48503515e-01]
 [ 1.82185597e-01  1.39154449e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.67491512]
curr_Stock_Price:  103.05719613269136
curr_Factors:  [1.03057196e+02 3.80341116e-02]
mat_Sqrt:  [[ 2.00985608e+01  0.00000000e+00]
 [-7.80093447e-03  1.78741863e-02]]
grads:  [1.79784816e-02 2.63160416e+01]
Stock Position:  0.017978481626462997
Bond Position:  [21.82210322]


portfolio before change:  [23.67427128]
curr_Stock_Price:  102.71789851071418
curr_Factors:  [1.02717899e+02 3.79142683e-02]
mat_Sqrt:  [[ 2.00008045e+01  0.00000000e+00]
 [-7.78863462e-03  1.78460039e-02]]
grads:  [ 0.00693637 -1.37049156]
Stock Position:  0.006936374686266127
Bond Position:  [22.96178144]


portfolio before change:  [23.69556279]
curr_Stock_Price:  104.95975433140758
curr_Factors:  [1.04959754e+02 3.61134029e-02]
mat_Sqrt:  [[ 1.9946055e+01  0.0000000e+00]
 [-7.6014107e-03  1.7417020e-02]]
grads:  [-0.00541152 -2.84436448]
Stock Position:  -0.005411521910509014
Bond Position:  [24.2635548]


portfolio before change:  [23.70142229]
curr_Stock_Price:  104.99803363224827
curr_Factors:  [1.04998034e+02 3.61279618e-02]
mat_Sqrt:  [[ 1.99573510e+01  0.00000000e+00]
 [-7.60294278e-03  1.74205304e-02]]
grads:  [ 1.11547477e-02 -1.67002322e+01]
Stock Position:  0.011154747717149768
Bond Position:  [22.53019571]


portfolio before change:  [23.71133132]
curr_Stock_Price:  105.38134835792621
curr_Factors:  [1.05381348e+02 3.53304341e-02]
mat_Sqrt:  [[ 1.98078910e+01  0.00000000e+00]
 [-7.51855668e-03  1.72271776e-02]]
grads:  [-0.00572464 -3.70903902]
Stock Position:  -0.0057246408168689766
Bond Position:  [24.31460169]


portfolio before change:  [23.72244054]
curr_Stock_Price:  104.50272311364128
curr_Factors:  [1.04502723e+02 3.62704336e-02]
mat_Sqrt:  [[ 1.99023327e+01  0.00000000e+00]
 [-7.61791925e-03  1.74548458e-02]]
grads:  [ 1.43972504e-02 -5.63926636e+01]
Stock Position:  0.014397250407948254
Bond Position:  [22.21788867]


portfolio before change:  [23.74271541]
curr_Stock_Price:  105.5251194038877
curr_Factors:  [1.05525119e+02 3.57217967e-02]
mat_Sqrt:  [[ 1.99444700e+01  0.00000000e+00]
 [-7.56008431e-03  1.73223293e-02]]
grads:  [-1.82700191e-02  3.39185914e+01]
Stock Position:  -0.0182700191360076
Bond Position:  [25.67066136]


portfolio before change:  [23.75867768]
curr_Stock_Price:  105.00274403075441
curr_Factors:  [1.05002744e+02 3.61753854e-02]
mat_Sqrt:  [[ 1.99713412e+01  0.00000000e+00]
 [-7.60793116e-03  1.74319602e-02]]
grads:  [ 0.03356977 10.28040214]
Stock Position:  0.03356976649955931
Bond Position:  [20.23376008]


portfolio before change:  [23.69756513]
curr_Stock_Price:  103.03157664784119
curr_Factors:  [1.03031577e+02 3.93129753e-02]
mat_Sqrt:  [[ 2.04285858e+01  0.00000000e+00]
 [-7.93099996e-03  1.81722038e-02]]
grads:  [-2.46026125e-03 -2.69464828e+00]
Stock Position:  -0.002460261250088161
Bond Position:  [23.95104972]


portfolio before change:  [23.70786152]
curr_Stock_Price:  101.28059183519929
curr_Factors:  [1.01280592e+02 3.97902534e-02]
mat_Sqrt:  [[ 2.02029404e+01  0.00000000e+00]
 [-7.97899778e-03  1.82821806e-02]]
grads:  [0.01466421 0.39696534]
Stock Position:  0.014664209301250576
Bond Position:  [22.22266172]


portfolio before change:  [23.66699109]
curr_Stock_Price:  98.11459868882001
curr_Factors:  [9.81145987e+01 3.87697602e-02]
mat_Sqrt:  [[ 1.93188019e+01  0.00000000e+00]
 [-7.87601526e-03  1.80462180e-02]]
grads:  [-4.69150822e-04  2.69022567e+00]
Stock Position:  -0.0004691508222434268
Bond Position:  [23.71302164]


portfolio before change:  [23.6719828]
curr_Stock_Price:  100.11242996545671
curr_Factors:  [1.00112430e+02 3.86031209e-02]
mat_Sqrt:  [[ 1.96697668e+01  0.00000000e+00]
 [-7.85907077e-03  1.80073934e-02]]
grads:  [-0.0104273   4.02854695]
Stock Position:  -0.010427300514729506
Bond Position:  [24.7158852]


portfolio before change:  [23.6794505]
curr_Stock_Price:  99.98891235768687
curr_Factors:  [9.99889124e+01 3.83533324e-02]
mat_Sqrt:  [[ 1.95818354e+01  0.00000000e+00]
 [-7.83360274e-03  1.79490388e-02]]
grads:  [-5.64334680e-04  2.09329745e+00]
Stock Position:  -0.0005643346799170612
Bond Position:  [23.73587771]


portfolio before change:  [23.68548704]
curr_Stock_Price:  99.80847070430009
curr_Factors:  [9.98084707e+01 3.79910900e-02]
mat_Sqrt:  [[ 1.94539716e+01  0.00000000e+00]
 [-7.79652127e-03  1.78640744e-02]]
grads:  [ -0.01682732 -14.97881019]
Stock Position:  -0.016827317055678116
Bond Position:  [25.36499582]


portfolio before change:  [23.70835982]
curr_Stock_Price:  98.8260959141685
curr_Factors:  [9.88260959e+01 3.82821495e-02]
mat_Sqrt:  [[ 1.93361406e+01  0.00000000e+00]
 [-7.82632986e-03  1.79323745e-02]]
grads:  [-0.0078079  -6.89056429]
Stock Position:  -0.007807901232538286
Bond Position:  [24.47998421]


portfolio before change:  [23.73424935]
curr_Stock_Price:  96.29420267226307
curr_Factors:  [9.62942027e+01 3.97199870e-02]
mat_Sqrt:  [[ 1.91913131e+01  0.00000000e+00]
 [-7.97194953e-03  1.82660311e-02]]
grads:  [0.00584602 2.98640581]
Stock Position:  0.005846020761258696
Bond Position:  [23.17131144]


portfolio before change:  [23.73762012]
curr_Stock_Price:  95.87977035044423
curr_Factors:  [9.58797704e+01 4.00986304e-02]
mat_Sqrt:  [[ 1.91995812e+01  0.00000000e+00]
 [-8.00985697e-03  1.83528879e-02]]
grads:  [ 1.13154751e-03 -4.54465497e+00]
Stock Position:  0.0011315475108304336
Bond Position:  [23.62912761]


portfolio before change:  [23.74504572]
curr_Stock_Price:  97.2209210712847
curr_Factors:  [9.72209211e+01 3.93965641e-02]
mat_Sqrt:  [[ 1.92969604e+01  0.00000000e+00]
 [-7.93942709e-03  1.81915128e-02]]
grads:  [  0.029803   -19.15747849]
Stock Position:  0.029802999026114177
Bond Position:  [20.8475707]


portfolio before change:  [23.7632975]
curr_Stock_Price:  97.65843538752348
curr_Factors:  [9.76584354e+01 3.64181991e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.7632975]
Stock Price:  98.18578599121855
PL:  [23.7632975]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.97707057e-02  1.41211887e-01]
 [-3.28707643e-02 -3.20119750e-02]
 [-1.41766365e-01 -4.27861217e-01]
 [ 1.61651053e-02  2.49233003e-01]
 [-3.44253289e-01 -1.06566380e-01]
 [ 3.69916306e-01 -4.47548782e-01]
 [-5.48072218e-01  3.39421802e-01]
 [ 2.11515048e-01  1.49303468e-01]
 [-1.25179613e-01 -2.50119842e-02]
 [ 1.24492146e-01  1.74352438e-02]
 [ 2.33419502e-01  3.46781891e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-1.07461086e-01  1.28357776e-01]
 [-2.13392728e-01  5.38978316e-02]
 [ 2.38143961e-01  2.64935116e-01]
 [ 7.93905163e-02  2.60563932e-02]
 [-5.31836663e-02  2.62166038e-01]
 [ 1.16156413e-01  5.90963510e-02]
 [ 8.08695202e-02 -1.17950175e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.88155958]
curr_Stock_Price:  100.764738613805
curr_Factors:  [1.00764739e+02 4.06987307e-02]
mat_Sqrt:  [[ 2.03282042e+01  0.00000000e+00]
 [-8.06957057e-03  1.84897090e-02]]
grads:  [9.14598406e-05 7.63732338e+00]
Stock Position:  9.14598406359053e-05
Bond Position:  [7.87234365]


portfolio before change:  [7.88362518]
curr_Stock_Price:  101.8282858220756
curr_Factors:  [1.01828286e+02 4.08054274e-02]
mat_Sqrt:  [[ 2.05696735e+01  0.00000000e+00]
 [-8.08014133e-03  1.85139296e-02]]
grads:  [-0.00227723 -1.72907511]
Stock Position:  -0.0022772328184968256
Bond Position:  [8.11551189]


portfolio before change:  [7.8856028]
curr_Stock_Price:  101.85090438493249
curr_Factors:  [1.01850904e+02 4.06334591e-02]
mat_Sqrt:  [[ 2.05308433e+01  0.00000000e+00]
 [-8.06309708e-03  1.84748764e-02]]
grads:  [-1.60003320e-02 -2.31590842e+01]
Stock Position:  -0.016000332030915387
Bond Position:  [9.51525109]


portfolio before change:  [7.92613943]
curr_Stock_Price:  99.46610905333327
curr_Factors:  [9.94661091e+01 4.27923094e-02]
mat_Sqrt:  [[ 2.05758598e+01  0.00000000e+00]
 [-8.27452083e-03  1.89593090e-02]]
grads:  [6.07213048e-03 1.31456796e+01]
Stock Position:  0.00607213047870934
Bond Position:  [7.32216824]


portfolio before change:  [7.93356805]
curr_Stock_Price:  100.38800133676797
curr_Factors:  [1.00388001e+02 3.93032561e-02]
mat_Sqrt:  [[ 1.99019703e+01  0.00000000e+00]
 [-7.93001953e-03  1.81699574e-02]]
grads:  [-0.01963437 -5.86497688]
Stock Position:  -0.019634371114039297
Bond Position:  [9.90462333]


portfolio before change:  [7.9363479]
curr_Stock_Price:  100.37254965396791
curr_Factors:  [1.00372550e+02 4.03793374e-02]
mat_Sqrt:  [[ 2.01694730e+01  0.00000000e+00]
 [-8.03784423e-03  1.84170148e-02]]
grads:  [ 8.6561510e-03 -2.4300832e+01]
Stock Position:  0.00865615100391141
Bond Position:  [7.06750796]


portfolio before change:  [7.9498606]
curr_Stock_Price:  101.72945738887225
curr_Factors:  [1.01729457e+02 4.14451806e-02]
mat_Sqrt:  [[ 2.07101739e+01  0.00000000e+00]
 [-8.14323578e-03  1.86584972e-02]]
grads:  [-0.01931111 18.19127225]
Stock Position:  -0.01931110769273346
Bond Position:  [9.9143691]


portfolio before change:  [7.96261303]
curr_Stock_Price:  101.1974564179701
curr_Factors:  [1.01197456e+02 4.24746862e-02]
mat_Sqrt:  [[ 2.08561762e+01  0.00000000e+00]
 [-8.24375509e-03  1.88888158e-02]]
grads:  [0.01326592 7.90433181]
Stock Position:  0.013265922818696922
Bond Position:  [6.62013538]


portfolio before change:  [7.97636816]
curr_Stock_Price:  102.10955986234326
curr_Factors:  [1.02109560e+02 4.13575878e-02]
mat_Sqrt:  [[ 2.07655771e+01  0.00000000e+00]
 [-8.13462602e-03  1.86387697e-02]]
grads:  [-0.00655391 -1.34193321]
Stock Position:  -0.006553910706063824
Bond Position:  [8.6455851]


portfolio before change:  [7.96570635]
curr_Stock_Price:  104.06617445412026
curr_Factors:  [1.04066174e+02 4.29433831e-02]
mat_Sqrt:  [[ 2.15654099e+01  0.00000000e+00]
 [-8.28911412e-03  1.89927465e-02]]
grads:  [0.00612562 0.91799487]
Stock Position:  0.006125620173733587
Bond Position:  [7.32823649]


portfolio before change:  [7.97315558]
curr_Stock_Price:  104.98313362170197
curr_Factors:  [1.04983134e+02 4.16315666e-02]
mat_Sqrt:  [[ 2.14205644e+01  0.00000000e+00]
 [-8.16152600e-03  1.87004053e-02]]
grads:  [1.79625299e-02 1.85440842e+01]
Stock Position:  0.01796252989463854
Bond Position:  [6.08739291]


portfolio before change:  [8.02546134]
curr_Stock_Price:  107.81033682944877
curr_Factors:  [1.07810337e+02 3.97432688e-02]
mat_Sqrt:  [[ 2.14927603e+01  0.00000000e+00]
 [-7.97428555e-03  1.82713836e-02]]
grads:  [-0.00879403  6.25749678]
Stock Position:  -0.008794029308469233
Bond Position:  [8.97354861]


portfolio before change:  [8.03173766]
curr_Stock_Price:  107.35176970530499
curr_Factors:  [1.07351770e+02 3.77096218e-02]
mat_Sqrt:  [[ 2.08466030e+01  0.00000000e+00]
 [-7.76758616e-03  1.77977758e-02]]
grads:  [-2.46760396e-03  7.21201219e+00]
Stock Position:  -0.002467603964594518
Bond Position:  [8.29663932]


portfolio before change:  [8.0298595]
curr_Stock_Price:  108.95356089792786
curr_Factors:  [1.08953561e+02 3.76838027e-02]
mat_Sqrt:  [[ 2.11504099e+01  0.00000000e+00]
 [-7.76492654e-03  1.77916818e-02]]
grads:  [-0.00897712  3.02938374]
Stock Position:  -0.008977120843382005
Bond Position:  [9.00794878]


portfolio before change:  [8.03960541]
curr_Stock_Price:  108.11881164442754
curr_Factors:  [1.08118812e+02 3.60421734e-02]
mat_Sqrt:  [[ 2.05261146e+01  0.00000000e+00]
 [-7.59391055e-03  1.73998350e-02]]
grads:  [ 0.01723517 15.2263005 ]
Stock Position:  0.01723517245785924
Bond Position:  [6.17615905]


portfolio before change:  [8.04923125]
curr_Stock_Price:  108.58771377508462
curr_Factors:  [1.08587714e+02 3.46543576e-02]
mat_Sqrt:  [[ 2.02143423e+01  0.00000000e+00]
 [-7.44627236e-03  1.70615534e-02]]
grads:  [0.00449    1.52719935]
Stock Position:  0.004490003052506985
Bond Position:  [7.56167209]


portfolio before change:  [8.05061422]
curr_Stock_Price:  108.47464235891783
curr_Factors:  [1.08474642e+02 3.38509907e-02]
mat_Sqrt:  [[ 1.99578576e+01  0.00000000e+00]
 [-7.35945549e-03  1.68626309e-02]]
grads:  [3.06821375e-03 1.55471610e+01]
Stock Position:  0.0030682137494878843
Bond Position:  [7.71779083]


portfolio before change:  [8.04911918]
curr_Stock_Price:  107.35844635670496
curr_Factors:  [1.07358446e+02 3.35569262e-02]
mat_Sqrt:  [[ 1.96665103e+01  0.00000000e+00]
 [-7.32741987e-03  1.67892281e-02]]
grads:  [0.00721776 3.51989685]
Stock Position:  0.007217761209414313
Bond Position:  [7.27423155]


portfolio before change:  [8.03792686]
curr_Stock_Price:  105.55579633619853
curr_Factors:  [1.05555796e+02 3.43457743e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.03792686]
Stock Price:  103.14103160122693
PL:  [4.89689526]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-4.78762915e-02  1.59086304e-01]
 [ 4.74984505e-02 -1.88726961e-02]
 [-8.01212995e-02 -7.26571188e-03]
 [ 3.96609083e-01 -3.69660960e-01]
 [-1.32742640e-01 -7.79291999e-02]
 [ 8.37233907e-01 -1.17174972e+00]
 [-6.38523300e-01  6.07491861e-01]
 [ 1.00732419e+00  2.11813579e-01]
 [ 3.01248813e-01 -2.03821147e-01]
 [-4.91695131e-02  2.68536116e-02]
 [ 2.78711176e-01  4.19089245e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-2.45069432e-02  6.70749204e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 1.64860181e-01  3.89756386e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.29440284e-02  3.46785106e-02]
 [ 2.60034030e-01 -1.79134693e-01]
 [ 2.27148468e-01  1.08159166e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.73315363]
curr_Stock_Price:  100.88835029247998
curr_Factors:  [1.00888350e+02 4.07626088e-02]
mat_Sqrt:  [[ 2.03691078e+01  0.00000000e+00]
 [-8.07590082e-03  1.85042134e-02]]
grads:  [1.05820363e-03 8.59730163e+00]
Stock Position:  0.001058203630473888
Bond Position:  [8.62639321]


portfolio before change:  [8.73667402]
curr_Stock_Price:  102.17687577619418
curr_Factors:  [1.02176876e+02 4.16434440e-02]
mat_Sqrt:  [[ 2.08509544e+01  0.00000000e+00]
 [-8.16269014e-03  1.87030727e-02]]
grads:  [ 0.00188297 -1.00906928]
Stock Position:  0.001882970431833945
Bond Position:  [8.54427798]


portfolio before change:  [8.74479861]
curr_Stock_Price:  105.3570897130079
curr_Factors:  [1.05357090e+02 4.44551161e-02]
mat_Sqrt:  [[ 2.22138912e+01  0.00000000e+00]
 [-8.43375277e-03  1.93241552e-02]]
grads:  [-0.00374956 -0.37599118]
Stock Position:  -0.0037495599261282795
Bond Position:  [9.13984133]


portfolio before change:  [8.74470839]
curr_Stock_Price:  105.99062042666858
curr_Factors:  [1.05990620e+02 4.67526719e-02]
mat_Sqrt:  [[ 2.29176801e+01  0.00000000e+00]
 [-8.64894647e-03  1.98172259e-02]]
grads:  [ 1.0266127e-02 -1.8653517e+01]
Stock Position:  0.010266126976423574
Bond Position:  [7.65659522]


portfolio before change:  [8.71755917]
curr_Stock_Price:  103.1596004572199
curr_Factors:  [1.03159600e+02 4.83403312e-02]
mat_Sqrt:  [[ 2.26811182e+01  0.00000000e+00]
 [-8.79457389e-03  2.01509003e-02]]
grads:  [-0.00735209 -3.8672813 ]
Stock Position:  -0.0073520948112463375
Bond Position:  [9.47599833]


portfolio before change:  [8.70021424]
curr_Stock_Price:  105.84104352281072
curr_Factors:  [1.05841044e+02 4.68677347e-02]
mat_Sqrt:  [[ 2.29134822e+01  0.00000000e+00]
 [-8.65958287e-03  1.98415970e-02]]
grads:  [ 1.42204665e-02 -5.90552120e+01]
Stock Position:  0.014220466461946999
Bond Position:  [7.19510523]


portfolio before change:  [8.70014879]
curr_Stock_Price:  105.70993320605575
curr_Factors:  [1.05709933e+02 4.63206882e-02]
mat_Sqrt:  [[ 2.27511472e+01  0.00000000e+00]
 [-8.60889663e-03  1.97254602e-02]]
grads:  [-1.64120126e-02  3.07973479e+01]
Stock Position:  -0.01641201264410609
Bond Position:  [10.43506155]


portfolio before change:  [8.64591274]
curr_Stock_Price:  109.17356332440401
curr_Factors:  [1.09173563e+02 4.56620528e-02]
mat_Sqrt:  [[ 2.33289505e+01  0.00000000e+00]
 [-8.54747240e-03  1.95847196e-02]]
grads:  [ 0.04714174 10.81524693]
Stock Position:  0.04714173544304911
Bond Position:  [3.4992815]


portfolio before change:  [8.5856647]
curr_Stock_Price:  107.8769845363289
curr_Factors:  [1.07876985e+02 4.80888258e-02]
mat_Sqrt:  [[ 2.36565215e+01  0.00000000e+00]
 [-8.77166583e-03  2.00984113e-02]]
grads:  [ 8.97401473e-03 -1.01411571e+01]
Stock Position:  0.00897401472692662
Bond Position:  [7.61757505]


portfolio before change:  [8.580352]
curr_Stock_Price:  107.07273712312443
curr_Factors:  [1.07072737e+02 4.99357335e-02]
mat_Sqrt:  [[ 2.39268001e+01  0.00000000e+00]
 [-8.93852189e-03  2.04807266e-02]]
grads:  [-0.00156518  1.31116499]
Stock Position:  -0.0015651752853587612
Bond Position:  [8.7479396]


portfolio before change:  [8.58344805]
curr_Stock_Price:  106.49210496306904
curr_Factors:  [1.06492105e+02 5.16824960e-02]
mat_Sqrt:  [[ 2.42096857e+01  0.00000000e+00]
 [-9.09351382e-03  2.08358577e-02]]
grads:  [1.90674395e-02 2.01138466e+01]
Stock Position:  0.019067439503226768
Bond Position:  [6.55291628]


portfolio before change:  [8.53268471]
curr_Stock_Price:  103.74387171186214
curr_Factors:  [1.03743872e+02 5.30261832e-02]
mat_Sqrt:  [[ 2.38895317e+01  0.00000000e+00]
 [-9.21096592e-03  2.11049743e-02]]
grads:  [-0.00791175  5.41735434]
Stock Position:  -0.007911748397698667
Bond Position:  [9.35348012]


portfolio before change:  [8.53757585]
curr_Stock_Price:  103.4212534237676
curr_Factors:  [1.03421253e+02 4.98775397e-02]
mat_Sqrt:  [[ 2.30973581e+01  0.00000000e+00]
 [-8.93331201e-03  2.04687893e-02]]
grads:  [2.06385164e-04 3.27693639e+00]
Stock Position:  0.00020638516397060812
Bond Position:  [8.51623124]


portfolio before change:  [8.53988058]
curr_Stock_Price:  104.27116617497887
curr_Factors:  [1.04271166e+02 4.87224323e-02]
mat_Sqrt:  [[ 2.30159397e+01  0.00000000e+00]
 [-8.82926337e-03  2.02303839e-02]]
grads:  [ -0.01785026 -12.33142136]
Stock Position:  -0.01785026321214532
Bond Position:  [10.40114834]


portfolio before change:  [8.55507026]
curr_Stock_Price:  103.5659066152093
curr_Factors:  [1.03565907e+02 4.81995563e-02]
mat_Sqrt:  [[ 2.27372707e+01  0.00000000e+00]
 [-8.78175894e-03  2.01215375e-02]]
grads:  [0.00799879 1.93701095]
Stock Position:  0.007998785196199405
Bond Position:  [7.72666882]


portfolio before change:  [8.55192975]
curr_Stock_Price:  102.93175734220245
curr_Factors:  [1.02931757e+02 4.93340233e-02]
mat_Sqrt:  [[ 2.28624440e+01  0.00000000e+00]
 [-8.88450546e-03  2.03569594e-02]]
grads:  [0.00419885 0.86118243]
Stock Position:  0.004198848128837524
Bond Position:  [8.11973493]


portfolio before change:  [8.55361133]
curr_Stock_Price:  102.8487330778206
curr_Factors:  [1.02848733e+02 5.07462144e-02]
mat_Sqrt:  [[ 2.31686523e+01  0.00000000e+00]
 [-9.01076817e-03  2.06462636e-02]]
grads:  [-1.63190699e-03  1.67965067e+00]
Stock Position:  -0.00163190699043046
Bond Position:  [8.7214509]


portfolio before change:  [8.55386116]
curr_Stock_Price:  104.03189061276582
curr_Factors:  [1.04031891e+02 5.25849395e-02]
mat_Sqrt:  [[ 2.38559755e+01  0.00000000e+00]
 [-9.17256252e-03  2.10169810e-02]]
grads:  [ 7.62296392e-03 -8.52333133e+00]
Stock Position:  0.007622963915819121
Bond Position:  [7.76082981]


portfolio before change:  [8.53320773]
curr_Stock_Price:  101.06796719984276
curr_Factors:  [1.01067967e+02 5.19942345e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.53320773]
Stock Price:  102.12613843471348
PL:  [6.4070693]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 8.65350602e-02  3.61073940e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.59723088e-01 -5.50377386e-01]
 [-3.92946045e-02  2.75513005e-01]
 [-4.50181197e-01 -1.09785959e-01]
 [ 2.53289383e-01 -2.78566624e-01]
 [-3.91259627e-01  1.52479491e-01]
 [ 3.51339933e-02  1.40059006e-01]
 [-2.19467258e-01  4.45780007e-02]
 [ 2.40213793e-01  5.71563663e-03]
 [-1.04952399e-01 -4.74575608e-02]
 [-1.88555864e-01  5.23716429e-02]
 [-1.11030983e-01  2.66206097e-02]
 [-2.15277715e-02 -1.70041295e-01]
 [-1.37402697e-01 -1.42920449e-01]
 [ 8.85299923e-02  6.64986483e-02]
 [ 4.32951210e-02 -7.68250455e-02]
 [ 6.23423374e-01 -3.05381933e-01]
 [ 2.15773615e-01  1.26030275e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.33668349]
curr_Stock_Price:  102.28233424748923
curr_Factors:  [1.02282334e+02 3.55832601e-02]
mat_Sqrt:  [[ 1.92940544e+01  0.00000000e+00]
 [-7.54541027e-03  1.72887069e-02]]
grads:  [1.26526360e-02 2.08849593e+01]
Stock Position:  0.012652635991921166
Bond Position:  [17.04254234]


portfolio before change:  [18.32375383]
curr_Stock_Price:  100.9236586847372
curr_Factors:  [1.00923659e+02 3.51714869e-02]
mat_Sqrt:  [[ 1.89272863e+01  0.00000000e+00]
 [-7.50162510e-03  1.71883824e-02]]
grads:  [-0.00984425 -3.87773372]
Stock Position:  -0.00984424642439307
Bond Position:  [19.31727119]


portfolio before change:  [18.32985526]
curr_Stock_Price:  100.79449633834179
curr_Factors:  [1.00794496e+02 3.33056629e-02]
mat_Sqrt:  [[ 1.83948335e+01  0.00000000e+00]
 [-7.29993566e-03  1.67262539e-02]]
grads:  [-2.17412935e-02 -3.29050002e+01]
Stock Position:  -0.02174129347899341
Bond Position:  [20.52125798]


portfolio before change:  [18.3839272]
curr_Stock_Price:  98.54343504193321
curr_Factors:  [9.85434350e+01 3.66041961e-02]
mat_Sqrt:  [[ 1.88535498e+01  0.00000000e+00]
 [-7.65288924e-03  1.75349721e-02]]
grads:  [4.29357491e-03 1.57122009e+01]
Stock Position:  0.004293574912585897
Bond Position:  [17.96082358]


portfolio before change:  [18.38909296]
curr_Stock_Price:  98.70064501571373
curr_Factors:  [9.87006450e+01 3.49251148e-02]
mat_Sqrt:  [[ 1.84454354e+01  0.00000000e+00]
 [-7.47530492e-03  1.71280753e-02]]
grads:  [-0.02700374 -6.40970788]
Stock Position:  -0.02700373863855821
Bond Position:  [21.05437938]


portfolio before change:  [18.38037735]
curr_Stock_Price:  99.21834599851172
curr_Factors:  [9.92183460e+01 3.45670713e-02]
mat_Sqrt:  [[ 1.84468950e+01  0.00000000e+00]
 [-7.43688874e-03  1.70400528e-02]]
grads:  [ 7.14011443e-03 -1.63477559e+01]
Stock Position:  0.007140114434568887
Bond Position:  [17.671947]


portfolio before change:  [18.37871308]
curr_Stock_Price:  98.36642679067216
curr_Factors:  [9.83664268e+01 3.55169044e-02]
mat_Sqrt:  [[ 1.85380671e+01  0.00000000e+00]
 [-7.53837164e-03  1.72725793e-02]]
grads:  [-0.01751596  8.82783562]
Stock Position:  -0.01751596430470132
Bond Position:  [20.10169591]


portfolio before change:  [18.37587824]
curr_Stock_Price:  98.81521154836389
curr_Factors:  [9.88152115e+01 3.59616789e-02]
mat_Sqrt:  [[ 1.87388867e+01  0.00000000e+00]
 [-7.58542592e-03  1.73803942e-02]]
grads:  [5.13695165e-03 8.05844814e+00]
Stock Position:  0.005136951645852932
Bond Position:  [17.86826928]


portfolio before change:  [18.3677143]
curr_Stock_Price:  96.35625106734284
curr_Factors:  [9.63562511e+01 3.90950394e-02]
mat_Sqrt:  [[ 1.90520066e+01  0.00000000e+00]
 [-7.90898623e-03  1.81217640e-02]]
grads:  [-0.0104982   2.45991508]
Stock Position:  -0.010498202525014795
Bond Position:  [19.37928174]


portfolio before change:  [18.35118416]
curr_Stock_Price:  98.39236783240557
curr_Factors:  [9.83923678e+01 3.79275199e-02]
mat_Sqrt:  [[ 1.91619029e+01  0.00000000e+00]
 [-7.78999562e-03  1.78491223e-02]]
grads:  [0.01266619 0.32021948]
Stock Position:  0.012666189958977751
Bond Position:  [17.10492774]


portfolio before change:  [18.32415113]
curr_Stock_Price:  95.92044809456877
curr_Factors:  [9.59204481e+01 4.04826537e-02]
mat_Sqrt:  [[ 1.92994835e+01  0.00000000e+00]
 [-8.04812064e-03  1.84405610e-02]]
grads:  [-0.00651129 -2.57354214]
Stock Position:  -0.006511292238804393
Bond Position:  [18.94871719]


portfolio before change:  [18.32574393]
curr_Stock_Price:  96.40344984686001
curr_Factors:  [9.64034498e+01 4.01486323e-02]
mat_Sqrt:  [[ 1.93164784e+01  0.00000000e+00]
 [-8.01484944e-03  1.83643271e-02]]
grads:  [-0.00857812  2.85181388]
Stock Position:  -0.008578116631485501
Bond Position:  [19.15270397]


portfolio before change:  [18.32793715]
curr_Stock_Price:  96.70602846762559
curr_Factors:  [9.67060285e+01 4.07159892e-02]
mat_Sqrt:  [[ 1.95135391e+01  0.00000000e+00]
 [-8.07128135e-03  1.84936289e-02]]
grads:  [-0.00509455  1.4394476 ]
Stock Position:  -0.005094554889901809
Bond Position:  [18.82061132]


portfolio before change:  [18.34212663]
curr_Stock_Price:  94.84448409415442
curr_Factors:  [9.48444841e+01 4.20902073e-02]
mat_Sqrt:  [[ 1.94581977e+01  0.00000000e+00]
 [-8.20635922e-03  1.88031312e-02]]
grads:  [-4.92028492e-03 -9.04324355e+00]
Stock Position:  -0.004920284924325619
Bond Position:  [18.80878852]


portfolio before change:  [18.33562204]
curr_Stock_Price:  97.12227379705723
curr_Factors:  [9.71222738e+01 4.19814178e-02]
mat_Sqrt:  [[ 1.98997395e+01  0.00000000e+00]
 [-8.19574698e-03  1.87788154e-02]]
grads:  [-0.01003924 -7.6107276 ]
Stock Position:  -0.010039241678345915
Bond Position:  [19.31065602]


portfolio before change:  [18.33960234]
curr_Stock_Price:  97.20673955459883
curr_Factors:  [9.72067396e+01 4.13405231e-02]
mat_Sqrt:  [[ 1.97644330e+01  0.00000000e+00]
 [-8.13294762e-03  1.86349240e-02]]
grads:  [0.00594767 3.56849581]
Stock Position:  0.005947672850596416
Bond Position:  [17.76144845]


portfolio before change:  [18.34333193]
curr_Stock_Price:  97.08714191971649
curr_Factors:  [9.70871419e+01 4.04957214e-02]
mat_Sqrt:  [[ 1.95373783e+01  0.00000000e+00]
 [-8.04941949e-03  1.84435371e-02]]
grads:  [ 4.99858382e-04 -4.16541823e+00]
Stock Position:  0.0004998583821191839
Bond Position:  [18.29480211]


portfolio before change:  [18.34852367]
curr_Stock_Price:  98.32243692467223
curr_Factors:  [9.83224369e+01 3.91044637e-02]
mat_Sqrt:  [[ 1.94431130e+01  0.00000000e+00]
 [-7.90993944e-03  1.81239481e-02]]
grads:  [  0.02520912 -16.84963626]
Stock Position:  0.025209120078360268
Bond Position:  [15.86990155]


portfolio before change:  [18.38392691]
curr_Stock_Price:  99.56941681836734
curr_Factors:  [9.95694168e+01 4.00293109e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.38392691]
Stock Price:  100.69908582820216
PL:  [17.68484108]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.05644566e-01  7.22746089e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.78705822e-01 -6.79893877e-01]
 [ 3.51274473e-02  2.15796092e-01]
 [-2.95404173e-01 -1.00649065e-01]
 [ 3.21508060e-01 -3.72046022e-01]
 [-4.92623474e-01  1.94037732e-01]
 [ 9.63443186e-02  1.40256908e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 3.18404071e-01  4.99190840e-03]
 [ 4.17768793e-02  1.18357098e-01]
 [-2.36039996e-01  5.84461414e-02]
 [-5.11003155e-02  3.58392131e-02]
 [-2.64020971e-01 -2.68481105e-01]
 [ 4.82465875e-02 -6.12472682e-02]
 [ 9.58983117e-02  3.03566205e-02]
 [-5.29693401e-02  6.32386207e-02]
 [ 2.50169521e-01 -1.62691653e-01]
 [ 1.22010815e-01  2.11423161e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.58965308]
curr_Stock_Price:  100.28690755545459
curr_Factors:  [1.00286908e+02 3.82128035e-02]
mat_Sqrt:  [[ 1.96041804e+01  0.00000000e+00]
 [-7.81923818e-03  1.79161254e-02]]
grads:  [-3.77987448e-03  4.03405353e+00]
Stock Position:  -0.0037798744759076413
Bond Position:  [4.968725]


portfolio before change:  [4.59606877]
curr_Stock_Price:  98.91825133625443
curr_Factors:  [9.89182513e+01 4.00044045e-02]
mat_Sqrt:  [[ 1.97847394e+01  0.00000000e+00]
 [-8.00044044e-03  1.83313119e-02]]
grads:  [-0.00941761 -3.6359629 ]
Stock Position:  -0.009417605458588026
Bond Position:  [5.52764183]


portfolio before change:  [4.58949685]
curr_Stock_Price:  99.76284003425577
curr_Factors:  [9.97628400e+01 3.87058028e-02]
mat_Sqrt:  [[ 1.96271320e+01  0.00000000e+00]
 [-7.86951615e-03  1.80313267e-02]]
grads:  [-2.42233983e-02 -3.77062591e+01]
Stock Position:  -0.024223398343271293
Bond Position:  [7.00609186]


portfolio before change:  [4.59058088]
curr_Stock_Price:  99.7904047486167
curr_Factors:  [9.97904047e+01 4.12055131e-02]
mat_Sqrt:  [[ 2.02565951e+01  0.00000000e+00]
 [-8.11965645e-03  1.86044702e-02]]
grads:  [6.38353003e-03 1.15991528e+01]
Stock Position:  0.0063835300269409045
Bond Position:  [3.95356583]


portfolio before change:  [4.59834466]
curr_Stock_Price:  100.8517724822507
curr_Factors:  [1.00851772e+02 4.08489866e-02]
mat_Sqrt:  [[ 2.03832851e+01  0.00000000e+00]
 [-8.08445289e-03  1.85238087e-02]]
grads:  [-0.01664751 -5.43349733]
Stock Position:  -0.016647514117659943
Bond Position:  [6.27727597]


portfolio before change:  [4.61899283]
curr_Stock_Price:  99.70573639249322
curr_Factors:  [9.97057364e+01 4.39386892e-02]
mat_Sqrt:  [[ 2.08998753e+01  0.00000000e+00]
 [-8.38462299e-03  1.92115848e-02]]
grads:  [ 7.61410594e-03 -1.93657122e+01]
Stock Position:  0.007614105939994248
Bond Position:  [3.85982279]


portfolio before change:  [4.61816195]
curr_Stock_Price:  99.46986434276207
curr_Factors:  [9.94698643e+01 4.29781389e-02]
mat_Sqrt:  [[ 2.06212662e+01  0.00000000e+00]
 [-8.29246780e-03  1.90004307e-02]]
grads:  [-0.01978242 10.2122807 ]
Stock Position:  -0.019782415948607943
Bond Position:  [6.58591618]


portfolio before change:  [4.60844927]
curr_Stock_Price:  100.04407967323618
curr_Factors:  [1.00044080e+02 4.27197936e-02]
mat_Sqrt:  [[ 2.06778779e+01  0.00000000e+00]
 [-8.26750687e-03  1.89432380e-02]]
grads:  [0.00761961 7.40406197]
Stock Position:  0.007619614186736444
Bond Position:  [3.84615198]


portfolio before change:  [4.60998961]
curr_Stock_Price:  100.12002581157552
curr_Factors:  [1.00120026e+02 4.31470278e-02]
mat_Sqrt:  [[ 2.07967943e+01  0.00000000e+00]
 [-8.30874506e-03  1.90377266e-02]]
grads:  [-0.01046223 -2.79176775]
Stock Position:  -0.010462231244721593
Bond Position:  [5.65746847]


portfolio before change:  [4.60543236]
curr_Stock_Price:  100.69082115273595
curr_Factors:  [1.00690821e+02 4.48256642e-02]
mat_Sqrt:  [[ 2.13183334e+01  0.00000000e+00]
 [-8.46882889e-03  1.94045247e-02]]
grads:  [0.01503789 0.25725487]
Stock Position:  0.01503788842656464
Bond Position:  [3.09125503]


portfolio before change:  [4.58669161]
curr_Stock_Price:  99.39318803172424
curr_Factors:  [9.93931880e+01 4.44712755e-02]
mat_Sqrt:  [[ 2.09602479e+01  0.00000000e+00]
 [-8.43528546e-03  1.93276671e-02]]
grads:  [4.45758812e-03 6.12371363e+00]
Stock Position:  0.004457588122925703
Bond Position:  [4.14363772]


portfolio before change:  [4.58660872]
curr_Stock_Price:  99.14217074581752
curr_Factors:  [9.91421707e+01 4.36695553e-02]
mat_Sqrt:  [[ 2.07179990e+01  0.00000000e+00]
 [-8.35890474e-03  1.91526568e-02]]
grads:  [-0.01016179  3.05159445]
Stock Position:  -0.0101617925732452
Bond Position:  [5.59407089]


portfolio before change:  [4.58627587]
curr_Stock_Price:  99.31256748477364
curr_Factors:  [9.93125675e+01 4.55236962e-02]
mat_Sqrt:  [[ 2.11896102e+01  0.00000000e+00]
 [-8.53451310e-03  1.95550262e-02]]
grads:  [-1.67340504e-03  1.83273665e+00]
Stock Position:  -0.0016734050408812322
Bond Position:  [4.75246602]


portfolio before change:  [4.58383414]
curr_Stock_Price:  101.48179668674022
curr_Factors:  [1.01481797e+02 4.57986879e-02]
mat_Sqrt:  [[ 2.17177418e+01  0.00000000e+00]
 [-8.56025120e-03  1.96139995e-02]]
grads:  [ -0.01755227 -13.68823855]
Stock Position:  -0.017552272917173477
Bond Position:  [6.36507033]


portfolio before change:  [4.58288007]
curr_Stock_Price:  101.62682253807031
curr_Factors:  [1.01626823e+02 4.81021274e-02]
mat_Sqrt:  [[ 2.22889951e+01  0.00000000e+00]
 [-8.77287888e-03  2.01011908e-02]]
grads:  [ 9.65323383e-04 -3.04694726e+00]
Stock Position:  0.0009653233831704144
Bond Position:  [4.48477732]


portfolio before change:  [4.58325929]
curr_Stock_Price:  100.85804409587328
curr_Factors:  [1.00858044e+02 4.96218948e-02]
mat_Sqrt:  [[ 2.24671101e+01  0.00000000e+00]
 [-8.91038898e-03  2.04162660e-02]]
grads:  [0.00485808 1.48688406]
Stock Position:  0.0048580803920952025
Bond Position:  [4.0932828]


portfolio before change:  [4.5973848]
curr_Stock_Price:  103.55500682431085
curr_Factors:  [1.03555007e+02 4.85423816e-02]
mat_Sqrt:  [[ 2.28155867e+01  0.00000000e+00]
 [-8.81293428e-03  2.01929692e-02]]
grads:  [-1.11194788e-03  3.13171481e+00]
Stock Position:  -0.0011119478792816935
Bond Position:  [4.71253257]


portfolio before change:  [4.59776507]
curr_Stock_Price:  104.27266974739015
curr_Factors:  [1.04272670e+02 4.91555524e-02]
mat_Sqrt:  [[ 2.31183473e+01  0.00000000e+00]
 [-8.86842059e-03  2.03201043e-02]]
grads:  [ 7.74990792e-03 -8.00643788e+00]
Stock Position:  0.007749907924261158
Bond Position:  [3.78966148]


portfolio before change:  [4.59946609]
curr_Stock_Price:  104.36989494164892
curr_Factors:  [1.04369895e+02 5.10859762e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.59946609]
Stock Price:  104.76769462890381
PL:  [-0.16822853]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.40495672e-01 -6.14002234e-02]
 [-1.48483470e-01 -4.73691067e-01]
 [ 1.99344617e-01 -3.93381995e-02]
 [-3.00574537e-01 -1.01198069e-01]
 [ 2.96002532e-01 -3.35094301e-01]
 [-5.32832315e-01  2.75974815e-01]
 [ 1.51452099e-01  1.44585576e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.52545915e-01  4.94287981e-03]
 [-4.67118959e-02  3.16316998e-02]
 [-2.36021840e-01  5.80922365e-02]
 [-7.86691175e-02  3.38186464e-02]
 [-1.90335587e-01 -2.61866359e-01]
 [-4.84260662e-02 -1.02379769e-01]
 [ 9.00982022e-02  1.24491054e-02]
 [-3.06414884e-02 -4.02350534e-02]
 [ 4.14558143e-01 -2.40486487e-01]
 [ 1.57549816e-01  5.22567332e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.9676075]
curr_Stock_Price:  98.75448644758829
curr_Factors:  [9.87544864e+01 4.04895820e-02]
mat_Sqrt:  [[ 1.98714007e+01  0.00000000e+00]
 [-8.04880931e-03  1.84421389e-02]]
grads:  [ 0.0014026  -0.07324716]
Stock Position:  0.0014025975312588757
Bond Position:  [-6.1061203]


portfolio before change:  [-5.96576606]
curr_Stock_Price:  101.15586199199119
curr_Factors:  [1.01155862e+02 4.03818504e-02]
mat_Sqrt:  [[ 2.03275090e+01  0.00000000e+00]
 [-8.03809434e-03  1.84175879e-02]]
grads:  [-0.00822988 -3.33378202]
Stock Position:  -0.008229878342769096
Bond Position:  [-5.13326562]


portfolio before change:  [-5.96973992]
curr_Stock_Price:  101.48276580939131
curr_Factors:  [1.01482766e+02 4.26810019e-02]
mat_Sqrt:  [[ 2.09657111e+01  0.00000000e+00]
 [-8.26375236e-03  1.89346353e-02]]
grads:  [-1.69428644e-02 -2.50171740e+01]
Stock Position:  -0.016942864364115254
Bond Position:  [-4.25033118]


portfolio before change:  [-5.97645136]
curr_Stock_Price:  101.81616472474767
curr_Factors:  [1.01816165e+02 4.37573815e-02]
mat_Sqrt:  [[ 2.12981753e+01  0.00000000e+00]
 [-8.36730604e-03  1.91719067e-02]]
grads:  [ 0.0085536  -2.05186684]
Stock Position:  0.00855359751023268
Bond Position:  [-6.84734586]


portfolio before change:  [-5.98683173]
curr_Stock_Price:  100.80275298477365
curr_Factors:  [1.00802753e+02 4.54299037e-02]
mat_Sqrt:  [[ 2.14853930e+01  0.00000000e+00]
 [-8.52571674e-03  1.95348712e-02]]
grads:  [-0.01604537 -5.18038069]
Stock Position:  -0.016045366070917822
Bond Position:  [-4.36941466]


portfolio before change:  [-5.96594983]
curr_Stock_Price:  99.43323671715436
curr_Factors:  [9.94332367e+01 4.75259057e-02]
mat_Sqrt:  [[ 2.16768802e+01  0.00000000e+00]
 [-8.72017484e-03  1.99804306e-02]]
grads:  [ 6.90853055e-03 -1.67711250e+01]
Stock Position:  0.006908530553375453
Bond Position:  [-6.65288739]


portfolio before change:  [-5.95902215]
curr_Stock_Price:  100.67678736901372
curr_Factors:  [1.00676787e+02 4.93866443e-02]
mat_Sqrt:  [[ 2.23735092e+01  0.00000000e+00]
 [-8.88924243e-03  2.03678131e-02]]
grads:  [-0.01843193 13.54955554]
Stock Position:  -0.01843193332204247
Bond Position:  [-4.10335432]


portfolio before change:  [-5.95870686]
curr_Stock_Price:  100.60401917259505
curr_Factors:  [1.00604019e+02 4.86759448e-02]
mat_Sqrt:  [[ 2.21958881e+01  0.00000000e+00]
 [-8.82505024e-03  2.02207304e-02]]
grads:  [0.0096664  7.15036368]
Stock Position:  0.009666403818738824
Bond Position:  [-6.93118594]


portfolio before change:  [-5.96701774]
curr_Stock_Price:  99.92353150022186
curr_Factors:  [9.99235315e+01 4.55486191e-02]
mat_Sqrt:  [[ 2.13258025e+01  0.00000000e+00]
 [-8.53684898e-03  1.95603783e-02]]
grads:  [-0.0102027  -2.71717194]
Stock Position:  -0.010202704963358691
Bond Position:  [-4.94752743]


portfolio before change:  [-5.95803574]
curr_Stock_Price:  98.92193043077631
curr_Factors:  [9.89219304e+01 4.31382636e-02]
mat_Sqrt:  [[ 2.05458405e+01  0.00000000e+00]
 [-8.30790116e-03  1.90357930e-02]]
grads:  [0.01239682 0.25966241]
Stock Position:  0.012396823779504438
Bond Position:  [-7.18435348]


portfolio before change:  [-5.97328252]
curr_Stock_Price:  97.8369376307437
curr_Factors:  [9.78369376e+01 4.45436590e-02]
mat_Sqrt:  [[ 2.06488465e+01  0.00000000e+00]
 [-8.44214750e-03  1.93433900e-02]]
grads:  [-1.59363335e-03  1.63527178e+00]
Stock Position:  -0.0015936333464864401
Bond Position:  [-5.81736631]


portfolio before change:  [-5.97678031]
curr_Stock_Price:  99.11908431860175
curr_Factors:  [9.91190843e+01 4.12475450e-02]
mat_Sqrt:  [[ 2.01305821e+01  0.00000000e+00]
 [-8.12379665e-03  1.86139565e-02]]
grads:  [-0.01046509  3.12089675]
Stock Position:  -0.010465087819264304
Bond Position:  [-4.93949039]


portfolio before change:  [-5.9713802]
curr_Stock_Price:  98.4850582798088
curr_Factors:  [9.84850583e+01 4.10498222e-02]
mat_Sqrt:  [[ 1.99538171e+01  0.00000000e+00]
 [-8.10430228e-03  1.85692893e-02]]
grads:  [-0.00320287  1.82121382]
Stock Position:  -0.003202868398976035
Bond Position:  [-5.65594552]


portfolio before change:  [-5.97474612]
curr_Stock_Price:  99.09443676373562
curr_Factors:  [9.90944368e+01 4.09559557e-02]
mat_Sqrt:  [[ 2.00543138e+01  0.00000000e+00]
 [-8.09503114e-03  1.85480465e-02]]
grads:  [ -0.01518992 -14.11827167]
Stock Position:  -0.015189920706762247
Bond Position:  [-4.46950949]


portfolio before change:  [-5.99398098]
curr_Stock_Price:  100.28715787622167
curr_Factors:  [1.00287158e+02 4.01144102e-02]
mat_Sqrt:  [[ 2.00860958e+01  0.00000000e+00]
 [-8.01143285e-03  1.83564987e-02]]
grads:  [-4.63545837e-03 -5.57730376e+00]
Stock Position:  -0.004635458367876054
Bond Position:  [-5.52910403]


portfolio before change:  [-6.00039063]
curr_Stock_Price:  101.37166756464673
curr_Factors:  [1.01371668e+02 3.79852327e-02]
mat_Sqrt:  [[ 1.97571359e+01  0.00000000e+00]
 [-7.79592023e-03  1.78626973e-02]]
grads:  [0.00483529 0.69693312]
Stock Position:  0.004835287763661333
Bond Position:  [-6.49055181]


portfolio before change:  [-6.00708657]
curr_Stock_Price:  100.32248440085918
curr_Factors:  [1.00322484e+02 3.69261706e-02]
mat_Sqrt:  [[ 1.92781526e+01  0.00000000e+00]
 [-7.68647338e-03  1.76119230e-02]]
grads:  [-0.00250032 -2.28453493]
Stock Position:  -0.002500317652946653
Bond Position:  [-5.75624849]


portfolio before change:  [-6.01150433]
curr_Stock_Price:  101.51373838484577
curr_Factors:  [1.01513738e+02 3.47110883e-02]
mat_Sqrt:  [[ 1.89129353e+01  0.00000000e+00]
 [-7.45236481e-03  1.70755129e-02]]
grads:  [  0.01636981 -14.08370503]
Stock Position:  0.01636981413585645
Bond Position:  [-7.67326536]


portfolio before change:  [-5.98712087]
curr_Stock_Price:  103.12047698535497
curr_Factors:  [1.03120477e+02 3.44881203e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.98712087]
Stock Price:  103.64241998464504
PL:  [-9.62954086]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.01008528e-01 -8.32062062e-01]
 [-3.42744979e-02  2.76039076e-01]
 [-4.07772856e-01 -7.89676826e-02]
 [-7.02819107e-03  5.88220305e-02]
 [-4.94171543e-01  1.97512557e-01]
 [-6.98111190e-02  1.51793369e-01]
 [-2.12842538e-01  1.87666154e-02]
 [ 1.98430474e-01  8.33386782e-03]
 [-7.43808565e-02  4.66438182e-03]
 [-1.94734618e-01  5.59893157e-02]
 [-1.24902712e-01  2.90683104e-02]
 [-3.62478476e-02 -1.90815891e-01]
 [-1.31601886e-01 -1.40138150e-01]
 [ 8.96669668e-02  5.56588041e-02]
 [-3.83948412e-02 -3.63900966e-02]
 [ 3.33695136e-01 -2.16976867e-01]
 [ 2.07081482e-01  9.28527266e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.5100985]
curr_Stock_Price:  97.94997564406707
curr_Factors:  [9.79499756e+01 4.37960166e-02]
mat_Sqrt:  [[ 2.04984791e+01  0.00000000e+00]
 [-8.37099914e-03  1.91803686e-02]]
grads:  [ 0.00135969 -0.07042796]
Stock Position:  0.0013596900308878816
Bond Position:  [-11.64328011]


portfolio before change:  [-11.51173914]
curr_Stock_Price:  98.88441209212283
curr_Factors:  [9.88844121e+01 4.47139549e-02]
mat_Sqrt:  [[ 2.09097759e+01  0.00000000e+00]
 [-8.45826979e-03  1.93803308e-02]]
grads:  [-0.0089109  -3.43915545]
Stock Position:  -0.008910897528461848
Bond Position:  [-10.63059028]


portfolio before change:  [-11.5120263]
curr_Stock_Price:  98.61835338500201
curr_Factors:  [9.86183534e+01 4.21976042e-02]
mat_Sqrt:  [[ 2.02582368e+01  0.00000000e+00]
 [-8.21682218e-03  1.88271048e-02]]
grads:  [-2.78479409e-02 -4.41949025e+01]
Stock Position:  -0.027847940945674502
Bond Position:  [-8.76570822]


portfolio before change:  [-11.49711519]
curr_Stock_Price:  98.00420331306113
curr_Factors:  [9.80042033e+01 4.20389205e-02]
mat_Sqrt:  [[ 2.00941889e+01  0.00000000e+00]
 [-8.20135798e-03  1.87916719e-02]]
grads:  [4.28973929e-03 1.46894368e+01]
Stock Position:  0.004289739288808403
Bond Position:  [-11.91752767]


portfolio before change:  [-11.49942054]
curr_Stock_Price:  98.16141615457393
curr_Factors:  [9.81614162e+01 4.38406505e-02]
mat_Sqrt:  [[ 2.05531935e+01  0.00000000e+00]
 [-8.37526363e-03  1.91901398e-02]]
grads:  [-0.02151671 -4.11501342]
Stock Position:  -0.021516713640151352
Bond Position:  [-9.38730946]


portfolio before change:  [-11.49305824]
curr_Stock_Price:  97.75664156577203
curr_Factors:  [9.77566416e+01 4.42304751e-02]
mat_Sqrt:  [[ 2.05592409e+01  0.00000000e+00]
 [-8.41241703e-03  1.92752689e-02]]
grads:  [9.06835414e-04 3.05168404e+00]
Stock Position:  0.0009068354136762525
Bond Position:  [-11.58170742]


portfolio before change:  [-11.49435094]
curr_Stock_Price:  99.52441961194837
curr_Factors:  [9.95244196e+01 4.30059044e-02]
mat_Sqrt:  [[ 2.06392398e+01  0.00000000e+00]
 [-8.29514600e-03  1.90065672e-02]]
grads:  [-0.01976672 10.39180591]
Stock Position:  -0.019766716252888592
Bond Position:  [-9.52707998]


portfolio before change:  [-11.40825918]
curr_Stock_Price:  95.04852041360591
curr_Factors:  [9.50485204e+01 4.26491051e-02]
mat_Sqrt:  [[ 1.96290971e+01  0.00000000e+00]
 [-8.26066391e-03  1.89275588e-02]]
grads:  [-1.81519372e-04  8.01970137e+00]
Stock Position:  -0.00018151937156026925
Bond Position:  [-11.39100604]


portfolio before change:  [-11.41146091]
curr_Stock_Price:  96.99664597673335
curr_Factors:  [9.69966460e+01 4.35969335e-02]
mat_Sqrt:  [[ 2.02527820e+01  0.00000000e+00]
 [-8.35195149e-03  1.91367249e-02]]
grads:  [-0.01010489  0.98065972]
Stock Position:  -0.010104889065127475
Bond Position:  [-10.43132057]


portfolio before change:  [-11.41158124]
curr_Stock_Price:  96.75044526521175
curr_Factors:  [9.67504453e+01 4.53932332e-02]
mat_Sqrt:  [[ 2.06133478e+01  0.00000000e+00]
 [-8.52227512e-03  1.95269854e-02]]
grads:  [0.00980276 0.42678722]
Stock Position:  0.009802758573684595
Bond Position:  [-12.3600025]


portfolio before change:  [-11.40881336]
curr_Stock_Price:  97.34805933416202
curr_Factors:  [9.73480593e+01 4.34629413e-02]
mat_Sqrt:  [[ 2.02948971e+01  0.00000000e+00]
 [-8.33910703e-03  1.91072946e-02]]
grads:  [-0.0035647   0.24411524]
Stock Position:  -0.0035646967268448174
Bond Position:  [-11.06179705]


portfolio before change:  [-11.40895146]
curr_Stock_Price:  96.61091552639321
curr_Factors:  [9.66109155e+01 4.44888291e-02]
mat_Sqrt:  [[ 2.03775368e+01  0.00000000e+00]
 [-8.43695007e-03  1.93314812e-02]]
grads:  [-0.00835719  2.89627655]
Stock Position:  -0.008357186625053867
Bond Position:  [-10.60155601]


portfolio before change:  [-11.41399709]
curr_Stock_Price:  96.8974844106931
curr_Factors:  [9.68974844e+01 4.41372372e-02]
mat_Sqrt:  [[ 2.03570609e+01  0.00000000e+00]
 [-8.40354565e-03  1.92549420e-02]]
grads:  [-0.0055124   1.50965453]
Stock Position:  -0.005512399961752349
Bond Position:  [-10.8798594]


portfolio before change:  [-11.40725383]
curr_Stock_Price:  95.18070742238028
curr_Factors:  [9.51807074e+01 4.55333785e-02]
mat_Sqrt:  [[ 2.03101844e+01  0.00000000e+00]
 [-8.53542065e-03  1.95571056e-02]]
grads:  [-5.88506376e-03 -9.75685743e+00]
Stock Position:  -0.005885063755370557
Bond Position:  [-10.8471093]


portfolio before change:  [-11.42250793]
curr_Stock_Price:  97.31186144325173
curr_Factors:  [9.73118614e+01 4.34944218e-02]
mat_Sqrt:  [[ 2.02946965e+01  0.00000000e+00]
 [-8.34212652e-03  1.91142131e-02]]
grads:  [-0.00949821 -7.33162013]
Stock Position:  -0.009498205057906047
Bond Position:  [-10.49821991]


portfolio before change:  [-11.44039107]
curr_Stock_Price:  98.91829794875562
curr_Factors:  [9.89182979e+01 4.29719535e-02]
mat_Sqrt:  [[ 2.05054443e+01  0.00000000e+00]
 [-8.29187105e-03  1.89990634e-02]]
grads:  [0.00555747 2.92955516]
Stock Position:  0.005557473364566286
Bond Position:  [-11.99012688]


portfolio before change:  [-11.43375295]
curr_Stock_Price:  100.65218505274484
curr_Factors:  [1.00652185e+02 4.35912167e-02]
mat_Sqrt:  [[ 2.10146762e+01  0.00000000e+00]
 [-8.35140388e-03  1.91354702e-02]]
grads:  [-0.0025828  -1.90170904]
Stock Position:  -0.002582803601706836
Bond Position:  [-11.17378812]


portfolio before change:  [-11.44205477]
curr_Stock_Price:  102.78476092245721
curr_Factors:  [1.02784761e+02 4.44890674e-02]
mat_Sqrt:  [[ 2.16798055e+01  0.00000000e+00]
 [-8.43697267e-03  1.93315330e-02]]
grads:  [ 1.10240227e-02 -1.12239866e+01]
Stock Position:  0.011024022703437254
Bond Position:  [-12.57515631]


portfolio before change:  [-11.45811473]
curr_Stock_Price:  101.61315758229746
curr_Factors:  [1.01613158e+02 4.36595249e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.45811473]
Stock Price:  101.39178915024712
PL:  [-12.84990388]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 5.45058785e-03  1.11985242e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.40899787e-01 -4.21948679e-01]
 [ 2.24768011e-01 -8.19101129e-02]
 [-2.76807740e-01 -9.84520916e-02]
 [ 3.28643355e-01 -3.83175003e-01]
 [-5.05387162e-01  2.28968056e-01]
 [ 2.90313690e-02  1.47761562e-01]
 [-2.10375548e-01  9.15467219e-03]
 [ 2.00031511e-01  8.23354344e-03]
 [-1.06004474e-01 -5.09235030e-02]
 [-1.93098108e-01  5.50489319e-02]
 [-8.18507877e-02  2.14554124e-02]
 [-8.95112400e-02 -2.15909664e-01]
 [-1.59125570e-01 -1.45514739e-01]
 [ 8.85464510e-02  7.23337198e-02]
 [ 3.59537896e-02 -7.31913607e-02]
 [ 7.24640484e-01 -3.47415241e-01]
 [ 1.56773685e-01  1.50030366e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.76841535]
curr_Stock_Price:  99.50916629371541
curr_Factors:  [9.95091663e+01 3.98991879e-02]
mat_Sqrt:  [[ 1.98767381e+01  0.00000000e+00]
 [-7.98991243e-03  1.83071892e-02]]
grads:  [0.00029881 0.06117009]
Stock Position:  0.0002988081588155765
Bond Position:  [-0.7981495]


portfolio before change:  [-0.76829241]
curr_Stock_Price:  100.58846000166496
curr_Factors:  [1.00588460e+02 3.94192247e-02]
mat_Sqrt:  [[ 1.99711098e+01  0.00000000e+00]
 [-7.94171012e-03  1.81967439e-02]]
grads:  [-0.00932972 -3.66285148]
Stock Position:  -0.009329720403113086
Bond Position:  [0.17016979]


portfolio before change:  [-0.78039703]
curr_Stock_Price:  101.89044597196082
curr_Factors:  [1.01890446e+02 3.89606883e-02]
mat_Sqrt:  [[ 2.01116070e+01  0.00000000e+00]
 [-7.89538481e-03  1.80905993e-02]]
grads:  [-1.61624722e-02 -2.33241958e+01]
Stock Position:  -0.01616247216886842
Bond Position:  [0.86640447]


portfolio before change:  [-0.78769933]
curr_Stock_Price:  102.35565508308225
curr_Factors:  [1.02355655e+02 3.80393974e-02]
mat_Sqrt:  [[ 1.99631310e+01  0.00000000e+00]
 [-7.80147651e-03  1.78754283e-02]]
grads:  [ 0.00946843 -4.58227414]
Stock Position:  0.009468429930470151
Bond Position:  [-1.75684668]


portfolio before change:  [-0.80070678]
curr_Stock_Price:  101.02827734859464
curr_Factors:  [1.01028277e+02 3.80191060e-02]
mat_Sqrt:  [[ 1.96989872e+01  0.00000000e+00]
 [-7.79939546e-03  1.78706600e-02]]
grads:  [-0.01623311 -5.50914691]
Stock Position:  -0.016233106419521495
Bond Position:  [0.83929599]


portfolio before change:  [-0.78085611]
curr_Stock_Price:  99.81835361651275
curr_Factors:  [9.98183536e+01 3.99659392e-02]
mat_Sqrt:  [[ 1.99551692e+01  0.00000000e+00]
 [-7.99659319e-03  1.83224968e-02]]
grads:  [ 8.08873491e-03 -2.09128159e+01]
Stock Position:  0.008088734906521736
Bond Position:  [-1.58826031]


portfolio before change:  [-0.7793891]
curr_Stock_Price:  100.0488130371687
curr_Factors:  [1.00048813e+02 4.05410873e-02]
mat_Sqrt:  [[ 2.01446458e+01  0.00000000e+00]
 [-8.05392697e-03  1.84538650e-02]]
grads:  [-0.0201273  12.40759355]
Stock Position:  -0.020127298976118767
Bond Position:  [1.23432327]


portfolio before change:  [-0.75001275]
curr_Stock_Price:  98.60461846679883
curr_Factors:  [9.86046185e+01 4.09609859e-02]
mat_Sqrt:  [[ 1.99564118e+01  0.00000000e+00]
 [-8.09552823e-03  1.85491855e-02]]
grads:  [4.68620323e-03 7.96593263e+00]
Stock Position:  0.004686203226700784
Bond Position:  [-1.21209403]


portfolio before change:  [-0.75651969]
curr_Stock_Price:  97.28075688989483
curr_Factors:  [9.72807569e+01 4.18631423e-02]
mat_Sqrt:  [[ 1.99041141e+01  0.00000000e+00]
 [-8.18419377e-03  1.87523437e-02]]
grads:  [-0.01036872  0.48818816]
Stock Position:  -0.010368716765555674
Bond Position:  [0.25215692]


portfolio before change:  [-0.75143036]
curr_Stock_Price:  96.7960024795408
curr_Factors:  [9.67960025e+01 4.22446938e-02]
mat_Sqrt:  [[ 1.98949799e+01  0.00000000e+00]
 [-8.22140560e-03  1.88376067e-02]]
grads:  [0.01023499 0.43708012]
Stock Position:  0.010234990179503278
Bond Position:  [-1.7421365]


portfolio before change:  [-0.7686814]
curr_Stock_Price:  95.15306498444568
curr_Factors:  [9.51530650e+01 4.18698624e-02]
mat_Sqrt:  [[ 1.94703406e+01  0.00000000e+00]
 [-8.18485063e-03  1.87538488e-02]]
grads:  [-0.00658588 -2.71536278]
Stock Position:  -0.006585879267061144
Bond Position:  [-0.1420148]


portfolio before change:  [-0.77799484]
curr_Stock_Price:  96.56182671708623
curr_Factors:  [9.65618267e+01 4.18077847e-02]
mat_Sqrt:  [[ 1.97439504e+01  0.00000000e+00]
 [-8.17878081e-03  1.87399411e-02]]
grads:  [-0.00856327  2.93751894]
Stock Position:  -0.008563270331467443
Bond Position:  [0.04889018]


portfolio before change:  [-0.77596327]
curr_Stock_Price:  96.32601182606835
curr_Factors:  [9.63260118e+01 4.18779730e-02]
mat_Sqrt:  [[ 1.97122594e+01  0.00000000e+00]
 [-8.18564333e-03  1.87556651e-02]]
grads:  [-0.00367725  1.14394303]
Stock Position:  -0.003677248583727284
Bond Position:  [-0.42174858]


portfolio before change:  [-0.77841491]
curr_Stock_Price:  96.96403842893974
curr_Factors:  [9.69640384e+01 4.08481772e-02]
mat_Sqrt:  [[ 1.95973359e+01  0.00000000e+00]
 [-8.08437279e-03  1.85236251e-02]]
grads:  [-9.37586333e-03 -1.16559076e+01]
Stock Position:  -0.00937586333025813
Bond Position:  [0.13070667]


portfolio before change:  [-0.77436275]
curr_Stock_Price:  96.53533372346587
curr_Factors:  [9.65353337e+01 4.19177641e-02]
mat_Sqrt:  [[ 1.97644784e+01  0.00000000e+00]
 [-8.18953127e-03  1.87645735e-02]]
grads:  [-0.01126432 -7.75475869]
Stock Position:  -0.011264319994339696
Bond Position:  [0.31304214]


portfolio before change:  [-0.79280641]
curr_Stock_Price:  98.17963484555723
curr_Factors:  [9.81796348e+01 4.26205451e-02]
mat_Sqrt:  [[ 2.02689342e+01  0.00000000e+00]
 [-8.25789757e-03  1.89212203e-02]]
grads:  [0.00592609 3.82288872]
Stock Position:  0.005926087347998312
Bond Position:  [-1.3746275]


portfolio before change:  [-0.79772475]
curr_Stock_Price:  97.4076850061799
curr_Factors:  [9.74076850e+01 4.06569845e-02]
mat_Sqrt:  [[ 1.96408738e+01  0.00000000e+00]
 [-8.06543088e-03  1.84802238e-02]]
grads:  [ 2.04189538e-04 -3.96052351e+00]
Stock Position:  0.000204189537834315
Bond Position:  [-0.81761438]


portfolio before change:  [-0.79796148]
curr_Stock_Price:  97.24949340369858
curr_Factors:  [9.72494934e+01 3.86449837e-02]
mat_Sqrt:  [[ 1.91176238e+01  0.00000000e+00]
 [-7.86333097e-03  1.80171547e-02]]
grads:  [  0.02997318 -19.28246981]
Stock Position:  0.029973183204069342
Bond Position:  [-3.71283837]


portfolio before change:  [-0.83211441]
curr_Stock_Price:  96.14101589374974
curr_Factors:  [9.61410159e+01 4.00044812e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.83211441]
Stock Price:  97.44380748311029
PL:  [-0.83211441]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.48997658e-02  2.83478626e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.61146094e-01 -5.60086352e-01]
 [ 2.69060791e-01 -1.56079139e-01]
 [-3.35430796e-01 -1.05506955e-01]
 [ 4.89932325e-01 -6.34343959e-01]
 [-5.76807206e-01  4.19487425e-01]
 [ 6.84216473e-02  1.38063607e-01]
 [-1.44977601e-01 -3.30613036e-02]
 [ 2.07175267e-01  1.29510068e-02]
 [ 1.88409254e-01  2.74923827e-01]
 [-2.38898851e-01  1.14173692e-01]
 [-1.30452515e-02  5.86075291e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 2.11542727e-01  1.82900789e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.32277264e-02  2.26262466e-01]
 [ 1.47845093e-01  1.35099355e-04]
 [ 1.12641874e-01  1.41935068e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.65355508]
curr_Stock_Price:  101.74771604169118
curr_Factors:  [1.01747716e+02 3.94060437e-02]
mat_Sqrt:  [[ 2.01978939e+01  0.00000000e+00]
 [-7.94038223e-03  1.81937013e-02]]
grads:  [7.85329311e-03 1.55811410e+01]
Stock Position:  0.007853293113463111
Bond Position:  [13.85450044]


portfolio before change:  [14.64789614]
curr_Stock_Price:  100.58603756618172
curr_Factors:  [1.00586038e+02 3.85669202e-02]
mat_Sqrt:  [[ 1.97535511e+01  0.00000000e+00]
 [-7.85538492e-03  1.79989480e-02]]
grads:  [-0.00943247 -3.70310366]
Stock Position:  -0.009432474671921352
Bond Position:  [15.59667139]


portfolio before change:  [14.65026146]
curr_Stock_Price:  100.74870214379818
curr_Factors:  [1.00748702e+02 3.94423484e-02]
mat_Sqrt:  [[ 2.00087908e+01  0.00000000e+00]
 [-7.94403912e-03  1.82020803e-02]]
grads:  [-2.02704813e-02 -3.07704583e+01]
Stock Position:  -0.020270481252110444
Bond Position:  [16.69248614]


portfolio before change:  [14.6028646]
curr_Stock_Price:  103.29282069754377
curr_Factors:  [1.03292821e+02 3.93104457e-02]
mat_Sqrt:  [[ 2.04797250e+01  0.00000000e+00]
 [-7.93074480e-03  1.81716192e-02]]
grads:  [ 0.00981177 -8.58917068]
Stock Position:  0.009811766017416977
Bond Position:  [13.58937961]


portfolio before change:  [14.57858272]
curr_Stock_Price:  100.4717535326978
curr_Factors:  [1.00471754e+02 3.90126559e-02]
mat_Sqrt:  [[ 1.98448007e+01  0.00000000e+00]
 [-7.90064867e-03  1.81026603e-02]]
grads:  [-0.01922306 -5.82825691]
Stock Position:  -0.01922306061824752
Bond Position:  [16.50995733]


portfolio before change:  [14.55471565]
curr_Stock_Price:  101.92808103580698
curr_Factors:  [1.01928081e+02 3.88297911e-02]
mat_Sqrt:  [[ 2.00852099e+01  0.00000000e+00]
 [-7.88211049e-03  1.80601840e-02]]
grads:  [ 1.06088970e-02 -3.51238924e+01]
Stock Position:  0.010608897041227108
Bond Position:  [13.47337113]


portfolio before change:  [14.5692638]
curr_Stock_Price:  102.98185529162471
curr_Factors:  [1.02981855e+02 3.87906892e-02]
mat_Sqrt:  [[ 2.02826389e+01  0.00000000e+00]
 [-7.87814082e-03  1.80510883e-02]]
grads:  [-1.94120640e-02  2.32388994e+01]
Stock Position:  -0.01941206395027128
Bond Position:  [16.56835416]


portfolio before change:  [14.63593237]
curr_Stock_Price:  99.76087051237764
curr_Factors:  [9.97608705e+01 4.00842916e-02]
mat_Sqrt:  [[ 1.99731856e+01  0.00000000e+00]
 [-8.00842473e-03  1.83496063e-02]]
grads:  [6.44251489e-03 7.52406372e+00]
Stock Position:  0.0064425148868057355
Bond Position:  [13.99322147]


portfolio before change:  [14.65282355]
curr_Stock_Price:  101.83962975633699
curr_Factors:  [1.01839630e+02 3.70427293e-02]
mat_Sqrt:  [[ 1.96005519e+01  0.00000000e+00]
 [-7.69859513e-03  1.76396975e-02]]
grads:  [-0.00813277 -1.87425571]
Stock Position:  -0.008132767737124432
Bond Position:  [15.4810616]


portfolio before change:  [14.65030194]
curr_Stock_Price:  102.62562979941619
curr_Factors:  [1.0262563e+02 3.4007934e-02]
mat_Sqrt:  [[ 1.89254389e+01  0.00000000e+00]
 [-7.37649608e-03  1.69016758e-02]]
grads:  [0.01124558 0.76625578]
Stock Position:  0.011245580650467551
Bond Position:  [13.49621714]


portfolio before change:  [14.66352408]
curr_Stock_Price:  103.50132193253737
curr_Factors:  [1.03501322e+02 3.46529847e-02]
mat_Sqrt:  [[ 1.92670942e+01  0.00000000e+00]
 [-7.44612487e-03  1.70612154e-02]]
grads:  [1.60063498e-02 1.61139649e+01]
Stock Position:  0.01600634979575626
Bond Position:  [13.00684572]


portfolio before change:  [14.6582843]
curr_Stock_Price:  102.9707885678086
curr_Factors:  [1.02970789e+02 3.73383412e-02]
mat_Sqrt:  [[ 1.98971809e+01  0.00000000e+00]
 [-7.72925261e-03  1.77099426e-02]]
grads:  [-0.00950232  6.44686967]
Stock Position:  -0.009502319333122886
Bond Position:  [15.63674561]


portfolio before change:  [14.66324467]
curr_Stock_Price:  102.86021546308038
curr_Factors:  [1.02860215e+02 3.70072429e-02]
mat_Sqrt:  [[ 1.97874939e+01  0.00000000e+00]
 [-7.69490667e-03  1.76312461e-02]]
grads:  [6.33388502e-04 3.32407186e+00]
Stock Position:  0.00063338850160126
Bond Position:  [14.5980942]


portfolio before change:  [14.66783361]
curr_Stock_Price:  104.34264159885362
curr_Factors:  [1.04342642e+02 3.67623990e-02]
mat_Sqrt:  [[ 2.00061605e+01  0.00000000e+00]
 [-7.66940926e-03  1.75728242e-02]]
grads:  [ -0.0205357  -14.19631725]
Stock Position:  -0.020535703541494345
Bond Position:  [16.81058316]


portfolio before change:  [14.62840477]
curr_Stock_Price:  106.46733173177249
curr_Factors:  [1.06467332e+02 3.65978453e-02]
mat_Sqrt:  [[ 2.03678003e+01  0.00000000e+00]
 [-7.65222533e-03  1.75334509e-02]]
grads:  [ 0.01430528 10.43153401]
Stock Position:  0.014305284407993755
Bond Position:  [13.10535931]


portfolio before change:  [14.64564629]
curr_Stock_Price:  107.44352857186327
curr_Factors:  [1.07443529e+02 3.65042896e-02]
mat_Sqrt:  [[ 2.05282635e+01  0.00000000e+00]
 [-7.64243831e-03  1.75110260e-02]]
grads:  [0.00467628 1.00114383]
Stock Position:  0.004676281085225292
Bond Position:  [14.14321015]


portfolio before change:  [14.64985503]
curr_Stock_Price:  107.58733678856849
curr_Factors:  [1.07587337e+02 3.79361065e-02]
mat_Sqrt:  [[ 2.09549937e+01  0.00000000e+00]
 [-7.79087738e-03  1.78511427e-02]]
grads:  [2.17233708e-03 1.26749570e+01]
Stock Position:  0.0021723370756434554
Bond Position:  [14.41613906]


portfolio before change:  [14.65136846]
curr_Stock_Price:  106.62475683220242
curr_Factors:  [1.06624757e+02 3.93996519e-02]
mat_Sqrt:  [[ 2.11643164e+01  0.00000000e+00]
 [-7.93973822e-03  1.81922257e-02]]
grads:  [0.00698837 0.00742621]
Stock Position:  0.006988369107929
Bond Position:  [13.90623531]


portfolio before change:  [14.64064897]
curr_Stock_Price:  104.59331257625962
curr_Factors:  [1.04593313e+02 4.08354033e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.64064897]
Stock Price:  102.91712873530335
PL:  [11.72352024]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-6.96574806e-02  1.26354464e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.12926533e-01 -1.03213950e+00]
 [-2.92253529e-02  2.76568190e-01]
 [-4.21672205e-01 -5.61084499e-02]
 [ 5.61868141e-02 -2.29069673e-02]
 [-4.10100301e-01  1.59848452e-01]
 [ 2.13676839e-02  1.57434444e-01]
 [-2.32240534e-01  9.46961648e-02]
 [ 1.41128711e-01  1.19245175e-02]
 [-1.04144327e-01 -4.47954561e-02]
 [-1.42640664e-01  2.51154722e-02]
 [ 1.90544253e-01 -2.62040459e-02]
 [ 1.22994447e-01  4.44883626e-02]
 [-3.00811648e-01 -9.99699379e-02]
 [ 8.02505643e-02  8.07830649e-02]
 [-2.50694527e-02 -2.77997092e-02]
 [ 1.30858203e+00 -5.90198434e-01]
 [ 1.43027431e-01  1.94139596e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.16863624]
curr_Stock_Price:  100.66125544621852
curr_Factors:  [1.00661255e+02 3.91352569e-02]
mat_Sqrt:  [[ 1.99134467e+01  0.00000000e+00]
 [-7.91305320e-03  1.81310826e-02]]
grads:  [-7.28747349e-04  6.96894203e+00]
Stock Position:  -0.0007287473487962211
Bond Position:  [7.24199286]


portfolio before change:  [7.1727598]
curr_Stock_Price:  97.48754318721507
curr_Factors:  [9.74875432e+01 4.04967492e-02]
mat_Sqrt:  [[ 1.96182022e+01  0.00000000e+00]
 [-8.04952165e-03  1.84437711e-02]]
grads:  [-0.00949755 -3.61379295]
Stock Position:  -0.009497550691662988
Bond Position:  [8.09865268]


portfolio before change:  [7.17661037]
curr_Stock_Price:  97.2953192532307
curr_Factors:  [9.72953193e+01 4.14433904e-02]
mat_Sqrt:  [[ 1.98070403e+01  0.00000000e+00]
 [-8.14305991e-03  1.86580942e-02]]
grads:  [-3.3492593e-02 -5.5318592e+01]
Stock Position:  -0.033492593039244914
Bond Position:  [10.43528291]


portfolio before change:  [7.17335713]
curr_Stock_Price:  97.47035467134742
curr_Factors:  [9.74703547e+01 4.05865438e-02]
mat_Sqrt:  [[ 1.96364774e+01  0.00000000e+00]
 [-8.05844092e-03  1.84642078e-02]]
grads:  [4.65862074e-03 1.49786112e+01]
Stock Position:  0.004658620741418925
Bond Position:  [6.71927971]


portfolio before change:  [7.17116371]
curr_Stock_Price:  96.6388956130227
curr_Factors:  [9.66388956e+01 3.99220695e-02]
mat_Sqrt:  [[ 1.93089421e+01  0.00000000e+00]
 [-7.99220315e-03  1.83124379e-02]]
grads:  [-0.02310639 -3.06395304]
Stock Position:  -0.02310638963382757
Bond Position:  [9.40413968]


portfolio before change:  [7.13938664]
curr_Stock_Price:  98.11590677031901
curr_Factors:  [9.81159068e+01 3.93723477e-02]
mat_Sqrt:  [[ 1.94686159e+01  0.00000000e+00]
 [-7.93698660e-03  1.81859209e-02]]
grads:  [ 0.00237251 -1.25959897]
Stock Position:  0.0023725052714234137
Bond Position:  [6.90660614]


portfolio before change:  [7.14203901]
curr_Stock_Price:  98.50600001576109
curr_Factors:  [9.85060000e+01 4.02031575e-02]
mat_Sqrt:  [[ 1.97511672e+01  0.00000000e+00]
 [-8.02029002e-03  1.83767931e-02]]
grads:  [-0.01723122  8.69838671]
Stock Position:  -0.01723122047956203
Bond Position:  [8.83941761]


portfolio before change:  [7.17418745]
curr_Stock_Price:  96.76855391353894
curr_Factors:  [9.67685539e+01 4.08431424e-02]
mat_Sqrt:  [[ 1.95566213e+01  0.00000000e+00]
 [-8.08387456e-03  1.85224835e-02]]
grads:  [4.60599543e-03 8.49964010e+00]
Stock Position:  0.0046059954299647946
Bond Position:  [6.72847194]


portfolio before change:  [7.1674331]
curr_Stock_Price:  94.93687898108566
curr_Factors:  [9.49368790e+01 4.06404967e-02]
mat_Sqrt:  [[ 1.91387890e+01  0.00000000e+00]
 [-8.06379530e-03  1.84764762e-02]]
grads:  [-0.00997512  5.12522863]
Stock Position:  -0.00997512117104028
Bond Position:  [8.11443997]


portfolio before change:  [7.17167003]
curr_Stock_Price:  94.7155216951522
curr_Factors:  [9.47155217e+01 4.07296983e-02]
mat_Sqrt:  [[ 1.91151078e+01  0.00000000e+00]
 [-8.07264005e-03  1.84967420e-02]]
grads:  [0.00765536 0.64468205]
Stock Position:  0.007655358164106986
Bond Position:  [6.44658878]


portfolio before change:  [7.16623622]
curr_Stock_Price:  93.7951658129631
curr_Factors:  [9.37951658e+01 3.98977270e-02]
mat_Sqrt:  [[ 1.87350360e+01  0.00000000e+00]
 [-7.98976615e-03  1.83068541e-02]]
grads:  [-0.00660232 -2.44692266]
Stock Position:  -0.006602318055473754
Bond Position:  [7.78550174]


portfolio before change:  [7.1619514]
curr_Stock_Price:  94.7389922031703
curr_Factors:  [9.47389922e+01 3.99726498e-02]
mat_Sqrt:  [[ 1.89413195e+01  0.00000000e+00]
 [-7.99726451e-03  1.83240350e-02]]
grads:  [-0.00695196  1.37063   ]
Stock Position:  -0.006951964118136492
Bond Position:  [7.82057347]


portfolio before change:  [7.17764539]
curr_Stock_Price:  92.76277367018467
curr_Factors:  [9.27627737e+01 4.27838083e-02]
mat_Sqrt:  [[ 1.91872814e+01  0.00000000e+00]
 [-8.27369889e-03  1.89574257e-02]]
grads:  [ 0.00933472 -1.38225761]
Stock Position:  0.009334718444489078
Bond Position:  [6.31173101]


portfolio before change:  [7.16897778]
curr_Stock_Price:  91.6651797502664
curr_Factors:  [9.16651798e+01 4.50401794e-02]
mat_Sqrt:  [[ 1.94538002e+01  0.00000000e+00]
 [-8.48906868e-03  1.94508999e-02]]
grads:  [0.00732046 2.28721359]
Stock Position:  0.007320459704454888
Bond Position:  [6.49794653]


portfolio before change:  [7.16421374]
curr_Stock_Price:  90.79245712567985
curr_Factors:  [9.07924571e+01 4.67239786e-02]
mat_Sqrt:  [[ 1.96254524e+01  0.00000000e+00]
 [-8.64629202e-03  1.98111438e-02]]
grads:  [-0.01755079 -5.04614669]
Stock Position:  -0.017550785499201763
Bond Position:  [8.75769268]


portfolio before change:  [7.17916409]
curr_Stock_Price:  90.06538708158676
curr_Factors:  [9.00653871e+01 4.74885709e-02]
mat_Sqrt:  [[ 1.96269344e+01  0.00000000e+00]
 [-8.71674902e-03  1.99725811e-02]]
grads:  [0.00588514 4.04469831]
Stock Position:  0.005885136323749034
Bond Position:  [6.64911701]


portfolio before change:  [7.17867113]
curr_Stock_Price:  89.69913354205401
curr_Factors:  [8.96991335e+01 4.76003839e-02]
mat_Sqrt:  [[ 1.95701194e+01  0.00000000e+00]
 [-8.72700489e-03  1.99960802e-02]]
grads:  [-0.00190097 -1.39025794]
Stock Position:  -0.0019009715621014698
Bond Position:  [7.34918663]


portfolio before change:  [7.17795552]
curr_Stock_Price:  91.0422033098958
curr_Factors:  [9.10422033e+01 4.56174215e-02]
mat_Sqrt:  [[ 1.94450080e+01  0.00000000e+00]
 [-8.54329412e-03  1.95751460e-02]]
grads:  [  0.05404978 -30.15039759]
Stock Position:  0.05404977531328019
Bond Position:  [2.25714488]


portfolio before change:  [7.27332206]
curr_Stock_Price:  92.79618261728314
curr_Factors:  [9.27961826e+01 4.67705765e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.27332206]
Stock Price:  91.33235116682454
PL:  [7.27332206]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-8.20741924e-02  1.79161520e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.10847240e-01 -8.99190197e-01]
 [ 1.40413029e-01  5.31458812e-02]
 [-1.97941553e-01 -8.88696421e-02]
 [ 4.48901735e-01 -5.70743042e-01]
 [-4.59555539e-01  1.75738447e-01]
 [ 3.11566271e-01  1.57162404e-01]
 [-1.08694262e-01 -1.86207705e-02]
 [ 2.86521524e-01  7.75586699e-03]
 [ 2.95055325e-01  4.45182389e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-2.24943058e-01  2.15148265e-01]
 [-1.75488622e-01  1.83725086e-01]
 [ 3.17312370e-01  6.47152003e-01]
 [-3.17334849e-02  1.31857696e-01]
 [-5.44859615e-02  4.41973292e-01]
 [ 2.05206562e-01  2.05882115e-01]
 [-9.27408778e-03 -2.67875962e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.3766278]
curr_Stock_Price:  99.96567965438001
curr_Factors:  [9.99656797e+01 4.19311720e-02]
mat_Sqrt:  [[ 2.04700745e+01  0.00000000e+00]
 [-8.19084093e-03  1.87675743e-02]]
grads:  [-0.00362749  0.95463334]
Stock Position:  -0.003627487655583592
Bond Position:  [2.73925207]


portfolio before change:  [2.38385622]
curr_Stock_Price:  98.16180844578503
curr_Factors:  [9.81618084e+01 4.38500555e-02]
mat_Sqrt:  [[ 2.05554801e+01  0.00000000e+00]
 [-8.37616194e-03  1.91921981e-02]]
grads:  [-0.00906449 -3.47286798]
Stock Position:  -0.009064486423716453
Bond Position:  [3.2736426]


portfolio before change:  [2.38510089]
curr_Stock_Price:  98.11479374035041
curr_Factors:  [9.81147937e+01 4.39950690e-02]
mat_Sqrt:  [[ 2.05795795e+01  0.00000000e+00]
 [-8.39000062e-03  1.92239065e-02]]
grads:  [-2.93147883e-02 -4.67745824e+01]
Stock Position:  -0.02931478826644553
Bond Position:  [5.2613153]


portfolio before change:  [2.30118575]
curr_Stock_Price:  101.0222218174406
curr_Factors:  [1.01022222e+02 4.03250697e-02]
mat_Sqrt:  [[ 2.02863764e+01  0.00000000e+00]
 [-8.03244119e-03  1.84046349e-02]]
grads:  [0.00806491 2.88763573]
Stock Position:  0.008064909689674963
Bond Position:  [1.48645065]


portfolio before change:  [2.30775353]
curr_Stock_Price:  101.79050425464564
curr_Factors:  [1.01790504e+02 3.90659370e-02]
mat_Sqrt:  [[ 2.01189999e+01  0.00000000e+00]
 [-7.90604194e-03  1.81150178e-02]]
grads:  [-0.01176636 -4.90585452]
Stock Position:  -0.011766362436062598
Bond Position:  [3.5054575]


portfolio before change:  [2.31277688]
curr_Stock_Price:  101.43806957403125
curr_Factors:  [1.0143807e+02 3.9982675e-02]
mat_Sqrt:  [[ 2.02832199e+01  0.00000000e+00]
 [-7.99826731e-03  1.83263327e-02]]
grads:  [ 9.85095323e-03 -3.11433308e+01]
Stock Position:  0.009850953227247088
Bond Position:  [1.3135152]


portfolio before change:  [2.28936274]
curr_Stock_Price:  99.02789050614315
curr_Factors:  [9.90278905e+01 4.17183868e-02]
mat_Sqrt:  [[ 2.02265253e+01  0.00000000e+00]
 [-8.17003176e-03  1.87198945e-02]]
grads:  [-0.01892846  9.38779047]
Stock Position:  -0.018928460889169087
Bond Position:  [4.16380829]


portfolio before change:  [2.2304126]
curr_Stock_Price:  102.19725693984431
curr_Factors:  [1.02197257e+02 4.06332093e-02]
mat_Sqrt:  [[ 2.06005968e+01  0.00000000e+00]
 [-8.06307230e-03  1.84748196e-02]]
grads:  [0.01845372 8.50684378]
Stock Position:  0.018453716232837324
Bond Position:  [0.34449342]


portfolio before change:  [2.23305477]
curr_Stock_Price:  102.33576787612857
curr_Factors:  [1.02335768e+02 4.04821395e-02]
mat_Sqrt:  [[ 2.05901344e+01  0.00000000e+00]
 [-8.04806953e-03  1.84404439e-02]]
grads:  [-0.00567364 -1.00977886]
Stock Position:  -0.005673641091435738
Bond Position:  [2.81367119]


portfolio before change:  [2.23918761]
curr_Stock_Price:  101.3788284066244
curr_Factors:  [1.01378828e+02 4.12837662e-02]
mat_Sqrt:  [[ 2.05985629e+01  0.00000000e+00]
 [-8.12736279e-03  1.86221276e-02]]
grads:  [0.01407411 0.41648662]
Stock Position:  0.014074111009165861
Bond Position:  [0.81237072]


portfolio before change:  [2.31767595]
curr_Stock_Price:  106.94118498731176
curr_Factors:  [1.06941185e+02 3.91537284e-02]
mat_Sqrt:  [[ 2.11607743e+01  0.00000000e+00]
 [-7.91492043e-03  1.81353610e-02]]
grads:  [2.31252809e-02 2.45477545e+01]
Stock Position:  0.023125280887182784
Bond Position:  [-0.15536899]


portfolio before change:  [2.35989214]
curr_Stock_Price:  108.76840758846924
curr_Factors:  [1.08768408e+02 3.98823158e-02]
mat_Sqrt:  [[ 2.17216571e+01  0.00000000e+00]
 [-7.98822291e-03  1.83033181e-02]]
grads:  [-0.00870136  6.24657909]
Stock Position:  -0.008701360250450851
Bond Position:  [3.30632524]


portfolio before change:  [2.33318999]
curr_Stock_Price:  111.93214657906381
curr_Factors:  [1.11932147e+02 3.98051062e-02]
mat_Sqrt:  [[ 2.23318255e+01  0.00000000e+00]
 [-7.98048682e-03  1.82855925e-02]]
grads:  [-5.86806737e-03  1.17659991e+01]
Stock Position:  -0.005868067373078464
Bond Position:  [2.99001537]


portfolio before change:  [2.34025817]
curr_Stock_Price:  110.85503183347791
curr_Factors:  [1.10855032e+02 4.17447196e-02]
mat_Sqrt:  [[ 2.26493731e+01  0.00000000e+00]
 [-8.17260983e-03  1.87258016e-02]]
grads:  [-4.20781719e-03  9.81133358e+00]
Stock Position:  -0.004207817185564719
Bond Position:  [2.80671588]


portfolio before change:  [2.32385538]
curr_Stock_Price:  114.9199796608867
curr_Factors:  [1.14919980e+02 4.04091789e-02]
mat_Sqrt:  [[ 2.31012539e+01  0.00000000e+00]
 [-8.04081378e-03  1.84238189e-02]]
grads:  [2.59619093e-02 3.51258339e+01]
Stock Position:  0.025961909339141113
Bond Position:  [-0.65968671]


portfolio before change:  [2.29757911]
curr_Stock_Price:  113.91422435038498
curr_Factors:  [1.13914224e+02 3.98837197e-02]
mat_Sqrt:  [[ 2.27497058e+01  0.00000000e+00]
 [-7.98836351e-03  1.83036402e-02]]
grads:  [1.13469298e-03 7.20390558e+00]
Stock Position:  0.001134692979557194
Bond Position:  [2.16832144]


portfolio before change:  [2.29700414]
curr_Stock_Price:  112.92971026108887
curr_Factors:  [1.12929710e+02 3.97777438e-02]
mat_Sqrt:  [[ 2.25231063e+01  0.00000000e+00]
 [-7.97774342e-03  1.82793065e-02]]
grads:  [6.14511138e-03 2.41788872e+01]
Stock Position:  0.0061451113846459566
Bond Position:  [1.60303849]


portfolio before change:  [2.30477808]
curr_Stock_Price:  114.12954767047339
curr_Factors:  [1.14129548e+02 3.99678111e-02]
mat_Sqrt:  [[ 2.28167234e+01  0.00000000e+00]
 [-7.99678046e-03  1.83229259e-02]]
grads:  [ 0.01293178 11.23631216]
Stock Position:  0.01293178155413836
Bond Position:  [0.8288797]


portfolio before change:  [2.2862063]
curr_Stock_Price:  112.67738709638162
curr_Factors:  [1.12677387e+02 4.11262077e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.2862063]
Stock Price:  111.73353500400552
PL:  [-9.4473287]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.49189336e-01 -4.78507095e-01]
 [ 2.55994589e-01 -1.34199557e-01]
 [-1.28641124e-01 -7.74701597e-02]
 [ 2.29633647e-01 -2.48036312e-01]
 [-4.66005925e-01  1.75966892e-01]
 [ 3.85725293e-02  1.35718985e-01]
 [-1.48763117e-01 -3.46003909e-02]
 [ 3.15396925e-01  4.75813785e-03]
 [ 1.10181677e-01  1.78468706e-01]
 [-2.37107325e-01  7.92515358e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.67834556e-01 -2.60370656e-01]
 [-1.07468801e-03 -8.25151202e-02]
 [ 9.67925388e-02  3.34035083e-02]
 [-6.98970013e-03 -5.19489436e-02]
 [ 7.40891197e-01 -3.53997535e-01]
 [ 1.72570818e-01  1.42407439e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.37097723]
curr_Stock_Price:  98.98624258468796
curr_Factors:  [9.89862426e+01 4.06680146e-02]
mat_Sqrt:  [[ 1.99618747e+01  0.00000000e+00]
 [-8.06652487e-03  1.84827304e-02]]
grads:  [ 0.00139624 -0.07308629]
Stock Position:  0.001396240486436274
Bond Position:  [-4.50918583]


portfolio before change:  [-4.37056165]
curr_Stock_Price:  100.0913624628943
curr_Factors:  [1.00091362e+02 3.87229033e-02]
mat_Sqrt:  [[ 1.96961144e+01  0.00000000e+00]
 [-7.87125437e-03  1.80353095e-02]]
grads:  [-0.00945998 -3.69563773]
Stock Position:  -0.009459981133952147
Bond Position:  [-3.42369925]


portfolio before change:  [-4.38389839]
curr_Stock_Price:  101.41067838064926
curr_Factors:  [1.01410678e+02 3.69795650e-02]
mat_Sqrt:  [[ 1.95013460e+01  0.00000000e+00]
 [-7.69202861e-03  1.76246517e-02]]
grads:  [-1.83590894e-02 -2.71498753e+01]
Stock Position:  -0.01835908939342611
Bond Position:  [-2.52209068]


portfolio before change:  [-4.41402119]
curr_Stock_Price:  103.01708707819083
curr_Factors:  [1.03017087e+02 3.59536425e-02]
mat_Sqrt:  [[ 1.95335291e+01  0.00000000e+00]
 [-7.58457830e-03  1.73784521e-02]]
grads:  [ 0.01010699 -7.72218127]
Stock Position:  0.010106985753791362
Bond Position:  [-5.45521342]


portfolio before change:  [-4.41307784]
curr_Stock_Price:  103.24537710624983
curr_Factors:  [1.03245377e+02 3.48928792e-02]
mat_Sqrt:  [[ 1.92858604e+01  0.00000000e+00]
 [-7.47185430e-03  1.71201690e-02]]
grads:  [-0.00842337 -4.5250815 ]
Stock Position:  -0.008423366698686211
Bond Position:  [-3.54340417]


portfolio before change:  [-4.37890057]
curr_Stock_Price:  99.08276174035335
curr_Factors:  [9.90827617e+01 3.70516191e-02]
mat_Sqrt:  [[ 1.90722398e+01  0.00000000e+00]
 [-7.69951886e-03  1.76418140e-02]]
grads:  [ 6.36431416e-03 -1.40595696e+01]
Stock Position:  0.0063643141576968125
Bond Position:  [-5.00949439]


portfolio before change:  [-4.37954049]
curr_Stock_Price:  99.1790180377089
curr_Factors:  [9.91790180e+01 3.61557613e-02]
mat_Sqrt:  [[ 1.88585614e+01  0.00000000e+00]
 [-7.60586734e-03  1.74272314e-02]]
grads:  [-0.02063825 10.09723734]
Stock Position:  -0.020638248575660444
Bond Position:  [-2.33265927]


portfolio before change:  [-4.38448447]
curr_Stock_Price:  99.39031188384357
curr_Factors:  [9.93903119e+01 3.58108699e-02]
mat_Sqrt:  [[ 1.88083842e+01  0.00000000e+00]
 [-7.56950407e-03  1.73439127e-02]]
grads:  [5.20008253e-03 7.82516536e+00]
Stock Position:  0.005200082527748863
Bond Position:  [-4.90132229]


portfolio before change:  [-4.3732286]
curr_Stock_Price:  101.79053310637481
curr_Factors:  [1.01790533e+02 3.29676000e-02]
mat_Sqrt:  [[ 1.84820889e+01  0.00000000e+00]
 [-7.26279285e-03  1.66411490e-02]]
grads:  [-0.0088661  -2.07920684]
Stock Position:  -0.008866095510823496
Bond Position:  [-3.47074401]


portfolio before change:  [-4.36337013]
curr_Stock_Price:  100.58072601687104
curr_Factors:  [1.00580726e+02 3.40920060e-02]
mat_Sqrt:  [[ 1.85712461e+01  0.00000000e+00]
 [-7.38560828e-03  1.69225545e-02]]
grads:  [0.0170949  0.28117137]
Stock Position:  0.01709489743554898
Bond Position:  [-6.08278733]


portfolio before change:  [-4.36026649]
curr_Stock_Price:  100.85124717143442
curr_Factors:  [1.00851247e+02 3.51811040e-02]
mat_Sqrt:  [[ 1.89162918e+01  0.00000000e+00]
 [-7.50265063e-03  1.71907322e-02]]
grads:  [9.94231890e-03 1.03816814e+01]
Stock Position:  0.00994231890453579
Bond Position:  [-5.36296175]


portfolio before change:  [-4.36435509]
curr_Stock_Price:  100.57488394560684
curr_Factors:  [1.00574884e+02 3.46229944e-02]
mat_Sqrt:  [[ 1.87142253e+01  0.00000000e+00]
 [-7.44290206e-03  1.70538310e-02]]
grads:  [-0.01082167  4.64713973]
Stock Position:  -0.010821667247307185
Bond Position:  [-3.27596716]


portfolio before change:  [-4.37585404]
curr_Stock_Price:  101.56177957768
curr_Factors:  [1.0156178e+02 3.3971592e-02]
mat_Sqrt:  [[ 1.87192417e+01  0.00000000e+00]
 [-7.37255364e-03  1.68926426e-02]]
grads:  [3.54849446e-04 2.33034605e+00]
Stock Position:  0.00035484944567583366
Bond Position:  [-4.41189318]


portfolio before change:  [-4.37678978]
curr_Stock_Price:  102.03344122739185
curr_Factors:  [1.02033441e+02 3.20054538e-02]
mat_Sqrt:  [[ 1.82538522e+01  0.00000000e+00]
 [-7.15602725e-03  1.63965183e-02]]
grads:  [ -0.02089803 -15.87963075]
Stock Position:  -0.020898034213524527
Bond Position:  [-2.24449143]


portfolio before change:  [-4.35725868]
curr_Stock_Price:  101.07199695486786
curr_Factors:  [1.01071997e+02 3.03509405e-02]
mat_Sqrt:  [[ 1.76082795e+01  0.00000000e+00]
 [-6.96860852e-03  1.59670880e-02]]
grads:  [-2.10623865e-03 -5.16782522e+00]
Stock Position:  -0.002106238654494461
Bond Position:  [-4.14437693]


portfolio before change:  [-4.35772756]
curr_Stock_Price:  100.80263466190101
curr_Factors:  [1.00802635e+02 2.98656759e-02]
mat_Sqrt:  [[ 1.74203974e+01  0.00000000e+00]
 [-6.91267542e-03  1.58389292e-02]]
grads:  [0.00639314 2.10894991]
Stock Position:  0.006393139177842077
Bond Position:  [-5.00217283]


portfolio before change:  [-4.3685952]
curr_Stock_Price:  99.29837491425913
curr_Factors:  [9.92983749e+01 3.00873564e-02]
mat_Sqrt:  [[ 1.72240055e+01  0.00000000e+00]
 [-6.93828295e-03  1.58976034e-02]]
grads:  [-1.72213588e-03 -3.26772170e+00]
Stock Position:  -0.0017221358759009755
Bond Position:  [-4.19758991]


portfolio before change:  [-4.36583698]
curr_Stock_Price:  97.08731308955498
curr_Factors:  [9.70873131e+01 3.29510199e-02]
mat_Sqrt:  [[ 1.76236927e+01  0.00000000e+00]
 [-7.26096631e-03  1.66369639e-02]]
grads:  [  0.03327305 -21.27777267]
Stock Position:  0.03327304981914842
Bond Position:  [-7.59622798]


portfolio before change:  [-4.36566606]
curr_Stock_Price:  97.14953193542922
curr_Factors:  [9.71495319e+01 3.20207014e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.36566606]
Stock Price:  97.47963624634195
PL:  [-4.36566606]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.04026225e-01  5.98582703e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.82772433e-01 -1.22220945e+00]
 [-7.53501904e-03  2.78841180e-01]
 [-4.50098917e-01 -1.82826109e-02]
 [ 3.06086969e-01 -1.25821373e-01]
 [-2.43689204e-01  7.65146923e-02]
 [-9.28190320e-02  2.30989077e-02]
 [-2.44324181e-01  1.50745074e-01]
 [ 1.19718138e-01  1.32661493e-02]
 [-9.20024200e-02 -4.79529679e-03]
 [-1.46318566e-01  2.72654278e-02]
 [ 8.17826073e-02 -7.36797948e-03]
 [ 2.13619541e-02 -1.06376627e-01]
 [-2.43451676e-01 -1.24145355e-01]
 [ 8.82052257e-02  1.29308003e-02]
 [ 2.74715324e-02 -5.75553650e-02]
 [ 1.14962184e+00 -5.24060133e-01]
 [ 1.93435444e-01  2.24714235e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.06439984]
curr_Stock_Price:  100.21066531903493
curr_Factors:  [1.00210665e+02 4.00030999e-02]
mat_Sqrt:  [[ 2.00429097e+01  0.00000000e+00]
 [-8.00030998e-03  1.83310130e-02]]
grads:  [-0.00388676  3.26540984]
Stock Position:  -0.0038867577195143537
Bond Position:  [4.45389441]


portfolio before change:  [4.06796319]
curr_Stock_Price:  99.58038741858273
curr_Factors:  [9.95803874e+01 4.15660907e-02]
mat_Sqrt:  [[ 2.03022140e+01  0.00000000e+00]
 [-8.15510546e-03  1.86856940e-02]]
grads:  [-0.00917756 -3.56700533]
Stock Position:  -0.009177564076900692
Bond Position:  [4.98186857]


portfolio before change:  [4.09970634]
curr_Stock_Price:  96.25733436708263
curr_Factors:  [9.62573344e+01 4.26561970e-02]
mat_Sqrt:  [[ 1.98803899e+01  0.00000000e+00]
 [-8.26135069e-03  1.89291324e-02]]
grads:  [-3.60248654e-02 -6.45676423e+01]
Stock Position:  -0.036024865351631435
Bond Position:  [7.56736385]


portfolio before change:  [4.14085679]
curr_Stock_Price:  95.16757675469678
curr_Factors:  [9.51675768e+01 4.20355191e-02]
mat_Sqrt:  [[ 1.95117947e+01  0.00000000e+00]
 [-8.20102619e-03  1.87909116e-02]]
grads:  [5.85088407e-03 1.48391513e+01]
Stock Position:  0.005850884070956212
Bond Position:  [3.58404233]


portfolio before change:  [4.13495036]
curr_Stock_Price:  94.0049234776663
curr_Factors:  [9.40049235e+01 4.38448407e-02]
mat_Sqrt:  [[ 1.96838410e+01  0.00000000e+00]
 [-8.37566386e-03  1.91910568e-02]]
grads:  [-0.02327178 -0.95266306]
Stock Position:  -0.02327178431613425
Bond Position:  [6.32261267]


portfolio before change:  [4.13085778]
curr_Stock_Price:  94.2487138098167
curr_Factors:  [9.42487138e+01 4.33633868e-02]
mat_Sqrt:  [[ 1.96262366e+01  0.00000000e+00]
 [-8.32955094e-03  1.90853988e-02]]
grads:  [ 0.01279787 -6.59254617]
Stock Position:  0.01279786978406817
Bond Position:  [2.92467501]


portfolio before change:  [4.14023307]
curr_Stock_Price:  94.92414127185454
curr_Factors:  [9.49241413e+01 4.05903989e-02]
mat_Sqrt:  [[ 1.91244228e+01  0.00000000e+00]
 [-8.05882362e-03  1.84650846e-02]]
grads:  [-0.01099617  4.14374989]
Stock Position:  -0.010996172649524646
Bond Position:  [5.18403532]


portfolio before change:  [4.14953203]
curr_Stock_Price:  94.19636176656905
curr_Factors:  [9.41963618e+01 4.16974709e-02]
mat_Sqrt:  [[ 1.92348581e+01  0.00000000e+00]
 [-8.16798344e-03  1.87152012e-02]]
grads:  [-0.00430145  1.2342324 ]
Stock Position:  -0.004301453220528685
Bond Position:  [4.55471328]


portfolio before change:  [4.1584056]
curr_Stock_Price:  92.39819122839734
curr_Factors:  [9.23981912e+01 4.35254999e-02]
mat_Sqrt:  [[ 1.92768183e+01  0.00000000e+00]
 [-8.34510634e-03  1.91210407e-02]]
grads:  [-0.00926157  7.88372745]
Stock Position:  -0.009261571824639252
Bond Position:  [5.01415808]


portfolio before change:  [4.14373198]
curr_Stock_Price:  94.1179122489205
curr_Factors:  [9.41179122e+01 4.22953787e-02]
mat_Sqrt:  [[ 1.93561395e+01  0.00000000e+00]
 [-8.22633612e-03  1.88489040e-02]]
grads:  [0.00648414 0.70381542]
Stock Position:  0.006484142171346753
Bond Position:  [3.53345805]


portfolio before change:  [4.12416962]
curr_Stock_Price:  90.96470667138475
curr_Factors:  [9.09647067e+01 4.43959668e-02]
mat_Sqrt:  [[ 1.91665825e+01  0.00000000e+00]
 [-8.42814018e-03  1.93112952e-02]]
grads:  [-0.00490934 -0.24831565]
Stock Position:  -0.004909339431435613
Bond Position:  [4.57074624]


portfolio before change:  [4.10618252]
curr_Stock_Price:  94.86134566523334
curr_Factors:  [9.48613457e+01 4.28541575e-02]
mat_Sqrt:  [[ 1.96374803e+01  0.00000000e+00]
 [-8.28049830e-03  1.89730051e-02]]
grads:  [-0.00684502  1.43706427]
Stock Position:  -0.006845020632761404
Bond Position:  [4.75551039]


portfolio before change:  [4.11203135]
curr_Stock_Price:  94.18058819515214
curr_Factors:  [9.41805882e+01 4.21031913e-02]
mat_Sqrt:  [[ 1.93249735e+01  0.00000000e+00]
 [-8.20762488e-03  1.88060311e-02]]
grads:  [ 0.00406557 -0.39178811]
Stock Position:  0.004065566120677509
Bond Position:  [3.72913394]


portfolio before change:  [4.11182671]
curr_Stock_Price:  93.90091266413114
curr_Factors:  [9.39009127e+01 4.22347151e-02]
mat_Sqrt:  [[ 1.92976577e+01  0.00000000e+00]
 [-8.22043455e-03  1.88353818e-02]]
grads:  [-1.29884221e-03 -5.64770221e+00]
Stock Position:  -0.001298842209431272
Bond Position:  [4.23378918]


portfolio before change:  [4.11251078]
curr_Stock_Price:  94.18925548920265
curr_Factors:  [9.41892555e+01 4.23116183e-02]
mat_Sqrt:  [[ 1.93745303e+01  0.00000000e+00]
 [-8.22791525e-03  1.88525222e-02]]
grads:  [-0.01536208 -6.58507934]
Stock Position:  -0.01536208340816844
Bond Position:  [5.55945398]


portfolio before change:  [4.13277874]
curr_Stock_Price:  92.96039042572792
curr_Factors:  [9.29603904e+01 4.18805426e-02]
mat_Sqrt:  [[ 1.90240986e+01  0.00000000e+00]
 [-8.18589446e-03  1.87562405e-02]]
grads:  [0.00493315 0.68941323]
Stock Position:  0.0049331477667543
Bond Position:  [3.6741914]


portfolio before change:  [4.1291309]
curr_Stock_Price:  92.03471278610233
curr_Factors:  [9.20347128e+01 4.23207108e-02]
mat_Sqrt:  [[ 1.89333794e+01  0.00000000e+00]
 [-8.22879926e-03  1.88545477e-02]]
grads:  [ 1.24241515e-04 -3.05259854e+00]
Stock Position:  0.00012424151495776643
Bond Position:  [4.11769637]


portfolio before change:  [4.13024744]
curr_Stock_Price:  92.73485978307961
curr_Factors:  [9.27348598e+01 4.20964484e-02]
mat_Sqrt:  [[ 1.90267998e+01  0.00000000e+00]
 [-8.20696762e-03  1.88045252e-02]]
grads:  [  0.04840032 -27.86883094]
Stock Position:  0.04840032236274485
Bond Position:  [-0.35814967]


portfolio before change:  [4.05963217]
curr_Stock_Price:  91.27772649462898
curr_Factors:  [9.12777265e+01 4.34930796e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.05963217]
Stock Price:  92.12312733378187
PL:  [4.05963217]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.05241222e-01  6.21796751e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.16022090e-01 -9.34497459e-01]
 [-1.83110041e-02  2.77711935e-01]
 [-4.23191902e-01 -5.72490268e-02]
 [-4.80446146e-02  1.25254702e-01]
 [-2.61350219e-01  8.61986457e-02]
 [ 1.15743175e-02  1.55397800e-01]
 [-2.40818124e-01  1.34948714e-01]
 [ 1.06512693e-01  1.40936304e-02]
 [-1.06004474e-01 -5.09235030e-02]
 [-1.78547435e-01  4.63307863e-02]
 [-6.81485399e-02  1.90189393e-02]
 [-1.06853799e-01 -2.24096129e-01]
 [-1.06968885e-01 -1.28323183e-01]
 [ 8.82198261e-02  6.91655338e-02]
 [-9.47288946e-03 -5.06975690e-02]
 [ 5.00228074e-01 -2.65432209e-01]
 [ 2.23729432e-01  1.23948178e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.15648207]
curr_Stock_Price:  100.22403135842237
curr_Factors:  [1.00224031e+02 3.94993782e-02]
mat_Sqrt:  [[ 1.99189755e+01  0.00000000e+00]
 [-7.94978019e-03  1.82152347e-02]]
grads:  [-0.00392107  3.41360822]
Stock Position:  -0.003921074500758543
Bond Position:  [4.54946797]


portfolio before change:  [4.16298404]
curr_Stock_Price:  98.85592253287383
curr_Factors:  [9.88559225e+01 4.12078105e-02]
mat_Sqrt:  [[ 2.00674626e+01  0.00000000e+00]
 [-8.11988281e-03  1.86049888e-02]]
grads:  [-0.00928492 -3.58247838]
Stock Position:  -0.009284924232429732
Bond Position:  [5.08085379]


portfolio before change:  [4.17343066]
curr_Stock_Price:  97.86762729531821
curr_Factors:  [9.78676273e+01 4.05069101e-02]
mat_Sqrt:  [[ 1.96971602e+01  0.00000000e+00]
 [-8.05053142e-03  1.84460848e-02]]
grads:  [-3.16731047e-02 -5.06610193e+01]
Stock Position:  -0.031673104700354934
Bond Position:  [7.27320226]


portfolio before change:  [4.22463044]
curr_Stock_Price:  96.3085361942604
curr_Factors:  [9.63085362e+01 4.38258196e-02]
mat_Sqrt:  [[ 2.01618233e+01  0.00000000e+00]
 [-8.37384686e-03  1.91868936e-02]]
grads:  [5.10332915e-03 1.44740436e+01]
Stock Position:  0.005103329148983878
Bond Position:  [3.73313628]


portfolio before change:  [4.22739893]
curr_Stock_Price:  96.66812230738097
curr_Factors:  [9.66681223e+01 4.43616684e-02]
mat_Sqrt:  [[ 2.03604428e+01  0.00000000e+00]
 [-8.42488395e-03  1.93038342e-02]]
grads:  [-0.02201216 -2.96568165]
Stock Position:  -0.022012164989167873
Bond Position:  [6.35527358]


portfolio before change:  [4.23408805]
curr_Stock_Price:  96.43642767242648
curr_Factors:  [9.64364277e+01 4.68399196e-02]
mat_Sqrt:  [[ 2.08712848e+01  0.00000000e+00]
 [-8.65701284e-03  1.98357083e-02]]
grads:  [3.17231034e-04 6.31460699e+00]
Stock Position:  0.00031723103421315923
Bond Position:  [4.20349542]


portfolio before change:  [4.23471844]
curr_Stock_Price:  95.11054111344865
curr_Factors:  [9.51105411e+01 4.80294316e-02]
mat_Sqrt:  [[ 2.08440630e+01  0.00000000e+00]
 [-8.76624724e-03  2.00859958e-02]]
grads:  [-0.01073351  4.29147983]
Stock Position:  -0.010733514204164534
Bond Position:  [5.25558878]


portfolio before change:  [4.22724364]
curr_Stock_Price:  95.92936526104351
curr_Factors:  [9.59293653e+01 4.97499641e-02]
mat_Sqrt:  [[ 2.13967571e+01  0.00000000e+00]
 [-8.92187999e-03  2.04425952e-02]]
grads:  [3.71063134e-03 7.60166692e+00]
Stock Position:  0.003710631341616818
Bond Position:  [3.87128513]


portfolio before change:  [4.21714604]
curr_Stock_Price:  92.94724838978324
curr_Factors:  [9.29472484e+01 5.19563649e-02]
mat_Sqrt:  [[ 2.11863390e+01  0.00000000e+00]
 [-9.11757555e-03  2.08909900e-02]]
grads:  [-0.00858674  6.45966103]
Stock Position:  -0.008586744375379934
Bond Position:  [5.01526031]


portfolio before change:  [4.21138886]
curr_Stock_Price:  93.76375819613031
curr_Factors:  [9.37637582e+01 5.04041531e-02]
mat_Sqrt:  [[ 2.10507788e+01  0.00000000e+00]
 [-8.98034771e-03  2.05765616e-02]]
grads:  [0.00535199 0.68493613]
Stock Position:  0.005351994765900875
Bond Position:  [3.70956571]


portfolio before change:  [4.21653123]
curr_Stock_Price:  94.55129053602218
curr_Factors:  [9.45512905e+01 5.05028867e-02]
mat_Sqrt:  [[ 2.12483672e+01  0.00000000e+00]
 [-8.98913893e-03  2.05967048e-02]]
grads:  [-0.00603478 -2.4724102 ]
Stock Position:  -0.006034784299465494
Bond Position:  [4.78712788]


portfolio before change:  [4.20893833]
curr_Stock_Price:  96.00781827599786
curr_Factors:  [9.60078183e+01 4.86864020e-02]
mat_Sqrt:  [[ 2.11841206e+01  0.00000000e+00]
 [-8.82599814e-03  2.02229023e-02]]
grads:  [-0.00747385  2.29100579]
Stock Position:  -0.0074738538851630435
Bond Position:  [4.92648674]


portfolio before change:  [4.20901055]
curr_Stock_Price:  96.16296642474269
curr_Factors:  [9.61629664e+01 4.80882769e-02]
mat_Sqrt:  [[ 2.10876148e+01  0.00000000e+00]
 [-8.77161576e-03  2.00982966e-02]]
grads:  [-0.00283806  0.94629608]
Stock Position:  -0.002838063708662534
Bond Position:  [4.48192718]


portfolio before change:  [4.20620916]
curr_Stock_Price:  97.54489893152308
curr_Factors:  [9.75448989e+01 4.64728950e-02]
mat_Sqrt:  [[ 2.10283127e+01  0.00000000e+00]
 [-8.62302917e-03  1.97578419e-02]]
grads:  [-9.73246743e-03 -1.13421359e+01]
Stock Position:  -0.009732467427435394
Bond Position:  [5.15556171]


portfolio before change:  [4.20110099]
curr_Stock_Price:  98.20220640368817
curr_Factors:  [9.82022064e+01 4.85806322e-02]
mat_Sqrt:  [[ 2.16447626e+01  0.00000000e+00]
 [-8.81640582e-03  2.02009235e-02]]
grads:  [-0.00752948 -6.3523424 ]
Stock Position:  -0.007529475668640247
Bond Position:  [4.94051211]


portfolio before change:  [4.20896914]
curr_Stock_Price:  97.32128574777128
curr_Factors:  [9.73212857e+01 5.05216820e-02]
mat_Sqrt:  [[ 2.18749334e+01  0.00000000e+00]
 [-8.99081149e-03  2.06005371e-02]]
grads:  [0.00541287 3.35746265]
Stock Position:  0.00541286859991438
Bond Position:  [3.68218181]


portfolio before change:  [4.22103317]
curr_Stock_Price:  99.37996586692654
curr_Factors:  [9.93799659e+01 4.98722362e-02]
mat_Sqrt:  [[ 2.21936260e+01  0.00000000e+00]
 [-8.93283706e-03  2.04677010e-02]]
grads:  [-1.42379269e-03 -2.47695474e+00]
Stock Position:  -0.0014237926913475256
Bond Position:  [4.36252964]


portfolio before change:  [4.22110662]
curr_Stock_Price:  100.09447648544423
curr_Factors:  [1.00094476e+02 4.83793442e-02]
mat_Sqrt:  [[ 2.20160854e+01  0.00000000e+00]
 [-8.79812200e-03  2.01590300e-02]]
grads:  [  0.01745923 -13.16691375]
Stock Position:  0.0174592328012262
Bond Position:  [2.47353386]


portfolio before change:  [4.22413151]
curr_Stock_Price:  100.23230758904144
curr_Factors:  [1.00232308e+02 4.90368158e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.22413151]
Stock Price:  99.23662163398035
PL:  [4.22413151]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.69921529e-02  1.90470095e-01]
 [-9.21934285e-02 -4.72298034e-02]
 [-1.57938415e-01 -5.38200810e-01]
 [ 2.10741416e-01 -5.84223364e-02]
 [-1.96020404e-01 -8.85825778e-02]
 [ 4.38642722e-01 -5.54741970e-01]
 [-5.14735572e-01  2.71510032e-01]
 [ 4.05880170e-01  1.64570678e-01]
 [-6.28890477e-02 -3.75397575e-02]
 [ 2.10422644e-01  1.27748885e-02]
 [ 1.37032014e-01  2.02269380e-01]
 [-2.37794985e-01  9.26560745e-02]
 [-1.05380887e-02  3.93657029e-02]
 [-2.12387720e-01 -2.68083999e-01]
 [-8.93983584e-02 -1.19895660e-01]
 [ 8.89192722e-02  6.69866279e-02]
 [ 5.61485484e-02 -8.30530679e-02]
 [ 7.61143786e-01 -3.62420763e-01]
 [ 1.47193043e-01  1.57633242e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.22786639]
curr_Stock_Price:  101.10531276664307
curr_Factors:  [1.01105313e+02 4.07225511e-02]
mat_Sqrt:  [[ 2.04028795e+01  0.00000000e+00]
 [-8.07193172e-03  1.84951191e-02]]
grads:  [2.75136711e-03 1.02983979e+01]
Stock Position:  0.002751367111988206
Bond Position:  [9.94968855]


portfolio before change:  [10.2316762]
curr_Stock_Price:  101.58583006675993
curr_Factors:  [1.01585830e+02 3.91000204e-02]
mat_Sqrt:  [[ 2.00873028e+01  0.00000000e+00]
 [-7.90949004e-03  1.81229184e-02]]
grads:  [-0.0056158  -2.60608156]
Stock Position:  -0.005615796499502813
Bond Position:  [10.80216155]


portfolio before change:  [10.23809476]
curr_Stock_Price:  100.9238255213062
curr_Factors:  [1.00923826e+02 3.83446186e-02]
mat_Sqrt:  [[ 1.97626835e+01  0.00000000e+00]
 [-7.83271280e-03  1.79469996e-02]]
grads:  [-1.98772857e-02 -2.99883446e+01]
Stock Position:  -0.019877285668876213
Bond Position:  [12.24418647]


portfolio before change:  [10.21860243]
curr_Stock_Price:  102.05847547637377
curr_Factors:  [1.02058475e+02 3.92736736e-02]
mat_Sqrt:  [[ 2.02255267e+01  0.00000000e+00]
 [-7.92703461e-03  1.81631181e-02]]
grads:  [ 0.00915891 -3.21653673]
Stock Position:  0.009158911928755935
Bond Position:  [9.28385784]


portfolio before change:  [10.21883835]
curr_Stock_Price:  101.8307920690591
curr_Factors:  [1.01830792e+02 3.71778557e-02]
mat_Sqrt:  [[ 1.96345653e+01  0.00000000e+00]
 [-7.71262401e-03  1.76718417e-02]]
grads:  [-0.01195244 -5.01263985]
Stock Position:  -0.011952442386964867
Bond Position:  [11.43596502]


portfolio before change:  [10.22781453]
curr_Stock_Price:  101.3190278738142
curr_Factors:  [1.01319028e+02 3.53774119e-02]
mat_Sqrt:  [[ 1.90569785e+01  0.00000000e+00]
 [-7.52355361e-03  1.72386270e-02]]
grads:  [ 1.03129401e-02 -3.21801714e+01]
Stock Position:  0.010312940118204494
Bond Position:  [9.18291746]


portfolio before change:  [10.22448803]
curr_Stock_Price:  100.77383742451073
curr_Factors:  [1.00773837e+02 3.41924828e-02]
mat_Sqrt:  [[ 1.86343014e+01  0.00000000e+00]
 [-7.39648379e-03  1.69474734e-02]]
grads:  [-0.02126395 16.020679  ]
Stock Position:  -0.021263951442391193
Bond Position:  [12.36733802]


portfolio before change:  [10.17738288]
curr_Stock_Price:  103.13451664915735
curr_Factors:  [1.03134517e+02 3.49740744e-02]
mat_Sqrt:  [[ 1.92875539e+01  0.00000000e+00]
 [-7.48054270e-03  1.71400766e-02]]
grads:  [0.02476751 9.60151359]
Stock Position:  0.024767510988282837
Bond Position:  [7.62299761]


portfolio before change:  [10.16925178]
curr_Stock_Price:  102.72926445781687
curr_Factors:  [1.02729264e+02 3.48339882e-02]
mat_Sqrt:  [[ 1.91732519e+01  0.00000000e+00]
 [-7.46554627e-03  1.71057154e-02]]
grads:  [-0.00413455 -2.19457395]
Stock Position:  -0.004134548556632969
Bond Position:  [10.59399091]


portfolio before change:  [10.17256861]
curr_Stock_Price:  102.56769980958747
curr_Factors:  [1.02567700e+02 3.28210615e-02]
mat_Sqrt:  [[ 1.85817635e+01  0.00000000e+00]
 [-7.24663359e-03  1.66041235e-02]]
grads:  [0.0116242  0.76938048]
Stock Position:  0.011624196117680625
Bond Position:  [8.98030155]


portfolio before change:  [10.16673004]
curr_Stock_Price:  101.8722600837487
curr_Factors:  [1.01872260e+02 3.25704083e-02]
mat_Sqrt:  [[ 1.83851655e+01  0.00000000e+00]
 [-7.21890943e-03  1.65405994e-02]]
grads:  [ 0.01225497 12.22866082]
Stock Position:  0.01225496769360406
Bond Position:  [8.91828878]


portfolio before change:  [10.1643511]
curr_Stock_Price:  101.49618546405264
curr_Factors:  [1.01496185e+02 3.23435932e-02]
mat_Sqrt:  [[ 1.82534035e+01  0.00000000e+00]
 [-7.19372985e-03  1.64829058e-02]]
grads:  [-0.01081204  5.62134345]
Stock Position:  -0.010812041657280377
Bond Position:  [11.26173209]


portfolio before change:  [10.17015576]
curr_Stock_Price:  101.2197465513234
curr_Factors:  [1.01219747e+02 2.98966230e-02]
mat_Sqrt:  [[ 1.75015419e+01  0.00000000e+00]
 [-6.91625598e-03  1.58471333e-02]]
grads:  [3.79538704e-04 2.48408985e+00]
Stock Position:  0.00037953870381972517
Bond Position:  [10.13173895]


portfolio before change:  [10.17218006]
curr_Stock_Price:  99.87877121445919
curr_Factors:  [9.98787712e+01 3.18792530e-02]
mat_Sqrt:  [[ 1.78331170e+01  0.00000000e+00]
 [-7.14190485e-03  1.63641598e-02]]
grads:  [ -0.01847064 -16.38238702]
Stock Position:  -0.018470644749432753
Bond Position:  [12.01700536]


portfolio before change:  [10.18565369]
curr_Stock_Price:  99.31197983620106
curr_Factors:  [9.93119798e+01 3.26476042e-02]
mat_Sqrt:  [[ 1.79443321e+01  0.00000000e+00]
 [-7.22745921e-03  1.65601895e-02]]
grads:  [-0.00789804 -7.23999325]
Stock Position:  -0.007898043438475
Bond Position:  [10.97002402]


portfolio before change:  [10.20394146]
curr_Stock_Price:  97.34378069115348
curr_Factors:  [9.73437807e+01 3.15333654e-02]
mat_Sqrt:  [[ 1.72859547e+01  0.00000000e+00]
 [-7.10305460e-03  1.62751427e-02]]
grads:  [0.0068353  4.11588575]
Stock Position:  0.006835296939880427
Bond Position:  [9.53856781]


portfolio before change:  [10.20008495]
curr_Stock_Price:  96.4306601126483
curr_Factors:  [9.64306601e+01 3.34873471e-02]
mat_Sqrt:  [[ 1.76463753e+01  0.00000000e+00]
 [-7.31981935e-03  1.67718131e-02]]
grads:  [ 1.12777936e-03 -4.95194332e+00]
Stock Position:  0.0011277793633629833
Bond Position:  [10.09133244]


portfolio before change:  [10.20310566]
curr_Stock_Price:  96.871853437732
curr_Factors:  [9.68718534e+01 3.32903377e-02]
mat_Sqrt:  [[ 1.76748896e+01  0.00000000e+00]
 [-7.29825598e-03  1.67224052e-02]]
grads:  [  0.03411452 -21.67276523]
Stock Position:  0.0341145212889698
Bond Position:  [6.89836876]


portfolio before change:  [10.1529109]
curr_Stock_Price:  95.34993330403418
curr_Factors:  [9.53499333e+01 3.34598509e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.1529109]
Stock Price:  94.66700628570847
PL:  [10.1529109]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 9.65277905e-03  2.45538533e-01]
 [ 2.13990885e-01  2.21794280e-03]
 [-1.12028515e-01 -2.24964100e-01]
 [ 2.77540100e-01 -1.70277888e-01]
 [-1.55015181e-01 -8.16792264e-02]
 [ 4.37300022e-01 -5.52647748e-01]
 [-5.36779026e-01  2.98436520e-01]
 [ 6.18890526e-01  1.81302455e-01]
 [ 6.97137445e-02 -8.90218232e-02]
 [ 1.39627038e-01  1.66144180e-02]
 [ 1.82042396e-01  2.64759251e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-7.89317534e-02  1.07281565e-01]
 [-2.67470593e-01 -1.31326979e-01]
 [ 2.04843946e-01  1.62252187e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.31608188e-02  1.94179916e-01]
 [ 2.60626020e-01 -1.74711090e-01]
 [ 1.17756511e-01  1.86069775e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.84845856]
curr_Stock_Price:  101.48570034267873
curr_Factors:  [1.01485700e+02 4.00124874e-02]
mat_Sqrt:  [[ 2.03003080e+01  0.00000000e+00]
 [-8.00124864e-03  1.83331638e-02]]
grads:  [5.75432550e-03 1.33931348e+01]
Stock Position:  0.005754325504140094
Bond Position:  [12.26447681]


portfolio before change:  [12.86539717]
curr_Stock_Price:  103.89642798142523
curr_Factors:  [1.03896428e+02 4.07318694e-02]
mat_Sqrt:  [[ 2.09685205e+01  0.00000000e+00]
 [-8.07285520e-03  1.84972350e-02]]
grads:  [0.0102515  0.11990672]
Stock Position:  0.01025150413683785
Bond Position:  [11.80030251]


portfolio before change:  [12.86479686]
curr_Stock_Price:  103.55006374392765
curr_Factors:  [1.03550064e+02 4.38516442e-02]
mat_Sqrt:  [[ 2.16841954e+01  0.00000000e+00]
 [-8.37631367e-03  1.91925457e-02]]
grads:  [-9.69419865e-03 -1.17214310e+01]
Stock Position:  -0.009694198648670362
Bond Position:  [13.86863175]


portfolio before change:  [12.8690256]
curr_Stock_Price:  103.47154847825578
curr_Factors:  [1.03471548e+02 4.23484346e-02]
mat_Sqrt:  [[ 2.12931360e+01  0.00000000e+00]
 [-8.23149411e-03  1.88607224e-02]]
grads:  [ 0.00954414 -9.02817422]
Stock Position:  0.009544143060449099
Bond Position:  [11.88147834]


portfolio before change:  [12.86455512]
curr_Stock_Price:  102.69188540407089
curr_Factors:  [1.02691885e+02 4.43963588e-02]
mat_Sqrt:  [[ 2.16376357e+01  0.00000000e+00]
 [-8.42817739e-03  1.93113804e-02]]
grads:  [-0.00881163 -4.22959026]
Stock Position:  -0.008811633629248661
Bond Position:  [13.76943839]


portfolio before change:  [12.88061312]
curr_Stock_Price:  101.26023128651107
curr_Factors:  [1.01260231e+02 4.51734276e-02]
mat_Sqrt:  [[ 2.15218915e+01  0.00000000e+00]
 [-8.50161656e-03  1.94796507e-02]]
grads:  [ 9.11187432e-03 -2.83705163e+01]
Stock Position:  0.009111874318616549
Bond Position:  [11.95794262]


portfolio before change:  [12.88171727]
curr_Stock_Price:  101.05327969768615
curr_Factors:  [1.01053280e+02 4.60191953e-02]
mat_Sqrt:  [[ 2.16780355e+01  0.00000000e+00]
 [-8.58083402e-03  1.96611607e-02]]
grads:  [-0.01875311 15.17898789]
Stock Position:  -0.018753113036134885
Bond Position:  [14.77678084]


portfolio before change:  [12.80613829]
curr_Stock_Price:  105.28050507966192
curr_Factors:  [1.05280505e+02 4.41603272e-02]
mat_Sqrt:  [[ 2.21240230e+01  0.00000000e+00]
 [-8.40574348e-03  1.92599779e-02]]
grads:  [0.0315502  9.41343007]
Stock Position:  0.03155020245462539
Bond Position:  [9.48451704]


portfolio before change:  [12.7680179]
curr_Stock_Price:  103.99709605761356
curr_Factors:  [1.03997096e+02 4.27130331e-02]
mat_Sqrt:  [[ 2.14932168e+01  0.00000000e+00]
 [-8.26685267e-03  1.89417391e-02]]
grads:  [ 1.43586863e-03 -4.69977033e+00]
Stock Position:  0.0014358686250086057
Bond Position:  [12.61869173]


portfolio before change:  [12.77089077]
curr_Stock_Price:  103.80056488519956
curr_Factors:  [1.03800565e+02 4.01198051e-02]
mat_Sqrt:  [[ 2.07911793e+01  0.00000000e+00]
 [-8.01197155e-03  1.83577330e-02]]
grads:  [0.00706445 0.90503647]
Stock Position:  0.007064446055812184
Bond Position:  [12.03759728]


portfolio before change:  [12.77060799]
curr_Stock_Price:  103.33448968538931
curr_Factors:  [1.03334490e+02 4.09056462e-02]
mat_Sqrt:  [[ 2.08995496e+01  0.00000000e+00]
 [-8.09005772e-03  1.85366509e-02]]
grads:  [1.42391971e-02 1.42830143e+01]
Stock Position:  0.014239197064618745
Bond Position:  [11.29920782]


portfolio before change:  [12.82065027]
curr_Stock_Price:  106.65048624689167
curr_Factors:  [1.06650486e+02 3.87907241e-02]
mat_Sqrt:  [[ 2.10051982e+01  0.00000000e+00]
 [-7.87814436e-03  1.80510964e-02]]
grads:  [-0.00899815  6.33386034]
Stock Position:  -0.008998151899141481
Bond Position:  [13.78030755]


portfolio before change:  [12.82998869]
curr_Stock_Price:  105.99558316801573
curr_Factors:  [1.05995583e+02 3.83173330e-02]
mat_Sqrt:  [[ 2.07484379e+01  0.00000000e+00]
 [-7.82992547e-03  1.79406131e-02]]
grads:  [-1.54759794e-03  5.97981601e+00]
Stock Position:  -0.0015475979384282708
Bond Position:  [12.99402724]


portfolio before change:  [12.83286]
curr_Stock_Price:  106.2395822096104
curr_Factors:  [1.06239582e+02 3.85866836e-02]
mat_Sqrt:  [[ 2.08691654e+01  0.00000000e+00]
 [-7.85739739e-03  1.80035592e-02]]
grads:  [-0.01556298 -7.29450093]
Stock Position:  -0.01556297914347571
Bond Position:  [14.4862644]


portfolio before change:  [12.83942276]
curr_Stock_Price:  106.05062416600467
curr_Factors:  [1.06050624e+02 3.94539840e-02]
mat_Sqrt:  [[ 2.10648641e+01  0.00000000e+00]
 [-7.94521079e-03  1.82047649e-02]]
grads:  [0.01308609 8.91262194]
Stock Position:  0.013086085217167512
Bond Position:  [11.45163526]


portfolio before change:  [12.86974127]
curr_Stock_Price:  108.14867236329337
curr_Factors:  [1.08148672e+02 4.12457309e-02]
mat_Sqrt:  [[ 2.19639625e+01  0.00000000e+00]
 [-8.12361800e-03  1.86135472e-02]]
grads:  [0.00437061 0.94184389]
Stock Position:  0.004370610725938737
Bond Position:  [12.39706552]


portfolio before change:  [12.86691872]
curr_Stock_Price:  106.79366759482164
curr_Factors:  [1.06793668e+02 3.97451805e-02]
mat_Sqrt:  [[ 2.12905920e+01  0.00000000e+00]
 [-7.97447733e-03  1.82718230e-02]]
grads:  [1.48357755e-03 1.06272875e+01]
Stock Position:  0.0014835775506427651
Bond Position:  [12.70848204]


portfolio before change:  [12.86607317]
curr_Stock_Price:  104.08193002528041
curr_Factors:  [1.04081930e+02 4.08963597e-02]
mat_Sqrt:  [[ 2.10483309e+01  0.00000000e+00]
 [-8.08913936e-03  1.85345467e-02]]
grads:  [ 8.75964228e-03 -9.42624023e+00]
Stock Position:  0.008759642281947574
Bond Position:  [11.95435269]


portfolio before change:  [12.87201425]
curr_Stock_Price:  104.41894377167624
curr_Factors:  [1.04418944e+02 3.91979846e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.87201425]
Stock Price:  106.41868383786321
PL:  [6.45333041]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.21983677e-01  5.77975010e-01]
 [-1.19329226e-01 -5.47597502e-02]
 [-1.86493841e-01 -7.33030422e-01]
 [ 1.26543233e-01  7.45735195e-02]
 [-1.41856981e-01 -7.95631159e-02]
 [ 4.90697346e-01 -6.35543327e-01]
 [-5.24068118e-01  2.68136812e-01]
 [ 3.25165689e-02  1.43362643e-01]
 [-2.10196058e-01  8.45533909e-03]
 [ 1.49885333e-01  1.13758091e-02]
 [-1.03859036e-01 -4.38555983e-02]
 [-1.18615867e-01  1.08181563e-02]
 [ 1.77425265e-01 -2.39615502e-02]
 [ 3.76742501e-02 -8.21547246e-02]
 [-2.84142138e-01 -1.07068725e-01]
 [ 8.33167637e-02  6.06147070e-02]
 [ 2.58828646e-02 -5.64975498e-02]
 [ 1.27554611e+00 -5.76599143e-01]
 [ 1.46919449e-01  1.76853722e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.02272839]
curr_Stock_Price:  103.83344882315416
curr_Factors:  [1.03833449e+02 3.95070993e-02]
mat_Sqrt:  [[ 2.06383442e+01  0.00000000e+00]
 [-7.95055714e-03  1.82170150e-02]]
grads:  [2.29782315e-02 3.17272073e+01]
Stock Position:  0.022978231518728836
Bond Position:  [26.63681937]


portfolio before change:  [28.97355487]
curr_Stock_Price:  101.4036031201712
curr_Factors:  [1.01403603e+02 4.12553382e-02]
mat_Sqrt:  [[ 2.05965017e+01  0.00000000e+00]
 [-8.12456406e-03  1.86157149e-02]]
grads:  [-0.00695401 -2.94158728]
Stock Position:  -0.006954012977143301
Bond Position:  [29.67871684]


portfolio before change:  [28.99506732]
curr_Stock_Price:  99.3771697087861
curr_Factors:  [9.93771697e+01 4.26392096e-02]
mat_Sqrt:  [[ 2.05206539e+01  0.00000000e+00]
 [-8.25970552e-03  1.89253629e-02]]
grads:  [-2.4678285e-02 -3.8732701e+01]
Stock Position:  -0.024678284982557065
Bond Position:  [31.44752544]


portfolio before change:  [28.96634031]
curr_Stock_Price:  100.8598449047242
curr_Factors:  [1.00859845e+02 4.05922320e-02]
mat_Sqrt:  [[ 2.03207514e+01  0.00000000e+00]
 [-8.05900559e-03  1.84655016e-02]]
grads:  [0.00782893 4.03853202]
Stock Position:  0.007828932243067181
Bond Position:  [28.17671541]


portfolio before change:  [28.98989037]
curr_Stock_Price:  102.96805096131075
curr_Factors:  [1.02968051e+02 4.06453815e-02]
mat_Sqrt:  [[ 2.07590796e+01  0.00000000e+00]
 [-8.06427990e-03  1.84775865e-02]]
grads:  [-0.00850621 -4.30592576]
Stock Position:  -0.00850621392684933
Bond Position:  [29.86575864]


portfolio before change:  [29.00622432]
curr_Stock_Price:  101.92568553840638
curr_Factors:  [1.01925686e+02 4.21386171e-02]
mat_Sqrt:  [[ 2.09229916e+01  0.00000000e+00]
 [-8.21107711e-03  1.88139412e-02]]
grads:  [ 1.01956500e-02 -3.37804461e+01]
Stock Position:  0.010195649972717893
Bond Position:  [27.96702571]


portfolio before change:  [28.99989193]
curr_Stock_Price:  100.61875314236758
curr_Factors:  [1.00618753e+02 4.37928792e-02]
mat_Sqrt:  [[ 2.10562332e+01  0.00000000e+00]
 [-8.37069930e-03  1.91796816e-02]]
grads:  [-0.01933126 13.98025359]
Stock Position:  -0.019331264806384
Bond Position:  [30.94497969]


portfolio before change:  [29.04411393]
curr_Stock_Price:  98.73140716793087
curr_Factors:  [9.87314072e+01 4.27531827e-02]
mat_Sqrt:  [[ 2.04145378e+01  0.00000000e+00]
 [-8.27073711e-03  1.89506394e-02]]
grads:  [4.65771778e-03 7.56505570e+00]
Stock Position:  0.004657717782253796
Bond Position:  [28.5842509]


portfolio before change:  [29.04467891]
curr_Stock_Price:  97.31827509912426
curr_Factors:  [9.73182751e+01 4.04779706e-02]
mat_Sqrt:  [[ 1.95795979e+01  0.00000000e+00]
 [-8.04765512e-03  1.84394944e-02]]
grads:  [-0.01054699  0.45854506]
Stock Position:  -0.010546991161659544
Bond Position:  [30.0710939]


portfolio before change:  [29.07701176]
curr_Stock_Price:  94.96555305688635
curr_Factors:  [9.49655531e+01 4.28692033e-02]
mat_Sqrt:  [[ 1.96625033e+01  0.00000000e+00]
 [-8.28195178e-03  1.89763355e-02]]
grads:  [0.0078754  0.59947344]
Stock Position:  0.00787540329158022
Bond Position:  [28.32911973]


portfolio before change:  [29.09265774]
curr_Stock_Price:  96.05283794231103
curr_Factors:  [9.60528379e+01 4.23871705e-02]
mat_Sqrt:  [[ 1.97754973e+01  0.00000000e+00]
 [-8.23525791e-03  1.88693464e-02]]
grads:  [-0.00621978 -2.32417157]
Stock Position:  -0.0062197772560463995
Bond Position:  [29.69008499]


portfolio before change:  [29.11374308]
curr_Stock_Price:  93.85631288398164
curr_Factors:  [9.38563129e+01 4.29546402e-02]
mat_Sqrt:  [[ 1.94521913e+01  0.00000000e+00]
 [-8.29020050e-03  1.89952357e-02]]
grads:  [-0.0058551   0.56951946]
Stock Position:  -0.005855095450579883
Bond Position:  [29.66328075]


portfolio before change:  [29.12650984]
curr_Stock_Price:  92.94257709464596
curr_Factors:  [9.29425771e+01 4.61085752e-02]
mat_Sqrt:  [[ 1.99574735e+01  0.00000000e+00]
 [-8.58916296e-03  1.96802447e-02]]
grads:  [ 0.00836617 -1.21754331]
Stock Position:  0.008366168545920713
Bond Position:  [28.34893657]


portfolio before change:  [29.13861647]
curr_Stock_Price:  93.5424342133916
curr_Factors:  [9.35424342e+01 4.77652233e-02]
mat_Sqrt:  [[ 2.04439388e+01  0.00000000e+00]
 [-8.74210256e-03  2.00306734e-02]]
grads:  [ 8.89744765e-05 -4.10144597e+00]
Stock Position:  8.897447645377459e-05
Bond Position:  [29.13029358]


portfolio before change:  [29.1457447]
curr_Stock_Price:  91.79754405806587
curr_Factors:  [9.17975441e+01 5.08895782e-02]
mat_Sqrt:  [[ 2.07083496e+01  0.00000000e+00]
 [-9.02348741e-03  2.06754070e-02]]
grads:  [-0.01597765 -5.17855465]
Stock Position:  -0.01597764996531959
Bond Position:  [30.61245372]


portfolio before change:  [29.16796619]
curr_Stock_Price:  90.88580687377267
curr_Factors:  [9.08858069e+01 4.97004350e-02]
mat_Sqrt:  [[ 2.02617131e+01  0.00000000e+00]
 [-8.91743775e-03  2.04324167e-02]]
grads:  [0.00541767 2.96659508]
Stock Position:  0.005417665820463861
Bond Position:  [28.67557726]


portfolio before change:  [29.18091537]
curr_Stock_Price:  91.95257448877464
curr_Factors:  [9.19525745e+01 4.81484086e-02]
mat_Sqrt:  [[ 2.01769195e+01  0.00000000e+00]
 [-8.77709826e-03  2.01108586e-02]]
grads:  [ 6.07284158e-05 -2.80930571e+00]
Stock Position:  6.072841581897459e-05
Bond Position:  [29.17533123]


portfolio before change:  [29.18817565]
curr_Stock_Price:  91.3851312440402
curr_Factors:  [9.13851312e+01 4.98173273e-02]
mat_Sqrt:  [[ 2.03969745e+01  0.00000000e+00]
 [-8.92791822e-03  2.04564305e-02]]
grads:  [  0.0501985  -28.18669381]
Stock Position:  0.05019850426970601
Bond Position:  [24.60077875]


portfolio before change:  [29.3281641]
curr_Stock_Price:  94.05129599611458
curr_Factors:  [9.40512960e+01 5.01371537e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.3281641]
Stock Price:  95.02065728512848
PL:  [29.3281641]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.07577304e-01 -8.76879885e-01]
 [-1.75401440e-02  2.77792715e-01]
 [-4.13139441e-01 -7.16048987e-02]
 [ 4.63168373e-02 -1.04914584e-02]
 [-2.86133533e-01  9.97879251e-02]
 [-1.13523528e-01 -1.26827677e-01]
 [-2.35128984e-01  1.08057020e-01]
 [ 1.47380056e-01  1.15327950e-02]
 [-1.06004474e-01 -5.09235030e-02]
 [-2.00216456e-01  5.93184736e-02]
 [-6.19990175e-02  3.50404278e-02]
 [-1.91862161e-01 -2.62326792e-01]
 [-6.46782400e-02 -1.09186671e-01]
 [ 8.83930463e-02  1.73910815e-02]
 [-5.19507867e-02 -5.32247093e-03]
 [ 3.22850485e-01 -2.13807784e-01]
 [ 1.06313785e-01  9.45535375e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.60484648]
curr_Stock_Price:  99.38775556322396
curr_Factors:  [9.93877556e+01 4.03445174e-02]
mat_Sqrt:  [[ 1.99629696e+01  0.00000000e+00]
 [-8.03437788e-03  1.84090724e-02]]
grads:  [ 0.00139616 -0.07337873]
Stock Position:  0.0013961639051985057
Bond Position:  [-1.74360808]


portfolio before change:  [-1.60621974]
curr_Stock_Price:  98.71641970480488
curr_Factors:  [9.87164197e+01 4.24806447e-02]
mat_Sqrt:  [[ 2.03462766e+01  0.00000000e+00]
 [-8.24433330e-03  1.88901407e-02]]
grads:  [-0.00915769 -3.52839988]
Stock Position:  -0.009157688821891753
Bond Position:  [-0.70220548]


portfolio before change:  [-1.60232812]
curr_Stock_Price:  98.27229086956564
curr_Factors:  [9.82722909e+01 4.14828712e-02]
mat_Sqrt:  [[ 2.00154558e+01  0.00000000e+00]
 [-8.14693770e-03  1.86669794e-02]]
grads:  [-2.94911626e-02 -4.69749213e+01]
Stock Position:  -0.02949116258530068
Bond Position:  [1.29583599]


portfolio before change:  [-1.54174042]
curr_Stock_Price:  96.2288414163953
curr_Factors:  [9.62288414e+01 4.21323264e-02]
mat_Sqrt:  [[ 1.97520864e+01  0.00000000e+00]
 [-8.21046419e-03  1.88125368e-02]]
grads:  [5.25000419e-03 1.47663613e+01]
Stock Position:  0.0052500041908948285
Bond Position:  [-2.04694224]


portfolio before change:  [-1.5347794]
curr_Stock_Price:  97.65223428552139
curr_Factors:  [9.76522343e+01 4.42846224e-02]
mat_Sqrt:  [[ 2.05498501e+01  0.00000000e+00]
 [-8.41756472e-03  1.92870638e-02]]
grads:  [-0.02162499 -3.71258682]
Stock Position:  -0.02162499382186275
Bond Position:  [0.57694957]


portfolio before change:  [-1.54328972]
curr_Stock_Price:  98.05244606536823
curr_Factors:  [9.80524461e+01 4.44261276e-02]
mat_Sqrt:  [[ 2.06670106e+01  0.00000000e+00]
 [-8.43100256e-03  1.93178537e-02]]
grads:  [ 0.00201955 -0.54309648]
Stock Position:  0.0020195465262936
Bond Position:  [-1.7413112]


portfolio before change:  [-1.54830464]
curr_Stock_Price:  95.78483804378693
curr_Factors:  [9.57848380e+01 4.56117764e-02]
mat_Sqrt:  [[ 2.04566852e+01  0.00000000e+00]
 [-8.54276549e-03  1.95739348e-02]]
grads:  [-0.01185835  5.09800029]
Stock Position:  -0.011858348981593344
Bond Position:  [-0.4124546]


portfolio before change:  [-1.51854484]
curr_Stock_Price:  93.26653419915651
curr_Factors:  [9.32665342e+01 4.33370708e-02]
mat_Sqrt:  [[ 1.94158146e+01  0.00000000e+00]
 [-8.32702308e-03  1.90796068e-02]]
grads:  [-0.00869784 -6.64728986]
Stock Position:  -0.008697840786929652
Bond Position:  [-0.70732738]


portfolio before change:  [-1.52810121]
curr_Stock_Price:  94.34490642934128
curr_Factors:  [9.43449064e+01 4.05952578e-02]
mat_Sqrt:  [[ 1.90088617e+01  0.00000000e+00]
 [-8.05930596e-03  1.84661898e-02]]
grads:  [-0.0098885   5.85161428]
Stock Position:  -0.0098884950493778
Bond Position:  [-0.59517207]


portfolio before change:  [-1.533678]
curr_Stock_Price:  94.89382585102864
curr_Factors:  [9.48938259e+01 4.21615664e-02]
mat_Sqrt:  [[ 1.94848167e+01  0.00000000e+00]
 [-8.21331275e-03  1.88190637e-02]]
grads:  [0.00782216 0.61282512]
Stock Position:  0.007822161365869298
Bond Position:  [-2.27595282]


portfolio before change:  [-1.53120324]
curr_Stock_Price:  95.28295387294718
curr_Factors:  [9.52829539e+01 4.12085097e-02]
mat_Sqrt:  [[ 1.93423246e+01  0.00000000e+00]
 [-8.11995169e-03  1.86051466e-02]]
grads:  [-0.00662947 -2.73706539]
Stock Position:  -0.006629467522636206
Bond Position:  [-0.89952799]


portfolio before change:  [-1.54171305]
curr_Stock_Price:  96.83434552368601
curr_Factors:  [9.68343455e+01 3.80528487e-02]
mat_Sqrt:  [[ 1.88896107e+01  0.00000000e+00]
 [-7.80285575e-03  1.78785886e-02]]
grads:  [-0.00922876  3.31784992]
Stock Position:  -0.009228763553631605
Bond Position:  [-0.64805177]


portfolio before change:  [-1.56154139]
curr_Stock_Price:  98.96532451530247
curr_Factors:  [9.89653245e+01 3.71643836e-02]
mat_Sqrt:  [[ 1.90786008e+01  0.00000000e+00]
 [-7.71122648e-03  1.76686395e-02]]
grads:  [-0.00244809  1.98319898]
Stock Position:  -0.002448089436531469
Bond Position:  [-1.31926542]


portfolio before change:  [-1.56231784]
curr_Stock_Price:  99.1477510131199
curr_Factors:  [9.91477510e+01 3.79319615e-02]
mat_Sqrt:  [[ 1.93101443e+01  0.00000000e+00]
 [-7.79045175e-03  1.78501674e-02]]
grads:  [ -0.01586477 -14.69604099]
Stock Position:  -0.01586476804650152
Bond Position:  [0.01063823]


portfolio before change:  [-1.57608001]
curr_Stock_Price:  100.01538638459586
curr_Factors:  [1.00015386e+02 3.82057986e-02]
mat_Sqrt:  [[ 1.95493111e+01  0.00000000e+00]
 [-7.81852146e-03  1.79144832e-02]]
grads:  [-5.74604442e-03 -6.09488255e+00]
Stock Position:  -0.005746044417419484
Bond Position:  [-1.00138716]


portfolio before change:  [-1.58950806]
curr_Stock_Price:  102.30873284065497
curr_Factors:  [1.02308733e+02 3.84114206e-02]
mat_Sqrt:  [[ 2.00513164e+01  0.00000000e+00]
 [-7.83953270e-03  1.79626260e-02]]
grads:  [0.00478687 0.96818146]
Stock Position:  0.004786874564729762
Bond Position:  [-2.07924713]


portfolio before change:  [-1.59221248]
curr_Stock_Price:  101.85237174529891
curr_Factors:  [1.01852372e+02 3.72390726e-02]
mat_Sqrt:  [[ 1.96548881e+01  0.00000000e+00]
 [-7.71897118e-03  1.76863849e-02]]
grads:  [-0.00276133 -0.30093606]
Stock Position:  -0.002761333632399058
Bond Position:  [-1.3109641]


portfolio before change:  [-1.59566977]
curr_Stock_Price:  102.98570431267872
curr_Factors:  [1.02985704e+02 3.57227833e-02]
mat_Sqrt:  [[ 1.94647840e+01  0.00000000e+00]
 [-7.56018871e-03  1.73225685e-02]]
grads:  [ 1.17924308e-02 -1.23427299e+01]
Stock Position:  0.011792430813597895
Bond Position:  [-2.81012157]


portfolio before change:  [-1.57559071]
curr_Stock_Price:  104.74799405369686
curr_Factors:  [1.04747994e+02 3.44333170e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.57559071]
Stock Price:  106.49577328794521
PL:  [-8.071364]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-2.50457911e-02  4.39430796e-03]
 [-1.52134960e-01 -6.50517755e-02]
 [-1.56186684e-01 -5.26249002e-01]
 [ 1.38138060e-01  5.66757872e-02]
 [-4.07760360e-01 -7.90110476e-02]
 [ 3.40776401e-01 -4.02099020e-01]
 [-3.79700392e-01  1.51092854e-01]
 [ 2.07416003e-02  1.58224668e-01]
 [-2.32981713e-01  9.83541505e-02]
 [ 1.69993782e-01  1.01157711e-02]
 [-1.06004474e-01 -5.09235030e-02]
 [-1.87360728e-01  5.16113011e-02]
 [-6.81339844e-02  1.90228307e-02]
 [-8.21932274e-02 -2.12471898e-01]
 [-1.73013726e-01 -1.42438835e-01]
 [ 8.82440700e-02  6.56828665e-02]
 [ 2.55406495e-02 -6.80294615e-02]
 [ 7.96785848e-01 -3.77645721e-01]
 [ 1.73909654e-01  1.44055164e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.26640161]
curr_Stock_Price:  99.65937338074056
curr_Factors:  [9.96593734e+01 4.08953382e-02]
mat_Sqrt:  [[ 2.01537123e+01  0.00000000e+00]
 [-8.08903834e-03  1.85343152e-02]]
grads:  [-0.00114758  0.23709039]
Stock Position:  -0.001147578052422269
Bond Position:  [0.38076852]


portfolio before change:  [0.26493153]
curr_Stock_Price:  101.02335955726383
curr_Factors:  [1.01023360e+02 4.24716113e-02]
mat_Sqrt:  [[ 2.08195422e+01  0.00000000e+00]
 [-8.24345668e-03  1.88881321e-02]]
grads:  [-0.00867098 -3.44405551]
Stock Position:  -0.008670982315555987
Bond Position:  [1.1409033]


portfolio before change:  [0.26493614]
curr_Stock_Price:  101.05572675410046
curr_Factors:  [1.01055727e+02 4.41690337e-02]
mat_Sqrt:  [[ 2.12383062e+01  0.00000000e+00]
 [-8.40657206e-03  1.92618764e-02]]
grads:  [-1.81681427e-02 -2.73207548e+01]
Stock Position:  -0.018168142668654675
Bond Position:  [2.100931]


portfolio before change:  [0.26658551]
curr_Stock_Price:  100.99385652873774
curr_Factors:  [1.00993857e+02 4.28984820e-02]
mat_Sqrt:  [[ 2.09177958e+01  0.00000000e+00]
 [-8.28477949e-03  1.89828146e-02]]
grads:  [0.00778636 2.98563666]
Stock Position:  0.007786355828720999
Bond Position:  [-0.5197886]


portfolio before change:  [0.24442136]
curr_Stock_Price:  98.16401149075718
curr_Factors:  [9.81640115e+01 4.38746847e-02]
mat_Sqrt:  [[ 2.05617134e+01  0.00000000e+00]
 [-8.37851393e-03  1.91975871e-02]]
grads:  [-0.02150811 -4.11567595]
Stock Position:  -0.02150811067035141
Bond Position:  [2.35574378]


portfolio before change:  [0.20609085]
curr_Stock_Price:  99.97353918985692
curr_Factors:  [9.99735392e+01 4.19479275e-02]
mat_Sqrt:  [[ 2.04757737e+01  0.00000000e+00]
 [-8.19247728e-03  1.87713236e-02]]
grads:  [ 8.07227134e-03 -2.14209199e+01]
Stock Position:  0.008072271338860529
Bond Position:  [-0.60092269]


portfolio before change:  [0.19085856]
curr_Stock_Price:  98.10516248448735
curr_Factors:  [9.81051625e+01 4.35059716e-02]
mat_Sqrt:  [[ 2.04628583e+01  0.00000000e+00]
 [-8.34323406e-03  1.91167508e-02]]
grads:  [-0.01533305  7.90368905]
Stock Position:  -0.015333051680285762
Bond Position:  [1.69511008]


portfolio before change:  [0.2095884]
curr_Stock_Price:  96.9112697940205
curr_Factors:  [9.69112698e+01 4.50024075e-02]
mat_Sqrt:  [[ 2.05585347e+01  0.00000000e+00]
 [-8.48550835e-03  1.94427422e-02]]
grads:  [4.36784567e-03 8.13798110e+00]
Stock Position:  0.004367845670829734
Bond Position:  [-0.21370507]


portfolio before change:  [0.19984425]
curr_Stock_Price:  94.69261845389663
curr_Factors:  [9.46926185e+01 4.51931682e-02]
mat_Sqrt:  [[ 2.01304054e+01  0.00000000e+00]
 [-8.50347395e-03  1.94839065e-02]]
grads:  [-0.00944126  5.04796871]
Stock Position:  -0.009441262552519413
Bond Position:  [1.09386212]


portfolio before change:  [0.19152933]
curr_Stock_Price:  95.60228651499565
curr_Factors:  [9.56022865e+01 4.54102097e-02]
mat_Sqrt:  [[ 2.03725332e+01  0.00000000e+00]
 [-8.52386858e-03  1.95306365e-02]]
grads:  [0.00856097 0.51794375]
Stock Position:  0.008560971020647755
Bond Position:  [-0.62691907]


portfolio before change:  [0.18852184]
curr_Stock_Price:  95.26929344069859
curr_Factors:  [9.52692934e+01 4.41951151e-02]
mat_Sqrt:  [[ 2.00281151e+01  0.00000000e+00]
 [-8.40905371e-03  1.92675626e-02]]
grads:  [-0.00640247 -2.64296549]
Stock Position:  -0.0064024653194830715
Bond Position:  [0.79848018]


portfolio before change:  [0.18184476]
curr_Stock_Price:  96.3433673488165
curr_Factors:  [9.63433673e+01 4.45231711e-02]
mat_Sqrt:  [[ 2.03289462e+01  0.00000000e+00]
 [-8.44020579e-03  1.93389410e-02]]
grads:  [-0.00810842  2.66877598]
Stock Position:  -0.008108423742715913
Bond Position:  [0.96303761]


portfolio before change:  [0.18362306]
curr_Stock_Price:  96.1537487786561
curr_Factors:  [9.61537488e+01 4.47680834e-02]
mat_Sqrt:  [[ 2.03446617e+01  0.00000000e+00]
 [-8.46338782e-03  1.93920577e-02]]
grads:  [-0.00294091  0.98095989]
Stock Position:  -0.002940906140560717
Bond Position:  [0.46640221]


portfolio before change:  [0.18207688]
curr_Stock_Price:  96.71915113198082
curr_Factors:  [9.67191511e+01 4.59527674e-02]
mat_Sqrt:  [[ 2.07332943e+01  0.00000000e+00]
 [-8.57463864e-03  1.96469653e-02]]
grads:  [-8.43684384e-03 -1.08144894e+01]
Stock Position:  -0.008436843841512531
Bond Position:  [0.99808125]


portfolio before change:  [0.18640417]
curr_Stock_Price:  96.2358251738331
curr_Factors:  [9.62358252e+01 4.69359467e-02]
mat_Sqrt:  [[ 2.08492082e+01  0.00000000e+00]
 [-8.66588222e-03  1.98560306e-02]]
grads:  [-0.01128    -7.17358053]
Stock Position:  -0.01128000294994869
Bond Position:  [1.27194457]


portfolio before change:  [0.17728342]
curr_Stock_Price:  97.07259609652826
curr_Factors:  [9.70725961e+01 4.83391584e-02]
mat_Sqrt:  [[ 2.13425441e+01  0.00000000e+00]
 [-8.79446720e-03  2.01506558e-02]]
grads:  [0.00547781 3.25958951]
Stock Position:  0.005477811017763453
Bond Position:  [-0.35446191]


portfolio before change:  [0.1814696]
curr_Stock_Price:  97.8529812210605
curr_Factors:  [9.78529812e+01 4.77762096e-02]
mat_Sqrt:  [[ 2.13884793e+01  0.00000000e+00]
 [-8.74310788e-03  2.00329768e-02]]
grads:  [-1.94022286e-04 -3.39587382e+00]
Stock Position:  -0.00019402228567326715
Bond Position:  [0.20045526]


portfolio before change:  [0.18178837]
curr_Stock_Price:  96.46834561122387
curr_Factors:  [9.64683456e+01 4.74449152e-02]
mat_Sqrt:  [[ 2.10125939e+01  0.00000000e+00]
 [-8.71274149e-03  1.99633987e-02]]
grads:  [  0.03007567 -18.91690522]
Stock Position:  0.030075665328578745
Bond Position:  [-2.71956131]


portfolio before change:  [0.19894625]
curr_Stock_Price:  97.06144503534377
curr_Factors:  [9.70614450e+01 4.66566651e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.19894625]
Stock Price:  95.36173927640493
PL:  [0.19894625]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.33607603e-02  2.66138301e-01]
 [-1.42452311e-01 -6.20140726e-02]
 [-1.98036726e-01 -8.11785883e-01]
 [-2.21580480e-02  2.77308792e-01]
 [-4.30136628e-01 -4.48467710e-02]
 [ 4.93634733e-01 -3.60499115e-01]
 [-1.56061039e-01  3.28216762e-02]
 [-1.56236092e-01 -4.31556572e-01]
 [-2.45399436e-01  1.55685099e-01]
 [ 6.11889215e-03  1.79799780e-02]
 [-1.06004474e-01 -5.09235030e-02]
 [-1.47163327e-01  2.77757361e-02]
 [-3.17628999e-02  1.25915276e-02]
 [-2.66986434e-02 -1.77714692e-01]
 [-1.53014757e-01 -1.46868143e-01]
 [ 8.79963100e-02  4.18523018e-02]
 [ 5.97499714e-02 -8.36982384e-02]
 [ 8.97054778e-01 -4.19128593e-01]
 [ 1.62927925e-01  1.47709889e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.82624962]
curr_Stock_Price:  101.62762993205467
curr_Factors:  [1.01627630e+02 3.89992079e-02]
mat_Sqrt:  [[ 2.00696450e+01  0.00000000e+00]
 [-7.89928684e-03  1.80995399e-02]]
grads:  [6.95144521e-03 1.47041473e+01]
Stock Position:  0.006951445212940799
Bond Position:  [13.11979072]


portfolio before change:  [13.82605765]
curr_Stock_Price:  101.12811880530737
curr_Factors:  [1.01128119e+02 3.69638129e-02]
mat_Sqrt:  [[ 1.94428672e+01  0.00000000e+00]
 [-7.69039015e-03  1.76208975e-02]]
grads:  [-0.00871875 -3.51934813]
Stock Position:  -0.00871874858674565
Bond Position:  [14.7077683]


portfolio before change:  [13.85046894]
curr_Stock_Price:  98.75003790886876
curr_Factors:  [9.87500379e+01 3.76909922e-02]
mat_Sqrt:  [[ 1.91714983e+01  0.00000000e+00]
 [-7.76566723e-03  1.77933790e-02]]
grads:  [-2.88099095e-02 -4.56229188e+01]
Stock Position:  -0.02880990950445244
Bond Position:  [16.6954486]


portfolio before change:  [13.91308942]
curr_Stock_Price:  96.72135792803851
curr_Factors:  [9.67213579e+01 3.99915517e-02]
mat_Sqrt:  [[ 1.93422286e+01  0.00000000e+00]
 [-7.99915512e-03  1.83283669e-02]]
grads:  [5.11158424e-03 1.51300328e+01]
Stock Position:  0.005111584241174829
Bond Position:  [13.41869005]


portfolio before change:  [13.91201438]
curr_Stock_Price:  95.85467447434787
curr_Factors:  [9.58546745e+01 4.10920728e-02]
mat_Sqrt:  [[ 1.94308733e+01  0.00000000e+00]
 [-8.10847189e-03  1.85788431e-02]]
grads:  [-0.02314406 -2.41386241]
Stock Position:  -0.023144063342196222
Bond Position:  [16.13048104]


portfolio before change:  [13.99395644]
curr_Stock_Price:  92.48841429463006
curr_Factors:  [9.24884143e+01 4.19181116e-02]
mat_Sqrt:  [[ 1.89359975e+01  0.00000000e+00]
 [-8.18956522e-03  1.87646513e-02]]
grads:  [ 1.77598259e-02 -1.92116075e+01]
Stock Position:  0.017759825925981597
Bond Position:  [12.35137831]


portfolio before change:  [14.00481643]
curr_Stock_Price:  92.92601747176944
curr_Factors:  [9.29260175e+01 4.15824414e-02]
mat_Sqrt:  [[ 1.89492627e+01  0.00000000e+00]
 [-8.15670928e-03  1.86893688e-02]]
grads:  [-0.00747979  1.75616825]
Stock Position:  -0.007479788920506033
Bond Position:  [14.69988343]


portfolio before change:  [14.02010533]
curr_Stock_Price:  91.37337121349886
curr_Factors:  [9.13733712e+01 4.24454736e-02]
mat_Sqrt:  [[ 1.88250154e+01  0.00000000e+00]
 [-8.24091971e-03  1.88823192e-02]]
grads:  [-1.83045174e-02 -2.28550618e+01]
Stock Position:  -0.018304517392121463
Bond Position:  [15.69265079]


portfolio before change:  [14.00905577]
curr_Stock_Price:  92.19137737584369
curr_Factors:  [9.21913774e+01 4.28388398e-02]
mat_Sqrt:  [[ 1.90813525e+01  0.00000000e+00]
 [-8.27901828e-03  1.89696140e-02]]
grads:  [-0.00929981  8.20707785]
Stock Position:  -0.009299806672870607
Bond Position:  [14.86641776]


portfolio before change:  [14.02081549]
curr_Stock_Price:  91.32655846776474
curr_Factors:  [9.13265585e+01 4.14769125e-02]
mat_Sqrt:  [[ 1.85994586e+01  0.00000000e+00]
 [-8.14635256e-03  1.86656386e-02]]
grads:  [7.50881958e-04 9.63266157e-01]
Stock Position:  0.0007508819576505741
Bond Position:  [13.95224003]


portfolio before change:  [14.02673863]
curr_Stock_Price:  94.56893576849005
curr_Factors:  [9.45689358e+01 4.16054261e-02]
mat_Sqrt:  [[ 1.92896119e+01  0.00000000e+00]
 [-8.15896328e-03  1.86945334e-02]]
grads:  [-0.00664758 -2.72397828]
Stock Position:  -0.006647583865556478
Bond Position:  [14.65539356]


portfolio before change:  [14.02823619]
curr_Stock_Price:  94.89488060377737
curr_Factors:  [9.48948806e+01 4.20965053e-02]
mat_Sqrt:  [[ 1.94699935e+01  0.00000000e+00]
 [-8.20697316e-03  1.88045379e-02]]
grads:  [-0.00693585  1.47707624]
Stock Position:  -0.0069358524477301136
Bond Position:  [14.68641308]


portfolio before change:  [14.0265276]
curr_Stock_Price:  95.67065376735277
curr_Factors:  [9.56706538e+01 4.27475560e-02]
mat_Sqrt:  [[ 1.97803689e+01  0.00000000e+00]
 [-8.27019284e-03  1.89493924e-02]]
grads:  [-0.00132796  0.66448186]
Stock Position:  -0.0013279583829258655
Bond Position:  [14.15357425]


portfolio before change:  [14.03101236]
curr_Stock_Price:  94.95834459438171
curr_Factors:  [9.49583446e+01 4.34955587e-02]
mat_Sqrt:  [[ 1.98041219e+01  0.00000000e+00]
 [-8.34223555e-03  1.91144629e-02]]
grads:  [-5.26454512e-03 -9.29739394e+00]
Stock Position:  -0.005264545123348504
Bond Position:  [14.53092485]


portfolio before change:  [14.02563274]
curr_Stock_Price:  96.67032652464643
curr_Factors:  [9.66703265e+01 4.38214882e-02]
mat_Sqrt:  [[ 2.02365627e+01  0.00000000e+00]
 [-8.37343306e-03  1.91859454e-02]]
grads:  [-0.01072876 -7.65498597]
Stock Position:  -0.010728762213441313
Bond Position:  [15.06278568]


portfolio before change:  [14.04449506]
curr_Stock_Price:  95.26325339196711
curr_Factors:  [9.52632534e+01 4.40581200e-02]
mat_Sqrt:  [[ 1.99957819e+01  0.00000000e+00]
 [-8.39601049e-03  1.92376768e-02]]
grads:  [0.00531423 2.17553825]
Stock Position:  0.005314228405345642
Bond Position:  [13.53824437]


portfolio before change:  [14.04999413]
curr_Stock_Price:  95.66106937335395
curr_Factors:  [9.56610694e+01 4.30716706e-02]
mat_Sqrt:  [[ 1.98532262e+01  0.00000000e+00]
 [-8.30148619e-03  1.90210944e-02]]
grads:  [ 1.16963688e-03 -4.40028510e+00]
Stock Position:  0.001169636875591301
Bond Position:  [13.93810541]


portfolio before change:  [14.05319122]
curr_Stock_Price:  95.41495482166455
curr_Factors:  [9.54149548e+01 4.16941309e-02]
mat_Sqrt:  [[ 1.94829139e+01  0.00000000e+00]
 [-8.16765630e-03  1.87144516e-02]]
grads:  [  0.03665427 -22.39598577]
Stock Position:  0.036654273910563445
Bond Position:  [10.55582533]


portfolio before change:  [14.09504441]
curr_Stock_Price:  96.48478644971651
curr_Factors:  [9.64847864e+01 4.12284294e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.09504441]
Stock Price:  96.51978323002452
PL:  [14.09504441]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 1.00339407e-01  3.81818523e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.72976860e-01 -6.40805980e-01]
 [-3.98244519e-02  2.75457480e-01]
 [-4.71380284e-01 -1.23500723e-01]
 [ 4.88309129e-02 -1.33770717e-02]
 [-3.39329572e-01  1.28956576e-01]
 [-2.04215961e-02  1.54232758e-01]
 [-2.39983812e-01  1.30675656e-01]
 [ 1.02800274e-01  1.43262584e-02]
 [-1.06004474e-01 -5.09235030e-02]
 [-1.10072362e-01  5.71810301e-03]
 [ 1.29947483e-01 -1.57423110e-02]
 [ 1.52430755e-02 -1.15453008e-01]
 [-2.34604858e-01 -1.27922826e-01]
 [ 8.59531812e-02  4.23610535e-02]
 [ 2.77059788e-02 -5.77232852e-02]
 [ 1.19550104e+00 -5.43239063e-01]
 [ 1.47108703e-01  1.72636870e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.33251596]
curr_Stock_Price:  102.42688260699072
curr_Factors:  [1.02426883e+02 3.78907408e-02]
mat_Sqrt:  [[ 1.99379500e+01  0.00000000e+00]
 [-7.78621765e-03  1.78404659e-02]]
grads:  [1.33904776e-02 2.14018247e+01]
Stock Position:  0.013390477558710076
Bond Position:  [17.96097108]


portfolio before change:  [19.30418926]
curr_Stock_Price:  99.97607375910742
curr_Factors:  [9.99760738e+01 3.84163126e-02]
mat_Sqrt:  [[ 1.95953902e+01  0.00000000e+00]
 [-7.84003190e-03  1.79637698e-02]]
grads:  [-0.00950861 -3.71035539]
Stock Position:  -0.009508607302460066
Bond Position:  [20.25482249]


portfolio before change:  [19.30832816]
curr_Stock_Price:  100.07340046787564
curr_Factors:  [1.00073400e+02 3.82831734e-02]
mat_Sqrt:  [[ 1.95804479e+01  0.00000000e+00]
 [-7.82643453e-03  1.79326143e-02]]
grads:  [-2.31173219e-02 -3.57341082e+01]
Stock Position:  -0.02311732191843809
Bond Position:  [21.62175717]


portfolio before change:  [19.34788669]
curr_Stock_Price:  98.59604887520791
curr_Factors:  [9.85960489e+01 3.95291483e-02]
mat_Sqrt:  [[ 1.96028059e+01  0.00000000e+00]
 [-7.95277545e-03  1.82220977e-02]]
grads:  [4.10120107e-03 1.51166723e+01]
Stock Position:  0.0041012010677199525
Bond Position:  [18.94352446]


portfolio before change:  [19.35385667]
curr_Stock_Price:  98.89681680992182
curr_Factors:  [9.88968168e+01 3.85785413e-02]
mat_Sqrt:  [[ 1.94247400e+01  0.00000000e+00]
 [-7.85656835e-03  1.80016596e-02]]
grads:  [-0.02704182 -6.86051872]
Stock Position:  -0.027041824921896548
Bond Position:  [22.02820707]


portfolio before change:  [19.38160079]
curr_Stock_Price:  98.07452091945531
curr_Factors:  [9.80745209e+01 3.96931388e-02]
mat_Sqrt:  [[ 1.95395212e+01  0.00000000e+00]
 [-7.96925480e-03  1.82598567e-02]]
grads:  [ 0.00220029 -0.73259456]
Stock Position:  0.00220029343582064
Bond Position:  [19.16580807]


portfolio before change:  [19.38450659]
curr_Stock_Price:  97.21724657376701
curr_Factors:  [9.72172466e+01 4.08875905e-02]
mat_Sqrt:  [[ 1.96579885e+01  0.00000000e+00]
 [-8.08827205e-03  1.85325595e-02]]
grads:  [-0.01439864  6.95837917]
Stock Position:  -0.014398640499774023
Bond Position:  [20.78430277]


portfolio before change:  [19.41318594]
curr_Stock_Price:  95.58635429432579
curr_Factors:  [9.55863543e+01 4.44034442e-02]
mat_Sqrt:  [[ 2.01420758e+01  0.00000000e+00]
 [-8.42884990e-03  1.93129214e-02]]
grads:  [2.32801716e-03 7.98598801e+00]
Stock Position:  0.002328017163267227
Bond Position:  [19.19065927]


portfolio before change:  [19.41262599]
curr_Stock_Price:  93.28473013898972
curr_Factors:  [9.32847301e+01 4.37415606e-02]
mat_Sqrt:  [[ 1.95100192e+01  0.00000000e+00]
 [-8.36579327e-03  1.91684404e-02]]
grads:  [-0.00937735  6.81722941]
Stock Position:  -0.009377350101900245
Bond Position:  [20.28738956]


portfolio before change:  [19.4143215]
curr_Stock_Price:  93.64484996375516
curr_Factors:  [9.364485e+01 4.311051e-02]
mat_Sqrt:  [[ 1.94435463e+01  0.00000000e+00]
 [-8.30522823e-03  1.90296685e-02]]
grads:  [0.00560869 0.75283804]
Stock Position:  0.005608687044173877
Bond Position:  [18.88909684]


portfolio before change:  [19.42352265]
curr_Stock_Price:  94.44330595961863
curr_Factors:  [9.44433060e+01 4.39941703e-02]
mat_Sqrt:  [[ 1.98092826e+01  0.00000000e+00]
 [-8.38991493e-03  1.92237101e-02]]
grads:  [-0.00647319 -2.64899453]
Stock Position:  -0.006473193166650913
Bond Position:  [20.03487242]


portfolio before change:  [19.43439719]
curr_Stock_Price:  93.53723253929192
curr_Factors:  [9.35372325e+01 4.53710343e-02]
mat_Sqrt:  [[ 1.99238772e+01  0.00000000e+00]
 [-8.52019102e-03  1.95222101e-02]]
grads:  [-0.00539939  0.29290244]
Stock Position:  -0.005399389673497937
Bond Position:  [19.93944115]


portfolio before change:  [19.43924639]
curr_Stock_Price:  93.56247171809777
curr_Factors:  [9.35624717e+01 4.61896945e-02]
mat_Sqrt:  [[ 2.01082479e+01  0.00000000e+00]
 [-8.59671514e-03  1.96975489e-02]]
grads:  [ 0.00612072 -0.79920152]
Stock Position:  0.006120721007833088
Bond Position:  [18.86657661]


portfolio before change:  [19.44686092]
curr_Stock_Price:  94.03582923032413
curr_Factors:  [9.40358292e+01 4.64366111e-02]
mat_Sqrt:  [[ 2.02639272e+01  0.00000000e+00]
 [-8.61966227e-03  1.97501274e-02]]
grads:  [-1.73435030e-03 -5.84568422e+00]
Stock Position:  -0.0017343502990636347
Bond Position:  [19.60995198]


portfolio before change:  [19.45056853]
curr_Stock_Price:  94.72513003841314
curr_Factors:  [9.47251300e+01 4.52684628e-02]
mat_Sqrt:  [[ 2.01540849e+01  0.00000000e+00]
 [-8.51055465e-03  1.95001304e-02]]
grads:  [-0.01441072 -6.56010102]
Stock Position:  -0.014410724044234439
Bond Position:  [20.81562624]


portfolio before change:  [19.50028748]
curr_Stock_Price:  91.63615315491676
curr_Factors:  [9.16361532e+01 4.57283149e-02]
mat_Sqrt:  [[ 1.95956398e+01  0.00000000e+00]
 [-8.55367195e-03  1.95989246e-02]]
grads:  [0.00532981 2.16139683]
Stock Position:  0.0053298112033532815
Bond Position:  [19.01188408]


portfolio before change:  [19.50726068]
curr_Stock_Price:  92.05261046087546
curr_Factors:  [9.20526105e+01 4.52069556e-02]
mat_Sqrt:  [[ 1.95721592e+01  0.00000000e+00]
 [-8.50477096e-03  1.94868783e-02]]
grads:  [ 1.28420771e-04 -2.96216173e+00]
Stock Position:  0.00012842077068463145
Bond Position:  [19.49543922]


portfolio before change:  [19.51215933]
curr_Stock_Price:  92.24086333344677
curr_Factors:  [9.22408633e+01 4.61561155e-02]
mat_Sqrt:  [[ 1.98170034e+01  0.00000000e+00]
 [-8.59358975e-03  1.96903878e-02]]
grads:  [  0.04836312 -27.58904849]
Stock Position:  0.04836311819192278
Bond Position:  [15.05110355]


portfolio before change:  [19.61740947]
curr_Stock_Price:  94.33929918615476
curr_Factors:  [9.43392992e+01 4.71292054e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.61740947]
Stock Price:  92.76518748534005
PL:  [19.61740947]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.98425880e-01 -8.14441024e-01]
 [ 2.19405302e-02  2.42716759e-01]
 [-3.77709476e-01 -1.11333886e-01]
 [ 1.62184318e-01 -1.60838513e-01]
 [-3.46869643e-01  1.33090976e-01]
 [ 2.08135043e-02  1.58133913e-01]
 [-2.08393078e-01  1.43052527e-03]
 [ 2.04965193e-01  7.92438852e-03]
 [-9.81019420e-02 -2.48894926e-02]
 [-2.03817679e-01  6.14401953e-02]
 [-4.97056846e-02  3.59414281e-02]
 [-1.85928442e-01 -2.59884817e-01]
 [-9.87926825e-02 -1.24401551e-01]
 [ 8.87279116e-02  7.34561408e-02]
 [-2.12932883e-02 -4.48603768e-02]
 [ 3.40932491e-01 -2.19070117e-01]
 [ 1.31332620e-01  3.02663098e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.84186962]
curr_Stock_Price:  97.90181797498282
curr_Factors:  [9.7901818e+01 4.1463618e-02]
mat_Sqrt:  [[ 1.99353724e+01  0.00000000e+00]
 [-8.14504688e-03  1.86626469e-02]]
grads:  [ 0.0013981  -0.07238171]
Stock Position:  0.0013980966597367038
Bond Position:  [-11.97874582]


portfolio before change:  [-11.8444576]
curr_Stock_Price:  98.19298477863867
curr_Factors:  [9.81929848e+01 4.31397249e-02]
mat_Sqrt:  [[ 2.03947857e+01  0.00000000e+00]
 [-8.30804188e-03  1.90361154e-02]]
grads:  [-0.00913591 -3.50134304]
Stock Position:  -0.009135907213484633
Bond Position:  [-10.9473756]


portfolio before change:  [-11.85231265]
curr_Stock_Price:  98.75317680383961
curr_Factors:  [9.87531768e+01 4.22382538e-02]
mat_Sqrt:  [[ 2.02957008e+01  0.00000000e+00]
 [-8.22077892e-03  1.88361708e-02]]
grads:  [-2.72903650e-02 -4.32381417e+01]
Stock Position:  -0.027290365008568542
Bond Position:  [-9.15730241]


portfolio before change:  [-11.8760135]
curr_Stock_Price:  99.53774836433351
curr_Factors:  [9.95377484e+01 4.12937627e-02]
mat_Sqrt:  [[ 2.02269333e+01  0.00000000e+00]
 [-8.12834672e-03  1.86243821e-02]]
grads:  [6.32180899e-03 1.30322047e+01]
Stock Position:  0.006321808986587477
Bond Position:  [-12.50527214]


portfolio before change:  [-11.87593684]
curr_Stock_Price:  100.04446684454908
curr_Factors:  [1.00044467e+02 4.17697249e-02]
mat_Sqrt:  [[ 2.04467309e+01  0.00000000e+00]
 [-8.17505717e-03  1.87314092e-02]]
grads:  [-0.02084928 -5.9437005 ]
Stock Position:  -0.02084927755911749
Bond Position:  [-9.79008198]


portfolio before change:  [-11.85033914]
curr_Stock_Price:  98.6993114274937
curr_Factors:  [9.86993114e+01 4.23054013e-02]
mat_Sqrt:  [[ 2.03007476e+01  0.00000000e+00]
 [-8.22731075e-03  1.88511371e-02]]
grads:  [ 4.53129301e-03 -8.53203243e+00]
Stock Position:  0.004531293008960863
Bond Position:  [-12.29757464]


portfolio before change:  [-11.8592042]
curr_Stock_Price:  97.42146905599678
curr_Factors:  [9.74214691e+01 4.01808732e-02]
mat_Sqrt:  [[ 1.95282964e+01  0.00000000e+00]
 [-8.01806691e-03  1.83716993e-02]]
grads:  [-0.01478798  7.2443476 ]
Stock Position:  -0.014787976026356136
Bond Position:  [-10.41853785]


portfolio before change:  [-11.85362085]
curr_Stock_Price:  96.86775473480367
curr_Factors:  [9.68677547e+01 4.09719477e-02]
mat_Sqrt:  [[ 1.96075142e+01  0.00000000e+00]
 [-8.09661141e-03  1.85516673e-02]]
grads:  [4.58134576e-03 8.52397310e+00]
Stock Position:  0.0045813457601560255
Bond Position:  [-12.29740552]


portfolio before change:  [-11.85370236]
curr_Stock_Price:  97.52110498725928
curr_Factors:  [9.75211050e+01 3.95703302e-02]
mat_Sqrt:  [[ 1.93991835e+01  0.00000000e+00]
 [-7.95691701e-03  1.82315873e-02]]
grads:  [-0.01071018  0.07846411]
Stock Position:  -0.010710179915027445
Bond Position:  [-10.80923378]


portfolio before change:  [-11.85063087]
curr_Stock_Price:  96.98197886812713
curr_Factors:  [9.69819789e+01 4.00606379e-02]
mat_Sqrt:  [[ 1.94110922e+01  0.00000000e+00]
 [-8.00606150e-03  1.83441914e-02]]
grads:  [0.01073735 0.43198353]
Stock Position:  0.010737349426141813
Bond Position:  [-12.89196026]


portfolio before change:  [-11.8573626]
curr_Stock_Price:  96.65523678478874
curr_Factors:  [9.66552368e+01 3.95935066e-02]
mat_Sqrt:  [[ 1.92325722e+01  0.00000000e+00]
 [-7.95924686e-03  1.82369256e-02]]
grads:  [-0.00566563 -1.36478555]
Stock Position:  -0.005665628380432634
Bond Position:  [-11.30974995]


portfolio before change:  [-11.86191487]
curr_Stock_Price:  96.95961135024955
curr_Factors:  [9.69596114e+01 3.94466570e-02]
mat_Sqrt:  [[ 1.92573254e+01  0.00000000e+00]
 [-7.94447300e-03  1.82030744e-02]]
grads:  [-0.00919146  3.37526474]
Stock Position:  -0.00919146226884368
Bond Position:  [-10.97071426]


portfolio before change:  [-11.88652888]
curr_Stock_Price:  99.33910116763795
curr_Factors:  [9.93391012e+01 4.07256206e-02]
mat_Sqrt:  [[ 2.00472166e+01  0.00000000e+00]
 [-8.07223593e-03  1.84958161e-02]]
grads:  [-1.69697171e-03  1.94321937e+00]
Stock Position:  -0.0016969717140885546
Bond Position:  [-11.71795323]


portfolio before change:  [-11.88891358]
curr_Stock_Price:  99.01785114290342
curr_Factors:  [9.90178511e+01 3.97695525e-02]
mat_Sqrt:  [[ 1.97464418e+01  0.00000000e+00]
 [-7.97692196e-03  1.82774244e-02]]
grads:  [ -0.01515977 -14.21889715]
Stock Position:  -0.015159767925338952
Bond Position:  [-10.38782594]


portfolio before change:  [-11.88693014]
curr_Stock_Price:  98.71568830482586
curr_Factors:  [9.87156883e+01 3.98007261e-02]
mat_Sqrt:  [[ 1.96938976e+01  0.00000000e+00]
 [-7.98004772e-03  1.82845864e-02]]
grads:  [-0.00777327 -6.8036295 ]
Stock Position:  -0.007773269353178125
Bond Position:  [-11.11958651]


portfolio before change:  [-11.88527971]
curr_Stock_Price:  98.14569959412938
curr_Factors:  [9.81456996e+01 3.87229763e-02]
mat_Sqrt:  [[ 1.93132624e+01  0.00000000e+00]
 [-7.87126178e-03  1.80353265e-02]]
grads:  [0.00625409 4.07290331]
Stock Position:  0.006254085793844259
Bond Position:  [-12.49909134]


portfolio before change:  [-11.8773565]
curr_Stock_Price:  99.91228560903615
curr_Factors:  [9.99122856e+01 3.82136827e-02]
mat_Sqrt:  [[ 1.95311736e+01  0.00000000e+00]
 [-7.81932812e-03  1.79163315e-02]]
grads:  [-2.09265263e-03 -2.50388182e+00]
Stock Position:  -0.0020926526299783733
Bond Position:  [-11.66827479]


portfolio before change:  [-11.88608993]
curr_Stock_Price:  102.69153580765965
curr_Factors:  [1.02691536e+02 3.68260754e-02]
mat_Sqrt:  [[ 1.97066302e+01  0.00000000e+00]
 [-7.67604850e-03  1.75880366e-02]]
grads:  [ 1.24487267e-02 -1.24556323e+01]
Stock Position:  0.012448726689758955
Bond Position:  [-13.1644688]


portfolio before change:  [-11.87358065]
curr_Stock_Price:  103.96080682079622
curr_Factors:  [1.03960807e+02 3.55006329e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.87358065]
Stock Price:  103.52034704289227
PL:  [-15.3939277]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.17934625e-01 -9.47546410e-01]
 [-1.26209374e-02  2.73784348e-01]
 [-4.08509105e-01 -7.48865519e-02]
 [ 2.41683624e-02  9.55475864e-02]
 [-1.80082559e-01  4.16376592e-02]
 [-1.38297852e-01 -2.98712502e-01]
 [-2.36232790e-01  1.12924006e-01]
 [ 1.68547408e-01  1.02064039e-02]
 [-1.02435586e-01 -3.91662003e-02]
 [-2.03577562e-01  6.13101402e-02]
 [-1.25409327e-01  3.03929732e-02]
 [-4.99953888e-02 -1.97281358e-01]
 [-2.37138905e-01 -1.26775394e-01]
 [ 8.79036978e-02  2.52600135e-02]
 [ 5.76235744e-02 -7.79655103e-02]
 [ 1.15513626e+00 -5.26203258e-01]
 [ 1.42987109e-01  1.82721680e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.08756666]
curr_Stock_Price:  98.15646082133081
curr_Factors:  [9.81564608e+01 3.96026661e-02]
mat_Sqrt:  [[ 1.95335466e+01  0.00000000e+00]
 [-7.96016744e-03  1.82390349e-02]]
grads:  [ 0.00142686 -0.07406281]
Stock Position:  0.0014268569957561327
Bond Position:  [-10.22762189]


portfolio before change:  [-10.0906719]
curr_Stock_Price:  97.77239049050465
curr_Factors:  [9.77723905e+01 4.05696340e-02]
mat_Sqrt:  [[ 1.96932221e+01  0.00000000e+00]
 [-8.05676203e-03  1.84603609e-02]]
grads:  [-0.00946137 -3.61054534]
Stock Position:  -0.009461370492350619
Bond Position:  [-9.16561109]


portfolio before change:  [-10.09308526]
curr_Stock_Price:  97.78525010394324
curr_Factors:  [9.77852501e+01 4.10277002e-02]
mat_Sqrt:  [[ 1.98066915e+01  0.00000000e+00]
 [-8.10211826e-03  1.85642851e-02]]
grads:  [-3.18820426e-02 -5.10413627e+01]
Stock Position:  -0.03188204255953923
Bond Position:  [-6.97549175]


portfolio before change:  [-10.1370509]
curr_Stock_Price:  99.1095552795309
curr_Factors:  [9.91095553e+01 4.07229731e-02]
mat_Sqrt:  [[ 2.00002427e+01  0.00000000e+00]
 [-8.07197355e-03  1.84952149e-02]]
grads:  [5.34335258e-03 1.48029828e+01]
Stock Position:  0.005343352579442166
Bond Position:  [-10.6666282]


portfolio before change:  [-10.14603962]
curr_Stock_Price:  97.92645331661814
curr_Factors:  [9.79264533e+01 3.97943567e-02]
mat_Sqrt:  [[ 1.95348810e+01  0.00000000e+00]
 [-7.97940917e-03  1.82831233e-02]]
grads:  [-0.02258485 -4.09593869]
Stock Position:  -0.022584845847490608
Bond Position:  [-7.93438577]


portfolio before change:  [-10.1041828]
curr_Stock_Price:  95.98529910654781
curr_Factors:  [9.59852991e+01 3.77671310e-02]
mat_Sqrt:  [[ 1.86535596e+01  0.00000000e+00]
 [-7.77350691e-03  1.78113419e-02]]
grads:  [3.53116237e-03 5.36442380e+00]
Stock Position:  0.0035311623681121857
Bond Position:  [-10.44312247]


portfolio before change:  [-10.11570422]
curr_Stock_Price:  93.46196083304207
curr_Factors:  [9.34619608e+01 3.84341929e-02]
mat_Sqrt:  [[ 1.83228814e+01  0.00000000e+00]
 [-7.84185620e-03  1.79679498e-02]]
grads:  [-0.00883651  2.31732945]
Stock Position:  -0.008836513810956372
Bond Position:  [-9.28982631]


portfolio before change:  [-10.10683271]
curr_Stock_Price:  92.19514278965842
curr_Factors:  [9.21951428e+01 3.82634939e-02]
mat_Sqrt:  [[ 1.80343442e+01  0.00000000e+00]
 [-7.82442268e-03  1.79280046e-02]]
grads:  [-1.48975018e-02 -1.66617818e+01]
Stock Position:  -0.014897501844895588
Bond Position:  [-8.7333554]


portfolio before change:  [-10.13910349]
curr_Stock_Price:  94.21475440710799
curr_Factors:  [9.42147544e+01 3.58304816e-02]
mat_Sqrt:  [[ 1.78338555e+01  0.00000000e+00]
 [-7.57157649e-03  1.73486612e-02]]
grads:  [-0.0104828  6.5090905]
Stock Position:  -0.010482798505177443
Bond Position:  [-9.15146921]


portfolio before change:  [-10.15471887]
curr_Stock_Price:  95.48609626845455
curr_Factors:  [9.54860963e+01 3.58804345e-02]
mat_Sqrt:  [[ 1.80871019e+01  0.00000000e+00]
 [-7.57685259e-03  1.73607503e-02]]
grads:  [0.00956493 0.58790109]
Stock Position:  0.009564929148040708
Bond Position:  [-11.06803661]


portfolio before change:  [-10.15097733]
curr_Stock_Price:  96.16659204981885
curr_Factors:  [9.61665920e+01 3.69318475e-02]
mat_Sqrt:  [[ 1.84809692e+01  0.00000000e+00]
 [-7.68706420e-03  1.76132768e-02]]
grads:  [-0.00646769 -2.22367483]
Stock Position:  -0.006467686628868049
Bond Position:  [-9.52900195]


portfolio before change:  [-10.15845917]
curr_Stock_Price:  96.95501792248797
curr_Factors:  [9.69550179e+01 3.83714784e-02]
mat_Sqrt:  [[ 1.89921686e+01  0.00000000e+00]
 [-7.83545567e-03  1.79532843e-02]]
grads:  [-0.00931013  3.41498185]
Stock Position:  -0.009310133397811995
Bond Position:  [-9.25579502]


portfolio before change:  [-10.16208831]
curr_Stock_Price:  97.09625181230717
curr_Factors:  [9.70962518e+01 3.81046138e-02]
mat_Sqrt:  [[ 1.89535798e+01  0.00000000e+00]
 [-7.80816125e-03  1.78907450e-02]]
grads:  [-0.00591681  1.69880981]
Stock Position:  -0.005916810812110891
Bond Position:  [-9.58758816]


portfolio before change:  [-10.15587415]
curr_Stock_Price:  95.64084560400346
curr_Factors:  [9.56408456e+01 3.92270787e-02]
mat_Sqrt:  [[ 1.89424605e+01  0.00000000e+00]
 [-7.92233083e-03  1.81523404e-02]]
grads:  [-7.18470720e-03 -1.08680949e+01]
Stock Position:  -0.0071847071965446705
Bond Position:  [-9.46872267]


portfolio before change:  [-10.15044435]
curr_Stock_Price:  94.55558641363179
curr_Factors:  [9.45555864e+01 3.95464664e-02]
mat_Sqrt:  [[ 1.88036013e+01  0.00000000e+00]
 [-7.95451735e-03  1.82260889e-02]]
grads:  [-0.01555384 -6.95571029]
Stock Position:  -0.015553840910622858
Bond Position:  [-8.6797418]


portfolio before change:  [-10.14435057]
curr_Stock_Price:  94.02427153192613
curr_Factors:  [9.40242715e+01 3.90198326e-02]
mat_Sqrt:  [[ 1.85730265e+01  0.00000000e+00]
 [-7.90137533e-03  1.81043253e-02]]
grads:  [0.00532644 1.39524744]
Stock Position:  0.005326437860201665
Bond Position:  [-10.64516501]


portfolio before change:  [-10.14843762]
curr_Stock_Price:  93.75665863682644
curr_Factors:  [9.37566586e+01 3.74352173e-02]
mat_Sqrt:  [[ 1.81402096e+01  0.00000000e+00]
 [-7.73927307e-03  1.77329023e-02]]
grads:  [ 1.30079181e-03 -4.39665819e+00]
Stock Position:  0.0013007918122483566
Bond Position:  [-10.27039551]


portfolio before change:  [-10.15239914]
curr_Stock_Price:  92.6853131007851
curr_Factors:  [9.26853131e+01 3.71063821e-02]
mat_Sqrt:  [[ 1.78539875e+01  0.00000000e+00]
 [-7.70520677e-03  1.76548466e-02]]
grads:  [  0.05183617 -29.80503138]
Stock Position:  0.05183616977918471
Bond Position:  [-14.95685076]


portfolio before change:  [-10.11065396]
curr_Stock_Price:  93.56278653974685
curr_Factors:  [9.35627865e+01 3.58416481e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.11065396]
Stock Price:  93.6436781026243
PL:  [-10.11065396]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.87204196e-02  1.42790212e-01]
 [-1.33842850e-01 -5.93130574e-02]
 [-1.23364937e-01 -3.02310892e-01]
 [ 6.47054036e-02  1.70087609e-01]
 [-2.95284948e-01 -1.00689214e-01]
 [ 3.48458154e-01 -4.14080317e-01]
 [-5.63594551e-01  3.86778664e-01]
 [ 6.95934839e-02  1.38155653e-01]
 [-1.94384784e-01 -5.31489112e-02]
 [ 2.99172976e-01  4.47374121e-03]
 [ 1.73644277e-01  2.51351802e-01]
 [-2.38674483e-01  1.09800086e-01]
 [-3.27581118e-02  3.71835459e-02]
 [-1.54227103e-01 -2.45643531e-01]
 [-9.19255727e-04 -8.24637965e-02]
 [ 9.35162273e-02  2.28713189e-02]
 [-1.47395705e-02 -4.81075722e-02]
 [ 5.27658967e-01 -2.73391889e-01]
 [ 1.93283463e-01  1.34587591e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.9515514]
curr_Stock_Price:  100.77489815736098
curr_Factors:  [1.00774898e+02 3.91534349e-02]
mat_Sqrt:  [[ 1.99405578e+01  0.00000000e+00]
 [-7.91489076e-03  1.81352930e-02]]
grads:  [1.80453220e-04 7.87360929e+00]
Stock Position:  0.0001804532201604989
Bond Position:  [7.93336625]


portfolio before change:  [7.95361732]
curr_Stock_Price:  101.23112515168579
curr_Factors:  [1.01231125e+02 3.88613496e-02]
mat_Sqrt:  [[ 1.99559774e+01  0.00000000e+00]
 [-7.88531289e-03  1.80675216e-02]]
grads:  [-0.00800408 -3.28285521]
Stock Position:  -0.008004077545757021
Bond Position:  [8.76387909]


portfolio before change:  [7.9426212]
curr_Stock_Price:  102.87870561820898
curr_Factors:  [1.02878706e+02 3.84411835e-02]
mat_Sqrt:  [[ 2.01708345e+01  0.00000000e+00]
 [-7.84256933e-03  1.79695838e-02]]
grads:  [-1.26570979e-02 -1.68234777e+01]
Stock Position:  -0.012657097882238916
Bond Position:  [9.24476705]


portfolio before change:  [7.97961997]
curr_Stock_Price:  100.13816510048663
curr_Factors:  [1.00138165e+02 3.84674618e-02]
mat_Sqrt:  [[ 1.96402221e+01  0.00000000e+00]
 [-7.84524945e-03  1.79757247e-02]]
grads:  [7.07414209e-03 9.46207240e+00]
Stock Position:  0.0070741420903037595
Bond Position:  [7.27122836]


portfolio before change:  [7.98649383]
curr_Stock_Price:  100.85285659510257
curr_Factors:  [1.00852857e+02 3.75022952e-02]
mat_Sqrt:  [[ 1.95306694e+01  0.00000000e+00]
 [-7.74620373e-03  1.77487825e-02]]
grads:  [-0.01736906 -5.6730209 ]
Stock Position:  -0.017369057758708874
Bond Position:  [9.73821292]


portfolio before change:  [8.00225635]
curr_Stock_Price:  100.08553452022616
curr_Factors:  [1.00085535e+02 3.98958715e-02]
mat_Sqrt:  [[ 1.99910355e+01  0.00000000e+00]
 [-7.98958036e-03  1.83064284e-02]]
grads:  [ 8.39069529e-03 -2.26193940e+01]
Stock Position:  0.00839069528689765
Bond Position:  [7.16246913]


portfolio before change:  [8.02418499]
curr_Stock_Price:  102.48555013338121
curr_Factors:  [1.02485550e+02 3.84737343e-02]
mat_Sqrt:  [[ 2.01022564e+01  0.00000000e+00]
 [-7.84588904e-03  1.79771902e-02]]
grads:  [-1.96391139e-02  2.15149675e+01]
Stock Position:  -0.019639113915307718
Bond Position:  [10.03691039]


portfolio before change:  [8.08001143]
curr_Stock_Price:  99.77071821728316
curr_Factors:  [9.97707182e+01 3.86599123e-02]
mat_Sqrt:  [[ 1.96170424e+01  0.00000000e+00]
 [-7.86484963e-03  1.80206344e-02]]
grads:  [6.62126082e-03 7.66652552e+00]
Stock Position:  0.006621260820394318
Bond Position:  [7.41940348]


portfolio before change:  [8.08115613]
curr_Stock_Price:  99.66343058815694
curr_Factors:  [9.96634306e+01 3.66105491e-02]
mat_Sqrt:  [[ 1.90694845e+01  0.00000000e+00]
 [-7.65355333e-03  1.75364937e-02]]
grads:  [-0.0114099  -3.03076043]
Stock Position:  -0.011409897858698054
Bond Position:  [9.21830569]


portfolio before change:  [8.07881384]
curr_Stock_Price:  100.0707220974635
curr_Factors:  [1.00070722e+02 3.74377172e-02]
mat_Sqrt:  [[ 1.93625126e+01  0.00000000e+00]
 [-7.73953148e-03  1.77334944e-02]]
grads:  [0.01555198 0.25227635]
Stock Position:  0.015551983534580332
Bond Position:  [6.52251562]


portfolio before change:  [8.12650092]
curr_Stock_Price:  103.03216076910545
curr_Factors:  [1.03032161e+02 3.52285690e-02]
mat_Sqrt:  [[ 1.93383898e+01  0.00000000e+00]
 [-7.50771006e-03  1.72023248e-02]]
grads:  [ 0.01465185 14.61150192]
Stock Position:  0.014651850550495485
Bond Position:  [6.6168891]


portfolio before change:  [8.12285915]
curr_Stock_Price:  102.67069119492454
curr_Factors:  [1.02670691e+02 3.70732681e-02]
mat_Sqrt:  [[ 1.97686459e+01  0.00000000e+00]
 [-7.70176791e-03  1.76469672e-02]]
grads:  [-0.00964931  6.22203719]
Stock Position:  -0.009649310205817656
Bond Position:  [9.1135605]


portfolio before change:  [8.15253334]
curr_Stock_Price:  99.83157471492498
curr_Factors:  [9.98315747e+01 3.81566197e-02]
mat_Sqrt:  [[ 1.95008198e+01  0.00000000e+00]
 [-7.81348780e-03  1.79029496e-02]]
grads:  [-8.47650617e-04  2.07695082e+00]
Stock Position:  -0.000847650617249002
Bond Position:  [8.23715564]


portfolio before change:  [8.15575629]
curr_Stock_Price:  98.45906596541225
curr_Factors:  [9.84590660e+01 3.85474966e-02]
mat_Sqrt:  [[ 1.93309769e+01  0.00000000e+00]
 [-7.85340656e-03  1.79944150e-02]]
grads:  [-1.35241344e-02 -1.36510985e+01]
Stock Position:  -0.013524134417339897
Bond Position:  [9.48732994]


portfolio before change:  [8.12271559]
curr_Stock_Price:  101.07755768747019
curr_Factors:  [1.01077558e+02 3.68727152e-02]
mat_Sqrt:  [[ 1.94091850e+01  0.00000000e+00]
 [-7.68090778e-03  1.75991707e-02]]
grads:  [-1.90164642e-03 -4.68566378e+00]
Stock Position:  -0.0019016464197372299
Bond Position:  [8.31492937]


portfolio before change:  [8.1248285]
curr_Stock_Price:  101.05972160289811
curr_Factors:  [1.01059722e+02 3.48478216e-02]
mat_Sqrt:  [[ 1.88653955e+01  0.00000000e+00]
 [-7.46702849e-03  1.71091116e-02]]
grads:  [0.00548613 1.33679173]
Stock Position:  0.005486134077180408
Bond Position:  [7.57040132]


portfolio before change:  [8.1188786]
curr_Stock_Price:  99.6301647408145
curr_Factors:  [9.96301647e+01 3.51042916e-02]
mat_Sqrt:  [[ 1.86668464e+01  0.00000000e+00]
 [-7.49445572e-03  1.71719553e-02]]
grads:  [-1.91437993e-03 -2.80151976e+00]
Stock Position:  -0.0019143799345571662
Bond Position:  [8.30960858]


portfolio before change:  [8.1208372]
curr_Stock_Price:  99.69235669652353
curr_Factors:  [9.96923567e+01 3.54607220e-02]
mat_Sqrt:  [[ 1.87730851e+01  0.00000000e+00]
 [-7.53240700e-03  1.72589126e-02]]
grads:  [  0.0217514  -15.84062074]
Stock Position:  0.021751404272024818
Bond Position:  [5.95238845]


portfolio before change:  [8.09219823]
curr_Stock_Price:  98.30728495038396
curr_Factors:  [9.83072850e+01 3.60727359e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.09219823]
Stock Price:  98.07771115684797
PL:  [8.09219823]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.60334824e-02  1.46828026e-01]
 [ 1.86692672e-01 -1.97872957e-02]
 [-7.71626090e-02  1.29210124e-02]
 [ 2.76003504e-01 -1.67704833e-01]
 [-1.57871921e-01 -8.22024877e-02]
 [ 6.94462129e-01 -9.50823441e-01]
 [-5.38131601e-01  3.15135584e-01]
 [ 3.92673133e-01  1.63533277e-01]
 [ 1.60452491e-01 -1.39413457e-01]
 [ 1.00533613e-01  1.87346111e-02]
 [ 2.55108960e-01  3.81408726e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-6.96741934e-02  1.00442489e-01]
 [-2.65501084e-01 -1.24581113e-01]
 [ 2.18663767e-01  2.04870309e-01]
 [ 7.31040040e-02  3.20417895e-02]
 [-5.34600255e-02  2.27132377e-01]
 [ 1.16083670e-01  5.48931876e-02]
 [-4.16981391e-02 -2.51121359e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.14470746]
curr_Stock_Price:  100.80293539550323
curr_Factors:  [1.00802935e+02 3.94008223e-02]
mat_Sqrt:  [[ 2.00090202e+01  0.00000000e+00]
 [-7.93985615e-03  1.81924959e-02]]
grads:  [4.02194693e-04 8.07080165e+00]
Stock Position:  0.00040219469295599335
Bond Position:  [8.10416506]


portfolio before change:  [8.14783245]
curr_Stock_Price:  103.53467029415525
curr_Factors:  [1.03534670e+02 4.05314696e-02]
mat_Sqrt:  [[ 2.08440439e+01  0.00000000e+00]
 [-8.05297159e-03  1.84516759e-02]]
grads:  [ 0.00854233 -1.07238474]
Stock Position:  0.008542334150234176
Bond Position:  [7.2634047]


portfolio before change:  [8.16655379]
curr_Stock_Price:  105.51366827056643
curr_Factors:  [1.05513668e+02 4.25655533e-02]
mat_Sqrt:  [[ 2.17689691e+01  0.00000000e+00]
 [-8.25256841e-03  1.89090097e-02]]
grads:  [-0.00328557  0.68332571]
Stock Position:  -0.0032855674702048578
Bond Position:  [8.51322606]


portfolio before change:  [8.17549819]
curr_Stock_Price:  103.4391921523141
curr_Factors:  [1.03439192e+02 4.16658055e-02]
mat_Sqrt:  [[ 2.11142185e+01  0.00000000e+00]
 [-8.16488144e-03  1.87080936e-02]]
grads:  [ 0.00960543 -8.96429301]
Stock Position:  0.009605428440383734
Bond Position:  [7.18192043]


portfolio before change:  [8.16953884]
curr_Stock_Price:  102.63183036715489
curr_Factors:  [1.02631830e+02 4.13027127e-02]
mat_Sqrt:  [[ 2.08579375e+01  0.00000000e+00]
 [-8.12922753e-03  1.86264003e-02]]
grads:  [-0.00928894 -4.41322459]
Stock Position:  -0.00928893507809511
Bond Position:  [9.12287925]


portfolio before change:  [8.15692007]
curr_Stock_Price:  104.23586479886103
curr_Factors:  [1.04235865e+02 4.25486784e-02]
mat_Sqrt:  [[ 2.15010768e+01  0.00000000e+00]
 [-8.25093239e-03  1.89052611e-02]]
grads:  [ 1.29988261e-02 -5.02941184e+01]
Stock Position:  0.01299882610015917
Bond Position:  [6.80197619]


portfolio before change:  [8.12126789]
curr_Stock_Price:  101.36230611966403
curr_Factors:  [1.01362306e+02 4.10859984e-02]
mat_Sqrt:  [[ 2.05458165e+01  0.00000000e+00]
 [-8.10787256e-03  1.85774699e-02]]
grads:  [-0.01949765 16.96332094]
Stock Position:  -0.01949765083104925
Bond Position:  [10.09759474]


portfolio before change:  [8.09164256]
curr_Stock_Price:  103.01122484305563
curr_Factors:  [1.03011225e+02 4.17589111e-02]
mat_Sqrt:  [[ 2.10503409e+01  0.00000000e+00]
 [-8.17399889e-03  1.87289843e-02]]
grads:  [0.02204453 8.73156142]
Stock Position:  0.022044531637881563
Bond Position:  [5.82080836]


portfolio before change:  [8.14824243]
curr_Stock_Price:  105.51272855129452
curr_Factors:  [1.05512729e+02 4.05153385e-02]
mat_Sqrt:  [[ 2.12380476e+01  0.00000000e+00]
 [-8.05136893e-03  1.84480038e-02]]
grads:  [ 4.69004833e-03 -7.55710257e+00]
Stock Position:  0.004690048333138998
Bond Position:  [7.65338263]


portfolio before change:  [8.14530763]
curr_Stock_Price:  104.478969209935
curr_Factors:  [1.04478969e+02 4.26760187e-02]
mat_Sqrt:  [[ 2.15834481e+01  0.00000000e+00]
 [-8.26326993e-03  1.89335300e-02]]
grads:  [0.00503673 0.98949383]
Stock Position:  0.005036733110813157
Bond Position:  [7.61907495]


portfolio before change:  [8.15324158]
curr_Stock_Price:  105.67596481353347
curr_Factors:  [1.05675965e+02 4.14025953e-02]
mat_Sqrt:  [[ 2.15025519e+01  0.00000000e+00]
 [-8.13905108e-03  1.86489088e-02]]
grads:  [1.96055509e-02 2.04520666e+01]
Stock Position:  0.019605550874569076
Bond Position:  [6.08140608]


portfolio before change:  [8.17081475]
curr_Stock_Price:  106.49474453567215
curr_Factors:  [1.06494745e+02 4.08736495e-02]
mat_Sqrt:  [[ 2.15302902e+01  0.00000000e+00]
 [-8.08689305e-03  1.85293998e-02]]
grads:  [-0.0087787   6.17036306]
Stock Position:  -0.008778700233704676
Bond Position:  [9.10570019]


portfolio before change:  [8.1813144]
curr_Stock_Price:  105.55805209812435
curr_Factors:  [1.05558052e+02 4.05734632e-02]
mat_Sqrt:  [[ 2.12624060e+01  0.00000000e+00]
 [-8.05714224e-03  1.84612321e-02]]
grads:  [-1.21517279e-03  5.44072510e+00]
Stock Position:  -0.0012151727919650069
Bond Position:  [8.30958568]


portfolio before change:  [8.18244385]
curr_Stock_Price:  106.3383595773537
curr_Factors:  [1.06338360e+02 3.89360599e-02]
mat_Sqrt:  [[ 2.09829216e+01  0.00000000e+00]
 [-7.89288895e-03  1.80848805e-02]]
grads:  [-0.01524443 -6.88868873]
Stock Position:  -0.01524443284509482
Bond Position:  [9.80351183]


portfolio before change:  [8.17620183]
curr_Stock_Price:  106.9086143468826
curr_Factors:  [1.06908614e+02 3.91109110e-02]
mat_Sqrt:  [[ 2.11427593e+01  0.00000000e+00]
 [-7.91059148e-03  1.81254421e-02]]
grads:  [ 0.01457125 11.30291378]
Stock Position:  0.014571253236196815
Bond Position:  [6.61840933]


portfolio before change:  [8.20719602]
curr_Stock_Price:  108.92212589462511
curr_Factors:  [1.08922126e+02 3.97034419e-02]
mat_Sqrt:  [[ 2.17035206e+01  0.00000000e+00]
 [-7.97028902e-03  1.82622264e-02]]
grads:  [0.00401263 1.75453906]
Stock Position:  0.004012629519359209
Bond Position:  [7.77013188]


portfolio before change:  [8.20387605]
curr_Stock_Price:  107.6105803996463
curr_Factors:  [1.07610580e+02 4.18802257e-02]
mat_Sqrt:  [[ 2.20221380e+01  0.00000000e+00]
 [-8.18586350e-03  1.87561695e-02]]
grads:  [2.07376189e-03 1.21097421e+01]
Stock Position:  0.0020737618913685327
Bond Position:  [7.98071733]


portfolio before change:  [8.20526391]
curr_Stock_Price:  107.31760268575088
curr_Factors:  [1.07317603e+02 4.15633653e-02]
mat_Sqrt:  [[ 2.18789419e+01  0.00000000e+00]
 [-8.15483810e-03  1.86850814e-02]]
grads:  [0.00640072 2.93780831]
Stock Position:  0.006400721858869719
Bond Position:  [7.51835379]


portfolio before change:  [8.22650531]
curr_Stock_Price:  110.34250655500877
curr_Factors:  [1.10342507e+02 4.21463319e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.22650531]
Stock Price:  110.82523913531152
PL:  [-2.59873383]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 8.68266989e-02  3.61512202e-01]
 [ 2.75388366e-01  7.54029862e-02]
 [-9.36525270e-02 -9.95873505e-02]
 [ 1.92174237e-01 -2.73312750e-02]
 [-1.67322126e-01 -8.38078194e-02]
 [ 3.53644788e-01 -4.22169954e-01]
 [-4.19366935e-01  1.61695738e-01]
 [ 1.67997096e-02  1.63200009e-01]
 [-2.01534553e-01 -2.52918188e-02]
 [ 2.25456476e-01  6.64036138e-03]
 [-4.90635081e-02  3.08794733e-02]
 [-2.02372653e-01  6.06449852e-02]
 [-2.84505279e-02  1.20220789e-02]
 [-6.27590922e-02 -2.03290276e-01]
 [-2.40928683e-01 -1.25135741e-01]
 [ 8.81534850e-02  3.23833471e-02]
 [ 3.59199472e-02 -7.31816086e-02]
 [ 8.66057043e-01 -4.06075012e-01]
 [ 1.47113322e-01  1.63299853e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.36992177]
curr_Stock_Price:  102.28715889391663
curr_Factors:  [1.02287159e+02 3.92674574e-02]
mat_Sqrt:  [[ 2.02692419e+01  0.00000000e+00]
 [-7.92640724e-03  1.81616806e-02]]
grads:  [1.20677211e-02 1.99052175e+01]
Stock Position:  0.012067721121646741
Bond Position:  [17.13554886]


portfolio before change:  [18.39981166]
curr_Stock_Price:  104.40897316931148
curr_Factors:  [1.04408973e+02 3.99353650e-02]
mat_Sqrt:  [[ 2.08649166e+01  0.00000000e+00]
 [-7.99353389e-03  1.83154871e-02]]
grads:  [0.01477585 4.11689768]
Stock Position:  0.01477585230705267
Bond Position:  [16.85708009]


portfolio before change:  [18.40644755]
curr_Stock_Price:  104.57282793436873
curr_Factors:  [1.04572828e+02 4.10218614e-02]
mat_Sqrt:  [[ 2.11800282e+01  0.00000000e+00]
 [-8.10154172e-03  1.85629641e-02]]
grads:  [-0.00647384 -5.36484098]
Stock Position:  -0.00647383509814682
Bond Position:  [19.08343479]


portfolio before change:  [18.43004448]
curr_Stock_Price:  101.66489493339134
curr_Factors:  [1.01664895e+02 4.17290283e-02]
mat_Sqrt:  [[ 2.07677837e+01  0.00000000e+00]
 [-8.17107369e-03  1.87222819e-02]]
grads:  [ 0.00867911 -1.45982606]
Stock Position:  0.008679110555043161
Bond Position:  [17.54768362]


portfolio before change:  [18.44110153]
curr_Stock_Price:  102.4333578750844
curr_Factors:  [1.02433358e+02 3.87599424e-02]
mat_Sqrt:  [[ 2.01666133e+01  0.00000000e+00]
 [-7.87501796e-03  1.80439329e-02]]
grads:  [-0.01011071 -4.64465367]
Stock Position:  -0.01011071390003652
Bond Position:  [19.4767759]


portfolio before change:  [18.46885887]
curr_Stock_Price:  100.16966596941394
curr_Factors:  [1.00169666e+02 3.64618352e-02]
mat_Sqrt:  [[ 1.91273801e+01  0.00000000e+00]
 [-7.63799295e-03  1.75008404e-02]]
grads:  [ 8.85613783e-03 -2.41228389e+01]
Stock Position:  0.008856137831216984
Bond Position:  [17.5817425]


portfolio before change:  [18.45983801]
curr_Stock_Price:  98.65468872392745
curr_Factors:  [9.86546887e+01 3.69570511e-02]
mat_Sqrt:  [[ 1.89655912e+01  0.00000000e+00]
 [-7.68968671e-03  1.76192857e-02]]
grads:  [-0.01839105  9.17720167]
Stock Position:  -0.018391049623538287
Bond Position:  [20.27420128]


portfolio before change:  [18.47569777]
curr_Stock_Price:  98.06795905212684
curr_Factors:  [9.80679591e+01 3.49144984e-02]
mat_Sqrt:  [[ 1.83244117e+01  0.00000000e+00]
 [-7.47416868e-03  1.71254719e-02]]
grads:  [4.80375765e-03 9.52966495e+00]
Stock Position:  0.00480375764700689
Bond Position:  [18.00460306]


portfolio before change:  [18.48130823]
curr_Stock_Price:  98.29876784405535
curr_Factors:  [9.82987678e+01 3.56618571e-02]
mat_Sqrt:  [[ 1.85630806e+01  0.00000000e+00]
 [-7.55373889e-03  1.73077901e-02]]
grads:  [-0.01145138 -1.46129682]
Stock Position:  -0.011451375513487648
Bond Position:  [19.60696433]


portfolio before change:  [18.49220908]
curr_Stock_Price:  97.77494468135504
curr_Factors:  [9.77749447e+01 3.43771080e-02]
mat_Sqrt:  [[ 1.81285158e+01  0.00000000e+00]
 [-7.41642588e-03  1.69931665e-02]]
grads:  [0.01259643 0.39076657]
Stock Position:  0.012596429291125618
Bond Position:  [17.2605939]


portfolio before change:  [18.49648994]
curr_Stock_Price:  97.77217990104909
curr_Factors:  [9.77721799e+01 3.31458046e-02]
mat_Sqrt:  [[ 1.78003926e+01  0.00000000e+00]
 [-7.28239571e-03  1.66860648e-02]]
grads:  [-0.0019992   1.85061449]
Stock Position:  -0.0019992031559977184
Bond Position:  [18.69195639]


portfolio before change:  [18.50285152]
curr_Stock_Price:  96.92783935726443
curr_Factors:  [9.69278394e+01 3.40551036e-02]
mat_Sqrt:  [[ 1.78870876e+01  0.00000000e+00]
 [-7.38160998e-03  1.69133932e-02]]
grads:  [-0.00983419  3.58561906]
Stock Position:  -0.009834189596128008
Bond Position:  [19.45605827]


portfolio before change:  [18.52073542]
curr_Stock_Price:  95.60396078104422
curr_Factors:  [9.56039608e+01 3.42150642e-02]
mat_Sqrt:  [[ 1.76841653e+01  0.00000000e+00]
 [-7.39892578e-03  1.69530687e-02]]
grads:  [-0.00131212  0.7091388 ]
Stock Position:  -0.001312115228440116
Bond Position:  [18.64617883]


portfolio before change:  [18.5247885]
curr_Stock_Price:  96.06813442652985
curr_Factors:  [9.60681344e+01 3.61318464e-02]
mat_Sqrt:  [[ 1.82609949e+01  0.00000000e+00]
 [-7.60335152e-03  1.74214669e-02]]
grads:  [-8.29539920e-03 -1.16689528e+01]
Stock Position:  -0.008295399197861557
Bond Position:  [19.32171202]


portfolio before change:  [18.54411467]
curr_Stock_Price:  94.32076318061257
curr_Factors:  [9.43207632e+01 3.66801105e-02]
mat_Sqrt:  [[ 1.80643618e+01  0.00000000e+00]
 [-7.66082089e-03  1.75531458e-02]]
grads:  [-0.01636052 -7.1289638 ]
Stock Position:  -0.01636052247354495
Bond Position:  [20.08725164]


portfolio before change:  [18.5443912]
curr_Stock_Price:  94.61084653534708
curr_Factors:  [9.46108465e+01 3.57738257e-02]
mat_Sqrt:  [[ 1.78946670e+01  0.00000000e+00]
 [-7.56558796e-03  1.73349398e-02]]
grads:  [0.00571605 1.86809689]
Stock Position:  0.0057160457981470705
Bond Position:  [18.00359126]


portfolio before change:  [18.56493612]
curr_Stock_Price:  97.41758790129866
curr_Factors:  [9.74175879e+01 3.44624171e-02]
mat_Sqrt:  [[ 1.80846555e+01  0.00000000e+00]
 [-7.42562236e-03  1.70142383e-02]]
grads:  [ 2.20124446e-04 -4.30119806e+00]
Stock Position:  0.00022012444563630432
Bond Position:  [18.54349213]


portfolio before change:  [18.56920649]
curr_Stock_Price:  95.75451321671775
curr_Factors:  [9.57545132e+01 3.57211454e-02]
mat_Sqrt:  [[ 1.80976398e+01  0.00000000e+00]
 [-7.56001539e-03  1.73221714e-02]]
grads:  [  0.03806195 -23.44250052]
Stock Position:  0.038061945359772975
Bond Position:  [14.92460344]


portfolio before change:  [18.54296723]
curr_Stock_Price:  94.96708955859727
curr_Factors:  [9.49670896e+01 3.83814149e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.54296723]
Stock Price:  93.65210862912163
PL:  [18.54296723]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-5.95837676e-02  1.41492809e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.87707467e-01 -7.41310817e-01]
 [ 8.74079332e-02  1.35040444e-01]
 [-1.53734669e-01 -8.15153919e-02]
 [ 6.01276104e-01 -8.06633002e-01]
 [-5.74356096e-01  4.13030129e-01]
 [ 5.11557709e-01  1.72871556e-01]
 [ 5.04088561e-02 -7.91282803e-02]
 [ 2.69422732e-01  9.00899393e-03]
 [ 1.31922248e-01  1.96530555e-01]
 [-2.37346829e-01  8.39201891e-02]
 [-6.94269167e-03  5.40992275e-02]
 [-2.44125123e-01 -2.73868825e-01]
 [-8.44135030e-02 -1.17504725e-01]
 [ 9.48814027e-02  2.71859640e-02]
 [-5.22249718e-02  4.63316485e-03]
 [ 5.43154718e-01 -2.77910613e-01]
 [ 2.08565443e-01  9.43758085e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.89901618]
curr_Stock_Price:  100.76727249658559
curr_Factors:  [1.00767272e+02 4.19133300e-02]
mat_Sqrt:  [[ 2.06298270e+01  0.00000000e+00]
 [-8.18909812e-03  1.87635810e-02]]
grads:  [1.05127255e-04 7.54082119e+00]
Stock Position:  0.00010512725516566312
Bond Position:  [7.88842279]


portfolio before change:  [7.90083938]
curr_Stock_Price:  99.34851083955799
curr_Factors:  [9.93485108e+01 4.27124747e-02]
mat_Sqrt:  [[ 2.05323533e+01  0.00000000e+00]
 [-8.26679863e-03  1.89416152e-02]]
grads:  [-0.0090747  -3.51881132]
Stock Position:  -0.0090746962694345
Bond Position:  [8.80239694]


portfolio before change:  [7.9033339]
curr_Stock_Price:  99.31615214167905
curr_Factors:  [9.93161521e+01 4.30740109e-02]
mat_Sqrt:  [[ 2.06123516e+01  0.00000000e+00]
 [-8.30171171e-03  1.90216112e-02]]
grads:  [-2.48027029e-02 -3.89720308e+01]
Stock Position:  -0.02480270287202864
Bond Position:  [10.36664291]


portfolio before change:  [7.8790195]
curr_Stock_Price:  100.40096883315806
curr_Factors:  [1.00400969e+02 4.23832866e-02]
mat_Sqrt:  [[ 2.06697498e+01  0.00000000e+00]
 [-8.23488060e-03  1.88684818e-02]]
grads:  [7.08012514e-03 7.15693214e+00]
Stock Position:  0.007080125139543453
Bond Position:  [7.16816807]


portfolio before change:  [7.89722156]
curr_Stock_Price:  102.71869661265173
curr_Factors:  [1.02718697e+02 4.14541851e-02]
mat_Sqrt:  [[ 2.09138357e+01  0.00000000e+00]
 [-8.14412035e-03  1.86605240e-02]]
grads:  [-0.00905195 -4.36833349]
Stock Position:  -0.009051945588410874
Bond Position:  [8.82702562]


portfolio before change:  [7.89521992]
curr_Stock_Price:  103.18364364090793
curr_Factors:  [1.03183644e+02 4.10842385e-02]
mat_Sqrt:  [[ 2.09145479e+01  0.00000000e+00]
 [-8.10769891e-03  1.85770720e-02]]
grads:  [ 1.19167099e-02 -4.34208902e+01]
Stock Position:  0.011916709915896955
Bond Position:  [6.66561037]


portfolio before change:  [7.89329479]
curr_Stock_Price:  102.88223941774486
curr_Factors:  [1.02882239e+02 3.88777008e-02]
mat_Sqrt:  [[ 2.02857326e+01  0.00000000e+00]
 [-7.88697162e-03  1.80713222e-02]]
grads:  [-1.94271993e-02  2.28555567e+01]
Stock Position:  -0.01942719929723171
Bond Position:  [9.89200855]


portfolio before change:  [7.87020368]
curr_Stock_Price:  104.19814796578957
curr_Factors:  [1.04198148e+02 3.87595789e-02]
mat_Sqrt:  [[ 2.05139610e+01  0.00000000e+00]
 [-7.87498103e-03  1.80438483e-02]]
grads:  [0.0286149  9.58063673]
Stock Position:  0.028614904847759855
Bond Position:  [4.88858359]


portfolio before change:  [7.85649137]
curr_Stock_Price:  103.67623085180311
curr_Factors:  [1.03676231e+02 4.06436233e-02]
mat_Sqrt:  [[ 2.09014015e+01  0.00000000e+00]
 [-8.06410548e-03  1.84771869e-02]]
grads:  [ 7.59491815e-04 -4.28248525e+00]
Stock Position:  0.0007594918145457124
Bond Position:  [7.77775012]


portfolio before change:  [7.85688537]
curr_Stock_Price:  101.634497776381
curr_Factors:  [1.01634498e+02 4.18539879e-02]
mat_Sqrt:  [[ 2.07926368e+01  0.00000000e+00]
 [-8.18329888e-03  1.87502933e-02]]
grads:  [0.0131467  0.48047216]
Stock Position:  0.013146701037775361
Bond Position:  [6.52072701]


portfolio before change:  [7.8595919]
curr_Stock_Price:  101.71635459274071
curr_Factors:  [1.01716355e+02 4.17147573e-02]
mat_Sqrt:  [[ 2.07747424e+01  0.00000000e+00]
 [-8.16967635e-03  1.87190801e-02]]
grads:  [1.04788406e-02 1.04989430e+01]
Stock Position:  0.010478840592675313
Bond Position:  [6.79372244]


portfolio before change:  [7.85264101]
curr_Stock_Price:  100.89092608930015
curr_Factors:  [1.00890926e+02 4.35300816e-02]
mat_Sqrt:  [[ 2.10497455e+01  0.00000000e+00]
 [-8.34554555e-03  1.91220471e-02]]
grads:  [-0.00953556  4.38866135]
Stock Position:  -0.009535557382943857
Bond Position:  [8.81469223]


portfolio before change:  [7.83878264]
curr_Stock_Price:  102.57539165191314
curr_Factors:  [1.02575392e+02 4.14072661e-02]
mat_Sqrt:  [[ 2.08728361e+01  0.00000000e+00]
 [-8.13951017e-03  1.86499607e-02]]
grads:  [7.98556882e-04 2.90076897e+00]
Stock Position:  0.0007985568815102604
Bond Position:  [7.75687036]


portfolio before change:  [7.8393521]
curr_Stock_Price:  100.85978978256391
curr_Factors:  [1.00859790e+02 4.24203153e-02]
mat_Sqrt:  [[ 2.07732766e+01  0.00000000e+00]
 [-8.23847707e-03  1.88767224e-02]]
grads:  [ -0.01750573 -14.5082827 ]
Stock Position:  -0.017505725439387776
Bond Position:  [9.60497588]


portfolio before change:  [7.86275591]
curr_Stock_Price:  99.66005243051227
curr_Factors:  [9.96600524e+01 4.35821285e-02]
mat_Sqrt:  [[ 2.08053645e+01  0.00000000e+00]
 [-8.35053325e-03  1.91334754e-02]]
grads:  [-0.0065222  -6.14131635]
Stock Position:  -0.006522200997664882
Bond Position:  [8.51275881]


portfolio before change:  [7.85649543]
curr_Stock_Price:  100.94626564566943
curr_Factors:  [1.00946266e+02 4.06653460e-02]
mat_Sqrt:  [[ 2.03564711e+01  0.00000000e+00]
 [-8.06626020e-03  1.84821240e-02]]
grads:  [0.00524385 1.47093289]
Stock Position:  0.005243852409607349
Bond Position:  [7.32714811]


portfolio before change:  [7.86438036]
curr_Stock_Price:  102.1005526863329
curr_Factors:  [1.02100553e+02 4.10682658e-02]
mat_Sqrt:  [[ 2.06909902e+01  0.00000000e+00]
 [-8.10612270e-03  1.85734604e-02]]
grads:  [-0.00242632  0.24945082]
Stock Position:  -0.002426316593524166
Bond Position:  [8.11210862]


portfolio before change:  [7.87290476]
curr_Stock_Price:  99.42319228645339
curr_Factors:  [9.94231923e+01 4.20493846e-02]
mat_Sqrt:  [[ 2.03876667e+01  0.00000000e+00]
 [-8.20237864e-03  1.87940105e-02]]
grads:  [  0.02069215 -14.78719047]
Stock Position:  0.020692146329202438
Bond Position:  [5.81562552]


portfolio before change:  [7.91820289]
curr_Stock_Price:  101.54206601594514
curr_Factors:  [1.01542066e+02 4.03546812e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.91820289]
Stock Price:  100.29522731770724
PL:  [7.62297558]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.79490337e-02  2.04059708e-01]
 [ 9.13068944e-02 -2.15756895e-02]
 [-1.25030797e-01 -3.13676819e-01]
 [ 3.44283876e-02  2.16842310e-01]
 [-3.29817439e-01 -1.04878792e-01]
 [ 4.04833257e-01 -5.02009053e-01]
 [-4.81558611e-01  1.89886720e-01]
 [ 2.15454824e-01  1.49612934e-01]
 [-6.00368497e-02 -3.97626806e-02]
 [ 2.19510893e-01  1.22819964e-02]
 [ 1.11882024e-01  1.80531573e-01]
 [-2.38233552e-01  1.01205035e-01]
 [-1.08428958e-02  5.69805260e-02]
 [-2.07685694e-01 -2.66762301e-01]
 [-5.56737697e-02 -1.05395671e-01]
 [ 9.83928002e-02  3.85256737e-02]
 [-5.13662477e-02 -1.97834669e-02]
 [ 3.41231918e-01 -2.19140452e-01]
 [ 1.77255903e-01  6.94341448e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.86477316]
curr_Stock_Price:  101.19776188055738
curr_Factors:  [1.01197762e+02 3.76285989e-02]
mat_Sqrt:  [[ 1.96304354e+01  0.00000000e+00]
 [-7.75923696e-03  1.77786454e-02]]
grads:  [3.62243236e-03 1.14777985e+01]
Stock Position:  0.0036224323604261985
Bond Position:  [10.49819111]


portfolio before change:  [10.87171153]
curr_Stock_Price:  102.38853415500628
curr_Factors:  [1.02388534e+02 3.67866149e-02]
mat_Sqrt:  [[ 1.96379540e+01  0.00000000e+00]
 [-7.67193482e-03  1.75786110e-02]]
grads:  [ 0.00417001 -1.22738307]
Stock Position:  0.004170011370727424
Bond Position:  [10.44475018]


portfolio before change:  [10.87588694]
curr_Stock_Price:  102.7635682066578
curr_Factors:  [1.02763568e+02 3.47264190e-02]
mat_Sqrt:  [[ 1.91500175e+01  0.00000000e+00]
 [-7.45401036e-03  1.70792833e-02]]
grads:  [-1.36778248e-02 -1.83659240e+01]
Stock Position:  -0.013677824771971468
Bond Position:  [12.28146902]


portfolio before change:  [10.91968367]
curr_Stock_Price:  99.78604918446315
curr_Factors:  [9.97860492e+01 3.56264633e-02]
mat_Sqrt:  [[ 1.88345906e+01  0.00000000e+00]
 [-7.54998949e-03  1.72991992e-02]]
grads:  [6.85261142e-03 1.25348178e+01]
Stock Position:  0.006852611422750434
Bond Position:  [10.23588865]


portfolio before change:  [10.92730672]
curr_Stock_Price:  100.52500111213607
curr_Factors:  [1.00525001e+02 3.60106167e-02]
mat_Sqrt:  [[ 1.90760901e+01  0.00000000e+00]
 [-7.59058540e-03  1.73922161e-02]]
grads:  [-0.01968906 -6.03021439]
Stock Position:  -0.019689060653717703
Bond Position:  [12.90654956]


portfolio before change:  [10.92378504]
curr_Stock_Price:  100.86776573809667
curr_Factors:  [1.00867766e+02 3.43849251e-02]
mat_Sqrt:  [[ 1.87040839e+01  0.00000000e+00]
 [-7.41726905e-03  1.69950984e-02]]
grads:  [ 9.93037372e-03 -2.95384610e+01]
Stock Position:  0.009930373723036394
Bond Position:  [9.92213043]


portfolio before change:  [10.91273577]
curr_Stock_Price:  99.5052674575535
curr_Factors:  [9.95052675e+01 3.39993560e-02]
mat_Sqrt:  [[ 1.83476910e+01  0.00000000e+00]
 [-7.37556572e-03  1.68995441e-02]]
grads:  [-0.02172945 11.23620369]
Stock Position:  -0.021729450984606255
Bond Position:  [13.0749306]


portfolio before change:  [10.87867198]
curr_Stock_Price:  101.22334728263719
curr_Factors:  [1.01223347e+02 3.22491037e-02]
mat_Sqrt:  [[ 1.81777246e+01  0.00000000e+00]
 [-7.18321418e-03  1.64588114e-02]]
grads:  [0.0154448 9.0901421]
Stock Position:  0.015444796745820612
Bond Position:  [9.31529795]


portfolio before change:  [10.90457502]
curr_Stock_Price:  102.74968188383531
curr_Factors:  [1.02749682e+02 3.10179171e-02]
mat_Sqrt:  [[ 1.80961756e+01  0.00000000e+00]
 [-7.04476169e-03  1.61415769e-02]]
grads:  [-0.00427663 -2.46337027]
Stock Position:  -0.004276633255042317
Bond Position:  [11.34399773]


portfolio before change:  [10.90887269]
curr_Stock_Price:  102.40798546643302
curr_Factors:  [1.02407985e+02 3.09894258e-02]
mat_Sqrt:  [[ 1.80277110e+01  0.00000000e+00]
 [-7.04152549e-03  1.61341618e-02]]
grads:  [0.01247364 0.76124168]
Stock Position:  0.012473641010887953
Bond Position:  [9.63147224]


portfolio before change:  [10.89244912]
curr_Stock_Price:  100.898263151883
curr_Factors:  [1.00898263e+02 3.10428548e-02]
mat_Sqrt:  [[ 1.77772474e+01  0.00000000e+00]
 [-7.04759304e-03  1.61480643e-02]]
grads:  [1.07256460e-02 1.11797656e+01]
Stock Position:  0.010725645974751999
Bond Position:  [9.81025007]


portfolio before change:  [10.90762102]
curr_Stock_Price:  102.0841152079974
curr_Factors:  [1.02084115e+02 3.01781509e-02]
mat_Sqrt:  [[ 1.77339093e+01  0.00000000e+00]
 [-6.94874388e-03  1.59215724e-02]]
grads:  [-0.01094311  6.35647236]
Stock Position:  -0.010943106242866542
Bond Position:  [12.02473834]


portfolio before change:  [10.90336123]
curr_Stock_Price:  102.74812684195285
curr_Factors:  [1.02748127e+02 3.10624329e-02]
mat_Sqrt:  [[ 1.81088823e+01  0.00000000e+00]
 [-7.04981508e-03  1.61531556e-02]]
grads:  [7.74506356e-04 3.52751669e+00]
Stock Position:  0.000774506356099386
Bond Position:  [10.82378215]


portfolio before change:  [10.90371731]
curr_Stock_Price:  99.71367525554932
curr_Factors:  [9.97136753e+01 3.09733409e-02]
mat_Sqrt:  [[ 1.75488536e+01  0.00000000e+00]
 [-7.03969783e-03  1.61299741e-02]]
grads:  [ -0.01846903 -16.53829695]
Stock Position:  -0.018469030215875086
Bond Position:  [12.74533219]


portfolio before change:  [10.89862881]
curr_Stock_Price:  100.16173511625342
curr_Factors:  [1.00161735e+02 2.99842143e-02]
mat_Sqrt:  [[ 1.73439565e+01  0.00000000e+00]
 [-6.92638022e-03  1.58703308e-02]]
grads:  [-5.86211177e-03 -6.64105068e+00]
Stock Position:  -0.005862111774626528
Bond Position:  [11.4857881]


portfolio before change:  [10.8984908]
curr_Stock_Price:  100.67517014235077
curr_Factors:  [1.00675170e+02 2.97936774e-02]
mat_Sqrt:  [[ 1.73773852e+01  0.00000000e+00]
 [-6.90433805e-03  1.58198259e-02]]
grads:  [0.0066297  2.43527799]
Stock Position:  0.006629696094139111
Bond Position:  [10.23104502]


portfolio before change:  [10.90645418]
curr_Stock_Price:  101.49048521063949
curr_Factors:  [1.01490485e+02 2.84498023e-02]
mat_Sqrt:  [[ 1.71184704e+01  0.00000000e+00]
 [-6.74682768e-03  1.54589243e-02]]
grads:  [-0.00350501 -1.27974409]
Stock Position:  -0.0035050129609162893
Bond Position:  [11.26217964]


portfolio before change:  [10.90496643]
curr_Stock_Price:  102.71833763495299
curr_Factors:  [1.02718338e+02 2.63738995e-02]
mat_Sqrt:  [[ 1.66815022e+01  0.00000000e+00]
 [-6.49601718e-03  1.48842452e-02]]
grads:  [ 1.47223662e-02 -1.47229805e+01]
Stock Position:  0.014722366200441877
Bond Position:  [9.39270945]


portfolio before change:  [10.90312948]
curr_Stock_Price:  102.43404729765737
curr_Factors:  [1.02434047e+02 2.61629850e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.90312948]
Stock Price:  104.50730405934691
PL:  [6.39582542]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.71867951e-01 -6.33240051e-01]
 [-3.52056364e-02  2.75941499e-01]
 [-4.12937296e-01 -1.17103055e-01]
 [ 2.57117925e-01 -2.83801143e-01]
 [-4.67678492e-01  1.77232185e-01]
 [ 1.53500040e-01  1.44746440e-01]
 [-1.75294961e-01 -4.53875122e-02]
 [ 3.01028544e-01  4.51534640e-03]
 [ 6.61504965e-02  1.40236571e-01]
 [-2.35950622e-01  5.67039704e-02]
 [-9.05107248e-02  3.29507539e-02]
 [-3.85104192e-02 -1.91879884e-01]
 [-1.40715751e-01 -1.44509522e-01]
 [ 8.82429393e-02  5.42869448e-02]
 [ 3.44525939e-02 -6.22938966e-02]
 [ 1.05653525e+00 -4.85550429e-01]
 [ 1.57765005e-01  2.06406382e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.4390942]
curr_Stock_Price:  98.10543544140616
curr_Factors:  [9.81054354e+01 4.07076716e-02]
mat_Sqrt:  [[ 1.97938922e+01  0.00000000e+00]
 [-8.07045690e-03  1.84917398e-02]]
grads:  [ 0.00140809 -0.07305069]
Stock Position:  0.0014080897939897329
Bond Position:  [-10.57723547]


portfolio before change:  [-10.44162086]
curr_Stock_Price:  98.18922847227596
curr_Factors:  [9.81892285e+01 3.89462706e-02]
mat_Sqrt:  [[ 1.93774572e+01  0.00000000e+00]
 [-7.89392380e-03  1.80872517e-02]]
grads:  [-0.00961555 -3.68502476]
Stock Position:  -0.009615548030296754
Bond Position:  [-9.49747761]


portfolio before change:  [-10.46272338]
curr_Stock_Price:  100.1368929016761
curr_Factors:  [1.00136893e+02 3.84264980e-02]
mat_Sqrt:  [[ 1.96295126e+01  0.00000000e+00]
 [-7.84107115e-03  1.79661510e-02]]
grads:  [-2.28348292e-02 -3.52462834e+01]
Stock Position:  -0.022834829187478915
Bond Position:  [-8.17611454]


portfolio before change:  [-10.4184437]
curr_Stock_Price:  98.10823902832954
curr_Factors:  [9.81082390e+01 3.77612731e-02]
mat_Sqrt:  [[ 1.90646481e+01  0.00000000e+00]
 [-7.77290402e-03  1.78099605e-02]]
grads:  [4.47032153e-03 1.54936615e+01]
Stock Position:  0.004470321530605617
Bond Position:  [-10.85701908]


portfolio before change:  [-10.41421753]
curr_Stock_Price:  99.6608707195209
curr_Factors:  [9.96608707e+01 3.81624607e-02]
mat_Sqrt:  [[ 1.94689649e+01  0.00000000e+00]
 [-7.81408581e-03  1.79043199e-02]]
grads:  [-0.02383513 -6.54049167]
Stock Position:  -0.023835127442217465
Bond Position:  [-8.03878798]


portfolio before change:  [-10.40605361]
curr_Stock_Price:  99.23402692575347
curr_Factors:  [9.92340269e+01 3.78161144e-02]
mat_Sqrt:  [[ 1.92974119e+01  0.00000000e+00]
 [-7.77854633e-03  1.78228887e-02]]
grads:  [ 6.90543127e-03 -1.59234088e+01]
Stock Position:  0.0069054312697841395
Bond Position:  [-11.09130736]


portfolio before change:  [-10.40931115]
curr_Stock_Price:  99.16388337937019
curr_Factors:  [9.91638834e+01 3.84807115e-02]
mat_Sqrt:  [[ 1.94524843e+01  0.00000000e+00]
 [-7.84660044e-03  1.79788202e-02]]
grads:  [-0.02006572  9.85783174]
Stock Position:  -0.02006571604120153
Bond Position:  [-8.41951683]


portfolio before change:  [-10.44043988]
curr_Stock_Price:  100.61030990992909
curr_Factors:  [1.00610310e+02 3.79614927e-02]
mat_Sqrt:  [[ 1.96026203e+01  0.00000000e+00]
 [-7.79348371e-03  1.78571145e-02]]
grads:  [0.01105325 8.10581351]
Stock Position:  0.011053245046581131
Bond Position:  [-11.55251029]


portfolio before change:  [-10.43415083]
curr_Stock_Price:  101.44061220187683
curr_Factors:  [1.01440612e+02 3.67031200e-02]
mat_Sqrt:  [[ 1.94340517e+01  0.00000000e+00]
 [-7.66322335e-03  1.75586505e-02]]
grads:  [-0.01003927 -2.58490891]
Stock Position:  -0.010039270186942029
Bond Position:  [-9.41576112]


portfolio before change:  [-10.4233458]
curr_Stock_Price:  100.12983273682634
curr_Factors:  [1.00129833e+02 3.76243367e-02]
mat_Sqrt:  [[ 1.94221774e+01  0.00000000e+00]
 [-7.75879751e-03  1.77776384e-02]]
grads:  [0.01560068 0.25399023]
Stock Position:  0.01560068141730274
Bond Position:  [-11.98543942]


portfolio before change:  [-10.43091344]
curr_Stock_Price:  99.83683850142285
curr_Factors:  [9.98368385e+01 3.85467541e-02]
mat_Sqrt:  [[ 1.96012933e+01  0.00000000e+00]
 [-7.85333092e-03  1.79942417e-02]]
grads:  [6.49726281e-03 7.79341376e+00]
Stock Position:  0.006497262808868209
Bond Position:  [-11.07957962]


portfolio before change:  [-10.43916082]
curr_Stock_Price:  98.99384628555178
curr_Factors:  [9.89938463e+01 3.95738634e-02]
mat_Sqrt:  [[ 1.96930246e+01  0.00000000e+00]
 [-7.95727223e-03  1.82324012e-02]]
grads:  [-0.01072476  3.11006597]
Stock Position:  -0.01072476088389674
Bond Position:  [-9.37747549]


portfolio before change:  [-10.43231412]
curr_Stock_Price:  98.13682334979846
curr_Factors:  [9.81368233e+01 4.14897749e-02]
mat_Sqrt:  [[ 1.99895278e+01  0.00000000e+00]
 [-8.14761559e-03  1.86685326e-02]]
grads:  [-0.00380849  1.76504253]
Stock Position:  -0.0038084860011109137
Bond Position:  [-10.0585614]


portfolio before change:  [-10.42385916]
curr_Stock_Price:  95.25643578137783
curr_Factors:  [9.52564358e+01 4.44533079e-02]
mat_Sqrt:  [[ 2.00838223e+01  0.00000000e+00]
 [-8.43358125e-03  1.93237622e-02]]
grads:  [-6.08717129e-03 -9.92973739e+00]
Stock Position:  -0.006087171290460481
Bond Position:  [-9.84401692]


portfolio before change:  [-10.43703142]
curr_Stock_Price:  97.01603047466902
curr_Factors:  [9.70160305e+01 4.37278523e-02]
mat_Sqrt:  [[ 2.02872217e+01  0.00000000e+00]
 [-8.36448227e-03  1.91654366e-02]]
grads:  [-0.01004499 -7.54011114]
Stock Position:  -0.010044986967859304
Bond Position:  [-9.46250666]


portfolio before change:  [-10.43158102]
curr_Stock_Price:  96.23789803099082
curr_Factors:  [9.62378980e+01 4.32697269e-02]
mat_Sqrt:  [[ 2.00188076e+01  0.00000000e+00]
 [-8.32055065e-03  1.90647766e-02]]
grads:  [0.00559153 2.84749966]
Stock Position:  0.0055915270553811725
Bond Position:  [-10.96969783]


portfolio before change:  [-10.45556124]
curr_Stock_Price:  92.43974782200421
curr_Factors:  [9.24397478e+01 4.53114042e-02]
mat_Sqrt:  [[ 1.96771643e+01  0.00000000e+00]
 [-8.51459023e-03  1.95093771e-02]]
grads:  [ 3.69225382e-04 -3.19302335e+00]
Stock Position:  0.00036922538213269174
Bond Position:  [-10.48969235]


portfolio before change:  [-10.45771399]
curr_Stock_Price:  93.7126912762116
curr_Factors:  [9.37126913e+01 4.74932993e-02]
mat_Sqrt:  [[ 2.04227669e+01  0.00000000e+00]
 [-8.71718297e-03  1.99735754e-02]]
grads:  [  0.04135697 -24.30964007]
Stock Position:  0.041356965671268876
Bond Position:  [-14.33338655]


portfolio before change:  [-10.52686847]
curr_Stock_Price:  92.12721018000315
curr_Factors:  [9.21272102e+01 4.83754911e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.52686847]
Stock Price:  90.92435926394393
PL:  [-10.52686847]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.04597966e-01 -8.56552286e-01]
 [ 3.18097077e-03  2.62842416e-01]
 [-4.55999235e-01 -1.24040762e-01]
 [ 3.24447326e-01 -3.76630421e-01]
 [-4.96148358e-01  2.04536852e-01]
 [ 2.04463847e-01  1.48749602e-01]
 [-2.01076940e-01 -2.70747799e-02]
 [ 2.02787636e-01  8.06083882e-03]
 [ 3.17019245e-02  1.08971614e-01]
 [-2.35580220e-01  6.92357256e-02]
 [ 6.78976890e-03  5.76629419e-03]
 [-1.61642430e-02 -1.62073107e-01]
 [-2.57594643e-01 -1.18234292e-01]
 [ 8.73636659e-02  1.83324620e-02]
 [ 6.69632547e-02 -8.49904490e-02]
 [ 1.06722823e+00 -4.90115140e-01]
 [ 1.61339504e-01  2.08253791e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.92028809]
curr_Stock_Price:  98.47104843588995
curr_Factors:  [9.84710484e+01 4.05629841e-02]
mat_Sqrt:  [[ 1.98323195e+01  0.00000000e+00]
 [-8.05610170e-03  1.84588479e-02]]
grads:  [ 0.00140536 -0.07318085]
Stock Position:  0.001405361465830355
Bond Position:  [-8.05867551]


portfolio before change:  [-7.92148252]
curr_Stock_Price:  99.05487858901954
curr_Factors:  [9.90548786e+01 4.26745282e-02]
mat_Sqrt:  [[ 2.04625726e+01  0.00000000e+00]
 [-8.26312562e-03  1.89331993e-02]]
grads:  [-0.00910564 -3.52037546]
Stock Position:  -0.009105642459835814
Bond Position:  [-7.01952421]


portfolio before change:  [-7.91764549]
curr_Stock_Price:  98.4407400894419
curr_Factors:  [9.84407401e+01 4.40375023e-02]
mat_Sqrt:  [[ 2.06579018e+01  0.00000000e+00]
 [-8.39404573e-03  1.92331750e-02]]
grads:  [-2.80003282e-02 -4.45351476e+01]
Stock Position:  -0.028000328170814694
Bond Position:  [-5.16127247]


portfolio before change:  [-7.94350593]
curr_Stock_Price:  99.31822838436277
curr_Factors:  [9.93182284e+01 4.16045620e-02]
mat_Sqrt:  [[ 2.02581341e+01  0.00000000e+00]
 [-8.15887855e-03  1.86943393e-02]]
grads:  [5.81962807e-03 1.40600003e+01]
Stock Position:  0.0058196280723837755
Bond Position:  [-8.52150108]


portfolio before change:  [-7.94637326]
curr_Stock_Price:  99.19164294254243
curr_Factors:  [9.91916429e+01 4.15751632e-02]
mat_Sqrt:  [[ 2.02251646e+01  0.00000000e+00]
 [-8.15599541e-03  1.86877332e-02]]
grads:  [-0.02522279 -6.63754992]
Stock Position:  -0.025222789117668138
Bond Position:  [-5.44448336]


portfolio before change:  [-7.96197582]
curr_Stock_Price:  99.75626205486074
curr_Factors:  [9.97562621e+01 4.13072462e-02]
mat_Sqrt:  [[ 2.02746464e+01  0.00000000e+00]
 [-8.12967367e-03  1.86274225e-02]]
grads:  [ 7.89519735e-03 -2.02191377e+01]
Stock Position:  0.00789519735061736
Bond Position:  [-8.74957119]


portfolio before change:  [-7.96502391]
curr_Stock_Price:  99.64728082581277
curr_Factors:  [9.96472808e+01 4.19432130e-02]
mat_Sqrt:  [[ 2.04078052e+01  0.00000000e+00]
 [-8.19201689e-03  1.87702688e-02]]
grads:  [-0.01993753 10.89685262]
Stock Position:  -0.019937526523012786
Bond Position:  [-5.97830361]


portfolio before change:  [-7.9960372]
curr_Stock_Price:  101.12783179451263
curr_Factors:  [1.01127832e+02 4.32351079e-02]
mat_Sqrt:  [[ 2.10275643e+01  0.00000000e+00]
 [-8.31722145e-03  1.90571484e-02]]
grads:  [0.01281097 7.80544912]
Stock Position:  0.012810970045677798
Bond Position:  [-9.29158282]


portfolio before change:  [-8.03533551]
curr_Stock_Price:  98.24162333527215
curr_Factors:  [9.82416233e+01 4.35492127e-02]
mat_Sqrt:  [[ 2.05015022e+01  0.00000000e+00]
 [-8.34737925e-03  1.91262486e-02]]
grads:  [-0.01038428 -1.41558235]
Stock Position:  -0.010384280160739338
Bond Position:  [-7.01516697]


portfolio before change:  [-8.02336575]
curr_Stock_Price:  96.92003222008617
curr_Factors:  [9.69200322e+01 4.43454641e-02]
mat_Sqrt:  [[ 2.04097720e+01  0.00000000e+00]
 [-8.42334510e-03  1.93003083e-02]]
grads:  [0.01010818 0.41765337]
Stock Position:  0.010108181266206658
Bond Position:  [-9.00305101]


portfolio before change:  [-8.00248319]
curr_Stock_Price:  99.20863419612596
curr_Factors:  [9.92086342e+01 4.08911168e-02]
mat_Sqrt:  [[ 2.00615256e+01  0.00000000e+00]
 [-8.08862082e-03  1.85333586e-02]]
grads:  [3.95089773e-03 5.87975535e+00]
Stock Position:  0.003950897733722152
Bond Position:  [-8.39444636]


portfolio before change:  [-8.0102083]
curr_Stock_Price:  97.784593934763
curr_Factors:  [9.77845939e+01 4.20610814e-02]
mat_Sqrt:  [[ 2.00544453e+01  0.00000000e+00]
 [-8.20351938e-03  1.87966243e-02]]
grads:  [-0.01024029  3.68341276]
Stock Position:  -0.01024028684354469
Bond Position:  [-7.00886601]


portfolio before change:  [-7.98518644]
curr_Stock_Price:  95.1699895408724
curr_Factors:  [9.51699895e+01 4.48017988e-02]
mat_Sqrt:  [[ 2.01440944e+01  0.00000000e+00]
 [-8.46657417e-03  1.93993585e-02]]
grads:  [0.00046199 0.29724149]
Stock Position:  0.00046199078659582863
Bond Position:  [-8.0291541]


portfolio before change:  [-7.98739873]
curr_Stock_Price:  94.72680301308554
curr_Factors:  [9.47268030e+01 4.65356304e-02]
mat_Sqrt:  [[ 2.04345784e+01  0.00000000e+00]
 [-8.62884747e-03  1.97711733e-02]]
grads:  [-4.25253433e-03 -8.19744505e+00]
Stock Position:  -0.00425253432956973
Bond Position:  [-7.58456975]


portfolio before change:  [-7.98349943]
curr_Stock_Price:  93.36392794808847
curr_Factors:  [9.33639279e+01 4.71065683e-02]
mat_Sqrt:  [[ 2.02637514e+01  0.00000000e+00]
 [-8.68161905e-03  1.98920882e-02]]
grads:  [-0.01525859 -5.94378481]
Stock Position:  -0.015258592183068095
Bond Position:  [-6.55889733]


portfolio before change:  [-7.98533111]
curr_Stock_Price:  93.37649433910256
curr_Factors:  [9.33764943e+01 4.98283705e-02]
mat_Sqrt:  [[ 2.08437525e+01  0.00000000e+00]
 [-8.92890770e-03  2.04586977e-02]]
grads:  [0.00457521 0.89607179]
Stock Position:  0.0045752130414880065
Bond Position:  [-8.41254846]


portfolio before change:  [-7.98175341]
curr_Stock_Price:  94.61820714668801
curr_Factors:  [9.46182071e+01 5.04993443e-02]
mat_Sqrt:  [[ 2.12626595e+01  0.00000000e+00]
 [-8.98882367e-03  2.05959824e-02]]
grads:  [ 1.40482811e-03 -4.12655474e+00]
Stock Position:  0.0014048281079927763
Bond Position:  [-8.11467572]


portfolio before change:  [-7.98522424]
curr_Stock_Price:  93.59181259113977
curr_Factors:  [9.35918126e+01 5.16407449e-02]
mat_Sqrt:  [[ 2.12683651e+01  0.00000000e+00]
 [-9.08984003e-03  2.08274400e-02]]
grads:  [  0.04012177 -23.53218348]
Stock Position:  0.040121769679149426
Bond Position:  [-11.74029339]


portfolio before change:  [-8.04986023]
curr_Stock_Price:  92.05398044766864
curr_Factors:  [9.20539804e+01 5.33539481e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.04986023]
Stock Price:  94.41571863342286
PL:  [-8.04986023]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-6.26752840e-02  1.36847011e-01]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.08836556e-01 -1.05660279e+00]
 [-1.43993816e-02  2.78121844e-01]
 [-4.45811192e-01 -2.14787464e-02]
 [ 5.06426773e-01 -3.75121209e-01]
 [ 5.16000229e-02  9.20100860e-03]
 [-1.80930230e-01 -8.54243236e-01]
 [-2.57210012e-01  2.10155161e-01]
 [-2.91205062e-02  5.61852800e-03]
 [-8.33755836e-02  2.36248547e-02]
 [ 3.96263034e-02 -6.95992432e-02]
 [ 4.10822553e-01 -6.43170667e-02]
 [ 2.49219542e-01  2.30277893e-01]
 [-3.23791715e-01 -9.01593407e-02]
 [ 7.17367022e-02  1.36679436e-01]
 [-5.78783009e-02 -9.61809558e-03]
 [ 1.55989460e+00 -6.94393581e-01]
 [ 3.15542092e-01  2.87412011e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.6731653]
curr_Stock_Price:  100.73448949919934
curr_Factors:  [1.00734489e+02 4.05526998e-02]
mat_Sqrt:  [[ 2.02856102e+01  0.00000000e+00]
 [-8.05508036e-03  1.84565078e-02]]
grads:  [-1.45440640e-04  7.41456685e+00]
Stock Position:  -0.00014544064023463025
Bond Position:  [7.68781619]


portfolio before change:  [7.67520076]
curr_Stock_Price:  99.95570578554234
curr_Factors:  [9.99557058e+01 4.13868662e-02]
mat_Sqrt:  [[ 2.03347511e+01  0.00000000e+00]
 [-8.13750490e-03  1.86453661e-02]]
grads:  [-0.00916288 -3.57472038]
Stock Position:  -0.009162879298035609
Bond Position:  [8.59108283]


portfolio before change:  [7.70298463]
curr_Stock_Price:  97.15791355676578
curr_Factors:  [9.71579136e+01 4.05492642e-02]
mat_Sqrt:  [[ 1.95645412e+01  0.00000000e+00]
 [-8.05473914e-03  1.84557259e-02]]
grads:  [-3.42443921e-02 -5.72506765e+01]
Stock Position:  -0.034244392111011504
Bond Position:  [11.03009832]


portfolio before change:  [7.74883157]
curr_Stock_Price:  95.8996324561062
curr_Factors:  [9.58996325e+01 3.88972013e-02]
mat_Sqrt:  [[ 1.89136836e+01  0.00000000e+00]
 [-7.88894936e-03  1.80758538e-02]]
grads:  [5.65637793e-03 1.53863739e+01]
Stock Position:  0.005656377930268685
Bond Position:  [7.20638701]


portfolio before change:  [7.74140036]
curr_Stock_Price:  94.26730927151539
curr_Factors:  [9.42673093e+01 3.98971959e-02]
mat_Sqrt:  [[ 1.88292186e+01  0.00000000e+00]
 [-7.98971297e-03  1.83067322e-02]]
grads:  [-0.02417441 -1.17327036]
Stock Position:  -0.024174411854946492
Bond Position:  [10.02025712]


portfolio before change:  [7.7895607]
curr_Stock_Price:  92.37874366202507
curr_Factors:  [9.23787437e+01 3.94041081e-02]
mat_Sqrt:  [[ 1.83376130e+01  0.00000000e+00]
 [-7.94018721e-03  1.81932545e-02]]
grads:  [ 1.86889349e-02 -2.06186974e+01]
Stock Position:  0.018688934906157532
Bond Position:  [6.06310037]


portfolio before change:  [7.76520552]
curr_Stock_Price:  90.99444070145142
curr_Factors:  [9.09944407e+01 3.86054343e-02]
mat_Sqrt:  [[ 1.78788294e+01  0.00000000e+00]
 [-7.85930625e-03  1.80079329e-02]]
grads:  [0.0031107  0.51094196]
Stock Position:  0.0031106998665123052
Bond Position:  [7.48214912]


portfolio before change:  [7.76002716]
curr_Stock_Price:  88.72834922035848
curr_Factors:  [8.87283492e+01 3.88597905e-02]
mat_Sqrt:  [[ 1.74909190e+01  0.00000000e+00]
 [-7.88515471e-03  1.80671592e-02]]
grads:  [-3.16594310e-02 -4.72815471e+01]
Stock Position:  -0.03165943096340827
Bond Position:  [10.5691162]


portfolio before change:  [7.72761264]
curr_Stock_Price:  89.83566937299666
curr_Factors:  [8.98356694e+01 3.94512309e-02]
mat_Sqrt:  [[ 1.78434606e+01  0.00000000e+00]
 [-7.94493357e-03  1.82041297e-02]]
grads:  [-9.27458990e-03  1.15443674e+01]
Stock Position:  -0.009274589902308195
Bond Position:  [8.56080163]


portfolio before change:  [7.72796596]
curr_Stock_Price:  90.02836205600896
curr_Factors:  [9.00283621e+01 4.00899459e-02]
mat_Sqrt:  [[ 1.80259053e+01  0.00000000e+00]
 [-8.00898954e-03  1.83509004e-02]]
grads:  [-0.00147945  0.30617179]
Stock Position:  -0.0014794474475495441
Bond Position:  [7.86115819]


portfolio before change:  [7.73149469]
curr_Stock_Price:  88.97175627537632
curr_Factors:  [8.89717563e+01 4.09155132e-02]
mat_Sqrt:  [[ 1.79968363e+01  0.00000000e+00]
 [-8.09103338e-03  1.85388865e-02]]
grads:  [-0.00405987  1.27434055]
Stock Position:  -0.004059872007807067
Bond Position:  [8.09270863]


portfolio before change:  [7.7311942]
curr_Stock_Price:  89.54416951827571
curr_Factors:  [8.95441695e+01 4.01132832e-02]
mat_Sqrt:  [[ 1.79341756e+01  0.00000000e+00]
 [-8.01132031e-03  1.83562409e-02]]
grads:  [ 5.15814253e-04 -3.79158476e+00]
Stock Position:  0.0005158142533857022
Bond Position:  [7.68500604]


portfolio before change:  [7.73328915]
curr_Stock_Price:  89.88045191909083
curr_Factors:  [8.98804519e+01 3.99821367e-02]
mat_Sqrt:  [[ 1.79720760e+01  0.00000000e+00]
 [-7.99821347e-03  1.83262093e-02]]
grads:  [ 0.02129705 -3.5095674 ]
Stock Position:  0.021297054568540266
Bond Position:  [5.81910026]


portfolio before change:  [7.70309595]
curr_Stock_Price:  88.39441742789722
curr_Factors:  [8.83944174e+01 4.09579029e-02]
mat_Sqrt:  [[ 1.78893143e+01  0.00000000e+00]
 [-8.09522357e-03  1.85484874e-02]]
grads:  [ 0.01954916 12.41491493]
Stock Position:  0.01954915926102423
Bond Position:  [5.9750594]


portfolio before change:  [7.72426545]
curr_Stock_Price:  89.40088273014685
curr_Factors:  [8.94008827e+01 3.91610954e-02]
mat_Sqrt:  [[ 1.76916860e+01  0.00000000e+00]
 [-7.91566501e-03  1.81370670e-02]]
grads:  [-0.02052605 -4.97099892]
Stock Position:  -0.020526052592765326
Bond Position:  [9.55931267]


portfolio before change:  [7.75966932]
curr_Stock_Price:  87.79250036685
curr_Factors:  [8.77925004e+01 4.06724112e-02]
mat_Sqrt:  [[ 1.77054667e+01  0.00000000e+00]
 [-8.06696089e-03  1.84837295e-02]]
grads:  [0.00742079 7.3945811 ]
Stock Position:  0.007420787102245496
Bond Position:  [7.10817986]


portfolio before change:  [7.76501843]
curr_Stock_Price:  88.2738297576154
curr_Factors:  [8.82738298e+01 4.00310772e-02]
mat_Sqrt:  [[ 1.76616229e+01  0.00000000e+00]
 [-8.00310711e-03  1.83374221e-02]]
grads:  [-0.00351474 -0.52450642]
Stock Position:  -0.003514738274736284
Bond Position:  [8.07527784]


portfolio before change:  [7.76663456]
curr_Stock_Price:  88.38847114409604
curr_Factors:  [8.83884711e+01 3.87439259e-02]
mat_Sqrt:  [[ 1.73979242e+01  0.00000000e+00]
 [-7.87339072e-03  1.80402045e-02]]
grads:  [  0.0722406  -38.49144738]
Stock Position:  0.07224059504994636
Bond Position:  [1.38139881]


portfolio before change:  [7.76741184]
curr_Stock_Price:  88.39444959277516
curr_Factors:  [8.83944496e+01 3.81167151e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.76741184]
Stock Price:  88.79519009153488
PL:  [7.76741184]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.22148370e-02 -1.43280144e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.65614641e-01 -5.90574612e-01]
 [ 1.67407589e-01  1.14344551e-02]
 [-2.44582958e-01 -9.45494557e-02]
 [ 5.64561612e-01 -7.49815428e-01]
 [-5.13739001e-01  2.52033953e-01]
 [ 7.19412952e-02  1.38340072e-01]
 [-6.71216591e-02 -3.49559581e-02]
 [ 8.93045521e-02  1.93436081e-02]
 [ 2.33919199e-01  3.47579648e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-9.53054602e-02  1.19377736e-01]
 [-2.73905366e-01 -1.53367042e-01]
 [ 1.98037171e-01  1.41271788e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.26402173e-02  6.77573810e-02]
 [ 4.07358932e-01 -2.38407634e-01]
 [ 1.73790257e-01  6.48798088e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.51097422]
curr_Stock_Price:  97.22408208011619
curr_Factors:  [9.72240821e+01 4.00149211e-02]
mat_Sqrt:  [[ 1.94484428e+01  0.00000000e+00]
 [-8.00149197e-03  1.83337213e-02]]
grads:  [ 0.00162427 -0.07815115]
Stock Position:  0.001624269432855379
Bond Position:  [-16.66889233]


portfolio before change:  [-16.51262338]
curr_Stock_Price:  98.77468098416986
curr_Factors:  [9.87746810e+01 4.09846647e-02]
mat_Sqrt:  [[ 1.99966078e+01  0.00000000e+00]
 [-8.09786783e-03  1.85545462e-02]]
grads:  [-0.00931782 -3.59221776]
Stock Position:  -0.009317823906535424
Bond Position:  [-15.59225829]


portfolio before change:  [-16.53258225]
curr_Stock_Price:  100.49829371460885
curr_Factors:  [1.00498294e+02 3.98294119e-02]
mat_Sqrt:  [[ 2.00567534e+01  0.00000000e+00]
 [-7.98292296e-03  1.82911744e-02]]
grads:  [-2.11082285e-02 -3.22874082e+01]
Stock Position:  -0.021108228467534563
Bond Position:  [-14.4112413]


portfolio before change:  [-16.55393271]
curr_Stock_Price:  101.33906525560165
curr_Factors:  [1.01339065e+02 3.86191269e-02]
mat_Sqrt:  [[ 1.99148995e+01  0.00000000e+00]
 [-7.86069990e-03  1.80111262e-02]]
grads:  [0.00865673 0.63485509]
Stock Position:  0.008656734324761413
Bond Position:  [-17.43119807]


portfolio before change:  [-16.55833302]
curr_Stock_Price:  101.3342170850147
curr_Factors:  [1.01334217e+02 3.89836761e-02]
mat_Sqrt:  [[ 2.00077159e+01  0.00000000e+00]
 [-7.89771371e-03  1.80959354e-02]]
grads:  [-0.01428687 -5.22490014]
Stock Position:  -0.014286874379711994
Bond Position:  [-15.11058379]


portfolio before change:  [-16.58268935]
curr_Stock_Price:  102.77457485533175
curr_Factors:  [1.02774575e+02 3.88647243e-02]
mat_Sqrt:  [[ 2.02611217e+01  0.00000000e+00]
 [-7.88565526e-03  1.80683061e-02]]
grads:  [ 1.17128427e-02 -4.14989333e+01]
Stock Position:  0.01171284266046473
Bond Position:  [-17.78647177]


portfolio before change:  [-16.61467656]
curr_Stock_Price:  100.42330647228393
curr_Factors:  [1.00423306e+02 3.93348949e-02]
mat_Sqrt:  [[ 1.99169812e+01  0.00000000e+00]
 [-7.93321069e-03  1.81772692e-02]]
grads:  [-0.02027126 13.86533643]
Stock Position:  -0.020271263110810143
Bond Position:  [-14.57896929]


portfolio before change:  [-16.60561401]
curr_Stock_Price:  99.79642154660854
curr_Factors:  [9.97964215e+01 4.03054420e-02]
mat_Sqrt:  [[ 2.00353444e+01  0.00000000e+00]
 [-8.03048611e-03  1.84001552e-02]]
grads:  [6.60422150e-03 7.51841874e+00]
Stock Position:  0.0066042215008531345
Bond Position:  [-17.26469168]


portfolio before change:  [-16.59078014]
curr_Stock_Price:  102.69617023880579
curr_Factors:  [1.02696170e+02 3.81263981e-02]
mat_Sqrt:  [[ 2.00524359e+01  0.00000000e+00]
 [-7.81039288e-03  1.78958583e-02]]
grads:  [-0.00410811 -1.95329878]
Stock Position:  -0.004108113862026975
Bond Position:  [-16.16889258]


portfolio before change:  [-16.60290841]
curr_Stock_Price:  104.66436007932205
curr_Factors:  [1.04664360e+02 3.75567437e-02]
mat_Sqrt:  [[ 2.02834949e+01  0.00000000e+00]
 [-7.75182494e-03  1.77616623e-02]]
grads:  [0.00481903 1.08906519]
Stock Position:  0.004819031196195077
Bond Position:  [-17.10728923]


portfolio before change:  [-16.60562536]
curr_Stock_Price:  104.98816076603138
curr_Factors:  [1.04988161e+02 3.97755540e-02]
mat_Sqrt:  [[ 2.09386388e+01  0.00000000e+00]
 [-7.97752382e-03  1.82788034e-02]]
grads:  [1.84164499e-02 1.90154487e+01]
Stock Position:  0.01841644994952504
Bond Position:  [-18.53913457]


portfolio before change:  [-16.58994]
curr_Stock_Price:  106.09156141973402
curr_Factors:  [1.06091561e+02 3.97479939e-02]
mat_Sqrt:  [[ 2.11513674e+01  0.00000000e+00]
 [-7.97475958e-03  1.82724697e-02]]
grads:  [-0.00893597  6.25712483]
Stock Position:  -0.0089359690312279
Bond Position:  [-15.6419091]


portfolio before change:  [-16.5999577]
curr_Stock_Price:  106.77494840951569
curr_Factors:  [1.06774948e+02 3.87911648e-02]
mat_Sqrt:  [[ 2.10298309e+01  0.00000000e+00]
 [-7.87818911e-03  1.80511990e-02]]
grads:  [-2.05445041e-03  6.61328572e+00]
Stock Position:  -0.002054450408391403
Bond Position:  [-16.38059386]


portfolio before change:  [-16.60228921]
curr_Stock_Price:  105.91625516140581
curr_Factors:  [1.05916255e+02 4.09629550e-02]
mat_Sqrt:  [[ 2.14367161e+01  0.00000000e+00]
 [-8.09572282e-03  1.85496313e-02]]
grads:  [-0.01589983 -8.26792941]
Stock Position:  -0.015899834160468362
Bond Position:  [-14.91823832]


portfolio before change:  [-16.60142177]
curr_Stock_Price:  105.62710320195924
curr_Factors:  [1.05627103e+02 4.26691545e-02]
mat_Sqrt:  [[ 2.18188767e+01  0.00000000e+00]
 [-8.26260535e-03  1.89320072e-02]]
grads:  [0.01190223 7.46206077]
Stock Position:  0.011902227498162827
Bond Position:  [-17.85861958]


portfolio before change:  [-16.62268612]
curr_Stock_Price:  104.2156757095683
curr_Factors:  [1.04215676e+02 4.34973871e-02]
mat_Sqrt:  [[ 2.17352497e+01  0.00000000e+00]
 [-8.34241089e-03  1.91148647e-02]]
grads:  [0.0044166  0.91714255]
Stock Position:  0.0044166012167903244
Bond Position:  [-17.0829652]


portfolio before change:  [-16.62939276]
curr_Stock_Price:  103.66426196365413
curr_Factors:  [1.03664262e+02 4.24222279e-02]
mat_Sqrt:  [[ 2.13513725e+01  0.00000000e+00]
 [-8.23866279e-03  1.88771479e-02]]
grads:  [-1.08042103e-03  3.58938655e+00]
Stock Position:  -0.0010804210313927378
Bond Position:  [-16.51739172]


portfolio before change:  [-16.6312925]
curr_Stock_Price:  101.60013289436354
curr_Factors:  [1.01600133e+02 4.44293216e-02]
mat_Sqrt:  [[ 2.14155443e+01  0.00000000e+00]
 [-8.43130562e-03  1.93185481e-02]]
grads:  [  0.01416304 -12.34086705]
Stock Position:  0.014163044675832301
Bond Position:  [-18.07025972]


portfolio before change:  [-16.62045459]
curr_Stock_Price:  102.68436569632028
curr_Factors:  [1.02684366e+02 4.55163077e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.62045459]
Stock Price:  100.64926491465908
PL:  [-17.26971951]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.55432214e-01 -1.45183938e+00]
 [-9.47596914e-03  2.78637782e-01]
 [-4.46244404e-01 -2.29584304e-02]
 [ 4.19618426e-01 -2.69634897e-01]
 [-1.96389773e-01  5.05792918e-02]
 [-9.30524481e-02  1.46092476e-02]
 [-2.35882722e-01  1.12098006e-01]
 [ 2.00910517e-01  8.17846305e-03]
 [-9.39185008e-02 -1.59018046e-02]
 [-2.36080497e-01  5.92356358e-02]
 [-7.79914386e-02  3.38683147e-02]
 [-1.68489525e-01 -2.52069898e-01]
 [-9.15053397e-02 -1.20906252e-01]
 [ 8.81111595e-02  7.06675178e-02]
 [-2.40585996e-02 -4.34793144e-02]
 [ 4.88962908e-01 -2.62151668e-01]
 [ 1.68711373e-01  1.46179627e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.8924971]
curr_Stock_Price:  99.05569554959833
curr_Factors:  [9.90556955e+01 4.06090759e-02]
mat_Sqrt:  [[ 1.99614004e+01  0.00000000e+00]
 [-8.06067748e-03  1.84693323e-02]]
grads:  [ 0.00139627 -0.07313931]
Stock Position:  0.0013962736642135797
Bond Position:  [-4.03080596]


portfolio before change:  [-3.89574076]
curr_Stock_Price:  97.45441151539673
curr_Factors:  [9.74544115e+01 4.07371975e-02]
mat_Sqrt:  [[ 1.96696702e+01  0.00000000e+00]
 [-8.07338318e-03  1.84984448e-02]]
grads:  [-0.0094727 -3.6031121]
Stock Position:  -0.00947269927003742
Bond Position:  [-2.97258443]


portfolio before change:  [-3.87296649]
curr_Stock_Price:  94.97175018041632
curr_Factors:  [9.49717502e+01 4.34591843e-02]
mat_Sqrt:  [[ 1.97986340e+01  0.00000000e+00]
 [-8.33874660e-03  1.91064688e-02]]
grads:  [-3.98546115e-02 -7.59867978e+01]
Stock Position:  -0.039854611538991044
Bond Position:  [-0.08790428]


portfolio before change:  [-3.88889424]
curr_Stock_Price:  95.37084484602222
curr_Factors:  [9.53708448e+01 4.41802339e-02]
mat_Sqrt:  [[ 2.00460881e+01  0.00000000e+00]
 [-8.40763785e-03  1.92643184e-02]]
grads:  [5.59368632e-03 1.44639315e+01]
Stock Position:  0.00559368632148393
Bond Position:  [-4.42236883]


portfolio before change:  [-3.89577898]
curr_Stock_Price:  94.33771268610127
curr_Factors:  [9.43377127e+01 4.27068671e-02]
mat_Sqrt:  [[ 1.94954920e+01  0.00000000e+00]
 [-8.26625594e-03  1.89403718e-02]]
grads:  [-0.02340358 -1.21214254]
Stock Position:  -0.023403578930029326
Bond Position:  [-1.68793888]


portfolio before change:  [-3.86887164]
curr_Stock_Price:  93.16996890910575
curr_Factors:  [9.31699689e+01 4.55451349e-02]
mat_Sqrt:  [[ 1.98836883e+01  0.00000000e+00]
 [-8.53652247e-03  1.95596302e-02]]
grads:  [  0.01518532 -13.7852758 ]
Stock Position:  0.015185316941650703
Bond Position:  [-5.28368715]


portfolio before change:  [-3.86460092]
curr_Stock_Price:  93.53820635506972
curr_Factors:  [9.35382064e+01 4.82892733e-02]
mat_Sqrt:  [[ 2.05548529e+01  0.00000000e+00]
 [-8.78992818e-03  2.01402556e-02]]
grads:  [-0.00848049  2.51135302]
Stock Position:  -0.008480486896627316
Bond Position:  [-3.07135139]


portfolio before change:  [-3.87054513]
curr_Stock_Price:  94.1485804658995
curr_Factors:  [9.41485805e+01 4.80836944e-02]
mat_Sqrt:  [[ 2.06448956e+01  0.00000000e+00]
 [-8.77119781e-03  2.00973390e-02]]
grads:  [-0.00419844  0.72692448]
Stock Position:  -0.004198444572393614
Bond Position:  [-3.47526753]


portfolio before change:  [-3.87065321]
curr_Stock_Price:  93.96736086344332
curr_Factors:  [9.39673609e+01 5.16072749e-02]
mat_Sqrt:  [[ 2.13467858e+01  0.00000000e+00]
 [-9.08689385e-03  2.08206894e-02]]
grads:  [-0.00875819  5.38397187]
Stock Position:  -0.00875818695976931
Bond Position:  [-3.0476695]


portfolio before change:  [-3.89700797]
curr_Stock_Price:  96.88951200794313
curr_Factors:  [9.68895120e+01 5.18122871e-02]
mat_Sqrt:  [[ 2.20542935e+01  0.00000000e+00]
 [-9.10492500e-03  2.08620040e-02]]
grads:  [0.00927166 0.39202672]
Stock Position:  0.009271659110933875
Bond Position:  [-4.7953345]


portfolio before change:  [-3.89694314]
curr_Stock_Price:  97.02582178614057
curr_Factors:  [9.70258218e+01 5.38900654e-02]
mat_Sqrt:  [[ 2.25238012e+01  0.00000000e+00]
 [-9.28569355e-03  2.12761968e-02]]
grads:  [-0.00447787 -0.74739883]
Stock Position:  -0.004477868390553339
Bond Position:  [-3.46247428]


portfolio before change:  [-3.9055909]
curr_Stock_Price:  98.76371048436576
curr_Factors:  [9.87637105e+01 5.06404047e-02]
mat_Sqrt:  [[ 2.22252156e+01  0.00000000e+00]
 [-9.00136921e-03  2.06247279e-02]]
grads:  [-0.00945898  2.87206872]
Stock Position:  -0.00945898346805103
Bond Position:  [-2.97138659]


portfolio before change:  [-3.90418223]
curr_Stock_Price:  98.53624366432894
curr_Factors:  [9.85362437e+01 5.12703970e-02]
mat_Sqrt:  [[ 2.23115295e+01  0.00000000e+00]
 [-9.05718693e-03  2.07526224e-02]]
grads:  [-0.00283307  1.63200169]
Stock Position:  -0.00283306862956158
Bond Position:  [-3.62502229]


portfolio before change:  [-3.90554718]
curr_Stock_Price:  98.69811076375065
curr_Factors:  [9.86981108e+01 5.05419792e-02]
mat_Sqrt:  [[ 2.21888586e+01  0.00000000e+00]
 [-8.99261735e-03  2.06046748e-02]]
grads:  [ -0.01255143 -12.2336266 ]
Stock Position:  -0.012551427408322428
Bond Position:  [-2.66674501]


portfolio before change:  [-3.91266214]
curr_Stock_Price:  99.21185178479008
curr_Factors:  [9.92118518e+01 4.98862396e-02]
mat_Sqrt:  [[ 2.21591930e+01  0.00000000e+00]
 [-8.93409108e-03  2.04705743e-02]]
grads:  [-0.00651076 -5.90634391]
Stock Position:  -0.0065107584963508625
Bond Position:  [-3.26671773]


portfolio before change:  [-3.90701743]
curr_Stock_Price:  98.2194200262983
curr_Factors:  [9.8219420e+01 5.2624838e-02]
mat_Sqrt:  [[ 2.25316373e+01  0.00000000e+00]
 [-9.17604168e-03  2.10249528e-02]]
grads:  [0.00527938 3.36112611]
Stock Position:  0.0052793763419157445
Bond Position:  [-4.42555472]


portfolio before change:  [-3.89862765]
curr_Stock_Price:  100.01817544413557
curr_Factors:  [1.00018175e+02 4.91950635e-02]
mat_Sqrt:  [[ 2.21839915e+01  0.00000000e+00]
 [-8.87198408e-03  2.03282693e-02]]
grads:  [-1.93989112e-03 -2.13885962e+00]
Stock Position:  -0.0019398911167372687
Bond Position:  [-3.70460328]


portfolio before change:  [-3.90006508]
curr_Stock_Price:  100.28167628738431
curr_Factors:  [1.00281676e+02 4.63922888e-02]
mat_Sqrt:  [[ 2.15995391e+01  0.00000000e+00]
 [-8.61554769e-03  1.97406997e-02]]
grads:  [  0.01734067 -13.2797556 ]
Stock Position:  0.01734067279214499
Bond Position:  [-5.63901682]


portfolio before change:  [-3.96256698]
curr_Stock_Price:  96.75863147256041
curr_Factors:  [9.67586315e+01 4.67205513e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.96256698]
Stock Price:  95.60421437592127
PL:  [-3.96256698]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.30172970e-02  2.80649732e-01]
 [-5.71902690e-02 -3.82505778e-02]
 [-1.41796791e-01 -4.28068809e-01]
 [ 2.48094422e-01 -1.20970592e-01]
 [-1.61041745e-01 -8.27492417e-02]
 [ 5.68908136e-01 -7.56540589e-01]
 [-5.74598943e-01  4.17487906e-01]
 [ 3.36406830e-01  1.59113608e-01]
 [ 1.18192542e-01 -1.17390729e-01]
 [ 6.88929585e-02  2.04506106e-02]
 [ 2.02524744e-01  2.97458957e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-8.01188306e-02  1.08158525e-01]
 [-2.89400279e-01 -2.06439447e-01]
 [ 1.75773901e-01  7.26142925e-02]
 [ 9.57016569e-02  4.97248420e-02]
 [-3.48966573e-02 -3.81243446e-02]
 [ 4.34391586e-01 -2.46265249e-01]
 [ 2.21503171e-01  1.23456064e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.51770076]
curr_Stock_Price:  101.72799634044868
curr_Factors:  [1.01727996e+02 3.90750461e-02]
mat_Sqrt:  [[ 2.01089892e+01  0.00000000e+00]
 [-7.90696362e-03  1.81171297e-02]]
grads:  [7.73300342e-03 1.54908497e+01]
Stock Position:  0.007733003415129634
Bond Position:  [13.73103782]


portfolio before change:  [14.52111902]
curr_Stock_Price:  101.72606578098465
curr_Factors:  [1.01726066e+02 3.81601766e-02]
mat_Sqrt:  [[ 1.98718105e+01  0.00000000e+00]
 [-7.81385197e-03  1.79037841e-02]]
grads:  [-0.00371804 -2.13645214]
Stock Position:  -0.0037180401753299087
Bond Position:  [14.89934062]


portfolio before change:  [14.5243975]
curr_Stock_Price:  101.84624232425983
curr_Factors:  [1.01846242e+02 4.01122966e-02]
mat_Sqrt:  [[ 2.03978209e+01  0.00000000e+00]
 [-8.01122179e-03  1.83560151e-02]]
grads:  [-1.61106099e-02 -2.33203561e+01]
Stock Position:  -0.01611060990992636
Bond Position:  [16.16520258]


portfolio before change:  [14.51228127]
curr_Stock_Price:  102.8491862607064
curr_Factors:  [1.02849186e+02 3.87868746e-02]
mat_Sqrt:  [[ 2.02555133e+01  0.00000000e+00]
 [-7.87775344e-03  1.80502007e-02]]
grads:  [ 0.00964175 -6.70189734]
Stock Position:  0.009641746661753115
Bond Position:  [13.52063547]


portfolio before change:  [14.51292416]
curr_Stock_Price:  102.5652453022731
curr_Factors:  [1.02565245e+02 3.99424673e-02]
mat_Sqrt:  [[ 2.04982916e+01  0.00000000e+00]
 [-7.99424466e-03  1.83171156e-02]]
grads:  [-0.00961819 -4.51759127]
Stock Position:  -0.009618190556608248
Bond Position:  [15.49941624]


portfolio before change:  [14.51431144]
curr_Stock_Price:  102.82392869790371
curr_Factors:  [1.02823929e+02 3.88509980e-02]
mat_Sqrt:  [[ 2.02672714e+01  0.00000000e+00]
 [-7.88426260e-03  1.80651151e-02]]
grads:  [ 1.17789291e-02 -4.18785369e+01]
Stock Position:  0.011778929137240822
Bond Position:  [13.30315567]


portfolio before change:  [14.51931209]
curr_Stock_Price:  102.96608467267484
curr_Factors:  [1.02966085e+02 3.74394949e-02]
mat_Sqrt:  [[ 1.99232043e+01  0.00000000e+00]
 [-7.73971523e-03  1.77339154e-02]]
grads:  [-1.96952396e-02  2.35417783e+01]
Stock Position:  -0.019695239593924347
Bond Position:  [16.54725379]


portfolio before change:  [14.53377602]
curr_Stock_Price:  102.44176481730767
curr_Factors:  [1.02441765e+02 3.73731313e-02]
mat_Sqrt:  [[ 1.98041768e+01  0.00000000e+00]
 [-7.73285265e-03  1.77181913e-02]]
grads:  [0.02049314 8.98023987]
Stock Position:  0.020493136641529828
Bond Position:  [12.43442294]


portfolio before change:  [14.58540996]
curr_Stock_Price:  104.80962784671608
curr_Factors:  [1.04809628e+02 3.71043046e-02]
mat_Sqrt:  [[ 2.01889312e+01  0.00000000e+00]
 [-7.70499107e-03  1.76543524e-02]]
grads:  [ 3.31662074e-03 -6.64939307e+00]
Stock Position:  0.0033166207351625846
Bond Position:  [14.23779617]


portfolio before change:  [14.58966517]
curr_Stock_Price:  105.01927354355573
curr_Factors:  [1.05019274e+02 3.93256516e-02]
mat_Sqrt:  [[ 2.08260532e+01  0.00000000e+00]
 [-7.93227852e-03  1.81751334e-02]]
grads:  [0.00373659 1.12519728]
Stock Position:  0.003736585899692845
Bond Position:  [14.19725163]


portfolio before change:  [14.58938587]
curr_Stock_Price:  103.99452677578884
curr_Factors:  [1.03994527e+02 4.16651329e-02]
mat_Sqrt:  [[ 2.12274032e+01  0.00000000e+00]
 [-8.16481553e-03  1.87079426e-02]]
grads:  [1.56564830e-02 1.59001427e+01]
Stock Position:  0.015656482965725926
Bond Position:  [12.96119733]


portfolio before change:  [14.61426268]
curr_Stock_Price:  105.37645321184792
curr_Factors:  [1.05376453e+02 4.12364878e-02]
mat_Sqrt:  [[ 2.13985532e+01  0.00000000e+00]
 [-8.12270770e-03  1.86114615e-02]]
grads:  [-0.00883275  6.14315669]
Stock Position:  -0.008832745001665901
Bond Position:  [15.54502602]


portfolio before change:  [14.61212556]
curr_Stock_Price:  106.05844558218672
curr_Factors:  [1.06058446e+02 4.35033484e-02]
mat_Sqrt:  [[ 2.21210940e+01  0.00000000e+00]
 [-8.34298253e-03  1.91161745e-02]]
grads:  [-1.48792732e-03  5.65795869e+00]
Stock Position:  -0.0014879273232029032
Bond Position:  [14.76993282]


portfolio before change:  [14.61718805]
curr_Stock_Price:  105.13800456875308
curr_Factors:  [1.05138005e+02 4.48157673e-02]
mat_Sqrt:  [[ 2.22574368e+01  0.00000000e+00]
 [-8.46789393e-03  1.94023825e-02]]
grads:  [ -0.01705038 -10.63990193]
Stock Position:  -0.017050383835504706
Bond Position:  [16.40983139]


portfolio before change:  [14.63651696]
curr_Stock_Price:  104.24500809630655
curr_Factors:  [1.04245008e+02 4.28990786e-02]
mat_Sqrt:  [[ 2.15913228e+01  0.00000000e+00]
 [-8.28483710e-03  1.89829466e-02]]
grads:  [0.00960874 3.82523821]
Stock Position:  0.009608738624624164
Bond Position:  [13.63485392]


portfolio before change:  [14.59723545]
curr_Stock_Price:  99.8021099882641
curr_Factors:  [9.98021100e+01 4.27031001e-02]
mat_Sqrt:  [[ 2.06238350e+01  0.00000000e+00]
 [-8.26589137e-03  1.89395365e-02]]
grads:  [0.00569261 2.6254519 ]
Stock Position:  0.00569260552885869
Bond Position:  [14.02910141]


portfolio before change:  [14.60473185]
curr_Stock_Price:  100.50278840003564
curr_Factors:  [1.00502788e+02 4.10555505e-02]
mat_Sqrt:  [[ 2.03640451e+01  0.00000000e+00]
 [-8.10486772e-03  1.85705849e-02]]
grads:  [-0.00253071 -2.05294258]
Stock Position:  -0.002530709642745093
Bond Position:  [14.85907522]


portfolio before change:  [14.60673725]
curr_Stock_Price:  101.17842203839514
curr_Factors:  [1.01178422e+02 4.01045405e-02]
mat_Sqrt:  [[ 2.02621102e+01  0.00000000e+00]
 [-8.01044722e-03  1.83542404e-02]]
grads:  [  0.01613418 -13.417349  ]
Stock Position:  0.01613418426760258
Bond Position:  [12.97430594]


portfolio before change:  [14.59394149]
curr_Stock_Price:  100.18427535885039
curr_Factors:  [1.00184275e+02 3.98903000e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.59394149]
Stock Price:  101.62590861947582
PL:  [12.96803287]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-9.47481741e-02  4.21313879e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.67214721e-01 -6.01491727e-01]
 [ 1.72018397e-01  4.29409630e-03]
 [-1.11169783e-01 -7.45977146e-02]
 [ 7.01540156e-01 -9.61725503e-01]
 [-5.62645474e-01  3.97780921e-01]
 [ 3.55244358e-01  1.60593279e-01]
 [ 3.61538592e-02 -7.47407179e-02]
 [ 1.86803934e-01  1.40558259e-02]
 [ 1.37332334e-01  2.02315054e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-5.23253010e-02  8.76258939e-02]
 [-2.75877461e-01 -1.60121764e-01]
 [ 1.95319434e-01  1.32847405e-01]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.19506339e-02  6.30999598e-02]
 [ 2.58007806e-01 -1.65955787e-01]
 [ 1.47531271e-01  4.40650091e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.35662305]
curr_Stock_Price:  100.10792918945717
curr_Factors:  [1.00107929e+02 4.24754185e-02]
mat_Sqrt:  [[ 2.06318091e+01  0.00000000e+00]
 [-8.24382615e-03  1.88889787e-02]]
grads:  [-0.00370111  2.23047464]
Stock Position:  -0.003701106799194006
Bond Position:  [3.72713319]


portfolio before change:  [3.36053745]
curr_Stock_Price:  99.30208774907707
curr_Factors:  [9.93020877e+01 4.08672793e-02]
mat_Sqrt:  [[ 2.00745696e+01  0.00000000e+00]
 [-8.08626285e-03  1.85279558e-02]]
grads:  [-0.00928164 -3.59737312]
Stock Position:  -0.009281637122392923
Bond Position:  [4.2822234]


portfolio before change:  [3.35142621]
curr_Stock_Price:  100.3990854457229
curr_Factors:  [1.00399085e+02 3.82776044e-02]
mat_Sqrt:  [[ 1.96427429e+01  0.00000000e+00]
 [-7.82586526e-03  1.79313100e-02]]
grads:  [-2.18771500e-02 -3.35442156e+01]
Stock Position:  -0.021877150006139733
Bond Position:  [5.54787206]


portfolio before change:  [3.33102604]
curr_Stock_Price:  101.39497903896805
curr_Factors:  [1.01394979e+02 3.57052152e-02]
mat_Sqrt:  [[ 1.91594164e+01  0.00000000e+00]
 [-7.55832946e-03  1.73183084e-02]]
grads:  [0.00907609 0.24795125]
Stock Position:  0.009076085098897383
Bond Position:  [2.41075658]


portfolio before change:  [3.35175215]
curr_Stock_Price:  103.61216304755646
curr_Factors:  [1.03612163e+02 3.37502084e-02]
mat_Sqrt:  [[ 1.90348286e+01  0.00000000e+00]
 [-7.34849191e-03  1.68375102e-02]]
grads:  [-0.00755073 -4.43044807]
Stock Position:  -0.007550732320748763
Bond Position:  [4.13409986]


portfolio before change:  [3.34720597]
curr_Stock_Price:  104.35114206182756
curr_Factors:  [1.04351142e+02 3.20962065e-02]
mat_Sqrt:  [[ 1.86949393e+01  0.00000000e+00]
 [-7.16616567e-03  1.64197483e-02]]
grads:  [ 1.50740653e-02 -5.85712695e+01]
Stock Position:  0.015074065274468659
Bond Position:  [1.77421005]


portfolio before change:  [3.32288974]
curr_Stock_Price:  102.7085963373408
curr_Factors:  [1.02708596e+02 3.34516446e-02]
mat_Sqrt:  [[ 1.87851874e+01  0.00000000e+00]
 [-7.31591631e-03  1.67628701e-02]]
grads:  [-2.07099158e-02  2.37298815e+01]
Stock Position:  -0.020709915757644023
Bond Position:  [5.44997612]


portfolio before change:  [3.32596267]
curr_Stock_Price:  102.62601428796604
curr_Factors:  [1.02626014e+02 3.40195604e-02]
mat_Sqrt:  [[ 1.89287446e+01  0.00000000e+00]
 [-7.37775688e-03  1.69045647e-02]]
grads:  [0.02247022 9.49999496]
Stock Position:  0.022470217658485683
Bond Position:  [1.01993379]


portfolio before change:  [3.3458117]
curr_Stock_Price:  103.49801339414844
curr_Factors:  [1.03498013e+02 3.33265494e-02]
mat_Sqrt:  [[ 1.88941426e+01  0.00000000e+00]
 [-7.30222425e-03  1.67314977e-02]]
grads:  [ 1.87059859e-04 -4.46706680e+00]
Stock Position:  0.0001870598591483996
Bond Position:  [3.32645137]


portfolio before change:  [3.34654583]
curr_Stock_Price:  102.97632439983369
curr_Factors:  [1.02976324e+02 3.35987102e-02]
mat_Sqrt:  [[ 1.88755098e+01  0.00000000e+00]
 [-7.33198039e-03  1.67996776e-02]]
grads:  [0.01022163 0.83667236]
Stock Position:  0.010221625869819074
Bond Position:  [2.29396036]


portfolio before change:  [3.33602236]
curr_Stock_Price:  101.89068202339841
curr_Factors:  [1.01890682e+02 3.41180636e-02]
mat_Sqrt:  [[ 1.88203050e+01  0.00000000e+00]
 [-7.38843027e-03  1.69290205e-02]]
grads:  [ 0.01198864 11.95078321]
Stock Position:  0.011988640078526876
Bond Position:  [2.11449164]


portfolio before change:  [3.35069209]
curr_Stock_Price:  103.07021920268184
curr_Factors:  [1.03070219e+02 3.36298856e-02]
mat_Sqrt:  [[ 1.89014836e+01  0.00000000e+00]
 [-7.33538117e-03  1.68074697e-02]]
grads:  [-0.00999964  6.80251851]
Stock Position:  -0.009999636409067331
Bond Position:  [4.38135681]


portfolio before change:  [3.33525568]
curr_Stock_Price:  104.72346855188175
curr_Factors:  [1.04723469e+02 3.29417560e-02]
mat_Sqrt:  [[ 1.90071670e+01  0.00000000e+00]
 [-7.25994556e-03  1.66346250e-02]]
grads:  [-7.40890297e-04  5.26768074e+00]
Stock Position:  -0.0007408902967976657
Bond Position:  [3.41284428]


portfolio before change:  [3.33529728]
curr_Stock_Price:  105.81906436267933
curr_Factors:  [1.05819064e+02 3.05860940e-02]
mat_Sqrt:  [[ 1.85065697e+01  0.00000000e+00]
 [-6.99555219e-03  1.60288237e-02]]
grads:  [-0.01868311 -9.98961414]
Stock Position:  -0.018683112762959232
Bond Position:  [5.31232679]


portfolio before change:  [3.34329348]
curr_Stock_Price:  105.46216711098145
curr_Factors:  [1.05462167e+02 3.03014090e-02]
mat_Sqrt:  [[ 1.83581157e+01  0.00000000e+00]
 [-6.96291996e-03  1.59540539e-02]]
grads:  [0.01379765 8.32687453]
Stock Position:  0.013797646715327275
Bond Position:  [1.88816375]


portfolio before change:  [3.31051777]
curr_Stock_Price:  103.05249482241504
curr_Factors:  [1.03052495e+02 3.16784863e-02]
mat_Sqrt:  [[ 1.83417479e+01  0.00000000e+00]
 [-7.11938045e-03  1.63125499e-02]]
grads:  [0.00523374 1.07469745]
Stock Position:  0.005233739475606485
Bond Position:  [2.77116786]


portfolio before change:  [3.31378286]
curr_Stock_Price:  103.54396128390445
curr_Factors:  [1.03543961e+02 3.09060353e-02]
mat_Sqrt:  [[ 1.82031448e+01  0.00000000e+00]
 [-7.03204497e-03  1.61124392e-02]]
grads:  [-1.34106244e-03  3.91622640e+00]
Stock Position:  -0.0013410624371939476
Bond Position:  [3.45264177]


portfolio before change:  [3.31376878]
curr_Stock_Price:  104.19817593678586
curr_Factors:  [1.04198176e+02 3.03327416e-02]
mat_Sqrt:  [[ 1.81474642e+01  0.00000000e+00]
 [-6.96651897e-03  1.59623003e-02]]
grads:  [ 1.02261539e-02 -1.03967338e+01]
Stock Position:  0.010226153911646883
Bond Position:  [2.2482222]


portfolio before change:  [3.30641112]
curr_Stock_Price:  103.42371238505926
curr_Factors:  [1.03423712e+02 3.24062366e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.30641112]
Stock Price:  102.70509102031284
PL:  [0.6013201]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-1.08347710e-01  6.81150106e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-2.18329745e-01 -9.96881610e-01]
 [-3.48043256e-02  2.75983553e-01]
 [-4.12989567e-01 -6.85676956e-02]
 [-4.05100031e-02  1.10676532e-01]
 [-2.60216124e-01  8.55767945e-02]
 [-9.24325019e-02  2.13874778e-02]
 [-2.39892239e-01  1.30291766e-01]
 [ 5.40830161e-02  1.73789849e-02]
 [-1.02197183e-01 -3.83808064e-02]
 [-2.85226434e-02 -3.44920195e-02]
 [ 5.04141814e-01 -8.05389024e-02]
 [ 2.49074188e-01  2.30068261e-01]
 [-3.31439121e-01 -8.70253302e-02]
 [ 7.13494063e-02  1.40355592e-01]
 [-6.27436133e-02 -6.80618558e-03]
 [ 1.64610255e+00 -7.30481905e-01]
 [ 4.08492528e-01  3.35176866e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.39846287]
curr_Stock_Price:  100.25915566691559
curr_Factors:  [1.00259156e+02 4.01622008e-02]
mat_Sqrt:  [[ 2.00924453e+01  0.00000000e+00]
 [-8.01620367e-03  1.83674300e-02]]
grads:  [-0.00391291  3.70846713]
Stock Position:  -0.003912907597277032
Bond Position:  [4.79076768]


portfolio before change:  [4.40698929]
curr_Stock_Price:  98.38623199957141
curr_Factors:  [9.83862320e+01 4.04159202e-02]
mat_Sqrt:  [[ 1.97792839e+01  0.00000000e+00]
 [-8.04148446e-03  1.84253556e-02]]
grads:  [-0.0094202  -3.61740482]
Stock Position:  -0.009420203032467373
Bond Position:  [5.33380757]


portfolio before change:  [4.4168184]
curr_Stock_Price:  97.48439378734751
curr_Factors:  [9.74843938e+01 4.02615813e-02]
mat_Sqrt:  [[ 1.95605251e+01  0.00000000e+00]
 [-8.02611550e-03  1.83901409e-02]]
grads:  [-3.34042438e-02 -5.42073938e+01]
Stock Position:  -0.03340424376062493
Bond Position:  [7.67321086]


portfolio before change:  [4.39942926]
curr_Stock_Price:  98.06239487891804
curr_Factors:  [9.80623949e+01 4.04233994e-02]
mat_Sqrt:  [[ 1.97160046e+01  0.00000000e+00]
 [-8.04222849e-03  1.84270604e-02]]
grads:  [4.34392127e-03 1.49770798e+01]
Stock Position:  0.004343921270155978
Bond Position:  [3.97345393]


portfolio before change:  [4.39794547]
curr_Stock_Price:  97.49211007902157
curr_Factors:  [9.74921101e+01 3.99352479e-02]
mat_Sqrt:  [[ 1.94826336e+01  0.00000000e+00]
 [-7.99352217e-03  1.83154602e-02]]
grads:  [-0.02273383 -3.74370585]
Stock Position:  -0.022733834269306287
Bond Position:  [6.61431495]


portfolio before change:  [4.41243905]
curr_Stock_Price:  96.92732209372838
curr_Factors:  [9.69273221e+01 3.97031895e-02]
mat_Sqrt:  [[ 1.93134079e+01  0.00000000e+00]
 [-7.97026369e-03  1.82621683e-02]]
grads:  [4.03512198e-04 6.06042669e+00]
Stock Position:  0.00040351219765756574
Bond Position:  [4.3733277]


portfolio before change:  [4.41284502]
curr_Stock_Price:  95.22352888902563
curr_Factors:  [9.52235289e+01 4.36592340e-02]
mat_Sqrt:  [[ 1.98967585e+01  0.00000000e+00]
 [-8.35791687e-03  1.91503933e-02]]
grads:  [-0.01120119  4.46867033]
Stock Position:  -0.01120118884733527
Bond Position:  [5.47946175]


portfolio before change:  [4.42580325]
curr_Stock_Price:  94.18897858042801
curr_Factors:  [9.41889786e+01 4.58908915e-02]
mat_Sqrt:  [[ 2.01773132e+01  0.00000000e+00]
 [-8.56886378e-03  1.96337334e-02]]
grads:  [-0.0041184   1.08932302]
Stock Position:  -0.004118399740357131
Bond Position:  [4.81371112]


portfolio before change:  [4.43071936]
curr_Stock_Price:  93.28752931352597
curr_Factors:  [9.32875293e+01 4.45321216e-02]
mat_Sqrt:  [[ 1.96861271e+01  0.00000000e+00]
 [-8.44105412e-03  1.93408847e-02]]
grads:  [-0.00929732  6.73659804]
Stock Position:  -0.009297321391659508
Bond Position:  [5.2980435]


portfolio before change:  [4.44136513]
curr_Stock_Price:  92.28497180070964
curr_Factors:  [9.22849718e+01 4.66296718e-02]
mat_Sqrt:  [[ 1.99279288e+01  0.00000000e+00]
 [-8.63756186e-03  1.97911405e-02]]
grads:  [0.00309454 0.87811942]
Stock Position:  0.0030945427157522544
Bond Position:  [4.15578535]


portfolio before change:  [4.445627]
curr_Stock_Price:  93.32641607384397
curr_Factors:  [9.33264161e+01 4.60955387e-02]
mat_Sqrt:  [[ 2.00370617e+01  0.00000000e+00]
 [-8.58794864e-03  1.96774624e-02]]
grads:  [-0.0059364  -1.95049574]
Stock Position:  -0.00593639634278526
Bond Position:  [4.9996496]


portfolio before change:  [4.4632654]
curr_Stock_Price:  90.56576342256417
curr_Factors:  [9.05657634e+01 4.66864672e-02]
mat_Sqrt:  [[ 1.95685911e+01  0.00000000e+00]
 [-8.64282058e-03  1.98031898e-02]]
grads:  [-0.00222684 -1.74174059]
Stock Position:  -0.0022268437510769745
Bond Position:  [4.66494121]


portfolio before change:  [4.46862698]
curr_Stock_Price:  88.68184268794167
curr_Factors:  [8.86818427e+01 4.75076530e-02]
mat_Sqrt:  [[ 1.93293165e+01  0.00000000e+00]
 [-8.71850015e-03  1.99765934e-02]]
grads:  [ 0.02426324 -4.03166349]
Stock Position:  0.02426323540506133
Bond Position:  [2.31691855]


portfolio before change:  [4.46229708]
curr_Stock_Price:  88.39708255963195
curr_Factors:  [8.83970826e+01 4.70710180e-02]
mat_Sqrt:  [[ 1.91785040e+01  0.00000000e+00]
 [-8.67834252e-03  1.98845807e-02]]
grads:  [ 0.0182227  11.57018414]
Stock Position:  0.01822270437872358
Bond Position:  [2.85146318]


portfolio before change:  [4.47344787]
curr_Stock_Price:  88.96987533818827
curr_Factors:  [8.89698753e+01 4.63904596e-02]
mat_Sqrt:  [[ 1.91627273e+01  0.00000000e+00]
 [-8.61537784e-03  1.97403105e-02]]
grads:  [-0.01927805 -4.40850867]
Stock Position:  -0.019278053822026582
Bond Position:  [6.18861391]


portfolio before change:  [4.50076194]
curr_Stock_Price:  87.63329200186058
curr_Factors:  [8.76332920e+01 4.76604833e-02]
mat_Sqrt:  [[ 1.91314703e+01  0.00000000e+00]
 [-8.73251243e-03  2.00086996e-02]]
grads:  [6.93128163e-03 7.01472833e+00]
Stock Position:  0.006931281633344802
Bond Position:  [3.89335091]


portfolio before change:  [4.5045857]
curr_Stock_Price:  88.04451429340946
curr_Factors:  [8.80445143e+01 4.78688289e-02]
mat_Sqrt:  [[ 1.92632119e+01  0.00000000e+00]
 [-8.75157850e-03  2.00523855e-02]]
grads:  [-0.00341138 -0.33942024]
Stock Position:  -0.0034113768993148767
Bond Position:  [4.80493872]


portfolio before change:  [4.50779075]
curr_Stock_Price:  87.4571653948125
curr_Factors:  [8.74571654e+01 4.80867958e-02]
mat_Sqrt:  [[ 1.91782209e+01  0.00000000e+00]
 [-8.77148067e-03  2.00979871e-02]]
grads:  [  0.06920841 -36.34602321]
Stock Position:  0.06920840663695459
Bond Position:  [-1.54498032]


portfolio before change:  [4.42280696]
curr_Stock_Price:  86.23480674179397
curr_Factors:  [8.62348067e+01 5.01912077e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.42280696]
Stock Price:  88.036471326436
PL:  [4.42280696]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.93062439e-01 -1.15106811e+00]
 [-1.23441993e-02  2.78337213e-01]
 [-4.26995176e-01 -4.77004571e-02]
 [ 4.63969258e-01 -3.22821707e-01]
 [-2.00073149e-01  5.25989739e-02]
 [-3.83926922e-02  1.53770294e-01]
 [-2.33515146e-01  1.00510595e-01]
 [ 1.07103702e-01  1.40565966e-02]
 [-9.76125797e-02 -2.32773429e-02]
 [-1.09550864e-01  5.40852583e-03]
 [ 2.32713143e-01 -3.35283943e-02]
 [ 8.90731563e-02 -5.86366326e-03]
 [-2.87833208e-01 -1.05475045e-01]
 [ 8.74027865e-02  1.32585849e-02]
 [ 2.80828087e-02 -5.79801926e-02]
 [ 1.20712716e+00 -5.48049419e-01]
 [ 1.88895288e-01  2.22384572e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.9252838]
curr_Stock_Price:  98.90578316216727
curr_Factors:  [9.89057832e+01 3.86506695e-02]
mat_Sqrt:  [[ 1.94446530e+01  0.00000000e+00]
 [-7.86390941e-03  1.80184801e-02]]
grads:  [ 0.00143338 -0.07496938]
Stock Position:  0.0014333800488522909
Bond Position:  [-5.06705338]


portfolio before change:  [-4.92758153]
curr_Stock_Price:  98.18664007528706
curr_Factors:  [9.81866401e+01 3.87701562e-02]
mat_Sqrt:  [[ 1.93330856e+01  0.00000000e+00]
 [-7.87605548e-03  1.80463102e-02]]
grads:  [-0.00963762 -3.69338493]
Stock Position:  -0.009637616777557428
Bond Position:  [-3.98129632]


portfolio before change:  [-4.91355225]
curr_Stock_Price:  96.62767308163538
curr_Factors:  [9.66276731e+01 3.71939918e-02]
mat_Sqrt:  [[ 1.86353656e+01  0.00000000e+00]
 [-7.71429756e-03  1.76756762e-02]]
grads:  [-3.73177412e-02 -6.51215884e+01]
Stock Position:  -0.03731774120867034
Bond Position:  [-1.30762575]


portfolio before change:  [-4.87856149]
curr_Stock_Price:  95.68126789455326
curr_Factors:  [9.56812679e+01 3.91759903e-02]
mat_Sqrt:  [[ 1.89381222e+01  0.00000000e+00]
 [-7.91717023e-03  1.81405159e-02]]
grads:  [5.76256286e-03 1.53434011e+01]
Stock Position:  0.00576256286021581
Bond Position:  [-5.42993082]


portfolio before change:  [-4.87765346]
curr_Stock_Price:  96.07444119147725
curr_Factors:  [9.60744412e+01 3.88845368e-02]
mat_Sqrt:  [[ 1.89450751e+01  0.00000000e+00]
 [-7.88766499e-03  1.80729109e-02]]
grads:  [-0.02363746 -2.63933449]
Stock Position:  -0.023637455054287295
Bond Position:  [-2.60669818]


portfolio before change:  [-4.80022106]
curr_Stock_Price:  92.77103304759304
curr_Factors:  [9.27710330e+01 4.11747771e-02]
mat_Sqrt:  [[ 1.88246981e+01  0.00000000e+00]
 [-8.11662758e-03  1.85975301e-02]]
grads:  [ 1.71624698e-02 -1.73583108e+01]
Stock Position:  0.01716246983284923
Bond Position:  [-6.39240111]


portfolio before change:  [-4.78252083]
curr_Stock_Price:  93.89549371268461
curr_Factors:  [9.38954937e+01 3.99220190e-02]
mat_Sqrt:  [[ 1.87607846e+01  0.00000000e+00]
 [-7.99219809e-03  1.83124264e-02]]
grads:  [-0.00944081  2.87231046]
Stock Position:  -0.009440813787688133
Bond Position:  [-3.89607096]


portfolio before change:  [-4.79766284]
curr_Stock_Price:  95.39619724610274
curr_Factors:  [9.53961972e+01 3.94549343e-02]
mat_Sqrt:  [[ 1.89488006e+01  0.00000000e+00]
 [-7.94530646e-03  1.82049841e-02]]
grads:  [1.51556643e-03 8.44660410e+00]
Stock Position:  0.001515566426848457
Bond Position:  [-4.94224211]


portfolio before change:  [-4.79994093]
curr_Stock_Price:  94.70841439866207
curr_Factors:  [9.47084144e+01 3.90015659e-02]
mat_Sqrt:  [[ 1.87037887e+01  0.00000000e+00]
 [-7.89952565e-03  1.81000871e-02]]
grads:  [-0.01013959  5.55304484]
Stock Position:  -0.010139588748108582
Bond Position:  [-3.83963656]


portfolio before change:  [-4.79128915]
curr_Stock_Price:  93.76046576135991
curr_Factors:  [9.37604658e+01 4.05684984e-02]
mat_Sqrt:  [[ 1.88848797e+01  0.00000000e+00]
 [-8.05664927e-03  1.84601026e-02]]
grads:  [0.00599625 0.76145821]
Stock Position:  0.005996252303062111
Bond Position:  [-5.35350056]


portfolio before change:  [-4.80158531]
curr_Stock_Price:  92.26659703696286
curr_Factors:  [9.22665970e+01 4.45025115e-02]
mat_Sqrt:  [[ 1.94642092e+01  0.00000000e+00]
 [-8.43824735e-03  1.93344536e-02]]
grads:  [-0.00553691 -1.20393073]
Stock Position:  -0.005536913618061514
Bond Position:  [-4.29071313]


portfolio before change:  [-4.80958883]
curr_Stock_Price:  93.51832601351316
curr_Factors:  [9.35183260e+01 4.53695227e-02]
mat_Sqrt:  [[ 1.99195182e+01  0.00000000e+00]
 [-8.52004908e-03  1.95218849e-02]]
grads:  [-0.00538117  0.27704937]
Stock Position:  -0.005381173801823319
Bond Position:  [-4.30635047]


portfolio before change:  [-4.80367572]
curr_Stock_Price:  92.21938332382165
curr_Factors:  [9.22193833e+01 4.54996792e-02]
mat_Sqrt:  [[ 1.96709974e+01  0.00000000e+00]
 [-8.53226152e-03  1.95498671e-02]]
grads:  [ 0.01108638 -1.71501904]
Stock Position:  0.011086380015418297
Bond Position:  [-5.82605485]


portfolio before change:  [-4.8030031]
curr_Stock_Price:  92.41144956956256
curr_Factors:  [9.24114496e+01 4.49739228e-02]
mat_Sqrt:  [[ 1.95977479e+01  0.00000000e+00]
 [-8.48282244e-03  1.94365880e-02]]
grads:  [ 0.00441449 -0.30168172]
Stock Position:  0.004414489059225097
Bond Position:  [-5.21095243]


portfolio before change:  [-4.80802216]
curr_Stock_Price:  91.56963832487266
curr_Factors:  [9.15696383e+01 4.83412842e-02]
mat_Sqrt:  [[ 2.01330972e+01  0.00000000e+00]
 [-8.79466058e-03  2.01510989e-02]]
grads:  [-0.01658296 -5.23420808]
Stock Position:  -0.016582957318519262
Bond Position:  [-3.28952676]


portfolio before change:  [-4.83281582]
curr_Stock_Price:  93.0151688369889
curr_Factors:  [9.30151688e+01 4.65508013e-02]
mat_Sqrt:  [[ 2.00686131e+01  0.00000000e+00]
 [-8.63025388e-03  1.97743958e-02]]
grads:  [0.00464354 0.67049254]
Stock Position:  0.004643535012908443
Bond Position:  [-5.26473501]


portfolio before change:  [-4.83849776]
curr_Stock_Price:  92.07502471744066
curr_Factors:  [9.20750247e+01 4.57256990e-02]
mat_Sqrt:  [[ 1.96889257e+01  0.00000000e+00]
 [-8.55342729e-03  1.95983640e-02]]
grads:  [ 1.41103589e-04 -2.95842003e+00]
Stock Position:  0.0001411035887627471
Bond Position:  [-4.85148988]


portfolio before change:  [-4.83970462]
curr_Stock_Price:  92.11869642365203
curr_Factors:  [9.21186964e+01 4.55043303e-02]
mat_Sqrt:  [[ 1.96505245e+01  0.00000000e+00]
 [-8.53269761e-03  1.95508663e-02]]
grads:  [  0.04925766 -28.03197614]
Stock Position:  0.04925765641427394
Bond Position:  [-9.37725572]


portfolio before change:  [-4.87812137]
curr_Stock_Price:  91.38638102346847
curr_Factors:  [9.13863810e+01 4.43589054e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.87812137]
Stock Price:  91.65612822838042
PL:  [-4.87812137]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 3.89193100e-02  2.89519025e-01]
 [ 3.75306759e-02 -1.83531276e-02]
 [-1.30898706e-01 -3.53712729e-01]
 [ 3.54800260e-01 -2.99651363e-01]
 [-8.63159982e-02 -5.83125739e-02]
 [ 8.71705133e-01 -1.22503653e+00]
 [-6.16108652e-01  5.61638965e-01]
 [ 5.63693476e-01  1.76966775e-01]
 [-6.67338190e-03 -5.76877381e-02]
 [ 1.09346399e-01  1.82566584e-02]
 [ 2.06117595e-01  3.03194879e-01]
 [-2.38907030e-01  1.14333124e-01]
 [-4.64968633e-02  8.33201017e-02]
 [-3.01963215e-01 -2.49469388e-01]
 [ 1.82763878e-01  9.41529435e-02]
 [ 8.83447502e-02  1.75310557e-02]
 [-5.18796402e-02 -1.67270001e-02]
 [ 2.92861861e-01 -2.05085296e-01]
 [ 8.44007234e-02 -8.96831340e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.94821861]
curr_Stock_Price:  101.79048742162986
curr_Factors:  [1.01790487e+02 4.14777400e-02]
mat_Sqrt:  [[ 2.07307367e+01  0.00000000e+00]
 [-8.14643382e-03  1.86658248e-02]]
grads:  [7.97249870e-03 1.55106473e+01]
Stock Position:  0.007972498696377131
Bond Position:  [14.13669408]


portfolio before change:  [14.95442325]
curr_Stock_Price:  102.12539291176742
curr_Factors:  [1.02125393e+02 4.02625977e-02]
mat_Sqrt:  [[ 2.04920136e+01  0.00000000e+00]
 [-8.02621682e-03  1.83903731e-02]]
grads:  [ 0.0014406  -0.99797473]
Stock Position:  0.0014405960688231682
Bond Position:  [14.80730181]


portfolio before change:  [14.9586116]
curr_Stock_Price:  102.46279619496326
curr_Factors:  [1.02462796e+02 4.02040271e-02]
mat_Sqrt:  [[ 2.05447557e+01  0.00000000e+00]
 [-8.02037676e-03  1.83769918e-02]]
grads:  [-1.3885373e-02 -1.9247586e+01]
Stock Position:  -0.013885373034958138
Bond Position:  [16.38134575]


portfolio before change:  [14.92598329]
curr_Stock_Price:  105.10760520761515
curr_Factors:  [1.05107605e+02 3.90131167e-02]
mat_Sqrt:  [[ 2.07605791e+01  0.00000000e+00]
 [-7.90069533e-03  1.81027672e-02]]
grads:  [ 1.07907242e-02 -1.65527933e+01]
Stock Position:  0.0107907241979067
Bond Position:  [13.79179611]


portfolio before change:  [14.94450722]
curr_Stock_Price:  106.50468897586286
curr_Factors:  [1.06504689e+02 3.74000856e-02]
mat_Sqrt:  [[ 2.05970502e+01  0.00000000e+00]
 [-7.73564070e-03  1.77245795e-02]]
grads:  [-0.0054263  -3.28992707]
Stock Position:  -0.005426296045695653
Bond Position:  [15.52243319]


portfolio before change:  [14.94967845]
curr_Stock_Price:  106.26693167643585
curr_Factors:  [1.06266932e+02 3.64581322e-02]
mat_Sqrt:  [[ 2.02906215e+01  0.00000000e+00]
 [-7.63760509e-03  1.74999517e-02]]
grads:  [ 1.66113867e-02 -7.00022804e+01]
Stock Position:  0.016611386706392308
Bond Position:  [13.18443736]


portfolio before change:  [14.93395732]
curr_Stock_Price:  105.12207513877888
curr_Factors:  [1.05122075e+02 3.74185811e-02]
mat_Sqrt:  [[ 2.03346913e+01  0.00000000e+00]
 [-7.73755321e-03  1.77289616e-02]]
grads:  [-1.82441576e-02  3.16791799e+01]
Stock Position:  -0.018244157605797322
Bond Position:  [16.85182103]


portfolio before change:  [14.94554444]
curr_Stock_Price:  104.7179109320993
curr_Factors:  [1.04717911e+02 3.68781395e-02]
mat_Sqrt:  [[ 2.01096944e+01  0.00000000e+00]
 [-7.68147273e-03  1.76004651e-02]]
grads:  [ 0.0318716  10.05466469]
Stock Position:  0.03187159858068616
Bond Position:  [11.60801722]


portfolio before change:  [14.90000461]
curr_Stock_Price:  103.19799352518602
curr_Factors:  [1.03197994e+02 3.76537462e-02]
mat_Sqrt:  [[ 2.00251302e+01  0.00000000e+00]
 [-7.76182929e-03  1.77845851e-02]]
grads:  [-1.59052024e-03 -3.24369321e+00]
Stock Position:  -0.0015905202378497327
Bond Position:  [15.0641431]


portfolio before change:  [14.90198782]
curr_Stock_Price:  104.31919376132329
curr_Factors:  [1.04319194e+02 3.78704442e-02]
mat_Sqrt:  [[ 2.03008593e+01  0.00000000e+00]
 [-7.78413199e-03  1.78356870e-02]]
grads:  [0.00577878 1.02360276]
Stock Position:  0.005778782862492265
Bond Position:  [14.29914985]


portfolio before change:  [14.90418719]
curr_Stock_Price:  104.08110427706691
curr_Factors:  [1.04081104e+02 3.68560284e-02]
mat_Sqrt:  [[ 1.99814113e+01  0.00000000e+00]
 [-7.67916958e-03  1.75951879e-02]]
grads:  [1.69378771e-02 1.72316931e+01]
Stock Position:  0.016937877126247246
Bond Position:  [13.14127423]


portfolio before change:  [14.90131191]
curr_Stock_Price:  103.71736308637873
curr_Factors:  [1.03717363e+02 3.72206348e-02]
mat_Sqrt:  [[ 2.00098280e+01  0.00000000e+00]
 [-7.71706004e-03  1.76820059e-02]]
grads:  [-0.00944576  6.46607204]
Stock Position:  -0.009445756571777129
Bond Position:  [15.88100088]


portfolio before change:  [14.8983375]
curr_Stock_Price:  104.45263070947524
curr_Factors:  [1.04452631e+02 3.81097083e-02]
mat_Sqrt:  [[ 2.03909376e+01  0.00000000e+00]
 [-7.80868319e-03  1.78919409e-02]]
grads:  [-4.96935940e-04  4.65685093e+00]
Stock Position:  -0.0004969359401653119
Bond Position:  [14.95024377]


portfolio before change:  [14.90213147]
curr_Stock_Price:  104.34006926981253
curr_Factors:  [1.04340069e+02 3.72923925e-02]
mat_Sqrt:  [[ 2.01493594e+01  0.00000000e+00]
 [-7.72449532e-03  1.76990423e-02]]
grads:  [ -0.02038976 -14.09507837]
Stock Position:  -0.020389758956855634
Bond Position:  [17.02960033]


portfolio before change:  [14.89944829]
curr_Stock_Price:  104.68049049595061
curr_Factors:  [1.04680490e+02 3.77525672e-02]
mat_Sqrt:  [[ 2.03394401e+01  0.00000000e+00]
 [-7.77200794e-03  1.78079074e-02]]
grads:  [0.01100599 5.28714248]
Stock Position:  0.01100598594387276
Bond Position:  [13.74733628]


portfolio before change:  [14.89952256]
curr_Stock_Price:  104.37492953334329
curr_Factors:  [1.0437493e+02 3.5457863e-02]
mat_Sqrt:  [[ 1.96540689e+01  0.00000000e+00]
 [-7.53210335e-03  1.72582169e-02]]
grads:  [0.00488428 1.01580922]
Stock Position:  0.004884277689306261
Bond Position:  [14.38972642]


portfolio before change:  [14.88941984]
curr_Stock_Price:  101.56988841347315
curr_Factors:  [1.01569888e+02 3.70615921e-02]
mat_Sqrt:  [[ 1.95536128e+01  0.00000000e+00]
 [-7.70055501e-03  1.76441881e-02]]
grads:  [-0.00302655 -0.94801756]
Stock Position:  -0.003026545636111732
Bond Position:  [15.19682574]


portfolio before change:  [14.88748632]
curr_Stock_Price:  103.46419131666593
curr_Factors:  [1.03464191e+02 3.69955581e-02]
mat_Sqrt:  [[ 1.99005399e+01  0.00000000e+00]
 [-7.69369176e-03  1.76284624e-02]]
grads:  [ 1.02185820e-02 -1.16337597e+01]
Stock Position:  0.01021858203976711
Bond Position:  [13.830229]


portfolio before change:  [14.91127773]
curr_Stock_Price:  105.45403816780889
curr_Factors:  [1.05454038e+02 3.57866173e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.91127773]
Stock Price:  103.34522376893635
PL:  [11.56605396]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [-9.45630182e-02  4.17776242e-02]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.80727941e-01 -1.23449205e+00]
 [-2.85330656e-02  2.76640736e-01]
 [-4.07104328e-01 -7.73337459e-02]
 [ 7.45749568e-02  6.70708829e-02]
 [-2.55791562e-01  8.31507023e-02]
 [-7.68515011e-02  1.39199408e-01]
 [-2.34238321e-01  1.03954143e-01]
 [ 9.99019830e-02  1.45078715e-02]
 [-9.94467627e-02 -2.93198546e-02]
 [-9.62321809e-02 -2.44414150e-03]
 [ 6.49260385e-02 -4.45414289e-03]
 [ 7.43039549e-02 -2.77898428e-02]
 [-2.56337893e-01 -1.18699035e-01]
 [ 8.78480523e-02  2.71318343e-02]
 [ 4.95780904e-02 -7.25306197e-02]
 [ 9.68629864e-01 -4.48897261e-01]
 [ 1.44205959e-01  1.84426277e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.32568946]
curr_Stock_Price:  100.10343907787266
curr_Factors:  [1.00103439e+02 3.75157963e-02]
mat_Sqrt:  [[ 1.93890300e+01  0.00000000e+00]
 [-7.74759796e-03  1.77519770e-02]]
grads:  [-0.00393675  2.35340684]
Stock Position:  -0.003936750221901547
Bond Position:  [3.7197717]


portfolio before change:  [3.33530427]
curr_Stock_Price:  97.8973692360365
curr_Factors:  [9.78973692e+01 3.92507121e-02]
mat_Sqrt:  [[ 1.93952236e+01  0.00000000e+00]
 [-7.92471699e-03  1.81578077e-02]]
grads:  [-0.00960674 -3.6707058 ]
Stock Position:  -0.00960673997513044
Bond Position:  [4.27577884]


portfolio before change:  [3.35278992]
curr_Stock_Price:  96.18850972132961
curr_Factors:  [9.61885097e+01 4.22525867e-02]
mat_Sqrt:  [[ 1.97719656e+01  0.00000000e+00]
 [-8.22217360e-03  1.88393665e-02]]
grads:  [-3.63901322e-02 -6.55272594e+01]
Stock Position:  -0.03639013219643746
Bond Position:  [6.8531025]


portfolio before change:  [3.31053756]
curr_Stock_Price:  97.39669020756065
curr_Factors:  [9.73966902e+01 4.07687096e-02]
mat_Sqrt:  [[ 1.96656218e+01  0.00000000e+00]
 [-8.07650515e-03  1.85055981e-02]]
grads:  [4.68852962e-03 1.49490297e+01]
Stock Position:  0.004688529618204802
Bond Position:  [2.85389029]


portfolio before change:  [3.31449089]
curr_Stock_Price:  98.08768921805911
curr_Factors:  [9.80876892e+01 4.03734388e-02]
mat_Sqrt:  [[ 1.97088995e+01  0.00000000e+00]
 [-8.03725712e-03  1.84156696e-02]]
grads:  [-0.02236835 -4.19934478]
Stock Position:  -0.022368349029236217
Bond Position:  [5.50855056]


portfolio before change:  [3.36900631]
curr_Stock_Price:  95.71209553659489
curr_Factors:  [9.57120955e+01 4.21190551e-02]
mat_Sqrt:  [[ 1.96429239e+01  0.00000000e+00]
 [-8.20917098e-03  1.88095737e-02]]
grads:  [0.00528674 3.56578432]
Stock Position:  0.005286742969487149
Bond Position:  [2.86300106]


portfolio before change:  [3.36716523]
curr_Stock_Price:  95.22844874466328
curr_Factors:  [9.52284487e+01 4.01876190e-02]
mat_Sqrt:  [[ 1.90903042e+01  0.00000000e+00]
 [-8.01873996e-03  1.83732414e-02]]
grads:  [-0.01149807  4.52564142]
Stock Position:  -0.011498068263534727
Bond Position:  [4.46210844]


portfolio before change:  [3.37187273]
curr_Stock_Price:  94.9160632101964
curr_Factors:  [9.49160632e+01 3.99876844e-02]
mat_Sqrt:  [[ 1.89802901e+01  0.00000000e+00]
 [-7.99876835e-03  1.83274807e-02]]
grads:  [-8.48243031e-04  7.59511961e+00]
Stock Position:  -0.0008482430313106065
Bond Position:  [3.45238462]


portfolio before change:  [3.37307137]
curr_Stock_Price:  94.5206096535244
curr_Factors:  [9.45206097e+01 4.09469035e-02]
mat_Sqrt:  [[ 1.91265679e+01  0.00000000e+00]
 [-8.09413650e-03  1.85459966e-02]]
grads:  [-0.00987469  5.60520664]
Stock Position:  -0.00987469443035854
Bond Position:  [4.30643351]


portfolio before change:  [3.38364875]
curr_Stock_Price:  93.5584899064342
curr_Factors:  [9.35584899e+01 4.06189349e-02]
mat_Sqrt:  [[ 1.88559088e+01  0.00000000e+00]
 [-8.06165590e-03  1.84715742e-02]]
grads:  [0.00563398 0.78541609]
Stock Position:  0.005633975974509529
Bond Position:  [2.85654247]


portfolio before change:  [3.37952874]
curr_Stock_Price:  92.70043960999823
curr_Factors:  [9.27004396e+01 4.15104158e-02]
mat_Sqrt:  [[ 1.88868850e+01  0.00000000e+00]
 [-8.14964203e-03  1.86731758e-02]]
grads:  [-0.00594291 -1.57015898]
Stock Position:  -0.005942906755666879
Bond Position:  [3.93043881]


portfolio before change:  [3.37841532]
curr_Stock_Price:  93.05315532429059
curr_Factors:  [9.30531553e+01 4.07086863e-02]
mat_Sqrt:  [[ 1.87747710e+01  0.00000000e+00]
 [-8.07055748e-03  1.84919703e-02]]
grads:  [-0.00518243 -0.13217312]
Stock Position:  -0.0051824276237685445
Bond Position:  [3.86065656]


portfolio before change:  [3.3723905]
curr_Stock_Price:  94.40196465466288
curr_Factors:  [9.44019647e+01 4.26316351e-02]
mat_Sqrt:  [[ 1.94915792e+01  0.00000000e+00]
 [-8.25897186e-03  1.89236819e-02]]
grads:  [ 0.00323125 -0.23537401]
Stock Position:  0.00323124618939665
Bond Position:  [3.06735451]


portfolio before change:  [3.36777502]
curr_Stock_Price:  92.73622576292624
curr_Factors:  [9.27362258e+01 4.28889718e-02]
mat_Sqrt:  [[ 1.92053504e+01  0.00000000e+00]
 [-8.28386111e-03  1.89807103e-02]]
grads:  [ 0.0032374  -1.46410974]
Stock Position:  0.0032374037446889275
Bond Position:  [3.06755042]


portfolio before change:  [3.3707635]
curr_Stock_Price:  93.42242168344177
curr_Factors:  [9.34224217e+01 4.21713282e-02]
mat_Sqrt:  [[ 1.91849098e+01  0.00000000e+00]
 [-8.21426352e-03  1.88212422e-02]]
grads:  [-0.01606171 -6.30665253]
Stock Position:  -0.016061706953338976
Bond Position:  [4.87128706]


portfolio before change:  [3.36034602]
curr_Stock_Price:  94.14684339484269
curr_Factors:  [9.41468434e+01 4.12903766e-02]
mat_Sqrt:  [[ 1.91306702e+01  0.00000000e+00]
 [-8.12801345e-03  1.86236184e-02]]
grads:  [0.00521097 1.45685085]
Stock Position:  0.005210970363889786
Bond Position:  [2.86974961]


portfolio before change:  [3.35666446]
curr_Stock_Price:  93.30264665008397
curr_Factors:  [9.33026467e+01 4.22771984e-02]
mat_Sqrt:  [[ 1.91843489e+01  0.00000000e+00]
 [-8.22456792e-03  1.88448525e-02]]
grads:  [ 9.34258074e-04 -3.84882926e+00]
Stock Position:  0.0009342580740235944
Bond Position:  [3.26949571]


portfolio before change:  [3.35874398]
curr_Stock_Price:  94.65349641361978
curr_Factors:  [9.46534964e+01 4.28922383e-02]
mat_Sqrt:  [[ 1.96031569e+01  0.00000000e+00]
 [-8.28417656e-03  1.89814331e-02]]
grads:  [  0.03941789 -23.64928185]
Stock Position:  0.03941788771503056
Bond Position:  [-0.37229691]


portfolio before change:  [3.31228939]
curr_Stock_Price:  93.47734238402123
curr_Factors:  [9.34773424e+01 4.35824508e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.31228939]
Stock Price:  93.81507314120068
PL:  [3.31228939]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.59289575e+02 -4.92723199e+01]
 [ 2.84611300e-02 -1.35083427e-03]
 [-1.57235566e-01 -6.66519702e-02]
 [-1.98579022e-01 -8.15485891e-01]
 [-9.00916211e-03  2.72193716e-01]
 [-4.72767332e-01 -1.26761120e-01]
 [-4.51681989e-02  1.19689336e-01]
 [-2.86258415e-01  9.98564009e-02]
 [-8.39280556e-02  8.42295183e-02]
 [-2.41205777e-01  1.36241012e-01]
 [ 6.42898447e-02  1.67394034e-02]
 [-8.49646573e-02  1.83898286e-02]
 [ 1.11017079e-01 -1.06376509e-01]
 [ 4.29777094e-01 -6.76438412e-02]
 [ 2.61763766e-01  2.48416038e-01]
 [-3.43411351e-01 -8.19637589e-02]
 [ 7.21279419e-02  1.34786419e-01]
 [-6.29510068e-02 -6.65734243e-03]
 [ 1.78525961e+00 -7.88423082e-01]
 [ 3.95346667e-01  3.28419208e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [159.28957494 -49.27231994]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.88926858 -2688.02542602]
init_Out:  [2.78462688]
Stock Position:  6.889268576461488
Bond position:  [-686.14223077]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.16819124]
curr_Stock_Price:  98.43506447815382
curr_Factors:  [9.84350645e+01 4.02108548e-02]
mat_Sqrt:  [[ 1.97388335e+01  0.00000000e+00]
 [-8.02105777e-03  1.83785522e-02]]
grads:  [ 0.00141202 -0.07350058]
Stock Position:  0.0014120174660790124
Bond Position:  [-8.30718327]


portfolio before change:  [-8.16985518]
curr_Stock_Price:  98.72763372508965
curr_Factors:  [9.87276337e+01 3.96911215e-02]
mat_Sqrt:  [[ 1.96691419e+01  0.00000000e+00]
 [-7.96905228e-03  1.82593927e-02]]
grads:  [-0.00947295 -3.65028407]
Stock Position:  -0.009472953693397469
Bond Position:  [-7.23461288]


portfolio before change:  [-8.17179418]
curr_Stock_Price:  98.74136992906287
curr_Factors:  [9.87413699e+01 4.14957204e-02]
mat_Sqrt:  [[ 2.01141091e+01  0.00000000e+00]
 [-8.14819935e-03  1.86698701e-02]]
grads:  [-2.75670297e-02 -4.36792482e+01]
Stock Position:  -0.027567029664610925
Bond Position:  [-5.44978791]


portfolio before change:  [-8.18473706]
curr_Stock_Price:  99.16144639199645
curr_Factors:  [9.91614464e+01 4.32428250e-02]
mat_Sqrt:  [[ 2.06205328e+01  0.00000000e+00]
 [-8.31796369e-03  1.90588491e-02]]
grads:  [5.32410660e-03 1.42817498e+01]
Stock Position:  0.005324106598642456
Bond Position:  [-8.71268317]


portfolio before change:  [-8.18772724]
curr_Stock_Price:  99.00898174214161
curr_Factors:  [9.90089817e+01 4.16155231e-02]
mat_Sqrt:  [[ 2.01977166e+01  0.00000000e+00]
 [-8.15995325e-03  1.86968017e-02]]
grads:  [-0.02614605 -6.77982907]
Stock Position:  -0.02614604570645257
Bond Position:  [-5.59903388]


portfolio before change:  [-8.12691548]
curr_Stock_Price:  96.6295895199055
curr_Factors:  [9.66295895e+01 4.34182295e-02]
mat_Sqrt:  [[ 2.01347476e+01  0.00000000e+00]
 [-8.33481656e-03  1.90974639e-02]]
grads:  [3.51060259e-04 6.26728954e+00]
Stock Position:  0.00035106025878635426
Bond Position:  [-8.16083829]


portfolio before change:  [-8.12923068]
curr_Stock_Price:  95.84701244228556
curr_Factors:  [9.58470124e+01 4.37686632e-02]
mat_Sqrt:  [[ 2.00521166e+01  0.00000000e+00]
 [-8.36838462e-03  1.91743780e-02]]
grads:  [-0.01210234  5.20780392]
Stock Position:  -0.012102338811081125
Bond Position:  [-6.96925766]


portfolio before change:  [-8.11561296]
curr_Stock_Price:  94.5778157800921
curr_Factors:  [9.45778158e+01 4.40382076e-02]
mat_Sqrt:  [[ 1.98474217e+01  0.00000000e+00]
 [-8.39411295e-03  1.92333290e-02]]
grads:  [-2.37649407e-03  4.37935203e+00]
Stock Position:  -0.002376494072717438
Bond Position:  [-7.89084934]


portfolio before change:  [-8.11400091]
curr_Stock_Price:  93.06928777671534
curr_Factors:  [9.30692878e+01 4.19931293e-02]
mat_Sqrt:  [[ 1.90719680e+01  0.00000000e+00]
 [-8.19689007e-03  1.87814346e-02]]
grads:  [-0.00952945  7.25402585]
Stock Position:  -0.009529447860381835
Bond Position:  [-7.22710199]


portfolio before change:  [-8.11101031]
curr_Stock_Price:  92.56583792525392
curr_Factors:  [9.25658379e+01 4.38911503e-02]
mat_Sqrt:  [[ 1.93927419e+01  0.00000000e+00]
 [-8.38008595e-03  1.92011891e-02]]
grads:  [0.00369187 0.87178994]
Stock Position:  0.0036918719160543506
Bond Position:  [-8.45275153]


portfolio before change:  [-8.12506284]
curr_Stock_Price:  89.33195727634413
curr_Factors:  [8.93319573e+01 4.41037506e-02]
mat_Sqrt:  [[ 1.87605087e+01  0.00000000e+00]
 [-8.40035719e-03  1.92476363e-02]]
grads:  [-0.0041011   0.95543309]
Stock Position:  -0.0041010976371930255
Bond Position:  [-7.75870376]


portfolio before change:  [-8.12329414]
curr_Stock_Price:  88.42765892934014
curr_Factors:  [8.84276589e+01 4.46101280e-02]
mat_Sqrt:  [[ 1.86769030e+01  0.00000000e+00]
 [-8.44844393e-03  1.93578169e-02]]
grads:  [ 3.45831236e-03 -5.49527406e+00]
Stock Position:  0.003458312357310968
Bond Position:  [-8.42910461]


portfolio before change:  [-8.12118663]
curr_Stock_Price:  89.64647641789597
curr_Factors:  [8.96464764e+01 4.51872501e-02]
mat_Sqrt:  [[ 1.90564141e+01  0.00000000e+00]
 [-8.50291716e-03  1.94826308e-02]]
grads:  [ 0.02100368 -3.47200756]
Stock Position:  0.02100368410678033
Bond Position:  [-10.0040929]


portfolio before change:  [-8.15900765]
curr_Stock_Price:  87.96488163208839
curr_Factors:  [8.79648816e+01 4.58512518e-02]
mat_Sqrt:  [[ 1.88358369e+01  0.00000000e+00]
 [-8.56516216e-03  1.96252520e-02]]
grads:  [ 0.01965304 12.65797954]
Stock Position:  0.01965303772235998
Bond Position:  [-9.88778479]


portfolio before change:  [-8.15573787]
curr_Stock_Price:  88.25705209242751
curr_Factors:  [8.82570521e+01 4.61449910e-02]
mat_Sqrt:  [[ 1.89588373e+01  0.00000000e+00]
 [-8.59255408e-03  1.96880147e-02]]
grads:  [-0.02000034 -4.1631297 ]
Stock Position:  -0.02000034396916105
Bond Position:  [-6.39056647]


portfolio before change:  [-8.14946808]
curr_Stock_Price:  87.86367741154153
curr_Factors:  [8.78636774e+01 4.53358459e-02]
mat_Sqrt:  [[ 1.87081239e+01  0.00000000e+00]
 [-8.51688637e-03  1.95146382e-02]]
grads:  [0.00699982 6.90693918]
Stock Position:  0.0069998231080315955
Bond Position:  [-8.76449828]


portfolio before change:  [-8.15051585]
curr_Stock_Price:  88.02705753878088
curr_Factors:  [8.80270575e+01 4.70059518e-02]
mat_Sqrt:  [[ 1.90850196e+01  0.00000000e+00]
 [-8.67234241e-03  1.98708328e-02]]
grads:  [-0.00345069 -0.33503087]
Stock Position:  -0.0034506912019108015
Bond Position:  [-7.84676165]


portfolio before change:  [-8.1453792]
curr_Stock_Price:  85.96990920797967
curr_Factors:  [8.59699092e+01 4.82584713e-02]
mat_Sqrt:  [[ 1.88857070e+01  0.00000000e+00]
 [-8.78712434e-03  2.01338312e-02]]
grads:  [  0.07630975 -39.15911851]
Stock Position:  0.0763097493342147
Bond Position:  [-14.70572142]


portfolio before change:  [-8.10569979]
curr_Stock_Price:  86.53807122224299
curr_Factors:  [8.65380712e+01 4.74856733e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.10569979]
Stock Price:  87.10935449656148
PL:  [-8.10569979]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  1.0777479283881668
FINAL STD P&L:  9.928188846342858
