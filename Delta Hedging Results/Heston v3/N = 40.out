WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 20:48:50.388573: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 20:48:50.415428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-18 20:48:50.415994: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 20:48:50.424308: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 20:48:50.431279: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 20:48:50.444545: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 20:48:50.454699: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 20:48:50.461153: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 20:48:50.472046: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 20:48:50.474289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 20:48:50.474720: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 20:48:50.481829: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399950000 Hz
2019-12-18 20:48:50.482030: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561ce25ef450 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 20:48:50.482048: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 20:48:50.483127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-18 20:48:50.483151: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 20:48:50.483164: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 20:48:50.483175: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 20:48:50.483185: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 20:48:50.483195: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 20:48:50.483205: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 20:48:50.483216: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 20:48:50.485122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 20:48:50.485152: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 20:48:50.581642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 20:48:50.581682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 20:48:50.581693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 20:48:50.584725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
2019-12-18 20:48:50.586807: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561ce2c28780 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 20:48:50.586825: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: 4.0000e-02
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 20:49:24.514019: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.3872e+02,   Y0: 2.7439e+00,  elapsed time  34
INFO   step:     1,    loss: 9.8465e+01,   Y0: 2.7489e+00,  elapsed time  49
INFO   step:     2,    loss: 9.8467e+01,   Y0: 2.7529e+00,  elapsed time  51
INFO   step:     3,    loss: 9.8458e+01,   Y0: 2.7562e+00,  elapsed time  52
INFO   step:     4,    loss: 9.8449e+01,   Y0: 2.7592e+00,  elapsed time  54
INFO   step:     5,    loss: 9.8439e+01,   Y0: 2.7629e+00,  elapsed time  56
INFO   step:     6,    loss: 9.8431e+01,   Y0: 2.7658e+00,  elapsed time  58
INFO   step:     7,    loss: 9.8425e+01,   Y0: 2.7670e+00,  elapsed time  60
INFO   step:     8,    loss: 9.8415e+01,   Y0: 2.7665e+00,  elapsed time  61
INFO   step:     9,    loss: 9.8402e+01,   Y0: 2.7666e+00,  elapsed time  63
INFO   step:    10,    loss: 9.8397e+01,   Y0: 2.7672e+00,  elapsed time  65
INFO   step:    11,    loss: 9.8390e+01,   Y0: 2.7662e+00,  elapsed time  67
INFO   step:    12,    loss: 9.8384e+01,   Y0: 2.7644e+00,  elapsed time  68
INFO   step:    13,    loss: 9.8379e+01,   Y0: 2.7634e+00,  elapsed time  70
INFO   step:    14,    loss: 9.8370e+01,   Y0: 2.7619e+00,  elapsed time  72
INFO   step:    15,    loss: 9.8362e+01,   Y0: 2.7601e+00,  elapsed time  74
INFO   step:    16,    loss: 9.8355e+01,   Y0: 2.7598e+00,  elapsed time  75
INFO   step:    17,    loss: 9.8347e+01,   Y0: 2.7599e+00,  elapsed time  77
INFO   step:    18,    loss: 9.8338e+01,   Y0: 2.7595e+00,  elapsed time  79
INFO   step:    19,    loss: 9.8327e+01,   Y0: 2.7592e+00,  elapsed time  81
INFO   step:    20,    loss: 9.8318e+01,   Y0: 2.7595e+00,  elapsed time  82
INFO   step:    21,    loss: 9.8309e+01,   Y0: 2.7604e+00,  elapsed time  84
INFO   step:    22,    loss: 9.8300e+01,   Y0: 2.7610e+00,  elapsed time  86
INFO   step:    23,    loss: 9.8292e+01,   Y0: 2.7617e+00,  elapsed time  88
INFO   step:    24,    loss: 9.8287e+01,   Y0: 2.7630e+00,  elapsed time  89
INFO   step:    25,    loss: 9.8282e+01,   Y0: 2.7639e+00,  elapsed time  91
INFO   step:    26,    loss: 9.8276e+01,   Y0: 2.7652e+00,  elapsed time  93
INFO   step:    27,    loss: 9.8271e+01,   Y0: 2.7655e+00,  elapsed time  95
INFO   step:    28,    loss: 9.8284e+01,   Y0: 2.7650e+00,  elapsed time  96
INFO   step:    29,    loss: 9.8287e+01,   Y0: 2.7637e+00,  elapsed time  98
INFO   step:    30,    loss: 9.8285e+01,   Y0: 2.7633e+00,  elapsed time 100
INFO   step:    31,    loss: 9.8283e+01,   Y0: 2.7632e+00,  elapsed time 102
INFO   step:    32,    loss: 9.8282e+01,   Y0: 2.7621e+00,  elapsed time 103
INFO   step:    33,    loss: 9.8281e+01,   Y0: 2.7615e+00,  elapsed time 105
INFO   step:    34,    loss: 9.8277e+01,   Y0: 2.7609e+00,  elapsed time 107
INFO   step:    35,    loss: 9.8272e+01,   Y0: 2.7599e+00,  elapsed time 109
INFO   step:    36,    loss: 9.8267e+01,   Y0: 2.7590e+00,  elapsed time 110
INFO   step:    37,    loss: 9.8263e+01,   Y0: 2.7584e+00,  elapsed time 112
INFO   step:    38,    loss: 9.8256e+01,   Y0: 2.7578e+00,  elapsed time 114
INFO   step:    39,    loss: 9.8247e+01,   Y0: 2.7561e+00,  elapsed time 116
INFO   step:    40,    loss: 9.8241e+01,   Y0: 2.7541e+00,  elapsed time 117
INFO   step:    41,    loss: 9.8236e+01,   Y0: 2.7535e+00,  elapsed time 119
INFO   step:    42,    loss: 9.8226e+01,   Y0: 2.7527e+00,  elapsed time 121
INFO   step:    43,    loss: 9.8215e+01,   Y0: 2.7515e+00,  elapsed time 123
INFO   step:    44,    loss: 9.8204e+01,   Y0: 2.7495e+00,  elapsed time 124
INFO   step:    45,    loss: 9.8194e+01,   Y0: 2.7482e+00,  elapsed time 126
INFO   step:    46,    loss: 9.8184e+01,   Y0: 2.7477e+00,  elapsed time 128
INFO   step:    47,    loss: 9.8172e+01,   Y0: 2.7465e+00,  elapsed time 130
INFO   step:    48,    loss: 9.8162e+01,   Y0: 2.7461e+00,  elapsed time 132
INFO   step:    49,    loss: 9.8153e+01,   Y0: 2.7460e+00,  elapsed time 133
INFO   step:    50,    loss: 9.8142e+01,   Y0: 2.7466e+00,  elapsed time 135
INFO   step:    51,    loss: 9.8136e+01,   Y0: 2.7476e+00,  elapsed time 137
INFO   step:    52,    loss: 9.8133e+01,   Y0: 2.7493e+00,  elapsed time 139
INFO   step:    53,    loss: 9.8131e+01,   Y0: 2.7507e+00,  elapsed time 140
INFO   step:    54,    loss: 9.8129e+01,   Y0: 2.7524e+00,  elapsed time 142
INFO   step:    55,    loss: 9.8129e+01,   Y0: 2.7541e+00,  elapsed time 144
INFO   step:    56,    loss: 9.8130e+01,   Y0: 2.7557e+00,  elapsed time 146
INFO   step:    57,    loss: 9.8133e+01,   Y0: 2.7568e+00,  elapsed time 147
INFO   step:    58,    loss: 9.8133e+01,   Y0: 2.7576e+00,  elapsed time 149
INFO   step:    59,    loss: 9.8129e+01,   Y0: 2.7582e+00,  elapsed time 151
INFO   step:    60,    loss: 9.8130e+01,   Y0: 2.7593e+00,  elapsed time 153
INFO   step:    61,    loss: 9.8128e+01,   Y0: 2.7594e+00,  elapsed time 155
INFO   step:    62,    loss: 9.8122e+01,   Y0: 2.7599e+00,  elapsed time 156
INFO   step:    63,    loss: 9.8115e+01,   Y0: 2.7610e+00,  elapsed time 158
INFO   step:    64,    loss: 9.8101e+01,   Y0: 2.7625e+00,  elapsed time 160
INFO   step:    65,    loss: 9.8087e+01,   Y0: 2.7646e+00,  elapsed time 162
INFO   step:    66,    loss: 9.8079e+01,   Y0: 2.7662e+00,  elapsed time 163
INFO   step:    67,    loss: 9.8069e+01,   Y0: 2.7671e+00,  elapsed time 165
INFO   step:    68,    loss: 9.8063e+01,   Y0: 2.7683e+00,  elapsed time 167
INFO   step:    69,    loss: 9.8056e+01,   Y0: 2.7698e+00,  elapsed time 169
INFO   step:    70,    loss: 9.8053e+01,   Y0: 2.7714e+00,  elapsed time 170
INFO   step:    71,    loss: 9.8049e+01,   Y0: 2.7735e+00,  elapsed time 172
INFO   step:    72,    loss: 9.8049e+01,   Y0: 2.7755e+00,  elapsed time 174
INFO   step:    73,    loss: 9.8050e+01,   Y0: 2.7775e+00,  elapsed time 176
INFO   step:    74,    loss: 9.8054e+01,   Y0: 2.7792e+00,  elapsed time 177
INFO   step:    75,    loss: 9.8050e+01,   Y0: 2.7808e+00,  elapsed time 179
INFO   step:    76,    loss: 9.8049e+01,   Y0: 2.7819e+00,  elapsed time 181
INFO   step:    77,    loss: 9.8045e+01,   Y0: 2.7830e+00,  elapsed time 183
INFO   step:    78,    loss: 9.8037e+01,   Y0: 2.7829e+00,  elapsed time 184
INFO   step:    79,    loss: 9.8024e+01,   Y0: 2.7826e+00,  elapsed time 186
INFO   step:    80,    loss: 9.8012e+01,   Y0: 2.7823e+00,  elapsed time 188
INFO   step:    81,    loss: 9.8003e+01,   Y0: 2.7823e+00,  elapsed time 190
INFO   step:    82,    loss: 9.7987e+01,   Y0: 2.7822e+00,  elapsed time 191
INFO   step:    83,    loss: 9.7967e+01,   Y0: 2.7817e+00,  elapsed time 193
INFO   step:    84,    loss: 9.7946e+01,   Y0: 2.7811e+00,  elapsed time 195
INFO   step:    85,    loss: 9.7927e+01,   Y0: 2.7805e+00,  elapsed time 197
INFO   step:    86,    loss: 9.7910e+01,   Y0: 2.7802e+00,  elapsed time 198
INFO   step:    87,    loss: 9.7892e+01,   Y0: 2.7803e+00,  elapsed time 200
INFO   step:    88,    loss: 9.7876e+01,   Y0: 2.7807e+00,  elapsed time 202
INFO   step:    89,    loss: 9.7860e+01,   Y0: 2.7813e+00,  elapsed time 204
INFO   step:    90,    loss: 9.7844e+01,   Y0: 2.7823e+00,  elapsed time 205
INFO   step:    91,    loss: 9.7828e+01,   Y0: 2.7834e+00,  elapsed time 207
INFO   step:    92,    loss: 9.7816e+01,   Y0: 2.7841e+00,  elapsed time 209
INFO   step:    93,    loss: 9.7805e+01,   Y0: 2.7842e+00,  elapsed time 211
INFO   step:    94,    loss: 9.7795e+01,   Y0: 2.7844e+00,  elapsed time 212
INFO   step:    95,    loss: 9.7786e+01,   Y0: 2.7849e+00,  elapsed time 214
INFO   step:    96,    loss: 9.7778e+01,   Y0: 2.7848e+00,  elapsed time 216
INFO   step:    97,    loss: 9.7768e+01,   Y0: 2.7845e+00,  elapsed time 218
INFO   step:    98,    loss: 9.7756e+01,   Y0: 2.7834e+00,  elapsed time 219
INFO   step:    99,    loss: 9.7745e+01,   Y0: 2.7827e+00,  elapsed time 221
INFO   step:   100,    loss: 9.7734e+01,   Y0: 2.7815e+00,  elapsed time 223
INFO   step:   101,    loss: 9.7724e+01,   Y0: 2.7799e+00,  elapsed time 225
INFO   step:   102,    loss: 9.7713e+01,   Y0: 2.7782e+00,  elapsed time 226
INFO   step:   103,    loss: 9.7702e+01,   Y0: 2.7772e+00,  elapsed time 228
INFO   step:   104,    loss: 9.7690e+01,   Y0: 2.7752e+00,  elapsed time 230
INFO   step:   105,    loss: 9.7679e+01,   Y0: 2.7737e+00,  elapsed time 232
INFO   step:   106,    loss: 9.7668e+01,   Y0: 2.7731e+00,  elapsed time 233
INFO   step:   107,    loss: 9.7657e+01,   Y0: 2.7725e+00,  elapsed time 235
INFO   step:   108,    loss: 9.7647e+01,   Y0: 2.7719e+00,  elapsed time 237
INFO   step:   109,    loss: 9.7638e+01,   Y0: 2.7718e+00,  elapsed time 239
INFO   step:   110,    loss: 9.7632e+01,   Y0: 2.7718e+00,  elapsed time 240
INFO   step:   111,    loss: 9.7629e+01,   Y0: 2.7722e+00,  elapsed time 242
INFO   step:   112,    loss: 9.7625e+01,   Y0: 2.7726e+00,  elapsed time 244
INFO   step:   113,    loss: 9.7621e+01,   Y0: 2.7725e+00,  elapsed time 246
INFO   step:   114,    loss: 9.7616e+01,   Y0: 2.7718e+00,  elapsed time 247
INFO   step:   115,    loss: 9.7611e+01,   Y0: 2.7727e+00,  elapsed time 249
INFO   step:   116,    loss: 9.7606e+01,   Y0: 2.7744e+00,  elapsed time 251
INFO   step:   117,    loss: 9.7600e+01,   Y0: 2.7752e+00,  elapsed time 253
INFO   step:   118,    loss: 9.7595e+01,   Y0: 2.7756e+00,  elapsed time 254
INFO   step:   119,    loss: 9.7590e+01,   Y0: 2.7754e+00,  elapsed time 256
INFO   step:   120,    loss: 9.7583e+01,   Y0: 2.7744e+00,  elapsed time 258
INFO   step:   121,    loss: 9.7576e+01,   Y0: 2.7733e+00,  elapsed time 260
INFO   step:   122,    loss: 9.7570e+01,   Y0: 2.7717e+00,  elapsed time 261
INFO   step:   123,    loss: 9.7564e+01,   Y0: 2.7703e+00,  elapsed time 263
INFO   step:   124,    loss: 9.7558e+01,   Y0: 2.7690e+00,  elapsed time 265
INFO   step:   125,    loss: 9.7552e+01,   Y0: 2.7691e+00,  elapsed time 267
INFO   step:   126,    loss: 9.7543e+01,   Y0: 2.7695e+00,  elapsed time 268
INFO   step:   127,    loss: 9.7538e+01,   Y0: 2.7699e+00,  elapsed time 270
INFO   step:   128,    loss: 9.7534e+01,   Y0: 2.7708e+00,  elapsed time 272
INFO   step:   129,    loss: 9.7530e+01,   Y0: 2.7707e+00,  elapsed time 274
INFO   step:   130,    loss: 9.7526e+01,   Y0: 2.7705e+00,  elapsed time 275
INFO   step:   131,    loss: 9.7521e+01,   Y0: 2.7707e+00,  elapsed time 277
INFO   step:   132,    loss: 9.7512e+01,   Y0: 2.7716e+00,  elapsed time 279
INFO   step:   133,    loss: 9.7505e+01,   Y0: 2.7729e+00,  elapsed time 281
INFO   step:   134,    loss: 9.7498e+01,   Y0: 2.7740e+00,  elapsed time 282
INFO   step:   135,    loss: 9.7490e+01,   Y0: 2.7750e+00,  elapsed time 284
INFO   step:   136,    loss: 9.7483e+01,   Y0: 2.7761e+00,  elapsed time 286
INFO   step:   137,    loss: 9.7475e+01,   Y0: 2.7764e+00,  elapsed time 288
INFO   step:   138,    loss: 9.7470e+01,   Y0: 2.7772e+00,  elapsed time 289
INFO   step:   139,    loss: 9.7467e+01,   Y0: 2.7785e+00,  elapsed time 291
INFO   step:   140,    loss: 9.7463e+01,   Y0: 2.7793e+00,  elapsed time 293
INFO   step:   141,    loss: 9.7458e+01,   Y0: 2.7805e+00,  elapsed time 295
INFO   step:   142,    loss: 9.7452e+01,   Y0: 2.7816e+00,  elapsed time 296
INFO   step:   143,    loss: 9.7449e+01,   Y0: 2.7834e+00,  elapsed time 298
INFO   step:   144,    loss: 9.7446e+01,   Y0: 2.7848e+00,  elapsed time 300
INFO   step:   145,    loss: 9.7443e+01,   Y0: 2.7859e+00,  elapsed time 302
INFO   step:   146,    loss: 9.7440e+01,   Y0: 2.7868e+00,  elapsed time 304
INFO   step:   147,    loss: 9.7434e+01,   Y0: 2.7874e+00,  elapsed time 305
INFO   step:   148,    loss: 9.7427e+01,   Y0: 2.7881e+00,  elapsed time 307
INFO   step:   149,    loss: 9.7420e+01,   Y0: 2.7887e+00,  elapsed time 309
Delta:  155 ,  155.05
Other:  -50 ,  -50
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 2) dtype=float64>]
num_iterations:  150
total time intervals:  40
# of dimensions:  2
Loss out:  98.80966655904206
Output_Z_Vals:  [[[ 1.54286108e+02 -4.92586898e+01]
  [ 1.54286108e+02 -4.92586898e+01]
  [ 1.54286108e+02 -4.92586898e+01]
  ...
  [ 1.54286108e+02 -4.92586898e+01]
  [ 1.54286108e+02 -4.92586898e+01]
  [ 1.54286108e+02 -4.92586898e+01]]

 [[ 2.71247067e-01  5.96073235e-01]
  [ 3.09251722e-01  6.42871767e-01]
  [ 4.95447801e-01  9.18372759e-01]
  ...
  [-1.23333809e-01  1.08480407e-01]
  [-5.66773261e-01 -2.76650278e-01]
  [-1.27606016e-01  1.03770452e-01]]

 [[-1.79455298e-01 -7.67543498e-02]
  [-2.11653812e-01 -7.37614353e-02]
  [-2.41955327e-01 -6.59348136e-02]
  ...
  [-1.64573137e-01 -8.80113702e-02]
  [-1.72295727e-01 -8.51751129e-02]
  [-1.64573137e-01 -8.80113702e-02]]

 ...

 [[-4.36885000e-02  3.06805786e-01]
  [-1.24400101e-01  1.15939812e-01]
  [-4.09170500e-02  2.79512868e-01]
  ...
  [-1.69736631e-01  2.07596830e-01]
  [-2.11898619e-01  1.76889871e-01]
  [-1.00033610e-01  2.69819021e-01]]

 [[-1.23894514e-01  1.17470762e-01]
  [-1.35016245e-01 -1.16384697e-01]
  [-1.35914602e-01  1.09361764e-01]
  ...
  [-1.19566259e-01  1.20390692e-01]
  [-1.16293186e-01  1.22598774e-01]
  [-1.21990114e-01  1.18755510e-01]]

 [[ 4.09934436e-01  5.32323376e-02]
  [ 1.88477491e+00 -1.30781133e-01]
  [ 8.10517724e-01  8.90140054e-03]
  ...
  [-7.36786656e-02  1.18360028e-01]
  [-1.80850689e-01  1.45626810e-01]
  [-4.42776209e-02  1.11035834e-01]]]
Z_Vals dimensionality:  (40, 200, 2)
X_test:  [[[1.00000000e+02 1.00820378e+02 1.00553960e+02 ... 9.96890676e+01
   9.98282549e+01 9.98485444e+01]
  [4.00000000e-02 3.91431292e-02 3.84944184e-02 ... 2.92970598e-02
   2.94995497e-02 2.96522714e-02]]

 [[1.00000000e+02 1.00956396e+02 1.01672737e+02 ... 9.06558099e+01
   8.75501189e+01 8.71388334e+01]
  [4.00000000e-02 3.82103601e-02 3.84976471e-02 ... 5.12749801e-02
   5.25711167e-02 5.50110488e-02]]

 [[1.00000000e+02 1.01858716e+02 1.02047204e+02 ... 9.64131885e+01
   9.70307891e+01 9.64981546e+01]
  [4.00000000e-02 3.97578023e-02 3.98044127e-02 ... 3.98406770e-02
   3.93074491e-02 3.95594557e-02]]

 ...

 [[1.00000000e+02 9.94114616e+01 9.87233367e+01 ... 1.04437673e+02
   1.03571284e+02 1.03437374e+02]
  [4.00000000e-02 3.99150179e-02 4.22252999e-02 ... 3.07349885e-02
   3.03459259e-02 2.94639946e-02]]

 [[1.00000000e+02 9.74919839e+01 9.71184832e+01 ... 1.07163450e+02
   1.06212813e+02 1.06203813e+02]
  [4.00000000e-02 4.07544193e-02 4.16421694e-02 ... 3.75975091e-02
   3.83537645e-02 3.93422050e-02]]

 [[1.00000000e+02 9.93974921e+01 9.88916918e+01 ... 1.02412013e+02
   1.02818899e+02 1.02108688e+02]
  [4.00000000e-02 4.08476087e-02 4.04221631e-02 ... 4.56317574e-02
   4.56407747e-02 4.77769134e-02]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.71247067e-01  5.96073235e-01]
 [-1.79455298e-01 -7.67543498e-02]
 [ 7.50856784e-01 -6.36445007e-01]
 [ 6.27549703e-03  2.40160125e-02]
 [-4.90842256e-02  2.30039261e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-8.98262935e-03  2.87334892e-01]
 [ 2.21897895e-01 -2.12470066e-03]
 [ 1.53385422e-01  7.41533353e-02]
 [ 1.22311677e-01  5.69429159e-02]
 [ 1.14802420e-01  1.79763231e-01]
 [-7.79047837e-02  3.42484762e-02]
 [-8.88101764e-02  1.31641259e-01]
 [-4.18154223e-01 -5.46643946e-01]
 [ 7.92553425e-02  2.24690282e-01]
 [ 5.27125190e-02 -1.95839497e-02]
 [-3.15495954e-02  4.66408111e-02]
 [-4.84420142e-03  4.96147777e-02]
 [ 1.55722620e-02  4.91444346e-02]
 [ 5.44302538e-02 -9.68265917e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 6.38752450e-02  2.93551170e-01]
 [ 3.56808936e-02  2.63263038e-01]
 [-7.10034128e-02  1.15872384e-01]
 [ 2.90096989e-02  7.17645051e-02]
 [ 4.54443516e-01 -8.99636072e-02]
 [ 7.95658992e-03  8.80781725e-02]
 [-1.47171146e-01  1.20112611e-01]
 [ 4.85614249e-03 -1.38597651e-01]
 [ 4.78459990e-03 -4.74440739e-02]
 [-6.70832571e-01 -8.68602776e-02]
 [-1.18128643e-01  7.50384878e-03]
 [ 1.20625247e-02 -9.21421553e-02]
 [ 8.57952123e-02  9.99066623e-02]
 [-2.01720520e-01  1.18037082e-02]
 [-4.38792276e-01 -3.48881028e-01]
 [-4.36885000e-02  3.06805786e-01]
 [-1.23894514e-01  1.17470762e-01]
 [ 4.09934436e-01  5.32323376e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.15460901]
curr_Stock_Price:  100.82037830990033
curr_Factors:  [1.00820378e+02 3.91431292e-02]
mat_Sqrt:  [[ 1.99469314e+01  0.00000000e+00]
 [-7.91384905e-03  1.81329061e-02]]
grads:  [2.66404263e-02 3.28724601e+01]
Stock Position:  0.026640426286870578
Bond Position:  [5.46871116]


portfolio before change:  [8.14819515]
curr_Stock_Price:  100.55396020858403
curr_Factors:  [1.00553960e+02 3.84944184e-02]
mat_Sqrt:  [[ 1.97286815e+01  0.00000000e+00]
 [-7.84799780e-03  1.79820220e-02]]
grads:  [-0.01079411 -4.26839373]
Stock Position:  -0.010794114290361208
Bond Position:  [9.23358609]


portfolio before change:  [8.14112697]
curr_Stock_Price:  101.31571322661507
curr_Factors:  [1.01315713e+02 3.74062608e-02]
mat_Sqrt:  [[ 1.95951664e+01  0.00000000e+00]
 [-7.73627929e-03  1.77260427e-02]]
grads:  [ 2.41431689e-02 -3.59045173e+01]
Stock Position:  0.024143168873972762
Bond Position:  [5.6950446]


portfolio before change:  [8.12576267]
curr_Stock_Price:  100.64984269838473
curr_Factors:  [1.00649843e+02 3.51539519e-02]
mat_Sqrt:  [[ 1.88712287e+01  0.00000000e+00]
 [-7.49975486e-03  1.71840972e-02]]
grads:  [8.87962543e-04 1.39757197e+00]
Stock Position:  0.0008879625426134822
Bond Position:  [8.03638938]


portfolio before change:  [8.12651508]
curr_Stock_Price:  100.36581612440557
curr_Factors:  [1.00365816e+02 3.44717245e-02]
mat_Sqrt:  [[ 1.86344820e+01  0.00000000e+00]
 [-7.42662502e-03  1.70165357e-02]]
grads:  [-0.00209528  1.35185719]
Stock Position:  -0.002095281694631777
Bond Position:  [8.33680974]


portfolio before change:  [8.12810437]
curr_Stock_Price:  100.1046968630771
curr_Factors:  [1.00104697e+02 3.28897608e-02]
mat_Sqrt:  [[ 1.81545217e+01  0.00000000e+00]
 [-7.25421376e-03  1.66214918e-02]]
grads:  [-0.00652294 -3.98983007]
Stock Position:  -0.006522935353269931
Bond Position:  [8.78108083]


portfolio before change:  [8.12925545]
curr_Stock_Price:  100.09651285298126
curr_Factors:  [1.00096513e+02 3.21762049e-02]
mat_Sqrt:  [[ 1.79550392e+01  0.00000000e+00]
 [-7.17509079e-03  1.64401983e-02]]
grads:  [6.48400694e-03 1.74775807e+01]
Stock Position:  0.006484006940714997
Bond Position:  [7.48022897]


portfolio before change:  [8.13678036]
curr_Stock_Price:  101.11283243534196
curr_Factors:  [1.01112832e+02 3.08742552e-02]
mat_Sqrt:  [[ 1.77666080e+01  0.00000000e+00]
 [-7.02842858e-03  1.61041530e-02]]
grads:  [ 0.01243741 -0.13193495]
Stock Position:  0.012437410612370234
Bond Position:  [6.87919855]


portfolio before change:  [8.12459933]
curr_Stock_Price:  100.06430317540709
curr_Factors:  [1.00064303e+02 3.27632229e-02]
mat_Sqrt:  [[ 1.81122533e+01  0.00000000e+00]
 [-7.24024562e-03  1.65894868e-02]]
grads:  [0.01025541 4.46989929]
Stock Position:  0.01025541036263111
Bond Position:  [7.09839884]


portfolio before change:  [8.10342422]
curr_Stock_Price:  97.91300323021211
curr_Factors:  [9.79130032e+01 3.32255062e-02]
mat_Sqrt:  [[ 1.78474500e+01  0.00000000e+00]
 [-7.29114599e-03  1.67061142e-02]]
grads:  [0.00824564 3.40850752]
Stock Position:  0.008245637481438303
Bond Position:  [7.29606909]


portfolio before change:  [8.11199789]
curr_Stock_Price:  98.84217353813999
curr_Factors:  [9.88421735e+01 3.30864640e-02]
mat_Sqrt:  [[ 1.79790800e+01  0.00000000e+00]
 [-7.27587400e-03  1.66711217e-02]]
grads:  [1.07490220e-02 1.07829116e+01]
Stock Position:  0.010749021997942748
Bond Position:  [7.04954119]


portfolio before change:  [8.12316472]
curr_Stock_Price:  99.79905934106236
curr_Factors:  [9.97990593e+01 3.30431299e-02]
mat_Sqrt:  [[ 1.81412428e+01  0.00000000e+00]
 [-7.27110774e-03  1.66602008e-02]]
grads:  [-0.00347041  2.05570609]
Stock Position:  -0.003470408496235095
Bond Position:  [8.46950822]


portfolio before change:  [8.12056495]
curr_Stock_Price:  100.85326674596614
curr_Factors:  [1.00853267e+02 3.07440390e-02]
mat_Sqrt:  [[ 1.76835898e+01  0.00000000e+00]
 [-7.01359127e-03  1.60701564e-02]]
grads:  [-1.77323842e-03  8.19166007e+00]
Stock Position:  -0.0017732384242368886
Bond Position:  [8.29940183]


portfolio before change:  [8.12212692]
curr_Stock_Price:  100.55748624457341
curr_Factors:  [1.00557486e+02 3.01474443e-02]
mat_Sqrt:  [[ 1.74598158e+01  0.00000000e+00]
 [-6.94520776e-03  1.59134701e-02]]
grads:  [ -0.03761375 -34.35102096]
Stock Position:  -0.03761375300473912
Bond Position:  [11.90447138]


portfolio before change:  [8.14281823]
curr_Stock_Price:  100.04695069894277
curr_Factors:  [1.00046951e+02 3.00302949e-02]
mat_Sqrt:  [[ 1.73373875e+01  0.00000000e+00]
 [-6.93170051e-03  1.58825211e-02]]
grads:  [1.02275052e-02 1.41470161e+01]
Stock Position:  0.010227505226760554
Bond Position:  [7.11958752]


portfolio before change:  [8.13556851]
curr_Stock_Price:  99.25108431021411
curr_Factors:  [9.92510843e+01 2.92545903e-02]
mat_Sqrt:  [[ 1.69758790e+01  0.00000000e+00]
 [-6.84158932e-03  1.56760505e-02]]
grads:  [ 0.00260166 -1.24929106]
Stock Position:  0.0026016551303141198
Bond Position:  [7.87735142]


portfolio before change:  [8.13467622]
curr_Stock_Price:  98.52961305418023
curr_Factors:  [9.85296131e+01 2.88912463e-02]
mat_Sqrt:  [[ 1.67474973e+01  0.00000000e+00]
 [-6.79897008e-03  1.55783975e-02]]
grads:  [-6.68391009e-04  2.99394152e+00]
Stock Position:  -0.0006683910092878224
Bond Position:  [8.20053253]


portfolio before change:  [8.1358013]
curr_Stock_Price:  98.38007452442822
curr_Factors:  [9.83800745e+01 2.99368600e-02]
mat_Sqrt:  [[ 1.70219876e+01  0.00000000e+00]
 [-6.92090861e-03  1.58577938e-02]]
grads:  [9.87514689e-04 3.12873142e+00]
Stock Position:  0.0009875146886676003
Bond Position:  [8.03864953]


portfolio before change:  [8.13693465]
curr_Stock_Price:  98.51015300204709
curr_Factors:  [9.85101530e+01 2.96932443e-02]
mat_Sqrt:  [[ 1.69750014e+01  0.00000000e+00]
 [-6.89269112e-03  1.57931394e-02]]
grads:  [2.18089241e-03 3.11175843e+00]
Stock Position:  0.002180892407775034
Bond Position:  [7.92209461]


portfolio before change:  [8.13860358]
curr_Stock_Price:  98.82131146177294
curr_Factors:  [9.88213115e+01 3.01936123e-02]
mat_Sqrt:  [[ 1.71714967e+01  0.00000000e+00]
 [-6.95052370e-03  1.59256505e-02]]
grads:  [ 7.08829574e-04 -6.07991440e+00]
Stock Position:  0.0007088295739795329
Bond Position:  [8.06855611]


portfolio before change:  [8.13951002]
curr_Stock_Price:  98.67714322308389
curr_Factors:  [9.86771432e+01 3.03320313e-02]
mat_Sqrt:  [[ 1.71857035e+01  0.00000000e+00]
 [-6.96643741e-03  1.59621134e-02]]
grads:  [ 0.00245138 -2.36672856]
Stock Position:  0.002451375383839219
Bond Position:  [7.8976153]


portfolio before change:  [8.14080836]
curr_Stock_Price:  98.80404080058199
curr_Factors:  [9.88040408e+01 3.06117587e-02]
mat_Sqrt:  [[ 1.72869688e+01  0.00000000e+00]
 [-6.99848655e-03  1.60355472e-02]]
grads:  [1.11061391e-02 1.83062771e+01]
Stock Position:  0.011106139075828346
Bond Position:  [7.04347694]


portfolio before change:  [8.13590842]
curr_Stock_Price:  98.28356913980284
curr_Factors:  [9.82835691e+01 3.18461258e-02]
mat_Sqrt:  [[ 1.75391775e+01  0.00000000e+00]
 [-7.13819314e-03  1.63556552e-02]]
grads:  [8.58525454e-03 1.60961475e+01]
Stock Position:  0.008585254543312527
Bond Position:  [7.29211896]


portfolio before change:  [8.1349823]
curr_Stock_Price:  98.06951751111006
curr_Factors:  [9.80695175e+01 3.11383887e-02]
mat_Sqrt:  [[ 1.73054185e+01  0.00000000e+00]
 [-7.05842914e-03  1.61728929e-02]]
grads:  [-1.18070293e-03  7.16460468e+00]
Stock Position:  -0.0011807029288735075
Bond Position:  [8.25077327]


portfolio before change:  [8.13582252]
curr_Stock_Price:  98.23144590477743
curr_Factors:  [9.82314459e+01 3.01911343e-02]
mat_Sqrt:  [[ 1.70682994e+01  0.00000000e+00]
 [-6.95023847e-03  1.59249970e-02]]
grads:  [3.53464018e-03 4.50640621e+00]
Stock Position:  0.0035346401791062003
Bond Position:  [7.78860971]


portfolio before change:  [8.13943234]
curr_Stock_Price:  98.97725893644802
curr_Factors:  [9.89772589e+01 2.92760705e-02]
mat_Sqrt:  [[ 1.69352579e+01  0.00000000e+00]
 [-6.84410059e-03  1.56818045e-02]]
grads:  [ 0.02451573 -5.73681474]
Stock Position:  0.02451572816087936
Bond Position:  [5.71293277]


portfolio before change:  [8.15666181]
curr_Stock_Price:  99.65092078270379
curr_Factors:  [9.96509208e+01 2.97077733e-02]
mat_Sqrt:  [[ 1.71757760e+01  0.00000000e+00]
 [-6.89437722e-03  1.57970027e-02]]
grads:  [2.70130770e-03 5.57562557e+00]
Stock Position:  0.002701307699907553
Bond Position:  [7.88747401]


portfolio before change:  [8.15834047]
curr_Stock_Price:  99.90733731767213
curr_Factors:  [9.99073373e+01 2.93134907e-02]
mat_Sqrt:  [[ 1.71053180e+01  0.00000000e+00]
 [-6.84847320e-03  1.56918234e-02]]
grads:  [-5.53919573e-03  7.65447122e+00]
Stock Position:  -0.0055391957312094986
Bond Position:  [8.71174676]


portfolio before change:  [8.16140725]
curr_Stock_Price:  99.55029184391512
curr_Factors:  [9.95502918e+01 3.02203383e-02]
mat_Sqrt:  [[ 1.73058207e+01  0.00000000e+00]
 [-6.95359917e-03  1.59326973e-02]]
grads:  [-3.21468902e-03 -8.69894464e+00]
Stock Position:  -0.0032146890216149045
Bond Position:  [8.48143048]


portfolio before change:  [8.16084433]
curr_Stock_Price:  100.0552126292262
curr_Factors:  [1.00055213e+02 3.11085918e-02]
mat_Sqrt:  [[ 1.76473661e+01  0.00000000e+00]
 [-7.05505117e-03  1.61651530e-02]]
grads:  [-9.02213476e-04 -2.93495978e+00]
Stock Position:  -0.0009022134763512078
Bond Position:  [8.25111549]


portfolio before change:  [8.16202394]
curr_Stock_Price:  99.89099646536974
curr_Factors:  [9.98909965e+01 3.17896205e-02]
mat_Sqrt:  [[ 1.78102090e+01  0.00000000e+00]
 [-7.13185759e-03  1.63411386e-02]]
grads:  [-0.03979411 -5.31543606]
Stock Position:  -0.039794114843467746
Bond Position:  [12.13709773]


portfolio before change:  [8.19503515]
curr_Stock_Price:  99.09957363768906
curr_Factors:  [9.90995736e+01 3.11750704e-02]
mat_Sqrt:  [[ 1.74974801e+01  0.00000000e+00]
 [-7.06258541e-03  1.61824161e-02]]
grads:  [-0.00656401  0.46370386]
Stock Position:  -0.006564013475563246
Bond Position:  [8.84552608]


portfolio before change:  [8.19632435]
curr_Stock_Price:  99.07162635667538
curr_Factors:  [9.90716264e+01 3.15958562e-02]
mat_Sqrt:  [[ 1.76102028e+01  0.00000000e+00]
 [-7.11008931e-03  1.62912612e-02]]
grads:  [-1.59859651e-03 -5.65592522e+00]
Stock Position:  -0.0015985965141006838
Bond Position:  [8.35469991]


portfolio before change:  [8.19768734]
curr_Stock_Price:  98.87233646714654
curr_Factors:  [9.88723365e+01 3.06875550e-02]
mat_Sqrt:  [[ 1.73203212e+01  0.00000000e+00]
 [-7.00714550e-03  1.60553873e-02]]
grads:  [0.00747088 6.22262548]
Stock Position:  0.007470880765788214
Bond Position:  [7.4590239]


portfolio before change:  [8.20193086]
curr_Stock_Price:  99.3155347168936
curr_Factors:  [9.93155347e+01 3.00522913e-02]
mat_Sqrt:  [[ 1.72169406e+01  0.00000000e+00]
 [-6.93423868e-03  1.58883368e-02]]
grads:  [-0.01141718  0.74291654]
Stock Position:  -0.011417182898704073
Bond Position:  [9.33583448]


portfolio before change:  [8.20178386]
curr_Stock_Price:  99.43062862689068
curr_Factors:  [9.94306286e+01 2.88647220e-02]
mat_Sqrt:  [[ 1.68928869e+01  0.00000000e+00]
 [-6.79584838e-03  1.55712448e-02]]
grads:  [ -0.03498848 -22.40546805]
Stock Position:  -0.03498848023833277
Bond Position:  [11.68071044]


portfolio before change:  [8.2122318]
curr_Stock_Price:  99.17375104924483
curr_Factors:  [9.91737510e+01 3.00191991e-02]
mat_Sqrt:  [[ 1.71828932e+01  0.00000000e+00]
 [-6.93041980e-03  1.58795867e-02]]
grads:  [5.25013580e-03 1.93207665e+01]
Stock Position:  0.005250135800251167
Bond Position:  [7.69155614]


portfolio before change:  [8.21589878]
curr_Stock_Price:  99.68906763152171
curr_Factors:  [9.96890676e+01 2.92970598e-02]
mat_Sqrt:  [[ 1.70631635e+01  0.00000000e+00]
 [-6.84655356e-03  1.56874250e-02]]
grads:  [-4.25630744e-03  7.48821191e+00]
Stock Position:  -0.004256307435576503
Bond Position:  [8.6402061]


portfolio before change:  [8.21638645]
curr_Stock_Price:  99.82825487178724
curr_Factors:  [9.98282549e+01 2.94995497e-02]
mat_Sqrt:  [[ 1.71459350e+01  0.00000000e+00]
 [-6.87017318e-03  1.57415443e-02]]
grads:  [0.02526354 3.38164646]
Stock Position:  0.025263535217502617
Bond Position:  [5.69437182]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.21761088]
Stock Price:  99.84854440441494
PL:  [8.21761088]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.09251722e-01  6.42871767e-01]
 [-2.11653812e-01 -7.37614353e-02]
 [ 7.74502603e-01 -6.52529892e-01]
 [ 3.85245446e-02  2.20682547e-02]
 [-4.53265735e-02  2.15000767e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-9.12768856e-03  2.86769664e-01]
 [ 1.76468334e-01 -1.49137594e-02]
 [ 1.66023588e-01  1.00116900e-01]
 [ 1.48021514e-01  2.24249427e-02]
 [ 1.15336680e-01  1.81668073e-01]
 [ 1.83448776e-02  1.57056031e-01]
 [ 7.23576490e-02  7.29153679e-02]
 [-2.41278903e-01 -3.31071944e-01]
 [ 7.97895108e-02  2.25147198e-01]
 [ 5.42596532e-02 -2.05697104e-02]
 [-5.18124830e-02  2.05555537e-01]
 [-9.45194961e-02  8.14458853e-03]
 [ 1.53944956e-02  5.35584032e-02]
 [ 2.95648782e-02 -9.55050558e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 3.44730826e-02  2.02304397e-01]
 [ 3.30670502e-02  1.87676201e-01]
 [-5.83678299e-02  5.29645252e-02]
 [ 5.84801156e-02  1.40911965e-01]
 [ 4.57903015e-02  1.20964229e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.65867283e-01  1.05033847e-01]
 [-2.96462512e-01  1.12083851e-02]
 [ 2.03235730e-01 -9.38207871e-02]
 [-1.22825426e+00 -1.39045921e-01]
 [ 4.23841414e-03  2.17706063e-01]
 [-1.28990935e-02 -1.26633945e-01]
 [ 1.98945715e-02  6.64051411e-02]
 [-9.08464838e-03  1.72360108e-01]
 [-2.29435504e+00  5.22645973e-02]
 [-1.24400101e-01  1.15939812e-01]
 [-1.35016245e-01 -1.16384697e-01]
 [ 1.88477491e+00 -1.30781133e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.05768106]
curr_Stock_Price:  100.95639557700997
curr_Factors:  [1.00956396e+02 3.82103601e-02]
mat_Sqrt:  [[ 1.97344216e+01  0.00000000e+00]
 [-7.81898818e-03  1.79155526e-02]]
grads:  [2.98880796e-02 3.58834462e+01]
Stock Position:  0.029888079591329882
Bond Position:  [6.04028827]


portfolio before change:  [9.07984622]
curr_Stock_Price:  101.67273718740917
curr_Factors:  [1.01672737e+02 3.84976471e-02]
mat_Sqrt:  [[ 1.99490220e+01  0.00000000e+00]
 [-7.84832692e-03  1.79827761e-02]]
grads:  [-0.01222345 -4.10178244]
Stock Position:  -0.012223453422568796
Bond Position:  [10.32263819]


portfolio before change:  [9.09351421]
curr_Stock_Price:  100.66012786389251
curr_Factors:  [1.00660128e+02 3.82889789e-02]
mat_Sqrt:  [[ 1.96967408e+01  0.00000000e+00]
 [-7.82702793e-03  1.79339740e-02]]
grads:  [ 2.48627535e-02 -3.63851254e+01]
Stock Position:  0.02486275345133876
Bond Position:  [6.59082627]


portfolio before change:  [9.11066725]
curr_Stock_Price:  101.31689856555414
curr_Factors:  [1.01316899e+02 3.81107209e-02]
mat_Sqrt:  [[ 1.97790519e+01  0.00000000e+00]
 [-7.80878694e-03  1.78921786e-02]]
grads:  [0.00243469 1.23340233]
Stock Position:  0.0024346930721661844
Bond Position:  [8.86399169]


portfolio before change:  [9.10935886]
curr_Stock_Price:  100.32439042329973
curr_Factors:  [1.0032439e+02 3.8616212e-02]
mat_Sqrt:  [[ 1.97147541e+01  0.00000000e+00]
 [-7.86040324e-03  1.80104464e-02]]
grads:  [-0.00182316  1.1937559 ]
Stock Position:  -0.0018231609945716862
Bond Position:  [9.29226638]


portfolio before change:  [9.11073877]
curr_Stock_Price:  100.20464946398448
curr_Factors:  [1.00204649e+02 3.83693216e-02]
mat_Sqrt:  [[ 1.96281755e+01  0.00000000e+00]
 [-7.83523545e-03  1.79527798e-02]]
grads:  [-0.0060332  -3.69396433]
Stock Position:  -0.006033203209876853
Bond Position:  [9.71529379]


portfolio before change:  [9.11267049]
curr_Stock_Price:  100.08576931957087
curr_Factors:  [1.00085769e+02 3.86166683e-02]
mat_Sqrt:  [[ 1.96679789e+01  0.00000000e+00]
 [-7.86044969e-03  1.80105528e-02]]
grads:  [5.89937861e-03 1.59223133e+01]
Stock Position:  0.005899378607259722
Bond Position:  [8.52222664]


portfolio before change:  [9.11582629]
curr_Stock_Price:  100.44012114464465
curr_Factors:  [1.00440121e+02 3.91245716e-02]
mat_Sqrt:  [[ 1.98669878e+01  0.00000000e+00]
 [-7.91197286e-03  1.81286073e-02]]
grads:  [ 0.00855487 -0.82266438]
Stock Position:  0.00855486686804731
Bond Position:  [8.25657443]


portfolio before change:  [9.09414681]
curr_Stock_Price:  97.78530338523353
curr_Factors:  [9.77853034e+01 4.03898440e-02]
mat_Sqrt:  [[ 1.96521321e+01  0.00000000e+00]
 [-8.03888987e-03  1.84194107e-02]]
grads:  [0.01067152 5.43540191]
Stock Position:  0.01067152327388184
Bond Position:  [8.05062867]


portfolio before change:  [9.10091485]
curr_Stock_Price:  98.3252120473233
curr_Factors:  [9.83252120e+01 3.90112987e-02]
mat_Sqrt:  [[ 1.94204861e+01  0.00000000e+00]
 [-7.90051125e-03  1.81023454e-02]]
grads:  [0.00812588 1.23878659]
Stock Position:  0.008125881137161117
Bond Position:  [8.30193587]


portfolio before change:  [9.10600386]
curr_Stock_Price:  98.82376658657762
curr_Factors:  [9.88237666e+01 3.94508603e-02]
mat_Sqrt:  [[ 1.96286143e+01  0.00000000e+00]
 [-7.94489625e-03  1.82040442e-02]]
grads:  [9.91527595e-03 9.97954472e+00]
Stock Position:  0.009915275950544379
Bond Position:  [8.12613894]


portfolio before change:  [9.10748663]
curr_Stock_Price:  98.87085993565594
curr_Factors:  [9.88708599e+01 3.99038282e-02]
mat_Sqrt:  [[ 1.97503862e+01  0.00000000e+00]
 [-7.99037704e-03  1.83082538e-02]]
grads:  [4.39939493e-03 8.57842765e+00]
Stock Position:  0.0043993949259936585
Bond Position:  [8.67251467]


portfolio before change:  [9.1103249]
curr_Stock_Price:  99.26958219535031
curr_Factors:  [9.92695822e+01 4.10330460e-02]
mat_Sqrt:  [[ 2.01086573e+01  0.00000000e+00]
 [-8.10264609e-03  1.85654945e-02]]
grads:  [0.00518088 3.92746705]
Stock Position:  0.005180879206145925
Bond Position:  [8.59602118]


portfolio before change:  [9.10729499]
curr_Stock_Price:  98.47734576683543
curr_Factors:  [9.84773458e+01 4.25249753e-02]
mat_Sqrt:  [[ 2.03075892e+01  0.00000000e+00]
 [-8.24863386e-03  1.88999945e-02]]
grads:  [ -0.01899637 -17.51703917]
Stock Position:  -0.018996373308766613
Bond Position:  [10.97800741]


portfolio before change:  [9.08167988]
curr_Stock_Price:  99.8980084852868
curr_Factors:  [9.98980085e+01 4.11804646e-02]
mat_Sqrt:  [[ 2.02722732e+01  0.00000000e+00]
 [-8.11718814e-03  1.85988145e-02]]
grads:  [8.78302111e-03 1.21054596e+01]
Stock Position:  0.008783021112239452
Bond Position:  [8.20427357]


portfolio before change:  [9.09187976]
curr_Stock_Price:  100.94255528012329
curr_Factors:  [1.00942555e+02 4.05034450e-02]
mat_Sqrt:  [[ 2.03151614e+01  0.00000000e+00]
 [-8.05018708e-03  1.84452958e-02]]
grads:  [ 0.00222899 -1.11517379]
Stock Position:  0.002228990200043928
Bond Position:  [8.86687979]


portfolio before change:  [9.0908059]
curr_Stock_Price:  99.9635078391347
curr_Factors:  [9.99635078e+01 4.12430886e-02]
mat_Sqrt:  [[ 2.03009835e+01  0.00000000e+00]
 [-8.12335779e-03  1.86129510e-02]]
grads:  [1.86687055e-03 1.10436833e+01]
Stock Position:  0.0018668705459241746
Bond Position:  [8.90418697]


portfolio before change:  [9.0916001]
curr_Stock_Price:  99.79268986318341
curr_Factors:  [9.97926899e+01 4.25936711e-02]
mat_Sqrt:  [[ 2.05954491e+01  0.00000000e+00]
 [-8.25529368e-03  1.89152541e-02]]
grads:  [-0.00441675  0.43058309]
Stock Position:  -0.00441674789349322
Bond Position:  [9.53235925]


portfolio before change:  [9.0967449]
curr_Stock_Price:  98.89764732110129
curr_Factors:  [9.88976473e+01 4.41047258e-02]
mat_Sqrt:  [[ 2.07696187e+01  0.00000000e+00]
 [-8.40045006e-03  1.92478491e-02]]
grads:  [1.86663509e-03 2.78256562e+00]
Stock Position:  0.001866635090966784
Bond Position:  [8.91213908]


portfolio before change:  [9.09830466]
curr_Stock_Price:  99.13640919569461
curr_Factors:  [9.91364092e+01 4.48543433e-02]
mat_Sqrt:  [[ 2.09959454e+01  0.00000000e+00]
 [-8.47153760e-03  1.94107311e-02]]
grads:  [-5.77108822e-04 -4.92021939e+00]
Stock Position:  -0.000577108821533006
Bond Position:  [9.15551716]


portfolio before change:  [9.10062523]
curr_Stock_Price:  97.09857081794007
curr_Factors:  [9.70985708e+01 4.49394053e-02]
mat_Sqrt:  [[ 2.05838448e+01  0.00000000e+00]
 [-8.47956653e-03  1.94291277e-02]]
grads:  [ 0.00204668 -1.94439967]
Stock Position:  0.002046683263584169
Bond Position:  [8.90189521]


portfolio before change:  [9.10030962]
curr_Stock_Price:  96.40065200585524
curr_Factors:  [9.64006520e+01 4.42203222e-02]
mat_Sqrt:  [[ 2.02717351e+01  0.00000000e+00]
 [-8.41145145e-03  1.92730565e-02]]
grads:  [6.0560164e-03 1.0496747e+01]
Stock Position:  0.006056016397653848
Bond Position:  [8.51650569]


portfolio before change:  [9.10483909]
curr_Stock_Price:  96.97278456119334
curr_Factors:  [9.69727846e+01 4.49996657e-02]
mat_Sqrt:  [[ 2.05709577e+01  0.00000000e+00]
 [-8.48524986e-03  1.94421499e-02]]
grads:  [5.58922250e-03 9.65305802e+00]
Stock Position:  0.005589222498523241
Bond Position:  [8.56283662]


portfolio before change:  [9.09966803]
curr_Stock_Price:  95.85608555623067
curr_Factors:  [9.58560856e+01 4.58608273e-02]
mat_Sqrt:  [[ 2.05277161e+01  0.00000000e+00]
 [-8.56605648e-03  1.96273011e-02]]
grads:  [-1.7172985e-03  2.6985129e+00]
Stock Position:  -0.001717298499547691
Bond Position:  [9.26428155]


portfolio before change:  [9.10139662]
curr_Stock_Price:  95.52389296105024
curr_Factors:  [9.55238930e+01 4.58731021e-02]
mat_Sqrt:  [[ 2.04593140e+01  0.00000000e+00]
 [-8.56720278e-03  1.96299276e-02]]
grads:  [5.86427966e-03 7.17842512e+00]
Stock Position:  0.0058642796640016055
Bond Position:  [8.54121779]


portfolio before change:  [9.10210683]
curr_Stock_Price:  95.46293063965611
curr_Factors:  [9.54629306e+01 4.54512493e-02]
mat_Sqrt:  [[ 2.03520272e+01  0.00000000e+00]
 [-8.52771944e-03  1.95394599e-02]]
grads:  [4.84391151e-03 6.19076623e+00]
Stock Position:  0.004843911512612859
Bond Position:  [8.63969285]


portfolio before change:  [9.10030991]
curr_Stock_Price:  94.86899848585199
curr_Factors:  [9.48689985e+01 4.51920538e-02]
mat_Sqrt:  [[ 2.01676528e+01  0.00000000e+00]
 [-8.50336910e-03  1.94836663e-02]]
grads:  [8.83402756e-03 8.97866920e+00]
Stock Position:  0.008834027562927654
Bond Position:  [8.26223456]


portfolio before change:  [9.10222136]
curr_Stock_Price:  94.9684559880439
curr_Factors:  [9.49684560e+01 4.47521006e-02]
mat_Sqrt:  [[ 2.00902846e+01  0.00000000e+00]
 [-8.46187692e-03  1.93885957e-02]]
grads:  [-0.00597437  5.41730037]
Stock Position:  -0.005974368005709474
Bond Position:  [9.66959787]


portfolio before change:  [9.10410373]
curr_Stock_Price:  94.85570873234724
curr_Factors:  [9.48557087e+01 4.56016599e-02]
mat_Sqrt:  [[ 2.02560052e+01  0.00000000e+00]
 [-8.54181806e-03  1.95717639e-02]]
grads:  [-0.01439429  0.57268139]
Stock Position:  -0.014394287963174466
Bond Position:  [10.46948412]


portfolio before change:  [9.10784611]
curr_Stock_Price:  94.6866411547455
curr_Factors:  [9.46866412e+01 4.71783349e-02]
mat_Sqrt:  [[ 2.05664823e+01  0.00000000e+00]
 [-8.68822973e-03  1.99072352e-02]]
grads:  [ 0.00789095 -4.71289891]
Stock Position:  0.007890945063771195
Bond Position:  [8.36067902]


portfolio before change:  [9.1059855]
curr_Stock_Price:  94.31840144479574
curr_Factors:  [9.43184014e+01 4.72863703e-02]
mat_Sqrt:  [[ 2.05099415e+01  0.00000000e+00]
 [-8.69817179e-03  1.99300153e-02]]
grads:  [-0.06284459 -6.97670919]
Stock Position:  -0.0628445906570411
Bond Position:  [15.03338683]


portfolio before change:  [9.0692437]
curr_Stock_Price:  94.9329506381618
curr_Factors:  [9.49329506e+01 4.55447454e-02]
mat_Sqrt:  [[ 2.02598450e+01  0.00000000e+00]
 [-8.53648596e-03  1.95595466e-02]]
grads:  [4.89900734e-03 1.11304248e+01]
Stock Position:  0.0048990073426619695
Bond Position:  [8.60416647]


portfolio before change:  [9.06558052]
curr_Stock_Price:  93.96566003672265
curr_Factors:  [9.39656600e+01 4.63114128e-02]
mat_Sqrt:  [[ 2.02214914e+01  0.00000000e+00]
 [-8.60803464e-03  1.97234852e-02]]
grads:  [-3.37100151e-03 -6.42046494e+00]
Stock Position:  -0.003371001513320271
Bond Position:  [9.3823389]


portfolio before change:  [9.06776619]
curr_Stock_Price:  93.6652137040235
curr_Factors:  [9.36652137e+01 4.90879203e-02]
mat_Sqrt:  [[ 2.07522717e+01  0.00000000e+00]
 [-8.86231756e-03  2.03061205e-02]]
grads:  [2.35521931e-03 3.27020324e+00]
Stock Position:  0.002355219313927791
Bond Position:  [8.84716407]


portfolio before change:  [9.06281915]
curr_Stock_Price:  91.09517402904613
curr_Factors:  [9.1095174e+01 4.8858463e-02]
mat_Sqrt:  [[ 2.01356322e+01  0.00000000e+00]
 [-8.84158022e-03  2.02586053e-02]]
grads:  [3.28469795e-03 8.50799477e+00]
Stock Position:  0.003284697948860335
Bond Position:  [8.76359902]


portfolio before change:  [9.06359295]
curr_Stock_Price:  90.99723139422868
curr_Factors:  [9.09972314e+01 4.97314766e-02]
mat_Sqrt:  [[ 2.02928879e+01  0.00000000e+00]
 [-8.92022212e-03  2.04387965e-02]]
grads:  [-0.11193798  2.55712694]
Stock Position:  -0.11193798076836362
Bond Position:  [19.24963929]


portfolio before change:  [9.13401688]
curr_Stock_Price:  90.38959518023958
curr_Factors:  [9.03895952e+01 4.98247045e-02]
mat_Sqrt:  [[ 2.01762666e+01  0.00000000e+00]
 [-8.92857924e-03  2.04579451e-02]]
grads:  [-3.65775394e-03  5.66722665e+00]
Stock Position:  -0.003657753936315797
Bond Position:  [9.46463978]


portfolio before change:  [9.13422629]
curr_Stock_Price:  90.65580988245908
curr_Factors:  [9.06558099e+01 5.12749801e-02]
mat_Sqrt:  [[ 2.05280829e+01  0.00000000e+00]
 [-9.05759174e-03  2.07535499e-02]]
grads:  [-0.00905154 -5.60794168]
Stock Position:  -0.009051536499460052
Bond Position:  [9.95480066]


portfolio before change:  [9.16358199]
curr_Stock_Price:  87.55011888163027
curr_Factors:  [8.75501189e+01 5.25711167e-02]
mat_Sqrt:  [[ 2.00738346e+01  0.00000000e+00]
 [-9.17135687e-03  2.10142185e-02]]
grads:  [ 0.09104874 -6.22345924]
Stock Position:  0.09104873968330728
Bond Position:  [1.19225401]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.12628401]
Stock Price:  87.13883339165014
PL:  [9.12628401]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.95447801e-01  9.18372759e-01]
 [-2.41955327e-01 -6.59348136e-02]
 [ 8.05780915e-01 -6.73806721e-01]
 [ 5.50462417e-02  2.66157656e-02]
 [-1.45810374e-01  6.17146844e-02]
 [-1.56365104e-02  7.51304292e-03]
 [ 2.98035472e-02  2.59818367e-01]
 [ 2.62288977e-01 -2.09982647e-03]
 [ 1.23639077e-01  8.36136247e-02]
 [ 2.71755606e-01 -1.15705745e-01]
 [ 7.32150802e-02  3.24356536e-02]
 [-1.40885347e-01 -1.10815929e-01]
 [ 2.98591820e-02  9.00343033e-02]
 [-2.93328408e-01 -4.00055765e-01]
 [ 8.73182944e-02  2.31158869e-01]
 [ 4.93340110e-02  1.14644076e-02]
 [-5.13641612e-02  1.80353918e-01]
 [-1.40645516e-01  2.08327320e-02]
 [ 1.50913967e-02  6.10843933e-02]
 [-4.21893530e-02 -7.21884947e-02]
 [ 1.23730387e-01  2.93856874e-02]
 [ 8.26229023e-02  3.04973843e-01]
 [ 3.66671784e-02  3.20109024e-01]
 [-5.25164094e-02  1.28683020e-01]
 [ 2.03562426e-02  4.76526212e-02]
 [ 5.67847755e-01 -1.53198251e-01]
 [-2.55535456e-02  1.80814410e-01]
 [-1.90204866e-01  1.39017067e-01]
 [-2.08061171e-01 -3.28213288e-02]
 [ 9.51413053e-02 -6.85596092e-02]
 [-8.68250804e-01 -1.02984825e-01]
 [-1.18179657e-01  9.48422609e-03]
 [-9.18796745e-03 -8.97266212e-02]
 [ 7.53756271e-02  1.00899861e-01]
 [-9.13930307e-02  1.44681045e-01]
 [-1.01523040e+00 -2.10000002e-01]
 [-4.09170500e-02  2.79512868e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.10517724e-01  8.90140054e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.04854198]
curr_Stock_Price:  101.85871619544781
curr_Factors:  [1.01858716e+02 3.97578023e-02]
mat_Sqrt:  [[ 2.03099747e+01  0.00000000e+00]
 [-7.97574345e-03  1.82747240e-02]]
grads:  [4.41289832e-02 5.02537142e+01]
Stock Position:  0.04412898317580975
Bond Position:  [10.5536204]


portfolio before change:  [15.05817903]
curr_Stock_Price:  102.04720390883105
curr_Factors:  [1.02047204e+02 3.98044127e-02]
mat_Sqrt:  [[ 2.03594818e+01  0.00000000e+00]
 [-7.98041730e-03  1.82854332e-02]]
grads:  [-0.01329757 -3.60586555]
Stock Position:  -0.0132975702019829
Bond Position:  [16.41515889]


portfolio before change:  [15.06301902]
curr_Stock_Price:  101.83754449306485
curr_Factors:  [1.01837544e+02 4.05540869e-02]
mat_Sqrt:  [[ 2.05080909e+01  0.00000000e+00]
 [-8.05521813e-03  1.84568234e-02]]
grads:  [ 2.49514963e-02 -3.65071879e+01]
Stock Position:  0.02495149628256024
Bond Position:  [12.5220199]


portfolio before change:  [15.06360445]
curr_Stock_Price:  101.79827169082205
curr_Factors:  [1.01798272e+02 4.15064767e-02]
mat_Sqrt:  [[ 2.07395027e+01  0.00000000e+00]
 [-8.14925534e-03  1.86722897e-02]]
grads:  [0.00321427 1.4254152 ]
Stock Position:  0.003214267715192328
Bond Position:  [14.73639755]


portfolio before change:  [15.06730788]
curr_Stock_Price:  102.37733338823426
curr_Factors:  [1.02377333e+02 4.18380870e-02]
mat_Sqrt:  [[ 2.09406290e+01  0.00000000e+00]
 [-8.18174426e-03  1.87467312e-02]]
grads:  [-0.00567681  3.29202375]
Stock Position:  -0.005676805465097727
Bond Position:  [15.64848408]


portfolio before change:  [15.07396747]
curr_Stock_Price:  101.54880169076944
curr_Factors:  [1.01548802e+02 4.11040073e-02]
mat_Sqrt:  [[ 2.05881292e+01  0.00000000e+00]
 [-8.10964929e-03  1.85815409e-02]]
grads:  [-0.00060023  0.4043283 ]
Stock Position:  -0.000600226934227824
Bond Position:  [15.1349198]


portfolio before change:  [15.07557523]
curr_Stock_Price:  102.02233765109078
curr_Factors:  [1.02022338e+02 4.10042844e-02]
mat_Sqrt:  [[ 2.06590282e+01  0.00000000e+00]
 [-8.09980587e-03  1.85589867e-02]]
grads:  [6.93147701e-03 1.39995987e+01]
Stock Position:  0.00693147700657486
Bond Position:  [14.36840974]


portfolio before change:  [15.07566725]
curr_Stock_Price:  101.77648310165708
curr_Factors:  [1.01776483e+02 4.35742174e-02]
mat_Sqrt:  [[ 2.12452692e+01  0.00000000e+00]
 [-8.34977532e-03  1.91317387e-02]]
grads:  [ 0.01230262 -0.10975618]
Stock Position:  0.012302623000926943
Bond Position:  [13.82354955]


portfolio before change:  [15.07318552]
curr_Stock_Price:  101.43429682202753
curr_Factors:  [1.01434297e+02 4.40710549e-02]
mat_Sqrt:  [[ 2.12942107e+01  0.00000000e+00]
 [-8.39724288e-03  1.92405006e-02]]
grads:  [0.00751993 4.34570943]
Stock Position:  0.007519933802032232
Bond Position:  [14.31040632]


portfolio before change:  [15.06364963]
curr_Stock_Price:  99.9283258262652
curr_Factors:  [9.99283258e+01 4.28886587e-02]
mat_Sqrt:  [[ 2.06947338e+01  0.00000000e+00]
 [-8.28383087e-03  1.89806410e-02]]
grads:  [ 0.01069149 -6.09598722]
Stock Position:  0.010691487090449203
Bond Position:  [13.99526722]


portfolio before change:  [15.07270523]
curr_Stock_Price:  100.61168153690616
curr_Factors:  [1.00611682e+02 3.99372581e-02]
mat_Sqrt:  [[ 2.01065487e+01  0.00000000e+00]
 [-7.99372335e-03  1.83159212e-02]]
grads:  [0.00434541 1.77089939]
Stock Position:  0.004345408120075702
Bond Position:  [14.63550642]


portfolio before change:  [15.07658407]
curr_Stock_Price:  101.08327847348855
curr_Factors:  [1.01083278e+02 4.02877319e-02]
mat_Sqrt:  [[ 2.02892376e+01  0.00000000e+00]
 [-8.02872163e-03  1.83961123e-02]]
grads:  [-0.00932757 -6.02387759]
Stock Position:  -0.009327574900104817
Bond Position:  [16.01944592]


portfolio before change:  [15.09147527]
curr_Stock_Price:  99.70149979062558
curr_Factors:  [9.97014998e+01 4.12700080e-02]
mat_Sqrt:  [[ 2.02543807e+01  0.00000000e+00]
 [-8.12600842e-03  1.86190243e-02]]
grads:  [3.41424280e-03 4.83560801e+00]
Stock Position:  0.003414242800276739
Bond Position:  [14.75107014]


portfolio before change:  [15.09148768]
curr_Stock_Price:  99.16504591311173
curr_Factors:  [9.91650459e+01 4.16525855e-02]
mat_Sqrt:  [[ 2.02385596e+01  0.00000000e+00]
 [-8.16358602e-03  1.87051254e-02]]
grads:  [ -0.02312057 -21.38749438]
Stock Position:  -0.023120571246024006
Bond Position:  [17.38424019]


portfolio before change:  [15.12316115]
curr_Stock_Price:  97.8891130914722
curr_Factors:  [9.78891131e+01 4.27389197e-02]
mat_Sqrt:  [[ 2.02370015e+01  0.00000000e+00]
 [-8.26935739e-03  1.89474781e-02]]
grads:  [9.30000897e-03 1.21999808e+01]
Stock Position:  0.00930000897209153
Bond Position:  [14.21279152]


portfolio before change:  [15.12137023]
curr_Stock_Price:  97.50549825462384
curr_Factors:  [9.75054983e+01 4.11073250e-02]
mat_Sqrt:  [[ 1.97691827e+01  0.00000000e+00]
 [-8.10997658e-03  1.85822908e-02]]
grads:  [0.0027486 0.6169534]
Stock Position:  0.0027485956062410655
Bond Position:  [14.85336705]


portfolio before change:  [15.12910913]
curr_Stock_Price:  99.645539217266
curr_Factors:  [9.96455392e+01 4.04516672e-02]
mat_Sqrt:  [[ 2.00413086e+01  0.00000000e+00]
 [-8.04503994e-03  1.84335022e-02]]
grads:  [1.36461856e-03 9.78402885e+00]
Stock Position:  0.0013646185577279764
Bond Position:  [14.99313098]


portfolio before change:  [15.13295932]
curr_Stock_Price:  101.09351680363832
curr_Factors:  [1.01093517e+02 3.94539648e-02]
mat_Sqrt:  [[ 2.00802276e+01  0.00000000e+00]
 [-7.94520885e-03  1.82047605e-02]]
grads:  [-0.00655139  1.14435628]
Stock Position:  -0.0065513882192410194
Bond Position:  [15.7952622]


portfolio before change:  [15.1398528]
curr_Stock_Price:  100.34269206278998
curr_Factors:  [1.00342692e+02 3.75031224e-02]
mat_Sqrt:  [[ 1.94320877e+01  0.00000000e+00]
 [-7.74628916e-03  1.77489782e-02]]
grads:  [2.14854998e-03 3.44157239e+00]
Stock Position:  0.0021485499778457744
Bond Position:  [14.92426151]


portfolio before change:  [15.14257912]
curr_Stock_Price:  100.74327467275924
curr_Factors:  [1.00743275e+02 3.65815714e-02]
mat_Sqrt:  [[ 1.92684705e+01  0.00000000e+00]
 [-7.65052379e-03  1.75295522e-02]]
grads:  [-3.82464167e-03 -4.11810262e+00]
Stock Position:  -0.003824641666260003
Bond Position:  [15.52788605]


portfolio before change:  [15.14632022]
curr_Stock_Price:  100.27264328012755
curr_Factors:  [1.00272643e+02 3.64048572e-02]
mat_Sqrt:  [[ 1.91320774e+01  0.00000000e+00]
 [-7.63202277e-03  1.74871610e-02]]
grads:  [0.00713751 1.68041499]
Stock Position:  0.007137507814421167
Bond Position:  [14.43062345]


portfolio before change:  [15.13925005]
curr_Stock_Price:  99.02933620298232
curr_Factors:  [9.90293362e+01 3.74071132e-02]
mat_Sqrt:  [[ 1.91531833e+01  0.00000000e+00]
 [-7.73636744e-03  1.77262447e-02]]
grads:  [1.12631094e-02 1.72046504e+01]
Stock Position:  0.011263109436021207
Bond Position:  [14.0238718]


portfolio before change:  [15.14444118]
curr_Stock_Price:  99.33458333835402
curr_Factors:  [9.93345833e+01 3.73293486e-02]
mat_Sqrt:  [[ 1.91922406e+01  0.00000000e+00]
 [-7.72832179e-03  1.77078098e-02]]
grads:  [9.18987071e-03 1.80772793e+01]
Stock Position:  0.009189870714789503
Bond Position:  [14.2315692]


portfolio before change:  [15.14285431]
curr_Stock_Price:  98.96831923074562
curr_Factors:  [9.89683192e+01 3.86863503e-02]
mat_Sqrt:  [[ 1.94659263e+01  0.00000000e+00]
 [-7.86753840e-03  1.80267951e-02]]
grads:  [1.87274146e-04 7.13843025e+00]
Stock Position:  0.00018727414626434961
Bond Position:  [15.12432011]


portfolio before change:  [15.14495658]
curr_Stock_Price:  100.09827251917825
curr_Factors:  [1.00098273e+02 3.76011890e-02]
mat_Sqrt:  [[ 1.94100821e+01  0.00000000e+00]
 [-7.75641041e-03  1.77721689e-02]]
grads:  [2.12021523e-03 2.68130589e+00]
Stock Position:  0.002120215226549137
Bond Position:  [14.9327267]


portfolio before change:  [15.14615272]
curr_Stock_Price:  99.78200005239381
curr_Factors:  [9.97820001e+01 3.77256258e-02]
mat_Sqrt:  [[ 1.93807434e+01  0.00000000e+00]
 [-7.76923428e-03  1.78015521e-02]]
grads:  [ 0.02584971 -8.60589291]
Stock Position:  0.025849707972819488
Bond Position:  [12.56681716]


portfolio before change:  [15.12365699]
curr_Stock_Price:  98.85097651641254
curr_Factors:  [9.88509765e+01 3.78345472e-02]
mat_Sqrt:  [[ 1.92276069e+01  0.00000000e+00]
 [-7.78044186e-03  1.78272319e-02]]
grads:  [2.77519366e-03 1.01425960e+01]
Stock Position:  0.0027751936553512234
Bond Position:  [14.84932639]


portfolio before change:  [15.1226435]
curr_Stock_Price:  97.8168975499665
curr_Factors:  [9.78168975e+01 3.90615172e-02]
mat_Sqrt:  [[ 1.93325187e+01  0.00000000e+00]
 [-7.90559470e-03  1.81139931e-02]]
grads:  [-6.70025702e-03  7.67456777e+00]
Stock Position:  -0.00670025701887331
Bond Position:  [15.77804185]


portfolio before change:  [15.13525925]
curr_Stock_Price:  96.22839587134831
curr_Factors:  [9.62283959e+01 3.89997986e-02]
mat_Sqrt:  [[ 1.90035365e+01  0.00000000e+00]
 [-7.89934667e-03  1.80996770e-02]]
grads:  [-0.01170233 -1.81336544]
Stock Position:  -0.011702325710305448
Bond Position:  [16.26135528]


portfolio before change:  [15.12114325]
curr_Stock_Price:  97.60836054586497
curr_Factors:  [9.76083605e+01 3.96327181e-02]
mat_Sqrt:  [[ 1.94318410e+01  0.00000000e+00]
 [-7.96318711e-03  1.82459538e-02]]
grads:  [ 3.35631806e-03 -3.75752399e+00]
Stock Position:  0.0033563180578107866
Bond Position:  [14.79353855]


portfolio before change:  [15.12396131]
curr_Stock_Price:  97.89699613141637
curr_Factors:  [9.78969961e+01 4.01792782e-02]
mat_Sqrt:  [[ 1.96232272e+01  0.00000000e+00]
 [-8.01790778e-03  1.83713347e-02]]
grads:  [-0.04653654 -5.60573455]
Stock Position:  -0.046536538496466266
Bond Position:  [19.67974864]


portfolio before change:  [15.10656017]
curr_Stock_Price:  98.32378476751035
curr_Factors:  [9.83237848e+01 3.89690073e-02]
mat_Sqrt:  [[ 1.94096748e+01  0.00000000e+00]
 [-7.89622769e-03  1.80925305e-02]]
grads:  [-0.00587544  0.52420672]
Stock Position:  -0.005875441129477545
Bond Position:  [15.68425578]


portfolio before change:  [15.11283975]
curr_Stock_Price:  97.5887033854677
curr_Factors:  [9.75887034e+01 4.04174969e-02]
mat_Sqrt:  [[ 1.96193337e+01  0.00000000e+00]
 [-8.04164131e-03  1.84257150e-02]]
grads:  [-2.46429752e-03 -4.86964121e+00]
Stock Position:  -0.0024642975170923813
Bond Position:  [15.35332735]


portfolio before change:  [15.11507428]
curr_Stock_Price:  97.46077951836386
curr_Factors:  [9.74607795e+01 4.02493439e-02]
mat_Sqrt:  [[ 1.95528146e+01  0.00000000e+00]
 [-8.02489565e-03  1.83873459e-02]]
grads:  [0.00610715 5.48746193]
Stock Position:  0.006107148184181716
Bond Position:  [14.51986685]


portfolio before change:  [15.11716028]
curr_Stock_Price:  97.5051378851644
curr_Factors:  [9.75051379e+01 4.05687147e-02]
mat_Sqrt:  [[ 1.96391698e+01  0.00000000e+00]
 [-8.05667075e-03  1.84601518e-02]]
grads:  [-1.43840327e-03  7.83747862e+00]
Stock Position:  -0.0014384032655495086
Bond Position:  [15.25741198]


portfolio before change:  [15.12015623]
curr_Stock_Price:  96.74828452263428
curr_Factors:  [9.67482845e+01 3.84308053e-02]
mat_Sqrt:  [[ 1.89663175e+01  0.00000000e+00]
 [-7.84151060e-03  1.79671579e-02]]
grads:  [ -0.0583604  -11.68799219]
Stock Position:  -0.05836040230486513
Bond Position:  [20.76642504]


portfolio before change:  [15.14527618]
curr_Stock_Price:  96.36233825752969
curr_Factors:  [9.63623383e+01 3.92684792e-02]
mat_Sqrt:  [[ 1.90954268e+01  0.00000000e+00]
 [-7.92651037e-03  1.81619169e-02]]
grads:  [4.24564308e-03 1.53900533e+01]
Stock Position:  0.004245643084116158
Bond Position:  [14.73615608]


portfolio before change:  [15.1473342]
curr_Stock_Price:  96.41318854097116
curr_Factors:  [9.64131885e+01 3.98406770e-02]
mat_Sqrt:  [[ 1.92441973e+01  0.00000000e+00]
 [-7.98405180e-03  1.82937609e-02]]
grads:  [-4.58243147e-03  5.97809085e+00]
Stock Position:  -0.004582431473271951
Bond Position:  [15.58914103]


portfolio before change:  [15.14645286]
curr_Stock_Price:  97.03078907959343
curr_Factors:  [9.70307891e+01 3.93074491e-02]
mat_Sqrt:  [[ 1.92374274e+01  0.00000000e+00]
 [-7.93044252e-03  1.81709266e-02]]
grads:  [0.04233428 0.48987048]
Stock Position:  0.04233427875563444
Bond Position:  [11.03872438]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.12528408]
Stock Price:  96.49815456141236
PL:  [15.12528408]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.25873433e-01  5.39892464e-01]
 [-1.79929335e-01 -7.31498662e-02]
 [ 7.69215154e-01 -6.48933145e-01]
 [-9.95645165e-03  2.49963796e-02]
 [-1.71118943e-01  7.18434234e-02]
 [ 4.50565660e-02  6.69005792e-02]
 [ 7.13875999e-02  1.06393114e-01]
 [ 4.05384769e-01 -1.27118651e-02]
 [ 8.53306392e-02  9.01784058e-02]
 [ 4.24131273e-01 -2.56552187e-01]
 [ 6.24932791e-02 -4.76275720e-03]
 [-8.50994524e-02 -1.73133811e-01]
 [-1.42003385e-01  1.39401667e-01]
 [-6.56100712e-01 -8.46717021e-01]
 [-2.21675603e-02 -2.17655916e-01]
 [-1.81490101e-02 -1.90805813e-01]
 [-5.10970683e-02  1.65339760e-01]
 [ 9.69376490e-02  1.52081192e-01]
 [ 1.66373964e-02  2.26969871e-02]
 [-1.13234043e-01 -2.51632856e-02]
 [ 2.09025785e-01  3.77394490e-01]
 [ 3.38428564e-02  5.79477795e-02]
 [-8.48827864e-03  1.29922460e-01]
 [ 7.28679389e-02  1.82081460e-01]
 [ 4.46823762e-02  9.78604086e-02]
 [ 7.35954360e-01 -4.11996077e-01]
 [-2.56195429e-01  3.35754398e-01]
 [ 1.37145932e-01 -1.11351800e-02]
 [-4.82193556e-02 -6.16904851e-02]
 [ 7.91708727e-02 -2.08924553e-01]
 [ 1.16356584e-01 -6.41628420e-02]
 [ 2.90723419e-01 -2.45214103e-02]
 [ 3.20590274e-01  4.21351165e-01]
 [ 2.42466307e-01  1.95274757e-02]
 [-1.50400407e-01 -2.43370172e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-3.11746071e-01  1.04170064e-01]
 [-1.11058279e-01  1.26130349e-01]
 [-3.13209593e-01  1.72901130e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.07572391]
curr_Stock_Price:  100.65788075078959
curr_Factors:  [1.00657881e+02 3.92501926e-02]
mat_Sqrt:  [[ 1.99419985e+01  0.00000000e+00]
 [-7.92466455e-03  1.81576876e-02]]
grads:  [2.31422052e-02 2.97335474e+01]
Stock Position:  0.023142205227939614
Bond Position:  [4.74627857]


portfolio before change:  [7.08744914]
curr_Stock_Price:  101.13890294649475
curr_Factors:  [1.01138903e+02 3.87889126e-02]
mat_Sqrt:  [[ 1.99192068e+01  0.00000000e+00]
 [-7.87796040e-03  1.80506749e-02]]
grads:  [-0.01063569 -4.05247263]
Stock Position:  -0.010635692253825421
Bond Position:  [8.16313139]


portfolio before change:  [7.08453608]
curr_Stock_Price:  101.50874414199221
curr_Factors:  [1.01508744e+02 3.81561989e-02]
mat_Sqrt:  [[ 1.98283240e+01  0.00000000e+00]
 [-7.81344471e-03  1.79028509e-02]]
grads:  [ 2.45102667e-02 -3.62474752e+01]
Stock Position:  0.024510266709172356
Bond Position:  [4.59652969]


portfolio before change:  [7.05575221]
curr_Stock_Price:  100.31094108341314
curr_Factors:  [1.00310941e+02 3.86321562e-02]
mat_Sqrt:  [[ 1.97161802e+01  0.00000000e+00]
 [-7.86202581e-03  1.80141642e-02]]
grads:  [4.83289754e-05 1.38759586e+00]
Stock Position:  4.832897535918492e-05
Bond Position:  [7.05090429]


portfolio before change:  [7.05677327]
curr_Stock_Price:  103.20038807932228
curr_Factors:  [1.03200388e+02 3.83739672e-02]
mat_Sqrt:  [[ 2.02162072e+01  0.00000000e+00]
 [-7.83570977e-03  1.79538666e-02]]
grads:  [-0.00691346  4.00155717]
Stock Position:  -0.0069134581442067
Bond Position:  [7.77024484]


portfolio before change:  [7.06444649]
curr_Stock_Price:  102.23099259677105
curr_Factors:  [1.02230993e+02 3.77223735e-02]
mat_Sqrt:  [[ 1.98555574e+01  0.00000000e+00]
 [-7.76889939e-03  1.78007847e-02]]
grads:  [3.73972742e-03 3.75829381e+00]
Stock Position:  0.003739727424541494
Bond Position:  [6.68213044]


portfolio before change:  [7.06863209]
curr_Stock_Price:  103.12685541599157
curr_Factors:  [1.03126855e+02 3.73872149e-02]
mat_Sqrt:  [[ 1.99403755e+01  0.00000000e+00]
 [-7.73430952e-03  1.77215294e-02]]
grads:  [5.9086832e-03 6.0036079e+00]
Stock Position:  0.005908683195699414
Bond Position:  [6.45928817]


portfolio before change:  [7.0723551]
curr_Stock_Price:  103.62028988545958
curr_Factors:  [1.03620290e+02 3.82224222e-02]
mat_Sqrt:  [[ 2.02583423e+01  0.00000000e+00]
 [-7.82022222e-03  1.79183801e-02]]
grads:  [ 0.0197369 -0.7094316]
Stock Position:  0.019736898970750007
Bond Position:  [5.02721191]


portfolio before change:  [7.0525062]
curr_Stock_Price:  102.58277427682478
curr_Factors:  [1.02582774e+02 3.81776571e-02]
mat_Sqrt:  [[ 2.00437546e+01  0.00000000e+00]
 [-7.81564146e-03  1.79078843e-02]]
grads:  [0.00622078 5.03568174]
Stock Position:  0.006220776732054284
Bond Position:  [6.41436166]


portfolio before change:  [7.05465803]
curr_Stock_Price:  102.79978692869277
curr_Factors:  [1.02799787e+02 3.65074080e-02]
mat_Sqrt:  [[ 1.96418647e+01  0.00000000e+00]
 [-7.64276474e-03  1.75117740e-02]]
grads:  [  0.01589272 -14.65026831]
Stock Position:  0.01589272325183572
Bond Position:  [5.42088947]


portfolio before change:  [7.05457396]
curr_Stock_Price:  102.75185768478174
curr_Factors:  [1.02751858e+02 3.56591019e-02]
mat_Sqrt:  [[ 1.94032680e+01  0.00000000e+00]
 [-7.55344710e-03  1.73071215e-02]]
grads:  [ 0.00311363 -0.2751906 ]
Stock Position:  0.003113632267888967
Bond Position:  [6.73464246]


portfolio before change:  [7.0574532]
curr_Stock_Price:  103.40619337561161
curr_Factors:  [1.03406193e+02 3.49364601e-02]
mat_Sqrt:  [[ 1.93279592e+01  0.00000000e+00]
 [-7.47651899e-03  1.71308571e-02]]
grads:  [-8.31237487e-03 -1.01065469e+01]
Stock Position:  -0.008312374870531372
Bond Position:  [7.91700425]


portfolio before change:  [7.05418257]
curr_Stock_Price:  103.91872140893908
curr_Factors:  [1.03918721e+02 3.21972320e-02]
mat_Sqrt:  [[ 1.86467463e+01  0.00000000e+00]
 [-7.17743486e-03  1.64455693e-02]]
grads:  [-4.35269017e-03  8.47654858e+00]
Stock Position:  -0.004352690167171819
Bond Position:  [7.50650856]


portfolio before change:  [7.05737026]
curr_Stock_Price:  103.40195505406882
curr_Factors:  [1.03401955e+02 3.08097963e-02]
mat_Sqrt:  [[ 1.81498552e+01  0.00000000e+00]
 [-7.02108781e-03  1.60873332e-02]]
grads:  [ -0.05650945 -52.63252842]
Stock Position:  -0.05650944906182283
Bond Position:  [12.90055777]


portfolio before change:  [7.01073742]
curr_Stock_Price:  104.2557152316556
curr_Factors:  [1.04255715e+02 3.06726478e-02]
mat_Sqrt:  [[ 1.82589377e+01  0.00000000e+00]
 [-7.00544335e-03  1.60514872e-02]]
grads:  [-6.41660496e-03 -1.35598598e+01]
Stock Position:  -0.00641660495728729
Bond Position:  [7.67970515]


portfolio before change:  [7.00374754]
curr_Stock_Price:  105.49467309250704
curr_Factors:  [1.05494673e+02 3.13351080e-02]
mat_Sqrt:  [[ 1.86743773e+01  0.00000000e+00]
 [-7.08069014e-03  1.62238993e-02]]
grads:  [-5.43115803e-03 -1.17607864e+01]
Stock Position:  -0.005431158030581527
Bond Position:  [7.57670578]


portfolio before change:  [7.00576936]
curr_Stock_Price:  105.29679966331409
curr_Factors:  [1.05296800e+02 3.06283971e-02]
mat_Sqrt:  [[ 1.84279619e+01  0.00000000e+00]
 [-7.00038823e-03  1.60399045e-02]]
grads:  [1.14299775e-03 1.03080265e+01]
Stock Position:  0.0011429977487911068
Bond Position:  [6.88541536]


portfolio before change:  [7.00639774]
curr_Stock_Price:  105.09351364898778
curr_Factors:  [1.05093514e+02 3.05095159e-02]
mat_Sqrt:  [[ 1.83566560e+01  0.00000000e+00]
 [-6.98678935e-03  1.60087455e-02]]
grads:  [8.89657258e-03 9.49988190e+00]
Stock Position:  0.008896572576798786
Bond Position:  [6.07142567]


portfolio before change:  [7.01854351]
curr_Stock_Price:  106.3734214631182
curr_Factors:  [1.06373421e+02 2.89876645e-02]
mat_Sqrt:  [[ 1.81108879e+01  0.00000000e+00]
 [-6.81030566e-03  1.56043706e-02]]
grads:  [0.00146559 1.45452756]
Stock Position:  0.0014655920741561523
Bond Position:  [6.86264346]


portfolio before change:  [7.02006931]
curr_Stock_Price:  106.82915578208393
curr_Factors:  [1.06829156e+02 2.75477447e-02]
mat_Sqrt:  [[ 1.77309833e+01  0.00000000e+00]
 [-6.63900531e-03  1.52118722e-02]]
grads:  [-0.0070056  -1.65418728]
Stock Position:  -0.007005601377221519
Bond Position:  [7.76847179]


portfolio before change:  [7.03054095]
curr_Stock_Price:  105.47302445947777
curr_Factors:  [1.05473024e+02 2.82806060e-02]
mat_Sqrt:  [[ 1.77372283e+01  0.00000000e+00]
 [-6.72673544e-03  1.54128872e-02]]
grads:  [2.10706113e-02 2.44856454e+01]
Stock Position:  0.02107061132960474
Bond Position:  [4.80815984]


portfolio before change:  [7.01050076]
curr_Stock_Price:  104.49340189496021
curr_Factors:  [1.04493402e+02 2.78615817e-02]
mat_Sqrt:  [[ 1.74418181e+01  0.00000000e+00]
 [-6.67671556e-03  1.52982772e-02]]
grads:  [3.39031978e-03 3.78786308e+00]
Stock Position:  0.0033903197803160237
Bond Position:  [6.65623471]


portfolio before change:  [7.0083283]
curr_Stock_Price:  103.60718950182199
curr_Factors:  [1.03607190e+02 2.80059631e-02]
mat_Sqrt:  [[ 1.73386448e+01  0.00000000e+00]
 [-6.69399290e-03  1.53378646e-02]]
grads:  [2.78075549e-03 8.47070068e+00]
Stock Position:  0.0027807554859878383
Bond Position:  [6.72022204]


portfolio before change:  [7.00989201]
curr_Stock_Price:  103.86741805406247
curr_Factors:  [1.03867418e+02 2.76222903e-02]
mat_Sqrt:  [[ 1.72627181e+01  0.00000000e+00]
 [-6.64798198e-03  1.52324403e-02]]
grads:  [8.82449695e-03 1.19535318e+01]
Stock Position:  0.008824496951828442
Bond Position:  [6.0933143]


portfolio before change:  [7.00625112]
curr_Stock_Price:  103.36851078492407
curr_Factors:  [1.03368511e+02 2.85340437e-02]
mat_Sqrt:  [[ 1.74610325e+01  0.00000000e+00]
 [-6.75680915e-03  1.54817947e-02]]
grads:  [5.00498238e-03 6.32099898e+00]
Stock Position:  0.005004982378479318
Bond Position:  [6.48889354]


portfolio before change:  [7.0058632]
curr_Stock_Price:  103.12893357256478
curr_Factors:  [1.03128934e+02 2.85421852e-02]
mat_Sqrt:  [[ 1.74230481e+01  0.00000000e+00]
 [-6.75777303e-03  1.54840032e-02]]
grads:  [  0.03192005 -26.6078527 ]
Stock Position:  0.03192004784182574
Bond Position:  [3.7139827]


portfolio before change:  [7.0106835]
curr_Stock_Price:  103.2654004520546
curr_Factors:  [1.03265400e+02 2.72563726e-02]
mat_Sqrt:  [[ 1.70486055e+01  0.00000000e+00]
 [-6.60380164e-03  1.51312105e-02]]
grads:  [-6.43220916e-03  2.21895267e+01]
Stock Position:  -0.0064322091588342924
Bond Position:  [7.67490816]


portfolio before change:  [6.99867127]
curr_Stock_Price:  105.28207312178952
curr_Factors:  [1.05282073e+02 2.50320514e-02]
mat_Sqrt:  [[ 1.66572249e+01  0.00000000e+00]
 [-6.32860823e-03  1.45006631e-02]]
grads:  [ 0.00794167 -0.76790833]
Stock Position:  0.00794166747615456
Bond Position:  [6.16255605]


portfolio before change:  [7.00076719]
curr_Stock_Price:  105.44898480371567
curr_Factors:  [1.05448985e+02 2.45444825e-02]
mat_Sqrt:  [[ 1.65203537e+01  0.00000000e+00]
 [-6.26667152e-03  1.43587483e-02]]
grads:  [-0.00454853 -4.29636928]
Stock Position:  -0.004548527941777474
Bond Position:  [7.48040485]


portfolio before change:  [6.99619749]
curr_Stock_Price:  106.65922526582841
curr_Factors:  [1.06659225e+02 2.42426240e-02]
mat_Sqrt:  [[ 1.66068873e+01  0.00000000e+00]
 [-6.22801722e-03  1.42701802e-02]]
grads:  [-7.23270863e-04 -1.46406388e+01]
Stock Position:  -0.0007232708629078733
Bond Position:  [7.073341]


portfolio before change:  [6.99600753]
curr_Stock_Price:  108.14439053177392
curr_Factors:  [1.08144391e+02 2.39343619e-02]
mat_Sqrt:  [[ 1.67307313e+01  0.00000000e+00]
 [-6.18829371e-03  1.41791622e-02]]
grads:  [ 0.00528092 -4.52515044]
Stock Position:  0.0052809182353765775
Bond Position:  [6.42490585]


portfolio before change:  [7.0009659]
curr_Stock_Price:  108.93122292152084
curr_Factors:  [1.08931223e+02 2.41940342e-02]
mat_Sqrt:  [[ 1.69436325e+01  0.00000000e+00]
 [-6.22177263e-03  1.42558720e-02]]
grads:  [ 0.01652664 -1.72009192]
Stock Position:  0.016526644863107853
Bond Position:  [5.20069826]


portfolio before change:  [7.01003569]
curr_Stock_Price:  109.44068315914012
curr_Factors:  [1.09440683e+02 2.56539505e-02]
mat_Sqrt:  [[ 1.75289508e+01  0.00000000e+00]
 [-6.40674026e-03  1.46796861e-02]]
grads:  [ 0.02877999 28.70300918]
Stock Position:  0.028779988324910813
Bond Position:  [3.86033411]


portfolio before change:  [6.98432349]
curr_Stock_Price:  108.53050978774093
curr_Factors:  [1.08530510e+02 2.47364463e-02]
mat_Sqrt:  [[ 1.70694881e+01  0.00000000e+00]
 [-6.29112979e-03  1.44147892e-02]]
grads:  [0.01470394 1.3546834 ]
Stock Position:  0.014703943931952408
Bond Position:  [5.38849695]


portfolio before change:  [6.9831118]
curr_Stock_Price:  108.40229325021045
curr_Factors:  [1.08402293e+02 2.44001710e-02]
mat_Sqrt:  [[ 1.69330388e+01  0.00000000e+00]
 [-6.24822163e-03  1.43164743e-02]]
grads:  [-1.51547433e-02 -1.69993091e+01]
Stock Position:  -0.015154743340849942
Bond Position:  [8.62592073]


portfolio before change:  [6.94241612]
curr_Stock_Price:  111.15878916019841
curr_Factors:  [1.11158789e+02 2.37807672e-02]
mat_Sqrt:  [[ 1.71418124e+01  0.00000000e+00]
 [-6.16840559e-03  1.41335928e-02]]
grads:  [ 0.0090933  -4.92984939]
Stock Position:  0.009093300257179427
Bond Position:  [5.93161587]


portfolio before change:  [6.94211733]
curr_Stock_Price:  111.0443876025116
curr_Factors:  [1.11044388e+02 2.36423084e-02]
mat_Sqrt:  [[ 1.70742467e+01  0.00000000e+00]
 [-6.15042222e-03  1.40923877e-02]]
grads:  [-0.01559557  7.39193858]
Stock Position:  -0.01559556520722558
Bond Position:  [8.67391732]


portfolio before change:  [6.93559257]
curr_Stock_Price:  111.5322871426494
curr_Factors:  [1.11532287e+02 2.25020791e-02]
mat_Sqrt:  [[ 1.67306160e+01  0.00000000e+00]
 [-6.00027720e-03  1.37483622e-02]]
grads:  [-3.34778360e-03  9.17420905e+00]
Stock Position:  -0.003347783599537469
Bond Position:  [7.30897853]


portfolio before change:  [6.9371469]
curr_Stock_Price:  111.34092208844787
curr_Factors:  [1.11340922e+02 2.25484772e-02]
mat_Sqrt:  [[ 1.67191203e+01  0.00000000e+00]
 [-6.00646015e-03  1.37625291e-02]]
grads:  [-0.01422021 12.56317993]
Stock Position:  -0.014220207097614653
Bond Position:  [8.52043787]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.92697292]
Stock Price:  112.13128295077738
PL:  [-5.20431003]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.37109698e-01  5.54261107e-01]
 [-1.76819466e-01 -7.86115656e-02]
 [ 7.50802829e-01 -6.36408305e-01]
 [ 9.86321666e-03  2.37993237e-02]
 [-1.85006550e-02  1.07640796e-02]
 [-8.69541233e-02 -7.66136420e-02]
 [-9.31460151e-02  1.35549419e-01]
 [-1.28943266e-01 -9.28047705e-02]
 [ 1.65798291e-01  1.07493020e-01]
 [ 6.85349509e-02  1.35378146e-01]
 [ 1.60609841e-01  3.43084391e-01]
 [ 1.56955958e-01  2.12941438e-01]
 [ 2.44256331e-01  2.22778540e-02]
 [-1.09881218e-01 -1.01635685e-01]
 [ 8.87673780e-02  2.32320722e-01]
 [ 5.17624793e-02 -1.89786294e-02]
 [-3.29274464e-02  4.43720155e-02]
 [ 2.08816080e-02  5.36507472e-02]
 [ 1.21390320e-02  4.52696082e-02]
 [ 1.99803389e-01 -1.06261566e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 3.24383717e-02  2.01805805e-01]
 [ 2.48942849e-02  1.40744946e-01]
 [-3.39448900e-02  5.94622612e-03]
 [ 4.88447529e-02  1.49591947e-01]
 [ 4.48748255e-02  1.80681216e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.74884358e-01  1.23825584e-01]
 [-2.43255128e-01 -1.56127279e-02]
 [ 1.40932449e-01 -7.92598108e-02]
 [-9.97197179e-01 -1.13732686e-01]
 [-1.22076429e-01  4.63261648e-02]
 [ 1.10047292e-02 -9.20144050e-02]
 [ 8.10506803e-02  9.97541361e-02]
 [-1.16143762e-01  1.21633627e-01]
 [-7.28781936e-01 -2.67320627e-01]
 [-5.94924807e-02  3.00489314e-01]
 [-1.23483322e-01  1.17748161e-01]
 [ 2.85431241e-01  6.94226415e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.34394889]
curr_Stock_Price:  100.69827977414288
curr_Factors:  [1.00698280e+02 4.07135506e-02]
mat_Sqrt:  [[ 2.03184952e+01  0.00000000e+00]
 [-8.07103965e-03  1.84930751e-02]]
grads:  [2.35750272e-02 2.99712787e+01]
Stock Position:  0.023575027193510595
Bond Position:  [4.9699842]


portfolio before change:  [7.3387855]
curr_Stock_Price:  100.45290680666182
curr_Factors:  [1.00452907e+02 4.04920621e-02]
mat_Sqrt:  [[ 2.02137763e+01  0.00000000e+00]
 [-8.04905581e-03  1.84427038e-02]]
grads:  [-0.01044478 -4.2624751 ]
Stock Position:  -0.01044477598596046
Bond Position:  [8.38799361]


portfolio before change:  [7.33363245]
curr_Stock_Price:  101.04665961737099
curr_Factors:  [1.01046660e+02 4.02362054e-02]
mat_Sqrt:  [[ 2.02689135e+01  0.00000000e+00]
 [-8.02358578e-03  1.83843446e-02]]
grads:  [ 2.33387682e-02 -3.46168612e+01]
Stock Position:  0.02333876817545349
Bond Position:  [4.97532789]


portfolio before change:  [7.32665185]
curr_Stock_Price:  100.72091179855052
curr_Factors:  [1.00720912e+02 4.04327646e-02]
mat_Sqrt:  [[ 2.02528603e+01  0.00000000e+00]
 [-8.04316004e-03  1.84291949e-02]]
grads:  [9.99863364e-04 1.29139248e+00]
Stock Position:  0.0009998633641351438
Bond Position:  [7.2259447]


portfolio before change:  [7.32686441]
curr_Stock_Price:  100.03007231260395
curr_Factors:  [1.00030072e+02 4.16527235e-02]
mat_Sqrt:  [[ 2.04151363e+01  0.00000000e+00]
 [-8.16359955e-03  1.87051564e-02]]
grads:  [-0.00067611  0.57546055]
Stock Position:  -0.0006761074375606973
Bond Position:  [7.39449548]


portfolio before change:  [7.32865188]
curr_Stock_Price:  98.75348967241145
curr_Factors:  [9.87534897e+01 4.31597213e-02]
mat_Sqrt:  [[ 2.05159564e+01  0.00000000e+00]
 [-8.30996715e-03  1.90405267e-02]]
grads:  [-0.00586817 -4.02371442]
Stock Position:  -0.005868166987195984
Bond Position:  [7.90815385]


portfolio before change:  [7.33687342]
curr_Stock_Price:  97.5209138072293
curr_Factors:  [9.75209138e+01 4.45236611e-02]
mat_Sqrt:  [[ 2.05775278e+01  0.00000000e+00]
 [-8.44025223e-03  1.93390474e-02]]
grads:  [-1.65167551e-03  7.00910528e+00]
Stock Position:  -0.0016516755097651392
Bond Position:  [7.49794633]


portfolio before change:  [7.3363359]
curr_Stock_Price:  98.4138383953618
curr_Factors:  [9.84138384e+01 4.43247184e-02]
mat_Sqrt:  [[ 2.07194949e+01  0.00000000e+00]
 [-8.42137456e-03  1.92957932e-02]]
grads:  [-0.00817812 -4.80958568]
Stock Position:  -0.008178123525118583
Bond Position:  [8.14117643]


portfolio before change:  [7.34601783]
curr_Stock_Price:  97.35439996984888
curr_Factors:  [9.73544000e+01 4.50142895e-02]
mat_Sqrt:  [[ 2.06552656e+01  0.00000000e+00]
 [-8.48662850e-03  1.94453087e-02]]
grads:  [0.0102982  5.52796677]
Stock Position:  0.010298201705980538
Bond Position:  [6.34344259]


portfolio before change:  [7.34249347]
curr_Stock_Price:  96.93516767036066
curr_Factors:  [9.69351677e+01 4.55855410e-02]
mat_Sqrt:  [[ 2.06964054e+01  0.00000000e+00]
 [-8.54030828e-03  1.95683046e-02]]
grads:  [6.16623105e-03 6.91823583e+00]
Stock Position:  0.006166231053386994
Bond Position:  [6.74476883]


portfolio before change:  [7.34134359]
curr_Stock_Price:  96.61195073579795
curr_Factors:  [9.66119507e+01 4.63613785e-02]
mat_Sqrt:  [[ 2.08021882e+01  0.00000000e+00]
 [-8.61267703e-03  1.97341222e-02]]
grads:  [1.49188221e-02 1.73853383e+01]
Stock Position:  0.014918822092818728
Bond Position:  [5.90000709]


portfolio before change:  [7.36116246]
curr_Stock_Price:  97.89096033014413
curr_Factors:  [9.78909603e+01 4.46031745e-02]
mat_Sqrt:  [[ 2.06740458e+01  0.00000000e+00]
 [-8.44778546e-03  1.93563082e-02]]
grads:  [ 0.01208719 11.00113905]
Stock Position:  0.012087194888011082
Bond Position:  [6.17793534]


portfolio before change:  [7.34032428]
curr_Stock_Price:  96.10307889423173
curr_Factors:  [9.61030789e+01 4.62747020e-02]
mat_Sqrt:  [[ 2.06732672e+01  0.00000000e+00]
 [-8.60462220e-03  1.97156663e-02]]
grads:  [0.01228539 1.12995694]
Stock Position:  0.01228539166754015
Bond Position:  [6.15966031]


portfolio before change:  [7.34297454]
curr_Stock_Price:  96.25612745434941
curr_Factors:  [9.62561275e+01 4.56682798e-02]
mat_Sqrt:  [[ 2.05700673e+01  0.00000000e+00]
 [-8.54805520e-03  1.95860550e-02]]
grads:  [-0.00749821 -5.18918614]
Stock Position:  -0.007498209210126936
Bond Position:  [8.06472312]


portfolio before change:  [7.33464501]
curr_Stock_Price:  97.5014492858219
curr_Factors:  [9.75014493e+01 4.47725105e-02]
mat_Sqrt:  [[ 2.06308345e+01  0.00000000e+00]
 [-8.46380629e-03  1.93930165e-02]]
grads:  [9.21729335e-03 1.19796073e+01]
Stock Position:  0.009217293348442544
Bond Position:  [6.43594555]


portfolio before change:  [7.3423795]
curr_Stock_Price:  98.25329028781759
curr_Factors:  [9.82532903e+01 4.25931461e-02]
mat_Sqrt:  [[ 2.02776192e+01  0.00000000e+00]
 [-8.25524280e-03  1.89151375e-02]]
grads:  [ 0.00214421 -1.00335667]
Stock Position:  0.0021442125898110467
Bond Position:  [7.13170355]


portfolio before change:  [7.34397262]
curr_Stock_Price:  98.58049925920226
curr_Factors:  [9.85804993e+01 4.24776319e-02]
mat_Sqrt:  [[ 2.03175418e+01  0.00000000e+00]
 [-8.24404094e-03  1.88894708e-02]]
grads:  [-6.67497639e-04  2.34903433e+00]
Stock Position:  -0.0006674976390595703
Bond Position:  [7.40977487]


portfolio before change:  [7.34542954]
curr_Stock_Price:  97.78553377946585
curr_Factors:  [9.77855338e+01 4.22269327e-02]
mat_Sqrt:  [[ 2.00941379e+01  0.00000000e+00]
 [-8.21967714e-03  1.88336463e-02]]
grads:  [2.20445953e-03 2.84866490e+00]
Stock Position:  0.002204459525698254
Bond Position:  [7.12986529]


portfolio before change:  [7.34419098]
curr_Stock_Price:  96.81937972099557
curr_Factors:  [9.68193797e+01 4.18622177e-02]
mat_Sqrt:  [[ 1.98094953e+01  0.00000000e+00]
 [-8.18410339e-03  1.87521366e-02]]
grads:  [1.61015252e-03 2.41410401e+00]
Stock Position:  0.0016101525184275287
Bond Position:  [7.18829701]


portfolio before change:  [7.34480724]
curr_Stock_Price:  96.64403286726773
curr_Factors:  [9.66440329e+01 4.04729297e-02]
mat_Sqrt:  [[ 1.94427354e+01  0.00000000e+00]
 [-8.04715400e-03  1.84383462e-02]]
grads:  [ 0.00789123 -5.76307467]
Stock Position:  0.007891227048935034
Bond Position:  [6.58216723]


portfolio before change:  [7.34167854]
curr_Stock_Price:  96.14328493374771
curr_Factors:  [9.61432849e+01 4.18120957e-02]
mat_Sqrt:  [[ 1.96593849e+01  0.00000000e+00]
 [-8.17920248e-03  1.87409072e-02]]
grads:  [ 0.00214293 -2.01580367]
Stock Position:  0.002142926186612694
Bond Position:  [7.13565058]


portfolio before change:  [7.34311366]
curr_Stock_Price:  96.39672389293905
curr_Factors:  [9.63967239e+01 4.34027090e-02]
mat_Sqrt:  [[ 2.00826349e+01  0.00000000e+00]
 [-8.33332673e-03  1.90940503e-02]]
grads:  [6.00088814e-03 1.05690412e+01]
Stock Position:  0.006000888140363909
Bond Position:  [6.7646477]


portfolio before change:  [7.34310086]
curr_Stock_Price:  96.25367362136816
curr_Factors:  [9.62536736e+01 4.44279945e-02]
mat_Sqrt:  [[ 2.02883005e+01  0.00000000e+00]
 [-8.43117970e-03  1.93182596e-02]]
grads:  [4.25468931e-03 7.28559139e+00]
Stock Position:  0.004254689305987879
Bond Position:  [6.93357139]


portfolio before change:  [7.33891599]
curr_Stock_Price:  95.06636758206419
curr_Factors:  [9.50663676e+01 4.39814897e-02]
mat_Sqrt:  [[ 1.99370945e+01  0.00000000e+00]
 [-8.38870571e-03  1.92209394e-02]]
grads:  [-0.00157243  0.30936189]
Stock Position:  -0.0015724329392215943
Bond Position:  [7.48840148]


portfolio before change:  [7.34057245]
curr_Stock_Price:  94.60825867285595
curr_Factors:  [9.46082587e+01 4.61728444e-02]
mat_Sqrt:  [[ 2.03292971e+01  0.00000000e+00]
 [-8.59514695e-03  1.96939558e-02]]
grads:  [5.61416512e-03 7.59583034e+00]
Stock Position:  0.005614165116623223
Bond Position:  [6.80942606]


portfolio before change:  [7.33647177]
curr_Stock_Price:  93.7262197894743
curr_Factors:  [9.37262198e+01 4.73982310e-02]
mat_Sqrt:  [[ 2.04052616e+01  0.00000000e+00]
 [-8.70845391e-03  1.99535746e-02]]
grads:  [6.06366020e-03 9.05508006e+00]
Stock Position:  0.0060636602031339856
Bond Position:  [6.76814782]


portfolio before change:  [7.3485323]
curr_Stock_Price:  95.57567405438938
curr_Factors:  [9.55756741e+01 4.84310449e-02]
mat_Sqrt:  [[ 2.10333907e+01  0.00000000e+00]
 [-8.80282181e-03  2.01697986e-02]]
grads:  [8.47041748e-03 8.67323455e+00]
Stock Position:  0.008470417480047154
Bond Position:  [6.53896644]


portfolio before change:  [7.35885636]
curr_Stock_Price:  96.69800817948499
curr_Factors:  [9.66980082e+01 4.92628082e-02]
mat_Sqrt:  [[ 2.14623420e+01  0.00000000e+00]
 [-8.87809062e-03  2.03422612e-02]]
grads:  [-5.63044065e-03  6.08711016e+00]
Stock Position:  -0.005630440650834595
Bond Position:  [7.90330876]


portfolio before change:  [7.36555944]
curr_Stock_Price:  95.68297200059372
curr_Factors:  [9.56829720e+01 4.94455875e-02]
mat_Sqrt:  [[ 2.12764137e+01  0.00000000e+00]
 [-8.89454552e-03  2.03799641e-02]]
grads:  [-0.01175335 -0.76608221]
Stock Position:  -0.011753347347395594
Bond Position:  [8.49015464]


portfolio before change:  [7.3586644]
curr_Stock_Price:  96.35991770827057
curr_Factors:  [9.63599177e+01 4.80368070e-02]
mat_Sqrt:  [[ 2.11194929e+01  0.00000000e+00]
 [-8.76692028e-03  2.00875379e-02]]
grads:  [ 0.00503519 -3.94572054]
Stock Position:  0.005035188671145716
Bond Position:  [6.87347403]


portfolio before change:  [7.36065442]
curr_Stock_Price:  96.58449378844423
curr_Factors:  [9.65844938e+01 4.84495836e-02]
mat_Sqrt:  [[ 2.12594699e+01  0.00000000e+00]
 [-8.80450644e-03  2.01736586e-02]]
grads:  [-0.04924084 -5.63768271]
Stock Position:  -0.049240841608472315
Bond Position:  [12.11655618]


portfolio before change:  [7.33728412]
curr_Stock_Price:  97.08986608496352
curr_Factors:  [9.70898661e+01 4.80258369e-02]
mat_Sqrt:  [[ 2.12770480e+01  0.00000000e+00]
 [-8.76591918e-03  2.00852441e-02]]
grads:  [-0.00478723  2.30647756]
Stock Position:  -0.004787225806945069
Bond Position:  [7.80207524]


portfolio before change:  [7.32948445]
curr_Stock_Price:  98.92286856300402
curr_Factors:  [9.89228686e+01 4.84808991e-02]
mat_Sqrt:  [[ 2.17812116e+01  0.00000000e+00]
 [-8.80735140e-03  2.01801772e-02]]
grads:  [-1.33847694e-03 -4.55964306e+00]
Stock Position:  -0.0013384769402366955
Bond Position:  [7.46189043]


portfolio before change:  [7.33238996]
curr_Stock_Price:  97.4490175154989
curr_Factors:  [9.74490175e+01 4.61604122e-02]
mat_Sqrt:  [[ 2.09368964e+01  0.00000000e+00]
 [-8.59398973e-03  1.96913042e-02]]
grads:  [0.00595059 5.06589787]
Stock Position:  0.005950593256228129
Bond Position:  [6.75251049]


portfolio before change:  [7.33631059]
curr_Stock_Price:  97.96602761935596
curr_Factors:  [9.79660276e+01 4.71337239e-02]
mat_Sqrt:  [[ 2.12687210e+01  0.00000000e+00]
 [-8.68412104e-03  1.98978210e-02]]
grads:  [-2.96484661e-03  6.11291190e+00]
Stock Position:  -0.0029648466061745274
Bond Position:  [7.62676483]


portfolio before change:  [7.33701836]
curr_Stock_Price:  98.04887537486101
curr_Factors:  [9.80488754e+01 4.58535004e-02]
mat_Sqrt:  [[ 2.09956278e+01  0.00000000e+00]
 [-8.56537219e-03  1.96257332e-02]]
grads:  [ -0.04026792 -13.62092436]
Stock Position:  -0.040267918262221876
Bond Position:  [11.28524246]


portfolio before change:  [7.26501191]
curr_Stock_Price:  99.8720934579493
curr_Factors:  [9.98720935e+01 4.48123249e-02]
mat_Sqrt:  [[ 2.11418453e+01  0.00000000e+00]
 [-8.46756871e-03  1.94016373e-02]]
grads:  [3.38909903e-03 1.54878328e+01]
Stock Position:  0.003389099030426361
Bond Position:  [6.9265355]


portfolio before change:  [7.26938281]
curr_Stock_Price:  100.9063010140187
curr_Factors:  [1.00906301e+02 4.59874791e-02]
mat_Sqrt:  [[ 2.16390449e+01  0.00000000e+00]
 [-8.57787658e-03  1.96543844e-02]]
grads:  [-3.33165407e-03  5.99093609e+00]
Stock Position:  -0.0033316540709883175
Bond Position:  [7.6055677]


portfolio before change:  [7.27157506]
curr_Stock_Price:  100.53366505541078
curr_Factors:  [1.00533665e+02 4.53245009e-02]
mat_Sqrt:  [[ 2.14031665e+01  0.00000000e+00]
 [-8.51582065e-03  1.95121964e-02]]
grads:  [0.01475154 3.55791015]
Stock Position:  0.014751544585026043
Bond Position:  [5.78854822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.28614827]
Stock Price:  101.47252244989217
PL:  [5.81362582]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.96876219e-01  9.20730927e-01]
 [-3.54360026e-01 -3.63582604e-02]
 [ 9.47149690e-01 -8.55405531e-01]
 [-1.50646551e-01  1.50927728e-01]
 [-1.85389108e-01  9.45159130e-02]
 [ 3.02826266e-01  2.70413856e-01]
 [ 1.46878067e-01 -1.44474343e-01]
 [ 3.99590781e-01 -1.22189541e-02]
 [ 5.98969502e-02  8.01832955e-02]
 [ 3.20048421e-01 -1.51082405e-01]
 [ 7.24241357e-02  2.96397548e-02]
 [-1.19458104e-01 -5.50067369e-02]
 [ 1.12431745e-01  5.67771348e-02]
 [-2.44210777e-01 -3.35425871e-01]
 [ 8.07485252e-02  2.25912633e-01]
 [ 5.37244941e-02 -2.02287324e-02]
 [-4.23899714e-02  8.94180163e-02]
 [-3.13175221e-02  2.99051600e-02]
 [ 1.52321695e-02  5.75889842e-02]
 [ 7.02468483e-02 -9.80855766e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 8.94241255e-02  3.02929392e-01]
 [ 3.60151839e-02  2.82530354e-01]
 [-5.73836321e-02  1.25310260e-01]
 [ 2.03388518e-02  4.74077036e-02]
 [ 6.04122788e-01 -1.73795245e-01]
 [ 2.92714711e-03  9.66422452e-02]
 [-2.07823238e-01  1.47217885e-01]
 [-7.15160543e-02 -1.01508888e-01]
 [ 9.18600679e-02 -6.77916834e-02]
 [-9.51695011e-01 -1.09705677e-01]
 [-1.23048110e-01  5.53273452e-02]
 [-9.07237361e-03 -9.18767231e-02]
 [ 6.78082594e-02  9.55149123e-02]
 [-5.08145244e-02  1.64136152e-01]
 [-1.40525059e+00 -1.29996802e-01]
 [-7.31904627e-02  2.36638562e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.08069681e+00 -2.62303619e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.1197501]
curr_Stock_Price:  101.86944129094901
curr_Factors:  [1.01869441e+02 3.81193809e-02]
mat_Sqrt:  [[ 1.98891784e+01  0.00000000e+00]
 [-7.80967409e-03  1.78942113e-02]]
grads:  [4.51861873e-02 5.14541217e+01]
Stock Position:  0.04518618727732645
Bond Position:  [10.51665845]


portfolio before change:  [15.19186277]
curr_Stock_Price:  103.43624762476864
curr_Factors:  [1.03436248e+02 3.76404666e-02]
mat_Sqrt:  [[ 2.00678228e+01  0.00000000e+00]
 [-7.76046046e-03  1.77814488e-02]]
grads:  [-0.01844884 -2.04472993]
Stock Position:  -0.018448841018094415
Bond Position:  [17.10014165]


portfolio before change:  [15.18931542]
curr_Stock_Price:  103.69019322306066
curr_Factors:  [1.03690193e+02 3.79804947e-02]
mat_Sqrt:  [[ 2.02077515e+01  0.00000000e+00]
 [-7.79543402e-03  1.78615832e-02]]
grads:  [ 2.83960395e-02 -4.78908011e+01]
Stock Position:  0.028396039489025558
Bond Position:  [12.24492459]


portfolio before change:  [15.22268797]
curr_Stock_Price:  104.81154108640071
curr_Factors:  [1.04811541e+02 3.66515468e-02]
mat_Sqrt:  [[ 2.00657437e+01  0.00000000e+00]
 [-7.65783748e-03  1.75463100e-02]]
grads:  [-4.22492637e-03  8.60167914e+00]
Stock Position:  -0.004224926369260013
Bond Position:  [15.66550901]


portfolio before change:  [15.22677387]
curr_Stock_Price:  104.30795995177502
curr_Factors:  [1.04307960e+02 3.76647768e-02]
mat_Sqrt:  [[ 2.02434789e+01  0.00000000e+00]
 [-7.76296611e-03  1.77871899e-02]]
grads:  [-0.00712027  5.31370686]
Stock Position:  -0.007120267302813796
Bond Position:  [15.96947443]


portfolio before change:  [15.22751151]
curr_Stock_Price:  104.48473274390538
curr_Factors:  [1.04484733e+02 3.74081608e-02]
mat_Sqrt:  [[ 2.02085901e+01  0.00000000e+00]
 [-7.73647577e-03  1.77264929e-02]]
grads:  [ 0.02082503 15.25478599]
Stock Position:  0.020825032633680608
Bond Position:  [13.05161354]


portfolio before change:  [15.22639988]
curr_Stock_Price:  104.35300752088321
curr_Factors:  [1.04353008e+02 3.75628663e-02]
mat_Sqrt:  [[ 2.02248045e+01  0.00000000e+00]
 [-7.75245678e-03  1.77631100e-02]]
grads:  [ 4.14462817e-03 -8.13339235e+00]
Stock Position:  0.004144628167333584
Bond Position:  [14.79389547]


portfolio before change:  [15.22491811]
curr_Stock_Price:  103.54928783596556
curr_Factors:  [1.03549288e+02 3.85919687e-02]
mat_Sqrt:  [[ 2.03420905e+01  0.00000000e+00]
 [-7.85793547e-03  1.80047921e-02]]
grads:  [ 0.01938139 -0.67865011]
Stock Position:  0.019381390116797573
Bond Position:  [13.21798897]


portfolio before change:  [15.21275896]
curr_Stock_Price:  102.83667100151835
curr_Factors:  [1.02836671e+02 3.95684463e-02]
mat_Sqrt:  [[ 2.04560845e+01  0.00000000e+00]
 [-7.95672760e-03  1.82311533e-02]]
grads:  [0.00463881 4.39814719]
Stock Position:  0.00463880609913386
Bond Position:  [14.73571958]


portfolio before change:  [15.20692875]
curr_Stock_Price:  101.18273539550852
curr_Factors:  [1.01182735e+02 4.07421680e-02]
mat_Sqrt:  [[ 2.04234207e+01  0.00000000e+00]
 [-8.07387570e-03  1.84995733e-02]]
grads:  [ 0.01244212 -8.16680486]
Stock Position:  0.012442120100975833
Bond Position:  [13.94800101]


portfolio before change:  [15.20199052]
curr_Stock_Price:  100.64570151816271
curr_Factors:  [1.00645702e+02 4.00840873e-02]
mat_Sqrt:  [[ 2.01502868e+01  0.00000000e+00]
 [-8.00840431e-03  1.83495595e-02]]
grads:  [0.00423617 1.61528427]
Stock Position:  0.004236167268634265
Bond Position:  [14.7756385]


portfolio before change:  [15.20346875]
curr_Stock_Price:  100.55863240544834
curr_Factors:  [1.00558632e+02 4.05436921e-02]
mat_Sqrt:  [[ 2.02479475e+01  0.00000000e+00]
 [-8.05418570e-03  1.84544578e-02]]
grads:  [-0.00708541 -2.98067477]
Stock Position:  -0.00708541011068531
Bond Position:  [15.91596791]


portfolio before change:  [15.21747584]
curr_Stock_Price:  98.86254636247746
curr_Factors:  [9.88625464e+01 4.12297946e-02]
mat_Sqrt:  [[ 2.00741598e+01  0.00000000e+00]
 [-8.12204847e-03  1.86099510e-02]]
grads:  [0.00683522 3.0509019 ]
Stock Position:  0.006835220978885398
Bond Position:  [14.54172849]


portfolio before change:  [15.21695726]
curr_Stock_Price:  98.52072777282886
curr_Factors:  [9.85207278e+01 4.23167083e-02]
mat_Sqrt:  [[ 2.02667239e+01  0.00000000e+00]
 [-8.22841013e-03  1.88536561e-02]]
grads:  [ -0.0192731  -17.79102517]
Stock Position:  -0.01927310165676996
Bond Position:  [17.11575727]


portfolio before change:  [15.1974829]
curr_Stock_Price:  99.64218548564207
curr_Factors:  [9.96421855e+01 4.12592181e-02]
mat_Sqrt:  [[ 2.02396846e+01  0.00000000e+00]
 [-8.12494609e-03  1.86165902e-02]]
grads:  [8.86105120e-03 1.21350167e+01]
Stock Position:  0.008861051195042952
Bond Position:  [14.31454839]


portfolio before change:  [15.20573317]
curr_Stock_Price:  100.37131295977183
curr_Factors:  [1.00371313e+02 4.01842704e-02]
mat_Sqrt:  [[ 2.01204481e+01  0.00000000e+00]
 [-8.01840587e-03  1.83724759e-02]]
grads:  [ 0.00223136 -1.10103464]
Stock Position:  0.0022313594227314462
Bond Position:  [14.98176869]


portfolio before change:  [15.20423445]
curr_Stock_Price:  98.8603258041572
curr_Factors:  [9.88603258e+01 4.04732516e-02]
mat_Sqrt:  [[ 1.98886857e+01  0.00000000e+00]
 [-8.04718600e-03  1.84384195e-02]]
grads:  [-1.69179085e-04  4.84954886e+00]
Stock Position:  -0.00016917908481410725
Bond Position:  [15.22095955]


portfolio before change:  [15.20608513]
curr_Stock_Price:  99.16802431564385
curr_Factors:  [9.91680243e+01 4.11782145e-02]
mat_Sqrt:  [[ 2.01235880e+01  0.00000000e+00]
 [-8.11696638e-03  1.85983064e-02]]
grads:  [-9.07683078e-04  1.60795071e+00]
Stock Position:  -0.0009076830784686799
Bond Position:  [15.29609827]


portfolio before change:  [15.20779816]
curr_Stock_Price:  99.38737650802221
curr_Factors:  [9.93873765e+01 4.19943939e-02]
mat_Sqrt:  [[ 2.03669917e+01  0.00000000e+00]
 [-8.19701350e-03  1.87817174e-02]]
grads:  [1.98193545e-03 3.06622568e+00]
Stock Position:  0.001981935448530567
Bond Position:  [15.0108188]


portfolio before change:  [15.20799288]
curr_Stock_Price:  98.53883744182039
curr_Factors:  [9.85388374e+01 4.43709424e-02]
mat_Sqrt:  [[ 2.07566260e+01  0.00000000e+00]
 [-8.42576453e-03  1.93058519e-02]]
grads:  [ 1.32192935e-03 -5.08061376e+00]
Stock Position:  0.0013219293489986886
Bond Position:  [15.0777315]


portfolio before change:  [15.20895667]
curr_Stock_Price:  97.84209305857924
curr_Factors:  [9.78420931e+01 4.32617090e-02]
mat_Sqrt:  [[ 2.03506165e+01  0.00000000e+00]
 [-8.31977970e-03  1.90630101e-02]]
grads:  [ 0.00207014 -1.98174314]
Stock Position:  0.0020701392812003325
Bond Position:  [15.00640991]


portfolio before change:  [15.21279101]
curr_Stock_Price:  98.78812817306859
curr_Factors:  [9.87881282e+01 4.30665197e-02]
mat_Sqrt:  [[ 2.05009811e+01  0.00000000e+00]
 [-8.30098979e-03  1.90199570e-02]]
grads:  [1.08108656e-02 1.59269231e+01]
Stock Position:  0.01081086560083409
Bond Position:  [14.14480583]


portfolio before change:  [15.21331141]
curr_Stock_Price:  98.67270629308017
curr_Factors:  [9.86727063e+01 4.38283820e-02]
mat_Sqrt:  [[ 2.06573572e+01  0.00000000e+00]
 [-8.37409166e-03  1.91874545e-02]]
grads:  [7.71258094e-03 1.47247439e+01]
Stock Position:  0.007712580937479271
Bond Position:  [14.45229018]


portfolio before change:  [15.21564285]
curr_Stock_Price:  98.74075006706092
curr_Factors:  [9.87407501e+01 4.39868038e-02]
mat_Sqrt:  [[ 2.07089283e+01  0.00000000e+00]
 [-8.38921248e-03  1.92221006e-02]]
grads:  [-1.30076788e-04  6.51907212e+00]
Stock Position:  -0.0001300767883381649
Bond Position:  [15.22848673]


portfolio before change:  [15.21739356]
curr_Stock_Price:  99.91675416089952
curr_Factors:  [9.99167542e+01 4.39039563e-02]
mat_Sqrt:  [[ 2.09358282e+01  0.00000000e+00]
 [-8.38130837e-03  1.92039900e-02]]
grads:  [1.95976340e-03 2.46863821e+00]
Stock Position:  0.0019597634048477922
Bond Position:  [15.02158036]


portfolio before change:  [15.21968404]
curr_Stock_Price:  100.12731954091338
curr_Factors:  [1.00127320e+02 4.38438317e-02]
mat_Sqrt:  [[ 2.09655781e+01  0.00000000e+00]
 [-8.37556749e-03  1.91908360e-02]]
grads:  [ 0.02519713 -9.0561581 ]
Stock Position:  0.02519712662075278
Bond Position:  [12.69676329]


portfolio before change:  [15.2077567]
curr_Stock_Price:  99.59096757741617
curr_Factors:  [9.95909676e+01 4.46316675e-02]
mat_Sqrt:  [[ 2.10397952e+01  0.00000000e+00]
 [-8.45048330e-03  1.93624897e-02]]
grads:  [2.14380798e-03 4.99120964e+00]
Stock Position:  0.0021438079774856213
Bond Position:  [14.99425279]


portfolio before change:  [15.20855824]
curr_Stock_Price:  99.09052064835558
curr_Factors:  [9.90905206e+01 4.63109525e-02]
mat_Sqrt:  [[ 2.13242599e+01  0.00000000e+00]
 [-8.60799187e-03  1.97233872e-02]]
grads:  [-6.73280510e-03  7.46412792e+00]
Stock Position:  -0.006732805099199839
Bond Position:  [15.8757154]


portfolio before change:  [15.21552247]
curr_Stock_Price:  98.35091113812477
curr_Factors:  [9.83509111e+01 4.53753297e-02]
mat_Sqrt:  [[ 2.09502054e+01  0.00000000e+00]
 [-8.52059431e-03  1.95231342e-02]]
grads:  [-0.00552826 -5.19941559]
Stock Position:  -0.005528259185820867
Bond Position:  [15.7592318]


portfolio before change:  [15.2211747]
curr_Stock_Price:  97.684843454744
curr_Factors:  [9.76848435e+01 4.53229422e-02]
mat_Sqrt:  [[ 2.07963076e+01  0.00000000e+00]
 [-8.51567422e-03  1.95118609e-02]]
grads:  [ 2.99444271e-03 -3.47438329e+00]
Stock Position:  0.002994442712507866
Bond Position:  [14.92866303]


portfolio before change:  [15.22116565]
curr_Stock_Price:  97.05860181688453
curr_Factors:  [9.70586018e+01 4.25023005e-02]
mat_Sqrt:  [[ 2.00096849e+01  0.00000000e+00]
 [-8.24643443e-03  1.88949550e-02]]
grads:  [-0.04995453 -5.80608298]
Stock Position:  -0.04995453448884415
Bond Position:  [20.06968292]


portfolio before change:  [15.23254396]
curr_Stock_Price:  96.88105146808223
curr_Factors:  [9.68810515e+01 4.16371974e-02]
mat_Sqrt:  [[ 1.97687673e+01  0.00000000e+00]
 [-8.16207791e-03  1.87016699e-02]]
grads:  [-0.00500291  2.95841737]
Stock Position:  -0.005002905607441079
Bond Position:  [15.71723072]


portfolio before change:  [15.23158843]
curr_Stock_Price:  97.46477507010486
curr_Factors:  [9.74647751e+01 4.23671984e-02]
mat_Sqrt:  [[ 2.00614610e+01  0.00000000e+00]
 [-8.23331752e-03  1.88649004e-02]]
grads:  [-2.45100110e-03 -4.87024693e+00]
Stock Position:  -0.002451001099766069
Bond Position:  [15.4704747]


portfolio before change:  [15.23494366]
curr_Stock_Price:  96.88488617442152
curr_Factors:  [9.68848862e+01 4.24463996e-02]
mat_Sqrt:  [[ 1.99607320e+01  0.00000000e+00]
 [-8.24100961e-03  1.88825252e-02]]
grads:  [0.00548549 5.05837601]
Stock Position:  0.005485489457521315
Bond Position:  [14.70348264]


portfolio before change:  [15.22586656]
curr_Stock_Price:  94.89506243281204
curr_Factors:  [9.48950624e+01 4.34501670e-02]
mat_Sqrt:  [[ 1.97805945e+01  0.00000000e+00]
 [-8.33788146e-03  1.91044865e-02]]
grads:  [1.05256518e-03 8.59149772e+00]
Stock Position:  0.0010525651839915818
Bond Position:  [15.12598332]


portfolio before change:  [15.22786266]
curr_Stock_Price:  94.99504109587272
curr_Factors:  [9.49950411e+01 4.21278205e-02]
mat_Sqrt:  [[ 1.94977919e+01  0.00000000e+00]
 [-8.21002514e-03  1.88115308e-02]]
grads:  [-0.07498212 -6.91048502]
Stock Position:  -0.0749821239060464
Bond Position:  [22.3507926]


portfolio before change:  [15.26903051]
curr_Stock_Price:  94.48326810673268
curr_Factors:  [9.44832681e+01 4.36355748e-02]
mat_Sqrt:  [[ 1.97367326e+01  0.00000000e+00]
 [-8.35565196e-03  1.91452038e-02]]
grads:  [1.52442015e-03 1.23602007e+01]
Stock Position:  0.0015244201483913648
Bond Position:  [15.12499831]


portfolio before change:  [15.2713492]
curr_Stock_Price:  94.76399770712163
curr_Factors:  [9.47639977e+01 4.30405109e-02]
mat_Sqrt:  [[ 1.96599352e+01  0.00000000e+00]
 [-8.29848284e-03  1.90142129e-02]]
grads:  [-4.48552929e-03  5.75157989e+00]
Stock Position:  -0.0044855292943136674
Bond Position:  [15.69641589]


portfolio before change:  [15.27384392]
curr_Stock_Price:  94.64527216211484
curr_Factors:  [9.46452722e+01 4.29083545e-02]
mat_Sqrt:  [[ 1.96051358e+01  0.00000000e+00]
 [-8.28573275e-03  1.89849987e-02]]
grads:  [ 0.05453923 -1.38163622]
Stock Position:  0.05453922654235122
Bond Position:  [10.11196398]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.35354253]
Stock Price:  96.08340292685808
PL:  [15.35354253]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-4.34089646e-01 -2.04314178e-01]
 [-1.74940161e-01 -8.42038977e-02]
 [ 8.85074051e-01 -8.48833137e-01]
 [-7.91966069e-03  2.58743531e-01]
 [ 4.99795276e-03 -1.34483906e-01]
 [-7.50348626e-02 -7.00144382e-02]
 [-1.45284941e-01  5.99954447e-02]
 [ 1.81453777e-01 -1.71860603e-01]
 [ 1.64707228e-01  1.43213999e-01]
 [-1.45254936e-01  4.34546066e-01]
 [ 2.27289746e-01  6.87183571e-01]
 [ 5.91721509e-02  3.81174631e-01]
 [ 4.22131759e-01  2.57672641e-02]
 [-6.97088562e-02  1.59036316e-01]
 [ 9.93972048e-02  2.48275770e-01]
 [ 2.88301474e-02  2.83007891e-01]
 [ 1.30660565e-01  3.19329735e-01]
 [ 1.29988502e-01  7.24524300e-02]
 [ 2.75709500e-02 -6.81151797e-02]
 [ 5.62188549e-01 -1.37166182e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 7.64990672e-03 -9.27455389e-02]
 [-1.15496330e-01  1.31371706e-01]
 [ 9.14219316e-02 -4.15511812e-01]
 [ 4.77192051e-02  2.03613909e-01]
 [ 2.46390422e-02  1.61727021e-01]
 [ 1.63469608e-02  1.59995549e-01]
 [-1.48021136e-01  6.44357733e-02]
 [-5.32973288e-01  1.21806616e-01]
 [ 2.62118417e-01 -1.06653111e-01]
 [-1.44694776e+00 -1.63238987e-01]
 [ 2.56475642e-01  5.01196941e-01]
 [-3.90219407e-03 -1.29710324e-01]
 [ 5.14785538e-03  6.04371002e-02]
 [-3.35132559e-02  1.67604660e-01]
 [-2.15076301e+00  2.25785608e-02]
 [-1.05102335e-01  1.60549187e-01]
 [-1.35130765e-01  7.46584589e-03]
 [ 1.30548783e+00 -5.54772898e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.1344472]
curr_Stock_Price:  98.21636661411449
curr_Factors:  [9.82163666e+01 4.11012561e-02]
mat_Sqrt:  [[ 1.99118408e+01  0.00000000e+00]
 [-8.10937789e-03  1.85809190e-02]]
grads:  [ -0.02627882 -10.99591349]
Stock Position:  -0.026278819202886168
Bond Position:  [-6.55343706]


portfolio before change:  [-9.09942277]
curr_Stock_Price:  96.85239150656437
curr_Factors:  [9.68523915e+01 4.01479841e-02]
mat_Sqrt:  [[ 1.94062768e+01  0.00000000e+00]
 [-8.01478475e-03  1.83641789e-02]]
grads:  [-0.01090831 -4.5852253 ]
Stock Position:  -0.010908313716310191
Bond Position:  [-8.0429265]


portfolio before change:  [-9.10422967]
curr_Stock_Price:  97.20088443693662
curr_Factors:  [9.72008844e+01 4.21336389e-02]
mat_Sqrt:  [[ 1.99519203e+01  0.00000000e+00]
 [-8.21059208e-03  1.88128299e-02]]
grads:  [ 2.57926501e-02 -4.51199072e+01]
Stock Position:  0.025792650061745928
Bond Position:  [-11.61129807]


portfolio before change:  [-9.12248659]
curr_Stock_Price:  96.54932633244877
curr_Factors:  [9.65493263e+01 4.29147477e-02]
mat_Sqrt:  [[ 2.00010378e+01  0.00000000e+00]
 [-8.28635000e-03  1.89864131e-02]]
grads:  [5.24999130e-03 1.36278259e+01]
Stock Position:  0.005249991297548646
Bond Position:  [-9.62936971]


portfolio before change:  [-9.12787579]
curr_Stock_Price:  95.75209483813586
curr_Factors:  [9.57520948e+01 4.36616015e-02]
mat_Sqrt:  [[ 2.00077437e+01  0.00000000e+00]
 [-8.35814348e-03  1.91509126e-02]]
grads:  [-2.68374268e-03 -7.02232362e+00]
Stock Position:  -0.00268374267688947
Bond Position:  [-8.87090181]


portfolio before change:  [-9.12954066]
curr_Stock_Price:  95.95924423230133
curr_Factors:  [9.59592442e+01 4.33371856e-02]
mat_Sqrt:  [[ 1.99763975e+01  0.00000000e+00]
 [-8.32703410e-03  1.90796320e-02]]
grads:  [-0.00528582 -3.66959059]
Stock Position:  -0.005285821364293462
Bond Position:  [-8.62231723]


portfolio before change:  [-9.12940482]
curr_Stock_Price:  95.72963140856743
curr_Factors:  [9.57296314e+01 4.41411580e-02]
mat_Sqrt:  [[ 2.01126015e+01  0.00000000e+00]
 [-8.40391890e-03  1.92557972e-02]]
grads:  [-0.0059217   3.11570817]
Stock Position:  -0.005921699522634641
Bond Position:  [-8.56252271]


portfolio before change:  [-9.12555383]
curr_Stock_Price:  94.89855673937733
curr_Factors:  [9.48985567e+01 4.34498470e-02]
mat_Sqrt:  [[ 1.97812501e+01  0.00000000e+00]
 [-8.33785076e-03  1.91044161e-02]]
grads:  [ 5.38124035e-03 -8.99585739e+00]
Stock Position:  0.0053812403531156155
Bond Position:  [-9.63622577]


portfolio before change:  [-9.12461707]
curr_Stock_Price:  95.29648715733694
curr_Factors:  [9.52964872e+01 4.28746933e-02]
mat_Sqrt:  [[ 1.97322862e+01  0.00000000e+00]
 [-8.28248207e-03  1.89775505e-02]]
grads:  [0.01151468 7.54649548]
Stock Position:  0.011514679047031217
Bond Position:  [-10.22192554]


portfolio before change:  [-9.14908629]
curr_Stock_Price:  93.28241475322642
curr_Factors:  [9.32824148e+01 4.50821896e-02]
mat_Sqrt:  [[ 1.98062511e+01  0.00000000e+00]
 [-8.49302675e-03  1.94599690e-02]]
grads:  [2.24154056e-03 2.23302548e+01]
Stock Position:  0.002241540564094355
Bond Position:  [-9.35818261]


portfolio before change:  [-9.1518604]
curr_Stock_Price:  92.56671782157322
curr_Factors:  [9.25667178e+01 4.39920653e-02]
mat_Sqrt:  [[ 1.94152077e+01  0.00000000e+00]
 [-8.38971421e-03  1.92232502e-02]]
grads:  [2.71540358e-02 3.57475226e+01]
Stock Position:  0.027154035775531788
Bond Position:  [-11.66542037]


portfolio before change:  [-9.16989373]
curr_Stock_Price:  91.95630918679173
curr_Factors:  [9.19563092e+01 4.63981469e-02]
mat_Sqrt:  [[ 1.98075997e+01  0.00000000e+00]
 [-8.61609163e-03  1.97419461e-02]]
grads:  [1.1386054e-02 1.9307855e+01]
Stock Position:  0.011386053958988146
Bond Position:  [-10.21691323]


portfolio before change:  [-9.16580778]
curr_Stock_Price:  92.42733654797043
curr_Factors:  [9.24273365e+01 4.74282056e-02]
mat_Sqrt:  [[ 2.01288417e+01  0.00000000e+00]
 [-8.71120709e-03  1.99598829e-02]]
grads:  [0.02153018 1.29095267]
Stock Position:  0.021530176517325667
Bond Position:  [-11.15578465]


portfolio before change:  [-9.21920646]
curr_Stock_Price:  90.0119302696825
curr_Factors:  [9.00119303e+01 4.93064529e-02]
mat_Sqrt:  [[ 1.99871999e+01  0.00000000e+00]
 [-8.88202255e-03  2.03512703e-02]]
grads:  [-1.49954784e-05  7.81456456e+00]
Stock Position:  -1.4995478379919302e-05
Bond Position:  [-9.21785669]


portfolio before change:  [-9.22038848]
curr_Stock_Price:  91.99334671848165
curr_Factors:  [9.19933467e+01 4.92913791e-02]
mat_Sqrt:  [[ 2.04240518e+01  0.00000000e+00]
 [-8.88066476e-03  2.03481592e-02]]
grads:  [1.01720088e-02 1.22013872e+01]
Stock Position:  0.010172008775498068
Bond Position:  [-10.15614561]


portfolio before change:  [-9.21891562]
curr_Stock_Price:  92.26295484489515
curr_Factors:  [9.22629548e+01 5.06204000e-02]
mat_Sqrt:  [[ 2.07582217e+01  0.00000000e+00]
 [-8.99959110e-03  2.06206537e-02]]
grads:  [7.33901581e-03 1.37244869e+01]
Stock Position:  0.007339015814712231
Bond Position:  [-9.89603491]


portfolio before change:  [-9.20667195]
curr_Stock_Price:  94.09981622443476
curr_Factors:  [9.40998162e+01 4.95715482e-02]
mat_Sqrt:  [[ 2.09510125e+01  0.00000000e+00]
 [-8.90586757e-03  2.04059061e-02]]
grads:  [1.28885173e-02 1.56488878e+01]
Stock Position:  0.012888517299830312
Bond Position:  [-10.41947906]


portfolio before change:  [-9.20962442]
curr_Stock_Price:  93.97179906091922
curr_Factors:  [9.39717991e+01 4.97493571e-02]
mat_Sqrt:  [[ 2.09600000e+01  0.00000000e+00]
 [-8.92182556e-03  2.04424705e-02]]
grads:  [0.00771037 3.54421106]
Stock Position:  0.0077103690453396235
Bond Position:  [-9.93418167]


portfolio before change:  [-9.21540516]
curr_Stock_Price:  93.3831252929619
curr_Factors:  [9.33831253e+01 4.78691260e-02]
mat_Sqrt:  [[ 2.04313072e+01  0.00000000e+00]
 [-8.75160566e-03  2.00524477e-02]]
grads:  [-1.05570904e-04 -3.39685113e+00]
Stock Position:  -0.00010557090440039856
Bond Position:  [-9.20554662]


portfolio before change:  [-9.21633951]
curr_Stock_Price:  91.33318793023867
curr_Factors:  [9.13331879e+01 4.71429273e-02]
mat_Sqrt:  [[ 1.98306473e+01  0.00000000e+00]
 [-8.68496883e-03  1.98997635e-02]]
grads:  [ 0.02533071 -6.89285486]
Stock Position:  0.025330707171250095
Bond Position:  [-11.52987375]


portfolio before change:  [-9.1936991]
curr_Stock_Price:  92.28388139359723
curr_Factors:  [9.22838814e+01 4.62044655e-02]
mat_Sqrt:  [[ 1.98366270e+01  0.00000000e+00]
 [-8.59808960e-03  1.97006982e-02]]
grads:  [ 0.00212378 -1.91759649]
Stock Position:  0.0021237789359469144
Bond Position:  [-9.38968966]


portfolio before change:  [-9.19964956]
curr_Stock_Price:  90.03473801120646
curr_Factors:  [9.00347380e+01 4.70429541e-02]
mat_Sqrt:  [[ 1.95279834e+01  0.00000000e+00]
 [-8.67575510e-03  1.98786522e-02]]
grads:  [-1.68105248e-03 -4.66558486e+00]
Stock Position:  -0.0016810524785124477
Bond Position:  [-9.04829644]


portfolio before change:  [-9.20079307]
curr_Stock_Price:  90.04211353526158
curr_Factors:  [9.00421135e+01 4.77659424e-02]
mat_Sqrt:  [[ 1.96790829e+01  0.00000000e+00]
 [-8.74216837e-03  2.00308242e-02]]
grads:  [-2.95547397e-03  6.55847733e+00]
Stock Position:  -0.0029554739689461253
Bond Position:  [-8.93467595]


portfolio before change:  [-9.20316968]
curr_Stock_Price:  90.46834147886223
curr_Factors:  [9.04683415e+01 4.58333699e-02]
mat_Sqrt:  [[ 1.93681225e+01  0.00000000e+00]
 [-8.56349180e-03  1.96214247e-02]]
grads:  [-4.64279851e-03 -2.11764343e+01]
Stock Position:  -0.004642798509574295
Bond Position:  [-8.7831434]


portfolio before change:  [-9.21065852]
curr_Stock_Price:  91.84485505788197
curr_Factors:  [9.18448551e+01 4.56691066e-02]
mat_Sqrt:  [[ 1.96275499e+01  0.00000000e+00]
 [-8.54813258e-03  1.95862323e-02]]
grads:  [6.95876973e-03 1.03957671e+01]
Stock Position:  0.006958769731649775
Bond Position:  [-9.84978571]


portfolio before change:  [-9.21565678]
curr_Stock_Price:  91.3035284278267
curr_Factors:  [9.13035284e+01 4.80278435e-02]
mat_Sqrt:  [[ 2.00094018e+01  0.00000000e+00]
 [-8.76610230e-03  2.00856637e-02]]
grads:  [4.75888794e-03 8.05186342e+00]
Stock Position:  0.004758887937303411
Bond Position:  [-9.65016004]


portfolio before change:  [-9.21988378]
curr_Stock_Price:  90.66879044927657
curr_Factors:  [9.06687904e+01 4.83729240e-02]
mat_Sqrt:  [[ 1.99415537e+01  0.00000000e+00]
 [-8.79753820e-03  2.01576924e-02]]
grads:  [4.32136555e-03 7.93719569e+00]
Stock Position:  0.004321365548018347
Bond Position:  [-9.61169676]


portfolio before change:  [-9.21909198]
curr_Stock_Price:  91.13006449522683
curr_Factors:  [9.11300645e+01 4.63009011e-02]
mat_Sqrt:  [[ 1.96090430e+01  0.00000000e+00]
 [-8.60705767e-03  1.97212466e-02]]
grads:  [-0.00611448  3.26732759]
Stock Position:  -0.006114477823303868
Bond Position:  [-8.66187922]


portfolio before change:  [-9.2186147]
curr_Stock_Price:  90.87491818396332
curr_Factors:  [9.08749182e+01 4.77975207e-02]
mat_Sqrt:  [[ 1.98676599e+01  0.00000000e+00]
 [-8.74505764e-03  2.00374443e-02]]
grads:  [-0.02415043  6.0789497 ]
Stock Position:  -0.02415042959891863
Bond Position:  [-7.02394638]


portfolio before change:  [-9.2481818]
curr_Stock_Price:  92.0628494907437
curr_Factors:  [9.20628495e+01 4.71278476e-02]
mat_Sqrt:  [[ 1.99858772e+01  0.00000000e+00]
 [-8.68357969e-03  1.98965806e-02]]
grads:  [ 0.01078618 -5.36037386]
Stock Position:  0.01078617570088083
Bond Position:  [-10.24118787]


portfolio before change:  [-9.24830551]
curr_Stock_Price:  92.17007097239818
curr_Factors:  [9.21700710e+01 4.73075666e-02]
mat_Sqrt:  [[ 2.00472694e+01  0.00000000e+00]
 [-8.70012107e-03  1.99344817e-02]]
grads:  [-0.07573057 -8.18877507]
Stock Position:  -0.07573056783981762
Bond Position:  [-2.2682137]


portfolio before change:  [-9.22993188]
curr_Stock_Price:  91.9237083231762
curr_Factors:  [9.19237083e+01 4.70106393e-02]
mat_Sqrt:  [[ 1.99308405e+01  0.00000000e+00]
 [-8.67277480e-03  1.98718235e-02]]
grads:  [2.38432453e-02 2.52214871e+01]
Stock Position:  0.023843245321259286
Bond Position:  [-11.4216914]


portfolio before change:  [-9.19730441]
curr_Stock_Price:  93.35200677041905
curr_Factors:  [9.33520068e+01 4.56698532e-02]
mat_Sqrt:  [[ 1.99497963e+01  0.00000000e+00]
 [-8.54820245e-03  1.95863924e-02]]
grads:  [-3.03323501e-03 -6.62247144e+00]
Stock Position:  -0.0030332350096970244
Bond Position:  [-8.91414583]


portfolio before change:  [-9.19713949]
curr_Stock_Price:  92.9302610012328
curr_Factors:  [9.29302610e+01 4.67705801e-02]
mat_Sqrt:  [[ 2.00975693e+01  0.00000000e+00]
 [-8.65060277e-03  1.98210210e-02]]
grads:  [1.56858612e-03 3.04914163e+00]
Stock Position:  0.0015685861240206961
Bond Position:  [-9.34290861]


portfolio before change:  [-9.19770095]
curr_Stock_Price:  93.3168987832031
curr_Factors:  [9.33168988e+01 4.63680815e-02]
mat_Sqrt:  [[ 2.00941602e+01  0.00000000e+00]
 [-8.61329962e-03  1.97355488e-02]]
grads:  [1.97248427e-03 8.49252597e+00]
Stock Position:  0.0019724842654348096
Bond Position:  [-9.38176707]


portfolio before change:  [-9.20218016]
curr_Stock_Price:  91.64063190993548
curr_Factors:  [9.16406319e+01 4.67367640e-02]
mat_Sqrt:  [[ 1.98115016e+01  0.00000000e+00]
 [-8.64747492e-03  1.98138542e-02]]
grads:  [-0.10806394  1.13953401]
Stock Position:  -0.10806393976586835
Bond Position:  [0.70086757]


portfolio before change:  [-9.21569066]
curr_Stock_Price:  91.76646587213045
curr_Factors:  [9.17664659e+01 4.67939601e-02]
mat_Sqrt:  [[ 1.98508408e+01  0.00000000e+00]
 [-8.65276465e-03  1.98259745e-02]]
grads:  [-1.76480812e-03  8.09792161e+00]
Stock Position:  -0.001764808122195954
Bond Position:  [-9.05374045]


portfolio before change:  [-9.21729909]
curr_Stock_Price:  92.03654848168397
curr_Factors:  [9.20365485e+01 4.82001630e-02]
mat_Sqrt:  [[ 2.02061967e+01  0.00000000e+00]
 [-8.78181421e-03  2.01216642e-02]]
grads:  [-0.00652633  0.37103521]
Stock Position:  -0.006526334675367859
Bond Position:  [-8.61663777]


portfolio before change:  [-9.22234334]
curr_Stock_Price:  92.64441015077576
curr_Factors:  [9.26444102e+01 4.97882147e-02]
mat_Sqrt:  [[ 2.06720001e+01  0.00000000e+00]
 [-8.92530916e-03  2.04504524e-02]]
grads:  [ 0.06198121 -2.71276589]
Stock Position:  0.061981209198839905
Bond Position:  [-14.96455591]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.30061396]
Stock Price:  91.41177956786682
PL:  [-9.30061396]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.75790767e-01 -1.71444609e-01]
 [-1.76482954e-01 -7.88559485e-02]
 [ 7.77810035e-01 -6.54779747e-01]
 [ 2.57130472e-02  2.28420355e-02]
 [-1.02491161e-01  4.43779082e-02]
 [-4.64689804e-02 -3.96205305e-02]
 [ 5.51769356e-03  3.13857201e-01]
 [ 8.57895006e-03 -6.01928420e-02]
 [ 1.66338509e-01  8.98065186e-02]
 [ 1.21164369e-01  6.12090885e-02]
 [ 9.74258175e-02  1.17941414e-01]
 [-4.27559763e-02  9.01290314e-02]
 [-2.46764245e-02  1.11239323e-01]
 [-4.81316683e-01 -6.20818268e-01]
 [ 6.90947099e-02  1.92444991e-01]
 [ 5.42600951e-02 -2.05699920e-02]
 [-5.24002740e-02  2.38597171e-01]
 [-1.28835625e-01  3.27601856e-02]
 [ 1.50458913e-02  6.22142993e-02]
 [-6.49992915e-02 -5.08588840e-02]
 [ 2.39211789e-01  2.09973076e-01]
 [ 3.34101819e-02  1.21836632e-02]
 [ 3.86413332e-03  1.98987538e-01]
 [ 4.47784538e-02  1.72295959e-01]
 [ 5.25013751e-02  1.13119539e-01]
 [ 7.86235955e-01 -6.29324217e-01]
 [-5.16222949e-01  6.51557487e-01]
 [ 1.24044798e-01 -1.13414052e-02]
 [-4.68122226e-02 -6.32282481e-02]
 [ 1.40299514e-02 -1.84339813e-01]
 [-1.01266671e-01 -7.72695261e-02]
 [-1.17917441e-01 -6.95048948e-04]
 [ 1.88738793e-01  2.01632082e-01]
 [ 2.03614696e-01  3.94600669e-02]
 [-2.32922534e-01 -2.13038274e-01]
 [ 1.07515227e-01 -3.10876259e-01]
 [-1.40049369e-01  2.34097927e-01]
 [-1.23323827e-01  1.17855759e-01]
 [ 6.28379724e-02  9.73420445e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.01816121]
curr_Stock_Price:  98.53511353723067
curr_Factors:  [9.85351135e+01 3.94310530e-02]
mat_Sqrt:  [[ 1.95663676e+01  0.00000000e+00]
 [-7.94290154e-03  1.81994738e-02]]
grads:  [-0.0230301  -9.42030584]
Stock Position:  -0.023030096209818003
Bond Position:  [-4.74888806]


portfolio before change:  [-7.06262861]
curr_Stock_Price:  100.44017511492153
curr_Factors:  [1.00440175e+02 3.97591355e-02]
mat_Sqrt:  [[ 2.00274625e+01  0.00000000e+00]
 [-7.97587718e-03  1.82750304e-02]]
grads:  [-0.01053047 -4.31495579]
Stock Position:  -0.0105304659409817
Bond Position:  [-6.00494676]


portfolio before change:  [-7.07551565]
curr_Stock_Price:  101.59267671090018
curr_Factors:  [1.01592677e+02 4.02501529e-02]
mat_Sqrt:  [[ 2.03819706e+01  0.00000000e+00]
 [-8.02497631e-03  1.83875307e-02]]
grads:  [ 2.41409791e-02 -3.56099880e+01]
Stock Position:  0.024140979056929055
Bond Position:  [-9.52806233]


portfolio before change:  [-7.08980836]
curr_Stock_Price:  101.04996352723323
curr_Factors:  [1.01049964e+02 3.99860110e-02]
mat_Sqrt:  [[ 2.02064584e+01  0.00000000e+00]
 [-7.99860097e-03  1.83270972e-02]]
grads:  [0.00176588 1.24635316]
Stock Position:  0.0017658774289005877
Bond Position:  [-7.26825021]


portfolio before change:  [-7.09063154]
curr_Stock_Price:  101.09832850921319
curr_Factors:  [1.01098329e+02 4.00006885e-02]
mat_Sqrt:  [[ 2.02198397e+01  0.00000000e+00]
 [-8.00006885e-03  1.83304605e-02]]
grads:  [-0.00411097  2.42099254]
Stock Position:  -0.004110965015095747
Bond Position:  [-6.67501985]


portfolio before change:  [-7.09160016]
curr_Stock_Price:  101.1309708572159
curr_Factors:  [1.01130971e+02 4.02439235e-02]
mat_Sqrt:  [[ 2.02877710e+01  0.00000000e+00]
 [-8.02435528e-03  1.83861077e-02]]
grads:  [-0.00314282 -2.1549167 ]
Stock Position:  -0.00314281926692121
Bond Position:  [-6.7737638]


portfolio before change:  [-7.09246569]
curr_Stock_Price:  101.13693878526111
curr_Factors:  [1.01136939e+02 3.91353842e-02]
mat_Sqrt:  [[ 2.00075820e+01  0.00000000e+00]
 [-7.91306608e-03  1.81311121e-02]]
grads:  [7.12211032e-03 1.73104219e+01]
Stock Position:  0.007122110324122127
Bond Position:  [-7.81277413]


portfolio before change:  [-7.10569021]
curr_Stock_Price:  99.41724294307008
curr_Factors:  [9.94172429e+01 4.17122583e-02]
mat_Sqrt:  [[ 2.03045592e+01  0.00000000e+00]
 [-8.16943163e-03  1.87185194e-02]]
grads:  [-8.71299875e-04 -3.21568392e+00]
Stock Position:  -0.0008712998747802775
Bond Position:  [-7.01906798]


portfolio before change:  [-7.10566145]
curr_Stock_Price:  98.37717991789012
curr_Factors:  [9.83771799e+01 4.28031924e-02]
mat_Sqrt:  [[ 2.03531882e+01  0.00000000e+00]
 [-8.27557296e-03  1.89617197e-02]]
grads:  [0.01009833 4.73620114]
Stock Position:  0.010098333693354049
Bond Position:  [-8.09910704]


portfolio before change:  [-7.11205756]
curr_Stock_Price:  97.84405646566415
curr_Factors:  [9.78440565e+01 4.36620614e-02]
mat_Sqrt:  [[ 2.04449742e+01  0.00000000e+00]
 [-8.35818749e-03  1.91510134e-02]]
grads:  [0.00723299 3.19612791]
Stock Position:  0.007232985666528318
Bond Position:  [-7.81976221]


portfolio before change:  [-7.09983826]
curr_Stock_Price:  99.66859089607553
curr_Factors:  [9.96685909e+01 4.29126529e-02]
mat_Sqrt:  [[ 2.06467168e+01  0.00000000e+00]
 [-8.28614776e-03  1.89859497e-02]]
grads:  [0.00721178 6.21203658]
Stock Position:  0.007211784425644521
Bond Position:  [-7.81862665]


portfolio before change:  [-7.10256354]
curr_Stock_Price:  99.42622464497192
curr_Factors:  [9.94262246e+01 4.28041701e-02]
mat_Sqrt:  [[ 2.05704593e+01  0.00000000e+00]
 [-8.27566748e-03  1.89619363e-02]]
grads:  [-1.66279330e-04  4.75315547e+00]
Stock Position:  -0.0001662793297370252
Bond Position:  [-7.08603101]


portfolio before change:  [-7.10358642]
curr_Stock_Price:  100.25059058279746
curr_Factors:  [1.00250591e+02 4.32399667e-02]
mat_Sqrt:  [[ 2.08463303e+01  0.00000000e+00]
 [-8.31768878e-03  1.90582192e-02]]
grads:  [1.1451606e-03 5.8368162e+00]
Stock Position:  0.0011451605969552783
Bond Position:  [-7.21838945]


portfolio before change:  [-7.10323522]
curr_Stock_Price:  101.34524398394502
curr_Factors:  [1.01345244e+02 4.31782095e-02]
mat_Sqrt:  [[ 2.10589002e+01  0.00000000e+00]
 [-8.31174682e-03  1.90446045e-02]]
grads:  [ -0.0357219  -32.59811817]
Stock Position:  -0.03572190283978929
Bond Position:  [-3.48299027]


portfolio before change:  [-7.12089818]
curr_Stock_Price:  101.82751271612615
curr_Factors:  [1.01827513e+02 4.23855426e-02]
mat_Sqrt:  [[ 2.09639931e+01  0.00000000e+00]
 [-8.23509976e-03  1.88689840e-02]]
grads:  [7.30226292e-03 1.01990118e+01]
Stock Position:  0.007302262919822618
Bond Position:  [-7.86446945]


portfolio before change:  [-7.12831769]
curr_Stock_Price:  100.9460895921803
curr_Factors:  [1.00946090e+02 4.19603151e-02]
mat_Sqrt:  [[ 2.06780162e+01  0.00000000e+00]
 [-8.19368685e-03  1.87740951e-02]]
grads:  [ 0.00218989 -1.09565824]
Stock Position:  0.00218989163444507
Bond Position:  [-7.34937868]


portfolio before change:  [-7.12924848]
curr_Stock_Price:  100.94057818304067
curr_Factors:  [1.00940578e+02 4.17995061e-02]
mat_Sqrt:  [[ 2.06372280e+01  0.00000000e+00]
 [-8.17797100e-03  1.87380856e-02]]
grads:  [2.50673533e-03 1.27332736e+01]
Stock Position:  0.0025067353303390677
Bond Position:  [-7.3822798]


portfolio before change:  [-7.12914801]
curr_Stock_Price:  101.34880524150985
curr_Factors:  [1.01348805e+02 4.14815287e-02]
mat_Sqrt:  [[ 2.06417260e+01  0.00000000e+00]
 [-8.14680587e-03  1.86666773e-02]]
grads:  [-0.00554885  1.75500895]
Stock Position:  -0.005548853236318221
Bond Position:  [-6.56677836]


portfolio before change:  [-7.12632634]
curr_Stock_Price:  100.69235037807076
curr_Factors:  [1.00692350e+02 3.99123286e-02]
mat_Sqrt:  [[ 2.01163884e+01  0.00000000e+00]
 [-7.99122805e-03  1.83102037e-02]]
grads:  [2.09771440e-03 3.39779395e+00]
Stock Position:  0.0020977144030480455
Bond Position:  [-7.33755013]


portfolio before change:  [-7.1257204]
curr_Stock_Price:  101.41846887624797
curr_Factors:  [1.01418469e+02 4.03651960e-02]
mat_Sqrt:  [[ 2.03760774e+01  0.00000000e+00]
 [-8.03643662e-03  1.84137896e-02]]
grads:  [-0.00427933 -2.76199985]
Stock Position:  -0.004279328467079173
Bond Position:  [-6.69171746]


portfolio before change:  [-7.13401446]
curr_Stock_Price:  103.16115980629836
curr_Factors:  [1.03161160e+02 4.09137962e-02]
mat_Sqrt:  [[ 2.08665718e+01  0.00000000e+00]
 [-8.09086361e-03  1.85384975e-02]]
grads:  [ 0.01585558 11.32632653]
Stock Position:  0.015855577742753615
Bond Position:  [-8.76969425]


portfolio before change:  [-7.12877577]
curr_Stock_Price:  103.56070192823233
curr_Factors:  [1.03560702e+02 4.00905145e-02]
mat_Sqrt:  [[ 2.07355615e+01  0.00000000e+00]
 [-8.00904633e-03  1.83510305e-02]]
grads:  [0.00186769 0.66392256]
Stock Position:  0.0018676884373181048
Bond Position:  [-7.3221949]


portfolio before change:  [-7.13074598]
curr_Stock_Price:  102.99589646003349
curr_Factors:  [1.02995896e+02 3.95309740e-02]
mat_Sqrt:  [[ 2.04780538e+01  0.00000000e+00]
 [-7.95295910e-03  1.82225185e-02]]
grads:  [4.42959158e-03 1.09198702e+01]
Stock Position:  0.004429591580482107
Bond Position:  [-7.58697574]


portfolio before change:  [-7.13348655]
curr_Stock_Price:  102.59131447862585
curr_Factors:  [1.02591314e+02 3.86570078e-02]
mat_Sqrt:  [[ 2.01708738e+01  0.00000000e+00]
 [-7.86455418e-03  1.80199574e-02]]
grads:  [5.94791166e-03 9.56139659e+00]
Stock Position:  0.005947911655132483
Bond Position:  [-7.74369062]


portfolio before change:  [-7.12674447]
curr_Stock_Price:  103.88758396231182
curr_Factors:  [1.03887584e+02 3.90670131e-02]
mat_Sqrt:  [[ 2.05337727e+01  0.00000000e+00]
 [-7.90615083e-03  1.81152673e-02]]
grads:  [4.96113358e-03 6.24443111e+00]
Stock Position:  0.00496113358063498
Bond Position:  [-7.64214465]


portfolio before change:  [-7.11922441]
curr_Stock_Price:  105.5959411081698
curr_Factors:  [1.05595941e+02 3.68555070e-02]
mat_Sqrt:  [[ 2.02720851e+01  0.00000000e+00]
 [-7.67911526e-03  1.75950635e-02]]
grads:  [ 2.52355072e-02 -3.57670899e+01]
Stock Position:  0.02523550720443839
Bond Position:  [-9.78399155]


portfolio before change:  [-7.11606051]
curr_Stock_Price:  105.76978256923807
curr_Factors:  [1.05769783e+02 3.69921133e-02]
mat_Sqrt:  [[ 2.03430555e+01  0.00000000e+00]
 [-7.69333356e-03  1.76276417e-02]]
grads:  [-1.13974987e-02  3.69622606e+01]
Stock Position:  -0.01139749872458026
Bond Position:  [-5.91054955]


portfolio before change:  [-7.11935319]
curr_Stock_Price:  105.99385086967875
curr_Factors:  [1.05993851e+02 3.71279947e-02]
mat_Sqrt:  [[ 2.04235587e+01  0.00000000e+00]
 [-7.70745040e-03  1.76599874e-02]]
grads:  [ 0.00583126 -0.64220913]
Stock Position:  0.005831256192376537
Bond Position:  [-7.73743049]


portfolio before change:  [-7.12716479]
curr_Stock_Price:  104.82011421368891
curr_Factors:  [1.04820114e+02 3.67451385e-02]
mat_Sqrt:  [[ 2.00929902e+01  0.00000000e+00]
 [-7.66760859e-03  1.75686984e-02]]
grads:  [-0.00370315 -3.59891477]
Stock Position:  -0.0037031468008109827
Bond Position:  [-6.73900052]


portfolio before change:  [-7.12729598]
curr_Stock_Price:  104.628049446168
curr_Factors:  [1.04628049e+02 3.66759903e-02]
mat_Sqrt:  [[ 2.00372932e+01  0.00000000e+00]
 [-7.66039063e-03  1.75521599e-02]]
grads:  [-3.31494568e-03 -1.05024005e+01]
Stock Position:  -0.003314945683342533
Bond Position:  [-6.78045968]


portfolio before change:  [-7.12800585]
curr_Stock_Price:  104.58649830581764
curr_Factors:  [1.04586498e+02 3.73474639e-02]
mat_Sqrt:  [[ 2.02118553e+01  0.00000000e+00]
 [-7.73019678e-03  1.77121059e-02]]
grads:  [-0.00667875 -4.36252619]
Stock Position:  -0.006678746469814768
Bond Position:  [-6.42949914]


portfolio before change:  [-7.1166801]
curr_Stock_Price:  102.77036568707271
curr_Factors:  [1.02770366e+02 3.82814288e-02]
mat_Sqrt:  [[ 2.01076803e+01  0.00000000e+00]
 [-7.82625620e-03  1.79322057e-02]]
grads:  [-0.00587938 -0.03875981]
Stock Position:  -0.005879384558867566
Bond Position:  [-6.51245359]


portfolio before change:  [-7.12710617]
curr_Stock_Price:  104.40522464425457
curr_Factors:  [1.04405225e+02 3.85428067e-02]
mat_Sqrt:  [[ 2.04971699e+01  0.00000000e+00]
 [-7.85292880e-03  1.79933203e-02]]
grads:  [ 0.01350129 11.20594075]
Stock Position:  0.013501290637268454
Bond Position:  [-8.53671145]


portfolio before change:  [-7.13446975]
curr_Stock_Price:  103.93886694542806
curr_Factors:  [1.03938867e+02 4.07230353e-02]
mat_Sqrt:  [[ 2.09748106e+01  0.00000000e+00]
 [-8.07197971e-03  1.84952290e-02]]
grads:  [0.01052865 2.13352681]
Stock Position:  0.010528651950788953
Bond Position:  [-8.22880591]


portfolio before change:  [-7.1349595]
curr_Stock_Price:  103.99005258534302
curr_Factors:  [1.03990053e+02 4.02754942e-02]
mat_Sqrt:  [[ 2.08695093e+01  0.00000000e+00]
 [-8.02750215e-03  1.83933181e-02]]
grads:  [ -0.01561609 -11.58237313]
Stock Position:  -0.015616086355035646
Bond Position:  [-5.51104186]


portfolio before change:  [-7.12904433]
curr_Stock_Price:  103.56714927265733
curr_Factors:  [1.03567149e+02 4.13116868e-02]
mat_Sqrt:  [[ 2.10503095e+01  0.00000000e+00]
 [-8.13011063e-03  1.86284237e-02]]
grads:  [-1.33785663e-03 -1.66882751e+01]
Stock Position:  -0.0013378566307668829
Bond Position:  [-6.99048633]


portfolio before change:  [-7.12865416]
curr_Stock_Price:  102.6223251924943
curr_Factors:  [1.02622325e+02 4.09324410e-02]
mat_Sqrt:  [[ 2.07623101e+01  0.00000000e+00]
 [-8.09270694e-03  1.85427211e-02]]
grads:  [-1.82449146e-03  1.26247882e+01]
Stock Position:  -0.0018244914604540433
Bond Position:  [-6.9414206]


portfolio before change:  [-7.12711245]
curr_Stock_Price:  101.30171641729795
curr_Factors:  [1.01301716e+02 4.16980138e-02]
mat_Sqrt:  [[ 2.06859032e+01  0.00000000e+00]
 [-8.16803661e-03  1.87153230e-02]]
grads:  [-3.47518579e-03  6.29728694e+00]
Stock Position:  -0.0034751857860536505
Bond Position:  [-6.77507017]


portfolio before change:  [-7.13061618]
curr_Stock_Price:  102.06622024342012
curr_Factors:  [1.02066220e+02 4.05426522e-02]
mat_Sqrt:  [[ 2.05512437e+01  0.00000000e+00]
 [-8.05408241e-03  1.84542212e-02]]
grads:  [5.12482480e-03 5.27478476e+00]
Stock Position:  0.005124824801500186
Bond Position:  [-7.65368768]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.12440889]
Stock Price:  103.46413392038008
PL:  [-10.58854281]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.53262554e-01  5.74318145e-01]
 [-1.74938386e-01 -7.13795337e-02]
 [ 7.48386787e-01 -6.34764811e-01]
 [-2.84534426e-02  1.62666621e-01]
 [ 1.90796274e-02 -9.50767382e-02]
 [-7.33568768e-02 -5.48808705e-02]
 [-1.47182314e-01  5.69515879e-02]
 [ 2.47448841e-02 -1.34958291e-01]
 [ 1.65300150e-01  1.23801993e-01]
 [-3.05247461e-02  2.72784782e-01]
 [ 1.95949134e-01  5.35421446e-01]
 [ 1.67824554e-01  2.67187356e-01]
 [ 1.98246163e-01  2.55359062e-02]
 [-2.65650942e-01 -3.59413324e-01]
 [ 8.06910049e-02  2.25845125e-01]
 [ 5.35573384e-02 -2.01222287e-02]
 [-3.66555011e-02  5.78248334e-02]
 [-2.87907954e-02  3.20951710e-02]
 [ 1.52627316e-02  5.68301230e-02]
 [-2.76997683e-03 -8.73578977e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 1.82967095e-02  2.18204686e-01]
 [ 2.55050397e-02  1.46327144e-01]
 [-5.24905815e-02  4.16498258e-02]
 [ 5.16757318e-02  1.13943839e-01]
 [ 1.00343086e-01  7.24887317e-02]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.70776953e-01  1.17043254e-01]
 [-1.86978437e-01 -4.32141111e-02]
 [ 9.38872013e-02 -6.82674883e-02]
 [-8.48065082e-01 -1.00907827e-01]
 [-1.21712535e-01  4.29593428e-02]
 [-4.15724161e-03 -9.01832896e-02]
 [ 5.30889538e-02  9.42698508e-02]
 [-6.60495305e-02  1.60516375e-01]
 [-1.08255957e+00 -1.96856805e-01]
 [-3.16103627e-02  2.92215197e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 6.96431838e-01  2.22226750e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.72815933]
curr_Stock_Price:  100.75614808577318
curr_Factors:  [1.00756148e+02 4.08612277e-02]
mat_Sqrt:  [[ 2.03670093e+01  0.00000000e+00]
 [-8.08566412e-03  1.85265839e-02]]
grads:  [2.47417544e-02 3.09996784e+01]
Stock Position:  0.024741754406240983
Bond Position:  [5.23527546]


portfolio before change:  [7.73498311]
curr_Stock_Price:  101.00549677196315
curr_Factors:  [1.01005497e+02 4.06844670e-02]
mat_Sqrt:  [[ 2.03732036e+01  0.00000000e+00]
 [-8.06815637e-03  1.84864686e-02]]
grads:  [-0.01011579 -3.86117733]
Stock Position:  -0.010115786048387764
Bond Position:  [8.7567331]


portfolio before change:  [7.73505715]
curr_Stock_Price:  101.10638998200342
curr_Factors:  [1.01106390e+02 4.05187489e-02]
mat_Sqrt:  [[ 2.03519777e+01  0.00000000e+00]
 [-8.05170778e-03  1.84487802e-02]]
grads:  [ 2.31600446e-02 -3.44068716e+01]
Stock Position:  0.02316004464826786
Bond Position:  [5.39342865]


portfolio before change:  [7.66309852]
curr_Stock_Price:  97.97026249193941
curr_Factors:  [9.79702625e+01 4.10772752e-02]
mat_Sqrt:  [[ 1.98561518e+01  0.00000000e+00]
 [-8.10701180e-03  1.85754976e-02]]
grads:  [2.14241367e-03 8.75705322e+00]
Stock Position:  0.0021424136698294694
Bond Position:  [7.45320569]


portfolio before change:  [7.6616202]
curr_Stock_Price:  96.84535101380366
curr_Factors:  [9.68453510e+01 4.07149377e-02]
mat_Sqrt:  [[ 1.95413996e+01  0.00000000e+00]
 [-8.07117714e-03  1.84933901e-02]]
grads:  [-1.14706539e-03 -5.14112003e+00]
Stock Position:  -0.001147065385259714
Bond Position:  [7.77270815]


portfolio before change:  [7.66409523]
curr_Stock_Price:  95.5347246170054
curr_Factors:  [9.55347246e+01 4.05967262e-02]
mat_Sqrt:  [[ 1.92489375e+01  0.00000000e+00]
 [-8.05945171e-03  1.84665238e-02]]
grads:  [-0.00505528 -2.97191129]
Stock Position:  -0.00505528434560239
Bond Position:  [8.14705042]


portfolio before change:  [7.66452494]
curr_Stock_Price:  95.65118258919982
curr_Factors:  [9.56511826e+01 4.02575699e-02]
mat_Sqrt:  [[ 1.91917299e+01  0.00000000e+00]
 [-8.02571566e-03  1.83892248e-02]]
grads:  [-0.00637392  3.09700864]
Stock Position:  -0.006373922738631786
Bond Position:  [8.27419819]


portfolio before change:  [7.66013403]
curr_Stock_Price:  96.50234730031296
curr_Factors:  [9.65023473e+01 3.96171234e-02]
mat_Sqrt:  [[ 1.92078761e+01  0.00000000e+00]
 [-7.96162028e-03  1.82423638e-02]]
grads:  [-1.77821550e-03 -7.39807038e+00]
Stock Position:  -0.0017782155006448761
Bond Position:  [7.831736]


portfolio before change:  [7.66126081]
curr_Stock_Price:  96.41925318367882
curr_Factors:  [9.64192532e+01 4.02752024e-02]
mat_Sqrt:  [[ 1.93500739e+01  0.00000000e+00]
 [-8.02747307e-03  1.83932515e-02]]
grads:  [0.01133493 6.73083783]
Stock Position:  0.011334931817855923
Bond Position:  [6.56835515]


portfolio before change:  [7.64900032]
curr_Stock_Price:  95.26515854579709
curr_Factors:  [9.52651585e+01 4.05929429e-02]
mat_Sqrt:  [[ 1.91937292e+01  0.00000000e+00]
 [-8.05907617e-03  1.84656633e-02]]
grads:  [4.61235500e-03 1.47725418e+01]
Stock Position:  0.004612355004485869
Bond Position:  [7.20960359]


portfolio before change:  [7.64625282]
curr_Stock_Price:  94.47407513214868
curr_Factors:  [9.44740751e+01 3.98606258e-02]
mat_Sqrt:  [[ 1.88618682e+01  0.00000000e+00]
 [-7.98605042e-03  1.82983403e-02]]
grads:  [2.27775005e-02 2.92606563e+01]
Stock Position:  0.022777500464894584
Bond Position:  [5.49436953]


portfolio before change:  [7.68713657]
curr_Stock_Price:  96.23883900545681
curr_Factors:  [9.62388390e+01 3.78974693e-02]
mat_Sqrt:  [[ 1.87350769e+01  0.00000000e+00]
 [-7.78690895e-03  1.78420498e-02]]
grads:  [ 0.01518193 14.97514906]
Stock Position:  0.015181932662583478
Bond Position:  [6.226045]


portfolio before change:  [7.70044449]
curr_Stock_Price:  97.06413646570272
curr_Factors:  [9.70641365e+01 3.75681366e-02]
mat_Sqrt:  [[ 1.88134577e+01  0.00000000e+00]
 [-7.75300061e-03  1.77643561e-02]]
grads:  [0.01112985 1.43747998]
Stock Position:  0.011129849135920964
Bond Position:  [6.62013529]


portfolio before change:  [7.71978392]
curr_Stock_Price:  98.7273989792321
curr_Factors:  [9.87273990e+01 3.60574184e-02]
mat_Sqrt:  [[ 1.87471395e+01  0.00000000e+00]
 [-7.59551641e-03  1.74035144e-02]]
grads:  [ -0.0225374  -20.65176692]
Stock Position:  -0.022537399770491885
Bond Position:  [9.94484278]


portfolio before change:  [7.69996169]
curr_Stock_Price:  99.66208592229493
curr_Factors:  [9.96620859e+01 3.34079669e-02]
mat_Sqrt:  [[ 1.82160830e+01  0.00000000e+00]
 [-7.31113856e-03  1.67519229e-02]]
grads:  [9.84063910e-03 1.34817433e+01]
Stock Position:  0.009840639104813328
Bond Position:  [6.71922307]


portfolio before change:  [7.70581445]
curr_Stock_Price:  100.17148493723083
curr_Factors:  [1.00171485e+02 3.18996328e-02]
mat_Sqrt:  [[ 1.78910963e+01  0.00000000e+00]
 [-7.14418732e-03  1.63693896e-02]]
grads:  [ 0.00250266 -1.22925956]
Stock Position:  0.0025026570246539496
Bond Position:  [7.45511958]


portfolio before change:  [7.7028881]
curr_Stock_Price:  98.6298025188518
curr_Factors:  [9.86298025e+01 3.19591531e-02]
mat_Sqrt:  [[ 1.76321712e+01  0.00000000e+00]
 [-7.15084925e-03  1.63846540e-02]]
grads:  [-6.47604579e-04  3.52920687e+00]
Stock Position:  -0.0006476045790451795
Bond Position:  [7.76676121]


portfolio before change:  [7.70356299]
curr_Stock_Price:  99.0869026658954
curr_Factors:  [9.90869027e+01 3.05977667e-02]
mat_Sqrt:  [[ 1.73324964e+01  0.00000000e+00]
 [-6.99688693e-03  1.60318820e-02]]
grads:  [-8.52924709e-04  2.00195904e+00]
Stock Position:  -0.000852924708969876
Bond Position:  [7.78807665]


portfolio before change:  [7.70427142]
curr_Stock_Price:  99.39775408582076
curr_Factors:  [9.93977541e+01 3.08646758e-02]
mat_Sqrt:  [[ 1.74625407e+01  0.00000000e+00]
 [-7.02733814e-03  1.61016545e-02]]
grads:  [2.29436434e-03 3.52945861e+00]
Stock Position:  0.002294364339415207
Bond Position:  [7.47621676]


portfolio before change:  [7.70630468]
curr_Stock_Price:  99.87661281958444
curr_Factors:  [9.98766128e+01 2.98880057e-02]
mat_Sqrt:  [[ 1.72668165e+01  0.00000000e+00]
 [-6.91525915e-03  1.58448493e-02]]
grads:  [-2.36847881e-03 -5.51333094e+00]
Stock Position:  -0.0023684788126688704
Bond Position:  [7.94286033]


portfolio before change:  [7.71074504]
curr_Stock_Price:  98.42106253035314
curr_Factors:  [9.84210625e+01 3.04315427e-02]
mat_Sqrt:  [[ 1.71691990e+01  0.00000000e+00]
 [-6.97785557e-03  1.59882757e-02]]
grads:  [ 0.00245373 -2.36285578]
Stock Position:  0.0024537318636685523
Bond Position:  [7.46924615]


portfolio before change:  [7.70806707]
curr_Stock_Price:  96.94914624367169
curr_Factors:  [9.69491462e+01 3.11954674e-02]
mat_Sqrt:  [[ 1.71233896e+01  0.00000000e+00]
 [-7.06489546e-03  1.61877091e-02]]
grads:  [6.63005659e-03 1.34796520e+01]
Stock Position:  0.006630056586568533
Bond Position:  [7.06528875]


portfolio before change:  [7.70467181]
curr_Stock_Price:  96.30383119911178
curr_Factors:  [9.63038312e+01 3.18101255e-02]
mat_Sqrt:  [[ 1.71761671e+01  0.00000000e+00]
 [-7.13415732e-03  1.63464080e-02]]
grads:  [5.20299091e-03 8.95163907e+00]
Stock Position:  0.005202990910249389
Bond Position:  [7.20360385]


portfolio before change:  [7.70232841]
curr_Stock_Price:  95.68036115755852
curr_Factors:  [9.56803612e+01 3.14523416e-02]
mat_Sqrt:  [[ 1.69687284e+01  0.00000000e+00]
 [-7.09392321e-03  1.62542200e-02]]
grads:  [-2.02213781e-03  2.56240076e+00]
Stock Position:  -0.0020221378124838387
Bond Position:  [7.89580729]


portfolio before change:  [7.70136008]
curr_Stock_Price:  96.64734162619905
curr_Factors:  [9.66473416e+01 3.11804077e-02]
mat_Sqrt:  [[ 1.70659633e+01  0.00000000e+00]
 [-7.06318995e-03  1.61838013e-02]]
grads:  [5.94193826e-03 7.04061038e+00]
Stock Position:  0.005941938259789295
Bond Position:  [7.12708754]


portfolio before change:  [7.70179344]
curr_Stock_Price:  96.57033369315339
curr_Factors:  [9.65703337e+01 3.23119828e-02]
mat_Sqrt:  [[ 1.73590333e+01  0.00000000e+00]
 [-7.19021366e-03  1.64748492e-02]]
grads:  [0.00760294 4.3999633 ]
Stock Position:  0.007602944207311878
Bond Position:  [6.96757459]


portfolio before change:  [7.70349239]
curr_Stock_Price:  96.67923104256946
curr_Factors:  [9.66792310e+01 3.48722507e-02]
mat_Sqrt:  [[ 1.80539891e+01  0.00000000e+00]
 [-7.46964531e-03  1.71151075e-02]]
grads:  [9.86826785e-03 1.02212267e+01]
Stock Position:  0.009868267848298123
Bond Position:  [6.74943584]


portfolio before change:  [7.69866465]
curr_Stock_Price:  96.1045137057765
curr_Factors:  [9.61045137e+01 3.46819103e-02]
mat_Sqrt:  [[ 1.78976203e+01  0.00000000e+00]
 [-7.44923194e-03  1.70683346e-02]]
grads:  [-6.68776559e-03  6.85733300e+00]
Stock Position:  -0.006687765591278731
Bond Position:  [8.34138911]


portfolio before change:  [7.69669192]
curr_Stock_Price:  96.5554081998567
curr_Factors:  [9.65554082e+01 3.47940963e-02]
mat_Sqrt:  [[ 1.80106499e+01  0.00000000e+00]
 [-7.46127027e-03  1.70959179e-02]]
grads:  [-0.01142872 -2.52774443]
Stock Position:  -0.01142871704226219
Bond Position:  [8.80019636]


portfolio before change:  [7.68525096]
curr_Stock_Price:  97.65273568930637
curr_Factors:  [9.76527357e+01 3.44644051e-02]
mat_Sqrt:  [[ 1.81288313e+01  0.00000000e+00]
 [-7.42583653e-03  1.70147290e-02]]
grads:  [ 3.53540864e-03 -4.01225834e+00]
Stock Position:  0.0035354086385813548
Bond Position:  [7.34000864]


portfolio before change:  [7.68782369]
curr_Stock_Price:  98.1209042737083
curr_Factors:  [9.81209043e+01 3.37857645e-02]
mat_Sqrt:  [[ 1.80355096e+01  0.00000000e+00]
 [-7.35236174e-03  1.68463771e-02]]
grads:  [-0.0494638  -5.98988293]
Stock Position:  -0.04946380169418158
Bond Position:  [12.54125664]


portfolio before change:  [7.73613598]
curr_Stock_Price:  97.17587911497343
curr_Factors:  [9.71758791e+01 3.45022891e-02]
mat_Sqrt:  [[ 1.80502172e+01  0.00000000e+00]
 [-7.42991672e-03  1.70240779e-02]]
grads:  [-0.00570428  2.52344609]
Stock Position:  -0.0057042826403730955
Bond Position:  [8.29045466]


portfolio before change:  [7.73304972]
curr_Stock_Price:  97.89860586000681
curr_Factors:  [9.78986059e+01 3.29925257e-02]
mat_Sqrt:  [[ 1.77821508e+01  0.00000000e+00]
 [-7.26553791e-03  1.66474387e-02]]
grads:  [-2.44719868e-03 -5.41724713e+00]
Stock Position:  -0.002447198682631029
Bond Position:  [7.97262706]


portfolio before change:  [7.73733557]
curr_Stock_Price:  96.55453445650686
curr_Factors:  [9.65545345e+01 3.32631585e-02]
mat_Sqrt:  [[ 1.76097997e+01  0.00000000e+00]
 [-7.29527612e-03  1.67155775e-02]]
grads:  [5.35109378e-03 5.63964067e+00]
Stock Position:  0.005351093775304595
Bond Position:  [7.2206632]


portfolio before change:  [7.73693465]
curr_Stock_Price:  96.31092959248579
curr_Factors:  [9.63109296e+01 3.43877738e-02]
mat_Sqrt:  [[ 1.78598417e+01  0.00000000e+00]
 [-7.41757629e-03  1.69958024e-02]]
grads:  [2.24277396e-04 9.44447169e+00]
Stock Position:  0.00022427739558628283
Bond Position:  [7.71533429]


portfolio before change:  [7.73792799]
curr_Stock_Price:  96.4396154605694
curr_Factors:  [9.64396155e+01 3.43591947e-02]
mat_Sqrt:  [[ 1.78762722e+01  0.00000000e+00]
 [-7.41449335e-03  1.69887385e-02]]
grads:  [ -0.06536457 -11.58748811]
Stock Position:  -0.06536457426328596
Bond Position:  [14.0416624]


portfolio before change:  [7.7094415]
curr_Stock_Price:  96.90227910741689
curr_Factors:  [9.69022791e+01 3.50778020e-02]
mat_Sqrt:  [[ 1.81488946e+01  0.00000000e+00]
 [-7.49162755e-03  1.71654752e-02]]
grads:  [5.28532493e-03 1.70234261e+01]
Stock Position:  0.005285324931523979
Bond Position:  [7.19728146]


portfolio before change:  [7.71374626]
curr_Stock_Price:  97.54652493186639
curr_Factors:  [9.75465249e+01 3.44074545e-02]
mat_Sqrt:  [[ 1.80941453e+01  0.00000000e+00]
 [-7.41969859e-03  1.70006652e-02]]
grads:  [-4.87368780e-03  6.43279325e+00]
Stock Position:  -0.00487368779758073
Bond Position:  [8.18915757]


portfolio before change:  [7.71330213]
curr_Stock_Price:  97.84770117176737
curr_Factors:  [9.78477012e+01 3.47893183e-02]
mat_Sqrt:  [[ 1.82504504e+01  0.00000000e+00]
 [-7.46075796e-03  1.70947440e-02]]
grads:  [0.03869113 1.29997121]
Stock Position:  0.0386911333255173
Bond Position:  [3.92746368]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.70427729]
Stock Price:  97.60175843708575
PL:  [7.70427729]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.63306800e-01  8.65311371e-01]
 [-1.93470136e-01 -7.61278019e-02]
 [ 7.60427640e-01 -6.42955508e-01]
 [ 1.40379371e-02  2.35471815e-02]
 [ 2.14984904e-02 -5.24397279e-03]
 [-7.78598520e-02 -6.15659123e-02]
 [-1.51366246e-02  2.63355641e-01]
 [ 4.77926218e-02 -5.05793718e-02]
 [ 1.65925229e-01  8.56732327e-02]
 [ 8.33050683e-02  1.12359389e-01]
 [ 1.52821757e-01  3.15316861e-01]
 [ 1.64634397e-01  2.70534151e-01]
 [ 3.20709860e-01  2.37354688e-02]
 [-6.79575798e-03  9.59017369e-02]
 [ 9.88683326e-02  2.39789325e-01]
 [ 3.26059878e-02  2.33119252e-01]
 [ 1.85612046e-01  4.81636399e-01]
 [ 1.34529713e-01  7.34984820e-02]
 [ 1.79604872e-02 -1.01555571e-02]
 [ 3.86731659e-01 -1.18908615e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-3.01634956e-02  6.92697901e-02]
 [-2.38844258e-02 -7.73425223e-02]
 [ 6.20761821e-03 -7.13541580e-02]
 [ 3.96714608e-02  1.54143645e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.63777124e-01  1.00175778e-01]
 [-3.70054661e-01  4.80398641e-02]
 [ 2.29702932e-01 -9.96048760e-02]
 [-1.18639781e+00 -1.34234558e-01]
 [-1.24353449e-01  6.74163197e-02]
 [-8.55891098e-03 -1.20180672e-01]
 [ 4.45295972e-02  8.23647082e-02]
 [-5.30308887e-02  1.63920663e-01]
 [-1.35239986e+00 -1.40153315e-01]
 [-3.90613318e-02  2.81128592e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.04505522e+00 -2.16154229e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.81837927]
curr_Stock_Price:  101.67343378151399
curr_Factors:  [1.01673434e+02 3.97019946e-02]
mat_Sqrt:  [[ 2.02587971e+01  0.00000000e+00]
 [-7.97014375e-03  1.82618935e-02]]
grads:  [4.15108380e-02 4.73834419e+01]
Stock Position:  0.04151083800776075
Bond Position:  [9.59782983]


portfolio before change:  [13.80976532]
curr_Stock_Price:  101.43701949355379
curr_Factors:  [1.01437019e+02 3.93913070e-02]
mat_Sqrt:  [[ 2.01324521e+01  0.00000000e+00]
 [-7.93889735e-03  1.81902990e-02]]
grads:  [-0.01126018 -4.18507699]
Stock Position:  -0.011260179867181992
Bond Position:  [14.95196441]


portfolio before change:  [13.8116472]
curr_Stock_Price:  101.43588569867288
curr_Factors:  [1.01435886e+02 3.89979045e-02]
mat_Sqrt:  [[ 2.00314442e+01  0.00000000e+00]
 [-7.89915484e-03  1.80992375e-02]]
grads:  [ 2.39532830e-02 -3.55239003e+01]
Stock Position:  0.023953282983358914
Bond Position:  [11.38192473]


portfolio before change:  [13.79804968]
curr_Stock_Price:  100.8088173751763
curr_Factors:  [1.00808817e+02 3.83674653e-02]
mat_Sqrt:  [[ 1.97460428e+01  0.00000000e+00]
 [-7.83504591e-03  1.79523455e-02]]
grads:  [1.23137430e-03 1.31164931e+00]
Stock Position:  0.0012313743020971278
Bond Position:  [13.6739163]


portfolio before change:  [13.79799224]
curr_Stock_Price:  99.37400658788259
curr_Factors:  [9.93740066e+01 3.76339811e-02]
mat_Sqrt:  [[ 1.92780402e+01  0.00000000e+00]
 [-7.75979186e-03  1.77799168e-02]]
grads:  [ 0.00099646 -0.29493798]
Stock Position:  0.0009964619258267327
Bond Position:  [13.69896983]


portfolio before change:  [13.80091142]
curr_Stock_Price:  100.58499148414718
curr_Factors:  [1.00584991e+02 3.68157273e-02]
mat_Sqrt:  [[ 1.92996697e+01  0.00000000e+00]
 [-7.67496995e-03  1.75855654e-02]]
grads:  [-0.00542649 -3.50093449]
Stock Position:  -0.005426487640293729
Bond Position:  [14.34673463]


portfolio before change:  [13.80700109]
curr_Stock_Price:  99.79327889021141
curr_Factors:  [9.97932789e+01 3.53858298e-02]
mat_Sqrt:  [[ 1.87722351e+01  0.00000000e+00]
 [-7.52444867e-03  1.72406778e-02]]
grads:  [5.31642608e-03 1.52752487e+01]
Stock Position:  0.005316426076522044
Bond Position:  [13.2764575]


portfolio before change:  [13.80794716]
curr_Stock_Price:  99.65905454961795
curr_Factors:  [9.96590545e+01 3.39177841e-02]
mat_Sqrt:  [[ 1.83539903e+01  0.00000000e+00]
 [-7.36671260e-03  1.68792591e-02]]
grads:  [ 1.40121977e-03 -2.99653982e+00]
Stock Position:  0.0014012197731548763
Bond Position:  [13.66830292]


portfolio before change:  [13.80822033]
curr_Stock_Price:  98.63460775050959
curr_Factors:  [9.86346078e+01 3.51347771e-02]
mat_Sqrt:  [[ 1.84883402e+01  0.00000000e+00]
 [-7.49770921e-03  1.71794100e-02]]
grads:  [0.01099699 4.98697177]
Stock Position:  0.010996990071392078
Bond Position:  [12.72353653]


portfolio before change:  [13.79437662]
curr_Stock_Price:  97.23111030703458
curr_Factors:  [9.72311103e+01 3.63995522e-02]
mat_Sqrt:  [[ 1.85503994e+01  0.00000000e+00]
 [-7.63146667e-03  1.74858868e-02]]
grads:  [0.00713423 6.42571862]
Stock Position:  0.007134225126364445
Bond Position:  [13.10070799]


portfolio before change:  [13.79424395]
curr_Stock_Price:  96.98295926643085
curr_Factors:  [9.69829593e+01 3.74335762e-02]
mat_Sqrt:  [[ 1.87640288e+01  0.00000000e+00]
 [-7.73910343e-03  1.77325136e-02]]
grads:  [1.54784093e-02 1.77818479e+01]
Stock Position:  0.01547840926746912
Bond Position:  [12.29310201]


portfolio before change:  [13.78230639]
curr_Stock_Price:  96.1124374962107
curr_Factors:  [9.61124375e+01 3.77639252e-02]
mat_Sqrt:  [[ 1.86774747e+01  0.00000000e+00]
 [-7.77317698e-03  1.78105860e-02]]
grads:  [1.51361565e-02 1.51895143e+01]
Stock Position:  0.015136156523443278
Bond Position:  [12.32753349]


portfolio before change:  [13.75971866]
curr_Stock_Price:  94.51832274693135
curr_Factors:  [9.45183227e+01 3.78185551e-02]
mat_Sqrt:  [[ 1.83809720e+01  0.00000000e+00]
 [-7.77879735e-03  1.78234638e-02]]
grads:  [0.0180115  1.33169787]
Stock Position:  0.01801149954528305
Bond Position:  [12.05730193]


portfolio before change:  [13.75710945]
curr_Stock_Price:  94.28977604400714
curr_Factors:  [9.42897760e+01 3.91899801e-02]
mat_Sqrt:  [[ 1.86660372e+01  0.00000000e+00]
 [-7.91858373e-03  1.81437547e-02]]
grads:  [1.87823431e-03 5.28566103e+00]
Stock Position:  0.001878234310912908
Bond Position:  [13.58001115]


portfolio before change:  [13.75892677]
curr_Stock_Price:  94.35351386236664
curr_Factors:  [9.43535139e+01 4.04697695e-02]
mat_Sqrt:  [[ 1.89811903e+01  0.00000000e+00]
 [-8.04683982e-03  1.84376263e-02]]
grads:  [1.07222450e-02 1.30054336e+01]
Stock Position:  0.010722245047455321
Bond Position:  [12.74724527]


portfolio before change:  [13.74834438]
curr_Stock_Price:  93.21794111734643
curr_Factors:  [9.32179411e+01 4.10783047e-02]
mat_Sqrt:  [[ 1.88932105e+01  0.00000000e+00]
 [-8.10711339e-03  1.85757304e-02]]
grads:  [7.11089153e-03 1.25496681e+01]
Stock Position:  0.007110891534199587
Bond Position:  [13.08548172]


portfolio before change:  [13.7465768]
curr_Stock_Price:  92.73932721450899
curr_Factors:  [9.27393272e+01 4.33170910e-02]
mat_Sqrt:  [[ 1.93016121e+01  0.00000000e+00]
 [-8.32510334e-03  1.90752081e-02]]
grads:  [2.05068573e-02 2.52493392e+01]
Stock Position:  0.02050685727288808
Bond Position:  [11.84478465]


portfolio before change:  [13.76966274]
curr_Stock_Price:  93.79288948923853
curr_Factors:  [9.37928895e+01 4.07886035e-02]
mat_Sqrt:  [[ 1.89425889e+01  0.00000000e+00]
 [-8.07847546e-03  1.85101126e-02]]
grads:  [0.00879537 3.97072041]
Stock Position:  0.00879537012567668
Bond Position:  [12.94471956]


portfolio before change:  [13.78265476]
curr_Stock_Price:  95.08605043341086
curr_Factors:  [9.50860504e+01 4.20258745e-02]
mat_Sqrt:  [[ 1.94928431e+01  0.00000000e+00]
 [-8.20008531e-03  1.87887558e-02]]
grads:  [ 0.00069401 -0.54051248]
Stock Position:  0.0006940105479196932
Bond Position:  [13.71666404]


portfolio before change:  [13.78353838]
curr_Stock_Price:  93.88856036045088
curr_Factors:  [9.38885604e+01 4.23752502e-02]
mat_Sqrt:  [[ 1.93271945e+01  0.00000000e+00]
 [-8.23409985e-03  1.88666929e-02]]
grads:  [ 0.01732459 -6.30256801]
Stock Position:  0.017324588108733354
Bond Position:  [12.15695775]


portfolio before change:  [13.78286002]
curr_Stock_Price:  93.76168445724898
curr_Factors:  [9.37616845e+01 4.13995462e-02]
mat_Sqrt:  [[ 1.90775760e+01  0.00000000e+00]
 [-8.13875137e-03  1.86482221e-02]]
grads:  [ 0.00220828 -2.02582259]
Stock Position:  0.002208279014257983
Bond Position:  [13.57580806]


portfolio before change:  [13.78338739]
curr_Stock_Price:  93.23199044944185
curr_Factors:  [9.32319904e+01 4.22295811e-02]
mat_Sqrt:  [[ 1.91590223e+01  0.00000000e+00]
 [-8.21993490e-03  1.88342369e-02]]
grads:  [3.56590798e-06 3.67786549e+00]
Stock Position:  3.565907979902548e-06
Bond Position:  [13.78305494]


portfolio before change:  [13.78511263]
curr_Stock_Price:  93.86132040867084
curr_Factors:  [9.38613204e+01 4.27852525e-02]
mat_Sqrt:  [[ 1.94148352e+01  0.00000000e+00]
 [-8.27383853e-03  1.89577457e-02]]
grads:  [-2.96883642e-03 -4.07973203e+00]
Stock Position:  -0.0029688364173339117
Bond Position:  [14.06377153]


portfolio before change:  [13.78715241]
curr_Stock_Price:  93.76643524365788
curr_Factors:  [9.37664352e+01 4.24488708e-02]
mat_Sqrt:  [[ 1.93188147e+01  0.00000000e+00]
 [-8.24124950e-03  1.88830748e-02]]
grads:  [-1.29065317e-03 -3.77873618e+00]
Stock Position:  -0.0012906531699806252
Bond Position:  [13.90817235]


portfolio before change:  [13.78870782]
curr_Stock_Price:  93.90839281093903
curr_Factors:  [9.39083928e+01 4.29770065e-02]
mat_Sqrt:  [[ 1.94680516e+01  0.00000000e+00]
 [-8.29235855e-03  1.90001804e-02]]
grads:  [5.49337269e-03 8.11274642e+00]
Stock Position:  0.005493372686756254
Bond Position:  [13.27283402]


portfolio before change:  [13.78230377]
curr_Stock_Price:  92.44057712844506
curr_Factors:  [9.24405771e+01 4.51106756e-02]
mat_Sqrt:  [[ 1.96337074e+01  0.00000000e+00]
 [-8.49570956e-03  1.94661161e-02]]
grads:  [6.39128608e-03 9.35309946e+00]
Stock Position:  0.006391286080000495
Bond Position:  [13.1914896]


portfolio before change:  [13.79141909]
curr_Stock_Price:  93.60877494510436
curr_Factors:  [9.36087749e+01 4.45113470e-02]
mat_Sqrt:  [[ 1.97493101e+01  0.00000000e+00]
 [-8.43908497e-03  1.93363728e-02]]
grads:  [9.02115563e-03 9.04706357e+00]
Stock Position:  0.009021155625478307
Bond Position:  [12.94695977]


portfolio before change:  [13.80115926]
curr_Stock_Price:  94.5090688218125
curr_Factors:  [9.45090688e+01 4.61175319e-02]
mat_Sqrt:  [[ 2.02958158e+01  0.00000000e+00]
 [-8.58999715e-03  1.96821561e-02]]
grads:  [-0.00591535  5.089675  ]
Stock Position:  -0.005915348841082038
Bond Position:  [14.36021337]


portfolio before change:  [13.80766705]
curr_Stock_Price:  93.71238668141598
curr_Factors:  [9.37123867e+01 4.67601889e-02]
mat_Sqrt:  [[ 2.02644643e+01  0.00000000e+00]
 [-8.64964174e-03  1.98188190e-02]]
grads:  [-0.01722663  2.4239519 ]
Stock Position:  -0.017226625913412116
Bond Position:  [15.42201528]


portfolio before change:  [13.81294802]
curr_Stock_Price:  93.517740609663
curr_Factors:  [9.35177406e+01 4.67757937e-02]
mat_Sqrt:  [[ 2.02257478e+01  0.00000000e+00]
 [-8.65108490e-03  1.98221257e-02]]
grads:  [ 0.00920766 -5.02493413]
Stock Position:  0.009207659559821035
Bond Position:  [12.9518685]


portfolio before change:  [13.82578699]
curr_Stock_Price:  94.73627970818524
curr_Factors:  [9.47362797e+01 4.53926135e-02]
mat_Sqrt:  [[ 2.01840782e+01  0.00000000e+00]
 [-8.52221695e-03  1.95268521e-02]]
grads:  [-0.06168142 -6.87435727]
Stock Position:  -0.06168141866527971
Bond Position:  [19.66925513]


portfolio before change:  [13.71361423]
curr_Stock_Price:  96.59472555393047
curr_Factors:  [9.65947256e+01 4.48876179e-02]
mat_Sqrt:  [[ 2.04652329e+01  0.00000000e+00]
 [-8.47467927e-03  1.94179296e-02]]
grads:  [-0.00463863  3.47185931]
Stock Position:  -0.004638625675506773
Bond Position:  [14.161681]


portfolio before change:  [13.71902491]
curr_Stock_Price:  95.80993248399405
curr_Factors:  [9.58099325e+01 4.40852381e-02]
mat_Sqrt:  [[ 2.01167181e+01  0.00000000e+00]
 [-8.39859399e-03  1.92435963e-02]]
grads:  [-3.03280368e-03 -6.24522934e+00]
Stock Position:  -0.0030328036771656314
Bond Position:  [14.00959763]


portfolio before change:  [13.72200257]
curr_Stock_Price:  95.40557159758023
curr_Factors:  [9.54055716e+01 4.42258049e-02]
mat_Sqrt:  [[ 2.00637270e+01  0.00000000e+00]
 [-8.41197288e-03  1.92742512e-02]]
grads:  [4.01104455e-03 4.27330262e+00]
Stock Position:  0.004011044546939646
Bond Position:  [13.33932657]


portfolio before change:  [13.72239083]
curr_Stock_Price:  95.08663715369575
curr_Factors:  [9.50866372e+01 4.57038530e-02]
mat_Sqrt:  [[ 2.03280582e+01  0.00000000e+00]
 [-8.55138379e-03  1.95936818e-02]]
grads:  [9.10561834e-04 8.36599600e+00]
Stock Position:  0.0009105618337086721
Bond Position:  [13.63580856]


portfolio before change:  [13.72423394]
curr_Stock_Price:  95.2387767769634
curr_Factors:  [9.52387768e+01 4.64550517e-02]
mat_Sqrt:  [[ 2.05272269e+01  0.00000000e+00]
 [-8.62137359e-03  1.97540485e-02]]
grads:  [-0.06886307 -7.094916  ]
Stock Position:  -0.0688630659856667
Bond Position:  [20.28266811]


portfolio before change:  [13.6416243]
curr_Stock_Price:  96.47521805260627
curr_Factors:  [9.64752181e+01 4.63707475e-02]
mat_Sqrt:  [[ 2.07748462e+01  0.00000000e+00]
 [-8.61354723e-03  1.97361161e-02]]
grads:  [4.02569742e-03 1.42443726e+01]
Stock Position:  0.0040256974191055514
Bond Position:  [13.25324426]


portfolio before change:  [13.63638728]
curr_Stock_Price:  94.76277474679394
curr_Factors:  [9.47627747e+01 4.73477396e-02]
mat_Sqrt:  [[ 2.06199399e+01  0.00000000e+00]
 [-8.70381430e-03  1.99429439e-02]]
grads:  [-4.27669605e-03  5.48373223e+00]
Stock Position:  -0.004276696051008933
Bond Position:  [14.04165886]


portfolio before change:  [13.63737839]
curr_Stock_Price:  94.94146399520139
curr_Factors:  [9.49414640e+01 4.68982448e-02]
mat_Sqrt:  [[ 2.05605259e+01  0.00000000e+00]
 [-8.66240104e-03  1.98480542e-02]]
grads:  [ 0.05036941 -1.08904493]
Stock Position:  0.0503694057614526
Bond Position:  [8.85523327]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.62069533]
Stock Price:  94.58827265906733
PL:  [13.62069533]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.19903117e-01  7.93656487e-01]
 [-2.54201398e-01 -6.28088615e-02]
 [ 9.32700492e-01 -8.34716158e-01]
 [-6.65242686e-02  1.06268489e-02]
 [-1.86436320e-01  9.07252331e-02]
 [ 5.39322187e-01  4.59437699e-01]
 [ 1.96882534e-01 -4.19578030e-01]
 [ 6.58730509e-01 -3.76816320e-02]
 [-4.21037131e-01 -2.59889800e-01]
 [ 5.23722582e-01 -3.82026375e-01]
 [ 6.09257955e-02 -1.01750140e-02]
 [-1.03324744e-01 -1.82563030e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-7.10528032e-01 -9.89219724e-01]
 [-2.99542560e-03 -1.32288572e-01]
 [ 3.15317966e-02 -1.17840166e-01]
 [-5.32066205e-02  2.83924521e-01]
 [-1.61235154e-02  1.32389277e-01]
 [ 1.48141591e-02  6.79682449e-02]
 [-7.99250356e-02 -3.89544994e-02]
 [ 1.70056201e-01  7.71696781e-02]
 [ 7.62004273e-02  3.12625440e-01]
 [ 3.63125346e-02  2.99668604e-01]
 [-4.43151495e-02  1.34366112e-01]
 [ 2.22678928e-02  5.56698605e-02]
 [ 4.44877986e-01 -8.82913314e-02]
 [-3.53121340e-02  2.08044604e-01]
 [-1.86733359e-01  1.37406633e-01]
 [-6.08496899e-03 -1.33696592e-01]
 [ 3.11485185e-02 -5.36041908e-02]
 [-7.47412539e-01 -9.33703459e-02]
 [-1.18184528e-01  9.67329914e-03]
 [-9.17649466e-03 -9.20579447e-02]
 [ 5.39381584e-02  8.88791350e-02]
 [-6.61796197e-02  1.61074019e-01]
 [-8.57025474e-01 -2.41640785e-01]
 [-4.03183037e-02  2.79817897e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.04716952e+00 -2.18774211e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.15328392]
curr_Stock_Price:  101.42264347155736
curr_Factors:  [1.01422643e+02 4.00101842e-02]
mat_Sqrt:  [[ 2.02871108e+01  0.00000000e+00]
 [-8.00101836e-03  1.83326361e-02]]
grads:  [3.77719239e-02 4.32920002e+01]
Stock Position:  0.03777192388995984
Bond Position:  [8.32235555]


portfolio before change:  [12.18363157]
curr_Stock_Price:  102.19854491625799
curr_Factors:  [1.02198545e+02 4.08112860e-02]
mat_Sqrt:  [[ 2.06459491e+01  0.00000000e+00]
 [-8.08072135e-03  1.85152586e-02]]
grads:  [-0.01364013 -3.39227567]
Stock Position:  -0.013640130151048223
Bond Position:  [13.57763303]


portfolio before change:  [12.16776868]
curr_Stock_Price:  103.48593741799945
curr_Factors:  [1.03485937e+02 3.84435313e-02]
mat_Sqrt:  [[ 2.02905106e+01  0.00000000e+00]
 [-7.84280881e-03  1.79701325e-02]]
grads:  [ 2.80131194e-02 -4.64501949e+01]
Stock Position:  0.028013119375984438
Bond Position:  [9.26880476]


portfolio before change:  [12.14621555]
curr_Stock_Price:  102.67518137014962
curr_Factors:  [1.02675181e+02 3.78202851e-02]
mat_Sqrt:  [[ 1.99676924e+01  0.00000000e+00]
 [-7.77897526e-03  1.78238715e-02]]
grads:  [-0.00309932  0.5962144 ]
Stock Position:  -0.0030993231640058837
Bond Position:  [12.46443912]


portfolio before change:  [12.14309484]
curr_Stock_Price:  104.1848205157362
curr_Factors:  [1.04184821e+02 3.78447419e-02]
mat_Sqrt:  [[ 2.02678285e+01  0.00000000e+00]
 [-7.78149003e-03  1.78296335e-02]]
grads:  [-0.00724501  5.08845193]
Stock Position:  -0.007245008093463187
Bond Position:  [12.89791471]


portfolio before change:  [12.12814158]
curr_Stock_Price:  106.47130549818174
curr_Factors:  [1.06471305e+02 3.72023962e-02]
mat_Sqrt:  [[ 2.05361031e+01  0.00000000e+00]
 [-7.71516908e-03  1.76776732e-02]]
grads:  [ 0.03602617 25.98971568]
Stock Position:  0.03602617470583719
Bond Position:  [8.29238773]


portfolio before change:  [12.10367337]
curr_Stock_Price:  105.76335289656444
curr_Factors:  [1.05763353e+02 3.78374820e-02]
mat_Sqrt:  [[ 2.05729383e+01  0.00000000e+00]
 [-7.78074361e-03  1.78279233e-02]]
grads:  [ 6.69018151e-04 -2.35348797e+01]
Stock Position:  0.0006690181513431884
Bond Position:  [12.03291577]


portfolio before change:  [12.10580492]
curr_Stock_Price:  106.70106283987047
curr_Factors:  [1.06701063e+02 3.74987210e-02]
mat_Sqrt:  [[ 2.06622196e+01  0.00000000e+00]
 [-7.74583460e-03  1.77479367e-02]]
grads:  [ 0.03108499 -2.12315565]
Stock Position:  0.03108499031082375
Bond Position:  [8.78900342]


portfolio before change:  [12.11342354]
curr_Stock_Price:  106.91080785970098
curr_Factors:  [1.06910808e+02 3.84857200e-02]
mat_Sqrt:  [[ 2.09735246e+01  0.00000000e+00]
 [-7.84711106e-03  1.79799902e-02]]
grads:  [ -0.02548271 -14.45439052]
Stock Position:  -0.025482714520876457
Bond Position:  [14.83780113]


portfolio before change:  [12.18432656]
curr_Stock_Price:  104.20119918934135
curr_Factors:  [1.04201199e+02 3.91441115e-02]
mat_Sqrt:  [[ 2.06160727e+01  0.00000000e+00]
 [-7.91394834e-03  1.81331337e-02]]
grads:  [ 1.73162274e-02 -2.10678630e+01]
Stock Position:  0.017316227405867912
Bond Position:  [10.3799549]


portfolio before change:  [12.17592]
curr_Stock_Price:  103.64079177196176
curr_Factors:  [1.03640792e+02 3.93479709e-02]
mat_Sqrt:  [[ 2.05585222e+01  0.00000000e+00]
 [-7.93452919e-03  1.81802903e-02]]
grads:  [ 0.00274753 -0.5596728 ]
Stock Position:  0.002747525082220091
Bond Position:  [11.89116432]


portfolio before change:  [12.17532048]
curr_Stock_Price:  102.88156168836531
curr_Factors:  [1.02881562e+02 3.98869059e-02]
mat_Sqrt:  [[ 2.05472035e+01  0.00000000e+00]
 [-7.98868258e-03  1.83043713e-02]]
grads:  [-8.90640822e-03 -9.97373942e+00]
Stock Position:  -0.008906408222357562
Bond Position:  [13.09162567]


portfolio before change:  [12.17816277]
curr_Stock_Price:  102.74618352594497
curr_Factors:  [1.02746184e+02 4.12387935e-02]
mat_Sqrt:  [[ 2.08650137e+01  0.00000000e+00]
 [-8.12293479e-03  1.86119818e-02]]
grads:  [-5.78922310e-03  8.89382166e+00]
Stock Position:  -0.005789223097549549
Bond Position:  [12.77298335]


portfolio before change:  [12.17007802]
curr_Stock_Price:  104.41851099830802
curr_Factors:  [1.04418511e+02 4.05189762e-02]
mat_Sqrt:  [[ 2.10187424e+01  0.00000000e+00]
 [-8.05173037e-03  1.84488319e-02]]
grads:  [ -0.05434478 -53.61963984]
Stock Position:  -0.05434477918757061
Bond Position:  [17.84467894]


portfolio before change:  [12.20646769]
curr_Stock_Price:  103.78995103226652
curr_Factors:  [1.03789951e+02 4.08200973e-02]
mat_Sqrt:  [[ 2.09697052e+01  0.00000000e+00]
 [-8.08159363e-03  1.85172573e-02]]
grads:  [-2.89612521e-03 -7.14406945e+00]
Stock Position:  -0.0028961252072622606
Bond Position:  [12.50705639]


portfolio before change:  [12.20760916]
curr_Stock_Price:  103.93566674694597
curr_Factors:  [1.03935667e+02 4.05220464e-02]
mat_Sqrt:  [[ 2.09223417e+01  0.00000000e+00]
 [-8.05203541e-03  1.84495309e-02]]
grads:  [-9.51034476e-04 -6.38716329e+00]
Stock Position:  -0.0009510344761118198
Bond Position:  [12.30645556]


portfolio before change:  [12.21004629]
curr_Stock_Price:  102.99066462639951
curr_Factors:  [1.02990665e+02 3.96738438e-02]
mat_Sqrt:  [[ 2.05139834e+01  0.00000000e+00]
 [-7.96731762e-03  1.82554180e-02]]
grads:  [3.44682932e-03 1.55528907e+01]
Stock Position:  0.00344682931857394
Bond Position:  [11.85505505]


portfolio before change:  [12.21283343]
curr_Stock_Price:  103.36932117863697
curr_Factors:  [1.03369321e+02 3.94924115e-02]
mat_Sqrt:  [[ 2.05422727e+01  0.00000000e+00]
 [-7.94907909e-03  1.82136283e-02]]
grads:  [2.02781371e-03 7.26869326e+00]
Stock Position:  0.002027813707812247
Bond Position:  [12.00321971]


portfolio before change:  [12.21345933]
curr_Stock_Price:  102.93801972609879
curr_Factors:  [1.02938020e+02 3.89416635e-02]
mat_Sqrt:  [[ 2.03134205e+01  0.00000000e+00]
 [-7.89345689e-03  1.80861818e-02]]
grads:  [2.18958363e-03 3.75802065e+00]
Stock Position:  0.0021895836342981103
Bond Position:  [11.98806793]


portfolio before change:  [12.21257237]
curr_Stock_Price:  101.84851462303364
curr_Factors:  [1.01848515e+02 3.97920187e-02]
mat_Sqrt:  [[ 2.03166774e+01  0.00000000e+00]
 [-7.97917477e-03  1.82825862e-02]]
grads:  [-0.00477077 -2.13068868]
Stock Position:  -0.004770768898387481
Bond Position:  [12.6984681]


portfolio before change:  [12.2172176]
curr_Stock_Price:  101.20756409607381
curr_Factors:  [1.01207564e+02 3.90179124e-02]
mat_Sqrt:  [[ 1.99914819e+01  0.00000000e+00]
 [-7.90118092e-03  1.81038798e-02]]
grads:  [0.01019113 4.26260442]
Stock Position:  0.010191130943075201
Bond Position:  [11.18579807]


portfolio before change:  [12.20589671]
curr_Stock_Price:  99.95949831922212
curr_Factors:  [9.99594983e+01 3.91964776e-02]
mat_Sqrt:  [[ 1.97900817e+01  0.00000000e+00]
 [-7.91924013e-03  1.81452587e-02]]
grads:  [1.07448447e-02 1.72290429e+01]
Stock Position:  0.010744844710284567
Bond Position:  [11.13184743]


portfolio before change:  [12.19666615]
curr_Stock_Price:  98.97091899078137
curr_Factors:  [9.89709190e+01 3.97430244e-02]
mat_Sqrt:  [[ 1.97304986e+01  0.00000000e+00]
 [-7.97426103e-03  1.82713274e-02]]
grads:  [8.46905288e-03 1.64010308e+01]
Stock Position:  0.008469052878512615
Bond Position:  [11.3584762]


portfolio before change:  [12.20140779]
curr_Stock_Price:  99.36314014077884
curr_Factors:  [9.93631401e+01 3.88930743e-02]
mat_Sqrt:  [[ 1.95957299e+01  0.00000000e+00]
 [-7.88853085e-03  1.80748949e-02]]
grads:  [7.31130183e-04 7.43385305e+00]
Stock Position:  0.0007311301828399004
Bond Position:  [12.1287604]


portfolio before change:  [12.2024655]
curr_Stock_Price:  98.73604850337432
curr_Factors:  [9.87360485e+01 3.75451005e-02]
mat_Sqrt:  [[ 1.91316478e+01  0.00000000e+00]
 [-7.75062326e-03  1.77589089e-02]]
grads:  [2.43388401e-03 3.13475681e+00]
Stock Position:  0.0024338840142940515
Bond Position:  [11.96215341]


portfolio before change:  [12.20432378]
curr_Stock_Price:  98.88515970650013
curr_Factors:  [9.88851597e+01 3.83319192e-02]
mat_Sqrt:  [[ 1.93602696e+01  0.00000000e+00]
 [-7.83141563e-03  1.79440275e-02]]
grads:  [ 0.02098858 -4.92037429]
Stock Position:  0.02098857594622437
Bond Position:  [10.12886509]


portfolio before change:  [12.19993031]
curr_Stock_Price:  98.61550557132225
curr_Factors:  [9.86155056e+01 3.96273729e-02]
mat_Sqrt:  [[ 1.96310191e+01  0.00000000e+00]
 [-7.96265010e-03  1.82447234e-02]]
grads:  [2.82644394e-03 1.14030013e+01]
Stock Position:  0.002826443941593405
Bond Position:  [11.92119911]


portfolio before change:  [12.1984334]
curr_Stock_Price:  97.55864843736961
curr_Factors:  [9.75586484e+01 4.03086313e-02]
mat_Sqrt:  [[ 1.95868592e+01  0.00000000e+00]
 [-8.03080382e-03  1.84008832e-02]]
grads:  [-6.47189970e-03  7.46739338e+00]
Stock Position:  -0.006471899698772672
Bond Position:  [12.82982319]


portfolio before change:  [12.18827985]
curr_Stock_Price:  99.3753301048458
curr_Factors:  [9.93753301e+01 3.87345719e-02]
mat_Sqrt:  [[ 1.95581587e+01  0.00000000e+00]
 [-7.87244023e-03  1.80380266e-02]]
grads:  [-3.29453026e-03 -7.41193009e+00]
Stock Position:  -0.003294530261292361
Bond Position:  [12.51567488]


portfolio before change:  [12.18998866]
curr_Stock_Price:  99.33154486257838
curr_Factors:  [9.93315449e+01 3.83164338e-02]
mat_Sqrt:  [[ 1.94437367e+01  0.00000000e+00]
 [-7.82983359e-03  1.79404026e-02]]
grads:  [ 3.98777857e-04 -2.98790346e+00]
Stock Position:  0.0003987778573509815
Bond Position:  [12.15037744]


portfolio before change:  [12.19141744]
curr_Stock_Price:  99.10557554429654
curr_Factors:  [9.91055755e+01 3.83430337e-02]
mat_Sqrt:  [[ 1.94062367e+01  0.00000000e+00]
 [-7.83255092e-03  1.79466287e-02]]
grads:  [-0.04061389 -5.20266772]
Stock Position:  -0.04061388680833241
Bond Position:  [16.21648007]


portfolio before change:  [12.22819381]
curr_Stock_Price:  98.24997699731135
curr_Factors:  [9.82499770e+01 3.92956403e-02]
mat_Sqrt:  [[ 1.94762187e+01  0.00000000e+00]
 [-7.92925119e-03  1.81681969e-02]]
grads:  [-0.00585138  0.53243033]
Stock Position:  -0.0058513798680290925
Bond Position:  [12.80309175]


portfolio before change:  [12.23446543]
curr_Stock_Price:  97.45168142379954
curr_Factors:  [9.74516814e+01 3.98269535e-02]
mat_Sqrt:  [[ 1.94481314e+01  0.00000000e+00]
 [-7.98267659e-03  1.82906099e-02]]
grads:  [-2.53771813e-03 -5.03307136e+00]
Stock Position:  -0.002537718128117374
Bond Position:  [12.48177032]


portfolio before change:  [12.2394404]
curr_Stock_Price:  96.10611837670889
curr_Factors:  [9.61061184e+01 4.17576863e-02]
mat_Sqrt:  [[ 1.96389946e+01  0.00000000e+00]
 [-8.17387901e-03  1.87287096e-02]]
grads:  [4.72163647e-03 4.74560911e+00]
Stock Position:  0.0047216364697176775
Bond Position:  [11.78566225]


portfolio before change:  [12.24180918]
curr_Stock_Price:  96.29577144272196
curr_Factors:  [9.62957714e+01 4.10679619e-02]
mat_Sqrt:  [[ 1.95145613e+01  0.00000000e+00]
 [-8.10609271e-03  1.85733917e-02]]
grads:  [2.11065248e-04 8.67229970e+00]
Stock Position:  0.00021106524765646698
Bond Position:  [12.22148449]


portfolio before change:  [12.24358411]
curr_Stock_Price:  97.46675380781674
curr_Factors:  [9.74667538e+01 4.26522709e-02]
mat_Sqrt:  [[ 2.01292494e+01  0.00000000e+00]
 [-8.26097049e-03  1.89282613e-02]]
grads:  [ -0.0478153  -12.76613742]
Stock Position:  -0.047815302908994134
Bond Position:  [16.90398647]


portfolio before change:  [12.29670491]
curr_Stock_Price:  96.39998938737082
curr_Factors:  [9.63999894e+01 4.34321023e-02]
mat_Sqrt:  [[ 2.00901145e+01  0.00000000e+00]
 [-8.33614801e-03  1.91005146e-02]]
grads:  [4.07186522e-03 1.46497569e+01]
Stock Position:  0.004071865220101115
Bond Position:  [11.90417714]


portfolio before change:  [12.29812241]
curr_Stock_Price:  96.38264718945229
curr_Factors:  [9.63826472e+01 4.43149196e-02]
mat_Sqrt:  [[ 2.02896163e+01  0.00000000e+00]
 [-8.42044366e-03  1.92936602e-02]]
grads:  [-4.34632249e-03  5.66827461e+00]
Stock Position:  -0.0043463224851170365
Bond Position:  [12.71703247]


portfolio before change:  [12.30600405]
curr_Stock_Price:  94.93500691898737
curr_Factors:  [9.49350069e+01 4.39796402e-02]
mat_Sqrt:  [[ 1.99091272e+01  0.00000000e+00]
 [-8.38852933e-03  1.92205353e-02]]
grads:  [ 0.05211788 -1.13823162]
Stock Position:  0.05211787605957562
Bond Position:  [7.35819312]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.42797044]
Stock Price:  97.2575604631175
PL:  [12.42797044]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.93552031e-01  2.66485337e-02]
 [-1.72007064e-01 -8.19382958e-02]
 [ 8.23471614e-01 -7.09238861e-01]
 [-3.92625111e-02  5.21611118e-02]
 [ 2.32515793e-02 -5.94557623e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-2.69594998e-02  2.33615445e-01]
 [ 2.21550292e-01 -2.09739871e-03]
 [ 1.48274296e-01  7.57788367e-02]
 [ 3.47766969e-01 -1.71548100e-01]
 [ 6.71891546e-02  1.14513100e-02]
 [ 1.61702859e-04  1.49878089e-01]
 [ 1.72343496e-01  3.31214873e-02]
 [-1.97359436e-01 -2.48856289e-01]
 [ 8.83578030e-02  2.31980619e-01]
 [ 5.09159680e-02 -9.47884487e-03]
 [ 3.98600856e-02  4.84525775e-02]
 [ 6.16111950e-02  6.06800638e-02]
 [ 1.48385497e-02  1.09951809e-02]
 [ 2.71853992e-01 -1.10928246e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-1.76461479e-02  1.24740687e-01]
 [-2.47211874e-02 -8.04857378e-02]
 [ 5.87139909e-02 -2.69829072e-01]
 [ 7.08608011e-02  2.54163464e-01]
 [-3.59770755e-02  1.03881819e-01]
 [-1.68865426e-02  1.54185383e-01]
 [-1.46055432e-01  5.96762609e-02]
 [-5.57500477e-01  1.29526430e-01]
 [ 2.71446873e-01 -1.08681436e-01]
 [-1.51909751e+00 -1.71365400e-01]
 [ 3.11310303e-01  5.68634039e-01]
 [ 1.88092062e-03 -1.31743242e-01]
 [ 1.03851888e-02  6.23871773e-02]
 [-3.73277436e-02  1.67148968e-01]
 [-1.35203090e+00 -1.39949629e-01]
 [-6.41153834e-02  2.48138817e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.11076953e+00 -3.01645890e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.73076341]
curr_Stock_Price:  99.18086503908161
curr_Factors:  [9.91808650e+01 4.03440372e-02]
mat_Sqrt:  [[ 1.99212951e+01  0.00000000e+00]
 [-8.03433006e-03  1.84089628e-02]]
grads:  [-0.00913202  1.44758474]
Stock Position:  -0.009132019588691942
Bond Position:  [-1.82504181]


portfolio before change:  [-2.74097285]
curr_Stock_Price:  100.27386479832133
curr_Factors:  [1.00273865e+02 4.04353965e-02]
mat_Sqrt:  [[ 2.01636248e+01  0.00000000e+00]
 [-8.04342181e-03  1.84297946e-02]]
grads:  [-0.01030409 -4.44596901]
Stock Position:  -0.010304093149518008
Bond Position:  [-1.7077416]


portfolio before change:  [-2.73205829]
curr_Stock_Price:  99.38799978944932
curr_Factors:  [9.93879998e+01 4.17253881e-02]
mat_Sqrt:  [[ 2.03017812e+01  0.00000000e+00]
 [-8.17071728e-03  1.87214652e-02]]
grads:  [ 2.53147442e-02 -3.78837261e+01]
Stock Position:  0.025314744211721113
Bond Position:  [-5.24804009]


portfolio before change:  [-2.72759409]
curr_Stock_Price:  99.59026344967926
curr_Factors:  [9.95902634e+01 4.12264423e-02]
mat_Sqrt:  [[ 2.02211016e+01  0.00000000e+00]
 [-8.12171827e-03  1.86091944e-02]]
grads:  [-8.15857412e-04  2.80297528e+00]
Stock Position:  -0.0008158574123854472
Bond Position:  [-2.64634263]


portfolio before change:  [-2.72768825]
curr_Stock_Price:  99.30019612805549
curr_Factors:  [9.93001961e+01 4.14816972e-02]
mat_Sqrt:  [[ 2.02245266e+01  0.00000000e+00]
 [-8.14682242e-03  1.86667152e-02]]
grads:  [ 0.00102137 -0.31851218]
Stock Position:  0.0010213696199076123
Bond Position:  [-2.82911045]


portfolio before change:  [-2.72814257]
curr_Stock_Price:  99.20164011917252
curr_Factors:  [9.92016401e+01 3.96101343e-02]
mat_Sqrt:  [[ 1.97434030e+01  0.00000000e+00]
 [-7.96091796e-03  1.82407546e-02]]
grads:  [-0.00599799 -3.63564609]
Stock Position:  -0.005997991929763084
Bond Position:  [-2.13313193]


portfolio before change:  [-2.72996872]
curr_Stock_Price:  99.46164313394578
curr_Factors:  [9.94616431e+01 3.89199200e-02]
mat_Sqrt:  [[ 1.96219244e+01  0.00000000e+00]
 [-7.89125288e-03  1.80811318e-02]]
grads:  [3.82218571e-03 1.29203994e+01]
Stock Position:  0.0038221857125145067
Bond Position:  [-3.1101296]


portfolio before change:  [-2.72420061]
curr_Stock_Price:  101.07247753441878
curr_Factors:  [1.01072478e+02 3.88165660e-02]
mat_Sqrt:  [[ 1.99132189e+01  0.00000000e+00]
 [-7.88076808e-03  1.80571081e-02]]
grads:  [ 0.01107982 -0.11615363]
Stock Position:  0.011079821597684647
Bond Position:  [-3.84406563]


portfolio before change:  [-2.73326493]
curr_Stock_Price:  100.29775487391316
curr_Factors:  [1.00297755e+02 3.88374599e-02]
mat_Sqrt:  [[ 1.97659012e+01  0.00000000e+00]
 [-7.88288880e-03  1.80619673e-02]]
grads:  [0.00917473 4.19549186]
Stock Position:  0.00917473429765998
Bond Position:  [-3.65347018]


portfolio before change:  [-2.71883665]
curr_Stock_Price:  101.92014503653057
curr_Factors:  [1.01920145e+02 3.68806888e-02]
mat_Sqrt:  [[ 1.95730968e+01  0.00000000e+00]
 [-7.68173822e-03  1.76010734e-02]]
grads:  [ 0.01394247 -9.74645671]
Stock Position:  0.013942466172026156
Bond Position:  [-4.13985482]


portfolio before change:  [-2.7279988]
curr_Stock_Price:  101.3001225336257
curr_Factors:  [1.01300123e+02 3.60889546e-02]
mat_Sqrt:  [[ 1.92440786e+01  0.00000000e+00]
 [-7.59883724e-03  1.74111234e-02]]
grads:  [0.00375112 0.65770081]
Stock Position:  0.0037511235270199336
Bond Position:  [-3.10798808]


portfolio before change:  [-2.73704]
curr_Stock_Price:  98.99343281190366
curr_Factors:  [9.89934328e+01 3.84355665e-02]
mat_Sqrt:  [[ 1.94076534e+01  0.00000000e+00]
 [-7.84199633e-03  1.79682709e-02]]
grads:  [3.37876311e-03 8.34126387e+00]
Stock Position:  0.0033787631145207405
Bond Position:  [-3.07151536]


portfolio before change:  [-2.74011731]
curr_Stock_Price:  98.19629394449257
curr_Factors:  [9.81962939e+01 3.93946381e-02]
mat_Sqrt:  [[ 1.94900815e+01  0.00000000e+00]
 [-7.93923302e-03  1.81910681e-02]]
grads:  [0.00958431 1.8207555 ]
Stock Position:  0.009584305658164023
Bond Position:  [-3.68126061]


portfolio before change:  [-2.74570505]
curr_Stock_Price:  97.66129962884652
curr_Factors:  [9.76612996e+01 4.05389541e-02]
mat_Sqrt:  [[ 1.96634070e+01  0.00000000e+00]
 [-8.05371508e-03  1.84533795e-02]]
grads:  [ -0.01556034 -13.48567558]
Stock Position:  -0.015560336238292985
Bond Position:  [-1.22606239]


portfolio before change:  [-2.74511439]
curr_Stock_Price:  97.61349090346094
curr_Factors:  [9.76134909e+01 3.99430863e-02]
mat_Sqrt:  [[ 1.95088044e+01  0.00000000e+00]
 [-7.99430661e-03  1.83172576e-02]]
grads:  [9.71881423e-03 1.26645934e+01]
Stock Position:  0.009718814231838529
Bond Position:  [-3.69380178]


portfolio before change:  [-2.74270107]
curr_Stock_Price:  97.90931691526308
curr_Factors:  [9.79093169e+01 3.98772006e-02]
mat_Sqrt:  [[ 1.95517823e+01  0.00000000e+00]
 [-7.98771062e-03  1.83021443e-02]]
grads:  [ 0.00239257 -0.51790898]
Stock Position:  0.002392572722850348
Bond Position:  [-2.97695623]


portfolio before change:  [-2.74673795]
curr_Stock_Price:  96.37760368660764
curr_Factors:  [9.63776037e+01 4.09926970e-02]
mat_Sqrt:  [[ 1.95132393e+01  0.00000000e+00]
 [-8.09866132e-03  1.85563643e-02]]
grads:  [0.00312642 2.61110295]
Stock Position:  0.0031264170564418116
Bond Position:  [-3.04805453]


portfolio before change:  [-2.74642394]
curr_Stock_Price:  96.59991529128445
curr_Factors:  [9.65999153e+01 4.16441973e-02]
mat_Sqrt:  [[ 1.97130577e+01  0.00000000e+00]
 [-8.16276397e-03  1.87032419e-02]]
grads:  [0.00446882 3.24436074]
Stock Position:  0.0044688220004473304
Bond Position:  [-3.17811177]


portfolio before change:  [-2.75143339]
curr_Stock_Price:  95.56784032714717
curr_Factors:  [9.55678403e+01 4.39213240e-02]
mat_Sqrt:  [[ 2.00285488e+01  0.00000000e+00]
 [-8.38296596e-03  1.92077880e-02]]
grads:  [0.00098046 0.57243348]
Stock Position:  0.000980462448660336
Bond Position:  [-2.84513407]


portfolio before change:  [-2.75179008]
curr_Stock_Price:  95.56678771102558
curr_Factors:  [9.55667877e+01 4.50321546e-02]
mat_Sqrt:  [[ 2.02800187e+01  0.00000000e+00]
 [-8.48831240e-03  1.94491670e-02]]
grads:  [ 0.01101779 -5.70349597]
Stock Position:  0.011017787507880232
Bond Position:  [-3.80472464]


portfolio before change:  [-2.76960014]
curr_Stock_Price:  93.9934741688334
curr_Factors:  [9.39934742e+01 4.58812549e-02]
mat_Sqrt:  [[ 2.01333177e+01  0.00000000e+00]
 [-8.56796405e-03  1.96316719e-02]]
grads:  [ 0.00209248 -1.92433889]
Stock Position:  0.002092482286309952
Bond Position:  [-2.96627982]


portfolio before change:  [-2.76910123]
curr_Stock_Price:  94.40911512967207
curr_Factors:  [9.44091151e+01 4.45589808e-02]
mat_Sqrt:  [[ 1.99288185e+01  0.00000000e+00]
 [-8.44359931e-03  1.93467165e-02]]
grads:  [1.84632879e-03 6.44764126e+00]
Stock Position:  0.0018463287929372807
Bond Position:  [-2.94341149]


portfolio before change:  [-2.77056372]
curr_Stock_Price:  93.81629303725003
curr_Factors:  [9.38162930e+01 4.67478211e-02]
mat_Sqrt:  [[ 2.02842500e+01  0.00000000e+00]
 [-8.64849777e-03  1.98161978e-02]]
grads:  [-2.95046862e-03 -4.06161356e+00]
Stock Position:  -0.0029504686195687786
Bond Position:  [-2.49376169]


portfolio before change:  [-2.76496799]
curr_Stock_Price:  91.81408055916245
curr_Factors:  [9.18140806e+01 4.71397900e-02]
mat_Sqrt:  [[ 1.99343974e+01  0.00000000e+00]
 [-8.68467985e-03  1.98991014e-02]]
grads:  [-2.96216984e-03 -1.35598622e+01]
Stock Position:  -0.0029621698392737284
Bond Position:  [-2.49299909]


portfolio before change:  [-2.76227835]
curr_Stock_Price:  90.80087332479513
curr_Factors:  [9.08008733e+01 4.81546149e-02]
mat_Sqrt:  [[ 1.99254887e+01  0.00000000e+00]
 [-8.77766392e-03  2.01121547e-02]]
grads:  [9.12333109e-03 1.26373066e+01]
Stock Position:  0.00912333109009371
Bond Position:  [-3.59068478]


portfolio before change:  [-2.77554636]
curr_Stock_Price:  89.39577785333425
curr_Factors:  [8.93957779e+01 4.94741703e-02]
mat_Sqrt:  [[ 1.98841151e+01  0.00000000e+00]
 [-8.89711597e-03  2.03858537e-02]]
grads:  [4.70761061e-04 5.09577966e+00]
Stock Position:  0.00047076106123868186
Bond Position:  [-2.81763041]


portfolio before change:  [-2.77591683]
curr_Stock_Price:  89.35703175619278
curr_Factors:  [8.93570318e+01 5.08046628e-02]
mat_Sqrt:  [[ 2.01409764e+01  0.00000000e+00]
 [-9.01595588e-03  2.06581501e-02]]
grads:  [2.50263317e-03 7.46365876e+00]
Stock Position:  0.002502633165825392
Bond Position:  [-2.9995447]


portfolio before change:  [-2.77298124]
curr_Stock_Price:  90.67986053571182
curr_Factors:  [9.06798605e+01 4.97734419e-02]
mat_Sqrt:  [[ 2.02306427e+01  0.00000000e+00]
 [-8.92398493e-03  2.04474182e-02]]
grads:  [-0.00593212  2.91852303]
Stock Position:  -0.00593211882451851
Bond Position:  [-2.23505753]


portfolio before change:  [-2.77208401]
curr_Stock_Price:  90.48151198976181
curr_Factors:  [9.04815120e+01 4.85385639e-02]
mat_Sqrt:  [[ 1.99344065e+01  0.00000000e+00]
 [-8.81258771e-03  2.01921751e-02]]
grads:  [-0.02513095  6.41468434]
Stock Position:  -0.025130946733020763
Bond Position:  [-0.49819795]


portfolio before change:  [-2.80156818]
curr_Stock_Price:  91.65225526889785
curr_Factors:  [9.16522553e+01 4.75169291e-02]
mat_Sqrt:  [[ 1.99787052e+01  0.00000000e+00]
 [-8.71935127e-03  1.99785436e-02]]
grads:  [ 0.01121266 -5.43990783]
Stock Position:  0.011212658838692104
Bond Position:  [-3.82923365]


portfolio before change:  [-2.80424801]
curr_Stock_Price:  91.45594633695974
curr_Factors:  [9.14559463e+01 4.88266925e-02]
mat_Sqrt:  [[ 2.02088035e+01  0.00000000e+00]
 [-8.83870510e-03  2.02520176e-02]]
grads:  [-0.07887095 -8.46164584]
Stock Position:  -0.07887094861554723
Bond Position:  [4.40896924]


portfolio before change:  [-2.76839621]
curr_Stock_Price:  91.00837170206371
curr_Factors:  [9.10083717e+01 4.88998489e-02]
mat_Sqrt:  [[ 2.01249636e+01  0.00000000e+00]
 [-8.84532409e-03  2.02671836e-02]]
grads:  [2.78004252e-02 2.80568850e+01]
Stock Position:  0.027800425152956686
Bond Position:  [-5.29846764]


portfolio before change:  [-2.71480918]
curr_Stock_Price:  92.9597586010266
curr_Factors:  [9.29597586e+01 4.71974427e-02]
mat_Sqrt:  [[ 2.01954819e+01  0.00000000e+00]
 [-8.68998897e-03  1.99112661e-02]]
grads:  [-2.75391022e-03 -6.61651756e+00]
Stock Position:  -0.0027539102184984602
Bond Position:  [-2.45880635]


portfolio before change:  [-2.7157142]
curr_Stock_Price:  93.17677685294001
curr_Factors:  [9.31767769e+01 4.78407123e-02]
mat_Sqrt:  [[ 2.03801090e+01  0.00000000e+00]
 [-8.74900793e-03  2.00464955e-02]]
grads:  [1.84558312e-03 3.11212387e+00]
Stock Position:  0.0018455831231902209
Bond Position:  [-2.88767968]


portfolio before change:  [-2.71520082]
curr_Stock_Price:  93.65053675247839
curr_Factors:  [9.36505368e+01 4.92728760e-02]
mat_Sqrt:  [[ 2.07880727e+01  0.00000000e+00]
 [-8.87899779e-03  2.03443397e-02]]
grads:  [1.71358101e-03 8.21599374e+00]
Stock Position:  0.0017135810105787456
Bond Position:  [-2.8756786]


portfolio before change:  [-2.71283157]
curr_Stock_Price:  95.24294841271123
curr_Factors:  [9.52429484e+01 4.84220209e-02]
mat_Sqrt:  [[ 2.09582148e+01  0.00000000e+00]
 [-8.80200167e-03  2.01679195e-02]]
grads:  [-0.06742511 -6.93921994]
Stock Position:  -0.06742510936525704
Bond Position:  [3.70893464]


portfolio before change:  [-2.69698584]
curr_Stock_Price:  95.01481252759213
curr_Factors:  [9.50148125e+01 4.72177781e-02]
mat_Sqrt:  [[ 2.06463882e+01  0.00000000e+00]
 [-8.69186084e-03  1.99155551e-02]]
grads:  [2.13990333e-03 1.24595481e+01]
Stock Position:  0.002139903327403643
Bond Position:  [-2.90030835]


portfolio before change:  [-2.69824188]
curr_Stock_Price:  94.59728040451327
curr_Factors:  [9.45972804e+01 4.80743000e-02]
mat_Sqrt:  [[ 2.07412600e+01  0.00000000e+00]
 [-8.77034093e-03  2.00953756e-02]]
grads:  [-4.25168072e-03  5.44213587e+00]
Stock Position:  -0.004251680724211938
Bond Position:  [-2.29604445]


portfolio before change:  [-2.69750832]
curr_Stock_Price:  94.35723919514739
curr_Factors:  [9.43572392e+01 4.87411575e-02]
mat_Sqrt:  [[ 2.08316248e+01  0.00000000e+00]
 [-8.83095986e-03  2.02342710e-02]]
grads:  [ 0.05268934 -1.49076727]
Stock Position:  0.05268934298795195
Bond Position:  [-7.66912926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.65147224]
Stock Price:  95.24916119330415
PL:  [-2.65147224]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.72918678e-04  2.59910400e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.49523571e-01 -6.35538099e-01]
 [ 5.44325303e-02  2.48747664e-02]
 [-1.15300466e-01  4.95043186e-02]
 [-3.70964591e-02 -2.51485340e-02]
 [-6.84659024e-03  2.95658041e-01]
 [ 2.17545193e-01 -2.10165541e-03]
 [ 1.22673857e-01  8.39205956e-02]
 [ 2.90195876e-01 -1.29420847e-01]
 [ 6.95139209e-02  1.94783366e-02]
 [-1.00874833e-01 -6.92158280e-03]
 [ 9.24606726e-02  6.47828552e-02]
 [-3.19108914e-01 -4.30330893e-01]
 [ 7.41878630e-02  2.15190870e-01]
 [ 5.44289356e-02 -2.06775692e-02]
 [-5.21642231e-02  2.25327988e-01]
 [-1.22031689e-01  4.01746779e-02]
 [ 1.48828771e-02  6.62619674e-02]
 [-6.65375891e-02 -4.92410672e-02]
 [ 2.20075277e-01  1.39062250e-01]
 [ 3.47235979e-02  5.31671980e-02]
 [-9.35104771e-03  5.53159746e-02]
 [ 8.54337103e-02  1.86452530e-01]
 [ 5.08858528e-02  1.09966774e-01]
 [ 7.37677306e-01 -4.12198395e-01]
 [-3.22216990e-01  4.16501788e-01]
 [ 1.34552346e-01  1.92987391e-03]
 [-2.65297892e-02 -8.20309535e-02]
 [-6.08492495e-02 -3.22713274e-02]
 [-4.23643209e-01 -9.70114583e-02]
 [-4.99401424e-03 -6.01668256e-03]
 [ 1.99928728e-01  2.20279139e-01]
 [ 1.98928651e-01  4.18642147e-02]
 [-2.69437144e-01 -1.73803876e-01]
 [-1.87863188e-02 -3.83078625e-01]
 [-1.24267826e-01  2.48185726e-01]
 [-1.23652587e-01  1.17633971e-01]
 [ 1.60354475e-01  8.51100336e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.69852637]
curr_Stock_Price:  99.84798776948828
curr_Factors:  [9.98479878e+01 3.98754124e-02]
mat_Sqrt:  [[ 1.99384738e+01  0.00000000e+00]
 [-7.98753152e-03  1.83017339e-02]]
grads:  [5.67552366e-03 1.42014085e+01]
Stock Position:  0.005675523657757823
Bond Position:  [1.13183675]


portfolio before change:  [1.69639105]
curr_Stock_Price:  99.44682501812953
curr_Factors:  [9.94468250e+01 3.96119762e-02]
mat_Sqrt:  [[ 1.97926606e+01  0.00000000e+00]
 [-7.96110305e-03  1.82411787e-02]]
grads:  [-0.01025554 -4.82487298]
Stock Position:  -0.010255541309111837
Bond Position:  [2.71627207]


portfolio before change:  [1.67736127]
curr_Stock_Price:  101.33549542616241
curr_Factors:  [1.01335495e+02 3.89610568e-02]
mat_Sqrt:  [[ 2.00021629e+01  0.00000000e+00]
 [-7.89542215e-03  1.80906848e-02]]
grads:  [ 2.36050475e-02 -3.51306822e+01]
Stock Position:  0.02360504747856104
Bond Position:  [-0.71466791]


portfolio before change:  [1.68685786]
curr_Stock_Price:  101.74159206397253
curr_Factors:  [1.01741592e+02 3.96092874e-02]
mat_Sqrt:  [[ 2.02486952e+01  0.00000000e+00]
 [-7.96083286e-03  1.82405596e-02]]
grads:  [0.00322434 1.36370632]
Stock Position:  0.0032243444652749025
Bond Position:  [1.35880792]


portfolio before change:  [1.68586877]
curr_Stock_Price:  101.38215399795924
curr_Factors:  [1.01382154e+02 3.88348851e-02]
mat_Sqrt:  [[ 1.99789438e+01  0.00000000e+00]
 [-7.88262749e-03  1.80613686e-02]]
grads:  [-0.00468969  2.74089521]
Stock Position:  -0.0046896878536076166
Bond Position:  [2.16131942]


portfolio before change:  [1.68671554]
curr_Stock_Price:  101.25920581210117
curr_Factors:  [1.01259206e+02 3.83342383e-02]
mat_Sqrt:  [[ 1.98256729e+01  0.00000000e+00]
 [-7.83165253e-03  1.79445703e-02]]
grads:  [-0.00242474 -1.40145646]
Stock Position:  -0.0024247438890238806
Bond Position:  [1.93224318]


portfolio before change:  [1.68953214]
curr_Stock_Price:  100.19721456636755
curr_Factors:  [1.00197215e+02 3.91161756e-02]
mat_Sqrt:  [[ 1.98168144e+01  0.00000000e+00]
 [-7.91112387e-03  1.81266620e-02]]
grads:  [6.16593340e-03 1.63106722e+01]
Stock Position:  0.006165933400075115
Bond Position:  [1.07172279]


portfolio before change:  [1.69467107]
curr_Stock_Price:  101.00892520397011
curr_Factors:  [1.01008925e+02 3.70334146e-02]
mat_Sqrt:  [[ 1.94382261e+01  0.00000000e+00]
 [-7.69762712e-03  1.76374795e-02]]
grads:  [ 0.01114443 -0.11915849]
Stock Position:  0.011144430270411745
Bond Position:  [0.56898414]


portfolio before change:  [1.69996099]
curr_Stock_Price:  101.47721270735143
curr_Factors:  [1.01477213e+02 3.70285669e-02]
mat_Sqrt:  [[ 1.95270654e+01  0.00000000e+00]
 [-7.69712330e-03  1.76363251e-02]]
grads:  [0.0081579  4.75839469]
Stock Position:  0.008157897964442837
Bond Position:  [0.87212025]


portfolio before change:  [1.69152482]
curr_Stock_Price:  100.42973791263574
curr_Factors:  [1.00429738e+02 3.86837975e-02]
mat_Sqrt:  [[ 1.97527188e+01  0.00000000e+00]
 [-7.86727882e-03  1.80262004e-02]]
grads:  [ 0.01183189 -7.17959662]
Stock Position:  0.011831889588343065
Bond Position:  [0.50325125]


portfolio before change:  [1.69764062]
curr_Stock_Price:  100.94131173941395
curr_Factors:  [1.00941312e+02 3.85706761e-02]
mat_Sqrt:  [[ 1.98242867e+01  0.00000000e+00]
 [-7.85576742e-03  1.79998244e-02]]
grads:  [0.00393532 1.08214037]
Stock Position:  0.003935322620886283
Bond Position:  [1.30040399]


portfolio before change:  [1.6945221]
curr_Stock_Price:  100.10756015056005
curr_Factors:  [1.00107560e+02 3.77291882e-02]
mat_Sqrt:  [[ 1.94448952e+01  0.00000000e+00]
 [-7.76960109e-03  1.78023926e-02]]
grads:  [-0.00534308 -0.38880071]
Stock Position:  -0.005343081464915127
Bond Position:  [2.22940495]


portfolio before change:  [1.70038071]
curr_Stock_Price:  99.06323346120674
curr_Factors:  [9.90632335e+01 3.73887061e-02]
mat_Sqrt:  [[ 1.91550247e+01  0.00000000e+00]
 [-7.73446376e-03  1.77218828e-02]]
grads:  [0.00630301 3.65552892]
Stock Position:  0.006303005621779759
Bond Position:  [1.0759846]


portfolio before change:  [1.70291392]
curr_Stock_Price:  99.44379785869197
curr_Factors:  [9.94437979e+01 3.72747328e-02]
mat_Sqrt:  [[ 1.91992813e+01  0.00000000e+00]
 [-7.72266615e-03  1.76948511e-02]]
grads:  [ -0.02640311 -24.31955432]
Stock Position:  -0.026403108797758
Bond Position:  [4.32853933]


portfolio before change:  [1.66249929]
curr_Stock_Price:  100.99496867216693
curr_Factors:  [1.00994969e+02 3.58674842e-02]
mat_Sqrt:  [[ 1.91271470e+01  0.00000000e+00]
 [-7.57548511e-03  1.73576170e-02]]
grads:  [8.78880985e-03 1.23974892e+01]
Stock Position:  0.008788809846916651
Bond Position:  [0.77487371]


portfolio before change:  [1.66353822]
curr_Stock_Price:  101.10215791122924
curr_Factors:  [1.01102158e+02 3.66555431e-02]
mat_Sqrt:  [[ 1.93566525e+01  0.00000000e+00]
 [-7.65825495e-03  1.75472665e-02]]
grads:  [ 0.00234568 -1.17839261]
Stock Position:  0.0023456795804052033
Bond Position:  [1.42638495]


portfolio before change:  [1.66177313]
curr_Stock_Price:  100.27365855903963
curr_Factors:  [1.00273659e+02 3.66538950e-02]
mat_Sqrt:  [[ 1.91975995e+01  0.00000000e+00]
 [-7.65808279e-03  1.75468720e-02]]
grads:  [2.40535143e-03 1.28414904e+01]
Stock Position:  0.0024053514291539724
Bond Position:  [1.42057975]


portfolio before change:  [1.66491413]
curr_Stock_Price:  101.50566726091492
curr_Factors:  [1.01505667e+02 3.55363187e-02]
mat_Sqrt:  [[ 1.91349137e+01  0.00000000e+00]
 [-7.54043168e-03  1.72772995e-02]]
grads:  [-0.00546112  2.32528689]
Stock Position:  -0.005461118005590753
Bond Position:  [2.21924856]


portfolio before change:  [1.66038681]
curr_Stock_Price:  102.38547660966472
curr_Factors:  [1.02385477e+02 3.60015948e-02]
mat_Sqrt:  [[ 1.94267086e+01  0.00000000e+00]
 [-7.58963448e-03  1.73900373e-02]]
grads:  [2.25472938e-03 3.81034074e+00]
Stock Position:  0.002254729375817827
Bond Position:  [1.42953527]


portfolio before change:  [1.65850622]
curr_Stock_Price:  101.47215567269103
curr_Factors:  [1.01472156e+02 3.67831186e-02]
mat_Sqrt:  [[ 1.94612692e+01  0.00000000e+00]
 [-7.67157022e-03  1.75777756e-02]]
grads:  [-0.00452325 -2.80132528]
Stock Position:  -0.004523248295127338
Bond Position:  [2.11748998]


portfolio before change:  [1.65494665]
curr_Stock_Price:  102.31762802052975
curr_Factors:  [1.02317628e+02 3.57609015e-02]
mat_Sqrt:  [[ 1.93488293e+01  0.00000000e+00]
 [-7.56422120e-03  1.73318081e-02]]
grads:  [0.0145108  8.02352815]
Stock Position:  0.014510801398262989
Bond Position:  [0.17023587]


portfolio before change:  [1.68563606]
curr_Stock_Price:  104.43109755206387
curr_Factors:  [1.04431098e+02 3.60636096e-02]
mat_Sqrt:  [[ 1.98319053e+01  0.00000000e+00]
 [-7.59616847e-03  1.74050085e-02]]
grads:  [2.92093295e-03 3.05470681e+00]
Stock Position:  0.002920932947470978
Bond Position:  [1.38059983]


portfolio before change:  [1.68490312]
curr_Stock_Price:  104.12108524050477
curr_Factors:  [1.04121085e+02 3.64226837e-02]
mat_Sqrt:  [[ 1.98712258e+01  0.00000000e+00]
 [-7.63389114e-03  1.74914420e-02]]
grads:  [7.44333693e-04 3.16245937e+00]
Stock Position:  0.0007443336926660427
Bond Position:  [1.60740229]


portfolio before change:  [1.6853326]
curr_Stock_Price:  104.42811680939825
curr_Factors:  [1.04428117e+02 3.72324426e-02]
mat_Sqrt:  [[ 2.01501466e+01  0.00000000e+00]
 [-7.71828402e-03  1.76848104e-02]]
grads:  [8.27826562e-03 1.05430890e+01]
Stock Position:  0.008278265615773125
Bond Position:  [0.82084891]


portfolio before change:  [1.67998447]
curr_Stock_Price:  103.76967733783262
curr_Factors:  [1.03769677e+02 3.75180544e-02]
mat_Sqrt:  [[ 2.00997484e+01  0.00000000e+00]
 [-7.74783112e-03  1.77525113e-02]]
grads:  [4.91942912e-03 6.19443481e+00]
Stock Position:  0.0049194291241514004
Bond Position:  [1.1694969]


portfolio before change:  [1.67672622]
curr_Stock_Price:  103.07763600818892
curr_Factors:  [1.03077636e+02 3.72585092e-02]
mat_Sqrt:  [[ 1.98965229e+01  0.00000000e+00]
 [-7.72098535e-03  1.76909999e-02]]
grads:  [  0.028034   -23.29989245]
Stock Position:  0.028034002698368022
Bond Position:  [-1.21295251]


portfolio before change:  [1.69902511]
curr_Stock_Price:  103.87846783371285
curr_Factors:  [1.03878468e+02 3.82789979e-02]
mat_Sqrt:  [[ 2.03238422e+01  0.00000000e+00]
 [-7.82600770e-03  1.79316363e-02]]
grads:  [-6.91014551e-03  2.32272047e+01]
Stock Position:  -0.0069101455088270945
Bond Position:  [2.41684044]


portfolio before change:  [1.70240726]
curr_Stock_Price:  103.43274316460162
curr_Factors:  [1.03432743e+02 3.84208699e-02]
mat_Sqrt:  [[ 2.02741026e+01  0.00000000e+00]
 [-7.84049691e-03  1.79648353e-02]]
grads:  [0.0066782  0.10742508]
Stock Position:  0.0066782049222071475
Bond Position:  [1.0116622]


portfolio before change:  [1.70074431]
curr_Stock_Price:  103.16479476448713
curr_Factors:  [1.03164795e+02 3.88083512e-02]
mat_Sqrt:  [[ 2.03232947e+01  0.00000000e+00]
 [-7.87993413e-03  1.80551973e-02]]
grads:  [-3.06697479e-03 -4.54334295e+00]
Stock Position:  -0.003066974789465582
Bond Position:  [2.01714813]


portfolio before change:  [1.70503277]
curr_Stock_Price:  101.84874342341075
curr_Factors:  [1.01848743e+02 3.90971553e-02]
mat_Sqrt:  [[ 2.01385527e+01  0.00000000e+00]
 [-7.90920024e-03  1.81222544e-02]]
grads:  [-0.0037209  -1.78075678]
Stock Position:  -0.003720903519901438
Bond Position:  [2.08400211]


portfolio before change:  [1.70404188]
curr_Stock_Price:  102.18505872495521
curr_Factors:  [1.02185059e+02 3.92116894e-02]
mat_Sqrt:  [[ 2.02346257e+01  0.00000000e+00]
 [-7.92077667e-03  1.81487793e-02]]
grads:  [-0.02302896 -5.34534343]
Stock Position:  -0.023028964654185868
Bond Position:  [4.05725799]


portfolio before change:  [1.64401437]
curr_Stock_Price:  104.813691920925
curr_Factors:  [1.04813692e+02 3.80215338e-02]
mat_Sqrt:  [[ 2.04377384e+01  0.00000000e+00]
 [-7.79964449e-03  1.78712306e-02]]
grads:  [-0.00037284 -0.33666862]
Stock Position:  -0.00037283527444253176
Bond Position:  [1.68309261]


portfolio before change:  [1.64421771]
curr_Stock_Price:  104.83263404116822
curr_Factors:  [1.04832634e+02 3.71730463e-02]
mat_Sqrt:  [[ 2.02120598e+01  0.00000000e+00]
 [-7.71212514e-03  1.76706986e-02]]
grads:  [ 0.01464801 12.46578554]
Stock Position:  0.01464800858962741
Bond Position:  [0.10862839]


portfolio before change:  [1.62767095]
curr_Stock_Price:  103.70208143747911
curr_Factors:  [1.03702081e+02 3.87671089e-02]
mat_Sqrt:  [[ 2.04182812e+01  0.00000000e+00]
 [-7.87574595e-03  1.80456010e-02]]
grads:  [0.01063751 2.31991246]
Stock Position:  0.010637511074756273
Bond Position:  [0.52453891]


portfolio before change:  [1.61656959]
curr_Stock_Price:  102.65231290721111
curr_Factors:  [1.02652313e+02 3.83381995e-02]
mat_Sqrt:  [[ 2.00994695e+01  0.00000000e+00]
 [-7.83205715e-03  1.79454974e-02]]
grads:  [-0.01717913 -9.68509665]
Stock Position:  -0.017179128723530827
Bond Position:  [3.38004689]


portfolio before change:  [1.62174612]
curr_Stock_Price:  102.37558184815241
curr_Factors:  [1.02375582e+02 3.98600132e-02]
mat_Sqrt:  [[ 2.04392569e+01  0.00000000e+00]
 [-7.98598905e-03  1.82981997e-02]]
grads:  [-9.09893830e-03 -2.09353178e+01]
Stock Position:  -0.009098938299955393
Bond Position:  [2.55325523]


portfolio before change:  [1.62437921]
curr_Stock_Price:  102.12127605656097
curr_Factors:  [1.02121276e+02 4.11916366e-02]
mat_Sqrt:  [[ 2.07262512e+01  0.00000000e+00]
 [-8.11828914e-03  1.86013372e-02]]
grads:  [-7.69588979e-04  1.33423594e+01]
Stock Position:  -0.0007695889789723938
Bond Position:  [1.70297062]


portfolio before change:  [1.62608375]
curr_Stock_Price:  100.1830336599153
curr_Factors:  [1.00183034e+02 4.28472123e-02]
mat_Sqrt:  [[ 2.07374554e+01  0.00000000e+00]
 [-8.27982728e-03  1.89714676e-02]]
grads:  [-3.48706783e-03  6.20057306e+00]
Stock Position:  -0.0034870678280544565
Bond Position:  [1.97542878]


portfolio before change:  [1.62210845]
curr_Stock_Price:  101.39386207429371
curr_Factors:  [1.01393862e+02 4.29397368e-02]
mat_Sqrt:  [[ 2.10107403e+01  0.00000000e+00]
 [-8.28876221e-03  1.89919401e-02]]
grads:  [0.00939993 4.48137647]
Stock Position:  0.009399932395619417
Bond Position:  [0.669013]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.62716101]
Stock Price:  101.92247563595926
PL:  [-0.29531462]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 8.41783996e-02  3.64442956e-01]
 [-1.64796586e-01 -8.67580055e-02]
 [ 8.66482120e-01 -8.04884583e-01]
 [-3.08035698e-02  1.51670451e-01]
 [ 2.97300913e-02 -6.52717168e-02]
 [-8.09914480e-02 -1.00942671e-01]
 [-1.00594022e-01  1.25440233e-01]
 [-6.02773887e-03 -1.27769523e-01]
 [ 1.66023979e-01  1.00104110e-01]
 [ 1.15120018e-01  6.87033636e-02]
 [ 1.23033545e-01  2.09110371e-01]
 [ 1.59364676e-01  2.14891966e-01]
 [ 1.06786090e-01  5.90123205e-02]
 [-3.44741137e-01 -4.60431886e-01]
 [ 7.69836764e-02  2.22897133e-01]
 [ 5.46873844e-02 -2.08422405e-02]
 [-5.25995999e-02  2.49801926e-01]
 [-1.31290046e-01  3.05045247e-02]
 [ 1.51006550e-02  6.08545081e-02]
 [-4.88958800e-02 -6.76633174e-02]
 [ 8.50093689e-02 -1.05541343e-02]
 [ 6.57904618e-02  2.75310379e-01]
 [ 3.01149286e-02  1.71519664e-01]
 [-7.73755005e-02  8.95575129e-02]
 [ 5.32285543e-02  1.16833495e-01]
 [ 6.88831912e-02  8.51581249e-02]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.69942379e-01  1.14929998e-01]
 [-2.41789749e-01 -1.58703769e-02]
 [ 1.40882799e-01 -7.92503554e-02]
 [-1.21541835e+00 -1.36761866e-01]
 [-8.77707507e-02  1.14585190e-01]
 [-9.38237394e-03 -1.21777021e-01]
 [ 4.19317706e-02  8.47790856e-02]
 [-6.54196591e-02  1.61025924e-01]
 [-8.12132469e-01 -2.51258575e-01]
 [-3.93912040e-02  2.81607773e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 6.12178121e-01  3.16462567e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.7065156]
curr_Stock_Price:  100.1504234483204
curr_Factors:  [1.00150423e+02 3.95668513e-02]
mat_Sqrt:  [[ 1.99213394e+01  0.00000000e+00]
 [-7.95656723e-03  1.82307858e-02]]
grads:  [1.22097385e-02 1.99905237e+01]
Stock Position:  0.012209738528831237
Bond Position:  [2.48370512]


portfolio before change:  [3.69351455]
curr_Stock_Price:  99.06018387069922
curr_Factors:  [9.90601839e+01 3.84374413e-02]
mat_Sqrt:  [[ 1.94212136e+01  0.00000000e+00]
 [-7.84218758e-03  1.79687091e-02]]
grads:  [-0.01043503 -4.8282826 ]
Stock Position:  -0.010435026764980525
Bond Position:  [4.72721022]


portfolio before change:  [3.70579845]
curr_Stock_Price:  97.93963381516059
curr_Factors:  [9.79396338e+01 3.77734950e-02]
mat_Sqrt:  [[ 1.90349640e+01  0.00000000e+00]
 [-7.77416182e-03  1.78128425e-02]]
grads:  [ 2.70660711e-02 -4.51856341e+01]
Stock Position:  0.02706607105092108
Bond Position:  [1.05495737]


portfolio before change:  [3.71125415]
curr_Stock_Price:  98.13633099129771
curr_Factors:  [9.81363310e+01 3.83171265e-02]
mat_Sqrt:  [[ 1.92099522e+01  0.00000000e+00]
 [-7.82990436e-03  1.79405647e-02]]
grads:  [1.84231806e-03 8.45405111e+00]
Stock Position:  0.0018423180621718153
Bond Position:  [3.53045582]


portfolio before change:  [3.71084039]
curr_Stock_Price:  97.67219182953556
curr_Factors:  [9.76721918e+01 3.74192931e-02]
mat_Sqrt:  [[ 1.88937743e+01  0.00000000e+00]
 [-7.73762683e-03  1.77291303e-02]]
grads:  [ 6.57983234e-05 -3.68160850e+00]
Stock Position:  6.579832337110565e-05
Bond Position:  [3.70441373]


portfolio before change:  [3.71132647]
curr_Stock_Price:  98.02162717598121
curr_Factors:  [9.80216272e+01 3.69069862e-02]
mat_Sqrt:  [[ 1.88311221e+01  0.00000000e+00]
 [-7.68447642e-03  1.76073474e-02]]
grads:  [-0.00664041 -5.73298568]
Stock Position:  -0.006640413715119096
Bond Position:  [4.36223062]


portfolio before change:  [3.71663226]
curr_Stock_Price:  97.30473277483424
curr_Factors:  [9.73047328e+01 3.76957405e-02]
mat_Sqrt:  [[ 1.88920943e+01  0.00000000e+00]
 [-7.76615637e-03  1.77944997e-02]]
grads:  [-2.42680433e-03  7.04938240e+00]
Stock Position:  -0.002426804325474007
Bond Position:  [3.9527718]


portfolio before change:  [3.71830791]
curr_Stock_Price:  96.81786688139803
curr_Factors:  [9.68178669e+01 3.80424681e-02]
mat_Sqrt:  [[ 1.88838200e+01  0.00000000e+00]
 [-7.80179139e-03  1.78761498e-02]]
grads:  [-3.27216264e-03 -7.14748557e+00]
Stock Position:  -0.003272162636073657
Bond Position:  [4.03511172]


portfolio before change:  [3.71564177]
curr_Stock_Price:  97.7868169316562
curr_Factors:  [9.77868169e+01 3.97303363e-02]
mat_Sqrt:  [[ 1.94913280e+01  0.00000000e+00]
 [-7.97298802e-03  1.82684106e-02]]
grads:  [0.0107593  5.47962886]
Stock Position:  0.010759297351213504
Bond Position:  [2.66352433]


portfolio before change:  [3.71567179]
curr_Stock_Price:  97.75866091985186
curr_Factors:  [9.77586609e+01 3.98658767e-02]
mat_Sqrt:  [[ 1.95189254e+01  0.00000000e+00]
 [-7.98657641e-03  1.82995455e-02]]
grads:  [0.00743405 3.75437542]
Stock Position:  0.007434047806563951
Bond Position:  [2.98892923]


portfolio before change:  [3.72116057]
curr_Stock_Price:  98.44672964829867
curr_Factors:  [9.84467296e+01 3.98031345e-02]
mat_Sqrt:  [[ 1.96408343e+01  0.00000000e+00]
 [-7.98028917e-03  1.82851396e-02]]
grads:  [1.09107785e-02 1.14360828e+01]
Stock Position:  0.010910778526619844
Bond Position:  [2.6470301]


portfolio before change:  [3.71483598]
curr_Stock_Price:  97.83673750301746
curr_Factors:  [9.78367375e+01 3.98099615e-02]
mat_Sqrt:  [[ 1.95208103e+01  0.00000000e+00]
 [-7.98097352e-03  1.82867076e-02]]
grads:  [ 0.01296827 11.75126599]
Stock Position:  0.012968274095409097
Bond Position:  [2.44606235]


portfolio before change:  [3.72915917]
curr_Stock_Price:  98.91763821688572
curr_Factors:  [9.89176382e+01 3.73017061e-02]
mat_Sqrt:  [[ 1.91046060e+01  0.00000000e+00]
 [-7.72545984e-03  1.77012522e-02]]
grads:  [0.00693766 3.33379355]
Stock Position:  0.006937655668607446
Bond Position:  [3.04290266]


portfolio before change:  [3.73525276]
curr_Stock_Price:  99.74114497395644
curr_Factors:  [9.97411450e+01 3.75001711e-02]
mat_Sqrt:  [[ 1.93148337e+01  0.00000000e+00]
 [-7.74598436e-03  1.77482798e-02]]
grads:  [ -0.02825238 -25.94233865]
Stock Position:  -0.028252383348504936
Bond Position:  [6.55317783]


portfolio before change:  [3.71043089]
curr_Stock_Price:  100.64871707596421
curr_Factors:  [1.00648717e+02 3.71013520e-02]
mat_Sqrt:  [[ 1.93866652e+01  0.00000000e+00]
 [-7.70468449e-03  1.76536499e-02]]
grads:  [8.98885696e-03 1.26261217e+01]
Stock Position:  0.008988856958199395
Bond Position:  [2.80571397]


portfolio before change:  [3.71716565]
curr_Stock_Price:  101.3589329983356
curr_Factors:  [1.01358933e+02 3.69468574e-02]
mat_Sqrt:  [[ 1.94827735e+01  0.00000000e+00]
 [-7.68862613e-03  1.76168556e-02]]
grads:  [ 0.00234007 -1.18308516]
Stock Position:  0.002340071593556027
Bond Position:  [3.47997849]


portfolio before change:  [3.7177199]
curr_Stock_Price:  101.40988134295759
curr_Factors:  [1.01409881e+02 3.80374056e-02]
mat_Sqrt:  [[ 1.97781524e+01  0.00000000e+00]
 [-7.80127226e-03  1.78749603e-02]]
grads:  [2.85278916e-03 1.39749639e+01]
Stock Position:  0.0028527891600620063
Bond Position:  [3.42841889]


portfolio before change:  [3.71783436]
curr_Stock_Price:  101.29977245632212
curr_Factors:  [1.01299772e+02 3.81353702e-02]
mat_Sqrt:  [[ 1.97821027e+01  0.00000000e+00]
 [-7.81131182e-03  1.78979638e-02]]
grads:  [-0.00596381  1.70435727]
Stock Position:  -0.005963813928105021
Bond Position:  [4.32196736]


portfolio before change:  [3.72439791]
curr_Stock_Price:  100.28980397967925
curr_Factors:  [1.00289804e+02 3.64933725e-02]
mat_Sqrt:  [[ 1.91586006e+01  0.00000000e+00]
 [-7.64129544e-03  1.75084074e-02]]
grads:  [2.17446674e-03 3.47573064e+00]
Stock Position:  0.002174466742617601
Bond Position:  [3.50632106]


portfolio before change:  [3.72616134]
curr_Stock_Price:  100.89920043421276
curr_Factors:  [1.00899200e+02 3.65583432e-02]
mat_Sqrt:  [[ 1.92921654e+01  0.00000000e+00]
 [-7.64809448e-03  1.75239859e-02]]
grads:  [-0.0040652  -3.86118305]
Stock Position:  -0.004065203203934678
Bond Position:  [4.13633709]


portfolio before change:  [3.73240667]
curr_Stock_Price:  99.49010541432449
curr_Factors:  [9.94901054e+01 3.60224617e-02]
mat_Sqrt:  [[ 1.88828083e+01  0.00000000e+00]
 [-7.59183368e-03  1.73950763e-02]]
grads:  [ 0.00425801 -0.60673113]
Stock Position:  0.004258008963203047
Bond Position:  [3.30877691]


portfolio before change:  [3.72767527]
curr_Stock_Price:  98.28178886431887
curr_Factors:  [9.82817889e+01 3.71137710e-02]
mat_Sqrt:  [[ 1.89339225e+01  0.00000000e+00]
 [-7.70597389e-03  1.76566043e-02]]
grads:  [9.82077339e-03 1.55924873e+01]
Stock Position:  0.009820773393829002
Bond Position:  [2.76247209]


portfolio before change:  [3.71250413]
curr_Stock_Price:  96.70182482953186
curr_Factors:  [9.67018248e+01 3.80845200e-02]
mat_Sqrt:  [[ 1.88716083e+01  0.00000000e+00]
 [-7.80610223e-03  1.78860272e-02]]
grads:  [5.56244310e-03 9.58958984e+00]
Stock Position:  0.005562443101755157
Bond Position:  [3.17460573]


portfolio before change:  [3.71166687]
curr_Stock_Price:  96.47995971258301
curr_Factors:  [9.64799597e+01 3.82973545e-02]
mat_Sqrt:  [[ 1.88808482e+01  0.00000000e+00]
 [-7.82788395e-03  1.79359354e-02]]
grads:  [-2.02794901e-03  4.99318888e+00]
Stock Position:  -0.0020279490123189317
Bond Position:  [3.90732331]


portfolio before change:  [3.71183397]
curr_Stock_Price:  96.63841941061158
curr_Factors:  [9.66384194e+01 3.80092308e-02]
mat_Sqrt:  [[ 1.88405839e+01  0.00000000e+00]
 [-7.79838248e-03  1.78683390e-02]]
grads:  [5.53161580e-03 6.53857611e+00]
Stock Position:  0.005531615799494425
Bond Position:  [3.17726736]


portfolio before change:  [3.71065127]
curr_Stock_Price:  96.35281010787843
curr_Factors:  [9.63528101e+01 3.57733147e-02]
mat_Sqrt:  [[ 1.82240113e+01  0.00000000e+00]
 [-7.56553393e-03  1.73348159e-02]]
grads:  [0.0058192  4.91254855]
Stock Position:  0.00581920422893402
Bond Position:  [3.14995459]


portfolio before change:  [3.71163537]
curr_Stock_Price:  96.45425561629712
curr_Factors:  [9.64542556e+01 3.80124812e-02]
mat_Sqrt:  [[ 1.88054835e+01  0.00000000e+00]
 [-7.79871592e-03  1.78691030e-02]]
grads:  [9.47391758e-03 9.78993709e+00]
Stock Position:  0.009473917575126936
Bond Position:  [2.7978357]


portfolio before change:  [3.70677732]
curr_Stock_Price:  95.90455645936076
curr_Factors:  [9.59045565e+01 3.72179393e-02]
mat_Sqrt:  [[ 1.85018605e+01  0.00000000e+00]
 [-7.71678061e-03  1.76813656e-02]]
grads:  [-6.47409571e-03  6.50006340e+00]
Stock Position:  -0.006474095712515264
Bond Position:  [4.32767259]


portfolio before change:  [3.70861571]
curr_Stock_Price:  95.70415720233603
curr_Factors:  [9.57041572e+01 3.78117319e-02]
mat_Sqrt:  [[ 1.86099021e+01  0.00000000e+00]
 [-7.77809559e-03  1.78218559e-02]]
grads:  [-0.01336472 -0.8905008 ]
Stock Position:  -0.013364720983336334
Bond Position:  [4.98767507]


portfolio before change:  [3.70014317]
curr_Stock_Price:  96.38475793011007
curr_Factors:  [9.63847579e+01 3.66385998e-02]
mat_Sqrt:  [[ 1.84492109e+01  0.00000000e+00]
 [-7.65648481e-03  1.75432106e-02]]
grads:  [ 0.0057615  -4.51743738]
Stock Position:  0.005761498929174585
Bond Position:  [3.14482249]


portfolio before change:  [3.68954185]
curr_Stock_Price:  94.47649592493794
curr_Factors:  [9.44764959e+01 3.82626557e-02]
mat_Sqrt:  [[ 1.84803985e+01  0.00000000e+00]
 [-7.82433698e-03  1.79278082e-02]]
grads:  [-0.06899776 -7.62847664]
Stock Position:  -0.0689977608436266
Bond Position:  [10.20820852]


portfolio before change:  [3.58379163]
curr_Stock_Price:  96.02765239694173
curr_Factors:  [9.60276524e+01 3.81433006e-02]
mat_Sqrt:  [[ 1.87544981e+01  0.00000000e+00]
 [-7.81212398e-03  1.78998247e-02]]
grads:  [-2.01347292e-03  6.40146992e+00]
Stock Position:  -0.002013472916217941
Bond Position:  [3.77714071]


portfolio before change:  [3.5852957]
curr_Stock_Price:  95.51515966060546
curr_Factors:  [9.55151597e+01 3.99674039e-02]
mat_Sqrt:  [[ 1.90952468e+01  0.00000000e+00]
 [-7.99673972e-03  1.83228325e-02]]
grads:  [-3.27464860e-03 -6.64618971e+00]
Stock Position:  -0.0032746486044580967
Bond Position:  [3.89807428]


portfolio before change:  [3.58559459]
curr_Stock_Price:  95.57269075764734
curr_Factors:  [9.55726908e+01 3.87643425e-02]
mat_Sqrt:  [[ 1.88169844e+01  0.00000000e+00]
 [-7.87546494e-03  1.80449571e-02]]
grads:  [4.19474213e-03 4.69821486e+00]
Stock Position:  0.004194742126643113
Bond Position:  [3.1846918]


portfolio before change:  [3.58877398]
curr_Stock_Price:  96.23573053935252
curr_Factors:  [9.62357305e+01 3.88946324e-02]
mat_Sqrt:  [[ 1.89793434e+01  0.00000000e+00]
 [-7.88868885e-03  1.80752569e-02]]
grads:  [2.55952783e-04 8.90863820e+00]
Stock Position:  0.000255952783024487
Bond Position:  [3.56414218]


portfolio before change:  [3.58958532]
curr_Stock_Price:  97.66487984068688
curr_Factors:  [9.76648798e+01 3.93414018e-02]
mat_Sqrt:  [[ 1.93715038e+01  0.00000000e+00]
 [-7.93386683e-03  1.81787727e-02]]
grads:  [ -0.04758488 -13.82153678]
Stock Position:  -0.04758488097853982
Bond Position:  [8.23695701]


portfolio before change:  [3.64838722]
curr_Stock_Price:  96.4507922127351
curr_Factors:  [9.64507922e+01 3.84746218e-02]
mat_Sqrt:  [[ 1.89187735e+01  0.00000000e+00]
 [-7.84597953e-03  1.79773976e-02]]
grads:  [4.41426628e-03 1.56645461e+01]
Stock Position:  0.004414266277783947
Bond Position:  [3.22262774]


portfolio before change:  [3.64904136]
curr_Stock_Price:  96.50771659170132
curr_Factors:  [9.65077166e+01 3.84362169e-02]
mat_Sqrt:  [[ 1.89204890e+01  0.00000000e+00]
 [-7.84206267e-03  1.79684229e-02]]
grads:  [-4.66083171e-03  6.08633072e+00]
Stock Position:  -0.00466083171064544
Bond Position:  [4.09884758]


portfolio before change:  [3.64086256]
curr_Stock_Price:  98.37244463611404
curr_Factors:  [9.83724446e+01 3.80546597e-02]
mat_Sqrt:  [[ 1.91901065e+01  0.00000000e+00]
 [-7.80304143e-03  1.78790140e-02]]
grads:  [0.03262044 1.77002248]
Stock Position:  0.032620437982648146
Bond Position:  [0.43191033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.64192129]
Stock Price:  98.40324543690072
PL:  [3.64192129]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.11815257e-01  6.46431595e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.55122180e-01 -7.79926278e-01]
 [-4.18925958e-02  9.97852528e-02]
 [ 3.12192485e-02 -1.30005609e-02]
 [-7.93604626e-02 -1.07597451e-01]
 [-6.11120558e-02  1.79029138e-01]
 [-8.43803331e-02 -1.08949102e-01]
 [ 1.66001936e-01  8.58532089e-02]
 [ 1.39329467e-01  3.52200410e-02]
 [ 1.48351017e-01  2.99376946e-01]
 [ 1.75885633e-01  2.28270283e-01]
 [ 2.18393921e-01  2.28540465e-02]
 [-9.87367143e-03  7.72240861e-02]
 [ 9.88192484e-02  2.39005763e-01]
 [ 4.19365144e-02  1.09451474e-01]
 [ 1.06210960e-01  2.45887759e-01]
 [ 1.54813980e-01  7.69773673e-02]
 [ 8.19928527e-02 -1.78847584e-01]
 [ 5.70482463e-01 -1.37965557e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 1.13561700e-02 -1.08444477e-01]
 [-1.04265000e-01  8.20530170e-02]
 [ 8.57152776e-02 -3.89217990e-01]
 [ 7.03927252e-02  2.53192188e-01]
 [ 1.48541244e-02  1.52380673e-01]
 [ 1.39152986e-02  1.59570425e-01]
 [-1.39211297e-01  4.43953756e-02]
 [-6.02627562e-01  1.41923161e-01]
 [ 2.98784974e-01  1.76853995e-01]
 [-2.00072028e+00 -2.24343668e-01]
 [ 4.21541446e-01  7.66255254e-01]
 [ 1.07748139e-01 -1.68155858e-01]
 [ 3.00163221e-01 -6.42240681e-02]
 [ 5.54110024e-02  1.84213180e-01]
 [-2.22592200e+00  4.98582040e-01]
 [-2.36529583e-01 -9.30652412e-02]
 [-1.29504741e-01 -6.32826683e-01]
 [ 2.25621953e+00 -1.79034996e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.11952532]
curr_Stock_Price:  100.96571032323519
curr_Factors:  [1.00965710e+02 3.94642058e-02]
mat_Sqrt:  [[ 2.00574440e+01  0.00000000e+00]
 [-7.94623995e-03  1.82071230e-02]]
grads:  [2.96120051e-02 3.55043240e+01]
Stock Position:  0.029612005080268407
Bond Position:  [6.12972819]


portfolio before change:  [9.08558492]
curr_Stock_Price:  99.79366326964171
curr_Factors:  [9.97936633e+01 3.97898607e-02]
mat_Sqrt:  [[ 1.99062372e+01  0.00000000e+00]
 [-7.97895840e-03  1.82820904e-02]]
grads:  [-0.01019703 -4.81407586]
Stock Position:  -0.01019702749719313
Bond Position:  [10.10318365]


portfolio before change:  [9.10220038]
curr_Stock_Price:  98.28807929773485
curr_Factors:  [9.82880793e+01 4.07493681e-02]
mat_Sqrt:  [[ 1.98408963e+01  0.00000000e+00]
 [-8.07458909e-03  1.85012079e-02]]
grads:  [ 2.59431045e-02 -4.21554248e+01]
Stock Position:  0.02594310446805295
Bond Position:  [6.55230247]


portfolio before change:  [9.11885388]
curr_Stock_Price:  98.89843096199009
curr_Factors:  [9.88984310e+01 4.12236999e-02]
mat_Sqrt:  [[ 2.00799619e+01  0.00000000e+00]
 [-8.12144813e-03  1.86085754e-02]]
grads:  [8.25329708e-05 5.36232627e+00]
Stock Position:  8.25329708225735e-05
Bond Position:  [9.1106915]


portfolio before change:  [9.1199975]
curr_Stock_Price:  98.95552935806799
curr_Factors:  [9.89555294e+01 4.07600987e-02]
mat_Sqrt:  [[ 1.99782609e+01  0.00000000e+00]
 [-8.07565216e-03  1.85036437e-02]]
grads:  [ 0.00127866 -0.70259464]
Stock Position:  0.0012786567736304752
Bond Position:  [8.99346735]


portfolio before change:  [9.118728]
curr_Stock_Price:  97.08343899775774
curr_Factors:  [9.70834390e+01 4.12724168e-02]
mat_Sqrt:  [[ 1.97230966e+01  0.00000000e+00]
 [-8.12624556e-03  1.86195677e-02]]
grads:  [-0.00640467 -5.7787298 ]
Stock Position:  -0.006404665672606049
Bond Position:  [9.74051497]


portfolio before change:  [9.11107049]
curr_Stock_Price:  98.46917093793849
curr_Factors:  [9.84691709e+01 4.12152710e-02]
mat_Sqrt:  [[ 1.99907626e+01  0.00000000e+00]
 [-8.12061781e-03  1.86066729e-02]]
grads:  [8.51526589e-04 9.62177059e+00]
Stock Position:  0.0008515265890530967
Bond Position:  [9.02722137]


portfolio before change:  [9.11147245]
curr_Stock_Price:  97.61598431893411
curr_Factors:  [9.76159843e+01 4.13961373e-02]
mat_Sqrt:  [[ 1.98609879e+01  0.00000000e+00]
 [-8.13841629e-03  1.86474543e-02]]
grads:  [-0.00664265 -5.84257239]
Stock Position:  -0.006642651413850257
Bond Position:  [9.75990141]


portfolio before change:  [9.10604094]
curr_Stock_Price:  98.61732675484643
curr_Factors:  [9.86173268e+01 3.97058198e-02]
mat_Sqrt:  [[ 1.96508033e+01  0.00000000e+00]
 [-7.97052769e-03  1.82627732e-02]]
grads:  [0.01035435 4.70099518]
Stock Position:  0.010354352667735588
Bond Position:  [8.08492236]


portfolio before change:  [9.10236791]
curr_Stock_Price:  98.16498430885979
curr_Factors:  [9.81649843e+01 4.14698734e-02]
mat_Sqrt:  [[ 1.99904677e+01  0.00000000e+00]
 [-8.14566126e-03  1.86640547e-02]]
grads:  [0.00773873 1.88705196]
Stock Position:  0.007738726028536919
Bond Position:  [8.34269599]


portfolio before change:  [9.09599504]
curr_Stock_Price:  97.20671610185092
curr_Factors:  [9.72067161e+01 4.11110199e-02]
mat_Sqrt:  [[ 1.97094905e+01  0.00000000e+00]
 [-8.11034104e-03  1.85831259e-02]]
grads:  [1.41561157e-02 1.61101500e+01]
Stock Position:  0.014156115731264497
Bond Position:  [7.71992551]


portfolio before change:  [9.10143692]
curr_Stock_Price:  97.5229632965809
curr_Factors:  [9.75229633e+01 4.05973767e-02]
mat_Sqrt:  [[ 1.96496978e+01  0.00000000e+00]
 [-8.05951628e-03  1.84666717e-02]]
grads:  [ 0.01402113 12.36120329]
Stock Position:  0.014021129240632972
Bond Position:  [7.73405485]


portfolio before change:  [9.09002285]
curr_Stock_Price:  96.63994668925358
curr_Factors:  [9.66399467e+01 4.35226519e-02]
mat_Sqrt:  [[ 2.01611062e+01  0.00000000e+00]
 [-8.34483331e-03  1.91204152e-02]]
grads:  [0.01132717 1.19526937]
Stock Position:  0.011327168415842364
Bond Position:  [7.9953659]


portfolio before change:  [9.06693529]
curr_Stock_Price:  94.51346278221831
curr_Factors:  [9.45134628e+01 4.60374979e-02]
mat_Sqrt:  [[ 2.02791399e+01  0.00000000e+00]
 [-8.58254022e-03  1.96650701e-02]]
grads:  [1.17508351e-03 3.92696724e+00]
Stock Position:  0.00117508350735502
Bond Position:  [8.95587408]


portfolio before change:  [9.06812174]
curr_Stock_Price:  94.5703892642272
curr_Factors:  [9.45703893e+01 4.48734614e-02]
mat_Sqrt:  [[ 2.00331832e+01  0.00000000e+00]
 [-8.47334280e-03  1.94148674e-02]]
grads:  [1.01396724e-02 1.23104504e+01]
Stock Position:  0.010139672425465368
Bond Position:  [8.10920897]


portfolio before change:  [9.07970156]
curr_Stock_Price:  95.61244512783881
curr_Factors:  [9.56124451e+01 4.33312632e-02]
mat_Sqrt:  [[ 1.99028422e+01  0.00000000e+00]
 [-8.32646511e-03  1.90783283e-02]]
grads:  [4.50714793e-03 5.73695308e+00]
Stock Position:  0.0045071479299338
Bond Position:  [8.64876212]


portfolio before change:  [9.07675461]
curr_Stock_Price:  94.71872847390497
curr_Factors:  [9.47187285e+01 4.37148999e-02]
mat_Sqrt:  [[ 1.98038945e+01  0.00000000e+00]
 [-8.36324338e-03  1.91625979e-02]]
grads:  [1.07819791e-02 1.28316505e+01]
Stock Position:  0.010781979107609719
Bond Position:  [8.05549925]


portfolio before change:  [9.0593756]
curr_Stock_Price:  93.01347508426994
curr_Factors:  [9.30134751e+01 4.36751930e-02]
mat_Sqrt:  [[ 1.94385241e+01  0.00000000e+00]
 [-8.35944429e-03  1.91538931e-02]]
grads:  [0.00969259 4.01888884]
Stock Position:  0.009692590689759145
Bond Position:  [8.15783406]


portfolio before change:  [9.0408604]
curr_Stock_Price:  90.99801893954611
curr_Factors:  [9.09980189e+01 4.48331476e-02]
mat_Sqrt:  [[ 1.92677744e+01  0.00000000e+00]
 [-8.46953577e-03  1.94061444e-02]]
grads:  [ 2.04349897e-04 -9.21602873e+00]
Stock Position:  0.00020434989672570795
Bond Position:  [9.02226497]


portfolio before change:  [9.04203414]
curr_Stock_Price:  91.22257545095736
curr_Factors:  [9.12225755e+01 4.44304851e-02]
mat_Sqrt:  [[ 1.92283871e+01  0.00000000e+00]
 [-8.43141602e-03  1.93188011e-02]]
grads:  [ 0.02653729 -7.14151756]
Stock Position:  0.026537293791717348
Bond Position:  [6.62123386]


portfolio before change:  [9.06541222]
curr_Stock_Price:  92.0723368341826
curr_Factors:  [9.20723368e+01 4.50406250e-02]
mat_Sqrt:  [[ 1.95403064e+01  0.00000000e+00]
 [-8.48911067e-03  1.94509961e-02]]
grads:  [ 0.00215599 -1.94221362]
Stock Position:  0.0021559851560660525
Bond Position:  [8.86690562]


portfolio before change:  [9.06146791]
curr_Stock_Price:  89.72874887363652
curr_Factors:  [8.97287489e+01 4.73740334e-02]
mat_Sqrt:  [[ 1.95299798e+01  0.00000000e+00]
 [-8.70623072e-03  1.99484806e-02]]
grads:  [-1.84193125e-03 -5.43622740e+00]
Stock Position:  -0.0018419312469619084
Bond Position:  [9.22674209]


portfolio before change:  [9.06115]
curr_Stock_Price:  90.52754259399825
curr_Factors:  [9.05275426e+01 4.52428767e-02]
mat_Sqrt:  [[ 1.92555460e+01  0.00000000e+00]
 [-8.50814920e-03  1.94946189e-02]]
grads:  [-3.55503438e-03  4.20900853e+00]
Stock Position:  -0.0035550343756003103
Bond Position:  [9.38297853]


portfolio before change:  [9.06165939]
curr_Stock_Price:  90.71419471035338
curr_Factors:  [9.07141947e+01 4.40388222e-02]
mat_Sqrt:  [[ 1.90367627e+01  0.00000000e+00]
 [-8.39417152e-03  1.92334632e-02]]
grads:  [-4.42057196e-03 -2.02365006e+01]
Stock Position:  -0.004420571955905964
Bond Position:  [9.46266802]


portfolio before change:  [9.06237308]
curr_Stock_Price:  90.82033857397556
curr_Factors:  [9.08203386e+01 4.48262451e-02]
mat_Sqrt:  [[ 1.92286723e+01  0.00000000e+00]
 [-8.46888376e-03  1.94046505e-02]]
grads:  [9.40755829e-03 1.30480159e+01]
Stock Position:  0.009407558287981345
Bond Position:  [8.20797545]


portfolio before change:  [9.06506944]
curr_Stock_Price:  90.99788675908961
curr_Factors:  [9.09978868e+01 4.38010908e-02]
mat_Sqrt:  [[ 1.90446839e+01  0.00000000e+00]
 [-8.37148405e-03  1.91814797e-02]]
grads:  [4.27197965e-03 7.94415630e+00]
Stock Position:  0.00427197964650059
Bond Position:  [8.67632832]


portfolio before change:  [9.06418645]
curr_Stock_Price:  90.5373052751872
curr_Factors:  [9.05373053e+01 4.50024082e-02]
mat_Sqrt:  [[ 1.92063766e+01  0.00000000e+00]
 [-8.48550842e-03  1.94427423e-02]]
grads:  [4.35051041e-03 8.20719744e+00]
Stock Position:  0.004350510411880892
Bond Position:  [8.67030296]


portfolio before change:  [9.05960602]
curr_Stock_Price:  89.23532284706253
curr_Factors:  [8.92353228e+01 4.70535066e-02]
mat_Sqrt:  [[ 1.93567658e+01  0.00000000e+00]
 [-8.67672810e-03  1.98808817e-02]]
grads:  [-0.00619089  2.23306875]
Stock Position:  -0.00619088783890666
Bond Position:  [9.61205189]


portfolio before change:  [9.05686099]
curr_Stock_Price:  89.8728094519752
curr_Factors:  [8.98728095e+01 4.64699319e-02]
mat_Sqrt:  [[ 1.93737788e+01  0.00000000e+00]
 [-8.62275426e-03  1.97572121e-02]]
grads:  [-0.0279082  7.1833597]
Stock Position:  -0.027908196071096406
Bond Position:  [11.56504898]


portfolio before change:  [9.13503937]
curr_Stock_Price:  87.1233429024689
curr_Factors:  [8.71233429e+01 4.62668024e-02]
mat_Sqrt:  [[ 1.87399865e+01  0.00000000e+00]
 [-8.60388772e-03  1.97139834e-02]]
grads:  [0.02006247 8.9709924 ]
Stock Position:  0.02006246831407419
Bond Position:  [7.38713006]


portfolio before change:  [9.12818978]
curr_Stock_Price:  86.735901137028
curr_Factors:  [8.67359011e+01 4.57255458e-02]
mat_Sqrt:  [[ 1.85471995e+01  0.00000000e+00]
 [-8.55341296e-03  1.95983312e-02]]
grads:  [ -0.11315088 -11.44708017]
Stock Position:  -0.11315087675344634
Bond Position:  [18.94243304]


portfolio before change:  [9.16737749]
curr_Stock_Price:  86.41049697743816
curr_Factors:  [8.64104970e+01 4.69818818e-02]
mat_Sqrt:  [[ 1.87297382e+01  0.00000000e+00]
 [-8.67012174e-03  1.98657446e-02]]
grads:  [ 0.04036162 38.57168561]
Stock Position:  0.040361624242997725
Bond Position:  [5.67970948]


portfolio before change:  [9.1413196]
curr_Stock_Price:  85.7472952594604
curr_Factors:  [8.57472953e+01 4.70866030e-02]
mat_Sqrt:  [[ 1.86066895e+01  0.00000000e+00]
 [-8.67977908e-03  1.98878723e-02]]
grads:  [ 1.84658889e-03 -8.45519597e+00]
Stock Position:  0.0018465888859464214
Bond Position:  [8.9829796]


portfolio before change:  [9.14413758]
curr_Stock_Price:  86.66522422506694
curr_Factors:  [8.66652242e+01 4.84028416e-02]
mat_Sqrt:  [[ 1.90669090e+01  0.00000000e+00]
 [-8.80025832e-03  2.01639249e-02]]
grads:  [ 0.01427256 -3.18509756]
Stock Position:  0.014272556691957754
Bond Position:  [7.90720326]


portfolio before change:  [9.12509775]
curr_Stock_Price:  85.2619507858579
curr_Factors:  [8.52619508e+01 4.73720594e-02]
mat_Sqrt:  [[ 1.85573688e+01  0.00000000e+00]
 [-8.70604934e-03  1.99480651e-02]]
grads:  [7.31829103e-03 9.23463901e+00]
Stock Position:  0.007318291026880504
Bond Position:  [8.50112598]


portfolio before change:  [9.12066331]
curr_Stock_Price:  84.5107989829779
curr_Factors:  [8.45107990e+01 4.74026808e-02]
mat_Sqrt:  [[ 1.83998236e+01  0.00000000e+00]
 [-8.70886268e-03  1.99545112e-02]]
grads:  [-0.10914903 24.98593096]
Stock Position:  -0.10914903306990828
Bond Position:  [18.3449353]


portfolio before change:  [9.1402482]
curr_Stock_Price:  84.35237674240607
curr_Factors:  [8.43523767e+01 4.68895883e-02]
mat_Sqrt:  [[ 1.82656669e+01  0.00000000e+00]
 [-8.66160154e-03  1.98462224e-02]]
grads:  [-0.01517309 -4.68931767]
Stock Position:  -0.015173088670399347
Bond Position:  [10.42013429]


portfolio before change:  [9.13418273]
curr_Stock_Price:  84.83797767954685
curr_Factors:  [8.48379777e+01 4.80751963e-02]
mat_Sqrt:  [[ 1.86016231e+01  0.00000000e+00]
 [-8.77042269e-03  2.00955629e-02]]
grads:  [-2.18095456e-02 -3.14908662e+01]
Stock Position:  -0.021809545634201205
Bond Position:  [10.98446048]


portfolio before change:  [9.14699318]
curr_Stock_Price:  84.31356034362098
curr_Factors:  [8.43135603e+01 4.71274970e-02]
mat_Sqrt:  [[ 1.83035199e+01  0.00000000e+00]
 [-8.68354739e-03  1.98965066e-02]]
grads:  [ 0.118998   -8.99831309]
Stock Position:  0.11899799941603875
Bond Position:  [-0.88615182]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.20397111]
Stock Price:  84.79330540310211
PL:  [9.20397111]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.50302255e-01  8.43842244e-01]
 [-2.47804754e-01 -6.43850777e-02]
 [ 7.57046471e-01 -6.40655494e-01]
 [ 4.30666530e-03  2.41349248e-02]
 [-1.38438549e-02  8.90038230e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-4.57363827e-03  3.13469673e-01]
 [-1.22146133e-01 -8.81866378e-02]
 [ 1.44590131e-01  7.69505191e-02]
 [ 2.70577603e-01 -1.14838687e-01]
 [ 1.24439714e-01  2.14123909e-01]
 [-7.25094188e-02  4.26563204e-02]
 [-1.05374782e-01  1.37067565e-01]
 [-3.96084078e-01 -5.20726051e-01]
 [ 7.73577237e-02  2.23215647e-01]
 [ 5.47502296e-02 -2.08822825e-02]
 [-5.13348013e-02  1.78703503e-01]
 [-8.52927733e-02  1.06995909e-02]
 [ 1.56646649e-02  4.68500573e-02]
 [ 1.86273934e-02 -9.47672502e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 4.22884810e-02  2.15661662e-01]
 [ 2.82565809e-02  1.60140568e-01]
 [-3.65553478e-02  1.09717999e-02]
 [ 4.48059264e-02  1.50914874e-01]
 [ 1.21575475e-01  5.93821446e-02]
 [ 9.36928544e-02  1.81416852e-01]
 [-1.99097325e-01  1.43153075e-01]
 [-9.14369243e-02 -9.13128484e-02]
 [ 2.33831569e-02 -5.17892372e-02]
 [-7.80988183e-01 -9.61605217e-02]
 [-1.18151315e-01  8.38396568e-03]
 [ 5.70505829e-02 -3.47474049e-02]
 [ 1.24262364e-01  8.01713156e-02]
 [-2.37626659e-01 -5.43501133e-02]
 [-4.43332566e-01 -3.45710856e-01]
 [-5.23100123e-02  3.03532911e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 3.59472234e-01  5.96725616e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.32165047]
curr_Stock_Price:  101.59861838437354
curr_Factors:  [1.01598618e+02 3.95795562e-02]
mat_Sqrt:  [[ 2.02126503e+01  0.00000000e+00]
 [-7.95784456e-03  1.82337125e-02]]
grads:  [4.04986576e-02 4.62792338e+01]
Stock Position:  0.04049865757851707
Bond Position:  [9.20704282]


portfolio before change:  [13.34389591]
curr_Stock_Price:  102.11948726047355
curr_Factors:  [1.02119487e+02 3.95550053e-02]
mat_Sqrt:  [[ 2.03099731e+01  0.00000000e+00]
 [-7.95537607e-03  1.82280565e-02]]
grads:  [-0.01358469 -3.53219652]
Stock Position:  -0.013584690831864053
Bond Position:  [14.73115758]


portfolio before change:  [13.3617253]
curr_Stock_Price:  100.94258340803329
curr_Factors:  [1.00942583e+02 3.98604777e-02]
mat_Sqrt:  [[ 2.01532766e+01  0.00000000e+00]
 [-7.98603559e-03  1.82983063e-02]]
grads:  [ 2.36905145e-02 -3.50117373e+01]
Stock Position:  0.02369051448035582
Bond Position:  [10.97034357]


portfolio before change:  [13.35508648]
curr_Stock_Price:  100.60446514461522
curr_Factors:  [1.00604465e+02 4.23060960e-02]
mat_Sqrt:  [[ 2.06927748e+01  0.00000000e+00]
 [-8.22737829e-03  1.88512919e-02]]
grads:  [7.17159017e-04 1.28027962e+00]
Stock Position:  0.0007171590165333121
Bond Position:  [13.28293708]


portfolio before change:  [13.3562984]
curr_Stock_Price:  99.97900097739232
curr_Factors:  [9.99790010e+01 4.17999806e-02]
mat_Sqrt:  [[ 2.04407503e+01  0.00000000e+00]
 [-8.17801742e-03  1.87381919e-02]]
grads:  [-0.00048723  0.47498618]
Stock Position:  -0.00048723307311919874
Bond Position:  [13.40501147]


portfolio before change:  [13.35843335]
curr_Stock_Price:  99.03649843871243
curr_Factors:  [9.90364984e+01 4.32282219e-02]
mat_Sqrt:  [[ 2.05910723e+01  0.00000000e+00]
 [-8.31655909e-03  1.90556308e-02]]
grads:  [-0.00575107 -3.4801749 ]
Stock Position:  -0.0057510735742911795
Bond Position:  [13.92799953]


portfolio before change:  [13.35204483]
curr_Stock_Price:  100.45008141888843
curr_Factors:  [1.00450081e+02 4.41758210e-02]
mat_Sqrt:  [[ 2.11126432e+01  0.00000000e+00]
 [-8.40721795e-03  1.92633563e-02]]
grads:  [6.26334382e-03 1.62728482e+01]
Stock Position:  0.006263343818566045
Bond Position:  [12.72289144]


portfolio before change:  [13.34197849]
curr_Stock_Price:  98.58896574831743
curr_Factors:  [9.85889657e+01 4.48459954e-02]
mat_Sqrt:  [[ 2.08780602e+01  0.00000000e+00]
 [-8.47074924e-03  1.94089248e-02]]
grads:  [-0.00769391 -4.54361274]
Stock Position:  -0.007693911031251802
Bond Position:  [14.10051322]


portfolio before change:  [13.32928331]
curr_Stock_Price:  100.46809522707095
curr_Factors:  [1.00468095e+02 4.12900909e-02]
mat_Sqrt:  [[ 2.04150801e+01  0.00000000e+00]
 [-8.12798533e-03  1.86235540e-02]]
grads:  [0.00872757 4.13189228]
Stock Position:  0.00872757246414607
Bond Position:  [12.45244073]


portfolio before change:  [13.32585813]
curr_Stock_Price:  99.89728054852787
curr_Factors:  [9.98972805e+01 4.30084299e-02]
mat_Sqrt:  [[ 2.07171714e+01  0.00000000e+00]
 [-8.29538956e-03  1.90071253e-02]]
grads:  [ 0.01064131 -6.04187563]
Stock Position:  0.010641312276030919
Bond Position:  [12.26281998]


portfolio before change:  [13.31128781]
curr_Stock_Price:  98.38400175102767
curr_Factors:  [9.83840018e+01 4.48929746e-02]
mat_Sqrt:  [[ 2.08455652e+01  0.00000000e+00]
 [-8.47518492e-03  1.94190882e-02]]
grads:  [1.04526334e-02 1.10264657e+01]
Stock Position:  0.010452633355828828
Bond Position:  [12.28291591]


portfolio before change:  [13.32705135]
curr_Stock_Price:  99.7451972315183
curr_Factors:  [9.97451972e+01 4.29180471e-02]
mat_Sqrt:  [[ 2.06638847e+01  0.00000000e+00]
 [-8.28666853e-03  1.89871429e-02]]
grads:  [-0.00260806  2.24658974]
Stock Position:  -0.0026080611217349555
Bond Position:  [13.58719292]


portfolio before change:  [13.32543053]
curr_Stock_Price:  101.01791294314474
curr_Factors:  [1.01017913e+02 4.30245787e-02]
mat_Sqrt:  [[ 2.09535062e+01  0.00000000e+00]
 [-8.29694678e-03  1.90106933e-02]]
grads:  [-2.17403200e-03  7.21002449e+00]
Stock Position:  -0.0021740319964665767
Bond Position:  [13.54504671]


portfolio before change:  [13.32854433]
curr_Stock_Price:  100.36449142782553
curr_Factors:  [1.00364491e+02 4.42395558e-02]
mat_Sqrt:  [[ 2.11098655e+01  0.00000000e+00]
 [-8.41328053e-03  1.92772474e-02]]
grads:  [ -0.02952873 -27.01246913]
Stock Position:  -0.029528731862299706
Bond Position:  [16.29218048]


portfolio before change:  [13.32525891]
curr_Stock_Price:  100.54472480959673
curr_Factors:  [1.00544725e+02 4.43867620e-02]
mat_Sqrt:  [[ 2.11829296e+01  0.00000000e+00]
 [-8.42726641e-03  1.93092931e-02]]
grads:  [8.25084266e-03 1.15600113e+01]
Stock Position:  0.008250842661665722
Bond Position:  [12.49568021]


portfolio before change:  [13.33416729]
curr_Stock_Price:  101.435096534119
curr_Factors:  [1.01435097e+02 4.34756451e-02]
mat_Sqrt:  [[ 2.11500435e+01  0.00000000e+00]
 [-8.34032566e-03  1.91100868e-02]]
grads:  [ 0.00215775 -1.09273614]
Stock Position:  0.002157747544256698
Bond Position:  [13.11529596]


portfolio before change:  [13.33190963]
curr_Stock_Price:  99.62896599082423
curr_Factors:  [9.96289660e+01 4.38586573e-02]
mat_Sqrt:  [[ 2.08647550e+01  0.00000000e+00]
 [-8.37698345e-03  1.91940804e-02]]
grads:  [1.27764748e-03 9.31034464e+00]
Stock Position:  0.001277647479335035
Bond Position:  [13.20461893]


portfolio before change:  [13.33369193]
curr_Stock_Price:  99.73198533125515
curr_Factors:  [9.97319853e+01 4.49394428e-02]
mat_Sqrt:  [[ 2.11421089e+01  0.00000000e+00]
 [-8.47957007e-03  1.94291358e-02]]
grads:  [-0.00381339  0.55069824]
Stock Position:  -0.003813389157205863
Bond Position:  [13.7140088]


portfolio before change:  [13.34161293]
curr_Stock_Price:  98.10439452637556
curr_Factors:  [9.81043945e+01 4.51636257e-02]
mat_Sqrt:  [[ 2.08488863e+01  0.00000000e+00]
 [-8.50069416e-03  1.94775372e-02]]
grads:  [1.73206883e-03 2.40533784e+00]
Stock Position:  0.001732068832568483
Bond Position:  [13.17168936]


portfolio before change:  [13.34534024]
curr_Stock_Price:  99.30570159397429
curr_Factors:  [9.93057016e+01 4.25111729e-02]
mat_Sqrt:  [[ 2.04750857e+01  0.00000000e+00]
 [-8.24729511e-03  1.88969271e-02]]
grads:  [-1.11024812e-03 -5.01495560e+00]
Stock Position:  -0.001110248123286529
Bond Position:  [13.45559421]


portfolio before change:  [13.34824903]
curr_Stock_Price:  98.20078018903578
curr_Factors:  [9.82007802e+01 4.30815481e-02]
mat_Sqrt:  [[ 2.03826473e+01  0.00000000e+00]
 [-8.30243801e-03  1.90232753e-02]]
grads:  [ 0.00206689 -1.98588251]
Stock Position:  0.0020668861163239093
Bond Position:  [13.1452792]


portfolio before change:  [13.34689302]
curr_Stock_Price:  96.74967159946698
curr_Factors:  [9.67496716e+01 4.36024780e-02]
mat_Sqrt:  [[ 2.02024986e+01  0.00000000e+00]
 [-8.35248255e-03  1.91379418e-02]]
grads:  [6.75218196e-03 1.12688012e+01]
Stock Position:  0.00675218195943038
Bond Position:  [12.69362163]


portfolio before change:  [13.34708289]
curr_Stock_Price:  96.5427866770236
curr_Factors:  [9.65427867e+01 4.28860891e-02]
mat_Sqrt:  [[ 1.99930040e+01  0.00000000e+00]
 [-8.28358271e-03  1.89800724e-02]]
grads:  [4.90909994e-03 8.43730017e+00]
Stock Position:  0.004909099944106827
Bond Position:  [12.87314471]


portfolio before change:  [13.34186402]
curr_Stock_Price:  95.15187663858937
curr_Factors:  [9.51518766e+01 4.31104039e-02]
mat_Sqrt:  [[ 1.97564270e+01  0.00000000e+00]
 [-8.30521801e-03  1.90296451e-02]]
grads:  [-0.00160793  0.57656356]
Stock Position:  -0.0016079254484621787
Bond Position:  [13.49486115]


portfolio before change:  [13.34486984]
curr_Stock_Price:  94.33165435432514
curr_Factors:  [9.43316544e+01 4.41270311e-02]
mat_Sqrt:  [[ 1.98157176e+01  0.00000000e+00]
 [-8.40257399e-03  1.92527157e-02]]
grads:  [5.58498963e-03 7.83862791e+00]
Stock Position:  0.005584989627234875
Bond Position:  [12.81802853]


portfolio before change:  [13.35964437]
curr_Stock_Price:  96.6901501065394
curr_Factors:  [9.66901501e+01 4.15345069e-02]
mat_Sqrt:  [[ 1.97054685e+01  0.00000000e+00]
 [-8.15200656e-03  1.86785936e-02]]
grads:  [0.00748482 3.17915502]
Stock Position:  0.007484824202069076
Bond Position:  [12.63593559]


portfolio before change:  [13.3629284]
curr_Stock_Price:  96.91786950954366
curr_Factors:  [9.69178695e+01 4.18523303e-02]
mat_Sqrt:  [[ 1.98273047e+01  0.00000000e+00]
 [-8.18313684e-03  1.87499220e-02]]
grads:  [8.71876751e-03 9.67560572e+00]
Stock Position:  0.008718767507603531
Bond Position:  [12.51792403]


portfolio before change:  [13.37797327]
curr_Stock_Price:  98.4639638764619
curr_Factors:  [9.84639639e+01 4.11673814e-02]
mat_Sqrt:  [[ 1.99780887e+01  0.00000000e+00]
 [-8.11589861e-03  1.85958599e-02]]
grads:  [-6.83850207e-03  7.69811539e+00]
Stock Position:  -0.006838502066730705
Bond Position:  [14.05131929]


portfolio before change:  [13.38262449]
curr_Stock_Price:  98.04067098473202
curr_Factors:  [9.80406710e+01 4.01727815e-02]
mat_Sqrt:  [[ 1.96504376e+01  0.00000000e+00]
 [-8.01725953e-03  1.83698493e-02]]
grads:  [-0.00668123 -4.97080007]
Stock Position:  -0.006681231288147973
Bond Position:  [14.03765689]


portfolio before change:  [13.3743687]
curr_Stock_Price:  99.53898909411507
curr_Factors:  [9.95389891e+01 3.89615727e-02]
mat_Sqrt:  [[ 1.96476886e+01  0.00000000e+00]
 [-7.89547442e-03  1.80908046e-02]]
grads:  [ 3.97237914e-05 -2.86273819e+00]
Stock Position:  3.9723791430930624e-05
Bond Position:  [13.37041463]


portfolio before change:  [13.37600932]
curr_Stock_Price:  98.76421301120374
curr_Factors:  [9.8764213e+01 4.0387907e-02]
mat_Sqrt:  [[ 1.98483898e+01  0.00000000e+00]
 [-8.03869711e-03  1.84189690e-02]]
grads:  [-0.04146211 -5.22073314]
Stock Position:  -0.0414621076234169
Bond Position:  [17.47098175]


portfolio before change:  [13.37871675]
curr_Stock_Price:  98.75158904215952
curr_Factors:  [9.87515890e+01 3.98058886e-02]
mat_Sqrt:  [[ 1.97023375e+01  0.00000000e+00]
 [-7.98056525e-03  1.82857722e-02]]
grads:  [-0.0058111   0.45849667]
Stock Position:  -0.005811099929874067
Bond Position:  [13.9525721]


portfolio before change:  [13.37404129]
curr_Stock_Price:  99.85630897658254
curr_Factors:  [9.98563090e+01 3.77678742e-02]
mat_Sqrt:  [[ 1.94060336e+01  0.00000000e+00]
 [-7.77358339e-03  1.78115171e-02]]
grads:  [ 0.00215838 -1.95083915]
Stock Position:  0.0021583788313450356
Bond Position:  [13.15851355]


portfolio before change:  [13.37692831]
curr_Stock_Price:  100.43178558652414
curr_Factors:  [1.00431786e+02 3.65215806e-02]
mat_Sqrt:  [[ 1.91931371e+01  0.00000000e+00]
 [-7.64424809e-03  1.75151728e-02]]
grads:  [0.00829734 4.57724949]
Stock Position:  0.008297340527370864
Bond Position:  [12.54361158]


portfolio before change:  [13.3742591]
curr_Stock_Price:  99.92110900330661
curr_Factors:  [9.99211090e+01 3.81797945e-02]
mat_Sqrt:  [[ 1.95242356e+01  0.00000000e+00]
 [-7.81586023e-03  1.79083856e-02]]
grads:  [-0.01338577 -3.03489743]
Stock Position:  -0.013385773406519507
Bond Position:  [14.71178042]


portfolio before change:  [13.38299429]
curr_Stock_Price:  99.40592708764507
curr_Factors:  [9.94059271e+01 3.71308973e-02]
mat_Sqrt:  [[ 1.91549050e+01  0.00000000e+00]
 [-7.70775166e-03  1.76606777e-02]]
grads:  [ -0.03102146 -19.57517495]
Stock Position:  -0.031021461809587463
Bond Position:  [16.46671147]


portfolio before change:  [13.38055493]
curr_Stock_Price:  99.5509179068767
curr_Factors:  [9.95509179e+01 3.63613532e-02]
mat_Sqrt:  [[ 1.89830192e+01  0.00000000e+00]
 [-7.62746125e-03  1.74767093e-02]]
grads:  [4.22285885e-03 1.73678527e+01]
Stock Position:  0.004222858852501491
Bond Position:  [12.96016546]


portfolio before change:  [13.37369963]
curr_Stock_Price:  97.54388270897857
curr_Factors:  [9.75438827e+01 3.84220260e-02]
mat_Sqrt:  [[ 1.91201004e+01  0.00000000e+00]
 [-7.84061487e-03  1.79651056e-02]]
grads:  [-4.61217323e-03  6.08745459e+00]
Stock Position:  -0.0046121732283718455
Bond Position:  [13.82358891]


portfolio before change:  [13.36358193]
curr_Stock_Price:  100.11224988794942
curr_Factors:  [1.00112250e+02 3.85071252e-02]
mat_Sqrt:  [[ 1.96452595e+01  0.00000000e+00]
 [-7.84929298e-03  1.79849896e-02]]
grads:  [0.01962384 3.31790915]
Stock Position:  0.01962384231219687
Bond Position:  [11.39899493]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.31902299]
Stock Price:  97.76898289231568
PL:  [13.31902299]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.57633719e-01  4.55241564e-01]
 [-1.64631607e-01 -8.76834000e-02]
 [ 8.29435576e-01 -7.20550284e-01]
 [-2.31314662e-02  2.57921159e-02]
 [-1.13771420e-03  3.81525951e-03]
 [-8.90405940e-02 -6.81003817e-02]
 [-4.05128754e-02  2.06988422e-01]
 [ 2.38256946e-02 -5.65761341e-02]
 [ 1.65616650e-01  8.51418692e-02]
 [ 1.49290224e-01  2.08444135e-02]
 [ 9.71201935e-02  1.16864285e-01]
 [-1.06070597e-01 -2.01847424e-02]
 [ 9.73620674e-02  6.28534933e-02]
 [-1.43174896e-01 -1.59257406e-01]
 [ 8.93874517e-02  2.32812491e-01]
 [ 4.92633529e-02  1.23673043e-02]
 [ 2.07066895e-02 -5.10514384e-02]
 [-7.56630282e-03  4.86905927e-02]
 [ 1.59006792e-02  4.09897873e-02]
 [ 1.01521419e-01 -1.00134653e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 3.73645610e-02  1.94617732e-01]
 [ 2.63421081e-02  1.48324098e-01]
 [-8.44833060e-02  1.06531444e-01]
 [ 4.32967815e-02  9.83514086e-02]
 [ 7.31250125e-02  7.77020252e-02]
 [-3.21119955e-03  2.22231098e-01]
 [-2.05314586e-01  1.46155688e-01]
 [-3.33342440e-02 -1.20653620e-01]
 [ 6.65993955e-02 -6.18880360e-02]
 [-8.17658008e-01 -9.94857148e-02]
 [-1.18132039e-01  7.63566161e-03]
 [ 9.28915451e-02  4.19109370e-02]
 [ 1.58384287e-01  6.26652632e-02]
 [-2.77553146e-01 -1.31019449e-01]
 [-1.06414645e-01 -4.15591958e-01]
 [-8.58396381e-02  2.82489634e-01]
 [-1.23464378e-01  1.17760941e-01]
 [-2.49443473e-02  1.08336589e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.45277011]
curr_Stock_Price:  100.41343764106185
curr_Factors:  [1.00413438e+02 3.88958154e-02]
mat_Sqrt:  [[ 1.98035603e+01  0.00000000e+00]
 [-7.88880883e-03  1.80755318e-02]]
grads:  [1.79925943e-02 2.51855143e+01]
Stock Position:  0.017992594278962395
Bond Position:  [3.64607187]


portfolio before change:  [5.44447532]
curr_Stock_Price:  99.92709403461566
curr_Factors:  [9.99270940e+01 3.91281552e-02]
mat_Sqrt:  [[ 1.97664166e+01  0.00000000e+00]
 [-7.91233520e-03  1.81294375e-02]]
grads:  [-0.01026487 -4.83652072]
Stock Position:  -0.010264874238709223
Bond Position:  [6.47021437]


portfolio before change:  [5.45238061]
curr_Stock_Price:  99.23575938673734
curr_Factors:  [9.92357594e+01 3.87236216e-02]
mat_Sqrt:  [[ 1.95279287e+01  0.00000000e+00]
 [-7.87132736e-03  1.80354767e-02]]
grads:  [ 2.63705208e-02 -3.99518291e+01]
Stock Position:  0.02637052083880113
Bond Position:  [2.83548195]


portfolio before change:  [5.47387392]
curr_Stock_Price:  100.03736876591555
curr_Factors:  [1.00037369e+02 3.90844033e-02]
mat_Sqrt:  [[ 1.97771635e+01  0.00000000e+00]
 [-7.90791030e-03  1.81192988e-02]]
grads:  [-6.00433119e-04  1.42346104e+00]
Stock Position:  -0.0006004331193058941
Bond Position:  [5.53393967]


portfolio before change:  [5.47468437]
curr_Stock_Price:  99.83974222421332
curr_Factors:  [9.98397422e+01 4.05183366e-02]
mat_Sqrt:  [[ 2.00969085e+01  0.00000000e+00]
 [-8.05166682e-03  1.84486863e-02]]
grads:  [2.62429200e-05 2.06803858e-01]
Stock Position:  2.6242920046422163e-05
Bond Position:  [5.47206428]


portfolio before change:  [5.475343]
curr_Stock_Price:  98.87110360887819
curr_Factors:  [9.88711036e+01 4.07693336e-02]
mat_Sqrt:  [[ 1.99634772e+01  0.00000000e+00]
 [-8.07656695e-03  1.85057397e-02]]
grads:  [-0.00594897 -3.67995999]
Stock Position:  -0.0059489655069917356
Bond Position:  [6.06352378]


portfolio before change:  [5.47487013]
curr_Stock_Price:  99.07800615143167
curr_Factors:  [9.90780062e+01 4.07409201e-02]
mat_Sqrt:  [[ 1.99982814e+01  0.00000000e+00]
 [-8.07375205e-03  1.84992900e-02]]
grads:  [2.49142800e-03 1.11889928e+01]
Stock Position:  0.002491428002542691
Bond Position:  [5.22802441]


portfolio before change:  [5.476601]
curr_Stock_Price:  99.51042068733148
curr_Factors:  [9.95104207e+01 4.04627931e-02]
mat_Sqrt:  [[ 2.00168849e+01  0.00000000e+00]
 [-8.04614621e-03  1.84360370e-02]]
grads:  [-4.32711988e-05 -3.06877959e+00]
Stock Position:  -4.327119879619294e-05
Bond Position:  [5.48090694]


portfolio before change:  [5.47732275]
curr_Stock_Price:  98.66473041827729
curr_Factors:  [9.86647304e+01 4.06978741e-02]
mat_Sqrt:  [[ 1.99043406e+01  0.00000000e+00]
 [-8.06948564e-03  1.84895144e-02]]
grads:  [0.01018751 4.60487319]
Stock Position:  0.01018750692055906
Bond Position:  [4.47217513]


portfolio before change:  [5.47460699]
curr_Stock_Price:  98.34327530299791
curr_Factors:  [9.83432753e+01 3.97787711e-02]
mat_Sqrt:  [[ 1.96141887e+01  0.00000000e+00]
 [-7.97784644e-03  1.82795426e-02]]
grads:  [0.00807515 1.14031374]
Stock Position:  0.008075147768111468
Bond Position:  [4.68047051]


portfolio before change:  [5.48593467]
curr_Stock_Price:  99.67360200060669
curr_Factors:  [9.96736020e+01 3.91248511e-02]
mat_Sqrt:  [[ 1.97154413e+01  0.00000000e+00]
 [-7.91200112e-03  1.81286720e-02]]
grads:  [0.00751309 6.4463787 ]
Stock Position:  0.007513093268468242
Bond Position:  [4.7370776]


portfolio before change:  [5.4907178]
curr_Stock_Price:  100.23142367630408
curr_Factors:  [1.00231424e+02 4.02531507e-02]
mat_Sqrt:  [[ 2.01096188e+01  0.00000000e+00]
 [-8.02527514e-03  1.83882154e-02]]
grads:  [-0.00571269 -1.09769991]
Stock Position:  -0.005712686163798158
Bond Position:  [6.06330847]


portfolio before change:  [5.49841876]
curr_Stock_Price:  99.01605918493968
curr_Factors:  [9.90160592e+01 4.19334270e-02]
mat_Sqrt:  [[ 2.02761649e+01  0.00000000e+00]
 [-8.19106117e-03  1.87680789e-02]]
grads:  [0.00615469 3.34895722]
Stock Position:  0.006154693510561889
Bond Position:  [4.88900526]


portfolio before change:  [5.48546129]
curr_Stock_Price:  96.8114590870819
curr_Factors:  [9.68114591e+01 4.45442086e-02]
mat_Sqrt:  [[ 2.04325415e+01  0.00000000e+00]
 [-8.44219958e-03  1.93435093e-02]]
grads:  [-0.01040891 -8.2331186 ]
Stock Position:  -0.01040891199703119
Bond Position:  [6.49316324]


portfolio before change:  [5.48080576]
curr_Stock_Price:  97.33670354378891
curr_Factors:  [9.73367035e+01 4.36821809e-02]
mat_Sqrt:  [[ 2.03436460e+01  0.00000000e+00]
 [-8.36011300e-03  1.91554253e-02]]
grads:  [9.38844259e-03 1.21538669e+01]
Stock Position:  0.009388442590304106
Bond Position:  [4.56696571]


portfolio before change:  [5.48281935]
curr_Stock_Price:  97.49036993727096
curr_Factors:  [9.74903699e+01 4.33319699e-02]
mat_Sqrt:  [[ 2.02939196e+01  0.00000000e+00]
 [-8.32653300e-03  1.90784839e-02]]
grads:  [0.00269346 0.64823308]
Stock Position:  0.0026934613048417502
Bond Position:  [5.22023281]


portfolio before change:  [5.48302967]
curr_Stock_Price:  97.32617487486894
curr_Factors:  [9.73261749e+01 4.53292250e-02]
mat_Sqrt:  [[ 2.07213861e+01  0.00000000e+00]
 [-8.51626444e-03  1.95132132e-02]]
grads:  [-7.59594383e-05 -2.61624971e+00]
Stock Position:  -7.595943834133764e-05
Bond Position:  [5.49042251]


portfolio before change:  [5.48363041]
curr_Stock_Price:  98.45318906501407
curr_Factors:  [9.84531891e+01 4.64850066e-02]
mat_Sqrt:  [[ 2.12268835e+01  0.00000000e+00]
 [-8.62415275e-03  1.97604164e-02]]
grads:  [6.44654878e-04 2.46404690e+00]
Stock Position:  0.0006446548776483086
Bond Position:  [5.42016208]


portfolio before change:  [5.48363122]
curr_Stock_Price:  97.40339499918683
curr_Factors:  [9.74033950e+01 4.69910482e-02]
mat_Sqrt:  [[ 2.11145418e+01  0.00000000e+00]
 [-8.67096748e-03  1.98676824e-02]]
grads:  [1.60032310e-03 2.06313884e+00]
Stock Position:  0.0016003231033330564
Bond Position:  [5.32775431]


portfolio before change:  [5.48535865]
curr_Stock_Price:  98.06664779982593
curr_Factors:  [9.80666478e+01 4.76666375e-02]
mat_Sqrt:  [[ 2.14105877e+01  0.00000000e+00]
 [-8.73307620e-03  2.00099914e-02]]
grads:  [ 2.70048981e-03 -5.00423268e+00]
Stock Position:  0.0027004898101398145
Bond Position:  [5.22053066]


portfolio before change:  [5.484938]
curr_Stock_Price:  97.66921815643539
curr_Factors:  [9.76692182e+01 4.78788034e-02]
mat_Sqrt:  [[ 2.13712220e+01  0.00000000e+00]
 [-8.75249025e-03  2.00544745e-02]]
grads:  [ 0.00197128 -1.88376861]
Stock Position:  0.0019712775739445854
Bond Position:  [5.29240486]


portfolio before change:  [5.48262692]
curr_Stock_Price:  96.16122574175775
curr_Factors:  [9.61612257e+01 4.81397280e-02]
mat_Sqrt:  [[ 2.10985110e+01  0.00000000e+00]
 [-8.77630702e-03  2.01090456e-02]]
grads:  [5.79674569e-03 9.67811879e+00]
Stock Position:  0.005796745694898767
Bond Position:  [4.92520475]


portfolio before change:  [5.4845053]
curr_Stock_Price:  96.37905268532619
curr_Factors:  [9.63790527e+01 4.83941705e-02]
mat_Sqrt:  [[ 2.12021146e+01  0.00000000e+00]
 [-8.79947003e-03  2.01621188e-02]]
grads:  [4.29561169e-03 7.35657297e+00]
Stock Position:  0.004295611685975817
Bond Position:  [5.07049831]


portfolio before change:  [5.48956937]
curr_Stock_Price:  97.41038933742668
curr_Factors:  [9.74103893e+01 4.75946327e-02]
mat_Sqrt:  [[ 2.12512397e+01  0.00000000e+00]
 [-8.72647766e-03  1.99948722e-02]]
grads:  [-1.78762146e-03  5.32793822e+00]
Stock Position:  -0.001787621463402347
Bond Position:  [5.66370227]


portfolio before change:  [5.49009979]
curr_Stock_Price:  97.50973205331977
curr_Factors:  [9.75097321e+01 4.96035510e-02]
mat_Sqrt:  [[ 2.17172258e+01  0.00000000e+00]
 [-8.90874186e-03  2.04124920e-02]]
grads:  [3.97015972e-03 4.81819705e+00]
Stock Position:  0.003970159724876645
Bond Position:  [5.10297058]


portfolio before change:  [5.48612578]
curr_Stock_Price:  96.3480873308842
curr_Factors:  [9.63480873e+01 4.98890281e-02]
mat_Sqrt:  [[ 2.15201661e+01  0.00000000e+00]
 [-8.93434077e-03  2.04711464e-02]]
grads:  [0.0049738  3.79568509]
Stock Position:  0.004973797877615155
Bond Position:  [5.00690987]


portfolio before change:  [5.49437726]
curr_Stock_Price:  97.88123668852947
curr_Factors:  [9.78812367e+01 4.94749251e-02]
mat_Sqrt:  [[ 2.17716839e+01  0.00000000e+00]
 [-8.89718383e-03  2.03860092e-02]]
grads:  [4.30735644e-03 1.09011575e+01]
Stock Position:  0.004307356444862913
Bond Position:  [5.07276789]


portfolio before change:  [5.5014716]
curr_Stock_Price:  99.38104403704072
curr_Factors:  [9.93810440e+01 4.72673733e-02]
mat_Sqrt:  [[ 2.16064934e+01  0.00000000e+00]
 [-8.69642439e-03  1.99260115e-02]]
grads:  [-6.55020746e-03  7.33491938e+00]
Stock Position:  -0.006550207461486832
Bond Position:  [6.15243806]


portfolio before change:  [5.505102]
curr_Stock_Price:  98.94421866165806
curr_Factors:  [9.89442187e+01 4.56396012e-02]
mat_Sqrt:  [[ 2.11378759e+01  0.00000000e+00]
 [-8.54537079e-03  1.95799042e-02]]
grads:  [-4.06813821e-03 -6.16211489e+00]
Stock Position:  -0.004068138210069055
Bond Position:  [5.90762076]


portfolio before change:  [5.50820143]
curr_Stock_Price:  98.36387293373984
curr_Factors:  [9.83638729e+01 4.53777840e-02]
mat_Sqrt:  [[ 2.09535331e+01  0.00000000e+00]
 [-8.52082475e-03  1.95236622e-02]]
grads:  [ 1.88938267e-03 -3.16989893e+00]
Stock Position:  0.001889382670869754
Bond Position:  [5.32235443]


portfolio before change:  [5.50889421]
curr_Stock_Price:  98.37839942950586
curr_Factors:  [9.83783994e+01 4.62129610e-02]
mat_Sqrt:  [[ 2.11486013e+01  0.00000000e+00]
 [-8.59888002e-03  1.97025093e-02]]
grads:  [-0.04071556 -5.04939312]
Stock Position:  -0.040715559393415555
Bond Position:  [9.51442578]


portfolio before change:  [5.4831978]
curr_Stock_Price:  99.03873143438439
curr_Factors:  [9.90387314e+01 4.65152400e-02]
mat_Sqrt:  [[ 2.13600715e+01  0.00000000e+00]
 [-8.62695682e-03  1.97668413e-02]]
grads:  [-0.00537449  0.38628638]
Stock Position:  -0.0053744933685767925
Bond Position:  [6.01548081]


portfolio before change:  [5.47477892]
curr_Stock_Price:  100.74509896993918
curr_Factors:  [1.00745099e+02 4.64884449e-02]
mat_Sqrt:  [[ 2.17218313e+01  0.00000000e+00]
 [-8.62447168e-03  1.97611472e-02]]
grads:  [0.00511849 2.12087571]
Stock Position:  0.005118490050550284
Bond Position:  [4.95911614]


portfolio before change:  [5.47789238]
curr_Stock_Price:  101.23225998308223
curr_Factors:  [1.01232260e+02 4.75300268e-02]
mat_Sqrt:  [[ 2.20700320e+01  0.00000000e+00]
 [-8.72055290e-03  1.99812969e-02]]
grads:  [0.00841565 3.13619599]
Stock Position:  0.008415649325823907
Bond Position:  [4.62595718]


portfolio before change:  [5.47347911]
curr_Stock_Price:  100.63913333825461
curr_Factors:  [1.00639133e+02 4.67004234e-02]
mat_Sqrt:  [[ 2.17483993e+01  0.00000000e+00]
 [-8.64411230e-03  1.98061495e-02]]
grads:  [-0.01539123 -6.61508939]
Stock Position:  -0.015391234903747114
Bond Position:  [7.02243966]


portfolio before change:  [5.45809621]
curr_Stock_Price:  101.69562855778064
curr_Factors:  [1.01695629e+02 4.52846789e-02]
mat_Sqrt:  [[ 2.16410302e+01  0.00000000e+00]
 [-8.51207885e-03  1.95036228e-02]]
grads:  [-1.32985280e-02 -2.13084493e+01]
Stock Position:  -0.013298527966383476
Bond Position:  [6.81049837]


portfolio before change:  [5.46960483]
curr_Stock_Price:  100.89424211071774
curr_Factors:  [1.00894242e+02 4.51929189e-02]
mat_Sqrt:  [[ 2.14487298e+01  0.00000000e+00]
 [-8.50345049e-03  1.94838528e-02]]
grads:  [1.74597499e-03 1.44986537e+01]
Stock Position:  0.0017459749915918765
Bond Position:  [5.29344601]


portfolio before change:  [5.47042656]
curr_Stock_Price:  100.98588700720596
curr_Factors:  [1.00985887e+02 4.58545056e-02]
mat_Sqrt:  [[ 2.16247797e+01  0.00000000e+00]
 [-8.56546607e-03  1.96259483e-02]]
grads:  [-3.33271788e-03  6.00026755e+00]
Stock Position:  -0.0033327178825439336
Bond Position:  [5.80698404]


portfolio before change:  [5.46560759]
curr_Stock_Price:  102.64966299779465
curr_Factors:  [1.02649663e+02 4.52699432e-02]
mat_Sqrt:  [[ 2.18404963e+01  0.00000000e+00]
 [-8.51069381e-03  1.95004493e-02]]
grads:  [1.02276141e-03 5.55559453e+00]
Stock Position:  0.001022761407083345
Bond Position:  [5.36062147]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.46641424]
Stock Price:  102.78315479193913
PL:  [2.68325945]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.23701604e-01  7.99927387e-01]
 [-2.15977565e-01 -7.28074739e-02]
 [ 8.53870708e-01 -7.21851633e-01]
 [ 3.84716742e-02  2.20714480e-02]
 [-1.18232970e-01  5.06779354e-02]
 [ 1.95673545e-01  1.84991728e-01]
 [ 1.31150220e-02  3.04240957e-01]
 [ 2.64796329e-01 -2.09386979e-03]
 [ 1.33064352e-01  8.06160857e-02]
 [ 1.03478347e-01  8.70720098e-02]
 [ 1.44962043e-01  2.87293943e-01]
 [ 1.83998328e-01  2.34839771e-01]
 [ 1.35349498e-01  4.75923967e-02]
 [-3.85657456e-01 -5.08481632e-01]
 [ 7.82999197e-02  2.23971728e-01]
 [ 5.37281261e-02 -2.02310465e-02]
 [-5.22872400e-02  2.32243165e-01]
 [-5.48701173e-02  1.16974645e-01]
 [ 1.49596680e-02  6.43552382e-02]
 [-3.38718866e-02 -7.98079393e-02]
 [ 1.85465402e-01  9.30639080e-02]
 [ 3.91453129e-02  1.81739157e-01]
 [ 1.08012709e-02  2.31440832e-01]
 [ 3.86476845e-02  1.70157413e-01]
 [ 2.66561653e-02  6.07141669e-02]
 [ 6.31982210e-01 -1.96611033e-01]
 [ 1.33339769e-02  6.57302030e-02]
 [-6.12130630e-02  8.17738968e-02]
 [ 3.54349081e-02 -1.58468583e-01]
 [ 1.50771275e-02 -4.98464321e-02]
 [-5.97529502e-01 -9.44105496e-02]
 [-1.18004300e-01  2.67684161e-03]
 [ 1.34972968e-01  1.12035987e-01]
 [ 1.97422536e-01  4.26369180e-02]
 [-2.81137968e-01 -1.75155983e-01]
 [-9.85880635e-02 -4.15447040e-01]
 [-3.92669229e-02  3.06309868e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 6.65947560e-01  2.56833627e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.28989054]
curr_Stock_Price:  101.44321863891454
curr_Factors:  [1.01443219e+02 4.08876371e-02]
mat_Sqrt:  [[ 2.05125205e+01  0.00000000e+00]
 [-8.08827667e-03  1.85325700e-02]]
grads:  [3.76754548e-02 4.31633274e+01]
Stock Position:  0.03767545481958007
Bond Position:  [8.46797114]


portfolio before change:  [12.30161006]
curr_Stock_Price:  101.72618692917013
curr_Factors:  [1.01726187e+02 4.07851224e-02]
mat_Sqrt:  [[ 2.05439359e+01  0.00000000e+00]
 [-8.07813071e-03  1.85093227e-02]]
grads:  [-0.01205968 -3.93355689]
Stock Position:  -0.012059682864616263
Bond Position:  [13.52839561]


portfolio before change:  [12.2954839]
curr_Stock_Price:  102.37440555681067
curr_Factors:  [1.02374406e+02 4.16019740e-02]
mat_Sqrt:  [[ 2.08808591e+01  0.00000000e+00]
 [-8.15862478e-03  1.86937578e-02]]
grads:  [ 2.58049166e-02 -3.86145814e+01]
Stock Position:  0.025804916600399484
Bond Position:  [9.65372091]


portfolio before change:  [12.26931338]
curr_Stock_Price:  101.31347163544369
curr_Factors:  [1.01313472e+02 4.17827913e-02]
mat_Sqrt:  [[ 2.07093240e+01  0.00000000e+00]
 [-8.17633574e-03  1.87343387e-02]]
grads:  [0.00232284 1.17812794]
Stock Position:  0.002322839891212595
Bond Position:  [12.03397841]


portfolio before change:  [12.27120352]
curr_Stock_Price:  101.47956138640136
curr_Factors:  [1.01479561e+02 4.23067759e-02]
mat_Sqrt:  [[ 2.08729363e+01  0.00000000e+00]
 [-8.22744441e-03  1.88514434e-02]]
grads:  [-0.00460478  2.68827879]
Stock Position:  -0.004604781247132728
Bond Position:  [12.73849471]


portfolio before change:  [12.2631157]
curr_Stock_Price:  103.58177465366123
curr_Factors:  [1.03581775e+02 4.27890854e-02]
mat_Sqrt:  [[ 2.14264316e+01  0.00000000e+00]
 [-8.27420912e-03  1.89585948e-02]]
grads:  [0.01290045 9.75767083]
Stock Position:  0.012900447418020036
Bond Position:  [10.92686447]


portfolio before change:  [12.23779747]
curr_Stock_Price:  101.51330559090482
curr_Factors:  [1.01513306e+02 4.51097400e-02]
mat_Sqrt:  [[ 2.15604654e+01  0.00000000e+00]
 [-8.49562146e-03  1.94659142e-02]]
grads:  [6.76686048e-03 1.56294204e+01]
Stock Position:  0.006766860480901353
Bond Position:  [11.55087109]


portfolio before change:  [12.24126349]
curr_Stock_Price:  101.8121248978727
curr_Factors:  [1.01812125e+02 4.56537768e-02]
mat_Sqrt:  [[ 2.17539365e+01  0.00000000e+00]
 [-8.54669777e-03  1.95829447e-02]]
grads:  [ 0.01213033 -0.10692313]
Stock Position:  0.012130332787250139
Bond Position:  [11.00624853]


portfolio before change:  [12.23279268]
curr_Stock_Price:  101.00038522720196
curr_Factors:  [1.01000385e+02 4.62077444e-02]
mat_Sqrt:  [[ 2.17110294e+01  0.00000000e+00]
 [-8.59839468e-03  1.97013972e-02]]
grads:  [0.00774943 4.09189687]
Stock Position:  0.007749429705406946
Bond Position:  [11.4500973]


portfolio before change:  [12.20726249]
curr_Stock_Price:  97.52122009682593
curr_Factors:  [9.75212201e+01 4.79908373e-02]
mat_Sqrt:  [[ 2.13637895e+01  0.00000000e+00]
 [-8.76272444e-03  2.00779240e-02]]
grads:  [0.00662241 4.33670382]
Stock Position:  0.006622405998582979
Bond Position:  [11.56143738]


portfolio before change:  [12.20777534]
curr_Stock_Price:  97.38042290725768
curr_Factors:  [9.73804229e+01 4.72395819e-02]
mat_Sqrt:  [[ 2.11653122e+01  0.00000000e+00]
 [-8.69386744e-03  1.99201528e-02]]
grads:  [1.27731355e-02 1.44222761e+01]
Stock Position:  0.012773135451855497
Bond Position:  [10.96392201]


portfolio before change:  [12.20908662]
curr_Stock_Price:  97.37578030403893
curr_Factors:  [9.73757803e+01 4.49782845e-02]
mat_Sqrt:  [[ 2.06515377e+01  0.00000000e+00]
 [-8.48323377e-03  1.94375305e-02]]
grads:  [ 0.01387261 12.08176991]
Stock Position:  0.013872613803779476
Bond Position:  [10.85823002]


portfolio before change:  [12.22787627]
curr_Stock_Price:  98.6323778026594
curr_Factors:  [9.86323778e+01 4.58617901e-02]
mat_Sqrt:  [[ 2.11224847e+01  0.00000000e+00]
 [-8.56614640e-03  1.96275071e-02]]
grads:  [0.0073912 2.4247805]
Stock Position:  0.007391200659762538
Bond Position:  [11.49886458]


portfolio before change:  [12.24132432]
curr_Stock_Price:  100.25736384760964
curr_Factors:  [1.00257364e+02 4.72817508e-02]
mat_Sqrt:  [[ 2.18003294e+01  0.00000000e+00]
 [-8.69774691e-03  1.99290418e-02]]
grads:  [ -0.02787009 -25.51460514]
Stock Position:  -0.027870085022263742
Bond Position:  [15.03550557]


portfolio before change:  [12.2422238]
curr_Stock_Price:  100.2925297779818
curr_Factors:  [1.00292530e+02 4.59424028e-02]
mat_Sqrt:  [[ 2.14968803e+01  0.00000000e+00]
 [-8.57367159e-03  1.96447495e-02]]
grads:  [8.18952299e-03 1.14010987e+01]
Stock Position:  0.008189522989383
Bond Position:  [11.42087582]


portfolio before change:  [12.24445107]
curr_Stock_Price:  100.39016301662029
curr_Factors:  [1.00390163e+02 4.67195340e-02]
mat_Sqrt:  [[ 2.16990345e+01  0.00000000e+00]
 [-8.64588077e-03  1.98102015e-02]]
grads:  [ 0.00206915 -1.02124385]
Stock Position:  0.0020691507509484897
Bond Position:  [12.03672868]


portfolio before change:  [12.24659612]
curr_Stock_Price:  100.69964578880791
curr_Factors:  [1.00699646e+02 4.61097028e-02]
mat_Sqrt:  [[ 2.16234061e+01  0.00000000e+00]
 [-8.58926798e-03  1.96804853e-02]]
grads:  [2.26939210e-03 1.18006828e+01]
Stock Position:  0.002269392099533501
Bond Position:  [12.01806914]


portfolio before change:  [12.25274947]
curr_Stock_Price:  102.7490947830034
curr_Factors:  [1.02749095e+02 4.50076971e-02]
mat_Sqrt:  [[ 2.17982385e+01  0.00000000e+00]
 [-8.48600703e-03  1.94438848e-02]]
grads:  [-1.75160791e-04  6.01601205e+00]
Stock Position:  -0.00017516079079728635
Bond Position:  [12.27074709]


portfolio before change:  [12.25453784]
curr_Stock_Price:  101.29658098353931
curr_Factors:  [1.01296581e+02 4.61369367e-02]
mat_Sqrt:  [[ 2.17580097e+01  0.00000000e+00]
 [-8.59180416e-03  1.96862965e-02]]
grads:  [1.97842529e-03 3.26903734e+00]
Stock Position:  0.001978425290551431
Bond Position:  [12.05413012]


portfolio before change:  [12.25443847]
curr_Stock_Price:  100.48470972968498
curr_Factors:  [1.00484710e+02 4.64844154e-02]
mat_Sqrt:  [[ 2.16647494e+01  0.00000000e+00]
 [-8.62409790e-03  1.97602907e-02]]
grads:  [-3.17118494e-03 -4.03880391e+00]
Stock Position:  -0.003171184937887831
Bond Position:  [12.57309407]


portfolio before change:  [12.25274129]
curr_Stock_Price:  101.51552849108536
curr_Factors:  [1.01515528e+02 4.48589284e-02]
mat_Sqrt:  [[ 2.15009143e+01  0.00000000e+00]
 [-8.47197057e-03  1.94117232e-02]]
grads:  [0.01051499 4.79421157]
Stock Position:  0.010514986415587234
Bond Position:  [11.18530689]


portfolio before change:  [12.25180139]
curr_Stock_Price:  101.29316547764988
curr_Factors:  [1.01293165e+02 4.61971548e-02]
mat_Sqrt:  [[ 2.17714702e+01  0.00000000e+00]
 [-8.59740936e-03  1.96991396e-02]]
grads:  [5.44119356e-03 9.22574085e+00]
Stock Position:  0.005441193561103356
Bond Position:  [11.70064568]


portfolio before change:  [12.26089425]
curr_Stock_Price:  102.69546588065133
curr_Factors:  [1.02695466e+02 4.68097737e-02]
mat_Sqrt:  [[ 2.22187458e+01  0.00000000e+00]
 [-8.65422660e-03  1.98293242e-02]]
grads:  [5.03225213e-03 1.16716449e+01]
Stock Position:  0.0050322521312026434
Bond Position:  [11.74410478]


portfolio before change:  [12.26041465]
curr_Stock_Price:  102.308419928794
curr_Factors:  [1.0230842e+02 4.7325855e-02]
mat_Sqrt:  [[ 2.22566918e+01  0.00000000e+00]
 [-8.70180257e-03  1.99383345e-02]]
grads:  [5.07310202e-03 8.53418392e+00]
Stock Position:  0.005073102020108047
Bond Position:  [11.7413936]


portfolio before change:  [12.25404928]
curr_Stock_Price:  100.76436862434032
curr_Factors:  [1.00764369e+02 4.70921230e-02]
mat_Sqrt:  [[ 2.18665931e+01  0.00000000e+00]
 [-8.68028783e-03  1.98890380e-02]]
grads:  [2.43083136e-03 3.05264472e+00]
Stock Position:  0.0024308313566361868
Bond Position:  [12.0091081]


portfolio before change:  [12.25473384]
curr_Stock_Price:  100.42840428101579
curr_Factors:  [1.00428404e+02 4.70429131e-02]
mat_Sqrt:  [[ 2.17822965e+01  0.00000000e+00]
 [-8.67575132e-03  1.98786436e-02]]
grads:  [ 0.02507422 -9.89056586]
Stock Position:  0.02507422114819693
Bond Position:  [9.73656982]


portfolio before change:  [12.24177659]
curr_Stock_Price:  99.86310641114424
curr_Factors:  [9.98631064e+01 4.75135188e-02]
mat_Sqrt:  [[ 2.17677564e+01  0.00000000e+00]
 [-8.71903837e-03  1.99778267e-02]]
grads:  [1.93042354e-03 3.29015784e+00]
Stock Position:  0.0019304235373128655
Bond Position:  [12.0489985]


portfolio before change:  [12.24510275]
curr_Stock_Price:  100.80587365214791
curr_Factors:  [1.00805874e+02 4.65426039e-02]
mat_Sqrt:  [[ 2.17475920e+01  0.00000000e+00]
 [-8.62949398e-03  1.97726547e-02]]
grads:  [-1.17364757e-03  4.13570651e+00]
Stock Position:  -0.001173647573501857
Bond Position:  [12.36341331]


portfolio before change:  [12.24737293]
curr_Stock_Price:  100.18843291311244
curr_Factors:  [1.00188433e+02 4.70533328e-02]
mat_Sqrt:  [[ 2.17326547e+01  0.00000000e+00]
 [-8.67671208e-03  1.98808449e-02]]
grads:  [-1.55187906e-03 -7.97091792e+00]
Stock Position:  -0.0015518790649743865
Bond Position:  [12.40285326]


portfolio before change:  [12.2496121]
curr_Stock_Price:  99.74463406620694
curr_Factors:  [9.97446341e+01 4.75280167e-02]
mat_Sqrt:  [[ 2.17452491e+01  0.00000000e+00]
 [-8.72036850e-03  1.99808744e-02]]
grads:  [-3.07084962e-04 -2.49470725e+00]
Stock Position:  -0.00030708496178133123
Bond Position:  [12.28024218]


portfolio before change:  [12.25087749]
curr_Stock_Price:  100.62302460034634
curr_Factors:  [1.00623025e+02 4.70627055e-02]
mat_Sqrt:  [[ 2.18290991e+01  0.00000000e+00]
 [-8.67757620e-03  1.98828249e-02]]
grads:  [-0.02926065 -4.74834688]
Stock Position:  -0.029260650714228828
Bond Position:  [15.19517266]


portfolio before change:  [12.23993944]
curr_Stock_Price:  101.06175583911504
curr_Factors:  [1.01061756e+02 4.69418129e-02]
mat_Sqrt:  [[ 2.18961000e+01  0.00000000e+00]
 [-8.66642375e-03  1.98572714e-02]]
grads:  [-0.00533593  0.1348041 ]
Stock Position:  -0.0053359287954492145
Bond Position:  [12.77919777]


portfolio before change:  [12.23465696]
curr_Stock_Price:  102.35112392885144
curr_Factors:  [1.02351124e+02 4.72221763e-02]
mat_Sqrt:  [[ 2.22415790e+01  0.00000000e+00]
 [-8.69226565e-03  1.99164826e-02]]
grads:  [0.00826693 5.6252898 ]
Stock Position:  0.008266925723068272
Bond Position:  [11.38852783]


portfolio before change:  [12.24020055]
curr_Stock_Price:  102.84948757236513
curr_Factors:  [1.02849488e+02 4.76517125e-02]
mat_Sqrt:  [[ 2.24512946e+01  0.00000000e+00]
 [-8.73170889e-03  2.00068585e-02]]
grads:  [0.0096222  2.13111509]
Stock Position:  0.00962219848618915
Bond Position:  [11.25056237]


portfolio before change:  [12.23318621]
curr_Stock_Price:  101.9743489505709
curr_Factors:  [1.01974349e+02 4.73250627e-02]
mat_Sqrt:  [[ 2.21838306e+01  0.00000000e+00]
 [-8.70172973e-03  1.99381676e-02]]
grads:  [-0.01611905 -8.78495893]
Stock Position:  -0.016119051417825454
Bond Position:  [13.87691598]


portfolio before change:  [12.23844328]
curr_Stock_Price:  101.75582781794145
curr_Factors:  [1.01755828e+02 4.80017131e-02]
mat_Sqrt:  [[ 2.22939827e+01  0.00000000e+00]
 [-8.76371730e-03  2.00801989e-02]]
grads:  [-1.25551374e-02 -2.06893886e+01]
Stock Position:  -0.012555137421474802
Bond Position:  [13.51600168]


portfolio before change:  [12.27438015]
curr_Stock_Price:  99.02807881167857
curr_Factors:  [9.90280788e+01 4.84924787e-02]
mat_Sqrt:  [[ 2.18069810e+01  0.00000000e+00]
 [-8.80840315e-03  2.01825871e-02]]
grads:  [4.32969898e-03 1.51769378e+01]
Stock Position:  0.0043296989799904186
Bond Position:  [11.84561838]


portfolio before change:  [12.27169219]
curr_Stock_Price:  98.06525155063554
curr_Factors:  [9.80652516e+01 4.90205092e-02]
mat_Sqrt:  [[ 2.17122113e+01  0.00000000e+00]
 [-8.85623028e-03  2.02921728e-02]]
grads:  [-4.06154925e-03  5.38935704e+00]
Stock Position:  -0.004061549249557484
Bond Position:  [12.66998904]


portfolio before change:  [12.27351812]
curr_Stock_Price:  98.00564906549917
curr_Factors:  [9.80056491e+01 4.68385568e-02]
mat_Sqrt:  [[ 2.12105955e+01  0.00000000e+00]
 [-8.65688691e-03  1.98354198e-02]]
grads:  [0.0319254  1.29482325]
Stock Position:  0.03192539774382658
Bond Position:  [9.14464879]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.20022747]
Stock Price:  95.67415724140875
PL:  [12.20022747]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.20012435e-01  7.93836960e-01]
 [-1.96284846e-01 -7.60354436e-02]
 [ 9.29395540e-01 -8.30012186e-01]
 [-1.48952286e-01  9.77198791e-02]
 [-1.87068383e-01  8.77807312e-02]
 [ 1.91842576e-01  1.81943707e-01]
 [ 1.78096622e-01 -3.16224026e-01]
 [ 5.65446124e-01 -2.61956282e-02]
 [-4.63930173e-01 -3.01249579e-01]
 [ 6.97261055e-01 -6.02091935e-01]
 [ 5.90133348e-02 -1.67784187e-02]
 [-6.73089979e-01 -2.77736714e-01]
 [-1.38554956e-01  1.30540656e-01]
 [-1.21335731e+00 -1.50115353e+00]
 [-1.87969596e-01 -9.31462985e-01]
 [-9.04438380e-02 -2.63599517e-01]
 [-4.95661034e-02  7.92792677e-02]
 [ 1.38473072e-01  1.57174421e-01]
 [ 1.81474323e-02 -1.47974314e-02]
 [-1.12384587e-01 -2.55553987e-02]
 [ 2.02698784e-01  4.79282181e-01]
 [-2.66256573e-02  2.54987658e-01]
 [-1.27473837e-02 -4.53655214e-01]
 [ 1.61778878e-01  2.13032991e-01]
 [ 1.07432119e-01  2.17701180e-01]
 [ 8.09682630e-01 -7.29577907e-01]
 [-4.71024646e-01  5.97001342e-01]
 [ 1.35712320e-01 -1.00954913e-02]
 [-2.06617961e-03 -1.04176318e-01]
 [-5.46112802e-02 -3.36948138e-02]
 [-4.59932266e-01 -9.91473521e-02]
 [-1.18028955e-01  3.63394257e-03]
 [ 6.25823306e-02 -2.23843720e-02]
 [ 1.69403317e-01  5.70120142e-02]
 [-2.92654812e-01 -1.82432046e-01]
 [-4.75028372e-01 -3.25395899e-01]
 [-3.13406148e-02  3.09263964e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.71060017e-01  1.00841099e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.16381525]
curr_Stock_Price:  101.42422965919064
curr_Factors:  [1.01424230e+02 3.93805549e-02]
mat_Sqrt:  [[ 2.01271662e+01  0.00000000e+00]
 [-7.93781380e-03  1.81878163e-02]]
grads:  [3.80814308e-02 4.36466340e+01]
Stock Position:  0.038081430792705775
Bond Position:  [8.30143546]


portfolio before change:  [12.16676223]
curr_Stock_Price:  101.47436535039559
curr_Factors:  [1.01474365e+02 4.03391514e-02]
mat_Sqrt:  [[ 2.03807294e+01  0.00000000e+00]
 [-8.03384356e-03  1.84078481e-02]]
grads:  [-0.01125914 -4.13059925]
Stock Position:  -0.011259137486864057
Bond Position:  [13.30927606]


portfolio before change:  [12.1462088]
curr_Stock_Price:  103.44762425179195
curr_Factors:  [1.03447624e+02 4.04364613e-02]
mat_Sqrt:  [[ 2.08020958e+01  0.00000000e+00]
 [-8.04352771e-03  1.84300373e-02]]
grads:  [ 2.72640088e-02 -4.50358387e+01]
Stock Position:  0.02726400883193133
Bond Position:  [9.32581186]


portfolio before change:  [12.17209181]
curr_Stock_Price:  104.35421176312528
curr_Factors:  [1.04354212e+02 4.07107620e-02]
mat_Sqrt:  [[ 2.10554534e+01  0.00000000e+00]
 [-8.07076323e-03  1.84924417e-02]]
grads:  [-5.04875539e-03  5.28431457e+00]
Stock Position:  -0.005048755394374359
Bond Position:  [12.6989507]


portfolio before change:  [12.17502446]
curr_Stock_Price:  104.08777372933193
curr_Factors:  [1.04087774e+02 4.12632138e-02]
mat_Sqrt:  [[ 2.11437125e+01  0.00000000e+00]
 [-8.12533951e-03  1.86174917e-02]]
grads:  [-0.00703555  4.71496014]
Stock Position:  -0.007035553996313303
Bond Position:  [12.90733961]


portfolio before change:  [12.18043944]
curr_Stock_Price:  103.54745131636435
curr_Factors:  [1.03547451e+02 4.10236236e-02]
mat_Sqrt:  [[ 2.09728004e+01  0.00000000e+00]
 [-8.10171572e-03  1.85633628e-02]]
grads:  [0.01293339 9.80122564]
Stock Position:  0.012933385859220993
Bond Position:  [10.8412203]


portfolio before change:  [12.20360122]
curr_Stock_Price:  105.23351707371059
curr_Factors:  [1.05233517e+02 3.75843964e-02]
mat_Sqrt:  [[ 2.04013016e+01  0.00000000e+00]
 [-7.75467821e-03  1.77682000e-02]]
grads:  [ 1.96483260e-03 -1.77971898e+01]
Stock Position:  0.001964832597899493
Bond Position:  [11.99683497]


portfolio before change:  [12.20572128]
curr_Stock_Price:  105.54924943075845
curr_Factors:  [1.05549249e+02 3.71934677e-02]
mat_Sqrt:  [[ 2.03558145e+01  0.00000000e+00]
 [-7.71424321e-03  1.76755517e-02]]
grads:  [ 0.02721647 -1.48202606]
Stock Position:  0.027216469983733782
Bond Position:  [9.3330433]


portfolio before change:  [12.25267628]
curr_Stock_Price:  107.231624127543
curr_Factors:  [1.07231624e+02 3.62977132e-02]
mat_Sqrt:  [[ 2.04297248e+01  0.00000000e+00]
 [-7.62078350e-03  1.74614086e-02]]
grads:  [ -0.02914412 -17.25230682]
Stock Position:  -0.029144115933526893
Bond Position:  [15.37784717]


portfolio before change:  [12.27081129]
curr_Stock_Price:  106.67533146365056
curr_Factors:  [1.06675331e+02 3.63775637e-02]
mat_Sqrt:  [[ 2.03460827e+01  0.00000000e+00]
 [-7.62916128e-03  1.74806045e-02]]
grads:  [ 2.13548032e-02 -3.44434275e+01]
Stock Position:  0.021354803163967276
Bond Position:  [9.99278058]


portfolio before change:  [12.27552174]
curr_Stock_Price:  106.83741558526495
curr_Factors:  [1.06837416e+02 3.63264645e-02]
mat_Sqrt:  [[ 2.03626802e+01  0.00000000e+00]
 [-7.62380110e-03  1.74683228e-02]]
grads:  [ 0.0025385  -0.96050542]
Stock Position:  0.002538498473840961
Bond Position:  [12.00431512]


portfolio before change:  [12.27893336]
curr_Stock_Price:  107.59021896463001
curr_Factors:  [1.07590219e+02 3.68771715e-02]
mat_Sqrt:  [[ 2.06610121e+01  0.00000000e+00]
 [-7.68137191e-03  1.76002341e-02]]
grads:  [ -0.03844459 -15.78028523]
Stock Position:  -0.03844459378741504
Bond Position:  [16.41519563]


portfolio before change:  [12.26314229]
curr_Stock_Price:  108.05434403668593
curr_Factors:  [1.08054344e+02 3.82430892e-02]
mat_Sqrt:  [[ 2.11309350e+01  0.00000000e+00]
 [-7.82233615e-03  1.79232238e-02]]
grads:  [-3.86080136e-03  7.28332455e+00]
Stock Position:  -0.0038608013603971475
Bond Position:  [12.68031865]


portfolio before change:  [12.261938]
curr_Stock_Price:  108.77684428324677
curr_Factors:  [1.08776844e+02 3.76873527e-02]
mat_Sqrt:  [[ 2.11170997e+01  0.00000000e+00]
 [-7.76529228e-03  1.77925198e-02]]
grads:  [ -0.08848348 -84.36992323]
Stock Position:  -0.08848347775279329
Bond Position:  [21.88689148]


portfolio before change:  [12.22180039]
curr_Stock_Price:  109.26138267804053
curr_Factors:  [1.09261383e+02 3.78193114e-02]
mat_Sqrt:  [[ 2.12482663e+01  0.00000000e+00]
 [-7.77887513e-03  1.78236421e-02]]
grads:  [-2.79784413e-02 -5.22599692e+01]
Stock Position:  -0.027978441284426905
Bond Position:  [15.27876357]


portfolio before change:  [12.26138619]
curr_Stock_Price:  107.91478022127653
curr_Factors:  [1.07914780e+02 3.86035582e-02]
mat_Sqrt:  [[ 2.12028675e+01  0.00000000e+00]
 [-7.85911529e-03  1.80074954e-02]]
grads:  [-9.69152400e-03 -1.46383221e+01]
Stock Position:  -0.009691524001135451
Bond Position:  [13.30724488]


portfolio before change:  [12.26314365]
curr_Stock_Price:  107.90508667565442
curr_Factors:  [1.07905087e+02 3.94899275e-02]
mat_Sqrt:  [[ 2.14429773e+01  0.00000000e+00]
 [-7.94882910e-03  1.82130555e-02]]
grads:  [-6.97934532e-04  4.35288124e+00]
Stock Position:  -0.000697934531975944
Bond Position:  [12.33845433]


portfolio before change:  [12.26447365]
curr_Stock_Price:  108.2094156488612
curr_Factors:  [1.08209416e+02 3.88982862e-02]
mat_Sqrt:  [[ 2.13417626e+01  0.00000000e+00]
 [-7.88905938e-03  1.80761059e-02]]
grads:  [0.00970255 8.69514829]
Stock Position:  0.009702554425316652
Bond Position:  [11.21456591]


portfolio before change:  [12.26056252]
curr_Stock_Price:  107.66182393787767
curr_Factors:  [1.07661824e+02 4.03320376e-02]
mat_Sqrt:  [[ 2.16215495e+01  0.00000000e+00]
 [-8.03313514e-03  1.84062249e-02]]
grads:  [ 5.40632102e-04 -8.03936250e-01]
Stock Position:  0.0005406321017264812
Bond Position:  [12.20235708]


portfolio before change:  [12.26123846]
curr_Stock_Price:  106.09059927522286
curr_Factors:  [1.06090599e+02 4.22224624e-02]
mat_Sqrt:  [[ 2.17996079e+01  0.00000000e+00]
 [-8.21924205e-03  1.88326494e-02]]
grads:  [-0.00566698 -1.3569731 ]
Stock Position:  -0.00566697703047334
Bond Position:  [12.86245144]


portfolio before change:  [12.25853414]
curr_Stock_Price:  106.85153769210261
curr_Factors:  [1.06851538e+02 4.22031358e-02]
mat_Sqrt:  [[ 2.19509407e+01  0.00000000e+00]
 [-8.21736072e-03  1.88283388e-02]]
grads:  [1.87634180e-02 2.54553621e+01]
Stock Position:  0.018763417998968045
Bond Position:  [10.25363408]


portfolio before change:  [12.27366862]
curr_Stock_Price:  107.58981944851172
curr_Factors:  [1.07589819e+02 4.17328229e-02]
mat_Sqrt:  [[ 2.19791078e+01  0.00000000e+00]
 [-8.17144520e-03  1.87231331e-02]]
grads:  [3.85184334e-03 1.36188562e+01]
Stock Position:  0.0038518433371626925
Bond Position:  [11.85924949]


portfolio before change:  [12.27842485]
curr_Stock_Price:  108.4397331237482
curr_Factors:  [1.08439733e+02 4.15325855e-02]
mat_Sqrt:  [[ 2.20995242e+01  0.00000000e+00]
 [-8.15181800e-03  1.86781615e-02]]
grads:  [-9.53589539e-03 -2.42880014e+01]
Stock Position:  -0.009535895385212824
Bond Position:  [13.3124948]


portfolio before change:  [12.28550703]
curr_Stock_Price:  107.87156269845383
curr_Factors:  [1.07871563e+02 4.28939970e-02]
mat_Sqrt:  [[ 2.23411348e+01  0.00000000e+00]
 [-8.28434640e-03  1.89818222e-02]]
grads:  [ 0.01140292 11.22300001]
Stock Position:  0.011402916656359884
Bond Position:  [11.05545659]


portfolio before change:  [12.29774973]
curr_Stock_Price:  108.82401011808203
curr_Factors:  [1.08824010e+02 4.16362746e-02]
mat_Sqrt:  [[ 2.22055052e+01  0.00000000e+00]
 [-8.16198746e-03  1.87014627e-02]]
grads:  [9.11686998e-03 1.16408638e+01]
Stock Position:  0.009116869981203967
Bond Position:  [11.30561537]


portfolio before change:  [12.28003505]
curr_Stock_Price:  106.72592532657075
curr_Factors:  [1.06725925e+02 4.19983178e-02]
mat_Sqrt:  [[ 2.18718680e+01  0.00000000e+00]
 [-8.19739645e-03  1.87825949e-02]]
grads:  [ 2.24612148e-02 -3.88432968e+01]
Stock Position:  0.022461214827442177
Bond Position:  [9.88284111]


portfolio before change:  [12.24971068]
curr_Stock_Price:  105.32084539674166
curr_Factors:  [1.05320845e+02 4.04084790e-02]
mat_Sqrt:  [[ 2.11714493e+01  0.00000000e+00]
 [-8.04074415e-03  1.84236593e-02]]
grads:  [-9.94130804e-03  3.24040589e+01]
Stock Position:  -0.009941308038875555
Bond Position:  [13.29673765]


portfolio before change:  [12.25261878]
curr_Stock_Price:  105.19551952673517
curr_Factors:  [1.05195520e+02 3.88284361e-02]
mat_Sqrt:  [[ 2.07287060e+01  0.00000000e+00]
 [-7.88197297e-03  1.80598689e-02]]
grads:  [ 0.00633451 -0.55900136]
Stock Position:  0.006334514362048336
Bond Position:  [11.58625625]


portfolio before change:  [12.23827667]
curr_Stock_Price:  102.70275118034289
curr_Factors:  [1.02702751e+02 3.95267309e-02]
mat_Sqrt:  [[ 2.04186736e+01  0.00000000e+00]
 [-7.95253227e-03  1.82215405e-02]]
grads:  [-2.32789128e-03 -5.71720692e+00]
Stock Position:  -0.002327891279938604
Bond Position:  [12.47735751]


portfolio before change:  [12.24223844]
curr_Stock_Price:  101.67091834941345
curr_Factors:  [1.01670918e+02 3.95041447e-02]
mat_Sqrt:  [[ 2.02077555e+01  0.00000000e+00]
 [-7.95025984e-03  1.82163338e-02]]
grads:  [-0.00343021 -1.84970336]
Stock Position:  -0.003430212854946868
Bond Position:  [12.59099133]


portfolio before change:  [12.24296708]
curr_Stock_Price:  101.91735565848035
curr_Factors:  [1.01917356e+02 3.83900944e-02]
mat_Sqrt:  [[ 1.99690653e+01  0.00000000e+00]
 [-7.83735613e-03  1.79576389e-02]]
grads:  [-0.02519916 -5.52117976]
Stock Position:  -0.025199162306833424
Bond Position:  [14.81119906]


portfolio before change:  [12.27689681]
curr_Stock_Price:  100.64436828095987
curr_Factors:  [1.00644368e+02 3.77474934e-02]
mat_Sqrt:  [[ 1.95539066e+01  0.00000000e+00]
 [-7.77148566e-03  1.78067106e-02]]
grads:  [-0.00595497  0.20407714]
Stock Position:  -0.005954972301347353
Bond Position:  [12.87623123]


portfolio before change:  [12.2824719]
curr_Stock_Price:  99.97846011702353
curr_Factors:  [9.99784601e+01 3.93194573e-02]
mat_Sqrt:  [[ 1.98248633e+01  0.00000000e+00]
 [-7.93165378e-03  1.81737019e-02]]
grads:  [ 0.00266398 -1.23169028]
Stock Position:  0.002663977501662462
Bond Position:  [12.01613153]


portfolio before change:  [12.28883738]
curr_Stock_Price:  101.80406430747271
curr_Factors:  [1.01804064e+02 4.10132109e-02]
mat_Sqrt:  [[ 2.06170727e+01  0.00000000e+00]
 [-8.10068747e-03  1.85610068e-02]]
grads:  [0.00942352 3.07160139]
Stock Position:  0.009423520154099791
Bond Position:  [11.32948473]


portfolio before change:  [12.28392378]
curr_Stock_Price:  101.1323544801203
curr_Factors:  [1.01132354e+02 4.25255575e-02]
mat_Sqrt:  [[ 2.08552368e+01  0.00000000e+00]
 [-8.24869032e-03  1.89001239e-02]]
grads:  [-0.01785042 -9.65242592]
Stock Position:  -0.017850417482632674
Bond Position:  [14.08917853]


portfolio before change:  [12.32010879]
curr_Stock_Price:  99.20389816209617
curr_Factors:  [9.92038982e+01 4.36591822e-02]
mat_Sqrt:  [[ 2.07284361e+01  0.00000000e+00]
 [-8.35791191e-03  1.91503820e-02]]
grads:  [ -0.02976794 -16.99161399]
Stock Position:  -0.029767937289920273
Bond Position:  [15.27320421]


portfolio before change:  [12.33753811]
curr_Stock_Price:  98.68253029187973
curr_Factors:  [9.86825303e+01 4.32099421e-02]
mat_Sqrt:  [[ 2.05131388e+01  0.00000000e+00]
 [-8.31480050e-03  1.90516013e-02]]
grads:  [5.05204229e-03 1.62329643e+01]
Stock Position:  0.005052042291483614
Bond Position:  [11.83898979]


portfolio before change:  [12.33361045]
curr_Stock_Price:  97.61214746499309
curr_Factors:  [9.76121475e+01 4.48869802e-02]
mat_Sqrt:  [[ 2.06806441e+01  0.00000000e+00]
 [-8.47461906e-03  1.94177917e-02]]
grads:  [-4.26414258e-03  5.63203923e+00]
Stock Position:  -0.00426414258334806
Bond Position:  [12.74984257]


portfolio before change:  [12.34004562]
curr_Stock_Price:  96.47678746839539
curr_Factors:  [9.64767875e+01 4.48080994e-02]
mat_Sqrt:  [[ 2.04221328e+01  0.00000000e+00]
 [-8.46716948e-03  1.94007225e-02]]
grads:  [0.0426743  0.05197801]
Stock Position:  0.042674295303178636
Bond Position:  [8.2229667]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.33029157]
Stock Price:  96.22412986699446
PL:  [12.33029157]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.72387678e-01  4.73704405e-01]
 [-1.82922468e-01 -7.41761733e-02]
 [ 9.37793410e-01 -8.41998968e-01]
 [ 5.53951391e-02  2.72733598e-02]
 [-1.25057096e-01  5.34090181e-02]
 [-5.76991646e-02 -5.33213722e-02]
 [-1.19816680e-02  2.75649037e-01]
 [-6.62435140e-02 -1.13286446e-01]
 [ 1.66257262e-01  9.24664857e-02]
 [ 1.32719612e-01  4.42454963e-02]
 [ 1.68843742e-01  3.75662727e-01]
 [ 1.61621469e-01  2.73695014e-01]
 [ 2.20639804e-01  2.25273066e-02]
 [-1.25967202e-01 -1.19924305e-01]
 [ 8.40986302e-02  2.28583052e-01]
 [ 5.24985941e-02 -1.94476469e-02]
 [-3.47728486e-02  5.03089036e-02]
 [ 4.07817089e-02  5.70823774e-02]
 [ 9.56561188e-03  4.28274249e-02]
 [ 2.52352528e-01 -1.09616988e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 4.30635955e-02  2.24209713e-01]
 [ 2.19129668e-02  1.24403438e-01]
 [-4.91567265e-02  3.52315899e-02]
 [ 5.92920860e-02  1.28117151e-01]
 [ 4.66446927e-02  1.18472641e-01]
 [-3.14919696e-02  2.22822360e-01]
 [-2.06945188e-01  1.46847566e-01]
 [ 1.57168691e-02 -1.44422316e-01]
 [-7.24790636e-03 -4.46309598e-02]
 [-5.97678547e-01 -9.43395795e-02]
 [-1.17962728e-01  1.06301270e-03]
 [ 1.75885668e-01  1.80213461e-01]
 [ 1.97568060e-01  4.25622578e-02]
 [-2.23111219e-01 -2.22701651e-01]
 [ 1.08992105e-01 -3.06258380e-01]
 [-1.67416649e-01  2.09758284e-01]
 [-1.17510715e-01  1.21777404e-01]
 [-1.52277767e-01  1.38314879e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.8040357]
curr_Stock_Price:  100.4663439237585
curr_Factors:  [1.00466344e+02 3.94972095e-02]
mat_Sqrt:  [[ 1.99665856e+01  0.00000000e+00]
 [-7.94956195e-03  1.82147347e-02]]
grads:  [1.89881854e-02 2.60066596e+01]
Stock Position:  0.01898818539285536
Bond Position:  [3.89636213]


portfolio before change:  [5.81878172]
curr_Stock_Price:  101.21728173350485
curr_Factors:  [1.01217282e+02 3.99372338e-02]
mat_Sqrt:  [[ 2.02275676e+01  0.00000000e+00]
 [-7.99372092e-03  1.83159156e-02]]
grads:  [-0.01064367 -4.04982066]
Stock Position:  -0.010643672484985777
Bond Position:  [6.89610532]


portfolio before change:  [5.79476099]
curr_Stock_Price:  103.5550831729168
curr_Factors:  [1.03555083e+02 3.76409058e-02]
mat_Sqrt:  [[ 2.00909954e+01  0.00000000e+00]
 [-7.76050573e-03  1.77815525e-02]]
grads:  [ 2.83865941e-02 -4.73523878e+01]
Stock Position:  0.02838659414755529
Bond Position:  [2.85518488]


portfolio before change:  [5.74599449]
curr_Stock_Price:  101.82456816686184
curr_Factors:  [1.01824568e+02 3.86308709e-02]
mat_Sqrt:  [[ 2.00133517e+01  0.00000000e+00]
 [-7.86189503e-03  1.80138645e-02]]
grads:  [0.00336267 1.51402048]
Stock Position:  0.003362665601911352
Bond Position:  [5.40359251]


portfolio before change:  [5.74625012]
curr_Stock_Price:  101.69970969738584
curr_Factors:  [1.01699710e+02 3.85461901e-02]
mat_Sqrt:  [[ 1.99668908e+01  0.00000000e+00]
 [-7.85327346e-03  1.79941101e-02]]
grads:  [-0.00509581  2.96813891]
Stock Position:  -0.00509581039922628
Bond Position:  [6.26449256]


portfolio before change:  [5.75080667]
curr_Stock_Price:  100.95921191428693
curr_Factors:  [1.00959212e+02 3.86247782e-02]
mat_Sqrt:  [[ 1.98417033e+01  0.00000000e+00]
 [-7.86127503e-03  1.80124439e-02]]
grads:  [-0.00408083 -2.96025194]
Stock Position:  -0.004080825023494716
Bond Position:  [6.16280355]


portfolio before change:  [5.75571367]
curr_Stock_Price:  99.94554424809081
curr_Factors:  [9.99455442e+01 3.93921225e-02]
mat_Sqrt:  [[ 1.98366407e+01  0.00000000e+00]
 [-7.93897953e-03  1.81904873e-02]]
grads:  [5.46067431e-03 1.51534718e+01]
Stock Position:  0.005460674308879771
Bond Position:  [5.2099436]


portfolio before change:  [5.74263408]
curr_Stock_Price:  97.43104383823568
curr_Factors:  [9.74310438e+01 4.08928038e-02]
mat_Sqrt:  [[ 1.97024757e+01  0.00000000e+00]
 [-8.08878768e-03  1.85337409e-02]]
grads:  [-5.87163636e-03 -6.11244362e+00]
Stock Position:  -0.0058716363639230475
Bond Position:  [6.31471374]


portfolio before change:  [5.73875448]
curr_Stock_Price:  98.22622063216063
curr_Factors:  [9.82262206e+01 4.07026730e-02]
mat_Sqrt:  [[ 1.98170452e+01  0.00000000e+00]
 [-8.06996138e-03  1.84906044e-02]]
grads:  [0.01042602 5.00072812]
Stock Position:  0.010426021809146686
Bond Position:  [4.71464576]


portfolio before change:  [5.73757127]
curr_Stock_Price:  98.05620588819116
curr_Factors:  [9.80562059e+01 4.05751364e-02]
mat_Sqrt:  [[ 1.97517272e+01  0.00000000e+00]
 [-8.05730838e-03  1.84616128e-02]]
grads:  [0.00769704 2.39662141]
Stock Position:  0.007697044813537468
Bond Position:  [4.98282826]


portfolio before change:  [5.72376616]
curr_Stock_Price:  96.18171907602938
curr_Factors:  [9.61817191e+01 4.05167134e-02]
mat_Sqrt:  [[ 1.93601911e+01  0.00000000e+00]
 [-8.05150554e-03  1.84483168e-02]]
grads:  [1.71897269e-02 2.03629812e+01]
Stock Position:  0.017189726902147144
Bond Position:  [4.07042867]


portfolio before change:  [5.72109511]
curr_Stock_Price:  95.99673187604034
curr_Factors:  [9.59967319e+01 3.97652000e-02]
mat_Sqrt:  [[ 1.91429134e+01  0.00000000e+00]
 [-7.97648545e-03  1.82764242e-02]]
grads:  [1.46828103e-02 1.49753043e+01]
Stock Position:  0.014682810341753732
Bond Position:  [4.3115933]


portfolio before change:  [5.7303431]
curr_Stock_Price:  96.58987478697189
curr_Factors:  [9.65898748e+01 3.90530037e-02]
mat_Sqrt:  [[ 1.90879296e+01  0.00000000e+00]
 [-7.90473314e-03  1.81120190e-02]]
grads:  [0.0120742  1.24377667]
Stock Position:  0.012074202471790306
Bond Position:  [4.5640974]


portfolio before change:  [5.72863476]
curr_Stock_Price:  96.40113437452742
curr_Factors:  [9.64011344e+01 4.01518669e-02]
mat_Sqrt:  [[ 1.93167926e+01  0.00000000e+00]
 [-8.01517230e-03  1.83650669e-02]]
grads:  [-0.00923065 -6.53002274]
Stock Position:  -0.009230645267531394
Bond Position:  [6.61847943]


portfolio before change:  [5.70778746]
curr_Stock_Price:  98.74925439858126
curr_Factors:  [9.87492544e+01 4.02771516e-02]
mat_Sqrt:  [[ 1.98181540e+01  0.00000000e+00]
 [-8.02766731e-03  1.83936966e-02]]
grads:  [9.27737530e-03 1.24272493e+01]
Stock Position:  0.009277375302145292
Bond Position:  [4.79165356]


portfolio before change:  [5.71112675]
curr_Stock_Price:  99.04462881320585
curr_Factors:  [9.90446288e+01 4.02404224e-02]
mat_Sqrt:  [[ 1.98683679e+01  0.00000000e+00]
 [-8.02400622e-03  1.83853079e-02]]
grads:  [ 0.00221513 -1.05778195]
Stock Position:  0.0022151263383999756
Bond Position:  [5.49173038]


portfolio before change:  [5.71085158]
curr_Stock_Price:  98.61048869754784
curr_Factors:  [9.86104887e+01 4.01897872e-02]
mat_Sqrt:  [[ 1.97688299e+01  0.00000000e+00]
 [-8.01895626e-03  1.83737370e-02]]
grads:  [-6.48305595e-04  2.73808771e+00]
Stock Position:  -0.0006483055953859085
Bond Position:  [5.77478132]


portfolio before change:  [5.71241058]
curr_Stock_Price:  97.31927325728071
curr_Factors:  [9.73192733e+01 4.06174680e-02]
mat_Sqrt:  [[ 1.96135082e+01  0.00000000e+00]
 [-8.06151033e-03  1.84712406e-02]]
grads:  [0.00334945 3.09033803]
Stock Position:  0.003349451833188636
Bond Position:  [5.38644436]


portfolio before change:  [5.70950122]
curr_Stock_Price:  96.24963377450024
curr_Factors:  [9.62496338e+01 4.17788263e-02]
mat_Sqrt:  [[ 1.96732995e+01  0.00000000e+00]
 [-8.17594778e-03  1.87334498e-02]]
grads:  [1.43631385e-03 2.28614726e+00]
Stock Position:  0.0014363138486558498
Bond Position:  [5.57125654]


portfolio before change:  [5.70964924]
curr_Stock_Price:  95.8678026546916
curr_Factors:  [9.58678027e+01 4.10927252e-02]
mat_Sqrt:  [[ 1.94336889e+01  0.00000000e+00]
 [-8.10853626e-03  1.85789906e-02]]
grads:  [ 0.01052357 -5.90005076]
Stock Position:  0.010523568319376644
Bond Position:  [4.70077787]


portfolio before change:  [5.70834454]
curr_Stock_Price:  95.6879841241068
curr_Factors:  [9.56879841e+01 4.15687641e-02]
mat_Sqrt:  [[ 1.95092674e+01  0.00000000e+00]
 [-8.15536772e-03  1.86862949e-02]]
grads:  [ 0.00215942 -2.02169503]
Stock Position:  0.0021594153037780045
Bond Position:  [5.50171445]


portfolio before change:  [5.71185489]
curr_Stock_Price:  96.9950940013832
curr_Factors:  [9.6995094e+01 4.1168611e-02]
mat_Sqrt:  [[ 1.96803526e+01  0.00000000e+00]
 [-8.11601981e-03  1.85961376e-02]]
grads:  [7.16027499e-03 1.20567893e+01]
Stock Position:  0.007160274989757742
Bond Position:  [5.01734335]


portfolio before change:  [5.70533074]
curr_Stock_Price:  95.99633833635642
curr_Factors:  [9.59963383e+01 4.06634728e-02]
mat_Sqrt:  [[ 1.93578402e+01  0.00000000e+00]
 [-8.06607442e-03  1.84816983e-02]]
grads:  [3.93675521e-03 6.73116917e+00]
Stock Position:  0.00393675520651711
Bond Position:  [5.32741665]


portfolio before change:  [5.70429387]
curr_Stock_Price:  95.56379100774453
curr_Factors:  [9.55637910e+01 3.97444922e-02]
mat_Sqrt:  [[ 1.90516172e+01  0.00000000e+00]
 [-7.97440829e-03  1.82716648e-02]]
grads:  [-1.77309883e-03  1.92820908e+00]
Stock Position:  -0.0017730988275459327
Bond Position:  [5.87373792]


portfolio before change:  [5.70386355]
curr_Stock_Price:  96.22060056814371
curr_Factors:  [9.62206006e+01 3.86780870e-02]
mat_Sqrt:  [[ 1.89234604e+01  0.00000000e+00]
 [-7.86669811e-03  1.80248698e-02]]
grads:  [6.08805113e-03 7.10779897e+00]
Stock Position:  0.006088051134843005
Bond Position:  [5.11806761]


portfolio before change:  [5.70068987]
curr_Stock_Price:  95.59421422384607
curr_Factors:  [9.55942142e+01 3.92276683e-02]
mat_Sqrt:  [[ 1.89333671e+01  0.00000000e+00]
 [-7.92239038e-03  1.81524768e-02]]
grads:  [5.19455372e-03 6.52652762e+00]
Stock Position:  0.005194553715701607
Bond Position:  [5.20412059]


portfolio before change:  [5.71552777]
curr_Stock_Price:  98.3254096946983
curr_Factors:  [9.83254097e+01 3.76463019e-02]
mat_Sqrt:  [[ 1.90777400e+01  0.00000000e+00]
 [-7.76106198e-03  1.77828270e-02]]
grads:  [3.44672278e-03 1.25301989e+01]
Stock Position:  0.0034467227834222717
Bond Position:  [5.37662734]


portfolio before change:  [5.71967044]
curr_Stock_Price:  99.33232308293466
curr_Factors:  [9.93323231e+01 3.58162970e-02]
mat_Sqrt:  [[ 1.87988349e+01  0.00000000e+00]
 [-7.57007762e-03  1.73452269e-02]]
grads:  [-7.59917605e-03  8.46616575e+00]
Stock Position:  -0.007599176054562325
Bond Position:  [6.47451425]


portfolio before change:  [5.71740748]
curr_Stock_Price:  99.73662078143064
curr_Factors:  [9.97366208e+01 3.67367368e-02]
mat_Sqrt:  [[ 1.91163484e+01  0.00000000e+00]
 [-7.66673196e-03  1.75666898e-02]]
grads:  [-2.47506458e-03 -8.22137338e+00]
Stock Position:  -0.002475064579550659
Bond Position:  [5.96426205]


portfolio before change:  [5.71659129]
curr_Stock_Price:  100.36762036008338
curr_Factors:  [1.00367620e+02 3.64866727e-02]
mat_Sqrt:  [[ 1.91717059e+01  0.00000000e+00]
 [-7.64059398e-03  1.75068001e-02]]
grads:  [-1.39405718e-03 -2.54934994e+00]
Stock Position:  -0.0013940571750921799
Bond Position:  [5.85650949]


portfolio before change:  [5.71691048]
curr_Stock_Price:  100.66382312394028
curr_Factors:  [1.00663823e+02 3.63631917e-02]
mat_Sqrt:  [[ 1.91957205e+01  0.00000000e+00]
 [-7.62765408e-03  1.74771511e-02]]
grads:  [-0.03328094 -5.39788087]
Stock Position:  -0.03328094480429634
Bond Position:  [9.06709762]


portfolio before change:  [5.68043017]
curr_Stock_Price:  101.79401222455698
curr_Factors:  [1.01794012e+02 3.48634272e-02]
mat_Sqrt:  [[ 1.90067241e+01  0.00000000e+00]
 [-7.46870026e-03  1.71129421e-02]]
grads:  [-0.00618196  0.06211747]
Stock Position:  -0.006181959104739258
Bond Position:  [6.3097166]


portfolio before change:  [5.66810223]
curr_Stock_Price:  103.91578374896284
curr_Factors:  [1.03915784e+02 3.34081449e-02]
mat_Sqrt:  [[ 1.89936179e+01  0.00000000e+00]
 [-7.31115804e-03  1.67519676e-02]]
grads:  [ 0.0134012  10.75774893]
Stock Position:  0.013401199891830631
Bond Position:  [4.27550604]


portfolio before change:  [5.67218399]
curr_Stock_Price:  104.18048291316126
curr_Factors:  [1.04180483e+02 3.14957175e-02]
mat_Sqrt:  [[ 1.84889445e+01  0.00000000e+00]
 [-7.09881314e-03  1.62654243e-02]]
grads:  [0.01169043 2.61673209]
Stock Position:  0.01169043220483124
Bond Position:  [4.45426912]


portfolio before change:  [5.67449307]
curr_Stock_Price:  104.330371044255
curr_Factors:  [1.04330371e+02 3.11254966e-02]
mat_Sqrt:  [[ 1.84064017e+01  0.00000000e+00]
 [-7.05696781e-03  1.61695446e-02]]
grads:  [ -0.01740189 -13.7729081 ]
Stock Position:  -0.01740189052491109
Bond Position:  [7.49003876]


portfolio before change:  [5.68766964]
curr_Stock_Price:  103.62698457713074
curr_Factors:  [1.03626985e+02 3.08493043e-02]
mat_Sqrt:  [[ 1.82010125e+01  0.00000000e+00]
 [-7.02558801e-03  1.60976444e-02]]
grads:  [-1.35541969e-03 -1.90250432e+01]
Stock Position:  -0.0013554196918475223
Bond Position:  [5.82812769]


portfolio before change:  [5.6867545]
curr_Stock_Price:  104.83966940093077
curr_Factors:  [1.04839669e+02 3.14403535e-02]
mat_Sqrt:  [[ 1.85895704e+01  0.00000000e+00]
 [-7.09257116e-03  1.62511221e-02]]
grads:  [-4.08135463e-03  1.29073108e+01]
Stock Position:  -0.004081354625890418
Bond Position:  [6.11464237]


portfolio before change:  [5.6821682]
curr_Stock_Price:  106.15067451427986
curr_Factors:  [1.06150675e+02 3.17585581e-02]
mat_Sqrt:  [[ 1.89170384e+01  0.00000000e+00]
 [-7.12837239e-03  1.63331530e-02]]
grads:  [-3.40236652e-03  7.45584174e+00]
Stock Position:  -0.003402366521734509
Bond Position:  [6.0433317]


portfolio before change:  [5.68508275]
curr_Stock_Price:  105.51609099394453
curr_Factors:  [1.05516091e+02 3.14672109e-02]
mat_Sqrt:  [[ 1.87174990e+01  0.00000000e+00]
 [-7.09559987e-03  1.62580617e-02]]
grads:  [-4.91049606e-03  8.50746425e+00]
Stock Position:  -0.0049104960569895315
Bond Position:  [6.2032191]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.6827225]
Stock Price:  106.15466126620471
PL:  [-0.47193876]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.97024205e-01  5.04516427e-01]
 [-1.79207965e-01 -7.28727037e-02]
 [ 7.65752366e-01 -6.46577611e-01]
 [ 5.50591769e-02  2.65040418e-02]
 [-1.45961937e-01  6.17753416e-02]
 [-1.79993387e-02  3.91687431e-03]
 [ 1.22470564e-03  3.19291009e-01]
 [ 1.22838054e-01 -3.11193452e-02]
 [ 1.46171991e-01  7.64474370e-02]
 [ 1.63114750e-01  2.81441099e-03]
 [ 9.77080449e-02  1.18936688e-01]
 [-1.15613516e-01 -4.45692160e-02]
 [-1.36216799e-01  1.46930611e-01]
 [-4.04499593e-01 -5.30608742e-01]
 [ 8.28453365e-02  2.27587975e-01]
 [ 5.29430337e-02 -1.97308228e-02]
 [-5.16016984e-02  1.93706653e-01]
 [-1.31493503e-01 -2.19955162e-03]
 [ 1.52307018e-02  5.76254265e-02]
 [-4.67636377e-03 -8.78833369e-02]
 [ 1.12758739e-01  1.80686898e-02]
 [ 4.39030783e-02  2.09513344e-01]
 [ 3.81765827e-02  4.07105778e-01]
 [ 5.46677305e-02  1.75737645e-01]
 [ 4.34119952e-02  9.53812027e-02]
 [ 7.44084704e-01 -4.36432907e-01]
 [-4.14759957e-01  5.28979694e-01]
 [ 1.50517275e-01 -7.59520749e-03]
 [-4.65938619e-02 -6.34668802e-02]
 [-2.34748821e-02 -1.35971171e-01]
 [-1.15094484e-01 -7.84323746e-02]
 [ 5.94158676e-02 -9.38639418e-03]
 [ 2.04616426e-01  2.28090783e-01]
 [ 2.14365946e-01  3.39442010e-02]
 [-1.94045759e-01 -2.36758230e-01]
 [ 1.68704790e-01 -1.19549656e-01]
 [-1.88344929e-01  1.94044237e-01]
 [-1.17345521e-01  1.21888847e-01]
 [-2.02128774e-01  1.50967710e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.39054694]
curr_Stock_Price:  100.55468201003256
curr_Factors:  [1.00554682e+02 4.04436455e-02]
mat_Sqrt:  [[ 2.02221555e+01  0.00000000e+00]
 [-8.04424222e-03  1.84316744e-02]]
grads:  [2.06314914e-02 2.73722514e+01]
Stock Position:  0.020631491363540918
Bond Position:  [4.31595389]


portfolio before change:  [6.40272182]
curr_Stock_Price:  101.11864248240902
curr_Factors:  [1.01118642e+02 4.04376150e-02]
mat_Sqrt:  [[ 2.03340552e+01  0.00000000e+00]
 [-8.04364246e-03  1.84303002e-02]]
grads:  [-0.01037728 -3.95396183]
Stock Position:  -0.010377281796499603
Bond Position:  [7.45205846]


portfolio before change:  [6.40704665]
curr_Stock_Price:  100.79165272893306
curr_Factors:  [1.00791653e+02 3.96917903e-02]
mat_Sqrt:  [[ 2.00805180e+01  0.00000000e+00]
 [-7.96911943e-03  1.82595465e-02]]
grads:  [ 2.40811897e-02 -3.54103872e+01]
Stock Position:  0.024081189673755492
Bond Position:  [3.97986374]


portfolio before change:  [6.43174975]
curr_Stock_Price:  101.79681844935419
curr_Factors:  [1.01796818e+02 3.97796832e-02]
mat_Sqrt:  [[ 2.03032174e+01  0.00000000e+00]
 [-7.97793790e-03  1.82797522e-02]]
grads:  [0.00328157 1.44991253]
Stock Position:  0.0032815729520889055
Bond Position:  [6.09769606]


portfolio before change:  [6.43442871]
curr_Stock_Price:  102.38089872046736
curr_Factors:  [1.02380899e+02 3.93518424e-02]
mat_Sqrt:  [[ 2.03096048e+01  0.00000000e+00]
 [-7.93491952e-03  1.81811847e-02]]
grads:  [-0.00585934  3.39776218]
Stock Position:  -0.005859344329228644
Bond Position:  [7.03431365]


portfolio before change:  [6.44037053]
curr_Stock_Price:  101.5168979835949
curr_Factors:  [1.01516898e+02 4.09659643e-02]
mat_Sqrt:  [[ 2.05470714e+01  0.00000000e+00]
 [-8.09602018e-03  1.85503127e-02]]
grads:  [-0.00079281  0.2111487 ]
Stock Position:  -0.0007928076113147782
Bond Position:  [6.5208539]


portfolio before change:  [6.44165293]
curr_Stock_Price:  100.92754461536165
curr_Factors:  [1.00927545e+02 4.18928871e-02]
mat_Sqrt:  [[ 2.06575995e+01  0.00000000e+00]
 [-8.18710079e-03  1.87590046e-02]]
grads:  [6.80498846e-03 1.70206798e+01]
Stock Position:  0.006804988464730176
Bond Position:  [5.75484215]


portfolio before change:  [6.43657263]
curr_Stock_Price:  100.07527191888077
curr_Factors:  [1.00075272e+02 4.27823169e-02]
mat_Sqrt:  [[ 2.06994559e+01  0.00000000e+00]
 [-8.27355468e-03  1.89570953e-02]]
grads:  [ 0.00527823 -1.64156717]
Stock Position:  0.005278228509760759
Bond Position:  [5.90835247]


portfolio before change:  [6.43900218]
curr_Stock_Price:  100.39563774517258
curr_Factors:  [1.00395638e+02 4.32946453e-02]
mat_Sqrt:  [[ 2.08896872e+01  0.00000000e+00]
 [-8.32294615e-03  1.90702654e-02]]
grads:  [0.0085945  4.00872435]
Stock Position:  0.008594498633655343
Bond Position:  [5.57615201]


portfolio before change:  [6.42388059]
curr_Stock_Price:  98.55508191899287
curr_Factors:  [9.85550819e+01 4.49723841e-02]
mat_Sqrt:  [[ 2.09002740e+01  0.00000000e+00]
 [-8.48267732e-03  1.94362555e-02]]
grads:  [0.0078632  0.14480212]
Stock Position:  0.007863201211018004
Bond Position:  [5.64892215]


portfolio before change:  [6.43328085]
curr_Stock_Price:  99.66075179277969
curr_Factors:  [9.96607518e+01 4.42011779e-02]
mat_Sqrt:  [[ 2.09527524e+01  0.00000000e+00]
 [-8.40963047e-03  1.92688841e-02]]
grads:  [0.00714065 6.17247411]
Stock Position:  0.007140650001069559
Bond Position:  [5.72163831]


portfolio before change:  [6.43969771]
curr_Stock_Price:  100.45922384840846
curr_Factors:  [1.00459224e+02 4.46549485e-02]
mat_Sqrt:  [[ 2.12287594e+01  0.00000000e+00]
 [-8.45268700e-03  1.93675390e-02]]
grads:  [-0.00636237 -2.3012328 ]
Stock Position:  -0.006362365033651267
Bond Position:  [7.07885596]


portfolio before change:  [6.4351652]
curr_Stock_Price:  101.31070406234768
curr_Factors:  [1.01310704e+02 4.21294347e-02]
mat_Sqrt:  [[ 2.07944841e+01  0.00000000e+00]
 [-8.21018243e-03  1.88118912e-02]]
grads:  [-3.46683394e-03  7.81051779e+00]
Stock Position:  -0.0034668339404899345
Bond Position:  [6.78639258]


portfolio before change:  [6.43898211]
curr_Stock_Price:  100.45442844175227
curr_Factors:  [1.00454428e+02 4.25711908e-02]
mat_Sqrt:  [[ 2.07265485e+01  0.00000000e+00]
 [-8.25311488e-03  1.89102618e-02]]
grads:  [ -0.03068896 -28.05930168]
Stock Position:  -0.030688960774518166
Bond Position:  [9.52182413]


portfolio before change:  [6.48227629]
curr_Stock_Price:  99.08247344086243
curr_Factors:  [9.90824734e+01 4.20766545e-02]
mat_Sqrt:  [[ 2.03243863e+01  0.00000000e+00]
 [-8.20503792e-03  1.88001037e-02]]
grads:  [8.96326557e-03 1.21056766e+01]
Stock Position:  0.008963265574333261
Bond Position:  [5.59417377]


portfolio before change:  [6.48696091]
curr_Stock_Price:  99.52709945255849
curr_Factors:  [9.95270995e+01 4.08738836e-02]
mat_Sqrt:  [[ 2.01216828e+01  0.00000000e+00]
 [-8.08691620e-03  1.85294528e-02]]
grads:  [ 0.00220319 -1.0648357 ]
Stock Position:  0.0022031853412712416
Bond Position:  [6.26768426]


portfolio before change:  [6.48837751]
curr_Stock_Price:  99.81445543588816
curr_Factors:  [9.98144554e+01 4.12330337e-02]
mat_Sqrt:  [[ 2.02682422e+01  0.00000000e+00]
 [-8.12236751e-03  1.86106820e-02]]
grads:  [1.62514419e-03 1.04083587e+01]
Stock Position:  0.001625144186585217
Bond Position:  [6.32616463]


portfolio before change:  [6.48954149]
curr_Stock_Price:  100.04407120613519
curr_Factors:  [1.00044071e+02 4.09484947e-02]
mat_Sqrt:  [[ 2.02446525e+01  0.00000000e+00]
 [-8.09429376e-03  1.85463569e-02]]
grads:  [-0.00654264 -0.1185975 ]
Stock Position:  -0.006542639613936437
Bond Position:  [7.1440938]


portfolio before change:  [6.49461808]
curr_Stock_Price:  99.40464716458045
curr_Factors:  [9.94046472e+01 4.05321767e-02]
mat_Sqrt:  [[ 2.00127446e+01  0.00000000e+00]
 [-8.05304183e-03  1.84518369e-02]]
grads:  [2.01773923e-03 3.12301842e+00]
Stock Position:  0.0020177392305281592
Bond Position:  [6.29404542]


portfolio before change:  [6.49630554]
curr_Stock_Price:  99.85101317174276
curr_Factors:  [9.98510132e+01 4.04978969e-02]
mat_Sqrt:  [[ 2.00941070e+01  0.00000000e+00]
 [-8.04963571e-03  1.84440325e-02]]
grads:  [-2.14151325e-03 -4.76486566e+00]
Stock Position:  -0.002141513252997797
Bond Position:  [6.7101378]


portfolio before change:  [6.49672155]
curr_Stock_Price:  100.04844575430701
curr_Factors:  [1.00048446e+02 4.03602078e-02]
mat_Sqrt:  [[ 2.00995828e+01  0.00000000e+00]
 [-8.03594005e-03  1.84126518e-02]]
grads:  [0.00600234 0.98131926]
Stock Position:  0.006002341569489598
Bond Position:  [5.89619661]


portfolio before change:  [6.50360771]
curr_Stock_Price:  101.07289476964445
curr_Factors:  [1.01072895e+02 4.12790962e-02]
mat_Sqrt:  [[ 2.05352405e+01  0.00000000e+00]
 [-8.12690310e-03  1.86210743e-02]]
grads:  [6.59072865e-03 1.12514101e+01]
Stock Position:  0.0065907286499508584
Bond Position:  [5.83746369]


portfolio before change:  [6.50339708]
curr_Stock_Price:  100.9302143405106
curr_Factors:  [1.00930214e+02 4.17723076e-02]
mat_Sqrt:  [[ 2.06283945e+01  0.00000000e+00]
 [-8.17530991e-03  1.87319882e-02]]
grads:  [1.04638347e-02 2.17331856e+01]
Stock Position:  0.010463834703851869
Bond Position:  [5.44728]


portfolio before change:  [6.52610405]
curr_Stock_Price:  103.03518097269716
curr_Factors:  [1.03035181e+02 4.25047864e-02]
mat_Sqrt:  [[ 2.12424428e+01  0.00000000e+00]
 [-8.24667559e-03  1.88955076e-02]]
grads:  [6.18412524e-03 9.30049878e+00]
Stock Position:  0.00618412524367706
Bond Position:  [5.88892159]


portfolio before change:  [6.52667971]
curr_Stock_Price:  103.00922746140941
curr_Factors:  [1.03009227e+02 4.30051326e-02]
mat_Sqrt:  [[ 2.13617228e+01  0.00000000e+00]
 [-8.29507156e-03  1.90063967e-02]]
grads:  [3.98094131e-03 5.01837378e+00]
Stock Position:  0.003980941307907313
Bond Position:  [6.11660602]


portfolio before change:  [6.52870993]
curr_Stock_Price:  103.32714094404633
curr_Factors:  [1.03327141e+02 4.23443250e-02]
mat_Sqrt:  [[ 2.12623871e+01  0.00000000e+00]
 [-8.23109471e-03  1.88598073e-02]]
grads:  [  0.02603705 -23.14089961]
Stock Position:  0.02603704684214372
Bond Position:  [3.83837632]


portfolio before change:  [6.56666255]
curr_Stock_Price:  104.76635145527587
curr_Factors:  [1.04766351e+02 4.30257326e-02]
mat_Sqrt:  [[ 2.17313125e+01  0.00000000e+00]
 [-8.29705804e-03  1.90109483e-02]]
grads:  [-8.46218064e-03  2.78250031e+01]
Stock Position:  -0.008462180636884423
Bond Position:  [7.45321434]


portfolio before change:  [6.57378262]
curr_Stock_Price:  104.03505465385119
curr_Factors:  [1.04035055e+02 4.31288216e-02]
mat_Sqrt:  [[ 2.16054589e+01  0.00000000e+00]
 [-8.30699190e-03  1.90337096e-02]]
grads:  [ 0.00681321 -0.39903979]
Stock Position:  0.006813206586973951
Bond Position:  [5.8649703]


portfolio before change:  [6.57895316]
curr_Stock_Price:  104.68634376837963
curr_Factors:  [1.04686344e+02 4.19415366e-02]
mat_Sqrt:  [[ 2.14393790e+01  0.00000000e+00]
 [-8.19185318e-03  1.87698936e-02]]
grads:  [-0.00346526 -3.38131272]
Stock Position:  -0.003465262656088516
Bond Position:  [6.94171884]


portfolio before change:  [6.58230861]
curr_Stock_Price:  103.96845353150937
curr_Factors:  [1.03968454e+02 4.29422412e-02]
mat_Sqrt:  [[ 2.15448730e+01  0.00000000e+00]
 [-8.28900392e-03  1.89924940e-02]]
grads:  [-3.84395705e-03 -7.15920571e+00]
Stock Position:  -0.0038439570496336065
Bond Position:  [6.98195888]


portfolio before change:  [6.58123846]
curr_Stock_Price:  104.47390694625295
curr_Factors:  [1.04473907e+02 4.12003526e-02]
mat_Sqrt:  [[ 2.12059778e+01  0.00000000e+00]
 [-8.11914800e-03  1.86033051e-02]]
grads:  [-0.00704165 -4.21604516]
Stock Position:  -0.007041654959761306
Bond Position:  [7.31690767]


portfolio before change:  [6.57442068]
curr_Stock_Price:  105.57200870764862
curr_Factors:  [1.05572009e+02 4.07604524e-02]
mat_Sqrt:  [[ 2.13141630e+01  0.00000000e+00]
 [-8.07568721e-03  1.85037240e-02]]
grads:  [ 0.00259542 -0.50727055]
Stock Position:  0.0025954248977903913
Bond Position:  [6.30041646]


portfolio before change:  [6.57375089]
curr_Stock_Price:  105.01048348366591
curr_Factors:  [1.05010483e+02 4.19875912e-02]
mat_Sqrt:  [[ 2.15175657e+01  0.00000000e+00]
 [-8.19634955e-03  1.87801961e-02]]
grads:  [ 0.01413559 12.14528225]
Stock Position:  0.014135586174455527
Bond Position:  [5.08936615]


portfolio before change:  [6.57061011]
curr_Stock_Price:  104.74328660093214
curr_Factors:  [1.04743287e+02 4.20109163e-02]
mat_Sqrt:  [[ 2.14687755e+01  0.00000000e+00]
 [-8.19862587e-03  1.87854118e-02]]
grads:  [0.01067506 1.80694474]
Stock Position:  0.010675057368571328
Bond Position:  [5.45246952]


portfolio before change:  [6.58655359]
curr_Stock_Price:  106.17296305521383
curr_Factors:  [1.06172963e+02 4.00378567e-02]
mat_Sqrt:  [[ 2.12446386e+01  0.00000000e+00]
 [-8.00378477e-03  1.83389748e-02]]
grads:  [ -0.01399767 -12.91011263]
Stock Position:  -0.013997673817180577
Bond Position:  [8.0727281]


portfolio before change:  [6.58718827]
curr_Stock_Price:  106.19971589081094
curr_Factors:  [1.06199716e+02 4.03751102e-02]
mat_Sqrt:  [[ 2.13393023e+01  0.00000000e+00]
 [-8.03742349e-03  1.84160508e-02]]
grads:  [ 5.46077097e-03 -6.49160114e+00]
Stock Position:  0.005460770971708039
Bond Position:  [6.00725594]


portfolio before change:  [6.58728415]
curr_Stock_Price:  106.0797554439791
curr_Factors:  [1.06079755e+02 4.11394735e-02]
mat_Sqrt:  [[ 2.15160168e+01  0.00000000e+00]
 [-8.11314721e-03  1.85895556e-02]]
grads:  [-4.81767059e-03  1.04383473e+01]
Stock Position:  -0.004817670586971824
Bond Position:  [7.09834146]


portfolio before change:  [6.5871818]
curr_Stock_Price:  106.28518472648993
curr_Factors:  [1.06285185e+02 4.07189037e-02]
mat_Sqrt:  [[ 2.14472083e+01  0.00000000e+00]
 [-8.07157023e-03  1.84942908e-02]]
grads:  [-2.99101241e-03  6.59062026e+00]
Stock Position:  -0.002991012409537038
Bond Position:  [6.90508211]


portfolio before change:  [6.58658265]
curr_Stock_Price:  106.77409663716489
curr_Factors:  [1.06774097e+02 4.11473097e-02]
mat_Sqrt:  [[ 2.16589116e+01  0.00000000e+00]
 [-8.11391986e-03  1.85913260e-02]]
grads:  [-6.29030057e-03  8.12033042e+00]
Stock Position:  -0.006290300567531514
Bond Position:  [7.25822381]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.57521427]
Stock Price:  108.72562715980501
PL:  [-2.15041289]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.79043035e-01  4.81747829e-01]
 [-1.71805453e-01 -8.21037201e-02]
 [ 8.13044232e-01 -6.78747536e-01]
 [ 5.52345411e-02  2.67609934e-02]
 [-1.85082228e-01  9.59460574e-02]
 [ 3.68308093e-01  3.22676587e-01]
 [ 1.90266447e-01 -3.83130759e-01]
 [ 5.91749090e-01 -2.84481640e-02]
 [-4.28153007e-01 -2.65925586e-01]
 [ 7.26277742e-01 -6.38902582e-01]
 [ 5.89942347e-02 -1.68443680e-02]
 [-6.33284140e-01 -2.69578339e-01]
 [-1.36339274e-01  1.29116591e-01]
 [-8.74816096e-01 -1.26873323e+00]
 [-1.69998407e-01 -8.61970369e-01]
 [-8.66501914e-02 -2.59911006e-01]
 [-4.97182247e-02  8.78304969e-02]
 [ 1.42011224e-01  1.57182650e-01]
 [-3.70283088e-01 -2.95892836e-01]
 [-8.85402188e-02 -3.20397814e-02]
 [ 5.04048857e-02  4.95181488e-01]
 [ 3.98404303e-02  2.86369747e-01]
 [-2.95569399e-03 -3.63467201e-01]
 [ 2.00914056e-01  2.25375305e-01]
 [ 1.04714525e-01  2.12643995e-01]
 [ 8.47296585e-01 -9.00064645e-01]
 [-8.33271512e-01  1.00143114e+00]
 [ 1.10117915e-01 -1.24940038e-02]
 [-5.27854830e-02 -5.67004652e-02]
 [ 1.20591483e-01 -1.12462881e-01]
 [ 1.75318046e-02 -9.56534219e-02]
 [ 3.01291699e-01 -2.88464740e-02]
 [ 3.71900433e-01  5.06855105e-01]
 [ 2.90667999e-01 -5.20211996e-03]
 [-1.08186820e-01 -2.92977042e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-3.59091857e-01  6.96876978e-02]
 [-1.09499312e-01  1.27030067e-01]
 [-3.59996887e-01  1.79888904e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.9618311]
curr_Stock_Price:  100.49011046501404
curr_Factors:  [1.00490110e+02 3.88376464e-02]
mat_Sqrt:  [[ 1.98038567e+01  0.00000000e+00]
 [-7.88290772e-03  1.80620107e-02]]
grads:  [1.96575359e-02 2.66718827e+01]
Stock Position:  0.019657535945463805
Bond Position:  [3.98644314]


portfolio before change:  [5.9579219]
curr_Stock_Price:  100.265894208191
curr_Factors:  [1.00265894e+02 3.88177841e-02]
mat_Sqrt:  [[ 1.97546164e+01  0.00000000e+00]
 [-7.88089174e-03  1.80573915e-02]]
grads:  [-0.01051088 -4.54682064]
Stock Position:  -0.010510882628509733
Bond Position:  [7.01180494]


portfolio before change:  [5.94172512]
curr_Stock_Price:  101.8902397519315
curr_Factors:  [1.01890240e+02 3.81257525e-02]
mat_Sqrt:  [[ 1.98949016e+01  0.00000000e+00]
 [-7.81032676e-03  1.78957068e-02]]
grads:  [ 2.59772343e-02 -3.79279536e+01]
Stock Position:  0.025977234307834024
Bond Position:  [3.29489849]


portfolio before change:  [5.94001943]
curr_Stock_Price:  101.80872313558204
curr_Factors:  [1.01808723e+02 3.74585473e-02]
mat_Sqrt:  [[ 1.97042748e+01  0.00000000e+00]
 [-7.74168429e-03  1.77384271e-02]]
grads:  [0.00339591 1.50864523]
Stock Position:  0.0033959126516830748
Bond Position:  [5.5942859]


portfolio before change:  [5.94936602]
curr_Stock_Price:  104.35509644206387
curr_Factors:  [1.04355096e+02 3.60023719e-02]
mat_Sqrt:  [[ 1.98006397e+01  0.00000000e+00]
 [-7.58971641e-03  1.73902250e-02]]
grads:  [-0.00723249  5.51724072]
Stock Position:  -0.007232490359838583
Bond Position:  [6.70411325]


portfolio before change:  [5.94528835]
curr_Stock_Price:  105.03477146766984
curr_Factors:  [1.05034771e+02 3.45159979e-02]
mat_Sqrt:  [[ 1.95138657e+01  0.00000000e+00]
 [-7.43139264e-03  1.70274597e-02]]
grads:  [ 0.02609097 18.9503657 ]
Stock Position:  0.026090970837541548
Bond Position:  [3.20482919]


portfolio before change:  [5.9598364]
curr_Stock_Price:  105.57700588779588
curr_Factors:  [1.05577006e+02 3.36925043e-02]
mat_Sqrt:  [[ 1.93792064e+01  0.00000000e+00]
 [-7.34220722e-03  1.68231102e-02]]
grads:  [ 1.18965011e-03 -2.27740741e+01]
Stock Position:  0.001189650105706311
Bond Position:  [5.8342367]


portfolio before change:  [5.96092048]
curr_Stock_Price:  105.87520771734374
curr_Factors:  [1.05875208e+02 3.44905097e-02]
mat_Sqrt:  [[ 1.96627420e+01  0.00000000e+00]
 [-7.42864830e-03  1.70211716e-02]]
grads:  [ 0.0294635  -1.67133995]
Stock Position:  0.02946350472604676
Bond Position:  [2.8414658]


portfolio before change:  [5.99201617]
curr_Stock_Price:  106.91854873855172
curr_Factors:  [1.06918549e+02 3.45295358e-02]
mat_Sqrt:  [[ 1.98677380e+01  0.00000000e+00]
 [-7.43284987e-03  1.70307986e-02]]
grads:  [ -0.02739177 -15.61439322]
Stock Position:  -0.027391766818724492
Bond Position:  [8.92070412]


portfolio before change:  [5.98845291]
curr_Stock_Price:  107.08934503762691
curr_Factors:  [1.07089345e+02 3.58409120e-02]
mat_Sqrt:  [[ 2.02738294e+01  0.00000000e+00]
 [-7.57267847e-03  1.73511861e-02]]
grads:  [ 2.20697228e-02 -3.68218390e+01]
Stock Position:  0.022069722763624504
Bond Position:  [3.62502076]


portfolio before change:  [5.98295473]
curr_Stock_Price:  106.81968403188674
curr_Factors:  [1.06819684e+02 3.63147829e-02]
mat_Sqrt:  [[ 2.03560269e+01  0.00000000e+00]
 [-7.62257520e-03  1.74655139e-02]]
grads:  [ 0.00253698 -0.96443586]
Stock Position:  0.0025369759153842392
Bond Position:  [5.71195576]


portfolio before change:  [5.98490355]
curr_Stock_Price:  107.30639818277312
curr_Factors:  [1.07306398e+02 3.68486752e-02]
mat_Sqrt:  [[ 2.05985456e+01  0.00000000e+00]
 [-7.67840350e-03  1.75934326e-02]]
grads:  [ -0.03645586 -15.32266866]
Stock Position:  -0.03645586385322578
Bond Position:  [9.89685099]


portfolio before change:  [5.97994947]
curr_Stock_Price:  107.47622700490564
curr_Factors:  [1.07476227e+02 3.65922982e-02]
mat_Sqrt:  [[ 2.05592494e+01  0.00000000e+00]
 [-7.65164539e-03  1.75321221e-02]]
grads:  [-3.89061741e-03  7.36457289e+00]
Stock Position:  -0.0038906174124101857
Bond Position:  [6.39809835]


portfolio before change:  [5.98546791]
curr_Stock_Price:  106.26340484214965
curr_Factors:  [1.06263405e+02 3.82154493e-02]
mat_Sqrt:  [[ 2.07731909e+01  0.00000000e+00]
 [-7.81950887e-03  1.79167456e-02]]
grads:  [-6.87682831e-02 -7.08127054e+01]
Stock Position:  -0.06876828314915828
Bond Position:  [13.29301983]


portfolio before change:  [5.83111025]
curr_Stock_Price:  108.53217448494755
curr_Factors:  [1.08532174e+02 3.66421688e-02]
mat_Sqrt:  [[ 2.07753854e+01  0.00000000e+00]
 [-7.65685771e-03  1.75440650e-02]]
grads:  [-2.62903963e-02 -4.91317359e+01]
Stock Position:  -0.026290396343029213
Bond Position:  [8.68446413]


portfolio before change:  [5.85214129]
curr_Stock_Price:  107.77351672579321
curr_Factors:  [1.07773517e+02 3.62737751e-02]
mat_Sqrt:  [[ 2.05261941e+01  0.00000000e+00]
 [-7.61827015e-03  1.74556498e-02]]
grads:  [-9.74777168e-03 -1.48897926e+01]
Stock Position:  -0.0097477716793766
Bond Position:  [6.90269292]


portfolio before change:  [5.85413792]
curr_Stock_Price:  107.6572095568902
curr_Factors:  [1.07657210e+02 3.66817681e-02]
mat_Sqrt:  [[ 2.06190309e+01  0.00000000e+00]
 [-7.66099400e-03  1.75535424e-02]]
grads:  [-5.52201183e-04  5.00357675e+00]
Stock Position:  -0.000552201182649239
Bond Position:  [5.91358635]


portfolio before change:  [5.85415429]
curr_Stock_Price:  108.96628844518962
curr_Factors:  [1.08966288e+02 3.63354688e-02]
mat_Sqrt:  [[ 2.07710065e+01  0.00000000e+00]
 [-7.62474590e-03  1.74704876e-02]]
grads:  [0.01013968 8.99703851]
Stock Position:  0.010139679850471933
Bond Position:  [4.74927101]


portfolio before change:  [5.86563451]
curr_Stock_Price:  110.03994475143335
curr_Factors:  [1.10039945e+02 3.62177725e-02]
mat_Sqrt:  [[ 2.09416662e+01  0.00000000e+00]
 [-7.61238701e-03  1.74421699e-02]]
grads:  [ -0.02384821 -16.96422166]
Stock Position:  -0.023848212668657158
Bond Position:  [8.48989052]


portfolio before change:  [5.88003456]
curr_Stock_Price:  109.48062623392953
curr_Factors:  [1.09480626e+02 3.70553864e-02]
mat_Sqrt:  [[ 2.10747750e+01  0.00000000e+00]
 [-7.69991028e-03  1.76427108e-02]]
grads:  [-0.00486475 -1.81603506]
Stock Position:  -0.004864750676528145
Bond Position:  [6.41263051]


portfolio before change:  [5.87350616]
curr_Stock_Price:  110.98739019645458
curr_Factors:  [1.10987390e+02 3.62955126e-02]
mat_Sqrt:  [[ 2.11446308e+01  0.00000000e+00]
 [-7.62055249e-03  1.74608793e-02]]
grads:  [1.26046091e-02 2.83594818e+01]
Stock Position:  0.012604609052866698
Bond Position:  [4.4745535]


portfolio before change:  [5.88000135]
curr_Stock_Price:  111.45831617317525
curr_Factors:  [1.11458316e+02 3.63597781e-02]
mat_Sqrt:  [[ 2.12531393e+01  0.00000000e+00]
 [-7.62729604e-03  1.74763307e-02]]
grads:  [7.75520414e-03 1.63861483e+01]
Stock Position:  0.007755204139428303
Bond Position:  [5.01561936]


portfolio before change:  [5.87130506]
curr_Stock_Price:  110.25611913504034
curr_Factors:  [1.10256119e+02 3.85840393e-02]
mat_Sqrt:  [[ 2.16574114e+01  0.00000000e+00]
 [-7.85712815e-03  1.80029423e-02]]
grads:  [-7.46099256e-03 -2.01893222e+01]
Stock Position:  -0.007460992556284703
Bond Position:  [6.69392515]


portfolio before change:  [5.87547018]
curr_Stock_Price:  109.81002273249258
curr_Factors:  [1.09810023e+02 3.87282782e-02]
mat_Sqrt:  [[ 2.16100651e+01  0.00000000e+00]
 [-7.87180062e-03  1.80365611e-02]]
grads:  [ 0.01384891 12.4954698 ]
Stock Position:  0.013848912592350292
Bond Position:  [4.35472077]


portfolio before change:  [5.85955646]
curr_Stock_Price:  108.62161942462377
curr_Factors:  [1.08621619e+02 3.88471922e-02]
mat_Sqrt:  [[ 2.14089856e+01  0.00000000e+00]
 [-7.88387642e-03  1.80642302e-02]]
grads:  [9.22603135e-03 1.17715503e+01]
Stock Position:  0.00922603135159983
Bond Position:  [4.85740999]


portfolio before change:  [5.86106888]
curr_Stock_Price:  108.71973441460209
curr_Factors:  [1.08719734e+02 3.90103260e-02]
mat_Sqrt:  [[ 2.14732694e+01  0.00000000e+00]
 [-7.90041275e-03  1.81021197e-02]]
grads:  [ 2.11647403e-02 -4.97215055e+01]
Stock Position:  0.021164740278353494
Bond Position:  [3.56004394]


portfolio before change:  [5.85912722]
curr_Stock_Price:  108.60696670997943
curr_Factors:  [1.08606967e+02 3.91251308e-02]
mat_Sqrt:  [[ 2.14825379e+01  0.00000000e+00]
 [-7.91202941e-03  1.81287368e-02]]
grads:  [-1.84434044e-02  5.52399842e+01]
Stock Position:  -0.018443404375089158
Bond Position:  [7.86220942]


portfolio before change:  [5.8916849]
curr_Stock_Price:  106.89498107317331
curr_Factors:  [1.06894981e+02 3.90268458e-02]
mat_Sqrt:  [[ 2.11173317e+01  0.00000000e+00]
 [-7.90208537e-03  1.81059522e-02]]
grads:  [ 0.00495636 -0.69004953]
Stock Position:  0.004956359352073006
Bond Position:  [5.36187496]


portfolio before change:  [5.89471162]
curr_Stock_Price:  107.37042040813795
curr_Factors:  [1.0737042e+02 3.8041950e-02]
mat_Sqrt:  [[ 2.09418979e+01  0.00000000e+00]
 [-7.80173827e-03  1.78760281e-02]]
grads:  [-0.00370222 -3.17187157]
Stock Position:  -0.003702223884215207
Bond Position:  [6.29222096]


portfolio before change:  [5.888351]
curr_Stock_Price:  109.30093547144605
curr_Factors:  [1.09300935e+02 3.76727870e-02]
mat_Sqrt:  [[ 2.12147420e+01  0.00000000e+00]
 [-7.76379155e-03  1.77890812e-02]]
grads:  [ 3.37070597e-03 -6.32201742e+00]
Stock Position:  0.003370705969438284
Bond Position:  [5.51992968]


portfolio before change:  [5.88921205]
curr_Stock_Price:  109.35167178478515
curr_Factors:  [1.09351672e+02 3.70000628e-02]
mat_Sqrt:  [[ 2.10342319e+01  0.00000000e+00]
 [-7.69416016e-03  1.76295357e-02]]
grads:  [-1.15120777e-03 -5.42574823e+00]
Stock Position:  -0.0011512077702838586
Bond Position:  [6.01509855]


portfolio before change:  [5.88938684]
curr_Stock_Price:  109.85301308457791
curr_Factors:  [1.09853013e+02 3.70527073e-02]
mat_Sqrt:  [[ 2.11456942e+01  0.00000000e+00]
 [-7.69963192e-03  1.76420731e-02]]
grads:  [ 0.013653   -1.63509548]
Stock Position:  0.013652995434754062
Bond Position:  [4.38956415]


portfolio before change:  [5.91101217]
curr_Stock_Price:  111.39674805577134
curr_Factors:  [1.11396748e+02 3.62909972e-02]
mat_Sqrt:  [[ 2.12212990e+01  0.00000000e+00]
 [-7.62007844e-03  1.74597931e-02]]
grads:  [2.79488139e-02 2.90298459e+01]
Stock Position:  0.027948813926807627
Bond Position:  [2.79760519]


portfolio before change:  [5.91957709]
curr_Stock_Price:  111.69068522645536
curr_Factors:  [1.11690685e+02 3.59786730e-02]
mat_Sqrt:  [[ 2.11855394e+01  0.00000000e+00]
 [-7.58721799e-03  1.73845004e-02]]
grads:  [ 0.01361295 -0.29923897]
Stock Position:  0.013612946179611394
Bond Position:  [4.39913781]


portfolio before change:  [5.92775063]
curr_Stock_Price:  112.25071212034581
curr_Factors:  [1.12250712e+02 3.54529132e-02]
mat_Sqrt:  [[ 2.11356237e+01  0.00000000e+00]
 [-7.53157760e-03  1.72570122e-02]]
grads:  [-1.11684655e-02 -1.69772750e+01]
Stock Position:  -0.011168465468501169
Bond Position:  [7.18141884]


portfolio before change:  [5.92451686]
curr_Stock_Price:  112.62063853611791
curr_Factors:  [1.12620639e+02 3.50894076e-02]
mat_Sqrt:  [[ 2.10962860e+01  0.00000000e+00]
 [-7.49286676e-03  1.71683145e-02]]
grads:  [ 0.00738877 -4.05843471]
Stock Position:  0.007388772006413553
Bond Position:  [5.09238864]


portfolio before change:  [5.92759771]
curr_Stock_Price:  112.9514458929721
curr_Factors:  [1.12951446e+02 3.33079027e-02]
mat_Sqrt:  [[ 2.06141503e+01  0.00000000e+00]
 [-7.30018112e-03  1.67268163e-02]]
grads:  [-0.01594427  4.16622605]
Stock Position:  -0.01594427359930354
Bond Position:  [7.72852646]


portfolio before change:  [5.93055327]
curr_Stock_Price:  112.82667131349666
curr_Factors:  [1.12826671e+02 3.26675569e-02]
mat_Sqrt:  [[ 2.03924827e+01  0.00000000e+00]
 [-7.22966742e-03  1.65652491e-02]]
grads:  [-2.65092027e-03  7.66846704e+00]
Stock Position:  -0.002650920274868227
Bond Position:  [6.22964778]


portfolio before change:  [5.92864023]
curr_Stock_Price:  113.8420894598479
curr_Factors:  [1.13842089e+02 3.27933507e-02]
mat_Sqrt:  [[ 2.06155894e+01  0.00000000e+00]
 [-7.24357378e-03  1.65971126e-02]]
grads:  [-0.01365408 10.83856622]
Stock Position:  -0.013654081280851509
Bond Position:  [7.48304938]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.93351363]
Stock Price:  113.55368097423214
PL:  [-7.62016735]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-4.16891886e-02  2.08965453e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.58157827e-01 -7.86772030e-01]
 [-3.52073550e-02  4.37495476e-02]
 [-2.21731905e-02  1.22338645e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-3.72105332e-02  2.11470694e-01]
 [-1.18825145e-01 -9.69054991e-02]
 [ 1.62157473e-01  7.86792342e-02]
 [ 1.55617242e-01  1.23151658e-02]
 [ 9.18632722e-02  9.83189519e-02]
 [-1.06683744e-01 -2.17591149e-02]
 [ 1.73995028e-01  2.97726384e-02]
 [-2.50101236e-01 -3.39587448e-01]
 [ 8.32998600e-02  2.27939406e-01]
 [ 5.23325374e-02 -1.93418435e-02]
 [ 7.58236519e-03 -5.29379589e-02]
 [ 1.04501068e-02  5.19491731e-02]
 [ 1.14209019e-02  4.62734958e-02]
 [ 2.02859277e-01 -1.06448245e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 5.52325254e-02  2.51211850e-01]
 [ 3.55532114e-02  2.55903885e-01]
 [-7.39376119e-02  1.13839120e-01]
 [ 2.16371712e-02  5.42855487e-02]
 [ 4.09895862e-01 -6.85993452e-02]
 [-2.41916328e-02  1.78495857e-01]
 [-1.90005991e-01  1.39269016e-01]
 [-6.23144806e-02 -1.05558952e-01]
 [ 1.50124910e-01 -8.14111496e-02]
 [-1.06160915e+00 -1.19114572e-01]
 [-1.24204990e-01  6.60451421e-02]
 [-9.68623101e-03 -9.02957013e-02]
 [ 5.57891924e-02  9.90665410e-02]
 [-7.86244664e-02  1.55167873e-01]
 [-5.06734052e-01 -3.15325580e-01]
 [-4.32153828e-02  3.07377239e-01]
 [-1.26243929e-01  1.15885799e-01]
 [ 4.48357411e-01  4.91911489e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.7145129]
curr_Stock_Price:  99.69977941495154
curr_Factors:  [9.96997794e+01 4.10703048e-02]
mat_Sqrt:  [[ 2.02049677e+01  0.00000000e+00]
 [-8.10632393e-03  1.85739215e-02]]
grads:  [2.45042766e-03 1.12504757e+01]
Stock Position:  0.002450427662302016
Bond Position:  [0.47020581]


portfolio before change:  [0.71086832]
curr_Stock_Price:  98.18846445354951
curr_Factors:  [9.81884645e+01 3.98418477e-02]
mat_Sqrt:  [[ 1.95988326e+01  0.00000000e+00]
 [-7.98416911e-03  1.82940296e-02]]
grads:  [-0.01035697 -4.81093405]
Stock Position:  -0.010356966253061001
Bond Position:  [1.72780293]


portfolio before change:  [0.71111616]
curr_Stock_Price:  98.18538896364355
curr_Factors:  [9.81853890e+01 4.04788729e-02]
mat_Sqrt:  [[ 1.97542739e+01  0.00000000e+00]
 [-8.04774482e-03  1.84396999e-02]]
grads:  [ 2.60592905e-02 -4.26672904e+01]
Stock Position:  0.026059290545457293
Bond Position:  [-1.84752542]


portfolio before change:  [0.75063771]
curr_Stock_Price:  99.71085279246415
curr_Factors:  [9.97108528e+01 4.00734638e-02]
mat_Sqrt:  [[ 1.99604750e+01  0.00000000e+00]
 [-8.00734301e-03  1.83471277e-02]]
grads:  [-8.07269719e-04  2.38454478e+00]
Stock Position:  -0.0008072697192879128
Bond Position:  [0.83113126]


portfolio before change:  [0.7504513]
curr_Stock_Price:  100.0704683917535
curr_Factors:  [1.00070468e+02 3.93080944e-02]
mat_Sqrt:  [[ 1.98402403e+01  0.00000000e+00]
 [-7.93050761e-03  1.81710757e-02]]
grads:  [-0.00084847  0.67326034]
Stock Position:  -0.0008484722967571028
Bond Position:  [0.83535832]


portfolio before change:  [0.75087216]
curr_Stock_Price:  99.6975202252027
curr_Factors:  [9.96975202e+01 3.81050027e-02]
mat_Sqrt:  [[ 1.94614572e+01  0.00000000e+00]
 [-7.80820110e-03  1.78908363e-02]]
grads:  [-0.00608489 -3.70675395]
Stock Position:  -0.006084887203352242
Bond Position:  [1.35752033]


portfolio before change:  [0.75421076]
curr_Stock_Price:  99.17673817900322
curr_Factors:  [9.91767382e+01 3.86699126e-02]
mat_Sqrt:  [[ 1.95027753e+01  0.00000000e+00]
 [-7.86586678e-03  1.80229650e-02]]
grads:  [2.82435927e-03 1.17334020e+01]
Stock Position:  0.002824359273028047
Bond Position:  [0.47410002]


portfolio before change:  [0.75158274]
curr_Stock_Price:  98.22527024487742
curr_Factors:  [9.82252702e+01 3.97263371e-02]
mat_Sqrt:  [[ 1.95777372e+01  0.00000000e+00]
 [-7.97258674e-03  1.82674911e-02]]
grads:  [-0.00822966 -5.30480614]
Stock Position:  -0.008229662654593921
Bond Position:  [1.55994358]


portfolio before change:  [0.74453056]
curr_Stock_Price:  99.10588794968878
curr_Factors:  [9.91058879e+01 4.01461569e-02]
mat_Sqrt:  [[ 1.98573571e+01  0.00000000e+00]
 [-8.01460236e-03  1.83637610e-02]]
grads:  [0.00989537 4.28448368]
Stock Position:  0.009895370525837957
Bond Position:  [-0.23615892]


portfolio before change:  [0.73796486]
curr_Stock_Price:  98.44535893192594
curr_Factors:  [9.84453589e+01 4.10668315e-02]
mat_Sqrt:  [[ 1.99499056e+01  0.00000000e+00]
 [-8.10598114e-03  1.85731361e-02]]
grads:  [0.00806981 0.66306335]
Stock Position:  0.008069813663958213
Bond Position:  [-0.05647084]


portfolio before change:  [0.74934032]
curr_Stock_Price:  99.85586444469331
curr_Factors:  [9.98558644e+01 4.00588415e-02]
mat_Sqrt:  [[ 1.99858567e+01  0.00000000e+00]
 [-8.00588198e-03  1.83437801e-02]]
grads:  [0.00674343 5.35979779]
Stock Position:  0.0067434277698276025
Bond Position:  [0.07596951]


portfolio before change:  [0.75198171]
curr_Stock_Price:  100.24615514157026
curr_Factors:  [1.00246155e+02 4.04627625e-02]
mat_Sqrt:  [[ 2.01648729e+01  0.00000000e+00]
 [-8.04614317e-03  1.84360301e-02]]
grads:  [-0.00576151 -1.18024948]
Stock Position:  -0.005761514118730104
Bond Position:  [1.32955135]


portfolio before change:  [0.76612824]
curr_Stock_Price:  97.81965215482792
curr_Factors:  [9.78196522e+01 3.93046407e-02]
mat_Sqrt:  [[ 1.93931354e+01  0.00000000e+00]
 [-7.93015921e-03  1.81702774e-02]]
grads:  [0.00964201 1.63853516]
Stock Position:  0.009642013472406542
Bond Position:  [-0.17705016]


portfolio before change:  [0.7730836]
curr_Stock_Price:  98.54330662861943
curr_Factors:  [9.85433066e+01 3.91320209e-02]
mat_Sqrt:  [[ 1.94936547e+01  0.00000000e+00]
 [-7.91272604e-03  1.81303330e-02]]
grads:  [ -0.02043277 -18.73034804]
Stock Position:  -0.02043276927326696
Bond Position:  [2.78659625]


portfolio before change:  [0.76484378]
curr_Stock_Price:  98.96362012999188
curr_Factors:  [9.89636201e+01 3.79920941e-02]
mat_Sqrt:  [[ 1.92895542e+01  0.00000000e+00]
 [-7.79662431e-03  1.78643105e-02]]
grads:  [9.47563490e-03 1.27594852e+01]
Stock Position:  0.009475634897429173
Bond Position:  [-0.17289936]


portfolio before change:  [0.7638313]
curr_Stock_Price:  98.8590501916773
curr_Factors:  [9.88590502e+01 3.76766532e-02]
mat_Sqrt:  [[ 1.91890110e+01  0.00000000e+00]
 [-7.76418992e-03  1.77899940e-02]]
grads:  [ 0.0022873  -1.08723159]
Stock Position:  0.002287302081811106
Bond Position:  [0.53771078]


portfolio before change:  [0.76153172]
curr_Stock_Price:  97.82429627813084
curr_Factors:  [9.78242963e+01 3.88353658e-02]
mat_Sqrt:  [[ 1.92779315e+01  0.00000000e+00]
 [-7.88267628e-03  1.80614804e-02]]
grads:  [-8.05151435e-04 -2.93098671e+00]
Stock Position:  -0.0008051514352435314
Bond Position:  [0.84029509]


portfolio before change:  [0.76147279]
curr_Stock_Price:  98.02794785913585
curr_Factors:  [9.80279479e+01 3.95785241e-02]
mat_Sqrt:  [[ 1.95020250e+01  0.00000000e+00]
 [-7.95774079e-03  1.82334748e-02]]
grads:  [1.69841772e-03 2.84910988e+00]
Stock Position:  0.001698417715019796
Bond Position:  [0.59498039]


portfolio before change:  [0.75936251]
curr_Stock_Price:  96.74165990978487
curr_Factors:  [9.67416599e+01 3.98071544e-02]
mat_Sqrt:  [[ 1.93016351e+01  0.00000000e+00]
 [-7.98069214e-03  1.82860629e-02]]
grads:  [1.63801206e-03 2.53053356e+00]
Stock Position:  0.0016380120606706646
Bond Position:  [0.60089851]


portfolio before change:  [0.75920649]
curr_Stock_Price:  96.60054956448651
curr_Factors:  [9.66005496e+01 4.00343580e-02]
mat_Sqrt:  [[ 1.93284056e+01  0.00000000e+00]
 [-8.00343506e-03  1.83381735e-02]]
grads:  [ 0.00809179 -5.80473541]
Stock Position:  0.008091792829560643
Bond Position:  [-0.02246514]


portfolio before change:  [0.76648589]
curr_Stock_Price:  97.50049900543696
curr_Factors:  [9.75004990e+01 3.86195377e-02]
mat_Sqrt:  [[ 1.91606560e+01  0.00000000e+00]
 [-7.86074172e-03  1.80112220e-02]]
grads:  [ 0.0021987  -2.09746955]
Stock Position:  0.002198703980044977
Bond Position:  [0.55211115]


portfolio before change:  [0.76703665]
curr_Stock_Price:  97.71960082930109
curr_Factors:  [9.77196008e+01 3.81687251e-02]
mat_Sqrt:  [[ 1.90913004e+01  0.00000000e+00]
 [-7.81472713e-03  1.79057893e-02]]
grads:  [8.63588974e-03 1.40296440e+01]
Stock Position:  0.00863588973617605
Bond Position:  [-0.07685905]


portfolio before change:  [0.7708792]
curr_Stock_Price:  98.16566559573373
curr_Factors:  [9.81656656e+01 3.67225769e-02]
mat_Sqrt:  [[ 1.88116197e+01  0.00000000e+00]
 [-7.66525427e-03  1.75633039e-02]]
grads:  [7.82701467e-03 1.45703727e+01]
Stock Position:  0.007827014672980838
Bond Position:  [0.0025351]


portfolio before change:  [0.76907213]
curr_Stock_Price:  97.93474922276606
curr_Factors:  [9.79347492e+01 3.62803519e-02]
mat_Sqrt:  [[ 1.86540253e+01  0.00000000e+00]
 [-7.61896076e-03  1.74572322e-02]]
grads:  [-1.30020980e-03  6.52102917e+00]
Stock Position:  -0.0013002098026265385
Bond Position:  [0.89640786]


portfolio before change:  [0.76812921]
curr_Stock_Price:  98.74614500525935
curr_Factors:  [9.8746145e+01 3.5529969e-02]
mat_Sqrt:  [[ 1.86130509e+01  0.00000000e+00]
 [-7.53975798e-03  1.72757558e-02]]
grads:  [2.43535181e-03 3.14229660e+00]
Stock Position:  0.0024353518052083432
Bond Position:  [0.52764761]


portfolio before change:  [0.76793216]
curr_Stock_Price:  98.63814810746602
curr_Factors:  [9.86381481e+01 3.52297150e-02]
mat_Sqrt:  [[ 1.85139666e+01  0.00000000e+00]
 [-7.50783218e-03  1.72026046e-02]]
grads:  [ 0.0205227  -3.98773015]
Stock Position:  0.020522703860497548
Bond Position:  [-1.25638935]


portfolio before change:  [0.77247598]
curr_Stock_Price:  98.86720557258612
curr_Factors:  [9.88672056e+01 3.37920697e-02]
mat_Sqrt:  [[ 1.81743821e+01  0.00000000e+00]
 [-7.35304777e-03  1.68479490e-02]]
grads:  [2.95527767e-03 1.05945155e+01]
Stock Position:  0.0029552776695768238
Bond Position:  [0.48029593]


portfolio before change:  [0.77438638]
curr_Stock_Price:  99.49332811294596
curr_Factors:  [9.94933281e+01 3.32882599e-02]
mat_Sqrt:  [[ 1.81526279e+01  0.00000000e+00]
 [-7.29802822e-03  1.67218834e-02]]
grads:  [-7.11874941e-03  8.32854847e+00]
Stock Position:  -0.007118749405754177
Bond Position:  [1.48265445]


portfolio before change:  [0.78169978]
curr_Stock_Price:  98.49202141961264
curr_Factors:  [9.84920214e+01 3.16817870e-02]
mat_Sqrt:  [[ 1.75309676e+01  0.00000000e+00]
 [-7.11975135e-03  1.63133997e-02]]
grads:  [-6.18244166e-03 -6.47068996e+00]
Stock Position:  -0.006182441661729604
Bond Position:  [1.39062096]


portfolio before change:  [0.79638147]
curr_Stock_Price:  96.14539895896857
curr_Factors:  [9.61453990e+01 3.22168163e-02]
mat_Sqrt:  [[ 1.72571795e+01  0.00000000e+00]
 [-7.17961740e-03  1.64505701e-02]]
grads:  [ 0.00664038 -4.94883454]
Stock Position:  0.0066403766086645406
Bond Position:  [0.15793982]


portfolio before change:  [0.79550774]
curr_Stock_Price:  96.01084628356676
curr_Factors:  [9.60108463e+01 3.16476822e-02]
mat_Sqrt:  [[ 1.70801332e+01  0.00000000e+00]
 [-7.11591818e-03  1.63046168e-02]]
grads:  [-0.06519826 -7.3055732 ]
Stock Position:  -0.06519826272520468
Bond Position:  [7.05524812]


portfolio before change:  [0.75573765]
curr_Stock_Price:  96.63436063808578
curr_Factors:  [9.66343606e+01 3.01123163e-02]
mat_Sqrt:  [[ 1.67688647e+01  0.00000000e+00]
 [-6.94116029e-03  1.59041962e-02]]
grads:  [-0.00568795  4.15268658]
Stock Position:  -0.00568795378017024
Bond Position:  [1.30538942]


portfolio before change:  [0.75072911]
curr_Stock_Price:  97.54360195501037
curr_Factors:  [9.75436020e+01 2.83717149e-02]
mat_Sqrt:  [[ 1.64301520e+01  0.00000000e+00]
 [-6.73756216e-03  1.54376943e-02]]
grads:  [-2.98807374e-03 -5.84904064e+00]
Stock Position:  -0.0029880737427765694
Bond Position:  [1.04219658]


portfolio before change:  [0.75246554]
curr_Stock_Price:  97.00608283313437
curr_Factors:  [9.70060828e+01 2.82869834e-02]
mat_Sqrt:  [[ 1.63151956e+01  0.00000000e+00]
 [-6.72749385e-03  1.54146249e-02]]
grads:  [6.06951812e-03 6.42678895e+00]
Stock Position:  0.006069518119997925
Bond Position:  [0.16368536]


portfolio before change:  [0.75402168]
curr_Stock_Price:  97.25909888671265
curr_Factors:  [9.72590989e+01 2.71441459e-02]
mat_Sqrt:  [[ 1.60239039e+01  0.00000000e+00]
 [-6.59019221e-03  1.51000273e-02]]
grads:  [-6.80461826e-04  1.02759995e+01]
Stock Position:  -0.0006804618256613896
Bond Position:  [0.82020279]


portfolio before change:  [0.75292263]
curr_Stock_Price:  99.02493534062508
curr_Factors:  [9.90249353e+01 2.64173942e-02]
mat_Sqrt:  [[ 1.60949472e+01  0.00000000e+00]
 [-6.50137145e-03  1.48965134e-02]]
grads:  [ -0.04003452 -21.16774388]
Stock Position:  -0.04003451579852924
Bond Position:  [4.71733797]


portfolio before change:  [0.74872775]
curr_Stock_Price:  99.14444687378592
curr_Factors:  [9.91444469e+01 2.57559777e-02]
mat_Sqrt:  [[ 1.59113641e+01  0.00000000e+00]
 [-6.41946760e-03  1.47088481e-02]]
grads:  [5.71510035e-03 2.08974379e+01]
Stock Position:  0.005715100345863936
Bond Position:  [0.18210729]


portfolio before change:  [0.74973751]
curr_Stock_Price:  99.31714672550507
curr_Factors:  [9.93171467e+01 2.51351389e-02]
mat_Sqrt:  [[ 1.57458054e+01  0.00000000e+00]
 [-6.34162615e-03  1.45304909e-02]]
grads:  [-4.80554773e-03  7.97535332e+00]
Stock Position:  -0.004805547731602758
Bond Position:  [1.2270108]


portfolio before change:  [0.74873826]
curr_Stock_Price:  99.55700257224842
curr_Factors:  [9.95570026e+01 2.45259067e-02]
mat_Sqrt:  [[ 1.55913725e+01  0.00000000e+00]
 [-6.26429970e-03  1.43533138e-02]]
grads:  [0.03013373 3.42716322]
Stock Position:  0.03013372860587698
Bond Position:  [-2.25128544]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.71929239]
Stock Price:  98.58916886912367
PL:  [0.71929239]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.02908683e-01  1.33231619e-01]
 [-1.64814223e-01 -8.66590734e-02]
 [ 8.41523032e-01 -7.49233989e-01]
 [-1.72821431e-02  2.14936775e-01]
 [ 3.39671651e-02 -5.34143860e-02]
 [-8.24199685e-02 -9.51139926e-02]
 [-5.37869277e-02  1.88971540e-01]
 [ 1.11759495e-01 -3.40748522e-02]
 [ 1.44282298e-01  7.70484198e-02]
 [ 3.29162659e-01 -1.57957021e-01]
 [ 7.53350384e-02  3.99304053e-02]
 [-1.01388891e-01 -8.30603620e-03]
 [ 1.99755498e-01  2.53605737e-02]
 [-2.66793517e-01 -3.63587634e-01]
 [ 8.99114921e-02  2.33212818e-01]
 [ 4.74383960e-02  3.66315043e-02]
 [ 2.07391377e-02 -5.30484434e-02]
 [-8.66702904e-03  4.87724984e-02]
 [ 1.50377020e-02  6.24176417e-02]
 [-7.47613300e-02 -4.27780957e-02]
 [ 1.63848970e-01  7.07670652e-02]
 [ 9.01166436e-02  3.08713943e-01]
 [ 4.02255970e-02  3.69093615e-01]
 [-4.60607134e-02  1.33156517e-01]
 [ 2.68801773e-02  6.75881604e-02]
 [ 4.29977328e-01 -8.05609416e-02]
 [-6.22260130e-03  1.25641303e-01]
 [-2.07364184e-01  1.47042455e-01]
 [-2.04898609e-02 -1.26855412e-01]
 [ 6.59827048e-02 -6.17448834e-02]
 [-7.40187595e-01 -9.29623017e-02]
 [-1.18195504e-01  1.00993813e-02]
 [ 3.73739108e-02 -6.48314575e-02]
 [ 1.16751187e-01  8.40248811e-02]
 [-1.68436510e-01  6.87219321e-02]
 [-2.96529778e-01 -3.77263679e-01]
 [-7.56612936e-02  2.91575595e-01]
 [-1.21687723e-01  1.18959508e-01]
 [-9.59172967e-02  1.24047830e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.74099747]
curr_Stock_Price:  99.4805559948566
curr_Factors:  [9.94805560e+01 4.14335444e-02]
mat_Sqrt:  [[ 2.02494973e+01  0.00000000e+00]
 [-8.14209255e-03  1.86558777e-02]]
grads:  [-2.21050612e-03  7.14153583e+00]
Stock Position:  -0.0022105061193159093
Bond Position:  [-0.52109509]


portfolio before change:  [-0.74055718]
curr_Stock_Price:  99.25190901893956
curr_Factors:  [9.92519090e+01 4.19100579e-02]
mat_Sqrt:  [[ 2.03187974e+01  0.00000000e+00]
 [-8.18877845e-03  1.87628486e-02]]
grads:  [-0.0099728  -4.61865229]
Stock Position:  -0.009972802036708106
Bond Position:  [0.24926246]


portfolio before change:  [-0.73551508]
curr_Stock_Price:  98.74944782927288
curr_Factors:  [9.87494478e+01 4.18880190e-02]
mat_Sqrt:  [[ 2.02106177e+01  0.00000000e+00]
 [-8.18662509e-03  1.87579146e-02]]
grads:  [ 2.54584258e-02 -3.99422860e+01]
Stock Position:  0.02545842583035378
Bond Position:  [-3.24952057]


portfolio before change:  [-0.77543323]
curr_Stock_Price:  97.19742979388069
curr_Factors:  [9.71974298e+01 4.19135811e-02]
mat_Sqrt:  [[ 1.98990418e+01  0.00000000e+00]
 [-8.18912265e-03  1.87636372e-02]]
grads:  [3.84561008e-03 1.14549632e+01]
Stock Position:  0.0038456100780920716
Bond Position:  [-1.14921664]


portfolio before change:  [-0.77248583]
curr_Stock_Price:  98.00121999520306
curr_Factors:  [9.8001220e+01 3.9494212e-02]
mat_Sqrt:  [[ 1.94759302e+01  0.00000000e+00]
 [-7.94926029e-03  1.82140435e-02]]
grads:  [ 5.47096635e-04 -2.93259352e+00]
Stock Position:  0.0005470966352674071
Bond Position:  [-0.82610196]


portfolio before change:  [-0.77231768]
curr_Stock_Price:  98.49732795648384
curr_Factors:  [9.84973280e+01 3.99884875e-02]
mat_Sqrt:  [[ 1.96966305e+01  0.00000000e+00]
 [-7.99884867e-03  1.83276647e-02]]
grads:  [-0.006292   -5.18964057]
Stock Position:  -0.006291995880842116
Bond Position:  [-0.15257289]


portfolio before change:  [-0.77352678]
curr_Stock_Price:  98.68646266505583
curr_Factors:  [9.86864627e+01 3.96514987e-02]
mat_Sqrt:  [[ 1.96511235e+01  0.00000000e+00]
 [-7.96507363e-03  1.82502764e-02]]
grads:  [1.45981546e-03 1.03544481e+01]
Stock Position:  0.0014598154638560197
Bond Position:  [-0.91759081]


portfolio before change:  [-0.77169508]
curr_Stock_Price:  100.01978623016551
curr_Factors:  [1.00019786e+02 3.79173110e-02]
mat_Sqrt:  [[ 1.94762207e+01  0.00000000e+00]
 [-7.78894714e-03  1.78467199e-02]]
grads:  [ 0.00497468 -1.90930615]
Stock Position:  0.004974682321946641
Bond Position:  [-1.26926175]


portfolio before change:  [-0.769557]
curr_Stock_Price:  100.48147480346503
curr_Factors:  [1.00481475e+02 3.76641311e-02]
mat_Sqrt:  [[ 1.95006900e+01  0.00000000e+00]
 [-7.76289958e-03  1.77870375e-02]]
grads:  [0.00912321 4.33171741]
Stock Position:  0.009123214906379731
Bond Position:  [-1.68627109]


portfolio before change:  [-0.76101426]
curr_Stock_Price:  101.44095440719676
curr_Factors:  [1.01440954e+02 3.70950392e-02]
mat_Sqrt:  [[ 1.95376013e+01  0.00000000e+00]
 [-7.70402899e-03  1.76521480e-02]]
grads:  [ 0.01331917 -8.94831731]
Stock Position:  0.01331916637324627
Bond Position:  [-2.1121232]


portfolio before change:  [-0.77357938]
curr_Stock_Price:  100.51739100425348
curr_Factors:  [1.00517391e+02 3.77764827e-02]
mat_Sqrt:  [[ 1.95367342e+01  0.00000000e+00]
 [-7.77446926e-03  1.78135469e-02]]
grads:  [0.00474809 2.24157521]
Stock Position:  0.0047480861032809475
Bond Position:  [-1.25084461]


portfolio before change:  [-0.77561921]
curr_Stock_Price:  100.12071340542563
curr_Factors:  [1.00120713e+02 3.72863358e-02]
mat_Sqrt:  [[ 1.93329794e+01  0.00000000e+00]
 [-7.72386802e-03  1.76976049e-02]]
grads:  [-0.00543186 -0.46933109]
Stock Position:  -0.005431855093837483
Bond Position:  [-0.231778]


portfolio before change:  [-0.75887493]
curr_Stock_Price:  97.03277177225313
curr_Factors:  [9.70327718e+01 3.86609195e-02]
mat_Sqrt:  [[ 1.90789525e+01  0.00000000e+00]
 [-7.86495208e-03  1.80208691e-02]]
grads:  [0.01105007 1.40728916]
Stock Position:  0.011050069942793353
Bond Position:  [-1.83109384]


portfolio before change:  [-0.73980573]
curr_Stock_Price:  98.77919476509526
curr_Factors:  [9.87791948e+01 3.74707213e-02]
mat_Sqrt:  [[ 1.91210399e+01  0.00000000e+00]
 [-7.74294221e-03  1.77413094e-02]]
grads:  [ -0.02225173 -20.49384438]
Stock Position:  -0.022251727501193152
Bond Position:  [1.45820199]


portfolio before change:  [-0.70449913]
curr_Stock_Price:  97.20069620364369
curr_Factors:  [9.72006962e+01 3.72095901e-02]
mat_Sqrt:  [[ 1.87498077e+01  0.00000000e+00]
 [-7.71591499e-03  1.76793822e-02]]
grads:  [1.02237801e-02 1.31912312e+01]
Stock Position:  0.010223780059644172
Bond Position:  [-1.69825767]


portfolio before change:  [-0.70660756]
curr_Stock_Price:  97.01523247208165
curr_Factors:  [9.70152325e+01 3.78206386e-02]
mat_Sqrt:  [[ 1.88670655e+01  0.00000000e+00]
 [-7.77901162e-03  1.78239548e-02]]
grads:  [0.00336171 2.05518386]
Stock Position:  0.0033617148948042815
Bond Position:  [-1.03274512]


portfolio before change:  [-0.70561623]
curr_Stock_Price:  97.3485267145057
curr_Factors:  [9.73485267e+01 3.76248373e-02]
mat_Sqrt:  [[ 1.88828133e+01  0.00000000e+00]
 [-7.75884913e-03  1.77777567e-02]]
grads:  [-1.27793515e-04 -2.98397848e+00]
Stock Position:  -0.00012779351547635376
Bond Position:  [-0.69317571]


portfolio before change:  [-0.70584663]
curr_Stock_Price:  98.47340139747034
curr_Factors:  [9.84734014e+01 3.68184796e-02]
mat_Sqrt:  [[ 1.88952162e+01  0.00000000e+00]
 [-7.67525683e-03  1.75862227e-02]]
grads:  [6.67842816e-04 2.77333565e+00]
Stock Position:  0.0006678428163904117
Bond Position:  [-0.77161138]


portfolio before change:  [-0.70432693]
curr_Stock_Price:  100.89336417304021
curr_Factors:  [1.00893364e+02 3.64148581e-02]
mat_Sqrt:  [[ 1.92531553e+01  0.00000000e+00]
 [-7.63307100e-03  1.74895628e-02]]
grads:  [2.19595144e-03 3.56885088e+00]
Stock Position:  0.002195951442061727
Bond Position:  [-0.92588386]


portfolio before change:  [-0.70266458]
curr_Stock_Price:  101.70307913485235
curr_Factors:  [1.01703079e+02 3.60093076e-02]
mat_Sqrt:  [[ 1.92992969e+01  0.00000000e+00]
 [-7.59044743e-03  1.73919000e-02]]
grads:  [-0.00484117 -2.45965627]
Stock Position:  -0.004841172302609899
Bond Position:  [-0.21030245]


portfolio before change:  [-0.69968529]
curr_Stock_Price:  101.08224104335679
curr_Factors:  [1.01082241e+02 3.87540382e-02]
mat_Sqrt:  [[ 1.98990958e+01  0.00000000e+00]
 [-7.87441814e-03  1.80425586e-02]]
grads:  [0.00978609 3.92223003]
Stock Position:  0.00978608530406036
Bond Position:  [-1.68888472]


portfolio before change:  [-0.7177342]
curr_Stock_Price:  99.25946987123376
curr_Factors:  [9.92594699e+01 3.89002162e-02]
mat_Sqrt:  [[ 1.95770820e+01  0.00000000e+00]
 [-7.88925510e-03  1.80765543e-02]]
grads:  [1.14853917e-02 1.70781410e+01]
Stock Position:  0.011485391680639355
Bond Position:  [-1.85776809]


portfolio before change:  [-0.69160633]
curr_Stock_Price:  101.55456838335874
curr_Factors:  [1.01554568e+02 3.85454379e-02]
mat_Sqrt:  [[ 1.99382004e+01  0.00000000e+00]
 [-7.85319684e-03  1.79939345e-02]]
grads:  [1.00967616e-02 2.05121129e+01]
Stock Position:  0.010096761644416094
Bond Position:  [-1.7169786]


portfolio before change:  [-0.71479871]
curr_Stock_Price:  99.27881442523329
curr_Factors:  [9.92788144e+01 3.86146173e-02]
mat_Sqrt:  [[ 1.95088851e+01  0.00000000e+00]
 [-7.86024094e-03  1.80100746e-02]]
grads:  [6.17849515e-04 7.39344621e+00]
Stock Position:  0.0006178495151534234
Bond Position:  [-0.77613808]


portfolio before change:  [-0.71537801]
curr_Stock_Price:  98.49824975315818
curr_Factors:  [9.84982498e+01 3.84299063e-02]
mat_Sqrt:  [[ 1.93091509e+01  0.00000000e+00]
 [-7.84141888e-03  1.79669478e-02]]
grads:  [2.91975909e-03 3.76180536e+00]
Stock Position:  0.002919759094243955
Bond Position:  [-1.00296917]


portfolio before change:  [-0.7146936]
curr_Stock_Price:  98.77559622445675
curr_Factors:  [9.87755962e+01 3.87644823e-02]
mat_Sqrt:  [[ 1.94476287e+01  0.00000000e+00]
 [-7.87547914e-03  1.80449897e-02]]
grads:  [ 0.02030158 -4.46444931]
Stock Position:  0.020301583129397654
Bond Position:  [-2.71999458]


portfolio before change:  [-0.70375279]
curr_Stock_Price:  99.33125918666998
curr_Factors:  [9.93312592e+01 3.74372603e-02]
mat_Sqrt:  [[ 1.92193179e+01  0.00000000e+00]
 [-7.73948425e-03  1.77333862e-02]]
grads:  [2.52931759e-03 7.08501475e+00]
Stock Position:  0.002529317585166168
Bond Position:  [-0.95499309]


portfolio before change:  [-0.70386296]
curr_Stock_Price:  99.33489819075966
curr_Factors:  [9.93348982e+01 3.81871451e-02]
mat_Sqrt:  [[ 1.94115604e+01  0.00000000e+00]
 [-7.81661258e-03  1.79101094e-02]]
grads:  [-7.37651134e-03  8.21002548e+00]
Stock Position:  -0.007376511343354086
Bond Position:  [0.02888204]


portfolio before change:  [-0.70245011]
curr_Stock_Price:  99.14385375041012
curr_Factors:  [9.91438538e+01 4.05995118e-02]
mat_Sqrt:  [[ 1.99768129e+01  0.00000000e+00]
 [-8.05972821e-03  1.84671573e-02]]
grads:  [-3.79710729e-03 -6.86924416e+00]
Stock Position:  -0.0037971072935234474
Bond Position:  [-0.32599026]


portfolio before change:  [-0.69963259]
curr_Stock_Price:  98.39110482384233
curr_Factors:  [9.83911048e+01 4.02124593e-02]
mat_Sqrt:  [[ 1.97304120e+01  0.00000000e+00]
 [-8.02121779e-03  1.83789188e-02]]
grads:  [ 1.97841933e-03 -3.35954927e+00]
Stock Position:  0.001978419325052002
Bond Position:  [-0.89429146]


portfolio before change:  [-0.69820333]
curr_Stock_Price:  99.17003768108111
curr_Factors:  [9.91700377e+01 4.03892569e-02]
mat_Sqrt:  [[ 1.99302804e+01  0.00000000e+00]
 [-8.03883145e-03  1.84192768e-02]]
grads:  [-0.03917455 -5.04701149]
Stock Position:  -0.03917454508359777
Bond Position:  [3.18673778]


portfolio before change:  [-0.65524054]
curr_Stock_Price:  98.08350499742666
curr_Factors:  [9.80835050e+01 4.02632921e-02]
mat_Sqrt:  [[ 1.96811566e+01  0.00000000e+00]
 [-8.02628603e-03  1.83905316e-02]]
grads:  [-0.00578156  0.54916201]
Stock Position:  -0.005781559194972903
Bond Position:  [-0.08816495]


portfolio before change:  [-0.66360724]
curr_Stock_Price:  99.52873327209689
curr_Factors:  [9.95287333e+01 4.03272596e-02]
mat_Sqrt:  [[ 1.99870101e+01  0.00000000e+00]
 [-8.03265930e-03  1.84051346e-02]]
grads:  [ 4.54252188e-04 -3.52246581e+00]
Stock Position:  0.0004542521879060387
Bond Position:  [-0.70881838]


portfolio before change:  [-0.66346993]
curr_Stock_Price:  100.02606479188964
curr_Factors:  [1.00026065e+02 4.14764621e-02]
mat_Sqrt:  [[ 2.03710791e+01  0.00000000e+00]
 [-8.14630832e-03  1.86655373e-02]]
grads:  [0.0075314  4.50160528]
Stock Position:  0.0075313953856147135
Bond Position:  [-1.41680577]


portfolio before change:  [-0.67208498]
curr_Stock_Price:  98.90569634420805
curr_Factors:  [9.89056963e+01 4.00518280e-02]
mat_Sqrt:  [[ 1.97939503e+01  0.00000000e+00]
 [-8.00518113e-03  1.83421742e-02]]
grads:  [-0.00699425  3.74666227]
Stock Position:  -0.006994248106630299
Bond Position:  [0.019686]


portfolio before change:  [-0.68252833]
curr_Stock_Price:  100.39918276049332
curr_Factors:  [1.00399183e+02 3.91881358e-02]
mat_Sqrt:  [[ 1.98750157e+01  0.00000000e+00]
 [-7.91839739e-03  1.81433277e-02]]
grads:  [ -0.02320406 -20.79352171]
Stock Position:  -0.023204064510643385
Bond Position:  [1.64714078]


portfolio before change:  [-0.68367268]
curr_Stock_Price:  100.45737329566151
curr_Factors:  [1.00457373e+02 3.93982446e-02]
mat_Sqrt:  [[ 1.99397750e+01  0.00000000e+00]
 [-7.93959642e-03  1.81919008e-02]]
grads:  [2.58742782e-03 1.60277696e+01]
Stock Position:  0.0025874278191026384
Bond Position:  [-0.94359889]


portfolio before change:  [-0.67807284]
curr_Stock_Price:  102.66721409094248
curr_Factors:  [1.02667214e+02 3.67743478e-02]
mat_Sqrt:  [[ 1.96881209e+01  0.00000000e+00]
 [-7.67065554e-03  1.75756798e-02]]
grads:  [-3.54373777e-03  6.76841576e+00]
Stock Position:  -0.003543737765422543
Bond Position:  [-0.31424715]


portfolio before change:  [-0.68323955]
curr_Stock_Price:  104.11411236971664
curr_Factors:  [1.04114112e+02 3.53518091e-02]
mat_Sqrt:  [[ 1.95756153e+01  0.00000000e+00]
 [-7.52083071e-03  1.72323880e-02]]
grads:  [-2.13420546e-03  7.19852813e+00]
Stock Position:  -0.0021342054649494983
Bond Position:  [-0.46103864]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.68513616]
Stock Price:  104.97578014446741
PL:  [-5.6609163]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 5.40018911e-01  9.91954942e-01]
 [-2.07644853e-01 -7.48106587e-02]
 [ 8.71960374e-01 -7.47708221e-01]
 [-1.47215647e-01  4.87310085e-02]
 [-1.77984986e-01  1.20885281e-01]
 [ 3.86355451e-01  3.37192141e-01]
 [ 2.16988296e-01 -5.30193321e-01]
 [ 4.45774336e-01 -1.61190161e-02]
 [-2.03207745e-01 -4.66504711e-02]
 [ 4.96476443e-01 -3.47910100e-01]
 [ 5.85434986e-02 -1.84006842e-02]
 [-3.66520469e-01 -2.14903992e-01]
 [-1.22128397e-01  1.25396910e-01]
 [-8.71769764e-01 -1.26417628e+00]
 [-1.49138008e-01 -7.81307051e-01]
 [-9.32861225e-02 -2.66789894e-01]
 [-5.04790920e-02  1.30601313e-01]
 [ 1.29276334e-01  1.57153032e-01]
 [ 1.47184395e-02  7.03449773e-02]
 [-1.03291263e-01 -3.35812769e-02]
 [ 2.38679572e-01  2.12611609e-01]
 [ 1.67607652e-02  4.67072048e-02]
 [-1.03073702e-02 -2.73803828e-02]
 [ 7.50550523e-02  1.82839476e-01]
 [ 3.28690779e-02  7.42577340e-02]
 [ 7.24098547e-01 -3.52859682e-01]
 [-4.84533547e-02  9.11687987e-02]
 [-1.74887192e-01  1.32523252e-01]
 [ 2.13397967e-02 -1.48273167e-01]
 [ 4.27595303e-02 -5.63178910e-02]
 [-6.21187096e-01 -9.11585360e-02]
 [-1.18107560e-01  6.68541841e-03]
 [ 5.25103503e-02 -4.49033142e-02]
 [ 1.35289463e-01  7.45139270e-02]
 [-2.85198988e-01 -1.77401696e-01]
 [-6.67550422e-03 -3.77629900e-01]
 [-1.58539098e-01  2.17673320e-01]
 [-1.20292446e-01  1.19900791e-01]
 [-1.31609502e-02  1.06893503e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.76197316]
curr_Stock_Price:  102.11678666497117
curr_Factors:  [1.02116787e+02 3.90890863e-02]
mat_Sqrt:  [[ 2.01894691e+01  0.00000000e+00]
 [-7.90838404e-03  1.81203842e-02]]
grads:  [4.81906450e-02 5.47424894e+01]
Stock Position:  0.04819064501441701
Bond Position:  [11.84089935]


portfolio before change:  [16.73966691]
curr_Stock_Price:  101.62319580380543
curr_Factors:  [1.01623196e+02 3.85020983e-02]
mat_Sqrt:  [[ 1.99404542e+01  0.00000000e+00]
 [-7.84878062e-03  1.79838157e-02]]
grads:  [-0.01205062 -4.15988799]
Stock Position:  -0.012050623221222617
Bond Position:  [17.96428975]


portfolio before change:  [16.72994127]
curr_Stock_Price:  102.61661486141563
curr_Factors:  [1.02616615e+02 3.79898187e-02]
mat_Sqrt:  [[ 2.00009809e+01  0.00000000e+00]
 [-7.79639083e-03  1.78637756e-02]]
grads:  [ 2.72803497e-02 -4.18561137e+01]
Stock Position:  0.027280349700712254
Bond Position:  [13.93052413]


portfolio before change:  [16.76785394]
curr_Stock_Price:  103.94252346750531
curr_Factors:  [1.03942523e+02 3.87644453e-02]
mat_Sqrt:  [[ 2.04649196e+01  0.00000000e+00]
 [-7.87547538e-03  1.80449810e-02]]
grads:  [-0.00615432  2.70052977]
Stock Position:  -0.006154321342450205
Bond Position:  [17.40754963]


portfolio before change:  [16.76251484]
curr_Stock_Price:  105.16364540788277
curr_Factors:  [1.05163645e+02 3.85698062e-02]
mat_Sqrt:  [[ 2.06532956e+01  0.00000000e+00]
 [-7.85567883e-03  1.79996214e-02]]
grads:  [-6.06326113e-03  6.71599020e+00]
Stock Position:  -0.006063261127715855
Bond Position:  [17.40014949]


portfolio before change:  [16.76455214]
curr_Stock_Price:  105.18638263312447
curr_Factors:  [1.05186383e+02 3.79415793e-02]
mat_Sqrt:  [[ 2.04888330e+01  0.00000000e+00]
 [-7.79143933e-03  1.78524302e-02]]
grads:  [ 0.02603946 18.88774451]
Stock Position:  0.02603946095976575
Bond Position:  [14.02555543]


portfolio before change:  [16.7960954]
curr_Stock_Price:  106.33041414371222
curr_Factors:  [1.06330414e+02 3.80998766e-02]
mat_Sqrt:  [[ 2.07548352e+01  0.00000000e+00]
 [-7.80767588e-03  1.78896329e-02]]
grads:  [-6.94153392e-04 -2.96369034e+01]
Stock Position:  -0.0006941533917287711
Bond Position:  [16.86990502]


portfolio before change:  [16.79974684]
curr_Stock_Price:  104.10818364026309
curr_Factors:  [1.04108184e+02 3.76396936e-02]
mat_Sqrt:  [[ 2.01979787e+01  0.00000000e+00]
 [-7.76038078e-03  1.77812662e-02]]
grads:  [ 0.02172195 -0.90651678]
Stock Position:  0.02172194689492988
Bond Position:  [14.53831441]


portfolio before change:  [16.82322782]
curr_Stock_Price:  105.10549643360343
curr_Factors:  [1.05105496e+02 3.56875179e-02]
mat_Sqrt:  [[ 1.98556267e+01  0.00000000e+00]
 [-7.55645609e-03  1.73140160e-02]]
grads:  [-0.01125966 -2.69437611]
Stock Position:  -0.011259663727473028
Bond Position:  [18.00668037]


portfolio before change:  [16.83992425]
curr_Stock_Price:  103.82255800154375
curr_Factors:  [1.03822558e+02 3.73341607e-02]
mat_Sqrt:  [[ 2.00606463e+01  0.00000000e+00]
 [-7.72881991e-03  1.77089511e-02]]
grads:  [ 1.71797070e-02 -1.96460026e+01]
Stock Position:  0.017179707029525034
Bond Position:  [15.05628312]


portfolio before change:  [16.86089185]
curr_Stock_Price:  104.93348764737745
curr_Factors:  [1.04933488e+02 3.71894876e-02]
mat_Sqrt:  [[ 2.02359783e+01  0.00000000e+00]
 [-7.71383044e-03  1.76746060e-02]]
grads:  [ 0.00249619 -1.04108031]
Stock Position:  0.002496186785460623
Bond Position:  [16.59895827]


portfolio before change:  [16.86414409]
curr_Stock_Price:  105.40510421059369
curr_Factors:  [1.05405104e+02 3.67831759e-02]
mat_Sqrt:  [[ 2.02155822e+01  0.00000000e+00]
 [-7.67157620e-03  1.75777893e-02]]
grads:  [ -0.02277017 -12.2258828 ]
Stock Position:  -0.02277017083322341
Bond Position:  [19.26423632]


portfolio before change:  [16.85470008]
curr_Stock_Price:  105.92561807230469
curr_Factors:  [1.05925618e+02 3.65917388e-02]
mat_Sqrt:  [[ 2.02624768e+01  0.00000000e+00]
 [-7.65158690e-03  1.75319881e-02]]
grads:  [-3.32638003e-03  7.15246379e+00]
Stock Position:  -0.003326380034900901
Bond Position:  [17.20704895]


portfolio before change:  [16.85584812]
curr_Stock_Price:  106.22714039515455
curr_Factors:  [1.06227140e+02 3.63384558e-02]
mat_Sqrt:  [[ 2.02497061e+01  0.00000000e+00]
 [-7.62505929e-03  1.74712057e-02]]
grads:  [-7.02973918e-02 -7.23577010e+01]
Stock Position:  -0.07029739182171407
Bond Position:  [24.32333903]


portfolio before change:  [16.75629701]
curr_Stock_Price:  107.68653626761667
curr_Factors:  [1.07686536e+02 3.43753163e-02]
mat_Sqrt:  [[ 1.99657101e+01  0.00000000e+00]
 [-7.41623261e-03  1.69927237e-02]]
grads:  [-2.45485064e-02 -4.59789182e+01]
Stock Position:  -0.024548506371194
Bond Position:  [19.39984063]


portfolio before change:  [16.75165961]
curr_Stock_Price:  107.9742329437196
curr_Factors:  [1.07974233e+02 3.40154823e-02]
mat_Sqrt:  [[ 1.99139973e+01  0.00000000e+00]
 [-7.37731467e-03  1.69035514e-02]]
grads:  [-1.05314254e-02 -1.57830675e+01]
Stock Position:  -0.010531425446577754
Bond Position:  [17.8887822]


portfolio before change:  [16.77150003]
curr_Stock_Price:  106.30264751381192
curr_Factors:  [1.06302648e+02 3.51606347e-02]
mat_Sqrt:  [[ 1.99329893e+01  0.00000000e+00]
 [-7.50046769e-03  1.71857305e-02]]
grads:  [3.27095647e-04 7.59940426e+00]
Stock Position:  0.00032709564687671
Bond Position:  [16.7367289]


portfolio before change:  [16.77357112]
curr_Stock_Price:  106.23804421952306
curr_Factors:  [1.06238044e+02 3.46548630e-02]
mat_Sqrt:  [[ 1.97770795e+01  0.00000000e+00]
 [-7.44632666e-03  1.70616778e-02]]
grads:  [0.01000469 9.21087798]
Stock Position:  0.01000468949355926
Bond Position:  [15.71069247]


portfolio before change:  [16.75301512]
curr_Stock_Price:  103.98710350900595
curr_Factors:  [1.03987104e+02 3.50823345e-02]
mat_Sqrt:  [[ 1.94770744e+01  0.00000000e+00]
 [-7.49211153e-03  1.71665841e-02]]
grads:  [2.33194696e-03 4.09778537e+00]
Stock Position:  0.002331946961395969
Bond Position:  [16.51052271]


portfolio before change:  [16.7555971]
curr_Stock_Price:  104.2092523809815
curr_Factors:  [1.04209252e+02 3.61367843e-02]
mat_Sqrt:  [[ 1.98098429e+01  0.00000000e+00]
 [-7.60387104e-03  1.74226573e-02]]
grads:  [-0.00595398 -1.92744862]
Stock Position:  -0.005953976213962772
Bond Position:  [17.37605651]


portfolio before change:  [16.76378525]
curr_Stock_Price:  103.19883339040707
curr_Factors:  [1.03198833e+02 3.77414446e-02]
mat_Sqrt:  [[ 2.00485998e+01  0.00000000e+00]
 [-7.77086297e-03  1.78052839e-02]]
grads:  [ 0.01653337 11.94092778]
Stock Position:  0.01653336833722169
Bond Position:  [15.05756093]


portfolio before change:  [16.76380447]
curr_Stock_Price:  103.0861462804742
curr_Factors:  [1.03086146e+02 3.78317403e-02]
mat_Sqrt:  [[ 2.00506504e+01  0.00000000e+00]
 [-7.78015324e-03  1.78265706e-02]]
grads:  [1.85258133e-03 2.62008919e+00]
Stock Position:  0.0018525813306203406
Bond Position:  [16.572829]


portfolio before change:  [16.76891151]
curr_Stock_Price:  104.72456960930661
curr_Factors:  [1.04724570e+02 3.58164279e-02]
mat_Sqrt:  [[ 1.98193643e+01  0.00000000e+00]
 [-7.57009146e-03  1.73452586e-02]]
grads:  [-1.12300014e-03 -1.57855143e+00]
Stock Position:  -0.001123000144463405
Bond Position:  [16.88651722]


portfolio before change:  [16.77188037]
curr_Stock_Price:  103.96062568511766
curr_Factors:  [1.03960626e+02 3.55693211e-02]
mat_Sqrt:  [[ 1.96067979e+01  0.00000000e+00]
 [-7.54393225e-03  1.72853203e-02]]
grads:  [7.89791084e-03 1.05777315e+01]
Stock Position:  0.007897910837399609
Bond Position:  [15.95080862]


portfolio before change:  [16.75831945]
curr_Stock_Price:  101.9911309124153
curr_Factors:  [1.01991131e+02 3.63792369e-02]
mat_Sqrt:  [[ 1.94531170e+01  0.00000000e+00]
 [-7.62933673e-03  1.74810065e-02]]
grads:  [3.35564783e-03 4.24790951e+00]
Stock Position:  0.003355647828793409
Bond Position:  [16.41607313]


portfolio before change:  [16.76174111]
curr_Stock_Price:  102.39925450439034
curr_Factors:  [1.02399255e+02 3.57679928e-02]
mat_Sqrt:  [[ 1.93661851e+01  0.00000000e+00]
 [-7.56497115e-03  1.73335265e-02]]
grads:  [  0.0294378  -20.35706251]
Stock Position:  0.02943780366381215
Bond Position:  [13.74733196]


portfolio before change:  [16.7253599]
curr_Stock_Price:  101.10500931369462
curr_Factors:  [1.01105009e+02 3.54436105e-02]
mat_Sqrt:  [[ 1.90345078e+01  0.00000000e+00]
 [-7.53058940e-03  1.72547480e-02]]
grads:  [-4.55174832e-04  5.28369344e+00]
Stock Position:  -0.0004551748320025171
Bond Position:  [16.77138035]


portfolio before change:  [16.72811727]
curr_Stock_Price:  99.653217919564
curr_Factors:  [9.96532179e+01 3.67299756e-02]
mat_Sqrt:  [[ 1.90986050e+01  0.00000000e+00]
 [-7.66602641e-03  1.75650731e-02]]
grads:  [-6.12868339e-03  7.54470257e+00]
Stock Position:  -0.006128683389939395
Bond Position:  [17.33886029]


portfolio before change:  [16.72899349]
curr_Stock_Price:  99.86391121442233
curr_Factors:  [9.98639112e+01 3.68650740e-02]
mat_Sqrt:  [[ 1.91741503e+01  0.00000000e+00]
 [-7.68011188e-03  1.75973470e-02]]
grads:  [-2.26199952e-03 -8.42588188e+00]
Stock Position:  -0.002261999522407819
Bond Position:  [16.95488561]


portfolio before change:  [16.73302068]
curr_Stock_Price:  99.02054403111359
curr_Factors:  [9.90205440e+01 3.77512415e-02]
mat_Sqrt:  [[ 1.92393736e+01  0.00000000e+00]
 [-7.77187149e-03  1.78075947e-02]]
grads:  [ 9.44957356e-04 -3.16257709e+00]
Stock Position:  0.0009449573563422956
Bond Position:  [16.63945049]


portfolio before change:  [16.73640781]
curr_Stock_Price:  100.40375511858126
curr_Factors:  [1.00403755e+02 3.68946775e-02]
mat_Sqrt:  [[ 1.92855405e+01  0.00000000e+00]
 [-7.68319491e-03  1.76044111e-02]]
grads:  [-0.03427293 -5.17816446]
Stock Position:  -0.03427292809783913
Bond Position:  [20.17753849]


portfolio before change:  [16.77281188]
curr_Stock_Price:  99.4151697385501
curr_Factors:  [9.94151697e+01 3.60265314e-02]
mat_Sqrt:  [[ 1.88696517e+01  0.00000000e+00]
 [-7.59226252e-03  1.73960589e-02]]
grads:  [-0.0061045  0.3843065]
Stock Position:  -0.006104500842518133
Bond Position:  [17.37969187]


portfolio before change:  [16.77290042]
curr_Stock_Price:  99.7565670768666
curr_Factors:  [9.97565671e+01 3.53026564e-02]
mat_Sqrt:  [[ 1.87432625e+01  0.00000000e+00]
 [-7.51560045e-03  1.72204040e-02]]
grads:  [ 1.75598764e-03 -2.60756450e+00]
Stock Position:  0.0017559876401129649
Bond Position:  [16.59772912]


portfolio before change:  [16.7768777]
curr_Stock_Price:  100.83996986810442
curr_Factors:  [1.00839970e+02 3.52733098e-02]
mat_Sqrt:  [[ 1.89389463e+01  0.00000000e+00]
 [-7.51247600e-03  1.72132450e-02]]
grads:  [0.00886058 4.32887158]
Stock Position:  0.008860577777292503
Bond Position:  [15.88337731]


portfolio before change:  [16.78597289]
curr_Stock_Price:  101.64236001302257
curr_Factors:  [1.01642360e+02 3.47984772e-02]
mat_Sqrt:  [[ 1.89607215e+01  0.00000000e+00]
 [-7.46173998e-03  1.70969941e-02]]
grads:  [ -0.01912498 -10.37619211]
Stock Position:  -0.019124980832299705
Bond Position:  [18.72988108]


portfolio before change:  [16.77252018]
curr_Stock_Price:  102.46819576505722
curr_Factors:  [1.02468196e+02 3.36507571e-02]
mat_Sqrt:  [[ 1.87969120e+01  0.00000000e+00]
 [-7.33765708e-03  1.68126845e-02]]
grads:  [-9.12313171e-03 -2.24610115e+01]
Stock Position:  -0.009123131710102364
Bond Position:  [17.70735103]


portfolio before change:  [16.76673676]
curr_Stock_Price:  103.3447559937682
curr_Factors:  [1.03344756e+02 3.26468966e-02]
mat_Sqrt:  [[ 1.86727979e+01  0.00000000e+00]
 [-7.22738089e-03  1.65600100e-02]]
grads:  [-3.40273978e-03  1.31445162e+01]
Stock Position:  -0.0034027397847600873
Bond Position:  [17.11839208]


portfolio before change:  [16.76721912]
curr_Stock_Price:  103.83188583258678
curr_Factors:  [1.03831886e+02 3.21003174e-02]
mat_Sqrt:  [[ 1.86031036e+01  0.00000000e+00]
 [-7.16662457e-03  1.64207998e-02]]
grads:  [-3.65333938e-03  7.30176315e+00]
Stock Position:  -0.0036533393836775327
Bond Position:  [17.14655224]


portfolio before change:  [16.77380921]
curr_Stock_Price:  102.61474192407857
curr_Factors:  [1.02614742e+02 3.09293378e-02]
mat_Sqrt:  [[ 1.80465865e+01  0.00000000e+00]
 [-7.03469548e-03  1.61185123e-02]]
grads:  [1.85581906e-03 6.63172267e+00]
Stock Position:  0.0018558190636115913
Bond Position:  [16.58337482]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.77581365]
Stock Price:  102.57776921327866
PL:  [14.19804444]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.63293429e-01  7.10517107e-01]
 [-2.18850652e-01 -7.19161680e-02]
 [ 7.88679870e-01 -6.62173868e-01]
 [-1.43998431e-02  2.52647488e-02]
 [-1.14663462e-01  4.92493831e-02]
 [ 1.93269483e-02  4.68253585e-02]
 [ 5.39325737e-02  1.73935115e-01]
 [ 3.13890861e-01 -4.98316865e-03]
 [ 9.79622153e-02  9.17796883e-02]
 [ 4.72852674e-01 -3.17872889e-01]
 [ 5.82772423e-02 -1.93200222e-02]
 [-2.17793258e-01 -1.89160713e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-5.11755489e-01 -6.56563831e-01]
 [ 6.91039600e-02  1.95832400e-01]
 [ 5.49700418e-02 -2.10223364e-02]
 [-5.28831864e-02  2.65743243e-01]
 [-1.08514890e-01  5.51168626e-02]
 [ 1.50291185e-02  6.26307718e-02]
 [-5.27187290e-02 -6.38758724e-02]
 [ 1.34991287e-01  4.10010416e-02]
 [ 8.16120180e-02  3.13208733e-01]
 [ 3.66937119e-02  3.21638321e-01]
 [-8.54833436e-02  1.05838464e-01]
 [ 4.50290255e-02  1.01574950e-01]
 [ 2.74002215e-01 -7.55206734e-03]
 [ 8.75500442e-02  1.86318703e-01]
 [-1.86931128e-01  1.37497526e-01]
 [-1.29601525e-01 -7.22070178e-02]
 [ 1.23965591e-01 -7.52959704e-02]
 [-1.02963099e+00 -1.16332406e-01]
 [-1.24893077e-01  7.24157632e-02]
 [-8.20296827e-03 -8.96946861e-02]
 [ 8.15041014e-02  1.02108192e-01]
 [-7.29058332e-02  1.59760020e-01]
 [-1.00743067e+00 -2.11418003e-01]
 [-1.63541720e-02  3.11870979e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.08348755e-01  9.18782872e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.34436092]
curr_Stock_Price:  101.15019038855706
curr_Factors:  [1.01150190e+02 4.04736404e-02]
mat_Sqrt:  [[ 2.03494577e+01  0.00000000e+00]
 [-8.04722466e-03  1.84385081e-02]]
grads:  [3.30912267e-02 3.85344142e+01]
Stock Position:  0.033091226727857
Bond Position:  [6.99717703]


portfolio before change:  [10.36547047]
curr_Stock_Price:  101.76167728601806
curr_Factors:  [1.01761677e+02 3.89836932e-02]
mat_Sqrt:  [[ 2.00921192e+01  0.00000000e+00]
 [-7.89771544e-03  1.80959394e-02]]
grads:  [-0.01245451 -3.97416052]
Stock Position:  -0.012454507083547284
Bond Position:  [11.632862]


portfolio before change:  [10.38417553]
curr_Stock_Price:  100.3765670989843
curr_Factors:  [1.00376567e+02 4.03234543e-02]
mat_Sqrt:  [[ 2.01563181e+01  0.00000000e+00]
 [-8.03228031e-03  1.84042663e-02]]
grads:  [ 2.47904156e-02 -3.59793680e+01]
Stock Position:  0.02479041556431743
Bond Position:  [7.89579872]


portfolio before change:  [10.38121998]
curr_Stock_Price:  100.21753013452927
curr_Factors:  [1.00217530e+02 4.05909486e-02]
mat_Sqrt:  [[ 2.01910217e+01  0.00000000e+00]
 [-8.05887820e-03  1.84652097e-02]]
grads:  [-1.67074396e-04  1.36823514e+00]
Stock Position:  -0.00016707439605122601
Bond Position:  [10.39796376]


portfolio before change:  [10.38232857]
curr_Stock_Price:  101.36213702136018
curr_Factors:  [1.01362137e+02 4.01530222e-02]
mat_Sqrt:  [[ 2.03111670e+01  0.00000000e+00]
 [-8.01528761e-03  1.83653311e-02]]
grads:  [-0.0045871   2.68164962]
Stock Position:  -0.0045870957903869575
Bond Position:  [10.8472864]


portfolio before change:  [10.38075787]
curr_Stock_Price:  102.00016573757536
curr_Factors:  [1.02000166e+02 4.04756905e-02]
mat_Sqrt:  [[ 2.05209759e+01  0.00000000e+00]
 [-8.04742846e-03  1.84389750e-02]]
grads:  [1.93768612e-03 2.53947730e+00]
Stock Position:  0.001937686119497324
Bond Position:  [10.18311356]


portfolio before change:  [10.38328227]
curr_Stock_Price:  102.64600788684727
curr_Factors:  [1.02646008e+02 4.10627164e-02]
mat_Sqrt:  [[ 2.08001229e+01  0.00000000e+00]
 [-8.10557501e-03  1.85722055e-02]]
grads:  [6.24246703e-03 9.36534517e+00]
Stock Position:  0.006242467027654117
Bond Position:  [9.74251795]


portfolio before change:  [10.38366675]
curr_Stock_Price:  102.51250101040533
curr_Factors:  [1.02512501e+02 4.02683793e-02]
mat_Sqrt:  [[ 2.05711658e+01  0.00000000e+00]
 [-8.02679306e-03  1.83916934e-02]]
grads:  [ 0.01515306 -0.2709467 ]
Stock Position:  0.015153056039231847
Bond Position:  [8.83028908]


portfolio before change:  [10.38238128]
curr_Stock_Price:  102.35482144413501
curr_Factors:  [1.02354821e+02 3.91503762e-02]
mat_Sqrt:  [[ 2.02523897e+01  0.00000000e+00]
 [-7.91458160e-03  1.81345846e-02]]
grads:  [0.00681491 5.06103063]
Stock Position:  0.00681490715338255
Bond Position:  [9.68484268]


portfolio before change:  [10.39128691]
curr_Stock_Price:  103.48395678254626
curr_Factors:  [1.03483957e+02 3.81222584e-02]
mat_Sqrt:  [[ 2.02051620e+01  0.00000000e+00]
 [-7.80996885e-03  1.78948867e-02]]
grads:  [ 1.65364461e-02 -1.77633362e+01]
Stock Position:  0.016536446059517696
Bond Position:  [8.68003004]


portfolio before change:  [10.41879452]
curr_Stock_Price:  105.08179341595964
curr_Factors:  [1.05081793e+02 3.74578968e-02]
mat_Sqrt:  [[ 2.03375751e+01  0.00000000e+00]
 [-7.74161707e-03  1.77382731e-02]]
grads:  [ 0.0024509  -1.08917153]
Stock Position:  0.0024508965799420507
Bond Position:  [10.16124992]


portfolio before change:  [10.41833492]
curr_Stock_Price:  104.37599463051926
curr_Factors:  [1.04375995e+02 3.76959647e-02]
mat_Sqrt:  [[ 2.02650677e+01  0.00000000e+00]
 [-7.76617947e-03  1.77945526e-02]]
grads:  [ -0.01482106 -10.63025955]
Stock Position:  -0.014821058930253561
Bond Position:  [11.96529769]


portfolio before change:  [10.44020732]
curr_Stock_Price:  103.00115072162399
curr_Factors:  [1.03001151e+02 3.80062289e-02]
mat_Sqrt:  [[ 2.00802662e+01  0.00000000e+00]
 [-7.79807453e-03  1.78676334e-02]]
grads:  [-6.01546901e-03  9.26432969e+00]
Stock Position:  -0.006015469014435683
Bond Position:  [11.05980755]


portfolio before change:  [10.44955256]
curr_Stock_Price:  101.67745059804643
curr_Factors:  [1.01677451e+02 3.87089533e-02]
mat_Sqrt:  [[ 2.00046226e+01  0.00000000e+00]
 [-7.86983642e-03  1.80320606e-02]]
grads:  [ -0.03990595 -36.41091537]
Stock Position:  -0.03990594835162394
Bond Position:  [14.50708765]


portfolio before change:  [10.45087555]
curr_Stock_Price:  101.68974216309223
curr_Factors:  [1.01689742e+02 3.89514622e-02]
mat_Sqrt:  [[ 2.00696144e+01  0.00000000e+00]
 [-7.89444992e-03  1.80884572e-02]]
grads:  [7.70180349e-03 1.08263739e+01]
Stock Position:  0.007701803485235276
Bond Position:  [9.66768114]


portfolio before change:  [10.45171659]
curr_Stock_Price:  101.64202706689863
curr_Factors:  [1.01642027e+02 3.83321144e-02]
mat_Sqrt:  [[ 1.99000747e+01  0.00000000e+00]
 [-7.83143557e-03  1.79440732e-02]]
grads:  [ 0.00230125 -1.17154763]
Stock Position:  0.0023012547856713136
Bond Position:  [10.21781239]


portfolio before change:  [10.4541024]
curr_Stock_Price:  102.12372205243975
curr_Factors:  [1.02123722e+02 3.66713099e-02]
mat_Sqrt:  [[ 1.95564421e+01  0.00000000e+00]
 [-7.65990182e-03  1.75510399e-02]]
grads:  [3.22638815e-03 1.51411679e+01]
Stock Position:  0.00322638815168648
Bond Position:  [10.12461164]


portfolio before change:  [10.45424054]
curr_Stock_Price:  101.77425343820742
curr_Factors:  [1.01774253e+02 3.55675425e-02]
mat_Sqrt:  [[ 1.91939719e+01  0.00000000e+00]
 [-7.54374363e-03  1.72848881e-02]]
grads:  [-0.00440034  3.18873123]
Stock Position:  -0.004400335672776157
Bond Position:  [10.90208142]


portfolio before change:  [10.4588106]
curr_Stock_Price:  101.04539692167597
curr_Factors:  [1.01045397e+02 3.44188588e-02]
mat_Sqrt:  [[ 1.87462657e+01  0.00000000e+00]
 [-7.42092811e-03  1.70034824e-02]]
grads:  [2.25983292e-03 3.68340851e+00]
Stock Position:  0.0022598329176948566
Bond Position:  [10.23046488]


portfolio before change:  [10.46003645]
curr_Stock_Price:  101.02192804210326
curr_Factors:  [1.01021928e+02 3.47043884e-02]
mat_Sqrt:  [[ 1.88194900e+01  0.00000000e+00]
 [-7.45164555e-03  1.70738649e-02]]
grads:  [-0.00428261 -3.74114899]
Stock Position:  -0.004282605172324019
Bond Position:  [10.89267348]


portfolio before change:  [10.4636262]
curr_Stock_Price:  100.50166527142741
curr_Factors:  [1.00501665e+02 3.41362606e-02]
mat_Sqrt:  [[ 1.85686885e+01  0.00000000e+00]
 [-7.39040032e-03  1.69335344e-02]]
grads:  [0.00823352 2.4212926 ]
Stock Position:  0.008233516775775981
Bond Position:  [9.63614405]


portfolio before change:  [10.45946303]
curr_Stock_Price:  99.84972542191294
curr_Factors:  [9.98497254e+01 3.47904501e-02]
mat_Sqrt:  [[ 1.86241688e+01  0.00000000e+00]
 [-7.46087932e-03  1.70950221e-02]]
grads:  [1.17217320e-02 1.83216337e+01]
Stock Position:  0.011721732039257006
Bond Position:  [9.28905131]


portfolio before change:  [10.45487239]
curr_Stock_Price:  99.35902629378387
curr_Factors:  [9.93590263e+01 3.62979989e-02]
mat_Sqrt:  [[ 1.89299152e+01  0.00000000e+00]
 [-7.62081349e-03  1.74614773e-02]]
grads:  [9.35388151e-03 1.84198802e+01]
Stock Position:  0.00935388150638101
Bond Position:  [9.52547984]


portfolio before change:  [10.43713605]
curr_Stock_Price:  97.33557722990582
curr_Factors:  [9.73355772e+01 3.62982894e-02]
mat_Sqrt:  [[ 1.85444812e+01  0.00000000e+00]
 [-7.62084399e-03  1.74615472e-02]]
grads:  [-2.11877865e-03  6.06123060e+00]
Stock Position:  -0.0021187786465479115
Bond Position:  [10.64336859]


portfolio before change:  [10.43870681]
curr_Stock_Price:  97.22218517461219
curr_Factors:  [9.72221852e+01 3.83783290e-02]
mat_Sqrt:  [[ 1.90462030e+01  0.00000000e+00]
 [-7.83615508e-03  1.79548869e-02]]
grads:  [4.69174712e-03 5.65723141e+00]
Stock Position:  0.004691747121601387
Bond Position:  [9.9825649]


portfolio before change:  [10.44224904]
curr_Stock_Price:  97.71119904373474
curr_Factors:  [9.77111990e+01 3.88433369e-02]
mat_Sqrt:  [[ 1.92576198e+01  0.00000000e+00]
 [-7.88348520e-03  1.80633338e-02]]
grads:  [ 0.0140571  -0.41808823]
Stock Position:  0.01405709662617734
Bond Position:  [9.06871327]


portfolio before change:  [10.43345623]
curr_Stock_Price:  97.00504566383427
curr_Factors:  [9.70050457e+01 3.96236820e-02]
mat_Sqrt:  [[ 1.93095316e+01  0.00000000e+00]
 [-7.96227927e-03  1.82438737e-02]]
grads:  [8.74522469e-03 1.02126722e+01]
Stock Position:  0.008745224687123012
Bond Position:  [9.58512531]


portfolio before change:  [10.43963447]
curr_Stock_Price:  97.57450192999538
curr_Factors:  [9.75745019e+01 3.98190526e-02]
mat_Sqrt:  [[ 1.94707107e+01  0.00000000e+00]
 [-7.98188475e-03  1.82887955e-02]]
grads:  [-6.51862635e-03  7.51812913e+00]
Stock Position:  -0.006518626347255135
Bond Position:  [11.07568619]


portfolio before change:  [10.44184538]
curr_Stock_Price:  97.44773146938668
curr_Factors:  [9.74477315e+01 4.06474177e-02]
mat_Sqrt:  [[ 1.96466367e+01  0.00000000e+00]
 [-8.06448190e-03  1.84780494e-02]]
grads:  [-0.00820065 -3.90771863]
Stock Position:  -0.008200653052141176
Bond Position:  [11.24098042]


portfolio before change:  [10.44829949]
curr_Stock_Price:  96.83206132289949
curr_Factors:  [9.68320613e+01 4.02861833e-02]
mat_Sqrt:  [[ 1.94355681e+01  0.00000000e+00]
 [-8.02856733e-03  1.83957587e-02]]
grads:  [ 0.00468747 -4.09311578]
Stock Position:  0.004687474793596767
Bond Position:  [9.99440164]


portfolio before change:  [10.44704081]
curr_Stock_Price:  96.29700543619015
curr_Factors:  [9.62970054e+01 3.95326300e-02]
mat_Sqrt:  [[ 1.91465547e+01  0.00000000e+00]
 [-7.95312568e-03  1.82229002e-02]]
grads:  [-0.05642804 -6.38385796]
Stock Position:  -0.05642804307408358
Bond Position:  [15.88089238]


portfolio before change:  [10.43870716]
curr_Stock_Price:  96.47987350777915
curr_Factors:  [9.64798735e+01 3.90693380e-02]
mat_Sqrt:  [[ 1.90701782e+01  0.00000000e+00]
 [-7.90638608e-03  1.81158063e-02]]
grads:  [-0.00489184  3.99738007]
Stock Position:  -0.004891839302052842
Bond Position:  [10.91067119]


portfolio before change:  [10.43432339]
curr_Stock_Price:  97.65482844238629
curr_Factors:  [9.76548284e+01 3.99883845e-02]
mat_Sqrt:  [[ 1.95281297e+01  0.00000000e+00]
 [-7.99883837e-03  1.83276411e-02]]
grads:  [-2.42465302e-03 -4.89395691e+00]
Stock Position:  -0.0024246530159972735
Bond Position:  [10.67110246]


portfolio before change:  [10.43498851]
curr_Stock_Price:  97.93068306406019
curr_Factors:  [9.79306831e+01 3.92278041e-02]
mat_Sqrt:  [[ 1.93961611e+01  0.00000000e+00]
 [-7.92240409e-03  1.81525082e-02]]
grads:  [0.00649962 5.62501833]
Stock Position:  0.006499624793378864
Bond Position:  [9.79847581]


portfolio before change:  [10.42956451]
curr_Stock_Price:  96.90771904371293
curr_Factors:  [9.69077190e+01 4.03291337e-02]
mat_Sqrt:  [[ 1.94611194e+01  0.00000000e+00]
 [-8.03284594e-03  1.84055623e-02]]
grads:  [-1.63446110e-04  8.67998583e+00]
Stock Position:  -0.0001634461102446151
Bond Position:  [10.4454037]


portfolio before change:  [10.43089033]
curr_Stock_Price:  96.78498286483558
curr_Factors:  [9.67849829e+01 3.96400324e-02]
mat_Sqrt:  [[ 1.92697011e+01  0.00000000e+00]
 [-7.96392189e-03  1.82476374e-02]]
grads:  [ -0.05706892 -11.58604799]
Stock Position:  -0.057068921205765524
Bond Position:  [15.95430489]


portfolio before change:  [10.37529966]
curr_Stock_Price:  97.79402735137856
curr_Factors:  [9.77940274e+01 3.83074796e-02]
mat_Sqrt:  [[ 1.91405371e+01  0.00000000e+00]
 [-7.82891866e-03  1.79383062e-02]]
grads:  [6.25674616e-03 1.73857540e+01]
Stock Position:  0.006256746156017975
Bond Position:  [9.76342725]


portfolio before change:  [10.37194787]
curr_Stock_Price:  97.06324838480829
curr_Factors:  [9.70632484e+01 3.87080413e-02]
mat_Sqrt:  [[ 1.90965722e+01  0.00000000e+00]
 [-7.86974371e-03  1.80318481e-02]]
grads:  [-4.61785573e-03  6.06492267e+00]
Stock Position:  -0.004617855727934456
Bond Position:  [10.82017194]


portfolio before change:  [10.37334276]
curr_Stock_Price:  97.05409042556796
curr_Factors:  [9.70540904e+01 3.82768852e-02]
mat_Sqrt:  [[ 1.89881275e+01  0.00000000e+00]
 [-7.82579174e-03  1.79311415e-02]]
grads:  [0.04278245 0.51239508]
Stock Position:  0.04278245200967499
Bond Position:  [6.2211308]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.31484013]
Stock Price:  95.6684679851331
PL:  [10.31484013]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.49845931e-01 -1.55329255e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.83782325e-01 -8.45639630e-01]
 [-4.02437679e-02  5.42740729e-02]
 [ 2.94427559e-02 -9.15844017e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-6.89795797e-02  1.68350541e-01]
 [-8.15800725e-02 -7.96530066e-02]
 [ 1.36184896e-01  7.96236528e-02]
 [ 3.50347857e-01 -1.73370802e-01]
 [ 6.27979736e-02 -3.71069827e-03]
 [-1.39395714e-01 -1.79227927e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-7.03307430e-01 -9.69610647e-01]
 [-1.71312023e-02 -1.95247982e-01]
 [ 2.85329508e-02 -1.25014160e-01]
 [-5.29003395e-02  2.66707475e-01]
 [-8.07129081e-02  8.73702301e-02]
 [ 1.48694102e-02  6.65963514e-02]
 [-1.00837475e-01 -3.58759135e-02]
 [ 2.32068554e-01  2.49410281e-01]
 [ 2.93763494e-02  8.21915556e-02]
 [-8.72466554e-03  1.09481305e-01]
 [ 7.52236228e-02  1.82897310e-01]
 [ 5.75519201e-02  1.22975906e-01]
 [ 7.56302010e-01 -4.94042762e-01]
 [-4.50995383e-01  5.72504210e-01]
 [ 1.40600823e-01 -9.83128853e-03]
 [-4.72635864e-02 -6.27349823e-02]
 [ 6.45168256e-02 -2.43051377e-01]
 [ 1.29219615e-01 -6.53087347e-02]
 [ 1.37443929e-01 -1.34686607e-02]
 [ 2.29804868e-01  2.70065142e-01]
 [ 2.18633465e-01  3.17547753e-02]
 [-1.91185866e-01 -2.37212428e-01]
 [ 1.82978532e-01 -7.54174578e-02]
 [-2.35435552e-01  1.59747709e-01]
 [-1.14757200e-01  1.23634982e-01]
 [-2.31381804e-01  1.58067894e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.09649659]
curr_Stock_Price:  98.67393114593155
curr_Factors:  [9.86739311e+01 4.01097620e-02]
mat_Sqrt:  [[ 1.97618443e+01  0.00000000e+00]
 [-8.01096869e-03  1.83554352e-02]]
grads:  [-0.02113351 -8.46230306]
Stock Position:  -0.021133512104752613
Bond Position:  [-4.01116987]


portfolio before change:  [-6.09087499]
curr_Stock_Price:  98.38420013545357
curr_Factors:  [9.83842001e+01 4.16394607e-02]
mat_Sqrt:  [[ 2.00760333e+01  0.00000000e+00]
 [-8.16229974e-03  1.87021782e-02]]
grads:  [-0.01011078 -4.70594223]
Stock Position:  -0.010110784591895714
Bond Position:  [-5.09613353]


portfolio before change:  [-6.08014368]
curr_Stock_Price:  97.2598198936781
curr_Factors:  [9.72598199e+01 4.14138313e-02]
mat_Sqrt:  [[ 1.97927512e+01  0.00000000e+00]
 [-8.14015541e-03  1.86514392e-02]]
grads:  [ 2.60052242e-02 -4.53391088e+01]
Stock Position:  0.026005224204266583
Bond Position:  [-8.6094071]


portfolio before change:  [-6.0213656]
curr_Stock_Price:  99.5614466352217
curr_Factors:  [9.95614466e+01 4.03983926e-02]
mat_Sqrt:  [[ 2.00112050e+01  0.00000000e+00]
 [-8.03974055e-03  1.84213598e-02]]
grads:  [-8.27367495e-04  2.94625768e+00]
Stock Position:  -0.0008273674954135599
Bond Position:  [-5.93899169]


portfolio before change:  [-6.02166954]
curr_Stock_Price:  99.0314813659204
curr_Factors:  [9.90314814e+01 3.87572542e-02]
mat_Sqrt:  [[ 1.94961912e+01  0.00000000e+00]
 [-7.87474486e-03  1.80433072e-02]]
grads:  [ 0.00130516 -0.50758101]
Stock Position:  0.001305161844025861
Bond Position:  [-6.15092165]


portfolio before change:  [-6.02175646]
curr_Stock_Price:  99.55401604635009
curr_Factors:  [9.95540160e+01 3.74195164e-02]
mat_Sqrt:  [[ 1.92578531e+01  0.00000000e+00]
 [-7.73764992e-03  1.77291832e-02]]
grads:  [-0.00614922 -3.74055179]
Stock Position:  -0.006149219802208029
Bond Position:  [-5.40957694]


portfolio before change:  [-6.0143424]
curr_Stock_Price:  98.23835324205477
curr_Factors:  [9.82383532e+01 3.83571393e-02]
mat_Sqrt:  [[ 1.92399606e+01  0.00000000e+00]
 [-7.83399151e-03  1.79499295e-02]]
grads:  [2.33608597e-04 9.37889706e+00]
Stock Position:  0.0002336085965162839
Bond Position:  [-6.03729173]


portfolio before change:  [-6.01495303]
curr_Stock_Price:  98.85511301285355
curr_Factors:  [9.88551130e+01 3.86868954e-02]
mat_Sqrt:  [[ 1.94437969e+01  0.00000000e+00]
 [-7.86759383e-03  1.80269221e-02]]
grads:  [-0.00598358 -4.41855831]
Stock Position:  -0.005983578985702406
Bond Position:  [-5.42344566]


portfolio before change:  [-6.02759632]
curr_Stock_Price:  100.85480481062538
curr_Factors:  [1.00854805e+02 3.82963169e-02]
mat_Sqrt:  [[ 1.97367253e+01  0.00000000e+00]
 [-7.82777791e-03  1.79356924e-02]]
grads:  [0.00866078 4.43939665]
Stock Position:  0.008660783588496427
Bond Position:  [-6.90107796]


portfolio before change:  [-6.01871551]
curr_Stock_Price:  101.97981844791343
curr_Factors:  [1.01979818e+02 3.78778508e-02]
mat_Sqrt:  [[ 1.98475497e+01  0.00000000e+00]
 [-7.78489315e-03  1.78374311e-02]]
grads:  [ 0.01383962 -9.71949386]
Stock Position:  0.013839624508053676
Bond Position:  [-7.4300779]


portfolio before change:  [-6.01105327]
curr_Stock_Price:  102.60057666043365
curr_Factors:  [1.02600577e+02 3.78061786e-02]
mat_Sqrt:  [[ 1.99494622e+01  0.00000000e+00]
 [-7.77752440e-03  1.78205471e-02]]
grads:  [ 0.00306667 -0.20822583]
Stock Position:  0.0030666737511413347
Bond Position:  [-6.32569576]


portfolio before change:  [-6.00803223]
curr_Stock_Price:  103.84354952681836
curr_Factors:  [1.03843550e+02 3.66604178e-02]
mat_Sqrt:  [[ 1.98828314e+01  0.00000000e+00]
 [-7.65876416e-03  1.75484332e-02]]
grads:  [ -0.01094498 -10.21332926]
Stock Position:  -0.010944980119313589
Bond Position:  [-4.87146665]


portfolio before change:  [-5.99679339]
curr_Stock_Price:  102.76106059420326
curr_Factors:  [1.02761061e+02 3.65470397e-02]
mat_Sqrt:  [[ 1.96451198e+01  0.00000000e+00]
 [-7.64691203e-03  1.75212766e-02]]
grads:  [-6.14871382e-03  9.44746495e+00]
Stock Position:  -0.006148713822392843
Bond Position:  [-5.36494503]


portfolio before change:  [-6.0067453]
curr_Stock_Price:  104.27052303846227
curr_Factors:  [1.04270523e+02 3.69550295e-02]
mat_Sqrt:  [[ 2.00446431e+01  0.00000000e+00]
 [-7.68947639e-03  1.76188038e-02]]
grads:  [ -0.05619857 -55.03271721]
Stock Position:  -0.056198566487164536
Bond Position:  [-0.14689138]


portfolio before change:  [-5.99888972]
curr_Stock_Price:  104.13041376782046
curr_Factors:  [1.04130414e+02 3.73740148e-02]
mat_Sqrt:  [[ 2.01308666e+01  0.00000000e+00]
 [-7.73294405e-03  1.77184007e-02]]
grads:  [-5.08395441e-03 -1.10195037e+01]
Stock Position:  -0.005083954406289044
Bond Position:  [-5.46949544]


portfolio before change:  [-5.9990241]
curr_Stock_Price:  104.02235835402783
curr_Factors:  [1.04022358e+02 3.77549164e-02]
mat_Sqrt:  [[ 2.02121937e+01  0.00000000e+00]
 [-7.77224975e-03  1.78084614e-02]]
grads:  [-1.28772275e-03 -7.01993043e+00]
Stock Position:  -0.0012877227545303514
Bond Position:  [-5.86507214]


portfolio before change:  [-5.99740363]
curr_Stock_Price:  102.19459864967774
curr_Factors:  [1.02194599e+02 3.89812612e-02]
mat_Sqrt:  [[ 2.01769671e+01  0.00000000e+00]
 [-7.89746908e-03  1.80953749e-02]]
grads:  [3.14717000e-03 1.47389858e+01]
Stock Position:  0.0031471699995042467
Bond Position:  [-6.31902741]


portfolio before change:  [-5.99791838]
curr_Stock_Price:  102.28203716063341
curr_Factors:  [1.02282037e+02 3.82028850e-02]
mat_Sqrt:  [[ 1.99915952e+01  0.00000000e+00]
 [-7.81822332e-03  1.79138001e-02]]
grads:  [-2.12996577e-03  4.87725830e+00]
Stock Position:  -0.002129965772011964
Bond Position:  [-5.78006114]


portfolio before change:  [-5.99903847]
curr_Stock_Price:  102.4686779985598
curr_Factors:  [1.02468678e+02 3.72917955e-02]
mat_Sqrt:  [[ 1.97878122e+01  0.00000000e+00]
 [-7.72443350e-03  1.76989006e-02]]
grads:  [2.22027783e-03 3.76273945e+00]
Stock Position:  0.0022202778333670343
Bond Position:  [-6.2265474]


portfolio before change:  [-5.99717511]
curr_Stock_Price:  103.65849409348459
curr_Factors:  [1.03658494e+02 3.64142161e-02]
mat_Sqrt:  [[ 1.97806418e+01  0.00000000e+00]
 [-7.63300372e-03  1.74894087e-02]]
grads:  [-0.00588934 -2.05129368]
Stock Position:  -0.005889344188387841
Bond Position:  [-5.38669456]


portfolio before change:  [-5.99813094]
curr_Stock_Price:  103.7064523430017
curr_Factors:  [1.03706452e+02 3.62155422e-02]
mat_Sqrt:  [[ 1.97357336e+01  0.00000000e+00]
 [-7.61215262e-03  1.74416328e-02]]
grads:  [ 0.01727426 14.29970944]
Stock Position:  0.017274256521789502
Bond Position:  [-7.7895828]


portfolio before change:  [-5.98023995]
curr_Stock_Price:  104.79852520784824
curr_Factors:  [1.04798525e+02 3.65544229e-02]
mat_Sqrt:  [[ 2.00366511e+01  0.00000000e+00]
 [-7.64768439e-03  1.75230463e-02]]
grads:  [3.25641669e-03 4.69048327e+00]
Stock Position:  0.0032564166875731033
Bond Position:  [-6.32150761]


portfolio before change:  [-5.98453352]
curr_Stock_Price:  103.72270065718955
curr_Factors:  [1.03722701e+02 3.77316437e-02]
mat_Sqrt:  [[ 2.01477558e+01  0.00000000e+00]
 [-7.76985392e-03  1.78029719e-02]]
grads:  [1.93852327e-03 6.14960840e+00]
Stock Position:  0.0019385232659394414
Bond Position:  [-6.18560239]


portfolio before change:  [-5.98483342]
curr_Stock_Price:  103.96688075625855
curr_Factors:  [1.03966881e+02 3.75112627e-02]
mat_Sqrt:  [[ 2.01361230e+01  0.00000000e+00]
 [-7.74712981e-03  1.77509044e-02]]
grads:  [7.69992083e-03 1.03035488e+01]
Stock Position:  0.007699920825899258
Bond Position:  [-6.78537017]


portfolio before change:  [-5.98281103]
curr_Stock_Price:  104.33969176330852
curr_Factors:  [1.04339692e+02 3.89949044e-02]
mat_Sqrt:  [[ 2.06040920e+01  0.00000000e+00]
 [-7.89885100e-03  1.80985413e-02]]
grads:  [5.39810275e-03 6.79479653e+00]
Stock Position:  0.0053981027474757975
Bond Position:  [-6.5460474]


portfolio before change:  [-5.9853732]
curr_Stock_Price:  104.01663978028017
curr_Factors:  [1.04016640e+02 3.87733184e-02]
mat_Sqrt:  [[ 2.04818559e+01  0.00000000e+00]
 [-7.87637667e-03  1.80470461e-02]]
grads:  [ 2.63981973e-02 -2.73752701e+01]
Stock Position:  0.026398197274202968
Bond Position:  [-8.73122498]


portfolio before change:  [-5.95694532]
curr_Stock_Price:  105.13487357774758
curr_Factors:  [1.05134874e+02 3.70580306e-02]
mat_Sqrt:  [[ 2.02389494e+01  0.00000000e+00]
 [-7.70018499e-03  1.76433403e-02]]
grads:  [-9.93796946e-03  3.24487428e+01]
Stock Position:  -0.009937969455664195
Bond Position:  [-4.91211815]


portfolio before change:  [-5.95523457]
curr_Stock_Price:  104.90094226726661
curr_Factors:  [1.04900942e+02 3.65136858e-02]
mat_Sqrt:  [[ 2.00450538e+01  0.00000000e+00]
 [-7.64342183e-03  1.75132795e-02]]
grads:  [ 0.00680019 -0.56136194]
Stock Position:  0.006800186153580435
Bond Position:  [-6.6685805]


portfolio before change:  [-5.95518363]
curr_Stock_Price:  105.03102173360057
curr_Factors:  [1.05031022e+02 3.77474497e-02]
mat_Sqrt:  [[ 2.04061652e+01  0.00000000e+00]
 [-7.77148117e-03  1.78067004e-02]]
grads:  [-0.00365788 -3.52311102]
Stock Position:  -0.0036578836216778856
Bond Position:  [-5.57099237]


portfolio before change:  [-5.95835684]
curr_Stock_Price:  105.7081338959077
curr_Factors:  [1.05708134e+02 3.81178817e-02]
mat_Sqrt:  [[ 2.06382460e+01  0.00000000e+00]
 [-7.80952051e-03  1.78938594e-02]]
grads:  [-2.01371240e-03 -1.35829488e+01]
Stock Position:  -0.0020137123997959945
Bond Position:  [-5.74549106]


portfolio before change:  [-5.96059336]
curr_Stock_Price:  106.46210542587843
curr_Factors:  [1.06462105e+02 3.79724297e-02]
mat_Sqrt:  [[ 2.07457550e+01  0.00000000e+00]
 [-7.79460631e-03  1.78596867e-02]]
grads:  [ 0.0048548  -3.65676821]
Stock Position:  0.004854802637792033
Bond Position:  [-6.47744587]


portfolio before change:  [-5.961269]
curr_Stock_Price:  106.48972581291416
curr_Factors:  [1.06489726e+02 3.75774769e-02]
mat_Sqrt:  [[ 2.06429384e+01  0.00000000e+00]
 [-7.75396434e-03  1.77665643e-02]]
grads:  [ 0.0063734  -0.75809033]
Stock Position:  0.0063734009649022315
Bond Position:  [-6.63997072]


portfolio before change:  [-5.96539363]
curr_Stock_Price:  105.97279880602812
curr_Factors:  [1.05972799e+02 3.79147808e-02]
mat_Sqrt:  [[ 2.06347247e+01  0.00000000e+00]
 [-7.78868726e-03  1.78461245e-02]]
grads:  [ 0.01684883 15.13298545]
Stock Position:  0.01684882953258006
Bond Position:  [-7.75091125]


portfolio before change:  [-5.9764444]
curr_Stock_Price:  105.37442779855222
curr_Factors:  [1.05374428e+02 3.87015660e-02]
mat_Sqrt:  [[ 2.07300094e+01  0.00000000e+00]
 [-7.86908543e-03  1.80303398e-02]]
grads:  [0.01121526 1.76118563]
Stock Position:  0.011215257124410695
Bond Position:  [-7.1582457]


portfolio before change:  [-5.96673392]
curr_Stock_Price:  106.32004331018275
curr_Factors:  [1.06320043e+02 3.93822909e-02]
mat_Sqrt:  [[ 2.10991827e+01  0.00000000e+00]
 [-7.93798876e-03  1.81882172e-02]]
grads:  [ -0.01396802 -13.04209346]
Stock Position:  -0.013968022436126626
Bond Position:  [-4.48165317]


portfolio before change:  [-5.97736224]
curr_Stock_Price:  107.04083829958651
curr_Factors:  [1.07040838e+02 4.05830575e-02]
mat_Sqrt:  [[ 2.15636306e+01  0.00000000e+00]
 [-8.05809481e-03  1.84634147e-02]]
grads:  [ 0.00695911 -4.08469717]
Stock Position:  0.00695910897255687
Bond Position:  [-6.7222711]


portfolio before change:  [-5.97170146]
curr_Stock_Price:  107.97502587521728
curr_Factors:  [1.07975026e+02 3.98044789e-02]
mat_Sqrt:  [[ 2.15421620e+01  0.00000000e+00]
 [-7.98042394e-03  1.82854484e-02]]
grads:  [-7.69263248e-03  8.73632988e+00]
Stock Position:  -0.007692632478003877
Bond Position:  [-5.14108927]


portfolio before change:  [-5.97594266]
curr_Stock_Price:  108.44281358019705
curr_Factors:  [1.08442814e+02 4.02235988e-02]
mat_Sqrt:  [[ 2.17490975e+01  0.00000000e+00]
 [-8.02232872e-03  1.83814643e-02]]
grads:  [-2.79544795e-03  6.72606816e+00]
Stock Position:  -0.0027954479482370587
Bond Position:  [-5.67279642]


portfolio before change:  [-5.97441912]
curr_Stock_Price:  107.64412971536086
curr_Factors:  [1.07644130e+02 3.94329975e-02]
mat_Sqrt:  [[ 2.13756951e+01  0.00000000e+00]
 [-7.94309738e-03  1.81999225e-02]]
grads:  [-7.59719479e-03  8.68508608e+00]
Stock Position:  -0.007597194785229935
Bond Position:  [-5.1566257]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.97751541]
Stock Price:  107.96683643097298
PL:  [-13.94435184]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.83401385e-01  7.35072843e-01]
 [-2.64776655e-01 -6.00067049e-02]
 [ 9.48893906e-01 -8.57916173e-01]
 [-5.95031461e-02  1.19425026e-02]
 [-1.07038395e-01  4.61977564e-02]
 [ 2.01143153e-03  3.13727241e-02]
 [ 6.09212462e-02  1.46892536e-01]
 [ 4.15401145e-01 -1.35714766e-02]
 [-1.23097677e-01  5.33546513e-04]
 [ 5.86131101e-01 -4.61575476e-01]
 [ 6.10386563e-02 -9.78532466e-03]
 [-3.84508054e-01 -2.18590624e-01]
 [-1.16485727e-01  1.23919947e-01]
 [-7.82915702e-01 -1.13450980e+00]
 [-2.34200896e-02 -2.23241822e-01]
 [-2.02402946e-02 -1.93008496e-01]
 [-5.09291594e-02  1.55901059e-01]
 [ 1.08999432e-01  1.54182010e-01]
 [ 1.57240025e-02  4.53766970e-02]
 [-1.13170025e-01 -2.51811127e-02]
 [ 2.00711928e-01  4.24257743e-01]
 [ 6.44692851e-03  1.63095342e-01]
 [-1.12920895e-02 -1.12532308e-01]
 [ 7.25567013e-02  1.81970864e-01]
 [ 6.08442175e-02  1.29400973e-01]
 [ 7.75012823e-01 -5.84107505e-01]
 [-6.04892544e-01  7.58644003e-01]
 [ 1.28511838e-01 -1.13838413e-02]
 [-4.90378374e-02 -6.07960202e-02]
 [ 6.30718391e-02 -2.46416509e-01]
 [-1.72456640e-01 -8.13136973e-02]
 [-8.87338100e-02 -1.63568644e-03]
 [ 1.83101274e-01  1.92237644e-01]
 [ 2.09400528e-01  3.64916798e-02]
 [-2.06253649e-01 -2.33995115e-01]
 [ 1.49019264e-01 -1.81102063e-01]
 [-1.69736631e-01  2.07596830e-01]
 [-1.18520129e-01  1.21096433e-01]
 [-1.27015932e-01  1.31929697e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.82169654]
curr_Stock_Price:  101.22208485943933
curr_Factors:  [1.01222085e+02 3.93105336e-02]
mat_Sqrt:  [[ 2.00691855e+01  0.00000000e+00]
 [-7.93075367e-03  1.81716395e-02]]
grads:  [3.50892902e-02 4.04516523e+01]
Stock Position:  0.03508929015322589
Bond Position:  [7.26988543]


portfolio before change:  [10.86145416]
curr_Stock_Price:  102.32922689700843
curr_Factors:  [1.02329227e+02 4.03556203e-02]
mat_Sqrt:  [[ 2.05566199e+01  0.00000000e+00]
 [-8.03548333e-03  1.84116053e-02]]
grads:  [-0.01415436 -3.25917832]
Stock Position:  -0.014154356568240498
Bond Position:  [12.30985853]


portfolio before change:  [10.84332508]
curr_Stock_Price:  103.71875757593028
curr_Factors:  [1.03718758e+02 3.88018512e-02]
mat_Sqrt:  [[ 2.04307133e+01  0.00000000e+00]
 [-7.87927420e-03  1.80536852e-02]]
grads:  [ 2.81178921e-02 -4.75202798e+01]
Stock Position:  0.028117892103461616
Bond Position:  [7.92697224]


portfolio before change:  [10.81393752]
curr_Stock_Price:  102.63836026749698
curr_Factors:  [1.02638360e+02 3.88250477e-02]
mat_Sqrt:  [[ 2.02239370e+01  0.00000000e+00]
 [-7.88162904e-03  1.80590808e-02]]
grads:  [-0.00268449  0.6613018 ]
Stock Position:  -0.0026844926711834167
Bond Position:  [11.08946944]


portfolio before change:  [10.81927775]
curr_Stock_Price:  101.16546848737342
curr_Factors:  [1.01165468e+02 3.92612101e-02]
mat_Sqrt:  [[ 2.00453728e+01  0.00000000e+00]
 [-7.92577669e-03  1.81602358e-02]]
grads:  [-0.00433397  2.54389628]
Stock Position:  -0.004333969854886752
Bond Position:  [11.25772584]


portfolio before change:  [10.81784003]
curr_Stock_Price:  101.8219155572221
curr_Factors:  [1.01821916e+02 3.82673779e-02]
mat_Sqrt:  [[ 1.99184535e+01  0.00000000e+00]
 [-7.82481978e-03  1.79289145e-02]]
grads:  [7.88395087e-04 1.74983958e+00]
Stock Position:  0.0007883950872320199
Bond Position:  [10.73756414]


portfolio before change:  [10.81998332]
curr_Stock_Price:  102.83790687217088
curr_Factors:  [1.02837907e+02 3.84242985e-02]
mat_Sqrt:  [[ 2.01584067e+01  0.00000000e+00]
 [-7.84084674e-03  1.79656369e-02]]
grads:  [6.20239520e-03 8.17630554e+00]
Stock Position:  0.006202395200327951
Bond Position:  [10.18214198]


portfolio before change:  [10.82688147]
curr_Stock_Price:  103.74486374572008
curr_Factors:  [1.03744864e+02 3.70670414e-02]
mat_Sqrt:  [[ 1.99737940e+01  0.00000000e+00]
 [-7.70112110e-03  1.76454852e-02]]
grads:  [ 0.02050077 -0.76911892]
Stock Position:  0.020500765552170654
Bond Position:  [8.70003234]


portfolio before change:  [10.84282886]
curr_Stock_Price:  104.46970572336562
curr_Factors:  [1.04469706e+02 3.55713746e-02]
mat_Sqrt:  [[ 1.97033783e+01  0.00000000e+00]
 [-7.54415001e-03  1.72858192e-02]]
grads:  [-0.00623572  0.03086614]
Stock Position:  -0.006235723475115507
Bond Position:  [11.49427305]


portfolio before change:  [10.84033436]
curr_Stock_Price:  105.10016537286583
curr_Factors:  [1.05100165e+02 3.60413243e-02]
mat_Sqrt:  [[ 1.99527963e+01  0.00000000e+00]
 [-7.59382110e-03  1.73996300e-02]]
grads:  [ 1.92796559e-02 -2.65278903e+01]
Stock Position:  0.01927965593991985
Bond Position:  [8.81403933]


portfolio before change:  [10.81164453]
curr_Stock_Price:  103.55492779547056
curr_Factors:  [1.03554928e+02 3.61722227e-02]
mat_Sqrt:  [[ 1.96951081e+01  0.00000000e+00]
 [-7.60759860e-03  1.74311982e-02]]
grads:  [ 0.00288234 -0.56136845]
Stock Position:  0.0028823396284063177
Bond Position:  [10.51316406]


portfolio before change:  [10.81861062]
curr_Stock_Price:  105.51578705145799
curr_Factors:  [1.05515787e+02 3.39161460e-02]
mat_Sqrt:  [[ 1.94321427e+01  0.00000000e+00]
 [-7.36653471e-03  1.68788515e-02]]
grads:  [ -0.02469665 -12.95056269]
Stock Position:  -0.024696649810417973
Bond Position:  [13.42449707]


portfolio before change:  [10.82522197]
curr_Stock_Price:  105.3160360395616
curr_Factors:  [1.05316036e+02 3.34597110e-02]
mat_Sqrt:  [[ 1.92644049e+01  0.00000000e+00]
 [-7.31679832e-03  1.67648911e-02]]
grads:  [-3.23927098e-03  7.39163451e+00]
Stock Position:  -0.0032392709803257887
Bond Position:  [11.16636915]


portfolio before change:  [10.82644171]
curr_Stock_Price:  105.37041288912195
curr_Factors:  [1.05370413e+02 3.24375490e-02]
mat_Sqrt:  [[ 1.89776616e+01  0.00000000e+00]
 [-7.20417091e-03  1.65068293e-02]]
grads:  [-6.73453033e-02 -6.87297232e+01]
Stock Position:  -0.0673453032551586
Bond Position:  [17.92264412]


portfolio before change:  [10.90180331]
curr_Stock_Price:  104.2846485787877
curr_Factors:  [1.04284649e+02 3.20560177e-02]
mat_Sqrt:  [[ 1.86713262e+01  0.00000000e+00]
 [-7.16167776e-03  1.64094652e-02]]
grads:  [-6.47253478e-03 -1.36044544e+01]
Stock Position:  -0.006472534775322917
Bond Position:  [11.57678932]


portfolio before change:  [10.89503365]
curr_Stock_Price:  105.5541430239778
curr_Factors:  [1.05554143e+02 3.01066110e-02]
mat_Sqrt:  [[ 1.83149704e+01  0.00000000e+00]
 [-6.94050270e-03  1.59026895e-02]]
grads:  [-5.70441044e-03 -1.21368461e+01]
Stock Position:  -0.0057044104352047586
Bond Position:  [11.49715781]


portfolio before change:  [10.89653932]
curr_Stock_Price:  105.54214719428505
curr_Factors:  [1.05542147e+02 2.98133506e-02]
mat_Sqrt:  [[ 1.82234802e+01  0.00000000e+00]
 [-6.90661719e-03  1.58250480e-02]]
grads:  [9.38988639e-04 9.85153780e+00]
Stock Position:  0.0009389886385806772
Bond Position:  [10.79743644]


portfolio before change:  [10.89764084]
curr_Stock_Price:  105.27777326412999
curr_Factors:  [1.05277773e+02 3.04442856e-02]
mat_Sqrt:  [[ 1.83691721e+01  0.00000000e+00]
 [-6.97931636e-03  1.59916228e-02]]
grads:  [9.59705622e-03 9.64142364e+00]
Stock Position:  0.009597056223332075
Bond Position:  [9.88728413]


portfolio before change:  [10.90205156]
curr_Stock_Price:  105.6085760827083
curr_Factors:  [1.05608576e+02 3.06852261e-02]
mat_Sqrt:  [[ 1.84996644e+01  0.00000000e+00]
 [-7.00687960e-03  1.60547781e-02]]
grads:  [1.92046817e-03 2.82636713e+00]
Stock Position:  0.001920468166818521
Bond Position:  [10.69923365]


portfolio before change:  [10.90544577]
curr_Stock_Price:  106.67952389523086
curr_Factors:  [1.06679524e+02 3.14299530e-02]
mat_Sqrt:  [[ 1.89126739e+01  0.00000000e+00]
 [-7.09139794e-03  1.62484339e-02]]
grads:  [-0.00656491 -1.54975629]
Stock Position:  -0.006564907956440817
Bond Position:  [11.60578702]


portfolio before change:  [10.91058838]
curr_Stock_Price:  106.11716965230013
curr_Factors:  [1.06117170e+02 3.18796917e-02]
mat_Sqrt:  [[ 1.89470986e+01  0.00000000e+00]
 [-7.14195398e-03  1.63642724e-02]]
grads:  [2.03658194e-02 2.59258544e+01]
Stock Position:  0.020365819383680206
Bond Position:  [8.74942527]


portfolio before change:  [10.91385069]
curr_Stock_Price:  106.22364991605573
curr_Factors:  [1.06223650e+02 3.10588431e-02]
mat_Sqrt:  [[ 1.87203454e+01  0.00000000e+00]
 [-7.04940771e-03  1.61522222e-02]]
grads:  [4.14669547e-03 1.00973934e+01]
Stock Position:  0.004146695473200064
Bond Position:  [10.47337356]


portfolio before change:  [10.91157176]
curr_Stock_Price:  105.35833950402423
curr_Factors:  [1.05358340e+02 3.15641684e-02]
mat_Sqrt:  [[ 1.87182866e+01  0.00000000e+00]
 [-7.10652302e-03  1.62830898e-02]]
grads:  [-3.22706968e-03 -6.91099229e+00]
Stock Position:  -0.0032270696825831033
Bond Position:  [11.25157047]


portfolio before change:  [10.91784627]
curr_Stock_Price:  103.84985941130533
curr_Factors:  [1.03849859e+02 3.26382141e-02]
mat_Sqrt:  [[ 1.87615669e+01  0.00000000e+00]
 [-7.22641976e-03  1.65578078e-02]]
grads:  [8.10035207e-03 1.09900336e+01]
Stock Position:  0.008100352070819042
Bond Position:  [10.07662584]


portfolio before change:  [10.92645927]
curr_Stock_Price:  104.75764001493232
curr_Factors:  [1.04757640e+02 3.16948608e-02]
mat_Sqrt:  [[ 1.86500556e+01  0.00000000e+00]
 [-7.12122021e-03  1.63167653e-02]]
grads:  [6.29056743e-03 7.93055305e+00]
Stock Position:  0.006290567425512301
Bond Position:  [10.26747427]


portfolio before change:  [10.92994056]
curr_Stock_Price:  105.10701663375538
curr_Factors:  [1.05107017e+02 3.11684649e-02]
mat_Sqrt:  [[ 1.85562158e+01  0.00000000e+00]
 [-7.06183714e-03  1.61807016e-02]]
grads:  [ 2.80276653e-02 -3.60990221e+01]
Stock Position:  0.0280276653382214
Bond Position:  [7.98403627]


portfolio before change:  [10.97413236]
curr_Stock_Price:  106.64812738357753
curr_Factors:  [1.06648127e+02 3.11808854e-02]
mat_Sqrt:  [[ 1.88320438e+01  0.00000000e+00]
 [-7.06324406e-03  1.61839253e-02]]
grads:  [-1.45386852e-02  4.68763906e+01]
Stock Position:  -0.014538685180435999
Bond Position:  [12.52465591]


portfolio before change:  [10.98848502]
curr_Stock_Price:  105.76861331740096
curr_Factors:  [1.05768613e+02 3.16797836e-02]
mat_Sqrt:  [[ 1.88255604e+01  0.00000000e+00]
 [-7.11952623e-03  1.63128839e-02]]
grads:  [ 0.00656254 -0.69784358]
Stock Position:  0.0065625415485715466
Bond Position:  [10.2943741]


portfolio before change:  [10.98990098]
curr_Stock_Price:  105.7882835169815
curr_Factors:  [1.05788284e+02 3.21666926e-02]
mat_Sqrt:  [[ 1.89732083e+01  0.00000000e+00]
 [-7.17403012e-03  1.64377680e-02]]
grads:  [-0.00398306 -3.69855689]
Stock Position:  -0.003983058359991458
Bond Position:  [11.41126189]


portfolio before change:  [10.99199574]
curr_Stock_Price:  105.62050839006194
curr_Factors:  [1.05620508e+02 3.25298141e-02]
mat_Sqrt:  [[ 1.90497396e+01  0.00000000e+00]
 [-7.21440937e-03  1.65302885e-02]]
grads:  [-2.33458006e-03 -1.49069696e+01]
Stock Position:  -0.0023345800567832757
Bond Position:  [11.23857527]


portfolio before change:  [10.99703034]
curr_Stock_Price:  104.06575789145445
curr_Factors:  [1.04065758e+02 3.39938301e-02]
mat_Sqrt:  [[ 1.91870365e+01  0.00000000e+00]
 [-7.37496631e-03  1.68981707e-02]]
grads:  [-0.01083778 -4.81198224]
Stock Position:  -0.010837778263089284
Bond Position:  [12.12487195]


portfolio before change:  [11.00112422]
curr_Stock_Price:  103.82786976956037
curr_Factors:  [1.03827870e+02 3.49600616e-02]
mat_Sqrt:  [[ 1.94133301e+01  0.00000000e+00]
 [-7.47904396e-03  1.71366425e-02]]
grads:  [-0.00460754 -0.09544964]
Stock Position:  -0.004607539347858838
Bond Position:  [11.47951522]


portfolio before change:  [11.00088549]
curr_Stock_Price:  104.1911345276901
curr_Factors:  [1.04191135e+02 3.36715296e-02]
mat_Sqrt:  [[ 1.91188687e+01  0.00000000e+00]
 [-7.33992149e-03  1.68178729e-02]]
grads:  [ 0.0139653  11.43055636]
Stock Position:  0.013965296003561679
Bond Position:  [9.54582546]


portfolio before change:  [11.01417191]
curr_Stock_Price:  105.05707483170065
curr_Factors:  [1.05057075e+02 3.30200178e-02]
mat_Sqrt:  [[ 1.90903529e+01  0.00000000e+00]
 [-7.26856440e-03  1.66543733e-02]]
grads:  [0.01180318 2.19111696]
Stock Position:  0.011803176399346442
Bond Position:  [9.77416472]


portfolio before change:  [11.01917408]
curr_Stock_Price:  105.3773552862491
curr_Factors:  [1.05377355e+02 3.32871580e-02]
mat_Sqrt:  [[ 1.92258546e+01  0.00000000e+00]
 [-7.29790743e-03  1.67216066e-02]]
grads:  [ -0.01603973 -13.99357852]
Stock Position:  -0.01603972861446403
Bond Position:  [12.70939826]


portfolio before change:  [11.02119534]
curr_Stock_Price:  105.3503919013646
curr_Factors:  [1.05350392e+02 3.39384281e-02]
mat_Sqrt:  [[ 1.94080551e+01  0.00000000e+00]
 [-7.36895413e-03  1.68843950e-02]]
grads:  [ 3.60571129e-03 -1.07260025e+01]
Stock Position:  0.0036057112937931345
Bond Position:  [10.64133224]


portfolio before change:  [11.0217046]
curr_Stock_Price:  105.1227008571722
curr_Factors:  [1.05122701e+02 3.39261453e-02]
mat_Sqrt:  [[ 1.93626043e+01  0.00000000e+00]
 [-7.36762054e-03  1.68813394e-02]]
grads:  [-4.08694749e-03  1.22974146e+01]
Stock Position:  -0.004086947489447741
Bond Position:  [11.45133556]


portfolio before change:  [11.02237698]
curr_Stock_Price:  105.30844550656275
curr_Factors:  [1.05308446e+02 3.41458861e-02]
mat_Sqrt:  [[ 1.94595322e+01  0.00000000e+00]
 [-7.39144219e-03  1.69359217e-02]]
grads:  [-3.37466038e-03  7.15027119e+00]
Stock Position:  -0.003374660383879929
Bond Position:  [11.37775722]


portfolio before change:  [11.02522491]
curr_Stock_Price:  104.88599538697457
curr_Factors:  [1.04885995e+02 3.42823604e-02]
mat_Sqrt:  [[ 1.94201626e+01  0.00000000e+00]
 [-7.40619853e-03  1.69697327e-02]]
grads:  [-3.57551547e-03  7.77441222e+00]
Stock Position:  -0.003575515469027583
Bond Position:  [11.40024641]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.02613]
Stock Price:  105.03143767093867
PL:  [5.99469233]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.75452760e-02  2.82108959e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.56944680e-01 -7.83557288e-01]
 [-1.74150041e-02  2.14315123e-01]
 [ 1.76594185e-02 -9.90511525e-02]
 [-7.14245602e-02 -3.74535205e-02]
 [-1.35236627e-01  7.56917814e-02]
 [-1.08573662e-01 -1.00640866e-01]
 [ 1.66098716e-01  9.76572440e-02]
 [ 2.66772241e-01 -1.12446136e-01]
 [ 1.13276816e-01  1.74323863e-01]
 [ 1.86249585e-01  2.47857649e-01]
 [ 1.75660599e-01  3.12546154e-02]
 [-1.53215942e-01 -1.66091646e-01]
 [ 8.69923684e-02  2.30885284e-01]
 [ 5.07328794e-02 -7.02497867e-03]
 [ 3.49569508e-03 -4.23772561e-02]
 [ 7.77198735e-03  5.16111697e-02]
 [ 1.57580477e-02  4.45313490e-02]
 [ 1.40034644e-01 -1.02364311e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 7.64424506e-02  2.98990226e-01]
 [ 3.63705656e-02  3.03013306e-01]
 [-1.58832158e-02  1.49267695e-01]
 [ 3.31459006e-02  7.48832861e-02]
 [ 7.45434767e-01 -4.48826571e-01]
 [-3.34176244e-01  4.30738548e-01]
 [ 1.41075356e-01 -9.91231947e-03]
 [-5.05397329e-02 -5.91546976e-02]
 [ 9.24224140e-02 -1.78063930e-01]
 [ 3.25456133e-02 -9.06142595e-02]
 [ 3.02871937e-01 -2.93070155e-02]
 [ 3.24070180e-01  4.27150127e-01]
 [ 2.80837568e-01 -1.58674802e-04]
 [-1.14475835e-01 -2.54499379e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-3.08201131e-01  1.06751876e-01]
 [-1.12459346e-01  1.25185161e-01]
 [-3.01881608e-01  1.71207229e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.12251822]
curr_Stock_Price:  99.91184780461069
curr_Factors:  [9.99118478e+01 4.02789436e-02]
mat_Sqrt:  [[ 2.00519229e+01  0.00000000e+00]
 [-8.02784590e-03  1.83941058e-02]]
grads:  [7.01517357e-03 1.53369217e+01]
Stock Position:  0.007015173565148318
Bond Position:  [1.42161927]


portfolio before change:  [2.10961419]
curr_Stock_Price:  98.04706912118742
curr_Factors:  [9.80470691e+01 4.01622538e-02]
mat_Sqrt:  [[ 1.96491448e+01  0.00000000e+00]
 [-8.01620896e-03  1.83674422e-02]]
grads:  [-0.01033045 -4.79170531]
Stock Position:  -0.010330446931836268
Bond Position:  [3.12248423]


portfolio before change:  [2.10788288]
curr_Stock_Price:  98.25244642861173
curr_Factors:  [9.82524464e+01 3.91614362e-02]
mat_Sqrt:  [[ 1.94434209e+01  0.00000000e+00]
 [-7.91569946e-03  1.81371460e-02]]
grads:  [ 2.64856809e-02 -4.32017964e+01]
Stock Position:  0.026485680913923056
Bond Position:  [-0.49440006]


portfolio before change:  [2.08022887]
curr_Stock_Price:  97.21066820928323
curr_Factors:  [9.72106682e+01 3.89036965e-02]
mat_Sqrt:  [[ 1.91738516e+01  0.00000000e+00]
 [-7.88960800e-03  1.80773629e-02]]
grads:  [3.96997876e-03 1.18554417e+01]
Stock Position:  0.003969978758900178
Bond Position:  [1.69430459]


portfolio before change:  [2.07855251]
curr_Stock_Price:  96.73505646630801
curr_Factors:  [9.67350565e+01 3.96722775e-02]
mat_Sqrt:  [[ 1.92675927e+01  0.00000000e+00]
 [-7.96716035e-03  1.82550577e-02]]
grads:  [-1.32710137e-03 -5.42595670e+00]
Stock Position:  -0.0013271013654598525
Bond Position:  [2.20692973]


portfolio before change:  [2.08106793]
curr_Stock_Price:  95.04751503893125
curr_Factors:  [9.50475150e+01 4.01385224e-02]
mat_Sqrt:  [[ 1.90423901e+01  0.00000000e+00]
 [-8.01384027e-03  1.83620148e-02]]
grads:  [-0.00460922 -2.03972826]
Stock Position:  -0.004609222699093433
Bond Position:  [2.51916309]


portfolio before change:  [2.07636119]
curr_Stock_Price:  96.13699534344107
curr_Factors:  [9.61369953e+01 3.96829828e-02]
mat_Sqrt:  [[ 1.91510548e+01  0.00000000e+00]
 [-7.96823522e-03  1.82575205e-02]]
grads:  [-0.00533663  4.14578646]
Stock Position:  -0.00533662644774276
Bond Position:  [2.58940842]


portfolio before change:  [2.0665318]
curr_Stock_Price:  98.03952285369714
curr_Factors:  [9.80395229e+01 3.92114204e-02]
mat_Sqrt:  [[ 1.94136625e+01  0.00000000e+00]
 [-7.92074950e-03  1.81487171e-02]]
grads:  [-0.00785513 -5.54534327]
Stock Position:  -0.007855134855076445
Bond Position:  [2.83664548]


portfolio before change:  [2.06776392]
curr_Stock_Price:  97.92781061007895
curr_Factors:  [9.79278106e+01 3.98531948e-02]
mat_Sqrt:  [[ 1.95495883e+01  0.00000000e+00]
 [-7.98530599e-03  1.82966346e-02]]
grads:  [0.01067643 5.337443  ]
Stock Position:  0.01067643103049504
Bond Position:  [1.02224441]


portfolio before change:  [2.08832072]
curr_Stock_Price:  99.84127879053898
curr_Factors:  [9.98412788e+01 3.67099952e-02]
mat_Sqrt:  [[ 1.91294419e+01  0.00000000e+00]
 [-7.66394104e-03  1.75602950e-02]]
grads:  [ 0.01138019 -6.40343091]
Stock Position:  0.011380192138688239
Bond Position:  [0.95210778]


portfolio before change:  [2.0779877]
curr_Stock_Price:  98.9228374297546
curr_Factors:  [9.89228374e+01 3.78596604e-02]
mat_Sqrt:  [[ 1.92479695e+01  0.00000000e+00]
 [-7.78302362e-03  1.78331474e-02]]
grads:  [0.00983782 9.77527177]
Stock Position:  0.009837816256385565
Bond Position:  [1.104803]


portfolio before change:  [2.05889247]
curr_Stock_Price:  96.96779534480434
curr_Factors:  [9.69677953e+01 3.80395076e-02]
mat_Sqrt:  [[ 1.89123268e+01  0.00000000e+00]
 [-7.80148781e-03  1.78754542e-02]]
grads:  [ 0.01556781 13.86580986]
Stock Position:  0.015567811084862772
Bond Position:  [0.54931615]


portfolio before change:  [2.07607406]
curr_Stock_Price:  98.06704563803738
curr_Factors:  [9.80670456e+01 3.88940326e-02]
mat_Sqrt:  [[ 1.93403611e+01  0.00000000e+00]
 [-7.88862803e-03  1.80751175e-02]]
grads:  [0.00978789 1.72915143]
Stock Position:  0.0097878850751333
Bond Position:  [1.11620508]


portfolio before change:  [2.06423108]
curr_Stock_Price:  96.84282727209354
curr_Factors:  [9.68428273e+01 3.87151940e-02]
mat_Sqrt:  [[ 1.90549661e+01  0.00000000e+00]
 [-7.87047079e-03  1.80335141e-02]]
grads:  [-0.01184491 -9.21016534]
Stock Position:  -0.011844905852183887
Bond Position:  [3.21132525]


portfolio before change:  [2.05117593]
curr_Stock_Price:  97.97889287830286
curr_Factors:  [9.79788929e+01 3.78267145e-02]
mat_Sqrt:  [[ 1.90560042e+01  0.00000000e+00]
 [-7.77963645e-03  1.78253865e-02]]
grads:  [9.85300832e-03 1.29526103e+01]
Stock Position:  0.00985300831866944
Bond Position:  [1.08578909]


portfolio before change:  [2.05013923]
curr_Stock_Price:  97.8598999746999
curr_Factors:  [9.78599000e+01 3.80195508e-02]
mat_Sqrt:  [[ 1.90813131e+01  0.00000000e+00]
 [-7.79944109e-03  1.78707646e-02]]
grads:  [ 0.00249809 -0.39309894]
Stock Position:  0.002498094709140682
Bond Position:  [1.80567593]


portfolio before change:  [2.0504582]
curr_Stock_Price:  97.89722662229146
curr_Factors:  [9.78972266e+01 3.74074019e-02]
mat_Sqrt:  [[ 1.89342960e+01  0.00000000e+00]
 [-7.73639730e-03  1.77263131e-02]]
grads:  [-7.92173936e-04 -2.39064129e+00]
Stock Position:  -0.000792173935747307
Bond Position:  [2.12800983]


portfolio before change:  [2.05057297]
curr_Stock_Price:  98.08815463119107
curr_Factors:  [9.80881546e+01 3.53496179e-02]
mat_Sqrt:  [[ 1.84420386e+01  0.00000000e+00]
 [-7.52059762e-03  1.72318539e-02]]
grads:  [1.64281993e-03 2.99510255e+00]
Stock Position:  0.0016428199294694827
Bond Position:  [1.88943179]


portfolio before change:  [2.05053415]
curr_Stock_Price:  97.92075136094488
curr_Factors:  [9.79207514e+01 3.53556082e-02]
mat_Sqrt:  [[ 1.84121241e+01  0.00000000e+00]
 [-7.52123481e-03  1.72333139e-02]]
grads:  [1.91141020e-03 2.58402703e+00]
Stock Position:  0.0019114101974198748
Bond Position:  [1.86336742]


portfolio before change:  [2.05004459]
curr_Stock_Price:  97.54276039506568
curr_Factors:  [9.75427604e+01 3.52266677e-02]
mat_Sqrt:  [[ 1.83075750e+01  0.00000000e+00]
 [-7.50750746e-03  1.72018606e-02]]
grads:  [ 5.20872892e-03 -5.95076971e+00]
Stock Position:  0.005208728920368514
Bond Position:  [1.54197079]


portfolio before change:  [2.05464804]
curr_Stock_Price:  98.38955027878991
curr_Factors:  [9.83895503e+01 3.51384331e-02]
mat_Sqrt:  [[ 1.84433654e+01  0.00000000e+00]
 [-7.49809929e-03  1.71803038e-02]]
grads:  [ 0.00228421 -2.19891278]
Stock Position:  0.0022842149264000787
Bond Position:  [1.82990516]


portfolio before change:  [2.0558576]
curr_Stock_Price:  98.81893350685277
curr_Factors:  [9.88189335e+01 3.64953151e-02]
mat_Sqrt:  [[ 1.88781191e+01  0.00000000e+00]
 [-7.64149881e-03  1.75088734e-02]]
grads:  [1.09614990e-02 1.70764971e+01]
Stock Position:  0.01096149899222284
Bond Position:  [0.97265396]


portfolio before change:  [2.05820392]
curr_Stock_Price:  99.0218920732103
curr_Factors:  [9.90218921e+01 3.67226572e-02]
mat_Sqrt:  [[ 1.89757203e+01  0.00000000e+00]
 [-7.66526266e-03  1.75633232e-02]]
grads:  [8.88590324e-03 1.72526180e+01]
Stock Position:  0.008885903242250312
Bond Position:  [1.17830497]


portfolio before change:  [2.06902875]
curr_Stock_Price:  100.22351788854655
curr_Factors:  [1.00223518e+02 3.64667379e-02]
mat_Sqrt:  [[ 1.91389497e+01  0.00000000e+00]
 [-7.63850644e-03  1.75020170e-02]]
grads:  [2.57394203e-03 8.52859959e+00]
Stock Position:  0.0025739420344143933
Bond Position:  [1.81105922]


portfolio before change:  [2.07399451]
curr_Stock_Price:  102.06480664791405
curr_Factors:  [1.02064807e+02 3.52320981e-02]
mat_Sqrt:  [[ 1.91577839e+01  0.00000000e+00]
 [-7.50808610e-03  1.72031864e-02]]
grads:  [3.43607832e-03 4.35287302e+00]
Stock Position:  0.0034360783230636674
Bond Position:  [1.72329184]


portfolio before change:  [2.07919754]
curr_Stock_Price:  103.5163455873662
curr_Factors:  [1.03516346e+02 3.49347361e-02]
mat_Sqrt:  [[ 1.93480707e+01  0.00000000e+00]
 [-7.47633452e-03  1.71304344e-02]]
grads:  [  0.02840339 -26.20053645]
Stock Position:  0.0284033897116761
Bond Position:  [-0.86101757]


portfolio before change:  [2.0929772]
curr_Stock_Price:  104.00527644103722
curr_Factors:  [1.04005276e+02 3.43666525e-02]
mat_Sqrt:  [[ 1.92807529e+01  0.00000000e+00]
 [-7.41529798e-03  1.69905821e-02]]
grads:  [-7.58199280e-03  2.53516062e+01]
Stock Position:  -0.007581992796794849
Bond Position:  [2.88154446]


portfolio before change:  [2.08663808]
curr_Stock_Price:  104.88886134527853
curr_Factors:  [1.04888861e+02 3.50364071e-02]
mat_Sqrt:  [[ 1.96331124e+01  0.00000000e+00]
 [-7.48720585e-03  1.71553438e-02]]
grads:  [ 0.00696524 -0.57779778]
Stock Position:  0.006965236220026882
Bond Position:  [1.35606238]


portfolio before change:  [2.09748716]
curr_Stock_Price:  106.42212708591107
curr_Factors:  [1.06422127e+02 3.47336030e-02]
mat_Sqrt:  [[ 1.98338422e+01  0.00000000e+00]
 [-7.45478134e-03  1.70810499e-02]]
grads:  [-0.00384983 -3.46317691]
Stock Position:  -0.0038498319596397958
Bond Position:  [2.50719446]


portfolio before change:  [2.09365114]
curr_Stock_Price:  107.49994890748562
curr_Factors:  [1.07499949e+02 3.35418998e-02]
mat_Sqrt:  [[ 1.96880220e+01  0.00000000e+00]
 [-7.32577912e-03  1.67854687e-02]]
grads:  [ 7.47101134e-04 -1.06082192e+01]
Stock Position:  0.0007471011341578763
Bond Position:  [2.01333781]


portfolio before change:  [2.09517372]
curr_Stock_Price:  109.2010519524734
curr_Factors:  [1.09201052e+02 3.38556637e-02]
mat_Sqrt:  [[ 2.00928938e+01  0.00000000e+00]
 [-7.35996345e-03  1.68637948e-02]]
grads:  [-3.48466071e-04 -5.37330183e+00]
Stock Position:  -0.00034846607137422713
Bond Position:  [2.13322658]


portfolio before change:  [2.0951791]
curr_Stock_Price:  109.95088301755263
curr_Factors:  [1.09950883e+02 3.41986108e-02]
mat_Sqrt:  [[ 2.03330699e+01  0.00000000e+00]
 [-7.39714657e-03  1.69489920e-02]]
grads:  [ 0.01426648 -1.72913029]
Stock Position:  0.014266478584305537
Bond Position:  [0.52656718]


portfolio before change:  [2.08983008]
curr_Stock_Price:  109.5713327400498
curr_Factors:  [1.09571333e+02 3.54031148e-02]
mat_Sqrt:  [[ 2.06166302e+01  0.00000000e+00]
 [-7.52628618e-03  1.72448881e-02]]
grads:  [2.47612619e-02 2.47696666e+01]
Stock Position:  0.024761261907122467
Bond Position:  [-0.62329439]


portfolio before change:  [2.12080703]
curr_Stock_Price:  110.82550402657054
curr_Factors:  [1.10825504e+02 3.63896163e-02]
mat_Sqrt:  [[ 2.11411425e+01  0.00000000e+00]
 [-7.63042502e-03  1.74835001e-02]]
grads:  [ 0.01328066 -0.00907569]
Stock Position:  0.013280659576198749
Bond Position:  [0.64897124]


portfolio before change:  [2.1161723]
curr_Stock_Price:  110.47041225492327
curr_Factors:  [1.10470412e+02 3.54857060e-02]
mat_Sqrt:  [[ 2.08100297e+01  0.00000000e+00]
 [-7.53506003e-03  1.72649915e-02]]
grads:  [-1.08384502e-02 -1.47407764e+01]
Stock Position:  -0.01083845015739924
Bond Position:  [3.31350036]


portfolio before change:  [2.11804103]
curr_Stock_Price:  110.33621256407864
curr_Factors:  [1.10336213e+02 3.46568160e-02]
mat_Sqrt:  [[ 2.05405658e+01  0.00000000e+00]
 [-7.44653649e-03  1.70621586e-02]]
grads:  [ 0.00758867 -4.08368516]
Stock Position:  0.007588673485848895
Bond Position:  [1.28073554]


portfolio before change:  [2.12250425]
curr_Stock_Price:  110.9032568495011
curr_Factors:  [1.10903257e+02 3.49342702e-02]
mat_Sqrt:  [[ 2.07286079e+01  0.00000000e+00]
 [-7.47628465e-03  1.71303202e-02]]
grads:  [-0.01262076  6.23175021]
Stock Position:  -0.01262076032280882
Bond Position:  [3.52218767]


portfolio before change:  [2.12980048]
curr_Stock_Price:  110.36003020721877
curr_Factors:  [1.10360030e+02 3.49398513e-02]
mat_Sqrt:  [[ 2.06287226e+01  0.00000000e+00]
 [-7.47688184e-03  1.71316885e-02]]
grads:  [-2.80308497e-03  7.30722842e+00]
Stock Position:  -0.002803084969639947
Bond Position:  [2.43914902]


portfolio before change:  [2.12903153]
curr_Stock_Price:  110.74313015143755
curr_Factors:  [1.10743130e+02 3.40529891e-02]
mat_Sqrt:  [[ 2.04359304e+01  0.00000000e+00]
 [-7.38138080e-03  1.69128681e-02]]
grads:  [-0.01111575 10.1228974 ]
Stock Position:  -0.011115747751590856
Bond Position:  [3.36002423]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.11472291]
Stock Price:  112.06815601085734
PL:  [-9.9534331]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.46197404e-01  8.37065570e-01]
 [-1.75812542e-01 -7.92832512e-02]
 [ 7.50465883e-01 -6.36179100e-01]
 [ 5.55683942e-02  2.79080043e-02]
 [ 1.44582762e-02 -2.42640965e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-5.19190558e-03  3.18458150e-01]
 [ 1.62644223e-01 -2.09113568e-02]
 [ 1.55466701e-01  7.34914219e-02]
 [ 2.45488111e-01 -9.21251256e-02]
 [ 1.08424474e-01  1.57023388e-01]
 [ 1.53557287e-01  2.10189266e-01]
 [ 2.07756321e-01  2.43782168e-02]
 [-1.72419572e-01 -1.99471936e-01]
 [ 9.45910957e-02  2.36954259e-01]
 [ 4.40259056e-02  8.18392001e-02]
 [ 3.53021513e-02  3.45490555e-02]
 [ 7.51680704e-02  6.31786629e-02]
 [ 1.68573744e-02  1.68665321e-04]
 [ 1.22350020e-01 -1.01298618e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 6.83635713e-02  2.73744291e-01]
 [ 2.50306013e-02  1.42092586e-01]
 [-7.17824551e-02  7.87899524e-02]
 [ 4.39260514e-02  1.95135375e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 7.14667964e-02  1.69632070e-01]
 [-1.54279849e-01  7.88972528e-02]
 [-4.54818536e-01  9.07325266e-02]
 [ 2.59285144e-01 -1.06037060e-01]
 [-1.43564436e+00 -1.61482268e-01]
 [ 2.93841921e-01  5.43423818e-01]
 [-7.01027517e-03 -1.28463717e-01]
 [ 3.98516150e-02  8.33459949e-02]
 [-4.53856161e-02  1.64844372e-01]
 [-1.66697414e+00 -7.70743652e-02]
 [-8.33903343e-02  2.23910815e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.13941280e+00 -3.38366732e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.14717158]
curr_Stock_Price:  101.57233903984061
curr_Factors:  [1.01572339e+02 4.12960024e-02]
mat_Sqrt:  [[ 2.06409394e+01  0.00000000e+00]
 [-8.12856714e-03  1.86248871e-02]]
grads:  [3.93161742e-02 4.49433903e+01]
Stock Position:  0.0393161741521131
Bond Position:  [9.15373581]


portfolio before change:  [13.10284851]
curr_Stock_Price:  100.415884599533
curr_Factors:  [1.00415885e+02 4.19918448e-02]
mat_Sqrt:  [[ 2.05771345e+01  0.00000000e+00]
 [-8.19676471e-03  1.87811474e-02]]
grads:  [-0.01022565 -4.22142746]
Stock Position:  -0.010225650692419984
Bond Position:  [14.12966627]


portfolio before change:  [13.09830422]
curr_Stock_Price:  101.03301944610742
curr_Factors:  [1.01033019e+02 4.14336420e-02]
mat_Sqrt:  [[ 2.05655291e+01  0.00000000e+00]
 [-8.14210213e-03  1.86558997e-02]]
grads:  [ 2.29906345e-02 -3.41006926e+01]
Stock Position:  0.022990634454097842
Bond Position:  [10.775491]


portfolio before change:  [13.11827604]
curr_Stock_Price:  101.84312307252742
curr_Factors:  [1.01843123e+02 4.08704985e-02]
mat_Sqrt:  [[ 2.05890675e+01  0.00000000e+00]
 [-8.08658133e-03  1.85286855e-02]]
grads:  [0.00329051 1.5062053 ]
Stock Position:  0.0032905057974298257
Bond Position:  [12.78316065]


portfolio before change:  [13.11271862]
curr_Stock_Price:  99.66855901935216
curr_Factors:  [9.96685590e+01 4.36524063e-02]
mat_Sqrt:  [[ 2.08239098e+01  0.00000000e+00]
 [-8.35726332e-03  1.91488959e-02]]
grads:  [ 0.00064346 -0.12671277]
Stock Position:  0.0006434576581719753
Bond Position:  [13.04858612]


portfolio before change:  [13.11430064]
curr_Stock_Price:  99.59217342866964
curr_Factors:  [9.95921734e+01 4.32972081e-02]
mat_Sqrt:  [[ 2.07231207e+01  0.00000000e+00]
 [-8.32319248e-03  1.90708298e-02]]
grads:  [-0.00571443 -3.47740129]
Stock Position:  -0.0057144275359458305
Bond Position:  [13.6834129]


portfolio before change:  [13.11059976]
curr_Stock_Price:  100.53914734061499
curr_Factors:  [1.00539147e+02 4.40615741e-02]
mat_Sqrt:  [[ 2.11040206e+01  0.00000000e+00]
 [-8.39633959e-03  1.92384309e-02]]
grads:  [6.33976949e-03 1.65532289e+01]
Stock Position:  0.006339769488890524
Bond Position:  [12.47320474]


portfolio before change:  [13.11066992]
curr_Stock_Price:  100.30426637073437
curr_Factors:  [1.00304266e+02 4.25771847e-02]
mat_Sqrt:  [[ 2.06970227e+01  0.00000000e+00]
 [-8.25369587e-03  1.89115930e-02]]
grads:  [ 0.00741738 -1.10574274]
Stock Position:  0.007417383665634316
Bond Position:  [12.36667469]


portfolio before change:  [13.10942253]
curr_Stock_Price:  99.9276747518344
curr_Factors:  [9.99276748e+01 4.19345600e-02]
mat_Sqrt:  [[ 2.04631189e+01  0.00000000e+00]
 [-8.19117184e-03  1.87683325e-02]]
grads:  [0.00916483 3.91571398]
Stock Position:  0.00916482907529429
Bond Position:  [12.19360247]


portfolio before change:  [13.10669626]
curr_Stock_Price:  99.46388418096548
curr_Factors:  [9.94638842e+01 4.16359544e-02]
mat_Sqrt:  [[ 2.02954964e+01  0.00000000e+00]
 [-8.16195608e-03  1.87013908e-02]]
grads:  [ 0.01011463 -4.92611093]
Stock Position:  0.01011462868926809
Bond Position:  [12.100656]


portfolio before change:  [13.10519947]
curr_Stock_Price:  99.16634838478406
curr_Factors:  [9.91663484e+01 4.23860499e-02]
mat_Sqrt:  [[ 2.04162415e+01  0.00000000e+00]
 [-8.23514905e-03  1.88690969e-02]]
grads:  [0.00866737 8.32172249]
Stock Position:  0.008667369035318331
Bond Position:  [12.24568813]


portfolio before change:  [13.0961883]
curr_Stock_Price:  97.95006517956904
curr_Factors:  [9.79500652e+01 4.12883440e-02]
mat_Sqrt:  [[ 1.99029963e+01  0.00000000e+00]
 [-8.12781338e-03  1.86231600e-02]]
grads:  [ 0.01232435 11.28644473]
Stock Position:  0.012324345543983015
Bond Position:  [11.88901785]


portfolio before change:  [13.08428702]
curr_Stock_Price:  96.86380007649178
curr_Factors:  [9.68638001e+01 3.95980500e-02]
mat_Sqrt:  [[ 1.92751782e+01  0.00000000e+00]
 [-7.95970351e-03  1.82379719e-02]]
grads:  [0.01133042 1.33667366]
Stock Position:  0.011330419056862991
Bond Position:  [11.98677957]


portfolio before change:  [13.08919822]
curr_Stock_Price:  97.16500346276406
curr_Factors:  [9.71650035e+01 3.81420020e-02]
mat_Sqrt:  [[ 1.89763033e+01  0.00000000e+00]
 [-7.81199099e-03  1.78995200e-02]]
grads:  [ -0.0136737  -11.14398239]
Stock Position:  -0.013673699156591244
Bond Position:  [14.41780324]


portfolio before change:  [13.1076001]
curr_Stock_Price:  95.95102750758717
curr_Factors:  [9.59510275e+01 3.99282892e-02]
mat_Sqrt:  [[ 1.91729960e+01  0.00000000e+00]
 [-7.99282571e-03  1.83138644e-02]]
grads:  [1.03273590e-02 1.29385177e+01]
Stock Position:  0.010327359006673458
Bond Position:  [12.11667939]


portfolio before change:  [13.11108114]
curr_Stock_Price:  96.14143067521519
curr_Factors:  [9.61414307e+01 3.84511828e-02]
mat_Sqrt:  [[ 1.88523473e+01  0.00000000e+00]
 [-7.84358925e-03  1.79719207e-02]]
grads:  [4.22989559e-03 4.55372585e+00]
Stock Position:  0.004229895592146688
Bond Position:  [12.70441293]


portfolio before change:  [13.11416627]
curr_Stock_Price:  96.49533454011227
curr_Factors:  [9.64953345e+01 3.84053892e-02]
mat_Sqrt:  [[ 1.89104734e+01  0.00000000e+00]
 [-7.83891719e-03  1.79612157e-02]]
grads:  [0.00266416 1.92353659]
Stock Position:  0.0026641636200291307
Bond Position:  [12.85708691]


portfolio before change:  [13.11465668]
curr_Stock_Price:  96.07613095107511
curr_Factors:  [9.6076131e+01 3.7335250e-02]
mat_Sqrt:  [[ 1.85641486e+01  0.00000000e+00]
 [-7.72893265e-03  1.77092095e-02]]
grads:  [0.0055344  3.56755975]
Stock Position:  0.005534404052753396
Bond Position:  [12.58293255]


portfolio before change:  [13.11228825]
curr_Stock_Price:  95.36396859542577
curr_Factors:  [9.53639686e+01 3.81757434e-02]
mat_Sqrt:  [[ 1.86327976e+01  0.00000000e+00]
 [-7.81544557e-03  1.79074355e-02]]
grads:  [0.00090867 0.00941873]
Stock Position:  0.0009086658018110324
Bond Position:  [13.02563427]


portfolio before change:  [13.1161224]
curr_Stock_Price:  97.79153183335515
curr_Factors:  [9.77915318e+01 3.85866613e-02]
mat_Sqrt:  [[ 1.92096676e+01  0.00000000e+00]
 [-7.85739512e-03  1.80035540e-02]]
grads:  [ 4.06772672e-03 -5.62659006e+00]
Stock Position:  0.004067726723102355
Bond Position:  [12.71833317]


portfolio before change:  [13.11771068]
curr_Stock_Price:  97.79113654185055
curr_Factors:  [9.77911365e+01 3.94566480e-02]
mat_Sqrt:  [[ 1.94249356e+01  0.00000000e+00]
 [-7.94547902e-03  1.82053795e-02]]
grads:  [ 0.00216879 -2.07510036]
Stock Position:  0.002168790234284719
Bond Position:  [12.90562222]


portfolio before change:  [13.12023486]
curr_Stock_Price:  98.21113093688322
curr_Factors:  [9.82111309e+01 3.91060988e-02]
mat_Sqrt:  [[ 1.94215085e+01  0.00000000e+00]
 [-7.91010481e-03  1.81243270e-02]]
grads:  [9.67151314e-03 1.51036941e+01]
Stock Position:  0.00967151314045938
Bond Position:  [12.17038462]


portfolio before change:  [13.10293183]
curr_Stock_Price:  96.26475189540227
curr_Factors:  [9.62647519e+01 4.10021915e-02]
mat_Sqrt:  [[ 1.94926476e+01  0.00000000e+00]
 [-8.09959915e-03  1.85585131e-02]]
grads:  [4.46552423e-03 7.65646394e+00]
Stock Position:  0.004465524234857558
Bond Position:  [12.67305924]


portfolio before change:  [13.10466096]
curr_Stock_Price:  96.29720088877389
curr_Factors:  [9.62972009e+01 3.97261101e-02]
mat_Sqrt:  [[ 1.91933898e+01  0.00000000e+00]
 [-7.97256396e-03  1.82674389e-02]]
grads:  [-1.94836353e-03  4.31313622e+00]
Stock Position:  -0.0019483635250769293
Bond Position:  [13.29228291]


portfolio before change:  [13.11467584]
curr_Stock_Price:  92.00988874816497
curr_Factors:  [9.20098887e+01 4.10293464e-02]
mat_Sqrt:  [[ 1.86372489e+01  0.00000000e+00]
 [-8.10228080e-03  1.85646575e-02]]
grads:  [6.92645743e-03 1.05111217e+01]
Stock Position:  0.006926457428875676
Bond Position:  [12.47737326]


portfolio before change:  [13.11897327]
curr_Stock_Price:  92.40513537993506
curr_Factors:  [9.24051354e+01 4.26459943e-02]
mat_Sqrt:  [[ 1.90824982e+01  0.00000000e+00]
 [-8.26036263e-03  1.89268685e-02]]
grads:  [6.57590214e-03 9.61957968e+00]
Stock Position:  0.006575902140430669
Bond Position:  [12.51132614]


portfolio before change:  [13.12047625]
curr_Stock_Price:  92.39585471932538
curr_Factors:  [9.23958547e+01 4.26144456e-02]
mat_Sqrt:  [[ 1.90735226e+01  0.00000000e+00]
 [-8.25730664e-03  1.89198663e-02]]
grads:  [7.62839170e-03 8.96581758e+00]
Stock Position:  0.0076283916965391345
Bond Position:  [12.41564448]


portfolio before change:  [13.12280374]
curr_Stock_Price:  92.49750516615767
curr_Factors:  [9.24975052e+01 4.31921440e-02]
mat_Sqrt:  [[ 1.92234973e+01  0.00000000e+00]
 [-8.31308790e-03  1.90476773e-02]]
grads:  [-0.00623436  4.14209311]
Stock Position:  -0.00623436323859378
Bond Position:  [13.69946678]


portfolio before change:  [13.1251578]
curr_Stock_Price:  92.39460457542069
curr_Factors:  [9.23946046e+01 4.15064227e-02]
mat_Sqrt:  [[ 1.88236684e+01  0.00000000e+00]
 [-8.14925005e-03  1.86722776e-02]]
grads:  [-0.02205838  4.85921046]
Stock Position:  -0.022058379180222836
Bond Position:  [15.16323302]


portfolio before change:  [13.13133479]
curr_Stock_Price:  92.20050748319495
curr_Factors:  [9.22005075e+01 3.99594840e-02]
mat_Sqrt:  [[ 1.84307601e+01  0.00000000e+00]
 [-7.99594738e-03  1.83210171e-02]]
grads:  [ 0.01155713 -5.78772782]
Stock Position:  0.011557134641453899
Bond Position:  [12.06576111]


portfolio before change:  [13.13399133]
curr_Stock_Price:  92.29985959269814
curr_Factors:  [9.22998596e+01 4.20200731e-02]
mat_Sqrt:  [[ 1.89203620e+01  0.00000000e+00]
 [-8.19951932e-03  1.87874590e-02]]
grads:  [-0.07960318 -8.59521603]
Stock Position:  -0.07960318095567208
Bond Position:  [20.48135375]


portfolio before change:  [13.20217053]
curr_Stock_Price:  91.47553477169825
curr_Factors:  [9.14755348e+01 4.17417074e-02]
mat_Sqrt:  [[ 1.86891720e+01  0.00000000e+00]
 [-8.17231496e-03  1.87251260e-02]]
grads:  [2.84127899e-02 2.90211035e+01]
Stock Position:  0.028412789924287408
Bond Position:  [10.60309538]


portfolio before change:  [13.26262773]
curr_Stock_Price:  93.55670064860382
curr_Factors:  [9.35567006e+01 3.94600579e-02]
mat_Sqrt:  [[ 1.85846230e+01  0.00000000e+00]
 [-7.94582234e-03  1.82061662e-02]]
grads:  [-3.39401221e-03 -7.05605537e+00]
Stock Position:  -0.0033940122117438773
Bond Position:  [13.58016032]


portfolio before change:  [13.25800666]
curr_Stock_Price:  95.4184213936847
curr_Factors:  [9.54184214e+01 3.92995317e-02]
mat_Sqrt:  [[ 1.89158523e+01  0.00000000e+00]
 [-7.92964380e-03  1.81690965e-02]]
grads:  [4.02978348e-03 4.58723938e+00]
Stock Position:  0.004029783479960164
Bond Position:  [12.87349108]


portfolio before change:  [13.25558227]
curr_Stock_Price:  94.41745533999834
curr_Factors:  [9.44174553e+01 4.00010007e-02]
mat_Sqrt:  [[ 1.88837273e+01  0.00000000e+00]
 [-8.00010007e-03  1.83305321e-02]]
grads:  [1.40641547e-03 8.99288531e+00]
Stock Position:  0.0014064154742866985
Bond Position:  [13.1227921]


portfolio before change:  [13.25637071]
curr_Stock_Price:  93.81165399024457
curr_Factors:  [9.38116540e+01 3.92213372e-02]
mat_Sqrt:  [[ 1.85788142e+01  0.00000000e+00]
 [-7.92175104e-03  1.81510119e-02]]
grads:  [-0.09153502 -4.24628476]
Stock Position:  -0.091535021049185
Bond Position:  [21.84342243]


portfolio before change:  [13.25241352]
curr_Stock_Price:  93.88471664837577
curr_Factors:  [9.38847166e+01 3.78965710e-02]
mat_Sqrt:  [[ 1.82765769e+01  0.00000000e+00]
 [-7.78681666e-03  1.78418384e-02]]
grads:  [7.84192641e-04 1.25497614e+01]
Stock Position:  0.0007841926408162066
Bond Position:  [13.17878981]


portfolio before change:  [13.25435713]
curr_Stock_Price:  94.26238346215615
curr_Factors:  [9.42623835e+01 3.67042176e-02]
mat_Sqrt:  [[ 1.80591124e+01  0.00000000e+00]
 [-7.66333792e-03  1.75589131e-02]]
grads:  [-4.88314227e-03  6.22827644e+00]
Stock Position:  -0.004883142270176915
Bond Position:  [13.71465376]


portfolio before change:  [13.25660145]
curr_Stock_Price:  94.15387116082036
curr_Factors:  [9.41538712e+01 3.71690179e-02]
mat_Sqrt:  [[ 1.81521773e+01  0.00000000e+00]
 [-7.71170724e-03  1.76697411e-02]]
grads:  [ 0.06195649 -1.91495014]
Stock Position:  0.06195649425017002
Bond Position:  [7.42315767]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.21979121]
Stock Price:  93.54476318051272
PL:  [13.21979121]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.09223769e-01  8.16599993e-03]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.25697953e-01 -7.12955518e-01]
 [-3.05176989e-02  1.53008032e-01]
 [ 1.76445160e-02 -9.90928569e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [ 1.83452805e-02  2.96343210e-01]
 [ 2.16952630e-01 -2.08979300e-03]
 [ 1.40271450e-01  7.83239979e-02]
 [ 2.44196252e-01 -9.09153497e-02]
 [ 6.81568016e-02  1.47924320e-02]
 [-1.29155809e-01 -1.91668350e-01]
 [-1.46924237e-01  1.50558710e-01]
 [-3.77685458e-01 -4.99119781e-01]
 [ 7.45763705e-02  2.16360694e-01]
 [ 5.34458808e-02 -2.00512132e-02]
 [-5.21207476e-02  2.22884086e-01]
 [-1.47159298e-02  4.42943974e-02]
 [ 1.50925379e-02  6.10560577e-02]
 [-1.18539935e-02 -8.60839799e-02]
 [ 1.30014888e-01  3.58680031e-02]
 [ 5.51178999e-02  2.87375593e-01]
 [ 3.76812869e-02  3.78558671e-01]
 [-4.37625347e-02  1.34749049e-01]
 [ 3.09757128e-02  7.54230701e-02]
 [ 2.92276281e-01 -2.00080304e-02]
 [ 8.08379244e-02  1.91674851e-01]
 [-1.92138735e-01  1.39938406e-01]
 [-7.01913058e-02 -1.02403597e-01]
 [ 7.18311176e-02 -6.31095938e-02]
 [-9.26284015e-01 -1.08472784e-01]
 [-1.23086723e-01  5.56824743e-02]
 [-8.26150431e-03 -1.18758134e-01]
 [ 5.48823374e-02  8.29852432e-02]
 [-3.56523405e-02  1.67701533e-01]
 [-1.42836317e+00 -1.23909603e-01]
 [-9.87627174e-02  1.78940516e-01]
 [-1.35680116e-01  8.90939720e-02]
 [ 1.18506243e+00 -3.98458196e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.07279271]
curr_Stock_Price:  99.12934989040572
curr_Factors:  [9.91293499e+01 3.97020854e-02]
mat_Sqrt:  [[ 1.97519018e+01  0.00000000e+00]
 [-7.97015286e-03  1.82619144e-02]]
grads:  [-0.01041215  0.44716013]
Stock Position:  -0.010412153533314018
Bond Position:  [-2.0406427]


portfolio before change:  [-3.06766201]
curr_Stock_Price:  98.61208981350016
curr_Factors:  [9.86120898e+01 4.03483796e-02]
mat_Sqrt:  [[ 1.98081179e+01  0.00000000e+00]
 [-8.03476244e-03  1.84099535e-02]]
grads:  [-0.01024754 -4.78064054]
Stock Position:  -0.01024753837356904
Bond Position:  [-2.05713084]


portfolio before change:  [-3.07555376]
curr_Stock_Price:  99.35710694643429
curr_Factors:  [9.93571069e+01 3.91893246e-02]
mat_Sqrt:  [[ 1.96690247e+01  0.00000000e+00]
 [-7.91851750e-03  1.81436029e-02]]
grads:  [ 2.61598459e-02 -3.92951456e+01]
Stock Position:  0.02615984587381148
Bond Position:  [-5.67472037]


portfolio before change:  [-3.10884912]
curr_Stock_Price:  98.11145851280108
curr_Factors:  [9.81114585e+01 4.21159040e-02]
mat_Sqrt:  [[ 2.01345902e+01  0.00000000e+00]
 [-8.20886389e-03  1.88088701e-02]]
grads:  [1.80090483e-03 8.13488695e+00]
Stock Position:  0.001800904830626858
Bond Position:  [-3.28553852]


portfolio before change:  [-3.1117405]
curr_Stock_Price:  96.73400304583784
curr_Factors:  [9.67340030e+01 4.37479849e-02]
mat_Sqrt:  [[ 2.02329024e+01  0.00000000e+00]
 [-8.36640759e-03  1.91698480e-02]]
grads:  [-1.26542163e-03 -5.16920410e+00]
Stock Position:  -0.0012654216309394906
Bond Position:  [-2.9893312]


portfolio before change:  [-3.11576045]
curr_Stock_Price:  99.61545541840039
curr_Factors:  [9.96154554e+01 4.25644902e-02]
mat_Sqrt:  [[ 2.05518274e+01  0.00000000e+00]
 [-8.25246535e-03  1.89087736e-02]]
grads:  [-0.00576206 -3.50720409]
Stock Position:  -0.005762055589815341
Bond Position:  [-2.54177065]


portfolio before change:  [-3.12838346]
curr_Stock_Price:  101.75102541847824
curr_Factors:  [1.01751025e+02 4.08629472e-02]
mat_Sqrt:  [[ 2.05685482e+01  0.00000000e+00]
 [-8.08583425e-03  1.85269738e-02]]
grads:  [7.17989716e-03 1.59952302e+01]
Stock Position:  0.007179897158596619
Bond Position:  [-3.85894536]


portfolio before change:  [-3.1343745]
curr_Stock_Price:  100.98379440986784
curr_Factors:  [1.00983794e+02 4.04250022e-02]
mat_Sqrt:  [[ 2.03037712e+01  0.00000000e+00]
 [-8.04238793e-03  1.84274257e-02]]
grads:  [ 0.01064042 -0.11340667]
Stock Position:  0.01064041586020272
Bond Position:  [-4.20888407]


portfolio before change:  [-3.13827228]
curr_Stock_Price:  100.66692331488457
curr_Factors:  [1.00666923e+02 4.03507989e-02]
mat_Sqrt:  [[ 2.02214766e+01  0.00000000e+00]
 [-8.03500332e-03  1.84105055e-02]]
grads:  [0.00862721 4.25431003]
Stock Position:  0.00862720604473209
Bond Position:  [-4.00674657]


portfolio before change:  [-3.14923301]
curr_Stock_Price:  99.4544964675997
curr_Factors:  [9.94544965e+01 4.03791098e-02]
mat_Sqrt:  [[ 1.99849374e+01  0.00000000e+00]
 [-8.03782157e-03  1.84169629e-02]]
grads:  [ 0.01023358 -4.93650067]
Stock Position:  0.010233584228476257
Bond Position:  [-4.16700898]


portfolio before change:  [-3.13235569]
curr_Stock_Price:  101.1546076371644
curr_Factors:  [1.01154608e+02 3.86550551e-02]
mat_Sqrt:  [[ 1.98878950e+01  0.00000000e+00]
 [-7.86435554e-03  1.80195023e-02]]
grads:  [0.00375167 0.82091235]
Stock Position:  0.0037516664405531997
Bond Position:  [-3.51185404]


portfolio before change:  [-3.12922676]
curr_Stock_Price:  102.10563613692227
curr_Factors:  [1.02105636e+02 3.90769316e-02]
mat_Sqrt:  [[ 2.01841257e+01  0.00000000e+00]
 [-7.90715439e-03  1.81175668e-02]]
grads:  [-1.05432724e-02 -1.05791442e+01]
Stock Position:  -0.010543272360944003
Bond Position:  [-2.05269923]


portfolio before change:  [-3.12249242]
curr_Stock_Price:  101.442564951443
curr_Factors:  [1.01442565e+02 3.90261689e-02]
mat_Sqrt:  [[ 2.00400214e+01  0.00000000e+00]
 [-7.90201684e-03  1.81057952e-02]]
grads:  [-4.05264182e-03  8.31549834e+00]
Stock Position:  -0.00405264181687532
Bond Position:  [-2.71138204]


portfolio before change:  [-3.11753825]
curr_Stock_Price:  100.13647470207383
curr_Factors:  [1.00136475e+02 4.07723716e-02]
mat_Sqrt:  [[ 2.02197269e+01  0.00000000e+00]
 [-8.07686787e-03  1.85064292e-02]]
grads:  [ -0.02945239 -26.97007487]
Stock Position:  -0.02945238543100134
Bond Position:  [-0.1682802]


portfolio before change:  [-3.14152508]
curr_Stock_Price:  100.95018797230514
curr_Factors:  [1.00950188e+02 4.10282626e-02]
mat_Sqrt:  [[ 2.04478992e+01  0.00000000e+00]
 [-8.10217379e-03  1.85644124e-02]]
grads:  [8.26509937e-03 1.16545943e+01]
Stock Position:  0.008265099374224092
Bond Position:  [-3.97588842]


portfolio before change:  [-3.14924727]
curr_Stock_Price:  100.07600970383893
curr_Factors:  [1.00076010e+02 4.29197318e-02]
mat_Sqrt:  [[ 2.07328249e+01  0.00000000e+00]
 [-8.28683117e-03  1.89875156e-02]]
grads:  [ 0.00215575 -1.05602089]
Stock Position:  0.002155751282771693
Bond Position:  [-3.36498626]


portfolio before change:  [-3.14937476]
curr_Stock_Price:  100.21199990570301
curr_Factors:  [1.00212000e+02 4.09902549e-02]
mat_Sqrt:  [[ 2.02889718e+01  0.00000000e+00]
 [-8.09842008e-03  1.85558115e-02]]
grads:  [2.22553626e-03 1.20115515e+01]
Stock Position:  0.0022255362612701893
Bond Position:  [-3.3724002]


portfolio before change:  [-3.15326366]
curr_Stock_Price:  98.65402659107576
curr_Factors:  [9.86540266e+01 4.26085023e-02]
mat_Sqrt:  [[ 2.03639935e+01  0.00000000e+00]
 [-8.25673081e-03  1.89185470e-02]]
grads:  [2.26661341e-04 2.34132132e+00]
Stock Position:  0.00022666134071092444
Bond Position:  [-3.17562471]


portfolio before change:  [-3.15332185]
curr_Stock_Price:  100.14870991667725
curr_Factors:  [1.00148710e+02 4.27153001e-02]
mat_Sqrt:  [[ 2.06984150e+01  0.00000000e+00]
 [-8.26707205e-03  1.89422417e-02]]
grads:  [2.01655953e-03 3.22327519e+00]
Stock Position:  0.0020165595321610364
Bond Position:  [-3.35527769]


portfolio before change:  [-3.15404683]
curr_Stock_Price:  99.99719451013023
curr_Factors:  [9.99971945e+01 4.34334994e-02]
mat_Sqrt:  [[ 2.08401205e+01  0.00000000e+00]
 [-8.33628208e-03  1.91008218e-02]]
grads:  [-2.37158525e-03 -4.50682073e+00]
Stock Position:  -0.002371585250286571
Bond Position:  [-2.91689496]


portfolio before change:  [-3.15535318]
curr_Stock_Price:  100.3942790560045
curr_Factors:  [1.00394279e+02 4.53245060e-02]
mat_Sqrt:  [[ 2.13734931e+01  0.00000000e+00]
 [-8.51582113e-03  1.95121975e-02]]
grads:  [0.0068154  1.83823494]
Stock Position:  0.0068154029494427735
Bond Position:  [-3.83958065]


portfolio before change:  [-3.15520058]
curr_Stock_Price:  100.48709444598394
curr_Factors:  [1.00487094e+02 4.55165090e-02]
mat_Sqrt:  [[ 2.14385181e+01  0.00000000e+00]
 [-8.53383937e-03  1.95534824e-02]]
grads:  [8.42123931e-03 1.46969009e+01]
Stock Position:  0.008421239312291473
Bond Position:  [-4.00142645]


portfolio before change:  [-3.15619691]
curr_Stock_Price:  100.42818229417593
curr_Factors:  [1.00428182e+02 4.69466101e-02]
mat_Sqrt:  [[ 2.17599414e+01  0.00000000e+00]
 [-8.66686657e-03  1.98582860e-02]]
grads:  [9.32437420e-03 1.90630083e+01]
Stock Position:  0.009324374197276919
Bond Position:  [-4.09262686]


portfolio before change:  [-3.16628097]
curr_Stock_Price:  99.40157671809291
curr_Factors:  [9.94015767e+01 4.84192057e-02]
mat_Sqrt:  [[ 2.18726853e+01  0.00000000e+00]
 [-8.80174580e-03  2.01673332e-02]]
grads:  [6.87925205e-04 6.68155017e+00]
Stock Position:  0.0006879252046047133
Bond Position:  [-3.23466182]


portfolio before change:  [-3.16739548]
curr_Stock_Price:  98.36927389102833
curr_Factors:  [9.83692739e+01 4.89596127e-02]
mat_Sqrt:  [[ 2.17659914e+01  0.00000000e+00]
 [-8.85072767e-03  2.02795648e-02]]
grads:  [2.93545275e-03 3.71916612e+00]
Stock Position:  0.0029354527533026835
Bond Position:  [-3.45615383]


portfolio before change:  [-3.169477]
curr_Stock_Price:  97.80735717947978
curr_Factors:  [9.78073572e+01 4.97632117e-02]
mat_Sqrt:  [[ 2.18185420e+01  0.00000000e+00]
 [-8.92306779e-03  2.04453168e-02]]
grads:  [ 0.01299555 -0.97861191]
Stock Position:  0.012995554935395389
Bond Position:  [-4.44053789]


portfolio before change:  [-3.18065121]
curr_Stock_Price:  96.9902233387947
curr_Factors:  [9.69902233e+01 5.19903617e-02]
mat_Sqrt:  [[ 2.21151240e+01  0.00000000e+00]
 [-9.12055803e-03  2.08978238e-02]]
grads:  [7.43797266e-03 9.17200056e+00]
Stock Position:  0.0074379726622832544
Bond Position:  [-3.90206184]


portfolio before change:  [-3.17416142]
curr_Stock_Price:  97.92832632241378
curr_Factors:  [9.79283263e+01 5.02612199e-02]
mat_Sqrt:  [[ 2.19545654e+01  0.00000000e+00]
 [-8.96760569e-03  2.05473659e-02]]
grads:  [-5.96981105e-03  6.81052777e+00]
Stock Position:  -0.0059698110535060375
Bond Position:  [-2.58954781]


portfolio before change:  [-3.17713534]
curr_Stock_Price:  98.37226222131866
curr_Factors:  [9.83722622e+01 5.10091555e-02]
mat_Sqrt:  [[ 2.22175786e+01  0.00000000e+00]
 [-9.03408262e-03  2.06996837e-02]]
grads:  [-0.00517086 -4.94710928]
Stock Position:  -0.005170856002418158
Bond Position:  [-2.66846654]


portfolio before change:  [-3.17663368]
curr_Stock_Price:  98.21073344320678
curr_Factors:  [9.82107334e+01 5.14308820e-02]
mat_Sqrt:  [[ 2.22726012e+01  0.00000000e+00]
 [-9.07135113e-03  2.07850766e-02]]
grads:  [ 1.98844457e-03 -3.03629354e+00]
Stock Position:  0.0019884445665454597
Bond Position:  [-3.37192028]


portfolio before change:  [-3.17891413]
curr_Stock_Price:  97.27586679706295
curr_Factors:  [9.72758668e+01 5.23131944e-02]
mat_Sqrt:  [[ 2.22490120e+01  0.00000000e+00]
 [-9.14883113e-03  2.09626056e-02]]
grads:  [-0.04376039 -5.17458497]
Stock Position:  -0.043760389042425844
Bond Position:  [1.07791565]


portfolio before change:  [-3.1609256]
curr_Stock_Price:  96.86787731228124
curr_Factors:  [9.68678773e+01 5.13176989e-02]
mat_Sqrt:  [[ 2.19438775e+01  0.00000000e+00]
 [-9.06136404e-03  2.07621933e-02]]
grads:  [-0.00450171  2.68191677]
Stock Position:  -0.0045017066466143865
Bond Position:  [-2.72485483]


portfolio before change:  [-3.15691193]
curr_Stock_Price:  95.90062135153849
curr_Factors:  [9.59006214e+01 5.16760742e-02]
mat_Sqrt:  [[ 2.18004861e+01  0.00000000e+00]
 [-9.09294885e-03  2.08345632e-02]]
grads:  [-2.75644327e-03 -5.70005394e+00]
Stock Position:  -0.002756443269855475
Bond Position:  [-2.89256731]


portfolio before change:  [-3.15648921]
curr_Stock_Price:  95.61608543971391
curr_Factors:  [9.56160854e+01 5.10568414e-02]
mat_Sqrt:  [[ 2.16051821e+01  0.00000000e+00]
 [-9.03830439e-03  2.07093570e-02]]
grads:  [0.00421658 4.0071376 ]
Stock Position:  0.004216584073856187
Bond Position:  [-3.55966248]


portfolio before change:  [-3.1659088]
curr_Stock_Price:  93.48768031041669
curr_Factors:  [9.34876803e+01 5.20433487e-02]
mat_Sqrt:  [[ 2.13273551e+01  0.00000000e+00]
 [-9.12520454e-03  2.09084703e-02]]
grads:  [1.76011553e-03 8.02074619e+00]
Stock Position:  0.0017601155345550474
Bond Position:  [-3.33045792]


portfolio before change:  [-3.16383356]
curr_Stock_Price:  94.90325380963803
curr_Factors:  [9.49032538e+01 5.18420981e-02]
mat_Sqrt:  [[ 2.16083889e+01  0.00000000e+00]
 [-9.10754396e-03  2.08680048e-02]]
grads:  [-0.06860492 -5.93777911]
Stock Position:  -0.06860491815928355
Bond Position:  [3.3469964]


portfolio before change:  [-2.99257195]
curr_Stock_Price:  92.41300661817888
curr_Factors:  [9.24130066e+01 5.27854621e-02]
mat_Sqrt:  [[ 2.12319686e+01  0.00000000e+00]
 [-9.19003479e-03  2.10570150e-02]]
grads:  [-9.73375285e-04  8.49790515e+00]
Stock Position:  -0.0009733752848144568
Bond Position:  [-2.90261942]


portfolio before change:  [-2.99337834]
curr_Stock_Price:  92.86867901809337
curr_Factors:  [9.28686790e+01 5.45263977e-02]
mat_Sqrt:  [[ 2.16856614e+01  0.00000000e+00]
 [-9.34035526e-03  2.14014425e-02]]
grads:  [-0.00446361  4.16298911]
Stock Position:  -0.004463609243118285
Bond Position:  [-2.57884885]


portfolio before change:  [-2.99732933]
curr_Stock_Price:  93.68161053060541
curr_Factors:  [9.36816105e+01 5.44775734e-02]
mat_Sqrt:  [[ 2.18656920e+01  0.00000000e+00]
 [-9.33617253e-03  2.13918587e-02]]
grads:  [ 0.05340203 -1.86266281]
Stock Position:  0.0534020277782366
Bond Position:  [-8.0001173]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.02077206]
Stock Price:  93.26135202122245
PL:  [-3.02077206]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.98767166e-01  2.06444521e-02]
 [-1.75725540e-01 -7.16474709e-02]
 [ 8.03262969e-01 -6.72093907e-01]
 [ 5.27549166e-02  2.12087776e-02]
 [-1.15389832e-01  4.95400838e-02]
 [ 6.08492512e-02  7.93255109e-02]
 [ 9.65742235e-02  4.18298907e-02]
 [ 3.21565046e-01 -5.64441238e-03]
 [-7.72458926e-02  2.30030145e-02]
 [ 3.65298396e-01 -1.88654356e-01]
 [ 6.67488616e-02  9.93105236e-03]
 [-1.45528383e-01 -1.57453361e-01]
 [-6.41200428e-02  1.23828543e-01]
 [-5.59410938e-01 -7.12527620e-01]
 [ 5.11698276e-02  1.08839606e-01]
 [ 5.79494400e-02 -2.60356121e-02]
 [-5.34658702e-02  2.98497782e-01]
 [-3.39325040e-02  1.29129479e-01]
 [ 1.48007752e-02  6.83005691e-02]
 [-8.99377338e-02 -3.83702586e-02]
 [ 2.23076943e-01  1.45940673e-01]
 [ 1.36448827e-02  5.28021919e-02]
 [-3.87083004e-03  1.62801858e-01]
 [ 6.52727606e-02  1.79433915e-01]
 [ 4.27238664e-02  9.40382882e-02]
 [ 7.45020060e-01 -4.48551168e-01]
 [-3.19223664e-01  4.12473999e-01]
 [ 1.53608488e-01 -8.10686645e-03]
 [-5.05167922e-02 -5.91797680e-02]
 [ 6.54039042e-02 -2.40985519e-01]
 [ 2.02133064e-03 -7.05252158e-02]
 [ 7.10735974e-02 -9.99643237e-03]
 [ 2.47932424e-01  3.00273145e-01]
 [ 2.13355296e-01  3.44627088e-02]
 [-1.89499506e-01 -2.36997672e-01]
 [ 1.47342218e-01 -1.86345823e-01]
 [-1.69736631e-01  2.07596830e-01]
 [-1.19375815e-01  1.20519169e-01]
 [-1.38053959e-01  1.34697746e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.84436314]
curr_Stock_Price:  99.16375508130461
curr_Factors:  [9.91637551e+01 4.06240738e-02]
mat_Sqrt:  [[ 1.99868660e+01  0.00000000e+00]
 [-8.06216585e-03  1.84727426e-02]]
grads:  [-0.00949409  1.11756292]
Stock Position:  -0.009494094191974485
Bond Position:  [-1.90289311]


portfolio before change:  [-2.86228152]
curr_Stock_Price:  101.02601888519627
curr_Factors:  [1.01026019e+02 4.11135570e-02]
mat_Sqrt:  [[ 2.04845187e+01  0.00000000e+00]
 [-8.11059130e-03  1.85836993e-02]]
grads:  [-0.01010495 -3.85539336]
Stock Position:  -0.010104951090487363
Bond Position:  [-1.84141854]


portfolio before change:  [-2.87046323]
curr_Stock_Price:  101.8129124606613
curr_Factors:  [1.01812912e+02 3.99306887e-02]
mat_Sqrt:  [[ 2.03449329e+01  0.00000000e+00]
 [-7.99306587e-03  1.83144147e-02]]
grads:  [ 2.50645771e-02 -3.66975368e+01]
Stock Position:  0.025064577130832256
Bond Position:  [-5.42236083]


portfolio before change:  [-2.87622136]
curr_Stock_Price:  101.61022460062955
curr_Factors:  [1.01610225e+02 4.10263885e-02]
mat_Sqrt:  [[ 2.05811224e+01  0.00000000e+00]
 [-8.10198874e-03  1.85639883e-02]]
grads:  [0.00301301 1.14246881]
Stock Position:  0.003013012839824848
Bond Position:  [-3.18237427]


portfolio before change:  [-2.87729498]
curr_Stock_Price:  101.3859308137009
curr_Factors:  [1.01385931e+02 4.04075332e-02]
mat_Sqrt:  [[ 2.03802197e+01  0.00000000e+00]
 [-8.04065004e-03  1.84234437e-02]]
grads:  [-0.00460097  2.6889698 ]
Stock Position:  -0.004600969399854383
Bond Position:  [-2.41082141]


portfolio before change:  [-2.88213596]
curr_Stock_Price:  102.3725937673998
curr_Factors:  [1.02372594e+02 3.98288056e-02]
mat_Sqrt:  [[ 2.04306577e+01  0.00000000e+00]
 [-7.98286221e-03  1.82910352e-02]]
grads:  [0.00467287 4.33685192]
Stock Position:  0.0046728668100692134
Bond Position:  [-3.36050945]


portfolio before change:  [-2.87744435]
curr_Stock_Price:  103.46650299972747
curr_Factors:  [1.03466503e+02 3.93140031e-02]
mat_Sqrt:  [[ 2.05150890e+01  0.00000000e+00]
 [-7.93110364e-03  1.81724414e-02]]
grads:  [0.00559736 2.3018311 ]
Stock Position:  0.005597357371050044
Bond Position:  [-3.45658335]


portfolio before change:  [-2.8826785]
curr_Stock_Price:  102.60858973888398
curr_Factors:  [1.02608590e+02 3.92010632e-02]
mat_Sqrt:  [[ 2.03157398e+01  0.00000000e+00]
 [-7.91970335e-03  1.81463200e-02]]
grads:  [ 0.01570711 -0.31104997]
Stock Position:  0.015707113066584934
Bond Position:  [-4.49436322]


portfolio before change:  [-2.85988253]
curr_Stock_Price:  104.09567375040007
curr_Factors:  [1.04095674e+02 3.87201051e-02]
mat_Sqrt:  [[ 2.04833480e+01  0.00000000e+00]
 [-7.87096996e-03  1.80346578e-02]]
grads:  [-0.00328103  1.27548938]
Stock Position:  -0.0032810336452090247
Bond Position:  [-2.51834113]


portfolio before change:  [-2.85390099]
curr_Stock_Price:  102.17665805162727
curr_Factors:  [1.02176658e+02 3.93664425e-02]
mat_Sqrt:  [[ 2.02728487e+01  0.00000000e+00]
 [-7.93639137e-03  1.81845571e-02]]
grads:  [  0.01395773 -10.37442675]
Stock Position:  0.01395772690177311
Bond Position:  [-4.28005488]


portfolio before change:  [-2.86557016]
curr_Stock_Price:  101.37895474113581
curr_Factors:  [1.01378955e+02 3.99676190e-02]
mat_Sqrt:  [[ 2.02675824e+01  0.00000000e+00]
 [-7.99676125e-03  1.83228819e-02]]
grads:  [0.00350723 0.54200275]
Stock Position:  0.0035072327188367712
Bond Position:  [-3.22112974]


portfolio before change:  [-2.86522665]
curr_Stock_Price:  101.59170858663431
curr_Factors:  [1.01591709e+02 3.97297829e-02]
mat_Sqrt:  [[ 2.02495959e+01  0.00000000e+00]
 [-7.97293250e-03  1.82682834e-02]]
grads:  [-0.01058029 -8.61894671]
Stock Position:  -0.010580293260681667
Bond Position:  [-1.79035658]


portfolio before change:  [-2.85520792]
curr_Stock_Price:  100.6236322158888
curr_Factors:  [1.00623632e+02 3.96674376e-02]
mat_Sqrt:  [[ 2.00408927e+01  0.00000000e+00]
 [-7.96667435e-03  1.82539441e-02]]
grads:  [-5.02813733e-04  6.78365957e+00]
Stock Position:  -0.0005028137325234368
Bond Position:  [-2.80461298]


portfolio before change:  [-2.85636532]
curr_Stock_Price:  102.22819631433741
curr_Factors:  [1.02228196e+02 3.86561291e-02]
mat_Sqrt:  [[ 2.00992513e+01  0.00000000e+00]
 [-7.86446480e-03  1.80197526e-02]]
grads:  [ -0.04330427 -39.54147627]
Stock Position:  -0.04330427406822367
Bond Position:  [1.57055251]


portfolio before change:  [-2.86635734]
curr_Stock_Price:  102.46346997714886
curr_Factors:  [1.02463470e+02 3.75065063e-02]
mat_Sqrt:  [[ 1.98436869e+01  0.00000000e+00]
 [-7.74663863e-03  1.77497790e-02]]
grads:  [4.97242909e-03 6.13188514e+00]
Stock Position:  0.004972429093984805
Bond Position:  [-3.37584968]


portfolio before change:  [-2.86666995]
curr_Stock_Price:  102.48547098956078
curr_Factors:  [1.02485471e+02 3.63289427e-02]
mat_Sqrt:  [[ 1.95338874e+01  0.00000000e+00]
 [-7.62406115e-03  1.74689187e-02]]
grads:  [ 0.00238491 -1.49039632]
Stock Position:  0.002384910194490967
Bond Position:  [-3.1110886]


portfolio before change:  [-2.86439951]
curr_Stock_Price:  103.60054635659584
curr_Factors:  [1.03600546e+02 3.47367810e-02]
mat_Sqrt:  [[ 1.93088688e+01  0.00000000e+00]
 [-7.45512237e-03  1.70818313e-02]]
grads:  [3.97792553e-03 1.74745773e+01]
Stock Position:  0.003977925534826363
Bond Position:  [-3.27651477]


portfolio before change:  [-2.86687522]
curr_Stock_Price:  103.08115001729549
curr_Factors:  [1.03081150e+02 3.37268993e-02]
mat_Sqrt:  [[ 1.89307344e+01  0.00000000e+00]
 [-7.34595391e-03  1.68316949e-02]]
grads:  [1.18454047e-03 7.67180488e+00]
Stock Position:  0.001184540470991968
Bond Position:  [-2.98897901]


portfolio before change:  [-2.86705431]
curr_Stock_Price:  103.24539393023359
curr_Factors:  [1.03245394e+02 3.38276485e-02]
mat_Sqrt:  [[ 1.89891966e+01  0.00000000e+00]
 [-7.35691767e-03  1.68568160e-02]]
grads:  [2.34920878e-03 4.05180723e+00]
Stock Position:  0.0023492087846255193
Bond Position:  [-3.1095993]


portfolio before change:  [-2.86892852]
curr_Stock_Price:  102.61306029183227
curr_Factors:  [1.02613060e+02 3.22496349e-02]
mat_Sqrt:  [[ 1.84274415e+01  0.00000000e+00]
 [-7.18327334e-03  1.64589469e-02]]
grads:  [-0.0057894  -2.33127057]
Stock Position:  -0.005789403130370599
Bond Position:  [-2.27486014]


portfolio before change:  [-2.86806827]
curr_Stock_Price:  102.41535027388849
curr_Factors:  [1.02415350e+02 3.33736063e-02]
mat_Sqrt:  [[ 1.87096914e+01  0.00000000e+00]
 [-7.30737779e-03  1.67433059e-02]]
grads:  [0.01532739 8.71635947]
Stock Position:  0.015327386695005496
Bond Position:  [-4.43782795]


portfolio before change:  [-2.85965382]
curr_Stock_Price:  103.00052562723353
curr_Factors:  [1.03000526e+02 3.38756076e-02]
mat_Sqrt:  [[ 1.89575839e+01  0.00000000e+00]
 [-7.36213095e-03  1.68687612e-02]]
grads:  [1.93535467e-03 3.13017603e+00]
Stock Position:  0.0019353546651422206
Bond Position:  [-3.05899637]


portfolio before change:  [-2.8594089]
curr_Stock_Price:  103.32466563991262
curr_Factors:  [1.03324666e+02 3.32379748e-02]
mat_Sqrt:  [[ 1.88374141e+01  0.00000000e+00]
 [-7.29251395e-03  1.67092486e-02]]
grads:  [3.56639852e-03 9.74321839e+00]
Stock Position:  0.003566398523762758
Bond Position:  [-3.22790583]


portfolio before change:  [-2.85911643]
curr_Stock_Price:  103.51981554181278
curr_Factors:  [1.03519816e+02 3.42614637e-02]
mat_Sqrt:  [[ 1.91613651e+01  0.00000000e+00]
 [-7.40394097e-03  1.69645600e-02]]
grads:  [7.49341922e-03 1.05769861e+01]
Stock Position:  0.007493419223647363
Bond Position:  [-3.6348338]


portfolio before change:  [-2.86275537]
curr_Stock_Price:  103.0948349467742
curr_Factors:  [1.03094835e+02 3.43509199e-02]
mat_Sqrt:  [[ 1.91075979e+01  0.00000000e+00]
 [-7.41360046e-03  1.69866926e-02]]
grads:  [4.38388648e-03 5.53599751e+00]
Stock Position:  0.00438388648017296
Bond Position:  [-3.31471142]


portfolio before change:  [-2.86128638]
curr_Stock_Price:  103.52444214758995
curr_Factors:  [1.03524442e+02 3.31005934e-02]
mat_Sqrt:  [[ 1.88347903e+01  0.00000000e+00]
 [-7.27742739e-03  1.66746809e-02]]
grads:  [  0.02916179 -26.900135  ]
Stock Position:  0.02916179436931669
Bond Position:  [-5.88024488]


portfolio before change:  [-2.85207578]
curr_Stock_Price:  103.86549376236134
curr_Factors:  [1.03865494e+02 3.22208963e-02]
mat_Sqrt:  [[ 1.86440431e+01  0.00000000e+00]
 [-7.18007201e-03  1.64516117e-02]]
grads:  [-7.46647342e-03  2.50719507e+01]
Stock Position:  -0.007466473418282173
Bond Position:  [-2.07656683]


portfolio before change:  [-2.85298311]
curr_Stock_Price:  103.95224628742356
curr_Factors:  [1.03952246e+02 3.09976123e-02]
mat_Sqrt:  [[ 1.83019768e+01  0.00000000e+00]
 [-7.04245552e-03  1.61362927e-02]]
grads:  [ 0.00819968 -0.50239957]
Stock Position:  0.008199680473871368
Bond Position:  [-3.70535831]


portfolio before change:  [-2.83324273]
curr_Stock_Price:  106.41619305646442
curr_Factors:  [1.06416193e+02 3.08862379e-02]
mat_Sqrt:  [[ 1.87020935e+01  0.00000000e+00]
 [-7.02979236e-03  1.61072778e-02]]
grads:  [-0.00408216 -3.67410116]
Stock Position:  -0.004082161192357636
Bond Position:  [-2.39883467]


portfolio before change:  [-2.83090541]
curr_Stock_Price:  105.77016411763151
curr_Factors:  [1.05770164e+02 3.22444737e-02]
mat_Sqrt:  [[ 1.89928800e+01  0.00000000e+00]
 [-7.18269851e-03  1.64576298e-02]]
grads:  [-2.09398464e-03 -1.46427840e+01]
Stock Position:  -0.0020939846362808255
Bond Position:  [-2.60942431]


portfolio before change:  [-2.83039078]
curr_Stock_Price:  105.3686192573397
curr_Factors:  [1.05368619e+02 3.17472723e-02]
mat_Sqrt:  [[ 1.87743322e+01  0.00000000e+00]
 [-7.12710570e-03  1.63302507e-02]]
grads:  [-1.53179334e-03 -4.31868544e+00]
Stock Position:  -0.001531793338119943
Bond Position:  [-2.66898783]


portfolio before change:  [-2.83124408]
curr_Stock_Price:  105.70787065873354
curr_Factors:  [1.05707871e+02 3.15597790e-02]
mat_Sqrt:  [[ 1.87790795e+01  0.00000000e+00]
 [-7.10602888e-03  1.62819576e-02]]
grads:  [ 0.0035524  -0.61395765]
Stock Position:  0.003552399706113895
Bond Position:  [-3.20676069]


portfolio before change:  [-2.82823943]
curr_Stock_Price:  106.66652632480692
curr_Factors:  [1.06666526e+02 2.97321103e-02]
mat_Sqrt:  [[ 1.83925108e+01  0.00000000e+00]
 [-6.89720063e-03  1.58034720e-02]]
grads:  [ 0.02060525 19.00045417]
Stock Position:  0.020605254622202765
Bond Position:  [-5.02613036]


portfolio before change:  [-2.85170607]
curr_Stock_Price:  105.55815203325893
curr_Factors:  [1.05558152e+02 3.09800047e-02]
mat_Sqrt:  [[ 1.85794356e+01  0.00000000e+00]
 [-7.04045506e-03  1.61317091e-02]]
grads:  [0.01229295 2.13633339]
Stock Position:  0.012292949048800189
Bond Position:  [-4.14932705]


portfolio before change:  [-2.84207647]
curr_Stock_Price:  106.38368955769981
curr_Factors:  [1.06383690e+02 3.04918848e-02]
mat_Sqrt:  [[ 1.85766408e+01  0.00000000e+00]
 [-6.98477026e-03  1.60041192e-02]]
grads:  [ -0.01576893 -14.80854202]
Stock Position:  -0.01576893117139533
Bond Position:  [-1.1645194]


portfolio before change:  [-2.82477985]
curr_Stock_Price:  105.27757822218891
curr_Factors:  [1.05277578e+02 3.20987275e-02]
mat_Sqrt:  [[ 1.88616549e+01  0.00000000e+00]
 [-7.16644709e-03  1.64203931e-02]]
grads:  [ 3.49991737e-03 -1.13484386e+01]
Stock Position:  0.0034999173744197027
Bond Position:  [-3.19324268]


portfolio before change:  [-2.82587743]
curr_Stock_Price:  105.07803173252597
curr_Factors:  [1.05078032e+02 3.25816762e-02]
mat_Sqrt:  [[ 1.89669998e+01  0.00000000e+00]
 [-7.22015802e-03  1.65434603e-02]]
grads:  [-4.17219104e-03  1.25485736e+01]
Stock Position:  -0.004172191043512096
Bond Position:  [-2.38747181]


portfolio before change:  [-2.82416405]
curr_Stock_Price:  104.59583223127967
curr_Factors:  [1.04595832e+02 3.23726697e-02]
mat_Sqrt:  [[ 1.88193075e+01  0.00000000e+00]
 [-7.19696266e-03  1.64903131e-02]]
grads:  [-3.54832065e-03  7.30848278e+00]
Stock Position:  -0.0035483206475113113
Bond Position:  [-2.4530245]


portfolio before change:  [-2.82649103]
curr_Stock_Price:  105.16520703686328
curr_Factors:  [1.05165207e+02 3.05948369e-02]
mat_Sqrt:  [[ 1.83948458e+01  0.00000000e+00]
 [-6.99655194e-03  1.60311144e-02]]
grads:  [-4.30919853e-03  8.40226966e+00]
Stock Position:  -0.004309198525723304
Bond Position:  [-2.37331327]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.82152848]
Stock Price:  103.94474216629672
PL:  [-6.76627065]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.49302656e-01 -3.83291870e-02]
 [-1.64904273e-01 -8.61539699e-02]
 [ 8.02264100e-01 -6.72260367e-01]
 [-3.85191511e-03  2.46276816e-02]
 [-1.85285077e-03  4.10146421e-03]
 [-8.75903638e-02 -7.40176407e-02]
 [-3.46547169e-02  2.14939706e-01]
 [ 1.13717989e-01 -3.34968324e-02]
 [ 1.54798672e-01  7.37038764e-02]
 [ 3.37944859e-01 -1.64166958e-01]
 [ 6.06289394e-02 -1.12000081e-02]
 [-9.94559139e-02 -1.80834375e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-7.57524142e-01 -1.09804902e+00]
 [-3.65282626e-03 -1.35225473e-01]
 [ 4.09943330e-02 -9.40490032e-02]
 [-5.32769195e-02  2.87876254e-01]
 [-1.69960458e-01 -9.58427525e-03]
 [ 1.53625427e-02  5.43517964e-02]
 [-9.64560955e-03 -8.66624584e-02]
 [ 1.82009646e-01  8.94993764e-02]
 [ 5.32083839e-02  2.74117682e-01]
 [ 3.48340034e-02  2.14451266e-01]
 [-7.82682534e-02  9.12762136e-02]
 [ 6.14966319e-02  1.32219601e-01]
 [ 1.36597881e-01  5.14460727e-02]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.64137442e-01  1.00978263e-01]
 [-2.32618779e-01 -2.07737549e-02]
 [ 1.72388720e-01 -8.66118840e-02]
 [-1.22505385e+00 -1.38738694e-01]
 [ 5.37522936e-02  2.73331537e-01]
 [-1.07384638e-02 -1.23810869e-01]
 [-2.01597538e-03  5.53035363e-02]
 [-2.11228312e-02  1.69983230e-01]
 [-2.11032630e+00  1.43984339e-02]
 [-1.08146470e-01  1.51252032e-01]
 [-1.34754664e-01 -2.30112671e-01]
 [ 1.65004527e+00 -1.00255408e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.94634614]
curr_Stock_Price:  98.99777860501179
curr_Factors:  [9.89977786e+01 4.06634416e-02]
mat_Sqrt:  [[ 1.99630786e+01  0.00000000e+00]
 [-8.06607133e-03  1.84816912e-02]]
grads:  [-0.01332615 -2.07390041]
Stock Position:  -0.013326145236319656
Bond Position:  [-2.62708736]


portfolio before change:  [-3.94918737]
curr_Stock_Price:  99.18634213968457
curr_Factors:  [9.91863421e+01 4.03735195e-02]
mat_Sqrt:  [[ 1.99296733e+01  0.00000000e+00]
 [-8.03726516e-03  1.84156880e-02]]
grads:  [-0.01016098 -4.67829223]
Stock Position:  -0.010160976791008176
Bond Position:  [-2.94135725]


portfolio before change:  [-3.95885436]
curr_Stock_Price:  100.10153954211317
curr_Factors:  [1.00101540e+02 4.16995819e-02]
mat_Sqrt:  [[ 2.04412103e+01  0.00000000e+00]
 [-8.16819019e-03  1.87156749e-02]]
grads:  [ 2.48941043e-02 -3.59196433e+01]
Stock Position:  0.024894104306527845
Bond Position:  [-6.45079253]


portfolio before change:  [-3.95136474]
curr_Stock_Price:  100.43479205290666
curr_Factors:  [1.00434792e+02 4.30028223e-02]
mat_Sqrt:  [[ 2.08272852e+01  0.00000000e+00]
 [-8.29484874e-03  1.90058861e-02]]
grads:  [3.31127474e-04 1.29579234e+00]
Stock Position:  0.00033112747364941604
Bond Position:  [-3.98462146]


portfolio before change:  [-3.95205731]
curr_Stock_Price:  99.84753212869954
curr_Factors:  [9.98475321e+01 4.14869909e-02]
mat_Sqrt:  [[ 2.03373004e+01  0.00000000e+00]
 [-8.14734223e-03  1.86679062e-02]]
grads:  [-3.08915310e-06  2.19706707e-01]
Stock Position:  -3.089153099982938e-06
Bond Position:  [-3.95174886]


portfolio before change:  [-3.95254804]
curr_Stock_Price:  98.78925263452422
curr_Factors:  [9.87892526e+01 4.09429538e-02]
mat_Sqrt:  [[ 1.99893782e+01  0.00000000e+00]
 [-8.09374611e-03  1.85451021e-02]]
grads:  [-0.0059979  -3.99122314]
Stock Position:  -0.005997900945149736
Bond Position:  [-3.36001989]


portfolio before change:  [-3.95573994]
curr_Stock_Price:  99.25139381605541
curr_Factors:  [9.92513938e+01 4.01771862e-02]
mat_Sqrt:  [[ 1.98941951e+01  0.00000000e+00]
 [-8.01769904e-03  1.83708564e-02]]
grads:  [2.97336288e-03 1.17000373e+01]
Stock Position:  0.0029733628753179846
Bond Position:  [-4.25085035]


portfolio before change:  [-3.95396935]
curr_Stock_Price:  100.02559505895078
curr_Factors:  [1.00025595e+02 4.11649225e-02]
mat_Sqrt:  [[ 2.02943336e+01  0.00000000e+00]
 [-8.11565622e-03  1.85953045e-02]]
grads:  [ 0.00488308 -1.80135972]
Stock Position:  0.004883075992368178
Bond Position:  [-4.44240193]


portfolio before change:  [-3.95464059]
curr_Stock_Price:  100.00185873527755
curr_Factors:  [1.00001859e+02 4.08949877e-02]
mat_Sqrt:  [[ 2.02228850e+01  0.00000000e+00]
 [-8.08900367e-03  1.85342358e-02]]
grads:  [0.00924525 3.97663422]
Stock Position:  0.00924525261645818
Bond Position:  [-4.87918304]


portfolio before change:  [-3.94006073]
curr_Stock_Price:  101.64484283056467
curr_Factors:  [1.01644843e+02 4.03624517e-02]
mat_Sqrt:  [[ 2.04208642e+01  0.00000000e+00]
 [-8.03616344e-03  1.84131636e-02]]
grads:  [ 0.01304041 -8.91573882]
Stock Position:  0.013040414033789008
Bond Position:  [-5.26555156]


portfolio before change:  [-3.91255215]
curr_Stock_Price:  103.80480578278066
curr_Factors:  [1.03804806e+02 3.94693683e-02]
mat_Sqrt:  [[ 2.06227961e+01  0.00000000e+00]
 [-7.94675967e-03  1.82083139e-02]]
grads:  [ 0.00270288 -0.61510408]
Stock Position:  0.002702875734661617
Bond Position:  [-4.19312364]


portfolio before change:  [-3.91532457]
curr_Stock_Price:  102.97300603360024
curr_Factors:  [1.02973006e+02 4.08785322e-02]
mat_Sqrt:  [[ 2.08195356e+01  0.00000000e+00]
 [-8.08737606e-03  1.85305065e-02]]
grads:  [-8.56784266e-03 -9.75873890e+00]
Stock Position:  -0.008567842662940982
Bond Position:  [-3.03306806]


portfolio before change:  [-3.91686446]
curr_Stock_Price:  103.10848070192264
curr_Factors:  [1.03108481e+02 4.03181247e-02]
mat_Sqrt:  [[ 2.07035371e+01  0.00000000e+00]
 [-8.03174946e-03  1.84030499e-02]]
grads:  [-5.83437597e-03  8.99479418e+00]
Stock Position:  -0.005834375965782209
Bond Position:  [-3.31529082]


portfolio before change:  [-3.92926176]
curr_Stock_Price:  105.16231925989824
curr_Factors:  [1.05162319e+02 4.06136770e-02]
mat_Sqrt:  [[ 2.11931890e+01  0.00000000e+00]
 [-8.06113412e-03  1.84703786e-02]]
grads:  [-5.83561079e-02 -5.94491886e+01]
Stock Position:  -0.0583561079380809
Bond Position:  [2.20760189]


portfolio before change:  [-3.8497354]
curr_Stock_Price:  103.80427138163775
curr_Factors:  [1.03804271e+02 4.27306438e-02]
mat_Sqrt:  [[ 2.14577876e+01  0.00000000e+00]
 [-8.26855671e-03  1.89456435e-02]]
grads:  [-2.92062082e-03 -7.13754977e+00]
Stock Position:  -0.002920620822429181
Bond Position:  [-3.54656249]


portfolio before change:  [-3.84963686]
curr_Stock_Price:  103.61873217298712
curr_Factors:  [1.03618732e+02 4.40785035e-02]
mat_Sqrt:  [[ 2.17546297e+01  0.00000000e+00]
 [-8.39795246e-03  1.92421264e-02]]
grads:  [-2.39108095e-06 -4.88766164e+00]
Stock Position:  -2.3910809478044834e-06
Bond Position:  [-3.8493891]


portfolio before change:  [-3.85011708]
curr_Stock_Price:  103.2052910313962
curr_Factors:  [1.03205291e+02 4.25891164e-02]
mat_Sqrt:  [[ 2.12986108e+01  0.00000000e+00]
 [-8.25485228e-03  1.89142427e-02]]
grads:  [3.39752572e-03 1.52200782e+01]
Stock Position:  0.0033975257174762366
Bond Position:  [-4.20075971]


portfolio before change:  [-3.8600196]
curr_Stock_Price:  100.44522532661945
curr_Factors:  [1.00445225e+02 4.50387821e-02]
mat_Sqrt:  [[ 2.13168297e+01  0.00000000e+00]
 [-8.48893700e-03  1.94505982e-02]]
grads:  [-0.00816929 -0.49274964]
Stock Position:  -0.008169290672264408
Bond Position:  [-3.03945336]


portfolio before change:  [-3.84844971]
curr_Stock_Price:  98.98244889533164
curr_Factors:  [9.89824489e+01 4.49926226e-02]
mat_Sqrt:  [[ 2.09956270e+01  0.00000000e+00]
 [-8.48458580e-03  1.94406283e-02]]
grads:  [1.86151199e-03 2.79578394e+00]
Stock Position:  0.001861511992397737
Bond Position:  [-4.03270672]


portfolio before change:  [-3.84715156]
curr_Stock_Price:  99.9506217755958
curr_Factors:  [9.99506218e+01 4.27738449e-02]
mat_Sqrt:  [[ 2.06716263e+01  0.00000000e+00]
 [-8.27273545e-03  1.89552182e-02]]
grads:  [-2.29629767e-03 -4.57195784e+00]
Stock Position:  -0.0022962976657013795
Bond Position:  [-3.61763518]


portfolio before change:  [-3.85104015]
curr_Stock_Price:  101.44709573592709
curr_Factors:  [1.01447096e+02 4.25050301e-02]
mat_Sqrt:  [[ 2.09150922e+01  0.00000000e+00]
 [-8.24669923e-03  1.88955617e-02]]
grads:  [0.0105699  4.73652902]
Stock Position:  0.0105698972903222
Bond Position:  [-4.92332553]


portfolio before change:  [-3.86076243]
curr_Stock_Price:  100.58551389244825
curr_Factors:  [1.00585514e+02 4.29862808e-02]
mat_Sqrt:  [[ 2.08545285e+01  0.00000000e+00]
 [-8.29325324e-03  1.90022304e-02]]
grads:  [8.28803914e-03 1.44255530e+01]
Stock Position:  0.008288039141082086
Bond Position:  [-4.69441911]


portfolio before change:  [-3.88740578]
curr_Stock_Price:  97.44164512824047
curr_Factors:  [9.74416451e+01 4.57647791e-02]
mat_Sqrt:  [[ 2.08454029e+01  0.00000000e+00]
 [-8.55708166e-03  1.96067372e-02]]
grads:  [6.16098474e-03 1.09376315e+01]
Stock Position:  0.0061609847365966496
Bond Position:  [-4.48774227]


portfolio before change:  [-3.8937669]
curr_Stock_Price:  96.50021744311495
curr_Factors:  [9.65002174e+01 4.67586438e-02]
mat_Sqrt:  [[ 2.08669629e+01  0.00000000e+00]
 [-8.64949883e-03  1.98184916e-02]]
grads:  [-1.84176528e-03  4.60560852e+00]
Stock Position:  -0.0018417652826468347
Bond Position:  [-3.71603615]


portfolio before change:  [-3.89360829]
curr_Stock_Price:  96.16187527298486
curr_Factors:  [9.61618753e+01 4.52465361e-02]
mat_Sqrt:  [[ 2.04548167e+01  0.00000000e+00]
 [-8.50849327e-03  1.94954072e-02]]
grads:  [5.82757590e-03 6.78208975e+00]
Stock Position:  0.005827575896297541
Bond Position:  [-4.45399892]


portfolio before change:  [-3.89054633]
curr_Stock_Price:  96.7828446355421
curr_Factors:  [9.67828446e+01 4.46673008e-02]
mat_Sqrt:  [[ 2.04547058e+01  0.00000000e+00]
 [-8.45385601e-03  1.93702175e-02]]
grads:  [0.00777576 2.65593675]
Stock Position:  0.007775755345876732
Bond Position:  [-4.64310605]


portfolio before change:  [-3.90258854]
curr_Stock_Price:  95.30880329336884
curr_Factors:  [9.53088033e+01 4.46794168e-02]
mat_Sqrt:  [[ 2.01459042e+01  0.00000000e+00]
 [-8.45500247e-03  1.93728444e-02]]
grads:  [8.84356436e-03 9.03003145e+00]
Stock Position:  0.008843564362634886
Bond Position:  [-4.74545807]


portfolio before change:  [-3.90958339]
curr_Stock_Price:  94.58492816761782
curr_Factors:  [9.45849282e+01 4.62836281e-02]
mat_Sqrt:  [[ 2.03486516e+01  0.00000000e+00]
 [-8.60545205e-03  1.97175677e-02]]
grads:  [-0.00590049  5.12123325]
Stock Position:  -0.005900485075313256
Bond Position:  [-3.35148644]


portfolio before change:  [-3.91745319]
curr_Stock_Price:  95.84767833503534
curr_Factors:  [9.58476783e+01 4.53180060e-02]
mat_Sqrt:  [[ 2.04040789e+01  0.00000000e+00]
 [-8.51521048e-03  1.95107983e-02]]
grads:  [-0.01184494 -1.06473116]
Stock Position:  -0.01184494484081058
Bond Position:  [-2.78214273]


portfolio before change:  [-3.91391208]
curr_Stock_Price:  95.51936047748636
curr_Factors:  [9.55193605e+01 4.55364131e-02]
mat_Sqrt:  [[ 2.03831272e+01  0.00000000e+00]
 [-8.53570507e-03  1.95577573e-02]]
grads:  [ 0.00660292 -4.42851819]
Stock Position:  0.006602921770315648
Bond Position:  [-4.54461894]


portfolio before change:  [-3.92221389]
curr_Stock_Price:  94.348106633293
curr_Factors:  [9.43481066e+01 4.77749352e-02]
mat_Sqrt:  [[ 2.06221168e+01  0.00000000e+00]
 [-8.74299127e-03  2.00327096e-02]]
grads:  [-0.06234105 -6.92560797]
Stock Position:  -0.06234104834403179
Bond Position:  [1.95954599]


portfolio before change:  [-3.92161831]
curr_Stock_Price:  94.3424824722404
curr_Factors:  [9.43424825e+01 4.63904143e-02]
mat_Sqrt:  [[ 2.03198934e+01  0.00000000e+00]
 [-8.61537363e-03  1.97403009e-02]]
grads:  [8.51598740e-03 1.38463713e+01]
Stock Position:  0.008515987396740917
Bond Position:  [-4.7250377]


portfolio before change:  [-3.91735587]
curr_Stock_Price:  94.91236487781516
curr_Factors:  [9.49123649e+01 4.68601069e-02]
mat_Sqrt:  [[ 2.05458651e+01  0.00000000e+00]
 [-8.65887817e-03  1.98399823e-02]]
grads:  [-3.15265173e-03 -6.24047276e+00]
Stock Position:  -0.003152651726213057
Bond Position:  [-3.61813024]


portfolio before change:  [-3.90982894]
curr_Stock_Price:  92.3814077728042
curr_Factors:  [9.23814078e+01 4.73540488e-02]
mat_Sqrt:  [[ 2.01031047e+01  0.00000000e+00]
 [-8.70439418e-03  1.99442726e-02]]
grads:  [1.10035076e-03 2.77290315e+00]
Stock Position:  0.001100350764308469
Bond Position:  [-4.01148089]


portfolio before change:  [-3.91053929]
curr_Stock_Price:  92.19156672183556
curr_Factors:  [9.21915667e+01 4.72472931e-02]
mat_Sqrt:  [[ 2.00391669e+01  0.00000000e+00]
 [-8.69457698e-03  1.99217786e-02]]
grads:  [2.64801092e-03 8.53253285e+00]
Stock Position:  0.002648010916998443
Bond Position:  [-4.15466357]


portfolio before change:  [-3.91203347]
curr_Stock_Price:  91.82343540556866
curr_Factors:  [9.18234354e+01 4.71609544e-02]
mat_Sqrt:  [[ 1.99409034e+01  0.00000000e+00]
 [-8.68662921e-03  1.99035679e-02]]
grads:  [-0.10551389  0.72340969]
Stock Position:  -0.10551389117749323
Bond Position:  [5.7766145]


portfolio before change:  [-3.872671]
curr_Stock_Price:  91.45722439166695
curr_Factors:  [9.14572244e+01 4.75498945e-02]
mat_Sqrt:  [[ 1.99431059e+01  0.00000000e+00]
 [-8.72237531e-03  1.99854726e-02]]
grads:  [-2.11274373e-03  7.56809883e+00]
Stock Position:  -0.0021127437314587727
Bond Position:  [-3.67944533]


portfolio before change:  [-3.86879196]
curr_Stock_Price:  89.40349376862599
curr_Factors:  [8.94034938e+01 4.88586662e-02]
mat_Sqrt:  [[ 1.97617451e+01  0.00000000e+00]
 [-8.84159861e-03  2.02586474e-02]]
grads:  [ -0.01190098 -11.35873814]
Stock Position:  -0.011900976612178074
Bond Position:  [-2.80480307]


portfolio before change:  [-3.87179]
curr_Stock_Price:  89.62594783263162
curr_Factors:  [8.96259478e+01 4.86441159e-02]
mat_Sqrt:  [[ 1.97673712e+01  0.00000000e+00]
 [-8.82216444e-03  2.02141182e-02]]
grads:  [ 0.08125968 -4.95967259]
Stock Position:  0.08125967793230973
Bond Position:  [-11.15476565]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.83951153]
Stock Price:  90.04033418361821
PL:  [-3.83951153]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 5.00197591e-02  3.22299385e-01]
 [-1.71025143e-01 -8.26275407e-02]
 [ 7.63258746e-01 -6.44881345e-01]
 [-4.63036004e-02  7.91463032e-02]
 [ 3.42293005e-02 -5.26808075e-02]
 [-8.68163826e-02 -7.71756543e-02]
 [-7.45001798e-02  1.60857427e-01]
 [-8.57387524e-02 -1.08833551e-01]
 [ 1.66206031e-01  9.41437988e-02]
 [ 4.28751673e-02  1.69360701e-01]
 [ 1.69454499e-01  3.79113206e-01]
 [ 1.72444914e-01  2.62340134e-01]
 [ 2.38420442e-01  2.21177047e-02]
 [-4.11339161e-02  3.73121222e-02]
 [ 9.84456319e-02  2.38999336e-01]
 [ 4.21270477e-02  1.07009877e-01]
 [ 8.58224967e-02  1.84519692e-01]
 [ 7.43327673e-02  6.30479884e-02]
 [ 1.56153396e-02  7.99575214e-03]
 [ 3.09974351e-01 -1.13197106e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 1.28956174e-03  1.79786301e-01]
 [ 2.73202825e-02  1.55868832e-01]
 [-7.48117199e-02  8.46218007e-02]
 [ 5.55807389e-02  1.34676234e-01]
 [ 4.68685401e-02  1.15875647e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.62519629e-01  9.81322330e-02]
 [-2.82461724e-01  4.52432928e-03]
 [ 1.65411407e-01 -8.49833306e-02]
 [-1.16074052e+00 -1.30285088e-01]
 [ 3.31138065e-03  2.17178798e-01]
 [-1.11188040e-02 -1.26859410e-01]
 [ 4.97273452e-03  7.08989316e-02]
 [-5.26327664e-02  1.62657048e-01]
 [-1.42840599e+00 -1.26902687e-01]
 [-8.59396715e-02  2.20404357e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.01308583e+00 -1.73928889e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.89464643]
curr_Stock_Price:  100.02814281075108
curr_Factors:  [1.00028143e+02 4.01407091e-02]
mat_Sqrt:  [[ 2.00407848e+01  0.00000000e+00]
 [-8.01405855e-03  1.83625150e-02]]
grads:  [9.51473430e-03 1.75520284e+01]
Stock Position:  0.009514734296347426
Bond Position:  [1.94290523]


portfolio before change:  [2.89687791]
curr_Stock_Price:  100.23714450107128
curr_Factors:  [1.00237145e+02 3.97753877e-02]
mat_Sqrt:  [[ 1.99910634e+01  0.00000000e+00]
 [-7.97750715e-03  1.82787652e-02]]
grads:  [-0.01035897 -4.52041152]
Stock Position:  -0.010358966571372183
Bond Position:  [3.93523114]


portfolio before change:  [2.89069466]
curr_Stock_Price:  100.88153141522284
curr_Factors:  [1.00881531e+02 3.68885437e-02]
mat_Sqrt:  [[ 1.93757009e+01  0.00000000e+00]
 [-7.68255621e-03  1.76029477e-02]]
grads:  [ 2.48666851e-02 -3.66348498e+01]
Stock Position:  0.02486668507642943
Bond Position:  [0.38210539]


portfolio before change:  [2.84912689]
curr_Stock_Price:  99.20798581913127
curr_Factors:  [9.92079858e+01 3.76314195e-02]
mat_Sqrt:  [[ 1.92451780e+01  0.00000000e+00]
 [-7.75952777e-03  1.77793117e-02]]
grads:  [-6.11130837e-04  4.45159546e+00]
Stock Position:  -0.000611130836621427
Bond Position:  [2.90975595]


portfolio before change:  [2.85021574]
curr_Stock_Price:  98.02149673387069
curr_Factors:  [9.80214967e+01 3.65052292e-02]
mat_Sqrt:  [[ 1.87283221e+01  0.00000000e+00]
 [-7.64253667e-03  1.75112514e-02]]
grads:  [ 6.00027655e-04 -3.00839765e+00]
Stock Position:  0.0006000276546004467
Bond Position:  [2.79140013]


portfolio before change:  [2.85099901]
curr_Stock_Price:  98.74533805181531
curr_Factors:  [9.87453381e+01 3.76575559e-02]
mat_Sqrt:  [[ 1.91620807e+01  0.00000000e+00]
 [-7.76222194e-03  1.77854848e-02]]
grads:  [-0.00628839 -4.33924941]
Stock Position:  -0.0062883880515115925
Bond Position:  [3.47194801]


portfolio before change:  [2.85564571]
curr_Stock_Price:  98.0754231505229
curr_Factors:  [9.80754232e+01 3.80624136e-02]
mat_Sqrt:  [[ 1.91341138e+01  0.00000000e+00]
 [-7.80383635e-03  1.78808354e-02]]
grads:  [-2.24533174e-04  8.99608005e+00]
Stock Position:  -0.00022453317365062086
Bond Position:  [2.8776669]


portfolio before change:  [2.85610502]
curr_Stock_Price:  97.63196418988687
curr_Factors:  [9.76319642e+01 3.84501969e-02]
mat_Sqrt:  [[ 1.91443802e+01  0.00000000e+00]
 [-7.84348870e-03  1.79716903e-02]]
grads:  [-0.00695962 -6.05583273]
Stock Position:  -0.006959619829120472
Bond Position:  [3.53558637]


portfolio before change:  [2.85307182]
curr_Stock_Price:  98.13129777362421
curr_Factors:  [9.81312978e+01 3.91498458e-02]
mat_Sqrt:  [[ 1.94165726e+01  0.00000000e+00]
 [-7.91452799e-03  1.81344618e-02]]
grads:  [0.01067612 5.19143054]
Stock Position:  0.010676124850706644
Bond Position:  [1.80540983]


portfolio before change:  [2.83622796]
curr_Stock_Price:  96.53244476942713
curr_Factors:  [9.65324448e+01 3.79739528e-02]
mat_Sqrt:  [[ 1.88111873e+01  0.00000000e+00]
 [-7.79476263e-03  1.78600449e-02]]
grads:  [6.20855211e-03 9.48265816e+00]
Stock Position:  0.00620855210757264
Bond Position:  [2.23690124]


portfolio before change:  [2.83406803]
curr_Stock_Price:  96.13950996692819
curr_Factors:  [9.61395100e+01 3.67257703e-02]
mat_Sqrt:  [[ 1.84241458e+01  0.00000000e+00]
 [-7.66558755e-03  1.75640676e-02]]
grads:  [1.81779428e-02 2.15845905e+01]
Stock Position:  0.018177942751952482
Bond Position:  [1.08644952]


portfolio before change:  [2.83930781]
curr_Stock_Price:  96.42028802163733
curr_Factors:  [9.64202880e+01 3.71524518e-02]
mat_Sqrt:  [[ 1.85849828e+01  0.00000000e+00]
 [-7.70998851e-03  1.76658030e-02]]
grads:  [ 0.01543932 14.85016755]
Stock Position:  0.01543932207119197
Bond Position:  [1.35064393]


portfolio before change:  [2.83635975]
curr_Stock_Price:  96.21840744493062
curr_Factors:  [9.62184074e+01 3.65465204e-02]
mat_Sqrt:  [[ 1.83942118e+01  0.00000000e+00]
 [-7.64685770e-03  1.75211521e-02]]
grads:  [0.01348649 1.26234305]
Stock Position:  0.013486492528081262
Bond Position:  [1.53871092]


portfolio before change:  [2.81811985]
curr_Stock_Price:  94.85168816904131
curr_Factors:  [9.48516882e+01 3.75933773e-02]
mat_Sqrt:  [[ 1.83908049e+01  0.00000000e+00]
 [-7.75560466e-03  1.77703227e-02]]
grads:  [-1.35119540e-03  2.09968737e+00]
Stock Position:  -0.001351195399737956
Bond Position:  [2.94628302]


portfolio before change:  [2.81846951]
curr_Stock_Price:  94.865492611632
curr_Factors:  [9.48654926e+01 3.75402333e-02]
mat_Sqrt:  [[ 1.83804758e+01  0.00000000e+00]
 [-7.75012085e-03  1.77577577e-02]]
grads:  [1.10309165e-02 1.34588691e+01]
Stock Position:  0.011030916496802054
Bond Position:  [1.77201618]


portfolio before change:  [2.82738739]
curr_Stock_Price:  95.6538550537147
curr_Factors:  [9.56538551e+01 3.77916400e-02]
mat_Sqrt:  [[ 1.85951783e+01  0.00000000e+00]
 [-7.77602881e-03  1.78171203e-02]]
grads:  [4.77704410e-03 6.00601416e+00]
Stock Position:  0.004777044099260813
Bond Position:  [2.3704447]


portfolio before change:  [2.82568866]
curr_Stock_Price:  95.23622235193892
curr_Factors:  [9.52362224e+01 3.79508124e-02]
mat_Sqrt:  [[ 1.85529382e+01  0.00000000e+00]
 [-7.79238730e-03  1.78546023e-02]]
grads:  [8.96642301e-03 1.03345730e+01]
Stock Position:  0.008966423009294129
Bond Position:  [1.97176041]


portfolio before change:  [2.83375205]
curr_Stock_Price:  96.10801915127269
curr_Factors:  [9.61080192e+01 3.67638867e-02]
mat_Sqrt:  [[ 1.84276661e+01  0.00000000e+00]
 [-7.66956444e-03  1.75731798e-02]]
grads:  [0.00552697 3.58773933]
Stock Position:  0.005526970396810515
Bond Position:  [2.30256587]


portfolio before change:  [2.83089153]
curr_Stock_Price:  95.53838468975525
curr_Factors:  [9.55383847e+01 3.60836493e-02]
mat_Sqrt:  [[ 1.81481818e+01  0.00000000e+00]
 [-7.59827868e-03  1.74098436e-02]]
grads:  [0.00105272 0.45926617]
Stock Position:  0.001052720991436447
Bond Position:  [2.73031627]


portfolio before change:  [2.83070407]
curr_Stock_Price:  95.036096661445
curr_Factors:  [9.50360967e+01 3.61990073e-02]
mat_Sqrt:  [[ 1.80816026e+01  0.00000000e+00]
 [-7.61041469e-03  1.74376507e-02]]
grads:  [ 0.01441084 -6.49153418]
Stock Position:  0.01441084005411957
Bond Position:  [1.46115408]


portfolio before change:  [2.83231256]
curr_Stock_Price:  95.13503797947553
curr_Factors:  [9.51350380e+01 3.72142147e-02]
mat_Sqrt:  [[ 1.83524870e+01  0.00000000e+00]
 [-7.71639446e-03  1.76804809e-02]]
grads:  [ 0.00229553 -2.13670601]
Stock Position:  0.002295525974202669
Bond Position:  [2.61392761]


portfolio before change:  [2.8344337]
curr_Stock_Price:  95.91672359505607
curr_Factors:  [9.59167236e+01 3.56115997e-02]
mat_Sqrt:  [[ 1.81004794e+01  0.00000000e+00]
 [-7.54841438e-03  1.72955901e-02]]
grads:  [4.40622233e-03 1.03949215e+01]
Stock Position:  0.004406222332315372
Bond Position:  [2.41180329]


portfolio before change:  [2.83713332]
curr_Stock_Price:  96.46098333703324
curr_Factors:  [9.64609833e+01 3.65482515e-02]
mat_Sqrt:  [[ 1.84410221e+01  0.00000000e+00]
 [-7.64703880e-03  1.75215671e-02]]
grads:  [5.17037601e-03 8.89582717e+00]
Stock Position:  0.0051703760113458366
Bond Position:  [2.33839377]


portfolio before change:  [2.83710231]
curr_Stock_Price:  96.3984490768288
curr_Factors:  [9.63984491e+01 3.67456373e-02]
mat_Sqrt:  [[ 1.84787648e+01  0.00000000e+00]
 [-7.66766063e-03  1.75688176e-02]]
grads:  [-2.04990640e-03  4.81659053e+00]
Stock Position:  -0.002049906399316891
Bond Position:  [3.03471011]


portfolio before change:  [2.83899954]
curr_Stock_Price:  95.65799461138194
curr_Factors:  [9.56579946e+01 3.76658377e-02]
mat_Sqrt:  [[ 1.85650057e+01  0.00000000e+00]
 [-7.76307544e-03  1.77874404e-02]]
grads:  [6.15988316e-03 7.57142291e+00]
Stock Position:  0.006159883161988369
Bond Position:  [2.24975747]


portfolio before change:  [2.83934784]
curr_Stock_Price:  95.66888159148064
curr_Factors:  [9.56688816e+01 3.81876851e-02]
mat_Sqrt:  [[ 1.86952968e+01  0.00000000e+00]
 [-7.81666785e-03  1.79102360e-02]]
grads:  [5.21204985e-03 6.46980012e+00]
Stock Position:  0.0052120498473896045
Bond Position:  [2.34071686]


portfolio before change:  [2.83655685]
curr_Stock_Price:  95.07725318883975
curr_Factors:  [9.50772532e+01 3.75147997e-02]
mat_Sqrt:  [[ 1.84152637e+01  0.00000000e+00]
 [-7.74749505e-03  1.77517413e-02]]
grads:  [9.67467005e-03 9.85466112e+00]
Stock Position:  0.009674670050300942
Bond Position:  [1.91671579]


portfolio before change:  [2.829436]
curr_Stock_Price:  94.31645700297582
curr_Factors:  [9.43164570e+01 3.68500551e-02]
mat_Sqrt:  [[ 1.81053343e+01  0.00000000e+00]
 [-7.67854727e-03  1.75937620e-02]]
grads:  [-0.00661083  5.57767195]
Stock Position:  -0.006610825802274721
Bond Position:  [3.45294567]


portfolio before change:  [2.82487189]
curr_Stock_Price:  95.07215037954217
curr_Factors:  [9.50721504e+01 3.74965028e-02]
mat_Sqrt:  [[ 1.84097843e+01  0.00000000e+00]
 [-7.74560550e-03  1.77474117e-02]]
grads:  [-0.01523576  0.25492896]
Stock Position:  -0.015235764919498724
Bond Position:  [4.27336882]


portfolio before change:  [2.81538356]
curr_Stock_Price:  95.72997968958899
curr_Factors:  [9.57299797e+01 3.43679657e-02]
mat_Sqrt:  [[ 1.77469972e+01  0.00000000e+00]
 [-7.41543965e-03  1.69909067e-02]]
grads:  [ 0.00723061 -5.00169484]
Stock Position:  0.007230611446851264
Bond Position:  [2.12319727]


portfolio before change:  [2.81058389]
curr_Stock_Price:  95.02947406130889
curr_Factors:  [9.50294741e+01 3.37880839e-02]
mat_Sqrt:  [[ 1.74678763e+01  0.00000000e+00]
 [-7.35261410e-03  1.68469553e-02]]
grads:  [-0.06970519 -7.73345007]
Stock Position:  -0.06970518735782867
Bond Position:  [9.43463119]


portfolio before change:  [2.81809159]
curr_Stock_Price:  94.93868752215275
curr_Factors:  [9.49386875e+01 3.33013048e-02]
mat_Sqrt:  [[ 1.73250242e+01  0.00000000e+00]
 [-7.29945804e-03  1.67251595e-02]]
grads:  [5.66209767e-03 1.29851556e+01]
Stock Position:  0.005662097672404099
Bond Position:  [2.28053947]


portfolio before change:  [2.81209359]
curr_Stock_Price:  93.82901252701318
curr_Factors:  [9.38290125e+01 3.27755772e-02]
mat_Sqrt:  [[ 1.69868292e+01  0.00000000e+00]
 [-7.24161056e-03  1.65926143e-02]]
grads:  [-3.91390229e-03 -7.64553482e+00]
Stock Position:  -0.003913902290717863
Bond Position:  [3.17933117]


portfolio before change:  [2.81251494]
curr_Stock_Price:  93.8229033748249
curr_Factors:  [9.38229034e+01 3.13857578e-02]
mat_Sqrt:  [[ 1.66216900e+01  0.00000000e+00]
 [-7.08641041e-03  1.62370060e-02]]
grads:  [2.16076495e-03 4.36650276e+00]
Stock Position:  0.002160764949195522
Bond Position:  [2.6097857]


portfolio before change:  [2.81562773]
curr_Stock_Price:  95.1125179772889
curr_Factors:  [9.51125180e+01 3.03461887e-02]
mat_Sqrt:  [[ 1.65687504e+01  0.00000000e+00]
 [-6.96806300e-03  1.59658381e-02]]
grads:  [1.10790426e-03 1.01878177e+01]
Stock Position:  0.0011079042602065376
Bond Position:  [2.71025217]


portfolio before change:  [2.81570456]
curr_Stock_Price:  94.87605809522235
curr_Factors:  [9.48760581e+01 3.06695550e-02]
mat_Sqrt:  [[ 1.66153835e+01  0.00000000e+00]
 [-7.00509015e-03  1.60506779e-02]]
grads:  [-0.08930223 -7.90637549]
Stock Position:  -0.08930223378717368
Bond Position:  [11.28834848]


portfolio before change:  [2.92127727]
curr_Stock_Price:  93.7096642712259
curr_Factors:  [9.37096643e+01 3.16676301e-02]
mat_Sqrt:  [[ 1.66760106e+01  0.00000000e+00]
 [-7.11816044e-03  1.63097545e-02]]
grads:  [6.14815872e-04 1.35136526e+01]
Stock Position:  0.0006148158716733484
Bond Position:  [2.86366308]


portfolio before change:  [2.92208223]
curr_Stock_Price:  94.43668483233068
curr_Factors:  [9.44366848e+01 3.10737919e-02]
mat_Sqrt:  [[ 1.66470721e+01  0.00000000e+00]
 [-7.05110396e-03  1.61561088e-02]]
grads:  [-5.29734088e-03  6.76906585e+00]
Stock Position:  -0.005297340881560964
Bond Position:  [3.42234554]


portfolio before change:  [2.91801298]
curr_Stock_Price:  95.28561443436428
curr_Factors:  [9.52856144e+01 3.15389878e-02]
mat_Sqrt:  [[ 1.69219814e+01  0.00000000e+00]
 [-7.10368781e-03  1.62765936e-02]]
grads:  [ 0.05941946 -1.06858286]
Stock Position:  0.059419456961508084
Bond Position:  [-2.74380648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.88755418]
Stock Price:  94.77878038913506
PL:  [2.88755418]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.70951722e-01  8.77932328e-01]
 [-1.81334025e-01 -7.36420780e-02]
 [ 7.57006171e-01 -6.40628080e-01]
 [ 3.85996049e-02  2.20637213e-02]
 [-1.78918958e-01  7.49650661e-02]
 [ 1.82267524e-01  1.74444215e-01]
 [ 5.24104944e-02  1.79824782e-01]
 [ 2.82635338e-01 -2.34356882e-03]
 [-4.13136885e-02  3.95559064e-02]
 [ 4.82984968e-01 -3.29943035e-01]
 [ 6.19887142e-02 -6.50493485e-03]
 [-1.36333194e-01 -1.78898101e-01]
 [-1.42265065e-01  1.48928520e-01]
 [-5.30320040e-01 -6.78364961e-01]
 [ 7.62963212e-02  2.21550332e-01]
 [ 5.41675039e-02 -2.05109973e-02]
 [-5.24014969e-02  2.38665917e-01]
 [-3.66561085e-02  1.28619154e-01]
 [ 1.48363119e-02  6.74181873e-02]
 [-8.28592348e-02 -3.88320592e-02]
 [ 2.14903459e-01  1.27210849e-01]
 [ 1.05415696e-02  1.02169049e-01]
 [ 1.95719247e-02  2.72471675e-01]
 [ 4.22492613e-02  1.71414140e-01]
 [ 3.77144251e-02  8.42621370e-02]
 [ 7.09752758e-01 -2.84731008e-01]
 [-1.32360114e-01  1.86485558e-01]
 [ 4.22091144e-02  3.56071720e-02]
 [ 2.56347824e-02 -1.29253531e-01]
 [-6.21631771e-02 -3.19720939e-02]
 [-5.41071700e-01 -1.02014219e-01]
 [-1.17935212e-01 -5.16016648e-06]
 [ 1.62399654e-01  1.57740186e-01]
 [ 1.93436121e-01  4.46821252e-02]
 [-2.65482473e-01 -1.77775588e-01]
 [ 1.05877313e-01 -3.15997664e-01]
 [-1.19330989e-01  2.52592721e-01]
 [-1.21734998e-01  1.18927616e-01]
 [ 9.24347693e-02  9.36414739e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.13277683]
curr_Stock_Price:  101.72078714178916
curr_Factors:  [1.01720787e+02 3.75524993e-02]
mat_Sqrt:  [[ 1.97119294e+01  0.00000000e+00]
 [-7.75138690e-03  1.77606586e-02]]
grads:  [4.33297413e-02 4.94312935e+01]
Stock Position:  0.04332974131879519
Bond Position:  [9.72524143]


portfolio before change:  [14.11039452]
curr_Stock_Price:  101.17617195647937
curr_Factors:  [1.01176172e+02 3.86457473e-02]
mat_Sqrt:  [[ 1.98897397e+01  0.00000000e+00]
 [-7.86340866e-03  1.80173327e-02]]
grads:  [-0.01073287 -4.08729079]
Stock Position:  -0.010732873669713844
Bond Position:  [15.19630559]


portfolio before change:  [14.11475868]
curr_Stock_Price:  100.94655044305063
curr_Factors:  [1.0094655e+02 3.9661464e-02]
mat_Sqrt:  [[ 2.01036934e+01  0.00000000e+00]
 [-7.96607446e-03  1.82525696e-02]]
grads:  [ 2.37475346e-02 -3.50979667e+01]
Stock Position:  0.023747534578491245
Bond Position:  [11.71752698]


portfolio before change:  [14.12504162]
curr_Stock_Price:  101.31787974443651
curr_Factors:  [1.01317880e+02 3.90180389e-02]
mat_Sqrt:  [[ 2.00133049e+01  0.00000000e+00]
 [-7.90119372e-03  1.81039092e-02]]
grads:  [0.00240985 1.21872691]
Stock Position:  0.0024098469766577757
Bond Position:  [13.88088103]


portfolio before change:  [14.13193573]
curr_Stock_Price:  103.45863614439264
curr_Factors:  [1.03458636e+02 3.89127432e-02]
mat_Sqrt:  [[ 2.04085746e+01  0.00000000e+00]
 [-7.89052528e-03  1.80794647e-02]]
grads:  [-0.00716373  4.14642067]
Stock Position:  -0.007163730111228127
Bond Position:  [14.87308548]


portfolio before change:  [14.13377394]
curr_Stock_Price:  103.46157313008685
curr_Factors:  [1.03461573e+02 4.09901508e-02]
mat_Sqrt:  [[ 2.09468555e+01  0.00000000e+00]
 [-8.09840980e-03  1.85557880e-02]]
grads:  [0.01233604 9.40106751]
Stock Position:  0.012336038765031716
Bond Position:  [12.85746797]


portfolio before change:  [14.12479871]
curr_Stock_Price:  102.60371925048062
curr_Factors:  [1.02603719e+02 4.07119954e-02]
mat_Sqrt:  [[ 2.07025717e+01  0.00000000e+00]
 [-8.07088549e-03  1.84927218e-02]]
grads:  [6.32252191e-03 9.72408405e+00]
Stock Position:  0.006322521907002216
Bond Position:  [13.47608444]


portfolio before change:  [14.12351489]
curr_Stock_Price:  102.13421825362494
curr_Factors:  [1.02134218e+02 4.09242324e-02]
mat_Sqrt:  [[ 2.06614854e+01  0.00000000e+00]
 [-8.09189544e-03  1.85408617e-02]]
grads:  [ 0.01362983 -0.12640021]
Stock Position:  0.013629829399654186
Bond Position:  [12.73144292]


portfolio before change:  [14.14782531]
curr_Stock_Price:  103.80106870690159
curr_Factors:  [1.03801069e+02 4.16991201e-02]
mat_Sqrt:  [[ 2.11965544e+01  0.00000000e+00]
 [-8.16814497e-03  1.87155713e-02]]
grads:  [-1.13462194e-03  2.11352920e+00]
Stock Position:  -0.001134621935989774
Bond Position:  [14.26560028]


portfolio before change:  [14.14982445]
curr_Stock_Price:  103.61084948950335
curr_Factors:  [1.03610849e+02 4.19803582e-02]
mat_Sqrt:  [[ 2.12289397e+01  0.00000000e+00]
 [-8.19564354e-03  1.87785784e-02]]
grads:  [ 1.59681089e-02 -1.75701817e+01]
Stock Position:  0.01596810892522588
Bond Position:  [12.49535512]


portfolio before change:  [14.14296649]
curr_Stock_Price:  103.0835500252343
curr_Factors:  [1.03083550e+02 4.29104232e-02]
mat_Sqrt:  [[ 2.13535834e+01  0.00000000e+00]
 [-8.28593249e-03  1.89854564e-02]]
grads:  [ 0.00277001 -0.34262726]
Stock Position:  0.002770014135218906
Bond Position:  [13.8574236]


portfolio before change:  [14.14137855]
curr_Stock_Price:  101.8849178649605
curr_Factors:  [1.01884918e+02 4.27720499e-02]
mat_Sqrt:  [[ 2.10712322e+01  0.00000000e+00]
 [-8.27256186e-03  1.89548205e-02]]
grads:  [-0.01017552 -9.4381322 ]
Stock Position:  -0.010175519170919
Bond Position:  [15.17811048]


portfolio before change:  [14.14845795]
curr_Stock_Price:  101.37565435188793
curr_Factors:  [1.01375654e+02 4.34440070e-02]
mat_Sqrt:  [[ 2.11299567e+01  0.00000000e+00]
 [-8.33729040e-03  1.91031322e-02]]
grads:  [-3.65676708e-03  7.79602624e+00]
Stock Position:  -0.0036567670835272203
Bond Position:  [14.51916511]


portfolio before change:  [14.14831193]
curr_Stock_Price:  101.91192987685864
curr_Factors:  [1.01911930e+02 4.32060861e-02]
mat_Sqrt:  [[ 2.11834889e+01  0.00000000e+00]
 [-8.31442949e-03  1.90507512e-02]]
grads:  [ -0.0390107  -35.60830502]
Stock Position:  -0.03901070245490888
Bond Position:  [18.1239679]


portfolio before change:  [14.19520036]
curr_Stock_Price:  100.76806950785085
curr_Factors:  [1.00768070e+02 4.42542689e-02]
mat_Sqrt:  [[ 2.11982751e+01  0.00000000e+00]
 [-8.41467945e-03  1.92804528e-02]]
grads:  [8.16051366e-03 1.14909300e+01]
Stock Position:  0.008160513659865734
Bond Position:  [13.37288115]


portfolio before change:  [14.19758955]
curr_Stock_Price:  100.85598942397773
curr_Factors:  [1.00855989e+02 4.27458993e-02]
mat_Sqrt:  [[ 2.08520580e+01  0.00000000e+00]
 [-8.27003258e-03  1.89490251e-02]]
grads:  [ 0.00216841 -1.08243021]
Stock Position:  0.002168408073822401
Bond Position:  [13.9788926]


portfolio before change:  [14.19952977]
curr_Stock_Price:  100.94488303399832
curr_Factors:  [1.00944883e+02 4.18995543e-02]
mat_Sqrt:  [[ 2.06627923e+01  0.00000000e+00]
 [-8.18775225e-03  1.87604972e-02]]
grads:  [2.50502681e-03 1.27217266e+01]
Stock Position:  0.002505026814250805
Bond Position:  [13.94666014]


portfolio before change:  [14.2065191]
curr_Stock_Price:  103.03902650153434
curr_Factors:  [1.03039027e+02 4.13297936e-02]
mat_Sqrt:  [[ 2.09475562e+01  0.00000000e+00]
 [-8.13189214e-03  1.86325056e-02]]
grads:  [9.29840803e-04 6.90294461e+00]
Stock Position:  0.0009298408030866412
Bond Position:  [14.11070921]


portfolio before change:  [14.20790998]
curr_Stock_Price:  102.63780234068557
curr_Factors:  [1.02637802e+02 4.14695532e-02]
mat_Sqrt:  [[ 2.09012386e+01  0.00000000e+00]
 [-8.14562982e-03  1.86639826e-02]]
grads:  [2.11757887e-03 3.61220800e+00]
Stock Position:  0.002117578867094421
Bond Position:  [13.99056633]


portfolio before change:  [14.2083287]
curr_Stock_Price:  102.00962801827164
curr_Factors:  [1.02009628e+02 4.13388645e-02]
mat_Sqrt:  [[ 2.07405580e+01  0.00000000e+00]
 [-8.13278447e-03  1.86345502e-02]]
grads:  [-0.00481216 -2.08387424]
Stock Position:  -0.00481216248381088
Bond Position:  [14.6992156]


portfolio before change:  [14.20949659]
curr_Stock_Price:  102.14878022988113
curr_Factors:  [1.02148780e+02 4.06558791e-02]
mat_Sqrt:  [[ 2.05965681e+01  0.00000000e+00]
 [-8.06532123e-03  1.84799725e-02]]
grads:  [0.01312951 6.88371419]
Stock Position:  0.0131295089342488
Bond Position:  [12.86833327]


portfolio before change:  [14.21190773]
curr_Stock_Price:  102.20990170508554
curr_Factors:  [1.02209902e+02 4.11503738e-02]
mat_Sqrt:  [[ 2.07338457e+01  0.00000000e+00]
 [-8.11422196e-03  1.85920182e-02]]
grads:  [2.65902424e-03 5.49531785e+00]
Stock Position:  0.0026590242381266892
Bond Position:  [13.94012912]


portfolio before change:  [14.21405937]
curr_Stock_Price:  102.36372437715133
curr_Factors:  [1.02363724e+02 4.19020215e-02]
mat_Sqrt:  [[ 2.09538373e+01  0.00000000e+00]
 [-8.18799331e-03  1.87610496e-02]]
grads:  [6.6092101e-03 1.4523264e+01]
Stock Position:  0.00660921009805758
Bond Position:  [13.53751601]


portfolio before change:  [14.21648888]
curr_Stock_Price:  102.47526799861981
curr_Factors:  [1.02475268e+02 4.12899762e-02]
mat_Sqrt:  [[ 2.08229079e+01  0.00000000e+00]
 [-8.12797404e-03  1.86235281e-02]]
grads:  [5.62171844e-03 9.20417115e+00]
Stock Position:  0.005621718437607515
Bond Position:  [13.64040178]


portfolio before change:  [14.21843662]
curr_Stock_Price:  102.518418302594
curr_Factors:  [1.02518418e+02 4.19553685e-02]
mat_Sqrt:  [[ 2.09988575e+01  0.00000000e+00]
 [-8.19320387e-03  1.87729884e-02]]
grads:  [3.54730902e-03 4.48847754e+00]
Stock Position:  0.0035473090181832503
Bond Position:  [13.85477211]


portfolio before change:  [14.21684182]
curr_Stock_Price:  101.58059295268679
curr_Factors:  [1.01580593e+02 4.05222198e-02]
mat_Sqrt:  [[ 2.04483070e+01  0.00000000e+00]
 [-8.05205264e-03  1.84495704e-02]]
grads:  [  0.02863249 -15.43293435]
Stock Position:  0.02863249056009677
Bond Position:  [11.30833645]


portfolio before change:  [14.23103997]
curr_Stock_Price:  102.02709713422138
curr_Factors:  [1.02027097e+02 3.97274901e-02]
mat_Sqrt:  [[ 2.03357921e+01  0.00000000e+00]
 [-7.97270243e-03  1.82677562e-02]]
grads:  [-2.50647449e-03  1.02084545e+01]
Stock Position:  -0.0025064744865098167
Bond Position:  [14.48676829]


portfolio before change:  [14.23341501]
curr_Stock_Price:  101.80205005400434
curr_Factors:  [1.01802050e+02 4.03612187e-02]
mat_Sqrt:  [[ 2.04521354e+01  0.00000000e+00]
 [-8.03604069e-03  1.84128824e-02]]
grads:  [0.00282363 1.93381847]
Stock Position:  0.0028236346559746502
Bond Position:  [13.94596321]


portfolio before change:  [14.23622405]
curr_Stock_Price:  102.17946662010674
curr_Factors:  [1.02179467e+02 3.88140004e-02]
mat_Sqrt:  [[ 2.01306517e+01  0.00000000e+00]
 [-7.88050764e-03  1.80565114e-02]]
grads:  [-1.52881703e-03 -7.15827814e+00]
Stock Position:  -0.001528817031179621
Bond Position:  [14.39243776]


portfolio before change:  [14.23846701]
curr_Stock_Price:  101.88918272908388
curr_Factors:  [1.01889183e+02 3.76089034e-02]
mat_Sqrt:  [[ 1.97593846e+01  0.00000000e+00]
 [-7.75720603e-03  1.77739919e-02]]
grads:  [-0.00385219 -1.79881335]
Stock Position:  -0.003852191985379117
Bond Position:  [14.6309637]


portfolio before change:  [14.242652]
curr_Stock_Price:  101.27758015804604
curr_Factors:  [1.01277580e+02 3.82270273e-02]
mat_Sqrt:  [[ 1.98015223e+01  0.00000000e+00]
 [-7.82069330e-03  1.79194595e-02]]
grads:  [-0.0295732  -5.69292944]
Stock Position:  -0.02957319874876857
Bond Position:  [17.23775401]


portfolio before change:  [14.21552312]
curr_Stock_Price:  102.2677922373673
curr_Factors:  [1.02267792e+02 3.74192243e-02]
mat_Sqrt:  [[ 1.97827321e+01  0.00000000e+00]
 [-7.73761971e-03  1.77291140e-02]]
grads:  [-0.00596164 -0.00029106]
Stock Position:  -0.0059616368187684005
Bond Position:  [14.82520655]


portfolio before change:  [14.21062499]
curr_Stock_Price:  103.40026496686686
curr_Factors:  [1.03400265e+02 3.68917300e-02]
mat_Sqrt:  [[ 1.98603164e+01  0.00000000e+00]
 [-7.68288799e-03  1.76037079e-02]]
grads:  [0.01164348 8.96062276]
Stock Position:  0.011643475905457137
Bond Position:  [13.0066865]


portfolio before change:  [14.21309867]
curr_Stock_Price:  103.47307344820148
curr_Factors:  [1.03473073e+02 3.58799999e-02]
mat_Sqrt:  [[ 1.95998869e+01  0.00000000e+00]
 [-7.57680671e-03  1.73606451e-02]]
grads:  [0.0108642  2.57375949]
Stock Position:  0.010864195276526456
Bond Position:  [13.088947]


portfolio before change:  [14.2073264]
curr_Stock_Price:  102.79115469764484
curr_Factors:  [1.02791155e+02 3.54938606e-02]
mat_Sqrt:  [[ 1.93656628e+01  0.00000000e+00]
 [-7.53592576e-03  1.72669751e-02]]
grads:  [ -0.01771538 -10.29569959]
Stock Position:  -0.017715381369508513
Bond Position:  [16.0283109]


portfolio before change:  [14.1968722]
curr_Stock_Price:  103.49437771922715
curr_Factors:  [1.03494378e+02 3.48457297e-02]
mat_Sqrt:  [[ 1.93193068e+01  0.00000000e+00]
 [-7.46680437e-03  1.71085981e-02]]
grads:  [-1.65820516e-03 -1.84701085e+01]
Stock Position:  -0.0016582051578227586
Bond Position:  [14.36848711]


portfolio before change:  [14.20119391]
curr_Stock_Price:  101.97132141996293
curr_Factors:  [1.01971321e+02 3.59130602e-02]
mat_Sqrt:  [[ 1.93243215e+01  0.00000000e+00]
 [-7.58029659e-03  1.73686415e-02]]
grads:  [-4.70416897e-04  1.45430327e+01]
Stock Position:  -0.0004704168969325199
Bond Position:  [14.24916294]


portfolio before change:  [14.20266631]
curr_Stock_Price:  102.62787871054832
curr_Factors:  [1.02627879e+02 3.65791380e-02]
mat_Sqrt:  [[ 1.96282728e+01  0.00000000e+00]
 [-7.65026933e-03  1.75289691e-02]]
grads:  [-3.55766049e-03  6.78463264e+00]
Stock Position:  -0.0035576604930334928
Bond Position:  [14.56778146]


portfolio before change:  [14.20715544]
curr_Stock_Price:  101.87793647711527
curr_Factors:  [1.01877936e+02 3.62861839e-02]
mat_Sqrt:  [[ 1.94066596e+01  0.00000000e+00]
 [-7.61957310e-03  1.74586353e-02]]
grads:  [0.00686894 5.36361935]
Stock Position:  0.0068689440471704265
Bond Position:  [13.50736159]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.20132899]
Stock Price:  100.78388584230657
PL:  [13.41744315]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.28866286e-01 -1.46301731e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.94307697e-01 -6.66002153e-01]
 [ 2.64699983e-02  2.27963177e-02]
 [-3.15602414e-02  1.59906549e-02]
 [-2.31734190e-02 -3.95797753e-03]
 [ 1.39071076e-02  3.03238382e-01]
 [ 2.86466616e-01 -2.64442885e-03]
 [ 1.26211563e-01  8.27954917e-02]
 [ 2.85596757e-01 -1.25812680e-01]
 [ 1.43634943e-01  2.82562317e-01]
 [ 1.41619006e-01  2.05332668e-01]
 [ 2.19322752e-01  2.27189263e-02]
 [-4.74395222e-02  1.87173192e-02]
 [ 9.75095231e-02  2.39290992e-01]
 [ 3.50797220e-02  2.00309203e-01]
 [ 1.47602316e-01  3.69005012e-01]
 [ 1.47766534e-01  7.57197891e-02]
 [ 3.60182006e-02 -7.67689417e-02]
 [ 3.42892060e-01 -1.15382314e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-1.34127031e-02  1.43033360e-01]
 [-1.61074423e-02 -5.01851330e-02]
 [-5.07858924e-02  3.83680103e-02]
 [ 3.89263750e-02  1.54898554e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 7.71284411e-02  1.70621888e-01]
 [-1.53332956e-01  7.66202686e-02]
 [-4.90909479e-01  1.05890795e-01]
 [ 2.92809923e-01 -3.42412185e-03]
 [-1.77742928e+00 -1.99731234e-01]
 [ 3.39760042e-01  6.19886505e-01]
 [ 5.54641199e-02 -1.50149759e-01]
 [ 2.13364564e-01 -3.72383190e-02]
 [ 1.75507188e-02  1.77087975e-01]
 [-2.58049436e+00  3.20387488e-01]
 [-1.60833534e-01  4.83050739e-02]
 [-1.32596133e-01 -3.96791351e-01]
 [ 2.05750493e+00 -1.53213514e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.50093158]
curr_Stock_Price:  99.06486524724917
curr_Factors:  [9.90648652e+01 4.01427257e-02]
mat_Sqrt:  [[ 1.98482893e+01  0.00000000e+00]
 [-8.01425986e-03  1.83629762e-02]]
grads:  [-0.01185248 -0.79672123]
Stock Position:  -0.011852478208657853
Bond Position:  [-2.32676742]


portfolio before change:  [-3.50655268]
curr_Stock_Price:  99.51458035766802
curr_Factors:  [9.95145804e+01 4.01363995e-02]
mat_Sqrt:  [[ 1.99368216e+01  0.00000000e+00]
 [-8.01362835e-03  1.83615292e-02]]
grads:  [-0.01018138 -4.79324837]
Stock Position:  -0.010181384604492937
Bond Position:  [-2.49335646]


portfolio before change:  [-3.51462796]
curr_Stock_Price:  100.27710845485636
curr_Factors:  [1.00277108e+02 4.03300181e-02]
mat_Sqrt:  [[ 2.01379849e+01  0.00000000e+00]
 [-8.03293402e-03  1.84057641e-02]]
grads:  [ 2.50094798e-02 -3.61844338e+01]
Stock Position:  0.025009479844969252
Bond Position:  [-6.02250628]


portfolio before change:  [-3.4956536]
curr_Stock_Price:  101.06589830881475
curr_Factors:  [1.01065898e+02 3.96179363e-02]
mat_Sqrt:  [[ 2.01164140e+01  0.00000000e+00]
 [-7.96170196e-03  1.82425509e-02]]
grads:  [0.00181042 1.24962335]
Stock Position:  0.0018104184446229774
Bond Position:  [-3.67862516]


portfolio before change:  [-3.49772938]
curr_Stock_Price:  100.17333011580807
curr_Factors:  [1.0017333e+02 4.0627834e-02]
mat_Sqrt:  [[ 2.01912844e+01  0.00000000e+00]
 [-8.06253896e-03  1.84735975e-02]]
grads:  [-0.00121742  0.86559507]
Stock Position:  -0.00121742366274447
Bond Position:  [-3.37577599]


portfolio before change:  [-3.49970212]
curr_Stock_Price:  101.44712662011563
curr_Factors:  [1.01447127e+02 3.98221526e-02]
mat_Sqrt:  [[ 2.02442698e+01  0.00000000e+00]
 [-7.98219544e-03  1.82895074e-02]]
grads:  [-0.00123002 -0.21640701]
Stock Position:  -0.0012300182844049822
Bond Position:  [-3.3749203]


portfolio before change:  [-3.5002498]
curr_Stock_Price:  101.54938980157283
curr_Factors:  [1.0154939e+02 3.9828452e-02]
mat_Sqrt:  [[ 2.02662797e+01  0.00000000e+00]
 [-7.98282677e-03  1.82909540e-02]]
grads:  [7.21647929e-03 1.65785985e+01]
Stock Position:  0.007216479291699055
Bond Position:  [-4.23307887]


portfolio before change:  [-3.49626394]
curr_Stock_Price:  102.17504513353373
curr_Factors:  [1.02175045e+02 4.24093259e-02]
mat_Sqrt:  [[ 2.10414431e+01  0.00000000e+00]
 [-8.23740988e-03  1.88742771e-02]]
grads:  [ 0.01355955 -0.14010756]
Stock Position:  0.013559549646344699
Bond Position:  [-4.88171154]


portfolio before change:  [-3.50852927]
curr_Stock_Price:  101.31549729676078
curr_Factors:  [1.01315497e+02 4.29935469e-02]
mat_Sqrt:  [[ 2.10076522e+01  0.00000000e+00]
 [-8.29395413e-03  1.90038363e-02]]
grads:  [0.00772797 4.35677778]
Stock Position:  0.007727968687355946
Bond Position:  [-4.29149227]


portfolio before change:  [-3.51703446]
curr_Stock_Price:  100.28434452328156
curr_Factors:  [1.00284345e+02 4.28027622e-02]
mat_Sqrt:  [[ 2.07476560e+01  0.00000000e+00]
 [-8.27553138e-03  1.89616245e-02]]
grads:  [ 0.01111873 -6.63512139]
Stock Position:  0.011118730797560806
Bond Position:  [-4.63206909]


portfolio before change:  [-3.54921184]
curr_Stock_Price:  97.44244338834761
curr_Factors:  [9.74424434e+01 4.47384811e-02]
mat_Sqrt:  [[ 2.06105121e+01  0.00000000e+00]
 [-8.46058921e-03  1.93856452e-02]]
grads:  [1.29523831e-02 1.45758531e+01]
Stock Position:  0.01295238305581249
Bond Position:  [-4.81132369]


portfolio before change:  [-3.54209023]
curr_Stock_Price:  98.03870878235568
curr_Factors:  [9.80387088e+01 4.26061116e-02]
mat_Sqrt:  [[ 2.02364129e+01  0.00000000e+00]
 [-8.25649917e-03  1.89180162e-02]]
grads:  [ 0.01142661 10.85381604]
Stock Position:  0.011426606567816284
Bond Position:  [-4.66233999]


portfolio before change:  [-3.55889273]
curr_Stock_Price:  96.6192439653221
curr_Factors:  [9.66192440e+01 4.16845824e-02]
mat_Sqrt:  [[ 1.97265602e+01  0.00000000e+00]
 [-8.16672099e-03  1.87123086e-02]]
grads:  [0.01162078 1.2141167 ]
Stock Position:  0.011620784479310527
Bond Position:  [-4.68168414]


portfolio before change:  [-3.57764376]
curr_Stock_Price:  95.05602871377928
curr_Factors:  [9.50560287e+01 4.13801570e-02]
mat_Sqrt:  [[ 1.93364050e+01  0.00000000e+00]
 [-8.13684528e-03  1.86438547e-02]]
grads:  [-0.00203092  1.00394042]
Stock Position:  -0.0020309160095667764
Bond Position:  [-3.38459295]


portfolio before change:  [-3.57830028]
curr_Stock_Price:  95.17095857580158
curr_Factors:  [9.51709586e+01 4.28550716e-02]
mat_Sqrt:  [[ 1.97017841e+01  0.00000000e+00]
 [-8.28058661e-03  1.89732075e-02]]
grads:  [1.02500704e-02 1.26120474e+01]
Stock Position:  0.010250070391332314
Bond Position:  [-4.5538093]


portfolio before change:  [-3.59235998]
curr_Stock_Price:  93.85482707146761
curr_Factors:  [9.38548271e+01 4.32040169e-02]
mat_Sqrt:  [[ 1.95082664e+01  0.00000000e+00]
 [-8.31423039e-03  1.90502951e-02]]
grads:  [6.27948290e-03 1.05147559e+01]
Stock Position:  0.006279482898442846
Bond Position:  [-4.18171976]


portfolio before change:  [-3.59395286]
curr_Stock_Price:  93.68440972735904
curr_Factors:  [9.36844097e+01 4.50763726e-02]
mat_Sqrt:  [[ 1.98903216e+01  0.00000000e+00]
 [-8.49247880e-03  1.94587135e-02]]
grads:  [1.55175624e-02 1.89634846e+01]
Stock Position:  0.015517562394415808
Bond Position:  [-5.04770653]


portfolio before change:  [-3.60078052]
curr_Stock_Price:  93.28507820783423
curr_Factors:  [9.32850782e+01 4.44302423e-02]
mat_Sqrt:  [[ 1.96630789e+01  0.00000000e+00]
 [-8.43139299e-03  1.93187483e-02]]
grads:  [0.00919558 3.91949768]
Stock Position:  0.009195577166860466
Bond Position:  [-4.45859065]


portfolio before change:  [-3.60117599]
curr_Stock_Price:  93.30268326488753
curr_Factors:  [9.33026833e+01 4.21829318e-02]
mat_Sqrt:  [[ 1.91629565e+01  0.00000000e+00]
 [-8.21539353e-03  1.88238314e-02]]
grads:  [ 1.31163874e-04 -4.07828461e+00]
Stock Position:  0.00013116387357406517
Bond Position:  [-3.61341393]


portfolio before change:  [-3.60146625]
curr_Stock_Price:  94.53351441695403
curr_Factors:  [9.45335144e+01 4.12675403e-02]
mat_Sqrt:  [[ 1.92039292e+01  0.00000000e+00]
 [-8.12576547e-03  1.86184677e-02]]
grads:  [ 0.01523309 -6.1971971 ]
Stock Position:  0.015233085205997384
Bond Position:  [-5.04150333]


portfolio before change:  [-3.59481288]
curr_Stock_Price:  95.01165768132631
curr_Factors:  [9.50116577e+01 4.09319409e-02]
mat_Sqrt:  [[ 1.92224201e+01  0.00000000e+00]
 [-8.09265750e-03  1.85426078e-02]]
grads:  [ 0.00219164 -2.0373612 ]
Stock Position:  0.002191639262623214
Bond Position:  [-3.80304416]


portfolio before change:  [-3.59548726]
curr_Stock_Price:  94.92087226993628
curr_Factors:  [9.49208723e+01 4.05923873e-02]
mat_Sqrt:  [[ 1.91242326e+01  0.00000000e+00]
 [-8.05902102e-03  1.84655369e-02]]
grads:  [2.56283083e-03 7.74596268e+00]
Stock Position:  0.0025628308277118616
Bond Position:  [-3.8387534]


portfolio before change:  [-3.59789733]
curr_Stock_Price:  94.16772083363578
curr_Factors:  [9.41677208e+01 4.13672453e-02]
mat_Sqrt:  [[ 1.91527156e+01  0.00000000e+00]
 [-8.13557573e-03  1.86409458e-02]]
grads:  [-1.98457654e-03 -2.69219886e+00]
Stock Position:  -0.001984576535016506
Bond Position:  [-3.41101428]


portfolio before change:  [-3.60119525]
curr_Stock_Price:  95.61463476781304
curr_Factors:  [9.56146348e+01 4.16590747e-02]
mat_Sqrt:  [[ 1.95154774e+01  0.00000000e+00]
 [-8.16422192e-03  1.87065825e-02]]
grads:  [-1.74429347e-03  2.05104328e+00]
Stock Position:  -0.0017442934703019324
Bond Position:  [-3.43441526]


portfolio before change:  [-3.59851813]
curr_Stock_Price:  93.83371326789643
curr_Factors:  [9.38337133e+01 4.30786808e-02]
mat_Sqrt:  [[ 1.94755666e+01  0.00000000e+00]
 [-8.30216172e-03  1.90226423e-02]]
grads:  [5.46991256e-03 8.14285164e+00]
Stock Position:  0.0054699125605576415
Bond Position:  [-4.11178033]


portfolio before change:  [-3.60527103]
curr_Stock_Price:  92.69312800722531
curr_Factors:  [9.26931280e+01 4.36235174e-02]
mat_Sqrt:  [[ 1.93601126e+01  0.00000000e+00]
 [-8.35449747e-03  1.91425585e-02]]
grads:  [6.48160697e-03 9.51119045e+00]
Stock Position:  0.006481606973031089
Bond Position:  [-4.20607146]


portfolio before change:  [-3.60648731]
curr_Stock_Price:  92.5865975282782
curr_Factors:  [9.25865975e+01 4.51633197e-02]
mat_Sqrt:  [[ 1.96761921e+01  0.00000000e+00]
 [-8.50066536e-03  1.94774712e-02]]
grads:  [7.70443475e-03 8.75996096e+00]
Stock Position:  0.007704434747479192
Bond Position:  [-4.31981471]


portfolio before change:  [-3.60937303]
curr_Stock_Price:  92.28213520913744
curr_Factors:  [9.22821352e+01 4.46846736e-02]
mat_Sqrt:  [[ 1.95072895e+01  0.00000000e+00]
 [-8.45549986e-03  1.93739841e-02]]
grads:  [-0.00614607  3.95480188]
Stock Position:  -0.006146068077011403
Bond Position:  [-3.04220075]


portfolio before change:  [-3.60633525]
curr_Stock_Price:  91.72599352070074
curr_Factors:  [9.17259935e+01 4.53080519e-02]
mat_Sqrt:  [[ 1.95245089e+01  0.00000000e+00]
 [-8.51427525e-03  1.95086554e-02]]
grads:  [-0.02277624  5.42788792]
Stock Position:  -0.022776242404923392
Bond Position:  [-1.51716179]


portfolio before change:  [-3.55492044]
curr_Stock_Price:  89.46027886247974
curr_Factors:  [8.94602789e+01 4.62830603e-02]
mat_Sqrt:  [[ 1.92460354e+01  0.00000000e+00]
 [-8.60539926e-03  1.97174468e-02]]
grads:  [ 0.01513639 -0.1736595 ]
Stock Position:  0.015136390804720635
Bond Position:  [-4.90902618]


portfolio before change:  [-3.56361979]
curr_Stock_Price:  88.9260903485284
curr_Factors:  [8.89260903e+01 4.66356525e-02]
mat_Sqrt:  [[ 1.92038466e+01  0.00000000e+00]
 [-8.63811577e-03  1.97924097e-02]]
grads:  [ -0.09709509 -10.09130457]
Stock Position:  -0.0970950858798283
Bond Position:  [5.07066659]


portfolio before change:  [-3.64922691]
curr_Stock_Price:  89.81430206707
curr_Factors:  [8.98143021e+01 4.58613955e-02]
mat_Sqrt:  [[ 1.92339788e+01  0.00000000e+00]
 [-8.56610954e-03  1.96274227e-02]]
grads:  [ 0.03173034 31.58267464]
Stock Position:  0.03173034038335723
Bond Position:  [-6.49906529]


portfolio before change:  [-3.66609337]
curr_Stock_Price:  89.3083502316443
curr_Factors:  [8.93083502e+01 4.63291918e-02]
mat_Sqrt:  [[ 1.92229231e+01  0.00000000e+00]
 [-8.60968681e-03  1.97272708e-02]]
grads:  [-5.23677244e-04 -7.61127888e+00]
Stock Position:  -0.0005236772439117036
Bond Position:  [-3.61932462]


portfolio before change:  [-3.66566546]
curr_Stock_Price:  87.62725648886386
curr_Factors:  [8.76272565e+01 4.80365413e-02]
mat_Sqrt:  [[ 1.92054762e+01  0.00000000e+00]
 [-8.76689604e-03  2.00874823e-02]]
grads:  [ 0.01026335 -1.85380718]
Stock Position:  0.010263345080288354
Bond Position:  [-4.56501423]


portfolio before change:  [-3.65528864]
curr_Stock_Price:  88.69391475751853
curr_Factors:  [8.86939148e+01 4.63248116e-02]
mat_Sqrt:  [[ 1.90897682e+01  0.00000000e+00]
 [-8.60927979e-03  1.97263382e-02]]
grads:  [4.96801462e-03 8.97723510e+00]
Stock Position:  0.004968014623224211
Bond Position:  [-4.09592131]


portfolio before change:  [-3.65989015]
curr_Stock_Price:  87.87075247077834
curr_Factors:  [8.78707525e+01 4.68222628e-02]
mat_Sqrt:  [[ 1.90138711e+01  0.00000000e+00]
 [-8.65538102e-03  1.98319693e-02]]
grads:  [-0.12836238 16.155102  ]
Stock Position:  -0.1283623829226691
Bond Position:  [7.61940903]


portfolio before change:  [-3.73034523]
curr_Stock_Price:  88.42704918202487
curr_Factors:  [8.84270492e+01 4.66862221e-02]
mat_Sqrt:  [[ 1.91064278e+01  0.00000000e+00]
 [-8.64279789e-03  1.98031378e-02]]
grads:  [-0.00731437  2.43926364]
Stock Position:  -0.007314369392979686
Bond Position:  [-3.08355713]


portfolio before change:  [-3.72410826]
curr_Stock_Price:  87.52164737848543
curr_Factors:  [8.75216474e+01 4.65154017e-02]
mat_Sqrt:  [[ 1.88761696e+01  0.00000000e+00]
 [-8.62697182e-03  1.97668757e-02]]
grads:  [-1.61987353e-02 -2.00735492e+01]
Stock Position:  -0.016198735302333046
Bond Position:  [-2.30636826]


portfolio before change:  [-3.70058064]
curr_Stock_Price:  86.05141325517924
curr_Factors:  [8.60514133e+01 4.85033952e-02]
mat_Sqrt:  [[ 1.89515213e+01  0.00000000e+00]
 [-8.80939455e-03  2.01848587e-02]]
grads:  [ 0.10503838 -7.59051708]
Stock Position:  0.10503837895629736
Bond Position:  [-12.7392816]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.54716201]
Stock Price:  87.52717037553718
PL:  [-3.54716201]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.36536600e-02  2.77208511e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.99151086e-01 -8.80565219e-01]
 [ 6.08577153e-03  3.24274501e-01]
 [-2.21657588e-03 -1.54673560e-01]
 [-7.75365175e-02 -9.25765870e-02]
 [-9.07749893e-02  1.38767614e-01]
 [-4.68615337e-02 -7.22324385e-02]
 [ 1.34977104e-01  8.00077693e-02]
 [ 3.32281794e-01 -1.60136947e-01]
 [ 1.02958519e-01  1.37535145e-01]
 [ 4.56285778e-02  1.67630392e-01]
 [ 8.50940819e-02  6.77572715e-02]
 [-3.37538967e-01 -4.51974076e-01]
 [ 8.15697540e-02  2.26557367e-01]
 [ 5.29436802e-02 -1.97312347e-02]
 [-5.22456067e-02  2.29902821e-01]
 [-1.67775234e-01 -6.60350814e-03]
 [ 1.49488052e-02  6.46249630e-02]
 [-1.21892091e-02 -8.53625010e-02]
 [ 1.00616193e-01  5.54393861e-03]
 [ 4.39041178e-02  2.11746893e-01]
 [ 3.76061016e-02  3.74225258e-01]
 [-8.05490254e-05  1.56412406e-01]
 [ 2.01399454e-02  4.72766421e-02]
 [ 6.31394627e-01 -1.93667074e-01]
 [ 1.28679827e-02  6.22079044e-02]
 [-1.52080951e-01  1.22329698e-01]
 [-4.96856254e-02 -1.12117819e-01]
 [ 5.78561211e-02 -5.98461549e-02]
 [-7.76502797e-01 -9.55865244e-02]
 [-1.18148302e-01  8.26701911e-03]
 [ 2.40113748e-02 -8.01450876e-02]
 [ 9.41174356e-02  9.56369944e-02]
 [-1.63139500e-01  7.47163337e-02]
 [-4.61761658e-01 -3.40524115e-01]
 [-7.52965442e-02  2.91901198e-01]
 [-1.23606052e-01  1.17665364e-01]
 [ 2.45744021e-01  7.44193429e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.02979533]
curr_Stock_Price:  99.8978822365515
curr_Factors:  [9.98978822e+01 4.00205296e-02]
mat_Sqrt:  [[ 1.99847030e+01  0.00000000e+00]
 [-8.00205270e-03  1.83350061e-02]]
grads:  [6.73702147e-03 1.51190847e+01]
Stock Position:  0.006737021468813321
Bond Position:  [1.35678115]


portfolio before change:  [2.0206371]
curr_Stock_Price:  98.5133183555684
curr_Factors:  [9.85133184e+01 3.99438843e-02]
mat_Sqrt:  [[ 1.96888385e+01  0.00000000e+00]
 [-7.99438646e-03  1.83174405e-02]]
grads:  [-0.01030962 -4.80478536]
Stock Position:  -0.010309620262975891
Bond Position:  [3.036272]


portfolio before change:  [2.03944933]
curr_Stock_Price:  96.72540875159129
curr_Factors:  [9.67254088e+01 4.08396034e-02]
mat_Sqrt:  [[ 1.95470549e+01  0.00000000e+00]
 [-8.08352432e-03  1.85216810e-02]]
grads:  [ 2.63385416e-02 -4.75424027e+01]
Stock Position:  0.026338541575360926
Bond Position:  [-0.50815687]


portfolio before change:  [2.00934095]
curr_Stock_Price:  95.5846904874825
curr_Factors:  [9.55846905e+01 4.08034366e-02]
mat_Sqrt:  [[ 1.93079742e+01  0.00000000e+00]
 [-8.07994421e-03  1.85134780e-02]]
grads:  [7.64506753e-03 1.75155906e+01]
Stock Position:  0.007645067532928346
Bond Position:  [1.27858953]


portfolio before change:  [2.00649752]
curr_Stock_Price:  95.19185402166353
curr_Factors:  [9.51918540e+01 4.01421657e-02]
mat_Sqrt:  [[ 1.90721733e+01  0.00000000e+00]
 [-8.01420396e-03  1.83628481e-02]]
grads:  [-3.65567418e-03 -8.42317915e+00]
Stock Position:  -0.0036556741786098394
Bond Position:  [2.35448792]


portfolio before change:  [2.00169188]
curr_Stock_Price:  96.58693799298041
curr_Factors:  [9.65869380e+01 3.89279934e-02]
mat_Sqrt:  [[ 1.90567750e+01  0.00000000e+00]
 [-7.89207131e-03  1.80830071e-02]]
grads:  [-0.00618889 -5.11953497]
Stock Position:  -0.006188888319964251
Bond Position:  [2.59945765]


portfolio before change:  [1.99577699]
curr_Stock_Price:  97.59517047488838
curr_Factors:  [9.75951705e+01 3.70738817e-02]
mat_Sqrt:  [[ 1.87915393e+01  0.00000000e+00]
 [-7.70183165e-03  1.76471133e-02]]
grads:  [-1.60773616e-03  7.86347389e+00]
Stock Position:  -0.001607736155118543
Bond Position:  [2.15268428]


portfolio before change:  [1.99366542]
curr_Stock_Price:  99.07593213299945
curr_Factors:  [9.90759321e+01 3.73759582e-02]
mat_Sqrt:  [[ 1.91542140e+01  0.00000000e+00]
 [-7.73314509e-03  1.77188614e-02]]
grads:  [-0.00409238 -4.07658466]
Stock Position:  -0.004092381682583272
Bond Position:  [2.39912195]


portfolio before change:  [1.98645876]
curr_Stock_Price:  100.91021051577404
curr_Factors:  [1.00910211e+02 3.71361684e-02]
mat_Sqrt:  [[ 1.94461512e+01  0.00000000e+00]
 [-7.70829874e-03  1.76619312e-02]]
grads:  [0.00873671 4.52995588]
Stock Position:  0.008736708637900693
Bond Position:  [1.10483565]


portfolio before change:  [1.99184221]
curr_Stock_Price:  101.51058903208055
curr_Factors:  [1.01510589e+02 3.86751098e-02]
mat_Sqrt:  [[ 1.99630606e+01  0.00000000e+00]
 [-7.86639534e-03  1.80241760e-02]]
grads:  [ 0.01314389 -8.8845641 ]
Stock Position:  0.013143891373655181
Bond Position:  [0.65759805]


portfolio before change:  [1.96469308]
curr_Stock_Price:  99.43880257392136
curr_Factors:  [9.94388026e+01 3.94593164e-02]
mat_Sqrt:  [[ 1.97528909e+01  0.00000000e+00]
 [-7.94574768e-03  1.82059951e-02]]
grads:  [0.00825114 7.55438768]
Stock Position:  0.008251135408248048
Bond Position:  [1.14421005]


portfolio before change:  [1.95862754]
curr_Stock_Price:  98.68635242711377
curr_Factors:  [9.86863524e+01 3.84300973e-02]
mat_Sqrt:  [[ 1.93460738e+01  0.00000000e+00]
 [-7.84143837e-03  1.79669924e-02]]
grads:  [6.14018536e-03 9.32990831e+00]
Stock Position:  0.006140185356674034
Bond Position:  [1.35267505]


portfolio before change:  [1.961573]
curr_Stock_Price:  99.13851519527647
curr_Factors:  [9.91385152e+01 3.81471175e-02]
mat_Sqrt:  [[ 1.93630280e+01  0.00000000e+00]
 [-7.81251483e-03  1.79007203e-02]]
grads:  [0.00592189 3.78517012]
Stock Position:  0.005921892979730677
Bond Position:  [1.37448532]


portfolio before change:  [1.96483154]
curr_Stock_Price:  99.65975396891614
curr_Factors:  [9.96597540e+01 3.79259312e-02]
mat_Sqrt:  [[ 1.94083197e+01  0.00000000e+00]
 [-7.78983247e-03  1.78487485e-02]]
grads:  [ -0.02755502 -25.32245198]
Stock Position:  -0.027555019428265208
Bond Position:  [4.710958]


portfolio before change:  [1.9718786]
curr_Stock_Price:  99.4253809385699
curr_Factors:  [9.94253809e+01 3.74291900e-02]
mat_Sqrt:  [[ 1.92354556e+01  0.00000000e+00]
 [-7.73865001e-03  1.77314747e-02]]
grads:  [9.38098368e-03 1.27771305e+01]
Stock Position:  0.00938098368480372
Bond Position:  [1.03917073]


portfolio before change:  [1.97290245]
curr_Stock_Price:  99.52067415699992
curr_Factors:  [9.95206742e+01 3.77528141e-02]
mat_Sqrt:  [[ 1.93369500e+01  0.00000000e+00]
 [-7.77203336e-03  1.78079656e-02]]
grads:  [ 0.00229262 -1.1080005 ]
Stock Position:  0.002292619228090102
Bond Position:  [1.74473944]


portfolio before change:  [1.97533474]
curr_Stock_Price:  100.48646262063171
curr_Factors:  [1.00486463e+02 3.69482413e-02]
mat_Sqrt:  [[ 1.93154328e+01  0.00000000e+00]
 [-7.68877012e-03  1.76171855e-02]]
grads:  [2.48983345e-03 1.30499177e+01]
Stock Position:  0.0024898334453203022
Bond Position:  [1.72514019]


portfolio before change:  [1.97560007]
curr_Stock_Price:  100.50641025724653
curr_Factors:  [1.00506410e+02 3.52739828e-02]
mat_Sqrt:  [[ 1.88764799e+01  0.00000000e+00]
 [-7.51254766e-03  1.72134092e-02]]
grads:  [-0.00904073 -0.38362582]
Stock Position:  -0.009040734373587208
Bond Position:  [2.88425182]


portfolio before change:  [1.96453157]
curr_Stock_Price:  101.77058323493043
curr_Factors:  [1.01770583e+02 3.55944622e-02]
mat_Sqrt:  [[ 1.92005417e+01  0.00000000e+00]
 [-7.54659788e-03  1.72914280e-02]]
grads:  [2.24751218e-03 3.73739884e+00]
Stock Position:  0.002247512182960001
Bond Position:  [1.73580094]


portfolio before change:  [1.96087018]
curr_Stock_Price:  100.04495213981119
curr_Factors:  [1.00044952e+02 3.73253307e-02]
mat_Sqrt:  [[ 1.93284493e+01  0.00000000e+00]
 [-7.72790587e-03  1.77068568e-02]]
grads:  [-2.55811824e-03 -4.82087261e+00]
Stock Position:  -0.0025581182438452698
Bond Position:  [2.216797]


portfolio before change:  [1.96175933]
curr_Stock_Price:  99.80569889986276
curr_Factors:  [9.98056989e+01 3.58712459e-02]
mat_Sqrt:  [[ 1.89029058e+01  0.00000000e+00]
 [-7.57588235e-03  1.73585272e-02]]
grads:  [0.00545079 0.3193784 ]
Stock Position:  0.0054507897872976205
Bond Position:  [1.41773945]


portfolio before change:  [1.96874634]
curr_Stock_Price:  101.05501788766892
curr_Factors:  [1.01055018e+02 3.61300996e-02]
mat_Sqrt:  [[ 1.92084563e+01  0.00000000e+00]
 [-7.60316772e-03  1.74210458e-02]]
grads:  [7.09677219e-03 1.21546602e+01]
Stock Position:  0.007096772188749629
Bond Position:  [1.2515819]


portfolio before change:  [1.96362611]
curr_Stock_Price:  100.31148423457674
curr_Factors:  [1.00311484e+02 3.52755249e-02]
mat_Sqrt:  [[ 1.88402820e+01  0.00000000e+00]
 [-7.51271188e-03  1.72137854e-02]]
grads:  [1.06649887e-02 2.17398584e+01]
Stock Position:  0.010664988677206336
Bond Position:  [0.89380526]


portfolio before change:  [1.96701952]
curr_Stock_Price:  100.61919068308708
curr_Factors:  [1.00619191e+02 3.56933498e-02]
mat_Sqrt:  [[ 1.90096654e+01  0.00000000e+00]
 [-7.55707348e-03  1.73154306e-02]]
grads:  [3.58677650e-03 9.03312248e+00]
Stock Position:  0.0035867765034804685
Bond Position:  [1.60612098]


portfolio before change:  [1.96549347]
curr_Stock_Price:  100.13774532379777
curr_Factors:  [1.00137745e+02 3.50794196e-02]
mat_Sqrt:  [[ 1.87552997e+01  0.00000000e+00]
 [-7.49180028e-03  1.71658709e-02]]
grads:  [2.17395426e-03 2.75410682e+00]
Stock Position:  0.002173954257322246
Bond Position:  [1.74779859]


portfolio before change:  [1.96642196]
curr_Stock_Price:  100.4643398298685
curr_Factors:  [1.00464340e+02 3.61994403e-02]
mat_Sqrt:  [[ 1.91144965e+01  0.00000000e+00]
 [-7.61046020e-03  1.74377550e-02]]
grads:  [  0.0286103  -11.10619308]
Stock Position:  0.028610295174072653
Bond Position:  [-0.90789246]


portfolio before change:  [1.95182616]
curr_Stock_Price:  99.95814777150166
curr_Factors:  [9.99581478e+01 3.68545386e-02]
mat_Sqrt:  [[ 1.91895013e+01  0.00000000e+00]
 [-7.67901438e-03  1.75948323e-02]]
grads:  [2.08539749e-03 3.53557813e+00]
Stock Position:  0.002085397491246139
Bond Position:  [1.74337369]


portfolio before change:  [1.95187845]
curr_Stock_Price:  99.87871932471987
curr_Factors:  [9.98787193e+01 3.63996285e-02]
mat_Sqrt:  [[ 1.90555479e+01  0.00000000e+00]
 [-7.63147467e-03  1.74859052e-02]]
grads:  [-5.17916850e-03  6.99590308e+00]
Stock Position:  -0.005179168495431106
Bond Position:  [2.46916717]


portfolio before change:  [1.9583488]
curr_Stock_Price:  98.6890143972602
curr_Factors:  [9.86890144e+01 3.73003509e-02]
mat_Sqrt:  [[ 1.90601042e+01  0.00000000e+00]
 [-7.72531951e-03  1.77009307e-02]]
grads:  [-5.17404586e-03 -6.33400699e+00]
Stock Position:  -0.005174045855254001
Bond Position:  [2.46897029]


portfolio before change:  [1.9590387]
curr_Stock_Price:  98.6153275054824
curr_Factors:  [9.86153275e+01 3.74307426e-02]
mat_Sqrt:  [[ 1.90791333e+01  0.00000000e+00]
 [-7.73881051e-03  1.77318425e-02]]
grads:  [ 1.66344651e-03 -3.37506692e+00]
Stock Position:  0.0016634465084369907
Bond Position:  [1.79499738]


portfolio before change:  [1.95960226]
curr_Stock_Price:  98.81922552771591
curr_Factors:  [9.88192255e+01 3.75134606e-02]
mat_Sqrt:  [[ 1.91396949e+01  0.00000000e+00]
 [-7.74735678e-03  1.77514244e-02]]
grads:  [-0.04274991 -5.38472418]
Stock Position:  -0.04274990693090755
Bond Position:  [6.18411496]


portfolio before change:  [1.96128849]
curr_Stock_Price:  98.79786500255648
curr_Factors:  [9.87978650e+01 3.85993298e-02]
mat_Sqrt:  [[ 1.94105321e+01  0.00000000e+00]
 [-7.85868485e-03  1.80065091e-02]]
grads:  [-0.00590093  0.45911282]
Stock Position:  -0.005900934526727999
Bond Position:  [2.54428822]


portfolio before change:  [1.95858213]
curr_Stock_Price:  99.31039581829369
curr_Factors:  [9.93103958e+01 3.76859302e-02]
mat_Sqrt:  [[ 1.92789924e+01  0.00000000e+00]
 [-7.76514574e-03  1.77921841e-02]]
grads:  [-5.68847626e-04 -4.50451093e+00]
Stock Position:  -0.0005688476255869337
Bond Position:  [2.01507461]


portfolio before change:  [1.95900091]
curr_Stock_Price:  99.01704099742518
curr_Factors:  [9.90170410e+01 3.77439756e-02]
mat_Sqrt:  [[ 1.92368414e+01  0.00000000e+00]
 [-7.77112353e-03  1.78058809e-02]]
grads:  [0.00706233 5.37109031]
Stock Position:  0.007062325820131988
Bond Position:  [1.2597103]


portfolio before change:  [1.95778476]
curr_Stock_Price:  98.82254092383364
curr_Factors:  [9.88225409e+01 3.70216755e-02]
mat_Sqrt:  [[ 1.90144624e+01  0.00000000e+00]
 [-7.69640701e-03  1.76346838e-02]]
grads:  [-0.00686481  4.2368967 ]
Stock Position:  -0.006864807211173597
Bond Position:  [2.63618245]


portfolio before change:  [1.95495887]
curr_Stock_Price:  99.28219456855953
curr_Factors:  [9.92821946e+01 3.71988297e-02]
mat_Sqrt:  [[ 1.91485550e+01  0.00000000e+00]
 [-7.71479925e-03  1.76768258e-02]]
grads:  [ -0.03187596 -19.26387233]
Stock Position:  -0.03187595962440024
Bond Position:  [5.11967409]


portfolio before change:  [1.91856533]
curr_Stock_Price:  100.44399597969758
curr_Factors:  [1.00443996e+02 3.58252741e-02]
mat_Sqrt:  [[ 1.90116033e+01  0.00000000e+00]
 [-7.57102626e-03  1.73474005e-02]]
grads:  [2.74040974e-03 1.68267977e+01]
Stock Position:  0.0027404097391577004
Bond Position:  [1.64330763]


portfolio before change:  [1.91854086]
curr_Stock_Price:  100.36010403925228
curr_Factors:  [1.00360104e+02 3.59692308e-02]
mat_Sqrt:  [[ 1.90338516e+01  0.00000000e+00]
 [-7.58622233e-03  1.73822190e-02]]
grads:  [-3.79600929e-03  6.76929477e+00]
Stock Position:  -0.003796009286810425
Bond Position:  [2.29950875]


portfolio before change:  [1.9170376]
curr_Stock_Price:  100.83183997071009
curr_Factors:  [1.00831840e+02 3.65988223e-02]
mat_Sqrt:  [[ 1.92899565e+01  0.00000000e+00]
 [-7.65232747e-03  1.75336849e-02]]
grads:  [0.01442322 4.2443641 ]
Stock Position:  0.014423219982491842
Bond Position:  [0.46271779]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.90663753]
Stock Price:  100.10676489134082
PL:  [1.79987264]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.80766170e-01 -1.74249798e-01]
 [-1.78489961e-01 -7.74701478e-02]
 [ 7.95846000e-01 -6.67048572e-01]
 [ 4.56894369e-02  2.16355140e-02]
 [-1.76676921e-01  7.40677810e-02]
 [ 8.72808568e-02  1.00005920e-01]
 [ 7.10122879e-02  1.07845379e-01]
 [ 5.91756068e-01 -2.84156416e-02]
 [-3.93346794e-01 -2.32497321e-01]
 [ 6.35770638e-01 -5.24226899e-01]
 [ 5.71138584e-02 -2.47624125e-02]
 [-5.25512480e-01 -2.47490080e-01]
 [-1.59933308e-01  1.48582210e-01]
 [-6.55588534e-01 -8.48085903e-01]
 [ 1.84330336e-02 -3.68298276e-02]
 [ 5.11835233e-02 -6.75105446e-02]
 [-5.30295828e-02  2.73972658e-01]
 [-1.43392565e-01  1.79962662e-02]
 [ 1.49931958e-02  6.35227367e-02]
 [-5.55646439e-02 -6.09498785e-02]
 [ 8.92362489e-02 -6.19420675e-03]
 [ 2.08004057e-02  1.15041672e-01]
 [ 3.85444218e-02  4.20065533e-01]
 [ 1.73038050e-02  1.62728799e-01]
 [ 2.86051894e-02  6.50666590e-02]
 [ 7.32052660e-01 -3.85334183e-01]
 [-1.67163009e-01  2.28664130e-01]
 [ 1.76267566e-02  4.65727121e-02]
 [ 4.82481925e-02 -1.49586898e-01]
 [-5.80815860e-02 -3.29027798e-02]
 [-4.40386340e-01 -9.80213475e-02]
 [-1.17965854e-01  1.18437130e-03]
 [ 1.17805813e-01  8.34284087e-02]
 [ 1.33275536e-01  7.55471603e-02]
 [-2.74280580e-01 -1.24203173e-01]
 [-2.16098950e-01 -3.94614895e-01]
 [-5.44007971e-02  3.02558975e-01]
 [-1.23737919e-01  1.17576404e-01]
 [ 3.89862055e-01  5.56570375e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.19294731]
curr_Stock_Price:  98.50878792070887
curr_Factors:  [9.85087879e+01 4.04044274e-02]
mat_Sqrt:  [[ 1.98011062e+01  0.00000000e+00]
 [-8.04034102e-03  1.84227357e-02]]
grads:  [-0.02307018 -9.45841056]
Stock Position:  -0.023070176569109854
Bond Position:  [-4.92033218]


portfolio before change:  [-7.2398418]
curr_Stock_Price:  100.51481538695819
curr_Factors:  [1.00514815e+02 3.96830456e-02]
mat_Sqrt:  [[ 2.00231581e+01  0.00000000e+00]
 [-7.96824152e-03  1.82575350e-02]]
grads:  [-0.01060276 -4.2431877 ]
Stock Position:  -0.01060275828723685
Bond Position:  [-6.17410751]


portfolio before change:  [-7.25367949]
curr_Stock_Price:  101.7471242376315
curr_Factors:  [1.01747124e+02 3.96527377e-02]
mat_Sqrt:  [[ 2.02608999e+01  0.00000000e+00]
 [-7.96519807e-03  1.82505615e-02]]
grads:  [ 2.49111410e-02 -3.65494821e+01]
Stock Position:  0.024911141045712498
Bond Position:  [-9.78831645]


portfolio before change:  [-7.26194115]
curr_Stock_Price:  101.46459811547612
curr_Factors:  [1.01464598e+02 3.95599042e-02]
mat_Sqrt:  [[ 2.01809755e+01  0.00000000e+00]
 [-7.95586870e-03  1.82291853e-02]]
grads:  [0.00273188 1.18686127]
Stock Position:  0.0027318773223830813
Bond Position:  [-7.53912998]


portfolio before change:  [-7.25763816]
curr_Stock_Price:  103.38468343372948
curr_Factors:  [1.03384683e+02 3.92427626e-02]
mat_Sqrt:  [[ 2.04802847e+01  0.00000000e+00]
 [-7.92391445e-03  1.81559689e-02]]
grads:  [-0.0070483   4.07952786]
Stock Position:  -0.007048295146726027
Bond Position:  [-6.5289524]


portfolio before change:  [-7.25299184]
curr_Stock_Price:  102.60967422068954
curr_Factors:  [1.02609674e+02 3.91211048e-02]
mat_Sqrt:  [[ 2.02952247e+01  0.00000000e+00]
 [-7.91162231e-03  1.81278041e-02]]
grads:  [0.00645112 5.51671455]
Stock Position:  0.0064511243756393225
Bond Position:  [-7.91493961]


portfolio before change:  [-7.25070994]
curr_Stock_Price:  103.11676917301462
curr_Factors:  [1.03116769e+02 3.79392461e-02]
mat_Sqrt:  [[ 2.00850837e+01  0.00000000e+00]
 [-7.79119977e-03  1.78518813e-02]]
grads:  [5.87898322e-03 6.04112119e+00]
Stock Position:  0.0058789832156093905
Bond Position:  [-7.85693169]


portfolio before change:  [-7.23552233]
curr_Stock_Price:  105.86720722150557
curr_Factors:  [1.05867207e+02 3.67738755e-02]
mat_Sqrt:  [[ 2.03016416e+01  0.00000000e+00]
 [-7.67060629e-03  1.75755670e-02]]
grads:  [ 0.02853732 -1.61676956]
Stock Position:  0.028537321083067852
Bond Position:  [-10.25668882]


portfolio before change:  [-7.21402093]
curr_Stock_Price:  106.66558508738999
curr_Factors:  [1.06665585e+02 3.68870882e-02]
mat_Sqrt:  [[ 2.04862047e+01  0.00000000e+00]
 [-7.68240464e-03  1.76026004e-02]]
grads:  [ -0.02415367 -13.20812355]
Stock Position:  -0.02415366594084422
Bond Position:  [-4.63765603]


portfolio before change:  [-7.19372209]
curr_Stock_Price:  105.801178655554
curr_Factors:  [1.05801179e+02 3.67824603e-02]
mat_Sqrt:  [[ 2.02913477e+01  0.00000000e+00]
 [-7.67150158e-03  1.75776183e-02]]
grads:  [ 2.00567881e-02 -2.98235454e+01]
Stock Position:  0.020056788130111712
Bond Position:  [-9.31575392]


portfolio before change:  [-7.19742623]
curr_Stock_Price:  105.67455823710596
curr_Factors:  [1.05674558e+02 3.77964816e-02]
mat_Sqrt:  [[ 2.05445261e+01  0.00000000e+00]
 [-7.77652689e-03  1.78182616e-02]]
grads:  [ 0.00225397 -1.38972101]
Stock Position:  0.002253965622558963
Bond Position:  [-7.43561306]


portfolio before change:  [-7.1963977]
curr_Stock_Price:  106.54326814695139
curr_Factors:  [1.06543268e+02 3.76395213e-02]
mat_Sqrt:  [[ 2.06703609e+01  0.00000000e+00]
 [-7.76036302e-03  1.77812255e-02]]
grads:  [ -0.03064901 -13.9186177 ]
Stock Position:  -0.03064900549570572
Bond Position:  [-3.93095249]


portfolio before change:  [-7.1106064]
curr_Stock_Price:  103.72808059287128
curr_Factors:  [1.03728081e+02 3.93890929e-02]
mat_Sqrt:  [[ 2.05865860e+01  0.00000000e+00]
 [-7.93867424e-03  1.81897878e-02]]
grads:  [-4.61886760e-03  8.16844108e+00]
Stock Position:  -0.004618867600623783
Bond Position:  [-6.63150013]


portfolio before change:  [-7.11011827]
curr_Stock_Price:  103.44291984269887
curr_Factors:  [1.03442920e+02 3.94794733e-02]
mat_Sqrt:  [[ 2.05535312e+01  0.00000000e+00]
 [-7.94777688e-03  1.82106446e-02]]
grads:  [ -0.04990498 -46.5708888 ]
Stock Position:  -0.049904980304604545
Bond Position:  [-1.9478014]


portfolio before change:  [-7.10208023]
curr_Stock_Price:  103.2769737650494
curr_Factors:  [1.03276974e+02 4.17593788e-02]
mat_Sqrt:  [[ 2.11047649e+01  0.00000000e+00]
 [-8.17404466e-03  1.87290892e-02]]
grads:  [ 1.11784188e-04 -1.96645054e+00]
Stock Position:  0.00011178418849765601
Bond Position:  [-7.11362496]


portfolio before change:  [-7.10297479]
curr_Stock_Price:  103.22955454712937
curr_Factors:  [1.03229555e+02 4.15094943e-02]
mat_Sqrt:  [[ 2.10318645e+01  0.00000000e+00]
 [-8.14955157e-03  1.86729685e-02]]
grads:  [ 1.03269523e-03 -3.61541576e+00]
Stock Position:  0.0010326952278765437
Bond Position:  [-7.20957946]


portfolio before change:  [-7.10457788]
curr_Stock_Price:  102.54993246982194
curr_Factors:  [1.02549932e+02 4.09503682e-02]
mat_Sqrt:  [[ 2.07522067e+01  0.00000000e+00]
 [-8.09447893e-03  1.85467812e-02]]
grads:  [3.20649697e-03 1.47719788e+01]
Stock Position:  0.003206496973598108
Bond Position:  [-7.43340393]


portfolio before change:  [-7.1103711]
curr_Stock_Price:  101.03301636419742
curr_Factors:  [1.01033016e+02 3.97957366e-02]
mat_Sqrt:  [[ 2.01549439e+01  0.00000000e+00]
 [-7.97954752e-03  1.82834403e-02]]
grads:  [-0.00672482  0.98429321]
Stock Position:  -0.006724819072994391
Bond Position:  [-6.43094235]


portfolio before change:  [-7.11220329]
curr_Stock_Price:  101.18592342493439
curr_Factors:  [1.01185923e+02 4.01780658e-02]
mat_Sqrt:  [[ 2.02821791e+01  0.00000000e+00]
 [-8.01778681e-03  1.83710575e-02]]
grads:  [2.10612434e-03 3.45776158e+00]
Stock Position:  0.002106124341295209
Bond Position:  [-7.32531343]


portfolio before change:  [-7.1132839]
curr_Stock_Price:  101.10763311355369
curr_Factors:  [1.01107633e+02 3.97477115e-02]
mat_Sqrt:  [[ 2.01576550e+01  0.00000000e+00]
 [-7.97473125e-03  1.82724048e-02]]
grads:  [-0.00407614 -3.33562435]
Stock Position:  -0.004076136415330371
Bond Position:  [-6.7011554]


portfolio before change:  [-7.10786929]
curr_Stock_Price:  99.57375097772277
curr_Factors:  [9.95737510e+01 3.89962588e-02]
mat_Sqrt:  [[ 1.96632970e+01  0.00000000e+00]
 [-7.89898817e-03  1.80988556e-02]]
grads:  [ 0.00440073 -0.34224301]
Stock Position:  0.0044007307267874595
Bond Position:  [-7.54606655]


portfolio before change:  [-7.09841802]
curr_Stock_Price:  101.93576479990472
curr_Factors:  [1.01935765e+02 3.86275459e-02]
mat_Sqrt:  [[ 2.00343448e+01  0.00000000e+00]
 [-7.86155668e-03  1.80130893e-02]]
grads:  [3.54434887e-03 6.38655978e+00]
Stock Position:  0.0035443488673662584
Bond Position:  [-7.45971393]


portfolio before change:  [-7.10199173]
curr_Stock_Price:  101.19058112192971
curr_Factors:  [1.01190581e+02 3.98645110e-02]
mat_Sqrt:  [[ 2.02038116e+01  0.00000000e+00]
 [-7.98643961e-03  1.82992320e-02]]
grads:  [1.09818907e-02 2.29553640e+01]
Stock Position:  0.010981890672318194
Bond Position:  [-8.21325563]


portfolio before change:  [-7.10127124]
curr_Stock_Price:  101.34968083699347
curr_Factors:  [1.01349681e+02 4.00927110e-02]
mat_Sqrt:  [[ 2.02934131e+01  0.00000000e+00]
 [-8.00926573e-03  1.83515332e-02]]
grads:  [4.35237163e-03 8.86731355e+00]
Stock Position:  0.004352371626475659
Bond Position:  [-7.54238271]


portfolio before change:  [-7.10269795]
curr_Stock_Price:  101.23850971326634
curr_Factors:  [1.01238510e+02 4.05859931e-02]
mat_Sqrt:  [[ 2.03954754e+01  0.00000000e+00]
 [-8.05838625e-03  1.84640825e-02]]
grads:  [2.79486535e-03 3.52395842e+00]
Stock Position:  0.0027948653524455845
Bond Position:  [-7.38564596]


portfolio before change:  [-7.09938619]
curr_Stock_Price:  102.75379762966189
curr_Factors:  [1.02753798e+02 3.93000873e-02]
mat_Sqrt:  [[ 2.03701693e+01  0.00000000e+00]
 [-7.92969985e-03  1.81692249e-02]]
grads:  [  0.02768161 -21.20806945]
Stock Position:  0.027681607649264566
Bond Position:  [-9.9437765]


portfolio before change:  [-7.11136665]
curr_Stock_Price:  102.36590778031915
curr_Factors:  [1.02365908e+02 3.96743638e-02]
mat_Sqrt:  [[ 2.03896761e+01  0.00000000e+00]
 [-7.96736983e-03  1.82555377e-02]]
grads:  [-3.30391717e-03  1.25257406e+01]
Stock Position:  -0.003303917172436049
Bond Position:  [-6.77315817]


portfolio before change:  [-7.10953679]
curr_Stock_Price:  101.55578902494766
curr_Factors:  [1.01555789e+02 3.86457637e-02]
mat_Sqrt:  [[ 1.99643710e+01  0.00000000e+00]
 [-7.86341033e-03  1.80173365e-02]]
grads:  [1.90102431e-03 2.58488329e+00]
Stock Position:  0.0019010243084073017
Bond Position:  [-7.30259681]


portfolio before change:  [-7.11010245]
curr_Stock_Price:  101.73843960672586
curr_Factors:  [1.01738440e+02 3.86733118e-02]
mat_Sqrt:  [[ 2.00074046e+01  0.00000000e+00]
 [-7.86621249e-03  1.80237571e-02]]
grads:  [-8.51528838e-04 -8.29942931e+00]
Stock Position:  -0.000851528837714764
Bond Position:  [-7.02346923]


portfolio before change:  [-7.11100667]
curr_Stock_Price:  101.76924834280311
curr_Factors:  [1.01769248e+02 3.95586800e-02]
mat_Sqrt:  [[ 2.02412562e+01  0.00000000e+00]
 [-7.95574559e-03  1.82289032e-02]]
grads:  [-0.00357891 -1.80497858]
Stock Position:  -0.0035789051575834396
Bond Position:  [-6.74678418]


portfolio before change:  [-7.11289352]
curr_Stock_Price:  102.06080444398977
curr_Factors:  [1.02060804e+02 3.91242042e-02]
mat_Sqrt:  [[ 2.01874631e+01  0.00000000e+00]
 [-7.91193571e-03  1.81285221e-02]]
grads:  [-0.02393398 -5.40702363]
Stock Position:  -0.023933981284718377
Bond Position:  [-4.67017214]


portfolio before change:  [-7.10566976]
curr_Stock_Price:  101.7345917188974
curr_Factors:  [1.01734592e+02 3.99908305e-02]
mat_Sqrt:  [[ 2.03445861e+01  0.00000000e+00]
 [-7.99908299e-03  1.83282017e-02]]
grads:  [-0.00577298  0.06462016]
Stock Position:  -0.005772983139232991
Bond Position:  [-6.51835768]


portfolio before change:  [-7.10627039]
curr_Stock_Price:  101.6974846953919
curr_Factors:  [1.01697485e+02 4.00148315e-02]
mat_Sqrt:  [[ 2.03432674e+01  0.00000000e+00]
 [-8.00148301e-03  1.83337008e-02]]
grads:  [0.00758074 4.55054927]
Stock Position:  0.007580736799998912
Bond Position:  [-7.87721225]


portfolio before change:  [-7.1157219]
curr_Stock_Price:  100.58060122429764
curr_Factors:  [1.00580601e+02 4.14426603e-02]
mat_Sqrt:  [[ 2.04756662e+01  0.00000000e+00]
 [-8.14298818e-03  1.86579299e-02]]
grads:  [0.00811925 4.04906444]
Stock Position:  0.008119248423351473
Bond Position:  [-7.93236079]


portfolio before change:  [-7.11694427]
curr_Stock_Price:  100.55217962863307
curr_Factors:  [1.00552180e+02 4.14057032e-02]
mat_Sqrt:  [[ 2.04607511e+01  0.00000000e+00]
 [-8.13935656e-03  1.86496088e-02]]
grads:  [-0.01605451 -6.65982727]
Stock Position:  -0.016054507835554427
Bond Position:  [-5.50262851]


portfolio before change:  [-7.12390971]
curr_Stock_Price:  100.94319581166032
curr_Factors:  [1.00943196e+02 4.00725242e-02]
mat_Sqrt:  [[ 2.02069329e+01  0.00000000e+00]
 [-8.00724913e-03  1.83469126e-02]]
grads:  [-1.92173157e-02 -2.15085177e+01]
Stock Position:  -0.019217315682401995
Bond Position:  [-5.18405245]


portfolio before change:  [-7.09963572]
curr_Stock_Price:  99.64634262141617
curr_Factors:  [9.96463426e+01 3.97002360e-02]
mat_Sqrt:  [[ 1.98544521e+01  0.00000000e+00]
 [-7.96996722e-03  1.82614890e-02]]
grads:  [3.91079869e-03 1.65681437e+01]
Stock Position:  0.003910798686180307
Bond Position:  [-7.48933251]


portfolio before change:  [-7.09994808]
curr_Stock_Price:  99.80586744416439
curr_Factors:  [9.98058674e+01 3.68042224e-02]
mat_Sqrt:  [[ 1.91471834e+01  0.00000000e+00]
 [-7.67377064e-03  1.75828174e-02]]
grads:  [-3.78245552e-03  6.68700592e+00]
Stock Position:  -0.0037824555248555064
Bond Position:  [-6.72243682]


portfolio before change:  [-7.10129435]
curr_Stock_Price:  99.93962090695254
curr_Factors:  [9.99396209e+01 3.61132352e-02]
mat_Sqrt:  [[ 1.89920085e+01  0.00000000e+00]
 [-7.60139305e-03  1.74169795e-02]]
grads:  [0.02180669 3.19556197]
Stock Position:  0.021806686614986217
Bond Position:  [-9.28064635]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.09800598]
Stock Price:  100.14361933796728
PL:  [-7.24162531]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.73069928e-01  5.98934386e-01]
 [-1.76679181e-01 -7.19869730e-02]
 [ 7.56861081e-01 -6.40529383e-01]
 [-3.09233154e-02  3.46873124e-02]
 [-1.65845995e-02  9.99725532e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-4.00200438e-02  2.07657343e-01]
 [-6.80968556e-02 -7.66691193e-02]
 [ 1.62216946e-01  7.87941043e-02]
 [ 1.49994558e-01  2.01917829e-02]
 [ 1.12300230e-01  1.70841955e-01]
 [-2.62238500e-02  1.16495496e-01]
 [ 2.28010374e-01  2.19540212e-02]
 [-1.64601708e-01 -1.97053046e-01]
 [ 9.87936393e-02  2.38594763e-01]
 [ 3.12494775e-02  2.51022890e-01]
 [ 1.90868930e-01  4.97613501e-01]
 [ 1.58990130e-01  7.12332081e-02]
 [ 5.17707065e-02 -1.15217943e-01]
 [ 5.74394043e-01 -1.38373338e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-1.08533141e-02 -1.25337054e-02]
 [-8.18473866e-02 -1.48521594e-02]
 [ 9.00648339e-02 -4.08332952e-01]
 [ 9.42196232e-02  3.04999193e-01]
 [-5.09890649e-02  8.95484202e-02]
 [-3.07617745e-02  1.51759597e-01]
 [-1.31392551e-01  2.67891142e-02]
 [-8.02990550e-01  1.96956703e-01]
 [ 2.98879800e-01  1.75982864e-01]
 [-1.91902940e+00 -2.15010648e-01]
 [ 3.73306475e-01  6.80358661e-01]
 [ 5.74555066e-02 -1.50705917e-01]
 [ 1.13039230e-01  2.62866236e-03]
 [ 1.36734922e-02  1.76012316e-01]
 [-2.53569210e+00  1.00545045e-01]
 [-1.21098256e-01  1.22939229e-01]
 [-1.35005971e-01 -1.33471710e-01]
 [ 1.60835065e+00 -9.48068261e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.1993451]
curr_Stock_Price:  100.82711628835665
curr_Factors:  [1.00827116e+02 4.11121546e-02]
mat_Sqrt:  [[ 2.04438396e+01  0.00000000e+00]
 [-8.11045297e-03  1.85833823e-02]]
grads:  [2.61431480e-02 3.22295681e+01]
Stock Position:  0.026143147950198425
Bond Position:  [5.56340688]


portfolio before change:  [8.20590839]
curr_Stock_Price:  101.05156623030743
curr_Factors:  [1.01051566e+02 4.06714415e-02]
mat_Sqrt:  [[ 2.03792329e+01  0.00000000e+00]
 [-8.06686472e-03  1.84835091e-02]]
grads:  [-0.01021122 -3.89465943]
Stock Position:  -0.010211222036140609
Bond Position:  [9.23776837]


portfolio before change:  [8.2082593]
curr_Stock_Price:  100.93442902693106
curr_Factors:  [1.00934429e+02 4.05590178e-02]
mat_Sqrt:  [[ 2.03274567e+01  0.00000000e+00]
 [-8.05570782e-03  1.84579454e-02]]
grads:  [ 2.34811047e-02 -3.47020954e+01]
Stock Position:  0.02348110469750863
Bond Position:  [5.83820741]


portfolio before change:  [8.18323026]
curr_Stock_Price:  99.83742492924745
curr_Factors:  [9.98374249e+01 4.13663886e-02]
mat_Sqrt:  [[ 2.03056630e+01  0.00000000e+00]
 [-8.13549149e-03  1.86407528e-02]]
grads:  [-7.77346256e-04  1.86083217e+00]
Stock Position:  -0.0007773462564434654
Bond Position:  [8.2608385]


portfolio before change:  [8.18412951]
curr_Stock_Price:  100.00905276513434
curr_Factors:  [1.00009053e+02 4.18269835e-02]
mat_Sqrt:  [[ 2.04534977e+01  0.00000000e+00]
 [-8.18065851e-03  1.87442434e-02]]
grads:  [-0.00059752  0.5333507 ]
Stock Position:  -0.0005975232083705753
Bond Position:  [8.24388724]


portfolio before change:  [8.18507389]
curr_Stock_Price:  100.15326733766244
curr_Factors:  [1.00153267e+02 4.02953962e-02]
mat_Sqrt:  [[ 2.01044796e+01  0.00000000e+00]
 [-8.02948528e-03  1.83978620e-02]]
grads:  [-0.00589027 -3.6045997 ]
Stock Position:  -0.005890267928647551
Bond Position:  [8.77500347]


portfolio before change:  [8.19241753]
curr_Stock_Price:  99.09275617623355
curr_Factors:  [9.90927562e+01 4.04043165e-02]
mat_Sqrt:  [[ 1.99184615e+01  0.00000000e+00]
 [-8.04032999e-03  1.84227104e-02]]
grads:  [2.54081124e-03 1.12718128e+01]
Stock Position:  0.0025408112359951657
Bond Position:  [7.94064154]


portfolio before change:  [8.19300883]
curr_Stock_Price:  98.93479831189113
curr_Factors:  [9.89347983e+01 4.16308323e-02]
mat_Sqrt:  [[ 2.01862952e+01  0.00000000e+00]
 [-8.16145402e-03  1.87002404e-02]]
grads:  [-0.00503104 -4.0999002 ]
Stock Position:  -0.005031037228832729
Bond Position:  [8.69075348]


portfolio before change:  [8.19327651]
curr_Stock_Price:  99.09753452874544
curr_Factors:  [9.90975345e+01 4.06229633e-02]
mat_Sqrt:  [[ 1.99732460e+01  0.00000000e+00]
 [-8.06205565e-03  1.84724901e-02]]
grads:  [0.00984344 4.26548363]
Stock Position:  0.009843443223115164
Bond Position:  [7.21781555]


portfolio before change:  [8.18681195]
curr_Stock_Price:  98.34913396522407
curr_Factors:  [9.83491340e+01 4.10868916e-02]
mat_Sqrt:  [[ 1.99352728e+01  0.00000000e+00]
 [-8.10796069e-03  1.85776718e-02]]
grads:  [0.00796613 1.08688447]
Stock Position:  0.007966129971920198
Bond Position:  [7.40334997]


portfolio before change:  [8.19272394]
curr_Stock_Price:  98.97509773976144
curr_Factors:  [9.89750977e+01 4.14253745e-02]
mat_Sqrt:  [[ 2.01446238e+01  0.00000000e+00]
 [-8.14128977e-03  1.86540383e-02]]
grads:  [0.00927601 9.15844346]
Stock Position:  0.00927601200513019
Bond Position:  [7.27462974]


portfolio before change:  [8.19617602]
curr_Stock_Price:  99.24921265697175
curr_Factors:  [9.92492127e+01 4.32908071e-02]
mat_Sqrt:  [[ 2.06502309e+01  0.00000000e+00]
 [-8.32257721e-03  1.90694200e-02]]
grads:  [1.19218777e-03 6.10902144e+00]
Stock Position:  0.0011921877680482844
Bond Position:  [8.07785232]


portfolio before change:  [8.19383456]
curr_Stock_Price:  96.43820452257667
curr_Factors:  [9.64382045e+01 4.50800551e-02]
mat_Sqrt:  [[ 2.04758215e+01  0.00000000e+00]
 [-8.49282568e-03  1.94595083e-02]]
grads:  [0.01160353 1.12818993]
Stock Position:  0.011603534141200642
Bond Position:  [7.07481057]


portfolio before change:  [8.20330374]
curr_Stock_Price:  97.1780456565235
curr_Factors:  [9.71780457e+01 4.41915296e-02]
mat_Sqrt:  [[ 2.04285564e+01  0.00000000e+00]
 [-8.40871258e-03  1.92667810e-02]]
grads:  [ -0.01226727 -10.22760609]
Stock Position:  -0.01226727445463055
Bond Position:  [9.3954135]


portfolio before change:  [8.23506468]
curr_Stock_Price:  94.68470980809029
curr_Factors:  [9.46847098e+01 4.43594838e-02]
mat_Sqrt:  [[ 1.99422012e+01  0.00000000e+00]
 [-8.42467650e-03  1.93033589e-02]]
grads:  [1.01756536e-02 1.23602718e+01]
Stock Position:  0.010175653556216498
Bond Position:  [7.27158587]


portfolio before change:  [8.21757483]
curr_Stock_Price:  92.87658472333207
curr_Factors:  [9.28765847e+01 4.57989110e-02]
mat_Sqrt:  [[ 1.98762208e+01  0.00000000e+00]
 [-8.56027205e-03  1.96140473e-02]]
grads:  [7.08408553e-03 1.27981179e+01]
Stock Position:  0.00708408552576735
Bond Position:  [7.55962916]


portfolio before change:  [8.21659018]
curr_Stock_Price:  92.60419054928037
curr_Factors:  [9.26041905e+01 4.58892002e-02]
mat_Sqrt:  [[ 1.98374518e+01  0.00000000e+00]
 [-8.56870588e-03  1.96333716e-02]]
grads:  [2.05694396e-02 2.53452901e+01]
Stock Position:  0.020569439593750634
Bond Position:  [6.31177387]


portfolio before change:  [8.21514037]
curr_Stock_Price:  92.49534808195713
curr_Factors:  [9.24953481e+01 4.52919542e-02]
mat_Sqrt:  [[ 1.96847734e+01  0.00000000e+00]
 [-8.51276258e-03  1.95051894e-02]]
grads:  [0.00965614 3.65201314]
Stock Position:  0.009656136084411779
Bond Position:  [7.3219927]


portfolio before change:  [8.21508755]
curr_Stock_Price:  92.39508829439725
curr_Factors:  [9.23950883e+01 4.52134973e-02]
mat_Sqrt:  [[ 1.96463979e+01  0.00000000e+00]
 [-8.50538627e-03  1.94882882e-02]]
grads:  [ 7.56104869e-05 -5.91216333e+00]
Stock Position:  7.561048687672113e-05
Bond Position:  [8.20810152]


portfolio before change:  [8.21602066]
curr_Stock_Price:  91.16548648517453
curr_Factors:  [9.11654865e+01 4.45714900e-02]
mat_Sqrt:  [[ 1.92468220e+01  0.00000000e+00]
 [-8.44478443e-03  1.93494319e-02]]
grads:  [ 0.02670586 -7.15128683]
Stock Position:  0.026705861738997517
Bond Position:  [5.78136778]


portfolio before change:  [8.21627692]
curr_Stock_Price:  91.14801997206644
curr_Factors:  [9.11480200e+01 4.46003698e-02]
mat_Sqrt:  [[ 1.92493677e+01  0.00000000e+00]
 [-8.44751985e-03  1.93556996e-02]]
grads:  [ 0.00218857 -1.95177599]
Stock Position:  0.0021885711403150337
Bond Position:  [8.01679299]


portfolio before change:  [8.21835]
curr_Stock_Price:  91.6373455642694
curr_Factors:  [9.16373456e+01 4.39620965e-02]
mat_Sqrt:  [[ 1.92137306e+01  0.00000000e+00]
 [-8.38685605e-03  1.92167013e-02]]
grads:  [-0.00084957 -0.65222981]
Stock Position:  -0.0008495732504664944
Bond Position:  [8.29620264]


portfolio before change:  [8.21951556]
curr_Stock_Price:  91.48613323470325
curr_Factors:  [9.14861332e+01 4.32146846e-02]
mat_Sqrt:  [[ 1.90182672e+01  0.00000000e+00]
 [-8.31525678e-03  1.90526468e-02]]
grads:  [-0.00464445 -0.77953261]
Stock Position:  -0.004644450477987737
Bond Position:  [8.64441837]


portfolio before change:  [8.22499744]
curr_Stock_Price:  90.53849465385484
curr_Factors:  [9.05384947e+01 4.32691104e-02]
mat_Sqrt:  [[ 1.88331191e+01  0.00000000e+00]
 [-8.32049137e-03  1.90646408e-02]]
grads:  [-4.68038651e-03 -2.14183397e+01]
Stock Position:  -0.004680386513686828
Bond Position:  [8.64875259]


portfolio before change:  [8.23058001]
curr_Stock_Price:  89.57673532787022
curr_Factors:  [8.95767353e+01 4.60411674e-02]
mat_Sqrt:  [[ 1.92206643e+01  0.00000000e+00]
 [-8.58288225e-03  1.96658538e-02]]
grads:  [1.18274884e-02 1.55090746e+01]
Stock Position:  0.01182748839688581
Bond Position:  [7.17111221]


portfolio before change:  [8.22377208]
curr_Stock_Price:  88.92534005749333
curr_Factors:  [8.89253401e+01 4.59235123e-02]
mat_Sqrt:  [[ 1.90564975e+01  0.00000000e+00]
 [-8.57190875e-03  1.96407104e-02]]
grads:  [-6.24822594e-04  4.55932696e+00]
Stock Position:  -0.0006248225937061676
Bond Position:  [8.27933464]


portfolio before change:  [8.22491668]
curr_Stock_Price:  88.74989744216244
curr_Factors:  [8.87498974e+01 4.58768509e-02]
mat_Sqrt:  [[ 1.90092359e+01  0.00000000e+00]
 [-8.56755283e-03  1.96307297e-02]]
grads:  [1.86601627e-03 7.73071603e+00]
Stock Position:  0.0018660162715134706
Bond Position:  [8.05930793]


portfolio before change:  [8.22372404]
curr_Stock_Price:  87.57085065973456
curr_Factors:  [8.75708507e+01 4.56602434e-02]
mat_Sqrt:  [[ 1.87123650e+01  0.00000000e+00]
 [-8.54730305e-03  1.95843316e-02]]
grads:  [-0.00639688  1.36788504]
Stock Position:  -0.006396883714744097
Bond Position:  [8.78390459]


portfolio before change:  [8.22732525]
curr_Stock_Price:  87.17954186596927
curr_Factors:  [8.71795419e+01 4.31188823e-02]
mat_Sqrt:  [[ 1.81029074e+01  0.00000000e+00]
 [-8.30603465e-03  1.90315163e-02]]
grads:  [-0.03960864 10.34897589]
Stock Position:  -0.03960864307942133
Bond Position:  [11.68038861]


portfolio before change:  [8.2305886]
curr_Stock_Price:  87.13401628741438
curr_Factors:  [8.71340163e+01 4.34777999e-02]
mat_Sqrt:  [[ 1.81686020e+01  0.00000000e+00]
 [-8.34053235e-03  1.91105604e-02]]
grads:  [0.02067771 9.20867105]
Stock Position:  0.020677706398831167
Bond Position:  [6.42885699]


portfolio before change:  [8.23998039]
curr_Stock_Price:  87.54934941803546
curr_Factors:  [8.75493494e+01 4.26275965e-02]
mat_Sqrt:  [[ 1.80758341e+01  0.00000000e+00]
 [-8.25858066e-03  1.89227855e-02]]
grads:  [ -0.11135684 -11.36252629]
Stock Position:  -0.11135683864981485
Bond Position:  [17.98919917]


portfolio before change:  [8.14692586]
curr_Stock_Price:  88.40518664895573
curr_Factors:  [8.84051866e+01 4.18895409e-02]
mat_Sqrt:  [[ 1.80938317e+01  0.00000000e+00]
 [-8.18677382e-03  1.87582554e-02]]
grads:  [ 0.03704242 36.26982616]
Stock Position:  0.03704242143550897
Bond Position:  [4.87218367]


portfolio before change:  [8.17577541]
curr_Stock_Price:  89.16756903873977
curr_Factors:  [8.91675690e+01 4.18221316e-02]
mat_Sqrt:  [[ 1.82351781e+01  0.00000000e+00]
 [-8.18018402e-03  1.87431562e-02]]
grads:  [-4.56148445e-04 -8.04058375e+00]
Stock Position:  -0.00045614844549953356
Bond Position:  [8.21644905]


portfolio before change:  [8.17662493]
curr_Stock_Price:  89.55691533050944
curr_Factors:  [8.95569153e+01 4.20687172e-02]
mat_Sqrt:  [[ 1.83687144e+01  0.00000000e+00]
 [-8.20426398e-03  1.87983304e-02]]
grads:  [0.00621636 0.13983488]
Stock Position:  0.006216356236611893
Bond Position:  [7.61990724]


portfolio before change:  [8.17449715]
curr_Stock_Price:  89.06139560317058
curr_Factors:  [8.90613956e+01 4.22451862e-02]
mat_Sqrt:  [[ 1.83053531e+01  0.00000000e+00]
 [-8.22145351e-03  1.88377165e-02]]
grads:  [4.94344819e-03 9.34361209e+00]
Stock Position:  0.0049434481912582345
Bond Position:  [7.73422675]


portfolio before change:  [8.17961624]
curr_Stock_Price:  89.90134722796516
curr_Factors:  [8.99013472e+01 4.33858703e-02]
mat_Sqrt:  [[ 1.87257990e+01  0.00000000e+00]
 [-8.33171006e-03  1.90903460e-02]]
grads:  [-0.13306832  5.26680053]
Stock Position:  -0.13306832167554009
Bond Position:  [20.14263764]


portfolio before change:  [8.0938808]
curr_Stock_Price:  90.56456614982345
curr_Factors:  [9.05645661e+01 4.32176800e-02]
mat_Sqrt:  [[ 1.88273430e+01  0.00000000e+00]
 [-8.31554496e-03  1.90533071e-02]]
grads:  [-3.58219308e-03  6.45238268e+00]
Stock Position:  -0.003582193079439633
Bond Position:  [8.41830056]


portfolio before change:  [8.0951625]
curr_Stock_Price:  90.5005427353881
curr_Factors:  [9.05005427e+01 4.21600040e-02]
mat_Sqrt:  [[ 1.85823872e+01  0.00000000e+00]
 [-8.21316056e-03  1.88187150e-02]]
grads:  [-0.01040005 -7.09249861]
Stock Position:  -0.010400052430171692
Bond Position:  [9.03637289]


portfolio before change:  [8.10129432]
curr_Stock_Price:  90.01956376129996
curr_Factors:  [9.00195638e+01 4.19400113e-02]
mat_Sqrt:  [[ 1.84353410e+01  0.00000000e+00]
 [-8.19170422e-03  1.87695523e-02]]
grads:  [ 0.08499835 -5.05109682]
Stock Position:  0.08499834937475192
Bond Position:  [0.44977999]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.03792876]
Stock Price:  89.27341061357691
PL:  [8.03792876]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.91673027e-01  6.21904709e-01]
 [-1.64728186e-01 -8.71416725e-02]
 [ 8.26171347e-01 -7.13872797e-01]
 [ 7.24607430e-04  2.43512717e-02]
 [-2.44629625e-02  1.31502539e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-5.49874085e-02  1.87342127e-01]
 [ 8.96397318e-02 -3.96829894e-02]
 [ 1.66372301e-01  8.87001743e-02]
 [ 2.33949138e-01 -7.93602206e-02]
 [ 1.45828103e-01  2.90381781e-01]
 [-6.12825057e-02  6.05441764e-02]
 [-7.60444586e-02  1.27679389e-01]
 [-3.95051622e-01 -5.19513594e-01]
 [ 8.57041921e-02  2.29877595e-01]
 [ 5.21381226e-02 -1.92179716e-02]
 [-5.19269945e-02  2.11992601e-01]
 [-1.34608813e-01 -3.12439705e-03]
 [ 1.50674756e-02  6.16783593e-02]
 [-1.68953399e-02 -8.47044208e-02]
 [ 1.38433411e-01  4.45515127e-02]
 [ 6.63656649e-03  9.71557132e-02]
 [ 2.53523971e-02  2.99513861e-01]
 [ 1.86460869e-02  1.63193899e-01]
 [ 3.24229211e-02  7.30177750e-02]
 [ 7.13607089e-01 -2.98568170e-01]
 [-1.73633154e-01  2.36818498e-01]
 [ 1.11662535e-01  9.75295696e-03]
 [-4.50145565e-02 -6.51927991e-02]
 [-6.55217754e-02 -6.94077244e-02]
 [-2.39337851e-01 -8.61627954e-02]
 [-1.17917216e-01 -7.03773745e-04]
 [ 1.88546369e-01  2.01311424e-01]
 [ 2.22034655e-01  3.00098150e-02]
 [-2.44332315e-01 -2.01089651e-01]
 [-5.33527479e-02 -3.98630259e-01]
 [-1.39130582e-01  2.34918105e-01]
 [-1.20245710e-01  1.19932321e-01]
 [-5.91927526e-02  1.14787845e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.64153905]
curr_Stock_Price:  100.89371785396082
curr_Factors:  [1.00893718e+02 4.08602507e-02]
mat_Sqrt:  [[ 2.03945741e+01  0.00000000e+00]
 [-8.08556746e-03  1.85263625e-02]]
grads:  [2.76100149e-02 3.35686355e+01]
Stock Position:  0.027610014913730847
Bond Position:  [5.85586199]


portfolio before change:  [8.59024666]
curr_Stock_Price:  99.00945919906815
curr_Factors:  [9.90094592e+01 4.10430301e-02]
mat_Sqrt:  [[ 2.00584050e+01  0.00000000e+00]
 [-8.10363179e-03  1.85677530e-02]]
grads:  [-0.01010848 -4.69317275]
Stock Position:  -0.0101084772011471
Bond Position:  [9.59108153]


portfolio before change:  [8.58833964]
curr_Stock_Price:  99.31672409676933
curr_Factors:  [9.93167241e+01 4.06005118e-02]
mat_Sqrt:  [[ 2.00118915e+01  0.00000000e+00]
 [-8.05982748e-03  1.84673847e-02]]
grads:  [ 2.57152961e-02 -3.86558685e+01]
Stock Position:  0.025715296068454893
Bond Position:  [6.03438068]


portfolio before change:  [8.62033797]
curr_Stock_Price:  100.53172011726355
curr_Factors:  [1.00531720e+02 3.98533107e-02]
mat_Sqrt:  [[ 2.00694429e+01  0.00000000e+00]
 [-7.98531760e-03  1.82966612e-02]]
grads:  [5.65654651e-04 1.33091341e+00]
Stock Position:  0.0005656546507991381
Bond Position:  [8.56347174]


portfolio before change:  [8.62116178]
curr_Stock_Price:  100.09560505984236
curr_Factors:  [1.00095605e+02 3.87751909e-02]
mat_Sqrt:  [[ 1.97102431e+01  0.00000000e+00]
 [-7.87656685e-03  1.80474819e-02]]
grads:  [-0.00094995  0.72864757]
Stock Position:  -0.000949948770166566
Bond Position:  [8.71624748]


portfolio before change:  [8.62215274]
curr_Stock_Price:  100.19944131523073
curr_Factors:  [1.00199441e+02 3.98237236e-02]
mat_Sqrt:  [[ 1.99956825e+01  0.00000000e+00]
 [-7.98235290e-03  1.82898682e-02]]
grads:  [-0.00592232 -3.62588332]
Stock Position:  -0.005922317059730605
Bond Position:  [9.2155656]


portfolio before change:  [8.63247786]
curr_Stock_Price:  98.65053769811432
curr_Factors:  [9.86505377e+01 4.04636544e-02]
mat_Sqrt:  [[ 1.98441275e+01  0.00000000e+00]
 [-8.04623185e-03  1.84362333e-02]]
grads:  [1.34928577e-03 1.01616271e+01]
Stock Position:  0.0013492857676179267
Bond Position:  [8.49937009]


portfolio before change:  [8.63520991]
curr_Stock_Price:  99.88790537040201
curr_Factors:  [9.98879054e+01 4.07958529e-02]
mat_Sqrt:  [[ 2.01753424e+01  0.00000000e+00]
 [-8.07919332e-03  1.85117575e-02]]
grads:  [ 0.00358461 -2.14366407]
Stock Position:  0.003584606091362228
Bond Position:  [8.27715111]


portfolio before change:  [8.63105681]
curr_Stock_Price:  98.44066091081433
curr_Factors:  [9.84406609e+01 4.30873829e-02]
mat_Sqrt:  [[ 2.04338207e+01  0.00000000e+00]
 [-8.30300022e-03  1.90245635e-02]]
grads:  [0.01003651 4.6624026 ]
Stock Position:  0.010036509237564011
Bond Position:  [7.64305621]


portfolio before change:  [8.64114651]
curr_Stock_Price:  99.35076391544676
curr_Factors:  [9.93507639e+01 4.29365375e-02]
mat_Sqrt:  [[ 2.05866045e+01  0.00000000e+00]
 [-8.28845341e-03  1.89912326e-02]]
grads:  [ 0.00968171 -4.17878198]
Stock Position:  0.009681708273035368
Bond Position:  [7.6792614]


portfolio before change:  [8.62258607]
curr_Stock_Price:  97.33454860745941
curr_Factors:  [9.73345486e+01 4.44623321e-02]
mat_Sqrt:  [[ 2.05240535e+01  0.00000000e+00]
 [-8.43443723e-03  1.93257235e-02]]
grads:  [1.32800814e-02 1.50256615e+01]
Stock Position:  0.013280081437035563
Bond Position:  [7.32997534]


portfolio before change:  [8.65392423]
curr_Stock_Price:  99.62533646676944
curr_Factors:  [9.96253365e+01 4.41127212e-02]
mat_Sqrt:  [[ 2.09243380e+01  0.00000000e+00]
 [-8.40121146e-03  1.92495937e-02]]
grads:  [-1.66594809e-03  3.14521840e+00]
Stock Position:  -0.001665948088900874
Bond Position:  [8.81989487]


portfolio before change:  [8.65317151]
curr_Stock_Price:  100.73898245908318
curr_Factors:  [1.00738982e+02 4.30297479e-02]
mat_Sqrt:  [[ 2.08969046e+01  0.00000000e+00]
 [-8.29744519e-03  1.90118353e-02]]
grads:  [-9.72421769e-04  6.71578449e+00]
Stock Position:  -0.000972421768654193
Bond Position:  [8.75113229]


portfolio before change:  [8.65464588]
curr_Stock_Price:  100.34778372835684
curr_Factors:  [1.00347784e+02 4.31582399e-02]
mat_Sqrt:  [[ 2.08468119e+01  0.00000000e+00]
 [-8.30982454e-03  1.90402000e-02]]
grads:  [ -0.02982643 -27.28509127]
Stock Position:  -0.0298264284299966
Bond Position:  [11.64766187]


portfolio before change:  [8.71663704]
curr_Stock_Price:  98.31820413676
curr_Factors:  [9.83182041e+01 4.51561794e-02]
mat_Sqrt:  [[ 2.08926020e+01  0.00000000e+00]
 [-8.49999336e-03  1.94759315e-02]]
grads:  [8.90415656e-03 1.18031630e+01]
Stock Position:  0.008904156558982093
Bond Position:  [7.84119635]


portfolio before change:  [8.72069838]
curr_Stock_Price:  98.6642372572029
curr_Factors:  [9.86642373e+01 4.45126008e-02]
mat_Sqrt:  [[ 2.08161902e+01  0.00000000e+00]
 [-8.43920383e-03  1.93366452e-02]]
grads:  [ 0.00210176 -0.99386276]
Stock Position:  0.002101763664352084
Bond Position:  [8.51332947]


portfolio before change:  [8.72467416]
curr_Stock_Price:  100.04952565670797
curr_Factors:  [1.00049526e+02 4.53527963e-02]
mat_Sqrt:  [[ 2.13067431e+01  0.00000000e+00]
 [-8.51847839e-03  1.95182860e-02]]
grads:  [1.90522604e-03 1.08612304e+01]
Stock Position:  0.0019052260444383045
Bond Position:  [8.5340572]


portfolio before change:  [8.72577876]
curr_Stock_Price:  100.0693517562724
curr_Factors:  [1.00069352e+02 4.47247399e-02]
mat_Sqrt:  [[ 2.11628912e+01  0.00000000e+00]
 [-8.45928980e-03  1.93826679e-02]]
grads:  [-0.00642504 -0.16119541]
Stock Position:  -0.006425039514713964
Bond Position:  [9.3687283]


portfolio before change:  [8.72537552]
curr_Stock_Price:  100.3143930502199
curr_Factors:  [1.00314393e+02 4.48077646e-02]
mat_Sqrt:  [[ 2.12343948e+01  0.00000000e+00]
 [-8.46713785e-03  1.94006501e-02]]
grads:  [1.97726937e-03 3.17919035e+00]
Stock Position:  0.0019772693667248426
Bond Position:  [8.52702695]


portfolio before change:  [8.72603199]
curr_Stock_Price:  100.10729989112478
curr_Factors:  [1.00107300e+02 4.43613701e-02]
mat_Sqrt:  [[ 2.10847387e+01  0.00000000e+00]
 [-8.42485561e-03  1.93037693e-02]]
grads:  [-2.55461453e-03 -4.38797312e+00]
Stock Position:  -0.00255461453460537
Bond Position:  [8.98176755]


portfolio before change:  [8.72598485]
curr_Stock_Price:  100.56526583052221
curr_Factors:  [1.00565266e+02 4.40036916e-02]
mat_Sqrt:  [[ 2.10956330e+01  0.00000000e+00]
 [-8.39082276e-03  1.92257902e-02]]
grads:  [0.00748388 2.31727862]
Stock Position:  0.007483884718165148
Bond Position:  [7.973366]


portfolio before change:  [8.74009392]
curr_Stock_Price:  102.31734194534974
curr_Factors:  [1.02317342e+02 4.36238395e-02]
mat_Sqrt:  [[ 2.13703282e+01  0.00000000e+00]
 [-8.35452830e-03  1.91426292e-02]]
grads:  [2.29471422e-03 5.07535889e+00]
Stock Position:  0.0022947142167089687
Bond Position:  [8.50530486]


portfolio before change:  [8.74072009]
curr_Stock_Price:  102.12687892481537
curr_Factors:  [1.02126879e+02 4.40085430e-02]
mat_Sqrt:  [[ 2.14243944e+01  0.00000000e+00]
 [-8.39128529e-03  1.92268500e-02]]
grads:  [7.28473159e-03 1.55778956e+01]
Stock Position:  0.0072847315939644774
Bond Position:  [7.99675319]


portfolio before change:  [8.7364735]
curr_Stock_Price:  101.40670782712941
curr_Factors:  [1.01406708e+02 4.52228651e-02]
mat_Sqrt:  [[ 2.15648142e+01  0.00000000e+00]
 [-8.50626735e-03  1.94903070e-02]]
grads:  [4.16742490e-03 8.37307996e+00]
Stock Position:  0.004167424897970384
Bond Position:  [8.31386866]


portfolio before change:  [8.73862261]
curr_Stock_Price:  101.67301438562778
curr_Factors:  [1.01673014e+02 4.52507236e-02]
mat_Sqrt:  [[ 2.16281047e+01  0.00000000e+00]
 [-8.50888699e-03  1.94963093e-02]]
grads:  [2.97254390e-03 3.74521012e+00]
Stock Position:  0.002972543900159772
Bond Position:  [8.43639511]


portfolio before change:  [8.73980734]
curr_Stock_Price:  101.71678863986304
curr_Factors:  [1.01716789e+02 4.44439049e-02]
mat_Sqrt:  [[ 2.14436517e+01  0.00000000e+00]
 [-8.43268924e-03  1.93217184e-02]]
grads:  [  0.02720158 -15.45246465]
Stock Position:  0.027201582263575573
Bond Position:  [5.97294975]


portfolio before change:  [8.75958039]
curr_Stock_Price:  102.4162473497829
curr_Factors:  [1.02416247e+02 4.44077622e-02]
mat_Sqrt:  [[ 2.15823287e+01  0.00000000e+00]
 [-8.42925972e-03  1.93138604e-02]]
grads:  [-3.25623285e-03  1.22615828e+01]
Stock Position:  -0.0032562328511105457
Bond Position:  [9.09307154]


portfolio before change:  [8.75880925]
curr_Stock_Price:  103.00215310756862
curr_Factors:  [1.03002153e+02 4.28370754e-02]
mat_Sqrt:  [[ 2.13184787e+01  0.00000000e+00]
 [-8.27884778e-03  1.89692233e-02]]
grads:  [0.00543749 0.51414635]
Stock Position:  0.005437492785587206
Bond Position:  [8.19873579]


portfolio before change:  [8.76420182]
curr_Stock_Price:  103.80540229734201
curr_Factors:  [1.03805402e+02 4.24991218e-02]
mat_Sqrt:  [[ 2.13998108e+01  0.00000000e+00]
 [-8.24612605e-03  1.88942484e-02]]
grads:  [-3.43306898e-03 -3.45040447e+00]
Stock Position:  -0.0034330689788186963
Bond Position:  [9.12057293]


portfolio before change:  [8.76812314]
curr_Stock_Price:  102.99528945878032
curr_Factors:  [1.02995289e+02 4.19906712e-02]
mat_Sqrt:  [[ 2.11054089e+01  0.00000000e+00]
 [-8.19665016e-03  1.87808849e-02]]
grads:  [-0.00453977 -3.69565783]
Stock Position:  -0.0045397741485004185
Bond Position:  [9.23569849]


portfolio before change:  [8.76678348]
curr_Stock_Price:  103.54469868986848
curr_Factors:  [1.03544699e+02 4.33741953e-02]
mat_Sqrt:  [[ 2.15647081e+01  0.00000000e+00]
 [-8.33058896e-03  1.90877773e-02]]
grads:  [-0.01284239 -4.5140298 ]
Stock Position:  -0.012842389378014326
Bond Position:  [10.09654481]


portfolio before change:  [8.77845744]
curr_Stock_Price:  102.73396017992519
curr_Factors:  [1.02733960e+02 4.33263465e-02]
mat_Sqrt:  [[ 2.13840551e+01  0.00000000e+00]
 [-8.32599270e-03  1.90772459e-02]]
grads:  [-0.00552862 -0.03689074]
Stock Position:  -0.0055286225055411
Bond Position:  [9.34643473]


portfolio before change:  [8.77043249]
curr_Stock_Price:  104.39682033792859
curr_Factors:  [1.0439682e+02 4.3296282e-02]
mat_Sqrt:  [[ 2.17226384e+01  0.00000000e+00]
 [-8.32310346e-03  1.90706258e-02]]
grads:  [ 0.01272432 10.55609953]
Stock Position:  0.012724323473999226
Bond Position:  [7.44205358]


portfolio before change:  [8.78294245]
curr_Stock_Price:  105.30685979830339
curr_Factors:  [1.05306860e+02 4.30546013e-02]
mat_Sqrt:  [[ 2.18507551e+01  0.00000000e+00]
 [-8.29984109e-03  1.90173250e-02]]
grads:  [0.01076082 1.57802503]
Stock Position:  0.010760818616138408
Bond Position:  [7.64975443]


portfolio before change:  [8.76530356]
curr_Stock_Price:  103.57881634068761
curr_Factors:  [1.03578816e+02 4.30929010e-02]
mat_Sqrt:  [[ 2.15017501e+01  0.00000000e+00]
 [-8.30353188e-03  1.90257817e-02]]
grads:  [ -0.01544502 -10.56932403]
Stock Position:  -0.01544502341246214
Bond Position:  [10.36508081]


portfolio before change:  [8.78934522]
curr_Stock_Price:  102.10611275878847
curr_Factors:  [1.02106113e+02 4.31188919e-02]
mat_Sqrt:  [[ 2.12024251e+01  0.00000000e+00]
 [-8.30603558e-03  1.90315184e-02]]
grads:  [-1.07218516e-02 -2.09457938e+01]
Stock Position:  -0.01072185161493909
Bond Position:  [9.88411181]


portfolio before change:  [8.78538704]
curr_Stock_Price:  102.59052296395154
curr_Factors:  [1.02590523e+02 4.34247888e-02]
mat_Sqrt:  [[ 2.13784444e+01  0.00000000e+00]
 [-8.33544613e-03  1.90989064e-02]]
grads:  [-1.71218799e-03  1.23000815e+01]
Stock Position:  -0.0017121879873899196
Bond Position:  [8.9610413]


portfolio before change:  [8.78432155]
curr_Stock_Price:  103.86706800882799
curr_Factors:  [1.03867068e+02 4.27202351e-02]
mat_Sqrt:  [[ 2.14681534e+01  0.00000000e+00]
 [-8.26754958e-03  1.89433359e-02]]
grads:  [-3.16296201e-03  6.33110880e+00]
Stock Position:  -0.003162962012704442
Bond Position:  [9.11284914]


portfolio before change:  [8.78758928]
curr_Stock_Price:  103.19410767692878
curr_Factors:  [1.03194108e+02 4.19679077e-02]
mat_Sqrt:  [[ 2.11404175e+01  0.00000000e+00]
 [-8.19442813e-03  1.87757936e-02]]
grads:  [-4.30229425e-04  6.11360819e+00]
Stock Position:  -0.000430229424957956
Bond Position:  [8.83198642]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.78870171]
Stock Price:  103.17465996518767
PL:  [5.61404175]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.32112019e-01  4.24318145e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.47440543e-01 -6.34121136e-01]
 [ 3.03598846e-02  2.25613787e-02]
 [-1.43898247e-01  6.09494326e-02]
 [ 1.96982762e-01  1.85953072e-01]
 [ 5.09866668e-02  1.85334264e-01]
 [ 2.33947618e-01 -2.10067779e-03]
 [ 1.63207165e-01  8.06300838e-02]
 [ 2.50910050e-01 -9.82690147e-02]
 [ 1.10170783e-01  1.63249654e-01]
 [ 2.82904933e-02  1.60925814e-01]
 [ 1.25973833e-01  5.12790440e-02]
 [-1.74506228e-01 -2.03306975e-01]
 [ 9.05487681e-02  2.33729755e-01]
 [ 4.78000330e-02  3.17980706e-02]
 [ 8.81908421e-02  1.91980375e-01]
 [ 9.26723294e-02  6.61186271e-02]
 [ 1.79036556e-02 -8.74441951e-03]
 [ 4.48554118e-01 -1.25341369e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-3.75326701e-02  9.80726967e-02]
 [-3.23214195e-02 -1.06749834e-01]
 [ 1.19570875e-02 -8.24228608e-02]
 [ 4.32125712e-02  1.51445323e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 7.77143543e-02  1.70724322e-01]
 [-1.54364588e-01  7.87423474e-02]
 [-5.04184381e-01  1.10911941e-01]
 [ 2.91470789e-01 -4.18666788e-02]
 [-1.72567145e+00 -1.94278788e-01]
 [ 3.46732670e-01  6.32126424e-01]
 [ 5.51584097e-02 -1.50097754e-01]
 [ 2.39911065e-01 -4.53299297e-02]
 [ 1.61785055e-02  1.76983524e-01]
 [-2.39339009e+00  7.19879944e-02]
 [-1.25588214e-01  1.14196066e-01]
 [-1.34989142e-01 -1.49368965e-01]
 [ 1.40105648e+00 -6.78826907e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.84748092]
curr_Stock_Price:  100.32227129117328
curr_Factors:  [1.00322271e+02 4.11676294e-02]
mat_Sqrt:  [[ 2.03551959e+01  0.00000000e+00]
 [-8.11592305e-03  1.85959159e-02]]
grads:  [1.55881398e-02 2.28178138e+01]
Stock Position:  0.015588139849324986
Bond Position:  [3.28364332]


portfolio before change:  [4.84071082]
curr_Stock_Price:  99.86162743926343
curr_Factors:  [9.98616274e+01 4.19565545e-02]
mat_Sqrt:  [[ 2.04549559e+01  0.00000000e+00]
 [-8.19331967e-03  1.87732538e-02]]
grads:  [-0.00992348 -4.68812552]
Stock Position:  -0.00992348499506277
Bond Position:  [5.83168618]


portfolio before change:  [4.82891709]
curr_Stock_Price:  101.12355616435674
curr_Factors:  [1.01123556e+02 4.16193127e-02]
mat_Sqrt:  [[ 2.06300265e+01  0.00000000e+00]
 [-8.16032477e-03  1.86976530e-02]]
grads:  [ 2.28156464e-02 -3.39144778e+01]
Stock Position:  0.02281564643790254
Bond Position:  [2.52171779]


portfolio before change:  [4.82972268]
curr_Stock_Price:  101.14504822430636
curr_Factors:  [1.01145048e+02 4.20396844e-02]
mat_Sqrt:  [[ 2.07383572e+01  0.00000000e+00]
 [-8.20143250e-03  1.87918426e-02]]
grads:  [0.00193875 1.20059428]
Stock Position:  0.0019387494025510895
Bond Position:  [4.63362778]


portfolio before change:  [4.8325694]
curr_Stock_Price:  102.31460640891929
curr_Factors:  [1.02314606e+02 4.10024546e-02]
mat_Sqrt:  [[ 2.07177490e+01  0.00000000e+00]
 [-8.09962514e-03  1.85585727e-02]]
grads:  [-0.0056617   3.28416596]
Stock Position:  -0.005661702651409951
Bond Position:  [5.41184428]


portfolio before change:  [4.82600483]
curr_Stock_Price:  103.59356614491399
curr_Factors:  [1.03593566e+02 4.04291714e-02]
mat_Sqrt:  [[ 2.08295652e+01  0.00000000e+00]
 [-8.04280264e-03  1.84283759e-02]]
grads:  [ 0.0133531  10.09058381]
Stock Position:  0.013353103352555377
Bond Position:  [3.44270924]


portfolio before change:  [4.81268622]
curr_Stock_Price:  102.56391906180265
curr_Factors:  [1.02563919e+02 3.99323388e-02]
mat_Sqrt:  [[ 2.04954275e+01  0.00000000e+00]
 [-7.99323102e-03  1.83147931e-02]]
grads:  [6.43427278e-03 1.01193753e+01]
Stock Position:  0.006434272780695199
Bond Position:  [4.15276198]


portfolio before change:  [4.80500805]
curr_Stock_Price:  101.28991412583431
curr_Factors:  [1.01289914e+02 3.95210570e-02]
mat_Sqrt:  [[ 2.01363374e+01  0.00000000e+00]
 [-7.95196147e-03  1.82202327e-02]]
grads:  [ 0.01157265 -0.11529369]
Stock Position:  0.011572651093759647
Bond Position:  [3.63281521]


portfolio before change:  [4.77866222]
curr_Stock_Price:  98.97411324773243
curr_Factors:  [9.89741132e+01 3.90397930e-02]
mat_Sqrt:  [[ 1.95557903e+01  0.00000000e+00]
 [-7.90339603e-03  1.81089553e-02]]
grads:  [0.01014518 4.45249782]
Stock Position:  0.010145180278421454
Bond Position:  [3.774552]


portfolio before change:  [4.78466425]
curr_Stock_Price:  99.51921702898774
curr_Factors:  [9.95192170e+01 4.00918795e-02]
mat_Sqrt:  [[ 1.99266897e+01  0.00000000e+00]
 [-8.00918268e-03  1.83513429e-02]]
grads:  [ 0.01043936 -5.35486776]
Stock Position:  0.01043936243251614
Bond Position:  [3.74574707]


portfolio before change:  [4.78051386]
curr_Stock_Price:  99.07679212185396
curr_Factors:  [9.90767921e+01 3.91899499e-02]
mat_Sqrt:  [[ 1.96136893e+01  0.00000000e+00]
 [-7.91858067e-03  1.81437477e-02]]
grads:  [0.0092496  8.99757077]
Stock Position:  0.009249599624597782
Bond Position:  [3.8640932]


portfolio before change:  [4.77847043]
curr_Stock_Price:  98.80364760803829
curr_Factors:  [9.88036476e+01 3.96507877e-02]
mat_Sqrt:  [[ 1.96742818e+01  0.00000000e+00]
 [-7.96500222e-03  1.82501128e-02]]
grads:  [5.00776991e-03 8.81779832e+00]
Stock Position:  0.005007769914033088
Bond Position:  [4.28368449]


portfolio before change:  [4.77859897]
curr_Stock_Price:  98.72238395915679
curr_Factors:  [9.87223840e+01 3.67674075e-02]
mat_Sqrt:  [[ 1.89298485e+01  0.00000000e+00]
 [-7.66993168e-03  1.75740213e-02]]
grads:  [0.00783703 2.91788904]
Stock Position:  0.007837032721354458
Bond Position:  [4.00490842]


portfolio before change:  [4.76718977]
curr_Stock_Price:  97.20269550924448
curr_Factors:  [9.72026955e+01 3.81879980e-02]
mat_Sqrt:  [[ 1.89951074e+01  0.00000000e+00]
 [-7.81669986e-03  1.79103094e-02]]
grads:  [ -0.01385813 -11.35139381]
Stock Position:  -0.013858129909709133
Bond Position:  [6.11423735]


portfolio before change:  [4.7703619]
curr_Stock_Price:  97.02894848586922
curr_Factors:  [9.70289485e+01 4.02762027e-02]
mat_Sqrt:  [[ 1.94726736e+01  0.00000000e+00]
 [-8.02757275e-03  1.83934799e-02]]
grads:  [9.88856489e-03 1.27072069e+01]
Stock Position:  0.009888564892369615
Bond Position:  [3.81088485]


portfolio before change:  [4.77165598]
curr_Stock_Price:  97.11163878119044
curr_Factors:  [9.71116388e+01 4.05930179e-02]
mat_Sqrt:  [[ 1.95657704e+01  0.00000000e+00]
 [-8.05908361e-03  1.84656803e-02]]
grads:  [0.00315233 1.72200915]
Stock Position:  0.003152334274755246
Bond Position:  [4.46552763]


portfolio before change:  [4.76610118]
curr_Stock_Price:  95.17243095692916
curr_Factors:  [9.51724310e+01 4.09592446e-02]
mat_Sqrt:  [[ 1.92613681e+01  0.00000000e+00]
 [-8.09535616e-03  1.85487912e-02]]
grads:  [8.92864649e-03 1.03500208e+01]
Stock Position:  0.008928646493824627
Bond Position:  [3.91634018]


portfolio before change:  [4.76866338]
curr_Stock_Price:  95.40456388219394
curr_Factors:  [9.54045639e+01 4.20600823e-02]
mat_Sqrt:  [[ 1.95660973e+01  0.00000000e+00]
 [-8.20342195e-03  1.87964010e-02]]
grads:  [0.0062112  3.51762165]
Stock Position:  0.006211195922927748
Bond Position:  [4.17608694]


portfolio before change:  [4.76748585]
curr_Stock_Price:  95.13093228801975
curr_Factors:  [9.51309323e+01 4.24608639e-02]
mat_Sqrt:  [[ 1.96027123e+01  0.00000000e+00]
 [-8.24241362e-03  1.88857422e-02]]
grads:  [ 0.00071864 -0.46301699]
Stock Position:  0.0007186392294893866
Bond Position:  [4.69912103]


portfolio before change:  [4.76653344]
curr_Stock_Price:  92.98822329966963
curr_Factors:  [9.29882233e+01 4.40402338e-02]
mat_Sqrt:  [[ 1.95142901e+01  0.00000000e+00]
 [-8.39430605e-03  1.92337714e-02]]
grads:  [ 0.02018268 -6.51673383]
Stock Position:  0.020182679314562458
Bond Position:  [2.88978195]


portfolio before change:  [4.75568674]
curr_Stock_Price:  92.43289822631941
curr_Factors:  [9.24328982e+01 4.48717632e-02]
mat_Sqrt:  [[ 1.95800203e+01  0.00000000e+00]
 [-8.47318246e-03  1.94145000e-02]]
grads:  [ 0.00215161 -1.94586467]
Stock Position:  0.0021516122022899485
Bond Position:  [4.55680698]


portfolio before change:  [4.75907288]
curr_Stock_Price:  93.74191957888196
curr_Factors:  [9.37419196e+01 4.34465899e-02]
mat_Sqrt:  [[ 1.95394210e+01  0.00000000e+00]
 [-8.33753823e-03  1.91037000e-02]]
grads:  [2.69699077e-04 5.13370167e+00]
Stock Position:  0.0002696990770015725
Bond Position:  [4.73379077]


portfolio before change:  [4.759608]
curr_Stock_Price:  93.53190670541895
curr_Factors:  [9.35319067e+01 4.33790133e-02]
mat_Sqrt:  [[ 1.94804786e+01  0.00000000e+00]
 [-8.33105163e-03  1.90888374e-02]]
grads:  [-4.05076631e-03 -5.59226482e+00]
Stock Position:  -0.0040507663129155875
Bond Position:  [5.1384839]


portfolio before change:  [4.76005971]
curr_Stock_Price:  93.57896908351884
curr_Factors:  [9.35789691e+01 4.35237840e-02]
mat_Sqrt:  [[ 1.95227764e+01  0.00000000e+00]
 [-8.34494185e-03  1.91206638e-02]]
grads:  [-1.23011183e-03 -4.31066941e+00]
Stock Position:  -0.001230111827426529
Bond Position:  [4.87517231]


portfolio before change:  [4.75987798]
curr_Stock_Price:  94.22213591532122
curr_Factors:  [9.42221359e+01 4.33279481e-02]
mat_Sqrt:  [[ 1.96126829e+01  0.00000000e+00]
 [-8.32614658e-03  1.90775985e-02]]
grads:  [5.57336952e-03 7.93838506e+00]
Stock Position:  0.005573369516333215
Bond Position:  [4.2347432]


portfolio before change:  [4.75404115]
curr_Stock_Price:  93.07988162563099
curr_Factors:  [9.30798816e+01 4.59109325e-02]
mat_Sqrt:  [[ 1.99440741e+01  0.00000000e+00]
 [-8.57073462e-03  1.96380201e-02]]
grads:  [6.29182583e-03 9.27122586e+00]
Stock Position:  0.006291825832027725
Bond Position:  [4.16839875]


portfolio before change:  [4.75165128]
curr_Stock_Price:  92.6172251593796
curr_Factors:  [9.26172252e+01 4.68786822e-02]
mat_Sqrt:  [[ 2.00530050e+01  0.00000000e+00]
 [-8.66059418e-03  1.98439142e-02]]
grads:  [7.59110950e-03 8.60335921e+00]
Stock Position:  0.007591109502339726
Bond Position:  [4.04858378]


portfolio before change:  [4.75113547]
curr_Stock_Price:  92.48260523659411
curr_Factors:  [9.24826052e+01 4.71744446e-02]
mat_Sqrt:  [[ 2.00869248e+01  0.00000000e+00]
 [-8.68787151e-03  1.99064144e-02]]
grads:  [-0.00597397  3.95562686]
Stock Position:  -0.005973966211491454
Bond Position:  [5.30362343]


portfolio before change:  [4.75791483]
curr_Stock_Price:  91.4587678270591
curr_Factors:  [9.14587678e+01 4.69179097e-02]
mat_Sqrt:  [[ 1.98104652e+01  0.00000000e+00]
 [-8.66421696e-03  1.98522150e-02]]
grads:  [-0.02300695  5.58687991]
Stock Position:  -0.02300695301236381
Bond Position:  [6.86210241]


portfolio before change:  [4.79327928]
curr_Stock_Price:  89.95893309940227
curr_Factors:  [8.99589331e+01 4.77523876e-02]
mat_Sqrt:  [[ 1.96581136e+01  0.00000000e+00]
 [-8.74092788e-03  2.00279818e-02]]
grads:  [ 0.0138975  -2.09040927]
Stock Position:  0.013897501947301709
Bond Position:  [3.54307483]


portfolio before change:  [4.78629366]
curr_Stock_Price:  89.42441094414487
curr_Factors:  [8.94244109e+01 4.94842263e-02]
mat_Sqrt:  [[ 1.98925052e+01  0.00000000e+00]
 [-8.89802012e-03  2.03879254e-02]]
grads:  [-0.09101225 -9.52911023]
Stock Position:  -0.0910122503911641
Bond Position:  [12.92501054]


portfolio before change:  [4.77818726]
curr_Stock_Price:  89.53123317308294
curr_Factors:  [8.95312332e+01 4.84112338e-02]
mat_Sqrt:  [[ 1.96991570e+01  0.00000000e+00]
 [-8.80102119e-03  2.01656729e-02]]
grads:  [ 0.03160619 31.34665662]
Stock Position:  0.03160618797537618
Bond Position:  [1.94844628]


portfolio before change:  [4.77211131]
curr_Stock_Price:  89.33128762305988
curr_Factors:  [8.93312876e+01 4.81886760e-02]
mat_Sqrt:  [[ 1.96099321e+01  0.00000000e+00]
 [-8.78076771e-03  2.01192663e-02]]
grads:  [-5.27774431e-04 -7.46039898e+00]
Stock Position:  -0.0005277744310157468
Bond Position:  [4.81925808]


portfolio before change:  [4.77376231]
curr_Stock_Price:  87.3445563231012
curr_Factors:  [8.73445563e+01 4.94453737e-02]
mat_Sqrt:  [[ 1.94222113e+01  0.00000000e+00]
 [-8.89452629e-03  2.03799200e-02]]
grads:  [ 0.0113338  -2.22424473]
Stock Position:  0.0113338001381139
Bond Position:  [3.78381656]


portfolio before change:  [4.79085777]
curr_Stock_Price:  88.81118314935456
curr_Factors:  [8.88111831e+01 4.80526771e-02]
mat_Sqrt:  [[ 1.94682292e+01  0.00000000e+00]
 [-8.76836834e-03  2.00908558e-02]]
grads:  [4.79861044e-03 8.80915801e+00]
Stock Position:  0.0047986104401708226
Bond Position:  [4.3646875]


portfolio before change:  [4.79973157]
curr_Stock_Price:  90.54672421905425
curr_Factors:  [9.05467242e+01 4.65000194e-02]
mat_Sqrt:  [[ 1.95253717e+01  0.00000000e+00]
 [-8.62554526e-03  1.97636070e-02]]
grads:  [-0.12096937  3.64245222]
Stock Position:  -0.12096937199742822
Bond Position:  [15.75311194]


portfolio before change:  [4.82863614]
curr_Stock_Price:  90.32406206634346
curr_Factors:  [9.03240621e+01 4.60634551e-02]
mat_Sqrt:  [[ 1.93857102e+01  0.00000000e+00]
 [-8.58495941e-03  1.96706132e-02]]
grads:  [-3.90746401e-03  5.80541464e+00]
Stock Position:  -0.003907464012997633
Bond Position:  [5.18157416]


portfolio before change:  [4.82933984]
curr_Stock_Price:  90.30973786715916
curr_Factors:  [9.03097379e+01 4.62309101e-02]
mat_Sqrt:  [[ 1.94178349e+01  0.00000000e+00]
 [-8.60054976e-03  1.97063351e-02]]
grads:  [-0.01030903 -7.57974345]
Stock Position:  -0.010309033137397436
Bond Position:  [5.76034592]


portfolio before change:  [4.81448103]
curr_Stock_Price:  91.82092775045689
curr_Factors:  [9.18209278e+01 4.61556802e-02]
mat_Sqrt:  [[ 1.97266916e+01  0.00000000e+00]
 [-8.59354923e-03  1.96902949e-02]]
grads:  [ 0.06952154 -3.44752026]
Stock Position:  0.06952154348873456
Bond Position:  [-1.5690516]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.81372603]
Stock Price:  91.81288913412594
PL:  [4.81372603]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.06802273e-01  3.92317258e-01]
 [-1.74832126e-01 -7.30608284e-02]
 [ 7.57046656e-01 -6.40655620e-01]
 [ 4.81110963e-02  2.14892522e-02]
 [-1.23469318e-01  5.27735735e-02]
 [ 5.90777642e-02  7.78416654e-02]
 [ 2.40545369e-02  2.78144149e-01]
 [ 2.49013612e-01 -2.12192932e-03]
 [ 8.67322737e-02  8.96325332e-02]
 [ 4.18562050e-01 -2.50002265e-01]
 [ 6.30671258e-02 -2.78136113e-03]
 [-1.22878201e-01 -1.89489993e-01]
 [-1.72015332e-01  1.59454989e-01]
 [-5.53039383e-01 -7.05045237e-01]
 [ 7.08373442e-02  2.05078676e-01]
 [ 5.43838761e-02 -2.06488594e-02]
 [-5.22039236e-02  2.27559680e-01]
 [-1.64594981e-01 -1.14087370e-02]
 [ 1.50713988e-02  6.15809458e-02]
 [-1.24794250e-02 -8.49218588e-02]
 [ 1.82435415e-01  8.99385474e-02]
 [ 4.86583139e-02  2.43971674e-01]
 [ 3.71692911e-02  3.49049034e-01]
 [-6.71070298e-02  1.18572397e-01]
 [ 1.91051600e-02  4.77203601e-02]
 [ 5.10955781e-01 -1.21839454e-01]
 [ 1.33457576e-02  7.06857889e-02]
 [-2.07172348e-01  1.46890746e-01]
 [ 2.05487393e-02 -1.47589911e-01]
 [-2.94534928e-02 -3.94414576e-02]
 [-5.69780687e-01 -9.81128475e-02]
 [-1.18067341e-01  5.12409974e-03]
 [ 6.16862492e-02 -2.44043135e-02]
 [ 1.17460537e-01  8.36609530e-02]
 [-2.28950330e-01 -3.82106596e-02]
 [-6.77823546e-01 -2.78727171e-01]
 [-6.66898992e-02  2.99584140e-01]
 [-1.23976183e-01  1.17415667e-01]
 [ 4.33590791e-01  5.08185748e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.24414307]
curr_Stock_Price:  100.23139884612043
curr_Factors:  [1.00231399e+02 3.90622133e-02]
mat_Sqrt:  [[ 1.98098969e+01  0.00000000e+00]
 [-7.90566514e-03  1.81141545e-02]]
grads:  [1.40345789e-02 2.16580497e+01]
Stock Position:  0.01403457894585579
Bond Position:  [2.83743759]


portfolio before change:  [4.25170389]
curr_Stock_Price:  100.74485337293828
curr_Factors:  [1.00744853e+02 3.95463877e-02]
mat_Sqrt:  [[ 2.00343972e+01  0.00000000e+00]
 [-7.95450943e-03  1.82260708e-02]]
grads:  [-0.01031818 -4.00858909]
Stock Position:  -0.010318178493765836
Bond Position:  [5.29120727]


portfolio before change:  [4.25000431]
curr_Stock_Price:  100.97367525624031
curr_Factors:  [1.00973675e+02 3.79596428e-02]
mat_Sqrt:  [[ 1.96729380e+01  0.00000000e+00]
 [-7.79329382e-03  1.78566794e-02]]
grads:  [ 2.42689537e-02 -3.58776458e+01]
Stock Position:  0.02426895370362586
Bond Position:  [1.79947885]


portfolio before change:  [4.26339719]
curr_Stock_Price:  101.51625879612388
curr_Factors:  [1.01516259e+02 3.73081561e-02]
mat_Sqrt:  [[ 1.96081896e+01  0.00000000e+00]
 [-7.72612773e-03  1.77027826e-02]]
grads:  [0.00293193 1.21389121]
Stock Position:  0.002931926714379937
Bond Position:  [3.96575896]


portfolio before change:  [4.2642746]
curr_Stock_Price:  101.64643370093181
curr_Factors:  [1.01646434e+02 3.56944740e-02]
mat_Sqrt:  [[ 1.92040416e+01  0.00000000e+00]
 [-7.55719249e-03  1.73157033e-02]]
grads:  [-0.00523     3.04772913]
Stock Position:  -0.005229995007801263
Bond Position:  [4.79588494]


portfolio before change:  [4.26115902]
curr_Stock_Price:  102.35677935102463
curr_Factors:  [1.02356779e+02 3.62668835e-02]
mat_Sqrt:  [[ 1.94926880e+01  0.00000000e+00]
 [-7.61754643e-03  1.74539916e-02]]
grads:  [0.00477362 4.45982027]
Stock Position:  0.004773618305636578
Bond Position:  [3.77254683]


portfolio before change:  [4.25937145]
curr_Stock_Price:  101.88351718864313
curr_Factors:  [1.01883517e+02 3.58928111e-02]
mat_Sqrt:  [[ 1.93022380e+01  0.00000000e+00]
 [-7.57815926e-03  1.73637442e-02]]
grads:  [7.53521927e-03 1.60186735e+01]
Stock Position:  0.007535219272551178
Bond Position:  [3.4916568]


portfolio before change:  [4.25748994]
curr_Stock_Price:  101.57589568575365
curr_Factors:  [1.01575896e+02 3.53247341e-02]
mat_Sqrt:  [[ 1.90910630e+01  0.00000000e+00]
 [-7.51795016e-03  1.72257878e-02]]
grads:  [ 0.01299496 -0.1231833 ]
Stock Position:  0.012994956130528555
Bond Position:  [2.93751563]


portfolio before change:  [4.26999176]
curr_Stock_Price:  102.50968980449984
curr_Factors:  [1.02509690e+02 3.37243204e-02]
mat_Sqrt:  [[ 1.88250667e+01  0.00000000e+00]
 [-7.34567306e-03  1.68310514e-02]]
grads:  [0.00668529 5.32542686]
Stock Position:  0.0066852946952577
Bond Position:  [3.58468428]


portfolio before change:  [4.27192572]
curr_Stock_Price:  102.73194480885263
curr_Factors:  [1.02731945e+02 3.39509078e-02]
mat_Sqrt:  [[ 1.89291540e+01  0.00000000e+00]
 [-7.37030885e-03  1.68874991e-02]]
grads:  [  0.01634791 -14.80398392]
Stock Position:  0.01634791048786515
Bond Position:  [2.59247308]


portfolio before change:  [4.2671514]
curr_Stock_Price:  102.42007665778
curr_Factors:  [1.02420077e+02 3.34636090e-02]
mat_Sqrt:  [[ 1.87357674e+01  0.00000000e+00]
 [-7.31722450e-03  1.67658676e-02]]
grads:  [ 0.00330135 -0.16589426]
Stock Position:  0.0033013454478120294
Bond Position:  [3.92902735]


portfolio before change:  [4.26721083]
curr_Stock_Price:  102.28930249117307
curr_Factors:  [1.02289302e+02 3.41583683e-02]
mat_Sqrt:  [[ 1.89050911e+01  0.00000000e+00]
 [-7.39279306e-03  1.69390169e-02]]
grads:  [-1.08742355e-02 -1.11865992e+01]
Stock Position:  -0.010874235512775467
Bond Position:  [5.3795288]


portfolio before change:  [4.27315706]
curr_Stock_Price:  101.80432651748174
curr_Factors:  [1.01804327e+02 3.33727125e-02]
mat_Sqrt:  [[ 1.85978178e+01  0.00000000e+00]
 [-7.30727993e-03  1.67430817e-02]]
grads:  [-5.50728425e-03  9.52363442e+00]
Stock Position:  -0.005507284254588148
Bond Position:  [4.83382242]


portfolio before change:  [4.27195367]
curr_Stock_Price:  102.13255546092608
curr_Factors:  [1.02132555e+02 3.36754154e-02]
mat_Sqrt:  [[ 1.87422048e+01  0.00000000e+00]
 [-7.34034500e-03  1.68188433e-02]]
grads:  [ -0.04592557 -41.91995994]
Stock Position:  -0.045925565317484186
Bond Position:  [8.96244902]


portfolio before change:  [4.3092054]
curr_Stock_Price:  101.34581813390008
curr_Factors:  [1.01345818e+02 3.43556525e-02]
mat_Sqrt:  [[ 1.87847290e+01  0.00000000e+00]
 [-7.41411114e-03  1.69878628e-02]]
grads:  [8.53571090e-03 1.20720704e+01]
Stock Position:  0.008535710903857309
Bond Position:  [3.4441468]


portfolio before change:  [4.30716083]
curr_Stock_Price:  101.05584619530562
curr_Factors:  [1.01055846e+02 3.58783007e-02]
mat_Sqrt:  [[ 1.91415621e+01  0.00000000e+00]
 [-7.57662729e-03  1.73602340e-02]]
grads:  [ 0.00237034 -1.18943439]
Stock Position:  0.002370338162289119
Bond Position:  [4.0676243]


portfolio before change:  [4.30601301]
curr_Stock_Price:  100.35708376064414
curr_Factors:  [1.00357084e+02 3.50366895e-02]
mat_Sqrt:  [[ 1.87849293e+01  0.00000000e+00]
 [-7.48723602e-03  1.71554129e-02]]
grads:  [2.50792869e-03 1.32645994e+01]
Stock Position:  0.0025079286884669228
Bond Position:  [4.05432461]


portfolio before change:  [4.30628929]
curr_Stock_Price:  100.26515733994334
curr_Factors:  [1.00265157e+02 3.56882947e-02]
mat_Sqrt:  [[ 1.89414376e+01  0.00000000e+00]
 [-7.55653833e-03  1.73142044e-02]]
grads:  [-0.00895255 -0.65892355]
Stock Position:  -0.00895254975025037
Bond Position:  [5.2039181]


portfolio before change:  [4.30410612]
curr_Stock_Price:  100.58168243271672
curr_Factors:  [1.00581682e+02 3.61327830e-02]
mat_Sqrt:  [[ 1.91191950e+01  0.00000000e+00]
 [-7.60345006e-03  1.74216927e-02]]
grads:  [2.19400069e-03 3.53472804e+00]
Stock Position:  0.0021940006857970877
Bond Position:  [4.08342984]


portfolio before change:  [4.30350379]
curr_Stock_Price:  100.07448500738828
curr_Factors:  [1.00074485e+02 3.38396926e-02]
mat_Sqrt:  [[ 1.84092701e+01  0.00000000e+00]
 [-7.35822725e-03  1.68598167e-02]]
grads:  [-2.69116388e-03 -5.03693845e+00]
Stock Position:  -0.0026911638826302435
Bond Position:  [4.57282062]


portfolio before change:  [4.30034411]
curr_Stock_Price:  101.46099077445153
curr_Factors:  [1.01460991e+02 3.37857780e-02]
mat_Sqrt:  [[ 1.86494514e+01  0.00000000e+00]
 [-7.35236321e-03  1.68463805e-02]]
grads:  [0.0118871  5.33874606]
Stock Position:  0.011887095781891843
Bond Position:  [3.09426759]


portfolio before change:  [4.29297901]
curr_Stock_Price:  100.8088629623354
curr_Factors:  [1.00808863e+02 3.41631390e-02]
mat_Sqrt:  [[ 1.86327776e+01  0.00000000e+00]
 [-7.39330930e-03  1.69401997e-02]]
grads:  [8.32598796e-03 1.44019361e+01]
Stock Position:  0.008325987964415455
Bond Position:  [3.45364563]


portfolio before change:  [4.28542871]
curr_Stock_Price:  99.85017402114426
curr_Factors:  [9.98501740e+01 3.41293516e-02]
mat_Sqrt:  [[ 1.84464519e+01  0.00000000e+00]
 [-7.38965239e-03  1.69318207e-02]]
grads:  [1.02733457e-02 2.06149734e+01]
Stock Position:  0.01027334574218679
Bond Position:  [3.25963335]


portfolio before change:  [4.26951708]
curr_Stock_Price:  98.26168378001799
curr_Factors:  [9.82616838e+01 3.49252576e-02]
mat_Sqrt:  [[ 1.83634387e+01  0.00000000e+00]
 [-7.47532020e-03  1.71281103e-02]]
grads:  [-8.36324475e-04  6.92267825e+00]
Stock Position:  -0.0008363244746114377
Bond Position:  [4.35169573]


portfolio before change:  [4.26954502]
curr_Stock_Price:  98.87873423509888
curr_Factors:  [9.88787342e+01 3.52169545e-02]
mat_Sqrt:  [[ 1.85557621e+01  0.00000000e+00]
 [-7.50647235e-03  1.71994889e-02]]
grads:  [2.15200175e-03 2.77452199e+00]
Stock Position:  0.0021520017542840946
Bond Position:  [4.05675781]


portfolio before change:  [4.27112199]
curr_Stock_Price:  99.37587188544555
curr_Factors:  [9.93758719e+01 3.44588579e-02]
mat_Sqrt:  [[ 1.84472397e+01  0.00000000e+00]
 [-7.42523889e-03  1.70133596e-02]]
grads:  [ 0.02481567 -7.16139882]
Stock Position:  0.02481567383435384
Bond Position:  [1.80504277]


portfolio before change:  [4.28205607]
curr_Stock_Price:  99.80739104389774
curr_Factors:  [9.98073910e+01 3.47439043e-02]
mat_Sqrt:  [[ 1.86038151e+01  0.00000000e+00]
 [-7.45588673e-03  1.70835827e-02]]
grads:  [2.37561838e-03 4.13764433e+00]
Stock Position:  0.002375618381817275
Bond Position:  [4.0449518]


portfolio before change:  [4.28082384]
curr_Stock_Price:  99.07583893100323
curr_Factors:  [9.90758389e+01 3.41717944e-02]
mat_Sqrt:  [[ 1.83147777e+01  0.00000000e+00]
 [-7.39424581e-03  1.69423456e-02]]
grads:  [-7.81139543e-03  8.67003600e+00]
Stock Position:  -0.007811395433792969
Bond Position:  [5.05474439]


portfolio before change:  [4.27545074]
curr_Stock_Price:  99.84458425353088
curr_Factors:  [9.98445843e+01 3.42730508e-02]
mat_Sqrt:  [[ 1.84842100e+01  0.00000000e+00]
 [-7.40519285e-03  1.69674284e-02]]
grads:  [-2.37309459e-03 -8.69842547e+00]
Stock Position:  -0.0023730945921726044
Bond Position:  [4.51239139]


portfolio before change:  [4.27335336]
curr_Stock_Price:  100.96610201582521
curr_Factors:  [1.00966102e+02 3.57708335e-02]
mat_Sqrt:  [[ 1.90958995e+01  0.00000000e+00]
 [-7.56527155e-03  1.73342148e-02]]
grads:  [-0.00244383 -2.275353  ]
Stock Position:  -0.002443831265467036
Bond Position:  [4.52009748]


portfolio before change:  [4.2738994]
curr_Stock_Price:  100.97387948877319
curr_Factors:  [1.00973879e+02 3.53717223e-02]
mat_Sqrt:  [[ 1.89905326e+01  0.00000000e+00]
 [-7.52294860e-03  1.72372407e-02]]
grads:  [-0.03225821 -5.69191143]
Stock Position:  -0.032258212826093556
Bond Position:  [7.5311363]


portfolio before change:  [4.30551745]
curr_Stock_Price:  100.022909478482
curr_Factors:  [1.00022909e+02 3.61412848e-02]
mat_Sqrt:  [[ 1.90152166e+01  0.00000000e+00]
 [-7.60434452e-03  1.74237422e-02]]
grads:  [-0.00609149  0.29408721]
Stock Position:  -0.0060914899400322416
Bond Position:  [4.91480599]


portfolio before change:  [4.306517]
curr_Stock_Price:  99.9596789134148
curr_Factors:  [9.99596789e+01 3.67393122e-02]
mat_Sqrt:  [[ 1.91597732e+01  0.00000000e+00]
 [-7.66700068e-03  1.75673055e-02]]
grads:  [ 0.00266367 -1.38918934]
Stock Position:  0.0026636710755513072
Bond Position:  [4.0402573]


portfolio before change:  [4.30767701]
curr_Stock_Price:  100.20555830108822
curr_Factors:  [1.00205558e+02 3.64701243e-02]
mat_Sqrt:  [[ 1.91364085e+01  0.00000000e+00]
 [-7.63886110e-03  1.75028296e-02]]
grads:  [0.00804609 4.77985302]
Stock Position:  0.008046085038481988
Bond Position:  [3.50141456]


portfolio before change:  [4.30466128]
curr_Stock_Price:  99.77635199979177
curr_Factors:  [9.97763520e+01 3.71086194e-02]
mat_Sqrt:  [[ 1.92205150e+01  0.00000000e+00]
 [-7.70543905e-03  1.76553789e-02]]
grads:  [-0.01277941 -2.16425034]
Stock Position:  -0.012779409340247419
Bond Position:  [5.57974413]


portfolio before change:  [4.32461716]
curr_Stock_Price:  98.26936809097123
curr_Factors:  [9.82693681e+01 3.86440258e-02]
mat_Sqrt:  [[ 1.93178747e+01  0.00000000e+00]
 [-7.86323351e-03  1.80169314e-02]]
grads:  [ -0.04138499 -15.47029098]
Stock Position:  -0.04138499027881914
Bond Position:  [8.391494]


portfolio before change:  [4.25109528]
curr_Stock_Price:  100.07125041620623
curr_Factors:  [1.00071250e+02 3.58536181e-02]
mat_Sqrt:  [[ 1.89485429e+01  0.00000000e+00]
 [-7.57402066e-03  1.73542615e-02]]
grads:  [3.38069998e-03 1.72628573e+01]
Stock Position:  0.003380699982025843
Bond Position:  [3.9127844]


portfolio before change:  [4.25017506]
curr_Stock_Price:  99.65437067007038
curr_Factors:  [9.96543707e+01 3.58160283e-02]
mat_Sqrt:  [[ 1.88597123e+01  0.00000000e+00]
 [-7.57004922e-03  1.73451618e-02]]
grads:  [-3.85646314e-03  6.76936127e+00]
Stock Position:  -0.003856463136381345
Bond Position:  [4.63448847]


portfolio before change:  [4.2508413]
curr_Stock_Price:  99.6318385439265
curr_Factors:  [9.96318385e+01 3.45463302e-02]
mat_Sqrt:  [[ 1.85182143e+01  0.00000000e+00]
 [-7.43465725e-03  1.70349398e-02]]
grads:  [0.02461198 2.98319662]
Stock Position:  0.024611975505521032
Bond Position:  [1.79870493]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.25448621]
Stock Price:  99.77079761933622
PL:  [4.25448621]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.44535022e-01  8.42198164e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.27558576e-01 -7.17066270e-01]
 [-4.26245257e-02  5.92359065e-02]
 [-2.05113877e-02  1.15687947e-02]
 [-8.72080075e-02 -7.55777384e-02]
 [-2.47661926e-02  2.39026616e-01]
 [ 5.44424050e-03 -6.09395249e-02]
 [ 1.64076250e-01  8.22577030e-02]
 [ 2.98879559e-01 -1.35807959e-01]
 [ 6.40469426e-02  6.01781201e-04]
 [-1.49137371e-01 -1.48939041e-01]
 [-1.82413002e-01  1.63181811e-01]
 [-5.77810611e-01 -7.34135127e-01]
 [ 7.35602834e-02  2.13295261e-01]
 [ 5.38366040e-02 -2.03001635e-02]
 [-4.44554217e-02  1.08782641e-01]
 [ 1.27046907e-02  5.22879815e-02]
 [ 1.51858664e-02  5.87386958e-02]
 [-5.74208875e-02 -5.76720274e-02]
 [ 7.30874234e-02 -2.28513415e-02]
 [ 5.09014352e-02  2.40464375e-01]
 [ 3.48103202e-02  2.13086250e-01]
 [-7.88979082e-02  1.10401865e-01]
 [ 3.82247455e-02  8.89128315e-02]
 [ 3.27556505e-01 -3.19621935e-02]
 [-3.45445648e-02  2.05457669e-01]
 [-2.04074463e-01  1.45577699e-01]
 [-3.47201837e-02 -1.19738343e-01]
 [ 4.40364195e-02 -5.66157538e-02]
 [-7.43820849e-01 -9.32116368e-02]
 [-1.18023601e-01  3.42608674e-03]
 [ 1.14796513e-01  7.84136701e-02]
 [ 1.46883422e-01  6.85657142e-02]
 [-2.88965296e-01 -1.79982646e-01]
 [-2.32277142e-01 -3.91010705e-01]
 [-9.71507395e-02  2.72392489e-01]
 [-1.23650642e-01  1.17635284e-01]
 [ 3.66533899e-01  5.87235030e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.66134097]
curr_Stock_Price:  99.3419373668451
curr_Factors:  [9.93419374e+01 4.15522948e-02]
mat_Sqrt:  [[ 2.02502380e+01  0.00000000e+00]
 [-8.15375200e-03  1.86825929e-02]]
grads:  [-0.00532233  4.50792976]
Stock Position:  -0.00532233154632065
Bond Position:  [-1.13261025]


portfolio before change:  [-1.66212039]
curr_Stock_Price:  99.46177782439057
curr_Factors:  [9.94617778e+01 4.00580464e-02]
mat_Sqrt:  [[ 1.99067838e+01  0.00000000e+00]
 [-8.00580253e-03  1.83435981e-02]]
grads:  [-0.01019675 -4.79793386]
Stock Position:  -0.01019674748969674
Bond Position:  [-0.64793376]


portfolio before change:  [-1.66012936]
curr_Stock_Price:  99.25857335077488
curr_Factors:  [9.92585734e+01 4.11197485e-02]
mat_Sqrt:  [[ 2.01276584e+01  0.00000000e+00]
 [-8.11120198e-03  1.85850985e-02]]
grads:  [ 2.55670674e-02 -3.85828608e+01]
Stock Position:  0.025567067357501562
Bond Position:  [-4.19787999]


portfolio before change:  [-1.65471782]
curr_Stock_Price:  99.49075917309287
curr_Factors:  [9.94907592e+01 4.07404832e-02]
mat_Sqrt:  [[ 2.00814853e+01  0.00000000e+00]
 [-8.07370876e-03  1.84991908e-02]]
grads:  [-8.35190046e-04  3.20208096e+00]
Stock Position:  -0.0008351900462521282
Bond Position:  [-1.57162413]


portfolio before change:  [-1.6553832]
curr_Stock_Price:  100.05220617532366
curr_Factors:  [1.00052206e+02 4.00551038e-02]
mat_Sqrt:  [[ 2.00242196e+01  0.00000000e+00]
 [-8.00550848e-03  1.83429243e-02]]
grads:  [-0.00077218  0.63069522]
Stock Position:  -0.0007721824912876057
Bond Position:  [-1.57812464]


portfolio before change:  [-1.6545885]
curr_Stock_Price:  98.76756126840061
curr_Factors:  [9.87675613e+01 3.93634797e-02]
mat_Sqrt:  [[ 1.95957131e+01  0.00000000e+00]
 [-7.93609271e-03  1.81838728e-02]]
grads:  [-0.00613363 -4.15630594]
Stock Position:  -0.006133629143283691
Bond Position:  [-1.0487849]


portfolio before change:  [-1.65934095]
curr_Stock_Price:  99.52100581893502
curr_Factors:  [9.95210058e+01 3.92205943e-02]
mat_Sqrt:  [[ 1.97093291e+01  0.00000000e+00]
 [-7.92167602e-03  1.81508400e-02]]
grads:  [4.03634109e-03 1.31689011e+01]
Stock Position:  0.004036341094219481
Bond Position:  [-2.06104168]


portfolio before change:  [-1.66007948]
curr_Stock_Price:  99.40186776205307
curr_Factors:  [9.94018678e+01 3.92358584e-02]
mat_Sqrt:  [[ 1.96895651e+01  0.00000000e+00]
 [-7.92321736e-03  1.81543717e-02]]
grads:  [-1.07427201e-03 -3.35674107e+00]
Stock Position:  -0.0010742720061069483
Bond Position:  [-1.55329484]


portfolio before change:  [-1.65969419]
curr_Stock_Price:  98.86247019569659
curr_Factors:  [9.88624702e+01 3.96686816e-02]
mat_Sqrt:  [[ 1.96904364e+01  0.00000000e+00]
 [-7.96679926e-03  1.82542303e-02]]
grads:  [0.01015602 4.50622686]
Stock Position:  0.010156019463842057
Bond Position:  [-2.66374337]


portfolio before change:  [-1.64179064]
curr_Stock_Price:  100.65810859301895
curr_Factors:  [1.00658109e+02 3.78734273e-02]
mat_Sqrt:  [[ 1.95891716e+01  0.00000000e+00]
 [-7.78443856e-03  1.78363895e-02]]
grads:  [ 0.01223166 -7.6140947 ]
Stock Position:  0.012231661024139674
Bond Position:  [-2.87300651]


portfolio before change:  [-1.62686099]
curr_Stock_Price:  101.90804572661148
curr_Factors:  [1.01908046e+02 3.69664208e-02]
mat_Sqrt:  [[ 1.95935069e+01  0.00000000e+00]
 [-7.69066143e-03  1.76215191e-02]]
grads:  [0.00328219 0.03415036]
Stock Position:  0.0032821884163192067
Bond Position:  [-1.96134239]


portfolio before change:  [-1.62852548]
curr_Stock_Price:  101.47561807240696
curr_Factors:  [1.01475618e+02 3.75454632e-02]
mat_Sqrt:  [[ 1.96625771e+01  0.00000000e+00]
 [-7.75066069e-03  1.77589947e-02]]
grads:  [-0.01089072 -8.38668202]
Stock Position:  -0.010890723846973524
Bond Position:  [-0.52338254]


portfolio before change:  [-1.63380877]
curr_Stock_Price:  101.95472925818123
curr_Factors:  [1.01954729e+02 3.72563571e-02]
mat_Sqrt:  [[ 1.96792059e+01  0.00000000e+00]
 [-7.72076236e-03  1.76904890e-02]]
grads:  [-5.65036118e-03  9.22426799e+00]
Stock Position:  -0.005650361182419977
Bond Position:  [-1.05772773]


portfolio before change:  [-1.63667075]
curr_Stock_Price:  102.43784060496347
curr_Factors:  [1.02437841e+02 3.79563271e-02]
mat_Sqrt:  [[ 1.99573331e+01  0.00000000e+00]
 [-7.79295344e-03  1.78558995e-02]]
grads:  [ -0.04500669 -41.11442979]
Stock Position:  -0.04500668727755531
Bond Position:  [2.97371711]


portfolio before change:  [-1.57421564]
curr_Stock_Price:  101.0584149959048
curr_Factors:  [1.01058415e+02 3.83465943e-02]
mat_Sqrt:  [[ 1.97895483e+01  0.00000000e+00]
 [-7.83291458e-03  1.79474620e-02]]
grads:  [8.42111019e-03 1.18844247e+01]
Stock Position:  0.008421110191298334
Bond Position:  [-2.42523968]


portfolio before change:  [-1.57931091]
curr_Stock_Price:  100.48935742849794
curr_Factors:  [1.00489357e+02 3.87413424e-02]
mat_Sqrt:  [[ 1.97791399e+01  0.00000000e+00]
 [-7.87312821e-03  1.80396030e-02]]
grads:  [ 0.00227396 -1.12531099]
Stock Position:  0.002273955622966828
Bond Position:  [-1.80781924]


portfolio before change:  [-1.5828921]
curr_Stock_Price:  99.01386388176483
curr_Factors:  [9.90138639e+01 3.99077568e-02]
mat_Sqrt:  [[ 1.97799262e+01  0.00000000e+00]
 [-7.99077035e-03  1.83091550e-02]]
grads:  [1.52741477e-04 5.94143428e+00]
Stock Position:  0.00015274147736667326
Bond Position:  [-1.59801563]


portfolio before change:  [-1.58325037]
curr_Stock_Price:  97.97614877005083
curr_Factors:  [9.79761488e+01 4.11905684e-02]
mat_Sqrt:  [[ 1.98847098e+01  0.00000000e+00]
 [-8.11818388e-03  1.86010961e-02]]
grads:  [1.78655043e-03 2.81101615e+00]
Stock Position:  0.001786550427416326
Bond Position:  [-1.7582897]


portfolio before change:  [-1.58069154]
curr_Stock_Price:  99.53145563529608
curr_Factors:  [9.95314556e+01 4.08996552e-02]
mat_Sqrt:  [[ 2.01289063e+01  0.00000000e+00]
 [-8.08946526e-03  1.85352935e-02]]
grads:  [2.02800561e-03 3.16901893e+00]
Stock Position:  0.002028005611110037
Bond Position:  [-1.78254189]


portfolio before change:  [-1.57752578]
curr_Stock_Price:  101.20235225076529
curr_Factors:  [1.01202352e+02 4.06077869e-02]
mat_Sqrt:  [[ 2.03936644e+01  0.00000000e+00]
 [-8.06054955e-03  1.84690392e-02]]
grads:  [-0.00404984 -3.12263279]
Stock Position:  -0.004049837355558256
Bond Position:  [-1.16767271]


portfolio before change:  [-1.56974929]
curr_Stock_Price:  99.24611075345895
curr_Factors:  [9.92461108e+01 4.09445297e-02]
mat_Sqrt:  [[ 2.00822070e+01  0.00000000e+00]
 [-8.09390187e-03  1.85454590e-02]]
grads:  [ 0.0031428  -1.23217989]
Stock Position:  0.0031427960163656595
Bond Position:  [-1.88165957]


portfolio before change:  [-1.57569672]
curr_Stock_Price:  97.42855506022728
curr_Factors:  [9.74285551e+01 3.96099021e-02]
mat_Sqrt:  [[ 1.93904615e+01  0.00000000e+00]
 [-7.96089463e-03  1.82407011e-02]]
grads:  [8.03738954e-03 1.31828472e+01]
Stock Position:  0.008037389539991127
Bond Position:  [-2.35876797]


portfolio before change:  [-1.57625314]
curr_Stock_Price:  97.39601225264205
curr_Factors:  [9.73960123e+01 3.93586212e-02]
mat_Sqrt:  [[ 1.93224020e+01  0.00000000e+00]
 [-7.93560293e-03  1.81827506e-02]]
grads:  [6.61453913e-03 1.17191428e+01]
Stock Position:  0.006614539130585803
Bond Position:  [-2.22048288]


portfolio before change:  [-1.57452998]
curr_Stock_Price:  97.69848822415653
curr_Factors:  [9.76984882e+01 3.81932156e-02]
mat_Sqrt:  [[ 1.90932982e+01  0.00000000e+00]
 [-7.81723384e-03  1.79115329e-02]]
grads:  [-1.60865784e-03  6.16373071e+00]
Stock Position:  -0.0016086578424643627
Bond Position:  [-1.41736654]


portfolio before change:  [-1.57474117]
curr_Stock_Price:  97.71962813441809
curr_Factors:  [9.77196281e+01 3.95678759e-02]
mat_Sqrt:  [[ 1.94380714e+01  0.00000000e+00]
 [-7.95667025e-03  1.82310218e-02]]
grads:  [3.96281528e-03 4.87700757e+00]
Stock Position:  0.003962815281658881
Bond Position:  [-1.961986]


portfolio before change:  [-1.57361918]
curr_Stock_Price:  98.06464756334816
curr_Factors:  [9.80646476e+01 4.01637780e-02]
mat_Sqrt:  [[ 1.96530406e+01  0.00000000e+00]
 [-8.01636107e-03  1.83677907e-02]]
grads:  [ 0.01595718 -1.74012183]
Stock Position:  0.01595717768856744
Bond Position:  [-3.13845419]


portfolio before change:  [-1.56484609]
curr_Stock_Price:  98.63902360303938
curr_Factors:  [9.86390236e+01 4.06256048e-02]
mat_Sqrt:  [[ 1.98814788e+01  0.00000000e+00]
 [-8.06231776e-03  1.84730907e-02]]
grads:  [2.77265659e-03 1.11219975e+01]
Stock Position:  0.0027726565920439352
Bond Position:  [-1.83833823]


portfolio before change:  [-1.56304252]
curr_Stock_Price:  99.37239288401366
curr_Factors:  [9.93723929e+01 3.98878733e-02]
mat_Sqrt:  [[ 1.98466033e+01  0.00000000e+00]
 [-7.98877946e-03  1.83045933e-02]]
grads:  [-7.08126952e-03  7.95306930e+00]
Stock Position:  -0.007081269516194682
Bond Position:  [-0.85935982]


portfolio before change:  [-1.55996024]
curr_Stock_Price:  98.92195033686379
curr_Factors:  [9.89219503e+01 4.02522041e-02]
mat_Sqrt:  [[ 1.98466634e+01  0.00000000e+00]
 [-8.02518078e-03  1.83879992e-02]]
grads:  [-4.38251405e-03 -6.51176574e+00]
Stock Position:  -0.004382514048980427
Bond Position:  [-1.1264334]


portfolio before change:  [-1.56035597]
curr_Stock_Price:  98.98011701316827
curr_Factors:  [9.89801170e+01 4.07079758e-02]
mat_Sqrt:  [[ 1.99704438e+01  0.00000000e+00]
 [-8.07048706e-03  1.84918089e-02]]
grads:  [ 9.67794155e-04 -3.06166660e+00]
Stock Position:  0.0009677941554463526
Bond Position:  [-1.65614835]


portfolio before change:  [-1.56041257]
curr_Stock_Price:  99.13555746273195
curr_Factors:  [9.91355575e+01 3.99307671e-02]
mat_Sqrt:  [[ 1.98099455e+01  0.00000000e+00]
 [-7.99307372e-03  1.83144327e-02]]
grads:  [-0.03960141 -5.08951811]
Stock Position:  -0.03960140847340171
Bond Position:  [2.36549514]


portfolio before change:  [-1.62346022]
curr_Stock_Price:  100.73508029595492
curr_Factors:  [1.00735080e+02 3.96793491e-02]
mat_Sqrt:  [[ 2.00661016e+01  0.00000000e+00]
 [-7.96787039e-03  1.82566846e-02]]
grads:  [-0.00580722  0.18766204]
Stock Position:  -0.005807223348673635
Bond Position:  [-1.03846911]


portfolio before change:  [-1.62851246]
curr_Stock_Price:  101.58271916794882
curr_Factors:  [1.01582719e+02 3.95877271e-02]
mat_Sqrt:  [[ 2.02115731e+01  0.00000000e+00]
 [-7.95866593e-03  1.82355945e-02]]
grads:  [0.00737296 4.30003365]
Stock Position:  0.007372956227059353
Bond Position:  [-2.37747741]


portfolio before change:  [-1.63238479]
curr_Stock_Price:  101.09782191524368
curr_Factors:  [1.01097822e+02 3.94681078e-02]
mat_Sqrt:  [[ 2.00846816e+01  0.00000000e+00]
 [-7.94663278e-03  1.82080231e-02]]
grads:  [0.00880312 3.76568691]
Stock Position:  0.00880312451447681
Bond Position:  [-2.52236151]


portfolio before change:  [-1.63013592]
curr_Stock_Price:  101.3891035681686
curr_Factors:  [1.01389104e+02 4.00519609e-02]
mat_Sqrt:  [[ 2.02909871e+01  0.00000000e+00]
 [-8.00519441e-03  1.83422047e-02]]
grads:  [-0.01811229 -9.81248709]
Stock Position:  -0.018112286019529095
Bond Position:  [0.20625252]


portfolio before change:  [-1.62005746]
curr_Stock_Price:  100.83408365172166
curr_Factors:  [1.00834084e+02 4.03277457e-02]
mat_Sqrt:  [[ 2.02492680e+01  0.00000000e+00]
 [-8.03270771e-03  1.84052456e-02]]
grads:  [-1.98984083e-02 -2.12445253e+01]
Stock Position:  -0.01989840832567412
Bond Position:  [0.38638031]


portfolio before change:  [-1.62928214]
curr_Stock_Price:  101.30009976184773
curr_Factors:  [1.01300100e+02 4.10587907e-02]
mat_Sqrt:  [[ 2.05264077e+01  0.00000000e+00]
 [-8.10518754e-03  1.85713177e-02]]
grads:  [1.05868935e-03 1.46673754e+01]
Stock Position:  0.001058689349148231
Bond Position:  [-1.73652747]


portfolio before change:  [-1.63067797]
curr_Stock_Price:  100.18669102224221
curr_Factors:  [1.00186691e+02 4.12276799e-02]
mat_Sqrt:  [[ 2.03425073e+01  0.00000000e+00]
 [-8.12184018e-03  1.86094737e-02]]
grads:  [-3.55464515e-03  6.32125795e+00]
Stock Position:  -0.0035546451466356805
Bond Position:  [-1.27454983]


portfolio before change:  [-1.63039936]
curr_Stock_Price:  100.06348943531479
curr_Factors:  [1.00063489e+02 4.10293007e-02]
mat_Sqrt:  [[ 2.02685509e+01  0.00000000e+00]
 [-8.10227629e-03  1.85646472e-02]]
grads:  [0.01934835 3.16318982]
Stock Position:  0.019348346007029196
Bond Position:  [-3.56646238]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.61986947]
Stock Price:  100.63075874667074
PL:  [-2.25062822]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-9.83724980e-02  1.38506905e-01]
 [-1.64756325e-01 -8.69838375e-02]
 [ 8.30783439e-01 -7.24966592e-01]
 [-3.04109859e-02  3.34654006e-02]
 [-1.89297058e-01  7.91184841e-02]
 [ 2.64871679e-01  2.40180363e-01]
 [ 1.37028097e-01 -9.03208039e-02]
 [ 4.40453981e-01 -1.56303742e-02]
 [-1.46082884e-01 -1.02460775e-02]
 [ 6.14949571e-01 -4.97405474e-01]
 [ 5.94906437e-02 -1.51303514e-02]
 [-2.99336507e-01 -2.01134354e-01]
 [-1.08804271e-01  1.21909335e-01]
 [-6.90051767e-01 -9.36257392e-01]
 [ 8.37978337e-03 -8.16027024e-02]
 [ 5.85266669e-02 -2.82776639e-02]
 [-5.23777270e-02  2.37329731e-01]
 [-1.61613931e-01 -1.06274460e-02]
 [ 1.49717621e-02  6.40549395e-02]
 [-7.79880861e-02 -4.08159555e-02]
 [ 2.28835198e-01  1.59663023e-01]
 [ 3.98094652e-02  7.29536912e-03]
 [-8.75374496e-03  1.06966712e-01]
 [ 9.67532186e-02  1.90393493e-01]
 [ 6.42933560e-02  1.36132123e-01]
 [ 7.97356368e-01 -6.79695381e-01]
 [-5.88754175e-01  7.39379720e-01]
 [ 1.10623456e-01 -1.27815685e-02]
 [-5.21794416e-02 -5.73627679e-02]
 [ 1.02807733e-01 -1.53878260e-01]
 [ 6.64878981e-02 -8.01741297e-02]
 [ 2.94126847e-01 -2.60932642e-02]
 [ 3.08995762e-01  4.02029914e-01]
 [ 2.49753306e-01  1.57889232e-02]
 [-1.40163871e-01 -2.45667427e-01]
 [ 1.83553223e-01 -7.44196178e-02]
 [-2.31001899e-01  1.62976779e-01]
 [-1.16954480e-01  1.22152652e-01]
 [-1.97706038e-01  1.49820864e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.63392373]
curr_Stock_Price:  99.49668303240641
curr_Factors:  [9.94966830e+01 4.03078972e-02]
mat_Sqrt:  [[ 1.99757767e+01  0.00000000e+00]
 [-8.03073070e-03  1.84007157e-02]]
grads:  [-1.89845578e-03  7.52725643e+00]
Stock Position:  -0.001898455782404155
Bond Position:  [-0.44503368]


portfolio before change:  [-0.63309728]
curr_Stock_Price:  99.03205242132691
curr_Factors:  [9.90320524e+01 4.22059877e-02]
mat_Sqrt:  [[ 2.03452398e+01  0.00000000e+00]
 [-8.21763836e-03  1.88289749e-02]]
grads:  [-0.00996396 -4.61967993]
Stock Position:  -0.009963961364874232
Bond Position:  [0.35365426]


portfolio before change:  [-0.63388328]
curr_Stock_Price:  99.11537319045858
curr_Factors:  [9.91153732e+01 4.27011728e-02]
mat_Sqrt:  [[ 2.04814605e+01  0.00000000e+00]
 [-8.26570484e-03  1.89391090e-02]]
grads:  [ 2.51145214e-02 -3.82788119e+01]
Stock Position:  0.02511452144652002
Bond Position:  [-3.12311845]


portfolio before change:  [-0.6157758]
curr_Stock_Price:  99.85191486445176
curr_Factors:  [9.98519149e+01 4.34931966e-02]
mat_Sqrt:  [[ 2.08241394e+01  0.00000000e+00]
 [-8.34200903e-03  1.91139439e-02]]
grads:  [-7.58998365e-04  1.75083702e+00]
Stock Position:  -0.0007589983650305427
Bond Position:  [-0.53998836]


portfolio before change:  [-0.61884269]
curr_Stock_Price:  103.80367715863937
curr_Factors:  [1.03803677e+02 4.21330590e-02]
mat_Sqrt:  [[ 2.13070946e+01  0.00000000e+00]
 [-8.21053558e-03  1.88127004e-02]]
grads:  [-0.00726363  4.20558891]
Stock Position:  -0.007263633217548478
Bond Position:  [0.13514915]


portfolio before change:  [-0.62145705]
curr_Stock_Price:  104.16592754394686
curr_Factors:  [1.04165928e+02 4.13205978e-02]
mat_Sqrt:  [[ 2.11742962e+01  0.00000000e+00]
 [-8.13098742e-03  1.86304327e-02]]
grads:  [ 0.01745961 12.89182958]
Stock Position:  0.017459611401883006
Bond Position:  [-2.44015366]


portfolio before change:  [-0.62334964]
curr_Stock_Price:  104.07499995801886
curr_Factors:  [1.04075000e+02 4.06449362e-02]
mat_Sqrt:  [[ 2.09821333e+01  0.00000000e+00]
 [-8.06423573e-03  1.84774853e-02]]
grads:  [ 4.65199913e-03 -4.88815454e+00]
Stock Position:  0.004651999125902337
Bond Position:  [-1.10750645]


portfolio before change:  [-0.62367794]
curr_Stock_Price:  104.03418958757788
curr_Factors:  [1.04034190e+02 4.04634008e-02]
mat_Sqrt:  [[ 2.09270147e+01  0.00000000e+00]
 [-8.04620664e-03  1.84361755e-02]]
grads:  [ 0.02072117 -0.84781001]
Stock Position:  0.020721174678805913
Bond Position:  [-2.77938856]


portfolio before change:  [-0.61010314]
curr_Stock_Price:  104.70607451862266
curr_Factors:  [1.04706075e+02 4.00260816e-02]
mat_Sqrt:  [[ 2.09480410e+01  0.00000000e+00]
 [-8.00260774e-03  1.83362779e-02]]
grads:  [-0.00718705 -0.55878721]
Stock Position:  -0.007187050959437412
Bond Position:  [0.14242475]


portfolio before change:  [-0.6157547]
curr_Stock_Price:  105.49490434021207
curr_Factors:  [1.05494904e+02 3.92723988e-02]
mat_Sqrt:  [[ 2.09062046e+01  0.00000000e+00]
 [-7.92690596e-03  1.81628233e-02]]
grads:  [ 1.90309064e-02 -2.73859117e+01]
Stock Position:  0.019030906448355527
Bond Position:  [-2.62341835]


portfolio before change:  [-0.63628237]
curr_Stock_Price:  104.43348772600851
curr_Factors:  [1.04433488e+02 3.99042024e-02]
mat_Sqrt:  [[ 2.08616714e+01  0.00000000e+00]
 [-7.99041450e-03  1.83083396e-02]]
grads:  [ 0.00253514 -0.82641854]
Stock Position:  0.002535138057694863
Bond Position:  [-0.90103567]


portfolio before change:  [-0.6351105]
curr_Stock_Price:  104.94016703856916
curr_Factors:  [1.04940167e+02 3.90449718e-02]
mat_Sqrt:  [[ 2.07359677e+01  0.00000000e+00]
 [-7.90392022e-03  1.81101563e-02]]
grads:  [ -0.01866895 -11.10616331]
Stock Position:  -0.018668949610348463
Bond Position:  [1.32401219]


portfolio before change:  [-0.62615217]
curr_Stock_Price:  104.46918100346086
curr_Factors:  [1.04469181e+02 3.79156645e-02]
mat_Sqrt:  [[ 2.03421815e+01  0.00000000e+00]
 [-7.78877803e-03  1.78463324e-02]]
grads:  [-2.73317173e-03  6.83105817e+00]
Stock Position:  -0.0027331717330943747
Bond Position:  [-0.34061996]


portfolio before change:  [-0.62504406]
curr_Stock_Price:  104.04817197719116
curr_Factors:  [1.04048172e+02 3.89645927e-02]
mat_Sqrt:  [[ 2.05385379e+01  0.00000000e+00]
 [-7.89578041e-03  1.80915057e-02]]
grads:  [ -0.053493   -51.75121449]
Stock Position:  -0.05349299913083801
Bond Position:  [4.94080471]


portfolio before change:  [-0.59615567]
curr_Stock_Price:  103.5196775053999
curr_Factors:  [1.03519678e+02 3.85293728e-02]
mat_Sqrt:  [[ 2.03197743e+01  0.00000000e+00]
 [-7.85156013e-03  1.79901843e-02]]
grads:  [-1.34029814e-03 -4.53595700e+00]
Stock Position:  -0.0013402981404302546
Bond Position:  [-0.45740844]


portfolio before change:  [-0.59489833]
curr_Stock_Price:  102.5389122316156
curr_Factors:  [1.02538912e+02 3.80477242e-02]
mat_Sqrt:  [[ 2.00010616e+01  0.00000000e+00]
 [-7.80233033e-03  1.78773847e-02]]
grads:  [ 0.00230914 -1.58175619]
Stock Position:  0.0023091415553674216
Bond Position:  [-0.8316752]


portfolio before change:  [-0.5989119]
curr_Stock_Price:  100.84581656596323
curr_Factors:  [1.00845817e+02 3.86251909e-02]
mat_Sqrt:  [[ 1.98195234e+01  0.00000000e+00]
 [-7.86131703e-03  1.80125402e-02]]
grads:  [2.58338499e-03 1.31758058e+01]
Stock Position:  0.0025833849885863102
Bond Position:  [-0.85943546]


portfolio before change:  [-0.60056128]
curr_Stock_Price:  100.24894566012986
curr_Factors:  [1.00248946e+02 3.96938972e-02]
mat_Sqrt:  [[ 1.99729256e+01  0.00000000e+00]
 [-7.96933093e-03  1.82600311e-02]]
grads:  [-0.00832387 -0.58200591]
Stock Position:  -0.008323874648553215
Bond Position:  [0.23389838]


portfolio before change:  [-0.61018997]
curr_Stock_Price:  101.40921473490862
curr_Factors:  [1.01409215e+02 3.96447189e-02]
mat_Sqrt:  [[ 2.01915701e+01  0.00000000e+00]
 [-7.96439265e-03  1.82487161e-02]]
grads:  [2.12601741e-03 3.51010664e+00]
Stock Position:  0.0021260174095512328
Bond Position:  [-0.82578773]


portfolio before change:  [-0.60950945]
curr_Stock_Price:  101.7778614283578
curr_Factors:  [1.01777861e+02 4.01360924e-02]
mat_Sqrt:  [[ 2.03901709e+01  0.00000000e+00]
 [-8.01359768e-03  1.83614590e-02]]
grads:  [-0.00469842 -2.22291461]
Stock Position:  -0.004698422104318149
Bond Position:  [-0.1313141]


portfolio before change:  [-0.6133757]
curr_Stock_Price:  102.59724974267692
curr_Factors:  [1.02597250e+02 4.00540136e-02]
mat_Sqrt:  [[ 2.05332994e+01  0.00000000e+00]
 [-8.00539954e-03  1.83426747e-02]]
grads:  [0.01453823 8.70445702]
Stock Position:  0.014538231212647204
Bond Position:  [-2.10495824]


portfolio before change:  [-0.59608708]
curr_Stock_Price:  103.80453276948141
curr_Factors:  [1.03804533e+02 4.04147173e-02]
mat_Sqrt:  [[ 2.08682529e+01  0.00000000e+00]
 [-8.04136479e-03  1.84250814e-02]]
grads:  [0.00206023 0.39594773]
Stock Position:  0.002060231183269422
Bond Position:  [-0.80994841]


portfolio before change:  [-0.59632991]
curr_Stock_Price:  103.73581094525177
curr_Factors:  [1.03735811e+02 3.92506302e-02]
mat_Sqrt:  [[ 2.05519022e+01  0.00000000e+00]
 [-7.92470872e-03  1.81577888e-02]]
grads:  [1.84558855e-03 5.89095473e+00]
Stock Position:  0.0018455885539230591
Bond Position:  [-0.78778354]


portfolio before change:  [-0.59420857]
curr_Stock_Price:  104.93857996615317
curr_Factors:  [1.04938580e+02 3.81978223e-02]
mat_Sqrt:  [[ 2.05094722e+01  0.00000000e+00]
 [-7.81770527e-03  1.79126131e-02]]
grads:  [8.76900923e-03 1.06290184e+01]
Stock Position:  0.008769009229500968
Bond Position:  [-1.51441595]


portfolio before change:  [-0.59407854]
curr_Stock_Price:  104.97499789403558
curr_Factors:  [1.04974998e+02 3.70249352e-02]
mat_Sqrt:  [[ 2.01991469e+01  0.00000000e+00]
 [-7.69674583e-03  1.76354602e-02]]
grads:  [6.12433217e-03 7.71922714e+00]
Stock Position:  0.006124332170738016
Bond Position:  [-1.2369803]


portfolio before change:  [-0.58682399]
curr_Stock_Price:  106.18479240502074
curr_Factors:  [1.06184792e+02 3.60100011e-02]
mat_Sqrt:  [[ 2.01499461e+01  0.00000000e+00]
 [-7.59052052e-03  1.73920674e-02]]
grads:  [ 2.48493460e-02 -3.90807696e+01]
Stock Position:  0.02484934603353852
Bond Position:  [-3.22544664]


portfolio before change:  [-0.57991312]
curr_Stock_Price:  106.47912906050773
curr_Factors:  [1.06479129e+02 3.56641997e-02]
mat_Sqrt:  [[ 2.01085489e+01  0.00000000e+00]
 [-7.55398699e-03  1.73083586e-02]]
grads:  [-1.32313083e-02  4.27180727e+01]
Stock Position:  -0.013231308319225872
Bond Position:  [0.82894507]


portfolio before change:  [-0.58555366]
curr_Stock_Price:  106.91326323162448
curr_Factors:  [1.06913263e+02 3.50901330e-02]
mat_Sqrt:  [[ 2.00273779e+01  0.00000000e+00]
 [-7.49294420e-03  1.71684920e-02]]
grads:  [ 0.00524508 -0.74447823]
Stock Position:  0.005245076147181622
Bond Position:  [-1.14632187]


portfolio before change:  [-0.58462835]
curr_Stock_Price:  107.1169980522137
curr_Factors:  [1.07116998e+02 3.46235472e-02]
mat_Sqrt:  [[ 1.99316923e+01  0.00000000e+00]
 [-7.44296148e-03  1.70539672e-02]]
grads:  [-0.00387396 -3.36360257]
Stock Position:  -0.003873961375770865
Bond Position:  [-0.16966124]


portfolio before change:  [-0.58870939]
curr_Stock_Price:  108.16497735697459
curr_Factors:  [1.08164977e+02 3.38854537e-02]
mat_Sqrt:  [[ 1.99110112e+01  0.00000000e+00]
 [-7.36320079e-03  1.68712125e-02]]
grads:  [ 1.79045423e-03 -9.12075882e+00]
Stock Position:  0.0017904542313249016
Bond Position:  [-0.78237383]


portfolio before change:  [-0.58759827]
curr_Stock_Price:  108.8401852732614
curr_Factors:  [1.08840185e+02 3.29722094e-02]
mat_Sqrt:  [[ 1.97634745e+01  0.00000000e+00]
 [-7.26330057e-03  1.66423123e-02]]
grads:  [ 1.59369949e-03 -4.81748739e+00]
Stock Position:  0.0015936994895333172
Bond Position:  [-0.76105681]


portfolio before change:  [-0.58701399]
curr_Stock_Price:  109.26650148178595
curr_Factors:  [1.09266501e+02 3.29279657e-02]
mat_Sqrt:  [[ 1.98275698e+01  0.00000000e+00]
 [-7.25842580e-03  1.66311428e-02]]
grads:  [ 0.01425988 -1.56893994]
Stock Position:  0.01425988236326914
Bond Position:  [-2.14514144]


portfolio before change:  [-0.59113371]
curr_Stock_Price:  108.99640339073382
curr_Factors:  [1.08996403e+02 3.34299272e-02]
mat_Sqrt:  [[ 1.99287419e+01  0.00000000e+00]
 [-7.31354111e-03  1.67574279e-02]]
grads:  [ 0.02430941 23.99114695]
Stock Position:  0.024309412183458216
Bond Position:  [-3.24077221]


portfolio before change:  [-0.60758853]
curr_Stock_Price:  108.33617782298485
curr_Factors:  [1.08336178e+02 3.46700555e-02]
mat_Sqrt:  [[ 2.01720845e+01  0.00000000e+00]
 [-7.44795870e-03  1.70654173e-02]]
grads:  [0.01272274 0.92519995]
Stock Position:  0.012722738591843481
Bond Position:  [-1.9859214]


portfolio before change:  [-0.59988909]
curr_Stock_Price:  108.96086172189379
curr_Factors:  [1.08960862e+02 3.38870766e-02]
mat_Sqrt:  [[ 2.00579979e+01  0.00000000e+00]
 [-7.36337711e-03  1.68716165e-02]]
grads:  [-1.23333310e-02 -1.45609893e+01]
Stock Position:  -0.012333330980440269
Bond Position:  [0.74396128]


portfolio before change:  [-0.58087661]
curr_Stock_Price:  107.42684959717414
curr_Factors:  [1.07426850e+02 3.43108795e-02]
mat_Sqrt:  [[ 1.98988861e+01  0.00000000e+00]
 [-7.40927846e-03  1.69767897e-02]]
grads:  [ 0.00759208 -4.38360957]
Stock Position:  0.0075920751694061464
Bond Position:  [-1.39646933]


portfolio before change:  [-0.57824988]
curr_Stock_Price:  107.79582715233529
curr_Factors:  [1.07795827e+02 3.44473806e-02]
mat_Sqrt:  [[ 2.00069115e+01  0.00000000e+00]
 [-7.42400222e-03  1.70105261e-02]]
grads:  [-7.99088863e-03  9.58093699e+00]
Stock Position:  -0.007990888627030623
Bond Position:  [0.28313457]


portfolio before change:  [-0.56876633]
curr_Stock_Price:  106.61346177818733
curr_Factors:  [1.06613462e+02 3.41594218e-02]
mat_Sqrt:  [[ 1.97045854e+01  0.00000000e+00]
 [-7.39290706e-03  1.69392781e-02]]
grads:  [-3.22984172e-03  7.21120763e+00]
Stock Position:  -0.0032298417225929995
Bond Position:  [-0.22442173]


portfolio before change:  [-0.5689354]
curr_Stock_Price:  106.6571195351258
curr_Factors:  [1.06657120e+02 3.37781196e-02]
mat_Sqrt:  [[ 1.96023250e+01  0.00000000e+00]
 [-7.35152986e-03  1.68444710e-02]]
grads:  [-6.75016113e-03  8.89436444e+00]
Stock Position:  -0.0067501611308714475
Bond Position:  [0.15101735]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.55973565]
Stock Price:  105.29702308489364
PL:  [-5.85675873]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.12088549e-02  2.74570410e-01]
 [-1.95847221e-01 -7.60427354e-02]
 [ 7.70231606e-01 -6.49624579e-01]
 [-1.82707584e-02  2.54985419e-02]
 [-1.23272739e-01  5.26949006e-02]
 [-2.00527851e-02  7.91534845e-04]
 [-7.43111654e-03  2.93380415e-01]
 [ 2.09725673e-01 -2.09040377e-03]
 [ 1.63332044e-01  8.08789596e-02]
 [ 1.87066184e-01 -2.87293354e-02]
 [ 1.17943305e-01  1.90961697e-01]
 [-2.26087251e-02  1.22299301e-01]
 [ 9.22839541e-02  6.48846459e-02]
 [-5.03198638e-01 -6.46515163e-01]
 [ 7.34057965e-02  2.12827878e-01]
 [ 5.41952490e-02 -2.05286751e-02]
 [-5.28286503e-02  2.62677591e-01]
 [-8.76796200e-02  7.92076734e-02]
 [ 1.49128756e-02  6.55170990e-02]
 [-7.37247092e-02 -4.42163581e-02]
 [ 2.24905058e-01  1.50129862e-01]
 [ 1.03803525e-04  8.94198031e-02]
 [ 3.79712514e-02  3.95271205e-01]
 [-5.59186796e-02  1.26325404e-01]
 [ 2.29280544e-02  5.30537553e-02]
 [ 5.23504029e-01 -1.30510109e-01]
 [-3.36460083e-02  7.88689166e-02]
 [-2.01015024e-01  1.44040838e-01]
 [-7.15245147e-02 -1.01247979e-01]
 [ 5.73786986e-02 -5.97342855e-02]
 [-7.01400419e-01 -8.98237883e-02]
 [-1.18084364e-01  5.78491303e-03]
 [ 3.05654519e-02 -7.31750243e-02]
 [ 8.54711557e-02  1.00072918e-01]
 [-1.39651363e-01  9.77910733e-02]
 [-8.25718939e-01 -2.48407423e-01]
 [-3.44986778e-02  3.08719561e-01]
 [-1.26379118e-01  1.15794598e-01]
 [ 3.67246239e-01  5.86309673e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.97255991]
curr_Stock_Price:  99.88926165630218
curr_Factors:  [9.98892617e+01 4.12969795e-02]
mat_Sqrt:  [[ 2.02991544e+01  0.00000000e+00]
 [-8.12866331e-03  1.86251074e-02]]
grads:  [6.45550075e-03 1.47419504e+01]
Stock Position:  0.006455500745775474
Bond Position:  [1.32772471]


portfolio before change:  [1.98291794]
curr_Stock_Price:  101.46807903889854
curr_Factors:  [1.01468079e+02 4.15136827e-02]
mat_Sqrt:  [[ 2.06740265e+01  0.00000000e+00]
 [-8.14996272e-03  1.86739105e-02]]
grads:  [-0.01107839 -4.07213771]
Stock Position:  -0.01107839303699798
Bond Position:  [3.1070212]


portfolio before change:  [1.99179573]
curr_Stock_Price:  100.70177828455996
curr_Factors:  [1.00701778e+02 4.03519806e-02]
mat_Sqrt:  [[ 2.02287743e+01  0.00000000e+00]
 [-8.03512097e-03  1.84107750e-02]]
grads:  [ 2.40603899e-02 -3.52850208e+01]
Stock Position:  0.02406038990870122
Bond Position:  [-0.43112832]


portfolio before change:  [1.97814593]
curr_Stock_Price:  100.13670429391303
curr_Factors:  [1.00136704e+02 4.14302624e-02]
mat_Sqrt:  [[ 2.03822505e+01  0.00000000e+00]
 [-8.14177007e-03  1.86551388e-02]]
grads:  [-3.50416769e-04  1.36683742e+00]
Stock Position:  -0.0003504167690875267
Bond Position:  [2.01323551]


portfolio before change:  [1.97786973]
curr_Stock_Price:  101.64310426154016
curr_Factors:  [1.01643104e+02 4.12686700e-02]
mat_Sqrt:  [[ 2.06484833e+01  0.00000000e+00]
 [-8.12587669e-03  1.86187225e-02]]
grads:  [-0.00485628  2.83021032]
Stock Position:  -0.004856279126773462
Bond Position:  [2.47147702]


portfolio before change:  [1.97892545]
curr_Stock_Price:  101.489331348188
curr_Factors:  [1.01489331e+02 3.93663044e-02]
mat_Sqrt:  [[ 2.01364410e+01  0.00000000e+00]
 [-7.93637745e-03  1.81845252e-02]]
grads:  [-0.00097869  0.04352794]
Stock Position:  -0.0009786898789264525
Bond Position:  [2.07825203]


portfolio before change:  [1.98047779]
curr_Stock_Price:  100.16864366061154
curr_Factors:  [1.00168644e+02 3.90117419e-02]
mat_Sqrt:  [[ 1.97846998e+01  0.00000000e+00]
 [-7.90055612e-03  1.81024482e-02]]
grads:  [6.09615486e-03 1.62066706e+01]
Stock Position:  0.006096154862849411
Bond Position:  [1.36983423]


portfolio before change:  [1.98486497]
curr_Stock_Price:  100.8602165324517
curr_Factors:  [1.00860217e+02 3.92762603e-02]
mat_Sqrt:  [[ 1.99887189e+01  0.00000000e+00]
 [-7.92729566e-03  1.81637162e-02]]
grads:  [ 0.01044656 -0.11508679]
Stock Position:  0.010446559741523302
Bond Position:  [0.93122269]


portfolio before change:  [1.96507846]
curr_Stock_Price:  98.95500329171952
curr_Factors:  [9.89550033e+01 4.09953723e-02]
mat_Sqrt:  [[ 2.00357302e+01  0.00000000e+00]
 [-8.09892558e-03  1.85569698e-02]]
grads:  [0.00991381 4.35841415]
Stock Position:  0.00991381466400987
Bond Position:  [0.98405689]


portfolio before change:  [1.96475112]
curr_Stock_Price:  98.90957662790673
curr_Factors:  [9.89095766e+01 4.03365319e-02]
mat_Sqrt:  [[ 1.98649566e+01  0.00000000e+00]
 [-8.03358271e-03  1.84072504e-02]]
grads:  [ 0.00878571 -1.56076191]
Stock Position:  0.008785706300205101
Bond Position:  [1.09576063]


portfolio before change:  [1.96303232]
curr_Stock_Price:  98.69834944849705
curr_Factors:  [9.86983494e+01 4.14240929e-02]
mat_Sqrt:  [[ 2.00879858e+01  0.00000000e+00]
 [-8.14116384e-03  1.86537498e-02]]
grads:  [1.00202093e-02 1.02371748e+01]
Stock Position:  0.010020209278017406
Bond Position:  [0.9740542]


portfolio before change:  [1.9682784]
curr_Stock_Price:  99.20974787447281
curr_Factors:  [9.92097479e+01 4.15143967e-02]
mat_Sqrt:  [[ 2.02140675e+01  0.00000000e+00]
 [-8.15003280e-03  1.86740711e-02]]
grads:  [1.52206210e-03 6.54915045e+00]
Stock Position:  0.001522062096625288
Bond Position:  [1.817275]


portfolio before change:  [1.96828804]
curr_Stock_Price:  99.06682517978041
curr_Factors:  [9.90668252e+01 4.05004389e-02]
mat_Sqrt:  [[ 1.99369220e+01  0.00000000e+00]
 [-8.04988834e-03  1.84446113e-02]]
grads:  [0.00604918 3.51781042]
Stock Position:  0.006049175244668883
Bond Position:  [1.36901545]


portfolio before change:  [1.98369414]
curr_Stock_Price:  101.58534475029398
curr_Factors:  [1.01585345e+02 4.02561163e-02]
mat_Sqrt:  [[ 2.03820093e+01  0.00000000e+00]
 [-8.02557076e-03  1.83888928e-02]]
grads:  [ -0.03853207 -35.15791687]
Stock Position:  -0.038532068907729325
Bond Position:  [5.89798765]


portfolio before change:  [2.00417694]
curr_Stock_Price:  101.07290141110519
curr_Factors:  [1.01072901e+02 4.03336284e-02]
mat_Sqrt:  [[ 2.02987072e+01  0.00000000e+00]
 [-8.03329356e-03  1.84065879e-02]]
grads:  [8.19222110e-03 1.15625926e+01]
Stock Position:  0.008192221101036764
Bond Position:  [1.17616538]


portfolio before change:  [2.00273838]
curr_Stock_Price:  100.87935386290293
curr_Factors:  [1.00879354e+02 4.08005315e-02]
mat_Sqrt:  [[ 2.03767634e+01  0.00000000e+00]
 [-8.07965658e-03  1.85128189e-02]]
grads:  [ 0.00221997 -1.10888975]
Stock Position:  0.0022199698673828552
Bond Position:  [1.77878926]


portfolio before change:  [2.00550932]
curr_Stock_Price:  102.02737778390592
curr_Factors:  [1.02027378e+02 4.04697689e-02]
mat_Sqrt:  [[ 2.05249490e+01  0.00000000e+00]
 [-8.04683976e-03  1.84376262e-02]]
grads:  [3.01161523e-03 1.42468227e+01]
Stock Position:  0.003011615232641853
Bond Position:  [1.69824212]


portfolio before change:  [2.00610217]
curr_Stock_Price:  102.15373830315086
curr_Factors:  [1.02153738e+02 3.84736207e-02]
mat_Sqrt:  [[ 2.00371428e+01  0.00000000e+00]
 [-7.84587746e-03  1.79771637e-02]]
grads:  [-2.65060532e-03  4.40601614e+00]
Stock Position:  -0.0026506053156043785
Bond Position:  [2.27687141]


portfolio before change:  [2.00673739]
curr_Stock_Price:  102.0214691224134
curr_Factors:  [1.02021469e+02 3.82138658e-02]
mat_Sqrt:  [[ 1.99435313e+01  0.00000000e+00]
 [-7.81934686e-03  1.79163744e-02]]
grads:  [2.18150342e-03 3.65682796e+00]
Stock Position:  0.002181503420997134
Bond Position:  [1.7841772]


portfolio before change:  [2.00614703]
curr_Stock_Price:  101.64860800344802
curr_Factors:  [1.01648608e+02 3.80177408e-02]
mat_Sqrt:  [[ 1.98195865e+01  0.00000000e+00]
 [-7.79925543e-03  1.78703392e-02]]
grads:  [-0.00469345 -2.47428757]
Stock Position:  -0.004693453627966729
Bond Position:  [2.48323005]


portfolio before change:  [2.00259655]
curr_Stock_Price:  102.47122135867767
curr_Factors:  [1.02471221e+02 3.79300341e-02]
mat_Sqrt:  [[ 1.99569206e+01  0.00000000e+00]
 [-7.79025382e-03  1.78497139e-02]]
grads:  [0.0145527  8.41077134]
Stock Position:  0.014552701176721023
Bond Position:  [0.51136349]


portfolio before change:  [2.0027786]
curr_Stock_Price:  102.47933845948619
curr_Factors:  [1.02479338e+02 3.90751124e-02]
mat_Sqrt:  [[ 2.02575272e+01  0.00000000e+00]
 [-7.90697034e-03  1.81171450e-02]]
grads:  [1.93161804e-03 4.93564537e+00]
Stock Position:  0.0019316180423181862
Bond Position:  [1.80482766]


portfolio before change:  [1.99958079]
curr_Stock_Price:  100.70702826639629
curr_Factors:  [1.00707028e+02 3.92836086e-02]
mat_Sqrt:  [[ 1.99602267e+01  0.00000000e+00]
 [-7.92803720e-03  1.81654153e-02]]
grads:  [1.05450580e-02 2.17595469e+01]
Stock Position:  0.01054505802387884
Bond Position:  [0.93761934]


portfolio before change:  [1.97965681]
curr_Stock_Price:  98.80649890912753
curr_Factors:  [9.88064989e+01 4.01842734e-02]
mat_Sqrt:  [[ 1.98067660e+01  0.00000000e+00]
 [-8.01840617e-03  1.83724766e-02]]
grads:  [-3.96709463e-05  6.87579618e+00]
Stock Position:  -3.9670946293386415e-05
Bond Position:  [1.98357656]


portfolio before change:  [1.97984038]
curr_Stock_Price:  100.42957847741908
curr_Factors:  [1.00429578e+02 3.93838693e-02]
mat_Sqrt:  [[ 1.99306210e+01  0.00000000e+00]
 [-7.93814782e-03  1.81885816e-02]]
grads:  [2.31215131e-03 2.91687149e+00]
Stock Position:  0.0023121513114521233
Bond Position:  [1.747632]


portfolio before change:  [1.97780281]
curr_Stock_Price:  99.45384573829728
curr_Factors:  [9.94538457e+01 3.98590987e-02]
mat_Sqrt:  [[ 1.98557053e+01  0.00000000e+00]
 [-7.98589744e-03  1.82979897e-02]]
grads:  [ 0.02349676 -7.13248343]
Stock Position:  0.02349676027799495
Bond Position:  [-0.35904036]


portfolio before change:  [2.01071925]
curr_Stock_Price:  100.85664846339931
curr_Factors:  [1.00856648e+02 3.88302011e-02]
mat_Sqrt:  [[ 1.98741861e+01  0.00000000e+00]
 [-7.88215210e-03  1.80602793e-02]]
grads:  [3.90058154e-05 4.36698210e+00]
Stock Position:  3.900581540990817e-05
Bond Position:  [2.00678525]


portfolio before change:  [2.01088244]
curr_Stock_Price:  98.6091130879675
curr_Factors:  [9.86091131e+01 3.95654935e-02]
mat_Sqrt:  [[ 1.96144144e+01  0.00000000e+00]
 [-7.95643070e-03  1.82304730e-02]]
grads:  [-7.04331244e-03  7.90110263e+00]
Stock Position:  -0.007043312440066886
Bond Position:  [2.70541724]


portfolio before change:  [2.01304617]
curr_Stock_Price:  98.34992681142712
curr_Factors:  [9.83499268e+01 3.91112019e-02]
mat_Sqrt:  [[ 1.94502247e+01  0.00000000e+00]
 [-7.91062090e-03  1.81255095e-02]]
grads:  [-0.00594917 -5.58593838]
Stock Position:  -0.005949173216771659
Bond Position:  [2.59814692]


portfolio before change:  [2.01173467]
curr_Stock_Price:  98.62497146786079
curr_Factors:  [9.86249715e+01 3.89784677e-02]
mat_Sqrt:  [[ 1.94714939e+01  0.00000000e+00]
 [-7.89718610e-03  1.80947265e-02]]
grads:  [ 1.60791562e-03 -3.30119858e+00]
Stock Position:  0.0016079156188139778
Bond Position:  [1.85315404]


portfolio before change:  [2.01347046]
curr_Stock_Price:  99.56042336373531
curr_Factors:  [9.95604234e+01 3.91223491e-02]
mat_Sqrt:  [[ 1.96924248e+01  0.00000000e+00]
 [-7.91174813e-03  1.81280924e-02]]
grads:  [-0.03760851 -4.95494984]
Stock Position:  -0.037608508870953065
Bond Position:  [5.75778952]


portfolio before change:  [2.00653035]
curr_Stock_Price:  99.76409730197837
curr_Factors:  [9.97640973e+01 3.86559333e-02]
mat_Sqrt:  [[ 1.96147311e+01  0.00000000e+00]
 [-7.86444488e-03  1.80197070e-02]]
grads:  [-0.00589147  0.32103258]
Stock Position:  -0.0058914710534990165
Bond Position:  [2.59428765]


portfolio before change:  [2.00880095]
curr_Stock_Price:  99.4337392940668
curr_Factors:  [9.94337393e+01 3.74235360e-02]
mat_Sqrt:  [[ 1.92356197e+01  0.00000000e+00]
 [-7.73806550e-03  1.77301354e-02]]
grads:  [-7.12608685e-05 -4.12715540e+00]
Stock Position:  -7.126086851188745e-05
Bond Position:  [2.01588669]


portfolio before change:  [2.00913441]
curr_Stock_Price:  98.29072740844063
curr_Factors:  [9.82907274e+01 3.85030781e-02]
mat_Sqrt:  [[ 1.92868043e+01  0.00000000e+00]
 [-7.84888049e-03  1.79840445e-02]]
grads:  [0.00669611 5.56453904]
Stock Position:  0.0066961097063296445
Bond Position:  [1.35096891]


portfolio before change:  [2.00998313]
curr_Stock_Price:  98.39225539579118
curr_Factors:  [9.83922554e+01 3.93984939e-02]
mat_Sqrt:  [[ 1.95299318e+01  0.00000000e+00]
 [-7.93962154e-03  1.81919583e-02]]
grads:  [-4.96529333e-03  5.37551106e+00]
Stock Position:  -0.004965293334642807
Bond Position:  [2.49852954]


portfolio before change:  [2.01420749]
curr_Stock_Price:  97.60438274462766
curr_Factors:  [9.76043827e+01 3.99231271e-02]
mat_Sqrt:  [[ 1.95021097e+01  0.00000000e+00]
 [-7.99230901e-03  1.83126805e-02]]
grads:  [ -0.04789907 -13.56477674]
Stock Position:  -0.04789906532223138
Bond Position:  [6.68936619]


portfolio before change:  [1.95747241]
curr_Stock_Price:  98.80631219727844
curr_Factors:  [9.88063122e+01 3.89940863e-02]
mat_Sqrt:  [[ 1.95112038e+01  0.00000000e+00]
 [-7.89876814e-03  1.80983514e-02]]
grads:  [5.13743723e-03 1.70578830e+01]
Stock Position:  0.005137437231091034
Bond Position:  [1.44986119]


portfolio before change:  [1.95990956]
curr_Stock_Price:  99.24542296626309
curr_Factors:  [9.92454230e+01 4.03002689e-02]
mat_Sqrt:  [[ 1.99234461e+01  0.00000000e+00]
 [-8.02997075e-03  1.83989744e-02]]
grads:  [-3.80668142e-03  6.29353546e+00]
Stock Position:  -0.0038066814158909815
Bond Position:  [2.33770527]


portfolio before change:  [1.9570998]
curr_Stock_Price:  100.06030291605826
curr_Factors:  [1.00060303e+02 4.06670357e-02]
mat_Sqrt:  [[ 2.01782302e+01  0.00000000e+00]
 [-8.06642778e-03  1.84825079e-02]]
grads:  [0.01946825 3.17224088]
Stock Position:  0.019468253070217805
Bond Position:  [0.0091005]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.9682404]
Stock Price:  100.63248873005588
PL:  [1.33575167]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.49093421e-01  5.68853915e-01]
 [-2.79002655e-01 -5.62015633e-02]
 [ 8.26075211e-01 -6.87611758e-01]
 [ 5.46381181e-03  2.40650362e-02]
 [ 6.35055387e-03  8.18380786e-04]
 [-8.20546391e-02 -6.32813345e-02]
 [ 1.13236519e-02  3.06508366e-01]
 [ 2.97185272e-01 -3.61554228e-03]
 [ 1.05221980e-01  8.94708509e-02]
 [ 4.96548217e-01 -3.48114053e-01]
 [ 6.09143293e-02 -1.02146048e-02]
 [-1.15281048e-01 -1.76220792e-01]
 [-1.07143947e-01  1.21474747e-01]
 [-6.71176540e-01 -8.87380794e-01]
 [-6.68965278e-03 -1.48727560e-01]
 [ 5.88773513e-02 -4.71653430e-02]
 [-5.28374726e-02  2.63173519e-01]
 [-1.43593076e-01  1.78797742e-02]
 [ 1.49827539e-02  6.37820103e-02]
 [-8.20953603e-02 -3.87210990e-02]
 [ 1.63267695e-01  7.01674940e-02]
 [ 4.20514613e-02  2.00999933e-01]
 [ 3.70192143e-02  3.40399138e-01]
 [-6.00039565e-02  1.23494497e-01]
 [ 1.54331962e-02  3.75452171e-02]
 [ 5.55655833e-01 -1.45126418e-01]
 [ 1.02213149e-02  8.01536728e-02]
 [-2.02387790e-01  1.44666236e-01]
 [-7.56762765e-02 -9.89224402e-02]
 [ 5.08394851e-03 -4.75139498e-02]
 [-6.57681728e-01 -8.61951363e-02]
 [-1.18078928e-01  5.57391458e-03]
 [ 6.32128989e-02 -2.10325245e-02]
 [ 1.07867637e-01  8.85825339e-02]
 [-2.43361659e-01 -6.62962880e-02]
 [-1.88592888e-01 -4.03081769e-01]
 [-1.63148029e-01  2.13656909e-01]
 [-1.22089592e-01  1.18688400e-01]
 [ 1.91846850e-01  8.11939318e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.62833023]
curr_Stock_Price:  100.74111220692852
curr_Factors:  [1.00741112e+02 3.98843083e-02]
mat_Sqrt:  [[ 2.01190641e+01  0.00000000e+00]
 [-7.98842245e-03  1.83037753e-02]]
grads:  [2.47209126e-02 3.10785019e+01]
Stock Position:  0.024720912591335444
Bond Position:  [5.137918]


portfolio before change:  [7.67257789]
curr_Stock_Price:  102.5050186673689
curr_Factors:  [1.02505019e+02 3.92828143e-02]
mat_Sqrt:  [[ 2.03163846e+01  0.00000000e+00]
 [-7.92795704e-03  1.81652316e-02]]
grads:  [-0.01494021 -3.09390843]
Stock Position:  -0.014940208801029578
Bond Position:  [9.20402427]


portfolio before change:  [7.68110016]
curr_Stock_Price:  102.01160553067226
curr_Factors:  [1.02011606e+02 3.99451176e-02]
mat_Sqrt:  [[ 2.03883197e+01  0.00000000e+00]
 [-7.99450987e-03  1.83177233e-02]]
grads:  [ 2.57979493e-02 -3.75380579e+01]
Stock Position:  0.025797949256805605
Bond Position:  [5.04940993]


portfolio before change:  [7.64610165]
curr_Stock_Price:  100.63049870867675
curr_Factors:  [1.00630499e+02 3.91052463e-02]
mat_Sqrt:  [[ 1.98997279e+01  0.00000000e+00]
 [-7.91001859e-03  1.81241295e-02]]
grads:  [8.02355427e-04 1.32778991e+00]
Stock Position:  0.000802355426700665
Bond Position:  [7.56536022]


portfolio before change:  [7.6463471]
curr_Stock_Price:  99.75771799009978
curr_Factors:  [9.97577180e+01 3.88870683e-02]
mat_Sqrt:  [[ 1.96720268e+01  0.00000000e+00]
 [-7.88792174e-03  1.80734992e-02]]
grads:  [0.00034098 0.0452807 ]
Stock Position:  0.00034097780519494345
Bond Position:  [7.61233193]


portfolio before change:  [7.64755413]
curr_Stock_Price:  100.50683802171983
curr_Factors:  [1.00506838e+02 3.91235265e-02]
mat_Sqrt:  [[ 1.98799188e+01  0.00000000e+00]
 [-7.91186718e-03  1.81283651e-02]]
grads:  [-0.00551677 -3.49073587]
Stock Position:  -0.005516766872780433
Bond Position:  [8.20202693]


portfolio before change:  [7.64353182]
curr_Stock_Price:  101.4217991871277
curr_Factors:  [1.01421799e+02 3.85306620e-02]
mat_Sqrt:  [[ 1.99083169e+01  0.00000000e+00]
 [-7.85169148e-03  1.79904853e-02]]
grads:  [7.28815351e-03 1.70372484e+01]
Stock Position:  0.0072881535123397925
Bond Position:  [6.90435418]


portfolio before change:  [7.65094743]
curr_Stock_Price:  102.32086266327615
curr_Factors:  [1.02320863e+02 3.76397812e-02]
mat_Sqrt:  [[ 1.98512445e+01  0.00000000e+00]
 [-7.76038981e-03  1.77812869e-02]]
grads:  [ 0.01489112 -0.20333412]
Stock Position:  0.01489112280697667
Bond Position:  [6.1272749]


portfolio before change:  [7.64852207]
curr_Stock_Price:  102.10655223343237
curr_Factors:  [1.02106552e+02 3.76091360e-02]
mat_Sqrt:  [[ 1.98016003e+01  0.00000000e+00]
 [-7.75723002e-03  1.77740469e-02]]
grads:  [0.00728579 5.03379177]
Stock Position:  0.007285787922531737
Bond Position:  [6.90459538]


portfolio before change:  [7.66191366]
curr_Stock_Price:  103.82612846362069
curr_Factors:  [1.03826128e+02 3.67500500e-02]
mat_Sqrt:  [[ 1.99037830e+01  0.00000000e+00]
 [-7.66812102e-03  1.75698725e-02]]
grads:  [ 1.73142357e-02 -1.98131234e+01]
Stock Position:  0.01731423567848034
Bond Position:  [5.8642436]


portfolio before change:  [7.65913188]
curr_Stock_Price:  103.62312472287273
curr_Factors:  [1.03623125e+02 3.61572781e-02]
mat_Sqrt:  [[ 1.97040068e+01  0.00000000e+00]
 [-7.60602688e-03  1.74275970e-02]]
grads:  [ 0.00286522 -0.58611665]
Stock Position:  0.002865219793080193
Bond Position:  [7.36222886]


portfolio before change:  [7.66020448]
curr_Stock_Price:  103.67626657523131
curr_Factors:  [1.03676267e+02 3.57254883e-02]
mat_Sqrt:  [[ 1.95960454e+01  0.00000000e+00]
 [-7.56047494e-03  1.73232243e-02]]
grads:  [-9.80759655e-03 -1.01725169e+01]
Stock Position:  -0.00980759654946348
Bond Position:  [8.67701948]


portfolio before change:  [7.65525943]
curr_Stock_Price:  104.29107030778765
curr_Factors:  [1.04291070e+02 3.63509309e-02]
mat_Sqrt:  [[ 1.98840521e+01  0.00000000e+00]
 [-7.62636804e-03  1.74742044e-02]]
grads:  [-2.72218259e-03  6.95166109e+00]
Stock Position:  -0.0027221825939485324
Bond Position:  [7.93915877]


portfolio before change:  [7.65784522]
curr_Stock_Price:  103.70575696150709
curr_Factors:  [1.03705757e+02 3.73526853e-02]
mat_Sqrt:  [[ 2.00430486e+01  0.00000000e+00]
 [-7.73073713e-03  1.77133440e-02]]
grads:  [ -0.05280939 -50.0967402 ]
Stock Position:  -0.0528093948191226
Bond Position:  [13.13448348]


portfolio before change:  [7.65020969]
curr_Stock_Price:  103.88143476661021
curr_Factors:  [1.03881435e+02 3.64879959e-02]
mat_Sqrt:  [[ 1.98432564e+01  0.00000000e+00]
 [-7.64073252e-03  1.75071176e-02]]
grads:  [-3.60826267e-03 -8.49526253e+00]
Stock Position:  -0.003608262673759558
Bond Position:  [8.0250412]


portfolio before change:  [7.65468288]
curr_Stock_Price:  102.91975481651012
curr_Factors:  [1.02919755e+02 3.74415159e-02]
mat_Sqrt:  [[ 1.99147773e+01  0.00000000e+00]
 [-7.73992413e-03  1.77343941e-02]]
grads:  [ 1.92282883e-03 -2.65954071e+00]
Stock Position:  0.0019228288281881157
Bond Position:  [7.45678581]


portfolio before change:  [7.65388846]
curr_Stock_Price:  102.02182091742866
curr_Factors:  [1.02021821e+02 3.80290561e-02]
mat_Sqrt:  [[ 1.98953161e+01  0.00000000e+00]
 [-7.80041600e-03  1.78729984e-02]]
grads:  [3.11736025e-03 1.47246429e+01]
Stock Position:  0.003117360250240982
Bond Position:  [7.33584969]


portfolio before change:  [7.65171436]
curr_Stock_Price:  101.03023249621094
curr_Factors:  [1.01030232e+02 3.86341554e-02]
mat_Sqrt:  [[ 1.98580712e+01  0.00000000e+00]
 [-7.86222924e-03  1.80146303e-02]]
grads:  [-0.00683801  0.99251408]
Stock Position:  -0.006838010659379331
Bond Position:  [8.34256017]


portfolio before change:  [7.65068769]
curr_Stock_Price:  101.33288788809074
curr_Factors:  [1.01332888e+02 3.88312397e-02]
mat_Sqrt:  [[ 1.99682979e+01  0.00000000e+00]
 [-7.88225751e-03  1.80605208e-02]]
grads:  [2.14437432e-03 3.53157092e+00]
Stock Position:  0.0021443743245094225
Bond Position:  [7.43339204]


portfolio before change:  [7.65310773]
curr_Stock_Price:  102.02810748106847
curr_Factors:  [1.02028107e+02 3.71433609e-02]
mat_Sqrt:  [[ 1.96634822e+01  0.00000000e+00]
 [-7.70904517e-03  1.76636415e-02]]
grads:  [-0.00503444 -2.19213569]
Stock Position:  -0.00503444060910246
Bond Position:  [8.16676218]


portfolio before change:  [7.65895]
curr_Stock_Price:  101.0704314548933
curr_Factors:  [1.01070431e+02 3.88509203e-02]
mat_Sqrt:  [[ 1.99216256e+01  0.00000000e+00]
 [-7.88425472e-03  1.80650970e-02]]
grads:  [0.0097327  3.88414709]
Stock Position:  0.009732704732835985
Bond Position:  [6.67526134]


portfolio before change:  [7.66046393]
curr_Stock_Price:  101.14024456322264
curr_Factors:  [1.01140245e+02 3.78875402e-02]
mat_Sqrt:  [[ 1.96866674e+01  0.00000000e+00]
 [-7.78588880e-03  1.78397124e-02]]
grads:  [6.59202603e-03 1.12669940e+01]
Stock Position:  0.006592026027490409
Bond Position:  [6.99374481]


portfolio before change:  [7.65189536]
curr_Stock_Price:  99.70777944343003
curr_Factors:  [9.97077794e+01 3.86884845e-02]
mat_Sqrt:  [[ 1.96119105e+01  0.00000000e+00]
 [-7.86775541e-03  1.80272924e-02]]
grads:  [9.46269756e-03 1.88824329e+01]
Stock Position:  0.00946269756268585
Bond Position:  [6.7083908]


portfolio before change:  [7.64231905]
curr_Stock_Price:  98.607151374606
curr_Factors:  [9.86071514e+01 3.79299597e-02]
mat_Sqrt:  [[ 1.92043496e+01  0.00000000e+00]
 [-7.79024617e-03  1.78496964e-02]]
grads:  [-3.17976889e-04  6.91857690e+00]
Stock Position:  -0.0003179768892089286
Bond Position:  [7.67367384]


portfolio before change:  [7.64311477]
curr_Stock_Price:  99.12149971272663
curr_Factors:  [9.91214997e+01 3.61187274e-02]
mat_Sqrt:  [[ 1.88379693e+01  0.00000000e+00]
 [-7.60197105e-03  1.74183039e-02]]
grads:  [1.68910310e-03 2.15550362e+00]
Stock Position:  0.0016891031008877612
Bond Position:  [7.47568833]


portfolio before change:  [7.64503303]
curr_Stock_Price:  99.70390795700169
curr_Factors:  [9.9703908e+01 3.3419454e-02]
mat_Sqrt:  [[ 1.82268599e+01  0.00000000e+00]
 [-7.31239539e-03  1.67548027e-02]]
grads:  [ 0.02701055 -8.66178017]
Stock Position:  0.027010547832447555
Bond Position:  [4.95197586]


portfolio before change:  [7.64618358]
curr_Stock_Price:  99.72358575827805
curr_Factors:  [9.97235858e+01 3.33996667e-02]
mat_Sqrt:  [[ 1.82250594e+01  0.00000000e+00]
 [-7.31023027e-03  1.67498418e-02]]
grads:  [2.48027975e-03 4.78533910e+00]
Stock Position:  0.00248027974607983
Bond Position:  [7.39884119]


portfolio before change:  [7.64463554]
curr_Stock_Price:  98.72654162199993
curr_Factors:  [9.87265416e+01 3.34588027e-02]
mat_Sqrt:  [[ 1.80588097e+01  0.00000000e+00]
 [-7.31669900e-03  1.67646635e-02]]
grads:  [-7.71093282e-03  8.62923590e+00]
Stock Position:  -0.00771093282306091
Bond Position:  [8.40590927]


portfolio before change:  [7.64909411]
curr_Stock_Price:  98.28460242106213
curr_Factors:  [9.82846024e+01 3.31322853e-02]
mat_Sqrt:  [[ 1.78900346e+01  0.00000000e+00]
 [-7.28091041e-03  1.66826616e-02]]
grads:  [-0.00664334 -5.92965576]
Stock Position:  -0.006643339230126144
Bond Position:  [8.30203207]


portfolio before change:  [7.63842877]
curr_Stock_Price:  100.04623977891433
curr_Factors:  [1.00046240e+02 3.15570216e-02]
mat_Sqrt:  [[ 1.77725103e+01  0.00000000e+00]
 [-7.10571844e-03  1.62812463e-02]]
grads:  [-8.80733166e-04 -2.91832387e+00]
Stock Position:  -0.0008807331656234591
Bond Position:  [7.72654282]


portfolio before change:  [7.63941684]
curr_Stock_Price:  100.02104240568418
curr_Factors:  [1.00021042e+02 3.24205729e-02]
mat_Sqrt:  [[ 1.80095026e+01  0.00000000e+00]
 [-7.20228551e-03  1.65025093e-02]]
grads:  [-0.03860742 -5.22315334]
Stock Position:  -0.038607416599999556
Bond Position:  [11.5009709]


portfolio before change:  [7.64747361]
curr_Stock_Price:  99.8495972854809
curr_Factors:  [9.98495973e+01 3.32470045e-02]
mat_Sqrt:  [[ 1.82063371e+01  0.00000000e+00]
 [-7.29350445e-03  1.67115181e-02]]
grads:  [-0.00635198  0.3335373 ]
Stock Position:  -0.006351979099162648
Bond Position:  [8.28171616]


portfolio before change:  [7.64758066]
curr_Stock_Price:  99.99572938892813
curr_Factors:  [9.99957294e+01 3.17519191e-02]
mat_Sqrt:  [[ 1.78183072e+01  0.00000000e+00]
 [-7.12762727e-03  1.63314457e-02]]
grads:  [ 0.00303247 -1.28785442]
Stock Position:  0.0030324739655980103
Bond Position:  [7.34434621]


portfolio before change:  [7.64859716]
curr_Stock_Price:  100.02817626244764
curr_Factors:  [1.00028176e+02 3.18431354e-02]
mat_Sqrt:  [[ 1.78496729e+01  0.00000000e+00]
 [-7.13785799e-03  1.63548873e-02]]
grads:  [0.00820901 5.41627297]
Stock Position:  0.008209014548750114
Bond Position:  [6.8274644]


portfolio before change:  [7.64925006]
curr_Stock_Price:  100.00374227309122
curr_Factors:  [1.00003742e+02 3.14834215e-02]
mat_Sqrt:  [[ 1.77442323e+01  0.00000000e+00]
 [-7.09742730e-03  1.62622489e-02]]
grads:  [-0.01534559 -4.07669863]
Stock Position:  -0.015345591014277044
Bond Position:  [9.18386659]


portfolio before change:  [7.6332333]
curr_Stock_Price:  101.12229299834969
curr_Factors:  [1.01122293e+02 3.07593494e-02]
mat_Sqrt:  [[ 1.77351751e+01  0.00000000e+00]
 [-7.01533741e-03  1.60741574e-02]]
grads:  [-2.05530643e-02 -2.50763856e+01]
Stock Position:  -0.020553064275298048
Bond Position:  [9.71160628]


portfolio before change:  [7.58362567]
curr_Stock_Price:  103.59499718004155
curr_Factors:  [1.03594997e+02 3.02183620e-02]
mat_Sqrt:  [[ 1.80083633e+01  0.00000000e+00]
 [-6.95337179e-03  1.59321763e-02]]
grads:  [-3.88155816e-03  1.34104033e+01]
Stock Position:  -0.0038815581647616776
Bond Position:  [7.98573568]


portfolio before change:  [7.58951606]
curr_Stock_Price:  102.33465232060537
curr_Factors:  [1.02334652e+02 2.99958675e-02]
mat_Sqrt:  [[ 1.77236609e+01  0.00000000e+00]
 [-6.92772603e-03  1.58734145e-02]]
grads:  [-3.96586959e-03  7.47718142e+00]
Stock Position:  -0.003965869585675347
Bond Position:  [7.99536194]


portfolio before change:  [7.59492828]
curr_Stock_Price:  101.22197280229331
curr_Factors:  [1.01221973e+02 2.94242113e-02]
mat_Sqrt:  [[ 1.73630979e+01  0.00000000e+00]
 [-6.86139477e-03  1.57214304e-02]]
grads:  [0.01308999 5.16453844]
Stock Position:  0.013089990558414708
Bond Position:  [6.26993361]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.58963002]
Stock Price:  100.75733912515281
PL:  [6.8322909]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.69714072e-01 -6.18844369e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.56500784e-01 -6.40284294e-01]
 [ 8.08314022e-03  2.39068356e-02]
 [-1.48190176e-01  6.26671048e-02]
 [ 6.88953594e-02  8.56915054e-02]
 [ 1.52642578e-01 -1.76236301e-01]
 [ 3.66986286e-01 -9.41838828e-03]
 [ 1.03291348e-01  9.00848537e-02]
 [ 4.34337695e-01 -2.68440658e-01]
 [ 6.31447490e-02 -2.51334147e-03]
 [-1.52469302e-01 -1.40579015e-01]
 [-1.86324289e-01  1.64628198e-01]
 [-4.44806694e-01 -5.77943059e-01]
 [ 6.99105073e-02  2.02275867e-01]
 [ 5.54020614e-02 -2.12975989e-02]
 [-5.31111108e-02  2.78555611e-01]
 [-6.02992305e-02  1.11024710e-01]
 [ 1.48312234e-02  6.75445372e-02]
 [-9.35737727e-02 -3.85279553e-02]
 [ 1.76002746e-01  8.33034007e-02]
 [ 4.26864516e-02  2.03710284e-01]
 [ 3.72558458e-02  3.54037743e-01]
 [-1.53099950e-02  1.49524607e-01]
 [ 2.53165652e-02  5.82259572e-02]
 [ 6.79236319e-01 -2.36901760e-01]
 [-4.06851442e-02  8.46808283e-02]
 [ 7.24826340e-02  2.34379259e-02]
 [ 6.28167624e-02 -1.62679338e-01]
 [ 1.02397042e-02 -4.87179435e-02]
 [-7.09383089e-01 -9.01481006e-02]
 [-1.18136005e-01  7.78965136e-03]
 [ 1.71336626e-02 -8.71643794e-02]
 [ 9.38922743e-02  9.57525121e-02]
 [-1.74777555e-01  5.84052253e-02]
 [-8.65883678e-01 -2.40548570e-01]
 [-1.69852232e-02  3.11119750e-01]
 [-1.35080741e-01  1.09924305e-01]
 [ 5.03944827e-01  4.35388715e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.39104548]
curr_Stock_Price:  98.93079968696857
curr_Factors:  [9.89307997e+01 4.15706852e-02]
mat_Sqrt:  [[ 2.01708923e+01  0.00000000e+00]
 [-8.15555616e-03  1.86867267e-02]]
grads:  [-0.01471044 -3.31167881]
Stock Position:  -0.014710437670769497
Bond Position:  [-2.93573012]


portfolio before change:  [-4.40387697]
curr_Stock_Price:  99.7781231256819
curr_Factors:  [9.97781231e+01 4.33242894e-02]
mat_Sqrt:  [[ 2.07683051e+01  0.00000000e+00]
 [-8.32579504e-03  1.90767930e-02]]
grads:  [-0.00977376 -4.6135307 ]
Stock Position:  -0.009773760899092062
Bond Position:  [-3.42866945]


portfolio before change:  [-4.41532233]
curr_Stock_Price:  100.9052991630287
curr_Factors:  [1.00905299e+02 4.27285344e-02]
mat_Sqrt:  [[ 2.08580149e+01  0.00000000e+00]
 [-8.26835262e-03  1.89451759e-02]]
grads:  [ 2.28716784e-02 -3.37966931e+01]
Stock Position:  0.02287167839933298
Bond Position:  [-6.72319588]


portfolio before change:  [-4.42122859]
curr_Stock_Price:  100.68381057135008
curr_Factors:  [1.00683811e+02 4.07126970e-02]
mat_Sqrt:  [[ 2.03153627e+01  0.00000000e+00]
 [-8.07095504e-03  1.84928812e-02]]
grads:  [9.11474678e-04 1.29275884e+00]
Stock Position:  0.0009114746777954896
Bond Position:  [-4.51299934]


portfolio before change:  [-4.42017918]
curr_Stock_Price:  102.45410119301435
curr_Factors:  [1.02454101e+02 4.05170027e-02]
mat_Sqrt:  [[ 2.06228177e+01  0.00000000e+00]
 [-8.05153429e-03  1.84483827e-02]]
grads:  [-0.00585953  3.39688882]
Stock Position:  -0.005859529521416289
Bond Position:  [-3.81984635]


portfolio before change:  [-4.42060166]
curr_Stock_Price:  102.44470978361319
curr_Factors:  [1.02444710e+02 4.22193661e-02]
mat_Sqrt:  [[ 2.10496748e+01  0.00000000e+00]
 [-8.21894067e-03  1.88319589e-02]]
grads:  [0.00504968 4.55032352]
Stock Position:  0.005049683637178317
Bond Position:  [-4.93791503]


portfolio before change:  [-4.41076292]
curr_Stock_Price:  104.51533788411072
curr_Factors:  [1.04515338e+02 4.16781534e-02]
mat_Sqrt:  [[ 2.13370445e+01  0.00000000e+00]
 [-8.16609120e-03  1.87108655e-02]]
grads:  [ 3.54907403e-03 -9.41892830e+00]
Stock Position:  0.0035490740302254755
Bond Position:  [-4.78169559]


portfolio before change:  [-4.41623052]
curr_Stock_Price:  103.14319219879758
curr_Factors:  [1.03143192e+02 4.25203410e-02]
mat_Sqrt:  [[ 2.12686017e+01  0.00000000e+00]
 [-8.24818438e-03  1.88989646e-02]]
grads:  [ 0.01706157 -0.49835472]
Stock Position:  0.017061571342683608
Bond Position:  [-6.17601545]


portfolio before change:  [-4.43313373]
curr_Stock_Price:  102.19772472209199
curr_Factors:  [1.02197725e+02 4.28002789e-02]
mat_Sqrt:  [[ 2.11428986e+01  0.00000000e+00]
 [-8.27529131e-03  1.89610744e-02]]
grads:  [0.00674494 4.75104162]
Stock Position:  0.006744940881765821
Bond Position:  [-5.12245134]


portfolio before change:  [-4.42889213]
curr_Stock_Price:  102.92151877552237
curr_Factors:  [1.02921519e+02 4.17873565e-02]
mat_Sqrt:  [[ 2.10391716e+01  0.00000000e+00]
 [-8.17678240e-03  1.87353622e-02]]
grads:  [  0.01507572 -14.32802076]
Stock Position:  0.015075716518099936
Bond Position:  [-5.98050777]


portfolio before change:  [-4.43687631]
curr_Stock_Price:  102.44150323914687
curr_Factors:  [1.02441503e+02 4.19938717e-02]
mat_Sqrt:  [[ 2.09927291e+01  0.00000000e+00]
 [-8.19696253e-03  1.87816006e-02]]
grads:  [ 0.00295568 -0.13381934]
Stock Position:  0.002955682251627979
Bond Position:  [-4.73966085]


portfolio before change:  [-4.44065998]
curr_Stock_Price:  101.36183151838308
curr_Factors:  [1.01361832e+02 4.40653569e-02]
mat_Sqrt:  [[ 2.12776223e+01  0.00000000e+00]
 [-8.39670001e-03  1.92392567e-02]]
grads:  [-0.0100492  -7.30688388]
Stock Position:  -0.01004919682049504
Bond Position:  [-3.42205498]


portfolio before change:  [-4.4476199]
curr_Stock_Price:  102.01184768036052
curr_Factors:  [1.02011848e+02 4.55995519e-02]
mat_Sqrt:  [[ 2.17836626e+01  0.00000000e+00]
 [-8.54162063e-03  1.95713116e-02]]
grads:  [-5.25506914e-03  8.41171002e+00]
Stock Position:  -0.005255069141876189
Bond Position:  [-3.91154059]


portfolio before change:  [-4.44242811]
curr_Stock_Price:  100.93084219368706
curr_Factors:  [1.00930842e+02 4.49271660e-02]
mat_Sqrt:  [[ 2.13933309e+01  0.00000000e+00]
 [-8.47841174e-03  1.94264818e-02]]
grads:  [ -0.0325822  -29.75026899]
Stock Position:  -0.032582197050041437
Bond Position:  [-1.15387953]


portfolio before change:  [-4.45898519]
curr_Stock_Price:  101.43457850622929
curr_Factors:  [1.01434579e+02 4.40264136e-02]
mat_Sqrt:  [[ 2.12834822e+01  0.00000000e+00]
 [-8.39298885e-03  1.92307533e-02]]
grads:  [7.43256823e-03 1.05183538e+01]
Stock Position:  0.007432568233475993
Bond Position:  [-5.21290462]


portfolio before change:  [-4.45575146]
curr_Stock_Price:  101.95733090316297
curr_Factors:  [1.01957331e+02 4.30323217e-02]
mat_Sqrt:  [[ 2.11502666e+01  0.00000000e+00]
 [-8.29769334e-03  1.90124039e-02]]
grads:  [ 0.00217997 -1.12019495]
Stock Position:  0.002179973805878458
Bond Position:  [-4.67801577]


portfolio before change:  [-4.45453445]
curr_Stock_Price:  102.78385212388869
curr_Factors:  [1.02783852e+02 4.30365347e-02]
mat_Sqrt:  [[ 2.13227658e+01  0.00000000e+00]
 [-8.29809951e-03  1.90133346e-02]]
grads:  [3.21067750e-03 1.46505396e+01]
Stock Position:  0.0032106775005706864
Bond Position:  [-4.78454025]


portfolio before change:  [-4.45554781]
curr_Stock_Price:  102.65451540841468
curr_Factors:  [1.02654515e+02 4.04579715e-02]
mat_Sqrt:  [[ 2.06481007e+01  0.00000000e+00]
 [-8.04566680e-03  1.84349386e-02]]
grads:  [-5.73615696e-04  6.02251585e+00]
Stock Position:  -0.0005736156961893301
Bond Position:  [-4.39666357]


portfolio before change:  [-4.45612975]
curr_Stock_Price:  102.71085560802602
curr_Factors:  [1.02710856e+02 4.07723869e-02]
mat_Sqrt:  [[ 2.07395541e+01  0.00000000e+00]
 [-8.07686938e-03  1.85064327e-02]]
grads:  [2.13650091e-03 3.64978699e+00]
Stock Position:  0.002136500905962069
Bond Position:  [-4.67557158]


portfolio before change:  [-4.45669959]
curr_Stock_Price:  102.71771009384943
curr_Factors:  [1.02717710e+02 4.02938329e-02]
mat_Sqrt:  [[ 2.06188586e+01  0.00000000e+00]
 [-8.02932953e-03  1.83975052e-02]]
grads:  [-0.00535378 -2.09419456]
Stock Position:  -0.005353776039786491
Bond Position:  [-3.90677197]


portfolio before change:  [-4.44974412]
curr_Stock_Price:  101.32731916021721
curr_Factors:  [1.01327319e+02 3.97732971e-02]
mat_Sqrt:  [[ 2.02079542e+01  0.00000000e+00]
 [-7.97729749e-03  1.82782848e-02]]
grads:  [0.0105087  4.55750644]
Stock Position:  0.010508700129727022
Bond Position:  [-5.51456253]


portfolio before change:  [-4.45262451]
curr_Stock_Price:  101.11882236518176
curr_Factors:  [1.01118822e+02 3.95341685e-02]
mat_Sqrt:  [[ 2.01056588e+01  0.00000000e+00]
 [-7.95328043e-03  1.82232548e-02]]
grads:  [6.54506823e-03 1.11785895e+01]
Stock Position:  0.006545068227314282
Bond Position:  [-5.11445411]


portfolio before change:  [-4.46090651]
curr_Stock_Price:  99.9511260864814
curr_Factors:  [9.99511261e+01 3.72922111e-02]
mat_Sqrt:  [[ 1.93017532e+01  0.00000000e+00]
 [-7.72447653e-03  1.76989992e-02]]
grads:  [9.93539719e-03 2.00032634e+01]
Stock Position:  0.009935397192803072
Bond Position:  [-5.45396065]


portfolio before change:  [-4.45874201]
curr_Stock_Price:  100.23760574777975
curr_Factors:  [1.00237606e+02 3.73327184e-02]
mat_Sqrt:  [[ 1.93675859e+01  0.00000000e+00]
 [-7.72867061e-03  1.77086091e-02]]
grads:  [2.57894266e-03 8.44361104e+00]
Stock Position:  0.002578942657889323
Bond Position:  [-4.71724905]


portfolio before change:  [-4.45769694]
curr_Stock_Price:  100.87149509756665
curr_Factors:  [1.00871495e+02 3.63116422e-02]
mat_Sqrt:  [[ 1.92216827e+01  0.00000000e+00]
 [-7.62224557e-03  1.74647586e-02]]
grads:  [2.63912672e-03 3.33391136e+00]
Stock Position:  0.0026391267166185326
Bond Position:  [-4.7239096]


portfolio before change:  [-4.45789463]
curr_Stock_Price:  101.02034651442713
curr_Factors:  [1.01020347e+02 3.67468568e-02]
mat_Sqrt:  [[ 1.93650647e+01  0.00000000e+00]
 [-7.66778788e-03  1.75691092e-02]]
grads:  [  0.02973622 -13.48399386]
Stock Position:  0.029736224663505992
Bond Position:  [-7.46185835]


portfolio before change:  [-4.46013915]
curr_Stock_Price:  100.97623427430213
curr_Factors:  [1.00976234e+02 3.66225468e-02]
mat_Sqrt:  [[ 1.93238404e+01  0.00000000e+00]
 [-7.65480731e-03  1.75393670e-02]]
grads:  [-1.92891304e-04  4.82804360e+00]
Stock Position:  -0.0001928913039067403
Bond Position:  [-4.44066171]


portfolio before change:  [-4.46093989]
curr_Stock_Price:  102.24962353328354
curr_Factors:  [1.02249624e+02 3.60337827e-02]
mat_Sqrt:  [[ 1.94096027e+01  0.00000000e+00]
 [-7.59302656e-03  1.73978095e-02]]
grads:  [0.00426138 1.34717683]
Stock Position:  0.004261384681389094
Bond Position:  [-4.89666487]


portfolio before change:  [-4.46593428]
curr_Stock_Price:  101.22125632665713
curr_Factors:  [1.01221256e+02 3.75182678e-02]
mat_Sqrt:  [[ 1.96061858e+01  0.00000000e+00]
 [-7.74785316e-03  1.77525618e-02]]
grads:  [-4.17333666e-04 -9.16371056e+00]
Stock Position:  -0.0004173336663430003
Bond Position:  [-4.42369125]


portfolio before change:  [-4.46593471]
curr_Stock_Price:  99.8972210012985
curr_Factors:  [9.98972210e+01 3.66022994e-02]
mat_Sqrt:  [[ 1.91120640e+01  0.00000000e+00]
 [-7.65269096e-03  1.75345178e-02]]
grads:  [-5.76732558e-04 -2.77840224e+00]
Stock Position:  -0.0005767325575046678
Bond Position:  [-4.40832073]


portfolio before change:  [-4.46625388]
curr_Stock_Price:  99.49511639920469
curr_Factors:  [9.94951164e+01 3.52261566e-02]
mat_Sqrt:  [[ 1.86738728e+01  0.00000000e+00]
 [-7.50745301e-03  1.72017358e-02]]
grads:  [-0.04009489 -5.24063975]
Stock Position:  -0.04009489383170533
Bond Position:  [-0.47700775]


portfolio before change:  [-4.445887]
curr_Stock_Price:  98.98566215782968
curr_Factors:  [9.89856622e+01 3.54421310e-02]
mat_Sqrt:  [[ 1.86351205e+01  0.00000000e+00]
 [-7.53043223e-03  1.72543878e-02]]
grads:  [-0.00615699  0.45145916]
Stock Position:  -0.006156993866918684
Bond Position:  [-3.83643288]


portfolio before change:  [-4.44754568]
curr_Stock_Price:  99.17716691186489
curr_Factors:  [9.91771669e+01 3.54440936e-02]
mat_Sqrt:  [[ 1.86716903e+01  0.00000000e+00]
 [-7.53064073e-03  1.72548656e-02]]
grads:  [-1.11976961e-03 -5.05158263e+00]
Stock Position:  -0.0011197696091875473
Bond Position:  [-4.3364901]


portfolio before change:  [-4.44799723]
curr_Stock_Price:  99.09630814370081
curr_Factors:  [9.90963081e+01 3.63846618e-02]
mat_Sqrt:  [[ 1.89023868e+01  0.00000000e+00]
 [-7.62990557e-03  1.74823099e-02]]
grads:  [0.00717804 5.47710872]
Stock Position:  0.007178040419164263
Bond Position:  [-5.15931453]


portfolio before change:  [-4.44953938]
curr_Stock_Price:  98.97131613258425
curr_Factors:  [9.89713161e+01 3.66193277e-02]
mat_Sqrt:  [[ 1.89393264e+01  0.00000000e+00]
 [-7.65447087e-03  1.75385961e-02]]
grads:  [-0.0078824   3.33009694]
Stock Position:  -0.007882404142631201
Bond Position:  [-3.66940747]


portfolio before change:  [-4.43777324]
curr_Stock_Price:  97.42041364871938
curr_Factors:  [9.74204136e+01 3.76238167e-02]
mat_Sqrt:  [[ 1.88965010e+01  0.00000000e+00]
 [-7.75874388e-03  1.77775156e-02]]
grads:  [ -0.05137817 -13.53105662]
Stock Position:  -0.051378172225656805
Bond Position:  [0.56750955]


portfolio before change:  [-4.45498469]
curr_Stock_Price:  97.75678978560472
curr_Factors:  [9.77567898e+01 3.76389250e-02]
mat_Sqrt:  [[ 1.89655542e+01  0.00000000e+00]
 [-7.76030154e-03  1.77810846e-02]]
grads:  [6.26391229e-03 1.74972313e+01]
Stock Position:  0.006263912287401012
Bond Position:  [-5.06732465]


portfolio before change:  [-4.45219606]
curr_Stock_Price:  98.30310824364736
curr_Factors:  [9.83031082e+01 3.84845011e-02]
mat_Sqrt:  [[ 1.92845798e+01  0.00000000e+00]
 [-7.84698680e-03  1.79797055e-02]]
grads:  [-4.51686486e-03  6.11379895e+00]
Stock Position:  -0.004516864864584612
Bond Position:  [-4.0081742]


portfolio before change:  [-4.45624113]
curr_Stock_Price:  99.08772875335978
curr_Factors:  [9.90877288e+01 3.85179871e-02]
mat_Sqrt:  [[ 1.94469575e+01  0.00000000e+00]
 [-7.85039995e-03  1.79875260e-02]]
grads:  [0.02689093 2.42050361]
Stock Position:  0.02689092872960246
Bond Position:  [-7.12080219]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.4168604]
Stock Price:  100.58529307484382
PL:  [-5.00215347]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-4.56317547e-02  2.03423542e-01]
 [-1.68883277e-01 -8.64283952e-02]
 [ 8.91967033e-01 -8.63793252e-01]
 [ 1.63219713e-03  3.03436369e-01]
 [-1.52182457e-02 -1.91058364e-01]
 [-6.55019403e-02  1.59619328e-02]
 [-2.39226739e-01 -9.30292871e-02]
 [ 3.33859748e-01 -2.08250460e-01]
 [ 1.48698333e-01  1.87464827e-01]
 [-1.88674066e-01  4.94291908e-01]
 [ 2.26993485e-01  6.85893716e-01]
 [ 1.05060440e-01  3.33033211e-01]
 [ 4.21457707e-01  2.57269714e-02]
 [ 6.54729105e-03  1.56579445e-01]
 [ 9.91349250e-02  2.44063595e-01]
 [ 3.02068679e-02  2.64901181e-01]
 [ 1.84611282e-01  4.78096387e-01]
 [ 1.62460950e-01  6.43854225e-02]
 [ 2.41223145e-02 -4.74053002e-02]
 [ 3.35563199e-01 -1.14874992e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 2.27125761e-03  1.70673441e-01]
 [ 3.06578114e-02  1.74482168e-01]
 [-8.51249143e-02  1.06086839e-01]
 [ 5.37620138e-02  1.35897618e-01]
 [ 4.44551256e-02  1.78819268e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.66873980e-01  1.07811391e-01]
 [-3.98957170e-01  6.28483353e-02]
 [ 2.41966895e-01 -1.02271481e-01]
 [-1.48549168e+00 -1.66665726e-01]
 [ 2.02821547e-01  4.41175849e-01]
 [-1.74691463e-03 -1.30274885e-01]
 [ 9.03977582e-03  6.70733408e-02]
 [-3.49035691e-02  1.66639510e-01]
 [-1.77445564e+00 -5.52177526e-02]
 [-6.79137963e-02  2.44018507e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.16576403e+00 -3.72691360e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.61924539]
curr_Stock_Price:  99.6854305847363
curr_Factors:  [9.96854306e+01 3.89227733e-02]
mat_Sqrt:  [[ 1.96667944e+01  0.00000000e+00]
 [-7.89154214e-03  1.80817946e-02]]
grads:  [2.19403105e-03 1.12501854e+01]
Stock Position:  0.0021940310540262114
Bond Position:  [0.40053246]


portfolio before change:  [0.61440381]
curr_Stock_Price:  97.45590493386271
curr_Factors:  [9.74559049e+01 3.89072403e-02]
mat_Sqrt:  [[ 1.92230977e+01  0.00000000e+00]
 [-7.88996734e-03  1.80781863e-02]]
grads:  [-0.01074768 -4.78081119]
Stock Position:  -0.010747680981774439
Bond Position:  [1.66182878]


portfolio before change:  [0.61951733]
curr_Stock_Price:  96.99945491502707
curr_Factors:  [9.69994549e+01 3.97800474e-02]
mat_Sqrt:  [[ 1.93464792e+01  0.00000000e+00]
 [-7.97797442e-03  1.82798358e-02]]
grads:  [ 2.66186289e-02 -4.72538846e+01]
Stock Position:  0.026618628853502923
Bond Position:  [-1.96247516]


portfolio before change:  [0.58981951]
curr_Stock_Price:  95.89299323800228
curr_Factors:  [9.58929932e+01 4.03191148e-02]
mat_Sqrt:  [[ 1.92549489e+01  0.00000000e+00]
 [-8.03184809e-03  1.84032759e-02]]
grads:  [6.96250540e-03 1.64881714e+01]
Stock Position:  0.006962505401909951
Bond Position:  [-0.07783597]


portfolio before change:  [0.57789979]
curr_Stock_Price:  94.18240392531789
curr_Factors:  [9.41824039e+01 4.12096006e-02]
mat_Sqrt:  [[ 1.91191673e+01  0.00000000e+00]
 [-8.12005917e-03  1.86053929e-02]]
grads:  [-5.15728276e-03 -1.02689777e+01]
Stock Position:  -0.005157282755200221
Bond Position:  [1.06362508]


portfolio before change:  [0.58126781]
curr_Stock_Price:  93.55512543724454
curr_Factors:  [9.35551254e+01 4.02430287e-02]
mat_Sqrt:  [[ 1.87677805e+01  0.00000000e+00]
 [-8.02426607e-03  1.83859033e-02]]
grads:  [-0.00311894  0.86816147]
Stock Position:  -0.0031189400254521644
Bond Position:  [0.87306063]


portfolio before change:  [0.58570448]
curr_Stock_Price:  92.16762446723635
curr_Factors:  [9.21676245e+01 4.15815177e-02]
mat_Sqrt:  [[ 1.87944042e+01  0.00000000e+00]
 [-8.15661868e-03  1.86891613e-02]]
grads:  [-0.0148889  -4.97771333]
Stock Position:  -0.014888902310362133
Bond Position:  [1.95797924]


portfolio before change:  [0.56843586]
curr_Stock_Price:  93.34389509077721
curr_Factors:  [9.33438951e+01 4.00384114e-02]
mat_Sqrt:  [[ 1.86777405e+01  0.00000000e+00]
 [-8.00384022e-03  1.83391018e-02]]
grads:  [  0.01300863 -11.35554301]
Stock Position:  0.013008628930156068
Bond Position:  [-0.64584023]


portfolio before change:  [0.5531736]
curr_Stock_Price:  92.17685978461317
curr_Factors:  [9.21768598e+01 4.09115517e-02]
mat_Sqrt:  [[ 1.86442486e+01  0.00000000e+00]
 [-8.09064167e-03  1.85379889e-02]]
grads:  [ 0.01236385 10.11246838]
Stock Position:  0.012363849934268067
Bond Position:  [-0.58648726]


portfolio before change:  [0.55782938]
curr_Stock_Price:  92.5593533709241
curr_Factors:  [9.25593534e+01 4.10057124e-02]
mat_Sqrt:  [[ 1.87431462e+01  0.00000000e+00]
 [-8.09994690e-03  1.85593099e-02]]
grads:  [1.44333341e-03 2.66330974e+01]
Stock Position:  0.0014433334121457901
Bond Position:  [0.42423537]


portfolio before change:  [0.55791265]
curr_Stock_Price:  92.58030792776226
curr_Factors:  [9.25803079e+01 4.00296690e-02]
mat_Sqrt:  [[ 1.85229272e+01  0.00000000e+00]
 [-8.00296635e-03  1.83370995e-02]]
grads:  [2.84157055e-02 3.74047005e+01]
Stock Position:  0.02841570545689022
Bond Position:  [-2.07282211]


portfolio before change:  [0.59122704]
curr_Stock_Price:  93.76182023625655
curr_Factors:  [9.37618202e+01 4.09699696e-02]
mat_Sqrt:  [[ 1.89783674e+01  0.00000000e+00]
 [-8.09641596e-03  1.85512195e-02]]
grads:  [1.31943936e-02 1.79520926e+01]
Stock Position:  0.013194393555774302
Bond Position:  [-0.64590332]


portfolio before change:  [0.57368117]
curr_Stock_Price:  92.43814267512207
curr_Factors:  [9.24381427e+01 4.16796123e-02]
mat_Sqrt:  [[ 1.88717879e+01  0.00000000e+00]
 [-8.16623412e-03  1.87111930e-02]]
grads:  [0.02292766 1.37495089]
Stock Position:  0.02292765691706937
Bond Position:  [-1.54570885]


portfolio before change:  [0.585216]
curr_Stock_Price:  92.94966669711373
curr_Factors:  [9.29496667e+01 4.16068572e-02]
mat_Sqrt:  [[ 1.89596490e+01  0.00000000e+00]
 [-8.15910360e-03  1.86948549e-02]]
grads:  [3.94965978e-03 8.37553676e+00]
Stock Position:  0.003949659782491057
Bond Position:  [0.21809644]


portfolio before change:  [0.58609655]
curr_Stock_Price:  93.1657075018416
curr_Factors:  [9.31657075e+01 4.03436250e-02]
mat_Sqrt:  [[ 1.87130055e+01  0.00000000e+00]
 [-8.03428901e-03  1.84088688e-02]]
grads:  [1.09898440e-02 1.32579355e+01]
Stock Position:  0.010989843957902107
Bond Position:  [-0.43778004]


portfolio before change:  [0.57986551]
curr_Stock_Price:  92.60370542914477
curr_Factors:  [9.26037054e+01 4.15832277e-02]
mat_Sqrt:  [[ 1.88837161e+01  0.00000000e+00]
 [-8.15678639e-03  1.86895455e-02]]
grads:  [7.72195583e-03 1.41737626e+01]
Stock Position:  0.007721955827948699
Bond Position:  [-0.13521622]


portfolio before change:  [0.58113716]
curr_Stock_Price:  92.7705744932401
curr_Factors:  [9.27705745e+01 3.93173015e-02]
mat_Sqrt:  [[ 1.83950976e+01  0.00000000e+00]
 [-7.93143634e-03  1.81732037e-02]]
grads:  [2.13790467e-02 2.63077658e+01]
Stock Position:  0.021379046712651582
Bond Position:  [-1.40220929]


portfolio before change:  [0.56314145]
curr_Stock_Price:  91.9370285360742
curr_Factors:  [9.19370285e+01 4.05440071e-02]
mat_Sqrt:  [[ 1.85120194e+01  0.00000000e+00]
 [-8.05421699e-03  1.84545295e-02]]
grads:  [0.01029391 3.48886827]
Stock Position:  0.010293909452846663
Bond Position:  [-0.38324999]


portfolio before change:  [0.58432147]
curr_Stock_Price:  93.99921107418398
curr_Factors:  [9.39992111e+01 3.96939219e-02]
mat_Sqrt:  [[ 1.87277763e+01  0.00000000e+00]
 [-7.96933341e-03  1.82600368e-02]]
grads:  [ 1.83307682e-04 -2.59612293e+00]
Stock Position:  0.000183307681805346
Bond Position:  [0.56709069]


portfolio before change:  [0.58451156]
curr_Stock_Price:  94.64948983842162
curr_Factors:  [9.46494898e+01 3.89704091e-02]
mat_Sqrt:  [[ 1.86846841e+01  0.00000000e+00]
 [-7.89636971e-03  1.80928560e-02]]
grads:  [ 0.01527602 -6.34919065]
Stock Position:  0.015276021839346714
Bond Position:  [-0.86135612]


portfolio before change:  [0.59000012]
curr_Stock_Price:  95.01583109200512
curr_Factors:  [9.50158311e+01 3.94074284e-02]
mat_Sqrt:  [[ 1.88618818e+01  0.00000000e+00]
 [-7.94052173e-03  1.81940210e-02]]
grads:  [ 0.00223353 -2.07639585]
Stock Position:  0.0022335316839350566
Bond Position:  [0.37777925]


portfolio before change:  [0.59145405]
curr_Stock_Price:  95.64564552292467
curr_Factors:  [9.56456455e+01 3.90783312e-02]
mat_Sqrt:  [[ 1.89074607e+01  0.00000000e+00]
 [-7.90729599e-03  1.81178912e-02]]
grads:  [4.05973362e-03 9.42016038e+00]
Stock Position:  0.004059733619471972
Bond Position:  [0.20315821]


portfolio before change:  [0.59595755]
curr_Stock_Price:  96.7486993965913
curr_Factors:  [9.67486994e+01 3.88491260e-02]
mat_Sqrt:  [[ 1.90693444e+01  0.00000000e+00]
 [-7.88407266e-03  1.80646799e-02]]
grads:  [5.60103537e-03 9.65874673e+00]
Stock Position:  0.0056010353684254706
Bond Position:  [0.05406467]


portfolio before change:  [0.59938083]
curr_Stock_Price:  97.3586787634789
curr_Factors:  [9.73586788e+01 3.79927114e-02]
mat_Sqrt:  [[ 1.89768802e+01  0.00000000e+00]
 [-7.79668764e-03  1.78644556e-02]]
grads:  [-2.04590119e-03  5.93843111e+00]
Stock Position:  -0.00204590119216327
Bond Position:  [0.79856707]


portfolio before change:  [0.60327418]
curr_Stock_Price:  95.50447036679141
curr_Factors:  [9.55044704e+01 3.73313384e-02]
mat_Sqrt:  [[ 1.84527238e+01  0.00000000e+00]
 [-7.72852777e-03  1.77082818e-02]]
grads:  [6.12769140e-03 7.67424079e+00]
Stock Position:  0.006127691399772531
Bond Position:  [0.01805226]


portfolio before change:  [0.59491561]
curr_Stock_Price:  94.1400358989516
curr_Factors:  [9.41400359e+01 3.87856609e-02]
mat_Sqrt:  [[ 1.85400097e+01  0.00000000e+00]
 [-7.87763019e-03  1.80499183e-02]]
grads:  [6.60723778e-03 9.90692951e+00]
Stock Position:  0.006607237776875789
Bond Position:  [-0.02708999]


portfolio before change:  [0.59699745]
curr_Stock_Price:  94.45563341268755
curr_Factors:  [9.44556334e+01 3.84942991e-02]
mat_Sqrt:  [[ 1.85321614e+01  0.00000000e+00]
 [-7.84798564e-03  1.79819941e-02]]
grads:  [9.61364392e-03 9.72847579e+00]
Stock Position:  0.009613643916347983
Bond Position:  [-0.31106538]


portfolio before change:  [0.60441668]
curr_Stock_Price:  95.23141852138802
curr_Factors:  [9.52314185e+01 3.90715527e-02]
mat_Sqrt:  [[ 1.88239425e+01  0.00000000e+00]
 [-7.90661017e-03  1.81163198e-02]]
grads:  [-0.00636536  5.95106472]
Stock Position:  -0.006365363201017536
Bond Position:  [1.21059925]


portfolio before change:  [0.61710269]
curr_Stock_Price:  93.26221872716974
curr_Factors:  [9.32622187e+01 3.88365041e-02]
mat_Sqrt:  [[ 1.83791663e+01  0.00000000e+00]
 [-7.88279180e-03  1.80617450e-02]]
grads:  [-0.02021462  3.47963805]
Stock Position:  -0.020214622458941928
Bond Position:  [2.50236323]


portfolio before change:  [0.62320379]
curr_Stock_Price:  92.97587706176627
curr_Factors:  [9.29758771e+01 3.83570654e-02]
mat_Sqrt:  [[ 1.82092882e+01  0.00000000e+00]
 [-7.83398395e-03  1.79499122e-02]]
grads:  [ 0.01083688 -5.69760339]
Stock Position:  0.010836884953532008
Bond Position:  [-0.38436509]


portfolio before change:  [0.6106561]
curr_Stock_Price:  91.82244145345817
curr_Factors:  [9.18224415e+01 3.85694686e-02]
mat_Sqrt:  [[ 1.80331113e+01  0.00000000e+00]
 [-7.85564445e-03  1.79995427e-02]]
grads:  [-0.08640941 -9.25944223]
Stock Position:  -0.08640941333164624
Bond Position:  [8.54497939]


portfolio before change:  [0.54791401]
curr_Stock_Price:  92.56090584189914
curr_Factors:  [9.25609058e+01 4.00152907e-02]
mat_Sqrt:  [[ 1.85157191e+01  0.00000000e+00]
 [-8.00152892e-03  1.83338060e-02]]
grads:  [2.13530174e-02 2.40635169e+01]
Stock Position:  0.02135301742818279
Bond Position:  [-1.42854062]


portfolio before change:  [0.56134263]
curr_Stock_Price:  93.19815533926322
curr_Factors:  [9.31981553e+01 3.94845109e-02]
mat_Sqrt:  [[ 1.85191350e+01  0.00000000e+00]
 [-7.94828393e-03  1.82118064e-02]]
grads:  [-3.16448559e-03 -7.15332035e+00]
Stock Position:  -0.0031644855883966676
Bond Position:  [0.85626685]


portfolio before change:  [0.56031299]
curr_Stock_Price:  93.55735392531368
curr_Factors:  [9.35573539e+01 4.00026849e-02]
mat_Sqrt:  [[ 1.87120987e+01  0.00000000e+00]
 [-8.00026848e-03  1.83309180e-02]]
grads:  [2.04749783e-03 3.65902793e+00]
Stock Position:  0.002047497833189769
Bond Position:  [0.36875451]


portfolio before change:  [0.56019149]
curr_Stock_Price:  93.47549757427288
curr_Factors:  [9.34754976e+01 3.82523110e-02]
mat_Sqrt:  [[ 1.82821229e+01  0.00000000e+00]
 [-7.82327921e-03  1.79253846e-02]]
grads:  [2.06889953e-03 9.29628647e+00]
Stock Position:  0.00206889953446168
Bond Position:  [0.36680008]


portfolio before change:  [0.55992966]
curr_Stock_Price:  93.32678163795327
curr_Factors:  [9.33267816e+01 3.88956914e-02]
mat_Sqrt:  [[ 1.84058991e+01  0.00000000e+00]
 [-7.88879625e-03  1.80755030e-02]]
grads:  [-0.09771621 -3.05483906]
Stock Position:  -0.09771620695244532
Bond Position:  [9.67946877]


portfolio before change:  [0.41831699]
curr_Stock_Price:  94.78838859636068
curr_Factors:  [9.47883886e+01 3.97185769e-02]
mat_Sqrt:  [[ 1.88908709e+01  0.00000000e+00]
 [-7.97180802e-03  1.82657068e-02]]
grads:  [2.04250040e-03 1.33593794e+01]
Stock Position:  0.002042500400231633
Bond Position:  [0.22471166]


portfolio before change:  [0.4191452]
curr_Stock_Price:  95.18012579824024
curr_Factors:  [9.51801258e+01 3.89019188e-02]
mat_Sqrt:  [[ 1.87729181e+01  0.00000000e+00]
 [-7.88942774e-03  1.80769499e-02]]
grads:  [-4.69746977e-03  6.04979075e+00]
Stock Position:  -0.004697469767891655
Bond Position:  [0.86625096]


portfolio before change:  [0.42519374]
curr_Stock_Price:  93.91556107292556
curr_Factors:  [9.39155611e+01 3.88824426e-02]
mat_Sqrt:  [[ 1.85188633e+01  0.00000000e+00]
 [-7.88745257e-03  1.80724242e-02]]
grads:  [ 0.06207176 -2.06221011]
Stock Position:  0.062071760207112255
Bond Position:  [-5.40431044]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.47814159]
Stock Price:  94.77945512462014
PL:  [0.47814159]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-4.78224686e-02  2.01687556e-01]
 [-1.71296520e-01 -8.24199487e-02]
 [ 7.63067672e-01 -6.44751369e-01]
 [ 3.01202312e-03  2.42131178e-02]
 [-7.01410848e-02  3.14310889e-02]
 [ 2.98248747e-02  5.50906837e-02]
 [ 2.34283754e-02  2.80140127e-01]
 [ 2.06724349e-01 -2.76731335e-03]
 [ 1.22824968e-01  8.38725374e-02]
 [ 3.07421220e-01 -1.41618683e-01]
 [ 6.96391146e-02  1.99106093e-02]
 [-1.03473573e-01 -1.29004625e-02]
 [ 3.15670592e-02  8.93845383e-02]
 [-5.59725519e-01 -7.12897046e-01]
 [ 7.38598051e-02  2.14196097e-01]
 [ 5.43075407e-02 -2.06002220e-02]
 [-5.22805676e-02  2.31868087e-01]
 [-1.45702550e-01  1.53786459e-02]
 [ 1.50620210e-02  6.18137975e-02]
 [-7.06956929e-02 -4.70710111e-02]
 [ 2.14300790e-01  1.25829812e-01]
 [ 7.85136256e-02  2.75001890e-01]
 [ 3.65452799e-02  3.13083224e-01]
 [-4.19381630e-02  1.36013254e-01]
 [ 3.09931552e-02  7.54555287e-02]
 [ 3.59163634e-01 -4.70708698e-02]
 [-3.90402809e-02  2.24320578e-01]
 [-1.95462382e-01  1.41465245e-01]
 [-1.61045342e-02 -1.28957029e-01]
 [ 5.13115658e-02 -5.83158646e-02]
 [-8.17775229e-01 -9.90098899e-02]
 [-1.18101853e-01  6.46385569e-03]
 [ 4.70153999e-02 -5.28442234e-02]
 [ 1.49205674e-01  6.73742964e-02]
 [-2.87128320e-01 -1.78763518e-01]
 [-1.55137969e-01 -4.08270675e-01]
 [-7.57983817e-02  2.91453219e-01]
 [-1.23583917e-01  1.17680298e-01]
 [ 2.01137378e-01  8.00022566e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.56940588]
curr_Stock_Price:  99.67792394881559
curr_Factors:  [9.96779239e+01 4.21176724e-02]
mat_Sqrt:  [[ 2.04564922e+01  0.00000000e+00]
 [-8.20903623e-03  1.88092650e-02]]
grads:  [1.96520483e-03 1.07227771e+01]
Stock Position:  0.001965204832005763
Bond Position:  [0.37351834]


portfolio before change:  [0.57057211]
curr_Stock_Price:  100.24760143950965
curr_Factors:  [1.00247601e+02 4.10180557e-02]
mat_Sqrt:  [[ 2.03030613e+01  0.00000000e+00]
 [-8.10116592e-03  1.85621030e-02]]
grads:  [-0.01020868 -4.44022688]
Stock Position:  -0.010208683902845512
Bond Position:  [1.59396818]


portfolio before change:  [0.56487628]
curr_Stock_Price:  100.82505948663105
curr_Factors:  [1.00825059e+02 4.05468538e-02]
mat_Sqrt:  [[ 2.03023854e+01  0.00000000e+00]
 [-8.05449974e-03  1.84551774e-02]]
grads:  [ 2.37250498e-02 -3.49360700e+01]
Stock Position:  0.023725049835987607
Bond Position:  [-1.82720328]


portfolio before change:  [0.55880455]
curr_Stock_Price:  100.5787662348697
curr_Factors:  [1.00578766e+02 4.04852965e-02]
mat_Sqrt:  [[ 2.02374117e+01  0.00000000e+00]
 [-8.04838335e-03  1.84411630e-02]]
grads:  [6.71009430e-04 1.31299299e+00]
Stock Position:  0.0006710094297985855
Bond Position:  [0.49131524]


portfolio before change:  [0.55889459]
curr_Stock_Price:  100.62142370780839
curr_Factors:  [1.00621424e+02 4.13919702e-02]
mat_Sqrt:  [[ 2.04714454e+01  0.00000000e+00]
 [-8.13800666e-03  1.86465158e-02]]
grads:  [-0.0027562   1.68562799]
Stock Position:  -0.0027562017198892357
Bond Position:  [0.83622753]


portfolio before change:  [0.55493961]
curr_Stock_Price:  102.09428812514946
curr_Factors:  [1.02094288e+02 4.20994255e-02]
mat_Sqrt:  [[ 2.09478536e+01  0.00000000e+00]
 [-8.20725781e-03  1.88051901e-02]]
grads:  [2.57154844e-03 2.92954676e+00]
Stock Position:  0.0025715484442102856
Bond Position:  [0.2923992]


portfolio before change:  [0.55440402]
curr_Stock_Price:  101.87179798943446
curr_Factors:  [1.01871798e+02 4.16994873e-02]
mat_Sqrt:  [[ 2.08026819e+01  0.00000000e+00]
 [-8.16818093e-03  1.87156537e-02]]
grads:  [7.00349844e-03 1.49682256e+01]
Stock Position:  0.00700349843842948
Bond Position:  [-0.15905496]


portfolio before change:  [0.5468515]
curr_Stock_Price:  100.79624403793987
curr_Factors:  [1.00796244e+02 4.38840032e-02]
mat_Sqrt:  [[ 2.11153103e+01  0.00000000e+00]
 [-8.37940363e-03  1.91996257e-02]]
grads:  [ 0.00973306 -0.14413371]
Stock Position:  0.009733060596135953
Bond Position:  [-0.43420446]


portfolio before change:  [0.55337115]
curr_Stock_Price:  101.47166714312858
curr_Factors:  [1.01471667e+02 4.33979032e-02]
mat_Sqrt:  [[ 2.11387435e+01  0.00000000e+00]
 [-8.33286536e-03  1.90929931e-02]]
grads:  [0.00754207 4.39284385]
Stock Position:  0.007542072891405662
Bond Position:  [-0.21193556]


portfolio before change:  [0.54851695]
curr_Stock_Price:  100.83156403674194
curr_Factors:  [1.00831564e+02 4.48025080e-02]
mat_Sqrt:  [[ 2.13426168e+01  0.00000000e+00]
 [-8.46664118e-03  1.93995120e-02]]
grads:  [ 0.01150814 -7.30011576]
Stock Position:  0.01150813708212186
Bond Position:  [-0.61186651]


portfolio before change:  [0.54964812]
curr_Stock_Price:  100.93650291246198
curr_Factors:  [1.00936503e+02 4.45074987e-02]
mat_Sqrt:  [[ 2.12943725e+01  0.00000000e+00]
 [-8.43872016e-03  1.93355369e-02]]
grads:  [0.00367838 1.02974173]
Stock Position:  0.0036783810715942836
Bond Position:  [0.17836519]


portfolio before change:  [0.54681916]
curr_Stock_Price:  100.16136560885487
curr_Factors:  [1.00161366e+02 4.52715121e-02]
mat_Sqrt:  [[ 2.13114371e+01  0.00000000e+00]
 [-8.51084129e-03  1.95007872e-02]]
grads:  [-0.0051195  -0.66153547]
Stock Position:  -0.005119495006421953
Bond Position:  [1.05959477]


portfolio before change:  [0.54938329]
curr_Stock_Price:  99.68638307289211
curr_Factors:  [9.96863831e+01 4.51420522e-02]
mat_Sqrt:  [[ 2.11800260e+01  0.00000000e+00]
 [-8.49866363e-03  1.94728847e-02]]
grads:  [3.33227495e-03 4.59020529e+00]
Stock Position:  0.0033322749476144497
Bond Position:  [0.21720085]


portfolio before change:  [0.55796618]
curr_Stock_Price:  102.25392018391784
curr_Factors:  [1.02253920e+02 4.36622351e-02]
mat_Sqrt:  [[ 2.13664784e+01  0.00000000e+00]
 [-8.35820413e-03  1.91510515e-02]]
grads:  [ -0.0407582  -37.22495573]
Stock Position:  -0.04075820447117419
Bond Position:  [4.72565237]


portfolio before change:  [0.60875466]
curr_Stock_Price:  101.02232180229088
curr_Factors:  [1.01022322e+02 4.42343991e-02]
mat_Sqrt:  [[ 2.12469899e+01  0.00000000e+00]
 [-8.41279018e-03  1.92761239e-02]]
grads:  [7.87606369e-03 1.11119901e+01]
Stock Position:  0.007876063694814885
Bond Position:  [-0.18690358]


portfolio before change:  [0.60852713]
curr_Stock_Price:  100.99639886814865
curr_Factors:  [1.00996399e+02 4.35057808e-02]
mat_Sqrt:  [[ 2.10658687e+01  0.00000000e+00]
 [-8.34321576e-03  1.91167089e-02]]
grads:  [ 0.0021512  -1.07760296]
Stock Position:  0.0021511985752965933
Bond Position:  [0.39126382]


portfolio before change:  [0.60784516]
curr_Stock_Price:  100.65664634640098
curr_Factors:  [1.00656646e+02 4.38784199e-02]
mat_Sqrt:  [[ 2.10847253e+01  0.00000000e+00]
 [-8.37887056e-03  1.91984043e-02]]
grads:  [2.31992408e-03 1.20774666e+01]
Stock Position:  0.0023199240791978376
Bond Position:  [0.37432939]


portfolio before change:  [0.60863736]
curr_Stock_Price:  100.9779517684055
curr_Factors:  [1.00977952e+02 4.31291612e-02]
mat_Sqrt:  [[ 2.09706583e+01  0.00000000e+00]
 [-8.30702461e-03  1.90337845e-02]]
grads:  [-0.00662787  0.80796574]
Stock Position:  -0.006627868189709539
Bond Position:  [1.27790592]


portfolio before change:  [0.61208879]
curr_Stock_Price:  100.48130957970633
curr_Factors:  [1.00481310e+02 4.15379724e-02]
mat_Sqrt:  [[ 2.04789617e+01  0.00000000e+00]
 [-8.15234664e-03  1.86793728e-02]]
grads:  [2.05282741e-03 3.30920091e+00]
Stock Position:  0.002052827414578173
Bond Position:  [0.405818]


portfolio before change:  [0.61432413]
curr_Stock_Price:  101.54550554709294
curr_Factors:  [1.01545506e+02 4.01963917e-02]
mat_Sqrt:  [[ 2.03588968e+01  0.00000000e+00]
 [-8.01961512e-03  1.83752467e-02]]
grads:  [-0.00448154 -2.56165329]
Stock Position:  -0.004481537840951663
Bond Position:  [1.06940416]


portfolio before change:  [0.61184297]
curr_Stock_Price:  102.12897574550647
curr_Factors:  [1.02128976e+02 4.14385835e-02]
mat_Sqrt:  [[ 2.07898534e+01  0.00000000e+00]
 [-8.14258765e-03  1.86570121e-02]]
grads:  [0.01294946 6.74437102]
Stock Position:  0.01294946227442932
Bond Position:  [-0.71067235]


portfolio before change:  [0.56005916]
curr_Stock_Price:  98.13692065743936
curr_Factors:  [9.81369207e+01 4.47796236e-02]
mat_Sqrt:  [[ 2.07669466e+01  0.00000000e+00]
 [-8.46447858e-03  1.93945569e-02]]
grads:  [9.56010982e-03 1.41793335e+01]
Stock Position:  0.00956010982217683
Bond Position:  [-0.37814057]


portfolio before change:  [0.57042601]
curr_Stock_Price:  99.22625075892586
curr_Factors:  [9.92262508e+01 4.32863001e-02]
mat_Sqrt:  [[ 2.06443786e+01  0.00000000e+00]
 [-8.32214397e-03  1.90684273e-02]]
grads:  [8.38901496e-03 1.64189326e+01]
Stock Position:  0.008389014964259436
Bond Position:  [-0.26198449]


portfolio before change:  [0.57251337]
curr_Stock_Price:  99.47897490945482
curr_Factors:  [9.94789749e+01 4.30531209e-02]
mat_Sqrt:  [[ 2.06411372e+01  0.00000000e+00]
 [-8.29969840e-03  1.90169981e-02]]
grads:  [8.44085637e-04 7.15219368e+00]
Stock Position:  0.0008440856372493252
Bond Position:  [0.48854459]


portfolio before change:  [0.57156544]
curr_Stock_Price:  98.28359564293176
curr_Factors:  [9.82835956e+01 4.32272756e-02]
mat_Sqrt:  [[ 2.04343096e+01  0.00000000e+00]
 [-8.31646806e-03  1.90554222e-02]]
grads:  [3.12829985e-03 3.95979306e+00]
Stock Position:  0.003128299852175573
Bond Position:  [0.26410488]


portfolio before change:  [0.57155307]
curr_Stock_Price:  98.26908937003508
curr_Factors:  [9.82690894e+01 4.27243281e-02]
mat_Sqrt:  [[ 2.03120872e+01  0.00000000e+00]
 [-8.26794564e-03  1.89442434e-02]]
grads:  [ 0.01667087 -2.48470572]
Stock Position:  0.016670872779041435
Bond Position:  [-1.06667842]


portfolio before change:  [0.57417039]
curr_Stock_Price:  98.43408761541662
curr_Factors:  [9.84340876e+01 4.21282491e-02]
mat_Sqrt:  [[ 2.02037611e+01  0.00000000e+00]
 [-8.21006690e-03  1.88116265e-02]]
grads:  [2.91338060e-03 1.19245711e+01]
Stock Position:  0.0029133805992192594
Bond Position:  [0.28739443]


portfolio before change:  [0.57351172]
curr_Stock_Price:  98.19567032712932
curr_Factors:  [9.81956703e+01 4.16980360e-02]
mat_Sqrt:  [[ 2.00516511e+01  0.00000000e+00]
 [-8.16803879e-03  1.87153280e-02]]
grads:  [-6.66887164e-03  7.55879056e+00]
Stock Position:  -0.0066688716419656185
Bond Position:  [1.22836604]


portfolio before change:  [0.56687165]
curr_Stock_Price:  99.21437763026968
curr_Factors:  [9.92143776e+01 4.04871704e-02]
mat_Sqrt:  [[ 1.99633456e+01  0.00000000e+00]
 [-8.04856960e-03  1.84415897e-02]]
grads:  [-3.62594513e-03 -6.99272843e+00]
Stock Position:  -0.0036259451294063092
Bond Position:  [0.92661754]


portfolio before change:  [0.56855221]
curr_Stock_Price:  98.78284074732673
curr_Factors:  [9.87828407e+01 4.15232471e-02]
mat_Sqrt:  [[ 2.01292301e+01  0.00000000e+00]
 [-8.15090151e-03  1.86760616e-02]]
grads:  [ 1.28472056e-03 -3.12249263e+00]
Stock Position:  0.0012847205636956464
Bond Position:  [0.44164386]


portfolio before change:  [0.56811546]
curr_Stock_Price:  98.39991027008276
curr_Factors:  [9.83999103e+01 3.99440820e-02]
mat_Sqrt:  [[ 1.96662214e+01  0.00000000e+00]
 [-7.99440624e-03  1.83174859e-02]]
grads:  [-0.04377998 -5.40521175]
Stock Position:  -0.04377997527140179
Bond Position:  [4.8760611]


portfolio before change:  [0.52057222]
curr_Stock_Price:  99.4997917314514
curr_Factors:  [9.94997917e+01 3.86522124e-02]
mat_Sqrt:  [[ 1.95618241e+01  0.00000000e+00]
 [-7.86406637e-03  1.80188397e-02]]
grads:  [-0.00589315  0.35872763]
Stock Position:  -0.005893151591321711
Bond Position:  [1.10693958]


portfolio before change:  [0.51972267]
curr_Stock_Price:  99.66743200995985
curr_Factors:  [9.96674320e+01 3.87271512e-02]
mat_Sqrt:  [[ 1.96137684e+01  0.00000000e+00]
 [-7.87168609e-03  1.80362987e-02]]
grads:  [ 1.22119775e-03 -2.92988181e+00]
Stock Position:  0.0012211977546902082
Bond Position:  [0.39800902]


portfolio before change:  [0.5216261]
curr_Stock_Price:  101.18534990105526
curr_Factors:  [1.01185350e+02 3.91548732e-02]
mat_Sqrt:  [[ 2.00221425e+01  0.00000000e+00]
 [-7.91503614e-03  1.81356261e-02]]
grads:  [0.00892064 3.71502455]
Stock Position:  0.008920635130929375
Bond Position:  [-0.38101149]


portfolio before change:  [0.52453683]
curr_Stock_Price:  101.51698082810636
curr_Factors:  [1.01516981e+02 3.88340700e-02]
mat_Sqrt:  [[ 2.00053037e+01  0.00000000e+00]
 [-7.88254477e-03  1.80611790e-02]]
grads:  [-0.01825252 -9.89766602]
Stock Position:  -0.01825251554042367
Bond Position:  [2.3774771]


portfolio before change:  [0.52780637]
curr_Stock_Price:  101.35413564742336
curr_Factors:  [1.01354136e+02 3.88267025e-02]
mat_Sqrt:  [[ 1.99713181e+01  0.00000000e+00]
 [-7.88179700e-03  1.80594657e-02]]
grads:  [-1.66900301e-02 -2.26070185e+01]
Stock Position:  -0.016690030092824354
Bond Position:  [2.21940994]


portfolio before change:  [0.54293824]
curr_Stock_Price:  100.46411783171516
curr_Factors:  [1.00464118e+02 3.82051631e-02]
mat_Sqrt:  [[ 1.96368582e+01  0.00000000e+00]
 [-7.81845643e-03  1.79143342e-02]]
grads:  [2.61764031e-03 1.62692744e+01]
Stock Position:  0.002617640313447124
Bond Position:  [0.27995931]


portfolio before change:  [0.54297354]
curr_Stock_Price:  100.46423626692754
curr_Factors:  [1.00464236e+02 3.97738617e-02]
mat_Sqrt:  [[ 2.00359697e+01  0.00000000e+00]
 [-7.97735411e-03  1.82784145e-02]]
grads:  [-3.60471816e-03  6.43821145e+00]
Stock Position:  -0.003604718162539398
Bond Position:  [0.9051188]


portfolio before change:  [0.54071183]
curr_Stock_Price:  101.12305560205208
curr_Factors:  [1.01123056e+02 4.06626365e-02]
mat_Sqrt:  [[ 2.03914426e+01  0.00000000e+00]
 [-8.06599147e-03  1.84815082e-02]]
grads:  [0.01157609 4.32877315]
Stock Position:  0.011576092486712403
Bond Position:  [-0.62989801]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.53646383]
Stock Price:  100.76289411606139
PL:  [-0.22643029]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.29009075e-01 -1.50218234e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.09342871e-01 -6.84402948e-01]
 [ 5.16070163e-02  2.12781078e-02]
 [-1.60581673e-01  6.76263041e-02]
 [ 1.32460624e-02  4.20118361e-02]
 [ 4.86091411e-02  1.94534070e-01]
 [ 2.46019235e-01 -2.10650511e-03]
 [ 1.12441282e-01  8.71748817e-02]
 [ 3.28344251e-01 -1.57086644e-01]
 [ 6.50267312e-02  3.98482639e-03]
 [-1.43886489e-01 -1.18631399e-01]
 [ 9.23363284e-02  6.48678954e-02]
 [-2.83347114e-01 -3.88334314e-01]
 [ 8.09214397e-02  2.26047398e-01]
 [ 5.34567244e-02 -2.00581222e-02]
 [-5.12605223e-02  1.74528036e-01]
 [-4.18515574e-02  2.29671494e-02]
 [ 1.55397687e-02  4.99512498e-02]
 [ 9.85686880e-02 -9.97443091e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 5.45761765e-02  2.64097376e-01]
 [ 3.65420482e-02  3.12896959e-01]
 [-7.36303701e-02  1.14052025e-01]
 [ 3.92294397e-02  9.07824719e-02]
 [ 3.97345647e-01 -6.04049725e-02]
 [ 5.93383509e-03  9.37835533e-02]
 [-1.98622860e-01  1.43111129e-01]
 [ 1.29186042e-02 -1.42423390e-01]
 [ 5.25528881e-02 -5.86082867e-02]
 [-8.47196186e-01 -1.00560389e-01]
 [-1.18100501e-01  6.41137652e-03]
 [ 6.10725260e-02 -2.58284051e-02]
 [ 1.30636407e-01  7.69011503e-02]
 [-2.04618684e-01  6.09456339e-03]
 [-4.43857585e-01 -3.48267489e-01]
 [-9.39390433e-02  2.75259492e-01]
 [-1.22903331e-01  1.18139434e-01]
 [ 1.22931678e-01  8.98431299e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.50438103]
curr_Stock_Price:  99.064345704608
curr_Factors:  [9.90643457e+01 3.93841305e-02]
mat_Sqrt:  [[ 1.96597507e+01  0.00000000e+00]
 [-7.93817415e-03  1.81886420e-02]]
grads:  [-0.0119821  -0.82589032]
Stock Position:  -0.011982101897945269
Bond Position:  [-2.31738194]


portfolio before change:  [-3.49931995]
curr_Stock_Price:  98.61778275652135
curr_Factors:  [9.86177828e+01 3.95164302e-02]
mat_Sqrt:  [[ 1.96039726e+01  0.00000000e+00]
 [-7.95149598e-03  1.82191661e-02]]
grads:  [-0.01035425 -4.83070244]
Stock Position:  -0.010354250760423973
Bond Position:  [-2.4782067]


portfolio before change:  [-3.51307915]
curr_Stock_Price:  99.91670829028973
curr_Factors:  [9.99167083e+01 3.86315671e-02]
mat_Sqrt:  [[ 1.96385438e+01  0.00000000e+00]
 [-7.86196587e-03  1.80140269e-02]]
grads:  [ 2.60021793e-02 -3.79927794e+01]
Stock Position:  0.02600217930588577
Bond Position:  [-6.11113131]


portfolio before change:  [-3.4703641]
curr_Stock_Price:  101.58883700019356
curr_Factors:  [1.01588837e+02 3.72082539e-02]
mat_Sqrt:  [[ 1.95959189e+01  0.00000000e+00]
 [-7.71577645e-03  1.76790648e-02]]
grads:  [0.00310746 1.20357655]
Stock Position:  0.0031074604945166527
Bond Position:  [-3.7860474]


portfolio before change:  [-3.46689972]
curr_Stock_Price:  102.85600229431724
curr_Factors:  [1.02856002e+02 3.75856476e-02]
mat_Sqrt:  [[ 1.99407119e+01  0.00000000e+00]
 [-7.75480729e-03  1.77684957e-02]]
grads:  [-0.00657284  3.80596676]
Stock Position:  -0.006572841271366371
Bond Position:  [-2.79084354]


portfolio before change:  [-3.4612651]
curr_Stock_Price:  101.94566553795967
curr_Factors:  [1.01945666e+02 3.85807956e-02]
mat_Sqrt:  [[ 2.00241622e+01  0.00000000e+00]
 [-7.85679788e-03  1.80021855e-02]]
grads:  [1.57717115e-03 2.33370754e+00]
Stock Position:  0.0015771711480124522
Bond Position:  [-3.62205086]


portfolio before change:  [-3.46084715]
curr_Stock_Price:  102.49775147459908
curr_Factors:  [1.02497751e+02 3.91755161e-02]
mat_Sqrt:  [[ 2.02871809e+01  0.00000000e+00]
 [-7.91712231e-03  1.81404061e-02]]
grads:  [6.58104103e-03 1.07237990e+01]
Stock Position:  0.006581041025467822
Bond Position:  [-4.13538905]


portfolio before change:  [-3.46789774]
curr_Stock_Price:  101.50495490251292
curr_Factors:  [1.01504955e+02 3.94361807e-02]
mat_Sqrt:  [[ 2.01574071e+01  0.00000000e+00]
 [-7.94341797e-03  1.82006571e-02]]
grads:  [ 0.0121593  -0.11573786]
Stock Position:  0.012159296096561512
Bond Position:  [-4.70212654]


portfolio before change:  [-3.46396292]
curr_Stock_Price:  101.87690244113435
curr_Factors:  [1.01876902e+02 3.93533269e-02]
mat_Sqrt:  [[ 2.02100068e+01  0.00000000e+00]
 [-7.93506919e-03  1.81815276e-02]]
grads:  [0.00744619 4.79469512]
Stock Position:  0.00744618848841236
Bond Position:  [-4.22255754]


portfolio before change:  [-3.46811394]
curr_Stock_Price:  101.39032181949047
curr_Factors:  [1.01390322e+02 4.15657882e-02]
mat_Sqrt:  [[ 2.06711440e+01  0.00000000e+00]
 [-8.15507579e-03  1.86856260e-02]]
grads:  [ 0.01256757 -8.40681728]
Stock Position:  0.012567568567164147
Bond Position:  [-4.74234376]


portfolio before change:  [-3.46542298]
curr_Stock_Price:  101.65161322690946
curr_Factors:  [1.01651613e+02 4.08721644e-02]
mat_Sqrt:  [[ 2.05507698e+01  0.00000000e+00]
 [-8.08674614e-03  1.85290631e-02]]
grads:  [0.00324882 0.21505817]
Stock Position:  0.003248824877746349
Bond Position:  [-3.79567127]


portfolio before change:  [-3.4675052]
curr_Stock_Price:  101.15674556736002
curr_Factors:  [1.01156746e+02 4.02641159e-02]
mat_Sqrt:  [[ 2.02980320e+01  0.00000000e+00]
 [-8.02636813e-03  1.83907198e-02]]
grads:  [-0.00963943 -6.45061205]
Stock Position:  -0.009639430876733407
Bond Position:  [-2.49241175]


portfolio before change:  [-3.44766846]
curr_Stock_Price:  99.06654791029733
curr_Factors:  [9.90665479e+01 4.09419210e-02]
mat_Sqrt:  [[ 2.00452343e+01  0.00000000e+00]
 [-8.09364403e-03  1.85448682e-02]]
grads:  [0.00601874 3.49788927]
Stock Position:  0.006018737267273637
Bond Position:  [-4.04392398]


portfolio before change:  [-3.44829435]
curr_Stock_Price:  99.04654919546692
curr_Factors:  [9.90465492e+01 4.09508963e-02]
mat_Sqrt:  [[ 2.00433844e+01  0.00000000e+00]
 [-8.09453112e-03  1.85469008e-02]]
grads:  [ -0.0225925  -20.93796255]
Stock Position:  -0.022592497127049724
Bond Position:  [-1.21058547]


portfolio before change:  [-3.46087596]
curr_Stock_Price:  99.59674433280132
curr_Factors:  [9.95967443e+01 4.00940883e-02]
mat_Sqrt:  [[ 1.99427623e+01  0.00000000e+00]
 [-8.00940331e-03  1.83518485e-02]]
grads:  [9.00460074e-03 1.23174185e+01]
Stock Position:  0.009004600738718322
Bond Position:  [-4.35770488]


portfolio before change:  [-3.45708542]
curr_Stock_Price:  100.07819667280832
curr_Factors:  [1.00078197e+02 3.87366763e-02]
mat_Sqrt:  [[ 1.96970256e+01  0.00000000e+00]
 [-7.87265407e-03  1.80385166e-02]]
grads:  [ 0.00226951 -1.11196074]
Stock Position:  0.0022695123209813587
Bond Position:  [-3.68421412]


portfolio before change:  [-3.45869907]
curr_Stock_Price:  99.57011791937654
curr_Factors:  [9.95701179e+01 3.87092477e-02]
mat_Sqrt:  [[ 1.95900880e+01  0.00000000e+00]
 [-7.86986634e-03  1.80321291e-02]]
grads:  [1.27154903e-03 9.67872596e+00]
Stock Position:  0.001271549032105234
Bond Position:  [-3.58530736]


portfolio before change:  [-3.45932816]
curr_Stock_Price:  99.42785433229406
curr_Factors:  [9.94278543e+01 3.84888172e-02]
mat_Sqrt:  [[ 1.95063202e+01  0.00000000e+00]
 [-7.84742681e-03  1.79807137e-02]]
grads:  [-0.00163167  1.27732135]
Stock Position:  -0.0016316696985581598
Bond Position:  [-3.29709474]


portfolio before change:  [-3.45828698]
curr_Stock_Price:  98.53715121109863
curr_Factors:  [9.85371512e+01 3.72526916e-02]
mat_Sqrt:  [[ 1.90186125e+01  0.00000000e+00]
 [-7.72038254e-03  1.76896187e-02]]
grads:  [1.96335465e-03 2.82376069e+00]
Stock Position:  0.001963354651694797
Bond Position:  [-3.65175036]


portfolio before change:  [-3.45950391]
curr_Stock_Price:  98.14983827943362
curr_Factors:  [9.81498383e+01 3.62951039e-02]
mat_Sqrt:  [[ 1.86987946e+01  0.00000000e+00]
 [-7.62050957e-03  1.74607810e-02]]
grads:  [ 2.94332891e-03 -5.71247696e+00]
Stock Position:  0.002943328909018234
Bond Position:  [-3.74839117]


portfolio before change:  [-3.46086738]
curr_Stock_Price:  97.84580075425274
curr_Factors:  [9.78458008e+01 3.55755205e-02]
mat_Sqrt:  [[ 1.84551604e+01  0.00000000e+00]
 [-7.54458964e-03  1.72868266e-02]]
grads:  [ 0.00228276 -2.18536291]
Stock Position:  0.002282755054740085
Bond Position:  [-3.68422537]


portfolio before change:  [-3.46076232]
curr_Stock_Price:  98.09357846867263
curr_Factors:  [9.80935785e+01 3.37329242e-02]
mat_Sqrt:  [[ 1.80163817e+01  0.00000000e+00]
 [-7.34661002e-03  1.68331983e-02]]
grads:  [9.42684963e-03 1.56890789e+01]
Stock Position:  0.009426849626156655
Bond Position:  [-4.38547573]


portfolio before change:  [-3.45101942]
curr_Stock_Price:  99.18526001997571
curr_Factors:  [9.91852600e+01 3.17172863e-02]
mat_Sqrt:  [[ 1.76642477e+01  0.00000000e+00]
 [-7.12373905e-03  1.63225367e-02]]
grads:  [9.79953856e-03 1.91696282e+01]
Stock Position:  0.009799538557949902
Bond Position:  [-4.4229892]


portfolio before change:  [-3.46374625]
curr_Stock_Price:  97.94296479410318
curr_Factors:  [9.79429648e+01 3.10021823e-02]
mat_Sqrt:  [[ 1.72452454e+01  0.00000000e+00]
 [-7.04297463e-03  1.61374822e-02]]
grads:  [-1.38322100e-03  7.06752289e+00]
Stock Position:  -0.0013832210031525076
Bond Position:  [-3.32826948]


portfolio before change:  [-3.46358938]
curr_Stock_Price:  97.52877063799764
curr_Factors:  [9.75287706e+01 3.14226387e-02]
mat_Sqrt:  [[ 1.72883711e+01  0.00000000e+00]
 [-7.09057275e-03  1.62465432e-02]]
grads:  [4.56087842e-03 5.58780233e+00]
Stock Position:  0.004560878422872018
Bond Position:  [-3.90840625]


portfolio before change:  [-3.45938832]
curr_Stock_Price:  98.55700251894024
curr_Factors:  [9.85570025e+01 3.11029332e-02]
mat_Sqrt:  [[ 1.73815363e+01  0.00000000e+00]
 [-7.05440948e-03  1.61636827e-02]]
grads:  [ 0.0213435  -3.73707982]
Stock Position:  0.021343496256783747
Bond Position:  [-5.56293934]


portfolio before change:  [-3.43779208]
curr_Stock_Price:  99.6014263569755
curr_Factors:  [9.96014264e+01 2.99229555e-02]
mat_Sqrt:  [[ 1.72293067e+01  0.00000000e+00]
 [-6.91930118e-03  1.58541107e-02]]
grads:  [2.72003594e-03 5.91540927e+00]
Stock Position:  0.0027200359420338693
Bond Position:  [-3.70871154]


portfolio before change:  [-3.43880383]
curr_Stock_Price:  99.39990963732156
curr_Factors:  [9.93999096e+01 3.05204989e-02]
mat_Sqrt:  [[ 1.73652806e+01  0.00000000e+00]
 [-6.98804682e-03  1.60116267e-02]]
grads:  [-7.84116573e-03  8.93795058e+00]
Stock Position:  -0.007841165725876476
Bond Position:  [-2.65939266]


portfolio before change:  [-3.44133126]
curr_Stock_Price:  99.67984033829336
curr_Factors:  [9.96798403e+01 2.90973941e-02]
mat_Sqrt:  [[ 1.70033456e+01  0.00000000e+00]
 [-6.82318332e-03  1.56338770e-02]]
grads:  [-2.89590417e-03 -9.10992138e+00]
Stock Position:  -0.0028959041700709304
Bond Position:  [-3.15266799]


portfolio before change:  [-3.43910443]
curr_Stock_Price:  98.77479162835583
curr_Factors:  [9.87747916e+01 2.92430124e-02]
mat_Sqrt:  [[ 1.68910706e+01  0.00000000e+00]
 [-6.84023537e-03  1.56729482e-02]]
grads:  [ 1.59694643e-03 -3.73945514e+00]
Stock Position:  0.0015969464272845174
Bond Position:  [-3.59684248]


portfolio before change:  [-3.44056363]
curr_Stock_Price:  98.14260674128364
curr_Factors:  [9.81426067e+01 3.01754391e-02]
mat_Sqrt:  [[ 1.70484299e+01  0.00000000e+00]
 [-6.94843166e-03  1.59208570e-02]]
grads:  [-0.05226782 -6.31626733]
Stock Position:  -0.052267824232597716
Bond Position:  [1.68913689]


portfolio before change:  [-3.51262769]
curr_Stock_Price:  99.5253926760422
curr_Factors:  [9.95253927e+01 3.03269142e-02]
mat_Sqrt:  [[ 1.73319733e+01  0.00000000e+00]
 [-6.96584974e-03  1.59607669e-02]]
grads:  [-0.00665258  0.40169602]
Stock Position:  -0.006652580474823776
Bond Position:  [-2.850527]


portfolio before change:  [-3.51580333]
curr_Stock_Price:  99.94918317954225
curr_Factors:  [9.99491832e+01 2.94912924e-02]
mat_Sqrt:  [[ 1.71643022e+01  0.00000000e+00]
 [-6.86921159e-03  1.57393410e-02]]
grads:  [ 0.00290138 -1.6410093 ]
Stock Position:  0.002901375503162006
Bond Position:  [-3.80579344]


portfolio before change:  [-3.51355201]
curr_Stock_Price:  100.88910650410244
curr_Factors:  [1.00889107e+02 2.86835007e-02]
mat_Sqrt:  [[ 1.70867849e+01  0.00000000e+00]
 [-6.77448161e-03  1.55222874e-02]]
grads:  [0.0096097  4.95424085]
Stock Position:  0.009609696681629316
Bond Position:  [-4.48306572]


portfolio before change:  [-3.52880052]
curr_Stock_Price:  99.36064041895303
curr_Factors:  [9.93606404e+01 2.85674504e-02]
mat_Sqrt:  [[ 1.67938443e+01  0.00000000e+00]
 [-6.76076332e-03  1.54908548e-02]]
grads:  [-0.01202576  0.39342977]
Stock Position:  -0.012025763414303878
Bond Position:  [-2.33391297]


portfolio before change:  [-3.52950613]
curr_Stock_Price:  99.39505406784599
curr_Factors:  [9.93950541e+01 2.69899721e-02]
mat_Sqrt:  [[ 1.63292407e+01  0.00000000e+00]
 [-6.57145002e-03  1.50570836e-02]]
grads:  [ -0.03649    -23.12981044]
Stock Position:  -0.03648999897734535
Bond Position:  [0.09741929]


portfolio before change:  [-3.59541388]
curr_Stock_Price:  101.20157448107084
curr_Factors:  [1.01201574e+02 2.63921700e-02]
mat_Sqrt:  [[ 1.64408709e+01  0.00000000e+00]
 [-6.49826684e-03  1.48893998e-02]]
grads:  [1.59322752e-03 1.84869434e+01]
Stock Position:  0.0015932275203612953
Bond Position:  [-3.75665101]


portfolio before change:  [-3.59515643]
curr_Stock_Price:  101.65792143240054
curr_Factors:  [1.01657921e+02 2.56392958e-02]
mat_Sqrt:  [[ 1.62777462e+01  0.00000000e+00]
 [-6.40491009e-03  1.46754926e-02]]
grads:  [-4.38285832e-03  8.05011710e+00]
Stock Position:  -0.004382858319678517
Bond Position:  [-3.14960416]


portfolio before change:  [-3.59574989]
curr_Stock_Price:  101.70349331870385
curr_Factors:  [1.01703493e+02 2.57204966e-02]
mat_Sqrt:  [[ 1.63108106e+01  0.00000000e+00]
 [-6.41504440e-03  1.46987133e-02]]
grads:  [0.0099408  6.11231257]
Stock Position:  0.00994079560728435
Bond Position:  [-4.60676353]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.59484196]
Stock Price:  101.85275809519925
PL:  [-5.44760005]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.27388452e-01  5.41827930e-01]
 [-1.64575277e-01 -8.79993658e-02]
 [ 8.51641324e-01 -7.71708223e-01]
 [-2.52154229e-02  1.77817212e-01]
 [ 3.69445592e-02 -4.50822330e-02]
 [-8.04985571e-02 -1.02953774e-01]
 [-4.65782721e-02  1.98755854e-01]
 [ 1.41111717e-01 -2.64458474e-02]
 [ 1.57679651e-01  7.27876328e-02]
 [ 3.39452323e-01 -1.65204455e-01]
 [ 6.51858364e-02  4.53418957e-03]
 [-1.27619703e-01 -1.91114435e-01]
 [-1.86472921e-01  1.64656452e-01]
 [-5.05349331e-01 -6.49040812e-01]
 [ 7.74437027e-02  2.23275733e-01]
 [ 5.36399302e-02 -2.01748523e-02]
 [-5.24972062e-02  2.44046045e-01]
 [-8.42379986e-03  1.33730360e-01]
 [ 1.46934822e-02  7.09646696e-02]
 [-1.08950427e-01 -2.85638673e-02]
 [ 2.08187169e-01  3.83528433e-01]
 [ 3.38666703e-02  5.78185197e-02]
 [-1.07970694e-02 -6.97262910e-02]
 [ 9.82276715e-02  1.90905305e-01]
 [ 4.00634470e-02  8.88463593e-02]
 [ 6.78422774e-01 -2.37580926e-01]
 [-2.70179600e-03  6.50835048e-02]
 [-2.10561931e-01  1.48485651e-01]
 [ 5.70132732e-02 -1.67843287e-01]
 [ 2.18556529e-02 -5.14307486e-02]
 [-5.43608211e-01 -1.01710974e-01]
 [-1.17931339e-01 -1.55533718e-04]
 [ 9.21107912e-02  4.06098782e-02]
 [ 1.05074945e-01  9.00153086e-02]
 [-2.85157370e-01 -1.49633190e-01]
 [-4.08209440e-01 -3.50594718e-01]
 [-6.04702084e-02  3.00612422e-01]
 [-1.23745592e-01  1.17571228e-01]
 [ 7.01748344e-01  2.17095366e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.1118851]
curr_Stock_Price:  100.66332721210847
curr_Factors:  [1.00663327e+02 3.94412945e-02]
mat_Sqrt:  [[ 1.99915681e+01  0.00000000e+00]
 [-7.94393298e-03  1.82018371e-02]]
grads:  [2.32028596e-02 2.97677607e+01]
Stock Position:  0.02320285956593075
Bond Position:  [4.77620806]


portfolio before change:  [7.09462186]
curr_Stock_Price:  99.8935811697448
curr_Factors:  [9.98935812e+01 3.88666837e-02]
mat_Sqrt:  [[ 1.96936550e+01  0.00000000e+00]
 [-7.88585404e-03  1.80687615e-02]]
grads:  [-0.01030694 -4.87024889]
Stock Position:  -0.01030694144604147
Bond Position:  [8.12421915]


portfolio before change:  [7.11076539]
curr_Stock_Price:  98.42583840816405
curr_Factors:  [9.84258384e+01 3.99633167e-02]
mat_Sqrt:  [[ 1.96761391e+01  0.00000000e+00]
 [-7.99633083e-03  1.83218956e-02]]
grads:  [ 2.61657147e-02 -4.21194530e+01]
Stock Position:  0.02616571468733153
Bond Position:  [4.53538298]


portfolio before change:  [7.09361303]
curr_Stock_Price:  97.74864259514676
curr_Factors:  [9.77486426e+01 3.95503286e-02]
mat_Sqrt:  [[ 1.94395310e+01  0.00000000e+00]
 [-7.95490577e-03  1.82269789e-02]]
grads:  [2.69504294e-03 9.75571502e+00]
Stock Position:  0.0026950429383604843
Bond Position:  [6.83017624]


portfolio before change:  [7.09577063]
curr_Stock_Price:  98.23240801863376
curr_Factors:  [9.82324080e+01 4.01558642e-02]
mat_Sqrt:  [[ 1.96847217e+01  0.00000000e+00]
 [-8.01557127e-03  1.83659810e-02]]
grads:  [ 8.77282389e-04 -2.45465967e+00]
Stock Position:  0.0008772823891217237
Bond Position:  [7.00959306]


portfolio before change:  [7.09621488]
curr_Stock_Price:  97.73998175807205
curr_Factors:  [9.77399818e+01 4.12908114e-02]
mat_Sqrt:  [[ 1.98609017e+01  0.00000000e+00]
 [-8.12805624e-03  1.86237165e-02]]
grads:  [-0.00631549 -5.52810038]
Stock Position:  -0.006315487068912672
Bond Position:  [7.71349047]


portfolio before change:  [7.08986876]
curr_Stock_Price:  98.89751300273858
curr_Factors:  [9.88975130e+01 4.30445907e-02]
mat_Sqrt:  [[ 2.05184553e+01  0.00000000e+00]
 [-8.29887613e-03  1.90151140e-02]]
grads:  [1.95754962e-03 1.04525197e+01]
Stock Position:  0.001957549624470465
Bond Position:  [6.89627197]


portfolio before change:  [7.09324393]
curr_Stock_Price:  100.18130615148749
curr_Factors:  [1.00181306e+02 4.21446021e-02]
mat_Sqrt:  [[ 2.05663711e+01  0.00000000e+00]
 [-8.21166020e-03  1.88152772e-02]]
grads:  [ 0.00630008 -1.40555183]
Stock Position:  0.0063000809301400505
Bond Position:  [6.4620936]


portfolio before change:  [7.09078683]
curr_Stock_Price:  99.66307183428228
curr_Factors:  [9.96630718e+01 4.23944247e-02]
mat_Sqrt:  [[ 2.05205332e+01  0.00000000e+00]
 [-8.23596257e-03  1.88709610e-02]]
grads:  [0.00923206 3.85712381]
Stock Position:  0.009232059251992554
Bond Position:  [6.17069144]


portfolio before change:  [7.11014866]
curr_Stock_Price:  101.67675623948782
curr_Factors:  [1.01676756e+02 4.13888672e-02]
mat_Sqrt:  [[ 2.06853776e+01  0.00000000e+00]
 [-8.13770161e-03  1.86458168e-02]]
grads:  [ 0.01292465 -8.86013506]
Stock Position:  0.012924646219147259
Bond Position:  [5.79601256]


portfolio before change:  [7.11026889]
curr_Stock_Price:  101.62999880243439
curr_Factors:  [1.01629999e+02 4.22184453e-02]
mat_Sqrt:  [[ 2.08820456e+01  0.00000000e+00]
 [-8.21885105e-03  1.88317535e-02]]
grads:  [0.00321639 0.24077363]
Stock Position:  0.0032163859976611893
Bond Position:  [6.78338758]


portfolio before change:  [7.1128008]
curr_Stock_Price:  102.15354892550133
curr_Factors:  [1.02153549e+02 4.09721808e-02]
mat_Sqrt:  [[ 2.06774986e+01  0.00000000e+00]
 [-8.09663444e-03  1.85517201e-02]]
grads:  [-1.02057258e-02 -1.03017097e+01]
Stock Position:  -0.010205725785233068
Bond Position:  [8.15535191]


portfolio before change:  [7.11524762]
curr_Stock_Price:  102.01369299216513
curr_Factors:  [1.02013693e+02 4.17829410e-02]
mat_Sqrt:  [[ 2.08524925e+01  0.00000000e+00]
 [-8.17635039e-03  1.87343723e-02]]
grads:  [-5.49627121e-03  8.78900288e+00]
Stock Position:  -0.005496271206374532
Bond Position:  [7.67594254]


portfolio before change:  [7.11839927]
curr_Stock_Price:  101.61485898260285
curr_Factors:  [1.01614859e+02 4.13097348e-02]
mat_Sqrt:  [[ 2.06530132e+01  0.00000000e+00]
 [-8.12991855e-03  1.86279836e-02]]
grads:  [ -0.03818397 -34.84224738]
Stock Position:  -0.03818396654247035
Bond Position:  [10.99845765]


portfolio before change:  [7.16144311]
curr_Stock_Price:  100.52359071765271
curr_Factors:  [1.00523591e+02 4.12918180e-02]
mat_Sqrt:  [[ 2.04267840e+01  0.00000000e+00]
 [-8.12815532e-03  1.86239435e-02]]
grads:  [8.56175998e-03 1.19886389e+01]
Stock Position:  0.008561759983289835
Bond Position:  [6.30078426]


portfolio before change:  [7.16016349]
curr_Stock_Price:  100.28213644934719
curr_Factors:  [1.00282136e+02 4.12130052e-02]
mat_Sqrt:  [[ 2.03582630e+01  0.00000000e+00]
 [-8.12039460e-03  1.86061615e-02]]
grads:  [ 0.0022023  -1.08431029]
Stock Position:  0.002202295100441691
Bond Position:  [6.93931263]


portfolio before change:  [7.16299075]
curr_Stock_Price:  101.17202112679121
curr_Factors:  [1.01172021e+02 4.02481989e-02]
mat_Sqrt:  [[ 2.02970841e+01  0.00000000e+00]
 [-8.02478150e-03  1.83870843e-02]]
grads:  [2.66113199e-03 1.32726886e+01]
Stock Position:  0.0026611319942032047
Bond Position:  [6.89375864]


portfolio before change:  [7.17001372]
curr_Stock_Price:  103.48727781652511
curr_Factors:  [1.03487278e+02 4.03917414e-02]
mat_Sqrt:  [[ 2.07985593e+01  0.00000000e+00]
 [-8.03907870e-03  1.84198433e-02]]
grads:  [2.40117181e-03 7.26012473e+00]
Stock Position:  0.002401171810510751
Bond Position:  [6.92152299]


portfolio before change:  [7.17226976]
curr_Stock_Price:  104.06649076566143
curr_Factors:  [1.04066491e+02 3.96028916e-02]
mat_Sqrt:  [[ 2.07097263e+01  0.00000000e+00]
 [-7.96019010e-03  1.82390869e-02]]
grads:  [2.20500275e-03 3.89080167e+00]
Stock Position:  0.002205002745109858
Bond Position:  [6.94280286]


portfolio before change:  [7.17605079]
curr_Stock_Price:  105.3876371272102
curr_Factors:  [1.05387637e+02 3.95881338e-02]
mat_Sqrt:  [[ 2.09687326e+01  0.00000000e+00]
 [-7.95870681e-03  1.82356882e-02]]
grads:  [-0.00579037 -1.56637178]
Stock Position:  -0.005790369993833917
Bond Position:  [7.7862842]


portfolio before change:  [7.17607321]
curr_Stock_Price:  105.55186268176429
curr_Factors:  [1.05551863e+02 4.18881867e-02]
mat_Sqrt:  [[ 2.16028814e+01  0.00000000e+00]
 [-8.18664148e-03  1.87579521e-02]]
grads:  [1.73853058e-02 2.04461782e+01]
Stock Position:  0.01738530578792357
Bond Position:  [5.3410218]


portfolio before change:  [7.15825886]
curr_Stock_Price:  104.48877967638897
curr_Factors:  [1.04488780e+02 4.17100815e-02]
mat_Sqrt:  [[ 2.13397917e+01  0.00000000e+00]
 [-8.16921847e-03  1.87180310e-02]]
grads:  [2.76950881e-03 3.08892104e+00]
Stock Position:  0.0027695088063284467
Bond Position:  [6.86887626]


portfolio before change:  [7.16056435]
curr_Stock_Price:  105.01119279234709
curr_Factors:  [1.05011193e+02 4.20779342e-02]
mat_Sqrt:  [[ 2.15408480e+01  0.00000000e+00]
 [-8.20516268e-03  1.88003895e-02]]
grads:  [-1.91395054e-03 -3.70876842e+00]
Stock Position:  -0.0019139505387458784
Bond Position:  [7.36155058]


portfolio before change:  [7.16150093]
curr_Stock_Price:  105.00266364238156
curr_Factors:  [1.05002664e+02 4.17701401e-02]
mat_Sqrt:  [[ 2.14601761e+01  0.00000000e+00]
 [-8.17509781e-03  1.87315023e-02]]
grads:  [8.45964992e-03 1.01916708e+01]
Stock Position:  0.0084596499199215
Bond Position:  [6.27321515]


portfolio before change:  [7.14290332]
curr_Stock_Price:  102.71157464365758
curr_Factors:  [1.02711575e+02 4.29294629e-02]
mat_Sqrt:  [[ 2.12812491e+01  0.00000000e+00]
 [-8.28777055e-03  1.89896679e-02]]
grads:  [3.7046311e-03 4.6786684e+00]
Stock Position:  0.003704631097761008
Bond Position:  [6.76239482]


portfolio before change:  [7.1373554]
curr_Stock_Price:  100.98582511182283
curr_Factors:  [1.00985825e+02 4.30895680e-02]
mat_Sqrt:  [[ 2.09626647e+01  0.00000000e+00]
 [-8.30321075e-03  1.90250459e-02]]
grads:  [  0.02741703 -12.4877978 ]
Stock Position:  0.027417027598879772
Bond Position:  [4.36862425]


portfolio before change:  [7.11812983]
curr_Stock_Price:  100.26467883244466
curr_Factors:  [1.00264679e+02 4.31421379e-02]
mat_Sqrt:  [[ 2.08256612e+01  0.00000000e+00]
 [-8.30827423e-03  1.90366478e-02]]
grads:  [1.23419727e-03 3.41885323e+00]
Stock Position:  0.0012341972719269872
Bond Position:  [6.99438343]


portfolio before change:  [7.11781097]
curr_Stock_Price:  99.29789075133854
curr_Factors:  [9.92978908e+01 4.39937338e-02]
mat_Sqrt:  [[ 2.08274181e+01  0.00000000e+00]
 [-8.38987331e-03  1.92236148e-02]]
grads:  [-6.99834609e-03  7.72412749e+00]
Stock Position:  -0.006998346092335105
Bond Position:  [7.81273198]


portfolio before change:  [7.10927069]
curr_Stock_Price:  100.65777396960284
curr_Factors:  [1.00657774e+02 4.49046810e-02]
mat_Sqrt:  [[ 2.13301117e+01  0.00000000e+00]
 [-8.47628985e-03  1.94216199e-02]]
grads:  [-7.61343538e-04 -8.64208482e+00]
Stock Position:  -0.0007613435381281198
Bond Position:  [7.18590584]


portfolio before change:  [7.11100198]
curr_Stock_Price:  99.56366654025616
curr_Factors:  [9.95636665e+01 4.69094292e-02]
mat_Sqrt:  [[ 2.15640811e+01  0.00000000e+00]
 [-8.66343388e-03  1.98504208e-02]]
grads:  [-2.73865591e-05 -2.59091478e+00]
Stock Position:  -2.7386559120585448e-05
Bond Position:  [7.11372868]


portfolio before change:  [7.11184599]
curr_Stock_Price:  101.21611262550047
curr_Factors:  [1.01216113e+02 4.67077418e-02]
mat_Sqrt:  [[ 2.18747999e+01  0.00000000e+00]
 [-8.64478958e-03  1.98077013e-02]]
grads:  [-0.02688018 -5.13492064]
Stock Position:  -0.026880178222532344
Bond Position:  [9.83255314]


portfolio before change:  [7.08325868]
curr_Stock_Price:  102.32534841562608
curr_Factors:  [1.02325348e+02 4.66338109e-02]
mat_Sqrt:  [[ 2.20970188e+01  0.00000000e+00]
 [-8.63794521e-03  1.97920189e-02]]
grads:  [-0.00534005 -0.00785841]
Stock Position:  -0.005340051525851823
Bond Position:  [7.62968132]


portfolio before change:  [7.09281195]
curr_Stock_Price:  100.71497212260893
curr_Factors:  [1.00714972e+02 4.79532579e-02]
mat_Sqrt:  [[ 2.20547986e+01  0.00000000e+00]
 [-8.75929293e-03  2.00700614e-02]]
grads:  [0.00498007 2.02340577]
Stock Position:  0.004980067930223714
Bond Position:  [6.59124454]


portfolio before change:  [7.08612133]
curr_Stock_Price:  99.20604240446059
curr_Factors:  [9.92060424e+01 4.84279438e-02]
mat_Sqrt:  [[ 2.18316289e+01  0.00000000e+00]
 [-8.80253998e-03  2.01691529e-02]]
grads:  [0.00661246 4.4630188 ]
Stock Position:  0.006612463368541355
Bond Position:  [6.43012501]


portfolio before change:  [7.0976629]
curr_Stock_Price:  100.82990739933462
curr_Factors:  [1.00829907e+02 4.68327322e-02]
mat_Sqrt:  [[ 2.18204708e+01  0.00000000e+00]
 [-8.65634863e-03  1.98341864e-02]]
grads:  [-0.01606119 -7.5442061 ]
Stock Position:  -0.016061186400090563
Bond Position:  [8.71711083]


portfolio before change:  [7.11768924]
curr_Stock_Price:  99.65087654618108
curr_Factors:  [9.96508765e+01 4.77407032e-02]
mat_Sqrt:  [[ 2.17733638e+01  0.00000000e+00]
 [-8.73985842e-03  2.00255314e-02]]
grads:  [ -0.0257756 -17.5073865]
Stock Position:  -0.02577560014417382
Bond Position:  [9.68625038]


portfolio before change:  [7.11256719]
curr_Stock_Price:  99.89657025104795
curr_Factors:  [9.98965703e+01 4.64472854e-02]
mat_Sqrt:  [[ 2.15293415e+01  0.00000000e+00]
 [-8.62065291e-03  1.97523973e-02]]
grads:  [3.28518217e-03 1.52190349e+01]
Stock Position:  0.003285182165988447
Bond Position:  [6.78438876]


portfolio before change:  [7.11312365]
curr_Stock_Price:  99.80779368636897
curr_Factors:  [9.98077937e+01 4.90033277e-02]
mat_Sqrt:  [[ 2.20941471e+01  0.00000000e+00]
 [-8.85467810e-03  2.02886163e-02]]
grads:  [-3.27839318e-03  5.79493575e+00]
Stock Position:  -0.003278393178156357
Bond Position:  [7.44033284]


portfolio before change:  [7.12075514]
curr_Stock_Price:  97.76368398485496
curr_Factors:  [9.77636840e+01 5.19191569e-02]
mat_Sqrt:  [[ 2.22762136e+01  0.00000000e+00]
 [-9.11431023e-03  2.08835083e-02]]
grads:  [0.03192747 1.0395541 ]
Stock Position:  0.03192747091153161
Bond Position:  [3.99940796]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.16543592]
Stock Price:  99.14747093037437
PL:  [7.16543592]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.12118034e-01 -1.11305725e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.82396203e-01 -8.42902298e-01]
 [-2.84888835e-02  1.62500794e-01]
 [ 3.80750874e-02 -2.78310609e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-3.27379195e-02  2.19359341e-01]
 [ 4.45431978e-02 -5.11340870e-02]
 [ 1.61491038e-01  7.74825753e-02]
 [ 2.63190906e-01 -1.09277439e-01]
 [ 1.32447213e-01  2.42673738e-01]
 [ 1.87363585e-01  2.37564883e-01]
 [ 1.74967752e-01  2.82264890e-02]
 [-1.97431343e-01 -2.62225063e-01]
 [ 8.59423188e-02  2.30071715e-01]
 [ 5.29811891e-02 -1.97551336e-02]
 [-5.21061964e-02  2.22066117e-01]
 [-1.48024925e-01  1.27084458e-02]
 [ 1.48886070e-02  6.61196939e-02]
 [-8.18340079e-02 -3.90216517e-02]
 [ 2.34964689e-01  1.79242820e-01]
 [ 3.64379650e-02  6.52051950e-03]
 [ 3.54276546e-03  1.97484116e-01]
 [ 4.90302063e-02  1.73772593e-01]
 [ 3.35571656e-02  7.53461481e-02]
 [ 7.11991327e-01 -2.88144517e-01]
 [-6.21523428e-02  1.03567996e-01]
 [-6.23387618e-02  8.22853327e-02]
 [ 2.37499059e-02 -1.27538279e-01]
 [-4.09498533e-02 -3.68081924e-02]
 [-5.48896063e-01 -1.01012121e-01]
 [-1.18008465e-01  2.83850641e-03]
 [ 1.12017447e-01  7.37825976e-02]
 [ 1.57001937e-01  6.33744694e-02]
 [-2.88888601e-01 -1.59768954e-01]
 [-2.42134688e-01 -3.85973795e-01]
 [-8.60212533e-02  2.82327511e-01]
 [-1.23454266e-01  1.17767762e-01]
 [ 1.99198299e-01  8.02166188e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.3156173]
curr_Stock_Price:  98.79154420635139
curr_Factors:  [9.87915442e+01 4.18163522e-02]
mat_Sqrt:  [[ 2.02019293e+01  0.00000000e+00]
 [-8.17961879e-03  1.87418611e-02]]
grads:  [-0.01785452 -5.93888325]
Stock Position:  -0.01785452418084738
Bond Position:  [-3.55174128]


portfolio before change:  [-5.30053659]
curr_Stock_Price:  97.92203348446301
curr_Factors:  [9.79220335e+01 4.31767406e-02]
mat_Sqrt:  [[ 2.03472326e+01  0.00000000e+00]
 [-8.31160544e-03  1.90442805e-02]]
grads:  [-0.00997602 -4.62140694]
Stock Position:  -0.009976022369053053
Bond Position:  [-4.3236642]


portfolio before change:  [-5.29472803]
curr_Stock_Price:  97.2856021646668
curr_Factors:  [9.72856022e+01 4.26938004e-02]
mat_Sqrt:  [[ 2.01016163e+01  0.00000000e+00]
 [-8.26499127e-03  1.89374741e-02]]
grads:  [ 2.55961248e-02 -4.45097533e+01]
Stock Position:  0.02559612483171687
Bond Position:  [-7.78486245]


portfolio before change:  [-5.27808759]
curr_Stock_Price:  97.9737381275631
curr_Factors:  [9.79737381e+01 4.03156980e-02]
mat_Sqrt:  [[ 1.96719209e+01  0.00000000e+00]
 [-8.03150776e-03  1.84024961e-02]]
grads:  [2.15699715e-03 8.83036699e+00]
Stock Position:  0.002156997153645402
Bond Position:  [-5.48941666]


portfolio before change:  [-5.27728891]
curr_Stock_Price:  98.66214645044884
curr_Factors:  [9.86621465e+01 4.07668246e-02]
mat_Sqrt:  [[ 1.99206728e+01  0.00000000e+00]
 [-8.07631843e-03  1.85051703e-02]]
grads:  [ 1.30159342e-03 -1.50396135e+00]
Stock Position:  0.0013015934211920597
Bond Position:  [-5.40570691]


portfolio before change:  [-5.27726056]
curr_Stock_Price:  99.20310124514793
curr_Factors:  [9.92031012e+01 4.20438996e-02]
mat_Sqrt:  [[ 2.03412082e+01  0.00000000e+00]
 [-8.20184366e-03  1.87927847e-02]]
grads:  [-0.00582172 -3.52885052]
Stock Position:  -0.0058217177019845735
Bond Position:  [-4.69972811]


portfolio before change:  [-5.27842169]
curr_Stock_Price:  99.30163368354191
curr_Factors:  [9.93016337e+01 4.45253482e-02]
mat_Sqrt:  [[ 2.09536679e+01  0.00000000e+00]
 [-8.44041214e-03  1.93394138e-02]]
grads:  [3.00655457e-03 1.13426055e+01]
Stock Position:  0.003006554569140954
Bond Position:  [-5.57697748]


portfolio before change:  [-5.27816078]
curr_Stock_Price:  99.62029749972153
curr_Factors:  [9.96202975e+01 4.59103430e-02]
mat_Sqrt:  [[ 2.13453413e+01  0.00000000e+00]
 [-8.57067960e-03  1.96378940e-02]]
grads:  [ 1.04127886e-03 -2.60384780e+00]
Stock Position:  0.001041278857512553
Bond Position:  [-5.38189329]


portfolio before change:  [-5.27929101]
curr_Stock_Price:  99.18097994461012
curr_Factors:  [9.91809799e+01 4.60588381e-02]
mat_Sqrt:  [[ 2.12855504e+01  0.00000000e+00]
 [-8.58452917e-03  1.96696274e-02]]
grads:  [0.00917558 3.93919895]
Stock Position:  0.009175577001321246
Bond Position:  [-6.18933373]


portfolio before change:  [-5.2754022]
curr_Stock_Price:  99.68912570166916
curr_Factors:  [9.96891257e+01 4.57951149e-02]
mat_Sqrt:  [[ 2.13332667e+01  0.00000000e+00]
 [-8.55991728e-03  1.96132344e-02]]
grads:  [ 0.01010152 -5.57161743]
Stock Position:  0.010101515348625637
Bond Position:  [-6.28241343]


portfolio before change:  [-5.29332034]
curr_Stock_Price:  97.9930642708826
curr_Factors:  [9.79930643e+01 4.63341579e-02]
mat_Sqrt:  [[ 2.10933702e+01  0.00000000e+00]
 [-8.61014824e-03  1.97283280e-02]]
grads:  [1.13001722e-02 1.23007757e+01]
Stock Position:  0.011300172179627532
Bond Position:  [-6.40065884]


portfolio before change:  [-5.30174822]
curr_Stock_Price:  97.31805243335144
curr_Factors:  [9.73180524e+01 4.87214160e-02]
mat_Sqrt:  [[ 2.14809439e+01  0.00000000e+00]
 [-8.82917129e-03  2.02301729e-02]]
grads:  [ 0.013549   11.74309704]
Stock Position:  0.01354900427451411
Bond Position:  [-6.62031093]


portfolio before change:  [-5.29926888]
curr_Stock_Price:  97.5621241819308
curr_Factors:  [9.75621242e+01 4.77848600e-02]
mat_Sqrt:  [[ 2.13268349e+01  0.00000000e+00]
 [-8.74389936e-03  2.00347903e-02]]
grads:  [0.00878174 1.40887369]
Stock Position:  0.008781743903549966
Bond Position:  [-6.15603447]


portfolio before change:  [-5.29765551]
curr_Stock_Price:  97.83347391048557
curr_Factors:  [9.78334739e+01 4.74325882e-02]
mat_Sqrt:  [[ 2.13071757e+01  0.00000000e+00]
 [-8.71160956e-03  1.99608051e-02]]
grads:  [ -0.01463712 -13.13699832]
Stock Position:  -0.014637122604367708
Bond Position:  [-3.86565496]


portfolio before change:  [-5.30429149]
curr_Stock_Price:  98.25382594201555
curr_Factors:  [9.82538259e+01 4.66505099e-02]
mat_Sqrt:  [[ 2.12215777e+01  0.00000000e+00]
 [-8.63949164e-03  1.97955622e-02]]
grads:  [8.78133802e-03 1.16223885e+01]
Stock Position:  0.008781338019450252
Bond Position:  [-6.16709155]


portfolio before change:  [-5.29343605]
curr_Stock_Price:  99.57781253578435
curr_Factors:  [9.95778125e+01 4.49989064e-02]
mat_Sqrt:  [[ 2.11233873e+01  0.00000000e+00]
 [-8.48517827e-03  1.94419858e-02]]
grads:  [ 0.00210001 -1.01610678]
Stock Position:  0.0021000108266057012
Bond Position:  [-5.50255054]


portfolio before change:  [-5.29274312]
curr_Stock_Price:  100.23533051951793
curr_Factors:  [1.00235331e+02 4.62394616e-02]
mat_Sqrt:  [[ 2.15539669e+01  0.00000000e+00]
 [-8.60134516e-03  1.97081576e-02]]
grads:  [2.07903274e-03 1.12677258e+01]
Stock Position:  0.0020790327408587344
Bond Position:  [-5.50113565]


portfolio before change:  [-5.29200341]
curr_Stock_Price:  100.9218971212355
curr_Factors:  [1.00921897e+02 4.69855013e-02]
mat_Sqrt:  [[ 2.18759710e+01  0.00000000e+00]
 [-8.67045570e-03  1.98665098e-02]]
grads:  [-0.00651301  0.63969192]
Stock Position:  -0.006513013967764003
Bond Position:  [-4.63469768]


portfolio before change:  [-5.29911494]
curr_Stock_Price:  101.92483656828517
curr_Factors:  [1.01924837e+02 4.75582196e-02]
mat_Sqrt:  [[ 2.22276125e+01  0.00000000e+00]
 [-8.72313885e-03  1.99872220e-02]]
grads:  [1.96807494e-03 3.30809823e+00]
Stock Position:  0.0019680749367233653
Bond Position:  [-5.49971066]


portfolio before change:  [-5.29993314]
curr_Stock_Price:  101.85843267321337
curr_Factors:  [1.01858433e+02 4.66055267e-02]
mat_Sqrt:  [[ 2.19895175e+01  0.00000000e+00]
 [-8.63532528e-03  1.97860159e-02]]
grads:  [-0.00449598 -1.97218338]
Stock Position:  -0.0044959810041685
Bond Position:  [-4.84197956]


portfolio before change:  [-5.30478647]
curr_Stock_Price:  102.80328734932618
curr_Factors:  [1.02803287e+02 4.63390690e-02]
mat_Sqrt:  [[ 2.21299613e+01  0.00000000e+00]
 [-8.61060454e-03  1.97293735e-02]]
grads:  [0.01415243 9.08507405]
Stock Position:  0.014152427291004533
Bond Position:  [-6.75970252]


portfolio before change:  [-5.29376677]
curr_Stock_Price:  103.64163911572871
curr_Factors:  [1.03641639e+02 4.64403027e-02]
mat_Sqrt:  [[ 2.23347859e+01  0.00000000e+00]
 [-8.62000489e-03  1.97509125e-02]]
grads:  [0.00175886 0.33013763]
Stock Position:  0.0017588596177855263
Bond Position:  [-5.47605787]


portfolio before change:  [-5.29561328]
curr_Stock_Price:  102.98100976589173
curr_Factors:  [1.02981010e+02 4.76446949e-02]
mat_Sqrt:  [[ 2.24783496e+01  0.00000000e+00]
 [-8.73106590e-03  2.00053852e-02]]
grads:  [3.99192562e-03 9.87154777e+00]
Stock Position:  0.003991925622909916
Bond Position:  [-5.70670581]


portfolio before change:  [-5.2971398]
curr_Stock_Price:  102.77731344474137
curr_Factors:  [1.02777313e+02 4.72315093e-02]
mat_Sqrt:  [[ 2.23363997e+01  0.00000000e+00]
 [-8.69312457e-03  1.99184507e-02]]
grads:  [5.59046154e-03 8.72420228e+00]
Stock Position:  0.005590461535242253
Bond Position:  [-5.87171242]


portfolio before change:  [-5.30348869]
curr_Stock_Price:  101.77294535301903
curr_Factors:  [1.01772945e+02 4.76637297e-02]
mat_Sqrt:  [[ 2.22190944e+01  0.00000000e+00]
 [-8.73280983e-03  2.00093810e-02]]
grads:  [2.99026230e-03 3.76554117e+00]
Stock Position:  0.0029902623049442934
Bond Position:  [-5.60781649]


portfolio before change:  [-5.30478755]
curr_Stock_Price:  101.57301605345037
curr_Factors:  [1.01573016e+02 4.81802742e-02]
mat_Sqrt:  [[ 2.22952826e+01  0.00000000e+00]
 [-8.78000220e-03  2.01175124e-02]]
grads:  [  0.02629412 -14.32306896]
Stock Position:  0.026294116097493235
Bond Position:  [-7.97556023]


portfolio before change:  [-5.31320593]
curr_Stock_Price:  101.29077174559822
curr_Factors:  [1.01290772e+02 4.96198786e-02]
mat_Sqrt:  [[ 2.25630460e+01  0.00000000e+00]
 [-8.91020795e-03  2.04158512e-02]]
grads:  [-7.51297658e-04  5.07292079e+00]
Stock Position:  -0.0007512976584351522
Bond Position:  [-5.23710641]


portfolio before change:  [-5.31349631]
curr_Stock_Price:  100.8058868318147
curr_Factors:  [1.00805887e+02 5.02566966e-02]
mat_Sqrt:  [[ 2.25986692e+01  0.00000000e+00]
 [-8.96720216e-03  2.05464413e-02]]
grads:  [-1.16938295e-03  4.00484597e+00]
Stock Position:  -0.0011693829477023134
Bond Position:  [-5.19561563]


portfolio before change:  [-5.31579447]
curr_Stock_Price:  102.21575016333185
curr_Factors:  [1.02215750e+02 4.94992266e-02]
mat_Sqrt:  [[ 2.27413911e+01  0.00000000e+00]
 [-8.89936866e-03  2.03910153e-02]]
grads:  [-1.40327223e-03 -6.25463115e+00]
Stock Position:  -0.0014032722303103826
Bond Position:  [-5.17235795]


portfolio before change:  [-5.31510132]
curr_Stock_Price:  101.26102583398449
curr_Factors:  [1.01261026e+02 5.00084315e-02]
mat_Sqrt:  [[ 2.26445628e+01  0.00000000e+00]
 [-8.94502601e-03  2.04956294e-02]]
grads:  [-0.00251779 -1.79590447]
Stock Position:  -0.002517790520789419
Bond Position:  [-5.06014727]


portfolio before change:  [-5.31543845]
curr_Stock_Price:  101.14368712694342
curr_Factors:  [1.01143687e+02 5.03390595e-02]
mat_Sqrt:  [[ 2.26929695e+01  0.00000000e+00]
 [-8.97454707e-03  2.05632706e-02]]
grads:  [-0.02613062 -4.91225948]
Stock Position:  -0.02613062014263844
Bond Position:  [-2.67249118]


portfolio before change:  [-5.31167988]
curr_Stock_Price:  100.98706433510431
curr_Factors:  [1.00987064e+02 4.94478414e-02]
mat_Sqrt:  [[ 2.24563628e+01  0.00000000e+00]
 [-8.89474823e-03  2.03804285e-02]]
grads:  [-0.00519985  0.13927609]
Stock Position:  -0.005199846467677818
Bond Position:  [-4.78656265]


portfolio before change:  [-5.31481345]
curr_Stock_Price:  101.4746208480225
curr_Factors:  [1.01474621e+02 4.86720209e-02]
mat_Sqrt:  [[ 2.23870633e+01  0.00000000e+00]
 [-8.82469452e-03  2.02199153e-02]]
grads:  [0.00644206 3.64900626]
Stock Position:  0.006442060352222346
Bond Position:  [-5.96851909]


portfolio before change:  [-5.31783217]
curr_Stock_Price:  101.12184526239132
curr_Factors:  [1.01121845e+02 4.95910461e-02]
mat_Sqrt:  [[ 2.25188714e+01  0.00000000e+00]
 [-8.90761886e-03  2.04099188e-02]]
grads:  [0.00820027 3.10508189]
Stock Position:  0.008200269903979174
Bond Position:  [-6.14705859]


portfolio before change:  [-5.32014863]
curr_Stock_Price:  100.93306721035812
curr_Factors:  [1.00933067e+02 4.96705670e-02]
mat_Sqrt:  [[ 2.24948463e+01  0.00000000e+00]
 [-8.91475783e-03  2.04262763e-02]]
grads:  [-0.01594221 -7.82173665]
Stock Position:  -0.015942206716517904
Bond Position:  [-3.71105281]


portfolio before change:  [-5.31809883]
curr_Stock_Price:  100.77539116440896
curr_Factors:  [1.00775391e+02 5.12673250e-02]
mat_Sqrt:  [[ 2.28178553e+01  0.00000000e+00]
 [-9.05691559e-03  2.07520006e-02]]
grads:  [-1.79941304e-02 -1.85993535e+01]
Stock Position:  -0.017994130387407395
Bond Position:  [-3.50473331]


portfolio before change:  [-5.32074175]
curr_Stock_Price:  100.89791980452941
curr_Factors:  [1.00897920e+02 5.13784829e-02]
mat_Sqrt:  [[ 2.28703521e+01  0.00000000e+00]
 [-9.06672889e-03  2.07744857e-02]]
grads:  [1.62641021e-03 1.35901083e+01]
Stock Position:  0.0016264102101292192
Bond Position:  [-5.48484316]


portfolio before change:  [-5.32118853]
curr_Stock_Price:  101.04479053089003
curr_Factors:  [1.01044791e+02 5.16228331e-02]
mat_Sqrt:  [[ 2.29580420e+01  0.00000000e+00]
 [-9.08826347e-03  2.08238276e-02]]
grads:  [-3.13860395e-03  5.65543301e+00]
Stock Position:  -0.0031386039466667747
Bond Position:  [-5.00404895]


portfolio before change:  [-5.32198165]
curr_Stock_Price:  101.09818396196853
curr_Factors:  [1.01098184e+02 5.26926849e-02]
mat_Sqrt:  [[ 2.32069742e+01  0.00000000e+00]
 [-9.18195491e-03  2.10385017e-02]]
grads:  [0.01009213 3.81284846]
Stock Position:  0.010092125744115098
Bond Position:  [-6.34227724]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.32568039]
Stock Price:  100.8102466373004
PL:  [-6.13592702]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-7.95559878e-03  2.50651642e-01]
 [-1.78879719e-01 -7.71869887e-02]
 [ 7.87487522e-01 -6.61362782e-01]
 [ 2.45729648e-03  2.42466218e-02]
 [-9.61550782e-02  4.18421455e-02]
 [-8.06476708e-02 -6.27059668e-02]
 [-5.00948557e-03  3.16986298e-01]
 [-3.21214134e-02 -6.89983866e-02]
 [ 1.57425574e-01  7.28684374e-02]
 [ 2.26651193e-01 -7.21542450e-02]
 [ 1.56804460e-01  3.29516738e-01]
 [ 1.69419692e-01  2.65513896e-01]
 [ 2.25221405e-01  2.18724069e-02]
 [-1.69720135e-01 -1.92568750e-01]
 [ 8.18214124e-02  2.26756013e-01]
 [ 5.28185751e-02 -1.96515237e-02]
 [-4.72747105e-02  1.35103776e-01]
 [ 1.19373863e-02  5.23263185e-02]
 [ 8.48807452e-03  5.02206147e-02]
 [ 2.64184989e-01 -1.10275492e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-9.26833195e-03  1.60364207e-01]
 [ 1.29930658e-03  1.70677346e-02]
 [-2.21810408e-02 -1.67011775e-02]
 [ 4.86342189e-02  1.39696815e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.69317629e-01  1.13689389e-01]
 [-2.72141166e-01 -5.82647967e-04]
 [ 1.84682765e-01 -8.94868299e-02]
 [-1.24334633e+00 -1.39854486e-01]
 [ 5.67673625e-02  2.77105151e-01]
 [-9.34954618e-03 -1.21433802e-01]
 [ 8.26598205e-02  1.01515257e-01]
 [-2.03429987e-01  9.28059606e-03]
 [-4.67735447e-01 -3.36151222e-01]
 [-7.00226675e-02  2.96609059e-01]
 [-1.23690032e-01  1.17608710e-01]
 [ 2.62919040e-01  7.22741846e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.51643414]
curr_Stock_Price:  99.82056173228784
curr_Factors:  [9.98205617e+01 4.07225326e-02]
mat_Sqrt:  [[ 2.01436144e+01  0.00000000e+00]
 [-8.07192989e-03  1.84951149e-02]]
grads:  [5.03572716e-03 1.35523160e+01]
Stock Position:  0.005035727156609348
Bond Position:  [1.01376503]


portfolio before change:  [1.52013121]
curr_Stock_Price:  100.52956356493696
curr_Factors:  [1.00529564e+02 4.05385818e-02]
mat_Sqrt:  [[ 2.02408186e+01  0.00000000e+00]
 [-8.05367810e-03  1.84532948e-02]]
grads:  [-0.01050189 -4.18282967]
Stock Position:  -0.010501891598758285
Bond Position:  [2.57588179]


portfolio before change:  [1.52165325]
curr_Stock_Price:  100.41529482947377
curr_Factors:  [1.00415295e+02 3.92427721e-02]
mat_Sqrt:  [[ 1.98920576e+01  0.00000000e+00]
 [-7.92391541e-03  1.81559711e-02]]
grads:  [ 2.50776039e-02 -3.64267369e+01]
Stock Position:  0.02507760388521099
Bond Position:  [-0.99652174]


portfolio before change:  [1.52535147]
curr_Stock_Price:  100.56773348220456
curr_Factors:  [1.00567733e+02 3.97387136e-02]
mat_Sqrt:  [[ 2.00477466e+01  0.00000000e+00]
 [-7.97382855e-03  1.82703365e-02]]
grads:  [6.50416729e-04 1.32710319e+00]
Stock Position:  0.0006504167293962111
Bond Position:  [1.45994054]


portfolio before change:  [1.52581858]
curr_Stock_Price:  101.00530312434621
curr_Factors:  [1.01005303e+02 3.82921637e-02]
mat_Sqrt:  [[ 1.97651052e+01  0.00000000e+00]
 [-7.82735345e-03  1.79347198e-02]]
grads:  [-0.00394097  2.33302477]
Stock Position:  -0.003940969099095057
Bond Position:  [1.92387736]


portfolio before change:  [1.52792027]
curr_Stock_Price:  100.53303489700697
curr_Factors:  [1.00533035e+02 3.85018539e-02]
mat_Sqrt:  [[ 1.97264808e+01  0.00000000e+00]
 [-7.84875571e-03  1.79837586e-02]]
grads:  [-0.00547562 -3.48681098]
Stock Position:  -0.005475624337185577
Bond Position:  [2.07840141]


portfolio before change:  [1.52827691]
curr_Stock_Price:  100.51535305407815
curr_Factors:  [1.00515353e+02 3.96973363e-02]
mat_Sqrt:  [[ 2.00268703e+01  0.00000000e+00]
 [-7.96967616e-03  1.82608221e-02]]
grads:  [6.65778899e-03 1.73588186e+01]
Stock Position:  0.006657788994922419
Bond Position:  [0.8590669]


portfolio before change:  [1.51939201]
curr_Stock_Price:  99.1647111180746
curr_Factors:  [9.91647111e+01 3.96471502e-02]
mat_Sqrt:  [[ 1.97452728e+01  0.00000000e+00]
 [-7.96463686e-03  1.82492757e-02]]
grads:  [-3.15188240e-03 -3.78088358e+00]
Stock Position:  -0.0031518824049412727
Bond Position:  [1.83194752]


portfolio before change:  [1.51792947]
curr_Stock_Price:  99.70138993773567
curr_Factors:  [9.97013899e+01 3.74271365e-02]
mat_Sqrt:  [[ 1.92883249e+01  0.00000000e+00]
 [-7.73843773e-03  1.77309883e-02]]
grads:  [0.00981049 4.10966586]
Stock Position:  0.009810492528955137
Bond Position:  [0.53980973]


portfolio before change:  [1.51398237]
curr_Stock_Price:  99.29217743685174
curr_Factors:  [9.92921774e+01 3.82132952e-02]
mat_Sqrt:  [[ 1.94098545e+01  0.00000000e+00]
 [-7.81928848e-03  1.79162407e-02]]
grads:  [ 0.01005471 -4.02730943]
Stock Position:  0.010054712095054262
Bond Position:  [0.51562812]


portfolio before change:  [1.48890109]
curr_Stock_Price:  96.7912860551527
curr_Factors:  [9.67912861e+01 4.04106482e-02]
mat_Sqrt:  [[ 1.94573714e+01  0.00000000e+00]
 [-8.04095996e-03  1.84241538e-02]]
grads:  [1.54500497e-02 1.78850405e+01]
Stock Position:  0.015450049703685659
Bond Position:  [-0.00652909]


portfolio before change:  [1.48140414]
curr_Stock_Price:  96.30610089238819
curr_Factors:  [9.63061009e+01 4.03146671e-02]
mat_Sqrt:  [[ 1.93368327e+01  0.00000000e+00]
 [-8.03140507e-03  1.84022608e-02]]
grads:  [ 0.0147542  14.42833019]
Stock Position:  0.014754197923485651
Bond Position:  [0.06048486]


portfolio before change:  [1.48416532]
curr_Stock_Price:  96.4927340202865
curr_Factors:  [9.64927340e+01 3.93531889e-02]
mat_Sqrt:  [[ 1.91418795e+01  0.00000000e+00]
 [-7.93505528e-03  1.81814957e-02]]
grads:  [0.01226459 1.20300372]
Stock Position:  0.012264590133276744
Bond Position:  [0.30072149]


portfolio before change:  [1.49154253]
curr_Stock_Price:  97.09117366137814
curr_Factors:  [9.70911737e+01 3.70713775e-02]
mat_Sqrt:  [[ 1.86938655e+01  0.00000000e+00]
 [-7.70157153e-03  1.76465173e-02]]
grads:  [ -0.01357472 -10.91256408]
Stock Position:  -0.013574722051365614
Bond Position:  [2.80952823]


portfolio before change:  [1.46111248]
curr_Stock_Price:  99.35871667089606
curr_Factors:  [9.93587167e+01 3.66453999e-02]
mat_Sqrt:  [[ 1.90202275e+01  0.00000000e+00]
 [-7.65719530e-03  1.75448385e-02]]
grads:  [9.50492577e-03 1.29243716e+01]
Stock Position:  0.009504925768986254
Bond Position:  [0.51671525]


portfolio before change:  [1.46141276]
curr_Stock_Price:  99.3835128688529
curr_Factors:  [9.93835129e+01 3.69827285e-02]
mat_Sqrt:  [[ 1.91123380e+01  0.00000000e+00]
 [-7.69235761e-03  1.76254055e-02]]
grads:  [ 0.00231484 -1.11495441]
Stock Position:  0.0023148369879025057
Bond Position:  [1.23135613]


portfolio before change:  [1.46116767]
curr_Stock_Price:  99.2111404542475
curr_Factors:  [9.92111405e+01 3.46218772e-02]
mat_Sqrt:  [[ 1.84601722e+01  0.00000000e+00]
 [-7.44278197e-03  1.70535559e-02]]
grads:  [6.33223316e-04 7.92232288e+00]
Stock Position:  0.0006332233159187692
Bond Position:  [1.39834486]


portfolio before change:  [1.46056962]
curr_Stock_Price:  97.99062364054083
curr_Factors:  [9.79906236e+01 3.51256296e-02]
mat_Sqrt:  [[ 1.83652388e+01  0.00000000e+00]
 [-7.49673311e-03  1.71771735e-02]]
grads:  [1.8934937e-03 3.0462706e+00]
Stock Position:  0.0018934936992386735
Bond Position:  [1.27502499]


portfolio before change:  [1.4577669]
curr_Stock_Price:  96.42626642919141
curr_Factors:  [9.64262664e+01 3.70559124e-02]
mat_Sqrt:  [[ 1.85619717e+01  0.00000000e+00]
 [-7.69996493e-03  1.76428361e-02]]
grads:  [1.63808824e-03 2.84651597e+00]
Stock Position:  0.0016380882439800046
Bond Position:  [1.29981217]


portfolio before change:  [1.45675944]
curr_Stock_Price:  95.71204797376396
curr_Factors:  [9.57120480e+01 3.57811951e-02]
mat_Sqrt:  [[ 1.81048124e+01  0.00000000e+00]
 [-7.56636717e-03  1.73367251e-02]]
grads:  [ 0.01193367 -6.36080294]
Stock Position:  0.011933667892978657
Bond Position:  [0.31456364]


portfolio before change:  [1.45759643]
curr_Stock_Price:  95.7788899686938
curr_Factors:  [9.57788900e+01 3.67862984e-02]
mat_Sqrt:  [[ 1.83701560e+01  0.00000000e+00]
 [-7.67190181e-03  1.75785354e-02]]
grads:  [ 0.00229332 -2.14909768]
Stock Position:  0.002293318065929334
Bond Position:  [1.23794497]


portfolio before change:  [1.45689379]
curr_Stock_Price:  95.40502423408778
curr_Factors:  [9.54050242e+01 3.68987560e-02]
mat_Sqrt:  [[ 1.83263978e+01  0.00000000e+00]
 [-7.68361956e-03  1.76053841e-02]]
grads:  [3.31327230e-03 9.10881616e+00]
Stock Position:  0.0033132722993443617
Bond Position:  [1.14079097]


portfolio before change:  [1.45507972]
curr_Stock_Price:  94.81446563257387
curr_Factors:  [9.48144656e+01 3.68515953e-02]
mat_Sqrt:  [[ 1.82013143e+01  0.00000000e+00]
 [-7.67870774e-03  1.75941297e-02]]
grads:  [4.80639834e-04 9.70081209e-01]
Stock Position:  0.0004806398340760131
Bond Position:  [1.40950811]


portfolio before change:  [1.45519768]
curr_Stock_Price:  94.69330038254375
curr_Factors:  [9.46933004e+01 3.59427169e-02]
mat_Sqrt:  [[ 1.79524904e+01  0.00000000e+00]
 [-7.58342581e-03  1.73758114e-02]]
grads:  [-0.00164156 -0.96117396]
Stock Position:  -0.0016415567698728165
Bond Position:  [1.61064211]


portfolio before change:  [1.45480502]
curr_Stock_Price:  95.05515506871252
curr_Factors:  [9.50551551e+01 3.67216978e-02]
mat_Sqrt:  [[ 1.82153303e+01  0.00000000e+00]
 [-7.66516252e-03  1.75630937e-02]]
grads:  [6.01706945e-03 7.95399816e+00]
Stock Position:  0.006017069449989034
Bond Position:  [0.88285155]


portfolio before change:  [1.44681837]
curr_Stock_Price:  93.709481882409
curr_Factors:  [9.37094819e+01 3.73295048e-02]
mat_Sqrt:  [[ 1.81054637e+01  0.00000000e+00]
 [-7.72833797e-03  1.77078469e-02]]
grads:  [6.93076096e-03 1.02817989e+01]
Stock Position:  0.0069307609561637985
Bond Position:  [0.79734035]


portfolio before change:  [1.45216925]
curr_Stock_Price:  94.46714839815583
curr_Factors:  [9.44671484e+01 3.72549077e-02]
mat_Sqrt:  [[ 1.82336054e+01  0.00000000e+00]
 [-7.72061217e-03  1.76901448e-02]]
grads:  [9.77105715e-03 9.88897468e+00]
Stock Position:  0.009771057153435316
Bond Position:  [0.52912534]


portfolio before change:  [1.46513559]
curr_Stock_Price:  95.78739377772472
curr_Factors:  [9.57873938e+01 3.51993927e-02]
mat_Sqrt:  [[ 1.79711530e+01  0.00000000e+00]
 [-7.50460048e-03  1.71951999e-02]]
grads:  [-0.00666065  6.61169337]
Stock Position:  -0.006660647302100364
Bond Position:  [2.10314163]


portfolio before change:  [1.46909581]
curr_Stock_Price:  95.23229617640547
curr_Factors:  [9.52322962e+01 3.59120010e-02]
mat_Sqrt:  [[ 1.80469601e+01  0.00000000e+00]
 [-7.58018480e-03  1.73683853e-02]]
grads:  [-0.0150937  -0.03354647]
Stock Position:  -0.015093702952909103
Bond Position:  [2.9065038]


portfolio before change:  [1.46983087]
curr_Stock_Price:  95.20766803262117
curr_Factors:  [9.52076680e+01 3.64017317e-02]
mat_Sqrt:  [[ 1.81648974e+01  0.00000000e+00]
 [-7.63169514e-03  1.74864103e-02]]
grads:  [ 0.00801697 -5.11750715]
Stock Position:  0.00801697400170725
Bond Position:  [0.70655347]


portfolio before change:  [1.46185704]
curr_Stock_Price:  94.20203221148982
curr_Factors:  [9.42020322e+01 3.82974639e-02]
mat_Sqrt:  [[ 1.84350907e+01  0.00000000e+00]
 [-7.82789514e-03  1.79359610e-02]]
grads:  [-0.07075549 -7.79743477]
Stock Position:  -0.07075548719290277
Bond Position:  [8.12716773]


portfolio before change:  [1.4557622]
curr_Stock_Price:  94.30253044889405
curr_Factors:  [9.43025304e+01 3.72535041e-02]
mat_Sqrt:  [[ 1.82014887e+01  0.00000000e+00]
 [-7.72046673e-03  1.76898116e-02]]
grads:  [9.76326543e-03 1.56646751e+01]
Stock Position:  0.009763265427028591
Bond Position:  [0.53506156]


portfolio before change:  [1.46836341]
curr_Stock_Price:  95.58635569290361
curr_Factors:  [9.55863557e+01 3.64407769e-02]
mat_Sqrt:  [[ 1.82469263e+01  0.00000000e+00]
 [-7.63578700e-03  1.74957860e-02]]
grads:  [-3.41688246e-03 -6.94074576e+00]
Stock Position:  -0.0034168824599205404
Bond Position:  [1.79497075]


portfolio before change:  [1.45902031]
curr_Stock_Price:  98.38642037474882
curr_Factors:  [9.83864204e+01 3.40885958e-02]
mat_Sqrt:  [[ 1.81651804e+01  0.00000000e+00]
 [-7.38523887e-03  1.69217081e-02]]
grads:  [0.00698945 5.99911405]
Stock Position:  0.00698945498522294
Bond Position:  [0.77135285]


portfolio before change:  [1.46585695]
curr_Stock_Price:  99.35076192135254
curr_Factors:  [9.93507619e+01 3.40683200e-02]
mat_Sqrt:  [[ 1.83377717e+01  0.00000000e+00]
 [-7.38304219e-03  1.69166748e-02]]
grads:  [-0.01087262  0.5486064 ]
Stock Position:  -0.010872618876301986
Bond Position:  [2.54605992]


portfolio before change:  [1.46736237]
curr_Stock_Price:  99.24157556475362
curr_Factors:  [9.92415756e+01 3.32344492e-02]
mat_Sqrt:  [[ 1.80920547e+01  0.00000000e+00]
 [-7.29212717e-03  1.67083624e-02]]
grads:  [ -0.03396208 -20.11874143]
Stock Position:  -0.03396208320504173
Bond Position:  [4.83781302]


portfolio before change:  [1.43482487]
curr_Stock_Price:  100.21743646773533
curr_Factors:  [1.00217436e+02 3.31142734e-02]
mat_Sqrt:  [[ 1.82368953e+01  0.00000000e+00]
 [-7.27893107e-03  1.66781263e-02]]
grads:  [3.25867631e-03 1.77843154e+01]
Stock Position:  0.0032586763054473847
Bond Position:  [1.10824868]


portfolio before change:  [1.43424601]
curr_Stock_Price:  99.99728634598061
curr_Factors:  [9.99972863e+01 3.29978711e-02]
mat_Sqrt:  [[ 1.81648232e+01  0.00000000e+00]
 [-7.26612646e-03  1.66487873e-02]]
grads:  [-3.98359960e-03  7.06410073e+00]
Stock Position:  -0.003983599601586158
Bond Position:  [1.83259516]


portfolio before change:  [1.43157378]
curr_Stock_Price:  100.72560273865564
curr_Factors:  [1.00725603e+02 3.31737812e-02]
mat_Sqrt:  [[ 1.83458299e+01  0.00000000e+00]
 [-7.28546840e-03  1.66931052e-02]]
grads:  [0.01605063 4.329583  ]
Stock Position:  0.016050627423092878
Bond Position:  [-0.18513534]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.42877331]
Stock Price:  100.55256784850371
PL:  [0.87620547]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.96487592e-01 -1.83113714e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.50162921e-01 -7.66801060e-01]
 [-3.18309999e-02  1.46863138e-01]
 [ 3.68043662e-02 -4.54745590e-02]
 [-8.09082793e-02 -1.01282017e-01]
 [-6.58329428e-02  1.72621474e-01]
 [-1.23290586e-01 -9.61166362e-02]
 [ 1.65860822e-01  1.05445798e-01]
 [ 1.15571796e-01  6.56000969e-02]
 [ 1.31202167e-01  2.38234668e-01]
 [ 1.64650435e-01  2.19172261e-01]
 [ 1.59254931e-01  3.79160249e-02]
 [-2.53260558e-01 -3.28740697e-01]
 [ 8.11566738e-02  2.26204681e-01]
 [ 5.22637570e-02 -1.92980199e-02]
 [-4.56517848e-02  1.19705070e-01]
 [-8.65638477e-02  1.05900787e-02]
 [ 1.52071266e-02  5.82108027e-02]
 [ 3.00999032e-02 -9.52228287e-02]
 [ 9.54137411e-02  1.77731564e-04]
 [ 5.77277547e-02  2.98167065e-01]
 [ 3.70229672e-02  3.40615443e-01]
 [-1.46056456e-03  1.55812094e-01]
 [ 2.15678878e-02  5.05605673e-02]
 [ 6.47287943e-01 -2.05638297e-01]
 [ 1.46062631e-02  6.19996610e-02]
 [ 6.15274955e-02  2.76118465e-02]
 [ 3.06601648e-03 -1.08835525e-01]
 [-7.23291126e-02 -2.96578852e-02]
 [-4.64950037e-01 -9.81502660e-02]
 [-1.17975553e-01  1.56088761e-03]
 [ 1.61483157e-01  1.56212923e-01]
 [ 1.83589334e-01  4.97339615e-02]
 [-2.39204487e-01 -2.04812043e-01]
 [ 1.22493841e-01 -2.64041355e-01]
 [-1.70880759e-01  2.06763551e-01]
 [-1.18836960e-01  1.20882692e-01]
 [-8.73576303e-02  1.21777973e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.78242]
curr_Stock_Price:  98.42000379304173
curr_Factors:  [9.84200038e+01 3.81764954e-02]
mat_Sqrt:  [[ 1.92300940e+01  0.00000000e+00]
 [-7.81552255e-03  1.79076118e-02]]
grads:  [ -0.02477393 -10.22546811]
Stock Position:  -0.024773928293690076
Bond Position:  [-5.34416988]


portfolio before change:  [-7.8142231]
curr_Stock_Price:  99.67676995117243
curr_Factors:  [9.96767700e+01 3.63397822e-02]
mat_Sqrt:  [[ 1.90013788e+01  0.00000000e+00]
 [-7.62519845e-03  1.74715246e-02]]
grads:  [-0.01068262 -5.03741788]
Stock Position:  -0.01068261677818947
Bond Position:  [-6.74941436]


portfolio before change:  [-7.80315084]
curr_Stock_Price:  98.56131392151015
curr_Factors:  [9.85613139e+01 3.54126180e-02]
mat_Sqrt:  [[ 1.85475052e+01  0.00000000e+00]
 [-7.52729625e-03  1.72472024e-02]]
grads:  [ 2.77936842e-02 -4.44594457e+01]
Stock Position:  0.027793684193027093
Bond Position:  [-10.54253287]


portfolio before change:  [-7.81418961]
curr_Stock_Price:  98.21156297833801
curr_Factors:  [9.82115630e+01 3.51608834e-02]
mat_Sqrt:  [[ 1.84158815e+01  0.00000000e+00]
 [-7.50049421e-03  1.71857912e-02]]
grads:  [1.75203824e-03 8.54561401e+00]
Stock Position:  0.0017520382359469341
Bond Position:  [-7.98626002]


portfolio before change:  [-7.81517077]
curr_Stock_Price:  98.22136972582497
curr_Factors:  [9.82213697e+01 3.41230822e-02]
mat_Sqrt:  [[ 1.81438778e+01  0.00000000e+00]
 [-7.38897365e-03  1.69302655e-02]]
grads:  [ 9.34620580e-04 -2.68599207e+00]
Stock Position:  0.000934620580183674
Bond Position:  [-7.90697048]


portfolio before change:  [-7.8163923]
curr_Stock_Price:  97.9719671312819
curr_Factors:  [9.79719671e+01 3.41629017e-02]
mat_Sqrt:  [[ 1.81083635e+01  0.00000000e+00]
 [-7.39328362e-03  1.69401409e-02]]
grads:  [-0.00690904 -5.97881787]
Stock Position:  -0.0069090382214993945
Bond Position:  [-7.13950023]


portfolio before change:  [-7.81978937]
curr_Stock_Price:  98.33447473908308
curr_Factors:  [9.83344747e+01 3.27646022e-02]
mat_Sqrt:  [[ 1.77995184e+01  0.00000000e+00]
 [-7.24039802e-03  1.65898360e-02]]
grads:  [5.34016981e-04 1.04052550e+01]
Stock Position:  0.0005340169814205429
Bond Position:  [-7.87230165]


portfolio before change:  [-7.82079424]
curr_Stock_Price:  98.29557507726464
curr_Factors:  [9.82955751e+01 3.16683960e-02]
mat_Sqrt:  [[ 1.74923034e+01  0.00000000e+00]
 [-7.11824652e-03  1.63099517e-02]]
grads:  [-0.0094464  -5.89312817]
Stock Position:  -0.009446401749053345
Bond Position:  [-6.89225475]


portfolio before change:  [-7.81404924]
curr_Stock_Price:  97.49033808976255
curr_Factors:  [9.74903381e+01 2.98381870e-02]
mat_Sqrt:  [[ 1.68402212e+01  0.00000000e+00]
 [-6.90949342e-03  1.58316383e-02]]
grads:  [0.01258185 6.66044763]
Stock Position:  0.012581850201795697
Bond Position:  [-9.04065807]


portfolio before change:  [-7.81112968]
curr_Stock_Price:  97.81220756036686
curr_Factors:  [9.78122076e+01 3.01716339e-02]
mat_Sqrt:  [[ 1.69899647e+01  0.00000000e+00]
 [-6.94799355e-03  1.59198532e-02]]
grads:  [0.00848748 4.12064711]
Stock Position:  0.008487482359589581
Bond Position:  [-8.64130906]


portfolio before change:  [-7.81033349]
curr_Stock_Price:  98.03328790942811
curr_Factors:  [9.80332879e+01 2.93204790e-02]
mat_Sqrt:  [[ 1.67864592e+01  0.00000000e+00]
 [-6.84928948e-03  1.56936938e-02]]
grads:  [1.40098813e-02 1.51802801e+01]
Stock Position:  0.014009881277883867
Bond Position:  [-9.18376822]


portfolio before change:  [-7.81587895]
curr_Stock_Price:  97.71940838517716
curr_Factors:  [9.77194084e+01 3.02523320e-02]
mat_Sqrt:  [[ 1.69965297e+01  0.00000000e+00]
 [-6.95727901e-03  1.59411289e-02]]
grads:  [ 0.01531519 13.74885446]
Stock Position:  0.015315188210860548
Bond Position:  [-9.31247008]


portfolio before change:  [-7.807127]
curr_Stock_Price:  98.3668757235984
curr_Factors:  [9.83668757e+01 2.93556534e-02]
mat_Sqrt:  [[ 1.68536804e+01  0.00000000e+00]
 [-6.85339664e-03  1.57031044e-02]]
grads:  [0.01043112 2.41455599]
Stock Position:  0.010431124622738241
Bond Position:  [-8.83320414]


portfolio before change:  [-7.8081359]
curr_Stock_Price:  98.37601307336612
curr_Factors:  [9.83760131e+01 2.98707138e-02]
mat_Sqrt:  [[ 1.70024700e+01  0.00000000e+00]
 [-6.91325843e-03  1.58402650e-02]]
grads:  [ -0.02333395 -20.75348467]
Stock Position:  -0.023333948531383937
Bond Position:  [-5.51263508]


portfolio before change:  [-7.83599529]
curr_Stock_Price:  99.54042213946188
curr_Factors:  [9.95404221e+01 2.90442510e-02]
mat_Sqrt:  [[ 1.69640510e+01  0.00000000e+00]
 [-6.81694959e-03  1.56195937e-02]]
grads:  [1.06036283e-02 1.44821104e+01]
Stock Position:  0.010603628256740803
Bond Position:  [-8.89148492]


portfolio before change:  [-7.84534192]
curr_Stock_Price:  98.7637886277293
curr_Factors:  [9.87637886e+01 2.85567732e-02]
mat_Sqrt:  [[ 1.66898452e+01  0.00000000e+00]
 [-6.75949977e-03  1.54879597e-02]]
grads:  [ 0.00262683 -1.24600143]
Stock Position:  0.0026268314793453035
Bond Position:  [-8.10477775]


portfolio before change:  [-7.84555008]
curr_Stock_Price:  99.07024261673905
curr_Factors:  [9.90702426e+01 2.76321074e-02]
mat_Sqrt:  [[ 1.64683554e+01  0.00000000e+00]
 [-6.64916325e-03  1.52351469e-02]]
grads:  [4.00270127e-04 7.85716542e+00]
Stock Position:  0.00040027012670593946
Bond Position:  [-7.88520494]


portfolio before change:  [-7.84627504]
curr_Stock_Price:  99.72169049323809
curr_Factors:  [9.97216905e+01 2.68011374e-02]
mat_Sqrt:  [[ 1.63254907e+01  0.00000000e+00]
 [-6.54842117e-03  1.50043178e-02]]
grads:  [-0.00501926  0.70580208]
Stock Position:  -0.00501926464651826
Bond Position:  [-7.34574548]


portfolio before change:  [-7.84662345]
curr_Stock_Price:  99.60815444270398
curr_Factors:  [9.96081544e+01 2.69715495e-02]
mat_Sqrt:  [[ 1.63586644e+01  0.00000000e+00]
 [-6.56920689e-03  1.50519439e-02]]
grads:  [2.48262345e-03 3.86732790e+00]
Stock Position:  0.0024826234478272265
Bond Position:  [-8.09391299]


portfolio before change:  [-7.848672]
curr_Stock_Price:  99.1905511964153
curr_Factors:  [9.91905512e+01 2.70867534e-02]
mat_Sqrt:  [[ 1.63248342e+01  0.00000000e+00]
 [-6.58322150e-03  1.50840554e-02]]
grads:  [-7.01921147e-04 -6.31281349e+00]
Stock Position:  -0.0007019211467731827
Bond Position:  [-7.77904806]


portfolio before change:  [-7.8500064]
curr_Stock_Price:  99.70621060953123
curr_Factors:  [9.97062106e+01 2.65011523e-02]
mat_Sqrt:  [[ 1.62313480e+01  0.00000000e+00]
 [-6.51166981e-03  1.49201099e-02]]
grads:  [0.00588314 0.01191222]
Stock Position:  0.005883141023037956
Bond Position:  [-8.43659209]


portfolio before change:  [-7.85523401]
curr_Stock_Price:  98.99689994112939
curr_Factors:  [9.89968999e+01 2.55948361e-02]
mat_Sqrt:  [[ 1.58379064e+01  0.00000000e+00]
 [-6.39935448e-03  1.46627631e-02]]
grads:  [1.18613235e-02 2.03349848e+01]
Stock Position:  0.011861323468526535
Bond Position:  [-9.02946826]


portfolio before change:  [-7.84836032]
curr_Stock_Price:  99.67156691013022
curr_Factors:  [9.96715669e+01 2.63384915e-02]
mat_Sqrt:  [[ 1.61758360e+01  0.00000000e+00]
 [-6.49165514e-03  1.48742505e-02]]
grads:  [1.14788339e-02 2.28996709e+01]
Stock Position:  0.011478833856809268
Bond Position:  [-8.99247368]


portfolio before change:  [-7.83897161]
curr_Stock_Price:  100.587412347879
curr_Factors:  [1.00587412e+02 2.63864637e-02]
mat_Sqrt:  [[ 1.63393295e+01  0.00000000e+00]
 [-6.49756431e-03  1.48877901e-02]]
grads:  [4.07246873e-03 1.04657638e+01]
Stock Position:  0.004072468729790624
Bond Position:  [-8.2486107]


portfolio before change:  [-7.84008617]
curr_Stock_Price:  100.56693037048116
curr_Factors:  [1.00566930e+02 2.74311617e-02]
mat_Sqrt:  [[ 1.66562524e+01  0.00000000e+00]
 [-6.62494217e-03  1.51796495e-02]]
grads:  [2.61969663e-03 3.33081257e+00]
Stock Position:  0.0026196966327365306
Bond Position:  [-8.10354101]


portfolio before change:  [-7.84077301]
curr_Stock_Price:  100.6914348497774
curr_Factors:  [1.00691435e+02 2.56404022e-02]
mat_Sqrt:  [[ 1.61233376e+01  0.00000000e+00]
 [-6.40504829e-03  1.46758093e-02]]
grads:  [  0.03457969 -14.01205839]
Stock Position:  0.03457969109918496
Bond Position:  [-11.32265172]


portfolio before change:  [-7.86793445]
curr_Stock_Price:  99.94689306040587
curr_Factors:  [9.99468931e+01 2.51346447e-02]
mat_Sqrt:  [[ 1.58454900e+01  0.00000000e+00]
 [-6.34156381e-03  1.45303481e-02]]
grads:  [2.62946324e-03 4.26690817e+00]
Stock Position:  0.0026294632443636837
Bond Position:  [-8.13074113]


portfolio before change:  [-7.86346745]
curr_Stock_Price:  102.03226601836806
curr_Factors:  [1.02032266e+02 2.37835471e-02]
mat_Sqrt:  [[ 1.57353296e+01  0.00000000e+00]
 [-6.16876611e-03  1.41344188e-02]]
grads:  [0.00467599 1.95351835]
Stock Position:  0.004675993135984519
Bond Position:  [-8.34056962]


portfolio before change:  [-7.8618329]
curr_Stock_Price:  102.60480376141587
curr_Factors:  [1.02604804e+02 2.37256721e-02]
mat_Sqrt:  [[ 1.58043615e+01  0.00000000e+00]
 [-6.16125599e-03  1.41172110e-02]]
grads:  [-2.81148346e-03 -7.70942119e+00]
Stock Position:  -0.0028114834563414642
Bond Position:  [-7.57336119]


portfolio before change:  [-7.86166099]
curr_Stock_Price:  102.20691998868058
curr_Factors:  [1.0220692e+02 2.3811309e-02]
mat_Sqrt:  [[ 1.57714614e+01  0.00000000e+00]
 [-6.17236538e-03  1.41426658e-02]]
grads:  [-0.00540678 -2.09705056]
Stock Position:  -0.005406783362269568
Bond Position:  [-7.30905031]


portfolio before change:  [-7.86102086]
curr_Stock_Price:  101.91953776253347
curr_Factors:  [1.01919538e+02 2.28479266e-02]
mat_Sqrt:  [[ 1.54056789e+01  0.00000000e+00]
 [-6.04621224e-03  1.38536126e-02]]
grads:  [-0.03296098 -7.08481381]
Stock Position:  -0.03296098323609052
Bond Position:  [-4.50165269]


portfolio before change:  [-7.85052197]
curr_Stock_Price:  101.58394003354763
curr_Factors:  [1.0158394e+02 2.3252352e-02]
mat_Sqrt:  [[ 1.54902525e+01  0.00000000e+00]
 [-6.09948876e-03  1.39756845e-02]]
grads:  [-0.00757214  0.11168595]
Stock Position:  -0.0075721377715490855
Bond Position:  [-7.08131438]


portfolio before change:  [-7.86491904]
curr_Stock_Price:  103.36835714709238
curr_Factors:  [1.03368357e+02 2.31055866e-02]
mat_Sqrt:  [[ 1.57125298e+01  0.00000000e+00]
 [-6.08020876e-03  1.39315085e-02]]
grads:  [ 0.01461636 11.21292242]
Stock Position:  0.014616364763801662
Bond Position:  [-9.37578866]


portfolio before change:  [-7.861977]
curr_Stock_Price:  103.64982895451463
curr_Factors:  [1.03649829e+02 2.35085968e-02]
mat_Sqrt:  [[ 1.58921240e+01  0.00000000e+00]
 [-6.13300538e-03  1.40524807e-02]]
grads:  [0.01291804 3.53915886]
Stock Position:  0.012918035034670945
Bond Position:  [-9.20092912]


portfolio before change:  [-7.86212028]
curr_Stock_Price:  103.7277743033937
curr_Factors:  [1.03727774e+02 2.36946175e-02]
mat_Sqrt:  [[ 1.59668745e+01  0.00000000e+00]
 [-6.15722243e-03  1.41079689e-02]]
grads:  [ -0.02057959 -14.51747195]
Stock Position:  -0.020579593799933425
Bond Position:  [-5.72744482]


portfolio before change:  [-7.87266573]
curr_Stock_Price:  104.20540620151864
curr_Factors:  [1.04205406e+02 2.36951377e-02]
mat_Sqrt:  [[ 1.60405727e+01  0.00000000e+00]
 [-6.15729002e-03  1.41081238e-02]]
grads:  [ 4.52399441e-04 -1.87155542e+01]
Stock Position:  0.0004523994412873323
Bond Position:  [-7.9198082]


portfolio before change:  [-7.87312692]
curr_Stock_Price:  105.37437996203926
curr_Factors:  [1.05374380e+02 2.35822195e-02]
mat_Sqrt:  [[ 1.61818202e+01  0.00000000e+00]
 [-6.14260134e-03  1.40744678e-02]]
grads:  [-4.98347815e-03  1.46906835e+01]
Stock Position:  -0.00498347814997063
Bond Position:  [-7.347996]


portfolio before change:  [-7.87242044]
curr_Stock_Price:  105.04829366405215
curr_Factors:  [1.05048294e+02 2.30664116e-02]
mat_Sqrt:  [[ 1.59543466e+01  0.00000000e+00]
 [-6.07505215e-03  1.39196932e-02]]
grads:  [-4.14178217e-03  8.68429285e+00]
Stock Position:  -0.004141782169562788
Bond Position:  [-7.43733329]


portfolio before change:  [-7.86867494]
curr_Stock_Price:  103.91949970379473
curr_Factors:  [1.03919500e+02 2.43880244e-02]
mat_Sqrt:  [[ 1.62287607e+01  0.00000000e+00]
 [-6.24666623e-03  1.43129104e-02]]
grads:  [-2.10794688e-03  8.50826068e+00]
Stock Position:  -0.0021079468805834277
Bond Position:  [-7.64961816]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.86877868]
Stock Price:  103.51506407921511
PL:  [-11.38384276]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.24659808e-02  2.87864804e-01]
 [-1.64710560e-01 -8.72405404e-02]
 [ 8.12808639e-01 -6.90515469e-01]
 [-4.11978360e-02  5.63736487e-02]
 [ 2.91658258e-02 -6.68507979e-02]
 [-8.16324121e-02 -9.83273959e-02]
 [-9.02012379e-02  1.39546368e-01]
 [-9.55937294e-02 -1.05371641e-01]
 [ 1.65639313e-01  8.51614879e-02]
 [ 1.12900982e-01  7.15911058e-02]
 [ 1.16982343e-01  1.87535498e-01]
 [-8.04516438e-02  3.01062653e-02]
 [ 4.98802702e-02  8.19309452e-02]
 [-2.99451232e-01 -4.07246054e-01]
 [ 7.69847045e-02  2.22898091e-01]
 [ 5.39054467e-02 -2.03440268e-02]
 [-5.23110999e-02  2.33584409e-01]
 [-1.14570877e-01  4.76300163e-02]
 [ 1.48571979e-02  6.68995856e-02]
 [-1.07124686e-01 -3.02239604e-02]
 [ 2.08370261e-01  3.82269199e-01]
 [ 1.89268944e-02  1.19966491e-01]
 [-1.24493903e-02 -2.12607918e-01]
 [ 6.78167614e-02  1.80316709e-01]
 [ 4.87315504e-02  1.05762555e-01]
 [ 7.56430999e-01 -4.92781198e-01]
 [-5.48197921e-01  6.90614027e-01]
 [ 1.28485056e-01 -1.04275615e-02]
 [-5.25369600e-02 -5.69720595e-02]
 [ 1.04404456e-01 -1.50159759e-01]
 [ 5.57674358e-03 -1.00194015e-01]
 [ 2.48223126e-01 -1.92642460e-02]
 [ 2.39262417e-01  2.85825328e-01]
 [ 2.43411189e-01  1.90427094e-02]
 [-1.79955820e-01 -2.39381725e-01]
 [ 1.82730624e-01 -7.58479035e-02]
 [-2.46147527e-01  1.51946080e-01]
 [-1.17365290e-01  1.21875511e-01]
 [-1.34819967e-01  1.33989381e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.23874524]
curr_Stock_Price:  99.92935347562991
curr_Factors:  [9.99293535e+01 3.91669404e-02]
mat_Sqrt:  [[ 1.97766579e+01  0.00000000e+00]
 [-7.91625573e-03  1.81384205e-02]]
grads:  [7.48865061e-03 1.58704449e+01]
Stock Position:  0.007488650606771233
Bond Position:  [1.49040923]


portfolio before change:  [2.23927477]
curr_Stock_Price:  99.97518487801835
curr_Factors:  [9.99751849e+01 3.87783324e-02]
mat_Sqrt:  [[ 1.96873282e+01  0.00000000e+00]
 [-7.87688592e-03  1.80482130e-02]]
grads:  [-0.0103003  -4.83374949]
Stock Position:  -0.010300303399370977
Bond Position:  [3.26904951]


portfolio before change:  [2.24167728]
curr_Stock_Price:  99.7816131439657
curr_Factors:  [9.97816131e+01 3.97021550e-02]
mat_Sqrt:  [[ 1.98818852e+01  0.00000000e+00]
 [-7.97015985e-03  1.82619304e-02]]
grads:  [ 2.57240688e-02 -3.78117457e+01]
Stock Position:  0.025724068771063608
Bond Position:  [-0.3251118]


portfolio before change:  [2.23525775]
curr_Stock_Price:  99.5336397249499
curr_Factors:  [9.95336397e+01 3.89486182e-02]
mat_Sqrt:  [[ 1.96433662e+01  0.00000000e+00]
 [-7.89416171e-03  1.80877968e-02]]
grads:  [-8.44781822e-04  3.11666752e+00]
Stock Position:  -0.0008447818216219229
Bond Position:  [2.31934196]


portfolio before change:  [2.23715717]
curr_Stock_Price:  97.6284322819242
curr_Factors:  [9.76284323e+01 3.94336730e-02]
mat_Sqrt:  [[ 1.93869697e+01  0.00000000e+00]
 [-7.94316541e-03  1.82000784e-02]]
grads:  [-5.28930277e-07 -3.67310495e+00]
Stock Position:  -5.289302773299128e-07
Bond Position:  [2.23720881]


portfolio before change:  [2.23743643]
curr_Stock_Price:  98.39180624910689
curr_Factors:  [9.83918062e+01 3.76028960e-02]
mat_Sqrt:  [[ 1.90796138e+01  0.00000000e+00]
 [-7.75658647e-03  1.77725723e-02]]
grads:  [-0.0065277  -5.53253599]
Stock Position:  -0.006527700565454723
Bond Position:  [2.87970868]


portfolio before change:  [2.24288708]
curr_Stock_Price:  97.61195191464277
curr_Factors:  [9.76119519e+01 3.73731140e-02]
mat_Sqrt:  [[ 1.88704667e+01  0.00000000e+00]
 [-7.73285086e-03  1.77181872e-02]]
grads:  [-1.55259595e-03  7.87588290e+00]
Stock Position:  -0.0015525959485041074
Bond Position:  [2.394439]


portfolio before change:  [2.24288773]
curr_Stock_Price:  97.80432286565409
curr_Factors:  [9.78043229e+01 3.85472654e-02]
mat_Sqrt:  [[ 1.92023702e+01  0.00000000e+00]
 [-7.85338300e-03  1.79943610e-02]]
grads:  [-0.00737314 -5.85581456]
Stock Position:  -0.007373135848598955
Bond Position:  [2.96401228]


portfolio before change:  [2.2369014]
curr_Stock_Price:  98.66648662188135
curr_Factors:  [9.86664866e+01 3.78765456e-02]
mat_Sqrt:  [[ 1.92023705e+01  0.00000000e+00]
 [-7.78475902e-03  1.78371237e-02]]
grads:  [0.01056155 4.77439576]
Stock Position:  0.010561551928142652
Bond Position:  [1.19483018]


portfolio before change:  [2.22710488]
curr_Stock_Price:  97.72478036528048
curr_Factors:  [9.77247804e+01 3.90073737e-02]
mat_Sqrt:  [[ 1.93009221e+01  0.00000000e+00]
 [-7.90011380e-03  1.81014347e-02]]
grads:  [0.00746834 3.95499621]
Stock Position:  0.0074683427447696776
Bond Position:  [1.49726273]


portfolio before change:  [2.23488775]
curr_Stock_Price:  98.74183275170876
curr_Factors:  [9.87418328e+01 3.84485282e-02]
mat_Sqrt:  [[ 1.93615911e+01  0.00000000e+00]
 [-7.84331850e-03  1.79713004e-02]]
grads:  [1.02692771e-02 1.04352771e+01]
Stock Position:  0.010269277136272223
Bond Position:  [1.2208805]


portfolio before change:  [2.24619372]
curr_Stock_Price:  99.82792169410382
curr_Factors:  [9.98279217e+01 3.69291646e-02]
mat_Sqrt:  [[ 1.91838942e+01  0.00000000e+00]
 [-7.68678498e-03  1.76126370e-02]]
grads:  [-0.00350879  1.70935592]
Stock Position:  -0.00350878667226606
Bond Position:  [2.5964686]


portfolio before change:  [2.24768379]
curr_Stock_Price:  99.49575789371886
curr_Factors:  [9.94957579e+01 3.72348202e-02]
mat_Sqrt:  [[ 1.91990259e+01  0.00000000e+00]
 [-7.71853045e-03  1.76853750e-02]]
grads:  [4.46053183e-03 4.63269482e+00]
Stock Position:  0.0044605318253195456
Bond Position:  [1.80387979]


portfolio before change:  [2.24667854]
curr_Stock_Price:  99.21983961120084
curr_Factors:  [9.92198396e+01 3.80268430e-02]
mat_Sqrt:  [[ 1.93483376e+01  0.00000000e+00]
 [-7.80018903e-03  1.78724783e-02]]
grads:  [ -0.024663   -22.78621056]
Stock Position:  -0.024662996472950366
Bond Position:  [4.6937371]


portfolio before change:  [2.21203238]
curr_Stock_Price:  100.6484138503145
curr_Factors:  [1.00648414e+02 3.71513490e-02]
mat_Sqrt:  [[ 1.93996649e+01  0.00000000e+00]
 [-7.70987409e-03  1.76655408e-02]]
grads:  [8.98290808e-03 1.26176772e+01]
Stock Position:  0.008982908076353508
Bond Position:  [1.30791693]


portfolio before change:  [2.21140195]
curr_Stock_Price:  100.56003224409895
curr_Factors:  [1.00560032e+02 3.70615392e-02]
mat_Sqrt:  [[ 1.93591877e+01  0.00000000e+00]
 [-7.70054951e-03  1.76441755e-02]]
grads:  [ 0.00232585 -1.15301657]
Stock Position:  0.0023258509715529457
Bond Position:  [1.9775143]


portfolio before change:  [2.21190124]
curr_Stock_Price:  100.6684137893736
curr_Factors:  [1.00668414e+02 3.81091476e-02]
mat_Sqrt:  [[ 1.96520492e+01  0.00000000e+00]
 [-7.80862575e-03  1.78918093e-02]]
grads:  [2.52561416e-03 1.30553822e+01]
Stock Position:  0.0025256141638662433
Bond Position:  [1.95765167]


portfolio before change:  [2.21464422]
curr_Stock_Price:  101.65758297205078
curr_Factors:  [1.01657583e+02 4.03348745e-02]
mat_Sqrt:  [[ 2.04164455e+01  0.00000000e+00]
 [-8.03341765e-03  1.84068722e-02]]
grads:  [-0.00459352  2.58762139]
Stock Position:  -0.004593524055198637
Bond Position:  [2.68161077]


portfolio before change:  [2.20014962]
curr_Stock_Price:  104.88600206567916
curr_Factors:  [1.04886002e+02 4.01546665e-02]
mat_Sqrt:  [[ 2.10177172e+01  0.00000000e+00]
 [-8.01545173e-03  1.83657071e-02]]
grads:  [2.09606830e-03 3.64263597e+00]
Stock Position:  0.002096068300928498
Bond Position:  [1.9803014]


portfolio before change:  [2.20062278]
curr_Stock_Price:  104.99363378005263
curr_Factors:  [1.04993634e+02 3.90911412e-02]
mat_Sqrt:  [[ 2.07587950e+01  0.00000000e+00]
 [-7.90859190e-03  1.81208605e-02]]
grads:  [-0.00579588 -1.66790977]
Stock Position:  -0.005795880906696549
Bond Position:  [2.80915337]


portfolio before change:  [2.19783371]
curr_Stock_Price:  105.53543824144693
curr_Factors:  [1.05535438e+02 3.96701350e-02]
mat_Sqrt:  [[ 2.10198763e+01  0.00000000e+00]
 [-7.96694521e-03  1.82545647e-02]]
grads:  [1.78500678e-02 2.09410197e+01]
Stock Position:  0.017850067760906356
Bond Position:  [0.31401898]


portfolio before change:  [2.196349]
curr_Stock_Price:  105.45006225235497
curr_Factors:  [1.05450062e+02 3.90837707e-02]
mat_Sqrt:  [[ 2.08470721e+01  0.00000000e+00]
 [-7.90784630e-03  1.81191521e-02]]
grads:  [3.41940408e-03 6.62097708e+00]
Stock Position:  0.003419404080736437
Bond Position:  [1.83577262]


portfolio before change:  [2.19865734]
curr_Stock_Price:  106.05802242395328
curr_Factors:  [1.06058022e+02 3.98165071e-02]
mat_Sqrt:  [[ 2.11628963e+01  0.00000000e+00]
 [-7.98162962e-03  1.82882109e-02]]
grads:  [-4.97281144e-03 -1.16254082e+01]
Stock Position:  -0.00497281144034132
Bond Position:  [2.72606389]


portfolio before change:  [2.2110725]
curr_Stock_Price:  103.6299443072774
curr_Factors:  [1.03629944e+02 4.10553081e-02]
mat_Sqrt:  [[ 2.09976128e+01  0.00000000e+00]
 [-8.10484380e-03  1.85705301e-02]]
grads:  [6.97762296e-03 9.70983100e+00]
Stock Position:  0.006977622957792047
Bond Position:  [1.48798182]


portfolio before change:  [2.21042491]
curr_Stock_Price:  103.51047724402311
curr_Factors:  [1.03510477e+02 4.14541788e-02]
mat_Sqrt:  [[ 2.10750430e+01  0.00000000e+00]
 [-8.14411972e-03  1.86605226e-02]]
grads:  [4.50248732e-03 5.66771670e+00]
Stock Position:  0.00450248732116392
Bond Position:  [1.7443703]


portfolio before change:  [2.21279689]
curr_Stock_Price:  103.98886192715946
curr_Factors:  [1.03988862e+02 4.09117326e-02]
mat_Sqrt:  [[ 2.10334620e+01  0.00000000e+00]
 [-8.09065957e-03  1.85380299e-02]]
grads:  [ 2.57382095e-02 -2.65821773e+01]
Stock Position:  0.02573820952505474
Bond Position:  [-0.46369023]


portfolio before change:  [2.26627103]
curr_Stock_Price:  106.06873088625443
curr_Factors:  [1.06068731e+02 4.15680799e-02]
mat_Sqrt:  [[ 2.16255596e+01  0.00000000e+00]
 [-8.15530060e-03  1.86861412e-02]]
grads:  [-1.14119243e-02  3.69586220e+01]
Stock Position:  -0.011411924297330189
Bond Position:  [3.47671936]


portfolio before change:  [2.27180408]
curr_Stock_Price:  105.62196751776538
curr_Factors:  [1.05621968e+02 4.29378879e-02]
mat_Sqrt:  [[ 2.18864131e+01  0.00000000e+00]
 [-8.28858375e-03  1.89915312e-02]]
grads:  [ 0.0056626  -0.54906376]
Stock Position:  0.005662604199069405
Bond Position:  [1.67370868]


portfolio before change:  [2.28129833]
curr_Stock_Price:  107.26167682203541
curr_Factors:  [1.07261677e+02 4.15392058e-02]
mat_Sqrt:  [[ 2.18611838e+01  0.00000000e+00]
 [-8.15246768e-03  1.86796501e-02]]
grads:  [-0.0035406  -3.04995325]
Stock Position:  -0.0035405953261968353
Bond Position:  [2.66106852]


portfolio before change:  [2.27809822]
curr_Stock_Price:  108.25946377411384
curr_Factors:  [1.08259464e+02 4.27041200e-02]
mat_Sqrt:  [[ 2.23717913e+01  0.00000000e+00]
 [-8.26599008e-03  1.89397626e-02]]
grads:  [ 1.73742747e-03 -7.92828092e+00]
Stock Position:  0.0017374274672827584
Bond Position:  [2.09000526]


portfolio before change:  [2.28044588]
curr_Stock_Price:  109.46031678805305
curr_Factors:  [1.09460317e+02 4.29565018e-02]
mat_Sqrt:  [[ 2.26866909e+01  0.00000000e+00]
 [-8.29038014e-03  1.89956473e-02]]
grads:  [-1.68166921e-03 -5.27457758e+00]
Stock Position:  -0.0016816692119898979
Bond Position:  [2.46452193]


portfolio before change:  [2.28355598]
curr_Stock_Price:  107.79410845883116
curr_Factors:  [1.07794108e+02 4.33084830e-02]
mat_Sqrt:  [[ 2.24326981e+01  0.00000000e+00]
 [-8.32427611e-03  1.90733127e-02]]
grads:  [ 0.01069044 -1.0100105 ]
Stock Position:  0.010690444791927252
Bond Position:  [1.13118901]


portfolio before change:  [2.26807322]
curr_Stock_Price:  106.33260044202929
curr_Factors:  [1.06332600e+02 4.32059878e-02]
mat_Sqrt:  [[ 2.21023476e+01  0.00000000e+00]
 [-8.31442003e-03  1.90507296e-02]]
grads:  [ 0.01646915 15.00337964]
Stock Position:  0.016469147256554333
Bond Position:  [0.51686596]


portfolio before change:  [2.28316039]
curr_Stock_Price:  107.2447644415309
curr_Factors:  [1.07244764e+02 4.14682260e-02]
mat_Sqrt:  [[ 2.18390543e+01  0.00000000e+00]
 [-8.14549947e-03  1.86636839e-02]]
grads:  [0.01152624 1.02030818]
Stock Position:  0.011526236681511173
Bond Position:  [1.04703185]


portfolio before change:  [2.27950232]
curr_Stock_Price:  106.91603998981135
curr_Factors:  [1.06916040e+02 4.36061589e-02]
mat_Sqrt:  [[ 2.23263013e+01  0.00000000e+00]
 [-8.35283511e-03  1.91387496e-02]]
grads:  [ -0.01273971 -12.50769933]
Stock Position:  -0.012739708483579042
Bond Position:  [3.64158151]


portfolio before change:  [2.2804827]
curr_Stock_Price:  106.87481862506445
curr_Factors:  [1.06874819e+02 4.46889917e-02]
mat_Sqrt:  [[ 2.25930919e+01  0.00000000e+00]
 [-8.45590840e-03  1.93749201e-02]]
grads:  [ 0.00662273 -3.91474664]
Stock Position:  0.0066227272187808295
Bond Position:  [1.57267993]


portfolio before change:  [2.29082538]
curr_Stock_Price:  108.40682799727529
curr_Factors:  [1.08406828e+02 4.43877977e-02]
mat_Sqrt:  [[ 2.28395970e+01  0.00000000e+00]
 [-8.42736473e-03  1.93095184e-02]]
grads:  [-0.00787373  7.86897305]
Stock Position:  -0.007873730059505195
Bond Position:  [3.14439148]


portfolio before change:  [2.30806328]
curr_Stock_Price:  106.26745691241833
curr_Factors:  [1.06267457e+02 4.42338084e-02]
mat_Sqrt:  [[ 2.23499962e+01  0.00000000e+00]
 [-8.41273401e-03  1.92759952e-02]]
grads:  [-2.87134082e-03  6.32265724e+00]
Stock Position:  -0.0028713408189063767
Bond Position:  [2.61319337]


portfolio before change:  [2.31184213]
curr_Stock_Price:  105.06516801822309
curr_Factors:  [1.05065168e+02 4.31803639e-02]
mat_Sqrt:  [[ 2.18324215e+01  0.00000000e+00]
 [-8.31195418e-03  1.90450796e-02]]
grads:  [-3.49673564e-03  7.03538046e+00]
Stock Position:  -0.003496735642246824
Bond Position:  [2.67922725]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.30954109]
Stock Price:  105.81900320421767
PL:  [-3.50946211]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-7.17729611e-02  1.71374264e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.80752303e-01 -8.38189650e-01]
 [-1.08721036e-02  2.44929145e-01]
 [-5.49722795e-03 -1.63854371e-01]
 [-7.08161329e-02 -3.19661826e-02]
 [-1.54476485e-01  2.23725369e-02]
 [ 1.82864667e-01 -1.72207279e-01]
 [ 1.65933360e-01  1.03070941e-01]
 [ 1.98559570e-01 -4.09176313e-02]
 [ 1.16456494e-01  1.85660642e-01]
 [-9.60185647e-02  5.15959968e-03]
 [ 9.37908938e-02  6.42957118e-02]
 [-2.51384631e-01 -3.45812013e-01]
 [ 9.03005282e-02  2.33536509e-01]
 [ 3.94765639e-02  1.42051488e-01]
 [ 9.76241460e-02  2.20182121e-01]
 [ 1.01733931e-01  6.77059245e-02]
 [ 1.63061252e-02  2.65162508e-03]
 [ 3.17197609e-01 -1.13760525e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 1.23412883e-02  1.78248481e-01]
 [ 1.62739006e-02  9.20813814e-02]
 [-1.02253505e-02 -3.97179078e-02]
 [ 5.21473808e-02  1.42520467e-01]
 [ 4.46743319e-02  1.61280838e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.58327690e-01  8.81830857e-02]
 [-4.80112742e-01  1.01806057e-01]
 [ 2.25503672e-01 -9.86918133e-02]
 [-1.12607959e+00 -1.27231087e-01]
 [ 1.48276415e-02  2.29731459e-01]
 [-1.16589586e-02 -1.24410877e-01]
 [ 1.36788001e-02  6.60807746e-02]
 [-4.90683854e-02  1.64605161e-01]
 [-1.57279043e+00 -9.53572747e-02]
 [-1.05592028e-01  1.59037755e-01]
 [-1.35068356e-01 -6.26072353e-02]
 [ 1.38818164e+00 -6.62060746e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.00160133]
curr_Stock_Price:  99.59192102034503
curr_Factors:  [9.9591921e+01 4.0024053e-02]
mat_Sqrt:  [[ 1.99243720e+01  0.00000000e+00]
 [-8.00240494e-03  1.83358132e-02]]
grads:  [1.51618298e-04 9.34642286e+00]
Stock Position:  0.00015161829838079006
Bond Position:  [-0.01670129]


portfolio before change:  [-0.00176824]
curr_Stock_Price:  98.50485667258334
curr_Factors:  [9.85048567e+01 3.98793477e-02]
mat_Sqrt:  [[ 1.96712368e+01  0.00000000e+00]
 [-7.98792565e-03  1.83026370e-02]]
grads:  [-0.01031885 -4.80867157]
Stock Position:  -0.010318845232969309
Bond Position:  [1.01468813]


portfolio before change:  [0.00980244]
curr_Stock_Price:  97.39583397083395
curr_Factors:  [9.73958340e+01 3.98476429e-02]
mat_Sqrt:  [[ 1.94420340e+01  0.00000000e+00]
 [-7.98474976e-03  1.82953601e-02]]
grads:  [ 2.64857241e-02 -4.58143292e+01]
Stock Position:  0.026485724073202543
Bond Position:  [-2.56979675]


portfolio before change:  [-0.00745291]
curr_Stock_Price:  96.75646681927252
curr_Factors:  [9.67564668e+01 4.05515457e-02]
mat_Sqrt:  [[ 1.94842507e+01  0.00000000e+00]
 [-8.05496575e-03  1.84562451e-02]]
grads:  [4.92827467e-03 1.32708004e+01]
Stock Position:  0.004928274669104909
Bond Position:  [-0.48429535]


portfolio before change:  [-0.01647939]
curr_Stock_Price:  94.93718042611324
curr_Factors:  [9.49371804e+01 4.18407342e-02]
mat_Sqrt:  [[ 1.94194076e+01  0.00000000e+00]
 [-8.18200310e-03  1.87473243e-02]]
grads:  [-3.96557609e-03 -8.74014708e+00]
Stock Position:  -0.003965576085009936
Bond Position:  [0.36000122]


portfolio before change:  [-0.0162688]
curr_Stock_Price:  94.89542456196077
curr_Factors:  [9.48954246e+01 4.21418606e-02]
mat_Sqrt:  [[ 1.94805909e+01  0.00000000e+00]
 [-8.21139311e-03  1.88146653e-02]]
grads:  [-0.00435137 -1.69900353]
Stock Position:  -0.004351373079328554
Bond Position:  [0.39665659]


portfolio before change:  [-0.01759309]
curr_Stock_Price:  95.21115769986231
curr_Factors:  [9.52111577e+01 4.25888349e-02]
mat_Sqrt:  [[ 1.96487861e+01  0.00000000e+00]
 [-8.25482501e-03  1.89141802e-02]]
grads:  [-0.00736495  1.18284465]
Stock Position:  -0.007364949077983254
Bond Position:  [0.68363224]


portfolio before change:  [-0.01510008]
curr_Stock_Price:  94.88426417593429
curr_Factors:  [9.48842642e+01 4.32785840e-02]
mat_Sqrt:  [[ 1.97392531e+01  0.00000000e+00]
 [-8.32140219e-03  1.90667277e-02]]
grads:  [ 5.45650074e-03 -9.03182138e+00]
Stock Position:  0.005456500740195269
Bond Position:  [-0.53283613]


portfolio before change:  [-0.00027727]
curr_Stock_Price:  97.61301188575969
curr_Factors:  [9.76130119e+01 4.20040586e-02]
mat_Sqrt:  [[ 2.00056811e+01  0.00000000e+00]
 [-8.19795668e-03  1.87838785e-02]]
grads:  [0.01054287 5.48720227]
Stock Position:  0.01054286556556638
Bond Position:  [-1.02939813]


portfolio before change:  [0.01436858]
curr_Stock_Price:  99.01438899160979
curr_Factors:  [9.90143890e+01 4.24055594e-02]
mat_Sqrt:  [[ 2.03896471e+01  0.00000000e+00]
 [-8.23704407e-03  1.88734390e-02]]
grads:  [ 0.00886242 -2.16800083]
Stock Position:  0.008862421707825332
Bond Position:  [-0.86313869]


portfolio before change:  [0.01211971]
curr_Stock_Price:  98.77281070607354
curr_Factors:  [9.87728107e+01 4.26859485e-02]
mat_Sqrt:  [[ 2.04070336e+01  0.00000000e+00]
 [-8.26423122e-03  1.89357326e-02]]
grads:  [9.67732225e-03 9.80477735e+00]
Stock Position:  0.009677322249894206
Bond Position:  [-0.94373661]


portfolio before change:  [0.02384832]
curr_Stock_Price:  99.99697016263293
curr_Factors:  [9.99969702e+01 4.23676280e-02]
mat_Sqrt:  [[ 2.05827745e+01  0.00000000e+00]
 [-8.23335926e-03  1.88649960e-02]]
grads:  [-0.00455559  0.27350123]
Stock Position:  -0.004555592384095921
Bond Position:  [0.47939376]


portfolio before change:  [0.02821055]
curr_Stock_Price:  99.05257077380497
curr_Factors:  [9.90525708e+01 4.23297301e-02]
mat_Sqrt:  [[ 2.03792643e+01  0.00000000e+00]
 [-8.22967607e-03  1.88565568e-02]]
grads:  [0.00597921 3.40972706]
Stock Position:  0.005979207163536589
Bond Position:  [-0.56404529]


portfolio before change:  [0.02557222]
curr_Stock_Price:  98.62311337677991
curr_Factors:  [9.86231134e+01 4.16458983e-02]
mat_Sqrt:  [[ 2.01263410e+01  0.00000000e+00]
 [-8.16293068e-03  1.87036239e-02]]
grads:  [ -0.0199892  -18.48903801]
Stock Position:  -0.019989195626648165
Bond Position:  [1.99696893]


portfolio before change:  [0.05638486]
curr_Stock_Price:  97.09413730399281
curr_Factors:  [9.70941373e+01 4.20307559e-02]
mat_Sqrt:  [[ 1.99056612e+01  0.00000000e+00]
 [-8.20056153e-03  1.87898470e-02]]
grads:  [9.6567612e-03 1.2428867e+01]
Stock Position:  0.009656761202973253
Bond Position:  [-0.88123004]


portfolio before change:  [0.03587386]
curr_Stock_Price:  94.98154095491368
curr_Factors:  [9.49815410e+01 4.30325759e-02]
mat_Sqrt:  [[ 1.97032507e+01  0.00000000e+00]
 [-8.29771785e-03  1.90124601e-02]]
grads:  [5.15005963e-03 7.47149436e+00]
Stock Position:  0.005150059632252249
Bond Position:  [-0.45328674]


portfolio before change:  [0.03557815]
curr_Stock_Price:  94.93512380422604
curr_Factors:  [9.49351238e+01 4.22744145e-02]
mat_Sqrt:  [[ 1.95193667e+01  0.00000000e+00]
 [-8.22429713e-03  1.88442321e-02]]
grads:  [9.92447682e-03 1.16843244e+01]
Stock Position:  0.009924476817969725
Bond Position:  [-0.90660329]


portfolio before change:  [0.03666273]
curr_Stock_Price:  95.05582749913935
curr_Factors:  [9.50558275e+01 4.21569114e-02]
mat_Sqrt:  [[ 1.95170035e+01  0.00000000e+00]
 [-8.21285932e-03  1.88180247e-02]]
grads:  [0.00672661 3.5979294 ]
Stock Position:  0.006726607339910179
Bond Position:  [-0.60274049]


portfolio before change:  [0.03890087]
curr_Stock_Price:  95.39975812976479
curr_Factors:  [9.53997581e+01 4.20278841e-02]
mat_Sqrt:  [[ 1.95576215e+01  0.00000000e+00]
 [-8.20028137e-03  1.87892051e-02]]
grads:  [0.00089292 0.14112492]
Stock Position:  0.0008929198911083985
Bond Position:  [-0.04628347]


portfolio before change:  [0.0384572]
curr_Stock_Price:  94.90935787378426
curr_Factors:  [9.49093579e+01 4.20251051e-02]
mat_Sqrt:  [[ 1.94564427e+01  0.00000000e+00]
 [-8.20001025e-03  1.87885838e-02]]
grads:  [ 0.01375115 -6.05476848]
Stock Position:  0.013751149160259345
Bond Position:  [-1.26665554]


portfolio before change:  [0.05510528]
curr_Stock_Price:  96.13154121604981
curr_Factors:  [9.61315412e+01 4.04350184e-02]
mat_Sqrt:  [[ 1.93305730e+01  0.00000000e+00]
 [-8.04338420e-03  1.84297085e-02]]
grads:  [ 0.00217938 -2.04984195]
Stock Position:  0.0021793772289015758
Bond Position:  [-0.15440161]


portfolio before change:  [0.05439425]
curr_Stock_Price:  95.81414358950714
curr_Factors:  [9.58141436e+01 4.14471903e-02]
mat_Sqrt:  [[ 1.95064020e+01  0.00000000e+00]
 [-8.14343321e-03  1.86589495e-02]]
grads:  [4.62080621e-03 9.55297514e+00]
Stock Position:  0.004620806207477257
Bond Position:  [-0.38834434]


portfolio before change:  [0.05294593]
curr_Stock_Price:  95.51121563117871
curr_Factors:  [9.55112156e+01 4.20075494e-02]
mat_Sqrt:  [[ 1.95757336e+01  0.00000000e+00]
 [-8.19829732e-03  1.87846590e-02]]
grads:  [2.88426025e-03 4.90194585e+00]
Stock Position:  0.0028842602483944327
Bond Position:  [-0.22253327]


portfolio before change:  [0.04942306]
curr_Stock_Price:  94.29944865987717
curr_Factors:  [9.42994487e+01 4.21031185e-02]
mat_Sqrt:  [[ 1.93493458e+01  0.00000000e+00]
 [-8.20761778e-03  1.88060149e-02]]
grads:  [-1.42432033e-03 -2.11197896e+00]
Stock Position:  -0.0014243203306515209
Bond Position:  [0.18373569]


portfolio before change:  [0.04828905]
curr_Stock_Price:  95.11175293176221
curr_Factors:  [9.51117529e+01 4.22285026e-02]
mat_Sqrt:  [[ 1.95450609e+01  0.00000000e+00]
 [-8.21982994e-03  1.88339964e-02]]
grads:  [5.85050170e-03 7.56719196e+00]
Stock Position:  0.005850501703187984
Bond Position:  [-0.50816242]


portfolio before change:  [0.04478548]
curr_Stock_Price:  94.52376157499532
curr_Factors:  [9.45237616e+01 4.23222081e-02]
mat_Sqrt:  [[ 1.94457705e+01  0.00000000e+00]
 [-8.22894482e-03  1.88548813e-02]]
grads:  [5.91712529e-03 8.55379757e+00]
Stock Position:  0.005917125288468719
Bond Position:  [-0.51452346]


portfolio before change:  [0.03789545]
curr_Stock_Price:  93.37020981487231
curr_Factors:  [9.33702098e+01 4.21165118e-02]
mat_Sqrt:  [[ 1.91617219e+01  0.00000000e+00]
 [-8.20892313e-03  1.88090058e-02]]
grads:  [9.29778658e-03 9.30072521e+00]
Stock Position:  0.009297786575026546
Bond Position:  [-0.83024083]


portfolio before change:  [0.03784087]
curr_Stock_Price:  93.37550151344726
curr_Factors:  [9.33755015e+01 4.19523529e-02]
mat_Sqrt:  [[ 1.91254256e+01  0.00000000e+00]
 [-8.19290942e-03  1.87723138e-02]]
grads:  [-0.00626608  4.69750755]
Stock Position:  -0.006266079429653188
Bond Position:  [0.62293918]


portfolio before change:  [0.04688814]
curr_Stock_Price:  91.9440796697939
curr_Factors:  [9.19440797e+01 4.44493772e-02]
mat_Sqrt:  [[ 1.93845896e+01  0.00000000e+00]
 [-8.43320838e-03  1.93229079e-02]]
grads:  [-0.02247563  5.26867166]
Stock Position:  -0.022475633784852758
Bond Position:  [2.11338961]


portfolio before change:  [0.00735225]
curr_Stock_Price:  93.71489010363783
curr_Factors:  [9.37148901e+01 4.33722188e-02]
mat_Sqrt:  [[ 1.95170610e+01  0.00000000e+00]
 [-8.33039916e-03  1.90873424e-02]]
grads:  [ 0.00934726 -5.17053718]
Stock Position:  0.009347259469721236
Bond Position:  [-0.86862515]


portfolio before change:  [0.02244393]
curr_Stock_Price:  95.34106336932929
curr_Factors:  [9.53410634e+01 4.19332588e-02]
mat_Sqrt:  [[ 1.95235729e+01  0.00000000e+00]
 [-8.19104474e-03  1.87680413e-02]]
grads:  [-0.06052211 -6.7791351 ]
Stock Position:  -0.06052210810260823
Bond Position:  [5.79268607]


portfolio before change:  [0.05559144]
curr_Stock_Price:  94.80533538370213
curr_Factors:  [9.48053354e+01 4.26551146e-02]
mat_Sqrt:  [[ 1.95802547e+01  0.00000000e+00]
 [-8.26124588e-03  1.89288923e-02]]
grads:  [5.87789444e-03 1.21365506e+01]
Stock Position:  0.005877894443143305
Bond Position:  [-0.50166431]


portfolio before change:  [0.05463615]
curr_Stock_Price:  94.65348141936872
curr_Factors:  [9.46534814e+01 4.26184568e-02]
mat_Sqrt:  [[ 1.95404901e+01  0.00000000e+00]
 [-8.25769526e-03  1.89207568e-02]]
grads:  [-3.37536656e-03 -6.57536474e+00]
Stock Position:  -0.003375366556648288
Bond Position:  [0.37412635]


portfolio before change:  [0.05843138]
curr_Stock_Price:  93.54294650351444
curr_Factors:  [9.35429465e+01 4.49162939e-02]
mat_Sqrt:  [[ 1.98249912e+01  0.00000000e+00]
 [-8.47738582e-03  1.94241311e-02]]
grads:  [2.14470786e-03 3.40199385e+00]
Stock Position:  0.002144707862543544
Bond Position:  [-0.14219091]


portfolio before change:  [0.06096009]
curr_Stock_Price:  94.73027859654742
curr_Factors:  [9.47302786e+01 4.51103835e-02]
mat_Sqrt:  [[ 2.01199582e+01  0.00000000e+00]
 [-8.49568206e-03  1.94660531e-02]]
grads:  [1.13177156e-03 8.45601112e+00]
Stock Position:  0.0011317715611204714
Bond Position:  [-0.04625295]


portfolio before change:  [0.06040435]
curr_Stock_Price:  94.24435923778842
curr_Factors:  [9.42443592e+01 4.56399603e-02]
mat_Sqrt:  [[ 2.01339041e+01  0.00000000e+00]
 [-8.54540441e-03  1.95799813e-02]]
grads:  [-0.08018354 -4.87014126]
Stock Position:  -0.08018354276860659
Bond Position:  [7.61725096]


portfolio before change:  [0.26402834]
curr_Stock_Price:  91.71676116212079
curr_Factors:  [9.17167612e+01 4.70391189e-02]
mat_Sqrt:  [[ 1.98919931e+01  0.00000000e+00]
 [-8.67540145e-03  1.98778419e-02]]
grads:  [-1.81893594e-03  8.00075560e+00]
Stock Position:  -0.0018189359427917401
Bond Position:  [0.43085525]


portfolio before change:  [0.26489383]
curr_Stock_Price:  91.27054803338606
curr_Factors:  [9.12705480e+01 4.58226056e-02]
mat_Sqrt:  [[ 1.95375701e+01  0.00000000e+00]
 [-8.56248615e-03  1.96191205e-02]]
grads:  [-0.0083118  -3.19113364]
Stock Position:  -0.008311800953083637
Bond Position:  [1.02351646]


portfolio before change:  [0.25948278]
curr_Stock_Price:  91.93695024824294
curr_Factors:  [9.19369502e+01 4.54180554e-02]
mat_Sqrt:  [[ 1.95931544e+01  0.00000000e+00]
 [-8.52460489e-03  1.95323236e-02]]
grads:  [ 0.06937561 -3.3895647 ]
Stock Position:  0.06937560518974435
Bond Position:  [-6.11869879]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.16776313]
Stock Price:  90.62590199750494
PL:  [0.16776313]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.22221621e-01  4.12186986e-01]
 [-1.78429910e-01 -7.58780843e-02]
 [ 7.87448459e-01 -6.61336210e-01]
 [-4.24141478e-02  9.73449274e-02]
 [ 3.88435420e-02 -2.94932155e-02]
 [-8.03062687e-02 -1.03738353e-01]
 [-8.92262093e-02  1.40869775e-01]
 [-1.26149150e-01 -9.40198805e-02]
 [ 1.55484754e-01  7.34856805e-02]
 [ 2.61840854e-01 -1.08630028e-01]
 [ 8.02682660e-02  5.73668037e-02]
 [-2.01601887e-02  1.26248989e-01]
 [ 3.60762619e-02  8.74955101e-02]
 [-3.95493793e-01 -5.20032855e-01]
 [ 8.49109178e-02  2.29228547e-01]
 [ 5.13728060e-02 -1.55257054e-02]
 [ 2.01830554e-02 -5.88284642e-02]
 [-2.80610037e-02  3.27277095e-02]
 [ 1.51628463e-02  5.93102896e-02]
 [-4.49018694e-02 -7.09832347e-02]
 [ 1.03821395e-01  8.85002949e-03]
 [ 6.86510569e-02  3.12369148e-01]
 [ 3.76140223e-02  3.74681774e-01]
 [-3.86684419e-02  1.38279019e-01]
 [ 1.95550040e-02  4.81795929e-02]
 [ 3.27860557e-01 -3.25754992e-02]
 [ 3.47479677e-03  2.17558894e-01]
 [-1.83850283e-01  1.34678007e-01]
 [-1.29050938e-01 -7.25393469e-02]
 [ 3.83242510e-02 -5.52804064e-02]
 [-8.72817762e-01 -1.03552253e-01]
 [-1.24640879e-01  7.00786188e-02]
 [-8.51306432e-03 -1.20040068e-01]
 [ 4.87441538e-02  8.31224636e-02]
 [-6.49048588e-02  1.61793660e-01]
 [-1.43663941e+00 -1.22814506e-01]
 [-5.92514057e-02  2.54464302e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.06372366e+00 -2.40465175e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.61257397]
curr_Stock_Price:  100.28689050376403
curr_Factors:  [1.00286891e+02 4.15664234e-02]
mat_Sqrt:  [[ 2.04463361e+01  0.00000000e+00]
 [-8.15513810e-03  1.86857688e-02]]
grads:  [1.47759857e-02 2.20588722e+01]
Stock Position:  0.014775985731911724
Bond Position:  [3.13073631]


portfolio before change:  [4.61756293]
curr_Stock_Price:  100.59804326789886
curr_Factors:  [1.00598043e+02 4.09890139e-02]
mat_Sqrt:  [[ 2.03668220e+01  0.00000000e+00]
 [-8.09829749e-03  1.85555306e-02]]
grads:  [-0.01038679 -4.08924357]
Stock Position:  -0.010386785938332376
Bond Position:  [5.66245327]


portfolio before change:  [4.62049331]
curr_Stock_Price:  100.3840670228094
curr_Factors:  [1.00384067e+02 4.11938727e-02]
mat_Sqrt:  [[ 2.03742250e+01  0.00000000e+00]
 [-8.11850949e-03  1.86018421e-02]]
grads:  [ 2.44827803e-02 -3.55521892e+01]
Stock Position:  0.02448278027795749
Bond Position:  [2.16281225]


portfolio before change:  [4.58526574]
curr_Stock_Price:  98.93415271851396
curr_Factors:  [9.89341527e+01 4.14510030e-02]
mat_Sqrt:  [[ 2.01425180e+01  0.00000000e+00]
 [-8.14380776e-03  1.86598077e-02]]
grads:  [3.50808028e-06 5.21682371e+00]
Stock Position:  3.5080802808946175e-06
Bond Position:  [4.58491867]


portfolio before change:  [4.58583782]
curr_Stock_Price:  98.62927629865247
curr_Factors:  [9.86292763e+01 4.11819710e-02]
mat_Sqrt:  [[ 2.00151759e+01  0.00000000e+00]
 [-8.11733661e-03  1.85991547e-02]]
grads:  [ 1.29759776e-03 -1.58572881e+00]
Stock Position:  0.0012975977613549595
Bond Position:  [4.45785669]


portfolio before change:  [4.58509865]
curr_Stock_Price:  97.63016950907635
curr_Factors:  [9.76301695e+01 4.31059274e-02]
mat_Sqrt:  [[ 2.02699436e+01  0.00000000e+00]
 [-8.30478680e-03  1.90286571e-02]]
grads:  [-0.00619545 -5.45169073]
Stock Position:  -0.006195448813539636
Bond Position:  [5.18996137]


portfolio before change:  [4.58569877]
curr_Stock_Price:  97.63802466610557
curr_Factors:  [9.76380247e+01 4.22102749e-02]
mat_Sqrt:  [[ 2.00598682e+01  0.00000000e+00]
 [-8.21805572e-03  1.88299312e-02]]
grads:  [-1.38313966e-03  7.48116247e+00]
Stock Position:  -0.0013831396617118433
Bond Position:  [4.72074579]


portfolio before change:  [4.58528931]
curr_Stock_Price:  98.3607191371211
curr_Factors:  [9.83607191e+01 4.22377936e-02]
mat_Sqrt:  [[ 2.02149330e+01  0.00000000e+00]
 [-8.22073414e-03  1.88360682e-02]]
grads:  [-0.00827026 -4.9914812 ]
Stock Position:  -0.008270261861317938
Bond Position:  [5.39875822]


portfolio before change:  [4.57302087]
curr_Stock_Price:  99.92576334717984
curr_Factors:  [9.99257633e+01 4.17852936e-02]
mat_Sqrt:  [[ 2.04262764e+01  0.00000000e+00]
 [-8.17658057e-03  1.87348997e-02]]
grads:  [0.00918212 3.9223952 ]
Stock Position:  0.009182120641373916
Bond Position:  [3.65549046]


portfolio before change:  [4.57132314]
curr_Stock_Price:  99.69110039977984
curr_Factors:  [9.96911004e+01 4.02631822e-02]
mat_Sqrt:  [[ 2.00037048e+01  0.00000000e+00]
 [-8.02627507e-03  1.83905065e-02]]
grads:  [ 0.01071956 -5.90685351]
Stock Position:  0.010719555438822753
Bond Position:  [3.50267886]


portfolio before change:  [4.57841469]
curr_Stock_Price:  100.31180689922908
curr_Factors:  [1.00311807e+02 4.06162012e-02]
mat_Sqrt:  [[ 2.02163014e+01  0.00000000e+00]
 [-8.06138461e-03  1.84709526e-02]]
grads:  [0.00520892 3.1057848 ]
Stock Position:  0.00520892469792518
Bond Position:  [4.05589805]


portfolio before change:  [4.57304]
curr_Stock_Price:  99.18264642374548
curr_Factors:  [9.91826464e+01 3.93865440e-02]
mat_Sqrt:  [[ 1.96838311e+01  0.00000000e+00]
 [-7.93841737e-03  1.81891992e-02]]
grads:  [1.77502983e-03 6.94087668e+00]
Stock Position:  0.0017750298321212244
Bond Position:  [4.39698785]


portfolio before change:  [4.57439489]
curr_Stock_Price:  99.63629223432704
curr_Factors:  [9.96362922e+01 3.77316382e-02]
mat_Sqrt:  [[ 1.93539845e+01  0.00000000e+00]
 [-7.76985336e-03  1.78029706e-02]]
grads:  [3.83706173e-03 4.91465791e+00]
Stock Position:  0.0038370617299061075
Bond Position:  [4.19208429]


portfolio before change:  [4.57757968]
curr_Stock_Price:  100.32972366924922
curr_Factors:  [1.00329724e+02 3.79060881e-02]
mat_Sqrt:  [[ 1.95336814e+01  0.00000000e+00]
 [-7.78779436e-03  1.78440786e-02]]
grads:  [ -0.03186572 -29.143161  ]
Stock Position:  -0.03186571570855231
Bond Position:  [7.77465813]


portfolio before change:  [4.63580007]
curr_Stock_Price:  98.53316886887703
curr_Factors:  [9.85331689e+01 3.93154652e-02]
mat_Sqrt:  [[ 1.95372827e+01  0.00000000e+00]
 [-7.93125112e-03  1.81727793e-02]]
grads:  [9.46674421e-03 1.26138409e+01]
Stock Position:  0.009466744212757333
Bond Position:  [3.70301177]


portfolio before change:  [4.63146013]
curr_Stock_Price:  98.0258301117696
curr_Factors:  [9.80258301e+01 3.94461221e-02]
mat_Sqrt:  [[ 1.94689570e+01  0.00000000e+00]
 [-7.94441914e-03  1.82029510e-02]]
grads:  [ 0.00229066 -0.85292244]
Stock Position:  0.0022906636736195253
Bond Position:  [4.40691593]


portfolio before change:  [4.6305958]
curr_Stock_Price:  97.4080027534291
curr_Factors:  [9.74080028e+01 4.01903718e-02]
mat_Sqrt:  [[ 1.95279049e+01  0.00000000e+00]
 [-8.01901458e-03  1.83738707e-02]]
grads:  [-2.81227878e-04 -3.20174585e+00]
Stock Position:  -0.0002812278784805969
Bond Position:  [4.65798964]


portfolio before change:  [4.63071161]
curr_Stock_Price:  99.06670626563387
curr_Factors:  [9.90667063e+01 3.96152118e-02]
mat_Sqrt:  [[ 1.97178117e+01  0.00000000e+00]
 [-7.96142819e-03  1.82419237e-02]]
grads:  [-6.98731708e-04  1.79409311e+00]
Stock Position:  -0.0006987317077421359
Bond Position:  [4.69993266]


portfolio before change:  [4.63091343]
curr_Stock_Price:  99.61871088387521
curr_Factors:  [9.96187109e+01 3.87013574e-02]
mat_Sqrt:  [[ 1.95976509e+01  0.00000000e+00]
 [-7.86906423e-03  1.80302912e-02]]
grads:  [2.09453567e-03 3.28948040e+00]
Stock Position:  0.0020945356723009235
Bond Position:  [4.42225849]


portfolio before change:  [4.63391127]
curr_Stock_Price:  100.78604434906376
curr_Factors:  [1.00786044e+02 3.96465420e-02]
mat_Sqrt:  [[ 2.00679522e+01  0.00000000e+00]
 [-7.96457577e-03  1.82491357e-02]]
grads:  [-3.78122751e-03 -3.88967653e+00]
Stock Position:  -0.0037812275124452528
Bond Position:  [5.01500624]


portfolio before change:  [4.63800935]
curr_Stock_Price:  99.86804481260384
curr_Factors:  [9.98680448e+01 3.99099034e-02]
mat_Sqrt:  [[ 1.99511019e+01  0.00000000e+00]
 [-7.99098526e-03  1.83096474e-02]]
grads:  [0.00539739 0.48335335]
Stock Position:  0.005397389344007154
Bond Position:  [4.09898263]


portfolio before change:  [4.63978253]
curr_Stock_Price:  100.10163420183164
curr_Factors:  [1.00101634e+02 3.94983614e-02]
mat_Sqrt:  [[ 1.98943937e+01  0.00000000e+00]
 [-7.94967787e-03  1.82150003e-02]]
grads:  [1.03034118e-02 1.71490059e+01]
Stock Position:  0.010303411775424737
Bond Position:  [3.60839417]


portfolio before change:  [4.64263283]
curr_Stock_Price:  100.33449135952111
curr_Factors:  [1.00334491e+02 3.98008948e-02]
mat_Sqrt:  [[ 2.00168932e+01  0.00000000e+00]
 [-7.98006464e-03  1.82846251e-02]]
grads:  [1.00484403e-02 2.04916301e+01]
Stock Position:  0.010048440251836016
Bond Position:  [3.63442769]


portfolio before change:  [4.63594668]
curr_Stock_Price:  99.62388556956549
curr_Factors:  [9.96238856e+01 4.15301386e-02]
mat_Sqrt:  [[ 2.03022965e+01  0.00000000e+00]
 [-8.15157787e-03  1.86776113e-02]]
grads:  [1.06793187e-03 7.40346376e+00]
Stock Position:  0.0010679318666837081
Bond Position:  [4.52955516]


portfolio before change:  [4.63576096]
curr_Stock_Price:  98.91976567055289
curr_Factors:  [9.89197657e+01 4.07286983e-02]
mat_Sqrt:  [[ 1.99633465e+01  0.00000000e+00]
 [-8.07254094e-03  1.84965150e-02]]
grads:  [2.03284065e-03 2.60479301e+00]
Stock Position:  0.0020328406532100223
Bond Position:  [4.43467284]


portfolio before change:  [4.63457537]
curr_Stock_Price:  98.06384186549133
curr_Factors:  [9.80638419e+01 4.13756453e-02]
mat_Sqrt:  [[ 1.99471702e+01  0.00000000e+00]
 [-8.13640169e-03  1.86428383e-02]]
grads:  [ 0.01572371 -1.74734655]
Stock Position:  0.015723706151688464
Bond Position:  [3.09264834]


portfolio before change:  [4.63188593]
curr_Stock_Price:  97.86821060825405
curr_Factors:  [9.78682106e+01 4.11221576e-02]
mat_Sqrt:  [[ 1.98463019e+01  0.00000000e+00]
 [-8.11143958e-03  1.85856429e-02]]
grads:  [4.95937644e-03 1.17057502e+01]
Stock Position:  0.004959376443078445
Bond Position:  [4.14652063]


portfolio before change:  [4.62982705]
curr_Stock_Price:  97.3485422950641
curr_Factors:  [9.73485423e+01 4.18634556e-02]
mat_Sqrt:  [[ 1.99180579e+01  0.00000000e+00]
 [-8.18422439e-03  1.87524139e-02]]
grads:  [-6.27932617e-03  7.18190242e+00]
Stock Position:  -0.006279326165153065
Bond Position:  [5.2411103]


portfolio before change:  [4.62980449]
curr_Stock_Price:  97.45647398512355
curr_Factors:  [9.74564740e+01 4.20242657e-02]
mat_Sqrt:  [[ 1.99784026e+01  0.00000000e+00]
 [-8.19992836e-03  1.87883962e-02]]
grads:  [-0.00804417 -3.86085891]
Stock Position:  -0.008044171871058376
Bond Position:  [5.41376112]


portfolio before change:  [4.6170215]
curr_Stock_Price:  99.12970451872606
curr_Factors:  [9.91297045e+01 4.26409946e-02]
mat_Sqrt:  [[ 2.04699827e+01  0.00000000e+00]
 [-8.25987841e-03  1.89257590e-02]]
grads:  [ 6.93596271e-04 -2.92090829e+00]
Stock Position:  0.0006935962714703091
Bond Position:  [4.5482655]


portfolio before change:  [4.61669676]
curr_Stock_Price:  97.84177840295197
curr_Factors:  [9.78417784e+01 4.28861567e-02]
mat_Sqrt:  [[ 2.02620276e+01  0.00000000e+00]
 [-8.28358925e-03  1.89800874e-02]]
grads:  [-0.045307   -5.45583645]
Stock Position:  -0.04530699930987032
Bond Position:  [9.04961415]


portfolio before change:  [4.6771534]
curr_Stock_Price:  96.53237006886607
curr_Factors:  [9.65323701e+01 4.41932485e-02]
mat_Sqrt:  [[ 2.02932185e+01  0.00000000e+00]
 [-8.40887612e-03  1.92671557e-02]]
grads:  [-0.00463485  3.63720624]
Stock Position:  -0.004634851873546539
Bond Position:  [5.12456664]


portfolio before change:  [4.68109908]
curr_Stock_Price:  95.8192788409638
curr_Factors:  [9.58192788e+01 4.52262722e-02]
mat_Sqrt:  [[ 2.03773776e+01  0.00000000e+00]
 [-8.50658777e-03  1.94910412e-02]]
grads:  [-2.98874792e-03 -6.15873041e+00]
Stock Position:  -0.002988747922794801
Bond Position:  [4.96747875]


portfolio before change:  [4.68257119]
curr_Stock_Price:  95.53449972774712
curr_Factors:  [9.55344997e+01 4.62701695e-02]
mat_Sqrt:  [[ 2.05499504e+01  0.00000000e+00]
 [-8.60420079e-03  1.97147007e-02]]
grads:  [4.13732244e-03 4.21626810e+00]
Stock Position:  0.0041373224415688125
Bond Position:  [4.28731416]


portfolio before change:  [4.68568679]
curr_Stock_Price:  96.15800673197646
curr_Factors:  [9.61580067e+01 4.66113613e-02]
mat_Sqrt:  [[ 2.07601910e+01  0.00000000e+00]
 [-8.63586580e-03  1.97872544e-02]]
grads:  [2.74934045e-04 8.17666042e+00]
Stock Position:  0.000274934044628076
Bond Position:  [4.65924968]


portfolio before change:  [4.68591254]
curr_Stock_Price:  94.86062946684383
curr_Factors:  [9.48606295e+01 4.76704335e-02]
mat_Sqrt:  [[ 2.07114523e+01  0.00000000e+00]
 [-8.73342393e-03  2.00107881e-02]]
grads:  [-0.07195247 -6.13741476]
Stock Position:  -0.07195246550622429
Bond Position:  [11.51136871]


portfolio before change:  [4.65582518]
curr_Stock_Price:  95.29878493369579
curr_Factors:  [9.52987849e+01 4.77382536e-02]
mat_Sqrt:  [[ 2.08219130e+01  0.00000000e+00]
 [-8.73963419e-03  2.00250176e-02]]
grads:  [2.48804807e-03 1.27073197e+01]
Stock Position:  0.002488048069111164
Bond Position:  [4.41871722]


portfolio before change:  [4.65721608]
curr_Stock_Price:  95.63580502471926
curr_Factors:  [9.56358050e+01 4.77102346e-02]
mat_Sqrt:  [[ 2.08894158e+01  0.00000000e+00]
 [-8.73706904e-03  2.00191401e-02]]
grads:  [-4.22152617e-03  5.46286023e+00]
Stock Position:  -0.004221526168051704
Bond Position:  [5.06094513]


portfolio before change:  [4.66149015]
curr_Stock_Price:  94.77322176867925
curr_Factors:  [9.47732218e+01 4.79702747e-02]
mat_Sqrt:  [[ 2.07573423e+01  0.00000000e+00]
 [-8.76084697e-03  2.00736222e-02]]
grads:  [ 0.05074006 -1.19791621]
Stock Position:  0.05074006484945683
Bond Position:  [-0.14730927]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.62295149]
Stock Price:  94.0140535551035
PL:  [4.62295149]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.53286126e-01  6.97682292e-01]
 [-1.77559026e-01 -7.52220829e-02]
 [ 8.13313963e-01 -6.91524182e-01]
 [-2.60178588e-02  2.59664464e-02]
 [-1.90914029e-02  1.10005028e-02]
 [ 6.55382737e-03  3.68130249e-02]
 [ 8.98952698e-03  3.09462762e-01]
 [ 2.13186976e-01 -2.07912510e-03]
 [ 1.52401246e-01  7.44663344e-02]
 [ 1.91772893e-01 -3.29074455e-02]
 [ 1.31029380e-01  2.37618613e-01]
 [ 1.55595122e-01  2.11839462e-01]
 [ 1.70544462e-01  3.38116556e-02]
 [-3.40994580e-01 -4.56032146e-01]
 [ 8.22270720e-02  2.27103504e-01]
 [ 5.36511061e-02 -2.01819730e-02]
 [-4.56854671e-02  1.20445839e-01]
 [-1.53145259e-01 -8.31056057e-03]
 [ 1.51033665e-02  6.07871830e-02]
 [-3.45905639e-02 -7.85877589e-02]
 [ 1.94902977e-01  1.02798545e-01]
 [ 1.75559244e-02  1.10802083e-01]
 [-1.41216402e-03  1.74303981e-01]
 [ 1.22237893e-01  1.99266464e-01]
 [ 8.33144309e-02  1.72820453e-01]
 [ 7.85263443e-01 -6.23321605e-01]
 [-4.35583923e-01  5.53949517e-01]
 [ 1.52053279e-01 -7.34550826e-03]
 [-4.63854113e-02 -6.36946821e-02]
 [ 4.92077215e-02 -2.29734811e-01]
 [ 1.23116550e-01 -6.46695319e-02]
 [ 2.94794878e-01 -2.65778576e-02]
 [ 2.59667909e-01  3.19829315e-01]
 [ 2.42005480e-01  1.97639004e-02]
 [-1.74333392e-01 -2.40305379e-01]
 [ 1.44447501e-01 -1.95396982e-01]
 [-1.61680929e-01  2.15102072e-01]
 [-1.21029057e-01  1.19403858e-01]
 [-1.25213179e-02  1.06780505e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.10538596]
curr_Stock_Price:  101.11419689233155
curr_Factors:  [1.01114197e+02 3.90470752e-02]
mat_Sqrt:  [[ 1.99805018e+01  0.00000000e+00]
 [-7.90413311e-03  1.81106441e-02]]
grads:  [3.29210772e-02 3.85233284e+01]
Stock Position:  0.03292107717266404
Bond Position:  [6.77659768]


portfolio before change:  [10.09038456]
curr_Stock_Price:  100.63278723799914
curr_Factors:  [1.00632787e+02 3.96116793e-02]
mat_Sqrt:  [[ 2.00286247e+01  0.00000000e+00]
 [-7.96107323e-03  1.82411103e-02]]
grads:  [-0.0105044  -4.12376667]
Stock Position:  -0.01050439745907674
Bond Position:  [11.14747136]


portfolio before change:  [10.10125465]
curr_Stock_Price:  99.7306348618842
curr_Factors:  [9.97306349e+01 4.16625731e-02]
mat_Sqrt:  [[ 2.03564306e+01  0.00000000e+00]
 [-8.16456472e-03  1.87073679e-02]]
grads:  [ 2.51275913e-02 -3.69653382e+01]
Stock Position:  0.025127591270573586
Bond Position:  [7.59526402]


portfolio before change:  [10.10836939]
curr_Stock_Price:  99.9759936724768
curr_Factors:  [9.99759937e+01 4.14536955e-02]
mat_Sqrt:  [[ 2.03552929e+01  0.00000000e+00]
 [-8.14407225e-03  1.86604138e-02]]
grads:  [-7.21442455e-04  1.39152576e+00]
Stock Position:  -0.0007214424554203458
Bond Position:  [10.18049632]


portfolio before change:  [10.10959832]
curr_Stock_Price:  100.03658628120439
curr_Factors:  [1.00036586e+02 4.09758818e-02]
mat_Sqrt:  [[ 2.02499063e+01  0.00000000e+00]
 [-8.09700012e-03  1.85525580e-02]]
grads:  [-0.0007057   0.59293725]
Stock Position:  -0.0007057015332933427
Bond Position:  [10.18019429]


portfolio before change:  [10.10956607]
curr_Stock_Price:  101.88561037427837
curr_Factors:  [1.01885610e+02 4.01354477e-02]
mat_Sqrt:  [[ 2.04115933e+01  0.00000000e+00]
 [-8.01353332e-03  1.83613115e-02]]
grads:  [1.10821082e-03 2.00492350e+00]
Stock Position:  0.0011082108214205502
Bond Position:  [9.99665533]


portfolio before change:  [10.11017629]
curr_Stock_Price:  101.30861099856139
curr_Factors:  [1.01308611e+02 4.12663778e-02]
mat_Sqrt:  [[ 2.05799605e+01  0.00000000e+00]
 [-8.12565102e-03  1.86182054e-02]]
grads:  [6.99953479e-03 1.66215140e+01]
Stock Position:  0.006999534786186051
Bond Position:  [9.40106314]


portfolio before change:  [10.10853041]
curr_Stock_Price:  100.90557139577885
curr_Factors:  [1.00905571e+02 4.30411578e-02]
mat_Sqrt:  [[ 2.09342361e+01  0.00000000e+00]
 [-8.29854521e-03  1.90143558e-02]]
grads:  [ 0.01014031 -0.10934502]
Stock Position:  0.010140306504699118
Bond Position:  [9.08531698]


portfolio before change:  [10.10161351]
curr_Stock_Price:  100.11145040695932
curr_Factors:  [1.00111450e+02 4.45448343e-02]
mat_Sqrt:  [[ 2.11291695e+01  0.00000000e+00]
 [-8.44225888e-03  1.93436452e-02]]
grads:  [0.00875098 3.84965366]
Stock Position:  0.008750983755772981
Bond Position:  [9.22553984]


portfolio before change:  [10.0925185]
curr_Stock_Price:  98.9403501686473
curr_Factors:  [9.89403502e+01 4.63833944e-02]
mat_Sqrt:  [[ 2.13085897e+01  0.00000000e+00]
 [-8.61472176e-03  1.97388073e-02]]
grads:  [ 0.00832579 -1.66714457]
Stock Position:  0.008325792962671366
Bond Position:  [9.26876163]


portfolio before change:  [10.08636897]
curr_Stock_Price:  98.06257240419666
curr_Factors:  [9.80625724e+01 4.63137196e-02]
mat_Sqrt:  [[ 2.11036761e+01  0.00000000e+00]
 [-8.60824903e-03  1.97239764e-02]]
grads:  [1.11229268e-02 1.20471962e+01]
Stock Position:  0.011122926795969134
Bond Position:  [8.99562615]


portfolio before change:  [10.08593309]
curr_Stock_Price:  97.9222854651871
curr_Factors:  [9.79222855e+01 4.77114680e-02]
mat_Sqrt:  [[ 2.13891207e+01  0.00000000e+00]
 [-8.73718197e-03  2.00193989e-02]]
grads:  [ 0.01159699 10.58170944]
Stock Position:  0.011596991151697442
Bond Position:  [8.95032921]


portfolio before change:  [10.09059735]
curr_Stock_Price:  98.22800279048096
curr_Factors:  [9.82280028e+01 4.49524467e-02]
mat_Sqrt:  [[ 2.08262933e+01  0.00000000e+00]
 [-8.48079682e-03  1.94319467e-02]]
grads:  [0.00889746 1.74000352]
Stock Position:  0.008897458385114361
Bond Position:  [9.21661779]


portfolio before change:  [10.10509829]
curr_Stock_Price:  99.72829458294463
curr_Factors:  [9.97282946e+01 4.44055360e-02]
mat_Sqrt:  [[ 2.10153656e+01  0.00000000e+00]
 [-8.42904844e-03  1.93133763e-02]]
grads:  [ -0.02569659 -23.61224367]
Stock Position:  -0.025696594316044218
Bond Position:  [12.66777581]


portfolio before change:  [10.11908799]
curr_Stock_Price:  99.24550157767742
curr_Factors:  [9.92455016e+01 4.52938650e-02]
mat_Sqrt:  [[ 2.11217803e+01  0.00000000e+00]
 [-8.51294214e-03  1.95056009e-02]]
grads:  [8.58560046e-03 1.16429894e+01]
Stock Position:  0.008585600460636542
Bond Position:  [9.26700577]


portfolio before change:  [10.12930238]
curr_Stock_Price:  100.30028327342214
curr_Factors:  [1.00300283e+02 4.38635888e-02]
mat_Sqrt:  [[ 2.10065262e+01  0.00000000e+00]
 [-8.37745439e-03  1.91951594e-02]]
grads:  [ 0.00213472 -1.0514095 ]
Stock Position:  0.0021347161616445723
Bond Position:  [9.91518974]


portfolio before change:  [10.12802184]
curr_Stock_Price:  99.11979326386849
curr_Factors:  [9.91197933e+01 4.48899098e-02]
mat_Sqrt:  [[ 2.10007475e+01  0.00000000e+00]
 [-8.47489562e-03  1.94184253e-02]]
grads:  [3.27674377e-04 6.20265739e+00]
Stock Position:  0.0003276743774388917
Bond Position:  [10.09554282]


portfolio before change:  [10.12963631]
curr_Stock_Price:  100.1953986620689
curr_Factors:  [1.00195399e+02 4.39191248e-02]
mat_Sqrt:  [[ 2.09978397e+01  0.00000000e+00]
 [-8.38275609e-03  1.92073072e-02]]
grads:  [-0.00746611 -0.43267703]
Stock Position:  -0.007466114970419482
Bond Position:  [10.87770668]


portfolio before change:  [10.13242737]
curr_Stock_Price:  100.00369796076473
curr_Factors:  [1.00003698e+02 4.39014890e-02]
mat_Sqrt:  [[ 2.09534570e+01  0.00000000e+00]
 [-8.38107287e-03  1.92034504e-02]]
grads:  [1.98693075e-03 3.16543026e+00]
Stock Position:  0.0019869307529696975
Bond Position:  [9.93372695]


portfolio before change:  [10.13470554]
curr_Stock_Price:  100.52529567985964
curr_Factors:  [1.00525296e+02 4.28651403e-02]
mat_Sqrt:  [[ 2.08126549e+01  0.00000000e+00]
 [-8.28155930e-03  1.89754362e-02]]
grads:  [-3.30996089e-03 -4.14155217e+00]
Stock Position:  -0.003309960887106301
Bond Position:  [10.46744034]


portfolio before change:  [10.13209852]
curr_Stock_Price:  101.70825048079637
curr_Factors:  [1.01708250e+02 4.16674881e-02]
mat_Sqrt:  [[ 2.07613143e+01  0.00000000e+00]
 [-8.16504630e-03  1.87084714e-02]]
grads:  [0.01154878 5.4947592 ]
Stock Position:  0.011548784243635535
Bond Position:  [8.95749188]


portfolio before change:  [10.13690008]
curr_Stock_Price:  102.02705527980483
curr_Factors:  [1.02027055e+02 4.16733208e-02]
mat_Sqrt:  [[ 2.08278483e+01  0.00000000e+00]
 [-8.16561775e-03  1.87097807e-02]]
grads:  [3.16470127e-03 5.92214762e+00]
Stock Position:  0.003164701268948187
Bond Position:  [9.81401493]


portfolio before change:  [10.14183019]
curr_Stock_Price:  103.19723881303568
curr_Factors:  [1.03197239e+02 4.19636638e-02]
mat_Sqrt:  [[ 2.11399900e+01  0.00000000e+00]
 [-8.19401379e-03  1.87748442e-02]]
grads:  [3.53171076e-03 9.28391092e+00]
Stock Position:  0.0035317107641216704
Bond Position:  [9.77736739]


portfolio before change:  [10.15326291]
curr_Stock_Price:  106.0883214231218
curr_Factors:  [1.06088321e+02 3.96732416e-02]
mat_Sqrt:  [[ 2.11308234e+01  0.00000000e+00]
 [-7.96725715e-03  1.82552795e-02]]
grads:  [9.90046167e-03 1.09155526e+01]
Stock Position:  0.009900461671472061
Bond Position:  [9.10293955]


portfolio before change:  [10.15999303]
curr_Stock_Price:  106.6531622450889
curr_Factors:  [1.06653162e+02 3.89377603e-02]
mat_Sqrt:  [[ 2.10454987e+01  0.00000000e+00]
 [-7.89306129e-03  1.80852754e-02]]
grads:  [7.54267992e-03 9.55586515e+00]
Stock Position:  0.007542679921618587
Bond Position:  [9.35554237]


portfolio before change:  [10.15257392]
curr_Stock_Price:  105.51449216002544
curr_Factors:  [1.05514492e+02 3.87886683e-02]
mat_Sqrt:  [[ 2.07809093e+01  0.00000000e+00]
 [-7.87793560e-03  1.80506181e-02]]
grads:  [ 2.46968784e-02 -3.45318704e+01]
Stock Position:  0.024696878445158332
Bond Position:  [7.54669534]


portfolio before change:  [10.14031398]
curr_Stock_Price:  104.97987626242714
curr_Factors:  [1.04979876e+02 3.89434387e-02]
mat_Sqrt:  [[ 2.07168254e+01  0.00000000e+00]
 [-7.89363680e-03  1.80865941e-02]]
grads:  [-9.35570630e-03  3.06276303e+01]
Stock Position:  -0.009355706298433264
Bond Position:  [11.12247486]


portfolio before change:  [10.15166949]
curr_Stock_Price:  103.91473809327076
curr_Factors:  [1.03914738e+02 4.10698133e-02]
mat_Sqrt:  [[ 2.10590372e+01  0.00000000e+00]
 [-8.10627542e-03  1.85738104e-02]]
grads:  [ 0.0070681  -0.39547665]
Stock Position:  0.007068102635765504
Bond Position:  [9.41718946]


portfolio before change:  [10.15749439]
curr_Stock_Price:  104.57229457340452
curr_Factors:  [1.04572295e+02 4.10633291e-02]
mat_Sqrt:  [[ 2.11906225e+01  0.00000000e+00]
 [-8.10563548e-03  1.85723441e-02]]
grads:  [-0.0035008  -3.42954459]
Stock Position:  -0.0035007961414632895
Bond Position:  [10.52358068]


portfolio before change:  [10.15646703]
curr_Stock_Price:  105.24153837447076
curr_Factors:  [1.05241538e+02 4.13997045e-02]
mat_Sqrt:  [[ 2.14134088e+01  0.00000000e+00]
 [-8.13876693e-03  1.86482578e-02]]
grads:  [-2.38433641e-03 -1.23193713e+01]
Stock Position:  -0.002384336410376022
Bond Position:  [10.40739827]


portfolio before change:  [10.15126377]
curr_Stock_Price:  107.969455346611
curr_Factors:  [1.07969455e+02 3.97789503e-02]
mat_Sqrt:  [[ 2.15341419e+01  0.00000000e+00]
 [-7.97786440e-03  1.82795838e-02]]
grads:  [ 0.0044066  -3.53780112]
Stock Position:  0.0044066047638226195
Bond Position:  [9.67548505]


portfolio before change:  [10.15864538]
curr_Stock_Price:  109.37010403116764
curr_Factors:  [1.09370104e+02 3.91598675e-02]
mat_Sqrt:  [[ 2.16430883e+01  0.00000000e+00]
 [-7.91554092e-03  1.81367827e-02]]
grads:  [ 0.01308479 -1.46541192]
Stock Position:  0.013084793892402469
Bond Position:  [8.72756012]


portfolio before change:  [10.13019106]
curr_Stock_Price:  107.1121138360713
curr_Factors:  [1.07112114e+02 4.02252304e-02]
mat_Sqrt:  [[ 2.14826504e+01  0.00000000e+00]
 [-8.02249143e-03  1.83818371e-02]]
grads:  [ 0.0185849  17.39920299]
Stock Position:  0.01858489798937858
Bond Position:  [8.13952335]


portfolio before change:  [10.13235428]
curr_Stock_Price:  107.17376134405524
curr_Factors:  [1.07173761e+02 4.08811569e-02]
mat_Sqrt:  [[ 2.16695584e+01  0.00000000e+00]
 [-8.08763569e-03  1.85311014e-02]]
grads:  [0.01156605 1.06652594]
Stock Position:  0.011566047990930448
Bond Position:  [8.89277741]


portfolio before change:  [10.13384648]
curr_Stock_Price:  107.20666279089725
curr_Factors:  [1.07206663e+02 4.28586671e-02]
mat_Sqrt:  [[ 2.21942824e+01  0.00000000e+00]
 [-8.28093397e-03  1.89740034e-02]]
grads:  [-1.25803237e-02 -1.26649803e+01]
Stock Position:  -0.012580323746674288
Bond Position:  [11.48254101]


portfolio before change:  [10.16107243]
curr_Stock_Price:  105.15659306502268
curr_Factors:  [1.05156593e+02 4.21602672e-02]
mat_Sqrt:  [[ 2.15917670e+01  0.00000000e+00]
 [-8.21318620e-03  1.88187737e-02]]
grads:  [ 2.74036239e-03 -1.03830879e+01]
Stock Position:  0.002740362390086243
Bond Position:  [9.87290526]


portfolio before change:  [10.15900526]
curr_Stock_Price:  103.95187477344761
curr_Factors:  [1.03951875e+02 4.31086019e-02]
mat_Sqrt:  [[ 2.15831235e+01  0.00000000e+00]
 [-8.30504443e-03  1.90292474e-02]]
grads:  [-3.14146785e-03  1.13037614e+01]
Stock Position:  -0.003141467847376803
Bond Position:  [10.48556673]


portfolio before change:  [10.16263489]
curr_Stock_Price:  103.21373121674581
curr_Factors:  [1.03213731e+02 4.38179209e-02]
mat_Sqrt:  [[ 2.16054523e+01  0.00000000e+00]
 [-8.37309223e-03  1.91851645e-02]]
grads:  [-3.18979396e-03  6.22375995e+00]
Stock Position:  -0.003189793956730208
Bond Position:  [10.49186543]


portfolio before change:  [10.16600963]
curr_Stock_Price:  102.56692556763991
curr_Factors:  [1.02566926e+02 4.46540271e-02]
mat_Sqrt:  [[ 2.16739294e+01  0.00000000e+00]
 [-8.45259980e-03  1.93673392e-02]]
grads:  [1.57246591e-03 5.51343187e+00]
Stock Position:  0.0015724659138990106
Bond Position:  [10.00472664]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.16867548]
Stock Price:  103.46689982194037
PL:  [6.70177566]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-4.02776330e-01 -1.86659375e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.29530821e-01 -7.20448362e-01]
 [-3.15047159e-02  1.48389811e-01]
 [ 3.41486106e-02 -5.29066159e-02]
 [-8.15061591e-02 -9.88425359e-02]
 [-3.07108062e-02  2.24360490e-01]
 [ 4.11432790e-02 -5.22039817e-02]
 [ 1.38209166e-01  7.89798701e-02]
 [ 4.12874151e-01 -2.42828663e-01]
 [ 6.22410038e-02 -5.63382128e-03]
 [-1.36679538e-01 -1.77399727e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-5.21951267e-01 -6.68537161e-01]
 [ 3.96206373e-02  5.75398485e-02]
 [ 6.06021796e-02 -3.57742952e-02]
 [-5.34421655e-02  2.97165267e-01]
 [-4.31327243e-02  1.27405624e-01]
 [ 1.48720267e-02  6.65313838e-02]
 [-9.85779797e-02 -3.77694982e-02]
 [ 2.14845254e-01  3.45145619e-01]
 [ 1.98509475e-02  1.16645916e-01]
 [-1.03566960e-02 -3.16457509e-02]
 [ 8.55763484e-02  1.86504519e-01]
 [ 6.91163222e-02  1.45544360e-01]
 [ 7.69718980e-01 -5.59752201e-01]
 [-3.42317998e-01  4.40470032e-01]
 [ 1.33288384e-01  1.94652035e-03]
 [-4.47992312e-02 -6.54281139e-02]
 [-4.67828813e-03 -1.60191612e-01]
 [-1.54863009e-01 -8.00025630e-02]
 [-6.51812491e-02 -2.86792970e-03]
 [ 2.04103608e-01  2.27236216e-01]
 [ 2.18411135e-01  3.18688404e-02]
 [-1.94027001e-01 -2.36229705e-01]
 [ 1.81932502e-01 -7.81894467e-02]
 [-2.15512577e-01  1.74257792e-01]
 [-1.15036660e-01  1.23446452e-01]
 [-2.63415330e-01  1.65461977e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.00294177]
curr_Stock_Price:  98.38678964592165
curr_Factors:  [9.83867896e+01 3.94641300e-02]
mat_Sqrt:  [[ 1.95451072e+01  0.00000000e+00]
 [-7.94623232e-03  1.82071055e-02]]
grads:  [ -0.02477557 -10.25200711]
Stock Position:  -0.0247755694480051
Bond Position:  [-5.56535303]


portfolio before change:  [-8.00345452]
curr_Stock_Price:  98.37940514998174
curr_Factors:  [9.83794051e+01 3.98484052e-02]
mat_Sqrt:  [[ 1.96385611e+01  0.00000000e+00]
 [-7.98482613e-03  1.82955351e-02]]
grads:  [-0.01033601 -4.81053819]
Stock Position:  -0.010336014264713705
Bond Position:  [-6.98660359]


portfolio before change:  [-8.01332373]
curr_Stock_Price:  99.24974275708561
curr_Factors:  [9.92497428e+01 3.77724832e-02]
mat_Sqrt:  [[ 1.92893307e+01  0.00000000e+00]
 [-7.77405770e-03  1.78126039e-02]]
grads:  [ 2.67039529e-02 -4.04459878e+01]
Stock Position:  0.026703952869078233
Bond Position:  [-10.66368418]


portfolio before change:  [-8.04308007]
curr_Stock_Price:  98.18535710920077
curr_Factors:  [9.81853571e+01 3.78786665e-02]
mat_Sqrt:  [[ 1.91092686e+01  0.00000000e+00]
 [-7.78497697e-03  1.78376231e-02]]
grads:  [1.74040712e-03 8.31892287e+00]
Stock Position:  0.0017404071158856312
Bond Position:  [-8.21396257]


portfolio before change:  [-8.04440291]
curr_Stock_Price:  98.01526434044347
curr_Factors:  [9.80152643e+01 3.77848894e-02]
mat_Sqrt:  [[ 1.90525361e+01  0.00000000e+00]
 [-7.77533427e-03  1.78155289e-02]]
grads:  [ 5.80409366e-04 -2.96969100e+00]
Stock Position:  0.0005804093658467396
Bond Position:  [-8.10129189]


portfolio before change:  [-8.04523954]
curr_Stock_Price:  98.31866152176075
curr_Factors:  [9.83186615e+01 3.70919710e-02]
mat_Sqrt:  [[ 1.89354623e+01  0.00000000e+00]
 [-7.70371038e-03  1.76514180e-02]]
grads:  [-0.0065826  -5.59969381]
Stock Position:  -0.00658260021708125
Bond Position:  [-7.3980471]


portfolio before change:  [-8.05302356]
curr_Stock_Price:  99.36068107706286
curr_Factors:  [9.93606811e+01 3.73994626e-02]
mat_Sqrt:  [[ 1.92153032e+01  0.00000000e+00]
 [-7.73557627e-03  1.77244319e-02]]
grads:  [3.49763617e-03 1.26582613e+01]
Stock Position:  0.0034976361749118035
Bond Position:  [-8.40055107]


portfolio before change:  [-8.05318418]
curr_Stock_Price:  99.61500016099937
curr_Factors:  [9.96150002e+01 3.74154341e-02]
mat_Sqrt:  [[ 1.92685988e+01  0.00000000e+00]
 [-7.73722784e-03  1.77282161e-02]]
grads:  [ 9.52824526e-04 -2.94468329e+00]
Stock Position:  0.000952824526344407
Bond Position:  [-8.14809979]


portfolio before change:  [-8.05311082]
curr_Stock_Price:  100.76099087766355
curr_Factors:  [1.00760991e+02 3.59603454e-02]
mat_Sqrt:  [[ 1.91075215e+01  0.00000000e+00]
 [-7.58528527e-03  1.73800720e-02]]
grads:  [0.00903722 4.54427751]
Stock Position:  0.009037216435128162
Bond Position:  [-8.96370971]


portfolio before change:  [-8.03710859]
curr_Stock_Price:  102.65568561258773
curr_Factors:  [1.02655686e+02 3.60812619e-02]
mat_Sqrt:  [[ 1.94995176e+01  0.00000000e+00]
 [-7.59802732e-03  1.74092677e-02]]
grads:  [  0.0157386  -13.94824113]
Stock Position:  0.015738596205614314
Bond Position:  [-9.65276497]


portfolio before change:  [-8.03468901]
curr_Stock_Price:  102.88609034770055
curr_Factors:  [1.02886090e+02 3.50766141e-02]
mat_Sqrt:  [[ 1.92692804e+01  0.00000000e+00]
 [-7.49150069e-03  1.71651845e-02]]
grads:  [ 0.00310246 -0.3282121 ]
Stock Position:  0.0031024616042887062
Bond Position:  [-8.35388916]


portfolio before change:  [-8.03889586]
curr_Stock_Price:  101.86672436627063
curr_Factors:  [1.01866724e+02 3.56462006e-02]
mat_Sqrt:  [[ 1.92326427e+01  0.00000000e+00]
 [-7.55208057e-03  1.73039904e-02]]
grads:  [ -0.01113228 -10.25195478]
Stock Position:  -0.0111322780564723
Bond Position:  [-6.90488716]


portfolio before change:  [-8.04679804]
curr_Stock_Price:  102.4990310036967
curr_Factors:  [1.02499031e+02 3.54854758e-02]
mat_Sqrt:  [[ 1.93083462e+01  0.00000000e+00]
 [-7.53503559e-03  1.72649355e-02]]
grads:  [-6.25595886e-03  9.58773618e+00]
Stock Position:  -0.006255958864815626
Bond Position:  [-7.40556832]


portfolio before change:  [-8.04317408]
curr_Stock_Price:  101.77176975045795
curr_Factors:  [1.01771770e+02 3.33685809e-02]
mat_Sqrt:  [[ 1.85907194e+01  0.00000000e+00]
 [-7.30682760e-03  1.67420453e-02]]
grads:  [ -0.04377049 -39.93163023]
Stock Position:  -0.04377048504612396
Bond Position:  [-3.58857435]


portfolio before change:  [-8.08716271]
curr_Stock_Price:  102.76650486454189
curr_Factors:  [1.02766505e+02 3.31166626e-02]
mat_Sqrt:  [[ 1.87014322e+01  0.00000000e+00]
 [-7.27919365e-03  1.66787279e-02]]
grads:  [0.0034614 3.4498943]
Stock Position:  0.00346139724490051
Bond Position:  [-8.44287841]


portfolio before change:  [-8.08846501]
curr_Stock_Price:  102.69518501629702
curr_Factors:  [1.02695185e+02 3.30983891e-02]
mat_Sqrt:  [[ 1.86832967e+01  0.00000000e+00]
 [-7.27718507e-03  1.66741257e-02]]
grads:  [ 0.00240798 -2.14549751]
Stock Position:  0.0024079795925644365
Bond Position:  [-8.33575292]


portfolio before change:  [-8.08756353]
curr_Stock_Price:  103.50229550577916
curr_Factors:  [1.03502296e+02 3.15183528e-02]
mat_Sqrt:  [[ 1.83751857e+01  0.00000000e+00]
 [-7.10136356e-03  1.62712680e-02]]
grads:  [4.14969354e-03 1.82631904e+01]
Stock Position:  0.004149693538932818
Bond Position:  [-8.51706634]


portfolio before change:  [-8.09100638]
curr_Stock_Price:  102.92920678930915
curr_Factors:  [1.02929207e+02 3.20748733e-02]
mat_Sqrt:  [[ 1.84340644e+01  0.00000000e+00]
 [-7.16378373e-03  1.64142906e-02]]
grads:  [6.76554457e-04 7.76187206e+00]
Stock Position:  0.0006765544571105922
Bond Position:  [-8.16064359]


portfolio before change:  [-8.09226489]
curr_Stock_Price:  102.576878142907
curr_Factors:  [1.02576878e+02 3.35007288e-02]
mat_Sqrt:  [[ 1.87748556e+01  0.00000000e+00]
 [-7.32128172e-03  1.67751638e-02]]
grads:  [2.33869725e-03 3.96606462e+00]
Stock Position:  0.002338697250492096
Bond Position:  [-8.33216115]


portfolio before change:  [-8.09179148]
curr_Stock_Price:  103.22467270333695
curr_Factors:  [1.03224673e+02 3.34027226e-02]
mat_Sqrt:  [[ 1.88657662e+01  0.00000000e+00]
 [-7.31056469e-03  1.67506080e-02]]
grads:  [-0.00609898 -2.25481356]
Stock Position:  -0.006098980498505669
Bond Position:  [-7.46222621]


portfolio before change:  [-8.10372034]
curr_Stock_Price:  105.02760097151784
curr_Factors:  [1.05027601e+02 3.09778493e-02]
mat_Sqrt:  [[ 1.84854095e+01  0.00000000e+00]
 [-7.04021014e-03  1.61311479e-02]]
grads:  [1.97712228e-02 2.13962218e+01]
Stock Position:  0.019771222841722353
Bond Position:  [-10.18024444]


portfolio before change:  [-8.09774417]
curr_Stock_Price:  105.39423384895561
curr_Factors:  [1.05394234e+02 3.08904920e-02]
mat_Sqrt:  [[ 1.85237650e+01  0.00000000e+00]
 [-7.03027647e-03  1.61083870e-02]]
grads:  [3.81992530e-03 7.24131568e+00]
Stock Position:  0.0038199252981503556
Bond Position:  [-8.50034227]


portfolio before change:  [-8.10118072]
curr_Stock_Price:  104.77277065724526
curr_Factors:  [1.04772771e+02 3.07757760e-02]
mat_Sqrt:  [[ 1.83803144e+01  0.00000000e+00]
 [-7.01721039e-03  1.60784489e-02]]
grads:  [-1.31488687e-03 -1.96820919e+00]
Stock Position:  -0.0013148868693883052
Bond Position:  [-7.96341638]


portfolio before change:  [-8.10173631]
curr_Stock_Price:  104.43821641517194
curr_Factors:  [1.04438216e+02 3.19958826e-02]
mat_Sqrt:  [[ 1.86812742e+01  0.00000000e+00]
 [-7.15495718e-03  1.63940664e-02]]
grads:  [8.93801956e-03 1.13763428e+01]
Stock Position:  0.008938019555089818
Bond Position:  [-9.03520713]


portfolio before change:  [-8.09367659]
curr_Stock_Price:  105.46631773654296
curr_Factors:  [1.05466318e+02 3.34491705e-02]
mat_Sqrt:  [[ 1.92888555e+01  0.00000000e+00]
 [-7.31564575e-03  1.67622502e-02]]
grads:  [6.87635866e-03 8.68286523e+00]
Stock Position:  0.006876358655765552
Bond Position:  [-8.81890082]


portfolio before change:  [-8.0992258]
curr_Stock_Price:  104.81964116871009
curr_Factors:  [1.04819641e+02 3.20088512e-02]
mat_Sqrt:  [[ 1.87533005e+01  0.00000000e+00]
 [-7.15640706e-03  1.63973885e-02]]
grads:  [ 2.80176330e-02 -3.41366675e+01]
Stock Position:  0.028017633009181635
Bond Position:  [-11.03602404]


portfolio before change:  [-8.1210476]
curr_Stock_Price:  104.09002176145255
curr_Factors:  [1.04090022e+02 3.22975133e-02]
mat_Sqrt:  [[ 1.87065476e+01  0.00000000e+00]
 [-7.18860357e-03  1.64711600e-02]]
grads:  [-8.02291902e-03  2.67418950e+01]
Stock Position:  -0.00802291902474433
Bond Position:  [-7.28594179]


portfolio before change:  [-8.11615996]
curr_Stock_Price:  103.3672873506912
curr_Factors:  [1.03367287e+02 3.25157333e-02]
mat_Sqrt:  [[ 1.86393128e+01  0.00000000e+00]
 [-7.21284779e-03  1.65267105e-02]]
grads:  [0.00719651 0.11778027]
Stock Position:  0.0071965054287000535
Bond Position:  [-8.86004321]


portfolio before change:  [-8.11480906]
curr_Stock_Price:  103.70890783643438
curr_Factors:  [1.03708908e+02 3.24741242e-02]
mat_Sqrt:  [[ 1.86889449e+01  0.00000000e+00]
 [-7.20823132e-03  1.65161328e-02]]
grads:  [-3.92501564e-03 -3.96146692e+00]
Stock Position:  -0.003925015637667223
Bond Position:  [-7.70774998]


portfolio before change:  [-8.11810425]
curr_Stock_Price:  104.30295906024693
curr_Factors:  [1.04302959e+02 3.17590662e-02]
mat_Sqrt:  [[ 1.85879070e+01  0.00000000e+00]
 [-7.12842941e-03  1.63332837e-02]]
grads:  [-4.01291223e-03 -9.80767954e+00]
Stock Position:  -0.004012912229310561
Bond Position:  [-7.69954563]


portfolio before change:  [-8.11866926]
curr_Stock_Price:  104.20390455335959
curr_Factors:  [1.04203905e+02 3.11019751e-02]
mat_Sqrt:  [[ 1.83771423e+01  0.00000000e+00]
 [-7.05430083e-03  1.61634338e-02]]
grads:  [-0.0103269  -4.94960193]
Stock Position:  -0.01032690431244002
Bond Position:  [-7.04256551]


portfolio before change:  [-8.11852483]
curr_Stock_Price:  104.10466797115924
curr_Factors:  [1.04104668e+02 3.25165636e-02]
mat_Sqrt:  [[ 1.87725178e+01  0.00000000e+00]
 [-7.21293988e-03  1.65269215e-02]]
grads:  [-0.00353884 -0.17353079]
Stock Position:  -0.0035388388999244426
Bond Position:  [-7.75011518]


portfolio before change:  [-8.12263762]
curr_Stock_Price:  104.9930868544072
curr_Factors:  [1.04993087e+02 3.22233217e-02]
mat_Sqrt:  [[ 1.88471574e+01  0.00000000e+00]
 [-7.18034224e-03  1.64522309e-02]]
grads:  [ 0.01609143 13.81187859]
Stock Position:  0.016091425168267597
Bond Position:  [-9.81212602]


portfolio before change:  [-8.10776011]
curr_Stock_Price:  105.99387495934552
curr_Factors:  [1.05993875e+02 3.08819081e-02]
mat_Sqrt:  [[ 1.86265676e+01  0.00000000e+00]
 [-7.02929961e-03  1.61061488e-02]]
grads:  [0.0124725 1.9786754]
Stock Position:  0.012472498557874299
Bond Position:  [-9.42976856]


portfolio before change:  [-8.10701026]
curr_Stock_Price:  106.14850682509235
curr_Factors:  [1.06148507e+02 3.06675596e-02]
mat_Sqrt:  [[ 1.85888918e+01  0.00000000e+00]
 [-7.00486227e-03  1.60501558e-02]]
grads:  [ -0.01598407 -14.71821884]
Stock Position:  -0.015984067307072792
Bond Position:  [-6.41032538]


portfolio before change:  [-8.11767015]
curr_Stock_Price:  106.76528041363731
curr_Factors:  [1.06765280e+02 3.02162867e-02]
mat_Sqrt:  [[ 1.85588299e+01  0.00000000e+00]
 [-6.95313301e-03  1.59316292e-02]]
grads:  [ 0.00796429 -4.90781237]
Stock Position:  0.007964286023132948
Bond Position:  [-8.96797938]


portfolio before change:  [-8.11555465]
curr_Stock_Price:  107.17166553989864
curr_Factors:  [1.07171666e+02 2.93889468e-02]
mat_Sqrt:  [[ 1.83726580e+01  0.00000000e+00]
 [-6.85728189e-03  1.57120067e-02]]
grads:  [-7.59064048e-03  1.10907407e+01]
Stock Position:  -0.007590640475321803
Bond Position:  [-7.30205307]


portfolio before change:  [-8.12438164]
curr_Stock_Price:  108.21428875355146
curr_Factors:  [1.08214289e+02 2.78014015e-02]
mat_Sqrt:  [[ 1.80433824e+01  0.00000000e+00]
 [-6.66950092e-03  1.52817464e-02]]
grads:  [-3.38962010e-03  8.07803301e+00]
Stock Position:  -0.003389620099566784
Bond Position:  [-7.75757631]


portfolio before change:  [-8.12695607]
curr_Stock_Price:  108.68769473373898
curr_Factors:  [1.08687695e+02 2.72562460e-02]
mat_Sqrt:  [[ 1.79437577e+01  0.00000000e+00]
 [-6.60378630e-03  1.51311753e-02]]
grads:  [-1.06556166e-02  1.09351702e+01]
Stock Position:  -0.010655616575021556
Bond Position:  [-6.96882166]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.12463545]
Stock Price:  108.38815568665676
PL:  [-16.51279114]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.69132867e-01 -6.17529146e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.17826525e-01 -6.99302706e-01]
 [-3.54206866e-02  4.42003465e-02]
 [-6.49902878e-02  2.93696891e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-4.93621665e-02  1.94977272e-01]
 [-8.85670696e-02 -1.07367467e-01]
 [ 1.66356811e-01  8.92073155e-02]
 [ 3.15304430e-01 -1.47543414e-01]
 [ 8.27930892e-02  6.62909468e-02]
 [-1.10989123e-01 -3.30129994e-02]
 [-5.89061657e-02  1.22152586e-01]
 [-4.19655515e-01 -5.48406976e-01]
 [ 7.99856468e-02  2.25295801e-01]
 [ 5.30704358e-02 -1.98119974e-02]
 [-5.13091136e-02  1.77259513e-01]
 [-1.48297171e-01  1.31040179e-02]
 [ 1.49733261e-02  6.40161056e-02]
 [-1.87151595e-02 -8.35628855e-02]
 [ 1.09265382e-01  1.44653742e-02]
 [ 8.95179400e-02  3.08503843e-01]
 [ 3.79528940e-02  3.94213149e-01]
 [-4.20123981e-02  1.35961812e-01]
 [ 2.67241314e-02  6.11912968e-02]
 [ 6.77302463e-01 -2.35164011e-01]
 [ 9.62480815e-03  8.08628213e-02]
 [-4.18298023e-02  7.30971537e-02]
 [-1.28498026e-03 -1.04887483e-01]
 [-6.97393667e-02 -6.09418322e-02]
 [-5.24173239e-01 -1.02752571e-01]
 [-1.17966069e-01  1.19268718e-03]
 [ 1.56223604e-01  1.47448333e-01]
 [ 1.38525205e-01  7.28538487e-02]
 [-1.62251484e-01  7.54293078e-02]
 [-3.91750406e-01 -3.57549901e-01]
 [-9.65623090e-02  2.72917767e-01]
 [-1.22044138e-01  1.18719064e-01]
 [ 3.12832289e-02  1.01311186e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.37918746]
curr_Stock_Price:  98.9325856957777
curr_Factors:  [9.89325857e+01 3.97268001e-02]
mat_Sqrt:  [[ 1.97188304e+01  0.00000000e+00]
 [-7.97263320e-03  1.82675976e-02]]
grads:  [-0.01501529 -3.38046174]
Stock Position:  -0.015015294620016767
Bond Position:  [-2.89368554]


portfolio before change:  [-4.37830289]
curr_Stock_Price:  98.84958296675698
curr_Factors:  [9.88495830e+01 4.04539056e-02]
mat_Sqrt:  [[ 1.98817711e+01  0.00000000e+00]
 [-8.04526251e-03  1.84340122e-02]]
grads:  [-0.01020958 -4.7744012 ]
Stock Position:  -0.010209575741716327
Bond Position:  [-3.36909058]


portfolio before change:  [-4.38641325]
curr_Stock_Price:  99.60271927836398
curr_Factors:  [9.96027193e+01 4.02887691e-02]
mat_Sqrt:  [[ 1.99923200e+01  0.00000000e+00]
 [-8.02882498e-03  1.83963491e-02]]
grads:  [ 2.56411363e-02 -3.80131243e+01]
Stock Position:  0.025641136315887263
Bond Position:  [-6.94034015]


portfolio before change:  [-4.38466985]
curr_Stock_Price:  99.7045476943542
curr_Factors:  [9.97045477e+01 4.00158128e-02]
mat_Sqrt:  [[ 1.99448507e+01  0.00000000e+00]
 [-8.00158112e-03  1.83339256e-02]]
grads:  [-8.08733749e-04  2.41085011e+00]
Stock Position:  -0.0008087337488861586
Bond Position:  [-4.30403542]


portfolio before change:  [-4.38588837]
curr_Stock_Price:  100.54596080688185
curr_Factors:  [1.00545961e+02 3.91698414e-02]
mat_Sqrt:  [[ 1.98994254e+01  0.00000000e+00]
 [-7.91654889e-03  1.81390923e-02]]
grads:  [-0.0026218   1.61913775]
Stock Position:  -0.0026217995571422587
Bond Position:  [-4.12227701]


portfolio before change:  [-4.38437798]
curr_Stock_Price:  99.77332225903756
curr_Factors:  [9.97733223e+01 4.20431733e-02]
mat_Sqrt:  [[ 2.04579531e+01  0.00000000e+00]
 [-8.20177282e-03  1.87926224e-02]]
grads:  [-0.0057885 -3.528881 ]
Stock Position:  -0.0057884956206033875
Bond Position:  [-3.80684054]


portfolio before change:  [-4.37930601]
curr_Stock_Price:  98.81489415065272
curr_Factors:  [9.88148942e+01 4.37056992e-02]
mat_Sqrt:  [[ 2.06581509e+01  0.00000000e+00]
 [-8.36236323e-03  1.91605812e-02]]
grads:  [1.72972362e-03 1.01759581e+01]
Stock Position:  0.0017297236165479827
Bond Position:  [-4.55022847]


portfolio before change:  [-4.3818307]
curr_Stock_Price:  97.68414810167988
curr_Factors:  [9.76841481e+01 4.37719915e-02]
mat_Sqrt:  [[ 2.04372401e+01  0.00000000e+00]
 [-8.36870279e-03  1.91751070e-02]]
grads:  [-0.00662644 -5.59931514]
Stock Position:  -0.006626436513710671
Bond Position:  [-3.7345329]


portfolio before change:  [-4.38711781]
curr_Stock_Price:  98.41157747011351
curr_Factors:  [9.84115775e+01 4.29436455e-02]
mat_Sqrt:  [[ 2.03936822e+01  0.00000000e+00]
 [-8.28913945e-03  1.89928045e-02]]
grads:  [0.01006636 4.69690064]
Stock Position:  0.010066356470245837
Bond Position:  [-5.37776383]


portfolio before change:  [-4.3612047]
curr_Stock_Price:  101.05259037845018
curr_Factors:  [1.01052590e+02 4.19975964e-02]
mat_Sqrt:  [[ 2.07090258e+01  0.00000000e+00]
 [-8.19732604e-03  1.87824335e-02]]
grads:  [ 0.01211603 -7.85539393]
Stock Position:  0.012116031311308109
Bond Position:  [-5.58556105]


portfolio before change:  [-4.37216127]
curr_Stock_Price:  100.2059161307076
curr_Factors:  [1.00205916e+02 4.16868363e-02]
mat_Sqrt:  [[ 2.04593971e+01  0.00000000e+00]
 [-8.16694179e-03  1.87128145e-02]]
grads:  [0.00546081 3.54254283]
Stock Position:  0.005460807561275627
Bond Position:  [-4.91936649]


portfolio before change:  [-4.3719781]
curr_Stock_Price:  100.35207163152099
curr_Factors:  [1.00352072e+02 4.00264681e-02]
mat_Sqrt:  [[ 2.00770535e+01  0.00000000e+00]
 [-8.00264637e-03  1.83363664e-02]]
grads:  [-0.0062458 -1.8004112]
Stock Position:  -0.006245795830945296
Bond Position:  [-3.74519955]


portfolio before change:  [-4.37383017]
curr_Stock_Price:  100.5736430162652
curr_Factors:  [1.00573643e+02 3.89687141e-02]
mat_Sqrt:  [[ 1.98537349e+01  0.00000000e+00]
 [-7.89619798e-03  1.80924625e-02]]
grads:  [-2.81781053e-04  6.75157329e+00]
Stock Position:  -0.00028178105272923997
Bond Position:  [-4.34549042]


portfolio before change:  [-4.37438381]
curr_Stock_Price:  100.61061892875354
curr_Factors:  [1.00610619e+02 3.82561115e-02]
mat_Sqrt:  [[ 1.96786016e+01  0.00000000e+00]
 [-7.82366784e-03  1.79262750e-02]]
grads:  [ -0.03348815 -30.59235537]
Stock Position:  -0.03348814900044774
Bond Position:  [-1.00512041]


portfolio before change:  [-4.34894945]
curr_Stock_Price:  99.84736351761916
curr_Factors:  [9.98473635e+01 3.83112622e-02]
mat_Sqrt:  [[ 1.95433870e+01  0.00000000e+00]
 [-7.82930517e-03  1.79391918e-02]]
grads:  [9.12394540e-03 1.25588602e+01]
Stock Position:  0.009123945398941371
Bond Position:  [-5.25995134]


portfolio before change:  [-4.35132702]
curr_Stock_Price:  99.65884403848611
curr_Factors:  [9.96588440e+01 3.81821381e-02]
mat_Sqrt:  [[ 1.94735876e+01  0.00000000e+00]
 [-7.81610012e-03  1.79089352e-02]]
grads:  [ 0.00228123 -1.10626328]
Stock Position:  0.0022812320088031793
Bond Position:  [-4.57867197]


portfolio before change:  [-4.35202194]
curr_Stock_Price:  99.60512240797618
curr_Factors:  [9.96051224e+01 3.92356900e-02]
mat_Sqrt:  [[ 1.97297836e+01  0.00000000e+00]
 [-7.92320037e-03  1.81543327e-02]]
grads:  [1.32050513e-03 9.76403351e+00]
Stock Position:  0.0013205051256402797
Bond Position:  [-4.48355102]


portfolio before change:  [-4.35083543]
curr_Stock_Price:  100.92809880635251
curr_Factors:  [1.00928099e+02 3.81519701e-02]
mat_Sqrt:  [[ 1.97138105e+01  0.00000000e+00]
 [-7.81301173e-03  1.79018588e-02]]
grads:  [-0.0072324   0.73199202]
Stock Position:  -0.007232397240297634
Bond Position:  [-3.62088332]


portfolio before change:  [-4.35541087]
curr_Stock_Price:  101.49814525274252
curr_Factors:  [1.01498145e+02 3.66881628e-02]
mat_Sqrt:  [[ 1.94411114e+01  0.00000000e+00]
 [-7.66166173e-03  1.75550724e-02]]
grads:  [2.20729382e-03 3.64658738e+00]
Stock Position:  0.002207293823554952
Bond Position:  [-4.5794471]


portfolio before change:  [-4.3588744]
curr_Stock_Price:  100.1883678305217
curr_Factors:  [1.00188368e+02 3.83912800e-02]
mat_Sqrt:  [[ 1.96306011e+01  0.00000000e+00]
 [-7.83747714e-03  1.79579161e-02]]
grads:  [-2.81117183e-03 -4.65326182e+00]
Stock Position:  -0.002811171826251376
Bond Position:  [-4.07722768]


portfolio before change:  [-4.35879601]
curr_Stock_Price:  99.9791747438611
curr_Factors:  [9.99791747e+01 3.81351545e-02]
mat_Sqrt:  [[ 1.95241575e+01  0.00000000e+00]
 [-7.81128973e-03  1.78979132e-02]]
grads:  [0.00591977 0.80821569]
Stock Position:  0.005919773423721052
Bond Position:  [-4.95065007]


portfolio before change:  [-4.36373658]
curr_Stock_Price:  99.24912909810404
curr_Factors:  [9.92491291e+01 3.87043776e-02]
mat_Sqrt:  [[ 1.95257061e+01  0.00000000e+00]
 [-7.86937127e-03  1.80309947e-02]]
grads:  [1.14802535e-02 1.71096408e+01]
Stock Position:  0.011480253484809902
Bond Position:  [-5.50314174]


portfolio before change:  [-4.34800303]
curr_Stock_Price:  100.67954059569497
curr_Factors:  [1.00679541e+02 3.67433346e-02]
mat_Sqrt:  [[ 1.92988091e+01  0.00000000e+00]
 [-7.66742039e-03  1.75682672e-02]]
grads:  [1.08815843e-02 2.24389318e+01]
Stock Position:  0.010881584279764146
Bond Position:  [-5.44355594]


portfolio before change:  [-4.36185921]
curr_Stock_Price:  99.46871552904132
curr_Factors:  [9.94687155e+01 3.67963276e-02]
mat_Sqrt:  [[ 1.90804559e+01  0.00000000e+00]
 [-7.67294755e-03  1.75809315e-02]]
grads:  [9.08060139e-04 7.73348171e+00]
Stock Position:  0.0009080601388242009
Bond Position:  [-4.45218279]


portfolio before change:  [-4.36097006]
curr_Stock_Price:  101.0607954596895
curr_Factors:  [1.01060795e+02 3.70064097e-02]
mat_Sqrt:  [[ 1.94411159e+01  0.00000000e+00]
 [-7.69482005e-03  1.76310477e-02]]
grads:  [2.74830947e-03 3.47065574e+00]
Stock Position:  0.00274830946751469
Bond Position:  [-4.63871641]


portfolio before change:  [-4.36172336]
curr_Stock_Price:  100.99769645732289
curr_Factors:  [1.00997696e+02 3.67691157e-02]
mat_Sqrt:  [[ 1.93665857e+01  0.00000000e+00]
 [-7.67010985e-03  1.75744295e-02]]
grads:  [  0.0296732  -13.38103246]
Stock Position:  0.029673195060713142
Bond Position:  [-7.3586477]


portfolio before change:  [-4.40055905]
curr_Stock_Price:  99.7199167021649
curr_Factors:  [9.97199167e+01 3.59543342e-02]
mat_Sqrt:  [[ 1.89085198e+01  0.00000000e+00]
 [-7.58465126e-03  1.73786193e-02]]
grads:  [2.37544964e-03 4.65300609e+00]
Stock Position:  0.0023754496449420095
Bond Position:  [-4.63743869]


portfolio before change:  [-4.39818557]
curr_Stock_Price:  100.9631328103183
curr_Factors:  [1.00963133e+02 3.54934766e-02]
mat_Sqrt:  [[ 1.90211639e+01  0.00000000e+00]
 [-7.53588498e-03  1.72668817e-02]]
grads:  [-5.21923317e-04  4.23337317e+00]
Stock Position:  -0.0005219233169667764
Bond Position:  [-4.34549056]


portfolio before change:  [-4.39962888]
curr_Stock_Price:  102.68769285140851
curr_Factors:  [1.02687693e+02 3.47781416e-02]
mat_Sqrt:  [[ 1.91501236e+01  0.00000000e+00]
 [-7.45955940e-03  1.70919978e-02]]
grads:  [-2.45751054e-03 -6.13664265e+00]
Stock Position:  -0.0024575105408741567
Bond Position:  [-4.14727279]


portfolio before change:  [-4.40058976]
curr_Stock_Price:  102.8677290982869
curr_Factors:  [1.02867729e+02 3.34176824e-02]
mat_Sqrt:  [[ 1.88047392e+01  0.00000000e+00]
 [-7.31220157e-03  1.67543586e-02]]
grads:  [-0.00512299 -3.63737184]
Stock Position:  -0.005122993811485294
Bond Position:  [-3.87359902]


portfolio before change:  [-4.39380476]
curr_Stock_Price:  101.4487860807618
curr_Factors:  [1.01448786e+02 3.48362563e-02]
mat_Sqrt:  [[ 1.89348816e+01  0.00000000e+00]
 [-7.46578931e-03  1.71062723e-02]]
grads:  [-0.03005132 -6.00671901]
Stock Position:  -0.03005131749563534
Bond Position:  [-1.34513508]


portfolio before change:  [-4.40261312]
curr_Stock_Price:  101.73630125390095
curr_Factors:  [1.01736301e+02 3.47418947e-02]
mat_Sqrt:  [[ 1.89628100e+01  0.00000000e+00]
 [-7.45567110e-03  1.70830886e-02]]
grads:  [-0.00619347  0.06981684]
Stock Position:  -0.0061934669525425335
Bond Position:  [-3.7725127]


portfolio before change:  [-4.41193306]
curr_Stock_Price:  103.16495990800001
curr_Factors:  [1.03164960e+02 3.49807084e-02]
mat_Sqrt:  [[ 1.92950769e+01  0.00000000e+00]
 [-7.48125214e-03  1.71417021e-02]]
grads:  [0.01143169 8.60173231]
Stock Position:  0.011431689711002868
Bond Position:  [-5.59128287]


portfolio before change:  [-4.43799349]
curr_Stock_Price:  100.94643602982555
curr_Factors:  [1.00946436e+02 3.53348828e-02]
mat_Sqrt:  [[ 1.89754821e+01  0.00000000e+00]
 [-7.51903002e-03  1.72282621e-02]]
grads:  [0.00897586 4.22874044]
Stock Position:  0.008975857932188335
Bond Position:  [-5.34407436]


portfolio before change:  [-4.45787978]
curr_Stock_Price:  98.80533321672269
curr_Factors:  [9.88053332e+01 3.59710355e-02]
mat_Sqrt:  [[ 1.87394507e+01  0.00000000e+00]
 [-7.58641265e-03  1.73826551e-02]]
grads:  [-0.00690156  4.33934329]
Stock Position:  -0.006901559557385702
Bond Position:  [-3.77596889]


portfolio before change:  [-4.46489125]
curr_Stock_Price:  99.75286461460229
curr_Factors:  [9.97528646e+01 3.49978944e-02]
mat_Sqrt:  [[ 1.86614908e+01  0.00000000e+00]
 [-7.48308967e-03  1.71459124e-02]]
grads:  [ -0.02935446 -20.85336096]
Stock Position:  -0.02935445957138023
Bond Position:  [-1.53669982]


portfolio before change:  [-4.50996426]
curr_Stock_Price:  101.28179447031394
curr_Factors:  [1.01281794e+02 3.54339470e-02]
mat_Sqrt:  [[ 1.90651907e+01  0.00000000e+00]
 [-7.52956275e-03  1.72523956e-02]]
grads:  [1.18271933e-03 1.58191229e+01]
Stock Position:  0.0011827193323337135
Bond Position:  [-4.62975219]


portfolio before change:  [-4.50925478]
curr_Stock_Price:  102.37100841868637
curr_Factors:  [1.02371008e+02 3.43047834e-02]
mat_Sqrt:  [[ 1.89606980e+01  0.00000000e+00]
 [-7.40862021e-03  1.69752815e-02]]
grads:  [-3.70402452e-03  6.99364333e+00]
Stock Position:  -0.0037040245161621614
Bond Position:  [-4.13007005]


portfolio before change:  [-4.50950227]
curr_Stock_Price:  102.29843993787944
curr_Factors:  [1.02298440e+02 3.51383229e-02]
mat_Sqrt:  [[ 1.91760664e+01  0.00000000e+00]
 [-7.49808753e-03  1.71802768e-02]]
grads:  [3.93715029e-03 5.89694723e+00]
Stock Position:  0.0039371502867746695
Bond Position:  [-4.91226661]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.51304297]
Stock Price:  101.55510435073514
PL:  [-6.06814732]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.03693191e-01  3.88158948e-01]
 [-1.72950331e-01 -8.13473271e-02]
 [ 7.80734645e-01 -6.56769190e-01]
 [-2.14774132e-02  2.56922154e-02]
 [-5.35798492e-02  2.48031190e-02]
 [-8.30964572e-02 -6.37073770e-02]
 [-7.99352741e-03  2.91188962e-01]
 [ 6.43498450e-02 -4.62881436e-02]
 [ 1.66370366e-01  8.87635348e-02]
 [ 1.51705971e-01  1.62742263e-02]
 [ 1.21497070e-01  2.03632246e-01]
 [ 1.80018913e-01  2.54394249e-01]
 [ 1.91462826e-01  2.63210567e-02]
 [-8.18720163e-02 -4.18193397e-02]
 [ 9.41017217e-02  2.36565322e-01]
 [ 4.22932357e-02  1.04760347e-01]
 [ 7.44815675e-02  1.51322565e-01]
 [ 9.19794592e-02  6.60167941e-02]
 [ 1.07338579e-02  3.60678679e-02]
 [ 2.21180440e-01 -1.07643789e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-7.71425774e-03  1.57094786e-01]
 [-2.73988304e-03 -2.30616432e-03]
 [ 6.54036116e-04 -6.06625711e-02]
 [ 3.45242150e-02  1.56802384e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.61030588e-01  9.43745170e-02]
 [-3.18845947e-01  2.26251205e-02]
 [ 2.27414020e-01 -9.91071882e-02]
 [-1.33053006e+00 -1.49818412e-01]
 [ 6.64119038e-02  2.87793962e-01]
 [-9.58058211e-03 -1.27654348e-01]
 [ 2.62939292e-03  6.19748930e-02]
 [-1.74014536e-02  1.70272345e-01]
 [-1.77699162e+00 -5.41082195e-02]
 [-8.44272194e-02  2.22211490e-01]
 [-1.35155413e-01  3.11010950e-02]
 [ 1.39857083e+00 -6.75433655e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.16950438]
curr_Stock_Price:  100.2201570520258
curr_Factors:  [1.00220157e+02 3.80611871e-02]
mat_Sqrt:  [[ 1.95522276e+01  0.00000000e+00]
 [-7.80371061e-03  1.78805473e-02]]
grads:  [1.39676998e-02 2.17084489e+01]
Stock Position:  0.0139676997629463
Bond Position:  [2.76965932]


portfolio before change:  [4.17107557]
curr_Stock_Price:  100.30785671986376
curr_Factors:  [1.00307857e+02 3.66588918e-02]
mat_Sqrt:  [[ 1.92054557e+01  0.00000000e+00]
 [-7.65860476e-03  1.75480680e-02]]
grads:  [-0.01085385 -4.63568565]
Stock Position:  -0.01085385416515639
Bond Position:  [5.25980242]


portfolio before change:  [4.16896601]
curr_Stock_Price:  100.56279671884637
curr_Factors:  [1.00562797e+02 3.75134464e-02]
mat_Sqrt:  [[ 1.94773929e+01  0.00000000e+00]
 [-7.74735530e-03  1.77514211e-02]]
grads:  [ 2.53677211e-02 -3.69981191e+01]
Stock Position:  0.025367721084251452
Bond Position:  [1.61791703]


portfolio before change:  [4.15675247]
curr_Stock_Price:  100.07336416796907
curr_Factors:  [1.00073364e+02 3.64277504e-02]
mat_Sqrt:  [[ 1.91000575e+01  0.00000000e+00]
 [-7.63442209e-03  1.74926586e-02]]
grads:  [-5.37402105e-04  1.46874275e+00]
Stock Position:  -0.0005374021052836272
Bond Position:  [4.21053211]


portfolio before change:  [4.15709521]
curr_Stock_Price:  100.4150245360994
curr_Factors:  [1.00415025e+02 3.61108350e-02]
mat_Sqrt:  [[ 1.90817176e+01  0.00000000e+00]
 [-7.60114044e-03  1.74164007e-02]]
grads:  [-0.00224062  1.42412428]
Stock Position:  -0.0022406201305934185
Bond Position:  [4.38208714]


portfolio before change:  [4.15748]
curr_Stock_Price:  100.48777771917506
curr_Factors:  [1.00487778e+02 3.64612598e-02]
mat_Sqrt:  [[ 1.91879720e+01  0.00000000e+00]
 [-7.63793268e-03  1.75007023e-02]]
grads:  [-0.0057797  -3.64027545]
Stock Position:  -0.005779695521144444
Bond Position:  [4.73826875]


portfolio before change:  [4.16006742]
curr_Stock_Price:  100.14258641944065
curr_Factors:  [1.00142586e+02 3.63753285e-02]
mat_Sqrt:  [[ 1.90995118e+01  0.00000000e+00]
 [-7.62892690e-03  1.74800675e-02]]
grads:  [6.23532977e-03 1.66583431e+01]
Stock Position:  0.006235329769218069
Bond Position:  [3.53564537]


portfolio before change:  [4.15806801]
curr_Stock_Price:  99.75104451279451
curr_Factors:  [9.97510445e+01 3.57779367e-02]
mat_Sqrt:  [[ 1.88679666e+01  0.00000000e+00]
 [-7.56602265e-03  1.73359358e-02]]
grads:  [ 2.33984106e-03 -2.67006894e+00]
Stock Position:  0.002339841063698004
Bond Position:  [3.92466642]


portfolio before change:  [4.15550614]
curr_Stock_Price:  98.44647706202258
curr_Factors:  [9.84464771e+01 3.50360571e-02]
mat_Sqrt:  [[ 1.84271339e+01  0.00000000e+00]
 [-7.48716844e-03  1.71552581e-02]]
grads:  [0.01113087 5.17412996]
Stock Position:  0.011130865442712056
Bond Position:  [3.05971165]


portfolio before change:  [4.15544492]
curr_Stock_Price:  98.40661387517669
curr_Factors:  [9.84066139e+01 3.51166395e-02]
mat_Sqrt:  [[ 1.84408427e+01  0.00000000e+00]
 [-7.49577368e-03  1.71749752e-02]]
grads:  [0.00861179 0.94755458]
Stock Position:  0.00861178791309116
Bond Position:  [3.30798803]


portfolio before change:  [4.15681597]
curr_Stock_Price:  98.51780198423329
curr_Factors:  [9.8517802e+01 3.6308911e-02]
mat_Sqrt:  [[ 1.87724660e+01  0.00000000e+00]
 [-7.62195890e-03  1.74641018e-02]]
grads:  [1.12062778e-02 1.16600469e+01]
Stock Position:  0.01120627781560073
Bond Position:  [3.05279811]


portfolio before change:  [4.13705148]
curr_Stock_Price:  96.72004979890198
curr_Factors:  [9.67200498e+01 3.72738764e-02]
mat_Sqrt:  [[ 1.86732018e+01  0.00000000e+00]
 [-7.72257743e-03  1.76946478e-02]]
grads:  [ 0.01558628 14.37690379]
Stock Position:  0.015586275355012556
Bond Position:  [2.62954615]


portfolio before change:  [4.14498677]
curr_Stock_Price:  97.2080802488411
curr_Factors:  [9.72080802e+01 3.83227996e-02]
mat_Sqrt:  [[ 1.90296579e+01  0.00000000e+00]
 [-7.83048398e-03  1.79418928e-02]]
grads:  [0.01066495 1.46701672]
Stock Position:  0.010664946158852676
Bond Position:  [3.10826783]


portfolio before change:  [4.12867895]
curr_Stock_Price:  95.6425416335677
curr_Factors:  [9.56425416e+01 4.07091465e-02]
mat_Sqrt:  [[ 1.92973248e+01  0.00000000e+00]
 [-8.07060310e-03  1.84920748e-02]]
grads:  [-0.00518846 -2.26147364]
Stock Position:  -0.0051884638610833625
Bond Position:  [4.62491682]


portfolio before change:  [4.12698102]
curr_Stock_Price:  96.0812216686704
curr_Factors:  [9.60812217e+01 4.04896970e-02]
mat_Sqrt:  [[ 1.93335132e+01  0.00000000e+00]
 [-8.04882073e-03  1.84421651e-02]]
grads:  [1.02075236e-02 1.28274159e+01]
Stock Position:  0.010207523615028039
Bond Position:  [3.14622968]


portfolio before change:  [4.12349007]
curr_Stock_Price:  95.70069282225555
curr_Factors:  [9.57006928e+01 4.09568212e-02]
mat_Sqrt:  [[ 1.93677069e+01  0.00000000e+00]
 [-8.09511667e-03  1.85482425e-02]]
grads:  [4.54438929e-03 5.64799319e+00]
Stock Position:  0.0045443892858078325
Bond Position:  [3.68858886]


portfolio before change:  [4.12310131]
curr_Stock_Price:  95.51367967443913
curr_Factors:  [9.55136797e+01 4.13533142e-02]
mat_Sqrt:  [[ 1.94231980e+01  0.00000000e+00]
 [-8.13420572e-03  1.86378067e-02]]
grads:  [7.23486159e-03 8.11911868e+00]
Stock Position:  0.007234861590434907
Bond Position:  [3.43207306]


portfolio before change:  [4.12293149]
curr_Stock_Price:  95.43090623162499
curr_Factors:  [9.54309062e+01 4.13503144e-02]
mat_Sqrt:  [[ 1.94056617e+01  0.00000000e+00]
 [-8.13391069e-03  1.86371307e-02]]
grads:  [0.00622455 3.54221876]
Stock Position:  0.006224551991227069
Bond Position:  [3.52891685]


portfolio before change:  [4.12760521]
curr_Stock_Price:  96.11088734535673
curr_Factors:  [9.61108873e+01 4.08397497e-02]
mat_Sqrt:  [[ 1.94229022e+01  0.00000000e+00]
 [-8.08353880e-03  1.85217142e-02]]
grads:  [1.36309012e-03 1.94732882e+00]
Stock Position:  0.001363090116595798
Bond Position:  [3.99659741]


portfolio before change:  [4.12839651]
curr_Stock_Price:  96.32488193935654
curr_Factors:  [9.63248819e+01 4.16932009e-02]
mat_Sqrt:  [[ 1.96684939e+01  0.00000000e+00]
 [-8.16756521e-03  1.87142429e-02]]
grads:  [ 0.00885685 -5.75197134]
Stock Position:  0.008856846888639943
Bond Position:  [3.27526178]


portfolio before change:  [4.12458635]
curr_Stock_Price:  95.84845967469916
curr_Factors:  [9.58484597e+01 3.97706978e-02]
mat_Sqrt:  [[ 1.91146673e+01  0.00000000e+00]
 [-7.97703682e-03  1.82776875e-02]]
grads:  [ 0.00220399 -2.0668911 ]
Stock Position:  0.002203993924637718
Bond Position:  [3.91333692]


portfolio before change:  [4.12387004]
curr_Stock_Price:  95.3014947042104
curr_Factors:  [9.53014947e+01 3.87222025e-02]
mat_Sqrt:  [[ 1.87533879e+01  0.00000000e+00]
 [-7.87118313e-03  1.80351463e-02]]
grads:  [3.24461520e-03 8.71048027e+00]
Stock Position:  0.003244615202783067
Bond Position:  [3.81465336]


portfolio before change:  [4.12234177]
curr_Stock_Price:  94.68350931939554
curr_Factors:  [9.46835093e+01 3.97014495e-02]
mat_Sqrt:  [[ 1.88659000e+01  0.00000000e+00]
 [-7.97008903e-03  1.82617681e-02]]
grads:  [-0.00019858 -0.12628374]
Stock Position:  -0.0001985792182016756
Bond Position:  [4.14114395]


portfolio before change:  [4.12300519]
curr_Stock_Price:  93.94958638917494
curr_Factors:  [9.39495864e+01 3.93907407e-02]
mat_Sqrt:  [[ 1.86462690e+01  0.00000000e+00]
 [-7.93884029e-03  1.81901683e-02]]
grads:  [-1.38479609e-03 -3.33490984e+00]
Stock Position:  -0.001384796089125256
Bond Position:  [4.25310621]


portfolio before change:  [4.12414443]
curr_Stock_Price:  93.51084104919785
curr_Factors:  [9.35108410e+01 4.12819957e-02]
mat_Sqrt:  [[ 1.89995058e+01  0.00000000e+00]
 [-8.12718851e-03  1.86217283e-02]]
grads:  [5.41900335e-03 8.42039909e+00]
Stock Position:  0.0054190033511726686
Bond Position:  [3.61740887]


portfolio before change:  [4.12328728]
curr_Stock_Price:  93.26921715302595
curr_Factors:  [9.32692172e+01 4.20798752e-02]
mat_Sqrt:  [[ 1.91326688e+01  0.00000000e+00]
 [-8.20535193e-03  1.88008232e-02]]
grads:  [6.55865850e-03 9.68407171e+00]
Stock Position:  0.006558658495101072
Bond Position:  [3.51156633]


portfolio before change:  [4.12769383]
curr_Stock_Price:  93.87415440655762
curr_Factors:  [9.38741544e+01 4.24594144e-02]
mat_Sqrt:  [[ 1.93434100e+01  0.00000000e+00]
 [-8.24227293e-03  1.88854198e-02]]
grads:  [9.21045462e-03 9.26309270e+00]
Stock Position:  0.009210454615971397
Bond Position:  [3.26307019]


portfolio before change:  [4.12890078]
curr_Stock_Price:  93.9609086605136
curr_Factors:  [9.39609087e+01 4.12286228e-02]
mat_Sqrt:  [[ 1.90786052e+01  0.00000000e+00]
 [-8.12193305e-03  1.86096865e-02]]
grads:  [-0.0062815   5.07125775]
Stock Position:  -0.006281495459200634
Bond Position:  [4.7191158]


portfolio before change:  [4.12605887]
curr_Stock_Price:  94.5072494663338
curr_Factors:  [9.45072495e+01 4.07251800e-02]
mat_Sqrt:  [[ 1.90720172e+01  0.00000000e+00]
 [-8.07219226e-03  1.84957160e-02]]
grads:  [-0.01620025  1.22326275]
Stock Position:  -0.01620025462200021
Bond Position:  [5.65710038]


portfolio before change:  [4.14091079]
curr_Stock_Price:  93.63413136977874
curr_Factors:  [9.36341314e+01 4.00865585e-02]
mat_Sqrt:  [[ 1.87470774e+01  0.00000000e+00]
 [-8.00865117e-03  1.83501251e-02]]
grads:  [ 0.0098234  -5.40089986]
Stock Position:  0.00982340301084067
Bond Position:  [3.22110498]


portfolio before change:  [4.13836282]
curr_Stock_Price:  93.3337636863254
curr_Factors:  [9.33337637e+01 4.16387844e-02]
mat_Sqrt:  [[ 1.90452992e+01  0.00000000e+00]
 [-8.16223346e-03  1.87020263e-02]]
grads:  [-0.07329453 -8.01081174]
Stock Position:  -0.07329452595781218
Bond Position:  [10.97921679]


portfolio before change:  [4.0770491]
curr_Stock_Price:  94.18902821837794
curr_Factors:  [9.41890282e+01 4.08942860e-02]
mat_Sqrt:  [[ 1.90472214e+01  0.00000000e+00]
 [-8.08893426e-03  1.85340768e-02]]
grads:  [1.00810235e-02 1.55278283e+01]
Stock Position:  0.010081023468350592
Bond Position:  [3.1275273]


portfolio before change:  [4.07286072]
curr_Stock_Price:  93.73477433402344
curr_Factors:  [9.37347743e+01 4.20753122e-02]
mat_Sqrt:  [[ 1.92271277e+01  0.00000000e+00]
 [-8.20490704e-03  1.87998038e-02]]
grads:  [-3.39590540e-03 -6.79019575e+00]
Stock Position:  -0.003395905402860697
Bond Position:  [4.39117515]


portfolio before change:  [4.07582483]
curr_Stock_Price:  93.02357030854374
curr_Factors:  [9.30235703e+01 4.26465325e-02]
mat_Sqrt:  [[ 1.92103318e+01  0.00000000e+00]
 [-8.26041476e-03  1.89269879e-02]]
grads:  [1.54486940e-03 3.27441922e+00]
Stock Position:  0.0015448693960589122
Bond Position:  [3.93211557]


portfolio before change:  [4.07453931]
curr_Stock_Price:  91.87326973557393
curr_Factors:  [9.18732697e+01 4.26285269e-02]
mat_Sqrt:  [[ 1.89687772e+01  0.00000000e+00]
 [-8.25867077e-03  1.89229920e-02]]
grads:  [3.00027195e-03 8.99817244e+00]
Stock Position:  0.0030002719518742306
Bond Position:  [3.79889452]


portfolio before change:  [4.07935684]
curr_Stock_Price:  93.32068316772738
curr_Factors:  [9.33206832e+01 4.30764965e-02]
mat_Sqrt:  [[ 1.93685940e+01  0.00000000e+00]
 [-8.30195124e-03  1.90221600e-02]]
grads:  [-0.09296526 -2.84448346]
Stock Position:  -0.09296525993223326
Bond Position:  [12.75493841]


portfolio before change:  [4.03395796]
curr_Stock_Price:  93.82617676633376
curr_Factors:  [9.38261768e+01 4.08227319e-02]
mat_Sqrt:  [[ 1.89572376e+01  0.00000000e+00]
 [-8.08185443e-03  1.85178548e-02]]
grads:  [6.62218087e-04 1.19998505e+01]
Stock Position:  0.0006622180870001538
Bond Position:  [3.97182457]


portfolio before change:  [4.03345564]
curr_Stock_Price:  92.31785648457615
curr_Factors:  [9.23178565e+01 4.27898603e-02]
mat_Sqrt:  [[ 1.90966042e+01  0.00000000e+00]
 [-8.27428405e-03  1.89587665e-02]]
grads:  [-0.00636667  1.64045984]
Stock Position:  -0.006366670304219601
Bond Position:  [4.62121299]


portfolio before change:  [4.03696048]
curr_Stock_Price:  91.85809388879568
curr_Factors:  [9.18580939e+01 4.24497637e-02]
mat_Sqrt:  [[ 1.89258358e+01  0.00000000e+00]
 [-8.24133617e-03  1.88832734e-02]]
grads:  [ 0.07233987 -3.57688861]
Stock Position:  0.07233986914216017
Bond Position:  [-2.60804201]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.01044829]
Stock Price:  91.49610593969165
PL:  [4.01044829]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 8.19791942e-03  2.70604502e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.65289143e-01 -6.46262507e-01]
 [-4.53400034e-02  6.47628848e-02]
 [ 2.62346828e-02 -7.13944369e-03]
 [-8.13357868e-02 -9.95376925e-02]
 [-2.66464074e-02  2.34387884e-01]
 [-1.24771972e-01 -9.44489890e-02]
 [ 1.65671662e-01  1.11638825e-01]
 [ 7.05376809e-02  1.31696354e-01]
 [ 1.58006660e-01  3.33803042e-01]
 [ 1.85511971e-01  2.48631480e-01]
 [ 1.84204546e-01  2.71605397e-02]
 [-1.43646214e-01 -1.53068722e-01]
 [ 9.23965666e-02  2.35207277e-01]
 [ 4.42364005e-02  7.89937298e-02]
 [ 5.03477407e-02  7.99292420e-02]
 [ 9.49235744e-02  6.64692875e-02]
 [ 1.08998658e-02  4.78113879e-02]
 [ 9.83642166e-02 -9.98769468e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 4.17747338e-02  2.04748513e-01]
 [ 2.61829788e-02  1.47473759e-01]
 [-8.06386182e-02  9.58395676e-02]
 [ 5.51390524e-02  1.46520428e-01]
 [ 4.34016010e-02  1.78901821e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.62058324e-01  9.57216662e-02]
 [-2.27049895e-01 -2.39131308e-02]
 [ 1.37029485e-01 -7.83463963e-02]
 [-1.12031096e+00 -1.27916747e-01]
 [-1.24642476e-01  7.00908192e-02]
 [ 5.43724927e-03 -9.13420189e-02]
 [ 9.35620453e-02  9.59219341e-02]
 [-1.09674128e-01  1.28247770e-01]
 [-7.69648359e-01 -2.58312064e-01]
 [-2.52572451e-02  3.10415941e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.42896641e-01  4.63364952e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.90041831]
curr_Stock_Price:  99.87839596407517
curr_Factors:  [9.98783960e+01 4.05272416e-02]
mat_Sqrt:  [[ 2.01068983e+01  0.00000000e+00]
 [-8.05255156e-03  1.84507135e-02]]
grads:  [6.28139679e-03 1.46663435e+01]
Stock Position:  0.00628139679198654
Bond Position:  [1.27304248]


portfolio before change:  [1.90044597]
curr_Stock_Price:  99.85746417844126
curr_Factors:  [9.98574642e+01 4.18898542e-02]
mat_Sqrt:  [[ 2.04378382e+01  0.00000000e+00]
 [-8.18680443e-03  1.87583255e-02]]
grads:  [-0.0099318  -4.69185643]
Stock Position:  -0.009931796386101926
Bond Position:  [2.89220998]


portfolio before change:  [1.89158461]
curr_Stock_Price:  100.78608854252396
curr_Factors:  [1.00786089e+02 4.05318173e-02]
mat_Sqrt:  [[ 2.02907747e+01  0.00000000e+00]
 [-8.05300613e-03  1.84517551e-02]]
grads:  [ 2.38156043e-02 -3.50244464e+01]
Stock Position:  0.023815604284740645
Bond Position:  [-0.50869699]


portfolio before change:  [1.85873705]
curr_Stock_Price:  99.40951330774655
curr_Factors:  [9.94095133e+01 4.30215136e-02]
mat_Sqrt:  [[ 2.06191515e+01  0.00000000e+00]
 [-8.29665124e-03  1.90100162e-02]]
grads:  [-8.28121527e-04  3.40677695e+00]
Stock Position:  -0.0008281215274299124
Bond Position:  [1.94106021]


portfolio before change:  [1.85917543]
curr_Stock_Price:  99.17315820928661
curr_Factors:  [9.91731582e+01 4.39225780e-02]
mat_Sqrt:  [[ 2.07844270e+01  0.00000000e+00]
 [-8.38308564e-03  1.92080622e-02]]
grads:  [ 0.00111231 -0.37168995]
Stock Position:  0.001112312318990143
Bond Position:  [1.74886391]


portfolio before change:  [1.85833835]
curr_Stock_Price:  98.22405092484752
curr_Factors:  [9.82240509e+01 4.30802913e-02]
mat_Sqrt:  [[ 2.03871800e+01  0.00000000e+00]
 [-8.30231691e-03  1.90229978e-02]]
grads:  [-0.0061204  -5.23249245]
Stock Position:  -0.006120395144183424
Bond Position:  [2.45950835]


portfolio before change:  [1.85102838]
curr_Stock_Price:  99.4686478046166
curr_Factors:  [9.94686478e+01 4.15635630e-02]
mat_Sqrt:  [[ 2.02788162e+01  0.00000000e+00]
 [-8.15485750e-03  1.86851259e-02]]
grads:  [3.73043728e-03 1.25440891e+01]
Stock Position:  0.003730437277050089
Bond Position:  [1.47996683]


portfolio before change:  [1.84699068]
curr_Stock_Price:  98.33668569140316
curr_Factors:  [9.83366857e+01 4.28869298e-02]
mat_Sqrt:  [[ 2.03647014e+01  0.00000000e+00]
 [-8.28366391e-03  1.89802584e-02]]
grads:  [-0.00815101 -4.97616981]
Stock Position:  -0.008151010283213935
Bond Position:  [2.64853401]


portfolio before change:  [1.85724672]
curr_Stock_Price:  97.11904990772499
curr_Factors:  [9.71190499e+01 4.17966044e-02]
mat_Sqrt:  [[ 1.98552301e+01  0.00000000e+00]
 [-8.17768714e-03  1.87374352e-02]]
grads:  [0.0107979  5.95806331]
Stock Position:  0.010797902512059943
Bond Position:  [0.80856469]


portfolio before change:  [1.85590782]
curr_Stock_Price:  96.98569226709405
curr_Factors:  [9.69856923e+01 4.21404485e-02]
mat_Sqrt:  [[ 1.99093576e+01  0.00000000e+00]
 [-8.21125554e-03  1.88143500e-02]]
grads:  [6.42987507e-03 6.99978227e+00]
Stock Position:  0.006429875067242308
Bond Position:  [1.23230193]


portfolio before change:  [1.85445206]
curr_Stock_Price:  96.73532944326321
curr_Factors:  [9.67353294e+01 4.28615089e-02]
mat_Sqrt:  [[ 2.00271358e+01  0.00000000e+00]
 [-8.28120850e-03  1.89746324e-02]]
grads:  [1.51639382e-02 1.75920690e+01]
Stock Position:  0.015163938246225769
Bond Position:  [0.3875635]


portfolio before change:  [1.85769529]
curr_Stock_Price:  96.94601185475398
curr_Factors:  [9.69460119e+01 4.23185768e-02]
mat_Sqrt:  [[ 1.99432289e+01  0.00000000e+00]
 [-8.22859180e-03  1.88540724e-02]]
grads:  [ 0.01474303 13.18714999]
Stock Position:  0.014743031122342118
Bond Position:  [0.42841722]


portfolio before change:  [1.8638932]
curr_Stock_Price:  97.36277535307994
curr_Factors:  [9.73627754e+01 4.04085977e-02]
mat_Sqrt:  [[ 1.95717579e+01  0.00000000e+00]
 [-8.04075596e-03  1.84236864e-02]]
grads:  [0.01001741 1.47421852]
Stock Position:  0.010017412772778024
Bond Position:  [0.88857009]


portfolio before change:  [1.85765448]
curr_Stock_Price:  96.72889871467119
curr_Factors:  [9.67288987e+01 4.08812417e-02]
mat_Sqrt:  [[ 1.95577226e+01  0.00000000e+00]
 [-8.08764408e-03  1.85311206e-02]]
grads:  [-0.0107605  -8.26008988]
Stock Position:  -0.010760500328402926
Bond Position:  [2.89850582]


portfolio before change:  [1.86009824]
curr_Stock_Price:  96.53546614618861
curr_Factors:  [9.65354661e+01 4.14107280e-02]
mat_Sqrt:  [[ 1.96446064e+01  0.00000000e+00]
 [-8.13985041e-03  1.86507403e-02]]
grads:  [9.92890540e-03 1.26111496e+01]
Stock Position:  0.009928905400734609
Bond Position:  [0.90160673]


portfolio before change:  [1.85688427]
curr_Stock_Price:  96.20041599195683
curr_Factors:  [9.62004160e+01 4.22067553e-02]
mat_Sqrt:  [[ 1.97636855e+01  0.00000000e+00]
 [-8.21771310e-03  1.88291462e-02]]
grads:  [3.98266259e-03 4.19529006e+00]
Stock Position:  0.003982662585423623
Bond Position:  [1.47375047]


portfolio before change:  [1.85671801]
curr_Stock_Price:  96.11241226295586
curr_Factors:  [9.61124123e+01 4.33199520e-02]
mat_Sqrt:  [[ 2.00043047e+01  0.00000000e+00]
 [-8.32537826e-03  1.90758380e-02]]
grads:  [0.00426067 4.19007762]
Stock Position:  0.0042606690432728895
Bond Position:  [1.44721483]


portfolio before change:  [1.85351695]
curr_Stock_Price:  95.31864642550175
curr_Factors:  [9.53186464e+01 4.36547567e-02]
mat_Sqrt:  [[ 1.99156118e+01  0.00000000e+00]
 [-8.35748830e-03  1.91494114e-02]]
grads:  [0.00622291 3.47108776]
Stock Position:  0.006222914515075276
Bond Position:  [1.26035716]


portfolio before change:  [1.86249684]
curr_Stock_Price:  96.73636341528834
curr_Factors:  [9.67363634e+01 4.43567586e-02]
mat_Sqrt:  [[ 2.03736883e+01  0.00000000e+00]
 [-8.42441771e-03  1.93027659e-02]]
grads:  [1.55919074e-03 2.47691901e+00]
Stock Position:  0.0015591907393844287
Bond Position:  [1.71166639]


portfolio before change:  [1.86487485]
curr_Stock_Price:  98.12428760026783
curr_Factors:  [9.81242876e+01 4.44773581e-02]
mat_Sqrt:  [[ 2.06940745e+01  0.00000000e+00]
 [-8.43586232e-03  1.93289888e-02]]
grads:  [ 2.64686123e-03 -5.16721013e+00]
Stock Position:  0.0026468612253719675
Bond Position:  [1.60515347]


portfolio before change:  [1.86389363]
curr_Stock_Price:  97.67776752804211
curr_Factors:  [9.76777675e+01 4.50782768e-02]
mat_Sqrt:  [[ 2.07385973e+01  0.00000000e+00]
 [-8.49265818e-03  1.94591245e-02]]
grads:  [ 0.00203141 -1.94140233]
Stock Position:  0.0020314108059772164
Bond Position:  [1.66546995]


portfolio before change:  [1.86157494]
curr_Stock_Price:  96.43386085535495
curr_Factors:  [9.64338609e+01 4.69392552e-02]
mat_Sqrt:  [[ 2.08928483e+01  0.00000000e+00]
 [-8.66618764e-03  1.98567304e-02]]
grads:  [6.27651668e-03 1.03112904e+01]
Stock Position:  0.006276516680324466
Bond Position:  [1.2563062]


portfolio before change:  [1.86130161]
curr_Stock_Price:  96.36529220754555
curr_Factors:  [9.63652922e+01 4.80620303e-02]
mat_Sqrt:  [[ 2.11262152e+01  0.00000000e+00]
 [-8.76922166e-03  2.00928110e-02]]
grads:  [4.28594536e-03 7.33962804e+00]
Stock Position:  0.004285945364298937
Bond Position:  [1.44828524]


portfolio before change:  [1.86238999]
curr_Stock_Price:  96.57699148251852
curr_Factors:  [9.65769915e+01 4.68161906e-02]
mat_Sqrt:  [[ 2.08964113e+01  0.00000000e+00]
 [-8.65481975e-03  1.98306833e-02]]
grads:  [-1.85729507e-03  4.83289285e+00]
Stock Position:  -0.0018572950693951143
Bond Position:  [2.04176196]


portfolio before change:  [1.86541428]
curr_Stock_Price:  95.0860837044943
curr_Factors:  [9.50860837e+01 4.84141244e-02]
mat_Sqrt:  [[ 2.09219905e+01  0.00000000e+00]
 [-8.80128394e-03  2.01662749e-02]]
grads:  [5.69189674e-03 7.26561690e+00]
Stock Position:  0.005691896739735659
Bond Position:  [1.32419411]


portfolio before change:  [1.85914752]
curr_Stock_Price:  93.95600370380805
curr_Factors:  [9.39560037e+01 4.99259226e-02]
mat_Sqrt:  [[ 2.09936323e+01  0.00000000e+00]
 [-8.93764377e-03  2.04787146e-02]]
grads:  [5.78655257e-03 8.73598880e+00]
Stock Position:  0.0057865525731050525
Bond Position:  [1.31546616]


portfolio before change:  [1.85641454]
curr_Stock_Price:  93.45528735769717
curr_Factors:  [9.34552874e+01 5.12869671e-02]
mat_Sqrt:  [[ 2.11644694e+01  0.00000000e+00]
 [-9.05865042e-03  2.07559756e-02]]
grads:  [8.41795731e-03 8.42829061e+00]
Stock Position:  0.00841795731081737
Bond Position:  [1.06971192]


portfolio before change:  [1.86187064]
curr_Stock_Price:  94.08755193266936
curr_Factors:  [9.40875519e+01 5.25094888e-02]
mat_Sqrt:  [[ 2.15601145e+01  0.00000000e+00]
 [-9.16597960e-03  2.10018977e-02]]
grads:  [-0.00557891  4.55776272]
Stock Position:  -0.005578911192129608
Bond Position:  [2.38677674]


portfolio before change:  [1.85186021]
curr_Stock_Price:  95.93536657893605
curr_Factors:  [9.59353666e+01 5.38272707e-02]
mat_Sqrt:  [[ 2.22576813e+01  0.00000000e+00]
 [-9.28028195e-03  2.12637973e-02]]
grads:  [-0.01066986 -1.12459362]
Stock Position:  -0.010669864381199497
Bond Position:  [2.87547756]


portfolio before change:  [1.84671706]
curr_Stock_Price:  96.45108134650788
curr_Factors:  [9.64510813e+01 5.47136514e-02]
mat_Sqrt:  [[ 2.25608236e+01  0.00000000e+00]
 [-9.35637976e-03  2.14381592e-02]]
grads:  [ 0.00455818 -3.65453001]
Stock Position:  0.004558180877594542
Bond Position:  [1.40707559]


portfolio before change:  [1.84186812]
curr_Stock_Price:  95.34870363300236
curr_Factors:  [9.53487036e+01 5.57556793e-02]
mat_Sqrt:  [[ 2.25143466e+01  0.00000000e+00]
 [-9.44505621e-03  2.16413425e-02]]
grads:  [-0.05223951 -5.91075841]
Stock Position:  -0.052239508558006756
Bond Position:  [6.82283754]


portfolio before change:  [1.78116245]
curr_Stock_Price:  96.52709490811547
curr_Factors:  [9.65270949e+01 5.42307757e-02]
mat_Sqrt:  [[ 2.24787493e+01  0.00000000e+00]
 [-9.31500087e-03  2.13433483e-02]]
grads:  [-0.00418406  3.28396549]
Stock Position:  -0.004184055502519129
Bond Position:  [2.18503717]


portfolio before change:  [1.77332931]
curr_Stock_Price:  98.46451744840442
curr_Factors:  [9.84645174e+01 5.25993890e-02]
mat_Sqrt:  [[ 2.25824006e+01  0.00000000e+00]
 [-9.17382267e-03  2.10198684e-02]]
grads:  [-1.52453571e-03 -4.34550860e+00]
Stock Position:  -0.0015245357088868536
Bond Position:  [1.92344198]


portfolio before change:  [1.77438973]
curr_Stock_Price:  97.92666741824762
curr_Factors:  [9.79266674e+01 5.24530937e-02]
mat_Sqrt:  [[ 2.24277925e+01  0.00000000e+00]
 [-9.16105615e-03  2.09906166e-02]]
grads:  [0.0060383  4.56975304]
Stock Position:  0.006038303127163488
Bond Position:  [1.18307883]


portfolio before change:  [1.77406884]
curr_Stock_Price:  97.8490320299899
curr_Factors:  [9.78490320e+01 4.96369246e-02]
mat_Sqrt:  [[ 2.18001241e+01  0.00000000e+00]
 [-8.91173829e-03  2.04193576e-02]]
grads:  [-2.46339020e-03  6.28069562e+00]
Stock Position:  -0.0024633901976825953
Bond Position:  [2.01510918]


portfolio before change:  [1.77426712]
curr_Stock_Price:  97.87079946946292
curr_Factors:  [9.78707995e+01 5.06548490e-02]
mat_Sqrt:  [[ 2.20274208e+01  0.00000000e+00]
 [-9.00265286e-03  2.06276691e-02]]
grads:  [ -0.04005848 -12.52260072]
Stock Position:  -0.04005847953315835
Bond Position:  [5.69482254]


portfolio before change:  [1.75210477]
curr_Stock_Price:  98.44182071918156
curr_Factors:  [9.84418207e+01 5.02988653e-02]
mat_Sqrt:  [[ 2.20779493e+01  0.00000000e+00]
 [-8.97096341e-03  2.05550594e-02]]
grads:  [4.99228334e-03 1.51016805e+01]
Stock Position:  0.0049922833440435585
Bond Position:  [1.26065531]


portfolio before change:  [1.75015782]
curr_Stock_Price:  98.0202609055881
curr_Factors:  [9.80202609e+01 5.10927675e-02]
mat_Sqrt:  [[ 2.21562148e+01  0.00000000e+00]
 [-9.04148372e-03  2.07166418e-02]]
grads:  [-3.98015708e-03  5.27893302e+00]
Stock Position:  -0.003980157079248225
Bond Position:  [2.14029385]


portfolio before change:  [1.75571758]
curr_Stock_Price:  96.69061207574255
curr_Factors:  [9.66906121e+01 5.28406806e-02]
mat_Sqrt:  [[ 2.22263685e+01  0.00000000e+00]
 [-9.19484034e-03  2.10680259e-02]]
grads:  [0.03801426 0.21993753]
Stock Position:  0.0380142590654515
Bond Position:  [-1.91990439]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.72372354]
Stock Price:  95.85529289760728
PL:  [1.72372354]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.10847980e-01  6.45552775e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.13797806e-01 -6.92279680e-01]
 [-2.49121157e-02  1.79236377e-01]
 [ 2.32543129e-02 -8.33939991e-02]
 [-7.26237360e-02 -4.82687541e-02]
 [-1.52861177e-01  3.48984494e-02]
 [ 9.47084779e-02 -1.51425925e-01]
 [ 1.64650961e-01  1.45056180e-01]
 [ 3.06045659e-02  1.86500680e-01]
 [ 1.82851456e-01  4.58089435e-01]
 [ 1.44610938e-01  2.91540769e-01]
 [ 2.68720318e-01  2.27168110e-02]
 [-8.75960187e-02 -4.25891308e-02]
 [ 9.87068031e-02  2.38570436e-01]
 [ 3.62295296e-02  1.85165412e-01]
 [ 1.14991667e-01  2.71102997e-01]
 [ 1.37272980e-01  7.40472887e-02]
 [ 1.77258885e-02 -5.09379218e-03]
 [ 2.54426820e-01 -1.09703481e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 5.96149022e-02  2.61451314e-01]
 [ 3.64839397e-02  3.09547793e-01]
 [-7.09592534e-02  1.15902985e-01]
 [ 5.08024562e-02  1.12318756e-01]
 [ 7.45988867e-02  8.10990782e-02]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.66415817e-01  1.06653676e-01]
 [-2.19388131e-01 -2.72061335e-02]
 [ 1.30542459e-01 -7.68330816e-02]
 [-9.43746065e-01 -1.08806368e-01]
 [-1.24846741e-01  7.19866078e-02]
 [-9.11167004e-03 -9.85251231e-02]
 [ 3.71532367e-02  8.24056075e-02]
 [-4.04944910e-02  1.65712494e-01]
 [-1.77475366e+00 -5.51813021e-02]
 [-9.57780821e-02  1.89401188e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.76210728e-01  3.62572770e-04]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.09726054]
curr_Stock_Price:  100.96235688770065
curr_Factors:  [1.00962357e+02 4.05079706e-02]
mat_Sqrt:  [[ 2.03202817e+01  0.00000000e+00]
 [-8.05063681e-03  1.84463263e-02]]
grads:  [2.91625047e-02 3.49962786e+01]
Stock Position:  0.029162504677715743
Bond Position:  [6.15294534]


portfolio before change:  [9.06584165]
curr_Stock_Price:  99.85860872633066
curr_Factors:  [9.98586087e+01 4.04801960e-02]
mat_Sqrt:  [[ 2.00912434e+01  0.00000000e+00]
 [-8.04787634e-03  1.84400012e-02]]
grads:  [-0.01010313 -4.77285055]
Stock Position:  -0.010103130224509864
Bond Position:  [10.07472618]


portfolio before change:  [9.06832133]
curr_Stock_Price:  99.73782826528651
curr_Factors:  [9.97378283e+01 4.03092300e-02]
mat_Sqrt:  [[ 2.00245220e+01  0.00000000e+00]
 [-8.03086347e-03  1.84010199e-02]]
grads:  [ 2.55517801e-02 -3.76218103e+01]
Stock Position:  0.02555178011594331
Bond Position:  [6.51984227]


portfolio before change:  [9.01776009]
curr_Stock_Price:  97.72715551463459
curr_Factors:  [9.77271555e+01 3.99467987e-02]
mat_Sqrt:  [[ 1.95324288e+01  0.00000000e+00]
 [-7.99467810e-03  1.83181088e-02]]
grads:  [2.72946355e-03 9.78465512e+00]
Stock Position:  0.0027294635520272305
Bond Position:  [8.75101738]


portfolio before change:  [9.01733187]
curr_Stock_Price:  97.16947388557027
curr_Factors:  [9.71694739e+01 4.03778403e-02]
mat_Sqrt:  [[ 1.95254654e+01  0.00000000e+00]
 [-8.03769522e-03  1.84166734e-02]]
grads:  [-6.73060124e-04 -4.52817930e+00]
Stock Position:  -0.0006730601242130402
Bond Position:  [9.08273276]


portfolio before change:  [9.01969115]
curr_Stock_Price:  95.3511002428309
curr_Factors:  [9.53511002e+01 4.24255037e-02]
mat_Sqrt:  [[ 1.96398973e+01  0.00000000e+00]
 [-8.23898088e-03  1.88778768e-02]]
grads:  [-0.00477039 -2.55689528]
Stock Position:  -0.004770388862537039
Bond Position:  [9.47455298]


portfolio before change:  [9.02093397]
curr_Stock_Price:  95.33885341979848
curr_Factors:  [9.53388534e+01 4.20259798e-02]
mat_Sqrt:  [[ 1.95446928e+01  0.00000000e+00]
 [-8.20009559e-03  1.87887794e-02]]
grads:  [-0.00704182  1.85740908]
Stock Position:  -0.007041821858026018
Bond Position:  [9.69229319]


portfolio before change:  [9.01899511]
curr_Stock_Price:  95.7862482672617
curr_Factors:  [9.57862483e+01 4.14368379e-02]
mat_Sqrt:  [[ 1.94982874e+01  0.00000000e+00]
 [-8.14241614e-03  1.86566192e-02]]
grads:  [ 1.46786153e-03 -8.11647192e+00]
Stock Position:  0.001467861529431737
Bond Position:  [8.87839416]


portfolio before change:  [9.019235]
curr_Stock_Price:  95.19356749349392
curr_Factors:  [9.51935675e+01 4.00356697e-02]
mat_Sqrt:  [[ 1.90472004e+01  0.00000000e+00]
 [-8.00356618e-03  1.83384739e-02]]
grads:  [0.01196809 7.90993736]
Stock Position:  0.01196809309905575
Bond Position:  [7.87994952]


portfolio before change:  [9.0337416]
curr_Stock_Price:  96.32336670846243
curr_Factors:  [9.63233667e+01 3.78236426e-02]
mat_Sqrt:  [[ 1.87332586e+01  0.00000000e+00]
 [-7.77932055e-03  1.78246626e-02]]
grads:  [5.97867876e-03 1.04630693e+01]
Stock Position:  0.005978678762467304
Bond Position:  [8.45785513]


portfolio before change:  [9.02865582]
curr_Stock_Price:  95.29586924959735
curr_Factors:  [9.52958692e+01 3.67756059e-02]
mat_Sqrt:  [[ 1.82748573e+01  0.00000000e+00]
 [-7.67078676e-03  1.75759805e-02]]
grads:  [2.09456123e-02 2.60633787e+01]
Stock Position:  0.020945612311650888
Bond Position:  [7.03262549]


portfolio before change:  [9.03004122]
curr_Stock_Price:  95.32003977754682
curr_Factors:  [9.53200398e+01 3.74924857e-02]
mat_Sqrt:  [[ 1.84567968e+01  0.00000000e+00]
 [-7.74519058e-03  1.77464610e-02]]
grads:  [1.47289783e-02 1.64281075e+01]
Stock Position:  0.01472897832701915
Bond Position:  [7.62607442]


portfolio before change:  [9.03501221]
curr_Stock_Price:  95.59281285485287
curr_Factors:  [9.55928129e+01 3.77422504e-02]
mat_Sqrt:  [[ 1.85711645e+01  0.00000000e+00]
 [-7.77094593e-03  1.78054740e-02]]
grads:  [0.01500362 1.27583299]
Stock Position:  0.015003622789225308
Bond Position:  [7.6007737]


portfolio before change:  [9.03637128]
curr_Stock_Price:  95.62006715161966
curr_Factors:  [9.56200672e+01 3.57585371e-02]
mat_Sqrt:  [[ 1.80816857e+01  0.00000000e+00]
 [-7.56397113e-03  1.73312351e-02]]
grads:  [-0.00587243 -2.4573627 ]
Stock Position:  -0.005872430318928975
Bond Position:  [9.59789346]


portfolio before change:  [9.04262172]
curr_Stock_Price:  94.76000889451551
curr_Factors:  [9.47600089e+01 3.64292507e-02]
mat_Sqrt:  [[ 1.80863201e+01  0.00000000e+00]
 [-7.63457931e-03  1.74930188e-02]]
grads:  [1.12144138e-02 1.36380369e+01]
Stock Position:  0.0112144138037307
Bond Position:  [7.97994377]


portfolio before change:  [9.03668118]
curr_Stock_Price:  94.14133236361927
curr_Factors:  [9.41413324e+01 3.70870362e-02]
mat_Sqrt:  [[ 1.81297328e+01  0.00000000e+00]
 [-7.70319790e-03  1.76502437e-02]]
grads:  [6.45582269e-03 1.04908133e+01]
Stock Position:  0.006455822691902314
Bond Position:  [8.42892143]


portfolio before change:  [9.04011045]
curr_Stock_Price:  94.50930869925119
curr_Factors:  [9.45093087e+01 3.76464578e-02]
mat_Sqrt:  [[ 1.83373530e+01  0.00000000e+00]
 [-7.76107804e-03  1.77828638e-02]]
grads:  [1.27232494e-02 1.52451821e+01]
Stock Position:  0.012723249355179935
Bond Position:  [7.83764495]


portfolio before change:  [9.03061743]
curr_Stock_Price:  93.68618644448777
curr_Factors:  [9.36861864e+01 3.83631446e-02]
mat_Sqrt:  [[ 1.83498560e+01  0.00000000e+00]
 [-7.83460474e-03  1.79513346e-02]]
grads:  [0.00924203 4.12489045]
Stock Position:  0.009242027065003437
Bond Position:  [8.16476716]


portfolio before change:  [9.04609883]
curr_Stock_Price:  95.25085791635122
curr_Factors:  [9.52508579e+01 3.86218348e-02]
mat_Sqrt:  [[ 1.87191165e+01  0.00000000e+00]
 [-7.86097549e-03  1.80117576e-02]]
grads:  [ 0.00082818 -0.28280373]
Stock Position:  0.0008281787937379696
Bond Position:  [8.96721408]


portfolio before change:  [9.04771283]
curr_Stock_Price:  95.84617443203435
curr_Factors:  [9.58461744e+01 3.85354888e-02]
mat_Sqrt:  [[ 1.88150432e+01  0.00000000e+00]
 [-7.85218327e-03  1.79916121e-02]]
grads:  [ 0.01097783 -6.09747922]
Stock Position:  0.0109778273321473
Bond Position:  [7.99553007]


portfolio before change:  [9.06147554]
curr_Stock_Price:  97.00880948278025
curr_Factors:  [9.70088095e+01 3.78317402e-02]
mat_Sqrt:  [[ 1.88685851e+01  0.00000000e+00]
 [-7.78015323e-03  1.78265705e-02]]
grads:  [ 0.00223274 -2.11919559]
Stock Position:  0.002232738198330877
Bond Position:  [8.84488026]


portfolio before change:  [9.06472013]
curr_Stock_Price:  97.96678572222004
curr_Factors:  [9.79667857e+01 3.75106904e-02]
mat_Sqrt:  [[ 1.89738904e+01  0.00000000e+00]
 [-7.74707072e-03  1.77507690e-02]]
grads:  [9.15582447e-03 1.47290134e+01]
Stock Position:  0.009155824472688619
Bond Position:  [8.16775343]


portfolio before change:  [9.07652863]
curr_Stock_Price:  99.14499391947014
curr_Factors:  [9.91449939e+01 3.80565417e-02]
mat_Sqrt:  [[ 1.93412906e+01  0.00000000e+00]
 [-7.80323437e-03  1.78794561e-02]]
grads:  [8.87126282e-03 1.73130430e+01]
Stock Position:  0.008871262819924054
Bond Position:  [8.19698733]


portfolio before change:  [9.0681017]
curr_Stock_Price:  98.07957494043382
curr_Factors:  [9.80795749e+01 3.75154935e-02]
mat_Sqrt:  [[ 1.89969512e+01  0.00000000e+00]
 [-7.74756669e-03  1.77519054e-02]]
grads:  [-1.07254283e-03  6.52904475e+00]
Stock Position:  -0.0010725428320267562
Bond Position:  [9.17329625]


portfolio before change:  [9.07060384]
curr_Stock_Price:  96.81584883209935
curr_Factors:  [9.68158488e+01 3.84376993e-02]
mat_Sqrt:  [[ 1.89812649e+01  0.00000000e+00]
 [-7.84221391e-03  1.79687694e-02]]
grads:  [5.25899517e-03 6.25077621e+00]
Stock Position:  0.005258995165173773
Bond Position:  [8.56144975]


portfolio before change:  [9.06939205]
curr_Stock_Price:  96.38191974604935
curr_Factors:  [9.63819197e+01 3.96026224e-02]
mat_Sqrt:  [[ 1.91803949e+01  0.00000000e+00]
 [-7.96016305e-03  1.82390249e-02]]
grads:  [0.00573468 4.4464591 ]
Stock Position:  0.005734679952535244
Bond Position:  [8.51667259]


portfolio before change:  [9.06189851]
curr_Stock_Price:  94.88956291503375
curr_Factors:  [9.48895629e+01 4.05050094e-02]
mat_Sqrt:  [[ 1.90973371e+01  0.00000000e+00]
 [-8.05034254e-03  1.84456520e-02]]
grads:  [9.32913312e-03 9.48393660e+00]
Stock Position:  0.009329133123297244
Bond Position:  [8.17666115]


portfolio before change:  [9.06508795]
curr_Stock_Price:  95.12187661213989
curr_Factors:  [9.51218766e+01 4.04360351e-02]
mat_Sqrt:  [[ 1.91277855e+01  0.00000000e+00]
 [-8.04348532e-03  1.84299402e-02]]
grads:  [-0.00626671  5.78697898]
Stock Position:  -0.006266712698573728
Bond Position:  [9.66118942]


portfolio before change:  [9.0604631]
curr_Stock_Price:  96.05259962584519
curr_Factors:  [9.60525996e+01 4.04895182e-02]
mat_Sqrt:  [[ 1.93277112e+01  0.00000000e+00]
 [-8.04880296e-03  1.84421244e-02]]
grads:  [-0.0119653  -1.47521689]
Stock Position:  -0.011965299918219865
Bond Position:  [10.20976126]


portfolio before change:  [9.05452333]
curr_Stock_Price:  96.65568205224908
curr_Factors:  [9.66556821e+01 4.00717189e-02]
mat_Sqrt:  [[ 1.93484587e+01  0.00000000e+00]
 [-8.00716868e-03  1.83467283e-02]]
grads:  [ 0.00501382 -4.18783559]
Stock Position:  0.0050138232893535
Bond Position:  [8.56990882]


portfolio before change:  [9.05807598]
curr_Stock_Price:  97.15058087441231
curr_Factors:  [9.71505809e+01 3.89324049e-02]
mat_Sqrt:  [[ 1.91690689e+01  0.00000000e+00]
 [-7.89251848e-03  1.80840317e-02]]
grads:  [-0.05171003 -6.01670965]
Stock Position:  -0.0517100264270274
Bond Position:  [14.08173508]


portfolio before change:  [9.09399536]
curr_Stock_Price:  96.48999217345428
curr_Factors:  [9.64899922e+01 3.90461737e-02]
mat_Sqrt:  [[ 1.90665235e+01  0.00000000e+00]
 [-7.90404188e-03  1.81104351e-02]]
grads:  [-0.00490017  3.97486904]
Stock Position:  -0.004900170164343782
Bond Position:  [9.56681274]


portfolio before change:  [9.09233766]
curr_Stock_Price:  97.07234490671198
curr_Factors:  [9.70723449e+01 3.89725720e-02]
mat_Sqrt:  [[ 1.91635099e+01  0.00000000e+00]
 [-7.89658883e-03  1.80933580e-02]]
grads:  [-2.71931183e-03 -5.44537520e+00]
Stock Position:  -0.0027193118280074203
Bond Position:  [9.35630764]


portfolio before change:  [9.09833521]
curr_Stock_Price:  95.29691687363452
curr_Factors:  [9.52969169e+01 3.86543798e-02]
mat_Sqrt:  [[ 1.87360573e+01  0.00000000e+00]
 [-7.86428685e-03  1.80193449e-02]]
grads:  [3.90252823e-03 4.57317444e+00]
Stock Position:  0.0039025282301370324
Bond Position:  [8.72643631]


portfolio before change:  [9.09427316]
curr_Stock_Price:  93.97650878334444
curr_Factors:  [9.39765088e+01 3.95349376e-02]
mat_Sqrt:  [[ 1.86857200e+01  0.00000000e+00]
 [-7.95335779e-03  1.82234321e-02]]
grads:  [1.70335265e-03 9.09337458e+00]
Stock Position:  0.001703352649054029
Bond Position:  [8.93419802]


portfolio before change:  [9.09428063]
curr_Stock_Price:  93.32521995707917
curr_Factors:  [9.33252200e+01 3.87244376e-02]
mat_Sqrt:  [[ 1.83650274e+01  0.00000000e+00]
 [-7.87141030e-03  1.80356668e-02]]
grads:  [-0.09794904 -3.05956541]
Stock Position:  -0.09794903719812904
Bond Position:  [18.23539607]


portfolio before change:  [9.15655546]
curr_Stock_Price:  92.712704854047
curr_Factors:  [9.27127049e+01 4.15585012e-02]
mat_Sqrt:  [[ 1.89003214e+01  0.00000000e+00]
 [-8.15436092e-03  1.86839881e-02]]
grads:  [-6.93989623e-04  1.01370857e+01]
Stock Position:  -0.0006939896227833618
Bond Position:  [9.22089711]


portfolio before change:  [9.15611877]
curr_Stock_Price:  95.00289846258033
curr_Factors:  [9.50028985e+01 3.94904362e-02]
mat_Sqrt:  [[ 1.88791667e+01  0.00000000e+00]
 [-7.94888029e-03  1.82131728e-02]]
grads:  [-4.67103325e-03  6.00454218e+00]
Stock Position:  -0.004671033252917049
Bond Position:  [9.59988047]


portfolio before change:  [9.15054115]
curr_Stock_Price:  96.45390054176221
curr_Factors:  [9.64539005e+01 3.94250664e-02]
mat_Sqrt:  [[ 1.91516419e+01  0.00000000e+00]
 [-7.94229855e-03  1.81980922e-02]]
grads:  [0.04575947 0.01992367]
Stock Position:  0.045759469281408206
Bond Position:  [4.73686185]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.15465664]
Stock Price:  96.53089743218843
PL:  [9.15465664]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.67522901e-01  8.72271707e-01]
 [-1.74555608e-01 -8.01934825e-02]
 [ 7.93764001e-01 -6.65632308e-01]
 [-2.16319745e-02  2.57015505e-02]
 [-2.36946620e-02  1.28427724e-02]
 [-7.37479953e-02 -5.98844038e-02]
 [ 1.68971516e-02  2.99453763e-01]
 [ 1.70840696e-01 -1.75602973e-02]
 [ 9.51386098e-02  9.26776852e-02]
 [ 4.27025427e-01 -2.59597193e-01]
 [ 5.97137362e-02 -1.43600507e-02]
 [-1.57400253e-01 -1.81389485e-01]
 [-1.89500900e-01  1.63721514e-01]
 [-6.81314405e-01 -9.13764930e-01]
 [-1.90503114e-03 -1.27420795e-01]
 [ 3.35598134e-02 -1.12292199e-01]
 [-5.31099687e-02  2.78491410e-01]
 [-1.12364263e-01  5.04459333e-02]
 [ 1.48695380e-02  6.65931783e-02]
 [-9.74709478e-02 -3.82889182e-02]
 [ 2.38369345e-01  2.14172389e-01]
 [ 1.22049642e-02  5.61041793e-02]
 [ 1.71925399e-02  2.61340445e-01]
 [ 4.76828452e-02  1.73308343e-01]
 [ 3.72879330e-02  8.34298183e-02]
 [ 6.90663047e-01 -2.47308702e-01]
 [-1.08983706e-01  1.58029866e-01]
 [-2.97575169e-02  6.77164422e-02]
 [ 5.83767804e-02 -1.67819240e-01]
 [-5.72577601e-02 -3.30921431e-02]
 [-3.91734700e-01 -9.47471504e-02]
 [-2.98099511e-02 -4.71842437e-03]
 [ 1.83850288e-01  1.93485811e-01]
 [ 1.88096839e-01  4.74214121e-02]
 [-2.74936242e-01 -1.70843497e-01]
 [-2.91493715e-02 -3.87741021e-01]
 [-1.49926596e-01  2.25280767e-01]
 [-1.22832171e-01  1.18187441e-01]
 [-4.55763312e-02  1.11281304e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.97828321]
curr_Stock_Price:  101.6975179019457
curr_Factors:  [1.01697518e+02 3.98544686e-02]
mat_Sqrt:  [[ 2.03024694e+01  0.00000000e+00]
 [-7.98543359e-03  1.82969270e-02]]
grads:  [4.17788333e-02 4.76731261e+01]
Stock Position:  0.041778833265157765
Bond Position:  [9.72947956]


portfolio before change:  [13.92396947]
curr_Stock_Price:  100.36837592049616
curr_Factors:  [1.00368376e+02 3.94145151e-02]
mat_Sqrt:  [[ 1.99262232e+01  0.00000000e+00]
 [-7.94123568e-03  1.81956568e-02]]
grads:  [-0.01051654 -4.40728704]
Stock Position:  -0.010516539487448158
Bond Position:  [14.97949745]


portfolio before change:  [13.92669318]
curr_Stock_Price:  100.28744025550871
curr_Factors:  [1.00287440e+02 4.02851715e-02]
mat_Sqrt:  [[ 2.01288589e+01  0.00000000e+00]
 [-8.02846650e-03  1.83955277e-02]]
grads:  [ 2.50018269e-02 -3.61844639e+01]
Stock Position:  0.025001826907177668
Bond Position:  [11.41932396]


portfolio before change:  [13.92259944]
curr_Stock_Price:  100.06660668908977
curr_Factors:  [1.00066607e+02 4.20242215e-02]
mat_Sqrt:  [[ 2.05134644e+01  0.00000000e+00]
 [-8.19992405e-03  1.87883863e-02]]
grads:  [-5.07710353e-04  1.36794880e+00]
Stock Position:  -0.0005077103526849089
Bond Position:  [13.9734043]


portfolio before change:  [13.92433581]
curr_Stock_Price:  100.08713111343558
curr_Factors:  [1.00087131e+02 3.96959771e-02]
mat_Sqrt:  [[ 1.99412092e+01  0.00000000e+00]
 [-7.96953972e-03  1.82605095e-02]]
grads:  [-0.00090715  0.70330855]
Stock Position:  -0.0009071474257268847
Bond Position:  [14.01512959]


portfolio before change:  [13.92556719]
curr_Stock_Price:  100.66103921300993
curr_Factors:  [1.00661039e+02 3.97376298e-02]
mat_Sqrt:  [[ 2.00660731e+01  0.00000000e+00]
 [-7.97371981e-03  1.82700873e-02]]
grads:  [-0.00497774 -3.27772948]
Stock Position:  -0.00497773986430466
Bond Position:  [14.42663166]


portfolio before change:  [13.9222221]
curr_Stock_Price:  101.69534990812916
curr_Factors:  [1.01695350e+02 3.81289465e-02]
mat_Sqrt:  [[ 1.98576795e+01  0.00000000e+00]
 [-7.81065390e-03  1.78964564e-02]]
grads:  [7.43236329e-03 1.67325730e+01]
Stock Position:  0.007432363290986226
Bond Position:  [13.16638532]


portfolio before change:  [13.91412267]
curr_Stock_Price:  100.38414694053684
curr_Factors:  [1.00384147e+02 3.75551693e-02]
mat_Sqrt:  [[ 1.94536006e+01  0.00000000e+00]
 [-7.75166246e-03  1.77612900e-02]]
grads:  [ 0.008388   -0.98868367]
Stock Position:  0.008387997560256277
Bond Position:  [13.07210069]


portfolio before change:  [13.93307707]
curr_Stock_Price:  102.44903620049521
curr_Factors:  [1.02449036e+02 3.93036478e-02]
mat_Sqrt:  [[ 2.03106727e+01  0.00000000e+00]
 [-7.93005905e-03  1.81700479e-02]]
grads:  [0.00667563 5.10057461]
Stock Position:  0.006675626645420636
Bond Position:  [13.24916555]


portfolio before change:  [13.93725613]
curr_Stock_Price:  102.82695018917155
curr_Factors:  [1.02826950e+02 3.96879894e-02]
mat_Sqrt:  [[ 2.04850253e+01  0.00000000e+00]
 [-7.96873785e-03  1.82586722e-02]]
grads:  [  0.01531499 -14.21774762]
Stock Position:  0.015314988377976395
Bond Position:  [12.36246258]


portfolio before change:  [13.961377]
curr_Stock_Price:  104.30102651635504
curr_Factors:  [1.04301027e+02 3.85879362e-02]
mat_Sqrt:  [[ 2.04886979e+01  0.00000000e+00]
 [-7.85752492e-03  1.80038514e-02]]
grads:  [ 0.00260858 -0.79760993]
Stock Position:  0.0026085843312184656
Bond Position:  [13.68929897]


portfolio before change:  [13.96223659]
curr_Stock_Price:  103.97453754075465
curr_Factors:  [1.03974538e+02 3.84294126e-02]
mat_Sqrt:  [[ 2.03825666e+01  0.00000000e+00]
 [-7.84136851e-03  1.79668324e-02]]
grads:  [ -0.01160625 -10.09579658]
Stock Position:  -0.011606247554335022
Bond Position:  [15.16899081]


portfolio before change:  [13.97037406]
curr_Stock_Price:  103.43679067606449
curr_Factors:  [1.03436791e+02 3.94210476e-02]
mat_Sqrt:  [[ 2.05371000e+01  0.00000000e+00]
 [-7.94189374e-03  1.81971646e-02]]
grads:  [-5.74798647e-03  8.99708923e+00]
Stock Position:  -0.005747986470777403
Bond Position:  [14.56492733]


portfolio before change:  [13.96957745]
curr_Stock_Price:  103.89213964226907
curr_Factors:  [1.03892140e+02 3.86470203e-02]
mat_Sqrt:  [[ 2.04239951e+01  0.00000000e+00]
 [-7.86353816e-03  1.80176294e-02]]
grads:  [ -0.05288457 -50.71504736]
Stock Position:  -0.05288456588753893
Bond Position:  [19.46386815]


portfolio before change:  [13.97870239]
curr_Stock_Price:  103.7656035045691
curr_Factors:  [1.03765604e+02 3.84656031e-02]
mat_Sqrt:  [[ 2.03511844e+01  0.00000000e+00]
 [-7.84505991e-03  1.79752904e-02]]
grads:  [-2.82617582e-03 -7.08866405e+00]
Stock Position:  -0.0028261758229563864
Bond Position:  [14.27196223]


portfolio before change:  [13.9802639]
curr_Stock_Price:  103.84436776602281
curr_Factors:  [1.03844368e+02 3.81623204e-02]
mat_Sqrt:  [[ 2.02861827e+01  0.00000000e+00]
 [-7.81407145e-03  1.79042870e-02]]
grads:  [-7.61529189e-04 -6.27180516e+00]
Stock Position:  -0.0007615291889872238
Bond Position:  [14.05934441]


portfolio before change:  [13.98288304]
curr_Stock_Price:  102.71294125144739
curr_Factors:  [1.02712941e+02 3.71652216e-02]
mat_Sqrt:  [[ 1.98012920e+01  0.00000000e+00]
 [-7.71131341e-03  1.76688387e-02]]
grads:  [3.45601928e-03 1.57617269e+01]
Stock Position:  0.0034560192779518
Bond Position:  [13.62790513]


portfolio before change:  [13.98109021]
curr_Stock_Price:  101.70124992352116
curr_Factors:  [1.01701250e+02 3.75793818e-02]
mat_Sqrt:  [[ 1.97151963e+01  0.00000000e+00]
 [-7.75416087e-03  1.77670146e-02]]
grads:  [-0.00458265  2.83930275]
Stock Position:  -0.004582650412661231
Bond Position:  [14.44715148]


portfolio before change:  [13.97924368]
curr_Stock_Price:  102.49828495894124
curr_Factors:  [1.02498285e+02 3.64142343e-02]
mat_Sqrt:  [[ 1.95592496e+01  0.00000000e+00]
 [-7.63300563e-03  1.74894130e-02]]
grads:  [2.24615896e-03 3.80762797e+00]
Stock Position:  0.00224615895513213
Bond Position:  [13.74901624]


portfolio before change:  [13.98218375]
curr_Stock_Price:  103.04202887066573
curr_Factors:  [1.03042029e+02 3.57794020e-02]
mat_Sqrt:  [[ 1.94908572e+01  0.00000000e+00]
 [-7.56617758e-03  1.73362907e-02]]
grads:  [-0.00585821 -2.20859922]
Stock Position:  -0.005858213440677426
Bond Position:  [14.58582595]


portfolio before change:  [13.98295854]
curr_Stock_Price:  103.22101773354551
curr_Factors:  [1.03221018e+02 3.61068475e-02]
mat_Sqrt:  [[ 1.96138533e+01  0.00000000e+00]
 [-7.60072076e-03  1.74154391e-02]]
grads:  [ 0.01691875 12.29784604]
Stock Position:  0.016918747885220506
Bond Position:  [12.23658816]


portfolio before change:  [13.98001674]
curr_Stock_Price:  102.95672673631827
curr_Factors:  [1.02956727e+02 3.67333865e-02]
mat_Sqrt:  [[ 1.97326408e+01  0.00000000e+00]
 [-7.66638236e-03  1.75658887e-02]]
grads:  [1.85939813e-03 3.19392774e+00]
Stock Position:  0.00185939812998061
Bond Position:  [13.78857919]


portfolio before change:  [13.98084866]
curr_Stock_Price:  102.47713519592162
curr_Factors:  [1.02477135e+02 3.63643294e-02]
mat_Sqrt:  [[ 1.95418091e+01  0.00000000e+00]
 [-7.62777340e-03  1.74774245e-02]]
grads:  [6.71641300e-03 1.49530296e+01]
Stock Position:  0.006716413001036003
Bond Position:  [13.2925699]


portfolio before change:  [13.9841696]
curr_Stock_Price:  102.72418045974241
curr_Factors:  [1.02724180e+02 3.61997791e-02]
mat_Sqrt:  [[ 1.95445486e+01  0.00000000e+00]
 [-7.61049582e-03  1.74378366e-02]]
grads:  [6.30972909e-03 9.93863786e+00]
Stock Position:  0.006309729088260353
Bond Position:  [13.33600785]


portfolio before change:  [13.98487651]
curr_Stock_Price:  102.57200333817822
curr_Factors:  [1.02572003e+02 3.65606105e-02]
mat_Sqrt:  [[ 1.96126174e+01  0.00000000e+00]
 [-7.64833163e-03  1.75245293e-02]]
grads:  [3.75776926e-03 4.76074517e+00]
Stock Position:  0.0037577692555521166
Bond Position:  [13.59943459]


portfolio before change:  [13.98123944]
curr_Stock_Price:  101.1517177041028
curr_Factors:  [1.01151718e+02 3.72394624e-02]
mat_Sqrt:  [[ 1.95197820e+01  0.00000000e+00]
 [-7.71901159e-03  1.76864774e-02]]
grads:  [  0.02985324 -13.98292584]
Stock Position:  0.029853237068605914
Bond Position:  [10.96153323]


portfolio before change:  [14.00209986]
curr_Stock_Price:  101.80458323098954
curr_Factors:  [1.01804583e+02 3.78661712e-02]
mat_Sqrt:  [[ 1.98103901e+01  0.00000000e+00]
 [-7.78369282e-03  1.78346808e-02]]
grads:  [-2.0198400e-03  8.8608183e+00]
Stock Position:  -0.0020198399987282696
Bond Position:  [14.20772883]


portfolio before change:  [14.00532042]
curr_Stock_Price:  101.0894363737112
curr_Factors:  [1.01089436e+02 3.81384563e-02]
mat_Sqrt:  [[ 1.97418265e+01  0.00000000e+00]
 [-7.81162788e-03  1.78986880e-02]]
grads:  [-1.03150853e-05  3.78331876e+00]
Stock Position:  -1.031508533559416e-05
Bond Position:  [14.00636317]


portfolio before change:  [14.00707549]
curr_Stock_Price:  100.6856244632486
curr_Factors:  [1.00685624e+02 3.71872835e-02]
mat_Sqrt:  [[ 1.94162205e+01  0.00000000e+00]
 [-7.71360185e-03  1.76740822e-02]]
grads:  [-7.65624833e-04 -9.49521667e+00]
Stock Position:  -0.0007656248325054133
Bond Position:  [14.08416291]


portfolio before change:  [14.00801925]
curr_Stock_Price:  101.75255786398657
curr_Factors:  [1.01752558e+02 3.64183095e-02]
mat_Sqrt:  [[ 1.94180326e+01  0.00000000e+00]
 [-7.63343273e-03  1.74903916e-02]]
grads:  [-0.00369246 -1.89201842]
Stock Position:  -0.003692462401597199
Bond Position:  [14.38373675]


portfolio before change:  [14.00730792]
curr_Stock_Price:  102.43216108254333
curr_Factors:  [1.02432161e+02 3.53232392e-02]
mat_Sqrt:  [[ 1.92515897e+01  0.00000000e+00]
 [-7.51779108e-03  1.72254233e-02]]
grads:  [-0.0224961  -5.50042507]
Stock Position:  -0.0224961031329422
Bond Position:  [16.31163238]


portfolio before change:  [13.96235078]
curr_Stock_Price:  104.52124373871773
curr_Factors:  [1.04521244e+02 3.49910612e-02]
mat_Sqrt:  [[ 1.95516370e+01  0.00000000e+00]
 [-7.48235911e-03  1.71442385e-02]]
grads:  [-0.00163    -0.27521924]
Stock Position:  -0.0016300036828354035
Bond Position:  [14.1327208]


portfolio before change:  [13.96460965]
curr_Stock_Price:  104.21930487452076
curr_Factors:  [1.04219305e+02 3.55484876e-02]
mat_Sqrt:  [[ 1.96498272e+01  0.00000000e+00]
 [-7.54172262e-03  1.72802574e-02]]
grads:  [ 0.01365378 11.19692876]
Stock Position:  0.013653780042347581
Bond Position:  [12.54162218]


portfolio before change:  [13.94971119]
curr_Stock_Price:  103.0133195498208
curr_Factors:  [1.03013320e+02 3.59787357e-02]
mat_Sqrt:  [[ 1.95396298e+01  0.00000000e+00]
 [-7.58722460e-03  1.73845155e-02]]
grads:  [0.01068563 2.72779601]
Stock Position:  0.010685629284676536
Bond Position:  [12.84894904]


portfolio before change:  [13.94459811]
curr_Stock_Price:  102.38450314828094
curr_Factors:  [1.02384503e+02 3.65544332e-02]
mat_Sqrt:  [[ 1.95751119e+01  0.00000000e+00]
 [-7.64768548e-03  1.75230488e-02]]
grads:  [-0.01785423 -9.74964456]
Stock Position:  -0.01785422522569028
Bond Position:  [15.77259409]


portfolio before change:  [13.94820451]
curr_Stock_Price:  102.29294469680086
curr_Factors:  [1.02292945e+02 3.56235449e-02]
mat_Sqrt:  [[ 1.93069756e+01  0.00000000e+00]
 [-7.54968025e-03  1.72984906e-02]]
grads:  [-1.02747023e-02 -2.24147315e+01]
Stock Position:  -0.01027470231038317
Bond Position:  [14.99923407]


portfolio before change:  [13.94313462]
curr_Stock_Price:  102.96886780169017
curr_Factors:  [1.02968868e+02 3.46592780e-02]
mat_Sqrt:  [[ 1.91697166e+01  0.00000000e+00]
 [-7.44680098e-03  1.70627646e-02]]
grads:  [-2.69205902e-03  1.32030636e+01]
Stock Position:  -0.002692059021116943
Bond Position:  [14.22033289]


portfolio before change:  [13.94829111]
curr_Stock_Price:  101.7137581105295
curr_Factors:  [1.01713758e+02 3.54244655e-02]
mat_Sqrt:  [[ 1.91439413e+01  0.00000000e+00]
 [-7.52855529e-03  1.72500872e-02]]
grads:  [-3.72185341e-03  6.85141118e+00]
Stock Position:  -0.0037218534108936652
Bond Position:  [14.3268548]


portfolio before change:  [13.9457936]
curr_Stock_Price:  102.86600068623522
curr_Factors:  [1.02866001e+02 3.62152776e-02]
mat_Sqrt:  [[ 1.95757209e+01  0.00000000e+00]
 [-7.61212482e-03  1.74415691e-02]]
grads:  [1.52781679e-04 6.38023468e+00]
Stock Position:  0.00015278167877425962
Bond Position:  [13.93007756]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.94753185]
Stock Price:  102.84562352689457
PL:  [11.10190833]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.29360019e-01  5.44431413e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.48476154e-01 -6.34825602e-01]
 [ 2.69585733e-02  2.27668090e-02]
 [-1.18993656e-01  5.09823696e-02]
 [-5.91019295e-02 -5.38950209e-02]
 [-1.30748063e-03  3.22496099e-01]
 [ 1.72503335e-01 -1.67471132e-02]
 [ 1.51669104e-01  7.46991793e-02]
 [ 2.74075594e-01 -1.17593033e-01]
 [ 7.95256601e-02  5.47421161e-02]
 [-8.18483221e-02  2.78186268e-02]
 [ 6.88468097e-02  7.43120712e-02]
 [-3.63582532e-01 -4.82558125e-01]
 [ 7.45183061e-02  2.16187366e-01]
 [ 5.47161530e-02 -2.08605705e-02]
 [-5.31998614e-02  2.83544571e-01]
 [-4.35352720e-02  1.27330198e-01]
 [ 1.48266837e-02  6.76572574e-02]
 [-1.00175068e-01 -3.66749826e-02]
 [ 2.39575838e-01  1.99707771e-01]
 [ 4.00654021e-02  8.83213939e-03]
 [-8.84914648e-03  9.87170278e-02]
 [ 6.47971253e-02  1.79267073e-01]
 [ 3.82272069e-02  8.52628539e-02]
 [ 7.26055749e-01 -3.62765389e-01]
 [-2.13678476e-01  2.84775191e-01]
 [ 8.45264907e-02  1.88492023e-02]
 [ 2.32926067e-02 -1.27135431e-01]
 [-1.73601505e-02 -1.43844774e-01]
 [-1.61567154e-01 -8.09251188e-02]
 [-2.07376480e-02 -5.19304302e-03]
 [ 2.20383193e-01  2.54364736e-01]
 [ 2.03353165e-01  3.95942438e-02]
 [-1.98842054e-01 -2.35667554e-01]
 [ 1.84624483e-01 -7.25595798e-02]
 [-2.75088521e-01  1.30868092e-01]
 [-1.13309475e-01  1.24611646e-01]
 [-2.78794732e-01  1.67758430e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.15913879]
curr_Stock_Price:  100.67044438240482
curr_Factors:  [1.00670444e+02 3.99668690e-02]
mat_Sqrt:  [[ 2.01257489e+01  0.00000000e+00]
 [-7.99668622e-03  1.83227099e-02]]
grads:  [2.32025835e-02 2.97134766e+01]
Stock Position:  0.02320258346803726
Bond Position:  [4.8233244]


portfolio before change:  [7.13217032]
curr_Stock_Price:  99.48215336444478
curr_Factors:  [9.94821534e+01 3.97810980e-02]
mat_Sqrt:  [[ 1.98419139e+01  0.00000000e+00]
 [-7.97807976e-03  1.82800772e-02]]
grads:  [-0.01023008 -4.81460604]
Stock Position:  -0.010230084121439494
Bond Position:  [8.14988112]


portfolio before change:  [7.11583351]
curr_Stock_Price:  101.17868018208799
curr_Factors:  [1.01178680e+02 4.03451031e-02]
mat_Sqrt:  [[ 2.03228412e+01  0.00000000e+00]
 [-8.03443619e-03  1.84092060e-02]]
grads:  [ 2.31963406e-02 -3.44841381e+01]
Stock Position:  0.023196340577855763
Bond Position:  [4.76885838]


portfolio before change:  [7.11404967]
curr_Stock_Price:  101.07607869412224
curr_Factors:  [1.01076079e+02 3.95454136e-02]
mat_Sqrt:  [[ 2.01000180e+01  0.00000000e+00]
 [-7.95441147e-03  1.82258463e-02]]
grads:  [0.00183556 1.24914962]
Stock Position:  0.0018355617079934567
Bond Position:  [6.9285183]


portfolio before change:  [7.11569875]
curr_Stock_Price:  101.50262742955667
curr_Factors:  [1.01502627e+02 3.92130986e-02]
mat_Sqrt:  [[ 2.00998522e+01  0.00000000e+00]
 [-7.92091899e-03  1.81491054e-02]]
grads:  [-0.00481313  2.80908443]
Stock Position:  -0.004813126217665491
Bond Position:  [7.60424371]


portfolio before change:  [7.11939025]
curr_Stock_Price:  100.93316086198215
curr_Factors:  [1.00933161e+02 3.86199102e-02]
mat_Sqrt:  [[ 1.98353334e+01  0.00000000e+00]
 [-7.86077963e-03  1.80113088e-02]]
grads:  [-0.00416548 -2.99228787]
Stock Position:  -0.004165478014325364
Bond Position:  [7.53982512]


portfolio before change:  [7.12088288]
curr_Stock_Price:  100.80110106755123
curr_Factors:  [1.00801101e+02 3.80291667e-02]
mat_Sqrt:  [[ 1.96572916e+01  0.00000000e+00]
 [-7.80042734e-03  1.78730244e-02]]
grads:  [7.09361996e-03 1.80437341e+01]
Stock Position:  0.007093619958330232
Bond Position:  [6.40583818]


portfolio before change:  [7.11883287]
curr_Stock_Price:  100.39922037881453
curr_Factors:  [1.00399220e+02 3.82169925e-02]
mat_Sqrt:  [[ 1.96272111e+01  0.00000000e+00]
 [-7.81966675e-03  1.79171074e-02]]
grads:  [ 0.0084166  -0.93469961]
Stock Position:  0.008416595428755514
Bond Position:  [6.27381326]


portfolio before change:  [7.11746408]
curr_Stock_Price:  100.14340840092723
curr_Factors:  [1.00143408e+02 3.84658099e-02]
mat_Sqrt:  [[ 1.96408288e+01  0.00000000e+00]
 [-7.84508100e-03  1.79753388e-02]]
grads:  [0.00938201 4.15564793]
Stock Position:  0.009382012356855
Bond Position:  [6.17791739]


portfolio before change:  [7.11697492]
curr_Stock_Price:  100.00895373859129
curr_Factors:  [1.00008954e+02 3.97110716e-02]
mat_Sqrt:  [[ 1.99294213e+01  0.00000000e+00]
 [-7.97105479e-03  1.82639810e-02]]
grads:  [ 0.01117713 -6.43852143]
Stock Position:  0.011177132735634225
Bond Position:  [5.99916157]


portfolio before change:  [7.12145435]
curr_Stock_Price:  100.3426256840935
curr_Factors:  [1.00342626e+02 4.01158831e-02]
mat_Sqrt:  [[ 2.00975741e+01  0.00000000e+00]
 [-8.01157993e-03  1.83568357e-02]]
grads:  [0.00514575 2.98211069]
Stock Position:  0.0051457493061735785
Bond Position:  [6.60511636]


portfolio before change:  [7.1197146]
curr_Stock_Price:  99.84406849354201
curr_Factors:  [9.98440685e+01 3.98533374e-02]
mat_Sqrt:  [[ 1.99321716e+01  0.00000000e+00]
 [-7.98532028e-03  1.82966673e-02]]
grads:  [-0.00349722  1.52042043]
Stock Position:  -0.0034972244522643095
Bond Position:  [7.46889171]


portfolio before change:  [7.12253618]
curr_Stock_Price:  99.30423607935089
curr_Factors:  [9.93042361e+01 3.92730978e-02]
mat_Sqrt:  [[ 1.96795587e+01  0.00000000e+00]
 [-7.92697651e-03  1.81629849e-02]]
grads:  [0.00514642 4.09140191]
Stock Position:  0.005146419093252511
Bond Position:  [6.61147496]


portfolio before change:  [7.12675779]
curr_Stock_Price:  99.96394259673505
curr_Factors:  [9.99639426e+01 3.86241062e-02]
mat_Sqrt:  [[ 1.96459302e+01  0.00000000e+00]
 [-7.86120664e-03  1.80122872e-02]]
grads:  [ -0.02922682 -26.79049684]
Stock Position:  -0.029226824939664768
Bond Position:  [10.04838644]


portfolio before change:  [7.09892731]
curr_Stock_Price:  100.95914512723566
curr_Factors:  [1.00959145e+02 3.75022151e-02]
mat_Sqrt:  [[ 1.95512318e+01  0.00000000e+00]
 [-7.74619546e-03  1.77487635e-02]]
grads:  [8.63731808e-03 1.21804184e+01]
Stock Position:  0.008637318077452424
Bond Position:  [6.22691106]


portfolio before change:  [7.10340577]
curr_Stock_Price:  101.38752392021564
curr_Factors:  [1.01387524e+02 3.69833348e-02]
mat_Sqrt:  [[ 1.94978871e+01  0.00000000e+00]
 [-7.69242066e-03  1.76255500e-02]]
grads:  [ 0.00233932 -1.18354153]
Stock Position:  0.0023393228910822206
Bond Position:  [6.86622761]


portfolio before change:  [7.10789169]
curr_Stock_Price:  102.93822663076965
curr_Factors:  [1.02938227e+02 3.66465418e-02]
mat_Sqrt:  [[ 1.97057596e+01  0.00000000e+00]
 [-7.65731460e-03  1.75451119e-02]]
grads:  [3.58012763e-03 1.61608870e+01]
Stock Position:  0.003580127630379303
Bond Position:  [6.7393597]


portfolio before change:  [7.108684]
curr_Stock_Price:  102.92421322482532
curr_Factors:  [1.02924213e+02 3.66884341e-02]
mat_Sqrt:  [[ 1.97143355e+01  0.00000000e+00]
 [-7.66169006e-03  1.75551373e-02]]
grads:  [6.10529441e-04 7.25315874e+00]
Stock Position:  0.0006105294414440343
Bond Position:  [7.04584573]


portfolio before change:  [7.10950967]
curr_Stock_Price:  102.83394919257738
curr_Factors:  [1.02833949e+02 3.85015576e-02]
mat_Sqrt:  [[ 2.01778860e+01  0.00000000e+00]
 [-7.84872551e-03  1.79836894e-02]]
grads:  [2.19818526e-03 3.76214557e+00]
Stock Position:  0.0021981852622921898
Bond Position:  [6.8834616]


portfolio before change:  [7.11172385]
curr_Stock_Price:  103.44977067096872
curr_Factors:  [1.03449771e+02 3.91642671e-02]
mat_Sqrt:  [[ 2.04726723e+01  0.00000000e+00]
 [-7.91598556e-03  1.81378015e-02]]
grads:  [-0.00567495 -2.02201918]
Stock Position:  -0.0056749476171747675
Bond Position:  [7.69879588]


portfolio before change:  [7.11506571]
curr_Stock_Price:  103.03047945248014
curr_Factors:  [1.03030479e+02 3.87900423e-02]
mat_Sqrt:  [[ 2.02920464e+01  0.00000000e+00]
 [-7.87807512e-03  1.80509378e-02]]
grads:  [ 0.01610165 11.06356762]
Stock Position:  0.0161016512495954
Bond Position:  [5.45610487]


portfolio before change:  [7.12865058]
curr_Stock_Price:  103.83181412608778
curr_Factors:  [1.03831814e+02 3.73889768e-02]
mat_Sqrt:  [[ 2.00771578e+01  0.00000000e+00]
 [-7.73449176e-03  1.77219470e-02]]
grads:  [0.00218756 0.49837297]
Stock Position:  0.0021875638070210693
Bond Position:  [6.90151186]


portfolio before change:  [7.12945034]
curr_Stock_Price:  103.80302312517856
curr_Factors:  [1.03803023e+02 3.71336782e-02]
mat_Sqrt:  [[ 2.00029471e+01  0.00000000e+00]
 [-7.70804029e-03  1.76613390e-02]]
grads:  [1.71147264e-03 5.58944186e+00]
Stock Position:  0.0017114726352085855
Bond Position:  [6.95179431]


portfolio before change:  [7.1297946]
curr_Stock_Price:  103.4964018984345
curr_Factors:  [1.03496402e+02 3.70325286e-02]
mat_Sqrt:  [[ 1.99166795e+01  0.00000000e+00]
 [-7.69753505e-03  1.76372685e-02]]
grads:  [7.18170365e-03 1.01641063e+01]
Stock Position:  0.007181703649195618
Bond Position:  [6.38651411]


portfolio before change:  [7.12460238]
curr_Stock_Price:  102.66225704868661
curr_Factors:  [1.02662257e+02 3.61838759e-02]
mat_Sqrt:  [[ 1.95284759e+01  0.00000000e+00]
 [-7.60882392e-03  1.74340058e-02]]
grads:  [3.86302379e-03 4.89060604e+00]
Stock Position:  0.003863023792941919
Bond Position:  [6.72801564]


portfolio before change:  [7.12490316]
curr_Stock_Price:  102.5223984678756
curr_Factors:  [1.02522398e+02 3.44084164e-02]
mat_Sqrt:  [[ 1.90173982e+01  0.00000000e+00]
 [-7.41980231e-03  1.70009029e-02]]
grads:  [  0.02985329 -21.33800729]
Stock Position:  0.029853292614785157
Bond Position:  [4.064272]


portfolio before change:  [7.13457444]
curr_Stock_Price:  102.82934014745886
curr_Factors:  [1.02829340e+02 3.56287938e-02]
mat_Sqrt:  [[ 1.94096458e+01  0.00000000e+00]
 [-7.55023643e-03  1.72997650e-02]]
grads:  [-4.60556544e-03  1.64612173e+01]
Stock Position:  -0.004605565439425888
Bond Position:  [7.6081617]


portfolio before change:  [7.13725984]
curr_Stock_Price:  102.45277087600404
curr_Factors:  [1.02452771e+02 3.66894190e-02]
mat_Sqrt:  [[ 1.96242978e+01  0.00000000e+00]
 [-7.66179290e-03  1.75553730e-02]]
grads:  [0.00472643 1.07369991]
Stock Position:  0.00472643443948666
Bond Position:  [6.65302353]


portfolio before change:  [7.13700808]
curr_Stock_Price:  102.22354167568236
curr_Factors:  [1.02223542e+02 3.62080676e-02]
mat_Sqrt:  [[ 1.94515224e+01  0.00000000e+00]
 [-7.61136703e-03  1.74398328e-02]]
grads:  [-1.65508095e-03 -7.28994551e+00]
Stock Position:  -0.0016550809517620012
Bond Position:  [7.30619632]


portfolio before change:  [7.1348516]
curr_Stock_Price:  104.07832049441254
curr_Factors:  [1.0407832e+02 3.7158309e-02]
mat_Sqrt:  [[ 2.00626477e+01  0.00000000e+00]
 [-7.71059624e-03  1.76671955e-02]]
grads:  [-3.99444569e-03 -8.14191331e+00]
Stock Position:  -0.003994445693860833
Bond Position:  [7.5505868]


portfolio before change:  [7.13555536]
curr_Stock_Price:  104.13843559529833
curr_Factors:  [1.04138436e+02 3.72528867e-02]
mat_Sqrt:  [[ 2.00997666e+01  0.00000000e+00]
 [-7.72040276e-03  1.76896650e-02]]
grads:  [-0.00979543 -4.57471177]
Stock Position:  -0.009795425761177319
Bond Position:  [8.15563567]


portfolio before change:  [7.13177751]
curr_Stock_Price:  104.62819107220919
curr_Factors:  [1.04628191e+02 3.63297160e-02]
mat_Sqrt:  [[ 1.99425054e+01  0.00000000e+00]
 [-7.62414229e-03  1.74691046e-02]]
grads:  [-0.00115352 -0.29727013]
Stock Position:  -0.0011535199490651706
Bond Position:  [7.25246822]


portfolio before change:  [7.13154731]
curr_Stock_Price:  105.6137107478688
curr_Factors:  [1.05613711e+02 3.55644933e-02]
mat_Sqrt:  [[ 1.99172152e+01  0.00000000e+00]
 [-7.54342027e-03  1.72841472e-02]]
grads:  [ 0.01663872 14.71664949]
Stock Position:  0.016638724967758076
Bond Position:  [5.37426983]


portfolio before change:  [7.10902952]
curr_Stock_Price:  104.21999728902341
curr_Factors:  [1.04219997e+02 3.70076702e-02]
mat_Sqrt:  [[ 2.00491945e+01  0.00000000e+00]
 [-7.69495109e-03  1.76313479e-02]]
grads:  [0.01100461 2.2456731 ]
Stock Position:  0.01100460714922712
Bond Position:  [5.96212939]


portfolio before change:  [7.12837885]
curr_Stock_Price:  105.91056347495665
curr_Factors:  [1.05910563e+02 3.53407340e-02]
mat_Sqrt:  [[ 1.99102660e+01  0.00000000e+00]
 [-7.51965255e-03  1.72296885e-02]]
grads:  [ -0.01515278 -13.67799274]
Stock Position:  -0.015152776345900058
Bond Position:  [8.73321793]


portfolio before change:  [7.09552595]
curr_Stock_Price:  108.15072206669362
curr_Factors:  [1.08150722e+02 3.48003151e-02]
mat_Sqrt:  [[ 2.01753469e+01  0.00000000e+00]
 [-7.46193702e-03  1.70974456e-02]]
grads:  [ 0.00758138 -4.24388423]
Stock Position:  0.007581375759063661
Bond Position:  [6.27559469]


portfolio before change:  [7.10707248]
curr_Stock_Price:  109.570257915703
curr_Factors:  [1.09570258e+02 3.36561983e-02]
mat_Sqrt:  [[ 2.01013494e+01  0.00000000e+00]
 [-7.33825029e-03  1.68140437e-02]]
grads:  [-0.0108437   7.78326106]
Stock Position:  -0.01084370000778773
Bond Position:  [8.29521949]


portfolio before change:  [7.10722351]
curr_Stock_Price:  109.65195869113545
curr_Factors:  [1.09651959e+02 3.34206452e-02]
mat_Sqrt:  [[ 2.00458192e+01  0.00000000e+00]
 [-7.31252572e-03  1.67551013e-02]]
grads:  [-2.93949045e-03  7.43723622e+00]
Stock Position:  -0.00293949044667236
Bond Position:  [7.4295444]


portfolio before change:  [7.10856449]
curr_Stock_Price:  109.51172151391488
curr_Factors:  [1.09511722e+02 3.39854570e-02]
mat_Sqrt:  [[ 2.01886446e+01  0.00000000e+00]
 [-7.37405799e-03  1.68960895e-02]]
grads:  [-0.0101829   9.92883176]
Stock Position:  -0.010182900053551285
Bond Position:  [8.2237114]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.09528979]
Stock Price:  110.91630409411913
PL:  [-3.8210143]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.59959985e-01  6.60792639e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.70973208e-01 -8.16482733e-01]
 [-2.37450539e-02  1.84697022e-01]
 [ 3.04360806e-02 -6.32960259e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-2.56099209e-02  2.36945030e-01]
 [ 2.03057474e-01 -4.13427445e-03]
 [ 1.29077834e-01  8.18839260e-02]
 [ 2.86642514e-01 -1.26704550e-01]
 [ 1.04420671e-01  1.42748281e-01]
 [ 4.81619828e-02  1.68782019e-01]
 [ 6.31318706e-02  7.66269434e-02]
 [-2.64275581e-01 -3.65910505e-01]
 [ 8.05086902e-02  2.25723455e-01]
 [ 5.21033084e-02 -1.91957896e-02]
 [-4.30411142e-02  9.55903230e-02]
 [-3.80767865e-02  2.40466460e-02]
 [ 1.22921665e-02  4.50837933e-02]
 [ 1.70024571e-01 -1.04407160e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 9.30806782e-02  3.05860610e-01]
 [ 3.80255792e-02  3.98402469e-01]
 [-1.05913754e-02  1.51643801e-01]
 [ 3.98127669e-02  8.83571459e-02]
 [ 7.30855419e-01 -3.77696534e-01]
 [-2.58330573e-01  3.39319400e-01]
 [ 1.52461226e-01 -7.20519845e-03]
 [-4.50522403e-02 -6.51516169e-02]
 [-2.97475470e-03 -1.62411954e-01]
 [-3.41609986e-01 -9.21805797e-02]
 [-1.17986827e-01  1.99852778e-03]
 [ 1.34916090e-01  1.11941205e-01]
 [ 1.61897634e-01  6.08627609e-02]
 [-2.88275746e-01 -1.79549300e-01]
 [-2.91956666e-01 -3.77856773e-01]
 [-1.09815773e-01  2.61086722e-01]
 [-1.22307290e-01  1.18541536e-01]
 [-4.47241155e-02  1.11106819e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.99790851]
curr_Stock_Price:  99.29124484819532
curr_Factors:  [9.92912448e+01 4.10922327e-02]
mat_Sqrt:  [[ 2.01275459e+01  0.00000000e+00]
 [-8.10848767e-03  1.85788793e-02]]
grads:  [-0.00651449  3.5566873 ]
Stock Position:  -0.006514486723878335
Bond Position:  [-1.35107701]


portfolio before change:  [-1.99547582]
curr_Stock_Price:  98.89189128101826
curr_Factors:  [9.88918913e+01 4.01773486e-02]
mat_Sqrt:  [[ 1.98221756e+01  0.00000000e+00]
 [-8.01771525e-03  1.83708935e-02]]
grads:  [-0.01024027 -4.79080509]
Stock Position:  -0.010240270892869953
Bond Position:  [-0.98279607]


portfolio before change:  [-1.98347367]
curr_Stock_Price:  97.70783931123106
curr_Factors:  [9.77078393e+01 4.17492258e-02]
mat_Sqrt:  [[ 1.99642787e+01  0.00000000e+00]
 [-8.17305092e-03  1.87268123e-02]]
grads:  [ 2.57775870e-02 -4.35996646e+01]
Stock Position:  0.025777586978925612
Bond Position:  [-4.50214599]


portfolio before change:  [-1.98564694]
curr_Stock_Price:  97.64536355212898
curr_Factors:  [9.76453636e+01 4.08157536e-02]
mat_Sqrt:  [[ 1.97272040e+01  0.00000000e+00]
 [-8.08116364e-03  1.85162720e-02]]
grads:  [2.88248323e-03 9.97484921e+00]
Stock Position:  0.0028824832316688823
Bond Position:  [-2.26710807]


portfolio before change:  [-1.98569464]
curr_Stock_Price:  97.72713726084804
curr_Factors:  [9.77271373e+01 4.25678228e-02]
mat_Sqrt:  [[ 2.01630346e+01  0.00000000e+00]
 [-8.25278840e-03  1.89095138e-02]]
grads:  [ 1.39434870e-04 -3.34731113e+00]
Stock Position:  0.0001394348697169159
Bond Position:  [-1.99932121]


portfolio before change:  [-1.98570053]
curr_Stock_Price:  99.47732614969729
curr_Factors:  [9.94773261e+01 4.17838751e-02]
mat_Sqrt:  [[ 2.03342641e+01  0.00000000e+00]
 [-8.17644177e-03  1.87345817e-02]]
grads:  [-0.00582371 -3.53981365]
Stock Position:  -0.0058237057860081485
Bond Position:  [-1.40637385]


portfolio before change:  [-1.98598684]
curr_Stock_Price:  99.49630083392341
curr_Factors:  [9.94963008e+01 4.24134333e-02]
mat_Sqrt:  [[ 2.04907875e+01  0.00000000e+00]
 [-8.23780877e-03  1.88751911e-02]]
grads:  [3.79689497e-03 1.25532519e+01]
Stock Position:  0.0037968949720893785
Bond Position:  [-2.36376385]


portfolio before change:  [-1.9814659]
curr_Stock_Price:  100.76481852819735
curr_Factors:  [1.00764819e+02 4.02224625e-02]
mat_Sqrt:  [[ 2.02089270e+01  0.00000000e+00]
 [-8.02221540e-03  1.83812047e-02]]
grads:  [ 0.00995863 -0.22491858]
Stock Position:  0.009958625138034744
Bond Position:  [-2.98494496]


portfolio before change:  [-1.97767592]
curr_Stock_Price:  101.18286032496381
curr_Factors:  [1.01182860e+02 4.05797679e-02]
mat_Sqrt:  [[ 2.03827009e+01  0.00000000e+00]
 [-8.05776822e-03  1.84626664e-02]]
grads:  [0.00808602 4.43510836]
Stock Position:  0.008086019104025462
Bond Position:  [-2.79584247]


portfolio before change:  [-1.98496087]
curr_Stock_Price:  100.3251517837046
curr_Factors:  [1.00325152e+02 4.06966313e-02]
mat_Sqrt:  [[ 2.02390003e+01  0.00000000e+00]
 [-8.06936243e-03  1.84892321e-02]]
grads:  [ 0.01143061 -6.85288334]
Stock Position:  0.011430609801355933
Bond Position:  [-3.13173854]


portfolio before change:  [-1.99631943]
curr_Stock_Price:  99.36570487887397
curr_Factors:  [9.93657049e+01 4.13424970e-02]
mat_Sqrt:  [[ 2.02038841e+01  0.00000000e+00]
 [-8.13314178e-03  1.86353689e-02]]
grads:  [0.00825193 7.66007272]
Stock Position:  0.008251934480273912
Bond Position:  [-2.81627871]


portfolio before change:  [-2.00241463]
curr_Stock_Price:  98.66972914117623
curr_Factors:  [9.86697291e+01 4.14764338e-02]
mat_Sqrt:  [[ 2.00948440e+01  0.00000000e+00]
 [-8.14630554e-03  1.86655309e-02]]
grads:  [6.06247527e-03 9.04244406e+00]
Stock Position:  0.00606247526617539
Bond Position:  [-2.60059742]


portfolio before change:  [-1.99853637]
curr_Stock_Price:  99.36306996112886
curr_Factors:  [9.93630700e+01 4.06080076e-02]
mat_Sqrt:  [[ 2.00230781e+01  0.00000000e+00]
 [-8.06057145e-03  1.84690894e-02]]
grads:  [0.00482317 4.14892915]
Stock Position:  0.004823165043194834
Bond Position:  [-2.47778085]


portfolio before change:  [-2.00143019]
curr_Stock_Price:  98.82730548525501
curr_Factors:  [9.88273055e+01 4.13062554e-02]
mat_Sqrt:  [[ 2.00856027e+01  0.00000000e+00]
 [-8.12957616e-03  1.86271991e-02]]
grads:  [ -0.02110825 -19.64388226]
Stock Position:  -0.021108254731656256
Bond Position:  [0.08464175]


portfolio before change:  [-2.01996075]
curr_Stock_Price:  99.70568911405347
curr_Factors:  [9.97056891e+01 4.20554717e-02]
mat_Sqrt:  [[ 2.04470752e+01  0.00000000e+00]
 [-8.20297231e-03  1.87953708e-02]]
grads:  [8.75540786e-03 1.20095240e+01]
Stock Position:  0.008755407861147278
Bond Position:  [-2.89292473]


portfolio before change:  [-2.0298246]
curr_Stock_Price:  98.62039308028608
curr_Factors:  [9.86203931e+01 4.18124170e-02]
mat_Sqrt:  [[ 2.01659816e+01  0.00000000e+00]
 [-8.17923390e-03  1.87409792e-02]]
grads:  [ 0.00216828 -1.02426823]
Stock Position:  0.0021682841899233105
Bond Position:  [-2.24366164]


portfolio before change:  [-2.02946367]
curr_Stock_Price:  98.91620391746807
curr_Factors:  [9.89162039e+01 4.30382585e-02]
mat_Sqrt:  [[ 2.05208236e+01  0.00000000e+00]
 [-8.29826570e-03  1.90137154e-02]]
grads:  [-6.44261183e-05  5.02744052e+00]
Stock Position:  -6.44261182719566e-05
Bond Position:  [-2.02309089]


portfolio before change:  [-2.02974779]
curr_Stock_Price:  99.40066115457212
curr_Factors:  [9.94006612e+01 4.29649679e-02]
mat_Sqrt:  [[ 2.06037617e+01  0.00000000e+00]
 [-8.29119706e-03  1.89975191e-02]]
grads:  [-0.00133869  1.26577823]
Stock Position:  -0.0013386861167256987
Bond Position:  [-1.8966815]


portfolio before change:  [-2.02655393]
curr_Stock_Price:  96.83773600106039
curr_Factors:  [9.68377360e+01 4.25112746e-02]
mat_Sqrt:  [[ 1.99662585e+01  0.00000000e+00]
 [-8.24730497e-03  1.88969497e-02]]
grads:  [1.60111855e-03 2.38577093e+00]
Stock Position:  0.0016011185510104475
Bond Position:  [-2.18160263]


portfolio before change:  [-2.02644727]
curr_Stock_Price:  97.07468201677825
curr_Factors:  [9.70746820e+01 4.27655084e-02]
mat_Sqrt:  [[ 2.00748725e+01  0.00000000e+00]
 [-8.27192925e-03  1.89533710e-02]]
grads:  [ 0.00619967 -5.50863275]
Stock Position:  0.0061996682803571925
Bond Position:  [-2.6282781]


portfolio before change:  [-2.02370525]
curr_Stock_Price:  97.56996331704381
curr_Factors:  [9.75699633e+01 4.31704445e-02]
mat_Sqrt:  [[ 2.02725977e+01  0.00000000e+00]
 [-8.31099941e-03  1.90428920e-02]]
grads:  [ 0.00207811 -1.98383679]
Stock Position:  0.002078106183309301
Bond Position:  [-2.22646599]


portfolio before change:  [-2.02110002]
curr_Stock_Price:  98.95755200935292
curr_Factors:  [9.89575520e+01 4.32294639e-02]
mat_Sqrt:  [[ 2.05749538e+01  0.00000000e+00]
 [-8.31667856e-03  1.90559045e-02]]
grads:  [1.10118931e-02 1.60507002e+01]
Stock Position:  0.011011893130252769
Bond Position:  [-3.11081]


portfolio before change:  [-2.00148733]
curr_Stock_Price:  100.7739123033759
curr_Factors:  [1.00773912e+02 4.23515716e-02]
mat_Sqrt:  [[ 2.07387647e+01  0.00000000e+00]
 [-8.23179898e-03  1.88614210e-02]]
grads:  [1.02177094e-02 2.11226116e+01]
Stock Position:  0.010217709425284367
Bond Position:  [-3.03116588]


portfolio before change:  [-2.00615592]
curr_Stock_Price:  100.35408518302638
curr_Factors:  [1.00354085e+02 4.27333622e-02]
mat_Sqrt:  [[ 2.07452460e+01  0.00000000e+00]
 [-8.26881972e-03  1.89462461e-02]]
grads:  [2.67971782e-03 8.00389693e+00]
Stock Position:  0.002679717821080917
Bond Position:  [-2.27507655]


portfolio before change:  [-2.00017404]
curr_Stock_Price:  102.6924947051473
curr_Factors:  [1.02692495e+02 4.27352790e-02]
mat_Sqrt:  [[ 2.12291192e+01  0.00000000e+00]
 [-8.26900516e-03  1.89466710e-02]]
grads:  [3.69186239e-03 4.66346546e+00]
Stock Position:  0.0036918623924838997
Bond Position:  [-2.3793006]


portfolio before change:  [-2.0006325]
curr_Stock_Price:  102.64887855258141
curr_Factors:  [1.02648879e+02 4.19685278e-02]
mat_Sqrt:  [[ 2.10288768e+01  0.00000000e+00]
 [-8.19448866e-03  1.87759323e-02]]
grads:  [  0.02691609 -20.11599363]
Stock Position:  0.026916089867760444
Bond Position:  [-4.76353894]


portfolio before change:  [-1.9851371]
curr_Stock_Price:  103.24669481344506
curr_Factors:  [1.03246695e+02 4.20631556e-02]
mat_Sqrt:  [[ 2.11751786e+01  0.00000000e+00]
 [-8.20372165e-03  1.87970877e-02]]
grads:  [-5.20606921e-03  1.80517006e+01]
Stock Position:  -0.0052060692073563454
Bond Position:  [-1.44762766]


portfolio before change:  [-1.98856907]
curr_Stock_Price:  103.87115892560327
curr_Factors:  [1.03871159e+02 4.11057066e-02]
mat_Sqrt:  [[ 2.10594021e+01  0.00000000e+00]
 [-8.10981693e-03  1.85819250e-02]]
grads:  [ 0.00709026 -0.38775307]
Stock Position:  0.007090259222083238
Bond Position:  [-2.72504251]


portfolio before change:  [-1.98920151]
curr_Stock_Price:  103.83000634854493
curr_Factors:  [1.03830006e+02 4.09528383e-02]
mat_Sqrt:  [[ 2.10118787e+01  0.00000000e+00]
 [-8.09472306e-03  1.85473406e-02]]
grads:  [-3.49739013e-03 -3.51272015e+00]
Stock Position:  -0.0034973901330739975
Bond Position:  [-1.62606747]


portfolio before change:  [-1.99114826]
curr_Stock_Price:  104.3285167333893
curr_Factors:  [1.04328517e+02 4.04822182e-02]
mat_Sqrt:  [[ 2.09910993e+01  0.00000000e+00]
 [-8.04807735e-03  1.84404618e-02]]
grads:  [-3.51849808e-03 -8.80736913e+00]
Stock Position:  -0.0035184980842708135
Bond Position:  [-1.62406858]


portfolio before change:  [-1.98593905]
curr_Stock_Price:  102.79029323384336
curr_Factors:  [1.02790293e+02 4.10380973e-02]
mat_Sqrt:  [[ 2.08231158e+01  0.00000000e+00]
 [-8.10314480e-03  1.85666372e-02]]
grads:  [-0.01833736 -4.96485059]
Stock Position:  -0.018337356123891695
Bond Position:  [-0.10103683]


portfolio before change:  [-1.95991602]
curr_Stock_Price:  101.37047812569448
curr_Factors:  [1.01370478e+02 4.09495325e-02]
mat_Sqrt:  [[ 2.05133207e+01  0.00000000e+00]
 [-8.09439633e-03  1.85465919e-02]]
grads:  [-0.0057092   0.10775714]
Stock Position:  -0.0057091974426251154
Bond Position:  [-1.38117195]


portfolio before change:  [-1.96568396]
curr_Stock_Price:  102.35052587254653
curr_Factors:  [1.02350526e+02 4.01671612e-02]
mat_Sqrt:  [[ 2.05128332e+01  0.00000000e+00]
 [-8.01669869e-03  1.83685643e-02]]
grads:  [0.00895884 6.0941728 ]
Stock Position:  0.008958842293543814
Bond Position:  [-2.88262618]


portfolio before change:  [-1.97322591]
curr_Stock_Price:  101.54890488937977
curr_Factors:  [1.01548905e+02 4.11339452e-02]
mat_Sqrt:  [[ 2.05956464e+01  0.00000000e+00]
 [-8.11260207e-03  1.85883065e-02]]
grads:  [0.00915049 3.2742499 ]
Stock Position:  0.009150493114275448
Bond Position:  [-2.90244847]


portfolio before change:  [-1.9745874]
curr_Stock_Price:  101.43976800136188
curr_Factors:  [1.01439768e+02 4.04170098e-02]
mat_Sqrt:  [[ 2.03934328e+01  0.00000000e+00]
 [-8.04159285e-03  1.84256040e-02]]
grads:  [-0.01797821 -9.74455439]
Stock Position:  -0.01797821328599857
Bond Position:  [-0.15088161]


portfolio before change:  [-1.95647388]
curr_Stock_Price:  100.43119310790064
curr_Factors:  [1.00431193e+02 4.07320141e-02]
mat_Sqrt:  [[ 2.02691980e+01  0.00000000e+00]
 [-8.07286954e-03  1.84972679e-02]]
grads:  [ -0.02253996 -20.42770725]
Stock Position:  -0.022539958503831538
Bond Position:  [0.30724104]


portfolio before change:  [-1.98466222]
curr_Stock_Price:  101.6834911687842
curr_Factors:  [1.01683491e+02 3.95139322e-02]
mat_Sqrt:  [[ 2.02127579e+01  0.00000000e+00]
 [-7.95124465e-03  1.82185902e-02]]
grads:  [2.04416159e-04 1.43307862e+01]
Stock Position:  0.00020441615859554614
Bond Position:  [-2.00544797]


portfolio before change:  [-1.98481768]
curr_Stock_Price:  102.14937527509116
curr_Factors:  [1.02149375e+02 4.07400267e-02]
mat_Sqrt:  [[ 2.06179921e+01  0.00000000e+00]
 [-8.07366353e-03  1.84990871e-02]]
grads:  [-3.42281252e-03  6.40796681e+00]
Stock Position:  -0.003422812518995954
Bond Position:  [-1.63517952]


portfolio before change:  [-1.98737733]
curr_Stock_Price:  102.83747437766375
curr_Factors:  [1.02837474e+02 4.08973629e-02]
mat_Sqrt:  [[ 2.07969216e+01  0.00000000e+00]
 [-8.08923857e-03  1.85347740e-02]]
grads:  [1.81126594e-04 5.99450624e+00]
Stock Position:  0.00018112659419746574
Bond Position:  [-2.00600393]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.98788328]
Stock Price:  101.42860037242785
PL:  [-3.41648365]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.81547927e-01 -1.74690561e-01]
 [-1.74068716e-01 -8.05195594e-02]
 [ 7.54319216e-01 -6.38800299e-01]
 [-8.81180035e-03  2.49272457e-02]
 [-7.37885239e-02  3.28908299e-02]
 [-1.60531745e-02  6.87896514e-03]
 [ 5.83038348e-02  1.57020576e-01]
 [ 3.37717917e-01 -6.95896598e-03]
 [-1.00317940e-01  1.22049419e-02]
 [ 4.43335579e-01 -2.79876662e-01]
 [ 6.50700917e-02  4.13454266e-03]
 [-8.97973698e-02  1.50711384e-02]
 [ 9.84111271e-02  6.24560465e-02]
 [-1.79332102e-01 -2.25683607e-01]
 [ 9.02006979e-02  2.33465562e-01]
 [ 4.42830595e-02  7.83316732e-02]
 [ 2.01401514e-02 -5.83831510e-02]
 [ 3.50128317e-02  5.60248028e-02]
 [ 1.08318741e-02  3.51575346e-02]
 [ 3.84353538e-01 -1.18653861e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.53312753e-02  5.14980404e-02]
 [-7.98293771e-02 -2.34554175e-02]
 [ 3.74684091e-02 -1.73513960e-01]
 [ 3.99709773e-02  1.54387233e-01]
 [ 4.41907738e-02  1.67547207e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.69502372e-01  1.13437183e-01]
 [-1.41454903e-01 -6.63490106e-02]
 [ 1.15723665e-01 -7.33689455e-02]
 [-1.02986043e+00 -1.16719949e-01]
 [-7.20069497e-02  1.32085040e-01]
 [-2.61757907e-03 -9.03692351e-02]
 [ 6.24894148e-02  9.19704432e-02]
 [-1.16628983e-01  1.20451706e-01]
 [-6.13735224e-01 -2.91371850e-01]
 [-2.26823689e-02  3.12204081e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 5.46628323e-01  3.89736049e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.22023216]
curr_Stock_Price:  98.50467838110404
curr_Factors:  [9.85046784e+01 4.05828021e-02]
mat_Sqrt:  [[ 1.98439385e+01  0.00000000e+00]
 [-8.05806945e-03  1.84633566e-02]]
grads:  [-0.02306947 -9.46147359]
Stock Position:  -0.023069469717447458
Bond Position:  [-4.94778147]


portfolio before change:  [-7.26343166]
curr_Stock_Price:  100.35045084160289
curr_Factors:  [1.00350451e+02 4.00599178e-02]
mat_Sqrt:  [[ 2.00851165e+01  0.00000000e+00]
 [-8.00598954e-03  1.83440265e-02]]
grads:  [-0.01041619 -4.38941577]
Stock Position:  -0.010416187180453772
Bond Position:  [-6.21816258]


portfolio before change:  [-7.27056933]
curr_Stock_Price:  100.96107219006458
curr_Factors:  [1.00961072e+02 4.16734026e-02]
mat_Sqrt:  [[ 2.06102583e+01  0.00000000e+00]
 [-8.16562577e-03  1.87097991e-02]]
grads:  [ 2.30721955e-02 -3.41425526e+01]
Stock Position:  0.023072195458286985
Bond Position:  [-9.59996292]


portfolio before change:  [-7.28627396]
curr_Stock_Price:  100.33241263830027
curr_Factors:  [1.00332413e+02 4.22117928e-02]
mat_Sqrt:  [[ 2.06138046e+01  0.00000000e+00]
 [-8.21820348e-03  1.88302698e-02]]
grads:  [1.0028918e-04 1.3237859e+00]
Stock Position:  0.00010028918049511292
Bond Position:  [-7.29633621]


portfolio before change:  [-7.2871517]
curr_Stock_Price:  100.67494270893384
curr_Factors:  [1.00674943e+02 4.25425364e-02]
mat_Sqrt:  [[ 2.07650548e+01  0.00000000e+00]
 [-8.25033685e-03  1.89038966e-02]]
grads:  [-0.0028622   1.73989684]
Stock Position:  -0.0028622023659448754
Bond Position:  [-6.99899964]


portfolio before change:  [-7.29051089]
curr_Stock_Price:  101.54289462697989
curr_Factors:  [1.01542895e+02 4.36845075e-02]
mat_Sqrt:  [[ 2.12233170e+01  0.00000000e+00]
 [-8.36033564e-03  1.91559355e-02]]
grads:  [-0.00061493  0.35910359]
Stock Position:  -0.0006149344107599696
Bond Position:  [-7.22806867]


portfolio before change:  [-7.29216808]
curr_Stock_Price:  102.76844463474858
curr_Factors:  [1.02768445e+02 4.39186777e-02]
mat_Sqrt:  [[ 2.15369605e+01  0.00000000e+00]
 [-8.38271342e-03  1.92072094e-02]]
grads:  [5.88909621e-03 8.17508535e+00]
Stock Position:  0.0058890962096239535
Bond Position:  [-7.89738134]


portfolio before change:  [-7.29301673]
curr_Stock_Price:  102.79197723492949
curr_Factors:  [1.02791977e+02 4.22822488e-02]
mat_Sqrt:  [[ 2.11367523e+01  0.00000000e+00]
 [-8.22505916e-03  1.88459781e-02]]
grads:  [ 0.01583407 -0.3692547 ]
Stock Position:  0.015834068075971878
Bond Position:  [-8.9206319]


portfolio before change:  [-7.26967661]
curr_Stock_Price:  104.33644925899951
curr_Factors:  [1.04336449e+02 4.04513285e-02]
mat_Sqrt:  [[ 2.09846847e+01  0.00000000e+00]
 [-8.04500626e-03  1.84334251e-02]]
grads:  [-0.00452669  0.66210929]
Stock Position:  -0.004526694956263624
Bond Position:  [-6.79737733]


portfolio before change:  [-7.26470469]
curr_Stock_Price:  103.05038126651041
curr_Factors:  [1.03050381e+02 4.15111798e-02]
mat_Sqrt:  [[ 2.09957862e+01  0.00000000e+00]
 [-8.14971704e-03  1.86733476e-02]]
grads:  [  0.01529771 -14.9880283 ]
Stock Position:  0.015297707195431698
Bond Position:  [-8.84113925]


portfolio before change:  [-7.28722078]
curr_Stock_Price:  101.65076819150913
curr_Factors:  [1.01650768e+02 4.32564235e-02]
mat_Sqrt:  [[ 2.11415084e+01  0.00000000e+00]
 [-8.31927146e-03  1.90618456e-02]]
grads:  [0.00316319 0.21690149]
Stock Position:  0.00316318745285683
Bond Position:  [-7.60876121]


portfolio before change:  [-7.29361325]
curr_Stock_Price:  99.93056531903848
curr_Factors:  [9.99305653e+01 4.30641419e-02]
mat_Sqrt:  [[ 2.07374925e+01  0.00000000e+00]
 [-8.30076063e-03  1.90194319e-02]]
grads:  [-0.00401301  0.79240739]
Stock Position:  -0.004013011002809396
Bond Position:  [-6.8925908]


portfolio before change:  [-7.29076809]
curr_Stock_Price:  99.00687174432724
curr_Factors:  [9.90068717e+01 4.44815350e-02]
mat_Sqrt:  [[ 2.08811889e+01  0.00000000e+00]
 [-8.43625842e-03  1.93298964e-02]]
grads:  [0.0060183  3.23105956]
Stock Position:  0.0060182962372708395
Bond Position:  [-7.88662077]


portfolio before change:  [-7.30103802]
curr_Stock_Price:  97.4642357299842
curr_Factors:  [9.74642357e+01 4.53273184e-02]
mat_Sqrt:  [[ 2.07503437e+01  0.00000000e+00]
 [-8.51608533e-03  1.95128028e-02]]
grads:  [ -0.0133891  -11.56592465]
Stock Position:  -0.01338910365441106
Bond Position:  [-5.99607927]


portfolio before change:  [-7.29716418]
curr_Stock_Price:  97.11892542599075
curr_Factors:  [9.71189254e+01 4.51949094e-02]
mat_Sqrt:  [[ 2.06466040e+01  0.00000000e+00]
 [-8.50363775e-03  1.94842818e-02]]
grads:  [9.30387498e-03 1.19822513e+01]
Stock Position:  0.009303874982476467
Bond Position:  [-8.20074652]


portfolio before change:  [-7.30658734]
curr_Stock_Price:  96.21629075838081
curr_Factors:  [9.62162908e+01 4.51281127e-02]
mat_Sqrt:  [[ 2.04395908e+01  0.00000000e+00]
 [-8.49735137e-03  1.94698779e-02]]
grads:  [3.83910840e-03 4.02322364e+00]
Stock Position:  0.003839108395143459
Bond Position:  [-7.67597211]


portfolio before change:  [-7.30299202]
curr_Stock_Price:  97.40273217499855
curr_Factors:  [9.74027322e+01 4.32728161e-02]
mat_Sqrt:  [[ 2.02618324e+01  0.00000000e+00]
 [-8.32084766e-03  1.90654571e-02]]
grads:  [-2.63566717e-04 -3.06224763e+00]
Stock Position:  -0.00026356671659024
Bond Position:  [-7.2773199]


portfolio before change:  [-7.30391571]
curr_Stock_Price:  97.45572697058499
curr_Factors:  [9.74557270e+01 4.33377885e-02]
mat_Sqrt:  [[ 2.02880702e+01  0.00000000e+00]
 [-8.32709203e-03  1.90797648e-02]]
grads:  [2.93098652e-03 2.93634662e+00]
Stock Position:  0.0029309865206324907
Bond Position:  [-7.58955713]


portfolio before change:  [-7.30888254]
curr_Stock_Price:  96.08483097689503
curr_Factors:  [9.60848310e+01 4.24167493e-02]
mat_Sqrt:  [[ 1.97889851e+01  0.00000000e+00]
 [-8.23813078e-03  1.88759290e-02]]
grads:  [1.32275000e-03 1.86255917e+00]
Stock Position:  0.0013227500036808047
Bond Position:  [-7.43597875]


portfolio before change:  [-7.31266986]
curr_Stock_Price:  93.92436182762424
curr_Factors:  [9.39243618e+01 4.19740917e-02]
mat_Sqrt:  [[ 1.92428284e+01  0.00000000e+00]
 [-8.19503183e-03  1.87771769e-02]]
grads:  [ 0.01728274 -6.3190469 ]
Stock Position:  0.017282737277198503
Bond Position:  [-8.93593992]


portfolio before change:  [-7.32356246]
curr_Stock_Price:  93.35873694886949
curr_Factors:  [9.33587369e+01 4.14714407e-02]
mat_Sqrt:  [[ 1.90120754e+01  0.00000000e+00]
 [-8.14581519e-03  1.86644074e-02]]
grads:  [ 0.00221589 -2.02406586]
Stock Position:  0.0022158869889011145
Bond Position:  [-7.53043487]


portfolio before change:  [-7.3254247]
curr_Stock_Price:  92.94315721735845
curr_Factors:  [9.29431572e+01 4.05641772e-02]
mat_Sqrt:  [[ 1.87192635e+01  0.00000000e+00]
 [-8.05622017e-03  1.84591194e-02]]
grads:  [-1.52553430e-04  2.78984275e+00]
Stock Position:  -0.00015255342953239697
Bond Position:  [-7.31124591]


portfolio before change:  [-7.32612943]
curr_Stock_Price:  91.57161711952597
curr_Factors:  [9.15716171e+01 4.32674230e-02]
mat_Sqrt:  [[ 1.90476498e+01  0.00000000e+00]
 [-8.32032913e-03  1.90642690e-02]]
grads:  [-0.00472847 -1.23033395]
Stock Position:  -0.004728465784011266
Bond Position:  [-6.89313618]


portfolio before change:  [-7.33237155]
curr_Stock_Price:  92.70949473191152
curr_Factors:  [9.27094947e+01 4.40956663e-02]
mat_Sqrt:  [[ 1.94680373e+01  0.00000000e+00]
 [-8.39958726e-03  1.92458722e-02]]
grads:  [-1.96523620e-03 -9.01564544e+00]
Stock Position:  -0.0019652361955328633
Bond Position:  [-7.15017549]


portfolio before change:  [-7.33563071]
curr_Stock_Price:  93.9130858984454
curr_Factors:  [9.39130859e+01 4.34491699e-02]
mat_Sqrt:  [[ 1.95756798e+01  0.00000000e+00]
 [-8.33778578e-03  1.91042672e-02]]
grads:  [5.48390098e-03 8.08129570e+00]
Stock Position:  0.005483900977512677
Bond Position:  [-7.85064078]


portfolio before change:  [-7.33422231]
curr_Stock_Price:  94.3488696063002
curr_Factors:  [9.43488696e+01 4.43694329e-02]
mat_Sqrt:  [[ 1.98736959e+01  0.00000000e+00]
 [-8.42562120e-03  1.93055235e-02]]
grads:  [5.90299713e-03 8.67871868e+00]
Stock Position:  0.005902997131620286
Bond Position:  [-7.89116342]


portfolio before change:  [-7.33093059]
curr_Stock_Price:  95.07361595697179
curr_Factors:  [9.50736160e+01 4.37937994e-02]
mat_Sqrt:  [[ 1.98960253e+01  0.00000000e+00]
 [-8.37078724e-03  1.91798831e-02]]
grads:  [8.95463279e-03 9.12087909e+00]
Stock Position:  0.008954632789607281
Bond Position:  [-8.18227991]


portfolio before change:  [-7.32577975]
curr_Stock_Price:  95.76305697279277
curr_Factors:  [9.57630570e+01 4.29001253e-02]
mat_Sqrt:  [[ 1.98347751e+01  0.00000000e+00]
 [-8.28493817e-03  1.89831781e-02]]
grads:  [-0.00604969  5.97566869]
Stock Position:  -0.0060496943038285365
Bond Position:  [-6.74644253]


portfolio before change:  [-7.3357023]
curr_Stock_Price:  97.26382545032598
curr_Factors:  [9.72638255e+01 4.26494082e-02]
mat_Sqrt:  [[ 2.00866657e+01  0.00000000e+00]
 [-8.26069325e-03  1.89276261e-02]]
grads:  [-0.00848384 -3.50540582]
Stock Position:  -0.008483836404333216
Bond Position:  [-6.51053192]


portfolio before change:  [-7.33465734]
curr_Stock_Price:  97.04472294449607
curr_Factors:  [9.70447229e+01 4.46143928e-02]
mat_Sqrt:  [[ 2.04979023e+01  0.00000000e+00]
 [-8.44884776e-03  1.93587422e-02]]
grads:  [ 0.00408348 -3.78996449]
Stock Position:  0.004083482828796768
Bond Position:  [-7.7309378]


portfolio before change:  [-7.33874103]
curr_Stock_Price:  96.28133884944256
curr_Factors:  [9.62813388e+01 4.33142492e-02]
mat_Sqrt:  [[ 2.00381451e+01  0.00000000e+00]
 [-8.32483025e-03  1.90745824e-02]]
grads:  [-0.05393719 -6.11913525]
Stock Position:  -0.053937187612158745
Bond Position:  [-2.14559639]


portfolio before change:  [-7.31530355]
curr_Stock_Price:  95.84183323296519
curr_Factors:  [9.58418332e+01 4.33994054e-02]
mat_Sqrt:  [[ 1.99662729e+01  0.00000000e+00]
 [-8.33300958e-03  1.90933236e-02]]
grads:  [-7.19228489e-04  6.91786526e+00]
Stock Position:  -0.0007192284889709773
Bond Position:  [-7.24637137]


portfolio before change:  [-7.31773893]
curr_Stock_Price:  97.96846213849032
curr_Factors:  [9.79684621e+01 4.35461517e-02]
mat_Sqrt:  [[ 2.04437792e+01  0.00000000e+00]
 [-8.34708588e-03  1.91255764e-02]]
grads:  [-2.05724912e-03 -4.72504635e+00]
Stock Position:  -0.002057249120718825
Bond Position:  [-7.1161934]


portfolio before change:  [-7.31560893]
curr_Stock_Price:  96.50068573015591
curr_Factors:  [9.65006857e+01 4.36400780e-02]
mat_Sqrt:  [[ 2.01591937e+01  0.00000000e+00]
 [-8.35608310e-03  1.91461917e-02]]
grads:  [0.00509091 4.8035894 ]
Stock Position:  0.005090908312827752
Bond Position:  [-7.80688508]


portfolio before change:  [-7.30910085]
curr_Stock_Price:  97.97075838919828
curr_Factors:  [9.79707584e+01 4.20390594e-02]
mat_Sqrt:  [[ 2.00873647e+01  0.00000000e+00]
 [-8.20137154e-03  1.87917029e-02]]
grads:  [-3.18904693e-03  6.40983453e+00]
Stock Position:  -0.0031890469297198476
Bond Position:  [-6.9966675]


portfolio before change:  [-7.3118609]
curr_Stock_Price:  98.56197309977226
curr_Factors:  [9.85619731e+01 4.15736585e-02]
mat_Sqrt:  [[ 2.00964113e+01  0.00000000e+00]
 [-8.15584782e-03  1.86873950e-02]]
grads:  [ -0.0368673  -15.59189233]
Stock Position:  -0.03686729500651317
Bond Position:  [-3.67814756]


portfolio before change:  [-7.30308169]
curr_Stock_Price:  98.31137144584306
curr_Factors:  [9.83113714e+01 4.03048577e-02]
mat_Sqrt:  [[ 1.97370595e+01  0.00000000e+00]
 [-8.03042790e-03  1.84000219e-02]]
grads:  [5.75438621e-03 1.69675930e+01]
Stock Position:  0.0057543862101907305
Bond Position:  [-7.86880329]


portfolio before change:  [-7.30507055]
curr_Stock_Price:  98.13668797162241
curr_Factors:  [9.81366880e+01 4.00342718e-02]
mat_Sqrt:  [[ 1.96357441e+01  0.00000000e+00]
 [-8.00342644e-03  1.83381537e-02]]
grads:  [-4.49105544e-03  5.96361912e+00]
Stock Position:  -0.004491055441148943
Bond Position:  [-6.86433324]


portfolio before change:  [-7.30883283]
curr_Stock_Price:  98.78334828730652
curr_Factors:  [9.87833483e+01 3.96924077e-02]
mat_Sqrt:  [[ 1.96805606e+01  0.00000000e+00]
 [-7.96918141e-03  1.82596885e-02]]
grads:  [0.02863932 2.13440688]
Stock Position:  0.028639316266690678
Bond Position:  [-10.13792038]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.36337397]
Stock Price:  96.9231845698427
PL:  [-7.36337397]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.06691654e-01 -1.05324495e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.45681796e-01 -7.58463728e-01]
 [-3.12442115e-02  1.49608703e-01]
 [ 4.06598108e-02 -3.34214414e-02]
 [-8.10168207e-02 -1.00839145e-01]
 [-5.57646311e-02  1.86287202e-01]
 [-2.89358790e-02 -6.82574437e-02]
 [ 1.66249912e-01  9.27071374e-02]
 [ 1.89718722e-02  2.04130248e-01]
 [ 1.68516991e-01  3.73821106e-01]
 [ 1.82791504e-01  2.51485524e-01]
 [ 2.01875961e-01  2.51129706e-02]
 [-1.17170772e-01 -1.10528335e-01]
 [ 8.49896789e-02  2.29296317e-01]
 [ 5.21559577e-02 -1.92293352e-02]
 [-5.11482399e-03 -2.24442287e-02]
 [ 1.76719012e-02  5.31911232e-02]
 [ 1.59862131e-02  3.88659677e-02]
 [ 2.01864101e-01 -1.06379226e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 3.40885540e-02  2.17147709e-01]
 [ 3.53017033e-02  2.41407847e-01]
 [-8.45834645e-02  1.06462039e-01]
 [ 1.53138765e-02  3.69463035e-02]
 [ 4.35248832e-01 -8.19268050e-02]
 [ 6.25516507e-03  9.08316894e-02]
 [-1.45274220e-01  1.19285210e-01]
 [ 2.17301663e-02 -1.48537191e-01]
 [-2.20701977e-02 -4.11667004e-02]
 [-4.83834755e-01 -1.00486898e-01]
 [-7.55205813e-02 -2.32695210e-03]
 [ 2.00481342e-01  2.21200023e-01]
 [ 2.14511943e-01  3.38692979e-02]
 [-2.03350288e-01 -2.34698734e-01]
 [ 1.53519659e-01 -1.67030296e-01]
 [-1.96562574e-01  1.88059252e-01]
 [-1.15891097e-01  1.22870032e-01]
 [-2.17536490e-01  1.54648854e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.19781308]
curr_Stock_Price:  98.80928742858812
curr_Factors:  [9.88092874e+01 4.06279077e-02]
mat_Sqrt:  [[ 1.99163613e+01  0.00000000e+00]
 [-8.06254627e-03  1.84736143e-02]]
grads:  [-0.017707  -5.7013475]
Stock Position:  -0.017707001130022586
Bond Position:  [-3.44819691]


portfolio before change:  [-5.19833902]
curr_Stock_Price:  98.81464633036576
curr_Factors:  [9.88146463e+01 4.02301385e-02]
mat_Sqrt:  [[ 1.98197004e+01  0.00000000e+00]
 [-8.02298084e-03  1.83829585e-02]]
grads:  [-0.01024155 -4.78766082]
Stock Position:  -0.010241549787348493
Bond Position:  [-4.1863239]


portfolio before change:  [-5.19683657]
curr_Stock_Price:  98.61684688224607
curr_Factors:  [9.86168469e+01 4.10746283e-02]
mat_Sqrt:  [[ 1.99865546e+01  0.00000000e+00]
 [-8.10675060e-03  1.85748991e-02]]
grads:  [ 2.57503656e-02 -4.08327239e+01]
Stock Position:  0.025750365577222076
Bond Position:  [-7.73625643]


portfolio before change:  [-5.20954461]
curr_Stock_Price:  98.16089418472332
curr_Factors:  [9.81608942e+01 4.26727671e-02]
mat_Sqrt:  [[ 2.02774766e+01  0.00000000e+00]
 [-8.26295512e-03  1.89328087e-02]]
grads:  [1.67922174e-03 7.90208708e+00]
Stock Position:  0.0016792217359531457
Bond Position:  [-5.37437852]


portfolio before change:  [-5.20956034]
curr_Stock_Price:  98.55161660042647
curr_Factors:  [9.85516166e+01 4.30256938e-02]
mat_Sqrt:  [[ 2.04422029e+01  0.00000000e+00]
 [-8.29705430e-03  1.90109397e-02]]
grads:  [ 1.27547398e-03 -1.75801102e+00]
Stock Position:  0.001275473982897362
Bond Position:  [-5.33526036]


portfolio before change:  [-5.21087991]
curr_Stock_Price:  98.0399491311538
curr_Factors:  [9.80399491e+01 4.29170545e-02]
mat_Sqrt:  [[ 2.03103792e+01  0.00000000e+00]
 [-8.28657270e-03  1.89869233e-02]]
grads:  [-0.0061558  -5.31097867]
Stock Position:  -0.006155799974243217
Bond Position:  [-4.60736559]


portfolio before change:  [-5.21507109]
curr_Stock_Price:  98.62723718076508
curr_Factors:  [9.86272372e+01 4.10633793e-02]
mat_Sqrt:  [[ 1.99859230e+01  0.00000000e+00]
 [-8.10564044e-03  1.85723554e-02]]
grads:  [1.27778783e-03 1.00303487e+01]
Stock Position:  0.0012777878312513695
Bond Position:  [-5.34109578]


portfolio before change:  [-5.21503067]
curr_Stock_Price:  99.18139735594482
curr_Factors:  [9.91813974e+01 4.15598437e-02]
mat_Sqrt:  [[ 2.02193493e+01  0.00000000e+00]
 [-8.15449262e-03  1.86842899e-02]]
grads:  [-2.90443914e-03 -3.65319979e+00]
Stock Position:  -0.0029044391440009774
Bond Position:  [-4.92696434]


portfolio before change:  [-5.21282912]
curr_Stock_Price:  98.21134231006714
curr_Factors:  [9.82113423e+01 4.15504404e-02]
mat_Sqrt:  [[ 2.00193265e+01  0.00000000e+00]
 [-8.15357006e-03  1.86821760e-02]]
grads:  [0.01032555 4.96233081]
Stock Position:  0.010325553353920693
Bond Position:  [-6.22691557]


portfolio before change:  [-5.23541292]
curr_Stock_Price:  96.09955300527588
curr_Factors:  [9.60995530e+01 4.30981216e-02]
mat_Sqrt:  [[ 1.99503509e+01  0.00000000e+00]
 [-8.30403483e-03  1.90269341e-02]]
grads:  [5.41652710e-03 1.07284887e+01]
Stock Position:  0.005416527095704063
Bond Position:  [-5.75593875]


portfolio before change:  [-5.2355645]
curr_Stock_Price:  96.20440963898838
curr_Factors:  [9.62044096e+01 4.26551308e-02]
mat_Sqrt:  [[ 1.98692108e+01  0.00000000e+00]
 [-8.26124744e-03  1.89288959e-02]]
grads:  [1.66924545e-02 1.97487011e+01]
Stock Position:  0.016692454491022267
Bond Position:  [-6.84145223]


portfolio before change:  [-5.22581724]
curr_Stock_Price:  96.83957659886381
curr_Factors:  [9.68395766e+01 4.29899752e-02]
mat_Sqrt:  [[ 2.00787411e+01  0.00000000e+00]
 [-8.29360961e-03  1.90030469e-02]]
grads:  [ 0.01457008 13.23395795]
Stock Position:  0.014570076041470703
Bond Position:  [-6.63677723]


portfolio before change:  [-5.22445447]
curr_Stock_Price:  96.99005077379171
curr_Factors:  [9.69900508e+01 4.27477027e-02]
mat_Sqrt:  [[ 2.00531950e+01  0.00000000e+00]
 [-8.27020703e-03  1.89494249e-02]]
grads:  [0.01061358 1.32526294]
Stock Position:  0.010613578534882135
Bond Position:  [-6.25386599]


portfolio before change:  [-5.23224548]
curr_Stock_Price:  96.32964847524006
curr_Factors:  [9.63296485e+01 4.34834355e-02]
mat_Sqrt:  [[ 2.00873155e+01  0.00000000e+00]
 [-8.34107288e-03  1.91117989e-02]]
grads:  [-0.00823451 -5.78325124]
Stock Position:  -0.008234514591754668
Bond Position:  [-4.43901759]


portfolio before change:  [-5.25076378]
curr_Stock_Price:  98.51112356690221
curr_Factors:  [9.85111236e+01 4.11047304e-02]
mat_Sqrt:  [[ 1.99724423e+01  0.00000000e+00]
 [-8.10972062e-03  1.85817043e-02]]
grads:  [9.26590717e-03 1.23398970e+01]
Stock Position:  0.009265907174470348
Bond Position:  [-6.16355871]


portfolio before change:  [-5.25001734]
curr_Stock_Price:  98.67483549843683
curr_Factors:  [9.86748355e+01 4.06994214e-02]
mat_Sqrt:  [[ 1.99067576e+01  0.00000000e+00]
 [-8.06963904e-03  1.84898659e-02]]
grads:  [ 0.00219843 -1.03999323]
Stock Position:  0.0021984287254276807
Bond Position:  [-5.46694693]


portfolio before change:  [-5.25204946]
curr_Stock_Price:  98.06134652412267
curr_Factors:  [9.80613465e+01 3.99929379e-02]
mat_Sqrt:  [[ 1.96105379e+01  0.00000000e+00]
 [-7.99929376e-03  1.83286846e-02]]
grads:  [-7.60320217e-04 -1.22454116e+00]
Stock Position:  -0.0007603202173960753
Bond Position:  [-5.17749143]


portfolio before change:  [-5.25254269]
curr_Stock_Price:  97.8588105245947
curr_Factors:  [9.78588105e+01 3.91163997e-02]
mat_Sqrt:  [[ 1.93543848e+01  0.00000000e+00]
 [-7.91114654e-03  1.81267139e-02]]
grads:  [2.11251409e-03 2.93440518e+00]
Stock Position:  0.0021125140920633958
Bond Position:  [-5.45927081]


portfolio before change:  [-5.25456535]
curr_Stock_Price:  97.22439965771544
curr_Factors:  [9.72243997e+01 3.92195803e-02]
mat_Sqrt:  [[ 1.92542560e+01  0.00000000e+00]
 [-7.92157361e-03  1.81506054e-02]]
grads:  [1.71124307e-03 2.14130421e+00]
Stock Position:  0.001711243065735083
Bond Position:  [-5.42093993]


portfolio before change:  [-5.25628357]
curr_Stock_Price:  96.6163232714148
curr_Factors:  [9.66163233e+01 3.97151131e-02]
mat_Sqrt:  [[ 1.92543299e+01  0.00000000e+00]
 [-7.97146041e-03  1.82649104e-02]]
grads:  [ 0.0080728  -5.82424025]
Stock Position:  0.008072802371007657
Bond Position:  [-6.03624806]


portfolio before change:  [-5.2580102]
curr_Stock_Price:  96.49591312432295
curr_Factors:  [9.64959131e+01 4.01239553e-02]
mat_Sqrt:  [[ 1.93290625e+01  0.00000000e+00]
 [-8.01238594e-03  1.83586825e-02]]
grads:  [ 0.00217955 -2.05777237]
Stock Position:  0.0021795475451653465
Bond Position:  [-5.46832763]


portfolio before change:  [-5.25795287]
curr_Stock_Price:  96.83585175408882
curr_Factors:  [9.68358518e+01 3.91593740e-02]
mat_Sqrt:  [[ 1.91625829e+01  0.00000000e+00]
 [-7.91549104e-03  1.81366684e-02]]
grads:  [6.72454150e-03 1.19728555e+01]
Stock Position:  0.0067245415010082
Bond Position:  [-5.90912957]


portfolio before change:  [-5.25148442]
curr_Stock_Price:  97.90761890878467
curr_Factors:  [9.79076189e+01 3.83908147e-02]
mat_Sqrt:  [[ 1.91836019e+01  0.00000000e+00]
 [-7.83742965e-03  1.79578073e-02]]
grads:  [7.33234178e-03 1.34430581e+01]
Stock Position:  0.0073323417799839715
Bond Position:  [-5.96937654]


portfolio before change:  [-5.25603157]
curr_Stock_Price:  97.38923940211815
curr_Factors:  [9.73892394e+01 3.78018202e-02]
mat_Sqrt:  [[ 1.89350881e+01  0.00000000e+00]
 [-7.77707608e-03  1.78195199e-02]]
grads:  [-2.01317371e-03  5.97446167e+00]
Stock Position:  -0.0020131737105538784
Bond Position:  [-5.05997011]


portfolio before change:  [-5.2602056]
curr_Stock_Price:  99.14840024233405
curr_Factors:  [9.91484002e+01 3.60308449e-02]
mat_Sqrt:  [[ 1.88201437e+01  0.00000000e+00]
 [-7.59271703e-03  1.73971003e-02]]
grads:  [1.67047425e-03 2.12370470e+00]
Stock Position:  0.0016704742470223953
Bond Position:  [-5.42583045]


portfolio before change:  [-5.26142676]
curr_Stock_Price:  98.82341268928968
curr_Factors:  [9.88234127e+01 3.49591671e-02]
mat_Sqrt:  [[ 1.84773798e+01  0.00000000e+00]
 [-7.47894828e-03  1.71364233e-02]]
grads:  [ 0.02162065 -4.78085791]
Stock Position:  0.021620654410191585
Bond Position:  [-7.39805361]


portfolio before change:  [-5.24486394]
curr_Stock_Price:  99.63225160900586
curr_Factors:  [9.96322516e+01 3.51240736e-02]
mat_Sqrt:  [[ 1.86724964e+01  0.00000000e+00]
 [-7.49656706e-03  1.71767930e-02]]
grads:  [2.45801972e-03 5.28804704e+00]
Stock Position:  0.002458019719306639
Bond Position:  [-5.48976198]


portfolio before change:  [-5.24478357]
curr_Stock_Price:  99.94414379815603
curr_Factors:  [9.99441438e+01 3.56397991e-02]
mat_Sqrt:  [[ 1.88679612e+01  0.00000000e+00]
 [-7.55140242e-03  1.73024366e-02]]
grads:  [-4.94032635e-03  6.89412783e+00]
Stock Position:  -0.004940326354770642
Bond Position:  [-4.75102688]


portfolio before change:  [-5.2450246]
curr_Stock_Price:  99.87271500351676
curr_Factors:  [9.98727150e+01 3.68135866e-02]
mat_Sqrt:  [[ 1.91624450e+01  0.00000000e+00]
 [-7.67474681e-03  1.75850541e-02]]
grads:  [-2.24902294e-03 -8.44678612e+00]
Stock Position:  -0.002249022941809651
Bond Position:  [-5.02040858]


portfolio before change:  [-5.2476575]
curr_Stock_Price:  100.76435012684803
curr_Factors:  [1.0076435e+02 3.7346458e-02]
mat_Sqrt:  [[ 1.94729441e+01  0.00000000e+00]
 [-7.73009268e-03  1.77118674e-02]]
grads:  [-2.05602288e-03 -2.32424394e+00]
Stock Position:  -0.002056022881482516
Bond Position:  [-5.04048369]


portfolio before change:  [-5.25029987]
curr_Stock_Price:  101.74306907041574
curr_Factors:  [1.01743069e+02 3.70455014e-02]
mat_Sqrt:  [[ 1.95827001e+01  0.00000000e+00]
 [-7.69888318e-03  1.76403575e-02]]
grads:  [-0.02694679 -5.69642072]
Stock Position:  -0.026946786206406576
Bond Position:  [-2.50865114]


portfolio before change:  [-5.31098581]
curr_Stock_Price:  103.98349737254487
curr_Factors:  [1.03983497e+02 3.59712147e-02]
mat_Sqrt:  [[ 1.97215921e+01  0.00000000e+00]
 [-7.58643155e-03  1.73826984e-02]]
grads:  [-0.00388083 -0.13386599]
Stock Position:  -0.003880830006406511
Bond Position:  [-4.90744354]


portfolio before change:  [-5.31497861]
curr_Stock_Price:  104.85427229113583
curr_Factors:  [1.04854272e+02 3.47251214e-02]
mat_Sqrt:  [[ 1.95392557e+01  0.00000000e+00]
 [-7.45387109e-03  1.70789642e-02]]
grads:  [ 0.01520124 12.95160639]
Stock Position:  0.015201241553972455
Bond Position:  [-6.90889373]


portfolio before change:  [-5.30732424]
curr_Stock_Price:  105.41462357851518
curr_Factors:  [1.05414624e+02 3.39372839e-02]
mat_Sqrt:  [[ 1.94195608e+01  0.00000000e+00]
 [-7.36882991e-03  1.68841104e-02]]
grads:  [0.01180736 2.00598652]
Stock Position:  0.01180735853335773
Bond Position:  [-6.5519925]


portfolio before change:  [-5.30558506]
curr_Stock_Price:  105.63128744759655
curr_Factors:  [1.05631287e+02 3.32886171e-02]
mat_Sqrt:  [[ 1.92726063e+01  0.00000000e+00]
 [-7.29806737e-03  1.67219731e-02]]
grads:  [ -0.01586611 -14.03534937]
Stock Position:  -0.015866105945361222
Bond Position:  [-3.62962787]


portfolio before change:  [-5.3046493]
curr_Stock_Price:  105.5437112703167
curr_Factors:  [1.05543711e+02 3.30192973e-02]
mat_Sqrt:  [[ 1.91785723e+01  0.00000000e+00]
 [-7.26848511e-03  1.66541916e-02]]
grads:  [ 4.20373632e-03 -1.00293247e+01]
Stock Position:  0.004203736321346663
Bond Position:  [-5.74832724]


portfolio before change:  [-5.30172839]
curr_Stock_Price:  106.40948787081976
curr_Factors:  [1.06409488e+02 3.36154010e-02]
mat_Sqrt:  [[ 1.95096510e+01  0.00000000e+00]
 [-7.33380130e-03  1.68038498e-02]]
grads:  [-5.86821299e-03  1.11914385e+01]
Stock Position:  -0.005868212988950864
Bond Position:  [-4.67729485]


portfolio before change:  [-5.30871515]
curr_Stock_Price:  107.50045953396723
curr_Factors:  [1.07500460e+02 3.23808195e-02]
mat_Sqrt:  [[ 1.93443543e+01  0.00000000e+00]
 [-7.19786852e-03  1.64923887e-02]]
grads:  [-3.21883158e-03  7.45010526e+00]
Stock Position:  -0.0032188315823862223
Bond Position:  [-4.96268927]


portfolio before change:  [-5.30850992]
curr_Stock_Price:  107.24396880664264
curr_Factors:  [1.07243969e+02 3.41565573e-02]
mat_Sqrt:  [[ 1.98202863e+01  0.00000000e+00]
 [-7.39259709e-03  1.69385679e-02]]
grads:  [-7.57013265e-03  9.12998402e+00]
Stock Position:  -0.007570132646042398
Bond Position:  [-4.49665885]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.32224166]
Stock Price:  108.98365049855744
PL:  [-14.30589216]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.74616270e-01  4.89166651e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.12793013e-01 -6.90632595e-01]
 [-3.72068705e-02  4.77442416e-02]
 [ 2.52749031e-02 -6.75533039e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-5.41767134e-02  1.88442484e-01]
 [-9.41309827e-02 -1.05433097e-01]
 [ 1.65571341e-01  1.14923287e-01]
 [ 1.01700915e-01  8.88357947e-02]
 [ 1.40171813e-01  2.70214922e-01]
 [-2.93962340e-02  1.11409860e-01]
 [ 1.74579598e-01  3.02927714e-02]
 [-2.78628582e-01 -3.82793144e-01]
 [ 8.16210191e-02  2.26619428e-01]
 [ 5.30879790e-02 -1.98231751e-02]
 [-5.17347905e-02  2.01188191e-01]
 [-5.06546009e-02  2.04159914e-02]
 [ 1.55386432e-02  4.99791945e-02]
 [ 7.16223872e-02 -9.81628884e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 8.00479563e-02  2.75239950e-01]
 [ 3.49642887e-02  2.21960457e-01]
 [-8.57400080e-02  1.05660608e-01]
 [ 5.41910465e-02  1.45833880e-01]
 [ 1.11025539e-01  6.20304592e-02]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.72458110e-01  1.19939481e-01]
 [-1.68628909e-01 -5.28380022e-02]
 [ 1.47129308e-01 -8.07084659e-02]
 [-1.06442113e+00 -1.20888852e-01]
 [-1.17647430e-01  8.05803924e-02]
 [-8.48473887e-03 -1.18406479e-01]
 [ 3.13061677e-02  7.48811492e-02]
 [-6.10995471e-02  1.62324983e-01]
 [-1.49259999e+00 -1.11797603e-01]
 [-8.74468551e-02  2.14074920e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.15611496e+00 -3.60422932e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.31759338]
curr_Stock_Price:  99.24309513199636
curr_Factors:  [9.92430951e+01 4.09044287e-02]
mat_Sqrt:  [[ 2.00717605e+01  0.00000000e+00]
 [-8.08993733e-03  1.85363751e-02]]
grads:  [-0.00763597  2.63895529]
Stock Position:  -0.007635966312697163
Bond Position:  [-1.55977645]


portfolio before change:  [-2.32240171]
curr_Stock_Price:  99.8472543578505
curr_Factors:  [9.98472544e+01 4.11273446e-02]
mat_Sqrt:  [[ 2.02489012e+01  0.00000000e+00]
 [-8.11195114e-03  1.85868151e-02]]
grads:  [-0.01002447 -4.73515069]
Stock Position:  -0.01002446729146915
Bond Position:  [-1.32148617]


portfolio before change:  [-2.32152881]
curr_Stock_Price:  99.74369789182957
curr_Factors:  [9.97436979e+01 4.19194667e-02]
mat_Sqrt:  [[ 2.04217681e+01  0.00000000e+00]
 [-8.18969759e-03  1.87649546e-02]]
grads:  [ 2.50407426e-02 -3.68043841e+01]
Stock Position:  0.025040742590400424
Bond Position:  [-4.81918507]


portfolio before change:  [-2.32446056]
curr_Stock_Price:  99.65067683899161
curr_Factors:  [9.96506768e+01 4.28243095e-02]
mat_Sqrt:  [[ 2.06217462e+01  0.00000000e+00]
 [-8.27761410e-03  1.89663966e-02]]
grads:  [-7.93801600e-04  2.51730693e+00]
Stock Position:  -0.0007938015997069469
Bond Position:  [-2.24535769]


portfolio before change:  [-2.3243944]
curr_Stock_Price:  99.21373116755056
curr_Factors:  [9.92137312e+01 4.22816117e-02]
mat_Sqrt:  [[ 2.04008165e+01  0.00000000e+00]
 [-8.22499719e-03  1.88458361e-02]]
grads:  [ 0.0010944  -0.35845215]
Stock Position:  0.0010943991005438474
Bond Position:  [-2.43297382]


portfolio before change:  [-2.32488011]
curr_Stock_Price:  99.04781894122287
curr_Factors:  [9.90478189e+01 4.27681682e-02]
mat_Sqrt:  [[ 2.04835507e+01  0.00000000e+00]
 [-8.27218648e-03  1.89539604e-02]]
grads:  [-0.00578126 -3.49884282]
Stock Position:  -0.005781261916500284
Bond Position:  [-1.75225873]


portfolio before change:  [-2.3229332]
curr_Stock_Price:  98.67316829906024
curr_Factors:  [9.86731683e+01 4.28000955e-02]
mat_Sqrt:  [[ 2.04136866e+01  0.00000000e+00]
 [-8.27527358e-03  1.89610338e-02]]
grads:  [1.37487803e-03 9.93840769e+00]
Stock Position:  0.0013748780281325125
Bond Position:  [-2.45859678]


portfolio before change:  [-2.32446334]
curr_Stock_Price:  97.78378482080898
curr_Factors:  [9.77837848e+01 4.31328311e-02]
mat_Sqrt:  [[ 2.03081717e+01  0.00000000e+00]
 [-8.30737803e-03  1.90345943e-02]]
grads:  [-0.00690095 -5.53902519]
Stock Position:  -0.006900954021669918
Bond Position:  [-1.64966194]


portfolio before change:  [-2.31876262]
curr_Stock_Price:  96.92782482458125
curr_Factors:  [9.69278248e+01 4.33041073e-02]
mat_Sqrt:  [[ 2.01703304e+01  0.00000000e+00]
 [-8.32385558e-03  1.90723491e-02]]
grads:  [0.01069531 6.0256493 ]
Stock Position:  0.01069531195235004
Bond Position:  [-3.35543595]


portfolio before change:  [-2.31301683]
curr_Stock_Price:  97.5042687180175
curr_Factors:  [9.75042687e+01 4.51480842e-02]
mat_Sqrt:  [[ 2.07177836e+01  0.00000000e+00]
 [-8.49923142e-03  1.94741857e-02]]
grads:  [0.00678026 4.56172064]
Stock Position:  0.006780263606512311
Bond Position:  [-2.97412148]


portfolio before change:  [-2.31265408]
curr_Stock_Price:  97.61260330729563
curr_Factors:  [9.76126033e+01 4.50011785e-02]
mat_Sqrt:  [[ 2.07070313e+01  0.00000000e+00]
 [-8.48539248e-03  1.94424767e-02]]
grads:  [1.24645233e-02 1.38981739e+01]
Stock Position:  0.012464523320655386
Bond Position:  [-3.52934865]


portfolio before change:  [-2.29226588]
curr_Stock_Price:  99.28369781014112
curr_Factors:  [9.92836978e+01 4.44855374e-02]
mat_Sqrt:  [[ 2.09405153e+01  0.00000000e+00]
 [-8.43663795e-03  1.93307660e-02]]
grads:  [9.18172976e-04 5.76334431e+00]
Stock Position:  0.000918172975990043
Bond Position:  [-2.38342549]


portfolio before change:  [-2.29382446]
curr_Stock_Price:  97.91071757852929
curr_Factors:  [9.79107176e+01 4.60944044e-02]
mat_Sqrt:  [[ 2.10210467e+01  0.00000000e+00]
 [-8.58784298e-03  1.96772202e-02]]
grads:  [0.00893392 1.53948429]
Stock Position:  0.008933924625241967
Bond Position:  [-3.16855143]


portfolio before change:  [-2.28443135]
curr_Stock_Price:  99.00645211780272
curr_Factors:  [9.90064521e+01 4.42277238e-02]
mat_Sqrt:  [[ 2.08214415e+01  0.00000000e+00]
 [-8.41215537e-03  1.92746694e-02]]
grads:  [ -0.02140549 -19.85990713]
Stock Position:  -0.021405492371982367
Bond Position:  [-0.16514949]


portfolio before change:  [-2.29303116]
curr_Stock_Price:  99.40724508921669
curr_Factors:  [9.94072451e+01 4.51146570e-02]
mat_Sqrt:  [[ 2.11143088e+01  0.00000000e+00]
 [-8.49608447e-03  1.94669751e-02]]
grads:  [8.54992923e-03 1.16412245e+01]
Stock Position:  0.008549929234180175
Bond Position:  [-3.14295607]


portfolio before change:  [-2.2909616]
curr_Stock_Price:  99.69525410028045
curr_Factors:  [9.96952541e+01 4.58141737e-02]
mat_Sqrt:  [[ 2.13390172e+01  0.00000000e+00]
 [-8.56169830e-03  1.96173153e-02]]
grads:  [ 0.0020824  -1.01049378]
Stock Position:  0.0020824031239504537
Bond Position:  [-2.49856731]


portfolio before change:  [-2.29082449]
curr_Stock_Price:  99.91108506535465
curr_Factors:  [9.99110851e+01 4.32870088e-02]
mat_Sqrt:  [[ 2.07870310e+01  0.00000000e+00]
 [-8.32221209e-03  1.90685834e-02]]
grads:  [1.73526149e-03 1.05507675e+01]
Stock Position:  0.0017352614920631306
Bond Position:  [-2.46419635]


portfolio before change:  [-2.29185541]
curr_Stock_Price:  99.49450343388008
curr_Factors:  [9.94945034e+01 4.45885697e-02]
mat_Sqrt:  [[ 2.10092650e+01  0.00000000e+00]
 [-8.44640228e-03  1.93531389e-02]]
grads:  [-0.00198695  1.05491887]
Stock Position:  -0.0019869486997329726
Bond Position:  [-2.09416494]


portfolio before change:  [-2.29008426]
curr_Stock_Price:  98.47135561398905
curr_Factors:  [9.84713556e+01 4.50130008e-02]
mat_Sqrt:  [[ 2.08919462e+01  0.00000000e+00]
 [-8.48650701e-03  1.94450304e-02]]
grads:  [1.78783497e-03 2.57028112e+00]
Stock Position:  0.001787834965243134
Bond Position:  [-2.46613479]


portfolio before change:  [-2.29030454]
curr_Stock_Price:  98.52058178001444
curr_Factors:  [9.85205818e+01 4.37961480e-02]
mat_Sqrt:  [[ 2.06179236e+01  0.00000000e+00]
 [-8.37101169e-03  1.91803974e-02]]
grads:  [ 1.39590150e-03 -5.11787564e+00]
Stock Position:  0.0013959015009402079
Bond Position:  [-2.42782956]


portfolio before change:  [-2.29138511]
curr_Stock_Price:  97.96389606534247
curr_Factors:  [9.79638961e+01 4.48270566e-02]
mat_Sqrt:  [[ 2.07413089e+01  0.00000000e+00]
 [-8.46896041e-03  1.94048261e-02]]
grads:  [ 0.00203115 -1.94683475]
Stock Position:  0.0020311452245168355
Bond Position:  [-2.49036401]


portfolio before change:  [-2.2913651]
curr_Stock_Price:  98.12702170729163
curr_Factors:  [9.81270217e+01 4.56231647e-02]
mat_Sqrt:  [[ 2.09595194e+01  0.00000000e+00]
 [-8.54383190e-03  1.95763782e-02]]
grads:  [9.55043454e-03 1.40597994e+01]
Stock Position:  0.009550434539985506
Bond Position:  [-3.22852079]


portfolio before change:  [-2.29703867]
curr_Stock_Price:  97.57521628853958
curr_Factors:  [9.75752163e+01 4.48694201e-02]
mat_Sqrt:  [[ 2.06687756e+01  0.00000000e+00]
 [-8.47296124e-03  1.94139931e-02]]
grads:  [6.37849946e-03 1.14330141e+01]
Stock Position:  0.006378499456960189
Bond Position:  [-2.91942213]


portfolio before change:  [-2.29915626]
curr_Stock_Price:  97.30044358570859
curr_Factors:  [9.73004436e+01 4.51983889e-02]
mat_Sqrt:  [[ 2.06859894e+01  0.00000000e+00]
 [-8.50396509e-03  1.94850319e-02]]
grads:  [-1.91559309e-03  5.42265512e+00]
Stock Position:  -0.0019155930869650868
Bond Position:  [-2.1127682]


portfolio before change:  [-2.29514261]
curr_Stock_Price:  95.0673203765475
curr_Factors:  [9.50673204e+01 4.69988548e-02]
mat_Sqrt:  [[ 2.06098528e+01  0.00000000e+00]
 [-8.67168771e-03  1.98693327e-02]]
grads:  [5.71756483e-03 7.33964659e+00]
Stock Position:  0.005717564826693543
Bond Position:  [-2.83869618]


portfolio before change:  [-2.28669012]
curr_Stock_Price:  96.60772380721706
curr_Factors:  [9.66077238e+01 4.67552673e-02]
mat_Sqrt:  [[ 2.08894556e+01  0.00000000e+00]
 [-8.64918653e-03  1.98177760e-02]]
grads:  [0.00661089 3.13004139]
Stock Position:  0.0066108879844310004
Bond Position:  [-2.92535296]


portfolio before change:  [-2.29032735]
curr_Stock_Price:  96.11285179607133
curr_Factors:  [9.61128518e+01 4.75744897e-02]
mat_Sqrt:  [[ 2.09637288e+01  0.00000000e+00]
 [-8.72463085e-03  1.99906406e-02]]
grads:  [8.49856445e-03 8.75096489e+00]
Stock Position:  0.008498564450942618
Bond Position:  [-3.10714862]


portfolio before change:  [-2.28846526]
curr_Stock_Price:  96.3776621206557
curr_Factors:  [9.63776621e+01 4.51875350e-02]
mat_Sqrt:  [[ 2.04873465e+01  0.00000000e+00]
 [-8.50294396e-03  1.94826922e-02]]
grads:  [-5.86275187e-03  6.15620677e+00]
Stock Position:  -0.005862751865760842
Bond Position:  [-1.72342694]


portfolio before change:  [-2.2914027]
curr_Stock_Price:  96.84194811848035
curr_Factors:  [9.68419481e+01 4.52509245e-02]
mat_Sqrt:  [[ 2.06004755e+01  0.00000000e+00]
 [-8.50890588e-03  1.94963526e-02]]
grads:  [-0.00930509 -2.71014806]
Stock Position:  -0.009305091194892498
Bond Position:  [-1.39027954]


portfolio before change:  [-2.28558115]
curr_Stock_Price:  96.19764059375055
curr_Factors:  [9.61976406e+01 4.59381931e-02]
mat_Sqrt:  [[ 2.06182298e+01  0.00000000e+00]
 [-8.57327877e-03  1.96438495e-02]]
grads:  [ 0.00542749 -4.10858707]
Stock Position:  0.005427490504034221
Bond Position:  [-2.80769293]


portfolio before change:  [-2.28739]
curr_Stock_Price:  95.92903291248243
curr_Factors:  [9.59290329e+01 4.69263669e-02]
mat_Sqrt:  [[ 2.07806215e+01  0.00000000e+00]
 [-8.66499781e-03  1.98540042e-02]]
grads:  [-0.05376073 -6.08889021]
Stock Position:  -0.05376072845904156
Bond Position:  [2.86982469]


portfolio before change:  [-2.31173231]
curr_Stock_Price:  96.38849577036393
curr_Factors:  [9.63884958e+01 4.81053365e-02]
mat_Sqrt:  [[ 2.11408201e+01  0.00000000e+00]
 [-8.77317152e-03  2.01018613e-02]]
grads:  [-3.90142214e-03  4.00860354e+00]
Stock Position:  -0.003901422142883242
Bond Position:  [-1.9356801]


portfolio before change:  [-2.31013142]
curr_Stock_Price:  95.91613774686704
curr_Factors:  [9.59161377e+01 4.65038312e-02]
mat_Sqrt:  [[ 2.06840724e+01  0.00000000e+00]
 [-8.62589879e-03  1.97644171e-02]]
grads:  [-2.90859370e-03 -5.99089152e+00]
Stock Position:  -0.002908593704599599
Bond Position:  [-2.03115034]


portfolio before change:  [-2.30645275]
curr_Stock_Price:  94.56408454501656
curr_Factors:  [9.45640845e+01 4.52564155e-02]
mat_Sqrt:  [[ 2.01171428e+01  0.00000000e+00]
 [-8.50942212e-03  1.94975355e-02]]
grads:  [3.18071911e-03 3.84054432e+00]
Stock Position:  0.0031807191060389136
Bond Position:  [-2.60723454]


portfolio before change:  [-2.30277881]
curr_Stock_Price:  95.82161916797791
curr_Factors:  [9.58216192e+01 4.45945043e-02]
mat_Sqrt:  [[ 2.02350450e+01  0.00000000e+00]
 [-8.44696435e-03  1.93544268e-02]]
grads:  [4.81584467e-04 8.38696927e+00]
Stock Position:  0.0004815844667779702
Bond Position:  [-2.34892502]


portfolio before change:  [-2.30365839]
curr_Stock_Price:  94.60491552830862
curr_Factors:  [9.46049155e+01 4.49418924e-02]
mat_Sqrt:  [[ 2.00557718e+01  0.00000000e+00]
 [-8.47980117e-03  1.94296654e-02]]
grads:  [-0.07685531 -5.75396443]
Stock Position:  -0.07685530522481436
Bond Position:  [4.96723127]


portfolio before change:  [-2.22281051]
curr_Stock_Price:  93.56104556843805
curr_Factors:  [9.35610456e+01 4.54981320e-02]
mat_Sqrt:  [[ 1.99568434e+01  0.00000000e+00]
 [-8.53211645e-03  1.95495347e-02]]
grads:  [2.99801916e-04 1.09503844e+01]
Stock Position:  0.0002998019159236098
Bond Position:  [-2.25086029]


portfolio before change:  [-2.22261508]
curr_Stock_Price:  95.15142489117717
curr_Factors:  [9.51514249e+01 4.43258454e-02]
mat_Sqrt:  [[ 2.00328994e+01  0.00000000e+00]
 [-8.42148162e-03  1.92960385e-02]]
grads:  [-4.40201958e-03  5.66757599e+00]
Stock Position:  -0.0044020195798629815
Bond Position:  [-1.80375665]


portfolio before change:  [-2.21765954]
curr_Stock_Price:  93.97446024136114
curr_Factors:  [9.39744602e+01 4.50997478e-02]
mat_Sqrt:  [[ 1.99570753e+01  0.00000000e+00]
 [-8.49468049e-03  1.94637582e-02]]
grads:  [ 0.05714188 -1.85176434]
Stock Position:  0.05714188064846257
Bond Position:  [-7.58753693]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.19447234]
Stock Price:  94.39684228009317
PL:  [-2.19447234]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.18382990e-01  4.07078643e-01]
 [-1.66275589e-01 -8.59176591e-02]
 [ 8.11037798e-01 -6.87444608e-01]
 [-3.58724415e-03  2.46116962e-02]
 [-7.58086098e-04  3.66332860e-03]
 [ 1.29613272e-02  4.18584622e-02]
 [ 3.63695942e-02  2.38888166e-01]
 [ 2.64822865e-01 -2.10648169e-03]
 [-2.12343610e-02  4.74853975e-02]
 [ 4.69005145e-01 -3.12669155e-01]
 [ 6.10712639e-02 -9.67273614e-03]
 [-1.63311196e-01 -1.82107390e-01]
 [-1.49573284e-01  1.43277633e-01]
 [-7.06255994e-01 -9.77875830e-01]
 [-3.10950228e-02 -2.57462986e-01]
 [ 1.21506473e-02 -1.59581995e-01]
 [-5.08509362e-02  1.51503877e-01]
 [ 8.55917488e-02  1.50105152e-01]
 [ 1.54888673e-02  5.12151378e-02]
 [-1.08949341e-01 -2.85988350e-02]
 [ 2.04103072e-01  4.89911050e-01]
 [ 9.72079738e-03  1.51902946e-01]
 [-1.24130107e-02 -2.09462059e-01]
 [ 1.05888925e-01  1.93571666e-01]
 [ 6.94583345e-02  1.46211812e-01]
 [ 8.01758016e-01 -6.91542508e-01]
 [-5.00678082e-01  6.33310615e-01]
 [ 1.15025599e-01 -1.15969766e-02]
 [-4.92863349e-02 -6.05244537e-02]
 [ 2.09721252e-02 -1.93318890e-01]
 [ 6.64460998e-02 -6.78109155e-02]
 [ 1.03474073e-01 -1.16913127e-02]
 [ 3.06662129e-01  3.98141116e-01]
 [ 2.50156627e-01  1.55820021e-02]
 [-1.87860185e-01 -2.38253319e-01]
 [ 1.83750208e-01 -7.40775910e-02]
 [-2.39326294e-01  1.56914046e-01]
 [-1.14350092e-01  1.23909625e-01]
 [-2.32585121e-01  1.58463180e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.52048053]
curr_Stock_Price:  100.27301974087663
curr_Factors:  [1.00273020e+02 4.04145115e-02]
mat_Sqrt:  [[ 2.01582469e+01  0.00000000e+00]
 [-8.04134431e-03  1.84250345e-02]]
grads:  [1.46861320e-02 2.20937791e+01]
Stock Position:  0.01468613197669318
Bond Position:  [3.04785773]


portfolio before change:  [4.51773776]
curr_Stock_Price:  100.06031749323465
curr_Factors:  [1.00060317e+02 3.92957700e-02]
mat_Sqrt:  [[ 1.98351175e+01  0.00000000e+00]
 [-7.92926428e-03  1.81682269e-02]]
grads:  [-0.01027335 -4.72900629]
Stock Position:  -0.010273351285796728
Bond Position:  [5.54569256]


portfolio before change:  [4.52072829]
curr_Stock_Price:  99.83670295469689
curr_Factors:  [9.9836703e+01 3.9959061e-02]
mat_Sqrt:  [[ 1.99571199e+01  0.00000000e+00]
 [-7.99590505e-03  1.83209201e-02]]
grads:  [ 2.56055170e-02 -3.75223845e+01]
Stock Position:  0.025605517001267297
Bond Position:  [1.9643579]


portfolio before change:  [4.5364705]
curr_Stock_Price:  100.44191047066495
curr_Factors:  [1.00441910e+02 4.04367089e-02]
mat_Sqrt:  [[ 2.01977441e+01  0.00000000e+00]
 [-8.04355234e-03  1.84300937e-02]]
grads:  [3.54206917e-04 1.33540809e+00]
Stock Position:  0.0003542069174610223
Bond Position:  [4.50089328]


portfolio before change:  [4.53681836]
curr_Stock_Price:  99.83552434406799
curr_Factors:  [9.98355243e+01 4.15487426e-02]
mat_Sqrt:  [[ 2.03499828e+01  0.00000000e+00]
 [-8.15340347e-03  1.86817943e-02]]
grads:  [4.13131346e-05 1.96090833e-01]
Stock Position:  4.1313134595758444e-05
Bond Position:  [4.53269384]


portfolio before change:  [4.53747205]
curr_Stock_Price:  101.94305830419268
curr_Factors:  [1.01943058e+02 4.11495691e-02]
mat_Sqrt:  [[ 2.06795129e+01  0.00000000e+00]
 [-8.11414263e-03  1.85918364e-02]]
grads:  [1.51018344e-03 2.25144312e+00]
Stock Position:  0.0015101834350170428
Bond Position:  [4.38351934]


portfolio before change:  [4.53837486]
curr_Stock_Price:  102.17801967431801
curr_Factors:  [1.02178020e+02 4.14767744e-02]
mat_Sqrt:  [[ 2.08094196e+01  0.00000000e+00]
 [-8.14633899e-03  1.86656075e-02]]
grads:  [6.75794614e-03 1.27983065e+01]
Stock Position:  0.006757946141830531
Bond Position:  [3.84786131]


portfolio before change:  [4.53649357]
curr_Stock_Price:  101.82846028313892
curr_Factors:  [1.01828460e+02 4.19669036e-02]
mat_Sqrt:  [[ 2.08604004e+01  0.00000000e+00]
 [-8.19433009e-03  1.87755690e-02]]
grads:  [ 0.01265093 -0.1121927 ]
Stock Position:  0.012650932682908232
Bond Position:  [3.24826858]


portfolio before change:  [4.55934544]
curr_Stock_Price:  103.60270145993482
curr_Factors:  [1.03602701e+02 4.07550698e-02]
mat_Sqrt:  [[ 2.09151942e+01  0.00000000e+00]
 [-8.07515398e-03  1.85025022e-02]]
grads:  [-2.43858341e-05  2.56643113e+00]
Stock Position:  -2.438583411429129e-05
Bond Position:  [4.56187187]


portfolio before change:  [4.55992012]
curr_Stock_Price:  103.42178038018676
curr_Factors:  [1.03421780e+02 3.98594397e-02]
mat_Sqrt:  [[ 2.06479816e+01  0.00000000e+00]
 [-7.98593160e-03  1.82980680e-02]]
grads:  [ 1.61054550e-02 -1.70875501e+01]
Stock Position:  0.016105454991101616
Bond Position:  [2.89426529]


portfolio before change:  [4.56263906]
curr_Stock_Price:  103.56813658281116
curr_Factors:  [1.03568137e+02 4.03157850e-02]
mat_Sqrt:  [[ 2.07952297e+01  0.00000000e+00]
 [-8.03151642e-03  1.84025160e-02]]
grads:  [ 0.00273379 -0.52562031]
Stock Position:  0.0027337873389934836
Bond Position:  [4.2795058]


portfolio before change:  [4.56440096]
curr_Stock_Price:  104.01693979994522
curr_Factors:  [1.04016940e+02 3.89044192e-02]
mat_Sqrt:  [[ 2.05165126e+01  0.00000000e+00]
 [-7.88968128e-03  1.80775308e-02]]
grads:  [ -0.01183385 -10.07368713]
Stock Position:  -0.01183385214504706
Bond Position:  [5.79532205]


portfolio before change:  [4.56732417]
curr_Stock_Price:  103.83113855073387
curr_Factors:  [1.03831139e+02 3.88684407e-02]
mat_Sqrt:  [[ 2.04703927e+01  0.00000000e+00]
 [-7.88603228e-03  1.80691699e-02]]
grads:  [-4.25208245e-03  7.92939764e+00]
Stock Position:  -0.004252082454923592
Bond Position:  [5.00882273]


portfolio before change:  [4.56580461]
curr_Stock_Price:  104.33576046280697
curr_Factors:  [1.04335760e+02 3.92436291e-02]
mat_Sqrt:  [[ 2.06689192e+01  0.00000000e+00]
 [-7.92400193e-03  1.81561693e-02]]
grads:  [ -0.05481835 -53.85914905]
Stock Position:  -0.05481834752670523
Bond Position:  [10.28531859]


portfolio before change:  [4.56011064]
curr_Stock_Price:  104.4630849488693
curr_Factors:  [1.04463085e+02 3.89645997e-02]
mat_Sqrt:  [[ 2.06204414e+01  0.00000000e+00]
 [-7.89578112e-03  1.80915073e-02]]
grads:  [-6.95722654e-03 -1.42311517e+01]
Stock Position:  -0.006957226537035684
Bond Position:  [5.28688399]


portfolio before change:  [4.56011064]
curr_Stock_Price:  104.55808019475141
curr_Factors:  [1.04558080e+02 3.88988254e-02]
mat_Sqrt:  [[ 2.06217655e+01  0.00000000e+00]
 [-7.88911406e-03  1.80762312e-02]]
grads:  [-2.78815339e-03 -8.82827807e+00]
Stock Position:  -0.0027881533858636954
Bond Position:  [4.85163461]


portfolio before change:  [4.55778411]
curr_Stock_Price:  105.61003942724497
curr_Factors:  [1.05610039e+02 3.77591272e-02]
mat_Sqrt:  [[ 2.05218344e+01  0.00000000e+00]
 [-7.77268316e-03  1.78094545e-02]]
grads:  [7.44123368e-04 8.50693529e+00]
Stock Position:  0.0007441233677469632
Bond Position:  [4.47919721]


portfolio before change:  [4.55783256]
curr_Stock_Price:  104.92267422004092
curr_Factors:  [1.04922674e+02 3.75830831e-02]
mat_Sqrt:  [[ 2.03406840e+01  0.00000000e+00]
 [-7.75454273e-03  1.77678895e-02]]
grads:  [7.42860995e-03 8.44811374e+00]
Stock Position:  0.007428609951122331
Bond Position:  [3.77840294]


portfolio before change:  [4.5620207]
curr_Stock_Price:  105.42287703979073
curr_Factors:  [1.05422877e+02 3.77371068e-02]
mat_Sqrt:  [[ 2.04794913e+01  0.00000000e+00]
 [-7.77041640e-03  1.78042607e-02]]
grads:  [1.84775029e-03 2.87656639e+00]
Stock Position:  0.0018477502880429868
Bond Position:  [4.36722555]


portfolio before change:  [4.5624801]
curr_Stock_Price:  105.37604388579614
curr_Factors:  [1.05376044e+02 4.00939151e-02]
mat_Sqrt:  [[ 2.10999353e+01  0.00000000e+00]
 [-8.00938600e-03  1.83518088e-02]]
grads:  [-0.00575504 -1.55836601]
Stock Position:  -0.005755036427154128
Bond Position:  [5.16892307]


portfolio before change:  [4.55381733]
curr_Stock_Price:  106.99357101429322
curr_Factors:  [1.06993571e+02 3.93110685e-02]
mat_Sqrt:  [[ 2.12136357e+01  0.00000000e+00]
 [-7.93080762e-03  1.81717631e-02]]
grads:  [1.97004318e-02 2.69600174e+01]
Stock Position:  0.019700431804255205
Bond Position:  [2.44599778]


portfolio before change:  [4.53493009]
curr_Stock_Price:  106.01932821977972
curr_Factors:  [1.06019328e+02 4.15648600e-02]
mat_Sqrt:  [[ 2.16146501e+01  0.00000000e+00]
 [-8.15498473e-03  1.86854174e-02]]
grads:  [3.51690533e-03 8.12949170e+00]
Stock Position:  0.003516905332958215
Bond Position:  [4.16207015]


portfolio before change:  [4.53545887]
curr_Stock_Price:  106.02174127741961
curr_Factors:  [1.06021741e+02 4.37486853e-02]
mat_Sqrt:  [[ 2.21757050e+01  0.00000000e+00]
 [-8.36647455e-03  1.91700015e-02]]
grads:  [-4.68213966e-03 -1.09265541e+01]
Stock Position:  -0.0046821396583090645
Bond Position:  [5.03186747]


portfolio before change:  [4.53924877]
curr_Stock_Price:  105.34664829166731
curr_Factors:  [1.05346648e+02 4.45794551e-02]
mat_Sqrt:  [[ 2.22427305e+01  0.00000000e+00]
 [-8.44553895e-03  1.93511608e-02]]
grads:  [8.55877502e-03 1.00031036e+01]
Stock Position:  0.008558775022919393
Bond Position:  [3.63761051]


portfolio before change:  [4.53942184]
curr_Stock_Price:  105.31373917527037
curr_Factors:  [1.05313739e+02 4.42264415e-02]
mat_Sqrt:  [[ 2.21475674e+01  0.00000000e+00]
 [-8.41203343e-03  1.92743900e-02]]
grads:  [6.01738325e-03 7.58580751e+00]
Stock Position:  0.0060173832518346775
Bond Position:  [3.90570871]


portfolio before change:  [4.54564126]
curr_Stock_Price:  106.26617595465662
curr_Factors:  [1.06266176e+02 4.50913854e-02]
mat_Sqrt:  [[ 2.25653380e+01  0.00000000e+00]
 [-8.49389291e-03  1.94619536e-02]]
grads:  [ 2.21554015e-02 -3.55330468e+01]
Stock Position:  0.02215540149176353
Bond Position:  [2.19127147]


portfolio before change:  [4.53103429]
curr_Stock_Price:  105.59451572787668
curr_Factors:  [1.05594516e+02 4.59921148e-02]
mat_Sqrt:  [[ 2.26455594e+01  0.00000000e+00]
 [-8.57830891e-03  1.96553750e-02]]
grads:  [-9.90386970e-03  3.22207344e+01]
Stock Position:  -0.009903869696546263
Bond Position:  [5.57682861]


portfolio before change:  [4.52274933]
curr_Stock_Price:  106.50144494400833
curr_Factors:  [1.06501445e+02 4.41213266e-02]
mat_Sqrt:  [[ 2.23707107e+01  0.00000000e+00]
 [-8.40203086e-03  1.92514712e-02]]
grads:  [ 0.00491555 -0.6023943 ]
Stock Position:  0.004915546257114193
Bond Position:  [3.99923655]


portfolio before change:  [4.52019745]
curr_Stock_Price:  105.8805958714187
curr_Factors:  [1.05880596e+02 4.53550761e-02]
mat_Sqrt:  [[ 2.25491059e+01  0.00000000e+00]
 [-8.51869249e-03  1.95187766e-02]]
grads:  [-0.00335718 -3.10083234]
Stock Position:  -0.0033571784347348464
Bond Position:  [4.8756575]


portfolio before change:  [4.52461854]
curr_Stock_Price:  104.74523968323305
curr_Factors:  [1.04745240e+02 4.55452805e-02]
mat_Sqrt:  [[ 2.23540380e+01  0.00000000e+00]
 [-8.53653611e-03  1.95596615e-02]]
grads:  [-2.83613884e-03 -9.88354991e+00]
Stock Position:  -0.002836138844102898
Bond Position:  [4.82169058]


portfolio before change:  [4.52219809]
curr_Stock_Price:  105.81119579595196
curr_Factors:  [1.05811196e+02 4.60699515e-02]
mat_Sqrt:  [[ 2.27112219e+01  0.00000000e+00]
 [-8.58556477e-03  1.96720002e-02]]
grads:  [ 1.62258949e-03 -3.44707781e+00]
Stock Position:  0.0016225894926210525
Bond Position:  [4.35050995]


portfolio before change:  [4.52319644]
curr_Stock_Price:  106.09130400438067
curr_Factors:  [1.06091304e+02 4.67198780e-02]
mat_Sqrt:  [[ 2.29314036e+01  0.00000000e+00]
 [-8.64591260e-03  1.98102745e-02]]
grads:  [ 0.00428982 -0.59016409]
Stock Position:  0.0042898187900866115
Bond Position:  [4.06808397]


portfolio before change:  [4.53577236]
curr_Stock_Price:  108.90433319662857
curr_Factors:  [1.08904333e+02 4.68802440e-02]
mat_Sqrt:  [[ 2.35797986e+01  0.00000000e+00]
 [-8.66073844e-03  1.98442447e-02]]
grads:  [ 0.02037444 20.06330404]
Stock Position:  0.02037443851129429
Bond Position:  [2.31690772]


portfolio before change:  [4.50535936]
curr_Stock_Price:  107.39741381150998
curr_Factors:  [1.07397414e+02 4.65894468e-02]
mat_Sqrt:  [[ 2.31812900e+01  0.00000000e+00]
 [-8.63383547e-03  1.97826023e-02]]
grads:  [0.01108468 0.7876619 ]
Stock Position:  0.011084679489292702
Bond Position:  [3.31489345]


portfolio before change:  [4.49599913]
curr_Stock_Price:  106.51560081573346
curr_Factors:  [1.06515601e+02 4.76549086e-02]
mat_Sqrt:  [[ 2.32523602e+01  0.00000000e+00]
 [-8.73200170e-03  2.00075294e-02]]
grads:  [ -0.01255109 -11.90818287]
Stock Position:  -0.012551089688119745
Bond Position:  [5.83288599]


portfolio before change:  [4.48355659]
curr_Stock_Price:  107.56504763498181
curr_Factors:  [1.07565048e+02 4.87482111e-02]
mat_Sqrt:  [[ 2.37492837e+01  0.00000000e+00]
 [-8.83159882e-03  2.02357351e-02]]
grads:  [ 0.00637578 -3.66073142]
Stock Position:  0.006375775304290346
Bond Position:  [3.79774601]


portfolio before change:  [4.4876514]
curr_Stock_Price:  108.13283121138421
curr_Factors:  [1.08132831e+02 4.84925227e-02]
mat_Sqrt:  [[ 2.38119501e+01  0.00000000e+00]
 [-8.80840714e-03  2.01825962e-02]]
grads:  [-7.17469124e-03  7.77472058e+00]
Stock Position:  -0.007174691236269838
Bond Position:  [5.26347107]


portfolio before change:  [4.48367446]
curr_Stock_Price:  108.7788397776784
curr_Factors:  [1.08778840e+02 4.95424529e-02]
mat_Sqrt:  [[ 2.42121399e+01  0.00000000e+00]
 [-8.90325360e-03  2.03999168e-02]]
grads:  [-2.48930899e-03  6.07402602e+00]
Stock Position:  -0.0024893089875211113
Bond Position:  [4.7544586]


portfolio before change:  [4.48705535]
curr_Stock_Price:  107.65943280100993
curr_Factors:  [1.07659433e+02 5.00936864e-02]
mat_Sqrt:  [[ 2.40959240e+01  0.00000000e+00]
 [-8.95264756e-03  2.05130926e-02]]
grads:  [-6.78231387e-03  7.72497757e+00]
Stock Position:  -0.006782313872495656
Bond Position:  [5.21723542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.49140407]
Stock Price:  107.11440906198483
PL:  [-2.62300499]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.15970646e-02  2.74780926e-01]
 [-1.64730436e-01 -8.71290540e-02]
 [ 8.26181068e-01 -7.13964325e-01]
 [-4.62731444e-02  7.92888059e-02]
 [ 3.47759728e-02 -2.06944986e-02]
 [-8.05921111e-02 -1.02572053e-01]
 [-1.37609935e-01  7.20244906e-02]
 [ 1.11988803e-01 -1.55321681e-01]
 [ 1.64242689e-01  1.58422856e-01]
 [-2.10122317e-01  5.25878962e-01]
 [ 2.47356192e-01  7.83633588e-01]
 [ 2.05211479e-02  4.21723412e-01]
 [ 4.12391950e-01  2.55702798e-02]
 [-1.94196088e-02  1.58142003e-01]
 [ 9.95229070e-02  2.50287990e-01]
 [ 2.68772038e-02  3.08961057e-01]
 [ 2.97836672e-01  8.15200525e-01]
 [ 1.81076071e-01  2.76585449e-02]
 [-8.54501765e-03 -3.05681952e-01]
 [ 6.76635861e-01 -1.48927940e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.21857477e-03 -4.53981041e-02]
 [-1.06592391e-01  9.08154711e-02]
 [ 8.64667901e-02 -3.92206402e-01]
 [ 3.62680869e-02  1.77778327e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 5.91904560e-02  1.67485815e-01]
 [-1.53123200e-01  7.64232061e-02]
 [-4.63134317e-01  9.48578327e-02]
 [ 2.30380431e-01 -9.97521873e-02]
 [-1.42011151e+00 -1.59696595e-01]
 [ 1.01971277e-01  3.27696508e-01]
 [-1.23942652e-02 -1.25138358e-01]
 [ 2.41303021e-02  7.44093864e-02]
 [-3.23577801e-02  1.67397557e-01]
 [-1.97870303e+00 -1.31758377e-02]
 [-9.04630939e-02  2.05681724e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.43878395e-01  4.56317559e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.98116797]
curr_Stock_Price:  99.89055816971636
curr_Factors:  [9.98905582e+01 4.04136075e-02]
mat_Sqrt:  [[ 2.00811347e+01  0.00000000e+00]
 [-8.04125438e-03  1.84248284e-02]]
grads:  [6.54949506e-03 1.49136220e+01]
Stock Position:  0.006549495064381443
Bond Position:  [1.32693526]


portfolio before change:  [1.97557795]
curr_Stock_Price:  99.01172729385834
curr_Factors:  [9.90117273e+01 4.17340461e-02]
mat_Sqrt:  [[ 2.02270190e+01  0.00000000e+00]
 [-8.17156495e-03  1.87234075e-02]]
grads:  [-0.01002405 -4.65348277]
Stock Position:  -0.010024051105723407
Bond Position:  [2.96807657]


portfolio before change:  [1.97300993]
curr_Stock_Price:  99.30492730436187
curr_Factors:  [9.93049273e+01 4.12558943e-02]
mat_Sqrt:  [[ 2.01703670e+01  0.00000000e+00]
 [-8.12461881e-03  1.86158404e-02]]
grads:  [ 2.55117564e-02 -3.83525165e+01]
Stock Position:  0.02551175642741304
Bond Position:  [-0.56043318]


portfolio before change:  [1.97030509]
curr_Stock_Price:  99.20165015171716
curr_Factors:  [9.92016502e+01 4.07682839e-02]
mat_Sqrt:  [[ 2.00299614e+01  0.00000000e+00]
 [-8.07646298e-03  1.85055015e-02]]
grads:  [-5.82560908e-04  4.28460726e+00]
Stock Position:  -0.0005825609081103599
Bond Position:  [2.0280961]


portfolio before change:  [1.97079067]
curr_Stock_Price:  98.80332072415335
curr_Factors:  [9.88033207e+01 4.06138311e-02]
mat_Sqrt:  [[ 1.99117083e+01  0.00000000e+00]
 [-8.06114941e-03  1.84704137e-02]]
grads:  [ 0.00129292 -1.12041338]
Stock Position:  0.0012929153464462198
Bond Position:  [1.84304634]


portfolio before change:  [1.96971589]
curr_Stock_Price:  97.79383665004364
curr_Factors:  [9.77938367e+01 4.11056839e-02]
mat_Sqrt:  [[ 1.98272473e+01  0.00000000e+00]
 [-8.10981469e-03  1.85819198e-02]]
grads:  [-0.00632252 -5.51999224]
Stock Position:  -0.006322522897962495
Bond Position:  [2.58801966]


portfolio before change:  [1.98111832]
curr_Stock_Price:  96.04154481167228
curr_Factors:  [9.60415448e+01 4.31000139e-02]
mat_Sqrt:  [[ 1.99387461e+01  0.00000000e+00]
 [-8.30421714e-03  1.90273518e-02]]
grads:  [-0.0053251   3.78531344]
Stock Position:  -0.005325102673493799
Bond Position:  [2.4925494]


portfolio before change:  [1.98374052]
curr_Stock_Price:  95.60763418602062
curr_Factors:  [9.56076342e+01 4.43322441e-02]
mat_Sqrt:  [[ 2.01304012e+01  0.00000000e+00]
 [-8.42208944e-03  1.92974312e-02]]
grads:  [ 2.19572691e-03 -8.04882680e+00]
Stock Position:  0.0021957269117246357
Bond Position:  [1.77381227]


portfolio before change:  [1.98134679]
curr_Stock_Price:  94.41647057945814
curr_Factors:  [9.44164706e+01 4.52135212e-02]
mat_Sqrt:  [[ 2.00762191e+01  0.00000000e+00]
 [-8.50538852e-03  1.94882934e-02]]
grads:  [0.0116249  8.12912925]
Stock Position:  0.011624902562072196
Bond Position:  [0.88376452]


portfolio before change:  [1.95526922]
curr_Stock_Price:  92.16371600718401
curr_Factors:  [9.21637160e+01 4.71282546e-02]
mat_Sqrt:  [[ 2.00078607e+01  0.00000000e+00]
 [-8.68361718e-03  1.98966665e-02]]
grads:  [9.69123044e-04 2.64305059e+01]
Stock Position:  0.0009691230440244697
Bond Position:  [1.86595124]


portfolio before change:  [1.95471208]
curr_Stock_Price:  91.34813485356547
curr_Factors:  [9.13481349e+01 4.78517446e-02]
mat_Sqrt:  [[ 1.99824425e+01  0.00000000e+00]
 [-8.75001665e-03  2.00488068e-02]]
grads:  [2.94939884e-02 3.90862955e+01]
Stock Position:  0.029493988429425622
Bond Position:  [-0.73950875]


portfolio before change:  [1.92749498]
curr_Stock_Price:  90.42846763983165
curr_Factors:  [9.04284676e+01 4.68660086e-02]
mat_Sqrt:  [[ 1.95764597e+01  0.00000000e+00]
 [-8.65942341e-03  1.98412316e-02]]
grads:  [1.04501190e-02 2.12549009e+01]
Stock Position:  0.010450119025993482
Bond Position:  [0.98250673]


portfolio before change:  [1.95060238]
curr_Stock_Price:  92.62792416055424
curr_Factors:  [9.26279242e+01 4.61094526e-02]
mat_Sqrt:  [[ 1.98900976e+01  0.00000000e+00]
 [-8.58924468e-03  1.96804320e-02]]
grads:  [0.0212946  1.29927432]
Stock Position:  0.021294603111458272
Bond Position:  [-0.0218725]


portfolio before change:  [1.93595388]
curr_Stock_Price:  91.9401552583596
curr_Factors:  [9.19401553e+01 4.52026654e-02]
mat_Sqrt:  [[ 1.95473215e+01  0.00000000e+00]
 [-8.50436739e-03  1.94859537e-02]]
grads:  [2.53739214e-03 8.11569226e+00]
Stock Position:  0.002537392135639894
Bond Position:  [1.70266566]


portfolio before change:  [1.93488487]
curr_Stock_Price:  91.43496866378999
curr_Factors:  [9.14349687e+01 4.51641118e-02]
mat_Sqrt:  [[ 1.94316222e+01  0.00000000e+00]
 [-8.50073990e-03  1.94776420e-02]]
grads:  [1.07431865e-02 1.28500149e+01]
Stock Position:  0.010743186523066725
Bond Position:  [0.95258195]


portfolio before change:  [1.9384489]
curr_Stock_Price:  91.75563199570128
curr_Factors:  [9.17556320e+01 4.55705491e-02]
mat_Sqrt:  [[ 1.95873129e+01  0.00000000e+00]
 [-8.53890383e-03  1.95650866e-02]]
grads:  [8.25630674e-03 1.57914485e+01]
Stock Position:  0.008256306738081089
Bond Position:  [1.18088626]


portfolio before change:  [1.92358695]
curr_Stock_Price:  89.93768005380255
curr_Factors:  [8.99376801e+01 4.52871748e-02]
mat_Sqrt:  [[ 1.91394430e+01  0.00000000e+00]
 [-8.51231342e-03  1.95041603e-02]]
grads:  [3.41503851e-02 4.17962380e+01]
Stock Position:  0.034150385089646
Bond Position:  [-1.14781946]


portfolio before change:  [1.89152874]
curr_Stock_Price:  89.00314520671728
curr_Factors:  [8.90031452e+01 4.52367192e-02]
mat_Sqrt:  [[ 1.89300127e+01  0.00000000e+00]
 [-8.50757020e-03  1.94932922e-02]]
grads:  [0.01020323 1.418875  ]
Stock Position:  0.01020322875231057
Bond Position:  [0.98340929]


portfolio before change:  [1.89798647]
curr_Stock_Price:  89.6240073455386
curr_Factors:  [8.96240073e+01 4.47796278e-02]
mat_Sqrt:  [[ 1.89655132e+01  0.00000000e+00]
 [-8.46447898e-03  1.93945578e-02]]
grads:  [-7.48493108e-03 -1.57612230e+01]
Stock Position:  -0.007484931076364203
Bond Position:  [2.56881599]


portfolio before change:  [1.89781422]
curr_Stock_Price:  89.68992288414667
curr_Factors:  [8.96899229e+01 4.34550450e-02]
mat_Sqrt:  [[ 1.86966480e+01  0.00000000e+00]
 [-8.33834948e-03  1.91055588e-02]]
grads:  [ 0.0327138  -7.79500569]
Stock Position:  0.032713798641188
Bond Position:  [-1.03628386]


portfolio before change:  [1.92444615]
curr_Stock_Price:  90.50797129634823
curr_Factors:  [9.05079713e+01 4.29562247e-02]
mat_Sqrt:  [[ 1.87585767e+01  0.00000000e+00]
 [-8.29035340e-03  1.89955860e-02]]
grads:  [ 0.00224583 -1.98877727]
Stock Position:  0.0022458319354106177
Bond Position:  [1.72118046]


portfolio before change:  [1.92593697]
curr_Stock_Price:  91.07598456652933
curr_Factors:  [9.10759846e+01 4.18477783e-02]
mat_Sqrt:  [[ 1.86311678e+01  0.00000000e+00]
 [-8.18269181e-03  1.87489023e-02]]
grads:  [-1.18253091e-03 -2.42137398e+00]
Stock Position:  -0.0011825309071553753
Bond Position:  [2.03363714]


portfolio before change:  [1.9269471]
curr_Stock_Price:  90.43675391678455
curr_Factors:  [9.04367539e+01 4.29085962e-02]
mat_Sqrt:  [[ 1.87334221e+01  0.00000000e+00]
 [-8.28575609e-03  1.89850522e-02]]
grads:  [-3.57421457e-03  4.78352495e+00]
Stock Position:  -0.0035742145711731084
Bond Position:  [2.25018747]


portfolio before change:  [1.92633109]
curr_Stock_Price:  90.68780383832554
curr_Factors:  [9.06878038e+01 4.31803841e-02]
mat_Sqrt:  [[ 1.88448262e+01  0.00000000e+00]
 [-8.31195612e-03  1.90450840e-02]]
grads:  [-4.49492696e-03 -2.05935769e+01]
Stock Position:  -0.004494926958771435
Bond Position:  [2.33396614]


portfolio before change:  [1.91910547]
curr_Stock_Price:  92.36021799975848
curr_Factors:  [9.23602180e+01 4.34588037e-02]
mat_Sqrt:  [[ 1.92541270e+01  0.00000000e+00]
 [-8.33871008e-03  1.91063851e-02]]
grads:  [5.91337689e-03 9.30465530e+00]
Stock Position:  0.005913376891770963
Bond Position:  [1.37294469]


portfolio before change:  [1.92065276]
curr_Stock_Price:  92.59285361408686
curr_Factors:  [9.25928536e+01 4.35337448e-02]
mat_Sqrt:  [[ 1.93192598e+01  0.00000000e+00]
 [-8.34589670e-03  1.91228517e-02]]
grads:  [6.49531308e-03 9.52099210e+00]
Stock Position:  0.006495313076646258
Bond Position:  [1.31923319]


portfolio before change:  [1.91716037]
curr_Stock_Price:  92.02978443775662
curr_Factors:  [9.20297844e+01 4.34235070e-02]
mat_Sqrt:  [[ 1.91774497e+01  0.00000000e+00]
 [-8.33532310e-03  1.90986245e-02]]
grads:  [6.89806312e-03 8.76952239e+00]
Stock Position:  0.006898063122891136
Bond Position:  [1.28233311]


portfolio before change:  [1.91893429]
curr_Stock_Price:  92.26370852377595
curr_Factors:  [9.22637085e+01 4.14885785e-02]
mat_Sqrt:  [[ 1.87929598e+01  0.00000000e+00]
 [-8.14749812e-03  1.86682634e-02]]
grads:  [-0.0063731   4.09375015]
Stock Position:  -0.006373098235577965
Bond Position:  [2.50693997]


portfolio before change:  [1.91923605]
curr_Stock_Price:  92.26553279307413
curr_Factors:  [9.22655328e+01 4.25302145e-02]
mat_Sqrt:  [[ 1.90277870e+01  0.00000000e+00]
 [-8.24914197e-03  1.89011587e-02]]
grads:  [-0.02216416  5.01862526]
Stock Position:  -0.02216416264758217
Bond Position:  [3.96422433]


portfolio before change:  [1.89244333]
curr_Stock_Price:  93.49672218152698
curr_Factors:  [9.34967222e+01 4.14841050e-02]
mat_Sqrt:  [[ 1.90430825e+01  0.00000000e+00]
 [-8.14705885e-03  1.86672569e-02]]
grads:  [ 0.0098117 -5.3436982]
Stock Position:  0.00981169972637469
Bond Position:  [0.97508157]


portfolio before change:  [1.88234357]
curr_Stock_Price:  92.45494033052944
curr_Factors:  [9.24549403e+01 4.13153676e-02]
mat_Sqrt:  [[ 1.87925595e+01  0.00000000e+00]
 [-8.13047281e-03  1.86292536e-02]]
grads:  [-0.07927653 -8.57235607]
Stock Position:  -0.07927652547175243
Bond Position:  [9.21185]


portfolio before change:  [1.77960267]
curr_Stock_Price:  93.76544748578591
curr_Factors:  [9.37654475e+01 4.25952868e-02]
mat_Sqrt:  [[ 1.93518997e+01  0.00000000e+00]
 [-8.25545025e-03  1.89156128e-02]]
grads:  [1.26597266e-02 1.73241285e+01]
Stock Position:  0.01265972656381401
Bond Position:  [0.59255775]


portfolio before change:  [1.78769602]
curr_Stock_Price:  94.39889549240898
curr_Factors:  [9.43988955e+01 4.20665099e-02]
mat_Sqrt:  [[ 1.93613285e+01  0.00000000e+00]
 [-8.20404875e-03  1.87978372e-02]]
grads:  [-3.46097749e-03 -6.65706149e+00]
Stock Position:  -0.003460977491291536
Bond Position:  [2.11440848]


portfolio before change:  [1.78790597]
curr_Stock_Price:  94.4146055573579
curr_Factors:  [9.44146056e+01 4.05822965e-02]
mat_Sqrt:  [[ 1.90198678e+01  0.00000000e+00]
 [-8.05801926e-03  1.84632416e-02]]
grads:  [2.97611011e-03 4.03013663e+00]
Stock Position:  0.0029761101133380847
Bond Position:  [1.50691771]


portfolio before change:  [1.78457422]
curr_Stock_Price:  93.23181275454922
curr_Factors:  [9.32318128e+01 4.15253845e-02]
mat_Sqrt:  [[ 1.89985720e+01  0.00000000e+00]
 [-8.15111129e-03  1.86765422e-02]]
grads:  [2.14229277e-03 8.96298443e+00]
Stock Position:  0.0021422927691710863
Bond Position:  [1.58484439]


portfolio before change:  [1.78301166]
curr_Stock_Price:  92.40994475236175
curr_Factors:  [9.24099448e+01 4.18580606e-02]
mat_Sqrt:  [[ 1.89063747e+01  0.00000000e+00]
 [-8.18369702e-03  1.87512055e-02]]
grads:  [-0.10496213 -0.70266616]
Stock Position:  -0.1049621341382397
Bond Position:  [11.48255668]


portfolio before change:  [1.69600978]
curr_Stock_Price:  93.25250847734509
curr_Factors:  [9.32525085e+01 3.98651018e-02]
mat_Sqrt:  [[ 1.86190262e+01  0.00000000e+00]
 [-7.98649879e-03  1.82993676e-02]]
grads:  [-3.73934701e-05  1.12398269e+01]
Stock Position:  -3.739347005977177e-05
Bond Position:  [1.69949682]


portfolio before change:  [1.69614467]
curr_Stock_Price:  95.3268412890366
curr_Factors:  [9.53268413e+01 3.86815194e-02]
mat_Sqrt:  [[ 1.87485189e+01  0.00000000e+00]
 [-7.86704716e-03  1.80256696e-02]]
grads:  [-4.70358303e-03  6.06700151e+00]
Stock Position:  -0.004703583030530972
Bond Position:  [2.14452238]


portfolio before change:  [1.68978484]
curr_Stock_Price:  96.73596024391422
curr_Factors:  [9.67359602e+01 3.98182975e-02]
mat_Sqrt:  [[ 1.93031991e+01  0.00000000e+00]
 [-7.98180907e-03  1.82886221e-02]]
grads:  [0.04382019 0.24950899]
Stock Position:  0.04382019386462407
Bond Position:  [-2.54920369]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.69360662]
Stock Price:  96.83044741662394
PL:  [1.69360662]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.60022880e-01  6.55851266e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.47502457e-01 -6.34163252e-01]
 [ 1.15918784e-02  2.52525188e-02]
 [-1.47522683e-01  6.23999674e-02]
 [ 1.91664695e-02  4.67577774e-02]
 [-1.04991220e-03  3.22170085e-01]
 [ 6.08294936e-02 -4.70272731e-02]
 [ 1.66309812e-01  9.07460179e-02]
 [ 9.69273483e-02  9.57525328e-02]
 [ 1.36923188e-01  2.58632317e-01]
 [ 1.59079348e-01  2.14660914e-01]
 [ 2.20797464e-01  2.25112179e-02]
 [-1.37795207e-01 -1.51759260e-01]
 [ 9.10233013e-02  2.34116371e-01]
 [ 4.78660208e-02  3.08771363e-02]
 [ 2.24904390e-02 -3.06476929e-02]
 [ 9.29640911e-03  5.16300812e-02]
 [ 1.55577125e-02  4.95057029e-02]
 [ 9.49651678e-02 -9.96254481e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [-4.80012704e-04  1.57687773e-01]
 [ 2.64699584e-02  1.50116051e-01]
 [-6.85041128e-02  7.24785878e-02]
 [ 4.81206846e-02  1.07328234e-01]
 [ 2.10635387e-01  1.93367348e-02]
 [ 2.47136650e-02  2.12471558e-01]
 [-2.06815491e-01  1.46742600e-01]
 [-1.20757686e-01 -7.67308460e-02]
 [ 1.24461749e-01 -7.54111265e-02]
 [-8.29838069e-01 -1.00286666e-01]
 [-1.18089526e-01  5.98533208e-03]
 [ 5.19705953e-03 -9.13130112e-02]
 [ 7.59853282e-02  9.63593588e-02]
 [-7.99074755e-02  1.56735050e-01]
 [-4.64851465e-01 -3.34367942e-01]
 [-2.49369343e-02  2.99670034e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.83104231e-01 -5.68975962e-04]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.99990781]
curr_Stock_Price:  99.29094372210989
curr_Factors:  [9.92909437e+01 3.96736482e-02]
mat_Sqrt:  [[ 1.97770134e+01  0.00000000e+00]
 [-7.96729798e-03  1.82553730e-02]]
grads:  [-0.00664404  3.59264785]
Stock Position:  -0.006644035744989451
Bond Position:  [-1.34021523]


portfolio before change:  [-2.0039136]
curr_Stock_Price:  99.86864401551729
curr_Factors:  [9.98686440e+01 4.09702648e-02]
mat_Sqrt:  [[ 2.02145249e+01  0.00000000e+00]
 [-8.09644513e-03  1.85512863e-02]]
grads:  [-0.01004151 -4.74421927]
Stock Position:  -0.010041514648511963
Bond Position:  [-1.00108115]


portfolio before change:  [-2.01725615]
curr_Stock_Price:  101.18491953743705
curr_Factors:  [1.01184920e+02 4.14883723e-02]
mat_Sqrt:  [[ 2.06100473e+01  0.00000000e+00]
 [-8.14747787e-03  1.86682170e-02]]
grads:  [ 2.28398759e-02 -3.39702100e+01]
Stock Position:  0.022839875894186925
Bond Position:  [-4.32830715]


portfolio before change:  [-1.99285669]
curr_Stock_Price:  102.27689270096285
curr_Factors:  [1.02276893e+02 4.22683445e-02]
mat_Sqrt:  [[ 2.10273791e+01  0.00000000e+00]
 [-8.22370666e-03  1.88428791e-02]]
grads:  [1.07540655e-03 1.34016244e+00]
Stock Position:  0.001075406545949051
Bond Position:  [-2.10284593]


portfolio before change:  [-1.99295165]
curr_Stock_Price:  102.43303012588696
curr_Factors:  [1.02433030e+02 4.17239935e-02]
mat_Sqrt:  [[ 2.09234336e+01  0.00000000e+00]
 [-8.17058074e-03  1.87211524e-02]]
grads:  [-0.00574901  3.33312641]
Stock Position:  -0.00574901360116061
Bond Position:  [-1.40406277]


portfolio before change:  [-1.99063009]
curr_Stock_Price:  101.99868180404425
curr_Factors:  [1.01998682e+02 4.26194719e-02]
mat_Sqrt:  [[ 2.10571015e+01  0.00000000e+00]
 [-8.25779359e-03  1.89209821e-02]]
grads:  [1.87932971e-03 2.47121302e+00]
Stock Position:  0.0018793297138770297
Bond Position:  [-2.18231925]


portfolio before change:  [-1.99312457]
curr_Stock_Price:  100.81652064129301
curr_Factors:  [1.00816521e+02 4.32088459e-02]
mat_Sqrt:  [[ 2.09564656e+01  0.00000000e+00]
 [-8.31469503e-03  1.90513597e-02]]
grads:  [6.65935959e-03 1.69106085e+01]
Stock Position:  0.0066593595904215494
Bond Position:  [-2.66449803]


portfolio before change:  [-2.00076639]
curr_Stock_Price:  99.71900707059748
curr_Factors:  [9.97190071e+01 4.28307965e-02]
mat_Sqrt:  [[ 2.06374494e+01  0.00000000e+00]
 [-8.27824102e-03  1.89678330e-02]]
grads:  [ 1.95300825e-03 -2.47931712e+00]
Stock Position:  0.0019530082538021325
Bond Position:  [-2.19551843]


portfolio before change:  [-2.00377131]
curr_Stock_Price:  98.32092587157503
curr_Factors:  [9.83209259e+01 4.45566232e-02]
mat_Sqrt:  [[ 2.07540135e+01  0.00000000e+00]
 [-8.44337593e-03  1.93462047e-02]]
grads:  [0.00992168 4.69063671]
Stock Position:  0.009921677163768655
Bond Position:  [-2.9792798]


portfolio before change:  [-2.01309914]
curr_Stock_Price:  97.41831684916144
curr_Factors:  [9.74183168e+01 4.60660328e-02]
mat_Sqrt:  [[ 2.09088924e+01  0.00000000e+00]
 [-8.58519961e-03  1.96711635e-02]]
grads:  [0.00663436 4.86765984]
Stock Position:  0.006634362879938341
Bond Position:  [-2.65940761]


portfolio before change:  [-2.01107937]
curr_Stock_Price:  97.77286680386085
curr_Factors:  [9.77728668e+01 4.57727894e-02]
mat_Sqrt:  [[ 2.09180906e+01  0.00000000e+00]
 [-8.55783051e-03  1.96084531e-02]]
grads:  [1.19417967e-02 1.31898379e+01]
Stock Position:  0.011941796698545079
Bond Position:  [-3.17866307]


portfolio before change:  [-2.01049978]
curr_Stock_Price:  97.85467632011743
curr_Factors:  [9.78546763e+01 4.70465265e-02]
mat_Sqrt:  [[ 2.12248860e+01  0.00000000e+00]
 [-8.67608451e-03  1.98794070e-02]]
grads:  [ 0.0119089  10.79815478]
Stock Position:  0.011908900306271111
Bond Position:  [-3.17584136]


portfolio before change:  [-2.0259547]
curr_Stock_Price:  96.59025055544596
curr_Factors:  [9.65902506e+01 4.60741190e-02]
mat_Sqrt:  [[ 2.07329840e+01  0.00000000e+00]
 [-8.58595309e-03  1.96728900e-02]]
grads:  [0.01112344 1.14427611]
Stock Position:  0.01112344294883102
Bond Position:  [-3.10037085]


portfolio before change:  [-2.02461953]
curr_Stock_Price:  96.74512557853755
curr_Factors:  [9.67451256e+01 4.56695922e-02]
mat_Sqrt:  [[ 2.06748639e+01  0.00000000e+00]
 [-8.54817803e-03  1.95863364e-02]]
grads:  [-0.00986843 -7.74822081]
Stock Position:  -0.009868426652646202
Bond Position:  [-1.06989736]


portfolio before change:  [-2.02628859]
curr_Stock_Price:  96.90070392634253
curr_Factors:  [9.69007039e+01 4.31735900e-02]
mat_Sqrt:  [[ 2.01342758e+01  0.00000000e+00]
 [-8.31130219e-03  1.90435857e-02]]
grads:  [9.59558041e-03 1.22937127e+01]
Stock Position:  0.009595580406223126
Bond Position:  [-2.95610709]


portfolio before change:  [-2.02443185]
curr_Stock_Price:  97.13271445627636
curr_Factors:  [9.71327145e+01 4.36984752e-02]
mat_Sqrt:  [[ 2.03047977e+01  0.00000000e+00]
 [-8.36167210e-03  1.91589977e-02]]
grads:  [0.00302105 1.61162587]
Stock Position:  0.0030210548635488895
Bond Position:  [-2.31787511]


portfolio before change:  [-2.02477578]
curr_Stock_Price:  97.11478274452989
curr_Factors:  [9.71147827e+01 4.31295889e-02]
mat_Sqrt:  [[ 2.01684723e+01  0.00000000e+00]
 [-8.30706580e-03  1.90338789e-02]]
grads:  [ 4.51927598e-04 -1.61016538e+00]
Stock Position:  0.00045192759820545454
Bond Position:  [-2.06866463]


portfolio before change:  [-2.02460836]
curr_Stock_Price:  98.05744536372616
curr_Factors:  [9.80574454e+01 4.39854232e-02]
mat_Sqrt:  [[ 2.05652959e+01  0.00000000e+00]
 [-8.38908083e-03  1.92217990e-02]]
grads:  [1.54773479e-03 2.68601713e+00]
Stock Position:  0.001547734789484711
Bond Position:  [-2.17637528]


portfolio before change:  [-2.02429441]
curr_Stock_Price:  98.43607352577513
curr_Factors:  [9.84360735e+01 4.27608366e-02]
mat_Sqrt:  [[ 2.03552940e+01  0.00000000e+00]
 [-8.27147741e-03  1.89523357e-02]]
grads:  [1.82575465e-03 2.61211619e+00]
Stock Position:  0.0018257546470079112
Bond Position:  [-2.20401453]


portfolio before change:  [-2.02503517]
curr_Stock_Price:  98.18125423685947
curr_Factors:  [9.81812542e+01 4.25014511e-02]
mat_Sqrt:  [[ 2.02409296e+01  0.00000000e+00]
 [-8.24635203e-03  1.88947662e-02]]
grads:  [ 2.54361132e-03 -5.27264784e+00]
Stock Position:  0.002543611316850583
Bond Position:  [-2.27477011]


portfolio before change:  [-2.02934233]
curr_Stock_Price:  96.59972208421848
curr_Factors:  [9.65997221e+01 4.19860398e-02]
mat_Sqrt:  [[ 1.97937615e+01  0.00000000e+00]
 [-8.19619813e-03  1.87798492e-02]]
grads:  [ 0.00212838 -2.0116237 ]
Stock Position:  0.0021283782044638705
Bond Position:  [-2.23494308]


portfolio before change:  [-2.03242839]
curr_Stock_Price:  95.28103150180912
curr_Factors:  [9.52810315e+01 4.20166520e-02]
mat_Sqrt:  [[ 1.95306713e+01  0.00000000e+00]
 [-8.19918552e-03  1.87866941e-02]]
grads:  [3.49914103e-03 8.39358811e+00]
Stock Position:  0.0034991410285268093
Bond Position:  [-2.36583016]


portfolio before change:  [-2.02884777]
curr_Stock_Price:  96.38883792544449
curr_Factors:  [9.63888379e+01 4.20172666e-02]
mat_Sqrt:  [[ 1.97578936e+01  0.00000000e+00]
 [-8.19924549e-03  1.87868316e-02]]
grads:  [4.65565692e-03 7.99049324e+00]
Stock Position:  0.004655656915867568
Bond Position:  [-2.47760113]


portfolio before change:  [-2.0300953]
curr_Stock_Price:  96.1874022178285
curr_Factors:  [9.61874022e+01 4.31714475e-02]
mat_Sqrt:  [[ 1.99855682e+01  0.00000000e+00]
 [-8.31109596e-03  1.90431132e-02]]
grads:  [-1.84492446e-03  3.80602621e+00]
Stock Position:  -0.0018449244612001774
Bond Position:  [-1.85263681]


portfolio before change:  [-2.03194368]
curr_Stock_Price:  97.06374170005726
curr_Factors:  [9.70637417e+01 4.24251413e-02]
mat_Sqrt:  [[ 1.99925724e+01  0.00000000e+00]
 [-8.23894569e-03  1.88777961e-02]]
grads:  [4.74989232e-03 5.68542182e+00]
Stock Position:  0.00474989232438515
Bond Position:  [-2.492986]


portfolio before change:  [-2.03122252]
curr_Stock_Price:  97.28117712757088
curr_Factors:  [9.72811771e+01 4.23395035e-02]
mat_Sqrt:  [[ 2.00171248e+01  0.00000000e+00]
 [-8.23062608e-03  1.88587335e-02]]
grads:  [0.01094436 1.02534642]
Stock Position:  0.010944360455461094
Bond Position:  [-3.09590279]


portfolio before change:  [-2.02763398]
curr_Stock_Price:  97.64442910415977
curr_Factors:  [9.76444291e+01 4.24820924e-02]
mat_Sqrt:  [[ 2.01256734e+01  0.00000000e+00]
 [-8.24447377e-03  1.88904626e-02]]
grads:  [5.83552426e-03 1.12475572e+01]
Stock Position:  0.005835524255008576
Bond Position:  [-2.59744041]


portfolio before change:  [-2.01989656]
curr_Stock_Price:  99.02598713270957
curr_Factors:  [9.90259871e+01 4.28465682e-02]
mat_Sqrt:  [[ 2.04977977e+01  0.00000000e+00]
 [-8.27976504e-03  1.89713250e-02]]
grads:  [-6.96522487e-03  7.73496843e+00]
Stock Position:  -0.006965224866179856
Bond Position:  [-1.33015829]


portfolio before change:  [-2.0100292]
curr_Stock_Price:  97.58545316206462
curr_Factors:  [9.75854532e+01 4.28914890e-02]
mat_Sqrt:  [[ 2.02102016e+01  0.00000000e+00]
 [-8.28410420e-03  1.89812673e-02]]
grads:  [-0.00763207 -4.04245116]
Stock Position:  -0.007632074943435413
Bond Position:  [-1.26524971]


portfolio before change:  [-2.00426878]
curr_Stock_Price:  96.8099649563739
curr_Factors:  [9.6809965e+01 4.4532611e-02]
mat_Sqrt:  [[ 2.04295661e+01  0.00000000e+00]
 [-8.44110050e-03  1.93409910e-02]]
grads:  [ 0.00448123 -3.89903116]
Stock Position:  0.004481232475697107
Bond Position:  [-2.43809674]


portfolio before change:  [-1.99805572]
curr_Stock_Price:  98.26444098896651
curr_Factors:  [9.82644410e+01 4.42246394e-02]
mat_Sqrt:  [[ 2.06646730e+01  0.00000000e+00]
 [-8.41186204e-03  1.92739973e-02]]
grads:  [-0.04227537 -5.20321057]
Stock Position:  -0.04227537290697601
Bond Position:  [2.15611017]


portfolio before change:  [-2.0577474]
curr_Stock_Price:  99.68278947296969
curr_Factors:  [9.96827895e+01 4.39462653e-02]
mat_Sqrt:  [[ 2.08968665e+01  0.00000000e+00]
 [-8.38534581e-03  1.92132410e-02]]
grads:  [-0.00552606  0.31152121]
Stock Position:  -0.005526058799728473
Bond Position:  [-1.50689444]


portfolio before change:  [-2.0511858]
curr_Stock_Price:  98.46131027427344
curr_Factors:  [9.84613103e+01 4.59186786e-02]
mat_Sqrt:  [[ 2.10989237e+01  0.00000000e+00]
 [-8.57145762e-03  1.96396767e-02]]
grads:  [-1.64251060e-03 -4.64941519e+00]
Stock Position:  -0.001642510596125691
Bond Position:  [-1.88946206]


portfolio before change:  [-2.04915562]
curr_Stock_Price:  97.08148169449699
curr_Factors:  [9.70814817e+01 4.73252466e-02]
mat_Sqrt:  [[ 2.11194614e+01  0.00000000e+00]
 [-8.70174664e-03  1.99382063e-02]]
grads:  [0.00558916 4.83290007]
Stock Position:  0.005589157686313257
Bond Position:  [-2.59175933]


portfolio before change:  [-2.04826233]
curr_Stock_Price:  97.29927437998066
curr_Factors:  [9.72992744e+01 4.72441334e-02]
mat_Sqrt:  [[ 2.11486936e+01  0.00000000e+00]
 [-8.69428625e-03  1.99211124e-02]]
grads:  [-5.43896089e-04  7.86778602e+00]
Stock Position:  -0.000543896088523784
Bond Position:  [-1.99534164]


portfolio before change:  [-2.0495835]
curr_Stock_Price:  99.26974876250381
curr_Factors:  [9.92697488e+01 4.61227227e-02]
mat_Sqrt:  [[ 2.13193712e+01  0.00000000e+00]
 [-8.59048057e-03  1.96832637e-02]]
grads:  [ -0.02864914 -16.98742376]
Stock Position:  -0.028649137587022727
Bond Position:  [0.79440919]


portfolio before change:  [-1.99301978]
curr_Stock_Price:  97.29885494562009
curr_Factors:  [9.72988549e+01 4.63846610e-02]
mat_Sqrt:  [[ 2.09553502e+01  0.00000000e+00]
 [-8.61483938e-03  1.97390768e-02]]
grads:  [5.05120601e-03 1.51815628e+01]
Stock Position:  0.005051206005745802
Bond Position:  [-2.48449634]


portfolio before change:  [-1.98989288]
curr_Stock_Price:  97.97938159570488
curr_Factors:  [9.79793816e+01 4.70461290e-02]
mat_Sqrt:  [[ 2.12518451e+01  0.00000000e+00]
 [-8.67604786e-03  1.98793230e-02]]
grads:  [-4.14953219e-03  5.50128212e+00]
Stock Position:  -0.004149532189681871
Bond Position:  [-1.58332428]


portfolio before change:  [-1.98337033]
curr_Stock_Price:  96.35980722075435
curr_Factors:  [9.63598072e+01 4.75356277e-02]
mat_Sqrt:  [[ 2.10090076e+01  0.00000000e+00]
 [-8.72106670e-03  1.99824741e-02]]
grads:  [ 0.04202273 -0.02847375]
Stock Position:  0.042022732562123494
Bond Position:  [-6.03267274]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.03394907]
Stock Price:  95.17414891933068
PL:  [-2.03394907]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.34916461e-01  4.27312277e-01]
 [-1.77835105e-01 -7.79226179e-02]
 [ 7.81181996e-01 -6.57073497e-01]
 [ 5.08872129e-02  2.13215820e-02]
 [-1.67495697e-01  7.03933645e-02]
 [ 2.95341984e-03  3.26518243e-02]
 [ 9.32098808e-03  3.09043218e-01]
 [ 2.71018388e-01 -2.11404228e-03]
 [ 1.16567480e-01  8.58626186e-02]
 [ 3.28381345e-01 -1.57050332e-01]
 [ 6.39258047e-02  1.83512625e-04]
 [-1.50883462e-01 -1.36561707e-01]
 [-1.68923531e-01  1.58403172e-01]
 [-3.88855110e-01 -5.12236771e-01]
 [ 8.52648952e-02  2.29519011e-01]
 [ 4.94631798e-02  9.70661473e-03]
 [ 2.34893559e-02 -1.86154737e-02]
 [ 3.32931701e-02  5.57096635e-02]
 [ 1.01636104e-02  4.91369408e-02]
 [ 2.95654878e-01 -1.12464636e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 3.29372751e-02  2.07544112e-01]
 [ 3.25364565e-02  1.84817435e-01]
 [-7.25520012e-02  8.02714593e-02]
 [ 6.04740850e-02  1.30316739e-01]
 [ 4.57871055e-02  1.35802753e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.66503096e-01  1.06803613e-01]
 [-1.73292342e-01 -5.03064294e-02]
 [ 1.27166108e-01 -7.60441540e-02]
 [-1.05313650e+00 -1.18922001e-01]
 [-7.53583554e-02  1.28494855e-01]
 [-9.57426165e-03 -1.22005411e-01]
 [ 4.74324437e-02  8.66647523e-02]
 [-6.30835212e-02  1.61622518e-01]
 [-1.11084871e+00 -1.90408660e-01]
 [-3.26713896e-02  2.90273781e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 4.88479657e-01  4.51449212e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.91306195]
curr_Stock_Price:  100.33214885620711
curr_Factors:  [1.00332149e+02 3.95987567e-02]
mat_Sqrt:  [[ 1.99655321e+01  0.00000000e+00]
 [-7.95977454e-03  1.82381347e-02]]
grads:  [1.60982851e-02 2.34296042e+01]
Stock Position:  0.016098285107546715
Bond Position:  [3.29788641]


portfolio before change:  [4.91602268]
curr_Stock_Price:  100.49045590220818
curr_Factors:  [1.00490456e+02 3.96890221e-02]
mat_Sqrt:  [[ 2.00198130e+01  0.00000000e+00]
 [-7.96884153e-03  1.82589098e-02]]
grads:  [-0.01058168 -4.26764899]
Stock Position:  -0.01058168345515479
Bond Position:  [5.97938088]


portfolio before change:  [4.90479324]
curr_Stock_Price:  101.62230896208766
curr_Factors:  [1.01622309e+02 4.03127642e-02]
mat_Sqrt:  [[ 2.04037666e+01  0.00000000e+00]
 [-8.03121552e-03  1.84018265e-02]]
grads:  [ 2.42313893e-02 -3.57069716e+01]
Stock Position:  0.024231389267038057
Bond Position:  [2.44234351]


portfolio before change:  [4.90389399]
curr_Stock_Price:  101.57259800463741
curr_Factors:  [1.01572598e+02 3.92699540e-02]
mat_Sqrt:  [[ 2.01282843e+01  0.00000000e+00]
 [-7.92665922e-03  1.81622579e-02]]
grads:  [0.00299045 1.17394996]
Stock Position:  0.002990454299050521
Bond Position:  [4.60014577]


portfolio before change:  [4.90898295]
curr_Stock_Price:  103.08203745425887
curr_Factors:  [1.03082037e+02 3.91950809e-02]
mat_Sqrt:  [[ 2.04079216e+01  0.00000000e+00]
 [-7.91909903e-03  1.81449354e-02]]
grads:  [-0.00670198  3.87950484]
Stock Position:  -0.0067019815431586215
Bond Position:  [5.59983686]


portfolio before change:  [4.91803324]
curr_Stock_Price:  101.83609732317986
curr_Factors:  [1.01836097e+02 4.12061792e-02]
mat_Sqrt:  [[ 2.06720202e+01  0.00000000e+00]
 [-8.11972209e-03  1.86046205e-02]]
grads:  [8.32228495e-04 1.75503845e+00]
Stock Position:  0.0008322284947355911
Bond Position:  [4.83328234]


portfolio before change:  [4.91821205]
curr_Stock_Price:  101.32495416414974
curr_Factors:  [1.01324954e+02 4.13825594e-02]
mat_Sqrt:  [[ 2.06122352e+01  0.00000000e+00]
 [-8.13708148e-03  1.86443959e-02]]
grads:  [6.99577241e-03 1.65756627e+01]
Stock Position:  0.006995772408113647
Bond Position:  [4.20936573]


portfolio before change:  [4.92307301]
curr_Stock_Price:  101.94457933786266
curr_Factors:  [1.01944579e+02 4.05861403e-02]
mat_Sqrt:  [[ 2.05377572e+01  0.00000000e+00]
 [-8.05840086e-03  1.84641160e-02]]
grads:  [ 0.01315118 -0.11449464]
Stock Position:  0.01315118014609065
Bond Position:  [3.58238148]


portfolio before change:  [4.92090354]
curr_Stock_Price:  101.74556333816652
curr_Factors:  [1.01745563e+02 4.03345221e-02]
mat_Sqrt:  [[ 2.04340259e+01  0.00000000e+00]
 [-8.03338256e-03  1.84067918e-02]]
grads:  [0.00753846 4.66472481]
Stock Position:  0.007538455732458894
Bond Position:  [4.15389912]


portfolio before change:  [4.9187002]
curr_Stock_Price:  101.38440039291096
curr_Factors:  [1.01384400e+02 4.26034928e-02]
mat_Sqrt:  [[ 2.09263623e+01  0.00000000e+00]
 [-8.25624542e-03  1.89174348e-02]]
grads:  [ 0.01241682 -8.30188307]
Stock Position:  0.012416824153018844
Bond Position:  [3.65982793]


portfolio before change:  [4.9270097]
curr_Stock_Price:  102.01676776916088
curr_Factors:  [1.02016768e+02 4.25798126e-02]
mat_Sqrt:  [[ 2.10510340e+01  0.00000000e+00]
 [-8.25395058e-03  1.89121766e-02]]
grads:  [0.00304051 0.00970341]
Stock Position:  0.0030405108032665806
Bond Position:  [4.61682662]


portfolio before change:  [4.92548172]
curr_Stock_Price:  101.32440987420395
curr_Factors:  [1.01324410e+02 4.29992076e-02]
mat_Sqrt:  [[ 2.10108832e+01  0.00000000e+00]
 [-8.29450012e-03  1.90050873e-02]]
grads:  [-0.01001785 -7.1855343 ]
Stock Position:  -0.010017850017235536
Bond Position:  [5.94053446]


portfolio before change:  [4.92185775]
curr_Stock_Price:  101.7602899189434
curr_Factors:  [1.01760290e+02 4.09422415e-02]
mat_Sqrt:  [[ 2.05903696e+01  0.00000000e+00]
 [-8.09367570e-03  1.85449408e-02]]
grads:  [-4.84647537e-03  8.54158412e+00]
Stock Position:  -0.004846475365966511
Bond Position:  [5.41503649]


portfolio before change:  [4.92975888]
curr_Stock_Price:  100.26967894615741
curr_Factors:  [1.00269679e+02 4.16934808e-02]
mat_Sqrt:  [[ 2.04740472e+01  0.00000000e+00]
 [-8.16759262e-03  1.87143057e-02]]
grads:  [ -0.0299117  -27.37140124]
Stock Position:  -0.02991170027449387
Bond Position:  [7.92899547]


portfolio before change:  [4.98556656]
curr_Stock_Price:  98.43706855873256
curr_Factors:  [9.84370686e+01 4.22283172e-02]
mat_Sqrt:  [[ 2.02283547e+01  0.00000000e+00]
 [-8.21981189e-03  1.88339551e-02]]
grads:  [9.16709278e-03 1.21864478e+01]
Stock Position:  0.009167092776159928
Bond Position:  [4.08318482]


portfolio before change:  [4.97787859]
curr_Stock_Price:  97.54273911590887
curr_Factors:  [9.75427391e+01 4.41914722e-02]
mat_Sqrt:  [[ 2.05052081e+01  0.00000000e+00]
 [-8.40870713e-03  1.92667684e-02]]
grads:  [0.00261882 0.50380087]
Stock Position:  0.00261882217420036
Bond Position:  [4.7224315]


portfolio before change:  [4.97702062]
curr_Stock_Price:  96.98969822179293
curr_Factors:  [9.69896982e+01 4.38587957e-02]
mat_Sqrt:  [[ 2.03120595e+01  0.00000000e+00]
 [-8.37699666e-03  1.91941107e-02]]
grads:  [ 7.56442109e-04 -9.69853411e-01]
Stock Position:  0.0007564421088033002
Bond Position:  [4.90365353]


portfolio before change:  [4.9780169]
curr_Stock_Price:  97.49640047270914
curr_Factors:  [9.74964005e+01 4.41445227e-02]
mat_Sqrt:  [[ 2.04845767e+01  0.00000000e+00]
 [-8.40423918e-03  1.92565311e-02]]
grads:  [2.81220654e-03 2.89302695e+00]
Stock Position:  0.002812206537950896
Bond Position:  [4.70383689]


portfolio before change:  [4.97629605]
curr_Stock_Price:  96.67538454669321
curr_Factors:  [9.66753845e+01 4.44610106e-02]
mat_Sqrt:  [[ 2.03847586e+01  0.00000000e+00]
 [-8.43431188e-03  1.93254363e-02]]
grads:  [1.55060602e-03 2.54260447e+00]
Stock Position:  0.0015506060232758606
Bond Position:  [4.82639062]


portfolio before change:  [4.97463018]
curr_Stock_Price:  95.21195121061847
curr_Factors:  [9.52119512e+01 4.62471735e-02]
mat_Sqrt:  [[ 2.04754786e+01  0.00000000e+00]
 [-8.60206240e-03  1.97098010e-02]]
grads:  [ 0.01204227 -5.70602593]
Stock Position:  0.012042272188052294
Bond Position:  [3.82806195]


portfolio before change:  [4.98779673]
curr_Stock_Price:  96.26557382751663
curr_Factors:  [9.62655738e+01 4.47204117e-02]
mat_Sqrt:  [[ 2.03574746e+01  0.00000000e+00]
 [-8.45888047e-03  1.93817300e-02]]
grads:  [ 0.00206944 -1.94915467]
Stock Position:  0.002069441889662043
Bond Position:  [4.78858072]


portfolio before change:  [4.98900792]
curr_Stock_Price:  96.56158786239783
curr_Factors:  [9.65615879e+01 4.17585172e-02]
mat_Sqrt:  [[ 1.97322647e+01  0.00000000e+00]
 [-8.17396033e-03  1.87288960e-02]]
grads:  [6.25964396e-03 1.10814921e+01]
Stock Position:  0.00625964396259891
Bond Position:  [4.38456676]


portfolio before change:  [4.99181447]
curr_Stock_Price:  96.92238224905871
curr_Factors:  [9.69223822e+01 4.31754740e-02]
mat_Sqrt:  [[ 2.01392196e+01  0.00000000e+00]
 [-8.31148352e-03  1.90440012e-02]]
grads:  [5.62074401e-03 9.70475861e+00]
Stock Position:  0.005620744005890008
Bond Position:  [4.44703857]


portfolio before change:  [4.98898218]
curr_Stock_Price:  96.31957829271298
curr_Factors:  [9.63195783e+01 4.22281293e-02]
mat_Sqrt:  [[ 1.97931763e+01  0.00000000e+00]
 [-8.21979360e-03  1.88339132e-02]]
grads:  [-1.89553529e-03  4.26207015e+00]
Stock Position:  -0.0018955352920817215
Bond Position:  [5.17155934]


portfolio before change:  [4.98988899]
curr_Stock_Price:  96.18224457163205
curr_Factors:  [9.61822446e+01 4.17335477e-02]
mat_Sqrt:  [[ 1.96488691e+01  0.00000000e+00]
 [-8.17151616e-03  1.87232957e-02]]
grads:  [5.97230160e-03 6.96013892e+00]
Stock Position:  0.005972301601023207
Bond Position:  [4.41545961]


portfolio before change:  [4.98430757]
curr_Stock_Price:  95.15527320357117
curr_Factors:  [9.51552732e+01 4.09700092e-02]
mat_Sqrt:  [[ 1.92604261e+01  0.00000000e+00]
 [-8.09641987e-03  1.85512285e-02]]
grads:  [5.45451514e-03 7.32041833e+00]
Stock Position:  0.005454515140132282
Bond Position:  [4.46528169]


portfolio before change:  [4.98685417]
curr_Stock_Price:  95.51981626607918
curr_Factors:  [9.55198163e+01 4.24248563e-02]
mat_Sqrt:  [[ 1.96744984e+01  0.00000000e+00]
 [-8.23891802e-03  1.88777327e-02]]
grads:  [9.05545833e-03 9.26686467e+00]
Stock Position:  0.009055458334683733
Bond Position:  [4.12187846]


portfolio before change:  [4.98389396]
curr_Stock_Price:  95.13601694990105
curr_Factors:  [9.51360169e+01 4.09863163e-02]
mat_Sqrt:  [[ 1.92603604e+01  0.00000000e+00]
 [-8.09803100e-03  1.85549200e-02]]
grads:  [-0.00622471  5.75608046]
Stock Position:  -0.006224711028480019
Bond Position:  [5.57608817]


portfolio before change:  [4.97442716]
curr_Stock_Price:  96.76884074542849
curr_Factors:  [9.67688407e+01 4.05015103e-02]
mat_Sqrt:  [[ 1.94747166e+01  0.00000000e+00]
 [-8.04999481e-03  1.84448553e-02]]
grads:  [-0.01002571 -2.72739626]
Stock Position:  -0.010025710309691349
Bond Position:  [5.94460352]


portfolio before change:  [4.97537772]
curr_Stock_Price:  96.74814993955255
curr_Factors:  [9.67481499e+01 3.92505410e-02]
mat_Sqrt:  [[ 1.91675009e+01  0.00000000e+00]
 [-7.92469971e-03  1.81577681e-02]]
grads:  [ 0.00490297 -4.18796811]
Stock Position:  0.004902971895568469
Bond Position:  [4.50102426]


portfolio before change:  [4.97259825]
curr_Stock_Price:  96.06649634664487
curr_Factors:  [9.60664963e+01 3.94230486e-02]
mat_Sqrt:  [[ 1.90742317e+01  0.00000000e+00]
 [-7.94209530e-03  1.81976265e-02]]
grads:  [-0.05793357 -6.53502816]
Stock Position:  -0.05793356866261268
Bond Position:  [10.53807322]


portfolio before change:  [4.98472052]
curr_Stock_Price:  95.87999088801656
curr_Factors:  [9.58799909e+01 3.91832372e-02]
mat_Sqrt:  [[ 1.89792104e+01  0.00000000e+00]
 [-7.91790247e-03  1.81421937e-02]]
grads:  [-1.01577478e-03  7.08265256e+00]
Stock Position:  -0.00101577477941164
Bond Position:  [5.082113]


portfolio before change:  [4.98580144]
curr_Stock_Price:  95.44130081272822
curr_Factors:  [9.54413008e+01 4.02638691e-02]
mat_Sqrt:  [[ 1.91511167e+01  0.00000000e+00]
 [-8.02634353e-03  1.83906634e-02]]
grads:  [-3.28031987e-03 -6.63409517e+00]
Stock Position:  -0.0032803198666467677
Bond Position:  [5.29887943]


portfolio before change:  [4.98522913]
curr_Stock_Price:  95.81769846113983
curr_Factors:  [9.58176985e+01 4.01251625e-02]
mat_Sqrt:  [[ 1.91934982e+01  0.00000000e+00]
 [-8.01250648e-03  1.83589587e-02]]
grads:  [4.44192307e-03 4.72057014e+00]
Stock Position:  0.004441923066401046
Bond Position:  [4.55961429]


portfolio before change:  [4.98668306]
curr_Stock_Price:  96.01669826049063
curr_Factors:  [9.60166983e+01 4.07611739e-02]
mat_Sqrt:  [[ 1.93851921e+01  0.00000000e+00]
 [-8.07575868e-03  1.85038877e-02]]
grads:  [3.84537259e-04 8.73451680e+00]
Stock Position:  0.00038453725867436904
Bond Position:  [4.94976107]


portfolio before change:  [4.98741778]
curr_Stock_Price:  96.31825320099915
curr_Factors:  [9.63182532e+01 3.91789010e-02]
mat_Sqrt:  [[ 1.90649084e+01  0.00000000e+00]
 [-7.91746434e-03  1.81411898e-02]]
grads:  [ -0.06262552 -10.49593011]
Stock Position:  -0.06262552323892487
Bond Position:  [11.01939879]


portfolio before change:  [4.95589965]
curr_Stock_Price:  96.84352850140623
curr_Factors:  [9.68435285e+01 3.98250895e-02]
mat_Sqrt:  [[ 1.93263119e+01  0.00000000e+00]
 [-7.98248978e-03  1.82901818e-02]]
grads:  [4.86458434e-03 1.58704699e+01]
Stock Position:  0.004864584344168209
Bond Position:  [4.48479614]


portfolio before change:  [4.96158503]
curr_Stock_Price:  97.89700918233001
curr_Factors:  [9.78970092e+01 3.92312645e-02]
mat_Sqrt:  [[ 1.93903468e+01  0.00000000e+00]
 [-7.92275352e-03  1.81533088e-02]]
grads:  [-4.54789262e-03  6.02434329e+00]
Stock Position:  -0.004547892622068329
Bond Position:  [5.40681012]


portfolio before change:  [4.9563122]
curr_Stock_Price:  99.2050272654959
curr_Factors:  [9.92050273e+01 3.82810869e-02]
mat_Sqrt:  [[ 1.94100123e+01  0.00000000e+00]
 [-7.82622125e-03  1.79321257e-02]]
grads:  [0.02618146 2.51754433]
Stock Position:  0.026181462796819474
Bond Position:  [2.35897947]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.93602488]
Stock Price:  98.41889045408418
PL:  [4.93602488]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.53335172e-01 -1.58783890e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.07677641e-01 -6.81398572e-01]
 [-4.17589080e-02  1.00410774e-01]
 [ 3.69064862e-02 -2.53043995e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-3.97330580e-02  2.08046869e-01]
 [ 2.61647992e-01 -2.12226145e-03]
 [ 1.07693166e-02  5.94082363e-02]
 [ 4.81705103e-01 -3.29509470e-01]
 [ 5.93530168e-02 -1.56055539e-02]
 [-8.45181116e-02 -1.72802487e-01]
 [-1.71572043e-01  1.54541516e-01]
 [-6.72745425e-01 -8.90415021e-01]
 [-2.04329039e-02 -2.09942856e-01]
 [ 3.11997842e-02 -1.17713770e-01]
 [-5.31781798e-02  2.82325778e-01]
 [ 7.44831760e-02  1.48170316e-01]
 [ 1.48134735e-02  6.79852699e-02]
 [-9.94887543e-02 -3.69763906e-02]
 [ 2.10483163e-01  3.69751756e-01]
 [ 1.60835612e-02  1.29728391e-01]
 [-1.42281084e-02 -3.66419538e-01]
 [ 1.39122821e-01  2.05149531e-01]
 [ 7.97668167e-02  1.66218680e-01]
 [ 7.97934332e-01 -6.86759538e-01]
 [-6.79616160e-01  8.39259219e-01]
 [ 1.05449911e-01 -1.35990718e-02]
 [-5.46419936e-02 -5.46716070e-02]
 [ 1.08891979e-01 -1.39709068e-01]
 [ 5.64750639e-02 -8.31592062e-02]
 [ 2.96166292e-01 -2.68359151e-02]
 [ 3.19251874e-01  4.19120836e-01]
 [ 2.67158529e-01  6.85927586e-03]
 [-1.11646342e-01 -2.71344252e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-3.92571488e-01  4.53041789e-02]
 [-1.07319566e-01  8.15003200e-02]
 [-3.34146190e-01  1.76027706e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.17709101]
curr_Stock_Price:  98.66179232182077
curr_Factors:  [9.86617923e+01 3.99314573e-02]
mat_Sqrt:  [[ 1.97154449e+01  0.00000000e+00]
 [-7.99314279e-03  1.83145909e-02]]
grads:  [-0.0214367  -8.66980272]
Stock Position:  -0.021436703382986092
Bond Position:  [-4.06210743]


portfolio before change:  [-6.18316956]
curr_Stock_Price:  98.92166212364415
curr_Factors:  [9.89216621e+01 3.86811064e-02]
mat_Sqrt:  [[ 1.94554307e+01  0.00000000e+00]
 [-7.86700516e-03  1.80255733e-02]]
grads:  [-0.01043331 -4.88258368]
Stock Position:  -0.010433305309181903
Bond Position:  [-5.15108966]


portfolio before change:  [-6.19505967]
curr_Stock_Price:  99.99957428610692
curr_Factors:  [9.99995743e+01 3.70814710e-02]
mat_Sqrt:  [[ 1.92564678e+01  0.00000000e+00]
 [-7.70261992e-03  1.76489194e-02]]
grads:  [ 2.64997157e-02 -3.86085151e+01]
Stock Position:  0.026499715740347665
Bond Position:  [-8.84501996]


portfolio before change:  [-6.22544679]
curr_Stock_Price:  98.89460296757592
curr_Factors:  [9.88946030e+01 3.72156609e-02]
mat_Sqrt:  [[ 1.90781149e+01  0.00000000e+00]
 [-7.71654440e-03  1.76808244e-02]]
grads:  [1.08183977e-04 5.67907759e+00]
Stock Position:  0.00010818397675880654
Bond Position:  [-6.23614561]


portfolio before change:  [-6.22624611]
curr_Stock_Price:  98.71204231078313
curr_Factors:  [9.87120423e+01 3.75425852e-02]
mat_Sqrt:  [[ 1.91263555e+01  0.00000000e+00]
 [-7.75036362e-03  1.77583140e-02]]
grads:  [ 1.35220433e-03 -1.42493255e+00]
Stock Position:  0.0013522043314089743
Bond Position:  [-6.35972496]


portfolio before change:  [-6.2259856]
curr_Stock_Price:  99.49264183020149
curr_Factors:  [9.94926418e+01 3.81310804e-02]
mat_Sqrt:  [[ 1.94281084e+01  0.00000000e+00]
 [-7.81087246e-03  1.78969571e-02]]
grads:  [-0.00609533 -3.70548622]
Stock Position:  -0.006095332043642142
Bond Position:  [-5.61954491]


portfolio before change:  [-6.22430743]
curr_Stock_Price:  99.10207174507802
curr_Factors:  [9.91020717e+01 3.89226642e-02]
mat_Sqrt:  [[ 1.95516770e+01  0.00000000e+00]
 [-7.89153108e-03  1.80817693e-02]]
grads:  [2.61184960e-03 1.15058912e+01]
Stock Position:  0.002611849598153222
Bond Position:  [-6.48314714]


portfolio before change:  [-6.21808774]
curr_Stock_Price:  101.79370071796323
curr_Factors:  [1.01793701e+02 3.69233654e-02]
mat_Sqrt:  [[ 1.95601212e+01  0.00000000e+00]
 [-7.68618141e-03  1.76112540e-02]]
grads:  [ 0.01332925 -0.12050598]
Stock Position:  0.013329250756855104
Bond Position:  [-7.57492151]


portfolio before change:  [-6.19965036]
curr_Stock_Price:  103.24796927657528
curr_Factors:  [1.03247969e+02 3.63942685e-02]
mat_Sqrt:  [[ 1.96969062e+01  0.00000000e+00]
 [-7.63091276e-03  1.74846177e-02]]
grads:  [1.86309445e-03 3.39774294e+00]
Stock Position:  0.0018630944497950211
Bond Position:  [-6.39201108]


portfolio before change:  [-6.19975734]
curr_Stock_Price:  103.61942960539754
curr_Factors:  [1.0361943e+02 3.5860893e-02]
mat_Sqrt:  [[ 1.96223830e+01  0.00000000e+00]
 [-7.57478903e-03  1.73560220e-02]]
grads:  [ 1.72198953e-02 -1.89853106e+01]
Stock Position:  0.01721989531543264
Bond Position:  [-7.98407307]


portfolio before change:  [-6.18594659]
curr_Stock_Price:  104.47941273428106
curr_Factors:  [1.04479413e+02 3.59513948e-02]
mat_Sqrt:  [[ 1.98101879e+01  0.00000000e+00]
 [-7.58434121e-03  1.73779089e-02]]
grads:  [ 0.00265228 -0.89801104]
Stock Position:  0.0026522814916282705
Bond Position:  [-6.46305541]


portfolio before change:  [-6.18955285]
curr_Stock_Price:  103.4243503603318
curr_Factors:  [1.03424350e+02 3.55828228e-02]
mat_Sqrt:  [[ 1.95093590e+01  0.00000000e+00]
 [-7.54536391e-03  1.72886006e-02]]
grads:  [-8.19787569e-03 -9.99516914e+00]
Stock Position:  -0.00819787569349485
Bond Position:  [-5.34169288]


portfolio before change:  [-6.19183012]
curr_Stock_Price:  103.62068402476991
curr_Factors:  [1.03620684e+02 3.56803557e-02]
mat_Sqrt:  [[ 1.95731643e+01  0.00000000e+00]
 [-7.55569779e-03  1.73122785e-02]]
grads:  [-5.31976300e-03  8.92669999e+00]
Stock Position:  -0.0053197629993360475
Bond Position:  [-5.64059264]


portfolio before change:  [-6.19303721]
curr_Stock_Price:  103.71504278099972
curr_Factors:  [1.03715043e+02 3.41620543e-02]
mat_Sqrt:  [[ 1.91696304e+01  0.00000000e+00]
 [-7.39319193e-03  1.69399308e-02]]
grads:  [ -0.05536645 -52.56308486]
Stock Position:  -0.055366450781538123
Bond Position:  [-0.45070339]


portfolio before change:  [-6.22059372]
curr_Stock_Price:  104.21173659104306
curr_Factors:  [1.04211737e+02 3.41049021e-02]
mat_Sqrt:  [[ 1.92453156e+01  0.00000000e+00]
 [-7.38700503e-03  1.69257549e-02]]
grads:  [-5.82268853e-03 -1.24037514e+01]
Stock Position:  -0.00582268853052939
Bond Position:  [-5.61380124]


portfolio before change:  [-6.21946146]
curr_Stock_Price:  103.89675589788946
curr_Factors:  [1.03896756e+02 3.37146693e-02]
mat_Sqrt:  [[ 1.90770597e+01  0.00000000e+00]
 [-7.34462190e-03  1.68286429e-02]]
grads:  [-1.05753808e-03 -6.99484629e+00]
Stock Position:  -0.0010575380789973174
Bond Position:  [-6.10958668]


portfolio before change:  [-6.21914176]
curr_Stock_Price:  102.87226422465093
curr_Factors:  [1.02872264e+02 3.57675106e-02]
mat_Sqrt:  [[ 1.94555116e+01  0.00000000e+00]
 [-7.56492015e-03  1.73334096e-02]]
grads:  [3.59995114e-03 1.62879539e+01]
Stock Position:  0.003599951139010818
Bond Position:  [-6.58947689]


portfolio before change:  [-6.21319889]
curr_Stock_Price:  104.75190273865287
curr_Factors:  [1.04751903e+02 3.46131470e-02]
mat_Sqrt:  [[ 1.94886817e+01  0.00000000e+00]
 [-7.44184353e-03  1.70514056e-02]]
grads:  [7.14004187e-03 8.68962474e+00]
Stock Position:  0.00714004186716287
Bond Position:  [-6.96113186]


portfolio before change:  [-6.22593788]
curr_Stock_Price:  103.0896169955435
curr_Factors:  [1.03089617e+02 3.48123260e-02]
mat_Sqrt:  [[ 1.92345242e+01  0.00000000e+00]
 [-7.46322461e-03  1.71003959e-02]]
grads:  [2.31275167e-03 3.97565475e+00]
Stock Position:  0.0023127516651733314
Bond Position:  [-6.46435856]


portfolio before change:  [-6.22600614]
curr_Stock_Price:  103.40951125919369
curr_Factors:  [1.03409511e+02 3.41724017e-02]
mat_Sqrt:  [[ 1.91160535e+01  0.00000000e+00]
 [-7.39431151e-03  1.69424961e-02]]
grads:  [-0.00604866 -2.18246416]
Stock Position:  -0.006048663456455678
Bond Position:  [-5.60051681]


portfolio before change:  [-6.23853886]
curr_Stock_Price:  105.36574719648782
curr_Factors:  [1.05365747e+02 3.30362068e-02]
mat_Sqrt:  [[ 1.91511359e+01  0.00000000e+00]
 [-7.27034599e-03  1.66584554e-02]]
grads:  [1.94169192e-02 2.21960408e+01]
Stock Position:  0.019416919206485663
Bond Position:  [-8.28441706]


portfolio before change:  [-6.23450093]
curr_Stock_Price:  105.62704244750661
curr_Factors:  [1.05627042e+02 3.28182235e-02]
mat_Sqrt:  [[ 1.91351845e+01  0.00000000e+00]
 [-7.24632027e-03  1.66034056e-02]]
grads:  [3.79937141e-03 7.81336037e+00]
Stock Position:  0.0037993714110092546
Bond Position:  [-6.63581729]


portfolio before change:  [-6.22902275]
curr_Stock_Price:  107.28723831590742
curr_Factors:  [1.07287238e+02 3.11120948e-02]
mat_Sqrt:  [[ 1.89239893e+01  0.00000000e+00]
 [-7.05544837e-03  1.61660631e-02]]
grads:  [-9.20243099e-03 -2.26659722e+01]
Stock Position:  -0.009202430987301679
Bond Position:  [-5.24171935]


portfolio before change:  [-6.2257169]
curr_Stock_Price:  106.85679645378788
curr_Factors:  [1.06856796e+02 3.10452778e-02]
mat_Sqrt:  [[ 1.88278151e+01  0.00000000e+00]
 [-7.04786808e-03  1.61486945e-02]]
grads:  [1.21446602e-02 1.27037843e+01]
Stock Position:  0.012144660199047023
Bond Position:  [-7.52345638]


portfolio before change:  [-6.23116441]
curr_Stock_Price:  106.48568533362241
curr_Factors:  [1.06485685e+02 2.96037155e-02]
mat_Sqrt:  [[ 1.83216398e+01  0.00000000e+00]
 [-6.88229211e-03  1.57693123e-02]]
grads:  [8.31315306e-03 1.05406423e+01]
Stock Position:  0.00831315306161782
Bond Position:  [-7.11639621]


portfolio before change:  [-6.23360795]
curr_Stock_Price:  106.29876020042255
curr_Factors:  [1.06298760e+02 3.07914668e-02]
mat_Sqrt:  [[ 1.86527723e+01  0.00000000e+00]
 [-7.01899899e-03  1.60825471e-02]]
grads:  [ 2.67095898e-02 -4.27021624e+01]
Stock Position:  0.02670958984495567
Bond Position:  [-9.07280424]


portfolio before change:  [-6.20784669]
curr_Stock_Price:  107.30571804853187
curr_Factors:  [1.07305718e+02 3.10915620e-02]
mat_Sqrt:  [[ 1.89210022e+01  0.00000000e+00]
 [-7.05311982e-03  1.61607277e-02]]
grads:  [-1.65600852e-02  5.19320190e+01]
Stock Position:  -0.016560085197624395
Bond Position:  [-4.43085486]


portfolio before change:  [-6.20844309]
curr_Stock_Price:  107.30828502611288
curr_Factors:  [1.07308285e+02 3.12240056e-02]
mat_Sqrt:  [[ 1.89617127e+01  0.00000000e+00]
 [-7.06812627e-03  1.61951118e-02]]
grads:  [ 0.0052482  -0.83970225]
Stock Position:  0.005248196221564618
Bond Position:  [-6.77161803]


portfolio before change:  [-6.20479917]
curr_Stock_Price:  108.1638990992662
curr_Factors:  [1.08163899e+02 3.10765833e-02]
mat_Sqrt:  [[ 1.90677288e+01  0.00000000e+00]
 [-7.05142066e-03  1.61568345e-02]]
grads:  [-0.00411704 -3.38380684]
Stock Position:  -0.004117041930510608
Bond Position:  [-5.75948386]


portfolio before change:  [-6.2071355]
curr_Stock_Price:  108.55649878826712
curr_Factors:  [1.08556499e+02 3.19247304e-02]
mat_Sqrt:  [[ 1.93963247e+01  0.00000000e+00]
 [-7.14699717e-03  1.63758278e-02]]
grads:  [ 2.47046510e-03 -8.53142019e+00]
Stock Position:  0.002470465101476626
Bond Position:  [-6.47532054]


portfolio before change:  [-6.20697613]
curr_Stock_Price:  108.9486644383579
curr_Factors:  [1.08948664e+02 3.26135128e-02]
mat_Sqrt:  [[ 1.96752700e+01  0.00000000e+00]
 [-7.22368469e-03  1.65515410e-02]]
grads:  [ 1.02572472e-03 -5.02425765e+00]
Stock Position:  0.0010257247201504894
Bond Position:  [-6.31872747]


portfolio before change:  [-6.2072778]
curr_Stock_Price:  109.42464043989382
curr_Factors:  [1.09424640e+02 3.30490793e-02]
mat_Sqrt:  [[ 1.98927494e+01  0.00000000e+00]
 [-7.27176229e-03  1.66617006e-02]]
grads:  [ 0.01429939 -1.61063482]
Stock Position:  0.014299387835395675
Bond Position:  [-7.77198317]


portfolio before change:  [-6.20877304]
curr_Stock_Price:  109.38801753323924
curr_Factors:  [1.09388018e+02 3.27443338e-02]
mat_Sqrt:  [[ 1.97941944e+01  0.00000000e+00]
 [-7.23815820e-03  1.65847039e-02]]
grads:  [ 0.02536962 25.27152962]
Stock Position:  0.02536962064929116
Bond Position:  [-8.98390555]


portfolio before change:  [-6.19562127]
curr_Stock_Price:  109.95069162293399
curr_Factors:  [1.09950692e+02 3.29296044e-02]
mat_Sqrt:  [[ 1.99522199e+01  0.00000000e+00]
 [-7.25860642e-03  1.66315567e-02]]
grads:  [0.01353996 0.41242537]
Stock Position:  0.01353995513769975
Bond Position:  [-7.68434871]


portfolio before change:  [-6.17897284]
curr_Stock_Price:  111.25121581301622
curr_Factors:  [1.11251216e+02 3.14615831e-02]
mat_Sqrt:  [[ 1.97330880e+01  0.00000000e+00]
 [-7.09496533e-03  1.62566078e-02]]
grads:  [-1.16591323e-02 -1.66913205e+01]
Stock Position:  -0.011659132252657339
Bond Position:  [-4.8818802]


portfolio before change:  [-6.19481518]
curr_Stock_Price:  112.5576650420567
curr_Factors:  [1.12557665e+02 2.94325214e-02]
mat_Sqrt:  [[ 1.93102906e+01  0.00000000e+00]
 [-6.86236361e-03  1.57236503e-02]]
grads:  [ 0.00807215 -4.43131729]
Stock Position:  0.008072154390000329
Bond Position:  [-7.10339803]


portfolio before change:  [-6.18165115]
curr_Stock_Price:  114.29846482016744
curr_Factors:  [1.14298465e+02 2.91263606e-02]
mat_Sqrt:  [[ 1.95066867e+01  0.00000000e+00]
 [-6.82657871e-03  1.56416568e-02]]
grads:  [-0.01911135  2.8963798 ]
Stock Position:  -0.019111350332447194
Bond Position:  [-3.99725315]


portfolio before change:  [-6.18017803]
curr_Stock_Price:  114.19523776520286
curr_Factors:  [1.14195238e+02 2.86967546e-02]
mat_Sqrt:  [[ 1.93448063e+01  0.00000000e+00]
 [-6.77604659e-03  1.55258732e-02]]
grads:  [-3.70900123e-03  5.24932278e+00]
Stock Position:  -0.0037090012278476964
Bond Position:  [-5.75662775]


portfolio before change:  [-6.17446711]
curr_Stock_Price:  112.46147118295467
curr_Factors:  [1.12461471e+02 2.94959559e-02]
mat_Sqrt:  [[ 1.93145680e+01  0.00000000e+00]
 [-6.86975468e-03  1.57405854e-02]]
grads:  [-0.01332266 11.18304698]
Stock Position:  -0.013322658906528381
Bond Position:  [-4.67618129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.17792399]
Stock Price:  112.6770679894251
PL:  [-18.85499198]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.00862872e-01  5.09304322e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.07921154e-01 -6.82088812e-01]
 [-4.24055170e-02  5.87143934e-02]
 [ 4.07598082e-02 -3.44053667e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-6.73673214e-02  1.70538861e-01]
 [-1.28087407e-01 -8.96107870e-02]
 [ 1.65967840e-01  1.01942064e-01]
 [ 2.31944087e-02  1.97478096e-01]
 [ 1.79050072e-01  4.35821282e-01]
 [ 1.53047987e-01  2.82689458e-01]
 [ 3.54649227e-01  2.44238018e-02]
 [ 8.88214000e-03  1.56986794e-01]
 [ 9.91396647e-02  2.44142428e-01]
 [ 3.24140769e-02  2.35628752e-01]
 [ 1.21003015e-01  2.89692760e-01]
 [ 1.08817783e-01  6.89145268e-02]
 [ 1.85844694e-02 -2.56491276e-02]
 [ 2.27595062e-01 -1.08053537e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-1.94986164e-02  1.29335184e-01]
 [ 2.09224927e-02  1.18488666e-01]
 [ 6.61836486e-03 -7.21449149e-02]
 [ 2.75473850e-02  1.53439539e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.54783865e-01  7.97873268e-02]
 [-5.02630813e-01  1.10328177e-01]
 [ 2.58693457e-01 -1.05908407e-01]
 [-1.48322236e+00 -1.67022073e-01]
 [ 2.38348507e-01  4.80935682e-01]
 [-5.98197602e-03 -1.28959024e-01]
 [ 9.59083849e-03  6.28444413e-02]
 [-3.31122715e-02  1.67660252e-01]
 [-2.19269637e+00  3.09775427e-02]
 [-1.09588095e-01  1.47010781e-01]
 [-1.35015250e-01 -1.20113751e-01]
 [ 1.35470406e+00 -6.18603598e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.4819025]
curr_Stock_Price:  100.56844163578818
curr_Factors:  [1.00568442e+02 4.05486889e-02]
mat_Sqrt:  [[ 2.02511704e+01  0.00000000e+00]
 [-8.05468201e-03  1.84555950e-02]]
grads:  [2.08946689e-02 2.75962017e+01]
Stock Position:  0.020894668903991255
Bond Position:  [4.38055821]


portfolio before change:  [6.46724349]
curr_Stock_Price:  99.84066656765069
curr_Factors:  [9.98406666e+01 4.03723938e-02]
mat_Sqrt:  [[ 2.00608681e+01  0.00000000e+00]
 [-8.03715310e-03  1.84154312e-02]]
grads:  [-0.01011843 -4.77921853]
Stock Position:  -0.010118427935574709
Bond Position:  [7.47747408]


portfolio before change:  [6.4673689]
curr_Stock_Price:  99.92065175135855
curr_Factors:  [9.99206518e+01 4.11615356e-02]
mat_Sqrt:  [[ 2.02722075e+01  0.00000000e+00]
 [-8.11532235e-03  1.85945395e-02]]
grads:  [ 2.51690987e-02 -3.66822105e+01]
Stock Position:  0.025169098732855003
Bond Position:  [3.95245615]


portfolio before change:  [6.45719898]
curr_Stock_Price:  99.49695714165537
curr_Factors:  [9.94969571e+01 4.16378616e-02]
mat_Sqrt:  [[ 2.03027098e+01  0.00000000e+00]
 [-8.16214302e-03  1.87018191e-02]]
grads:  [-8.26513064e-04  3.13950173e+00]
Stock Position:  -0.0008265130640559856
Bond Position:  [6.53943452]


portfolio before change:  [6.45881676]
curr_Stock_Price:  98.52866987825855
curr_Factors:  [9.85286699e+01 4.16434023e-02]
mat_Sqrt:  [[ 2.01064650e+01  0.00000000e+00]
 [-8.16268606e-03  1.87030634e-02]]
grads:  [ 1.28038793e-03 -1.83955783e+00]
Stock Position:  0.0012803879307691762
Bond Position:  [6.33266184]


portfolio before change:  [6.46081724]
curr_Stock_Price:  99.47279586407826
curr_Factors:  [9.94727959e+01 4.17119229e-02]
mat_Sqrt:  [[ 2.03158235e+01  0.00000000e+00]
 [-8.16939879e-03  1.87184442e-02]]
grads:  [-0.00582899 -3.54286539]
Stock Position:  -0.005828991963489977
Bond Position:  [7.04064337]


portfolio before change:  [6.46862445]
curr_Stock_Price:  98.28441393465954
curr_Factors:  [9.82844139e+01 4.11373504e-02]
mat_Sqrt:  [[ 1.99343835e+01  0.00000000e+00]
 [-8.11293785e-03  1.85890759e-02]]
grads:  [3.54259239e-04 9.17414410e+00]
Stock Position:  0.0003542592388540768
Bond Position:  [6.43380629]


portfolio before change:  [6.46952648]
curr_Stock_Price:  98.5603571844311
curr_Factors:  [9.85603572e+01 3.98496921e-02]
mat_Sqrt:  [[ 1.96750006e+01  0.00000000e+00]
 [-7.98495506e-03  1.82958305e-02]]
grads:  [-0.00849793 -4.89788026]
Stock Position:  -0.008497929143776672
Bond Position:  [7.30708541]


portfolio before change:  [6.47790236]
curr_Stock_Price:  97.68220878654326
curr_Factors:  [9.76822088e+01 3.85339711e-02]
mat_Sqrt:  [[ 1.91750875e+01  0.00000000e+00]
 [-7.85202864e-03  1.79912578e-02]]
grads:  [0.01097565 5.66619994]
Stock Position:  0.010975647649852344
Bond Position:  [5.40577686]


portfolio before change:  [6.4621506]
curr_Stock_Price:  96.18548352400221
curr_Factors:  [9.61854835e+01 4.01916102e-02]
mat_Sqrt:  [[ 1.92831170e+01  0.00000000e+00]
 [-8.01913813e-03  1.83741537e-02]]
grads:  [5.67236697e-03 1.07476023e+01]
Stock Position:  0.005672366974009892
Bond Position:  [5.91655124]


portfolio before change:  [6.4592219]
curr_Stock_Price:  95.53878408584593
curr_Factors:  [9.55387841e+01 4.03358693e-02]
mat_Sqrt:  [[ 1.91878105e+01  0.00000000e+00]
 [-8.03351672e-03  1.84070992e-02]]
grads:  [1.92444090e-02 2.36768041e+01]
Stock Position:  0.019244409045920893
Bond Position:  [4.62063446]


portfolio before change:  [6.4621431]
curr_Stock_Price:  95.66056401909812
curr_Factors:  [9.56605640e+01 4.14526259e-02]
mat_Sqrt:  [[ 1.94764124e+01  0.00000000e+00]
 [-8.14396718e-03  1.86601730e-02]]
grads:  [1.41927464e-02 1.51493481e+01]
Stock Position:  0.014192746375076039
Bond Position:  [5.10445697]


portfolio before change:  [6.43665252]
curr_Stock_Price:  93.81957620723368
curr_Factors:  [9.38195762e+01 4.28214780e-02]
mat_Sqrt:  [[ 1.94144143e+01  0.00000000e+00]
 [-8.27734045e-03  1.89657696e-02]]
grads:  [0.01881636 1.28778332]
Stock Position:  0.018816362002457492
Bond Position:  [4.67130941]


portfolio before change:  [6.4208123]
curr_Stock_Price:  92.94670962556577
curr_Factors:  [9.29467096e+01 4.39495124e-02]
mat_Sqrt:  [[ 1.94854774e+01  0.00000000e+00]
 [-8.38565560e-03  1.92139508e-02]]
grads:  [3.97202452e-03 8.17045885e+00]
Stock Position:  0.003972024520885282
Bond Position:  [6.05162569]


portfolio before change:  [6.42234875]
curr_Stock_Price:  93.14307024564337
curr_Factors:  [9.31430702e+01 4.39982046e-02]
mat_Sqrt:  [[ 1.95374566e+01  0.00000000e+00]
 [-8.39029960e-03  1.92245915e-02]]
grads:  [1.05280928e-02 1.26994859e+01]
Stock Position:  0.010528092774445216
Bond Position:  [5.44172986]


portfolio before change:  [6.42333084]
curr_Stock_Price:  93.17173978516547
curr_Factors:  [9.31717398e+01 4.33066881e-02]
mat_Sqrt:  [[ 1.93892804e+01  0.00000000e+00]
 [-8.32410362e-03  1.90729175e-02]]
grads:  [6.97555001e-03 1.23541012e+01]
Stock Position:  0.006975550013650776
Bond Position:  [5.77340671]


portfolio before change:  [6.4322802]
curr_Stock_Price:  94.35123663564306
curr_Factors:  [9.43512366e+01 4.28387943e-02]
mat_Sqrt:  [[ 1.95283799e+01  0.00000000e+00]
 [-8.27901388e-03  1.89696039e-02]]
grads:  [1.26705493e-02 1.52714185e+01]
Stock Position:  0.012670549284468108
Bond Position:  [5.23679821]


portfolio before change:  [6.43841487]
curr_Stock_Price:  94.78373799794073
curr_Factors:  [9.47837380e+01 4.33923971e-02]
mat_Sqrt:  [[ 1.97442505e+01  0.00000000e+00]
 [-8.33233672e-03  1.90917819e-02]]
grads:  [0.00703468 3.60964352]
Stock Position:  0.007034683220751332
Bond Position:  [5.7716413]


portfolio before change:  [6.43773678]
curr_Stock_Price:  94.58478223818847
curr_Factors:  [9.45847822e+01 4.37497228e-02]
mat_Sqrt:  [[ 1.97837639e+01  0.00000000e+00]
 [-8.36657376e-03  1.91702288e-02]]
grads:  [ 3.73552391e-04 -1.33796670e+00]
Stock Position:  0.00037355239080499197
Bond Position:  [6.40240441]


portfolio before change:  [6.43915174]
curr_Stock_Price:  96.23009790559574
curr_Factors:  [9.62300979e+01 4.17775590e-02]
mat_Sqrt:  [[ 1.96690081e+01  0.00000000e+00]
 [-8.17582378e-03  1.87331657e-02]]
grads:  [ 0.00917365 -5.76803402]
Stock Position:  0.00917365183807256
Bond Position:  [5.55637033]


portfolio before change:  [6.44389197]
curr_Stock_Price:  96.67110463284409
curr_Factors:  [9.66711046e+01 4.03683659e-02]
mat_Sqrt:  [[ 1.94230428e+01  0.00000000e+00]
 [-8.03675217e-03  1.84145126e-02]]
grads:  [ 0.002169   -2.05153351]
Stock Position:  0.0021690015896201147
Bond Position:  [6.2342122]


portfolio before change:  [6.44007685]
curr_Stock_Price:  94.55287396125955
curr_Factors:  [9.45528740e+01 4.21563744e-02]
mat_Sqrt:  [[ 1.94136127e+01  0.00000000e+00]
 [-8.21280701e-03  1.88179049e-02]]
grads:  [1.90319474e-03 6.87298530e+00]
Stock Position:  0.0019031947410644756
Bond Position:  [6.26012432]


portfolio before change:  [6.44344496]
curr_Stock_Price:  95.91140114006828
curr_Factors:  [9.59114011e+01 4.23230459e-02]
mat_Sqrt:  [[ 1.97314360e+01  0.00000000e+00]
 [-8.22902628e-03  1.88550679e-02]]
grads:  [3.68119107e-03 6.28418134e+00]
Stock Position:  0.0036811910731746403
Bond Position:  [6.09037677]


portfolio before change:  [6.43625577]
curr_Stock_Price:  93.75162808740473
curr_Factors:  [9.37516281e+01 4.39044507e-02]
mat_Sqrt:  [[ 1.96441433e+01  0.00000000e+00]
 [-8.38135557e-03  1.92040982e-02]]
grads:  [-1.26593749e-03 -3.75674579e+00]
Stock Position:  -0.0012659374884159398
Bond Position:  [6.55493947]


portfolio before change:  [6.43794006]
curr_Stock_Price:  93.06844207146493
curr_Factors:  [9.30684421e+01 4.54044233e-02]
mat_Sqrt:  [[ 1.98313156e+01  0.00000000e+00]
 [-8.52332548e-03  1.95293921e-02]]
grads:  [4.76589106e-03 7.85685176e+00]
Stock Position:  0.004765891063613125
Bond Position:  [5.994386]


portfolio before change:  [6.43960587]
curr_Stock_Price:  93.26073900366008
curr_Factors:  [9.32607390e+01 4.65260799e-02]
mat_Sqrt:  [[ 2.01162527e+01  0.00000000e+00]
 [-8.62796198e-03  1.97691444e-02]]
grads:  [6.23797296e-03 9.20973189e+00]
Stock Position:  0.006237972957963084
Bond Position:  [5.8578479]


portfolio before change:  [6.44096925]
curr_Stock_Price:  93.36191028945593
curr_Factors:  [9.33619103e+01 4.57943680e-02]
mat_Sqrt:  [[ 1.99790928e+01  0.00000000e+00]
 [-8.55984747e-03  1.96130745e-02]]
grads:  [8.91740192e-03 8.91942742e+00]
Stock Position:  0.008917401915708755
Bond Position:  [5.60842357]


portfolio before change:  [6.43471085]
curr_Stock_Price:  92.58147067407671
curr_Factors:  [9.25814707e+01 4.60918804e-02]
mat_Sqrt:  [[ 1.98763341e+01  0.00000000e+00]
 [-8.58760785e-03  1.96766815e-02]]
grads:  [-0.00603541  4.05491784]
Stock Position:  -0.006035409746262513
Bond Position:  [6.99347796]


portfolio before change:  [6.44219079]
curr_Stock_Price:  91.48697967834337
curr_Factors:  [9.14869797e+01 4.48806167e-02]
mat_Sqrt:  [[ 1.93815586e+01  0.00000000e+00]
 [-8.47401834e-03  1.94164152e-02]]
grads:  [-0.02344908  5.68221143]
Stock Position:  -0.02344907647163917
Bond Position:  [8.58747598]


portfolio before change:  [6.42613123]
curr_Stock_Price:  92.2176293840357
curr_Factors:  [9.22176294e+01 4.47914323e-02]
mat_Sqrt:  [[ 1.95169266e+01  0.00000000e+00]
 [-8.46559458e-03  1.93971140e-02]]
grads:  [ 0.01088651 -5.46000849]
Stock Position:  0.010886511125893873
Bond Position:  [5.42220299]


portfolio before change:  [6.42250463]
curr_Stock_Price:  91.8222392720558
curr_Factors:  [9.18222393e+01 4.49114971e-02]
mat_Sqrt:  [[ 1.94592746e+01  0.00000000e+00]
 [-8.47693313e-03  1.94230939e-02]]
grads:  [-0.07996787 -8.59914873]
Stock Position:  -0.07996787132721075
Bond Position:  [13.76533365]


portfolio before change:  [6.39890983]
curr_Stock_Price:  92.1388110882541
curr_Factors:  [9.21388111e+01 4.42435190e-02]
mat_Sqrt:  [[ 1.93806097e+01  0.00000000e+00]
 [-8.41365737e-03  1.92781109e-02]]
grads:  [2.31285833e-02 2.49472412e+01]
Stock Position:  0.023128583346462547
Bond Position:  [4.26786966]


portfolio before change:  [6.43074691]
curr_Stock_Price:  93.49226887078949
curr_Factors:  [9.34922689e+01 4.44137515e-02]
mat_Sqrt:  [[ 1.97030940e+01  0.00000000e+00]
 [-8.42982813e-03  1.93151628e-02]]
grads:  [-3.16012849e-03 -6.67656939e+00]
Stock Position:  -0.003160128486357867
Bond Position:  [6.72619449]


portfolio before change:  [6.43249924]
curr_Stock_Price:  93.20383089809125
curr_Factors:  [9.32038309e+01 4.65804370e-02]
mat_Sqrt:  [[ 2.01157182e+01  0.00000000e+00]
 [-8.63300059e-03  1.97806893e-02]]
grads:  [1.84027242e-03 3.17706022e+00]
Stock Position:  0.001840272415236057
Bond Position:  [6.2609788]


portfolio before change:  [6.43342479]
curr_Stock_Price:  93.28147031630435
curr_Factors:  [9.32814703e+01 4.61510069e-02]
mat_Sqrt:  [[ 2.00394581e+01  0.00000000e+00]
 [-8.59311417e-03  1.96892981e-02]]
grads:  [1.99908906e-03 8.51529860e+00]
Stock Position:  0.0019990890640871036
Bond Position:  [6.24694682]


portfolio before change:  [6.43054505]
curr_Stock_Price:  91.45030764863728
curr_Factors:  [9.14503076e+01 4.57050375e-02]
mat_Sqrt:  [[ 1.95509203e+01  0.00000000e+00]
 [-8.55149461e-03  1.95939357e-02]]
grads:  [-0.11146159  1.58097603]
Stock Position:  -0.111461589971611
Bond Position:  [16.62374174]


portfolio before change:  [6.44822248]
curr_Stock_Price:  91.31035509501336
curr_Factors:  [9.13103551e+01 4.66479011e-02]
mat_Sqrt:  [[ 1.97213248e+01  0.00000000e+00]
 [-8.63925007e-03  1.97950087e-02]]
grads:  [-2.30346241e-03  7.42665908e+00]
Stock Position:  -0.0023034624134795475
Bond Position:  [6.65855245]


portfolio before change:  [6.45062232]
curr_Stock_Price:  90.62987058119337
curr_Factors:  [9.06298706e+01 4.71339548e-02]
mat_Sqrt:  [[ 1.96760673e+01  0.00000000e+00]
 [-8.68414231e-03  1.98978697e-02]]
grads:  [-0.00952615 -6.03651309]
Stock Position:  -0.009526150982656537
Bond Position:  [7.31397615]


portfolio before change:  [6.43633617]
curr_Stock_Price:  92.22552617670796
curr_Factors:  [9.22255262e+01 4.66637372e-02]
mat_Sqrt:  [[ 1.99223654e+01  0.00000000e+00]
 [-8.64071638e-03  1.97983684e-02]]
grads:  [ 0.06664399 -3.12451806]
Stock Position:  0.06664399336431073
Bond Position:  [0.29005881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.42790514]
Stock Price:  92.0984736884546
PL:  [6.42790514]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.12448192e-01  4.55551013e-03]
 [-1.64775017e-01 -8.68789891e-02]
 [ 8.07590807e-01 -6.81364606e-01]
 [-3.36116863e-02  1.38531364e-01]
 [ 3.24037650e-02 -5.77895168e-02]
 [-8.03630857e-02 -1.03506527e-01]
 [-6.99057263e-02  1.67093482e-01]
 [-1.35124629e-01 -9.11958856e-02]
 [ 1.65965120e-01  8.57691898e-02]
 [ 2.18256270e-01 -6.32053891e-02]
 [ 1.00264430e-01  1.27956968e-01]
 [-1.05594974e-01 -1.93953860e-02]
 [-1.05500702e-01  1.37047344e-01]
 [-4.14408683e-01 -5.42245401e-01]
 [ 7.80169266e-02  2.23730351e-01]
 [ 5.23564761e-02 -1.93570961e-02]
 [-4.01678044e-02  7.04668375e-02]
 [-1.04842548e-01  5.28178070e-03]
 [ 1.50838420e-02  6.12719790e-02]
 [-2.36628229e-02 -8.22128848e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 8.48920814e-02  3.03854310e-01]
 [ 3.71894759e-02  3.50212413e-01]
 [ 2.61084012e-02  1.65795053e-01]
 [ 1.71397538e-02  4.07283587e-02]
 [ 7.20731596e-01 -3.35745687e-01]
 [-3.18414549e-01  4.11882564e-01]
 [ 1.45270343e-01 -2.87473005e-03]
 [-3.84890824e-02 -7.12060687e-02]
 [-6.24679560e-02 -7.50631855e-02]
 [-2.88849016e-01 -8.86940134e-02]
 [-4.00253464e-02 -4.18394124e-03]
 [ 2.11341979e-01  2.39298335e-01]
 [ 2.29826904e-01  2.60120469e-02]
 [-1.83231502e-01 -2.38459930e-01]
 [ 1.83704572e-01 -7.41568285e-02]
 [-2.10083037e-01  1.78212176e-01]
 [-1.16464507e-01  1.22483197e-01]
 [-1.64416596e-01  1.41438952e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.14287757]
curr_Stock_Price:  99.11879397647841
curr_Factors:  [9.9118794e+01 4.0218217e-02]
mat_Sqrt:  [[ 1.98777588e+01  0.00000000e+00]
 [-8.02179202e-03  1.83802346e-02]]
grads:  [-0.01058771  0.24784831]
Stock Position:  -0.010587712959910789
Bond Position:  [-2.09343623]


portfolio before change:  [-3.14480328]
curr_Stock_Price:  99.27595877418428
curr_Factors:  [9.92759588e+01 3.99831448e-02]
mat_Sqrt:  [[ 1.98510080e+01  0.00000000e+00]
 [-7.99831431e-03  1.83264404e-02]]
grads:  [-0.01021067 -4.74063634]
Stock Position:  -0.010210671217742445
Bond Position:  [-2.1311291]


portfolio before change:  [-3.15216882]
curr_Stock_Price:  99.97122529092422
curr_Factors:  [9.99712253e+01 3.88850957e-02]
mat_Sqrt:  [[ 1.97136300e+01  0.00000000e+00]
 [-7.88772167e-03  1.80730408e-02]]
grads:  [ 2.58815303e-02 -3.77006068e+01]
Stock Position:  0.025881530340687693
Bond Position:  [-5.73957713]


portfolio before change:  [-3.19542313]
curr_Stock_Price:  98.32770539886228
curr_Factors:  [9.83277054e+01 4.02503685e-02]
mat_Sqrt:  [[ 1.97269905e+01  0.00000000e+00]
 [-8.02499779e-03  1.83875799e-02]]
grads:  [1.36099613e-03 7.53396393e+00]
Stock Position:  0.001360996125061748
Bond Position:  [-3.32924675]


portfolio before change:  [-3.19644885]
curr_Stock_Price:  97.87983887132418
curr_Factors:  [9.78798389e+01 3.96742308e-02]
mat_Sqrt:  [[ 1.94960892e+01  0.00000000e+00]
 [-7.96735648e-03  1.82555071e-02]]
grads:  [ 3.68399634e-04 -3.16559363e+00]
Stock Position:  0.00036839963358507757
Bond Position:  [-3.23250775]


portfolio before change:  [-3.19693381]
curr_Stock_Price:  97.66033421041894
curr_Factors:  [9.76603342e+01 3.88473076e-02]
mat_Sqrt:  [[ 1.92485788e+01  0.00000000e+00]
 [-7.88388814e-03  1.80642571e-02]]
grads:  [-0.00652189 -5.72990778]
Stock Position:  -0.0065218860688597705
Bond Position:  [-2.56000423]


portfolio before change:  [-3.2008469]
curr_Stock_Price:  98.21125932036959
curr_Factors:  [9.82112593e+01 3.78836863e-02]
mat_Sqrt:  [[ 1.91155763e+01  0.00000000e+00]
 [-7.78549279e-03  1.78388050e-02]]
grads:  [1.57978385e-04 9.36685399e+00]
Stock Position:  0.000157978385124472
Bond Position:  [-3.21636215]


portfolio before change:  [-3.20120013]
curr_Stock_Price:  98.52041753478231
curr_Factors:  [9.85204175e+01 3.73747431e-02]
mat_Sqrt:  [[ 1.90465075e+01  0.00000000e+00]
 [-7.73301940e-03  1.77185734e-02]]
grads:  [-0.00918414 -5.14690905]
Stock Position:  -0.00918413921105471
Bond Position:  [-2.2963749]


portfolio before change:  [-3.20244896]
curr_Stock_Price:  98.62513798308852
curr_Factors:  [9.86251380e+01 3.78054963e-02]
mat_Sqrt:  [[ 1.91763124e+01  0.00000000e+00]
 [-7.77745421e-03  1.78203863e-02]]
grads:  [0.01060672 4.8129815 ]
Stock Position:  0.010606724558250374
Bond Position:  [-4.24853863]


portfolio before change:  [-3.19672432]
curr_Stock_Price:  99.21492845467372
curr_Factors:  [9.92149285e+01 3.69984914e-02]
mat_Sqrt:  [[ 1.90839835e+01  0.00000000e+00]
 [-7.69399677e-03  1.76291613e-02]]
grads:  [ 0.00999116 -3.58527488]
Stock Position:  0.009991162325535295
Bond Position:  [-4.18799677]


portfolio before change:  [-3.19377906]
curr_Stock_Price:  99.56211411855291
curr_Factors:  [9.95621141e+01 3.68641783e-02]
mat_Sqrt:  [[ 1.91159721e+01  0.00000000e+00]
 [-7.68001857e-03  1.75971332e-02]]
grads:  [0.00816644 7.2714667 ]
Stock Position:  0.00816643948100903
Bond Position:  [-4.00684704]


portfolio before change:  [-3.18886352]
curr_Stock_Price:  100.22536911490884
curr_Factors:  [1.00225369e+02 3.59489495e-02]
mat_Sqrt:  [[ 1.90029387e+01  0.00000000e+00]
 [-7.58408328e-03  1.73773179e-02]]
grads:  [-0.00600222 -1.11613232]
Stock Position:  -0.006002219796576342
Bond Position:  [-2.58728882]


portfolio before change:  [-3.19393034]
curr_Stock_Price:  101.01564301358985
curr_Factors:  [1.01015643e+02 3.70402711e-02]
mat_Sqrt:  [[ 1.94413183e+01  0.00000000e+00]
 [-7.69833968e-03  1.76391122e-02]]
grads:  [-2.35006376e-03  7.76951487e+00]
Stock Position:  -0.002350063761286787
Bond Position:  [-2.95653714]


portfolio before change:  [-3.19321497]
curr_Stock_Price:  100.55396815398299
curr_Factors:  [1.00553968e+02 3.91653681e-02]
mat_Sqrt:  [[ 1.98998737e+01  0.00000000e+00]
 [-7.91609682e-03  1.81380565e-02]]
grads:  [ -0.03271699 -29.8954523 ]
Stock Position:  -0.032716990460731184
Bond Position:  [0.09660825]


portfolio before change:  [-3.18722626]
curr_Stock_Price:  100.3712913446429
curr_Factors:  [1.00371291e+02 4.02856750e-02]
mat_Sqrt:  [[ 2.01458147e+01  0.00000000e+00]
 [-8.02851668e-03  1.83956427e-02]]
grads:  [8.71947151e-03 1.21621383e+01]
Stock Position:  0.008719471512745543
Bond Position:  [-4.06241087]


portfolio before change:  [-3.2006328]
curr_Stock_Price:  98.89199162499752
curr_Factors:  [9.88919916e+01 4.07571005e-02]
mat_Sqrt:  [[ 1.99646989e+01  0.00000000e+00]
 [-8.07535515e-03  1.85029631e-02]]
grads:  [ 0.0021993  -1.04616195]
Stock Position:  0.0021992992269346382
Bond Position:  [-3.41812588]


portfolio before change:  [-3.20145203]
curr_Stock_Price:  98.71378050797681
curr_Factors:  [9.87137805e+01 4.10255720e-02]
mat_Sqrt:  [[ 1.99942495e+01  0.00000000e+00]
 [-8.10190812e-03  1.85638036e-02]]
grads:  [-4.70813129e-04  3.79592669e+00]
Stock Position:  -0.00047081312887364103
Bond Position:  [-3.15497629]


portfolio before change:  [-3.20238652]
curr_Stock_Price:  99.8609318987118
curr_Factors:  [9.98609319e+01 4.02790481e-02]
mat_Sqrt:  [[ 2.00417303e+01  0.00000000e+00]
 [-8.02785631e-03  1.83941296e-02]]
grads:  [-0.00511619  0.28714491]
Stock Position:  -0.005116194468797135
Bond Position:  [-2.69147858]


portfolio before change:  [-3.20517483]
curr_Stock_Price:  100.34016496124536
curr_Factors:  [1.00340165e+02 3.96275812e-02]
mat_Sqrt:  [[ 1.99743931e+01  0.00000000e+00]
 [-7.96267103e-03  1.82447714e-02]]
grads:  [2.09393726e-03 3.35833088e+00]
Stock Position:  0.0020939372571205745
Bond Position:  [-3.41528084]


portfolio before change:  [-3.20569388]
curr_Stock_Price:  100.29617528565856
curr_Factors:  [1.00296175e+02 3.93403350e-02]
mat_Sqrt:  [[ 1.98931427e+01  0.00000000e+00]
 [-7.93375926e-03  1.81785262e-02]]
grads:  [-2.99316544e-03 -4.52252752e+00]
Stock Position:  -0.002993165444991407
Bond Position:  [-2.90549083]


portfolio before change:  [-3.20162882]
curr_Stock_Price:  98.81671642917527
curr_Factors:  [9.88167164e+01 3.99869229e-02]
mat_Sqrt:  [[ 1.97601124e+01  0.00000000e+00]
 [-7.99869219e-03  1.83273062e-02]]
grads:  [ 0.002132   -2.06129527]
Stock Position:  0.0021320025753224286
Bond Position:  [-3.41230632]


portfolio before change:  [-3.20188897]
curr_Stock_Price:  98.8947754859474
curr_Factors:  [9.88947755e+01 3.98025577e-02]
mat_Sqrt:  [[ 1.97300797e+01  0.00000000e+00]
 [-7.98023134e-03  1.82850071e-02]]
grads:  [1.10240292e-02 1.66176753e+01]
Stock Position:  0.011024029203002031
Bond Position:  [-4.29210786]


portfolio before change:  [-3.19147692]
curr_Stock_Price:  99.8879327476076
curr_Factors:  [9.98879327e+01 3.92405281e-02]
mat_Sqrt:  [[ 1.97870225e+01  0.00000000e+00]
 [-7.92368884e-03  1.81554520e-02]]
grads:  [9.60400708e-03 1.92896555e+01]
Stock Position:  0.009604007078339638
Bond Position:  [-4.15080133]


portfolio before change:  [-3.17413066]
curr_Stock_Price:  101.7481086102906
curr_Factors:  [1.01748109e+02 3.88730849e-02]
mat_Sqrt:  [[ 2.00609201e+01  0.00000000e+00]
 [-7.88650340e-03  1.80702494e-02]]
grads:  [4.90841368e-03 9.17502849e+00]
Stock Position:  0.004908413675114984
Bond Position:  [-3.67355247]


portfolio before change:  [-3.18543635]
curr_Stock_Price:  99.53833792111102
curr_Factors:  [9.95383379e+01 4.04994995e-02]
mat_Sqrt:  [[ 2.00315803e+01  0.00000000e+00]
 [-8.04979498e-03  1.84443974e-02]]
grads:  [1.74300111e-03 2.20816966e+00]
Stock Position:  0.0017430011118287456
Bond Position:  [-3.35893178]


portfolio before change:  [-3.1812413]
curr_Stock_Price:  102.1860365651552
curr_Factors:  [1.02186037e+02 3.81922041e-02]
mat_Sqrt:  [[ 1.99700391e+01  0.00000000e+00]
 [-7.81713033e-03  1.79112957e-02]]
grads:  [  0.02875308 -18.74491341]
Stock Position:  0.028753081618886234
Bond Position:  [-6.11940475]


portfolio before change:  [-3.13439531]
curr_Stock_Price:  103.84189269922832
curr_Factors:  [1.03841893e+02 3.81189999e-02]
mat_Sqrt:  [[ 2.02741822e+01  0.00000000e+00]
 [-7.80963507e-03  1.78941219e-02]]
grads:  [-6.83895701e-03  2.30177578e+01]
Stock Position:  -0.006838957013426917
Bond Position:  [-2.42422507]


portfolio before change:  [-3.13332723]
curr_Stock_Price:  103.64140556861526
curr_Factors:  [1.03641406e+02 3.75961698e-02]
mat_Sqrt:  [[ 2.00957905e+01  0.00000000e+00]
 [-7.75589271e-03  1.77709827e-02]]
grads:  [ 0.00716646 -0.1617654 ]
Stock Position:  0.007166461431837469
Bond Position:  [-3.87606937]


portfolio before change:  [-3.13560926]
curr_Stock_Price:  103.39058522862624
curr_Factors:  [1.03390585e+02 3.71316064e-02]
mat_Sqrt:  [[ 1.99229141e+01  0.00000000e+00]
 [-7.70782526e-03  1.76608464e-02]]
grads:  [-3.49175618e-03 -4.03186049e+00]
Stock Position:  -0.003491756183303728
Bond Position:  [-2.77459455]


portfolio before change:  [-3.13488664]
curr_Stock_Price:  103.08430153888094
curr_Factors:  [1.03084302e+02 3.74297234e-02]
mat_Sqrt:  [[ 1.99434754e+01  0.00000000e+00]
 [-7.73870515e-03  1.77316011e-02]]
grads:  [-0.00477491 -4.23329993]
Stock Position:  -0.0047749057846036705
Bond Position:  [-2.64266881]


portfolio before change:  [-3.1357268]
curr_Stock_Price:  103.19106963422341
curr_Factors:  [1.03191070e+02 3.76822953e-02]
mat_Sqrt:  [[ 2.00313762e+01  0.00000000e+00]
 [-7.76477124e-03  1.77913260e-02]]
grads:  [-0.01635226 -4.98523907]
Stock Position:  -0.016352259220531993
Bond Position:  [-1.44831968]


portfolio before change:  [-3.15570001]
curr_Stock_Price:  104.40143140416025
curr_Factors:  [1.04401431e+02 3.77462211e-02]
mat_Sqrt:  [[ 2.02835139e+01  0.00000000e+00]
 [-7.77135469e-03  1.78064106e-02]]
grads:  [-0.00206332 -0.23496826]
Stock Position:  -0.0020633194211649546
Bond Position:  [-2.9402865]


portfolio before change:  [-3.15785574]
curr_Stock_Price:  105.26808020145694
curr_Factors:  [1.05268080e+02 3.79872927e-02]
mat_Sqrt:  [[ 2.05170952e+01  0.00000000e+00]
 [-7.79613163e-03  1.78631817e-02]]
grads:  [ 0.01539108 13.39617652]
Stock Position:  0.015391083901407396
Bond Position:  [-4.77804559]


portfolio before change:  [-3.14143638]
curr_Stock_Price:  106.37369736982592
curr_Factors:  [1.06373697e+02 3.80605375e-02]
mat_Sqrt:  [[ 2.07525617e+01  0.00000000e+00]
 [-7.80364402e-03  1.78803947e-02]]
grads:  [0.01162167 1.45478035]
Stock Position:  0.011621673325679377
Bond Position:  [-4.37767674]


portfolio before change:  [-3.13786174]
curr_Stock_Price:  106.72837022371854
curr_Factors:  [1.06728370e+02 3.72808132e-02]
mat_Sqrt:  [[ 2.06073699e+01  0.00000000e+00]
 [-7.72329600e-03  1.76962943e-02]]
grads:  [ -0.01394181 -13.47513363]
Stock Position:  -0.013941805730062169
Bond Position:  [-1.64987553]


portfolio before change:  [-3.14924306]
curr_Stock_Price:  107.52992219034883
curr_Factors:  [1.07529922e+02 3.66419836e-02]
mat_Sqrt:  [[ 2.05834808e+01  0.00000000e+00]
 [-7.65683837e-03  1.75440207e-02]]
grads:  [ 0.00735249 -4.22690042]
Stock Position:  0.0073524920288410775
Bond Position:  [-3.93985596]


portfolio before change:  [-3.15396979]
curr_Stock_Price:  106.95403367224817
curr_Factors:  [1.06954034e+02 3.60137291e-02]
mat_Sqrt:  [[ 2.02969702e+01  0.00000000e+00]
 [-7.59091342e-03  1.73929677e-02]]
grads:  [-6.51845403e-03  1.02462201e+01]
Stock Position:  -0.006518454032837006
Bond Position:  [-2.45679484]


portfolio before change:  [-3.15471329]
curr_Stock_Price:  107.0209789733571
curr_Factors:  [1.07020979e+02 3.66687856e-02]
mat_Sqrt:  [[ 2.04935494e+01  0.00000000e+00]
 [-7.65963817e-03  1.75504359e-02]]
grads:  [-3.07455071e-03  6.97892624e+00]
Stock Position:  -0.00307455070894193
Bond Position:  [-2.82567186]


portfolio before change:  [-3.15134005]
curr_Stock_Price:  105.80894054375383
curr_Factors:  [1.05808941e+02 3.63764856e-02]
mat_Sqrt:  [[ 2.01805378e+01  0.00000000e+00]
 [-7.62904824e-03  1.74803455e-02]]
grads:  [-5.0884460e-03  8.0913133e+00]
Stock Position:  -0.005088446003172926
Bond Position:  [-2.61293697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.16242264]
Stock Price:  107.92274000653907
PL:  [-11.08516265]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.17635824e-01  7.89913426e-01]
 [-1.74389880e-01 -7.11890783e-02]
 [ 7.67065824e-01 -6.47471081e-01]
 [ 3.12328574e-03  2.42063978e-02]
 [ 2.21916962e-02 -5.52140057e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-4.00147335e-03  3.08853172e-01]
 [ 1.09148873e-01 -3.46572693e-02]
 [ 1.58158044e-01  7.26354886e-02]
 [ 2.59259025e-01 -1.06634165e-01]
 [ 1.22658063e-01  2.07771634e-01]
 [-7.35223143e-05  1.49962760e-01]
 [ 1.05853579e-01  5.94383044e-02]
 [-1.76206293e-01 -2.15178934e-01]
 [ 8.48995058e-02  2.29227917e-01]
 [ 4.93353300e-02  1.14197350e-02]
 [ 2.13344195e-02 -4.43366612e-02]
 [ 2.42887975e-02  5.42481142e-02]
 [ 8.35498682e-03  4.97216827e-02]
 [ 2.79682626e-01 -1.11397947e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-1.21708901e-02  1.36453232e-01]
 [-1.89693643e-02 -6.02909603e-02]
 [ 2.56794771e-02 -1.20361070e-01]
 [ 6.85387555e-02  2.49165157e-01]
 [-5.56295698e-03  1.32902267e-01]
 [ 1.49702097e-02  1.59754853e-01]
 [-1.41342539e-01  4.94466999e-02]
 [-6.67567139e-01  1.59761209e-01]
 [ 2.96417521e-01  1.02718460e-01]
 [-1.90951935e+00 -2.14054909e-01]
 [ 4.16396336e-01  7.57475317e-01]
 [ 8.56841392e-02 -1.60418499e-01]
 [ 1.79305020e-01 -2.73026171e-02]
 [ 3.84074368e-02  1.80516043e-01]
 [-2.61778990e+00  2.92079158e-01]
 [-1.78045923e-01  1.68250942e-02]
 [-1.32192061e-01 -4.29834095e-01]
 [ 2.15615946e+00 -1.66010847e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.07210374]
curr_Stock_Price:  101.41041642206785
curr_Factors:  [1.01410416e+02 3.94507711e-02]
mat_Sqrt:  [[ 2.01423582e+01  0.00000000e+00]
 [-7.94488727e-03  1.82040237e-02]]
grads:  [3.78497046e-02 4.33922434e+01]
Stock Position:  0.03784970457571557
Bond Position:  [8.23374944]


portfolio before change:  [12.05725915]
curr_Stock_Price:  100.99102408652126
curr_Factors:  [1.00991024e+02 4.06277209e-02]
mat_Sqrt:  [[ 2.03560733e+01  0.00000000e+00]
 [-8.06252773e-03  1.84735718e-02]]
grads:  [-0.01009327 -3.8535633 ]
Stock Position:  -0.010093269839620606
Bond Position:  [13.0765888]


portfolio before change:  [12.06104286]
curr_Stock_Price:  100.77810653110414
curr_Factors:  [1.00778107e+02 3.91024367e-02]
mat_Sqrt:  [[ 1.99282015e+01  0.00000000e+00]
 [-7.90973443e-03  1.81234784e-02]]
grads:  [ 2.43115907e-02 -3.57255416e+01]
Stock Position:  0.02431159070676549
Bond Position:  [9.61096678]


portfolio before change:  [12.05747599]
curr_Stock_Price:  100.58197341309746
curr_Factors:  [1.00581973e+02 3.90681734e-02]
mat_Sqrt:  [[ 1.98807015e+01  0.00000000e+00]
 [-7.90626823e-03  1.81155363e-02]]
grads:  [6.88498031e-04 1.33622308e+00]
Stock Position:  0.0006884980310598701
Bond Position:  [11.9882255]


portfolio before change:  [12.058123]
curr_Stock_Price:  99.34504763812481
curr_Factors:  [9.93450476e+01 3.98032140e-02]
mat_Sqrt:  [[ 1.98200750e+01  0.00000000e+00]
 [-7.98029714e-03  1.82851579e-02]]
grads:  [ 0.00099808 -0.30196078]
Stock Position:  0.000998076919969813
Bond Position:  [11.958969]


portfolio before change:  [12.06047586]
curr_Stock_Price:  100.20459768762409
curr_Factors:  [1.00204598e+02 3.94399703e-02]
mat_Sqrt:  [[ 1.99001311e+01  0.00000000e+00]
 [-7.94379963e-03  1.82015315e-02]]
grads:  [-0.00595075 -3.64348065]
Stock Position:  -0.005950753329706058
Bond Position:  [12.6567687]


portfolio before change:  [12.06107594]
curr_Stock_Price:  100.36963781762441
curr_Factors:  [1.00369638e+02 4.07752005e-02]
mat_Sqrt:  [[ 2.02675106e+01  0.00000000e+00]
 [-8.07714806e-03  1.85070712e-02]]
grads:  [6.45333827e-03 1.66883873e+01]
Stock Position:  0.006453338268570039
Bond Position:  [11.41335671]


portfolio before change:  [12.06010761]
curr_Stock_Price:  99.99849784162717
curr_Factors:  [9.99984978e+01 4.16733096e-02]
mat_Sqrt:  [[ 2.04137350e+01  0.00000000e+00]
 [-8.16561665e-03  1.87097782e-02]]
grads:  [ 0.00460588 -1.85236131]
Stock Position:  0.0046058793680708605
Bond Position:  [11.59952659]


portfolio before change:  [12.05975426]
curr_Stock_Price:  99.60695924974904
curr_Factors:  [9.96069592e+01 4.18196932e-02]
mat_Sqrt:  [[ 2.03694876e+01  0.00000000e+00]
 [-8.17994554e-03  1.87426098e-02]]
grads:  [0.00932074 3.8754202 ]
Stock Position:  0.009320743563802218
Bond Position:  [11.13134333]


portfolio before change:  [12.06119925]
curr_Stock_Price:  99.6126980324635
curr_Factors:  [9.96126980e+01 4.20897044e-02]
mat_Sqrt:  [[ 2.04363175e+01  0.00000000e+00]
 [-8.20631020e-03  1.88030188e-02]]
grads:  [ 0.01040892 -5.67111943]
Stock Position:  0.01040892324641087
Bond Position:  [11.02433832]


portfolio before change:  [12.05067893]
curr_Stock_Price:  98.46959724852
curr_Factors:  [9.84695972e+01 4.34395350e-02]
mat_Sqrt:  [[ 2.05231843e+01  0.00000000e+00]
 [-8.33686128e-03  1.91021489e-02]]
grads:  [1.03949287e-02 1.08768723e+01]
Stock Position:  0.010394928733849751
Bond Position:  [11.02709449]


portfolio before change:  [12.05752466]
curr_Stock_Price:  98.99555078152132
curr_Factors:  [9.89955508e+01 4.17455393e-02]
mat_Sqrt:  [[ 2.02264989e+01  0.00000000e+00]
 [-8.17269007e-03  1.87259854e-02]]
grads:  [3.23217539e-03 8.00827067e+00]
Stock Position:  0.003232175390464598
Bond Position:  [11.73755367]


portfolio before change:  [12.0587803]
curr_Stock_Price:  98.93006991917692
curr_Factors:  [9.89300699e+01 4.24250116e-02]
mat_Sqrt:  [[ 2.03769557e+01  0.00000000e+00]
 [-8.23893309e-03  1.88777673e-02]]
grads:  [0.00646782 3.14858762]
Stock Position:  0.006467824933839217
Bond Position:  [11.41891792]


portfolio before change:  [12.04996438]
curr_Stock_Price:  97.34632757347528
curr_Factors:  [9.73463276e+01 4.27800882e-02]
mat_Sqrt:  [[ 2.01344796e+01  0.00000000e+00]
 [-8.27333918e-03  1.89566015e-02]]
grads:  [ -0.0134157  -11.35113453]
Stock Position:  -0.013415697040877039
Bond Position:  [13.35593322]


portfolio before change:  [12.03569483]
curr_Stock_Price:  98.53442432180496
curr_Factors:  [9.85344243e+01 4.23948262e-02]
mat_Sqrt:  [[ 2.02882418e+01  0.00000000e+00]
 [-8.23600157e-03  1.88710503e-02]]
grads:  [9.11576135e-03 1.21470673e+01]
Stock Position:  0.009115761350745537
Bond Position:  [11.13747853]


portfolio before change:  [12.0277329]
curr_Stock_Price:  97.50826739528036
curr_Factors:  [9.75082674e+01 4.29210386e-02]
mat_Sqrt:  [[ 2.02011713e+01  0.00000000e+00]
 [-8.28695733e-03  1.89878046e-02]]
grads:  [0.00268892 0.60142471]
Stock Position:  0.0026889188838596484
Bond Position:  [11.76554108]


portfolio before change:  [12.02852787]
curr_Stock_Price:  97.25693348580302
curr_Factors:  [9.72569335e+01 4.30481771e-02]
mat_Sqrt:  [[ 2.01789217e+01  0.00000000e+00]
 [-8.29922185e-03  1.90159062e-02]]
grads:  [ 9.83359834e-05 -2.33155658e+00]
Stock Position:  9.833598340327326e-05
Bond Position:  [12.01896401]


portfolio before change:  [12.03007444]
curr_Stock_Price:  97.70550151820358
curr_Factors:  [9.77055015e+01 4.15987435e-02]
mat_Sqrt:  [[ 1.99277894e+01  0.00000000e+00]
 [-8.15830801e-03  1.86930320e-02]]
grads:  [2.40692104e-03 2.90205004e+00]
Stock Position:  0.002406921038307899
Bond Position:  [11.79490502]


portfolio before change:  [12.02837963]
curr_Stock_Price:  96.38877173592101
curr_Factors:  [9.63887717e+01 4.32851103e-02]
mat_Sqrt:  [[ 2.00537553e+01  0.00000000e+00]
 [-8.32202959e-03  1.90681653e-02]]
grads:  [1.49873716e-03 2.60757561e+00]
Stock Position:  0.001498737160356462
Bond Position:  [11.8839182]


portfolio before change:  [12.02846883]
curr_Stock_Price:  95.45706554339006
curr_Factors:  [9.54570655e+01 4.34290118e-02]
mat_Sqrt:  [[ 1.98928979e+01  0.00000000e+00]
 [-8.33585142e-03  1.90998351e-02]]
grads:  [ 0.01161543 -5.83240361]
Stock Position:  0.011615430640117113
Bond Position:  [10.91969391]


portfolio before change:  [12.0275885]
curr_Stock_Price:  95.26375492317042
curr_Factors:  [9.52637549e+01 4.24861029e-02]
mat_Sqrt:  [[ 1.96359150e+01  0.00000000e+00]
 [-8.24486293e-03  1.88913542e-02]]
grads:  [ 0.00214549 -1.99975021]
Stock Position:  0.002145487518989043
Bond Position:  [11.8232013]


portfolio before change:  [12.02790492]
curr_Stock_Price:  94.72235226415123
curr_Factors:  [9.47223523e+01 4.33526692e-02]
mat_Sqrt:  [[ 1.97224287e+01  0.00000000e+00]
 [-8.32852152e-03  1.90830401e-02]]
grads:  [2.40245171e-03 7.15049756e+00]
Stock Position:  0.0024024517148547356
Bond Position:  [11.80033904]


portfolio before change:  [12.02776203]
curr_Stock_Price:  94.04886353479691
curr_Factors:  [9.40488635e+01 4.38168427e-02]
mat_Sqrt:  [[ 1.96867530e+01  0.00000000e+00]
 [-8.37298921e-03  1.91849284e-02]]
grads:  [-2.30015060e-03 -3.14262107e+00]
Stock Position:  -0.002300150597786739
Bond Position:  [12.24408858]


portfolio before change:  [12.031239]
curr_Stock_Price:  93.20267353159987
curr_Factors:  [9.32026735e+01 4.30789104e-02]
mat_Sqrt:  [[ 1.93446433e+01  0.00000000e+00]
 [-8.30218385e-03  1.90226930e-02]]
grads:  [-1.38800185e-03 -6.32723614e+00]
Stock Position:  -0.0013880018454705187
Bond Position:  [12.16060448]


portfolio before change:  [12.03593215]
curr_Stock_Price:  90.9166683526578
curr_Factors:  [9.09166684e+01 4.44422538e-02]
mat_Sqrt:  [[ 1.91664442e+01  0.00000000e+00]
 [-8.43253260e-03  1.93213595e-02]]
grads:  [9.24967319e-03 1.28958399e+01]
Stock Position:  0.009249673191569715
Bond Position:  [11.19498268]


portfolio before change:  [12.03212604]
curr_Stock_Price:  90.35388407491182
curr_Factors:  [9.03538841e+01 4.70286044e-02]
mat_Sqrt:  [[ 1.95942151e+01  0.00000000e+00]
 [-8.67443180e-03  1.98756202e-02]]
grads:  [2.67631785e-03 6.68669788e+00]
Stock Position:  0.002676317853027484
Bond Position:  [11.79031032]


portfolio before change:  [12.0342494]
curr_Stock_Price:  90.59656288250612
curr_Factors:  [9.05965629e+01 4.66861174e-02]
mat_Sqrt:  [[ 1.95751726e+01  0.00000000e+00]
 [-8.64278820e-03  1.98031156e-02]]
grads:  [4.32654902e-03 8.06715756e+00]
Stock Position:  0.00432654901962112
Bond Position:  [11.64227893]


portfolio before change:  [12.03188224]
curr_Stock_Price:  89.71305452553352
curr_Factors:  [8.97130545e+01 4.45393495e-02]
mat_Sqrt:  [[ 1.89333550e+01  0.00000000e+00]
 [-8.44173911e-03  1.93424542e-02]]
grads:  [-0.00632546  2.5563819 ]
Stock Position:  -0.0063254626220601295
Bond Position:  [12.59935881]


portfolio before change:  [12.03797725]
curr_Stock_Price:  88.9984833565049
curr_Factors:  [8.89984834e+01 4.45032277e-02]
mat_Sqrt:  [[ 1.87749315e+01  0.00000000e+00]
 [-8.43831525e-03  1.93346092e-02]]
grads:  [-0.03184255  8.26296554]
Stock Position:  -0.03184254663195859
Bond Position:  [14.8719156]


portfolio before change:  [12.06895872]
curr_Stock_Price:  88.08390934027072
curr_Factors:  [8.80839093e+01 4.42518973e-02]
mat_Sqrt:  [[ 1.85294500e+01  0.00000000e+00]
 [-8.41445398e-03  1.92799361e-02]]
grads:  [0.0184165 5.3277386]
Stock Position:  0.018416495455885584
Bond Position:  [10.4467618]


portfolio before change:  [12.06207474]
curr_Stock_Price:  87.63920417952737
curr_Factors:  [8.76392042e+01 4.36323716e-02]
mat_Sqrt:  [[ 1.83063952e+01  0.00000000e+00]
 [-8.35534527e-03  1.91445011e-02]]
grads:  [ -0.10941207 -11.18101264]
Stock Position:  -0.10941206828986896
Bond Position:  [21.65086133]


portfolio before change:  [12.17718478]
curr_Stock_Price:  86.61186301901755
curr_Factors:  [8.66118630e+01 4.25176041e-02]
mat_Sqrt:  [[ 1.78591906e+01  0.00000000e+00]
 [-8.24791893e-03  1.88983564e-02]]
grads:  [ 0.0418264  40.08154467]
Stock Position:  0.04182640094971685
Bond Position:  [8.55452227]


portfolio before change:  [12.20471767]
curr_Stock_Price:  87.24456151296053
curr_Factors:  [8.72445615e+01 4.19134189e-02]
mat_Sqrt:  [[ 1.78613758e+01  0.00000000e+00]
 [-8.18910681e-03  1.87636009e-02]]
grads:  [ 8.77410920e-04 -8.54945169e+00]
Stock Position:  0.0008774109198436233
Bond Position:  [12.12816834]


portfolio before change:  [12.20686637]
curr_Stock_Price:  87.96552877151531
curr_Factors:  [8.79655288e+01 3.98800387e-02]
mat_Sqrt:  [[ 1.75667048e+01  0.00000000e+00]
 [-7.98799486e-03  1.83027955e-02]]
grads:  [ 0.00952878 -1.49171841]
Stock Position:  0.009528775202751515
Bond Position:  [11.36866262]


portfolio before change:  [12.19743215]
curr_Stock_Price:  86.82630678984508
curr_Factors:  [8.68263068e+01 4.11940627e-02]
mat_Sqrt:  [[ 1.76225455e+01  0.00000000e+00]
 [-8.11852821e-03  1.86018850e-02]]
grads:  [6.65006634e-03 9.70418011e+00]
Stock Position:  0.006650066336246134
Bond Position:  [11.62003145]


portfolio before change:  [12.20846515]
curr_Stock_Price:  88.26695554130437
curr_Factors:  [8.82669555e+01 4.17447538e-02]
mat_Sqrt:  [[ 1.80342921e+01  0.00000000e+00]
 [-8.17261317e-03  1.87258092e-02]]
grads:  [-0.13808782 15.5976788 ]
Stock Position:  -0.1380878216173514
Bond Position:  [24.39705676]


portfolio before change:  [12.31765617]
curr_Stock_Price:  87.49830558777442
curr_Factors:  [8.74983056e+01 4.14566207e-02]
mat_Sqrt:  [[ 1.78154416e+01  0.00000000e+00]
 [-8.14435959e-03  1.86610722e-02]]
grads:  [-0.00958174  0.90161455]
Stock Position:  -0.00958173550881481
Bond Position:  [13.1560418]


portfolio before change:  [12.32252806]
curr_Stock_Price:  87.16149027884663
curr_Factors:  [8.71614903e+01 4.26969076e-02]
mat_Sqrt:  [[ 1.80103792e+01  0.00000000e+00]
 [-8.26529201e-03  1.89381631e-02]]
grads:  [-1.77557083e-02 -2.26967152e+01]
Stock Position:  -0.017755708309263672
Bond Position:  [13.87014205]


portfolio before change:  [12.35892095]
curr_Stock_Price:  85.20949724203625
curr_Factors:  [8.52094972e+01 4.27852343e-02]
mat_Sqrt:  [[ 1.76252368e+01  0.00000000e+00]
 [-8.27383677e-03  1.89577416e-02]]
grads:  [ 0.11822289 -8.75688942]
Stock Position:  0.11822288767986644
Bond Position:  [2.28520813]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.32901293]
Stock Price:  84.95410093766252
PL:  [12.32901293]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.10878140e-01  3.97709848e-01]
 [-2.62004510e-01 -6.07150681e-02]
 [ 8.47561424e-01 -7.12796445e-01]
 [ 2.24957131e-02  2.30363541e-02]
 [-5.55621973e-02  2.55964743e-02]
 [-5.15586753e-02 -4.76418896e-02]
 [-3.35525782e-04  3.21265857e-01]
 [ 1.52073664e-01 -2.35852895e-02]
 [ 1.29782275e-01  8.16598911e-02]
 [ 3.24199649e-01 -1.53916220e-01]
 [ 7.17753148e-02  2.73435443e-02]
 [-1.52201166e-01 -1.42849014e-01]
 [-1.46775000e-01  1.50565925e-01]
 [-3.82019000e-01 -5.04208841e-01]
 [ 7.60151679e-02  2.20698738e-01]
 [ 5.38589393e-02 -2.03143945e-02]
 [-5.01479406e-02  1.62455006e-01]
 [-3.62291949e-02  2.56480246e-02]
 [ 1.57173482e-02  4.55419238e-02]
 [ 2.15315823e-01 -1.07432671e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 8.80641379e-02  2.72500934e-01]
 [ 3.86458016e-02  4.14909078e-01]
 [ 4.12198955e-02  1.71052686e-01]
 [ 2.95214059e-02  6.67742215e-02]
 [ 6.18979239e-01 -1.85074080e-01]
 [-2.25636611e-02  1.67949803e-01]
 [-2.06907457e-01  1.46796159e-01]
 [ 6.10819774e-03 -1.39966727e-01]
 [ 1.01686612e-01 -7.00875649e-02]
 [-7.48912785e-01 -9.40969031e-02]
 [-1.18178818e-01  9.45163401e-03]
 [ 1.11075029e-02 -9.20268170e-02]
 [ 1.28752104e-01  7.78678808e-02]
 [-2.02265282e-01  1.32552141e-02]
 [-6.10080490e-01 -2.91778875e-01]
 [-4.03472140e-02  3.06339957e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.09729802e-01  8.97787031e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.34185556]
curr_Stock_Price:  100.24611592840633
curr_Factors:  [1.00246116e+02 4.01825561e-02]
mat_Sqrt:  [[ 2.00949224e+01  0.00000000e+00]
 [-8.01823482e-03  1.83720840e-02]]
grads:  [1.41554638e-02 2.16475087e+01]
Stock Position:  0.014155463818579324
Bond Position:  [2.92282529]


portfolio before change:  [4.37122338]
curr_Stock_Price:  102.29496788661869
curr_Factors:  [1.02294968e+02 4.01372550e-02]
mat_Sqrt:  [[ 2.04940647e+01  0.00000000e+00]
 [-8.01371374e-03  1.83617249e-02]]
grads:  [-0.01407738 -3.30661027]
Stock Position:  -0.014077380053580047
Bond Position:  [5.81126852]


portfolio before change:  [4.37217543]
curr_Stock_Price:  102.27894263382997
curr_Factors:  [1.02278943e+02 4.03957460e-02]
mat_Sqrt:  [[ 2.05567307e+01  0.00000000e+00]
 [-8.03947720e-03  1.84207564e-02]]
grads:  [ 2.60971241e-02 -3.86952864e+01]
Stock Position:  0.026097124087166523
Bond Position:  [1.70298917]


portfolio before change:  [4.3385597]
curr_Stock_Price:  100.98268403970532
curr_Factors:  [1.00982684e+02 4.08421579e-02]
mat_Sqrt:  [[ 2.04080378e+01  0.00000000e+00]
 [-8.08377712e-03  1.85222603e-02]]
grads:  [0.00159494 1.24371182]
Stock Position:  0.001594940316786483
Bond Position:  [4.17749834]


portfolio before change:  [4.33821085]
curr_Stock_Price:  100.43653866779509
curr_Factors:  [1.00436539e+02 4.02795570e-02]
mat_Sqrt:  [[ 2.01573799e+01  0.00000000e+00]
 [-8.02790703e-03  1.83942458e-02]]
grads:  [-0.00220222  1.39154791]
Stock Position:  -0.002202219752273925
Bond Position:  [4.55939418]


portfolio before change:  [4.33740717]
curr_Stock_Price:  101.0602907203933
curr_Factors:  [1.01060291e+02 4.06453565e-02]
mat_Sqrt:  [[ 2.03744555e+01  0.00000000e+00]
 [-8.06427742e-03  1.84775809e-02]]
grads:  [-0.00355108 -2.57836185]
Stock Position:  -0.0035510789702587336
Bond Position:  [4.69628024]


portfolio before change:  [4.33873591]
curr_Stock_Price:  100.85143246557763
curr_Factors:  [1.00851432e+02 4.28753751e-02]
mat_Sqrt:  [[ 2.08826706e+01  0.00000000e+00]
 [-8.28254792e-03  1.89777014e-02]]
grads:  [6.69820408e-03 1.69285969e+01]
Stock Position:  0.006698204081359717
Bond Position:  [3.66321243]


portfolio before change:  [4.33510374]
curr_Stock_Price:  100.24080578537009
curr_Factors:  [1.00240806e+02 4.42139512e-02]
mat_Sqrt:  [[ 2.10777482e+01  0.00000000e+00]
 [-8.41084549e-03  1.92716681e-02]]
grads:  [ 0.00672653 -1.22383228]
Stock Position:  0.006726534457214654
Bond Position:  [3.6608305]


portfolio before change:  [4.34168425]
curr_Stock_Price:  101.15106407607489
curr_Factors:  [1.01151064e+02 4.35863402e-02]
mat_Sqrt:  [[ 2.11176534e+01  0.00000000e+00]
 [-8.35093673e-03  1.91343999e-02]]
grads:  [0.00783333 4.26770067]
Stock Position:  0.007833331207256924
Bond Position:  [3.54933447]


portfolio before change:  [4.34304472]
curr_Stock_Price:  101.26809888852321
curr_Factors:  [1.01268099e+02 4.39489837e-02]
mat_Sqrt:  [[ 2.12298573e+01  0.00000000e+00]
 [-8.38560516e-03  1.92138352e-02]]
grads:  [ 0.01210677 -8.01069743]
Stock Position:  0.012106774895018602
Bond Position:  [3.11701464]


portfolio before change:  [4.33634506]
curr_Stock_Price:  100.68253279021161
curr_Factors:  [1.00682533e+02 4.52802149e-02]
mat_Sqrt:  [[ 2.14243854e+01  0.00000000e+00]
 [-8.51165929e-03  1.95026615e-02]]
grads:  [0.00390718 1.40204168]
Stock Position:  0.003907184005516613
Bond Position:  [3.94295987]


portfolio before change:  [4.33959765]
curr_Stock_Price:  101.38884619455152
curr_Factors:  [1.01388846e+02 4.72446377e-02]
mat_Sqrt:  [[ 2.20377089e+01  0.00000000e+00]
 [-8.69433266e-03  1.99212188e-02]]
grads:  [-0.00973539 -7.17069654]
Stock Position:  -0.009735385278903592
Bond Position:  [5.32665713]


portfolio before change:  [4.33975437]
curr_Stock_Price:  101.44114544304306
curr_Factors:  [1.01441145e+02 4.83655136e-02]
mat_Sqrt:  [[ 2.23090998e+01  0.00000000e+00]
 [-8.79686431e-03  2.01561483e-02]]
grads:  [-3.63361337e-03  7.46997505e+00]
Stock Position:  -0.00363361337330513
Bond Position:  [4.70835228]


portfolio before change:  [4.34477409]
curr_Stock_Price:  100.22166050562531
curr_Factors:  [1.00221661e+02 4.87240670e-02]
mat_Sqrt:  [[ 2.21224570e+01  0.00000000e+00]
 [-8.82941148e-03  2.02307232e-02]]
grads:  [ -0.0272155  -24.92292714]
Stock Position:  -0.027215502295493736
Bond Position:  [7.07235692]


portfolio before change:  [4.33011063]
curr_Stock_Price:  100.79293658319521
curr_Factors:  [1.00792937e+02 4.96916166e-02]
mat_Sqrt:  [[ 2.24683749e+01  0.00000000e+00]
 [-8.91664659e-03  2.04306040e-02]]
grads:  [7.67015838e-03 1.08023599e+01]
Stock Position:  0.007670158380609714
Bond Position:  [3.55701284]


portfolio before change:  [4.32858743]
curr_Stock_Price:  100.53637703944811
curr_Factors:  [1.00536377e+02 4.87488839e-02]
mat_Sqrt:  [[ 2.21975769e+01  0.00000000e+00]
 [-8.83165977e-03  2.02358747e-02]]
grads:  [ 0.00202693 -1.00388023]
Stock Position:  0.0020269334296615644
Bond Position:  [4.12480688]


portfolio before change:  [4.32694255]
curr_Stock_Price:  99.47047600602255
curr_Factors:  [9.94704760e+01 5.06263082e-02]
mat_Sqrt:  [[ 2.23811463e+01  0.00000000e+00]
 [-9.00011628e-03  2.06218571e-02]]
grads:  [9.27264250e-04 7.87780682e+00]
Stock Position:  0.0009272642496658645
Bond Position:  [4.23470713]


portfolio before change:  [4.327335]
curr_Stock_Price:  99.32281157665908
curr_Factors:  [9.93228116e+01 5.09031902e-02]
mat_Sqrt:  [[ 2.24089499e+01  0.00000000e+00]
 [-9.02469414e-03  2.06781720e-02]]
grads:  [-1.11720894e-03  1.24034294e+00]
Stock Position:  -0.0011172089439651486
Bond Position:  [4.43829933]


portfolio before change:  [4.32948711]
curr_Stock_Price:  97.89309926570527
curr_Factors:  [9.78930993e+01 5.17313678e-02]
mat_Sqrt:  [[ 2.22653260e+01  0.00000000e+00]
 [-9.09781229e-03  2.08457067e-02]]
grads:  [1.59860553e-03 2.18471479e+00]
Stock Position:  0.001598605526061205
Bond Position:  [4.17299466]


portfolio before change:  [4.32758908]
curr_Stock_Price:  96.37947657509415
curr_Factors:  [9.63794766e+01 5.08009010e-02]
mat_Sqrt:  [[ 2.17230234e+01  0.00000000e+00]
 [-9.01562209e-03  2.06573853e-02]]
grads:  [ 0.00775345 -5.20069068]
Stock Position:  0.007753449311370328
Bond Position:  [3.58031569]


portfolio before change:  [4.33941531]
curr_Stock_Price:  97.8470384355211
curr_Factors:  [9.78470384e+01 5.12787874e-02]
mat_Sqrt:  [[ 2.21572858e+01  0.00000000e+00]
 [-9.05792801e-03  2.07543204e-02]]
grads:  [ 0.00190134 -1.82024701]
Stock Position:  0.0019013434716994842
Bond Position:  [4.15337449]


portfolio before change:  [4.34016024]
curr_Stock_Price:  97.96575607205298
curr_Factors:  [9.79657561e+01 5.12009848e-02]
mat_Sqrt:  [[ 2.21673333e+01  0.00000000e+00]
 [-9.05105385e-03  2.07385697e-02]]
grads:  [9.33776258e-03 1.31398133e+01]
Stock Position:  0.009337762578854884
Bond Position:  [3.42537927]


portfolio before change:  [4.37050793]
curr_Stock_Price:  101.16989533453734
curr_Factors:  [1.01169895e+02 4.95951984e-02]
mat_Sqrt:  [[ 2.25305149e+01  0.00000000e+00]
 [-8.90799178e-03  2.04107733e-02]]
grads:  [9.75241667e-03 2.03279451e+01]
Stock Position:  0.009752416672072944
Bond Position:  [3.38385696]


portfolio before change:  [4.38316155]
curr_Stock_Price:  102.42400616319962
curr_Factors:  [1.02424006e+02 4.81318662e-02]
mat_Sqrt:  [[ 2.24707780e+01  0.00000000e+00]
 [-8.77559034e-03  2.01074035e-02]]
grads:  [5.15662644e-03 8.50695047e+00]
Stock Position:  0.005156626441743439
Bond Position:  [3.85499921]


portfolio before change:  [4.37717801]
curr_Stock_Price:  101.1701933788736
curr_Factors:  [1.01170193e+02 4.77848314e-02]
mat_Sqrt:  [[ 2.21155431e+01  0.00000000e+00]
 [-8.74389675e-03  2.00347844e-02]]
grads:  [2.65261699e-03 3.33291441e+00]
Stock Position:  0.0026526169888140085
Bond Position:  [4.10881224]


portfolio before change:  [4.37531305]
curr_Stock_Price:  100.27349592936338
curr_Factors:  [1.00273496e+02 4.78546404e-02]
mat_Sqrt:  [[ 2.19355327e+01  0.00000000e+00]
 [-8.75028140e-03  2.00494134e-02]]
grads:  [ 0.02453582 -9.23089746]
Stock Position:  0.024535820366532613
Bond Position:  [1.91502057]


portfolio before change:  [4.34366532]
curr_Stock_Price:  98.97388098113721
curr_Factors:  [9.89738810e+01 4.88580446e-02]
mat_Sqrt:  [[ 2.18770440e+01  0.00000000e+00]
 [-8.84154236e-03  2.02585186e-02]]
grads:  [2.31912695e-03 8.29032996e+00]
Stock Position:  0.0023191269517664477
Bond Position:  [4.11413233]


portfolio before change:  [4.34428249]
curr_Stock_Price:  99.01823507502023
curr_Factors:  [9.90182351e+01 4.81653843e-02]
mat_Sqrt:  [[ 2.17311493e+01  0.00000000e+00]
 [-8.77864539e-03  2.01144035e-02]]
grads:  [-6.57306976e-03  7.29806175e+00]
Stock Position:  -0.006573069755653862
Bond Position:  [4.99513625]


portfolio before change:  [4.34126269]
curr_Stock_Price:  99.57265302654785
curr_Factors:  [9.95726530e+01 4.86852578e-02]
mat_Sqrt:  [[ 2.19704431e+01  0.00000000e+00]
 [-8.82589443e-03  2.02226646e-02]]
grads:  [-2.50237511e-03 -6.92128011e+00]
Stock Position:  -0.002502375106027021
Bond Position:  [4.59043082]


portfolio before change:  [4.34723989]
curr_Stock_Price:  97.41335854227908
curr_Factors:  [9.74133585e+01 4.88602438e-02]
mat_Sqrt:  [[ 2.15325930e+01  0.00000000e+00]
 [-8.84174135e-03  2.02589745e-02]]
grads:  [ 3.30187316e-03 -3.45958108e+00]
Stock Position:  0.0033018731564207634
Bond Position:  [4.02559334]


portfolio before change:  [4.35318733]
curr_Stock_Price:  99.06218149143898
curr_Factors:  [9.90621815e+01 4.62138608e-02]
mat_Sqrt:  [[ 2.12958026e+01  0.00000000e+00]
 [-8.59896373e-03  1.97027011e-02]]
grads:  [-0.03709557 -4.77583772]
Stock Position:  -0.03709557482665017
Bond Position:  [8.02795589]


portfolio before change:  [4.3812676]
curr_Stock_Price:  98.33226392758459
curr_Factors:  [9.83322639e+01 4.57448419e-02]
mat_Sqrt:  [[ 2.10313477e+01  0.00000000e+00]
 [-8.55521753e-03  1.96024660e-02]]
grads:  [-0.00542304  0.48216556]
Stock Position:  -0.005423037457992673
Bond Position:  [4.91452715]


portfolio before change:  [4.37858299]
curr_Stock_Price:  98.94058787483158
curr_Factors:  [9.89405879e+01 4.56443792e-02]
mat_Sqrt:  [[ 2.11382066e+01  0.00000000e+00]
 [-8.54581809e-03  1.95809291e-02]]
grads:  [-1.37458647e-03 -4.69981871e+00]
Stock Position:  -0.001374586468121608
Bond Position:  [4.51458538]


portfolio before change:  [4.3772717]
curr_Stock_Price:  100.3051043381362
curr_Factors:  [1.00305104e+02 4.54283467e-02]
mat_Sqrt:  [[ 2.13789563e+01  0.00000000e+00]
 [-8.52557064e-03  1.95345364e-02]]
grads:  [0.00761199 3.98616477]
Stock Position:  0.00761199148148828
Bond Position:  [3.6137501]


portfolio before change:  [4.37045161]
curr_Stock_Price:  99.34979143644624
curr_Factors:  [9.93497914e+01 4.43992422e-02]
mat_Sqrt:  [[ 2.09341214e+01  0.00000000e+00]
 [-8.42845107e-03  1.93120075e-02]]
grads:  [-0.00938565  0.68637163]
Stock Position:  -0.009385645018600765
Bond Position:  [5.30291349]


portfolio before change:  [4.37832558]
curr_Stock_Price:  98.58148443453385
curr_Factors:  [9.85814844e+01 4.39558507e-02]
mat_Sqrt:  [[ 2.06682496e+01  0.00000000e+00]
 [-8.38626025e-03  1.92153362e-02]]
grads:  [ -0.03567904 -15.1846875 ]
Stock Position:  -0.03567903645712566
Bond Position:  [7.89561795]


portfolio before change:  [4.36203731]
curr_Stock_Price:  99.06567020405197
curr_Factors:  [9.90656702e+01 4.48890187e-02]
mat_Sqrt:  [[ 2.09890720e+01  0.00000000e+00]
 [-8.47481150e-03  1.94182326e-02]]
grads:  [4.44757654e-03 1.57758929e+01]
Stock Position:  0.004447576541732678
Bond Position:  [3.92143516]


portfolio before change:  [4.35779229]
curr_Stock_Price:  98.00099519155417
curr_Factors:  [9.80009952e+01 4.61779527e-02]
mat_Sqrt:  [[ 2.10594887e+01  0.00000000e+00]
 [-8.59562239e-03  1.96950451e-02]]
grads:  [-4.18743382e-03  5.55275521e+00]
Stock Position:  -0.0041874338242088175
Bond Position:  [4.76816498]


portfolio before change:  [4.36252468]
curr_Stock_Price:  97.01320084879467
curr_Factors:  [9.70132008e+01 4.52202705e-02]
mat_Sqrt:  [[ 2.06299137e+01  0.00000000e+00]
 [-8.50602333e-03  1.94897479e-02]]
grads:  [0.03944021 0.46064579]
Stock Position:  0.039440206876253714
Bond Position:  [0.53630396]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.35926366]
Stock Price:  96.92881845404722
PL:  [4.35926366]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 5.15575091e-01  9.51600782e-01]
 [-2.02494305e-01 -7.58503443e-02]
 [ 8.28549773e-01 -6.89295060e-01]
 [-6.76812539e-02  1.04115042e-02]
 [-1.78766192e-01  7.49039278e-02]
 [-3.27098490e-02 -1.84722684e-02]
 [ 1.07560949e-02  3.07226746e-01]
 [ 2.95866771e-01 -3.51293845e-03]
 [ 1.24618228e-01  8.33022232e-02]
 [ 3.91898943e-01 -2.18982807e-01]
 [ 6.26840703e-02 -4.10398719e-03]
 [-8.41560546e-02 -1.72532522e-01]
 [-1.89532335e-01  1.63737609e-01]
 [-6.54850672e-01 -8.46326977e-01]
 [-1.83872796e-03 -1.27129731e-01]
 [ 7.14236882e-03 -1.64690794e-01]
 [-5.28900100e-02  2.66126817e-01]
 [ 8.19232002e-02  1.49466222e-01]
 [ 1.63534538e-02  2.97473260e-02]
 [-1.05901624e-01 -3.12710820e-02]
 [ 2.21120411e-01  3.10929042e-01]
 [ 2.78785281e-02  2.36936724e-02]
 [-8.35947943e-03  1.41060152e-01]
 [ 4.78685570e-02  1.73371053e-01]
 [ 5.15151831e-02  1.11194940e-01]
 [ 7.51891006e-01 -4.73492427e-01]
 [-3.53841787e-01  4.54937071e-01]
 [ 9.13771388e-02  1.62589319e-02]
 [ 3.05216912e-02 -1.33656497e-01]
 [-6.55138262e-02 -3.12053098e-02]
 [-5.36006100e-01 -1.02727502e-01]
 [-1.17944645e-01  3.61013845e-04]
 [ 1.23218374e-01  9.24479723e-02]
 [ 1.96099201e-01  4.33158476e-02]
 [-2.46237369e-01 -1.98954999e-01]
 [ 1.57421250e-01 -1.54830858e-01]
 [-1.71321247e-01  2.06442740e-01]
 [-1.17574815e-01  1.21734161e-01]
 [-1.20574810e-01  1.30359488e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.82808706]
curr_Stock_Price:  101.97612830167347
curr_Factors:  [1.01976128e+02 3.88804191e-02]
mat_Sqrt:  [[ 2.01077737e+01  0.00000000e+00]
 [-7.88724734e-03  1.80719540e-02]]
grads:  [4.62949174e-02 5.26562199e+01]
Stock Position:  0.04629491740031598
Bond Position:  [11.10711062]


portfolio before change:  [15.81011921]
curr_Stock_Price:  101.55801922829217
curr_Factors:  [1.01558019e+02 3.89421561e-02]
mat_Sqrt:  [[ 2.00412229e+01  0.00000000e+00]
 [-7.89350681e-03  1.80862962e-02]]
grads:  [-0.01175568 -4.19380194]
Stock Position:  -0.011755675312932446
Bond Position:  [17.00400231]


portfolio before change:  [15.8067833]
curr_Stock_Price:  102.02260651831534
curr_Factors:  [1.02022607e+02 3.75173116e-02]
mat_Sqrt:  [[ 1.97611525e+01  0.00000000e+00]
 [-7.74775442e-03  1.77523355e-02]]
grads:  [ 2.67047555e-02 -3.88284154e+01]
Stock Position:  0.026704755486537488
Bond Position:  [13.08229454]


portfolio before change:  [15.82597108]
curr_Stock_Price:  102.67988232348391
curr_Factors:  [1.02679882e+02 3.84631527e-02]
mat_Sqrt:  [[ 2.01376043e+01  0.00000000e+00]
 [-7.84481003e-03  1.79747179e-02]]
grads:  [-0.00313529  0.57923047]
Stock Position:  -0.0031352935586919017
Bond Position:  [16.14790266]


portfolio before change:  [15.82556765]
curr_Stock_Price:  103.4523906779401
curr_Factors:  [1.03452391e+02 3.68317537e-02]
mat_Sqrt:  [[ 1.98541697e+01  0.00000000e+00]
 [-7.67664027e-03  1.75893926e-02]]
grads:  [-0.00735742  4.25847155]
Stock Position:  -0.007357418603441447
Bond Position:  [16.5867102]


portfolio before change:  [15.84334012]
curr_Stock_Price:  101.31862613094506
curr_Factors:  [1.01318626e+02 3.68223760e-02]
mat_Sqrt:  [[ 1.94421906e+01  0.00000000e+00]
 [-7.67566294e-03  1.75871532e-02]]
grads:  [-0.00209708 -1.05032737]
Stock Position:  -0.0020970789118087076
Bond Position:  [16.05581328]


portfolio before change:  [15.84519112]
curr_Stock_Price:  101.39306300010463
curr_Factors:  [1.01393063e+02 3.69246055e-02]
mat_Sqrt:  [[ 1.94834641e+01  0.00000000e+00]
 [-7.68631048e-03  1.76115498e-02]]
grads:  [7.43403940e-03 1.74446173e+01]
Stock Position:  0.007434039399444338
Bond Position:  [15.0914311]


portfolio before change:  [15.85387222]
curr_Stock_Price:  102.30704063043515
curr_Factors:  [1.02307041e+02 3.70642531e-02]
mat_Sqrt:  [[ 1.96962319e+01  0.00000000e+00]
 [-7.70083145e-03  1.76448215e-02]]
grads:  [ 0.01494365 -0.19909175]
Stock Position:  0.014943650172878221
Bond Position:  [14.32503159]


portfolio before change:  [15.84192874]
curr_Stock_Price:  101.38797318638738
curr_Factors:  [1.01387973e+02 3.86974097e-02]
mat_Sqrt:  [[ 1.99446945e+01  0.00000000e+00]
 [-7.86866288e-03  1.80293716e-02]]
grads:  [0.00807103 4.62036198]
Stock Position:  0.008071033569352248
Bond Position:  [15.023623]


portfolio before change:  [15.85234023]
curr_Stock_Price:  102.44526316081893
curr_Factors:  [1.02445263e+02 3.72753610e-02]
mat_Sqrt:  [[ 1.97789308e+01  0.00000000e+00]
 [-7.72273123e-03  1.76950002e-02]]
grads:  [  0.01498195 -12.37540574]
Stock Position:  0.014981952934529471
Bond Position:  [14.31751012]


portfolio before change:  [15.8573968]
curr_Stock_Price:  102.6633105505749
curr_Factors:  [1.02663311e+02 3.78263890e-02]
mat_Sqrt:  [[ 1.99669949e+01  0.00000000e+00]
 [-7.77960297e-03  1.78253097e-02]]
grads:  [ 0.00304968 -0.23023371]
Stock Position:  0.0030496799252021775
Bond Position:  [15.54430657]


portfolio before change:  [15.8617015]
curr_Stock_Price:  103.43766721972088
curr_Factors:  [1.03437667e+02 3.88787464e-02]
mat_Sqrt:  [[ 2.03955229e+01  0.00000000e+00]
 [-7.88707767e-03  1.80715652e-02]]
grads:  [-7.81815799e-03 -9.54718197e+00]
Stock Position:  -0.007818157994566206
Bond Position:  [16.67039353]


portfolio before change:  [15.86378308]
curr_Stock_Price:  103.4379679704191
curr_Factors:  [1.03437968e+02 3.86593376e-02]
mat_Sqrt:  [[ 2.03379504e+01  0.00000000e+00]
 [-7.86479117e-03  1.80205004e-02]]
grads:  [-5.80547112e-03  9.08618548e+00]
Stock Position:  -0.005805471116734697
Bond Position:  [16.46428922]


portfolio before change:  [15.86587378]
curr_Stock_Price:  103.43236373142982
curr_Factors:  [1.03432364e+02 3.99070276e-02]
mat_Sqrt:  [[ 2.06624179e+01  0.00000000e+00]
 [-7.99069735e-03  1.83089877e-02]]
grads:  [ -0.04956913 -46.22467334]
Stock Position:  -0.049569128517913986
Bond Position:  [20.99292591]


portfolio before change:  [15.85209458]
curr_Stock_Price:  103.76328503536558
curr_Factors:  [1.03763285e+02 3.94691577e-02]
mat_Sqrt:  [[ 2.06144922e+01  0.00000000e+00]
 [-7.94673847e-03  1.82082653e-02]]
grads:  [-2.78069869e-03 -6.98197930e+00]
Stock Position:  -0.002780698687459411
Bond Position:  [16.14062901]


portfolio before change:  [15.85145593]
curr_Stock_Price:  104.7185673597644
curr_Factors:  [1.04718567e+02 3.84236631e-02]
mat_Sqrt:  [[ 2.05268862e+01  0.00000000e+00]
 [-7.84078191e-03  1.79654883e-02]]
grads:  [-3.15364862e-03 -9.16706470e+00]
Stock Position:  -0.0031536486152719057
Bond Position:  [16.1817015]


portfolio before change:  [15.85476759]
curr_Stock_Price:  104.30989300134121
curr_Factors:  [1.04309893e+02 3.90557674e-02]
mat_Sqrt:  [[ 2.06142761e+01  0.00000000e+00]
 [-7.90501283e-03  1.81126598e-02]]
grads:  [3.06861396e-03 1.46928623e+01]
Stock Position:  0.0030686139590487
Bond Position:  [15.53468079]


portfolio before change:  [15.85842016]
curr_Stock_Price:  104.86734738543483
curr_Factors:  [1.04867347e+02 3.96214330e-02]
mat_Sqrt:  [[ 2.08739852e+01  0.00000000e+00]
 [-7.96205330e-03  1.82433560e-02]]
grads:  [7.04971310e-03 8.19291263e+00]
Stock Position:  0.007049713104679799
Bond Position:  [15.11913544]


portfolio before change:  [15.86934066]
curr_Stock_Price:  106.14832085063595
curr_Factors:  [1.06148321e+02 3.69977709e-02]
mat_Sqrt:  [[ 2.04174221e+01  0.00000000e+00]
 [-7.69392185e-03  1.76289896e-02]]
grads:  [1.43682445e-03 1.68740958e+00]
Stock Position:  0.0014368244458985765
Bond Position:  [15.71682416]


portfolio before change:  [15.86929827]
curr_Stock_Price:  104.75141038281077
curr_Factors:  [1.04751410e+02 3.77905542e-02]
mat_Sqrt:  [[ 2.03634571e+01  0.00000000e+00]
 [-7.77591710e-03  1.78168644e-02]]
grads:  [-0.00587078 -1.75513948]
Stock Position:  -0.00587078325976312
Bond Position:  [16.4842711]


portfolio before change:  [15.87252498]
curr_Stock_Price:  104.55279284792454
curr_Factors:  [1.04552793e+02 3.91348375e-02]
mat_Sqrt:  [[ 2.06831845e+01  0.00000000e+00]
 [-7.91301080e-03  1.81309855e-02]]
grads:  [ 0.01725174 17.14904257]
Stock Position:  0.01725174237032383
Bond Position:  [14.06880713]


portfolio before change:  [15.85444236]
curr_Stock_Price:  103.40268707874192
curr_Factors:  [1.03402687e+02 3.97243173e-02]
mat_Sqrt:  [[ 2.06091484e+01  0.00000000e+00]
 [-7.97238407e-03  1.82670267e-02]]
grads:  [0.00185448 1.29707329]
Stock Position:  0.001854481991048227
Bond Position:  [15.66268394]


portfolio before change:  [15.85654958]
curr_Stock_Price:  103.4831764251379
curr_Factors:  [1.03483176e+02 4.06255682e-02]
mat_Sqrt:  [[ 2.08578469e+01  0.00000000e+00]
 [-8.06231413e-03  1.84730824e-02]]
grads:  [2.55080106e-03 7.63598347e+00]
Stock Position:  0.0025508010620224736
Bond Position:  [15.59258459]


portfolio before change:  [15.85657627]
curr_Stock_Price:  102.72948856578846
curr_Factors:  [1.02729489e+02 4.06048894e-02]
mat_Sqrt:  [[ 2.07006648e+01  0.00000000e+00]
 [-8.06026198e-03  1.84683803e-02]]
grads:  [5.96762901e-03 9.38745302e+00]
Stock Position:  0.005967629011293881
Bond Position:  [15.24352479]


portfolio before change:  [15.86483441]
curr_Stock_Price:  103.79399426524905
curr_Factors:  [1.03793994e+02 3.93935679e-02]
mat_Sqrt:  [[ 2.06008378e+01  0.00000000e+00]
 [-7.93912518e-03  1.81908210e-02]]
grads:  [4.85633810e-03 6.11269498e+00]
Stock Position:  0.004856338101326969
Bond Position:  [15.36077568]


portfolio before change:  [15.86664964]
curr_Stock_Price:  103.77237625219183
curr_Factors:  [1.03772376e+02 3.97723030e-02]
mat_Sqrt:  [[ 2.06953193e+01  0.00000000e+00]
 [-7.97719780e-03  1.82780564e-02]]
grads:  [  0.02634615 -25.90496591]
Stock Position:  0.026346149178306213
Bond Position:  [13.13264713]


portfolio before change:  [15.87908233]
curr_Stock_Price:  104.1819618973403
curr_Factors:  [1.04181962e+02 3.98723235e-02]
mat_Sqrt:  [[ 2.08031118e+01  0.00000000e+00]
 [-7.98722215e-03  1.83010250e-02]]
grads:  [-7.46479528e-03  2.48585568e+01]
Stock Position:  -0.007464795280836792
Bond Position:  [16.65677934]


portfolio before change:  [15.89313998]
curr_Stock_Price:  102.57770744890979
curr_Factors:  [1.02577707e+02 4.04292699e-02]
mat_Sqrt:  [[ 2.06253315e+01  0.00000000e+00]
 [-8.04281243e-03  1.84283984e-02]]
grads:  [0.00477438 0.88227591]
Stock Position:  0.0047743774838572344
Bond Position:  [15.40339529]


portfolio before change:  [15.89271508]
curr_Stock_Price:  102.08540311038803
curr_Factors:  [1.02085403e+02 4.12177974e-02]
mat_Sqrt:  [[ 2.07255487e+01  0.00000000e+00]
 [-8.12086669e-03  1.86072432e-02]]
grads:  [-1.34186007e-03 -7.18303597e+00]
Stock Position:  -0.0013418600724331633
Bond Position:  [16.02969941]


portfolio before change:  [15.89486854]
curr_Stock_Price:  101.97389829487075
curr_Factors:  [1.01973898e+02 4.24680880e-02]
mat_Sqrt:  [[ 2.10145636e+01  0.00000000e+00]
 [-8.24311475e-03  1.88873487e-02]]
grads:  [-0.00376562 -1.65218053]
Stock Position:  -0.0037656237500960674
Bond Position:  [16.27886388]


portfolio before change:  [15.89940216]
curr_Stock_Price:  101.31036204048254
curr_Factors:  [1.01310362e+02 4.39767164e-02]
mat_Sqrt:  [[ 2.12454173e+01  0.00000000e+00]
 [-8.38825049e-03  1.92198964e-02]]
grads:  [-0.02733955 -5.344852  ]
Stock Position:  -0.027339545649545115
Bond Position:  [18.66918142]


portfolio before change:  [15.88019871]
curr_Stock_Price:  102.09813081000256
curr_Factors:  [1.02098131e+02 4.35639611e-02]
mat_Sqrt:  [[ 2.13099030e+01  0.00000000e+00]
 [-8.34879259e-03  1.91294870e-02]]
grads:  [-0.00552734  0.01887211]
Stock Position:  -0.00552734030144396
Bond Position:  [16.44452982]


portfolio before change:  [15.88332887]
curr_Stock_Price:  101.90374016677916
curr_Factors:  [1.01903740e+02 4.15144072e-02]
mat_Sqrt:  [[ 2.07629733e+01  0.00000000e+00]
 [-8.15003384e-03  1.86740735e-02]]
grads:  [0.00787777 4.95060557]
Stock Position:  0.00787777233969212
Bond Position:  [15.0805544]


portfolio before change:  [15.89564544]
curr_Stock_Price:  103.22789369553234
curr_Factors:  [1.03227894e+02 4.16440380e-02]
mat_Sqrt:  [[ 2.10655830e+01  0.00000000e+00]
 [-8.16274836e-03  1.87032061e-02]]
grads:  [0.0102064  2.31595842]
Stock Position:  0.010206400958382848
Bond Position:  [14.84206016]


portfolio before change:  [15.90035065]
curr_Stock_Price:  103.5071143970137
curr_Factors:  [1.03507114e+02 4.20266724e-02]
mat_Sqrt:  [[ 2.12193806e+01  0.00000000e+00]
 [-8.20016316e-03  1.87889342e-02]]
grads:  [ -0.01569643 -10.58894543]
Stock Position:  -0.01569642651261134
Bond Position:  [17.52504246]


portfolio before change:  [15.86789655]
curr_Stock_Price:  105.7142962576008
curr_Factors:  [1.05714296e+02 4.06424373e-02]
mat_Sqrt:  [[ 2.13119699e+01  0.00000000e+00]
 [-8.06398782e-03  1.84769173e-02]]
grads:  [ 4.21582445e-03 -8.37969101e+00]
Stock Position:  0.0042158244520530685
Bond Position:  [15.42222363]


portfolio before change:  [15.86847578]
curr_Stock_Price:  105.39439049066779
curr_Factors:  [1.05394390e+02 4.01160929e-02]
mat_Sqrt:  [[ 2.11094448e+01  0.00000000e+00]
 [-8.01160088e-03  1.83568837e-02]]
grads:  [-3.84767340e-03  1.12460667e+01]
Stock Position:  -0.003847673401367301
Bond Position:  [16.27399897]


portfolio before change:  [15.86781789]
curr_Stock_Price:  106.0941030492167
curr_Factors:  [1.06094103e+02 4.05975794e-02]
mat_Sqrt:  [[ 2.13767321e+01  0.00000000e+00]
 [-8.05953640e-03  1.84667178e-02]]
grads:  [-3.01475788e-03  6.59208430e+00]
Stock Position:  -0.0030147578833252
Bond Position:  [16.18766592]


portfolio before change:  [15.87399896]
curr_Stock_Price:  104.71505976986252
curr_Factors:  [1.04715060e+02 4.14849335e-02]
mat_Sqrt:  [[ 2.13282069e+01  0.00000000e+00]
 [-8.14714021e-03  1.86674434e-02]]
grads:  [-2.98577677e-03  6.98325346e+00]
Stock Position:  -0.002985776774864264
Bond Position:  [16.18665475]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.87938001]
Stock Price:  103.59052957043053
PL:  [12.28885044]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.18226714e-01  1.14647825e-01]
 [-1.74456418e-01 -8.02384917e-02]
 [ 8.57920474e-01 -7.86237451e-01]
 [-4.21294702e-02  5.83242547e-02]
 [-5.54334369e-02  2.55449431e-02]
 [-5.46488649e-02 -5.20739783e-02]
 [-2.22223952e-02  2.45302491e-01]
 [-9.45578913e-02 -8.25226418e-02]
 [ 1.65899418e-01  1.04182170e-01]
 [ 1.26087478e-01  5.28654607e-02]
 [ 1.68127255e-01  3.71353047e-01]
 [ 1.88757876e-01  2.45226200e-01]
 [ 1.75106260e-01  2.82151611e-02]
 [-2.71752654e-01 -3.72017237e-01]
 [ 8.50426170e-02  2.29332277e-01]
 [ 5.34661810e-02 -2.00641475e-02]
 [-5.20776196e-02  2.20459724e-01]
 [-1.68835890e-01 -7.84668492e-03]
 [ 1.50933073e-02  6.10369530e-02]
 [ 1.43838012e-02 -9.32403700e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 5.24332467e-02  2.39831424e-01]
 [ 3.46981966e-02  2.06623843e-01]
 [-8.57400080e-02  1.05660608e-01]
 [ 3.82863166e-02  8.90274094e-02]
 [ 2.32916012e-01  9.79004513e-03]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.87487329e-01  1.37758123e-01]
 [-9.87102575e-02 -8.77363600e-02]
 [ 9.96400597e-02 -6.96104975e-02]
 [-9.66704813e-01 -1.10898208e-01]
 [-1.22683490e-01  5.19498773e-02]
 [-8.79928965e-03 -1.09368425e-01]
 [ 6.62361874e-02  9.36369982e-02]
 [-6.77665703e-02  1.60977141e-01]
 [-8.53561718e-01 -2.42470877e-01]
 [-3.00425478e-02  3.09959863e-01]
 [-1.30797020e-01  1.12814191e-01]
 [ 3.74774438e-01  5.76485909e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.08806638]
curr_Stock_Price:  99.42828179875029
curr_Factors:  [9.94282818e+01 4.06109047e-02]
mat_Sqrt:  [[ 2.00369340e+01  0.00000000e+00]
 [-8.06085898e-03  1.84697482e-02]]
grads:  [-3.40323034e-03  6.20733014e+00]
Stock Position:  -0.0034032303390947763
Bond Position:  [-0.74968904]


portfolio before change:  [-1.09134834]
curr_Stock_Price:  100.36511044242123
curr_Factors:  [1.00365110e+02 4.08738943e-02]
mat_Sqrt:  [[ 2.02911086e+01  0.00000000e+00]
 [-8.08691726e-03  1.85294552e-02]]
grads:  [-0.01032351 -4.33032113]
Stock Position:  -0.010323505272649492
Bond Position:  [-0.0552286]


portfolio before change:  [-1.06893539]
curr_Stock_Price:  98.19338115988042
curr_Factors:  [9.81933812e+01 4.05020519e-02]
mat_Sqrt:  [[ 1.97615373e+01  0.00000000e+00]
 [-8.05004863e-03  1.84449786e-02]]
grads:  [ 2.60495077e-02 -4.26260972e+01]
Stock Position:  0.026049507659323384
Bond Position:  [-3.62682462]


portfolio before change:  [-1.03519517]
curr_Stock_Price:  99.5060203268825
curr_Factors:  [9.95060203e+01 3.89547300e-02]
mat_Sqrt:  [[ 1.96394561e+01  0.00000000e+00]
 [-7.89478106e-03  1.80892159e-02]]
grads:  [-8.49039734e-04  3.22425554e+00]
Stock Position:  -0.0008490397344225194
Bond Position:  [-0.9507106]


portfolio before change:  [-1.03610303]
curr_Stock_Price:  100.43531978020042
curr_Factors:  [1.00435320e+02 3.66715982e-02]
mat_Sqrt:  [[ 1.92331928e+01  0.00000000e+00]
 [-7.65993193e-03  1.75511089e-02]]
grads:  [-0.00230251  1.45546035]
Stock Position:  -0.002302514726886935
Bond Position:  [-0.80484922]


portfolio before change:  [-1.03754106]
curr_Stock_Price:  101.01617147158707
curr_Factors:  [1.01016171e+02 3.57524878e-02]
mat_Sqrt:  [[ 1.91004693e+01  0.00000000e+00]
 [-7.56333131e-03  1.73297691e-02]]
grads:  [-0.00405099 -3.00488587]
Stock Position:  -0.004050990110418216
Bond Position:  [-0.62832555]


portfolio before change:  [-1.0318497]
curr_Stock_Price:  99.5918517777216
curr_Factors:  [9.95918518e+01 3.60343057e-02]
mat_Sqrt:  [[ 1.89052266e+01  0.00000000e+00]
 [-7.59308167e-03  1.73979357e-02]]
grads:  [4.48745686e-03 1.40995170e+01]
Stock Position:  0.0044874568649607635
Bond Position:  [-1.47876384]


portfolio before change:  [-1.03568546]
curr_Stock_Price:  98.77827147647103
curr_Factors:  [9.87782715e+01 3.59347046e-02]
mat_Sqrt:  [[ 1.87248549e+01  0.00000000e+00]
 [-7.58258052e-03  1.73738746e-02]]
grads:  [-0.00697328 -4.74981221]
Stock Position:  -0.006973283655456543
Bond Position:  [-0.34687656]


portfolio before change:  [-1.0271861]
curr_Stock_Price:  97.55320686770506
curr_Factors:  [9.75532069e+01 3.83553390e-02]
mat_Sqrt:  [[ 1.91053265e+01  0.00000000e+00]
 [-7.83380766e-03  1.79495083e-02]]
grads:  [0.01106331 5.8041796 ]
Stock Position:  0.0110633149881592
Bond Position:  [-2.10644796]


portfolio before change:  [-1.02300265]
curr_Stock_Price:  97.9551451104487
curr_Factors:  [9.79551451e+01 3.79670719e-02]
mat_Sqrt:  [[ 1.90866981e+01  0.00000000e+00]
 [-7.79405639e-03  1.78584267e-02]]
grads:  [0.00781486 2.96025297]
Stock Position:  0.00781485909518636
Bond Position:  [-1.78850831]


portfolio before change:  [-1.03674949]
curr_Stock_Price:  96.22469081895636
curr_Factors:  [9.62246908e+01 3.83409531e-02]
mat_Sqrt:  [[ 1.88416085e+01  0.00000000e+00]
 [-7.83233841e-03  1.79461418e-02]]
grads:  [1.75249906e-02 2.06926397e+01]
Stock Position:  0.017524990553617236
Bond Position:  [-2.72308629]


portfolio before change:  [-1.02232417]
curr_Stock_Price:  97.06724353690973
curr_Factors:  [9.70672435e+01 3.81814574e-02]
mat_Sqrt:  [[ 1.89670132e+01  0.00000000e+00]
 [-7.81603044e-03  1.79087756e-02]]
grads:  [ 0.01559462 13.69307462]
Stock Position:  0.015594620001277603
Bond Position:  [-2.53605094]


portfolio before change:  [-1.01504662]
curr_Stock_Price:  97.55424297077562
curr_Factors:  [9.75542430e+01 3.83818497e-02]
mat_Sqrt:  [[ 1.91121310e+01  0.00000000e+00]
 [-7.83651451e-03  1.79557105e-02]]
grads:  [0.00980636 1.57137537]
Stock Position:  0.009806356283437625
Bond Position:  [-1.97169828]


portfolio before change:  [-1.00241412]
curr_Stock_Price:  98.86757290494869
curr_Factors:  [9.88675729e+01 3.77609343e-02]
mat_Sqrt:  [[ 1.92121177e+01  0.00000000e+00]
 [-7.77286915e-03  1.78098806e-02]]
grads:  [ -0.02259586 -20.88824988]
Stock Position:  -0.022595858219860442
Bond Position:  [1.23158354]


portfolio before change:  [-0.99391679]
curr_Stock_Price:  98.49832951345921
curr_Factors:  [9.84983295e+01 3.88230734e-02]
mat_Sqrt:  [[ 1.94076889e+01  0.00000000e+00]
 [-7.88142864e-03  1.80586217e-02]]
grads:  [9.53907647e-03 1.26993234e+01]
Stock Position:  0.009539076470658287
Bond Position:  [-1.93349989]


portfolio before change:  [-0.97899014]
curr_Stock_Price:  100.08845751360751
curr_Factors:  [1.00088458e+02 3.87479799e-02]
mat_Sqrt:  [[ 1.97019190e+01  0.00000000e+00]
 [-7.87380263e-03  1.80411483e-02]]
grads:  [ 0.0022693  -1.11213251]
Stock Position:  0.0022692951472667836
Bond Position:  [-1.20612039]


portfolio before change:  [-0.97900786]
curr_Stock_Price:  100.14709106848835
curr_Factors:  [1.00147091e+02 3.80791836e-02]
mat_Sqrt:  [[ 1.95425915e+01  0.00000000e+00]
 [-7.80555531e-03  1.78847740e-02]]
grads:  [2.25859974e-03 1.23266709e+01]
Stock Position:  0.002258599739153003
Bond Position:  [-1.20520005]


portfolio before change:  [-0.97840574]
curr_Stock_Price:  100.48038286393664
curr_Factors:  [1.00480383e+02 3.73453294e-02]
mat_Sqrt:  [[ 1.94177734e+01  0.00000000e+00]
 [-7.72997588e-03  1.77115998e-02]]
grads:  [-0.00887128 -0.44302519]
Stock Position:  -0.0088712778940685
Bond Position:  [-0.08701634]


portfolio before change:  [-0.97702733]
curr_Stock_Price:  100.3237778719938
curr_Factors:  [1.00323778e+02 3.75224842e-02]
mat_Sqrt:  [[ 1.94334394e+01  0.00000000e+00]
 [-7.74828850e-03  1.77535593e-02]]
grads:  [2.14743344e-03 3.43801218e+00]
Stock Position:  0.0021474334384143476
Bond Position:  [-1.19246597]


portfolio before change:  [-0.97910505]
curr_Stock_Price:  99.42566114875102
curr_Factors:  [9.94256611e+01 3.83736051e-02]
mat_Sqrt:  [[ 1.94766737e+01  0.00000000e+00]
 [-7.83567280e-03  1.79537819e-02]]
grads:  [-1.35082781e-03 -5.19335540e+00]
Stock Position:  -0.001350827806373513
Bond Position:  [-0.8447981]


portfolio before change:  [-0.97850418]
curr_Stock_Price:  98.90266646458099
curr_Factors:  [9.89026665e+01 3.86700302e-02]
mat_Sqrt:  [[ 1.94489095e+01  0.00000000e+00]
 [-7.86587874e-03  1.80229924e-02]]
grads:  [ 0.00216612 -2.09609974]
Stock Position:  0.002166116848422788
Bond Position:  [-1.19273891]


portfolio before change:  [-0.98190371]
curr_Stock_Price:  97.4020854007689
curr_Factors:  [9.74020854e+01 4.05566271e-02]
mat_Sqrt:  [[ 1.96154904e+01  0.00000000e+00]
 [-8.05547040e-03  1.84574014e-02]]
grads:  [8.00919367e-03 1.29937806e+01]
Stock Position:  0.008009193671315328
Bond Position:  [-1.76201588]


portfolio before change:  [-0.98307122]
curr_Stock_Price:  97.28381571647716
curr_Factors:  [9.72838157e+01 4.09766463e-02]
mat_Sqrt:  [[ 1.96928604e+01  0.00000000e+00]
 [-8.09707565e-03  1.85527310e-02]]
grads:  [6.34119333e-03 1.11371120e+01]
Stock Position:  0.006341193327197295
Bond Position:  [-1.59996671]


portfolio before change:  [-0.98554275]
curr_Stock_Price:  96.92560039693434
curr_Factors:  [9.69256004e+01 4.15572937e-02]
mat_Sqrt:  [[ 1.97588711e+01  0.00000000e+00]
 [-8.15424245e-03  1.86837166e-02]]
grads:  [-2.00547582e-03  5.65522427e+00]
Stock Position:  -0.002005475818949275
Bond Position:  [-0.7911608]


portfolio before change:  [-0.98725976]
curr_Stock_Price:  97.73244600627645
curr_Factors:  [9.77324460e+01 4.07327383e-02]
mat_Sqrt:  [[ 1.97247075e+01  0.00000000e+00]
 [-8.07294130e-03  1.84974323e-02]]
grads:  [3.91088504e-03 4.81296041e+00]
Stock Position:  0.003910885039775458
Bond Position:  [-1.36948012]


portfolio before change:  [-0.98860662]
curr_Stock_Price:  97.43183221388868
curr_Factors:  [9.74318322e+01 4.13441855e-02]
mat_Sqrt:  [[ 1.98110772e+01  0.00000000e+00]
 [-8.13330786e-03  1.86357495e-02]]
grads:  [0.01197253 0.52533681]
Stock Position:  0.011972531131408634
Bond Position:  [-2.15511226]


portfolio before change:  [-1.00448044]
curr_Stock_Price:  96.128481140232
curr_Factors:  [9.61284811e+01 4.22238891e-02]
mat_Sqrt:  [[ 1.97529151e+01  0.00000000e+00]
 [-8.21938091e-03  1.88329676e-02]]
grads:  [9.01950926e-03 9.28889160e+00]
Stock Position:  0.009019509259441214
Bond Position:  [-1.87151216]


portfolio before change:  [-0.9913299]
curr_Stock_Price:  97.61242991320289
curr_Factors:  [9.76124299e+01 4.08838600e-02]
mat_Sqrt:  [[ 1.97369968e+01  0.00000000e+00]
 [-8.08790307e-03  1.85317140e-02]]
grads:  [-6.45309700e-03  7.43364174e+00]
Stock Position:  -0.006453097003979565
Bond Position:  [-0.36142742]


portfolio before change:  [-0.99341074]
curr_Stock_Price:  97.92788461999002
curr_Factors:  [9.79278846e+01 4.18413578e-02]
mat_Sqrt:  [[ 2.00313057e+01  0.00000000e+00]
 [-8.18206407e-03  1.87474640e-02]]
grads:  [-0.00683937 -4.67990551]
Stock Position:  -0.006839371665056024
Bond Position:  [-0.32364554]


portfolio before change:  [-0.9904005]
curr_Stock_Price:  97.48183461895829
curr_Factors:  [9.74818346e+01 4.23362589e-02]
mat_Sqrt:  [[ 2.00576447e+01  0.00000000e+00]
 [-8.23031070e-03  1.88580109e-02]]
grads:  [ 3.45302497e-03 -3.69129586e+00]
Stock Position:  0.003453024970686142
Bond Position:  [-1.32700771]


portfolio before change:  [-0.99254592]
curr_Stock_Price:  96.90855985676484
curr_Factors:  [9.69085599e+01 4.27081344e-02]
mat_Sqrt:  [[ 2.00270711e+01  0.00000000e+00]
 [-8.26637859e-03  1.89406528e-02]]
grads:  [-0.05068663 -5.85503619]
Stock Position:  -0.0506866307556955
Bond Position:  [3.91942248]


portfolio before change:  [-0.99465175]
curr_Stock_Price:  96.95977239664197
curr_Factors:  [9.69597724e+01 4.32928732e-02]
mat_Sqrt:  [[ 2.01743612e+01  0.00000000e+00]
 [-8.32277581e-03  1.90698751e-02]]
grads:  [-0.00495732  2.72418551]
Stock Position:  -0.004957317054420597
Bond Position:  [-0.51399141]


portfolio before change:  [-0.99214459]
curr_Stock_Price:  96.44106163189838
curr_Factors:  [9.64410616e+01 4.23782748e-02]
mat_Sqrt:  [[ 1.98533418e+01  0.00000000e+00]
 [-8.23439370e-03  1.88673662e-02]]
grads:  [-2.84745936e-03 -5.79669807e+00]
Stock Position:  -0.002847459355249669
Bond Position:  [-0.71753258]


portfolio before change:  [-0.99297238]
curr_Stock_Price:  96.7002748363645
curr_Factors:  [9.67002748e+01 4.40098199e-02]
mat_Sqrt:  [[ 2.02862841e+01  0.00000000e+00]
 [-8.39140702e-03  1.92271289e-02]]
grads:  [0.00527956 4.87004578]
Stock Position:  0.005279563428608028
Bond Position:  [-1.50350762]


portfolio before change:  [-0.99458577]
curr_Stock_Price:  96.43028375450463
curr_Factors:  [9.64302838e+01 4.33408538e-02]
mat_Sqrt:  [[ 2.00753061e+01  0.00000000e+00]
 [-8.32738651e-03  1.90804395e-02]]
grads:  [1.24013748e-04 8.43676274e+00]
Stock Position:  0.00012401374787658067
Bond Position:  [-1.00654445]


portfolio before change:  [-0.99458126]
curr_Stock_Price:  97.48124856242384
curr_Factors:  [9.74812486e+01 4.17759603e-02]
mat_Sqrt:  [[ 1.99243565e+01  0.00000000e+00]
 [-8.17566734e-03  1.87328072e-02]]
grads:  [ -0.04815135 -12.94364878]
Stock Position:  -0.048151351057551764
Bond Position:  [3.69927256]


portfolio before change:  [-1.04901297]
curr_Stock_Price:  98.62128193864277
curr_Factors:  [9.86212819e+01 4.02254683e-02]
mat_Sqrt:  [[ 1.97797682e+01  0.00000000e+00]
 [-8.02251514e-03  1.83818915e-02]]
grads:  [5.32033672e-03 1.68622399e+01]
Stock Position:  0.005320336721650794
Bond Position:  [-1.5737114]


portfolio before change:  [-1.0490938]
curr_Stock_Price:  98.64306495793552
curr_Factors:  [9.86430650e+01 4.01026892e-02]
mat_Sqrt:  [[ 1.97539207e+01  0.00000000e+00]
 [-8.01026234e-03  1.83538167e-02]]
grads:  [-4.12884467e-03  6.14663381e+00]
Stock Position:  -0.004128844672544152
Bond Position:  [-0.64181191]


portfolio before change:  [-1.05487663]
curr_Stock_Price:  100.02422618481144
curr_Factors:  [1.00024226e+02 3.76932588e-02]
mat_Sqrt:  [[ 1.94194553e+01  0.00000000e+00]
 [-7.76590073e-03  1.77939140e-02]]
grads:  [0.02059452 3.23979261]
Stock Position:  0.020594519259747188
Bond Position:  [-3.11482749]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.04445868]
Stock Price:  100.54899349654232
PL:  [-1.59345218]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.29159544e-01  6.68313104e-01]
 [-1.84435309e-01 -7.46867975e-02]
 [ 7.87245646e-01 -6.61198248e-01]
 [-3.61552429e-02  1.26630144e-01]
 [-2.82059868e-02  1.46482491e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-5.52682539e-03  3.00800550e-01]
 [ 1.85632655e-01 -1.13092131e-02]
 [ 1.36164784e-01  7.96300491e-02]
 [ 2.52907923e-01 -9.97697835e-02]
 [ 8.12495863e-02  6.08330932e-02]
 [ 1.53274987e-01  2.10034315e-01]
 [ 1.76171598e-01  3.17092866e-02]
 [-2.29398417e-01 -3.17380607e-01]
 [ 8.15180200e-02  2.26538252e-01]
 [ 5.36636531e-02 -2.01899674e-02]
 [-8.47384190e-03 -1.79804381e-02]
 [ 5.96949458e-02  6.01417912e-02]
 [ 9.99373663e-03  4.98887702e-02]
 [ 1.75178137e-01 -1.04824347e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 4.83395048e-02  2.24682655e-01]
 [ 2.84769593e-02  1.61079300e-01]
 [-5.98551614e-02  5.58278905e-02]
 [ 5.88741381e-02  1.38539460e-01]
 [ 4.52348133e-02  1.37885590e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.67598441e-01  1.08895937e-01]
 [-3.10975832e-01  1.84621104e-02]
 [ 1.77251843e-01 -8.77483852e-02]
 [-9.46047343e-01 -1.09437639e-01]
 [-1.22387336e-01  4.92065923e-02]
 [-6.40054371e-03 -8.99123654e-02]
 [ 7.26826023e-02  9.83677661e-02]
 [-6.98180550e-02  1.60413644e-01]
 [-7.75083100e-01 -2.58580702e-01]
 [-2.62990250e-02  2.98530574e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.04231587e-01  9.70974180e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.53287042]
curr_Stock_Price:  101.02796678509583
curr_Factors:  [1.01027967e+02 4.07499228e-02]
mat_Sqrt:  [[ 2.03941218e+01  0.00000000e+00]
 [-8.07464404e-03  1.85013338e-02]]
grads:  [3.04418745e-02 3.61224284e+01]
Stock Position:  0.030441874479359428
Bond Position:  [6.45738973]


portfolio before change:  [9.54063537]
curr_Stock_Price:  101.25652450044771
curr_Factors:  [1.01256525e+02 4.10413745e-02]
mat_Sqrt:  [[ 2.05132260e+01  0.00000000e+00]
 [-8.10346834e-03  1.85673785e-02]]
grads:  [-0.01058007 -4.02247401]
Stock Position:  -0.010580066725092988
Bond Position:  [10.61193615]


portfolio before change:  [9.5512876]
curr_Stock_Price:  100.37508789175668
curr_Factors:  [1.00375088e+02 4.19616315e-02]
mat_Sqrt:  [[ 2.05613735e+01  0.00000000e+00]
 [-8.19381538e-03  1.87743896e-02]]
grads:  [ 2.42530040e-02 -3.52180956e+01]
Stock Position:  0.024253003989158303
Bond Position:  [7.11689019]


portfolio before change:  [9.50668186]
curr_Stock_Price:  98.49922102903038
curr_Factors:  [9.84992210e+01 4.33571692e-02]
mat_Sqrt:  [[ 2.05098864e+01  0.00000000e+00]
 [-8.32895376e-03  1.90840305e-02]]
grads:  [9.31779065e-04 6.63539830e+00]
Stock Position:  0.0009317790648515168
Bond Position:  [9.41490235]


portfolio before change:  [9.50938431]
curr_Stock_Price:  100.1364270204266
curr_Factors:  [1.00136427e+02 4.29178648e-02]
mat_Sqrt:  [[ 2.07448904e+01  0.00000000e+00]
 [-8.28665093e-03  1.89871026e-02]]
grads:  [-0.00105149  0.77148417]
Stock Position:  -0.0010514862394091057
Bond Position:  [9.61467639]


portfolio before change:  [9.5107074]
curr_Stock_Price:  100.0211763250332
curr_Factors:  [1.00021176e+02 4.41402201e-02]
mat_Sqrt:  [[ 2.10140231e+01  0.00000000e+00]
 [-8.40382961e-03  1.92555927e-02]]
grads:  [-0.00563532 -3.44403463]
Stock Position:  -0.005635321290685014
Bond Position:  [10.07435887]


portfolio before change:  [9.51062094]
curr_Stock_Price:  100.25999853959335
curr_Factors:  [1.00259999e+02 4.24043515e-02]
mat_Sqrt:  [[ 2.06458566e+01  0.00000000e+00]
 [-8.23692675e-03  1.88731702e-02]]
grads:  [6.09097020e-03 1.59379981e+01]
Stock Position:  0.006090970201692085
Bond Position:  [8.89994027]


portfolio before change:  [9.51343697]
curr_Stock_Price:  100.53966963581179
curr_Factors:  [1.00539670e+02 4.27528445e-02]
mat_Sqrt:  [[ 2.07883472e+01  0.00000000e+00]
 [-8.27070440e-03  1.89505645e-02]]
grads:  [ 0.00869222 -0.59677447]
Stock Position:  0.008692221084740616
Bond Position:  [8.63952393]


portfolio before change:  [9.51727448]
curr_Stock_Price:  100.85690827703738
curr_Factors:  [1.00856908e+02 4.35782468e-02]
mat_Sqrt:  [[ 2.10542865e+01  0.00000000e+00]
 [-8.35016137e-03  1.91326233e-02]]
grads:  [0.00811798 4.16200371]
Stock Position:  0.00811797572108992
Bond Position:  [8.69852055]


portfolio before change:  [9.50757549]
curr_Stock_Price:  99.52820508740913
curr_Factors:  [9.95282051e+01 4.44024745e-02]
mat_Sqrt:  [[ 2.09724785e+01  0.00000000e+00]
 [-8.42875786e-03  1.93127105e-02]]
grads:  [ 0.00998284 -5.16601664]
Stock Position:  0.009982836261016561
Bond Position:  [8.51400171]


portfolio before change:  [9.5161256]
curr_Stock_Price:  100.2780717138338
curr_Factors:  [1.00278072e+02 4.52531603e-02]
mat_Sqrt:  [[ 2.13319438e+01  0.00000000e+00]
 [-8.50911608e-03  1.94968343e-02]]
grads:  [0.00505342 3.12015235]
Stock Position:  0.005053422499768224
Bond Position:  [9.00937814]


portfolio before change:  [9.50553985]
curr_Stock_Price:  97.96043669095774
curr_Factors:  [9.79604367e+01 4.54292987e-02]
mat_Sqrt:  [[ 2.08794343e+01  0.00000000e+00]
 [-8.52565997e-03  1.95347411e-02]]
grads:  [ 0.01173123 10.75183511]
Stock Position:  0.011731231463638548
Bond Position:  [8.3563433]


portfolio before change:  [9.50877416]
curr_Stock_Price:  98.14709239667143
curr_Factors:  [9.81470924e+01 4.55533153e-02]
mat_Sqrt:  [[ 2.09477525e+01  0.00000000e+00]
 [-8.53728906e-03  1.95613867e-02]]
grads:  [0.00907069 1.62101425]
Stock Position:  0.009070694580871001
Bond Position:  [8.61851186]


portfolio before change:  [9.51182341]
curr_Stock_Price:  98.36448077681699
curr_Factors:  [9.83644808e+01 4.62646809e-02]
mat_Sqrt:  [[ 2.11574386e+01  0.00000000e+00]
 [-8.60369046e-03  1.97135314e-02]]
grads:  [ -0.01738938 -16.09963234]
Stock Position:  -0.017389376683380066
Bond Position:  [11.22232042]


portfolio before change:  [9.49461927]
curr_Stock_Price:  99.43450274220577
curr_Factors:  [9.94345027e+01 4.54816055e-02]
mat_Sqrt:  [[ 2.12058165e+01  0.00000000e+00]
 [-8.53056673e-03  1.95459839e-02]]
grads:  [8.50650663e-03 1.15900153e+01]
Stock Position:  0.008506506632291636
Bond Position:  [8.64877901]


portfolio before change:  [9.5032356]
curr_Stock_Price:  100.32031504370116
curr_Factors:  [1.00320315e+02 4.66898667e-02]
mat_Sqrt:  [[ 2.16770513e+01  0.00000000e+00]
 [-8.64313524e-03  1.98039107e-02]]
grads:  [ 0.0020691  -1.01949396]
Stock Position:  0.002069101946455003
Bond Position:  [9.29566265]


portfolio before change:  [9.49988699]
curr_Stock_Price:  98.1403125160913
curr_Factors:  [9.81403125e+01 4.89947608e-02]
mat_Sqrt:  [[ 2.17231228e+01  0.00000000e+00]
 [-8.85390407e-03  2.02868428e-02]]
grads:  [-7.51326067e-04 -8.86310319e-01]
Stock Position:  -0.0007513260672061226
Bond Position:  [9.57362236]


portfolio before change:  [9.50218318]
curr_Stock_Price:  96.67701030979364
curr_Factors:  [9.66770103e+01 4.89082422e-02]
mat_Sqrt:  [[ 2.13803218e+01  0.00000000e+00]
 [-8.84608317e-03  2.02689229e-02]]
grads:  [0.00401972 2.96719227]
Stock Position:  0.004019723180846785
Bond Position:  [9.11356836]


portfolio before change:  [9.50337251]
curr_Stock_Price:  96.68946343331257
curr_Factors:  [9.66894634e+01 4.78130138e-02]
mat_Sqrt:  [[ 2.11422990e+01  0.00000000e+00]
 [-8.74647484e-03  2.00406915e-02]]
grads:  [1.50253201e-03 2.48937369e+00]
Stock Position:  0.0015025320099181774
Bond Position:  [9.35809349]


portfolio before change:  [9.5049808]
curr_Stock_Price:  96.98127613380244
curr_Factors:  [9.69812761e+01 4.77764233e-02]
mat_Sqrt:  [[ 2.11979914e+01  0.00000000e+00]
 [-8.74312743e-03  2.00330216e-02]]
grads:  [ 0.00610572 -5.23257795]
Stock Position:  0.006105721963217246
Bond Position:  [8.91284009]


portfolio before change:  [9.50564823]
curr_Stock_Price:  96.90810750160348
curr_Factors:  [9.69081075e+01 4.63209002e-02]
mat_Sqrt:  [[ 2.08568447e+01  0.00000000e+00]
 [-8.60891633e-03  1.97255054e-02]]
grads:  [ 0.00201989 -1.91518488]
Stock Position:  0.002019893764606924
Bond Position:  [9.30990415]


portfolio before change:  [9.50695998]
curr_Stock_Price:  96.98135158761234
curr_Factors:  [9.69813516e+01 4.35579458e-02]
mat_Sqrt:  [[ 2.02405322e+01  0.00000000e+00]
 [-8.34821617e-03  1.91281663e-02]]
grads:  [7.23296468e-03 1.17461680e+01]
Stock Position:  0.007232964681456851
Bond Position:  [8.80549729]


portfolio before change:  [9.50502843]
curr_Stock_Price:  96.56211733525149
curr_Factors:  [9.65621173e+01 4.47775967e-02]
mat_Sqrt:  [[ 2.04332369e+01  0.00000000e+00]
 [-8.46428702e-03  1.93941180e-02]]
grads:  [4.83416944e-03 8.30557494e+00]
Stock Position:  0.004834169441567686
Bond Position:  [9.0382308]


portfolio before change:  [9.50298442]
curr_Stock_Price:  95.90557013823117
curr_Factors:  [9.59055701e+01 4.46187566e-02]
mat_Sqrt:  [[ 2.02582797e+01  0.00000000e+00]
 [-8.44926095e-03  1.93596889e-02]]
grads:  [-1.75187000e-03  2.88371836e+00]
Stock Position:  -0.0017518699998384847
Bond Position:  [9.67099851]


portfolio before change:  [9.50463279]
curr_Stock_Price:  95.65474445391361
curr_Factors:  [9.56547445e+01 4.39687487e-02]
mat_Sqrt:  [[ 2.00575817e+01  0.00000000e+00]
 [-8.38749057e-03  1.92181552e-02]]
grads:  [5.94975593e-03 7.20878037e+00]
Stock Position:  0.005949755930509394
Bond Position:  [8.9355104]


portfolio before change:  [9.50221495]
curr_Stock_Price:  95.06062770491667
curr_Factors:  [9.50606277e+01 4.48495856e-02]
mat_Sqrt:  [[ 2.01316743e+01  0.00000000e+00]
 [-8.47108830e-03  1.94097017e-02]]
grads:  [5.23617741e-03 7.10395203e+00]
Stock Position:  0.00523617741460653
Bond Position:  [9.00446063]


portfolio before change:  [9.50985855]
curr_Stock_Price:  96.30542421095937
curr_Factors:  [9.63054242e+01 4.43264701e-02]
mat_Sqrt:  [[ 2.02760019e+01  0.00000000e+00]
 [-8.42154096e-03  1.92961745e-02]]
grads:  [8.78682107e-03 9.06591070e+00]
Stock Position:  0.00878682106910465
Bond Position:  [8.66364002]


portfolio before change:  [9.50240185]
curr_Stock_Price:  95.33354607599527
curr_Factors:  [9.53335461e+01 4.54752193e-02]
mat_Sqrt:  [[ 2.03298020e+01  0.00000000e+00]
 [-8.52996781e-03  1.95446116e-02]]
grads:  [-0.00590622  5.57166033]
Stock Position:  -0.00590622365107187
Bond Position:  [10.0654631]


portfolio before change:  [9.50781386]
curr_Stock_Price:  94.63026384588083
curr_Factors:  [9.46302638e+01 4.60721602e-02]
mat_Sqrt:  [[ 2.03118434e+01  0.00000000e+00]
 [-8.58577058e-03  1.96724718e-02]]
grads:  [-0.01491338  0.93847436]
Stock Position:  -0.01491338331300049
Bond Position:  [10.91907125]


portfolio before change:  [9.49787787]
curr_Stock_Price:  95.38803628345939
curr_Factors:  [9.53880363e+01 4.58163600e-02]
mat_Sqrt:  [[ 2.04175769e+01  0.00000000e+00]
 [-8.56190259e-03  1.96177834e-02]]
grads:  [ 0.00680567 -4.4729001 ]
Stock Position:  0.006805670881226215
Bond Position:  [8.84869829]


portfolio before change:  [9.51068008]
curr_Stock_Price:  97.10661017193826
curr_Factors:  [9.71066102e+01 4.47600440e-02]
mat_Sqrt:  [[ 2.05444276e+01  0.00000000e+00]
 [-8.46262787e-03  1.93903164e-02]]
grads:  [-0.04837369 -5.6439326 ]
Stock Position:  -0.04837369346269817
Bond Position:  [14.20808547]


portfolio before change:  [9.51646722]
curr_Stock_Price:  97.02369276505587
curr_Factors:  [9.70236928e+01 4.46763657e-02]
mat_Sqrt:  [[ 2.05076888e+01  0.00000000e+00]
 [-8.45471378e-03  1.93721829e-02]]
grads:  [-0.00492068  2.5400644 ]
Stock Position:  -0.004920682148209052
Bond Position:  [9.99388997]


portfolio before change:  [9.51412405]
curr_Stock_Price:  97.7537718010337
curr_Factors:  [9.77537718e+01 4.24440390e-02]
mat_Sqrt:  [[ 2.01391843e+01  0.00000000e+00]
 [-8.24078045e-03  1.88820001e-02]]
grads:  [-2.26630416e-03 -4.76180304e+00]
Stock Position:  -0.0022663041576217124
Bond Position:  [9.73566383]


portfolio before change:  [9.51658898]
curr_Stock_Price:  97.20314091511591
curr_Factors:  [9.72031409e+01 4.19289952e-02]
mat_Sqrt:  [[ 1.99038700e+01  0.00000000e+00]
 [-8.19062832e-03  1.87670871e-02]]
grads:  [0.00580861 5.2415042 ]
Stock Position:  0.005808609845872983
Bond Position:  [8.95197386]


portfolio before change:  [9.51434672]
curr_Stock_Price:  96.6244606267857
curr_Factors:  [9.66244606e+01 4.12471109e-02]
mat_Sqrt:  [[ 1.96238335e+01  0.00000000e+00]
 [-8.12375390e-03  1.86138586e-02]]
grads:  [9.79416132e-06 8.61796835e+00]
Stock Position:  9.794161322224049e-06
Bond Position:  [9.51340036]


portfolio before change:  [9.51554781]
curr_Stock_Price:  97.83392414223326
curr_Factors:  [9.78339241e+01 4.09485769e-02]
mat_Sqrt:  [[ 1.97974329e+01  0.00000000e+00]
 [-8.09430189e-03  1.85463756e-02]]
grads:  [ -0.04485112 -13.94238466]
Stock Position:  -0.04485111648682402
Bond Position:  [13.90350854]


portfolio before change:  [9.54501224]
curr_Stock_Price:  97.21573714280086
curr_Factors:  [9.72157371e+01 4.07693401e-02]
mat_Sqrt:  [[ 1.96292368e+01  0.00000000e+00]
 [-8.07656760e-03  1.85057412e-02]]
grads:  [5.29773011e-03 1.61317815e+01]
Stock Position:  0.00529773011405045
Bond Position:  [9.0299895]


portfolio before change:  [9.54059874]
curr_Stock_Price:  96.16956824145433
curr_Factors:  [9.61695682e+01 4.07410575e-02]
mat_Sqrt:  [[ 1.94112639e+01  0.00000000e+00]
 [-8.07376566e-03  1.84993211e-02]]
grads:  [-4.54299192e-03  5.91166365e+00]
Stock Position:  -0.004542991924953456
Bond Position:  [9.97749631]


portfolio before change:  [9.53772019]
curr_Stock_Price:  97.07773958637344
curr_Factors:  [9.70777396e+01 4.12875340e-02]
mat_Sqrt:  [[ 1.97255503e+01  0.00000000e+00]
 [-8.12773365e-03  1.86229773e-02]]
grads:  [0.04098589 0.52138504]
Stock Position:  0.04098589160251716
Bond Position:  [5.55890247]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.51329068]
Stock Price:  96.46473797300845
PL:  [9.51329068]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-8.54724349e-02  1.54435487e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.30960441e-01 -7.24733578e-01]
 [-2.82717944e-02  2.91861839e-02]
 [ 1.33939828e-02 -2.00046891e-03]
 [-8.05403126e-02 -1.02783403e-01]
 [-1.31644092e-01  8.13667902e-02]
 [ 3.22845616e-02 -1.36625798e-01]
 [ 1.65045776e-01  1.32130093e-01]
 [-2.29605143e-02  2.62414246e-01]
 [ 1.90130344e-01  5.01169181e-01]
 [ 1.51556295e-01  2.84254392e-01]
 [ 2.96938605e-01  2.32809926e-02]
 [-1.06300712e-01 -8.33112181e-02]
 [ 9.36946831e-02  2.36240906e-01]
 [ 3.73165872e-02  1.70711327e-01]
 [ 1.29174055e-01  3.13508206e-01]
 [ 1.15853102e-01  7.02754119e-02]
 [ 1.88028378e-02 -3.10712488e-02]
 [ 3.37010631e-01 -1.14975282e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 6.49475172e-02  2.68683504e-01]
 [ 3.69632469e-02  3.37173372e-01]
 [ 9.95899311e-03  1.60172374e-01]
 [ 3.06386635e-02  6.94834245e-02]
 [ 6.91231057e-01 -2.47912875e-01]
 [-1.77410026e-01  2.40949251e-01]
 [-1.62552764e-01  1.27018878e-01]
 [ 1.08107328e-02 -1.41854149e-01]
 [ 7.51227656e-02 -6.38812681e-02]
 [-8.21978099e-01 -9.92866860e-02]
 [-1.18145454e-01  8.15645299e-03]
 [ 4.40966293e-03 -9.12179170e-02]
 [ 9.81845728e-02  9.35503735e-02]
 [-2.67067096e-01 -1.09279461e-01]
 [-1.14499421e-01 -4.16046891e-01]
 [-1.59311530e-01  2.17309566e-01]
 [-1.18559703e-01  1.21069735e-01]
 [-1.97304675e-01  1.49755442e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.32729013]
curr_Stock_Price:  99.54286701554582
curr_Factors:  [9.95428670e+01 4.01336353e-02]
mat_Sqrt:  [[ 1.99418018e+01  0.00000000e+00]
 [-8.01335238e-03  1.83608969e-02]]
grads:  [-9.06200085e-04  8.41110802e+00]
Stock Position:  -0.0009062000853487189
Bond Position:  [-0.23708438]


portfolio before change:  [-0.32752189]
curr_Stock_Price:  99.76590487345379
curr_Factors:  [9.97659049e+01 4.04467176e-02]
mat_Sqrt:  [[ 2.00642896e+01  0.00000000e+00]
 [-8.04454773e-03  1.84323745e-02]]
grads:  [-0.0101167  -4.77482542]
Stock Position:  -0.010116702463425643
Bond Position:  [0.68178009]


portfolio before change:  [-0.32114229]
curr_Stock_Price:  99.14372862946372
curr_Factors:  [9.91437286e+01 4.08037973e-02]
mat_Sqrt:  [[ 2.00269834e+01  0.00000000e+00]
 [-8.07997993e-03  1.85135598e-02]]
grads:  [ 2.56983673e-02 -3.91460953e+01]
Stock Position:  0.02569836728554202
Bond Position:  [-2.86897424]


portfolio before change:  [-0.30164791]
curr_Stock_Price:  99.91626877912998
curr_Factors:  [9.99162688e+01 4.06283254e-02]
mat_Sqrt:  [[ 2.01395920e+01  0.00000000e+00]
 [-8.06258771e-03  1.84737092e-02]]
grads:  [-7.71311528e-04  1.57987676e+00]
Stock Position:  -0.0007713115280160353
Bond Position:  [-0.22458134]


portfolio before change:  [-0.30149405]
curr_Stock_Price:  99.68038759707974
curr_Factors:  [9.96803876e+01 4.06948013e-02]
mat_Sqrt:  [[ 2.01084772e+01  0.00000000e+00]
 [-8.06918100e-03  1.84888164e-02]]
grads:  [ 0.00062267 -0.10819886]
Stock Position:  0.0006226680613778061
Bond Position:  [-0.36356184]


portfolio before change:  [-0.30273275]
curr_Stock_Price:  97.76402338481053
curr_Factors:  [9.77640234e+01 4.12161005e-02]
mat_Sqrt:  [[ 1.98478065e+01  0.00000000e+00]
 [-8.12069953e-03  1.86068601e-02]]
grads:  [-0.00631801 -5.52395202]
Stock Position:  -0.006318011379308995
Bond Position:  [0.31494146]


portfolio before change:  [-0.2933416]
curr_Stock_Price:  96.28384523541403
curr_Factors:  [9.62838452e+01 4.18198335e-02]
mat_Sqrt:  [[ 1.96899483e+01  0.00000000e+00]
 [-8.17995927e-03  1.87426413e-02]]
grads:  [-0.00488232  4.34126594]
Stock Position:  -0.004882324330104791
Bond Position:  [0.17674736]


portfolio before change:  [-0.29400421]
curr_Stock_Price:  96.42408704291421
curr_Factors:  [9.64240870e+01 4.13404685e-02]
mat_Sqrt:  [[ 1.96052883e+01  0.00000000e+00]
 [-8.13294225e-03  1.86349117e-02]]
grads:  [-1.39471682e-03 -7.33171159e+00]
Stock Position:  -0.0013947168208581703
Bond Position:  [-0.15951992]


portfolio before change:  [-0.29334495]
curr_Stock_Price:  95.93710084577984
curr_Factors:  [9.59371008e+01 4.17861728e-02]
mat_Sqrt:  [[ 1.96111422e+01  0.00000000e+00]
 [-8.17666658e-03  1.87350968e-02]]
grads:  [0.01135641 7.05254392]
Stock Position:  0.011356405151835136
Bond Position:  [-1.38284553]


portfolio before change:  [-0.29972614]
curr_Stock_Price:  95.39042063519473
curr_Factors:  [9.53904206e+01 4.14523833e-02]
mat_Sqrt:  [[ 1.94213545e+01  0.00000000e+00]
 [-8.14394334e-03  1.86601184e-02]]
grads:  [4.71473047e-03 1.40628393e+01]
Stock Position:  0.004714730467545884
Bond Position:  [-0.74946626]


portfolio before change:  [-0.30240666]
curr_Stock_Price:  94.8417490731995
curr_Factors:  [9.48417491e+01 4.11037893e-02]
mat_Sqrt:  [[ 1.92282821e+01  0.00000000e+00]
 [-8.10962779e-03  1.85814916e-02]]
grads:  [2.12633923e-02 2.69714182e+01]
Stock Position:  0.021263392349091685
Bond Position:  [-2.31906398]


portfolio before change:  [-0.28662255]
curr_Stock_Price:  95.59769672306074
curr_Factors:  [9.55976967e+01 3.92110491e-02]
mat_Sqrt:  [[ 1.89300456e+01  0.00000000e+00]
 [-7.92071200e-03  1.81486311e-02]]
grads:  [1.45596629e-02 1.56625803e+01]
Stock Position:  0.014559662905321442
Bond Position:  [-1.67849279]


portfolio before change:  [-0.29537571]
curr_Stock_Price:  95.01091551435525
curr_Factors:  [9.50109155e+01 4.01786164e-02]
mat_Sqrt:  [[ 1.90445621e+01  0.00000000e+00]
 [-8.01784174e-03  1.83711834e-02]]
grads:  [0.0161253  1.26725601]
Stock Position:  0.016125299241316185
Bond Position:  [-1.82745516]


portfolio before change:  [-0.27901235]
curr_Stock_Price:  96.03984598391786
curr_Factors:  [9.60398460e+01 3.94745369e-02]
mat_Sqrt:  [[ 1.90813886e+01  0.00000000e+00]
 [-7.94727998e-03  1.82095060e-02]]
grads:  [-0.00747643 -4.57514981]
Stock Position:  -0.007476432210451808
Bond Position:  [0.43902305]


portfolio before change:  [-0.28007787]
curr_Stock_Price:  96.18970449312489
curr_Factors:  [9.61897045e+01 4.06237052e-02]
mat_Sqrt:  [[ 1.93873458e+01  0.00000000e+00]
 [-8.06212927e-03  1.84726588e-02]]
grads:  [1.01508824e-02 1.27886791e+01]
Stock Position:  0.010150882408603804
Bond Position:  [-1.25648825]


portfolio before change:  [-0.29815407]
curr_Stock_Price:  94.42442724988825
curr_Factors:  [9.44244272e+01 4.04247921e-02]
mat_Sqrt:  [[ 1.89848975e+01  0.00000000e+00]
 [-8.04236702e-03  1.84273778e-02]]
grads:  [5.89000379e-03 9.26400534e+00]
Stock Position:  0.005890003793095533
Bond Position:  [-0.8543143]


portfolio before change:  [-0.29986269]
curr_Stock_Price:  94.15246972026354
curr_Factors:  [9.41524697e+01 3.96633883e-02]
mat_Sqrt:  [[ 1.87510945e+01  0.00000000e+00]
 [-7.96626771e-03  1.82530124e-02]]
grads:  [1.41858521e-02 1.71756968e+01]
Stock Position:  0.014185852130359318
Bond Position:  [-1.63549571]


portfolio before change:  [-0.29498308]
curr_Stock_Price:  94.51085936489919
curr_Factors:  [9.45108594e+01 3.88465724e-02]
mat_Sqrt:  [[ 1.86276498e+01  0.00000000e+00]
 [-7.88381353e-03  1.80640861e-02]]
grads:  [0.00786593 3.89033862]
Stock Position:  0.007865930911098721
Bond Position:  [-1.03839897]


portfolio before change:  [-0.29586302]
curr_Stock_Price:  94.41549435419903
curr_Factors:  [9.44154944e+01 3.96547167e-02]
mat_Sqrt:  [[ 1.88014220e+01  0.00000000e+00]
 [-7.96539684e-03  1.82510170e-02]]
grads:  [ 2.78821095e-04 -1.70243931e+00]
Stock Position:  0.0002788210954691218
Bond Position:  [-0.32218805]


portfolio before change:  [-0.29584445]
curr_Stock_Price:  94.62656628178033
curr_Factors:  [9.46265663e+01 3.94294444e-02]
mat_Sqrt:  [[ 1.87898542e+01  0.00000000e+00]
 [-7.94273952e-03  1.81991025e-02]]
grads:  [ 0.01526522 -6.31763472]
Stock Position:  0.015265222438959626
Bond Position:  [-1.74034003]


portfolio before change:  [-0.2821468]
curr_Stock_Price:  95.5381289322822
curr_Factors:  [9.55381289e+01 4.01792638e-02]
mat_Sqrt:  [[ 1.91503943e+01  0.00000000e+00]
 [-8.01790634e-03  1.83713314e-02]]
grads:  [ 0.00219988 -2.05635557]
Stock Position:  0.0021998821571116854
Bond Position:  [-0.49231942]


portfolio before change:  [-0.27655372]
curr_Stock_Price:  98.10854905096798
curr_Factors:  [9.81085491e+01 3.85598073e-02]
mat_Sqrt:  [[ 1.92652336e+01  0.00000000e+00]
 [-7.85466050e-03  1.79972882e-02]]
grads:  [9.45800168e-03 1.49291105e+01]
Stock Position:  0.009458001684885512
Bond Position:  [-1.20446454]


portfolio before change:  [-0.26213571]
curr_Stock_Price:  99.64889278137407
curr_Factors:  [9.96488928e+01 3.86092632e-02]
mat_Sqrt:  [[ 1.95802501e+01  0.00000000e+00]
 [-7.85969600e-03  1.80088259e-02]]
grads:  [9.40323897e-03 1.87226737e+01]
Stock Position:  0.00940323897249702
Bond Position:  [-1.19915807]


portfolio before change:  [-0.24939658]
curr_Stock_Price:  101.01959465972516
curr_Factors:  [1.01019595e+02 3.78424677e-02]
mat_Sqrt:  [[ 1.96514837e+01  0.00000000e+00]
 [-7.78125622e-03  1.78290978e-02]]
grads:  [4.06401620e-03 8.98376215e+00]
Stock Position:  0.004064016199624951
Bond Position:  [-0.65994185]


portfolio before change:  [-0.24701363]
curr_Stock_Price:  101.62624706323562
curr_Factors:  [1.01626247e+02 3.75650520e-02]
mat_Sqrt:  [[ 1.96969002e+01  0.00000000e+00]
 [-7.75268232e-03  1.77636268e-02]]
grads:  [3.09509189e-03 3.91155620e+00]
Stock Position:  0.0030950918880310865
Bond Position:  [-0.56155621]


portfolio before change:  [-0.2485371]
curr_Stock_Price:  101.15670871730188
curr_Factors:  [1.01156709e+02 3.76540198e-02]
mat_Sqrt:  [[ 1.96290989e+01  0.00000000e+00]
 [-7.76185749e-03  1.77846497e-02]]
grads:  [  0.02970248 -13.93971087]
Stock Position:  0.029702484580027673
Bond Position:  [-3.25314268]


portfolio before change:  [-0.2099043]
curr_Stock_Price:  102.471058722122
curr_Factors:  [1.02471059e+02 3.76355313e-02]
mat_Sqrt:  [[ 1.98792616e+01  0.00000000e+00]
 [-7.75995168e-03  1.77802830e-02]]
grads:  [-3.63449878e-03  1.35514857e+01]
Stock Position:  -0.003634498779666102
Bond Position:  [0.16252663]


portfolio before change:  [-0.20011359]
curr_Stock_Price:  99.78282183763015
curr_Factors:  [9.97828218e+01 3.92422955e-02]
mat_Sqrt:  [[ 1.97666459e+01  0.00000000e+00]
 [-7.92386729e-03  1.81558608e-02]]
grads:  [-5.41908732e-03  6.99602620e+00]
Stock Position:  -0.0054190873169507985
Bond Position:  [0.34061823]


portfolio before change:  [-0.19933617]
curr_Stock_Price:  99.64721822692269
curr_Factors:  [9.96472182e+01 3.97566705e-02]
mat_Sqrt:  [[ 1.98687334e+01  0.00000000e+00]
 [-7.97562993e-03  1.82744639e-02]]
grads:  [-2.57185461e-03 -7.76242466e+00]
Stock Position:  -0.0025718546139699068
Bond Position:  [0.05694199]


portfolio before change:  [-0.19547421]
curr_Stock_Price:  98.14836485561918
curr_Factors:  [9.81483649e+01 3.87606280e-02]
mat_Sqrt:  [[ 1.93231743e+01  0.00000000e+00]
 [-7.87508761e-03  1.80440925e-02]]
grads:  [ 2.44487235e-03 -3.54028711e+00]
Stock Position:  0.0024448723460165768
Bond Position:  [-0.43543444]


portfolio before change:  [-0.19500984]
curr_Stock_Price:  98.36056802531623
curr_Factors:  [9.83605680e+01 3.92633992e-02]
mat_Sqrt:  [[ 1.94901408e+01  0.00000000e+00]
 [-7.92599765e-03  1.81607421e-02]]
grads:  [-0.04439734 -5.46710511]
Stock Position:  -0.04439733769008601
Bond Position:  [4.17193752]


portfolio before change:  [-0.21579567]
curr_Stock_Price:  98.84049219115556
curr_Factors:  [9.88404922e+01 3.92682186e-02]
mat_Sqrt:  [[ 1.95864397e+01  0.00000000e+00]
 [-7.92648408e-03  1.81618566e-02]]
grads:  [-0.00585026  0.44909797]
Stock Position:  -0.005850255987902418
Bond Position:  [0.36244651]


portfolio before change:  [-0.21326687]
curr_Stock_Price:  98.41598303243538
curr_Factors:  [9.8415983e+01 4.1245186e-02]
mat_Sqrt:  [[ 1.99872143e+01  0.00000000e+00]
 [-8.12356435e-03  1.86134243e-02]]
grads:  [-1.77118729e-03 -4.90065212e+00]
Stock Position:  -0.0017711872907340564
Bond Position:  [-0.03895373]


portfolio before change:  [-0.21475465]
curr_Stock_Price:  99.2532206868097
curr_Factors:  [9.92532207e+01 4.07106565e-02]
mat_Sqrt:  [[ 2.00262052e+01  0.00000000e+00]
 [-8.07075278e-03  1.84924178e-02]]
grads:  [0.00694157 5.05885032]
Stock Position:  0.006941569903960576
Bond Position:  [-0.90372782]


portfolio before change:  [-0.20683351]
curr_Stock_Price:  100.4106111962128
curr_Factors:  [1.00410611e+02 4.08579669e-02]
mat_Sqrt:  [[ 2.02963520e+01  0.00000000e+00]
 [-8.08534150e-03  1.85258447e-02]]
grads:  [-0.01550823 -5.89875725]
Stock Position:  -0.015508233325104157
Bond Position:  [1.35035767]


portfolio before change:  [-0.22561791]
curr_Stock_Price:  101.63274937510332
curr_Factors:  [1.01632749e+02 4.10421340e-02]
mat_Sqrt:  [[ 2.05896347e+01  0.00000000e+00]
 [-8.10354332e-03  1.85675503e-02]]
grads:  [-1.43799137e-02 -2.24072042e+01]
Stock Position:  -0.014379913728405289
Bond Position:  [1.23585226]


portfolio before change:  [-0.26512472]
curr_Stock_Price:  104.39085383110394
curr_Factors:  [1.04390854e+02 3.91669325e-02]
mat_Sqrt:  [[ 2.06596153e+01  0.00000000e+00]
 [-7.91625492e-03  1.81384187e-02]]
grads:  [-3.12057409e-03  1.19806235e+01]
Stock Position:  -0.003120574094087755
Bond Position:  [0.06063467]


portfolio before change:  [-0.26787341]
curr_Stock_Price:  105.27411025694417
curr_Factors:  [1.05274110e+02 3.79393068e-02]
mat_Sqrt:  [[ 2.05053070e+01  0.00000000e+00]
 [-7.79120599e-03  1.78518956e-02]]
grads:  [-3.20505025e-03  6.78189798e+00]
Stock Position:  -0.0032050502481981093
Bond Position:  [0.0695354]


portfolio before change:  [-0.27223872]
curr_Stock_Price:  106.63883243400694
curr_Factors:  [1.06638832e+02 3.71279917e-02]
mat_Sqrt:  [[ 2.05478369e+01  0.00000000e+00]
 [-7.70745008e-03  1.76599867e-02]]
grads:  [-6.42140784e-03  8.47992951e+00]
Stock Position:  -0.006421407840777619
Bond Position:  [0.41253271]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.26491392]
Stock Price:  105.50617868767182
PL:  [-5.77109261]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-5.50380783e-02  1.91938848e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.30080560e-01 -7.22232897e-01]
 [-4.34124073e-02  9.26741033e-02]
 [ 4.00122344e-02 -3.64974310e-02]
 [-8.50800027e-02 -8.42604669e-02]
 [-2.78932185e-02  2.31311841e-01]
 [ 6.74060339e-02 -4.53800790e-02]
 [ 1.57804642e-01  7.27478819e-02]
 [ 2.89920974e-01 -1.29018290e-01]
 [ 8.07409105e-02  5.90367003e-02]
 [-9.76652491e-02  1.83372807e-03]
 [-1.93036153e-01  1.65531647e-01]
 [-5.80391280e-01 -7.37165715e-01]
 [ 6.13994703e-02  1.54281873e-01]
 [ 5.26532923e-02 -6.35560754e-02]
 [-5.24520813e-02  2.41509429e-01]
 [-1.36208847e-01  2.51923424e-02]
 [ 1.50588710e-02  6.18920120e-02]
 [-8.91255195e-02 -3.86595898e-02]
 [ 7.97284605e-02 -1.60012675e-02]
 [ 8.51505579e-02  3.12638740e-01]
 [ 3.78412386e-02  3.87777726e-01]
 [-4.01999123e-02  1.37217781e-01]
 [ 1.88608178e-02  4.43717246e-02]
 [ 6.27475964e-01 -1.91300107e-01]
 [-3.75462726e-03  6.52953382e-02]
 [-1.84133355e-01  1.36670112e-01]
 [-5.63322371e-02 -1.08938213e-01]
 [ 1.16300367e-01 -7.35044668e-02]
 [-9.74474271e-01 -1.11321971e-01]
 [ 1.14587906e-03  2.14445920e-01]
 [-6.89480476e-03 -1.28568774e-01]
 [-6.92612301e-04  6.07738941e-02]
 [-1.18954166e-02  1.71397417e-01]
 [-2.21059224e+00  3.42422290e-02]
 [-1.42378335e-01  8.31308153e-02]
 [-1.33420470e-01 -3.35357230e-01]
 [ 1.65330998e+00 -1.00656252e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.39595722]
curr_Stock_Price:  99.6517997730155
curr_Factors:  [9.96517998e+01 3.94742527e-02]
mat_Sqrt:  [[ 1.97989476e+01  0.00000000e+00]
 [-7.94725137e-03  1.82094405e-02]]
grads:  [1.45113283e-03 1.05406231e+01]
Stock Position:  0.001451132827353508
Bond Position:  [0.25134922]


portfolio before change:  [0.39586182]
curr_Stock_Price:  99.56440362773631
curr_Factors:  [9.95644036e+01 3.89659708e-02]
mat_Sqrt:  [[ 1.96538143e+01  0.00000000e+00]
 [-7.89592004e-03  1.80918256e-02]]
grads:  [-0.01032799 -4.86470365]
Stock Position:  -0.010327992592576225
Bond Position:  [1.42416224]


portfolio before change:  [0.39978741]
curr_Stock_Price:  99.20154932081981
curr_Factors:  [9.92015493e+01 3.93450585e-02]
mat_Sqrt:  [[ 1.96772115e+01  0.00000000e+00]
 [-7.93423554e-03  1.81796175e-02]]
grads:  [ 2.61659170e-02 -3.97276179e+01]
Stock Position:  0.026165916994911328
Bond Position:  [-2.1959121]


portfolio before change:  [0.39438975]
curr_Stock_Price:  99.00575456480176
curr_Factors:  [9.90057546e+01 3.94919397e-02]
mat_Sqrt:  [[ 1.96749968e+01  0.00000000e+00]
 [-7.94903161e-03  1.82135195e-02]]
grads:  [-1.50755434e-04  5.08820402e+00]
Stock Position:  -0.00015075543388429698
Bond Position:  [0.40931541]


portfolio before change:  [0.3945216]
curr_Stock_Price:  98.47058391936312
curr_Factors:  [9.84705839e+01 3.99627644e-02]
mat_Sqrt:  [[ 1.96849481e+01  0.00000000e+00]
 [-7.99627558e-03  1.83217691e-02]]
grads:  [ 1.22344491e-03 -1.99202549e+00]
Stock Position:  0.0012234449101694758
Bond Position:  [0.27404826]


portfolio before change:  [0.39477228]
curr_Stock_Price:  98.64748479794763
curr_Factors:  [9.86474848e+01 4.00288661e-02]
mat_Sqrt:  [[ 1.97366146e+01  0.00000000e+00]
 [-8.00288609e-03  1.83369156e-02]]
grads:  [-0.00617402 -4.59512759]
Stock Position:  -0.006174021626435107
Bond Position:  [1.00382399]


portfolio before change:  [0.39003282]
curr_Stock_Price:  99.4354561343414
curr_Factors:  [9.94354561e+01 4.04124923e-02]
mat_Sqrt:  [[ 1.99893691e+01  0.00000000e+00]
 [-8.04114343e-03  1.84245742e-02]]
grads:  [3.65492002e-03 1.25545285e+01]
Stock Position:  0.003654920023897151
Bond Position:  [0.02660418]


portfolio before change:  [0.39122112]
curr_Stock_Price:  99.75967139768322
curr_Factors:  [9.97596714e+01 4.11070054e-02]
mat_Sqrt:  [[ 2.02261363e+01  0.00000000e+00]
 [-8.10994505e-03  1.85822185e-02]]
grads:  [ 2.35341753e-03 -2.44212385e+00]
Stock Position:  0.0023534175268689534
Bond Position:  [0.15644497]


portfolio before change:  [0.39097764]
curr_Stock_Price:  99.64790310524604
curr_Factors:  [9.96479031e+01 4.25588520e-02]
mat_Sqrt:  [[ 2.05571600e+01  0.00000000e+00]
 [-8.25191876e-03  1.89075212e-02]]
grads:  [0.00922085 3.84756316]
Stock Position:  0.009220846652773524
Bond Position:  [-0.52786039]


portfolio before change:  [0.39785382]
curr_Stock_Price:  100.4007794879874
curr_Factors:  [1.00400779e+02 4.19896486e-02]
mat_Sqrt:  [[ 2.05735011e+01  0.00000000e+00]
 [-8.19655036e-03  1.87806562e-02]]
grads:  [ 0.01135503 -6.86974345]
Stock Position:  0.011355032609745025
Bond Position:  [-0.74220031]


portfolio before change:  [0.39655171]
curr_Stock_Price:  100.29427821385622
curr_Factors:  [1.00294278e+02 4.21213148e-02]
mat_Sqrt:  [[ 2.05838741e+01  0.00000000e+00]
 [-8.20939119e-03  1.88100783e-02]]
grads:  [0.00517428 3.1385675 ]
Stock Position:  0.0051742756699606025
Bond Position:  [-0.12239853]


portfolio before change:  [0.39513818]
curr_Stock_Price:  100.02405152507416
curr_Factors:  [1.00024052e+02 4.15616293e-02]
mat_Sqrt:  [[ 2.03915728e+01  0.00000000e+00]
 [-8.15466780e-03  1.86846912e-02]]
grads:  [-0.00475024  0.09814067]
Stock Position:  -0.004750243912371212
Bond Position:  [0.87027682]


portfolio before change:  [0.38254203]
curr_Stock_Price:  102.69863850095682
curr_Factors:  [1.02698639e+02 4.04196350e-02]
mat_Sqrt:  [[ 2.06471864e+01  0.00000000e+00]
 [-8.04185401e-03  1.84262024e-02]]
grads:  [-5.85029925e-03  8.98349227e+00]
Stock Position:  -0.0058502992483910644
Bond Position:  [0.9833598]


portfolio before change:  [0.38396509]
curr_Stock_Price:  102.47640486321393
curr_Factors:  [1.02476405e+02 3.99344211e-02]
mat_Sqrt:  [[ 2.04784734e+01  0.00000000e+00]
 [-7.99343942e-03  1.83152706e-02]]
grads:  [ -0.04405195 -40.24869364]
Stock Position:  -0.04405195442348124
Bond Position:  [4.89825101]


portfolio before change:  [0.39694338]
curr_Stock_Price:  102.19569161408714
curr_Factors:  [1.02195692e+02 4.04591790e-02]
mat_Sqrt:  [[ 2.05561188e+01  0.00000000e+00]
 [-8.04578687e-03  1.84352137e-02]]
grads:  [6.26254405e-03 8.36886816e+00]
Stock Position:  0.006262544054034426
Bond Position:  [-0.24306164]


portfolio before change:  [0.40299485]
curr_Stock_Price:  103.16683944139466
curr_Factors:  [1.03166839e+02 4.02604309e-02]
mat_Sqrt:  [[ 2.07004285e+01  0.00000000e+00]
 [-8.02600084e-03  1.83898782e-02]]
grads:  [ 1.20360537e-03 -3.45603569e+00]
Stock Position:  0.0012036053696469456
Bond Position:  [0.27882269]


portfolio before change:  [0.40050901]
curr_Stock_Price:  101.07255203242039
curr_Factors:  [1.01072552e+02 4.16851240e-02]
mat_Sqrt:  [[ 2.06359174e+01  0.00000000e+00]
 [-8.16677406e-03  1.87124301e-02]]
grads:  [2.56597629e-03 1.29063637e+01]
Stock Position:  0.002565976293371714
Bond Position:  [0.14115924]


portfolio before change:  [0.40082093]
curr_Stock_Price:  101.18723689895285
curr_Factors:  [1.01187237e+02 4.18042235e-02]
mat_Sqrt:  [[ 2.06888246e+01  0.00000000e+00]
 [-8.17843247e-03  1.87391429e-02]]
grads:  [-0.00605225  1.34437005]
Stock Position:  -0.00605225332341405
Bond Position:  [1.01323173]


portfolio before change:  [0.40505782]
curr_Stock_Price:  100.5081143020604
curr_Factors:  [1.00508114e+02 4.16307086e-02]
mat_Sqrt:  [[ 2.05072784e+01  0.00000000e+00]
 [-8.16144189e-03  1.87002126e-02]]
grads:  [2.05150380e-03 3.30969563e+00]
Stock Position:  0.0020515038025609375
Bond Position:  [0.19886504]


portfolio before change:  [0.40900686]
curr_Stock_Price:  102.42094392685543
curr_Factors:  [1.02420944e+02 4.09009656e-02]
mat_Sqrt:  [[ 2.07135985e+01  0.00000000e+00]
 [-8.08959486e-03  1.85355904e-02]]
grads:  [-0.00511731 -2.08569509]
Stock Position:  -0.005117312064306735
Bond Position:  [0.93312679]


portfolio before change:  [0.42468614]
curr_Stock_Price:  99.3797691964699
curr_Factors:  [9.93797692e+01 4.19244979e-02]
mat_Sqrt:  [[ 2.03484774e+01  0.00000000e+00]
 [-8.19018905e-03  1.87660806e-02]]
grads:  [ 0.00357496 -0.85266965]
Stock Position:  0.0035749571495293127
Bond Position:  [0.06940773]


portfolio before change:  [0.42618542]
curr_Stock_Price:  99.79672385352386
curr_Factors:  [9.97967239e+01 4.18850040e-02]
mat_Sqrt:  [[ 2.04242240e+01  0.00000000e+00]
 [-8.18633046e-03  1.87572395e-02]]
grads:  [1.08497288e-02 1.66676307e+01]
Stock Position:  0.010849728763015773
Bond Position:  [-0.65658197]


portfolio before change:  [0.43458784]
curr_Stock_Price:  100.578724744312
curr_Factors:  [1.00578725e+02 4.17116626e-02]
mat_Sqrt:  [[ 2.05416287e+01  0.00000000e+00]
 [-8.16937331e-03  1.87183858e-02]]
grads:  [1.00810562e-02 2.07164085e+01]
Stock Position:  0.010081056174661552
Bond Position:  [-0.57935194]


portfolio before change:  [0.42420088]
curr_Stock_Price:  99.55556521888215
curr_Factors:  [9.95555652e+01 4.18398082e-02]
mat_Sqrt:  [[ 2.03638732e+01  0.00000000e+00]
 [-8.18191255e-03  1.87471168e-02]]
grads:  [9.66753064e-04 7.31940714e+00]
Stock Position:  0.0009667530644718112
Bond Position:  [0.32795524]


portfolio before change:  [0.42446361]
curr_Stock_Price:  99.78492034273725
curr_Factors:  [9.97849203e+01 4.08164106e-02]
mat_Sqrt:  [[ 2.01596190e+01  0.00000000e+00]
 [-8.08122868e-03  1.85164211e-02]]
grads:  [1.89617800e-03 2.39634454e+00]
Stock Position:  0.0018961780028077337
Bond Position:  [0.23525364]


portfolio before change:  [0.4256555]
curr_Stock_Price:  100.39798530051779
curr_Factors:  [1.00397985e+02 4.14286449e-02]
mat_Sqrt:  [[ 2.04350339e+01  0.00000000e+00]
 [-8.14161113e-03  1.86547746e-02]]
grads:  [  0.02662025 -10.25475304]
Stock Position:  0.026620252049199163
Bond Position:  [-2.24696418]


portfolio before change:  [0.42247196]
curr_Stock_Price:  100.28894626985895
curr_Factors:  [1.00288946e+02 4.18692472e-02]
mat_Sqrt:  [[ 2.05211004e+01  0.00000000e+00]
 [-8.18479049e-03  1.87537110e-02]]
grads:  [1.20571481e-03 3.48172893e+00]
Stock Position:  0.0012057148096938982
Bond Position:  [0.3015521]


portfolio before change:  [0.42164799]
curr_Stock_Price:  99.57429317553586
curr_Factors:  [9.95742932e+01 4.12634794e-02]
mat_Sqrt:  [[ 2.02269385e+01  0.00000000e+00]
 [-8.12536566e-03  1.86175516e-02]]
grads:  [-6.15444731e-03  7.34092836e+00]
Stock Position:  -0.006154447314678427
Bond Position:  [1.03447273]


portfolio before change:  [0.42785822]
curr_Stock_Price:  98.58624125922881
curr_Factors:  [9.85862413e+01 4.09900938e-02]
mat_Sqrt:  [[ 1.99597807e+01  0.00000000e+00]
 [-8.09840417e-03  1.85557751e-02]]
grads:  [-5.20430424e-03 -5.87085223e+00]
Stock Position:  -0.005204304239973446
Bond Position:  [0.94093102]


portfolio before change:  [0.43603687]
curr_Stock_Price:  97.03732643325647
curr_Factors:  [9.70373264e+01 4.06825011e-02]
mat_Sqrt:  [[ 1.95723352e+01  0.00000000e+00]
 [-8.06796144e-03  1.84860220e-02]]
grads:  [ 0.00430303 -3.97621872]
Stock Position:  0.004303032163862568
Bond Position:  [0.01848213]


portfolio before change:  [0.43518983]
curr_Stock_Price:  96.83994239436487
curr_Factors:  [9.68399424e+01 4.03133794e-02]
mat_Sqrt:  [[ 1.94437096e+01  0.00000000e+00]
 [-8.03127680e-03  1.84019669e-02]]
grads:  [-0.05261646 -6.04946041]
Stock Position:  -0.05261645977752173
Bond Position:  [5.53056477]


portfolio before change:  [0.53439641]
curr_Stock_Price:  94.96761554006993
curr_Factors:  [9.49676155e+01 4.04003601e-02]
mat_Sqrt:  [[ 1.90883396e+01  0.00000000e+00]
 [-8.03993633e-03  1.84218084e-02]]
grads:  [4.96312167e-03 1.16408724e+01]
Stock Position:  0.004963121666264391
Bond Position:  [0.06306058]


portfolio before change:  [0.52737558]
curr_Stock_Price:  93.55142846262324
curr_Factors:  [9.35514285e+01 4.17458751e-02]
mat_Sqrt:  [[ 1.91142476e+01  0.00000000e+00]
 [-8.17272293e-03  1.87260607e-02]]
grads:  [-3.29632739e-03 -6.86576722e+00]
Stock Position:  -0.0032963273888935427
Bond Position:  [0.83575172]


portfolio before change:  [0.52972534]
curr_Stock_Price:  92.87028109838732
curr_Factors:  [9.28702811e+01 4.19153786e-02]
mat_Sqrt:  [[ 1.90135608e+01  0.00000000e+00]
 [-8.18929825e-03  1.87640396e-02]]
grads:  [1.35857191e-03 3.23884918e+00]
Stock Position:  0.001358571913240729
Bond Position:  [0.40355438]


portfolio before change:  [0.52773761]
curr_Stock_Price:  91.37004427738407
curr_Factors:  [9.13700443e+01 4.38009857e-02]
mat_Sqrt:  [[ 1.91225488e+01  0.00000000e+00]
 [-8.37147401e-03  1.91814567e-02]]
grads:  [3.28975754e-03 8.93557879e+00]
Stock Position:  0.003289757538561293
Bond Position:  [0.22715232]


portfolio before change:  [0.52775338]
curr_Stock_Price:  91.36620686234184
curr_Factors:  [9.13662069e+01 4.30095078e-02]
mat_Sqrt:  [[ 1.89481944e+01  0.00000000e+00]
 [-8.29549350e-03  1.90073635e-02]]
grads:  [-0.11587636  1.8015244 ]
Stock Position:  -0.11587635557187967
Bond Position:  [11.11493645]


portfolio before change:  [0.75474443]
curr_Stock_Price:  89.41929032398234
curr_Factors:  [8.94192903e+01 4.37948066e-02]
mat_Sqrt:  [[ 1.87129616e+01  0.00000000e+00]
 [-8.37088350e-03  1.91801036e-02]]
grads:  [-0.00566971  4.33422138]
Stock Position:  -0.005669710393767904
Bond Position:  [1.26172591]


portfolio before change:  [0.76164046]
curr_Stock_Price:  88.23081614245903
curr_Factors:  [8.82308161e+01 4.33345170e-02]
mat_Sqrt:  [[ 1.83669598e+01  0.00000000e+00]
 [-8.32677772e-03  1.90790446e-02]]
grads:  [-1.52329164e-02 -1.75772549e+01]
Stock Position:  -0.015232916409639499
Bond Position:  [2.1056531]


portfolio before change:  [0.74075026]
curr_Stock_Price:  89.61948154447089
curr_Factors:  [8.96194815e+01 4.32918275e-02]
mat_Sqrt:  [[ 1.86468461e+01  0.00000000e+00]
 [-8.32267529e-03  1.90696448e-02]]
grads:  [ 0.08630843 -5.27834964]
Stock Position:  0.0863084289072605
Bond Position:  [-6.9941664]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.73564654]
Stock Price:  89.57047834983511
PL:  [0.73564654]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.03023247e-01  7.65789610e-01]
 [-1.64718044e-01 -8.71985592e-02]
 [ 8.21682844e-01 -7.05955350e-01]
 [-2.68030090e-02  2.61360761e-02]
 [ 3.70715086e-02 -2.56601918e-02]
 [-7.87145396e-02 -1.03201038e-01]
 [-7.04841137e-02  1.66308436e-01]
 [-1.88885929e-02 -6.61479300e-02]
 [ 1.61099467e-01  7.66978998e-02]
 [ 1.58938489e-01  6.91915116e-03]
 [ 1.30506370e-01  2.35753882e-01]
 [-4.03907681e-02  9.40454141e-02]
 [ 1.25958428e-02  9.69257745e-02]
 [-4.09217814e-01 -5.36149547e-01]
 [ 7.19529172e-02  2.08445809e-01]
 [ 5.58661377e-02 -2.15932863e-02]
 [-5.33417157e-02  2.91518659e-01]
 [ 2.73503986e-02  1.39961105e-01]
 [ 1.47428062e-02  6.97399492e-02]
 [-1.06482678e-01 -3.03046339e-02]
 [ 2.24968809e-01  2.88757327e-01]
 [ 2.58328467e-02  9.59420370e-02]
 [-1.07748622e-02 -6.78059582e-02]
 [ 7.37437529e-02  1.82384640e-01]
 [ 6.34978014e-02  1.34579562e-01]
 [ 7.71244060e-01 -5.67854048e-01]
 [-2.61299541e-01  3.42244240e-01]
 [-5.15314833e-02  7.74205461e-02]
 [ 6.02070538e-02 -1.60334052e-01]
 [-1.35427607e-02 -4.31608186e-02]
 [-7.13651620e-01 -9.01637958e-02]
 [-1.18064713e-01  5.02208809e-03]
 [ 4.74810003e-03 -9.12587902e-02]
 [ 8.90232863e-02  9.82505178e-02]
 [-2.80105874e-01 -1.40487054e-01]
 [-8.09520085e-02 -4.11047324e-01]
 [-1.14707115e-01  2.56720340e-01]
 [-1.23336467e-01  1.17847232e-01]
 [ 3.23538521e-01  6.44880063e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.5159232]
curr_Stock_Price:  101.32664663029178
curr_Factors:  [1.01326647e+02 3.91177645e-02]
mat_Sqrt:  [[ 2.00405983e+01  0.00000000e+00]
 [-7.91128454e-03  1.81270301e-02]]
grads:  [3.67873863e-02 4.22457294e+01]
Stock Position:  0.03678738633075701
Bond Position:  [7.7883807]


portfolio before change:  [11.44294397]
curr_Stock_Price:  99.31636962763488
curr_Factors:  [9.93163696e+01 4.03364116e-02]
mat_Sqrt:  [[ 1.99466270e+01  0.00000000e+00]
 [-8.03357072e-03  1.84072230e-02]]
grads:  [-0.01016586 -4.73719254]
Stock Position:  -0.010165859909516824
Bond Position:  [12.45258027]


portfolio before change:  [11.44271531]
curr_Stock_Price:  99.49199008574857
curr_Factors:  [9.94919901e+01 3.91964177e-02]
mat_Sqrt:  [[ 1.96975089e+01  0.00000000e+00]
 [-7.91923407e-03  1.81452448e-02]]
grads:  [ 2.60732802e-02 -3.89058047e+01]
Stock Position:  0.02607328020039595
Bond Position:  [8.84863277]


portfolio before change:  [11.45602219]
curr_Stock_Price:  99.95993044734148
curr_Factors:  [9.99599304e+01 4.02595756e-02]
mat_Sqrt:  [[ 2.00567491e+01  0.00000000e+00]
 [-8.02591559e-03  1.83896828e-02]]
grads:  [-7.67636378e-04  1.42123583e+00]
Stock Position:  -0.00076763637772935
Bond Position:  [11.53275507]


portfolio before change:  [11.45842714]
curr_Stock_Price:  98.7050868736514
curr_Factors:  [9.87050869e+01 4.05972400e-02]
mat_Sqrt:  [[ 1.98878479e+01  0.00000000e+00]
 [-8.05950272e-03  1.84666406e-02]]
grads:  [ 1.30091918e-03 -1.38954303e+00]
Stock Position:  0.0013009191777847281
Bond Position:  [11.3300198]


portfolio before change:  [11.45747557]
curr_Stock_Price:  96.88490252078984
curr_Factors:  [9.68849025e+01 4.07418202e-02]
mat_Sqrt:  [[ 1.95558330e+01  0.00000000e+00]
 [-8.07384124e-03  1.84994943e-02]]
grads:  [-0.0063283 -5.578587 ]
Stock Position:  -0.006328299347108418
Bond Position:  [12.07059224]


portfolio before change:  [11.45070792]
curr_Stock_Price:  98.19276817315375
curr_Factors:  [9.81927682e+01 4.03682861e-02]
mat_Sqrt:  [[ 1.97287541e+01  0.00000000e+00]
 [-8.03674423e-03  1.84144944e-02]]
grads:  [1.06384746e-04 9.03138760e+00]
Stock Position:  0.000106384745634774
Bond Position:  [11.44026171]


portfolio before change:  [11.45225026]
curr_Stock_Price:  99.24755819468915
curr_Factors:  [9.92475582e+01 3.98966045e-02]
mat_Sqrt:  [[ 1.98238407e+01  0.00000000e+00]
 [-7.98965376e-03  1.83065966e-02]]
grads:  [-2.40911522e-03 -3.61333849e+00]
Stock Position:  -0.0024091152248323093
Bond Position:  [11.69134906]


portfolio before change:  [11.45372569]
curr_Stock_Price:  99.24178041945959
curr_Factors:  [9.92417804e+01 3.93923876e-02]
mat_Sqrt:  [[ 1.96970279e+01  0.00000000e+00]
 [-7.93900624e-03  1.81905485e-02]]
grads:  [0.0098783  4.21635992]
Stock Position:  0.00987830122458404
Bond Position:  [10.47338549]


portfolio before change:  [11.44786531]
curr_Stock_Price:  98.51598461953753
curr_Factors:  [9.85159846e+01 3.81382384e-02]
mat_Sqrt:  [[ 1.92392003e+01  0.00000000e+00]
 [-7.81160556e-03  1.78986369e-02]]
grads:  [0.00841814 0.3865742 ]
Stock Position:  0.008418138539702514
Bond Position:  [10.61854411]


portfolio before change:  [11.44549799]
curr_Stock_Price:  98.07708463905325
curr_Factors:  [9.80770846e+01 3.72195599e-02]
mat_Sqrt:  [[ 1.89213956e+01  0.00000000e+00]
 [-7.71694861e-03  1.76817506e-02]]
grads:  [1.23351261e-02 1.33331754e+01]
Stock Position:  0.012335126068178673
Bond Position:  [10.23570479]


portfolio before change:  [11.46307169]
curr_Stock_Price:  99.39804050226589
curr_Factors:  [9.93980405e+01 3.57624500e-02]
mat_Sqrt:  [[ 1.87971261e+01  0.00000000e+00]
 [-7.56438497e-03  1.73321833e-02]]
grads:  [3.47933826e-05 5.42605696e+00]
Stock Position:  3.47933825928876e-05
Bond Position:  [11.4596133]


portfolio before change:  [11.46452077]
curr_Stock_Price:  99.87328677594716
curr_Factors:  [9.98732868e+01 3.50213807e-02]
mat_Sqrt:  [[ 1.86902872e+01  0.00000000e+00]
 [-7.48560011e-03  1.71516646e-02]]
grads:  [2.93723250e-03 5.65110017e+00]
Stock Position:  0.0029372324950882223
Bond Position:  [11.17116971]


portfolio before change:  [11.46767708]
curr_Stock_Price:  100.47242981985099
curr_Factors:  [1.00472430e+02 3.42870486e-02]
mat_Sqrt:  [[ 1.86042410e+01  0.00000000e+00]
 [-7.40670492e-03  1.69708930e-02]]
grads:  [ -0.03457344 -31.59230032]
Stock Position:  -0.03457344271809392
Bond Position:  [14.94135487]


portfolio before change:  [11.44337595]
curr_Stock_Price:  101.22933786873463
curr_Factors:  [1.01229338e+02 3.44491511e-02]
mat_Sqrt:  [[ 1.87886535e+01  0.00000000e+00]
 [-7.42419300e-03  1.70109632e-02]]
grads:  [8.67151689e-03 1.22536159e+01]
Stock Position:  0.008671516885392739
Bond Position:  [10.56556403]


portfolio before change:  [11.45179241]
curr_Stock_Price:  102.04761262194319
curr_Factors:  [1.02047613e+02 3.36533866e-02]
mat_Sqrt:  [[ 1.87204911e+01  0.00000000e+00]
 [-7.33794376e-03  1.68133414e-02]]
grads:  [ 0.00248081 -1.28429477]
Stock Position:  0.00248081392931886
Bond Position:  [11.19863127]


portfolio before change:  [11.45619726]
curr_Stock_Price:  103.25888495041532
curr_Factors:  [1.03258885e+02 3.28176896e-02]
mat_Sqrt:  [[ 1.87060216e+01  0.00000000e+00]
 [-7.24626134e-03  1.66032705e-02]]
grads:  [3.94992902e-03 1.75579057e+01]
Stock Position:  0.003949929023376817
Bond Position:  [11.048332]


portfolio before change:  [11.46062862]
curr_Stock_Price:  104.03110804426133
curr_Factors:  [1.04031108e+02 3.26677545e-02]
mat_Sqrt:  [[ 1.88028147e+01  0.00000000e+00]
 [-7.22968929e-03  1.65652992e-02]]
grads:  [4.70325502e-03 8.44905384e+00]
Stock Position:  0.004703255024833202
Bond Position:  [10.97134379]


portfolio before change:  [11.46119937]
curr_Stock_Price:  103.86085344777382
curr_Factors:  [1.03860853e+02 3.20563059e-02]
mat_Sqrt:  [[ 1.85955327e+01  0.00000000e+00]
 [-7.16170995e-03  1.64095390e-02]]
grads:  [2.42960587e-03 4.24996396e+00]
Stock Position:  0.0024296058684669646
Bond Position:  [11.20885843]


portfolio before change:  [11.46542475]
curr_Stock_Price:  105.0232555837912
curr_Factors:  [1.05023256e+02 3.14239143e-02]
mat_Sqrt:  [[ 1.86172537e+01  0.00000000e+00]
 [-7.09071667e-03  1.62468729e-02]]
grads:  [-0.00642999 -1.86525949]
Stock Position:  -0.00642998728575148
Bond Position:  [12.14072294]


portfolio before change:  [11.47191508]
curr_Stock_Price:  104.24990255473233
curr_Factors:  [1.04249903e+02 3.29575654e-02]
mat_Sqrt:  [[ 1.89257552e+01  0.00000000e+00]
 [-7.26168745e-03  1.66386162e-02]]
grads:  [ 0.01854578 17.35464794]
Stock Position:  0.018545777135375873
Bond Position:  [9.53851962]


portfolio before change:  [11.48745991]
curr_Stock_Price:  105.02379516823882
curr_Factors:  [1.05023795e+02 3.25709879e-02]
mat_Sqrt:  [[ 1.89541003e+01  0.00000000e+00]
 [-7.21897365e-03  1.65407466e-02]]
grads:  [3.57207061e-03 5.80034501e+00]
Stock Position:  0.0035720706134584218
Bond Position:  [11.1123075]


portfolio before change:  [11.48887208]
curr_Stock_Price:  105.03024744382682
curr_Factors:  [1.05030247e+02 3.23900496e-02]
mat_Sqrt:  [[ 1.89025413e+01  0.00000000e+00]
 [-7.19889431e-03  1.64947391e-02]]
grads:  [-2.13557574e-03 -4.11076271e+00]
Stock Position:  -0.002135575735227196
Bond Position:  [11.71317213]


portfolio before change:  [11.49274114]
curr_Stock_Price:  103.90417153622944
curr_Factors:  [1.03904172e+02 3.16216515e-02]
mat_Sqrt:  [[ 1.84767362e+01  0.00000000e+00]
 [-7.11299110e-03  1.62979101e-02]]
grads:  [8.29924365e-03 1.11906765e+01]
Stock Position:  0.008299243646354348
Bond Position:  [10.63041511]


portfolio before change:  [11.50332065]
curr_Stock_Price:  105.01880603720011
curr_Factors:  [1.05018806e+02 3.02664273e-02]
mat_Sqrt:  [[ 1.82703832e+01  0.00000000e+00]
 [-6.95889961e-03  1.59448421e-02]]
grads:  [6.69023393e-03 8.44031952e+00]
Stock Position:  0.006690233928854376
Bond Position:  [10.80072027]


portfolio before change:  [11.50402839]
curr_Stock_Price:  104.92278104062501
curr_Factors:  [1.04922781e+02 3.05034988e-02]
mat_Sqrt:  [[ 1.83250269e+01  0.00000000e+00]
 [-6.98610035e-03  1.60071668e-02]]
grads:  [ 2.85626994e-02 -3.54749878e+01]
Stock Position:  0.02856269938423364
Bond Position:  [8.50715054]


portfolio before change:  [11.45882096]
curr_Stock_Price:  103.30280494106745
curr_Factors:  [1.03302805e+02 3.18555654e-02]
mat_Sqrt:  [[ 1.84376163e+01  0.00000000e+00]
 [-7.13925099e-03  1.63580790e-02]]
grads:  [-6.07084493e-03  2.09220312e+01]
Stock Position:  -0.006070844929195227
Bond Position:  [12.08595627]


portfolio before change:  [11.47515712]
curr_Stock_Price:  100.86075344445159
curr_Factors:  [1.00860753e+02 3.30730392e-02]
mat_Sqrt:  [[ 1.83425310e+01  0.00000000e+00]
 [-7.27439775e-03  1.66677392e-02]]
grads:  [-9.67281284e-04  4.64493386e+00]
Stock Position:  -0.0009672812839269387
Bond Position:  [11.57271784]


portfolio before change:  [11.47611885]
curr_Stock_Price:  101.36210991828962
curr_Factors:  [1.01362110e+02 3.20449322e-02]
mat_Sqrt:  [[ 1.81449310e+01  0.00000000e+00]
 [-7.16043934e-03  1.64066276e-02]]
grads:  [-5.38357715e-04 -9.77251730e+00]
Stock Position:  -0.0005383577148069136
Bond Position:  [11.53068792]


portfolio before change:  [11.47799854]
curr_Stock_Price:  100.54802674057177
curr_Factors:  [1.00548027e+02 3.10716385e-02]
mat_Sqrt:  [[ 1.77237506e+01  0.00000000e+00]
 [-7.05085964e-03  1.61555490e-02]]
grads:  [-1.82690938e-03 -2.67157857e+00]
Stock Position:  -0.0018269093806287534
Bond Position:  [11.66169067]


portfolio before change:  [11.48143024]
curr_Stock_Price:  99.46756946488027
curr_Factors:  [9.94675695e+01 3.11041782e-02]
mat_Sqrt:  [[ 1.75424752e+01  0.00000000e+00]
 [-7.05455067e-03  1.61640062e-02]]
grads:  [-0.04292452 -5.57805996]
Stock Position:  -0.042924519893874205
Bond Position:  [15.75102791]


portfolio before change:  [11.45771503]
curr_Stock_Price:  100.06592708616473
curr_Factors:  [1.00065927e+02 3.08201595e-02]
mat_Sqrt:  [[ 1.75672452e+01  0.00000000e+00]
 [-7.02226852e-03  1.60900385e-02]]
grads:  [-0.00659596  0.31212406]
Stock Position:  -0.006595962699211398
Bond Position:  [12.11774615]


portfolio before change:  [11.46983289]
curr_Stock_Price:  98.45842174832286
curr_Factors:  [9.84584217e+01 3.18940402e-02]
mat_Sqrt:  [[ 1.75835936e+01  0.00000000e+00]
 [-7.14356104e-03  1.63679546e-02]]
grads:  [-1.99507006e-03 -5.57545475e+00]
Stock Position:  -0.0019950700640376925
Bond Position:  [11.66626434]


portfolio before change:  [11.47027892]
curr_Stock_Price:  98.96584259840571
curr_Factors:  [9.89658426e+01 3.28996307e-02]
mat_Sqrt:  [[ 1.79506772e+01  0.00000000e+00]
 [-7.25530214e-03  1.66239856e-02]]
grads:  [0.0073481  5.91016619]
Stock Position:  0.00734809756471868
Bond Position:  [10.74306825]


portfolio before change:  [11.4842919]
curr_Stock_Price:  100.69009943089736
curr_Factors:  [1.00690099e+02 3.26282215e-02]
mat_Sqrt:  [[ 1.81879382e+01  0.00000000e+00]
 [-7.22531345e-03  1.65552729e-02]]
grads:  [-0.01877175 -8.48594007]
Stock Position:  -0.018771751201705853
Bond Position:  [13.37442139]


portfolio before change:  [11.46352567]
curr_Stock_Price:  101.88541348420692
curr_Factors:  [1.01885413e+02 3.00974508e-02]
mat_Sqrt:  [[ 1.76757100e+01  0.00000000e+00]
 [-6.93944676e-03  1.59002700e-02]]
grads:  [-1.47291264e-02 -2.58515940e+01]
Stock Position:  -0.014729126448016076
Bond Position:  [12.9642088]


portfolio before change:  [11.46595142]
curr_Stock_Price:  101.83075152446399
curr_Factors:  [1.01830752e+02 2.95647319e-02]
mat_Sqrt:  [[ 1.75091846e+01  0.00000000e+00]
 [-6.87775915e-03  1.57589260e-02]]
grads:  [-1.52215739e-04  1.62904718e+01]
Stock Position:  -0.00015221573910886106
Bond Position:  [11.48145166]


portfolio before change:  [11.46746809]
curr_Stock_Price:  101.29595538410962
curr_Factors:  [1.01295955e+02 2.82636088e-02]
mat_Sqrt:  [[ 1.70296574e+01  0.00000000e+00]
 [-6.72471368e-03  1.54082547e-02]]
grads:  [-4.22226453e-03  7.64831801e+00]
Stock Position:  -0.004222264532516903
Bond Position:  [11.89516641]


portfolio before change:  [11.47293713]
curr_Stock_Price:  100.35284727334322
curr_Factors:  [1.00352847e+02 2.83512959e-02]
mat_Sqrt:  [[ 1.68972549e+01  0.00000000e+00]
 [-6.73513722e-03  1.54321381e-02]]
grads:  [0.02081305 4.17881217]
Stock Position:  0.020813048962798373
Bond Position:  [9.38428841]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.49230249]
Stock Price:  101.22692637549878
PL:  [10.26537612]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.82083302e-01  4.85803908e-01]
 [-1.86289695e-01 -7.53509756e-02]
 [ 7.71460875e-01 -6.50460780e-01]
 [ 5.47998183e-03  2.40640595e-02]
 [ 2.12329200e-02 -5.13768891e-03]
 [-8.65606794e-02 -7.82189797e-02]
 [-4.04696144e-02  2.07047140e-01]
 [ 6.87934187e-02 -4.50689669e-02]
 [ 1.66091617e-01  8.60315020e-02]
 [ 2.37013130e-01 -8.30535586e-02]
 [ 1.23652944e-01  2.11318769e-01]
 [ 1.59194508e-01  2.14754168e-01]
 [ 2.36160616e-01  2.21035529e-02]
 [-9.88976895e-02 -7.80142560e-02]
 [ 9.62085850e-02  2.38258963e-01]
 [ 4.04869451e-02  1.28625824e-01]
 [ 4.66503104e-02  6.96295895e-02]
 [ 1.02098597e-01  6.75640196e-02]
 [ 1.58505462e-02  3.74463768e-03]
 [ 1.99886070e-01 -1.06443970e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 4.08898027e-02  1.91270149e-01]
 [ 1.48703444e-02  8.26519070e-02]
 [-4.09427952e-03 -5.15212587e-02]
 [ 5.37051642e-02  1.50656616e-01]
 [ 4.50731128e-02  1.80920712e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.66828108e-01  1.06577013e-01]
 [-4.20363843e-01  7.30246156e-02]
 [ 2.52566178e-01 -1.04576127e-01]
 [-1.53640154e+00 -1.73695963e-01]
 [ 3.08628352e-01  5.63313760e-01]
 [ 7.81091627e-04 -1.31538252e-01]
 [ 1.32943097e-02  6.01426680e-02]
 [-3.31021445e-02  1.68269660e-01]
 [-1.74185116e+00 -5.97533382e-02]
 [-9.58533697e-02  1.87813631e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.24372341e+00 -4.74505122e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.03479427]
curr_Stock_Price:  100.50109989907389
curr_Factors:  [1.00501100e+02 3.97832227e-02]
mat_Sqrt:  [[ 2.00456801e+01  0.00000000e+00]
 [-7.97829282e-03  1.82805654e-02]]
grads:  [1.96603711e-02 2.65748842e+01]
Stock Position:  0.01966037111272785
Bond Position:  [4.05890535]


portfolio before change:  [6.05113389]
curr_Stock_Price:  101.30638625647484
curr_Factors:  [1.01306386e+02 3.99230046e-02]
mat_Sqrt:  [[ 2.02417676e+01  0.00000000e+00]
 [-7.99229675e-03  1.83126524e-02]]
grads:  [-0.01082789 -4.11469479]
Stock Position:  -0.010827886242736158
Bond Position:  [7.14806792]


portfolio before change:  [6.05872335]
curr_Stock_Price:  100.68799279631924
curr_Factors:  [1.00687993e+02 3.98681088e-02]
mat_Sqrt:  [[ 2.01043715e+01  0.00000000e+00]
 [-7.98679999e-03  1.83000578e-02]]
grads:  [ 2.42522636e-02 -3.55441927e+01]
Stock Position:  0.02425226357797065
Bond Position:  [3.61681161]


portfolio before change:  [6.05778267]
curr_Stock_Price:  100.63056265271628
curr_Factors:  [1.00630563e+02 3.95330280e-02]
mat_Sqrt:  [[ 2.00082885e+01  0.00000000e+00]
 [-7.95316571e-03  1.82229919e-02]]
grads:  [7.98788884e-04 1.32053285e+00]
Stock Position:  0.0007987888835025396
Bond Position:  [5.97740009]


portfolio before change:  [6.05753565]
curr_Stock_Price:  99.38587790281333
curr_Factors:  [9.93858779e+01 3.90186941e-02]
mat_Sqrt:  [[ 1.96318417e+01  0.00000000e+00]
 [-7.90126006e-03  1.81040612e-02]]
grads:  [ 0.00096734 -0.28378654]
Stock Position:  0.0009673391356023769
Bond Position:  [5.9613958]


portfolio before change:  [6.0576474]
curr_Stock_Price:  98.73101871778917
curr_Factors:  [9.87310187e+01 3.93333765e-02]
mat_Sqrt:  [[ 1.95809714e+01  0.00000000e+00]
 [-7.93305757e-03  1.81769184e-02]]
grads:  [-0.00616406 -4.30320355]
Stock Position:  -0.006164057875568026
Bond Position:  [6.66623111]


portfolio before change:  [6.05632816]
curr_Stock_Price:  99.08023104964859
curr_Factors:  [9.9080231e+01 3.9064990e-02]
mat_Sqrt:  [[ 1.95830742e+01  0.00000000e+00]
 [-7.90594611e-03  1.81147983e-02]]
grads:  [2.54776985e-03 1.14297238e+01]
Stock Position:  0.0025477698463390076
Bond Position:  [5.80389454]


portfolio before change:  [6.05881329]
curr_Stock_Price:  99.77087010419545
curr_Factors:  [9.97708701e+01 3.91794213e-02]
mat_Sqrt:  [[ 1.97484388e+01  0.00000000e+00]
 [-7.91751692e-03  1.81413103e-02]]
grads:  [ 0.00248747 -2.4843281 ]
Stock Position:  0.0024874730331092905
Bond Position:  [5.81063594]


portfolio before change:  [6.05663634]
curr_Stock_Price:  98.6036920915607
curr_Factors:  [9.86036921e+01 4.10560861e-02]
mat_Sqrt:  [[ 1.99793774e+01  0.00000000e+00]
 [-8.10492059e-03  1.85707061e-02]]
grads:  [0.01019245 4.63264572]
Stock Position:  0.010192451891045737
Bond Position:  [5.05162295]


portfolio before change:  [6.06523474]
curr_Stock_Price:  99.38534020753595
curr_Factors:  [9.93853402e+01 4.06485195e-02]
mat_Sqrt:  [[ 2.00375535e+01  0.00000000e+00]
 [-8.06459120e-03  1.84782998e-02]]
grads:  [ 0.01001947 -4.4946537 ]
Stock Position:  0.010019465977749087
Bond Position:  [5.06944671]


portfolio before change:  [6.05619855]
curr_Stock_Price:  98.42022829417716
curr_Factors:  [9.84202283e+01 4.29674208e-02]
mat_Sqrt:  [[ 2.04011200e+01  0.00000000e+00]
 [-8.29143373e-03  1.89980613e-02]]
grads:  [1.05817728e-02 1.11231754e+01]
Stock Position:  0.010581772754894641
Bond Position:  [5.01473806]


portfolio before change:  [6.05073979]
curr_Stock_Price:  97.84512133889571
curr_Factors:  [9.78451213e+01 4.27853308e-02]
mat_Sqrt:  [[ 2.02388869e+01  0.00000000e+00]
 [-8.27384610e-03  1.89577630e-02]]
grads:  [ 0.01249678 11.32803315]
Stock Position:  0.012496779731820111
Bond Position:  [4.82799086]


portfolio before change:  [6.03164173]
curr_Stock_Price:  96.26858782933958
curr_Factors:  [9.62685878e+01 4.29360174e-02]
mat_Sqrt:  [[ 1.99478218e+01  0.00000000e+00]
 [-8.28840321e-03  1.89911176e-02]]
grads:  [0.01232252 1.163889  ]
Stock Position:  0.012322518172659872
Bond Position:  [4.84537031]


portfolio before change:  [6.0291027]
curr_Stock_Price:  96.01338526653397
curr_Factors:  [9.60133853e+01 4.36376686e-02]
mat_Sqrt:  [[ 2.00568420e+01  0.00000000e+00]
 [-8.35585243e-03  1.91456631e-02]]
grads:  [-0.00662846 -4.0747743 ]
Stock Position:  -0.006628456388229713
Bond Position:  [6.66552324]


portfolio before change:  [6.03322846]
curr_Stock_Price:  95.51666022560623
curr_Factors:  [9.55166602e+01 4.50412977e-02]
mat_Sqrt:  [[ 2.02714389e+01  0.00000000e+00]
 [-8.48917407e-03  1.94511414e-02]]
grads:  [9.87563452e-03 1.22490993e+01]
Stock Position:  0.009875634519977828
Bond Position:  [5.08994084]


portfolio before change:  [6.0311708]
curr_Stock_Price:  95.24387268246315
curr_Factors:  [9.52438727e+01 4.55418930e-02]
mat_Sqrt:  [[ 2.03255630e+01  0.00000000e+00]
 [-8.53621864e-03  1.95589340e-02]]
grads:  [4.75380961e-03 6.57632075e+00]
Stock Position:  0.004753809607949708
Bond Position:  [5.57839956]


portfolio before change:  [6.03639947]
curr_Stock_Price:  96.19707203736442
curr_Factors:  [9.61970720e+01 4.81157025e-02]
mat_Sqrt:  [[ 2.11011084e+01  0.00000000e+00]
 [-8.77411671e-03  2.01040270e-02]]
grads:  [0.00365095 3.46346479]
Stock Position:  0.0036509529767905754
Bond Position:  [5.68518848]


portfolio before change:  [6.03290471]
curr_Stock_Price:  95.04519378762893
curr_Factors:  [9.50451938e+01 4.95594609e-02]
mat_Sqrt:  [[ 2.11589176e+01  0.00000000e+00]
 [-8.90478172e-03  2.04034181e-02]]
grads:  [0.00621894 3.3114069 ]
Stock Position:  0.006218935901547698
Bond Position:  [5.44182474]


portfolio before change:  [6.03572343]
curr_Stock_Price:  95.38905472814209
curr_Factors:  [9.53890547e+01 4.98382887e-02]
mat_Sqrt:  [[ 2.12951207e+01  0.00000000e+00]
 [-8.92979630e-03  2.04607337e-02]]
grads:  [0.00082107 0.18301581]
Stock Position:  0.0008210725962483761
Bond Position:  [5.95740209]


portfolio before change:  [6.03746905]
curr_Stock_Price:  96.60807675931687
curr_Factors:  [9.66080768e+01 5.04242842e-02]
mat_Sqrt:  [[ 2.16936839e+01  0.00000000e+00]
 [-8.98214088e-03  2.05806702e-02]]
grads:  [ 0.00707257 -5.17203614]
Stock Position:  0.007072570687066125
Bond Position:  [5.3542016]


portfolio before change:  [6.03733178]
curr_Stock_Price:  96.49403115494071
curr_Factors:  [9.64940312e+01 5.01588630e-02]
mat_Sqrt:  [[ 2.16109716e+01  0.00000000e+00]
 [-8.95846978e-03  2.05264329e-02]]
grads:  [ 0.00194941 -1.84045566]
Stock Position:  0.0019494084521206067
Bond Position:  [5.8492255]


portfolio before change:  [6.03718787]
curr_Stock_Price:  96.04512390292243
curr_Factors:  [9.60451239e+01 5.09395819e-02]
mat_Sqrt:  [[ 2.16771912e+01  0.00000000e+00]
 [-9.02791953e-03  2.06855623e-02]]
grads:  [5.73722575e-03 9.24655306e+00]
Stock Position:  0.005737225745683922
Bond Position:  [5.48615531]


portfolio before change:  [6.03412688]
curr_Stock_Price:  95.39205567600696
curr_Factors:  [9.53920557e+01 5.06384440e-02]
mat_Sqrt:  [[ 2.14660622e+01  0.00000000e+00]
 [-9.00119494e-03  2.06243286e-02]]
grads:  [2.37316902e-03 4.00749564e+00]
Stock Position:  0.0023731690231554334
Bond Position:  [5.80774541]


portfolio before change:  [6.03176655]
curr_Stock_Price:  94.09153980997885
curr_Factors:  [9.40915398e+01 5.10480549e-02]
mat_Sqrt:  [[ 2.12588699e+01  0.00000000e+00]
 [-9.03752664e-03  2.07075750e-02]]
grads:  [-1.25030165e-03 -2.48803922e+00]
Stock Position:  -0.0012503016538759591
Bond Position:  [6.14940936]


portfolio before change:  [6.03162682]
curr_Stock_Price:  94.81813063599672
curr_Factors:  [9.48181306e+01 5.11263296e-02]
mat_Sqrt:  [[ 2.14394528e+01  0.00000000e+00]
 [-9.04445285e-03  2.07234449e-02]]
grads:  [5.57183539e-03 7.26986349e+00]
Stock Position:  0.0055718353853922015
Bond Position:  [5.5033158]


portfolio before change:  [6.02522577]
curr_Stock_Price:  93.54583801946492
curr_Factors:  [9.3545838e+01 5.1604955e-02]
mat_Sqrt:  [[ 2.12505499e+01  0.00000000e+00]
 [-9.08668961e-03  2.08202215e-02]]
grads:  [5.83671414e-03 8.68966317e+00]
Stock Position:  0.005836714140580024
Bond Position:  [5.47922546]


portfolio before change:  [6.03397113]
curr_Stock_Price:  94.92682272766606
curr_Factors:  [9.49268227e+01 5.19591906e-02]
mat_Sqrt:  [[ 2.16381503e+01  0.00000000e+00]
 [-9.11782347e-03  2.08915581e-02]]
grads:  [8.23367976e-03 8.37359250e+00]
Stock Position:  0.008233679762367658
Bond Position:  [5.25237407]


portfolio before change:  [6.03616794]
curr_Stock_Price:  95.11388649318769
curr_Factors:  [9.51138865e+01 5.20427680e-02]
mat_Sqrt:  [[ 2.16982207e+01  0.00000000e+00]
 [-9.12515363e-03  2.09083536e-02]]
grads:  [-0.00554488  5.09734121]
Stock Position:  -0.005544882621334744
Bond Position:  [6.56356328]


portfolio before change:  [6.04908989]
curr_Stock_Price:  92.9314318257946
curr_Factors:  [9.29314318e+01 5.22878721e-02]
mat_Sqrt:  [[ 2.12502044e+01  0.00000000e+00]
 [-9.14661660e-03  2.09575315e-02]]
grads:  [-0.01828186  3.48440921]
Stock Position:  -0.018281861192787456
Bond Position:  [7.74804943]


portfolio before change:  [6.05845808]
curr_Stock_Price:  92.47198075025345
curr_Factors:  [9.24719808e+01 5.28879495e-02]
mat_Sqrt:  [[ 2.12661330e+01  0.00000000e+00]
 [-9.19895207e-03  2.10774471e-02]]
grads:  [ 0.00973028 -4.96151772]
Stock Position:  0.009730279335334048
Bond Position:  [5.15867988]


portfolio before change:  [6.04741263]
curr_Stock_Price:  91.27054296392984
curr_Factors:  [9.12705430e+01 5.31752382e-02]
mat_Sqrt:  [[ 2.10467652e+01  0.00000000e+00]
 [-9.22390270e-03  2.11346162e-02]]
grads:  [-0.07660126 -8.21855301]
Stock Position:  -0.07660125730307657
Bond Position:  [13.03885098]


portfolio before change:  [6.05938646]
curr_Stock_Price:  91.13550768508532
curr_Factors:  [9.11355077e+01 5.41969499e-02]
mat_Sqrt:  [[ 2.12165634e+01  0.00000000e+00]
 [-9.31209535e-03  2.13366909e-02]]
grads:  [2.61342340e-02 2.64011773e+01]
Stock Position:  0.026134233962270794
Bond Position:  [3.67762978]


portfolio before change:  [6.10965962]
curr_Stock_Price:  93.04156803362403
curr_Factors:  [9.30415680e+01 5.32611028e-02]
mat_Sqrt:  [[ 2.14724746e+01  0.00000000e+00]
 [-9.23134684e-03  2.11516728e-02]]
grads:  [-2.63718594e-03 -6.21881085e+00]
Stock Position:  -0.0026371859420997
Bond Position:  [6.35502754]


portfolio before change:  [6.11048738]
curr_Stock_Price:  93.02892782058784
curr_Factors:  [9.30289278e+01 5.32871035e-02]
mat_Sqrt:  [[ 2.14747973e+01  0.00000000e+00]
 [-9.23359982e-03  2.11568351e-02]]
grads:  [1.84135484e-03 2.84270629e+00]
Stock Position:  0.0018413548409945183
Bond Position:  [5.93918812]


portfolio before change:  [6.11164137]
curr_Stock_Price:  93.25242704895138
curr_Factors:  [9.32524270e+01 5.31264226e-02]
mat_Sqrt:  [[ 2.14939102e+01  0.00000000e+00]
 [-9.21966790e-03  2.11249130e-02]]
grads:  [1.87665975e-03 7.96546051e+00]
Stock Position:  0.0018766597466762984
Bond Position:  [5.93663829]


portfolio before change:  [6.11283442]
curr_Stock_Price:  93.49270958456992
curr_Factors:  [9.34927096e+01 5.37683218e-02]
mat_Sqrt:  [[ 2.16790870e+01  0.00000000e+00]
 [-9.27519891e-03  2.12521506e-02]]
grads:  [-0.08155    -2.81163725]
Stock Position:  -0.08155000499972265
Bond Position:  [13.73716536]


portfolio before change:  [6.17849682]
curr_Stock_Price:  92.70858775832151
curr_Factors:  [9.27085878e+01 5.21595194e-02]
mat_Sqrt:  [[ 2.11732125e+01  0.00000000e+00]
 [-9.13538347e-03  2.09317931e-02]]
grads:  [-6.55771104e-04  8.97264893e+00]
Stock Position:  -0.0006557711040844753
Bond Position:  [6.23929243]


portfolio before change:  [6.17901861]
curr_Stock_Price:  93.10226590901325
curr_Factors:  [9.31022659e+01 5.22752334e-02]
mat_Sqrt:  [[ 2.12866952e+01  0.00000000e+00]
 [-9.14551111e-03  2.09549985e-02]]
grads:  [-4.14273867e-03  5.21888678e+00]
Stock Position:  -0.00414273867258695
Bond Position:  [6.56471697]


portfolio before change:  [6.17949458]
curr_Stock_Price:  93.18546672343827
curr_Factors:  [9.31854667e+01 4.99992837e-02]
mat_Sqrt:  [[ 2.08367546e+01  0.00000000e+00]
 [-8.94420784e-03  2.04937547e-02]]
grads:  [ 0.05869505 -2.3153645 ]
Stock Position:  0.058695047752587645
Bond Position:  [0.70996916]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.10595]
Stock Price:  91.93096012082017
PL:  [6.10595]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.92161365e-01  6.22138120e-01]
 [-1.78854838e-01 -7.62455190e-02]
 [ 7.63123758e-01 -6.44789521e-01]
 [-2.49111088e-02  2.58996016e-02]
 [ 1.05561430e-02 -8.64737455e-04]
 [-8.94776914e-02 -6.63169280e-02]
 [-4.75309283e-03  3.14917599e-01]
 [ 2.26823187e-01 -2.09265721e-03]
 [ 9.30453507e-02  9.33434086e-02]
 [ 5.07013108e-01 -3.60676570e-01]
 [ 6.24689344e-02 -4.84681548e-03]
 [-1.45242801e-01 -1.58194573e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-6.42412640e-01 -8.14968139e-01]
 [ 9.57673486e-04 -1.14677420e-01]
 [ 2.58421888e-02 -1.31274427e-01]
 [-5.21478932e-02  2.24410028e-01]
 [ 1.12918430e-01  1.54864716e-01]
 [ 1.46681137e-02  7.15945739e-02]
 [-1.06969877e-01 -3.03715216e-02]
 [ 2.04388030e-01  4.04413846e-01]
 [ 3.46643227e-02  5.34889384e-02]
 [-4.13989936e-04  1.78973636e-01]
 [ 9.55487375e-02  1.89972607e-01]
 [ 4.57711991e-02  9.99852958e-02]
 [ 7.34066631e-01 -3.90191589e-01]
 [-3.08752029e-01  4.00509246e-01]
 [ 1.51449051e-01 -7.45655574e-03]
 [-4.68308685e-02 -6.32078713e-02]
 [-4.55452242e-02 -1.07496419e-01]
 [-3.38640151e-01 -9.22068789e-02]
 [-1.17965087e-01  1.15458908e-03]
 [ 6.14581863e-02 -2.48522648e-02]
 [ 1.58917553e-01  6.23916741e-02]
 [-2.93152999e-01 -1.82836883e-01]
 [-1.88872217e-01 -3.99031456e-01]
 [-6.59707118e-02  3.00226141e-01]
 [-1.23649873e-01  1.17635802e-01]
 [ 5.10470180e-01  4.29352488e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.65229494]
curr_Stock_Price:  100.89533786640628
curr_Factors:  [1.00895338e+02 3.96464657e-02]
mat_Sqrt:  [[ 2.00896948e+01  0.00000000e+00]
 [-7.96456811e-03  1.82491181e-02]]
grads:  [2.80584005e-02 3.40914074e+01]
Stock Position:  0.028058400472617682
Bond Position:  [5.82133315]


portfolio before change:  [8.64416477]
curr_Stock_Price:  100.5796433870266
curr_Factors:  [1.00579643e+02 3.97846840e-02]
mat_Sqrt:  [[ 2.00617146e+01  0.00000000e+00]
 [-7.97843935e-03  1.82809011e-02]]
grads:  [-0.01057393 -4.17077465]
Stock Position:  -0.010573927219159075
Bond Position:  [9.7076866]


portfolio before change:  [8.63607341]
curr_Stock_Price:  101.45962873115724
curr_Factors:  [1.01459629e+02 3.90594741e-02]
mat_Sqrt:  [[ 2.00519431e+01  0.00000000e+00]
 [-7.90538794e-03  1.81135193e-02]]
grads:  [ 2.40233346e-02 -3.55971421e+01]
Stock Position:  0.024023334644116556
Bond Position:  [6.1986748]


portfolio before change:  [8.60177121]
curr_Stock_Price:  99.9995034625793
curr_Factors:  [9.99995035e+01 4.05825645e-02]
mat_Sqrt:  [[ 2.01450146e+01  0.00000000e+00]
 [-8.05804586e-03  1.84633026e-02]]
grads:  [-6.75482057e-04  1.40276105e+00]
Stock Position:  -0.000675482057310379
Bond Position:  [8.66931908]


portfolio before change:  [8.60304953]
curr_Stock_Price:  99.71143268100361
curr_Factors:  [9.97114327e+01 4.20561892e-02]
mat_Sqrt:  [[ 2.04484275e+01  0.00000000e+00]
 [-8.20304228e-03  1.87955311e-02]]
grads:  [ 0.00049778 -0.04600761]
Stock Position:  0.0004977762057657546
Bond Position:  [8.55341556]


portfolio before change:  [8.603981]
curr_Stock_Price:  99.43464853935791
curr_Factors:  [9.94346485e+01 4.19465857e-02]
mat_Sqrt:  [[ 2.03650768e+01  0.00000000e+00]
 [-8.19234626e-03  1.87710234e-02]]
grads:  [-0.00581489 -3.53294152]
Stock Position:  -0.0058148944397562186
Bond Position:  [9.18218299]


portfolio before change:  [8.59906451]
curr_Stock_Price:  100.47754505272226
curr_Factors:  [1.00477545e+02 4.12895330e-02]
mat_Sqrt:  [[ 2.04168624e+01  0.00000000e+00]
 [-8.12793042e-03  1.86234282e-02]]
grads:  [6.49895232e-03 1.69097545e+01]
Stock Position:  0.0064989523234389
Bond Position:  [7.94606574]


portfolio before change:  [8.60447509]
curr_Stock_Price:  101.1572331403895
curr_Factors:  [1.01157233e+02 4.09117416e-02]
mat_Sqrt:  [[ 2.04607207e+01  0.00000000e+00]
 [-8.09066046e-03  1.85380320e-02]]
grads:  [ 0.01104115 -0.11288454]
Stock Position:  0.011041149528956087
Bond Position:  [7.48758296]


portfolio before change:  [8.62048303]
curr_Stock_Price:  102.52230239305344
curr_Factors:  [1.02522302e+02 4.00676311e-02]
mat_Sqrt:  [[ 2.05217874e+01  0.00000000e+00]
 [-8.00676026e-03  1.83457925e-02]]
grads:  [0.00651911 5.0880009 ]
Stock Position:  0.0065191082711416005
Bond Position:  [7.95212904]


portfolio before change:  [8.63084542]
curr_Stock_Price:  103.95935541106259
curr_Factors:  [1.03959355e+02 4.02383919e-02]
mat_Sqrt:  [[ 2.08537367e+01  0.00000000e+00]
 [-8.02380378e-03  1.83848441e-02]]
grads:  [ 1.67644270e-02 -1.96181468e+01]
Stock Position:  0.016764427038061695
Bond Position:  [6.88802639]


portfolio before change:  [8.6122433]
curr_Stock_Price:  102.79837519770878
curr_Factors:  [1.02798375e+02 4.00712269e-02]
mat_Sqrt:  [[ 2.05779719e+01  0.00000000e+00]
 [-8.00711952e-03  1.83466157e-02]]
grads:  [ 0.00293292 -0.26418036]
Stock Position:  0.00293292316988955
Bond Position:  [8.31074357]


portfolio before change:  [8.60977214]
curr_Stock_Price:  101.60159333541293
curr_Factors:  [1.01601593e+02 4.05875614e-02]
mat_Sqrt:  [[ 2.04690175e+01  0.00000000e+00]
 [-8.05854195e-03  1.84644392e-02]]
grads:  [-0.01046873 -8.56752651]
Stock Position:  -0.010468727798459027
Bond Position:  [9.67341157]


portfolio before change:  [8.59532192]
curr_Stock_Price:  103.09742684267677
curr_Factors:  [1.03097427e+02 4.04718018e-02]
mat_Sqrt:  [[ 2.07407328e+01  0.00000000e+00]
 [-8.04704187e-03  1.84380892e-02]]
grads:  [-5.82391282e-03  8.97770069e+00]
Stock Position:  -0.0058239128165549344
Bond Position:  [9.19575235]


portfolio before change:  [8.59574272]
curr_Stock_Price:  103.22255540098364
curr_Factors:  [1.03222555e+02 4.15893957e-02]
mat_Sqrt:  [[ 2.10506694e+01  0.00000000e+00]
 [-8.15739132e-03  1.86909316e-02]]
grads:  [ -0.04741388 -43.60232846]
Stock Position:  -0.04741387910414974
Bond Position:  [13.48992449]


portfolio before change:  [8.57500532]
curr_Stock_Price:  103.69549187898906
curr_Factors:  [1.03695492e+02 4.07547999e-02]
mat_Sqrt:  [[ 2.09338573e+01  0.00000000e+00]
 [-8.07512723e-03  1.85024409e-02]]
grads:  [-2.3450841e-03 -6.1979617e+00]
Stock Position:  -0.002345084102547788
Bond Position:  [8.81817997]


portfolio before change:  [8.57509098]
curr_Stock_Price:  104.12902986642321
curr_Factors:  [1.04129030e+02 4.05451081e-02]
mat_Sqrt:  [[ 2.09672297e+01  0.00000000e+00]
 [-8.05432635e-03  1.84547801e-02]]
grads:  [-1.49999159e-03 -7.11330215e+00]
Stock Position:  -0.0014999915856807088
Bond Position:  [8.73128364]


portfolio before change:  [8.57531425]
curr_Stock_Price:  104.70783831105321
curr_Factors:  [1.04707838e+02 3.96108707e-02]
mat_Sqrt:  [[ 2.08394565e+01  0.00000000e+00]
 [-7.96099197e-03  1.82409242e-02]]
grads:  [2.19740243e-03 1.23025580e+01]
Stock Position:  0.0021974024326884296
Bond Position:  [8.34522899]


portfolio before change:  [8.57774913]
curr_Stock_Price:  105.34116063281245
curr_Factors:  [1.05341161e+02 4.03579876e-02]
mat_Sqrt:  [[ 2.11622992e+01  0.00000000e+00]
 [-8.03571902e-03  1.84121453e-02]]
grads:  [0.00852965 8.41100879]
Stock Position:  0.008529646577008148
Bond Position:  [7.67922626]


portfolio before change:  [8.56983922]
curr_Stock_Price:  104.30127366248963
curr_Factors:  [1.04301274e+02 3.98114320e-02]
mat_Sqrt:  [[ 2.08110270e+01  0.00000000e+00]
 [-7.98112093e-03  1.82870454e-02]]
grads:  [2.20626053e-03 3.91504326e+00]
Stock Position:  0.0022062605344310977
Bond Position:  [8.33972344]


portfolio before change:  [8.57233056]
curr_Stock_Price:  104.95795294646622
curr_Factors:  [1.04957953e+02 3.91502341e-02]
mat_Sqrt:  [[ 2.07674194e+01  0.00000000e+00]
 [-7.91456724e-03  1.81345517e-02]]
grads:  [-0.00578912 -1.67478756]
Stock Position:  -0.005789120598706221
Bond Position:  [9.17994481]


portfolio before change:  [8.56836608]
curr_Stock_Price:  105.84099708548432
curr_Factors:  [1.05840997e+02 3.85486081e-02]
mat_Sqrt:  [[ 2.07806091e+01  0.00000000e+00]
 [-7.85351978e-03  1.79946744e-02]]
grads:  [1.83290442e-02 2.24740852e+01]
Stock Position:  0.018329044208224843
Bond Position:  [6.62840176]


portfolio before change:  [8.5434099]
curr_Stock_Price:  104.43422552800902
curr_Factors:  [1.04434226e+02 4.04527746e-02]
mat_Sqrt:  [[ 2.10047254e+01  0.00000000e+00]
 [-8.04515005e-03  1.84337545e-02]]
grads:  [2.76170282e-03 2.90168442e+00]
Stock Position:  0.0027617028167384898
Bond Position:  [8.25499361]


portfolio before change:  [8.54092499]
curr_Stock_Price:  103.16079150893846
curr_Factors:  [1.03160792e+02 4.10214639e-02]
mat_Sqrt:  [[ 2.08939352e+01  0.00000000e+00]
 [-8.10150247e-03  1.85628742e-02]]
grads:  [3.71861537e-03 9.64148301e+00]
Stock Position:  0.0037186153710393874
Bond Position:  [8.15730969]


portfolio before change:  [8.54834464]
curr_Stock_Price:  104.88184077975832
curr_Factors:  [1.04881841e+02 4.15616829e-02]
mat_Sqrt:  [[ 2.13819280e+01  0.00000000e+00]
 [-8.15467306e-03  1.86847033e-02]]
grads:  [8.34628105e-03 1.01672799e+01]
Stock Position:  0.008346281048550017
Bond Position:  [7.67297132]


portfolio before change:  [8.53531494]
curr_Stock_Price:  103.20577898061443
curr_Factors:  [1.03205779e+02 4.38328995e-02]
mat_Sqrt:  [[ 2.16074798e+01  0.00000000e+00]
 [-8.37452322e-03  1.91884433e-02]]
grads:  [4.13784303e-03 5.21070388e+00]
Stock Position:  0.004137843029929693
Bond Position:  [8.10826563]


portfolio before change:  [8.53456869]
curr_Stock_Price:  102.78047426385812
curr_Factors:  [1.02780474e+02 4.41107795e-02]
mat_Sqrt:  [[ 2.15865374e+01  0.00000000e+00]
 [-8.40102656e-03  1.92491701e-02]]
grads:  [  0.02611688 -20.27056687]
Stock Position:  0.026116882547293076
Bond Position:  [5.85026312]


portfolio before change:  [8.56020867]
curr_Stock_Price:  103.73421193553821
curr_Factors:  [1.03734212e+02 4.32395834e-02]
mat_Sqrt:  [[ 2.15706267e+01  0.00000000e+00]
 [-8.31765192e-03  1.90581348e-02]]
grads:  [-6.21008680e-03  2.10151335e+01]
Stock Position:  -0.00621008679789507
Bond Position:  [9.20440713]


portfolio before change:  [8.55993178]
curr_Stock_Price:  103.96408212600568
curr_Factors:  [1.03964082e+02 4.17787993e-02]
mat_Sqrt:  [[ 2.12501158e+01  0.00000000e+00]
 [-8.17594513e-03  1.87334437e-02]]
grads:  [ 0.00697383 -0.39803444]
Stock Position:  0.006973832262934494
Bond Position:  [7.83490371]


portfolio before change:  [8.56687909]
curr_Stock_Price:  104.81983575560994
curr_Factors:  [1.04819836e+02 4.13065121e-02]
mat_Sqrt:  [[ 2.13035872e+01  0.00000000e+00]
 [-8.12960143e-03  1.86272570e-02]]
grads:  [-0.00349317 -3.39330002]
Stock Position:  -0.0034931696980590806
Bond Position:  [8.93303256]


portfolio before change:  [8.57231817]
curr_Stock_Price:  103.58245613720523
curr_Factors:  [1.03582456e+02 4.22248144e-02]
mat_Sqrt:  [[ 2.12848248e+01  0.00000000e+00]
 [-8.21947097e-03  1.88331739e-02]]
grads:  [-4.34396378e-03 -5.70782279e+00]
Stock Position:  -0.0043439637825149
Bond Position:  [9.0222766]


portfolio before change:  [8.57681847]
curr_Stock_Price:  102.80610249472542
curr_Factors:  [1.02806102e+02 4.35059769e-02]
mat_Sqrt:  [[ 2.14433857e+01  0.00000000e+00]
 [-8.34323457e-03  1.91167520e-02]]
grads:  [-0.01766897 -4.82335488]
Stock Position:  -0.017668969717125716
Bond Position:  [10.39329639]


portfolio before change:  [8.59688812]
curr_Stock_Price:  101.74376556866375
curr_Factors:  [1.01743766e+02 4.39716097e-02]
mat_Sqrt:  [[ 2.13350659e+01  0.00000000e+00]
 [-8.38776344e-03  1.92187804e-02]]
grads:  [-0.00550555  0.06007608]
Stock Position:  -0.0055055458269495745
Bond Position:  [9.15704308]


portfolio before change:  [8.60790272]
curr_Stock_Price:  99.95104562290764
curr_Factors:  [9.99510456e+01 4.50033330e-02]
mat_Sqrt:  [[ 2.12036038e+01  0.00000000e+00]
 [-8.48559561e-03  1.94429421e-02]]
grads:  [ 0.00238694 -1.27821523]
Stock Position:  0.0023869418192406138
Bond Position:  [8.36932539]


portfolio before change:  [8.61219506]
curr_Stock_Price:  101.31098923854312
curr_Factors:  [1.01310989e+02 4.55733347e-02]
mat_Sqrt:  [[ 2.16277808e+01  0.00000000e+00]
 [-8.53916480e-03  1.95656845e-02]]
grads:  [0.00860687 3.18883165]
Stock Position:  0.008606870639403501
Bond Position:  [7.74022448]


portfolio before change:  [8.61139672]
curr_Stock_Price:  101.10581304345793
curr_Factors:  [1.01105813e+02 4.53688521e-02]
mat_Sqrt:  [[ 2.15355031e+01  0.00000000e+00]
 [-8.51998611e-03  1.95217406e-02]]
grads:  [-0.01731789 -9.36580844]
Stock Position:  -0.017317893854069132
Bond Position:  [10.36233646]


portfolio before change:  [8.61224992]
curr_Stock_Price:  101.13134603335574
curr_Factors:  [1.01131346e+02 4.59028698e-02]
mat_Sqrt:  [[ 2.16673454e+01  0.00000000e+00]
 [-8.56998201e-03  1.96362956e-02]]
grads:  [-1.67544208e-02 -2.03211168e+01]
Stock Position:  -0.016754420773911413
Bond Position:  [10.30664704]


portfolio before change:  [8.6319458]
curr_Stock_Price:  100.03268267457108
curr_Factors:  [1.00032683e+02 4.68171094e-02]
mat_Sqrt:  [[ 2.16443333e+01  0.00000000e+00]
 [-8.65490468e-03  1.98308779e-02]]
grads:  [3.00580838e-03 1.51393268e+01]
Stock Position:  0.003005808375373972
Bond Position:  [8.33126672]


portfolio before change:  [8.63350994]
curr_Stock_Price:  100.20657002851767
curr_Factors:  [1.00206570e+02 4.71425107e-02]
mat_Sqrt:  [[ 2.17571773e+01  0.00000000e+00]
 [-8.68493047e-03  1.98996756e-02]]
grads:  [-3.32347341e-03  5.91144319e+00]
Stock Position:  -0.00332347340918314
Bond Position:  [8.96654381]


portfolio before change:  [8.63861111]
curr_Stock_Price:  99.00894166187635
curr_Factors:  [9.90089417e+01 4.66947353e-02]
mat_Sqrt:  [[ 2.13948072e+01  0.00000000e+00]
 [-8.64358586e-03  1.98049432e-02]]
grads:  [0.02473538 2.16790567]
Stock Position:  0.024735378718683823
Bond Position:  [6.18958745]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.64446531]
Stock Price:  99.21433384026663
PL:  [8.64446531]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-7.54244958e-01 -2.93584791e-01]
 [-1.68923341e-01 -8.64136809e-02]
 [ 9.23128195e-01 -9.61767401e-01]
 [-5.39834309e-03  2.70540695e-01]
 [ 8.00868098e-03 -1.26058468e-01]
 [-7.16711277e-02 -3.96772852e-02]
 [-1.48048198e-01  5.57022468e-02]
 [ 9.62603409e-02 -1.51492911e-01]
 [ 1.65371699e-01  1.21459477e-01]
 [ 1.34564644e-02  2.12472586e-01]
 [ 1.70627121e-01  3.86391966e-01]
 [ 1.75414153e-01  2.59225104e-01]
 [ 1.56176660e-01  3.91912148e-02]
 [-1.54910974e-01 -1.79585029e-01]
 [ 9.39950414e-02  2.36493581e-01]
 [ 4.17222771e-02  1.12261731e-01]
 [ 4.63315744e-02  6.79591683e-02]
 [ 4.94979766e-02  5.84823616e-02]
 [ 1.54646211e-02  5.18171750e-02]
 [-5.50785305e-02 -6.33960789e-02]
 [ 2.28181192e-01  1.57637237e-01]
 [ 2.42373117e-02  3.14376451e-02]
 [ 8.49905436e-03  2.20670610e-01]
 [ 7.20551101e-02  1.81793333e-01]
 [ 4.35024482e-02  9.55577259e-02]
 [ 7.34684496e-01 -3.94331695e-01]
 [-4.34890161e-01  5.53303326e-01]
 [ 1.13426064e-01 -1.19690096e-02]
 [-5.32886689e-02 -5.61505664e-02]
 [ 1.19336208e-01 -1.15386206e-01]
 [-1.66116508e-01 -1.52031336e-01]
 [ 3.30802998e-01 -3.96990643e-02]
 [ 4.21305931e-01  5.89185091e-01]
 [ 3.29622838e-01 -2.51876718e-02]
 [-1.07376892e-01 -2.98338244e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-4.03172463e-01  3.75833923e-02]
 [-1.06242902e-01  5.93810596e-02]
 [-4.01831569e-01  1.86137534e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.49709651]
curr_Stock_Price:  96.65558390377977
curr_Factors:  [9.66555839e+01 3.97844122e-02]
mat_Sqrt:  [[ 1.92789520e+01  0.00000000e+00]
 [-7.97841209e-03  1.82808387e-02]]
grads:  [ -0.04576887 -16.05970035]
Stock Position:  -0.04576887096477879
Bond Position:  [-15.07327956]


portfolio before change:  [-19.47092345]
curr_Stock_Price:  96.04256161495766
curr_Factors:  [9.60425616e+01 4.19898638e-02]
mat_Sqrt:  [[ 1.96804927e+01  0.00000000e+00]
 [-8.19657136e-03  1.87807043e-02]]
grads:  [-0.0104996  -4.60119489]
Stock Position:  -0.010499603151816885
Bond Position:  [-18.46251467]


portfolio before change:  [-19.46922312]
curr_Stock_Price:  95.66080506614799
curr_Factors:  [9.56608051e+01 4.30413129e-02]
mat_Sqrt:  [[ 1.98461736e+01  0.00000000e+00]
 [-8.29856015e-03  1.90143900e-02]]
grads:  [ 2.53640071e-02 -5.05810283e+01]
Stock Position:  0.02536400708609659
Bond Position:  [-21.89556445]


portfolio before change:  [-19.45384572]
curr_Stock_Price:  96.37498709935832
curr_Factors:  [9.63749871e+01 4.30397392e-02]
mat_Sqrt:  [[ 1.99939752e+01  0.00000000e+00]
 [-8.29840845e-03  1.90140424e-02]]
grads:  [5.63546246e-03 1.42284681e+01]
Stock Position:  0.005635462459561689
Bond Position:  [-19.99696334]


portfolio before change:  [-19.45853821]
curr_Stock_Price:  95.9858936950219
curr_Factors:  [9.59858937e+01 4.52159578e-02]
mat_Sqrt:  [[ 2.04104829e+01  0.00000000e+00]
 [-8.50561770e-03  1.94888185e-02]]
grads:  [-2.30311772e-03 -6.46824579e+00]
Stock Position:  -0.002303117722588893
Bond Position:  [-19.2374714]


portfolio before change:  [-19.4589352]
curr_Stock_Price:  95.11409863665787
curr_Factors:  [9.51140986e+01 4.73966458e-02]
mat_Sqrt:  [[ 2.07070723e+01  0.00000000e+00]
 [-8.70830829e-03  1.99532410e-02]]
grads:  [-0.00429746 -1.98851331]
Stock Position:  -0.0042974551454465024
Bond Position:  [-19.05018663]


portfolio before change:  [-19.46348234]
curr_Stock_Price:  95.6180516860803
curr_Factors:  [9.56180517e+01 4.67404469e-02]
mat_Sqrt:  [[ 2.06721820e+01  0.00000000e+00]
 [-8.64781563e-03  1.98146349e-02]]
grads:  [-0.00598571  2.81116696]
Stock Position:  -0.005985712792086605
Bond Position:  [-18.89114014]


portfolio before change:  [-19.46673743]
curr_Stock_Price:  95.76733171940826
curr_Factors:  [9.57673317e+01 4.57291394e-02]
mat_Sqrt:  [[ 2.04792431e+01  0.00000000e+00]
 [-8.55374906e-03  1.95991013e-02]]
grads:  [ 1.47190078e-03 -7.72958459e+00]
Stock Position:  0.0014719007821664375
Bond Position:  [-19.60769744]


portfolio before change:  [-19.46804001]
curr_Stock_Price:  96.54763945026271
curr_Factors:  [9.65476395e+01 4.59989395e-02]
mat_Sqrt:  [[ 2.07069230e+01  0.00000000e+00]
 [-8.57894534e-03  1.96568332e-02]]
grads:  [0.01054628 6.17899516]
Stock Position:  0.010546277720132152
Bond Position:  [-20.48625823]


portfolio before change:  [-19.47644253]
curr_Stock_Price:  95.99373978279587
curr_Factors:  [9.59937398e+01 4.55346920e-02]
mat_Sqrt:  [[ 2.04839691e+01  0.00000000e+00]
 [-8.53554375e-03  1.95573877e-02]]
grads:  [5.18391247e-03 1.08640576e+01]
Stock Position:  0.005183912470938122
Bond Position:  [-19.97406567]


portfolio before change:  [-19.47851916]
curr_Stock_Price:  96.07481466524698
curr_Factors:  [9.60748147e+01 4.59877360e-02]
mat_Sqrt:  [[ 2.06030051e+01  0.00000000e+00]
 [-8.57790054e-03  1.96544393e-02]]
grads:  [1.64666464e-02 1.96592719e+01]
Stock Position:  0.01646664640677872
Bond Position:  [-21.06054916]


portfolio before change:  [-19.47329658]
curr_Stock_Price:  96.55185854586917
curr_Factors:  [9.65518585e+01 4.53391374e-02]
mat_Sqrt:  [[ 2.05587765e+01  0.00000000e+00]
 [-8.51719553e-03  1.95153466e-02]]
grads:  [ 0.01403533 13.28314118]
Stock Position:  0.014035332532411364
Bond Position:  [-20.82843402]


portfolio before change:  [-19.44968002]
curr_Stock_Price:  98.42002036071345
curr_Factors:  [9.84200204e+01 4.45534555e-02]
mat_Sqrt:  [[ 2.07741923e+01  0.00000000e+00]
 [-8.44307579e-03  1.93455169e-02]]
grads:  [0.00834117 2.02585513]
Stock Position:  0.00834117189409247
Bond Position:  [-20.27061833]


portfolio before change:  [-19.46399676]
curr_Stock_Price:  97.00741927914372
curr_Factors:  [9.70074193e+01 4.41562334e-02]
mat_Sqrt:  [[ 2.03845421e+01  0.00000000e+00]
 [-8.40535386e-03  1.92590851e-02]]
grads:  [-0.01144437 -9.32469159]
Stock Position:  -0.01144437314708758
Bond Position:  [-18.35380765]


portfolio before change:  [-19.45598469]
curr_Stock_Price:  96.10685123731974
curr_Factors:  [9.61068512e+01 4.53509625e-02]
mat_Sqrt:  [[ 2.04666896e+01  0.00000000e+00]
 [-8.51830617e-03  1.95178914e-02]]
grads:  [9.63562285e-03 1.21167587e+01]
Stock Position:  0.009635622846507638
Bond Position:  [-20.38203406]


portfolio before change:  [-19.46380107]
curr_Stock_Price:  95.56008144321389
curr_Factors:  [9.55600814e+01 4.52314253e-02]
mat_Sqrt:  [[ 2.03234132e+01  0.00000000e+00]
 [-8.50707238e-03  1.94921516e-02]]
grads:  [4.46368492e-03 5.75932988e+00]
Stock Position:  0.004463684923257344
Bond Position:  [-19.89035116]


portfolio before change:  [-19.46337293]
curr_Stock_Price:  96.21303842820113
curr_Factors:  [9.62130384e+01 4.30180084e-02]
mat_Sqrt:  [[ 1.99553376e+01  0.00000000e+00]
 [-8.29631325e-03  1.90092417e-02]]
grads:  [0.00380807 3.5750594 ]
Stock Position:  0.0038080732307506746
Bond Position:  [-19.82975922]


portfolio before change:  [-19.46259853]
curr_Stock_Price:  97.06734695297098
curr_Factors:  [9.70673470e+01 4.42422403e-02]
mat_Sqrt:  [[ 2.04169899e+01  0.00000000e+00]
 [-8.41353579e-03  1.92778323e-02]]
grads:  [0.00367448 3.03365859]
Stock Position:  0.0036744775772277524
Bond Position:  [-19.81927032]


portfolio before change:  [-19.45906047]
curr_Stock_Price:  98.70448318702157
curr_Factors:  [9.87044832e+01 4.29486942e-02]
mat_Sqrt:  [[ 2.04555830e+01  0.00000000e+00]
 [-8.28962669e-03  1.89939209e-02]]
grads:  [1.86156955e-03 2.72809260e+00]
Stock Position:  0.0018615695479841717
Bond Position:  [-19.64280573]


portfolio before change:  [-19.45717231]
curr_Stock_Price:  101.03781828485116
curr_Factors:  [1.01037818e+02 4.23394006e-02]
mat_Sqrt:  [[ 2.07900873e+01  0.00000000e+00]
 [-8.23061607e-03  1.88587106e-02]]
grads:  [-0.00398011 -3.3616338 ]
Stock Position:  -0.003980110645426903
Bond Position:  [-19.05503062]


portfolio before change:  [-19.46566935]
curr_Stock_Price:  102.57421015143697
curr_Factors:  [1.02574210e+02 4.13743981e-02]
mat_Sqrt:  [[ 2.08643100e+01  0.00000000e+00]
 [-8.13627907e-03  1.86425573e-02]]
grads:  [0.01423386 8.45577322]
Stock Position:  0.014233862660114213
Bond Position:  [-20.92569657]


portfolio before change:  [-19.4579941]
curr_Stock_Price:  103.29721329098291
curr_Factors:  [1.03297213e+02 4.11004148e-02]
mat_Sqrt:  [[ 2.09416891e+01  0.00000000e+00]
 [-8.10929489e-03  1.85807288e-02]]
grads:  [0.00181255 1.69194898]
Stock Position:  0.001812548393075186
Bond Position:  [-19.6452253]


portfolio before change:  [-19.46133704]
curr_Stock_Price:  102.80777252184657
curr_Factors:  [1.02807773e+02 4.06965046e-02]
mat_Sqrt:  [[ 2.07397971e+01  0.00000000e+00]
 [-8.06934987e-03  1.84892033e-02]]
grads:  [5.05345368e-03 1.19351065e+01]
Stock Position:  0.005053453679793198
Bond Position:  [-19.98087136]


portfolio before change:  [-19.45870605]
curr_Stock_Price:  103.82267424359948
curr_Factors:  [1.03822674e+02 3.91297944e-02]
mat_Sqrt:  [[ 2.05374252e+01  0.00000000e+00]
 [-7.91250093e-03  1.81298172e-02]]
grads:  [7.37172377e-03 1.00273120e+01]
Stock Position:  0.007371723768987742
Bond Position:  [-20.22405812]


portfolio before change:  [-19.46683339]
curr_Stock_Price:  103.06312560479758
curr_Factors:  [1.03063126e+02 4.03081555e-02]
mat_Sqrt:  [[ 2.06918715e+01  0.00000000e+00]
 [-8.03075642e-03  1.84007746e-02]]
grads:  [4.11790974e-03 5.19313605e+00]
Stock Position:  0.004117909737437268
Bond Position:  [-19.89123804]


portfolio before change:  [-19.47024559]
curr_Stock_Price:  102.83834229154063
curr_Factors:  [1.02838342e+02 4.25026288e-02]
mat_Sqrt:  [[ 2.12013230e+01  0.00000000e+00]
 [-8.24646628e-03  1.88950280e-02]]
grads:  [  0.02653533 -20.86960104]
Stock Position:  0.026535326762803
Bond Position:  [-22.19909461]


portfolio before change:  [-19.41658221]
curr_Stock_Price:  104.96525938783867
curr_Factors:  [1.04965259e+02 4.18932684e-02]
mat_Sqrt:  [[ 2.14841267e+01  0.00000000e+00]
 [-8.18713805e-03  1.87590899e-02]]
grads:  [-9.00240415e-03  2.94952116e+01]
Stock Position:  -0.009002404150563118
Bond Position:  [-18.47164252]


portfolio before change:  [-19.43398638]
curr_Stock_Price:  106.64204120376431
curr_Factors:  [1.06642041e+02 4.15254445e-02]
mat_Sqrt:  [[ 2.17312943e+01  0.00000000e+00]
 [-8.15111718e-03  1.86765557e-02]]
grads:  [ 0.0049791  -0.64085743]
Stock Position:  0.004979103330686571
Bond Position:  [-19.96496812]


portfolio before change:  [-19.43180981]
curr_Stock_Price:  107.58043150644615
curr_Factors:  [1.07580432e+02 4.12878774e-02]
mat_Sqrt:  [[ 2.18597183e+01  0.00000000e+00]
 [-8.12776746e-03  1.86230548e-02]]
grads:  [-0.00355882 -3.01511041]
Stock Position:  -0.0035588192069415828
Bond Position:  [-19.04895051]


portfolio before change:  [-19.44002185]
curr_Stock_Price:  109.21883133419405
curr_Factors:  [1.09218831e+02 3.95764292e-02]
mat_Sqrt:  [[ 2.17278037e+01  0.00000000e+00]
 [-7.95753019e-03  1.82329922e-02]]
grads:  [ 3.17462088e-03 -6.32842952e+00]
Stock Position:  0.0031746208750196977
Bond Position:  [-19.78675023]


portfolio before change:  [-19.43586773]
curr_Stock_Price:  111.3065202128974
curr_Factors:  [1.11306520e+02 4.10640655e-02]
mat_Sqrt:  [[ 2.25554542e+01  0.00000000e+00]
 [-8.10570816e-03  1.85725106e-02]]
grads:  [-0.01030653 -8.18582578]
Stock Position:  -0.01030652809584875
Bond Position:  [-18.28868395]


portfolio before change:  [-19.44699293]
curr_Stock_Price:  112.16412935212871
curr_Factors:  [1.12164129e+02 4.15310493e-02]
mat_Sqrt:  [[ 2.28581165e+01  0.00000000e+00]
 [-8.15166725e-03  1.86778161e-02]]
grads:  [ 0.01371403 -2.12546606]
Stock Position:  0.01371403047582993
Bond Position:  [-20.98521522]


portfolio before change:  [-19.43429103]
curr_Stock_Price:  113.28161373874408
curr_Factors:  [1.13281614e+02 4.02043148e-02]
mat_Sqrt:  [[ 2.27141118e+01  0.00000000e+00]
 [-8.02040545e-03  1.83770575e-02]]
grads:  [2.98689815e-02 3.20609047e+01]
Stock Position:  0.02986898150733394
Bond Position:  [-22.81789746]


portfolio before change:  [-19.39147426]
curr_Stock_Price:  114.81059747746421
curr_Factors:  [1.14810597e+02 3.81301347e-02]
mat_Sqrt:  [[ 2.24189953e+01  0.00000000e+00]
 [-7.81077560e-03  1.78967352e-02]]
grads:  [ 0.0142125 -1.4073892]
Stock Position:  0.014212502924930915
Bond Position:  [-21.02322021]


portfolio before change:  [-19.42697676]
curr_Stock_Price:  112.49753277143175
curr_Factors:  [1.12497533e+02 3.89360714e-02]
mat_Sqrt:  [[ 2.21982666e+01  0.00000000e+00]
 [-7.89289010e-03  1.80848832e-02]]
grads:  [-1.07027445e-02 -1.64965536e+01]
Stock Position:  -0.010702744526219544
Bond Position:  [-18.22294441]


portfolio before change:  [-19.44422086]
curr_Stock_Price:  113.8958733752041
curr_Factors:  [1.13895873e+02 3.92322507e-02]
mat_Sqrt:  [[ 2.25595068e+01  0.00000000e+00]
 [-7.92285309e-03  1.81535370e-02]]
grads:  [ 0.00690953 -3.83817675]
Stock Position:  0.006909532573397656
Bond Position:  [-20.2311881]


portfolio before change:  [-19.44101358]
curr_Stock_Price:  114.72607929565979
curr_Factors:  [1.14726079e+02 3.57416931e-02]
mat_Sqrt:  [[ 2.16895086e+01  0.00000000e+00]
 [-7.56218943e-03  1.73271527e-02]]
grads:  [-0.01783211  2.16904605]
Stock Position:  -0.017832111047270626
Bond Position:  [-17.39520539]


portfolio before change:  [-19.44577529]
curr_Stock_Price:  114.87116425142065
curr_Factors:  [1.14871164e+02 3.68670867e-02]
mat_Sqrt:  [[ 2.20561869e+01  0.00000000e+00]
 [-7.68032152e-03  1.75978274e-02]]
grads:  [-0.00364192  3.37434038]
Stock Position:  -0.0036419206722067355
Bond Position:  [-19.02742362]


portfolio before change:  [-19.45254341]
curr_Stock_Price:  116.0764469699521
curr_Factors:  [1.16076447e+02 3.82666614e-02]
mat_Sqrt:  [[ 2.27067194e+01  0.00000000e+00]
 [-7.82474653e-03  1.79287466e-02]]
grads:  [-0.01411893 10.38207176]
Stock Position:  -0.014118925907289725
Bond Position:  [-17.81366865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.45791377]
Stock Price:  116.29909221603161
PL:  [-35.75700598]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.75557570e-01  4.76825403e-02]
 [-1.64730335e-01 -8.71296185e-02]
 [ 8.19027483e-01 -7.01376865e-01]
 [-4.63706022e-02  6.72477107e-02]
 [ 3.41780901e-02 -5.28241183e-02]
 [-8.09798680e-02 -1.00989920e-01]
 [-1.04913078e-01  1.19577975e-01]
 [ 4.26234347e-02 -1.39134643e-01]
 [ 1.65002446e-01  1.33548707e-01]
 [ 2.58764373e-02  1.94068541e-01]
 [ 1.80287703e-01  4.43117359e-01]
 [ 1.41041049e-01  2.95285941e-01]
 [ 3.10106605e-01  2.35304513e-02]
 [-9.44112477e-02 -5.95660181e-02]
 [ 9.89147130e-02  2.40531203e-01]
 [ 4.12209231e-02  1.19011445e-01]
 [ 9.20575615e-02  2.03114749e-01]
 [ 1.10964970e-01  6.94109590e-02]
 [ 1.88078351e-02 -3.11953321e-02]
 [ 3.31164122e-01 -1.14583708e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.24015697e-02  4.17506767e-02]
 [-1.15210577e-01  1.25511136e-01]
 [ 7.72899092e-02 -3.49180390e-01]
 [ 7.32209067e-02  2.59431753e-01]
 [-1.80174769e-02  1.20999049e-01]
 [-1.98685764e-02  1.53664039e-01]
 [-1.36195052e-01  3.83422872e-02]
 [-7.68609339e-01  1.87518376e-01]
 [ 2.97091424e-01  1.17376122e-01]
 [-1.89542564e+00 -2.12199882e-01]
 [ 3.89899258e-01  7.10120740e-01]
 [ 1.00637800e-01 -1.65573280e-01]
 [ 3.54881057e-01 -8.19603903e-02]
 [ 4.81730740e-02  1.82401400e-01]
 [-2.34485109e+00  4.38588021e-01]
 [-2.02357313e-01 -2.84076455e-02]
 [-1.31761039e-01 -4.64307046e-01]
 [ 2.15550820e+00 -1.65922236e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.3383219]
curr_Stock_Price:  99.23997308236349
curr_Factors:  [9.92399731e+01 4.04477788e-02]
mat_Sqrt:  [[ 1.99587793e+01  0.00000000e+00]
 [-8.04465326e-03  1.84326162e-02]]
grads:  [-0.00775334  2.58685689]
Stock Position:  -0.007753340053554532
Bond Position:  [-1.56888064]


portfolio before change:  [-2.33903158]
curr_Stock_Price:  99.30621023375252
curr_Factors:  [9.93062102e+01 3.94280888e-02]
mat_Sqrt:  [[ 1.97187450e+01  0.00000000e+00]
 [-7.94260298e-03  1.81987897e-02]]
grads:  [-0.01028244 -4.78766006]
Stock Position:  -0.01028244026444901
Bond Position:  [-1.3179214]


portfolio before change:  [-2.34188415]
curr_Stock_Price:  99.56760897622944
curr_Factors:  [9.95676090e+01 3.99847103e-02]
mat_Sqrt:  [[ 1.99097155e+01  0.00000000e+00]
 [-7.99847089e-03  1.83267991e-02]]
grads:  [ 2.57623733e-02 -3.82705599e+01]
Stock Position:  0.02576237328087458
Bond Position:  [-4.90698206]


portfolio before change:  [-2.34731816]
curr_Stock_Price:  99.38049109021215
curr_Factors:  [9.93804911e+01 3.83601627e-02]
mat_Sqrt:  [[ 1.94644151e+01  0.00000000e+00]
 [-7.83430025e-03  1.79506369e-02]]
grads:  [-8.74482740e-04  3.74625763e+00]
Stock Position:  -0.0008744827402274582
Bond Position:  [-2.26041163]


portfolio before change:  [-2.34640891]
curr_Stock_Price:  98.01760302592429
curr_Factors:  [9.8017603e+01 3.9744538e-02]
mat_Sqrt:  [[ 1.95408209e+01  0.00000000e+00]
 [-7.97441288e-03  1.82716753e-02]]
grads:  [ 5.69257292e-04 -2.89103858e+00]
Stock Position:  0.0005692572917155475
Bond Position:  [-2.40220614]


portfolio before change:  [-2.34670943]
curr_Stock_Price:  98.01719567056539
curr_Factors:  [9.80171957e+01 4.05741152e-02]
mat_Sqrt:  [[ 1.97436208e+01  0.00000000e+00]
 [-8.05720698e-03  1.84613804e-02]]
grads:  [-0.00633397 -5.47033413]
Stock Position:  -0.006333969009096678
Bond Position:  [-1.72587155]


portfolio before change:  [-2.34159565]
curr_Stock_Price:  97.17577592944428
curr_Factors:  [9.71757759e+01 4.00990981e-02]
mat_Sqrt:  [[ 1.94592151e+01  0.00000000e+00]
 [-8.00990368e-03  1.83529950e-02]]
grads:  [-2.70951171e-03  6.51544749e+00]
Stock Position:  -0.0027095117120283976
Bond Position:  [-2.07829675]


portfolio before change:  [-2.3395341]
curr_Stock_Price:  96.31903148124191
curr_Factors:  [9.63190315e+01 4.05354333e-02]
mat_Sqrt:  [[ 1.93923087e+01  0.00000000e+00]
 [-8.05336534e-03  1.84525781e-02]]
grads:  [-9.33354669e-04 -7.54011944e+00]
Stock Position:  -0.0009333546694443257
Bond Position:  [-2.24963428]


portfolio before change:  [-2.33938378]
curr_Stock_Price:  95.85667424279042
curr_Factors:  [9.58566742e+01 4.05953336e-02]
mat_Sqrt:  [[ 1.93134747e+01  0.00000000e+00]
 [-8.05931348e-03  1.84662070e-02]]
grads:  [0.01156125 7.23205945]
Stock Position:  0.01156124848333915
Bond Position:  [-3.44760661]


portfolio before change:  [-2.33555718]
curr_Stock_Price:  96.22493643758575
curr_Factors:  [9.62249364e+01 4.15458707e-02]
mat_Sqrt:  [[ 1.96133404e+01  0.00000000e+00]
 [-8.15312168e-03  1.86811486e-02]]
grads:  [5.63773893e-03 1.03884694e+01]
Stock Position:  0.005637738926329343
Bond Position:  [-2.87804825]


portfolio before change:  [-2.34022468]
curr_Stock_Price:  95.4608507217039
curr_Factors:  [9.54608507e+01 4.03439301e-02]
mat_Sqrt:  [[ 1.91740741e+01  0.00000000e+00]
 [-8.03431939e-03  1.84089384e-02]]
grads:  [1.94888145e-02 2.40707720e+01]
Stock Position:  0.019488814514937898
Bond Position:  [-4.20064349]


portfolio before change:  [-2.34615494]
curr_Stock_Price:  95.18350443710551
curr_Factors:  [9.51835044e+01 4.01876044e-02]
mat_Sqrt:  [[ 1.90812908e+01  0.00000000e+00]
 [-8.01873849e-03  1.83732381e-02]]
grads:  [1.41455000e-02 1.60715242e+01]
Stock Position:  0.014145499998749212
Bond Position:  [-3.6925732]


portfolio before change:  [-2.35292153]
curr_Stock_Price:  94.7377805729253
curr_Factors:  [9.47377806e+01 3.83838924e-02]
mat_Sqrt:  [[ 1.85608437e+01  0.00000000e+00]
 [-7.83672303e-03  1.79561882e-02]]
grads:  [0.01726086 1.31043688]
Stock Position:  0.017260860649415035
Bond Position:  [-3.98817716]


portfolio before change:  [-2.33507429]
curr_Stock_Price:  95.80063582627305
curr_Factors:  [9.58006358e+01 3.82264483e-02]
mat_Sqrt:  [[ 1.87305429e+01  0.00000000e+00]
 [-7.82063408e-03  1.79193238e-02]]
grads:  [-0.00642843 -3.32412198]
Stock Position:  -0.006428430280996787
Bond Position:  [-1.71922658]


portfolio before change:  [-2.32466403]
curr_Stock_Price:  94.14779491500731
curr_Factors:  [9.41477949e+01 3.82099971e-02]
mat_Sqrt:  [[ 1.84034250e+01  0.00000000e+00]
 [-7.81895104e-03  1.79154675e-02]]
grads:  [1.10789778e-02 1.34258960e+01]
Stock Position:  0.01107897777160422
Bond Position:  [-3.36772536]


portfolio before change:  [-2.3109675]
curr_Stock_Price:  95.42205742128586
curr_Factors:  [9.54220574e+01 3.81265601e-02]
mat_Sqrt:  [[ 1.86321335e+01  0.00000000e+00]
 [-7.81040947e-03  1.78958963e-02]]
grads:  [5.00005948e-03 6.65020867e+00]
Stock Position:  0.0050000594798243585
Bond Position:  [-2.78808346]


portfolio before change:  [-2.31302697]
curr_Stock_Price:  95.0798723766241
curr_Factors:  [9.50798724e+01 3.85013943e-02]
mat_Sqrt:  [[ 1.86563559e+01  0.00000000e+00]
 [-7.84870887e-03  1.79836512e-02]]
grads:  [9.68592721e-03 1.12944110e+01]
Stock Position:  0.00968592720939675
Bond Position:  [-3.2339637]


portfolio before change:  [-2.31711923]
curr_Stock_Price:  94.69911517038899
curr_Factors:  [9.46991152e+01 3.90895692e-02]
mat_Sqrt:  [[ 1.87230399e+01  0.00000000e+00]
 [-7.90843289e-03  1.81204962e-02]]
grads:  [0.00754463 3.83052199]
Stock Position:  0.007544629333061263
Bond Position:  [-3.03158895]


portfolio before change:  [-2.31965829]
curr_Stock_Price:  94.4128070673628
curr_Factors:  [9.44128071e+01 3.86522228e-02]
mat_Sqrt:  [[ 1.85617170e+01  0.00000000e+00]
 [-7.86406743e-03  1.80188421e-02]]
grads:  [ 2.79773468e-04 -1.73126175e+00]
Stock Position:  0.0002797734678314055
Bond Position:  [-2.34607249]


portfolio before change:  [-2.3198666]
curr_Stock_Price:  94.71650825094456
curr_Factors:  [9.47165083e+01 3.83348787e-02]
mat_Sqrt:  [[ 1.85448244e+01  0.00000000e+00]
 [-7.83171794e-03  1.79447201e-02]]
grads:  [ 0.01516087 -6.3853717 ]
Stock Position:  0.01516087105848225
Bond Position:  [-3.75585137]


portfolio before change:  [-2.31733478]
curr_Stock_Price:  94.9144737930853
curr_Factors:  [9.49144738e+01 3.86435429e-02]
mat_Sqrt:  [[ 1.86582502e+01  0.00000000e+00]
 [-7.86318438e-03  1.80168188e-02]]
grads:  [ 0.00225791 -2.09681798]
Stock Position:  0.0022579079053871055
Bond Position:  [-2.53164292]


portfolio before change:  [-2.32240297]
curr_Stock_Price:  92.80999660366267
curr_Factors:  [9.28099966e+01 3.87554657e-02]
mat_Sqrt:  [[ 1.82709545e+01  0.00000000e+00]
 [-7.87456317e-03  1.80428909e-02]]
grads:  [-2.28782824e-04  2.31396825e+00]
Stock Position:  -0.0002287828236978928
Bond Position:  [-2.30116964]


portfolio before change:  [-2.32206731]
curr_Stock_Price:  90.08544309271306
curr_Factors:  [9.00854431e+01 3.86732121e-02]
mat_Sqrt:  [[ 1.77157581e+01  0.00000000e+00]
 [-7.86620234e-03  1.80237338e-02]]
grads:  [-3.41125825e-03  6.96365897e+00]
Stock Position:  -0.0034112582536323702
Bond Position:  [-2.01476259]


portfolio before change:  [-2.32575462]
curr_Stock_Price:  91.09253715248892
curr_Factors:  [9.10925372e+01 3.85796756e-02]
mat_Sqrt:  [[ 1.78921316e+01  0.00000000e+00]
 [-7.85668384e-03  1.80019242e-02]]
grads:  [-4.19765003e-03 -1.93968370e+01]
Stock Position:  -0.004197650034530222
Bond Position:  [-1.94338003]


portfolio before change:  [-2.32419487]
curr_Stock_Price:  90.66308481717229
curr_Factors:  [9.06630848e+01 3.85534796e-02]
mat_Sqrt:  [[ 1.78017330e+01  0.00000000e+00]
 [-7.85401600e-03  1.79958114e-02]]
grads:  [1.04734863e-02 1.44162298e+01]
Stock Position:  0.010473486300643469
Bond Position:  [-3.27375345]


portfolio before change:  [-2.33189777]
curr_Stock_Price:  89.96669233968534
curr_Factors:  [8.99666923e+01 3.81093349e-02]
mat_Sqrt:  [[ 1.75629489e+01  0.00000000e+00]
 [-7.80864494e-03  1.78918533e-02]]
grads:  [1.98092232e-03 6.76280133e+00]
Stock Position:  0.001980922315960379
Bond Position:  [-2.5101148]


portfolio before change:  [-2.3339034]
curr_Stock_Price:  89.11262558687994
curr_Factors:  [8.91126256e+01 3.83599971e-02]
mat_Sqrt:  [[ 1.74533389e+01  0.00000000e+00]
 [-7.83428333e-03  1.79505982e-02]]
grads:  [2.70411916e-03 8.56038540e+00]
Stock Position:  0.0027041191632254436
Bond Position:  [-2.57487456]


portfolio before change:  [-2.33543945]
curr_Stock_Price:  88.66361785313546
curr_Factors:  [8.86636179e+01 3.80370952e-02]
mat_Sqrt:  [[ 1.72921550e+01  0.00000000e+00]
 [-7.80124044e-03  1.78748874e-02]]
grads:  [-0.0069084   2.14503657]
Stock Position:  -0.006908398989891083
Bond Position:  [-1.7229158]


portfolio before change:  [-2.32855129]
curr_Stock_Price:  87.63537135722147
curr_Factors:  [8.76353714e+01 3.97522098e-02]
mat_Sqrt:  [[ 1.74727020e+01  0.00000000e+00]
 [-7.97518249e-03  1.82734387e-02]]
grads:  [-0.03930529 10.26180012]
Stock Position:  -0.039305289570920596
Bond Position:  [1.11598236]


portfolio before change:  [-2.33853644]
curr_Stock_Price:  87.89296151258199
curr_Factors:  [8.78929615e+01 4.00094901e-02]
mat_Sqrt:  [[ 1.75806775e+01  0.00000000e+00]
 [-8.00094896e-03  1.83324771e-02]]
grads:  [0.01981258 6.40263295]
Stock Position:  0.019812579106041252
Bond Position:  [-4.07992269]


portfolio before change:  [-2.34111389]
curr_Stock_Price:  87.7886122294067
curr_Factors:  [8.77886122e+01 4.05412506e-02]
mat_Sqrt:  [[ 1.76761124e+01  0.00000000e+00]
 [-8.05394319e-03  1.84539022e-02]]
grads:  [ -0.11247028 -11.49891661]
Stock Position:  -0.11247027712233428
Bond Position:  [7.53249566]


portfolio before change:  [-2.33162796]
curr_Stock_Price:  87.71264278671703
curr_Factors:  [8.77126428e+01 4.14499597e-02]
mat_Sqrt:  [[ 1.78576478e+01  0.00000000e+00]
 [-8.14370527e-03  1.86595729e-02]]
grads:  [ 0.03918889 38.05664491]
Stock Position:  0.0391888879612056
Bond Position:  [-5.76898889]


portfolio before change:  [-2.39059864]
curr_Stock_Price:  86.22626451112284
curr_Factors:  [8.62262645e+01 4.23010430e-02]
mat_Sqrt:  [[ 1.77343432e+01  0.00000000e+00]
 [-8.22688695e-03  1.88501661e-02]]
grads:  [ 1.60004211e-03 -8.78365099e+00]
Stock Position:  0.0016000421143729769
Bond Position:  [-2.5285643]


portfolio before change:  [-2.39126539]
curr_Stock_Price:  86.00711118901992
curr_Factors:  [8.60071112e+01 4.28236409e-02]
mat_Sqrt:  [[ 1.77982030e+01  0.00000000e+00]
 [-8.27754948e-03  1.89662485e-02]]
grads:  [ 0.01792937 -4.32138123]
Stock Position:  0.017929372461394713
Bond Position:  [-3.93331892]


portfolio before change:  [-2.39298058]
curr_Stock_Price:  85.93887140074645
curr_Factors:  [8.59388714e+01 4.20094518e-02]
mat_Sqrt:  [[ 1.76142093e+01  0.00000000e+00]
 [-8.19848296e-03  1.87850844e-02]]
grads:  [7.25434613e-03 9.70990579e+00]
Stock Position:  0.00725434612649461
Bond Position:  [-3.0164109]


portfolio before change:  [-2.39575678]
curr_Stock_Price:  85.60815641123482
curr_Factors:  [8.56081564e+01 4.25259760e-02]
mat_Sqrt:  [[ 1.76539661e+01  0.00000000e+00]
 [-8.24873090e-03  1.89002169e-02]]
grads:  [-0.12198027 23.20544913]
Stock Position:  -0.12198027190804872
Bond Position:  [8.04674942]


portfolio before change:  [-2.46561078]
curr_Stock_Price:  86.18906931435069
curr_Factors:  [8.61890693e+01 4.01646120e-02]
mat_Sqrt:  [[ 1.72732468e+01  0.00000000e+00]
 [-8.01644430e-03  1.83679814e-02]]
grads:  [-0.01243283 -1.54658505]
Stock Position:  -0.012432834883754228
Bond Position:  [-1.39403632]


portfolio before change:  [-2.47313973]
curr_Stock_Price:  86.78062271454871
curr_Factors:  [8.67806227e+01 4.00443001e-02]
mat_Sqrt:  [[ 1.73657328e+01  0.00000000e+00]
 [-8.00442878e-03  1.83404504e-02]]
grads:  [-1.92563855e-02 -2.53160111e+01]
Stock Position:  -0.019256385506587592
Bond Position:  [-0.80205861]


portfolio before change:  [-2.44316797]
curr_Stock_Price:  85.21895724994613
curr_Factors:  [8.52189572e+01 4.18812913e-02]
mat_Sqrt:  [[ 1.74399906e+01  0.00000000e+00]
 [-8.18596763e-03  1.87564082e-02]]
grads:  [ 0.11944352 -8.84616257]
Stock Position:  0.11944351611375645
Bond Position:  [-12.62201986]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.48914371]
Stock Price:  84.84725104378903
PL:  [-2.48914371]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.79362061e-01 -7.36582717e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.63126192e-01 -7.98041959e-01]
 [-2.60423764e-02  1.73947923e-01]
 [ 2.67558554e-02 -7.34802211e-03]
 [-8.77694877e-02 -7.32867754e-02]
 [-6.21028334e-02  1.77684355e-01]
 [ 9.97696260e-02 -1.52629894e-01]
 [ 1.65519762e-01  1.16611975e-01]
 [ 1.42205354e-01  3.15358795e-02]
 [ 1.55669169e-01  3.25468986e-01]
 [ 1.67012848e-01  2.68038917e-01]
 [ 2.34424183e-01  2.20775726e-02]
 [-1.16018475e-01 -1.13170377e-01]
 [ 9.09137965e-02  2.34042114e-01]
 [ 4.37905672e-02  8.48001056e-02]
 [-2.14726774e-02  1.38783056e-02]
 [-6.62416678e-02  1.60043463e-02]
 [ 1.52618943e-02  5.68509129e-02]
 [-2.95736049e-02 -8.14617387e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 1.06521490e-01  3.07588111e-01]
 [ 3.56439140e-02  2.61131666e-01]
 [-7.61891497e-02  8.72735866e-02]
 [ 4.41057675e-02  9.98568547e-02]
 [ 4.33537538e-02  1.73745563e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.61566583e-01  9.49997335e-02]
 [-4.71435949e-01  9.85133607e-02]
 [ 2.26549037e-01 -9.89191115e-02]
 [-1.26605313e+00 -1.43152693e-01]
 [ 1.64487533e-01  3.97837697e-01]
 [ 2.09007815e-02 -1.38304435e-01]
 [ 4.04695976e-03  5.23339878e-02]
 [-1.31222369e-02  1.71453473e-01]
 [-2.03220117e+00 -1.38565661e-03]
 [-1.05953905e-01  1.57745798e-01]
 [-1.35002775e-01 -1.33796080e-01]
 [ 1.63625878e+00 -9.84622534e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.60219897]
curr_Stock_Price:  98.89899655344344
curr_Factors:  [9.88989966e+01 3.98421708e-02]
mat_Sqrt:  [[ 1.97407379e+01  0.00000000e+00]
 [-7.98420148e-03  1.82941038e-02]]
grads:  [-0.01578002 -4.02633944]
Stock Position:  -0.015780016339355482
Bond Position:  [-3.04157119]


portfolio before change:  [-4.60005275]
curr_Stock_Price:  98.7388928206091
curr_Factors:  [9.87388928e+01 3.80751003e-02]
mat_Sqrt:  [[ 1.92667641e+01  0.00000000e+00]
 [-7.80513680e-03  1.78838151e-02]]
grads:  [-0.01053547 -4.92128607]
Stock Position:  -0.010535471678336624
Bond Position:  [-3.55979194]


portfolio before change:  [-4.59285804]
curr_Stock_Price:  98.01375103113595
curr_Factors:  [9.80137510e+01 4.02316117e-02]
mat_Sqrt:  [[ 1.96594211e+01  0.00000000e+00]
 [-8.02312774e-03  1.83832951e-02]]
grads:  [ 2.61875527e-02 -4.34112576e+01]
Stock Position:  0.02618755270082291
Bond Position:  [-7.15959831]


portfolio before change:  [-4.59924327]
curr_Stock_Price:  97.8041010619884
curr_Factors:  [9.78041011e+01 4.07858811e-02]
mat_Sqrt:  [[ 1.97520415e+01  0.00000000e+00]
 [-8.07820585e-03  1.85094949e-02]]
grads:  [2.52504132e-03 9.39776714e+00]
Stock Position:  0.0025250413231019658
Bond Position:  [-4.84620266]


portfolio before change:  [-4.59645043]
curr_Stock_Price:  99.15008054548305
curr_Factors:  [9.91500805e+01 4.18307212e-02]
mat_Sqrt:  [[ 2.02787298e+01  0.00000000e+00]
 [-8.18102402e-03  1.87450809e-02]]
grads:  [ 0.00116126 -0.39199735]
Stock Position:  0.0011612618716298339
Bond Position:  [-4.71158964]


portfolio before change:  [-4.59744661]
curr_Stock_Price:  98.79942865648442
curr_Factors:  [9.87994287e+01 4.18901830e-02]
mat_Sqrt:  [[ 2.02213694e+01  0.00000000e+00]
 [-8.18683656e-03  1.87583991e-02]]
grads:  [-0.00592217 -3.90687793]
Stock Position:  -0.005922173550652712
Bond Position:  [-4.01233925]


portfolio before change:  [-4.59581707]
curr_Stock_Price:  98.43957439008351
curr_Factors:  [9.84395744e+01 4.17918321e-02]
mat_Sqrt:  [[ 2.01240521e+01  0.00000000e+00]
 [-8.17722027e-03  1.87363654e-02]]
grads:  [7.67488406e-04 9.48339503e+00]
Stock Position:  0.00076748840561821
Bond Position:  [-4.6713683]


portfolio before change:  [-4.59847708]
curr_Stock_Price:  95.73457501798862
curr_Factors:  [9.57345750e+01 4.13873811e-02]
mat_Sqrt:  [[ 1.94761355e+01  0.00000000e+00]
 [-8.13755552e-03  1.86454821e-02]]
grads:  [ 1.70241571e-03 -8.18589155e+00]
Stock Position:  0.0017024157130481924
Bond Position:  [-4.76145712]


portfolio before change:  [-4.59720517]
curr_Stock_Price:  96.83132994992816
curr_Factors:  [9.68313299e+01 4.25299241e-02]
mat_Sqrt:  [[ 1.99693165e+01  0.00000000e+00]
 [-8.24911381e-03  1.89010942e-02]]
grads:  [0.0108373  6.16958856]
Stock Position:  0.010837296292487978
Bond Position:  [-5.64659498]


portfolio before change:  [-4.5829937]
curr_Stock_Price:  98.20781118544451
curr_Factors:  [9.82078112e+01 4.28115248e-02]
mat_Sqrt:  [[ 2.03201252e+01  0.00000000e+00]
 [-8.27637842e-03  1.89635653e-02]]
grads:  [0.00767558 1.66297208]
Stock Position:  0.007675579663048397
Bond Position:  [-5.33679558]


portfolio before change:  [-4.59407409]
curr_Stock_Price:  96.85113800060317
curr_Factors:  [9.68511380e+01 4.38199618e-02]
mat_Sqrt:  [[ 2.02740599e+01  0.00000000e+00]
 [-8.37328722e-03  1.91856113e-02]]
grads:  [1.46845517e-02 1.69642229e+01]
Stock Position:  0.014684551688812943
Bond Position:  [-6.01628963]


portfolio before change:  [-4.60412663]
curr_Stock_Price:  96.2177883940289
curr_Factors:  [9.62177884e+01 4.42978947e-02]
mat_Sqrt:  [[ 2.02510205e+01  0.00000000e+00]
 [-8.41882602e-03  1.92899537e-02]]
grads:  [ 0.01402372 13.89525968]
Stock Position:  0.014023719046095017
Bond Position:  [-5.95345786]


portfolio before change:  [-4.60364217]
curr_Stock_Price:  96.30540327747508
curr_Factors:  [9.63054033e+01 4.46400972e-02]
mat_Sqrt:  [[ 2.03476013e+01  0.00000000e+00]
 [-8.45128130e-03  1.93643181e-02]]
grads:  [0.01199452 1.14011619]
Stock Position:  0.011994515773950467
Bond Position:  [-5.75877885]


portfolio before change:  [-4.6035839]
curr_Stock_Price:  96.37028021728054
curr_Factors:  [9.63702802e+01 4.59363892e-02]
mat_Sqrt:  [[ 2.06548264e+01  0.00000000e+00]
 [-8.57311045e-03  1.96434638e-02]]
grads:  [-0.0080083  -5.76122308]
Stock Position:  -0.008008301460308133
Bond Position:  [-3.83182164]


portfolio before change:  [-4.60852242]
curr_Stock_Price:  96.92714197382864
curr_Factors:  [9.69271420e+01 4.79398817e-02]
mat_Sqrt:  [[ 2.12223702e+01  0.00000000e+00]
 [-8.75807117e-03  2.00672620e-02]]
grads:  [9.09691742e-03 1.16628822e+01]
Stock Position:  0.00909691742419537
Bond Position:  [-5.49026063]


portfolio before change:  [-4.61677698]
curr_Stock_Price:  96.09518622432653
curr_Factors:  [9.60951862e+01 4.89516285e-02]
mat_Sqrt:  [[ 2.12610743e+01  0.00000000e+00]
 [-8.85000596e-03  2.02779111e-02]]
grads:  [3.80038969e-03 4.18189552e+00]
Stock Position:  0.003800389686761164
Bond Position:  [-4.98197614]


portfolio before change:  [-4.60871619]
curr_Stock_Price:  98.38010463311078
curr_Factors:  [9.83801046e+01 4.86339634e-02]
mat_Sqrt:  [[ 2.16958721e+01  0.00000000e+00]
 [-8.82124376e-03  2.02120086e-02]]
grads:  [-0.00071054  0.68663664]
Stock Position:  -0.0007105355421031404
Bond Position:  [-4.53881363]


portfolio before change:  [-4.61015347]
curr_Stock_Price:  99.60439331482365
curr_Factors:  [9.96043933e+01 4.76337292e-02]
mat_Sqrt:  [[ 2.17388110e+01  0.00000000e+00]
 [-8.73006110e-03  2.00030829e-02]]
grads:  [-0.00272585  0.80009399]
Stock Position:  -0.002725852785311176
Bond Position:  [-4.33864656]


portfolio before change:  [-4.60967255]
curr_Stock_Price:  99.22899217689655
curr_Factors:  [9.92289922e+01 5.01012990e-02]
mat_Sqrt:  [[ 2.22107423e+01  0.00000000e+00]
 [-8.95332778e-03  2.05146511e-02]]
grads:  [1.80424707e-03 2.77123469e+00]
Stock Position:  0.001804247074860461
Bond Position:  [-4.78870617]


portfolio before change:  [-4.60821316]
curr_Stock_Price:  100.36964191994306
curr_Factors:  [1.00369642e+02 4.89160087e-02]
mat_Sqrt:  [[ 2.21987173e+01  0.00000000e+00]
 [-8.84678551e-03  2.02705321e-02]]
grads:  [-2.93379214e-03 -4.01872719e+00]
Stock Position:  -0.0029337921383499484
Bond Position:  [-4.3137495]


portfolio before change:  [-4.6043222]
curr_Stock_Price:  98.85957666105115
curr_Factors:  [9.88595767e+01 5.09971520e-02]
mat_Sqrt:  [[ 2.23250124e+01  0.00000000e+00]
 [-9.03301961e-03  2.06972481e-02]]
grads:  [ 0.00188706 -1.82526631]
Stock Position:  0.0018870587812022982
Bond Position:  [-4.79087603]


portfolio before change:  [-4.60480971]
curr_Stock_Price:  98.91860005939549
curr_Factors:  [9.89186001e+01 5.02054110e-02]
mat_Sqrt:  [[ 2.21642594e+01  0.00000000e+00]
 [-8.96262560e-03  2.05359551e-02]]
grads:  [1.08627111e-02 1.49780280e+01]
Stock Position:  0.01086271109651917
Bond Position:  [-5.67933389]


portfolio before change:  [-4.61221756]
curr_Stock_Price:  98.30200554916229
curr_Factors:  [9.83020055e+01 4.94355070e-02]
mat_Sqrt:  [[ 2.18565633e+01  0.00000000e+00]
 [-8.89363880e-03  2.03778865e-02]]
grads:  [6.84513454e-03 1.28144626e+01]
Stock Position:  0.0068451345415284325
Bond Position:  [-5.28510802]


portfolio before change:  [-4.62569508]
curr_Stock_Price:  96.4296043319153
curr_Factors:  [9.64296043e+01 4.98984714e-02]
mat_Sqrt:  [[ 2.15404120e+01  0.00000000e+00]
 [-8.93518631e-03  2.04730838e-02]]
grads:  [-1.76876068e-03  4.26284518e+00]
Stock Position:  -0.0017687606835837726
Bond Position:  [-4.45513419]


portfolio before change:  [-4.62800613]
curr_Stock_Price:  97.42132847002796
curr_Factors:  [9.74213285e+01 4.74758994e-02]
mat_Sqrt:  [[ 2.12270991e+01  0.00000000e+00]
 [-8.71558599e-03  1.99699163e-02]]
grads:  [4.13089284e-03 5.00036422e+00]
Stock Position:  0.004130892837807651
Bond Position:  [-5.0304432]


portfolio before change:  [-4.64217977]
curr_Stock_Price:  94.14242536630063
curr_Factors:  [9.41424254e+01 4.93251221e-02]
mat_Sqrt:  [[ 2.09083358e+01  0.00000000e+00]
 [-8.88370392e-03  2.03551228e-02]]
grads:  [5.70024009e-03 8.53571676e+00]
Stock Position:  0.005700240094556198
Bond Position:  [-5.1788142]


portfolio before change:  [-4.64191346]
curr_Stock_Price:  94.30271842696663
curr_Factors:  [9.43027184e+01 4.84793683e-02]
mat_Sqrt:  [[ 2.07636016e+01  0.00000000e+00]
 [-8.80721234e-03  2.01798586e-02]]
grads:  [8.58047671e-03 8.66891081e+00]
Stock Position:  0.00858047671049708
Bond Position:  [-5.45107573]


portfolio before change:  [-4.64502429]
curr_Stock_Price:  94.01958606607319
curr_Factors:  [9.40195861e+01 4.79996669e-02]
mat_Sqrt:  [[ 2.05985878e+01  0.00000000e+00]
 [-8.76353051e-03  2.00797710e-02]]
grads:  [-0.00583075  4.73111639]
Stock Position:  -0.005830754103188246
Bond Position:  [-4.09681921]


portfolio before change:  [-4.6345028]
curr_Stock_Price:  92.12727040554925
curr_Factors:  [9.21272704e+01 4.85455726e-02]
mat_Sqrt:  [[ 2.02984566e+01  0.00000000e+00]
 [-8.81322394e-03  2.01936329e-02]]
grads:  [-0.02110708  4.87843674]
Stock Position:  -0.021107082268089765
Bond Position:  [-2.68996492]


portfolio before change:  [-4.66718988]
curr_Stock_Price:  93.6599697441823
curr_Factors:  [9.36599697e+01 4.73820614e-02]
mat_Sqrt:  [[ 2.03873599e+01  0.00000000e+00]
 [-8.70696837e-03  1.99501708e-02]]
grads:  [ 0.00899465 -4.958309  ]
Stock Position:  0.008994651547390329
Bond Position:  [-5.50962867]


portfolio before change:  [-4.66527122]
curr_Stock_Price:  93.94985336153837
curr_Factors:  [9.39498534e+01 4.65095679e-02]
mat_Sqrt:  [[ 2.02612978e+01  0.00000000e+00]
 [-8.62643082e-03  1.97656361e-02]]
grads:  [-0.06556984 -7.2425037 ]
Stock Position:  -0.06556984152637717
Bond Position:  [1.49500577]


portfolio before change:  [-4.60417098]
curr_Stock_Price:  93.02086909350375
curr_Factors:  [9.30208691e+01 4.58405546e-02]
mat_Sqrt:  [[ 1.99161471e+01  0.00000000e+00]
 [-8.56416297e-03  1.96229625e-02]]
grads:  [1.69770859e-02 2.02740894e+01]
Stock Position:  0.016977085885588217
Bond Position:  [-6.18339427]


portfolio before change:  [-4.62796684]
curr_Stock_Price:  91.66475381313006
curr_Factors:  [9.16647538e+01 4.78557538e-02]
mat_Sqrt:  [[ 2.00525430e+01  0.00000000e+00]
 [-8.75038320e-03  2.00496467e-02]]
grads:  [-1.96784132e-03 -6.89809838e+00]
Stock Position:  -0.0019678413172643907
Bond Position:  [-4.44758515]


portfolio before change:  [-4.62960702]
curr_Stock_Price:  92.21571241178088
curr_Factors:  [9.22157124e+01 4.66679195e-02]
mat_Sqrt:  [[ 1.99211381e+01  0.00000000e+00]
 [-8.64110358e-03  1.97992556e-02]]
grads:  [1.34969119e-03 2.64323007e+00]
Stock Position:  0.0013496911912413946
Bond Position:  [-4.75406976]


portfolio before change:  [-4.63121054]
curr_Stock_Price:  91.46796888900766
curr_Factors:  [9.14679689e+01 4.70616012e-02]
mat_Sqrt:  [[ 1.98427740e+01  0.00000000e+00]
 [-8.67747440e-03  1.98825916e-02]]
grads:  [3.10975641e-03 8.62329602e+00]
Stock Position:  0.0031097564147824245
Bond Position:  [-4.91565365]


portfolio before change:  [-4.62962075]
curr_Stock_Price:  92.17679985417882
curr_Factors:  [9.21767999e+01 4.81229837e-02]
mat_Sqrt:  [[ 2.02207798e+01  0.00000000e+00]
 [-8.77478057e-03  2.01055481e-02]]
grads:  [-0.10053054 -0.06891912]
Stock Position:  -0.10053054042840633
Bond Position:  [4.63696276]


portfolio before change:  [-4.57914631]
curr_Stock_Price:  91.6804851842833
curr_Factors:  [9.16804852e+01 4.85845768e-02]
mat_Sqrt:  [[ 2.02081294e+01  0.00000000e+00]
 [-8.81676374e-03  2.02017436e-02]]
grads:  [-1.83629045e-03  7.80852389e+00]
Stock Position:  -0.0018362904451379699
Bond Position:  [-4.41079431]


portfolio before change:  [-4.57749043]
curr_Stock_Price:  90.4784629611864
curr_Factors:  [9.04784630e+01 4.71679637e-02]
mat_Sqrt:  [[ 1.96502816e+01  0.00000000e+00]
 [-8.68727471e-03  1.99050470e-02]]
grads:  [-0.0098419  -6.72171637]
Stock Position:  -0.0098419033289847
Bond Position:  [-3.68701014]


portfolio before change:  [-4.57076343]
curr_Stock_Price:  89.74812610826197
curr_Factors:  [8.97481261e+01 4.83512934e-02]
mat_Sqrt:  [[ 1.97346504e+01  0.00000000e+00]
 [-8.79557102e-03  2.01531850e-02]]
grads:  [ 0.08073547 -4.88569194]
Stock Position:  0.08073547282268377
Bond Position:  [-11.81662083]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.6872776]
Stock Price:  88.3232629472555
PL:  [-4.6872776]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.91824005e-02  2.96973798e-01]
 [-1.68446856e-01 -8.43802402e-02]
 [ 8.17813300e-01 -6.99401900e-01]
 [-3.91551674e-02  1.12593593e-01]
 [ 3.71221559e-02 -2.57685625e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-4.87142006e-03  3.03354359e-01]
 [ 1.18774542e-01 -3.21463860e-02]
 [ 1.51032708e-01  7.49015736e-02]
 [ 3.83605114e-01 -2.08483801e-01]
 [ 6.26144161e-02 -4.34449136e-03]
 [-8.30680007e-02 -1.71792620e-01]
 [-1.09962815e-01  1.22212582e-01]
 [-6.42996022e-01 -8.18356360e-01]
 [ 2.90249755e-02  1.03306857e-02]
 [ 5.44607784e-02 -2.06978579e-02]
 [-5.29266735e-02  2.68187793e-01]
 [-9.47289091e-02  7.02728528e-02]
 [ 1.51149879e-02  6.04986216e-02]
 [-5.84016911e-02 -5.90739414e-02]
 [ 1.53201655e-01  5.97846100e-02]
 [ 1.03749815e-01  3.12620769e-01]
 [ 3.66798246e-02  3.20837910e-01]
 [-5.48516933e-02  1.27064776e-01]
 [ 3.11440475e-02  7.57363250e-02]
 [ 2.97575285e-01 -2.24271596e-02]
 [ 1.00564035e-01  1.75933776e-01]
 [-1.90628955e-01  1.39236381e-01]
 [-1.00745333e-01 -8.69818026e-02]
 [ 7.79532501e-02 -6.45416821e-02]
 [-9.25122664e-01 -1.07677547e-01]
 [-1.21907644e-01  4.47641909e-02]
 [ 2.40765128e-02 -8.01775626e-02]
 [ 1.05084410e-01  9.00104525e-02]
 [-2.35122200e-01 -4.88990030e-02]
 [-4.35040646e-01 -3.45906224e-01]
 [-4.12603158e-02  3.06268171e-01]
 [-1.24769880e-01  1.16880223e-01]
 [ 5.02120669e-01  4.37685355e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.40027442]
curr_Stock_Price:  99.95368238395858
curr_Factors:  [9.99536824e+01 4.17408956e-02]
mat_Sqrt:  [[ 2.04211258e+01  0.00000000e+00]
 [-8.17223549e-03  1.87249439e-02]]
grads:  [7.77588825e-03 1.58597964e+01]
Stock Position:  0.007775888247250822
Bond Position:  [1.62304576]


portfolio before change:  [2.40193975]
curr_Stock_Price:  100.14175538578225
curr_Factors:  [1.00141755e+02 4.15816319e-02]
mat_Sqrt:  [[ 2.04204809e+01  0.00000000e+00]
 [-8.15662989e-03  1.86891869e-02]]
grads:  [-0.01005233 -4.51492302]
Stock Position:  -0.010052329997620662
Bond Position:  [3.40859772]


portfolio before change:  [2.40810717]
curr_Stock_Price:  99.57061248438082
curr_Factors:  [9.95706125e+01 4.21663832e-02]
mat_Sqrt:  [[ 2.04462824e+01  0.00000000e+00]
 [-8.21378190e-03  1.88201387e-02]]
grads:  [ 2.50690701e-02 -3.71624202e+01]
Stock Position:  0.025069070073149367
Bond Position:  [-0.0880355]


portfolio before change:  [2.38644431]
curr_Stock_Price:  98.70692482662787
curr_Factors:  [9.87069248e+01 4.30077380e-02]
mat_Sqrt:  [[ 2.04701452e+01  0.00000000e+00]
 [-8.29532282e-03  1.90069724e-02]]
grads:  [4.87769147e-04 5.92380473e+00]
Stock Position:  0.00048776914720850866
Bond Position:  [2.33829812]


portfolio before change:  [2.38673472]
curr_Stock_Price:  98.70302646237738
curr_Factors:  [9.87030265e+01 4.36677057e-02]
mat_Sqrt:  [[ 2.06257931e+01  0.00000000e+00]
 [-8.35872772e-03  1.91522512e-02]]
grads:  [ 1.25453761e-03 -1.34545867e+00]
Stock Position:  0.0012545376101667372
Bond Position:  [2.26290806]


portfolio before change:  [2.38910646]
curr_Stock_Price:  100.36807198088948
curr_Factors:  [1.00368072e+02 4.27286866e-02]
mat_Sqrt:  [[ 2.07470022e+01  0.00000000e+00]
 [-8.26836734e-03  1.89452096e-02]]
grads:  [-0.00570785 -3.50045892]
Stock Position:  -0.0057078497626407805
Bond Position:  [2.96199234]


portfolio before change:  [2.38990981]
curr_Stock_Price:  100.29219888801909
curr_Factors:  [1.00292199e+02 4.22294519e-02]
mat_Sqrt:  [[ 2.06098521e+01  0.00000000e+00]
 [-8.21992233e-03  1.88342081e-02]]
grads:  [6.18749109e-03 1.61065630e+01]
Stock Position:  0.006187491090371793
Bond Position:  [1.76935272]


portfolio before change:  [2.38863742]
curr_Stock_Price:  100.0508141084577
curr_Factors:  [1.00050814e+02 4.34487814e-02]
mat_Sqrt:  [[ 2.08549632e+01  0.00000000e+00]
 [-8.33774851e-03  1.91041818e-02]]
grads:  [ 0.00502253 -1.68268844]
Stock Position:  0.0050225314918220495
Bond Position:  [1.88612906]


portfolio before change:  [2.38948901]
curr_Stock_Price:  100.17342373884495
curr_Factors:  [1.00173424e+02 4.38381727e-02]
mat_Sqrt:  [[ 2.09738781e+01  0.00000000e+00]
 [-8.37502694e-03  1.91895975e-02]]
grads:  [0.00875958 3.90323839]
Stock Position:  0.00875958341280718
Bond Position:  [1.51201155]


portfolio before change:  [2.40866189]
curr_Stock_Price:  102.34063433489709
curr_Factors:  [1.02340634e+02 4.48106740e-02]
mat_Sqrt:  [[ 2.16640098e+01  0.00000000e+00]
 [-8.46741273e-03  1.94012799e-02]]
grads:  [  0.01350698 -10.74587871]
Stock Position:  0.013506978972908751
Bond Position:  [1.02634909]


portfolio before change:  [2.41446134]
curr_Stock_Price:  102.76050214126118
curr_Factors:  [1.02760502e+02 4.56705292e-02]
mat_Sqrt:  [[ 2.19606019e+01  0.00000000e+00]
 [-8.54826572e-03  1.95865374e-02]]
grads:  [ 0.00276488 -0.22181008]
Stock Position:  0.0027648752453005134
Bond Position:  [2.13034137]


portfolio before change:  [2.41670434]
curr_Stock_Price:  103.47543261613974
curr_Factors:  [1.03475433e+02 4.55364103e-02]
mat_Sqrt:  [[ 2.20808937e+01  0.00000000e+00]
 [-8.53570480e-03  1.95577567e-02]]
grads:  [-7.15752039e-03 -8.78386118e+00]
Stock Position:  -0.007157520390719241
Bond Position:  [3.15733186]


portfolio before change:  [2.409187]
curr_Stock_Price:  104.58084837510057
curr_Factors:  [1.04580848e+02 4.54697895e-02]
mat_Sqrt:  [[ 2.23004503e+01  0.00000000e+00]
 [-8.52945855e-03  1.95434447e-02]]
grads:  [-2.5391806e-03  6.2533798e+00]
Stock Position:  -0.002539180601855435
Bond Position:  [2.67473666]


portfolio before change:  [2.41285454]
curr_Stock_Price:  103.26814960316351
curr_Factors:  [1.03268150e+02 4.77094358e-02]
mat_Sqrt:  [[ 2.25563350e+01  0.00000000e+00]
 [-8.73699589e-03  2.00189725e-02]]
grads:  [ -0.04434036 -40.87903908]
Stock Position:  -0.04434036024323553
Bond Position:  [6.99180149]


portfolio before change:  [2.42476194]
curr_Stock_Price:  103.01931606103572
curr_Factors:  [1.03019316e+02 4.78295022e-02]
mat_Sqrt:  [[ 2.25302802e+01  0.00000000e+00]
 [-8.74798283e-03  2.00441467e-02]]
grads:  [0.00148838 0.51539663]
Stock Position:  0.0014883816840518779
Bond Position:  [2.27142987]


portfolio before change:  [2.42227717]
curr_Stock_Price:  101.15909964079444
curr_Factors:  [1.01159100e+02 4.85979343e-02]
mat_Sqrt:  [[ 2.23004620e+01  0.00000000e+00]
 [-8.81797567e-03  2.02045205e-02]]
grads:  [ 0.00203707 -1.02441718]
Stock Position:  0.002037065090808662
Bond Position:  [2.2162095]


portfolio before change:  [2.42497988]
curr_Stock_Price:  102.3498621386767
curr_Factors:  [1.02349862e+02 4.65399671e-02]
mat_Sqrt:  [[ 2.20800625e+01  0.00000000e+00]
 [-8.62924952e-03  1.97720946e-02]]
grads:  [2.90398070e-03 1.35639546e+01]
Stock Position:  0.0029039807006004986
Bond Position:  [2.12775785]


portfolio before change:  [2.42427355]
curr_Stock_Price:  102.01504027014128
curr_Factors:  [1.02015040e+02 4.65704281e-02]
mat_Sqrt:  [[ 2.20150320e+01  0.00000000e+00]
 [-8.63207304e-03  1.97785641e-02]]
grads:  [-2.90979917e-03  3.55298052e+00]
Stock Position:  -0.0029097991725370305
Bond Position:  [2.72111683]


portfolio before change:  [2.43120827]
curr_Stock_Price:  99.74870964408483
curr_Factors:  [9.97487096e+01 4.80030423e-02]
mat_Sqrt:  [[ 2.18545399e+01  0.00000000e+00]
 [-8.76383863e-03  2.00804770e-02]]
grads:  [1.89977694e-03 3.01280800e+00]
Stock Position:  0.0018997769441352285
Bond Position:  [2.24170797]


portfolio before change:  [2.43417641]
curr_Stock_Price:  101.16356328575817
curr_Factors:  [1.01163563e+02 4.66220619e-02]
mat_Sqrt:  [[ 2.18433808e+01  0.00000000e+00]
 [-8.63685701e-03  1.97895255e-02]]
grads:  [-0.00385397 -2.98511156]
Stock Position:  -0.0038539671931317153
Bond Position:  [2.82405746]


portfolio before change:  [2.43569202]
curr_Stock_Price:  100.86190623521973
curr_Factors:  [1.00861906e+02 4.71514084e-02]
mat_Sqrt:  [[ 2.19015326e+01  0.00000000e+00]
 [-8.68575003e-03  1.99015535e-02]]
grads:  [0.00818636 3.00401725]
Stock Position:  0.008186358528455269
Bond Position:  [1.61000029]


portfolio before change:  [2.42441155]
curr_Stock_Price:  99.45936260034185
curr_Factors:  [9.94593626e+01 4.79502682e-02]
mat_Sqrt:  [[ 2.17791633e+01  0.00000000e+00]
 [-8.75901987e-03  2.00694358e-02]]
grads:  [1.10283715e-02 1.55769585e+01]
Stock Position:  0.011028371488747874
Bond Position:  [1.32753675]


portfolio before change:  [2.4237228]
curr_Stock_Price:  99.38186156602215
curr_Factors:  [9.93818616e+01 4.77985978e-02]
mat_Sqrt:  [[ 2.17277475e+01  0.00000000e+00]
 [-8.74515617e-03  2.00376701e-02]]
grads:  [8.13268694e-03 1.60117374e+01]
Stock Position:  0.008132686944085511
Bond Position:  [1.61548123]


portfolio before change:  [2.41974496]
curr_Stock_Price:  98.86791259654268
curr_Factors:  [9.88679126e+01 4.82880398e-02]
mat_Sqrt:  [[ 2.17257688e+01  0.00000000e+00]
 [-8.78981591e-03  2.01399984e-02]]
grads:  [2.77974774e-05 6.30907580e+00]
Stock Position:  2.779747740754136e-05
Bond Position:  [2.41699668]


portfolio before change:  [2.4200335]
curr_Stock_Price:  98.37855757676626
curr_Factors:  [9.83785576e+01 5.03957278e-02]
mat_Sqrt:  [[ 2.20849953e+01  0.00000000e+00]
 [-8.97959712e-03  2.05748418e-02]]
grads:  [2.90686454e-03 3.68101616e+00]
Stock Position:  0.002906864535771147
Bond Position:  [2.13406036]


portfolio before change:  [2.41874146]
curr_Stock_Price:  97.84230691533483
curr_Factors:  [9.78423069e+01 4.99035946e-02]
mat_Sqrt:  [[ 2.18571030e+01  0.00000000e+00]
 [-8.93564499e-03  2.04741348e-02]]
grads:  [ 0.01316676 -1.09538986]
Stock Position:  0.013166761858868867
Bond Position:  [1.13047511]


portfolio before change:  [2.4048285]
curr_Stock_Price:  96.77490047644794
curr_Factors:  [9.67749005e+01 5.04576032e-02]
mat_Sqrt:  [[ 2.17383232e+01  0.00000000e+00]
 [-8.98510796e-03  2.05874687e-02]]
grads:  [8.15830310e-03 8.54567303e+00]
Stock Position:  0.008158303103391561
Bond Position:  [1.61530953]


portfolio before change:  [2.41354202]
curr_Stock_Price:  97.81820585779984
curr_Factors:  [9.78182059e+01 4.99991170e-02]
mat_Sqrt:  [[ 2.18726226e+01  0.00000000e+00]
 [-8.94419293e-03  2.04937206e-02]]
grads:  [-5.93715801e-03  6.79409970e+00]
Stock Position:  -0.005937158008058464
Bond Position:  [2.99430417]


portfolio before change:  [2.41344766]
curr_Stock_Price:  97.89714493790548
curr_Factors:  [9.78971449e+01 4.83154377e-02]
mat_Sqrt:  [[ 2.15185491e+01  0.00000000e+00]
 [-8.79230916e-03  2.01457111e-02]]
grads:  [-0.00644594 -4.31763377]
Stock Position:  -0.006445941264748965
Bond Position:  [3.04448691]


portfolio before change:  [2.41277664]
curr_Stock_Price:  98.06028787648073
curr_Factors:  [9.80602879e+01 4.45691594e-02]
mat_Sqrt:  [[ 2.07019085e+01  0.00000000e+00]
 [-8.44456364e-03  1.93489260e-02]]
grads:  [ 2.40484835e-03 -3.33567258e+00]
Stock Position:  0.0024048483535320246
Bond Position:  [2.17695651]


portfolio before change:  [2.41126932]
curr_Stock_Price:  97.32034315279208
curr_Factors:  [9.73203432e+01 4.32113118e-02]
mat_Sqrt:  [[ 2.02303016e+01  0.00000000e+00]
 [-8.31493228e-03  1.90519033e-02]]
grads:  [-0.04805252 -5.65180002]
Stock Position:  -0.0480525213496895
Bond Position:  [7.08775719]


portfolio before change:  [2.42134451]
curr_Stock_Price:  97.12911142235785
curr_Factors:  [9.71291114e+01 4.30776007e-02]
mat_Sqrt:  [[ 2.01592870e+01  0.00000000e+00]
 [-8.30205764e-03  1.90224038e-02]]
grads:  [-0.0050781   2.35323524]
Stock Position:  -0.00507810367783986
Bond Position:  [2.91457621]


portfolio before change:  [2.41063837]
curr_Stock_Price:  99.30915427992724
curr_Factors:  [9.93091543e+01 4.10611432e-02]
mat_Sqrt:  [[ 2.01235595e+01  0.00000000e+00]
 [-8.10541973e-03  1.85718497e-02]]
grads:  [-5.42441030e-04 -4.31715546e+00]
Stock Position:  -0.0005424410295520926
Bond Position:  [2.46450773]


portfolio before change:  [2.41076529]
curr_Stock_Price:  99.64312987012603
curr_Factors:  [9.96431299e+01 4.12242684e-02]
mat_Sqrt:  [[ 2.02313023e+01  0.00000000e+00]
 [-8.12150413e-03  1.86087037e-02]]
grads:  [0.00713588 4.8370082 ]
Stock Position:  0.007135882310172869
Bond Position:  [1.69972364]


portfolio before change:  [2.41272096]
curr_Stock_Price:  99.88741509549864
curr_Factors:  [9.98874151e+01 4.24611521e-02]
mat_Sqrt:  [[ 2.05829046e+01  0.00000000e+00]
 [-8.24244159e-03  1.88858063e-02]]
grads:  [-0.01246002 -2.5891933 ]
Stock Position:  -0.012460023447854225
Bond Position:  [3.6573205]


portfolio before change:  [2.41842425]
curr_Stock_Price:  99.46638131030652
curr_Factors:  [9.94663813e+01 4.32708920e-02]
mat_Sqrt:  [[ 2.06906551e+01  0.00000000e+00]
 [-8.32066266e-03  1.90650332e-02]]
grads:  [ -0.02832228 -18.14348915]
Stock Position:  -0.02832227858129975
Bond Position:  [5.23553881]


portfolio before change:  [2.4294674]
curr_Stock_Price:  99.09957915041902
curr_Factors:  [9.90995792e+01 4.28146048e-02]
mat_Sqrt:  [[ 2.05053780e+01  0.00000000e+00]
 [-8.27667612e-03  1.89642474e-02]]
grads:  [4.50643107e-03 1.61497667e+01]
Stock Position:  0.004506431068832309
Bond Position:  [1.98288198]


portfolio before change:  [2.43151857]
curr_Stock_Price:  99.49973911290333
curr_Factors:  [9.94997391e+01 4.32832413e-02]
mat_Sqrt:  [[ 2.07005474e+01  0.00000000e+00]
 [-8.32184992e-03  1.90677536e-02]]
grads:  [-3.56315064e-03  6.12973216e+00]
Stock Position:  -0.003563150640687087
Bond Position:  [2.78605113]


portfolio before change:  [2.43334232]
curr_Stock_Price:  99.08564695236089
curr_Factors:  [9.90856470e+01 4.28786799e-02]
mat_Sqrt:  [[ 2.05178312e+01  0.00000000e+00]
 [-8.28286712e-03  1.89784328e-02]]
grads:  [0.02540341 2.30622497]
Stock Position:  0.025403407365688746
Bond Position:  [-0.08377073]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.45857529]
Stock Price:  100.0793499320973
PL:  [2.37922536]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.67804425e-01  7.15769712e-01]
 [-1.64594564e-01 -8.78911815e-02]
 [ 8.50964854e-01 -7.70849666e-01]
 [-3.89942906e-02  1.13346330e-01]
 [ 2.45971312e-02 -6.48407939e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-1.98321777e-02  2.51199465e-01]
 [ 4.50562826e-02 -5.11022138e-02]
 [ 1.56166162e-01  7.32689709e-02]
 [ 2.87340905e-01 -1.27194128e-01]
 [ 8.45958733e-02  7.26629329e-02]
 [-1.46070667e-01 -1.23896253e-01]
 [-8.64111185e-02  1.31023723e-01]
 [-3.69757412e-01 -4.89809545e-01]
 [ 6.90883935e-02  1.90131924e-01]
 [ 5.53077201e-02 -2.12374891e-02]
 [-5.31803313e-02  2.82446721e-01]
 [-1.03599300e-01  5.96152556e-02]
 [ 1.48954377e-02  6.59500865e-02]
 [-4.17779831e-02 -7.59928278e-02]
 [ 2.01605707e-01  1.09712254e-01]
 [ 3.62068200e-02  1.62664193e-01]
 [ 3.80651071e-02  4.00680717e-01]
 [-3.98966306e-02  1.37427941e-01]
 [ 2.91553404e-02  6.57148002e-02]
 [ 6.68542758e-01 -2.31535927e-01]
 [-1.57483618e-02  6.74015200e-02]
 [-1.09805418e-01  1.03506502e-01]
 [-1.24056375e-02 -9.48020715e-02]
 [-4.40761233e-03 -1.60605289e-01]
 [ 1.36963250e-01 -6.57026394e-02]
 [ 1.34352524e-01 -1.33067239e-02]
 [ 2.41187873e-01  2.89033934e-01]
 [ 2.30111207e-01  2.58661872e-02]
 [-2.02195282e-01 -2.36022334e-01]
 [ 1.30014602e-01 -2.40525553e-01]
 [-1.24540752e-01  2.47942092e-01]
 [-1.23156558e-01  1.17968603e-01]
 [ 5.82408687e-02  9.78936659e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.45085531]
curr_Stock_Price:  101.1662301681516
curr_Factors:  [1.01166230e+02 3.93758451e-02]
mat_Sqrt:  [[ 2.00747669e+01  0.00000000e+00]
 [-7.93733911e-03  1.81867286e-02]]
grads:  [3.38829309e-02 3.93567049e+01]
Stock Position:  0.033882930850620684
Bond Position:  [7.02304693]


portfolio before change:  [10.37664765]
curr_Stock_Price:  98.950200067866
curr_Factors:  [9.89502001e+01 4.21702801e-02]
mat_Sqrt:  [[ 2.03198230e+01  0.00000000e+00]
 [-8.21416144e-03  1.88210083e-02]]
grads:  [-0.00998795 -4.66984447]
Stock Position:  -0.00998795220665178
Bond Position:  [11.36495752]


portfolio before change:  [10.38343899]
curr_Stock_Price:  98.41248910691931
curr_Factors:  [9.84124891e+01 4.20087438e-02]
mat_Sqrt:  [[ 2.01706579e+01  0.00000000e+00]
 [-8.19841388e-03  1.87849261e-02]]
grads:  [ 2.55092561e-02 -4.10355443e+01]
Stock Position:  0.02550925611731284
Bond Position:  [7.8730096]


portfolio before change:  [10.39168427]
curr_Stock_Price:  98.69713436618451
curr_Factors:  [9.86971344e+01 4.20272135e-02]
mat_Sqrt:  [[ 2.02334454e+01  0.00000000e+00]
 [-8.20021595e-03  1.87890552e-02]]
grads:  [5.17662872e-04 6.03257211e+00]
Stock Position:  0.0005176628720812966
Bond Position:  [10.34059243]


portfolio before change:  [10.39325965]
curr_Stock_Price:  99.24330298409741
curr_Factors:  [9.9243303e+01 4.3746986e-02]
mat_Sqrt:  [[ 2.07575111e+01  0.00000000e+00]
 [-8.36631206e-03  1.91696292e-02]]
grads:  [ 0.00104864 -0.33824751]
Stock Position:  0.0010486443618287161
Bond Position:  [10.28918872]


portfolio before change:  [10.39482441]
curr_Stock_Price:  99.50890624473278
curr_Factors:  [9.95089062e+01 4.27465061e-02]
mat_Sqrt:  [[ 2.05736934e+01  0.00000000e+00]
 [-8.27009128e-03  1.89491596e-02]]
grads:  [-0.00575593 -3.49972924]
Stock Position:  -0.005755931572644802
Bond Position:  [10.96759086]


portfolio before change:  [10.39536631]
curr_Stock_Price:  99.65295489297218
curr_Factors:  [9.96529549e+01 4.27147104e-02]
mat_Sqrt:  [[ 2.05958118e+01  0.00000000e+00]
 [-8.26701498e-03  1.89421110e-02]]
grads:  [4.36012222e-03 1.32614293e+01]
Stock Position:  0.004360122224990579
Bond Position:  [9.96086724]


portfolio before change:  [10.39651328]
curr_Stock_Price:  99.63043014824585
curr_Factors:  [9.96304301e+01 4.16214879e-02]
mat_Sqrt:  [[ 2.03259478e+01  0.00000000e+00]
 [-8.16053802e-03  1.86981416e-02]]
grads:  [ 1.11942864e-03 -2.73301032e+00]
Stock Position:  0.0011194286358929357
Bond Position:  [10.28498413]


portfolio before change:  [10.39803827]
curr_Stock_Price:  99.84418434984119
curr_Factors:  [9.98441843e+01 4.19905766e-02]
mat_Sqrt:  [[ 2.04596732e+01  0.00000000e+00]
 [-8.19664093e-03  1.87808638e-02]]
grads:  [0.00919581 3.90125672]
Stock Position:  0.009195814644041149
Bond Position:  [9.47988966]


portfolio before change:  [10.40379107]
curr_Stock_Price:  100.34090392267653
curr_Factors:  [1.00340904e+02 4.10261741e-02]
mat_Sqrt:  [[ 2.03239687e+01  0.00000000e+00]
 [-8.10196757e-03  1.85639398e-02]]
grads:  [ 0.01140667 -6.85167744]
Stock Position:  0.011406671550438197
Bond Position:  [9.25923534]


portfolio before change:  [10.40254879]
curr_Stock_Price:  100.13052228095953
curr_Factors:  [1.00130522e+02 4.25733977e-02]
mat_Sqrt:  [[ 2.06602531e+01  0.00000000e+00]
 [-8.25332880e-03  1.89107520e-02]]
grads:  [0.00562958 3.84241372]
Stock Position:  0.005629581428586935
Bond Position:  [9.83885586]


portfolio before change:  [10.40982731]
curr_Stock_Price:  101.20495022865282
curr_Factors:  [1.01204950e+02 4.43042158e-02]
mat_Sqrt:  [[ 2.13021914e+01  0.00000000e+00]
 [-8.41942666e-03  1.92913300e-02]]
grads:  [-0.00939544 -6.42238008]
Stock Position:  -0.009395438313702228
Bond Position:  [11.36069217]


portfolio before change:  [10.41468512]
curr_Stock_Price:  100.83906596448305
curr_Factors:  [1.00839066e+02 4.56113364e-02]
mat_Sqrt:  [[ 2.15360084e+01  0.00000000e+00]
 [-8.54272429e-03  1.95738403e-02]]
grads:  [-1.35715390e-03  6.69381788e+00]
Stock Position:  -0.0013571539033147475
Bond Position:  [10.55153926]


portfolio before change:  [10.41705437]
curr_Stock_Price:  100.06522858511757
curr_Factors:  [1.00065229e+02 4.53997176e-02]
mat_Sqrt:  [[ 2.13211079e+01  0.00000000e+00]
 [-8.52288379e-03  1.95283801e-02]]
grads:  [ -0.02736855 -25.08193426]
Stock Position:  -0.027368550773072296
Bond Position:  [13.15569466]


portfolio before change:  [10.3679426]
curr_Stock_Price:  101.91977789399682
curr_Factors:  [1.01919778e+02 4.68735575e-02]
mat_Sqrt:  [[ 2.20659397e+01  0.00000000e+00]
 [-8.66012078e-03  1.98428295e-02]]
grads:  [6.89156095e-03 9.58189576e+00]
Stock Position:  0.006891560946891788
Bond Position:  [9.66555624]


portfolio before change:  [10.36939209]
curr_Stock_Price:  101.95477945867907
curr_Factors:  [1.01954779e+02 4.76700474e-02]
mat_Sqrt:  [[ 2.22602676e+01  0.00000000e+00]
 [-8.73338857e-03  2.00107071e-02]]
grads:  [ 0.00206821 -1.06130628]
Stock Position:  0.0020682105345168826
Bond Position:  [10.15852814]


portfolio before change:  [10.37286608]
curr_Stock_Price:  103.02048188067528
curr_Factors:  [1.03020482e+02 4.80920914e-02]
mat_Sqrt:  [[ 2.25922980e+01  0.00000000e+00]
 [-8.77196364e-03  2.00990937e-02]]
grads:  [3.10236363e-03 1.40527093e+01]
Stock Position:  0.0031023636278549554
Bond Position:  [10.05325909]


portfolio before change:  [10.37048599]
curr_Stock_Price:  101.84820568140636
curr_Factors:  [1.01848206e+02 4.99792978e-02]
mat_Sqrt:  [[ 2.27692359e+01  0.00000000e+00]
 [-8.94242006e-03  2.04896584e-02]]
grads:  [-0.00340728  2.90952901]
Stock Position:  -0.003407275911900687
Bond Position:  [10.71751093]


portfolio before change:  [10.3722576]
curr_Stock_Price:  101.72146668175718
curr_Factors:  [1.01721467e+02 5.14918831e-02]
mat_Sqrt:  [[ 2.30824552e+01  0.00000000e+00]
 [-9.07672920e-03  2.07973993e-02]]
grads:  [1.89227770e-03 3.17107373e+00]
Stock Position:  0.0018922776984014093
Bond Position:  [10.17977233]


portfolio before change:  [10.37144432]
curr_Stock_Price:  100.61918211022417
curr_Factors:  [1.00619182e+02 5.39313889e-02]
mat_Sqrt:  [[ 2.33669261e+01  0.00000000e+00]
 [-9.28925305e-03  2.12843526e-02]]
grads:  [-3.20726705e-03 -3.57036125e+00]
Stock Position:  -0.0032072670513919417
Bond Position:  [10.69415691]


portfolio before change:  [10.36887525]
curr_Stock_Price:  101.83701786275383
curr_Factors:  [1.01837018e+02 5.27689074e-02]
mat_Sqrt:  [[ 2.33934742e+01  0.00000000e+00]
 [-9.18859357e-03  2.10537128e-02]]
grads:  [0.01066486 5.21106442]
Stock Position:  0.010664857109717669
Bond Position:  [9.282798]


portfolio before change:  [10.36585043]
curr_Stock_Price:  101.444585322537
curr_Factors:  [1.01444585e+02 5.36744026e-02]
mat_Sqrt:  [[ 2.35024145e+01  0.00000000e+00]
 [-9.26709470e-03  2.12335815e-02]]
grads:  [4.56120345e-03 7.66070448e+00]
Stock Position:  0.004561203449724442
Bond Position:  [9.90314104]


portfolio before change:  [10.36440006]
curr_Stock_Price:  100.85519091634772
curr_Factors:  [1.00855191e+02 5.46175584e-02]
mat_Sqrt:  [[ 2.35702613e+01  0.00000000e+00]
 [-9.34815989e-03  2.14193252e-02]]
grads:  [9.03411744e-03 1.87065052e+01]
Stock Position:  0.009034117437501975
Bond Position:  [9.45326242]


portfolio before change:  [10.35409119]
curr_Stock_Price:  99.58327960881654
curr_Factors:  [9.95832796e+01 5.45832828e-02]
mat_Sqrt:  [[ 2.32657068e+01  0.00000000e+00]
 [-9.34522619e-03  2.14126032e-02]]
grads:  [8.63151941e-04 6.41808656e+00]
Stock Position:  0.0008631519411015719
Bond Position:  [10.26813569]


portfolio before change:  [10.35648802]
curr_Stock_Price:  100.87300662092878
curr_Factors:  [1.00873007e+02 5.63380322e-02]
mat_Sqrt:  [[ 2.39428477e+01  0.00000000e+00]
 [-9.49425361e-03  2.17540679e-02]]
grads:  [2.41557025e-03 3.02080514e+00]
Stock Position:  0.0024155702485203
Bond Position:  [10.11282219]


portfolio before change:  [10.35762391]
curr_Stock_Price:  100.81989611337664
curr_Factors:  [1.00819896e+02 5.59269531e-02]
mat_Sqrt:  [[ 2.38427764e+01  0.00000000e+00]
 [-9.45955205e-03  2.16745567e-02]]
grads:  [  0.02380143 -10.68238353]
Stock Position:  0.023801430941641014
Bond Position:  [7.95796611]


portfolio before change:  [10.3510735]
curr_Stock_Price:  100.50288917796973
curr_Factors:  [1.00502889e+02 5.73549000e-02]
mat_Sqrt:  [[ 2.40693194e+01  0.00000000e+00]
 [-9.57955323e-03  2.19495139e-02]]
grads:  [5.67862886e-04 3.07075229e+00]
Stock Position:  0.0005678628861737487
Bond Position:  [10.29400164]


portfolio before change:  [10.35227955]
curr_Stock_Price:  100.36063025083064
curr_Factors:  [1.00360630e+02 5.82814537e-02]
mat_Sqrt:  [[ 2.42286138e+01  0.00000000e+00]
 [-9.65662084e-03  2.21260980e-02]]
grads:  [-2.66756808e-03  4.67802781e+00]
Stock Position:  -0.002667568084762899
Bond Position:  [10.61999836]


portfolio before change:  [10.34683548]
curr_Stock_Price:  102.89914178205697
curr_Factors:  [1.02899142e+02 5.66473053e-02]
mat_Sqrt:  [[ 2.44907103e+01  0.00000000e+00]
 [-9.52027775e-03  2.18136967e-02]]
grads:  [-2.19596136e-03 -4.34598833e+00]
Stock Position:  -0.0021959613646968636
Bond Position:  [10.57279802]


portfolio before change:  [10.34509071]
curr_Stock_Price:  104.29554400220766
curr_Factors:  [1.04295544e+02 5.66266251e-02]
mat_Sqrt:  [[ 2.48185322e+01  0.00000000e+00]
 [-9.51853982e-03  2.18097146e-02]]
grads:  [-3.00184984e-03 -7.36393353e+00]
Stock Position:  -0.00300184983579481
Bond Position:  [10.65817027]


portfolio before change:  [10.33952582]
curr_Stock_Price:  106.59321052539855
curr_Factors:  [1.06593211e+02 5.32927828e-02]
mat_Sqrt:  [[ 2.46072874e+01  0.00000000e+00]
 [-9.23409186e-03  2.11579625e-02]]
grads:  [ 0.00440066 -3.10533869]
Stock Position:  0.0044006584437420865
Bond Position:  [9.87044551]


portfolio before change:  [10.34015279]
curr_Stock_Price:  106.45529677096691
curr_Factors:  [1.06455297e+02 5.11873741e-02]
mat_Sqrt:  [[ 2.40851137e+01  0.00000000e+00]
 [-9.04985075e-03  2.07358130e-02]]
grads:  [ 0.00533711 -0.64172665]
Stock Position:  0.005337113820668091
Bond Position:  [9.77198875]


portfolio before change:  [10.34110331]
curr_Stock_Price:  106.40450954744303
curr_Factors:  [1.06404510e+02 5.03056416e-02]
mat_Sqrt:  [[ 2.38653815e+01  0.00000000e+00]
 [-8.97156768e-03  2.05564440e-02]]
grads:  [ 0.01539186 14.0605026 ]
Stock Position:  0.01539186054842044
Bond Position:  [8.70333993]


portfolio before change:  [10.32718853]
curr_Stock_Price:  105.42978886108304
curr_Factors:  [1.05429789e+02 4.99195993e-02]
mat_Sqrt:  [[ 2.35558555e+01  0.00000000e+00]
 [-8.93707776e-03  2.04774177e-02]]
grads:  [0.01024799 1.26315669]
Stock Position:  0.010247988503157767
Bond Position:  [9.24674526]


portfolio before change:  [10.33193905]
curr_Stock_Price:  105.78055106973855
curr_Factors:  [1.05780551e+02 5.17456182e-02]
mat_Sqrt:  [[ 2.40626035e+01  0.00000000e+00]
 [-9.09906529e-03  2.08485777e-02]]
grads:  [ -0.01268374 -11.32078829]
Stock Position:  -0.012683742802159986
Bond Position:  [11.67363235]


portfolio before change:  [10.34914539]
curr_Stock_Price:  104.53903729734449
curr_Factors:  [1.04539037e+02 5.19421078e-02]
mat_Sqrt:  [[ 2.38252947e+01  0.00000000e+00]
 [-9.11632450e-03  2.08881235e-02]]
grads:  [ 1.0510109e-03 -1.1514943e+01]
Stock Position:  0.0010510108970603746
Bond Position:  [10.23927372]


portfolio before change:  [10.3478939]
curr_Stock_Price:  102.13042998597669
curr_Factors:  [1.02130430e+02 5.14751904e-02]
mat_Sqrt:  [[ 2.31714996e+01  0.00000000e+00]
 [-9.07525782e-03  2.07940280e-02]]
grads:  [-7.04742984e-04  1.19237164e+01]
Stock Position:  -0.0007047429837971267
Bond Position:  [10.41986961]


portfolio before change:  [10.34968479]
curr_Stock_Price:  101.4375197628514
curr_Factors:  [1.01437520e+02 5.18868138e-02]
mat_Sqrt:  [[ 2.31061253e+01  0.00000000e+00]
 [-9.11147091e-03  2.08770026e-02]]
grads:  [-3.10181122e-03  5.65064847e+00]
Stock Position:  -0.003101811219267739
Bond Position:  [10.66432483]


portfolio before change:  [10.34907229]
curr_Stock_Price:  102.06477442479581
curr_Factors:  [1.02064774e+02 5.08968725e-02]
mat_Sqrt:  [[ 2.30261552e+01  0.00000000e+00]
 [-9.02413408e-03  2.06768888e-02]]
grads:  [4.38480355e-03 4.73444855e+00]
Stock Position:  0.0043848035466398285
Bond Position:  [9.90153831]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.35368203]
Stock Price:  102.83378758287729
PL:  [7.51989445]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.71093282e-01  4.72008635e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.88179518e-01 -6.61833507e-01]
 [-6.29578233e-03  2.47752848e-02]
 [-9.56936324e-02  4.16574703e-02]
 [ 3.57787227e-02  5.95915303e-02]
 [ 9.97495067e-03  3.08215472e-01]
 [ 2.33152845e-01 -2.11957425e-03]
 [ 1.34227529e-01  8.02461581e-02]
 [ 3.19168120e-01 -1.50817885e-01]
 [ 6.49761359e-02  3.81012931e-03]
 [-8.63150158e-02  2.08152237e-02]
 [ 8.32229824e-02  6.84690176e-02]
 [-2.71034898e-01 -3.65773911e-01]
 [ 8.64001015e-02  2.30402262e-01]
 [ 5.33654857e-02 -1.99999892e-02]
 [-5.09089993e-02  1.69160484e-01]
 [-1.38801470e-01  2.32391448e-02]
 [ 1.48606614e-02  6.68135866e-02]
 [-1.03920044e-01 -3.28338190e-02]
 [ 2.12562440e-01  3.58094330e-01]
 [ 1.30240373e-02  1.40337677e-01]
 [-1.04353782e-02 -3.84496585e-02]
 [ 9.18924291e-02  1.88703410e-01]
 [ 6.63032285e-02  1.40054480e-01]
 [ 7.95643107e-01 -6.75195253e-01]
 [-6.83271748e-01  8.43118192e-01]
 [ 1.08776531e-01 -1.33931188e-02]
 [-5.68911170e-02 -5.22136880e-02]
 [ 1.22862079e-01 -1.07175044e-01]
 [-1.22542498e-01 -1.36920517e-01]
 [ 3.14108059e-01 -3.31291620e-02]
 [ 4.02321991e-01  5.57549999e-01]
 [ 3.01263804e-01 -1.06382355e-02]
 [-1.06627030e-01 -3.01295647e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-3.48985869e-01  7.70479807e-02]
 [-1.10107116e-01  1.26772024e-01]
 [-3.30131171e-01  1.75428365e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.77304329]
curr_Stock_Price:  100.46167596541282
curr_Factors:  [1.00461676e+02 3.91962426e-02]
mat_Sqrt:  [[ 1.98894438e+01  0.00000000e+00]
 [-7.91921638e-03  1.81452043e-02]]
grads:  [1.89595418e-02 2.60128588e+01]
Stock Position:  0.018959541754869233
Bond Position:  [3.86833595]


portfolio before change:  [5.76016472]
curr_Stock_Price:  99.7569047709207
curr_Factors:  [9.97569048e+01 3.80551238e-02]
mat_Sqrt:  [[ 1.94603002e+01  0.00000000e+00]
 [-7.80308901e-03  1.78791230e-02]]
grads:  [-0.01043069 -4.92257758]
Stock Position:  -0.010430694604696021
Bond Position:  [6.80069853]


portfolio before change:  [5.74107637]
curr_Stock_Price:  101.668425707254
curr_Factors:  [1.01668426e+02 3.69027184e-02]
mat_Sqrt:  [[ 1.95305862e+01  0.00000000e+00]
 [-7.68403210e-03  1.76063294e-02]]
grads:  [ 2.55666517e-02 -3.75906581e+01]
Stock Position:  0.025566651744066828
Bond Position:  [3.14175514]


portfolio before change:  [5.70870844]
curr_Stock_Price:  100.38704272336372
curr_Factors:  [1.00387043e+02 3.83650738e-02]
mat_Sqrt:  [[ 1.96628144e+01  0.00000000e+00]
 [-7.83480172e-03  1.79517860e-02]]
grads:  [2.29724918e-04 1.38010139e+00]
Stock Position:  0.00022972491786674468
Bond Position:  [5.68564704]


portfolio before change:  [5.70955968]
curr_Stock_Price:  100.99858610065665
curr_Factors:  [1.00998586e+02 3.78670344e-02]
mat_Sqrt:  [[ 1.96537732e+01  0.00000000e+00]
 [-7.78378154e-03  1.78348840e-02]]
grads:  [-0.00394392  2.33572981]
Stock Position:  -0.003943915542120216
Bond Position:  [6.10788957]


portfolio before change:  [5.70579076]
curr_Stock_Price:  102.14781256440801
curr_Factors:  [1.02147813e+02 3.61275363e-02]
mat_Sqrt:  [[ 1.94154850e+01  0.00000000e+00]
 [-7.60289800e-03  1.74204278e-02]]
grads:  [3.18233610e-03 3.42078455e+00]
Stock Position:  0.0031823360960708826
Bond Position:  [5.38072209]


portfolio before change:  [5.70393514]
curr_Stock_Price:  101.35334653250196
curr_Factors:  [1.01353347e+02 3.44033798e-02]
mat_Sqrt:  [[ 1.87991688e+01  0.00000000e+00]
 [-7.41925924e-03  1.69996585e-02]]
grads:  [7.6860425e-03 1.8130686e+01]
Stock Position:  0.007686042504704063
Bond Position:  [4.92492901]


portfolio before change:  [5.704141]
curr_Stock_Price:  101.30003054969653
curr_Factors:  [1.01300031e+02 3.38849904e-02]
mat_Sqrt:  [[ 1.86471842e+01  0.00000000e+00]
 [-7.36315046e-03  1.68710972e-02]]
grads:  [ 0.01245377 -0.12563346]
Stock Position:  0.012453772381794072
Bond Position:  [4.44257348]


portfolio before change:  [5.70026534]
curr_Stock_Price:  100.94423328481169
curr_Factors:  [1.00944233e+02 3.47869757e-02]
mat_Sqrt:  [[ 1.88273784e+01  0.00000000e+00]
 [-7.46050677e-03  1.70941685e-02]]
grads:  [0.00898956 4.69435867]
Stock Position:  0.008989558731625137
Bond Position:  [4.79282123]


portfolio before change:  [5.70317376]
curr_Stock_Price:  101.20111733386794
curr_Factors:  [1.01201117e+02 3.45545031e-02]
mat_Sqrt:  [[ 1.88121154e+01  0.00000000e+00]
 [-7.43553663e-03  1.70369547e-02]]
grads:  [ 0.01346716 -8.85239691]
Stock Position:  0.013467161625945946
Bond Position:  [4.34028195]


portfolio before change:  [5.70966309]
curr_Stock_Price:  101.64269276833078
curr_Factors:  [1.01642693e+02 3.41291141e-02]
mat_Sqrt:  [[ 1.87775389e+01  0.00000000e+00]
 [-7.38962669e-03  1.69317618e-02]]
grads:  [0.00354887 0.22502852]
Stock Position:  0.0035488683120402844
Bond Position:  [5.34894656]


portfolio before change:  [5.70410993]
curr_Stock_Price:  99.88950737153257
curr_Factors:  [9.98895074e+01 3.37863505e-02]
mat_Sqrt:  [[ 1.83607540e+01  0.00000000e+00]
 [-7.35242550e-03  1.68465232e-02]]
grads:  [-0.00420628  1.2355798 ]
Stock Position:  -0.004206281904488856
Bond Position:  [6.12427336]


portfolio before change:  [5.70796476]
curr_Stock_Price:  99.15506974957924
curr_Factors:  [9.91550697e+01 3.38931153e-02]
mat_Sqrt:  [[ 1.82545306e+01  0.00000000e+00]
 [-7.36403317e-03  1.68731197e-02]]
grads:  [0.00619601 4.05787541]
Stock Position:  0.006196013156427101
Bond Position:  [5.09359865]


portfolio before change:  [5.70630261]
curr_Stock_Price:  98.7840425734818
curr_Factors:  [9.87840426e+01 3.46888745e-02]
mat_Sqrt:  [[ 1.83984781e+01  0.00000000e+00]
 [-7.44997981e-03  1.70700482e-02]]
grads:  [ -0.02340801 -21.42781947]
Stock Position:  -0.023408007939648513
Bond Position:  [8.01864027]


portfolio before change:  [5.72240281]
curr_Stock_Price:  98.13905784444263
curr_Factors:  [9.81390578e+01 3.40341637e-02]
mat_Sqrt:  [[ 1.81050374e+01  0.00000000e+00]
 [-7.37934021e-03  1.69081926e-02]]
grads:  [1.03261810e-02 1.36266642e+01]
Stock Position:  0.010326180961357404
Bond Position:  [4.70900114]


portfolio before change:  [5.74184739]
curr_Stock_Price:  99.96508770638422
curr_Factors:  [9.99650877e+01 3.24464166e-02]
mat_Sqrt:  [[ 1.80066002e+01  0.00000000e+00]
 [-7.20515556e-03  1.65090854e-02]]
grads:  [ 0.00247891 -1.2114535 ]
Stock Position:  0.0024789118624687014
Bond Position:  [5.49404275]


portfolio before change:  [5.74133038]
curr_Stock_Price:  99.47946729278574
curr_Factors:  [9.94794673e+01 3.29541131e-02]
mat_Sqrt:  [[ 1.80587741e+01  0.00000000e+00]
 [-7.26130711e-03  1.66377447e-02]]
grads:  [1.26911653e-03 1.01672725e+01]
Stock Position:  0.0012691165304318994
Bond Position:  [5.61507934]


portfolio before change:  [5.74414376]
curr_Stock_Price:  101.14318473350916
curr_Factors:  [1.01143185e+02 3.26416932e-02]
mat_Sqrt:  [[ 1.82735516e+01  0.00000000e+00]
 [-7.22680490e-03  1.65586902e-02]]
grads:  [-0.00704073  1.403441  ]
Stock Position:  -0.007040726350791857
Bond Position:  [6.45626524]


portfolio before change:  [5.73409767]
curr_Stock_Price:  102.68466862037035
curr_Factors:  [1.02684669e+02 3.35199815e-02]
mat_Sqrt:  [[ 1.87999845e+01  0.00000000e+00]
 [-7.32338517e-03  1.67799834e-02]]
grads:  [2.34151795e-03 3.98174330e+00]
Stock Position:  0.0023415179533018875
Bond Position:  [5.49365968]


portfolio before change:  [5.73880954]
curr_Stock_Price:  104.40368729711939
curr_Factors:  [1.04403687e+02 3.36908642e-02]
mat_Sqrt:  [[ 1.91633712e+01  0.00000000e+00]
 [-7.34202852e-03  1.68227007e-02]]
grads:  [-0.00617062 -1.95175671]
Stock Position:  -0.006170620790296407
Bond Position:  [6.3830451]


portfolio before change:  [5.73466122]
curr_Stock_Price:  105.20526844292995
curr_Factors:  [1.05205268e+02 3.27288745e-02]
mat_Sqrt:  [[ 1.90328149e+01  0.00000000e+00]
 [-7.23644935e-03  1.65807885e-02]]
grads:  [1.93795621e-02 2.15969422e+01]
Stock Position:  0.019379562082792293
Bond Position:  [3.69582918]


portfolio before change:  [5.74696436]
curr_Stock_Price:  105.81628025296537
curr_Factors:  [1.05816280e+02 3.33408381e-02]
mat_Sqrt:  [[ 1.93214959e+01  0.00000000e+00]
 [-7.30378949e-03  1.67350841e-02]]
grads:  [3.84403057e-03 8.38583637e+00]
Stock Position:  0.0038440305697165222
Bond Position:  [5.34020335]


portfolio before change:  [5.74378975]
curr_Stock_Price:  104.81676088687342
curr_Factors:  [1.04816761e+02 3.23870478e-02]
mat_Sqrt:  [[ 1.88632454e+01  0.00000000e+00]
 [-7.19856072e-03  1.64939747e-02]]
grads:  [-1.44281561e-03 -2.33113359e+00]
Stock Position:  -0.0014428156072238381
Bond Position:  [5.89502101]


portfolio before change:  [5.7446621]
curr_Stock_Price:  104.72289557897558
curr_Factors:  [1.04722896e+02 3.27492929e-02]
mat_Sqrt:  [[ 1.89514570e+01  0.00000000e+00]
 [-7.23870628e-03  1.65859597e-02]]
grads:  [9.19450935e-03 1.13772982e+01]
Stock Position:  0.009194509354654202
Bond Position:  [4.78178646]


portfolio before change:  [5.75003785]
curr_Stock_Price:  105.24255220153853
curr_Factors:  [1.05242552e+02 3.18382276e-02]
mat_Sqrt:  [[ 1.87787125e+01  0.00000000e+00]
 [-7.13730791e-03  1.63536269e-02]]
grads:  [6.78576952e-03 8.56412349e+00]
Stock Position:  0.00678576951543761
Bond Position:  [5.03588615]


portfolio before change:  [5.75686039]
curr_Stock_Price:  106.15519934088512
curr_Factors:  [1.06155199e+02 3.23458778e-02]
mat_Sqrt:  [[ 1.90919699e+01  0.00000000e+00]
 [-7.19398391e-03  1.64834879e-02]]
grads:  [ 2.62394998e-02 -4.09619164e+01]
Stock Position:  0.02623949977317873
Bond Position:  [2.97140106]


portfolio before change:  [5.7882308]
curr_Stock_Price:  107.33658489373659
curr_Factors:  [1.07336585e+02 3.13134678e-02]
mat_Sqrt:  [[ 1.89938654e+01  0.00000000e+00]
 [-7.07824473e-03  1.62182961e-02]]
grads:  [-1.66003494e-02  5.19856207e+01]
Stock Position:  -0.016600349402078718
Bond Position:  [7.57005562]


portfolio before change:  [5.79304184]
curr_Stock_Price:  107.1037753781226
curr_Factors:  [1.07103775e+02 2.99560256e-02]
mat_Sqrt:  [[ 1.85373170e+01  0.00000000e+00]
 [-6.92312364e-03  1.58628691e-02]]
grads:  [ 0.00555265 -0.8443062 ]
Stock Position:  0.005552653338034384
Bond Position:  [5.1983317]


portfolio before change:  [5.80488264]
curr_Stock_Price:  109.1192025710443
curr_Factors:  [1.09119203e+02 2.87139792e-02]
mat_Sqrt:  [[ 1.84904668e+01  0.00000000e+00]
 [-6.77807987e-03  1.55305320e-02]]
grads:  [-0.0043092  -3.36200253]
Stock Position:  -0.004309195638504136
Bond Position:  [6.27509863]


portfolio before change:  [5.80422215]
curr_Stock_Price:  109.4545150925245
curr_Factors:  [1.09454515e+02 2.85070184e-02]
mat_Sqrt:  [[ 1.84803239e+01  0.00000000e+00]
 [-6.75360862e-03  1.54744614e-02]]
grads:  [ 4.11719271e-03 -6.92593048e+00]
Stock Position:  0.004117192710417532
Bond Position:  [5.35357682]


portfolio before change:  [5.81075943]
curr_Stock_Price:  110.87976884206881
curr_Factors:  [1.10879769e+02 2.87615130e-02]
mat_Sqrt:  [[ 1.88043435e+01  0.00000000e+00]
 [-6.78368784e-03  1.55433815e-02]]
grads:  [-0.00969454 -8.80892728]
Stock Position:  -0.00969454268124469
Bond Position:  [6.88568808]


portfolio before change:  [5.81273959]
curr_Stock_Price:  110.76430292106178
curr_Factors:  [1.10764303e+02 2.79530670e-02]
mat_Sqrt:  [[ 1.85188729e+01  0.00000000e+00]
 [-6.68766829e-03  1.53233731e-02]]
grads:  [ 0.01618075 -2.16200192]
Stock Position:  0.016180752970956478
Bond Position:  [4.02048976]


portfolio before change:  [5.84229757]
curr_Stock_Price:  112.55997901436609
curr_Factors:  [1.12559979e+02 2.69479348e-02]
mat_Sqrt:  [[ 1.84776505e+01  0.00000000e+00]
 [-6.56633045e-03  1.50453532e-02]]
grads:  [3.49425790e-02 3.70579536e+01]
Stock Position:  0.03494257898097345
Bond Position:  [1.90916161]


portfolio before change:  [5.87190503]
curr_Stock_Price:  113.40046655976467
curr_Factors:  [1.13400467e+02 2.60133087e-02]
mat_Sqrt:  [[ 1.82899551e+01  0.00000000e+00]
 [-6.45145673e-03  1.47821444e-02]]
grads:  [ 0.01621769 -0.71966795]
Stock Position:  0.016217694131497748
Bond Position:  [4.03281095]


portfolio before change:  [5.86006516]
curr_Stock_Price:  112.63932246719625
curr_Factors:  [1.12639322e+02 2.49230894e-02]
mat_Sqrt:  [[ 1.77824242e+01  0.00000000e+00]
 [-6.31481932e-03  1.44690688e-02]]
grads:  [-1.33909318e-02 -2.08234304e+01]
Stock Position:  -0.013390931842753069
Bond Position:  [7.36841065]


portfolio before change:  [5.86606743]
curr_Stock_Price:  112.25987450408107
curr_Factors:  [1.12259875e+02 2.57422219e-02]
mat_Sqrt:  [[ 1.80114040e+01  0.00000000e+00]
 [-6.41775312e-03  1.47049197e-02]]
grads:  [ 0.00865428 -4.73831105]
Stock Position:  0.008654275220284011
Bond Position:  [4.89453958]


portfolio before change:  [5.86913487]
curr_Stock_Price:  112.54361638009445
curr_Factors:  [1.12543616e+02 2.56856369e-02]
mat_Sqrt:  [[ 1.80370719e+01  0.00000000e+00]
 [-6.41069567e-03  1.46887491e-02]]
grads:  [-0.01748396  5.24537388]
Stock Position:  -0.017483956167876215
Bond Position:  [7.83684253]


portfolio before change:  [5.87396036]
curr_Stock_Price:  112.32365320236718
curr_Factors:  [1.12323653e+02 2.66121082e-02]
mat_Sqrt:  [[ 1.83236024e+01  0.00000000e+00]
 [-6.52528721e-03  1.49513113e-02]]
grads:  [-2.98954689e-03  8.47899032e+00]
Stock Position:  -0.0029895468912489714
Bond Position:  [6.20975719]


portfolio before change:  [5.87496981]
curr_Stock_Price:  112.24565623766786
curr_Factors:  [1.12245656e+02 2.64981619e-02]
mat_Sqrt:  [[ 1.82716353e+01  0.00000000e+00]
 [-6.51130241e-03  1.49192681e-02]]
grads:  [-0.01387768 11.75851014]
Stock Position:  -0.013877682611805624
Bond Position:  [7.4326794]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.89097947]
Stock Price:  111.15898172407368
PL:  [-5.26800225]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.87590272e-02  2.95916886e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.24816994e-01 -7.11463064e-01]
 [-3.98808000e-03  2.46359056e-02]
 [ 3.40000707e-02 -1.90164835e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-3.59716492e-02  2.13152232e-01]
 [-3.58348384e-02 -6.98127643e-02]
 [ 1.46099027e-01  7.64706417e-02]
 [ 3.13744198e-01 -1.46600744e-01]
 [ 6.67363073e-02  9.88770445e-03]
 [-1.02300363e-01 -1.82129403e-01]
 [-1.59458946e-01  1.55028631e-01]
 [-4.07978053e-01 -5.34693644e-01]
 [ 7.67359511e-02  2.22702145e-01]
 [ 5.45232511e-02 -2.07376625e-02]
 [-5.27115817e-02  2.56096786e-01]
 [-1.41669401e-02  1.32730048e-01]
 [ 1.50020358e-02  6.33032378e-02]
 [-5.63083307e-02 -5.92004689e-02]
 [ 9.72640080e-02  2.08623855e-03]
 [ 9.77185805e-02  3.13055257e-01]
 [ 3.63184778e-02  3.00011147e-01]
 [-5.99664229e-02  1.23520506e-01]
 [ 3.07405593e-02  7.49854718e-02]
 [ 3.81442780e-01 -5.65822840e-02]
 [-1.48657830e-02  1.48190928e-01]
 [-1.14959944e-01  1.05760162e-01]
 [ 3.50375779e-02 -1.37714821e-01]
 [-5.17849444e-02 -3.43391854e-02]
 [-3.65223559e-01 -9.34526649e-02]
 [-1.17941563e-01  2.41388860e-04]
 [ 1.35464020e-01  1.12854282e-01]
 [ 1.62940315e-01  6.03278194e-02]
 [-2.88847934e-01 -1.79918423e-01]
 [-1.83645188e-02 -3.82888855e-01]
 [-1.64458932e-01  2.12513894e-01]
 [-1.21002688e-01  1.19421647e-01]
 [-2.98875648e-02  1.08964734e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.38897967]
curr_Stock_Price:  99.95198121229609
curr_Factors:  [9.99519812e+01 4.00018618e-02]
mat_Sqrt:  [[ 1.99908615e+01  0.00000000e+00]
 [-8.00018618e-03  1.83307294e-02]]
grads:  [7.89899648e-03 1.61432139e+01]
Stock Position:  0.00789899647653958
Bond Position:  [1.59945933]


portfolio before change:  [2.38533633]
curr_Stock_Price:  99.46542673796304
curr_Factors:  [9.94654267e+01 3.90396756e-02]
mat_Sqrt:  [[ 1.96528369e+01  0.00000000e+00]
 [-7.90338414e-03  1.81089280e-02]]
grads:  [-0.01032851 -4.86010933]
Stock Position:  -0.01032850620430933
Bond Position:  [3.4126656]


portfolio before change:  [2.38669557]
curr_Stock_Price:  99.37512967651189
curr_Factors:  [9.93751297e+01 3.98583778e-02]
mat_Sqrt:  [[ 1.98398104e+01  0.00000000e+00]
 [-7.98582523e-03  1.82978243e-02]]
grads:  [ 2.59230832e-02 -3.88823858e+01]
Stock Position:  0.025923083174274296
Bond Position:  [-0.18941418]


portfolio before change:  [2.4141253]
curr_Stock_Price:  100.43416303225551
curr_Factors:  [1.00434163e+02 3.95432526e-02]
mat_Sqrt:  [[ 1.99718207e+01  0.00000000e+00]
 [-7.95419413e-03  1.82253483e-02]]
grads:  [3.38672712e-04 1.35173853e+00]
Stock Position:  0.0003386727119915147
Bond Position:  [2.38011099]


portfolio before change:  [2.41388174]
curr_Stock_Price:  98.83648708757522
curr_Factors:  [9.88364871e+01 3.95529004e-02]
mat_Sqrt:  [[ 1.96565126e+01  0.00000000e+00]
 [-7.95516441e-03  1.82275715e-02]]
grads:  [ 0.00130749 -1.04328125]
Stock Position:  0.0013074850781139213
Bond Position:  [2.28465451]


portfolio before change:  [2.41492279]
curr_Stock_Price:  99.41426920166894
curr_Factors:  [9.94142692e+01 3.83968985e-02]
mat_Sqrt:  [[ 1.94803519e+01  0.00000000e+00]
 [-7.83805062e-03  1.79592301e-02]]
grads:  [-0.00607899 -3.69263757]
Stock Position:  -0.006078985249737843
Bond Position:  [3.01926066]


portfolio before change:  [2.41652092]
curr_Stock_Price:  99.213462524485
curr_Factors:  [9.92134625e+01 3.84510358e-02]
mat_Sqrt:  [[ 1.94547040e+01  0.00000000e+00]
 [-7.84357426e-03  1.79718864e-02]]
grads:  [2.93274118e-03 1.18603149e+01]
Stock Position:  0.0029327411785656753
Bond Position:  [2.12555351]


portfolio before change:  [2.416578]
curr_Stock_Price:  99.14232361815495
curr_Factors:  [9.91423236e+01 3.90873369e-02]
mat_Sqrt:  [[ 1.96009506e+01  0.00000000e+00]
 [-7.90820707e-03  1.81199788e-02]]
grads:  [-3.38267403e-03 -3.85280608e+00]
Stock Position:  -0.003382674031371929
Bond Position:  [2.75194416]


portfolio before change:  [2.4126745]
curr_Stock_Price:  100.39799013613323
curr_Factors:  [1.00397990e+02 3.87590299e-02]
mat_Sqrt:  [[ 1.97656667e+01  0.00000000e+00]
 [-7.87492526e-03  1.80437206e-02]]
grads:  [0.00908007 4.23807504]
Stock Position:  0.009080065661949762
Bond Position:  [1.50105416]


portfolio before change:  [2.41863518]
curr_Stock_Price:  101.03378242028955
curr_Factors:  [1.01033782e+02 3.87882061e-02]
mat_Sqrt:  [[ 1.98983222e+01  0.00000000e+00]
 [-7.87788867e-03  1.80505106e-02]]
grads:  [ 0.01255193 -8.12169515]
Stock Position:  0.01255193201948917
Bond Position:  [1.15046601]


portfolio before change:  [2.42311546]
curr_Stock_Price:  101.37926429863926
curr_Factors:  [1.01379264e+02 3.93032414e-02]
mat_Sqrt:  [[ 2.00984849e+01  0.00000000e+00]
 [-7.93001805e-03  1.81699540e-02]]
grads:  [0.00353517 0.54417884]
Stock Position:  0.0035351746982569144
Bond Position:  [2.06472205]


portfolio before change:  [2.42876813]
curr_Stock_Price:  102.90523140582282
curr_Factors:  [1.02905231e+02 3.97703381e-02]
mat_Sqrt:  [[ 2.05218777e+01  0.00000000e+00]
 [-7.97700075e-03  1.82776049e-02]]
grads:  [-8.85826110e-03 -9.96462089e+00]
Stock Position:  -0.008858261095061415
Bond Position:  [3.34032954]


portfolio before change:  [2.44053871]
curr_Stock_Price:  101.62360148961503
curr_Factors:  [1.01623601e+02 4.01676744e-02]
mat_Sqrt:  [[ 2.03672749e+01  0.00000000e+00]
 [-8.01674990e-03  1.83686816e-02]]
grads:  [-4.50717655e-03  8.43983441e+00]
Stock Position:  -0.0045071765459896405
Bond Position:  [2.89857422]


portfolio before change:  [2.44603235]
curr_Stock_Price:  100.48512853430788
curr_Factors:  [1.00485129e+02 4.04141296e-02]
mat_Sqrt:  [[ 2.02007925e+01  0.00000000e+00]
 [-8.04130632e-03  1.84249474e-02]]
grads:  [ -0.03174814 -29.02009058]
Stock Position:  -0.03174813521800425
Bond Position:  [5.6362478]


portfolio before change:  [2.43946361]
curr_Stock_Price:  100.71422266233284
curr_Factors:  [1.00714223e+02 3.80740593e-02]
mat_Sqrt:  [[ 1.96519385e+01  0.00000000e+00]
 [-7.80503010e-03  1.78835706e-02]]
grads:  [8.85058417e-03 1.24528904e+01]
Stock Position:  0.008850584166306163
Bond Position:  [1.54808391]


portfolio before change:  [2.44393933]
curr_Stock_Price:  101.19805458448899
curr_Factors:  [1.01198055e+02 3.77932044e-02]
mat_Sqrt:  [[ 1.96733819e+01  0.00000000e+00]
 [-7.77618975e-03  1.78174891e-02]]
grads:  [ 0.00231138 -1.16389366]
Stock Position:  0.002311376533708308
Bond Position:  [2.21003252]


portfolio before change:  [2.44539221]
curr_Stock_Price:  101.7071044481525
curr_Factors:  [1.01707104e+02 3.88233316e-02]
mat_Sqrt:  [[ 2.00399988e+01  0.00000000e+00]
 [-7.88145485e-03  1.80586817e-02]]
grads:  [2.94701710e-03 1.41813666e+01]
Stock Position:  0.0029470170985337056
Bond Position:  [2.14565963]


portfolio before change:  [2.45064635]
curr_Stock_Price:  103.39895469195612
curr_Factors:  [1.03398955e+02 3.87598991e-02]
mat_Sqrt:  [[ 2.03567043e+01  0.00000000e+00]
 [-7.87501356e-03  1.80439229e-02]]
grads:  [2.14971939e-03 7.35594186e+00]
Stock Position:  0.002149719386748711
Bond Position:  [2.22836761]


portfolio before change:  [2.44607681]
curr_Stock_Price:  101.14373012557225
curr_Factors:  [1.01143730e+02 3.89775052e-02]
mat_Sqrt:  [[ 1.99685249e+01  0.00000000e+00]
 [-7.89708859e-03  1.80945031e-02]]
grads:  [2.13485142e-03 3.49847892e+00]
Stock Position:  0.002134851419568629
Bond Position:  [2.23014997]


portfolio before change:  [2.44638594]
curr_Stock_Price:  101.15794567585067
curr_Factors:  [1.01157946e+02 3.93184808e-02]
mat_Sqrt:  [[ 2.00584960e+01  0.00000000e+00]
 [-7.93155529e-03  1.81734763e-02]]
grads:  [-0.0040953  -3.25752036]
Stock Position:  -0.004095298750094086
Bond Position:  [2.86065795]


portfolio before change:  [2.45257277]
curr_Stock_Price:  99.73455248881784
curr_Factors:  [9.97345525e+01 4.14444135e-02]
mat_Sqrt:  [[ 2.03038615e+01  0.00000000e+00]
 [-8.14316042e-03  1.86583245e-02]]
grads:  [0.00483526 0.11181275]
Stock Position:  0.004835263340435543
Bond Position:  [1.97032994]


portfolio before change:  [2.45197652]
curr_Stock_Price:  99.56029959777156
curr_Factors:  [9.95602996e+01 4.14888876e-02]
mat_Sqrt:  [[ 2.02792594e+01  0.00000000e+00]
 [-8.14752847e-03  1.86683330e-02]]
grads:  [1.15559987e-02 1.67693204e+01]
Stock Position:  0.011555998741176663
Bond Position:  [1.30145782]


portfolio before change:  [2.44552927]
curr_Stock_Price:  98.98830739271033
curr_Factors:  [9.89883074e+01 4.31771168e-02]
mat_Sqrt:  [[ 2.05688835e+01  0.00000000e+00]
 [-8.31164165e-03  1.90443635e-02]]
grads:  [8.13141253e-03 1.57532777e+01]
Stock Position:  0.008131412534551826
Bond Position:  [1.6406145]


portfolio before change:  [2.44269658]
curr_Stock_Price:  98.6147224989587
curr_Factors:  [9.86147225e+01 4.25646261e-02]
mat_Sqrt:  [[ 2.03453970e+01  0.00000000e+00]
 [-8.25247852e-03  1.89088037e-02]]
grads:  [-2.97740785e-04  6.53243366e+00]
Stock Position:  -0.000297740784834424
Bond Position:  [2.47205821]


portfolio before change:  [2.44310258]
curr_Stock_Price:  98.28904760431547
curr_Factors:  [9.82890476e+01 4.23879995e-02]
mat_Sqrt:  [[ 2.02360893e+01  0.00000000e+00]
 [-8.23533844e-03  1.88695309e-02]]
grads:  [3.13632250e-03 3.97389168e+00]
Stock Position:  0.0031363225019769574
Bond Position:  [2.13483643]


portfolio before change:  [2.44377997]
curr_Stock_Price:  98.4199396838373
curr_Factors:  [9.84199397e+01 4.16411893e-02]
mat_Sqrt:  [[ 2.00837431e+01  0.00000000e+00]
 [-8.16246917e-03  1.87025664e-02]]
grads:  [ 0.01776304 -3.02537538]
Stock Position:  0.01776303577929017
Bond Position:  [0.69554306]


portfolio before change:  [2.45666282]
curr_Stock_Price:  99.14030644739502
curr_Factors:  [9.91403064e+01 4.30387030e-02]
mat_Sqrt:  [[ 2.05674213e+01  0.00000000e+00]
 [-8.29830855e-03  1.90138135e-02]]
grads:  [2.42179317e-03 7.79385619e+00]
Stock Position:  0.0024217931715865312
Bond Position:  [2.2165655]


portfolio before change:  [2.45966452]
curr_Stock_Price:  100.26534575415528
curr_Factors:  [1.00265346e+02 4.27559084e-02]
mat_Sqrt:  [[ 2.07323688e+01  0.00000000e+00]
 [-8.27100075e-03  1.89512435e-02]]
grads:  [-3.31859932e-03  5.58064500e+00]
Stock Position:  -0.0033185993187400324
Bond Position:  [2.79240503]


portfolio before change:  [2.45426658]
curr_Stock_Price:  101.99710391230718
curr_Factors:  [1.01997104e+02 4.11841120e-02]
mat_Sqrt:  [[ 2.06991587e+01  0.00000000e+00]
 [-8.11754761e-03  1.85996382e-02]]
grads:  [-1.21097180e-03 -7.40416666e+00]
Stock Position:  -0.0012109718013362388
Bond Position:  [2.5777822]


portfolio before change:  [2.45508494]
curr_Stock_Price:  101.58741970263293
curr_Factors:  [1.0158742e+02 4.1065353e-02]
mat_Sqrt:  [[ 2.05862721e+01  0.00000000e+00]
 [-8.10583523e-03  1.85728018e-02]]
grads:  [-0.00324351 -1.84889635]
Stock Position:  -0.003243510680711433
Bond Position:  [2.78458482]


portfolio before change:  [2.45208492]
curr_Stock_Price:  102.61966824290165
curr_Factors:  [1.02619668e+02 3.90977207e-02]
mat_Sqrt:  [[ 2.02911343e+01  0.00000000e+00]
 [-7.90925743e-03  1.81223854e-02]]
grads:  [-0.02000921 -5.15675297]
Stock Position:  -0.02000921383827569
Bond Position:  [4.50542381]


portfolio before change:  [2.46190181]
curr_Stock_Price:  102.15719760232038
curr_Factors:  [1.02157198e+02 3.80301878e-02]
mat_Sqrt:  [[ 1.99220124e+01  0.00000000e+00]
 [-7.80053207e-03  1.78732643e-02]]
grads:  [-0.00591487  0.01350558]
Stock Position:  -0.005914874971466862
Bond Position:  [3.06614886]


portfolio before change:  [2.46101556]
curr_Stock_Price:  102.37183347536855
curr_Factors:  [1.02371833e+02 3.84003646e-02]
mat_Sqrt:  [[ 2.00607957e+01  0.00000000e+00]
 [-7.83840439e-03  1.79600407e-02]]
grads:  [0.00920789 6.28363177]
Stock Position:  0.00920789331565741
Bond Position:  [1.51838664]


portfolio before change:  [2.45452946]
curr_Stock_Price:  101.64681315195784
curr_Factors:  [1.01646813e+02 3.91092273e-02]
mat_Sqrt:  [[ 2.01017277e+01  0.00000000e+00]
 [-7.91042121e-03  1.81250520e-02]]
grads:  [0.00941559 3.32842187]
Stock Position:  0.009415585430009095
Bond Position:  [1.49746521]


portfolio before change:  [2.4523812]
curr_Stock_Price:  101.39877203866097
curr_Factors:  [1.01398772e+02 4.04368765e-02]
mat_Sqrt:  [[ 2.03902005e+01  0.00000000e+00]
 [-8.04356901e-03  1.84301319e-02]]
grads:  [-0.01801703 -9.76218856]
Stock Position:  -0.018017025959130673
Bond Position:  [4.27928551]


portfolio before change:  [2.43526319]
curr_Stock_Price:  102.37856493415859
curr_Factors:  [1.02378565e+02 3.89603602e-02]
mat_Sqrt:  [[ 2.02078691e+01  0.00000000e+00]
 [-7.89535156e-03  1.80905231e-02]]
grads:  [-9.17815304e-03 -2.11651622e+01]
Stock Position:  -0.009178153040582967
Bond Position:  [3.37490933]


portfolio before change:  [2.41459666]
curr_Stock_Price:  104.67624105390577
curr_Factors:  [1.04676241e+02 3.97554648e-02]
mat_Sqrt:  [[ 2.08711575e+01  0.00000000e+00]
 [-7.97550899e-03  1.82741868e-02]]
grads:  [-3.43585472e-03  1.16291847e+01]
Stock Position:  -0.0034358547174645113
Bond Position:  [2.77424902]


portfolio before change:  [2.41988949]
curr_Stock_Price:  103.23670892766499
curr_Factors:  [1.03236709e+02 4.10084617e-02]
mat_Sqrt:  [[ 2.09059973e+01  0.00000000e+00]
 [-8.10021844e-03  1.85599321e-02]]
grads:  [-3.29488269e-03  6.43437953e+00]
Stock Position:  -0.0032948826898053394
Bond Position:  [2.76004233]


portfolio before change:  [2.42202115]
curr_Stock_Price:  102.69446385367705
curr_Factors:  [1.02694464e+02 4.17632793e-02]
mat_Sqrt:  [[ 2.09867084e+01  0.00000000e+00]
 [-8.17442639e-03  1.87299639e-02]]
grads:  [8.41892102e-04 5.81766922e+00]
Stock Position:  0.000841892102493505
Bond Position:  [2.33556349]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.42267161]
Stock Price:  103.12029215031704
PL:  [-0.69762054]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.10789508e-01  6.23146915e-03]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.66898989e-01 -6.47357593e-01]
 [-1.44723499e-01 -2.34571182e-02]
 [-1.86649799e-01  8.94562207e-02]
 [ 8.12392754e-02  9.52863469e-02]
 [ 3.47255802e-02  2.44128692e-01]
 [ 2.68318549e-01 -2.11456514e-03]
 [ 9.73969556e-02  9.19594590e-02]
 [ 5.26327244e-01 -3.85492647e-01]
 [ 6.10280926e-02 -9.82179956e-03]
 [-2.29760881e-01 -1.90857448e-01]
 [-1.08110429e-01  1.21727723e-01]
 [-7.16238511e-01 -1.00186625e+00]
 [-1.49385190e-02 -1.85462948e-01]
 [-1.08789629e-02 -1.83331225e-01]
 [-5.05888721e-02  1.36772406e-01]
 [ 1.12958876e-01  1.54871660e-01]
 [ 1.64454917e-02  2.74620108e-02]
 [-1.15410379e-01 -2.45572408e-02]
 [ 1.69082028e-01  5.45605986e-01]
 [-1.00199161e-02  2.68774196e-01]
 [-1.45348172e-02 -3.92941656e-01]
 [ 1.70399260e-01  2.16038845e-01]
 [ 8.53061649e-02  1.76526881e-01]
 [ 8.21384068e-01 -7.90139974e-01]
 [-5.37105228e-01  6.76551353e-01]
 [ 1.34407900e-01 -1.07719307e-02]
 [-4.84189114e-02 -6.14724038e-02]
 [ 7.61244301e-02 -2.16019208e-01]
 [ 1.23933000e-01 -6.51037778e-02]
 [ 2.36784822e-01 -1.86660104e-02]
 [ 2.89360857e-01  3.69310044e-01]
 [ 2.52905160e-01  1.41718834e-02]
 [-1.47068620e-01 -2.44203665e-01]
 [ 1.84554618e-01 -7.26808861e-02]
 [-2.00630362e-01  1.85096645e-01]
 [-1.15951000e-01  1.22829620e-01]
 [-2.28147921e-01  1.57204466e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.1070956]
curr_Stock_Price:  99.12418331932184
curr_Factors:  [9.91241833e+01 3.93413405e-02]
mat_Sqrt:  [[ 1.96609364e+01  0.00000000e+00]
 [-7.93386065e-03  1.81787585e-02]]
grads:  [-0.01058291  0.34278849]
Stock Position:  -0.01058290752540162
Bond Position:  [-2.05807354]


portfolio before change:  [-3.09441741]
curr_Stock_Price:  97.9018848534769
curr_Factors:  [9.79018849e+01 4.13643016e-02]
mat_Sqrt:  [[ 1.99114965e+01  0.00000000e+00]
 [-8.13528627e-03  1.86402826e-02]]
grads:  [-0.01019433 -4.72156846]
Stock Position:  -0.010194334123095443
Bond Position:  [-2.09637288]


portfolio before change:  [-3.13134104]
curr_Stock_Price:  101.49815430760027
curr_Factors:  [1.01498154e+02 4.03611387e-02]
mat_Sqrt:  [[ 2.03910622e+01  0.00000000e+00]
 [-8.03603272e-03  1.84128641e-02]]
grads:  [ 2.37539843e-02 -3.51578977e+01]
Stock Position:  0.0237539843480759
Bond Position:  [-5.54232661]


portfolio before change:  [-3.0885634]
curr_Stock_Price:  103.32818329699519
curr_Factors:  [1.03328183e+02 4.00314746e-02]
mat_Sqrt:  [[ 2.06737656e+01  0.00000000e+00]
 [-8.00314684e-03  1.83375131e-02]]
grads:  [-0.00749554 -1.27918754]
Stock Position:  -0.007495539426260796
Bond Position:  [-2.31406293]


portfolio before change:  [-3.09495673]
curr_Stock_Price:  104.1425423213764
curr_Factors:  [1.04142542e+02 4.03831450e-02]
mat_Sqrt:  [[ 2.09280250e+01  0.00000000e+00]
 [-8.03822319e-03  1.84178831e-02]]
grads:  [-0.00705312  4.85703054]
Stock Position:  -0.0070531215518977635
Bond Position:  [-2.36042672]


portfolio before change:  [-3.08405805]
curr_Stock_Price:  102.55547805478027
curr_Factors:  [1.02555478e+02 3.95571574e-02]
mat_Sqrt:  [[ 2.03972398e+01  0.00000000e+00]
 [-7.95559249e-03  1.82285524e-02]]
grads:  [0.00602168 5.22731289]
Stock Position:  0.0060216797903054516
Bond Position:  [-3.7016143]


portfolio before change:  [-3.08703671]
curr_Stock_Price:  102.13766528838408
curr_Factors:  [1.02137665e+02 3.87863492e-02]
mat_Sqrt:  [[ 2.01152474e+01  0.00000000e+00]
 [-7.87770009e-03  1.80500785e-02]]
grads:  [7.02313394e-03 1.35250765e+01]
Stock Position:  0.007023133938021063
Bond Position:  [-3.80436322]


portfolio before change:  [-3.08918998]
curr_Stock_Price:  101.89878426967118
curr_Factors:  [1.01898784e+02 4.00707651e-02]
mat_Sqrt:  [[ 2.03977761e+01  0.00000000e+00]
 [-8.00707338e-03  1.83465099e-02]]
grads:  [ 0.01310906 -0.11525708]
Stock Position:  0.013109060344746426
Bond Position:  [-4.42498729]


portfolio before change:  [-3.08351402]
curr_Stock_Price:  102.3739607756351
curr_Factors:  [1.02373961e+02 3.92339905e-02]
mat_Sqrt:  [[ 2.02777959e+01  0.00000000e+00]
 [-7.92302876e-03  1.81539395e-02]]
grads:  [0.00678236 5.06553736]
Stock Position:  0.006782362073246352
Bond Position:  [-3.77785129]


portfolio before change:  [-3.07131645]
curr_Stock_Price:  104.24201642132381
curr_Factors:  [1.04242016e+02 3.82597472e-02]
mat_Sqrt:  [[ 2.03898416e+01  0.00000000e+00]
 [-7.82403959e-03  1.79271268e-02]]
grads:  [ 1.75619049e-02 -2.15033146e+01]
Stock Position:  0.017561904948196004
Bond Position:  [-4.90200484]


portfolio before change:  [-3.08374438]
curr_Stock_Price:  103.56924573625531
curr_Factors:  [1.03569246e+02 3.73056658e-02]
mat_Sqrt:  [[ 2.00040629e+01  0.00000000e+00]
 [-7.72586987e-03  1.77021917e-02]]
grads:  [ 0.0028365  -0.55483523]
Stock Position:  0.002836499172732203
Bond Position:  [-3.37751846]


portfolio before change:  [-3.08168498]
curr_Stock_Price:  104.44413120969134
curr_Factors:  [1.04444131e+02 3.55431616e-02]
mat_Sqrt:  [[ 1.96907415e+01  0.00000000e+00]
 [-7.54115765e-03  1.72789629e-02]]
grads:  [ -0.01589874 -11.04565417]
Stock Position:  -0.0158987360109277
Bond Position:  [-1.42115531]


portfolio before change:  [-3.0811314]
curr_Stock_Price:  104.3981378578051
curr_Factors:  [1.04398138e+02 3.55259408e-02]
mat_Sqrt:  [[ 1.96773018e+01  0.00000000e+00]
 [-7.53933056e-03  1.72747765e-02]]
grads:  [-2.79429042e-03  7.04655848e+00]
Stock Position:  -0.002794290415610941
Bond Position:  [-2.78941268]


portfolio before change:  [-3.08171497]
curr_Stock_Price:  104.48219052157455
curr_Factors:  [1.04482191e+02 3.40863293e-02]
mat_Sqrt:  [[ 1.92900071e+01  0.00000000e+00]
 [-7.38499336e-03  1.69211455e-02]]
grads:  [ -0.05979722 -59.20794459]
Stock Position:  -0.059797219560481105
Bond Position:  [3.16602952]


portfolio before change:  [-3.05731942]
curr_Stock_Price:  104.08083801268587
curr_Factors:  [1.04080838e+02 3.34810838e-02]
mat_Sqrt:  [[ 1.90445421e+01  0.00000000e+00]
 [-7.31913480e-03  1.67702446e-02]]
grads:  [-5.03457552e-03 -1.10590485e+01]
Stock Position:  -0.0050345755216863125
Bond Position:  [-2.53331658]


portfolio before change:  [-3.06361337]
curr_Stock_Price:  105.26807953845754
curr_Factors:  [1.05268080e+02 3.28947213e-02]
mat_Sqrt:  [[ 1.90923684e+01  0.00000000e+00]
 [-7.25476079e-03  1.66227452e-02]]
grads:  [-4.76060735e-03 -1.10289379e+01]
Stock Position:  -0.004760607346033292
Bond Position:  [-2.56247337]


portfolio before change:  [-3.06804905]
curr_Stock_Price:  106.13253921686305
curr_Factors:  [1.06132539e+02 3.21763401e-02]
mat_Sqrt:  [[ 1.90378051e+01  0.00000000e+00]
 [-7.17510586e-03  1.64402329e-02]]
grads:  [4.78180115e-04 8.31937160e+00]
Stock Position:  0.0004781801151510651
Bond Position:  [-3.11879952]


portfolio before change:  [-3.06881836]
curr_Stock_Price:  105.33904118554
curr_Factors:  [1.05339041e+02 3.26308750e-02]
mat_Sqrt:  [[ 1.90284635e+01  0.00000000e+00]
 [-7.22560724e-03  1.65559461e-02]]
grads:  [0.00948844 9.3544434 ]
Stock Position:  0.009488438738480454
Bond Position:  [-4.0683214]


portfolio before change:  [-3.06100781]
curr_Stock_Price:  106.21580524285574
curr_Factors:  [1.06215805e+02 3.11632219e-02]
mat_Sqrt:  [[ 1.87503907e+01  0.00000000e+00]
 [-7.06124316e-03  1.61793406e-02]]
grads:  [1.51628285e-03 1.69735043e+00]
Stock Position:  0.001516282846737194
Bond Position:  [-3.22206101]


portfolio before change:  [-3.05953474]
curr_Stock_Price:  107.45294480507425
curr_Factors:  [1.07452945e+02 3.01061831e-02]
mat_Sqrt:  [[ 1.86443038e+01  0.00000000e+00]
 [-6.94045337e-03  1.59025765e-02]]
grads:  [-0.00676496 -1.54423032]
Stock Position:  -0.00676496362441839
Bond Position:  [-2.33261947]


portfolio before change:  [-3.06538457]
curr_Stock_Price:  108.2745661515974
curr_Factors:  [1.08274566e+02 3.09504059e-02]
mat_Sqrt:  [[ 1.90484493e+01  0.00000000e+00]
 [-7.03709097e-03  1.61240010e-02]]
grads:  [2.13772783e-02 3.38381264e+01]
Stock Position:  0.021377278319613384
Bond Position:  [-5.38000011]


portfolio before change:  [-3.05752629]
curr_Stock_Price:  108.67362652075884
curr_Factors:  [1.08673627e+02 3.12582915e-02]
mat_Sqrt:  [[ 1.92135130e+01  0.00000000e+00]
 [-7.07200583e-03  1.62040010e-02]]
grads:  [5.58371392e-03 1.65869032e+01]
Stock Position:  0.005583713918504478
Bond Position:  [-3.66432873]


portfolio before change:  [-3.06450494]
curr_Stock_Price:  107.50584073901035
curr_Factors:  [1.07505841e+02 3.13598224e-02]
mat_Sqrt:  [[ 1.90378919e+01  0.00000000e+00]
 [-7.08348190e-03  1.62302960e-02]]
grads:  [-9.77149235e-03 -2.42103814e+01]
Stock Position:  -0.009771492352451986
Bond Position:  [-2.01401244]


portfolio before change:  [-3.07219991]
curr_Stock_Price:  108.26756749799394
curr_Factors:  [1.08267567e+02 3.32366403e-02]
mat_Sqrt:  [[ 1.97381724e+01  0.00000000e+00]
 [-7.29236755e-03  1.67089131e-02]]
grads:  [ 0.01340987 12.92955699]
Stock Position:  0.013409870792819465
Bond Position:  [-4.52405401]


portfolio before change:  [-3.09056441]
curr_Stock_Price:  106.94026493598962
curr_Factors:  [1.06940265e+02 3.28143977e-02]
mat_Sqrt:  [[ 1.93719560e+01  0.00000000e+00]
 [-7.24589790e-03  1.66024378e-02]]
grads:  [8.38061018e-03 1.06325880e+01]
Stock Position:  0.008380610182909408
Bond Position:  [-3.98678909]


portfolio before change:  [-3.08647855]
curr_Stock_Price:  107.48727084871163
curr_Factors:  [1.07487271e+02 3.23112114e-02]
mat_Sqrt:  [[ 1.93211804e+01  0.00000000e+00]
 [-7.19012783e-03  1.64746525e-02]]
grads:  [ 2.46640578e-02 -4.79609493e+01]
Stock Position:  0.024664057837026195
Bond Position:  [-5.73755081]


portfolio before change:  [-3.12422916]
curr_Stock_Price:  105.9857591235854
curr_Factors:  [1.05985759e+02 3.22031733e-02]
mat_Sqrt:  [[ 1.90194016e+01  0.00000000e+00]
 [-7.17809705e-03  1.64470865e-02]]
grads:  [-1.27151219e-02  4.11350272e+01]
Stock Position:  -0.012715121911886479
Bond Position:  [-1.77660731]


portfolio before change:  [-3.11659541]
curr_Stock_Price:  105.36792469551969
curr_Factors:  [1.05367925e+02 3.23312648e-02]
mat_Sqrt:  [[ 1.89460977e+01  0.00000000e+00]
 [-7.19235870e-03  1.64797641e-02]]
grads:  [ 0.00684609 -0.65364593]
Stock Position:  0.006846087548516099
Bond Position:  [-3.83795345]


portfolio before change:  [-3.11599506]
curr_Stock_Price:  105.52569646851995
curr_Factors:  [1.05525696e+02 3.25134537e-02]
mat_Sqrt:  [[ 1.90278526e+01  0.00000000e+00]
 [-7.21259495e-03  1.65261312e-02]]
grads:  [-0.00395461 -3.7197093 ]
Stock Position:  -0.0039546064046228875
Bond Position:  [-2.69868247]


portfolio before change:  [-3.12001812]
curr_Stock_Price:  106.45769910928315
curr_Factors:  [1.06457699e+02 3.14227908e-02]
mat_Sqrt:  [[ 1.88711972e+01  0.00000000e+00]
 [-7.09058992e-03  1.62465825e-02]]
grads:  [-9.61999458e-04 -1.32962860e+01]
Stock Position:  -0.0009619994583567689
Bond Position:  [-3.01760587]


portfolio before change:  [-3.12037637]
curr_Stock_Price:  106.43796930328686
curr_Factors:  [1.06437969e+02 3.17753063e-02]
mat_Sqrt:  [[ 1.89732379e+01  0.00000000e+00]
 [-7.13025176e-03  1.63374592e-02]]
grads:  [ 0.00503443 -3.98493896]
Stock Position:  0.005034427039608525
Bond Position:  [-3.65623056]


portfolio before change:  [-3.11469265]
curr_Stock_Price:  107.65772523129822
curr_Factors:  [1.07657725e+02 3.08296609e-02]
mat_Sqrt:  [[ 1.89029494e+01  0.00000000e+00]
 [-7.02335087e-03  1.60925185e-02]]
grads:  [ 0.01209538 -1.15991853]
Stock Position:  0.012095377368660258
Bond Position:  [-4.41685347]


portfolio before change:  [-3.10810903]
curr_Stock_Price:  108.24768333120042
curr_Factors:  [1.08247683e+02 3.02158576e-02]
mat_Sqrt:  [[ 1.88163799e+01  0.00000000e+00]
 [-6.95308365e-03  1.59315161e-02]]
grads:  [ 0.02394408 23.18109858]
Stock Position:  0.023944083649129692
Bond Position:  [-5.70000061]


portfolio before change:  [-3.09063226]
curr_Stock_Price:  109.00734132658103
curr_Factors:  [1.09007341e+02 2.97140173e-02]
mat_Sqrt:  [[ 1.87904177e+01  0.00000000e+00]
 [-6.89510172e-03  1.57986628e-02]]
grads:  [0.01378843 0.89703057]
Stock Position:  0.013788425632535415
Bond Position:  [-4.59367188]


portfolio before change:  [-3.09698582]
curr_Stock_Price:  108.58819891728412
curr_Factors:  [1.08588199e+02 2.89996062e-02]
mat_Sqrt:  [[ 1.84917784e+01  0.00000000e+00]
 [-6.81170829e-03  1.56075844e-02]]
grads:  [-1.37167898e-02 -1.56464741e+01]
Stock Position:  -0.013716789809376436
Bond Position:  [-1.60750432]


portfolio before change:  [-3.09051347]
curr_Stock_Price:  108.10169326252847
curr_Factors:  [1.08101693e+02 2.96397604e-02]
mat_Sqrt:  [[ 1.86110056e+01  0.00000000e+00]
 [-6.88648071e-03  1.57789096e-02]]
grads:  [ 0.00821203 -4.60620462]
Stock Position:  0.008212026910236906
Bond Position:  [-3.97824749]


portfolio before change:  [-3.10356521]
curr_Stock_Price:  106.57290750146794
curr_Factors:  [1.06572908e+02 3.13405440e-02]
mat_Sqrt:  [[ 1.88668797e+01  0.00000000e+00]
 [-7.08130428e-03  1.62253064e-02]]
grads:  [-6.35227260e-03  1.14078983e+01]
Stock Position:  -0.006352272601840711
Bond Position:  [-2.42658505]


portfolio before change:  [-3.10944565]
curr_Stock_Price:  107.45087607054352
curr_Factors:  [1.07450876e+02 3.14022319e-02]
mat_Sqrt:  [[ 1.90410204e+01  0.00000000e+00]
 [-7.08826996e-03  1.62412668e-02]]
grads:  [-3.27418161e-03  7.56281028e+00]
Stock Position:  -0.0032741816129191748
Bond Position:  [-2.75763197]


portfolio before change:  [-3.11015923]
curr_Stock_Price:  107.56353034446818
curr_Factors:  [1.07563530e+02 3.14601907e-02]
mat_Sqrt:  [[ 1.90785658e+01  0.00000000e+00]
 [-7.09480832e-03  1.62562481e-02]]
grads:  [-8.36217300e-03  9.67040273e+00]
Stock Position:  -0.008362172997371641
Bond Position:  [-2.21069438]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.10746405]
Stock Price:  107.20817632131445
PL:  [-10.31564037]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-9.81189364e-02  1.38976738e-01]
 [-1.77084735e-01 -7.84296065e-02]
 [ 7.70376160e-01 -6.49722911e-01]
 [ 5.34923157e-03  2.40719565e-02]
 [ 3.49311061e-02 -2.10292149e-02]
 [-8.09485426e-02 -1.01117734e-01]
 [-4.28233201e-02  2.03852454e-01]
 [-9.03902651e-02 -1.07071482e-01]
 [ 1.44877666e-01  7.68590739e-02]
 [ 3.38912123e-01 -1.64957568e-01]
 [ 6.17258407e-02 -7.41259279e-03]
 [-1.11686513e-01 -1.85522460e-01]
 [-1.90525631e-01  1.65810156e-01]
 [-6.21763028e-01 -7.85750290e-01]
 [ 4.78263772e-03 -9.76201997e-02]
 [ 5.61181445e-02 -2.17538531e-02]
 [-5.33430431e-02  2.91593276e-01]
 [-5.89764838e-02  1.12697974e-01]
 [ 1.48649051e-02  6.67082142e-02]
 [-8.18129012e-02 -3.87687899e-02]
 [ 1.98198424e-01  1.06197721e-01]
 [ 2.93443667e-02  1.32290628e-01]
 [ 3.74199952e-02  3.63498739e-01]
 [ 3.56096293e-02  1.69102906e-01]
 [ 4.56480074e-02  9.97448816e-02]
 [ 7.53423528e-01 -4.80954155e-01]
 [-3.02798279e-01  3.93046435e-01]
 [ 1.40627277e-01 -9.51632762e-03]
 [-4.90656197e-02 -6.07656588e-02]
 [ 8.57853790e-02 -1.93520474e-01]
 [ 1.13426397e-01 -6.51789568e-02]
 [ 6.91005479e-02 -9.89307897e-03]
 [ 2.30699618e-01  2.71556165e-01]
 [ 2.03243128e-01  3.96506978e-02]
 [-2.39476017e-01 -2.06162285e-01]
 [ 8.52571674e-02 -3.36268865e-01]
 [-1.67948690e-01  2.09262598e-01]
 [-1.18937508e-01  1.20814860e-01]
 [-1.13811104e-01  1.28634595e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.6275353]
curr_Stock_Price:  99.49764523365641
curr_Factors:  [9.94976452e+01 4.08164652e-02]
mat_Sqrt:  [[ 2.01015941e+01  0.00000000e+00]
 [-8.08123409e-03  1.85164335e-02]]
grads:  [-1.86375842e-03  7.50558894e+00]
Stock Position:  -0.0018637584211784986
Bond Position:  [-0.44209573]


portfolio before change:  [-0.62938929]
curr_Stock_Price:  100.46275041959787
curr_Factors:  [1.00462750e+02 4.04073264e-02]
mat_Sqrt:  [[ 2.01945938e+01  0.00000000e+00]
 [-8.04062947e-03  1.84233966e-02]]
grads:  [-0.0104639  -4.25706553]
Stock Position:  -0.010463900581693636
Bond Position:  [0.42184294]


portfolio before change:  [-0.63184359]
curr_Stock_Price:  100.70233948744158
curr_Factors:  [1.00702339e+02 4.01616779e-02]
mat_Sqrt:  [[ 2.01811302e+01  0.00000000e+00]
 [-8.01615149e-03  1.83673105e-02]]
grads:  [ 2.41222285e-02 -3.53738731e+01]
Stock Position:  0.024122228495323125
Bond Position:  [-3.06100843]


portfolio before change:  [-0.63403773]
curr_Stock_Price:  100.62724306084705
curr_Factors:  [1.00627243e+02 4.04903066e-02]
mat_Sqrt:  [[ 2.02484184e+01  0.00000000e+00]
 [-8.04888133e-03  1.84423040e-02]]
grads:  [7.83028795e-04 1.30525755e+00]
Stock Position:  0.0007830287954820733
Bond Position:  [-0.71283176]


portfolio before change:  [-0.63556017]
curr_Stock_Price:  98.79676004431045
curr_Factors:  [9.87967600e+01 4.28522579e-02]
mat_Sqrt:  [[ 2.04517068e+01  0.00000000e+00]
 [-8.28031476e-03  1.89725846e-02]]
grads:  [ 0.00125922 -1.10840011]
Stock Position:  0.0012592202981415196
Bond Position:  [-0.75996705]


portfolio before change:  [-0.63665848]
curr_Stock_Price:  97.99998471607803
curr_Factors:  [9.79999847e+01 4.19761998e-02]
mat_Sqrt:  [[ 2.00783290e+01  0.00000000e+00]
 [-8.19523762e-03  1.87776484e-02]]
grads:  [-0.0062296  -5.38500521]
Stock Position:  -0.0062295990673965585
Bond Position:  [-0.02615787]


portfolio before change:  [-0.64294696]
curr_Stock_Price:  99.00891136430683
curr_Factors:  [9.90089114e+01 4.22218982e-02]
mat_Sqrt:  [[ 2.03443193e+01  0.00000000e+00]
 [-8.21918714e-03  1.88325236e-02]]
grads:  [2.26820982e-03 1.08244895e+01]
Stock Position:  0.0022682098217328434
Bond Position:  [-0.86751995]


portfolio before change:  [-0.64599589]
curr_Stock_Price:  97.71252266330661
curr_Factors:  [9.77125227e+01 4.02241242e-02]
mat_Sqrt:  [[ 1.95971774e+01  0.00000000e+00]
 [-8.02238111e-03  1.83815843e-02]]
grads:  [-0.00699693 -5.82493218]
Stock Position:  -0.006996930637046888
Bond Position:  [0.03769185]


portfolio before change:  [-0.66517512]
curr_Stock_Price:  100.45428780323516
curr_Factors:  [1.00454288e+02 3.87955231e-02]
mat_Sqrt:  [[ 1.97860583e+01  0.00000000e+00]
 [-7.87863167e-03  1.80522130e-02]]
grads:  [0.00901755 4.25759844]
Stock Position:  0.009017547231015468
Bond Position:  [-1.5710264]


portfolio before change:  [-0.65432882]
curr_Stock_Price:  101.67886541174559
curr_Factors:  [1.01678865e+02 3.89762401e-02]
mat_Sqrt:  [[ 2.00738494e+01  0.00000000e+00]
 [-7.89696044e-03  1.80942095e-02]]
grads:  [ 0.01329684 -9.11659435]
Stock Position:  0.01329683871133167
Bond Position:  [-2.0063363]


portfolio before change:  [-0.63441597]
curr_Stock_Price:  103.19529075002214
curr_Factors:  [1.03195291e+02 3.85583984e-02]
mat_Sqrt:  [[ 2.02637292e+01  0.00000000e+00]
 [-7.85451701e-03  1.79969594e-02]]
grads:  [ 0.00288647 -0.41188029]
Stock Position:  0.0028864736354973107
Bond Position:  [-0.93228645]


portfolio before change:  [-0.636168]
curr_Stock_Price:  102.62868712396039
curr_Factors:  [1.02628687e+02 3.78513489e-02]
mat_Sqrt:  [[ 1.99668453e+01  0.00000000e+00]
 [-7.78216925e-03  1.78311898e-02]]
grads:  [-9.64875269e-03 -1.04043792e+01]
Stock Position:  -0.009648752694647189
Bond Position:  [0.35407082]


portfolio before change:  [-0.63100134]
curr_Stock_Price:  102.09780025933682
curr_Factors:  [1.02097800e+02 3.85990695e-02]
mat_Sqrt:  [[ 2.00587933e+01  0.00000000e+00]
 [-7.85865836e-03  1.80064484e-02]]
grads:  [-5.89069064e-03  9.20837648e+00]
Stock Position:  -0.005890690639583806
Bond Position:  [-0.02957478]


portfolio before change:  [-0.63598288]
curr_Stock_Price:  102.94283678289979
curr_Factors:  [1.02942837e+02 3.72380095e-02]
mat_Sqrt:  [[ 1.98650362e+01  0.00000000e+00]
 [-7.71886100e-03  1.76861324e-02]]
grads:  [ -0.04856234 -44.42747981]
Stock Position:  -0.04856233632080907
Bond Position:  [4.36316178]


portfolio before change:  [-0.6676893]
curr_Stock_Price:  103.6069697102137
curr_Factors:  [1.03606970e+02 3.67570721e-02]
mat_Sqrt:  [[ 1.98636670e+01  0.00000000e+00]
 [-7.66885358e-03  1.75715510e-02]]
grads:  [-1.90409506e-03 -5.55558240e+00]
Stock Position:  -0.0019040950630449468
Bond Position:  [-0.47041178]


portfolio before change:  [-0.66499131]
curr_Stock_Price:  102.15914461641715
curr_Factors:  [1.02159145e+02 3.93636468e-02]
mat_Sqrt:  [[ 2.02686541e+01  0.00000000e+00]
 [-7.93610955e-03  1.81839114e-02]]
grads:  [ 0.0023003  -1.19632419]
Stock Position:  0.002300299984131704
Bond Position:  [-0.89998799]


portfolio before change:  [-0.6624237]
curr_Stock_Price:  103.32426220145102
curr_Factors:  [1.03324262e+02 3.81698369e-02]
mat_Sqrt:  [[ 2.01865669e+01  0.00000000e+00]
 [-7.81484095e-03  1.79060501e-02]]
grads:  [3.66177649e-03 1.62846231e+01]
Stock Position:  0.003661776493320081
Bond Position:  [-1.04077405]


portfolio before change:  [-0.66491112]
curr_Stock_Price:  102.68049784002359
curr_Factors:  [1.02680498e+02 3.89767506e-02]
mat_Sqrt:  [[ 2.02717285e+01  0.00000000e+00]
 [-7.89701215e-03  1.80943280e-02]]
grads:  [-4.82990664e-04  6.22835919e+00]
Stock Position:  -0.00048299066433668775
Bond Position:  [-0.6153174]


portfolio before change:  [-0.6648893]
curr_Stock_Price:  102.47605229782702
curr_Factors:  [1.02476052e+02 3.83058418e-02]
mat_Sqrt:  [[ 2.00564882e+01  0.00000000e+00]
 [-7.82875130e-03  1.79379227e-02]]
grads:  [2.19274462e-03 3.71883720e+00]
Stock Position:  0.002192744623289005
Bond Position:  [-0.88959311]


portfolio before change:  [-0.66606889]
curr_Stock_Price:  101.98881401033664
curr_Factors:  [1.01988814e+02 3.84481081e-02]
mat_Sqrt:  [[ 1.99981596e+01  0.00000000e+00]
 [-7.84327566e-03  1.79712022e-02]]
grads:  [-0.0049371  -2.15727304]
Stock Position:  -0.004937103738343217
Bond Position:  [-0.16253954]


portfolio before change:  [-0.66504484]
curr_Stock_Price:  101.77727933050475
curr_Factors:  [1.01777279e+02 3.76947093e-02]
mat_Sqrt:  [[ 1.97601864e+01  0.00000000e+00]
 [-7.76605015e-03  1.77942563e-02]]
grads:  [0.01237574 5.96808988]
Stock Position:  0.012375738981604566
Bond Position:  [-1.92461388]


portfolio before change:  [-0.66643041]
curr_Stock_Price:  101.68476170425464
curr_Factors:  [1.01684762e+02 3.83803269e-02]
mat_Sqrt:  [[ 1.99209575e+01  0.00000000e+00]
 [-7.83635904e-03  1.79553542e-02]]
grads:  [4.37131247e-03 7.36775371e+00]
Stock Position:  0.004371312470937888
Bond Position:  [-1.11092627]


portfolio before change:  [-0.67337588]
curr_Stock_Price:  100.12765500428509
curr_Factors:  [1.00127655e+02 3.86990025e-02]
mat_Sqrt:  [[ 1.96971744e+01  0.00000000e+00]
 [-7.86882481e-03  1.80297427e-02]]
grads:  [9.95390746e-03 2.01610609e+01]
Stock Position:  0.009953907458734933
Bond Position:  [-1.67003729]


portfolio before change:  [-0.65319089]
curr_Stock_Price:  102.17647469567831
curr_Factors:  [1.02176475e+02 3.98267034e-02]
mat_Sqrt:  [[ 2.03909798e+01  0.00000000e+00]
 [-7.98265153e-03  1.82905524e-02]]
grads:  [5.36571508e-03 9.24536896e+00]
Stock Position:  0.00536571508374601
Bond Position:  [-1.20144074]


portfolio before change:  [-0.64743403]
curr_Stock_Price:  103.27736180064599
curr_Factors:  [1.03277362e+02 3.89725028e-02]
mat_Sqrt:  [[ 2.03884535e+01  0.00000000e+00]
 [-7.89658183e-03  1.80933420e-02]]
grads:  [4.37405627e-03 5.51279480e+00]
Stock Position:  0.004374056268529346
Bond Position:  [-1.09917502]


portfolio before change:  [-0.64500861]
curr_Stock_Price:  103.86327638082403
curr_Factors:  [1.03863276e+02 3.90505992e-02]
mat_Sqrt:  [[ 2.05246552e+01  0.00000000e+00]
 [-7.90448978e-03  1.81114614e-02]]
grads:  [ 2.64812208e-02 -2.65552373e+01]
Stock Position:  0.026481220835350393
Bond Position:  [-3.39543497]


portfolio before change:  [-0.65012111]
curr_Stock_Price:  103.68624383606885
curr_Factors:  [1.03686244e+02 3.95013315e-02]
mat_Sqrt:  [[ 2.06075807e+01  0.00000000e+00]
 [-7.94997675e-03  1.82156851e-02]]
grads:  [-6.36944012e-03  2.15773622e+01]
Stock Position:  -0.006369440120580296
Bond Position:  [0.01030221]


portfolio before change:  [-0.65753747]
curr_Stock_Price:  104.85081240320096
curr_Factors:  [1.04850812e+02 4.01825738e-02]
mat_Sqrt:  [[ 2.10179655e+01  0.00000000e+00]
 [-8.01823659e-03  1.83720881e-02]]
grads:  [ 0.00649321 -0.51797747]
Stock Position:  0.006493207496707807
Bond Position:  [-1.33835555]


portfolio before change:  [-0.65159193]
curr_Stock_Price:  105.79223403788079
curr_Factors:  [1.05792234e+02 4.01141361e-02]
mat_Sqrt:  [[ 2.11886121e+01  0.00000000e+00]
 [-8.01140548e-03  1.83564360e-02]]
grads:  [-0.00356729 -3.310319  ]
Stock Position:  -0.0035672901631131435
Bond Position:  [-0.27420033]


portfolio before change:  [-0.65618201]
curr_Stock_Price:  107.06933922533955
curr_Factors:  [1.07069339e+02 3.96526107e-02]
mat_Sqrt:  [[ 2.13206782e+01  0.00000000e+00]
 [-7.96518532e-03  1.82505323e-02]]
grads:  [ 6.21987563e-05 -1.06035523e+01]
Stock Position:  6.219875632395503e-05
Bond Position:  [-0.66284159]


portfolio before change:  [-0.65631656]
curr_Stock_Price:  106.23828807895883
curr_Factors:  [1.06238288e+02 3.97562265e-02]
mat_Sqrt:  [[ 2.11828135e+01  0.00000000e+00]
 [-7.97558539e-03  1.82743619e-02]]
grads:  [ 0.00401174 -3.56668852]
Stock Position:  0.004011741314219245
Bond Position:  [-1.08251709]


portfolio before change:  [-0.65866796]
curr_Stock_Price:  105.68589092442325
curr_Factors:  [1.05685891e+02 4.02052913e-02]
mat_Sqrt:  [[ 2.11913498e+01  0.00000000e+00]
 [-8.02050286e-03  1.83772807e-02]]
grads:  [ 0.00305704 -0.53833204]
Stock Position:  0.0030570423779358253
Bond Position:  [-0.98175421]


portfolio before change:  [-0.65781125]
curr_Stock_Price:  106.00627861276048
curr_Factors:  [1.06006279e+02 4.09268627e-02]
mat_Sqrt:  [[ 2.14454822e+01  0.00000000e+00]
 [-8.09215548e-03  1.85414575e-02]]
grads:  [ 0.01628392 14.64589096]
Stock Position:  0.01628391664242775
Bond Position:  [-2.38400865]


portfolio before change:  [-0.69379013]
curr_Stock_Price:  103.81510661984305
curr_Factors:  [1.03815107e+02 4.18541796e-02]
mat_Sqrt:  [[ 2.12387998e+01  0.00000000e+00]
 [-8.18331762e-03  1.87503362e-02]]
grads:  [0.01038421 2.11466596]
Stock Position:  0.010384207815362135
Bond Position:  [-1.77182777]


portfolio before change:  [-0.69465067]
curr_Stock_Price:  103.75356595645248
curr_Factors:  [1.03753566e+02 4.17505748e-02]
mat_Sqrt:  [[ 2.11999219e+01  0.00000000e+00]
 [-8.17318296e-03  1.87271148e-02]]
grads:  [ -0.01554027 -11.00875853]
Stock Position:  -0.015540274899400054
Bond Position:  [0.91770827]


portfolio before change:  [-0.68579094]
curr_Stock_Price:  103.19083369107176
curr_Factors:  [1.03190834e+02 4.17777324e-02]
mat_Sqrt:  [[ 2.10917956e+01  0.00000000e+00]
 [-8.17584074e-03  1.87332045e-02]]
grads:  [-2.91594885e-03 -1.79504187e+01]
Stock Position:  -0.002915948851543412
Bond Position:  [-0.38489174]


portfolio before change:  [-0.69073472]
curr_Stock_Price:  104.86976273709713
curr_Factors:  [1.04869763e+02 4.07638334e-02]
mat_Sqrt:  [[ 2.11732631e+01  0.00000000e+00]
 [-8.07602213e-03  1.85044914e-02]]
grads:  [-3.61866779e-03  1.13087463e+01]
Stock Position:  -0.003618667791449536
Bond Position:  [-0.31124589]


portfolio before change:  [-0.69109442]
curr_Stock_Price:  104.95841166402775
curr_Factors:  [1.04958412e+02 4.01490994e-02]
mat_Sqrt:  [[ 2.10307690e+01  0.00000000e+00]
 [-8.01489607e-03  1.83644340e-02]]
grads:  [-3.14822442e-03  6.57874128e+00]
Stock Position:  -0.003148224423480952
Bond Position:  [-0.36066179]


portfolio before change:  [-0.68985082]
curr_Stock_Price:  104.54907340280113
curr_Factors:  [1.04549073e+02 4.05236912e-02]
mat_Sqrt:  [[ 2.10462481e+01  0.00000000e+00]
 [-8.05219882e-03  1.84499053e-02]]
grads:  [-2.74017316e-03  6.97210056e+00]
Stock Position:  -0.0027401731592950444
Bond Position:  [-0.40336825]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.68803562]
Stock Price:  103.86823363906795
PL:  [-4.55626926]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.17417315e-01 -1.52963410e-03]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.31214481e-01 -7.25047400e-01]
 [-3.02247084e-02  1.54378925e-01]
 [ 3.20488170e-02 -1.47952578e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-3.08658673e-02  2.23977935e-01]
 [ 7.20515564e-02 -4.42394179e-02]
 [ 1.55472695e-01  7.34895154e-02]
 [ 2.90557506e-01 -1.29593135e-01]
 [ 7.20986385e-02  2.84889824e-02]
 [-1.17302066e-01 -1.87485998e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-3.63632288e-01 -4.82616555e-01]
 [ 8.20275627e-02  2.26935114e-01]
 [ 5.23633584e-02 -1.93614812e-02]
 [ 2.27028489e-02 -2.87526923e-02]
 [ 6.35064582e-02  6.10210409e-02]
 [ 1.02764998e-02  3.87649882e-02]
 [ 2.76106708e-01 -1.11117532e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-7.32374662e-03  1.51095659e-01]
 [ 1.54884688e-02  8.78642746e-02]
 [-4.10467940e-02  1.96185951e-02]
 [ 5.40626368e-02  1.39130724e-01]
 [ 8.72542526e-02  7.54087498e-02]
 [ 3.38807438e-02  2.09166116e-01]
 [-1.72231505e-01  1.19974803e-01]
 [-2.38483964e-01 -1.76187049e-02]
 [ 1.62300431e-01 -8.42551201e-02]
 [-1.02684439e+00 -1.16220952e-01]
 [-1.01616719e-01  9.89192906e-02]
 [-9.11569535e-03 -1.21612036e-01]
 [ 5.69364670e-02  9.16550721e-02]
 [-1.21770283e-01  1.15029541e-01]
 [-6.59375803e-01 -2.82408322e-01]
 [-2.48428974e-02  3.11672020e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 7.09692724e-01  2.07589316e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.25166207]
curr_Stock_Price:  99.10240926905142
curr_Factors:  [9.91024093e+01 3.92567452e-02]
mat_Sqrt:  [[ 1.96354725e+01  0.00000000e+00]
 [-7.92532601e-03  1.81592032e-02]]
grads:  [-0.01110668 -0.08423465]
Stock Position:  -0.011106679570847103
Bond Position:  [-2.15096337]


portfolio before change:  [-3.24179712]
curr_Stock_Price:  98.1899996890543
curr_Factors:  [9.81899997e+01 4.02506007e-02]
mat_Sqrt:  [[ 1.96994201e+01  0.00000000e+00]
 [-8.02502094e-03  1.83876330e-02]]
grads:  [-0.01030408 -4.78644371]
Stock Position:  -0.010304082407240582
Bond Position:  [-2.23003927]


portfolio before change:  [-3.25195966]
curr_Stock_Price:  99.14920898493686
curr_Factors:  [9.91492090e+01 4.00100646e-02]
mat_Sqrt:  [[ 1.98323364e+01  0.00000000e+00]
 [-8.00100639e-03  1.83326087e-02]]
grads:  [ 2.59564906e-02 -3.95496032e+01]
Stock Position:  0.025956490640299746
Bond Position:  [-5.82552518]


portfolio before change:  [-3.28012082]
curr_Stock_Price:  98.09232818646738
curr_Factors:  [9.80923282e+01 4.12936766e-02]
mat_Sqrt:  [[ 1.99331906e+01  0.00000000e+00]
 [-8.12833824e-03  1.86243626e-02]]
grads:  [1.86381493e-03 8.28908501e+00]
Stock Position:  0.0018638149335928156
Bond Position:  [-3.46294676]


portfolio before change:  [-3.27901106]
curr_Stock_Price:  98.92001328507948
curr_Factors:  [9.89200133e+01 4.02950011e-02]
mat_Sqrt:  [[ 1.98568224e+01  0.00000000e+00]
 [-8.02944592e-03  1.83977719e-02]]
grads:  [ 0.00128881 -0.80418748]
Stock Position:  0.001288808279187368
Bond Position:  [-3.40649999]


portfolio before change:  [-3.27828285]
curr_Stock_Price:  99.81545658107397
curr_Factors:  [9.98154566e+01 3.92063583e-02]
mat_Sqrt:  [[ 1.97640548e+01  0.00000000e+00]
 [-7.92023821e-03  1.81475456e-02]]
grads:  [-0.00599172 -3.65431941]
Stock Position:  -0.005991724506618347
Bond Position:  [-2.68021613]


portfolio before change:  [-3.2758613]
curr_Stock_Price:  99.35539042952979
curr_Factors:  [9.93553904e+01 3.93143938e-02]
mat_Sqrt:  [[ 1.97000453e+01  0.00000000e+00]
 [-7.93114305e-03  1.81725317e-02]]
grads:  [3.39522657e-03 1.23250815e+01]
Stock Position:  0.003395226573410155
Bond Position:  [-3.61319537]


portfolio before change:  [-3.27483723]
curr_Stock_Price:  99.79004369979694
curr_Factors:  [9.97900437e+01 3.89057433e-02]
mat_Sqrt:  [[ 1.96831259e+01  0.00000000e+00]
 [-7.88981554e-03  1.80778385e-02]]
grads:  [ 0.00267965 -2.44716302]
Stock Position:  0.002679650159982353
Bond Position:  [-3.54223964]


portfolio before change:  [-3.27490356]
curr_Stock_Price:  99.9305416049119
curr_Factors:  [9.99305416e+01 3.97171656e-02]
mat_Sqrt:  [[ 1.99153235e+01  0.00000000e+00]
 [-7.97166639e-03  1.82653823e-02]]
grads:  [0.00941718 4.02343155]
Stock Position:  0.009417178159809449
Bond Position:  [-4.21596727]


portfolio before change:  [-3.2707357]
curr_Stock_Price:  100.42908641217088
curr_Factors:  [1.00429086e+02 4.01841022e-02]
mat_Sqrt:  [[ 2.01319873e+01  0.00000000e+00]
 [-8.01838909e-03  1.83724375e-02]]
grads:  [ 0.01162322 -7.0536713 ]
Stock Position:  0.011623215412015546
Bond Position:  [-4.43804461]


portfolio before change:  [-3.26860321]
curr_Stock_Price:  100.6602861381244
curr_Factors:  [1.00660286e+02 4.04768817e-02]
mat_Sqrt:  [[ 2.02517093e+01  0.00000000e+00]
 [-8.04754687e-03  1.84392463e-02]]
grads:  [0.00417408 1.54501881]
Stock Position:  0.0041740797625951336
Bond Position:  [-3.68876727]


portfolio before change:  [-3.26154271]
curr_Stock_Price:  102.4622688382857
curr_Factors:  [1.02462269e+02 4.00375056e-02]
mat_Sqrt:  [[ 2.05020588e+01  0.00000000e+00]
 [-8.00374968e-03  1.83388944e-02]]
grads:  [-9.71256918e-03 -1.02234079e+01]
Stock Position:  -0.00971256917565082
Bond Position:  [-2.26637084]


portfolio before change:  [-3.26297592]
curr_Stock_Price:  102.58066141683116
curr_Factors:  [1.02580661e+02 4.09258716e-02]
mat_Sqrt:  [[ 2.07522153e+01  0.00000000e+00]
 [-8.09205750e-03  1.85412330e-02]]
grads:  [-5.82069036e-03  8.92775829e+00]
Stock Position:  -0.0058206903624895365
Bond Position:  [-2.66588565]


portfolio before change:  [-3.24815333]
curr_Stock_Price:  99.97687325545536
curr_Factors:  [9.99768733e+01 4.14245332e-02]
mat_Sqrt:  [[ 2.03483108e+01  0.00000000e+00]
 [-8.14120710e-03  1.86538489e-02]]
grads:  [ -0.02822168 -25.87222391]
Stock Position:  -0.02822167540049099
Bond Position:  [-0.42663847]


portfolio before change:  [-3.22912259]
curr_Stock_Price:  99.30065271222783
curr_Factors:  [9.93006527e+01 4.19525530e-02]
mat_Sqrt:  [[ 2.03390798e+01  0.00000000e+00]
 [-8.19292895e-03  1.87723585e-02]]
grads:  [8.90257415e-03 1.20887907e+01]
Stock Position:  0.008902574148468184
Bond Position:  [-4.11315401]


portfolio before change:  [-3.23319785]
curr_Stock_Price:  98.900646329331
curr_Factors:  [9.89006463e+01 4.12853168e-02]
mat_Sqrt:  [[ 2.00954132e+01  0.00000000e+00]
 [-8.12751542e-03  1.86224773e-02]]
grads:  [ 0.00218524 -1.03968343]
Stock Position:  0.002185240723488267
Bond Position:  [-3.44931957]


portfolio before change:  [-3.23757367]
curr_Stock_Price:  97.09552491147767
curr_Factors:  [9.70955249e+01 4.11371793e-02]
mat_Sqrt:  [[ 1.96932080e+01  0.00000000e+00]
 [-8.11292099e-03  1.85890373e-02]]
grads:  [ 5.15616612e-04 -1.54675532e+00]
Stock Position:  0.0005156166118817347
Bond Position:  [-3.28763774]


portfolio before change:  [-3.23827788]
curr_Stock_Price:  96.52682741322596
curr_Factors:  [9.65268274e+01 4.13412706e-02]
mat_Sqrt:  [[ 1.96263682e+01  0.00000000e+00]
 [-8.13302115e-03  1.86350925e-02]]
grads:  [0.00459271 3.2745231 ]
Stock Position:  0.004592710319927854
Bond Position:  [-3.68159764]


portfolio before change:  [-3.24038913]
curr_Stock_Price:  96.16733963598861
curr_Factors:  [9.61673396e+01 4.09622434e-02]
mat_Sqrt:  [[ 1.94634341e+01  0.00000000e+00]
 [-8.09565251e-03  1.85494702e-02]]
grads:  [1.39723173e-03 2.08981647e+00]
Stock Position:  0.0013972317311935528
Bond Position:  [-3.37475719]


portfolio before change:  [-3.24171535]
curr_Stock_Price:  95.5201005981723
curr_Factors:  [9.55201006e+01 4.04610456e-02]
mat_Sqrt:  [[ 1.92138025e+01  0.00000000e+00]
 [-8.04597246e-03  1.84356389e-02]]
grads:  [ 0.01184623 -6.02732201]
Stock Position:  0.011846225712645621
Bond Position:  [-4.37326802]


portfolio before change:  [-3.23218362]
curr_Stock_Price:  96.37087080590683
curr_Factors:  [9.63708708e+01 4.07336067e-02]
mat_Sqrt:  [[ 1.94501169e+01  0.00000000e+00]
 [-8.07302735e-03  1.84976295e-02]]
grads:  [ 0.00216598 -2.04231519]
Stock Position:  0.002165982386117469
Bond Position:  [-3.44092123]


portfolio before change:  [-3.23531365]
curr_Stock_Price:  95.12437536678658
curr_Factors:  [9.51243754e+01 4.08810466e-02]
mat_Sqrt:  [[ 1.92332564e+01  0.00000000e+00]
 [-8.08762478e-03  1.85310764e-02]]
grads:  [3.04783568e-03 8.15363639e+00]
Stock Position:  0.0030478356803746937
Bond Position:  [-3.52523712]


portfolio before change:  [-3.23478225]
curr_Stock_Price:  95.4433194110049
curr_Factors:  [9.54433194e+01 4.04879810e-02]
mat_Sqrt:  [[ 1.92047472e+01  0.00000000e+00]
 [-8.04865017e-03  1.84417743e-02]]
grads:  [2.80324346e-03 4.76441545e+00]
Stock Position:  0.002803243458694602
Bond Position:  [-3.50233311]


portfolio before change:  [-3.23561954]
curr_Stock_Price:  95.30081442140559
curr_Factors:  [9.53008144e+01 3.98429434e-02]
mat_Sqrt:  [[ 1.90227070e+01  0.00000000e+00]
 [-7.98427889e-03  1.82942812e-02]]
grads:  [-0.00170767  1.0723895 ]
Stock Position:  -0.001707671630389429
Bond Position:  [-3.07287704]


portfolio before change:  [-3.23612321]
curr_Stock_Price:  95.37081446177602
curr_Factors:  [9.53708145e+01 4.06080258e-02]
mat_Sqrt:  [[ 1.92185859e+01  0.00000000e+00]
 [-8.06057326e-03  1.84690936e-02]]
grads:  [5.97256547e-03 7.53316471e+00]
Stock Position:  0.005972565474130332
Bond Position:  [-3.80573164]


portfolio before change:  [-3.23005846]
curr_Stock_Price:  96.46590498008824
curr_Factors:  [9.64659050e+01 3.97167507e-02]
mat_Sqrt:  [[ 1.92247499e+01  0.00000000e+00]
 [-7.97162475e-03  1.82652869e-02]]
grads:  [0.00625055 4.12852807]
Stock Position:  0.006250553575269145
Bond Position:  [-3.83302376]


portfolio before change:  [-3.22364522]
curr_Stock_Price:  97.56859083574548
curr_Factors:  [9.75685908e+01 3.98959386e-02]
mat_Sqrt:  [[ 1.94883188e+01  0.00000000e+00]
 [-7.98958709e-03  1.83064438e-02]]
grads:  [6.42273568e-03 1.14258191e+01]
Stock Position:  0.006422735680644326
Bond Position:  [-3.85030249]


portfolio before change:  [-3.23175152]
curr_Stock_Price:  96.3814043911497
curr_Factors:  [9.63814044e+01 3.88864174e-02]
mat_Sqrt:  [[ 1.90060653e+01  0.00000000e+00]
 [-7.88785572e-03  1.80733480e-02]]
grads:  [-6.30694501e-03  6.63821685e+00]
Stock Position:  -0.0063069450061370574
Bond Position:  [-2.6238793]


portfolio before change:  [-3.22813405]
curr_Stock_Price:  95.75582744753652
curr_Factors:  [9.57558274e+01 4.00500329e-02]
mat_Sqrt:  [[ 1.91631391e+01  0.00000000e+00]
 [-8.00500173e-03  1.83417632e-02]]
grads:  [-0.01284619 -0.96057858]
Stock Position:  -0.012846193739840663
Bond Position:  [-1.99803614]


portfolio before change:  [-3.22896479]
curr_Stock_Price:  95.80105246955311
curr_Factors:  [9.58010525e+01 4.04619329e-02]
mat_Sqrt:  [[ 1.92705271e+01  0.00000000e+00]
 [-8.04606069e-03  1.84358411e-02]]
grads:  [ 0.00651401 -4.57018043]
Stock Position:  0.006514013927712755
Bond Position:  [-3.85301418]


portfolio before change:  [-3.22608496]
curr_Stock_Price:  96.3170904444401
curr_Factors:  [9.63170904e+01 4.15874420e-02]
mat_Sqrt:  [[ 1.96419436e+01  0.00000000e+00]
 [-8.15719971e-03  1.86904926e-02]]
grads:  [-0.05486053 -6.21818562]
Stock Position:  -0.054860526982206566
Bond Position:  [2.05792137]


portfolio before change:  [-3.21907034]
curr_Stock_Price:  96.19391679478228
curr_Factors:  [9.61939168e+01 4.05439304e-02]
mat_Sqrt:  [[ 1.93691487e+01  0.00000000e+00]
 [-8.05420938e-03  1.84545121e-02]]
grads:  [-3.01741716e-03  5.36016830e+00]
Stock Position:  -0.0030174171592334373
Bond Position:  [-2.92881316]


portfolio before change:  [-3.21760954]
curr_Stock_Price:  95.58845839398724
curr_Factors:  [9.55884584e+01 4.12973427e-02]
mat_Sqrt:  [[ 1.94252453e+01  0.00000000e+00]
 [-8.12869905e-03  1.86251894e-02]]
grads:  [-3.20158322e-03 -6.52943892e+00]
Stock Position:  -0.003201583220932156
Bond Position:  [-2.91157514]


portfolio before change:  [-3.22053736]
curr_Stock_Price:  96.38926632783857
curr_Factors:  [9.63892663e+01 3.99506133e-02]
mat_Sqrt:  [[ 1.92659487e+01  0.00000000e+00]
 [-7.99505981e-03  1.83189834e-02]]
grads:  [0.00503157 5.00328376]
Stock Position:  0.005031572609302306
Bond Position:  [-3.70552696]


portfolio before change:  [-3.21258031]
curr_Stock_Price:  98.06275372564333
curr_Factors:  [9.80627537e+01 3.88619859e-02]
mat_Sqrt:  [[ 1.93315457e+01  0.00000000e+00]
 [-7.88537744e-03  1.80676695e-02]]
grads:  [-3.70209794e-03  6.36659538e+00]
Stock Position:  -0.0037020979376316244
Bond Position:  [-2.84954239]


portfolio before change:  [-3.21401187]
curr_Stock_Price:  98.35322169946757
curr_Factors:  [9.83532217e+01 3.91953391e-02]
mat_Sqrt:  [[ 1.94717867e+01  0.00000000e+00]
 [-7.91912511e-03  1.81449951e-02]]
grads:  [ -0.04019297 -15.56397895]
Stock Position:  -0.040192967977294214
Bond Position:  [0.73909602]


portfolio before change:  [-3.21578196]
curr_Stock_Price:  98.3995603339263
curr_Factors:  [9.83995603e+01 3.90154906e-02]
mat_Sqrt:  [[ 1.9436215e+01  0.0000000e+00]
 [-7.9009357e-03  1.8103318e-02]]
grads:  [5.72034855e-03 1.72162927e+01]
Stock Position:  0.00572034854644291
Bond Position:  [-3.77866174]


portfolio before change:  [-3.22069319]
curr_Stock_Price:  97.62358202513467
curr_Factors:  [9.76235820e+01 3.78557394e-02]
mat_Sqrt:  [[ 1.89941825e+01  0.00000000e+00]
 [-7.78262058e-03  1.78322240e-02]]
grads:  [-4.64274867e-03  6.13281690e+00]
Stock Position:  -0.0046427486674998205
Bond Position:  [-2.76745143]


portfolio before change:  [-3.22163981]
curr_Stock_Price:  97.75295851956703
curr_Factors:  [9.77529585e+01 3.84137910e-02]
mat_Sqrt:  [[ 1.91590290e+01  0.00000000e+00]
 [-7.83977459e-03  1.79631802e-02]]
grads:  [0.03751509 1.15563789]
Stock Position:  0.03751508828980097
Bond Position:  [-6.88885067]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.20232341]
Stock Price:  98.29081035332992
PL:  [-3.20232341]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.94626433e-01  7.51927360e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.52922630e-01 -7.74291111e-01]
 [-3.66190320e-02  1.24460089e-01]
 [ 2.40253290e-02 -6.25523850e-03]
 [-8.21270010e-02 -6.33109262e-02]
 [ 1.02071133e-02  3.07921614e-01]
 [ 2.89116443e-01 -2.95759710e-03]
 [ 1.08958443e-01  8.82825359e-02]
 [ 2.88418319e-01 -1.28349256e-01]
 [ 6.87504460e-02  1.68421863e-02]
 [-1.47934677e-01 -1.29713601e-01]
 [-1.91310667e-01  1.65723067e-01]
 [-6.03254942e-01 -7.64015470e-01]
 [-2.03797171e-02 -2.09702248e-01]
 [ 5.48587879e-02 -5.69093150e-02]
 [-5.32166810e-02  2.84490051e-01]
 [-8.41627458e-02  8.37980532e-02]
 [ 1.48875986e-02  6.61447310e-02]
 [-9.92768713e-02 -3.71117516e-02]
 [ 2.20359478e-01  3.14460027e-01]
 [ 2.71495351e-02  9.13815777e-02]
 [-1.14032247e-02 -1.22142538e-01]
 [ 1.10914751e-01  1.95327183e-01]
 [ 7.85093265e-02  1.63875232e-01]
 [ 8.07303549e-01 -7.27422969e-01]
 [-7.06478510e-01  8.67594266e-01]
 [ 8.66716859e-02 -1.53838975e-02]
 [-5.87862177e-02 -5.01426573e-02]
 [ 1.40718203e-01 -6.55911177e-02]
 [-1.29476602e-01 -1.39037558e-01]
 [ 3.06697589e-01 -3.05119116e-02]
 [ 3.64505608e-01  4.94532269e-01]
 [ 2.76458554e-01  2.08795231e-03]
 [-1.06516266e-01 -3.01978046e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-3.57660045e-01  7.07304996e-02]
 [-1.09090708e-01  1.18210743e-01]
 [-3.44314243e-01  1.77547227e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.18640352]
curr_Stock_Price:  101.27701563310862
curr_Factors:  [1.01277016e+02 3.99109432e-02]
mat_Sqrt:  [[ 2.02328420e+01  0.00000000e+00]
 [-7.99108936e-03  1.83098859e-02]]
grads:  [3.57238215e-02 4.10667419e+01]
Stock Position:  0.03572382149071463
Bond Position:  [7.56840149]


portfolio before change:  [11.13166349]
curr_Stock_Price:  99.71822002486837
curr_Factors:  [9.97182200e+01 3.96089581e-02]
mat_Sqrt:  [[ 1.98459196e+01  0.00000000e+00]
 [-7.96079977e-03  1.82404838e-02]]
grads:  [-0.01022802 -4.82505679]
Stock Position:  -0.010228019273993963
Bond Position:  [12.15158337]


portfolio before change:  [11.146674]
curr_Stock_Price:  98.3991510008644
curr_Factors:  [9.83991510e+01 3.89365442e-02]
mat_Sqrt:  [[ 1.94164600e+01  0.00000000e+00]
 [-7.89293803e-03  1.80849930e-02]]
grads:  [ 2.65235931e-02 -4.28140122e+01]
Stock Position:  0.026523593060609484
Bond Position:  [8.53677496]


portfolio before change:  [11.15142789]
curr_Stock_Price:  98.53814909915089
curr_Factors:  [9.85381491e+01 3.82499611e-02]
mat_Sqrt:  [[ 1.92716944e+01  0.00000000e+00]
 [-7.82303891e-03  1.79248340e-02]]
grads:  [9.18435291e-04 6.94344447e+00]
Stock Position:  0.0009184352908330668
Bond Position:  [11.06092698]


portfolio before change:  [11.15347922]
curr_Stock_Price:  99.2661624012929
curr_Factors:  [9.92661624e+01 3.90265758e-02]
mat_Sqrt:  [[ 1.96101744e+01  0.00000000e+00]
 [-7.90205804e-03  1.81058896e-02]]
grads:  [ 0.00108593 -0.34548087]
Stock Position:  0.0010859321603531845
Bond Position:  [11.04568291]


portfolio before change:  [11.15620599]
curr_Stock_Price:  100.50562214773339
curr_Factors:  [1.00505622e+02 3.79399505e-02]
mat_Sqrt:  [[ 1.95766662e+01  0.00000000e+00]
 [-7.79127209e-03  1.78520471e-02]]
grads:  [-0.00560658 -3.54642389]
Stock Position:  -0.005606580467144353
Bond Position:  [11.71969885]


portfolio before change:  [11.15284843]
curr_Stock_Price:  101.36579173744083
curr_Factors:  [1.01365792e+02 3.63524325e-02]
mat_Sqrt:  [[ 1.93267200e+01  0.00000000e+00]
 [-7.62652555e-03  1.74745653e-02]]
grads:  [7.48161732e-03 1.76211315e+01]
Stock Position:  0.007481617320662299
Bond Position:  [10.39446837]


portfolio before change:  [11.16060558]
curr_Stock_Price:  102.22894091599754
curr_Factors:  [1.02228941e+02 3.61894295e-02]
mat_Sqrt:  [[ 1.94475425e+01  0.00000000e+00]
 [-7.60940781e-03  1.74353436e-02]]
grads:  [ 0.0148001  -0.16963228]
Stock Position:  0.014800103476054276
Bond Position:  [9.64760667]


portfolio before change:  [11.15799815]
curr_Stock_Price:  101.97127689132692
curr_Factors:  [1.01971277e+02 3.53907790e-02]
mat_Sqrt:  [[ 1.91832823e+01  0.00000000e+00]
 [-7.52497485e-03  1.72418834e-02]]
grads:  [0.00768837 5.12023738]
Stock Position:  0.00768836626181992
Bond Position:  [10.37400562]


portfolio before change:  [11.14728031]
curr_Stock_Price:  100.40856873784755
curr_Factors:  [1.00408569e+02 3.49883414e-02]
mat_Sqrt:  [[ 1.87815943e+01  0.00000000e+00]
 [-7.48206831e-03  1.71435722e-02]]
grads:  [ 0.01237393 -7.48672765]
Stock Position:  0.012373928875574116
Bond Position:  [9.90483182]


portfolio before change:  [11.15646539]
curr_Stock_Price:  101.05079784410904
curr_Factors:  [1.01050798e+02 3.44167485e-02]
mat_Sqrt:  [[ 1.87466929e+01  0.00000000e+00]
 [-7.42070062e-03  1.70029611e-02]]
grads:  [0.00405943 0.9905443 ]
Stock Position:  0.004059434851568877
Bond Position:  [10.74625626]


portfolio before change:  [11.1586684]
curr_Stock_Price:  101.26256222980852
curr_Factors:  [1.01262562e+02 3.50535415e-02]
mat_Sqrt:  [[ 1.89589754e+01  0.00000000e+00]
 [-7.48903641e-03  1.71595381e-02]]
grads:  [-0.01078889 -7.55927112]
Stock Position:  -0.010788891775501045
Bond Position:  [12.25117922]


portfolio before change:  [11.15072079]
curr_Stock_Price:  102.1411602134602
curr_Factors:  [1.0214116e+02 3.3941184e-02]
mat_Sqrt:  [[ 1.88176021e+01  0.00000000e+00]
 [-7.36925331e-03  1.68850806e-02]]
grads:  [-6.32297306e-03  9.81476316e+00]
Stock Position:  -0.006322973059863145
Bond Position:  [11.79655659]


portfolio before change:  [11.14857604]
curr_Stock_Price:  102.7135826285722
curr_Factors:  [1.02713583e+02 3.37772137e-02]
mat_Sqrt:  [[ 1.88772961e+01  0.00000000e+00]
 [-7.35143129e-03  1.68442452e-02]]
grads:  [ -0.04962038 -45.35765552]
Stock Position:  -0.04962038120217836
Bond Position:  [16.24526316]


portfolio before change:  [11.07630005]
curr_Stock_Price:  104.21108783910734
curr_Factors:  [1.04211088e+02 3.32526559e-02]
mat_Sqrt:  [[ 1.90032157e+01  0.00000000e+00]
 [-7.29412431e-03  1.67129384e-02]]
grads:  [-5.88854450e-03 -1.25472998e+01]
Stock Position:  -0.0058885444987640196
Bond Position:  [11.68995167]


portfolio before change:  [11.08468313]
curr_Stock_Price:  103.03562794604284
curr_Factors:  [1.03035628e+02 3.34303368e-02]
mat_Sqrt:  [[ 1.88389979e+01  0.00000000e+00]
 [-7.31358592e-03  1.67575305e-02]]
grads:  [ 1.59358405e-03 -3.39604424e+00]
Stock Position:  0.0015935840480279422
Bond Position:  [10.9204872]


portfolio before change:  [11.08588949]
curr_Stock_Price:  102.93598743250354
curr_Factors:  [1.02935987e+02 3.27150341e-02]
mat_Sqrt:  [[ 1.86183386e+01  0.00000000e+00]
 [-7.23491911e-03  1.65772822e-02]]
grads:  [3.81048805e-03 1.71614410e+01]
Stock Position:  0.0038104880463948145
Bond Position:  [10.69365314]


portfolio before change:  [11.08451585]
curr_Stock_Price:  102.22468010041715
curr_Factors:  [1.02224680e+02 3.28960198e-02]
mat_Sqrt:  [[ 1.85407559e+01  0.00000000e+00]
 [-7.25490397e-03  1.66230733e-02]]
grads:  [-2.56679270e-03  5.04106862e+00]
Stock Position:  -0.002566792704341443
Bond Position:  [11.34690541]


portfolio before change:  [11.08541279]
curr_Stock_Price:  102.42785531107236
curr_Factors:  [1.02427855e+02 3.35123982e-02]
mat_Sqrt:  [[ 1.87508445e+01  0.00000000e+00]
 [-7.32255673e-03  1.67780853e-02]]
grads:  [2.33352294e-03 3.94232893e+00]
Stock Position:  0.002333522941484782
Bond Position:  [10.84639504]


portfolio before change:  [11.08899739]
curr_Stock_Price:  103.38293935712005
curr_Factors:  [1.03382939e+02 3.32613828e-02]
mat_Sqrt:  [[ 1.88546739e+01  0.00000000e+00]
 [-7.29508138e-03  1.67151313e-02]]
grads:  [-0.00612441 -2.22024888]
Stock Position:  -0.0061244107474584435
Bond Position:  [11.72215697]


portfolio before change:  [11.08298278]
curr_Stock_Price:  104.60427718879248
curr_Factors:  [1.04604277e+02 3.23262312e-02]
mat_Sqrt:  [[ 1.88073229e+01  0.00000000e+00]
 [-7.19179880e-03  1.64784812e-02]]
grads:  [1.90139281e-02 1.90830710e+01]
Stock Position:  0.019013928128103486
Bond Position:  [9.09404457]


portfolio before change:  [11.09054664]
curr_Stock_Price:  104.94229459172072
curr_Factors:  [1.04942295e+02 3.27139205e-02]
mat_Sqrt:  [[ 1.89809023e+01  0.00000000e+00]
 [-7.23479597e-03  1.65770001e-02]]
grads:  [3.53153525e-03 5.51255216e+00]
Stock Position:  0.0035315352460576622
Bond Position:  [10.71993923]


portfolio before change:  [11.09358313]
curr_Stock_Price:  105.42265473170258
curr_Factors:  [1.05422655e+02 3.32001650e-02]
mat_Sqrt:  [[ 1.92089696e+01  0.00000000e+00]
 [-7.28836497e-03  1.66997421e-02]]
grads:  [-3.36876989e-03 -7.31403736e+00]
Stock Position:  -0.003368769892883867
Bond Position:  [11.44872779]


portfolio before change:  [11.09447637]
curr_Stock_Price:  105.58233720877365
curr_Factors:  [1.05582337e+02 3.20625148e-02]
mat_Sqrt:  [[ 1.89055825e+01  0.00000000e+00]
 [-7.16240348e-03  1.64111281e-02]]
grads:  [1.03759047e-02 1.19021181e+01]
Stock Position:  0.010375904731586482
Bond Position:  [9.9989641]


portfolio before change:  [11.10351926]
curr_Stock_Price:  106.3333979811599
curr_Factors:  [1.06333398e+02 3.17700785e-02]
mat_Sqrt:  [[ 1.89530381e+01  0.00000000e+00]
 [-7.12966518e-03  1.63361152e-02]]
grads:  [7.91589932e-03 1.00314690e+01]
Stock Position:  0.007915899317541598
Bond Position:  [10.26179478]


portfolio before change:  [11.10819161]
curr_Stock_Price:  106.76159241585283
curr_Factors:  [1.06761592e+02 3.21454617e-02]
mat_Sqrt:  [[ 1.91414519e+01  0.00000000e+00]
 [-7.17166221e-03  1.64323425e-02]]
grads:  [ 2.55900200e-02 -4.42677586e+01]
Stock Position:  0.025590019973572548
Bond Position:  [8.37616032]


portfolio before change:  [11.12903332]
curr_Stock_Price:  107.53512157844813
curr_Factors:  [1.07535122e+02 3.18473289e-02]
mat_Sqrt:  [[ 1.91905242e+01  0.00000000e+00]
 [-7.13832797e-03  1.63559641e-02]]
grads:  [-1.70828752e-02  5.30445199e+01]
Stock Position:  -0.017082875207356442
Bond Position:  [12.96604238]


portfolio before change:  [11.11316278]
curr_Stock_Price:  108.5590355448946
curr_Factors:  [1.08559036e+02 3.10751660e-02]
mat_Sqrt:  [[ 1.91369492e+01  0.00000000e+00]
 [-7.05125986e-03  1.61564660e-02]]
grads:  [ 0.00417818 -0.95218209]
Stock Position:  0.004178179161709898
Bond Position:  [10.65958368]


portfolio before change:  [11.12018717]
curr_Stock_Price:  109.92131737999743
curr_Factors:  [1.09921317e+02 2.95881127e-02]
mat_Sqrt:  [[ 1.89077807e+01  0.00000000e+00]
 [-6.88047820e-03  1.57651561e-02]]
grads:  [-0.00426651 -3.18060012]
Stock Position:  -0.004266511692655604
Bond Position:  [11.58916775]


portfolio before change:  [11.11875113]
curr_Stock_Price:  110.59746018345412
curr_Factors:  [1.10597460e+02 2.96395088e-02]
mat_Sqrt:  [[ 1.90406011e+01  0.00000000e+00]
 [-6.88645148e-03  1.57788426e-02]]
grads:  [ 0.00588699 -4.15690297]
Stock Position:  0.005886993360743085
Bond Position:  [10.46766462]


portfolio before change:  [11.12215761]
curr_Stock_Price:  110.95382812438514
curr_Factors:  [1.10953828e+02 2.88387896e-02]
mat_Sqrt:  [[ 1.88421651e+01  0.00000000e+00]
 [-6.79279496e-03  1.55642485e-02]]
grads:  [-0.01009213 -8.93313658]
Stock Position:  -0.01009212935105339
Bond Position:  [12.24191799]


portfolio before change:  [11.13122373]
curr_Stock_Price:  110.207128940495
curr_Factors:  [1.10207129e+02 2.95971252e-02]
mat_Sqrt:  [[ 1.89598306e+01  0.00000000e+00]
 [-6.88152602e-03  1.57675569e-02]]
grads:  [ 0.01547382 -1.93510711]
Stock Position:  0.015473824868524172
Bond Position:  [9.42589792]


portfolio before change:  [11.14647196]
curr_Stock_Price:  111.11640090684119
curr_Factors:  [1.11116401e+02 2.77558555e-02]
mat_Sqrt:  [[ 1.85120909e+01  0.00000000e+00]
 [-6.66403547e-03  1.52692235e-02]]
grads:  [3.13490890e-02 3.23875192e+01]
Stock Position:  0.031349088954539535
Bond Position:  [7.66307402]


portfolio before change:  [11.15115515]
curr_Stock_Price:  111.23523222891608
curr_Factors:  [1.11235232e+02 2.68310886e-02]
mat_Sqrt:  [[ 1.82205513e+01  0.00000000e+00]
 [-6.55207919e-03  1.50126994e-02]]
grads:  [0.01522291 0.13907907]
Stock Position:  0.015222909963632852
Bond Position:  [9.45783123]


portfolio before change:  [11.17419222]
curr_Stock_Price:  112.67088165017056
curr_Factors:  [1.12670882e+02 2.49630555e-02]
mat_Sqrt:  [[ 1.78016625e+01  0.00000000e+00]
 [-6.31988044e-03  1.44806653e-02]]
grads:  [-1.33869682e-02 -2.08538793e+01]
Stock Position:  -0.013386968196357197
Bond Position:  [12.68251373]


portfolio before change:  [11.18244317]
curr_Stock_Price:  112.17296898697786
curr_Factors:  [1.12172969e+02 2.47639460e-02]
mat_Sqrt:  [[ 1.76521715e+01  0.00000000e+00]
 [-6.29462577e-03  1.44227995e-02]]
grads:  [ 0.00883039 -4.83099578]
Stock Position:  0.008830394996737958
Bond Position:  [10.19191155]


portfolio before change:  [11.19007138]
curr_Stock_Price:  112.89254501496575
curr_Factors:  [1.12892545e+02 2.41090113e-02]
mat_Sqrt:  [[ 1.75289121e+01  0.00000000e+00]
 [-6.21083071e-03  1.42308009e-02]]
grads:  [-0.01864296  4.97024025]
Stock Position:  -0.018642955259848572
Bond Position:  [13.29472205]


portfolio before change:  [11.18817775]
curr_Stock_Price:  113.08326473030145
curr_Factors:  [1.13083265e+02 2.41253831e-02]
mat_Sqrt:  [[ 1.75644861e+01  0.00000000e+00]
 [-6.21293916e-03  1.42356320e-02]]
grads:  [-3.27361187e-03  8.30386334e+00]
Stock Position:  -0.0032736118745604285
Bond Position:  [11.55836846]


portfolio before change:  [11.18988996]
curr_Stock_Price:  113.0016028921207
curr_Factors:  [1.13001603e+02 2.55502835e-02]
mat_Sqrt:  [[ 1.80626915e+01  0.00000000e+00]
 [-6.39378241e-03  1.46499959e-02]]
grads:  [-0.01477223 12.119268  ]
Stock Position:  -0.014772232578118388
Bond Position:  [12.85917592]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.18594919]
Stock Price:  113.37719041769185
PL:  [-2.19124122]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.34555530e-01  5.51077796e-01]
 [-2.01678431e-01 -7.58675596e-02]
 [ 8.08639871e-01 -6.83349590e-01]
 [-1.76760279e-02  2.54626217e-02]
 [-9.74036008e-02  4.23418166e-02]
 [ 6.18453618e-03  3.65606162e-02]
 [ 3.15998640e-02  2.54092354e-01]
 [ 2.81026178e-01 -2.22603733e-03]
 [ 1.18954736e-01  8.51033949e-02]
 [ 3.52251121e-01 -1.74672899e-01]
 [ 6.27673869e-02 -3.81630904e-03]
 [-1.02451839e-01 -1.82228398e-01]
 [-1.86685581e-01  1.62280004e-01]
 [-6.67494138e-01 -8.77985195e-01]
 [ 1.43439865e-03 -1.12543619e-01]
 [ 4.29300819e-02 -8.84059629e-02]
 [-5.24286242e-02  2.40190830e-01]
 [ 4.72191541e-02  1.43421784e-01]
 [ 1.47731586e-02  6.89862947e-02]
 [-9.97975628e-02 -3.71666202e-02]
 [ 1.78478466e-01  8.58570471e-02]
 [ 6.31771203e-02  3.11746671e-01]
 [ 3.63636194e-02  3.02612951e-01]
 [-7.30194508e-02  1.14475364e-01]
 [ 3.90896179e-02  9.05222768e-02]
 [ 3.80609210e-01 -5.75338524e-02]
 [-2.91739992e-02  2.25523189e-01]
 [-1.69628682e-01  1.13559333e-01]
 [-5.37627393e-02 -1.10294207e-01]
 [ 2.48543605e-02 -5.21325591e-02]
 [-6.04429116e-01 -9.34435552e-02]
 [-1.18121570e-01  7.22926818e-03]
 [ 8.16277489e-03 -9.16711814e-02]
 [ 8.61120648e-02  9.97441029e-02]
 [-7.10382868e-02  1.60062899e-01]
 [-1.08757136e+00 -1.94950302e-01]
 [-6.19998055e-02  2.51662160e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.22856876e+00 -4.54427998e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.28316847]
curr_Stock_Price:  100.68912525926137
curr_Factors:  [1.00689125e+02 4.06516742e-02]
mat_Sqrt:  [[ 2.03012036e+01  0.00000000e+00]
 [-8.06490414e-03  1.84790168e-02]]
grads:  [2.34008588e-02 2.98218136e+01]
Stock Position:  0.02340085877439023
Bond Position:  [4.92695647]


portfolio before change:  [7.30384874]
curr_Stock_Price:  101.54654537515063
curr_Factors:  [1.01546545e+02 4.04545975e-02]
mat_Sqrt:  [[ 2.04243900e+01  0.00000000e+00]
 [-8.04533132e-03  1.84341699e-02]]
grads:  [-0.01149556 -4.11559404]
Stock Position:  -0.011495557440575349
Bond Position:  [8.47118289]


portfolio before change:  [7.32389946]
curr_Stock_Price:  99.89445017333672
curr_Factors:  [9.98944502e+01 4.12789206e-02]
mat_Sqrt:  [[ 2.02957697e+01  0.00000000e+00]
 [-8.12688581e-03  1.86210347e-02]]
grads:  [ 2.51481795e-02 -3.66977239e+01]
Stock Position:  0.02514817947822225
Bond Position:  [4.8117359]


portfolio before change:  [7.33091026]
curr_Stock_Price:  100.14931109362145
curr_Factors:  [1.00149311e+02 4.10040271e-02]
mat_Sqrt:  [[ 2.02796858e+01  0.00000000e+00]
 [-8.09978045e-03  1.85589285e-02]]
grads:  [-3.23635619e-04  1.37198770e+00]
Stock Position:  -0.0003236356192191969
Bond Position:  [7.36332214]


portfolio before change:  [7.33154799]
curr_Stock_Price:  101.02294867276568
curr_Factors:  [1.01022949e+02 4.21895538e-02]
mat_Sqrt:  [[ 2.07502105e+01  0.00000000e+00]
 [-8.21603834e-03  1.88253088e-02]]
grads:  [-0.00380353  2.24919639]
Stock Position:  -0.0038035333202405762
Bond Position:  [7.71579214]


portfolio before change:  [7.32924406]
curr_Stock_Price:  101.88226994627385
curr_Factors:  [1.01882270e+02 4.14932905e-02]
mat_Sqrt:  [[ 2.07533185e+01  0.00000000e+00]
 [-8.14796077e-03  1.86693235e-02]]
grads:  [1.06686057e-03 1.95832571e+00]
Stock Position:  0.001066860572532149
Bond Position:  [7.22054989]


portfolio before change:  [7.33034106]
curr_Stock_Price:  102.0644566992376
curr_Factors:  [1.02064457e+02 4.02504894e-02]
mat_Sqrt:  [[ 2.04767067e+01  0.00000000e+00]
 [-8.02500985e-03  1.83876075e-02]]
grads:  [6.95887579e-03 1.38186740e+01]
Stock Position:  0.006958875788841636
Bond Position:  [6.62008718]


portfolio before change:  [7.33154976]
curr_Stock_Price:  102.1192271328041
curr_Factors:  [1.02119227e+02 3.96914278e-02]
mat_Sqrt:  [[ 2.03449150e+01  0.00000000e+00]
 [-7.96908304e-03  1.82594631e-02]]
grads:  [ 0.01376534 -0.12191143]
Stock Position:  0.013765339197293584
Bond Position:  [5.92584396]


portfolio before change:  [7.32582011]
curr_Stock_Price:  101.64917500676808
curr_Factors:  [1.01649175e+02 3.95302814e-02]
mat_Sqrt:  [[ 2.02101162e+01  0.00000000e+00]
 [-7.95288943e-03  1.82223589e-02]]
grads:  [0.0077237  4.67027322]
Stock Position:  0.0077237013923228464
Bond Position:  [6.54071224]


portfolio before change:  [7.32949621]
curr_Stock_Price:  102.0192644266135
curr_Factors:  [1.02019264e+02 3.93015717e-02]
mat_Sqrt:  [[ 2.02249356e+01  0.00000000e+00]
 [-7.92984961e-03  1.81695680e-02]]
grads:  [ 0.01364739 -9.61348659]
Stock Position:  0.013647391717055235
Bond Position:  [5.93719935]


portfolio before change:  [7.33846687]
curr_Stock_Price:  102.62219772758964
curr_Factors:  [1.02622198e+02 3.84472954e-02]
mat_Sqrt:  [[ 2.01221420e+01  0.00000000e+00]
 [-7.84319276e-03  1.79710123e-02]]
grads:  [ 0.00303655 -0.21235916]
Stock Position:  0.003036546170245166
Bond Position:  [7.02684983]


portfolio before change:  [7.34019305]
curr_Stock_Price:  102.90138435662928
curr_Factors:  [1.02901384e+02 3.75027530e-02]
mat_Sqrt:  [[ 1.99274988e+01  0.00000000e+00]
 [-7.74625102e-03  1.77488908e-02]]
grads:  [-9.13224652e-03 -1.02670302e+01]
Stock Position:  -0.009132246523232702
Bond Position:  [8.27991386]


portfolio before change:  [7.33605403]
curr_Stock_Price:  103.46795614052634
curr_Factors:  [1.03467956e+02 3.76609570e-02]
mat_Sqrt:  [[ 2.00794377e+01  0.00000000e+00]
 [-7.76257246e-03  1.77862879e-02]]
grads:  [-5.77012080e-03  9.12388267e+00]
Stock Position:  -0.005770120801441358
Bond Position:  [7.93307664]


portfolio before change:  [7.336044]
curr_Stock_Price:  103.64156186298038
curr_Factors:  [1.03641562e+02 3.74902595e-02]
mat_Sqrt:  [[ 2.00674954e+01  0.00000000e+00]
 [-7.74496064e-03  1.77459342e-02]]
grads:  [ -0.05235722 -49.47528744]
Stock Position:  -0.052357220974585256
Bond Position:  [12.76242816]


portfolio before change:  [7.33532337]
curr_Stock_Price:  103.68579708394172
curr_Factors:  [1.03685797e+02 3.84253202e-02]
mat_Sqrt:  [[ 2.03248813e+01  0.00000000e+00]
 [-7.84095098e-03  1.79658757e-02]]
grads:  [-2.34607340e-03 -6.26429909e+00]
Stock Position:  -0.0023460734014064876
Bond Position:  [7.57857786]


portfolio before change:  [7.33667497]
curr_Stock_Price:  103.51349923787505
curr_Factors:  [1.03513499e+02 3.94101815e-02]
mat_Sqrt:  [[ 2.05494976e+01  0.00000000e+00]
 [-7.94079910e-03  1.81946565e-02]]
grads:  [ 2.11516437e-04 -4.85889706e+00]
Stock Position:  0.00021151643695034873
Bond Position:  [7.31478017]


portfolio before change:  [7.3378096]
curr_Stock_Price:  104.55466169965055
curr_Factors:  [1.04554662e+02 4.04131747e-02]
mat_Sqrt:  [[ 2.10186532e+01  0.00000000e+00]
 [-8.04121132e-03  1.84247298e-02]]
grads:  [2.49298789e-03 1.30363285e+01]
Stock Position:  0.002492987894005311
Bond Position:  [7.0771561]


portfolio before change:  [7.33815322]
curr_Stock_Price:  104.33761911694192
curr_Factors:  [1.04337619e+02 4.09995535e-02]
mat_Sqrt:  [[ 2.11266426e+01  0.00000000e+00]
 [-8.09933859e-03  1.85579161e-02]]
grads:  [5.19787049e-03 7.72833455e+00]
Stock Position:  0.005197870494818668
Bond Position:  [6.79581979]


portfolio before change:  [7.33333886]
curr_Stock_Price:  103.24796402045254
curr_Factors:  [1.03247964e+02 4.12575311e-02]
mat_Sqrt:  [[ 2.09716748e+01  0.00000000e+00]
 [-8.12477998e-03  1.86162096e-02]]
grads:  [2.14008878e-03 3.70571110e+00]
Stock Position:  0.0021400887827886456
Bond Position:  [7.11237905]


portfolio before change:  [7.33437935]
curr_Stock_Price:  103.3187021962414
curr_Factors:  [1.03318702e+02 4.12713758e-02]
mat_Sqrt:  [[ 2.09895639e+01  0.00000000e+00]
 [-8.12614308e-03  1.86193329e-02]]
grads:  [-0.00552743 -1.99613061]
Stock Position:  -0.005527432881396799
Bond Position:  [7.90546654]


portfolio before change:  [7.34610641]
curr_Stock_Price:  101.37588100880852
curr_Factors:  [1.01375881e+02 4.22242199e-02]
mat_Sqrt:  [[ 2.08312561e+01  0.00000000e+00]
 [-8.21941311e-03  1.88330414e-02]]
grads:  [0.01036661 4.55885194]
Stock Position:  0.01036661216315384
Bond Position:  [6.29518197]


portfolio before change:  [7.33484146]
curr_Stock_Price:  100.21331248080563
curr_Factors:  [1.00213312e+02 4.42955378e-02]
mat_Sqrt:  [[ 2.10914000e+01  0.00000000e+00]
 [-8.41860205e-03  1.92894406e-02]]
grads:  [9.44624456e-03 1.61615196e+01]
Stock Position:  0.009446244558751975
Bond Position:  [6.388202]


portfolio before change:  [7.32454741]
curr_Stock_Price:  99.03902301120051
curr_Factors:  [9.90390230e+01 4.42314512e-02]
mat_Sqrt:  [[ 2.08291689e+01  0.00000000e+00]
 [-8.41250985e-03  1.92754816e-02]]
grads:  [8.08648389e-03 1.56993718e+01]
Stock Position:  0.00808648389169972
Bond Position:  [6.52366995]


portfolio before change:  [7.31687336]
curr_Stock_Price:  97.98917716812485
curr_Factors:  [9.79891772e+01 4.45242008e-02]
mat_Sqrt:  [[ 2.06764596e+01  0.00000000e+00]
 [-8.44030339e-03  1.93391646e-02]]
grads:  [-1.11519605e-03  5.91935412e+00]
Stock Position:  -0.0011151960544526578
Bond Position:  [7.4261505]


portfolio before change:  [7.31808857]
curr_Stock_Price:  97.7319281894995
curr_Factors:  [9.77319282e+01 4.45435626e-02]
mat_Sqrt:  [[ 2.06266615e+01  0.00000000e+00]
 [-8.44213836e-03  1.93433690e-02]]
grads:  [3.81044593e-03 4.67975753e+00]
Stock Position:  0.0038104459328704697
Bond Position:  [6.94568634]


portfolio before change:  [7.32152744]
curr_Stock_Price:  98.40654999090958
curr_Factors:  [9.8406550e+01 4.4998706e-02]
mat_Sqrt:  [[ 2.08748815e+01  0.00000000e+00]
 [-8.48515937e-03  1.94419426e-02]]
grads:  [ 0.01703001 -2.9592646 ]
Stock Position:  0.01703000702006515
Bond Position:  [5.64566321]


portfolio before change:  [7.31924764]
curr_Stock_Price:  98.23123837029082
curr_Factors:  [9.82312384e+01 4.48850630e-02]
mat_Sqrt:  [[ 2.08113637e+01  0.00000000e+00]
 [-8.47443808e-03  1.94173770e-02]]
grads:  [3.32762384e-03 1.16145033e+01]
Stock Position:  0.003327623841144754
Bond Position:  [6.99237103]


portfolio before change:  [7.31194659]
curr_Stock_Price:  95.77448502055198
curr_Factors:  [9.57744850e+01 4.47847731e-02]
mat_Sqrt:  [[ 2.02681922e+01  0.00000000e+00]
 [-8.46496526e-03  1.93956720e-02]]
grads:  [-0.00592393  5.85488006]
Stock Position:  -0.005923928713821174
Bond Position:  [7.87930781]


portfolio before change:  [7.29603706]
curr_Stock_Price:  98.62639340676455
curr_Factors:  [9.86263934e+01 4.26582289e-02]
mat_Sqrt:  [[ 2.03701657e+01  0.00000000e+00]
 [-8.26154745e-03  1.89295833e-02]]
grads:  [-5.00236860e-03 -5.82655228e+00]
Stock Position:  -0.00500236860299457
Bond Position:  [7.78940263]


portfolio before change:  [7.2926715]
curr_Stock_Price:  99.49384209772617
curr_Factors:  [9.94938421e+01 4.16737924e-02]
mat_Sqrt:  [[ 2.03108320e+01  0.00000000e+00]
 [-8.16566395e-03  1.87098866e-02]]
grads:  [ 1.03484014e-04 -2.78636425e+00]
Stock Position:  0.00010348401409088535
Bond Position:  [7.28237548]


portfolio before change:  [7.29369369]
curr_Stock_Price:  100.57458479001093
curr_Factors:  [1.00574585e+02 4.01867411e-02]
mat_Sqrt:  [[ 2.01618158e+01  0.00000000e+00]
 [-8.01865237e-03  1.83730407e-02]]
grads:  [-0.03200164 -5.08590584]
Stock Position:  -0.032001642777268136
Bond Position:  [10.51224563]


portfolio before change:  [7.33896856]
curr_Stock_Price:  99.20088155096288
curr_Factors:  [9.92008816e+01 4.01658404e-02]
mat_Sqrt:  [[ 1.98812626e+01  0.00000000e+00]
 [-8.01656689e-03  1.83682623e-02]]
grads:  [-0.00578265  0.39357388]
Stock Position:  -0.005782653803616769
Bond Position:  [7.91261292]


portfolio before change:  [7.34296021]
curr_Stock_Price:  98.68165561069631
curr_Factors:  [9.86816556e+01 3.89663319e-02]
mat_Sqrt:  [[ 1.94796518e+01  0.00000000e+00]
 [-7.89595663e-03  1.80919095e-02]]
grads:  [-1.63482433e-03 -5.06697105e+00]
Stock Position:  -0.0016348243297778441
Bond Position:  [7.50428738]


portfolio before change:  [7.34448584]
curr_Stock_Price:  98.32226758785652
curr_Factors:  [9.83222676e+01 3.87600147e-02]
mat_Sqrt:  [[ 1.93572586e+01  0.00000000e+00]
 [-7.87502530e-03  1.80439498e-02]]
grads:  [0.00669743 5.52784197]
Stock Position:  0.006697433906972431
Bond Position:  [6.68597895]


portfolio before change:  [7.33472905]
curr_Stock_Price:  96.74067889617876
curr_Factors:  [9.67406789e+01 3.98229236e-02]
mat_Sqrt:  [[ 1.93052621e+01  0.00000000e+00]
 [-7.98227272e-03  1.82896845e-02]]
grads:  [-6.11807496e-05  8.75153967e+00]
Stock Position:  -6.118074964792842e-05
Bond Position:  [7.34064772]


portfolio before change:  [7.335666]
curr_Stock_Price:  96.42498825632373
curr_Factors:  [9.64249883e+01 4.06026769e-02]
mat_Sqrt:  [[ 1.94297373e+01  0.00000000e+00]
 [-8.06004238e-03  1.84678771e-02]]
grads:  [ -0.0603536  -10.55618359]
Stock Position:  -0.060353602813953425
Bond Position:  [13.15526145]


portfolio before change:  [7.41523035]
curr_Stock_Price:  95.13393304516339
curr_Factors:  [9.51339330e+01 4.07612449e-02]
mat_Sqrt:  [[ 1.92069839e+01  0.00000000e+00]
 [-8.07576571e-03  1.85039038e-02]]
grads:  [2.49047773e-03 1.36004900e+01]
Stock Position:  0.0024904777314373695
Bond Position:  [7.17830141]


portfolio before change:  [7.41391804]
curr_Stock_Price:  94.24669492789083
curr_Factors:  [9.42466949e+01 4.08009808e-02]
mat_Sqrt:  [[ 1.90371280e+01  0.00000000e+00]
 [-8.07970106e-03  1.85129209e-02]]
grads:  [-4.63227516e-03  5.90732091e+00]
Stock Position:  -0.004632275163707266
Bond Position:  [7.85049467]


portfolio before change:  [7.41903302]
curr_Stock_Price:  93.3543478567481
curr_Factors:  [9.33543479e+01 4.13329154e-02]
mat_Sqrt:  [[ 1.89794039e+01  0.00000000e+00]
 [-8.13219925e-03  1.86332093e-02]]
grads:  [ 0.06368672 -2.43880692]
Stock Position:  0.06368671509647657
Bond Position:  [1.47360126]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.4298764]
Stock Price:  93.52171676026703
PL:  [7.4298764]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.78559975e-01  8.90492748e-01]
 [-2.72830985e-01 -5.78398091e-02]
 [ 8.92175490e-01 -7.76682473e-01]
 [-1.37649541e-01 -2.52250082e-02]
 [-1.68335014e-01  7.07292677e-02]
 [ 7.09024223e-02  8.71882636e-02]
 [ 9.17941780e-03  3.09222410e-01]
 [ 2.45400433e-01 -2.10024333e-03]
 [ 1.47064677e-01  7.61635344e-02]
 [ 1.62510718e-01  3.11983024e-03]
 [ 1.09087501e-01  1.59387336e-01]
 [ 1.76286543e-01  2.58309880e-01]
 [ 1.79782352e-01  2.76719060e-02]
 [-1.41958676e-01 -1.49263891e-01]
 [ 8.92191872e-02  2.32672600e-01]
 [ 5.12373505e-02 -1.37821850e-02]
 [ 1.96730706e-02 -6.36272624e-02]
 [ 3.99757145e-02  5.68291227e-02]
 [ 1.59371351e-02  4.00845804e-02]
 [ 2.55442860e-01 -1.09881942e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 7.78959059e-02  2.79394610e-01]
 [ 2.76893922e-02  1.56637863e-01]
 [-7.88233544e-02  9.23448771e-02]
 [ 5.75261130e-02  1.37757158e-01]
 [ 5.55996954e-02  8.96309240e-02]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.68626864e-01  1.11762955e-01]
 [-2.42771215e-01 -1.53443904e-02]
 [ 1.26091913e-01 -7.57933446e-02]
 [-9.96534020e-01 -1.12923140e-01]
 [-2.97876723e-02  1.79760709e-01]
 [-8.78244755e-03 -1.20560860e-01]
 [ 4.07752501e-02  8.37071454e-02]
 [-7.16915398e-02  1.59986547e-01]
 [-1.20546035e+00 -1.70711271e-01]
 [-2.94837741e-02  2.94367584e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 6.87381350e-01  2.32644452e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.39126926]
curr_Stock_Price:  101.75972028532851
curr_Factors:  [1.01759720e+02 4.08109545e-02]
mat_Sqrt:  [[ 2.05572151e+01  0.00000000e+00]
 [-8.08068853e-03  1.85151834e-02]]
grads:  [4.21848421e-02 4.80952701e+01]
Stock Position:  0.04218484206411321
Bond Position:  [10.09855153]


portfolio before change:  [14.42075472]
curr_Stock_Price:  102.4287535793951
curr_Factors:  [1.02428754e+02 3.95864227e-02]
mat_Sqrt:  [[ 2.03795700e+01  0.00000000e+00]
 [-7.95853481e-03  1.82352941e-02]]
grads:  [-0.01462614 -3.17186051]
Stock Position:  -0.01462613524583122
Bond Position:  [15.91889152]


portfolio before change:  [14.41569209]
curr_Stock_Price:  102.91094582338562
curr_Factors:  [1.02910946e+02 3.92652296e-02]
mat_Sqrt:  [[ 2.03922732e+01  0.00000000e+00]
 [-7.92618240e-03  1.81611654e-02]]
grads:  [ 2.71280923e-02 -4.27661141e+01]
Stock Position:  0.02712809228266487
Bond Position:  [11.62391446]


portfolio before change:  [14.42545266]
curr_Stock_Price:  103.2171778025055
curr_Factors:  [1.03217178e+02 3.86910041e-02]
mat_Sqrt:  [[ 2.03028488e+01  0.00000000e+00]
 [-7.86801160e-03  1.80278794e-02]]
grads:  [-0.00732206 -1.39922216]
Stock Position:  -0.007322058014087474
Bond Position:  [15.18121483]


portfolio before change:  [14.42814746]
curr_Stock_Price:  103.10832522698517
curr_Factors:  [1.03108325e+02 3.73011464e-02]
mat_Sqrt:  [[ 1.99138313e+01  0.00000000e+00]
 [-7.72540189e-03  1.77011195e-02]]
grads:  [-0.00690305  3.99575111]
Stock Position:  -0.006903052925870305
Bond Position:  [15.13990968]


portfolio before change:  [14.43449638]
curr_Stock_Price:  102.46276878973607
curr_Factors:  [1.02462769e+02 3.94500186e-02]
mat_Sqrt:  [[ 2.03511846e+01  0.00000000e+00]
 [-7.94481150e-03  1.82038500e-02]]
grads:  [0.00535372 4.78955075]
Stock Position:  0.005353717851003462
Bond Position:  [13.88593962]


portfolio before change:  [14.43010393]
curr_Stock_Price:  101.31808823902203
curr_Factors:  [1.01318088e+02 4.15470086e-02]
mat_Sqrt:  [[ 2.06517504e+01  0.00000000e+00]
 [-8.15323333e-03  1.86814045e-02]]
grads:  [6.97931841e-03 1.65524177e+01]
Stock Position:  0.00697931841117591
Bond Position:  [13.72297273]


portfolio before change:  [14.43299428]
curr_Stock_Price:  101.48642402245741
curr_Factors:  [1.01486424e+02 4.11854139e-02]
mat_Sqrt:  [[ 2.05958475e+01  0.00000000e+00]
 [-8.11767592e-03  1.85999322e-02]]
grads:  [ 0.01187054 -0.11291672]
Stock Position:  0.011870539034929635
Bond Position:  [13.22829572]


portfolio before change:  [14.42120647]
curr_Stock_Price:  100.35408688995105
curr_Factors:  [1.00354087e+02 4.14577055e-02]
mat_Sqrt:  [[ 2.04332616e+01  0.00000000e+00]
 [-8.14446615e-03  1.86613163e-02]]
grads:  [0.0088241  4.08135917]
Stock Position:  0.008824101206872022
Bond Position:  [13.53567185]


portfolio before change:  [14.4070212]
curr_Stock_Price:  98.55477322719254
curr_Factors:  [9.85547732e+01 4.28529042e-02]
mat_Sqrt:  [[ 2.04017675e+01  0.00000000e+00]
 [-8.28037721e-03  1.89727277e-02]]
grads:  [0.00803226 0.16443762]
Stock Position:  0.008032261138503177
Bond Position:  [13.61540353]


portfolio before change:  [14.41336759]
curr_Stock_Price:  99.13298527603254
curr_Factors:  [9.91329853e+01 4.16943778e-02]
mat_Sqrt:  [[ 2.02421637e+01  0.00000000e+00]
 [-8.16768049e-03  1.87145070e-02]]
grads:  [0.00882563 8.5167798 ]
Stock Position:  0.008825629501416733
Bond Position:  [13.53845659]


portfolio before change:  [14.39255352]
curr_Stock_Price:  96.58285750770156
curr_Factors:  [9.65828575e+01 4.33099107e-02]
mat_Sqrt:  [[ 2.00998906e+01  0.00000000e+00]
 [-8.32441332e-03  1.90736271e-02]]
grads:  [ 0.01437929 13.54277709]
Stock Position:  0.014379293027805475
Bond Position:  [13.00376031]


portfolio before change:  [14.40675049]
curr_Stock_Price:  97.45712898324528
curr_Factors:  [9.74571290e+01 4.18765393e-02]
mat_Sqrt:  [[ 1.99433911e+01  0.00000000e+00]
 [-8.18550322e-03  1.87553441e-02]]
grads:  [0.0096202  1.47541447]
Stock Position:  0.009620197566876524
Bond Position:  [13.46919366]


portfolio before change:  [14.40104793]
curr_Stock_Price:  96.68933665195934
curr_Factors:  [9.66893367e+01 4.04778356e-02]
mat_Sqrt:  [[ 1.94530284e+01  0.00000000e+00]
 [-8.04764170e-03  1.84394636e-02]]
grads:  [-0.0106463  -8.09480657]
Stock Position:  -0.010646300125251397
Bond Position:  [15.43043163]


portfolio before change:  [14.39559437]
curr_Stock_Price:  97.38276866545542
curr_Factors:  [9.73827687e+01 4.16371837e-02]
mat_Sqrt:  [[ 1.98711404e+01  0.00000000e+00]
 [-8.16207657e-03  1.87016668e-02]]
grads:  [9.60014531e-03 1.24412761e+01]
Stock Position:  0.009600145311926291
Bond Position:  [13.46070564]


portfolio before change:  [14.4031613]
curr_Stock_Price:  97.99570047250462
curr_Factors:  [9.79957005e+01 4.28694916e-02]
mat_Sqrt:  [[ 2.02899599e+01  0.00000000e+00]
 [-8.28197963e-03  1.89763993e-02]]
grads:  [ 0.0022288 -0.7262803]
Stock Position:  0.00222880242712759
Bond Position:  [14.18474825]


portfolio before change:  [14.40373384]
curr_Stock_Price:  97.45699431512901
curr_Factors:  [9.74569943e+01 4.41681612e-02]
mat_Sqrt:  [[ 2.04817789e+01  0.00000000e+00]
 [-8.40648904e-03  1.92616862e-02]]
grads:  [-3.95285163e-04 -3.30330698e+00]
Stock Position:  -0.0003952851632235271
Bond Position:  [14.44225714]


portfolio before change:  [14.40558528]
curr_Stock_Price:  97.34050338656702
curr_Factors:  [9.73405034e+01 4.47851960e-02]
mat_Sqrt:  [[ 2.05996968e+01  0.00000000e+00]
 [-8.46500523e-03  1.93957636e-02]]
grads:  [0.00314461 2.92997604]
Stock Position:  0.0031446082803996676
Bond Position:  [14.09948753]


portfolio before change:  [14.40726312]
curr_Stock_Price:  97.31356536162224
curr_Factors:  [9.73135654e+01 4.52000748e-02]
mat_Sqrt:  [[ 2.06891649e+01  0.00000000e+00]
 [-8.50412369e-03  1.94853953e-02]]
grads:  [1.61589317e-03 2.05716024e+00]
Stock Position:  0.0016158931710594068
Bond Position:  [14.25001479]


portfolio before change:  [14.40661309]
curr_Stock_Price:  95.80889178900854
curr_Factors:  [9.58088918e+01 4.49283007e-02]
mat_Sqrt:  [[ 2.03079373e+01  0.00000000e+00]
 [-8.47851881e-03  1.94267271e-02]]
grads:  [ 0.01021701 -5.65622514]
Stock Position:  0.010217012490478308
Bond Position:  [13.42773244]


portfolio before change:  [14.4261053]
curr_Stock_Price:  97.55241889843381
curr_Factors:  [9.75524189e+01 4.38120405e-02]
mat_Sqrt:  [[ 2.04190148e+01  0.00000000e+00]
 [-8.37253037e-03  1.91838771e-02]]
grads:  [ 0.0020632  -1.96925728]
Stock Position:  0.0020632048665332825
Bond Position:  [14.22483467]


portfolio before change:  [14.4293524]
curr_Stock_Price:  98.26436616213913
curr_Factors:  [9.82643662e+01 4.31206409e-02]
mat_Sqrt:  [[ 2.04050969e+01  0.00000000e+00]
 [-8.30620403e-03  1.90319044e-02]]
grads:  [9.79332330e-03 1.46803286e+01]
Stock Position:  0.009793323303851879
Bond Position:  [13.4670177]


portfolio before change:  [14.41370087]
curr_Stock_Price:  96.49428044160392
curr_Factors:  [9.64942804e+01 4.45294073e-02]
mat_Sqrt:  [[ 2.03622155e+01  0.00000000e+00]
 [-8.44079686e-03  1.93402953e-02]]
grads:  [4.71715664e-03 8.09904195e+00]
Stock Position:  0.004717156642264435
Bond Position:  [13.95852223]


portfolio before change:  [14.41557212]
curr_Stock_Price:  96.52106091704346
curr_Factors:  [9.65210609e+01 4.39800476e-02]
mat_Sqrt:  [[ 2.02418375e+01  0.00000000e+00]
 [-8.38856818e-03  1.92206243e-02]]
grads:  [-1.90302614e-03  4.80446813e+00]
Stock Position:  -0.0019030261407835699
Bond Position:  [14.59925422]


portfolio before change:  [14.41911362]
curr_Stock_Price:  95.61908474109187
curr_Factors:  [9.56190847e+01 4.21381754e-02]
mat_Sqrt:  [[ 1.96282891e+01  0.00000000e+00]
 [-8.21103408e-03  1.88138426e-02]]
grads:  [5.99381155e-03 7.32211707e+00]
Stock Position:  0.005993811546951444
Bond Position:  [13.84599085]


portfolio before change:  [14.42466065]
curr_Stock_Price:  96.25577016429533
curr_Factors:  [9.62557702e+01 3.94589503e-02]
mat_Sqrt:  [[ 1.91205129e+01  0.00000000e+00]
 [-7.94571082e-03  1.82059106e-02]]
grads:  [0.00495373 4.92317719]
Stock Position:  0.004953728927483398
Bond Position:  [13.94783566]


portfolio before change:  [14.42688589]
curr_Stock_Price:  96.3529996265938
curr_Factors:  [9.63529996e+01 3.90403842e-02]
mat_Sqrt:  [[ 1.90380420e+01  0.00000000e+00]
 [-7.90345587e-03  1.81090924e-02]]
grads:  [9.35818926e-03 9.66019669e+00]
Stock Position:  0.00935818926023436
Bond Position:  [13.52519628]


portfolio before change:  [14.4215767]
curr_Stock_Price:  95.604997294461
curr_Factors:  [9.56049973e+01 3.93332063e-02]
mat_Sqrt:  [[ 1.89609577e+01  0.00000000e+00]
 [-7.93304040e-03  1.81768791e-02]]
grads:  [-0.00632086  6.14863282]
Stock Position:  -0.006320857475609156
Bond Position:  [15.02588226]


portfolio before change:  [14.42292538]
curr_Stock_Price:  95.68879363760985
curr_Factors:  [9.56887936e+01 3.69783382e-02]
mat_Sqrt:  [[ 1.84007182e+01  0.00000000e+00]
 [-7.69190101e-03  1.76243593e-02]]
grads:  [-0.01355752 -0.87063536]
Stock Position:  -0.013557517348873779
Bond Position:  [15.72022786]


portfolio before change:  [14.41010126]
curr_Stock_Price:  96.77964760347791
curr_Factors:  [9.67796476e+01 3.79812478e-02]
mat_Sqrt:  [[ 1.88611709e+01  0.00000000e+00]
 [-7.79551130e-03  1.78617603e-02]]
grads:  [ 0.00493145 -4.24333007]
Stock Position:  0.004931453406861623
Bond Position:  [13.93283694]


portfolio before change:  [14.41108779]
curr_Stock_Price:  96.6265097581682
curr_Factors:  [9.66265098e+01 3.86579826e-02]
mat_Sqrt:  [[ 1.89983501e+01  0.00000000e+00]
 [-7.86465334e-03  1.80201846e-02]]
grads:  [-0.05504782 -6.26648077]
Stock Position:  -0.05504781813431713
Bond Position:  [19.73016632]


portfolio before change:  [14.48460389]
curr_Stock_Price:  95.33581950507975
curr_Factors:  [9.53358195e+01 3.82899693e-02]
mat_Sqrt:  [[ 1.86551443e+01  0.00000000e+00]
 [-7.82712916e-03  1.79342059e-02]]
grads:  [2.60873528e-03 1.00233437e+01]
Stock Position:  0.002608735276515965
Bond Position:  [14.23589798]


portfolio before change:  [14.48754836]
curr_Stock_Price:  95.78234451571777
curr_Factors:  [9.57823445e+01 3.86348941e-02]
mat_Sqrt:  [[ 1.88267487e+01  0.00000000e+00]
 [-7.86230441e-03  1.80148025e-02]]
grads:  [-3.26129176e-03 -6.69232204e+00]
Stock Position:  -0.0032612917642770582
Bond Position:  [14.79992253]


portfolio before change:  [14.49043873]
curr_Stock_Price:  95.46337154618979
curr_Factors:  [9.54633715e+01 3.94631150e-02]
mat_Sqrt:  [[ 1.89641093e+01  0.00000000e+00]
 [-7.94613013e-03  1.82068714e-02]]
grads:  [4.07654492e-03 4.59755790e+00]
Stock Position:  0.004076544915169363
Bond Position:  [14.101278]


portfolio before change:  [14.4976411]
curr_Stock_Price:  96.79773819348831
curr_Factors:  [9.67977382e+01 4.03397619e-02]
mat_Sqrt:  [[ 1.94415942e+01  0.00000000e+00]
 [-8.03390435e-03  1.84079874e-02]]
grads:  [-9.60665216e-05  8.69114822e+00]
Stock Position:  -9.60665215872808e-05
Bond Position:  [14.50694012]


portfolio before change:  [14.49954125]
curr_Stock_Price:  95.89555856840839
curr_Factors:  [9.58955586e+01 4.21218904e-02]
mat_Sqrt:  [[ 1.96812383e+01  0.00000000e+00]
 [-8.20944728e-03  1.88102068e-02]]
grads:  [-0.06503477 -9.07545956]
Stock Position:  -0.06503477258094895
Bond Position:  [20.7360871]


portfolio before change:  [14.42836023]
curr_Stock_Price:  97.02992392336394
curr_Factors:  [9.70299239e+01 4.06129336e-02]
mat_Sqrt:  [[ 1.95541018e+01  0.00000000e+00]
 [-8.06106034e-03  1.84702096e-02]]
grads:  [5.06230218e-03 1.59374252e+01]
Stock Position:  0.005062302176222666
Bond Position:  [13.93716544]


portfolio before change:  [14.43100176]
curr_Stock_Price:  97.20756512751753
curr_Factors:  [9.72075651e+01 4.20536420e-02]
mat_Sqrt:  [[ 1.99343405e+01  0.00000000e+00]
 [-8.20279386e-03  1.87949619e-02]]
grads:  [-4.42378395e-03  5.81867444e+00]
Stock Position:  -0.004423783946529354
Bond Position:  [14.86102703]


portfolio before change:  [14.42985982]
curr_Stock_Price:  97.8856466762095
curr_Factors:  [9.78856467e+01 4.14137770e-02]
mat_Sqrt:  [[ 1.99200963e+01  0.00000000e+00]
 [-8.14015007e-03  1.86514269e-02]]
grads:  [0.03501664 1.2473279 ]
Stock Position:  0.03501663718411664
Bond Position:  [11.00223364]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.41047147]
Stock Price:  97.29267951054102
PL:  [14.41047147]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.32551680e-01  5.48175855e-01]
 [-1.67196487e-01 -8.52723758e-02]
 [ 8.23694420e-01 -7.09505225e-01]
 [-3.95584265e-02  1.10706756e-01]
 [ 3.64154062e-02 -4.65630526e-02]
 [-7.98206452e-02 -1.05719804e-01]
 [-1.27235979e-01  8.82510930e-02]
 [ 2.22263616e-01 -1.81818063e-01]
 [ 1.63348531e-01  1.76201228e-01]
 [-2.01438851e-01  5.12163713e-01]
 [ 2.52120815e-01  8.06788509e-01]
 [-6.82242163e-03  4.50409561e-01]
 [ 5.77611376e-01  2.87899025e-02]
 [-8.40603821e-02  1.54987086e-01]
 [ 1.00327469e-01  2.63185347e-01]
 [ 1.85242516e-02  4.19712504e-01]
 [ 2.91172170e-01  7.94804907e-01]
 [ 1.77392134e-01  3.49268018e-02]
 [ 8.74954042e-02 -1.85312102e-01]
 [ 5.93120523e-01 -1.40275000e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.32223922e-02  4.12997995e-02]
 [-6.64406773e-02 -8.13169379e-02]
 [-2.06596068e-03 -5.54261162e-02]
 [ 3.49984401e-02  1.74927612e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.53205701e-01  7.68570492e-02]
 [-3.99151646e-01  6.29248145e-02]
 [ 2.32802872e-01 -1.00278909e-01]
 [-1.20143066e+00 -1.35347682e-01]
 [ 1.89919787e-01  4.26709955e-01]
 [ 1.18602157e-02 -1.34958780e-01]
 [ 2.16115229e-03  5.03064949e-02]
 [-2.16850864e-02  1.69405054e-01]
 [-1.48076418e+00 -1.14784289e-01]
 [-9.00940783e-02  2.06793008e-01]
 [-1.35120898e-01 -8.73392154e-03]
 [ 1.55251124e+00 -8.75437098e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.23455137]
curr_Stock_Price:  100.68180273733458
curr_Factors:  [1.00681803e+02 3.92818390e-02]
mat_Sqrt:  [[ 1.99547774e+01  0.00000000e+00]
 [-7.92785862e-03  1.81650061e-02]]
grads:  [2.36432222e-02 3.01775761e+01]
Stock Position:  0.023643222187427267
Bond Position:  [4.85410914]


portfolio before change:  [7.22127801]
curr_Stock_Price:  100.09473541547945
curr_Factors:  [1.00094735e+02 3.98448800e-02]
mat_Sqrt:  [[ 1.99800926e+01  0.00000000e+00]
 [-7.98447293e-03  1.82947258e-02]]
grads:  [-0.0102308  -4.66103602]
Stock Position:  -0.01023080358938442
Bond Position:  [8.24532759]


portfolio before change:  [7.22928321]
curr_Stock_Price:  99.41302282186369
curr_Factors:  [9.94130228e+01 3.98498893e-02]
mat_Sqrt:  [[ 1.98452621e+01  0.00000000e+00]
 [-7.98497482e-03  1.82958758e-02]]
grads:  [ 2.59024523e-02 -3.87795170e+01]
Stock Position:  0.025902452261794936
Bond Position:  [4.65424213]


portfolio before change:  [7.21235318]
curr_Stock_Price:  98.73695388764529
curr_Factors:  [9.87369539e+01 4.13975388e-02]
mat_Sqrt:  [[ 2.00894009e+01  0.00000000e+00]
 [-8.13855406e-03  1.86477700e-02]]
grads:  [4.35949442e-04 5.93672896e+00]
Stock Position:  0.00043594944181855444
Bond Position:  [7.16930886]


portfolio before change:  [7.21301153]
curr_Stock_Price:  98.19133021749171
curr_Factors:  [9.81913302e+01 4.04216484e-02]
mat_Sqrt:  [[ 1.97415002e+01  0.00000000e+00]
 [-8.04205430e-03  1.84266613e-02]]
grads:  [ 8.15217883e-04 -2.52693919e+00]
Stock Position:  0.0008152178829191038
Bond Position:  [7.13296421]


portfolio before change:  [7.21321568]
curr_Stock_Price:  97.34795747712751
curr_Factors:  [9.73479575e+01 3.97286508e-02]
mat_Sqrt:  [[ 1.94034409e+01  0.00000000e+00]
 [-7.97281891e-03  1.82680231e-02]]
grads:  [-0.00649166 -5.7871508 ]
Stock Position:  -0.0064916604798946195
Bond Position:  [7.84516557]


portfolio before change:  [7.21994433]
curr_Stock_Price:  96.46252282072646
curr_Factors:  [9.64625228e+01 3.97723806e-02]
mat_Sqrt:  [[ 1.92375344e+01  0.00000000e+00]
 [-7.97720559e-03  1.82780742e-02]]
grads:  [-4.61181991e-03  4.82824897e+00]
Stock Position:  -0.004611819909527503
Bond Position:  [7.66481211]


portfolio before change:  [7.23002508]
curr_Stock_Price:  94.48443301792523
curr_Factors:  [9.44844330e+01 3.94954549e-02]
mat_Sqrt:  [[ 1.87773293e+01  0.00000000e+00]
 [-7.94938538e-03  1.82143301e-02]]
grads:  [ 7.61086446e-03 -9.98214385e+00]
Stock Position:  0.007610864457281891
Bond Position:  [6.51091687]


portfolio before change:  [7.22245899]
curr_Stock_Price:  93.38337399741305
curr_Factors:  [9.33833740e+01 4.00918918e-02]
mat_Sqrt:  [[ 1.86981154e+01  0.00000000e+00]
 [-8.00918391e-03  1.83513458e-02]]
grads:  [0.01284884 9.60154262]
Stock Position:  0.012848837803434215
Bond Position:  [6.02259116]


portfolio before change:  [7.20981965]
curr_Stock_Price:  92.34108467784223
curr_Factors:  [9.23410847e+01 4.10123061e-02]
mat_Sqrt:  [[ 1.87004504e+01  0.00000000e+00]
 [-8.10059811e-03  1.85608020e-02]]
grads:  [1.18113300e-03 2.75938352e+01]
Stock Position:  0.0011811330008287177
Bond Position:  [7.10075255]


portfolio before change:  [7.20918291]
curr_Stock_Price:  91.05047068286306
curr_Factors:  [9.10504707e+01 4.13843258e-02]
mat_Sqrt:  [[ 1.85225228e+01  0.00000000e+00]
 [-8.13725514e-03  1.86447938e-02]]
grads:  [3.26214844e-02 4.32715168e+01]
Stock Position:  0.03262148440594341
Bond Position:  [4.2389814]


portfolio before change:  [7.15387603]
curr_Stock_Price:  89.33881367188663
curr_Factors:  [8.93388137e+01 4.21091912e-02]
mat_Sqrt:  [[ 1.83327928e+01  0.00000000e+00]
 [-8.20820966e-03  1.88073710e-02]]
grads:  [1.03504375e-02 2.39485657e+01]
Stock Position:  0.010350437503317461
Bond Position:  [6.22918022]


portfolio before change:  [7.1533342]
curr_Stock_Price:  89.2112324233664
curr_Factors:  [8.92112324e+01 4.26158772e-02]
mat_Sqrt:  [[ 1.84164219e+01  0.00000000e+00]
 [-8.25744534e-03  1.89201842e-02]]
grads:  [0.0320462  1.52165023]
Stock Position:  0.032046198969334194
Bond Position:  [4.2944533]


portfolio before change:  [7.16752945]
curr_Stock_Price:  89.63744242527552
curr_Factors:  [8.96374424e+01 4.19994862e-02]
mat_Sqrt:  [[ 1.83700968e+01  0.00000000e+00]
 [-8.19751047e-03  1.87828561e-02]]
grads:  [-8.93760798e-04  8.25151856e+00]
Stock Position:  -0.0008937607976871815
Bond Position:  [7.24764388]


portfolio before change:  [7.17003177]
curr_Stock_Price:  87.85139038758474
curr_Factors:  [8.78513904e+01 4.19894396e-02]
mat_Sqrt:  [[ 1.80019138e+01  0.00000000e+00]
 [-8.19652996e-03  1.87806095e-02]]
grads:  [1.19537830e-02 1.40136744e+01]
Stock Position:  0.01195378300399751
Bond Position:  [6.11987531]


portfolio before change:  [7.19179947]
curr_Stock_Price:  89.60837976166324
curr_Factors:  [8.96083798e+01 4.08497130e-02]
mat_Sqrt:  [[ 1.81110292e+01  0.00000000e+00]
 [-8.08452478e-03  1.85239734e-02]]
grads:  [1.11369599e-02 2.26578011e+01]
Stock Position:  0.011136959914021227
Bond Position:  [6.19383454]


portfolio before change:  [7.19816647]
curr_Stock_Price:  90.11055682171373
curr_Factors:  [9.01105568e+01 4.10377159e-02]
mat_Sqrt:  [[ 1.82543874e+01  0.00000000e+00]
 [-8.10310714e-03  1.85665509e-02]]
grads:  [3.49534309e-02 4.28084306e+01]
Stock Position:  0.034953430923807226
Bond Position:  [4.04849335]


portfolio before change:  [7.18013832]
curr_Stock_Price:  89.58030131585042
curr_Factors:  [8.95803013e+01 4.25851318e-02]
mat_Sqrt:  [[ 1.84859390e+01  0.00000000e+00]
 [-8.25446612e-03  1.89133579e-02]]
grads:  [0.01042065 1.84667376]
Stock Position:  0.010420646732369851
Bond Position:  [6.24665364]


portfolio before change:  [7.19485391]
curr_Stock_Price:  90.91752290251468
curr_Factors:  [9.09175229e+01 4.16347940e-02]
mat_Sqrt:  [[ 1.85513622e+01  0.00000000e+00]
 [-8.16184234e-03  1.87011302e-02]]
grads:  [ 3.56770149e-04 -9.90913921e+00]
Stock Position:  0.00035677014885739604
Bond Position:  [7.16241725]


portfolio before change:  [7.19574311]
curr_Stock_Price:  90.90026217024179
curr_Factors:  [9.09002622e+01 4.29132368e-02]
mat_Sqrt:  [[ 1.88304532e+01  0.00000000e+00]
 [-8.28620413e-03  1.89860788e-02]]
grads:  [ 0.02824677 -7.38830808]
Stock Position:  0.02824677071049692
Bond Position:  [4.62810425]


portfolio before change:  [7.18903993]
curr_Stock_Price:  90.64247239417104
curr_Factors:  [9.06424724e+01 4.35298649e-02]
mat_Sqrt:  [[ 1.89114750e+01  0.00000000e+00]
 [-8.34552478e-03  1.91219995e-02]]
grads:  [ 0.00222767 -1.97562967]
Stock Position:  0.0022276745017257506
Bond Position:  [6.98711801]


portfolio before change:  [7.19453558]
curr_Stock_Price:  92.7173710571885
curr_Factors:  [9.27173711e+01 4.17367118e-02]
mat_Sqrt:  [[ 1.89417554e+01  0.00000000e+00]
 [-8.17182592e-03  1.87240054e-02]]
grads:  [-2.74403394e-04  2.20571392e+00]
Stock Position:  -0.00027440339431700314
Bond Position:  [7.21997754]


portfolio before change:  [7.19559546]
curr_Stock_Price:  92.1440308297834
curr_Factors:  [9.21440308e+01 4.20838330e-02]
mat_Sqrt:  [[ 1.89027439e+01  0.00000000e+00]
 [-8.20573780e-03  1.88017073e-02]]
grads:  [-0.00539235 -4.32497627]
Stock Position:  -0.005392354623776223
Bond Position:  [7.69246875]


portfolio before change:  [7.18635697]
curr_Stock_Price:  94.03561751708975
curr_Factors:  [9.40356175e+01 4.14718773e-02]
mat_Sqrt:  [[ 1.91500198e+01  0.00000000e+00]
 [-8.14585807e-03  1.86645056e-02]]
grads:  [-1.37106390e-03 -2.96960002e+00]
Stock Position:  -0.0013710639049868622
Bond Position:  [7.31528581]


portfolio before change:  [7.18949186]
curr_Stock_Price:  92.41612767292027
curr_Factors:  [9.24161277e+01 4.23165282e-02]
mat_Sqrt:  [[ 1.90109046e+01  0.00000000e+00]
 [-8.22839262e-03  1.88536160e-02]]
grads:  [5.85680226e-03 9.27819955e+00]
Stock Position:  0.005856802261412718
Bond Position:  [6.64822887]


portfolio before change:  [7.19133357]
curr_Stock_Price:  92.58868455136046
curr_Factors:  [9.25886846e+01 4.12906069e-02]
mat_Sqrt:  [[ 1.88141043e+01  0.00000000e+00]
 [-8.12803611e-03  1.86236704e-02]]
grads:  [6.66971112e-03 9.77618892e+00]
Stock Position:  0.0066697111249451576
Bond Position:  [6.57379379]


portfolio before change:  [7.19719942]
curr_Stock_Price:  93.34494951271004
curr_Factors:  [9.33449495e+01 4.04267815e-02]
mat_Sqrt:  [[ 1.87683204e+01  0.00000000e+00]
 [-8.04256492e-03  1.84278313e-02]]
grads:  [9.49267684e-03 9.49310811e+00]
Stock Position:  0.009492676837569427
Bond Position:  [6.31110598]


portfolio before change:  [7.18811556]
curr_Stock_Price:  92.30490670785466
curr_Factors:  [9.23049067e+01 3.86566649e-02]
mat_Sqrt:  [[ 1.81483430e+01  0.00000000e+00]
 [-7.86451930e-03  1.80198775e-02]]
grads:  [-0.00659358  4.26512607]
Stock Position:  -0.006593579099786492
Bond Position:  [7.79673527]


portfolio before change:  [7.18279757]
curr_Stock_Price:  93.25926666437564
curr_Factors:  [9.32592667e+01 3.93484643e-02]
mat_Sqrt:  [[ 1.84993253e+01  0.00000000e+00]
 [-7.93457893e-03  1.81804043e-02]]
grads:  [-0.02009203  3.46113395]
Stock Position:  -0.02009203032122828
Bond Position:  [9.05656558]


portfolio before change:  [7.18132339]
curr_Stock_Price:  93.38898557472307
curr_Factors:  [9.33889856e+01 4.02028059e-02]
mat_Sqrt:  [[ 1.87250869e+01  0.00000000e+00]
 [-8.02025495e-03  1.83767127e-02]]
grads:  [ 0.01009542 -5.45684696]
Stock Position:  0.01009541742916116
Bond Position:  [6.2385226]


portfolio before change:  [7.19441951]
curr_Stock_Price:  94.60897018778608
curr_Factors:  [9.46089702e+01 3.96522323e-02]
mat_Sqrt:  [[ 1.88393596e+01  0.00000000e+00]
 [-7.96514732e-03  1.82504452e-02]]
grads:  [-0.06690786 -7.41613038]
Stock Position:  -0.0669078599386448
Bond Position:  [13.52450324]


portfolio before change:  [7.32286713]
curr_Stock_Price:  92.71447000051624
curr_Factors:  [9.27144700e+01 3.91206457e-02]
mat_Sqrt:  [[ 1.83379391e+01  0.00000000e+00]
 [-7.91157589e-03  1.81276977e-02]]
grads:  [2.05121893e-02 2.35391147e+01]
Stock Position:  0.020512189339864553
Bond Position:  [5.42109037]


portfolio before change:  [7.31445414]
curr_Stock_Price:  92.27128618042846
curr_Factors:  [9.22712862e+01 3.96023337e-02]
mat_Sqrt:  [[ 1.83622951e+01  0.00000000e+00]
 [-7.96013404e-03  1.82389584e-02]]
grads:  [-2.56180528e-03 -7.39947846e+00]
Stock Position:  -0.0025618052772644873
Bond Position:  [7.55083521]


portfolio before change:  [7.31606597]
curr_Stock_Price:  92.01056693474435
curr_Factors:  [9.20105669e+01 4.06742772e-02]
mat_Sqrt:  [[ 1.85565668e+01  0.00000000e+00]
 [-8.06714593e-03  1.84841534e-02]]
grads:  [1.29963193e-03 2.72160124e+00]
Stock Position:  0.0012996319285075346
Bond Position:  [7.1964861]


portfolio before change:  [7.31729548]
curr_Stock_Price:  92.26440283262562
curr_Factors:  [9.22644028e+01 4.18082446e-02]
mat_Sqrt:  [[ 1.88653619e+01  0.00000000e+00]
 [-8.17882579e-03  1.87400441e-02]]
grads:  [2.76959120e-03 9.03973611e+00]
Stock Position:  0.002769591199370901
Bond Position:  [7.0617608]


portfolio before change:  [7.32479395]
curr_Stock_Price:  94.65309344464261
curr_Factors:  [9.46530934e+01 4.08879469e-02]
mat_Sqrt:  [[ 1.91395827e+01  0.00000000e+00]
 [-8.08830731e-03  1.85326402e-02]]
grads:  [-0.07998399 -6.19362852]
Stock Position:  -0.07998398791956218
Bond Position:  [14.89552583]


portfolio before change:  [7.43567876]
curr_Stock_Price:  93.29003620951752
curr_Factors:  [9.32900362e+01 3.98961075e-02]
mat_Sqrt:  [[ 1.86337612e+01  0.00000000e+00]
 [-7.98960400e-03  1.83064825e-02]]
grads:  [8.46795040e-06 1.12961629e+01]
Stock Position:  8.467950399399439e-06
Bond Position:  [7.43488878]


portfolio before change:  [7.43659631]
curr_Stock_Price:  91.88853571998933
curr_Factors:  [9.18885357e+01 3.97772559e-02]
mat_Sqrt:  [[ 1.83264666e+01  0.00000000e+00]
 [-7.97769450e-03  1.82791945e-02]]
grads:  [-0.00758099 -0.4778067 ]
Stock Position:  -0.007580986353012783
Bond Position:  [8.13320205]


portfolio before change:  [7.44802799]
curr_Stock_Price:  90.51470802298039
curr_Factors:  [9.05147080e+01 4.06850851e-02]
mat_Sqrt:  [[ 1.82573091e+01  0.00000000e+00]
 [-8.06821766e-03  1.84866091e-02]]
grads:  [ 0.08294234 -4.73552015]
Stock Position:  0.08294234494252442
Bond Position:  [-0.05947414]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.42724548]
Stock Price:  90.26423183786198
PL:  [7.42724548]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.20970905e-01  5.34145605e-01]
 [-1.95673278e-01 -7.60556505e-02]
 [ 8.34617266e-01 -6.94237778e-01]
 [ 4.86797177e-02  2.14549089e-02]
 [-7.06071494e-02  3.16176125e-02]
 [-8.43151710e-02 -6.42057596e-02]
 [-4.33321712e-03  3.20677287e-01]
 [ 2.43858382e-01 -2.10222636e-03]
 [ 1.23843879e-01  8.35484910e-02]
 [ 3.26771546e-01 -1.56039240e-01]
 [ 7.19479691e-02  2.79553295e-02]
 [-1.30253232e-01 -8.29389251e-02]
 [-1.21738223e-01  1.42302530e-01]
 [-4.62726664e-01 -5.98987230e-01]
 [ 7.76959788e-02  2.23480224e-01]
 [ 5.47657745e-02 -2.08921870e-02]
 [-5.27766712e-02  2.59755680e-01]
 [-2.55219904e-02  1.30705367e-01]
 [ 1.46443525e-02  7.21845685e-02]
 [-1.08118837e-01 -2.96528835e-02]
 [ 2.30008380e-01  2.61828637e-01]
 [ 2.42027547e-02  3.18253901e-02]
 [ 1.78893140e-02  2.64600091e-01]
 [ 3.07892872e-02  1.67423138e-01]
 [ 4.20972950e-02  9.28155058e-02]
 [ 7.35443352e-01 -3.96202432e-01]
 [-2.02938584e-01  2.72264243e-01]
 [ 1.97396971e-02  4.56419653e-02]
 [ 4.19375224e-02 -1.62768812e-01]
 [-1.92165974e-03 -4.58739136e-02]
 [-6.92820932e-01 -8.96685643e-02]
 [-1.18200003e-01  1.02740426e-02]
 [-8.75332659e-03 -1.02136944e-01]
 [ 5.20603835e-02  8.48543629e-02]
 [-4.39529334e-02  1.65703177e-01]
 [-1.54972470e+00 -9.98276338e-02]
 [-5.88821337e-02  2.54903942e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 9.00490027e-01 -2.83516004e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.95989794]
curr_Stock_Price:  100.64043548493645
curr_Factors:  [1.00640435e+02 4.03179896e-02]
mat_Sqrt:  [[ 2.02079352e+01  0.00000000e+00]
 [-8.03173601e-03  1.84030191e-02]]
grads:  [2.2470933e-02 2.9024890e+01]
Stock Position:  0.02247093301162771
Bond Position:  [4.69841345]


portfolio before change:  [6.97904233]
curr_Stock_Price:  101.46626048978969
curr_Factors:  [1.01466260e+02 4.01070821e-02]
mat_Sqrt:  [[ 2.03203970e+01  0.00000000e+00]
 [-8.01070105e-03  1.83548220e-02]]
grads:  [-0.0112629  -4.14363325]
Stock Position:  -0.011262904238899038
Bond Position:  [8.12184711]


portfolio before change:  [6.97304673]
curr_Stock_Price:  102.0887374614115
curr_Factors:  [1.02088737e+02 3.91887106e-02]
mat_Sqrt:  [[ 2.02096280e+01  0.00000000e+00]
 [-7.91845547e-03  1.81434608e-02]]
grads:  [ 2.63056330e-02 -3.82638013e+01]
Stock Position:  0.026305633043125023
Bond Position:  [4.28753786]


portfolio before change:  [6.95882551]
curr_Stock_Price:  101.52774747039135
curr_Factors:  [1.01527747e+02 3.77904632e-02]
mat_Sqrt:  [[ 1.97367599e+01  0.00000000e+00]
 [-7.77590773e-03  1.78168429e-02]]
grads:  [0.00294088 1.20419252]
Stock Position:  0.0029408782312747746
Bond Position:  [6.66024477]


portfolio before change:  [6.95701418]
curr_Stock_Price:  100.62872780264979
curr_Factors:  [1.00628728e+02 3.91194216e-02]
mat_Sqrt:  [[ 1.99029840e+01  0.00000000e+00]
 [-7.91145211e-03  1.81274141e-02]]
grads:  [-0.00285425  1.74418769]
Stock Position:  -0.0028542499926532644
Bond Position:  [7.24423373]


portfolio before change:  [6.95838718]
curr_Stock_Price:  100.46496901094304
curr_Factors:  [1.00464969e+02 3.80817374e-02]
mat_Sqrt:  [[ 1.96052792e+01  0.00000000e+00]
 [-7.80581706e-03  1.78853738e-02]]
grads:  [-0.00572993 -3.58984724]
Stock Position:  -0.0057299291978702
Bond Position:  [7.53404434]


portfolio before change:  [6.95848598]
curr_Stock_Price:  100.6120925134908
curr_Factors:  [1.00612093e+02 3.87752197e-02]
mat_Sqrt:  [[ 1.98119542e+01  0.00000000e+00]
 [-7.87656978e-03  1.80474886e-02]]
grads:  [6.84545419e-03 1.77685269e+01]
Stock Position:  0.0068454541884996984
Bond Position:  [6.26975051]


portfolio before change:  [6.96509041]
curr_Stock_Price:  101.46238822163062
curr_Factors:  [1.01462388e+02 4.03981720e-02]
mat_Sqrt:  [[ 2.03932262e+01  0.00000000e+00]
 [-8.03971860e-03  1.84213095e-02]]
grads:  [ 0.01191282 -0.11411927]
Stock Position:  0.011912823029427472
Bond Position:  [5.75638694]


portfolio before change:  [6.96535422]
curr_Stock_Price:  101.42412814483063
curr_Factors:  [1.01424128e+02 4.07944883e-02]
mat_Sqrt:  [[ 2.04852858e+01  0.00000000e+00]
 [-8.07905819e-03  1.85114478e-02]]
grads:  [0.00782549 4.51334178]
Stock Position:  0.007825491492813405
Bond Position:  [6.17166057]


portfolio before change:  [6.96563033]
curr_Stock_Price:  101.36082248463327
curr_Factors:  [1.01360822e+02 3.99220184e-02]
mat_Sqrt:  [[ 2.02523941e+01  0.00000000e+00]
 [-7.99219803e-03  1.83124262e-02]]
grads:  [ 0.01277234 -8.52094847]
Stock Position:  0.012772338759106326
Bond Position:  [5.67101557]


portfolio before change:  [6.95751897]
curr_Stock_Price:  100.67024610093964
curr_Factors:  [1.00670246e+02 4.24837535e-02]
mat_Sqrt:  [[ 2.07497358e+01  0.00000000e+00]
 [-8.24463496e-03  1.88908319e-02]]
grads:  [0.00405541 1.47983581]
Stock Position:  0.00405540948530629
Bond Position:  [6.5492599]


portfolio before change:  [6.95894765]
curr_Stock_Price:  100.82065349463147
curr_Factors:  [1.00820653e+02 4.21858686e-02]
mat_Sqrt:  [[ 2.07077544e+01  0.00000000e+00]
 [-8.21567951e-03  1.88244866e-02]]
grads:  [-0.00803809 -4.40590635]
Stock Position:  -0.008038087710853178
Bond Position:  [7.7693529]


portfolio before change:  [6.95708368]
curr_Stock_Price:  101.17337321621311
curr_Factors:  [1.01173373e+02 4.27532484e-02]
mat_Sqrt:  [[ 2.09194754e+01  0.00000000e+00]
 [-8.27074347e-03  1.89506540e-02]]
grads:  [-2.85056417e-03  7.50910916e+00]
Stock Position:  -0.0028505641721949114
Bond Position:  [7.24548488]


portfolio before change:  [6.95811797]
curr_Stock_Price:  101.12827934721368
curr_Factors:  [1.01128279e+02 4.27176174e-02]
mat_Sqrt:  [[ 2.09014362e+01  0.00000000e+00]
 [-8.26729628e-03  1.89427555e-02]]
grads:  [ -0.03464576 -31.62091334]
Stock Position:  -0.034645759116737805
Bond Position:  [10.46178398]


portfolio before change:  [6.98273013]
curr_Stock_Price:  100.45563265950904
curr_Factors:  [1.00455633e+02 4.24522973e-02]
mat_Sqrt:  [[ 2.06978336e+01  0.00000000e+00]
 [-8.24158211e-03  1.88838369e-02]]
grads:  [8.46613939e-03 1.18344712e+01]
Stock Position:  0.00846613939496696
Bond Position:  [6.13225874]


portfolio before change:  [6.99188596]
curr_Stock_Price:  101.4465512977128
curr_Factors:  [1.01446551e+02 4.16160398e-02]
mat_Sqrt:  [[ 2.06951064e+01  0.00000000e+00]
 [-8.16000390e-03  1.86969178e-02]]
grads:  [ 0.00220572 -1.11741343]
Stock Position:  0.002205723218512092
Bond Position:  [6.76812295]


portfolio before change:  [6.99376683]
curr_Stock_Price:  101.915695052591
curr_Factors:  [1.01915695e+02 4.23750242e-02]
mat_Sqrt:  [[ 2.09795443e+01  0.00000000e+00]
 [-8.23407789e-03  1.88666426e-02]]
grads:  [2.88805136e-03 1.37679864e+01]
Stock Position:  0.002888051363198084
Bond Position:  [6.69942907]


portfolio before change:  [6.99837984]
curr_Stock_Price:  103.22298488361803
curr_Factors:  [1.03222985e+02 4.35457241e-02]
mat_Sqrt:  [[ 2.15401722e+01  0.00000000e+00]
 [-8.34704490e-03  1.91254826e-02]]
grads:  [1.46342879e-03 6.83409511e+00]
Stock Position:  0.0014634287941439788
Bond Position:  [6.84732035]


portfolio before change:  [7.00092338]
curr_Stock_Price:  104.3761518941312
curr_Factors:  [1.04376152e+02 4.41354051e-02]
mat_Sqrt:  [[ 2.19277888e+01  0.00000000e+00]
 [-8.40337124e-03  1.92545424e-02]]
grads:  [2.10455698e-03 3.74896308e+00]
Stock Position:  0.002104556979469775
Bond Position:  [6.78125782]


portfolio before change:  [7.00328795]
curr_Stock_Price:  105.09690338828487
curr_Factors:  [1.05096903e+02 4.43192875e-02]
mat_Sqrt:  [[ 2.21251541e+01  0.00000000e+00]
 [-8.42085862e-03  1.92946110e-02]]
grads:  [-0.00547162 -1.53684795]
Stock Position:  -0.005471619121560021
Bond Position:  [7.57833818]


portfolio before change:  [7.01092651]
curr_Stock_Price:  103.87401048440854
curr_Factors:  [1.0387401e+02 4.4691917e-02]
mat_Sqrt:  [[ 2.19594466e+01  0.00000000e+00]
 [-8.45618514e-03  1.93755542e-02]]
grads:  [ 0.01567798 13.51334956]
Stock Position:  0.015677980061355228
Bond Position:  [5.38239185]


portfolio before change:  [7.00249769]
curr_Stock_Price:  103.29347243894662
curr_Factors:  [1.03293472e+02 4.41474738e-02]
mat_Sqrt:  [[ 2.17033016e+01  0.00000000e+00]
 [-8.40452010e-03  1.92571748e-02]]
grads:  [0.00175515 1.65265105]
Stock Position:  0.0017551474103860813
Bond Position:  [6.82120242]


portfolio before change:  [7.00182744]
curr_Stock_Price:  102.4257676123346
curr_Factors:  [1.02425768e+02 4.33129441e-02]
mat_Sqrt:  [[ 2.13166071e+01  0.00000000e+00]
 [-8.32470483e-03  1.90742950e-02]]
grads:  [6.25663647e-03 1.38720771e+01]
Stock Position:  0.006256636468615889
Bond Position:  [6.36098665]


portfolio before change:  [6.99968771]
curr_Stock_Price:  101.95668158643764
curr_Factors:  [1.01956682e+02 4.28728775e-02]
mat_Sqrt:  [[ 2.11109126e+01  0.00000000e+00]
 [-8.28230668e-03  1.89771487e-02]]
grads:  [4.91967054e-03 8.82235476e+00]
Stock Position:  0.004919670540055596
Bond Position:  [6.49809443]


portfolio before change:  [7.00506691]
curr_Stock_Price:  102.88497235312698
curr_Factors:  [1.02884972e+02 4.34104463e-02]
mat_Sqrt:  [[ 2.14362627e+01  0.00000000e+00]
 [-8.33406947e-03  1.90957521e-02]]
grads:  [3.85353100e-03 4.86053156e+00]
Stock Position:  0.0038535309955505864
Bond Position:  [6.60859648]


portfolio before change:  [7.00575501]
curr_Stock_Price:  102.84915303529421
curr_Factors:  [1.02849153e+02 4.42681581e-02]
mat_Sqrt:  [[ 2.16394613e+01  0.00000000e+00]
 [-8.41599982e-03  1.92834781e-02]]
grads:  [  0.0259954  -20.54621213]
Stock Position:  0.0259953991031177
Bond Position:  [4.33215023]


portfolio before change:  [7.00253313]
curr_Stock_Price:  102.70438005760323
curr_Factors:  [1.0270438e+02 4.3297756e-02]
mat_Sqrt:  [[ 2.13708433e+01  0.00000000e+00]
 [-8.32324514e-03  1.90709504e-02]]
grads:  [-3.93586372e-03  1.42763856e+01]
Stock Position:  -0.003935863716492255
Bond Position:  [7.40676357]


portfolio before change:  [7.00784008]
curr_Stock_Price:  101.591270146709
curr_Factors:  [1.01591270e+02 4.36016678e-02]
mat_Sqrt:  [[ 2.12132857e+01  0.00000000e+00]
 [-8.35240495e-03  1.91377640e-02]]
grads:  [1.86955875e-03 2.38491630e+00]
Stock Position:  0.0018695587495513172
Bond Position:  [6.81790923]


portfolio before change:  [7.00634202]
curr_Stock_Price:  100.33410220603372
curr_Factors:  [1.00334102e+02 4.44172664e-02]
mat_Sqrt:  [[ 2.11458176e+01  0.00000000e+00]
 [-8.43016169e-03  1.93159270e-02]]
grads:  [-1.37618756e-03 -8.42666324e+00]
Stock Position:  -0.001376187564562442
Bond Position:  [7.14442057]


portfolio before change:  [7.00741372]
curr_Stock_Price:  100.20433070576104
curr_Factors:  [1.00204331e+02 4.62294413e-02]
mat_Sqrt:  [[ 2.15449661e+01  0.00000000e+00]
 [-8.60041314e-03  1.97060221e-02]]
grads:  [-1.01845958e-03 -2.32791343e+00]
Stock Position:  -0.00101845957661397
Bond Position:  [7.10946778]


portfolio before change:  [7.00889597]
curr_Stock_Price:  99.62157356440935
curr_Factors:  [9.96215736e+01 4.58087249e-02]
mat_Sqrt:  [[ 2.13219784e+01  0.00000000e+00]
 [-8.56118916e-03  1.96161487e-02]]
grads:  [-0.03432869 -4.57116051]
Stock Position:  -0.034328686062743995
Bond Position:  [10.4287737]


portfolio before change:  [7.06548824]
curr_Stock_Price:  98.01100820531666
curr_Factors:  [9.80110082e+01 4.75117806e-02]
mat_Sqrt:  [[ 2.13636528e+01  0.00000000e+00]
 [-8.71887889e-03  1.99774612e-02]]
grads:  [-0.00532287  0.51428169]
Stock Position:  -0.00532287452366527
Bond Position:  [7.58718854]


portfolio before change:  [7.07252088]
curr_Stock_Price:  96.86798379327736
curr_Factors:  [9.68679838e+01 4.61471077e-02]
mat_Sqrt:  [[ 2.08090620e+01  0.00000000e+00]
 [-8.59275115e-03  1.96884663e-02]]
grads:  [-2.56280382e-03 -5.18765366e+00]
Stock Position:  -0.002562803819708389
Bond Position:  [7.32077452]


portfolio before change:  [7.07634443]
curr_Stock_Price:  95.73313463296755
curr_Factors:  [9.57331346e+01 4.62229236e-02]
mat_Sqrt:  [[ 2.05821617e+01  0.00000000e+00]
 [-8.59980685e-03  1.97046329e-02]]
grads:  [0.00432869 4.30631533]
Stock Position:  0.004328693214050423
Bond Position:  [6.66194506]


portfolio before change:  [7.07080181]
curr_Stock_Price:  94.26030842207784
curr_Factors:  [9.42603084e+01 4.68053698e-02]
mat_Sqrt:  [[ 2.03927923e+01  0.00000000e+00]
 [-8.65381949e-03  1.98283914e-02]]
grads:  [1.39097489e-03 8.35686434e+00]
Stock Position:  0.0013909748886964213
Bond Position:  [6.93968809]


portfolio before change:  [7.07179463]
curr_Stock_Price:  94.35039372377919
curr_Factors:  [9.43503937e+01 4.72623365e-02]
mat_Sqrt:  [[ 2.05116837e+01  0.00000000e+00]
 [-8.69596104e-03  1.99249499e-02]]
grads:  [-0.07767734 -5.01018244]
Stock Position:  -0.0776773412674907
Bond Position:  [14.40068236]


portfolio before change:  [6.99823373]
curr_Stock_Price:  95.32057497745365
curr_Factors:  [9.53205750e+01 4.81290907e-02]
mat_Sqrt:  [[ 2.09117550e+01  0.00000000e+00]
 [-8.77533732e-03  2.01068238e-02]]
grads:  [2.50419285e-03 1.26774843e+01]
Stock Position:  0.002504192847284524
Bond Position:  [6.75953263]


portfolio before change:  [6.99828926]
curr_Stock_Price:  95.00531719899918
curr_Factors:  [9.50053172e+01 4.86361074e-02]
mat_Sqrt:  [[ 2.09520883e+01  0.00000000e+00]
 [-8.82143820e-03  2.02124541e-02]]
grads:  [-4.20889860e-03  5.41061287e+00]
Stock Position:  -0.004208898601058143
Bond Position:  [7.398157]


portfolio before change:  [6.99418107]
curr_Stock_Price:  96.2011203057794
curr_Factors:  [9.62011203e+01 4.90176220e-02]
mat_Sqrt:  [[ 2.12988546e+01  0.00000000e+00]
 [-8.85596946e-03  2.02915752e-02]]
grads:  [ 0.04222071 -0.13972104]
Stock Position:  0.0422207052342189
Bond Position:  [2.93250193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.90804488]
Stock Price:  94.15229663603654
PL:  [6.90804488]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.38683263e-01  8.24660519e-01]
 [-1.77500731e-01 -7.81567068e-02]
 [ 8.04592844e-01 -6.76225099e-01]
 [ 4.42803913e-02  2.17206167e-02]
 [-1.18036625e-01  5.05993564e-02]
 [ 4.77994275e-03  3.50433694e-02]
 [ 1.55337902e-02  3.01179425e-01]
 [ 2.60202413e-01 -2.11230472e-03]
 [ 1.18020951e-01  8.54003684e-02]
 [ 3.37370205e-01 -1.63827848e-01]
 [ 7.31449099e-02  3.21883666e-02]
 [-1.35074202e-01 -1.81308396e-01]
 [-1.04978395e-01  1.36882769e-01]
 [-4.81117699e-01 -6.20584592e-01]
 [ 5.52097738e-02  1.26784955e-01]
 [ 4.72119853e-02 -7.73093322e-02]
 [-5.28950797e-02  2.66411800e-01]
 [-1.68171400e-01 -7.31469207e-03]
 [ 1.52374213e-02  5.74585814e-02]
 [ 7.51776389e-02 -9.83349020e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 7.19402380e-02  2.72885697e-01]
 [ 3.51053208e-02  2.30089048e-01]
 [-7.07107252e-02  1.16075203e-01]
 [ 3.12475173e-02  7.59288725e-02]
 [ 4.65141330e-02  1.03371138e-01]
 [-4.17183247e-03  2.20488110e-01]
 [-1.85500842e-01  1.36492617e-01]
 [-4.28075665e-02 -1.15859300e-01]
 [ 3.42280812e-02 -5.43225731e-02]
 [-8.24284919e-01 -1.00017019e-01]
 [-1.18200527e-01  1.02944124e-02]
 [-1.53566566e-03 -9.04998981e-02]
 [ 6.92755318e-02  9.22215507e-02]
 [-6.67003866e-02  1.61684790e-01]
 [-6.43437771e-01 -2.84315686e-01]
 [-5.09052059e-02  3.02886757e-01]
 [-1.23770496e-01  1.17554427e-01]
 [ 2.68020520e-01  7.16023014e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.87391873]
curr_Stock_Price:  101.53118273707314
curr_Factors:  [1.01531183e+02 3.98597554e-02]
mat_Sqrt:  [[ 2.02706073e+01  0.00000000e+00]
 [-7.98596323e-03  1.82981405e-02]]
grads:  [3.93966796e-02 4.50679958e+01]
Stock Position:  0.039396679568234345
Bond Position:  [8.87392726]


portfolio before change:  [12.83353467]
curr_Stock_Price:  100.47796269624294
curr_Factors:  [1.00477963e+02 3.95027100e-02]
mat_Sqrt:  [[ 1.99702851e+01  0.00000000e+00]
 [-7.95011547e-03  1.82160030e-02]]
grads:  [-0.0105963  -4.29055194]
Stock Position:  -0.010596299082612634
Bond Position:  [13.89822921]


portfolio before change:  [12.83982074]
curr_Stock_Price:  100.04869115161672
curr_Factors:  [1.00048691e+02 4.02313316e-02]
mat_Sqrt:  [[ 2.00675159e+01  0.00000000e+00]
 [-8.02309981e-03  1.83832311e-02]]
grads:  [ 2.53874978e-02 -3.67848881e+01]
Stock Position:  0.025387497808070626
Bond Position:  [10.29983482]


portfolio before change:  [12.8763117]
curr_Stock_Price:  101.43533417039048
curr_Factors:  [1.01435334e+02 3.96174840e-02]
mat_Sqrt:  [[ 2.01898322e+01  0.00000000e+00]
 [-7.96165651e-03  1.82424468e-02]]
grads:  [0.00266273 1.19066356]
Stock Position:  0.002662728692092172
Bond Position:  [12.60621692]


portfolio before change:  [12.87798441]
curr_Stock_Price:  101.47169965757661
curr_Factors:  [1.01471700e+02 3.96430891e-02]
mat_Sqrt:  [[ 2.02035962e+01  0.00000000e+00]
 [-7.96422894e-03  1.82483410e-02]]
grads:  [-0.00474932  2.77281954]
Stock Position:  -0.0047493156571798145
Bond Position:  [13.35990554]


portfolio before change:  [12.87778414]
curr_Stock_Price:  101.86551698199084
curr_Factors:  [1.01865517e+02 3.84984581e-02]
mat_Sqrt:  [[ 1.99870575e+01  0.00000000e+00]
 [-7.84840959e-03  1.79829655e-02]]
grads:  [1.00435609e-03 1.94869803e+00]
Stock Position:  0.0010043560949984135
Bond Position:  [12.77547488]


portfolio before change:  [12.87914387]
curr_Stock_Price:  101.62924658936987
curr_Factors:  [1.01629247e+02 3.97453141e-02]
mat_Sqrt:  [[ 2.02610371e+01  0.00000000e+00]
 [-7.97449074e-03  1.82718537e-02]]
grads:  [7.25428153e-03 1.64832441e+01]
Stock Position:  0.007254281526563032
Bond Position:  [12.1418967]


portfolio before change:  [12.88158333]
curr_Stock_Price:  101.75629226575536
curr_Factors:  [1.01756292e+02 3.96428269e-02]
mat_Sqrt:  [[ 2.02601932e+01  0.00000000e+00]
 [-7.96420260e-03  1.82482806e-02]]
grads:  [ 0.01279753 -0.11575363]
Stock Position:  0.012797534809226489
Bond Position:  [11.57935364]


portfolio before change:  [12.88221161]
curr_Stock_Price:  101.69227760310922
curr_Factors:  [1.01692278e+02 3.98299717e-02]
mat_Sqrt:  [[ 2.02951831e+01  0.00000000e+00]
 [-7.98297906e-03  1.82913029e-02]]
grads:  [0.0076517 4.6689057]
Stock Position:  0.0076517037161225624
Bond Position:  [12.10409243]


portfolio before change:  [12.88331546]
curr_Stock_Price:  101.63879276873251
curr_Factors:  [1.01638793e+02 3.90479753e-02]
mat_Sqrt:  [[ 2.00843952e+01  0.00000000e+00]
 [-7.90422421e-03  1.81108529e-02]]
grads:  [ 0.01323763 -9.04583837]
Stock Position:  0.013237633900076031
Bond Position:  [11.53785834]


portfolio before change:  [12.87116812]
curr_Stock_Price:  100.61219939037143
curr_Factors:  [1.00612199e+02 3.85282402e-02]
mat_Sqrt:  [[ 1.97487781e+01  0.00000000e+00]
 [-7.85144473e-03  1.79899199e-02]]
grads:  [0.00441511 1.78924458]
Stock Position:  0.004415111887907925
Bond Position:  [12.426954]


portfolio before change:  [12.87849399]
curr_Stock_Price:  101.91961964633767
curr_Factors:  [1.01919620e+02 3.78498648e-02]
mat_Sqrt:  [[ 1.98285045e+01  0.00000000e+00]
 [-7.78201668e-03  1.78308403e-02]]
grads:  [ -0.01080282 -10.16824746]
Stock Position:  -0.01080281537584692
Bond Position:  [13.97951283]


portfolio before change:  [12.89005908]
curr_Stock_Price:  101.01082527160922
curr_Factors:  [1.01010825e+02 3.72981791e-02]
mat_Sqrt:  [[ 1.95079545e+01  0.00000000e+00]
 [-7.72509460e-03  1.77004154e-02]]
grads:  [-2.31894413e-03  7.73330831e+00]
Stock Position:  -0.002318944134594174
Bond Position:  [13.12429754]


portfolio before change:  [12.89097098]
curr_Stock_Price:  101.32507936768198
curr_Factors:  [1.01325079e+02 3.91292172e-02]
mat_Sqrt:  [[ 2.00432218e+01  0.00000000e+00]
 [-7.91244257e-03  1.81296835e-02]]
grads:  [ -0.03751707 -34.2303048 ]
Stock Position:  -0.03751707326702222
Bond Position:  [16.69239141]


portfolio before change:  [12.85432219]
curr_Stock_Price:  102.3575552087284
curr_Factors:  [1.02357555e+02 3.89122948e-02]
mat_Sqrt:  [[ 2.01912556e+01  0.00000000e+00]
 [-7.89047981e-03  1.80793605e-02]]
grads:  [5.47480885e-03 7.01269024e+00]
Stock Position:  0.005474808847394046
Bond Position:  [12.29393414]


portfolio before change:  [12.86130813]
curr_Stock_Price:  103.35286035167539
curr_Factors:  [1.0335286e+02 3.8719139e-02]
mat_Sqrt:  [[ 2.03369278e+01  0.00000000e+00]
 [-7.87087177e-03  1.80344328e-02]]
grads:  [ 6.62412079e-04 -4.28676260e+00]
Stock Position:  0.0006624120788749436
Bond Position:  [12.79284595]


portfolio before change:  [12.862133]
curr_Stock_Price:  102.1838969462828
curr_Factors:  [1.02183897e+02 3.92258640e-02]
mat_Sqrt:  [[ 2.02380526e+01  0.00000000e+00]
 [-7.92220818e-03  1.81520593e-02]]
grads:  [3.13155437e-03 1.46766708e+01]
Stock Position:  0.0031315543652807596
Bond Position:  [12.54213857]


portfolio before change:  [12.85840335]
curr_Stock_Price:  100.4922392294347
curr_Factors:  [1.00492239e+02 3.92823715e-02]
mat_Sqrt:  [[ 1.99173416e+01  0.00000000e+00]
 [-7.92791236e-03  1.81651293e-02]]
grads:  [-0.00860375 -0.40267768]
Stock Position:  -0.008603748247003586
Bond Position:  [13.72301328]


portfolio before change:  [12.86955803]
curr_Stock_Price:  99.39513641032123
curr_Factors:  [9.93951364e+01 3.94102728e-02]
mat_Sqrt:  [[ 1.97319431e+01  0.00000000e+00]
 [-7.94080830e-03  1.81946776e-02]]
grads:  [2.04310350e-03 3.15798844e+00]
Stock Position:  0.0020431035030558753
Bond Position:  [12.66648348]


portfolio before change:  [12.86926937]
curr_Stock_Price:  98.4788510081814
curr_Factors:  [9.8478851e+01 4.0748339e-02]
mat_Sqrt:  [[ 1.98791554e+01  0.00000000e+00]
 [-8.07448713e-03  1.85009742e-02]]
grads:  [ 1.62284406e-03 -5.31512021e+00]
Stock Position:  0.001622844061700945
Bond Position:  [12.70945355]


portfolio before change:  [12.87045269]
curr_Stock_Price:  98.22900237107368
curr_Factors:  [9.82290024e+01 4.07588893e-02]
mat_Sqrt:  [[ 1.98312872e+01  0.00000000e+00]
 [-8.07553236e-03  1.85033692e-02]]
grads:  [ 0.00212435 -2.04168167]
Stock Position:  0.002124350791604403
Bond Position:  [12.66177983]


portfolio before change:  [12.87186593]
curr_Stock_Price:  98.14917562694454
curr_Factors:  [9.81491756e+01 4.14879668e-02]
mat_Sqrt:  [[ 1.99916082e+01  0.00000000e+00]
 [-8.14743806e-03  1.86681258e-02]]
grads:  [9.55587555e-03 1.46177340e+01]
Stock Position:  0.009555875545230016
Bond Position:  [11.93396462]


portfolio before change:  [12.8691916]
curr_Stock_Price:  97.71319588805409
curr_Factors:  [9.77131959e+01 4.18669220e-02]
mat_Sqrt:  [[ 1.99934957e+01  0.00000000e+00]
 [-8.18456323e-03  1.87531903e-02]]
grads:  [6.77842513e-03 1.22693283e+01]
Stock Position:  0.0067784251252498585
Bond Position:  [12.20685002]


portfolio before change:  [12.87332825]
curr_Stock_Price:  98.09834439998062
curr_Factors:  [9.80983444e+01 4.29921051e-02]
mat_Sqrt:  [[ 2.03402381e+01  0.00000000e+00]
 [-8.29381506e-03  1.90035176e-02]]
grads:  [-9.85797369e-04  6.10809038e+00]
Stock Position:  -0.0009857973685039574
Bond Position:  [12.97003334]


portfolio before change:  [12.87479036]
curr_Stock_Price:  98.25988954807823
curr_Factors:  [9.82598895e+01 4.28359164e-02]
mat_Sqrt:  [[ 2.03366916e+01  0.00000000e+00]
 [-8.27873579e-03  1.89689667e-02]]
grads:  [3.16598173e-03 4.00279434e+00]
Stock Position:  0.0031659817306024587
Bond Position:  [12.56370134]


portfolio before change:  [12.86887323]
curr_Stock_Price:  95.8948458926278
curr_Factors:  [9.58948459e+01 4.48815831e-02]
mat_Sqrt:  [[ 2.03155858e+01  0.00000000e+00]
 [-8.47410957e-03  1.94166243e-02]]
grads:  [4.51028079e-03 5.32384706e+00]
Stock Position:  0.004510280789669353
Bond Position:  [12.43636055]


portfolio before change:  [12.87959912]
curr_Stock_Price:  97.92825379613704
curr_Factors:  [9.79282538e+01 4.37712580e-02]
mat_Sqrt:  [[ 2.04881396e+01  0.00000000e+00]
 [-8.36863267e-03  1.91749463e-02]]
grads:  [4.49318825e-03 1.14987602e+01]
Stock Position:  0.004493188248331216
Bond Position:  [12.43958904]


portfolio before change:  [12.87903932]
curr_Stock_Price:  97.45757689680435
curr_Factors:  [9.74575769e+01 4.47263547e-02]
mat_Sqrt:  [[ 2.06109192e+01  0.00000000e+00]
 [-8.45944251e-03  1.93830178e-02]]
grads:  [-6.10989637e-03  7.04186614e+00]
Stock Position:  -0.006109896373392785
Bond Position:  [13.47449502]


portfolio before change:  [12.87254082]
curr_Stock_Price:  98.79686539882036
curr_Factors:  [9.87968654e+01 4.44927909e-02]
mat_Sqrt:  [[ 2.08395333e+01  0.00000000e+00]
 [-8.43732572e-03  1.93323419e-02]]
grads:  [-4.48055669e-03 -5.99302975e+00]
Stock Position:  -0.004480556690452009
Bond Position:  [13.31520578]


portfolio before change:  [12.87224624]
curr_Stock_Price:  99.23410704885957
curr_Factors:  [9.92341070e+01 4.54169224e-02]
mat_Sqrt:  [[ 2.11480251e+01  0.00000000e+00]
 [-8.52449857e-03  1.95320800e-02]]
grads:  [ 4.97434943e-04 -2.78119756e+00]
Stock Position:  0.0004974349433934144
Bond Position:  [12.82288373]


portfolio before change:  [12.87339048]
curr_Stock_Price:  98.31193087916229
curr_Factors:  [9.83119309e+01 4.63658147e-02]
mat_Sqrt:  [[ 2.11692355e+01  0.00000000e+00]
 [-8.61308908e-03  1.97350663e-02]]
grads:  [-0.04099987 -5.06798494]
Stock Position:  -0.04099987107675253
Bond Position:  [16.90416697]


portfolio before change:  [12.88816949]
curr_Stock_Price:  98.0030066078737
curr_Factors:  [9.80030066e+01 4.76273130e-02]
mat_Sqrt:  [[ 2.13878653e+01  0.00000000e+00]
 [-8.72947311e-03  2.00017357e-02]]
grads:  [-0.00531646  0.51467596]
Stock Position:  -0.005316457538543441
Bond Position:  [13.40919831]


portfolio before change:  [12.88973649]
curr_Stock_Price:  98.02355677115084
curr_Factors:  [9.80235568e+01 4.74979636e-02]
mat_Sqrt:  [[ 2.13632809e+01  0.00000000e+00]
 [-8.71761101e-03  1.99745562e-02]]
grads:  [-1.92072835e-03 -4.53075890e+00]
Stock Position:  -0.0019207283479404334
Bond Position:  [13.07801311]


portfolio before change:  [12.89405691]
curr_Stock_Price:  96.62535544380479
curr_Factors:  [9.66253554e+01 4.83446961e-02]
mat_Sqrt:  [[ 2.12454298e+01  0.00000000e+00]
 [-8.79497094e-03  2.01518100e-02]]
grads:  [0.00515519 4.57634081]
Stock Position:  0.005155194183933963
Bond Position:  [12.39593444]


portfolio before change:  [12.89398162]
curr_Stock_Price:  96.31016400082316
curr_Factors:  [9.63101640e+01 4.91915061e-02]
mat_Sqrt:  [[ 2.13607837e+01  0.00000000e+00]
 [-8.87166331e-03  2.03275343e-02]]
grads:  [1.80922253e-04 7.95397946e+00]
Stock Position:  0.00018092225308567118
Bond Position:  [12.87655697]


portfolio before change:  [12.89597611]
curr_Stock_Price:  98.43711863050974
curr_Factors:  [9.84371186e+01 4.86503649e-02]
mat_Sqrt:  [[ 2.17121057e+01  0.00000000e+00]
 [-8.82273108e-03  2.02154165e-02]]
grads:  [ -0.03535002 -14.06430016]
Stock Position:  -0.03535001721549589
Bond Position:  [16.37572995]


portfolio before change:  [12.8599071]
curr_Stock_Price:  99.51536700680944
curr_Factors:  [9.95153670e+01 4.71124205e-02]
mat_Sqrt:  [[ 2.16002043e+01  0.00000000e+00]
 [-8.68215831e-03  1.98933238e-02]]
grads:  [3.76317794e-03 1.52255480e+01]
Stock Position:  0.0037631779374421737
Bond Position:  [12.48541307]


portfolio before change:  [12.86215622]
curr_Stock_Price:  99.69828194436818
curr_Factors:  [9.96982819e+01 4.74404447e-02]
mat_Sqrt:  [[ 2.17151108e+01  0.00000000e+00]
 [-8.71233101e-03  1.99624582e-02]]
grads:  [-3.33710192e-03  5.88877514e+00]
Stock Position:  -0.003337101917185001
Bond Position:  [13.19485955]


portfolio before change:  [12.86063615]
curr_Stock_Price:  100.64806679415013
curr_Factors:  [1.00648067e+02 4.66784155e-02]
mat_Sqrt:  [[ 2.17452042e+01  0.00000000e+00]
 [-8.64207526e-03  1.98014820e-02]]
grads:  [0.01376259 3.61600719]
Stock Position:  0.01376258984741774
Bond Position:  [11.47545809]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.86179204]
Stock Price:  100.62782125164286
PL:  [12.23397079]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.22285337e-01  4.11258261e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.90970258e-01 -8.61966120e-01]
 [-2.05302208e-02  1.99739123e-01]
 [ 1.89065591e-02 -9.55610651e-02]
 [-7.28830331e-02 -5.06073262e-02]
 [-1.85427993e-01 -4.20910142e-02]
 [ 3.97734503e-01 -2.23331430e-01]
 [ 1.54821323e-01  1.82757231e-01]
 [-1.55024866e-01  4.46886343e-01]
 [ 1.84253554e-01  4.66424605e-01]
 [ 1.62978877e-01  2.72270957e-01]
 [ 2.17186493e-01  2.30222170e-02]
 [-1.29791252e-01 -1.20920436e-01]
 [ 9.44435358e-02  2.36828232e-01]
 [ 4.77391689e-02  3.26728215e-02]
 [ 2.81116759e-02  1.28627371e-02]
 [ 7.82269829e-02  6.37836836e-02]
 [ 1.13278159e-02  3.36388574e-02]
 [ 2.96115573e-01 -1.12303534e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.32922407e-02  4.60103425e-02]
 [-4.93065290e-02 -1.55956891e-01]
 [ 7.53530531e-03 -7.39101807e-02]
 [ 3.39811896e-02  1.52802570e-01]
 [ 4.59019295e-02  1.81973599e-01]
 [ 9.27956582e-03  1.58759966e-01]
 [-1.45158176e-01  5.82777678e-02]
 [-5.60189471e-01  1.30270662e-01]
 [ 2.92824184e-01 -6.04209437e-03]
 [-1.82740266e+00 -2.04882410e-01]
 [ 4.01086077e-01  7.30018487e-01]
 [ 8.58533762e-02 -1.60499123e-01]
 [ 2.14953977e-01 -3.85130513e-02]
 [ 3.85197868e-02  1.80547068e-01]
 [-2.36820391e+00  4.26724533e-01]
 [-1.93703510e-01 -1.21175391e-02]
 [-1.32063671e-01 -4.41087227e-01]
 [ 1.92076419e+00 -1.35400831e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.61176646]
curr_Stock_Price:  100.28676887948858
curr_Factors:  [1.00286769e+02 3.82749471e-02]
mat_Sqrt:  [[ 1.96200874e+01  0.00000000e+00]
 [-7.82559361e-03  1.79306875e-02]]
grads:  [1.53808263e-02 2.29360006e+01]
Stock Position:  0.015380826304928211
Bond Position:  [3.06927309]


portfolio before change:  [4.58481569]
curr_Stock_Price:  98.50959151112019
curr_Factors:  [9.85095915e+01 3.87823689e-02]
mat_Sqrt:  [[ 1.93997300e+01  0.00000000e+00]
 [-7.87729588e-03  1.80491523e-02]]
grads:  [-0.01046326 -4.87620519]
Stock Position:  -0.01046326151320743
Bond Position:  [5.61554731]


portfolio before change:  [4.60120496]
curr_Stock_Price:  97.01031843894091
curr_Factors:  [9.70103184e+01 4.11210851e-02]
mat_Sqrt:  [[ 1.96720769e+01  0.00000000e+00]
 [-8.11133381e-03  1.85854006e-02]]
grads:  [ 2.61679234e-02 -4.63786678e+01]
Stock Position:  0.026167923411526187
Bond Position:  [2.06264638]


portfolio before change:  [4.6122502]
curr_Stock_Price:  97.42255577469994
curr_Factors:  [9.74225558e+01 4.13566247e-02]
mat_Sqrt:  [[ 1.98121707e+01  0.00000000e+00]
 [-8.13453130e-03  1.86385527e-02]]
grads:  [3.36374445e-03 1.07164503e+01]
Stock Position:  0.0033637444506156946
Bond Position:  [4.28454562]


portfolio before change:  [4.61079907]
curr_Stock_Price:  96.83192255244045
curr_Factors:  [9.68319226e+01 4.10661883e-02]
mat_Sqrt:  [[ 1.96227898e+01  0.00000000e+00]
 [-8.10591767e-03  1.85729907e-02]]
grads:  [-1.16189946e-03 -5.14516304e+00]
Stock Position:  -0.0011618994634980799
Bond Position:  [4.72330803]


portfolio before change:  [4.61303531]
curr_Stock_Price:  95.41545547400592
curr_Factors:  [9.54154555e+01 4.08181279e-02]
mat_Sqrt:  [[ 1.92772584e+01  0.00000000e+00]
 [-8.08139868e-03  1.85168106e-02]]
grads:  [-0.00492652 -2.73304768]
Stock Position:  -0.004926524248780546
Bond Position:  [5.08310187]


portfolio before change:  [4.620895]
curr_Stock_Price:  93.94905318136715
curr_Factors:  [9.39490532e+01 4.08469862e-02]
mat_Sqrt:  [[ 1.89877024e+01  0.00000000e+00]
 [-8.08425493e-03  1.85233551e-02]]
grads:  [-0.01073316 -2.27232129]
Stock Position:  -0.010733158373961152
Bond Position:  [5.62926507]


portfolio before change:  [4.63510599]
curr_Stock_Price:  92.69058991315721
curr_Factors:  [9.26905899e+01 4.10370153e-02]
mat_Sqrt:  [[ 1.87768843e+01  0.00000000e+00]
 [-8.10303798e-03  1.85663924e-02]]
grads:  [  0.01599119 -12.02880049]
Stock Position:  0.01599118746147774
Bond Position:  [3.15287339]


portfolio before change:  [4.63535574]
curr_Stock_Price:  92.68156096709333
curr_Factors:  [9.26815610e+01 4.01929288e-02]
mat_Sqrt:  [[ 1.85809608e+01  0.00000000e+00]
 [-8.01926967e-03  1.83744551e-02]]
grads:  [0.01262492 9.94626668]
Stock Position:  0.012624918609184388
Bond Position:  [3.46525858]


portfolio before change:  [4.64157894]
curr_Stock_Price:  93.14017880797309
curr_Factors:  [9.31401788e+01 3.98357123e-02]
mat_Sqrt:  [[ 1.85897419e+01  0.00000000e+00]
 [-7.98355432e-03  1.82926210e-02]]
grads:  [2.15238729e-03 2.44298695e+01]
Stock Position:  0.0021523872881100492
Bond Position:  [4.4411052]


portfolio before change:  [4.6465877]
curr_Stock_Price:  95.20931693543898
curr_Factors:  [9.52093169e+01 3.85431148e-02]
mat_Sqrt:  [[ 1.86918744e+01  0.00000000e+00]
 [-7.85296019e-03  1.79933922e-02]]
grads:  [2.07479428e-02 2.59219939e+01]
Stock Position:  0.020747942778661238
Bond Position:  [2.67119024]


portfolio before change:  [4.66430281]
curr_Stock_Price:  96.04704769230707
curr_Factors:  [9.60470477e+01 3.78137860e-02]
mat_Sqrt:  [[ 1.86770852e+01  0.00000000e+00]
 [-7.77830686e-03  1.78223400e-02]]
grads:  [1.50884178e-02 1.52769478e+01]
Stock Position:  0.015088417764559396
Bond Position:  [3.21510483]


portfolio before change:  [4.67399259]
curr_Stock_Price:  96.66261033562189
curr_Factors:  [9.66626103e+01 3.79023692e-02]
mat_Sqrt:  [[ 1.88187901e+01  0.00000000e+00]
 [-7.78741232e-03  1.78432032e-02]]
grads:  [0.01207486 1.29025135]
Stock Position:  0.01207485772394197
Bond Position:  [3.50680532]


portfolio before change:  [4.67116749]
curr_Stock_Price:  96.39234019966833
curr_Factors:  [9.63923402e+01 3.70953927e-02]
mat_Sqrt:  [[ 1.85653231e+01  0.00000000e+00]
 [-7.70406570e-03  1.76522321e-02]]
grads:  [-0.00983367 -6.85014991]
Stock Position:  -0.0098336698159485
Bond Position:  [5.61905794]


portfolio before change:  [4.67580544]
curr_Stock_Price:  95.99213106579697
curr_Factors:  [9.59921311e+01 3.69180076e-02]
mat_Sqrt:  [[ 1.84439850e+01  0.00000000e+00]
 [-7.68562373e-03  1.76099763e-02]]
grads:  [1.07245723e-02 1.34485265e+01]
Stock Position:  0.010724572255580399
Bond Position:  [3.6463309]


portfolio before change:  [4.68803475]
curr_Stock_Price:  97.08993562109286
curr_Factors:  [9.70899356e+01 3.60396357e-02]
mat_Sqrt:  [[ 1.84316582e+01  0.00000000e+00]
 [-7.59364320e-03  1.73992224e-02]]
grads:  [0.00336371 1.87783228]
Stock Position:  0.003363710225547362
Bond Position:  [4.36145234]


portfolio before change:  [4.68719541]
curr_Stock_Price:  96.67832193115774
curr_Factors:  [9.66783219e+01 3.60668033e-02]
mat_Sqrt:  [[ 1.83604334e+01  0.00000000e+00]
 [-7.59650480e-03  1.74057791e-02]]
grads:  [0.00183685 0.73899232]
Stock Position:  0.0018368539449957512
Bond Position:  [4.50961146]


portfolio before change:  [4.68643467]
curr_Stock_Price:  95.95726499707276
curr_Factors:  [9.5957265e+01 3.4879979e-02]
mat_Sqrt:  [[ 1.79211539e+01  0.00000000e+00]
 [-7.47047297e-03  1.71170039e-02]]
grads:  [0.00591839 3.72633457]
Stock Position:  0.005918394840186272
Bond Position:  [4.11852169]


portfolio before change:  [4.68769172]
curr_Stock_Price:  96.08267104590257
curr_Factors:  [9.60826710e+01 3.55007936e-02]
mat_Sqrt:  [[ 1.81035647e+01  0.00000000e+00]
 [-7.53666171e-03  1.72686614e-02]]
grads:  [1.43667931e-03 1.94797134e+00]
Stock Position:  0.0014366793106231758
Bond Position:  [4.54965174]


portfolio before change:  [4.68705342]
curr_Stock_Price:  95.24250739069828
curr_Factors:  [9.52425074e+01 3.55498067e-02]
mat_Sqrt:  [[ 1.79576475e+01  0.00000000e+00]
 [-7.54186255e-03  1.72805780e-02]]
grads:  [ 0.01376028 -6.49882972]
Stock Position:  0.013760281911801727
Bond Position:  [3.37648967]


portfolio before change:  [4.67653826]
curr_Stock_Price:  94.44766555496412
curr_Factors:  [9.44476656e+01 3.75337483e-02]
mat_Sqrt:  [[ 1.82979399e+01  0.00000000e+00]
 [-7.74945141e-03  1.77562238e-02]]
grads:  [ 0.00230237 -2.12759143]
Stock Position:  0.0023023690582799033
Bond Position:  [4.45908488]


portfolio before change:  [4.67354025]
curr_Stock_Price:  92.9034166003154
curr_Factors:  [9.29034166e+01 3.82971831e-02]
mat_Sqrt:  [[ 1.81808884e+01  0.00000000e+00]
 [-7.82786644e-03  1.79358952e-02]]
grads:  [-1.76651484e-04  2.56526601e+00]
Stock Position:  -0.00017665148366810226
Bond Position:  [4.68995178]


portfolio before change:  [4.67413057]
curr_Stock_Price:  92.88055638632271
curr_Factors:  [9.28805564e+01 3.94089624e-02]
mat_Sqrt:  [[ 1.84383608e+01  0.00000000e+00]
 [-7.94067629e-03  1.81943751e-02]]
grads:  [-6.36562534e-03 -8.57170916e+00]
Stock Position:  -0.006365625336149783
Bond Position:  [5.26537339]


portfolio before change:  [4.66939359]
curr_Stock_Price:  93.72810790098622
curr_Factors:  [9.37281079e+01 3.78591554e-02]
mat_Sqrt:  [[ 1.82370803e+01  0.00000000e+00]
 [-7.78297171e-03  1.78330285e-02]]
grads:  [-1.35557565e-03 -4.14456696e+00]
Stock Position:  -0.0013555756547606736
Bond Position:  [4.79644913]


portfolio before change:  [4.67007592]
curr_Stock_Price:  93.66706859750329
curr_Factors:  [9.36670686e+01 3.70890275e-02]
mat_Sqrt:  [[ 1.80388834e+01  0.00000000e+00]
 [-7.70340470e-03  1.76507176e-02]]
grads:  [5.58070564e-03 8.65701743e+00]
Stock Position:  0.005580705637802371
Bond Position:  [4.14734758]


portfolio before change:  [4.66118265]
curr_Stock_Price:  91.9805924446888
curr_Factors:  [9.19805924e+01 3.89742059e-02]
mat_Sqrt:  [[ 1.81587036e+01  0.00000000e+00]
 [-7.89675436e-03  1.80937373e-02]]
grads:  [6.90146839e-03 1.00572698e+01]
Stock Position:  0.006901468394044028
Bond Position:  [4.02638149]


portfolio before change:  [4.65022714]
curr_Stock_Price:  90.32024564265078
curr_Factors:  [9.03202456e+01 4.19353195e-02]
mat_Sqrt:  [[ 1.84958838e+01  0.00000000e+00]
 [-8.19124601e-03  1.87685024e-02]]
grads:  [4.24786923e-03 8.45885104e+00]
Stock Position:  0.004247869231478858
Bond Position:  [4.26655855]


portfolio before change:  [4.65172843]
curr_Stock_Price:  90.54810831269617
curr_Factors:  [9.05481083e+01 4.24765847e-02]
mat_Sqrt:  [[ 1.86618278e+01  0.00000000e+00]
 [-8.24393933e-03  1.88892380e-02]]
grads:  [-0.00641543  3.08523657]
Stock Position:  -0.006415431237858176
Bond Position:  [5.23263359]


portfolio before change:  [4.6530863]
curr_Stock_Price:  90.43841097432994
curr_Factors:  [9.04384110e+01 4.41559203e-02]
mat_Sqrt:  [[ 1.90041038e+01  0.00000000e+00]
 [-8.40532405e-03  1.92590169e-02]]
grads:  [-0.02648558  6.76413871]
Stock Position:  -0.026485579075877792
Bond Position:  [7.04839999]


portfolio before change:  [4.67898836]
curr_Stock_Price:  89.49370991438511
curr_Factors:  [8.94937099e+01 4.40053449e-02]
mat_Sqrt:  [[ 1.87734991e+01  0.00000000e+00]
 [-8.39098038e-03  1.92261514e-02]]
grads:  [ 0.01545728 -0.31426437]
Stock Position:  0.015457278146228536
Bond Position:  [3.2956592]


portfolio before change:  [4.66325423]
curr_Stock_Price:  88.44914586959088
curr_Factors:  [8.84491459e+01 4.27023674e-02]
mat_Sqrt:  [[ 1.82776190e+01  0.00000000e+00]
 [-8.26582046e-03  1.89393740e-02]]
grads:  [ -0.10487256 -10.81780266]
Stock Position:  -0.10487255887853415
Bond Position:  [13.93914249]


portfolio before change:  [4.79067728]
curr_Stock_Price:  87.2507336972336
curr_Factors:  [8.72507337e+01 4.28738158e-02]
mat_Sqrt:  [[ 1.80661311e+01  0.00000000e+00]
 [-8.28239731e-03  1.89773563e-02]]
grads:  [ 0.03983655 38.46787062]
Stock Position:  0.03983654624810716
Bond Position:  [1.31490939]


portfolio before change:  [4.79017193]
curr_Stock_Price:  87.23392185705008
curr_Factors:  [8.72339219e+01 4.26974181e-02]
mat_Sqrt:  [[ 1.80254537e+01  0.00000000e+00]
 [-8.26534143e-03  1.89382764e-02]]
grads:  [ 8.76860938e-04 -8.47485377e+00]
Stock Position:  0.0008768609380713548
Bond Position:  [4.71367991]


portfolio before change:  [4.79104184]
curr_Stock_Price:  87.5539952264565
curr_Factors:  [8.75539952e+01 4.17835269e-02]
mat_Sqrt:  [[ 1.78969290e+01  0.00000000e+00]
 [-8.17640771e-03  1.87345036e-02]]
grads:  [ 0.01107148 -2.05572841]
Stock Position:  0.011071480612017265
Bond Position:  [3.82168948]


portfolio before change:  [4.78334517]
curr_Stock_Price:  86.81566501164043
curr_Factors:  [8.68156650e+01 4.13106208e-02]
mat_Sqrt:  [[ 1.76452964e+01  0.00000000e+00]
 [-8.13000574e-03  1.86281833e-02]]
grads:  [6.64862663e-03 9.69214574e+00]
Stock Position:  0.006648626628285417
Bond Position:  [4.20614023]


portfolio before change:  [4.7772025]
curr_Stock_Price:  85.81267974185104
curr_Factors:  [8.58126797e+01 3.98372695e-02]
mat_Sqrt:  [[ 1.71275895e+01  0.00000000e+00]
 [-7.98371036e-03  1.82929785e-02]]
grads:  [-0.12739481 23.32723082]
Stock Position:  -0.12739481281135556
Bond Position:  [15.70929277]


portfolio before change:  [4.67192624]
curr_Stock_Price:  86.6544725648687
curr_Factors:  [8.66544726e+01 3.91255777e-02]
mat_Sqrt:  [[ 1.71404163e+01  0.00000000e+00]
 [-7.91207459e-03  1.81288403e-02]]
grads:  [-0.01160952 -0.66841226]
Stock Position:  -0.01160952188514492
Bond Position:  [5.67794324]


portfolio before change:  [4.66811583]
curr_Stock_Price:  87.04382499664597
curr_Factors:  [8.70438250e+01 4.00992893e-02]
mat_Sqrt:  [[ 1.74303579e+01  0.00000000e+00]
 [-8.00992277e-03  1.83530387e-02]]
grads:  [-1.86209555e-02 -2.40334712e+01]
Stock Position:  -0.01862095549605639
Bond Position:  [6.28895502]


portfolio before change:  [4.66433536]
curr_Stock_Price:  87.28906679822192
curr_Factors:  [8.72890668e+01 3.93649557e-02]
mat_Sqrt:  [[ 1.73186779e+01  0.00000000e+00]
 [-7.93624150e-03  1.81842137e-02]]
grads:  [ 0.10749495 -7.44606468]
Stock Position:  0.10749495078220174
Bond Position:  [-4.71879857]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.64164875]
Stock Price:  87.08350622473645
PL:  [4.64164875]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.50656770e-01  4.46760707e-01]
 [-1.77150758e-01 -7.49149584e-02]
 [ 8.27157807e-01 -7.15487738e-01]
 [-3.28742955e-02  3.88559369e-02]
 [ 1.49500206e-02 -2.62321059e-03]
 [-7.95206700e-02 -1.06943769e-01]
 [-7.94946637e-02  1.54078409e-01]
 [-1.16624891e-01 -9.76890645e-02]
 [ 1.65965768e-01  1.02009907e-01]
 [-8.97257230e-03  2.42865251e-01]
 [ 2.04238516e-01  5.76266531e-01]
 [ 8.57146613e-02  3.53328874e-01]
 [ 4.15486822e-01  2.56267606e-02]
 [-4.26578710e-02  1.59187398e-01]
 [ 9.93656801e-02  2.47767297e-01]
 [ 3.14450013e-02  2.48412968e-01]
 [ 1.84325564e-01  4.78167278e-01]
 [ 1.48426195e-01  7.57371491e-02]
 [ 1.94778262e-02 -4.78313130e-02]
 [ 4.59951752e-01 -1.26656611e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-6.96607867e-03 -3.95215412e-02]
 [-7.50743745e-02 -3.94317201e-02]
 [ 3.54358584e-02 -1.67591371e-01]
 [ 3.01170847e-02  1.63721669e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 9.49013148e-02  1.73729093e-01]
 [-1.53775418e-01  7.68625544e-02]
 [-3.87781015e-01  5.66361059e-02]
 [ 2.57016023e-01 -1.05543676e-01]
 [-1.28623734e+00 -1.45962970e-01]
 [ 2.42448703e-02  2.39891742e-01]
 [ 1.20875271e-02 -1.35433995e-01]
 [ 1.32105220e-02  5.14508408e-02]
 [-2.14502232e-02  1.70413484e-01]
 [-2.42915269e+00  8.01256096e-02]
 [-1.37094691e-01  9.21000478e-02]
 [-1.34931501e-01 -2.09712968e-01]
 [ 1.77101993e+00 -1.15981195e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.28723752]
curr_Stock_Price:  100.38850575281944
curr_Factors:  [1.00388506e+02 3.94279476e-02]
mat_Sqrt:  [[ 1.99336154e+01  0.00000000e+00]
 [-7.94258876e-03  1.81987571e-02]]
grads:  [1.73395102e-02 2.45489681e+01]
Stock Position:  0.017339510197273186
Bond Position:  [3.54655]


portfolio before change:  [5.29219879]
curr_Stock_Price:  100.64906267269754
curr_Factors:  [1.00649063e+02 3.89498482e-02]
mat_Sqrt:  [[ 1.98638131e+01  0.00000000e+00]
 [-7.89428636e-03  1.80880824e-02]]
grads:  [-0.01056425 -4.14167498]
Stock Position:  -0.010564251970513052
Bond Position:  [6.35548085]


portfolio before change:  [5.30712343]
curr_Stock_Price:  99.3115183382312
curr_Factors:  [9.93115183e+01 3.89875402e-02]
mat_Sqrt:  [[ 1.96093203e+01  0.00000000e+00]
 [-7.89810511e-03  1.80968322e-02]]
grads:  [ 2.62575832e-02 -3.95366287e+01]
Stock Position:  0.02625758318428052
Bond Position:  [2.69944298]


portfolio before change:  [5.3197615]
curr_Stock_Price:  99.77997801491395
curr_Factors:  [9.97799780e+01 4.01834248e-02]
mat_Sqrt:  [[ 2.00016986e+01  0.00000000e+00]
 [-8.01832150e-03  1.83722826e-02]]
grads:  [-7.95741140e-04  2.11492158e+00]
Stock Position:  -0.0007957411396300061
Bond Position:  [5.39916054]


portfolio before change:  [5.32053564]
curr_Stock_Price:  99.6553129056034
curr_Factors:  [9.96553129e+01 3.92177125e-02]
mat_Sqrt:  [[ 1.97352025e+01  0.00000000e+00]
 [-7.92138498e-03  1.81501731e-02]]
grads:  [ 0.00069952 -0.14452813]
Stock Position:  0.0006995194320197105
Bond Position:  [5.25082481]


portfolio before change:  [5.31945718]
curr_Stock_Price:  97.17525275647809
curr_Factors:  [9.71752528e+01 4.02858662e-02]
mat_Sqrt:  [[ 1.95043747e+01  0.00000000e+00]
 [-8.02853572e-03  1.83956863e-02]]
grads:  [-0.00647007 -5.81352428]
Stock Position:  -0.006470074493013588
Bond Position:  [5.94818831]


portfolio before change:  [5.31533467]
curr_Stock_Price:  97.92734376217592
curr_Factors:  [9.79273438e+01 3.89934300e-02]
mat_Sqrt:  [[ 1.93374718e+01  0.00000000e+00]
 [-7.89870167e-03  1.80981991e-02]]
grads:  [-6.33450580e-04  8.51346636e+00]
Stock Position:  -0.0006334505799212171
Bond Position:  [5.3773668]


portfolio before change:  [5.31584327]
curr_Stock_Price:  98.18563327993083
curr_Factors:  [9.81856333e+01 3.97951410e-02]
mat_Sqrt:  [[ 1.95867766e+01  0.00000000e+00]
 [-7.97948780e-03  1.82833034e-02]]
grads:  [-0.00813099 -5.34307517]
Stock Position:  -0.008130990505299147
Bond Position:  [6.11418972]


portfolio before change:  [5.3207658]
curr_Stock_Price:  97.67423093237535
curr_Factors:  [9.76742309e+01 4.19893588e-02]
mat_Sqrt:  [[ 2.00147247e+01  0.00000000e+00]
 [-8.19652207e-03  1.87805914e-02]]
grads:  [0.01051658 5.43166636]
Stock Position:  0.01051658435347173
Bond Position:  [4.29356651]


portfolio before change:  [5.29979315]
curr_Stock_Price:  95.62894911851662
curr_Factors:  [9.56289491e+01 4.15837971e-02]
mat_Sqrt:  [[ 1.95007563e+01  0.00000000e+00]
 [-8.15684225e-03  1.86896735e-02]]
grads:  [4.97532053e-03 1.29946225e+01]
Stock Position:  0.004975320526724195
Bond Position:  [4.82400847]


portfolio before change:  [5.29214494]
curr_Stock_Price:  93.97051459798423
curr_Factors:  [9.39705146e+01 4.30683843e-02]
mat_Sqrt:  [[ 1.95016292e+01  0.00000000e+00]
 [-8.30116949e-03  1.90203688e-02]]
grads:  [2.33694244e-02 3.02973375e+01]
Stock Position:  0.023369424368836194
Bond Position:  [3.09610811]


portfolio before change:  [5.26989959]
curr_Stock_Price:  93.00205287785558
curr_Factors:  [9.30020529e+01 4.40735485e-02]
mat_Sqrt:  [[ 1.95245730e+01  0.00000000e+00]
 [-8.39748043e-03  1.92410449e-02]]
grads:  [1.22881061e-02 1.83632893e+01]
Stock Position:  0.01228810609147133
Bond Position:  [4.1270805]


portfolio before change:  [5.26502629]
curr_Stock_Price:  92.5634813604538
curr_Factors:  [9.25634814e+01 4.52315475e-02]
mat_Sqrt:  [[ 1.96861325e+01  0.00000000e+00]
 [-8.50708387e-03  1.94921779e-02]]
grads:  [0.0216737  1.31472023]
Stock Position:  0.021673696312032302
Bond Position:  [3.25883351]


portfolio before change:  [5.23365203]
curr_Stock_Price:  91.09711210537326
curr_Factors:  [9.10971121e+01 4.67029875e-02]
mat_Sqrt:  [[ 1.96868821e+01  0.00000000e+00]
 [-8.64434960e-03  1.98066932e-02]]
grads:  [1.36218651e-03 8.03705074e+00]
Stock Position:  0.0013621865149435687
Bond Position:  [5.10956077]


portfolio before change:  [5.23570515]
curr_Stock_Price:  92.13543012345583
curr_Factors:  [9.21354301e+01 4.53956717e-02]
mat_Sqrt:  [[ 1.96306143e+01  0.00000000e+00]
 [-8.52250402e-03  1.95275099e-02]]
grads:  [1.05702343e-02 1.26881153e+01]
Stock Position:  0.010570234341471736
Bond Position:  [4.26181206]


portfolio before change:  [5.24461989]
curr_Stock_Price:  92.92840961858296
curr_Factors:  [9.29284096e+01 4.70751694e-02]
mat_Sqrt:  [[ 2.01625033e+01  0.00000000e+00]
 [-8.67872520e-03  1.98854576e-02]]
grads:  [6.93670360e-03 1.24921927e+01]
Stock Position:  0.0069367035981174755
Bond Position:  [4.60000305]


portfolio before change:  [5.24407884]
curr_Stock_Price:  92.76751498582105
curr_Factors:  [9.27675150e+01 4.57923313e-02]
mat_Sqrt:  [[ 1.98514530e+01  0.00000000e+00]
 [-8.55965712e-03  1.96126383e-02]]
grads:  [1.97977888e-02 2.43805687e+01]
Stock Position:  0.019797788764350347
Bond Position:  [3.40748718]


portfolio before change:  [5.25428093]
curr_Stock_Price:  93.26131368549781
curr_Factors:  [9.32613137e+01 4.79676277e-02]
mat_Sqrt:  [[ 2.04256388e+01  0.00000000e+00]
 [-8.76060525e-03  2.00730683e-02]]
grads:  [0.00888494 3.77307285]
Stock Position:  0.008884941015431299
Bond Position:  [4.42565966]


portfolio before change:  [5.26017858]
curr_Stock_Price:  93.86282692251842
curr_Factors:  [9.38628269e+01 4.95014899e-02]
mat_Sqrt:  [[ 2.08834749e+01  0.00000000e+00]
 [-8.89957211e-03  2.03914814e-02]]
grads:  [-6.69175147e-05 -2.34565170e+00]
Stock Position:  -6.691751466752841e-05
Bond Position:  [5.26645965]


portfolio before change:  [5.26090795]
curr_Stock_Price:  92.80156104128386
curr_Factors:  [9.28015610e+01 5.03132927e-02]
mat_Sqrt:  [[ 2.08159699e+01  0.00000000e+00]
 [-8.97224990e-03  2.05580072e-02]]
grads:  [ 0.01944057 -6.16093818]
Stock Position:  0.019440567805507864
Bond Position:  [3.45679291]


portfolio before change:  [5.23325977]
curr_Stock_Price:  91.35714341089049
curr_Factors:  [9.13571434e+01 5.22316528e-02]
mat_Sqrt:  [[ 2.08789856e+01  0.00000000e+00]
 [-9.14169812e-03  2.09462618e-02]]
grads:  [ 0.00201775 -1.80356715]
Stock Position:  0.0020177517875061388
Bond Position:  [5.04892373]


portfolio before change:  [5.23294174]
curr_Stock_Price:  90.88672280504218
curr_Factors:  [9.08867228e+01 5.24925469e-02]
mat_Sqrt:  [[ 2.08232861e+01  0.00000000e+00]
 [-9.16450081e-03  2.09985093e-02]]
grads:  [-1.16286609e-03 -1.88211175e+00]
Stock Position:  -0.0011628660910504096
Bond Position:  [5.33863083]


portfolio before change:  [5.23261203]
curr_Stock_Price:  91.74414993549622
curr_Factors:  [9.17441499e+01 5.18118311e-02]
mat_Sqrt:  [[ 2.08829982e+01  0.00000000e+00]
 [-9.10488494e-03  2.08619122e-02]]
grads:  [-0.00441909 -1.89012971]
Stock Position:  -0.004419087099902968
Bond Position:  [5.63803742]


portfolio before change:  [5.22885594]
curr_Stock_Price:  92.75361001843292
curr_Factors:  [9.27536100e+01 5.14035165e-02]
mat_Sqrt:  [[ 2.10294172e+01  0.00000000e+00]
 [-9.06893745e-03  2.07795462e-02]]
grads:  [-1.79306028e-03 -8.06520845e+00]
Stock Position:  -0.0017930602762739269
Bond Position:  [5.39516876]


portfolio before change:  [5.22971457]
curr_Stock_Price:  92.65088428314341
curr_Factors:  [9.26508843e+01 5.20060191e-02]
mat_Sqrt:  [[ 2.11288750e+01  0.00000000e+00]
 [-9.12193130e-03  2.09009703e-02]]
grads:  [4.80721662e-03 7.83320902e+00]
Stock Position:  0.0048072166224615055
Bond Position:  [4.7843217]


portfolio before change:  [5.22901959]
curr_Stock_Price:  92.38189999503804
curr_Factors:  [9.2381900e+01 5.3095147e-02]
mat_Sqrt:  [[ 2.12869923e+01  0.00000000e+00]
 [-9.21695368e-03  2.11186940e-02]]
grads:  [5.89489763e-03 8.62120168e+00]
Stock Position:  0.005894897631070769
Bond Position:  [4.68443774]


portfolio before change:  [5.23438205]
curr_Stock_Price:  93.19224064270244
curr_Factors:  [9.31922406e+01 5.40804077e-02]
mat_Sqrt:  [[ 2.16720369e+01  0.00000000e+00]
 [-9.30207785e-03  2.13137379e-02]]
grads:  [7.87756628e-03 8.15103827e+00]
Stock Position:  0.007877566278241923
Bond Position:  [4.500254]


portfolio before change:  [5.22795125]
curr_Stock_Price:  92.30448357365825
curr_Factors:  [9.23044836e+01 5.34163665e-02]
mat_Sqrt:  [[ 2.13333947e+01  0.00000000e+00]
 [-9.24479240e-03  2.11824805e-02]]
grads:  [-0.00563576  3.62859083]
Stock Position:  -0.005635757957547381
Bond Position:  [5.74815698]


portfolio before change:  [5.22228212]
curr_Stock_Price:  93.43790671764198
curr_Factors:  [9.34379067e+01 5.37620375e-02]
mat_Sqrt:  [[ 2.16651131e+01  0.00000000e+00]
 [-9.27465687e-03  2.12509086e-02]]
grads:  [-0.01675796  2.66511456]
Stock Position:  -0.016757955071071817
Bond Position:  [6.78811036]


portfolio before change:  [5.24258773]
curr_Stock_Price:  92.27684337710856
curr_Factors:  [9.22768434e+01 5.26796090e-02]
mat_Sqrt:  [[ 2.11794170e+01  0.00000000e+00]
 [-9.18081556e-03  2.10358911e-02]]
grads:  [ 0.00996028 -5.01731422]
Stock Position:  0.009960282997849344
Bond Position:  [4.32348426]


portfolio before change:  [5.25760395]
curr_Stock_Price:  93.7301904803391
curr_Factors:  [9.37301905e+01 5.25404894e-02]
mat_Sqrt:  [[ 2.14845646e+01  0.00000000e+00]
 [-9.16868491e-03  2.10080963e-02]]
grads:  [-0.06283305 -6.94793893]
Stock Position:  -0.06283305386582826
Bond Position:  [11.14695806]


portfolio before change:  [5.19822662]
curr_Stock_Price:  94.69736917271443
curr_Factors:  [9.46973692e+01 5.27877355e-02]
mat_Sqrt:  [[ 2.17572714e+01  0.00000000e+00]
 [-9.19023269e-03  2.10574685e-02]]
grads:  [5.92639616e-03 1.13922403e+01]
Stock Position:  0.005926396159060787
Bond Position:  [4.63701249]


portfolio before change:  [5.18443]
curr_Stock_Price:  92.27156492792369
curr_Factors:  [9.22715649e+01 5.34919819e-02]
mat_Sqrt:  [[ 2.13408754e+01  0.00000000e+00]
 [-9.25133348e-03  2.11974680e-02]]
grads:  [-2.20331702e-03 -6.38915906e+00]
Stock Position:  -0.002203317017531002
Bond Position:  [5.38773351]


portfolio before change:  [5.18508749]
curr_Stock_Price:  92.27883818006241
curr_Factors:  [9.22788382e+01 5.32133105e-02]
mat_Sqrt:  [[ 2.12868920e+01  0.00000000e+00]
 [-9.22720417e-03  2.11421808e-02]]
grads:  [1.67546816e-03 2.43356356e+00]
Stock Position:  0.0016754681638120634
Bond Position:  [5.03047723]


portfolio before change:  [5.18558169]
curr_Stock_Price:  92.19847238604216
curr_Factors:  [9.21984724e+01 5.28857013e-02]
mat_Sqrt:  [[ 2.12027825e+01  0.00000000e+00]
 [-9.19875655e-03  2.10769991e-02]]
grads:  [2.49610251e-03 8.08528213e+00]
Stock Position:  0.0024961025118551325
Bond Position:  [4.95544485]


portfolio before change:  [5.18169495]
curr_Stock_Price:  90.39317430463974
curr_Factors:  [9.03931743e+01 5.24941940e-02]
mat_Sqrt:  [[ 2.07105329e+01  0.00000000e+00]
 [-9.16464459e-03  2.09988388e-02]]
grads:  [-0.11560219  3.81571622]
Stock Position:  -0.11560219253973407
Bond Position:  [15.63134409]


portfolio before change:  [5.2630082]
curr_Stock_Price:  89.70668897204847
curr_Factors:  [8.97066890e+01 5.08988612e-02]
mat_Sqrt:  [[ 2.02385251e+01  0.00000000e+00]
 [-9.02431038e-03  2.06772927e-02]]
grads:  [-0.00478785  4.45416376]
Stock Position:  -0.004787845654376284
Bond Position:  [5.69250998]


portfolio before change:  [5.26410976]
curr_Stock_Price:  89.62524120725966
curr_Factors:  [8.96252412e+01 5.09125738e-02]
mat_Sqrt:  [[ 2.02228734e+01  0.00000000e+00]
 [-9.02552591e-03  2.06800778e-02]]
grads:  [ -0.0111981 -10.140821 ]
Stock Position:  -0.011198099226801478
Bond Position:  [6.26774211]


portfolio before change:  [5.27679653]
curr_Stock_Price:  88.56227057384301
curr_Factors:  [8.85622706e+01 4.91812482e-02]
mat_Sqrt:  [[ 1.96403180e+01  0.00000000e+00]
 [-8.87073825e-03  2.03254147e-02]]
grads:  [ 0.0875954  -5.70621542]
Stock Position:  0.08759540388615496
Bond Position:  [-2.48085133]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.4976722]
Stock Price:  91.08735505563139
PL:  [5.4976722]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.26920662e-01  4.17445520e-01]
 [-2.18678941e-01 -7.20121698e-02]
 [ 7.83939211e-01 -6.58949071e-01]
 [-8.97021884e-03  2.13990227e-02]
 [-5.08043674e-02  2.36923439e-02]
 [-7.40674911e-02 -6.00150588e-02]
 [ 4.76096745e-03  3.14815020e-01]
 [ 2.25709371e-01 -2.09114028e-03]
 [ 1.44102180e-01  7.71057031e-02]
 [ 2.67506566e-01 -1.12814876e-01]
 [ 6.72191282e-02  1.15548038e-02]
 [-1.34548181e-01 -1.82516331e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-5.18524648e-01 -6.64513138e-01]
 [ 3.97484009e-02  5.80957634e-02]
 [ 5.48050017e-02 -2.09171807e-02]
 [-5.26922550e-02  2.55010370e-01]
 [-3.81237305e-02  1.28344164e-01]
 [ 1.49921103e-02  6.35496892e-02]
 [-4.20718572e-02 -7.24821458e-02]
 [ 1.80523735e-01  8.79666945e-02]
 [ 3.34543564e-02  1.54831685e-01]
 [ 4.72544794e-03  2.03016937e-01]
 [ 5.87578655e-02  1.77163852e-01]
 [ 4.08415837e-02  9.03649283e-02]
 [ 7.12955579e-01 -3.01072951e-01]
 [-4.50133275e-02  8.84983741e-02]
 [ 2.47437149e-03  5.33379543e-02]
 [-5.52659913e-03 -1.01043340e-01]
 [-1.69245493e-02 -1.44408361e-01]
 [-1.11087222e-01 -7.79882993e-02]
 [-1.17918057e-01 -6.71108029e-04]
 [ 2.01819521e-01  2.23429982e-01]
 [ 2.25468352e-01  2.82481766e-02]
 [-1.75666200e-01 -2.39977147e-01]
 [ 1.72676621e-01 -1.07130594e-01]
 [-2.06700604e-01  1.80675633e-01]
 [-1.14012697e-01  1.24137238e-01]
 [-2.84735854e-01  1.68645494e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.72301666]
curr_Stock_Price:  100.30352496014443
curr_Factors:  [1.00303525e+02 3.97270099e-02]
mat_Sqrt:  [[ 1.99921331e+01  0.00000000e+00]
 [-7.97265426e-03  1.82676458e-02]]
grads:  [1.54615229e-02 2.28516320e+01]
Stock Position:  0.015461522865131366
Bond Position:  [3.17217142]


portfolio before change:  [4.74592574]
curr_Stock_Price:  101.75956057472736
curr_Factors:  [1.01759561e+02 3.96427479e-02]
mat_Sqrt:  [[ 2.02608237e+01  0.00000000e+00]
 [-7.96419466e-03  1.82482625e-02]]
grads:  [-0.0123444  -3.94624803]
Stock Position:  -0.012344395854197466
Bond Position:  [6.00208603]


portfolio before change:  [4.76275157]
curr_Stock_Price:  100.45730764288315
curr_Factors:  [1.00457308e+02 4.05037285e-02]
mat_Sqrt:  [[ 2.02175738e+01  0.00000000e+00]
 [-8.05021525e-03  1.84453604e-02]]
grads:  [ 2.45504364e-02 -3.57243804e+01]
Stock Position:  0.024550436401396095
Bond Position:  [2.29648083]


portfolio before change:  [4.81036836]
curr_Stock_Price:  102.38516381796833
curr_Factors:  [1.02385164e+02 3.90675017e-02]
mat_Sqrt:  [[ 2.02369402e+01  0.00000000e+00]
 [-7.90620027e-03  1.81153806e-02]]
grads:  [1.82379513e-05 1.18126266e+00]
Stock Position:  1.8237951286617145e-05
Bond Position:  [4.80850106]


portfolio before change:  [4.81093297]
curr_Stock_Price:  100.38438420625182
curr_Factors:  [1.00384384e+02 3.99650974e-02]
mat_Sqrt:  [[ 2.00681157e+01  0.00000000e+00]
 [-7.99650898e-03  1.83223038e-02]]
grads:  [-0.00201634  1.2930876 ]
Stock Position:  -0.0020163418118495256
Bond Position:  [5.0133422]


portfolio before change:  [4.81101421]
curr_Stock_Price:  100.65490857947206
curr_Factors:  [1.00654909e+02 4.15600165e-02]
mat_Sqrt:  [[ 2.05197854e+01  0.00000000e+00]
 [-8.15450958e-03  1.86843287e-02]]
grads:  [-0.00488603 -3.21205326]
Stock Position:  -0.004886026254194177
Bond Position:  [5.30281673]


portfolio before change:  [4.80949642]
curr_Stock_Price:  101.10121807280075
curr_Factors:  [1.01101218e+02 4.18468337e-02]
mat_Sqrt:  [[ 2.06817693e+01  0.00000000e+00]
 [-8.18259946e-03  1.87486907e-02]]
grads:  [6.87356601e-03 1.67913069e+01]
Stock Position:  0.006873566009667568
Bond Position:  [4.11457052]


portfolio before change:  [4.81025094]
curr_Stock_Price:  101.13615897992825
curr_Factors:  [1.01136159e+02 4.12061215e-02]
mat_Sqrt:  [[ 2.05299232e+01  0.00000000e+00]
 [-8.11971640e-03  1.86046075e-02]]
grads:  [ 0.01094971 -0.11239905]
Stock Position:  0.010949710841106111
Bond Position:  [3.70283924]


portfolio before change:  [4.80364239]
curr_Stock_Price:  100.49034857105106
curr_Factors:  [1.00490349e+02 4.02346196e-02]
mat_Sqrt:  [[ 2.01569260e+01  0.00000000e+00]
 [-8.02342766e-03  1.83839823e-02]]
grads:  [0.0088185  4.19417849]
Stock Position:  0.008818500766420889
Bond Position:  [3.91746817]


portfolio before change:  [4.79841468]
curr_Stock_Price:  99.84200480114426
curr_Factors:  [9.98420048e+01 3.94472025e-02]
mat_Sqrt:  [[ 1.98299399e+01  0.00000000e+00]
 [-7.94452793e-03  1.82032003e-02]]
grads:  [ 0.0110071 -6.1975298]
Stock Position:  0.011007099308388321
Bond Position:  [3.69944382]


portfolio before change:  [4.81493]
curr_Stock_Price:  101.30041435300686
curr_Factors:  [1.01300414e+02 3.80873548e-02]
mat_Sqrt:  [[ 1.97697705e+01  0.00000000e+00]
 [-7.80639275e-03  1.78866928e-02]]
grads:  [0.00365518 0.64600001]
Stock Position:  0.0036551794068488876
Bond Position:  [4.44465881]


portfolio before change:  [4.81780952]
curr_Stock_Price:  101.93619801992921
curr_Factors:  [1.01936198e+02 3.78326847e-02]
mat_Sqrt:  [[ 1.98272285e+01  0.00000000e+00]
 [-7.78025035e-03  1.78267931e-02]]
grads:  [ -0.01080357 -10.23831543]
Stock Position:  -0.01080356935719348
Bond Position:  [5.91908431]


portfolio before change:  [4.8132781]
curr_Stock_Price:  102.4241245022401
curr_Factors:  [1.02424125e+02 3.71131566e-02]
mat_Sqrt:  [[ 1.97317774e+01  0.00000000e+00]
 [-7.70591010e-03  1.76564582e-02]]
grads:  [-6.12171002e-03  9.37513316e+00]
Stock Position:  -0.006121710016864989
Bond Position:  [5.44028889]


portfolio before change:  [4.81809196]
curr_Stock_Price:  101.74885930577875
curr_Factors:  [1.01748859e+02 3.71553637e-02]
mat_Sqrt:  [[ 1.96128320e+01  0.00000000e+00]
 [-7.71029065e-03  1.76664953e-02]]
grads:  [ -0.04122515 -37.61431612]
Stock Position:  -0.04122515089927284
Bond Position:  [9.01270404]


portfolio before change:  [4.77748514]
curr_Stock_Price:  102.76118975128124
curr_Factors:  [1.02761190e+02 3.60644505e-02]
mat_Sqrt:  [[ 1.95150103e+01  0.00000000e+00]
 [-7.59625703e-03  1.74052114e-02]]
grads:  [3.33607156e-03 3.33783727e+00]
Stock Position:  0.0033360715642378343
Bond Position:  [4.43466646]


portfolio before change:  [4.77375233]
curr_Stock_Price:  101.47608994896255
curr_Factors:  [1.01476090e+02 3.72211863e-02]
mat_Sqrt:  [[ 1.95775720e+01  0.00000000e+00]
 [-7.71711722e-03  1.76821369e-02]]
grads:  [ 0.00233308 -1.18295548]
Stock Position:  0.0023330776454215866
Bond Position:  [4.53700073]


portfolio before change:  [4.77469373]
curr_Stock_Price:  101.63649554638351
curr_Factors:  [1.01636496e+02 3.70195740e-02]
mat_Sqrt:  [[ 1.95553409e+01  0.00000000e+00]
 [-7.69618857e-03  1.76341833e-02]]
grads:  [2.99679741e-03 1.44611386e+01]
Stock Position:  0.0029967974094246854
Bond Position:  [4.47010974]


portfolio before change:  [4.77937836]
curr_Stock_Price:  103.0132435227368
curr_Factors:  [1.03013244e+02 3.66909006e-02]
mat_Sqrt:  [[ 1.97320518e+01  0.00000000e+00]
 [-7.66194760e-03  1.75557274e-02]]
grads:  [9.06659641e-04 7.31067197e+00]
Stock Position:  0.0009066596405341573
Bond Position:  [4.68598041]


portfolio before change:  [4.77842164]
curr_Stock_Price:  101.31193945286566
curr_Factors:  [1.01311939e+02 3.68855909e-02]
mat_Sqrt:  [[ 1.94575879e+01  0.00000000e+00]
 [-7.68224872e-03  1.76022431e-02]]
grads:  [2.19592833e-03 3.61031766e+00]
Stock Position:  0.002195928329176825
Bond Position:  [4.55594788]


portfolio before change:  [4.77772114]
curr_Stock_Price:  100.73358139983885
curr_Factors:  [1.00733581e+02 3.76364871e-02]
mat_Sqrt:  [[ 1.95424413e+01  0.00000000e+00]
 [-7.76005022e-03  1.77805088e-02]]
grads:  [-3.77156867e-03 -4.07649448e+00]
Stock Position:  -0.0037715686656619968
Bond Position:  [5.15764476]


portfolio before change:  [4.77577543]
curr_Stock_Price:  101.42041860699658
curr_Factors:  [1.01420419e+02 3.69621898e-02]
mat_Sqrt:  [[ 1.94986366e+01  0.00000000e+00]
 [-7.69022130e-03  1.76205106e-02]]
grads:  [0.01122722 4.99228975]
Stock Position:  0.011227223355888662
Bond Position:  [3.63710574]


portfolio before change:  [4.77719206]
curr_Stock_Price:  101.50610005741557
curr_Factors:  [1.01506100e+02 3.74867473e-02]
mat_Sqrt:  [[ 1.96530981e+01  0.00000000e+00]
 [-7.74459784e-03  1.77451029e-02]]
grads:  [5.14058614e-03 8.72531907e+00]
Stock Position:  0.005140586137883275
Bond Position:  [4.25539121]


portfolio before change:  [4.78524607]
curr_Stock_Price:  102.96936850315359
curr_Factors:  [1.02969369e+02 3.72738735e-02]
mat_Sqrt:  [[ 1.98797223e+01  0.00000000e+00]
 [-7.72257714e-03  1.76946471e-02]]
grads:  [4.69469854e-03 1.14733532e+01]
Stock Position:  0.004694698544640513
Bond Position:  [4.30183593]


portfolio before change:  [4.786975]
curr_Stock_Price:  103.22309344945599
curr_Factors:  [1.03223093e+02 3.78953847e-02]
mat_Sqrt:  [[ 2.00941681e+01  0.00000000e+00]
 [-7.78669478e-03  1.78415591e-02]]
grads:  [6.77203999e-03 9.92984140e+00]
Stock Position:  0.006772039986861392
Bond Position:  [4.08794408]


portfolio before change:  [4.78495855]
curr_Stock_Price:  102.8498719128117
curr_Factors:  [1.02849872e+02 3.88783882e-02]
mat_Sqrt:  [[ 2.02795298e+01  0.00000000e+00]
 [-7.88704134e-03  1.80714820e-02]]
grads:  [3.95867520e-03 5.00041604e+00]
Stock Position:  0.003958675203707523
Bond Position:  [4.37780932]


portfolio before change:  [4.78128868]
curr_Stock_Price:  101.7845834648003
curr_Factors:  [1.01784583e+02 3.81437835e-02]
mat_Sqrt:  [[ 1.98789705e+01  0.00000000e+00]
 [-7.81217343e-03  1.78999380e-02]]
grads:  [  0.02925486 -16.81977615]
Stock Position:  0.029254863678906663
Bond Position:  [1.80359457]


portfolio before change:  [4.7597092]
curr_Stock_Price:  101.03923903869473
curr_Factors:  [1.01039239e+02 3.94050163e-02]
mat_Sqrt:  [[ 2.00569930e+01  0.00000000e+00]
 [-7.94027872e-03  1.81934641e-02]]
grads:  [-3.18565729e-04  4.86429486e+00]
Stock Position:  -0.0003185657285203339
Bond Position:  [4.79189684]


portfolio before change:  [4.76018964]
curr_Stock_Price:  101.41148505769308
curr_Factors:  [1.01411485e+02 4.01042811e-02]
mat_Sqrt:  [[ 2.03087180e+01  0.00000000e+00]
 [-8.01042132e-03  1.83541810e-02]]
grads:  [1.26807429e-03 2.90603837e+00]
Stock Position:  0.001268074288834102
Bond Position:  [4.63159234]


portfolio before change:  [4.76248897]
curr_Stock_Price:  102.76814437981756
curr_Factors:  [1.02768144e+02 3.99958458e-02]
mat_Sqrt:  [[ 2.05525616e+01  0.00000000e+00]
 [-7.99958457e-03  1.83293509e-02]]
grads:  [-2.41456658e-03 -5.51265240e+00]
Stock Position:  -0.0024145665761159648
Bond Position:  [5.01062949]


portfolio before change:  [4.75993415]
curr_Stock_Price:  104.08564070180002
curr_Factors:  [1.04085641e+02 3.77826379e-02]
mat_Sqrt:  [[ 2.02319134e+01  0.00000000e+00]
 [-7.77510261e-03  1.78149981e-02]]
grads:  [-3.95165416e-03 -8.10599920e+00]
Stock Position:  -0.0039516541587954175
Bond Position:  [5.17124461]


portfolio before change:  [4.75890453]
curr_Stock_Price:  104.5097834131748
curr_Factors:  [1.04509783e+02 3.88054448e-02]
mat_Sqrt:  [[ 2.05874843e+01  0.00000000e+00]
 [-7.87963906e-03  1.80545212e-02]]
grads:  [-0.00704914 -4.31959941]
Stock Position:  -0.007049142273725511
Bond Position:  [5.49560886]


portfolio before change:  [4.77120582]
curr_Stock_Price:  102.86216578275331
curr_Factors:  [1.02862166e+02 3.89548123e-02]
mat_Sqrt:  [[ 2.03018784e+01  0.00000000e+00]
 [-7.89478940e-03  1.80892350e-02]]
grads:  [-0.00582266 -0.03709986]
Stock Position:  -0.00582266087454725
Bond Position:  [5.37013733]


portfolio before change:  [4.75998533]
curr_Stock_Price:  104.90449560951812
curr_Factors:  [1.04904496e+02 3.85515923e-02]
mat_Sqrt:  [[ 2.05975355e+01  0.00000000e+00]
 [-7.85382376e-03  1.79953709e-02]]
grads:  [ 0.01453244 12.41596982]
Stock Position:  0.01453243566197656
Bond Position:  [3.2354675]


portfolio before change:  [4.77535152]
curr_Stock_Price:  105.9340360504113
curr_Factors:  [1.05934036e+02 3.89295997e-02]
mat_Sqrt:  [[ 2.09014054e+01  0.00000000e+00]
 [-7.89223413e-03  1.80833802e-02]]
grads:  [0.01137708 1.5621071 ]
Stock Position:  0.011377075512621985
Bond Position:  [3.57013199]


portfolio before change:  [4.78943333]
curr_Stock_Price:  107.13254348626529
curr_Factors:  [1.07132543e+02 4.11101966e-02]
mat_Sqrt:  [[ 2.17218191e+01  0.00000000e+00]
 [-8.11025983e-03  1.85829398e-02]]
grads:  [-1.29087169e-02 -1.29138419e+01]
Stock Position:  -0.012908716902615216
Bond Position:  [6.172377]


portfolio before change:  [4.80003521]
curr_Stock_Price:  106.37102049742501
curr_Factors:  [1.06371020e+02 4.15091231e-02]
mat_Sqrt:  [[ 2.16718060e+01  0.00000000e+00]
 [-8.14951513e-03  1.86728850e-02]]
grads:  [ 0.00581036 -5.73722774]
Stock Position:  0.005810360101556966
Bond Position:  [4.18198127]


portfolio before change:  [4.80315823]
curr_Stock_Price:  106.81853838926989
curr_Factors:  [1.06818538e+02 4.07393097e-02]
mat_Sqrt:  [[ 2.15602337e+01  0.00000000e+00]
 [-8.07359248e-03  1.84989243e-02]]
grads:  [-5.92977309e-03  9.76681829e+00]
Stock Position:  -0.005929773088064262
Bond Position:  [5.43656792]


portfolio before change:  [4.79052428]
curr_Stock_Price:  109.06374409603283
curr_Factors:  [1.09063744e+02 3.92033702e-02]
mat_Sqrt:  [[ 2.15944479e+01  0.00000000e+00]
 [-7.91993638e-03  1.81468540e-02]]
grads:  [-2.77084022e-03  6.84070299e+00]
Stock Position:  -0.002770840217837906
Bond Position:  [5.09272249]


portfolio before change:  [4.78903693]
curr_Stock_Price:  109.83029011285198
curr_Factors:  [1.09830290e+02 3.70232213e-02]
mat_Sqrt:  [[ 2.11329065e+01  0.00000000e+00]
 [-7.69656768e-03  1.76350520e-02]]
grads:  [-0.00999072  9.56308459]
Stock Position:  -0.009990718781267968
Bond Position:  [5.88632047]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.78179679]
Stock Price:  110.62862896775435
PL:  [-5.84683218]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.93179550e-01  4.99876322e-01]
 [-2.55047132e-01 -6.24087123e-02]
 [ 7.49191294e-01 -6.35312071e-01]
 [-3.32592396e-02  3.96916193e-02]
 [-6.62986524e-03  6.01327251e-03]
 [-2.78210219e-02 -1.10315384e-02]
 [-7.90065086e-03  2.91550858e-01]
 [ 5.67067168e-02 -4.81879488e-02]
 [ 1.14541558e-01  8.65069267e-02]
 [ 2.83857635e-01 -1.24954255e-01]
 [ 7.03223040e-02  2.22695472e-02]
 [-1.20316161e-01 -1.88580922e-01]
 [-1.01448772e-01  1.35722960e-01]
 [-3.67399787e-01 -4.87040886e-01]
 [ 8.36886580e-02  2.28242245e-01]
 [ 5.32482098e-02 -1.99252666e-02]
 [-5.15447771e-02  1.90506922e-01]
 [-1.32516594e-01  2.94863093e-02]
 [ 1.49544430e-02  6.44849744e-02]
 [-3.97874941e-02 -7.35300011e-02]
 [ 1.75466270e-01  8.27500383e-02]
 [ 2.97331419e-02  1.35877969e-01]
 [ 4.08521391e-02  3.88932038e-01]
 [ 3.90799985e-02  1.70314047e-01]
 [ 3.50615573e-02  7.90115849e-02]
 [ 6.68475757e-01 -2.26467299e-01]
 [ 9.96498427e-03  8.09651344e-02]
 [-1.96512789e-01  1.42178942e-01]
 [-5.04282426e-02 -1.11612224e-01]
 [ 3.71758069e-02 -5.50136038e-02]
 [-6.90145888e-01 -8.85363990e-02]
 [-1.18091970e-01  6.08020490e-03]
 [ 9.62985453e-02  4.75884081e-02]
 [ 1.37340890e-01  7.34614544e-02]
 [-2.82110937e-01 -1.75309273e-01]
 [-1.52452698e-01 -4.10663559e-01]
 [-6.86257961e-02  2.97856012e-01]
 [-1.23683472e-01  1.17613136e-01]
 [ 3.14582160e-01  6.56597385e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.29940673]
curr_Stock_Price:  100.54095481898706
curr_Factors:  [1.00540955e+02 4.08455890e-02]
mat_Sqrt:  [[ 2.03196202e+01  0.00000000e+00]
 [-8.08411667e-03  1.85230383e-02]]
grads:  [2.02436590e-02 2.69867348e+01]
Stock Position:  0.020243658975920786
Bond Position:  [4.26408993]


portfolio before change:  [6.33370666]
curr_Stock_Price:  102.20897786011578
curr_Factors:  [1.02208978e+02 3.85031803e-02]
mat_Sqrt:  [[ 2.00556779e+01  0.00000000e+00]
 [-7.84889091e-03  1.79840683e-02]]
grads:  [-0.01407504 -3.47022215]
Stock Position:  -0.014075042920966525
Bond Position:  [7.77230241]


portfolio before change:  [6.35049956]
curr_Stock_Price:  101.08491023466051
curr_Factors:  [1.01084910e+02 3.96370571e-02]
mat_Sqrt:  [[ 2.01250529e+01  0.00000000e+00]
 [-7.96362301e-03  1.82469526e-02]]
grads:  [ 2.34492986e-02 -3.48174341e+01]
Stock Position:  0.023449298585164355
Bond Position:  [3.98012932]


portfolio before change:  [6.32013302]
curr_Stock_Price:  99.7687049838488
curr_Factors:  [9.97687050e+01 3.97618817e-02]
mat_Sqrt:  [[ 1.98942604e+01  0.00000000e+00]
 [-7.97615262e-03  1.82756616e-02]]
grads:  [-8.01054998e-04  2.17182941e+00]
Stock Position:  -0.0008010549977832411
Bond Position:  [6.40005324]


portfolio before change:  [6.32082792]
curr_Stock_Price:  99.89997938942237
curr_Factors:  [9.98999794e+01 4.02605621e-02]
mat_Sqrt:  [[ 2.00449656e+01  0.00000000e+00]
 [-8.02601392e-03  1.83899082e-02]]
grads:  [-1.99823638e-04  3.26987632e-01]
Stock Position:  -0.00019982363839135423
Bond Position:  [6.3407903]


portfolio before change:  [6.32132394]
curr_Stock_Price:  101.38444599807265
curr_Factors:  [1.01384446e+02 3.88752809e-02]
mat_Sqrt:  [[ 1.99897841e+01  0.00000000e+00]
 [-7.88672616e-03  1.80707598e-02]]
grads:  [-0.00163261 -0.61046345]
Stock Position:  -0.0016326129328927785
Bond Position:  [6.48684549]


portfolio before change:  [6.32415877]
curr_Stock_Price:  100.14475688179722
curr_Factors:  [1.00144757e+02 4.05855660e-02]
mat_Sqrt:  [[ 2.01750221e+01  0.00000000e+00]
 [-8.05834385e-03  1.84639853e-02]]
grads:  [5.91536281e-03 1.57902453e+01]
Stock Position:  0.005915362805645957
Bond Position:  [5.7317662]


portfolio before change:  [6.32226059]
curr_Stock_Price:  99.70273857400373
curr_Factors:  [9.97027386e+01 3.84060156e-02]
mat_Sqrt:  [[ 1.95391971e+01  0.00000000e+00]
 [-7.83898111e-03  1.79613622e-02]]
grads:  [ 1.82585659e-03 -2.68286717e+00]
Stock Position:  0.0018258565885217307
Bond Position:  [6.14021769]


portfolio before change:  [6.32684675]
curr_Stock_Price:  101.79412877254674
curr_Factors:  [1.01794129e+02 3.68259222e-02]
mat_Sqrt:  [[ 1.95343761e+01  0.00000000e+00]
 [-7.67603254e-03  1.75880001e-02]]
grads:  [0.00779632 4.9185198 ]
Stock Position:  0.007796321496705656
Bond Position:  [5.53322699]


portfolio before change:  [6.31576685]
curr_Stock_Price:  100.28423813450853
curr_Factors:  [1.00284238e+02 3.60766572e-02]
mat_Sqrt:  [[ 1.90478440e+01  0.00000000e+00]
 [-7.59754247e-03  1.74081567e-02]]
grads:  [ 0.01203932 -7.1779142 ]
Stock Position:  0.012039321994778614
Bond Position:  [5.10841262]


portfolio before change:  [6.32269292]
curr_Stock_Price:  100.80648329182488
curr_Factors:  [1.00806483e+02 3.54111345e-02]
mat_Sqrt:  [[ 1.89696092e+01  0.00000000e+00]
 [-7.52713858e-03  1.72468412e-02]]
grads:  [0.00421946 1.2912247 ]
Stock Position:  0.0042194612553672585
Bond Position:  [5.89734387]


portfolio before change:  [6.33001514]
curr_Stock_Price:  102.36711069503356
curr_Factors:  [1.02367111e+02 3.51238594e-02]
mat_Sqrt:  [[ 1.91849893e+01  0.00000000e+00]
 [-7.49654421e-03  1.71767406e-02]]
grads:  [-1.05613623e-02 -1.09788537e+01]
Stock Position:  -0.01056136232979722
Bond Position:  [7.41115129]


portfolio before change:  [6.34563849]
curr_Stock_Price:  100.97553811708895
curr_Factors:  [1.00975538e+02 3.43293752e-02]
mat_Sqrt:  [[ 1.87089376e+01  0.00000000e+00]
 [-7.41127522e-03  1.69813648e-02]]
grads:  [-2.25637700e-03  7.99246473e+00]
Stock Position:  -0.0022563769954932274
Bond Position:  [6.57347737]


portfolio before change:  [6.34866653]
curr_Stock_Price:  99.99773129145578
curr_Factors:  [9.99977313e+01 3.62792749e-02]
mat_Sqrt:  [[ 1.90466871e+01  0.00000000e+00]
 [-7.61884767e-03  1.74569731e-02]]
grads:  [ -0.03044949 -27.89950378]
Stock Position:  -0.030449487326393715
Bond Position:  [9.39354618]


portfolio before change:  [6.38443895]
curr_Stock_Price:  98.86148368550731
curr_Factors:  [9.88614837e+01 3.53069294e-02]
mat_Sqrt:  [[ 1.85762094e+01  0.00000000e+00]
 [-7.51605528e-03  1.72214461e-02]]
grads:  [9.86755352e-03 1.32533728e+01]
Stock Position:  0.009867553516841867
Bond Position:  [5.40891797]


portfolio before change:  [6.39479449]
curr_Stock_Price:  99.84241318280534
curr_Factors:  [9.98424132e+01 3.43103644e-02]
mat_Sqrt:  [[ 1.84938672e+01  0.00000000e+00]
 [-7.40922283e-03  1.69766622e-02]]
grads:  [ 0.00240902 -1.17368575]
Stock Position:  0.0024090207920178966
Bond Position:  [6.15427204]


portfolio before change:  [6.395383]
curr_Stock_Price:  99.76735613929868
curr_Factors:  [9.97673561e+01 3.56568275e-02]
mat_Sqrt:  [[ 1.88390853e+01  0.00000000e+00]
 [-7.55320621e-03  1.73065696e-02]]
grads:  [1.67732455e-03 1.10077807e+01]
Stock Position:  0.0016773245452976163
Bond Position:  [6.22804077]


portfolio before change:  [6.39869411]
curr_Stock_Price:  101.27723420217346
curr_Factors:  [1.01277234e+02 3.50347380e-02]
mat_Sqrt:  [[ 1.89566359e+01  0.00000000e+00]
 [-7.48702750e-03  1.71549351e-02]]
grads:  [-0.00631165  1.71882371]
Stock Position:  -0.0063116532964254445
Bond Position:  [7.0379209]


portfolio before change:  [6.39682464]
curr_Stock_Price:  101.71282010155817
curr_Factors:  [1.01712820e+02 3.57071217e-02]
mat_Sqrt:  [[ 1.92199882e+01  0.00000000e+00]
 [-7.55853125e-03  1.73187708e-02]]
grads:  [2.24235273e-03 3.72341520e+00]
Stock Position:  0.0022423527332658677
Bond Position:  [6.16874862]


portfolio before change:  [6.39531683]
curr_Stock_Price:  100.69649626471217
curr_Factors:  [1.00696496e+02 3.52168340e-02]
mat_Sqrt:  [[ 1.88968543e+01  0.00000000e+00]
 [-7.50645951e-03  1.71994595e-02]]
grads:  [-3.80373455e-03 -4.27513442e+00]
Stock Position:  -0.003803734545098279
Bond Position:  [6.77833957]


portfolio before change:  [6.39379352]
curr_Stock_Price:  101.3197388228012
curr_Factors:  [1.01319739e+02 3.43897854e-02]
mat_Sqrt:  [[ 1.87892219e+01  0.00000000e+00]
 [-7.41779325e-03  1.69962995e-02]]
grads:  [0.01126078 4.86870911]
Stock Position:  0.011260782888352302
Bond Position:  [5.25285394]


portfolio before change:  [6.39823915]
curr_Stock_Price:  101.65621481948553
curr_Factors:  [1.01656215e+02 3.49328768e-02]
mat_Sqrt:  [[ 1.89998911e+01  0.00000000e+00]
 [-7.47613556e-03  1.71299786e-02]]
grads:  [4.68608736e-03 7.93217392e+00]
Stock Position:  0.0046860873627704745
Bond Position:  [5.92186925]


portfolio before change:  [6.39801675]
curr_Stock_Price:  101.45078060435769
curr_Factors:  [1.01450781e+02 3.41551878e-02]
mat_Sqrt:  [[ 1.87492427e+01  0.00000000e+00]
 [-7.39244888e-03  1.69382283e-02]]
grads:  [1.12322401e-02 2.29617898e+01]
Stock Position:  0.011232240134433857
Bond Position:  [5.25849722]


portfolio before change:  [6.40863458]
curr_Stock_Price:  102.33755612636195
curr_Factors:  [1.02337556e+02 3.35645427e-02]
mat_Sqrt:  [[ 1.87488834e+01  0.00000000e+00]
 [-7.32825139e-03  1.67911333e-02]]
grads:  [6.04895449e-03 1.01430942e+01]
Stock Position:  0.006048954494899251
Bond Position:  [5.78959936]


portfolio before change:  [6.40974854]
curr_Stock_Price:  102.40206494873595
curr_Factors:  [1.02402065e+02 3.33729396e-02]
mat_Sqrt:  [[ 1.87070775e+01  0.00000000e+00]
 [-7.30730479e-03  1.67431387e-02]]
grads:  [3.71757909e-03 4.71904262e+00]
Stock Position:  0.0037175790850072906
Bond Position:  [6.02906076]


portfolio before change:  [6.40494744]
curr_Stock_Price:  100.90787444918782
curr_Factors:  [1.00907874e+02 3.34345962e-02]
mat_Sqrt:  [[ 1.84511356e+01  0.00000000e+00]
 [-7.31405181e-03  1.67585980e-02]]
grads:  [  0.03087275 -13.51349906]
Stock Position:  0.030872751581657892
Bond Position:  [3.2896437]


portfolio before change:  [6.36857213]
curr_Stock_Price:  99.71632066218237
curr_Factors:  [9.97163207e+01 3.32005425e-02]
mat_Sqrt:  [[ 1.81693268e+01  0.00000000e+00]
 [-7.28840641e-03  1.66998370e-02]]
grads:  [2.49327157e-03 4.84825895e+00]
Stock Position:  0.002493271569519461
Bond Position:  [6.11995226]


portfolio before change:  [6.36862436]
curr_Stock_Price:  99.43042462444654
curr_Factors:  [9.94304246e+01 3.38872230e-02]
mat_Sqrt:  [[ 1.83036324e+01  0.00000000e+00]
 [-7.36339303e-03  1.68716530e-02]]
grads:  [-7.34612722e-03  8.42709022e+00]
Stock Position:  -0.007346127215779495
Bond Position:  [7.0990529]


portfolio before change:  [6.37504631]
curr_Stock_Price:  98.67703213108247
curr_Factors:  [9.86770321e+01 3.40434556e-02]
mat_Sqrt:  [[ 1.82067696e+01  0.00000000e+00]
 [-7.38034748e-03  1.69105005e-02]]
grads:  [-5.44521696e-03 -6.60017274e+00]
Stock Position:  -0.005445216963268485
Bond Position:  [6.91236416]


portfolio before change:  [6.37318213]
curr_Stock_Price:  99.17807368168869
curr_Factors:  [9.91780737e+01 3.41583928e-02]
mat_Sqrt:  [[ 1.83300810e+01  0.00000000e+00]
 [-7.39279572e-03  1.69390230e-02]]
grads:  [ 7.18267522e-04 -3.24774362e+00]
Stock Position:  0.0007182675220952865
Bond Position:  [6.30194574]


portfolio before change:  [6.37433856]
curr_Stock_Price:  99.6913113994573
curr_Factors:  [9.96913114e+01 3.38856466e-02]
mat_Sqrt:  [[ 1.83512308e+01  0.00000000e+00]
 [-7.36322175e-03  1.68712605e-02]]
grads:  [-0.03971321 -5.24776432]
Stock Position:  -0.03971321309945588
Bond Position:  [10.33340086]


portfolio before change:  [6.37717265]
curr_Stock_Price:  99.65247467527078
curr_Factors:  [9.96524747e+01 3.32907023e-02]
mat_Sqrt:  [[ 1.81823313e+01  0.00000000e+00]
 [-7.29829594e-03  1.67224968e-02]]
grads:  [-0.00634893  0.36359432]
Stock Position:  -0.0063489301425332404
Bond Position:  [7.00985925]


portfolio before change:  [6.37026697]
curr_Stock_Price:  100.87818820231887
curr_Factors:  [1.00878188e+02 3.28131851e-02]
mat_Sqrt:  [[ 1.82734887e+01  0.00000000e+00]
 [-7.24576402e-03  1.66021310e-02]]
grads:  [0.00640643 2.86640359]
Stock Position:  0.006406430187891701
Bond Position:  [5.7239979]


portfolio before change:  [6.37182427]
curr_Stock_Price:  101.00957996851986
curr_Factors:  [1.0100958e+02 3.2029786e-02]
mat_Sqrt:  [[ 1.80775505e+01  0.00000000e+00]
 [-7.15874693e-03  1.64027498e-02]]
grads:  [0.00937085 4.47860603]
Stock Position:  0.00937085460241448
Bond Position:  [5.42527818]


portfolio before change:  [6.3804024]
curr_Stock_Price:  101.85261205807215
curr_Factors:  [1.01852612e+02 3.12948877e-02]
mat_Sqrt:  [[ 1.80180949e+01  0.00000000e+00]
 [-7.07614445e-03  1.62134838e-02]]
grads:  [ -0.01990345 -10.81256041]
Stock Position:  -0.01990344586792958
Bond Position:  [8.40762035]


portfolio before change:  [6.39111231]
curr_Stock_Price:  101.36732450512575
curr_Factors:  [1.01367325e+02 3.19716617e-02]
mat_Sqrt:  [[ 1.81251074e+01  0.00000000e+00]
 [-7.15224851e-03  1.63878601e-02]]
grads:  [-1.82995312e-02 -2.50590106e+01]
Stock Position:  -0.018299531232936928
Bond Position:  [8.24608683]


portfolio before change:  [6.41428476]
curr_Stock_Price:  100.15736868846271
curr_Factors:  [1.00157369e+02 3.24846000e-02]
mat_Sqrt:  [[ 1.80518480e+01  0.00000000e+00]
 [-7.20939388e-03  1.65187966e-02]]
grads:  [3.39960900e-03 1.80313385e+01]
Stock Position:  0.003399609003337004
Bond Position:  [6.07378887]


portfolio before change:  [6.41458084]
curr_Stock_Price:  100.02112052020598
curr_Factors:  [1.00021121e+02 3.16276198e-02]
mat_Sqrt:  [[ 1.77879119e+01  0.00000000e+00]
 [-7.11366232e-03  1.62994480e-02]]
grads:  [-4.06753145e-03  7.21577414e+00]
Stock Position:  -0.004067531451536043
Bond Position:  [6.82141989]


portfolio before change:  [6.4139031]
curr_Stock_Price:  100.39738696024763
curr_Factors:  [1.00397387e+02 3.13128592e-02]
mat_Sqrt:  [[ 1.77657592e+01  0.00000000e+00]
 [-7.07817594e-03  1.62181385e-02]]
grads:  [0.01932022 4.04853728]
Stock Position:  0.019320222377263822
Bond Position:  [4.47420325]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.40537313]
Stock Price:  99.92693311664348
PL:  [6.40537313]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-5.33344263e-01 -2.60275055e-01]
 [-1.72516334e-01 -8.50940911e-02]
 [ 9.19020611e-01 -9.33116732e-01]
 [-1.18970142e-03  2.90232795e-01]
 [ 2.59606277e-02 -7.58204539e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-9.91005467e-02  1.27467328e-01]
 [-7.11712695e-02 -7.73063218e-02]
 [ 1.46820517e-01  7.62411851e-02]
 [ 2.81335263e-01 -1.22738669e-01]
 [ 6.81828005e-02  1.48822020e-02]
 [-1.32073916e-01 -8.76508609e-02]
 [-5.17983857e-03  1.04162122e-01]
 [-3.27619852e-01 -4.40325644e-01]
 [ 8.40080255e-02  2.28522606e-01]
 [ 5.09847199e-02 -1.04506634e-02]
 [ 6.14146916e-04 -3.80908434e-02]
 [ 1.71209791e-02  5.29701410e-02]
 [ 1.59395784e-02  4.00239153e-02]
 [ 1.18519639e-01 -1.01153977e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 9.86392042e-02  3.12833523e-01]
 [ 3.75862744e-02  3.73082488e-01]
 [-5.02062970e-02  1.30283820e-01]
 [ 2.15139342e-02  4.99329340e-02]
 [ 6.51278701e-01 -2.13383094e-01]
 [-6.54438165e-02  1.06132826e-01]
 [-2.07483538e-01  1.47060057e-01]
 [-1.13903512e-01 -8.02788944e-02]
 [ 8.85661420e-02 -6.70219755e-02]
 [-8.29875432e-01 -1.00344765e-01]
 [-1.18120318e-01  7.18065582e-03]
 [ 1.05592886e-02 -9.19606090e-02]
 [ 9.36123680e-02  9.58961163e-02]
 [-2.24319074e-01 -2.82830900e-02]
 [-1.23038906e-01 -4.13963309e-01]
 [-1.32227747e-01  2.41080098e-01]
 [-1.21809474e-01  1.18877373e-01]
 [-9.57451060e-02  1.24095315e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.76001555]
curr_Stock_Price:  97.67029733902564
curr_Factors:  [9.76702973e+01 4.07260692e-02]
mat_Sqrt:  [[ 1.97105506e+01  0.00000000e+00]
 [-8.07228039e-03  1.84959180e-02]]
grads:  [ -0.03282189 -14.07202691]
Stock Position:  -0.032821894280334475
Bond Position:  [-9.55429138]


portfolio before change:  [-12.71560876]
curr_Stock_Price:  96.28094571652943
curr_Factors:  [9.62809457e+01 4.19398807e-02]
mat_Sqrt:  [[ 1.97175951e+01  0.00000000e+00]
 [-8.19169147e-03  1.87695231e-02]]
grads:  [-0.01063286 -4.53363096]
Stock Position:  -0.010632860605912899
Bond Position:  [-11.69186688]


portfolio before change:  [-12.71327967]
curr_Stock_Price:  95.92444155894471
curr_Factors:  [9.59244416e+01 4.38428925e-02]
mat_Sqrt:  [[ 2.00853257e+01  0.00000000e+00]
 [-8.37547778e-03  1.91906304e-02]]
grads:  [ 2.54800489e-02 -4.86235580e+01]
Stock Position:  0.025480048926192284
Bond Position:  [-15.15743914]


portfolio before change:  [-12.71108126]
curr_Stock_Price:  96.08508538027354
curr_Factors:  [9.60850854e+01 4.24260499e-02]
mat_Sqrt:  [[ 1.97912069e+01  0.00000000e+00]
 [-8.23903392e-03  1.88779983e-02]]
grads:  [6.34010223e-03 1.53741298e+01]
Stock Position:  0.006340102228038162
Bond Position:  [-13.32027052]


portfolio before change:  [-12.70453875]
curr_Stock_Price:  97.3796465426227
curr_Factors:  [9.73796465e+01 4.22902877e-02]
mat_Sqrt:  [[ 2.00257373e+01  0.00000000e+00]
 [-8.22584101e-03  1.88477695e-02]]
grads:  [-3.56048379e-04 -4.02278125e+00]
Stock Position:  -0.0003560483788711164
Bond Position:  [-12.66986688]


portfolio before change:  [-12.70674026]
curr_Stock_Price:  99.11447979360845
curr_Factors:  [9.91144798e+01 4.08801281e-02]
mat_Sqrt:  [[ 2.00397929e+01  0.00000000e+00]
 [-8.08753393e-03  1.85308682e-02]]
grads:  [-0.00590928 -3.57872752]
Stock Position:  -0.005909281197842987
Bond Position:  [-12.12104493]


portfolio before change:  [-12.6978058]
curr_Stock_Price:  97.346127040198
curr_Factors:  [9.73461270e+01 4.25242324e-02]
mat_Sqrt:  [[ 2.00741386e+01  0.00000000e+00]
 [-8.24856181e-03  1.88998294e-02]]
grads:  [-2.16543507e-03  6.74436396e+00]
Stock Position:  -0.002165435066602282
Bond Position:  [-12.48700908]


portfolio before change:  [-12.70276203]
curr_Stock_Price:  98.9140598270347
curr_Factors:  [9.89140598e+01 4.24205176e-02]
mat_Sqrt:  [[ 2.03725789e+01  0.00000000e+00]
 [-8.23849672e-03  1.88767674e-02]]
grads:  [-0.00514959 -4.09531569]
Stock Position:  -0.005149594205957904
Bond Position:  [-12.19339476]


portfolio before change:  [-12.71175943]
curr_Stock_Price:  100.36526839658897
curr_Factors:  [1.00365268e+02 4.11379625e-02]
mat_Sqrt:  [[ 2.03565811e+01  0.00000000e+00]
 [-8.11299821e-03  1.85892142e-02]]
grads:  [0.00884701 4.10136675]
Stock Position:  0.008847011053270643
Bond Position:  [-13.59969207]


portfolio before change:  [-12.71510894]
curr_Stock_Price:  100.17882764575339
curr_Factors:  [1.00178828e+02 4.22108410e-02]
mat_Sqrt:  [[ 2.05820177e+01  0.00000000e+00]
 [-8.21811083e-03  1.88300575e-02]]
grads:  [ 0.01106635 -6.51823125]
Stock Position:  0.01106634537415335
Bond Position:  [-13.82372245]


portfolio before change:  [-12.7060046]
curr_Stock_Price:  101.15768899466751
curr_Factors:  [1.01157689e+02 4.15192854e-02]
mat_Sqrt:  [[ 2.06121756e+01  0.00000000e+00]
 [-8.15051267e-03  1.86751706e-02]]
grads:  [0.003623   0.79689778]
Stock Position:  0.0036230006620818797
Bond Position:  [-13.07249897]


portfolio before change:  [-12.70869969]
curr_Stock_Price:  100.86485725356584
curr_Factors:  [1.00864857e+02 4.24537290e-02]
mat_Sqrt:  [[ 2.07825005e+01  0.00000000e+00]
 [-8.24172109e-03  1.88841554e-02]]
grads:  [-0.00819574 -4.64150285]
Stock Position:  -0.008195736024380606
Bond Position:  [-11.88203795]


portfolio before change:  [-12.70357558]
curr_Stock_Price:  100.05840660885889
curr_Factors:  [1.00058407e+02 4.28522330e-02]
mat_Sqrt:  [[ 2.07128715e+01  0.00000000e+00]
 [-8.28031236e-03  1.89725791e-02]]
grads:  [1.94469599e-03 5.49014033e+00]
Stock Position:  0.0019446959929024005
Bond Position:  [-12.89815877]


portfolio before change:  [-12.70614254]
curr_Stock_Price:  99.5675397399279
curr_Factors:  [9.95675397e+01 4.30183901e-02]
mat_Sqrt:  [[ 2.06511791e+01  0.00000000e+00]
 [-8.29635005e-03  1.90093261e-02]]
grads:  [ -0.02517017 -23.16366413]
Stock Position:  -0.025170171455057525
Bond Position:  [-10.20001049]


portfolio before change:  [-12.68736655]
curr_Stock_Price:  98.77091954598369
curr_Factors:  [9.87709195e+01 4.45820471e-02]
mat_Sqrt:  [[ 2.08549475e+01  0.00000000e+00]
 [-8.44578447e-03  1.93517233e-02]]
grads:  [8.81054569e-03 1.18089021e+01]
Stock Position:  0.008810545689252686
Bond Position:  [-13.55759225]


portfolio before change:  [-12.69644939]
curr_Stock_Price:  97.93237577086391
curr_Factors:  [9.79323758e+01 4.39336913e-02]
mat_Sqrt:  [[ 2.05269837e+01  0.00000000e+00]
 [-8.38414612e-03  1.92104921e-02]]
grads:  [ 0.00226159 -0.5440081 ]
Stock Position:  0.002261592697300205
Bond Position:  [-12.91793253]


portfolio before change:  [-12.69799518]
curr_Stock_Price:  97.9629057716319
curr_Factors:  [9.79629058e+01 4.40264849e-02]
mat_Sqrt:  [[ 2.05550560e+01  0.00000000e+00]
 [-8.39299565e-03  1.92307689e-02]]
grads:  [-7.78886714e-04 -1.98072389e+00]
Stock Position:  -0.000778886714048183
Bond Position:  [-12.62169318]


portfolio before change:  [-12.69950398]
curr_Stock_Price:  97.87430473230727
curr_Factors:  [9.78743047e+01 4.36840279e-02]
mat_Sqrt:  [[ 2.04564386e+01  0.00000000e+00]
 [-8.36028974e-03  1.91558303e-02]]
grads:  [1.96706008e-03 2.76522292e+00]
Stock Position:  0.0019670600832070156
Bond Position:  [-12.89202862]


portfolio before change:  [-12.70222731]
curr_Stock_Price:  97.3091354862476
curr_Factors:  [9.73091355e+01 4.49013440e-02]
mat_Sqrt:  [[ 2.06197447e+01  0.00000000e+00]
 [-8.47597490e-03  1.94208983e-02]]
grads:  [1.62016783e-03 2.06086839e+00]
Stock Position:  0.0016201678290726368
Bond Position:  [-12.85988444]


portfolio before change:  [-12.70299342]
curr_Stock_Price:  97.82851372474381
curr_Factors:  [9.78285137e+01 4.41558489e-02]
mat_Sqrt:  [[ 2.05569924e+01  0.00000000e+00]
 [-8.40531726e-03  1.92590013e-02]]
grads:  [ 3.61786503e-03 -5.25229607e+00]
Stock Position:  0.0036178650345637647
Bond Position:  [-13.05692378]


portfolio before change:  [-12.70081258]
curr_Stock_Price:  98.8824646352498
curr_Factors:  [9.88824646e+01 4.37848293e-02]
mat_Sqrt:  [[ 2.06909825e+01  0.00000000e+00]
 [-8.36992992e-03  1.91779187e-02]]
grads:  [ 0.00203609 -1.96986911]
Stock Position:  0.0020360855571670135
Bond Position:  [-12.90214574]


portfolio before change:  [-12.70107045]
curr_Stock_Price:  99.5479595561058
curr_Factors:  [9.95479596e+01 4.41047025e-02]
mat_Sqrt:  [[ 2.09061860e+01  0.00000000e+00]
 [-8.40044784e-03  1.92478441e-02]]
grads:  [1.12488689e-02 1.62529124e+01]
Stock Position:  0.011248868934256388
Bond Position:  [-13.8208724]


portfolio before change:  [-12.69413427]
curr_Stock_Price:  100.31816095971429
curr_Factors:  [1.00318161e+02 4.37193603e-02]
mat_Sqrt:  [[ 2.09756999e+01  0.00000000e+00]
 [-8.36367004e-03  1.91635755e-02]]
grads:  [9.55452366e-03 1.94683131e+01]
Stock Position:  0.00955452365737031
Bond Position:  [-13.65262651]


portfolio before change:  [-12.70762479]
curr_Stock_Price:  99.0848355583826
curr_Factors:  [9.90848356e+01 4.30084043e-02]
mat_Sqrt:  [[ 2.05486766e+01  0.00000000e+00]
 [-8.29538709e-03  1.90071196e-02]]
grads:  [3.23827369e-04 6.85447469e+00]
Stock Position:  0.00032382736884267456
Bond Position:  [-12.73971117]


portfolio before change:  [-12.70888294]
curr_Stock_Price:  100.1175166726377
curr_Factors:  [1.00117517e+02 4.29789228e-02]
mat_Sqrt:  [[ 2.07557214e+01  0.00000000e+00]
 [-8.29254342e-03  1.90006040e-02]]
grads:  [2.08648268e-03 2.62796562e+00]
Stock Position:  0.002086482684906245
Bond Position:  [-12.91777641]


portfolio before change:  [-12.70935655]
curr_Stock_Price:  100.66447185954868
curr_Factors:  [1.00664472e+02 4.42715919e-02]
mat_Sqrt:  [[ 2.11806259e+01  0.00000000e+00]
 [-8.41632622e-03  1.92842260e-02]]
grads:  [  0.02635194 -11.06516248]
Stock Position:  0.02635194479959737
Bond Position:  [-15.36206116]


portfolio before change:  [-12.69312544]
curr_Stock_Price:  101.35328225033933
curr_Factors:  [1.01353282e+02 4.59945631e-02]
mat_Sqrt:  [[ 2.17365726e+01  0.00000000e+00]
 [-8.57853723e-03  1.96558981e-02]]
grads:  [-8.79791592e-04  5.39954090e+00]
Stock Position:  -0.0008797915923963281
Bond Position:  [-12.60395567]


portfolio before change:  [-12.69268832]
curr_Stock_Price:  99.06557294723979
curr_Factors:  [9.90655729e+01 4.63145543e-02]
mat_Sqrt:  [[ 2.13197202e+01  0.00000000e+00]
 [-8.60832660e-03  1.97241541e-02]]
grads:  [-6.72153605e-03  7.45583591e+00]
Stock Position:  -0.006721536049324751
Bond Position:  [-12.0268155]


portfolio before change:  [-12.68496147]
curr_Stock_Price:  97.69233007515972
curr_Factors:  [9.76923301e+01 4.56552205e-02]
mat_Sqrt:  [[ 2.08740005e+01  0.00000000e+00]
 [-8.54683291e-03  1.95832544e-02]]
grads:  [-0.0071352  -4.09936433]
Stock Position:  -0.007135196401887574
Bond Position:  [-11.98790751]


portfolio before change:  [-12.68704718]
curr_Stock_Price:  97.77461642816752
curr_Factors:  [9.77746164e+01 4.47339846e-02]
mat_Sqrt:  [[ 2.06797323e+01  0.00000000e+00]
 [-8.46016402e-03  1.93846710e-02]]
grads:  [ 2.86828441e-03 -3.45747294e+00]
Stock Position:  0.0028682844100858924
Bond Position:  [-12.96749259]


portfolio before change:  [-12.68727173]
curr_Stock_Price:  98.26148989938842
curr_Factors:  [9.82614899e+01 4.49377150e-02]
mat_Sqrt:  [[ 2.08299793e+01  0.00000000e+00]
 [-8.47940705e-03  1.94287623e-02]]
grads:  [-0.04194289 -5.16475332]
Stock Position:  -0.04194288755347608
Bond Position:  [-8.5659011]


portfolio before change:  [-12.72839856]
curr_Stock_Price:  99.21650361055616
curr_Factors:  [9.92165036e+01 4.54825585e-02]
mat_Sqrt:  [[ 2.11595468e+01  0.00000000e+00]
 [-8.53065610e-03  1.95461887e-02]]
grads:  [-0.00543426  0.36736859]
Stock Position:  -0.0054342573396942255
Bond Position:  [-12.18923055]


portfolio before change:  [-12.72815042]
curr_Stock_Price:  98.8904438599791
curr_Factors:  [9.88904439e+01 4.45264885e-02]
mat_Sqrt:  [[ 2.08671698e+01  0.00000000e+00]
 [-8.44052022e-03  1.93396614e-02]]
grads:  [-1.41732740e-03 -4.75502684e+00]
Stock Position:  -0.0014173274036095487
Bond Position:  [-12.58799028]


portfolio before change:  [-12.72922732]
curr_Stock_Price:  98.5399953971109
curr_Factors:  [9.85399954e+01 4.38930842e-02]
mat_Sqrt:  [[ 2.06447956e+01  0.00000000e+00]
 [-8.38027057e-03  1.92016121e-02]]
grads:  [0.0065617  4.99417006]
Stock Position:  0.006561695605513081
Bond Position:  [-13.37581677]


portfolio before change:  [-12.72320587]
curr_Stock_Price:  99.71248650564753
curr_Factors:  [9.97124865e+01 4.41414083e-02]
mat_Sqrt:  [[ 2.09494506e+01  0.00000000e+00]
 [-8.40394272e-03  1.92558518e-02]]
grads:  [-0.01129685 -1.46880493]
Stock Position:  -0.011296851205996203
Bond Position:  [-11.59676874]


portfolio before change:  [-12.74569185]
curr_Stock_Price:  101.57462407235141
curr_Factors:  [1.01574624e+02 4.38566072e-02]
mat_Sqrt:  [[ 2.12717264e+01  0.00000000e+00]
 [-8.37678766e-03  1.91936318e-02]]
grads:  [-1.42775109e-02 -2.15677426e+01]
Stock Position:  -0.014277510868065287
Bond Position:  [-11.29545905]


portfolio before change:  [-12.75835286]
curr_Stock_Price:  102.36250578297684
curr_Factors:  [1.02362506e+02 4.33413836e-02]
mat_Sqrt:  [[ 2.13104340e+01  0.00000000e+00]
 [-8.32743741e-03  1.90805561e-02]]
grads:  [-1.2675371e-03  1.2634857e+01]
Stock Position:  -0.0012675371036315398
Bond Position:  [-12.62860458]


portfolio before change:  [-12.7601854]
curr_Stock_Price:  102.56279346064088
curr_Factors:  [1.02562793e+02 4.50397359e-02]
mat_Sqrt:  [[ 2.17664578e+01  0.00000000e+00]
 [-8.48902688e-03  1.94508041e-02]]
grads:  [-3.21260975e-03  6.11169453e+00]
Stock Position:  -0.003212609750101128
Bond Position:  [-12.43069117]


portfolio before change:  [-12.76665738]
curr_Stock_Price:  104.0936492963251
curr_Factors:  [1.04093649e+02 4.55727825e-02]
mat_Sqrt:  [[ 2.22216860e+01  0.00000000e+00]
 [-8.53911307e-03  1.95655660e-02]]
grads:  [-1.87139132e-03  6.34253643e+00]
Stock Position:  -0.0018713913178261682
Bond Position:  [-12.57185743]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.76852924]
Stock Price:  104.25410951304514
PL:  [-17.02263876]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-7.74189764e-02  1.64666309e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.71941584e-01 -8.18265823e-01]
 [-4.09084472e-02  1.04390053e-01]
 [ 1.24824716e-02 -1.63567317e-03]
 [-8.70596850e-02 -7.61829269e-02]
 [-7.77338404e-02  1.56468376e-01]
 [-5.32772179e-02 -1.16389024e-01]
 [ 1.64851602e-01  1.38487271e-01]
 [-7.64650145e-02  3.37484689e-01]
 [ 2.08093407e-01  5.94889171e-01]
 [ 9.82789318e-02  3.40147693e-01]
 [ 3.18644812e-01  2.37052301e-02]
 [ 1.07943667e-02  1.56448369e-01]
 [ 9.90922861e-02  2.43380707e-01]
 [ 2.95654931e-02  2.73410351e-01]
 [ 2.29618047e-01  6.12136350e-01]
 [ 1.61169041e-01  6.69343062e-02]
 [ 3.01698142e-02 -6.01003019e-02]
 [ 4.41355898e-01 -1.24487478e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.04294518e-02  3.43507802e-02]
 [-6.14778296e-02 -1.04910639e-01]
 [-1.61880014e-02 -2.82387942e-02]
 [ 4.09020379e-02  1.48023452e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 4.76758227e-02  1.65472729e-01]
 [-1.53247613e-01  7.69018410e-02]
 [-5.04315981e-01  1.10974091e-01]
 [ 2.55642285e-01 -1.05244978e-01]
 [-1.57788856e+00 -1.76982561e-01]
 [ 3.23981425e-01  5.92275105e-01]
 [ 6.65341365e-02 -1.53749793e-01]
 [ 1.78606569e-01 -2.71325241e-02]
 [ 1.14259714e-02  1.75349171e-01]
 [-2.60541853e+00  1.45861912e-01]
 [-1.47667883e-01  7.38433039e-02]
 [-1.34465710e-01 -2.56883239e-01]
 [ 1.53885156e+00 -8.57617699e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.13519922]
curr_Stock_Price:  99.57179901684212
curr_Factors:  [9.9571799e+01 4.0961237e-02]
mat_Sqrt:  [[ 2.01522195e+01  0.00000000e+00]
 [-8.09555305e-03  1.85492423e-02]]
grads:  [-2.75538255e-04  8.87725255e+00]
Stock Position:  -0.0002755382552321511
Bond Position:  [-0.10776338]


portfolio before change:  [-0.13501193]
curr_Stock_Price:  98.84320980810226
curr_Factors:  [9.88432098e+01 4.02477083e-02]
mat_Sqrt:  [[ 1.98297582e+01  0.00000000e+00]
 [-8.02473260e-03  1.83869723e-02]]
grads:  [-0.01023636 -4.7866157 ]
Stock Position:  -0.010236355174046915
Bond Position:  [0.87678227]


portfolio before change:  [-0.12316778]
curr_Stock_Price:  97.6968499140113
curr_Factors:  [9.76968499e+01 4.04702509e-02]
mat_Sqrt:  [[ 1.96538895e+01  0.00000000e+00]
 [-8.04688768e-03  1.84377360e-02]]
grads:  [ 2.61943623e-02 -4.43799512e+01]
Stock Position:  0.026194362296422354
Bond Position:  [-2.68227446]


portfolio before change:  [-0.09377547]
curr_Stock_Price:  98.83173612510791
curr_Factors:  [9.88317361e+01 4.02679425e-02]
mat_Sqrt:  [[ 1.98324398e+01  0.00000000e+00]
 [-8.02674953e-03  1.83915936e-02]]
grads:  [2.34520160e-04 5.67596559e+00]
Stock Position:  0.00023452016043969595
Bond Position:  [-0.1169535]


portfolio before change:  [-0.09358871]
curr_Stock_Price:  99.69039183120118
curr_Factors:  [9.96903918e+01 4.05229619e-02]
mat_Sqrt:  [[ 2.00679908e+01  0.00000000e+00]
 [-8.05212636e-03  1.84497393e-02]]
grads:  [ 0.00058644 -0.08865563]
Stock Position:  0.0005864366518275077
Bond Position:  [-0.15205081]


portfolio before change:  [-0.09415375]
curr_Stock_Price:  98.75928821101056
curr_Factors:  [9.87592882e+01 4.08176021e-02]
mat_Sqrt:  [[ 1.99527010e+01  0.00000000e+00]
 [-8.08134663e-03  1.85166913e-02]]
grads:  [-0.00602969 -4.11428401]
Stock Position:  -0.006029691923706165
Bond Position:  [0.50133433]


portfolio before change:  [-0.08938041]
curr_Stock_Price:  97.97804242283469
curr_Factors:  [9.79780424e+01 4.13331174e-02]
mat_Sqrt:  [[ 1.99194728e+01  0.00000000e+00]
 [-8.13221913e-03  1.86332549e-02]]
grads:  [-4.74181353e-04  8.39726486e+00]
Stock Position:  -0.00047418135253650325
Bond Position:  [-0.04292105]


portfolio before change:  [-0.08906371]
curr_Stock_Price:  97.29884469938222
curr_Factors:  [9.72988447e+01 4.05081358e-02]
mat_Sqrt:  [[ 1.95829814e+01  0.00000000e+00]
 [-8.05065322e-03  1.84463639e-02]]
grads:  [-5.31448965e-03 -6.30959165e+00]
Stock Position:  -0.005314489653730808
Bond Position:  [0.42802999]


portfolio before change:  [-0.07982346]
curr_Stock_Price:  95.57022220490093
curr_Factors:  [9.55702222e+01 4.19466925e-02]
mat_Sqrt:  [[ 1.95736337e+01  0.00000000e+00]
 [-8.19235668e-03  1.87710473e-02]]
grads:  [0.01150999 7.37770616]
Stock Position:  0.011509993775741616
Bond Position:  [-1.17983612]


portfolio before change:  [-0.09260488]
curr_Stock_Price:  94.47257374627013
curr_Factors:  [9.44725737e+01 4.21058591e-02]
mat_Sqrt:  [[ 1.93855003e+01  0.00000000e+00]
 [-8.20788490e-03  1.88066269e-02]]
grads:  [3.65352341e-03 1.79449877e+01]
Stock Position:  0.0036535234129347503
Bond Position:  [-0.43776264]


portfolio before change:  [-0.09536043]
curr_Stock_Price:  93.73333357831726
curr_Factors:  [9.37333336e+01 4.10736393e-02]
mat_Sqrt:  [[ 1.89965903e+01  0.00000000e+00]
 [-8.10665300e-03  1.85746755e-02]]
grads:  [2.46214884e-02 3.20268944e+01]
Stock Position:  0.024621488424482984
Bond Position:  [-2.40321462]


portfolio before change:  [-0.10159569]
curr_Stock_Price:  93.49229051137678
curr_Factors:  [9.34922905e+01 4.02051653e-02]
mat_Sqrt:  [[ 1.87463502e+01  0.00000000e+00]
 [-8.02049029e-03  1.83772519e-02]]
grads:  [1.31615783e-02 1.85091707e+01]
Stock Position:  0.013161578276021284
Bond Position:  [-1.33210179]


portfolio before change:  [-0.08768076]
curr_Stock_Price:  94.56218137996106
curr_Factors:  [9.45621814e+01 3.99848327e-02]
mat_Sqrt:  [[ 1.89088503e+01  0.00000000e+00]
 [-7.99848313e-03  1.83268272e-02]]
grads:  [0.01739876 1.29347158]
Stock Position:  0.017398763905161728
Bond Position:  [-1.73294583]


portfolio before change:  [-0.11345097]
curr_Stock_Price:  93.09348092979126
curr_Factors:  [9.30934809e+01 4.16245480e-02]
mat_Sqrt:  [[ 1.89930204e+01  0.00000000e+00]
 [-8.16083799e-03  1.86988289e-02]]
grads:  [4.16332058e-03 8.36674690e+00]
Stock Position:  0.004163320575675259
Bond Position:  [-0.50102897]


portfolio before change:  [-0.11242361]
curr_Stock_Price:  93.35528960076365
curr_Factors:  [9.33552896e+01 4.13169615e-02]
mat_Sqrt:  [[ 1.89759321e+01  0.00000000e+00]
 [-8.13062964e-03  1.86296129e-02]]
grads:  [1.08196179e-02 1.30641849e+01]
Stock Position:  0.010819617912669844
Bond Position:  [-1.12249217]


portfolio before change:  [-0.1224847]
curr_Stock_Price:  92.4383648142702
curr_Factors:  [9.24383648e+01 4.08734056e-02]
mat_Sqrt:  [[ 1.86884235e+01  0.00000000e+00]
 [-8.08686892e-03  1.85293445e-02]]
grads:  [7.96704725e-03 1.47555328e+01]
Stock Position:  0.00796704725063313
Bond Position:  [-0.85894552]


portfolio before change:  [-0.12892049]
curr_Stock_Price:  91.64404143127834
curr_Factors:  [9.16440414e+01 4.19863935e-02]
mat_Sqrt:  [[ 1.87783971e+01  0.00000000e+00]
 [-8.19623265e-03  1.87799283e-02]]
grads:  [2.64546676e-02 3.25952443e+01]
Stock Position:  0.026454667574757257
Bond Position:  [-2.55333314]


portfolio before change:  [-0.11609346]
curr_Stock_Price:  92.14097513665153
curr_Factors:  [9.21409751e+01 4.03836631e-02]
mat_Sqrt:  [[ 1.85163618e+01  0.00000000e+00]
 [-8.03827475e-03  1.84180013e-02]]
grads:  [0.0102818  3.63417861]
Stock Position:  0.010281802042794825
Bond Position:  [-1.06346873]


portfolio before change:  [-0.09998167]
curr_Stock_Price:  93.72092488835013
curr_Factors:  [9.37209249e+01 3.95949640e-02]
mat_Sqrt:  [[ 1.86490426e+01  0.00000000e+00]
 [-7.95939334e-03  1.82372612e-02]]
grads:  [ 2.11265112e-04 -3.29546751e+00]
Stock Position:  0.00021126511156805872
Bond Position:  [-0.11978163]


portfolio before change:  [-0.10012575]
curr_Stock_Price:  93.10982763683785
curr_Factors:  [9.31098276e+01 3.90058678e-02]
mat_Sqrt:  [[ 1.83891009e+01  0.00000000e+00]
 [-7.89996129e-03  1.81010853e-02]]
grads:  [ 0.02104644 -6.87734884]
Stock Position:  0.021046440030915662
Bond Position:  [-2.05975615]


portfolio before change:  [-0.08399271]
curr_Stock_Price:  93.88860649311862
curr_Factors:  [9.38886065e+01 3.77962526e-02]
mat_Sqrt:  [[ 1.82531266e+01  0.00000000e+00]
 [-7.77650334e-03  1.78182076e-02]]
grads:  [ 0.00230802 -2.12019023]
Stock Position:  0.0023080216142482702
Bond Position:  [-0.30068964]


portfolio before change:  [-0.08680567]
curr_Stock_Price:  92.68611884165858
curr_Factors:  [9.26861188e+01 3.81900423e-02]
mat_Sqrt:  [[ 1.81129741e+01  0.00000000e+00]
 [-7.81690909e-03  1.79107888e-02]]
grads:  [-3.00201515e-04  1.91788204e+00]
Stock Position:  -0.00030020151522323874
Bond Position:  [-0.05898115]


portfolio before change:  [-0.08671833]
curr_Stock_Price:  92.37064361906559
curr_Factors:  [9.23706436e+01 3.74385393e-02]
mat_Sqrt:  [[ 1.78728338e+01  0.00000000e+00]
 [-7.73961645e-03  1.77336891e-02]]
grads:  [-0.00600154 -5.91589477]
Stock Position:  -0.006001543299714992
Bond Position:  [0.46764808]


portfolio before change:  [-0.09942812]
curr_Stock_Price:  94.4981375444736
curr_Factors:  [9.44981375e+01 3.68242163e-02]
mat_Sqrt:  [[ 1.81338494e+01  0.00000000e+00]
 [-7.67585475e-03  1.75875927e-02]]
grads:  [-1.57233144e-03 -1.60560884e+00]
Stock Position:  -0.001572331437479843
Bond Position:  [0.04915427]


portfolio before change:  [-0.09904339]
curr_Stock_Price:  94.25736004850411
curr_Factors:  [9.42573600e+01 3.82387271e-02]
mat_Sqrt:  [[ 1.84317676e+01  0.00000000e+00]
 [-7.82189001e-03  1.79222015e-02]]
grads:  [5.72407223e-03 8.25922263e+00]
Stock Position:  0.005724072229264126
Bond Position:  [-0.63857933]


portfolio before change:  [-0.10553542]
curr_Stock_Price:  93.13714301123365
curr_Factors:  [9.31371430e+01 3.91238341e-02]
mat_Sqrt:  [[ 1.84222901e+01  0.00000000e+00]
 [-7.91189830e-03  1.81284364e-02]]
grads:  [6.81156578e-03 1.00432556e+01]
Stock Position:  0.006811565779703178
Bond Position:  [-0.7399452]


portfolio before change:  [-0.11575266]
curr_Stock_Price:  91.65073945454063
curr_Factors:  [9.16507395e+01 3.94244372e-02]
mat_Sqrt:  [[ 1.81977932e+01  0.00000000e+00]
 [-7.94223517e-03  1.81979469e-02]]
grads:  [6.58838361e-03 9.09293391e+00]
Stock Position:  0.006588383611521021
Bond Position:  [-0.71958289]


portfolio before change:  [-0.11150505]
curr_Stock_Price:  92.30910463372915
curr_Factors:  [9.23091046e+01 3.92331400e-02]
mat_Sqrt:  [[ 1.82839941e+01  0.00000000e+00]
 [-7.92294288e-03  1.81537427e-02]]
grads:  [-0.00654588  4.23614249]
Stock Position:  -0.006545883676316478
Bond Position:  [0.49273961]


portfolio before change:  [-0.10579571]
curr_Stock_Price:  91.44631100681104
curr_Factors:  [9.14463110e+01 4.10112193e-02]
mat_Sqrt:  [[ 1.85190000e+01  0.00000000e+00]
 [-8.10049078e-03  1.85605561e-02]]
grads:  [-0.02461704  5.97902832]
Stock Position:  -0.024617037485853165
Bond Position:  [2.14534156]


portfolio before change:  [-0.12805061]
curr_Stock_Price:  92.3612498635455
curr_Factors:  [9.23612499e+01 3.95892049e-02]
mat_Sqrt:  [[ 1.83771513e+01  0.00000000e+00]
 [-7.95881447e-03  1.82359349e-02]]
grads:  [ 0.01141143 -5.771296  ]
Stock Position:  0.011411431907833785
Bond Position:  [-1.18202472]


portfolio before change:  [-0.14474494]
curr_Stock_Price:  90.91125016086325
curr_Factors:  [9.09112502e+01 3.95744621e-02]
mat_Sqrt:  [[ 1.80852760e+01  0.00000000e+00]
 [-7.95733243e-03  1.82325391e-02]]
grads:  [-0.0915181  -9.70696181]
Stock Position:  -0.0915180991325099
Bond Position:  [8.17527986]


portfolio before change:  [-0.1017191]
curr_Stock_Price:  90.45228223315594
curr_Factors:  [9.04522822e+01 3.92017207e-02]
mat_Sqrt:  [[ 1.79090312e+01  0.00000000e+00]
 [-7.91976976e-03  1.81464722e-02]]
grads:  [3.25238962e-02 3.26385811e+01]
Stock Position:  0.03252389615672847
Bond Position:  [-3.04357973]


portfolio before change:  [-0.16410122]
curr_Stock_Price:  88.54594085739296
curr_Factors:  [8.85459409e+01 3.90599192e-02]
mat_Sqrt:  [[ 1.74998500e+01  0.00000000e+00]
 [-7.90543299e-03  1.81136225e-02]]
grads:  [-3.24445189e-05 -8.48807533e+00]
Stock Position:  -3.244451892234857e-05
Bond Position:  [-0.16122839]


portfolio before change:  [-0.16410267]
curr_Stock_Price:  87.96965678543908
curr_Factors:  [8.79696568e+01 3.95973188e-02]
mat_Sqrt:  [[ 1.75051480e+01  0.00000000e+00]
 [-7.95963002e-03  1.82378035e-02]]
grads:  [ 0.00952662 -1.48770789]
Stock Position:  0.009526624089593436
Bond Position:  [-1.00215653]


portfolio before change:  [-0.15178055]
curr_Stock_Price:  89.27624808374438
curr_Factors:  [8.92762481e+01 3.94254997e-02]
mat_Sqrt:  [[ 1.77265628e+01  0.00000000e+00]
 [-7.94234219e-03  1.81981921e-02]]
grads:  [4.96174159e-03 9.63552698e+00]
Stock Position:  0.00496174158620827
Bond Position:  [-0.59474622]


portfolio before change:  [-0.15146778]
curr_Stock_Price:  89.3542686107303
curr_Factors:  [8.93542686e+01 3.97012246e-02]
mat_Sqrt:  [[ 1.78039865e+01  0.00000000e+00]
 [-7.97006645e-03  1.82617164e-02]]
grads:  [-0.14276349  7.98730571]
Stock Position:  -0.1427634859677621
Bond Position:  [12.6050591]


portfolio before change:  [-0.11824501]
curr_Stock_Price:  89.13259399555196
curr_Factors:  [8.91325940e+01 3.91248594e-02]
mat_Sqrt:  [[ 1.76304315e+01  0.00000000e+00]
 [-7.91200196e-03  1.81286739e-02]]
grads:  [-0.00654777  4.07328766]
Stock Position:  -0.006547770735169113
Bond Position:  [0.46537478]


portfolio before change:  [-0.11818619]
curr_Stock_Price:  89.13249564004799
curr_Factors:  [8.91324956e+01 4.03604141e-02]
mat_Sqrt:  [[ 1.79066306e+01  0.00000000e+00]
 [-8.03596059e-03  1.84126988e-02]]
grads:  [-1.37702482e-02 -1.39514170e+01]
Stock Position:  -0.01377024821563719
Bond Position:  [1.1091904]


portfolio before change:  [-0.13881655]
curr_Stock_Price:  90.64074871113799
curr_Factors:  [9.06407487e+01 3.91916692e-02]
mat_Sqrt:  [[ 1.79440456e+01  0.00000000e+00]
 [-7.91875437e-03  1.81441457e-02]]
grads:  [ 0.08367244 -4.726691  ]
Stock Position:  0.0836724386145247
Bond Position:  [-7.72294903]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.16847029]
Stock Price:  90.29788419945491
PL:  [-0.16847029]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-6.58176713e-01 -2.85181080e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.18005426e-01 -6.99674417e-01]
 [-4.61778012e-02  7.97349136e-02]
 [ 3.96099055e-02 -3.11506964e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-3.69407777e-02  2.11836833e-01]
 [ 2.11836838e-01 -2.07968013e-03]
 [ 1.34595677e-01  8.01290754e-02]
 [ 2.38824359e-01 -8.46483712e-02]
 [ 6.94899036e-02  1.93954090e-02]
 [-1.33172984e-01 -1.86086285e-01]
 [-1.01048659e-02  1.06150528e-01]
 [-1.63286944e-01 -1.93412485e-01]
 [ 8.60124203e-02  2.30119983e-01]
 [ 5.30133787e-02 -1.97756433e-02]
 [-4.84413263e-02  1.46210894e-01]
 [-1.74990706e-02  4.18821424e-02]
 [ 1.57624978e-02  4.44208514e-02]
 [ 8.17137253e-02 -9.87740425e-02]
 [ 6.88665421e-02 -2.72050816e-02]
 [ 8.68091483e-02  3.05320361e-01]
 [ 3.60793398e-02  2.86228078e-01]
 [-6.22653288e-02  1.21927471e-01]
 [ 2.79816316e-02  6.98513695e-02]
 [ 2.92213804e-01 -1.51374047e-02]
 [ 1.61810957e-02  2.12890570e-01]
 [-2.02776286e-01  1.44851671e-01]
 [-3.79702575e-02 -1.17924549e-01]
 [ 4.82575151e-02 -5.76032493e-02]
 [-9.03696349e-01 -1.05445287e-01]
 [-1.19021315e-01  1.80333472e-02]
 [ 3.64042464e-02 -6.58967097e-02]
 [ 8.16824613e-02  1.02016685e-01]
 [-1.99182157e-01  1.79546450e-02]
 [-2.74364500e-01 -3.82536631e-01]
 [-8.32704765e-02  2.84783062e-01]
 [-1.21928384e-01  1.18797154e-01]
 [ 5.52148512e-02  9.83098771e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.64394757]
curr_Stock_Price:  97.08531431399842
curr_Factors:  [9.70853143e+01 4.19179660e-02]
mat_Sqrt:  [[ 1.98771283e+01  0.00000000e+00]
 [-8.18955100e-03  1.87646187e-02]]
grads:  [ -0.03937389 -15.19780841]
Stock Position:  -0.039373893816215595
Bond Position:  [-12.82132071]


portfolio before change:  [-16.69513602]
curr_Stock_Price:  98.34466880641563
curr_Factors:  [9.83446688e+01 4.14417323e-02]
mat_Sqrt:  [[ 2.00202627e+01  0.00000000e+00]
 [-8.14289701e-03  1.86577210e-02]]
grads:  [-0.01013895 -4.71715545]
Stock Position:  -0.010138950254557199
Bond Position:  [-15.69802432]


portfolio before change:  [-16.70963132]
curr_Stock_Price:  99.58078551283651
curr_Factors:  [9.95807855e+01 4.12069587e-02]
mat_Sqrt:  [[ 2.02143988e+01  0.00000000e+00]
 [-8.11979889e-03  1.86047965e-02]]
grads:  [ 2.53602633e-02 -3.76072061e+01]
Stock Position:  0.02536026330174147
Bond Position:  [-19.23502627]


portfolio before change:  [-16.72181102]
curr_Stock_Price:  99.19533328990143
curr_Factors:  [9.91953333e+01 4.05686103e-02]
mat_Sqrt:  [[ 1.99795778e+01  0.00000000e+00]
 [-8.05666038e-03  1.84601280e-02]]
grads:  [-5.69513131e-04  4.31930448e+00]
Stock Position:  -0.0005695131314185039
Bond Position:  [-16.66531798]


portfolio before change:  [-16.72355328]
curr_Stock_Price:  98.59650917088614
curr_Factors:  [9.85965092e+01 4.19859909e-02]
mat_Sqrt:  [[ 2.02029013e+01  0.00000000e+00]
 [-8.19619336e-03  1.87798382e-02]]
grads:  [ 1.28766787e-03 -1.65873081e+00]
Stock Position:  0.0012876678743192907
Bond Position:  [-16.85051284]


portfolio before change:  [-16.72485589]
curr_Stock_Price:  99.22076454626476
curr_Factors:  [9.92207645e+01 4.24437660e-02]
mat_Sqrt:  [[ 2.04413477e+01  0.00000000e+00]
 [-8.24075395e-03  1.88819394e-02]]
grads:  [-0.0057932  -3.51218838]
Stock Position:  -0.005793197863758001
Bond Position:  [-16.15005037]


portfolio before change:  [-16.72665125]
curr_Stock_Price:  99.18217974145747
curr_Factors:  [9.91821797e+01 4.31444184e-02]
mat_Sqrt:  [[ 2.06013632e+01  0.00000000e+00]
 [-8.30849382e-03  1.90371509e-02]]
grads:  [2.69459820e-03 1.11275492e+01]
Stock Position:  0.0026945981982214296
Bond Position:  [-16.99390737]


portfolio before change:  [-16.72419248]
curr_Stock_Price:  100.8830397550516
curr_Factors:  [1.0088304e+02 4.2697528e-02]
mat_Sqrt:  [[ 2.08458460e+01  0.00000000e+00]
 [-8.26535207e-03  1.89383008e-02]]
grads:  [ 0.01011852 -0.10981345]
Stock Position:  0.010118523870660109
Bond Position:  [-17.74497993]


portfolio before change:  [-16.72594642]
curr_Stock_Price:  100.92892798403626
curr_Factors:  [1.00928928e+02 4.22469326e-02]
mat_Sqrt:  [[ 2.07449910e+01  0.00000000e+00]
 [-8.22162345e-03  1.88381059e-02]]
grads:  [0.00817387 4.25356327]
Stock Position:  0.008173870598761028
Bond Position:  [-17.55092642]


portfolio before change:  [-16.7406623]
curr_Stock_Price:  99.39698819493228
curr_Factors:  [9.93969882e+01 4.30585990e-02]
mat_Sqrt:  [[ 2.06254377e+01  0.00000000e+00]
 [-8.30022641e-03  1.90182079e-02]]
grads:  [ 0.00978795 -4.45091208]
Stock Position:  0.009787951374836432
Bond Position:  [-17.71355519]


portfolio before change:  [-16.72762886]
curr_Stock_Price:  100.95479879035486
curr_Factors:  [1.00954799e+02 4.24554928e-02]
mat_Sqrt:  [[ 2.08014644e+01  0.00000000e+00]
 [-8.24189229e-03  1.88845476e-02]]
grads:  [0.00374756 1.02705182]
Stock Position:  0.003747560867585063
Bond Position:  [-17.10596311]


portfolio before change:  [-16.72591098]
curr_Stock_Price:  101.98380459428866
curr_Factors:  [1.01983805e+02 4.19703635e-02]
mat_Sqrt:  [[ 2.08930852e+01  0.00000000e+00]
 [-8.19466787e-03  1.87763429e-02]]
grads:  [-0.01026118 -9.91067782]
Stock Position:  -0.010261179494079037
Bond Position:  [-15.67943685]


portfolio before change:  [-16.70863052]
curr_Stock_Price:  100.10872677128482
curr_Factors:  [1.00108727e+02 4.33412760e-02]
mat_Sqrt:  [[ 2.08412030e+01  0.00000000e+00]
 [-8.32742707e-03  1.90805324e-02]]
grads:  [1.73804855e-03 5.56328962e+00]
Stock Position:  0.0017380485494079675
Bond Position:  [-16.88262435]


portfolio before change:  [-16.71590339]
curr_Stock_Price:  97.13849337349114
curr_Factors:  [9.71384934e+01 4.35251458e-02]
mat_Sqrt:  [[ 2.02656940e+01  0.00000000e+00]
 [-8.34507239e-03  1.91209630e-02]]
grads:  [ -0.01222258 -10.11520628]
Stock Position:  -0.012222580313964186
Bond Position:  [-15.52862035]


portfolio before change:  [-16.73126808]
curr_Stock_Price:  98.23674682987827
curr_Factors:  [9.82367468e+01 4.38650226e-02]
mat_Sqrt:  [[ 2.05746829e+01  0.00000000e+00]
 [-8.37759131e-03  1.91954732e-02]]
grads:  [9.06186576e-03 1.19882423e+01]
Stock Position:  0.009061865757930151
Bond Position:  [-17.62147629]


portfolio before change:  [-16.72105348]
curr_Stock_Price:  99.60704133908793
curr_Factors:  [9.96070413e+01 4.25412254e-02]
mat_Sqrt:  [[ 2.05444746e+01  0.00000000e+00]
 [-8.25020974e-03  1.89036053e-02]]
grads:  [ 0.00216032 -1.04613078]
Stock Position:  0.002160317133685884
Bond Position:  [-16.93623628]


portfolio before change:  [-16.72379802]
curr_Stock_Price:  99.31662818499557
curr_Factors:  [9.93166282e+01 4.11898367e-02]
mat_Sqrt:  [[ 2.01565872e+01  0.00000000e+00]
 [-8.11811177e-03  1.86009308e-02]]
grads:  [7.62546707e-04 7.86040736e+00]
Stock Position:  0.0007625467074432915
Bond Position:  [-16.79953159]


portfolio before change:  [-16.72633782]
curr_Stock_Price:  98.73997974015892
curr_Factors:  [9.87399797e+01 4.15661389e-02]
mat_Sqrt:  [[ 2.01308854e+01  0.00000000e+00]
 [-8.15511019e-03  1.86857049e-02]]
grads:  [3.87362427e-05 2.24140019e+00]
Stock Position:  3.8736242655821126e-05
Bond Position:  [-16.73016263]


portfolio before change:  [-16.72846404]
curr_Stock_Price:  97.84113316326903
curr_Factors:  [9.78411332e+01 4.28514519e-02]
mat_Sqrt:  [[ 2.02536940e+01  0.00000000e+00]
 [-8.28023689e-03  1.89724062e-02]]
grads:  [1.73545363e-03 2.34133989e+00]
Stock Position:  0.0017354536283828352
Bond Position:  [-16.89826279]


portfolio before change:  [-16.72964469]
curr_Stock_Price:  98.37802974437025
curr_Factors:  [9.83780297e+01 4.20496158e-02]
mat_Sqrt:  [[ 2.01734017e+01  0.00000000e+00]
 [-8.20240119e-03  1.87940622e-02]]
grads:  [ 1.91366828e-03 -5.25559837e+00]
Stock Position:  0.0019136682804014183
Bond Position:  [-16.91790761]


portfolio before change:  [-16.73026186]
curr_Stock_Price:  99.16066368833303
curr_Factors:  [9.91606637e+01 4.11412314e-02]
mat_Sqrt:  [[ 2.01130562e+01  0.00000000e+00]
 [-8.11332054e-03  1.85899528e-02]]
grads:  [ 0.00283365 -1.4634293 ]
Stock Position:  0.002833645489301017
Bond Position:  [-17.01124803]


portfolio before change:  [-16.73284413]
curr_Stock_Price:  98.99983425865032
curr_Factors:  [9.89998343e+01 3.97450944e-02]
mat_Sqrt:  [[ 1.97367770e+01  0.00000000e+00]
 [-7.97446870e-03  1.82718032e-02]]
grads:  [1.11498386e-02 1.67099195e+01]
Stock Position:  0.011149838624174327
Bond Position:  [-17.83667631]


portfolio before change:  [-16.73814124]
curr_Stock_Price:  98.72472844779053
curr_Factors:  [9.87247284e+01 3.91568337e-02]
mat_Sqrt:  [[ 1.95357339e+01  0.00000000e+00]
 [-7.91523429e-03  1.81360801e-02]]
grads:  [8.24128315e-03 1.57822460e+01]
Stock Position:  0.008241283148293008
Bond Position:  [-17.55175968]


portfolio before change:  [-16.74219861]
curr_Stock_Price:  98.4986403855926
curr_Factors:  [9.84986404e+01 3.81582154e-02]
mat_Sqrt:  [[ 1.92408504e+01  0.00000000e+00]
 [-7.81365117e-03  1.79033240e-02]]
grads:  [-4.70447907e-04  6.81032591e+00]
Stock Position:  -0.0004704479069016487
Bond Position:  [-16.69586013]


portfolio before change:  [-16.74424772]
curr_Stock_Price:  98.41787070153332
curr_Factors:  [9.84178707e+01 3.79235756e-02]
mat_Sqrt:  [[ 1.91658729e+01  0.00000000e+00]
 [-7.78959055e-03  1.78481942e-02]]
grads:  [3.05059253e-03 3.91363792e+00]
Stock Position:  0.0030505925267566704
Bond Position:  [-17.04448054]


portfolio before change:  [-16.74815459]
curr_Stock_Price:  97.83563123852184
curr_Factors:  [9.78356312e+01 3.74770439e-02]
mat_Sqrt:  [[ 1.89399887e+01  0.00000000e+00]
 [-7.74359543e-03  1.77428061e-02]]
grads:  [ 0.01507959 -0.85315731]
Stock Position:  0.015079591853850662
Bond Position:  [-18.22347598]


portfolio before change:  [-16.75150206]
curr_Stock_Price:  97.76471433348586
curr_Factors:  [9.77647143e+01 3.72895661e-02]
mat_Sqrt:  [[ 1.88788615e+01  0.00000000e+00]
 [-7.72420259e-03  1.76983715e-02]]
grads:  [5.77864071e-03 1.20288225e+01]
Stock Position:  0.005778640711541154
Bond Position:  [-17.31644922]


portfolio before change:  [-16.74798203]
curr_Stock_Price:  98.74846255526653
curr_Factors:  [9.87484626e+01 3.58788969e-02]
mat_Sqrt:  [[ 1.87046628e+01  0.00000000e+00]
 [-7.57669024e-03  1.73603783e-02]]
grads:  [-7.46112536e-03  8.34380844e+00]
Stock Position:  -0.007461125356429749
Bond Position:  [-16.01120737]


portfolio before change:  [-16.75089659]
curr_Stock_Price:  98.87083542550623
curr_Factors:  [9.88708354e+01 3.57348239e-02]
mat_Sqrt:  [[ 1.86902034e+01  0.00000000e+00]
 [-7.56146271e-03  1.73254876e-02]]
grads:  [-4.78522081e-03 -6.80642022e+00]
Stock Position:  -0.0047852208091297985
Bond Position:  [-16.27777781]


portfolio before change:  [-16.75296311]
curr_Stock_Price:  98.87745324791656
curr_Factors:  [9.88774532e+01 3.54601999e-02]
mat_Sqrt:  [[ 1.86194935e+01  0.00000000e+00]
 [-7.53235155e-03  1.72587856e-02]]
grads:  [ 1.24156955e-03 -3.33761892e+00]
Stock Position:  0.0012415695489470554
Bond Position:  [-16.87572635]


portfolio before change:  [-16.75670928]
curr_Stock_Price:  97.55930344444778
curr_Factors:  [9.75593034e+01 3.60679717e-02]
mat_Sqrt:  [[ 1.85280431e+01  0.00000000e+00]
 [-7.59662785e-03  1.74060611e-02]]
grads:  [-0.05125832 -6.05796373]
Stock Position:  -0.05125832462908994
Bond Position:  [-11.75598284]


portfolio before change:  [-16.76857536]
curr_Stock_Price:  97.76212871246813
curr_Factors:  [9.77621287e+01 3.60906733e-02]
mat_Sqrt:  [[ 1.85724048e+01  0.00000000e+00]
 [-7.59901818e-03  1.74115380e-02]]
grads:  [-0.00598473  1.03571248]
Stock Position:  -0.005984734792500621
Bond Position:  [-16.18349494]


portfolio before change:  [-16.78110801]
curr_Stock_Price:  99.51819473533934
curr_Factors:  [9.95181947e+01 3.58244322e-02]
mat_Sqrt:  [[ 1.88361503e+01  0.00000000e+00]
 [-7.57093729e-03  1.73471966e-02]]
grads:  [ 4.05845376e-04 -3.79869504e+00]
Stock Position:  0.00040584537557654355
Bond Position:  [-16.82149701]


portfolio before change:  [-16.78377852]
curr_Stock_Price:  98.11941224374841
curr_Factors:  [9.81194122e+01 3.67716565e-02]
mat_Sqrt:  [[ 1.88153168e+01  0.00000000e+00]
 [-7.67037486e-03  1.75750367e-02]]
grads:  [0.00670763 5.80463568]
Stock Position:  0.006707630495359892
Bond Position:  [-17.44192728]


portfolio before change:  [-16.77812194]
curr_Stock_Price:  99.28777689215367
curr_Factors:  [9.92877769e+01 3.80184123e-02]
mat_Sqrt:  [[ 1.93594393e+01  0.00000000e+00]
 [-7.79932431e-03  1.78704970e-02]]
grads:  [-0.00988387  1.00470876]
Stock Position:  -0.009883866161512746
Bond Position:  [-15.79677484]


portfolio before change:  [-16.79255012]
curr_Stock_Price:  100.54775562428078
curr_Factors:  [1.00547756e+02 3.75669451e-02]
mat_Sqrt:  [[ 1.94883612e+01  0.00000000e+00]
 [-7.75287767e-03  1.77640744e-02]]
grads:  [ -0.02264517 -21.53428448]
Stock Position:  -0.02264516591311528
Bond Position:  [-14.51562951]


portfolio before change:  [-16.79981126]
curr_Stock_Price:  100.78827380546475
curr_Factors:  [1.00788274e+02 3.73730049e-02]
mat_Sqrt:  [[ 1.94844888e+01  0.00000000e+00]
 [-7.73283958e-03  1.77181613e-02]]
grads:  [2.10521517e-03 1.60729467e+01]
Stock Position:  0.0021052151749235714
Bond Position:  [-17.01199226]


portfolio before change:  [-16.7984046]
curr_Stock_Price:  102.46662385096354
curr_Factors:  [1.02466624e+02 3.67513361e-02]
mat_Sqrt:  [[ 1.96435055e+01  0.00000000e+00]
 [-7.66825519e-03  1.75701799e-02]]
grads:  [-3.56764504e-03  6.76129411e+00]
Stock Position:  -0.0035676450369809334
Bond Position:  [-16.43284006]


portfolio before change:  [-16.79927279]
curr_Stock_Price:  102.13417928367447
curr_Factors:  [1.02134179e+02 3.54917947e-02]
mat_Sqrt:  [[ 1.92413298e+01  0.00000000e+00]
 [-7.53570644e-03  1.72664726e-02]]
grads:  [5.09948117e-03 5.69368622e+00]
Stock Position:  0.005099481174169751
Bond Position:  [-17.32010412]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.79394076]
Stock Price:  103.60436359668704
PL:  [-20.39830436]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.91711799e-01  6.21714444e-01]
 [-1.64852500e-01 -8.64443710e-02]
 [ 8.26592607e-01 -7.14623259e-01]
 [-4.17966181e-02  1.00234329e-01]
 [ 3.15404652e-02 -6.02054368e-02]
 [-8.03907192e-02 -1.03393776e-01]
 [-3.73801870e-02  2.11240423e-01]
 [-6.02171947e-02 -7.49676373e-02]
 [ 1.53492483e-01  7.41192864e-02]
 [ 3.09455949e-01 -1.43302895e-01]
 [ 6.41249371e-02  8.71083156e-04]
 [-1.41025293e-01 -1.67969981e-01]
 [ 5.81324492e-02  7.86598231e-02]
 [-3.80536166e-01 -5.02467487e-01]
 [ 7.96569360e-02  2.25047361e-01]
 [ 5.42807498e-02 -2.05831522e-02]
 [-5.27609160e-02  2.58870027e-01]
 [-1.58806176e-01 -9.85665277e-03]
 [ 1.49575380e-02  6.44081261e-02]
 [-7.87125550e-02 -4.04896117e-02]
 [ 1.64775235e-01  7.17224864e-02]
 [ 5.59496096e-02  2.95018487e-01]
 [ 3.81879360e-02  4.07760142e-01]
 [ 3.69998598e-02  1.69586585e-01]
 [ 2.96533915e-02  6.72211875e-02]
 [ 6.47507264e-01 -2.09888839e-01]
 [-1.30428446e-01  1.84432677e-01]
 [-7.36236173e-02  8.73089566e-02]
 [ 2.22858238e-02 -1.26215919e-01]
 [-6.26271989e-02 -3.18629261e-02]
 [-3.66315171e-01 -9.39830274e-02]
 [-1.17930465e-01 -1.89442398e-04]
 [ 2.06287885e-01  2.30876124e-01]
 [ 2.23208073e-01  2.94077998e-02]
 [-2.18164553e-01 -2.29329321e-01]
 [ 1.39771480e-01 -2.10017892e-01]
 [-1.69736631e-01  2.07596830e-01]
 [-1.18368092e-01  1.21199000e-01]
 [-1.65304023e-01  1.41724219e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.64191175]
curr_Stock_Price:  100.89377398938417
curr_Factors:  [1.00893774e+02 4.00818557e-02]
mat_Sqrt:  [[ 2.01993911e+01  0.00000000e+00]
 [-8.00818139e-03  1.83490487e-02]]
grads:  [2.78746139e-02 3.38826527e+01]
Stock Position:  0.027874613913427305
Bond Position:  [5.82953675]


portfolio before change:  [8.59601316]
curr_Stock_Price:  99.22102139754233
curr_Factors:  [9.92210214e+01 3.95152450e-02]
mat_Sqrt:  [[ 1.97235930e+01  0.00000000e+00]
 [-7.95137673e-03  1.82188929e-02]]
grads:  [-0.01027094 -4.74476531]
Stock Position:  -0.010270943865033445
Bond Position:  [9.6151067]


portfolio before change:  [8.59634614]
curr_Stock_Price:  99.30562659327823
curr_Factors:  [9.93056266e+01 4.04181680e-02]
mat_Sqrt:  [[ 1.99646715e+01  0.00000000e+00]
 [-8.04170808e-03  1.84258680e-02]]
grads:  [ 2.57808122e-02 -3.87836958e+01]
Stock Position:  0.02578081221695906
Bond Position:  [6.03616643]


portfolio before change:  [8.58649835]
curr_Stock_Price:  98.8943766913434
curr_Factors:  [9.88943767e+01 3.93143632e-02]
mat_Sqrt:  [[ 1.96086286e+01  0.00000000e+00]
 [-7.93113997e-03  1.81725246e-02]]
grads:  [9.94067343e-05 5.51570745e+00]
Stock Position:  9.940673427328043e-05
Bond Position:  [8.57666759]


portfolio before change:  [8.58746299]
curr_Stock_Price:  97.81279385160376
curr_Factors:  [9.78127939e+01 3.90218288e-02]
mat_Sqrt:  [[ 1.93218841e+01  0.00000000e+00]
 [-7.90157744e-03  1.81047884e-02]]
grads:  [ 2.72471273e-04 -3.32538749e+00]
Stock Position:  0.0002724712732912007
Bond Position:  [8.56081181]


portfolio before change:  [8.58849594]
curr_Stock_Price:  97.67620440203953
curr_Factors:  [9.76762044e+01 3.87319618e-02]
mat_Sqrt:  [[ 1.92231043e+01  0.00000000e+00]
 [-7.87217497e-03  1.80374188e-02]]
grads:  [-0.00652941 -5.73218249]
Stock Position:  -0.006529406532737284
Bond Position:  [9.22626359]


portfolio before change:  [8.5798882]
curr_Stock_Price:  99.17114784761348
curr_Factors:  [9.91711478e+01 3.96933620e-02]
mat_Sqrt:  [[ 1.97580592e+01  0.00000000e+00]
 [-7.96927721e-03  1.82599080e-02]]
grads:  [2.77419413e-03 1.15685371e+01]
Stock Position:  0.002774194126848052
Bond Position:  [8.30476819]


portfolio before change:  [8.58040686]
curr_Stock_Price:  98.98388444937287
curr_Factors:  [9.89838844e+01 4.19194326e-02]
mat_Sqrt:  [[ 2.02661938e+01  0.00000000e+00]
 [-8.18969427e-03  1.87649469e-02]]
grads:  [-0.00458575 -3.99508922]
Stock Position:  -0.004585752760170445
Bond Position:  [9.03432248]


portfolio before change:  [8.57659516]
curr_Stock_Price:  100.06136510681301
curr_Factors:  [1.00061365e+02 4.19189221e-02]
mat_Sqrt:  [[ 2.04866749e+01  0.00000000e+00]
 [-8.18964439e-03  1.87648327e-02]]
grads:  [0.0090713  3.94990394]
Stock Position:  0.009071300819148514
Bond Position:  [7.66890842]


portfolio before change:  [8.58521052]
curr_Stock_Price:  100.90542095536078
curr_Factors:  [1.00905421e+02 4.15411906e-02]
mat_Sqrt:  [[ 2.05661959e+01  0.00000000e+00]
 [-8.15266245e-03  1.86800964e-02]]
grads:  [ 0.01200579 -7.6714216 ]
Stock Position:  0.012005790433521405
Bond Position:  [7.37376118]


portfolio before change:  [8.59814665]
curr_Stock_Price:  101.90613474186843
curr_Factors:  [1.01906135e+02 4.24169425e-02]
mat_Sqrt:  [[ 2.09879494e+01  0.00000000e+00]
 [-8.23814955e-03  1.88759719e-02]]
grads:  [0.00307344 0.04614772]
Stock Position:  0.0030734355033467694
Bond Position:  [8.28494472]


portfolio before change:  [8.59865775]
curr_Stock_Price:  101.73545139345998
curr_Factors:  [1.01735451e+02 4.13683911e-02]
mat_Sqrt:  [[ 2.06921983e+01  0.00000000e+00]
 [-8.13568841e-03  1.86412040e-02]]
grads:  [-0.01035817 -9.01068306]
Stock Position:  -0.010358174611251327
Bond Position:  [9.65245132]


portfolio before change:  [8.62390005]
curr_Stock_Price:  99.41499729963594
curr_Factors:  [9.94149973e+01 4.25718476e-02]
mat_Sqrt:  [[ 2.05122431e+01  0.00000000e+00]
 [-8.25317855e-03  1.89104077e-02]]
grads:  [0.00450767 4.15960482]
Stock Position:  0.0045076694008177294
Bond Position:  [8.17577011]


portfolio before change:  [8.62835199]
curr_Stock_Price:  100.17590081358944
curr_Factors:  [1.00175901e+02 4.22381664e-02]
mat_Sqrt:  [[ 2.05880771e+01  0.00000000e+00]
 [-8.22077042e-03  1.88361514e-02]]
grads:  [ -0.02913487 -26.67569807]
Stock Position:  -0.029134870339757608
Bond Position:  [11.54696387]


portfolio before change:  [8.63689819]
curr_Stock_Price:  99.93211266097653
curr_Factors:  [9.99321127e+01 4.33410301e-02]
mat_Sqrt:  [[ 2.08043755e+01  0.00000000e+00]
 [-8.32740345e-03  1.90804783e-02]]
grads:  [8.54991569e-03 1.17946394e+01]
Stock Position:  0.008549915691285851
Bond Position:  [7.78248705]


portfolio before change:  [8.64672775]
curr_Stock_Price:  100.96799318419546
curr_Factors:  [1.00967993e+02 4.26341558e-02]
mat_Sqrt:  [[ 2.08479117e+01  0.00000000e+00]
 [-8.25921602e-03  1.89242413e-02]]
grads:  [ 0.00217276 -1.08766063]
Stock Position:  0.0021727608222046795
Bond Position:  [8.42734845]


portfolio before change:  [8.64973697]
curr_Stock_Price:  101.86810961088814
curr_Factors:  [1.01868110e+02 4.17662387e-02]
mat_Sqrt:  [[ 2.08185717e+01  0.00000000e+00]
 [-8.17471602e-03  1.87306275e-02]]
grads:  [2.89257243e-03 1.38206810e+01]
Stock Position:  0.002892572427759256
Bond Position:  [8.35507609]


portfolio before change:  [8.64604593]
curr_Stock_Price:  100.23098929759988
curr_Factors:  [1.00230989e+02 4.09008581e-02]
mat_Sqrt:  [[ 2.02706758e+01  0.00000000e+00]
 [-8.08958423e-03  1.85355660e-02]]
grads:  [-0.0080465  -0.53176972]
Stock Position:  -0.008046498998503036
Bond Position:  [9.45255449]


portfolio before change:  [8.6371876]
curr_Stock_Price:  101.47873332244191
curr_Factors:  [1.01478733e+02 4.15301713e-02]
mat_Sqrt:  [[ 2.06803031e+01  0.00000000e+00]
 [-8.15158108e-03  1.86776187e-02]]
grads:  [2.08253954e-03 3.44841210e+00]
Stock Position:  0.002082539537421864
Bond Position:  [8.42585413]


portfolio before change:  [8.63888985]
curr_Stock_Price:  101.79034798217178
curr_Factors:  [1.01790348e+02 4.15339090e-02]
mat_Sqrt:  [[ 2.07447403e+01  0.00000000e+00]
 [-8.15194789e-03  1.86784591e-02]]
grads:  [-0.00464617 -2.16771691]
Stock Position:  -0.004646173866802547
Bond Position:  [9.11182551]


portfolio before change:  [8.64324319]
curr_Stock_Price:  101.09853486551253
curr_Factors:  [1.01098535e+02 4.27629351e-02]
mat_Sqrt:  [[ 2.09063692e+01  0.00000000e+00]
 [-8.27168037e-03  1.89528007e-02]]
grads:  [0.00937884 3.78426848]
Stock Position:  0.009378840165273048
Bond Position:  [7.69505619]


portfolio before change:  [8.63793309]
curr_Stock_Price:  100.42979126844554
curr_Factors:  [1.00429791e+02 4.30072992e-02]
mat_Sqrt:  [[ 2.08273322e+01  0.00000000e+00]
 [-8.29528051e-03  1.90068754e-02]]
grads:  [8.86845378e-03 1.55216721e+01]
Stock Position:  0.008868453783118088
Bond Position:  [7.74727613]


portfolio before change:  [8.64343689]
curr_Stock_Price:  100.94119167229749
curr_Factors:  [1.00941192e+02 4.14905357e-02]
mat_Sqrt:  [[ 2.05609392e+01  0.00000000e+00]
 [-8.14769029e-03  1.86687037e-02]]
grads:  [1.05126060e-02 2.18419097e+01]
Stock Position:  0.010512605960851223
Bond Position:  [7.58228192]


portfolio before change:  [8.65802424]
curr_Stock_Price:  102.23863456154758
curr_Factors:  [1.02238635e+02 4.07092763e-02]
mat_Sqrt:  [[ 2.06282189e+01  0.00000000e+00]
 [-8.07061597e-03  1.84921043e-02]]
grads:  [5.38163347e-03 9.17075647e+00]
Stock Position:  0.005381633473589805
Bond Position:  [8.10781338]


portfolio before change:  [8.65416535]
curr_Stock_Price:  101.33325401814749
curr_Factors:  [1.01333254e+02 4.27316273e-02]
mat_Sqrt:  [[ 2.09472350e+01  0.00000000e+00]
 [-8.26865186e-03  1.89458615e-02]]
grads:  [2.81617707e-03 3.54806707e+00]
Stock Position:  0.002816177071721097
Bond Position:  [8.36879297]


portfolio before change:  [8.65320897]
curr_Stock_Price:  100.62216504844662
curr_Factors:  [1.00622165e+02 4.38422263e-02]
mat_Sqrt:  [[ 2.10688076e+01  0.00000000e+00]
 [-8.37541414e-03  1.91904846e-02]]
grads:  [  0.02638518 -10.93713071]
Stock Position:  0.026385179205781626
Bond Position:  [5.99827511]


portfolio before change:  [8.69022479]
curr_Stock_Price:  101.99664868998391
curr_Factors:  [1.01996649e+02 4.40969293e-02]
mat_Sqrt:  [[ 2.14185505e+01  0.00000000e+00]
 [-8.39970755e-03  1.92461478e-02]]
grads:  [-2.33141021e-03  9.58283593e+00]
Stock Position:  -0.002331410207318799
Bond Position:  [8.92802082]


portfolio before change:  [8.69440963]
curr_Stock_Price:  100.68038022478568
curr_Factors:  [1.00680380e+02 4.52845109e-02]
mat_Sqrt:  [[ 2.14249436e+01  0.00000000e+00]
 [-8.51206305e-03  1.95035866e-02]]
grads:  [-1.65782768e-03  4.47655902e+00]
Stock Position:  -0.0016578276841360392
Bond Position:  [8.86132035]


portfolio before change:  [8.69292652]
curr_Stock_Price:  102.24317549662773
curr_Factors:  [1.02243175e+02 4.58953066e-02]
mat_Sqrt:  [[ 2.19037497e+01  0.00000000e+00]
 [-8.56927597e-03  1.96346779e-02]]
grads:  [-1.49742943e-03 -6.42821440e+00]
Stock Position:  -0.001497429430417517
Bond Position:  [8.84602846]


portfolio before change:  [8.69456699]
curr_Stock_Price:  101.88613132408577
curr_Factors:  [1.01886131e+02 4.52318556e-02]
mat_Sqrt:  [[ 2.16689204e+01  0.00000000e+00]
 [-8.50711285e-03  1.94922443e-02]]
grads:  [-0.00353194 -1.63464636]
Stock Position:  -0.003531939683323587
Bond Position:  [9.05442266]


portfolio before change:  [8.69318643]
curr_Stock_Price:  102.59747866123583
curr_Factors:  [1.02597479e+02 4.46373303e-02]
mat_Sqrt:  [[ 2.16763320e+01  0.00000000e+00]
 [-8.45101938e-03  1.93637180e-02]]
grads:  [-0.01879159 -4.85356311]
Stock Position:  -0.018791589245297544
Bond Position:  [10.6211561]


portfolio before change:  [8.67881121]
curr_Stock_Price:  103.43311525830319
curr_Factors:  [1.03433115e+02 4.47813822e-02]
mat_Sqrt:  [[ 2.18881145e+01  0.00000000e+00]
 [-8.46464479e-03  1.93949377e-02]]
grads:  [-0.00539165 -0.00976762]
Stock Position:  -0.005391654200497516
Bond Position:  [9.2364868]


portfolio before change:  [8.67112016]
curr_Stock_Price:  105.07374156121607
curr_Factors:  [1.05073742e+02 4.44059216e-02]
mat_Sqrt:  [[ 2.21418876e+01  0.00000000e+00]
 [-8.42908504e-03  1.93134601e-02]]
grads:  [ 0.0138674  11.95415648]
Stock Position:  0.01386740337447214
Bond Position:  [7.2140202]


portfolio before change:  [8.67664081]
curr_Stock_Price:  105.40681391762756
curr_Factors:  [1.05406814e+02 4.30462116e-02]
mat_Sqrt:  [[ 2.18693641e+01  0.00000000e+00]
 [-8.29903239e-03  1.90154721e-02]]
grads:  [0.0107933  1.54651958]
Stock Position:  0.010793303730670636
Bond Position:  [7.53895306]


portfolio before change:  [8.66822923]
curr_Stock_Price:  104.54016453892626
curr_Factors:  [1.04540165e+02 4.58327164e-02]
mat_Sqrt:  [[ 2.23805615e+01  0.00000000e+00]
 [-8.56343075e-03  1.96212848e-02]]
grads:  [ -0.01422002 -11.6877831 ]
Stock Position:  -0.014220021864523126
Bond Position:  [10.15479266]


portfolio before change:  [8.66357211]
curr_Stock_Price:  104.95693981118227
curr_Factors:  [1.04956940e+02 4.65259344e-02]
mat_Sqrt:  [[ 2.26390767e+01  0.00000000e+00]
 [-8.62794849e-03  1.97691135e-02]]
grads:  [ 2.12518198e-03 -1.06235361e+01]
Stock Position:  0.002125181975809368
Bond Position:  [8.44051951]


portfolio before change:  [8.66503813]
curr_Stock_Price:  105.15028361259945
curr_Factors:  [1.05150284e+02 4.37706814e-02]
mat_Sqrt:  [[ 2.19989576e+01  0.00000000e+00]
 [-8.36857755e-03  1.91748200e-02]]
grads:  [-3.59716803e-03  1.08265334e+01]
Stock Position:  -0.003597168029578317
Bond Position:  [9.04328137]


portfolio before change:  [8.66515504]
curr_Stock_Price:  105.43205166024951
curr_Factors:  [1.05432052e+02 4.29279778e-02]
mat_Sqrt:  [[ 2.18445385e+01  0.00000000e+00]
 [-8.28762719e-03  1.89893395e-02]]
grads:  [-2.99720281e-03  6.38247581e+00]
Stock Position:  -0.002997202809555297
Bond Position:  [8.98115628]


portfolio before change:  [8.66511426]
curr_Stock_Price:  105.82024521556724
curr_Factors:  [1.05820245e+02 4.31111279e-02]
mat_Sqrt:  [[ 2.19716897e+01  0.00000000e+00]
 [-8.30528775e-03  1.90298049e-02]]
grads:  [-4.70835447e-03  7.44748670e+00]
Stock Position:  -0.004708354470864022
Bond Position:  [9.16335349]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.66084466]
Stock Price:  106.97034804755398
PL:  [1.69049661]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 8.78812945e-02  3.69324971e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.52604640e-01 -6.37633972e-01]
 [ 1.81172987e-02  2.33007988e-02]
 [-1.33009164e-01  5.65915142e-02]
 [ 5.74194072e-03  3.60647819e-02]
 [ 5.47378081e-02  1.70819271e-01]
 [ 3.87231516e-01 -1.12368594e-02]
 [ 1.48726573e-01  7.56349980e-02]
 [ 2.57408268e-01 -1.05545064e-01]
 [ 1.12892320e-01  1.72952984e-01]
 [ 1.79199244e-01  2.30953574e-01]
 [ 1.73428624e-01  2.92686685e-02]
 [-1.40893452e-01 -1.43107201e-01]
 [ 9.45641908e-02  2.36929721e-01]
 [ 4.20929678e-02  1.07432159e-01]
 [ 6.37994602e-02  1.19672886e-01]
 [ 1.02915551e-01  6.79217012e-02]
 [ 4.72422770e-02 -1.02109837e-01]
 [ 5.17702869e-01 -1.32471142e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 8.90197121e-03 -9.37786743e-02]
 [-1.28258845e-01  1.84079878e-01]
 [ 1.26728146e-01 -5.73148210e-01]
 [ 5.94490038e-02  2.29282096e-01]
 [-2.33348122e-02  1.15939228e-01]
 [ 6.46294173e-03  1.58267540e-01]
 [-1.51130816e-01  7.14662939e-02]
 [-4.95842609e-01  1.07753772e-01]
 [ 2.81566898e-01 -1.10881875e-01]
 [-1.65130585e+00 -1.86111191e-01]
 [ 3.63917914e-01  6.62706890e-01]
 [ 5.95421230e-02 -1.51633590e-01]
 [ 1.41301736e-01 -6.44140492e-03]
 [ 2.17217438e-03  1.74286464e-01]
 [-2.47333928e+00  8.82722330e-02]
 [-1.49857694e-01  6.89158961e-02]
 [-1.34977502e-01 -1.62333995e-01]
 [ 1.54675630e+00 -8.68191562e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.79524724]
curr_Stock_Price:  100.1637878689153
curr_Factors:  [1.00163788e+02 4.05287747e-02]
mat_Sqrt:  [[ 2.01647330e+01  0.00000000e+00]
 [-8.05270386e-03  1.84510625e-02]]
grads:  [1.23516600e-02 2.00164609e+01]
Stock Position:  0.012351660009254948
Bond Position:  [2.55805819]


portfolio before change:  [3.7894671]
curr_Stock_Price:  99.66993368018893
curr_Factors:  [9.96699337e+01 4.15954394e-02]
mat_Sqrt:  [[ 2.03276431e+01  0.00000000e+00]
 [-8.15798400e-03  1.86922896e-02]]
grads:  [-0.00998564 -4.70843177]
Stock Position:  -0.009985636152253712
Bond Position:  [4.78473479]


portfolio before change:  [3.7730732]
curr_Stock_Price:  101.37158020499369
curr_Factors:  [1.01371580e+02 3.98752388e-02]
mat_Sqrt:  [[ 2.02426732e+01  0.00000000e+00]
 [-7.98751414e-03  1.83016941e-02]]
grads:  [ 2.34316068e-02 -3.48401612e+01]
Stock Position:  0.023431606761345498
Bond Position:  [1.3977742]


portfolio before change:  [3.76203047]
curr_Stock_Price:  100.89284797332621
curr_Factors:  [1.00892848e+02 3.92914638e-02]
mat_Sqrt:  [[ 1.99990555e+01  0.00000000e+00]
 [-7.92882980e-03  1.81672314e-02]]
grads:  [0.0014144  1.28257291]
Stock Position:  0.0014143968439223585
Bond Position:  [3.61932795]


portfolio before change:  [3.76398948]
curr_Stock_Price:  101.95801439062092
curr_Factors:  [1.01958014e+02 3.73733290e-02]
mat_Sqrt:  [[ 1.97107097e+01  0.00000000e+00]
 [-7.73287310e-03  1.77182382e-02]]
grads:  [-0.00549501  3.19396961]
Stock Position:  -0.005495012833962099
Bond Position:  [4.32425008]


portfolio before change:  [3.76496745]
curr_Stock_Price:  101.87841484076174
curr_Factors:  [1.01878415e+02 3.59869227e-02]
mat_Sqrt:  [[ 1.93265589e+01  0.00000000e+00]
 [-7.58808779e-03  1.73864933e-02]]
grads:  [1.11152234e-03 2.07429878e+00]
Stock Position:  0.0011115223408898352
Bond Position:  [3.65172732]


portfolio before change:  [3.76629862]
curr_Stock_Price:  102.66533187424014
curr_Factors:  [1.02665332e+02 3.55443040e-02]
mat_Sqrt:  [[ 1.93556973e+01  0.00000000e+00]
 [-7.54127883e-03  1.72792405e-02]]
grads:  [6.67965858e-03 9.88580896e+00]
Stock Position:  0.006679658584523524
Bond Position:  [3.08052925]


portfolio before change:  [3.77168966]
curr_Stock_Price:  103.41476368665784
curr_Factors:  [1.03414764e+02 3.45980739e-02]
mat_Sqrt:  [[ 1.92357226e+01  0.00000000e+00]
 [-7.44022300e-03  1.70476925e-02]]
grads:  [ 0.0198759  -0.65914254]
Stock Position:  0.019875902599031933
Bond Position:  [1.71622789]


portfolio before change:  [3.70953117]
curr_Stock_Price:  100.27664036879283
curr_Factors:  [1.00276640e+02 3.68584021e-02]
mat_Sqrt:  [[ 1.92516531e+01  0.00000000e+00]
 [-7.67941687e-03  1.75957545e-02]]
grads:  [0.00944004 4.29847995]
Stock Position:  0.00944004091659358
Bond Position:  [2.76291558]


portfolio before change:  [3.70342809]
curr_Stock_Price:  99.59354381223686
curr_Factors:  [9.95935438e+01 3.78062858e-02]
mat_Sqrt:  [[ 1.93648079e+01  0.00000000e+00]
 [-7.77753542e-03  1.78205724e-02]]
grads:  [ 0.01091385 -5.92265283]
Stock Position:  0.010913850891611041
Bond Position:  [2.61647901]


portfolio before change:  [3.69663346]
curr_Stock_Price:  98.9410048340141
curr_Factors:  [9.89410048e+01 3.72970430e-02]
mat_Sqrt:  [[ 1.91079245e+01  0.00000000e+00]
 [-7.72497694e-03  1.77001458e-02]]
grads:  [0.00985849 9.77127456]
Stock Position:  0.009858485163292508
Bond Position:  [2.72122503]


portfolio before change:  [3.68232094]
curr_Stock_Price:  97.4547019991074
curr_Factors:  [9.74547020e+01 3.76701286e-02]
mat_Sqrt:  [[ 1.89147824e+01  0.00000000e+00]
 [-7.76351761e-03  1.77884536e-02]]
grads:  [ 0.01480301 12.9833419 ]
Stock Position:  0.014803006533549594
Bond Position:  [2.23969835]


portfolio before change:  [3.68673423]
curr_Stock_Price:  97.73392270085176
curr_Factors:  [9.77339227e+01 3.68270215e-02]
mat_Sqrt:  [[ 1.87554992e+01  0.00000000e+00]
 [-7.67614710e-03  1.75882626e-02]]
grads:  [0.00992789 1.66410232]
Stock Position:  0.009927889202136091
Bond Position:  [2.71644267]


portfolio before change:  [3.6759741]
curr_Stock_Price:  96.6158899107331
curr_Factors:  [9.66158899e+01 3.82680554e-02]
mat_Sqrt:  [[ 1.89002155e+01  0.00000000e+00]
 [-7.82488905e-03  1.79290732e-02]]
grads:  [-0.01075917 -7.98185157]
Stock Position:  -0.01075916596031273
Bond Position:  [4.71548049]


portfolio before change:  [3.68363276]
curr_Stock_Price:  95.95885088912674
curr_Factors:  [9.59588509e+01 3.88130550e-02]
mat_Sqrt:  [[ 1.89048812e+01  0.00000000e+00]
 [-7.88041167e-03  1.80562915e-02]]
grads:  [1.04718351e-02 1.31217267e+01]
Stock Position:  0.010471835106198087
Bond Position:  [2.6787675]


portfolio before change:  [3.68070971]
curr_Stock_Price:  95.64773877388217
curr_Factors:  [9.56477388e+01 3.97453051e-02]
mat_Sqrt:  [[ 1.90685480e+01  0.00000000e+00]
 [-7.97448984e-03  1.82718517e-02]]
grads:  [4.66633357e-03 5.87965361e+00]
Stock Position:  0.004666333571189964
Bond Position:  [3.23438546]


portfolio before change:  [3.68172766]
curr_Stock_Price:  95.7792397966529
curr_Factors:  [9.57792398e+01 4.18745660e-02]
mat_Sqrt:  [[ 1.95995701e+01  0.00000000e+00]
 [-8.18531036e-03  1.87549021e-02]]
grads:  [5.91997627e-03 6.38088567e+00]
Stock Position:  0.005919976269084799
Bond Position:  [3.11471684]


portfolio before change:  [3.67756438]
curr_Stock_Price:  95.01020741314348
curr_Factors:  [9.50102074e+01 4.18533144e-02]
mat_Sqrt:  [[ 1.94372667e+01  0.00000000e+00]
 [-8.18323305e-03  1.87501424e-02]]
grads:  [0.00681984 3.62246322]
Stock Position:  0.006819838083229734
Bond Position:  [3.02961014]


portfolio before change:  [3.66236365]
curr_Stock_Price:  92.72577678839433
curr_Factors:  [9.27257768e+01 4.30864829e-02]
mat_Sqrt:  [[ 1.92473526e+01  0.00000000e+00]
 [-8.30291350e-03  1.90243648e-02]]
grads:  [ 1.39130337e-04 -5.36731912e+00]
Stock Position:  0.00013913033678814257
Bond Position:  [3.64946268]


portfolio before change:  [3.66271772]
curr_Stock_Price:  91.99163307486458
curr_Factors:  [9.19916331e+01 4.28895089e-02]
mat_Sqrt:  [[ 1.90512671e+01  0.00000000e+00]
 [-8.28391298e-03  1.89808291e-02]]
grads:  [ 0.02413948 -6.97920732]
Stock Position:  0.02413948223913437
Bond Position:  [1.44208733]


portfolio before change:  [3.60013613]
curr_Stock_Price:  89.39166589208804
curr_Factors:  [8.93916659e+01 4.41144049e-02]
mat_Sqrt:  [[ 1.87753155e+01  0.00000000e+00]
 [-8.40137178e-03  1.92499611e-02]]
grads:  [ 0.00224383 -1.96249694]
Stock Position:  0.002243829705973526
Bond Position:  [3.39955646]


portfolio before change:  [3.60216339]
curr_Stock_Price:  90.10575218500216
curr_Factors:  [9.01057522e+01 4.38337629e-02]
mat_Sqrt:  [[ 1.88650037e+01  0.00000000e+00]
 [-8.37460570e-03  1.91886323e-02]]
grads:  [-1.69766189e-03 -4.88719951e+00]
Stock Position:  -0.0016976618878605644
Bond Position:  [3.75513249]


portfolio before change:  [3.60363922]
curr_Stock_Price:  89.51293148252071
curr_Factors:  [8.95129315e+01 4.40970536e-02]
mat_Sqrt:  [[ 1.87970876e+01  0.00000000e+00]
 [-8.39971939e-03  1.92461750e-02]]
grads:  [-2.54932042e-03  9.56449158e+00]
Stock Position:  -0.0025493204156373816
Bond Position:  [3.83183637]


portfolio before change:  [3.60539809]
curr_Stock_Price:  89.01089210899377
curr_Factors:  [8.90108921e+01 4.53022902e-02]
mat_Sqrt:  [[ 1.89453762e+01  0.00000000e+00]
 [-8.51373386e-03  1.95074149e-02]]
grads:  [-6.51421431e-03 -2.93810436e+01]
Stock Position:  -0.006514214309991404
Bond Position:  [4.18523412]


portfolio before change:  [3.5908342]
curr_Stock_Price:  91.32691662273756
curr_Factors:  [9.13269166e+01 4.51783359e-02]
mat_Sqrt:  [[ 1.94117152e+01  0.00000000e+00]
 [-8.50207842e-03  1.94807090e-02]]
grads:  [8.21750746e-03 1.17696998e+01]
Stock Position:  0.008217507459926629
Bond Position:  [2.84035458]


portfolio before change:  [3.57860489]
curr_Stock_Price:  89.79550699368029
curr_Factors:  [8.97955070e+01 4.56219233e-02]
mat_Sqrt:  [[ 1.91796820e+01  0.00000000e+00]
 [-8.54371566e-03  1.95761119e-02]]
grads:  [1.42156763e-03 5.92248494e+00]
Stock Position:  0.0014215676334347067
Bond Position:  [3.45095451]


portfolio before change:  [3.57968478]
curr_Stock_Price:  90.25168385470141
curr_Factors:  [9.02516839e+01 4.64002456e-02]
mat_Sqrt:  [[ 1.94408591e+01  0.00000000e+00]
 [-8.61628649e-03  1.97423925e-02]]
grads:  [3.88545376e-03 8.01663425e+00]
Stock Position:  0.003885453758206204
Bond Position:  [3.22901603]


portfolio before change:  [3.58608391]
curr_Stock_Price:  91.79474121022848
curr_Factors:  [9.17947412e+01 4.65321252e-02]
mat_Sqrt:  [[ 1.98013247e+01  0.00000000e+00]
 [-8.62852248e-03  1.97704287e-02]]
grads:  [-0.00605719  3.61480749]
Stock Position:  -0.00605718908505228
Bond Position:  [4.14210201]


portfolio before change:  [3.58760547]
curr_Stock_Price:  91.62902554060432
curr_Factors:  [9.16290255e+01 4.73173324e-02]
mat_Sqrt:  [[ 1.99316473e+01  0.00000000e+00]
 [-8.70101901e-03  1.99365391e-02]]
grads:  [-0.02251771  5.40483838]
Stock Position:  -0.022517707644948117
Bond Position:  [5.65088108]


portfolio before change:  [3.59784027]
curr_Stock_Price:  91.20587452510625
curr_Factors:  [9.12058745e+01 4.84536825e-02]
mat_Sqrt:  [[ 2.00764169e+01  0.00000000e+00]
 [-8.80487887e-03  2.01745120e-02]]
grads:  [ 0.01161433 -5.49613668]
Stock Position:  0.011614327459616297
Bond Position:  [2.53854538]


portfolio before change:  [3.58592627]
curr_Stock_Price:  90.1527497687432
curr_Factors:  [9.01527498e+01 5.00944394e-02]
mat_Sqrt:  [[ 2.01777965e+01  0.00000000e+00]
 [-8.95271484e-03  2.05132467e-02]]
grads:  [-0.08586326 -9.07273204]
Stock Position:  -0.08586326223935048
Bond Position:  [11.32673547]


portfolio before change:  [3.70166953]
curr_Stock_Price:  88.82124513091358
curr_Factors:  [8.88212451e+01 5.04606310e-02]
mat_Sqrt:  [[ 1.99523105e+01  0.00000000e+00]
 [-8.98537754e-03  2.05880864e-02]]
grads:  [ 0.0327354  32.18885322]
Stock Position:  0.03273540233629482
Bond Position:  [0.79407034]


portfolio before change:  [3.70872527]
curr_Stock_Price:  89.0337511816015
curr_Factors:  [8.90337512e+01 4.91662575e-02]
mat_Sqrt:  [[ 1.97418682e+01  0.00000000e+00]
 [-8.86938622e-03  2.03223169e-02]]
grads:  [-3.36148589e-04 -7.46143222e+00]
Stock Position:  -0.0003361485888972125
Bond Position:  [3.73865384]


portfolio before change:  [3.70913687]
curr_Stock_Price:  89.1996280393399
curr_Factors:  [8.91996280e+01 4.89082949e-02]
mat_Sqrt:  [[ 1.97266938e+01  0.00000000e+00]
 [-8.84608794e-03  2.02689338e-02]]
grads:  [ 0.00702046 -0.31779693]
Stock Position:  0.007020460593709854
Bond Position:  [3.0829144]


portfolio before change:  [3.71572857]
curr_Stock_Price:  90.08365985287121
curr_Factors:  [9.00836599e+01 4.69636624e-02]
mat_Sqrt:  [[ 1.95221210e+01  0.00000000e+00]
 [-8.66844045e-03  1.98618923e-02]]
grads:  [4.00760877e-03 8.77491742e+00]
Stock Position:  0.004007608771440662
Bond Position:  [3.3547085]


portfolio before change:  [3.71655925]
curr_Stock_Price:  90.18629342746553
curr_Factors:  [9.01862934e+01 4.64438905e-02]
mat_Sqrt:  [[ 1.94359080e+01  0.00000000e+00]
 [-8.62033786e-03  1.97516754e-02]]
grads:  [-0.12527401  4.46910104]
Stock Position:  -0.12527400954798926
Bond Position:  [15.01455783]


portfolio before change:  [3.86485574]
curr_Stock_Price:  89.01749912606972
curr_Factors:  [8.90174991e+01 4.57671529e-02]
mat_Sqrt:  [[ 1.90437441e+01  0.00000000e+00]
 [-8.55730359e-03  1.96072457e-02]]
grads:  [-0.00628975  3.51481779]
Stock Position:  -0.0062897469551090116
Bond Position:  [4.42475328]


portfolio before change:  [3.85817618]
curr_Stock_Price:  90.16741630180232
curr_Factors:  [9.01674163e+01 4.59521272e-02]
mat_Sqrt:  [[ 1.93286907e+01  0.00000000e+00]
 [-8.57457891e-03  1.96468285e-02]]
grads:  [-0.01064872 -8.26260563]
Stock Position:  -0.010648722654604606
Bond Position:  [4.81834398]


portfolio before change:  [3.85477829]
curr_Stock_Price:  90.54306816546921
curr_Factors:  [9.05430682e+01 4.60267097e-02]
mat_Sqrt:  [[ 1.94249617e+01  0.00000000e+00]
 [-8.58153457e-03  1.96627659e-02]]
grads:  [ 0.07767662 -4.41540914]
Stock Position:  0.07767661694668668
Bond Position:  [-3.17830093]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.72932323]
Stock Price:  88.9330887849204
PL:  [3.72932323]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-5.12670487e-01 -2.48618946e-01]
 [-1.77257508e-01 -8.33528113e-02]
 [ 8.77201114e-01 -8.30035659e-01]
 [-2.23036139e-02  1.91441473e-01]
 [ 3.17772031e-02 -5.95429327e-02]
 [-8.15039613e-02 -9.88515036e-02]
 [-6.36266974e-02  1.75616013e-01]
 [-6.75469600e-02 -7.66601683e-02]
 [ 1.55217760e-01  7.35705932e-02]
 [ 2.82621561e-01 -1.23978350e-01]
 [ 7.07472626e-02  2.37368576e-02]
 [-1.01035443e-01 -7.64282181e-03]
 [ 4.57207848e-02  8.35785941e-02]
 [-2.82380492e-01 -3.84761554e-01]
 [ 8.30158344e-02  2.27701490e-01]
 [ 5.03159227e-02 -1.44861467e-03]
 [ 2.21470304e-02 -3.71003211e-02]
 [ 5.55914925e-02  5.98486442e-02]
 [ 1.30379826e-02  4.27079453e-02]
 [ 1.60249313e-01 -1.03651144e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 7.39085638e-02  3.00054180e-01]
 [ 3.47960096e-02  2.12261440e-01]
 [-8.57400080e-02  1.05660608e-01]
 [ 1.61542256e-02  3.87234936e-02]
 [ 4.74668392e-01 -1.04102482e-01]
 [ 8.40340089e-03  8.34946840e-02]
 [-2.03593472e-01  1.45233626e-01]
 [-6.17103487e-02 -1.06062939e-01]
 [ 1.33646943e-02 -4.94484497e-02]
 [-5.97352158e-01 -9.43864721e-02]
 [-1.18039536e-01  4.04471926e-03]
 [ 6.83089267e-02 -9.61584657e-03]
 [ 1.10658909e-01  8.71504882e-02]
 [-2.74421134e-01 -1.25292650e-01]
 [-1.42552044e-01 -4.11085573e-01]
 [-9.84633423e-02  2.71220761e-01]
 [-1.23153013e-01  1.17970994e-01]
 [ 1.56393104e-01  8.56146455e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.00794723]
curr_Stock_Price:  97.78357100096228
curr_Factors:  [9.7783571e+01 4.0361641e-02]
mat_Sqrt:  [[ 1.96449216e+01  0.00000000e+00]
 [-8.03608272e-03  1.84129787e-02]]
grads:  [ -0.03162022 -13.50237517]
Stock Position:  -0.031620217282997194
Bond Position:  [-8.91600947]


portfolio before change:  [-11.97146899]
curr_Stock_Price:  96.59468568077503
curr_Factors:  [9.65946857e+01 4.08983166e-02]
mat_Sqrt:  [[ 1.95346642e+01  0.00000000e+00]
 [-8.08933289e-03  1.85349901e-02]]
grads:  [-0.01093623 -4.49705183]
Stock Position:  -0.010936233915183325
Bond Position:  [-10.91508691]


portfolio before change:  [-11.98299529]
curr_Stock_Price:  97.52387550437098
curr_Factors:  [9.75238755e+01 3.97306246e-02]
mat_Sqrt:  [[ 1.94389878e+01  0.00000000e+00]
 [-7.97301695e-03  1.82684769e-02]]
grads:  [ 2.64902606e-02 -4.54354058e+01]
Stock Position:  0.026490260595665126
Bond Position:  [-14.56642817]


portfolio before change:  [-11.9841871]
curr_Stock_Price:  97.54762425681582
curr_Factors:  [9.75476243e+01 3.94561071e-02]
mat_Sqrt:  [[ 1.93764322e+01  0.00000000e+00]
 [-7.94542455e-03  1.82052547e-02]]
grads:  [3.16096866e-03 1.05157262e+01]
Stock Position:  0.003160968656093946
Bond Position:  [-12.29253208]


portfolio before change:  [-11.98482748]
curr_Stock_Price:  97.8311710324526
curr_Factors:  [9.78311710e+01 3.88783338e-02]
mat_Sqrt:  [[ 1.92899488e+01  0.00000000e+00]
 [-7.88703583e-03  1.80714693e-02]]
grads:  [ 3.00184145e-04 -3.29485841e+00]
Stock Position:  0.00030018414451494206
Bond Position:  [-12.01419485]


portfolio before change:  [-11.98618327]
curr_Stock_Price:  98.31779651914842
curr_Factors:  [9.83177965e+01 3.77489736e-02]
mat_Sqrt:  [[ 1.91022582e+01  0.00000000e+00]
 [-7.77163804e-03  1.78070598e-02]]
grads:  [-0.00652521 -5.55125353]
Stock Position:  -0.006525212528894086
Bond Position:  [-11.34463875]


portfolio before change:  [-11.98811386]
curr_Stock_Price:  98.39632625647018
curr_Factors:  [9.83963263e+01 3.86556653e-02]
mat_Sqrt:  [[ 1.93457450e+01  0.00000000e+00]
 [-7.86441762e-03  1.80196445e-02]]
grads:  [6.72934242e-04 9.74580896e+00]
Stock Position:  0.0006729342416462603
Bond Position:  [-12.05432812]


portfolio before change:  [-11.98925169]
curr_Stock_Price:  98.9447558021144
curr_Factors:  [9.89447558e+01 3.79360859e-02]
mat_Sqrt:  [[ 1.92716563e+01  0.00000000e+00]
 [-7.79087527e-03  1.78511378e-02]]
grads:  [-0.00524108 -4.29441356]
Stock Position:  -0.005241075232356108
Bond Position:  [-11.47067478]


portfolio before change:  [-11.99603537]
curr_Stock_Price:  99.96549257745717
curr_Factors:  [9.99654926e+01 3.68978781e-02]
mat_Sqrt:  [[ 1.92021919e+01  0.00000000e+00]
 [-7.68352816e-03  1.76051747e-02]]
grads:  [0.00975548 4.17891867]
Stock Position:  0.00975547997467764
Bond Position:  [-12.97124673]


portfolio before change:  [-11.99493509]
curr_Stock_Price:  100.24449333254988
curr_Factors:  [1.00244493e+02 3.72845869e-02]
mat_Sqrt:  [[ 1.93564269e+01  0.00000000e+00]
 [-7.72368688e-03  1.76971899e-02]]
grads:  [ 0.01180553 -7.00553876]
Stock Position:  0.011805534860120611
Bond Position:  [-13.17837496]


portfolio before change:  [-11.99072613]
curr_Stock_Price:  100.74056280012157
curr_Factors:  [1.00740563e+02 3.57323486e-02]
mat_Sqrt:  [[ 1.90429906e+01  0.00000000e+00]
 [-7.56120082e-03  1.73248875e-02]]
grads:  [0.00425915 1.37010168]
Stock Position:  0.004259145952605298
Bond Position:  [-12.41979489]


portfolio before change:  [-11.99494195]
curr_Stock_Price:  100.11526092666709
curr_Factors:  [1.00115261e+02 3.48225137e-02]
mat_Sqrt:  [[ 1.86823000e+01  0.00000000e+00]
 [-7.46431657e-03  1.71028979e-02]]
grads:  [-0.00558663 -0.44687291]
Stock Position:  -0.00558662708811715
Bond Position:  [-11.43563532]


portfolio before change:  [-11.9931376]
curr_Stock_Price:  99.53639754143369
curr_Factors:  [9.95363975e+01 3.44278095e-02]
mat_Sqrt:  [[ 1.84687122e+01  0.00000000e+00]
 [-7.42189297e-03  1.70056932e-02]]
grads:  [4.45063374e-03 4.91474198e+00]
Stock Position:  0.004450633736747178
Bond Position:  [-12.43613765]


portfolio before change:  [-11.99715945]
curr_Stock_Price:  98.98204266752823
curr_Factors:  [9.89820427e+01 3.51732310e-02]
mat_Sqrt:  [[ 1.85636146e+01  0.00000000e+00]
 [-7.50181108e-03  1.71888086e-02]]
grads:  [ -0.02425736 -22.38442253]
Stock Position:  -0.02425735561780617
Bond Position:  [-9.59611684]


portfolio before change:  [-11.99980746]
curr_Stock_Price:  99.04175319099566
curr_Factors:  [9.90417532e+01 3.38918520e-02]
mat_Sqrt:  [[ 1.82333291e+01  0.00000000e+00]
 [-7.36389592e-03  1.68728052e-02]]
grads:  [1.00032699e-02 1.34951768e+01]
Stock Position:  0.010003269901769935
Bond Position:  [-12.99054884]


portfolio before change:  [-12.01436885]
curr_Stock_Price:  97.74842831653817
curr_Factors:  [9.77484283e+01 3.45858118e-02]
mat_Sqrt:  [[ 1.81785304e+01  0.00000000e+00]
 [-7.43890441e-03  1.70446713e-02]]
grads:  [ 0.0027331 -0.0849893]
Stock Position:  0.0027330974718738407
Bond Position:  [-12.28152484]


portfolio before change:  [-12.0174484]
curr_Stock_Price:  97.18340657866355
curr_Factors:  [9.71834066e+01 3.53827853e-02]
mat_Sqrt:  [[ 1.82805024e+01  0.00000000e+00]
 [-7.52412496e-03  1.72399361e-02]]
grads:  [ 3.25763629e-04 -2.15199876e+00]
Stock Position:  0.00032576362942712394
Bond Position:  [-12.04910722]


portfolio before change:  [-12.01907044]
curr_Stock_Price:  96.82789838062499
curr_Factors:  [9.68278984e+01 3.35608830e-02]
mat_Sqrt:  [[ 1.77385124e+01  0.00000000e+00]
 [-7.32785185e-03  1.67902179e-02]]
grads:  [0.00460645 3.56449479]
Stock Position:  0.004606450679060414
Bond Position:  [-12.46510338]


portfolio before change:  [-12.02059917]
curr_Stock_Price:  96.8343043578703
curr_Factors:  [9.68343044e+01 3.46968588e-02]
mat_Sqrt:  [[ 1.80374158e+01  0.00000000e+00]
 [-7.45083714e-03  1.70720126e-02]]
grads:  [1.75619714e-03 2.50163506e+00]
Stock Position:  0.0017561971422183913
Bond Position:  [-12.1906593]


portfolio before change:  [-12.02140196]
curr_Stock_Price:  97.24493091885199
curr_Factors:  [9.72449309e+01 3.52440097e-02]
mat_Sqrt:  [[ 1.82561682e+01  0.00000000e+00]
 [-7.50935520e-03  1.72060943e-02]]
grads:  [ 0.00629991 -6.02409482]
Stock Position:  0.00629991159742668
Bond Position:  [-12.63403643]


portfolio before change:  [-12.02829516]
curr_Stock_Price:  96.40145083679273
curr_Factors:  [9.64014508e+01 3.50445669e-02]
mat_Sqrt:  [[ 1.80465388e+01  0.00000000e+00]
 [-7.48807766e-03  1.71573414e-02]]
grads:  [ 0.00233444 -2.20185569]
Stock Position:  0.0023344426960149787
Bond Position:  [-12.25333882]


portfolio before change:  [-12.02405173]
curr_Stock_Price:  98.87535950597447
curr_Factors:  [9.88753595e+01 3.46739383e-02]
mat_Sqrt:  [[ 1.84115207e+01  0.00000000e+00]
 [-7.44837574e-03  1.70663728e-02]]
grads:  [1.11268888e-02 1.75816023e+01]
Stock Position:  0.011126888800016208
Bond Position:  [-13.12422686]


portfolio before change:  [-12.04243918]
curr_Stock_Price:  97.37028254953032
curr_Factors:  [9.73702825e+01 3.60549834e-02]
mat_Sqrt:  [[ 1.84888151e+01  0.00000000e+00]
 [-7.59525993e-03  1.74029268e-02]]
grads:  [6.89251830e-03 1.21968817e+01]
Stock Position:  0.006892518300638606
Bond Position:  [-12.71356563]


portfolio before change:  [-12.04717948]
curr_Stock_Price:  96.91311976604425
curr_Factors:  [9.69131198e+01 3.70071162e-02]
mat_Sqrt:  [[ 1.86434034e+01  0.00000000e+00]
 [-7.69489349e-03  1.76312159e-02]]
grads:  [-2.12546698e-03  5.99281456e+00]
Stock Position:  -0.0021254669805002057
Bond Position:  [-11.84119384]


portfolio before change:  [-12.05408831]
curr_Stock_Price:  99.46718689422147
curr_Factors:  [9.94671869e+01 3.78506559e-02]
mat_Sqrt:  [[ 1.93515849e+01  0.00000000e+00]
 [-7.78209801e-03  1.78310266e-02]]
grads:  [1.70810525e-03 2.17169177e+00]
Stock Position:  0.0017081052490597684
Bond Position:  [-12.22398873]


portfolio before change:  [-12.05624043]
curr_Stock_Price:  99.10185138973273
curr_Factors:  [9.91018514e+01 3.84169664e-02]
mat_Sqrt:  [[ 1.94242072e+01  0.00000000e+00]
 [-7.84009862e-03  1.79639227e-02]]
grads:  [ 0.02209791 -5.79508628]
Stock Position:  0.02209790804232926
Bond Position:  [-14.24618403]


portfolio before change:  [-12.04482205]
curr_Stock_Price:  99.69915958265776
curr_Factors:  [9.96991596e+01 3.81656675e-02]
mat_Sqrt:  [[ 1.94772630e+01  0.00000000e+00]
 [-7.81441411e-03  1.79050721e-02]]
grads:  [2.30234959e-03 4.66318614e+00]
Stock Position:  0.0023023495891797696
Bond Position:  [-12.27436437]


portfolio before change:  [-12.04841415]
curr_Stock_Price:  98.80541949137064
curr_Factors:  [9.88054195e+01 3.69915058e-02]
mat_Sqrt:  [[ 1.90034202e+01  0.00000000e+00]
 [-7.69327038e-03  1.76274969e-02]]
grads:  [-7.37805716e-03  8.23903853e+00]
Stock Position:  -0.007378057161277432
Bond Position:  [-11.31942211]


portfolio before change:  [-12.04759109]
curr_Stock_Price:  98.50207715083116
curr_Factors:  [9.85020772e+01 3.65931547e-02]
mat_Sqrt:  [[ 1.88427946e+01  0.00000000e+00]
 [-7.65173494e-03  1.75323273e-02]]
grads:  [-5.73163441e-03 -6.04956417e+00]
Stock Position:  -0.005731634413260819
Bond Position:  [-11.48301319]


portfolio before change:  [-12.05655205]
curr_Stock_Price:  99.815053301853
curr_Factors:  [9.98150533e+01 3.57057698e-02]
mat_Sqrt:  [[ 1.88610229e+01  0.00000000e+00]
 [-7.55838816e-03  1.73184429e-02]]
grads:  [-4.35627402e-04 -2.85524800e+00]
Stock Position:  -0.00043562740217982764
Bond Position:  [-12.01306988]


portfolio before change:  [-12.05842411]
curr_Stock_Price:  100.66515504044465
curr_Factors:  [1.00665155e+02 3.69304093e-02]
mat_Sqrt:  [[ 1.93451111e+01  0.00000000e+00]
 [-7.68691452e-03  1.76129338e-02]]
grads:  [-0.03300812 -5.35892958]
Stock Position:  -0.03300812227876828
Bond Position:  [-8.73565636]


portfolio before change:  [-12.05284082]
curr_Stock_Price:  100.46292251550665
curr_Factors:  [1.00462923e+02 3.60370119e-02]
mat_Sqrt:  [[ 1.90712954e+01  0.00000000e+00]
 [-7.59336677e-03  1.73985890e-02]]
grads:  [-0.00609682  0.23247398]
Stock Position:  -0.006096821085618603
Bond Position:  [-11.44033635]


portfolio before change:  [-12.05209888]
curr_Stock_Price:  100.10666022506936
curr_Factors:  [1.00106660e+02 3.68826946e-02]
mat_Sqrt:  [[ 1.92253517e+01  0.00000000e+00]
 [-7.68194711e-03  1.76015520e-02]]
grads:  [ 0.00333478 -0.54630674]
Stock Position:  0.0033347752555879565
Bond Position:  [-12.38593209]


portfolio before change:  [-12.05421273]
curr_Stock_Price:  99.93707895644506
curr_Factors:  [9.9937079e+01 3.7777150e-02]
mat_Sqrt:  [[ 1.94241153e+01  0.00000000e+00]
 [-7.77453793e-03  1.78137043e-02]]
grads:  [0.00765515 4.89232822]
Stock Position:  0.007655149211077094
Bond Position:  [-12.81924599]


portfolio before change:  [-12.05110274]
curr_Stock_Price:  100.55267770331045
curr_Factors:  [1.00552678e+02 3.81391493e-02]
mat_Sqrt:  [[ 1.96371809e+01  0.00000000e+00]
 [-7.81169885e-03  1.78988506e-02]]
grads:  [-0.01675919 -7.00003888]
Stock Position:  -0.01675919426265428
Bond Position:  [-10.36592088]


portfolio before change:  [-12.06725244]
curr_Stock_Price:  101.43898997341472
curr_Factors:  [1.01438990e+02 3.85864082e-02]
mat_Sqrt:  [[ 1.99260903e+01  0.00000000e+00]
 [-7.85736935e-03  1.80034949e-02]]
grads:  [-1.61579363e-02 -2.28336540e+01]
Stock Position:  -0.016157936282203043
Bond Position:  [-10.4282077]


portfolio before change:  [-12.06695099]
curr_Stock_Price:  101.33965460448817
curr_Factors:  [1.01339655e+02 3.88190668e-02]
mat_Sqrt:  [[ 1.99665010e+01  0.00000000e+00]
 [-7.88102194e-03  1.80576898e-02]]
grads:  [9.97025070e-04 1.50196821e+01]
Stock Position:  0.0009970250696801296
Bond Position:  [-12.16798917]


portfolio before change:  [-12.06836719]
curr_Stock_Price:  101.44486816749743
curr_Factors:  [1.01444868e+02 3.95255995e-02]
mat_Sqrt:  [[ 2.01683010e+01  0.00000000e+00]
 [-7.95241845e-03  1.82212797e-02]]
grads:  [-3.55341036e-03  6.47435284e+00]
Stock Position:  -0.003553410355740231
Bond Position:  [-11.70789194]


portfolio before change:  [-12.0697829]
curr_Stock_Price:  101.43139711897963
curr_Factors:  [1.01431397e+02 3.96139096e-02]
mat_Sqrt:  [[ 2.01881378e+01  0.00000000e+00]
 [-7.96129734e-03  1.82416239e-02]]
grads:  [0.00959764 4.69336755]
Stock Position:  0.009597636020165555
Bond Position:  [-13.04328453]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.0583555]
Stock Price:  102.79193116708873
PL:  [-14.85028667]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 6.31524751e-02  3.38499683e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.18243957e-01 -7.00005760e-01]
 [-3.73320518e-02  4.82655828e-02]
 [ 1.00839530e-02 -6.75762371e-04]
 [-8.73498794e-02 -6.54467775e-02]
 [-3.61860101e-03  3.22263628e-01]
 [ 2.49288923e-01 -2.11857355e-03]
 [ 1.54433516e-01  7.38200078e-02]
 [ 3.06023325e-01 -1.41102146e-01]
 [ 7.06505673e-02  2.34029850e-02]
 [-1.49705750e-01 -1.34278316e-01]
 [-1.92715666e-01  1.65567200e-01]
 [-6.21589153e-01 -7.85546101e-01]
 [ 1.53350793e-02 -5.05984428e-02]
 [ 3.06317778e-02 -1.19134568e-01]
 [-5.35711622e-02  3.04416588e-01]
 [-3.50313178e-02  1.28923593e-01]
 [ 1.47522741e-02  6.95048585e-02]
 [-1.01252594e-01 -3.51657484e-02]
 [ 2.30517726e-01  2.57519242e-01]
 [ 3.93484518e-03  7.28400235e-02]
 [-5.07414648e-03  1.57172507e-01]
 [ 3.99305726e-02  1.70610659e-01]
 [ 3.07776039e-02  6.99431976e-02]
 [ 7.14788624e-01 -3.14125442e-01]
 [-2.34382610e-01  3.09761402e-01]
 [ 1.45447112e-01 -2.69940413e-03]
 [-4.60674540e-02 -6.40421567e-02]
 [ 8.78850725e-03 -1.77564853e-01]
 [-1.89901055e-01 -8.23103943e-02]
 [ 3.89324045e-02 -8.31485593e-03]
 [ 1.67785446e-01  1.66715142e-01]
 [ 1.78825423e-01  5.21780582e-02]
 [-2.40778606e-01 -2.04063010e-01]
 [ 9.57818310e-02 -3.31533758e-01]
 [-1.57305062e-01  2.18748626e-01]
 [-1.21171805e-01  1.19307557e-01]
 [-9.34117990e-02  1.23389751e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.20677432]
curr_Stock_Price:  100.0751543221055
curr_Factors:  [1.00075154e+02 3.99124902e-02]
mat_Sqrt:  [[ 1.99931250e+01  0.00000000e+00]
 [-7.99124423e-03  1.83102408e-02]]
grads:  [1.05479183e-02 1.84869051e+01]
Stock Position:  0.010547918276885358
Bond Position:  [2.15118977]


portfolio before change:  [3.19488994]
curr_Stock_Price:  98.92295558321445
curr_Factors:  [9.89229556e+01 4.05311552e-02]
mat_Sqrt:  [[ 1.99155165e+01  0.00000000e+00]
 [-8.05294035e-03  1.84516044e-02]]
grads:  [-0.01019228 -4.76984919]
Stock Position:  -0.010192276353739779
Bond Position:  [4.20314004]


portfolio before change:  [3.18856286]
curr_Stock_Price:  99.59527845785681
curr_Factors:  [9.95952785e+01 3.99083516e-02]
mat_Sqrt:  [[ 1.98962232e+01  0.00000000e+00]
 [-7.99082990e-03  1.83092914e-02]]
grads:  [ 2.57705390e-02 -3.82322692e+01]
Stock Position:  0.025770539024788958
Bond Position:  [0.62193885]


portfolio before change:  [3.1900039]
curr_Stock_Price:  99.64817948701912
curr_Factors:  [9.96481795e+01 3.91244353e-02]
mat_Sqrt:  [[ 1.97103080e+01  0.00000000e+00]
 [-7.91195908e-03  1.81285757e-02]]
grads:  [-8.25315593e-04  2.66240347e+00]
Stock Position:  -0.0008253155932330846
Bond Position:  [3.27224509]


portfolio before change:  [3.19035637]
curr_Stock_Price:  99.7167365714831
curr_Factors:  [9.97167366e+01 3.96979298e-02]
mat_Sqrt:  [[ 1.98679010e+01  0.00000000e+00]
 [-7.96973574e-03  1.82609586e-02]]
grads:  [ 0.00049271 -0.03700585]
Stock Position:  0.0004927056039563506
Bond Position:  [3.14122538]


portfolio before change:  [3.19108993]
curr_Stock_Price:  100.40858430620406
curr_Factors:  [1.00408584e+02 3.83160124e-02]
mat_Sqrt:  [[ 1.96544546e+01  0.00000000e+00]
 [-7.82979054e-03  1.79403039e-02]]
grads:  [-0.00589755 -3.64803059]
Stock Position:  -0.005897553367678811
Bond Position:  [3.78325491]


portfolio before change:  [3.19005066]
curr_Stock_Price:  100.66499560352955
curr_Factors:  [1.00664996e+02 3.84319245e-02]
mat_Sqrt:  [[ 1.97344281e+01  0.00000000e+00]
 [-7.84162478e-03  1.79674196e-02]]
grads:  [6.94364065e-03 1.79359995e+01]
Stock Position:  0.006943640649926398
Bond Position:  [2.49106911]


portfolio before change:  [3.19669058]
curr_Stock_Price:  101.57640764978855
curr_Factors:  [1.01576408e+02 3.63436372e-02]
mat_Sqrt:  [[ 1.93645337e+01  0.00000000e+00]
 [-7.62560290e-03  1.74724513e-02]]
grads:  [ 0.01282573 -0.12125222]
Stock Position:  0.012825731077381537
Bond Position:  [1.89389889]


portfolio before change:  [3.17693407]
curr_Stock_Price:  100.0175673542722
curr_Factors:  [1.00017567e+02 3.67651791e-02]
mat_Sqrt:  [[ 1.91776165e+01  0.00000000e+00]
 [-7.66969925e-03  1.75734887e-02]]
grads:  [0.00973276 4.20064617]
Stock Position:  0.009732763613429696
Bond Position:  [2.20348673]


portfolio before change:  [3.18531422]
curr_Stock_Price:  100.85029009213052
curr_Factors:  [1.00850290e+02 3.65563026e-02]
mat_Sqrt:  [[ 1.92822755e+01  0.00000000e+00]
 [-7.64788103e-03  1.75234969e-02]]
grads:  [ 0.01267699 -8.0521683 ]
Stock Position:  0.012676994458787142
Bond Position:  [1.90683565]


portfolio before change:  [3.18433785]
curr_Stock_Price:  100.75446801941251
curr_Factors:  [1.00754468e+02 3.52216942e-02]
mat_Sqrt:  [[ 1.89090380e+01  0.00000000e+00]
 [-7.50697746e-03  1.72006462e-02]]
grads:  [0.0042765  1.36058754]
Stock Position:  0.004276498212776629
Bond Position:  [2.75346155]


portfolio before change:  [3.1870378]
curr_Stock_Price:  101.30532729691862
curr_Factors:  [1.01305327e+02 3.54946290e-02]
mat_Sqrt:  [[ 1.90859422e+01  0.00000000e+00]
 [-7.53600733e-03  1.72671620e-02]]
grads:  [-0.0109143  -7.77651337]
Stock Position:  -0.010914295418884078
Bond Position:  [4.29271407]


portfolio before change:  [3.17753523]
curr_Stock_Price:  102.22514798075406
curr_Factors:  [1.02225148e+02 3.47170029e-02]
mat_Sqrt:  [[ 1.90471000e+01  0.00000000e+00]
 [-7.45299971e-03  1.70769677e-02]]
grads:  [-6.32412369e-03  9.69535128e+00]
Stock Position:  -0.006324123686892203
Bond Position:  [3.82401971]


portfolio before change:  [3.17356161]
curr_Stock_Price:  102.92906421140408
curr_Factors:  [1.02929064e+02 3.45720164e-02]
mat_Sqrt:  [[ 1.91381688e+01  0.00000000e+00]
 [-7.43742068e-03  1.70412716e-02]]
grads:  [ -0.05039299 -46.09668335]
Stock Position:  -0.05039299165572497
Bond Position:  [8.36046508]


portfolio before change:  [3.15306277]
curr_Stock_Price:  103.35658330301156
curr_Factors:  [1.03356583e+02 3.41691336e-02]
mat_Sqrt:  [[ 1.91053557e+01  0.00000000e+00]
 [-7.39395792e-03  1.69416859e-02]]
grads:  [-3.53193718e-04 -2.98662383e+00]
Stock Position:  -0.0003531937179164972
Bond Position:  [3.18956766]


portfolio before change:  [3.15326412]
curr_Stock_Price:  103.91539989790549
curr_Factors:  [1.03915400e+02 3.34503517e-02]
mat_Sqrt:  [[ 1.90055419e+01  0.00000000e+00]
 [-7.31577493e-03  1.67625462e-02]]
grads:  [-1.12403058e-03 -7.10718804e+00]
Stock Position:  -0.0011240305774617226
Bond Position:  [3.2700682]


portfolio before change:  [3.15374382]
curr_Stock_Price:  103.85230968895763
curr_Factors:  [1.03852310e+02 3.30827634e-02]
mat_Sqrt:  [[ 1.88893515e+01  0.00000000e+00]
 [-7.27546709e-03  1.66701893e-02]]
grads:  [4.19745108e-03 1.82611356e+01]
Stock Position:  0.004197451076391347
Bond Position:  [2.71782883]


portfolio before change:  [3.1507694]
curr_Stock_Price:  103.06274258718257
curr_Factors:  [1.03062743e+02 3.27923253e-02]
mat_Sqrt:  [[ 1.86632727e+01  0.00000000e+00]
 [-7.24346053e-03  1.65968531e-02]]
grads:  [1.13782570e-03 7.76795412e+00]
Stock Position:  0.001137825696069846
Bond Position:  [3.03350196]


portfolio before change:  [3.15197398]
curr_Stock_Price:  103.788136702372
curr_Factors:  [1.03788137e+02 3.15540759e-02]
mat_Sqrt:  [[ 1.84363714e+01  0.00000000e+00]
 [-7.10538679e-03  1.62804864e-02]]
grads:  [2.44552902e-03 4.26921265e+00]
Stock Position:  0.0024455290227463683
Bond Position:  [2.89815708]


portfolio before change:  [3.15251029]
curr_Stock_Price:  103.85929596143241
curr_Factors:  [1.03859296e+02 3.15721645e-02]
mat_Sqrt:  [[ 1.84542990e+01  0.00000000e+00]
 [-7.10742311e-03  1.62851522e-02]]
grads:  [-0.00631832 -2.15937487]
Stock Position:  -0.006318320984244852
Bond Position:  [3.80872666]


portfolio before change:  [3.15323234]
curr_Stock_Price:  103.8203735105007
curr_Factors:  [1.03820374e+02 3.09305968e-02]
mat_Sqrt:  [[ 1.82589894e+01  0.00000000e+00]
 [-7.03483865e-03  1.61188403e-02]]
grads:  [ 0.01878025 15.97628845]
Stock Position:  0.018780247329061757
Bond Position:  [1.20346005]


portfolio before change:  [3.13280395]
curr_Stock_Price:  102.72460334631488
curr_Factors:  [1.02724603e+02 3.16265932e-02]
mat_Sqrt:  [[ 1.82684070e+01  0.00000000e+00]
 [-7.11354688e-03  1.62991835e-02]]
grads:  [1.95555297e-03 4.46893695e+00]
Stock Position:  0.0019555529722216055
Bond Position:  [2.93192054]


portfolio before change:  [3.13444478]
curr_Stock_Price:  103.37624656777469
curr_Factors:  [1.03376247e+02 3.21314139e-02]
mat_Sqrt:  [[ 1.85304377e+01  0.00000000e+00]
 [-7.17009499e-03  1.64287515e-02]]
grads:  [3.42795785e-03 9.56691730e+00]
Stock Position:  0.0034279578490752044
Bond Position:  [2.78007537]


portfolio before change:  [3.1313658]
curr_Stock_Price:  102.37666694751397
curr_Factors:  [1.02376667e+02 3.25587228e-02]
mat_Sqrt:  [[ 1.84728824e+01  0.00000000e+00]
 [-7.21761432e-03  1.65376320e-02]]
grads:  [6.19238330e-03 1.03165108e+01]
Stock Position:  0.006192383298262504
Bond Position:  [2.49741023]


portfolio before change:  [3.1280368]
curr_Stock_Price:  101.78865609445617
curr_Factors:  [1.01788656e+02 3.25711787e-02]
mat_Sqrt:  [[ 1.83702945e+01  0.00000000e+00]
 [-7.21899480e-03  1.65407951e-02]]
grads:  [3.33708956e-03 4.22852695e+00]
Stock Position:  0.003337089562158403
Bond Position:  [2.78835894]


portfolio before change:  [3.12899286]
curr_Stock_Price:  101.97069738191975
curr_Factors:  [1.01970697e+02 3.24768343e-02]
mat_Sqrt:  [[ 1.83764761e+01  0.00000000e+00]
 [-7.20853209e-03  1.65168220e-02]]
grads:  [  0.03143655 -19.01851596]
Stock Position:  0.031436551698874694
Bond Position:  [-0.07661424]


portfolio before change:  [3.16244657]
curr_Stock_Price:  103.03516802398003
curr_Factors:  [1.03035168e+02 3.39956803e-02]
mat_Sqrt:  [[ 1.89975393e+01  0.00000000e+00]
 [-7.37516701e-03  1.68986305e-02]]
grads:  [-5.22128938e-03  1.83305624e+01]
Stock Position:  -0.005221289379667764
Bond Position:  [3.700423]


portfolio before change:  [3.15989773]
curr_Stock_Price:  103.61192637420504
curr_Factors:  [1.03611926e+02 3.26274687e-02]
mat_Sqrt:  [[ 1.87155002e+01  0.00000000e+00]
 [-7.22523010e-03  1.65550819e-02]]
grads:  [ 0.00770853 -0.16305592]
Stock Position:  0.007708530019572989
Bond Position:  [2.36120208]


portfolio before change:  [3.1663939]
curr_Stock_Price:  104.4163607361039
curr_Factors:  [1.04416361e+02 3.20116978e-02]
mat_Sqrt:  [[ 1.86819802e+01  0.00000000e+00]
 [-7.15672526e-03  1.63981176e-02]]
grads:  [-0.00396199 -3.90545782]
Stock Position:  -0.003961985933410921
Bond Position:  [3.58009006]


portfolio before change:  [3.16635656]
curr_Stock_Price:  104.53874421507362
curr_Factors:  [1.04538744e+02 3.16673446e-02]
mat_Sqrt:  [[ 1.86030050e+01  0.00000000e+00]
 [-7.11812836e-03  1.63096810e-02]]
grads:  [-3.69333598e-03 -1.08870831e+01]
Stock Position:  -0.003693335980991086
Bond Position:  [3.55245327]


portfolio before change:  [3.16901946]
curr_Stock_Price:  103.93798223781965
curr_Factors:  [1.03937982e+02 3.32402409e-02]
mat_Sqrt:  [[ 1.89498756e+01  0.00000000e+00]
 [-7.29276254e-03  1.67098182e-02]]
grads:  [-0.01191693 -4.92587013]
Stock Position:  -0.011916925545177173
Bond Position:  [4.40764066]


portfolio before change:  [3.1529819]
curr_Stock_Price:  105.32999833747297
curr_Factors:  [1.05329998e+02 3.39343402e-02]
mat_Sqrt:  [[ 1.94031295e+01  0.00000000e+00]
 [-7.36851032e-03  1.68833781e-02]]
grads:  [ 0.00181947 -0.49248769]
Stock Position:  0.0018194747350555231
Bond Position:  [2.96133663]


portfolio before change:  [3.1502163]
curr_Stock_Price:  103.60654258688781
curr_Factors:  [1.03606543e+02 3.37091597e-02]
mat_Sqrt:  [[ 1.90222176e+01  0.00000000e+00]
 [-7.34402175e-03  1.68272678e-02]]
grads:  [0.01264552 9.90743975]
Stock Position:  0.012645523493188418
Bond Position:  [1.84005734]


portfolio before change:  [3.13463282]
curr_Stock_Price:  102.35602072192661
curr_Factors:  [1.02356021e+02 3.44221866e-02]
mat_Sqrt:  [[ 1.89903348e+01  0.00000000e+00]
 [-7.42128686e-03  1.70043044e-02]]
grads:  [0.01061581 3.06852059]
Stock Position:  0.010615810441287144
Bond Position:  [2.04804071]


portfolio before change:  [3.14905665]
curr_Stock_Price:  103.69061593868865
curr_Factors:  [1.03690616e+02 3.39815994e-02]
mat_Sqrt:  [[ 1.91144305e+01  0.00000000e+00]
 [-7.37363947e-03  1.68951305e-02]]
grads:  [ -0.01725602 -12.07821448]
Stock Position:  -0.017256020559389393
Bond Position:  [4.93834405]


portfolio before change:  [3.15692976]
curr_Stock_Price:  103.27013817291717
curr_Factors:  [1.03270138e+02 3.30569324e-02]
mat_Sqrt:  [[ 1.87761278e+01  0.00000000e+00]
 [-7.27262620e-03  1.66636800e-02]]
grads:  [-2.60497607e-03 -1.98955908e+01]
Stock Position:  -0.002604976069589481
Bond Position:  [3.425946]


portfolio before change:  [3.15733818]
curr_Stock_Price:  103.27775575390781
curr_Factors:  [1.03277756e+02 3.36362422e-02]
mat_Sqrt:  [[ 1.89413325e+01  0.00000000e+00]
 [-7.33607439e-03  1.68090581e-02]]
grads:  [-3.26457149e-03  1.30137349e+01]
Stock Position:  -0.0032645714949952227
Bond Position:  [3.4944958]


portfolio before change:  [3.15836048]
curr_Stock_Price:  103.09841788225731
curr_Factors:  [1.03098418e+02 3.34867174e-02]
mat_Sqrt:  [[ 1.88663675e+01  0.00000000e+00]
 [-7.31975053e-03  1.67716554e-02]]
grads:  [-3.66269332e-03  7.11364230e+00]
Stock Position:  -0.0036626933226063855
Bond Position:  [3.53597837]


portfolio before change:  [3.1552951]
curr_Stock_Price:  104.0560227609996
curr_Factors:  [1.04056023e+02 3.28521936e-02]
mat_Sqrt:  [[ 1.88603353e+01  0.00000000e+00]
 [-7.25006963e-03  1.66119964e-02]]
grads:  [-2.09752882e-03  7.42774965e+00]
Stock Position:  -0.0020975288233326304
Bond Position:  [3.3735556]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.15739573]
Stock Price:  103.25560082535328
PL:  [-0.0982051]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.95889870e-01  2.39063422e-02]
 [-1.64868554e-01 -8.63543201e-02]
 [ 8.43702654e-01 -7.53588686e-01]
 [-3.10431348e-02  1.50549534e-01]
 [ 2.82376288e-02 -6.94483310e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-9.93114632e-02  1.27181051e-01]
 [ 6.92968605e-03 -1.30535169e-01]
 [ 1.65514871e-01  1.16772107e-01]
 [ 1.39233714e-01  3.59028509e-02]
 [ 1.27218838e-01  2.24032558e-01]
 [ 1.39122698e-01  2.04622382e-01]
 [ 1.75848273e-01  3.14216018e-02]
 [-2.60708198e-01 -3.61748486e-01]
 [ 8.12050170e-02  2.26292663e-01]
 [ 5.35676321e-02 -2.01287873e-02]
 [-5.26328974e-02  2.51673687e-01]
 [-1.09559710e-01  5.29050712e-02]
 [ 1.48631208e-02  6.67525200e-02]
 [-1.02127788e-01 -3.54916606e-02]
 [ 2.12946040e-01  3.57741213e-01]
 [ 3.18543889e-02  1.67488344e-02]
 [-1.08229176e-02 -7.19614642e-02]
 [ 7.50805074e-02  1.82840818e-01]
 [ 8.47243936e-02  1.75444260e-01]
 [ 8.12969100e-01 -7.36756819e-01]
 [-7.47485009e-01  9.11282487e-01]
 [ 6.77015864e-02 -1.55893600e-02]
 [-5.56484915e-02 -5.35716716e-02]
 [ 1.29549377e-01 -9.16014437e-02]
 [-1.51364884e-01 -1.48392836e-01]
 [ 2.98598177e-01 -2.83001053e-02]
 [ 2.94723297e-01  3.78246087e-01]
 [ 2.46757908e-01  1.73256945e-02]
 [-1.48223223e-01 -2.45147098e-01]
 [ 1.73890297e-01 -1.03335691e-01]
 [-1.88752122e-01  1.93747675e-01]
 [-1.19308433e-01  1.20564627e-01]
 [-1.91160239e-01  1.48347406e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.78176348]
curr_Stock_Price:  99.17318360273549
curr_Factors:  [9.91731836e+01 4.02986782e-02]
mat_Sqrt:  [[ 1.99085512e+01  0.00000000e+00]
 [-8.02981228e-03  1.83986113e-02]]
grads:  [-0.00931541  1.2993558 ]
Stock Position:  -0.00931540848429683
Bond Position:  [-1.85792476]


portfolio before change:  [-2.78234915]
curr_Stock_Price:  99.21112207371213
curr_Factors:  [9.92111221e+01 4.02745794e-02]
mat_Sqrt:  [[ 1.99102113e+01  0.00000000e+00]
 [-8.02741098e-03  1.83931092e-02]]
grads:  [-0.01017351 -4.69492781]
Stock Position:  -0.010173506789388565
Bond Position:  [-1.77302412]


portfolio before change:  [-2.77743366]
curr_Stock_Price:  98.70617081328166
curr_Factors:  [9.87061708e+01 4.00251884e-02]
mat_Sqrt:  [[ 1.97474488e+01  0.00000000e+00]
 [-8.00251844e-03  1.83360733e-02]]
grads:  [ 2.60696758e-02 -4.10986952e+01]
Stock Position:  0.026069675763715175
Bond Position:  [-5.35067153]


portfolio before change:  [-2.79256008]
curr_Stock_Price:  98.15159778937004
curr_Factors:  [9.81515978e+01 3.92675417e-02]
mat_Sqrt:  [[ 1.94497593e+01  0.00000000e+00]
 [-7.92641575e-03  1.81617001e-02]]
grads:  [1.78213356e-03 8.28939656e+00]
Stock Position:  0.001782133556534196
Bond Position:  [-2.96747934]


portfolio before change:  [-2.7939918]
curr_Stock_Price:  97.55637472153684
curr_Factors:  [9.75563747e+01 3.98122532e-02]
mat_Sqrt:  [[ 1.94654313e+01  0.00000000e+00]
 [-7.98120323e-03  1.82872340e-02]]
grads:  [-1.06450647e-04 -3.79763999e+00]
Stock Position:  -0.00010645064744758159
Bond Position:  [-2.78360687]


portfolio before change:  [-2.794528]
curr_Stock_Price:  99.32457825139954
curr_Factors:  [9.93245783e+01 3.91604272e-02]
mat_Sqrt:  [[ 1.96553345e+01  0.00000000e+00]
 [-7.91559748e-03  1.81369123e-02]]
grads:  [-0.00602487 -3.65646185]
Stock Position:  -0.006024866759770903
Bond Position:  [-2.19611065]


portfolio before change:  [-2.78284957]
curr_Stock_Price:  97.34063918422596
curr_Factors:  [9.73406392e+01 4.12085413e-02]
mat_Sqrt:  [[ 1.97600398e+01  0.00000000e+00]
 [-8.11995481e-03  1.86051538e-02]]
grads:  [-2.21685292e-03  6.83579684e+00]
Stock Position:  -0.002216852916273552
Bond Position:  [-2.56705969]


portfolio before change:  [-2.78171115]
curr_Stock_Price:  96.68235407764246
curr_Factors:  [9.66823541e+01 4.24306550e-02]
mat_Sqrt:  [[ 1.99153106e+01  0.00000000e+00]
 [-8.23948105e-03  1.88790228e-02]]
grads:  [-2.51266643e-03 -6.91429692e+00]
Stock Position:  -0.002512666431029223
Bond Position:  [-2.53878064]


portfolio before change:  [-2.78237828]
curr_Stock_Price:  96.82155451724047
curr_Factors:  [9.68215545e+01 4.29879574e-02]
mat_Sqrt:  [[ 2.00745332e+01  0.00000000e+00]
 [-8.29341497e-03  1.90026009e-02]]
grads:  [0.01078373 6.14505918]
Stock Position:  0.010783732499530066
Bond Position:  [-3.82647602]


portfolio before change:  [-2.76849683]
curr_Stock_Price:  98.15317009809146
curr_Factors:  [9.81531701e+01 4.36229487e-02]
mat_Sqrt:  [[ 2.05003766e+01  0.00000000e+00]
 [-8.35444301e-03  1.91424337e-02]]
grads:  [0.00755611 1.87556355]
Stock Position:  0.007556105218575332
Bond Position:  [-3.51015251]


portfolio before change:  [-2.76821664]
curr_Stock_Price:  98.24832282399316
curr_Factors:  [9.82483228e+01 4.53946458e-02]
mat_Sqrt:  [[ 2.09328066e+01  0.00000000e+00]
 [-8.52240772e-03  1.95272892e-02]]
grads:  [1.07484231e-02 1.14727935e+01]
Stock Position:  0.01074842308974503
Bond Position:  [-3.82423119]


portfolio before change:  [-2.77075799]
curr_Stock_Price:  98.05636143955245
curr_Factors:  [9.80563614e+01 4.75640965e-02]
mat_Sqrt:  [[ 2.13853026e+01  0.00000000e+00]
 [-8.72367780e-03  1.99884569e-02]]
grads:  [ 0.01068151 10.23702745]
Stock Position:  0.010681505512472326
Bond Position:  [-3.81814755]


portfolio before change:  [-2.77077171]
curr_Stock_Price:  98.0997609608058
curr_Factors:  [9.80997610e+01 4.67673232e-02]
mat_Sqrt:  [[ 2.12148129e+01  0.00000000e+00]
 [-8.65030156e-03  1.98203309e-02]]
grads:  [0.00893535 1.58532176]
Stock Position:  0.008935350281528458
Bond Position:  [-3.64732744]


portfolio before change:  [-2.76485839]
curr_Stock_Price:  98.81257729688484
curr_Factors:  [9.88125773e+01 4.72457819e-02]
mat_Sqrt:  [[ 2.14779955e+01  0.00000000e+00]
 [-8.69443794e-03  1.99214600e-02]]
grads:  [ -0.01948916 -18.15873368]
Stock Position:  -0.019489164166639573
Bond Position:  [-0.83908385]


portfolio before change:  [-2.77869394]
curr_Stock_Price:  99.51710520225892
curr_Factors:  [9.95171052e+01 4.69936756e-02]
mat_Sqrt:  [[ 2.15733427e+01  0.00000000e+00]
 [-8.67120989e-03  1.98682378e-02]]
grads:  [8.34211159e-03 1.13896695e+01]
Stock Position:  0.00834211158569806
Bond Position:  [-3.60887674]


portfolio before change:  [-2.77330561]
curr_Stock_Price:  100.21710482542056
curr_Factors:  [1.00217105e+02 4.70030690e-02]
mat_Sqrt:  [[ 2.17272599e+01  0.00000000e+00]
 [-8.67207648e-03  1.98702234e-02]]
grads:  [ 0.00206113 -1.01301263]
Stock Position:  0.0020611300821807878
Bond Position:  [-2.9798661]


portfolio before change:  [-2.77084642]
curr_Stock_Price:  101.59096204292341
curr_Factors:  [1.01590962e+02 4.62785264e-02]
mat_Sqrt:  [[ 2.18546992e+01  0.00000000e+00]
 [-8.60497776e-03  1.97164810e-02]]
grads:  [2.61758371e-03 1.27646352e+01]
Stock Position:  0.0026175837086166117
Bond Position:  [-3.03676926]


portfolio before change:  [-2.7708306]
curr_Stock_Price:  101.74203141145497
curr_Factors:  [1.01742031e+02 4.70455006e-02]
mat_Sqrt:  [[ 2.20678209e+01  0.00000000e+00]
 [-8.67598991e-03  1.98791902e-02]]
grads:  [-0.00391838  2.66132929]
Stock Position:  -0.003918377081747325
Bond Position:  [-2.37216695]


portfolio before change:  [-2.77267606]
curr_Stock_Price:  102.13732852957934
curr_Factors:  [1.02137329e+02 4.84333026e-02]
mat_Sqrt:  [[ 2.24779415e+01  0.00000000e+00]
 [-8.80302698e-03  2.01702688e-02]]
grads:  [1.95731041e-03 3.30945119e+00]
Stock Position:  0.001957310413186317
Bond Position:  [-2.97259052]


portfolio before change:  [-2.77004147]
curr_Stock_Price:  103.67320781148327
curr_Factors:  [1.03673208e+02 4.85159113e-02]
mat_Sqrt:  [[ 2.28354005e+01  0.00000000e+00]
 [-8.81053109e-03  2.01874628e-02]]
grads:  [-0.00515067 -1.75810407]
Stock Position:  -0.005150670264181723
Bond Position:  [-2.23605496]


portfolio before change:  [-2.77815087]
curr_Stock_Price:  105.19337538625862
curr_Factors:  [1.05193375e+02 4.95945516e-02]
mat_Sqrt:  [[ 2.34263903e+01  0.00000000e+00]
 [-8.90793368e-03  2.04106402e-02]]
grads:  [1.57547578e-02 1.75271922e+01]
Stock Position:  0.015754757811209875
Bond Position:  [-4.43544702]


portfolio before change:  [-2.8053103]
curr_Stock_Price:  103.5046818476863
curr_Factors:  [1.03504682e+02 5.28084852e-02]
mat_Sqrt:  [[ 2.37854762e+01  0.00000000e+00]
 [-9.19203875e-03  2.10616067e-02]]
grads:  [0.00164656 0.79523061]
Stock Position:  0.0016465585651130842
Bond Position:  [-2.97573682]


portfolio before change:  [-2.80322655]
curr_Stock_Price:  104.99611876215955
curr_Factors:  [1.04996119e+02 5.12697219e-02]
mat_Sqrt:  [[ 2.37740804e+01  0.00000000e+00]
 [-9.05712731e-03  2.07524857e-02]]
grads:  [-1.77628218e-03 -3.46760697e+00]
Stock Position:  -0.0017762821820876864
Bond Position:  [-2.61672381]


portfolio before change:  [-2.80169533]
curr_Stock_Price:  103.94992929291901
curr_Factors:  [1.03949929e+02 5.25237292e-02]
mat_Sqrt:  [[ 2.38233030e+01  0.00000000e+00]
 [-9.16722241e-03  2.10047453e-02]]
grads:  [6.50114648e-03 8.70473865e+00]
Stock Position:  0.0065011464796686244
Bond Position:  [-3.47748905]


portfolio before change:  [-2.78498328]
curr_Stock_Price:  106.58742765580926
curr_Factors:  [1.06587428e+02 5.04339756e-02]
mat_Sqrt:  [[ 2.39368822e+01  0.00000000e+00]
 [-8.98300400e-03  2.05826479e-02]]
grads:  [6.73832726e-03 8.52389161e+00]
Stock Position:  0.006738327263315068
Bond Position:  [-3.50320425]


portfolio before change:  [-2.78428908]
curr_Stock_Price:  106.75544066557231
curr_Factors:  [1.06755441e+02 5.07186226e-02]
mat_Sqrt:  [[ 2.40421744e+01  0.00000000e+00]
 [-9.00831816e-03  2.06406499e-02]]
grads:  [ 2.04400008e-02 -3.56944583e+01]
Stock Position:  0.020440000769343637
Bond Position:  [-4.96637037]


portfolio before change:  [-2.76286459]
curr_Stock_Price:  107.8339790160675
curr_Factors:  [1.07833979e+02 5.03767962e-02]
mat_Sqrt:  [[ 2.42030949e+01  0.00000000e+00]
 [-8.97791033e-03  2.05709768e-02]]
grads:  [-1.4451405e-02  4.4299427e+01]
Stock Position:  -0.014451404997547131
Bond Position:  [-1.20451209]


portfolio before change:  [-2.788179]
curr_Stock_Price:  109.5752517502234
curr_Factors:  [1.09575252e+02 4.96834781e-02]
mat_Sqrt:  [[ 2.44240946e+01  0.00000000e+00]
 [-8.91591639e-03  2.04289309e-02]]
grads:  [ 0.00249335 -0.7631021 ]
Stock Position:  0.00249335064229688
Bond Position:  [-3.06138853]


portfolio before change:  [-2.79105685]
curr_Stock_Price:  108.57452916036803
curr_Factors:  [1.08574529e+02 4.71665269e-02]
mat_Sqrt:  [[ 2.35800599e+01  0.00000000e+00]
 [-8.68714240e-03  1.99047438e-02]]
grads:  [-0.00335152 -2.69140222]
Stock Position:  -0.00335152184437744
Bond Position:  [-2.42716695]


portfolio before change:  [-2.79569123]
curr_Stock_Price:  109.86676561166671
curr_Factors:  [1.09866766e+02 4.67712289e-02]
mat_Sqrt:  [[ 2.37605084e+01  0.00000000e+00]
 [-8.65066276e-03  1.98211585e-02]]
grads:  [ 3.76975224e-03 -4.62139707e+00]
Stock Position:  0.0037697522363929897
Bond Position:  [-3.20986171]


portfolio before change:  [-2.79132864]
curr_Stock_Price:  111.13046735041222
curr_Factors:  [1.11130467e+02 4.65573384e-02]
mat_Sqrt:  [[ 2.39787872e+01  0.00000000e+00]
 [-8.63085983e-03  1.97757842e-02]]
grads:  [-0.00901333 -7.50376492]
Stock Position:  -0.009013334394771142
Bond Position:  [-1.78967258]


portfolio before change:  [-2.77899632]
curr_Stock_Price:  109.73741541718005
curr_Factors:  [1.09737415e+02 4.80402883e-02]
mat_Sqrt:  [[ 2.40523508e+01  0.00000000e+00]
 [-8.76723795e-03  2.00882658e-02]]
grads:  [ 0.011901   -1.40878788]
Stock Position:  0.011900998792086098
Bond Position:  [-4.08498117]


portfolio before change:  [-2.79484849]
curr_Stock_Price:  108.44832110814309
curr_Factors:  [1.08448321e+02 4.83323664e-02]
mat_Sqrt:  [[ 2.38419549e+01  0.00000000e+00]
 [-8.79384934e-03  2.01492401e-02]]
grads:  [ 0.01928547 18.77222586]
Stock Position:  0.019285474900671257
Bond Position:  [-4.88632586]


portfolio before change:  [-2.82573697]
curr_Stock_Price:  106.8783493069669
curr_Factors:  [1.06878349e+02 4.94261612e-02]
mat_Sqrt:  [[ 2.37611895e+01  0.00000000e+00]
 [-8.89279809e-03  2.03759602e-02]]
grads:  [0.01070315 0.85030077]
Stock Position:  0.010703145197638809
Bond Position:  [-3.96967146]


portfolio before change:  [-2.80799116]
curr_Stock_Price:  108.58271235478325
curr_Factors:  [1.08582712e+02 4.91204603e-02]
mat_Sqrt:  [[ 2.40653344e+01  0.00000000e+00]
 [-8.86525445e-03  2.03128498e-02]]
grads:  [-1.06050548e-02 -1.20685724e+01]
Stock Position:  -0.010605054758424203
Bond Position:  [-1.65646555]


portfolio before change:  [-2.78533267]
curr_Stock_Price:  106.42661155950844
curr_Factors:  [1.06426612e+02 5.10013047e-02]
mat_Sqrt:  [[ 2.40348202e+01  0.00000000e+00]
 [-9.03338738e-03  2.06980907e-02]]
grads:  [ 0.00535851 -4.99252285]
Stock Position:  0.005358513307198857
Bond Position:  [-3.35562108]


portfolio before change:  [-2.78751587]
curr_Stock_Price:  106.09746663974697
curr_Factors:  [1.06097467e+02 5.07189740e-02]
mat_Sqrt:  [[ 2.38940762e+01  0.00000000e+00]
 [-9.00834937e-03  2.06407214e-02]]
grads:  [-4.36065004e-03  9.38667168e+00]
Stock Position:  -0.004360650037509105
Bond Position:  [-2.32486195]


portfolio before change:  [-2.78147252]
curr_Stock_Price:  104.64493517079809
curr_Factors:  [1.04644935e+02 5.22426645e-02]
mat_Sqrt:  [[ 2.39183311e+01  0.00000000e+00]
 [-9.14266172e-03  2.09484697e-02]]
grads:  [-2.78822615e-03  5.75529518e+00]
Stock Position:  -0.0027882261468791785
Bond Position:  [-2.48969877]


portfolio before change:  [-2.78681549]
curr_Stock_Price:  106.44957338837511
curr_Factors:  [1.06449573e+02 5.00684747e-02]
mat_Sqrt:  [[ 2.38191416e+01  0.00000000e+00]
 [-8.95039438e-03  2.05079299e-02]]
grads:  [-5.30733328e-03  7.23366068e+00]
Stock Position:  -0.005307333278845418
Bond Position:  [-2.22185212]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.79289555]
Stock Price:  107.54283668374914
PL:  [-10.33573223]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.45082801e-01  6.88171148e-01]
 [-1.66896469e-01 -8.54391528e-02]
 [ 8.57459881e-01 -7.86421959e-01]
 [-2.26955459e-02  1.89607636e-01]
 [ 3.04491247e-02 -6.32595223e-02]
 [-7.68874112e-02 -8.67223688e-02]
 [-2.04060494e-01 -5.78903965e-02]
 [ 4.18170621e-01 -2.27583960e-01]
 [ 1.58538343e-01  1.79900080e-01]
 [-1.90695421e-01  4.99807737e-01]
 [ 2.38426647e-01  7.40467293e-01]
 [ 3.97259940e-02  4.01575601e-01]
 [ 4.35452541e-01  2.60508906e-02]
 [ 2.09056363e-03  1.58669666e-01]
 [ 9.98079703e-02  2.54863300e-01]
 [ 2.65726076e-02  3.12945641e-01]
 [ 2.07578528e-01  5.47661922e-01]
 [ 1.67679251e-01  5.40899256e-02]
 [ 6.68081303e-02 -1.48778467e-01]
 [ 4.92657436e-01 -1.29940926e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-1.20184605e-02 -9.39138196e-03]
 [-8.41720769e-02 -3.33202399e-03]
 [ 5.90474914e-02 -2.71414923e-01]
 [ 2.96104194e-02  1.56126202e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 7.70631287e-02  1.70610469e-01]
 [-1.61454882e-01  9.50340223e-02]
 [-4.25178908e-01  7.57346163e-02]
 [ 2.53588905e-01 -1.04798503e-01]
 [-1.43679341e+00 -1.61867470e-01]
 [ 2.09988681e-01  4.49060819e-01]
 [-8.09149064e-03 -1.28220673e-01]
 [-5.54255057e-03  5.60579390e-02]
 [-2.49041368e-02  1.69167910e-01]
 [-2.20923987e+00  3.43529816e-02]
 [-1.22815031e-01  1.19498961e-01]
 [-1.34958276e-01 -1.83910860e-01]
 [ 1.43303326e+00 -7.20288561e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.91181812]
curr_Stock_Price:  101.08504244218707
curr_Factors:  [1.01085042e+02 4.11767407e-02]
mat_Sqrt:  [[ 2.05122302e+01  0.00000000e+00]
 [-8.11682112e-03  1.85979736e-02]]
grads:  [3.14653896e-02 3.70024801e+01]
Stock Position:  0.031465389554028035
Bond Position:  [6.73113788]


portfolio before change:  [9.881171]
curr_Stock_Price:  100.08430591692469
curr_Factors:  [1.00084306e+02 4.23595869e-02]
mat_Sqrt:  [[ 2.05987962e+01  0.00000000e+00]
 [-8.23257791e-03  1.88632057e-02]]
grads:  [-0.00991248 -4.52940789]
Stock Position:  -0.009912480857272003
Bond Position:  [10.87325476]


portfolio before change:  [9.90177824]
curr_Stock_Price:  98.14251141221462
curr_Factors:  [9.81425114e+01 4.41838255e-02]
mat_Sqrt:  [[ 2.06295058e+01  0.00000000e+00]
 [-8.40797959e-03  1.92651015e-02]]
grads:  [ 2.4927267e-02 -4.0821065e+01]
Stock Position:  0.024927267016052603
Bond Position:  [7.45535365]


portfolio before change:  [9.88834331]
curr_Stock_Price:  97.56615822069382
curr_Factors:  [9.75661582e+01 4.57867705e-02]
mat_Sqrt:  [[ 2.08770538e+01  0.00000000e+00]
 [-8.55913739e-03  1.96114475e-02]]
grads:  [2.87665161e-03 9.66821220e+00]
Stock Position:  0.002876651614579584
Bond Position:  [9.60767946]


portfolio before change:  [9.89001062]
curr_Stock_Price:  97.72824720081343
curr_Factors:  [9.77282472e+01 4.63887883e-02]
mat_Sqrt:  [[ 2.10487652e+01  0.00000000e+00]
 [-8.61522265e-03  1.97399550e-02]]
grads:  [ 1.34944052e-04 -3.20464370e+00]
Stock Position:  0.00013494405226341163
Bond Position:  [9.87682277]


portfolio before change:  [9.89106983]
curr_Stock_Price:  96.42799273847089
curr_Factors:  [9.64279927e+01 4.64697409e-02]
mat_Sqrt:  [[ 2.07868294e+01  0.00000000e+00]
 [-8.62273654e-03  1.97571715e-02]]
grads:  [-0.00551966 -4.38941217]
Stock Position:  -0.005519656390151024
Bond Position:  [10.42331922]


portfolio before change:  [9.909393]
curr_Stock_Price:  93.34443602515866
curr_Factors:  [9.33444360e+01 4.76190717e-02]
mat_Sqrt:  [[ 2.03694311e+01  0.00000000e+00]
 [-8.72871782e-03  2.00000051e-02]]
grads:  [-0.01125834 -2.89451909]
Stock Position:  -0.011258337755455405
Bond Position:  [10.96029619]


portfolio before change:  [9.92054308]
curr_Stock_Price:  92.47575052219919
curr_Factors:  [9.24757505e+01 4.95170958e-02]
mat_Sqrt:  [[ 2.05781082e+01  0.00000000e+00]
 [-8.90097485e-03  2.03946955e-02]]
grads:  [  0.01549437 -11.15897806]
Stock Position:  0.01549437071202465
Bond Position:  [8.48768952]


portfolio before change:  [9.92933824]
curr_Stock_Price:  92.97490784495493
curr_Factors:  [9.29749078e+01 5.08087657e-02]
mat_Sqrt:  [[ 2.09572879e+01  0.00000000e+00]
 [-9.01631993e-03  2.06589843e-02]]
grads:  [0.01131125 8.70807962]
Stock Position:  0.011311252513719137
Bond Position:  [8.87767558]


portfolio before change:  [9.92479321]
curr_Stock_Price:  92.47498042093439
curr_Factors:  [9.24749804e+01 5.15443942e-02]
mat_Sqrt:  [[ 2.09949560e+01  0.00000000e+00]
 [-9.08135622e-03  2.08080011e-02]]
grads:  [1.30691196e-03 2.40199784e+01]
Stock Position:  0.001306911959279692
Bond Position:  [9.80393655]


portfolio before change:  [9.92526534]
curr_Stock_Price:  91.89847919484028
curr_Factors:  [9.18984792e+01 5.33009520e-02]
mat_Sqrt:  [[ 2.12166009e+01  0.00000000e+00]
 [-9.23479958e-03  2.11595840e-02]]
grads:  [2.64695118e-02 3.49944163e+01]
Stock Position:  0.026469511796924573
Bond Position:  [7.49275746]


portfolio before change:  [9.90772681]
curr_Stock_Price:  91.20049919841139
curr_Factors:  [9.12004992e+01 5.40924414e-02]
mat_Sqrt:  [[ 2.12112131e+01  0.00000000e+00]
 [-9.30311272e-03  2.13161091e-02]]
grads:  [1.01355804e-02 1.88390667e+01]
Stock Position:  0.010135580356821453
Bond Position:  [8.98335682]


portfolio before change:  [9.91852057]
curr_Stock_Price:  92.15464051514788
curr_Factors:  [9.21546405e+01 5.22489229e-02]
mat_Sqrt:  [[ 2.10647292e+01  0.00000000e+00]
 [-9.14320932e-03  2.09497244e-02]]
grads:  [0.02121186 1.24349562]
Stock Position:  0.02121185976813003
Bond Position:  [7.96374926]


portfolio before change:  [9.92609262]
curr_Stock_Price:  92.46468009918864
curr_Factors:  [9.24646801e+01 5.10905241e-02]
mat_Sqrt:  [[ 2.08999887e+01  0.00000000e+00]
 [-9.04128523e-03  2.07161870e-02]]
grads:  [3.41338383e-03 7.65921192e+00]
Stock Position:  0.0034133838267132646
Bond Position:  [9.61047518]


portfolio before change:  [9.91943491]
curr_Stock_Price:  90.16224625143768
curr_Factors:  [9.01622463e+01 5.13324494e-02]
mat_Sqrt:  [[ 2.04277586e+01  0.00000000e+00]
 [-9.06266622e-03  2.07651770e-02]]
grads:  [1.03310127e-02 1.22735915e+01]
Stock Position:  0.010331012709948613
Bond Position:  [8.9879676]


portfolio before change:  [9.93626075]
curr_Stock_Price:  91.68216226895935
curr_Factors:  [9.16821623e+01 4.90028473e-02]
mat_Sqrt:  [[ 2.02953014e+01  0.00000000e+00]
 [-8.85463470e-03  2.02885169e-02]]
grads:  [8.03896820e-03 1.54247667e+01]
Stock Position:  0.008038968199823809
Bond Position:  [9.19923076]


portfolio before change:  [9.94143536]
curr_Stock_Price:  92.18280280968422
curr_Factors:  [9.21828028e+01 4.88773724e-02]
mat_Sqrt:  [[ 2.03799838e+01  0.00000000e+00]
 [-8.84329101e-03  2.02625252e-02]]
grads:  [2.19135497e-02 2.70283154e+01]
Stock Position:  0.021913549674637833
Bond Position:  [7.92138293]


portfolio before change:  [9.91924459]
curr_Stock_Price:  91.1249636769941
curr_Factors:  [9.11249637e+01 4.70275446e-02]
mat_Sqrt:  [[ 1.97612094e+01  0.00000000e+00]
 [-8.67433406e-03  1.98753962e-02]]
grads:  [0.00967987 2.72145144]
Stock Position:  0.009679874660528184
Bond Position:  [9.03716636]


portfolio before change:  [9.92531543]
curr_Stock_Price:  91.63541748669414
curr_Factors:  [9.16354175e+01 4.61857843e-02]
mat_Sqrt:  [[ 1.96932559e+01  0.00000000e+00]
 [-8.59635126e-03  1.96967152e-02]]
grads:  [ 9.52551433e-05 -7.55346594e+00]
Stock Position:  9.525514329585338e-05
Bond Position:  [9.91658669]


portfolio before change:  [9.9266226]
curr_Stock_Price:  92.34425328548517
curr_Factors:  [9.23442533e+01 4.57132424e-02]
mat_Sqrt:  [[ 1.97438066e+01  0.00000000e+00]
 [-8.55226215e-03  1.95956943e-02]]
grads:  [ 0.02208017 -6.63109576]
Stock Position:  0.022080168064679266
Bond Position:  [7.88764597]


portfolio before change:  [9.93605092]
curr_Stock_Price:  92.72660115376624
curr_Factors:  [9.27266012e+01 4.51600858e-02]
mat_Sqrt:  [[ 1.97052396e+01  0.00000000e+00]
 [-8.50036101e-03  1.94767739e-02]]
grads:  [ 0.00213794 -1.93964308]
Stock Position:  0.002137939522762749
Bond Position:  [9.73780706]


portfolio before change:  [9.93498858]
curr_Stock_Price:  91.66032123403843
curr_Factors:  [9.16603212e+01 4.52524176e-02]
mat_Sqrt:  [[ 1.94985478e+01  0.00000000e+00]
 [-8.50904625e-03  1.94966743e-02]]
grads:  [-0.00082658 -0.48169148]
Stock Position:  -0.000826584407754884
Bond Position:  [10.01075358]


portfolio before change:  [9.93647433]
curr_Stock_Price:  91.37683302633411
curr_Factors:  [9.13768330e+01 4.63088272e-02]
mat_Sqrt:  [[ 1.96638247e+01  0.00000000e+00]
 [-8.60779435e-03  1.97229346e-02]]
grads:  [-0.00435451 -0.16894159]
Stock Position:  -0.0043545084863565175
Bond Position:  [10.33437553]


portfolio before change:  [9.93592748]
curr_Stock_Price:  91.79909145978668
curr_Factors:  [9.17990915e+01 4.73582949e-02]
mat_Sqrt:  [[ 1.99772825e+01  0.00000000e+00]
 [-8.70478442e-03  1.99451668e-02]]
grads:  [-2.97376243e-03 -1.36080548e+01]
Stock Position:  -0.0029737624270077465
Bond Position:  [10.20891617]


portfolio before change:  [9.93330813]
curr_Stock_Price:  93.10906353619414
curr_Factors:  [9.31090635e+01 4.64512309e-02]
mat_Sqrt:  [[ 2.00673753e+01  0.00000000e+00]
 [-8.62101905e-03  1.97532362e-02]]
grads:  [4.87106455e-03 7.90382904e+00]
Stock Position:  0.0048710645456738495
Bond Position:  [9.47976787]


portfolio before change:  [9.93613814]
curr_Stock_Price:  93.44676403382199
curr_Factors:  [9.34467640e+01 4.63212975e-02]
mat_Sqrt:  [[ 2.01119706e+01  0.00000000e+00]
 [-8.60895324e-03  1.97255899e-02]]
grads:  [6.23930113e-03 9.23006715e+00]
Stock Position:  0.006239301132369839
Bond Position:  [9.35309564]


portfolio before change:  [9.93197416]
curr_Stock_Price:  92.59199060403456
curr_Factors:  [9.25919906e+01 4.61462744e-02]
mat_Sqrt:  [[ 1.98903188e+01  0.00000000e+00]
 [-8.59267357e-03  1.96882885e-02]]
grads:  [7.61795946e-03 8.66558151e+00]
Stock Position:  0.007617959459913105
Bond Position:  [9.22661213]


portfolio before change:  [9.94402922]
curr_Stock_Price:  94.02303880960679
curr_Factors:  [9.40230388e+01 4.46999636e-02]
mat_Sqrt:  [[ 1.98786949e+01  0.00000000e+00]
 [-8.45694636e-03  1.93772984e-02]]
grads:  [-0.00603554  4.90439999]
Stock Position:  -0.006035538801825153
Bond Position:  [10.51150892]


portfolio before change:  [9.9523892]
curr_Stock_Price:  92.85562798763496
curr_Factors:  [9.28556280e+01 4.50383365e-02]
mat_Sqrt:  [[ 1.97060419e+01  0.00000000e+00]
 [-8.48889501e-03  1.94505020e-02]]
grads:  [-0.01989875  3.89371012]
Stock Position:  -0.019898750501373484
Bond Position:  [11.80010017]


portfolio before change:  [9.96208211]
curr_Stock_Price:  92.44264685605403
curr_Factors:  [9.24426469e+01 4.43937665e-02]
mat_Sqrt:  [[ 1.94775070e+01  0.00000000e+00]
 [-8.42793133e-03  1.93108166e-02]]
grads:  [ 0.01067134 -5.42693274]
Stock Position:  0.010671339430848355
Bond Position:  [8.97559525]


portfolio before change:  [9.96145795]
curr_Stock_Price:  92.2790136512879
curr_Factors:  [9.22790137e+01 4.47150715e-02]
mat_Sqrt:  [[ 1.95132635e+01  0.00000000e+00]
 [-8.45837540e-03  1.93805728e-02]]
grads:  [-0.07725198 -8.35204778]
Stock Position:  -0.0772519761853546
Bond Position:  [17.09019411]


portfolio before change:  [9.94828708]
curr_Stock_Price:  92.47716095275159
curr_Factors:  [9.24771610e+01 4.41046388e-02]
mat_Sqrt:  [[ 1.94212252e+01  0.00000000e+00]
 [-8.40044178e-03  1.92478302e-02]]
grads:  [2.09036705e-02 2.33304646e+01]
Stock Position:  0.020903670451623696
Bond Position:  [8.01517499]


portfolio before change:  [9.9735021]
curr_Stock_Price:  93.63547678481977
curr_Factors:  [9.36354768e+01 4.39684394e-02]
mat_Sqrt:  [[ 1.96340979e+01  0.00000000e+00]
 [-8.38746106e-03  1.92180876e-02]]
grads:  [-3.26226244e-03 -6.67187473e+00]
Stock Position:  -0.003262262444615931
Bond Position:  [10.27896559]


portfolio before change:  [9.97884047]
curr_Stock_Price:  92.39295650078863
curr_Factors:  [9.23929565e+01 4.51675307e-02]
mat_Sqrt:  [[ 1.96359555e+01  0.00000000e+00]
 [-8.50106165e-03  1.94783792e-02]]
grads:  [9.63698447e-04 2.87795706e+00]
Stock Position:  0.0009636984469636891
Bond Position:  [9.88980152]


portfolio before change:  [9.98021765]
curr_Stock_Price:  92.53913544043404
curr_Factors:  [9.25391354e+01 4.59521809e-02]
mat_Sqrt:  [[ 1.98371146e+01  0.00000000e+00]
 [-8.57458392e-03  1.96468399e-02]]
grads:  [2.46642685e-03 8.61043865e+00]
Stock Position:  0.002466426850749339
Bond Position:  [9.75197664]


portfolio before change:  [9.97856739]
curr_Stock_Price:  91.37577783766912
curr_Factors:  [9.13757778e+01 4.57344821e-02]
mat_Sqrt:  [[ 1.95412783e+01  0.00000000e+00]
 [-8.55424873e-03  1.96002462e-02]]
grads:  [-0.11228779  1.75268113]
Stock Position:  -0.1122877922564341
Bond Position:  [20.23895174]


portfolio before change:  [10.08247619]
curr_Stock_Price:  90.47293014051816
curr_Factors:  [9.04729301e+01 4.50761464e-02]
mat_Sqrt:  [[ 1.92084378e+01  0.00000000e+00]
 [-8.49245749e-03  1.94586647e-02]]
grads:  [-3.67866505e-03  6.14116968e+00]
Stock Position:  -0.003678665046829405
Bond Position:  [10.41529579]


portfolio before change:  [10.08576994]
curr_Stock_Price:  89.93149436827126
curr_Factors:  [8.99314944e+01 4.52350586e-02]
mat_Sqrt:  [[ 1.91271115e+01  0.00000000e+00]
 [-8.50741405e-03  1.94929344e-02]]
grads:  [-0.01125228 -9.43474473]
Stock Position:  -0.011252276999419268
Bond Position:  [11.09770403]


portfolio before change:  [10.0689481]
curr_Stock_Price:  91.54975741863382
curr_Factors:  [9.15497574e+01 4.38874312e-02]
mat_Sqrt:  [[ 1.91790583e+01  0.00000000e+00]
 [-8.37973090e-03  1.92003756e-02]]
grads:  [ 0.07307957 -3.75142954]
Stock Position:  0.07307956800947521
Bond Position:  [3.37853137]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.07441847]
Stock Price:  91.61883328226776
PL:  [10.07441847]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.48985188e-02  3.15937956e-01]
 [-1.64588372e-01 -8.79259132e-02]
 [ 8.63194466e-01 -7.98357639e-01]
 [-2.96451801e-02  1.57090520e-01]
 [ 3.99997129e-02 -3.65324718e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-4.77802061e-02  1.97124468e-01]
 [ 1.96205366e-01 -6.87664799e-03]
 [ 9.57633357e-02  9.24790023e-02]
 [ 3.30844447e-01 -1.58998538e-01]
 [ 6.19078472e-02 -6.78415479e-03]
 [-1.03600257e-01 -1.82655592e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-4.86581115e-01 -6.27000510e-01]
 [ 5.14543750e-02  1.10085295e-01]
 [ 5.30264409e-02 -6.27637444e-02]
 [-5.28445731e-02  2.63572661e-01]
 [-4.37275775e-02  1.27294165e-01]
 [ 1.49432636e-02  6.47625619e-02]
 [-8.46588733e-02 -3.88031295e-02]
 [ 1.49250245e-01  5.57088228e-02]
 [ 4.66878549e-02  2.24732470e-01]
 [ 3.82076723e-02  3.59653367e-01]
 [ 3.28282050e-02  1.68133569e-01]
 [ 3.11889870e-02  7.05259468e-02]
 [ 7.46548746e-01 -4.48339652e-01]
 [-2.11429942e-01  2.82407408e-01]
 [ 1.25809725e-01 -1.08506916e-02]
 [-4.85216592e-02 -6.13601174e-02]
 [-9.66412880e-03 -1.53792330e-01]
 [-6.70855964e-02 -7.57992030e-02]
 [ 8.94993484e-03 -6.74610280e-03]
 [ 1.65888296e-01  1.63553705e-01]
 [ 1.83185160e-01  4.99413206e-02]
 [-2.82670794e-01 -1.76053499e-01]
 [-6.69595233e-02 -4.04752025e-01]
 [-1.59520153e-01  2.16815863e-01]
 [-1.17922411e-01  1.21499665e-01]
 [-1.06128798e-01  1.26700163e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.77282758]
curr_Stock_Price:  100.00979491976108
curr_Factors:  [1.00009795e+02 4.00861362e-02]
mat_Sqrt:  [[ 2.00234836e+01  0.00000000e+00]
 [-8.00860899e-03  1.83500284e-02]]
grads:  [9.12853884e-03 1.72173006e+01]
Stock Position:  0.00912853883666406
Bond Position:  [1.85988428]


portfolio before change:  [2.76754794]
curr_Stock_Price:  99.40595889853557
curr_Factors:  [9.94059589e+01 3.97624003e-02]
mat_Sqrt:  [[ 1.98220568e+01  0.00000000e+00]
 [-7.97620464e-03  1.82757808e-02]]
grads:  [-0.01023922 -4.81106193]
Stock Position:  -0.010239219321102761
Bond Position:  [3.78538735]


portfolio before change:  [2.78238987]
curr_Stock_Price:  98.00265632280616
curr_Factors:  [9.80026563e+01 4.07068498e-02]
mat_Sqrt:  [[ 1.97729558e+01  0.00000000e+00]
 [-8.07037544e-03  1.84915532e-02]]
grads:  [ 2.60336711e-02 -4.31741797e+01]
Stock Position:  0.026033671092125617
Bond Position:  [0.23102094]


portfolio before change:  [2.7837599]
curr_Stock_Price:  98.05417260523726
curr_Factors:  [9.80541726e+01 3.99017541e-02]
mat_Sqrt:  [[ 1.95867362e+01  0.00000000e+00]
 [-7.99016937e-03  1.83077780e-02]]
grads:  [1.98679061e-03 8.58053445e+00]
Stock Position:  0.0019867906098032934
Bond Position:  [2.58894679]


portfolio before change:  [2.78490884]
curr_Stock_Price:  98.46956495103396
curr_Factors:  [9.84695650e+01 3.81232497e-02]
mat_Sqrt:  [[ 1.92263558e+01  0.00000000e+00]
 [-7.81007039e-03  1.78951194e-02]]
grads:  [ 1.25118017e-03 -2.04147684e+00]
Stock Position:  0.0012511801670584738
Bond Position:  [2.66170567]


portfolio before change:  [2.78584134]
curr_Stock_Price:  98.94892372596918
curr_Factors:  [9.89489237e+01 3.91739785e-02]
mat_Sqrt:  [[ 1.95843840e+01  0.00000000e+00]
 [-7.91696695e-03  1.81400502e-02]]
grads:  [-0.00604669 -3.65582936]
Stock Position:  -0.006046693727645079
Bond Position:  [3.38415517]


portfolio before change:  [2.78677695]
curr_Stock_Price:  98.8641561287226
curr_Factors:  [9.88641561e+01 3.92351058e-02]
mat_Sqrt:  [[ 1.95828672e+01  0.00000000e+00]
 [-7.92314138e-03  1.81541975e-02]]
grads:  [1.95333833e-03 1.08583410e+01]
Stock Position:  0.001953338333283288
Bond Position:  [2.5936618]


portfolio before change:  [2.79065811]
curr_Stock_Price:  100.68510951324512
curr_Factors:  [1.00685110e+02 3.88968458e-02]
mat_Sqrt:  [[ 1.98574025e+01  0.00000000e+00]
 [-7.88891332e-03  1.80757712e-02]]
grads:  [ 0.00972958 -0.38043456]
Stock Position:  0.009729578220973267
Bond Position:  [1.81103446]


portfolio before change:  [2.80780233]
curr_Stock_Price:  102.42391292655995
curr_Factors:  [1.02423913e+02 3.84563767e-02]
mat_Sqrt:  [[ 2.00856340e+01  0.00000000e+00]
 [-7.84411899e-03  1.79731345e-02]]
grads:  [0.00677721 5.145402  ]
Stock Position:  0.006777206092974465
Bond Position:  [2.11365436]


portfolio before change:  [2.80156091]
curr_Stock_Price:  101.4639826643412
curr_Factors:  [1.01463983e+02 4.01385756e-02]
mat_Sqrt:  [[ 2.03279172e+01  0.00000000e+00]
 [-8.01384558e-03  1.83620270e-02]]
grads:  [ 0.01286171 -8.6590951 ]
Stock Position:  0.012861710960234947
Bond Position:  [1.49656049]


portfolio before change:  [2.82291849]
curr_Stock_Price:  103.10999229086833
curr_Factors:  [1.03109992e+02 4.05156209e-02]
mat_Sqrt:  [[ 2.07544870e+01  0.00000000e+00]
 [-8.05139699e-03  1.84480681e-02]]
grads:  [ 0.00284021 -0.36774337]
Stock Position:  0.0028402050722625767
Bond Position:  [2.53006497]


portfolio before change:  [2.82256431]
curr_Stock_Price:  102.87393371112641
curr_Factors:  [1.02873934e+02 4.05543110e-02]
mat_Sqrt:  [[ 2.07168566e+01  0.00000000e+00]
 [-8.05524038e-03  1.84568744e-02]]
grads:  [-8.84872141e-03 -9.89634473e+00]
Stock Position:  -0.008848721410933779
Bond Position:  [3.73286709]


portfolio before change:  [2.82520147]
curr_Stock_Price:  102.62864205430067
curr_Factors:  [1.02628642e+02 4.17002341e-02]
mat_Sqrt:  [[ 2.09574206e+01  0.00000000e+00]
 [-8.16825407e-03  1.87158213e-02]]
grads:  [-5.76369687e-03  8.84447677e+00]
Stock Position:  -0.005763696866032259
Bond Position:  [3.41672185]


portfolio before change:  [2.83270136]
curr_Stock_Price:  101.40151694186552
curr_Factors:  [1.01401517e+02 4.21371992e-02]
mat_Sqrt:  [[ 2.08150417e+01  0.00000000e+00]
 [-8.21093897e-03  1.88136247e-02]]
grads:  [ -0.03652294 -33.32693836]
Stock Position:  -0.0365229425665125
Bond Position:  [6.53618314]


portfolio before change:  [2.79511819]
curr_Stock_Price:  102.45291752015957
curr_Factors:  [1.02452918e+02 4.21734969e-02]
mat_Sqrt:  [[ 2.10399225e+01  0.00000000e+00]
 [-8.21447473e-03  1.88217261e-02]]
grads:  [4.72908284e-03 5.84884161e+00]
Stock Position:  0.004729082836090495
Bond Position:  [2.31060986]


portfolio before change:  [2.79876003]
curr_Stock_Price:  103.16193365444234
curr_Factors:  [1.03161934e+02 4.14147719e-02]
mat_Sqrt:  [[ 2.09940927e+01  0.00000000e+00]
 [-8.14024785e-03  1.86516510e-02]]
grads:  [ 1.22101476e-03 -3.36505034e+00]
Stock Position:  0.0012210147622674322
Bond Position:  [2.67279779]


portfolio before change:  [2.79776388]
curr_Stock_Price:  102.07245360668908
curr_Factors:  [1.02072454e+02 4.08245417e-02]
mat_Sqrt:  [[ 2.06238249e+01  0.00000000e+00]
 [-8.08203358e-03  1.85182653e-02]]
grads:  [3.01534596e-03 1.42331183e+01]
Stock Position:  0.003015345956614155
Bond Position:  [2.48998012]


portfolio before change:  [2.80063907]
curr_Stock_Price:  102.9227445002989
curr_Factors:  [1.02922745e+02 4.14888661e-02]
mat_Sqrt:  [[ 2.09641443e+01  0.00000000e+00]
 [-8.14752636e-03  1.86683281e-02]]
grads:  [5.64208618e-04 6.81872337e+00]
Stock Position:  0.0005642086175604555
Bond Position:  [2.74256917]


portfolio before change:  [2.80021509]
curr_Stock_Price:  101.56362360447582
curr_Factors:  [1.01563624e+02 4.29916951e-02]
mat_Sqrt:  [[ 2.10586473e+01  0.00000000e+00]
 [-8.29377551e-03  1.90034270e-02]]
grads:  [2.05179194e-03 3.40794120e+00]
Stock Position:  0.002051791936596999
Bond Position:  [2.59182766]


portfolio before change:  [2.80167459]
curr_Stock_Price:  102.11704405308122
curr_Factors:  [1.02117044e+02 4.18763419e-02]
mat_Sqrt:  [[ 2.08969356e+01  0.00000000e+00]
 [-8.18548392e-03  1.87552998e-02]]
grads:  [-0.00486167 -2.06891545]
Stock Position:  -0.004861667257416402
Bond Position:  [3.29813368]


portfolio before change:  [2.80856646]
curr_Stock_Price:  100.78425407067061
curr_Factors:  [1.00784254e+02 4.34774611e-02]
mat_Sqrt:  [[ 2.10147764e+01  0.00000000e+00]
 [-8.34049985e-03  1.91104859e-02]]
grads:  [0.00825912 2.9150919 ]
Stock Position:  0.008259120399905005
Bond Position:  [1.97617717]


portfolio before change:  [2.81021025]
curr_Stock_Price:  100.95336968138848
curr_Factors:  [1.00953370e+02 4.22958087e-02]
mat_Sqrt:  [[ 2.07620143e+01  0.00000000e+00]
 [-8.22637793e-03  1.88489998e-02]]
grads:  [6.97278905e-03 1.19227796e+01]
Stock Position:  0.006972789051192651
Bond Position:  [2.10628369]


portfolio before change:  [2.81512917]
curr_Stock_Price:  101.62105383149316
curr_Factors:  [1.01621054e+02 4.25617348e-02]
mat_Sqrt:  [[ 2.09649270e+01  0.00000000e+00]
 [-8.25219824e-03  1.89081615e-02]]
grads:  [9.30951345e-03 1.90210649e+01]
Stock Position:  0.009309513452885668
Bond Position:  [1.8690866]


portfolio before change:  [2.81935167]
curr_Stock_Price:  102.0495242182713
curr_Factors:  [1.02049524e+02 4.17645866e-02]
mat_Sqrt:  [[ 2.08552345e+01  0.00000000e+00]
 [-8.17455433e-03  1.87302570e-02]]
grads:  [5.09261646e-03 8.97657567e+00]
Stock Position:  0.005092616463475441
Bond Position:  [2.29965258]


portfolio before change:  [2.81734853]
curr_Stock_Price:  101.59973328188093
curr_Factors:  [1.01599733e+02 4.13775620e-02]
mat_Sqrt:  [[ 2.06668847e+01  0.00000000e+00]
 [-8.13659014e-03  1.86432701e-02]]
grads:  [2.99846999e-03 3.78291718e+00]
Stock Position:  0.0029984699925274865
Bond Position:  [2.51270478]


portfolio before change:  [2.82327537]
curr_Stock_Price:  103.47159690723163
curr_Factors:  [1.03471597e+02 4.12892425e-02]
mat_Sqrt:  [[ 2.10251745e+01  0.00000000e+00]
 [-8.12790182e-03  1.86233627e-02]]
grads:  [  0.02620084 -24.07404395]
Stock Position:  0.026200842191387592
Bond Position:  [0.11223238]


portfolio before change:  [2.80550996]
curr_Stock_Price:  102.79301418585743
curr_Factors:  [1.02793014e+02 4.10460603e-02]
mat_Sqrt:  [[ 2.08256872e+01  0.00000000e+00]
 [-8.10393093e-03  1.85684385e-02]]
grads:  [-4.23406170e-03  1.52090015e+01]
Stock Position:  -0.004234061701182955
Bond Position:  [3.24074192]


portfolio before change:  [2.79307196]
curr_Stock_Price:  105.82629974570933
curr_Factors:  [1.05826300e+02 4.09341262e-02]
mat_Sqrt:  [[ 2.14109715e+01  0.00000000e+00]
 [-8.09287352e-03  1.85431028e-02]]
grads:  [ 0.00565477 -0.58516052]
Stock Position:  0.005654768886027449
Bond Position:  [2.19464869]


portfolio before change:  [2.79183408]
curr_Stock_Price:  105.55887506407153
curr_Factors:  [1.05558875e+02 4.30375106e-02]
mat_Sqrt:  [[ 2.18986995e+01  0.00000000e+00]
 [-8.29819359e-03  1.90135501e-02]]
grads:  [-0.00343862 -3.22717835]
Stock Position:  -0.003438624739448897
Bond Position:  [3.15481144]


portfolio before change:  [2.79686855]
curr_Stock_Price:  104.20947208627966
curr_Factors:  [1.04209472e+02 4.44622511e-02]
mat_Sqrt:  [[ 2.19736862e+01  0.00000000e+00]
 [-8.43442954e-03  1.93257059e-02]]
grads:  [-3.49438885e-03 -7.95791525e+00]
Stock Position:  -0.003494388851020437
Bond Position:  [3.16101696]


portfolio before change:  [2.79512249]
curr_Stock_Price:  104.82222764932537
curr_Factors:  [1.04822228e+02 4.45856051e-02]
mat_Sqrt:  [[ 2.21335317e+01  0.00000000e+00]
 [-8.44612149e-03  1.93524955e-02]]
grads:  [-0.00452558 -3.91676634]
Stock Position:  -0.0045255805492934705
Bond Position:  [3.26950393]


portfolio before change:  [2.79482336]
curr_Stock_Price:  104.97863659372412
curr_Factors:  [1.04978637e+02 4.40522908e-02]
mat_Sqrt:  [[ 2.20335856e+01  0.00000000e+00]
 [-8.39545504e-03  1.92364041e-02]]
grads:  [ 2.72569990e-04 -3.50694587e-01]
Stock Position:  0.00027256999003058037
Bond Position:  [2.76620934]


portfolio before change:  [2.7947747]
curr_Stock_Price:  103.53142908026012
curr_Factors:  [1.03531429e+02 4.58285105e-02]
mat_Sqrt:  [[ 2.21635886e+01  0.00000000e+00]
 [-8.56303782e-03  1.96203845e-02]]
grads:  [0.01070535 8.33590723]
Stock Position:  0.010705350521677273
Bond Position:  [1.68643446]


portfolio before change:  [2.78013838]
curr_Stock_Price:  102.14453954933605
curr_Factors:  [1.02144540e+02 4.49077647e-02]
mat_Sqrt:  [[ 2.16459113e+01  0.00000000e+00]
 [-8.47658088e-03  1.94222868e-02]]
grads:  [0.00946975 2.57134091]
Stock Position:  0.009469748641712175
Bond Position:  [1.81285526]


portfolio before change:  [2.77761849]
curr_Stock_Price:  101.85451014949092
curr_Factors:  [1.01854510e+02 4.42858573e-02]
mat_Sqrt:  [[ 2.14344721e+01  0.00000000e+00]
 [-8.41768208e-03  1.92873327e-02]]
grads:  [-0.01677237 -9.12793399]
Stock Position:  -0.016772367328419812
Bond Position:  [4.48595975]


portfolio before change:  [2.77574006]
curr_Stock_Price:  101.99994054625446
curr_Factors:  [1.01999941e+02 4.41254400e-02]
mat_Sqrt:  [[ 2.14261649e+01  0.00000000e+00]
 [-8.40242251e-03  1.92523686e-02]]
grads:  [-1.13696404e-02 -2.10234924e+01]
Stock Position:  -0.011369640364737057
Bond Position:  [3.9354427]


portfolio before change:  [2.7603358]
curr_Stock_Price:  103.39806902464179
curr_Factors:  [1.03398069e+02 4.23834970e-02]
mat_Sqrt:  [[ 2.12868217e+01  0.00000000e+00]
 [-8.23490105e-03  1.88685287e-02]]
grads:  [-3.04855060e-03  1.14908728e+01]
Stock Position:  -0.00304855060226203
Bond Position:  [3.07555005]


portfolio before change:  [2.75338534]
curr_Stock_Price:  105.80410723113384
curr_Factors:  [1.05804107e+02 4.13369372e-02]
mat_Sqrt:  [[ 2.15115485e+01  0.00000000e+00]
 [-8.13259489e-03  1.86341158e-02]]
grads:  [-3.01678003e-03  6.52028067e+00]
Stock Position:  -0.0030167800264114856
Bond Position:  [3.07257306]


portfolio before change:  [2.7581376]
curr_Stock_Price:  104.35615137483428
curr_Factors:  [1.04356151e+02 4.22034902e-02]
mat_Sqrt:  [[ 2.14383935e+01  0.00000000e+00]
 [-8.21739523e-03  1.88284178e-02]]
grads:  [-2.37108782e-03  6.72919862e+00]
Stock Position:  -0.0023710878151819146
Bond Position:  [3.0055752]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.75476313]
Stock Price:  105.93778611753255
PL:  [-3.18302299]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.47781237e-01 -1.53035691e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.59792321e-01 -7.90541890e-01]
 [-3.02760595e-02  1.54138655e-01]
 [ 1.92058638e-02 -9.47234694e-02]
 [-7.69500541e-02 -8.72873383e-02]
 [-1.28716790e-01  8.59565604e-02]
 [ 9.46235106e-02 -1.51333418e-01]
 [ 1.64350277e-01  1.54900458e-01]
 [-1.21456921e-01  4.01383676e-01]
 [ 2.12280360e-01  6.14958055e-01]
 [ 7.63979669e-02  3.63103021e-01]
 [ 3.55014629e-01  2.44343735e-02]
 [ 2.16213256e-02  1.56217990e-01]
 [ 9.91097606e-02  2.43661187e-01]
 [ 3.54897944e-02  1.94910681e-01]
 [ 1.22075455e-01  2.92828865e-01]
 [ 9.63931490e-02  6.67711596e-02]
 [ 1.82693800e-02 -1.78254120e-02]
 [ 2.50128323e-01 -1.09443386e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 5.50225459e-03  1.70581126e-01]
 [ 2.40940373e-02  1.36679105e-01]
 [-8.57400080e-02  1.05660608e-01]
 [ 6.16449863e-02  1.32495675e-01]
 [ 1.20568299e-01  5.97461052e-02]
 [ 3.46582455e-03  2.17493687e-01]
 [-1.97500665e-01  1.42408306e-01]
 [-2.55244464e-02 -1.24338364e-01]
 [ 7.95168959e-02 -6.49077947e-02]
 [-8.30779021e-01 -1.00128101e-01]
 [-1.18155741e-01  8.55580038e-03]
 [ 4.69982539e-03 -9.12529600e-02]
 [ 9.76166681e-02  9.38417337e-02]
 [-8.42339697e-02  1.52179116e-01]
 [-7.46708374e-01 -2.63536370e-01]
 [-1.84378527e-02  3.12754052e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 9.20765183e-01 -5.45961080e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.05883583]
curr_Stock_Price:  98.67960346597506
curr_Factors:  [9.86796035e+01 4.00182123e-02]
mat_Sqrt:  [[ 1.97404131e+01  0.00000000e+00]
 [-8.00182102e-03  1.83344753e-02]]
grads:  [-0.02100116 -8.34688141]
Stock Position:  -0.021001155637076004
Bond Position:  [-3.98645012]


portfolio before change:  [-6.06086719]
curr_Stock_Price:  98.75260028593806
curr_Factors:  [9.87526003e+01 4.04515334e-02]
mat_Sqrt:  [[ 1.98616825e+01  0.00000000e+00]
 [-8.04502663e-03  1.84334717e-02]]
grads:  [-0.0102199  -4.77454119]
Stock Position:  -0.010219901981630579
Bond Position:  [-5.05162529]


portfolio before change:  [-6.05509019]
curr_Stock_Price:  98.12554033651332
curr_Factors:  [9.81255403e+01 4.05828856e-02]
mat_Sqrt:  [[ 1.97675808e+01  0.00000000e+00]
 [-8.05807775e-03  1.84633756e-02]]
grads:  [ 2.60412015e-02 -4.28167582e+01]
Stock Position:  0.026041201459566156
Bond Position:  [-8.61039715]


portfolio before change:  [-6.05688119]
curr_Stock_Price:  98.09809800170633
curr_Factors:  [9.8098098e+01 3.9646207e-02]
mat_Sqrt:  [[ 1.95326608e+01  0.00000000e+00]
 [-7.96454212e-03  1.82490586e-02]]
grads:  [1.89403609e-03 8.44638940e+00]
Stock Position:  0.0018940360921242067
Bond Position:  [-6.24268252]


portfolio before change:  [-6.06001577]
curr_Stock_Price:  96.85514517222995
curr_Factors:  [9.68551452e+01 4.04357618e-02]
mat_Sqrt:  [[ 1.94762576e+01  0.00000000e+00]
 [-8.04345814e-03  1.84298779e-02]]
grads:  [-1.13650414e-03 -5.13966885e+00]
Stock Position:  -0.0011365041436325557
Bond Position:  [-5.94993949]


portfolio before change:  [-6.0602887]
curr_Stock_Price:  96.44083999482686
curr_Factors:  [9.64408400e+01 4.16778869e-02]
mat_Sqrt:  [[ 1.96885544e+01  0.00000000e+00]
 [-8.16606509e-03  1.87108057e-02]]
grads:  [-0.00584326 -4.66507641]
Stock Position:  -0.005843261484940988
Bond Position:  [-5.49675965]


portfolio before change:  [-6.06075382]
curr_Stock_Price:  96.40284574373827
curr_Factors:  [9.64028457e+01 4.15294198e-02]
mat_Sqrt:  [[ 1.96457126e+01  0.00000000e+00]
 [-8.15150733e-03  1.86774497e-02]]
grads:  [-0.00464235  4.60215725]
Stock Position:  -0.004642349876147325
Bond Position:  [-5.61321809]


portfolio before change:  [-6.05859367]
curr_Stock_Price:  95.78638071486486
curr_Factors:  [9.57863807e+01 4.24682143e-02]
mat_Sqrt:  [[ 1.97394825e+01  0.00000000e+00]
 [-8.24312701e-03  1.88873767e-02]]
grads:  [ 1.44766673e-03 -8.01241062e+00]
Stock Position:  0.0014476667332907615
Bond Position:  [-6.19726043]


portfolio before change:  [-6.06105525]
curr_Stock_Price:  94.62115019501877
curr_Factors:  [9.46211502e+01 4.39354520e-02]
mat_Sqrt:  [[ 1.98333361e+01  0.00000000e+00]
 [-8.38431412e-03  1.92108770e-02]]
grads:  [0.01169518 8.06316428]
Stock Position:  0.011695177118206872
Bond Position:  [-7.16766636]


portfolio before change:  [-6.07288293]
curr_Stock_Price:  93.68643410677069
curr_Factors:  [9.36864341e+01 4.56854689e-02]
mat_Sqrt:  [[ 2.00246877e+01  0.00000000e+00]
 [-8.54966375e-03  1.95897407e-02]]
grads:  [2.68275229e-03 2.04894839e+01]
Stock Position:  0.0026827522919710533
Bond Position:  [-6.32422043]


portfolio before change:  [-6.0742249]
curr_Stock_Price:  93.48090289453745
curr_Factors:  [9.34809029e+01 4.35046544e-02]
mat_Sqrt:  [[ 1.94980312e+01  0.00000000e+00]
 [-8.34310776e-03  1.91164614e-02]]
grads:  [2.46522356e-02 3.21690318e+01]
Stock Position:  0.02465223561288073
Bond Position:  [-8.37873814]


portfolio before change:  [-6.09619282]
curr_Stock_Price:  92.63227725889321
curr_Factors:  [9.26322773e+01 4.33208335e-02]
mat_Sqrt:  [[ 1.92801649e+01  0.00000000e+00]
 [-8.32546297e-03  1.90760321e-02]]
grads:  [1.21819040e-02 1.90345151e+01]
Stock Position:  0.012181904002506879
Bond Position:  [-7.22463033]


portfolio before change:  [-6.0827196]
curr_Stock_Price:  93.81241795222884
curr_Factors:  [9.38124180e+01 4.35460997e-02]
mat_Sqrt:  [[ 1.9576496e+01  0.0000000e+00]
 [-8.3470809e-03  1.9125565e-02]]
grads:  [0.01867947 1.27757656]
Stock Position:  0.01867947475569814
Bond Position:  [-7.83508629]


portfolio before change:  [-6.09061173]
curr_Stock_Price:  93.4423494293026
curr_Factors:  [9.34423494e+01 4.21746157e-02]
mat_Sqrt:  [[ 1.91897500e+01  0.00000000e+00]
 [-8.21458368e-03  1.88219758e-02]]
grads:  [4.67960481e-03 8.29976578e+00]
Stock Position:  0.004679604807251605
Bond Position:  [-6.527885]


portfolio before change:  [-6.09220029]
curr_Stock_Price:  93.27726546701513
curr_Factors:  [9.32772655e+01 4.17087042e-02]
mat_Sqrt:  [[ 1.90497445e+01  0.00000000e+00]
 [-8.16908359e-03  1.87177219e-02]]
grads:  [1.07850382e-02 1.30176732e+01]
Stock Position:  0.010785038152296476
Bond Position:  [-7.09819916]


portfolio before change:  [-6.08575892]
curr_Stock_Price:  93.95679071141768
curr_Factors:  [9.39567907e+01 4.08606502e-02]
mat_Sqrt:  [[ 1.89924421e+01  0.00000000e+00]
 [-8.08560699e-03  1.85264530e-02]]
grads:  [6.34756653e-03 1.05206691e+01]
Stock Position:  0.00634756652857479
Bond Position:  [-6.6821559]


portfolio before change:  [-6.08425679]
curr_Stock_Price:  94.32503400351018
curr_Factors:  [9.4325034e+01 4.2494945e-02]
mat_Sqrt:  [[ 1.94444474e+01  0.00000000e+00]
 [-8.24572083e-03  1.88933199e-02]]
grads:  [1.28507868e-02 1.54990688e+01]
Stock Position:  0.012850786823725096
Bond Position:  [-7.2964077]


portfolio before change:  [-6.07313644]
curr_Stock_Price:  95.26135521104386
curr_Factors:  [9.52613552e+01 4.20722984e-02]
mat_Sqrt:  [[ 1.95395643e+01  0.00000000e+00]
 [-8.20461318e-03  1.87991305e-02]]
grads:  [0.00642463 3.5518217 ]
Stock Position:  0.006424630073150277
Bond Position:  [-6.6851554]


portfolio before change:  [-6.07667803]
curr_Stock_Price:  94.84017887774478
curr_Factors:  [9.48401789e+01 4.11382691e-02]
mat_Sqrt:  [[ 1.92360267e+01  0.00000000e+00]
 [-8.11302845e-03  1.85892835e-02]]
grads:  [ 5.45317001e-04 -9.58907967e-01]
Stock Position:  0.0005453170012372851
Bond Position:  [-6.128396]


portfolio before change:  [-6.07686246]
curr_Stock_Price:  95.90685029916337
curr_Factors:  [9.59068503e+01 3.92924622e-02]
mat_Sqrt:  [[ 1.90109689e+01  0.00000000e+00]
 [-7.92893054e-03  1.81674622e-02]]
grads:  [ 0.01064456 -6.02414278]
Stock Position:  0.010644555525065047
Bond Position:  [-7.09774825]


portfolio before change:  [-6.08290089]
curr_Stock_Price:  95.42292569540119
curr_Factors:  [9.54229257e+01 3.99448678e-02]
mat_Sqrt:  [[ 1.90714284e+01  0.00000000e+00]
 [-7.99448488e-03  1.83176661e-02]]
grads:  [ 0.00220899 -2.06238008]
Stock Position:  0.0022089908359481285
Bond Position:  [-6.29368926]


portfolio before change:  [-6.08323888]
curr_Stock_Price:  95.62608271002655
curr_Factors:  [9.56260827e+01 4.06670292e-02]
mat_Sqrt:  [[ 1.92840207e+01  0.00000000e+00]
 [-8.06642713e-03  1.84825065e-02]]
grads:  [4.14591762e-03 9.22932861e+00]
Stock Position:  0.004145917624462967
Bond Position:  [-6.47969674]


portfolio before change:  [-6.08173485]
curr_Stock_Price:  96.18423219187444
curr_Factors:  [9.61842322e+01 4.14967085e-02]
mat_Sqrt:  [[ 1.95934407e+01  0.00000000e+00]
 [-8.14829637e-03  1.86700924e-02]]
grads:  [4.27416962e-03 7.32075139e+00]
Stock Position:  0.004274169621538013
Bond Position:  [-6.49284258]


portfolio before change:  [-6.08009969]
curr_Stock_Price:  96.75669862236347
curr_Factors:  [9.67566986e+01 4.25156104e-02]
mat_Sqrt:  [[ 1.99505674e+01  0.00000000e+00]
 [-8.24772554e-03  1.88979133e-02]]
grads:  [-1.98620608e-03  5.59112565e+00]
Stock Position:  -0.00198620608334735
Bond Position:  [-5.88792095]


portfolio before change:  [-6.07954359]
curr_Stock_Price:  96.10614238813483
curr_Factors:  [9.61061424e+01 4.21736616e-02]
mat_Sqrt:  [[ 1.97365755e+01  0.00000000e+00]
 [-8.21449077e-03  1.88217629e-02]]
grads:  [6.05327098e-03 7.03949337e+00]
Stock Position:  0.006053270979857442
Bond Position:  [-6.66130011]


portfolio before change:  [-6.07688479]
curr_Stock_Price:  96.6829394604048
curr_Factors:  [9.66829395e+01 4.17509739e-02]
mat_Sqrt:  [[ 1.97552782e+01  0.00000000e+00]
 [-8.17322202e-03  1.87272043e-02]]
grads:  [0.00742301 3.19033766]
Stock Position:  0.007423010453931367
Bond Position:  [-6.79456326]


portfolio before change:  [-6.06892584]
curr_Stock_Price:  97.86956464833467
curr_Factors:  [9.78695646e+01 4.09289762e-02]
mat_Sqrt:  [[ 1.97999046e+01  0.00000000e+00]
 [-8.09236442e-03  1.85419362e-02]]
grads:  [4.96910737e-03 1.17298261e+01]
Stock Position:  0.004969107371830677
Bond Position:  [-6.55525021]


portfolio before change:  [-6.06735474]
curr_Stock_Price:  98.35064846473901
curr_Factors:  [9.83506485e+01 3.97379715e-02]
mat_Sqrt:  [[ 1.96055972e+01  0.00000000e+00]
 [-7.97375410e-03  1.82701659e-02]]
grads:  [-6.90356862e-03  7.79458199e+00]
Stock Position:  -0.00690356862199693
Bond Position:  [-5.38838429]


portfolio before change:  [-6.07295857]
curr_Stock_Price:  99.06480706411243
curr_Factors:  [9.90648071e+01 4.00519854e-02]
mat_Sqrt:  [[ 1.98258320e+01  0.00000000e+00]
 [-8.00519685e-03  1.83422103e-02]]
grads:  [-4.02455529e-03 -6.77881029e+00]
Stock Position:  -0.004024555286285413
Bond Position:  [-5.67426678]


portfolio before change:  [-6.0694857]
curr_Stock_Price:  98.02563578289293
curr_Factors:  [9.80256358e+01 4.09870108e-02]
mat_Sqrt:  [[ 1.98455341e+01  0.00000000e+00]
 [-8.09809961e-03  1.85550772e-02]]
grads:  [ 2.57936177e-03 -3.49811504e+00]
Stock Position:  0.0025793617657219373
Bond Position:  [-6.32232927]


portfolio before change:  [-6.06965619]
curr_Stock_Price:  98.26594404460036
curr_Factors:  [9.82659440e+01 4.12217918e-02]
mat_Sqrt:  [[ 1.99510824e+01  0.00000000e+00]
 [-8.12126017e-03  1.86081447e-02]]
grads:  [-0.04383113 -5.380875  ]
Stock Position:  -0.04383113092895977
Bond Position:  [-1.76254873]


portfolio before change:  [-6.08814426]
curr_Stock_Price:  98.68271927819379
curr_Factors:  [9.86827193e+01 4.29865894e-02]
mat_Sqrt:  [[ 2.04600930e+01  0.00000000e+00]
 [-8.29328301e-03  1.90022986e-02]]
grads:  [-0.00559243  0.45025081]
Stock Position:  -0.005592432246297286
Bond Position:  [-5.53626783]


portfolio before change:  [-6.08744182]
curr_Stock_Price:  98.4333622625957
curr_Factors:  [9.84333623e+01 4.26330141e-02]
mat_Sqrt:  [[ 2.03242879e+01  0.00000000e+00]
 [-8.25910543e-03  1.89239879e-02]]
grads:  [-1.72828842e-03 -4.82207875e+00]
Stock Position:  -0.0017282884188931855
Bond Position:  [-5.91732058]


portfolio before change:  [-6.08902856]
curr_Stock_Price:  98.9234565060159
curr_Factors:  [9.89234565e+01 4.28801173e-02]
mat_Sqrt:  [[ 2.04845895e+01  0.00000000e+00]
 [-8.28300596e-03  1.89787509e-02]]
grads:  [0.00676472 4.94456849]
Stock Position:  0.006764722249096585
Bond Position:  [-6.75821826]


portfolio before change:  [-6.10033656]
curr_Stock_Price:  97.37673084186642
curr_Factors:  [9.73767308e+01 4.46200354e-02]
mat_Sqrt:  [[ 2.05693300e+01  0.00000000e+00]
 [-8.44938203e-03  1.93599664e-02]]
grads:  [-8.66219675e-04  7.86050520e+00]
Stock Position:  -0.0008662196749504085
Bond Position:  [-6.01598692]


portfolio before change:  [-6.10160186]
curr_Stock_Price:  97.96925456927043
curr_Factors:  [9.79692546e+01 4.67787052e-02]
mat_Sqrt:  [[ 2.11891679e+01  0.00000000e+00]
 [-8.65135414e-03  1.98227426e-02]]
grads:  [ -0.04066819 -13.29464724]
Stock Position:  -0.04066818858330266
Bond Position:  [-2.11736974]


portfolio before change:  [-6.10917634]
curr_Stock_Price:  98.14899680195795
curr_Factors:  [9.81489968e+01 4.77867564e-02]
mat_Sqrt:  [[ 2.14555495e+01  0.00000000e+00]
 [-8.74407287e-03  2.00351879e-02]]
grads:  [5.50250209e-03 1.56102380e+01]
Stock Position:  0.005502502090846782
Bond Position:  [-6.6492414]


portfolio before change:  [-6.11399085]
curr_Stock_Price:  97.42508834891774
curr_Factors:  [9.74250883e+01 4.74424866e-02]
mat_Sqrt:  [[ 2.12204471e+01  0.00000000e+00]
 [-8.71251850e-03  1.99628878e-02]]
grads:  [-4.15567188e-03  5.47825373e+00]
Stock Position:  -0.004155671880525959
Bond Position:  [-5.70912415]


portfolio before change:  [-6.10892112]
curr_Stock_Price:  96.03339655028027
curr_Factors:  [9.60333966e+01 4.65624454e-02]
mat_Sqrt:  [[ 2.07224061e+01  0.00000000e+00]
 [-8.63133319e-03  1.97768688e-02]]
grads:  [ 0.04431833 -0.27606042]
Stock Position:  0.044318329170393564
Bond Position:  [-10.3649608]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.04409058]
Stock Price:  97.5254709917618
PL:  [-6.04409058]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 5.29608568e-01  9.74768567e-01]
 [-3.33020361e-01 -4.19807302e-02]
 [ 8.47023437e-01 -7.11994199e-01]
 [-1.48747953e-01  9.56359571e-02]
 [-1.84026088e-01  7.70089903e-02]
 [ 9.39421949e-02  1.05173292e-01]
 [ 3.21903940e-02  2.52209956e-01]
 [ 2.23163155e-01 -2.10864867e-03]
 [ 1.10205872e-01  8.78858136e-02]
 [ 3.73661939e-01 -1.98528853e-01]
 [ 6.64274687e-02  8.82133686e-03]
 [-1.24408795e-01 -1.90019832e-01]
 [-1.87320010e-01  1.64912858e-01]
 [-6.70313494e-01 -8.84216572e-01]
 [-4.80449726e-03 -1.40323193e-01]
 [ 5.69160386e-02 -2.22622334e-02]
 [-5.27811506e-02  2.60007479e-01]
 [-1.30717889e-01  3.12887193e-02]
 [ 1.49859540e-02  6.37025519e-02]
 [-2.90104429e-02 -7.99238446e-02]
 [ 1.48192821e-01  5.46181149e-02]
 [ 3.77341571e-02  1.79258065e-01]
 [ 3.90884548e-02  4.16630373e-01]
 [-2.09869418e-02  1.46961593e-01]
 [ 2.81341552e-02  7.01352013e-02]
 [ 5.65646305e-01 -1.51581994e-01]
 [ 1.10273263e-02  6.25551338e-02]
 [-2.03020704e-01  1.45098664e-01]
 [ 1.30541318e-02 -1.42780013e-01]
 [-1.20048195e-02 -4.35193410e-02]
 [-5.98338801e-01 -9.42515074e-02]
 [-1.18054433e-01  4.62301776e-03]
 [ 7.81211775e-02  1.22963068e-02]
 [ 1.12048478e-01  8.64375784e-02]
 [-1.65894329e-01  7.20435548e-02]
 [-4.01921418e-01 -3.54486710e-01]
 [-3.87520786e-02  3.07265559e-01]
 [-1.23724936e-01  1.17585163e-01]
 [ 3.47243223e-01  6.12904729e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.35501325]
curr_Stock_Price:  102.0554919151856
curr_Factors:  [1.02055492e+02 3.99159297e-02]
mat_Sqrt:  [[ 2.03896375e+01  0.00000000e+00]
 [-7.99158855e-03  1.83110297e-02]]
grads:  [4.68391087e-02 5.32339569e+01]
Stock Position:  0.04683910870737056
Bond Position:  [11.57482497]


portfolio before change:  [16.40878187]
curr_Stock_Price:  103.17254297987917
curr_Factors:  [1.03172543e+02 3.81475153e-02]
mat_Sqrt:  [[ 2.01510306e+01  0.00000000e+00]
 [-7.81255557e-03  1.79008136e-02]]
grads:  [-0.01743545 -2.34518559]
Stock Position:  -0.017435448350675446
Bond Position:  [18.20764142]


portfolio before change:  [16.42693625]
curr_Stock_Price:  102.2618536581576
curr_Factors:  [1.02261854e+02 3.82840143e-02]
mat_Sqrt:  [[ 2.00088623e+01  0.00000000e+00]
 [-7.82652049e-03  1.79328113e-02]]
grads:  [ 2.68023081e-02 -3.97034346e+01]
Stock Position:  0.0268023080869702
Bond Position:  [13.68608254]


portfolio before change:  [16.48444332]
curr_Stock_Price:  104.34362248504041
curr_Factors:  [1.04343622e+02 3.64320731e-02]
mat_Sqrt:  [[ 1.99162630e+01  0.00000000e+00]
 [-7.63487505e-03  1.74936964e-02]]
grads:  [-5.37294570e-03  5.46688103e+00]
Stock Position:  -0.005372945698393524
Bond Position:  [17.04507594]


portfolio before change:  [16.49042649]
curr_Stock_Price:  103.62662225224545
curr_Factors:  [1.03626622e+02 3.73405068e-02]
mat_Sqrt:  [[ 2.00244892e+01  0.00000000e+00]
 [-7.72947675e-03  1.77104561e-02]]
grads:  [-0.00751163  4.34822173]
Stock Position:  -0.007511632796559488
Bond Position:  [17.26883163]


portfolio before change:  [16.4997751]
curr_Stock_Price:  102.66945782845313
curr_Factors:  [1.02669458e+02 3.72991879e-02]
mat_Sqrt:  [[ 1.98285500e+01  0.00000000e+00]
 [-7.72519906e-03  1.77006547e-02]]
grads:  [0.00705264 5.94177413]
Stock Position:  0.0070526378858119685
Bond Position:  [15.77568459]


portfolio before change:  [16.49756492]
curr_Stock_Price:  102.0764510318826
curr_Factors:  [1.02076451e+02 3.65369676e-02]
mat_Sqrt:  [[ 1.95115518e+01  0.00000000e+00]
 [-7.64585824e-03  1.75188621e-02]]
grads:  [7.29126233e-03 1.43964805e+01]
Stock Position:  0.007291262334815587
Bond Position:  [15.75329874]


portfolio before change:  [16.49251959]
curr_Stock_Price:  101.11439249586226
curr_Factors:  [1.01114392e+02 3.57411380e-02]
mat_Sqrt:  [[ 1.91160063e+01  0.00000000e+00]
 [-7.56213071e-03  1.73270182e-02]]
grads:  [ 0.01162601 -0.12169715]
Stock Position:  0.011626009209115457
Bond Position:  [15.31696273]


portfolio before change:  [16.50393845]
curr_Stock_Price:  101.93188095053148
curr_Factors:  [1.01931881e+02 3.57464239e-02]
mat_Sqrt:  [[ 1.92719801e+01  0.00000000e+00]
 [-7.56268989e-03  1.73282994e-02]]
grads:  [0.00770872 5.07180834]
Stock Position:  0.0077087245222385225
Bond Position:  [15.71817366]


portfolio before change:  [16.50849359]
curr_Stock_Price:  102.26789542093759
curr_Factors:  [1.02267895e+02 3.64723632e-02]
mat_Sqrt:  [[ 1.95308557e+01  0.00000000e+00]
 [-7.63909557e-03  1.75033668e-02]]
grads:  [  0.01469556 -11.34232372]
Stock Position:  0.01469555911059926
Bond Position:  [15.00560969]


portfolio before change:  [16.49792794]
curr_Stock_Price:  101.42128085342405
curr_Factors:  [1.01421281e+02 3.67143068e-02]
mat_Sqrt:  [[ 1.94333091e+01  0.00000000e+00]
 [-7.66439110e-03  1.75613262e-02]]
grads:  [0.00361634 0.5023161 ]
Stock Position:  0.00361633808780154
Bond Position:  [16.13115429]


portfolio before change:  [16.50292223]
curr_Stock_Price:  102.24470394530336
curr_Factors:  [1.02244704e+02 3.55481197e-02]
mat_Sqrt:  [[ 1.92774302e+01  0.00000000e+00]
 [-7.54168360e-03  1.72801680e-02]]
grads:  [-1.07555959e-02 -1.09964112e+01]
Stock Position:  -0.010755595864728617
Bond Position:  [17.60262495]


portfolio before change:  [16.50748175]
curr_Stock_Price:  102.0253712466811
curr_Factors:  [1.02025371e+02 3.47920954e-02]
mat_Sqrt:  [[ 1.90304245e+01  0.00000000e+00]
 [-7.46105574e-03  1.70954263e-02]]
grads:  [-6.06114375e-03  9.64660689e+00]
Stock Position:  -0.006061143754039317
Bond Position:  [17.12587219]


portfolio before change:  [16.4996375]
curr_Stock_Price:  103.67276996558473
curr_Factors:  [1.03672770e+02 3.42742194e-02]
mat_Sqrt:  [[ 1.91932486e+01  0.00000000e+00]
 [-7.40531911e-03  1.69677177e-02]]
grads:  [ -0.05503067 -52.11169755]
Stock Position:  -0.05503066547266693
Bond Position:  [22.20481902]


portfolio before change:  [16.49335351]
curr_Stock_Price:  103.8374012178894
curr_Factors:  [1.03837401e+02 3.50717620e-02]
mat_Sqrt:  [[ 1.94461040e+01  0.00000000e+00]
 [-7.49098253e-03  1.71639972e-02]]
grads:  [-3.39639033e-03 -8.17543786e+00]
Stock Position:  -0.0033963903308419207
Bond Position:  [16.84602585]


portfolio before change:  [16.5003939]
curr_Stock_Price:  102.3845336266235
curr_Factors:  [1.02384534e+02 3.53654499e-02]
mat_Sqrt:  [[ 1.92541322e+01  0.00000000e+00]
 [-7.52228156e-03  1.72357123e-02]]
grads:  [ 0.00245142 -1.29163408]
Stock Position:  0.0024514220025433535
Bond Position:  [16.2494062]


portfolio before change:  [16.50112192]
curr_Stock_Price:  101.85289193859559
curr_Factors:  [1.01852892e+02 3.59546908e-02]
mat_Sqrt:  [[ 1.93130624e+01  0.00000000e+00]
 [-7.58468887e-03  1.73787054e-02]]
grads:  [3.14271322e-03 1.49612686e+01]
Stock Position:  0.0031427132188343357
Bond Position:  [16.18102749]


portfolio before change:  [16.50145694]
curr_Stock_Price:  101.31585992942902
curr_Factors:  [1.0131586e+02 3.5529640e-02]
mat_Sqrt:  [[ 1.90973382e+01  0.00000000e+00]
 [-7.53972307e-03  1.72756758e-02]]
grads:  [-0.00612977  1.811143  ]
Stock Position:  -0.006129774264720915
Bond Position:  [17.12250029]


portfolio before change:  [16.50231723]
curr_Stock_Price:  101.52470281155657
curr_Factors:  [1.01524703e+02 3.25013006e-02]
mat_Sqrt:  [[ 1.83029923e+01  0.00000000e+00]
 [-7.21124684e-03  1.65230423e-02]]
grads:  [2.33776129e-03 3.85537668e+00]
Stock Position:  0.0023377612911553167
Bond Position:  [16.26497671]


portfolio before change:  [16.50187545]
curr_Stock_Price:  100.46598644394082
curr_Factors:  [1.00465986e+02 3.22351886e-02]
mat_Sqrt:  [[ 1.80378246e+01  0.00000000e+00]
 [-7.18166428e-03  1.64552601e-02]]
grads:  [-3.54211606e-03 -4.85703928e+00]
Stock Position:  -0.003542116061377879
Bond Position:  [16.85773763]


portfolio before change:  [16.50291082]
curr_Stock_Price:  100.76862289475224
curr_Factors:  [1.00768623e+02 3.40038776e-02]
mat_Sqrt:  [[ 1.85818755e+01  0.00000000e+00]
 [-7.37605614e-03  1.69006678e-02]]
grads:  [0.00925795 3.23171342]
Stock Position:  0.009257952505249903
Bond Position:  [15.5699997]


portfolio before change:  [16.50989165]
curr_Stock_Price:  101.31242087831615
curr_Factors:  [1.01312421e+02 3.43514589e-02]
mat_Sqrt:  [[ 1.87773926e+01  0.00000000e+00]
 [-7.41365863e-03  1.69868259e-02]]
grads:  [6.17597944e-03 1.05527699e+01]
Stock Position:  0.006175979436193733
Bond Position:  [15.88418822]


portfolio before change:  [16.51146045]
curr_Stock_Price:  101.24492576183178
curr_Factors:  [1.01244926e+02 3.55020406e-02]
mat_Sqrt:  [[ 1.90765539e+01  0.00000000e+00]
 [-7.53679408e-03  1.72689647e-02]]
grads:  [1.15807529e-02 2.41259613e+01]
Stock Position:  0.011580752887725167
Bond Position:  [15.33896798]


portfolio before change:  [16.50007128]
curr_Stock_Price:  100.09589319493237
curr_Factors:  [1.00095893e+02 3.61617725e-02]
mat_Sqrt:  [[ 1.90344843e+01  0.00000000e+00]
 [-7.60649958e-03  1.74286801e-02]]
grads:  [2.26706199e-03 8.43217000e+00]
Stock Position:  0.0022670619932094916
Bond Position:  [16.27314768]


portfolio before change:  [16.49821122]
curr_Stock_Price:  98.37810429705634
curr_Factors:  [9.83781043e+01 3.59544676e-02]
mat_Sqrt:  [[ 1.86541249e+01  0.00000000e+00]
 [-7.58466533e-03  1.73786515e-02]]
grads:  [3.14909795e-03 4.03571021e+00]
Stock Position:  0.003149097950079841
Bond Position:  [16.18840893]


portfolio before change:  [16.5046148]
curr_Stock_Price:  99.76894938940964
curr_Factors:  [9.97689494e+01 3.65245297e-02]
mat_Sqrt:  [[ 1.90672348e+01  0.00000000e+00]
 [-7.64455672e-03  1.75158799e-02]]
grads:  [ 0.02619627 -8.6539754 ]
Stock Position:  0.02619627354012731
Bond Position:  [13.89104011]


portfolio before change:  [16.5122957]
curr_Stock_Price:  99.9958673915634
curr_Factors:  [9.99958674e+01 3.68871290e-02]
mat_Sqrt:  [[ 1.92052285e+01  0.00000000e+00]
 [-7.68240889e-03  1.76026101e-02]]
grads:  [1.99573907e-03 3.55374193e+00]
Stock Position:  0.0019957390725616063
Bond Position:  [16.31273004]


portfolio before change:  [16.51309725]
curr_Stock_Price:  99.37571453147451
curr_Factors:  [9.93757145e+01 3.73742080e-02]
mat_Sqrt:  [[ 1.92117207e+01  0.00000000e+00]
 [-7.73296403e-03  1.77184465e-02]]
grads:  [-7.27131410e-03  8.18913009e+00]
Stock Position:  -0.007271314098121794
Bond Position:  [17.23568929]


portfolio before change:  [16.51301847]
curr_Stock_Price:  99.68286407610968
curr_Factors:  [9.96828641e+01 3.61092290e-02]
mat_Sqrt:  [[ 1.89421650e+01  0.00000000e+00]
 [-7.60097141e-03  1.74160134e-02]]
grads:  [-2.60055673e-03 -8.19820299e+00]
Stock Position:  -0.00260055673162106
Bond Position:  [16.77224941]


portfolio before change:  [16.51299858]
curr_Stock_Price:  100.49674650400313
curr_Factors:  [1.00496747e+02 3.58879122e-02]
mat_Sqrt:  [[ 1.90382094e+01  0.00000000e+00]
 [-7.57764208e-03  1.73625592e-02]]
grads:  [-1.62821075e-03 -2.50650497e+00]
Stock Position:  -0.001628210746384499
Bond Position:  [16.67662846]


portfolio before change:  [16.51482487]
curr_Stock_Price:  100.65545806970722
curr_Factors:  [1.00655458e+02 3.66456115e-02]
mat_Sqrt:  [[ 1.92685181e+01  0.00000000e+00]
 [-7.65721741e-03  1.75448892e-02]]
grads:  [-0.03318748 -5.37202067]
Stock Position:  -0.033187478478241376
Bond Position:  [19.85532572]


portfolio before change:  [16.53181793]
curr_Stock_Price:  100.21821538722361
curr_Factors:  [1.00218215e+02 3.57580980e-02]
mat_Sqrt:  [[ 1.89510759e+01  0.00000000e+00]
 [-7.56392470e-03  1.73311287e-02]]
grads:  [-0.00612297  0.26674649]
Stock Position:  -0.0061229654608841635
Bond Position:  [17.1454506]


portfolio before change:  [16.53331138]
curr_Stock_Price:  100.32435078960843
curr_Factors:  [1.00324351e+02 3.72779866e-02]
mat_Sqrt:  [[ 1.93701321e+01  0.00000000e+00]
 [-7.72300321e-03  1.76956234e-02]]
grads:  [0.00431013 0.69487842]
Stock Position:  0.00431012681914804
Bond Position:  [16.1009007]


portfolio before change:  [16.53387096]
curr_Stock_Price:  99.98720012959804
curr_Factors:  [9.99872001e+01 3.76621471e-02]
mat_Sqrt:  [[ 1.94042537e+01  0.00000000e+00]
 [-7.76269511e-03  1.77865690e-02]]
grads:  [0.00771856 4.85971064]
Stock Position:  0.007718561691886007
Bond Position:  [15.76211358]


portfolio before change:  [16.52723962]
curr_Stock_Price:  98.87278024035602
curr_Factors:  [9.88727802e+01 3.74081661e-02]
mat_Sqrt:  [[ 1.91231731e+01  0.00000000e+00]
 [-7.73647632e-03  1.77264942e-02]]
grads:  [-0.00703084  4.06417389]
Stock Position:  -0.00703083860855416
Bond Position:  [17.22239818]


portfolio before change:  [16.52367175]
curr_Stock_Price:  99.68645374520038
curr_Factors:  [9.96864537e+01 3.81849107e-02]
mat_Sqrt:  [[ 1.94796898e+01  0.00000000e+00]
 [-7.81638389e-03  1.79095854e-02]]
grads:  [ -0.028575   -19.79312766]
Stock Position:  -0.028574998294910343
Bond Position:  [19.372212]


portfolio before change:  [16.54602724]
curr_Stock_Price:  98.9888576850383
curr_Factors:  [9.89888577e+01 4.05177047e-02]
mat_Sqrt:  [[ 1.99254771e+01  0.00000000e+00]
 [-8.05160403e-03  1.84485425e-02]]
grads:  [4.78531102e-03 1.66552756e+01]
Stock Position:  0.004785311022356235
Bond Position:  [16.07233476]


portfolio before change:  [16.55224024]
curr_Stock_Price:  99.86734613054045
curr_Factors:  [9.98673461e+01 3.91787293e-02]
mat_Sqrt:  [[ 1.97673605e+01  0.00000000e+00]
 [-7.91744699e-03  1.81411501e-02]]
grads:  [-3.66293536e-03  6.48168185e+00]
Stock Position:  -0.0036629353566216094
Bond Position:  [16.91804788]


portfolio before change:  [16.55319956]
curr_Stock_Price:  100.18282355846752
curr_Factors:  [1.00182824e+02 3.90763452e-02]
mat_Sqrt:  [[ 1.98038777e+01  0.00000000e+00]
 [-7.90709507e-03  1.81174308e-02]]
grads:  [0.01888482 3.38295609]
Stock Position:  0.018884815528149308
Bond Position:  [14.66126542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.55456868]
Stock Price:  100.15827186640124
PL:  [16.39629681]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-5.53651660e-02  1.92026757e-01]
 [-1.80578425e-01 -7.33791671e-02]
 [ 7.51286621e-01 -6.36737400e-01]
 [-6.93941432e-03  2.48141585e-02]
 [-4.79124732e-02  2.25349793e-02]
 [-7.96459752e-02 -6.22963320e-02]
 [ 1.86483284e-03  3.18480774e-01]
 [ 9.44723176e-02 -3.84490815e-02]
 [ 1.58740763e-01  7.24501653e-02]
 [ 2.61529530e-01 -1.08459840e-01]
 [ 1.00174319e-01  1.27637922e-01]
 [-8.12630255e-02  2.87236295e-02]
 [ 1.06723622e-01  5.90741435e-02]
 [-2.66728605e-01 -3.68818503e-01]
 [ 8.45048628e-02  2.28908330e-01]
 [ 5.11439280e-02 -1.25216781e-02]
 [ 7.63783204e-03 -5.38253336e-02]
 [ 2.05695678e-02  5.35920492e-02]
 [ 1.59084551e-02  4.07967104e-02]
 [ 2.34134535e-01 -1.08462097e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 4.91371441e-02  2.36872112e-01]
 [ 3.55796813e-02  2.57429517e-01]
 [-6.08857942e-02  1.22883424e-01]
 [ 1.53052069e-02  3.69027874e-02]
 [ 4.59029692e-01 -9.49611038e-02]
 [-2.19807363e-02  1.70668493e-01]
 [-6.26037675e-02  8.23697897e-02]
 [ 6.00862432e-02 -1.60225483e-01]
 [-5.50979369e-02 -3.35846823e-02]
 [-4.42517527e-01 -9.80442272e-02]
 [-1.17916574e-01 -7.28699108e-04]
 [ 2.17851254e-01  2.50145478e-01]
 [ 2.28600508e-01  2.66412424e-02]
 [-1.65923068e-01 -2.41430087e-01]
 [ 1.59083921e-01 -1.49632046e-01]
 [-1.69566783e-01  2.07755072e-01]
 [-1.20989200e-01  1.19430747e-01]
 [-6.15059894e-02  1.15345998e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.38931593]
curr_Stock_Price:  99.6507994866888
curr_Factors:  [9.96507995e+01 4.10850642e-02]
mat_Sqrt:  [[ 2.01986699e+01  0.00000000e+00]
 [-8.10778038e-03  1.85772587e-02]]
grads:  [1.40812151e-03 1.03366573e+01]
Stock Position:  0.0014081215120455104
Bond Position:  [0.24899549]


portfolio before change:  [0.39146685]
curr_Stock_Price:  101.15620980840252
curr_Factors:  [1.01156210e+02 3.86028913e-02]
mat_Sqrt:  [[ 1.98747862e+01  0.00000000e+00]
 [-7.85904741e-03  1.80073398e-02]]
grads:  [-0.01069716 -4.07495876]
Stock Position:  -0.010697157515289863
Bond Position:  [1.47355076]


portfolio before change:  [0.3894721]
curr_Stock_Price:  101.3599050469124
curr_Factors:  [1.01359905e+02 3.98294421e-02]
mat_Sqrt:  [[ 2.02287155e+01  0.00000000e+00]
 [-7.98292599e-03  1.82911813e-02]]
grads:  [ 2.34019622e-02 -3.48111688e+01]
Stock Position:  0.02340196222774311
Bond Position:  [-1.98254857]


portfolio before change:  [0.36610826]
curr_Stock_Price:  100.37212450484738
curr_Factors:  [1.00372125e+02 4.08352624e-02]
mat_Sqrt:  [[ 2.02829347e+01  0.00000000e+00]
 [-8.08309469e-03  1.85206966e-02]]
grads:  [1.91805198e-04 1.33980697e+00]
Stock Position:  0.00019180519771612402
Bond Position:  [0.34685637]


portfolio before change:  [0.36614789]
curr_Stock_Price:  100.35267025972387
curr_Factors:  [1.00352670e+02 4.00268906e-02]
mat_Sqrt:  [[ 2.00772793e+01  0.00000000e+00]
 [-8.00268861e-03  1.83364632e-02]]
grads:  [-0.00189654  1.22897088]
Stock Position:  -0.001896541927765897
Bond Position:  [0.55647094]


portfolio before change:  [0.36584062]
curr_Stock_Price:  100.55136365153034
curr_Factors:  [1.00551364e+02 4.10384415e-02]
mat_Sqrt:  [[ 2.03696419e+01  0.00000000e+00]
 [-8.10317878e-03  1.85667151e-02]]
grads:  [-0.00524478 -3.35526946]
Stock Position:  -0.0052447816207628626
Bond Position:  [0.89321057]


portfolio before change:  [0.36381772]
curr_Stock_Price:  100.95835098308454
curr_Factors:  [1.00958351e+02 4.07025569e-02]
mat_Sqrt:  [[ 2.03682208e+01  0.00000000e+00]
 [-8.06994988e-03  1.84905781e-02]]
grads:  [6.91573601e-03 1.72239490e+01]
Stock Position:  0.0069157360136671946
Bond Position:  [-0.33438358]


portfolio before change:  [0.35656794]
curr_Stock_Price:  99.91609287037474
curr_Factors:  [9.99160929e+01 4.05400150e-02]
mat_Sqrt:  [[ 2.01176568e+01  0.00000000e+00]
 [-8.05382046e-03  1.84536209e-02]]
grads:  [ 0.00386187 -2.08355214]
Stock Position:  0.003861869370684755
Bond Position:  [-0.02929496]


portfolio before change:  [0.3551168]
curr_Stock_Price:  99.54128095732356
curr_Factors:  [9.95412810e+01 3.94658723e-02]
mat_Sqrt:  [[ 1.97748901e+01  0.00000000e+00]
 [-7.94640772e-03  1.82075074e-02]]
grads:  [0.00962638 3.97913693]
Stock Position:  0.009626380059322178
Bond Position:  [-0.6031054]


portfolio before change:  [0.3564662]
curr_Stock_Price:  99.68928977320955
curr_Factors:  [9.96892898e+01 3.93295848e-02]
mat_Sqrt:  [[ 1.97700689e+01  0.00000000e+00]
 [-7.93267519e-03  1.81760423e-02]]
grads:  [ 0.01083425 -5.96718681]
Stock Position:  0.01083424526205869
Bond Position:  [-0.72359202]


portfolio before change:  [0.35509814]
curr_Stock_Price:  99.57136691969153
curr_Factors:  [9.95713669e+01 4.10960922e-02]
mat_Sqrt:  [[ 2.01852779e+01  0.00000000e+00]
 [-8.10886845e-03  1.85797517e-02]]
grads:  [0.00772246 6.8697324 ]
Stock Position:  0.007722463674010046
Bond Position:  [-0.41383812]


portfolio before change:  [0.3571083]
curr_Stock_Price:  99.83836608721275
curr_Factors:  [9.98383661e+01 4.12743144e-02]
mat_Sqrt:  [[ 2.02832432e+01  0.00000000e+00]
 [-8.12643236e-03  1.86199957e-02]]
grads:  [-0.00338836  1.54262278]
Stock Position:  -0.0033883637380933097
Bond Position:  [0.695397]


portfolio before change:  [0.36030555]
curr_Stock_Price:  98.92042397260256
curr_Factors:  [9.89204240e+01 4.10280799e-02]
mat_Sqrt:  [[ 2.00367171e+01  0.00000000e+00]
 [-8.10215576e-03  1.85643710e-02]]
grads:  [0.00661314 3.1821247 ]
Stock Position:  0.006613143813343561
Bond Position:  [-0.29386944]


portfolio before change:  [0.35984743]
curr_Stock_Price:  98.85670566518134
curr_Factors:  [9.88567057e+01 4.14710626e-02]
mat_Sqrt:  [[ 2.01316196e+01  0.00000000e+00]
 [-8.14577806e-03  1.86643223e-02]]
grads:  [ -0.0212449  -19.76061586]
Stock Position:  -0.02124489756174005
Bond Position:  [2.46004802]


portfolio before change:  [0.36474464]
curr_Stock_Price:  98.64066899235817
curr_Factors:  [9.86406690e+01 4.06899321e-02]
mat_Sqrt:  [[ 1.98975448e+01  0.00000000e+00]
 [-8.06869824e-03  1.84877102e-02]]
grads:  [9.26790970e-03 1.23816485e+01]
Stock Position:  0.009267909696586392
Bond Position:  [-0.54944818]


portfolio before change:  [0.35845779]
curr_Stock_Price:  97.96973410814164
curr_Factors:  [9.79697341e+01 4.13613659e-02]
mat_Sqrt:  [[ 1.99245887e+01  0.00000000e+00]
 [-8.13499757e-03  1.86396211e-02]]
grads:  [ 0.0022926 -0.6717775]
Stock Position:  0.002292595357756378
Bond Position:  [0.13385283]


portfolio before change:  [0.35814652]
curr_Stock_Price:  97.8266628691634
curr_Factors:  [9.78266629e+01 4.06502973e-02]
mat_Sqrt:  [[ 1.97237324e+01  0.00000000e+00]
 [-8.06476755e-03  1.84787039e-02]]
grads:  [-8.03776340e-04 -2.91283057e+00]
Stock Position:  -0.0008037763397797717
Bond Position:  [0.43677727]


portfolio before change:  [0.35822822]
curr_Stock_Price:  97.79294525619831
curr_Factors:  [9.77929453e+01 4.24276963e-02]
mat_Sqrt:  [[ 2.01433757e+01  0.00000000e+00]
 [-8.23919378e-03  1.88783646e-02]]
grads:  [2.18230829e-03 2.83880783e+00]
Stock Position:  0.0021823082904685407
Bond Position:  [0.14481386]


portfolio before change:  [0.35744065]
curr_Stock_Price:  97.4237635449884
curr_Factors:  [9.74237635e+01 4.21672122e-02]
mat_Sqrt:  [[ 2.00056353e+01  0.00000000e+00]
 [-8.21386264e-03  1.88203237e-02]]
grads:  [1.68520513e-03 2.16769441e+00]
Stock Position:  0.0016852051296517361
Bond Position:  [0.19326163]


portfolio before change:  [0.35529343]
curr_Stock_Price:  96.13526592017382
curr_Factors:  [9.61352659e+01 4.13488121e-02]
mat_Sqrt:  [[ 1.95485365e+01  0.00000000e+00]
 [-8.13376293e-03  1.86367921e-02]]
grads:  [ 0.00955559 -5.81978358]
Stock Position:  0.00955558971895961
Bond Position:  [-0.56333573]


portfolio before change:  [0.36789515]
curr_Stock_Price:  97.46141584165836
curr_Factors:  [9.74614158e+01 4.03430392e-02]
mat_Sqrt:  [[ 1.95756875e+01  0.00000000e+00]
 [-8.03423069e-03  1.84087351e-02]]
grads:  [ 0.00215209 -2.05217737]
Stock Position:  0.0021520884373234456
Bond Position:  [0.15814957]


portfolio before change:  [0.36763841]
curr_Stock_Price:  97.33292840068124
curr_Factors:  [9.73329284e+01 3.99388749e-02]
mat_Sqrt:  [[ 1.94517063e+01  0.00000000e+00]
 [-7.99388516e-03  1.83162919e-02]]
grads:  [7.84078306e-03 1.29323180e+01]
Stock Position:  0.007840783063418406
Bond Position:  [-0.39552797]


portfolio before change:  [0.37437602]
curr_Stock_Price:  98.19853772535588
curr_Factors:  [9.81985377e+01 3.83048952e-02]
mat_Sqrt:  [[ 1.92190608e+01  0.00000000e+00]
 [-7.82865457e-03  1.79377011e-02]]
grads:  [7.69710525e-03 1.43513105e+01]
Stock Position:  0.007697105249611172
Bond Position:  [-0.38146846]


portfolio before change:  [0.37714291]
curr_Stock_Price:  98.56420465817745
curr_Factors:  [9.85642047e+01 3.75108296e-02]
mat_Sqrt:  [[ 1.90896320e+01  0.00000000e+00]
 [-7.74708509e-03  1.77508019e-02]]
grads:  [-3.80052949e-04  6.92269707e+00]
Stock Position:  -0.00038005294892508085
Bond Position:  [0.41460252]


portfolio before change:  [0.37697096]
curr_Stock_Price:  99.15301250676714
curr_Factors:  [9.91530125e+01 3.70830895e-02]
mat_Sqrt:  [[ 1.90938659e+01  0.00000000e+00]
 [-7.70278801e-03  1.76493046e-02]]
grads:  [1.64507826e-03 2.09089187e+00]
Stock Position:  0.001645078263004587
Bond Position:  [0.21385649]


portfolio before change:  [0.37673555]
curr_Stock_Price:  98.99366178796829
curr_Factors:  [9.89936618e+01 3.61280881e-02]
mat_Sqrt:  [[ 1.88161115e+01  0.00000000e+00]
 [-7.60295607e-03  1.74205608e-02]]
grads:  [ 0.02219296 -5.45109337]
Stock Position:  0.02219296307003536
Bond Position:  [-1.82022713]


portfolio before change:  [0.37529861]
curr_Stock_Price:  98.9391673952842
curr_Factors:  [9.89391674e+01 3.76296688e-02]
mat_Sqrt:  [[ 1.91925840e+01  0.00000000e+00]
 [-7.75934727e-03  1.77788981e-02]]
grads:  [2.73569733e-03 9.59949780e+00]
Stock Position:  0.002735697332690603
Bond Position:  [0.104631]


portfolio before change:  [0.380299]
curr_Stock_Price:  100.76221590298432
curr_Factors:  [1.00762216e+02 3.64598940e-02]
mat_Sqrt:  [[ 1.92400152e+01  0.00000000e+00]
 [-7.63778963e-03  1.75003746e-02]]
grads:  [-1.38537542e-03  4.70674439e+00]
Stock Position:  -0.0013853754158600908
Bond Position:  [0.5198925]


portfolio before change:  [0.37951664]
curr_Stock_Price:  101.37385309687535
curr_Factors:  [1.01373853e+02 3.64798314e-02]
mat_Sqrt:  [[ 1.93620958e+01  0.00000000e+00]
 [-7.63987764e-03  1.75051588e-02]]
grads:  [-5.08307083e-04 -9.15304367e+00]
Stock Position:  -0.0005083070832421626
Bond Position:  [0.43104569]


portfolio before change:  [0.37941015]
curr_Stock_Price:  101.68936908290179
curr_Factors:  [1.01689369e+02 3.73203285e-02]
mat_Sqrt:  [[ 1.96448303e+01  0.00000000e+00]
 [-7.72738802e-03  1.77056703e-02]]
grads:  [-0.00355083 -1.89683202]
Stock Position:  -0.003550832093243936
Bond Position:  [0.74049202]


portfolio before change:  [0.37822859]
curr_Stock_Price:  102.04819322813249
curr_Factors:  [1.02048193e+02 3.78516526e-02]
mat_Sqrt:  [[ 1.98539874e+01  0.00000000e+00]
 [-7.78220047e-03  1.78312614e-02]]
grads:  [-0.02444383 -5.49844597]
Stock Position:  -0.024443832145696252
Bond Position:  [2.8726775]


portfolio before change:  [0.36411112]
curr_Stock_Price:  102.64043170424125
curr_Factors:  [1.02640432e+02 3.89563366e-02]
mat_Sqrt:  [[ 2.02585112e+01  0.00000000e+00]
 [-7.89494386e-03  1.80895889e-02]]
grads:  [-0.00583629 -0.04028279]
Stock Position:  -0.005836292873701823
Bond Position:  [0.96315074]


portfolio before change:  [0.34744656]
curr_Stock_Price:  105.51639432549645
curr_Factors:  [1.05516394e+02 3.85960160e-02]
mat_Sqrt:  [[ 2.07296124e+01  0.00000000e+00]
 [-7.85834751e-03  1.80057362e-02]]
grads:  [ 0.01577568 13.89254378]
Stock Position:  0.015775678029351207
Bond Position:  [-1.3171461]


portfolio before change:  [0.36021194]
curr_Stock_Price:  106.33601232035308
curr_Factors:  [1.06336012e+02 3.72511208e-02]
mat_Sqrt:  [[ 2.05234346e+01  0.00000000e+00]
 [-7.72021977e-03  1.76892457e-02]]
grads:  [0.01170504 1.50607001]
Stock Position:  0.011705043717847563
Bond Position:  [-0.88445573]


portfolio before change:  [0.37523705]
curr_Stock_Price:  107.6291026206363
curr_Factors:  [1.07629103e+02 3.72127853e-02]
mat_Sqrt:  [[ 2.07623165e+01  0.00000000e+00]
 [-7.71624627e-03  1.76801413e-02]]
grads:  [-1.30665476e-02 -1.36554388e+01]
Stock Position:  -0.013066547560590374
Bond Position:  [1.78157784]


portfolio before change:  [0.3995525]
curr_Stock_Price:  105.78525368414937
curr_Factors:  [1.05785254e+02 3.89941978e-02]
mat_Sqrt:  [[ 2.08893596e+01  0.00000000e+00]
 [-7.89877943e-03  1.80983773e-02]]
grads:  [ 4.48932584e-03 -8.26770505e+00]
Stock Position:  0.004489325837765868
Bond Position:  [-0.07535197]


portfolio before change:  [0.39583516]
curr_Stock_Price:  104.95931015191941
curr_Factors:  [1.04959310e+02 3.83906868e-02]
mat_Sqrt:  [[ 2.05652460e+01  0.00000000e+00]
 [-7.83741659e-03  1.79577774e-02]]
grads:  [-3.83632835e-03  1.15690861e+01]
Stock Position:  -0.003836328351075195
Bond Position:  [0.79849353]


portfolio before change:  [0.40249668]
curr_Stock_Price:  103.24889668720647
curr_Factors:  [1.03248897e+02 3.83504193e-02]
mat_Sqrt:  [[ 2.02195031e+01  0.00000000e+00]
 [-7.83330524e-03  1.79483571e-02]]
grads:  [-3.40588731e-03  6.65413252e+00]
Stock Position:  -0.0034058873102851203
Bond Position:  [0.75415079]


portfolio before change:  [0.40256499]
curr_Stock_Price:  103.25652096196677
curr_Factors:  [1.03256521e+02 3.87349542e-02]
mat_Sqrt:  [[ 2.03221200e+01  0.00000000e+00]
 [-7.87247907e-03  1.80381156e-02]]
grads:  [-5.49394877e-04  6.39457029e+00]
Stock Position:  -0.0005493948772884359
Bond Position:  [0.45929359]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.40194616]
Stock Price:  104.4874025436089
PL:  [-4.08545638]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.29658151e-01  1.01026362e-01]
 [-1.64923626e-01 -8.60454145e-02]
 [ 8.23289613e-01 -7.08797906e-01]
 [-4.03107993e-02  1.07186428e-01]
 [ 2.87022176e-02 -8.12697543e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-1.17413675e-02  2.76585376e-01]
 [ 1.53221120e-01 -2.34411617e-02]
 [ 1.37564605e-01  7.91848611e-02]
 [ 3.07191502e-01 -1.41954733e-01]
 [ 7.39731628e-02  3.51174097e-02]
 [-5.89177263e-02  6.44777910e-02]
 [ 2.57787168e-02  9.16408530e-02]
 [-4.79077827e-01 -6.18189085e-01]
 [ 5.68022336e-02  1.33863749e-01]
 [ 6.15425600e-02 -3.91726526e-02]
 [-5.31833732e-02  2.82617713e-01]
 [-4.58218515e-02  1.26586108e-01]
 [ 1.47616558e-02  6.92719106e-02]
 [-9.10857575e-02 -3.85354164e-02]
 [ 2.25536316e-01  2.86104815e-01]
 [ 3.71424185e-02  4.00380693e-02]
 [-7.03382447e-03  1.48004748e-01]
 [ 4.25106712e-02  1.71505636e-01]
 [ 5.67852366e-02  1.21479688e-01]
 [ 7.69266838e-01 -5.49683106e-01]
 [-3.48437355e-01  4.48488739e-01]
 [ 1.05814440e-01  1.15553860e-02]
 [-2.50554791e-02 -8.33634863e-02]
 [-6.35117799e-02 -7.32186683e-02]
 [-3.28397730e-01 -9.13722849e-02]
 [-6.43895647e-02 -2.90922552e-03]
 [ 1.67933308e-01  1.66961541e-01]
 [ 2.03357420e-01  3.95920609e-02]
 [-2.06070800e-01 -2.34445365e-01]
 [ 1.84723791e-01 -7.23871495e-02]
 [-2.24542658e-01  1.67681103e-01]
 [-1.12855387e-01  1.24917983e-01]
 [-2.95586995e-01  1.70265911e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.33776136]
curr_Stock_Price:  99.39067369440907
curr_Factors:  [9.93906737e+01 3.96714507e-02]
mat_Sqrt:  [[ 1.97963296e+01  0.00000000e+00]
 [-7.96707733e-03  1.82548675e-02]]
grads:  [-4.32234831e-03  5.53421501e+00]
Stock Position:  -0.004322348308208338
Bond Position:  [-0.90816025]


portfolio before change:  [-1.33692569]
curr_Stock_Price:  99.17107228424408
curr_Factors:  [9.91710723e+01 3.93630919e-02]
mat_Sqrt:  [[ 1.96756737e+01  0.00000000e+00]
 [-7.93605362e-03  1.81837832e-02]]
grads:  [-0.01029072 -4.73198638]
Stock Position:  -0.01029072380428136
Bond Position:  [-0.31638358]


portfolio before change:  [-1.33959929]
curr_Stock_Price:  99.42703584261318
curr_Factors:  [9.94270358e+01 3.98267261e-02]
mat_Sqrt:  [[ 1.98422901e+01  0.00000000e+00]
 [-7.98265381e-03  1.82905577e-02]]
grads:  [ 2.59014883e-02 -3.87521211e+01]
Stock Position:  0.025901488280015306
Bond Position:  [-3.91490749]


portfolio before change:  [-1.35657344]
curr_Stock_Price:  98.7905953453821
curr_Factors:  [9.87905953e+01 4.01610070e-02]
mat_Sqrt:  [[ 1.97978441e+01  0.00000000e+00]
 [-8.01608453e-03  1.83671571e-02]]
grads:  [3.26762506e-04 5.83576586e+00]
Stock Position:  0.0003267625063297396
Bond Position:  [-1.3888545]


portfolio before change:  [-1.35665691]
curr_Stock_Price:  99.06648276623245
curr_Factors:  [9.90664828e+01 4.13976349e-02]
mat_Sqrt:  [[ 2.01564715e+01  0.00000000e+00]
 [-8.13856350e-03  1.86477916e-02]]
grads:  [ 0.001248   -0.43581436]
Stock Position:  0.001248001897823672
Bond Position:  [-1.48029207]


portfolio before change:  [-1.35680776]
curr_Stock_Price:  99.09388598794618
curr_Factors:  [9.9093886e+01 4.0948009e-02]
mat_Sqrt:  [[ 2.00522567e+01  0.00000000e+00]
 [-8.09424576e-03  1.85462469e-02]]
grads:  [-0.00590561 -3.57576   ]
Stock Position:  -0.005905608215560219
Bond Position:  [-0.77159809]


portfolio before change:  [-1.36200643]
curr_Stock_Price:  99.95784760952887
curr_Factors:  [9.99578476e+01 3.84477613e-02]
mat_Sqrt:  [[ 1.95998354e+01  0.00000000e+00]
 [-7.84324028e-03  1.79711211e-02]]
grads:  [5.55976030e-03 1.53905465e+01]
Stock Position:  0.00555976029530158
Bond Position:  [-1.9177481]


portfolio before change:  [-1.36057617]
curr_Stock_Price:  100.25821959888046
curr_Factors:  [1.00258220e+02 3.77540758e-02]
mat_Sqrt:  [[ 1.94805812e+01  0.00000000e+00]
 [-7.77216323e-03  1.78082632e-02]]
grads:  [ 0.00734016 -1.31630814]
Stock Position:  0.007340158741192418
Bond Position:  [-2.09648742]


portfolio before change:  [-1.35692731]
curr_Stock_Price:  100.79103281497967
curr_Factors:  [1.00791033e+02 3.74675145e-02]
mat_Sqrt:  [[ 1.95096437e+01  0.00000000e+00]
 [-7.74261088e-03  1.77405502e-02]]
grads:  [0.00882249 4.46349522]
Stock Position:  0.008822493875690323
Bond Position:  [-2.24615558]


portfolio before change:  [-1.35642062]
curr_Stock_Price:  100.880291397559
curr_Factors:  [1.00880291e+02 3.65560363e-02]
mat_Sqrt:  [[ 1.92879414e+01  0.00000000e+00]
 [-7.64785317e-03  1.75234330e-02]]
grads:  [ 0.01271454 -8.10085175]
Stock Position:  0.012714543879704686
Bond Position:  [-2.63906751]


portfolio before change:  [-1.36066517]
curr_Stock_Price:  100.57240365920035
curr_Factors:  [1.00572404e+02 3.60022074e-02]
mat_Sqrt:  [[ 1.90828569e+01  0.00000000e+00]
 [-7.58969906e-03  1.73901852e-02]]
grads:  [0.00467957 2.019381  ]
Stock Position:  0.004679574824005921
Bond Position:  [-1.83130126]


portfolio before change:  [-1.3654595]
curr_Stock_Price:  99.59680164526999
curr_Factors:  [9.95968016e+01 3.61874597e-02]
mat_Sqrt:  [[ 1.89463014e+01  0.00000000e+00]
 [-7.60920072e-03  1.74348691e-02]]
grads:  [-1.62444958e-03  3.69820906e+00]
Stock Position:  -0.0016244495757292005
Bond Position:  [-1.20366952]


portfolio before change:  [-1.36584388]
curr_Stock_Price:  99.74079253544086
curr_Factors:  [9.97407925e+01 3.75205011e-02]
mat_Sqrt:  [[ 1.93200003e+01  0.00000000e+00]
 [-7.74808374e-03  1.77530901e-02]]
grads:  [3.40445460e-03 5.16196631e+00]
Stock Position:  0.0034044546026299064
Bond Position:  [-1.70540688]


portfolio before change:  [-1.36077543]
curr_Stock_Price:  101.29218181298373
curr_Factors:  [1.01292182e+02 3.70183383e-02]
mat_Sqrt:  [[ 1.94887680e+01  0.00000000e+00]
 [-7.69606012e-03  1.76338890e-02]]
grads:  [ -0.03842612 -35.05687737]
Stock Position:  -0.03842611611324658
Bond Position:  [2.53148971]


portfolio before change:  [-1.39982622]
curr_Stock_Price:  102.3166736014096
curr_Factors:  [1.02316674e+02 3.81847225e-02]
mat_Sqrt:  [[ 1.99936107e+01  0.00000000e+00]
 [-7.81636463e-03  1.79095413e-02]]
grads:  [5.76309928e-03 7.47443764e+00]
Stock Position:  0.0057630992832612415
Bond Position:  [-1.98948736]


portfolio before change:  [-1.39724974]
curr_Stock_Price:  102.80689198558886
curr_Factors:  [1.02806892e+02 3.90563145e-02]
mat_Sqrt:  [[ 2.03173873e+01  0.00000000e+00]
 [-7.90506819e-03  1.81127867e-02]]
grads:  [ 0.00218759 -2.16270711]
Stock Position:  0.0021875948999333958
Bond Position:  [-1.62214957]


portfolio before change:  [-1.3971811]
curr_Stock_Price:  102.9309648272862
curr_Factors:  [1.02930965e+02 3.96837441e-02]
mat_Sqrt:  [[ 2.05046502e+01  0.00000000e+00]
 [-7.96831165e-03  1.82576956e-02]]
grads:  [3.42171695e-03 1.54793748e+01]
Stock Position:  0.003421716949247602
Bond Position:  [-1.74938173]


portfolio before change:  [-1.39752274]
curr_Stock_Price:  102.89503150539795
curr_Factors:  [1.02895032e+02 3.89332545e-02]
mat_Sqrt:  [[ 2.03027450e+01  0.00000000e+00]
 [-7.89260459e-03  1.80842290e-02]]
grads:  [4.64215809e-04 6.99980672e+00]
Stock Position:  0.00046421580920704965
Bond Position:  [-1.44528824]


portfolio before change:  [-1.39746651]
curr_Stock_Price:  103.40536041126387
curr_Factors:  [1.03405360e+02 3.99019638e-02]
mat_Sqrt:  [[ 2.06557129e+01  0.00000000e+00]
 [-7.99019037e-03  1.83078261e-02]]
grads:  [2.17830275e-03 3.78373217e+00]
Stock Position:  0.0021783027497725336
Bond Position:  [-1.62271469]


portfolio before change:  [-1.39945391]
curr_Stock_Price:  102.58612142284059
curr_Factors:  [1.02586121e+02 3.85034090e-02]
mat_Sqrt:  [[ 2.01297417e+01  0.00000000e+00]
 [-7.84891421e-03  1.79841218e-02]]
grads:  [-0.00536043 -2.14274664]
Stock Position:  -0.00536042607404024
Bond Position:  [-0.84954859]


portfolio before change:  [-1.40827185]
curr_Stock_Price:  104.21131723651973
curr_Factors:  [1.04211317e+02 3.78557264e-02]
mat_Sqrt:  [[ 2.02759251e+01  0.00000000e+00]
 [-7.78261924e-03  1.78322209e-02]]
grads:  [ 0.01728171 16.04426151]
Stock Position:  0.017281711831857477
Bond Position:  [-3.20922181]


portfolio before change:  [-1.40775028]
curr_Stock_Price:  104.26471184943455
curr_Factors:  [1.04264712e+02 3.66779630e-02]
mat_Sqrt:  [[ 1.99682475e+01  0.00000000e+00]
 [-7.66059664e-03  1.75526320e-02]]
grads:  [0.00273517 2.28102938]
Stock Position:  0.002735165638920703
Bond Position:  [-1.69293154]


portfolio before change:  [-1.410228]
curr_Stock_Price:  103.43620889382241
curr_Factors:  [1.03436209e+02 3.73825632e-02]
mat_Sqrt:  [[ 1.99989471e+01  0.00000000e+00]
 [-7.73382836e-03  1.77204269e-02]]
grads:  [2.87818868e-03 8.35221119e+00]
Stock Position:  0.0028781886802494877
Bond Position:  [-1.70793693]


portfolio before change:  [-1.41317115]
curr_Stock_Price:  102.4878191862409
curr_Factors:  [1.02487819e+02 4.02206796e-02]
mat_Sqrt:  [[ 2.05540285e+01  0.00000000e+00]
 [-8.02203761e-03  1.83807973e-02]]
grads:  [5.70992044e-03 9.33069625e+00]
Stock Position:  0.005709920440585733
Bond Position:  [-1.99836845]


portfolio before change:  [-1.40344523]
curr_Stock_Price:  104.23490748883218
curr_Factors:  [1.04234907e+02 4.11337054e-02]
mat_Sqrt:  [[ 2.11403465e+01  0.00000000e+00]
 [-8.11257843e-03  1.85882524e-02]]
grads:  [5.19401699e-03 6.53529368e+00]
Stock Position:  0.005194016991205829
Bond Position:  [-1.94484311]


portfolio before change:  [-1.40155672]
curr_Stock_Price:  104.64530973562556
curr_Factors:  [1.04645310e+02 4.13783207e-02]
mat_Sqrt:  [[ 2.12865951e+01  0.00000000e+00]
 [-8.13666474e-03  1.86434410e-02]]
grads:  [ 2.48684894e-02 -2.94839941e+01]
Stock Position:  0.024868489382081454
Bond Position:  [-4.00392749]


portfolio before change:  [-1.41499034]
curr_Stock_Price:  104.12525001927851
curr_Factors:  [1.04125250e+02 4.14177879e-02]
mat_Sqrt:  [[ 2.11909051e+01  0.00000000e+00]
 [-8.14054425e-03  1.86523301e-02]]
grads:  [-7.20596033e-03  2.40446495e+01]
Stock Position:  -0.007205960334720286
Bond Position:  [-0.66466792]


portfolio before change:  [-1.40604576]
curr_Stock_Price:  102.87244533152165
curr_Factors:  [1.02872445e+02 4.10594529e-02]
mat_Sqrt:  [[ 2.08451796e+01  0.00000000e+00]
 [-8.10525290e-03  1.85714675e-02]]
grads:  [0.00531814 0.62221179]
Stock Position:  0.005318141929717799
Bond Position:  [-1.95313603]


portfolio before change:  [-1.40488242]
curr_Stock_Price:  103.13710674657598
curr_Factors:  [1.03137107e+02 4.13209892e-02]
mat_Sqrt:  [[ 2.09652622e+01  0.00000000e+00]
 [-8.13102593e-03  1.86305209e-02]]
grads:  [-2.93048027e-03 -4.47456551e+00]
Stock Position:  -0.0029304802712554062
Bond Position:  [-1.10264116]


portfolio before change:  [-1.40477818]
curr_Stock_Price:  103.05450185405782
curr_Factors:  [1.03054502e+02 4.09991316e-02]
mat_Sqrt:  [[ 2.08667252e+01  0.00000000e+00]
 [-8.09929692e-03  1.85578206e-02]]
grads:  [-0.00457508 -3.94543464]
Stock Position:  -0.004575084279815185
Bond Position:  [-0.93329515]


portfolio before change:  [-1.40413624]
curr_Stock_Price:  102.88868917580632
curr_Factors:  [1.02888689e+02 4.09713285e-02]
mat_Sqrt:  [[ 2.08260860e+01  0.00000000e+00]
 [-8.09655023e-03  1.85515271e-02]]
grads:  [-0.01768339 -4.92532416]
Stock Position:  -0.01768339307400437
Bond Position:  [0.41528489]


portfolio before change:  [-1.4257726]
curr_Stock_Price:  104.11516609812954
curr_Factors:  [1.04115166e+02 4.07754119e-02]
mat_Sqrt:  [[ 2.10238948e+01  0.00000000e+00]
 [-8.07716900e-03  1.85071192e-02]]
grads:  [-0.00312308 -0.15719494]
Stock Position:  -0.0031230775929233824
Bond Position:  [-1.10061286]


portfolio before change:  [-1.42433492]
curr_Stock_Price:  103.61076954540592
curr_Factors:  [1.03610770e+02 4.00637064e-02]
mat_Sqrt:  [[ 2.07386490e+01  0.00000000e+00]
 [-8.00636811e-03  1.83448940e-02]]
grads:  [0.01161123 9.10125407]
Stock Position:  0.011611233584722712
Bond Position:  [-2.62738377]


portfolio before change:  [-1.42076203]
curr_Stock_Price:  103.94676554218978
curr_Factors:  [1.03946766e+02 4.03596068e-02]
mat_Sqrt:  [[ 2.08825939e+01  0.00000000e+00]
 [-8.03588022e-03  1.84125147e-02]]
grads:  [0.01056558 2.15027994]
Stock Position:  0.010565584548749117
Bond Position:  [-2.51902037]


portfolio before change:  [-1.40550813]
curr_Stock_Price:  105.42030483253286
curr_Factors:  [1.05420305e+02 4.01481223e-02]
mat_Sqrt:  [[ 2.11230626e+01  0.00000000e+00]
 [-8.01479854e-03  1.83642105e-02]]
grads:  [ -0.01459974 -12.76642766]
Stock Position:  -0.014599736355639537
Bond Position:  [0.13360053]


portfolio before change:  [-1.44636459]
curr_Stock_Price:  108.21988693813837
curr_Factors:  [1.08219887e+02 4.06510553e-02]
mat_Sqrt:  [[ 2.18194092e+01  0.00000000e+00]
 [-8.06484274e-03  1.84788762e-02]]
grads:  [ 0.00701813 -3.91729177]
Stock Position:  0.007018129944911123
Bond Position:  [-2.20586582]


portfolio before change:  [-1.4514337]
curr_Stock_Price:  107.53688996085407
curr_Factors:  [1.07536890e+02 4.20974548e-02]
mat_Sqrt:  [[ 2.20640581e+01  0.00000000e+00]
 [-8.20706572e-03  1.88047499e-02]]
grads:  [-6.86005377e-03  8.91695467e+00]
Stock Position:  -0.006860053774481031
Bond Position:  [-0.71372485]


portfolio before change:  [-1.46860627]
curr_Stock_Price:  110.02715404508596
curr_Factors:  [1.10027154e+02 4.27116323e-02]
mat_Sqrt:  [[ 2.27390839e+01  0.00000000e+00]
 [-8.26671711e-03  1.89414284e-02]]
grads:  [-2.56548197e-03  6.59496108e+00]
Stock Position:  -0.0025654819659400568
Bond Position:  [-1.18633359]


portfolio before change:  [-1.46973988]
curr_Stock_Price:  110.41122010098597
curr_Factors:  [1.10411220e+02 4.09210285e-02]
mat_Sqrt:  [[ 2.23350269e+01  0.00000000e+00]
 [-8.09157869e-03  1.85401359e-02]]
grads:  [-0.00990717  9.18363875]
Stock Position:  -0.009907167823644454
Bond Position:  [-0.37587739]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.48090327]
Stock Price:  111.53327681299153
PL:  [-13.01418009]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.22280430e-01 -1.23494064e-01]
 [-1.74394783e-01 -8.44041973e-02]
 [ 9.04494500e-01 -8.93175216e-01]
 [-2.86261361e-03  2.82405293e-01]
 [ 2.16971581e-02 -8.77516528e-02]
 [-8.03671305e-02 -1.03490024e-01]
 [-7.50078227e-02  1.60168402e-01]
 [-1.08668505e-01 -1.00700747e-01]
 [ 1.64178563e-01  8.24358792e-02]
 [ 2.10500372e-01 -5.45999785e-02]
 [ 1.22232148e-01  2.06253082e-01]
 [ 1.12935343e-01  1.93861547e-01]
 [ 2.09920966e-01  2.40660221e-02]
 [-1.67376997e-01 -1.90244098e-01]
 [ 9.07592891e-02  2.33893463e-01]
 [ 4.25701039e-02  1.01114448e-01]
 [ 7.43224768e-02  1.50559002e-01]
 [ 9.13326971e-02  6.59755124e-02]
 [ 1.06009735e-02  3.75409698e-02]
 [ 2.31675545e-01 -1.08218302e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 2.50686391e-02  2.14311361e-01]
 [ 1.15044051e-02  6.68210728e-02]
 [-3.12317682e-02  7.23006770e-04]
 [ 5.06800202e-02  1.34218694e-01]
 [ 4.57381430e-02  1.60845004e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.64526562e-01  1.02969074e-01]
 [-2.73672295e-01  2.87347839e-04]
 [ 1.73266212e-01 -8.68194944e-02]
 [-1.17619754e+00 -1.31802190e-01]
 [-3.84685331e-02  1.70285247e-01]
 [-9.09136103e-03 -1.20421093e-01]
 [ 3.38063667e-02  8.50948204e-02]
 [-5.75748841e-02  1.61792769e-01]
 [-1.13435302e+00 -1.86571448e-01]
 [-4.35807908e-02  2.76712286e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.04525320e+00 -2.15807463e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.53771079]
curr_Stock_Price:  98.75809333233717
curr_Factors:  [9.87580933e+01 4.07146963e-02]
mat_Sqrt:  [[ 1.99272925e+01  0.00000000e+00]
 [-8.07115321e-03  1.84933353e-02]]
grads:  [-0.01887751 -6.67776053]
Stock Position:  -0.018877509726919168
Bond Position:  [-3.67340392]


portfolio before change:  [-5.50326136]
curr_Stock_Price:  96.90887560967548
curr_Factors:  [9.69088756e+01 4.17150649e-02]
mat_Sqrt:  [[ 1.97929267e+01  0.00000000e+00]
 [-8.16970647e-03  1.87191492e-02]]
grads:  [-0.01067208 -4.50897616]
Stock Position:  -0.010672084945549849
Bond Position:  [-4.46904161]


portfolio before change:  [-5.49960835]
curr_Stock_Price:  96.51423133088814
curr_Factors:  [9.65142313e+01 4.20301154e-02]
mat_Sqrt:  [[ 1.97866216e+01  0.00000000e+00]
 [-8.20049905e-03  1.87897038e-02]]
grads:  [ 2.60115591e-02 -4.75353537e+01]
Stock Position:  0.026011559137690224
Bond Position:  [-8.01009399]


portfolio before change:  [-5.50874449]
curr_Stock_Price:  96.20149284612855
curr_Factors:  [9.62014928e+01 4.18004081e-02]
mat_Sqrt:  [[ 1.96685377e+01  0.00000000e+00]
 [-8.17805924e-03  1.87382877e-02]]
grads:  [6.12090043e-03 1.50710298e+01]
Stock Position:  0.006120900428633821
Bond Position:  [-6.09758425]


portfolio before change:  [-5.50432188]
curr_Stock_Price:  97.04856764883229
curr_Factors:  [9.70485676e+01 4.01643273e-02]
mat_Sqrt:  [[ 1.94495420e+01  0.00000000e+00]
 [-8.01641589e-03  1.83679163e-02]]
grads:  [-8.53531821e-04 -4.77744189e+00]
Stock Position:  -0.0008535318205989113
Bond Position:  [-5.42148784]


portfolio before change:  [-5.50552426]
curr_Stock_Price:  97.66325691622451
curr_Factors:  [9.76632569e+01 3.98085301e-02]
mat_Sqrt:  [[ 1.94858464e+01  0.00000000e+00]
 [-7.98083004e-03  1.82863789e-02]]
grads:  [-0.00644231 -5.65940498]
Stock Position:  -0.0064423108652145785
Bond Position:  [-4.8763472]


portfolio before change:  [-5.50868828]
curr_Stock_Price:  98.0597656891458
curr_Factors:  [9.80597657e+01 3.92306924e-02]
mat_Sqrt:  [[ 1.94224422e+01  0.00000000e+00]
 [-7.92269574e-03  1.81531765e-02]]
grads:  [-2.62819732e-04  8.82316120e+00]
Stock Position:  -0.0002628197324973051
Bond Position:  [-5.48291624]


portfolio before change:  [-5.5093685]
curr_Stock_Price:  98.04004652049116
curr_Factors:  [9.80400465e+01 3.82830645e-02]
mat_Sqrt:  [[ 1.91825728e+01  0.00000000e+00]
 [-7.82642340e-03  1.79325888e-02]]
grads:  [-0.00795607 -5.6155164 ]
Stock Position:  -0.007956071122941503
Bond Position:  [-4.72935492]


portfolio before change:  [-5.51642026]
curr_Stock_Price:  98.85207429394002
curr_Factors:  [9.88520743e+01 3.80724897e-02]
mat_Sqrt:  [[ 1.92881878e+01  0.00000000e+00]
 [-7.80486922e-03  1.78832020e-02]]
grads:  [0.01037716 4.60968227]
Stock Position:  0.010377155808598153
Bond Position:  [-6.54222364]


portfolio before change:  [-5.51426566]
curr_Stock_Price:  99.13851385883109
curr_Factors:  [9.91385139e+01 3.80357531e-02]
mat_Sqrt:  [[ 1.93347435e+01  0.00000000e+00]
 [-7.80110280e-03  1.78745721e-02]]
grads:  [ 0.00965469 -3.05461738]
Stock Position:  0.009654691718563842
Bond Position:  [-6.47141745]


portfolio before change:  [-5.52138891]
curr_Stock_Price:  98.48450328468185
curr_Factors:  [9.84845033e+01 3.85551579e-02]
mat_Sqrt:  [[ 1.93378925e+01  0.00000000e+00]
 [-7.85418695e-03  1.79962031e-02]]
grads:  [1.09757758e-02 1.14609221e+01]
Stock Position:  0.010975775806104121
Bond Position:  [-6.60233274]


portfolio before change:  [-5.52498982]
curr_Stock_Price:  98.23162162238756
curr_Factors:  [9.82316216e+01 3.75140452e-02]
mat_Sqrt:  [[ 1.90260337e+01  0.00000000e+00]
 [-7.74741714e-03  1.77515627e-02]]
grads:  [1.03827977e-02 1.09208158e+01]
Stock Position:  0.010382797688522323
Bond Position:  [-6.54490888]


portfolio before change:  [-5.5404948]
curr_Stock_Price:  96.81708839535295
curr_Factors:  [9.68170884e+01 3.82102992e-02]
mat_Sqrt:  [[ 1.89252767e+01  0.00000000e+00]
 [-7.81898195e-03  1.79155383e-02]]
grads:  [0.01164708 1.34330443]
Stock Position:  0.011647081468507417
Bond Position:  [-6.66813132]


portfolio before change:  [-5.53833107]
curr_Stock_Price:  97.07443196080521
curr_Factors:  [9.70744320e+01 3.80515981e-02]
mat_Sqrt:  [[ 1.89361336e+01  0.00000000e+00]
 [-7.80272754e-03  1.78782948e-02]]
grads:  [ -0.01322373 -10.64106504]
Stock Position:  -0.013223730565215806
Bond Position:  [-4.25464494]


portfolio before change:  [-5.53753091]
curr_Stock_Price:  96.97370205051865
curr_Factors:  [9.69737021e+01 3.87241505e-02]
mat_Sqrt:  [[ 1.90829242e+01  0.00000000e+00]
 [-7.87138112e-03  1.80355999e-02]]
grads:  [1.01053048e-02 1.29684326e+01]
Stock Position:  0.010105304773819141
Bond Position:  [-6.51747972]


portfolio before change:  [-5.55051322]
curr_Stock_Price:  95.76962343045321
curr_Factors:  [9.57696234e+01 3.94402227e-02]
mat_Sqrt:  [[ 1.90194283e+01  0.00000000e+00]
 [-7.94382505e-03  1.82015898e-02]]
grads:  [4.55850016e-03 5.55525365e+00]
Stock Position:  0.00455850015514915
Bond Position:  [-5.98707907]


portfolio before change:  [-5.55239559]
curr_Stock_Price:  95.52087142627829
curr_Factors:  [9.55208714e+01 3.93032512e-02]
mat_Sqrt:  [[ 1.89370582e+01  0.00000000e+00]
 [-7.93001904e-03  1.81699562e-02]]
grads:  [7.39459163e-03 8.28615104e+00]
Stock Position:  0.0073945916323916025
Bond Position:  [-6.25873343]


portfolio before change:  [-5.55366798]
curr_Stock_Price:  95.45460697536716
curr_Factors:  [9.54546070e+01 3.87543735e-02]
mat_Sqrt:  [[ 1.87913185e+01  0.00000000e+00]
 [-7.87445221e-03  1.80426367e-02]]
grads:  [0.00639267 3.65664474]
Stock Position:  0.006392673892809566
Bond Position:  [-6.16387815]


portfolio before change:  [-5.54995315]
curr_Stock_Price:  96.15624855172554
curr_Factors:  [9.61562486e+01 3.75490502e-02]
mat_Sqrt:  [[ 1.86327514e+01  0.00000000e+00]
 [-7.75103092e-03  1.77598429e-02]]
grads:  [1.44826684e-03 2.11381204e+00]
Stock Position:  0.0014482668382026708
Bond Position:  [-5.68921305]


portfolio before change:  [-5.55061748]
curr_Stock_Price:  96.18860687300302
curr_Factors:  [9.61886069e+01 3.64447206e-02]
mat_Sqrt:  [[ 1.83628864e+01  0.00000000e+00]
 [-7.63620016e-03  1.74967326e-02]]
grads:  [ 0.01004446 -6.18505779]
Stock Position:  0.010044456082892816
Bond Position:  [-6.51677972]


portfolio before change:  [-5.54366606]
curr_Stock_Price:  96.96177645259304
curr_Factors:  [9.69617765e+01 3.57222458e-02]
mat_Sqrt:  [[ 1.83260953e+01  0.00000000e+00]
 [-7.56013183e-03  1.73224382e-02]]
grads:  [ 0.00229883 -2.18087022]
Stock Position:  0.002298831797560211
Bond Position:  [-5.76656488]


portfolio before change:  [-5.54475844]
curr_Stock_Price:  96.80016670970498
curr_Factors:  [9.68001667e+01 3.57405213e-02]
mat_Sqrt:  [[ 1.83002299e+01  0.00000000e+00]
 [-7.56206546e-03  1.73268687e-02]]
grads:  [6.48089043e-03 1.23687300e+01]
Stock Position:  0.006480890432785678
Bond Position:  [-6.17210971]


portfolio before change:  [-5.55609008]
curr_Stock_Price:  95.17074832108689
curr_Factors:  [9.51707483e+01 3.63821481e-02]
mat_Sqrt:  [[ 1.81529684e+01  0.00000000e+00]
 [-7.62964199e-03  1.74817060e-02]]
grads:  [2.24026788e-03 3.82234279e+00]
Stock Position:  0.0022402678794517282
Bond Position:  [-5.76929806]


portfolio before change:  [-5.55722363]
curr_Stock_Price:  94.9866885664125
curr_Factors:  [9.49866886e+01 3.59255187e-02]
mat_Sqrt:  [[ 1.80038038e+01  0.00000000e+00]
 [-7.58161130e-03  1.73716538e-02]]
grads:  [-0.00171721  0.04161992]
Stock Position:  -0.001717205014374714
Bond Position:  [-5.39411202]


portfolio before change:  [-5.55863836]
curr_Stock_Price:  95.41786470646707
curr_Factors:  [9.54178647e+01 3.32489296e-02]
mat_Sqrt:  [[ 1.73987692e+01  0.00000000e+00]
 [-7.29371560e-03  1.67120019e-02]]
grads:  [6.27963157e-03 8.03127562e+00]
Stock Position:  0.006279631573111738
Bond Position:  [-6.15782739]


portfolio before change:  [-5.56434313]
curr_Stock_Price:  94.63199191887333
curr_Factors:  [9.46319919e+01 3.37631983e-02]
mat_Sqrt:  [[ 1.73884060e+01  0.00000000e+00]
 [-7.34990594e-03  1.68407502e-02]]
grads:  [6.66746901e-03 9.55094060e+00]
Stock Position:  0.006667469009921852
Bond Position:  [-6.195299]


portfolio before change:  [-5.56043515]
curr_Stock_Price:  95.33427359866825
curr_Factors:  [9.53342736e+01 3.30083750e-02]
mat_Sqrt:  [[ 1.73205283e+01  0.00000000e+00]
 [-7.26728285e-03  1.66514369e-02]]
grads:  [1.02861528e-02 1.05058438e+01]
Stock Position:  0.010286152792751366
Bond Position:  [-6.54105805]


portfolio before change:  [-5.5670163]
curr_Stock_Price:  94.77396007541913
curr_Factors:  [9.47739601e+01 3.35628628e-02]
mat_Sqrt:  [[ 1.73627506e+01  0.00000000e+00]
 [-7.32806800e-03  1.67907131e-02]]
grads:  [-0.00688757  6.13250154]
Stock Position:  -0.006887570798739631
Bond Position:  [-4.91425394]


portfolio before change:  [-5.57062123]
curr_Stock_Price:  95.20816411435241
curr_Factors:  [9.52081641e+01 3.34053879e-02]
mat_Sqrt:  [[ 1.74013303e+01  0.00000000e+00]
 [-7.31085636e-03  1.67512763e-02]]
grads:  [-0.01571988  0.01715379]
Stock Position:  -0.015719883582464157
Bond Position:  [-4.07395998]


portfolio before change:  [-5.57608732]
curr_Stock_Price:  95.52348522472613
curr_Factors:  [9.55234852e+01 3.20961725e-02]
mat_Sqrt:  [[ 1.71134190e+01  0.00000000e+00]
 [-7.16616188e-03  1.64197396e-02]]
grads:  [ 0.00791046 -5.28750738]
Stock Position:  0.007910463638391093
Bond Position:  [-6.33172238]


portfolio before change:  [-5.58193134]
curr_Stock_Price:  94.88477415111089
curr_Factors:  [9.48847742e+01 3.17760128e-02]
mat_Sqrt:  [[ 1.69139962e+01  0.00000000e+00]
 [-7.13033102e-03  1.63376408e-02]]
grads:  [-0.07294082 -8.06739426]
Stock Position:  -0.07294081853354047
Bond Position:  [1.33904176]


portfolio before change:  [-5.62200564]
curr_Stock_Price:  95.43647753468612
curr_Factors:  [9.54364775e+01 3.15571358e-02]
mat_Sqrt:  [[ 1.69536491e+01  0.00000000e+00]
 [-7.10573130e-03  1.62812758e-02]]
grads:  [2.11459145e-03 1.04589621e+01]
Stock Position:  0.0021145914491485797
Bond Position:  [-5.8238148]


portfolio before change:  [-5.62200008]
curr_Stock_Price:  95.78339029836609
curr_Factors:  [9.57833903e+01 3.13491040e-02]
mat_Sqrt:  [[ 1.69590988e+01  0.00000000e+00]
 [-7.08227127e-03  1.62275221e-02]]
grads:  [-3.63506547e-03 -7.42079364e+00]
Stock Position:  -0.0036350654726562794
Bond Position:  [-5.27382119]


portfolio before change:  [-5.62154258]
curr_Stock_Price:  95.47616704305867
curr_Factors:  [9.5476167e+01 3.2232488e-02]
mat_Sqrt:  [[ 1.71412264e+01  0.00000000e+00]
 [-7.18136343e-03  1.64545708e-02]]
grads:  [4.13883987e-03 5.17150047e+00]
Stock Position:  0.00413883986996017
Bond Position:  [-6.01670314]


portfolio before change:  [-5.62195823]
curr_Stock_Price:  95.5574647297821
curr_Factors:  [9.55574647e+01 3.09651451e-02]
mat_Sqrt:  [[ 1.68151667e+01  0.00000000e+00]
 [-7.03876638e-03  1.61278399e-02]]
grads:  [7.75327979e-04 1.00318933e+01]
Stock Position:  0.0007753279794506269
Bond Position:  [-5.69604661]


portfolio before change:  [-5.62216921]
curr_Stock_Price:  96.20374241397954
curr_Factors:  [9.62037424e+01 3.24603836e-02]
mat_Sqrt:  [[ 1.73328026e+01  0.00000000e+00]
 [-7.20670617e-03  1.65126383e-02]]
grads:  [ -0.07014327 -11.29870619]
Stock Position:  -0.07014327159585783
Bond Position:  [1.12587603]


portfolio before change:  [-5.62197965]
curr_Stock_Price:  96.20304651172216
curr_Factors:  [9.62030465e+01 3.32399928e-02]
mat_Sqrt:  [[ 1.75395839e+01  0.00000000e+00]
 [-7.29273533e-03  1.67097558e-02]]
grads:  [4.40069458e-03 1.65599240e+01]
Stock Position:  0.004400694580639946
Bond Position:  [-6.04533988]


portfolio before change:  [-5.62454852]
curr_Stock_Price:  95.79103178196769
curr_Factors:  [9.57910318e+01 3.29963493e-02]
mat_Sqrt:  [[ 1.74003425e+01  0.00000000e+00]
 [-7.26595891e-03  1.66484033e-02]]
grads:  [-5.06801606e-03  6.56890406e+00]
Stock Position:  -0.005068016059984201
Bond Position:  [-5.13907803]


portfolio before change:  [-5.6211657]
curr_Stock_Price:  94.99678877509443
curr_Factors:  [9.49967888e+01 3.31278368e-02]
mat_Sqrt:  [[ 1.72904168e+01  0.00000000e+00]
 [-7.28042161e-03  1.66815416e-02]]
grads:  [ 0.05990802 -1.29369017]
Stock Position:  0.05990801714406938
Bond Position:  [-11.31223496]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.7123418]
Stock Price:  93.49845872549322
PL:  [-5.7123418]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.30303784e-02  2.76428971e-01]
 [-1.64629918e-01 -8.76928725e-02]
 [ 8.35896675e-01 -7.35542385e-01]
 [-3.49361208e-02  1.32334377e-01]
 [ 2.53603135e-02 -6.78951247e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-3.17583074e-02  2.21776170e-01]
 [-9.84536821e-02 -1.04140083e-01]
 [ 1.65573922e-01  1.14838795e-01]
 [ 1.72927072e-01 -1.19397294e-02]
 [ 7.20166603e-02  2.81997588e-02]
 [-8.47475386e-02 -1.72868359e-01]
 [-1.85029217e-01  1.61431907e-01]
 [-7.75047744e-01 -1.12339964e+00]
 [-1.37098552e-01 -7.34744807e-01]
 [-5.78550017e-02 -2.30690708e-01]
 [-4.99197997e-02  9.91616803e-02]
 [ 1.33716007e-01  1.57163358e-01]
 [ 1.78120138e-02 -6.46893922e-03]
 [-1.16492365e-01 -2.42559398e-02]
 [ 1.80856734e-01  5.47239949e-01]
 [-1.56402688e-02  2.66739107e-01]
 [-7.87205391e-03 -4.08750165e-01]
 [ 2.03708384e-01  2.26189889e-01]
 [ 1.27332409e-01  2.54733729e-01]
 [ 8.96328424e-01 -1.12489114e+00]
 [-1.25849430e+00  1.44953491e+00]
 [ 2.85262213e-02 -2.08366738e-02]
 [-6.58593093e-02 -4.24129412e-02]
 [ 2.21636613e-01  1.22854321e-01]
 [-5.04322686e-01 -2.52821210e-01]
 [ 3.79541842e-01 -4.97376708e-02]
 [ 5.26130672e-01  7.63866452e-01]
 [ 3.56019644e-01 -3.87303984e-02]
 [-8.76858202e-02 -4.17816887e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-4.35510129e-01  1.40315761e-02]
 [-1.06162952e-01  5.75440909e-02]
 [-3.87841752e-01  1.84048501e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.01495708]
curr_Stock_Price:  99.89564735565274
curr_Factors:  [9.98956474e+01 3.99965080e-02]
mat_Sqrt:  [[ 1.99782574e+01  0.00000000e+00]
 [-7.99965080e-03  1.83295027e-02]]
grads:  [6.69096758e-03 1.50810950e+01]
Stock Position:  0.006690967576930735
Bond Position:  [1.34655854]


portfolio before change:  [2.00886428]
curr_Stock_Price:  98.95988880294914
curr_Factors:  [9.89598888e+01 3.96086857e-02]
mat_Sqrt:  [[ 1.96949288e+01  0.00000000e+00]
 [-7.96077239e-03  1.82404210e-02]]
grads:  [-0.01030226 -4.8076123 ]
Stock Position:  -0.010302257406627727
Bond Position:  [3.02837452]


portfolio before change:  [2.00888842]
curr_Stock_Price:  98.99429195110588
curr_Factors:  [9.89942920e+01 3.94025767e-02]
mat_Sqrt:  [[ 1.96504484e+01  0.00000000e+00]
 [-7.94003291e-03  1.81929009e-02]]
grads:  [ 2.62019293e-02 -4.04301869e+01]
Stock Position:  0.02620192931972054
Bond Position:  [-0.58495302]


portfolio before change:  [1.99376943]
curr_Stock_Price:  98.42006442842337
curr_Factors:  [9.84200644e+01 3.96068423e-02]
mat_Sqrt:  [[ 1.95870375e+01  0.00000000e+00]
 [-7.96058714e-03  1.82399966e-02]]
grads:  [1.16502235e-03 7.25517555e+00]
Stock Position:  0.0011650223490597086
Bond Position:  [1.87910785]


portfolio before change:  [1.99492369]
curr_Stock_Price:  99.20920439655356
curr_Factors:  [9.92092044e+01 3.98149470e-02]
mat_Sqrt:  [[ 1.97958903e+01  0.00000000e+00]
 [-7.98147325e-03  1.82878527e-02]]
grads:  [ 0.0011314  -0.37125805]
Stock Position:  0.001131402882966411
Bond Position:  [1.88267811]


portfolio before change:  [1.99503394]
curr_Stock_Price:  99.09862778978008
curr_Factors:  [9.90986278e+01 3.82925362e-02]
mat_Sqrt:  [[ 1.93920940e+01  0.00000000e+00]
 [-7.82739152e-03  1.79348071e-02]]
grads:  [-0.00610665 -3.6976661 ]
Stock Position:  -0.006106652119081717
Bond Position:  [2.60019478]


portfolio before change:  [1.99393838]
curr_Stock_Price:  99.33125966751979
curr_Factors:  [9.93312597e+01 3.91505174e-02]
mat_Sqrt:  [[ 1.96541695e+01  0.00000000e+00]
 [-7.91459588e-03  1.81346174e-02]]
grads:  [3.30885254e-03 1.22294375e+01]
Stock Position:  0.0033088525420933404
Bond Position:  [1.66526589]


portfolio before change:  [1.98927354]
curr_Stock_Price:  97.85853962429825
curr_Factors:  [9.78585396e+01 4.05629915e-02]
mat_Sqrt:  [[ 1.97089605e+01  0.00000000e+00]
 [-8.05610244e-03  1.84588496e-02]]
grads:  [-0.00730146 -5.64174284]
Stock Position:  -0.007301457651051645
Bond Position:  [2.70378352]


portfolio before change:  [1.99635311]
curr_Stock_Price:  96.93521997919011
curr_Factors:  [9.6935220e+01 4.1160484e-02]
mat_Sqrt:  [[ 1.96662627e+01  0.00000000e+00]
 [-8.11521869e-03  1.85943020e-02]]
grads:  [0.0109677  6.17602079]
Stock Position:  0.01096770057834817
Bond Position:  [0.93319664]


portfolio before change:  [2.0162828]
curr_Stock_Price:  98.74170877022829
curr_Factors:  [9.87417088e+01 4.09808561e-02]
mat_Sqrt:  [[ 1.99890039e+01  0.00000000e+00]
 [-8.09749157e-03  1.85536840e-02]]
grads:  [ 0.00839042 -0.64352338]
Stock Position:  0.00839042044916797
Bond Position:  [1.18779834]


portfolio before change:  [2.03254302]
curr_Stock_Price:  100.66196271315145
curr_Factors:  [1.00661963e+02 3.94402215e-02]
mat_Sqrt:  [[ 1.99910252e+01  0.00000000e+00]
 [-7.94382492e-03  1.82015895e-02]]
grads:  [0.0042181  1.54930199]
Stock Position:  0.004218095029606027
Bond Position:  [1.60794129]


portfolio before change:  [2.04437445]
curr_Stock_Price:  103.41923345924955
curr_Factors:  [1.03419233e+02 3.82787618e-02]
mat_Sqrt:  [[ 2.02339306e+01  0.00000000e+00]
 [-7.82598358e-03  1.79315811e-02]]
grads:  [-7.91707153e-03 -9.64044153e+00]
Stock Position:  -0.00791707153282138
Bond Position:  [2.86315192]


portfolio before change:  [2.04420514]
curr_Stock_Price:  103.48582729744378
curr_Factors:  [1.03485827e+02 3.68634973e-02]
mat_Sqrt:  [[ 1.98691434e+01  0.00000000e+00]
 [-7.67994764e-03  1.75969707e-02]]
grads:  [-5.76645678e-03  9.17384643e+00]
Stock Position:  -0.005766456781518784
Bond Position:  [2.64095169]


portfolio before change:  [2.03397273]
curr_Stock_Price:  105.31754983414048
curr_Factors:  [1.05317550e+02 3.79097328e-02]
mat_Sqrt:  [[ 2.05057713e+01  0.00000000e+00]
 [-7.78816875e-03  1.78449364e-02]]
grads:  [-6.17065083e-02 -6.29534125e+01]
Stock Position:  -0.06170650827059189
Bond Position:  [8.53275099]


portfolio before change:  [1.91922578]
curr_Stock_Price:  107.19439582733756
curr_Factors:  [1.07194396e+02 3.76425394e-02]
mat_Sqrt:  [[ 2.07975194e+01  0.00000000e+00]
 [-7.76067414e-03  1.77819383e-02]]
grads:  [-2.20106767e-02 -4.13197253e+01]
Stock Position:  -0.02201067668327775
Bond Position:  [4.27864697]


portfolio before change:  [1.92768913]
curr_Stock_Price:  106.83418505038901
curr_Factors:  [1.06834185e+02 3.67380389e-02]
mat_Sqrt:  [[ 2.04770894e+01  0.00000000e+00]
 [-7.66686782e-03  1.75670011e-02]]
grads:  [-7.74214918e-03 -1.31320484e+01]
Stock Position:  -0.007742149182975162
Bond Position:  [2.75481533]


portfolio before change:  [1.92445393]
curr_Stock_Price:  107.29653336508362
curr_Factors:  [1.07296533e+02 3.64768627e-02]
mat_Sqrt:  [[ 2.04924758e+01  0.00000000e+00]
 [-7.63956677e-03  1.75044465e-02]]
grads:  [-3.24123569e-04  5.66494235e+00]
Stock Position:  -0.0003241235688189545
Bond Position:  [1.95923127]


portfolio before change:  [1.92473348]
curr_Stock_Price:  107.18968779319012
curr_Factors:  [1.07189688e+02 3.66364326e-02]
mat_Sqrt:  [[ 2.05167986e+01  0.00000000e+00]
 [-7.65625837e-03  1.75426918e-02]]
grads:  [0.00986059 8.95890778]
Stock Position:  0.009860589032867134
Bond Position:  [0.86778002]


portfolio before change:  [1.92665729]
curr_Stock_Price:  107.37378694466432
curr_Factors:  [1.07373787e+02 3.67196042e-02]
mat_Sqrt:  [[ 2.05753516e+01  0.00000000e+00]
 [-7.66494401e-03  1.75625931e-02]]
grads:  [ 0.00072848 -0.36833622]
Stock Position:  0.000728480247893185
Bond Position:  [1.8484376]


portfolio before change:  [1.92706701]
curr_Stock_Price:  107.61902264036027
curr_Factors:  [1.07619023e+02 3.57203121e-02]
mat_Sqrt:  [[ 2.03397994e+01  0.00000000e+00]
 [-7.55992720e-03  1.73219693e-02]]
grads:  [-0.00624778 -1.4002992 ]
Stock Position:  -0.006247776701639413
Bond Position:  [2.59944663]


portfolio before change:  [1.92408276]
curr_Stock_Price:  108.14868176436104
curr_Factors:  [1.08148682e+02 3.57908479e-02]
mat_Sqrt:  [[ 2.04600751e+01  0.00000000e+00]
 [-7.56738770e-03  1.73390635e-02]]
grads:  [2.05127218e-02 3.15611019e+01]
Stock Position:  0.020512721796914397
Bond Position:  [-0.29434106]


portfolio before change:  [1.92837141]
curr_Stock_Price:  108.359547884824
curr_Factors:  [1.08359548e+02 3.56492367e-02]
mat_Sqrt:  [[ 2.04593721e+01  0.00000000e+00]
 [-7.55240218e-03  1.73047273e-02]]
grads:  [4.92557743e-03 1.54142335e+01]
Stock Position:  0.004925577429211048
Bond Position:  [1.39463806]


portfolio before change:  [1.93346674]
curr_Stock_Price:  109.35861702024214
curr_Factors:  [1.09358617e+02 3.58094440e-02]
mat_Sqrt:  [[ 2.06943504e+01  0.00000000e+00]
 [-7.56935337e-03  1.73435674e-02]]
grads:  [-9.00077786e-03 -2.35678252e+01]
Stock Position:  -0.009000777863730361
Bond Position:  [2.91777936]


portfolio before change:  [1.9284256]
curr_Stock_Price:  109.95921869208085
curr_Factors:  [1.09959219e+02 3.57132335e-02]
mat_Sqrt:  [[ 2.07800330e+01  0.00000000e+00]
 [-7.55917810e-03  1.73202529e-02]]
grads:  [ 0.01455367 13.0592717 ]
Stock Position:  0.014553670101778606
Bond Position:  [0.32811541]


portfolio before change:  [1.94021023]
curr_Stock_Price:  110.76613604556164
curr_Factors:  [1.10766136e+02 3.49821473e-02]
mat_Sqrt:  [[ 2.07171608e+01  0.00000000e+00]
 [-7.48140599e-03  1.71420546e-02]]
grads:  [1.15125487e-02 1.48601631e+01]
Stock Position:  0.011512548652933075
Bond Position:  [0.6650097]


portfolio before change:  [1.94721419]
curr_Stock_Price:  111.36729158138806
curr_Factors:  [1.11367292e+02 3.21036394e-02]
mat_Sqrt:  [[ 1.99542217e+01  0.00000000e+00]
 [-7.16699540e-03  1.64216495e-02]]
grads:  [ 2.03157853e-02 -6.85004961e+01]
Stock Position:  0.020315785292734236
Bond Position:  [-0.31529979]


portfolio before change:  [1.96590869]
curr_Stock_Price:  112.2894274233693
curr_Factors:  [1.12289427e+02 3.38021922e-02]
mat_Sqrt:  [[ 2.06448295e+01  0.00000000e+00]
 [-7.35414901e-03  1.68504722e-02]]
grads:  [-3.03158428e-02  8.60233995e+01]
Stock Position:  -0.03031584276539043
Bond Position:  [5.37005732]


portfolio before change:  [1.9626073]
curr_Stock_Price:  112.4204709875758
curr_Factors:  [1.12420471e+02 3.14809810e-02]
mat_Sqrt:  [[ 1.99466299e+01  0.00000000e+00]
 [-7.09715221e-03  1.62616186e-02]]
grads:  [ 9.7421727e-04 -1.2813407e+00]
Stock Position:  0.0009742172701604905
Bond Position:  [1.85308533]


portfolio before change:  [1.96332197]
curr_Stock_Price:  112.91627420440136
curr_Factors:  [1.12916274e+02 3.16104190e-02]
mat_Sqrt:  [[ 2.00757448e+01  0.00000000e+00]
 [-7.11172766e-03  1.62950152e-02]]
grads:  [-0.00420258 -2.60281692]
Stock Position:  -0.004202575563331636
Bond Position:  [2.43786114]


portfolio before change:  [1.95158635]
curr_Stock_Price:  115.78127108671447
curr_Factors:  [1.15781271e+02 2.98708519e-02]
mat_Sqrt:  [[ 2.00106924e+01  0.00000000e+00]
 [-6.91327440e-03  1.58403016e-02]]
grads:  [0.01375538 7.75580693]
Stock Position:  0.013755377773097247
Bond Position:  [0.35897123]


portfolio before change:  [1.94049196]
curr_Stock_Price:  114.97145924484629
curr_Factors:  [1.14971459e+02 2.87007717e-02]
mat_Sqrt:  [[ 1.94776622e+01  0.00000000e+00]
 [-6.77652084e-03  1.55269599e-02]]
grads:  [ -0.03155732 -16.28272455]
Stock Position:  -0.03155732450011876
Bond Position:  [5.56868361]


portfolio before change:  [1.91393041]
curr_Stock_Price:  115.83521039438557
curr_Factors:  [1.1583521e+02 2.9789624e-02]
mat_Sqrt:  [[ 1.99927761e+01  0.00000000e+00]
 [-6.90386837e-03  1.58187497e-02]]
grads:  [ 0.01789819 -3.14422264]
Stock Position:  0.017898191835164307
Bond Position:  [-0.15931041]


portfolio before change:  [1.93985928]
curr_Stock_Price:  117.28500985358815
curr_Factors:  [1.17285010e+02 2.95128732e-02]
mat_Sqrt:  [[ 2.01487568e+01  0.00000000e+00]
 [-6.87172446e-03  1.57450987e-02]]
grads:  [4.26581815e-02 4.85145546e+01]
Stock Position:  0.042658181517007336
Bond Position:  [-3.06330595]


portfolio before change:  [1.95715681]
curr_Stock_Price:  117.69947818551606
curr_Factors:  [1.17699478e+02 3.00961222e-02]
mat_Sqrt:  [[ 2.04187809e+01  0.00000000e+00]
 [-6.93929359e-03  1.58999191e-02]]
grads:  [ 0.01660806 -2.43588651]
Stock Position:  0.016608058766619957
Bond Position:  [0.00239696]


portfolio before change:  [1.96262394]
curr_Stock_Price:  118.02864524029724
curr_Factors:  [1.18028645e+02 3.02760602e-02]
mat_Sqrt:  [[ 2.05370047e+01  0.00000000e+00]
 [-6.96000691e-03  1.59473793e-02]]
grads:  [-1.31487558e-02 -2.61997210e+01]
Stock Position:  -0.013148755803442172
Bond Position:  [3.51455377]


portfolio before change:  [1.96657567]
curr_Stock_Price:  117.76151858428804
curr_Factors:  [1.17761519e+02 3.11640798e-02]
mat_Sqrt:  [[ 2.07888541e+01  0.00000000e+00]
 [-7.06134036e-03  1.61795634e-02]]
grads:  [ 0.00749804 -4.30645019]
Stock Position:  0.007498039399968165
Bond Position:  [1.08359516]


portfolio before change:  [1.95370793]
curr_Stock_Price:  116.02730636304467
curr_Factors:  [1.16027306e+02 3.28186632e-02]
mat_Sqrt:  [[ 2.10194164e+01  0.00000000e+00]
 [-7.24636882e-03  1.66035168e-02]]
grads:  [-0.02042808  0.84509663]
Stock Position:  -0.02042807655815924
Bond Position:  [4.32392263]


portfolio before change:  [1.9768402]
curr_Stock_Price:  114.92139006353068
curr_Factors:  [1.14921390e+02 3.21449236e-02]
mat_Sqrt:  [[ 2.06042623e+01  0.00000000e+00]
 [-7.17160218e-03  1.64322049e-02]]
grads:  [-0.00393359  3.50190928]
Stock Position:  -0.003933586675406361
Bond Position:  [2.42889345]


portfolio before change:  [1.97554773]
curr_Stock_Price:  115.32715279917848
curr_Factors:  [1.15327153e+02 3.26463882e-02]
mat_Sqrt:  [[ 2.08376693e+01  0.00000000e+00]
 [-7.22732462e-03  1.65598811e-02]]
grads:  [-0.01475772 11.11411976]
Stock Position:  -0.01475771579283804
Bond Position:  [3.67751307]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.99531011]
Stock Price:  114.01918202294331
PL:  [-12.02387191]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-5.01081726e-02  1.97678836e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 9.22626398e-01 -9.46037905e-01]
 [ 5.69360277e-04  2.98463389e-01]
 [ 8.96400232e-03 -1.23385028e-01]
 [-7.95298572e-02 -1.06906283e-01]
 [-1.29458480e-01  8.47983574e-02]
 [ 1.38167586e-01 -1.61686167e-01]
 [ 1.64279074e-01  1.57231621e-01]
 [-4.66781596e-02  2.95816195e-01]
 [ 1.71346432e-01  3.90424261e-01]
 [ 1.84928965e-01  2.49243112e-01]
 [ 2.26507464e-01  2.19017423e-02]
 [-5.95519421e-02 -1.21663163e-03]
 [ 9.73752832e-02  2.39175849e-01]
 [ 3.80362251e-02  1.61165828e-01]
 [ 1.28032492e-01  3.10515348e-01]
 [ 1.09635314e-01  6.90839820e-02]
 [ 1.78487761e-02 -7.38175255e-03]
 [ 3.50367641e-01 -1.15868295e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.83753289e-02  6.09435746e-02]
 [-5.28958220e-02 -1.39222537e-01]
 [ 1.21925190e-02 -8.28761063e-02]
 [ 5.05553099e-02  1.44112636e-01]
 [ 4.55304518e-02  1.36092767e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-2.02715759e-01  1.44836255e-01]
 [-5.75060046e-02 -1.08351080e-01]
 [ 6.82986475e-02 -6.22861383e-02]
 [-8.47736462e-01 -1.01437333e-01]
 [-1.18189771e-01  9.87685418e-03]
 [ 1.23004669e-03 -9.08339139e-02]
 [ 7.97688501e-02  1.01530736e-01]
 [-9.99033176e-02  1.36757855e-01]
 [-9.44109058e-01 -2.23921414e-01]
 [-3.34176428e-02  3.08736108e-01]
 [-1.23702057e-01  1.17600598e-01]
 [ 4.43800142e-01  4.98350121e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.51234021]
curr_Stock_Price:  99.66932893521121
curr_Factors:  [9.96693289e+01 3.82732170e-02]
mat_Sqrt:  [[ 1.94988509e+01  0.00000000e+00]
 [-7.82541674e-03  1.79302823e-02]]
grads:  [1.85477311e-03 1.10248591e+01]
Stock Position:  0.0018547731147556057
Bond Position:  [0.32747622]


portfolio before change:  [0.50927645]
curr_Stock_Price:  97.99543206876656
curr_Factors:  [9.79954321e+01 3.98573450e-02]
mat_Sqrt:  [[ 1.95641063e+01  0.00000000e+00]
 [-7.98572176e-03  1.82975872e-02]]
grads:  [-0.01037535 -4.80999867]
Stock Position:  -0.010375349857130393
Bond Position:  [1.52601334]


portfolio before change:  [0.53203737]
curr_Stock_Price:  95.820068523972
curr_Factors:  [9.58200685e+01 4.03829926e-02]
mat_Sqrt:  [[ 1.92555411e+01  0.00000000e+00]
 [-8.03820802e-03  1.84178484e-02]]
grads:  [ 2.64724634e-02 -5.13652782e+01]
Stock Position:  0.026472463391108075
Bond Position:  [-2.00455588]


portfolio before change:  [0.535642]
curr_Stock_Price:  95.96569949246212
curr_Factors:  [9.59656995e+01 4.08481304e-02]
mat_Sqrt:  [[ 1.93955512e+01  0.00000000e+00]
 [-8.08436817e-03  1.85236145e-02]]
grads:  [6.74533357e-03 1.61125891e+01]
Stock Position:  0.00674533357128687
Bond Position:  [-0.11167866]


portfolio before change:  [0.53626386]
curr_Stock_Price:  96.05996125703193
curr_Factors:  [9.60599613e+01 4.10628147e-02]
mat_Sqrt:  [[ 1.94655538e+01  0.00000000e+00]
 [-8.10558471e-03  1.85722277e-02]]
grads:  [-2.30590094e-03 -6.64352333e+00]
Stock Position:  -0.0023059009370100278
Bond Position:  [0.75776862]


portfolio before change:  [0.53377297]
curr_Stock_Price:  97.18126623259782
curr_Factors:  [9.71812662e+01 4.14496930e-02]
mat_Sqrt:  [[ 1.97853261e+01  0.00000000e+00]
 [-8.14367907e-03  1.86595129e-02]]
grads:  [-0.00637784 -5.729318  ]
Stock Position:  -0.006377836974051936
Bond Position:  [1.15357924]


portfolio before change:  [0.53907354]
curr_Stock_Price:  96.37278451923325
curr_Factors:  [9.63727845e+01 4.18809939e-02]
mat_Sqrt:  [[ 1.97225423e+01  0.00000000e+00]
 [-8.18593856e-03  1.87563416e-02]]
grads:  [-0.0046875   4.52104997]
Stock Position:  -0.004687501290992553
Bond Position:  [0.99082109]


portfolio before change:  [0.54403039]
curr_Stock_Price:  95.34174687705126
curr_Factors:  [9.53417469e+01 4.21241040e-02]
mat_Sqrt:  [[ 1.95680903e+01  0.00000000e+00]
 [-8.20966299e-03  1.88107010e-02]]
grads:  [ 3.45470389e-03 -8.59543549e+00]
Stock Position:  0.0034547038944881723
Bond Position:  [0.21465289]


portfolio before change:  [0.54111043]
curr_Stock_Price:  94.48876633995853
curr_Factors:  [9.44887663e+01 4.21667748e-02]
mat_Sqrt:  [[ 1.94028431e+01  0.00000000e+00]
 [-8.21382004e-03  1.88202260e-02]]
grads:  [0.01200343 8.35439601]
Stock Position:  0.012003425392821248
Bond Position:  [-0.59307843]


portfolio before change:  [0.54694773]
curr_Stock_Price:  94.98124591109718
curr_Factors:  [9.49812459e+01 4.22304720e-02]
mat_Sqrt:  [[ 1.95186973e+01  0.00000000e+00]
 [-8.22002160e-03  1.88344356e-02]]
grads:  [4.22295662e-03 1.57061353e+01]
Stock Position:  0.004222956620149417
Bond Position:  [0.14584605]


portfolio before change:  [0.55137081]
curr_Stock_Price:  96.02431715498247
curr_Factors:  [9.60243172e+01 4.07272895e-02]
mat_Sqrt:  [[ 1.93786706e+01  0.00000000e+00]
 [-8.07240133e-03  1.84961951e-02]]
grads:  [1.76349325e-02 2.11083555e+01]
Stock Position:  0.017634932511031383
Bond Position:  [-1.14201154]


portfolio before change:  [0.56700468]
curr_Stock_Price:  96.91894101143399
curr_Factors:  [9.69189410e+01 3.99947016e-02]
mat_Sqrt:  [[ 1.93825044e+01  0.00000000e+00]
 [-7.99947014e-03  1.83290887e-02]]
grads:  [ 0.01515323 13.59822718]
Stock Position:  0.01515323156809641
Bond Position:  [-0.90163048]


portfolio before change:  [0.56003802]
curr_Stock_Price:  96.4666317573006
curr_Factors:  [9.64666318e+01 4.02329440e-02]
mat_Sqrt:  [[ 1.93494231e+01  0.00000000e+00]
 [-8.02326059e-03  1.83835995e-02]]
grads:  [0.01220017 1.19137399]
Stock Position:  0.012200165695992953
Bond Position:  [-0.61687087]


portfolio before change:  [0.54505407]
curr_Stock_Price:  95.2447758557107
curr_Factors:  [9.52447759e+01 4.04353591e-02]
mat_Sqrt:  [[ 1.91523388e+01  0.00000000e+00]
 [-8.04341809e-03  1.84297861e-02]]
grads:  [-0.00313711 -0.06601442]
Stock Position:  -0.0031371063466582192
Bond Position:  [0.84384706]


portfolio before change:  [0.54527349]
curr_Stock_Price:  95.20845556667174
curr_Factors:  [9.52084556e+01 3.99377967e-02]
mat_Sqrt:  [[ 1.90268797e+01  0.00000000e+00]
 [-7.99377725e-03  1.83160447e-02]]
grads:  [1.06039553e-02 1.30582696e+01]
Stock Position:  0.010603955317397551
Bond Position:  [-0.46431272]


portfolio before change:  [0.53886696]
curr_Stock_Price:  94.60976519912731
curr_Factors:  [9.46097652e+01 4.10882968e-02]
mat_Sqrt:  [[ 1.91776344e+01  0.00000000e+00]
 [-8.10809934e-03  1.85779895e-02]]
grads:  [5.65110153e-03 8.67509522e+00]
Stock Position:  0.005651101530114918
Bond Position:  [0.00421758]


portfolio before change:  [0.53641927]
curr_Stock_Price:  94.17653538400242
curr_Factors:  [9.41765354e+01 4.24617679e-02]
mat_Sqrt:  [[ 1.94062555e+01  0.00000000e+00]
 [-8.24250136e-03  1.88859432e-02]]
grads:  [1.35808013e-02 1.64416119e+01]
Stock Position:  0.013580801315011212
Bond Position:  [-0.74257355]


portfolio before change:  [0.54413956]
curr_Stock_Price:  94.7518414790563
curr_Factors:  [9.47518415e+01 4.24573345e-02]
mat_Sqrt:  [[ 1.95237852e+01  0.00000000e+00]
 [-8.24207105e-03  1.88849572e-02]]
grads:  [0.00715978 3.65814871]
Stock Position:  0.007159781437976723
Bond Position:  [-0.13426292]


portfolio before change:  [0.54715464]
curr_Stock_Price:  95.17529986176032
curr_Factors:  [9.51752999e+01 4.20942355e-02]
mat_Sqrt:  [[ 1.95270018e+01  0.00000000e+00]
 [-8.20675190e-03  1.88040309e-02]]
grads:  [ 0.00074907 -0.39256224]
Stock Position:  0.000749071223337639
Bond Position:  [0.47586156]


portfolio before change:  [0.5466494]
curr_Stock_Price:  94.42139396072508
curr_Factors:  [9.4421394e+01 4.1841224e-02]
mat_Sqrt:  [[ 1.93140165e+01  0.00000000e+00]
 [-8.18205099e-03  1.87474340e-02]]
grads:  [ 0.01552233 -6.18048822]
Stock Position:  0.015522331726512456
Bond Position:  [-0.9189908]


portfolio before change:  [0.52753058]
curr_Stock_Price:  93.19709725636373
curr_Factors:  [9.31970973e+01 4.28807162e-02]
mat_Sqrt:  [[ 1.92989376e+01  0.00000000e+00]
 [-8.28306380e-03  1.89788834e-02]]
grads:  [ 0.00218295 -1.99052751]
Stock Position:  0.002182949734259001
Bond Position:  [0.324086]


portfolio before change:  [0.52725796]
curr_Stock_Price:  93.0536536502893
curr_Factors:  [9.30536537e+01 4.29740874e-02]
mat_Sqrt:  [[ 1.92902014e+01  0.00000000e+00]
 [-8.29207694e-03  1.89995351e-02]]
grads:  [-9.21386093e-05  3.20763504e+00]
Stock Position:  -9.213860926746969e-05
Bond Position:  [0.5358318]


portfolio before change:  [0.52735579]
curr_Stock_Price:  92.71887807443126
curr_Factors:  [9.27188781e+01 4.21229223e-02]
mat_Sqrt:  [[ 1.90295016e+01  0.00000000e+00]
 [-8.20954783e-03  1.88104372e-02]]
grads:  [-5.97270075e-03 -7.40134508e+00]
Stock Position:  -0.005972700745720559
Bond Position:  [1.0811379]


portfolio before change:  [0.52238877]
curr_Stock_Price:  93.57312683808935
curr_Factors:  [9.35731268e+01 4.17798221e-02]
mat_Sqrt:  [[ 1.91264529e+01  0.00000000e+00]
 [-8.17604521e-03  1.87336730e-02]]
grads:  [-1.25363439e-03 -4.42391122e+00]
Stock Position:  -0.001253634394694798
Bond Position:  [0.63969526]


portfolio before change:  [0.52073869]
curr_Stock_Price:  94.95314765022924
curr_Factors:  [9.49531477e+01 4.24261661e-02]
mat_Sqrt:  [[ 1.95580819e+01  0.00000000e+00]
 [-8.23904520e-03  1.88780241e-02]]
grads:  [5.80073350e-03 7.63388347e+00]
Stock Position:  0.005800733503483414
Bond Position:  [-0.03005921]


portfolio before change:  [0.52173374]
curr_Stock_Price:  95.1253324670303
curr_Factors:  [9.51253325e+01 4.29787897e-02]
mat_Sqrt:  [[ 1.97207432e+01  0.00000000e+00]
 [-8.29253059e-03  1.90005746e-02]]
grads:  [5.32060093e-03 7.16256060e+00]
Stock Position:  0.0053206009252189075
Bond Position:  [0.0156098]


portfolio before change:  [0.52212848]
curr_Stock_Price:  95.1991573698745
curr_Factors:  [9.51991574e+01 4.19940125e-02]
mat_Sqrt:  [[ 1.95086309e+01  0.00000000e+00]
 [-8.19697628e-03  1.87816321e-02]]
grads:  [9.13245023e-03 9.31428074e+00]
Stock Position:  0.009132450227053054
Bond Position:  [-0.34727309]


portfolio before change:  [0.55430292]
curr_Stock_Price:  98.72700069574162
curr_Factors:  [9.87270007e+01 4.21200872e-02]
mat_Sqrt:  [[ 2.02619190e+01  0.00000000e+00]
 [-8.20927156e-03  1.88098042e-02]]
grads:  [-6.88503570e-03  7.70004055e+00]
Stock Position:  -0.006885035702465072
Bond Position:  [1.23404185]


portfolio before change:  [0.55555187]
curr_Stock_Price:  98.56800674218292
curr_Factors:  [9.85680067e+01 4.10162556e-02]
mat_Sqrt:  [[ 1.99624564e+01  0.00000000e+00]
 [-8.10098814e-03  1.85616957e-02]]
grads:  [-5.24956903e-03 -5.83734813e+00]
Stock Position:  -0.00524956902907216
Bond Position:  [1.07299142]


portfolio before change:  [0.55694157]
curr_Stock_Price:  98.32883026593011
curr_Factors:  [9.83288303e+01 4.02171040e-02]
mat_Sqrt:  [[ 1.97190628e+01  0.00000000e+00]
 [-8.02168102e-03  1.83799802e-02]]
grads:  [ 2.08502547e-03 -3.38880334e+00]
Stock Position:  0.0020850254652401354
Bond Position:  [0.35192346]


portfolio before change:  [0.55650472]
curr_Stock_Price:  98.09821150181341
curr_Factors:  [9.80982115e+01 4.09626667e-02]
mat_Sqrt:  [[ 1.98543284e+01  0.00000000e+00]
 [-8.09569434e-03  1.85495661e-02]]
grads:  [-0.0449276  -5.46844774]
Stock Position:  -0.044927600995431846
Bond Position:  [4.96382202]


portfolio before change:  [0.55394889]
curr_Stock_Price:  98.16891064280465
curr_Factors:  [9.81689106e+01 4.22317492e-02]
mat_Sqrt:  [[ 2.01740692e+01  0.00000000e+00]
 [-8.22014590e-03  1.88347204e-02]]
grads:  [-0.00564483  0.52439611]
Stock Position:  -0.005644828392104891
Bond Position:  [1.10809555]


portfolio before change:  [0.553955]
curr_Stock_Price:  98.19236724516726
curr_Factors:  [9.81923672e+01 4.24530463e-02]
mat_Sqrt:  [[ 2.02316899e+01  0.00000000e+00]
 [-8.24165481e-03  1.88840035e-02]]
grads:  [-1.89866114e-03 -4.81009834e+00]
Stock Position:  -0.001898661140744658
Bond Position:  [0.74038904]


portfolio before change:  [0.55520726]
curr_Stock_Price:  97.58156607211107
curr_Factors:  [9.75815661e+01 4.26122102e-02]
mat_Sqrt:  [[ 2.01434945e+01  0.00000000e+00]
 [-8.25709006e-03  1.89193701e-02]]
grads:  [0.00615983 5.36649665]
Stock Position:  0.006159829731862091
Bond Position:  [-0.04587857]


portfolio before change:  [0.55570696]
curr_Stock_Price:  97.66361855624436
curr_Factors:  [9.76636186e+01 4.28362570e-02]
mat_Sqrt:  [[ 2.02133627e+01  0.00000000e+00]
 [-8.27876870e-03  1.89690421e-02]]
grads:  [-1.98963908e-03  7.20952878e+00]
Stock Position:  -0.001989639083081867
Bond Position:  [0.75002231]


portfolio before change:  [0.55697385]
curr_Stock_Price:  97.0739973516658
curr_Factors:  [9.70739974e+01 4.24640537e-02]
mat_Sqrt:  [[ 2.00038523e+01  0.00000000e+00]
 [-8.24272321e-03  1.88864515e-02]]
grads:  [ -0.05208179 -11.85619301]
Stock Position:  -0.052081787119955654
Bond Position:  [5.61276111]


portfolio before change:  [0.46946598]
curr_Stock_Price:  98.76767012459665
curr_Factors:  [9.87676701e+01 4.21338453e-02]
mat_Sqrt:  [[ 2.02735759e+01  0.00000000e+00]
 [-8.21061218e-03  1.88128759e-02]]
grads:  [4.99792648e-03 1.64108938e+01]
Stock Position:  0.004997926475071201
Bond Position:  [-0.02416757]


portfolio before change:  [0.47547849]
curr_Stock_Price:  99.97127552354402
curr_Factors:  [9.99712755e+01 4.17958239e-02]
mat_Sqrt:  [[ 2.04381545e+01  0.00000000e+00]
 [-8.17761079e-03  1.87372602e-02]]
grads:  [-3.54126631e-03  6.27629635e+00]
Stock Position:  -0.003541266312784543
Bond Position:  [0.8295034]


portfolio before change:  [0.47716588]
curr_Stock_Price:  99.52406434488702
curr_Factors:  [9.95240643e+01 4.30676659e-02]
mat_Sqrt:  [[ 2.06539809e+01  0.00000000e+00]
 [-8.30110026e-03  1.90202101e-02]]
grads:  [0.02254045 2.62010839]
Stock Position:  0.02254044515933019
Bond Position:  [-1.76615083]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.455138]
Stock Price:  98.55659910912345
PL:  [0.455138]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.18880465e-01  4.07028571e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.46066733e-01 -7.59320930e-01]
 [-2.03803693e-02  2.00440274e-01]
 [ 3.26718707e-02 -5.70392305e-02]
 [-7.82470027e-02 -9.89843748e-02]
 [-1.20975339e-01  9.77766556e-02]
 [ 1.58031444e-01 -1.66541765e-01]
 [ 1.64054462e-01  1.64585317e-01]
 [-6.94428016e-02  3.27686383e-01]
 [ 1.86357845e-01  4.78945494e-01]
 [ 1.29615131e-01  3.07272875e-01]
 [ 2.62578633e-01  2.26101357e-02]
 [-5.33004055e-02  8.21845831e-03]
 [ 9.88681713e-02  2.39786637e-01]
 [ 3.87438839e-02  1.51826683e-01]
 [ 9.84863864e-02  2.22355963e-01]
 [ 9.26540234e-02  6.61577691e-02]
 [ 1.40694469e-02  1.63774749e-02]
 [ 3.79468855e-01 -1.18108560e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-3.09209478e-02  7.48307609e-02]
 [-3.54304821e-02 -1.17387002e-01]
 [ 3.05754157e-02 -1.41483137e-01]
 [ 2.45121350e-02  1.51233316e-01]
 [ 4.57065708e-02  1.81685817e-01]
 [ 9.41250448e-02  1.73593379e-01]
 [-1.57821790e-01  8.72506762e-02]
 [-3.70995194e-01  4.89062882e-02]
 [ 2.03064800e-01 -9.37828547e-02]
 [-1.20926676e+00 -1.35988247e-01]
 [ 7.37919623e-02  2.96209946e-01]
 [-1.22572788e-02 -1.24603250e-01]
 [ 3.36747939e-02  8.20376605e-02]
 [-4.62554102e-02  1.64392991e-01]
 [-1.23077612e+00 -1.66421226e-01]
 [-6.04502815e-02  2.54277463e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.56573980e-01  2.93447197e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.53077421]
curr_Stock_Price:  100.27457013525714
curr_Factors:  [1.00274570e+02 3.82377667e-02]
mat_Sqrt:  [[ 1.96081702e+01  0.00000000e+00]
 [-7.82179179e-03  1.79219765e-02]]
grads:  [1.51223849e-02 2.27111431e+01]
Stock Position:  0.01512238491200026
Bond Position:  [3.01438356]


portfolio before change:  [4.5200865]
curr_Stock_Price:  99.54290452628602
curr_Factors:  [9.95429045e+01 3.86336690e-02]
mat_Sqrt:  [[ 1.95656052e+01  0.00000000e+00]
 [-7.86217975e-03  1.80145169e-02]]
grads:  [-0.01037456 -4.88558037]
Stock Position:  -0.010374555033923323
Bond Position:  [5.55279984]


portfolio before change:  [4.53051704]
curr_Stock_Price:  98.60441611497555
curr_Factors:  [9.86044161e+01 4.10079517e-02]
mat_Sqrt:  [[ 1.99678086e+01  0.00000000e+00]
 [-8.10016806e-03  1.85598166e-02]]
grads:  [ 2.57750824e-02 -4.09120922e+01]
Stock Position:  0.025775082367858793
Bond Position:  [1.9889801]


portfolio before change:  [4.5000418]
curr_Stock_Price:  97.41241686011801
curr_Factors:  [9.74124169e+01 4.11989528e-02]
mat_Sqrt:  [[ 1.97723098e+01  0.00000000e+00]
 [-8.11901007e-03  1.86029891e-02]]
grads:  [3.39358115e-03 1.07746273e+01]
Stock Position:  0.003393581150374298
Bond Position:  [4.16946486]


portfolio before change:  [4.50222001]
curr_Stock_Price:  97.9006901715967
curr_Factors:  [9.79006902e+01 4.10506422e-02]
mat_Sqrt:  [[ 1.98356178e+01  0.00000000e+00]
 [-8.10438323e-03  1.85694748e-02]]
grads:  [ 3.92118346e-04 -3.07166633e+00]
Stock Position:  0.00039211834564681884
Bond Position:  [4.46383136]


portfolio before change:  [4.5023335]
curr_Stock_Price:  96.76702409227703
curr_Factors:  [9.67670241e+01 4.06393991e-02]
mat_Sqrt:  [[ 1.95074734e+01  0.00000000e+00]
 [-8.06368641e-03  1.84762267e-02]]
grads:  [-0.00622568 -5.35739123]
Stock Position:  -0.006225681973069955
Bond Position:  [5.10477421]


portfolio before change:  [4.50337944]
curr_Stock_Price:  96.70151947978954
curr_Factors:  [9.67015195e+01 3.96117799e-02]
mat_Sqrt:  [[ 1.92462214e+01  0.00000000e+00]
 [-7.96108333e-03  1.82411335e-02]]
grads:  [-4.06844056e-03  5.36022916e+00]
Stock Position:  -0.004068440562128398
Bond Position:  [4.89680383]


portfolio before change:  [4.51034345]
curr_Stock_Price:  95.140265849092
curr_Factors:  [9.51402658e+01 4.00726942e-02]
mat_Sqrt:  [[ 1.90453357e+01  0.00000000e+00]
 [-8.00726612e-03  1.83469516e-02]]
grads:  [ 4.48123678e-03 -9.07735348e+00]
Stock Position:  0.0044812367822634775
Bond Position:  [4.08399739]


portfolio before change:  [4.50603795]
curr_Stock_Price:  94.06555499144837
curr_Factors:  [9.40655550e+01 4.13516915e-02]
mat_Sqrt:  [[ 1.91283391e+01  0.00000000e+00]
 [-8.13404613e-03  1.86374411e-02]]
grads:  [0.01233172 8.83089672]
Stock Position:  0.01233172322470181
Bond Position:  [3.34604756]


portfolio before change:  [4.51294856]
curr_Stock_Price:  94.59202913186427
curr_Factors:  [9.45920291e+01 4.22332786e-02]
mat_Sqrt:  [[ 1.94393590e+01  0.00000000e+00]
 [-8.22029475e-03  1.88350615e-02]]
grads:  [3.78465466e-03 1.73976806e+01]
Stock Position:  0.0037846546632225287
Bond Position:  [4.1549504]


portfolio before change:  [4.51531363]
curr_Stock_Price:  95.07970089518851
curr_Factors:  [9.50797009e+01 4.14823174e-02]
mat_Sqrt:  [[ 1.93650807e+01  0.00000000e+00]
 [-8.14688332e-03  1.86668548e-02]]
grads:  [2.04175134e-02 2.56575358e+01]
Stock Position:  0.020417513397484377
Bond Position:  [2.57402257]


portfolio before change:  [4.50856615]
curr_Stock_Price:  94.7334657854617
curr_Factors:  [9.47334658e+01 4.12630190e-02]
mat_Sqrt:  [[ 1.92434939e+01  0.00000000e+00]
 [-8.12532033e-03  1.86174477e-02]]
grads:  [1.37043725e-02 1.65045649e+01]
Stock Position:  0.013704372492859376
Bond Position:  [3.21030345]


portfolio before change:  [4.52250541]
curr_Stock_Price:  95.72132182219087
curr_Factors:  [9.57213218e+01 4.06323126e-02]
mat_Sqrt:  [[ 1.92949856e+01  0.00000000e+00]
 [-8.06298333e-03  1.84746157e-02]]
grads:  [0.01412007 1.22384877]
Stock Position:  0.014120067856745272
Bond Position:  [3.17091385]


portfolio before change:  [4.51495294]
curr_Stock_Price:  95.15837458115527
curr_Factors:  [9.51583746e+01 4.13673132e-02]
mat_Sqrt:  [[ 1.93542200e+01  0.00000000e+00]
 [-8.13558241e-03  1.86409611e-02]]
grads:  [-0.00256862  0.44088168]
Stock Position:  -0.002568616889060273
Bond Position:  [4.75937835]


portfolio before change:  [4.5176133]
curr_Stock_Price:  94.3542873392422
curr_Factors:  [9.43542873e+01 4.03375567e-02]
mat_Sqrt:  [[ 1.89503150e+01  0.00000000e+00]
 [-8.03368476e-03  1.84074843e-02]]
grads:  [1.07396441e-02 1.30265838e+01]
Stock Position:  0.010739644137033827
Bond Position:  [3.50428183]


portfolio before change:  [4.52270686]
curr_Stock_Price:  94.78777524732699
curr_Factors:  [9.47877752e+01 3.85753879e-02]
mat_Sqrt:  [[ 1.86169049e+01  0.00000000e+00]
 [-7.85624723e-03  1.80009238e-02]]
grads:  [5.64038337e-03 8.43438287e+00]
Stock Position:  0.0056403833734975815
Bond Position:  [3.98806747]


portfolio before change:  [4.5239394]
curr_Stock_Price:  94.91790713557346
curr_Factors:  [9.49179071e+01 3.95500854e-02]
mat_Sqrt:  [[ 1.88765171e+01  0.00000000e+00]
 [-7.95488131e-03  1.82269229e-02]]
grads:  [1.03583984e-02 1.21993144e+01]
Stock Position:  0.010358398384343305
Bond Position:  [3.5407419]


portfolio before change:  [4.52942305]
curr_Stock_Price:  95.404568594912
curr_Factors:  [9.54045686e+01 4.05372973e-02]
mat_Sqrt:  [[ 1.92086378e+01  0.00000000e+00]
 [-8.05355050e-03  1.84530024e-02]]
grads:  [0.00632672 3.58520352]
Stock Position:  0.006326718344951403
Bond Position:  [3.92582522]


portfolio before change:  [4.5317724]
curr_Stock_Price:  95.69833786927349
curr_Factors:  [9.56983379e+01 4.00421193e-02]
mat_Sqrt:  [[ 1.91497418e+01  0.00000000e+00]
 [-8.00421082e-03  1.83399510e-02]]
grads:  [0.00110796 0.89299448]
Stock Position:  0.0011079607870481537
Bond Position:  [4.4257424]


portfolio before change:  [4.53044554]
curr_Stock_Price:  94.00142187008244
curr_Factors:  [9.40014219e+01 4.01333736e-02]
mat_Sqrt:  [[ 1.88316015e+01  0.00000000e+00]
 [-8.01332626e-03  1.83608371e-02]]
grads:  [ 0.01741339 -6.43263481]
Stock Position:  0.017413391676674057
Bond Position:  [2.89356196]


portfolio before change:  [4.5238597]
curr_Stock_Price:  93.6024438573121
curr_Factors:  [9.36024439e+01 4.09421189e-02]
mat_Sqrt:  [[ 1.89396673e+01  0.00000000e+00]
 [-8.09366359e-03  1.85449130e-02]]
grads:  [ 0.00222436 -2.03710794]
Stock Position:  0.0022243585370099435
Bond Position:  [4.3156543]


portfolio before change:  [4.52392796]
curr_Stock_Price:  93.39059560060157
curr_Factors:  [9.33905956e+01 4.03323318e-02]
mat_Sqrt:  [[ 1.87555503e+01  0.00000000e+00]
 [-8.03316444e-03  1.84062921e-02]]
grads:  [9.26591734e-05 4.06549894e+00]
Stock Position:  9.265917341287043e-05
Bond Position:  [4.51527447]


portfolio before change:  [4.52449526]
curr_Stock_Price:  93.42139418242834
curr_Factors:  [9.34213942e+01 4.01614519e-02]
mat_Sqrt:  [[ 1.87219485e+01  0.00000000e+00]
 [-8.01612893e-03  1.83672588e-02]]
grads:  [-4.62891831e-03 -6.39110081e+00]
Stock Position:  -0.004628918305315052
Bond Position:  [4.95693526]


portfolio before change:  [4.5270198]
curr_Stock_Price:  93.00987633229943
curr_Factors:  [9.30098763e+01 4.13027908e-02]
mat_Sqrt:  [[ 1.89024791e+01  0.00000000e+00]
 [-8.12923522e-03  1.86264179e-02]]
grads:  [-1.64914283e-03 -7.59583181e+00]
Stock Position:  -0.0016491428265960745
Bond Position:  [4.68040637]


portfolio before change:  [4.52780267]
curr_Stock_Price:  92.8899437070744
curr_Factors:  [9.28899437e+01 4.14470014e-02]
mat_Sqrt:  [[ 1.89110332e+01  0.00000000e+00]
 [-8.14341465e-03  1.86589070e-02]]
grads:  [4.78639978e-03 8.10515403e+00]
Stock Position:  0.004786399776277193
Bond Position:  [4.08319427]


portfolio before change:  [4.53257481]
curr_Stock_Price:  93.78032182434299
curr_Factors:  [9.37803218e+01 4.03783213e-02]
mat_Sqrt:  [[ 1.88445534e+01  0.00000000e+00]
 [-8.03774310e-03  1.84167831e-02]]
grads:  [6.63325682e-03 9.86523087e+00]
Stock Position:  0.006633256818716676
Bond Position:  [3.91050585]


portfolio before change:  [4.52834671]
curr_Stock_Price:  93.06921650906519
curr_Factors:  [9.30692165e+01 4.08160891e-02]
mat_Sqrt:  [[ 1.88027665e+01  0.00000000e+00]
 [-8.08119685e-03  1.85163481e-02]]
grads:  [9.03523463e-03 9.37514125e+00]
Stock Position:  0.009035234625913116
Bond Position:  [3.6874445]


portfolio before change:  [4.53077996]
curr_Stock_Price:  93.28750552186762
curr_Factors:  [9.32875055e+01 3.94893940e-02]
mat_Sqrt:  [[ 1.85380357e+01  0.00000000e+00]
 [-7.94877540e-03  1.82129325e-02]]
grads:  [-0.00645929  4.79058912]
Stock Position:  -0.006459285886204478
Bond Position:  [5.13335063]


portfolio before change:  [4.52878012]
curr_Stock_Price:  93.69645978324182
curr_Factors:  [9.36964598e+01 3.71176250e-02]
mat_Sqrt:  [[ 1.80514990e+01  0.00000000e+00]
 [-7.70637399e-03  1.76575211e-02]]
grads:  [-0.01936962  2.76971427]
Stock Position:  -0.019369623499686177
Bond Position:  [6.34364527]


portfolio before change:  [4.50987747]
curr_Stock_Price:  94.71329155501384
curr_Factors:  [9.47132916e+01 3.64835040e-02]
mat_Sqrt:  [[ 1.80908595e+01  0.00000000e+00]
 [-7.64026220e-03  1.75060399e-02]]
grads:  [ 0.00896224 -5.3571713 ]
Stock Position:  0.008962238986431012
Bond Position:  [3.66103432]


portfolio before change:  [4.5087854]
curr_Stock_Price:  94.54037376076926
curr_Factors:  [9.45403738e+01 3.72899567e-02]
mat_Sqrt:  [[ 1.82563206e+01  0.00000000e+00]
 [-7.72424305e-03  1.76984642e-02]]
grads:  [-0.06948919 -7.68361848]
Stock Position:  -0.0694891880424918
Bond Position:  [11.07831921]


portfolio before change:  [4.54079053]
curr_Stock_Price:  94.09972599329664
curr_Factors:  [9.40997260e+01 3.80480389e-02]
mat_Sqrt:  [[ 1.83550046e+01  0.00000000e+00]
 [-7.80236260e-03  1.78774586e-02]]
grads:  [1.10633904e-02 1.65689068e+01]
Stock Position:  0.011063390399860231
Bond Position:  [3.49972853]


portfolio before change:  [4.54591374]
curr_Stock_Price:  94.52325954210033
curr_Factors:  [9.45232595e+01 3.76027805e-02]
mat_Sqrt:  [[ 1.83294177e+01  0.00000000e+00]
 [-7.75657456e-03  1.77725450e-02]]
grads:  [-3.63560896e-03 -7.01099644e+00]
Stock Position:  -0.0036356089621723676
Bond Position:  [4.88956335]


portfolio before change:  [4.54401902]
curr_Stock_Price:  95.21254019353071
curr_Factors:  [9.52125402e+01 3.65916932e-02]
mat_Sqrt:  [[ 1.82131643e+01  0.00000000e+00]
 [-7.65158213e-03  1.75319772e-02]]
grads:  [3.81476624e-03 4.67931596e+00]
Stock Position:  0.0038147662422054066
Bond Position:  [4.18080544]


portfolio before change:  [4.54186018]
curr_Stock_Price:  94.50961954980232
curr_Factors:  [9.45096195e+01 3.66737974e-02]
mat_Sqrt:  [[ 1.80989740e+01  0.00000000e+00]
 [-7.66016160e-03  1.75516352e-02]]
grads:  [1.40845404e-03 9.36624930e+00]
Stock Position:  0.0014084540431659705
Bond Position:  [4.40874772]


portfolio before change:  [4.54419161]
curr_Stock_Price:  95.77363578070822
curr_Factors:  [9.57736358e+01 3.59936731e-02]
mat_Sqrt:  [[ 1.81701728e+01  0.00000000e+00]
 [-7.58879944e-03  1.73881239e-02]]
grads:  [-0.0717334  -9.57097078]
Stock Position:  -0.07173340099169793
Bond Position:  [11.41436023]


portfolio before change:  [4.5852621]
curr_Stock_Price:  95.22098380068984
curr_Factors:  [9.52209838e+01 3.57320557e-02]
mat_Sqrt:  [[ 1.79995507e+01  0.00000000e+00]
 [-7.56116983e-03  1.73248165e-02]]
grads:  [2.80704236e-03 1.46770652e+01]
Stock Position:  0.0028070423582902968
Bond Position:  [4.31797277]


portfolio before change:  [4.58804353]
curr_Stock_Price:  96.0195638124045
curr_Factors:  [9.60195638e+01 3.41751521e-02]
mat_Sqrt:  [[ 1.77506784e+01  0.00000000e+00]
 [-7.39460907e-03  1.69431779e-02]]
grads:  [-4.96799126e-03  6.45461938e+00]
Stock Position:  -0.0049679912598719405
Bond Position:  [5.06506789]


portfolio before change:  [4.58557073]
curr_Stock_Price:  96.64476122943815
curr_Factors:  [9.66447612e+01 3.49449715e-02]
mat_Sqrt:  [[ 1.80663601e+01  0.00000000e+00]
 [-7.47742966e-03  1.71329437e-02]]
grads:  [0.04748354 0.17127658]
Stock Position:  0.04748353752777222
Bond Position:  [-0.00346442]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.60710651]
Stock Price:  97.09831237717714
PL:  [4.60710651]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.10667815e-01  7.78409983e-01]
 [-2.22284705e-01 -7.12652865e-02]
 [ 8.60377078e-01 -7.31178894e-01]
 [ 4.04561380e-02  2.19515916e-02]
 [-3.10537309e-02  1.57879444e-02]
 [ 8.35610245e-02  9.72091665e-02]
 [ 8.70796547e-02  6.15985399e-02]
 [ 3.57681868e-01 -8.62110618e-03]
 [ 9.08501556e-02  9.39430238e-02]
 [ 5.20773653e-01 -3.77598682e-01]
 [ 6.08041848e-02 -1.05949153e-02]
 [-9.43343348e-02 -1.77995824e-01]
 [-1.61400224e-01  1.55741661e-01]
 [-5.72114140e-01 -7.27445522e-01]
 [-1.74696732e-02 -1.96772471e-01]
 [-6.08224134e-02 -2.33355968e-01]
 [-5.16241696e-02  1.94969831e-01]
 [ 1.30236724e-01  1.57155266e-01]
 [ 1.73616417e-02  4.71386808e-03]
 [-1.12725926e-01 -2.54252837e-02]
 [ 2.00339556e-01  4.27855135e-01]
 [-1.13602068e-02  2.14753280e-01]
 [-1.16612342e-02 -1.44453467e-01]
 [ 9.31926656e-02  1.89150388e-01]
 [ 7.21800929e-02  1.51523447e-01]
 [ 7.95990302e-01 -6.65867257e-01]
 [-6.90458323e-01  8.51004663e-01]
 [ 1.23837761e-01 -1.08378169e-02]
 [-4.94832329e-02 -6.03092768e-02]
 [ 9.52979602e-02 -1.71367264e-01]
 [ 9.44435491e-02 -6.59515060e-02]
 [ 1.19523875e-01 -1.25310295e-02]
 [ 1.95796569e-01  2.13393254e-01]
 [ 2.25844802e-01  2.80550414e-02]
 [-2.24968684e-01 -2.21945996e-01]
 [ 1.12412330e-01 -2.95564071e-01]
 [-1.46019272e-01  2.28768740e-01]
 [-1.19645228e-01  1.20337418e-01]
 [-1.29382983e-01  1.32615743e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.78521074]
curr_Stock_Price:  101.3672056926747
curr_Factors:  [1.01367206e+02 4.14430370e-02]
mat_Sqrt:  [[ 2.06358927e+01  0.00000000e+00]
 [-8.14302519e-03  1.86580147e-02]]
grads:  [3.63635241e-02 4.17198720e+01]
Stock Position:  0.03636352414549812
Bond Position:  [8.09914191]


portfolio before change:  [11.80211165]
curr_Stock_Price:  101.80413961287276
curr_Factors:  [1.01804140e+02 4.21783278e-02]
mat_Sqrt:  [[ 2.09078857e+01  0.00000000e+00]
 [-8.21494519e-03  1.88228041e-02]]
grads:  [-0.01211923 -3.78611423]
Stock Position:  -0.012119227621171168
Bond Position:  [13.03589919]


portfolio before change:  [11.79567584]
curr_Stock_Price:  102.46964442338502
curr_Factors:  [1.02469644e+02 4.21261692e-02]
mat_Sqrt:  [[ 2.10315467e+01  0.00000000e+00]
 [-8.20986424e-03  1.88111622e-02]]
grads:  [ 2.57358364e-02 -3.88694164e+01]
Stock Position:  0.025735836443265905
Bond Position:  [9.15853383]


portfolio before change:  [11.76810868]
curr_Stock_Price:  101.35400003376573
curr_Factors:  [1.01354000e+02 4.27830134e-02]
mat_Sqrt:  [[ 2.09641172e+01  0.00000000e+00]
 [-8.27362203e-03  1.89572496e-02]]
grads:  [0.00238677 1.15795234]
Stock Position:  0.002386773434036095
Bond Position:  [11.52619965]


portfolio before change:  [11.76671777]
curr_Stock_Price:  100.16755280828754
curr_Factors:  [1.00167553e+02 4.48007732e-02]
mat_Sqrt:  [[ 2.12016577e+01  0.00000000e+00]
 [-8.46647726e-03  1.93991364e-02]]
grads:  [-0.00113969  0.81384779]
Stock Position:  -0.0011396895186404762
Bond Position:  [11.88087768]


portfolio before change:  [11.76545784]
curr_Stock_Price:  102.57622161098351
curr_Factors:  [1.02576222e+02 4.34158791e-02]
mat_Sqrt:  [[ 2.13732712e+01  0.00000000e+00]
 [-8.33459096e-03  1.90969470e-02]]
grads:  [0.00589459 5.09029881]
Stock Position:  0.005894585883397392
Bond Position:  [11.16081349]


portfolio before change:  [11.77165576]
curr_Stock_Price:  103.39099234791146
curr_Factors:  [1.03390992e+02 4.38048089e-02]
mat_Sqrt:  [[ 2.16393195e+01  0.00000000e+00]
 [-8.37183936e-03  1.91822938e-02]]
grads:  [0.0052665  3.21121867]
Stock Position:  0.0052664993345222025
Bond Position:  [11.22714717]


portfolio before change:  [11.77114635]
curr_Stock_Price:  103.02777298818654
curr_Factors:  [1.03027773e+02 4.35088645e-02]
mat_Sqrt:  [[ 2.14903351e+01  0.00000000e+00]
 [-8.34351144e-03  1.91173864e-02]]
grads:  [ 0.01646877 -0.45095632]
Stock Position:  0.01646876644045392
Bond Position:  [10.07440602]


portfolio before change:  [11.76558554]
curr_Stock_Price:  102.61364465339082
curr_Factors:  [1.02613645e+02 4.42432230e-02]
mat_Sqrt:  [[ 2.15838290e+01  0.00000000e+00]
 [-8.41362923e-03  1.92780464e-02]]
grads:  [0.00610875 4.87305725]
Stock Position:  0.006108751719186578
Bond Position:  [11.13874427]


portfolio before change:  [11.77632431]
curr_Stock_Price:  104.14363603379503
curr_Factors:  [1.04143636e+02 4.27432418e-02]
mat_Sqrt:  [[ 2.15311123e+01  0.00000000e+00]
 [-8.26977550e-03  1.89484361e-02]]
grads:  [ 1.65331021e-02 -1.99276964e+01]
Stock Position:  0.016533102112507518
Bond Position:  [10.05450694]


portfolio before change:  [11.7706552]
curr_Stock_Price:  103.72471854081851
curr_Factors:  [1.03724719e+02 4.16258068e-02]
mat_Sqrt:  [[ 2.11623356e+01  0.00000000e+00]
 [-8.16096140e-03  1.86991117e-02]]
grads:  [ 0.00265473 -0.56659993]
Stock Position:  0.0026547251572261784
Bond Position:  [11.49529458]


portfolio before change:  [11.77051453]
curr_Stock_Price:  103.1304296020931
curr_Factors:  [1.03130430e+02 4.29166264e-02]
mat_Sqrt:  [[ 2.13648385e+01  0.00000000e+00]
 [-8.28653138e-03  1.89868286e-02]]
grads:  [-8.05145712e-03 -9.37470008e+00]
Stock Position:  -0.008051457116931525
Bond Position:  [12.60086476]


portfolio before change:  [11.78399412]
curr_Stock_Price:  101.65189185230112
curr_Factors:  [1.01651892e+02 4.35577932e-02]
mat_Sqrt:  [[ 2.12152620e+01  0.00000000e+00]
 [-8.34820155e-03  1.91281328e-02]]
grads:  [-4.40385751e-03  8.14202112e+00]
Stock Position:  -0.004403857507640181
Bond Position:  [12.23165456]


portfolio before change:  [11.78225252]
curr_Stock_Price:  102.39457083385837
curr_Factors:  [1.02394571e+02 4.30767654e-02]
mat_Sqrt:  [[ 2.12519347e+01  0.00000000e+00]
 [-8.30197715e-03  1.90222194e-02]]
grads:  [ -0.0418596  -38.24188487]
Stock Position:  -0.04185959573146857
Bond Position:  [16.06844786]


portfolio before change:  [11.71137905]
curr_Stock_Price:  104.13568060250948
curr_Factors:  [1.04135681e+02 4.12398566e-02]
mat_Sqrt:  [[ 2.11474561e+01  0.00000000e+00]
 [-8.12303949e-03  1.86122217e-02]]
grads:  [-4.88702847e-03 -1.05722183e+01]
Stock Position:  -0.00488702847251807
Bond Position:  [12.22029308]


portfolio before change:  [11.69906222]
curr_Stock_Price:  106.96857931076069
curr_Factors:  [1.06968579e+02 4.18234238e-02]
mat_Sqrt:  [[ 2.18759045e+01  0.00000000e+00]
 [-8.18031039e-03  1.87434458e-02]]
grads:  [-7.43591228e-03 -1.24500036e+01]
Stock Position:  -0.0074359122832787115
Bond Position:  [12.49447119]


portfolio before change:  [11.7154044]
curr_Stock_Price:  104.9808909333477
curr_Factors:  [1.04980891e+02 4.29869954e-02]
mat_Sqrt:  [[ 2.17660088e+01  0.00000000e+00]
 [-8.29332217e-03  1.90023883e-02]]
grads:  [1.53761036e-03 1.02602803e+01]
Stock Position:  0.0015376103648391149
Bond Position:  [11.5539847]


portfolio before change:  [11.71910209]
curr_Stock_Price:  106.44637806457901
curr_Factors:  [1.06446378e+02 4.17832693e-02]
mat_Sqrt:  [[ 2.17586576e+01  0.00000000e+00]
 [-8.17638250e-03  1.87344459e-02]]
grads:  [0.00913774 8.38857295]
Stock Position:  0.009137737651816209
Bond Position:  [10.74642301]


portfolio before change:  [11.72557531]
curr_Stock_Price:  107.00776759791454
curr_Factors:  [1.07007768e+02 4.41194507e-02]
mat_Sqrt:  [[ 2.24765863e+01  0.00000000e+00]
 [-8.40185224e-03  1.92510619e-02]]
grads:  [0.00086396 0.24486276]
Stock Position:  0.0008639631531575828
Bond Position:  [11.63312454]


portfolio before change:  [11.72624872]
curr_Stock_Price:  106.10400679827457
curr_Factors:  [1.06104007e+02 4.49999135e-02]
mat_Sqrt:  [[ 2.25080372e+01  0.00000000e+00]
 [-8.48527322e-03  1.94422034e-02]]
grads:  [-0.00550125 -1.30773674]
Stock Position:  -0.005501253975865805
Bond Position:  [12.30995381]


portfolio before change:  [11.72747521]
curr_Stock_Price:  106.16078622145746
curr_Factors:  [1.06160786e+02 4.61473406e-02]
mat_Sqrt:  [[ 2.28053880e+01  0.00000000e+00]
 [-8.59277283e-03  1.96885160e-02]]
grads:  [1.69727805e-02 2.17312029e+01]
Stock Position:  0.01697278053254192
Bond Position:  [9.92563148]


portfolio before change:  [11.74327404]
curr_Stock_Price:  107.01851531641327
curr_Factors:  [1.07018515e+02 4.59561443e-02]
mat_Sqrt:  [[ 2.29419703e+01  0.00000000e+00]
 [-8.57495369e-03  1.96476872e-02]]
grads:  [3.59018023e-03 1.09302066e+01]
Stock Position:  0.0035901802341924333
Bond Position:  [11.35905828]


portfolio before change:  [11.73938903]
curr_Stock_Price:  105.54088024349677
curr_Factors:  [1.05540880e+02 4.61190388e-02]
mat_Sqrt:  [[ 2.26652668e+01  0.00000000e+00]
 [-8.59013748e-03  1.96824776e-02]]
grads:  [-3.2960519e-03 -7.3391912e+00]
Stock Position:  -0.003296051897581416
Bond Position:  [12.08725725]


portfolio before change:  [11.74343252]
curr_Stock_Price:  104.77254010811416
curr_Factors:  [1.04772540e+02 4.57282787e-02]
mat_Sqrt:  [[ 2.24047396e+01  0.00000000e+00]
 [-8.55366857e-03  1.95989168e-02]]
grads:  [7.84408415e-03 9.65106333e+00]
Stock Position:  0.007844084152388579
Bond Position:  [10.9215879]


portfolio before change:  [11.75082165]
curr_Stock_Price:  105.540487472282
curr_Factors:  [1.05540487e+02 4.51819224e-02]
mat_Sqrt:  [[ 2.24337279e+01  0.00000000e+00]
 [-8.50241588e-03  1.94814822e-02]]
grads:  [6.16528591e-03 7.77781923e+00]
Stock Position:  0.006165285907325099
Bond Position:  [11.10013437]


portfolio before change:  [11.75485241]
curr_Stock_Price:  105.96920436717421
curr_Factors:  [1.05969204e+02 4.50058939e-02]
mat_Sqrt:  [[ 2.24809350e+01  0.00000000e+00]
 [-8.48583704e-03  1.94434953e-02]]
grads:  [ 2.24804710e-02 -3.42462735e+01]
Stock Position:  0.02248047095525669
Bond Position:  [9.37261479]


portfolio before change:  [11.78732891]
curr_Stock_Price:  107.36173941515372
curr_Factors:  [1.07361739e+02 4.37744532e-02]
mat_Sqrt:  [[ 2.24625938e+01  0.00000000e+00]
 [-8.36893812e-03  1.91756462e-02]]
grads:  [-1.42035885e-02  4.43794516e+01]
Stock Position:  -0.014203588465990125
Bond Position:  [13.31225087]


portfolio before change:  [11.80937664]
curr_Stock_Price:  105.92663725927126
curr_Factors:  [1.05926637e+02 4.32704366e-02]
mat_Sqrt:  [[ 2.20343795e+01  0.00000000e+00]
 [-8.32061889e-03  1.90649329e-02]]
grads:  [ 0.00540554 -0.56846866]
Stock Position:  0.005405541383133427
Bond Position:  [11.23678582]


portfolio before change:  [11.81099248]
curr_Stock_Price:  105.96570000261184
curr_Factors:  [1.05965700e+02 4.36517275e-02]
mat_Sqrt:  [[ 2.21394093e+01  0.00000000e+00]
 [-8.35719833e-03  1.91487470e-02]]
grads:  [-0.00342396 -3.14951557]
Stock Position:  -0.0034239558181780824
Bond Position:  [12.17381436]


portfolio before change:  [11.80666209]
curr_Stock_Price:  107.67489670779685
curr_Factors:  [1.07674897e+02 4.40165445e-02]
mat_Sqrt:  [[ 2.25903228e+01  0.00000000e+00]
 [-8.39204809e-03  1.92285978e-02]]
grads:  [ 9.07784924e-04 -8.91210404e+00]
Stock Position:  0.0009077849238446233
Bond Position:  [11.70891644]


portfolio before change:  [11.80662727]
curr_Stock_Price:  106.02414784001084
curr_Factors:  [1.06024148e+02 4.41785003e-02]
mat_Sqrt:  [[ 2.22848787e+01  0.00000000e+00]
 [-8.40747289e-03  1.92639405e-02]]
grads:  [ 2.94639037e-03 -3.42357298e+00]
Stock Position:  0.0029463903705368977
Bond Position:  [11.49423875]


portfolio before change:  [11.8088175]
curr_Stock_Price:  106.2798363315027
curr_Factors:  [1.06279836e+02 4.44208696e-02]
mat_Sqrt:  [[ 2.23998136e+01  0.00000000e+00]
 [-8.43050362e-03  1.93167105e-02]]
grads:  [ 0.00509178 -0.64871447]
Stock Position:  0.005091778309044689
Bond Position:  [11.26766414]


portfolio before change:  [11.8020453]
curr_Stock_Price:  104.67317814123597
curr_Factors:  [1.04673178e+02 4.49652007e-02]
mat_Sqrt:  [[ 2.21959470e+01  0.00000000e+00]
 [-8.48199983e-03  1.94347031e-02]]
grads:  [ 0.0130172  10.98001099]
Stock Position:  0.013017197253566431
Bond Position:  [10.43949389]


portfolio before change:  [11.8140061]
curr_Stock_Price:  105.49177049038705
curr_Factors:  [1.05491770e+02 4.47382387e-02]
mat_Sqrt:  [[ 2.23130029e+01  0.00000000e+00]
 [-8.46056629e-03  1.93855927e-02]]
grads:  [0.01067042 1.44721092]
Stock Position:  0.010670416089928272
Bond Position:  [10.68836501]


portfolio before change:  [11.80251152]
curr_Stock_Price:  104.2893145671947
curr_Factors:  [1.04289315e+02 4.46750808e-02]
mat_Sqrt:  [[ 2.20430906e+01  0.00000000e+00]
 [-8.45459220e-03  1.93719044e-02]]
grads:  [ -0.01460021 -11.45710776]
Stock Position:  -0.014600214799770422
Bond Position:  [13.32515791]


portfolio before change:  [11.81162449]
curr_Stock_Price:  103.7792385380553
curr_Factors:  [1.03779239e+02 4.51835477e-02]
mat_Sqrt:  [[ 2.20597529e+01  0.00000000e+00]
 [-8.50256880e-03  1.94818326e-02]]
grads:  [-7.51704058e-04 -1.51712663e+01]
Stock Position:  -0.0007517040580013141
Bond Position:  [11.88963576]


portfolio before change:  [11.81382137]
curr_Stock_Price:  102.83394019062563
curr_Factors:  [1.02833940e+02 4.66579076e-02]
mat_Sqrt:  [[ 2.22125852e+01  0.00000000e+00]
 [-8.64017662e-03  1.97971317e-02]]
grads:  [-2.07883991e-03  1.15556507e+01]
Stock Position:  -0.0020788399063556458
Bond Position:  [12.02759667]


portfolio before change:  [11.81213888]
curr_Stock_Price:  104.36654054371222
curr_Factors:  [1.04366541e+02 4.56713306e-02]
mat_Sqrt:  [[ 2.23040187e+01  0.00000000e+00]
 [-8.54834072e-03  1.95867092e-02]]
grads:  [-3.00957753e-03  6.14383030e+00]
Stock Position:  -0.003009577528645115
Bond Position:  [12.12623808]


portfolio before change:  [11.81196065]
curr_Stock_Price:  104.92944636324009
curr_Factors:  [1.04929446e+02 4.38551633e-02]
mat_Sqrt:  [[ 2.19739306e+01  0.00000000e+00]
 [-8.37664976e-03  1.91933158e-02]]
grads:  [-3.25407089e-03  6.90947540e+00]
Stock Position:  -0.0032540708909204515
Bond Position:  [12.15340851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.81379487]
Stock Price:  104.83265873428061
PL:  [6.98113614]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.56888421e-01 -4.70457317e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.46337704e-01 -7.60618279e-01]
 [-2.94868839e-02  3.15797607e-02]
 [-1.98578765e-03  4.15466686e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [ 3.78898346e-03  3.16045299e-01]
 [ 2.75765882e-01 -2.11570598e-03]
 [ 1.19044498e-01  8.50748478e-02]
 [ 3.26400853e-01 -1.55629274e-01]
 [ 6.98723552e-02  2.07159498e-02]
 [-1.38043294e-01 -1.03116829e-01]
 [-4.89145519e-02  1.18992147e-01]
 [-2.71725627e-01 -3.74686715e-01]
 [ 8.41439322e-02  2.28628028e-01]
 [ 5.21251795e-02 -1.92097249e-02]
 [-5.12965345e-02  1.76552403e-01]
 [-3.66229040e-02  2.53067818e-02]
 [ 1.50239229e-02  6.27597792e-02]
 [-5.48876936e-02 -6.21397290e-02]
 [ 1.29351217e-01  3.51834417e-02]
 [ 1.67239229e-02  1.09829128e-01]
 [ 3.66376470e-02  3.52308480e-01]
 [-4.28508633e-02  1.35380795e-01]
 [ 1.52679856e-02  3.67159584e-02]
 [ 5.05109907e-02  9.00872429e-02]
 [ 5.67368158e-02  2.04978880e-01]
 [-1.91029544e-01  1.39411711e-01]
 [-1.66113523e-02 -1.28832619e-01]
 [ 9.72809740e-02 -6.90588366e-02]
 [-9.32559684e-01 -1.08348912e-01]
 [-1.18174752e-01  9.29378594e-03]
 [-3.68864100e-03 -9.02398827e-02]
 [ 8.21929359e-02  1.01754789e-01]
 [-1.31110569e-01  1.06416091e-01]
 [-6.77873850e-01 -2.78182998e-01]
 [-2.16998151e-02  3.04320176e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 9.32558292e-01 -6.98537422e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.11155953]
curr_Stock_Price:  98.97289479417523
curr_Factors:  [9.89728948e+01 4.11274062e-02]
mat_Sqrt:  [[ 2.00715972e+01  0.00000000e+00]
 [-8.11195722e-03  1.85868290e-02]]
grads:  [-0.01382156 -2.53113276]
Stock Position:  -0.013821563799415989
Bond Position:  [-2.74359935]


portfolio before change:  [-4.11927192]
curr_Stock_Price:  99.50607705573663
curr_Factors:  [9.95060771e+01 4.10820720e-02]
mat_Sqrt:  [[ 2.01686010e+01  0.00000000e+00]
 [-8.10748513e-03  1.85765822e-02]]
grads:  [-0.01006438 -4.73775905]
Stock Position:  -0.0100643791748824
Bond Position:  [-3.11780503]


portfolio before change:  [-4.11011953]
curr_Stock_Price:  98.55796751965629
curr_Factors:  [9.85579675e+01 4.30264362e-02]
mat_Sqrt:  [[ 2.04436966e+01  0.00000000e+00]
 [-8.29712588e-03  1.90111037e-02]]
grads:  [ 2.51606489e-02 -4.00091594e+01]
Stock Position:  0.025160648917755553
Bond Position:  [-6.58990195]


portfolio before change:  [-4.07769167]
curr_Stock_Price:  99.87954130046255
curr_Factors:  [9.98795413e+01 4.27848664e-02]
mat_Sqrt:  [[ 2.06595867e+01  0.00000000e+00]
 [-8.27380120e-03  1.89576601e-02]]
grads:  [-7.60148141e-04  1.66580477e+00]
Stock Position:  -0.0007601481410051867
Bond Position:  [-4.00176842]


portfolio before change:  [-4.07816863]
curr_Stock_Price:  99.84889963948841
curr_Factors:  [9.98488996e+01 4.31728489e-02]
mat_Sqrt:  [[ 2.07466814e+01  0.00000000e+00]
 [-8.31123085e-03  1.90434222e-02]]
grads:  [-8.31662512e-06  2.18168080e-01]
Stock Position:  -8.31662512322489e-06
Bond Position:  [-4.07733822]


portfolio before change:  [-4.07867241]
curr_Stock_Price:  99.13790855838373
curr_Factors:  [9.91379086e+01 4.19673182e-02]
mat_Sqrt:  [[ 2.03093190e+01  0.00000000e+00]
 [-8.19437058e-03  1.87756617e-02]]
grads:  [-0.00583086 -3.53206875]
Stock Position:  -0.0058308588065123425
Bond Position:  [-3.50061327]


portfolio before change:  [-4.09027616]
curr_Stock_Price:  101.05291600070164
curr_Factors:  [1.01052916e+02 4.08006701e-02]
mat_Sqrt:  [[ 2.04118561e+01  0.00000000e+00]
 [-8.07967030e-03  1.85128504e-02]]
grads:  [6.94314420e-03 1.70716715e+01]
Stock Position:  0.006943144199717463
Bond Position:  [-4.79190112]


portfolio before change:  [-4.08410254]
curr_Stock_Price:  102.02835928510945
curr_Factors:  [1.02028359e+02 4.07365363e-02]
mat_Sqrt:  [[ 2.05926839e+01  0.00000000e+00]
 [-8.07331766e-03  1.84982946e-02]]
grads:  [ 0.01334661 -0.11437303]
Stock Position:  0.013346609611298122
Bond Position:  [-5.44583522]


portfolio before change:  [-4.08989777]
curr_Stock_Price:  101.64515657302422
curr_Factors:  [1.01645157e+02 4.00620857e-02]
mat_Sqrt:  [[ 2.03448020e+01  0.00000000e+00]
 [-8.00620616e-03  1.83445229e-02]]
grads:  [0.00767637 4.63761572]
Stock Position:  0.007676368923371713
Bond Position:  [-4.87016349]


portfolio before change:  [-4.09287837]
curr_Stock_Price:  101.3361824684268
curr_Factors:  [1.01336182e+02 4.22045984e-02]
mat_Sqrt:  [[ 2.08182599e+01  0.00000000e+00]
 [-8.21750312e-03  1.88286650e-02]]
grads:  [ 0.01241596 -8.26555011]
Stock Position:  0.012415959398740795
Bond Position:  [-5.3510643]


portfolio before change:  [-4.09902113]
curr_Stock_Price:  100.89531176699984
curr_Factors:  [1.00895312e+02 4.26804780e-02]
mat_Sqrt:  [[ 2.08442188e+01  0.00000000e+00]
 [-8.26370164e-03  1.89345192e-02]]
grads:  [0.00378587 1.09408375]
Stock Position:  0.0037858716357569585
Bond Position:  [-4.48099783]


portfolio before change:  [-4.0991471]
curr_Stock_Price:  101.00999968472246
curr_Factors:  [1.01010000e+02 4.31669902e-02]
mat_Sqrt:  [[ 2.09865115e+01  0.00000000e+00]
 [-8.31066690e-03  1.90421301e-02]]
grads:  [-0.00872213 -5.415194  ]
Stock Position:  -0.008722134109324368
Bond Position:  [-3.21812433]


portfolio before change:  [-4.0949335]
curr_Stock_Price:  100.48078394960876
curr_Factors:  [1.00480784e+02 4.26998418e-02]
mat_Sqrt:  [[ 2.07632889e+01  0.00000000e+00]
 [-8.26557601e-03  1.89388139e-02]]
grads:  [1.45346844e-04 6.28297778e+00]
Stock Position:  0.00014534684397761664
Bond Position:  [-4.10953806]


portfolio before change:  [-4.09567433]
curr_Stock_Price:  98.91825108791572
curr_Factors:  [9.89182511e+01 4.23258459e-02]
mat_Sqrt:  [[ 2.03506953e+01  0.00000000e+00]
 [-8.22929848e-03  1.88556916e-02]]
grads:  [ -0.02138759 -19.87127932]
Stock Position:  -0.021387589384086258
Bond Position:  [-1.98005139]


portfolio before change:  [-4.09200917]
curr_Stock_Price:  98.73530932941526
curr_Factors:  [9.87353093e+01 4.34846656e-02]
mat_Sqrt:  [[ 2.05892515e+01  0.00000000e+00]
 [-8.34119086e-03  1.91120692e-02]]
grads:  [8.93307774e-03 1.19624948e+01]
Stock Position:  0.008933077741558512
Bond Position:  [-4.97401936]


portfolio before change:  [-4.09343044]
curr_Stock_Price:  98.64581260998939
curr_Factors:  [9.86458126e+01 4.25781353e-02]
mat_Sqrt:  [[ 2.03550406e+01  0.00000000e+00]
 [-8.25378801e-03  1.89118042e-02]]
grads:  [ 0.00214892 -1.01575316]
Stock Position:  0.002148920706196012
Bond Position:  [-4.30541247]


portfolio before change:  [-4.09191975]
curr_Stock_Price:  99.59926702738156
curr_Factors:  [9.95992670e+01 4.17088763e-02]
mat_Sqrt:  [[ 2.03409104e+01  0.00000000e+00]
 [-8.16910045e-03  1.87177606e-02]]
grads:  [1.26627819e-03 9.43234646e+00]
Stock Position:  0.001266278188055091
Bond Position:  [-4.21804013]


portfolio before change:  [-4.09278473]
curr_Stock_Price:  99.33258859693034
curr_Factors:  [9.93325886e+01 4.18623952e-02]
mat_Sqrt:  [[ 2.03237475e+01  0.00000000e+00]
 [-8.18412074e-03  1.87521764e-02]]
grads:  [-1.25853359e-03  1.34953839e+00]
Stock Position:  -0.0012585335911146796
Bond Position:  [-3.96777133]


portfolio before change:  [-4.09525464]
curr_Stock_Price:  100.90100770508529
curr_Factors:  [1.00901008e+02 3.99408524e-02]
mat_Sqrt:  [[ 2.01652759e+01  0.00000000e+00]
 [-7.99408305e-03  1.83167453e-02]]
grads:  [2.10334519e-03 3.42636086e+00]
Stock Position:  0.0021033451936140137
Bond Position:  [-4.30748429]


portfolio before change:  [-4.09543083]
curr_Stock_Price:  101.07324729264438
curr_Factors:  [1.01073247e+02 3.94242175e-02]
mat_Sqrt:  [[ 2.00686316e+01  0.00000000e+00]
 [-7.94221304e-03  1.81978962e-02]]
grads:  [-0.00408636 -3.41466553]
Stock Position:  -0.0040863620648217995
Bond Position:  [-3.68240895]


portfolio before change:  [-4.09307145]
curr_Stock_Price:  100.38321671236187
curr_Factors:  [1.00383217e+02 4.14426276e-02]
mat_Sqrt:  [[ 2.04354756e+01  0.00000000e+00]
 [-8.14298496e-03  1.86579225e-02]]
grads:  [0.00708114 1.88571057]
Stock Position:  0.007081143217487383
Bond Position:  [-4.80389938]


portfolio before change:  [-4.08188799]
curr_Stock_Price:  102.04735227200128
curr_Factors:  [1.02047352e+02 4.09301826e-02]
mat_Sqrt:  [[ 2.06454133e+01  0.00000000e+00]
 [-8.09248368e-03  1.85422095e-02]]
grads:  [3.13179898e-03 5.92319531e+00]
Stock Position:  0.003131798976140576
Bond Position:  [-4.40147978]


portfolio before change:  [-4.08356005]
curr_Stock_Price:  101.68914368154523
curr_Factors:  [1.01689144e+02 4.08862578e-02]
mat_Sqrt:  [[ 2.05619014e+01  0.00000000e+00]
 [-8.08814024e-03  1.85322574e-02]]
grads:  [9.25973089e-03 1.90105539e+01]
Stock Position:  0.009259730889973459
Bond Position:  [-5.02517415]


portfolio before change:  [-4.10503864]
curr_Stock_Price:  99.4374145375825
curr_Factors:  [9.94374145e+01 4.24758288e-02]
mat_Sqrt:  [[ 2.04937179e+01  0.00000000e+00]
 [-8.24386597e-03  1.88890699e-02]]
grads:  [7.92152966e-04 7.16714985e+00]
Stock Position:  0.0007921529660787917
Bond Position:  [-4.18380828]


portfolio before change:  [-4.10577038]
curr_Stock_Price:  99.173914542139
curr_Factors:  [9.91739145e+01 4.20389058e-02]
mat_Sqrt:  [[ 2.03340158e+01  0.00000000e+00]
 [-8.20135655e-03  1.87916686e-02]]
grads:  [1.53890622e-03 1.95384238e+00]
Stock Position:  0.0015389062245126702
Bond Position:  [-4.25838973]


portfolio before change:  [-4.11086213]
curr_Stock_Price:  96.21114793966576
curr_Factors:  [9.62111479e+01 4.40602559e-02]
mat_Sqrt:  [[ 2.01952347e+01  0.00000000e+00]
 [-8.39621400e-03  1.92381431e-02]]
grads:  [4.44799421e-03 4.68274108e+00]
Stock Position:  0.004447994205923114
Bond Position:  [-4.53880876]


portfolio before change:  [-4.10656987]
curr_Stock_Price:  97.30369495501525
curr_Factors:  [9.73036950e+01 4.50410149e-02]
mat_Sqrt:  [[ 2.06506353e+01  0.00000000e+00]
 [-8.48914741e-03  1.94510803e-02]]
grads:  [7.07953685e-03 1.05381746e+01]
Stock Position:  0.0070795368545233895
Bond Position:  [-4.79543497]


portfolio before change:  [-4.10321628]
curr_Stock_Price:  97.86207353244012
curr_Factors:  [9.78620735e+01 4.46962627e-02]
mat_Sqrt:  [[ 2.06895011e+01  0.00000000e+00]
 [-8.45659626e-03  1.93764962e-02]]
grads:  [-6.29233563e-03  7.19488752e+00]
Stock Position:  -0.006292335634591011
Bond Position:  [-3.48743527]


portfolio before change:  [-4.11211226]
curr_Stock_Price:  99.20657000876554
curr_Factors:  [9.92065700e+01 4.33497684e-02]
mat_Sqrt:  [[ 2.06554103e+01  0.00000000e+00]
 [-8.32824288e-03  1.90824017e-02]]
grads:  [-3.52636507e-03 -6.75138389e+00]
Stock Position:  -0.0035263650655275617
Bond Position:  [-3.76227368]


portfolio before change:  [-4.10671175]
curr_Stock_Price:  97.54173364066155
curr_Factors:  [9.75417336e+01 4.40460233e-02]
mat_Sqrt:  [[ 2.04712246e+01  0.00000000e+00]
 [-8.39485779e-03  1.92350356e-02]]
grads:  [ 3.27978556e-03 -3.59026299e+00]
Stock Position:  0.00327978556228836
Bond Position:  [-4.42662772]


portfolio before change:  [-4.1082474]
curr_Stock_Price:  97.24223732048831
curr_Factors:  [9.72422373e+01 4.43536711e-02]
mat_Sqrt:  [[ 2.04795179e+01  0.00000000e+00]
 [-8.42412451e-03  1.93020941e-02]]
grads:  [-0.04784522 -5.6133242 ]
Stock Position:  -0.04784521942231076
Bond Position:  [0.54432878]


portfolio before change:  [-4.16338324]
curr_Stock_Price:  98.3960389258251
curr_Factors:  [9.83960389e+01 4.20004358e-02]
mat_Sqrt:  [[ 2.01652919e+01  0.00000000e+00]
 [-8.19760314e-03  1.87830685e-02]]
grads:  [-0.00565916  0.49479594]
Stock Position:  -0.00565915986413162
Bond Position:  [-3.60654433]


portfolio before change:  [-4.16107735]
curr_Stock_Price:  97.90891055900275
curr_Factors:  [9.79089106e+01 4.25229399e-02]
mat_Sqrt:  [[ 2.01898857e+01  0.00000000e+00]
 [-8.24843645e-03  1.88995422e-02]]
grads:  [-2.13337288e-03 -4.77471262e+00]
Stock Position:  -0.0021333728842420348
Bond Position:  [-3.95220114]


portfolio before change:  [-4.16128958]
curr_Stock_Price:  97.77680700081058
curr_Factors:  [9.77768070e+01 4.21414877e-02]
mat_Sqrt:  [[ 2.00720062e+01  0.00000000e+00]
 [-8.21135679e-03  1.88145820e-02]]
grads:  [0.00630741 5.40829389]
Stock Position:  0.006307409702053488
Bond Position:  [-4.77800796]


portfolio before change:  [-4.15898313]
curr_Stock_Price:  98.23717715449187
curr_Factors:  [9.82371772e+01 4.19407718e-02]
mat_Sqrt:  [[ 2.01184299e+01  0.00000000e+00]
 [-8.19177849e-03  1.87697225e-02]]
grads:  [-4.20841885e-03  5.66956121e+00]
Stock Position:  -0.004208418853788953
Bond Position:  [-3.74555994]


portfolio before change:  [-4.15960608]
curr_Stock_Price:  98.27394424016323
curr_Factors:  [9.82739442e+01 4.24099184e-02]
mat_Sqrt:  [[ 2.02382103e+01  0.00000000e+00]
 [-8.23746742e-03  1.88744090e-02]]
grads:  [ -0.03949375 -14.73863357]
Stock Position:  -0.03949375217892237
Bond Position:  [-0.27839928]


portfolio before change:  [-4.12849601]
curr_Stock_Price:  97.48534154285447
curr_Factors:  [9.74853415e+01 4.29195501e-02]
mat_Sqrt:  [[ 2.01960714e+01  0.00000000e+00]
 [-8.28681364e-03  1.89874754e-02]]
grads:  [5.50188183e-03 1.60274165e+01]
Stock Position:  0.005501881833892068
Bond Position:  [-4.66484884]


portfolio before change:  [-4.1280488]
curr_Stock_Price:  97.6726137532091
curr_Factors:  [9.76726138e+01 4.29380212e-02]
mat_Sqrt:  [[ 2.02392224e+01  0.00000000e+00]
 [-8.28859662e-03  1.89915607e-02]]
grads:  [-4.35714444e-03  5.75844008e+00]
Stock Position:  -0.004357144440025595
Bond Position:  [-3.70247511]


portfolio before change:  [-4.12094738]
curr_Stock_Price:  95.93655424842355
curr_Factors:  [9.59365542e+01 4.49618974e-02]
mat_Sqrt:  [[ 2.03425987e+01  0.00000000e+00]
 [-8.48168827e-03  1.94339893e-02]]
grads:  [ 0.04569277 -0.35944109]
Stock Position:  0.0456927671583801
Bond Position:  [-8.50455401]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.1474757]
Stock Price:  95.37924095809358
PL:  [-4.1474757]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.09307333e-01  3.95379707e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.25128908e-01 -7.11794764e-01]
 [-4.69061646e-02  7.63269241e-02]
 [ 2.16911073e-02 -5.32105997e-03]
 [-8.33697685e-02 -9.12385990e-02]
 [-2.36523429e-02  2.41774626e-01]
 [-6.89015896e-02 -7.69647936e-02]
 [ 1.61732966e-01  7.78663378e-02]
 [ 1.45864809e-01  2.48489898e-02]
 [ 1.21983267e-01  2.05365725e-01]
 [ 1.68910523e-01  2.66048065e-01]
 [ 2.75155970e-01  2.28336188e-02]
 [-1.85295915e-02  7.99444031e-02]
 [ 9.88283547e-02  2.39145271e-01]
 [ 3.02024933e-02  2.65025634e-01]
 [ 1.81898495e-01  4.69649836e-01]
 [ 1.54257550e-01  7.70760010e-02]
 [ 2.63216886e-02 -4.76919350e-02]
 [ 4.69610000e-01 -1.27376415e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-8.26129737e-03 -1.53238466e-02]
 [-9.84907781e-02  5.33543758e-02]
 [ 9.29733532e-02 -4.19398012e-01]
 [ 7.55536761e-02  2.64499799e-01]
 [ 2.42975718e-02  1.61382225e-01]
 [ 1.68238797e-02  1.60078928e-01]
 [-1.46787392e-01  6.22077628e-02]
 [-4.97125069e-01  1.08251958e-01]
 [ 2.92776884e-01 -9.96625693e-03]
 [-1.81066682e+00 -2.03100961e-01]
 [ 3.68257536e-01  6.71257776e-01]
 [ 8.63366900e-02 -1.60720332e-01]
 [ 3.62600513e-01 -8.42129980e-02]
 [ 6.01485224e-02  1.84794832e-01]
 [-2.20186713e+00  5.10546891e-01]
 [-2.34157272e-01 -8.85025090e-02]
 [-1.28289846e-01 -7.27418732e-01]
 [ 2.40141998e+00 -1.97902697e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.30361736]
curr_Stock_Price:  100.24035663665305
curr_Factors:  [1.00240357e+02 3.89280375e-02]
mat_Sqrt:  [[ 1.97776122e+01  0.00000000e+00]
 [-7.89207577e-03  1.80830173e-02]]
grads:  [1.42517297e-02 2.18646977e+01]
Stock Position:  0.014251729715105995
Bond Position:  [2.87501889]


portfolio before change:  [4.29450198]
curr_Stock_Price:  99.5755408360279
curr_Factors:  [9.95755408e+01 3.80661883e-02]
mat_Sqrt:  [[ 1.94277439e+01  0.00000000e+00]
 [-7.80422330e-03  1.78817220e-02]]
grads:  [-0.01044817 -4.92186212]
Stock Position:  -0.010448173967356807
Bond Position:  [5.33488456]


portfolio before change:  [4.29678222]
curr_Stock_Price:  99.42112772445675
curr_Factors:  [9.94211277e+01 3.66001866e-02]
mat_Sqrt:  [[ 1.90204302e+01  0.00000000e+00]
 [-7.65247009e-03  1.75340117e-02]]
grads:  [ 2.70486103e-02 -4.05950889e+01]
Stock Position:  0.027048610347473957
Bond Position:  [1.60757887]


portfolio before change:  [4.29233737]
curr_Stock_Price:  99.2493698786252
curr_Factors:  [9.92493699e+01 3.78097685e-02]
mat_Sqrt:  [[ 1.92987761e+01  0.00000000e+00]
 [-7.77789365e-03  1.78213932e-02]]
grads:  [-7.04415859e-04  4.28288200e+00]
Stock Position:  -0.0007044158587999671
Bond Position:  [4.3622502]


portfolio before change:  [4.29280066]
curr_Stock_Price:  99.3658096588976
curr_Factors:  [9.93658097e+01 3.78081842e-02]
mat_Sqrt:  [[ 1.93210127e+01  0.00000000e+00]
 [-7.77773070e-03  1.78210198e-02]]
grads:  [ 0.00100247 -0.29858336]
Stock Position:  0.0010024736618889044
Bond Position:  [4.19318905]


portfolio before change:  [4.29250785]
curr_Stock_Price:  98.55083109985733
curr_Factors:  [9.85508311e+01 3.83609950e-02]
mat_Sqrt:  [[ 1.93021294e+01  0.00000000e+00]
 [-7.83438523e-03  1.79508317e-02]]
grads:  [-0.00638217 -5.08269481]
Stock Position:  -0.006382174481334979
Bond Position:  [4.92147645]


portfolio before change:  [4.28673285]
curr_Stock_Price:  99.55209132949626
curr_Factors:  [9.95520913e+01 3.77116546e-02]
mat_Sqrt:  [[ 1.93325072e+01  0.00000000e+00]
 [-7.76779553e-03  1.77982555e-02]]
grads:  [4.23466826e-03 1.35841755e+01]
Stock Position:  0.004234668256132526
Bond Position:  [3.86516277]


portfolio before change:  [4.28461148]
curr_Stock_Price:  98.93703798293231
curr_Factors:  [9.89370380e+01 3.74765269e-02]
mat_Sqrt:  [[ 1.91530778e+01  0.00000000e+00]
 [-7.74354202e-03  1.77426837e-02]]
grads:  [-0.00535119 -4.3378327 ]
Stock Position:  -0.005351191105733424
Bond Position:  [4.81404248]


portfolio before change:  [4.28399835]
curr_Stock_Price:  99.16407687112994
curr_Factors:  [9.91640769e+01 3.76159026e-02]
mat_Sqrt:  [[ 1.92326938e+01  0.00000000e+00]
 [-7.75792782e-03  1.77756457e-02]]
grads:  [0.01017625 4.38050684]
Stock Position:  0.01017624592032212
Bond Position:  [3.27488031]


portfolio before change:  [4.27560835]
curr_Stock_Price:  98.29937839074925
curr_Factors:  [9.82993784e+01 3.66758479e-02]
mat_Sqrt:  [[ 1.88252544e+01  0.00000000e+00]
 [-7.66037575e-03  1.75521259e-02]]
grads:  [0.00832445 1.41572536]
Stock Position:  0.008324445157336364
Bond Position:  [3.45732056]


portfolio before change:  [4.27765392]
curr_Stock_Price:  98.49319089147014
curr_Factors:  [9.84931909e+01 3.56825039e-02]
mat_Sqrt:  [[ 1.86051797e+01  0.00000000e+00]
 [-7.55592524e-03  1.73127997e-02]]
grads:  [1.13738336e-02 1.18620748e+01]
Stock Position:  0.011373833579128939
Bond Position:  [3.15740876]


portfolio before change:  [4.252866]
curr_Stock_Price:  96.2791067164325
curr_Factors:  [9.62791067e+01 3.63440696e-02]
mat_Sqrt:  [[ 1.83547651e+01  0.00000000e+00]
 [-7.62564826e-03  1.74725552e-02]]
grads:  [ 0.01552858 15.22662611]
Stock Position:  0.015528578935911834
Bond Position:  [2.75778829]


portfolio before change:  [4.2404715]
curr_Stock_Price:  95.45873281040973
curr_Factors:  [9.54587328e+01 3.57805142e-02]
mat_Sqrt:  [[ 1.80567237e+01  0.00000000e+00]
 [-7.56629518e-03  1.73365602e-02]]
grads:  [0.01579032 1.31707897]
Stock Position:  0.015790316219549766
Bond Position:  [2.73314792]


portfolio before change:  [4.2245586]
curr_Stock_Price:  94.42933159383196
curr_Factors:  [9.44293316e+01 3.65285794e-02]
mat_Sqrt:  [[ 1.80477600e+01  0.00000000e+00]
 [-7.64498051e-03  1.75168509e-02]]
grads:  [9.06539453e-04 4.56385702e+00]
Stock Position:  0.0009065394526226956
Bond Position:  [4.13895468]


portfolio before change:  [4.22517024]
curr_Stock_Price:  94.53328817251273
curr_Factors:  [9.45332882e+01 3.65112431e-02]
mat_Sqrt:  [[ 1.80633407e+01  0.00000000e+00]
 [-7.64316616e-03  1.75126937e-02]]
grads:  [1.12492983e-02 1.36555389e+01]
Stock Position:  0.011249298278842497
Bond Position:  [3.16173708]


portfolio before change:  [4.20377955]
curr_Stock_Price:  92.59664063503243
curr_Factors:  [9.25966406e+01 3.71489943e-02]
mat_Sqrt:  [[ 1.78471454e+01  0.00000000e+00]
 [-7.70962975e-03  1.76649810e-02]]
grads:  [8.17324896e-03 1.50028825e+01]
Stock Position:  0.008173248959461324
Bond Position:  [3.44696416]


portfolio before change:  [4.20622029]
curr_Stock_Price:  92.84254478661347
curr_Factors:  [9.28425448e+01 3.65698156e-02]
mat_Sqrt:  [[ 1.77544990e+01  0.00000000e+00]
 [-7.64929441e-03  1.75267353e-02]]
grads:  [2.17899975e-02 2.67961961e+01]
Stock Position:  0.021789997498313764
Bond Position:  [2.18318147]


portfolio before change:  [4.21061378]
curr_Stock_Price:  93.03164882072883
curr_Factors:  [9.30316488e+01 3.66186397e-02]
mat_Sqrt:  [[ 1.78025339e+01  0.00000000e+00]
 [-7.65439897e-03  1.75384313e-02]]
grads:  [0.01055447 4.39469183]
Stock Position:  0.010554468002666144
Bond Position:  [3.22871422]


portfolio before change:  [4.22171319]
curr_Stock_Price:  94.04503974203675
curr_Factors:  [9.40450397e+01 3.70117222e-02]
mat_Sqrt:  [[ 1.80927899e+01  0.00000000e+00]
 [-7.69537234e-03  1.76323131e-02]]
grads:  [ 3.04387644e-04 -2.70480309e+00]
Stock Position:  0.0003043876440201614
Bond Position:  [4.19308705]


portfolio before change:  [4.22182993]
curr_Stock_Price:  92.70650460041976
curr_Factors:  [9.27065046e+01 3.74153206e-02]
mat_Sqrt:  [[ 1.79322565e+01  0.00000000e+00]
 [-7.73721609e-03  1.77281892e-02]]
grads:  [ 0.02308791 -7.18496477]
Stock Position:  0.02308791282853606
Bond Position:  [2.08143023]


portfolio before change:  [4.20165909]
curr_Stock_Price:  91.82158119698519
curr_Factors:  [9.18215812e+01 3.82125839e-02]
mat_Sqrt:  [[ 1.79493187e+01  0.00000000e+00]
 [-7.81921570e-03  1.79160739e-02]]
grads:  [ 0.00234709 -2.10860872]
Stock Position:  0.0023470868860581504
Bond Position:  [3.98614586]


portfolio before change:  [4.2020076]
curr_Stock_Price:  91.7577600166249
curr_Factors:  [9.17577600e+01 3.78250013e-02]
mat_Sqrt:  [[ 1.78456462e+01  0.00000000e+00]
 [-7.77946027e-03  1.78249828e-02]]
grads:  [-8.37692966e-04 -8.59683668e-01]
Stock Position:  -0.0008376929663462546
Bond Position:  [4.27887243]


portfolio before change:  [4.20334514]
curr_Stock_Price:  90.79959583420472
curr_Factors:  [9.07995958e+01 3.73924745e-02]
mat_Sqrt:  [[ 1.75580394e+01  0.00000000e+00]
 [-7.73485353e-03  1.77227759e-02]]
grads:  [-0.00428322  3.01049769]
Stock Position:  -0.004283224217938555
Bond Position:  [4.59226016]


portfolio before change:  [4.20544797]
curr_Stock_Price:  90.44267654648152
curr_Factors:  [9.04426765e+01 3.87907837e-02]
mat_Sqrt:  [[ 1.78130252e+01  0.00000000e+00]
 [-7.87815041e-03  1.80511103e-02]]
grads:  [-5.05624084e-03 -2.32339178e+01]
Stock Position:  -0.005056240839406823
Bond Position:  [4.66274792]


portfolio before change:  [4.20552981]
curr_Stock_Price:  90.54176941379076
curr_Factors:  [9.05417694e+01 3.89648723e-02]
mat_Sqrt:  [[ 1.78725124e+01  0.00000000e+00]
 [-7.89580874e-03  1.80915706e-02]]
grads:  [1.06862901e-02 1.46200573e+01]
Stock Position:  0.010686290126223056
Bond Position:  [3.2379742]


portfolio before change:  [4.21401383]
curr_Stock_Price:  91.29780784138964
curr_Factors:  [9.12978078e+01 3.83549195e-02]
mat_Sqrt:  [[ 1.78801389e+01  0.00000000e+00]
 [-7.83376481e-03  1.79494101e-02]]
grads:  [5.29808800e-03 8.99094868e+00]
Stock Position:  0.0052980880028810715
Bond Position:  [3.73031001]


portfolio before change:  [4.21081122]
curr_Stock_Price:  90.60530779456269
curr_Factors:  [9.06053078e+01 4.01121073e-02]
mat_Sqrt:  [[ 1.81464376e+01  0.00000000e+00]
 [-8.01120289e-03  1.83559718e-02]]
grads:  [4.77713883e-03 8.72080920e+00]
Stock Position:  0.004777138827227324
Bond Position:  [3.77797709]


portfolio before change:  [4.21278605]
curr_Stock_Price:  90.91983777531516
curr_Factors:  [9.09198378e+01 3.97681662e-02]
mat_Sqrt:  [[ 1.81311952e+01  0.00000000e+00]
 [-7.97678293e-03  1.82771058e-02]]
grads:  [-0.00659845  3.40358936]
Stock Position:  -0.006598445219424183
Bond Position:  [4.81271562]


portfolio before change:  [4.20894703]
curr_Stock_Price:  91.59282184088332
curr_Factors:  [9.15928218e+01 4.12000352e-02]
mat_Sqrt:  [[ 1.85913203e+01  0.00000000e+00]
 [-8.11911672e-03  1.86032335e-02]]
grads:  [-0.02419839  5.81898618]
Stock Position:  -0.024198391212484332
Bond Position:  [6.42534597]


portfolio before change:  [4.25932446]
curr_Stock_Price:  89.54416446194283
curr_Factors:  [8.95441645e+01 4.21396476e-02]
mat_Sqrt:  [[ 1.83815757e+01  0.00000000e+00]
 [-8.21117751e-03  1.88141712e-02]]
grads:  [ 0.01569111 -0.52972075]
Stock Position:  0.015691105991793033
Bond Position:  [2.85427749]


portfolio before change:  [4.24503824]
curr_Stock_Price:  88.61095897764288
curr_Factors:  [8.86109590e+01 4.34312488e-02]
mat_Sqrt:  [[ 1.84666703e+01  0.00000000e+00]
 [-8.33606610e-03  1.91003270e-02]]
grads:  [ -0.10285056 -10.63337612]
Stock Position:  -0.10285055833947962
Bond Position:  [13.35872485]


portfolio before change:  [4.24606106]
curr_Stock_Price:  88.61725093673985
curr_Factors:  [8.86172509e+01 4.24818098e-02]
mat_Sqrt:  [[ 1.82650043e+01  0.00000000e+00]
 [-8.24444635e-03  1.88903997e-02]]
grads:  [ 0.03620138 35.53433414]
Stock Position:  0.0362013847355582
Bond Position:  [1.03799386]


portfolio before change:  [4.19499941]
curr_Stock_Price:  87.20317782075679
curr_Factors:  [8.72031778e+01 4.46201827e-02]
mat_Sqrt:  [[ 1.84203545e+01  0.00000000e+00]
 [-8.44939597e-03  1.93599983e-02]]
grads:  [ 8.79059434e-04 -8.30167077e+00]
Stock Position:  0.0008790594344047222
Bond Position:  [4.11834263]


portfolio before change:  [4.19439684]
curr_Stock_Price:  85.93205852993749
curr_Factors:  [8.59320585e+01 4.40380643e-02]
mat_Sqrt:  [[ 1.80330558e+01  0.00000000e+00]
 [-8.39409929e-03  1.92332977e-02]]
grads:  [ 0.01806942 -4.37850021]
Stock Position:  0.018069424931763455
Bond Position:  [2.64165396]


portfolio before change:  [4.17511802]
curr_Stock_Price:  84.84685242123678
curr_Factors:  [8.48468524e+01 4.39445240e-02]
mat_Sqrt:  [[ 1.77864026e+01  0.00000000e+00]
 [-8.38517969e-03  1.92128603e-02]]
grads:  [7.91613698e-03 9.61828844e+00]
Stock Position:  0.007916136977112742
Bond Position:  [3.50345872]


portfolio before change:  [4.17096171]
curr_Stock_Price:  84.26648517314797
curr_Factors:  [8.42664852e+01 4.48550355e-02]
mat_Sqrt:  [[ 1.78468051e+01  0.00000000e+00]
 [-8.47160296e-03  1.94108809e-02]]
grads:  [-0.11089078 26.30209796]
Stock Position:  -0.11089078337336865
Bond Position:  [13.51533827]


portfolio before change:  [4.14901457]
curr_Stock_Price:  84.47963788293762
curr_Factors:  [8.44796379e+01 4.58359648e-02]
mat_Sqrt:  [[ 1.80865291e+01  0.00000000e+00]
 [-8.56373422e-03  1.96219801e-02]]
grads:  [-0.01508211 -4.51037604]
Stock Position:  -0.015082105102895624
Bond Position:  [5.42314534]


portfolio before change:  [4.16031279]
curr_Stock_Price:  83.77547301753204
curr_Factors:  [8.37754730e+01 4.53250548e-02]
mat_Sqrt:  [[ 1.78355316e+01  0.00000000e+00]
 [-8.51587269e-03  1.95123156e-02]]
grads:  [-2.49928860e-02 -3.72799798e+01]
Stock Position:  -0.024992886011659436
Bond Position:  [6.25410364]


portfolio before change:  [4.17938299]
curr_Stock_Price:  83.04372913245825
curr_Factors:  [8.30437291e+01 4.61184502e-02]
mat_Sqrt:  [[ 1.78338125e+01  0.00000000e+00]
 [-8.59008267e-03  1.96823520e-02]]
grads:  [  0.1298123  -10.05482964]
Stock Position:  0.1298122972354397
Bond Position:  [-6.60071426]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.00775964]
Stock Price:  81.72799699611461
PL:  [4.00775964]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.02847879e-02  2.73126863e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.92591927e-01 -6.64835014e-01]
 [-4.52362759e-02  6.44922562e-02]
 [-6.75826145e-02  3.04071638e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-1.07093384e-01  1.16618644e-01]
 [ 1.76866582e-03 -1.29152177e-01]
 [ 1.64683498e-01  1.43990933e-01]
 [-7.70779517e-02  3.39622092e-01]
 [ 2.06878586e-01  5.88843791e-01]
 [ 9.12010537e-02  3.47573098e-01]
 [ 3.72379386e-01  2.47882376e-02]
 [-2.97204280e-02  3.99446093e-02]
 [ 9.69883317e-02  2.38884230e-01]
 [ 3.65655820e-02  1.80559239e-01]
 [ 1.20895169e-01  2.89829347e-01]
 [ 1.60562598e-01  6.81307933e-02]
 [ 8.85305754e-02 -1.93547874e-01]
 [ 6.24616836e-01 -1.43592117e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.15126487e-02  3.04243873e-02]
 [-4.75966334e-02 -1.60047184e-01]
 [ 7.92004136e-02 -3.61123965e-01]
 [ 9.60116055e-02  3.08896803e-01]
 [-5.88786811e-02  8.20212732e-02]
 [-1.63872977e-02  1.54272666e-01]
 [-1.40798940e-01  4.81974389e-02]
 [-7.16251827e-01  1.73130895e-01]
 [ 2.95381189e-01  7.14095916e-02]
 [-1.84596988e+00 -2.07273457e-01]
 [ 3.81975593e-01  6.95473167e-01]
 [ 7.67739789e-02 -1.57454981e-01]
 [ 1.74000970e-01 -2.29254245e-02]
 [ 2.21928562e-02  1.77761409e-01]
 [-2.60686136e+00  1.79995397e-01]
 [-1.57286178e-01  5.55142872e-02]
 [-1.34327970e-01 -2.66241270e-01]
 [ 1.78072394e+00 -1.17213778e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.94989756]
curr_Stock_Price:  99.88584833874629
curr_Factors:  [9.98858483e+01 4.03212339e-02]
mat_Sqrt:  [[ 2.00572261e+01  0.00000000e+00]
 [-8.03205915e-03  1.84037595e-02]]
grads:  [6.45588394e-03 1.48408189e+01]
Stock Position:  0.0064558839384898925
Bond Position:  [1.30504611]


portfolio before change:  [1.94735132]
curr_Stock_Price:  99.46617320662544
curr_Factors:  [9.94661732e+01 4.14155649e-02]
mat_Sqrt:  [[ 2.02421764e+01  0.00000000e+00]
 [-8.14032578e-03  1.86518295e-02]]
grads:  [-0.0100278  -4.71864543]
Stock Position:  -0.010027797626857203
Bond Position:  [2.94477798]


portfolio before change:  [1.93964024]
curr_Stock_Price:  100.27185380697588
curr_Factors:  [1.00271854e+02 4.25028195e-02]
mat_Sqrt:  [[ 2.06722579e+01  0.00000000e+00]
 [-8.24648478e-03  1.88950704e-02]]
grads:  [ 2.43047538e-02 -3.51856331e+01]
Stock Position:  0.024304753789190624
Bond Position:  [-0.49744248]


portfolio before change:  [1.91868774]
curr_Stock_Price:  99.41233817830673
curr_Factors:  [9.94123382e+01 4.37838235e-02]
mat_Sqrt:  [[ 2.08016187e+01  0.00000000e+00]
 [-8.36983379e-03  1.91776984e-02]]
grads:  [-8.21548938e-04  3.36287779e+00]
Stock Position:  -0.0008215489383140063
Bond Position:  [2.00035984]


portfolio before change:  [1.91797597]
curr_Stock_Price:  100.58309434202138
curr_Factors:  [1.00583094e+02 4.46850236e-02]
mat_Sqrt:  [[ 2.12620918e+01  0.00000000e+00]
 [-8.45553297e-03  1.93740599e-02]]
grads:  [-0.0025544   1.56947815]
Stock Position:  -0.0025543977923755228
Bond Position:  [2.1749052]


portfolio before change:  [1.92148026]
curr_Stock_Price:  99.31766290857767
curr_Factors:  [9.93176629e+01 4.37816436e-02]
mat_Sqrt:  [[ 2.07812909e+01  0.00000000e+00]
 [-8.36962543e-03  1.91772210e-02]]
grads:  [-0.00569843 -3.45810938]
Stock Position:  -0.005698431927548008
Bond Position:  [2.48743521]


portfolio before change:  [1.93438103]
curr_Stock_Price:  97.10831498290162
curr_Factors:  [9.71083150e+01 4.54934464e-02]
mat_Sqrt:  [[ 2.07124197e+01  0.00000000e+00]
 [-8.53167710e-03  1.95485281e-02]]
grads:  [-2.71319508e-03  5.96559718e+00]
Stock Position:  -0.002713195077729724
Bond Position:  [2.19785483]


portfolio before change:  [1.93567281]
curr_Stock_Price:  96.73346835457937
curr_Factors:  [9.67334684e+01 4.46943609e-02]
mat_Sqrt:  [[ 2.04504621e+01  0.00000000e+00]
 [-8.45641635e-03  1.93760840e-02]]
grads:  [-2.66976682e-03 -6.66554587e+00]
Stock Position:  -0.0026697668247251476
Bond Position:  [2.19392862]


portfolio before change:  [1.93991306]
curr_Stock_Price:  95.24794944024244
curr_Factors:  [9.52479494e+01 4.60398762e-02]
mat_Sqrt:  [[ 2.04372618e+01  0.00000000e+00]
 [-8.58276190e-03  1.96655781e-02]]
grads:  [0.01113291 7.32197815]
Stock Position:  0.011132914730863381
Bond Position:  [0.87952576]


portfolio before change:  [1.93101001]
curr_Stock_Price:  94.43836859755052
curr_Factors:  [9.44383686e+01 4.71253010e-02]
mat_Sqrt:  [[ 2.05010235e+01  0.00000000e+00]
 [-8.68334507e-03  1.98960430e-02]]
grads:  [3.47032825e-03 1.70698310e+01]
Stock Position:  0.0034703282543176945
Bond Position:  [1.60327787]


portfolio before change:  [1.92904324]
curr_Stock_Price:  93.81387535038574
curr_Factors:  [9.38138754e+01 4.68464408e-02]
mat_Sqrt:  [[ 2.03051114e+01  0.00000000e+00]
 [-8.65761545e-03  1.98370891e-02]]
grads:  [2.28450401e-02 2.96839818e+01]
Stock Position:  0.02284504012462591
Bond Position:  [-0.21413851]


portfolio before change:  [1.91555682]
curr_Stock_Price:  93.22470361962583
curr_Factors:  [9.32247036e+01 4.73533314e-02]
mat_Sqrt:  [[ 2.02864605e+01  0.00000000e+00]
 [-8.70432825e-03  1.99441215e-02]]
grads:  [1.19732266e-02 1.74273455e+01]
Stock Position:  0.0119732266465062
Bond Position:  [0.79935631]


portfolio before change:  [1.9184154]
curr_Stock_Price:  93.45510527431166
curr_Factors:  [9.34551053e+01 4.64633579e-02]
mat_Sqrt:  [[ 2.01445851e+01  0.00000000e+00]
 [-8.62214432e-03  1.97558145e-02]]
grads:  [0.01902238 1.25473124]
Stock Position:  0.019022375350757202
Bond Position:  [0.1406773]


portfolio before change:  [1.94558224]
curr_Stock_Price:  94.88233305205057
curr_Factors:  [9.48823331e+01 4.68932718e-02]
mat_Sqrt:  [[ 2.05466311e+01  0.00000000e+00]
 [-8.66194175e-03  1.98470019e-02]]
grads:  [-5.98013916e-04  2.01262687e+00]
Stock Position:  -0.0005980139155461688
Bond Position:  [2.0023232]


portfolio before change:  [1.94557797]
curr_Stock_Price:  95.30804329975118
curr_Factors:  [9.53080433e+01 4.61638634e-02]
mat_Sqrt:  [[ 2.04776741e+01  0.00000000e+00]
 [-8.59431099e-03  1.96920403e-02]]
grads:  [9.82757886e-03 1.21310045e+01]
Stock Position:  0.009827578855623293
Bond Position:  [1.00893066]


portfolio before change:  [1.93521932]
curr_Stock_Price:  94.24117084293451
curr_Factors:  [9.42411708e+01 4.73123173e-02]
mat_Sqrt:  [[ 2.04987691e+01  0.00000000e+00]
 [-8.70055789e-03  1.99354826e-02]]
grads:  [5.62804985e-03 9.05717923e+00]
Stock Position:  0.005628049850852644
Bond Position:  [1.40482531]


portfolio before change:  [1.93600104]
curr_Stock_Price:  94.34886521666766
curr_Factors:  [9.43488652e+01 4.60563154e-02]
mat_Sqrt:  [[ 2.02479601e+01  0.00000000e+00]
 [-8.58429407e-03  1.96690887e-02]]
grads:  [1.22178760e-02 1.47352707e+01]
Stock Position:  0.012217876009984066
Bond Position:  [0.78325831]


portfolio before change:  [1.91044167]
curr_Stock_Price:  92.24888609158097
curr_Factors:  [9.22488861e+01 4.63709225e-02]
mat_Sqrt:  [[ 1.98647909e+01  0.00000000e+00]
 [-8.61356349e-03  1.97361533e-02]]
grads:  [0.00957963 3.45208066]
Stock Position:  0.009579628336028172
Bond Position:  [1.02673163]


portfolio before change:  [1.89538766]
curr_Stock_Price:  90.66402714430615
curr_Factors:  [9.06640271e+01 4.53227153e-02]
mat_Sqrt:  [[ 1.93015847e+01  0.00000000e+00]
 [-8.51565291e-03  1.95118120e-02]]
grads:  [ 2.1031216e-04 -9.9195233e+00]
Stock Position:  0.00021031215959216952
Bond Position:  [1.87631991]


portfolio before change:  [1.89557409]
curr_Stock_Price:  90.43519864954612
curr_Factors:  [9.04351986e+01 4.56008424e-02]
mat_Sqrt:  [[ 1.93118522e+01  0.00000000e+00]
 [-8.54174149e-03  1.95715885e-02]]
grads:  [ 0.02909861 -7.33676357]
Stock Position:  0.029098612152805896
Bond Position:  [-0.73596468]


portfolio before change:  [1.94830977]
curr_Stock_Price:  92.25066944486166
curr_Factors:  [9.22506694e+01 4.49945689e-02]
mat_Sqrt:  [[ 1.95681412e+01  0.00000000e+00]
 [-8.48476931e-03  1.94410488e-02]]
grads:  [ 0.00215292 -1.94320739]
Stock Position:  0.002152918364730071
Bond Position:  [1.74970161]


portfolio before change:  [1.94890994]
curr_Stock_Price:  92.42784417619188
curr_Factors:  [9.24278442e+01 4.47150576e-02]
mat_Sqrt:  [[ 1.95447320e+01  0.00000000e+00]
 [-8.45837408e-03  1.93805697e-02]]
grads:  [-4.21308282e-04  1.56983967e+00]
Stock Position:  -0.0004213082821574625
Bond Position:  [1.98785056]


portfolio before change:  [1.94894583]
curr_Stock_Price:  92.93248787054716
curr_Factors:  [9.29324879e+01 4.54061405e-02]
mat_Sqrt:  [[ 1.98027205e+01  0.00000000e+00]
 [-8.52348665e-03  1.95297614e-02]]
grads:  [-5.93084930e-03 -8.19504042e+00]
Stock Position:  -0.0059308493038297385
Bond Position:  [2.50011441]


portfolio before change:  [1.9608941]
curr_Stock_Price:  90.97058690706304
curr_Factors:  [9.09705869e+01 4.64309012e-02]
mat_Sqrt:  [[ 1.96021881e+01  0.00000000e+00]
 [-8.61913232e-03  1.97489131e-02]]
grads:  [-3.9999109e-03 -1.8285764e+01]
Stock Position:  -0.003999910898820468
Bond Position:  [2.32476834]


portfolio before change:  [1.96713466]
curr_Stock_Price:  89.48306815809563
curr_Factors:  [8.94830682e+01 4.60408381e-02]
mat_Sqrt:  [[ 1.92004973e+01  0.00000000e+00]
 [-8.58285156e-03  1.96657835e-02]]
grads:  [1.20218357e-02 1.57073225e+01]
Stock Position:  0.012021835662505477
Bond Position:  [0.89138392]


portfolio before change:  [1.95755027]
curr_Stock_Price:  88.67655102017257
curr_Factors:  [8.8676551e+01 4.7039757e-02]
mat_Sqrt:  [[ 1.92327474e+01  0.00000000e+00]
 [-8.67546029e-03  1.98779767e-02]]
grads:  [-1.20012301e-03  4.12623852e+00]
Stock Position:  -0.0012001230089711515
Bond Position:  [2.06397304]


portfolio before change:  [1.95702709]
curr_Stock_Price:  89.327479310476
curr_Factors:  [8.93274793e+01 4.58451867e-02]
mat_Sqrt:  [[ 1.91263435e+01  0.00000000e+00]
 [-8.56459566e-03  1.96239540e-02]]
grads:  [2.66348941e-03 7.86144658e+00]
Stock Position:  0.002663489413133963
Bond Position:  [1.71910429]


portfolio before change:  [1.95795435]
curr_Stock_Price:  89.59493246415161
curr_Factors:  [8.95949325e+01 4.47314833e-02]
mat_Sqrt:  [[ 1.89491658e+01  0.00000000e+00]
 [-8.45992750e-03  1.93841291e-02]]
grads:  [-0.00632027  2.48643819]
Stock Position:  -0.006320270466449057
Bond Position:  [2.52421855]


portfolio before change:  [1.96615626]
curr_Stock_Price:  88.34714384785322
curr_Factors:  [8.83471438e+01 4.56079735e-02]
mat_Sqrt:  [[ 1.88674367e+01  0.00000000e+00]
 [-8.54240935e-03  1.95731187e-02]]
grads:  [-0.03395752  8.84534025]
Stock Position:  -0.03395751737781759
Bond Position:  [4.96620593]


portfolio before change:  [1.96193425]
curr_Stock_Price:  88.48975781539043
curr_Factors:  [8.84897578e+01 4.42241956e-02]
mat_Sqrt:  [[ 1.86089975e+01  0.00000000e+00]
 [-8.41181983e-03  1.92739006e-02]]
grads:  [0.0175478  3.70498911]
Stock Position:  0.017547795891792617
Bond Position:  [0.40913405]


portfolio before change:  [1.95785309]
curr_Stock_Price:  88.25426886131602
curr_Factors:  [8.82542689e+01 4.62234518e-02]
mat_Sqrt:  [[ 1.89743501e+01  0.00000000e+00]
 [-8.59985598e-03  1.97047455e-02]]
grads:  [ -0.10205522 -10.51896138]
Stock Position:  -0.10205521831200075
Bond Position:  [10.96466176]


portfolio before change:  [1.97942444]
curr_Stock_Price:  88.05633008964581
curr_Factors:  [8.80563301e+01 4.61206068e-02]
mat_Sqrt:  [[ 1.89107210e+01  0.00000000e+00]
 [-8.59028351e-03  1.96828122e-02]]
grads:  [ 0.03624954 35.33403458]
Stock Position:  0.03624954156347987
Bond Position:  [-1.21257716]


portfolio before change:  [1.97199656]
curr_Stock_Price:  87.85560221260612
curr_Factors:  [8.78556022e+01 4.54595410e-02]
mat_Sqrt:  [[ 1.87319066e+01  0.00000000e+00]
 [-8.52849727e-03  1.95412422e-02]]
grads:  [ 4.30014492e-04 -8.05757280e+00]
Stock Position:  0.00043001449238459137
Bond Position:  [1.93421738]


portfolio before change:  [1.97241451]
curr_Stock_Price:  88.26524698719155
curr_Factors:  [8.82652470e+01 4.42227218e-02]
mat_Sqrt:  [[ 1.85614746e+01  0.00000000e+00]
 [-8.41167967e-03  1.92735794e-02]]
grads:  [ 0.00883526 -1.18947415]
Stock Position:  0.008835262203349402
Bond Position:  [1.19256791]


portfolio before change:  [1.97271499]
curr_Stock_Price:  88.28238244458542
curr_Factors:  [8.82823824e+01 4.41545412e-02]
mat_Sqrt:  [[ 1.85507611e+01  0.00000000e+00]
 [-8.40519280e-03  1.92587161e-02]]
grads:  [5.37844754e-03 9.23017963e+00]
Stock Position:  0.005378447538796903
Bond Position:  [1.49789282]


portfolio before change:  [1.97736017]
curr_Stock_Price:  89.11123463272813
curr_Factors:  [8.91112346e+01 4.29644941e-02]
mat_Sqrt:  [[ 1.84708683e+01  0.00000000e+00]
 [-8.29115135e-03  1.89974143e-02]]
grads:  [-0.13688068  9.47473137]
Stock Position:  -0.13688067503536325
Bond Position:  [14.17496612]


portfolio before change:  [2.04691176]
curr_Stock_Price:  88.61606167319493
curr_Factors:  [8.86160617e+01 4.20489439e-02]
mat_Sqrt:  [[ 1.81714671e+01  0.00000000e+00]
 [-8.20233566e-03  1.87939120e-02]]
grads:  [-0.00732235  2.95384416]
Stock Position:  -0.007322345317694745
Bond Position:  [2.69578917]


portfolio before change:  [2.04430649]
curr_Stock_Price:  89.01788198208509
curr_Factors:  [8.9017882e+01 4.2557407e-02]
mat_Sqrt:  [[ 1.83638965e+01  0.00000000e+00]
 [-8.25177867e-03  1.89072002e-02]]
grads:  [-1.36422674e-02 -1.40814752e+01]
Stock Position:  -0.013642267379379425
Bond Position:  [3.25871224]


portfolio before change:  [2.05172146]
curr_Stock_Price:  88.50421340884786
curr_Factors:  [8.85042134e+01 4.26444049e-02]
mat_Sqrt:  [[ 1.82765818e+01  0.00000000e+00]
 [-8.26020870e-03  1.89265158e-02]]
grads:  [ 0.09463299 -6.19309854]
Stock Position:  0.09463299387489824
Bond Position:  [-6.32369723]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.96962241]
Stock Price:  87.6450147854746
PL:  [1.96962241]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.18205386e-01 -2.21052090e-03]
 [-1.64581534e-01 -8.79642723e-02]
 [ 8.52863288e-01 -7.74521922e-01]
 [-3.43256640e-02  1.35190685e-01]
 [ 2.06931226e-02 -9.05614177e-02]
 [-7.73936202e-02 -9.12878118e-02]
 [-9.49617098e-02  1.33084975e-01]
 [-1.00895051e-01 -1.03472198e-01]
 [ 1.65911961e-01  1.03771506e-01]
 [ 2.30123893e-01 -7.56600770e-02]
 [ 1.03645021e-01  1.39982789e-01]
 [-9.73473627e-02  2.52387401e-03]
 [-1.80910802e-01  1.62658563e-01]
 [-4.50458510e-01 -5.84580222e-01]
 [ 3.77232492e-02  4.90941610e-02]
 [ 4.85272916e-02 -7.36519051e-02]
 [-5.35883440e-02  3.05382435e-01]
 [-6.24299096e-02  1.08816584e-01]
 [ 1.48178217e-02  6.78773020e-02]
 [-8.57298922e-02 -3.86197998e-02]
 [ 2.01243969e-01  1.09339130e-01]
 [ 2.86827488e-02  1.29310776e-01]
 [ 2.70913699e-02  3.07649118e-01]
 [ 3.70062385e-02  1.69590584e-01]
 [ 3.44614603e-02  7.76210492e-02]
 [ 7.04526461e-01 -2.64247192e-01]
 [-2.45154840e-02  7.09673745e-02]
 [ 2.60526585e-02  4.28064645e-02]
 [ 3.51752467e-02 -1.57842193e-01]
 [-3.35924615e-02 -3.84932995e-02]
 [-6.78013736e-01 -8.77442668e-02]
 [-1.18048875e-01  4.40726031e-03]
 [ 5.16973610e-02 -4.66986930e-02]
 [ 8.94969191e-02  9.80075233e-02]
 [-1.25586751e-01  1.11523094e-01]
 [-8.49533266e-01 -2.43283466e-01]
 [-1.92354930e-02  3.07551076e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 9.93466741e-01 -1.48885705e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.26849056]
curr_Stock_Price:  99.09987462657347
curr_Factors:  [9.90998746e+01 4.00624389e-02]
mat_Sqrt:  [[ 1.98354381e+01  0.00000000e+00]
 [-8.00624146e-03  1.83446038e-02]]
grads:  [-0.01104942 -0.12049979]
Stock Position:  -0.011049422494795133
Bond Position:  [-2.17349418]


portfolio before change:  [-3.27219574]
curr_Stock_Price:  99.41061308058039
curr_Factors:  [9.94106131e+01 3.96913919e-02]
mat_Sqrt:  [[ 1.98052768e+01  0.00000000e+00]
 [-7.96907944e-03  1.82594549e-02]]
grads:  [-0.01024839 -4.81746432]
Stock Position:  -0.010248394470676771
Bond Position:  [-2.25339657]


portfolio before change:  [-3.26192914]
curr_Stock_Price:  98.38134953287756
curr_Factors:  [9.83813495e+01 4.00271298e-02]
mat_Sqrt:  [[ 1.96829414e+01  0.00000000e+00]
 [-8.00271252e-03  1.83365180e-02]]
grads:  [ 2.61563654e-02 -4.22393131e+01]
Stock Position:  0.026156365373215237
Bond Position:  [-5.83522766]


portfolio before change:  [-3.26275874]
curr_Stock_Price:  98.37752035510063
curr_Factors:  [9.83775204e+01 3.98842272e-02]
mat_Sqrt:  [[ 1.96470098e+01  0.00000000e+00]
 [-7.98841433e-03  1.83037567e-02]]
grads:  [1.25598695e-03 7.38595291e+00]
Stock Position:  0.0012559869540474066
Bond Position:  [-3.38631963]


portfolio before change:  [-3.26494914]
curr_Stock_Price:  96.97059829502953
curr_Factors:  [9.69705983e+01 3.96174462e-02]
mat_Sqrt:  [[ 1.93011557e+01  0.00000000e+00]
 [-7.96165271e-03  1.82424381e-02]]
grads:  [-9.75647299e-04 -4.96432643e+00]
Stock Position:  -0.0009756472994913616
Bond Position:  [-3.17034003]


portfolio before change:  [-3.26493631]
curr_Stock_Price:  96.5512398536835
curr_Factors:  [9.65512399e+01 3.94349649e-02]
mat_Sqrt:  [[ 1.91733758e+01  0.00000000e+00]
 [-7.94329552e-03  1.82003765e-02]]
grads:  [-0.00611446 -5.01571008]
Stock Position:  -0.0061144625174030165
Bond Position:  [-2.67457737]


portfolio before change:  [-3.27089072]
curr_Stock_Price:  97.47038298139118
curr_Factors:  [9.74703830e+01 3.90175042e-02]
mat_Sqrt:  [[ 1.92531775e+01  0.00000000e+00]
 [-7.90113958e-03  1.81037851e-02]]
grads:  [-1.91545862e-03  7.35122376e+00]
Stock Position:  -0.0019154586158253487
Bond Position:  [-3.08419023]


portfolio before change:  [-3.27209912]
curr_Stock_Price:  97.89997031105389
curr_Factors:  [9.78999703e+01 3.84952151e-02]
mat_Sqrt:  [[ 1.92081676e+01  0.00000000e+00]
 [-7.84807901e-03  1.79822081e-02]]
grads:  [-0.00760375 -5.75414309]
Stock Position:  -0.007603745651893893
Bond Position:  [-2.52769265]


portfolio before change:  [-3.26995383]
curr_Stock_Price:  97.5762785407083
curr_Factors:  [9.75762785e+01 3.88789406e-02]
mat_Sqrt:  [[ 1.92398403e+01  0.00000000e+00]
 [-7.88709737e-03  1.80716104e-02]]
grads:  [0.0109773  5.74223901]
Stock Position:  0.010977303184246306
Bond Position:  [-4.34107823]


portfolio before change:  [-3.25134192]
curr_Stock_Price:  99.32120439537164
curr_Factors:  [9.93212044e+01 3.99691503e-02]
mat_Sqrt:  [[ 1.98565793e+01  0.00000000e+00]
 [-7.99691444e-03  1.83232329e-02]]
grads:  [ 0.00992634 -4.1291882 ]
Stock Position:  0.00992633850947109
Bond Position:  [-4.23723782]


portfolio before change:  [-3.25105434]
curr_Stock_Price:  99.40353748452873
curr_Factors:  [9.94035375e+01 3.96322627e-02]
mat_Sqrt:  [[ 1.97891105e+01  0.00000000e+00]
 [-7.96314136e-03  1.82458490e-02]]
grads:  [0.00832471 7.67203483]
Stock Position:  0.008324705570214547
Bond Position:  [-4.07855953]


portfolio before change:  [-3.24644912]
curr_Stock_Price:  100.01798251574957
curr_Factors:  [1.00017983e+02 4.02438499e-02]
mat_Sqrt:  [[ 2.00644773e+01  0.00000000e+00]
 [-8.02434794e-03  1.83860909e-02]]
grads:  [-0.00479683  0.13727083]
Stock Position:  -0.004796828363901613
Bond Position:  [-2.76668003]


portfolio before change:  [-3.25598187]
curr_Stock_Price:  101.93318475165667
curr_Factors:  [1.01933185e+02 3.90449985e-02]
mat_Sqrt:  [[ 2.01418009e+01  0.00000000e+00]
 [-7.90392293e-03  1.81101626e-02]]
grads:  [-5.45734646e-03  8.98161803e+00]
Stock Position:  -0.005457346456790545
Bond Position:  [-2.69969717]


portfolio before change:  [-3.2510775]
curr_Stock_Price:  100.97267034220002
curr_Factors:  [1.00972670e+02 3.95969955e-02]
mat_Sqrt:  [[ 2.00925454e+01  0.00000000e+00]
 [-7.95959753e-03  1.82377291e-02]]
grads:  [ -0.03511702 -32.05334499]
Stock Position:  -0.035117015783004524
Bond Position:  [0.29478136]


portfolio before change:  [-3.31567736]
curr_Stock_Price:  102.81327974473082
curr_Factors:  [1.02813280e+02 3.68415274e-02]
mat_Sqrt:  [[ 1.97341319e+01  0.00000000e+00]
 [-7.67765875e-03  1.75917262e-02]]
grads:  [0.00299733 2.7907529 ]
Stock Position:  0.002997329594192685
Bond Position:  [-3.62384264]


portfolio before change:  [-3.31469978]
curr_Stock_Price:  103.29056551844816
curr_Factors:  [1.03290566e+02 3.67771373e-02]
mat_Sqrt:  [[ 1.98084100e+01  0.00000000e+00]
 [-7.67094647e-03  1.75763464e-02]]
grads:  [ 8.27071173e-04 -4.19039904e+00]
Stock Position:  0.0008270711734399281
Bond Position:  [-3.40012843]


portfolio before change:  [-3.31460301]
curr_Stock_Price:  103.92148588015831
curr_Factors:  [1.03921486e+02 3.52394539e-02]
mat_Sqrt:  [[ 1.95083228e+01  0.00000000e+00]
 [-7.50886984e-03  1.72049822e-02]]
grads:  [4.08499891e-03 1.77496513e+01]
Stock Position:  0.004084998908840679
Bond Position:  [-3.73912217]


portfolio before change:  [-3.32039081]
curr_Stock_Price:  102.61906589200656
curr_Factors:  [1.02619066e+02 3.72022211e-02]
mat_Sqrt:  [[ 1.97930395e+01  0.00000000e+00]
 [-7.71515092e-03  1.76776315e-02]]
grads:  [-7.54732929e-04  6.15560880e+00]
Stock Position:  -0.0007547329289575784
Bond Position:  [-3.24294083]


portfolio before change:  [-3.32107038]
curr_Stock_Price:  102.98234072656071
curr_Factors:  [1.02982341e+02 3.66848719e-02]
mat_Sqrt:  [[ 1.97245118e+01  0.00000000e+00]
 [-7.66131810e-03  1.75542851e-02]]
grads:  [2.25313080e-03 3.86670843e+00]
Stock Position:  0.0022531307988828265
Bond Position:  [-3.55310307]


portfolio before change:  [-3.32312555]
curr_Stock_Price:  102.2673338298479
curr_Factors:  [1.02267334e+02 3.68486660e-02]
mat_Sqrt:  [[ 1.96312439e+01  0.00000000e+00]
 [-7.67840254e-03  1.75934304e-02]]
grads:  [-0.0052256  -2.19512619]
Stock Position:  -0.005225596255056314
Bond Position:  [-2.78871776]


portfolio before change:  [-3.32123757]
curr_Stock_Price:  101.83932688770638
curr_Factors:  [1.01839327e+02 3.69033198e-02]
mat_Sqrt:  [[ 1.95635758e+01  0.00000000e+00]
 [-7.68409472e-03  1.76064728e-02]]
grads:  [0.01272587 6.21016659]
Stock Position:  0.012725867650421139
Bond Position:  [-4.61723137]


portfolio before change:  [-3.32348182]
curr_Stock_Price:  101.70832960230474
curr_Factors:  [1.01708330e+02 3.70248214e-02]
mat_Sqrt:  [[ 1.95705490e+01  0.00000000e+00]
 [-7.69673400e-03  1.76354331e-02]]
grads:  [4.34932094e-03 7.33244120e+00]
Stock Position:  0.004349320936355281
Bond Position:  [-3.76584398]


portfolio before change:  [-3.32234086]
curr_Stock_Price:  102.07889571063669
curr_Factors:  [1.02078896e+02 3.78155480e-02]
mat_Sqrt:  [[ 1.98504868e+01  0.00000000e+00]
 [-7.77848808e-03  1.78227552e-02]]
grads:  [8.12879071e-03 1.72615914e+01]
Stock Position:  0.008128790714311981
Bond Position:  [-4.15211884]


portfolio before change:  [-3.32153632]
curr_Stock_Price:  102.2417237176342
curr_Factors:  [1.02241724e+02 3.67001511e-02]
mat_Sqrt:  [[ 1.95867369e+01  0.00000000e+00]
 [-7.66291340e-03  1.75579403e-02]]
grads:  [5.66820489e-03 9.65891107e+00]
Stock Position:  0.005668204885752685
Bond Position:  [-3.90106336]


portfolio before change:  [-3.32218848]
curr_Stock_Price:  102.21270319955545
curr_Factors:  [1.02212703e+02 3.69039952e-02]
mat_Sqrt:  [[ 1.96354820e+01  0.00000000e+00]
 [-7.68416504e-03  1.76066340e-02]]
grads:  [3.48033542e-03 4.40862514e+00]
Stock Position:  0.003480335416010816
Bond Position:  [-3.67792297]


portfolio before change:  [-3.32560325]
curr_Stock_Price:  101.36364546082261
curr_Factors:  [1.01363645e+02 3.72078275e-02]
mat_Sqrt:  [[ 1.95523687e+01  0.00000000e+00]
 [-7.71573224e-03  1.76789635e-02]]
grads:  [  0.03013443 -14.9469844 ]
Stock Position:  0.030134432365471836
Bond Position:  [-6.38013917]


portfolio before change:  [-3.34588143]
curr_Stock_Price:  100.71718860977188
curr_Factors:  [1.00717189e+02 3.55359425e-02]
mat_Sqrt:  [[ 1.89861765e+01  0.00000000e+00]
 [-7.54039177e-03  1.72772080e-02]]
grads:  [3.40100994e-04 4.10757192e+00]
Stock Position:  0.0003401009936886028
Bond Position:  [-3.38013544]


portfolio before change:  [-3.34599323]
curr_Stock_Price:  101.63087143789123
curr_Factors:  [1.01630871e+02 3.61007462e-02]
mat_Sqrt:  [[ 1.93100651e+01  0.00000000e+00]
 [-7.60007855e-03  1.74139676e-02]]
grads:  [2.31666392e-03 2.45816838e+00]
Stock Position:  0.002316663918595793
Bond Position:  [-3.5814378]


portfolio before change:  [-3.34980662]
curr_Stock_Price:  100.17805589194896
curr_Factors:  [1.00178056e+02 3.88879054e-02]
mat_Sqrt:  [[ 1.97551292e+01  0.00000000e+00]
 [-7.88800663e-03  1.80736937e-02]]
grads:  [-1.70653068e-03 -8.73325595e+00]
Stock Position:  -0.0017065306806788093
Bond Position:  [-3.17884969]


portfolio before change:  [-3.35174648]
curr_Stock_Price:  101.08192699988108
curr_Factors:  [1.01081927e+02 3.60850841e-02]
mat_Sqrt:  [[ 1.92015980e+01  0.00000000e+00]
 [-7.59842975e-03  1.74101897e-02]]
grads:  [-0.00262438 -2.21096381]
Stock Position:  -0.0026243812973728393
Bond Position:  [-3.08646897]


portfolio before change:  [-3.34878001]
curr_Stock_Price:  99.8045565496441
curr_Factors:  [9.98045565e+01 3.59394185e-02]
mat_Sqrt:  [[ 1.89206430e+01  0.00000000e+00]
 [-7.58307785e-03  1.73750141e-02]]
grads:  [-0.03785857 -5.05002564]
Stock Position:  -0.03785856914968751
Bond Position:  [0.4296777]


portfolio before change:  [-3.36752696]
curr_Stock_Price:  100.30115914396985
curr_Factors:  [1.00301159e+02 3.74472398e-02]
mat_Sqrt:  [[ 1.94095675e+01  0.00000000e+00]
 [-7.74051572e-03  1.77357496e-02]]
grads:  [-0.00598289  0.24849586]
Stock Position:  -0.005982894233050862
Bond Position:  [-2.76743573]


portfolio before change:  [-3.36449974]
curr_Stock_Price:  99.73735708693522
curr_Factors:  [9.97373571e+01 3.79863145e-02]
mat_Sqrt:  [[ 1.94388888e+01  0.00000000e+00]
 [-7.79603125e-03  1.78629517e-02]]
grads:  [ 1.61101701e-03 -2.61427640e+00]
Stock Position:  0.0016110170060756458
Bond Position:  [-3.52517832]


portfolio before change:  [-3.36679646]
curr_Stock_Price:  98.58526086054842
curr_Factors:  [9.85852609e+01 3.87626537e-02]
mat_Sqrt:  [[ 1.94096963e+01  0.00000000e+00]
 [-7.87529339e-03  1.80445640e-02]]
grads:  [0.00681468 5.43141542]
Stock Position:  0.006814682044566881
Bond Position:  [-4.03862367]


portfolio before change:  [-3.37037584]
curr_Stock_Price:  98.13410049268964
curr_Factors:  [9.81341005e+01 4.02132362e-02]
mat_Sqrt:  [[ 1.96790649e+01  0.00000000e+00]
 [-8.02129527e-03  1.83790964e-02]]
grads:  [-3.9084216e-03  6.0679313e+00]
Stock Position:  -0.003908421596224647
Bond Position:  [-2.9868264]


portfolio before change:  [-3.36826886]
curr_Stock_Price:  97.499481212729
curr_Factors:  [9.74994812e+01 4.18347653e-02]
mat_Sqrt:  [[ 1.99421038e+01  0.00000000e+00]
 [-8.18141946e-03  1.87459870e-02]]
grads:  [ -0.04792428 -12.97789579]
Stock Position:  -0.04792427536766637
Bond Position:  [1.30432313]


portfolio before change:  [-3.37431611]
curr_Stock_Price:  97.6290668993441
curr_Factors:  [9.76290669e+01 4.29572544e-02]
mat_Sqrt:  [[ 2.02347292e+01  0.00000000e+00]
 [-8.29045276e-03  1.89958137e-02]]
grads:  [5.68284359e-03 1.61904661e+01]
Stock Position:  0.005682843592400732
Bond Position:  [-3.92912682]


portfolio before change:  [-3.38383037]
curr_Stock_Price:  96.04128902489296
curr_Factors:  [9.6041289e+01 4.2763604e-02]
mat_Sqrt:  [[ 1.98607265e+01  0.00000000e+00]
 [-8.27174506e-03  1.89529489e-02]]
grads:  [-4.44018075e-03  5.77017143e+00]
Stock Position:  -0.004440180752361361
Bond Position:  [-2.95738969]


portfolio before change:  [-3.38141769]
curr_Stock_Price:  95.41465216434587
curr_Factors:  [9.54146522e+01 4.19408575e-02]
mat_Sqrt:  [[ 1.95404123e+01  0.00000000e+00]
 [-8.19178686e-03  1.87697417e-02]]
grads:  [ 0.05050911 -0.79322192]
Stock Position:  0.050509109979542444
Bond Position:  [-8.20072685]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.37597923]
Stock Price:  95.54262137350571
PL:  [-3.37597923]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-5.62159203e-01 -2.76048969e-01]
 [-8.12544267e-02 -8.68491593e-02]
 [ 9.53429943e-01 -1.01106966e+00]
 [ 2.45062368e-02  4.10463270e-01]
 [ 1.89119415e-03 -1.43178082e-01]
 [-7.13214651e-02 -3.65237175e-02]
 [-1.57014833e-01  1.71267463e-03]
 [ 1.45963724e-01 -1.63616146e-01]
 [ 1.65483061e-01  1.17813526e-01]
 [ 1.82789879e-02  2.04589183e-01]
 [ 1.45741201e-01  2.90071940e-01]
 [ 1.86852436e-01  2.47225198e-01]
 [ 2.05895922e-01  2.46435583e-02]
 [-1.86730452e-01 -2.22182820e-01]
 [ 8.67772003e-02  2.30713434e-01]
 [ 5.26540720e-02 -1.95467101e-02]
 [-5.00249618e-02  1.60961398e-01]
 [-6.55511751e-02  1.63341740e-02]
 [ 1.50565613e-02  6.19493617e-02]
 [-7.88943442e-03 -8.64972710e-02]
 [ 2.14818675e-01  1.27016562e-01]
 [ 1.69548637e-02  4.58137230e-02]
 [ 9.77373630e-03  2.26633823e-01]
 [ 3.75357589e-02  1.69776216e-01]
 [ 2.49784179e-02  5.75888858e-02]
 [ 6.52846589e-01 -2.12302195e-01]
 [ 7.42294436e-03  6.32714030e-02]
 [-7.63547849e-02  8.84930376e-02]
 [ 6.51558368e-02 -1.64781410e-01]
 [-5.43464432e-02 -3.37590416e-02]
 [-5.74607399e-01 -9.74455121e-02]
 [-1.18040669e-01  4.08867083e-03]
 [ 1.17871583e-01  8.35380081e-02]
 [ 1.42099043e-01  7.10203122e-02]
 [-2.90068852e-01 -1.80493803e-01]
 [-1.40468512e-01 -4.12943357e-01]
 [-1.64073221e-01  2.12849768e-01]
 [-1.19583754e-01  1.20378889e-01]
 [-1.69328106e-01  1.42646871e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.81225687]
curr_Stock_Price:  97.51181276508903
curr_Factors:  [9.75118128e+01 3.96771967e-02]
mat_Sqrt:  [[ 1.94235103e+01  0.00000000e+00]
 [-7.96765428e-03  1.82561894e-02]]
grads:  [ -0.03514488 -15.12084274]
Stock Position:  -0.03514487545029293
Bond Position:  [-10.38521636]


portfolio before change:  [-13.73040268]
curr_Stock_Price:  95.14582263944739
curr_Factors:  [9.51458226e+01 4.05247111e-02]
mat_Sqrt:  [[ 1.91535681e+01  0.00000000e+00]
 [-8.05230016e-03  1.84501375e-02]]
grads:  [-0.00622122 -4.70723643]
Stock Position:  -0.006221217214426092
Bond Position:  [-13.13847985]


portfolio before change:  [-13.73311786]
curr_Stock_Price:  95.31826100702327
curr_Factors:  [9.53182610e+01 4.00396353e-02]
mat_Sqrt:  [[ 1.90730948e+01  0.00000000e+00]
 [-8.00396255e-03  1.83393821e-02]]
grads:  [ 2.68526411e-02 -5.51310643e+01]
Stock Position:  0.02685264110374383
Bond Position:  [-16.29266492]


portfolio before change:  [-13.76215186]
curr_Stock_Price:  94.31287428297934
curr_Factors:  [9.43128743e+01 4.03180019e-02]
mat_Sqrt:  [[ 1.89374056e+01  0.00000000e+00]
 [-8.03173724e-03  1.84030219e-02]]
grads:  [1.07536955e-02 2.23041233e+01]
Stock Position:  0.010753695535096176
Bond Position:  [-14.7763638]


portfolio before change:  [-13.75111731]
curr_Stock_Price:  95.51076183350757
curr_Factors:  [9.55107618e+01 3.90343358e-02]
mat_Sqrt:  [[ 1.88701654e+01  0.00000000e+00]
 [-7.90284362e-03  1.81076895e-02]]
grads:  [-3.21125133e-03 -7.90703205e+00]
Stock Position:  -0.0032112513290882207
Bond Position:  [-13.44440825]


portfolio before change:  [-13.75122731]
curr_Stock_Price:  95.02165121679279
curr_Factors:  [9.50216512e+01 4.03265999e-02]
mat_Sqrt:  [[ 1.90817577e+01  0.00000000e+00]
 [-8.03259359e-03  1.84049841e-02]]
grads:  [-0.00457304 -1.98444711]
Stock Position:  -0.0045730442521347454
Bond Position:  [-13.31668909]


portfolio before change:  [-13.75281096]
curr_Stock_Price:  95.00393093079884
curr_Factors:  [9.50039309e+01 4.12127544e-02]
mat_Sqrt:  [[ 1.92866765e+01  0.00000000e+00]
 [-8.12036989e-03  1.86061048e-02]]
grads:  [-0.00810235  0.09204907]
Stock Position:  -0.008102347772304884
Bond Position:  [-12.98305607]


portfolio before change:  [-13.75653234]
curr_Stock_Price:  95.26291657707891
curr_Factors:  [9.52629166e+01 4.09731297e-02]
mat_Sqrt:  [[ 1.92829486e+01  0.00000000e+00]
 [-8.09672820e-03  1.85519349e-02]]
grads:  [ 3.86640989e-03 -8.81935749e+00]
Stock Position:  0.003866409888586304
Bond Position:  [-14.12485782]


portfolio before change:  [-13.75248923]
curr_Stock_Price:  96.76529720524924
curr_Factors:  [9.67652972e+01 3.97464845e-02]
mat_Sqrt:  [[ 1.92916332e+01  0.00000000e+00]
 [-7.97460815e-03  1.82721227e-02]]
grads:  [0.01124327 6.4477197 ]
Stock Position:  0.011243273051501239
Bond Position:  [-14.84044789]


portfolio before change:  [-13.76185617]
curr_Stock_Price:  96.09718504553231
curr_Factors:  [9.60971850e+01 4.10929192e-02]
mat_Sqrt:  [[ 1.94802337e+01  0.00000000e+00]
 [-8.10855541e-03  1.85790345e-02]]
grads:  [5.52195775e-03 1.10118308e+01]
Stock Position:  0.00552195775419845
Bond Position:  [-14.29250077]


portfolio before change:  [-13.75682538]
curr_Stock_Price:  97.33179612690017
curr_Factors:  [9.73317961e+01 3.87346805e-02]
mat_Sqrt:  [[ 1.91559955e+01  0.00000000e+00]
 [-7.87245126e-03  1.80380519e-02]]
grads:  [1.42169053e-02 1.60811124e+01]
Stock Position:  0.01421690530227736
Bond Position:  [-15.14058231]


portfolio before change:  [-13.76352855]
curr_Stock_Price:  96.99343264043355
curr_Factors:  [9.69934326e+01 3.90787081e-02]
mat_Sqrt:  [[ 1.91739870e+01  0.00000000e+00]
 [-7.90733413e-03  1.81179786e-02]]
grads:  [ 0.01537241 13.64529697]
Stock Position:  0.015372408353090157
Bond Position:  [-15.2545512]


portfolio before change:  [-13.76683708]
curr_Stock_Price:  96.90225702572437
curr_Factors:  [9.6902257e+01 3.7606134e-02]
mat_Sqrt:  [[ 1.87915774e+01  0.00000000e+00]
 [-7.75692042e-03  1.77733375e-02]]
grads:  [0.01152917 1.38654647]
Stock Position:  0.011529168002244806
Bond Position:  [-14.88403948]


portfolio before change:  [-13.76322258]
curr_Stock_Price:  97.37715015682065
curr_Factors:  [9.73771502e+01 3.65877376e-02]
mat_Sqrt:  [[ 1.86262247e+01  0.00000000e+00]
 [-7.65116855e-03  1.75310295e-02]]
grads:  [ -0.01523116 -12.67368923]
Stock Position:  -0.015231158707631365
Bond Position:  [-12.28005575]


portfolio before change:  [-13.77479751]
curr_Stock_Price:  98.03631436888028
curr_Factors:  [9.80363144e+01 3.77675988e-02]
mat_Sqrt:  [[ 1.90522671e+01  0.00000000e+00]
 [-7.77355504e-03  1.78114522e-02]]
grads:  [9.83971075e-03 1.29530951e+01]
Stock Position:  0.009839710747080725
Bond Position:  [-14.73944649]


portfolio before change:  [-13.76513807]
curr_Stock_Price:  99.20524985985337
curr_Factors:  [9.92052499e+01 3.68870252e-02]
mat_Sqrt:  [[ 1.90533555e+01  0.00000000e+00]
 [-7.68239808e-03  1.76025854e-02]]
grads:  [ 0.00231577 -1.11044541]
Stock Position:  0.002315769957034925
Bond Position:  [-13.99487461]


portfolio before change:  [-13.76638183]
curr_Stock_Price:  99.42362640274787
curr_Factors:  [9.94236264e+01 3.68205424e-02]
mat_Sqrt:  [[ 1.90780811e+01  0.00000000e+00]
 [-7.67547183e-03  1.75867153e-02]]
grads:  [1.06008311e-03 9.15244233e+00]
Stock Position:  0.001060083105812249
Bond Position:  [-13.87177914]


portfolio before change:  [-13.76794041]
curr_Stock_Price:  99.58918364289732
curr_Factors:  [9.95891836e+01 3.76240855e-02]
mat_Sqrt:  [[ 1.93172433e+01  0.00000000e+00]
 [-7.75877161e-03  1.77775791e-02]]
grads:  [-0.00302436  0.91880756]
Stock Position:  -0.003024363071343846
Bond Position:  [-13.46674656]


portfolio before change:  [-13.77306944]
curr_Stock_Price:  100.72845992424813
curr_Factors:  [1.00728460e+02 3.59854887e-02]
mat_Sqrt:  [[ 1.91080292e+01  0.00000000e+00]
 [-7.58793660e-03  1.73861469e-02]]
grads:  [2.20292103e-03 3.56314495e+00]
Stock Position:  0.00220292102724791
Bond Position:  [-13.99496628]


portfolio before change:  [-13.77652559]
curr_Stock_Price:  99.95373080533523
curr_Factors:  [9.99537308e+01 3.61238422e-02]
mat_Sqrt:  [[ 1.89974792e+01  0.00000000e+00]
 [-7.60250929e-03  1.74195372e-02]]
grads:  [-2.40242076e-03 -4.96553211e+00]
Stock Position:  -0.0024024207611662274
Bond Position:  [-13.53639467]


portfolio before change:  [-13.78349463]
curr_Stock_Price:  102.15022022724943
curr_Factors:  [1.02150220e+02 3.37974308e-02]
mat_Sqrt:  [[ 1.87793757e+01  0.00000000e+00]
 [-7.35363102e-03  1.68492854e-02]]
grads:  [0.01439096 7.53839461]
Stock Position:  0.014390960136818553
Bond Position:  [-15.25353438]


portfolio before change:  [-13.77179135]
curr_Stock_Price:  103.09595957398555
curr_Factors:  [1.03095960e+02 3.31175413e-02]
mat_Sqrt:  [[ 1.87616353e+01  0.00000000e+00]
 [-7.27929022e-03  1.66789492e-02]]
grads:  [1.96942384e-03 2.74679912e+00]
Stock Position:  0.0019694238358760434
Bond Position:  [-13.97483099]


portfolio before change:  [-13.77415162]
curr_Stock_Price:  102.78454327243196
curr_Factors:  [1.02784543e+02 3.26530690e-02]
mat_Sqrt:  [[ 1.85733316e+01  0.00000000e+00]
 [-7.22806408e-03  1.65615754e-02]]
grads:  [5.85166128e-03 1.36843155e+01]
Stock Position:  0.005851661281574222
Bond Position:  [-14.37561195]


portfolio before change:  [-13.7789736]
curr_Stock_Price:  102.26761123768739
curr_Factors:  [1.02267611e+02 3.38708724e-02]
mat_Sqrt:  [[ 1.88213731e+01  0.00000000e+00]
 [-7.36161639e-03  1.68675822e-02]]
grads:  [5.93113869e-03 1.00652372e+01]
Stock Position:  0.005931138688189208
Bond Position:  [-14.38553698]


portfolio before change:  [-13.78893793]
curr_Stock_Price:  100.89080459214338
curr_Factors:  [1.00890805e+02 3.38627319e-02]
mat_Sqrt:  [[ 1.85657536e+01  0.00000000e+00]
 [-7.36073169e-03  1.68655551e-02]]
grads:  [2.69917771e-03 3.41458586e+00]
Stock Position:  0.0026991777132817805
Bond Position:  [-14.06126014]


portfolio before change:  [-13.79113794]
curr_Stock_Price:  100.72696154611482
curr_Factors:  [1.00726962e+02 3.30717405e-02]
mat_Sqrt:  [[ 1.83178399e+01  0.00000000e+00]
 [-7.27425493e-03  1.66674119e-02]]
grads:  [  0.03058168 -12.73756217]
Stock Position:  0.030581679781679937
Bond Position:  [-16.87153763]


portfolio before change:  [-13.81312008]
curr_Stock_Price:  100.07712592798303
curr_Factors:  [1.00077126e+02 3.34030984e-02]
mat_Sqrt:  [[ 1.82906105e+01  0.00000000e+00]
 [-7.31060582e-03  1.67507023e-02]]
grads:  [1.91556474e-03 3.77723882e+00]
Stock Position:  0.001915564738773913
Bond Position:  [-14.00482429]


portfolio before change:  [-13.81384728]
curr_Stock_Price:  100.6114380233922
curr_Factors:  [1.00611438e+02 3.11255548e-02]
mat_Sqrt:  [[ 1.77503086e+01  0.00000000e+00]
 [-7.05697440e-03  1.61695597e-02]]
grads:  [-2.12578034e-03  5.47281678e+00]
Stock Position:  -0.0021257803393545803
Bond Position:  [-13.59996947]


portfolio before change:  [-13.81654793]
curr_Stock_Price:  101.08210928271444
curr_Factors:  [1.01082109e+02 3.08436411e-02]
mat_Sqrt:  [[ 1.77524017e+01  0.00000000e+00]
 [-7.02494311e-03  1.60961668e-02]]
grads:  [-3.80831103e-04 -1.02373076e+01]
Stock Position:  -0.00038083110330853896
Bond Position:  [-13.77805272]


portfolio before change:  [-13.81849883]
curr_Stock_Price:  101.68219637226156
curr_Factors:  [1.01682196e+02 3.06700985e-02]
mat_Sqrt:  [[ 1.78074816e+01  0.00000000e+00]
 [-7.00515222e-03  1.60508202e-02]]
grads:  [-0.00387927 -2.1032596 ]
Stock Position:  -0.0038792738048708127
Bond Position:  [-13.42404575]


portfolio before change:  [-13.81726811]
curr_Stock_Price:  100.93235781800462
curr_Factors:  [1.00932358e+02 3.24866775e-02]
mat_Sqrt:  [[ 1.81921098e+01  0.00000000e+00]
 [-7.20962441e-03  1.65193248e-02]]
grads:  [-0.03392328 -5.89887985]
Stock Position:  -0.03392328405833269
Bond Position:  [-10.39331106]


portfolio before change:  [-13.80209113]
curr_Stock_Price:  100.44666727497905
curr_Factors:  [1.00446667e+02 3.27940804e-02]
mat_Sqrt:  [[ 1.81900235e+01  0.00000000e+00]
 [-7.24365437e-03  1.65972972e-02]]
grads:  [-0.00639121  0.24634558]
Stock Position:  -0.006391208140521941
Bond Position:  [-13.16011558]


portfolio before change:  [-13.81175701]
curr_Stock_Price:  101.70163436804589
curr_Factors:  [1.01701634e+02 3.26617437e-02]
mat_Sqrt:  [[ 1.83800892e+01  0.00000000e+00]
 [-7.22902413e-03  1.65637751e-02]]
grads:  [0.00839662 5.04341597]
Stock Position:  0.008396616391118435
Bond Position:  [-14.66570662]


portfolio before change:  [-13.81852649]
curr_Stock_Price:  101.11375978631193
curr_Factors:  [1.01113760e+02 3.38041283e-02]
mat_Sqrt:  [[ 1.85906738e+01  0.00000000e+00]
 [-7.35435961e-03  1.68509548e-02]]
grads:  [0.00931084 4.2146165 ]
Stock Position:  0.009310843170187336
Bond Position:  [-14.75998085]


portfolio before change:  [-13.8187491]
curr_Stock_Price:  101.28801919292253
curr_Factors:  [1.01288019e+02 3.32920825e-02]
mat_Sqrt:  [[ 1.84811316e+01  0.00000000e+00]
 [-7.29844723e-03  1.67228434e-02]]
grads:  [ -0.0199578 -10.7932484]
Stock Position:  -0.0199578042108572
Bond Position:  [-11.79726265]


portfolio before change:  [-13.82344107]
curr_Stock_Price:  101.44922029283443
curr_Factors:  [1.01449220e+02 3.32632628e-02]
mat_Sqrt:  [[ 1.85025309e+01  0.00000000e+00]
 [-7.29528756e-03  1.67156037e-02]]
grads:  [-1.73323190e-02 -2.47040647e+01]
Stock Position:  -0.017332319035887882
Bond Position:  [-12.06509082]


portfolio before change:  [-13.86301154]
curr_Stock_Price:  103.6452468281441
curr_Factors:  [1.03645247e+02 3.33444109e-02]
mat_Sqrt:  [[ 1.89260906e+01  0.00000000e+00]
 [-7.30418082e-03  1.67359807e-02]]
grads:  [-3.76083832e-03  1.27180935e+01]
Stock Position:  -0.003760838320994378
Bond Position:  [-13.47321852]


portfolio before change:  [-13.86761861]
curr_Stock_Price:  104.42241777585127
curr_Factors:  [1.04422418e+02 3.26257863e-02]
mat_Sqrt:  [[ 1.88614136e+01  0.00000000e+00]
 [-7.22504381e-03  1.65546551e-02]]
grads:  [-3.55466994e-03  7.27160357e+00]
Stock Position:  -0.0035546699414852278
Bond Position:  [-13.49643138]


portfolio before change:  [-13.87469103]
curr_Stock_Price:  105.93740024507719
curr_Factors:  [1.05937400e+02 3.20723465e-02]
mat_Sqrt:  [[ 1.89720683e+01  0.00000000e+00]
 [-7.16350155e-03  1.64136440e-02]]
grads:  [-5.64366022e-03  8.69074967e+00]
Stock Position:  -0.005643660219155349
Bond Position:  [-13.27681634]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.87046078]
Stock Price:  104.89375971971552
PL:  [-18.7642205]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-7.20630230e-02  1.70767605e-01]
 [-1.64887107e-01 -8.62502571e-02]
 [ 8.50421171e-01 -7.69013145e-01]
 [-1.49416031e-02  2.25888087e-01]
 [ 5.55926150e-03 -1.32913099e-01]
 [-7.29975049e-02 -5.16397351e-02]
 [-1.47482483e-01  5.65099710e-02]
 [ 9.08140746e-03 -1.31010934e-01]
 [ 1.65034097e-01  1.32512441e-01]
 [ 9.33416209e-02  9.94952304e-02]
 [ 1.33580882e-01  2.46715706e-01]
 [ 1.75922202e-01  2.58692111e-01]
 [ 1.68280172e-01  3.46429136e-02]
 [-2.26048774e-01 -3.07001095e-01]
 [ 8.82340319e-02  2.31895878e-01]
 [ 4.85623465e-02  2.16183183e-02]
 [ 8.94451354e-03 -5.93945086e-02]
 [ 5.91179273e-02  6.00702333e-02]
 [ 1.57949703e-02  4.36145543e-02]
 [ 8.27473383e-02 -9.89441895e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 9.05661623e-02  2.87554059e-01]
 [ 3.53005098e-02  2.41339056e-01]
 [-5.59380261e-02  1.26311998e-01]
 [ 3.82915533e-02  8.90371544e-02]
 [ 4.62259998e-02  1.05869548e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.69295187e-01  1.12579812e-01]
 [-2.33220351e-01 -2.06253566e-02]
 [ 1.44017753e-01 -7.99806561e-02]
 [-1.03107922e+00 -1.17524090e-01]
 [-1.20487645e-01  3.16108758e-02]
 [ 6.31431287e-03 -9.14479421e-02]
 [ 9.22304794e-02  9.66050862e-02]
 [-7.37442830e-02  1.60663449e-01]
 [-5.50487185e-01 -3.02774903e-01]
 [-4.99051773e-02  3.02674722e-01]
 [-1.24565662e-01  1.17017992e-01]
 [ 5.36016158e-01  4.02203828e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.00906887]
curr_Stock_Price:  99.59079628844513
curr_Factors:  [9.95907963e+01 3.92162625e-02]
mat_Sqrt:  [[ 1.97220614e+01  0.00000000e+00]
 [-7.92123854e-03  1.81498376e-02]]
grads:  [1.25041196e-04 9.40876767e+00]
Stock Position:  0.00012504119641352493
Bond Position:  [-0.02152182]


portfolio before change:  [-0.00912908]
curr_Stock_Price:  99.13078593773092
curr_Factors:  [9.91307859e+01 3.94859877e-02]
mat_Sqrt:  [[ 1.96983592e+01  0.00000000e+00]
 [-7.94843257e-03  1.82121470e-02]]
grads:  [-0.01028156 -4.73586433]
Stock Position:  -0.01028155711065417
Bond Position:  [1.01008976]


portfolio before change:  [-0.00214766]
curr_Stock_Price:  98.46404376435812
curr_Factors:  [9.84640438e+01 4.02402481e-02]
mat_Sqrt:  [[ 1.97518597e+01  0.00000000e+00]
 [-8.02398884e-03  1.83852681e-02]]
grads:  [ 2.60631822e-02 -4.18276818e+01]
Stock Position:  0.026063182208533993
Bond Position:  [-2.56843398]


portfolio before change:  [-0.03968774]
curr_Stock_Price:  97.03601384186133
curr_Factors:  [9.70360138e+01 4.17158929e-02]
mat_Sqrt:  [[ 1.98190905e+01  0.00000000e+00]
 [-8.16978756e-03  1.87193349e-02]]
grads:  [4.22037734e-03 1.20671000e+01]
Stock Position:  0.004220377344639829
Bond Position:  [-0.44921634]


portfolio before change:  [-0.04497863]
curr_Stock_Price:  95.79566661689452
curr_Factors:  [9.57956666e+01 4.32910482e-02]
mat_Sqrt:  [[ 1.99317263e+01  0.00000000e+00]
 [-8.32260038e-03  1.90694731e-02]]
grads:  [-2.63142138e-03 -6.96994082e+00]
Stock Position:  -0.002631421375534322
Bond Position:  [0.20710013]


portfolio before change:  [-0.04403106]
curr_Stock_Price:  95.4454058295758
curr_Factors:  [9.54454058e+01 4.26191533e-02]
mat_Sqrt:  [[ 1.97041379e+01  0.00000000e+00]
 [-8.25776273e-03  1.89209114e-02]]
grads:  [-0.00484847 -2.72924142]
Stock Position:  -0.004848470590554396
Bond Position:  [0.41873319]


portfolio before change:  [-0.04491994]
curr_Stock_Price:  95.63953463769488
curr_Factors:  [9.56395346e+01 4.20017305e-02]
mat_Sqrt:  [[ 1.96006758e+01  0.00000000e+00]
 [-8.19772949e-03  1.87833580e-02]]
grads:  [-0.00626609  3.0085127 ]
Stock Position:  -0.006266085426305442
Bond Position:  [0.55436555]


portfolio before change:  [-0.05124508]
curr_Stock_Price:  96.66001845264178
curr_Factors:  [9.66600185e+01 4.29241735e-02]
mat_Sqrt:  [[ 2.00261675e+01  0.00000000e+00]
 [-8.28725996e-03  1.89884980e-02]]
grads:  [-2.40168029e-03 -6.89948904e+00]
Stock Position:  -0.0024016802883367067
Bond Position:  [0.18090138]


portfolio before change:  [-0.04943171]
curr_Stock_Price:  95.91439226878632
curr_Factors:  [9.59143923e+01 4.23423969e-02]
mat_Sqrt:  [[ 1.97365618e+01  0.00000000e+00]
 [-8.23090731e-03  1.88593779e-02]]
grads:  [0.0112921  7.02634208]
Stock Position:  0.011292101931699943
Bond Position:  [-1.1325068]


portfolio before change:  [-0.03301561]
curr_Stock_Price:  97.38069803407772
curr_Factors:  [9.73806980e+01 4.10550647e-02]
mat_Sqrt:  [[ 1.97313252e+01  0.00000000e+00]
 [-8.10481977e-03  1.85704751e-02]]
grads:  [0.00693136 5.35771056]
Stock Position:  0.006931359055831412
Bond Position:  [-0.70799619]


portfolio before change:  [-0.02927448]
curr_Stock_Price:  97.93320597347677
curr_Factors:  [9.7933206e+01 4.2854704e-02]
mat_Sqrt:  [[ 2.02735229e+01  0.00000000e+00]
 [-8.28055109e-03  1.89731261e-02]]
grads:  [1.19000751e-02 1.30034294e+01]
Stock Position:  0.01190007505817494
Bond Position:  [-1.19468698]


portfolio before change:  [-0.04563369]
curr_Stock_Price:  96.57104092605162
curr_Factors:  [9.65710409e+01 4.48116018e-02]
mat_Sqrt:  [[ 2.04428832e+01  0.00000000e+00]
 [-8.46750040e-03  1.94014808e-02]]
grads:  [ 0.01412837 13.33362716]
Stock Position:  0.01412837378662242
Bond Position:  [-1.41002546]


portfolio before change:  [-0.02197605]
curr_Stock_Price:  98.25799421109218
curr_Factors:  [9.82579942e+01 4.36197671e-02]
mat_Sqrt:  [[ 2.05215219e+01  0.00000000e+00]
 [-8.35413834e-03  1.91417356e-02]]
grads:  [0.00893694 1.80981047]
Stock Position:  0.008936938469878307
Bond Position:  [-0.9001017]


portfolio before change:  [-0.02216488]
curr_Stock_Price:  98.24945580925407
curr_Factors:  [9.82494558e+01 4.39918844e-02]
mat_Sqrt:  [[ 2.06070790e+01  0.00000000e+00]
 [-8.38969695e-03  1.92232107e-02]]
grads:  [ -0.01747143 -15.97033398]
Stock Position:  -0.01747142503074753
Bond Position:  [1.69439312]


portfolio before change:  [-0.01136693]
curr_Stock_Price:  97.64354433571592
curr_Factors:  [9.76435443e+01 4.50357793e-02]
mat_Sqrt:  [[ 2.07215566e+01  0.00000000e+00]
 [-8.48865401e-03  1.94499498e-02]]
grads:  [9.14225191e-03 1.19226980e+01]
Stock Position:  0.009142251905600455
Bond Position:  [-0.90404881]


portfolio before change:  [-0.01449214]
curr_Stock_Price:  97.31406340524369
curr_Factors:  [9.73140634e+01 4.58437230e-02]
mat_Sqrt:  [[ 2.08360575e+01  0.00000000e+00]
 [-8.56445893e-03  1.96236407e-02]]
grads:  [0.00278351 1.10164667]
Stock Position:  0.0027835090276350652
Bond Position:  [-0.28536671]


portfolio before change:  [-0.01313836]
curr_Stock_Price:  97.81323445495904
curr_Factors:  [9.78132345e+01 4.63978586e-02]
mat_Sqrt:  [[ 2.10691293e+01  0.00000000e+00]
 [-8.61606486e-03  1.97418847e-02]]
grads:  [-8.05793867e-04 -3.00855311e+00]
Stock Position:  -0.0008057938672629512
Bond Position:  [0.06567894]


portfolio before change:  [-0.01223209]
curr_Stock_Price:  96.69872914781698
curr_Factors:  [9.66987291e+01 4.78408301e-02]
mat_Sqrt:  [[ 2.11504747e+01  0.00000000e+00]
 [-8.74901870e-03  2.00465202e-02]]
grads:  [0.00403465 2.99654168]
Stock Position:  0.004034648281494778
Bond Position:  [-0.40237745]


portfolio before change:  [-0.00819062]
curr_Stock_Price:  97.71288665761631
curr_Factors:  [9.77128867e+01 4.66760085e-02]
mat_Sqrt:  [[ 2.11105087e+01  0.00000000e+00]
 [-8.64185244e-03  1.98009715e-02]]
grads:  [1.64988551e-03 2.20264720e+00]
Stock Position:  0.0016498855088509926
Bond Position:  [-0.1694057]


portfolio before change:  [-0.00717328]
curr_Stock_Price:  98.34233801127135
curr_Factors:  [9.83423380e+01 4.79125309e-02]
mat_Sqrt:  [[ 2.15260867e+01  0.00000000e+00]
 [-8.75557248e-03  2.00615368e-02]]
grads:  [ 1.83798171e-03 -4.93203439e+00]
Stock Position:  0.0018379817121371008
Bond Position:  [-0.1879247]


portfolio before change:  [-0.00751622]
curr_Stock_Price:  98.16853230503935
curr_Factors:  [9.81685323e+01 4.92158595e-02]
mat_Sqrt:  [[ 2.17783431e+01  0.00000000e+00]
 [-8.87385909e-03  2.03325655e-02]]
grads:  [ 0.00193443 -1.85800408]
Stock Position:  0.0019344268048889432
Bond Position:  [-0.19741606]


portfolio before change:  [-0.0071841]
curr_Stock_Price:  98.3529800417467
curr_Factors:  [9.83529800e+01 4.82659161e-02]
mat_Sqrt:  [[ 2.16076631e+01  0.00000000e+00]
 [-8.78780210e-03  2.01353842e-02]]
grads:  [9.99946368e-03 1.42810317e+01]
Stock Position:  0.009999463680879207
Bond Position:  [-0.99066115]


portfolio before change:  [-0.01146669]
curr_Stock_Price:  97.9370823490106
curr_Factors:  [9.79370823e+01 4.78396789e-02]
mat_Sqrt:  [[ 2.14210764e+01  0.00000000e+00]
 [-8.74891343e-03  2.00462790e-02]]
grads:  [6.56500666e-03 1.20390949e+01]
Stock Position:  0.006565006656871945
Bond Position:  [-0.65442429]


portfolio before change:  [-0.00579703]
curr_Stock_Price:  98.81316248323071
curr_Factors:  [9.88131625e+01 4.62892020e-02]
mat_Sqrt:  [[ 2.12595783e+01  0.00000000e+00]
 [-8.60597020e-03  1.97187549e-02]]
grads:  [-3.81451879e-05  6.40567817e+00]
Stock Position:  -3.814518786679802e-05
Bond Position:  [-0.00202778]


portfolio before change:  [-0.00575861]
curr_Stock_Price:  97.79929396437126
curr_Factors:  [9.77992940e+01 4.52954546e-02]
mat_Sqrt:  [[ 2.08143585e+01  0.00000000e+00]
 [-8.51309153e-03  1.95059432e-02]]
grads:  [3.70660250e-03 4.56461672e+00]
Stock Position:  0.0037066024963467335
Bond Position:  [-0.36826172]


portfolio before change:  [-0.01315509]
curr_Stock_Price:  95.81622577372822
curr_Factors:  [9.58162258e+01 4.64767309e-02]
mat_Sqrt:  [[ 2.06565052e+01  0.00000000e+00]
 [-8.62338503e-03  1.97586573e-02]]
grads:  [4.47468038e-03 5.35813471e+00]
Stock Position:  0.004474680379158232
Bond Position:  [-0.44190208]


portfolio before change:  [-0.01634246]
curr_Stock_Price:  95.1162599693275
curr_Factors:  [9.51162600e+01 4.75118974e-02]
mat_Sqrt:  [[ 2.07327042e+01  0.00000000e+00]
 [-8.71888960e-03  1.99774858e-02]]
grads:  [8.59326397e-03 8.75672726e+00]
Stock Position:  0.008593263966618173
Bond Position:  [-0.83370159]


portfolio before change:  [-0.01158758]
curr_Stock_Price:  95.6817135118586
curr_Factors:  [9.56817135e+01 4.73480814e-02]
mat_Sqrt:  [[ 2.08199718e+01  0.00000000e+00]
 [-8.70384572e-03  1.99430159e-02]]
grads:  [-0.00577145  5.64507455]
Stock Position:  -0.005771445342131663
Bond Position:  [0.5406342]


portfolio before change:  [-0.01242684]
curr_Stock_Price:  95.83883968252601
curr_Factors:  [9.58388397e+01 4.90536259e-02]
mat_Sqrt:  [[ 2.12264372e+01  0.00000000e+00]
 [-8.85922126e-03  2.02990260e-02]]
grads:  [-0.01141134 -1.01607617]
Stock Position:  -0.011411335418295726
Bond Position:  [1.0812223]


portfolio before change:  [-0.01726424]
curr_Stock_Price:  96.27459539899962
curr_Factors:  [9.62745954e+01 4.91874105e-02]
mat_Sqrt:  [[ 2.13520060e+01  0.00000000e+00]
 [-8.87129398e-03  2.03266881e-02]]
grads:  [ 0.00511012 -3.93476083]
Stock Position:  0.005110120926130796
Bond Position:  [-0.50923906]


portfolio before change:  [-0.01748129]
curr_Stock_Price:  96.2445780328686
curr_Factors:  [9.62445780e+01 5.03031555e-02]
mat_Sqrt:  [[ 2.15860852e+01  0.00000000e+00]
 [-8.97134599e-03  2.05559360e-02]]
grads:  [-0.05014207 -5.71728235]
Stock Position:  -0.050142067254896915
Bond Position:  [4.80842082]


portfolio before change:  [-0.07661727]
curr_Stock_Price:  97.43593447223245
curr_Factors:  [9.74359345e+01 4.90227448e-02]
mat_Sqrt:  [[ 2.15733687e+01  0.00000000e+00]
 [-8.85643222e-03  2.02926355e-02]]
grads:  [-0.00494552  1.55775112]
Stock Position:  -0.004945520034372206
Bond Position:  [0.40525409]


portfolio before change:  [-0.08198313]
curr_Stock_Price:  98.53117121517631
curr_Factors:  [9.85311712e+01 4.98059643e-02]
mat_Sqrt:  [[ 2.19894477e+01  0.00000000e+00]
 [-8.92689996e-03  2.04540974e-02]]
grads:  [-1.52786198e-03 -4.47088622e+00]
Stock Position:  -0.001527861981228682
Bond Position:  [0.0685589]


portfolio before change:  [-0.08095277]
curr_Stock_Price:  97.86240323084354
curr_Factors:  [9.78624032e+01 5.19015179e-02]
mat_Sqrt:  [[ 2.22949194e+01  0.00000000e+00]
 [-9.11276186e-03  2.08799605e-02]]
grads:  [0.00602794 4.62668913]
Stock Position:  0.006027938172662436
Bond Position:  [-0.67086129]


portfolio before change:  [-0.08662943]
curr_Stock_Price:  96.93459196165124
curr_Factors:  [9.69345920e+01 5.24905462e-02]
mat_Sqrt:  [[ 2.22085054e+01  0.00000000e+00]
 [-9.16432616e-03  2.09981092e-02]]
grads:  [-1.63225991e-04  7.65132935e+00]
Stock Position:  -0.00016322599140888426
Bond Position:  [-0.07080718]


portfolio before change:  [-0.08695262]
curr_Stock_Price:  98.8604193425011
curr_Factors:  [9.88604193e+01 5.20530476e-02]
mat_Sqrt:  [[ 2.25551401e+01  0.00000000e+00]
 [-9.12605480e-03  2.09104185e-02]]
grads:  [ -0.0302649  -14.47961949]
Stock Position:  -0.03026489673400933
Bond Position:  [2.90504776]


portfolio before change:  [-0.10548065]
curr_Stock_Price:  99.48461391160622
curr_Factors:  [9.94846139e+01 5.22884056e-02]
mat_Sqrt:  [[ 2.27488066e+01  0.00000000e+00]
 [-9.14666327e-03  2.09576384e-02]]
grads:  [3.61306432e-03 1.44422151e+01]
Stock Position:  0.0036130643152278157
Bond Position:  [-0.46492496]


portfolio before change:  [-0.10547717]
curr_Stock_Price:  99.50166358980532
curr_Factors:  [9.95016636e+01 5.29521353e-02]
mat_Sqrt:  [[ 2.28966571e+01  0.00000000e+00]
 [-9.20453239e-03  2.10902332e-02]]
grads:  [-3.20984950e-03  5.54844467e+00]
Stock Position:  -0.0032098494975719882
Bond Position:  [0.21390819]


portfolio before change:  [-0.10323694]
curr_Stock_Price:  98.81207100370797
curr_Factors:  [9.88120710e+01 5.28305481e-02]
mat_Sqrt:  [[ 2.27118526e+01  0.00000000e+00]
 [-9.19395872e-03  2.10660059e-02]]
grads:  [0.02437361 1.90925527]
Stock Position:  0.024373607154426838
Bond Position:  [-2.51164354]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.15149673]
Stock Price:  96.84495070785405
PL:  [-0.15149673]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.45274626e-01  8.35542162e-01]
 [-2.36850268e-01 -6.70311396e-02]
 [ 7.87168840e-01 -6.61146001e-01]
 [ 4.57983190e-03  2.41184262e-02]
 [-6.05420309e-02  2.75894528e-02]
 [-8.82356947e-02 -7.13845483e-02]
 [-1.13610300e-01  1.07773229e-01]
 [-9.90002073e-02 -1.04155262e-01]
 [ 1.65720118e-01  1.10052381e-01]
 [ 9.52079204e-02  9.62947643e-02]
 [ 1.46010338e-01  2.91031518e-01]
 [ 1.59533735e-01  2.75885257e-01]
 [ 2.51428969e-01  2.23903750e-02]
 [-8.17377867e-02 -4.20628647e-02]
 [ 9.31609975e-02  2.35814737e-01]
 [ 3.94946503e-02  1.41831264e-01]
 [ 8.70629644e-02  1.88778743e-01]
 [ 7.42108464e-02  6.28986472e-02]
 [ 1.23326863e-02  4.47026803e-02]
 [ 2.24607097e-01 -1.07822874e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 1.44710810e-02  1.91587382e-01]
 [ 2.07755490e-02  1.18258302e-01]
 [-2.64886309e-02 -8.40833642e-03]
 [ 4.47159538e-02  1.44703853e-01]
 [ 1.20910191e-01  6.19932353e-02]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.67485611e-01  1.09334276e-01]
 [-3.02189365e-01  1.43242944e-02]
 [ 2.18249857e-01 -9.71145860e-02]
 [-1.34471417e+00 -1.51145077e-01]
 [ 1.42603301e-01  3.73480302e-01]
 [ 9.11845751e-03 -1.34036909e-01]
 [-1.58543402e-03  6.11075354e-02]
 [-1.82163987e-02  1.69954441e-01]
 [-2.06076510e+00  3.60117103e-03]
 [-8.80382142e-02  2.12957943e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.18793991e+00 -4.01514158e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.1467953]
curr_Stock_Price:  101.57228236556884
curr_Factors:  [1.01572282e+02 3.78272183e-02]
mat_Sqrt:  [[ 1.97550173e+01  0.00000000e+00]
 [-7.77968825e-03  1.78255051e-02]]
grads:  [4.09989579e-02 4.68734073e+01]
Stock Position:  0.0409989578882007
Bond Position:  [8.98243757]


portfolio before change:  [13.16480197]
curr_Stock_Price:  101.98409267263871
curr_Factors:  [1.01984093e+02 3.67162703e-02]
mat_Sqrt:  [[ 1.95416718e+01  0.00000000e+00]
 [-7.66459604e-03  1.75617958e-02]]
grads:  [-0.01361731 -3.81687275]
Stock Position:  -0.013617312693639612
Bond Position:  [14.55355125]


portfolio before change:  [13.18754621]
curr_Stock_Price:  100.44745092888931
curr_Factors:  [1.00447451e+02 3.76209878e-02]
mat_Sqrt:  [[ 1.94829187e+01  0.00000000e+00]
 [-7.75845220e-03  1.77768472e-02]]
grads:  [ 2.55927296e-02 -3.71914093e+01]
Stock Position:  0.025592729579212107
Bond Position:  [10.61682176]


portfolio before change:  [13.19310683]
curr_Stock_Price:  100.61286632459779
curr_Factors:  [1.00612866e+02 3.79962728e-02]
mat_Sqrt:  [[ 1.96120964e+01  0.00000000e+00]
 [-7.79705307e-03  1.78652929e-02]]
grads:  [7.70237701e-04 1.35001572e+00]
Stock Position:  0.000770237701168911
Bond Position:  [13.115611]


portfolio before change:  [13.19465273]
curr_Stock_Price:  100.4912809907947
curr_Factors:  [1.00491281e+02 3.77244754e-02]
mat_Sqrt:  [[ 1.95182100e+01  0.00000000e+00]
 [-7.76911582e-03  1.78012807e-02]]
grads:  [-0.00248491  1.54985775]
Stock Position:  -0.002484910577310965
Bond Position:  [13.44436458]


portfolio before change:  [13.20047273]
curr_Stock_Price:  98.82548648340993
curr_Factors:  [9.88254865e+01 3.81085490e-02]
mat_Sqrt:  [[ 1.92921294e+01  0.00000000e+00]
 [-7.80856442e-03  1.78916688e-02]]
grads:  [-0.00618856 -3.98982058]
Stock Position:  -0.0061885581938863855
Bond Position:  [13.81206]


portfolio before change:  [13.2139954]
curr_Stock_Price:  96.91938003732108
curr_Factors:  [9.69193800e+01 3.91281942e-02]
mat_Sqrt:  [[ 1.91714751e+01  0.00000000e+00]
 [-7.91233915e-03  1.81294465e-02]]
grads:  [-3.47256570e-03  5.94465078e+00]
Stock Position:  -0.003472565702757137
Bond Position:  [13.55055431]


portfolio before change:  [13.21240306]
curr_Stock_Price:  97.8657307048712
curr_Factors:  [9.78657307e+01 3.84728330e-02]
mat_Sqrt:  [[ 1.91958667e+01  0.00000000e+00]
 [-7.84579714e-03  1.79769796e-02]]
grads:  [-0.00752544 -5.79381318]
Stock Position:  -0.007525437224624627
Bond Position:  [13.94888547]


portfolio before change:  [13.21904692]
curr_Stock_Price:  97.2145861534592
curr_Factors:  [9.72145862e+01 3.83721361e-02]
mat_Sqrt:  [[ 1.90431777e+01  0.00000000e+00]
 [-7.83552281e-03  1.79534382e-02]]
grads:  [0.01122454 6.12987774]
Stock Position:  0.01122454028413038
Bond Position:  [12.12785789]


portfolio before change:  [13.22290803]
curr_Stock_Price:  97.42350574007216
curr_Factors:  [9.74235057e+01 3.87490871e-02]
mat_Sqrt:  [[ 1.91776104e+01  0.00000000e+00]
 [-7.87391512e-03  1.80414060e-02]]
grads:  [0.00715597 5.33743125]
Stock Position:  0.007155969819735002
Bond Position:  [12.52574836]


portfolio before change:  [13.22371817]
curr_Stock_Price:  97.31790479138412
curr_Factors:  [9.73179048e+01 3.81693296e-02]
mat_Sqrt:  [[ 1.90129723e+01  0.00000000e+00]
 [-7.81478902e-03  1.79059311e-02]]
grads:  [1.43600328e-02 1.62533585e+01]
Stock Position:  0.01436003275963514
Bond Position:  [11.82622987]


portfolio before change:  [13.20501938]
curr_Stock_Price:  95.9128134924544
curr_Factors:  [9.59128135e+01 3.89843649e-02]
mat_Sqrt:  [[ 1.89374658e+01  0.00000000e+00]
 [-7.89778348e-03  1.80960953e-02]]
grads:  [1.47823333e-02 1.52455683e+01]
Stock Position:  0.014782333313259776
Bond Position:  [11.7872042]


portfolio before change:  [13.20706633]
curr_Stock_Price:  95.95160674855595
curr_Factors:  [9.59516067e+01 4.03401552e-02]
mat_Sqrt:  [[ 1.92717447e+01  0.00000000e+00]
 [-8.03394351e-03  1.84080771e-02]]
grads:  [0.01355357 1.21633427]
Stock Position:  0.013553569441953413
Bond Position:  [11.90657956]


portfolio before change:  [13.20441872]
curr_Stock_Price:  95.64644543852401
curr_Factors:  [9.56464454e+01 4.09614377e-02]
mat_Sqrt:  [[ 1.93578193e+01  0.00000000e+00]
 [-8.09557288e-03  1.85492878e-02]]
grads:  [-0.00517081 -2.26762694]
Stock Position:  -0.005170805889428865
Bond Position:  [13.69898792]


portfolio before change:  [13.20258575]
curr_Stock_Price:  96.33211260567293
curr_Factors:  [9.63321126e+01 4.05037984e-02]
mat_Sqrt:  [[ 1.93873728e+01  0.00000000e+00]
 [-8.05022220e-03  1.84453763e-02]]
grads:  [1.01137471e-02 1.27844904e+01]
Stock Position:  0.010113747148179596
Bond Position:  [12.22830712]


portfolio before change:  [13.19048436]
curr_Stock_Price:  94.98443973811499
curr_Factors:  [9.49844397e+01 4.17367580e-02]
mat_Sqrt:  [[ 1.94049184e+01  0.00000000e+00]
 [-8.17183044e-03  1.87240158e-02]]
grads:  [5.22521593e-03 7.57483149e+00]
Stock Position:  0.005225215934925407
Bond Position:  [12.69417015]


portfolio before change:  [13.19319193]
curr_Stock_Price:  95.19891816778494
curr_Factors:  [9.51989182e+01 4.20010942e-02]
mat_Sqrt:  [[ 1.95102267e+01  0.00000000e+00]
 [-8.19766740e-03  1.87832157e-02]]
grads:  [8.68533027e-03 1.00503953e+01]
Stock Position:  0.008685330271458225
Bond Position:  [12.36635788]


portfolio before change:  [13.20269278]
curr_Stock_Price:  96.11482618713725
curr_Factors:  [9.61148262e+01 4.13641108e-02]
mat_Sqrt:  [[ 1.95479955e+01  0.00000000e+00]
 [-8.13526750e-03  1.86402396e-02]]
grads:  [0.00520064 3.37434758]
Stock Position:  0.005200638923881356
Bond Position:  [12.70283427]


portfolio before change:  [13.20795663]
curr_Stock_Price:  96.82164256201875
curr_Factors:  [9.68216426e+01 4.02060526e-02]
mat_Sqrt:  [[ 1.94141403e+01  0.00000000e+00]
 [-8.02057879e-03  1.83774547e-02]]
grads:  [1.64017231e-03 2.43247397e+00]
Stock Position:  0.0016401723130441306
Bond Position:  [13.04915245]


portfolio before change:  [13.20870286]
curr_Stock_Price:  96.28205364748253
curr_Factors:  [9.62820536e+01 3.95024350e-02]
mat_Sqrt:  [[ 1.91362695e+01  0.00000000e+00]
 [-7.95008780e-03  1.82159396e-02]]
grads:  [ 0.00927816 -5.91914977]
Stock Position:  0.009278158221508556
Bond Position:  [12.31538273]


portfolio before change:  [13.215601]
curr_Stock_Price:  96.85960581498927
curr_Factors:  [9.68596058e+01 3.82931155e-02]
mat_Sqrt:  [[ 1.89540948e+01  0.00000000e+00]
 [-7.82745072e-03  1.79349427e-02]]
grads:  [ 0.00222267 -2.10639031]
Stock Position:  0.0022226653962770498
Bond Position:  [13.0003145]


portfolio before change:  [13.21574297]
curr_Stock_Price:  96.19231113253997
curr_Factors:  [9.61923111e+01 3.80930942e-02]
mat_Sqrt:  [[ 1.87742884e+01  0.00000000e+00]
 [-7.80698090e-03  1.78880405e-02]]
grads:  [5.22452131e-03 1.07103616e+01]
Stock Position:  0.005224521308116067
Bond Position:  [12.71318419]


portfolio before change:  [13.21579488]
curr_Stock_Price:  95.89805861165192
curr_Factors:  [9.58980586e+01 3.86915821e-02]
mat_Sqrt:  [[ 1.88633168e+01  0.00000000e+00]
 [-7.86807037e-03  1.80280140e-02]]
grads:  [3.83748543e-03 6.55969661e+00]
Stock Position:  0.003837485430727281
Bond Position:  [12.84778748]


portfolio before change:  [13.21330095]
curr_Stock_Price:  94.82964908541943
curr_Factors:  [9.48296491e+01 3.91377828e-02]
mat_Sqrt:  [[ 1.87604069e+01  0.00000000e+00]
 [-7.91330857e-03  1.81316678e-02]]
grads:  [-0.00160755 -0.46373762]
Stock Position:  -0.0016075520094263039
Bond Position:  [13.36574454]


portfolio before change:  [13.21531778]
curr_Stock_Price:  94.61441325958947
curr_Factors:  [9.46144133e+01 3.82290113e-02]
mat_Sqrt:  [[ 1.84992377e+01  0.00000000e+00]
 [-7.82089625e-03  1.79199245e-02]]
grads:  [5.83104527e-03 8.07502578e+00]
Stock Position:  0.0058310452667034085
Bond Position:  [12.66361685]


portfolio before change:  [13.22905867]
curr_Stock_Price:  96.69943180059302
curr_Factors:  [9.66994318e+01 3.56630333e-02]
mat_Sqrt:  [[ 1.82613576e+01  0.00000000e+00]
 [-7.55386347e-03  1.73080756e-02]]
grads:  [0.0081027  3.58175206]
Stock Position:  0.008102697523342544
Bond Position:  [12.44553242]


portfolio before change:  [13.22023651]
curr_Stock_Price:  95.41863038301453
curr_Factors:  [9.54186304e+01 3.63648861e-02]
mat_Sqrt:  [[ 1.81959316e+01  0.00000000e+00]
 [-7.62783179e-03  1.74775583e-02]]
grads:  [9.79128767e-03 1.00092582e+01]
Stock Position:  0.009791287673084407
Bond Position:  [12.28596525]


portfolio before change:  [13.22135002]
curr_Stock_Price:  95.37549752862836
curr_Factors:  [9.53754975e+01 3.75096161e-02]
mat_Sqrt:  [[ 1.84717536e+01  0.00000000e+00]
 [-7.74695978e-03  1.77505148e-02]]
grads:  [-0.00648386  6.15949888]
Stock Position:  -0.006483857672402383
Bond Position:  [13.83975117]


portfolio before change:  [13.2270326]
curr_Stock_Price:  94.76590697504683
curr_Factors:  [9.47659070e+01 3.95970989e-02]
mat_Sqrt:  [[ 1.88574866e+01  0.00000000e+00]
 [-7.95960792e-03  1.82377529e-02]]
grads:  [-0.01569338  0.78541992]
Stock Position:  -0.015693381440733973
Bond Position:  [14.71423012]


portfolio before change:  [13.24009022]
curr_Stock_Price:  94.05106871738094
curr_Factors:  [9.40510687e+01 3.98629608e-02]
mat_Sqrt:  [[ 1.87779644e+01  0.00000000e+00]
 [-7.98628432e-03  1.82988762e-02]]
grads:  [ 0.00936553 -5.30713388]
Stock Position:  0.009365529369022648
Bond Position:  [12.35925218]


portfolio before change:  [13.23369641]
curr_Stock_Price:  93.20340591163753
curr_Factors:  [9.32034059e+01 3.91084636e-02]
mat_Sqrt:  [[ 1.84317750e+01  0.00000000e+00]
 [-7.91034397e-03  1.81248750e-02]]
grads:  [-0.07653518 -8.33909623]
Stock Position:  -0.07653518405171374
Bond Position:  [20.36703624]


portfolio before change:  [13.23041961]
curr_Stock_Price:  93.27948655954548
curr_Factors:  [9.32794866e+01 4.00437338e-02]
mat_Sqrt:  [[ 1.86660932e+01  0.00000000e+00]
 [-8.00437218e-03  1.83403207e-02]]
grads:  [1.63721173e-02 2.03638915e+01]
Stock Position:  0.01637211734360525
Bond Position:  [11.70323691]


portfolio before change:  [13.21844811]
curr_Stock_Price:  92.45891484019269
curr_Factors:  [9.24589148e+01 4.03450092e-02]
mat_Sqrt:  [[ 1.85713597e+01  0.00000000e+00]
 [-8.03442684e-03  1.84091846e-02]]
grads:  [-2.65893540e-03 -7.28098025e+00]
Stock Position:  -0.0026589353994113676
Bond Position:  [13.46429039]


portfolio before change:  [13.21899763]
curr_Stock_Price:  92.88525850201339
curr_Factors:  [9.28852585e+01 4.07617725e-02]
mat_Sqrt:  [[ 1.87531110e+01  0.00000000e+00]
 [-8.07581797e-03  1.85040236e-02]]
grads:  [1.33759571e-03 3.30239178e+00]
Stock Position:  0.001337595711939237
Bond Position:  [13.0947547]


portfolio before change:  [13.21938994]
curr_Stock_Price:  91.95476032340817
curr_Factors:  [9.19547603e+01 4.07168680e-02]
mat_Sqrt:  [[ 1.85550188e+01  0.00000000e+00]
 [-8.07136846e-03  1.84938285e-02]]
grads:  [3.01577708e-03 9.18979223e+00]
Stock Position:  0.0030157770775363947
Bond Position:  [12.94207489]


portfolio before change:  [13.22126653]
curr_Stock_Price:  92.04055007672375
curr_Factors:  [9.20405501e+01 4.22406826e-02]
mat_Sqrt:  [[ 1.89166692e+01  0.00000000e+00]
 [-8.22101528e-03  1.88367124e-02]]
grads:  [-0.10885603  0.19117832]
Stock Position:  -0.10885602526058745
Bond Position:  [23.24043497]


portfolio before change:  [13.06539117]
curr_Stock_Price:  93.4991794663911
curr_Factors:  [9.34991795e+01 4.02735737e-02]
mat_Sqrt:  [[ 1.87636742e+01  0.00000000e+00]
 [-8.02731075e-03  1.83928796e-02]]
grads:  [2.61369487e-04 1.15782818e+01]
Stock Position:  0.0002613694870813616
Bond Position:  [13.04095333]


portfolio before change:  [13.06718896]
curr_Stock_Price:  94.14032376982274
curr_Factors:  [9.41403238e+01 3.97361930e-02]
mat_Sqrt:  [[ 1.87658749e+01  0.00000000e+00]
 [-7.97357566e-03  1.82697570e-02]]
grads:  [-4.69923284e-03  5.98594520e+00]
Stock Position:  -0.004699232835037441
Bond Position:  [13.50957626]


portfolio before change:  [13.0708484]
curr_Stock_Price:  93.72097142951532
curr_Factors:  [9.37209714e+01 3.88860236e-02]
mat_Sqrt:  [[ 1.84813439e+01  0.00000000e+00]
 [-7.88781578e-03  1.80732564e-02]]
grads:  [ 0.06332961 -2.22159277]
Stock Position:  0.0633296149741089
Bond Position:  [7.13553536]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.03972507]
Stock Price:  93.21543666755377
PL:  [13.03972507]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.15561668e-01  7.86489216e-01]
 [-2.78931496e-01 -5.61682177e-02]
 [ 9.67579767e-01 -8.84670716e-01]
 [-1.39911075e-01 -2.46602372e-02]
 [-1.80701035e-01  1.11289582e-01]
 [ 4.84975589e-01  4.16007378e-01]
 [ 2.03257107e-01 -4.54634295e-01]
 [ 6.38529443e-01 -3.31932614e-02]
 [-5.24280897e-01 -3.60104413e-01]
 [ 7.56071378e-01 -6.73839708e-01]
 [ 5.90448475e-02 -1.66696108e-02]
 [-6.67801922e-01 -2.76652904e-01]
 [-1.22335069e-01  1.25451006e-01]
 [-9.61150541e-01 -1.37310483e+00]
 [-1.40362005e-01 -7.47362844e-01]
 [-6.84551274e-02 -2.41307653e-01]
 [-2.18850000e-02  5.12058371e-02]
 [ 1.47373611e-01  1.57195121e-01]
 [-2.39033730e-01 -2.03253742e-01]
 [-9.00263322e-02 -3.16259430e-02]
 [ 9.54816335e-02  5.39773313e-01]
 [ 7.39848580e-03  2.74888365e-01]
 [ 8.97159349e-03 -2.53608905e-01]
 [ 2.31255231e-01  2.34220166e-01]
 [ 1.38061651e-01  2.74699830e-01]
 [ 8.75412662e-01 -1.02680185e+00]
 [-1.23244692e+00  1.42213539e+00]
 [ 2.95190030e-02 -2.04292759e-02]
 [-6.43685950e-02 -4.40420447e-02]
 [ 1.46844378e-01 -5.13242803e-02]
 [-1.63993857e-01 -1.50445579e-01]
 [ 3.23421143e-01 -3.67188307e-02]
 [ 3.33891167e-01  4.43515952e-01]
 [ 2.78730298e-01  9.22447642e-04]
 [-1.31903859e-01 -2.47114410e-01]
 [ 1.85978921e-01 -7.02078576e-02]
 [-2.00861747e-01  1.84928126e-01]
 [-1.16771445e-01  1.22276131e-01]
 [-2.07505492e-01  1.52222769e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.00174604]
curr_Stock_Price:  101.39981941370968
curr_Factors:  [1.01399819e+02 3.85513128e-02]
mat_Sqrt:  [[ 1.99093356e+01  0.00000000e+00]
 [-7.85379529e-03  1.79953057e-02]]
grads:  [3.81134618e-02 4.37052434e+01]
Stock Position:  0.03811346183142398
Bond Position:  [8.13704789]


portfolio before change:  [12.04485249]
curr_Stock_Price:  102.50413396814129
curr_Factors:  [1.02504134e+02 3.86123155e-02]
mat_Sqrt:  [[ 2.01420794e+01  0.00000000e+00]
 [-7.86000667e-03  1.80095378e-02]]
grads:  [-0.01506524 -3.11880396]
Stock Position:  -0.015065242740521971
Bond Position:  [13.58910215]


portfolio before change:  [12.02427849]
curr_Stock_Price:  103.9825525754077
curr_Factors:  [1.03982553e+02 3.81242887e-02]
mat_Sqrt:  [[ 2.03030530e+01  0.00000000e+00]
 [-7.81017682e-03  1.78953632e-02]]
grads:  [ 2.86399199e-02 -4.94357507e+01]
Stock Position:  0.028639919880671633
Bond Position:  [9.04622652]


portfolio before change:  [12.00453242]
curr_Stock_Price:  103.25360766741031
curr_Factors:  [1.03253608e+02 3.86670359e-02]
mat_Sqrt:  [[ 2.03037228e+01  0.00000000e+00]
 [-7.86557420e-03  1.80222946e-02]]
grads:  [-0.00742099 -1.36831839]
Stock Position:  -0.007420988072617145
Bond Position:  [12.77077621]


portfolio before change:  [11.99426401]
curr_Stock_Price:  104.85243223550317
curr_Factors:  [1.04852432e+02 3.78478388e-02]
mat_Sqrt:  [[ 2.03985385e+01  0.00000000e+00]
 [-7.78180841e-03  1.78303630e-02]]
grads:  [-0.00647744  6.24157687]
Stock Position:  -0.00647743858119351
Bond Position:  [12.6734392]


portfolio before change:  [11.98831916]
curr_Stock_Price:  106.0147934792591
curr_Factors:  [1.06014793e+02 3.75233717e-02]
mat_Sqrt:  [[ 2.05360730e+01  0.00000000e+00]
 [-7.74838014e-03  1.77537692e-02]]
grads:  [ 0.03245684 23.43205953]
Stock Position:  0.03245684282179822
Bond Position:  [8.54741367]


portfolio before change:  [11.98706453]
curr_Stock_Price:  105.94321776451116
curr_Factors:  [1.05943218e+02 3.66843894e-02]
mat_Sqrt:  [[ 2.02914839e+01  0.00000000e+00]
 [-7.66126772e-03  1.75541696e-02]]
grads:  [ 2.38446536e-04 -2.58989348e+01]
Stock Position:  0.00023844653564511186
Bond Position:  [11.96180274]


portfolio before change:  [11.98867715]
curr_Stock_Price:  106.43513404583685
curr_Factors:  [1.06435134e+02 3.73051564e-02]
mat_Sqrt:  [[ 2.05574595e+01  0.00000000e+00]
 [-7.72581712e-03  1.77020709e-02]]
grads:  [ 0.03035602 -1.87510612]
Stock Position:  0.03035602308117877
Bond Position:  [8.75772976]


portfolio before change:  [12.02875854]
curr_Stock_Price:  107.71944593884187
curr_Factors:  [1.07719446e+02 3.60973822e-02]
mat_Sqrt:  [[ 2.04659527e+01  0.00000000e+00]
 [-7.59972444e-03  1.74131563e-02]]
grads:  [ -0.03329644 -20.6800196 ]
Stock Position:  -0.033296439144384266
Bond Position:  [15.61543251]


portfolio before change:  [12.03894657]
curr_Stock_Price:  107.47209269750826
curr_Factors:  [1.07472093e+02 3.67977826e-02]
mat_Sqrt:  [[ 2.06161009e+01  0.00000000e+00]
 [-7.67309925e-03  1.75812791e-02]]
grads:  [ 2.24088746e-02 -3.83271152e+01]
Stock Position:  0.022408874633226272
Bond Position:  [9.63061792]


portfolio before change:  [12.02648531]
curr_Stock_Price:  106.86228245775995
curr_Factors:  [1.06862282e+02 3.70027920e-02]
mat_Sqrt:  [[ 2.05561460e+01  0.00000000e+00]
 [-7.69444392e-03  1.76301858e-02]]
grads:  [ 0.00251845 -0.94551532]
Stock Position:  0.002518450343452371
Bond Position:  [11.75735796]


portfolio before change:  [12.02969249]
curr_Stock_Price:  107.55215945084183
curr_Factors:  [1.07552159e+02 3.68152041e-02]
mat_Sqrt:  [[ 2.06363431e+01  0.00000000e+00]
 [-7.67491541e-03  1.75854404e-02]]
grads:  [ -0.03821138 -15.73192926]
Stock Position:  -0.03821137990880019
Bond Position:  [16.13940892]


portfolio before change:  [12.09310815]
curr_Stock_Price:  105.94535800540119
curr_Factors:  [1.05945358e+02 3.80317411e-02]
mat_Sqrt:  [[ 2.06611760e+01  0.00000000e+00]
 [-7.80069136e-03  1.78736293e-02]]
grads:  [-3.27105105e-03  7.01877632e+00]
Stock Position:  -0.0032710510468543313
Bond Position:  [12.43966082]


portfolio before change:  [12.09112258]
curr_Stock_Price:  107.02776940639619
curr_Factors:  [1.07027769e+02 3.89663243e-02]
mat_Sqrt:  [[ 2.11271636e+01  0.00000000e+00]
 [-7.89595586e-03  1.80919077e-02]]
grads:  [-7.38585951e-02 -7.58960775e+01]
Stock Position:  -0.07385859505088589
Bond Position:  [19.99604326]


portfolio before change:  [12.07158791]
curr_Stock_Price:  107.32610073603968
curr_Factors:  [1.07326101e+02 3.86567050e-02]
mat_Sqrt:  [[ 2.11017157e+01  0.00000000e+00]
 [-7.86452338e-03  1.80198868e-02]]
grads:  [-2.21090028e-02 -4.14743361e+01]
Stock Position:  -0.02210900278104616
Bond Position:  [14.44446097]


portfolio before change:  [12.07628875]
curr_Stock_Price:  107.19515064860843
curr_Factors:  [1.07195151e+02 3.86395311e-02]
mat_Sqrt:  [[ 2.10712870e+01  0.00000000e+00]
 [-7.86277621e-03  1.80158836e-02]]
grads:  [-8.24678726e-03 -1.33941614e+01]
Stock Position:  -0.008246787259479187
Bond Position:  [12.96030435]


portfolio before change:  [12.05330512]
curr_Stock_Price:  110.17858730535654
curr_Factors:  [1.10178587e+02 3.65707269e-02]
mat_Sqrt:  [[ 2.10699738e+01  0.00000000e+00]
 [-7.64938972e-03  1.75269537e-02]]
grads:  [2.19772201e-05 2.92154803e+00]
Stock Position:  2.197722008054474e-05
Bond Position:  [12.05088371]


portfolio before change:  [12.05481019]
curr_Stock_Price:  110.11521884249575
curr_Factors:  [1.10115219e+02 3.73834301e-02]
mat_Sqrt:  [[ 2.12905519e+01  0.00000000e+00]
 [-7.73391804e-03  1.77206324e-02]]
grads:  [0.01014437 8.87073992]
Stock Position:  0.01014436767201374
Bond Position:  [10.93776092]


portfolio before change:  [12.04804968]
curr_Stock_Price:  109.31400483022918
curr_Factors:  [1.09314005e+02 3.76201386e-02]
mat_Sqrt:  [[ 2.12024477e+01  0.00000000e+00]
 [-7.75836463e-03  1.77766466e-02]]
grads:  [ -0.01545769 -11.43375053]
Stock Position:  -0.015457693396245113
Bond Position:  [13.73779205]


portfolio before change:  [12.04814348]
curr_Stock_Price:  109.41903567487604
curr_Factors:  [1.09419036e+02 3.69965383e-02]
mat_Sqrt:  [[ 2.10461872e+01  0.00000000e+00]
 [-7.69379369e-03  1.76286960e-02]]
grads:  [-0.00493339 -1.79400354]
Stock Position:  -0.0049333888623923055
Bond Position:  [12.58795013]


portfolio before change:  [12.05119053]
curr_Stock_Price:  109.1203650144012
curr_Factors:  [1.09120365e+02 3.70100657e-02]
mat_Sqrt:  [[ 2.09925762e+01  0.00000000e+00]
 [-7.69520014e-03  1.76319186e-02]]
grads:  [1.57702426e-02 3.06134191e+01]
Stock Position:  0.015770242646936453
Bond Position:  [10.3303359]


portfolio before change:  [12.06077641]
curr_Stock_Price:  109.64632456432864
curr_Factors:  [1.09646325e+02 3.61849105e-02]
mat_Sqrt:  [[ 2.08572876e+01  0.00000000e+00]
 [-7.60893269e-03  1.74342550e-02]]
grads:  [6.10671946e-03 1.57671415e+01]
Stock Position:  0.006106719463845933
Bond Position:  [11.39119707]


portfolio before change:  [12.07939789]
curr_Stock_Price:  112.4624830057342
curr_Factors:  [1.12462483e+02 3.68068255e-02]
mat_Sqrt:  [[ 2.15760455e+01  0.00000000e+00]
 [-7.67404201e-03  1.75834392e-02]]
grads:  [-4.71413572e-03 -1.44231684e+01]
Stock Position:  -0.004714135722104648
Bond Position:  [12.6095613]


portfolio before change:  [12.08595469]
curr_Stock_Price:  111.40597842177463
curr_Factors:  [1.11405978e+02 3.77491367e-02]
mat_Sqrt:  [[ 2.16452202e+01  0.00000000e+00]
 [-7.77165483e-03  1.78070983e-02]]
grads:  [ 0.01540651 13.15319108]
Stock Position:  0.015406509549237895
Bond Position:  [10.36957742]


portfolio before change:  [12.09188077]
curr_Stock_Price:  111.70648801121824
curr_Factors:  [1.11706488e+02 3.76772201e-02]
mat_Sqrt:  [[ 2.16829228e+01  0.00000000e+00]
 [-7.76424833e-03  1.77901278e-02]]
grads:  [1.18964813e-02 1.54411386e+01]
Stock Position:  0.011896481319226937
Bond Position:  [10.76296662]


portfolio before change:  [12.07526819]
curr_Stock_Price:  110.1969628903451
curr_Factors:  [1.10196963e+02 3.75915348e-02]
mat_Sqrt:  [[ 2.13655784e+01  0.00000000e+00]
 [-7.75541460e-03  1.77698872e-02]]
grads:  [ 1.99985036e-02 -5.77832506e+01]
Stock Position:  0.01999850364642546
Bond Position:  [9.87149383]


portfolio before change:  [12.11372015]
curr_Stock_Price:  112.05799925500014
curr_Factors:  [1.12057999e+02 3.61102801e-02]
mat_Sqrt:  [[ 2.12940511e+01  0.00000000e+00]
 [-7.60108204e-03  1.74162669e-02]]
grads:  [-2.87299090e-02  8.16555806e+01]
Stock Position:  -0.02872990899709287
Bond Position:  [15.33313627]


portfolio before change:  [12.10851514]
curr_Stock_Price:  112.30588615533279
curr_Factors:  [1.12305886e+02 3.51644549e-02]
mat_Sqrt:  [[ 2.10598107e+01  0.00000000e+00]
 [-7.50087513e-03  1.71866640e-02]]
grads:  [ 9.78305850e-04 -1.18867023e+00]
Stock Position:  0.0009783058501363407
Bond Position:  [11.99864563]


portfolio before change:  [12.10999093]
curr_Stock_Price:  112.28121204836224
curr_Factors:  [1.12281212e+02 3.50958433e-02]
mat_Sqrt:  [[ 2.10346327e+01  0.00000000e+00]
 [-7.49355385e-03  1.71698889e-02]]
grads:  [-0.00397393 -2.56507454]
Stock Position:  -0.003973928153995147
Bond Position:  [12.55618839]


portfolio before change:  [12.11671295]
curr_Stock_Price:  110.98466101119818
curr_Factors:  [1.10984661e+02 3.55932754e-02]
mat_Sqrt:  [[ 2.09385661e+01  0.00000000e+00]
 [-7.54647206e-03  1.72911397e-02]]
grads:  [ 0.00594332 -2.9682416 ]
Stock Position:  0.0059433213004967764
Bond Position:  [11.45709545]


portfolio before change:  [12.12004249]
curr_Stock_Price:  111.30389621673514
curr_Factors:  [1.11303896e+02 3.49093646e-02]
mat_Sqrt:  [[ 2.07960733e+01  0.00000000e+00]
 [-7.47361917e-03  1.71242128e-02]]
grads:  [-0.01104313 -8.78554718]
Stock Position:  -0.011043127596092944
Bond Position:  [13.34918562]


portfolio before change:  [12.11922515]
curr_Stock_Price:  111.52902177117916
curr_Factors:  [1.11529022e+02 3.35959050e-02]
mat_Sqrt:  [[ 2.04423616e+01  0.00000000e+00]
 [-7.33167430e-03  1.67989762e-02]]
grads:  [ 0.01503719 -2.18577788]
Stock Position:  0.015037192751312628
Bond Position:  [10.44214176]


portfolio before change:  [12.09673168]
curr_Stock_Price:  109.94635759038104
curr_Factors:  [1.09946358e+02 3.46332123e-02]
mat_Sqrt:  [[ 2.04610178e+01  0.00000000e+00]
 [-7.44400025e-03  1.70563473e-02]]
grads:  [2.57786490e-02 2.60029855e+01]
Stock Position:  0.025778649036045237
Bond Position:  [9.26246311]


portfolio before change:  [12.12158912]
curr_Stock_Price:  110.8657061809584
curr_Factors:  [1.10865706e+02 3.37129608e-02]
mat_Sqrt:  [[ 2.03561516e+01  0.00000000e+00]
 [-7.34443581e-03  1.68282165e-02]]
grads:  [0.01371246 0.05481553]
Stock Position:  0.013712458672029183
Bond Position:  [10.60134771]


portfolio before change:  [12.10270798]
curr_Stock_Price:  109.3921268118613
curr_Factors:  [1.09392127e+02 3.43753375e-02]
mat_Sqrt:  [[ 2.02819427e+01  0.00000000e+00]
 [-7.41623489e-03  1.69927289e-02]]
grads:  [-1.18210288e-02 -1.45423617e+01]
Stock Position:  -0.011821028847273858
Bond Position:  [13.39583546]


portfolio before change:  [12.10824533]
curr_Stock_Price:  109.06535555390708
curr_Factors:  [1.09065356e+02 3.37619150e-02]
mat_Sqrt:  [[ 2.00401217e+01  0.00000000e+00]
 [-7.34976625e-03  1.68404301e-02]]
grads:  [ 0.00775134 -4.16900621]
Stock Position:  0.007751335141443541
Bond Position:  [11.26284321]


portfolio before change:  [12.0904094]
curr_Stock_Price:  106.5827030453713
curr_Factors:  [1.06582703e+02 3.48354819e-02]
mat_Sqrt:  [[ 1.98928790e+01  0.00000000e+00]
 [-7.46570633e-03  1.71060822e-02]]
grads:  [-6.03997519e-03  1.08106651e+01]
Stock Position:  -0.006039975188045269
Bond Position:  [12.73416629]


portfolio before change:  [12.09089882]
curr_Stock_Price:  106.7652296390745
curr_Factors:  [1.06765230e+02 3.64048331e-02]
mat_Sqrt:  [[ 2.03708598e+01  0.00000000e+00]
 [-7.63202024e-03  1.74871552e-02]]
grads:  [-3.11257191e-03  6.99233976e+00]
Stock Position:  -0.003112571909483993
Bond Position:  [12.42321327]


portfolio before change:  [12.09189562]
curr_Stock_Price:  106.9439235800783
curr_Factors:  [1.06943924e+02 3.56385536e-02]
mat_Sqrt:  [[ 2.01890623e+01  0.00000000e+00]
 [-7.55127047e-03  1.73021343e-02]]
grads:  [-6.98744829e-03  8.79791863e+00]
Stock Position:  -0.006987448286577069
Bond Position:  [12.83916076]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.09989407]
Stock Price:  106.02893192753497
PL:  [6.07096214]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-5.50475724e-02  1.91983039e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.04399466e-01 -6.75833499e-01]
 [ 2.73485018e-02  2.27432584e-02]
 [-2.55947624e-03  4.38426270e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-2.06166202e-02  2.49264144e-01]
 [-1.79837072e-02 -6.59562623e-02]
 [ 1.66175934e-01  9.51291346e-02]
 [ 8.57742386e-02  1.09625029e-01]
 [ 1.70685703e-01  3.86525281e-01]
 [ 1.76666008e-01  2.28902214e-01]
 [ 1.44638465e-01  4.38007295e-02]
 [-2.91292209e-01 -3.97664572e-01]
 [ 8.56848614e-02  2.29846289e-01]
 [ 4.59647025e-02  5.61175764e-02]
 [ 6.54262720e-03 -5.19998484e-02]
 [-4.26339694e-04  5.00324285e-02]
 [ 1.58047100e-02  4.33727177e-02]
 [ 1.40570513e-01 -1.02538977e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 3.31266923e-02  2.01375144e-01]
 [ 2.17456587e-02  1.22588773e-01]
 [-6.95980242e-02  7.45845528e-02]
 [ 6.41501502e-02  1.37374099e-01]
 [ 1.02774743e-01  6.60895604e-02]
 [ 6.19821853e-02  2.04045737e-01]
 [-1.73524638e-01  1.22284674e-01]
 [-9.78218246e-02 -8.83210323e-02]
 [ 6.09901172e-02 -6.05771908e-02]
 [-6.99753915e-01 -9.01948089e-02]
 [-1.18087514e-01  5.90723042e-03]
 [ 4.75724595e-02 -5.23607361e-02]
 [ 1.18941068e-01  8.29013751e-02]
 [-2.91103385e-01 -1.71336642e-01]
 [-2.73408739e-01 -3.80943447e-01]
 [-8.35127082e-02  2.84566828e-01]
 [-1.23568500e-01  1.17690698e-01]
 [ 2.58878725e-01  7.27612377e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.39586043]
curr_Stock_Price:  99.65178519423647
curr_Factors:  [9.96517852e+01 3.96570200e-02]
mat_Sqrt:  [[ 1.98447267e+01  0.00000000e+00]
 [-7.96562816e-03  1.82515470e-02]]
grads:  [1.44827871e-03 1.05187269e+01]
Stock Position:  0.0014482787055506508
Bond Position:  [0.25153687]


portfolio before change:  [0.39614479]
curr_Stock_Price:  99.82642231034569
curr_Factors:  [9.98264223e+01 3.94851061e-02]
mat_Sqrt:  [[ 1.98363682e+01  0.00000000e+00]
 [-7.94834384e-03  1.82119436e-02]]
grads:  [-0.01023294 -4.83261819]
Stock Position:  -0.010232944142105719
Bond Position:  [1.417663]


portfolio before change:  [0.3938327]
curr_Stock_Price:  100.0696864452802
curr_Factors:  [1.00069686e+02 3.93953525e-02]
mat_Sqrt:  [[ 1.98620941e+01  0.00000000e+00]
 [-7.93930500e-03  1.81912331e-02]]
grads:  [ 2.56489343e-02 -3.71516047e+01]
Stock Position:  0.02564893428651565
Bond Position:  [-2.17284811]


portfolio before change:  [0.41959224]
curr_Stock_Price:  101.08458844100558
curr_Factors:  [1.01084588e+02 3.88810822e-02]
mat_Sqrt:  [[ 1.99321488e+01  0.00000000e+00]
 [-7.88731460e-03  1.80721081e-02]]
grads:  [0.00187007 1.2584729 ]
Stock Position:  0.001870067998239105
Bond Position:  [0.23055718]


portfolio before change:  [0.41732243]
curr_Stock_Price:  99.85542055672629
curr_Factors:  [9.98554206e+01 3.88694744e-02]
mat_Sqrt:  [[ 1.96868385e+01  0.00000000e+00]
 [-7.88613714e-03  1.80694102e-02]]
grads:  [-3.28151790e-05  2.42634521e-01]
Stock Position:  -3.2815179041891844e-05
Bond Position:  [0.4205992]


portfolio before change:  [0.41739855]
curr_Stock_Price:  99.13792427735329
curr_Factors:  [9.91379243e+01 3.79247247e-02]
mat_Sqrt:  [[ 1.93063885e+01  0.00000000e+00]
 [-7.78970857e-03  1.78484646e-02]]
grads:  [-0.00613376 -3.71555367]
Stock Position:  -0.00613376095452177
Bond Position:  [1.02548688]


portfolio before change:  [0.41448793]
curr_Stock_Price:  99.63334824601098
curr_Factors:  [9.96333482e+01 3.97315843e-02]
mat_Sqrt:  [[ 1.98596992e+01  0.00000000e+00]
 [-7.97311325e-03  1.82686975e-02]]
grads:  [4.43970325e-03 1.36443304e+01]
Stock Position:  0.004439703248763602
Bond Position:  [-0.02785457]


portfolio before change:  [0.41279767]
curr_Stock_Price:  99.25341691572086
curr_Factors:  [9.92534169e+01 3.98036261e-02]
mat_Sqrt:  [[ 1.98018965e+01  0.00000000e+00]
 [-7.98033845e-03  1.82852525e-02]]
grads:  [-2.36186367e-03 -3.60707418e+00]
Stock Position:  -0.0023618636717458587
Bond Position:  [0.64722071]


portfolio before change:  [0.41566285]
curr_Stock_Price:  98.07457230441821
curr_Factors:  [9.80745723e+01 3.90564166e-02]
mat_Sqrt:  [[ 1.93821799e+01  0.00000000e+00]
 [-7.90507853e-03  1.81128104e-02]]
grads:  [0.0107157  5.25203614]
Stock Position:  0.010715703476829664
Bond Position:  [-0.63527519]


portfolio before change:  [0.40685395]
curr_Stock_Price:  97.25992850776154
curr_Factors:  [9.72599285e+01 3.92337826e-02]
mat_Sqrt:  [[ 1.92647792e+01  0.00000000e+00]
 [-7.92300777e-03  1.81538914e-02]]
grads:  [0.0069359  6.03865182]
Stock Position:  0.006935896968886015
Bond Position:  [-0.26773089]


portfolio before change:  [0.39853832]
curr_Stock_Price:  96.06582680308924
curr_Factors:  [9.60658268e+01 4.06255250e-02]
mat_Sqrt:  [[ 1.93628115e+01  0.00000000e+00]
 [-8.06230984e-03  1.84730726e-02]]
grads:  [1.75273702e-02 2.09237137e+01]
Stock Position:  0.017527370226220217
Bond Position:  [-1.285243]


portfolio before change:  [0.42367061]
curr_Stock_Price:  97.50888191271069
curr_Factors:  [9.75088819e+01 4.10630365e-02]
mat_Sqrt:  [[ 1.97592159e+01  0.00000000e+00]
 [-8.10560660e-03  1.85722779e-02]]
grads:  [ 0.01399687 12.32494018]
Stock Position:  0.013996867348438677
Bond Position:  [-0.94114827]


portfolio before change:  [0.43791599]
curr_Stock_Price:  98.53504213918484
curr_Factors:  [9.85350421e+01 4.07331544e-02]
mat_Sqrt:  [[ 1.98867919e+01  0.00000000e+00]
 [-8.07298254e-03  1.84975268e-02]]
grads:  [0.00823434 2.36792356]
Stock Position:  0.008234343278705201
Bond Position:  [-0.37345537]


portfolio before change:  [0.44280885]
curr_Stock_Price:  99.13491316704322
curr_Factors:  [9.91349132e+01 4.01587408e-02]
mat_Sqrt:  [[ 1.98662856e+01  0.00000000e+00]
 [-8.01585837e-03  1.83666389e-02]]
grads:  [ -0.0233988  -21.65146138]
Stock Position:  -0.023398800725206677
Bond Position:  [2.76244693]


portfolio before change:  [0.46206515]
curr_Stock_Price:  98.32671038991721
curr_Factors:  [9.83267104e+01 3.93863461e-02]
mat_Sqrt:  [[ 1.95139126e+01  0.00000000e+00]
 [-7.93839743e-03  1.81891536e-02]]
grads:  [9.53155881e-03 1.26364477e+01]
Stock Position:  0.009531558805031981
Bond Position:  [-0.47514167]


portfolio before change:  [0.44594008]
curr_Stock_Price:  96.64118609840013
curr_Factors:  [9.66411861e+01 4.05604304e-02]
mat_Sqrt:  [[ 1.94631679e+01  0.00000000e+00]
 [-8.05584810e-03  1.84582669e-02]]
grads:  [0.00361999 3.04024082]
Stock Position:  0.003619987310096952
Bond Position:  [0.09610022]


portfolio before change:  [0.45033067]
curr_Stock_Price:  97.85074022996353
curr_Factors:  [9.78507402e+01 4.26922619e-02]
mat_Sqrt:  [[ 2.02180235e+01  0.00000000e+00]
 [-8.26484235e-03  1.89371328e-02]]
grads:  [-7.98889525e-04 -2.74591982e+00]
Stock Position:  -0.0007988895251261175
Bond Position:  [0.5285026]


portfolio before change:  [0.4500509]
curr_Stock_Price:  98.2836289473615
curr_Factors:  [9.82836289e+01 4.19366464e-02]
mat_Sqrt:  [[ 2.01269530e+01  0.00000000e+00]
 [-8.19137560e-03  1.87687994e-02]]
grads:  [1.06372794e-03 2.66572344e+00]
Stock Position:  0.0010637279406090093
Bond Position:  [0.34550386]


portfolio before change:  [0.44950011]
curr_Stock_Price:  97.72522851357898
curr_Factors:  [9.77252285e+01 4.21139288e-02]
mat_Sqrt:  [[ 2.00548572e+01  0.00000000e+00]
 [-8.20867140e-03  1.88084290e-02]]
grads:  [1.73195528e-03 2.30602554e+00]
Stock Position:  0.0017319552834306085
Bond Position:  [0.28024438]


portfolio before change:  [0.4491577]
curr_Stock_Price:  97.50730227680047
curr_Factors:  [9.75073023e+01 4.31230180e-02]
mat_Sqrt:  [[ 2.02484468e+01  0.00000000e+00]
 [-8.30643298e-03  1.90324289e-02]]
grads:  [ 4.73215727e-03 -5.38759279e+00]
Stock Position:  0.0047321572687798324
Bond Position:  [-0.01226219]


portfolio before change:  [0.43897651]
curr_Stock_Price:  95.35613560655244
curr_Factors:  [9.53561356e+01 4.40957507e-02]
mat_Sqrt:  [[ 2.00238237e+01  0.00000000e+00]
 [-8.39959529e-03  1.92458906e-02]]
grads:  [ 0.00210392 -1.962912  ]
Stock Position:  0.002103924367883377
Bond Position:  [0.23835441]


portfolio before change:  [0.44116162]
curr_Stock_Price:  96.38056171869904
curr_Factors:  [9.63805617e+01 4.38761561e-02]
mat_Sqrt:  [[ 2.01884855e+01  0.00000000e+00]
 [-8.37865441e-03  1.91979090e-02]]
grads:  [5.99420946e-03 1.04894311e+01]
Stock Position:  0.005994209457970977
Bond Position:  [-0.13656365]


portfolio before change:  [0.43876103]
curr_Stock_Price:  95.98292547156183
curr_Factors:  [9.59829255e+01 4.58306817e-02]
mat_Sqrt:  [[ 2.05481223e+01  0.00000000e+00]
 [-8.56324067e-03  1.96208493e-02]]
grads:  [3.66202735e-03 6.24788313e+00]
Stock Position:  0.0036620273469065517
Bond Position:  [0.08726894]


portfolio before change:  [0.43963944]
curr_Stock_Price:  96.21981406477866
curr_Factors:  [9.62198141e+01 4.61409256e-02]
mat_Sqrt:  [[ 2.06684384e+01  0.00000000e+00]
 [-8.59217557e-03  1.96871475e-02]]
grads:  [-1.79242650e-03  3.78848957e+00]
Stock Position:  -0.0017924265020251107
Bond Position:  [0.61210638]


portfolio before change:  [0.44012784]
curr_Stock_Price:  95.99002219286236
curr_Factors:  [9.59900222e+01 4.71690553e-02]
mat_Sqrt:  [[ 2.08475335e+01  0.00000000e+00]
 [-8.68737523e-03  1.99052773e-02]]
grads:  [5.95298825e-03 6.90139087e+00]
Stock Position:  0.005952988254325197
Bond Position:  [-0.13129963]


portfolio before change:  [0.44347496]
curr_Stock_Price:  96.55503773189271
curr_Factors:  [9.65550377e+01 4.57948492e-02]
mat_Sqrt:  [[ 2.06625185e+01  0.00000000e+00]
 [-8.55989245e-03  1.96131775e-02]]
grads:  [0.00636992 3.36965085]
Stock Position:  0.0063699200999670184
Bond Position:  [-0.17157292]


portfolio before change:  [0.44783184]
curr_Stock_Price:  97.24238248466244
curr_Factors:  [9.72423825e+01 4.63013094e-02]
mat_Sqrt:  [[ 2.09243621e+01  0.00000000e+00]
 [-8.60709563e-03  1.97213336e-02]]
grads:  [7.21814337e-03 1.03464472e+01]
Stock Position:  0.007218143371107856
Bond Position:  [-0.25407762]


portfolio before change:  [0.44315845]
curr_Stock_Price:  96.59933182706406
curr_Factors:  [9.65993318e+01 4.60249731e-02]
mat_Sqrt:  [[ 2.07238717e+01  0.00000000e+00]
 [-8.58137267e-03  1.96623949e-02]]
grads:  [-5.79791425e-03  6.21921566e+00]
Stock Position:  -0.005797914254414501
Bond Position:  [1.00323309]


portfolio before change:  [0.4354983]
curr_Stock_Price:  97.94215253655211
curr_Factors:  [9.79421525e+01 4.52448276e-02]
mat_Sqrt:  [[ 2.08331103e+01  0.00000000e+00]
 [-8.50833263e-03  1.94950392e-02]]
grads:  [-0.00654575 -4.53043626]
Stock Position:  -0.00654574766903571
Bond Position:  [1.07660292]


portfolio before change:  [0.4318787]
curr_Stock_Price:  98.51568312371242
curr_Factors:  [9.85156831e+01 4.48915774e-02]
mat_Sqrt:  [[ 2.08731410e+01  0.00000000e+00]
 [-8.47505303e-03  1.94187860e-02]]
grads:  [ 1.65533609e-03 -3.11951482e+00]
Stock Position:  0.00165533609361366
Bond Position:  [0.26880213]


portfolio before change:  [0.4336301]
curr_Stock_Price:  99.55341895566411
curr_Factors:  [9.95534190e+01 4.55860748e-02]
mat_Sqrt:  [[ 2.12555467e+01  0.00000000e+00]
 [-8.54035828e-03  1.95684191e-02]]
grads:  [-0.03477295 -4.60920263]
Stock Position:  -0.03477295449294168
Bond Position:  [3.89539661]


portfolio before change:  [0.42860835]
curr_Stock_Price:  99.71183820947758
curr_Factors:  [9.97118382e+01 4.61289158e-02]
mat_Sqrt:  [[ 2.14157528e+01  0.00000000e+00]
 [-8.59105728e-03  1.96845851e-02]]
grads:  [-0.00539366  0.30009423]
Stock Position:  -0.0053936645856364806
Bond Position:  [0.96642056]


portfolio before change:  [0.42895286]
curr_Stock_Price:  99.67036340496576
curr_Factors:  [9.96703634e+01 4.55841532e-02]
mat_Sqrt:  [[ 2.12800668e+01  0.00000000e+00]
 [-8.54017829e-03  1.95680067e-02]]
grads:  [ 1.16166744e-03 -2.67583392e+00]
Stock Position:  0.0011616674398527533
Bond Position:  [0.31316905]


portfolio before change:  [0.42933915]
curr_Stock_Price:  99.9691915202341
curr_Factors:  [9.99691915e+01 4.56627314e-02]
mat_Sqrt:  [[ 2.13622564e+01  0.00000000e+00]
 [-8.54753592e-03  1.95848652e-02]]
grads:  [0.00726151 4.2329306 ]
Stock Position:  0.007261507958003182
Bond Position:  [-0.29658793]


portfolio before change:  [0.43681408]
curr_Stock_Price:  101.0036889936794
curr_Factors:  [1.01003689e+02 4.38176178e-02]
mat_Sqrt:  [[ 2.11427570e+01  0.00000000e+00]
 [-8.37306327e-03  1.91850981e-02]]
grads:  [-0.01730526 -8.93071494]
Stock Position:  -0.017305256232376498
Bond Position:  [2.1847088]


portfolio before change:  [0.44477997]
curr_Stock_Price:  100.55915474127262
curr_Factors:  [1.00559155e+02 4.44080168e-02]
mat_Sqrt:  [[ 2.11910416e+01  0.00000000e+00]
 [-8.42928389e-03  1.93139157e-02]]
grads:  [ -0.02074773 -19.72378114]
Stock Position:  -0.020747733802996
Bond Position:  [2.53115454]


portfolio before change:  [0.44021199]
curr_Stock_Price:  100.79457310138562
curr_Factors:  [1.00794573e+02 4.35637470e-02]
mat_Sqrt:  [[ 2.10377729e+01  0.00000000e+00]
 [-8.34877208e-03  1.91294400e-02]]
grads:  [1.93378061e-03 1.48758577e+01]
Stock Position:  0.001933780611121205
Bond Position:  [0.2452974]


portfolio before change:  [0.43974097]
curr_Stock_Price:  100.53514414591503
curr_Factors:  [1.00535144e+02 4.18499920e-02]
mat_Sqrt:  [[ 2.05667465e+01  0.00000000e+00]
 [-8.18290823e-03  1.87493982e-02]]
grads:  [-3.51071906e-03  6.27703868e+00]
Stock Position:  -0.0035107190592956546
Bond Position:  [0.79269162]


portfolio before change:  [0.43916545]
curr_Stock_Price:  100.72730273344678
curr_Factors:  [1.00727303e+02 4.13356932e-02]
mat_Sqrt:  [[ 2.04790505e+01  0.00000000e+00]
 [-8.13247251e-03  1.86338354e-02]]
grads:  [0.01419179 3.90479126]
Stock Position:  0.014191787453494519
Bond Position:  [-0.99033502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.4524354]
Stock Price:  101.67107034754906
PL:  [-1.21863495]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.96656764e-01 -1.83209095e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.88466698e-01 -8.57150469e-01]
 [-2.62680099e-02  1.72892191e-01]
 [ 2.60180076e-02 -7.56598780e-02]
 [-7.92777845e-02 -1.07934795e-01]
 [-1.33170352e-01  7.90365681e-02]
 [-7.74823425e-03 -1.26903629e-01]
 [ 1.65435513e-01  1.19370232e-01]
 [ 7.39946820e-02  1.26824306e-01]
 [ 1.74915220e-01  4.11538754e-01]
 [ 1.34144528e-01  3.02521083e-01]
 [ 3.10626857e-01  2.35546062e-02]
 [-6.28169649e-02 -1.03598215e-02]
 [ 9.88159632e-02  2.38950858e-01]
 [ 4.11699088e-02  1.19633914e-01]
 [ 9.41989639e-02  2.09857861e-01]
 [ 1.16908043e-01  7.04434840e-02]
 [ 1.84042777e-02 -2.11749407e-02]
 [ 3.57115918e-01 -1.16279156e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-1.52633744e-02  1.31100181e-01]
 [-1.86307428e-02 -5.90765696e-02]
 [-3.77189792e-02  1.32119875e-02]
 [ 6.09439783e-02  1.31191166e-01]
 [ 4.46016695e-02  1.59191620e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.63137686e-01  9.89484793e-02]
 [-3.18204013e-01  2.21334565e-02]
 [ 2.05479082e-01 -9.43377829e-02]
 [-1.29463782e+00 -1.46264734e-01]
 [-1.55874622e-02  1.95398711e-01]
 [-1.08267401e-02 -1.23959427e-01]
 [ 5.75813859e-02  8.76865168e-02]
 [-9.82118912e-02  1.38644573e-01]
 [-4.84369212e-01 -3.17298716e-01]
 [-6.02038546e-02  3.00507750e-01]
 [-1.26032501e-01  1.16028433e-01]
 [ 7.62317191e-01  1.49219349e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.76401982]
curr_Stock_Price:  98.42277515831096
curr_Factors:  [9.84227752e+01 4.16822201e-02]
mat_Sqrt:  [[ 2.00942142e+01  0.00000000e+00]
 [-8.16648958e-03  1.87117783e-02]]
grads:  [-0.02371905 -9.79111078]
Stock Position:  -0.023719054827954486
Bond Position:  [-5.42952462]


portfolio before change:  [-7.76345741]
curr_Stock_Price:  98.37044819244996
curr_Factors:  [9.83704482e+01 4.26127115e-02]
mat_Sqrt:  [[ 2.03064607e+01  0.00000000e+00]
 [-8.25713863e-03  1.89194814e-02]]
grads:  [-0.00999605 -4.65189126]
Stock Position:  -0.009996052535091563
Bond Position:  [-6.78014124]


portfolio before change:  [-7.7511048]
curr_Stock_Price:  97.04990952538026
curr_Factors:  [9.70499095e+01 4.38151091e-02]
mat_Sqrt:  [[ 2.03145442e+01  0.00000000e+00]
 [-8.37282357e-03  1.91845489e-02]]
grads:  [ 2.53205565e-02 -4.46792090e+01]
Stock Position:  0.025320556455431686
Bond Position:  [-10.20846252]


portfolio before change:  [-7.73297408]
curr_Stock_Price:  97.81635627714567
curr_Factors:  [9.78163563e+01 4.32552945e-02]
mat_Sqrt:  [[ 2.03437550e+01  0.00000000e+00]
 [-8.31916289e-03  1.90615968e-02]]
grads:  [2.41785887e-03 9.07018403e+00]
Stock Position:  0.0024178588681772364
Bond Position:  [-7.96948023]


portfolio before change:  [-7.73501539]
curr_Stock_Price:  97.38413233056795
curr_Factors:  [9.73841323e+01 4.34972901e-02]
mat_Sqrt:  [[ 2.03104385e+01  0.00000000e+00]
 [-8.34240158e-03  1.91148434e-02]]
grads:  [-3.44781841e-04 -3.95817411e+00]
Stock Position:  -0.0003447818405640009
Bond Position:  [-7.70143911]


portfolio before change:  [-7.73585885]
curr_Stock_Price:  97.03820050864273
curr_Factors:  [9.70382005e+01 4.52776409e-02]
mat_Sqrt:  [[ 2.06483156e+01  0.00000000e+00]
 [-8.51141736e-03  1.95021072e-02]]
grads:  [-0.00612081 -5.53451965]
Stock Position:  -0.006120808762437617
Bond Position:  [-7.14190659]


portfolio before change:  [-7.73176196]
curr_Stock_Price:  96.22300015602217
curr_Factors:  [9.62230002e+01 4.56825301e-02]
mat_Sqrt:  [[ 2.05661959e+01  0.00000000e+00]
 [-8.54938876e-03  1.95891106e-02]]
grads:  [-0.00479797  4.03471959]
Stock Position:  -0.004797968766842558
Bond Position:  [-7.27008701]


portfolio before change:  [-7.73558694]
curr_Stock_Price:  96.83079020755338
curr_Factors:  [9.68307902e+01 4.45681954e-02]
mat_Sqrt:  [[ 2.04421232e+01  0.00000000e+00]
 [-8.44447231e-03  1.93487168e-02]]
grads:  [-3.08840320e-03 -6.55876202e+00]
Stock Position:  -0.0030884031952991904
Bond Position:  [-7.43653442]


portfolio before change:  [-7.73602581]
curr_Stock_Price:  96.67188771718965
curr_Factors:  [9.66718877e+01 4.28211764e-02]
mat_Sqrt:  [[ 2.00045827e+01  0.00000000e+00]
 [-8.27731130e-03  1.89657028e-02]]
grads:  [0.01087416 6.29400519]
Stock Position:  0.01087415602728826
Bond Position:  [-8.787251]


portfolio before change:  [-7.73306269]
curr_Stock_Price:  97.04539698529211
curr_Factors:  [9.70453970e+01 4.20133191e-02]
mat_Sqrt:  [[ 1.98915414e+01  0.00000000e+00]
 [-8.19886033e-03  1.87859490e-02]]
grads:  [6.50253012e-03 6.75101940e+00]
Stock Position:  0.0065025301247890995
Bond Position:  [-8.3641033]


portfolio before change:  [-7.74219684]
curr_Stock_Price:  95.80148508309433
curr_Factors:  [9.58014851e+01 4.26671007e-02]
mat_Sqrt:  [[ 1.97887703e+01  0.00000000e+00]
 [-8.26240650e-03  1.89315516e-02]]
grads:  [1.79154870e-02 2.17382475e+01]
Stock Position:  0.017915487008208674
Bond Position:  [-9.4585271]


portfolio before change:  [-7.75932119]
curr_Stock_Price:  94.91164253899422
curr_Factors:  [9.49116425e+01 4.07064120e-02]
mat_Sqrt:  [[ 1.91492117e+01  0.00000000e+00]
 [-8.07033204e-03  1.84914537e-02]]
grads:  [1.39000788e-02 1.63600487e+01]
Stock Position:  0.013900078846975047
Bond Position:  [-9.07860051]


portfolio before change:  [-7.76299985]
curr_Stock_Price:  94.72863899261056
curr_Factors:  [9.47286390e+01 4.13472741e-02]
mat_Sqrt:  [[ 1.92621491e+01  0.00000000e+00]
 [-8.13361166e-03  1.86364456e-02]]
grads:  [0.01665998 1.26390014]
Stock Position:  0.01665997542729824
Bond Position:  [-9.34117665]


portfolio before change:  [-7.75391034]
curr_Stock_Price:  95.34431992583677
curr_Factors:  [9.53443199e+01 4.21435388e-02]
mat_Sqrt:  [[ 1.95731320e+01  0.00000000e+00]
 [-8.21155662e-03  1.88150399e-02]]
grads:  [-0.00344035 -0.55061385]
Stock Position:  -0.0034403467737344883
Bond Position:  [-7.42589282]


portfolio before change:  [-7.75223051]
curr_Stock_Price:  94.58622097357167
curr_Factors:  [9.45862210e+01 4.20002693e-02]
mat_Sqrt:  [[ 1.93844691e+01  0.00000000e+00]
 [-8.19758689e-03  1.87830312e-02]]
grads:  [1.04775976e-02 1.27216345e+01]
Stock Position:  0.010477597598799864
Bond Position:  [-8.74326687]


portfolio before change:  [-7.74465282]
curr_Stock_Price:  95.41376416742627
curr_Factors:  [9.54137642e+01 4.16942743e-02]
mat_Sqrt:  [[ 1.94827043e+01  0.00000000e+00]
 [-8.16767035e-03  1.87144838e-02]]
grads:  [4.79309382e-03 6.39258425e+00]
Stock Position:  0.0047930938192018
Bond Position:  [-8.20197995]


portfolio before change:  [-7.74755483]
curr_Stock_Price:  95.02222319660487
curr_Factors:  [9.50222232e+01 4.12027897e-02]
mat_Sqrt:  [[ 1.92880578e+01  0.00000000e+00]
 [-8.11938812e-03  1.86038553e-02]]
grads:  [9.63230438e-03 1.12803426e+01]
Stock Position:  0.009632304384025568
Bond Position:  [-8.66283781]


portfolio before change:  [-7.75395177]
curr_Stock_Price:  94.47053617036373
curr_Factors:  [9.44705362e+01 3.94589618e-02]
mat_Sqrt:  [[ 1.87658918e+01  0.00000000e+00]
 [-7.94571199e-03  1.82059133e-02]]
grads:  [0.00786811 3.86926395]
Stock Position:  0.00786810994751088
Bond Position:  [-8.49725633]


portfolio before change:  [-7.75294233]
curr_Stock_Price:  94.73383415839456
curr_Factors:  [9.47338342e+01 3.99614047e-02]
mat_Sqrt:  [[ 1.89376239e+01  0.00000000e+00]
 [-7.99613954e-03  1.83214573e-02]]
grads:  [ 4.83839786e-04 -1.15574543e+00]
Stock Position:  0.0004838397863188657
Bond Position:  [-7.79877833]


portfolio before change:  [-7.75411474]
curr_Stock_Price:  94.32564108513635
curr_Factors:  [9.43256411e+01 4.07951761e-02]
mat_Sqrt:  [[ 1.90517192e+01  0.00000000e+00]
 [-8.07912629e-03  1.85116039e-02]]
grads:  [ 0.01608083 -6.28141982]
Stock Position:  0.016080834045322935
Bond Position:  [-9.27094972]


portfolio before change:  [-7.75104269]
curr_Stock_Price:  94.58874878618421
curr_Factors:  [9.45887488e+01 4.18876357e-02]
mat_Sqrt:  [[ 1.93589770e+01  0.00000000e+00]
 [-8.18658763e-03  1.87578288e-02]]
grads:  [ 0.00217618 -2.01398521]
Stock Position:  0.002176179586406774
Bond Position:  [-7.9568848]


portfolio before change:  [-7.75205146]
curr_Stock_Price:  94.58227253032324
curr_Factors:  [9.45822725e+01 4.36193813e-02]
mat_Sqrt:  [[ 1.97537474e+01  0.00000000e+00]
 [-8.35410140e-03  1.91416510e-02]]
grads:  [2.12382160e-03 6.84894844e+00]
Stock Position:  0.0021238216024228114
Bond Position:  [-7.95292733]


portfolio before change:  [-7.75414647]
curr_Stock_Price:  94.06394465931426
curr_Factors:  [9.40639447e+01 4.32054178e-02]
mat_Sqrt:  [[ 1.95520497e+01  0.00000000e+00]
 [-8.31436519e-03  1.90506039e-02]]
grads:  [-2.27157113e-03 -3.10103395e+00]
Stock Position:  -0.002271571127455245
Bond Position:  [-7.54047353]


portfolio before change:  [-7.75764485]
curr_Stock_Price:  95.18905110367555
curr_Factors:  [9.51890511e+01 4.36402262e-02]
mat_Sqrt:  [[ 1.98852243e+01  0.00000000e+00]
 [-8.35609729e-03  1.91462242e-02]]
grads:  [-0.00160686  0.69005708]
Stock Position:  -0.001606861185216563
Bond Position:  [-7.60468926]


portfolio before change:  [-7.76015931]
curr_Stock_Price:  96.16226292532951
curr_Factors:  [9.61622629e+01 4.26269049e-02]
mat_Sqrt:  [[ 1.98539340e+01  0.00000000e+00]
 [-8.25851365e-03  1.89226320e-02]]
grads:  [5.95350508e-03 6.93302950e+00]
Stock Position:  0.005953505076600615
Bond Position:  [-8.33266183]


portfolio before change:  [-7.77073849]
curr_Stock_Price:  94.56026089110614
curr_Factors:  [9.45602609e+01 4.35504852e-02]
mat_Sqrt:  [[ 1.97335473e+01  0.00000000e+00]
 [-8.34750121e-03  1.91265281e-02]]
grads:  [5.78094686e-03 8.32307982e+00]
Stock Position:  0.005780946862161695
Bond Position:  [-8.31738633]


portfolio before change:  [-7.7771949]
curr_Stock_Price:  93.62327358893508
curr_Factors:  [9.36232736e+01 4.39684123e-02]
mat_Sqrt:  [[ 1.96315330e+01  0.00000000e+00]
 [-8.38745847e-03  1.92180817e-02]]
grads:  [9.07527703e-03 9.10275007e+00]
Stock Position:  0.00907527702719303
Bond Position:  [-8.62685204]


portfolio before change:  [-7.77128604]
curr_Stock_Price:  94.39319871498965
curr_Factors:  [9.43931987e+01 4.35640982e-02]
mat_Sqrt:  [[ 1.97017620e+01  0.00000000e+00]
 [-8.34880573e-03  1.91295171e-02]]
grads:  [-0.00608844  5.172555  ]
Stock Position:  -0.006088441722941703
Bond Position:  [-7.19657855]


portfolio before change:  [-7.77294423]
curr_Stock_Price:  94.51778867719969
curr_Factors:  [9.45177887e+01 4.48734726e-02]
mat_Sqrt:  [[ 2.00220431e+01  0.00000000e+00]
 [-8.47334386e-03  1.94148698e-02]]
grads:  [-0.01541022  1.140026  ]
Stock Position:  -0.015410224562901236
Bond Position:  [-6.31640388]


portfolio before change:  [-7.77534873]
curr_Stock_Price:  94.62258317093257
curr_Factors:  [9.46225832e+01 4.47002975e-02]
mat_Sqrt:  [[ 2.00055275e+01  0.00000000e+00]
 [-8.45697795e-03  1.93773708e-02]]
grads:  [ 0.00821307 -4.86845114]
Stock Position:  0.00821306503771183
Bond Position:  [-8.55249016]


portfolio before change:  [-7.78423402]
curr_Stock_Price:  93.67090970503314
curr_Factors:  [9.36709097e+01 4.59886483e-02]
mat_Sqrt:  [[ 2.00876929e+01  0.00000000e+00]
 [-8.57798562e-03  1.96546342e-02]]
grads:  [-0.06762713 -7.44174286]
Stock Position:  -0.06762712828340631
Bond Position:  [-1.44953939]


portfolio before change:  [-7.88577649]
curr_Stock_Price:  95.16973533654301
curr_Factors:  [9.51697353e+01 4.60224618e-02]
mat_Sqrt:  [[ 2.04166171e+01  0.00000000e+00]
 [-8.58113856e-03  1.96618585e-02]]
grads:  [3.41347082e-03 9.93795737e+00]
Stock Position:  0.003413470823480493
Bond Position:  [-8.21063561]


portfolio before change:  [-7.88782598]
curr_Stock_Price:  94.87001337789273
curr_Factors:  [9.48700134e+01 4.74935021e-02]
mat_Sqrt:  [[ 2.06750258e+01  0.00000000e+00]
 [-8.71720158e-03  1.99736180e-02]]
grads:  [-3.14036220e-03 -6.20615788e+00]
Stock Position:  -0.0031403621986227964
Bond Position:  [-7.58989978]


portfolio before change:  [-7.89251004]
curr_Stock_Price:  96.059450137768
curr_Factors:  [9.60594501e+01 4.62189000e-02]
mat_Sqrt:  [[ 2.06514190e+01  0.00000000e+00]
 [-8.59943254e-03  1.97037753e-02]]
grads:  [0.00464137 4.45023939]
Stock Position:  0.004641372059109357
Bond Position:  [-8.33835769]


portfolio before change:  [-7.88624451]
curr_Stock_Price:  97.63395983295021
curr_Factors:  [9.76339598e+01 4.46175966e-02]
mat_Sqrt:  [[ 2.06231020e+01  0.00000000e+00]
 [-8.44915111e-03  1.93594373e-02]]
grads:  [-1.82816526e-03  7.16160142e+00]
Stock Position:  -0.0018281652605918164
Bond Position:  [-7.7077535]


portfolio before change:  [-7.88997777]
curr_Stock_Price:  99.14898958430332
curr_Factors:  [9.91489896e+01 4.46459322e-02]
mat_Sqrt:  [[ 2.09497691e+01  0.00000000e+00]
 [-8.45183362e-03  1.93655837e-02]]
grads:  [ -0.02973062 -16.38467094]
Stock Position:  -0.029730624807645323
Bond Position:  [-4.94221636]


portfolio before change:  [-7.91273984]
curr_Stock_Price:  99.89381943547168
curr_Factors:  [9.98938194e+01 4.48597234e-02]
mat_Sqrt:  [[ 2.11576249e+01  0.00000000e+00]
 [-8.47204564e-03  1.94118952e-02]]
grads:  [3.35332911e-03 1.54805982e+01]
Stock Position:  0.003353329110110151
Bond Position:  [-8.24771669]


portfolio before change:  [-7.91580443]
curr_Stock_Price:  99.28739000113971
curr_Factors:  [9.9287390e+01 4.4864303e-02]
mat_Sqrt:  [[ 2.10302559e+01  0.00000000e+00]
 [-8.47247808e-03  1.94128861e-02]]
grads:  [-3.58500352e-03  5.97687701e+00]
Stock Position:  -0.0035850035213741004
Bond Position:  [-7.55985878]


portfolio before change:  [-7.90996398]
curr_Stock_Price:  97.39464636337439
curr_Factors:  [9.73946464e+01 4.67815091e-02]
mat_Sqrt:  [[ 2.10655207e+01  0.00000000e+00]
 [-8.65161341e-03  1.98233367e-02]]
grads:  [0.03649706 0.75274587]
Stock Position:  0.03649706396578661
Bond Position:  [-11.46458261]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.85983678]
Stock Price:  98.80737254603396
PL:  [-7.85983678]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.55320040e-01 -4.55012669e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.49311237e-01 -7.66092479e-01]
 [-1.60168442e-02  2.20857068e-01]
 [ 3.82095633e-02 -4.15421547e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-3.99025545e-03  3.21634776e-01]
 [ 2.61288591e-01 -2.10860442e-03]
 [ 1.35778797e-01  7.97528052e-02]
 [ 3.43989350e-01 -1.68585669e-01]
 [ 5.98815495e-02 -1.37806195e-02]
 [-3.68340428e-01 -2.15277000e-01]
 [-1.08873414e-01  1.21927433e-01]
 [-7.24655141e-01 -1.02480069e+00]
 [-6.50437363e-02 -4.08700775e-01]
 [-1.19033412e-03 -1.73077594e-01]
 [-5.10642023e-02  1.63492256e-01]
 [ 1.27130506e-01  1.57148042e-01]
 [ 1.48319796e-02  6.75257589e-02]
 [-1.14520304e-01 -2.48051001e-02]
 [ 1.84544744e-01  5.47856359e-01]
 [ 1.26668970e-02  2.76748835e-01]
 [-1.22714134e-02 -4.49271209e-01]
 [ 2.06156402e-01  2.26903519e-01]
 [ 1.20489871e-01  2.42000416e-01]
 [ 9.24529107e-01 -1.24639280e+00]
 [-1.30829010e+00  1.50209691e+00]
 [ 2.65346966e-02 -2.05338491e-02]
 [-6.51064887e-02 -4.32356493e-02]
 [ 1.75201016e-01  1.47135848e-02]
 [-2.27666278e-01 -1.69932611e-01]
 [ 3.26310263e-01 -3.78644228e-02]
 [ 3.95540141e-01  5.46248632e-01]
 [ 2.94599517e-01 -7.21916205e-03]
 [-1.05020956e-01 -3.12475410e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-3.69695326e-01  6.19650951e-02]
 [-1.07125107e-01  7.77335433e-02]
 [-4.04465824e-01  1.86531455e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.0777857]
curr_Stock_Price:  98.97798168049819
curr_Factors:  [9.89779817e+01 4.01625549e-02]
mat_Sqrt:  [[ 1.98357789e+01  0.00000000e+00]
 [-8.01623901e-03  1.83675110e-02]]
grads:  [-0.01387283 -2.47726907]
Stock Position:  -0.013872831619481362
Bond Position:  [-2.70468082]


portfolio before change:  [-4.06707981]
curr_Stock_Price:  98.18189399038641
curr_Factors:  [9.81818940e+01 3.95298665e-02]
mat_Sqrt:  [[ 1.95206412e+01  0.00000000e+00]
 [-7.95284769e-03  1.82222633e-02]]
grads:  [-0.01039845 -4.82988139]
Stock Position:  -0.010398451860476724
Bond Position:  [-3.04614011]


portfolio before change:  [-4.07102087]
curr_Stock_Price:  98.524278705754
curr_Factors:  [9.85242787e+01 3.90961146e-02]
mat_Sqrt:  [[ 1.94809469e+01  0.00000000e+00]
 [-7.90909498e-03  1.81220132e-02]]
grads:  [ 2.64340881e-02 -4.22741375e+01]
Stock Position:  0.026434088106647678
Bond Position:  [-6.67542034]


portfolio before change:  [-4.10921131]
curr_Stock_Price:  97.11110511015734
curr_Factors:  [9.71111051e+01 4.11121568e-02]
mat_Sqrt:  [[ 1.96903768e+01  0.00000000e+00]
 [-8.11045318e-03  1.85833828e-02]]
grads:  [4.08184585e-03 1.18846536e+01]
Stock Position:  0.004081845848719916
Bond Position:  [-4.50560387]


portfolio before change:  [-4.10479655]
curr_Stock_Price:  98.33064890182143
curr_Factors:  [9.83306489e+01 4.10711805e-02]
mat_Sqrt:  [[ 1.99277147e+01  0.00000000e+00]
 [-8.10641035e-03  1.85741195e-02]]
grads:  [ 1.00759575e-03 -2.23656118e+00]
Stock Position:  0.0010075957462350744
Bond Position:  [-4.2038741]


portfolio before change:  [-4.10416633]
curr_Stock_Price:  99.47768005208144
curr_Factors:  [9.94776801e+01 4.05003338e-02]
mat_Sqrt:  [[ 2.00195794e+01  0.00000000e+00]
 [-8.04987789e-03  1.84445874e-02]]
grads:  [-0.00591525 -3.59546823]
Stock Position:  -0.005915247720977624
Bond Position:  [-3.51573121]


portfolio before change:  [-4.11148258]
curr_Stock_Price:  100.64022772863768
curr_Factors:  [1.00640228e+02 4.10979548e-02]
mat_Sqrt:  [[ 2.04024215e+01  0.00000000e+00]
 [-8.10905220e-03  1.85801728e-02]]
grads:  [6.68463148e-03 1.73106451e+01]
Stock Position:  0.006684631477827124
Bond Position:  [-4.78422541]


portfolio before change:  [-4.10452638]
curr_Stock_Price:  101.77032221554958
curr_Factors:  [1.01770322e+02 4.08713811e-02]
mat_Sqrt:  [[ 2.05745718e+01  0.00000000e+00]
 [-8.08666864e-03  1.85288856e-02]]
grads:  [ 0.01265486 -0.11380093]
Stock Position:  0.012654859713045223
Bond Position:  [-5.39241553]


portfolio before change:  [-4.11654137]
curr_Stock_Price:  100.87415271332166
curr_Factors:  [1.00874153e+02 4.11327512e-02]
mat_Sqrt:  [[ 2.04584996e+01  0.00000000e+00]
 [-8.11248432e-03  1.85880367e-02]]
grads:  [0.00833814 4.29054485]
Stock Position:  0.008338137134204303
Bond Position:  [-4.95764389]


portfolio before change:  [-4.10943413]
curr_Stock_Price:  101.8008565493316
curr_Factors:  [1.01800857e+02 4.02436045e-02]
mat_Sqrt:  [[ 2.04220751e+01  0.00000000e+00]
 [-8.02432347e-03  1.83860349e-02]]
grads:  [ 0.01324119 -9.16922383]
Stock Position:  0.013241187857857757
Bond Position:  [-5.4573984]


portfolio before change:  [-4.07818132]
curr_Stock_Price:  104.21265132391075
curr_Factors:  [1.04212651e+02 3.90973905e-02]
mat_Sqrt:  [[ 2.06060301e+01  0.00000000e+00]
 [-7.90922403e-03  1.81223089e-02]]
grads:  [ 0.00261415 -0.76042294]
Stock Position:  0.0026141471084766524
Bond Position:  [-4.35060852]


portfolio before change:  [-4.07554164]
curr_Stock_Price:  105.43046574709854
curr_Factors:  [1.05430466e+02 3.88143974e-02]
mat_Sqrt:  [[ 2.07712460e+01  0.00000000e+00]
 [-7.88054794e-03  1.80566037e-02]]
grads:  [ -0.02225649 -11.92234174]
Stock Position:  -0.02225648928171718
Bond Position:  [-1.72902961]


portfolio before change:  [-4.05448031]
curr_Stock_Price:  104.47445393546053
curr_Factors:  [1.04474454e+02 3.90793100e-02]
mat_Sqrt:  [[ 2.06530194e+01  0.00000000e+00]
 [-7.90739502e-03  1.81181181e-02]]
grads:  [-2.69500157e-03  6.72958595e+00]
Stock Position:  -0.0026950015679488427
Bond Position:  [-3.7729215]


portfolio before change:  [-4.05544158]
curr_Stock_Price:  104.65613278039416
curr_Factors:  [1.04656133e+02 3.84905250e-02]
mat_Sqrt:  [[ 2.05324891e+01  0.00000000e+00]
 [-7.84760091e-03  1.79811126e-02]]
grads:  [ -0.05707612 -56.99317477]
Stock Position:  -0.05707612103870903
Bond Position:  [1.91792452]


portfolio before change:  [-4.09052788]
curr_Stock_Price:  105.27506162403736
curr_Factors:  [1.05275062e+02 3.84669479e-02]
mat_Sqrt:  [[ 2.06475900e+01  0.00000000e+00]
 [-7.84519704e-03  1.79756046e-02]]
grads:  [-1.17890455e-02 -2.27364132e+01]
Stock Position:  -0.011789045473193935
Bond Position:  [-2.8494354]


portfolio before change:  [-4.08761637]
curr_Stock_Price:  104.997878814811
curr_Factors:  [1.04997879e+02 3.93119285e-02]
mat_Sqrt:  [[ 2.08181772e+01  0.00000000e+00]
 [-7.93089438e-03  1.81719619e-02]]
grads:  [-3.68560552e-03 -9.52443079e+00]
Stock Position:  -0.003685605520773492
Bond Position:  [-3.7006356]


portfolio before change:  [-4.08914203]
curr_Stock_Price:  105.28631349482745
curr_Factors:  [1.05286313e+02 4.14307617e-02]
mat_Sqrt:  [[ 2.14305530e+01  0.00000000e+00]
 [-8.14181913e-03  1.86552512e-02]]
grads:  [9.46763628e-04 8.76387320e+00]
Stock Position:  0.0009467636282965859
Bond Position:  [-4.18882328]


portfolio before change:  [-4.08919811]
curr_Stock_Price:  105.7801595144503
curr_Factors:  [1.05780160e+02 3.93110797e-02]
mat_Sqrt:  [[ 2.09730554e+01  0.00000000e+00]
 [-7.93080875e-03  1.81717657e-02]]
grads:  [0.00933176 8.6479236 ]
Stock Position:  0.00933176069810016
Bond Position:  [-5.07631325]


portfolio before change:  [-4.09839136]
curr_Stock_Price:  104.86300473726993
curr_Factors:  [1.04863005e+02 3.95926706e-02]
mat_Sqrt:  [[ 2.08655432e+01  0.00000000e+00]
 [-7.95916283e-03  1.82367331e-02]]
grads:  [2.12324388e-03 3.70273330e+00]
Stock Position:  0.0021232438766058998
Bond Position:  [-4.32104109]


portfolio before change:  [-4.09457603]
curr_Stock_Price:  106.91434375600596
curr_Factors:  [1.06914344e+02 3.76053690e-02]
mat_Sqrt:  [[ 2.07329405e+01  0.00000000e+00]
 [-7.75684152e-03  1.77731567e-02]]
grads:  [-0.00604575 -1.39564966]
Stock Position:  -0.0060457481664044875
Bond Position:  [-3.44819883]


portfolio before change:  [-4.10223971]
curr_Stock_Price:  108.11066041261742
curr_Factors:  [1.08110660e+02 3.81742958e-02]
mat_Sqrt:  [[ 2.11229241e+01  0.00000000e+00]
 [-7.81529739e-03  1.79070959e-02]]
grads:  [2.00563549e-02 3.05943722e+01]
Stock Position:  0.020056354892982613
Bond Position:  [-6.27054548]


portfolio before change:  [-4.06632229]
curr_Stock_Price:  109.94056868593447
curr_Factors:  [1.09940569e+02 3.66023816e-02]
mat_Sqrt:  [[ 2.10335536e+01  0.00000000e+00]
 [-7.65269956e-03  1.75345375e-02]]
grads:  [6.34462411e-03 1.57830701e+01]
Stock Position:  0.006344624113844475
Bond Position:  [-4.76385387]


portfolio before change:  [-4.07578497]
curr_Stock_Price:  108.54298207872748
curr_Factors:  [1.08542982e+02 3.69995918e-02]
mat_Sqrt:  [[ 2.08785443e+01  0.00000000e+00]
 [-7.69411119e-03  1.76294235e-02]]
grads:  [-9.97911736e-03 -2.54841691e+01]
Stock Position:  -0.009979117364874175
Bond Position:  [-2.99262181]


portfolio before change:  [-4.09156541]
curr_Stock_Price:  110.08683970513918
curr_Factors:  [1.10086840e+02 3.71480122e-02]
mat_Sqrt:  [[ 2.12179389e+01  0.00000000e+00]
 [-7.70952784e-03  1.76647474e-02]]
grads:  [ 0.01438336 12.84499084]
Stock Position:  0.014383358277151597
Bond Position:  [-5.67498386]


portfolio before change:  [-4.09249284]
curr_Stock_Price:  110.07168180013129
curr_Factors:  [1.10071682e+02 3.88398997e-02]
mat_Sqrt:  [[ 2.16927520e+01  0.00000000e+00]
 [-7.88313640e-03  1.80625346e-02]]
grads:  [1.04231824e-02 1.33979212e+01]
Stock Position:  0.010423182433204755
Bond Position:  [-5.23979006]


portfolio before change:  [-4.06529743]
curr_Stock_Price:  112.74365198714996
curr_Factors:  [1.12743652e+02 3.72176660e-02]
mat_Sqrt:  [[ 2.17503708e+01  0.00000000e+00]
 [-7.71675228e-03  1.76813007e-02]]
grads:  [ 1.74966532e-02 -7.04921440e+01]
Stock Position:  0.017496653177385715
Bond Position:  [-6.037934]


portfolio before change:  [-4.06663411]
curr_Stock_Price:  112.71039424643898
curr_Factors:  [1.12710394e+02 3.66543730e-02]
mat_Sqrt:  [[ 2.15787790e+01  0.00000000e+00]
 [-7.65813272e-03  1.75469864e-02]]
grads:  [-3.02482946e-02  8.56042669e+01]
Stock Position:  -0.030248294550371528
Bond Position:  [-0.65733691]


portfolio before change:  [-4.05965464]
curr_Stock_Price:  112.47693821485139
curr_Factors:  [1.12476938e+02 3.72434957e-02]
mat_Sqrt:  [[ 2.17064451e+01  0.00000000e+00]
 [-7.71942958e-03  1.76874352e-02]]
grads:  [ 8.09574762e-04 -1.16092858e+00]
Stock Position:  0.0008095747619597557
Bond Position:  [-4.15071313]


portfolio before change:  [-4.06008043]
curr_Stock_Price:  112.59190818187663
curr_Factors:  [1.12591908e+02 3.70850426e-02]
mat_Sqrt:  [[ 2.16823610e+01  0.00000000e+00]
 [-7.70299085e-03  1.76497693e-02]]
grads:  [-0.00387301 -2.44964387]
Stock Position:  -0.003873013327074095
Bond Position:  [-3.62401047]


portfolio before change:  [-4.06134073]
curr_Stock_Price:  112.80034042685249
curr_Factors:  [1.12800340e+02 3.67011315e-02]
mat_Sqrt:  [[ 2.16097696e+01  0.00000000e+00]
 [-7.66301575e-03  1.75581749e-02]]
grads:  [0.00840465 0.83799056]
Stock Position:  0.00840465001364964
Bond Position:  [-5.00938811]


portfolio before change:  [-4.06883695]
curr_Stock_Price:  111.98293428805326
curr_Factors:  [1.11982934e+02 3.59282603e-02]
mat_Sqrt:  [[ 2.12260869e+01  0.00000000e+00]
 [-7.58190058e-03  1.73723167e-02]]
grads:  [-0.01421981 -9.78180483]
Stock Position:  -0.014219811293816473
Bond Position:  [-2.47646076]


portfolio before change:  [-4.06616305]
curr_Stock_Price:  111.77312284793578
curr_Factors:  [1.11773123e+02 3.61674814e-02]
mat_Sqrt:  [[ 2.12567330e+01  0.00000000e+00]
 [-7.60709999e-03  1.74300558e-02]]
grads:  [ 0.01457349 -2.17236384]
Stock Position:  0.014573494110945008
Bond Position:  [-5.695088]


portfolio before change:  [-4.05921068]
curr_Stock_Price:  112.29902992886335
curr_Factors:  [1.12299030e+02 3.63467142e-02]
mat_Sqrt:  [[ 2.14096014e+01  0.00000000e+00]
 [-7.62592569e-03  1.74731909e-02]]
grads:  [2.96102004e-02 3.12620995e+01]
Stock Position:  0.029610200385894382
Bond Position:  [-7.38440745]


portfolio before change:  [-4.06899736]
curr_Stock_Price:  111.99968791682785
curr_Factors:  [1.11999688e+02 3.62677813e-02]
mat_Sqrt:  [[ 2.13293346e+01  0.00000000e+00]
 [-7.61764071e-03  1.74542076e-02]]
grads:  [ 0.01366422 -0.41360583]
Stock Position:  0.013664224501259332
Bond Position:  [-5.59938624]


portfolio before change:  [-4.05394534]
curr_Stock_Price:  113.15247871074946
curr_Factors:  [1.13152479e+02 3.65437187e-02]
mat_Sqrt:  [[ 2.16306934e+01  0.00000000e+00]
 [-7.64656458e-03  1.75204805e-02]]
grads:  [-1.11599014e-02 -1.78348653e+01]
Stock Position:  -0.01115990138035802
Bond Position:  [-2.79117483]


portfolio before change:  [-4.04353047]
curr_Stock_Price:  112.18797331153415
curr_Factors:  [1.12187973e+02 3.70830632e-02]
mat_Sqrt:  [[ 2.16039967e+01  0.00000000e+00]
 [-7.70278528e-03  1.76492983e-02]]
grads:  [ 0.00721513 -3.94783308]
Stock Position:  0.0072151300979326595
Bond Position:  [-4.85298129]


portfolio before change:  [-4.03554634]
curr_Stock_Price:  113.3786367618843
curr_Factors:  [1.13378637e+02 3.61241207e-02]
mat_Sqrt:  [[ 2.15491365e+01  0.00000000e+00]
 [-7.60253859e-03  1.74196043e-02]]
grads:  [-0.01590094  3.55720452]
Stock Position:  -0.0159009406744718
Bond Position:  [-2.23271936]


portfolio before change:  [-4.05075074]
curr_Stock_Price:  114.31727928843634
curr_Factors:  [1.14317279e+02 3.64270702e-02]
mat_Sqrt:  [[ 2.18184553e+01  0.00000000e+00]
 [-7.63435081e-03  1.74924952e-02]]
grads:  [-3.35493079e-03  4.44382246e+00]
Stock Position:  -0.0033549307914929128
Bond Position:  [-3.66722418]


portfolio before change:  [-4.05757726]
curr_Stock_Price:  116.21540589843345
curr_Factors:  [1.16215406e+02 3.54942589e-02]
mat_Sqrt:  [[ 2.18948896e+01  0.00000000e+00]
 [-7.53596803e-03  1.72670720e-02]]
grads:  [-0.0147549  10.80272644]
Stock Position:  -0.014754896194487662
Bond Position:  [-2.34283101]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.03760759]
Stock Price:  114.8421301750794
PL:  [-18.87973777]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 8.97208634e-02  3.72110353e-01]
 [-1.68130112e-01 -8.45849405e-02]
 [ 8.25782309e-01 -7.13150264e-01]
 [-3.31450152e-02  3.94793809e-02]
 [ 2.13745661e-02 -5.19437705e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-5.55607874e-02  1.86563879e-01]
 [ 1.49412675e-01 -2.43606327e-02]
 [ 1.42625436e-01  7.75753551e-02]
 [ 2.91195106e-01 -1.30075828e-01]
 [ 6.43355013e-02  1.59812570e-03]
 [-9.89711040e-02 -1.80602065e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-4.21869072e-01 -5.51006449e-01]
 [ 7.09015319e-02  2.05268347e-01]
 [ 5.91501848e-02 -3.06673195e-02]
 [-5.29937252e-02  2.71956985e-01]
 [-1.02486443e-01  6.18319283e-02]
 [ 1.49313863e-02  6.50574757e-02]
 [-7.73597825e-02 -4.17283618e-02]
 [ 2.36309955e-01  1.85156896e-01]
 [ 4.06942183e-02  2.07592370e-02]
 [-1.02021887e-02 -1.82849942e-02]
 [ 7.83587958e-02  1.83986322e-01]
 [ 5.79368696e-02  1.23727152e-01]
 [ 7.47296993e-01 -4.47256065e-01]
 [-3.42666639e-01  4.41766897e-01]
 [ 1.48815839e-01 -7.81023412e-03]
 [-4.89301106e-02 -6.09137478e-02]
 [ 1.11991499e-02 -1.80707847e-01]
 [-2.99818612e-01 -8.99404985e-02]
 [-1.16905252e-01 -1.61692089e-04]
 [ 1.75419753e-01  1.79437054e-01]
 [ 2.24247190e-01  2.88746868e-02]
 [-2.20972343e-01 -2.26259744e-01]
 [ 1.55476869e-01 -1.60910519e-01]
 [-1.90373178e-01  1.92567046e-01]
 [-1.17428408e-01  1.21832930e-01]
 [-1.23228693e-01  1.31060876e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.84015829]
curr_Stock_Price:  100.17055219999276
curr_Factors:  [1.00170552e+02 4.21826862e-02]
mat_Sqrt:  [[ 2.05734528e+01  0.00000000e+00]
 [-8.21536962e-03  1.88237766e-02]]
grads:  [1.22547799e-02 1.97681030e+01]
Stock Position:  0.012254779909928553
Bond Position:  [2.61259022]


portfolio before change:  [3.83999072]
curr_Stock_Price:  100.13022826654078
curr_Factors:  [1.00130228e+02 4.24619227e-02]
mat_Sqrt:  [[ 2.06331262e+01  0.00000000e+00]
 [-8.24251639e-03  1.88859776e-02]]
grads:  [-0.00993771 -4.47871654]
Stock Position:  -0.009937709135769466
Bond Position:  [4.83505581]


portfolio before change:  [3.84843251]
curr_Stock_Price:  99.34157885963351
curr_Factors:  [9.93415789e+01 3.99213977e-02]
mat_Sqrt:  [[ 1.98487850e+01  0.00000000e+00]
 [-7.99213591e-03  1.83122839e-02]]
grads:  [ 2.59228974e-02 -3.89438187e+01]
Stock Position:  0.025922897423987484
Bond Position:  [1.27321095]


portfolio before change:  [3.85975507]
curr_Stock_Price:  99.77221733606787
curr_Factors:  [9.97722173e+01 3.93768700e-02]
mat_Sqrt:  [[ 1.97984057e+01  0.00000000e+00]
 [-7.93744241e-03  1.81869653e-02]]
grads:  [-8.03842542e-04  2.17075142e+00]
Stock Position:  -0.0008038425422368011
Bond Position:  [3.93995622]


portfolio before change:  [3.86056312]
curr_Stock_Price:  99.37969307851043
curr_Factors:  [9.93796931e+01 3.86991132e-02]
mat_Sqrt:  [[ 1.95500628e+01  0.00000000e+00]
 [-7.86883607e-03  1.80297685e-02]]
grads:  [ 0.00097737 -0.28810004]
Stock Position:  0.0009773653534122014
Bond Position:  [3.76343285]


portfolio before change:  [3.86144323]
curr_Stock_Price:  99.79882603299276
curr_Factors:  [9.97988260e+01 3.92427897e-02]
mat_Sqrt:  [[ 1.97699408e+01  0.00000000e+00]
 [-7.92391718e-03  1.81559752e-02]]
grads:  [-0.00598994 -3.65262276]
Stock Position:  -0.005989940625949265
Bond Position:  [4.45923227]


portfolio before change:  [3.86897597]
curr_Stock_Price:  98.63432307058413
curr_Factors:  [9.86343231e+01 3.91806152e-02]
mat_Sqrt:  [[ 1.95237705e+01  0.00000000e+00]
 [-7.91763755e-03  1.81415867e-02]]
grads:  [1.32466036e-03 1.02837686e+01]
Stock Position:  0.0013246603567936535
Bond Position:  [3.73831899]


portfolio before change:  [3.87155992]
curr_Stock_Price:  100.23219261132164
curr_Factors:  [1.00232193e+02 4.02316608e-02]
mat_Sqrt:  [[ 2.01044044e+01  0.00000000e+00]
 [-8.02313264e-03  1.83833063e-02]]
grads:  [ 0.00690301 -1.32514969]
Stock Position:  0.0069030059396960625
Bond Position:  [3.1796565]


portfolio before change:  [3.87420964]
curr_Stock_Price:  100.5584607817069
curr_Factors:  [1.00558461e+02 4.04713070e-02]
mat_Sqrt:  [[ 2.02298300e+01  0.00000000e+00]
 [-8.04699268e-03  1.84379765e-02]]
grads:  [0.00872385 4.20736814]
Stock Position:  0.008723854658507583
Bond Position:  [2.99695224]


portfolio before change:  [3.8736149]
curr_Stock_Price:  100.44734239477071
curr_Factors:  [1.00447342e+02 3.98999938e-02]
mat_Sqrt:  [[ 2.00643394e+01  0.00000000e+00]
 [-7.98999312e-03  1.83073741e-02]]
grads:  [ 0.01168368 -7.1051057 ]
Stock Position:  0.011683681961294613
Bond Position:  [2.7000201]


portfolio before change:  [3.88931513]
curr_Stock_Price:  101.76222812855694
curr_Factors:  [1.01762228e+02 3.86605757e-02]
mat_Sqrt:  [[ 2.00087872e+01  0.00000000e+00]
 [-7.86491711e-03  1.80207890e-02]]
grads:  [0.00325022 0.08868234]
Stock Position:  0.003250221003396691
Bond Position:  [3.5585654]


portfolio before change:  [3.89373997]
curr_Stock_Price:  102.98675883244871
curr_Factors:  [1.02986759e+02 3.94165262e-02]
mat_Sqrt:  [[ 2.04465747e+01  0.00000000e+00]
 [-7.94143828e-03  1.81961210e-02]]
grads:  [-8.69545680e-03 -9.92530576e+00]
Stock Position:  -0.008695456799766596
Bond Position:  [4.78925689]


portfolio before change:  [3.90036369]
curr_Stock_Price:  102.29386512532572
curr_Factors:  [1.02293865e+02 3.99664129e-02]
mat_Sqrt:  [[ 2.04501818e+01  0.00000000e+00]
 [-7.99664058e-03  1.83226054e-02]]
grads:  [-5.90665748e-03  9.03428542e+00]
Stock Position:  -0.00590665747628037
Bond Position:  [4.50457852]


portfolio before change:  [3.91063467]
curr_Stock_Price:  100.65031805512936
curr_Factors:  [1.00650318e+02 4.14534622e-02]
mat_Sqrt:  [[ 2.04925289e+01  0.00000000e+00]
 [-8.14404933e-03  1.86603613e-02]]
grads:  [ -0.03232144 -29.52817694]
Stock Position:  -0.03232143800940819
Bond Position:  [7.16379769]


portfolio before change:  [3.88946458]
curr_Stock_Price:  101.33301122132728
curr_Factors:  [1.01333011e+02 4.17877315e-02]
mat_Sqrt:  [[ 2.07145425e+01  0.00000000e+00]
 [-8.17681908e-03  1.87354462e-02]]
grads:  [7.74759970e-03 1.09561494e+01]
Stock Position:  0.007747599698491622
Bond Position:  [3.10437697]


portfolio before change:  [3.89970456]
curr_Stock_Price:  102.60461979340046
curr_Factors:  [1.0260462e+02 4.1277080e-02]
mat_Sqrt:  [[ 2.08459360e+01  0.00000000e+00]
 [-8.12670463e-03  1.86206195e-02]]
grads:  [ 0.00219543 -1.64695484]
Stock Position:  0.0021954336512223405
Bond Position:  [3.67444293]


portfolio before change:  [3.8998346]
curr_Stock_Price:  102.45462688883626
curr_Factors:  [1.02454627e+02 4.06873061e-02]
mat_Sqrt:  [[ 2.06662198e+01  0.00000000e+00]
 [-8.06843787e-03  1.84871137e-02]]
grads:  [3.17900587e-03 1.47106244e+01]
Stock Position:  0.003179005865871085
Bond Position:  [3.57413074]


portfolio before change:  [3.89845687]
curr_Stock_Price:  101.88069711099389
curr_Factors:  [1.01880697e+02 3.93653301e-02]
mat_Sqrt:  [[ 2.02138415e+01  0.00000000e+00]
 [-7.93627924e-03  1.81843002e-02]]
grads:  [-0.0037351   3.40029188]
Stock Position:  -0.0037351028341086794
Bond Position:  [4.27899175]


portfolio before change:  [3.89942932]
curr_Stock_Price:  101.76355255715383
curr_Factors:  [1.01763553e+02 4.05270602e-02]
mat_Sqrt:  [[ 2.04863605e+01  0.00000000e+00]
 [-8.05253354e-03  1.84506722e-02]]
grads:  [2.11481178e-03 3.52602197e+00]
Stock Position:  0.002114811779453451
Bond Position:  [3.68421856]


portfolio before change:  [3.89984707]
curr_Stock_Price:  101.74331358685662
curr_Factors:  [1.01743314e+02 4.15212395e-02]
mat_Sqrt:  [[ 2.07319920e+01  0.00000000e+00]
 [-8.15070446e-03  1.86756101e-02]]
grads:  [-0.00460986 -2.23437744]
Stock Position:  -0.0046098576859907
Bond Position:  [4.36886927]


portfolio before change:  [3.89520397]
curr_Stock_Price:  102.8689984462615
curr_Factors:  [1.02868998e+02 4.38075861e-02]
mat_Sqrt:  [[ 2.15307507e+01  0.00000000e+00]
 [-8.37210473e-03  1.91829018e-02]]
grads:  [0.01472866 9.65218387]
Stock Position:  0.014728657341402085
Bond Position:  [2.38008174]


portfolio before change:  [3.91244188]
curr_Stock_Price:  104.01916325345957
curr_Factors:  [1.04019163e+02 4.32744883e-02]
mat_Sqrt:  [[ 2.16386084e+01  0.00000000e+00]
 [-8.32100843e-03  1.90658255e-02]]
grads:  [0.00229933 1.08881921]
Stock Position:  0.00229932957012707
Bond Position:  [3.67326754]


portfolio before change:  [3.91431948]
curr_Stock_Price:  104.6360420888524
curr_Factors:  [1.04636042e+02 4.23826031e-02]
mat_Sqrt:  [[ 2.15414591e+01  0.00000000e+00]
 [-8.23481420e-03  1.88683297e-02]]
grads:  [-8.44066055e-04 -9.69083882e-01]
Stock Position:  -0.0008440660550734786
Bond Position:  [4.00263921]


portfolio before change:  [3.91526867]
curr_Stock_Price:  104.10429660779339
curr_Factors:  [1.04104297e+02 4.34571840e-02]
mat_Sqrt:  [[ 2.17019843e+01  0.00000000e+00]
 [-8.33855469e-03  1.91060290e-02]]
grads:  [7.31071445e-03 9.62975206e+00]
Stock Position:  0.007310714447366713
Bond Position:  [3.15419188]


portfolio before change:  [3.91689776]
curr_Stock_Price:  104.27319894736533
curr_Factors:  [1.04273199e+02 4.49310885e-02]
mat_Sqrt:  [[ 2.21027426e+01  0.00000000e+00]
 [-8.47878184e-03  1.94273298e-02]]
grads:  [5.06434100e-03 6.36871631e+00]
Stock Position:  0.005064341003272308
Bond Position:  [3.38882273]


portfolio before change:  [3.91303775]
curr_Stock_Price:  103.42735531651424
curr_Factors:  [1.03427355e+02 4.64379606e-02]
mat_Sqrt:  [[ 2.22880457e+01  0.00000000e+00]
 [-8.61978753e-03  1.97504144e-02]]
grads:  [  0.02477106 -22.64540153]
Stock Position:  0.024771056716814243
Bond Position:  [1.35103287]


portfolio before change:  [3.92883054]
curr_Stock_Price:  104.05808720051606
curr_Factors:  [1.04058087e+02 4.55458578e-02]
mat_Sqrt:  [[ 2.22075312e+01  0.00000000e+00]
 [-8.53659021e-03  1.95597854e-02]]
grads:  [-6.74833044e-03  2.25854674e+01]
Stock Position:  -0.0067483304436712615
Bond Position:  [4.63104889]


portfolio before change:  [3.92873077]
curr_Stock_Price:  104.15865761773809
curr_Factors:  [1.04158658e+02 4.58944734e-02]
mat_Sqrt:  [[ 2.23139045e+01  0.00000000e+00]
 [-8.56919818e-03  1.96344996e-02]]
grads:  [ 0.00651644 -0.39778116]
Stock Position:  0.006516437904950147
Bond Position:  [3.24998735]


portfolio before change:  [3.93938315]
curr_Stock_Price:  105.731005156899
curr_Factors:  [1.05731005e+02 4.39878824e-02]
mat_Sqrt:  [[ 2.21752686e+01  0.00000000e+00]
 [-8.38931534e-03  1.92223363e-02]]
grads:  [-0.00340537 -3.16890449]
Stock Position:  -0.0034053724928305696
Bond Position:  [4.29943661]


portfolio before change:  [3.9438582]
curr_Stock_Price:  104.57471737420735
curr_Factors:  [1.04574717e+02 4.44064305e-02]
mat_Sqrt:  [[ 2.20368559e+01  0.00000000e+00]
 [-8.42913334e-03  1.93135708e-02]]
grads:  [-3.07068398e-03 -9.35652185e+00]
Stock Position:  -0.0030706839783241433
Bond Position:  [4.26497411]


portfolio before change:  [3.94894455]
curr_Stock_Price:  103.09192439216694
curr_Factors:  [1.03091924e+02 4.46065883e-02]
mat_Sqrt:  [[ 2.17732947e+01  0.00000000e+00]
 [-8.44810874e-03  1.93570489e-02]]
grads:  [-0.01557283 -4.64639517]
Stock Position:  -0.015572832156683276
Bond Position:  [5.55437778]


portfolio before change:  [3.94331956]
curr_Stock_Price:  103.49771598638468
curr_Factors:  [1.03497716e+02 4.43599919e-02]
mat_Sqrt:  [[ 2.17984942e+01  0.00000000e+00]
 [-8.42472474e-03  1.93034694e-02]]
grads:  [-0.00536623 -0.00837632]
Stock Position:  -0.00536623399475002
Bond Position:  [4.49871253]


portfolio before change:  [3.94174872]
curr_Stock_Price:  103.89524271588068
curr_Factors:  [1.03895243e+02 4.57775913e-02]
mat_Sqrt:  [[ 2.22291128e+01  0.00000000e+00]
 [-8.55827938e-03  1.96094816e-02]]
grads:  [0.01141442 9.15052515]
Stock Position:  0.011414423307094109
Bond Position:  [2.75584444]


portfolio before change:  [3.95770076]
curr_Stock_Price:  105.26259541016869
curr_Factors:  [1.05262595e+02 4.58901295e-02]
mat_Sqrt:  [[ 2.25493338e+01  0.00000000e+00]
 [-8.56879264e-03  1.96335704e-02]]
grads:  [0.0105036  1.47067936]
Stock Position:  0.010503597943437151
Bond Position:  [2.85206478]


portfolio before change:  [3.94937667]
curr_Stock_Price:  104.43615312825337
curr_Factors:  [1.04436153e+02 4.51043486e-02]
mat_Sqrt:  [[ 2.21799250e+01  0.00000000e+00]
 [-8.49511376e-03  1.94647509e-02]]
grads:  [ -0.01441485 -11.624076  ]
Stock Position:  -0.014414845435540244
Bond Position:  [5.45480768]


portfolio before change:  [3.93281133]
curr_Stock_Price:  105.63264444054523
curr_Factors:  [1.05632644e+02 4.63126510e-02]
mat_Sqrt:  [[ 2.27325405e+01  0.00000000e+00]
 [-8.60814972e-03  1.97237488e-02]]
grads:  [ 3.75012030e-03 -8.15821171e+00]
Stock Position:  0.0037501203017684553
Bond Position:  [3.53667621]


portfolio before change:  [3.93523896]
curr_Stock_Price:  106.16209867006383
curr_Factors:  [1.06162099e+02 4.62422433e-02]
mat_Sqrt:  [[ 2.28291080e+01  0.00000000e+00]
 [-8.60160388e-03  1.97087504e-02]]
grads:  [-4.65765149e-03  9.77063696e+00]
Stock Position:  -0.004657651493628192
Bond Position:  [4.42970502]


portfolio before change:  [3.93554886]
curr_Stock_Price:  106.21445186507111
curr_Factors:  [1.06214452e+02 4.53413869e-02]
mat_Sqrt:  [[ 2.26167924e+01  0.00000000e+00]
 [-8.51740683e-03  1.95158308e-02]]
grads:  [-2.84108186e-03  6.24277445e+00]
Stock Position:  -0.0028410818628316517
Bond Position:  [4.23731282]


portfolio before change:  [3.94016583]
curr_Stock_Price:  104.77581959620048
curr_Factors:  [1.04775820e+02 4.46184946e-02]
mat_Sqrt:  [[ 2.21318910e+01  0.00000000e+00]
 [-8.44923614e-03  1.93596321e-02]]
grads:  [-2.98343405e-03  6.76980202e+00]
Stock Position:  -0.0029834340532627988
Bond Position:  [4.25275758]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.93879457]
Stock Price:  105.41363895121306
PL:  [-1.47484438]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.79420418e-01 -1.73491047e-01]
 [-1.64894229e-01 -8.62103051e-02]
 [ 8.55132046e-01 -7.80265747e-01]
 [ 2.67920567e-02  2.27768662e-02]
 [-1.58629753e-01  6.68451264e-02]
 [ 1.52478053e-01  1.51046816e-01]
 [ 1.41083468e-01 -1.12614912e-01]
 [ 5.37673867e-01 -2.38441582e-02]
 [-2.23454609e-01 -6.66301081e-02]
 [ 6.48412715e-01 -5.40006756e-01]
 [ 5.98440652e-02 -1.39100467e-02]
 [-6.32185790e-01 -2.69353227e-01]
 [-1.23573642e-01  1.25775201e-01]
 [-8.82139903e-01 -1.27929108e+00]
 [-1.42365275e-01 -7.55114162e-01]
 [-1.30500899e-01 -3.04569085e-01]
 [-3.56106075e-02  4.14198831e-02]
 [ 1.35242094e-01  1.57166907e-01]
 [-2.35568677e-01 -1.94350940e-01]
 [-8.83958262e-02 -3.20799905e-02]
 [ 9.58579257e-02  5.39446108e-01]
 [ 4.54529298e-03  2.73896128e-01]
 [-1.46676522e-02 -4.04428339e-01]
 [ 1.50308669e-01  2.09041838e-01]
 [ 1.05752946e-01  2.14576399e-01]
 [ 8.37593350e-01 -8.58151976e-01]
 [-8.33880429e-01  1.00206144e+00]
 [ 6.65092939e-02 -1.65404000e-02]
 [-5.78918123e-02 -5.11200940e-02]
 [ 1.43773770e-01 -5.84752133e-02]
 [ 1.38943197e-02 -9.69896944e-02]
 [ 2.93743150e-01 -2.61719599e-02]
 [ 3.04953962e-01  3.95294603e-01]
 [ 2.67970865e-01  6.44251172e-03]
 [-1.43203793e-01 -2.45513391e-01]
 [ 1.85754826e-01 -7.05969554e-02]
 [-3.05851177e-01  1.08463369e-01]
 [-1.12806573e-01  1.24950914e-01]
 [-3.12321126e-01  1.72766105e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.14519825]
curr_Stock_Price:  98.51597970242105
curr_Factors:  [9.85159797e+01 4.02085852e-02]
mat_Sqrt:  [[ 1.97545016e+01  0.00000000e+00]
 [-8.02083140e-03  1.83780335e-02]]
grads:  [-0.02303972 -9.44013119]
Stock Position:  -0.023039716635055413
Bond Position:  [-4.87541799]


portfolio before change:  [-7.16138951]
curr_Stock_Price:  99.19228108470455
curr_Factors:  [9.91922811e+01 3.97518743e-02]
mat_Sqrt:  [[ 1.97768301e+01  0.00000000e+00]
 [-7.97514883e-03  1.82733616e-02]]
grads:  [-0.01024024 -4.71781312]
Stock Position:  -0.010240240221296576
Bond Position:  [-6.14563672]


portfolio before change:  [-7.15271863]
curr_Stock_Price:  98.27051250049024
curr_Factors:  [9.82705125e+01 4.16926598e-02]
mat_Sqrt:  [[ 2.00656403e+01  0.00000000e+00]
 [-8.16751221e-03  1.87141215e-02]]
grads:  [ 2.56456385e-02 -4.16939554e+01]
Stock Position:  0.025645638471495466
Bond Position:  [-9.67292866]


portfolio before change:  [-7.08207913]
curr_Stock_Price:  101.07210723613628
curr_Factors:  [1.01072107e+02 4.03608325e-02]
mat_Sqrt:  [[ 2.03053920e+01  0.00000000e+00]
 [-8.03600224e-03  1.84127943e-02]]
grads:  [0.00180901 1.23701302]
Stock Position:  0.0018090119170768907
Bond Position:  [-7.26491978]


portfolio before change:  [-7.07987353]
curr_Stock_Price:  102.79336469959749
curr_Factors:  [1.02793365e+02 3.92635698e-02]
mat_Sqrt:  [[ 2.03685434e+01  0.00000000e+00]
 [-7.92601487e-03  1.81607816e-02]]
grads:  [-0.00635569  3.68074062]
Stock Position:  -0.006355690013151862
Bond Position:  [-6.42655077]


portfolio before change:  [-7.08322603]
curr_Stock_Price:  103.19444292938199
curr_Factors:  [1.03194443e+02 3.84757243e-02]
mat_Sqrt:  [[ 2.02418272e+01  0.00000000e+00]
 [-7.84609195e-03  1.79776551e-02]]
grads:  [0.01078955 8.40191978]
Stock Position:  0.010789554033975931
Bond Position:  [-8.19664805]


portfolio before change:  [-7.07351479]
curr_Stock_Price:  104.18946837320514
curr_Factors:  [1.04189468e+02 3.92345790e-02]
mat_Sqrt:  [[ 2.06375586e+01  0.00000000e+00]
 [-7.92308818e-03  1.81540757e-02]]
grads:  [ 4.45470765e-03 -6.20328539e+00]
Stock Position:  0.004454707652739291
Bond Position:  [-7.53764842]


portfolio before change:  [-7.06990354]
curr_Stock_Price:  105.21164956026
curr_Factors:  [1.0521165e+02 3.8192761e-02]
mat_Sqrt:  [[ 2.05614793e+01  0.00000000e+00]
 [-7.81718732e-03  1.79114263e-02]]
grads:  [ 0.02564346 -1.3312261 ]
Stock Position:  0.02564345761329056
Bond Position:  [-9.76789402]


portfolio before change:  [-7.06931859]
curr_Stock_Price:  105.28207755274543
curr_Factors:  [1.05282078e+02 3.66412934e-02]
mat_Sqrt:  [[ 2.01530065e+01  0.00000000e+00]
 [-7.65676625e-03  1.75438555e-02]]
grads:  [-0.01253085 -3.79791707]
Stock Position:  -0.01253085354843227
Bond Position:  [-5.75004429]


portfolio before change:  [-7.07872957]
curr_Stock_Price:  105.97574020621191
curr_Factors:  [1.0597574e+02 3.7880003e-02]
mat_Sqrt:  [[ 2.06258313e+01  0.00000000e+00]
 [-7.78511430e-03  1.78379378e-02]]
grads:  [ 2.00105605e-02 -3.02729364e+01]
Stock Position:  0.02001056050307918
Bond Position:  [-9.19936353]


portfolio before change:  [-7.04732224]
curr_Stock_Price:  107.60274717697659
curr_Factors:  [1.07602747e+02 3.77146494e-02]
mat_Sqrt:  [[ 2.08967331e+01  0.00000000e+00]
 [-7.76810395e-03  1.77989622e-02]]
grads:  [ 0.00257328 -0.78150886]
Stock Position:  0.00257328371660324
Bond Position:  [-7.32421464]


portfolio before change:  [-7.04901355]
curr_Stock_Price:  107.30129576074177
curr_Factors:  [1.07301296e+02 3.72951692e-02]
mat_Sqrt:  [[ 2.07219803e+01  0.00000000e+00]
 [-7.72478289e-03  1.76997012e-02]]
grads:  [ -0.03618096 -15.21795338]
Stock Position:  -0.036180961641022684
Bond Position:  [-3.16674948]


portfolio before change:  [-7.00531817]
curr_Stock_Price:  106.08266466714896
curr_Factors:  [1.06082665e+02 3.69248756e-02]
mat_Sqrt:  [[ 2.03846820e+01  0.00000000e+00]
 [-7.68633859e-03  1.76116142e-02]]
grads:  [-3.36923792e-03  7.14160552e+00]
Stock Position:  -0.003369237918324864
Bond Position:  [-6.64790043]


portfolio before change:  [-7.006969]
curr_Stock_Price:  106.32598124112353
curr_Factors:  [1.06325981e+02 3.65034379e-02]
mat_Sqrt:  [[ 2.03145068e+01  0.00000000e+00]
 [-7.64234915e-03  1.75108217e-02]]
grads:  [-7.09083571e-02 -7.30571698e+01]
Stock Position:  -0.07090835708019078
Bond Position:  [0.53243164]


portfolio before change:  [-7.08376288]
curr_Stock_Price:  107.40992163711208
curr_Factors:  [1.07409922e+02 3.59485325e-02]
mat_Sqrt:  [[ 2.03650266e+01  0.00000000e+00]
 [-7.58403929e-03  1.73772171e-02]]
grads:  [-2.31732628e-02 -4.34542631e+01]
Stock Position:  -0.02317326278486812
Bond Position:  [-4.59472454]


portfolio before change:  [-7.12550846]
curr_Stock_Price:  109.18659032074072
curr_Factors:  [1.09186590e+02 3.31928014e-02]
mat_Sqrt:  [[ 1.98925866e+01  0.00000000e+00]
 [-7.28755668e-03  1.66978900e-02]]
grads:  [-1.32424078e-02 -1.82399743e+01]
Stock Position:  -0.013242407839735177
Bond Position:  [-5.6796151]


portfolio before change:  [-7.13183631]
curr_Stock_Price:  109.6108222257093
curr_Factors:  [1.09610822e+02 3.34063171e-02]
mat_Sqrt:  [[ 2.00340030e+01  0.00000000e+00]
 [-7.31095803e-03  1.67515093e-02]]
grads:  [-8.75186473e-04  2.47260604e+00]
Stock Position:  -0.0008751864728062073
Bond Position:  [-7.0359064]


portfolio before change:  [-7.13088258]
curr_Stock_Price:  107.51609784917996
curr_Factors:  [1.07516098e+02 3.54043343e-02]
mat_Sqrt:  [[ 2.02302714e+01  0.00000000e+00]
 [-7.52641580e-03  1.72451851e-02]]
grads:  [0.01007576 9.11366891]
Stock Position:  0.010075759781107887
Bond Position:  [-8.21418895]


portfolio before change:  [-7.11620284]
curr_Stock_Price:  109.07494587373982
curr_Factors:  [1.09074946e+02 3.41373569e-02]
mat_Sqrt:  [[ 2.01530115e+01  0.00000000e+00]
 [-7.39051900e-03  1.69338064e-02]]
grads:  [ -0.01589789 -11.47709709]
Stock Position:  -0.015897891051600287
Bond Position:  [-5.38214123]


portfolio before change:  [-7.12345639]
curr_Stock_Price:  109.48888414968127
curr_Factors:  [1.09488884e+02 3.43821587e-02]
mat_Sqrt:  [[ 2.03018961e+01  0.00000000e+00]
 [-7.41697067e-03  1.69944148e-02]]
grads:  [-0.0050437  -1.88767845]
Stock Position:  -0.0050437004253103546
Bond Position:  [-6.57122726]


portfolio before change:  [-7.12237311]
curr_Stock_Price:  109.11123801119454
curr_Factors:  [1.09111238e+02 3.40194102e-02]
mat_Sqrt:  [[ 2.01248603e+01  0.00000000e+00]
 [-7.37774060e-03  1.69045274e-02]]
grads:  [1.64618042e-02 3.19113393e+01]
Stock Position:  0.01646180418968882
Bond Position:  [-8.91854095]


portfolio before change:  [-7.11730185]
curr_Stock_Price:  109.48702624976617
curr_Factors:  [1.09487026e+02 3.44859002e-02]
mat_Sqrt:  [[ 2.03321565e+01  0.00000000e+00]
 [-7.42815188e-03  1.70200341e-02]]
grads:  [6.10281370e-03 1.60925722e+01]
Stock Position:  0.00610281370209803
Bond Position:  [-7.78548077]


portfolio before change:  [-7.12987417]
curr_Stock_Price:  107.58641492749545
curr_Factors:  [1.07586415e+02 3.53481523e-02]
mat_Sqrt:  [[ 2.02274341e+01  0.00000000e+00]
 [-7.52044172e-03  1.72314967e-02]]
grads:  [-9.45125562e-03 -2.34702966e+01]
Stock Position:  -0.009451255624100149
Bond Position:  [-6.11304746]


portfolio before change:  [-7.1284785]
curr_Stock_Price:  107.35789002158558
curr_Factors:  [1.0735789e+02 3.6782609e-02]
mat_Sqrt:  [[ 2.05899472e+01  0.00000000e+00]
 [-7.67151709e-03  1.75776539e-02]]
grads:  [1.17310649e-02 1.18924766e+01]
Stock Position:  0.011731064894175913
Bond Position:  [-8.38790088]


portfolio before change:  [-7.1131856]
curr_Stock_Price:  108.75089730898465
curr_Factors:  [1.08750897e+02 3.68557991e-02]
mat_Sqrt:  [[ 2.08778496e+01  0.00000000e+00]
 [-7.67914569e-03  1.75951332e-02]]
grads:  [9.55087657e-03 1.21952131e+01]
Stock Position:  0.009550876573539813
Bond Position:  [-8.151852]


portfolio before change:  [-7.11904443]
curr_Stock_Price:  108.2441600296143
curr_Factors:  [1.08244160e+02 3.73747863e-02]
mat_Sqrt:  [[ 2.09263668e+01  0.00000000e+00]
 [-7.73302386e-03  1.77185836e-02]]
grads:  [ 2.21283096e-02 -4.84323124e+01]
Stock Position:  0.02212830955126211
Bond Position:  [-9.51430471]


portfolio before change:  [-7.112059]
curr_Stock_Price:  108.61358703456295
curr_Factors:  [1.08613587e+02 3.86615721e-02]
mat_Sqrt:  [[ 2.13561967e+01  0.00000000e+00]
 [-7.86501846e-03  1.80210212e-02]]
grads:  [-1.85681452e-02  5.56051418e+01]
Stock Position:  -0.018568145245553405
Bond Position:  [-5.09530614]


portfolio before change:  [-7.1344348]
curr_Stock_Price:  109.78434751340963
curr_Factors:  [1.09784348e+02 3.98377580e-02]
mat_Sqrt:  [[ 2.19122952e+01  0.00000000e+00]
 [-7.98375931e-03  1.82930907e-02]]
grads:  [ 0.00270581 -0.90418838]
Stock Position:  0.0027058083609285146
Bond Position:  [-7.4314902]


portfolio before change:  [-7.13604407]
curr_Stock_Price:  109.53293411495059
curr_Factors:  [1.09532934e+02 3.91540068e-02]
mat_Sqrt:  [[ 2.16736885e+01  0.00000000e+00]
 [-7.91494857e-03  1.81354255e-02]]
grads:  [-0.00370045 -2.81879761]
Stock Position:  -0.003700452300270615
Bond Position:  [-6.73072267]


portfolio before change:  [-7.14152016]
curr_Stock_Price:  110.78540300614291
curr_Factors:  [1.10785403e+02 3.84627078e-02]
mat_Sqrt:  [[ 2.17271353e+01  0.00000000e+00]
 [-7.84476465e-03  1.79746139e-02]]
grads:  [ 0.00544265 -3.25321109]
Stock Position:  0.005442645462626659
Bond Position:  [-7.74448584]


portfolio before change:  [-7.15010639]
curr_Stock_Price:  109.38569613025875
curr_Factors:  [1.09385696e+02 3.85164395e-02]
mat_Sqrt:  [[ 2.14676053e+01  0.00000000e+00]
 [-7.85024224e-03  1.79871647e-02]]
grads:  [-1.32457500e-03 -5.39216137e+00]
Stock Position:  -0.001324574999934039
Bond Position:  [-7.00521684]


portfolio before change:  [-7.15084691]
curr_Stock_Price:  109.28363348207469
curr_Factors:  [1.09283633e+02 3.85093882e-02]
mat_Sqrt:  [[ 2.14456116e+01  0.00000000e+00]
 [-7.84952362e-03  1.79855181e-02]]
grads:  [ 0.0131645  -1.45516853]
Stock Position:  0.013164500773276768
Bond Position:  [-8.58951139]


portfolio before change:  [-7.15775012]
curr_Stock_Price:  108.840817129101
curr_Factors:  [1.08840817e+02 3.93346382e-02]
mat_Sqrt:  [[ 2.15863579e+01  0.00000000e+00]
 [-7.93318480e-03  1.81772099e-02]]
grads:  [ 0.02211928 21.74671496]
Stock Position:  0.022119278862461633
Bond Position:  [-9.56523051]


portfolio before change:  [-7.14641361]
curr_Stock_Price:  109.40739277460922
curr_Factors:  [1.09407393e+02 4.04278448e-02]
mat_Sqrt:  [[ 2.19981908e+01  0.00000000e+00]
 [-8.04267068e-03  1.84280736e-02]]
grads:  [0.01230931 0.3496031 ]
Stock Position:  0.012309312630301949
Bond Position:  [-8.49314341]


portfolio before change:  [-7.15470268]
curr_Stock_Price:  108.82024655821657
curr_Factors:  [1.08820247e+02 4.03771045e-02]
mat_Sqrt:  [[ 2.18664002e+01  0.00000000e+00]
 [-8.03762199e-03  1.84165056e-02]]
grads:  [-1.14492838e-02 -1.33311605e+01]
Stock Position:  -0.011449283802093058
Bond Position:  [-5.9087888]


portfolio before change:  [-7.15654184]
curr_Stock_Price:  108.91636716554946
curr_Factors:  [1.08916367e+02 4.05274482e-02]
mat_Sqrt:  [[ 2.19264224e+01  0.00000000e+00]
 [-8.05257208e-03  1.84507606e-02]]
grads:  [ 0.00706653 -3.82623552]
Stock Position:  0.007066533048127919
Bond Position:  [-7.92620295]


portfolio before change:  [-7.14415629]
curr_Stock_Price:  110.80928848474112
curr_Factors:  [1.10809288e+02 3.94306332e-02]
mat_Sqrt:  [[ 2.20035646e+01  0.00000000e+00]
 [-7.94285926e-03  1.81993769e-02]]
grads:  [-0.01174873  5.95972983]
Stock Position:  -0.011748727382930415
Bond Position:  [-5.84228816]


portfolio before change:  [-7.13618998]
curr_Stock_Price:  110.06906898730915
curr_Factors:  [1.10069069e+02 3.92600249e-02]
mat_Sqrt:  [[ 2.18092424e+01  0.00000000e+00]
 [-7.92565707e-03  1.81599617e-02]]
grads:  [-2.67196459e-03  6.88057146e+00]
Stock Position:  -0.002671964593781574
Bond Position:  [-6.84208933]


portfolio before change:  [-7.14034044]
curr_Stock_Price:  111.30229916625406
curr_Factors:  [1.11302299e+02 3.82985432e-02]
mat_Sqrt:  [[ 2.17818751e+01  0.00000000e+00]
 [-7.82800544e-03  1.79362137e-02]]
grads:  [-0.01087692  9.63225056]
Stock Position:  -0.010876924758917867
Bond Position:  [-5.92971371]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.14077987]
Stock Price:  111.27454912636543
PL:  [-18.41532899]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 7.34227850e-02  3.51208089e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.73152647e-01 -8.21170522e-01]
 [-1.70503159e-02  2.16021487e-01]
 [ 1.62012372e-02 -1.03131832e-01]
 [-8.05207117e-02 -1.02863378e-01]
 [-7.08539034e-02  1.65806520e-01]
 [-1.04452756e-01 -8.45315071e-02]
 [ 1.66209753e-01  9.40219143e-02]
 [ 6.33591071e-02  1.41714568e-01]
 [ 1.89683101e-01  4.98688759e-01]
 [ 9.37865556e-02  3.44860647e-01]
 [ 3.93500600e-01  2.52019738e-02]
 [ 1.98146982e-02  1.57716746e-01]
 [ 9.91235170e-02  2.43888790e-01]
 [ 3.21822034e-02  2.38594538e-01]
 [ 1.45719878e-01  3.64086373e-01]
 [ 1.49518364e-01  7.59120271e-02]
 [ 2.51293059e-02 -6.44832350e-02]
 [ 5.16443663e-01 -1.32471245e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-3.48178256e-02  7.81609494e-02]
 [-3.25755654e-02 -1.08044314e-01]
 [ 3.49212372e-02 -1.64525145e-01]
 [ 5.08250474e-02  2.10367151e-01]
 [ 4.50895330e-02  1.80940544e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.66106409e-01  1.05347906e-01]
 [-1.77448697e-01 -4.84633766e-02]
 [ 1.48817726e-01 -8.11032934e-02]
 [-1.06920251e+00 -1.21316602e-01]
 [-8.67444194e-02  1.15439337e-01]
 [-8.49171558e-03 -1.21362050e-01]
 [ 3.86824646e-02  7.78914532e-02]
 [-4.74210404e-02  1.65116486e-01]
 [-1.66611995e+00 -7.62522902e-02]
 [-7.90919000e-02  2.28571801e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.14243086e+00 -3.42632780e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.45096101]
curr_Stock_Price:  100.11193278984625
curr_Factors:  [1.00111933e+02 3.98618093e-02]
mat_Sqrt:  [[ 1.99877703e+01  0.00000000e+00]
 [-7.98616897e-03  1.82986119e-02]]
grads:  [1.13420636e-02 1.91931547e+01]
Stock Position:  0.011342063580588107
Bond Position:  [2.3154851]


portfolio before change:  [3.43515312]
curr_Stock_Price:  98.69267285019981
curr_Factors:  [9.86926729e+01 4.06916944e-02]
mat_Sqrt:  [[ 1.99084660e+01  0.00000000e+00]
 [-8.06887297e-03  1.84881106e-02]]
grads:  [-0.01019589 -4.76043075]
Stock Position:  -0.010195885905743116
Bond Position:  [4.44141236]


portfolio before change:  [3.4463755]
curr_Stock_Price:  97.64645074715892
curr_Factors:  [9.76464507e+01 4.08790544e-02]
mat_Sqrt:  [[ 1.97427153e+01  0.00000000e+00]
 [-8.08742771e-03  1.85306248e-02]]
grads:  [ 2.60736399e-02 -4.43142382e+01]
Stock Position:  0.026073639929022216
Bond Position:  [0.9003771]


portfolio before change:  [3.43440983]
curr_Stock_Price:  97.18321588153785
curr_Factors:  [9.71832159e+01 4.05789181e-02]
mat_Sqrt:  [[ 1.95767907e+01  0.00000000e+00]
 [-8.05768384e-03  1.84624731e-02]]
grads:  [3.94493620e-03 1.17005715e+01]
Stock Position:  0.003944936199073066
Bond Position:  [3.05102825]


portfolio before change:  [3.43257672]
curr_Stock_Price:  96.62185880476228
curr_Factors:  [9.66218588e+01 4.04048495e-02]
mat_Sqrt:  [[ 1.94219188e+01  0.00000000e+00]
 [-8.04038302e-03  1.84228319e-02]]
grads:  [-1.48333357e-03 -5.59804443e+00]
Stock Position:  -0.0014833335683486079
Bond Position:  [3.57589916]


portfolio before change:  [3.4313471]
curr_Stock_Price:  97.75216916458568
curr_Factors:  [9.77521692e+01 4.03238630e-02]
mat_Sqrt:  [[ 1.96294200e+01  0.00000000e+00]
 [-8.03232101e-03  1.84043595e-02]]
grads:  [-0.00638908 -5.58907678]
Stock Position:  -0.006389081810909348
Bond Position:  [4.05589371]


portfolio before change:  [3.42911299]
curr_Stock_Price:  98.18120294221086
curr_Factors:  [9.81812029e+01 4.15018834e-02]
mat_Sqrt:  [[ 2.00014855e+01  0.00000000e+00]
 [-8.14880441e-03  1.86712565e-02]]
grads:  [7.54941310e-05 8.88030863e+00]
Stock Position:  7.54941310447449e-05
Bond Position:  [3.42170089]


portfolio before change:  [3.42958058]
curr_Stock_Price:  98.70903022007987
curr_Factors:  [9.87090302e+01 3.98954530e-02]
mat_Sqrt:  [[ 1.97159898e+01  0.00000000e+00]
 [-7.98953846e-03  1.83063324e-02]]
grads:  [-0.00716907 -4.6176102 ]
Stock Position:  -0.007169070972565198
Bond Position:  [4.13723262]


portfolio before change:  [3.43421133]
curr_Stock_Price:  98.13523682384336
curr_Factors:  [9.81352368e+01 4.17778925e-02]
mat_Sqrt:  [[ 2.00584901e+01  0.00000000e+00]
 [-8.17585641e-03  1.87332404e-02]]
grads:  [0.010332   5.01898828]
Stock Position:  0.01033199804983468
Bond Position:  [2.42027826]


portfolio before change:  [3.42137477]
curr_Stock_Price:  96.8635448730007
curr_Factors:  [9.68635449e+01 4.20169913e-02]
mat_Sqrt:  [[ 1.98551345e+01  0.00000000e+00]
 [-8.19921862e-03  1.87867700e-02]]
grads:  [6.30609755e-03 7.54331734e+00]
Stock Position:  0.006306097546623505
Bond Position:  [2.8105438]


portfolio before change:  [3.40917867]
curr_Stock_Price:  94.8738144122597
curr_Factors:  [9.48738144e+01 4.50503052e-02]
mat_Sqrt:  [[ 2.01370214e+01  0.00000000e+00]
 [-8.49002287e-03  1.94530862e-02]]
grads:  [2.02278535e-02 2.56354572e+01]
Stock Position:  0.020227853541104842
Bond Position:  [1.49008505]


portfolio before change:  [3.37803753]
curr_Stock_Price:  93.32508768493484
curr_Factors:  [9.33250877e+01 4.62688598e-02]
mat_Sqrt:  [[ 2.00744107e+01  0.00000000e+00]
 [-8.60407901e-03  1.97144217e-02]]
grads:  [1.21695269e-02 1.74928107e+01]
Stock Position:  0.012169526898634164
Bond Position:  [2.24231536]


portfolio before change:  [3.37458769]
curr_Stock_Price:  93.01857227885162
curr_Factors:  [9.30185723e+01 4.64725941e-02]
mat_Sqrt:  [[ 2.00524816e+01  0.00000000e+00]
 [-8.62300125e-03  1.97577780e-02]]
grads:  [0.02017205 1.27554697]
Stock Position:  0.020172049029788513
Bond Position:  [1.49821248]


portfolio before change:  [3.37710941]
curr_Stock_Price:  93.13429846198457
curr_Factors:  [9.31342985e+01 4.91890967e-02]
mat_Sqrt:  [[ 2.06558976e+01  0.00000000e+00]
 [-8.87144603e-03  2.03270365e-02]]
grads:  [4.29165225e-03 7.75896407e+00]
Stock Position:  0.004291652246095445
Bond Position:  [2.97740939]


portfolio before change:  [3.37781595]
curr_Stock_Price:  93.2122049347435
curr_Factors:  [9.32122049e+01 5.07737444e-02]
mat_Sqrt:  [[ 2.10035342e+01  0.00000000e+00]
 [-9.01321202e-03  2.06518632e-02]]
grads:  [9.78717724e-03 1.18095296e+01]
Stock Position:  0.009787177235620129
Bond Position:  [2.46553158]


portfolio before change:  [3.37723977]
curr_Stock_Price:  93.12184276103878
curr_Factors:  [9.31218428e+01 5.04195147e-02]
mat_Sqrt:  [[ 2.09098488e+01  0.00000000e+00]
 [-8.98171607e-03  2.05796969e-02]]
grads:  [6.51910007e-03 1.15936857e+01]
Stock Position:  0.006519100074668519
Bond Position:  [2.77016916]


portfolio before change:  [3.38151101]
curr_Stock_Price:  93.7239103043262
curr_Factors:  [9.37239103e+01 4.98077090e-02]
mat_Sqrt:  [[ 2.09169656e+01  0.00000000e+00]
 [-8.92705631e-03  2.04544556e-02]]
grads:  [1.45633073e-02 1.77998564e+01]
Stock Position:  0.01456330729237747
Bond Position:  [2.0165809]


portfolio before change:  [3.37441798]
curr_Stock_Price:  93.2195530330626
curr_Factors:  [9.32195530e+01 4.85701836e-02]
mat_Sqrt:  [[ 2.05443256e+01  0.00000000e+00]
 [-8.81545766e-03  2.01987510e-02]]
grads:  [0.00889049 3.75825352]
Stock Position:  0.00889048844533339
Bond Position:  [2.54565063]


portfolio before change:  [3.37673847]
curr_Stock_Price:  93.44476671587002
curr_Factors:  [9.34447667e+01 4.88217957e-02]
mat_Sqrt:  [[ 2.06472330e+01  0.00000000e+00]
 [-8.83826189e-03  2.02510021e-02]]
grads:  [-1.45951037e-04 -3.18419971e+00]
Stock Position:  -0.00014595103719775333
Bond Position:  [3.39037683]


portfolio before change:  [3.37737476]
curr_Stock_Price:  91.98900281433957
curr_Factors:  [9.19890028e+01 4.89062329e-02]
mat_Sqrt:  [[ 2.03431414e+01  0.00000000e+00]
 [-8.84590146e-03  2.02685065e-02]]
grads:  [ 0.02254462 -6.5358168 ]
Stock Position:  0.02254462391504573
Bond Position:  [1.30351729]


portfolio before change:  [3.412655]
curr_Stock_Price:  93.54668173944276
curr_Factors:  [9.35466817e+01 4.92781174e-02]
mat_Sqrt:  [[ 2.07661239e+01  0.00000000e+00]
 [-8.87947002e-03  2.03454217e-02]]
grads:  [ 0.00202872 -1.85683001]
Stock Position:  0.0020287180619767615
Bond Position:  [3.22287516]


portfolio before change:  [3.41230234]
curr_Stock_Price:  93.17425759619722
curr_Factors:  [9.31742576e+01 5.02312963e-02]
mat_Sqrt:  [[ 2.08825310e+01  0.00000000e+00]
 [-8.96493581e-03  2.05412485e-02]]
grads:  [-3.37885582e-05  3.80507297e+00]
Stock Position:  -3.378855816370934e-05
Bond Position:  [3.41545056]


portfolio before change:  [3.4127183]
curr_Stock_Price:  93.49970595655886
curr_Factors:  [9.34997060e+01 5.04347401e-02]
mat_Sqrt:  [[ 2.09978650e+01  0.00000000e+00]
 [-8.98307209e-03  2.05828039e-02]]
grads:  [-3.79705128e-03 -5.24925151e+00]
Stock Position:  -0.0037970512810885163
Bond Position:  [3.76774148]


portfolio before change:  [3.41590477]
curr_Stock_Price:  92.7845538576126
curr_Factors:  [9.27845539e+01 4.96371289e-02]
mat_Sqrt:  [[ 2.06718341e+01  0.00000000e+00]
 [-8.91175663e-03  2.04193997e-02]]
grads:  [-1.78423564e-03 -8.05729591e+00]
Stock Position:  -0.0017842356395805293
Bond Position:  [3.58145428]


portfolio before change:  [3.4182665]
curr_Stock_Price:  91.71181182537977
curr_Factors:  [9.17118118e+01 4.85647710e-02]
mat_Sqrt:  [[ 2.02109136e+01  0.00000000e+00]
 [-8.81496646e-03  2.01976255e-02]]
grads:  [7.05741470e-03 1.04154397e+01]
Stock Position:  0.007057414699805881
Bond Position:  [2.77101821]


portfolio before change:  [3.43257499]
curr_Stock_Price:  93.69016926547042
curr_Factors:  [9.36901693e+01 4.71077869e-02]
mat_Sqrt:  [[ 2.03348220e+01  0.00000000e+00]
 [-8.68173134e-03  1.98923455e-02]]
grads:  [6.10078912e-03 9.09598842e+00]
Stock Position:  0.006100789122516739
Bond Position:  [2.86099103]


portfolio before change:  [3.43902055]
curr_Stock_Price:  94.68805812041622
curr_Factors:  [9.46880581e+01 4.80560022e-02]
mat_Sqrt:  [[ 2.07572124e+01  0.00000000e+00]
 [-8.76867171e-03  2.00915509e-02]]
grads:  [8.58311785e-03 8.70701296e+00]
Stock Position:  0.008583117847277109
Bond Position:  [2.62630178]


portfolio before change:  [3.44200896]
curr_Stock_Price:  94.99798091177112
curr_Factors:  [9.49979809e+01 4.73698011e-02]
mat_Sqrt:  [[ 2.06759349e+01  0.00000000e+00]
 [-8.70584182e-03  1.99475896e-02]]
grads:  [-0.00581008  5.28123487]
Stock Position:  -0.0058100789143093225
Bond Position:  [3.99395472]


portfolio before change:  [3.43258999]
curr_Stock_Price:  96.70505585582006
curr_Factors:  [9.67050559e+01 4.63540639e-02]
mat_Sqrt:  [[ 2.08205927e+01  0.00000000e+00]
 [-8.61199758e-03  1.97325654e-02]]
grads:  [-0.00953863 -2.45600993]
Stock Position:  -0.009538626075653896
Bond Position:  [4.35502336]


portfolio before change:  [3.43838348]
curr_Stock_Price:  96.15475961856556
curr_Factors:  [9.61547596e+01 4.47197043e-02]
mat_Sqrt:  [[ 2.03338796e+01  0.00000000e+00]
 [-8.45881356e-03  1.93815767e-02]]
grads:  [ 0.00557795 -4.18455601]
Stock Position:  0.005577949183748269
Bond Position:  [2.90203711]


portfolio before change:  [3.43724607]
curr_Stock_Price:  95.88581079184087
curr_Factors:  [9.58858108e+01 4.58702100e-02]
mat_Sqrt:  [[ 2.05361822e+01  0.00000000e+00]
 [-8.56693271e-03  1.96293088e-02]]
grads:  [-0.05464255 -6.18038074]
Stock Position:  -0.05464255250369367
Bond Position:  [8.67669152]


portfolio before change:  [3.43108002]
curr_Stock_Price:  96.01850422901741
curr_Factors:  [9.60185042e+01 4.52678967e-02]
mat_Sqrt:  [[ 2.04291405e+01  0.00000000e+00]
 [-8.51050144e-03  1.95000085e-02]]
grads:  [-1.77993599e-03  5.91996341e+00]
Stock Position:  -0.001779935986438382
Bond Position:  [3.60198681]


portfolio before change:  [3.4320371]
curr_Stock_Price:  95.73376932713396
curr_Factors:  [9.57337693e+01 4.59639811e-02]
mat_Sqrt:  [[ 2.05245658e+01  0.00000000e+00]
 [-8.57568480e-03  1.96493624e-02]]
grads:  [-2.99438524e-03 -6.17638619e+00]
Stock Position:  -0.002994385238861921
Bond Position:  [3.71870089]


portfolio before change:  [3.43489722]
curr_Stock_Price:  94.93385488157574
curr_Factors:  [9.49338549e+01 4.63789586e-02]
mat_Sqrt:  [[ 2.04447410e+01  0.00000000e+00]
 [-8.61430982e-03  1.97378634e-02]]
grads:  [3.55480571e-03 3.94629609e+00]
Stock Position:  0.0035548057054148275
Bond Position:  [3.09742581]


portfolio before change:  [3.43399679]
curr_Stock_Price:  94.57163039437798
curr_Factors:  [9.45716304e+01 4.74671960e-02]
mat_Sqrt:  [[ 2.06042905e+01  0.00000000e+00]
 [-8.71478706e-03  1.99680857e-02]]
grads:  [1.19595004e-03 8.26901930e+00]
Stock Position:  0.0011959500382831118
Bond Position:  [3.32089384]


portfolio before change:  [3.43351835]
curr_Stock_Price:  93.8244649131352
curr_Factors:  [9.38244649e+01 4.62473964e-02]
mat_Sqrt:  [[ 2.01771462e+01  0.00000000e+00]
 [-8.60208314e-03  1.97098486e-02]]
grads:  [-0.08422396 -3.86874054]
Stock Position:  -0.0842239610811209
Bond Position:  [11.33578643]


portfolio before change:  [3.40827922]
curr_Stock_Price:  94.14095670386631
curr_Factors:  [9.41409567e+01 4.63978436e-02]
mat_Sqrt:  [[ 2.02781115e+01  0.00000000e+00]
 [-8.61606347e-03  1.97418815e-02]]
grads:  [1.01907974e-03 1.15780150e+01]
Stock Position:  0.0010190797383336607
Bond Position:  [3.31234208]


portfolio before change:  [3.40948999]
curr_Stock_Price:  94.92274038913652
curr_Factors:  [9.49227404e+01 4.67315632e-02]
mat_Sqrt:  [[ 2.05199086e+01  0.00000000e+00]
 [-8.64699376e-03  1.98127517e-02]]
grads:  [-4.29754426e-03  5.51976656e+00]
Stock Position:  -0.004297544258313216
Bond Position:  [3.81742467]


portfolio before change:  [3.41352465]
curr_Stock_Price:  94.09495384776748
curr_Factors:  [9.40949538e+01 4.49966945e-02]
mat_Sqrt:  [[ 1.99598209e+01  0.00000000e+00]
 [-8.48496972e-03  1.94415080e-02]]
grads:  [ 0.05648734 -1.76237759]
Stock Position:  0.05648733751942433
Bond Position:  [-1.90164877]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.38578145]
Stock Price:  93.60802215707814
PL:  [3.38578145]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.84030392e-01  4.88195527e-01]
 [-2.68317498e-01 -5.88778660e-02]
 [ 8.61493994e-01 -7.32710774e-01]
 [-3.10983101e-03  2.45828617e-02]
 [-6.42260203e-02  2.90638217e-02]
 [-2.71125044e-02 -9.95326731e-03]
 [ 4.75179244e-02  1.98756519e-01]
 [ 4.76873968e-01 -1.87651075e-02]
 [-2.78617330e-01 -1.20121650e-01]
 [ 5.84242605e-01 -4.59478469e-01]
 [ 5.95041330e-02 -1.50837753e-02]
 [-4.92535606e-01 -2.40731329e-01]
 [-1.23292026e-01  1.25701489e-01]
 [-7.80551956e-01 -1.13114406e+00]
 [-1.08573016e-01 -6.04015372e-01]
 [-9.26347822e-02 -2.66290204e-01]
 [-4.93324033e-02  6.61422262e-02]
 [ 1.34295186e-01  1.57164705e-01]
 [ 1.67940573e-02  1.88070741e-02]
 [-1.08009386e-01 -2.89669891e-02]
 [ 2.28952434e-01  2.66532564e-01]
 [ 1.36390461e-02  5.28654630e-02]
 [ 3.85200536e-02  3.61114748e-01]
 [ 2.71813595e-02  1.66169936e-01]
 [ 2.49601346e-02  5.74350388e-02]
 [ 5.83753920e-01 -1.60865977e-01]
 [ 6.77368056e-03  2.15467712e-01]
 [-2.10164340e-01  1.48285213e-01]
 [-1.48798877e-02 -1.29380226e-01]
 [ 1.30511286e-02 -4.93749069e-02]
 [-7.01709890e-01 -8.97405920e-02]
 [-1.18078986e-01  5.57615333e-03]
 [ 2.18987632e-02 -8.23124422e-02]
 [ 1.10911494e-01  8.70209013e-02]
 [-2.04031019e-01  8.91393525e-03]
 [-2.54326757e-01 -3.86702186e-01]
 [-1.44075858e-01  2.30503578e-01]
 [-1.23490959e-01  1.17743009e-01]
 [ 3.14151034e-02  1.01286362e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.08104745]
curr_Stock_Price:  100.50806637644078
curr_Factors:  [1.00508066e+02 3.97158149e-02]
mat_Sqrt:  [[ 2.00300788e+01  0.00000000e+00]
 [-7.97153083e-03  1.82650717e-02]]
grads:  [1.98250038e-02 2.67283663e+01]
Stock Position:  0.01982500382398357
Bond Position:  [4.08847465]


portfolio before change:  [6.11853011]
curr_Stock_Price:  102.37296270207088
curr_Factors:  [1.02372963e+02 3.77435281e-02]
mat_Sqrt:  [[ 1.98887056e+01  0.00000000e+00]
 [-7.77107747e-03  1.78057754e-02]]
grads:  [-0.01478296 -3.3066724 ]
Stock Position:  -0.014782958293821013
Bond Position:  [7.63190535]


portfolio before change:  [6.11811757]
curr_Stock_Price:  102.4654061862212
curr_Factors:  [1.02465406e+02 3.75946383e-02]
mat_Sqrt:  [[ 1.98673627e+01  0.00000000e+00]
 [-7.75573473e-03  1.77706207e-02]]
grads:  [ 2.72664673e-02 -4.12315802e+01]
Stock Position:  0.027266467251968712
Bond Position:  [3.32424793]


portfolio before change:  [6.06367752]
curr_Stock_Price:  100.45357209353615
curr_Factors:  [1.00453572e+02 3.76651735e-02]
mat_Sqrt:  [[ 1.94955446e+01  0.00000000e+00]
 [-7.76300700e-03  1.77872836e-02]]
grads:  [3.90807724e-04 1.38204699e+00]
Stock Position:  0.0003908077244575531
Bond Position:  [6.02441949]


portfolio before change:  [6.06446243]
curr_Stock_Price:  100.53496671329458
curr_Factors:  [1.00534967e+02 3.77851198e-02]
mat_Sqrt:  [[ 1.95423839e+01  0.00000000e+00]
 [-7.77535798e-03  1.78155832e-02]]
grads:  [-0.00263742  1.63137077]
Stock Position:  -0.0026374227861320665
Bond Position:  [6.32961564]


portfolio before change:  [6.06298727]
curr_Stock_Price:  101.39429621693988
curr_Factors:  [1.01394296e+02 3.62891181e-02]
mat_Sqrt:  [[ 1.93153122e+01  0.00000000e+00]
 [-7.61988116e-03  1.74593411e-02]]
grads:  [-0.00162858 -0.57008264]
Stock Position:  -0.001628576648976196
Bond Position:  [6.22811565]


portfolio before change:  [6.06202024]
curr_Stock_Price:  102.46614350302096
curr_Factors:  [1.02466144e+02 3.65098159e-02]
mat_Sqrt:  [[ 1.95787614e+01  0.00000000e+00]
 [-7.64301678e-03  1.75123515e-02]]
grads:  [6.85755235e-03 1.13495049e+01]
Stock Position:  0.006857552348327554
Bond Position:  [5.3593533]


portfolio before change:  [6.07656465]
curr_Stock_Price:  104.48937931929257
curr_Factors:  [1.04489379e+02 3.56314983e-02]
mat_Sqrt:  [[ 1.97237365e+01  0.00000000e+00]
 [-7.55052298e-03  1.73004215e-02]]
grads:  [ 0.02376244 -1.08466186]
Stock Position:  0.02376244499299575
Bond Position:  [3.59364152]


portfolio before change:  [6.10604795]
curr_Stock_Price:  105.71122592141097
curr_Factors:  [1.05711226e+02 3.51358183e-02]
mat_Sqrt:  [[ 1.98150944e+01  0.00000000e+00]
 [-7.49782030e-03  1.71796645e-02]]
grads:  [-0.01670659 -6.99208354]
Stock Position:  -0.01670659294069342
Bond Position:  [7.87212237]


portfolio before change:  [6.11757836]
curr_Stock_Price:  105.07995806792606
curr_Factors:  [1.05079958e+02 3.45341386e-02]
mat_Sqrt:  [[ 1.95273902e+01  0.00000000e+00]
 [-7.43334526e-03  1.70319337e-02]]
grads:  [ 1.96498230e-02 -2.69774694e+01]
Stock Position:  0.019649822967704834
Bond Position:  [4.05277579]


portfolio before change:  [6.10462581]
curr_Stock_Price:  104.39500652907628
curr_Factors:  [1.04395007e+02 3.57679166e-02]
mat_Sqrt:  [[ 1.97436093e+01  0.00000000e+00]
 [-7.56496309e-03  1.73335080e-02]]
grads:  [ 0.00268041 -0.87020903]
Stock Position:  0.0026804133421801735
Bond Position:  [5.82480404]


portfolio before change:  [6.11044376]
curr_Stock_Price:  106.29389271546567
curr_Factors:  [1.06293893e+02 3.52809646e-02]
mat_Sqrt:  [[ 1.99654240e+01  0.00000000e+00]
 [-7.51329112e-03  1.72151126e-02]]
grads:  [ -0.02993171 -13.98372084]
Stock Position:  -0.029931714548719405
Bond Position:  [9.29200221]


portfolio before change:  [6.11863538]
curr_Stock_Price:  106.05902315093167
curr_Factors:  [1.06059023e+02 3.32944899e-02]
mat_Sqrt:  [[ 1.93523543e+01  0.00000000e+00]
 [-7.29871111e-03  1.67234481e-02]]
grads:  [-3.53607615e-03  7.51648153e+00]
Stock Position:  -0.0035360761492636535
Bond Position:  [6.49366816]


portfolio before change:  [6.12194439]
curr_Stock_Price:  105.35280142571173
curr_Factors:  [1.05352801e+02 3.36439496e-02]
mat_Sqrt:  [[ 1.93241133e+01  0.00000000e+00]
 [-7.33691484e-03  1.68109838e-02]]
grads:  [-6.59395686e-02 -6.72860118e+01]
Stock Position:  -0.06593956858439963
Bond Position:  [13.06886267]


portfolio before change:  [6.05829891]
curr_Stock_Price:  106.34278647637188
curr_Factors:  [1.06342786e+02 3.23904007e-02]
mat_Sqrt:  [[ 1.91388658e+01  0.00000000e+00]
 [-7.19893334e-03  1.64948285e-02]]
grads:  [-1.94466558e-02 -3.66184694e+01]
Stock Position:  -0.01944665584137423
Bond Position:  [8.12631048]


portfolio before change:  [6.02834257]
curr_Stock_Price:  107.93546136569101
curr_Factors:  [1.07935461e+02 3.16331695e-02]
mat_Sqrt:  [[ 1.91970947e+01  0.00000000e+00]
 [-7.11428642e-03  1.63008780e-02]]
grads:  [-1.08794252e-02 -1.63359424e+01]
Stock Position:  -0.010879425195159621
Bond Position:  [7.20261834]


portfolio before change:  [6.02422683]
curr_Stock_Price:  108.39652603311879
curr_Factors:  [1.08396526e+02 3.17291524e-02]
mat_Sqrt:  [[ 1.93083250e+01  0.00000000e+00]
 [-7.12507150e-03  1.63255897e-02]]
grads:  [-1.05993499e-03  4.05144483e+00]
Stock Position:  -0.0010599349878901967
Bond Position:  [6.1391201]


portfolio before change:  [6.02614388]
curr_Stock_Price:  107.31192545137756
curr_Factors:  [1.07311925e+02 3.17247216e-02]
mat_Sqrt:  [[ 1.91137938e+01  0.00000000e+00]
 [-7.12457399e-03  1.63244498e-02]]
grads:  [0.01061472 9.62756519]
Stock Position:  0.010614715669141605
Bond Position:  [4.8870583]


portfolio before change:  [6.01824164]
curr_Stock_Price:  106.50991063562736
curr_Factors:  [1.06509911e+02 3.18320189e-02]
mat_Sqrt:  [[ 1.90029976e+01  0.00000000e+00]
 [-7.13661196e-03  1.63520323e-02]]
grads:  [0.00131569 1.1501368 ]
Stock Position:  0.0013156943933631384
Bond Position:  [5.87810714]


portfolio before change:  [6.01743171]
curr_Stock_Price:  105.33582973863707
curr_Factors:  [1.05335830e+02 3.25922978e-02]
mat_Sqrt:  [[ 1.90166324e+01  0.00000000e+00]
 [-7.22133481e-03  1.65461567e-02]]
grads:  [-0.00634453 -1.75067779]
Stock Position:  -0.00634453116243249
Bond Position:  [6.68573817]


portfolio before change:  [6.02710101]
curr_Stock_Price:  103.94352366013392
curr_Factors:  [1.03943524e+02 3.33982296e-02]
mat_Sqrt:  [[ 1.89958687e+01  0.00000000e+00]
 [-7.31007300e-03  1.67494814e-02]]
grads:  [ 0.01817641 15.91288451]
Stock Position:  0.018176414437985556
Bond Position:  [4.13778045]


portfolio before change:  [6.01046681]
curr_Stock_Price:  102.99991314512651
curr_Factors:  [1.02999913e+02 3.43688325e-02]
mat_Sqrt:  [[ 1.90949818e+01  0.00000000e+00]
 [-7.41553316e-03  1.69911210e-02]]
grads:  [1.92256930e-03 3.11135816e+00]
Stock Position:  0.0019225692954304605
Bond Position:  [5.81244234]


portfolio before change:  [6.00856377]
curr_Stock_Price:  101.63213558742696
curr_Factors:  [1.01632136e+02 3.56691003e-02]
mat_Sqrt:  [[ 1.91945144e+01  0.00000000e+00]
 [-7.55450598e-03  1.73095477e-02]]
grads:  [1.02176823e-02 2.08621712e+01]
Stock Position:  0.010217682323304425
Bond Position:  [4.97011889]


portfolio before change:  [6.01088577]
curr_Stock_Price:  101.79858220201454
curr_Factors:  [1.01798582e+02 3.59767035e-02]
mat_Sqrt:  [[ 1.93086724e+01  0.00000000e+00]
 [-7.58701032e-03  1.73840246e-02]]
grads:  [5.16368310e-03 9.55877251e+00]
Stock Position:  0.005163683101994853
Bond Position:  [5.48523015]


portfolio before change:  [6.00635897]
curr_Stock_Price:  100.78913016875039
curr_Factors:  [1.00789130e+02 3.73484379e-02]
mat_Sqrt:  [[ 1.94782492e+01  0.00000000e+00]
 [-7.73029758e-03  1.77123369e-02]]
grads:  [2.56834380e-03 3.24265732e+00]
Stock Position:  0.002568343798222102
Bond Position:  [5.74749784]


portfolio before change:  [6.00490643]
curr_Stock_Price:  99.94382617616427
curr_Factors:  [9.99438262e+01 3.68071321e-02]
mat_Sqrt:  [[ 1.91744079e+01  0.00000000e+00]
 [-7.67407397e-03  1.75835124e-02]]
grads:  [ 0.0267829  -9.14868276]
Stock Position:  0.026782900166310564
Bond Position:  [3.32812091]


portfolio before change:  [5.9494521]
curr_Stock_Price:  97.85778011356393
curr_Factors:  [9.78577801e+01 3.76130966e-02]
mat_Sqrt:  [[ 1.89786320e+01  0.00000000e+00]
 [-7.75763846e-03  1.77749827e-02]]
grads:  [5.31184227e-03 1.21219646e+01]
Stock Position:  0.005311842269636123
Bond Position:  [5.42964701]


portfolio before change:  [5.95773718]
curr_Stock_Price:  99.28973708604904
curr_Factors:  [9.92897371e+01 3.62799187e-02]
mat_Sqrt:  [[ 1.89120024e+01  0.00000000e+00]
 [-7.61891527e-03  1.74571280e-02]]
grads:  [-7.69074394e-03  8.49425022e+00]
Stock Position:  -0.007690743942216484
Bond Position:  [6.72134912]


portfolio before change:  [5.95900915]
curr_Stock_Price:  99.2335983215766
curr_Factors:  [9.92335983e+01 3.65184834e-02]
mat_Sqrt:  [[ 1.89633520e+01  0.00000000e+00]
 [-7.64392395e-03  1.75144301e-02]]
grads:  [-3.76231205e-03 -7.38706458e+00]
Stock Position:  -0.0037623120477656754
Bond Position:  [6.33235691]


portfolio before change:  [5.95759211]
curr_Stock_Price:  99.82064139159131
curr_Factors:  [9.98206414e+01 3.70840269e-02]
mat_Sqrt:  [[ 1.92226740e+01  0.00000000e+00]
 [-7.70288537e-03  1.76495276e-02]]
grads:  [-4.42074160e-04 -2.79752002e+00]
Stock Position:  -0.0004420741604251827
Bond Position:  [6.00172023]


portfolio before change:  [5.95845654]
curr_Stock_Price:  99.5623692393738
curr_Factors:  [9.95623692e+01 3.77334714e-02]
mat_Sqrt:  [[ 1.9340095e+01  0.0000000e+00]
 [-7.7700421e-03  1.7803403e-02]]
grads:  [-0.03830777 -5.04064261]
Stock Position:  -0.03830776912043296
Bond Position:  [9.7724688]


portfolio before change:  [5.94883466]
curr_Stock_Price:  99.84543247351378
curr_Factors:  [9.98454325e+01 3.85490284e-02]
mat_Sqrt:  [[ 1.96035589e+01  0.00000000e+00]
 [-7.85356260e-03  1.79947725e-02]]
grads:  [-0.0058992   0.30987629]
Stock Position:  -0.005899201972577619
Bond Position:  [6.53784303]


portfolio before change:  [5.95305132]
curr_Stock_Price:  99.26918747940843
curr_Factors:  [9.92691875e+01 3.73787688e-02]
mat_Sqrt:  [[ 1.91922973e+01  0.00000000e+00]
 [-7.73343585e-03  1.77195276e-02]]
grads:  [-7.30779202e-04 -4.64529552e+00]
Stock Position:  -0.0007307792017917899
Bond Position:  [6.02559518]


portfolio before change:  [5.95332237]
curr_Stock_Price:  99.9290323948154
curr_Factors:  [9.99290324e+01 3.83077939e-02]
mat_Sqrt:  [[ 1.95584869e+01  0.00000000e+00]
 [-7.82895077e-03  1.79383798e-02]]
grads:  [0.00761258 4.85110152]
Stock Position:  0.007612579117035929
Bond Position:  [5.1926047]


portfolio before change:  [5.9497041]
curr_Stock_Price:  99.36846152473329
curr_Factors:  [9.93684615e+01 3.84953987e-02]
mat_Sqrt:  [[ 1.94963349e+01  0.00000000e+00]
 [-7.84809773e-03  1.79822509e-02]]
grads:  [-0.01026555  0.49570742]
Stock Position:  -0.010265552944309673
Bond Position:  [6.9697763]


portfolio before change:  [5.93707355]
curr_Stock_Price:  100.68371665346545
curr_Factors:  [1.00683717e+02 3.83838518e-02]
mat_Sqrt:  [[ 1.97257496e+01  0.00000000e+00]
 [-7.83671888e-03  1.79561787e-02]]
grads:  [-2.14489911e-02 -2.15358842e+01]
Stock Position:  -0.0214489911196727
Bond Position:  [8.0966377]


portfolio before change:  [5.89347624]
curr_Stock_Price:  102.76350949209431
curr_Factors:  [1.02763509e+02 3.80003051e-02]
mat_Sqrt:  [[ 2.00323763e+01  0.00000000e+00]
 [-7.79746678e-03  1.78662409e-02]]
grads:  [-2.17027917e-03  1.29016271e+01]
Stock Position:  -0.0021702791739963315
Bond Position:  [6.11650174]


portfolio before change:  [5.89838272]
curr_Stock_Price:  100.85505662371278
curr_Factors:  [1.00855057e+02 3.92278830e-02]
mat_Sqrt:  [[ 1.99753829e+01  0.00000000e+00]
 [-7.92241206e-03  1.81525265e-02]]
grads:  [-3.60962778e-03  6.48631522e+00]
Stock Position:  -0.0036096277782989667
Bond Position:  [6.26243194]


portfolio before change:  [5.89399839]
curr_Stock_Price:  102.28655867580741
curr_Factors:  [1.02286559e+02 3.86068507e-02]
mat_Sqrt:  [[ 2.00979035e+01  0.00000000e+00]
 [-7.85945044e-03  1.80082633e-02]]
grads:  [3.76258628e-03 5.62443809e+00]
Stock Position:  0.0037625862806822076
Bond Position:  [5.50913638]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.89914962]
Stock Price:  103.47259044351645
PL:  [2.42655917]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.86863897e-01  7.39112235e-01]
 [-2.50265739e-01 -6.36810345e-02]
 [ 9.61802689e-01 -8.76407729e-01]
 [-1.52629395e-01  2.08238187e-01]
 [-1.71170437e-01  1.45502681e-01]
 [ 4.25981210e-01  3.68861205e-01]
 [ 1.37245826e-01 -9.14956290e-02]
 [ 5.52560565e-01 -2.50956535e-02]
 [-2.87261474e-01 -1.29121802e-01]
 [ 7.20798766e-01 -6.31720646e-01]
 [ 5.85286159e-02 -1.84520714e-02]
 [-2.28046638e-01 -1.90469488e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-5.42824756e-01 -6.93049773e-01]
 [ 5.14208519e-02  1.09956156e-01]
 [ 5.49327386e-02 -2.09985686e-02]
 [-5.25011816e-02  2.44269517e-01]
 [-1.41134032e-01  2.04031297e-02]
 [ 1.49719815e-02  6.40494916e-02]
 [-9.74929740e-02 -3.84452673e-02]
 [ 2.37771005e-01  2.18193326e-01]
 [ 3.69136678e-02  4.12797064e-02]
 [ 2.04716328e-03  1.90487395e-01]
 [ 4.33312312e-02  1.71791254e-01]
 [ 4.07684728e-02  9.02222492e-02]
 [ 7.56033047e-01 -4.91431956e-01]
 [-4.21437400e-01  5.36932159e-01]
 [ 1.49626613e-01 -8.34256062e-03]
 [-4.47210487e-02 -6.55135544e-02]
 [-4.32086683e-02 -1.10503732e-01]
 [-4.23909458e-01 -9.70630563e-02]
 [-1.17936208e-01  3.35135142e-05]
 [ 1.22774531e-01  9.17083473e-02]
 [ 1.95736497e-01  4.35019306e-02]
 [-2.43305153e-01 -2.01957017e-01]
 [ 6.97513024e-02 -3.43245042e-01]
 [-1.59758767e-01  2.16892890e-01]
 [-1.20291245e-01  1.19901601e-01]
 [-8.81110220e-02  1.22099582e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.90393632]
curr_Stock_Price:  101.23447150131403
curr_Factors:  [1.01234472e+02 3.84452211e-02]
mat_Sqrt:  [[ 1.98495014e+01  0.00000000e+00]
 [-7.84298117e-03  1.79705275e-02]]
grads:  [3.57408939e-02 4.11291342e+01]
Stock Position:  0.0357408939429512
Bond Position:  [7.28572581]


portfolio before change:  [10.93756508]
curr_Stock_Price:  102.14989313655396
curr_Factors:  [1.02149893e+02 3.87786514e-02]
mat_Sqrt:  [[ 2.01156591e+01  0.00000000e+00]
 [-7.87691833e-03  1.80482872e-02]]
grads:  [-0.01382298 -3.52836996]
Stock Position:  -0.013822983333421747
Bond Position:  [12.34958135]


portfolio before change:  [10.91486779]
curr_Stock_Price:  103.90357242842747
curr_Factors:  [1.03903572e+02 3.89122457e-02]
mat_Sqrt:  [[ 2.04962131e+01  0.00000000e+00]
 [-7.89047484e-03  1.80793491e-02]]
grads:  [ 2.82640991e-02 -4.84756240e+01]
Stock Position:  0.02826409908891119
Bond Position:  [7.97812693]


portfolio before change:  [10.95521379]
curr_Stock_Price:  105.29575093197727
curr_Factors:  [1.05295751e+02 3.73592263e-02]
mat_Sqrt:  [[ 2.03521260e+01  0.00000000e+00]
 [-7.73141398e-03  1.77148949e-02]]
grads:  [-3.03392380e-03  1.17549773e+01]
Stock Position:  -0.0030339238037081404
Bond Position:  [11.27467308]


portfolio before change:  [10.95459813]
curr_Stock_Price:  105.96323065116756
curr_Factors:  [1.05963231e+02 3.76496687e-02]
mat_Sqrt:  [[ 2.05605994e+01  0.00000000e+00]
 [-7.76140902e-03  1.77836222e-02]]
grads:  [-5.23661102e-03  8.18183606e+00]
Stock Position:  -0.005236611021960799
Bond Position:  [11.50948635]


portfolio before change:  [10.95836192]
curr_Stock_Price:  105.51923982358335
curr_Factors:  [1.05519240e+02 3.78095814e-02]
mat_Sqrt:  [[ 2.05178849e+01  0.00000000e+00]
 [-7.77787441e-03  1.78213491e-02]]
grads:  [ 0.0286075  20.69771501]
Stock Position:  0.02860750226111549
Bond Position:  [7.93972002]


portfolio before change:  [10.91821751]
curr_Stock_Price:  104.08126273130307
curr_Factors:  [1.04081263e+02 3.86880229e-02]
mat_Sqrt:  [[ 2.04720258e+01  0.00000000e+00]
 [-7.86770847e-03  1.80271848e-02]]
grads:  [ 4.75350413e-03 -5.07542525e+00]
Stock Position:  0.00475350413033349
Bond Position:  [10.4234668]


portfolio before change:  [10.92574363]
curr_Stock_Price:  105.39042521971619
curr_Factors:  [1.05390425e+02 3.82748660e-02]
mat_Sqrt:  [[ 2.06185441e+01  0.00000000e+00]
 [-7.82558532e-03  1.79306685e-02]]
grads:  [ 0.026268   -1.39959386]
Stock Position:  0.0262680003555504
Bond Position:  [8.15734791]


portfolio before change:  [10.93785065]
curr_Stock_Price:  105.81250858089547
curr_Factors:  [1.05812509e+02 3.75886839e-02]
mat_Sqrt:  [[ 2.05147189e+01  0.00000000e+00]
 [-7.75512052e-03  1.77692134e-02]]
grads:  [-0.01674967 -7.26660202]
Stock Position:  -0.01674967374653059
Bond Position:  [12.71017565]


portfolio before change:  [10.91944971]
curr_Stock_Price:  107.0059536914173
curr_Factors:  [1.07005954e+02 3.71361711e-02]
mat_Sqrt:  [[ 2.06208472e+01  0.00000000e+00]
 [-7.70829902e-03  1.76619319e-02]]
grads:  [ 2.15846259e-02 -3.57673583e+01]
Stock Position:  0.02158462592834145
Bond Position:  [8.60976623]


portfolio before change:  [10.90685885]
curr_Stock_Price:  106.3727649097404
curr_Factors:  [1.06372765e+02 3.82254424e-02]
mat_Sqrt:  [[ 2.07972881e+01  0.00000000e+00]
 [-7.82053117e-03  1.79190880e-02]]
grads:  [ 0.00242702 -1.02974389]
Stock Position:  0.002427021807276064
Bond Position:  [10.64868983]


portfolio before change:  [10.90351111]
curr_Stock_Price:  104.44492539719334
curr_Factors:  [1.04444925e+02 3.77072426e-02]
mat_Sqrt:  [[ 2.02814841e+01  0.00000000e+00]
 [-7.76734112e-03  1.77972143e-02]]
grads:  [ -0.01534278 -10.70220794]
Stock Position:  -0.015342779462054142
Bond Position:  [12.50598657]


portfolio before change:  [10.92423575]
curr_Stock_Price:  103.19604513817444
curr_Factors:  [1.03196045e+02 3.80653754e-02]
mat_Sqrt:  [[ 2.01339095e+01  0.00000000e+00]
 [-7.80413996e-03  1.78815311e-02]]
grads:  [-5.99944186e-03  9.25712938e+00]
Stock Position:  -0.005999441855045891
Bond Position:  [11.54335443]


portfolio before change:  [10.93264825]
curr_Stock_Price:  102.03435522894651
curr_Factors:  [1.02034355e+02 3.81855083e-02]
mat_Sqrt:  [[ 1.99386483e+01  0.00000000e+00]
 [-7.81644506e-03  1.79097256e-02]]
grads:  [ -0.04239487 -38.69683933]
Stock Position:  -0.04239487363375528
Bond Position:  [15.25838185]


portfolio before change:  [10.91663159]
curr_Stock_Price:  102.45714400781769
curr_Factors:  [1.02457144e+02 3.72170431e-02]
mat_Sqrt:  [[ 1.97657446e+01  0.00000000e+00]
 [-7.71668769e-03  1.76811527e-02]]
grads:  [5.02939075e-03 6.21883414e+00]
Stock Position:  0.005029390745298363
Bond Position:  [10.40133458]


portfolio before change:  [10.91363778]
curr_Stock_Price:  101.60334940553395
curr_Factors:  [1.01603349e+02 3.75297305e-02]
mat_Sqrt:  [[ 1.96832019e+01  0.00000000e+00]
 [-7.74903664e-03  1.77552735e-02]]
grads:  [ 0.00232524 -1.18266658]
Stock Position:  0.002325242209579101
Bond Position:  [10.67738538]


portfolio before change:  [10.91390186]
curr_Stock_Price:  101.14289163533336
curr_Factors:  [1.01142892e+02 3.68485225e-02]
mat_Sqrt:  [[ 1.94153581e+01  0.00000000e+00]
 [-7.67838759e-03  1.75933962e-02]]
grads:  [2.78680287e-03 1.38841594e+01]
Stock Position:  0.002786802870591685
Bond Position:  [10.63203656]


portfolio before change:  [10.91506712]
curr_Stock_Price:  101.08410641376551
curr_Factors:  [1.01084106e+02 3.85343453e-02]
mat_Sqrt:  [[ 1.98429788e+01  0.00000000e+00]
 [-7.85206677e-03  1.79913452e-02]]
grads:  [-0.00666379  1.13405249]
Stock Position:  -0.006663786612621484
Bond Position:  [11.58867004]


portfolio before change:  [10.91466993]
curr_Stock_Price:  101.3611061511253
curr_Factors:  [1.01361106e+02 4.09546485e-02]
mat_Sqrt:  [[ 2.05127054e+01  0.00000000e+00]
 [-8.09490195e-03  1.85477505e-02]]
grads:  [2.09262847e-03 3.45322155e+00]
Stock Position:  0.002092628470120901
Bond Position:  [10.70255879]


portfolio before change:  [10.91935764]
curr_Stock_Price:  102.96187242372744
curr_Factors:  [1.02961872e+02 4.08306082e-02]
mat_Sqrt:  [[ 2.08050784e+01  0.00000000e+00]
 [-8.08263404e-03  1.85196412e-02]]
grads:  [-0.0054925  -2.07591858]
Stock Position:  -0.005492498616519348
Bond Position:  [11.48487558]


portfolio before change:  [10.91908028]
curr_Stock_Price:  103.27376408980484
curr_Factors:  [1.03273764e+02 4.24684715e-02]
mat_Sqrt:  [[ 2.12825333e+01  0.00000000e+00]
 [-8.24315197e-03  1.88874339e-02]]
grads:  [ 0.01564656 11.55230123]
Stock Position:  0.015646557418140063
Bond Position:  [9.3032014]


portfolio before change:  [10.93598044]
curr_Stock_Price:  104.27955636339676
curr_Factors:  [1.04279556e+02 4.07519336e-02]
mat_Sqrt:  [[ 2.10510268e+01  0.00000000e+00]
 [-8.07484327e-03  1.85017902e-02]]
grads:  [0.00260936 2.23111958]
Stock Position:  0.0026093553107356606
Bond Position:  [10.66387802]


portfolio before change:  [10.93413623]
curr_Stock_Price:  103.06190804811546
curr_Factors:  [1.03061908e+02 4.13438156e-02]
mat_Sqrt:  [[ 2.09557619e+01  0.00000000e+00]
 [-8.13327148e-03  1.86356661e-02]]
grads:  [4.06488098e-03 1.02216574e+01]
Stock Position:  0.00406488097708121
Bond Position:  [10.51520184]


portfolio before change:  [10.9332671]
curr_Stock_Price:  102.52471945109372
curr_Factors:  [1.02524719e+02 4.04389481e-02]
mat_Sqrt:  [[ 2.06171445e+01  0.00000000e+00]
 [-8.04377505e-03  1.84306040e-02]]
grads:  [5.73828646e-03 9.32097797e+00]
Stock Position:  0.00573828646129886
Bond Position:  [10.34495089]


portfolio before change:  [10.93620128]
curr_Stock_Price:  102.81068948635803
curr_Factors:  [1.02810689e+02 4.08003738e-02]
mat_Sqrt:  [[ 2.07668364e+01  0.00000000e+00]
 [-8.07964096e-03  1.85127831e-02]]
grads:  [3.85926334e-03 4.87351084e+00]
Stock Position:  0.0038592633418477176
Bond Position:  [10.53942775]


portfolio before change:  [10.94201714]
curr_Stock_Price:  103.97628902226197
curr_Factors:  [1.03976289e+02 4.04143968e-02]
mat_Sqrt:  [[ 2.09026989e+01  0.00000000e+00]
 [-8.04133291e-03  1.84250084e-02]]
grads:  [ 2.59083557e-02 -2.66720072e+01]
Stock Position:  0.02590835571988078
Bond Position:  [8.24816246]


portfolio before change:  [10.96534831]
curr_Stock_Price:  104.83701846199733
curr_Factors:  [1.04837018e+02 4.08924695e-02]
mat_Sqrt:  [[ 2.12000229e+01  0.00000000e+00]
 [-8.08875461e-03  1.85336651e-02]]
grads:  [-8.82550904e-03  2.89706410e+01]
Stock Position:  -0.008825509038885404
Bond Position:  [11.89058837]


portfolio before change:  [10.97246129]
curr_Stock_Price:  104.19948466599534
curr_Factors:  [1.04199485e+02 3.95771009e-02]
mat_Sqrt:  [[ 2.07294395e+01  0.00000000e+00]
 [-7.95759772e-03  1.82331470e-02]]
grads:  [ 0.00704243 -0.45754914]
Stock Position:  0.007042429706302849
Bond Position:  [10.23864374]


portfolio before change:  [10.96986077]
curr_Stock_Price:  103.64847683641624
curr_Factors:  [1.03648477e+02 3.96966289e-02]
mat_Sqrt:  [[ 2.06509359e+01  0.00000000e+00]
 [-7.96960515e-03  1.82606594e-02]]
grads:  [-3.55013005e-03 -3.58768831e+00]
Stock Position:  -0.0035501300473773914
Bond Position:  [11.33782634]


portfolio before change:  [10.97136253]
curr_Stock_Price:  103.6246912799358
curr_Factors:  [1.03624691e+02 3.94972421e-02]
mat_Sqrt:  [[ 2.05942811e+01  0.00000000e+00]
 [-7.94956523e-03  1.82147422e-02]]
grads:  [-4.43989525e-03 -6.06671951e+00]
Stock Position:  -0.0044398952527345695
Bond Position:  [11.4314453]


portfolio before change:  [10.97919692]
curr_Stock_Price:  102.18200497532648
curr_Factors:  [1.02182005e+02 3.96345502e-02]
mat_Sqrt:  [[ 2.03428308e+01  0.00000000e+00]
 [-7.96337116e-03  1.82463756e-02]]
grads:  [-0.02292067 -5.3195801 ]
Stock Position:  -0.022920666912552432
Bond Position:  [13.32127662]


portfolio before change:  [10.97934768]
curr_Stock_Price:  102.2480809105901
curr_Factors:  [1.02248081e+02 3.98045425e-02]
mat_Sqrt:  [[ 2.03995921e+01  0.00000000e+00]
 [-7.98043031e-03  1.82854630e-02]]
grads:  [-0.00578059  0.0018328 ]
Stock Position:  -0.00578058528342942
Bond Position:  [11.57040143]


portfolio before change:  [10.98288175]
curr_Stock_Price:  101.88692706895758
curr_Factors:  [1.01886927e+02 4.09414304e-02]
mat_Sqrt:  [[ 2.06157895e+01  0.00000000e+00]
 [-8.09359554e-03  1.85447571e-02]]
grads:  [0.00789683 4.94524392]
Stock Position:  0.007896827603388008
Bond Position:  [10.17829825]


portfolio before change:  [10.99553537]
curr_Stock_Price:  103.3281701809204
curr_Factors:  [1.03328170e+02 4.00395601e-02]
mat_Sqrt:  [[ 2.06758507e+01  0.00000000e+00]
 [-8.00395504e-03  1.83393649e-02]]
grads:  [0.01038517 2.37205219]
Stock Position:  0.010385173465136316
Bond Position:  [9.9224544]


portfolio before change:  [10.99971614]
curr_Stock_Price:  103.6113038098644
curr_Factors:  [1.03611304e+02 4.05468425e-02]
mat_Sqrt:  [[ 2.08634276e+01  0.00000000e+00]
 [-8.05449862e-03  1.84551748e-02]]
grads:  [ -0.01588648 -10.94311048]
Stock Position:  -0.01588647981354493
Bond Position:  [12.64573503]


portfolio before change:  [11.00991556]
curr_Stock_Price:  103.06879215404707
curr_Factors:  [1.03068792e+02 3.99631780e-02]
mat_Sqrt:  [[ 2.06042682e+01  0.00000000e+00]
 [-7.99631695e-03  1.83218639e-02]]
grads:  [-3.88526855e-03 -1.87341771e+01]
Stock Position:  -0.0038852685528443136
Bond Position:  [11.4103655]


portfolio before change:  [11.00610908]
curr_Stock_Price:  104.4156407068448
curr_Factors:  [1.04415641e+02 3.90742893e-02]
mat_Sqrt:  [[ 2.06400670e+01  0.00000000e+00]
 [-7.90688706e-03  1.81169542e-02]]
grads:  [-3.15400862e-03  1.19718186e+01]
Stock Position:  -0.003154008617533654
Bond Position:  [11.33543691]


portfolio before change:  [11.00937113]
curr_Stock_Price:  103.83066000168614
curr_Factors:  [1.03830660e+02 3.83660395e-02]
mat_Sqrt:  [[ 2.03375718e+01  0.00000000e+00]
 [-7.83490033e-03  1.79520119e-02]]
grads:  [-3.34169177e-03  6.67900633e+00]
Stock Position:  -0.0033416917721335202
Bond Position:  [11.35634119]


portfolio before change:  [11.01050897]
curr_Stock_Price:  103.91498600757176
curr_Factors:  [1.03914986e+02 3.90091744e-02]
mat_Sqrt:  [[ 2.05239791e+01  0.00000000e+00]
 [-7.90029614e-03  1.81018525e-02]]
grads:  [-1.69666883e-03  6.74514289e+00]
Stock Position:  -0.0016966688337898108
Bond Position:  [11.18681829]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.01125575]
Stock Price:  104.29906600729993
PL:  [6.71218974]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.43109657e-01  4.37256834e-01]
 [-2.12655184e-01 -7.33582978e-02]
 [ 8.68262160e-01 -7.42393194e-01]
 [-1.50208447e-01  1.38112367e-01]
 [-1.81105634e-01  1.10100415e-01]
 [ 3.12594273e-01  2.78205803e-01]
 [ 1.03853235e-01  2.70054539e-02]
 [ 5.35334606e-01 -2.36609252e-02]
 [-3.33784621e-01 -1.74340816e-01]
 [ 6.47452772e-01 -5.38913510e-01]
 [ 5.87166183e-02 -1.78029307e-02]
 [-4.11942911e-01 -2.24213514e-01]
 [-1.33923580e-01  1.28484286e-01]
 [-1.23233027e+00 -1.51145680e+00]
 [-1.70128218e-01 -8.62472873e-01]
 [-1.17480247e-01 -2.91084437e-01]
 [-2.92674102e-02  4.59423960e-02]
 [ 1.48512645e-01  1.57197771e-01]
 [-4.13395461e-01 -3.28150556e-01]
 [-7.03565601e-02 -3.71033898e-02]
 [ 4.38706941e-02  4.87126595e-01]
 [ 2.59767919e-02  2.81482184e-01]
 [-4.79459770e-04 -3.40659427e-01]
 [ 1.96802072e-01  2.24176606e-01]
 [ 1.21368578e-01  2.43635606e-01]
 [ 8.62810618e-01 -9.75443815e-01]
 [-1.17990379e+00  1.36660162e+00]
 [ 4.98083244e-02 -1.88643154e-02]
 [-6.12139757e-02 -4.74895204e-02]
 [ 1.29672598e-01 -9.13144846e-02]
 [-8.61197837e-02 -1.26589755e-01]
 [ 3.09435936e-01 -3.17055652e-02]
 [ 3.24620309e-01  4.28066870e-01]
 [ 2.51094492e-01  1.51008358e-02]
 [-1.46581067e-01 -2.44537513e-01]
 [ 1.84202057e-01 -7.32930414e-02]
 [-2.18210933e-01  1.72292555e-01]
 [-1.15396172e-01  1.23203918e-01]
 [-2.64843837e-01  1.65674474e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.10741687]
curr_Stock_Price:  100.36142185388705
curr_Factors:  [1.00361422e+02 3.89258000e-02]
mat_Sqrt:  [[ 1.98009296e+01  0.00000000e+00]
 [-7.89184896e-03  1.80824976e-02]]
grads:  [1.68650761e-02 2.41812190e+01]
Stock Position:  0.01686507612224143
Bond Position:  [3.41481386]


portfolio before change:  [5.13016764]
curr_Stock_Price:  101.68509732518287
curr_Factors:  [1.01685097e+02 3.66764061e-02]
mat_Sqrt:  [[ 1.94737995e+01  0.00000000e+00]
 [-7.66043404e-03  1.75522594e-02]]
grads:  [-0.01256413 -4.17942192]
Stock Position:  -0.012564131061547548
Bond Position:  [6.40775253]


portfolio before change:  [5.11999521]
curr_Stock_Price:  102.55849262738866
curr_Factors:  [1.02558493e+02 3.67965005e-02]
mat_Sqrt:  [[ 1.96731946e+01  0.00000000e+00]
 [-7.67296558e-03  1.75809728e-02]]
grads:  [ 2.76648109e-02 -4.22270829e+01]
Stock Position:  0.027664810861772197
Bond Position:  [2.28273391]


portfolio before change:  [5.17960754]
curr_Stock_Price:  104.70298493554964
curr_Factors:  [1.04702985e+02 3.66633303e-02]
mat_Sqrt:  [[ 2.00481830e+01  0.00000000e+00]
 [-7.65906838e-03  1.75491303e-02]]
grads:  [-4.48575656e-03  7.87004056e+00]
Stock Position:  -0.004485756562611942
Bond Position:  [5.64927964]


portfolio before change:  [5.17981402]
curr_Stock_Price:  104.8143876470129
curr_Factors:  [1.04814388e+02 3.65290796e-02]
mat_Sqrt:  [[ 2.00327359e+01  0.00000000e+00]
 [-7.64503285e-03  1.75169709e-02]]
grads:  [-0.00664182  6.28535698]
Stock Position:  -0.0066418223794685784
Bond Position:  [5.87597256]


portfolio before change:  [5.18219311]
curr_Stock_Price:  104.5667821371257
curr_Factors:  [1.04566782e+02 3.68195096e-02]
mat_Sqrt:  [[ 2.00647034e+01  0.00000000e+00]
 [-7.67536419e-03  1.75864687e-02]]
grads:  [ 0.02163068 15.81931017]
Stock Position:  0.021630683102378794
Bond Position:  [2.92034219]


portfolio before change:  [5.15997014]
curr_Stock_Price:  103.52252288068733
curr_Factors:  [1.03522523e+02 3.91168332e-02]
mat_Sqrt:  [[ 2.04746596e+01  0.00000000e+00]
 [-7.91119037e-03  1.81268144e-02]]
grads:  [0.00564793 1.48980694]
Stock Position:  0.00564792690947513
Bond Position:  [4.5752825]


portfolio before change:  [5.169942]
curr_Stock_Price:  105.18683493962612
curr_Factors:  [1.05186835e+02 3.72540857e-02]
mat_Sqrt:  [[ 2.03024450e+01  0.00000000e+00]
 [-7.72052699e-03  1.76899497e-02]]
grads:  [ 0.02585935 -1.33753491]
Stock Position:  0.025859354990064257
Bond Position:  [2.44987829]


portfolio before change:  [5.19593718]
curr_Stock_Price:  106.18024426887105
curr_Factors:  [1.06180244e+02 3.67772473e-02]
mat_Sqrt:  [[ 2.03626047e+01  0.00000000e+00]
 [-7.67095794e-03  1.75763727e-02]]
grads:  [-0.02012872 -9.91904412]
Stock Position:  -0.02012872113240787
Bond Position:  [7.3332097]


portfolio before change:  [5.20118944]
curr_Stock_Price:  105.96485255747412
curr_Factors:  [1.05964853e+02 3.72548830e-02]
mat_Sqrt:  [[ 2.04528315e+01  0.00000000e+00]
 [-7.72060961e-03  1.76901390e-02]]
grads:  [ 2.01562133e-02 -3.04640631e+01]
Stock Position:  0.020156213275724828
Bond Position:  [3.06533928]


portfolio before change:  [5.2135177]
curr_Stock_Price:  106.55747693134485
curr_Factors:  [1.06557477e+02 3.68160867e-02]
mat_Sqrt:  [[ 2.04457356e+01  0.00000000e+00]
 [-7.67500740e-03  1.75856512e-02]]
grads:  [ 0.0024918 -1.0123555]
Stock Position:  0.0024918048121197814
Bond Position:  [4.94799726]


portfolio before change:  [5.21207994]
curr_Stock_Price:  105.73225318492355
curr_Factors:  [1.05732253e+02 3.73534674e-02]
mat_Sqrt:  [[ 2.04349203e+01  0.00000000e+00]
 [-7.73081806e-03  1.77135295e-02]]
grads:  [ -0.02494738 -12.6577549 ]
Stock Position:  -0.02494737947196741
Bond Position:  [7.84982258]


portfolio before change:  [5.17613397]
curr_Stock_Price:  107.21245896588397
curr_Factors:  [1.07212459e+02 3.66851295e-02]
mat_Sqrt:  [[ 2.05347909e+01  0.00000000e+00]
 [-7.66134500e-03  1.75543467e-02]]
grads:  [-3.79105102e-03  7.31922914e+00]
Stock Position:  -0.0037910510175356033
Bond Position:  [5.58258188]


portfolio before change:  [5.17042997]
curr_Stock_Price:  108.9011397629499
curr_Factors:  [1.08901140e+02 3.49873201e-02]
mat_Sqrt:  [[ 2.03698469e+01  0.00000000e+00]
 [-7.48195911e-03  1.71433220e-02]]
grads:  [ -0.09288161 -88.16592265]
Stock Position:  -0.0928816064755016
Bond Position:  [15.28534277]


portfolio before change:  [5.20609577]
curr_Stock_Price:  108.53771992041399
curr_Factors:  [1.08537720e+02 3.63391654e-02]
mat_Sqrt:  [[ 2.06903658e+01  0.00000000e+00]
 [-7.62513375e-03  1.74713763e-02]]
grads:  [-2.64153010e-02 -4.93649074e+01]
Stock Position:  -0.026415300989792546
Bond Position:  [8.07315231]


portfolio before change:  [5.20040463]
curr_Stock_Price:  108.79137396943095
curr_Factors:  [1.08791374e+02 3.74351583e-02]
mat_Sqrt:  [[ 2.10491372e+01  0.00000000e+00]
 [-7.73926698e-03  1.77328884e-02]]
grads:  [-1.16166239e-02 -1.64149478e+01]
Stock Position:  -0.011616623912086888
Bond Position:  [6.46419311]


portfolio before change:  [5.18865721]
curr_Stock_Price:  109.8721955615928
curr_Factors:  [1.09872196e+02 3.72235449e-02]
mat_Sqrt:  [[ 2.11980869e+01  0.00000000e+00]
 [-7.71736172e-03  1.76826971e-02]]
grads:  [-4.34780021e-04  2.59815546e+00]
Stock Position:  -0.0004347800214829817
Bond Position:  [5.23642744]


portfolio before change:  [5.18910012]
curr_Stock_Price:  110.35906633409287
curr_Factors:  [1.10359066e+02 3.70676656e-02]
mat_Sqrt:  [[ 2.12473923e+01  0.00000000e+00]
 [-7.70118595e-03  1.76456338e-02]]
grads:  [0.01021864 8.90859306]
Stock Position:  0.010218636439902081
Bond Position:  [4.06138094]


portfolio before change:  [5.18941962]
curr_Stock_Price:  110.34064856575779
curr_Factors:  [1.10340649e+02 3.67535437e-02]
mat_Sqrt:  [[ 2.11536416e+01  0.00000000e+00]
 [-7.66848550e-03  1.75707076e-02]]
grads:  [ -0.02631283 -18.67600116]
Stock Position:  -0.026312826672554485
Bond Position:  [8.09279398]


portfolio before change:  [5.19318984]
curr_Stock_Price:  110.23581166806878
curr_Factors:  [1.10235812e+02 3.59127194e-02]
mat_Sqrt:  [[ 2.08904046e+01  0.00000000e+00]
 [-7.58026062e-03  1.73685590e-02]]
grads:  [-0.00414304 -2.1362388 ]
Stock Position:  -0.004143041209967359
Bond Position:  [5.64990135]


portfolio before change:  [5.18947123]
curr_Stock_Price:  111.30384051129712
curr_Factors:  [1.11303841e+02 3.48706054e-02]
mat_Sqrt:  [[ 2.07845149e+01  0.00000000e+00]
 [-7.46946910e-03  1.71147038e-02]]
grads:  [1.23394830e-02 2.84624614e+01]
Stock Position:  0.01233948304569741
Bond Position:  [3.81603938]


portfolio before change:  [5.1823004]
curr_Stock_Price:  110.68405219433453
curr_Factors:  [1.10684052e+02 3.44734531e-02]
mat_Sqrt:  [[ 2.05507390e+01  0.00000000e+00]
 [-7.42681122e-03  1.70169623e-02]]
grads:  [7.24186553e-03 1.65412710e+01]
Stock Position:  0.007241865534226949
Bond Position:  [4.38074138]


portfolio before change:  [5.18317053]
curr_Stock_Price:  110.72858483051242
curr_Factors:  [1.10728585e+02 3.39881618e-02]
mat_Sqrt:  [[ 2.04137874e+01  0.00000000e+00]
 [-7.37435142e-03  1.68967618e-02]]
grads:  [-7.30660214e-03 -2.01612257e+01]
Stock Position:  -0.007306602139072648
Bond Position:  [5.99222024]


portfolio before change:  [5.19218667]
curr_Stock_Price:  109.59713277274619
curr_Factors:  [1.09597133e+02 3.43658040e-02]
mat_Sqrt:  [[ 2.03171341e+01  0.00000000e+00]
 [-7.41520643e-03  1.69903724e-02]]
grads:  [ 0.01450208 13.19433152]
Stock Position:  0.014502082935919217
Bond Position:  [3.60279996]


portfolio before change:  [5.20232104]
curr_Stock_Price:  110.26489816415366
curr_Factors:  [1.10264898e+02 3.22213269e-02]
mat_Sqrt:  [[ 1.97928800e+01  0.00000000e+00]
 [-7.18011998e-03  1.64517217e-02]]
grads:  [1.15041305e-02 1.48091252e+01]
Stock Position:  0.011504130485471446
Bond Position:  [3.93381926]


portfolio before change:  [5.19558918]
curr_Stock_Price:  109.63698338877352
curr_Factors:  [1.09636983e+02 3.18875758e-02]
mat_Sqrt:  [[ 1.95779777e+01  0.00000000e+00]
 [-7.14283706e-03  1.63662957e-02]]
grads:  [ 2.23256989e-02 -5.96007692e+01]
Stock Position:  0.0223256988901029
Bond Position:  [2.7478669]


portfolio before change:  [5.24025646]
curr_Stock_Price:  111.62230871171145
curr_Factors:  [1.11622309e+02 3.02231306e-02]
mat_Sqrt:  [[ 1.94053163e+01  0.00000000e+00]
 [-6.95392041e-03  1.59334333e-02]]
grads:  [-3.00675307e-02  8.57694381e+01]
Stock Position:  -0.03006753067727618
Bond Position:  [8.59646365]


portfolio before change:  [5.25971895]
curr_Stock_Price:  111.0107566764742
curr_Factors:  [1.11010757e+02 3.10572360e-02]
mat_Sqrt:  [[ 1.95634959e+01  0.00000000e+00]
 [-7.04922532e-03  1.61518043e-02]]
grads:  [ 0.00212514 -1.16793858]
Stock Position:  0.002125144831518447
Bond Position:  [5.02380501]


portfolio before change:  [5.26021338]
curr_Stock_Price:  110.94789894673532
curr_Factors:  [1.10947899e+02 3.17081266e-02]
mat_Sqrt:  [[ 1.97562437e+01  0.00000000e+00]
 [-7.12271034e-03  1.63201796e-02]]
grads:  [-0.00414755 -2.90986505]
Stock Position:  -0.004147554714540983
Bond Position:  [5.72037586]


portfolio before change:  [5.26532782]
curr_Stock_Price:  109.8871903888772
curr_Factors:  [1.09887190e+02 3.26171423e-02]
mat_Sqrt:  [[ 1.98458646e+01  0.00000000e+00]
 [-7.22408664e-03  1.65524619e-02]]
grads:  [ 4.52586426e-03 -5.51667088e+00]
Stock Position:  0.004525864255585532
Bond Position:  [4.76799331]


portfolio before change:  [5.26857914]
curr_Stock_Price:  110.47388180354719
curr_Factors:  [1.10473882e+02 3.35170308e-02]
mat_Sqrt:  [[ 2.02251795e+01  0.00000000e+00]
 [-7.32306284e-03  1.67792449e-02]]
grads:  [-6.98970718e-03 -7.54442500e+00]
Stock Position:  -0.006989707181199469
Bond Position:  [6.04075922]


portfolio before change:  [5.26941984]
curr_Stock_Price:  110.4616407815847
curr_Factors:  [1.10461641e+02 3.48016410e-02]
mat_Sqrt:  [[ 2.06068377e+01  0.00000000e+00]
 [-7.46207918e-03  1.70977713e-02]]
grads:  [ 0.01434468 -1.8543683 ]
Stock Position:  0.014344679994127947
Bond Position:  [3.68488295]


portfolio before change:  [5.25740772]
curr_Stock_Price:  109.5921361068252
curr_Factors:  [1.09592136e+02 3.62745357e-02]
mat_Sqrt:  [[ 2.08727813e+01  0.00000000e+00]
 [-7.61835002e-03  1.74558328e-02]]
grads:  [2.45029160e-02 2.45228557e+01]
Stock Position:  0.024502916017969476
Bond Position:  [2.57208081]


portfolio before change:  [5.22725264]
curr_Stock_Price:  108.3483409218076
curr_Factors:  [1.08348341e+02 3.59111321e-02]
mat_Sqrt:  [[ 2.05322628e+01  0.00000000e+00]
 [-7.58009309e-03  1.73681752e-02]]
grads:  [0.01255025 0.86945437]
Stock Position:  0.012550250308583765
Bond Position:  [3.86745384]


portfolio before change:  [5.23121498]
curr_Stock_Price:  108.62553700758693
curr_Factors:  [1.08625537e+02 3.34063284e-02]
mat_Sqrt:  [[ 1.98539219e+01  0.00000000e+00]
 [-7.31095927e-03  1.67515121e-02]]
grads:  [-1.27584861e-02 -1.45979366e+01]
Stock Position:  -0.012758486114081122
Bond Position:  [6.61711238]


portfolio before change:  [5.2417478]
curr_Stock_Price:  107.86481763301596
curr_Factors:  [1.07864818e+02 3.33037470e-02]
mat_Sqrt:  [[ 1.96845895e+01  0.00000000e+00]
 [-7.29972570e-03  1.67257728e-02]]
grads:  [ 0.00773267 -4.38204216]
Stock Position:  0.007732665750071254
Bond Position:  [4.40766522]


portfolio before change:  [5.23778287]
curr_Stock_Price:  107.28081240336567
curr_Factors:  [1.07280812e+02 3.32663984e-02]
mat_Sqrt:  [[ 1.95670316e+01  0.00000000e+00]
 [-7.29563139e-03  1.67163915e-02]]
grads:  [-7.30904414e-03  1.03068031e+01]
Stock Position:  -0.007309044136133845
Bond Position:  [6.02190307]


portfolio before change:  [5.2339151]
curr_Stock_Price:  107.91298292392254
curr_Factors:  [1.07912983e+02 3.24185715e-02]
mat_Sqrt:  [[ 1.94299031e+01  0.00000000e+00]
 [-7.20206321e-03  1.65019999e-02]]
grads:  [-3.17168712e-03  7.46599921e+00]
Stock Position:  -0.00317168712370439
Bond Position:  [5.57618131]


portfolio before change:  [5.2319025]
curr_Stock_Price:  108.76731131542935
curr_Factors:  [1.08767311e+02 3.34111935e-02]
mat_Sqrt:  [[ 1.98812821e+01  0.00000000e+00]
 [-7.31149161e-03  1.67527319e-02]]
grads:  [-9.68436380e-03  9.88940042e+00]
Stock Position:  -0.009684363796055764
Bond Position:  [6.28524471]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.247936]
Stock Price:  107.19283600372731
PL:  [-1.94490001]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.31078724e-01  8.12106232e-01]
 [-2.47163413e-01 -6.44565898e-02]
 [ 9.02617131e-01 -7.91651350e-01]
 [-1.46701178e-01  3.30790622e-02]
 [-1.31330312e-01  5.59196210e-02]
 [ 1.16280416e-01  1.22696880e-01]
 [ 1.19153394e-01 -4.32241136e-03]
 [ 3.40169769e-01 -7.24070742e-03]
 [-8.59152743e-02  1.84193764e-02]
 [ 4.10285624e-01 -2.39895390e-01]
 [ 6.56199399e-02  6.03307614e-03]
 [-1.41542922e-01 -1.66390016e-01]
 [-1.14545688e-01  1.39946567e-01]
 [-4.52759977e-01 -5.87282931e-01]
 [ 7.70340549e-02  2.22936907e-01]
 [ 5.51351343e-02 -2.11275255e-02]
 [-5.23173971e-02  2.33938394e-01]
 [-9.44983417e-02  8.24429183e-03]
 [ 1.52768023e-02  5.64807445e-02]
 [ 4.43999818e-02 -9.62717769e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 4.76986752e-02  2.49358774e-01]
 [ 3.48765473e-02  2.16903349e-01]
 [-5.76134632e-02  1.25150998e-01]
 [ 1.58488996e-02  3.81260473e-02]
 [ 3.47180442e-01 -3.87793088e-02]
 [ 4.08632813e-04  2.16551292e-01]
 [-1.79613886e-01  1.29899739e-01]
 [-2.00962258e-01 -3.63457533e-02]
 [ 1.80400407e-01 -8.84853736e-02]
 [-1.04373768e+00 -1.17912547e-01]
 [-6.65392315e-02  1.38383855e-01]
 [-8.93841975e-03 -1.21318883e-01]
 [ 3.57564299e-02  8.01036039e-02]
 [-4.13576283e-02  1.65727658e-01]
 [-1.50534110e+00 -1.09914584e-01]
 [-7.12532705e-02  2.39595676e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.81753898e-01 -3.65331226e-04]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.58521409]
curr_Stock_Price:  101.4876991457065
curr_Factors:  [1.01487699e+02 3.96132692e-02]
mat_Sqrt:  [[ 2.01991805e+01  0.00000000e+00]
 [-7.96123299e-03  1.82414764e-02]]
grads:  [3.88882580e-02 4.45197644e+01]
Stock Position:  0.038888258016283
Bond Position:  [8.63853426]


portfolio before change:  [12.61055452]
curr_Stock_Price:  102.11155188869918
curr_Factors:  [1.02111552e+02 3.83126165e-02]
mat_Sqrt:  [[ 1.99869158e+01  0.00000000e+00]
 [-7.82944355e-03  1.79395089e-02]]
grads:  [-0.01377374 -3.59299635]
Stock Position:  -0.013773739684950957
Bond Position:  [14.01701246]


portfolio before change:  [12.59919018]
curr_Stock_Price:  103.06384076874421
curr_Factors:  [1.03063841e+02 4.01182438e-02]
mat_Sqrt:  [[ 2.06432123e+01  0.00000000e+00]
 [-8.01181565e-03  1.83573758e-02]]
grads:  [ 2.69876678e-02 -4.31244289e+01]
Stock Position:  0.02698766779438341
Bond Position:  [9.81773748]


portfolio before change:  [12.62052342]
curr_Stock_Price:  103.80884573914142
curr_Factors:  [1.03808846e+02 3.94415343e-02]
mat_Sqrt:  [[ 2.06163255e+01  0.00000000e+00]
 [-7.94395713e-03  1.82018924e-02]]
grads:  [-0.00641551  1.81734192]
Stock Position:  -0.006415512373328373
Bond Position:  [13.28651035]


portfolio before change:  [12.63440437]
curr_Stock_Price:  101.90408280563058
curr_Factors:  [1.01904083e+02 3.87134331e-02]
mat_Sqrt:  [[ 2.00503717e+01  0.00000000e+00]
 [-7.87029180e-03  1.80331040e-02]]
grads:  [-0.00533282  3.10094264]
Stock Position:  -0.005332818285982169
Bond Position:  [13.17784032]


portfolio before change:  [12.63090177]
curr_Stock_Price:  102.86978710637338
curr_Factors:  [1.02869787e+02 3.83945467e-02]
mat_Sqrt:  [[ 2.01568476e+01  0.00000000e+00]
 [-7.83781058e-03  1.79586801e-02]]
grads:  [0.00842541 6.83217695]
Stock Position:  0.008425410949098863
Bond Position:  [11.76418154]


portfolio before change:  [12.63887203]
curr_Stock_Price:  103.64122042063723
curr_Factors:  [1.03641220e+02 3.70603536e-02]
mat_Sqrt:  [[ 1.99520396e+01  0.00000000e+00]
 [-7.70042633e-03  1.76438933e-02]]
grads:  [ 0.00587744 -0.24498059]
Stock Position:  0.0058774411707200915
Bond Position:  [12.02972685]


portfolio before change:  [12.63566604]
curr_Stock_Price:  102.83988581080911
curr_Factors:  [1.02839886e+02 3.70807857e-02]
mat_Sqrt:  [[ 1.98032308e+01  0.00000000e+00]
 [-7.70254874e-03  1.76487563e-02]]
grads:  [ 0.01701791 -0.41026729]
Stock Position:  0.017017913306978227
Bond Position:  [10.88554578]


portfolio before change:  [12.65901479]
curr_Stock_Price:  104.1319343786429
curr_Factors:  [1.04131934e+02 3.54313983e-02]
mat_Sqrt:  [[ 1.96009934e+01  0.00000000e+00]
 [-7.52929195e-03  1.72517751e-02]]
grads:  [-0.00397308  1.06768007]
Stock Position:  -0.003973084319764111
Bond Position:  [13.07273975]


portfolio before change:  [12.66661666]
curr_Stock_Price:  102.62990817003478
curr_Factors:  [1.02629908e+02 3.61658062e-02]
mat_Sqrt:  [[ 1.95174473e+01  0.00000000e+00]
 [-7.60692382e-03  1.74296521e-02]]
grads:  [  0.0156571  -13.76363619]
Stock Position:  0.01565710347388523
Bond Position:  [11.05972957]


portfolio before change:  [12.65111385]
curr_Stock_Price:  101.55146047635148
curr_Factors:  [1.01551460e+02 3.80687183e-02]
mat_Sqrt:  [[ 1.98139153e+01  0.00000000e+00]
 [-7.80448264e-03  1.78823162e-02]]
grads:  [0.0034447  0.33737666]
Stock Position:  0.003444699815166881
Bond Position:  [12.30129955]


portfolio before change:  [12.65321525]
curr_Stock_Price:  101.7150867398228
curr_Factors:  [1.01715087e+02 3.74128726e-02]
mat_Sqrt:  [[ 1.96741465e+01  0.00000000e+00]
 [-7.73696298e-03  1.77276092e-02]]
grads:  [-0.01088543 -9.38592529]
Stock Position:  -0.010885426653128123
Bond Position:  [13.76042737]


portfolio before change:  [12.66161028]
curr_Stock_Price:  101.10189346206785
curr_Factors:  [1.01101893e+02 3.74406500e-02]
mat_Sqrt:  [[ 1.95627984e+01  0.00000000e+00]
 [-7.73983463e-03  1.77341890e-02]]
grads:  [-2.73314673e-03  7.89134295e+00]
Stock Position:  -0.0027331467276302777
Bond Position:  [12.93793659]


portfolio before change:  [12.66354128]
curr_Stock_Price:  100.98713235901786
curr_Factors:  [1.00987132e+02 3.68438267e-02]
mat_Sqrt:  [[ 1.93842234e+01  0.00000000e+00]
 [-7.67789832e-03  1.75922751e-02]]
grads:  [ -0.03657981 -33.38300062]
Stock Position:  -0.03657981277723354
Bond Position:  [16.35763168]


portfolio before change:  [12.67845351]
curr_Stock_Price:  100.6353702484438
curr_Factors:  [1.00635370e+02 3.69471509e-02]
mat_Sqrt:  [[ 1.93437703e+01  0.00000000e+00]
 [-7.68865668e-03  1.76169256e-02]]
grads:  [9.01229157e-03 1.26546999e+01]
Stock Position:  0.009012291570358832
Bond Position:  [11.77149821]


portfolio before change:  [12.69046013]
curr_Stock_Price:  101.8043391417745
curr_Factors:  [1.01804339e+02 3.77130153e-02]
mat_Sqrt:  [[ 1.97702389e+01  0.00000000e+00]
 [-7.76793567e-03  1.77985766e-02]]
grads:  [ 0.0023224  -1.18703456]
Stock Position:  0.0023223961214718274
Bond Position:  [12.45403012]


portfolio before change:  [12.68937765]
curr_Stock_Price:  100.66787108589992
curr_Factors:  [1.00667871e+02 3.66627388e-02]
mat_Sqrt:  [[ 1.92753972e+01  0.00000000e+00]
 [-7.65900660e-03  1.75489887e-02]]
grads:  [2.58265435e-03 1.33305912e+01]
Stock Position:  0.002582654353343346
Bond Position:  [12.42938733]


portfolio before change:  [12.68865212]
curr_Stock_Price:  99.78532936141464
curr_Factors:  [9.97853294e+01 3.57037556e-02]
mat_Sqrt:  [[ 1.88548745e+01  0.00000000e+00]
 [-7.55817498e-03  1.73179545e-02]]
grads:  [-0.00482105  0.4760546 ]
Stock Position:  -0.004821047088455104
Bond Position:  [13.16972189]


portfolio before change:  [12.69254653]
curr_Stock_Price:  99.31902200354962
curr_Factors:  [9.93190220e+01 3.51245206e-02]
mat_Sqrt:  [[ 1.86139112e+01  0.00000000e+00]
 [-7.49661476e-03  1.71769023e-02]]
grads:  [2.14500971e-03 3.28817987e+00]
Stock Position:  0.0021450097050495476
Bond Position:  [12.47950626]


portfolio before change:  [12.69332075]
curr_Stock_Price:  98.95267779724118
curr_Factors:  [9.89526778e+01 3.48867979e-02]
mat_Sqrt:  [[ 1.84823890e+01  0.00000000e+00]
 [-7.47120316e-03  1.71186770e-02]]
grads:  [ 1.28962425e-04 -5.62378605e+00]
Stock Position:  0.0001289624250633982
Bond Position:  [12.68055957]


portfolio before change:  [12.69477309]
curr_Stock_Price:  97.92267283971239
curr_Factors:  [9.79226728e+01 3.52881469e-02]
mat_Sqrt:  [[ 1.83949108e+01  0.00000000e+00]
 [-7.51405583e-03  1.72168648e-02]]
grads:  [ 0.00229023 -2.19424327]
Stock Position:  0.002290231856193273
Bond Position:  [12.47050746]


portfolio before change:  [12.69583314]
curr_Stock_Price:  97.7048533715213
curr_Factors:  [9.77048534e+01 3.51436629e-02]
mat_Sqrt:  [[ 1.83163802e+01  0.00000000e+00]
 [-7.49865725e-03  1.71815822e-02]]
grads:  [8.54578059e-03 1.45131438e+01]
Stock Position:  0.008545780589832326
Bond Position:  [11.8608689]


portfolio before change:  [12.69519368]
curr_Stock_Price:  97.45652480726879
curr_Factors:  [9.74565248e+01 3.66316052e-02]
mat_Sqrt:  [[ 1.86525793e+01  0.00000000e+00]
 [-7.65575394e-03  1.75415360e-02]]
grads:  [6.94493385e-03 1.23651287e+01]
Stock Position:  0.006944933854817767
Bond Position:  [12.01836456]


portfolio before change:  [12.70546859]
curr_Stock_Price:  98.71967842060576
curr_Factors:  [9.87196784e+01 3.59364029e-02]
mat_Sqrt:  [[ 1.87141900e+01  0.00000000e+00]
 [-7.58275970e-03  1.73742852e-02]]
grads:  [-1.59936908e-04  7.20323149e+00]
Stock Position:  -0.00015993690826461324
Bond Position:  [12.72125751]


portfolio before change:  [12.70693956]
curr_Stock_Price:  99.46551516339703
curr_Factors:  [9.94655152e+01 3.63124593e-02]
mat_Sqrt:  [[ 1.89539778e+01  0.00000000e+00]
 [-7.62233133e-03  1.74649551e-02]]
grads:  [1.71407137e-03 2.18300287e+00]
Stock Position:  0.0017140713727268298
Bond Position:  [12.53644857]


portfolio before change:  [12.70634913]
curr_Stock_Price:  98.20676595475962
curr_Factors:  [9.82067660e+01 3.52501068e-02]
mat_Sqrt:  [[ 1.84383319e+01  0.00000000e+00]
 [-7.51000472e-03  1.72075825e-02]]
grads:  [ 0.01791137 -2.25361748]
Stock Position:  0.01791136888785986
Bond Position:  [10.94733151]


portfolio before change:  [12.70281575]
curr_Stock_Price:  97.93309199851481
curr_Factors:  [9.79330920e+01 3.59443694e-02]
mat_Sqrt:  [[ 1.85671353e+01  0.00000000e+00]
 [-7.58360014e-03  1.73762108e-02]]
grads:  [5.11222457e-03 1.24625152e+01]
Stock Position:  0.005112224565190784
Bond Position:  [12.20215979]


portfolio before change:  [12.69988595]
curr_Stock_Price:  97.06161903599629
curr_Factors:  [9.70616190e+01 3.73010409e-02]
mat_Sqrt:  [[ 1.87459738e+01  0.00000000e+00]
 [-7.72539095e-03  1.77010944e-02]]
grads:  [-6.55719425e-03  7.33851453e+00]
Stock Position:  -0.006557194247369825
Bond Position:  [13.33633784]


portfolio before change:  [12.70629414]
curr_Stock_Price:  96.33858951445328
curr_Factors:  [9.63385895e+01 3.81937835e-02]
mat_Sqrt:  [[ 1.88276720e+01  0.00000000e+00]
 [-7.81729196e-03  1.79116661e-02]]
grads:  [-0.01151629 -2.02916653]
Stock Position:  -0.011516285464680462
Bond Position:  [13.81575684]


portfolio before change:  [12.71979903]
curr_Stock_Price:  95.31588090280887
curr_Factors:  [9.53158809e+01 3.97573260e-02]
mat_Sqrt:  [[ 1.90052615e+01  0.00000000e+00]
 [-7.97569568e-03  1.82746146e-02]]
grads:  [ 0.00746016 -4.84198302]
Stock Position:  0.007460156461221798
Bond Position:  [12.00872764]


portfolio before change:  [12.72758034]
curr_Stock_Price:  96.1577034699915
curr_Factors:  [9.61577035e+01 3.97384678e-02]
mat_Sqrt:  [[ 1.91685668e+01  0.00000000e+00]
 [-7.97380389e-03  1.82702800e-02]]
grads:  [-0.05713515 -6.45378985]
Stock Position:  -0.05713514973876477
Bond Position:  [18.22156513]


portfolio before change:  [12.75172323]
curr_Stock_Price:  95.77501339240654
curr_Factors:  [9.57750134e+01 3.97781897e-02]
mat_Sqrt:  [[ 1.91018191e+01  0.00000000e+00]
 [-7.97778814e-03  1.82794090e-02]]
grads:  [-3.21622021e-04  7.57047753e+00]
Stock Position:  -0.0003216220210994915
Bond Position:  [12.78252659]


portfolio before change:  [12.75335411]
curr_Stock_Price:  95.67251103001963
curr_Factors:  [9.56725110e+01 4.00845558e-02]
mat_Sqrt:  [[ 1.91547157e+01  0.00000000e+00]
 [-8.00845112e-03  1.83496667e-02]]
grads:  [-3.23086608e-03 -6.61150336e+00]
Stock Position:  -0.003230866080914187
Bond Position:  [13.06245919]


portfolio before change:  [12.75690562]
curr_Stock_Price:  95.07867755026862
curr_Factors:  [9.50786776e+01 4.09671097e-02]
mat_Sqrt:  [[ 1.92442414e+01  0.00000000e+00]
 [-8.09613337e-03  1.85505720e-02]]
grads:  [3.67468415e-03 4.31812043e+00]
Stock Position:  0.003674684152870435
Bond Position:  [12.40752151]


portfolio before change:  [12.75466383]
curr_Stock_Price:  94.04652811472761
curr_Factors:  [9.40465281e+01 4.15502506e-02]
mat_Sqrt:  [[ 1.91703301e+01  0.00000000e+00]
 [-8.15355143e-03  1.86821333e-02]]
grads:  [1.61561388e-03 8.87091719e+00]
Stock Position:  0.0016156138762073512
Bond Position:  [12.60272096]


portfolio before change:  [12.75703826]
curr_Stock_Price:  94.54106961104723
curr_Factors:  [9.45410696e+01 3.99101851e-02]
mat_Sqrt:  [[ 1.88869740e+01  0.00000000e+00]
 [-7.99101346e-03  1.83097120e-02]]
grads:  [-0.08224249 -6.00307554]
Stock Position:  -0.08224248917434245
Bond Position:  [20.53233116]


portfolio before change:  [12.75526206]
curr_Stock_Price:  94.59387564037235
curr_Factors:  [9.45938756e+01 4.00530480e-02]
mat_Sqrt:  [[ 1.89313160e+01  0.00000000e+00]
 [-8.00530304e-03  1.83424536e-02]]
grads:  [1.75977494e-03 1.30623570e+01]
Stock Position:  0.0017597749371724208
Bond Position:  [12.58879813]


portfolio before change:  [12.75540226]
curr_Stock_Price:  93.77928191276384
curr_Factors:  [9.37792819e+01 4.15158888e-02]
mat_Sqrt:  [[ 1.91079490e+01  0.00000000e+00]
 [-8.15017927e-03  1.86744067e-02]]
grads:  [-4.61510628e-03  5.85623769e+00]
Stock Position:  -0.004615106280951864
Bond Position:  [13.18820361]


portfolio before change:  [12.74496415]
curr_Stock_Price:  96.39823423074519
curr_Factors:  [9.63982342e+01 4.11214849e-02]
mat_Sqrt:  [[ 1.95480514e+01  0.00000000e+00]
 [-8.11137324e-03  1.85854909e-02]]
grads:  [ 0.04509884 -0.0196568 ]
Stock Position:  0.0450988405130014
Bond Position:  [8.39751555]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.72780457]
Stock Price:  95.99446940114903
PL:  [12.72780457]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-7.31803966e-02  1.69692440e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.35862521e-01 -7.35790174e-01]
 [-3.96079308e-02  1.10475127e-01]
 [-1.13564975e-01  4.88097578e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-7.14177580e-02  1.65041200e-01]
 [-7.26588577e-02 -7.75895418e-02]
 [ 1.61063419e-01  7.66622327e-02]
 [ 1.62002286e-01  4.35492173e-03]
 [ 1.17520877e-01  1.89455579e-01]
 [-2.70805453e-02  1.15105342e-01]
 [-1.55548290e-01  1.53662863e-01]
 [-5.08832670e-01 -6.53131443e-01]
 [ 7.54204377e-02  2.18905392e-01]
 [ 5.16210182e-02 -1.88884971e-02]
 [-3.38967292e-02  4.66263424e-02]
 [-2.13437432e-02  3.85498171e-02]
 [ 1.52786153e-02  5.64357289e-02]
 [ 2.97336960e-02 -9.55691326e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 9.52965216e-02  2.90437379e-01]
 [ 3.54269857e-02  2.48628684e-01]
 [-4.35325338e-02  1.34908429e-01]
 [ 2.19880770e-02  5.08003229e-02]
 [ 7.24233158e-01 -3.44440662e-01]
 [-1.79414259e-01  2.43792005e-01]
 [ 1.08981316e-01  1.07276204e-02]
 [ 3.92525679e-02 -1.41502736e-01]
 [-3.39150858e-02 -3.84157739e-02]
 [-5.63674894e-01 -9.89928263e-02]
 [-1.17918695e-01 -6.46351179e-04]
 [ 1.63155406e-01  1.58999581e-01]
 [ 2.27506194e-01  2.72026739e-02]
 [-2.23351357e-01 -2.23666025e-01]
 [ 1.02005514e-01 -3.28103946e-01]
 [-1.63416102e-01  2.13419144e-01]
 [-1.20409043e-01  1.19822132e-01]
 [-5.25582360e-02  1.13146634e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.03492682]
curr_Stock_Price:  99.58690166207548
curr_Factors:  [9.95869017e+01 4.02260938e-02]
mat_Sqrt:  [[ 1.99735910e+01  0.00000000e+00]
 [-8.02257752e-03  1.83820344e-02]]
grads:  [4.40309402e-05 9.23142873e+00]
Stock Position:  4.4030940204308875e-05
Bond Position:  [-0.03931173]


portfolio before change:  [-0.03491856]
curr_Stock_Price:  99.88616689437089
curr_Factors:  [9.98861669e+01 3.99320846e-02]
mat_Sqrt:  [[ 1.99602666e+01  0.00000000e+00]
 [-7.99320557e-03  1.83147348e-02]]
grads:  [-0.01016943 -4.8054952 ]
Stock Position:  -0.01016942567258561
Bond Position:  [0.98086639]


portfolio before change:  [-0.02555839]
curr_Stock_Price:  98.97780188455181
curr_Factors:  [9.89778019e+01 4.03723855e-02]
mat_Sqrt:  [[ 1.98874917e+01  0.00000000e+00]
 [-8.03715228e-03  1.84154294e-02]]
grads:  [ 2.58824678e-02 -3.99550920e+01]
Stock Position:  0.02588246778861947
Bond Position:  [-2.58734816]


portfolio before change:  [-0.03201383]
curr_Stock_Price:  98.74088481186853
curr_Factors:  [9.87408848e+01 4.10186039e-02]
mat_Sqrt:  [[ 1.99980409e+01  0.00000000e+00]
 [-8.10122005e-03  1.85622270e-02]]
grads:  [4.30410533e-04 5.95160951e+00]
Stock Position:  0.00043041053338770005
Bond Position:  [-0.07451295]


portfolio before change:  [-0.03090991]
curr_Stock_Price:  101.32733652312763
curr_Factors:  [1.01327337e+02 4.19142450e-02]
mat_Sqrt:  [[ 2.07447139e+01  0.00000000e+00]
 [-8.18918750e-03  1.87637858e-02]]
grads:  [-0.00444753  2.60127452]
Stock Position:  -0.0044475257796538145
Bond Position:  [0.41974603]


portfolio before change:  [-0.02544537]
curr_Stock_Price:  100.11046389451188
curr_Factors:  [1.00110464e+02 4.29635579e-02]
mat_Sqrt:  [[ 2.07505491e+01  0.00000000e+00]
 [-8.29106101e-03  1.89972073e-02]]
grads:  [-0.00570687 -3.49087773]
Stock Position:  -0.0057068741207560395
Bond Position:  [0.54587245]


portfolio before change:  [-0.01426232]
curr_Stock_Price:  98.16284618312224
curr_Factors:  [9.81628462e+01 4.45085700e-02]
mat_Sqrt:  [[ 2.07094690e+01  0.00000000e+00]
 [-8.43882172e-03  1.93357697e-02]]
grads:  [2.95578283e-05 8.53553818e+00]
Stock Position:  2.9557828299481082e-05
Bond Position:  [-0.0171638]


portfolio before change:  [-0.0142426]
curr_Stock_Price:  98.90253213265913
curr_Factors:  [9.89025321e+01 4.36518139e-02]
mat_Sqrt:  [[ 2.06637224e+01  0.00000000e+00]
 [-8.35720660e-03  1.91487659e-02]]
grads:  [-0.00515501 -4.05193432]
Stock Position:  -0.005155010703402336
Bond Position:  [0.49560101]


portfolio before change:  [-0.01591978]
curr_Stock_Price:  99.23989943638823
curr_Factors:  [9.92398994e+01 4.33252347e-02]
mat_Sqrt:  [[ 2.06565019e+01  0.00000000e+00]
 [-8.32588587e-03  1.90770011e-02]]
grads:  [0.00941697 4.01856834]
Stock Position:  0.009416965216075395
Bond Position:  [-0.95045846]


portfolio before change:  [-0.02266365]
curr_Stock_Price:  98.53637551243392
curr_Factors:  [9.85363755e+01 4.49061192e-02]
mat_Sqrt:  [[ 2.08809064e+01  0.00000000e+00]
 [-8.47642559e-03  1.94219309e-02]]
grads:  [0.00784942 0.22422702]
Stock Position:  0.007849416419379295
Bond Position:  [-0.7961167]


portfolio before change:  [-0.02129359]
curr_Stock_Price:  98.72359759112916
curr_Factors:  [9.87235976e+01 4.51243543e-02]
mat_Sqrt:  [[ 2.09713541e+01  0.00000000e+00]
 [-8.49699752e-03  1.94690672e-02]]
grads:  [9.54664487e-03 9.73110715e+00]
Stock Position:  0.009546644872231407
Bond Position:  [-0.96377272]


portfolio before change:  [-0.01630413]
curr_Stock_Price:  99.25885822390119
curr_Factors:  [9.92588582e+01 4.44414037e-02]
mat_Sqrt:  [[ 2.09248888e+01  0.00000000e+00]
 [-8.43245195e-03  1.93211747e-02]]
grads:  [1.10660298e-03 5.95747121e+00]
Stock Position:  0.0011066029843228064
Bond Position:  [-0.12614427]


portfolio before change:  [-0.01376518]
curr_Stock_Price:  101.56747110733333
curr_Factors:  [1.01567471e+02 4.42665316e-02]
mat_Sqrt:  [[ 2.13694029e+01  0.00000000e+00]
 [-8.41584521e-03  1.92831238e-02]]
grads:  [-4.14070147e-03  7.96877437e+00]
Stock Position:  -0.0041407014716924664
Bond Position:  [0.4067954]


portfolio before change:  [-0.01415991]
curr_Stock_Price:  101.67508192934712
curr_Factors:  [1.01675082e+02 4.58314293e-02]
mat_Sqrt:  [[ 2.17668824e+01  0.00000000e+00]
 [-8.56331051e-03  1.96210093e-02]]
grads:  [ -0.03647204 -33.28735197]
Stock Position:  -0.03647203971714999
Bond Position:  [3.69413772]


portfolio before change:  [0.01611611]
curr_Stock_Price:  100.85762784129393
curr_Factors:  [1.00857628e+02 4.64864543e-02]
mat_Sqrt:  [[ 2.17456283e+01  0.00000000e+00]
 [-8.62428704e-03  1.97607241e-02]]
grads:  [7.86174493e-03 1.10778021e+01]
Stock Position:  0.007861744933477443
Bond Position:  [-0.77680084]


portfolio before change:  [-0.00564258]
curr_Stock_Price:  98.10231315918668
curr_Factors:  [9.81023132e+01 4.69305531e-02]
mat_Sqrt:  [[ 2.12523561e+01  0.00000000e+00]
 [-8.66538429e-03  1.98548897e-02]]
grads:  [ 0.00204106 -0.95132722]
Stock Position:  0.0020410632131984676
Bond Position:  [-0.2058756]


portfolio before change:  [-0.00463355]
curr_Stock_Price:  98.60929043001292
curr_Factors:  [9.86092904e+01 4.79825662e-02]
mat_Sqrt:  [[ 2.16002894e+01  0.00000000e+00]
 [-8.76196929e-03  2.00761938e-02]]
grads:  [-6.27182575e-04  2.32246923e+00]
Stock Position:  -0.0006271825749900032
Bond Position:  [0.05721248]


portfolio before change:  [-0.00478404]
curr_Stock_Price:  98.86065225504508
curr_Factors:  [9.88606523e+01 4.73523707e-02]
mat_Sqrt:  [[ 2.15126710e+01  0.00000000e+00]
 [-8.70423995e-03  1.99439192e-02]]
grads:  [-2.10072647e-04  1.93291081e+00]
Stock Position:  -0.0002100726468140744
Bond Position:  [0.01598388]


portfolio before change:  [-0.00485348]
curr_Stock_Price:  99.20071312802506
curr_Factors:  [9.92007131e+01 4.78277667e-02]
mat_Sqrt:  [[ 2.16947598e+01  0.00000000e+00]
 [-8.74782412e-03  2.00437831e-02]]
grads:  [1.83957726e-03 2.81562261e+00]
Stock Position:  0.0018395772555413008
Bond Position:  [-0.18734086]


portfolio before change:  [-0.00501901]
curr_Stock_Price:  99.1234637251933
curr_Factors:  [9.91234637e+01 4.78504267e-02]
mat_Sqrt:  [[ 2.16830004e+01  0.00000000e+00]
 [-8.74989616e-03  2.00485307e-02]]
grads:  [-5.52326375e-04 -4.76688960e+00]
Stock Position:  -0.0005523263748254806
Bond Position:  [0.0497295]


portfolio before change:  [-0.00490591]
curr_Stock_Price:  98.92995146571435
curr_Factors:  [9.89299515e+01 4.85123739e-02]
mat_Sqrt:  [[ 2.17898409e+01  0.00000000e+00]
 [-8.81020988e-03  2.01867268e-02]]
grads:  [ 0.00193341 -1.8714272 ]
Stock Position:  0.001933406067813131
Bond Position:  [-0.19617768]


portfolio before change:  [-0.00599066]
curr_Stock_Price:  98.38158120425804
curr_Factors:  [9.83815812e+01 5.02347721e-02]
mat_Sqrt:  [[ 2.20503769e+01  0.00000000e+00]
 [-8.96524597e-03  2.05419591e-02]]
grads:  [1.00702944e-02 1.41387380e+01]
Stock Position:  0.01007029435665823
Bond Position:  [-0.99672214]


portfolio before change:  [-0.00924562]
curr_Stock_Price:  98.07072982246918
curr_Factors:  [9.80707298e+01 4.81954820e-02]
mat_Sqrt:  [[ 2.15299277e+01  0.00000000e+00]
 [-8.78138777e-03  2.01206871e-02]]
grads:  [6.68545857e-03 1.23568685e+01]
Stock Position:  0.006685458568844163
Bond Position:  [-0.66489342]


portfolio before change:  [-0.00036235]
curr_Stock_Price:  99.41190715125106
curr_Factors:  [9.94119072e+01 4.78283992e-02]
mat_Sqrt:  [[ 2.17410907e+01  0.00000000e+00]
 [-8.74788196e-03  2.00439156e-02]]
grads:  [7.05867602e-04 6.73064241e+00]
Stock Position:  0.0007058676017926405
Bond Position:  [-0.07053399]


portfolio before change:  [9.20608222e-05]
curr_Stock_Price:  100.06816093434456
curr_Factors:  [1.00068161e+02 4.71975279e-02]
mat_Sqrt:  [[ 2.17398000e+01  0.00000000e+00]
 [-8.68999681e-03  1.99112841e-02]]
grads:  [2.03125860e-03 2.55133334e+00]
Stock Position:  0.0020312585959734245
Bond Position:  [-0.20317225]


portfolio before change:  [0.00447234]
curr_Stock_Price:  102.23709954797171
curr_Factors:  [1.02237100e+02 4.62656154e-02]
mat_Sqrt:  [[ 2.19906310e+01  0.00000000e+00]
 [-8.60377734e-03  1.97137305e-02]]
grads:  [  0.02609779 -17.47211989]
Stock Position:  0.02609779264399089
Bond Position:  [-2.66369029]


portfolio before change:  [0.01031805]
curr_Stock_Price:  102.47385132559847
curr_Factors:  [1.02473851e+02 4.39023479e-02]
mat_Sqrt:  [[ 2.14712304e+01  0.00000000e+00]
 [-8.38115485e-03  1.92036383e-02]]
grads:  [-3.40058319e-03  1.26950946e+01]
Stock Position:  -0.0034005831941710018
Bond Position:  [0.35878891]


portfolio before change:  [0.00871799]
curr_Stock_Price:  102.95756585379156
curr_Factors:  [1.02957566e+02 4.42174820e-02]
mat_Sqrt:  [[ 2.16498689e+01  0.00000000e+00]
 [-8.41118132e-03  1.92724376e-02]]
grads:  [0.00525007 0.55663018]
Stock Position:  0.00525006566685429
Bond Position:  [-0.53181599]


portfolio before change:  [0.00317895]
curr_Stock_Price:  101.91518524201568
curr_Factors:  [1.01915185e+02 4.45118779e-02]
mat_Sqrt:  [[ 2.15019009e+01  0.00000000e+00]
 [-8.43913530e-03  1.93364882e-02]]
grads:  [-1.04661858e-03 -7.31791289e+00]
Stock Position:  -0.0010466185831312555
Bond Position:  [0.10984527]


portfolio before change:  [0.00407544]
curr_Stock_Price:  101.071745468028
curr_Factors:  [1.01071745e+02 4.51743247e-02]
mat_Sqrt:  [[ 2.14820439e+01  0.00000000e+00]
 [-8.50170098e-03  1.94798441e-02]]
grads:  [-0.00235923 -1.97207809]
Stock Position:  -0.0023592310029100596
Bond Position:  [0.24252703]


portfolio before change:  [0.00428329]
curr_Stock_Price:  100.99649255463817
curr_Factors:  [1.00996493e+02 4.65634259e-02]
mat_Sqrt:  [[ 2.17935889e+01  0.00000000e+00]
 [-8.63142407e-03  1.97770771e-02]]
grads:  [-0.02784667 -5.0054326 ]
Stock Position:  -0.027846671208647356
Bond Position:  [2.81669942]


portfolio before change:  [-0.04988009]
curr_Stock_Price:  102.9541950658236
curr_Factors:  [1.02954195e+02 4.48494582e-02]
mat_Sqrt:  [[ 2.18033210e+01  0.00000000e+00]
 [-8.47107626e-03  1.94096741e-02]]
grads:  [-0.00542123 -0.03330047]
Stock Position:  -0.005421228548411583
Bond Position:  [0.50825813]


portfolio before change:  [-0.05238161]
curr_Stock_Price:  103.42734540596405
curr_Factors:  [1.03427345e+02 4.48109040e-02]
mat_Sqrt:  [[ 2.18941067e+01  0.00000000e+00]
 [-8.46743446e-03  1.94013297e-02]]
grads:  [0.01062151 8.19529297]
Stock Position:  0.01062151175741424
Bond Position:  [-1.15093638]


portfolio before change:  [-0.02958438]
curr_Stock_Price:  105.58721819843062
curr_Factors:  [1.05587218e+02 4.52908287e-02]
mat_Sqrt:  [[ 2.24706938e+01  0.00000000e+00]
 [-8.51265681e-03  1.95049471e-02]]
grads:  [0.01065292 1.3946551 ]
Stock Position:  0.01065291602741848
Bond Position:  [-1.15439614]


portfolio before change:  [-0.04292806]
curr_Stock_Price:  104.34817987940369
curr_Factors:  [1.04348180e+02 4.45653798e-02]
mat_Sqrt:  [[ 2.20284370e+01  0.00000000e+00]
 [-8.44420557e-03  1.93481056e-02]]
grads:  [ -0.01457058 -11.56009944]
Stock Position:  -0.01457058493116316
Bond Position:  [1.47748596]


portfolio before change:  [-0.0279366]
curr_Stock_Price:  103.33197115747853
curr_Factors:  [1.03331971e+02 4.66572787e-02]
mat_Sqrt:  [[ 2.23200116e+01  0.00000000e+00]
 [-8.64011840e-03  1.97969983e-02]]
grads:  [-1.84546444e-03 -1.65734189e+01]
Stock Position:  -0.0018454644446079475
Bond Position:  [0.16275888]


portfolio before change:  [-0.02842866]
curr_Stock_Price:  103.60962909439701
curr_Factors:  [1.03609629e+02 4.69503342e-02]
mat_Sqrt:  [[ 2.24501612e+01  0.00000000e+00]
 [-8.66721032e-03  1.98590737e-02]]
grads:  [-3.13014907e-03  1.07466817e+01]
Stock Position:  -0.0031301490702275604
Bond Position:  [0.29588492]


portfolio before change:  [-0.02876762]
curr_Stock_Price:  103.7297337332978
curr_Factors:  [1.03729734e+02 4.60692148e-02]
mat_Sqrt:  [[ 2.22642807e+01  0.00000000e+00]
 [-8.58549612e-03  1.96718429e-02]]
grads:  [-3.05935674e-03  6.09104764e+00]
Stock Position:  -0.0030593567392029042
Bond Position:  [0.28857864]


portfolio before change:  [-0.02656719]
curr_Stock_Price:  103.02227812711097
curr_Factors:  [1.03022278e+02 4.67124002e-02]
mat_Sqrt:  [[ 2.22662582e+01  0.00000000e+00]
 [-8.64522067e-03  1.98086891e-02]]
grads:  [-1.42682096e-04  5.71196982e+00]
Stock Position:  -0.0001426820960508975
Bond Position:  [-0.01186775]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.02664087]
Stock Price:  103.52826023972015
PL:  [-3.55490111]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.14825682e-02  2.45611212e-01]
 [-1.64659307e-01 -8.75280242e-02]
 [ 7.93288361e-01 -6.65308758e-01]
 [-1.14745703e-02  2.50880700e-02]
 [ 7.87730736e-03  2.07358982e-04]
 [-8.94776914e-02 -6.63169280e-02]
 [-3.20995307e-02  2.20934328e-01]
 [ 1.68875715e-01 -1.90205088e-02]
 [ 1.19916616e-01  8.47974864e-02]
 [ 2.94772208e-01 -1.32449392e-01]
 [ 6.80169122e-02  1.43094178e-02]
 [-1.43538803e-01 -1.62332992e-01]
 [-1.05246416e-01  1.37018304e-01]
 [-3.99193684e-01 -5.24377792e-01]
 [ 8.94882150e-02  2.32891859e-01]
 [ 5.20195700e-02 -1.91424355e-02]
 [-4.58710489e-02  1.22148003e-01]
 [-5.49267954e-02  1.92223718e-02]
 [ 1.53855110e-02  5.37814902e-02]
 [ 1.00280158e-01 -9.99341531e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 8.24628417e-02  3.12892187e-01]
 [ 3.73315523e-02  3.58401200e-01]
 [ 5.08181268e-03  1.58473393e-01]
 [ 1.98289329e-02  4.64571428e-02]
 [ 5.55434660e-01 -1.47223454e-01]
 [ 4.99309192e-03  9.29609163e-02]
 [-1.69884449e-01  1.30293317e-01]
 [-2.74950300e-02 -1.23238112e-01]
 [ 1.82069039e-02 -5.05801183e-02]
 [-6.22168697e-01 -9.10170593e-02]
 [-1.18041004e-01  4.10170911e-03]
 [ 6.75545894e-02 -1.13227752e-02]
 [ 1.46024428e-01  6.90064163e-02]
 [-2.59162041e-01 -1.84210729e-01]
 [-3.72182850e-02 -3.91371272e-01]
 [-1.18156912e-01  2.53640790e-01]
 [-1.20326439e-01  1.19877859e-01]
 [-1.68761609e-02  1.07357705e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.43101839]
curr_Stock_Price:  99.80769673832395
curr_Factors:  [9.98076967e+01 3.85312213e-02]
mat_Sqrt:  [[ 1.95916233e+01  0.00000000e+00]
 [-7.85174847e-03  1.79906159e-02]]
grads:  [4.88529979e-03 1.36521848e+01]
Stock Position:  0.004885299787475253
Bond Position:  [0.94342787]


portfolio before change:  [1.43179588]
curr_Stock_Price:  99.94270491759215
curr_Factors:  [9.99427049e+01 3.98130240e-02]
mat_Sqrt:  [[ 1.9941769e+01  0.0000000e+00]
 [-7.9812805e-03  1.8287411e-02]]
grads:  [-0.0101726  -4.78624471]
Stock Position:  -0.010172601470881632
Bond Position:  [2.44847319]


portfolio before change:  [1.428326]
curr_Stock_Price:  100.31389395795502
curr_Factors:  [1.00313894e+02 3.91813559e-02]
mat_Sqrt:  [[ 1.98564140e+01  0.00000000e+00]
 [-7.91771239e-03  1.81417582e-02]]
grads:  [ 2.53280282e-02 -3.66727828e+01]
Stock Position:  0.025328028189446343
Bond Position:  [-1.11242713]


portfolio before change:  [1.42727714]
curr_Stock_Price:  100.27797327952192
curr_Factors:  [1.00277973e+02 4.09611104e-02]
mat_Sqrt:  [[ 2.02951100e+01  0.00000000e+00]
 [-8.09554054e-03  1.85492137e-02]]
grads:  [-2.58800714e-05  1.35251394e+00]
Stock Position:  -2.5880071435759827e-05
Bond Position:  [1.42987234]


portfolio before change:  [1.42746979]
curr_Stock_Price:  99.74087722394945
curr_Factors:  [9.97408772e+01 4.07446381e-02]
mat_Sqrt:  [[ 2.01329964e+01  0.00000000e+00]
 [-8.07412044e-03  1.85001341e-02]]
grads:  [0.00039576 0.01120851]
Stock Position:  0.0003957585888379004
Bond Position:  [1.38799648]


portfolio before change:  [1.42766896]
curr_Stock_Price:  99.80571141510069
curr_Factors:  [9.98057114e+01 4.25259310e-02]
mat_Sqrt:  [[ 2.05817505e+01  0.00000000e+00]
 [-8.24872654e-03  1.89002069e-02]]
grads:  [-0.00575368 -3.50879376]
Stock Position:  -0.005753678314663029
Bond Position:  [2.00191891]


portfolio before change:  [1.4307149]
curr_Stock_Price:  99.31981510977154
curr_Factors:  [9.93198151e+01 4.30141651e-02]
mat_Sqrt:  [[ 2.05987872e+01  0.00000000e+00]
 [-8.29594264e-03  1.90083925e-02]]
grads:  [3.12271371e-03 1.16229885e+01]
Stock Position:  0.003122713713501355
Bond Position:  [1.12056755]


portfolio before change:  [1.43404443]
curr_Stock_Price:  100.34118710937086
curr_Factors:  [1.00341187e+02 4.45340486e-02]
mat_Sqrt:  [[ 2.11750929e+01  0.00000000e+00]
 [-8.44123674e-03  1.93413032e-02]]
grads:  [ 0.00758318 -0.98341402]
Stock Position:  0.007583177336593813
Bond Position:  [0.67313942]


portfolio before change:  [1.443717]
curr_Stock_Price:  101.60561976636974
curr_Factors:  [1.01605620e+02 4.30112903e-02]
mat_Sqrt:  [[ 2.10721556e+01  0.00000000e+00]
 [-8.29566541e-03  1.90077573e-02]]
grads:  [0.00744704 4.46120418]
Stock Position:  0.007447044134779108
Bond Position:  [0.68705546]


portfolio before change:  [1.43566975]
curr_Stock_Price:  100.51348975256451
curr_Factors:  [1.00513490e+02 4.37819366e-02]
mat_Sqrt:  [[ 2.10315769e+01  0.00000000e+00]
 [-8.36965343e-03  1.91772852e-02]]
grads:  [ 0.01126718 -6.90657673]
Stock Position:  0.01126717965589834
Bond Position:  [0.3031662]


portfolio before change:  [1.44332589]
curr_Stock_Price:  101.1896347160875
curr_Factors:  [1.01189635e+02 4.38779837e-02]
mat_Sqrt:  [[ 2.11962659e+01  0.00000000e+00]
 [-8.37882891e-03  1.91983089e-02]]
grads:  [0.00350354 0.74534783]
Stock Position:  0.003503544182578634
Bond Position:  [1.08880353]


portfolio before change:  [1.44510165]
curr_Stock_Price:  101.65763109570393
curr_Factors:  [1.01657631e+02 4.28203642e-02]
mat_Sqrt:  [[ 2.10360970e+01  0.00000000e+00]
 [-8.27723280e-03  1.89655229e-02]]
grads:  [-0.01019137 -8.5593734 ]
Stock Position:  -0.01019137389567826
Bond Position:  [2.48113257]


portfolio before change:  [1.45194863]
curr_Stock_Price:  101.0162239638555
curr_Factors:  [1.01016224e+02 4.22165205e-02]
mat_Sqrt:  [[ 2.07554593e+01  0.00000000e+00]
 [-8.21866368e-03  1.88313242e-02]]
grads:  [-2.18962757e-03  7.27608435e+00]
Stock Position:  -0.0021896275686624695
Bond Position:  [1.67313654]


portfolio before change:  [1.45352469]
curr_Stock_Price:  100.3919604450416
curr_Factors:  [1.00391960e+02 4.23167481e-02]
mat_Sqrt:  [[ 2.06516653e+01  0.00000000e+00]
 [-8.22841400e-03  1.88536650e-02]]
grads:  [ -0.03041164 -27.81304281]
Stock Position:  -0.030411635359407413
Bond Position:  [4.50660838]


portfolio before change:  [1.54781408]
curr_Stock_Price:  97.31004700905406
curr_Factors:  [9.73100470e+01 4.33069724e-02]
mat_Sqrt:  [[ 2.02505393e+01  0.00000000e+00]
 [-8.32413094e-03  1.90729801e-02]]
grads:  [9.43829457e-03 1.22105648e+01]
Stock Position:  0.009438294573232683
Bond Position:  [0.62937319]


portfolio before change:  [1.55941677]
curr_Stock_Price:  98.53103198142435
curr_Factors:  [9.8531032e+01 4.2368898e-02]
mat_Sqrt:  [[ 2.02813386e+01  0.00000000e+00]
 [-8.23348266e-03  1.88652788e-02]]
grads:  [ 0.00215297 -1.01469137]
Stock Position:  0.0021529706266883554
Bond Position:  [1.34728235]


portfolio before change:  [1.56087348]
curr_Stock_Price:  99.12940884340956
curr_Factors:  [9.91294088e+01 4.33050032e-02]
mat_Sqrt:  [[ 2.06286855e+01  0.00000000e+00]
 [-8.32394169e-03  1.90725464e-02]]
grads:  [3.60600308e-04 6.40438884e+00]
Stock Position:  0.000360600308141116
Bond Position:  [1.52512738]


portfolio before change:  [1.56120621]
curr_Stock_Price:  99.52342614549956
curr_Factors:  [9.95234261e+01 4.42806768e-02]
mat_Sqrt:  [[ 2.09426890e+01  0.00000000e+00]
 [-8.41718973e-03  1.92862045e-02]]
grads:  [-0.00222213  0.99669024]
Stock Position:  -0.002222134158521016
Bond Position:  [1.78236062]


portfolio before change:  [1.56273364]
curr_Stock_Price:  98.93632554533998
curr_Factors:  [9.89363255e+01 4.26875385e-02]
mat_Sqrt:  [[ 2.04411974e+01  0.00000000e+00]
 [-8.26438513e-03  1.89360852e-02]]
grads:  [1.90094919e-03 2.84015886e+00]
Stock Position:  0.0019009491877838031
Bond Position:  [1.37466071]


portfolio before change:  [1.56133232]
curr_Stock_Price:  98.10875892313543
curr_Factors:  [9.81087589e+01 4.08410048e-02]
mat_Sqrt:  [[ 1.98269536e+01  0.00000000e+00]
 [-8.08366301e-03  1.85219988e-02]]
grads:  [ 2.85799415e-03 -5.39543027e+00]
Stock Position:  0.00285799414604967
Bond Position:  [1.28093806]


portfolio before change:  [1.56198631]
curr_Stock_Price:  98.28155877407424
curr_Factors:  [9.82815588e+01 4.05534892e-02]
mat_Sqrt:  [[ 1.97918390e+01  0.00000000e+00]
 [-8.05515876e-03  1.84566874e-02]]
grads:  [ 0.00212858 -2.04684562]
Stock Position:  0.0021285849514617997
Bond Position:  [1.35278566]


portfolio before change:  [1.56547381]
curr_Stock_Price:  99.84052399930809
curr_Factors:  [9.98405240e+01 3.83783326e-02]
mat_Sqrt:  [[ 1.95591466e+01  0.00000000e+00]
 [-7.83615545e-03  1.79548877e-02]]
grads:  [1.11978396e-02 1.74265744e+01]
Stock Position:  0.01119783962552452
Bond Position:  [0.44747563]


portfolio before change:  [1.56774892]
curr_Stock_Price:  100.03870279202647
curr_Factors:  [1.00038703e+02 3.98363344e-02]
mat_Sqrt:  [[ 1.99667664e+01  0.00000000e+00]
 [-7.98361667e-03  1.82927638e-02]]
grads:  [9.70365737e-03 1.95925122e+01]
Stock Position:  0.00970365736557973
Bond Position:  [0.59700762]


portfolio before change:  [1.57519292]
curr_Stock_Price:  100.79814543367137
curr_Factors:  [1.00798145e+02 3.95855608e-02]
mat_Sqrt:  [[ 2.00549204e+01  0.00000000e+00]
 [-7.95844817e-03  1.82350956e-02]]
grads:  [3.70209755e-03 8.69057102e+00]
Stock Position:  0.0037020975532528894
Bond Position:  [1.20202835]


portfolio before change:  [1.57222025]
curr_Stock_Price:  99.95458675616564
curr_Factors:  [9.99545868e+01 3.99041024e-02]
mat_Sqrt:  [[ 1.99669394e+01  0.00000000e+00]
 [-7.99040448e-03  1.83083167e-02]]
grads:  [2.00854479e-03 2.53748849e+00]
Stock Position:  0.002008544794791318
Bond Position:  [1.37145698]


portfolio before change:  [1.57185554]
curr_Stock_Price:  99.68765117415057
curr_Factors:  [9.96876512e+01 3.93267074e-02]
mat_Sqrt:  [[ 1.97690207e+01  0.00000000e+00]
 [-7.93238501e-03  1.81753774e-02]]
grads:  [ 0.024846   -8.10015942]
Stock Position:  0.024845999385616768
Bond Position:  [-0.90498378]


portfolio before change:  [1.56999768]
curr_Stock_Price:  99.61742958026451
curr_Factors:  [9.96174296e+01 3.89197465e-02]
mat_Sqrt:  [[ 1.96526144e+01  0.00000000e+00]
 [-7.89123529e-03  1.80810915e-02]]
grads:  [2.31849875e-03 5.14133321e+00]
Stock Position:  0.002318498753395223
Bond Position:  [1.33903479]


portfolio before change:  [1.57037523]
curr_Stock_Price:  99.70807316664094
curr_Factors:  [9.97080732e+01 3.85546775e-02]
mat_Sqrt:  [[ 1.95780242e+01  0.00000000e+00]
 [-7.85413802e-03  1.79960910e-02]]
grads:  [-5.77278800e-03  7.24008992e+00]
Stock Position:  -0.005772787999630301
Bond Position:  [2.1459688]


portfolio before change:  [1.57453585]
curr_Stock_Price:  99.03381338315337
curr_Factors:  [9.90338134e+01 3.73004880e-02]
mat_Sqrt:  [[ 1.91267314e+01  0.00000000e+00]
 [-7.72533370e-03  1.77009632e-02]]
grads:  [-4.24957876e-03 -6.96222629e+00]
Stock Position:  -0.004249578755066506
Bond Position:  [1.99538784]


portfolio before change:  [1.57201846]
curr_Stock_Price:  99.68489620837676
curr_Factors:  [9.96848962e+01 3.56924283e-02]
mat_Sqrt:  [[ 1.88329090e+01  0.00000000e+00]
 [-7.55697594e-03  1.73152071e-02]]
grads:  [-2.05388850e-04 -2.92113851e+00]
Stock Position:  -0.00020538884993140486
Bond Position:  [1.59249263]


portfolio before change:  [1.57207063]
curr_Stock_Price:  100.40012507128748
curr_Factors:  [1.00400125e+02 3.50940872e-02]
mat_Sqrt:  [[ 1.88083730e+01  0.00000000e+00]
 [-7.49336636e-03  1.71694593e-02]]
grads:  [-0.03519134 -5.30110225]
Stock Position:  -0.0351913373173507
Bond Position:  [5.1052853]


portfolio before change:  [1.57129152]
curr_Stock_Price:  100.44039975307237
curr_Factors:  [1.00440400e+02 3.32322118e-02]
mat_Sqrt:  [[ 1.83099879e+01  0.00000000e+00]
 [-7.29188171e-03  1.67078000e-02]]
grads:  [-0.00634904  0.24549666]
Stock Position:  -0.006349041451380562
Bond Position:  [2.20899178]


portfolio before change:  [1.57378456]
curr_Stock_Price:  100.09122886709766
curr_Factors:  [1.00091229e+02 3.38332742e-02]
mat_Sqrt:  [[ 1.84106039e+01  0.00000000e+00]
 [-7.35752939e-03  1.68582177e-02]]
grads:  [ 0.00340092 -0.67164723]
Stock Position:  0.0034009164154821542
Bond Position:  [1.23338265]


portfolio before change:  [1.57792775]
curr_Stock_Price:  101.26415115034804
curr_Factors:  [1.01264151e+02 3.31962280e-02]
mat_Sqrt:  [[ 1.84501583e+01  0.00000000e+00]
 [-7.28793282e-03  1.66987519e-02]]
grads:  [0.00954687 4.13242958]
Stock Position:  0.009546871867376247
Bond Position:  [0.61117187]


portfolio before change:  [1.59471888]
curr_Stock_Price:  103.01495828823532
curr_Factors:  [1.03014958e+02 3.19106277e-02]
mat_Sqrt:  [[ 1.84021245e+01  0.00000000e+00]
 [-7.14541841e-03  1.63722104e-02]]
grads:  [ -0.01845212 -11.25142698]
Stock Position:  -0.018452119220123117
Bond Position:  [3.49556317]


portfolio before change:  [1.60966403]
curr_Stock_Price:  102.22869793505899
curr_Factors:  [1.02228698e+02 3.25967151e-02]
mat_Sqrt:  [[ 1.84569420e+01  0.00000000e+00]
 [-7.22182415e-03  1.65472779e-02]]
grads:  [-1.12709197e-02 -2.36517011e+01]
Stock Position:  -0.011270919717969802
Bond Position:  [2.76187547]


portfolio before change:  [1.61331449]
curr_Stock_Price:  101.93544674549408
curr_Factors:  [1.01935447e+02 3.21995760e-02]
mat_Sqrt:  [[ 1.82915415e+01  0.00000000e+00]
 [-7.17769612e-03  1.64461679e-02]]
grads:  [-4.07783894e-04  1.54224857e+01]
Stock Position:  -0.000407783894441703
Bond Position:  [1.65488213]


portfolio before change:  [1.61275938]
curr_Stock_Price:  103.8040393238251
curr_Factors:  [1.03804039e+02 3.07287467e-02]
mat_Sqrt:  [[ 1.81964504e+01  0.00000000e+00]
 [-7.01184674e-03  1.60661592e-02]]
grads:  [-3.73740211e-03  7.46151317e+00]
Stock Position:  -0.0037374021140456773
Bond Position:  [2.00071682]


portfolio before change:  [1.61736763]
curr_Stock_Price:  102.63795140307924
curr_Factors:  [1.02637951e+02 3.15979649e-02]
mat_Sqrt:  [[ 1.82447338e+01  0.00000000e+00]
 [-7.11032657e-03  1.62918049e-02]]
grads:  [1.64313623e-03 6.58967539e+00]
Stock Position:  0.0016431362268048398
Bond Position:  [1.44871949]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.61945888]
Stock Price:  103.80045747616732
PL:  [-2.18099859]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.22271633e-01  6.59659805e-01]
 [-1.80041232e-01 -7.31573468e-02]
 [ 7.49029260e-01 -6.35201848e-01]
 [ 2.41461657e-02  2.29366711e-02]
 [-1.26097566e-01  5.38254246e-02]
 [ 1.65986863e-01  1.61611467e-01]
 [ 1.60771965e-01 -2.20907170e-01]
 [ 6.22164744e-01 -3.09749733e-02]
 [-2.86209511e-01 -1.27961243e-01]
 [ 5.15719847e-01 -3.72023909e-01]
 [ 5.93250994e-02 -1.57019480e-02]
 [-3.81300134e-01 -2.17933147e-01]
 [-1.26040584e-01  1.26420921e-01]
 [-8.67364744e-01 -1.25788253e+00]
 [-1.36171929e-01 -7.31161915e-01]
 [-6.33723420e-02 -2.36263147e-01]
 [-4.90889214e-02  5.24553210e-02]
 [ 1.43411687e-01  1.57185907e-01]
 [-1.17995239e-01 -1.14290942e-01]
 [-1.16375674e-01 -2.42884346e-02]
 [ 2.02350675e-01  4.15672347e-01]
 [-2.06051575e-02  2.38990663e-01]
 [-1.40724258e-02 -4.65859738e-01]
 [ 1.74729772e-01  2.17545044e-01]
 [ 9.88979970e-02  2.01819989e-01]
 [ 8.16210850e-01 -7.63856122e-01]
 [-6.86487522e-01  8.46629586e-01]
 [ 8.78414173e-02 -1.48759667e-02]
 [-5.87430124e-02 -5.01898736e-02]
 [ 1.31527569e-01 -8.69945666e-02]
 [ 1.26095242e-01 -6.48906301e-02]
 [ 2.90518388e-01 -2.49118482e-02]
 [ 2.82923700e-01  3.58583079e-01]
 [ 2.21509653e-01  3.02791638e-02]
 [-2.22772382e-01 -2.23696225e-01]
 [ 1.06470616e-01 -3.14142534e-01]
 [-1.47323295e-01  2.27604670e-01]
 [-1.23473246e-01  1.17754958e-01]
 [ 1.70686312e-01  8.38198538e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.36880337]
curr_Stock_Price:  101.00325563245562
curr_Factors:  [1.01003256e+02 4.03584616e-02]
mat_Sqrt:  [[ 2.02909637e+01  0.00000000e+00]
 [-8.03576621e-03  1.84122535e-02]]
grads:  [3.00710594e-02 3.58272173e+01]
Stock Position:  0.03007105938722374
Bond Position:  [6.33152847]


portfolio before change:  [9.37371934]
curr_Stock_Price:  101.14041323323616
curr_Factors:  [1.01140413e+02 4.08266320e-02]
mat_Sqrt:  [[ 2.04360286e+01  0.00000000e+00]
 [-8.08224048e-03  1.85187394e-02]]
grads:  [-0.01037235 -3.95044961]
Stock Position:  -0.010372353682793186
Bond Position:  [10.42278347]


portfolio before change:  [9.37289557]
curr_Stock_Price:  101.3454484701752
curr_Factors:  [1.01345448e+02 4.10262931e-02]
mat_Sqrt:  [[ 2.05274682e+01  0.00000000e+00]
 [-8.10197932e-03  1.85639668e-02]]
grads:  [ 2.29840544e-02 -3.42169245e+01]
Stock Position:  0.022984054417469993
Bond Position:  [7.04356626]


portfolio before change:  [9.36624623]
curr_Stock_Price:  101.01783709408345
curr_Factors:  [1.01017837e+02 3.93952110e-02]
mat_Sqrt:  [[ 2.00502495e+01  0.00000000e+00]
 [-7.93929075e-03  1.81912004e-02]]
grads:  [0.00170355 1.26086627]
Stock Position:  0.0017035473603994032
Bond Position:  [9.19415756]


portfolio before change:  [9.36861498]
curr_Stock_Price:  101.73364079272548
curr_Factors:  [1.01733641e+02 3.86355277e-02]
mat_Sqrt:  [[ 1.99966853e+01  0.00000000e+00]
 [-7.86236888e-03  1.80149503e-02]]
grads:  [-0.00513116  2.98781977]
Stock Position:  -0.005131161681687589
Bond Position:  [9.89062674]


portfolio before change:  [9.36173402]
curr_Stock_Price:  103.31561499716335
curr_Factors:  [1.03315615e+02 3.79366677e-02]
mat_Sqrt:  [[ 2.01231310e+01  0.00000000e+00]
 [-7.79093501e-03  1.78512747e-02]]
grads:  [0.01175363 9.05321718]
Stock Position:  0.011753632632113459
Bond Position:  [8.14740023]


portfolio before change:  [9.37955187]
curr_Stock_Price:  104.74490602601584
curr_Factors:  [1.04744906e+02 3.71633261e-02]
mat_Sqrt:  [[ 2.01925050e+01  0.00000000e+00]
 [-7.71111676e-03  1.76683881e-02]]
grads:  [ 3.18732976e-03 -1.25029611e+01]
Stock Position:  0.0031873297572063554
Bond Position:  [9.04569531]


portfolio before change:  [9.38542603]
curr_Stock_Price:  106.23310416408428
curr_Factors:  [1.06233104e+02 3.67392240e-02]
mat_Sqrt:  [[ 2.03622076e+01  0.00000000e+00]
 [-7.66699149e-03  1.75672844e-02]]
grads:  [ 0.02989097 -1.76321921]
Stock Position:  0.029890970977407446
Bond Position:  [6.2100154]


portfolio before change:  [9.37315443]
curr_Stock_Price:  105.79658766154222
curr_Factors:  [1.05796588e+02 3.70061510e-02]
mat_Sqrt:  [[ 2.03520714e+01  0.00000000e+00]
 [-7.69479314e-03  1.76309860e-02]]
grads:  [-0.01680696 -7.25774743]
Stock Position:  -0.016806956338472654
Bond Position:  [11.15127306]


portfolio before change:  [9.40322434]
curr_Stock_Price:  104.09039442085265
curr_Factors:  [1.04090394e+02 3.85187253e-02]
mat_Sqrt:  [[ 2.04289764e+01  0.00000000e+00]
 [-7.85047518e-03  1.79876984e-02]]
grads:  [ 1.72967698e-02 -2.06821296e+01]
Stock Position:  0.01729676976685532
Bond Position:  [7.60279675]


portfolio before change:  [9.41157336]
curr_Stock_Price:  104.51813979754785
curr_Factors:  [1.04518140e+02 3.90650616e-02]
mat_Sqrt:  [[ 2.06578885e+01  0.00000000e+00]
 [-7.90595336e-03  1.81148149e-02]]
grads:  [ 0.00254006 -0.86680146]
Stock Position:  0.002540056674152549
Bond Position:  [9.14609136]


portfolio before change:  [9.41527093]
curr_Stock_Price:  105.52372339892949
curr_Factors:  [1.05523723e+02 3.89635275e-02]
mat_Sqrt:  [[ 2.08295190e+01  0.00000000e+00]
 [-7.89567248e-03  1.80912584e-02]]
grads:  [ -0.02287206 -12.04632327]
Stock Position:  -0.0228720575770998
Bond Position:  [11.82881561]


portfolio before change:  [9.39787033]
curr_Stock_Price:  106.34915390811418
curr_Factors:  [1.06349154e+02 3.83026478e-02]
mat_Sqrt:  [[ 2.08136591e+01  0.00000000e+00]
 [-7.82842491e-03  1.79371749e-02]]
grads:  [-3.40478197e-03  7.04798396e+00]
Stock Position:  -0.0034047819659779165
Bond Position:  [9.75996601]


portfolio before change:  [9.39962209]
curr_Stock_Price:  106.19299501820356
curr_Factors:  [1.06192995e+02 3.82515025e-02]
mat_Sqrt:  [[ 2.07692168e+01  0.00000000e+00]
 [-7.82319654e-03  1.79251952e-02]]
grads:  [-6.81946606e-02 -7.01739937e+01]
Stock Position:  -0.06819466063151375
Bond Position:  [16.64141735]


portfolio before change:  [9.33596714]
curr_Stock_Price:  107.15693052993313
curr_Factors:  [1.07156931e+02 3.74319451e-02]
mat_Sqrt:  [[ 2.07320125e+01  0.00000000e+00]
 [-7.73893482e-03  1.77321273e-02]]
grads:  [-2.19601039e-02 -4.12337393e+01]
Stock Position:  -0.021960103931084166
Bond Position:  [11.68914448]


portfolio before change:  [9.34050059]
curr_Stock_Price:  107.01703074414532
curr_Factors:  [1.07017031e+02 3.70401193e-02]
mat_Sqrt:  [[ 2.05962941e+01  0.00000000e+00]
 [-7.69832390e-03  1.76390760e-02]]
grads:  [-8.08330042e-03 -1.33943041e+01]
Stock Position:  -0.00808330041849198
Bond Position:  [10.2055514]


portfolio before change:  [9.32739461]
curr_Stock_Price:  108.79622479679864
curr_Factors:  [1.08796225e+02 3.59016103e-02]
mat_Sqrt:  [[ 2.06144043e+01  0.00000000e+00]
 [-7.57908810e-03  1.73658725e-02]]
grads:  [-1.27073972e-03  3.02059808e+00]
Stock Position:  -0.0012707397224414319
Bond Position:  [9.46564629]


portfolio before change:  [9.3279806]
curr_Stock_Price:  109.26625456342998
curr_Factors:  [1.09266255e+02 3.63568660e-02]
mat_Sqrt:  [[ 2.08343174e+01  0.00000000e+00]
 [-7.62699060e-03  1.74756309e-02]]
grads:  [0.01017615 8.99457698]
Stock Position:  0.010176154872229025
Bond Position:  [8.21607027]


portfolio before change:  [9.32145744]
curr_Stock_Price:  108.52430119783148
curr_Factors:  [1.08524301e+02 3.69887414e-02]
mat_Sqrt:  [[ 2.08718899e+01  0.00000000e+00]
 [-7.69298292e-03  1.76268383e-02]]
grads:  [-0.00804316 -6.48391616]
Stock Position:  -0.008043157382659216
Bond Position:  [10.19433548]


portfolio before change:  [9.33083359]
curr_Stock_Price:  107.51701350034587
curr_Factors:  [1.07517014e+02 3.76499338e-02]
mat_Sqrt:  [[ 2.08621614e+01  0.00000000e+00]
 [-7.76143634e-03  1.77836848e-02]]
grads:  [-0.00608643 -1.36577065]
Stock Position:  -0.006086426706031347
Bond Position:  [9.98522801]


portfolio before change:  [9.34133555]
curr_Stock_Price:  105.99662530071502
curr_Factors:  [1.05996625e+02 3.73068150e-02]
mat_Sqrt:  [[ 2.04732187e+01  0.00000000e+00]
 [-7.72598886e-03  1.77024644e-02]]
grads:  [1.87447302e-02 2.34810441e+01]
Stock Position:  0.018744730206075772
Bond Position:  [7.3544574]


portfolio before change:  [9.36789163]
curr_Stock_Price:  107.36430141684947
curr_Factors:  [1.07364301e+02 3.72974656e-02]
mat_Sqrt:  [[ 2.07347863e+01  0.00000000e+00]
 [-7.72502071e-03  1.77002461e-02]]
grads:  [4.03664246e-03 1.35021096e+01]
Stock Position:  0.004036642464284668
Bond Position:  [8.93450033]


portfolio before change:  [9.37242499]
curr_Stock_Price:  108.21066774275505
curr_Factors:  [1.08210668e+02 3.70198871e-02]
mat_Sqrt:  [[ 2.08203306e+01  0.00000000e+00]
 [-7.69622111e-03  1.76342579e-02]]
grads:  [-1.04412503e-02 -2.64178816e+01]
Stock Position:  -0.010441250325628051
Bond Position:  [10.50227966]


portfolio before change:  [9.37112934]
curr_Stock_Price:  108.4604960871887
curr_Factors:  [1.08460496e+02 3.69832365e-02]
mat_Sqrt:  [[ 2.08580663e+01  0.00000000e+00]
 [-7.69241044e-03  1.76255266e-02]]
grads:  [ 0.01292901 12.34261245]
Stock Position:  0.012929013105379788
Bond Position:  [7.96884217]


portfolio before change:  [9.36801204]
curr_Stock_Price:  108.14233834397173
curr_Factors:  [1.08142338e+02 3.55909231e-02]
mat_Sqrt:  [[ 2.04016542e+01  0.00000000e+00]
 [-7.54622270e-03  1.72905684e-02]]
grads:  [9.16491672e-03 1.16722588e+01]
Stock Position:  0.009164916718981382
Bond Position:  [8.37689652]


portfolio before change:  [9.36005507]
curr_Stock_Price:  107.15987948452059
curr_Factors:  [1.07159879e+02 3.60228053e-02]
mat_Sqrt:  [[ 2.03385966e+01  0.00000000e+00]
 [-7.59186989e-03  1.73951592e-02]]
grads:  [ 2.37399226e-02 -4.39119937e+01]
Stock Position:  0.023739922565212138
Bond Position:  [6.81608783]


portfolio before change:  [9.36541868]
curr_Stock_Price:  107.34992003259798
curr_Factors:  [1.07349920e+02 3.61856192e-02]
mat_Sqrt:  [[ 2.04206579e+01  0.00000000e+00]
 [-7.60900721e-03  1.74344258e-02]]
grads:  [-1.55229121e-02  4.85607956e+01]
Stock Position:  -0.015522912099907814
Bond Position:  [11.03180205]


portfolio before change:  [9.35019155]
curr_Stock_Price:  108.41970545839888
curr_Factors:  [1.08419705e+02 3.57429959e-02]
mat_Sqrt:  [[ 2.04976323e+01  0.00000000e+00]
 [-7.56232725e-03  1.73274685e-02]]
grads:  [ 0.0039687  -0.85851933]
Stock Position:  0.003968702915001533
Bond Position:  [8.91990595]


portfolio before change:  [9.35716388]
curr_Stock_Price:  109.8955700990902
curr_Factors:  [1.09895570e+02 3.71490004e-02]
mat_Sqrt:  [[ 2.11813557e+01  0.00000000e+00]
 [-7.70963039e-03  1.76649824e-02]]
grads:  [-0.00380748 -2.84120711]
Stock Position:  -0.003807483820856496
Bond Position:  [9.77558949]


portfolio before change:  [9.35797616]
curr_Stock_Price:  110.00318607319976
curr_Factors:  [1.10003186e+02 3.58279469e-02]
mat_Sqrt:  [[ 2.08217019e+01  0.00000000e+00]
 [-7.57130867e-03  1.73480476e-02]]
grads:  [ 4.49339001e-03 -5.01466037e+00]
Stock Position:  0.00449339000668632
Bond Position:  [8.86368894]


portfolio before change:  [9.34751825]
curr_Stock_Price:  107.42919728887404
curr_Factors:  [1.07429197e+02 3.81419799e-02]
mat_Sqrt:  [[ 2.09808919e+01  0.00000000e+00]
 [-7.81198872e-03  1.78995148e-02]]
grads:  [ 0.00466018 -3.62527313]
Stock Position:  0.004660175999167622
Bond Position:  [8.84687929]


portfolio before change:  [9.35601505]
curr_Stock_Price:  109.0151599861062
curr_Factors:  [1.09015160e+02 3.61155074e-02]
mat_Sqrt:  [[ 2.07173287e+01  0.00000000e+00]
 [-7.60163218e-03  1.74175274e-02]]
grads:  [ 0.01349817 -1.43027466]
Stock Position:  0.01349816716324312
Bond Position:  [7.8845102]


portfolio before change:  [9.34330808]
curr_Stock_Price:  108.00075611117884
curr_Factors:  [1.08000756e+02 3.57329791e-02]
mat_Sqrt:  [[ 2.04155652e+01  0.00000000e+00]
 [-7.56126752e-03  1.73250404e-02]]
grads:  [ 0.02152388 20.69738778]
Stock Position:  0.021523880489322692
Bond Position:  [7.01871271]


portfolio before change:  [9.2955181]
curr_Stock_Price:  105.73966858640749
curr_Factors:  [1.05739669e+02 3.72078539e-02]
mat_Sqrt:  [[ 2.03964815e+01  0.00000000e+00]
 [-7.71573498e-03  1.76789698e-02]]
grads:  [0.01150809 1.71272218]
Stock Position:  0.011508090940694056
Bond Position:  [8.07865638]


portfolio before change:  [9.28061045]
curr_Stock_Price:  104.35650787547708
curr_Factors:  [1.04356508e+02 3.80821770e-02]
mat_Sqrt:  [[ 2.03648128e+01  0.00000000e+00]
 [-7.80586211e-03  1.78854770e-02]]
grads:  [ -0.01573309 -12.50714336]
Stock Position:  -0.01573308934472253
Bond Position:  [10.92246072]


portfolio before change:  [9.29511335]
curr_Stock_Price:  103.52148437679148
curr_Factors:  [1.03521484e+02 3.92917575e-02]
mat_Sqrt:  [[ 2.05201825e+01  0.00000000e+00]
 [-7.92885944e-03  1.81672993e-02]]
grads:  [-1.49279502e-03 -1.72916474e+01]
Stock Position:  -0.0014927950243167742
Bond Position:  [9.4496497]


portfolio before change:  [9.29725446]
curr_Stock_Price:  102.87850840607243
curr_Factors:  [1.02878508e+02 4.06175604e-02]
mat_Sqrt:  [[ 2.07339275e+01  0.00000000e+00]
 [-8.06151950e-03  1.84712617e-02]]
grads:  [-2.31449024e-03  1.23220966e+01]
Stock Position:  -0.0023144902428026705
Bond Position:  [9.53536576]


portfolio before change:  [9.30294685]
curr_Stock_Price:  100.93406532022213
curr_Factors:  [1.00934065e+02 4.07379323e-02]
mat_Sqrt:  [[ 2.03721684e+01  0.00000000e+00]
 [-8.07345599e-03  1.84986116e-02]]
grads:  [-3.53819819e-03  6.36561060e+00]
Stock Position:  -0.0035381981938383505
Bond Position:  [9.66007157]


portfolio before change:  [9.30275245]
curr_Stock_Price:  101.3303058107401
curr_Factors:  [1.01330306e+02 4.07681882e-02]
mat_Sqrt:  [[ 2.04597376e+01  0.00000000e+00]
 [-8.07645350e-03  1.85054798e-02]]
grads:  [0.01013055 4.52946127]
Stock Position:  0.01013054512675113
Bond Position:  [8.27622122]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.3012204]
Stock Price:  101.07694817524605
PL:  [8.22427222]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.28663338e-01  5.43557387e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.92613400e-01 -6.64849621e-01]
 [ 8.85036920e-03  2.38604970e-02]
 [ 1.67522754e-02 -3.34449074e-03]
 [-5.67428884e-02 -5.29303112e-02]
 [ 8.43462534e-03  3.10165123e-01]
 [ 1.96547709e-01 -6.72244385e-03]
 [ 1.27181828e-01  8.24869165e-02]
 [ 3.44134790e-01 -1.68748761e-01]
 [ 6.29897553e-02 -3.04850856e-03]
 [-1.03994233e-01 -1.82823632e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-4.72398029e-01 -6.10344719e-01]
 [ 6.80042120e-02  1.83656762e-01]
 [ 5.72068198e-02 -2.31340175e-02]
 [-5.33700312e-02  2.93110362e-01]
 [-1.11770589e-01  5.15836253e-02]
 [ 1.48967127e-02  6.59184268e-02]
 [-1.01593097e-01 -3.48824685e-02]
 [ 2.10636811e-01  3.68632013e-01]
 [ 6.12304031e-03  1.64201869e-01]
 [-1.37029779e-02 -3.21009775e-01]
 [ 1.13124842e-01  1.96097558e-01]
 [ 7.42131627e-02  1.55491074e-01]
 [ 7.95665550e-01 -6.78736422e-01]
 [-7.67405897e-01  9.31743406e-01]
 [ 7.98801278e-02 -1.62800897e-02]
 [-5.86613846e-02 -5.02790792e-02]
 [ 1.22517957e-01 -1.07976446e-01]
 [ 1.18398842e-01 -6.43163074e-02]
 [ 2.25198468e-01 -1.80598516e-02]
 [ 2.33670734e-01  2.76507273e-01]
 [ 2.23849531e-01  2.90787035e-02]
 [-1.85779389e-01 -2.37624037e-01]
 [ 1.64720220e-01 -1.32008548e-01]
 [-1.84205966e-01  1.97058682e-01]
 [-1.18768374e-01  1.20928962e-01]
 [-1.68658550e-01  1.42475120e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.14254695]
curr_Stock_Price:  100.66794538303168
curr_Factors:  [1.00667945e+02 3.99312464e-02]
mat_Sqrt:  [[ 2.01162784e+01  0.00000000e+00]
 [-7.99312168e-03  1.83145426e-02]]
grads:  [2.31599116e-02 2.96790043e+01]
Stock Position:  0.023159911636550998
Bond Position:  [4.81108623]


portfolio before change:  [7.12379629]
curr_Stock_Price:  99.83236001107984
curr_Factors:  [9.98323600e+01 3.97882588e-02]
mat_Sqrt:  [[ 1.99135553e+01  0.00000000e+00]
 [-7.97879778e-03  1.82817224e-02]]
grads:  [-0.01019328 -4.81417277]
Stock Position:  -0.010193280141244066
Bond Position:  [8.14141551]


portfolio before change:  [7.11987513]
curr_Stock_Price:  100.31688506987128
curr_Factors:  [1.00316885e+02 3.97268996e-02]
mat_Sqrt:  [[ 1.99947683e+01  0.00000000e+00]
 [-7.97264319e-03  1.82676204e-02]]
grads:  [ 2.51290353e-02 -3.63949767e+01]
Stock Position:  0.02512903527015698
Bond Position:  [4.59900859]


portfolio before change:  [7.13008929]
curr_Stock_Price:  100.7004751021216
curr_Factors:  [1.00700475e+02 3.95306210e-02]
mat_Sqrt:  [[ 2.00215796e+01  0.00000000e+00]
 [-7.95292359e-03  1.82224372e-02]]
grads:  [9.62159042e-04 1.30940207e+00]
Stock Position:  0.0009621590418329748
Bond Position:  [7.03319942]


portfolio before change:  [7.12988917]
curr_Stock_Price:  99.57870066082803
curr_Factors:  [9.95787007e+01 4.10866504e-02]
mat_Sqrt:  [[ 2.01844455e+01  0.00000000e+00]
 [-8.10793689e-03  1.85776173e-02]]
grads:  [ 0.00075764 -0.18002797]
Stock Position:  0.0007576437985517576
Bond Position:  [7.05444399]


portfolio before change:  [7.13183035]
curr_Stock_Price:  100.976869647406
curr_Factors:  [1.00976870e+02 3.95664503e-02]
mat_Sqrt:  [[ 2.00856295e+01  0.00000000e+00]
 [-7.95652691e-03  1.82306934e-02]]
grads:  [-0.00397516 -2.90336248]
Stock Position:  -0.003975158958031941
Bond Position:  [7.53322946]


portfolio before change:  [7.13156985]
curr_Stock_Price:  101.279300559818
curr_Factors:  [1.01279301e+02 3.74225443e-02]
mat_Sqrt:  [[ 1.95923869e+01  0.00000000e+00]
 [-7.73796297e-03  1.77299005e-02]]
grads:  [7.33967656e-03 1.74939010e+01]
Stock Position:  0.007339676560247294
Bond Position:  [6.38821254]


portfolio before change:  [7.12805057]
curr_Stock_Price:  100.69101082377365
curr_Factors:  [1.00691011e+02 3.84586493e-02]
mat_Sqrt:  [[ 1.97463902e+01  0.00000000e+00]
 [-7.84435076e-03  1.79736656e-02]]
grads:  [ 0.00980502 -0.3740163 ]
Stock Position:  0.009805022177571912
Bond Position:  [6.14077297]


portfolio before change:  [7.13449491]
curr_Stock_Price:  101.26996884820728
curr_Factors:  [1.01269969e+02 3.93511557e-02]
mat_Sqrt:  [[ 2.00890510e+01  0.00000000e+00]
 [-7.93485029e-03  1.81810260e-02]]
grads:  [0.00812294 4.53697807]
Stock Position:  0.008122935699634412
Bond Position:  [6.31188546]


portfolio before change:  [7.13967682]
curr_Stock_Price:  101.81076730499109
curr_Factors:  [1.01810767e+02 3.93113086e-02]
mat_Sqrt:  [[ 2.01861019e+01  0.00000000e+00]
 [-7.93083185e-03  1.81718186e-02]]
grads:  [ 0.01339965 -9.2862891 ]
Stock Position:  0.01339965459859956
Bond Position:  [5.7754477]


portfolio before change:  [7.14959355]
curr_Stock_Price:  102.49696101550673
curr_Factors:  [1.02496961e+02 3.80398545e-02]
mat_Sqrt:  [[ 1.99908110e+01  0.00000000e+00]
 [-7.80152339e-03  1.78755357e-02]]
grads:  [ 0.00308438 -0.17054082]
Stock Position:  0.0030843809754849934
Bond Position:  [6.83345387]


portfolio before change:  [7.15156121]
curr_Stock_Price:  102.85795009287028
curr_Factors:  [1.02857950e+02 3.62133336e-02]
mat_Sqrt:  [[ 1.95736635e+01  0.00000000e+00]
 [-7.61192051e-03  1.74411010e-02]]
grads:  [-9.38940263e-03 -1.04823447e+01]
Stock Position:  -0.009389402632238223
Bond Position:  [8.11733592]


portfolio before change:  [7.15671483]
curr_Stock_Price:  102.4171459800027
curr_Factors:  [1.02417146e+02 3.48132568e-02]
mat_Sqrt:  [[ 1.91093096e+01  0.00000000e+00]
 [-7.46332439e-03  1.71006245e-02]]
grads:  [-6.32111897e-03  9.67985975e+00]
Stock Position:  -0.006321118971674577
Bond Position:  [7.8041058]


portfolio before change:  [7.16535114]
curr_Stock_Price:  101.20521919128304
curr_Factors:  [1.01205219e+02 3.48123619e-02]
mat_Sqrt:  [[ 1.88829418e+01  0.00000000e+00]
 [-7.46322845e-03  1.71004047e-02]]
grads:  [ -0.0391239  -35.69182898]
Stock Position:  -0.03912389875590378
Bond Position:  [11.12489389]


portfolio before change:  [7.13452158]
curr_Stock_Price:  102.02876327808902
curr_Factors:  [1.02028763e+02 3.35589701e-02]
mat_Sqrt:  [[ 1.86907589e+01  0.00000000e+00]
 [-7.32764302e-03  1.67897394e-02]]
grads:  [7.92683676e-03 1.09386309e+01]
Stock Position:  0.00792683675979983
Bond Position:  [6.32575623]


portfolio before change:  [7.13835988]
curr_Stock_Price:  102.41322053136427
curr_Factors:  [1.02413221e+02 3.32980903e-02]
mat_Sqrt:  [[ 1.86881231e+01  0.00000000e+00]
 [-7.29910573e-03  1.67243523e-02]]
grads:  [ 0.00252087 -1.38325342]
Stock Position:  0.002520868817294841
Bond Position:  [6.88018959]


portfolio before change:  [7.14150495]
curr_Stock_Price:  103.31965177992006
curr_Factors:  [1.03319652e+02 3.17735854e-02]
mat_Sqrt:  [[ 1.84168795e+01  0.00000000e+00]
 [-7.13005867e-03  1.63370168e-02]]
grads:  [4.04812437e-03 1.79414863e+01]
Stock Position:  0.004048124365250933
Bond Position:  [6.72325415]


portfolio before change:  [7.1358617]
curr_Stock_Price:  101.71799382439178
curr_Factors:  [1.01717994e+02 3.24363597e-02]
mat_Sqrt:  [[ 1.83195094e+01  0.00000000e+00]
 [-7.20403883e-03  1.65065266e-02]]
grads:  [-0.00487227  3.1250442 ]
Stock Position:  -0.0048722728787319695
Bond Position:  [7.63145952]


portfolio before change:  [7.13358028]
curr_Stock_Price:  102.38203970515308
curr_Factors:  [1.02382040e+02 3.23404955e-02]
mat_Sqrt:  [[ 1.84118366e+01  0.00000000e+00]
 [-7.19338535e-03  1.64821164e-02]]
grads:  [2.37161961e-03 3.99939092e+00]
Stock Position:  0.0023716196089230025
Bond Position:  [6.89076903]


portfolio before change:  [7.13809857]
curr_Stock_Price:  103.92397667496402
curr_Factors:  [1.03923977e+02 3.20569842e-02]
mat_Sqrt:  [[ 1.86070313e+01  0.00000000e+00]
 [-7.16178572e-03  1.64097126e-02]]
grads:  [-0.00627811 -2.12572087]
Stock Position:  -0.006278113489284823
Bond Position:  [7.79054509]


portfolio before change:  [7.13011128]
curr_Stock_Price:  105.35134311149092
curr_Factors:  [1.05351343e+02 3.05815963e-02]
mat_Sqrt:  [[ 1.84234157e+01  0.00000000e+00]
 [-6.99503781e-03  1.60276451e-02]]
grads:  [2.01656965e-02 2.29997613e+01]
Stock Position:  0.020165696543668985
Bond Position:  [5.00562806]


portfolio before change:  [7.14873549]
curr_Stock_Price:  106.24387231431368
curr_Factors:  [1.06243872e+02 2.99674747e-02]
mat_Sqrt:  [[ 1.83920003e+01  0.00000000e+00]
 [-6.92444651e-03  1.58659001e-02]]
grads:  [4.22937200e-03 1.03493572e+01]
Stock Position:  0.00422937199683598
Bond Position:  [6.69939064]


portfolio before change:  [7.15243215]
curr_Stock_Price:  106.91990057527109
curr_Factors:  [1.06919901e+02 2.87775248e-02]
mat_Sqrt:  [[ 1.81378274e+01  0.00000000e+00]
 [-6.78557585e-03  1.55477075e-02]]
grads:  [-8.47968869e-03 -2.06467594e+01]
Stock Position:  -0.008479688694104431
Bond Position:  [8.05907962]


portfolio before change:  [7.16392434]
curr_Stock_Price:  105.68344599637324
curr_Factors:  [1.05683446e+02 3.01859989e-02]
mat_Sqrt:  [[ 1.83615670e+01  0.00000000e+00]
 [-6.94964735e-03  1.59236425e-02]]
grads:  [1.08219975e-02 1.23148681e+01]
Stock Position:  0.01082199752916323
Bond Position:  [6.02021835]


portfolio before change:  [7.16815274]
curr_Stock_Price:  106.00462691959882
curr_Factors:  [1.06004627e+02 2.85468145e-02]
mat_Sqrt:  [[ 1.79103325e+01  0.00000000e+00]
 [-6.75832104e-03  1.54852589e-02]]
grads:  [7.93257362e-03 1.00412318e+01]
Stock Position:  0.007932573616100566
Bond Position:  [6.32726323]


portfolio before change:  [7.17065911]
curr_Stock_Price:  106.22087620838596
curr_Factors:  [1.06220876e+02 2.83411954e-02]
mat_Sqrt:  [[ 1.78821182e+01  0.00000000e+00]
 [-6.73393737e-03  1.54293889e-02]]
grads:  [ 2.79296157e-02 -4.39898448e+01]
Stock Position:  0.027929615713910942
Bond Position:  [4.20395085]


portfolio before change:  [7.2228152]
curr_Stock_Price:  108.06947190154672
curr_Factors:  [1.08069472e+02 2.88119480e-02]
mat_Sqrt:  [[ 1.83438014e+01  0.00000000e+00]
 [-6.78963303e-03  1.55570037e-02]]
grads:  [-1.96665745e-02  5.98922149e+01]
Stock Position:  -0.019666574456725792
Bond Position:  [9.34817152]


portfolio before change:  [7.2046962]
curr_Stock_Price:  109.05020171456236
curr_Factors:  [1.09050202e+02 2.80780156e-02]
mat_Sqrt:  [[ 1.82729926e+01  0.00000000e+00]
 [-6.70259838e-03  1.53575822e-02]]
grads:  [ 0.00398265 -1.06006853]
Stock Position:  0.0039826489092260765
Bond Position:  [6.77038753]


portfolio before change:  [7.20880431]
curr_Stock_Price:  109.86919472667635
curr_Factors:  [1.09869195e+02 2.88051849e-02]
mat_Sqrt:  [[ 1.86470989e+01  0.00000000e+00]
 [-6.78883612e-03  1.55551777e-02]]
grads:  [-0.00432265 -3.23230503]
Stock Position:  -0.00432265490748325
Bond Position:  [7.68373093]


portfolio before change:  [7.21165653]
curr_Stock_Price:  109.43157153311
curr_Factors:  [1.09431572e+02 2.95207595e-02]
mat_Sqrt:  [[ 1.88021018e+01  0.00000000e+00]
 [-6.87264252e-03  1.57472023e-02]]
grads:  [ 4.00982682e-03 -6.85686539e+00]
Stock Position:  0.004009826819364751
Bond Position:  [6.77285488]


portfolio before change:  [7.20746308]
curr_Stock_Price:  108.17462986219009
curr_Factors:  [1.08174630e+02 3.02672911e-02]
mat_Sqrt:  [[ 1.88196783e+01  0.00000000e+00]
 [-6.95899891e-03  1.59450696e-02]]
grads:  [ 0.00479971 -4.03361722]
Stock Position:  0.0047997050335533515
Bond Position:  [6.68825676]


portfolio before change:  [7.2051634]
curr_Stock_Price:  107.52130747879166
curr_Factors:  [1.07521307e+02 3.02800618e-02]
mat_Sqrt:  [[ 1.87099624e+01  0.00000000e+00]
 [-6.96046686e-03  1.59484331e-02]]
grads:  [ 0.01161502 -1.13239034]
Stock Position:  0.011615015440202036
Bond Position:  [5.95630176]


portfolio before change:  [7.18965654]
curr_Stock_Price:  106.12213194798943
curr_Factors:  [1.06122132e+02 2.99375690e-02]
mat_Sqrt:  [[ 1.83617568e+01  0.00000000e+00]
 [-6.92099056e-03  1.58579816e-02]]
grads:  [ 0.01929818 17.43647338]
Stock Position:  0.019298175278373464
Bond Position:  [5.14169304]


portfolio before change:  [7.19873527]
curr_Stock_Price:  106.55927061414474
curr_Factors:  [1.06559271e+02 2.95916201e-02]
mat_Sqrt:  [[ 1.83305548e+01  0.00000000e+00]
 [-6.88088600e-03  1.57660905e-02]]
grads:  [0.01290417 1.84438264]
Stock Position:  0.012904165723107883
Bond Position:  [5.82367679]


portfolio before change:  [7.19968832]
curr_Stock_Price:  106.57671019093132
curr_Factors:  [1.06576710e+02 3.02655734e-02]
mat_Sqrt:  [[ 1.85411541e+01  0.00000000e+00]
 [-6.95880144e-03  1.59446172e-02]]
grads:  [ -0.01561321 -14.9030883 ]
Stock Position:  -0.015613214799556714
Bond Position:  [8.86369339]


portfolio before change:  [7.20940987]
curr_Stock_Price:  106.025028723454
curr_Factors:  [1.06025029e+02 3.12534320e-02]
mat_Sqrt:  [[ 1.87437834e+01  0.00000000e+00]
 [-7.07145609e-03  1.62027414e-02]]
grads:  [ 5.71426614e-03 -8.14729710e+00]
Stock Position:  0.005714266143329491
Bond Position:  [6.60355464]


portfolio before change:  [7.20958945]
curr_Stock_Price:  105.91199152932117
curr_Factors:  [1.05911992e+02 3.26880646e-02]
mat_Sqrt:  [[ 1.91487195e+01  0.00000000e+00]
 [-7.23193635e-03  1.65704479e-02]]
grads:  [-5.1284111e-03  1.1892176e+01]
Stock Position:  -0.005128411103316752
Bond Position:  [7.75274968]


portfolio before change:  [7.21471259]
curr_Stock_Price:  105.10199636169209
curr_Factors:  [1.05101996e+02 3.28194459e-02]
mat_Sqrt:  [[ 1.90404228e+01  0.00000000e+00]
 [-7.24645523e-03  1.66037148e-02]]
grads:  [-3.46581841e-03  7.28324734e+00]
Stock Position:  -0.0034658184097334094
Bond Position:  [7.57897702]


portfolio before change:  [7.21282099]
curr_Stock_Price:  105.92114649645077
curr_Factors:  [1.05921146e+02 3.18651087e-02]
mat_Sqrt:  [[ 1.89077728e+01  0.00000000e+00]
 [-7.14032029e-03  1.63605291e-02]]
grads:  [-5.63140415e-03  8.70846654e+00]
Stock Position:  -0.0056314041461786825
Bond Position:  [7.80930578]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.2123375]
Stock Price:  106.18035703858445
PL:  [1.03198046]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.93530303e-01  5.00482911e-01]
 [-1.76404684e-01 -7.88741164e-02]
 [ 8.33442538e-01 -7.31112280e-01]
 [-4.59137529e-02  6.59137257e-02]
 [ 2.16504656e-02 -5.30479475e-03]
 [-8.20902395e-02 -6.32958929e-02]
 [-1.62276827e-03  3.22895171e-01]
 [ 1.70429675e-01 -1.82061196e-02]
 [ 1.22040783e-01  8.41219332e-02]
 [ 3.10918401e-01 -1.44091799e-01]
 [ 6.88907613e-02  1.73266713e-02]
 [-1.49532987e-01 -1.32771608e-01]
 [-6.69653133e-02  1.24794977e-01]
 [-4.35897692e-01 -5.67480845e-01]
 [ 8.04674655e-02  2.25699576e-01]
 [ 5.29994663e-02 -1.97667790e-02]
 [-5.17416058e-02  2.01571299e-01]
 [ 3.37775149e-02  5.57151099e-02]
 [ 1.59162854e-02  4.06022830e-02]
 [ 1.49148996e-01 -1.03153836e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 2.91599697e-02  1.81903865e-01]
 [ 1.39227337e-02  7.75882427e-02]
 [-6.04777440e-02  5.70264675e-02]
 [ 5.63212361e-02  1.22588682e-01]
 [ 4.53694937e-02  1.19995395e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.53814973e-01  7.73704424e-02]
 [-3.83579589e-01  5.47903041e-02]
 [ 2.89616083e-01 -9.81943361e-02]
 [-1.72040211e+00 -1.93584730e-01]
 [ 3.75695886e-01  6.84043325e-01]
 [ 7.87875149e-02 -1.58203903e-01]
 [ 2.42201741e-01 -4.62829339e-02]
 [ 2.95394371e-02  1.79349180e-01]
 [-2.60798617e+00  2.15449861e-01]
 [-1.36212718e-01  9.41241527e-02]
 [-1.34943206e-01 -1.98606040e-01]
 [ 1.42593659e+00 -7.11245109e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.30814401]
curr_Stock_Price:  100.54227079511054
curr_Factors:  [1.00542271e+02 4.14075427e-02]
mat_Sqrt:  [[ 2.04591892e+01  0.00000000e+00]
 [-8.13953735e-03  1.86500230e-02]]
grads:  [2.01356441e-02 2.68355117e+01]
Stock Position:  0.020135644129549792
Bond Position:  [4.28366063]


portfolio before change:  [6.30657816]
curr_Stock_Price:  100.4379111724316
curr_Factors:  [1.00437911e+02 4.19862470e-02]
mat_Sqrt:  [[ 2.05802763e+01  0.00000000e+00]
 [-8.19621835e-03  1.87798955e-02]]
grads:  [-0.01024419 -4.19992307]
Stock Position:  -0.010244185637827107
Bond Position:  [7.33548276]


portfolio before change:  [6.32204794]
curr_Stock_Price:  99.01732097279658
curr_Factors:  [9.90173210e+01 4.29080077e-02]
mat_Sqrt:  [[ 2.05106936e+01  0.00000000e+00]
 [-8.28569927e-03  1.89849220e-02]]
grads:  [ 2.50776005e-02 -3.85101544e+01]
Stock Position:  0.025077600466272002
Bond Position:  [3.83893112]


portfolio before change:  [6.3319306]
curr_Stock_Price:  99.3922676366184
curr_Factors:  [9.93922676e+01 4.37453828e-02]
mat_Sqrt:  [[ 2.07882873e+01  0.00000000e+00]
 [-8.36615877e-03  1.91692779e-02]]
grads:  [-8.24822381e-04  3.43850853e+00]
Stock Position:  -0.0008248223812520513
Bond Position:  [6.41391156]


portfolio before change:  [6.33275118]
curr_Stock_Price:  99.36948368592643
curr_Factors:  [9.93694837e+01 4.33164638e-02]
mat_Sqrt:  [[ 2.06813808e+01  0.00000000e+00]
 [-8.32504307e-03  1.90750700e-02]]
grads:  [ 0.00093491 -0.27810093]
Stock Position:  0.000934911626603067
Bond Position:  [6.23984949]


portfolio before change:  [6.33459333]
curr_Stock_Price:  100.50555480133522
curr_Factors:  [1.00505555e+02 4.48754877e-02]
mat_Sqrt:  [[ 2.12909312e+01  0.00000000e+00]
 [-8.47353411e-03  1.94153057e-02]]
grads:  [-0.00515313 -3.26010282]
Stock Position:  -0.005153125104207423
Bond Position:  [6.85251103]


portfolio before change:  [6.3339921]
curr_Stock_Price:  100.78846173867468
curr_Factors:  [1.00788462e+02 4.33572044e-02]
mat_Sqrt:  [[ 2.09865695e+01  0.00000000e+00]
 [-8.32895714e-03  1.90840383e-02]]
grads:  [6.63758973e-03 1.69196460e+01]
Stock Position:  0.0066375897324135805
Bond Position:  [5.66499964]


portfolio before change:  [6.33184313]
curr_Stock_Price:  100.35801365286997
curr_Factors:  [1.00358014e+02 4.43074181e-02]
mat_Sqrt:  [[ 2.11246868e+01  0.00000000e+00]
 [-8.41973093e-03  1.92920272e-02]]
grads:  [ 0.00769166 -0.94371211]
Stock Position:  0.007691658341148397
Bond Position:  [5.55992358]


portfolio before change:  [6.34138428]
curr_Stock_Price:  101.50810595103474
curr_Factors:  [1.01508106e+02 4.47342923e-02]
mat_Sqrt:  [[ 2.14694545e+01  0.00000000e+00]
 [-8.46019313e-03  1.93847377e-02]]
grads:  [0.00739444 4.33959616]
Stock Position:  0.007394440543412432
Bond Position:  [5.59078863]


portfolio before change:  [6.33768108]
curr_Stock_Price:  100.9127812277358
curr_Factors:  [1.00912781e+02 4.60996624e-02]
mat_Sqrt:  [[ 2.16668137e+01  0.00000000e+00]
 [-8.58833277e-03  1.96783425e-02]]
grads:  [ 0.01144753 -7.32235448]
Stock Position:  0.011447533927889246
Bond Position:  [5.18247859]


portfolio before change:  [6.34001787]
curr_Stock_Price:  101.06031863111498
curr_Factors:  [1.01060319e+02 4.70323807e-02]
mat_Sqrt:  [[ 2.19169009e+01  0.00000000e+00]
 [-8.67478006e-03  1.98764181e-02]]
grads:  [0.0034883 0.87172  ]
Stock Position:  0.0034883006879118422
Bond Position:  [5.98748909]


portfolio before change:  [6.3415604]
curr_Stock_Price:  101.2879515748826
curr_Factors:  [1.01287952e+02 4.56299948e-02]
mat_Sqrt:  [[ 2.16363002e+01  0.00000000e+00]
 [-8.54447141e-03  1.95778435e-02]]
grads:  [-0.00958941 -6.78172791]
Stock Position:  -0.00958940600697302
Bond Position:  [7.31285169]


portfolio before change:  [6.34855492]
curr_Stock_Price:  100.65388207793883
curr_Factors:  [1.00653882e+02 4.51748899e-02]
mat_Sqrt:  [[ 2.13933640e+01  0.00000000e+00]
 [-8.50175416e-03  1.94799660e-02]]
grads:  [-5.84308299e-04  6.40632416e+00]
Stock Position:  -0.0005843082986659514
Bond Position:  [6.40736782]


portfolio before change:  [6.34925913]
curr_Stock_Price:  100.81948187928886
curr_Factors:  [1.00819482e+02 4.30330078e-02]
mat_Sqrt:  [[ 2.09143953e+01  0.00000000e+00]
 [-8.29775949e-03  1.90125555e-02]]
grads:  [ -0.03268403 -29.84768909]
Stock Position:  -0.032684025882004475
Bond Position:  [9.64444568]


portfolio before change:  [6.38657079]
curr_Stock_Price:  99.71478221382134
curr_Factors:  [9.97147822e+01 4.53306049e-02]
mat_Sqrt:  [[ 2.12302595e+01  0.00000000e+00]
 [-8.51639407e-03  1.95135102e-02]]
grads:  [8.42998816e-03 1.15663237e+01]
Stock Position:  0.00842998816479279
Bond Position:  [5.54597636]


portfolio before change:  [6.38629627]
curr_Stock_Price:  99.59997605148348
curr_Factors:  [9.95999761e+01 4.60422862e-02]
mat_Sqrt:  [[ 2.13716313e+01  0.00000000e+00]
 [-8.58298654e-03  1.96660927e-02]]
grads:  [ 0.00207624 -1.00511979]
Stock Position:  0.002076235358219966
Bond Position:  [6.17950327]


portfolio before change:  [6.38773205]
curr_Stock_Price:  99.91944771761094
curr_Factors:  [9.99194477e+01 4.61710319e-02]
mat_Sqrt:  [[ 2.14701370e+01  0.00000000e+00]
 [-8.59497825e-03  1.96935692e-02]]
grads:  [1.68752168e-03 1.02353868e+01]
Stock Position:  0.0016875216752593202
Bond Position:  [6.21911582]


portfolio before change:  [6.3844041]
curr_Stock_Price:  97.486654954188
curr_Factors:  [9.74866550e+01 4.69085085e-02]
mat_Sqrt:  [[ 2.11140225e+01  0.00000000e+00]
 [-8.66334887e-03  1.98502260e-02]]
grads:  [2.75142182e-03 2.80677459e+00]
Stock Position:  0.002751421824053929
Bond Position:  [6.11617719]


portfolio before change:  [6.38481894]
curr_Stock_Price:  97.35954825279381
curr_Factors:  [9.73595483e+01 4.68302726e-02]
mat_Sqrt:  [[ 2.10689015e+01  0.00000000e+00]
 [-8.65612132e-03  1.98336656e-02]]
grads:  [1.59650347e-03 2.04713964e+00]
Stock Position:  0.0015965034729802216
Bond Position:  [6.22938409]


portfolio before change:  [6.38561024]
curr_Stock_Price:  97.36742720383158
curr_Factors:  [9.73674272e+01 4.69935082e-02]
mat_Sqrt:  [[ 2.11072974e+01  0.00000000e+00]
 [-8.67119445e-03  1.98682025e-02]]
grads:  [ 4.93331617e-03 -5.19190582e+00]
Stock Position:  0.004933316173045684
Bond Position:  [5.90526594]


portfolio before change:  [6.38591267]
curr_Stock_Price:  97.27909339286587
curr_Factors:  [9.72790934e+01 4.68648886e-02]
mat_Sqrt:  [[ 2.10592698e+01  0.00000000e+00]
 [-8.65931994e-03  1.98409945e-02]]
grads:  [ 0.00200048 -1.9040371 ]
Stock Position:  0.002000478220765217
Bond Position:  [6.19130796]


portfolio before change:  [6.38379378]
curr_Stock_Price:  95.83301519165688
curr_Factors:  [9.58330152e+01 4.83585242e-02]
mat_Sqrt:  [[ 2.10742279e+01  0.00000000e+00]
 [-8.79622867e-03  2.01546918e-02]]
grads:  [5.15080911e-03 9.02538556e+00]
Stock Position:  0.005150809106057903
Bond Position:  [5.89017622]


portfolio before change:  [6.38183673]
curr_Stock_Price:  95.31011225921654
curr_Factors:  [9.53101123e+01 4.86600645e-02]
mat_Sqrt:  [[ 2.10244828e+01  0.00000000e+00]
 [-8.82361056e-03  2.02174316e-02]]
grads:  [2.27282732e-03 3.83769037e+00]
Stock Position:  0.0022728273202729855
Bond Position:  [6.1652133]


portfolio before change:  [6.38399957]
curr_Stock_Price:  95.92262886341457
curr_Factors:  [9.59226289e+01 4.76617897e-02]
mat_Sqrt:  [[ 2.09414257e+01  0.00000000e+00]
 [-8.73263211e-03  2.00089738e-02]]
grads:  [-1.69947136e-03  2.85004459e+00]
Stock Position:  -0.0016994713570496554
Bond Position:  [6.54701733]


portfolio before change:  [6.3837207]
curr_Stock_Price:  96.5682981264682
curr_Factors:  [9.65682981e+01 4.80562562e-02]
mat_Sqrt:  [[ 2.11694485e+01  0.00000000e+00]
 [-8.76869489e-03  2.00916040e-02]]
grads:  [5.18782163e-03 6.10148803e+00]
Stock Position:  0.005187821627878116
Bond Position:  [5.8827416]


portfolio before change:  [6.37862218]
curr_Stock_Price:  95.44375744887738
curr_Factors:  [9.54437574e+01 4.91835662e-02]
mat_Sqrt:  [[ 2.11669136e+01  0.00000000e+00]
 [-8.87094730e-03  2.03258937e-02]]
grads:  [4.61757343e-03 5.90357289e+00]
Stock Position:  0.004617573434278501
Bond Position:  [5.93790362]


portfolio before change:  [6.37234241]
curr_Stock_Price:  93.9230348786659
curr_Factors:  [9.39230349e+01 4.83297115e-02]
mat_Sqrt:  [[ 2.06480583e+01  0.00000000e+00]
 [-8.79360781e-03  2.01486867e-02]]
grads:  [8.62849172e-03 8.68232242e+00]
Stock Position:  0.008628491718823588
Bond Position:  [5.56192828]


portfolio before change:  [6.35948901]
curr_Stock_Price:  92.35280799436023
curr_Factors:  [9.2352808e+01 4.8617418e-02]
mat_Sqrt:  [[ 2.03632011e+01  0.00000000e+00]
 [-8.81974312e-03  2.02085702e-02]]
grads:  [-0.00589533  3.82859557]
Stock Position:  -0.005895327718326539
Bond Position:  [6.90393908]


portfolio before change:  [6.35357527]
curr_Stock_Price:  93.50232600033937
curr_Factors:  [9.35023260e+01 4.74253551e-02]
mat_Sqrt:  [[ 2.03623412e+01  0.00000000e+00]
 [-8.71094531e-03  1.99592831e-02]]
grads:  [-0.01766335  2.74510381]
Stock Position:  -0.017663349062437706
Bond Position:  [8.00513949]


portfolio before change:  [6.40426795]
curr_Stock_Price:  90.68904461996536
curr_Factors:  [9.06890446e+01 4.74826102e-02]
mat_Sqrt:  [[ 1.97616007e+01  0.00000000e+00]
 [-8.71620194e-03  1.99713276e-02]]
grads:  [ 0.01248687 -4.91676558]
Stock Position:  0.01248687114616302
Bond Position:  [5.27184553]


portfolio before change:  [6.3898334]
curr_Stock_Price:  89.48029008764986
curr_Factors:  [8.94802901e+01 4.83232633e-02]
mat_Sqrt:  [[ 1.96700521e+01  0.00000000e+00]
 [-8.79302116e-03  2.01473425e-02]]
grads:  [-0.09175824 -9.60844981]
Stock Position:  -0.09175824259902225
Bond Position:  [14.60038757]


portfolio before change:  [6.49781441]
curr_Stock_Price:  88.3233820862571
curr_Factors:  [8.83233821e+01 4.79897377e-02]
mat_Sqrt:  [[ 1.93486148e+01  0.00000000e+00]
 [-8.76262405e-03  2.00776940e-02]]
grads:  [ 0.03484678 34.06981524]
Stock Position:  0.03484677714432736
Bond Position:  [3.4200292]


portfolio before change:  [6.47723915]
curr_Stock_Price:  87.72066358955199
curr_Factors:  [8.77206636e+01 4.74296455e-02]
mat_Sqrt:  [[ 1.91041117e+01  0.00000000e+00]
 [-8.71133932e-03  1.99601859e-02]]
grads:  [ 5.09925354e-04 -7.92597343e+00]
Stock Position:  0.0005099253539109359
Bond Position:  [6.43250816]


portfolio before change:  [6.47782977]
curr_Stock_Price:  87.30199958749317
curr_Factors:  [8.73019996e+01 4.75237418e-02]
mat_Sqrt:  [[ 1.90317842e+01  0.00000000e+00]
 [-8.71997631e-03  1.99799758e-02]]
grads:  [ 0.01166481 -2.31646597]
Stock Position:  0.011664813454232903
Bond Position:  [5.45946823]


portfolio before change:  [6.48206921]
curr_Stock_Price:  87.6069302283802
curr_Factors:  [8.76069302e+01 4.67133743e-02]
mat_Sqrt:  [[ 1.89347285e+01  0.00000000e+00]
 [-8.64531080e-03  1.98088956e-02]]
grads:  [5.69397318e-03 9.05397169e+00]
Stock Position:  0.005693973184582471
Bond Position:  [5.9832377]


portfolio before change:  [6.48996114]
curr_Stock_Price:  88.86158700322176
curr_Factors:  [8.88615870e+01 4.70748163e-02]
mat_Sqrt:  [[ 1.92800601e+01  0.00000000e+00]
 [-8.67869265e-03  1.98853830e-02]]
grads:  [-0.13039151 10.83458445]
Stock Position:  -0.13039150968839794
Bond Position:  [18.07675762]


portfolio before change:  [6.37599946]
curr_Stock_Price:  89.75291354186585
curr_Factors:  [8.97529135e+01 4.79104148e-02]
mat_Sqrt:  [[ 1.96455196e+01  0.00000000e+00]
 [-8.75537913e-03  2.00610938e-02]]
grads:  [-0.00484251  4.69187541]
Stock Position:  -0.004842507195873916
Bond Position:  [6.81062859]


portfolio before change:  [6.37682517]
curr_Stock_Price:  89.7582160340059
curr_Factors:  [8.97582160e+01 4.81589973e-02]
mat_Sqrt:  [[ 1.96975826e+01  0.00000000e+00]
 [-8.77806332e-03  2.01130698e-02]]
grads:  [-0.01125123 -9.87447676]
Stock Position:  -0.011251227769199875
Bond Position:  [7.3867153]


portfolio before change:  [6.35708256]
curr_Stock_Price:  91.59499359453677
curr_Factors:  [9.15949936e+01 4.79974673e-02]
mat_Sqrt:  [[ 2.00669282e+01  0.00000000e+00]
 [-8.76332972e-03  2.00793109e-02]]
grads:  [ 0.06951215 -3.54217888]
Stock Position:  0.06951214917598211
Bond Position:  [-0.0098823]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.25667244]
Stock Price:  90.15051388199187
PL:  [6.25667244]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.89746743e-01  3.12314438e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.01383831e-01 -6.70815638e-01]
 [-2.97216468e-02  1.56732734e-01]
 [-1.33490645e-02  8.70236231e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-5.06196593e-02  1.93270476e-01]
 [ 2.60980978e-02 -1.35175852e-01]
 [ 1.65802158e-01  1.07366433e-01]
 [ 1.65148453e-01 -7.78077772e-04]
 [ 1.39529182e-01  2.67923695e-01]
 [-6.21288176e-02  5.92538594e-02]
 [ 1.59595631e-01  3.78483244e-02]
 [-1.87792955e-01 -2.36131628e-01]
 [ 8.75245848e-02  2.31324101e-01]
 [ 4.59866280e-02  5.57737282e-02]
 [ 3.58088622e-02  3.69398069e-02]
 [ 7.26166891e-02  6.25124150e-02]
 [ 8.48876469e-03  5.22934314e-02]
 [ 2.55255047e-01 -1.09900920e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 5.71376087e-03  1.48378842e-01]
 [ 1.98206650e-02  1.11396559e-01]
 [-2.99998172e-02 -1.64870773e-03]
 [ 3.96790089e-02  1.58980680e-01]
 [ 3.80681778e-02  1.74540675e-01]
 [ 2.49167992e-02  1.61493801e-01]
 [-1.42259528e-01  5.13692343e-02]
 [-5.57037594e-01  1.29400973e-01]
 [ 2.92642211e-01 -6.18998371e-03]
 [-1.81419851e+00 -2.04181209e-01]
 [ 3.66218906e-01  6.66728430e-01]
 [ 4.65447994e-02 -1.47252700e-01]
 [ 5.67859639e-02  3.16629349e-02]
 [-5.97768204e-03  1.73220960e-01]
 [-2.13860655e+00  2.10063979e-02]
 [-1.06470398e-01  1.55459980e-01]
 [-1.35149694e-01  2.98381262e-02]
 [ 1.31242101e+00 -5.63824480e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.6475726]
curr_Stock_Price:  99.19339492172821
curr_Factors:  [9.91933949e+01 4.08206536e-02]
mat_Sqrt:  [[ 2.00411543e+01  0.00000000e+00]
 [-8.08164870e-03  1.85173835e-02]]
grads:  [-0.00878773  1.68660134]
Stock Position:  -0.008787728529975152
Bond Position:  [-1.77588797]


portfolio before change:  [-2.65166451]
curr_Stock_Price:  99.63377206239636
curr_Factors:  [9.96337721e+01 4.00269433e-02]
mat_Sqrt:  [[ 1.99334644e+01  0.00000000e+00]
 [-8.00269388e-03  1.83364752e-02]]
grads:  [-0.0101831  -4.79979762]
Stock Position:  -0.010183099309372333
Bond Position:  [-1.63708392]


portfolio before change:  [-2.6571027]
curr_Stock_Price:  100.14771611167873
curr_Factors:  [1.00147716e+02 4.06034674e-02]
mat_Sqrt:  [[ 2.01800673e+01  0.00000000e+00]
 [-8.06012084e-03  1.84680569e-02]]
grads:  [ 2.52038745e-02 -3.63230220e+01]
Stock Position:  0.025203874490828886
Bond Position:  [-5.18121317]


portfolio before change:  [-2.71042807]
curr_Stock_Price:  98.05765371873167
curr_Factors:  [9.80576537e+01 4.12368778e-02]
mat_Sqrt:  [[ 1.99124356e+01  0.00000000e+00]
 [-8.12274612e-03  1.86115495e-02]]
grads:  [1.94261149e-03 8.42126199e+00]
Stock Position:  0.001942611488968742
Bond Position:  [-2.90091599]


portfolio before change:  [-2.7070687]
curr_Stock_Price:  99.97363435053
curr_Factors:  [9.99736344e+01 4.06985387e-02]
mat_Sqrt:  [[ 2.01685599e+01  0.00000000e+00]
 [-8.06955153e-03  1.84896654e-02]]
grads:  [-0.00047356  0.47066089]
Stock Position:  -0.0004735609425017263
Bond Position:  [-2.65972509]


portfolio before change:  [-2.70710963]
curr_Stock_Price:  99.35796537650334
curr_Factors:  [9.93579654e+01 3.98299081e-02]
mat_Sqrt:  [[ 1.98292981e+01  0.00000000e+00]
 [-7.98297269e-03  1.82912883e-02]]
grads:  [-0.00597201 -3.62560181]
Stock Position:  -0.0059720102575202124
Bond Position:  [-2.11374284]


portfolio before change:  [-2.70392241]
curr_Stock_Price:  98.78002753884346
curr_Factors:  [9.87800275e+01 3.96631865e-02]
mat_Sqrt:  [[ 1.96726536e+01  0.00000000e+00]
 [-7.96624745e-03  1.82529660e-02]]
grads:  [1.71458780e-03 1.05884423e+01]
Stock Position:  0.001714587803364471
Bond Position:  [-2.87328944]


portfolio before change:  [-2.70821238]
curr_Stock_Price:  96.48747033315705
curr_Factors:  [9.64874703e+01 4.10913491e-02]
mat_Sqrt:  [[ 1.95589763e+01  0.00000000e+00]
 [-8.10840049e-03  1.85786795e-02]]
grads:  [-1.68196332e-03 -7.27585897e+00]
Stock Position:  -0.0016819633155432691
Bond Position:  [-2.545924]


portfolio before change:  [-2.71000931]
curr_Stock_Price:  97.36659962385204
curr_Factors:  [9.73665996e+01 4.08504666e-02]
mat_Sqrt:  [[ 1.96792487e+01  0.00000000e+00]
 [-8.08459934e-03  1.85241442e-02]]
grads:  [0.01080634 5.79602663]
Stock Position:  0.010806342984972371
Bond Position:  [-3.76218618]


portfolio before change:  [-2.69711134]
curr_Stock_Price:  98.60367570533748
curr_Factors:  [9.86036757e+01 4.20478048e-02]
mat_Sqrt:  [[ 2.02192373e+01  0.00000000e+00]
 [-8.20222456e-03  1.87936574e-02]]
grads:  [ 0.00815109 -0.04140108]
Stock Position:  0.008151092460145563
Bond Position:  [-3.50083902]


portfolio before change:  [-2.7054004]
curr_Stock_Price:  97.64044010198214
curr_Factors:  [9.76404401e+01 4.19970370e-02]
mat_Sqrt:  [[ 2.00096298e+01  0.00000000e+00]
 [-8.19727145e-03  1.87823085e-02]]
grads:  [1.28168623e-02 1.42646840e+01]
Stock Position:  0.012816862269049987
Bond Position:  [-3.95684447]


portfolio before change:  [-2.68035385]
curr_Stock_Price:  99.63321948759999
curr_Factors:  [9.96332195e+01 4.11568026e-02]
mat_Sqrt:  [[ 2.02127301e+01  0.00000000e+00]
 [-8.11485577e-03  1.85934704e-02]]
grads:  [-1.79433026e-03  3.18681011e+00]
Stock Position:  -0.0017943302557611514
Bond Position:  [-2.50157895]


portfolio before change:  [-2.67841354]
curr_Stock_Price:  98.37757891345144
curr_Factors:  [9.83775789e+01 4.23327324e-02]
mat_Sqrt:  [[ 2.02411079e+01  0.00000000e+00]
 [-8.22996791e-03  1.88572255e-02]]
grads:  [0.00870081 2.00709932]
Stock Position:  0.008700808007592785
Bond Position:  [-3.53437796]


portfolio before change:  [-2.6860455]
curr_Stock_Price:  97.55120304881905
curr_Factors:  [9.75512030e+01 4.28572659e-02]
mat_Sqrt:  [[ 2.01950466e+01  0.00000000e+00]
 [-8.28079860e-03  1.89736932e-02]]
grads:  [ -0.01440201 -12.44521164]
Stock Position:  -0.014402009126314707
Bond Position:  [-1.28111218]


portfolio before change:  [-2.69027793]
curr_Stock_Price:  97.83396096485926
curr_Factors:  [9.78339610e+01 4.29674779e-02]
mat_Sqrt:  [[ 2.02796086e+01  0.00000000e+00]
 [-8.29143924e-03  1.89980740e-02]]
grads:  [9.2941981e-03 1.2176187e+01]
Stock Position:  0.009294198104697378
Bond Position:  [-3.59956615]


portfolio before change:  [-2.70171726]
curr_Stock_Price:  96.65157273369789
curr_Factors:  [9.66515727e+01 4.41168692e-02]
mat_Sqrt:  [[ 2.03007119e+01  0.00000000e+00]
 [-8.40160644e-03  1.92504987e-02]]
grads:  [0.00346433 2.89726147]
Stock Position:  0.003464325732631224
Bond Position:  [-3.03654979]


portfolio before change:  [-2.70271588]
curr_Stock_Price:  96.47288520278727
curr_Factors:  [9.64728852e+01 4.46445636e-02]
mat_Sqrt:  [[ 2.03840069e+01  0.00000000e+00]
 [-8.45170408e-03  1.93652868e-02]]
grads:  [0.00254762 1.90752697]
Stock Position:  0.002547620583832505
Bond Position:  [-2.94849219]


portfolio before change:  [-2.70383586]
curr_Stock_Price:  96.17794538017253
curr_Factors:  [9.61779454e+01 4.51936873e-02]
mat_Sqrt:  [[ 2.04462837e+01  0.00000000e+00]
 [-8.50352278e-03  1.94840184e-02]]
grads:  [0.00488594 3.20839437]
Stock Position:  0.004885941378851042
Bond Position:  [-3.17375566]


portfolio before change:  [-2.70243639]
curr_Stock_Price:  96.54557435958581
curr_Factors:  [9.65455744e+01 4.57510561e-02]
mat_Sqrt:  [[ 2.06506123e+01  0.00000000e+00]
 [-8.55579860e-03  1.96037974e-02]]
grads:  [1.51624992e-03 2.66751540e+00]
Stock Position:  0.0015162499227088576
Bond Position:  [-2.84882361]


portfolio before change:  [-2.70391451]
curr_Stock_Price:  95.80559278802266
curr_Factors:  [9.58055928e+01 4.66658816e-02]
mat_Sqrt:  [[ 2.06961994e+01  0.00000000e+00]
 [-8.64091491e-03  1.97988233e-02]]
grads:  [ 0.01001587 -5.55088137]
Stock Position:  0.010015865701325259
Bond Position:  [-3.66349046]


portfolio before change:  [-2.72069173]
curr_Stock_Price:  94.17625233311293
curr_Factors:  [9.41762523e+01 4.67757557e-02]
mat_Sqrt:  [[ 2.03681606e+01  0.00000000e+00]
 [-8.65108138e-03  1.98221176e-02]]
grads:  [ 0.00206836 -1.90585034]
Stock Position:  0.0020683561707256918
Bond Position:  [-2.91548176]


portfolio before change:  [-2.71939992]
curr_Stock_Price:  94.97701960305983
curr_Factors:  [9.49770196e+01 4.80616768e-02]
mat_Sqrt:  [[ 2.08217869e+01  0.00000000e+00]
 [-8.76918941e-03  2.00927371e-02]]
grads:  [3.38451243e-03 7.38470029e+00]
Stock Position:  0.0033845124301223333
Bond Position:  [-3.04085082]


portfolio before change:  [-2.71693543]
curr_Stock_Price:  95.81750199398121
curr_Factors:  [9.58175020e+01 4.72393446e-02]
mat_Sqrt:  [[ 2.08255642e+01  0.00000000e+00]
 [-8.69384560e-03  1.99201028e-02]]
grads:  [3.28625474e-03 5.59216787e+00]
Stock Position:  0.003286254739890754
Bond Position:  [-3.03181615]


portfolio before change:  [-2.72021187]
curr_Stock_Price:  94.9358168556796
curr_Factors:  [9.49358169e+01 4.65891118e-02]
mat_Sqrt:  [[ 2.04914319e+01  0.00000000e+00]
 [-8.63380442e-03  1.97825312e-02]]
grads:  [-0.00149913 -0.0833416 ]
Stock Position:  -0.0014991325335080598
Bond Position:  [-2.5778905]


portfolio before change:  [-2.71865876]
curr_Stock_Price:  93.68485145826384
curr_Factors:  [9.36848515e+01 4.75194057e-02]
mat_Sqrt:  [[ 2.04223104e+01  0.00000000e+00]
 [-8.71957850e-03  1.99790642e-02]]
grads:  [5.34042740e-03 7.95736366e+00]
Stock Position:  0.00534042739813922
Bond Position:  [-3.21897591]


portfolio before change:  [-2.72951904]
curr_Stock_Price:  91.72660429990646
curr_Factors:  [9.17266043e+01 4.68884072e-02]
mat_Sqrt:  [[ 1.98622323e+01  0.00000000e+00]
 [-8.66149245e-03  1.98459724e-02]]
grads:  [5.75181942e-03 8.79476557e+00]
Stock Position:  0.005751819424244248
Bond Position:  [-3.2571139]


portfolio before change:  [-2.73419941]
curr_Stock_Price:  90.98367204040541
curr_Factors:  [9.09836720e+01 4.54093923e-02]
mat_Sqrt:  [[ 1.93881471e+01  0.00000000e+00]
 [-8.52379186e-03  1.95304607e-02]]
grads:  [4.92045331e-03 8.26881679e+00]
Stock Position:  0.004920453306650659
Bond Position:  [-3.18188032]


portfolio before change:  [-2.73995539]
curr_Stock_Price:  89.89470318421957
curr_Factors:  [8.98947032e+01 4.63361643e-02]
mat_Sqrt:  [[ 1.93505869e+01  0.00000000e+00]
 [-8.61033465e-03  1.97287551e-02]]
grads:  [-0.0061931   2.60377474]
Stock Position:  -0.006193101862091864
Bond Position:  [-2.18322834]


portfolio before change:  [-2.74388818]
curr_Stock_Price:  90.485661221544
curr_Factors:  [9.04856612e+01 4.72536752e-02]
mat_Sqrt:  [[ 1.96696920e+01  0.00000000e+00]
 [-8.69516420e-03  1.99231241e-02]]
grads:  [-0.02544841  6.49501417]
Stock Position:  -0.025448409588353798
Bond Position:  [-0.44117201]


portfolio before change:  [-2.71877108]
curr_Stock_Price:  89.49651313115412
curr_Factors:  [8.94965131e+01 4.79978573e-02]
mat_Sqrt:  [[ 1.96072660e+01  0.00000000e+00]
 [-8.76336532e-03  2.00793925e-02]]
grads:  [ 0.01478741 -0.30827545]
Stock Position:  0.01478740997829131
Bond Position:  [-4.04219271]


portfolio before change:  [-2.7332621]
curr_Stock_Price:  88.55072781313773
curr_Factors:  [8.85507278e+01 5.06317408e-02]
mat_Sqrt:  [[ 1.99252402e+01  0.00000000e+00]
 [-9.00059916e-03  2.06229635e-02]]
grads:  [-0.09552259 -9.90067256]
Stock Position:  -0.09552258750485113
Bond Position:  [5.72533254]


portfolio before change:  [-2.74951413]
curr_Stock_Price:  88.72835842339754
curr_Factors:  [8.87283584e+01 5.14833215e-02]
mat_Sqrt:  [[ 2.01324081e+01  0.00000000e+00]
 [-9.07597457e-03  2.07956702e-02]]
grads:  [ 0.03264404 32.06092531]
Stock Position:  0.03264403568446181
Bond Position:  [-5.64596582]


portfolio before change:  [-2.71122921]
curr_Stock_Price:  89.92277896853527
curr_Factors:  [8.99227790e+01 5.23105585e-02]
mat_Sqrt:  [[ 2.05666898e+01  0.00000000e+00]
 [-9.14860064e-03  2.09620775e-02]]
grads:  [-8.61662606e-04 -7.02471880e+00]
Stock Position:  -0.0008616626059770832
Bond Position:  [-2.63374611]


portfolio before change:  [-2.71267896]
curr_Stock_Price:  91.2231869403425
curr_Factors:  [9.12231869e+01 5.15521249e-02]
mat_Sqrt:  [[ 2.07123094e+01  0.00000000e+00]
 [-9.08203721e-03  2.08095615e-02]]
grads:  [0.00340883 1.52155705]
Stock Position:  0.0034088328852941415
Bond Position:  [-3.02364356]


portfolio before change:  [-2.71449696]
curr_Stock_Price:  90.80074949993222
curr_Factors:  [9.08007495e+01 5.21148263e-02]
mat_Sqrt:  [[ 2.07286052e+01  0.00000000e+00]
 [-9.13146878e-03  2.09228234e-02]]
grads:  [3.35874710e-03 8.27904324e+00]
Stock Position:  0.003358747104594085
Bond Position:  [-3.01947371]


portfolio before change:  [-2.71184208]
curr_Stock_Price:  91.70356722893898
curr_Factors:  [9.17035672e+01 5.31206997e-02]
mat_Sqrt:  [[ 2.11357724e+01  0.00000000e+00]
 [-9.21917131e-03  2.11237752e-02]]
grads:  [-0.10075045  0.99444336]
Stock Position:  -0.10075045110360362
Bond Position:  [6.52733369]


portfolio before change:  [-2.70359999]
curr_Stock_Price:  91.62985918126977
curr_Factors:  [9.16298592e+01 5.42345334e-02]
mat_Sqrt:  [[ 2.13390447e+01  0.00000000e+00]
 [-9.31532358e-03  2.13440877e-02]]
grads:  [-1.80992642e-03  7.28351486e+00]
Stock Position:  -0.0018099264180204443
Bond Position:  [-2.53775669]


portfolio before change:  [-2.70508446]
curr_Stock_Price:  92.27476301392545
curr_Factors:  [9.22747630e+01 5.06779934e-02]
mat_Sqrt:  [[ 2.07726854e+01  0.00000000e+00]
 [-9.00470929e-03  2.06323810e-02]]
grads:  [-0.00587922  1.44617949]
Stock Position:  -0.005879223893115775
Bond Position:  [-2.16258047]


portfolio before change:  [-2.70714799]
curr_Stock_Price:  92.5797680928992
curr_Factors:  [9.25797681e+01 5.07074689e-02]
mat_Sqrt:  [[ 2.08474075e+01  0.00000000e+00]
 [-9.00732759e-03  2.06383802e-02]]
grads:  [ 0.06177333 -2.73192214]
Stock Position:  0.06177332588794242
Bond Position:  [-8.42610818]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.64814715]
Stock Price:  93.55193810490911
PL:  [-2.64814715]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.01058225e-01  7.62545566e-01]
 [-1.91452661e-01 -7.61881159e-02]
 [ 8.23686522e-01 -6.85986871e-01]
 [ 5.36635224e-02  2.28340095e-02]
 [-1.40608847e-01  5.96329821e-02]
 [-1.60484671e-02  6.88597337e-03]
 [-9.75615188e-03  2.84320836e-01]
 [-5.83205413e-02 -7.46980701e-02]
 [ 1.61947299e-01  7.82624078e-02]
 [ 2.92108526e-01 -1.30953548e-01]
 [ 6.85348668e-02  1.60978277e-02]
 [-2.41450275e-02  1.19973822e-01]
 [ 1.38107095e-01  4.63783808e-02]
 [-2.68439120e-01 -3.64601114e-01]
 [ 8.00804842e-02  2.25361886e-01]
 [ 5.30626037e-02 -1.98070071e-02]
 [-4.17669973e-02  8.34996019e-02]
 [ 2.49362698e-02  5.44386692e-02]
 [ 1.38343212e-02  1.78258161e-02]
 [ 3.58171221e-01 -1.16364761e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-1.47875997e-02  1.40626289e-01]
 [ 1.50549258e-02  8.53215890e-02]
 [-6.03989657e-02  5.68748060e-02]
 [ 6.05307736e-02  1.30422231e-01]
 [ 8.96496442e-02  7.42338497e-02]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.71524549e-01  1.18348443e-01]
 [-2.71649249e-01 -8.99544678e-04]
 [ 1.92680819e-01 -9.13558905e-02]
 [-1.34522741e+00 -1.51123752e-01]
 [ 1.83374506e-01  4.19426005e-01]
 [ 1.87795980e-02 -1.37312431e-01]
 [ 3.06030186e-03  6.57767178e-02]
 [-8.73437253e-03  1.71589992e-01]
 [-2.45648776e+00  8.39288618e-02]
 [-1.36971602e-01  9.36203900e-02]
 [-1.35002728e-01 -1.37808075e-01]
 [ 1.56283008e+00 -8.88863359e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.43720328]
curr_Stock_Price:  101.31479013596707
curr_Factors:  [1.01314790e+02 3.94627149e-02]
mat_Sqrt:  [[ 2.01264106e+01  0.00000000e+00]
 [-7.94608984e-03  1.82067791e-02]]
grads:  [3.64625570e-02 4.18825078e+01]
Stock Position:  0.03646255698976235
Bond Position:  [7.74300697]


portfolio before change:  [11.44163741]
curr_Stock_Price:  101.40985191751473
curr_Factors:  [1.01409852e+02 3.98125325e-02]
mat_Sqrt:  [[ 2.02343869e+01  0.00000000e+00]
 [-7.98123123e-03  1.82872981e-02]]
grads:  [-0.01110505 -4.16617673]
Stock Position:  -0.011105050105296901
Bond Position:  [12.56779889]


portfolio before change:  [11.43681508]
curr_Stock_Price:  101.98557185505535
curr_Factors:  [1.01985572e+02 3.87399224e-02]
mat_Sqrt:  [[ 2.00732692e+01  0.00000000e+00]
 [-7.87298392e-03  1.80392724e-02]]
grads:  [ 2.61191788e-02 -3.80274135e+01]
Stock Position:  0.026119178769416204
Bond Position:  [8.7730357]


portfolio before change:  [11.4297498]
curr_Stock_Price:  101.67308178217378
curr_Factors:  [1.01673082e+02 3.89080243e-02]
mat_Sqrt:  [[ 2.00551344e+01  0.00000000e+00]
 [-7.89004682e-03  1.80783684e-02]]
grads:  [0.00317271 1.26305698]
Stock Position:  0.003172708790095006
Bond Position:  [11.10717072]


portfolio before change:  [11.43282815]
curr_Stock_Price:  102.20570972290996
curr_Factors:  [1.02205710e+02 3.77713434e-02]
mat_Sqrt:  [[ 1.98635274e+01  0.00000000e+00]
 [-7.77394040e-03  1.78123352e-02]]
grads:  [-0.00576851  3.34784752]
Stock Position:  -0.005768506137919251
Bond Position:  [12.02240242]


portfolio before change:  [11.43815075]
curr_Stock_Price:  101.54354396366433
curr_Factors:  [1.01543544e+02 3.82571081e-02]
mat_Sqrt:  [[ 1.98613327e+01  0.00000000e+00]
 [-7.82376974e-03  1.79265085e-02]]
grads:  [-0.00065671  0.38412239]
Stock Position:  -0.0006567123223077138
Bond Position:  [11.50483565]


portfolio before change:  [11.44056635]
curr_Stock_Price:  100.05521968436281
curr_Factors:  [1.00055220e+02 3.82055006e-02]
mat_Sqrt:  [[ 1.95570208e+01  0.00000000e+00]
 [-7.81849096e-03  1.79144133e-02]]
grads:  [5.84606599e-03 1.58710660e+01]
Stock Position:  0.005846065986422675
Bond Position:  [10.85563693]


portfolio before change:  [11.43577805]
curr_Stock_Price:  99.00402791316334
curr_Factors:  [9.90040279e+01 3.72523613e-02]
mat_Sqrt:  [[ 1.91086395e+01  0.00000000e+00]
 [-7.72034831e-03  1.76895403e-02]]
grads:  [-0.00475813 -4.22272535]
Stock Position:  -0.0047581331916308
Bond Position:  [11.9068524]


portfolio before change:  [11.43663079]
curr_Stock_Price:  99.13763383644994
curr_Factors:  [9.91376338e+01 3.71081607e-02]
mat_Sqrt:  [[ 1.90973568e+01  0.00000000e+00]
 [-7.70539143e-03  1.76552697e-02]]
grads:  [0.01026864 4.43280726]
Stock Position:  0.01026863639534083
Bond Position:  [10.41862247]


portfolio before change:  [11.45185805]
curr_Stock_Price:  100.49369099173633
curr_Factors:  [1.00493691e+02 3.64442989e-02]
mat_Sqrt:  [[ 1.91846375e+01  0.00000000e+00]
 [-7.63615598e-03  1.74966314e-02]]
grads:  [ 0.01224708 -7.48450058]
Stock Position:  0.012247075912040033
Bond Position:  [10.22110419]


portfolio before change:  [11.46038215]
curr_Stock_Price:  101.08537357578759
curr_Factors:  [1.01085374e+02 3.47074606e-02]
mat_Sqrt:  [[ 1.88321429e+01  0.00000000e+00]
 [-7.45197537e-03  1.70746206e-02]]
grads:  [0.00401232 0.9427927 ]
Stock Position:  0.00401231741740712
Bond Position:  [11.05479555]


portfolio before change:  [11.45429456]
curr_Stock_Price:  99.22372428880989
curr_Factors:  [9.92237243e+01 3.53190009e-02]
mat_Sqrt:  [[ 1.86474619e+01  0.00000000e+00]
 [-7.51734005e-03  1.72243899e-02]]
grads:  [1.51311965e-03 6.96534520e+00]
Stock Position:  0.0015131196462369084
Bond Position:  [11.30415719]


portfolio before change:  [11.45476132]
curr_Stock_Price:  98.59829592944882
curr_Factors:  [9.85982959e+01 3.53553554e-02]
mat_Sqrt:  [[ 1.85394571e+01  0.00000000e+00]
 [-7.52120792e-03  1.72332523e-02]]
grads:  [0.00854115 2.69121464]
Stock Position:  0.008541149760480796
Bond Position:  [10.61261851]


portfolio before change:  [11.457669]
curr_Stock_Price:  98.78340249562878
curr_Factors:  [9.87834025e+01 3.64910682e-02]
mat_Sqrt:  [[ 1.88702333e+01  0.00000000e+00]
 [-7.64105419e-03  1.75078546e-02]]
grads:  [ -0.02265812 -20.8250024 ]
Stock Position:  -0.022658124320000094
Bond Position:  [13.69591562]


portfolio before change:  [11.43580102]
curr_Stock_Price:  99.8240925129757
curr_Factors:  [9.98240925e+01 3.48276993e-02]
mat_Sqrt:  [[ 1.86293527e+01  0.00000000e+00]
 [-7.46487233e-03  1.71041713e-02]]
grads:  [9.57824343e-03 1.31758436e+01]
Stock Position:  0.009578243428653524
Bond Position:  [10.47966156]


portfolio before change:  [11.43539403]
curr_Stock_Price:  99.64482949696331
curr_Factors:  [9.96448295e+01 3.57563710e-02]
mat_Sqrt:  [[ 1.88421946e+01  0.00000000e+00]
 [-7.56374203e-03  1.73307102e-02]]
grads:  [ 0.00235737 -1.14288491]
Stock Position:  0.0023573749195682707
Bond Position:  [11.20049381]


portfolio before change:  [11.43481536]
curr_Stock_Price:  98.80541204773944
curr_Factors:  [9.88054120e+01 3.74859465e-02]
mat_Sqrt:  [[ 1.91300002e+01  0.00000000e+00]
 [-7.74451511e-03  1.77449134e-02]]
grads:  [-2.78347273e-04  4.70555140e+00]
Stock Position:  -0.00027834727330298937
Bond Position:  [11.46231758]


portfolio before change:  [11.43655907]
curr_Stock_Price:  97.68871150874288
curr_Factors:  [9.76887115e+01 3.87135095e-02]
mat_Sqrt:  [[ 1.92209856e+01  0.00000000e+00]
 [-7.87029956e-03  1.80331217e-02]]
grads:  [2.53344204e-03 3.01881560e+00]
Stock Position:  0.0025334420371219317
Bond Position:  [11.18907038]


portfolio before change:  [11.43299539]
curr_Stock_Price:  95.72995397354177
curr_Factors:  [9.57299540e+01 3.98071153e-02]
mat_Sqrt:  [[ 1.90997729e+01  0.00000000e+00]
 [-7.98068822e-03  1.82860539e-02]]
grads:  [0.00113164 0.97483121]
Stock Position:  0.0011316440895601243
Bond Position:  [11.32466315]


portfolio before change:  [11.4328002]
curr_Stock_Price:  94.30647951985061
curr_Factors:  [9.43064795e+01 4.18312134e-02]
mat_Sqrt:  [[ 1.92882028e+01  0.00000000e+00]
 [-8.18107214e-03  1.87451912e-02]]
grads:  [ 0.01593645 -6.20771266]
Stock Position:  0.0159364498117865
Bond Position:  [9.92988972]


portfolio before change:  [11.42763499]
curr_Stock_Price:  93.90447518443094
curr_Factors:  [9.39044752e+01 4.23296315e-02]
mat_Sqrt:  [[ 1.93200628e+01  0.00000000e+00]
 [-8.22966648e-03  1.88565348e-02]]
grads:  [ 0.00218056 -2.00344284]
Stock Position:  0.0021805628195076887
Bond Position:  [11.22287038]


portfolio before change:  [11.43111672]
curr_Stock_Price:  94.85780169301351
curr_Factors:  [9.48578017e+01 4.07198808e-02]
mat_Sqrt:  [[ 1.91415149e+01  0.00000000e+00]
 [-8.07166707e-03  1.84945127e-02]]
grads:  [2.43380657e-03 7.60367639e+00]
Stock Position:  0.0024338065700381314
Bond Position:  [11.20025118]


portfolio before change:  [11.43385127]
curr_Stock_Price:  95.40608829368138
curr_Factors:  [9.54060883e+01 4.09370557e-02]
mat_Sqrt:  [[ 1.93034259e+01  0.00000000e+00]
 [-8.09316311e-03  1.85437663e-02]]
grads:  [2.70896578e-03 4.60109277e+00]
Stock Position:  0.002708965780562265
Bond Position:  [11.17539944]


portfolio before change:  [11.43666067]
curr_Stock_Price:  95.92746528057802
curr_Factors:  [9.59274653e+01 4.04580456e-02]
mat_Sqrt:  [[ 1.92950283e+01  0.00000000e+00]
 [-8.04567418e-03  1.84349555e-02]]
grads:  [-1.84383070e-03  3.08516102e+00]
Stock Position:  -0.0018438306968700429
Bond Position:  [11.61353468]


portfolio before change:  [11.43769616]
curr_Stock_Price:  96.15323855860109
curr_Factors:  [9.61532386e+01 4.00360257e-02]
mat_Sqrt:  [[ 1.92393057e+01  0.00000000e+00]
 [-8.00360176e-03  1.83385554e-02]]
grads:  [6.10477859e-03 7.11191409e+00]
Stock Position:  0.006104778587574425
Bond Position:  [10.85070193]


portfolio before change:  [11.44105485]
curr_Stock_Price:  96.48122195247132
curr_Factors:  [9.64812220e+01 3.99865797e-02]
mat_Sqrt:  [[ 1.92930071e+01  0.00000000e+00]
 [-7.99865786e-03  1.83272275e-02]]
grads:  [0.00632602 4.05046806]
Stock Position:  0.006326020183199017
Bond Position:  [10.8307127]


portfolio before change:  [11.43954196]
curr_Stock_Price:  96.02804333532526
curr_Factors:  [9.60280433e+01 3.99890636e-02]
mat_Sqrt:  [[ 1.92029830e+01  0.00000000e+00]
 [-7.99890628e-03  1.83277968e-02]]
grads:  [9.27780858e-03 9.54492221e+00]
Stock Position:  0.009277808582884264
Bond Position:  [10.54861216]


portfolio before change:  [11.4427123]
curr_Stock_Price:  96.2276250381585
curr_Factors:  [9.62276250e+01 3.91555977e-02]
mat_Sqrt:  [[ 1.90413044e+01  0.00000000e+00]
 [-7.91510937e-03  1.81357939e-02]]
grads:  [-6.29542240e-03  6.52568303e+00]
Stock Position:  -0.006295422404689422
Bond Position:  [12.04850585]


portfolio before change:  [11.45043488]
curr_Stock_Price:  95.24017349449429
curr_Factors:  [9.52401735e+01 3.76297567e-02]
mat_Sqrt:  [[ 1.84750611e+01  0.00000000e+00]
 [-7.75935634e-03  1.77789189e-02]]
grads:  [-0.01472481 -0.05059614]
Stock Position:  -0.014724814234206586
Bond Position:  [12.85282874]


portfolio before change:  [11.45571126]
curr_Stock_Price:  94.99095647994741
curr_Factors:  [9.49909565e+01 3.72168350e-02]
mat_Sqrt:  [[ 1.83253374e+01  0.00000000e+00]
 [-7.71666612e-03  1.76811033e-02]]
grads:  [ 0.00833872 -5.16686594]
Stock Position:  0.008338719007675152
Bond Position:  [10.66360837]


portfolio before change:  [11.44212049]
curr_Stock_Price:  93.20125666694665
curr_Factors:  [9.32012567e+01 3.82929858e-02]
mat_Sqrt:  [[ 1.82381752e+01  0.00000000e+00]
 [-7.82743747e-03  1.79349123e-02]]
grads:  [-0.07737524 -8.42623307]
Stock Position:  -0.07737524214696101
Bond Position:  [18.65359029]


portfolio before change:  [11.47613349]
curr_Stock_Price:  92.79180846619462
curr_Factors:  [9.27918085e+01 3.73626184e-02]
mat_Sqrt:  [[ 1.79361113e+01  0.00000000e+00]
 [-7.73176496e-03  1.77156991e-02]]
grads:  [2.04295689e-02 2.36753855e+01]
Stock Position:  0.020429568880289
Bond Position:  [9.58043685]


portfolio before change:  [11.45704529]
curr_Stock_Price:  91.79884429784677
curr_Factors:  [9.17988443e+01 3.86769914e-02]
mat_Sqrt:  [[ 1.80535892e+01  0.00000000e+00]
 [-7.86658669e-03  1.80246145e-02]]
grads:  [-2.27923986e-03 -7.61805092e+00]
Stock Position:  -0.002279239857061371
Bond Position:  [11.66627687]


portfolio before change:  [11.45495573]
curr_Stock_Price:  93.3554755544838
curr_Factors:  [9.33554756e+01 3.74252329e-02]
mat_Sqrt:  [[ 1.80601790e+01  0.00000000e+00]
 [-7.73824092e-03  1.77305374e-02]]
grads:  [1.75898672e-03 3.70979832e+00]
Stock Position:  0.001758986716769953
Bond Position:  [11.29074469]


portfolio before change:  [11.45240355]
curr_Stock_Price:  91.1021278015689
curr_Factors:  [9.11021278e+01 3.92690634e-02]
mat_Sqrt:  [[ 1.80531833e+01  0.00000000e+00]
 [-7.92656934e-03  1.81620520e-02]]
grads:  [3.66437534e-03 9.44772058e+00]
Stock Position:  0.003664375337777377
Bond Position:  [11.11857116]


portfolio before change:  [11.45068585]
curr_Stock_Price:  90.25406926959492
curr_Factors:  [9.02540693e+01 4.00301055e-02]
mat_Sqrt:  [[ 1.80576054e+01  0.00000000e+00]
 [-8.00300998e-03  1.83371995e-02]]
grads:  [-0.1340077   4.57697271]
Stock Position:  -0.13400770169899565
Bond Position:  [23.54542625]


portfolio before change:  [11.52666865]
curr_Stock_Price:  89.70903020118618
curr_Factors:  [8.97090302e+01 4.06753363e-02]
mat_Sqrt:  [[ 1.80926315e+01  0.00000000e+00]
 [-8.06725096e-03  1.84843941e-02]]
grads:  [-0.00531224  5.06483413]
Stock Position:  -0.005312235184975709
Bond Position:  [12.00322412]


portfolio before change:  [11.52419531]
curr_Stock_Price:  90.45708375273092
curr_Factors:  [9.04570838e+01 4.09449020e-02]
mat_Sqrt:  [[ 1.83038522e+01  0.00000000e+00]
 [-8.09393867e-03  1.85455433e-02]]
grads:  [-0.01066153 -7.43079201]
Stock Position:  -0.010661531823413166
Bond Position:  [12.48860639]


portfolio before change:  [11.52612208]
curr_Stock_Price:  90.42279287327558
curr_Factors:  [9.04227929e+01 4.10171437e-02]
mat_Sqrt:  [[ 1.83130476e+01  0.00000000e+00]
 [-8.10107585e-03  1.85618966e-02]]
grads:  [ 0.08322137 -4.78864513]
Stock Position:  0.08322136951861728
Bond Position:  [4.00101342]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.57399859]
Stock Price:  90.99207406099555
PL:  [11.57399859]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-7.19772658e-02  1.71023184e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.00340617e-01 -6.70106000e-01]
 [ 5.50092991e-02  3.33702631e-02]
 [-1.67514606e-01  7.04009322e-02]
 [-5.98066394e-02 -5.41832059e-02]
 [-8.92826610e-03  2.87546721e-01]
 [ 2.59676287e-01 -2.11341395e-03]
 [ 1.26309863e-01  8.27642291e-02]
 [ 3.88153820e-01 -2.14885545e-01]
 [ 6.37281306e-02 -4.99022843e-04]
 [-1.44410653e-01 -1.59584256e-01]
 [-1.72201285e-01  1.59541949e-01]
 [-4.79184369e-01 -6.18314201e-01]
 [ 7.75299472e-02  2.23337616e-01]
 [ 5.68280082e-02 -2.22061446e-02]
 [-5.29040050e-02  2.66913521e-01]
 [-3.80612320e-02  1.28355875e-01]
 [ 1.49245778e-02  6.52265314e-02]
 [-9.94000237e-02 -3.74060746e-02]
 [ 2.32773081e-01  1.72389464e-01]
 [ 2.27154644e-02  1.06817381e-01]
 [-1.16100998e-02 -1.40031707e-01]
 [ 8.66797890e-02  1.86886291e-01]
 [ 5.70706700e-02  1.22036724e-01]
 [ 7.39176200e-01 -4.20422836e-01]
 [-2.07207811e-01  2.76890282e-01]
 [ 1.40468576e-01 -3.05354223e-04]
 [-4.45427721e-02 -6.57083811e-02]
 [-1.29901628e-02 -1.49475064e-01]
 [-1.09210243e-01 -7.75888203e-02]
 [-1.17918868e-01 -6.39647702e-04]
 [ 1.20785102e-01  8.83931352e-02]
 [ 1.84819583e-01  4.91027894e-02]
 [-2.40160945e-01 -2.04880315e-01]
 [ 1.15549190e-01 -2.85755786e-01]
 [-1.27854972e-01  2.44983568e-01]
 [-1.21839469e-01  1.18857138e-01]
 [-5.55113789e-02  1.13800854e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.0066854]
curr_Stock_Price:  99.5911552777124
curr_Factors:  [9.95911553e+01 3.97040529e-02]
mat_Sqrt:  [[ 1.98444100e+01  0.00000000e+00]
 [-7.97035034e-03  1.82623669e-02]]
grads:  [1.34212654e-04 9.36478743e+00]
Stock Position:  0.00013421265403682322
Bond Position:  [-0.02005179]


portfolio before change:  [-0.00668812]
curr_Stock_Price:  99.58954483367954
curr_Factors:  [9.95895448e+01 4.03154636e-02]
mat_Sqrt:  [[ 1.99962969e+01  0.00000000e+00]
 [-8.03148440e-03  1.84024426e-02]]
grads:  [-0.0101511  -4.78259175]
Stock Position:  -0.010151101927908732
Bond Position:  [1.0042555]


portfolio before change:  [-0.01260112]
curr_Stock_Price:  100.18440970429916
curr_Factors:  [1.00184410e+02 3.94861924e-02]
mat_Sqrt:  [[ 1.99077772e+01  0.00000000e+00]
 [-7.94845317e-03  1.82121942e-02]]
grads:  [ 2.55117573e-02 -3.67943584e+01]
Stock Position:  0.025511757330619448
Bond Position:  [-2.56848146]


portfolio before change:  [0.0350833]
curr_Stock_Price:  102.06611069364797
curr_Factors:  [1.02066111e+02 3.84766336e-02]
mat_Sqrt:  [[ 2.00207388e+01  0.00000000e+00]
 [-7.84618466e-03  1.79778676e-02]]
grads:  [0.00347506 1.85618583]
Stock Position:  0.003475060365117368
Bond Position:  [-0.31960259]


portfolio before change:  [0.03857473]
curr_Stock_Price:  103.08231802745217
curr_Factors:  [1.03082318e+02 3.85868695e-02]
mat_Sqrt:  [[ 2.02490172e+01  0.00000000e+00]
 [-7.85741631e-03  1.80036025e-02]]
grads:  [-0.00675535  3.91038028]
Stock Position:  -0.006755346143938271
Bond Position:  [0.73493147]


portfolio before change:  [0.05327421]
curr_Stock_Price:  100.91994083005355
curr_Factors:  [1.00919941e+02 3.98446007e-02]
mat_Sqrt:  [[ 2.01447428e+01  0.00000000e+00]
 [-7.98444495e-03  1.82946617e-02]]
grads:  [-0.00414272 -2.96169488]
Stock Position:  -0.004142724976604057
Bond Position:  [0.47135777]


portfolio before change:  [0.05675337]
curr_Stock_Price:  100.09434137019718
curr_Factors:  [1.00094341e+02 4.07329306e-02]
mat_Sqrt:  [[ 2.02014413e+01  0.00000000e+00]
 [-8.07296036e-03  1.84974760e-02]]
grads:  [5.77025223e-03 1.55451869e+01]
Stock Position:  0.005770252226362026
Bond Position:  [-0.52081623]


portfolio before change:  [0.06623396]
curr_Stock_Price:  101.74863629407594
curr_Factors:  [1.01748636e+02 3.92476336e-02]
mat_Sqrt:  [[ 2.01574381e+01  0.00000000e+00]
 [-7.92440621e-03  1.81570957e-02]]
grads:  [ 0.01283665 -0.11639604]
Stock Position:  0.012836646961250938
Bond Position:  [-1.23987736]


portfolio before change:  [0.06044961]
curr_Stock_Price:  101.31009869654565
curr_Factors:  [1.01310099e+02 3.90959790e-02]
mat_Sqrt:  [[ 2.00317451e+01  0.00000000e+00]
 [-7.90908126e-03  1.81219818e-02]]
grads:  [0.00810869 4.56706281]
Stock Position:  0.008108686171404506
Bond Position:  [-0.76104218]


portfolio before change:  [0.06928056]
curr_Stock_Price:  102.41090407008411
curr_Factors:  [1.02410904e+02 3.64297492e-02]
mat_Sqrt:  [[ 1.95467379e+01  0.00000000e+00]
 [-7.63463154e-03  1.74931385e-02]]
grads:  [  0.01505981 -12.28399038]
Stock Position:  0.015059805910194946
Bond Position:  [-1.47300778]


portfolio before change:  [0.06393764]
curr_Stock_Price:  102.06835087679272
curr_Factors:  [1.02068351e+02 3.49880931e-02]
mat_Sqrt:  [[ 1.90919916e+01  0.00000000e+00]
 [-7.48204176e-03  1.71435114e-02]]
grads:  [ 0.00332654 -0.02910855]
Stock Position:  0.003326543429753793
Bond Position:  [-0.27559716]


portfolio before change:  [0.06241979]
curr_Stock_Price:  101.62242400266223
curr_Factors:  [1.01622424e+02 3.52689397e-02]
mat_Sqrt:  [[ 1.90847182e+01  0.00000000e+00]
 [-7.51201062e-03  1.72121786e-02]]
grads:  [-0.01121625 -9.27158958]
Stock Position:  -0.011216247973904544
Bond Position:  [1.2022421]


portfolio before change:  [0.06049688]
curr_Stock_Price:  101.80726362512243
curr_Factors:  [1.01807264e+02 3.65851985e-02]
mat_Sqrt:  [[ 1.94729376e+01  0.00000000e+00]
 [-7.65090305e-03  1.75304212e-02]]
grads:  [-5.26738553e-03  9.10086226e+00]
Stock Position:  -0.0052673855303861416
Bond Position:  [0.59675498]


portfolio before change:  [0.06327414]
curr_Stock_Price:  101.29416845061931
curr_Factors:  [1.01294168e+02 3.71894258e-02]
mat_Sqrt:  [[ 1.95341348e+01  0.00000000e+00]
 [-7.71382403e-03  1.76745913e-02]]
grads:  [ -0.03834512 -34.9832249 ]
Stock Position:  -0.03834512345914621
Bond Position:  [3.94741154]


portfolio before change:  [0.09414143]
curr_Stock_Price:  100.502051355185
curr_Factors:  [1.00502051e+02 3.87728881e-02]
mat_Sqrt:  [[ 1.97896905e+01  0.00000000e+00]
 [-7.87633297e-03  1.80469460e-02]]
grads:  [8.84311322e-03 1.23753690e+01]
Stock Position:  0.008843113222497291
Bond Position:  [-0.79460959]


portfolio before change:  [0.11060113]
curr_Stock_Price:  102.37458578697668
curr_Factors:  [1.02374586e+02 3.83850826e-02]
mat_Sqrt:  [[ 2.00573428e+01  0.00000000e+00]
 [-7.83684453e-03  1.79564666e-02]]
grads:  [ 0.00235008 -1.2366656 ]
Stock Position:  0.0023500845840900087
Bond Position:  [-0.1299878]


portfolio before change:  [0.1101672]
curr_Stock_Price:  102.19685700060145
curr_Factors:  [1.02196857e+02 3.83617017e-02]
mat_Sqrt:  [[ 2.00164230e+01  0.00000000e+00]
 [-7.83445739e-03  1.79509970e-02]]
grads:  [3.17672172e-03 1.48690081e+01]
Stock Position:  0.0031767217194256783
Bond Position:  [-0.21448377]


portfolio before change:  [0.11273855]
curr_Stock_Price:  103.01473246888554
curr_Factors:  [1.03014732e+02 3.79957217e-02]
mat_Sqrt:  [[ 2.00801378e+01  0.00000000e+00]
 [-7.79699652e-03  1.78651634e-02]]
grads:  [8.94309822e-04 7.18470199e+00]
Stock Position:  0.0008943098221032197
Bond Position:  [0.02061147]


portfolio before change:  [0.11173388]
curr_Stock_Price:  101.88844365078455
curr_Factors:  [1.01888444e+02 3.88214691e-02]
mat_Sqrt:  [[ 2.00752476e+01  0.00000000e+00]
 [-7.88126579e-03  1.80582485e-02]]
grads:  [2.16145627e-03 3.61200762e+00]
Stock Position:  0.002161456273956681
Bond Position:  [-0.10849354]


portfolio before change:  [0.11471449]
curr_Stock_Price:  103.27369871542112
curr_Factors:  [1.03273699e+02 3.93459675e-02]
mat_Sqrt:  [[ 2.04851829e+01  0.00000000e+00]
 [-7.93432720e-03  1.81798275e-02]]
grads:  [-0.00564922 -2.05755938]
Stock Position:  -0.0056492233231548806
Bond Position:  [0.69813067]


portfolio before change:  [0.11785714]
curr_Stock_Price:  102.73284950922829
curr_Factors:  [1.0273285e+02 3.9346097e-02]
mat_Sqrt:  [[ 2.03779346e+01  0.00000000e+00]
 [-7.93434025e-03  1.81798574e-02]]
grads:  [0.01511488 9.48244312]
Stock Position:  0.015114878799709566
Bond Position:  [-1.43493743]


portfolio before change:  [0.15520824]
curr_Stock_Price:  105.21586559288461
curr_Factors:  [1.05215866e+02 3.76238449e-02]
mat_Sqrt:  [[ 2.04085815e+01  0.00000000e+00]
 [-7.75874680e-03  1.77775222e-02]]
grads:  [3.39731557e-03 6.00856407e+00]
Stock Position:  0.0033973155668561485
Bond Position:  [-0.20224325]


portfolio before change:  [0.15627902]
curr_Stock_Price:  105.53849166476529
curr_Factors:  [1.05538492e+02 3.73850661e-02]
mat_Sqrt:  [[ 2.04060976e+01  0.00000000e+00]
 [-7.73408727e-03  1.77210202e-02]]
grads:  [-3.56388314e-03 -7.90201162e+00]
Stock Position:  -0.0035638831415291256
Bond Position:  [0.53240588]


portfolio before change:  [0.16010295]
curr_Stock_Price:  104.48419929604782
curr_Factors:  [1.04484199e+02 3.74969019e-02]
mat_Sqrt:  [[ 2.02324424e+01  0.00000000e+00]
 [-7.74564672e-03  1.77475062e-02]]
grads:  [8.31553848e-03 1.05302846e+01]
Stock Position:  0.008315538480251464
Bond Position:  [-0.70873943]


portfolio before change:  [0.1588996]
curr_Stock_Price:  104.35014252445218
curr_Factors:  [1.04350143e+02 3.58511559e-02]
mat_Sqrt:  [[ 1.97580749e+01  0.00000000e+00]
 [-7.57376059e-03  1.73536656e-02]]
grads:  [5.58414033e-03 7.03233122e+00]
Stock Position:  0.005584140332445816
Bond Position:  [-0.42380624]


portfolio before change:  [0.15233423]
curr_Stock_Price:  103.18391171989457
curr_Factors:  [1.03183912e+02 3.54744259e-02]
mat_Sqrt:  [[ 1.94343346e+01  0.00000000e+00]
 [-7.53386232e-03  1.72622472e-02]]
grads:  [  0.02859314 -24.3550467 ]
Stock Position:  0.02859313903757214
Bond Position:  [-2.79801771]


portfolio before change:  [0.14009458]
curr_Stock_Price:  102.76808216001238
curr_Factors:  [1.02768082e+02 3.49880999e-02]
mat_Sqrt:  [[ 1.92228789e+01  0.00000000e+00]
 [-7.48204249e-03  1.71435130e-02]]
grads:  [-4.49271852e-03  1.61513152e+01]
Stock Position:  -0.004492718522403557
Bond Position:  [0.60180265]


portfolio before change:  [0.1367798]
curr_Stock_Price:  103.52263854822733
curr_Factors:  [1.03522639e+02 3.41226217e-02]
mat_Sqrt:  [[ 1.91230221e+01  0.00000000e+00]
 [-7.38892378e-03  1.69301513e-02]]
grads:  [ 0.00733855 -0.01803612]
Stock Position:  0.007338552866018928
Bond Position:  [-0.62292656]


portfolio before change:  [0.13699044]
curr_Stock_Price:  103.56195277923615
curr_Factors:  [1.03561953e+02 3.42334636e-02]
mat_Sqrt:  [[ 1.91613301e+01  0.00000000e+00]
 [-7.40091493e-03  1.69576264e-02]]
grads:  [-3.82125148e-03 -3.87485721e+00]
Stock Position:  -0.0038212514754077773
Bond Position:  [0.5327267]


portfolio before change:  [0.1347862]
curr_Stock_Price:  104.15621701911905
curr_Factors:  [1.04156217e+02 3.42966246e-02]
mat_Sqrt:  [[ 1.92890522e+01  0.00000000e+00]
 [-7.40773915e-03  1.69732627e-02]]
grads:  [-4.05548330e-03 -8.80650152e+00]
Stock Position:  -0.004055483296192792
Bond Position:  [0.55719]


portfolio before change:  [0.13333027]
curr_Stock_Price:  104.53239506734943
curr_Factors:  [1.04532395e+02 3.53978888e-02]
mat_Sqrt:  [[ 1.96670663e+01  0.00000000e+00]
 [-7.52573067e-03  1.72436152e-02]]
grads:  [-0.00727474 -4.49956806]
Stock Position:  -0.007274739291382262
Bond Position:  [0.89377619]


portfolio before change:  [0.14469634]
curr_Stock_Price:  102.98535158038541
curr_Factors:  [1.02985352e+02 3.52625877e-02]
mat_Sqrt:  [[ 1.93389346e+01  0.00000000e+00]
 [-7.51133412e-03  1.72106286e-02]]
grads:  [-0.00611192 -0.03716585]
Stock Position:  -0.006111920605323701
Bond Position:  [0.77413463]


portfolio before change:  [0.15196468]
curr_Stock_Price:  101.81197679332976
curr_Factors:  [1.01811977e+02 3.65303018e-02]
mat_Sqrt:  [[ 1.94592232e+01  0.00000000e+00]
 [-7.64516075e-03  1.75172639e-02]]
grads:  [0.00818959 5.04605831]
Stock Position:  0.008189588392315058
Bond Position:  [-0.6818335]


portfolio before change:  [0.15988532]
curr_Stock_Price:  102.78954371757486
curr_Factors:  [1.02789544e+02 3.53235816e-02]
mat_Sqrt:  [[ 1.93188515e+01  0.00000000e+00]
 [-7.51782751e-03  1.72255068e-02]]
grads:  [0.01067609 2.85058605]
Stock Position:  0.010676089994603148
Bond Position:  [-0.9375051]


portfolio before change:  [0.16966534]
curr_Stock_Price:  103.71658844730048
curr_Factors:  [1.03716588e+02 3.57051679e-02]
mat_Sqrt:  [[ 1.95980907e+01  0.00000000e+00]
 [-7.55832446e-03  1.73182970e-02]]
grads:  [ -0.01681684 -11.83028072]
Stock Position:  -0.016816844584188247
Bond Position:  [1.91385109]


portfolio before change:  [0.16663427]
curr_Stock_Price:  103.91105474035972
curr_Factors:  [1.03911055e+02 3.62831199e-02]
mat_Sqrt:  [[ 1.97931112e+01  0.00000000e+00]
 [-7.61925139e-03  1.74578981e-02]]
grads:  [-4.63032797e-04 -1.63682812e+01]
Stock Position:  -0.0004630327968700511
Bond Position:  [0.2147485]


portfolio before change:  [0.16743972]
curr_Stock_Price:  102.2295222389038
curr_Factors:  [1.02229522e+02 3.67911406e-02]
mat_Sqrt:  [[ 1.96086619e+01  0.00000000e+00]
 [-7.67240673e-03  1.75796923e-02]]
grads:  [-1.06765965e-03  1.39356005e+01]
Stock Position:  -0.001067659651942874
Bond Position:  [0.27658606]


portfolio before change:  [0.16714239]
curr_Stock_Price:  102.54040098049286
curr_Factors:  [1.02540401e+02 3.76979430e-02]
mat_Sqrt:  [[ 1.99092013e+01  0.00000000e+00]
 [-7.76638325e-03  1.77950196e-02]]
grads:  [-3.51425252e-03  6.67923615e+00]
Stock Position:  -0.0035142525225269087
Bond Position:  [0.52749525]


portfolio before change:  [0.16519846]
curr_Stock_Price:  103.11231994104524
curr_Factors:  [1.03112320e+02 3.60461217e-02]
mat_Sqrt:  [[ 1.95767155e+01  0.00000000e+00]
 [-7.59432648e-03  1.74007880e-02]]
grads:  [-2.98549274e-04  6.53998282e+00]
Stock Position:  -0.0002985492737762852
Bond Position:  [0.19598257]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.16503366]
Stock Price:  103.74637405764528
PL:  [-3.58134039]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.90686393e-01  3.05820110e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.63038176e-01 -7.99079960e-01]
 [-4.79772968e-02  7.02568690e-02]
 [ 2.46501600e-02 -7.94877606e-02]
 [-8.07087169e-02 -1.02096276e-01]
 [-6.00551282e-02  1.80463707e-01]
 [-7.61572119e-02 -1.10569591e-01]
 [ 1.66356372e-01  8.92216920e-02]
 [ 1.07166432e-01  8.10384844e-02]
 [ 1.63783723e-01  3.54400507e-01]
 [ 1.78326555e-01  2.56169703e-01]
 [ 2.06539428e-01  2.45550241e-02]
 [-1.32629299e-01 -1.32648126e-01]
 [ 8.21054560e-02  2.26990607e-01]
 [ 4.76289263e-02  3.40564633e-02]
 [ 1.97218357e-02 -6.35131210e-02]
 [ 3.70210838e-02  5.64097559e-02]
 [ 1.15148383e-02  4.64457800e-02]
 [ 3.07042272e-01 -1.13097691e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-1.87305566e-02  1.36006675e-01]
 [-3.72781831e-03 -7.02961169e-03]
 [-4.80269737e-02  3.30566243e-02]
 [ 5.72140782e-02  1.38864309e-01]
 [ 6.88719374e-02  8.25240611e-02]
 [-2.21834683e-02  2.24082863e-01]
 [-2.03951615e-01  1.45403371e-01]
 [-1.81436095e-02 -1.27883958e-01]
 [ 4.92683251e-02 -5.78388626e-02]
 [-8.69199147e-01 -1.02905006e-01]
 [-1.18163288e-01  8.84875291e-03]
 [ 3.15887029e-03 -9.10668585e-02]
 [ 9.63850695e-02  9.44735981e-02]
 [-2.40822180e-01 -6.02466990e-02]
 [-4.20206111e-01 -3.49981016e-01]
 [-1.02091572e-01  2.67981929e-01]
 [-1.21121925e-01  1.19341207e-01]
 [-7.58083886e-02  1.18961383e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.66739556]
curr_Stock_Price:  99.19040926310986
curr_Factors:  [9.91904093e+01 4.23289460e-02]
mat_Sqrt:  [[ 2.04074344e+01  0.00000000e+00]
 [-8.22959984e-03  1.88563821e-02]]
grads:  [-0.00868994  1.62183874]
Stock Position:  -0.008689936506303125
Bond Position:  [-1.8054372]


portfolio before change:  [-2.65834438]
curr_Stock_Price:  98.12286700247037
curr_Factors:  [9.81228670e+01 4.37262621e-02]
mat_Sqrt:  [[ 2.05183015e+01  0.00000000e+00]
 [-8.36433018e-03  1.91650881e-02]]
grads:  [-0.00989285 -4.59227579]
Stock Position:  -0.009892848510311263
Bond Position:  [-1.68762972]


portfolio before change:  [-2.6568408]
curr_Stock_Price:  97.94955586575855
curr_Factors:  [9.79495559e+01 4.39197345e-02]
mat_Sqrt:  [[ 2.05273234e+01  0.00000000e+00]
 [-8.38281427e-03  1.92074405e-02]]
grads:  [ 2.50539771e-02 -4.16026259e+01]
Stock Position:  0.02505397711349814
Bond Position:  [-5.11086673]


portfolio before change:  [-2.62286409]
curr_Stock_Price:  99.33119727507291
curr_Factors:  [9.93311973e+01 4.34362327e-02]
mat_Sqrt:  [[ 2.07019734e+01  0.00000000e+00]
 [-8.33654438e-03  1.91014228e-02]]
grads:  [-8.36378498e-04  3.67809611e+00]
Stock Position:  -0.0008363784979892927
Bond Position:  [-2.53978561]


portfolio before change:  [-2.62146429]
curr_Stock_Price:  97.27795331389925
curr_Factors:  [9.72779533e+01 4.44241510e-02]
mat_Sqrt:  [[ 2.05033107e+01  0.00000000e+00]
 [-8.43081500e-03  1.93174240e-02]]
grads:  [-4.89732755e-04 -4.11482198e+00]
Stock Position:  -0.00048973275514764
Bond Position:  [-2.57382409]


portfolio before change:  [-2.62207271]
curr_Stock_Price:  97.86331017423626
curr_Factors:  [9.78633102e+01 4.47054018e-02]
mat_Sqrt:  [[ 2.06918777e+01  0.00000000e+00]
 [-8.45746079e-03  1.93784771e-02]]
grads:  [-0.00605393 -5.2685397 ]
Stock Position:  -0.006053930270365278
Bond Position:  [-2.02961505]


portfolio before change:  [-2.62617185]
curr_Stock_Price:  98.49850500484041
curr_Factors:  [9.8498505e+01 4.4562493e-02]
mat_Sqrt:  [[ 2.07928671e+01  0.00000000e+00]
 [-8.44393207e-03  1.93474789e-02]]
grads:  [8.99620550e-04 9.32750501e+00]
Stock Position:  0.0008996205499458283
Bond Position:  [-2.71478313]


portfolio before change:  [-2.62738375]
curr_Stock_Price:  97.52861518218815
curr_Factors:  [9.75286152e+01 4.61005711e-02]
mat_Sqrt:  [[ 2.09404114e+01  0.00000000e+00]
 [-8.58841742e-03  1.96785365e-02]]
grads:  [-0.00594132 -5.61879139]
Stock Position:  -0.005941322504162367
Bond Position:  [-2.0479348]


portfolio before change:  [-2.63285971]
curr_Stock_Price:  98.40719902647808
curr_Factors:  [9.8407199e+01 4.5960866e-02]
mat_Sqrt:  [[ 2.10970131e+01  0.00000000e+00]
 [-8.57539420e-03  1.96486965e-02]]
grads:  [0.00973104 4.54084534]
Stock Position:  0.009731041522071103
Bond Position:  [-3.59046425]


portfolio before change:  [-2.64115938]
curr_Stock_Price:  97.60041636817354
curr_Factors:  [9.76004164e+01 4.45759091e-02]
mat_Sqrt:  [[ 2.06063833e+01  0.00000000e+00]
 [-8.44520305e-03  1.93503911e-02]]
grads:  [0.00691701 4.18795072]
Stock Position:  0.006917008393027416
Bond Position:  [-3.31626228]


portfolio before change:  [-2.64951119]
curr_Stock_Price:  96.4529184820402
curr_Factors:  [9.64529185e+01 4.36019923e-02]
mat_Sqrt:  [[ 2.01404208e+01  0.00000000e+00]
 [-8.35243603e-03  1.91378352e-02]]
grads:  [1.58118238e-02 1.85183174e+01]
Stock Position:  0.015811823814055402
Bond Position:  [-4.17460775]


portfolio before change:  [-2.64674235]
curr_Stock_Price:  96.6610351978743
curr_Factors:  [9.66610352e+01 4.18593248e-02]
mat_Sqrt:  [[ 1.97764143e+01  0.00000000e+00]
 [-8.18382061e-03  1.87514887e-02]]
grads:  [ 0.01467041 13.66129946]
Stock Position:  0.01467041370065674
Bond Position:  [-4.06479972]


portfolio before change:  [-2.64387974]
curr_Stock_Price:  96.89079935248887
curr_Factors:  [9.68907994e+01 4.17722755e-02]
mat_Sqrt:  [[ 1.98028002e+01  0.00000000e+00]
 [-8.17530677e-03  1.87319810e-02]]
grads:  [0.01097098 1.31086104]
Stock Position:  0.010970979687526361
Bond Position:  [-3.70686674]


portfolio before change:  [-2.64832706]
curr_Stock_Price:  96.52766607048693
curr_Factors:  [9.65276661e+01 4.05484544e-02]
mat_Sqrt:  [[ 1.94374352e+01  0.00000000e+00]
 [-8.05465872e-03  1.84555416e-02]]
grads:  [-0.00980179 -7.1874415 ]
Stock Position:  -0.009801791531322839
Bond Position:  [-1.702183]


portfolio before change:  [-2.67553022]
curr_Stock_Price:  99.2812829379939
curr_Factors:  [9.92812829e+01 3.95330510e-02]
mat_Sqrt:  [[ 1.97400181e+01  0.00000000e+00]
 [-7.95316802e-03  1.82229972e-02]]
grads:  [9.17791856e-03 1.24562718e+01]
Stock Position:  0.009177918555145263
Bond Position:  [-3.58672575]


portfolio before change:  [-2.69628665]
curr_Stock_Price:  97.06857428585612
curr_Factors:  [9.70685743e+01 4.11834677e-02]
mat_Sqrt:  [[ 1.96988152e+01  0.00000000e+00]
 [-8.11748412e-03  1.85994927e-02]]
grads:  [0.00317239 1.83104259]
Stock Position:  0.0031723930953364114
Bond Position:  [-3.00422633]


portfolio before change:  [-2.69543275]
curr_Stock_Price:  97.45612311970653
curr_Factors:  [9.74561231e+01 4.26721352e-02]
mat_Sqrt:  [[ 2.01317402e+01  0.00000000e+00]
 [-8.26289394e-03  1.89326685e-02]]
grads:  [-3.97261375e-04 -3.35468405e+00]
Stock Position:  -0.0003972613754473436
Bond Position:  [-2.65671719]


portfolio before change:  [-2.69574569]
curr_Stock_Price:  97.40788022875562
curr_Factors:  [9.74078802e+01 4.17879111e-02]
mat_Sqrt:  [[ 1.99122081e+01  0.00000000e+00]
 [-8.17683666e-03  1.87354865e-02]]
grads:  [0.0030956  3.01085088]
Stock Position:  0.0030956044213557837
Bond Position:  [-2.99728196]


portfolio before change:  [-2.69809194]
curr_Stock_Price:  96.77098771662128
curr_Factors:  [9.67709877e+01 4.23414177e-02]
mat_Sqrt:  [[ 1.99125955e+01  0.00000000e+00]
 [-8.23081213e-03  1.88591598e-02]]
grads:  [1.59624789e-03 2.46277037e+00]
Stock Position:  0.001596247888401708
Bond Position:  [-2.85256243]


portfolio before change:  [-2.7011762]
curr_Stock_Price:  95.0621884886068
curr_Factors:  [9.50621885e+01 4.10972227e-02]
mat_Sqrt:  [[ 1.92714346e+01  0.00000000e+00]
 [-8.10897998e-03  1.85800073e-02]]
grads:  [ 0.01337121 -6.08706388]
Stock Position:  0.013371209684014153
Bond Position:  [-3.97227266]


portfolio before change:  [-2.71647227]
curr_Stock_Price:  93.955370207741
curr_Factors:  [9.39553702e+01 4.06309591e-02]
mat_Sqrt:  [[ 1.89386991e+01  0.00000000e+00]
 [-8.06284903e-03  1.84743080e-02]]
grads:  [ 0.00222447 -2.04489335]
Stock Position:  0.002224472246354818
Bond Position:  [-2.92547338]


portfolio before change:  [-2.71508465]
curr_Stock_Price:  94.74356704990745
curr_Factors:  [9.47435670e+01 4.03354856e-02]
mat_Sqrt:  [[ 1.90280102e+01  0.00000000e+00]
 [-8.03347851e-03  1.84070117e-02]]
grads:  [2.13514826e-03 7.38885148e+00]
Stock Position:  0.0021351482592451825
Bond Position:  [-2.91737622]


portfolio before change:  [-2.71564613]
curr_Stock_Price:  94.65140261925659
curr_Factors:  [9.46514026e+01 4.03910867e-02]
mat_Sqrt:  [[ 1.90225977e+01  0.00000000e+00]
 [-8.03901354e-03  1.84196940e-02]]
grads:  [-3.57248389e-04 -3.81635638e-01]
Stock Position:  -0.0003572483889394046
Bond Position:  [-2.68183207]


portfolio before change:  [-2.71629356]
curr_Stock_Price:  95.52523780348929
curr_Factors:  [9.55252378e+01 4.16291436e-02]
mat_Sqrt:  [[ 1.94902256e+01  0.00000000e+00]
 [-8.16128848e-03  1.86998611e-02]]
grads:  [-1.72393490e-03  1.76774705e+00]
Stock Position:  -0.0017239349015807667
Bond Position:  [-2.55161427]


portfolio before change:  [-2.71665727]
curr_Stock_Price:  95.5511880283156
curr_Factors:  [9.55511880e+01 4.29225718e-02]
mat_Sqrt:  [[ 1.97960690e+01  0.00000000e+00]
 [-8.28710534e-03  1.89881438e-02]]
grads:  [5.95165793e-03 7.31321137e+00]
Stock Position:  0.005951657934081911
Bond Position:  [-3.28534525]


portfolio before change:  [-2.71239048]
curr_Stock_Price:  96.33710043282238
curr_Factors:  [9.63371004e+01 4.24687231e-02]
mat_Sqrt:  [[ 1.98530928e+01  0.00000000e+00]
 [-8.24317639e-03  1.88874899e-02]]
grads:  [0.00528323 4.36924449]
Stock Position:  0.005283226723181968
Bond Position:  [-3.22136122]


portfolio before change:  [-2.70331239]
curr_Stock_Price:  98.1316071136416
curr_Factors:  [9.81316071e+01 4.05903495e-02]
mat_Sqrt:  [[ 1.97706208e+01  0.00000000e+00]
 [-8.05881872e-03  1.84650734e-02]]
grads:  [3.82457949e-03 1.21354981e+01]
Stock Position:  0.003824579485276937
Bond Position:  [-3.07862452]


portfolio before change:  [-2.70103674]
curr_Stock_Price:  98.82723876088268
curr_Factors:  [9.88272388e+01 3.86317262e-02]
mat_Sqrt:  [[ 1.94244495e+01  0.00000000e+00]
 [-7.86198206e-03  1.80140640e-02]]
grads:  [-7.23276001e-03  8.07165840e+00]
Stock Position:  -0.0072327600105907795
Bond Position:  [-1.98624304]


portfolio before change:  [-2.70384594]
curr_Stock_Price:  99.1813081836358
curr_Factors:  [9.91813082e+01 3.82335955e-02]
mat_Sqrt:  [[ 1.93933307e+01  0.00000000e+00]
 [-7.82136515e-03  1.79209989e-02]]
grads:  [-3.81351433e-03 -7.13598380e+00]
Stock Position:  -0.003813514330642618
Bond Position:  [-2.3256166]


portfolio before change:  [-2.70284832]
curr_Stock_Price:  98.84347430158518
curr_Factors:  [9.88434743e+01 3.87590781e-02]
mat_Sqrt:  [[ 1.94596364e+01  0.00000000e+00]
 [-7.87493016e-03  1.80437318e-02]]
grads:  [ 1.23462615e-03 -3.20548229e+00]
Stock Position:  0.0012346261491810741
Bond Position:  [-2.82488306]


portfolio before change:  [-2.70437275]
curr_Stock_Price:  97.89477097391612
curr_Factors:  [9.78947710e+01 3.81867524e-02]
mat_Sqrt:  [[ 1.91300391e+01  0.00000000e+00]
 [-7.81657239e-03  1.79100173e-02]]
grads:  [-0.04778404 -5.74566761]
Stock Position:  -0.04778404106411448
Bond Position:  [1.97343501]


portfolio before change:  [-2.73643529]
curr_Stock_Price:  98.57092223684032
curr_Factors:  [9.85709222e+01 3.93683260e-02]
mat_Sqrt:  [[ 1.95579033e+01  0.00000000e+00]
 [-7.93658123e-03  1.81849921e-02]]
grads:  [-0.00584426  0.48659647]
Stock Position:  -0.005844255059613504
Bond Position:  [-2.16036168]


portfolio before change:  [-2.73530451]
curr_Stock_Price:  98.33122516179078
curr_Factors:  [9.83312252e+01 4.01329685e-02]
mat_Sqrt:  [[ 1.96989053e+01  0.00000000e+00]
 [-8.01328581e-03  1.83607444e-02]]
grads:  [-1.85725880e-03 -4.95986745e+00]
Stock Position:  -0.001857258798002641
Bond Position:  [-2.55267797]


portfolio before change:  [-2.7368532]
curr_Stock_Price:  98.99327115413492
curr_Factors:  [9.89932712e+01 4.05544121e-02]
mat_Sqrt:  [[ 1.99353897e+01  0.00000000e+00]
 [-8.05525042e-03  1.84568974e-02]]
grads:  [0.00690314 5.11860667]
Stock Position:  0.006903137079977628
Bond Position:  [-3.42021732]


portfolio before change:  [-2.73050437]
curr_Stock_Price:  99.97490979704668
curr_Factors:  [9.99749098e+01 3.88502362e-02]
mat_Sqrt:  [[ 1.97055179e+01  0.00000000e+00]
 [-7.88418530e-03  1.80649380e-02]]
grads:  [-0.01355539 -3.33500725]
Stock Position:  -0.013555390763970908
Bond Position:  [-1.3753054]


portfolio before change:  [-2.72511059]
curr_Stock_Price:  99.56431981804722
curr_Factors:  [9.95643198e+01 4.01140955e-02]
mat_Sqrt:  [[ 1.99412433e+01  0.00000000e+00]
 [-8.01140142e-03  1.83564267e-02]]
grads:  [ -0.02873193 -19.06585749]
Stock Position:  -0.028731927032479298
Bond Position:  [0.13556419]


portfolio before change:  [-2.77925754]
curr_Stock_Price:  101.44946681547316
curr_Factors:  [1.01449467e+02 3.81421214e-02]
mat_Sqrt:  [[ 1.98130890e+01  0.00000000e+00]
 [-7.81200321e-03  1.78995480e-02]]
grads:  [7.50278284e-04 1.49714355e+01]
Stock Position:  0.0007502782844821379
Bond Position:  [-2.85537288]


portfolio before change:  [-2.77834742]
curr_Stock_Price:  103.13827154623687
curr_Factors:  [1.03138272e+02 3.83335753e-02]
mat_Sqrt:  [[ 2.01934030e+01  0.00000000e+00]
 [-7.83158480e-03  1.79444151e-02]]
grads:  [-3.41879735e-03  6.65060448e+00]
Stock Position:  -0.0034187973453751056
Bond Position:  [-2.42573857]


portfolio before change:  [-2.78027435]
curr_Stock_Price:  103.61320480576123
curr_Factors:  [1.03613205e+02 3.71758404e-02]
mat_Sqrt:  [[ 1.99777008e+01  0.00000000e+00]
 [-7.71241496e-03  1.76713627e-02]]
grads:  [-1.19580251e-03  6.73187377e+00]
Stock Position:  -0.0011958025054192953
Bond Position:  [-2.65637342]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.77924322]
Stock Price:  102.47321849760147
PL:  [-5.25246172]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.03939762e-01  5.12528336e-01]
 [-1.64913339e-01 -8.61031145e-02]
 [ 8.62847861e-01 -7.96499029e-01]
 [-1.25071858e-02  2.37278647e-01]
 [ 2.81642934e-02 -7.91169287e-03]
 [-8.00184365e-02 -1.04912772e-01]
 [-5.51825062e-02  1.87077321e-01]
 [-1.15836783e-01 -9.86151062e-02]
 [ 1.65849710e-01  1.05809598e-01]
 [ 1.31069203e-01  4.51302014e-02]
 [ 1.49464490e-01  3.03346906e-01]
 [ 1.88644317e-01  2.45345335e-01]
 [ 2.25671965e-01  2.18710175e-02]
 [-2.15446792e-01 -2.75902359e-01]
 [ 8.48322307e-02  2.29162869e-01]
 [ 5.24539817e-02 -1.94192220e-02]
 [-4.18864077e-02  8.46171730e-02]
 [-1.37738151e-02  4.51109644e-02]
 [ 1.57093711e-02  4.57399953e-02]
 [ 1.67419853e-01 -1.04141735e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 2.41688049e-02  2.08540142e-01]
 [ 2.87467912e-02  1.63718890e-01]
 [-3.48281827e-02  7.64671439e-03]
 [ 5.69522837e-02  1.35746371e-01]
 [ 4.61380355e-02  1.29693336e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.77029948e-01  1.26786327e-01]
 [-1.97213100e-01 -3.82603759e-02]
 [ 1.91482431e-01 -9.10752700e-02]
 [-1.18722481e+00 -1.33948445e-01]
 [ 4.48416146e-02  2.63529768e-01]
 [-9.35386128e-03 -1.27746586e-01]
 [-8.66977883e-04  6.04452388e-02]
 [-4.34842711e-02  1.65281569e-01]
 [-1.54337291e+00 -1.02053225e-01]
 [-8.06967210e-02  2.26985508e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.15397169e+00 -3.57498464e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.55371407]
curr_Stock_Price:  100.57925761978606
curr_Factors:  [1.00579258e+02 3.86281654e-02]
mat_Sqrt:  [[ 1.97678969e+01  0.00000000e+00]
 [-7.86161972e-03  1.80132337e-02]]
grads:  [2.16323198e-02 2.84528777e+01]
Stock Position:  0.02163231977731077
Bond Position:  [4.3779514]


portfolio before change:  [6.52333772]
curr_Stock_Price:  99.14974751352385
curr_Factors:  [9.91497475e+01 3.78493603e-02]
mat_Sqrt:  [[ 1.92894962e+01  0.00000000e+00]
 [-7.78196483e-03  1.78307214e-02]]
grads:  [-0.01049752 -4.82891928]
Stock Position:  -0.010497517257453065
Bond Position:  [7.56416391]


portfolio before change:  [6.53558765]
curr_Stock_Price:  98.07288828689573
curr_Factors:  [9.80728883e+01 3.75322305e-02]
mat_Sqrt:  [[ 1.89998929e+01  0.00000000e+00]
 [-7.74929473e-03  1.77558648e-02]]
grads:  [ 2.71173732e-02 -4.48583629e+01]
Stock Position:  0.027117373155737298
Bond Position:  [3.87610854]


portfolio before change:  [6.5035547]
curr_Stock_Price:  96.87374945945618
curr_Factors:  [9.68737495e+01 3.73400582e-02]
mat_Sqrt:  [[ 1.87194724e+01  0.00000000e+00]
 [-7.72943032e-03  1.77103498e-02]]
grads:  [4.86390342e-03 1.33977392e+01]
Stock Position:  0.004863903418247456
Bond Position:  [6.03237014]


portfolio before change:  [6.51507552]
curr_Stock_Price:  99.08734808379042
curr_Factors:  [9.90873481e+01 3.51326100e-02]
mat_Sqrt:  [[ 1.85726302e+01  0.00000000e+00]
 [-7.49747797e-03  1.71788802e-02]]
grads:  [ 0.00133052 -0.46054765]
Stock Position:  0.0013305249293265725
Bond Position:  [6.38323734]


portfolio before change:  [6.51370674]
curr_Stock_Price:  97.45886115826752
curr_Factors:  [9.74588612e+01 3.45164859e-02]
mat_Sqrt:  [[ 1.81065046e+01  0.00000000e+00]
 [-7.43144518e-03  1.70275800e-02]]
grads:  [-0.00694812 -6.16134366]
Stock Position:  -0.006948117647370762
Bond Position:  [7.19086237]


portfolio before change:  [6.50633696]
curr_Stock_Price:  98.64892261705246
curr_Factors:  [9.86489226e+01 3.31201828e-02]
mat_Sqrt:  [[ 1.79530694e+01  0.00000000e+00]
 [-7.27958052e-03  1.66796144e-02]]
grads:  [1.47410617e-03 1.12159260e+01]
Stock Position:  0.001474106165748507
Bond Position:  [6.36091798]


portfolio before change:  [6.50641623]
curr_Stock_Price:  98.16327073426694
curr_Factors:  [9.81632707e+01 3.34430202e-02]
mat_Sqrt:  [[ 1.79515423e+01  0.00000000e+00]
 [-7.31497316e-03  1.67607091e-02]]
grads:  [-0.00885027 -5.88370728]
Stock Position:  -0.008850267122675738
Bond Position:  [7.37518739]


portfolio before change:  [6.5135267]
curr_Stock_Price:  97.46402369963319
curr_Factors:  [9.74640237e+01 3.43692752e-02]
mat_Sqrt:  [[ 1.80688089e+01  0.00000000e+00]
 [-7.41558092e-03  1.69912304e-02]]
grads:  [0.01173452 6.22730637]
Stock Position:  0.011734520289161521
Bond Position:  [5.36983314]


portfolio before change:  [6.52112613]
curr_Stock_Price:  98.05443142544148
curr_Factors:  [9.80544314e+01 3.49810005e-02]
mat_Sqrt:  [[ 1.83393247e+01  0.00000000e+00]
 [-7.48128337e-03  1.71417737e-02]]
grads:  [0.00822089 2.63276148]
Stock Position:  0.008220893650782397
Bond Position:  [5.71503107]


portfolio before change:  [6.51438161]
curr_Stock_Price:  97.1471162906226
curr_Factors:  [9.71471163e+01 3.70338604e-02]
mat_Sqrt:  [[ 1.86951695e+01  0.00000000e+00]
 [-7.69767346e-03  1.76375856e-02]]
grads:  [1.50764043e-02 1.71988906e+01]
Stock Position:  0.015076404328444632
Bond Position:  [5.0497524]


portfolio before change:  [6.51368386]
curr_Stock_Price:  97.0589649813989
curr_Factors:  [9.70589650e+01 3.59882534e-02]
mat_Sqrt:  [[ 1.84126391e+01  0.00000000e+00]
 [-7.58822808e-03  1.73868148e-02]]
grads:  [ 0.0160608  14.11099953]
Stock Position:  0.016060804652336596
Bond Position:  [4.95483879]


portfolio before change:  [6.50504064]
curr_Stock_Price:  96.48224334072944
curr_Factors:  [9.64822433e+01 3.71856906e-02]
mat_Sqrt:  [[ 1.86052418e+01  0.00000000e+00]
 [-7.71343665e-03  1.76737037e-02]]
grads:  [0.01264253 1.23748921]
Stock Position:  0.012642526329323068
Bond Position:  [5.28526134]


portfolio before change:  [6.52372684]
curr_Stock_Price:  97.90802637591595
curr_Factors:  [9.79080264e+01 3.77112737e-02]
mat_Sqrt:  [[ 1.90131422e+01  0.00000000e+00]
 [-7.76775630e-03  1.77981656e-02]]
grads:  [ -0.01766465 -15.50173009]
Stock Position:  -0.017664647403023658
Bond Position:  [8.25323761]


portfolio before change:  [6.51333414]
curr_Stock_Price:  98.55476549338152
curr_Factors:  [9.85547655e+01 3.82648053e-02]
mat_Sqrt:  [[ 1.92786839e+01  0.00000000e+00]
 [-7.82455676e-03  1.79283118e-02]]
grads:  [9.58816002e-03 1.27821778e+01]
Stock Position:  0.009588160018972568
Bond Position:  [5.56837528]


portfolio before change:  [6.51822256]
curr_Stock_Price:  98.99200593278549
curr_Factors:  [9.89920059e+01 3.83401238e-02]
mat_Sqrt:  [[ 1.93832626e+01  0.00000000e+00]
 [-7.83225370e-03  1.79459477e-02]]
grads:  [ 0.0022689  -1.08209509]
Stock Position:  0.0022689027742357616
Bond Position:  [6.29361933]


portfolio before change:  [6.5186056]
curr_Stock_Price:  98.81407153796758
curr_Factors:  [9.88140715e+01 3.73735946e-02]
mat_Sqrt:  [[ 1.91029848e+01  0.00000000e+00]
 [-7.73290057e-03  1.77183011e-02]]
grads:  [-2.59459231e-04  4.77569336e+00]
Stock Position:  -0.0002594592313116238
Bond Position:  [6.54424382]


portfolio before change:  [6.51947314]
curr_Stock_Price:  98.62346656188201
curr_Factors:  [9.86234666e+01 3.74948143e-02]
mat_Sqrt:  [[ 1.90970316e+01  0.00000000e+00]
 [-7.74543110e-03  1.77470122e-02]]
grads:  [3.09693361e-04 2.54189066e+00]
Stock Position:  0.00030969336055605993
Bond Position:  [6.4889301]


portfolio before change:  [6.5201029]
curr_Stock_Price:  98.03771782895615
curr_Factors:  [9.80377178e+01 3.80812933e-02]
mat_Sqrt:  [[ 1.91315007e+01  0.00000000e+00]
 [-7.80577154e-03  1.78852695e-02]]
grads:  [1.86456579e-03 2.55741158e+00]
Stock Position:  0.0018645657887917488
Bond Position:  [6.33730513]


portfolio before change:  [6.51920745]
curr_Stock_Price:  97.13259261924156
curr_Factors:  [9.71325926e+01 3.71672982e-02]
mat_Sqrt:  [[ 1.87260197e+01  0.00000000e+00]
 [-7.71152885e-03  1.76693323e-02]]
grads:  [ 0.00651333 -5.89392587]
Stock Position:  0.006513326144913997
Bond Position:  [5.88655119]


portfolio before change:  [6.52627668]
curr_Stock_Price:  98.10496290052443
curr_Factors:  [9.81049629e+01 3.59739078e-02]
mat_Sqrt:  [[ 1.86073611e+01  0.00000000e+00]
 [-7.58671553e-03  1.73833491e-02]]
grads:  [ 0.00226408 -2.1732285 ]
Stock Position:  0.00226408303220291
Bond Position:  [6.30415889]


portfolio before change:  [6.52373988]
curr_Stock_Price:  96.63643547027431
curr_Factors:  [9.66364355e+01 3.72021460e-02]
mat_Sqrt:  [[ 1.86390983e+01  0.00000000e+00]
 [-7.71514313e-03  1.76776137e-02]]
grads:  [6.17965434e-03 1.17968491e+01]
Stock Position:  0.006179654340804395
Bond Position:  [5.92656011]


portfolio before change:  [6.5241572]
curr_Stock_Price:  96.58407833637213
curr_Factors:  [9.65840783e+01 3.81641676e-02]
mat_Sqrt:  [[ 1.88683289e+01  0.00000000e+00]
 [-7.81426056e-03  1.79047203e-02]]
grads:  [5.31046355e-03 9.14389543e+00]
Stock Position:  0.00531046355077072
Bond Position:  [6.01125097]


portfolio before change:  [6.51702653]
curr_Stock_Price:  95.09981611240389
curr_Factors:  [9.50998161e+01 3.92854159e-02]
mat_Sqrt:  [[ 1.88493056e+01  0.00000000e+00]
 [-7.92821956e-03  1.81658331e-02]]
grads:  [-0.00167067  0.42093937]
Stock Position:  -0.0016706654183180757
Bond Position:  [6.6759065]


portfolio before change:  [6.51688913]
curr_Stock_Price:  95.68158228751454
curr_Factors:  [9.56815823e+01 3.97854866e-02]
mat_Sqrt:  [[ 1.90849350e+01  0.00000000e+00]
 [-7.97851983e-03  1.82810855e-02]]
grads:  [6.08840727e-03 7.42550934e+00]
Stock Position:  0.006088407266143617
Bond Position:  [5.93434069]


portfolio before change:  [6.51539631]
curr_Stock_Price:  95.31454625624797
curr_Factors:  [9.53145463e+01 3.99586874e-02]
mat_Sqrt:  [[ 1.90530625e+01  0.00000000e+00]
 [-7.99586767e-03  1.83208344e-02]]
grads:  [5.39235349e-03 7.07900814e+00]
Stock Position:  0.005392353486094165
Bond Position:  [6.00142658]


portfolio before change:  [6.51464891]
curr_Stock_Price:  95.03681592371741
curr_Factors:  [9.50368159e+01 4.13917888e-02]
mat_Sqrt:  [[ 1.93352136e+01  0.00000000e+00]
 [-8.13798882e-03  1.86464749e-02]]
grads:  [9.21435903e-03 9.38179444e+00]
Stock Position:  0.009214359029867768
Bond Position:  [5.63894557]


portfolio before change:  [6.53229123]
curr_Stock_Price:  96.87496950563849
curr_Factors:  [9.68749695e+01 3.91059645e-02]
mat_Sqrt:  [[ 1.91572462e+01  0.00000000e+00]
 [-7.91009123e-03  1.81242959e-02]]
grads:  [-6.35247143e-03  6.99537943e+00]
Stock Position:  -0.006352471434069567
Bond Position:  [7.14768671]


portfolio before change:  [6.53622127]
curr_Stock_Price:  96.39696321227235
curr_Factors:  [9.63969632e+01 3.90680243e-02]
mat_Sqrt:  [[ 1.90534698e+01  0.00000000e+00]
 [-7.90625315e-03  1.81155018e-02]]
grads:  [-0.01122689 -2.11202408]
Stock Position:  -0.011226894584936947
Bond Position:  [7.61845981]


portfolio before change:  [6.55266421]
curr_Stock_Price:  95.01718948312372
curr_Factors:  [9.50171895e+01 4.01196033e-02]
mat_Sqrt:  [[ 1.90318276e+01  0.00000000e+00]
 [-8.01195140e-03  1.83576869e-02]]
grads:  [ 0.00797264 -4.96115173]
Stock Position:  0.007972640772983508
Bond Position:  [5.79512629]


portfolio before change:  [6.55119578]
curr_Stock_Price:  94.74214019919754
curr_Factors:  [9.47421402e+01 4.14498976e-02]
mat_Sqrt:  [[ 1.92887872e+01  0.00000000e+00]
 [-8.14369917e-03  1.86595590e-02]]
grads:  [-0.06458077 -7.17854295]
Stock Position:  -0.06458076841283518
Bond Position:  [12.66971599]


portfolio before change:  [6.57186673]
curr_Stock_Price:  94.44658572646243
curr_Factors:  [9.44465857e+01 4.12735862e-02]
mat_Sqrt:  [[ 1.91876755e+01  0.00000000e+00]
 [-8.12636068e-03  1.86198315e-02]]
grads:  [8.33115165e-03 1.41531769e+01]
Stock Position:  0.008331151647969564
Bond Position:  [5.7850179]


portfolio before change:  [6.56653572]
curr_Stock_Price:  93.7198946018111
curr_Factors:  [9.37198946e+01 4.25739152e-02]
mat_Sqrt:  [[ 1.93376452e+01  0.00000000e+00]
 [-8.25337896e-03  1.89108669e-02]]
grads:  [-3.36685475e-03 -6.75519462e+00]
Stock Position:  -0.003366854748152755
Bond Position:  [6.882077]


portfolio before change:  [6.57036018]
curr_Stock_Price:  92.83950419342625
curr_Factors:  [9.28395042e+01 4.22642874e-02]
mat_Sqrt:  [[ 1.90862052e+01  0.00000000e+00]
 [-8.22331198e-03  1.88419748e-02]]
grads:  [1.33675012e-03 3.20800975e+00]
Stock Position:  0.0013367501224480591
Bond Position:  [6.44625696]


portfolio before change:  [6.57304004]
curr_Stock_Price:  94.24142745786894
curr_Factors:  [9.42414275e+01 4.09648812e-02]
mat_Sqrt:  [[ 1.90742603e+01  0.00000000e+00]
 [-8.09591316e-03  1.85500674e-02]]
grads:  [1.50205141e-03 8.91002525e+00]
Stock Position:  0.0015020514116820753
Bond Position:  [6.43148457]


portfolio before change:  [6.57403812]
curr_Stock_Price:  94.37064680257558
curr_Factors:  [9.43706468e+01 4.06942626e-02]
mat_Sqrt:  [[ 1.90372198e+01  0.00000000e+00]
 [-8.06912760e-03  1.84886940e-02]]
grads:  [-0.08341095 -5.51976386]
Stock Position:  -0.0834109502455787
Bond Position:  [14.44558344]


portfolio before change:  [6.60305532]
curr_Stock_Price:  94.04441391640724
curr_Factors:  [9.40444139e+01 4.18919043e-02]
mat_Sqrt:  [[ 1.92485516e+01  0.00000000e+00]
 [-8.18700476e-03  1.87587845e-02]]
grads:  [9.54247187e-04 1.21002247e+01]
Stock Position:  0.0009542471872637903
Bond Position:  [6.51331371]


portfolio before change:  [6.60343639]
curr_Stock_Price:  93.59050051345167
curr_Factors:  [9.35905005e+01 4.25234459e-02]
mat_Sqrt:  [[ 1.92994972e+01  0.00000000e+00]
 [-8.24848552e-03  1.88996546e-02]]
grads:  [-4.56930118e-03  5.78644248e+00]
Stock Position:  -0.004569301177149838
Bond Position:  [7.03107958]


portfolio before change:  [6.60241507]
curr_Stock_Price:  94.00637570687417
curr_Factors:  [9.40063757e+01 4.19359876e-02]
mat_Sqrt:  [[ 1.92508871e+01  0.00000000e+00]
 [-8.19131126e-03  1.87686519e-02]]
grads:  [ 0.05913334 -1.90476367]
Stock Position:  0.059133336011200154
Bond Position:  [1.04350447]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.52908679]
Stock Price:  92.76411990211122
PL:  [6.52908679]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.51227160e-01 -4.05481514e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.10500157e-01 -6.86411970e-01]
 [-3.97354703e-02  1.09878374e-01]
 [-2.92654049e-02  1.50722387e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-4.24900647e-03  3.10850388e-01]
 [-8.41623672e-02 -8.01921338e-02]
 [ 1.66385837e-01  8.82569976e-02]
 [ 1.47002304e-01  2.41447481e-02]
 [ 1.25257236e-01  2.17038690e-01]
 [-1.59092931e-02  1.32977611e-01]
 [ 1.27938337e-01  5.05394144e-02]
 [-1.18359478e-01 -1.13986566e-01]
 [ 9.14522500e-02  2.34458427e-01]
 [ 4.02986565e-02  1.31156104e-01]
 [ 9.85351972e-02  2.22804928e-01]
 [ 9.62924829e-02  6.67577425e-02]
 [ 8.87169743e-03  4.71637000e-02]
 [ 3.25150815e-01 -1.14246878e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.75555249e-02  1.16292437e-01]
 [-2.88398646e-02 -9.46110897e-02]
 [-9.65611778e-03 -4.08137773e-02]
 [ 4.71367140e-02  1.49511249e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.62253857e-01  9.69390568e-02]
 [-4.45683390e-01  8.61339881e-02]
 [ 2.44231945e-01 -1.02763980e-01]
 [-1.35575067e+00 -1.52760441e-01]
 [ 9.14855979e-02  3.15875460e-01]
 [-1.31369371e-02 -1.26070817e-01]
 [ 3.51002251e-02  7.74570809e-02]
 [-4.11231087e-02  1.65917400e-01]
 [-1.74817279e+00 -5.98362996e-02]
 [-8.86927540e-02  2.10409694e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.17109682e+00 -3.79867002e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.988272]
curr_Stock_Price:  98.99146389250102
curr_Factors:  [9.89914639e+01 4.07555845e-02]
mat_Sqrt:  [[ 1.99844090e+01  0.00000000e+00]
 [-8.07520497e-03  1.85026190e-02]]
grads:  [-0.01345668 -2.19148172]
Stock Position:  -0.013456681351236
Bond Position:  [-2.65617541]


portfolio before change:  [-3.98766657]
curr_Stock_Price:  98.92179807022383
curr_Factors:  [9.89217981e+01 4.04875809e-02]
mat_Sqrt:  [[ 1.99045753e+01  0.00000000e+00]
 [-8.04861040e-03  1.84416832e-02]]
grads:  [-0.01019788 -4.77241525]
Stock Position:  -0.010197878861857369
Bond Position:  [-2.97887405]


portfolio before change:  [-3.99781196]
curr_Stock_Price:  99.88013529330122
curr_Factors:  [9.98801353e+01 3.84965821e-02]
mat_Sqrt:  [[ 1.95970278e+01  0.00000000e+00]
 [-7.84821835e-03  1.79825273e-02]]
grads:  [ 2.60715767e-02 -3.81710511e+01]
Stock Position:  0.026071576739496907
Bond Position:  [-6.60184457]


portfolio before change:  [-4.0280325]
curr_Stock_Price:  98.75265207536462
curr_Factors:  [9.87526521e+01 3.88267380e-02]
mat_Sqrt:  [[ 1.94587178e+01  0.00000000e+00]
 [-7.88180061e-03  1.80594740e-02]]
grads:  [4.22401090e-04 6.08425108e+00]
Stock Position:  0.00042240108958056647
Bond Position:  [-4.06974573]


portfolio before change:  [-4.02795175]
curr_Stock_Price:  100.1482666997115
curr_Factors:  [1.00148267e+02 3.87534279e-02]
mat_Sqrt:  [[ 1.97150780e+01  0.00000000e+00]
 [-7.87435614e-03  1.80424165e-02]]
grads:  [-0.00115076  0.83537805]
Stock Position:  -0.0011507608882084077
Bond Position:  [-3.91270504]


portfolio before change:  [-4.02858655]
curr_Stock_Price:  100.27486525132359
curr_Factors:  [1.00274865e+02 3.72406104e-02]
mat_Sqrt:  [[ 1.93508694e+01  0.00000000e+00]
 [-7.71913056e-03  1.76867500e-02]]
grads:  [-0.00611966 -3.74952594]
Stock Position:  -0.00611966155709626
Bond Position:  [-3.41493831]


portfolio before change:  [-4.02982265]
curr_Stock_Price:  100.40709523476946
curr_Factors:  [1.00407095e+02 3.75460942e-02]
mat_Sqrt:  [[ 1.94556966e+01  0.00000000e+00]
 [-7.75072582e-03  1.77591439e-02]]
grads:  [6.75469133e-03 1.75036809e+01]
Stock Position:  0.00675469132941875
Bond Position:  [-4.70804158]


portfolio before change:  [-4.04101043]
curr_Stock_Price:  98.8379274208349
curr_Factors:  [9.88379274e+01 3.92174933e-02]
mat_Sqrt:  [[ 1.95732771e+01  0.00000000e+00]
 [-7.92136284e-03  1.81501224e-02]]
grads:  [-0.00608795 -4.41826959]
Stock Position:  -0.0060879475050662135
Bond Position:  [-3.43929032]


portfolio before change:  [-4.03919485]
curr_Stock_Price:  98.46908135255444
curr_Factors:  [9.84690814e+01 4.06582032e-02]
mat_Sqrt:  [[ 1.98551868e+01  0.00000000e+00]
 [-8.06555176e-03  1.84805007e-02]]
grads:  [0.01031994 4.77568216]
Stock Position:  0.01031994061813517
Bond Position:  [-5.05538993]


portfolio before change:  [-4.04154744]
curr_Stock_Price:  98.30235367949656
curr_Factors:  [9.83023537e+01 4.01607237e-02]
mat_Sqrt:  [[ 1.96999299e+01  0.00000000e+00]
 [-8.01605626e-03  1.83670923e-02]]
grads:  [0.00799698 1.31456562]
Stock Position:  0.007996979515720835
Bond Position:  [-4.82766935]


portfolio before change:  [-4.04185407]
curr_Stock_Price:  98.33947529284184
curr_Factors:  [9.83394753e+01 4.12725738e-02]
mat_Sqrt:  [[ 1.99783061e+01  0.00000000e+00]
 [-8.12626101e-03  1.86196031e-02]]
grads:  [1.10109779e-02 1.16564617e+01]
Stock Position:  0.011010977851859999
Bond Position:  [-5.12466786]


portfolio before change:  [-4.03370059]
curr_Stock_Price:  99.13814219401559
curr_Factors:  [9.91381422e+01 4.20253370e-02]
mat_Sqrt:  [[ 2.03234006e+01  0.00000000e+00]
 [-8.20003288e-03  1.87886357e-02]]
grads:  [2.07282703e-03 7.07755543e+00]
Stock Position:  0.002072827027273683
Bond Position:  [-4.23919681]


portfolio before change:  [-4.03512742]
curr_Stock_Price:  98.7054516441641
curr_Factors:  [9.87054516e+01 4.20109618e-02]
mat_Sqrt:  [[ 2.02312377e+01  0.00000000e+00]
 [-8.19863031e-03  1.87854220e-02]]
grads:  [0.00741406 2.69035289]
Stock Position:  0.0074140568312362105
Bond Position:  [-4.76693525]


portfolio before change:  [-4.05305658]
curr_Stock_Price:  96.36756079996685
curr_Factors:  [9.63675608e+01 4.41727365e-02]
mat_Sqrt:  [[ 2.02538700e+01  0.00000000e+00]
 [-8.40692444e-03  1.92626838e-02]]
grads:  [-0.00830001 -5.91748103]
Stock Position:  -0.008300008515032953
Bond Position:  [-3.253205]


portfolio before change:  [-4.05693916]
curr_Stock_Price:  96.78634438420592
curr_Factors:  [9.67863444e+01 4.30965776e-02]
mat_Sqrt:  [[ 2.00925695e+01  0.00000000e+00]
 [-8.30388609e-03  1.90265933e-02]]
grads:  [9.64427654e-03 1.23226698e+01]
Stock Position:  0.00964427654407995
Bond Position:  [-4.99037343]


portfolio before change:  [-4.07293494]
curr_Stock_Price:  95.19245143086792
curr_Factors:  [9.51924514e+01 4.31832490e-02]
mat_Sqrt:  [[ 1.97815432e+01  0.00000000e+00]
 [-8.31223186e-03  1.90457158e-02]]
grads:  [4.93085257e-03 6.88638353e+00]
Stock Position:  0.004930852571860114
Bond Position:  [-4.54231489]


portfolio before change:  [-4.07487911]
curr_Stock_Price:  94.91332241909676
curr_Factors:  [9.49133224e+01 4.16910750e-02]
mat_Sqrt:  [[ 1.93797747e+01  0.00000000e+00]
 [-8.16735698e-03  1.87137658e-02]]
grads:  [1.01020390e-02 1.19059376e+01]
Stock Position:  0.01010203902332387
Bond Position:  [-5.0336972]


portfolio before change:  [-4.07195409]
curr_Stock_Price:  95.26515968060734
curr_Factors:  [9.52651597e+01 4.19196316e-02]
mat_Sqrt:  [[ 1.95048596e+01  0.00000000e+00]
 [-8.18971371e-03  1.87649915e-02]]
grads:  [0.0064306  3.55756849]
Stock Position:  0.006430600011028571
Bond Position:  [-4.68456622]


portfolio before change:  [-4.06559221]
curr_Stock_Price:  96.34553907371091
curr_Factors:  [9.63455391e+01 4.07868216e-02]
mat_Sqrt:  [[ 1.94577018e+01  0.00000000e+00]
 [-8.07829899e-03  1.85097083e-02]]
grads:  [1.51382851e-03 2.54805204e+00]
Stock Position:  0.0015138285080605722
Bond Position:  [-4.21144283]


portfolio before change:  [-4.06846427]
curr_Stock_Price:  94.7960900491101
curr_Factors:  [9.47960900e+01 4.09120103e-02]
mat_Sqrt:  [[ 1.91741374e+01  0.00000000e+00]
 [-8.09068703e-03  1.85380929e-02]]
grads:  [ 0.01435733 -6.16281721]
Stock Position:  0.014357328519731828
Bond Position:  [-5.42948288]


portfolio before change:  [-4.08586172]
curr_Stock_Price:  93.6316171531706
curr_Factors:  [9.36316172e+01 4.23987068e-02]
mat_Sqrt:  [[ 1.9279636e+01  0.0000000e+00]
 [-8.2363785e-03  1.8871914e-02]]
grads:  [ 0.00218514 -2.00181019]
Stock Position:  0.0021851351700379056
Bond Position:  [-4.29045946]


portfolio before change:  [-4.08512483]
curr_Stock_Price:  94.21429424703567
curr_Factors:  [9.42142942e+01 4.25544258e-02]
mat_Sqrt:  [[ 1.94352068e+01  0.00000000e+00]
 [-8.25148964e-03  1.89065379e-02]]
grads:  [1.19364079e-03 6.15091125e+00]
Stock Position:  0.0011936407888920558
Bond Position:  [-4.19758286]


portfolio before change:  [-4.08630159]
curr_Stock_Price:  93.66804289790404
curr_Factors:  [9.36680429e+01 4.30700311e-02]
mat_Sqrt:  [[ 1.94392291e+01  0.00000000e+00]
 [-8.30132820e-03  1.90207324e-02]]
grads:  [-3.60773202e-03 -4.97410340e+00]
Stock Position:  -0.003607732017195311
Bond Position:  [-3.74837239]


portfolio before change:  [-4.08897432]
curr_Stock_Price:  94.2789954387419
curr_Factors:  [9.42789954e+01 4.40547691e-02]
mat_Sqrt:  [[ 1.97884333e+01  0.00000000e+00]
 [-8.39569119e-03  1.92369452e-02]]
grads:  [-1.38811952e-03 -2.12163505e+00]
Stock Position:  -0.0013881195196564393
Bond Position:  [-3.9581038]


portfolio before change:  [-4.08980493]
curr_Stock_Price:  94.52091980786935
curr_Factors:  [9.45209198e+01 4.47072977e-02]
mat_Sqrt:  [[ 1.99855981e+01  0.00000000e+00]
 [-8.45764011e-03  1.93788880e-02]]
grads:  [5.62348809e-03 7.71516144e+00]
Stock Position:  0.005623488094243352
Bond Position:  [-4.6213422]


portfolio before change:  [-4.09654357]
curr_Stock_Price:  93.42534896672537
curr_Factors:  [9.34253490e+01 4.39838464e-02]
mat_Sqrt:  [[ 1.95934689e+01  0.00000000e+00]
 [-8.38893046e-03  1.92214544e-02]]
grads:  [6.40441166e-03 9.47215106e+00]
Stock Position:  0.006404411663378145
Bond Position:  [-4.69487796]


portfolio before change:  [-4.09435061]
curr_Stock_Price:  93.85940215922065
curr_Factors:  [9.38594022e+01 4.32867807e-02]
mat_Sqrt:  [[ 1.95278948e+01  0.00000000e+00]
 [-8.32219016e-03  1.90685332e-02]]
grads:  [9.12344121e-03 9.17414008e+00]
Stock Position:  0.009123441206900465
Bond Position:  [-4.95067134]


portfolio before change:  [-4.09183271]
curr_Stock_Price:  94.20321642433696
curr_Factors:  [9.42032164e+01 4.36270864e-02]
mat_Sqrt:  [[ 1.96763182e+01  0.00000000e+00]
 [-8.35483922e-03  1.91433416e-02]]
grads:  [-0.00609597  5.06385243]
Stock Position:  -0.0060959668728344345
Bond Position:  [-3.51757302]


portfolio before change:  [-4.08211289]
curr_Stock_Price:  92.53661579652928
curr_Factors:  [9.25366158e+01 4.20110867e-02]
mat_Sqrt:  [[ 1.89668658e+01  0.00000000e+00]
 [-8.19864249e-03  1.87854499e-02]]
grads:  [-0.02151602  4.58514374]
Stock Position:  -0.021516018579239553
Bond Position:  [-2.09109335]


portfolio before change:  [-4.08942452]
curr_Stock_Price:  92.86428922407984
curr_Factors:  [9.28642892e+01 4.30333521e-02]
mat_Sqrt:  [[ 1.92642155e+01  0.00000000e+00]
 [-8.29779268e-03  1.90126315e-02]]
grads:  [ 0.01034987 -5.40503717]
Stock Position:  0.010349866954854226
Bond Position:  [-5.05055756]


portfolio before change:  [-4.08781936]
curr_Stock_Price:  93.08038076701372
curr_Factors:  [9.30803808e+01 4.32282506e-02]
mat_Sqrt:  [[ 1.93527186e+01  0.00000000e+00]
 [-8.31656184e-03  1.90556371e-02]]
grads:  [-0.07349979 -8.0165486 ]
Stock Position:  -0.0734997920227923
Bond Position:  [2.75356926]


portfolio before change:  [-4.14704943]
curr_Stock_Price:  93.89091751657428
curr_Factors:  [9.38909175e+01 4.33935605e-02]
mat_Sqrt:  [[ 1.95585307e+01  0.00000000e+00]
 [-8.33244843e-03  1.90920378e-02]]
grads:  [1.17260828e-02 1.65448792e+01]
Stock Position:  0.011726082820440457
Bond Position:  [-5.2480221]


portfolio before change:  [-4.14521042]
curr_Stock_Price:  94.10369590594205
curr_Factors:  [9.41036959e+01 4.37683328e-02]
mat_Sqrt:  [[ 1.96873237e+01  0.00000000e+00]
 [-8.36835303e-03  1.91743056e-02]]
grads:  [-3.46206288e-03 -6.57498739e+00]
Stock Position:  -0.00346206288370052
Bond Position:  [-3.8194175]


portfolio before change:  [-4.14824467]
curr_Stock_Price:  94.8422154437005
curr_Factors:  [9.48422154e+01 4.43355648e-02]
mat_Sqrt:  [[ 1.99699884e+01  0.00000000e+00]
 [-8.42240486e-03  1.92981539e-02]]
grads:  [3.45044099e-03 4.01370417e+00]
Stock Position:  0.003450440992031411
Bond Position:  [-4.47549214]


portfolio before change:  [-4.15164623]
curr_Stock_Price:  94.01852825248497
curr_Factors:  [9.40185283e+01 4.32285462e-02]
mat_Sqrt:  [[ 1.95478395e+01  0.00000000e+00]
 [-8.31659028e-03  1.90557022e-02]]
grads:  [1.60064653e-03 8.70696856e+00]
Stock Position:  0.0016006465335034598
Bond Position:  [-4.30213666]


portfolio before change:  [-4.15309103]
curr_Stock_Price:  93.45188120488557
curr_Factors:  [9.34518812e+01 4.40969244e-02]
mat_Sqrt:  [[ 1.96242107e+01  0.00000000e+00]
 [-8.39970708e-03  1.92461467e-02]]
grads:  [-0.09041319 -3.10900153]
Stock Position:  -0.09041318994457086
Bond Position:  [4.29619166]


portfolio before change:  [-4.15094775]
curr_Stock_Price:  93.43411584271672
curr_Factors:  [9.34341158e+01 4.47170407e-02]
mat_Sqrt:  [[ 1.97579557e+01  0.00000000e+00]
 [-8.45856165e-03  1.93809995e-02]]
grads:  [1.58800089e-04 1.08564935e+01]
Stock Position:  0.00015880008886368452
Bond Position:  [-4.1657851]


portfolio before change:  [-4.15137823]
curr_Stock_Price:  94.0026264937312
curr_Factors:  [9.40026265e+01 4.46537965e-02]
mat_Sqrt:  [[ 1.98641133e+01  0.00000000e+00]
 [-8.45257798e-03  1.93672892e-02]]
grads:  [-4.43942371e-03  5.64672543e+00]
Stock Position:  -0.0044394237068294175
Bond Position:  [-3.73406074]


portfolio before change:  [-4.15114825]
curr_Stock_Price:  93.8456784557983
curr_Factors:  [9.38456785e+01 4.44550670e-02]
mat_Sqrt:  [[ 1.97867703e+01  0.00000000e+00]
 [-8.43374811e-03  1.93241445e-02]]
grads:  [ 0.05834798 -1.96576361]
Stock Position:  0.058347979041531224
Bond Position:  [-9.62685393]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.0987135]
Stock Price:  94.76495938643406
PL:  [-4.0987135]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.75106153e-01  6.00982022e-01]
 [-1.74416753e-01 -7.27506808e-02]
 [ 8.47493118e-01 -7.61918702e-01]
 [-3.27430022e-02  3.86853313e-02]
 [-9.63221972e-02  4.19090282e-02]
 [-7.36072038e-03  1.89649412e-02]
 [ 9.18730622e-04  3.19678294e-01]
 [-4.40180470e-02 -7.15254657e-02]
 [ 1.66059288e-01  9.89481002e-02]
 [ 8.14844233e-02  1.16359521e-01]
 [ 1.21673884e-01  2.04262655e-01]
 [ 6.20647839e-02  1.74266887e-01]
 [ 2.07661978e-01  2.43942422e-02]
 [-1.38241753e-01 -1.45611844e-01]
 [ 8.88674288e-02  2.32393557e-01]
 [ 3.90724301e-02  1.47393047e-01]
 [ 1.05122863e-01  2.42695989e-01]
 [ 1.20564700e-01  7.09742689e-02]
 [ 1.91879127e-02 -4.06327169e-02]
 [ 4.99688923e-01 -1.30612213e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 6.80274452e-03 -8.11874193e-02]
 [-1.12485249e-01  1.14937356e-01]
 [ 8.87635826e-02 -4.01274303e-01]
 [ 9.43857602e-02  3.05441580e-01]
 [-6.17981433e-02  7.92230834e-02]
 [-8.93121449e-02  1.80226556e-01]
 [-1.32690732e-01  3.01237815e-02]
 [-7.13641066e-01  1.72421872e-01]
 [ 2.97052299e-01  1.15817153e-01]
 [-1.81231139e+00 -2.02826451e-01]
 [ 3.48376252e-01  6.35958232e-01]
 [ 3.00539584e-02 -1.41189224e-01]
 [ 4.78221114e-02  2.97633461e-02]
 [ 1.52128323e-02  1.76143732e-01]
 [-2.28788005e+00  4.92997158e-02]
 [-1.02521344e-01  1.69351506e-01]
 [-1.35147772e-01  2.06105344e-02]
 [ 1.31387911e+00 -5.65209725e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.24667046]
curr_Stock_Price:  100.83424425358443
curr_Factors:  [1.00834244e+02 3.95604306e-02]
mat_Sqrt:  [[ 2.00557336e+01  0.00000000e+00]
 [-7.95592163e-03  1.82293065e-02]]
grads:  [2.67951410e-02 3.29679037e+01]
Stock Position:  0.0267951410288714
Bond Position:  [5.54480266]


portfolio before change:  [8.24541015]
curr_Stock_Price:  100.76134108299135
curr_Factors:  [1.00761341e+02 3.87810458e-02]
mat_Sqrt:  [[ 1.98428339e+01  0.00000000e+00]
 [-7.87716150e-03  1.80488444e-02]]
grads:  [-0.01039004 -4.03076669]
Stock Position:  -0.010390035730374118
Bond Position:  [9.29232408]


portfolio before change:  [8.2691343]
curr_Stock_Price:  98.58978604595583
curr_Factors:  [9.8589786e+01 3.9038761e-02]
mat_Sqrt:  [[ 1.94795956e+01  0.00000000e+00]
 [-7.90329156e-03  1.81087159e-02]]
grads:  [ 2.64360999e-02 -4.20746951e+01]
Stock Position:  0.026436099863352658
Bond Position:  [5.66280487]


portfolio before change:  [8.30142203]
curr_Stock_Price:  99.78435865405574
curr_Factors:  [9.97843587e+01 3.86938310e-02]
mat_Sqrt:  [[ 1.96283293e+01  0.00000000e+00]
 [-7.86829902e-03  1.80285379e-02]]
grads:  [-8.07982135e-04  2.14578306e+00]
Stock Position:  -0.0008079821345967363
Bond Position:  [8.38204601]


portfolio before change:  [8.3014813]
curr_Stock_Price:  101.00784106635976
curr_Factors:  [1.01007841e+02 3.78989234e-02]
mat_Sqrt:  [[ 1.96638487e+01  0.00000000e+00]
 [-7.78705833e-03  1.78423921e-02]]
grads:  [-0.00396828  2.34884582]
Stock Position:  -0.003968276951125519
Bond Position:  [8.70230839]


portfolio before change:  [8.29992599]
curr_Stock_Price:  101.67391569638322
curr_Factors:  [1.01673916e+02 3.92238262e-02]
mat_Sqrt:  [[ 2.01365251e+01  0.00000000e+00]
 [-7.92200240e-03  1.81515878e-02]]
grads:  [4.55023167e-05 1.04480894e+00]
Stock Position:  4.5502316691432246e-05
Bond Position:  [8.29529959]


portfolio before change:  [8.30092828]
curr_Stock_Price:  100.91153047498801
curr_Factors:  [1.00911530e+02 4.00498672e-02]
mat_Sqrt:  [[ 2.01948826e+01  0.00000000e+00]
 [-8.00498517e-03  1.83417252e-02]]
grads:  [6.95412689e-03 1.74290199e+01]
Stock Position:  0.006954126892997596
Bond Position:  [7.59917669]


portfolio before change:  [8.28919797]
curr_Stock_Price:  99.0881143764311
curr_Factors:  [9.90881144e+01 4.06258373e-02]
mat_Sqrt:  [[ 1.99720538e+01  0.00000000e+00]
 [-8.06234084e-03  1.84731436e-02]]
grads:  [-3.76697961e-03 -3.87186216e+00]
Stock Position:  -0.0037669796148315994
Bond Position:  [8.66246087]


portfolio before change:  [8.29493412]
curr_Stock_Price:  97.85283373202604
curr_Factors:  [9.78528337e+01 4.02941627e-02]
mat_Sqrt:  [[ 1.96423966e+01  0.00000000e+00]
 [-8.02936238e-03  1.83975805e-02]]
grads:  [0.01065266 5.37832138]
Stock Position:  0.010652660355861562
Bond Position:  [7.25254112]


portfolio before change:  [8.28859942]
curr_Stock_Price:  97.1730674528116
curr_Factors:  [9.71730675e+01 4.20938103e-02]
mat_Sqrt:  [[ 1.99367807e+01  0.00000000e+00]
 [-8.20671045e-03  1.88039359e-02]]
grads:  [0.00663437 6.1880407 ]
Stock Position:  0.0066343650721022536
Bond Position:  [7.64391782]


portfolio before change:  [8.29846573]
curr_Stock_Price:  98.51618842340403
curr_Factors:  [9.85161884e+01 4.20719785e-02]
mat_Sqrt:  [[ 2.02071036e+01  0.00000000e+00]
 [-8.20458199e-03  1.87990590e-02]]
grads:  [1.04330348e-02 1.08655787e+01]
Stock Position:  0.010433034804308256
Bond Position:  [7.27064291]


portfolio before change:  [8.29999863]
curr_Stock_Price:  98.57600019551167
curr_Factors:  [9.85760002e+01 4.25359562e-02]
mat_Sqrt:  [[ 2.03305577e+01  0.00000000e+00]
 [-8.24969877e-03  1.89024345e-02]]
grads:  [6.79376781e-03 9.21928263e+00]
Stock Position:  0.00679376781175312
Bond Position:  [7.63029618]


portfolio before change:  [8.28934336]
curr_Stock_Price:  96.86721023601568
curr_Factors:  [9.68672102e+01 4.22493724e-02]
mat_Sqrt:  [[ 1.99107181e+01  0.00000000e+00]
 [-8.22186085e-03  1.88386499e-02]]
grads:  [0.01096437 1.29490396]
Stock Position:  0.01096437092184676
Bond Position:  [7.22725534]


portfolio before change:  [8.2880104]
curr_Stock_Price:  96.66323823024423
curr_Factors:  [9.66632382e+01 4.20512730e-02]
mat_Sqrt:  [[ 1.98221571e+01  0.00000000e+00]
 [-8.20256281e-03  1.87944325e-02]]
grads:  [-0.01018012 -7.74760526]
Stock Position:  -0.010180121711617342
Bond Position:  [9.27205393]


portfolio before change:  [8.28089301]
curr_Stock_Price:  97.47624113643859
curr_Factors:  [9.74762411e+01 4.22303711e-02]
mat_Sqrt:  [[ 2.00313963e+01  0.00000000e+00]
 [-8.22001179e-03  1.88344131e-02]]
grads:  [9.49970185e-03 1.23387735e+01]
Stock Position:  0.00949970184659246
Bond Position:  [7.35489778]


portfolio before change:  [8.25714091]
curr_Stock_Price:  94.87915723454395
curr_Factors:  [9.48791572e+01 4.39269664e-02]
mat_Sqrt:  [[ 1.98854958e+01  0.00000000e+00]
 [-8.38350441e-03  1.92090218e-02]]
grads:  [5.19977124e-03 7.67311570e+00]
Stock Position:  0.005199771243833169
Bond Position:  [7.76379099]


portfolio before change:  [8.25741605]
curr_Stock_Price:  94.74542308606564
curr_Factors:  [9.47454231e+01 4.39941969e-02]
mat_Sqrt:  [[ 1.98726570e+01  0.00000000e+00]
 [-8.38991746e-03  1.92237159e-02]]
grads:  [1.06198218e-02 1.26248218e+01]
Stock Position:  0.010619821820060054
Bond Position:  [7.25123654]


portfolio before change:  [8.25392803]
curr_Stock_Price:  94.3316229034977
curr_Factors:  [9.43316229e+01 4.34436867e-02]
mat_Sqrt:  [[ 1.96616809e+01  0.00000000e+00]
 [-8.33725967e-03  1.91030618e-02]]
grads:  [0.0077074  3.71533473]
Stock Position:  0.007707398550088976
Bond Position:  [7.52687662]


portfolio before change:  [8.2531177]
curr_Stock_Price:  94.10440656138908
curr_Factors:  [9.41044066e+01 4.20530023e-02]
mat_Sqrt:  [[ 1.92978294e+01  0.00000000e+00]
 [-8.20273147e-03  1.87948189e-02]]
grads:  [ 7.53629418e-05 -2.16191052e+00]
Stock Position:  7.536294183407952e-05
Bond Position:  [8.24602572]


portfolio before change:  [8.25400888]
curr_Stock_Price:  92.25150287004848
curr_Factors:  [9.22515029e+01 4.31177201e-02]
mat_Sqrt:  [[ 1.91558463e+01  0.00000000e+00]
 [-8.30592271e-03  1.90312598e-02]]
grads:  [ 0.02310966 -6.86303559]
Stock Position:  0.023109659185483203
Bond Position:  [6.12210809]


portfolio before change:  [8.24636365]
curr_Stock_Price:  91.88756225593791
curr_Factors:  [9.18875623e+01 4.25209410e-02]
mat_Sqrt:  [[ 1.89477726e+01  0.00000000e+00]
 [-8.24824258e-03  1.88990980e-02]]
grads:  [ 0.00222341 -1.99893083]
Stock Position:  0.0022234070212437344
Bond Position:  [8.0420602]


portfolio before change:  [8.24412851]
curr_Stock_Price:  90.43013307254785
curr_Factors:  [9.04301331e+01 4.07692380e-02]
mat_Sqrt:  [[ 1.82591042e+01  0.00000000e+00]
 [-8.07655749e-03  1.85057180e-02]]
grads:  [-1.56800410e-03 -4.38715316e+00]
Stock Position:  -0.0015680040962068767
Bond Position:  [8.38592333]


portfolio before change:  [8.24554729]
curr_Stock_Price:  90.19386089527373
curr_Factors:  [9.01938609e+01 4.07928001e-02]
mat_Sqrt:  [[ 1.82166593e+01  0.00000000e+00]
 [-8.07889102e-03  1.85110648e-02]]
grads:  [-3.42118022e-03  6.20911640e+00]
Stock Position:  -0.003421180218673325
Bond Position:  [8.55411674]


portfolio before change:  [8.24519987]
curr_Stock_Price:  90.60797236447894
curr_Factors:  [9.06079724e+01 4.04059099e-02]
mat_Sqrt:  [[ 1.82133091e+01  0.00000000e+00]
 [-8.04048854e-03  1.84230737e-02]]
grads:  [-4.74196538e-03 -2.17810725e+01]
Stock Position:  -0.004741965376739708
Bond Position:  [8.67485974]


portfolio before change:  [8.25125663]
curr_Stock_Price:  89.5593920977467
curr_Factors:  [8.95593921e+01 4.02780877e-02]
mat_Sqrt:  [[ 1.79740340e+01  0.00000000e+00]
 [-8.02776061e-03  1.83939103e-02]]
grads:  [1.26677959e-02 1.66055816e+01]
Stock Position:  0.012667795916204178
Bond Position:  [7.11673653]


portfolio before change:  [8.23983964]
curr_Stock_Price:  88.5879020613328
curr_Factors:  [8.85879021e+01 4.08800293e-02]
mat_Sqrt:  [[ 1.79114199e+01  0.00000000e+00]
 [-8.08752415e-03  1.85308458e-02]]
grads:  [-1.51983233e-03  4.27520061e+00]
Stock Position:  -0.0015198323280900502
Bond Position:  [8.3744784]


portfolio before change:  [8.24307171]
curr_Stock_Price:  87.15011432682246
curr_Factors:  [8.71501143e+01 4.11278912e-02]
mat_Sqrt:  [[ 1.76740542e+01  0.00000000e+00]
 [-8.11200505e-03  1.85869386e-02]]
grads:  [-6.02851351e-04  9.69640885e+00]
Stock Position:  -0.0006028513511046255
Bond Position:  [8.29561027]


portfolio before change:  [8.24366485]
curr_Stock_Price:  87.88640951811912
curr_Factors:  [8.78864095e+01 4.11704454e-02]
mat_Sqrt:  [[ 1.78325933e+01  0.00000000e+00]
 [-8.11620063e-03  1.85965519e-02]]
grads:  [-0.00670366  1.61985844]
Stock Position:  -0.006703659626131342
Bond Position:  [8.83282542]


portfolio before change:  [8.2415118]
curr_Stock_Price:  88.37229598098686
curr_Factors:  [8.83722960e+01 3.94519527e-02]
mat_Sqrt:  [[ 1.75529611e+01  0.00000000e+00]
 [-7.94500625e-03  1.82042963e-02]]
grads:  [-0.03636936  9.47149339]
Stock Position:  -0.03636936174510312
Bond Position:  [11.4555558]


portfolio before change:  [8.25964423]
curr_Stock_Price:  87.91310756386264
curr_Factors:  [8.79131076e+01 3.97267620e-02]
mat_Sqrt:  [[ 1.75224656e+01  0.00000000e+00]
 [-7.97262937e-03  1.82675888e-02]]
grads:  [0.01983734 6.34003504]
Stock Position:  0.019837336658719704
Bond Position:  [6.51568232]


portfolio before change:  [8.27431711]
curr_Stock_Price:  88.61170797790419
curr_Factors:  [8.86117080e+01 3.86653704e-02]
mat_Sqrt:  [[ 1.74241738e+01  0.00000000e+00]
 [-7.86540480e-03  1.80219064e-02]]
grads:  [ -0.10909166 -11.25443924]
Stock Position:  -0.10909166345687293
Bond Position:  [17.94111574]


portfolio before change:  [8.18660546]
curr_Stock_Price:  89.43628459820451
curr_Factors:  [8.94362846e+01 3.93068973e-02]
mat_Sqrt:  [[ 1.77316084e+01  0.00000000e+00]
 [-7.93038686e-03  1.81707990e-02]]
grads:  [ 0.0353003  34.99891397]
Stock Position:  0.03530030470362829
Bond Position:  [5.02947736]


portfolio before change:  [8.24351795]
curr_Stock_Price:  91.03071202506965
curr_Factors:  [9.10307120e+01 3.86309346e-02]
mat_Sqrt:  [[ 1.78918623e+01  0.00000000e+00]
 [-7.86190151e-03  1.80138794e-02]]
grads:  [-1.76426971e-03 -7.83780223e+00]
Stock Position:  -0.001764269712498936
Bond Position:  [8.40412068]


portfolio before change:  [8.24476196]
curr_Stock_Price:  90.92107504239995
curr_Factors:  [9.09210750e+01 3.93370056e-02]
mat_Sqrt:  [[ 1.80328849e+01  0.00000000e+00]
 [-7.93342353e-03  1.81777569e-02]]
grads:  [0.00337228 1.63734977]
Stock Position:  0.0033722779742750685
Bond Position:  [7.93815082]


portfolio before change:  [8.23903709]
curr_Stock_Price:  88.92918527440126
curr_Factors:  [8.89291853e+01 4.04704095e-02]
mat_Sqrt:  [[ 1.78901142e+01  0.00000000e+00]
 [-8.04690345e-03  1.84377721e-02]]
grads:  [5.14743833e-03 9.55341737e+00]
Stock Position:  0.005147438331064743
Bond Position:  [7.78127959]


portfolio before change:  [8.25072899]
curr_Stock_Price:  91.01161533978375
curr_Factors:  [9.10116153e+01 3.81260728e-02]
mat_Sqrt:  [[ 1.77708360e+01  0.00000000e+00]
 [-7.81035956e-03  1.78957819e-02]]
grads:  [-0.12753277  2.75482323]
Stock Position:  -0.12753276691726664
Bond Position:  [19.85769211]


portfolio before change:  [8.1238101]
curr_Stock_Price:  92.02626634922797
curr_Factors:  [9.20262663e+01 3.89844769e-02]
mat_Sqrt:  [[ 1.81701143e+01  0.00000000e+00]
 [-7.89779483e-03  1.80961213e-02]]
grads:  [-1.57457940e-03  9.35844224e+00]
Stock Position:  -0.0015745794009928969
Bond Position:  [8.26871277]


portfolio before change:  [8.12454811]
curr_Stock_Price:  92.21403034660436
curr_Factors:  [9.22140303e+01 3.94955072e-02]
mat_Sqrt:  [[ 1.83261337e+01  0.00000000e+00]
 [-7.94939064e-03  1.82143422e-02]]
grads:  [-0.00688375  1.13155525]
Stock Position:  -0.006883754071047385
Bond Position:  [8.75932682]


portfolio before change:  [8.12288197]
curr_Stock_Price:  92.61513830714587
curr_Factors:  [9.26151383e+01 3.90843833e-02]
mat_Sqrt:  [[ 1.83098005e+01  0.00000000e+00]
 [-7.90790827e-03  1.81192941e-02]]
grads:  [ 0.070411   -3.11938049]
Stock Position:  0.07041099884669151
Bond Position:  [1.60175757]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.17596959]
Stock Price:  93.36626228251112
PL:  [8.17596959]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-4.44675811e-02  2.05227688e-01]
 [-1.75015523e-01 -8.41762196e-02]
 [ 9.21994869e-01 -9.40028620e-01]
 [-2.16865666e-03  2.85652295e-01]
 [-4.03768949e-03 -1.59769894e-01]
 [-6.83604581e-02 -9.81872305e-03]
 [-1.50451506e-01  5.18434682e-02]
 [ 2.44178799e-01 -1.86721301e-01]
 [ 1.50986729e-01  1.85705662e-01]
 [-1.26508375e-01  4.08314727e-01]
 [ 1.88351203e-01  4.90893992e-01]
 [ 1.73324399e-01  2.61417467e-01]
 [ 3.39153123e-01  2.41408483e-02]
 [ 1.41829556e-02  1.57559788e-01]
 [ 9.94396274e-02  2.48954730e-01]
 [ 3.20953283e-02  2.39811188e-01]
 [ 2.21483852e-01  5.88787953e-01]
 [ 1.58813463e-01  7.15817661e-02]
 [ 1.94442352e-02 -4.69972424e-02]
 [ 3.42859727e-01 -1.15478781e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-1.61031897e-02  1.26961260e-01]
 [-3.62862785e-02 -1.20571026e-01]
 [-1.01955077e-02 -3.97753603e-02]
 [ 4.47759184e-02  1.52112029e-01]
 [ 4.41853253e-02  1.56990944e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.69079544e-01  1.11986712e-01]
 [-2.27070858e-01 -2.36898850e-02]
 [ 2.00372569e-01 -9.31511836e-02]
 [-1.18524360e+00 -1.34477965e-01]
 [-1.24327909e-01  6.71788863e-02]
 [-8.47447848e-03 -1.11633016e-01]
 [ 5.76199097e-02  8.55904052e-02]
 [-6.89539972e-02  1.61294026e-01]
 [-9.74618662e-01 -2.16903367e-01]
 [-2.57038058e-02  3.10656747e-01]
 [-1.24851996e-01  1.16824826e-01]
 [ 5.21727205e-01  4.17495081e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.64776286]
curr_Stock_Price:  99.68972577819176
curr_Factors:  [9.96897258e+01 4.01047279e-02]
mat_Sqrt:  [[ 1.99640288e+01  0.00000000e+00]
 [-8.01046595e-03  1.83542833e-02]]
grads:  [2.25911942e-03 1.11814602e+01]
Stock Position:  0.0022591194178075416
Bond Position:  [0.42255187]


portfolio before change:  [0.64048622]
curr_Stock_Price:  96.44533595994191
curr_Factors:  [9.6445336e+01 4.0216803e-02]
mat_Sqrt:  [[ 1.93412706e+01  0.00000000e+00]
 [-8.02165100e-03  1.83799115e-02]]
grads:  [-0.01094825 -4.57979462]
Stock Position:  -0.010948248502053178
Bond Position:  [1.69639373]


portfolio before change:  [0.64691761]
curr_Stock_Price:  95.87726990959105
curr_Factors:  [9.58772699e+01 4.01446521e-02]
mat_Sqrt:  [[ 1.92100948e+01  0.00000000e+00]
 [-8.01445215e-03  1.83634168e-02]]
grads:  [ 2.66387412e-02 -5.11902893e+01]
Stock Position:  0.026638741237670314
Bond Position:  [-1.90713217]


portfolio before change:  [0.6540735]
curr_Stock_Price:  96.1548468239697
curr_Factors:  [9.61548468e+01 4.08427192e-02]
mat_Sqrt:  [[ 1.94324923e+01  0.00000000e+00]
 [-8.08383267e-03  1.85223876e-02]]
grads:  [6.30388649e-03 1.54220018e+01]
Stock Position:  0.006303886489778632
Bond Position:  [0.04792426]


portfolio before change:  [0.64711785]
curr_Stock_Price:  95.05050529890883
curr_Factors:  [9.50505053e+01 4.19669034e-02]
mat_Sqrt:  [[ 1.94718804e+01  0.00000000e+00]
 [-8.19433008e-03  1.87755689e-02]]
grads:  [-3.78838544e-03 -8.50945689e+00]
Stock Position:  -0.003788385438389136
Bond Position:  [1.0072058]


portfolio before change:  [0.650175]
curr_Stock_Price:  94.27676261897221
curr_Factors:  [9.42767626e+01 4.23845676e-02]
mat_Sqrt:  [[ 1.94092404e+01  0.00000000e+00]
 [-8.23500505e-03  1.88687670e-02]]
grads:  [-0.00374284 -0.52036909]
Stock Position:  -0.0037428409688123046
Bond Position:  [1.00303792]


portfolio before change:  [0.6456523]
curr_Stock_Price:  95.51862187188328
curr_Factors:  [9.55186219e+01 4.16277403e-02]
mat_Sqrt:  [[ 1.94885472e+01  0.00000000e+00]
 [-8.16115093e-03  1.86995459e-02]]
grads:  [-0.00655899  2.7724453 ]
Stock Position:  -0.00655898870536555
Bond Position:  [1.27215786]


portfolio before change:  [0.65408281]
curr_Stock_Price:  94.25753132085262
curr_Factors:  [9.42575313e+01 4.37008929e-02]
mat_Sqrt:  [[ 1.97043093e+01  0.00000000e+00]
 [-8.36190341e-03  1.91595277e-02]]
grads:  [ 8.25641435e-03 -9.74561086e+00]
Stock Position:  0.00825641435039013
Bond Position:  [-0.12414642]


portfolio before change:  [0.63840478]
curr_Stock_Price:  92.36052061405032
curr_Factors:  [9.23605206e+01 4.48523547e-02]
mat_Sqrt:  [[ 1.95604570e+01  0.00000000e+00]
 [-8.47134981e-03  1.94103009e-02]]
grads:  [0.01186247 9.5673768 ]
Stock Position:  0.011862469533092827
Bond Position:  [-0.45721908]


portfolio before change:  [0.65308271]
curr_Stock_Price:  93.60268064034622
curr_Factors:  [9.36026806e+01 4.51332037e-02]
mat_Sqrt:  [[ 1.98854932e+01  0.00000000e+00]
 [-8.49783066e-03  1.94709761e-02]]
grads:  [2.59962280e-03 2.09704292e+01]
Stock Position:  0.002599622801657292
Bond Position:  [0.40975105]


portfolio before change:  [0.65666014]
curr_Stock_Price:  94.9591089891338
curr_Factors:  [9.49591090e+01 4.64840035e-02]
mat_Sqrt:  [[ 2.04733256e+01  0.00000000e+00]
 [-8.62405969e-03  1.97602032e-02]]
grads:  [1.9664363e-02 2.4842558e+01]
Stock Position:  0.01966436298174428
Bond Position:  [-1.21065025]


portfolio before change:  [0.68621423]
curr_Stock_Price:  96.46973165308253
curr_Factors:  [9.64697317e+01 4.56420181e-02]
mat_Sqrt:  [[ 2.06097864e+01  0.00000000e+00]
 [-8.54559705e-03  1.95804227e-02]]
grads:  [ 0.01394562 13.35096136]
Stock Position:  0.013945624175759438
Bond Position:  [-0.65911639]


portfolio before change:  [0.65367331]
curr_Stock_Price:  94.14222542211732
curr_Factors:  [9.41422254e+01 4.71848526e-02]
mat_Sqrt:  [[ 2.04496445e+01  0.00000000e+00]
 [-8.68882985e-03  1.99086102e-02]]
grads:  [0.01710001 1.2125833 ]
Stock Position:  0.017100006493485247
Bond Position:  [-0.95615936]


portfolio before change:  [0.6340249]
curr_Stock_Price:  93.00018602280464
curr_Factors:  [9.30001860e+01 4.75560367e-02]
mat_Sqrt:  [[ 2.02808729e+01  0.00000000e+00]
 [-8.72293865e-03  1.99867633e-02]]
grads:  [4.08994648e-03 7.88320678e+00]
Stock Position:  0.00408994647662402
Bond Position:  [0.25365912]


portfolio before change:  [0.62916825]
curr_Stock_Price:  91.8049736732298
curr_Factors:  [9.18049737e+01 4.77277726e-02]
mat_Sqrt:  [[ 2.00563451e+01  0.00000000e+00]
 [-8.73867474e-03  2.00228192e-02]]
grads:  [1.03753889e-02 1.24335503e+01]
Stock Position:  0.010375388855450298
Bond Position:  [-0.32334405]


portfolio before change:  [0.64249907]
curr_Stock_Price:  93.09371951713285
curr_Factors:  [9.30937195e+01 4.60502334e-02]
mat_Sqrt:  [[ 1.99772774e+01  0.00000000e+00]
 [-8.58372725e-03  1.96677899e-02]]
grads:  [6.84565312e-03 1.21930928e+01]
Stock Position:  0.006845653119339818
Bond Position:  [0.00521176]


portfolio before change:  [0.63390301]
curr_Stock_Price:  91.83792807458683
curr_Factors:  [9.18379281e+01 4.76804014e-02]
mat_Sqrt:  [[ 2.00535853e+01  0.00000000e+00]
 [-8.73433697e-03  2.00128801e-02]]
grads:  [2.38586754e-02 2.94204507e+01]
Stock Position:  0.023858675441834332
Bond Position:  [-1.55722831]


portfolio before change:  [0.65021448]
curr_Stock_Price:  92.529757592157
curr_Factors:  [9.25297576e+01 4.85165996e-02]
mat_Sqrt:  [[ 2.03810522e+01  0.00000000e+00]
 [-8.81059359e-03  2.01876060e-02]]
grads:  [0.00932505 3.54582738]
Stock Position:  0.00932504880634099
Bond Position:  [-0.21263002]


portfolio before change:  [0.66290836]
curr_Stock_Price:  93.89387490272428
curr_Factors:  [9.38938749e+01 4.62974769e-02]
mat_Sqrt:  [[ 2.02030028e+01  0.00000000e+00]
 [-8.60673939e-03  1.97205174e-02]]
grads:  [-5.28160594e-05 -2.38316478e+00]
Stock Position:  -5.281605943723301e-05
Bond Position:  [0.66786747]


portfolio before change:  [0.66295906]
curr_Stock_Price:  94.51466973327372
curr_Factors:  [9.45146697e+01 4.68023608e-02]
mat_Sqrt:  [[ 2.04471650e+01  0.00000000e+00]
 [-8.65354131e-03  1.98277540e-02]]
grads:  [ 0.01430324 -5.82409789]
Stock Position:  0.014303237440229575
Bond Position:  [-0.6889067]


portfolio before change:  [0.65147168]
curr_Stock_Price:  93.71755938137782
curr_Factors:  [9.37175594e+01 4.63057928e-02]
mat_Sqrt:  [[ 2.01668762e+01  0.00000000e+00]
 [-8.60751233e-03  1.97222884e-02]]
grads:  [ 0.002089   -1.91549727]
Stock Position:  0.0020890003093750383
Bond Position:  [0.45569567]


portfolio before change:  [0.65309186]
curr_Stock_Price:  94.46586545424722
curr_Factors:  [9.44658655e+01 4.45738047e-02]
mat_Sqrt:  [[ 1.99441146e+01  0.00000000e+00]
 [-8.44500370e-03  1.93499343e-02]]
grads:  [1.97086949e-03 6.56132768e+00]
Stock Position:  0.001970869487454652
Bond Position:  [0.46691197]


portfolio before change:  [0.65100425]
curr_Stock_Price:  93.37701584719159
curr_Factors:  [9.33770158e+01 4.36855380e-02]
mat_Sqrt:  [[ 1.95168100e+01  0.00000000e+00]
 [-8.36043425e-03  1.91561614e-02]]
grads:  [-4.55544673e-03 -6.29411204e+00]
Stock Position:  -0.004555446730446131
Bond Position:  [1.07637827]


portfolio before change:  [0.64694762]
curr_Stock_Price:  94.29705391115814
curr_Factors:  [9.42970539e+01 4.34945756e-02]
mat_Sqrt:  [[ 1.96659836e+01  0.00000000e+00]
 [-8.34214127e-03  1.91142469e-02]]
grads:  [-1.40114518e-03 -2.08092741e+00]
Stock Position:  -0.0014011451766422851
Bond Position:  [0.77907148]


portfolio before change:  [0.64707643]
curr_Stock_Price:  94.27462872950998
curr_Factors:  [9.42746287e+01 4.52253256e-02]
mat_Sqrt:  [[ 2.00486753e+01  0.00000000e+00]
 [-8.50649875e-03  1.94908372e-02]]
grads:  [5.54465813e-03 7.80428399e+00]
Stock Position:  0.005544658132325702
Bond Position:  [0.12435584]


portfolio before change:  [0.64871319]
curr_Stock_Price:  94.56701984723976
curr_Factors:  [9.45670198e+01 4.76205194e-02]
mat_Sqrt:  [[ 2.06365345e+01  0.00000000e+00]
 [-8.72885050e-03  2.00003091e-02]]
grads:  [5.46127502e-03 7.84942587e+00]
Stock Position:  0.00546127502490149
Bond Position:  [0.13225668]


portfolio before change:  [0.6565863]
curr_Stock_Price:  96.00561817440915
curr_Factors:  [9.60056182e+01 4.77316714e-02]
mat_Sqrt:  [[ 2.09749034e+01  0.00000000e+00]
 [-8.73903166e-03  2.00236370e-02]]
grads:  [8.49403675e-03 8.73654442e+00]
Stock Position:  0.008494036748086997
Bond Position:  [-0.15888895]


portfolio before change:  [0.65333824]
curr_Stock_Price:  95.62556327620855
curr_Factors:  [9.56255633e+01 4.85433799e-02]
mat_Sqrt:  [[ 2.10687617e+01  0.00000000e+00]
 [-8.81302490e-03  2.01931768e-02]]
grads:  [-0.00570534  5.54576989]
Stock Position:  -0.005705344093995582
Bond Position:  [1.19891498]


portfolio before change:  [0.65172647]
curr_Stock_Price:  95.93433395085496
curr_Factors:  [9.59343340e+01 4.86352402e-02]
mat_Sqrt:  [[ 2.11567813e+01  0.00000000e+00]
 [-8.82135955e-03  2.02122739e-02]]
grads:  [-0.01122146 -1.17205442]
Stock Position:  -0.011221459806029087
Bond Position:  [1.72824974]


portfolio before change:  [0.6651359]
curr_Stock_Price:  94.75860555826857
curr_Factors:  [9.47586056e+01 4.96091102e-02]
mat_Sqrt:  [[ 2.11056815e+01  0.00000000e+00]
 [-8.90924106e-03  2.04136358e-02]]
grads:  [ 0.00756754 -4.56318436]
Stock Position:  0.007567538619494741
Bond Position:  [-0.05195351]


portfolio before change:  [0.66494225]
curr_Stock_Price:  94.73387461394117
curr_Factors:  [9.47338746e+01 4.92673542e-02]
mat_Sqrt:  [[ 2.10273682e+01  0.00000000e+00]
 [-8.87850026e-03  2.03431997e-02]]
grads:  [-0.05915788 -6.61046279]
Stock Position:  -0.05915788345569211
Bond Position:  [6.26919777]


portfolio before change:  [0.55541216]
curr_Stock_Price:  96.59860996279937
curr_Factors:  [9.65986100e+01 4.83236971e-02]
mat_Sqrt:  [[ 2.12349359e+01  0.00000000e+00]
 [-8.79306064e-03  2.01474330e-02]]
grads:  [-0.00447417  3.33436455]
Stock Position:  -0.004474166542035776
Bond Position:  [0.98761043]


portfolio before change:  [0.55680338]
curr_Stock_Price:  96.31525735103686
curr_Factors:  [9.63152574e+01 4.92550711e-02]
mat_Sqrt:  [[ 2.13757108e+01  0.00000000e+00]
 [-8.87739341e-03  2.03406636e-02]]
grads:  [-2.67570616e-03 -5.48816981e+00]
Stock Position:  -0.0026757061594059775
Bond Position:  [0.81451471]


portfolio before change:  [0.55806807]
curr_Stock_Price:  95.88065435908223
curr_Factors:  [9.58806544e+01 4.93039404e-02]
mat_Sqrt:  [[ 2.12898109e+01  0.00000000e+00]
 [-8.88179625e-03  2.03507518e-02]]
grads:  [0.00446104 4.20576134]
Stock Position:  0.004461036570977501
Bond Position:  [0.13034097]


portfolio before change:  [0.56090486]
curr_Stock_Price:  96.51290517681757
curr_Factors:  [9.65129052e+01 4.95121889e-02]
mat_Sqrt:  [[ 2.14754094e+01  0.00000000e+00]
 [-8.90053382e-03  2.03936850e-02]]
grads:  [6.70761118e-05 7.90901823e+00]
Stock Position:  6.707611177123327e-05
Bond Position:  [0.55443115]


portfolio before change:  [0.56100306]
curr_Stock_Price:  96.94368288747387
curr_Factors:  [9.69436829e+01 4.81119079e-02]
mat_Sqrt:  [[ 2.12640412e+01  0.00000000e+00]
 [-8.77377072e-03  2.01032342e-02]]
grads:  [ -0.05028598 -10.78947617]
Stock Position:  -0.050285975457981344
Bond Position:  [5.43591072]


portfolio before change:  [0.4858181]
curr_Stock_Price:  98.45234401116436
curr_Factors:  [9.84523440e+01 4.65275537e-02]
mat_Sqrt:  [[ 2.12364133e+01  0.00000000e+00]
 [-8.62809862e-03  1.97694575e-02]]
grads:  [5.17403350e-03 1.57139743e+01]
Stock Position:  0.005174033495770709
Bond Position:  [-0.02357763]


portfolio before change:  [0.49112276]
curr_Stock_Price:  99.4781601228475
curr_Factors:  [9.94781601e+01 4.57641816e-02]
mat_Sqrt:  [[ 2.12809296e+01  0.00000000e+00]
 [-8.55702580e-03  1.96066092e-02]]
grads:  [-3.47096970e-03  5.95844107e+00]
Stock Position:  -0.0034709696974441
Bond Position:  [0.83640844]


portfolio before change:  [0.49312937]
curr_Stock_Price:  98.93017060126417
curr_Factors:  [9.89301706e+01 4.50447236e-02]
mat_Sqrt:  [[ 2.09966844e+01  0.00000000e+00]
 [-8.48949691e-03  1.94518811e-02]]
grads:  [0.02571588 2.1462967 ]
Stock Position:  0.025715878444836044
Bond Position:  [-2.05094687]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.48438474]
Stock Price:  98.60009240946174
PL:  [0.48438474]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.33206516e-01  9.72908198e-02]
 [-1.64676359e-01 -8.74323769e-02]
 [ 8.10982454e-01 -6.87445431e-01]
 [-1.66840933e-03  2.44958036e-02]
 [-1.11398649e-01  4.79427729e-02]
 [-6.19380238e-02 -5.50548173e-02]
 [ 2.35111832e-03  3.17865263e-01]
 [ 2.18195570e-01 -2.09544465e-03]
 [ 2.91092130e-02  6.76588374e-02]
 [ 5.12426142e-01 -3.67768613e-01]
 [ 5.77004496e-02 -2.17726214e-02]
 [-1.91822006e-01 -1.85824390e-01]
 [-1.20658004e-01  1.28472329e-01]
 [-6.80034558e-01 -9.10140227e-01]
 [ 6.06068584e-03 -9.19297306e-02]
 [ 4.18964388e-03 -1.67785154e-01]
 [-5.09313763e-02  1.56025674e-01]
 [ 4.49258798e-02  1.43022309e-01]
 [ 1.54434198e-02  5.23436074e-02]
 [-1.05481947e-01 -3.15509250e-02]
 [ 2.20874103e-01  3.12089698e-01]
 [ 3.62014408e-02  4.51456068e-02]
 [-8.70049229e-03  1.11571646e-01]
 [ 7.22012067e-02  1.81844075e-01]
 [ 4.84452523e-02  1.05203832e-01]
 [ 7.25080914e-01 -3.53177148e-01]
 [-3.27133049e-01  4.22615954e-01]
 [ 1.42628825e-01 -9.31968896e-03]
 [-4.52888196e-02 -6.48930750e-02]
 [-5.83464830e-02 -8.31674818e-02]
 [-3.47193238e-01 -9.24797295e-02]
 [-4.44503492e-02 -3.95238955e-03]
 [ 1.25500000e-01  9.62501047e-02]
 [ 1.85396951e-01  4.88065739e-02]
 [-2.34224195e-01 -2.11638321e-01]
 [ 1.13888030e-01 -2.90949875e-01]
 [-1.63559879e-01  2.13351514e-01]
 [-1.22811899e-01  1.18201117e-01]
 [ 2.23816582e-03  1.04932470e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.41453265]
curr_Stock_Price:  99.37911069485097
curr_Factors:  [9.93791107e+01 4.10408214e-02]
mat_Sqrt:  [[ 2.01327513e+01  0.00000000e+00]
 [-8.10341374e-03  1.85672534e-02]]
grads:  [-4.50734824e-03  5.23991447e+00]
Stock Position:  -0.004507348244259863
Bond Position:  [-0.96659639]


portfolio before change:  [-1.41285287]
curr_Stock_Price:  98.97962584133846
curr_Factors:  [9.89796258e+01 4.17375818e-02]
mat_Sqrt:  [[ 2.02213175e+01  0.00000000e+00]
 [-8.17191109e-03  1.87242006e-02]]
grads:  [-0.01003075 -4.66948517]
Stock Position:  -0.010030749804504984
Bond Position:  [-0.420013]


portfolio before change:  [-1.42126124]
curr_Stock_Price:  99.81265120386384
curr_Factors:  [9.98126512e+01 4.14537401e-02]
mat_Sqrt:  [[ 2.03220470e+01  0.00000000e+00]
 [-8.14407663e-03  1.86604238e-02]]
grads:  [ 2.51429726e-02 -3.68397545e+01]
Stock Position:  0.025142972565041378
Bond Position:  [-3.93084799]


portfolio before change:  [-1.40492482]
curr_Stock_Price:  100.48193603109763
curr_Factors:  [1.00481936e+02 4.00841151e-02]
mat_Sqrt:  [[ 2.01175062e+01  0.00000000e+00]
 [-8.00840710e-03  1.83495659e-02]]
grads:  [4.48486792e-04 1.33495276e+00]
Stock Position:  0.00044848679176401427
Bond Position:  [-1.44998964]


portfolio before change:  [-1.40475918]
curr_Stock_Price:  101.25541260376585
curr_Factors:  [1.01255413e+02 3.94107128e-02]
mat_Sqrt:  [[ 2.01013577e+01  0.00000000e+00]
 [-7.94085263e-03  1.81947791e-02]]
grads:  [-0.00450093  2.63497416]
Stock Position:  -0.004500925194042875
Bond Position:  [-0.94901614]


portfolio before change:  [-1.40319025]
curr_Stock_Price:  100.88047438915557
curr_Factors:  [1.00880474e+02 3.87649449e-02]
mat_Sqrt:  [[ 1.98621703e+01  0.00000000e+00]
 [-7.87552613e-03  1.80450973e-02]]
grads:  [-0.00432812 -3.05095707]
Stock Position:  -0.004328122991241492
Bond Position:  [-0.96656715]


portfolio before change:  [-1.40374785]
curr_Stock_Price:  100.9813901562636
curr_Factors:  [1.00981390e+02 3.91180955e-02]
mat_Sqrt:  [[ 1.99723973e+01  0.00000000e+00]
 [-7.91131802e-03  1.81271068e-02]]
grads:  [7.06369348e-03 1.75353555e+01]
Stock Position:  0.007063693479838148
Bond Position:  [-2.11704944]


portfolio before change:  [-1.40379419]
curr_Stock_Price:  101.01229603054817
curr_Factors:  [1.01012296e+02 3.89380729e-02]
mat_Sqrt:  [[ 1.99324861e+01  0.00000000e+00]
 [-7.89309297e-03  1.80853480e-02]]
grads:  [ 0.01090085 -0.11586422]
Stock Position:  0.010900850091935926
Bond Position:  [-2.50491409]


portfolio before change:  [-1.38111956]
curr_Stock_Price:  103.12110076128036
curr_Factors:  [1.03121101e+02 3.95548216e-02]
mat_Sqrt:  [[ 2.05091308e+01  0.00000000e+00]
 [-7.95535760e-03  1.82280142e-02]]
grads:  [2.85911437e-03 3.71180517e+00]
Stock Position:  0.0028591143651380936
Bond Position:  [-1.67595458]


portfolio before change:  [-1.37869707]
curr_Stock_Price:  104.04166516299529
curr_Factors:  [1.04041665e+02 3.89765629e-02]
mat_Sqrt:  [[ 2.05404079e+01  0.00000000e+00]
 [-7.89699313e-03  1.80942844e-02]]
grads:  [ 1.71329977e-02 -2.03251262e+01]
Stock Position:  0.017132997683905145
Bond Position:  [-3.16124268]


portfolio before change:  [-1.34886985]
curr_Stock_Price:  105.80565270994192
curr_Factors:  [1.05805653e+02 3.74490942e-02]
mat_Sqrt:  [[ 2.04752649e+01  0.00000000e+00]
 [-7.74070738e-03  1.77361887e-02]]
grads:  [ 0.00235397 -1.22758174]
Stock Position:  0.0023539670325278344
Bond Position:  [-1.59793287]


portfolio before change:  [-1.35284233]
curr_Stock_Price:  104.20294555442769
curr_Factors:  [1.04202946e+02 3.79397239e-02]
mat_Sqrt:  [[ 2.02967769e+01  0.00000000e+00]
 [-7.79124882e-03  1.78519937e-02]]
grads:  [ -0.01344659 -10.40916731]
Stock Position:  -0.013446589053442298
Bond Position:  [0.04833186]


portfolio before change:  [-1.35170575]
curr_Stock_Price:  104.11886917421324
curr_Factors:  [1.04118869e+02 3.73684721e-02]
mat_Sqrt:  [[ 2.01271421e+01  0.00000000e+00]
 [-7.73237061e-03  1.77170868e-02]]
grads:  [-3.20900415e-03  7.25132353e+00]
Stock Position:  -0.003209004146950706
Bond Position:  [-1.01758786]


portfolio before change:  [-1.35101228]
curr_Stock_Price:  103.86313034198753
curr_Factors:  [1.03863130e+02 3.75335714e-02]
mat_Sqrt:  [[ 2.01220097e+01  0.00000000e+00]
 [-7.74943316e-03  1.77561820e-02]]
grads:  [ -0.05353602 -51.25765355]
Stock Position:  -0.05353602034332672
Bond Position:  [4.20940637]


portfolio before change:  [-1.3351076]
curr_Stock_Price:  103.5758755212839
curr_Factors:  [1.03575876e+02 3.74958247e-02]
mat_Sqrt:  [[ 2.00562654e+01  0.00000000e+00]
 [-7.74553546e-03  1.77472513e-02]]
grads:  [-1.69825923e-03 -5.17994191e+00]
Stock Position:  -0.0016982592322398473
Bond Position:  [-1.15920891]


portfolio before change:  [-1.33733858]
curr_Stock_Price:  104.80423462780323
curr_Factors:  [1.04804235e+02 3.69213213e-02]
mat_Sqrt:  [[ 2.01380515e+01  0.00000000e+00]
 [-7.68596865e-03  1.76107666e-02]]
grads:  [-3.42822644e-03 -9.52741912e+00]
Stock Position:  -0.003428226443535687
Bond Position:  [-0.97804593]


portfolio before change:  [-1.33977599]
curr_Stock_Price:  105.47955387532069
curr_Factors:  [1.05479554e+02 3.62098982e-02]
mat_Sqrt:  [[ 2.00715973e+01  0.00000000e+00]
 [-7.61155944e-03  1.74402736e-02]]
grads:  [8.55129270e-04 8.94628587e+00]
Stock Position:  0.0008551292704921251
Bond Position:  [-1.42997464]


portfolio before change:  [-1.34096243]
curr_Stock_Price:  104.3011503054659
curr_Factors:  [1.04301150e+02 3.69583387e-02]
mat_Sqrt:  [[ 2.00514285e+01  0.00000000e+00]
 [-7.68982067e-03  1.76195927e-02]]
grads:  [5.35353042e-03 8.11723128e+00]
Stock Position:  0.005353530421527116
Bond Position:  [-1.89934182]


portfolio before change:  [-1.33540658]
curr_Stock_Price:  105.38329456796195
curr_Factors:  [1.05383295e+02 3.69197802e-02]
mat_Sqrt:  [[ 2.02488949e+01  0.00000000e+00]
 [-7.68580825e-03  1.76103990e-02]]
grads:  [1.89087075e-03 2.97231240e+00]
Stock Position:  0.0018908707461514154
Bond Position:  [-1.53467276]


portfolio before change:  [-1.33690017]
curr_Stock_Price:  104.69485726770654
curr_Factors:  [1.04694857e+02 3.61608380e-02]
mat_Sqrt:  [[ 1.99087775e+01  0.00000000e+00]
 [-7.60640130e-03  1.74284549e-02]]
grads:  [-0.00598992 -1.81031108]
Stock Position:  -0.005989915728235703
Bond Position:  [-0.70978679]


portfolio before change:  [-1.33623881]
curr_Stock_Price:  104.56963237811475
curr_Factors:  [1.04569632e+02 3.70976283e-02]
mat_Sqrt:  [[ 2.01408898e+01  0.00000000e+00]
 [-7.70429784e-03  1.76527640e-02]]
grads:  [ 0.01772917 17.67936725]
Stock Position:  0.017729167738720707
Bond Position:  [-3.19017136]


portfolio before change:  [-1.3408972]
curr_Stock_Price:  104.32937311274733
curr_Factors:  [1.04329373e+02 3.67481754e-02]
mat_Sqrt:  [[ 1.99997464e+01  0.00000000e+00]
 [-7.66792544e-03  1.75694244e-02]]
grads:  [0.00279527 2.56955526]
Stock Position:  0.0027952653979818414
Bond Position:  [-1.63252549]


portfolio before change:  [-1.3428444]
curr_Stock_Price:  103.70577664517748
curr_Factors:  [1.03705777e+02 3.82368002e-02]
mat_Sqrt:  [[ 2.02788685e+01  0.00000000e+00]
 [-7.82169293e-03  1.79217500e-02]]
grads:  [1.97216950e-03 6.22548836e+00]
Stock Position:  0.001972169502337228
Bond Position:  [-1.54736977]


portfolio before change:  [-1.34279468]
curr_Stock_Price:  103.82906945927601
curr_Factors:  [1.03829069e+02 3.94186875e-02]
mat_Sqrt:  [[ 2.06143688e+01  0.00000000e+00]
 [-7.94165600e-03  1.81966199e-02]]
grads:  [7.35237004e-03 9.99328865e+00]
Stock Position:  0.007352370036559328
Bond Position:  [-2.10618442]


portfolio before change:  [-1.34535068]
curr_Stock_Price:  103.51723571673176
curr_Factors:  [1.03517236e+02 3.95520899e-02]
mat_Sqrt:  [[ 2.05872048e+01  0.00000000e+00]
 [-7.95508289e-03  1.82273848e-02]]
grads:  [4.58342789e-03 5.77174581e+00]
Stock Position:  0.00458342789444908
Bond Position:  [-1.81981447]


portfolio before change:  [-1.35081905]
curr_Stock_Price:  102.3737957751186
curr_Factors:  [1.02373796e+02 4.05025320e-02]
mat_Sqrt:  [[ 2.06029730e+01  0.00000000e+00]
 [-8.05009635e-03  1.84450879e-02]]
grads:  [  0.02771162 -19.14749063]
Stock Position:  0.02771162053444951
Bond Position:  [-4.18776283]


portfolio before change:  [-1.30849438]
curr_Stock_Price:  103.92001243353332
curr_Factors:  [1.03920012e+02 4.06393094e-02]
mat_Sqrt:  [[ 2.09494367e+01  0.00000000e+00]
 [-8.06367752e-03  1.84762063e-02]]
grads:  [-6.81108175e-03  2.28735243e+01]
Stock Position:  -0.0068110817462777515
Bond Position:  [-0.60068668]


portfolio before change:  [-1.31399446]
curr_Stock_Price:  104.7165063009225
curr_Factors:  [1.04716506e+02 4.02735427e-02]
mat_Sqrt:  [[ 2.10147903e+01  0.00000000e+00]
 [-8.02730766e-03  1.83928725e-02]]
grads:  [ 0.00659352 -0.50670111]
Stock Position:  0.006593517073729806
Bond Position:  [-2.00444453]


portfolio before change:  [-1.31923765]
curr_Stock_Price:  103.95930557117592
curr_Factors:  [1.03959306e+02 4.20094237e-02]
mat_Sqrt:  [[ 2.13077078e+01  0.00000000e+00]
 [-8.19848022e-03  1.87850781e-02]]
grads:  [-0.00345464 -3.45450121]
Stock Position:  -0.003454640932447561
Bond Position:  [-0.96009557]


portfolio before change:  [-1.31676136]
curr_Stock_Price:  103.20776378572324
curr_Factors:  [1.03207764e+02 4.19790555e-02]
mat_Sqrt:  [[ 2.11460230e+01  0.00000000e+00]
 [-8.19551639e-03  1.87782871e-02]]
grads:  [-0.00447572 -4.42891736]
Stock Position:  -0.004475723304442697
Bond Position:  [-0.85483196]


portfolio before change:  [-1.31481939]
curr_Stock_Price:  102.74999952475162
curr_Factors:  [1.02750000e+02 4.05599091e-02]
mat_Sqrt:  [[ 2.06933267e+01  0.00000000e+00]
 [-8.05579633e-03  1.84581482e-02]]
grads:  [-0.01872849 -5.01023875]
Stock Position:  -0.018728487019839583
Bond Position:  [0.60953264]


portfolio before change:  [-1.34470536]
curr_Stock_Price:  104.3498170352845
curr_Factors:  [1.04349817e+02 4.09288559e-02]
mat_Sqrt:  [[ 2.11108877e+01  0.00000000e+00]
 [-8.09235253e-03  1.85419090e-02]]
grads:  [-0.00218727 -0.2131598 ]
Stock Position:  -0.002187274840577101
Bond Position:  [-1.11646363]


portfolio before change:  [-1.33968468]
curr_Stock_Price:  101.99060716469528
curr_Factors:  [1.01990607e+02 4.24987225e-02]
mat_Sqrt:  [[ 2.10255863e+01  0.00000000e+00]
 [-8.24608732e-03  1.88941597e-02]]
grads:  [0.00796682 5.09417229]
Stock Position:  0.007966816557579276
Bond Position:  [-2.15222514]


portfolio before change:  [-1.33731551]
curr_Stock_Price:  102.32175866020711
curr_Factors:  [1.02321759e+02 4.16531212e-02]
mat_Sqrt:  [[ 2.08829463e+01  0.00000000e+00]
 [-8.16363852e-03  1.87052457e-02]]
grads:  [0.00989793 2.60924527]
Stock Position:  0.009897927427202392
Bond Position:  [-2.35008885]


portfolio before change:  [-1.32156893]
curr_Stock_Price:  103.94233617133717
curr_Factors:  [1.03942336e+02 4.01917197e-02]
mat_Sqrt:  [[ 2.08382272e+01  0.00000000e+00]
 [-8.01914905e-03  1.83741788e-02]]
grads:  [ -0.01567267 -11.51824656]
Stock Position:  -0.015672673507627192
Bond Position:  [0.30748537]


portfolio before change:  [-1.31994354]
curr_Stock_Price:  103.84108045763463
curr_Factors:  [1.03841080e+02 4.05187801e-02]
mat_Sqrt:  [[ 2.09024589e+01  0.00000000e+00]
 [-8.05171089e-03  1.84487873e-02]]
grads:  [-6.26381150e-04 -1.57706775e+01]
Stock Position:  -0.0006263811499329908
Bond Position:  [-1.25489945]


portfolio before change:  [-1.32005077]
curr_Stock_Price:  103.76182455416284
curr_Factors:  [1.03761825e+02 4.06649361e-02]
mat_Sqrt:  [[ 2.09241414e+01  0.00000000e+00]
 [-8.06621954e-03  1.84820308e-02]]
grads:  [-3.36671614e-03  1.15437268e+01]
Stock Position:  -0.0033667161440436803
Bond Position:  [-0.97071416]


portfolio before change:  [-1.31332468]
curr_Stock_Price:  101.7279640049766
curr_Factors:  [1.01727964e+02 4.29980068e-02]
mat_Sqrt:  [[ 2.10942707e+01  0.00000000e+00]
 [-8.29438430e-03  1.90048219e-02]]
grads:  [-3.37649512e-03  6.21953297e+00]
Stock Position:  -0.0033764951216131087
Bond Position:  [-0.96984071]


portfolio before change:  [-1.31594994]
curr_Stock_Price:  102.46956688963222
curr_Factors:  [1.02469567e+02 4.36255355e-02]
mat_Sqrt:  [[ 2.14025384e+01  0.00000000e+00]
 [-8.35469070e-03  1.91430013e-02]]
grads:  [2.24433426e-03 5.48150568e+00]
Stock Position:  0.0022443342641438545
Bond Position:  [-1.5459259]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.31087075]
Stock Price:  104.81879193840587
PL:  [-6.12966269]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.71272380e-01  4.71988214e-01]
 [-2.35817716e-01 -6.73735975e-02]
 [ 7.72892864e-01 -6.51434879e-01]
 [ 5.52518605e-02  2.66760567e-02]
 [-1.38788703e-01  5.89045425e-02]
 [ 1.32368933e-01  1.35288746e-01]
 [ 1.24448688e-01 -2.10749948e-02]
 [ 4.20675989e-01 -1.40028864e-02]
 [ 4.58346221e-02  7.40261646e-02]
 [ 4.99497801e-01 -3.51801590e-01]
 [ 6.03050698e-02 -1.23182753e-02]
 [-9.26314593e-02 -1.77149622e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-7.01916874e-01 -9.66998914e-01]
 [-3.37770813e-02 -2.69418349e-01]
 [-6.43970180e-02 -2.37188828e-01]
 [-5.01090370e-02  1.09799320e-01]
 [ 1.40433652e-01  1.57178981e-01]
 [-1.02684159e-01 -1.07112080e-01]
 [-8.57201094e-02 -3.28250981e-02]
 [ 2.09074446e-01  5.26017485e-01]
 [-4.26299259e-03  1.95885077e-01]
 [-1.28196075e-02 -2.44621824e-01]
 [ 1.50345192e-01  2.09052660e-01]
 [ 7.33466507e-02  1.53800037e-01]
 [ 8.20635983e-01 -7.79212521e-01]
 [-7.32291621e-01  8.95068062e-01]
 [ 6.72261514e-02 -1.61882399e-02]
 [-5.69044085e-02 -5.21991627e-02]
 [ 1.34177645e-01 -8.08229838e-02]
 [-1.30736104e-02 -1.06241229e-01]
 [ 2.85596790e-01 -2.35436234e-02]
 [ 3.11746666e-01  4.06614057e-01]
 [ 2.68918372e-01  5.95639842e-03]
 [-1.76351984e-01 -2.40115170e-01]
 [ 1.83270236e-01 -7.49109695e-02]
 [-1.69736631e-01  2.07596830e-01]
 [-1.19935328e-01  1.20141710e-01]
 [-1.02972675e-01  1.25942081e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.77674362]
curr_Stock_Price:  100.46223329577563
curr_Factors:  [1.00462233e+02 3.84047625e-02]
mat_Sqrt:  [[ 1.96877176e+01  0.00000000e+00]
 [-7.83885323e-03  1.79610691e-02]]
grads:  [1.91624511e-02 2.62784030e+01]
Stock Position:  0.01916245106967898
Bond Position:  [3.851641]


portfolio before change:  [5.8061433]
curr_Stock_Price:  101.97134015593818
curr_Factors:  [1.01971340e+02 3.76492805e-02]
mat_Sqrt:  [[ 1.97859300e+01  0.00000000e+00]
 [-7.76136900e-03  1.77835305e-02]]
grads:  [-0.01340457 -3.78853893]
Stock Position:  -0.01340457412871936
Bond Position:  [7.17302568]


portfolio before change:  [5.812836]
curr_Stock_Price:  101.53894935684804
curr_Factors:  [1.01538949e+02 3.77378190e-02]
mat_Sqrt:  [[ 1.97251840e+01  0.00000000e+00]
 [-7.77048972e-03  1.78044287e-02]]
grads:  [ 2.47695217e-02 -3.65883619e+01]
Stock Position:  0.02476952168697824
Bond Position:  [3.29776479]


portfolio before change:  [5.81991078]
curr_Stock_Price:  101.80793080982458
curr_Factors:  [1.01807931e+02 3.59161260e-02]
mat_Sqrt:  [[ 1.92941813e+01  0.00000000e+00]
 [-7.58062014e-03  1.73693828e-02]]
grads:  [0.00346707 1.53580913]
Stock Position:  0.0034670683997365176
Bond Position:  [5.46693572]


portfolio before change:  [5.82176617]
curr_Stock_Price:  102.14596258069496
curr_Factors:  [1.02145963e+02 3.69076402e-02]
mat_Sqrt:  [[ 1.96236299e+01  0.00000000e+00]
 [-7.68454451e-03  1.76075034e-02]]
grads:  [-0.00576247  3.34542274]
Stock Position:  -0.005762473785042382
Bond Position:  [6.4103796]


portfolio before change:  [5.81756495]
curr_Stock_Price:  103.01409129566767
curr_Factors:  [1.03014091e+02 3.81119008e-02]
mat_Sqrt:  [[ 2.01106886e+01  0.00000000e+00]
 [-7.80890782e-03  1.78924556e-02]]
grads:  [0.00951801 7.56121735]
Stock Position:  0.00951801234584166
Bond Position:  [4.83707556]


portfolio before change:  [5.8248924]
curr_Stock_Price:  103.72041268159519
curr_Factors:  [1.03720413e+02 3.72460442e-02]
mat_Sqrt:  [[ 2.00172454e+01  0.00000000e+00]
 [-7.71969370e-03  1.76880403e-02]]
grads:  [ 0.00575758 -1.19148274]
Stock Position:  0.005757575748041625
Bond Position:  [5.22771427]


portfolio before change:  [5.82603448]
curr_Stock_Price:  103.805270976687
curr_Factors:  [1.03805271e+02 3.79261757e-02]
mat_Sqrt:  [[ 2.02157069e+01  0.00000000e+00]
 [-7.78985758e-03  1.78488060e-02]]
grads:  [ 0.02050706 -0.7845279 ]
Stock Position:  0.020507055723637264
Bond Position:  [3.69729401]


portfolio before change:  [5.80881529]
curr_Stock_Price:  102.94306108806495
curr_Factors:  [1.02943061e+02 3.78199515e-02]
mat_Sqrt:  [[ 2.00196998e+01  0.00000000e+00]
 [-7.77894096e-03  1.78237929e-02]]
grads:  [3.90326976e-03 4.15322177e+00]
Stock Position:  0.0039032697591899444
Bond Position:  [5.40700075]


portfolio before change:  [5.81309754]
curr_Stock_Price:  103.8669884961491
curr_Factors:  [1.03866988e+02 3.69758573e-02]
mat_Sqrt:  [[ 1.99726948e+01  0.00000000e+00]
 [-7.69164297e-03  1.76237681e-02]]
grads:  [ 1.73215984e-02 -1.99617691e+01]
Stock Position:  0.017321598444262586
Bond Position:  [4.01395528]


portfolio before change:  [5.81550856]
curr_Stock_Price:  103.97721151717306
curr_Factors:  [1.03977212e+02 3.87320364e-02]
mat_Sqrt:  [[ 2.04631898e+01  0.00000000e+00]
 [-7.87218256e-03  1.80374362e-02]]
grads:  [ 0.00268428 -0.68292828]
Stock Position:  0.002684280131152184
Bond Position:  [5.53640459]


portfolio before change:  [5.81405988]
curr_Stock_Price:  103.17969005749286
curr_Factors:  [1.03179690e+02 3.91559366e-02]
mat_Sqrt:  [[ 2.04170516e+01  0.00000000e+00]
 [-7.91514362e-03  1.81358724e-02]]
grads:  [-8.32372351e-03 -9.76791289e+00]
Stock Position:  -0.008323723508835857
Bond Position:  [6.67289909]


portfolio before change:  [5.81913657]
curr_Stock_Price:  102.66999855751983
curr_Factors:  [1.02669999e+02 3.88757014e-02]
mat_Sqrt:  [[ 2.02433636e+01  0.00000000e+00]
 [-7.88676881e-03  1.80708575e-02]]
grads:  [-5.96700341e-03  9.16014341e+00]
Stock Position:  -0.005967003407631881
Bond Position:  [6.43176881]


portfolio before change:  [5.81043074]
curr_Stock_Price:  104.2637397739283
curr_Factors:  [1.04263740e+02 4.00338853e-02]
mat_Sqrt:  [[ 2.08615786e+01  0.00000000e+00]
 [-8.00338781e-03  1.83380652e-02]]
grads:  [ -0.05387655 -52.73178502]
Stock Position:  -0.0538765460124844
Bond Position:  [11.42780091]


portfolio before change:  [5.79772807]
curr_Stock_Price:  104.52602891888785
curr_Factors:  [1.04526029e+02 4.05740104e-02]
mat_Sqrt:  [[ 2.10546691e+01  0.00000000e+00]
 [-8.05719658e-03  1.84613566e-02]]
grads:  [-7.18894646e-03 -1.45936376e+01]
Stock Position:  -0.007188946457197659
Bond Position:  [6.54916009]


portfolio before change:  [5.78030964]
curr_Stock_Price:  107.0628579730173
curr_Factors:  [1.07062858e+02 3.87169004e-02]
mat_Sqrt:  [[ 2.10663416e+01  0.00000000e+00]
 [-7.87064423e-03  1.80339115e-02]]
grads:  [-7.97075791e-03 -1.31523784e+01]
Stock Position:  -0.007970757914223383
Bond Position:  [6.63368176]


portfolio before change:  [5.78217808]
curr_Stock_Price:  106.93248420181516
curr_Factors:  [1.06932484e+02 3.90620934e-02]
mat_Sqrt:  [[ 2.11342779e+01  0.00000000e+00]
 [-7.90565300e-03  1.81141266e-02]]
grads:  [-1.03560904e-04  6.06152990e+00]
Stock Position:  -0.00010356090364060638
Bond Position:  [5.7932521]


portfolio before change:  [5.78272654]
curr_Stock_Price:  108.6294302923605
curr_Factors:  [1.08629430e+02 3.91359594e-02]
mat_Sqrt:  [[ 2.14899544e+01  0.00000000e+00]
 [-7.91312423e-03  1.81312454e-02]]
grads:  [0.00972697 8.66895669]
Stock Position:  0.009726971909311703
Bond Position:  [4.72609112]


portfolio before change:  [5.78267282]
curr_Stock_Price:  108.56316882574805
curr_Factors:  [1.08563169e+02 3.91300328e-02]
mat_Sqrt:  [[ 2.14752198e+01  0.00000000e+00]
 [-7.91252504e-03  1.81298725e-02]]
grads:  [-0.00695833 -5.90804377]
Stock Position:  -0.006958331721102208
Bond Position:  [6.53809136]


portfolio before change:  [5.77630541]
curr_Stock_Price:  109.59570309793247
curr_Factors:  [1.09595703e+02 3.92877568e-02]
mat_Sqrt:  [[ 2.17231171e+01  0.00000000e+00]
 [-7.92845577e-03  1.81663744e-02]]
grads:  [-0.00460552 -1.80691521]
Stock Position:  -0.004605515688433826
Bond Position:  [6.28105014]


portfolio before change:  [5.78687388]
curr_Stock_Price:  107.47144872365404
curr_Factors:  [1.07471449e+02 4.05938090e-02]
mat_Sqrt:  [[ 2.16532458e+01  0.00000000e+00]
 [-8.05916214e-03  1.84658603e-02]]
grads:  [2.02578081e-02 2.84859452e+01]
Stock Position:  0.020257808072281575
Bond Position:  [3.6097379]


portfolio before change:  [5.77276382]
curr_Stock_Price:  106.75264916368998
curr_Factors:  [1.06752649e+02 4.02415059e-02]
mat_Sqrt:  [[ 2.14148863e+01  0.00000000e+00]
 [-8.02411424e-03  1.83855555e-02]]
grads:  [3.79307472e-03 1.06542921e+01]
Stock Position:  0.0037930747238903804
Bond Position:  [5.36784305]


portfolio before change:  [5.7716813]
curr_Stock_Price:  106.2903482995031
curr_Factors:  [1.06290348e+02 3.99628006e-02]
mat_Sqrt:  [[ 2.12481825e+01  0.00000000e+00]
 [-7.99627920e-03  1.83217773e-02]]
grads:  [-5.62783776e-03 -1.33514243e+01]
Stock Position:  -0.005627837763506775
Bond Position:  [6.36986614]


portfolio before change:  [5.76647714]
curr_Stock_Price:  107.35655592071234
curr_Factors:  [1.07356556e+02 4.10524553e-02]
mat_Sqrt:  [[ 2.17519471e+01  0.00000000e+00]
 [-8.10456221e-03  1.85698849e-02]]
grads:  [1.11062817e-02 1.12576175e+01]
Stock Position:  0.01110628170497771
Bond Position:  [4.57414499]


portfolio before change:  [5.74857802]
curr_Stock_Price:  105.69344972277317
curr_Factors:  [1.05693450e+02 4.23086192e-02]
mat_Sqrt:  [[ 2.17401481e+01  0.00000000e+00]
 [-8.22762364e-03  1.88518541e-02]]
grads:  [6.46134005e-03 8.15835071e+00]
Stock Position:  0.006461340049358454
Bond Position:  [5.0656567]


portfolio before change:  [5.7596325]
curr_Stock_Price:  107.30630855338477
curr_Factors:  [1.07306309e+02 4.11420405e-02]
mat_Sqrt:  [[ 2.17654760e+01  0.00000000e+00]
 [-8.11340033e-03  1.85901356e-02]]
grads:  [ 2.20789915e-02 -4.19153759e+01]
Stock Position:  0.022078991458062594
Bond Position:  [3.39041743]


portfolio before change:  [5.76933364]
curr_Stock_Price:  107.7264961217567
curr_Factors:  [1.07726496e+02 4.24123116e-02]
mat_Sqrt:  [[ 2.21854635e+01  0.00000000e+00]
 [-8.23769984e-03  1.88749415e-02]]
grads:  [-1.53998086e-02  4.74209714e+01]
Stock Position:  -0.015399808646228825
Bond Position:  [7.42830107]


portfolio before change:  [5.73998412]
curr_Stock_Price:  109.6926321545313
curr_Factors:  [1.09692632e+02 4.31783934e-02]
mat_Sqrt:  [[ 2.27934832e+01  0.00000000e+00]
 [-8.31176452e-03  1.90446450e-02]]
grads:  [ 0.0026394  -0.85001531]
Stock Position:  0.002639395822160033
Bond Position:  [5.45046184]


portfolio before change:  [5.73912293]
curr_Stock_Price:  109.10820245919375
curr_Factors:  [1.09108202e+02 4.56144315e-02]
mat_Sqrt:  [[ 2.33028229e+01  0.00000000e+00]
 [-8.54301413e-03  1.95745045e-02]]
grads:  [-0.00341959 -2.6666914 ]
Stock Position:  -0.003419585308570086
Bond Position:  [6.11222773]


portfolio before change:  [5.73627546]
curr_Stock_Price:  110.16433806443334
curr_Factors:  [1.10164338e+02 4.55696231e-02]
mat_Sqrt:  [[ 2.35168283e+01  0.00000000e+00]
 [-8.53881707e-03  1.95648878e-02]]
grads:  [ 0.00420565 -4.1310221 ]
Stock Position:  0.004205652282712985
Bond Position:  [5.27296256]


portfolio before change:  [5.73477974]
curr_Stock_Price:  109.65196179726743
curr_Factors:  [1.09651962e+02 4.54730921e-02]
mat_Sqrt:  [[ 2.33826457e+01  0.00000000e+00]
 [-8.52976831e-03  1.95441545e-02]]
grads:  [-2.54210258e-03 -5.43595933e+00]
Stock Position:  -0.0025421025824219107
Bond Position:  [6.01352628]


portfolio before change:  [5.73788908]
curr_Stock_Price:  108.72453949549337
curr_Factors:  [1.08724539e+02 4.67009440e-02]
mat_Sqrt:  [[ 2.34958092e+01  0.00000000e+00]
 [-8.64416048e-03  1.98062599e-02]]
grads:  [ 0.0117179  -1.18869608]
Stock Position:  0.011717898628155105
Bond Position:  [4.46386595]


portfolio before change:  [5.74282922]
curr_Stock_Price:  109.09850705715223
curr_Factors:  [1.09098507e+02 4.64126126e-02]
mat_Sqrt:  [[ 2.35037314e+01  0.00000000e+00]
 [-8.61743466e-03  1.97450233e-02]]
grads:  [ 0.02081404 20.59324268]
Stock Position:  0.020814039294683437
Bond Position:  [3.4720486]


portfolio before change:  [5.74173307]
curr_Stock_Price:  109.02499024917583
curr_Factors:  [1.09024990e+02 4.60949486e-02]
mat_Sqrt:  [[ 2.34073756e+01  0.00000000e+00]
 [-8.58789367e-03  1.96773364e-02]]
grads:  [0.01159968 0.30270349]
Stock Position:  0.011599675357242807
Bond Position:  [4.47707857]


portfolio before change:  [5.72006886]
curr_Stock_Price:  107.1090851547694
curr_Factors:  [1.07109085e+02 4.56188490e-02]
mat_Sqrt:  [[ 2.28769684e+01  0.00000000e+00]
 [-8.54342779e-03  1.95754523e-02]]
grads:  [ -0.01228951 -12.26613653]
Stock Position:  -0.01228951456127849
Bond Position:  [7.03638752]


portfolio before change:  [5.71934279]
curr_Stock_Price:  107.23973929663717
curr_Factors:  [1.07239739e+02 4.57621459e-02]
mat_Sqrt:  [[ 2.29408202e+01  0.00000000e+00]
 [-8.55683548e-03  1.96061732e-02]]
grads:  [ 0.00656369 -3.82078485]
Stock Position:  0.006563688998111949
Bond Position:  [5.01545449]


portfolio before change:  [5.70583678]
curr_Stock_Price:  105.0865328546931
curr_Factors:  [1.05086533e+02 4.67704962e-02]
mat_Sqrt:  [[ 2.27265259e+01  0.00000000e+00]
 [-8.65059501e-03  1.98210032e-02]]
grads:  [-3.48200808e-03  1.04735783e+01]
Stock Position:  -0.0034820080810675385
Bond Position:  [6.07174894]


portfolio before change:  [5.7099462]
curr_Stock_Price:  104.12432903742854
curr_Factors:  [1.04124329e+02 4.68065684e-02]
mat_Sqrt:  [[ 2.25271171e+01  0.00000000e+00]
 [-8.65393029e-03  1.98286453e-02]]
grads:  [-2.99644143e-03  6.05899740e+00]
Stock Position:  -0.00299644142898517
Bond Position:  [6.02194865]


portfolio before change:  [5.71026134]
curr_Stock_Price:  104.27038364693179
curr_Factors:  [1.04270384e+02 4.70009780e-02]
mat_Sqrt:  [[ 2.26055157e+01  0.00000000e+00]
 [-8.67188358e-03  1.98697815e-02]]
grads:  [-2.12368720e-03  6.33837275e+00]
Stock Position:  -0.002123687202229571
Bond Position:  [5.93169902]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.71211642]
Stock Price:  103.74602870842946
PL:  [1.96608771]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 9.11823195e-02  3.73127231e-01]
 [-1.74384544e-01 -7.11999153e-02]
 [ 7.76940071e-01 -6.54187960e-01]
 [-4.77078636e-02  6.99641494e-02]
 [-3.83867200e-02  1.87226789e-02]
 [-7.24581237e-03  1.91023868e-02]
 [ 8.33634246e-02  6.86604352e-02]
 [ 3.37869358e-01 -7.02233111e-03]
 [ 3.93259995e-02  7.16724901e-02]
 [ 3.40090356e-01 -1.65805331e-01]
 [ 6.42700098e-02  1.37199477e-03]
 [-1.26320656e-01 -7.29623679e-02]
 [-1.99522425e-02  1.09681787e-01]
 [-3.90728766e-01 -5.14437084e-01]
 [ 8.33136366e-02  2.27951472e-01]
 [ 5.20445460e-02 -1.91583490e-02]
 [-2.66831438e-02  3.05349231e-02]
 [-1.61276517e-02  4.30708039e-02]
 [ 1.52562511e-02  5.69910349e-02]
 [ 1.07674329e-01 -1.00384459e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 6.16960207e-02  2.57852911e-01]
 [ 3.48442889e-02  2.15044089e-01]
 [-6.97845614e-02  1.16716992e-01]
 [ 3.12662909e-02  7.59638084e-02]
 [ 7.13481929e-01 -3.02456570e-01]
 [-9.94770069e-02  1.46673301e-01]
 [ 7.61118831e-03  5.10492188e-02]
 [ 3.42179427e-02 -1.36978234e-01]
 [-1.33848466e-02 -4.31955672e-02]
 [-5.62609095e-01 -9.91145745e-02]
 [-1.17968537e-01  1.28852979e-03]
 [ 1.28931448e-01  1.01968317e-01]
 [ 1.95619856e-01  4.35617724e-02]
 [-2.51639813e-01 -1.93314036e-01]
 [ 7.00736036e-02 -3.43100037e-01]
 [-1.63648542e-01  2.13217312e-01]
 [-1.22415250e-01  1.18468704e-01]
 [-1.18026969e-01  1.29732787e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.87308141]
curr_Stock_Price:  100.17551095468752
curr_Factors:  [1.00175511e+02 3.95900265e-02]
mat_Sqrt:  [[ 1.99321645e+01  0.00000000e+00]
 [-7.95889706e-03  1.82361241e-02]]
grads:  [1.27446467e-02 2.04608846e+01]
Stock Position:  0.012744646664211661
Bond Position:  [2.59637992]


portfolio before change:  [3.88380504]
curr_Stock_Price:  100.9914666394077
curr_Factors:  [1.00991467e+02 3.98076385e-02]
mat_Sqrt:  [[ 2.01496676e+01  0.00000000e+00]
 [-7.98074066e-03  1.82861741e-02]]
grads:  [-0.01019663 -3.89364746]
Stock Position:  -0.010196631455107725
Bond Position:  [4.91357781]


portfolio before change:  [3.88828708]
curr_Stock_Price:  100.61214501700042
curr_Factors:  [1.00612145e+02 3.85917439e-02]
mat_Sqrt:  [[ 1.97650360e+01  0.00000000e+00]
 [-7.85791259e-03  1.80047396e-02]]
grads:  [ 2.48635539e-02 -3.63342083e+01]
Stock Position:  0.024863553855747074
Bond Position:  [1.3867116]


portfolio before change:  [3.85684172]
curr_Stock_Price:  99.34045568207961
curr_Factors:  [9.93404557e+01 3.95601556e-02]
mat_Sqrt:  [[ 1.97585533e+01  0.00000000e+00]
 [-7.95589398e-03  1.82292432e-02]]
grads:  [-8.69142857e-04  3.83801723e+00]
Stock Position:  -0.0008691428571635239
Bond Position:  [3.94318276]


portfolio before change:  [3.85654558]
curr_Stock_Price:  100.24832659711704
curr_Factors:  [1.00248327e+02 3.79784908e-02]
mat_Sqrt:  [[ 1.95364650e+01  0.00000000e+00]
 [-7.79522837e-03  1.78611120e-02]]
grads:  [-0.00154662  1.04823703]
Stock Position:  -0.0015466192606040778
Bond Position:  [4.01159157]


portfolio before change:  [3.85483891]
curr_Stock_Price:  101.67604844148222
curr_Factors:  [1.01676048e+02 3.78198482e-02]
mat_Sqrt:  [[ 1.97732724e+01  0.00000000e+00]
 [-7.77893033e-03  1.78237685e-02]]
grads:  [5.51832143e-05 1.07173670e+00]
Stock Position:  5.518321434961841e-05
Bond Position:  [3.8492281]


portfolio before change:  [3.85541331]
curr_Stock_Price:  103.36525271534603
curr_Factors:  [1.03365253e+02 3.89410494e-02]
mat_Sqrt:  [[ 2.03975683e+01  0.00000000e+00]
 [-7.89339465e-03  1.80860392e-02]]
grads:  [0.00555602 3.79632236]
Stock Position:  0.005556019889313549
Bond Position:  [3.28111391]


portfolio before change:  [3.85271714]
curr_Stock_Price:  102.80615926102999
curr_Factors:  [1.02806159e+02 3.87911819e-02]
mat_Sqrt:  [[ 2.02481636e+01  0.00000000e+00]
 [-7.87819085e-03  1.80512029e-02]]
grads:  [ 0.01653506 -0.38902289]
Stock Position:  0.016535058139613163
Bond Position:  [2.15281132]


portfolio before change:  [3.85650615]
curr_Stock_Price:  103.01903363090058
curr_Factors:  [1.03019034e+02 3.89905025e-02]
mat_Sqrt:  [[ 2.03421517e+01  0.00000000e+00]
 [-7.89840516e-03  1.80975198e-02]]
grads:  [3.47094249e-03 3.96034877e+00]
Stock Position:  0.0034709424934971176
Bond Position:  [3.49893301]


portfolio before change:  [3.85239235]
curr_Stock_Price:  101.7078059435465
curr_Factors:  [1.01707806e+02 3.91750908e-02]
mat_Sqrt:  [[ 2.01307192e+01  0.00000000e+00]
 [-7.91707934e-03  1.81403077e-02]]
grads:  [ 0.01329942 -9.14016091]
Stock Position:  0.013299424288639056
Bond Position:  [2.49973709]


portfolio before change:  [3.85385098]
curr_Stock_Price:  101.79398612654427
curr_Factors:  [1.01793986e+02 3.80980961e-02]
mat_Sqrt:  [[ 1.98688970e+01  0.00000000e+00]
 [-7.80749344e-03  1.78892148e-02]]
grads:  [0.00326484 0.07669396]
Stock Position:  0.0032648414027095
Bond Position:  [3.52150976]


portfolio before change:  [3.85080987]
curr_Stock_Price:  100.72767576991228
curr_Factors:  [1.00727676e+02 3.96802566e-02]
mat_Sqrt:  [[ 2.00648561e+01  0.00000000e+00]
 [-7.96796151e-03  1.82568934e-02]]
grads:  [-0.00788264 -3.99642844]
Stock Position:  -0.007882640353487052
Bond Position:  [4.64480991]


portfolio before change:  [3.85552584]
curr_Stock_Price:  100.20306291735895
curr_Factors:  [1.00203063e+02 3.87521172e-02]
mat_Sqrt:  [[ 1.97255315e+01  0.00000000e+00]
 [-7.87422298e-03  1.80421114e-02]]
grads:  [1.41526295e-03 6.07921018e+00]
Stock Position:  0.0014152629532424444
Bond Position:  [3.71371216]


portfolio before change:  [3.85609383]
curr_Stock_Price:  100.27637240189392
curr_Factors:  [1.00276372e+02 3.83006114e-02]
mat_Sqrt:  [[ 1.96246296e+01  0.00000000e+00]
 [-7.82821680e-03  1.79366980e-02]]
grads:  [ -0.03135078 -28.68070163]
Stock Position:  -0.03135078368678462
Bond Position:  [6.99983669]


portfolio before change:  [3.89824697]
curr_Stock_Price:  98.95971930220377
curr_Factors:  [9.89597193e+01 3.83821175e-02]
mat_Sqrt:  [[ 1.93875495e+01  0.00000000e+00]
 [-7.83654184e-03  1.79557731e-02]]
grads:  [9.42872203e-03 1.26951633e+01]
Stock Position:  0.009428722027808372
Bond Position:  [2.96518329]


portfolio before change:  [3.89473153]
curr_Stock_Price:  98.54756179162271
curr_Factors:  [9.85475618e+01 3.77684871e-02]
mat_Sqrt:  [[ 1.91518476e+01  0.00000000e+00]
 [-7.77364646e-03  1.78116617e-02]]
grads:  [ 0.00228088 -1.07560706]
Stock Position:  0.0022808847389940478
Bond Position:  [3.6699559]


portfolio before change:  [3.8949876]
curr_Stock_Price:  98.45869145554305
curr_Factors:  [9.84586915e+01 3.91106642e-02]
mat_Sqrt:  [[ 1.94716007e+01  0.00000000e+00]
 [-7.91056653e-03  1.81253849e-02]]
grads:  [-6.85953404e-04  1.68464963e+00]
Stock Position:  -0.0006859534038466976
Bond Position:  [3.96252567]


portfolio before change:  [3.89531966]
curr_Stock_Price:  98.69673383381613
curr_Factors:  [9.86967338e+01 3.87507718e-02]
mat_Sqrt:  [[ 1.94286650e+01  0.00000000e+00]
 [-7.87408628e-03  1.80417982e-02]]
grads:  [1.37425203e-04 2.38727888e+00]
Stock Position:  0.00013742520297291023
Bond Position:  [3.88175624]


portfolio before change:  [3.89589492]
curr_Stock_Price:  99.35173323493572
curr_Factors:  [9.93517332e+01 3.81487273e-02]
mat_Sqrt:  [[ 1.94050817e+01  0.00000000e+00]
 [-7.81267967e-03  1.79010980e-02]]
grads:  [2.06797264e-03 3.18366141e+00]
Stock Position:  0.00206797263587619
Bond Position:  [3.69043825]


portfolio before change:  [3.8935688]
curr_Stock_Price:  98.00381760164655
curr_Factors:  [9.80038176e+01 3.97016289e-02]
mat_Sqrt:  [[ 1.95275229e+01  0.00000000e+00]
 [-7.97010704e-03  1.82618094e-02]]
grads:  [ 3.27040760e-03 -5.49696127e+00]
Stock Position:  0.0032704076027035497
Bond Position:  [3.57305637]


portfolio before change:  [3.89094548]
curr_Stock_Price:  97.06510372628163
curr_Factors:  [9.70651037e+01 4.00046825e-02]
mat_Sqrt:  [[ 1.94141570e+01  0.00000000e+00]
 [-8.00046824e-03  1.83313757e-02]]
grads:  [ 0.00216999 -2.06083768]
Stock Position:  0.002169994331124978
Bond Position:  [3.68031476]


portfolio before change:  [3.89309901]
curr_Stock_Price:  97.84550176917088
curr_Factors:  [9.78455018e+01 3.98074752e-02]
mat_Sqrt:  [[ 1.95219493e+01  0.00000000e+00]
 [-7.98072430e-03  1.82861366e-02]]
grads:  [8.92494157e-03 1.41010054e+01]
Stock Position:  0.008924941574239875
Bond Position:  [3.01983363]


portfolio before change:  [3.88983674]
curr_Stock_Price:  97.43768121539804
curr_Factors:  [9.74376812e+01 4.12305446e-02]
mat_Sqrt:  [[ 1.97850192e+01  0.00000000e+00]
 [-8.12212234e-03  1.86101202e-02]]
grads:  [6.50478134e-03 1.15552230e+01]
Stock Position:  0.006504781341564291
Bond Position:  [3.25602593]


portfolio before change:  [3.89481594]
curr_Stock_Price:  98.14057573224959
curr_Factors:  [9.81405757e+01 4.11218508e-02]
mat_Sqrt:  [[ 1.99014595e+01  0.00000000e+00]
 [-8.11140933e-03  1.85855736e-02]]
grads:  [-9.46919994e-04  6.27997791e+00]
Stock Position:  -0.0009469199940816112
Bond Position:  [3.98774722]


portfolio before change:  [3.89522822]
curr_Stock_Price:  98.23163510922438
curr_Factors:  [9.82316351e+01 4.10078854e-02]
mat_Sqrt:  [[ 1.98923028e+01  0.00000000e+00]
 [-8.10016152e-03  1.85598017e-02]]
grads:  [3.23841918e-03 4.09292135e+00]
Stock Position:  0.0032384191836114353
Bond Position:  [3.57711301]


portfolio before change:  [3.90721083]
curr_Stock_Price:  101.79369541775763
curr_Factors:  [1.01793695e+02 3.92682164e-02]
mat_Sqrt:  [[ 2.01716521e+01  0.00000000e+00]
 [-7.92648385e-03  1.81618561e-02]]
grads:  [  0.02882655 -16.65339531]
Stock Position:  0.028826546168515346
Bond Position:  [0.97285017]


portfolio before change:  [3.90478641]
curr_Stock_Price:  101.70537287047667
curr_Factors:  [1.01705373e+02 4.03788381e-02]
mat_Sqrt:  [[ 2.04371722e+01  0.00000000e+00]
 [-8.03779453e-03  1.84169009e-02]]
grads:  [-1.73524644e-03  7.96405983e+00]
Stock Position:  -0.0017352464394189673
Bond Position:  [4.08127029]


portfolio before change:  [3.90571166]
curr_Stock_Price:  101.46618020103385
curr_Factors:  [1.01466180e+02 4.15496521e-02]
mat_Sqrt:  [[ 2.06825940e+01  0.00000000e+00]
 [-8.15349270e-03  1.86819987e-02]]
grads:  [1.44521978e-03 2.73253518e+00]
Stock Position:  0.0014452197810640671
Bond Position:  [3.75907073]


portfolio before change:  [3.906972]
curr_Stock_Price:  102.01311017258783
curr_Factors:  [1.02013110e+02 4.10545425e-02]
mat_Sqrt:  [[ 2.06698154e+01  0.00000000e+00]
 [-8.10476823e-03  1.85703570e-02]]
grads:  [-1.23679187e-03 -7.37617666e+00]
Stock Position:  -0.0012367918683344795
Bond Position:  [4.03314099]


portfolio before change:  [3.90932263]
curr_Stock_Price:  100.52017541183571
curr_Factors:  [1.00520175e+02 4.25185184e-02]
mat_Sqrt:  [[ 2.07272793e+01  0.00000000e+00]
 [-8.24800760e-03  1.88985596e-02]]
grads:  [-1.55529036e-03 -2.28565394e+00]
Stock Position:  -0.0015552903619980118
Bond Position:  [4.06566069]


portfolio before change:  [3.90904252]
curr_Stock_Price:  101.02705755546242
curr_Factors:  [1.01027058e+02 4.18054666e-02]
mat_Sqrt:  [[ 2.06563813e+01  0.00000000e+00]
 [-8.17855406e-03  1.87394215e-02]]
grads:  [-0.02933071 -5.28909467]
Stock Position:  -0.02933070572396756
Bond Position:  [6.87223741]


portfolio before change:  [3.89060262]
curr_Stock_Price:  101.68503651340988
curr_Factors:  [1.01685037e+02 4.29930537e-02]
mat_Sqrt:  [[ 2.10841548e+01  0.00000000e+00]
 [-8.29390656e-03  1.90037273e-02]]
grads:  [-0.00556846  0.06780406]
Stock Position:  -0.005568455467111775
Bond Position:  [4.45683121]


portfolio before change:  [3.88872827]
curr_Stock_Price:  102.12168929037591
curr_Factors:  [1.02121689e+02 4.20117754e-02]
mat_Sqrt:  [[ 2.09316521e+01  0.00000000e+00]
 [-8.19870969e-03  1.87856039e-02]]
grads:  [0.00828573 5.42800316]
Stock Position:  0.00828573252925023
Bond Position:  [3.04257527]


portfolio before change:  [3.8975244]
curr_Stock_Price:  103.1373851797191
curr_Factors:  [1.03137385e+02 4.22560880e-02]
mat_Sqrt:  [[ 2.12012155e+01  0.00000000e+00]
 [-8.22251427e-03  1.88401470e-02]]
grads:  [0.01012356 2.31217794]
Stock Position:  0.010123559768671835
Bond Position:  [2.85340692]


portfolio before change:  [3.89965651]
curr_Stock_Price:  103.31275889837539
curr_Factors:  [1.03312759e+02 4.35435796e-02]
mat_Sqrt:  [[ 2.15583751e+01  0.00000000e+00]
 [-8.34683936e-03  1.91250116e-02]]
grads:  [ -0.01558601 -10.10791733]
Stock Position:  -0.015586006539066381
Bond Position:  [5.50988984]


portfolio before change:  [3.90408238]
curr_Stock_Price:  103.07298656234606
curr_Factors:  [1.03072987e+02 4.46723382e-02]
mat_Sqrt:  [[ 2.17853330e+01  0.00000000e+00]
 [-8.45433268e-03  1.93713097e-02]]
grads:  [-3.65693418e-03 -1.77117625e+01]
Stock Position:  -0.0036569341839802903
Bond Position:  [4.28101351]


portfolio before change:  [3.90260897]
curr_Stock_Price:  103.62223595284566
curr_Factors:  [1.03622236e+02 4.38805137e-02]
mat_Sqrt:  [[ 2.17064504e+01  0.00000000e+00]
 [-8.37907046e-03  1.91988623e-02]]
grads:  [-3.25216130e-03  1.11057264e+01]
Stock Position:  -0.0032521612980374146
Bond Position:  [4.2396052]


portfolio before change:  [3.90822526]
curr_Stock_Price:  102.0582591850748
curr_Factors:  [1.02058259e+02 4.39116620e-02]
mat_Sqrt:  [[ 2.13864201e+01  0.00000000e+00]
 [-8.38204386e-03  1.92056752e-02]]
grads:  [-3.30636304e-03  6.16842171e+00]
Stock Position:  -0.0033063630361110253
Bond Position:  [4.24566692]


portfolio before change:  [3.90019193]
curr_Stock_Price:  104.64843824563157
curr_Factors:  [1.04648438e+02 4.37070877e-02]
mat_Sqrt:  [[ 2.18780538e+01  0.00000000e+00]
 [-8.36249606e-03  1.91608856e-02]]
grads:  [-2.80678252e-03  6.77070932e+00]
Stock Position:  -0.002806782520148693
Bond Position:  [4.19391734]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.89368765]
Stock Price:  107.15257025076451
PL:  [-3.2588826]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 6.24397397e-03  2.67884524e-01]
 [-1.78330532e-01 -7.75755016e-02]
 [ 8.42132976e-01 -7.50627306e-01]
 [ 5.82124391e-03  2.40434482e-02]
 [-1.14667120e-01  4.92508470e-02]
 [-8.29343470e-02 -6.36410835e-02]
 [ 4.91562998e-03  3.14619258e-01]
 [ 2.29909365e-01 -2.08054022e-03]
 [ 1.40285190e-01  7.83196282e-02]
 [ 3.21191356e-01 -1.51486216e-01]
 [ 7.63457168e-02  4.34969279e-02]
 [-1.38677831e-01 -1.04410571e-01]
 [-1.79740886e-01  1.58724157e-01]
 [-6.89176634e-01 -9.35420484e-01]
 [ 3.36772893e-02  3.10729327e-02]
 [ 4.65140275e-02 -8.01991514e-02]
 [-5.08976923e-02  1.54132188e-01]
 [ 1.29024282e-01  1.57152446e-01]
 [ 1.52982346e-02  5.59485777e-02]
 [-1.01627542e-01 -3.56862424e-02]
 [ 2.18581106e-01  3.25692092e-01]
 [ 3.05969907e-02  7.55660307e-02]
 [-1.18861974e-02 -1.63906776e-01]
 [ 1.02569283e-01  1.92416006e-01]
 [ 3.68128516e-02  8.23498583e-02]
 [ 7.59051463e-01 -5.02046170e-01]
 [-1.89900350e-01  2.56683770e-01]
 [ 1.29419945e-01  4.17141166e-03]
 [-4.80610727e-02 -6.18634620e-02]
 [ 3.30950388e-03 -1.70535710e-01]
 [ 3.27854100e-02 -6.99528839e-02]
 [ 7.64353936e-02 -1.02767130e-02]
 [ 2.11292251e-01  2.39215468e-01]
 [ 2.15293651e-01  3.34682474e-02]
 [-1.95083548e-01 -2.37029691e-01]
 [ 1.80308820e-01 -8.32663508e-02]
 [-2.01696636e-01  1.84320068e-01]
 [-1.15159832e-01  1.23363358e-01]
 [-2.89020341e-01  1.69283978e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.85326482]
curr_Stock_Price:  99.87129388529303
curr_Factors:  [9.98712939e+01 3.95498269e-02]
mat_Sqrt:  [[ 1.98615423e+01  0.00000000e+00]
 [-7.95485531e-03  1.82268633e-02]]
grads:  [6.20084600e-03 1.46972367e+01]
Stock Position:  0.006200846004224663
Bond Position:  [1.23397831]


portfolio before change:  [1.85737322]
curr_Stock_Price:  100.50897151296141
curr_Factors:  [1.00508972e+02 3.99822668e-02]
mat_Sqrt:  [[ 2.00973380e+01  0.00000000e+00]
 [-7.99822649e-03  1.83262392e-02]]
grads:  [-0.01055798 -4.23302899]
Stock Position:  -0.010557978234598477
Bond Position:  [2.91854476]


portfolio before change:  [1.87654314]
curr_Stock_Price:  98.72784656216932
curr_Factors:  [9.87278466e+01 4.18867030e-02]
mat_Sqrt:  [[ 2.02058792e+01  0.00000000e+00]
 [-8.18649649e-03  1.87576199e-02]]
grads:  [ 2.54644876e-02 -4.00171935e+01]
Stock Position:  0.025464487647149783
Bond Position:  [-0.63751089]


portfolio before change:  [1.92504112]
curr_Stock_Price:  100.63551011433309
curr_Factors:  [1.00635510e+02 4.28914737e-02]
mat_Sqrt:  [[ 2.08418726e+01  0.00000000e+00]
 [-8.28410272e-03  1.89812639e-02]]
grads:  [7.82783070e-04 1.26669374e+00]
Stock Position:  0.0007827830698374713
Bond Position:  [1.84626535]


portfolio before change:  [1.92584172]
curr_Stock_Price:  101.3634222853743
curr_Factors:  [1.01363422e+02 4.22690472e-02]
mat_Sqrt:  [[ 2.08397495e+01  0.00000000e+00]
 [-8.22377501e-03  1.88430357e-02]]
grads:  [-0.00447089  2.61374269]
Stock Position:  -0.004470892884600221
Bond Position:  [2.37902672]


portfolio before change:  [1.93004367]
curr_Stock_Price:  100.49009432280259
curr_Factors:  [1.00490094e+02 4.28787639e-02]
mat_Sqrt:  [[ 2.08086729e+01  0.00000000e+00]
 [-8.28287524e-03  1.89784514e-02]]
grads:  [-0.00532036 -3.35333385]
Stock Position:  -0.005320358184085275
Bond Position:  [2.46468697]


portfolio before change:  [1.92705581]
curr_Stock_Price:  101.1095951008402
curr_Factors:  [1.01109595e+02 4.33066675e-02]
mat_Sqrt:  [[ 2.10411636e+01  0.00000000e+00]
 [-8.32410163e-03  1.90729129e-02]]
grads:  [6.75945179e-03 1.64956061e+01]
Stock Position:  0.006759451791389587
Bond Position:  [1.24361038]


portfolio before change:  [1.92778909]
curr_Stock_Price:  101.1950781593035
curr_Factors:  [1.01195078e+02 4.48715925e-02]
mat_Sqrt:  [[ 2.14360683e+01  0.00000000e+00]
 [-8.47316635e-03  1.94144631e-02]]
grads:  [ 0.01068299 -0.10716445]
Stock Position:  0.010682991837295494
Bond Position:  [0.84672289]


portfolio before change:  [1.92226169]
curr_Stock_Price:  100.66776811164647
curr_Factors:  [1.00667768e+02 4.69861762e-02]
mat_Sqrt:  [[ 2.18210423e+01  0.00000000e+00]
 [-8.67051797e-03  1.98666525e-02]]
grads:  [0.00799534 3.94226599]
Stock Position:  0.007995341154729108
Bond Position:  [1.11738854]


portfolio before change:  [1.92638024]
curr_Stock_Price:  101.16541677576913
curr_Factors:  [1.01165417e+02 4.77874851e-02]
mat_Sqrt:  [[ 2.21151130e+01  0.00000000e+00]
 [-8.74413953e-03  2.00353406e-02]]
grads:  [ 0.01153407 -7.56095038]
Stock Position:  0.011534074031787904
Bond Position:  [0.75953083]


portfolio before change:  [1.91873215]
curr_Stock_Price:  100.49409816339248
curr_Factors:  [1.00494098e+02 4.90652532e-02]
mat_Sqrt:  [[ 2.22601240e+01  0.00000000e+00]
 [-8.86027117e-03  2.03014316e-02]]
grads:  [0.00428252 2.14255471]
Stock Position:  0.004282515788850396
Bond Position:  [1.48836459]


portfolio before change:  [1.92117497]
curr_Stock_Price:  101.02107082251311
curr_Factors:  [1.01021071e+02 4.66016450e-02]
mat_Sqrt:  [[ 2.18078369e+01  0.00000000e+00]
 [-8.63496566e-03  1.97851919e-02]]
grads:  [-0.00844863 -5.27720791]
Stock Position:  -0.008448629776794987
Bond Position:  [2.7746646]


portfolio before change:  [1.90037856]
curr_Stock_Price:  103.52363842724006
curr_Factors:  [1.03523638e+02 4.41770031e-02]
mat_Sqrt:  [[ 2.17589359e+01  0.00000000e+00]
 [-8.40733043e-03  1.92636141e-02]]
grads:  [-5.07690198e-03  8.23958351e+00]
Stock Position:  -0.0050769019835397505
Bond Position:  [2.42595793]


portfolio before change:  [1.89796412]
curr_Stock_Price:  104.05894662975064
curr_Factors:  [1.04058947e+02 4.35105056e-02]
mat_Sqrt:  [[ 2.17058347e+01  0.00000000e+00]
 [-8.34366880e-03  1.91177469e-02]]
grads:  [ -0.05055911 -48.92943128]
Stock Position:  -0.0505591063962416
Bond Position:  [7.15909147]


portfolio before change:  [1.95690417]
curr_Stock_Price:  102.91088231723802
curr_Factors:  [1.02910882e+02 4.40125467e-02]
mat_Sqrt:  [[ 2.15898463e+01  0.00000000e+00]
 [-8.39166698e-03  1.92277246e-02]]
grads:  [0.002188   1.61604836]
Stock Position:  0.0021880020959253108
Bond Position:  [1.73173494]


portfolio before change:  [1.95826811]
curr_Stock_Price:  103.4353166230342
curr_Factors:  [1.03435317e+02 4.63479336e-02]
mat_Sqrt:  [[ 2.22681448e+01  0.00000000e+00]
 [-8.61142809e-03  1.97312605e-02]]
grads:  [ 5.16982821e-04 -4.06457313e+00]
Stock Position:  0.0005169828210067342
Bond Position:  [1.90479383]


portfolio before change:  [1.9595542]
curr_Stock_Price:  105.46241690442004
curr_Factors:  [1.05462417e+02 4.46927429e-02]
mat_Sqrt:  [[ 2.22954491e+01  0.00000000e+00]
 [-8.45626328e-03  1.93757333e-02]]
grads:  [7.34280324e-04 7.95490864e+00]
Stock Position:  0.0007342803237684932
Bond Position:  [1.88211522]


portfolio before change:  [1.9603219]
curr_Stock_Price:  106.18750704217243
curr_Factors:  [1.06187507e+02 4.39924249e-02]
mat_Sqrt:  [[ 2.22721619e+01  0.00000000e+00]
 [-8.38974850e-03  1.92233288e-02]]
grads:  [0.00887257 8.17509016]
Stock Position:  0.008872566249149684
Bond Position:  [1.01816621]


portfolio before change:  [1.95234246]
curr_Stock_Price:  105.27382321521925
curr_Factors:  [1.05273823e+02 4.43401899e-02]
mat_Sqrt:  [[ 2.21676252e+01  0.00000000e+00]
 [-8.42284416e-03  1.92991605e-02]]
grads:  [1.79163061e-03 2.89901614e+00]
Stock Position:  0.0017916306063857192
Bond Position:  [1.76373065]


portfolio before change:  [1.94965769]
curr_Stock_Price:  103.65225717700038
curr_Factors:  [1.03652257e+02 4.45034270e-02]
mat_Sqrt:  [[ 2.18663095e+01  0.00000000e+00]
 [-8.43833415e-03  1.93346525e-02]]
grads:  [-0.00535995 -1.84571419]
Stock Position:  -0.0053599486013303325
Bond Position:  [2.50522846]


portfolio before change:  [1.94406577]
curr_Stock_Price:  104.75396471252428
curr_Factors:  [1.04753965e+02 4.44666259e-02]
mat_Sqrt:  [[ 2.20895850e+01  0.00000000e+00]
 [-8.43484448e-03  1.93266567e-02]]
grads:  [1.63300844e-02 1.68519625e+01]
Stock Position:  0.01633008443890895
Bond Position:  [0.23342468]


portfolio before change:  [1.94343077]
curr_Stock_Price:  104.7132926130771
curr_Factors:  [1.04713293e+02 4.27425928e-02]
mat_Sqrt:  [[ 2.16487212e+01  0.00000000e+00]
 [-8.26971272e-03  1.89482923e-02]]
grads:  [2.93674207e-03 3.98801272e+00]
Stock Position:  0.0029367420657881753
Bond Position:  [1.63591484]


portfolio before change:  [1.94651914]
curr_Stock_Price:  105.69528716715404
curr_Factors:  [1.05695287e+02 4.23253049e-02]
mat_Sqrt:  [[ 2.17448127e+01  0.00000000e+00]
 [-8.22924588e-03  1.88555711e-02]]
grads:  [-3.83636228e-03 -8.69275056e+00]
Stock Position:  -0.0038363622835392093
Bond Position:  [2.35200455]


portfolio before change:  [1.94872439]
curr_Stock_Price:  105.1970964814651
curr_Factors:  [1.05197096e+02 4.40811162e-02]
mat_Sqrt:  [[ 2.20866600e+01  0.00000000e+00]
 [-8.39820135e-03  1.92426967e-02]]
grads:  [8.44611694e-03 9.99943036e+00]
Stock Position:  0.008446116935927712
Bond Position:  [1.06021742]


portfolio before change:  [1.92468721]
curr_Stock_Price:  102.33545930298197
curr_Factors:  [1.02335459e+02 4.48795949e-02]
mat_Sqrt:  [[ 2.16795672e+01  0.00000000e+00]
 [-8.47392187e-03  1.94161942e-02]]
grads:  [3.35584542e-03 4.24129762e+00]
Stock Position:  0.00335584542253964
Bond Position:  [1.58126523]


portfolio before change:  [1.93073521]
curr_Stock_Price:  104.07878488763566
curr_Factors:  [1.04078785e+02 4.37439157e-02]
mat_Sqrt:  [[ 2.17681259e+01  0.00000000e+00]
 [-8.36601848e-03  1.91689565e-02]]
grads:  [ 2.48041817e-02 -2.61905843e+01]
Stock Position:  0.024804181697399917
Bond Position:  [-0.65085388]


portfolio before change:  [1.89319308]
curr_Stock_Price:  102.56852477348923
curr_Factors:  [1.02568525e+02 4.66652224e-02]
mat_Sqrt:  [[ 2.21569909e+01  0.00000000e+00]
 [-8.64085389e-03  1.97986835e-02]]
grads:  [-3.51466355e-03  1.29646888e+01]
Stock Position:  -0.0035146635548477237
Bond Position:  [2.25368694]


portfolio before change:  [1.89060479]
curr_Stock_Price:  103.38510846739017
curr_Factors:  [1.03385108e+02 4.66273584e-02]
mat_Sqrt:  [[ 2.23243279e+01  0.00000000e+00]
 [-8.63734759e-03  1.97906496e-02]]
grads:  [0.00587881 0.21077689]
Stock Position:  0.0058788106981725145
Bond Position:  [1.28282331]


portfolio before change:  [1.90237784]
curr_Stock_Price:  105.36045468022328
curr_Factors:  [1.05360455e+02 4.63550600e-02]
mat_Sqrt:  [[ 2.26843432e+01  0.00000000e+00]
 [-8.61209011e-03  1.97327774e-02]]
grads:  [-0.00330891 -3.13506106]
Stock Position:  -0.003308912244887642
Bond Position:  [2.25100634]


portfolio before change:  [1.90572008]
curr_Stock_Price:  104.43542408245692
curr_Factors:  [1.04435424e+02 4.68263154e-02]
mat_Sqrt:  [[ 2.25991876e+01  0.00000000e+00]
 [-8.65575558e-03  1.98328276e-02]]
grads:  [-3.14694417e-03 -8.59865841e+00]
Stock Position:  -0.003146944165692714
Bond Position:  [2.23437253]


portfolio before change:  [1.90246669]
curr_Stock_Price:  105.55800594504146
curr_Factors:  [1.05558006e+02 4.72271449e-02]
mat_Sqrt:  [[ 2.29396625e+01  0.00000000e+00]
 [-8.69272293e-03  1.99175304e-02]]
grads:  [ 9.83217835e-05 -3.51212638e+00]
Stock Position:  9.832178349240971e-05
Bond Position:  [1.89208804]


portfolio before change:  [1.90272438]
curr_Stock_Price:  105.77321508377197
curr_Factors:  [1.05773215e+02 4.72853853e-02]
mat_Sqrt:  [[ 2.30006003e+01  0.00000000e+00]
 [-8.69808120e-03  1.99298077e-02]]
grads:  [ 0.00312819 -0.51564537]
Stock Position:  0.0031281908853917615
Bond Position:  [1.57184557]


portfolio before change:  [1.90132772]
curr_Stock_Price:  105.26392570585197
curr_Factors:  [1.05263926e+02 4.81084515e-02]
mat_Sqrt:  [[ 2.30882094e+01  0.00000000e+00]
 [-8.77345556e-03  2.01025121e-02]]
grads:  [ 0.01367341 11.89977983]
Stock Position:  0.013673405150731139
Bond Position:  [0.46201141]


portfolio before change:  [1.88781249]
curr_Stock_Price:  104.27127012661391
curr_Factors:  [1.04271270e+02 4.87554097e-02]
mat_Sqrt:  [[ 2.30237504e+01  0.00000000e+00]
 [-8.83225087e-03  2.02372291e-02]]
grads:  [0.00998536 1.65379595]
Stock Position:  0.009985358057955168
Bond Position:  [0.84662652]


portfolio before change:  [1.90658283]
curr_Stock_Price:  106.14045752919867
curr_Factors:  [1.06140458e+02 4.79637272e-02]
mat_Sqrt:  [[ 2.32454211e+01  0.00000000e+00]
 [-8.76024905e-03  2.00722522e-02]]
grads:  [ -0.01284261 -11.80882388]
Stock Position:  -0.012842606082356052
Bond Position:  [3.26970292]


portfolio before change:  [1.89978025]
curr_Stock_Price:  106.70197251018205
curr_Factors:  [1.06701973e+02 4.86937129e-02]
mat_Sqrt:  [[ 2.35455529e+01  0.00000000e+00]
 [-8.82666079e-03  2.02244206e-02]]
grads:  [ 0.00611446 -4.11711922]
Stock Position:  0.006114462696178157
Bond Position:  [1.24735502]


portfolio before change:  [1.89942401]
curr_Stock_Price:  106.61820793278078
curr_Factors:  [1.06618208e+02 4.86086965e-02]
mat_Sqrt:  [[ 2.35065214e+01  0.00000000e+00]
 [-8.81895200e-03  2.02067575e-02]]
grads:  [-5.15826057e-03  9.12170436e+00]
Stock Position:  -0.005158260565487708
Bond Position:  [2.4493885]


portfolio before change:  [1.89206244]
curr_Stock_Price:  108.10470857374472
curr_Factors:  [1.08104709e+02 4.72504389e-02]
mat_Sqrt:  [[ 2.34989000e+01  0.00000000e+00]
 [-8.69486643e-03  1.99224418e-02]]
grads:  [-2.60946888e-03  6.19218062e+00]
Stock Position:  -0.0026094688828695927
Bond Position:  [2.17415831]


portfolio before change:  [1.88721968]
curr_Stock_Price:  110.06470629719023
curr_Factors:  [1.10064706e+02 4.76201491e-02]
mat_Sqrt:  [[ 2.40183658e+01  0.00000000e+00]
 [-8.72881656e-03  2.00002313e-02]]
grads:  [-0.00895726  8.46410102]
Stock Position:  -0.008957260350559448
Bond Position:  [2.8730979]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.88237727]
Stock Price:  110.64541574105462
PL:  [-8.76303847]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.07383035e-02  2.98133713e-01]
 [-1.73818683e-01 -8.07108424e-02]
 [ 8.00871464e-01 -6.70467105e-01]
 [-3.08242141e-02  3.45904567e-02]
 [-1.24486831e-01  5.31807925e-02]
 [-2.83579535e-02 -1.18487086e-02]
 [-1.01072240e-02  2.82952871e-01]
 [-9.37591725e-02 -8.21733878e-02]
 [ 1.64715234e-01  8.34703434e-02]
 [ 2.57691945e-01 -1.05206228e-01]
 [ 6.54637981e-02  5.49394453e-03]
 [-1.41111468e-01 -1.67805205e-01]
 [-1.80514933e-01  1.62546205e-01]
 [-5.13390354e-01 -6.58483722e-01]
 [ 5.56405083e-02  1.28680847e-01]
 [ 5.37711420e-02 -2.02584542e-02]
 [-5.15907845e-02  1.93093144e-01]
 [-3.40153245e-02  2.75668711e-02]
 [ 1.57906361e-02  4.37221745e-02]
 [ 5.14006786e-02 -9.68872953e-02]
 [ 8.89573870e-02 -6.48184621e-03]
 [ 8.51943833e-02  2.90255477e-01]
 [ 3.61777395e-02  2.91899487e-01]
 [-4.59451658e-02  1.33236587e-01]
 [ 2.33117139e-02  5.73302562e-02]
 [ 4.13620877e-01 -7.44630934e-02]
 [-3.81366529e-02  2.13867343e-01]
 [-2.03443783e-01  1.45179799e-01]
 [-7.21194867e-02 -1.01173863e-01]
 [ 5.91382399e-02 -6.01443721e-02]
 [-9.34162839e-01 -1.08558350e-01]
 [-1.21543983e-01  7.62629125e-02]
 [ 5.37581123e-04 -9.07502847e-02]
 [ 8.87967643e-02  9.83667336e-02]
 [-1.39621244e-01  9.84176229e-02]
 [-1.12353749e+00 -1.87045647e-01]
 [-5.10180787e-02  2.65711594e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.92127251e-01 -1.70847896e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.43550343]
curr_Stock_Price:  99.95898844250976
curr_Factors:  [9.99589884e+01 3.92332503e-02]
mat_Sqrt:  [[ 1.97992617e+01  0.00000000e+00]
 [-7.92295402e-03  1.81537683e-02]]
grads:  [8.12426874e-03 1.64226902e+01]
Stock Position:  0.008124268741170698
Bond Position:  [1.62340974]


portfolio before change:  [2.43880844]
curr_Stock_Price:  100.34081602954666
curr_Factors:  [1.00340816e+02 3.89138412e-02]
mat_Sqrt:  [[ 1.97938229e+01  0.00000000e+00]
 [-7.89063660e-03  1.80797198e-02]]
grads:  [-0.01056106 -4.46416446]
Stock Position:  -0.010561061573582574
Bond Position:  [3.49851397]


portfolio before change:  [2.44079949]
curr_Stock_Price:  100.19369882560792
curr_Factors:  [1.00193699e+02 3.83454833e-02]
mat_Sqrt:  [[ 1.96199329e+01  0.00000000e+00]
 [-7.83280111e-03  1.79472020e-02]]
grads:  [ 2.59050647e-02 -3.73577511e+01]
Stock Position:  0.025905064656058026
Bond Position:  [-0.15472476]


portfolio before change:  [2.43164038]
curr_Stock_Price:  99.84088091538176
curr_Factors:  [9.98408809e+01 3.97863932e-02]
mat_Sqrt:  [[ 1.99147881e+01  0.00000000e+00]
 [-7.97861073e-03  1.82812938e-02]]
grads:  [-7.89749864e-04  1.89212301e+00]
Stock Position:  -0.0007897498640169212
Bond Position:  [2.5104897]


portfolio before change:  [2.43050005]
curr_Stock_Price:  101.6821773849882
curr_Factors:  [1.01682177e+02 4.04292999e-02]
mat_Sqrt:  [[ 2.04452746e+01  0.00000000e+00]
 [-8.04281542e-03  1.84284052e-02]]
grads:  [-0.00495356  2.88580546]
Stock Position:  -0.004953556877153955
Bond Position:  [2.93418849]


portfolio before change:  [2.43237809]
curr_Stock_Price:  101.37709474900673
curr_Factors:  [1.01377095e+02 3.97836163e-02]
mat_Sqrt:  [[ 2.02205037e+01  0.00000000e+00]
 [-7.97833229e-03  1.82806558e-02]]
grads:  [-0.00165818 -0.64815555]
Stock Position:  -0.0016581759956881836
Bond Position:  [2.60047915]


portfolio before change:  [2.4349271]
curr_Stock_Price:  100.03589982068533
curr_Factors:  [1.00035900e+02 4.19659047e-02]
mat_Sqrt:  [[ 2.04929357e+01  0.00000000e+00]
 [-8.19423257e-03  1.87753455e-02]]
grads:  [5.53281065e-03 1.50704481e+01]
Stock Position:  0.00553281065173999
Bond Position:  [1.88144741]


portfolio before change:  [2.42817342]
curr_Stock_Price:  98.77272934034491
curr_Factors:  [9.87727293e+01 4.19456805e-02]
mat_Sqrt:  [[ 2.02292917e+01  0.00000000e+00]
 [-8.19225786e-03  1.87708209e-02]]
grads:  [-0.00640767 -4.37771946]
Stock Position:  -0.006407667701545173
Bond Position:  [3.06107624]


portfolio before change:  [2.42852792]
curr_Stock_Price:  98.7771234433079
curr_Factors:  [9.87771234e+01 4.21146762e-02]
mat_Sqrt:  [[ 2.02709036e+01  0.00000000e+00]
 [-8.20874424e-03  1.88085959e-02]]
grads:  [0.00992283 4.43788275]
Stock Position:  0.009922827439632543
Bond Position:  [1.44837957]


portfolio before change:  [2.43664857]
curr_Stock_Price:  99.5772580387189
curr_Factors:  [9.95772580e+01 4.29415094e-02]
mat_Sqrt:  [[ 2.06347312e+01  0.00000000e+00]
 [-8.28893329e-03  1.89923321e-02]]
grads:  [ 0.01026309 -5.53940547]
Stock Position:  0.010263093818983384
Bond Position:  [1.41467783]


portfolio before change:  [2.45744537]
curr_Stock_Price:  101.58639365052369
curr_Factors:  [1.01586394e+02 4.22337765e-02]
mat_Sqrt:  [[ 2.08768755e+01  0.00000000e+00]
 [-8.22034320e-03  1.88351725e-02]]
grads:  [0.00325056 0.29168538]
Stock Position:  0.0032505607466495213
Bond Position:  [2.12723262]


portfolio before change:  [2.4581881]
curr_Stock_Price:  101.73307824591413
curr_Factors:  [1.01733078e+02 4.17073494e-02]
mat_Sqrt:  [[ 2.07763131e+01  0.00000000e+00]
 [-8.16895092e-03  1.87174180e-02]]
grads:  [-0.01031692 -8.96518982]
Stock Position:  -0.010316924988652365
Bond Position:  [3.50776063]


portfolio before change:  [2.45661748]
curr_Stock_Price:  101.9278181094217
curr_Factors:  [1.01927818e+02 4.34678869e-02]
mat_Sqrt:  [[ 2.12508836e+01  0.00000000e+00]
 [-8.33958147e-03  1.91083817e-02]]
grads:  [-5.15620693e-03  8.50653960e+00]
Stock Position:  -0.005156206929614836
Bond Position:  [2.9821784]


portfolio before change:  [2.45810005]
curr_Stock_Price:  101.7125870596048
curr_Factors:  [1.01712587e+02 4.23886293e-02]
mat_Sqrt:  [[ 2.09410950e+01  0.00000000e+00]
 [-8.23539962e-03  1.88696711e-02]]
grads:  [ -0.03823946 -34.89640704]
Stock Position:  -0.03823946219873176
Bond Position:  [6.34753468]


portfolio before change:  [2.43477492]
curr_Stock_Price:  102.34331288544755
curr_Factors:  [1.02343313e+02 4.34193675e-02]
mat_Sqrt:  [[ 2.13255980e+01  0.00000000e+00]
 [-8.33492580e-03  1.90977142e-02]]
grads:  [5.24259316e-03 6.73802349e+00]
Stock Position:  0.005242593159227049
Bond Position:  [1.89823057]


portfolio before change:  [2.42497625]
curr_Stock_Price:  100.42900024107108
curr_Factors:  [1.0042900e+02 4.3338012e-02]
mat_Sqrt:  [[ 2.09070921e+01  0.00000000e+00]
 [-8.32711349e-03  1.90798140e-02]]
grads:  [ 0.00214901 -1.0617742 ]
Stock Position:  0.0021490137189007067
Bond Position:  [2.20915295]


portfolio before change:  [2.4239241]
curr_Stock_Price:  99.81089345252853
curr_Factors:  [9.98108935e+01 4.46145019e-02]
mat_Sqrt:  [[ 2.10822019e+01  0.00000000e+00]
 [-8.44885810e-03  1.93587659e-02]]
grads:  [1.55021627e-03 9.97445523e+00]
Stock Position:  0.0015502162692348311
Bond Position:  [2.26919562]


portfolio before change:  [2.42334188]
curr_Stock_Price:  99.25233684529695
curr_Factors:  [9.92523368e+01 4.38822947e-02]
mat_Sqrt:  [[ 2.07914800e+01  0.00000000e+00]
 [-8.37924051e-03  1.91992520e-02]]
grads:  [-1.05736367e-03  1.43583048e+00]
Stock Position:  -0.0010573636690061302
Bond Position:  [2.52828769]


portfolio before change:  [2.42524681]
curr_Stock_Price:  97.74965623505122
curr_Factors:  [9.77496562e+01 4.39572549e-02]
mat_Sqrt:  [[ 2.04941788e+01  0.00000000e+00]
 [-8.38639421e-03  1.92156431e-02]]
grads:  [1.70158355e-03 2.27534276e+00]
Stock Position:  0.0017015835490281747
Bond Position:  [2.25891761]


portfolio before change:  [2.42734405]
curr_Stock_Price:  98.81622300146906
curr_Factors:  [9.88162230e+01 4.44353714e-02]
mat_Sqrt:  [[ 2.08301625e+01  0.00000000e+00]
 [-8.43187963e-03  1.93198633e-02]]
grads:  [ 4.37615228e-04 -5.01490583e+00]
Stock Position:  0.00043761522763714994
Bond Position:  [2.38410057]


portfolio before change:  [2.42796972]
curr_Stock_Price:  99.56491350897107
curr_Factors:  [9.95649135e+01 4.42729807e-02]
mat_Sqrt:  [[ 2.09495984e+01  0.00000000e+00]
 [-8.41645823e-03  1.92845285e-02]]
grads:  [ 0.00411122 -0.3361164 ]
Stock Position:  0.004111223317932749
Bond Position:  [2.01863613]


portfolio before change:  [2.42378175]
curr_Stock_Price:  98.48486546434285
curr_Factors:  [9.84848655e+01 4.42735838e-02]
mat_Sqrt:  [[ 2.07224851e+01  0.00000000e+00]
 [-8.41651556e-03  1.92846598e-02]]
grads:  [1.02242689e-02 1.50511069e+01]
Stock Position:  0.010224268875757848
Bond Position:  [1.416846]


portfolio before change:  [2.42760133]
curr_Stock_Price:  98.84112238984777
curr_Factors:  [9.88411224e+01 4.32529733e-02]
mat_Sqrt:  [[ 2.05563334e+01  0.00000000e+00]
 [-8.31893968e-03  1.90610854e-02]]
grads:  [7.95731013e-03 1.53138964e+01]
Stock Position:  0.007957310126911126
Bond Position:  [1.64109187]


portfolio before change:  [2.43137481]
curr_Stock_Price:  99.28955628720267
curr_Factors:  [9.92895563e+01 4.27810001e-02]
mat_Sqrt:  [[ 2.05366233e+01  0.00000000e+00]
 [-8.27342735e-03  1.89568035e-02]]
grads:  [5.94257767e-04 7.02843105e+00]
Stock Position:  0.0005942577674795544
Bond Position:  [2.37237122]


portfolio before change:  [2.43136674]
curr_Stock_Price:  98.77693353317167
curr_Factors:  [9.87769335e+01 4.57454381e-02]
mat_Sqrt:  [[ 2.11265915e+01  0.00000000e+00]
 [-8.55527328e-03  1.96025937e-02]]
grads:  [2.28776559e-03 2.92462605e+00]
Stock Position:  0.0022877655867941053
Bond Position:  [2.20538827]


portfolio before change:  [2.43132809]
curr_Stock_Price:  98.6395335456912
curr_Factors:  [9.86395335e+01 4.56097454e-02]
mat_Sqrt:  [[ 2.10658911e+01  0.00000000e+00]
 [-8.54257530e-03  1.95734990e-02]]
grads:  [ 0.01809192 -3.80428116]
Stock Position:  0.018091924904404047
Bond Position:  [0.64674906]


portfolio before change:  [2.43015931]
curr_Stock_Price:  98.5704622138326
curr_Factors:  [9.85704622e+01 4.54154449e-02]
mat_Sqrt:  [[ 2.10062524e+01  0.00000000e+00]
 [-8.52435990e-03  1.95317623e-02]]
grads:  [2.62791795e-03 1.09497208e+01]
Stock Position:  0.002627917951954925
Bond Position:  [2.17112422]


portfolio before change:  [2.43096395]
curr_Stock_Price:  98.77337336389489
curr_Factors:  [9.87733734e+01 4.47138399e-02]
mat_Sqrt:  [[ 2.08862691e+01  0.00000000e+00]
 [-8.45825891e-03  1.93803059e-02]]
grads:  [-6.70690030e-03  7.49109946e+00]
Stock Position:  -0.006706900295463072
Bond Position:  [3.09342712]


portfolio before change:  [2.43424768]
curr_Stock_Price:  98.34142654012723
curr_Factors:  [9.83414265e+01 4.45789804e-02]
mat_Sqrt:  [[ 2.07635481e+01  0.00000000e+00]
 [-8.44549398e-03  1.93510577e-02]]
grads:  [-0.00559998 -5.2283376 ]
Stock Position:  -0.005599976440217989
Bond Position:  [2.98495735]


portfolio before change:  [2.43336734]
curr_Stock_Price:  98.56526298829114
curr_Factors:  [9.85652630e+01 4.49927048e-02]
mat_Sqrt:  [[ 2.09071549e+01  0.00000000e+00]
 [-8.48459355e-03  1.94406461e-02]]
grads:  [ 1.57310185e-03 -3.09374348e+00]
Stock Position:  0.0015731018476831866
Bond Position:  [2.27831414]


portfolio before change:  [2.43153965]
curr_Stock_Price:  97.22237469481034
curr_Factors:  [9.72223747e+01 4.54363912e-02]
mat_Sqrt:  [[ 2.07237402e+01  0.00000000e+00]
 [-8.52632546e-03  1.95362659e-02]]
grads:  [-0.04736315 -5.55676048]
Stock Position:  -0.047363148581405674
Bond Position:  [7.03629743]


portfolio before change:  [2.46974293]
curr_Stock_Price:  96.43434244858294
curr_Factors:  [9.64343424e+01 4.66112139e-02]
mat_Sqrt:  [[ 2.08198181e+01  0.00000000e+00]
 [-8.63585214e-03  1.97872231e-02]]
grads:  [-0.00423924  3.85414933]
Stock Position:  -0.004239235865280399
Bond Position:  [2.87855085]


portfolio before change:  [2.46284598]
curr_Stock_Price:  98.14615875834357
curr_Factors:  [9.81461588e+01 4.52523389e-02]
mat_Sqrt:  [[ 2.08782370e+01  0.00000000e+00]
 [-8.50903885e-03  1.94966573e-02]]
grads:  [-1.87128301e-03 -4.65465865e+00]
Stock Position:  -0.0018712830145404874
Bond Position:  [2.64650522]


portfolio before change:  [2.4631793]
curr_Stock_Price:  98.14482672898808
curr_Factors:  [9.81448267e+01 4.41844467e-02]
mat_Sqrt:  [[ 2.06301375e+01  0.00000000e+00]
 [-8.40803870e-03  1.92652369e-02]]
grads:  [0.0063852  5.10591872]
Stock Position:  0.006385198661177341
Bond Position:  [1.83650509]


portfolio before change:  [2.46500771]
curr_Stock_Price:  98.39522332897677
curr_Factors:  [9.83952233e+01 4.36724315e-02]
mat_Sqrt:  [[ 2.05625846e+01  0.00000000e+00]
 [-8.35918001e-03  1.91532876e-02]]
grads:  [-4.70117320e-03  5.13841932e+00]
Stock Position:  -0.0047011731952225615
Bond Position:  [2.9275807]


portfolio before change:  [2.47537388]
curr_Stock_Price:  96.26805230475331
curr_Factors:  [9.62680523e+01 4.46611862e-02]
mat_Sqrt:  [[ 2.03445137e+01  0.00000000e+00]
 [-8.45327735e-03  1.93688917e-02]]
grads:  [-0.05923813 -9.65701345]
Stock Position:  -0.059238127988647464
Bond Position:  [8.17811309]


portfolio before change:  [2.50552097]
curr_Stock_Price:  95.77639662947999
curr_Factors:  [9.57763966e+01 4.39447663e-02]
mat_Sqrt:  [[ 2.00776127e+01  0.00000000e+00]
 [-8.38520280e-03  1.92129133e-02]]
grads:  [3.23484516e-03 1.38298440e+01]
Stock Position:  0.00323484515855346
Bond Position:  [2.19569916]


portfolio before change:  [2.50343731]
curr_Stock_Price:  95.04741437170807
curr_Factors:  [9.50474144e+01 4.23527402e-02]
mat_Sqrt:  [[ 1.95605501e+01  0.00000000e+00]
 [-8.23191256e-03  1.88616812e-02]]
grads:  [-4.50831980e-03  5.79809208e+00]
Stock Position:  -0.004508319801683848
Bond Position:  [2.93194145]


portfolio before change:  [2.49810248]
curr_Stock_Price:  96.31204109251003
curr_Factors:  [9.63120411e+01 3.99572509e-02]
mat_Sqrt:  [[ 1.92521123e+01  0.00000000e+00]
 [-7.99572395e-03  1.83205051e-02]]
grads:  [ 0.04630046 -0.09325501]
Stock Position:  0.04630045753812294
Bond Position:  [-1.96118909]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.44943359]
Stock Price:  95.26618257492628
PL:  [2.44943359]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.89707647e-01  4.95182948e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.52384326e-01 -7.74371651e-01]
 [-2.30828873e-02  2.57891818e-02]
 [ 3.87822381e-02 -3.99395406e-02]
 [-8.30453209e-02 -9.25624169e-02]
 [-1.32941047e-01  7.93317119e-02]
 [ 6.83402413e-02 -1.44964310e-01]
 [ 1.64484994e-01  1.50489876e-01]
 [-1.31138792e-01  4.14375592e-01]
 [ 2.30820614e-01  7.04164683e-01]
 [ 8.06506441e-02  3.58641536e-01]
 [ 3.79675990e-01  2.49190140e-02]
 [ 1.55168202e-02  1.56603186e-01]
 [ 9.90163258e-02  2.42164291e-01]
 [ 3.22098420e-02  2.38334271e-01]
 [ 1.73969270e-01  4.47125395e-01]
 [ 1.59359536e-01  7.05043856e-02]
 [ 4.08181804e-02 -9.07529164e-02]
 [ 4.28005214e-01 -1.23250668e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.49733085e-02  4.31414353e-02]
 [-7.20442814e-02 -5.53453819e-02]
 [ 1.28792282e-02 -8.41981380e-02]
 [ 2.40310444e-02  1.50067872e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.64771752e-01  1.02696401e-01]
 [-2.44414741e-01 -1.47803802e-02]
 [ 1.60337718e-01 -8.37959545e-02]
 [-1.00789594e+00 -1.14178357e-01]
 [-1.06037402e-01  9.38121119e-02]
 [-8.89963472e-03 -1.01224357e-01]
 [ 3.87930289e-02  8.04261311e-02]
 [-5.71770317e-02  1.62986820e-01]
 [-1.61532460e+00 -8.70175451e-02]
 [-5.49043108e-02  2.60870871e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.02935458e+00 -1.95517812e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.21594315]
curr_Stock_Price:  100.52838385345784
curr_Factors:  [1.00528384e+02 3.95650678e-02]
mat_Sqrt:  [[ 1.99960704e+01  0.00000000e+00]
 [-7.95638791e-03  1.82303749e-02]]
grads:  [2.02951477e-02 2.71625213e+01]
Stock Position:  0.020295147731757338
Bond Position:  [4.17570475]


portfolio before change:  [6.19876127]
curr_Stock_Price:  99.65606307998075
curr_Factors:  [9.96560631e+01 4.10107896e-02]
mat_Sqrt:  [[ 2.01814698e+01  0.00000000e+00]
 [-8.10044835e-03  1.85604589e-02]]
grads:  [-0.01005796 -4.7418747 ]
Stock Position:  -0.010057961595300022
Bond Position:  [7.20109813]


portfolio before change:  [6.21282759]
curr_Stock_Price:  98.34703775204358
curr_Factors:  [9.83470378e+01 4.28374005e-02]
mat_Sqrt:  [[ 2.03550811e+01  0.00000000e+00]
 [-8.27887920e-03  1.89692953e-02]]
grads:  [ 2.52723547e-02 -4.08223732e+01]
Stock Position:  0.025272354697913887
Bond Position:  [3.72736637]


portfolio before change:  [6.25598934]
curr_Stock_Price:  100.03646487303882
curr_Factors:  [1.00036465e+02 4.20966665e-02]
mat_Sqrt:  [[ 2.05249539e+01  0.00000000e+00]
 [-8.20698887e-03  1.88045739e-02]]
grads:  [-5.76252968e-04  1.37143133e+00]
Stock Position:  -0.00057625296757367
Bond Position:  [6.31363565]


portfolio before change:  [6.25773594]
curr_Stock_Price:  98.37513238328933
curr_Factors:  [9.83751324e+01 4.18496896e-02]
mat_Sqrt:  [[ 2.01247943e+01  0.00000000e+00]
 [-8.18287867e-03  1.87493305e-02]]
grads:  [ 1.06093971e-03 -2.13018490e+00]
Stock Position:  0.0010609397121528394
Bond Position:  [6.15336586]


portfolio before change:  [6.25867241]
curr_Stock_Price:  98.5327716471746
curr_Factors:  [9.85327716e+01 4.20888278e-02]
mat_Sqrt:  [[ 2.02145517e+01  0.00000000e+00]
 [-8.20622474e-03  1.88028230e-02]]
grads:  [-0.00610663 -4.9227936 ]
Stock Position:  -0.006106634138556259
Bond Position:  [6.860376]


portfolio before change:  [6.27358553]
curr_Stock_Price:  96.2310917238263
curr_Factors:  [9.62310917e+01 4.18563456e-02]
mat_Sqrt:  [[ 1.96877491e+01  0.00000000e+00]
 [-8.18352937e-03  1.87508214e-02]]
grads:  [-0.00499386  4.23083929]
Stock Position:  -0.004993859295034953
Bond Position:  [6.75415006]


portfolio before change:  [6.27531651]
curr_Stock_Price:  96.05354052831153
curr_Factors:  [9.60535405e+01 4.43889448e-02]
mat_Sqrt:  [[ 2.02372170e+01  0.00000000e+00]
 [-8.42747362e-03  1.93097679e-02]]
grads:  [ 2.50658443e-04 -7.50730466e+00]
Stock Position:  0.0002506584434411127
Bond Position:  [6.25123988]


portfolio before change:  [6.27580259]
curr_Stock_Price:  94.87512829051465
curr_Factors:  [9.48751283e+01 4.43006698e-02]
mat_Sqrt:  [[ 1.99690554e+01  0.00000000e+00]
 [-8.41908972e-03  1.92905580e-02]]
grads:  [0.01152604 7.80121948]
Stock Position:  0.011526041447497819
Bond Position:  [5.18226793]


portfolio before change:  [6.26096176]
curr_Stock_Price:  93.5313323161705
curr_Factors:  [9.35313323e+01 4.34794000e-02]
mat_Sqrt:  [[ 1.95028864e+01  0.00000000e+00]
 [-8.34068582e-03  1.91109121e-02]]
grads:  [2.54883007e-03 2.16826696e+01]
Stock Position:  0.0025488300670446565
Bond Position:  [6.02256629]


portfolio before change:  [6.25870865]
curr_Stock_Price:  92.3519732183962
curr_Factors:  [9.23519732e+01 4.43835475e-02]
mat_Sqrt:  [[ 1.94561625e+01  0.00000000e+00]
 [-8.42696126e-03  1.93085939e-02]]
grads:  [2.76592713e-02 3.64689778e+01]
Stock Position:  0.027659271304150686
Bond Position:  [3.70432036]


portfolio before change:  [6.27160259]
curr_Stock_Price:  92.80140212509036
curr_Factors:  [9.28014021e+01 4.38601097e-02]
mat_Sqrt:  [[ 1.94352170e+01  0.00000000e+00]
 [-8.37712215e-03  1.91943982e-02]]
grads:  [1.22033442e-02 1.86846982e+01]
Stock Position:  0.01220334419032925
Bond Position:  [5.13911514]


portfolio before change:  [6.27836493]
curr_Stock_Price:  93.30289693531606
curr_Factors:  [9.33028969e+01 4.38873879e-02]
mat_Sqrt:  [[ 1.95463196e+01  0.00000000e+00]
 [-8.37972676e-03  1.92003661e-02]]
grads:  [0.01998082 1.29784056]
Stock Position:  0.019980822355878888
Bond Position:  [4.41409633]


portfolio before change:  [6.27690014]
curr_Stock_Price:  93.20197039370905
curr_Factors:  [9.32019704e+01 4.31068435e-02]
mat_Sqrt:  [[ 1.93507680e+01  0.00000000e+00]
 [-8.30487505e-03  1.90288593e-02]]
grads:  [4.33388763e-03 8.22977268e+00]
Stock Position:  0.004333887631181446
Bond Position:  [5.87297327]


portfolio before change:  [6.27976217]
curr_Stock_Price:  93.69295474651483
curr_Factors:  [9.36929547e+01 4.32231201e-02]
mat_Sqrt:  [[ 1.94789253e+01  0.00000000e+00]
 [-8.31606831e-03  1.90545063e-02]]
grads:  [1.0509075e-02 1.2709030e+01]
Stock Position:  0.010509075020194587
Bond Position:  [5.29513588]


portfolio before change:  [6.27439715]
curr_Stock_Price:  93.11945468312784
curr_Factors:  [9.31194547e+01 4.33528061e-02]
mat_Sqrt:  [[ 1.93887152e+01  0.00000000e+00]
 [-8.32853467e-03  1.90830703e-02]]
grads:  [7.02612031e-03 1.24893042e+01]
Stock Position:  0.007026120309370571
Bond Position:  [5.62012866]


portfolio before change:  [6.27446372]
curr_Stock_Price:  93.02893588288956
curr_Factors:  [9.30289359e+01 4.37796502e-02]
mat_Sqrt:  [[ 1.94649905e+01  0.00000000e+00]
 [-8.36943489e-03  1.91767844e-02]]
grads:  [1.89628035e-02 2.33159733e+01]
Stock Position:  0.018962803484466117
Bond Position:  [4.51037429]


portfolio before change:  [6.2637975]
curr_Stock_Price:  92.43672120549141
curr_Factors:  [9.24367212e+01 4.51830394e-02]
mat_Sqrt:  [[ 1.96486290e+01  0.00000000e+00]
 [-8.50252098e-03  1.94817230e-02]]
grads:  [0.00967651 3.61900154]
Stock Position:  0.009676510879592547
Bond Position:  [5.36933256]


portfolio before change:  [6.26942689]
curr_Stock_Price:  92.94911454077213
curr_Factors:  [9.29491145e+01 4.44923896e-02]
mat_Sqrt:  [[ 1.96059605e+01  0.00000000e+00]
 [-8.43728768e-03  1.93322547e-02]]
grads:  [ 6.17343109e-05 -4.69437827e+00]
Stock Position:  6.173431090524393e-05
Bond Position:  [6.26368874]


portfolio before change:  [6.27023032]
curr_Stock_Price:  93.27989403300624
curr_Factors:  [9.32798940e+01 4.56765425e-02]
mat_Sqrt:  [[ 1.99358453e+01  0.00000000e+00]
 [-8.54882846e-03  1.95878268e-02]]
grads:  [ 0.01877092 -6.29220739]
Stock Position:  0.01877092274347219
Bond Position:  [4.51928063]


portfolio before change:  [6.27543464]
curr_Stock_Price:  93.52705159776728
curr_Factors:  [9.35270516e+01 4.58742785e-02]
mat_Sqrt:  [[ 2.00318872e+01  0.00000000e+00]
 [-8.56731263e-03  1.96301793e-02]]
grads:  [ 0.00210308 -1.92448521]
Stock Position:  0.0021030774630617735
Bond Position:  [6.07874]


portfolio before change:  [6.27431694]
curr_Stock_Price:  92.63427005474783
curr_Factors:  [9.26342701e+01 4.59158708e-02]
mat_Sqrt:  [[ 1.98496611e+01  0.00000000e+00]
 [-8.57119556e-03  1.96390762e-02]]
grads:  [-3.09569140e-04  2.19671408e+00]
Stock Position:  -0.0003095691395640156
Bond Position:  [6.30299365]


portfolio before change:  [6.27533444]
curr_Stock_Price:  91.8926552710359
curr_Factors:  [9.18926553e+01 4.60187561e-02]
mat_Sqrt:  [[ 1.97127965e+01  0.00000000e+00]
 [-8.58079307e-03  1.96610669e-02]]
grads:  [-0.00488003 -2.81497348]
Stock Position:  -0.004880027369380081
Bond Position:  [6.72377312]


portfolio before change:  [6.26810432]
curr_Stock_Price:  93.54646771463368
curr_Factors:  [9.35464677e+01 4.60690675e-02]
mat_Sqrt:  [[ 2.00785388e+01  0.00000000e+00]
 [-8.58548240e-03  1.96718115e-02]]
grads:  [-1.18872454e-03 -4.28014157e+00]
Stock Position:  -0.0011887245444620119
Bond Position:  [6.3793053]


portfolio before change:  [6.26964886]
curr_Stock_Price:  92.91799444217568
curr_Factors:  [9.29179944e+01 4.58960147e-02]
mat_Sqrt:  [[ 1.99061520e+01  0.00000000e+00]
 [-8.56934207e-03  1.96348293e-02]]
grads:  [4.49740529e-03 7.64294252e+00]
Stock Position:  0.0044974052945148425
Bond Position:  [5.85175898]


portfolio before change:  [6.27228494]
curr_Stock_Price:  93.34147445860567
curr_Factors:  [9.33414745e+01 4.45715761e-02]
mat_Sqrt:  [[ 1.97062348e+01  0.00000000e+00]
 [-8.44479258e-03  1.93494506e-02]]
grads:  [6.36776340e-03 9.40949298e+00]
Stock Position:  0.006367763403342868
Bond Position:  [5.67790851]


portfolio before change:  [6.28279634]
curr_Stock_Price:  94.88073059756039
curr_Factors:  [9.48807306e+01 4.40053973e-02]
mat_Sqrt:  [[ 1.99035706e+01  0.00000000e+00]
 [-8.39098538e-03  1.92261628e-02]]
grads:  [8.95123815e-03 9.09892400e+00]
Stock Position:  0.008951238150122902
Bond Position:  [5.43349632]


portfolio before change:  [6.28228364]
curr_Stock_Price:  94.74757267737019
curr_Factors:  [9.47475727e+01 4.30711735e-02]
mat_Sqrt:  [[ 1.96635282e+01  0.00000000e+00]
 [-8.30143829e-03  1.90209847e-02]]
grads:  [-0.0061002   5.39911067]
Stock Position:  -0.006100195592172247
Bond Position:  [6.86026237]


portfolio before change:  [6.27755012]
curr_Stock_Price:  95.664119047834
curr_Factors:  [9.56641190e+01 4.33140735e-02]
mat_Sqrt:  [[ 1.99096484e+01  0.00000000e+00]
 [-8.32481337e-03  1.90745437e-02]]
grads:  [-0.01260019 -0.77487464]
Stock Position:  -0.012600193739794843
Bond Position:  [7.48293655]


portfolio before change:  [6.27615906]
curr_Stock_Price:  95.84875764086554
curr_Factors:  [9.58487576e+01 4.29171221e-02]
mat_Sqrt:  [[ 1.98564581e+01  0.00000000e+00]
 [-8.28657923e-03  1.89869383e-02]]
grads:  [ 0.00623304 -4.41334739]
Stock Position:  0.006233043404065038
Bond Position:  [5.67872959]


portfolio before change:  [6.28093593]
curr_Stock_Price:  96.50124557401044
curr_Factors:  [9.65012456e+01 4.21451311e-02]
mat_Sqrt:  [[ 1.98110103e+01  0.00000000e+00]
 [-8.21171175e-03  1.88153953e-02]]
grads:  [-0.05339089 -6.06834747]
Stock Position:  -0.053390889494190893
Bond Position:  [11.43322327]


portfolio before change:  [6.29588129]
curr_Stock_Price:  96.248091511177
curr_Factors:  [9.62480915e+01 4.38176824e-02]
mat_Sqrt:  [[ 2.01472988e+01  0.00000000e+00]
 [-8.37306944e-03  1.91851123e-02]]
grads:  [-3.23092639e-03  4.88983909e+00]
Stock Position:  -0.0032309263914140373
Bond Position:  [6.60685179]


portfolio before change:  [6.29454174]
curr_Stock_Price:  96.91832200163029
curr_Factors:  [9.69183220e+01 4.30097321e-02]
mat_Sqrt:  [[ 2.00996852e+01  0.00000000e+00]
 [-8.29551514e-03  1.90074130e-02]]
grads:  [-2.64071628e-03 -5.32551993e+00]
Stock Position:  -0.0026407162806197614
Bond Position:  [6.55047553]


portfolio before change:  [6.30002377]
curr_Stock_Price:  95.15244921494444
curr_Factors:  [9.51524492e+01 4.27658649e-02]
mat_Sqrt:  [[ 1.96774402e+01  0.00000000e+00]
 [-8.27196372e-03  1.89534499e-02]]
grads:  [3.75525828e-03 4.24335049e+00]
Stock Position:  0.0037552582791979708
Bond Position:  [5.94270174]


portfolio before change:  [6.30195758]
curr_Stock_Price:  95.46958612194605
curr_Factors:  [9.54695861e+01 4.38261564e-02]
mat_Sqrt:  [[ 1.99862692e+01  0.00000000e+00]
 [-8.37387905e-03  1.91869673e-02]]
grads:  [6.98291821e-04 8.49466294e+00]
Stock Position:  0.000698291820864286
Bond Position:  [6.23529195]


portfolio before change:  [6.30174554]
curr_Stock_Price:  94.04969258698749
curr_Factors:  [9.40496926e+01 4.33267585e-02]
mat_Sqrt:  [[ 1.95765194e+01  0.00000000e+00]
 [-8.32603228e-03  1.90773366e-02]]
grads:  [-0.08445333 -4.5613047 ]
Stock Position:  -0.08445332550592369
Bond Position:  [14.24455484]


portfolio before change:  [6.1769643]
curr_Stock_Price:  95.54829456068795
curr_Factors:  [9.55482946e+01 4.16832950e-02]
mat_Sqrt:  [[ 1.95076053e+01  0.00000000e+00]
 [-8.16659488e-03  1.87120196e-02]]
grads:  [3.02185073e-03 1.39413530e+01]
Stock Position:  0.0030218507283054463
Bond Position:  [5.88823162]


portfolio before change:  [6.17405461]
curr_Stock_Price:  94.341827475571
curr_Factors:  [9.43418275e+01 4.31548321e-02]
mat_Sqrt:  [[ 1.95983270e+01  0.00000000e+00]
 [-8.30949645e-03  1.90394482e-02]]
grads:  [-4.49962975e-03  5.74395660e+00]
Stock Position:  -0.004499629752211431
Bond Position:  [6.59855791]


portfolio before change:  [6.17146379]
curr_Stock_Price:  95.10093405137137
curr_Factors:  [9.51009341e+01 4.16590841e-02]
mat_Sqrt:  [[ 1.94106304e+01  0.00000000e+00]
 [-8.16422284e-03  1.87065846e-02]]
grads:  [ 0.05259085 -1.04518177]
Stock Position:  0.052590846135947535
Bond Position:  [1.1700252]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.17788014]
Stock Price:  95.220158041748
PL:  [6.17788014]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.72721153e-01  5.98430883e-01]
 [-1.68803613e-01 -8.41735506e-02]
 [ 8.18623011e-01 -7.00615448e-01]
 [-2.77382452e-03  2.45625678e-02]
 [-9.90550167e-03  7.32421451e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-7.78172993e-02  1.56355097e-01]
 [-1.05478461e-01 -1.01934671e-01]
 [ 1.64807666e-01  1.39925711e-01]
 [ 1.68046516e-02  2.05157727e-01]
 [ 1.62453543e-01  3.49657902e-01]
 [ 1.40044915e-01  2.96330985e-01]
 [ 3.39487827e-01  2.41126997e-02]
 [-1.16283840e-02  8.72062354e-02]
 [ 9.89009891e-02  2.40312509e-01]
 [ 3.50023367e-02  2.01387626e-01]
 [ 1.36223016e-01  3.34475571e-01]
 [ 8.03464011e-02  6.40018088e-02]
 [ 2.57633680e-02 -5.38943647e-02]
 [ 3.91051940e-01 -1.19365992e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 2.13960227e-02  1.88772977e-01]
 [ 2.65977648e-02  1.50936197e-01]
 [-6.07457011e-02  5.75423304e-02]
 [ 5.66745823e-02  1.23246225e-01]
 [ 4.53110084e-02  1.53995870e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.60808886e-01  9.39329041e-02]
 [-4.29097204e-01  7.79112161e-02]
 [ 2.39804394e-01 -1.01801279e-01]
 [-1.30041198e+00 -1.46176201e-01]
 [ 1.15490952e-01  3.43056023e-01]
 [-6.83159142e-03 -1.28473253e-01]
 [ 1.22624195e-02  7.08700831e-02]
 [-5.03678165e-02  1.63527680e-01]
 [-1.28521571e+00 -1.55521716e-01]
 [-5.68992618e-02  2.59113687e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.87142209e-01 -1.02391313e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.19088684]
curr_Stock_Price:  100.8258423379371
curr_Factors:  [1.00825842e+02 4.08789138e-02]
mat_Sqrt:  [[ 2.03855077e+01  0.00000000e+00]
 [-8.08741381e-03  1.85305930e-02]]
grads:  [2.61900665e-02 3.22942112e+01]
Stock Position:  0.02619006645241922
Bond Position:  [5.55025133]


portfolio before change:  [8.17399314]
curr_Stock_Price:  100.15430824463445
curr_Factors:  [1.00154308e+02 3.91103899e-02]
mat_Sqrt:  [[ 1.98068635e+01  0.00000000e+00]
 [-7.91053879e-03  1.81253214e-02]]
grads:  [-0.01037721 -4.64397562]
Stock Position:  -0.010377209002881842
Bond Position:  [9.21331533]


portfolio before change:  [8.18093679]
curr_Stock_Price:  99.59617057582776
curr_Factors:  [9.95961706e+01 3.91217155e-02]
mat_Sqrt:  [[ 1.96993359e+01  0.00000000e+00]
 [-7.91168407e-03  1.81279456e-02]]
grads:  [ 2.60338401e-02 -3.86483645e+01]
Stock Position:  0.026033840100999482
Bond Position:  [5.58806601]


portfolio before change:  [8.20410826]
curr_Stock_Price:  100.45939009884778
curr_Factors:  [1.00459390e+02 3.94800088e-02]
mat_Sqrt:  [[ 1.99608558e+01  0.00000000e+00]
 [-7.94783078e-03  1.82107681e-02]]
grads:  [3.98087085e-04 1.34879362e+00]
Stock Position:  0.0003980870853731016
Bond Position:  [8.16411668]


portfolio before change:  [8.20492049]
curr_Stock_Price:  99.93600522892753
curr_Factors:  [9.99360052e+01 3.82543005e-02]
mat_Sqrt:  [[ 1.95461901e+01  0.00000000e+00]
 [-7.82348265e-03  1.79258507e-02]]
grads:  [-3.43235811e-04  4.08583928e-01]
Stock Position:  -0.0003432358105924989
Bond Position:  [8.2392221]


portfolio before change:  [8.20620266]
curr_Stock_Price:  99.20121293029092
curr_Factors:  [9.92012129e+01 3.81386204e-02]
mat_Sqrt:  [[ 1.93731157e+01  0.00000000e+00]
 [-7.81164468e-03  1.78987265e-02]]
grads:  [-0.00611263 -3.70511991]
Stock Position:  -0.006112634312230458
Bond Position:  [8.8125834]


portfolio before change:  [8.21478866]
curr_Stock_Price:  97.97680550110057
curr_Factors:  [9.79768055e+01 3.91582112e-02]
mat_Sqrt:  [[ 1.93880753e+01  0.00000000e+00]
 [-7.91537352e-03  1.81363991e-02]]
grads:  [-4.94032554e-04  8.62106619e+00]
Stock Position:  -0.000494032554447579
Bond Position:  [8.26319239]


portfolio before change:  [8.21581938]
curr_Stock_Price:  97.9813405574308
curr_Factors:  [9.79813406e+01 3.74157927e-02]
mat_Sqrt:  [[ 1.89526897e+01  0.00000000e+00]
 [-7.73726492e-03  1.77283011e-02]]
grads:  [-0.00791267 -5.74982741]
Stock Position:  -0.00791267102560199
Bond Position:  [8.9911135]


portfolio before change:  [8.23662451]
curr_Stock_Price:  95.49404227382603
curr_Factors:  [9.54940423e+01 3.61735613e-02]
mat_Sqrt:  [[ 1.81623446e+01  0.00000000e+00]
 [-7.60773935e-03  1.74315207e-02]]
grads:  [0.01243651 8.027166  ]
Stock Position:  0.012436514005690319
Bond Position:  [7.04901152]


portfolio before change:  [8.24503813]
curr_Stock_Price:  96.09971290002747
curr_Factors:  [9.60997129e+01 3.52254402e-02]
mat_Sqrt:  [[ 1.80364185e+01  0.00000000e+00]
 [-7.50737666e-03  1.72015609e-02]]
grads:  [5.89600558e-03 1.19266925e+01]
Stock Position:  0.005896005577055506
Bond Position:  [7.67843368]


portfolio before change:  [8.24841093]
curr_Stock_Price:  96.50896320336614
curr_Factors:  [9.65089632e+01 3.60979890e-02]
mat_Sqrt:  [[ 1.83361923e+01  0.00000000e+00]
 [-7.59978832e-03  1.74133026e-02]]
grads:  [1.71822349e-02 2.00799302e+01]
Stock Position:  0.017182234894490188
Bond Position:  [6.59017126]


portfolio before change:  [8.22569531]
curr_Stock_Price:  95.1389759299125
curr_Factors:  [9.51389759e+01 3.72160295e-02]
mat_Sqrt:  [[ 1.83536942e+01  0.00000000e+00]
 [-7.71658261e-03  1.76809120e-02]]
grads:  [1.46768469e-02 1.67599378e+01]
Stock Position:  0.014676846921432915
Bond Position:  [6.82935513]


portfolio before change:  [8.21175959]
curr_Stock_Price:  94.13130392932003
curr_Factors:  [9.41313039e+01 3.98205679e-02]
mat_Sqrt:  [[ 1.87839879e+01  0.00000000e+00]
 [-7.98203663e-03  1.82891435e-02]]
grads:  [0.0186335  1.31841602]
Stock Position:  0.018633501791452955
Bond Position:  [6.45776377]


portfolio before change:  [8.21710151]
curr_Stock_Price:  94.37466428041907
curr_Factors:  [9.43746643e+01 3.91994899e-02]
mat_Sqrt:  [[ 1.86851086e+01  0.00000000e+00]
 [-7.91954442e-03  1.81459559e-02]]
grads:  [1.41457766e-03 4.80582207e+00]
Stock Position:  0.0014145776645487138
Bond Position:  [8.08360122]


portfolio before change:  [8.21787659]
curr_Stock_Price:  94.20822475721977
curr_Factors:  [9.42082248e+01 3.99428308e-02]
mat_Sqrt:  [[ 1.88281756e+01  0.00000000e+00]
 [-7.99428104e-03  1.83171990e-02]]
grads:  [1.08232455e-02 1.31195009e+01]
Stock Position:  0.010823245470391223
Bond Position:  [7.19823784]


portfolio before change:  [8.21468553]
curr_Stock_Price:  93.8302519517846
curr_Factors:  [9.38302520e+01 3.96671915e-02]
mat_Sqrt:  [[ 1.86878186e+01  0.00000000e+00]
 [-7.96664964e-03  1.82538875e-02]]
grads:  [6.57621445e-03 1.10325883e+01]
Stock Position:  0.006576214454241222
Bond Position:  [7.59763767]


portfolio before change:  [8.21659587]
curr_Stock_Price:  93.97631983689061
curr_Factors:  [9.39763198e+01 3.98984741e-02]
mat_Sqrt:  [[ 1.87713962e+01  0.00000000e+00]
 [-7.98984096e-03  1.83070255e-02]]
grads:  [1.50335180e-02 1.82703395e+01]
Stock Position:  0.015033517972403525
Bond Position:  [6.80380117]


portfolio before change:  [8.24603879]
curr_Stock_Price:  95.87822941521097
curr_Factors:  [9.58782294e+01 4.04081470e-02]
mat_Sqrt:  [[ 1.92732286e+01  0.00000000e+00]
 [-8.04071112e-03  1.84235837e-02]]
grads:  [0.00561811 3.47390659]
Stock Position:  0.0056181080299584
Bond Position:  [7.70738454]


portfolio before change:  [8.23544077]
curr_Stock_Price:  93.82033099333354
curr_Factors:  [9.38203310e+01 4.15273072e-02]
mat_Sqrt:  [[ 1.91189416e+01  0.00000000e+00]
 [-8.15129999e-03  1.86769746e-02]]
grads:  [ 1.17262710e-04 -2.88560465e+00]
Stock Position:  0.00011726270953012694
Bond Position:  [8.22443915]


portfolio before change:  [8.23646937]
curr_Stock_Price:  93.82438889837016
curr_Factors:  [9.38243889e+01 4.28534678e-02]
mat_Sqrt:  [[ 1.94226610e+01  0.00000000e+00]
 [-8.28043166e-03  1.89728524e-02]]
grads:  [ 0.01745159 -6.2914099 ]
Stock Position:  0.017451591741502383
Bond Position:  [6.59908444]


portfolio before change:  [8.221086]
curr_Stock_Price:  92.89563086374238
curr_Factors:  [9.28956309e+01 4.36354632e-02]
mat_Sqrt:  [[ 1.94050642e+01  0.00000000e+00]
 [-8.35564127e-03  1.91451793e-02]]
grads:  [ 0.00217101 -1.9732377 ]
Stock Position:  0.0021710111457409506
Bond Position:  [8.01940855]


portfolio before change:  [8.22898881]
curr_Stock_Price:  96.0740203048038
curr_Factors:  [9.60740203e+01 4.23575633e-02]
mat_Sqrt:  [[ 1.97729491e+01  0.00000000e+00]
 [-8.23238127e-03  1.88627552e-02]]
grads:  [5.24875190e-03 1.00077097e+01]
Stock Position:  0.005248751902510502
Bond Position:  [7.72472011]


portfolio before change:  [8.23166404]
curr_Stock_Price:  96.39973261905348
curr_Factors:  [9.63997326e+01 4.14619951e-02]
mat_Sqrt:  [[ 1.96291244e+01  0.00000000e+00]
 [-8.14488749e-03  1.86622817e-02]]
grads:  [4.71094481e-03 8.08776756e+00]
Stock Position:  0.004710944805408337
Bond Position:  [7.77753022]


portfolio before change:  [8.23046326]
curr_Stock_Price:  95.93845922264315
curr_Factors:  [9.59384592e+01 4.06970181e-02]
mat_Sqrt:  [[ 1.93541469e+01  0.00000000e+00]
 [-8.06940078e-03  1.84893199e-02]]
grads:  [-1.84106121e-03  3.11219291e+00]
Stock Position:  -0.0018410612145489706
Bond Position:  [8.40709184]


portfolio before change:  [8.230649]
curr_Stock_Price:  96.40841483360919
curr_Factors:  [9.64084148e+01 3.88950851e-02]
mat_Sqrt:  [[ 1.90135103e+01  0.00000000e+00]
 [-7.88873476e-03  1.80753621e-02]]
grads:  [5.80974490e-03 6.81846508e+00]
Stock Position:  0.005809744902923488
Bond Position:  [7.6705407]


portfolio before change:  [8.22188013]
curr_Stock_Price:  94.73403100665767
curr_Factors:  [9.47340310e+01 3.93334066e-02]
mat_Sqrt:  [[ 1.87882702e+01  0.00000000e+00]
 [-7.93306061e-03  1.81769254e-02]]
grads:  [5.98885978e-03 8.47205271e+00]
Stock Position:  0.00598885978282636
Bond Position:  [7.6545313]


portfolio before change:  [8.22624583]
curr_Stock_Price:  95.30322463655449
curr_Factors:  [9.53032246e+01 3.95030159e-02]
mat_Sqrt:  [[ 1.89418643e+01  0.00000000e+00]
 [-7.95014625e-03  1.82160735e-02]]
grads:  [9.40570564e-03 9.60346337e+00]
Stock Position:  0.00940570564117223
Bond Position:  [7.32985175]


portfolio before change:  [8.2141444]
curr_Stock_Price:  93.91920173602497
curr_Factors:  [9.39192017e+01 4.05279673e-02]
mat_Sqrt:  [[ 1.89073996e+01  0.00000000e+00]
 [-8.05262365e-03  1.84508787e-02]]
grads:  [-0.00633684  5.09097185]
Stock Position:  -0.0063368421011571925
Bond Position:  [8.80929556]


portfolio before change:  [8.22237562]
curr_Stock_Price:  92.79403734217011
curr_Factors:  [9.27940373e+01 3.98390240e-02]
mat_Sqrt:  [[ 1.85214258e+01  0.00000000e+00]
 [-7.98388617e-03  1.82933814e-02]]
grads:  [-0.02133173  4.25898386]
Stock Position:  -0.02133172502230417
Bond Position:  [10.20183251]


portfolio before change:  [8.21773566]
curr_Stock_Price:  93.07133682046575
curr_Factors:  [9.30713368e+01 3.98885759e-02]
mat_Sqrt:  [[ 1.85883233e+01  0.00000000e+00]
 [-7.98884982e-03  1.83047545e-02]]
grads:  [ 0.01051061 -5.56146651]
Stock Position:  0.010510613030840832
Bond Position:  [7.23949885]


portfolio before change:  [8.22462945]
curr_Stock_Price:  93.64112311953825
curr_Factors:  [9.36411231e+01 3.83948973e-02]
mat_Sqrt:  [[ 1.83486184e+01  0.00000000e+00]
 [-7.83784636e-03  1.79587621e-02]]
grads:  [-0.07434939 -8.13954769]
Stock Position:  -0.07434938563099484
Bond Position:  [15.18678943]


portfolio before change:  [8.22940311]
curr_Stock_Price:  93.60245175292673
curr_Factors:  [9.36024518e+01 3.87578829e-02]
mat_Sqrt:  [[ 1.84275351e+01  0.00000000e+00]
 [-7.87480874e-03  1.80434536e-02]]
grads:  [1.43922057e-02 1.90127695e+01]
Stock Position:  0.014392205660918428
Bond Position:  [6.88225738]


portfolio before change:  [8.22940012]
curr_Stock_Price:  93.54246575051323
curr_Factors:  [9.35424658e+01 3.76434413e-02]
mat_Sqrt:  [[ 1.81490323e+01  0.00000000e+00]
 [-7.76076711e-03  1.77821514e-02]]
grads:  [-3.46585508e-03 -7.22484306e+00]
Stock Position:  -0.0034658550814412694
Bond Position:  [8.55360475]


portfolio before change:  [8.22912184]
curr_Stock_Price:  93.93127151006625
curr_Factors:  [9.39312715e+01 3.68748462e-02]
mat_Sqrt:  [[ 1.80374571e+01  0.00000000e+00]
 [-7.68112973e-03  1.75996792e-02]]
grads:  [2.39460914e-03 4.02678266e+00]
Stock Position:  0.002394609139036296
Bond Position:  [8.00419316]


portfolio before change:  [8.23241014]
curr_Stock_Price:  94.88663146067371
curr_Factors:  [9.48866315e+01 3.55110046e-02]
mat_Sqrt:  [[ 1.78807820e+01  0.00000000e+00]
 [-7.53774551e-03  1.72711447e-02]]
grads:  [1.17452997e-03 9.46825954e+00]
Stock Position:  0.001174529965050068
Bond Position:  [8.12096295]


portfolio before change:  [8.23417688]
curr_Stock_Price:  95.52650958943094
curr_Factors:  [9.55265096e+01 3.46232783e-02]
mat_Sqrt:  [[ 1.77749342e+01  0.00000000e+00]
 [-7.44293257e-03  1.70539010e-02]]
grads:  [-0.07612354 -9.11942181]
Stock Position:  -0.07612354191413556
Bond Position:  [15.50599314]


portfolio before change:  [8.24368566]
curr_Stock_Price:  95.4270606146658
curr_Factors:  [9.54270606e+01 3.42232858e-02]
mat_Sqrt:  [[ 1.76535641e+01  0.00000000e+00]
 [-7.39981468e-03  1.69551055e-02]]
grads:  [3.18276934e-03 1.52823401e+01]
Stock Position:  0.0031827693384175308
Bond Position:  [7.93996334]


portfolio before change:  [8.24575848]
curr_Stock_Price:  95.76647156910158
curr_Factors:  [9.57664716e+01 3.32067114e-02]
mat_Sqrt:  [[ 1.74512452e+01  0.00000000e+00]
 [-7.28908350e-03  1.67013884e-02]]
grads:  [-5.05323341e-03  6.54806424e+00]
Stock Position:  -0.00505323341341992
Bond Position:  [8.72968882]


portfolio before change:  [8.24369693]
curr_Stock_Price:  96.3903955579034
curr_Factors:  [9.63903956e+01 3.16038477e-02]
mat_Sqrt:  [[ 1.71357747e+01  0.00000000e+00]
 [-7.11098842e-03  1.62933213e-02]]
grads:  [ 0.05174527 -0.0628425 ]
Stock Position:  0.051745272938574116
Bond Position:  [3.2559496]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.21005641]
Stock Price:  95.73241207672275
PL:  [8.21005641]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.06525549e-01  1.28635059e-01]
 [-1.64895088e-01 -8.62054894e-02]
 [ 8.04850147e-01 -6.76705764e-01]
 [ 3.27246733e-02  2.24185517e-02]
 [-1.28940799e-01  5.49633142e-02]
 [ 5.93490715e-02  7.81453346e-02]
 [ 1.17990443e-01 -1.78146915e-03]
 [ 4.02307959e-01 -1.24391349e-02]
 [ 8.14178531e-02  8.87745375e-02]
 [ 3.90027081e-01 -2.16818663e-01]
 [ 6.12404667e-02 -9.08850736e-03]
 [-1.32483662e-01 -1.78405824e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-4.28201054e-01 -5.58442361e-01]
 [ 7.74104670e-02  2.23238231e-01]
 [ 5.41231908e-02 -2.04827630e-02]
 [-5.25254241e-02  2.45632264e-01]
 [-5.94409635e-02  1.80641241e-02]
 [ 1.55379557e-02  4.99962658e-02]
 [ 8.69099739e-02 -9.90178924e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 4.64381574e-02  2.42667180e-01]
 [ 3.13645208e-02  1.78979810e-01]
 [-8.57400080e-02  1.05660608e-01]
 [ 3.68351631e-02  8.63269505e-02]
 [ 2.85321023e-01 -1.10576454e-02]
 [ 1.70516326e-02  2.12240754e-01]
 [-1.95695239e-01  1.41563688e-01]
 [-6.52030597e-02 -1.04361378e-01]
 [ 5.13864485e-02 -5.83340504e-02]
 [-8.91520044e-01 -1.04518838e-01]
 [-1.18200656e-01  1.02993844e-02]
 [-9.13788993e-03 -1.02720945e-01]
 [ 3.69048002e-02  8.41169021e-02]
 [-6.52056381e-02  1.60742524e-01]
 [-8.32820554e-01 -2.47619529e-01]
 [-2.21243938e-02  3.04616424e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 4.75585458e-01  4.64503936e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.82727107]
curr_Stock_Price:  99.46756179418561
curr_Factors:  [9.94675618e+01 4.10558971e-02]
mat_Sqrt:  [[ 2.01543708e+01  0.00000000e+00]
 [-8.10490193e-03  1.85706633e-02]]
grads:  [-2.49993448e-03  6.92678858e+00]
Stock Position:  -0.0024999344779280397
Bond Position:  [-0.57860868]


portfolio before change:  [-0.82666049]
curr_Stock_Price:  99.19439084505878
curr_Factors:  [9.91943908e+01 4.13158571e-02]
mat_Sqrt:  [[ 2.01625519e+01  0.00000000e+00]
 [-8.13052097e-03  1.86293639e-02]]
grads:  [-0.01004428 -4.62739843]
Stock Position:  -0.010044276592271941
Bond Position:  [0.16967541]


portfolio before change:  [-0.83504752]
curr_Stock_Price:  100.03150879104113
curr_Factors:  [1.00031509e+02 4.07233931e-02]
mat_Sqrt:  [[ 2.01863964e+01  0.00000000e+00]
 [-8.07201517e-03  1.84953103e-02]]
grads:  [ 2.52403415e-02 -3.65879649e+01]
Stock Position:  0.025240341482363197
Bond Position:  [-3.35987696]


portfolio before change:  [-0.80611448]
curr_Stock_Price:  101.19445067279295
curr_Factors:  [1.01194451e+02 4.14875876e-02]
mat_Sqrt:  [[ 2.06117938e+01  0.00000000e+00]
 [-8.14740082e-03  1.86680405e-02]]
grads:  [0.00206236 1.20090546]
Stock Position:  0.0020623596317429333
Bond Position:  [-1.01481383]


portfolio before change:  [-0.80493577]
curr_Stock_Price:  101.82749721746153
curr_Factors:  [1.01827497e+02 4.09389712e-02]
mat_Sqrt:  [[ 2.06031456e+01  0.00000000e+00]
 [-8.09335246e-03  1.85442001e-02]]
grads:  [-0.00509402  2.9639086 ]
Stock Position:  -0.005094020289020278
Bond Position:  [-0.28622444]


portfolio before change:  [-0.80767977]
curr_Stock_Price:  102.35914270853198
curr_Factors:  [1.02359143e+02 3.96321645e-02]
mat_Sqrt:  [[ 2.03774828e+01  0.00000000e+00]
 [-7.96313150e-03  1.82458264e-02]]
grads:  [0.00458616 4.2829156 ]
Stock Position:  0.004586164660114549
Bond Position:  [-1.27711565]


portfolio before change:  [-0.80200511]
curr_Stock_Price:  103.63129623652384
curr_Factors:  [1.03631296e+02 3.87821039e-02]
mat_Sqrt:  [[ 2.04082898e+01  0.00000000e+00]
 [-7.87726896e-03  1.80490906e-02]]
grads:  [ 0.0057434  -0.09870132]
Stock Position:  0.005743398750230732
Bond Position:  [-1.39720097]


portfolio before change:  [-0.80247493]
curr_Stock_Price:  103.5799049972156
curr_Factors:  [1.03579905e+02 3.91756935e-02]
mat_Sqrt:  [[ 2.05014159e+01  0.00000000e+00]
 [-7.91714025e-03  1.81404472e-02]]
grads:  [ 0.01935862 -0.68571269]
Stock Position:  0.019358617878750334
Bond Position:  [-2.80763873]


portfolio before change:  [-0.82123326]
curr_Stock_Price:  102.62904417441551
curr_Factors:  [1.02629044e+02 3.89256118e-02]
mat_Sqrt:  [[ 2.02482739e+01  0.00000000e+00]
 [-7.89182988e-03  1.80824539e-02]]
grads:  [0.00593444 4.90942977]
Stock Position:  0.005934443499450162
Bond Position:  [-1.43027952]


portfolio before change:  [-0.82261842]
curr_Stock_Price:  102.42576190184002
curr_Factors:  [1.02425762e+02 3.76202068e-02]
mat_Sqrt:  [[ 1.98664282e+01  0.00000000e+00]
 [-7.75837166e-03  1.77766627e-02]]
grads:  [  0.01486929 -12.19681479]
Stock Position:  0.014869288780229369
Bond Position:  [-2.34561666]


portfolio before change:  [-0.80774371]
curr_Stock_Price:  103.44584683536824
curr_Factors:  [1.03445847e+02 3.64118625e-02]
mat_Sqrt:  [[ 1.97394254e+01  0.00000000e+00]
 [-7.63275704e-03  1.74888434e-02]]
grads:  [ 0.0029015  -0.51967458]
Stock Position:  0.002901498689345997
Bond Position:  [-1.1078917]


portfolio before change:  [-0.80687581]
curr_Stock_Price:  103.79269926258152
curr_Factors:  [1.03792699e+02 3.58822684e-02]
mat_Sqrt:  [[ 1.96610520e+01  0.00000000e+00]
 [-7.57704622e-03  1.73611939e-02]]
grads:  [ -0.01069863 -10.27612646]
Stock Position:  -0.010698631355304765
Bond Position:  [0.30356402]


portfolio before change:  [-0.79213849]
curr_Stock_Price:  102.41875008643139
curr_Factors:  [1.02418750e+02 3.56067337e-02]
mat_Sqrt:  [[ 1.93261586e+01  0.00000000e+00]
 [-7.54789864e-03  1.72944084e-02]]
grads:  [-6.25019290e-03  9.57139686e+00]
Stock Position:  -0.006250192897813669
Bond Position:  [-0.15200154]


portfolio before change:  [-0.78144218]
curr_Stock_Price:  100.7043531494255
curr_Factors:  [1.00704353e+02 3.71076720e-02]
mat_Sqrt:  [[ 1.93990338e+01  0.00000000e+00]
 [-7.70534069e-03  1.76551535e-02]]
grads:  [ -0.03463705 -31.63055824]
Stock Position:  -0.03463704895775679
Bond Position:  [2.70665943]


portfolio before change:  [-0.77523003]
curr_Stock_Price:  100.53477192419588
curr_Factors:  [1.00534772e+02 3.73019277e-02]
mat_Sqrt:  [[ 1.94169913e+01  0.00000000e+00]
 [-7.72548279e-03  1.77013048e-02]]
grads:  [9.00446502e-03 1.26113997e+01]
Stock Position:  0.009004465020134666
Bond Position:  [-1.68049187]


portfolio before change:  [-0.77311516]
curr_Stock_Price:  100.79297131267329
curr_Factors:  [1.00792971e+02 3.58660961e-02]
mat_Sqrt:  [[ 1.90885220e+01  0.00000000e+00]
 [-7.57533852e-03  1.73572811e-02]]
grads:  [ 0.00236707 -1.18006748]
Stock Position:  0.0023670654118122434
Bond Position:  [-1.01169871]


portfolio before change:  [-0.77229972]
curr_Stock_Price:  101.19089204242854
curr_Factors:  [1.01190892e+02 3.56068911e-02]
mat_Sqrt:  [[ 1.90945071e+01  0.00000000e+00]
 [-7.54791533e-03  1.72944467e-02]]
grads:  [2.86350856e-03 1.42029559e+01]
Stock Position:  0.0028635085634586247
Bond Position:  [-1.06206071]


portfolio before change:  [-0.77714247]
curr_Stock_Price:  99.54606297763449
curr_Factors:  [9.95460630e+01 3.63890621e-02]
mat_Sqrt:  [[ 1.89893246e+01  0.00000000e+00]
 [-7.63036692e-03  1.74833670e-02]]
grads:  [-0.00271506  1.03321769]
Stock Position:  -0.0027150588229591663
Bond Position:  [-0.50686905]


portfolio before change:  [-0.7744873]
curr_Stock_Price:  98.54478288569537
curr_Factors:  [9.85447829e+01 3.69861706e-02]
mat_Sqrt:  [[ 1.89519247e+01  0.00000000e+00]
 [-7.69271558e-03  1.76262257e-02]]
grads:  [1.97120428e-03 2.83647030e+00]
Stock Position:  0.001971204280670071
Bond Position:  [-0.9687392]


portfolio before change:  [-0.77505441]
curr_Stock_Price:  98.31851985757172
curr_Factors:  [9.83185199e+01 3.71703281e-02]
mat_Sqrt:  [[ 1.89554251e+01  0.00000000e+00]
 [-7.71184316e-03  1.76700525e-02]]
grads:  [ 2.30514602e-03 -5.60371240e+00]
Stock Position:  0.0023051460190879453
Bond Position:  [-1.00169295]


portfolio before change:  [-0.77792357]
curr_Stock_Price:  97.12816519413664
curr_Factors:  [9.71281652e+01 3.72847581e-02]
mat_Sqrt:  [[ 1.87547314e+01  0.00000000e+00]
 [-7.72370461e-03  1.76972305e-02]]
grads:  [ 0.00224629 -2.13468371]
Stock Position:  0.0022462923953025056
Bond Position:  [-0.99610183]


portfolio before change:  [-0.77717658]
curr_Stock_Price:  97.51614467643022
curr_Factors:  [9.75161447e+01 3.67336320e-02]
mat_Sqrt:  [[ 1.86899637e+01  0.00000000e+00]
 [-7.66640797e-03  1.75659474e-02]]
grads:  [8.15126234e-03 1.38146366e+01]
Stock Position:  0.008151262342312868
Bond Position:  [-1.57205625]


portfolio before change:  [-0.78312376]
curr_Stock_Price:  96.81065133113644
curr_Factors:  [9.68106513e+01 3.63168887e-02]
mat_Sqrt:  [[ 1.84491966e+01  0.00000000e+00]
 [-7.62279620e-03  1.74660203e-02]]
grads:  [5.93400982e-03 1.02473149e+01]
Stock Position:  0.005934009821377144
Bond Position:  [-1.35759911]


portfolio before change:  [-0.78190216]
curr_Stock_Price:  97.04511485595903
curr_Factors:  [9.70451149e+01 3.56712268e-02]
mat_Sqrt:  [[ 1.83287438e+01  0.00000000e+00]
 [-7.55473116e-03  1.73100637e-02]]
grads:  [-2.16195603e-03  6.10399878e+00]
Stock Position:  -0.0021619560314381898
Bond Position:  [-0.57209489]


portfolio before change:  [-0.78347625]
curr_Stock_Price:  97.74012033905308
curr_Factors:  [9.77401203e+01 3.43059704e-02]
mat_Sqrt:  [[ 1.81032990e+01  0.00000000e+00]
 [-7.40874838e-03  1.69755751e-02]]
grads:  [4.11589806e-03 5.08536234e+00]
Stock Position:  0.004115898060591691
Bond Position:  [-1.18576462]


portfolio before change:  [-0.78339573]
curr_Stock_Price:  97.79569725887
curr_Factors:  [9.77956973e+01 3.49273216e-02]
mat_Sqrt:  [[ 1.82768938e+01  0.00000000e+00]
 [-7.47554109e-03  1.71286165e-02]]
grads:  [ 0.01534698 -0.64556559]
Stock Position:  0.01534697706881238
Bond Position:  [-2.28426405]


portfolio before change:  [-0.7841709]
curr_Stock_Price:  97.76379395542857
curr_Factors:  [9.77637940e+01 3.60833949e-02]
mat_Sqrt:  [[ 1.85708483e+01  0.00000000e+00]
 [-7.59825189e-03  1.74097822e-02]]
grads:  [5.90608948e-03 1.21908908e+01]
Stock Position:  0.0059060894812860846
Bond Position:  [-1.36157261]


portfolio before change:  [-0.78161232]
curr_Stock_Price:  98.22582358175451
curr_Factors:  [9.82258236e+01 3.69089685e-02]
mat_Sqrt:  [[ 1.88708574e+01  0.00000000e+00]
 [-7.68468279e-03  1.76078203e-02]]
grads:  [-7.09622133e-03  8.03981897e+00]
Stock Position:  -0.00709622133011037
Bond Position:  [-0.08458013]


portfolio before change:  [-0.78319928]
curr_Stock_Price:  98.44796908450658
curr_Factors:  [9.84479691e+01 3.77823761e-02]
mat_Sqrt:  [[ 1.91360102e+01  0.00000000e+00]
 [-7.77507567e-03  1.78149364e-02]]
grads:  [-5.78752298e-03 -5.85808309e+00]
Stock Position:  -0.005787522983669329
Bond Position:  [-0.2134294]


portfolio before change:  [-0.78519577]
curr_Stock_Price:  98.78832300788771
curr_Factors:  [9.87883230e+01 3.78885309e-02]
mat_Sqrt:  [[ 1.92291238e+01  0.00000000e+00]
 [-7.78599059e-03  1.78399456e-02]]
grads:  [ 1.34833921e-03 -3.26985584e+00]
Stock Position:  0.0013483392136520102
Bond Position:  [-0.91839594]


portfolio before change:  [-0.78680618]
curr_Stock_Price:  97.67910589779204
curr_Factors:  [9.76791059e+01 3.64304205e-02]
mat_Sqrt:  [[ 1.86437713e+01  0.00000000e+00]
 [-7.63470188e-03  1.74932996e-02]]
grads:  [-0.05026536 -5.97479266]
Stock Position:  -0.05026535608057656
Bond Position:  [4.12306886]


portfolio before change:  [-0.80280913]
curr_Stock_Price:  98.00772918242814
curr_Factors:  [9.80077292e+01 3.69080596e-02]
mat_Sqrt:  [[ 1.88287259e+01  0.00000000e+00]
 [-7.68458817e-03  1.76076035e-02]]
grads:  [-0.00603894  0.58493959]
Stock Position:  -0.006038944763605683
Bond Position:  [-0.21094586]


portfolio before change:  [-0.79569094]
curr_Stock_Price:  96.8246481988903
curr_Factors:  [9.68246482e+01 3.67964902e-02]
mat_Sqrt:  [[ 1.85733022e+01  0.00000000e+00]
 [-7.67296451e-03  1.75809703e-02]]
grads:  [-2.90572916e-03 -5.84273470e+00]
Stock Position:  -0.0029057291629350683
Bond Position:  [-0.51434473]


portfolio before change:  [-0.79173063]
curr_Stock_Price:  95.43958905129672
curr_Factors:  [9.54395891e+01 3.59735736e-02]
mat_Sqrt:  [[ 1.81017412e+01  0.00000000e+00]
 [-7.58668028e-03  1.73832683e-02]]
grads:  [4.06681463e-03 4.83895781e+00]
Stock Position:  0.004066814631802187
Bond Position:  [-1.17986574]


portfolio before change:  [-0.78865832]
curr_Stock_Price:  96.23131512754013
curr_Factors:  [9.62313151e+01 3.51841882e-02]
mat_Sqrt:  [[ 1.80505396e+01  0.00000000e+00]
 [-7.50297948e-03  1.71914857e-02]]
grads:  [2.74127586e-04 9.35012405e+00]
Stock Position:  0.000274127586008452
Bond Position:  [-0.81503797]


portfolio before change:  [-0.78839421]
curr_Stock_Price:  97.56644266171512
curr_Factors:  [9.75664427e+01 3.52730048e-02]
mat_Sqrt:  [[ 1.83240598e+01  0.00000000e+00]
 [-7.51244353e-03  1.72131706e-02]]
grads:  [ -0.05134728 -14.38546888]
Stock Position:  -0.05134727724031904
Bond Position:  [4.22137697]


portfolio before change:  [-0.78218153]
curr_Stock_Price:  97.45572652943082
curr_Factors:  [9.74557265e+01 3.55306367e-02]
mat_Sqrt:  [[ 1.83699874e+01  0.00000000e+00]
 [-7.53982882e-03  1.72759182e-02]]
grads:  [6.03272666e-03 1.76324303e+01]
Stock Position:  0.006032726662516346
Bond Position:  [-1.37010529]


portfolio before change:  [-0.77996087]
curr_Stock_Price:  97.85221880188442
curr_Factors:  [9.78522188e+01 3.43480857e-02]
mat_Sqrt:  [[ 1.81351832e+01  0.00000000e+00]
 [-7.41329462e-03  1.69859919e-02]]
grads:  [-4.86265920e-03  6.43835022e+00]
Stock Position:  -0.004862659202594087
Bond Position:  [-0.30413888]


portfolio before change:  [-0.78711732]
curr_Stock_Price:  99.31611465471394
curr_Factors:  [9.93161147e+01 3.44196624e-02]
mat_Sqrt:  [[ 1.84256588e+01  0.00000000e+00]
 [-7.42101475e-03  1.70036809e-02]]
grads:  [0.02691128 2.7317846 ]
Stock Position:  0.026911280478676792
Bond Position:  [-3.45984114]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.78395068]
Stock Price:  99.44985603657271
PL:  [-0.78395068]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.28265943e-01 -1.35968895e-02]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.57386339e-01 -7.84918618e-01]
 [-4.72410549e-02  7.47599832e-02]
 [ 3.18992863e-02 -5.92012861e-02]
 [-7.71888256e-02 -8.94407926e-02]
 [-8.99384492e-02  1.39903051e-01]
 [-1.02731272e-01 -1.02219355e-01]
 [ 1.61975945e-01  7.83628099e-02]
 [ 2.94794654e-01 -1.32493677e-01]
 [ 7.04773319e-02  2.28048325e-02]
 [-1.17312302e-01 -1.87470020e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-5.24767446e-01 -6.71844317e-01]
 [ 5.68739240e-02  1.34155087e-01]
 [ 5.14240768e-02 -6.72312193e-02]
 [-5.32152939e-02  2.84412081e-01]
 [ 2.00301853e-02  1.38686265e-01]
 [ 1.46577303e-02  7.18523952e-02]
 [-1.04622653e-01 -3.28899193e-02]
 [ 2.31627298e-01  2.52803609e-01]
 [ 3.03843381e-02  1.89894963e-02]
 [-9.50172562e-03  4.22863588e-02]
 [ 1.13859603e-01  1.96347366e-01]
 [ 7.52861014e-02  1.57584963e-01]
 [ 8.01399685e-01 -6.90029442e-01]
 [-3.74953326e-01  4.80818748e-01]
 [ 1.51307054e-01 -6.77898342e-03]
 [-4.48657121e-02 -6.53554613e-02]
 [-9.89343925e-03 -1.53503653e-01]
 [-1.62273299e-02 -7.28029160e-02]
 [ 1.16619168e-01 -1.23790165e-02]
 [ 2.53047668e-01  3.08797257e-01]
 [ 2.31948893e-01  2.49233733e-02]
 [-2.09096595e-01 -2.33970249e-01]
 [ 1.77532752e-01 -9.19465178e-02]
 [-2.25846939e-01  1.66731183e-01]
 [-1.16613802e-01  1.22382480e-01]
 [-2.73060466e-01  1.66900301e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.487344]
curr_Stock_Price:  99.06691175665584
curr_Factors:  [9.90669118e+01 4.12640359e-02]
mat_Sqrt:  [[ 2.01240078e+01  0.00000000e+00]
 [-8.12542045e-03  1.86176771e-02]]
grads:  [-0.01163785 -0.73032148]
Stock Position:  -0.011637846455042252
Bond Position:  [-2.33441849]


portfolio before change:  [-3.49303799]
curr_Stock_Price:  99.53110169700992
curr_Factors:  [9.95311017e+01 4.05595584e-02]
mat_Sqrt:  [[ 2.00449704e+01  0.00000000e+00]
 [-8.05576151e-03  1.84580684e-02]]
grads:  [-0.01012645 -4.76817877]
Stock Position:  -0.01012645284473573
Bond Position:  [-2.48514098]


portfolio before change:  [-3.48004814]
curr_Stock_Price:  98.21765898338448
curr_Factors:  [9.82176590e+01 4.02094643e-02]
mat_Sqrt:  [[ 1.96948974e+01  0.00000000e+00]
 [-8.02091907e-03  1.83782344e-02]]
grads:  [ 2.61397538e-02 -4.27091417e+01]
Stock Position:  0.02613975384436714
Bond Position:  [-6.04743357]


portfolio before change:  [-3.45325397]
curr_Stock_Price:  99.27161484781449
curr_Factors:  [9.92716148e+01 3.84687390e-02]
mat_Sqrt:  [[ 1.94705878e+01  0.00000000e+00]
 [-7.84537968e-03  1.79760231e-02]]
grads:  [-7.50522968e-04  4.15887222e+00]
Stock Position:  -0.0007505229677026589
Bond Position:  [-3.37874834]


portfolio before change:  [-3.45260239]
curr_Stock_Price:  97.84067983250048
curr_Factors:  [9.78406798e+01 4.00578775e-02]
mat_Sqrt:  [[ 1.95822878e+01  0.00000000e+00]
 [-8.00578566e-03  1.83435594e-02]]
grads:  [ 3.09551513e-04 -3.22736089e+00]
Stock Position:  0.00030955151337887086
Bond Position:  [-3.48288912]


portfolio before change:  [-3.45345265]
curr_Stock_Price:  96.50042269128086
curr_Factors:  [9.65004227e+01 4.07224378e-02]
mat_Sqrt:  [[ 1.94735935e+01  0.00000000e+00]
 [-8.07192049e-03  1.84950933e-02]]
grads:  [-0.00596829 -4.83592004]
Stock Position:  -0.0059682866339372705
Bond Position:  [-2.87751047]


portfolio before change:  [-3.46047454]
curr_Stock_Price:  97.61668612148577
curr_Factors:  [9.76166861e+01 4.27353566e-02]
mat_Sqrt:  [[ 2.01798404e+01  0.00000000e+00]
 [-8.26901268e-03  1.89466883e-02]]
grads:  [-1.43111895e-03  7.38403720e+00]
Stock Position:  -0.0014311189484281916
Bond Position:  [-3.32077346]


portfolio before change:  [-3.46135326]
curr_Stock_Price:  97.9406265614151
curr_Factors:  [9.79406266e+01 4.43555264e-02]
mat_Sqrt:  [[ 2.06270322e+01  0.00000000e+00]
 [-8.42430070e-03  1.93024978e-02]]
grads:  [-0.00714322 -5.29565427]
Stock Position:  -0.00714322130008252
Bond Position:  [-2.76174169]


portfolio before change:  [-3.47015441]
curr_Stock_Price:  99.12439332625
curr_Factors:  [9.91243933e+01 4.29414217e-02]
mat_Sqrt:  [[ 2.05408661e+01  0.00000000e+00]
 [-8.28892482e-03  1.89923127e-02]]
grads:  [0.00955054 4.12602778]
Stock Position:  0.00955053591009176
Bond Position:  [-4.41684549]


portfolio before change:  [-3.45740553]
curr_Stock_Price:  100.51709242223603
curr_Factors:  [1.00517092e+02 4.33250904e-02]
mat_Sqrt:  [[ 2.09223111e+01  0.00000000e+00]
 [-8.32587200e-03  1.90769693e-02]]
grads:  [ 0.01132617 -6.94521625]
Stock Position:  0.011326170924617584
Bond Position:  [-4.5958793]


portfolio before change:  [-3.45474357]
curr_Stock_Price:  100.80284456033176
curr_Factors:  [1.00802845e+02 4.36887725e-02]
mat_Sqrt:  [[ 2.10696688e+01  0.00000000e+00]
 [-8.36074374e-03  1.91568705e-02]]
grads:  [0.00381734 1.19042578]
Stock Position:  0.0038173441430293803
Bond Position:  [-3.83954272]


portfolio before change:  [-3.44887949]
curr_Stock_Price:  102.46474770213936
curr_Factors:  [1.02464748e+02 4.29440192e-02]
mat_Sqrt:  [[ 2.12337069e+01  0.00000000e+00]
 [-8.28917552e-03  1.89928871e-02]]
grads:  [-9.37805760e-03 -9.87053831e+00]
Stock Position:  -0.009378057602344336
Bond Position:  [-2.48795918]


portfolio before change:  [-3.44798569]
curr_Stock_Price:  102.33627631072393
curr_Factors:  [1.02336276e+02 4.22659793e-02]
mat_Sqrt:  [[ 2.10389993e+01  0.00000000e+00]
 [-8.22347657e-03  1.88423519e-02]]
grads:  [-5.74134815e-03  8.78508412e+00]
Stock Position:  -0.00574134814580749
Bond Position:  [-2.8604375]


portfolio before change:  [-3.44557076]
curr_Stock_Price:  101.85337436685926
curr_Factors:  [1.01853374e+02 4.44848830e-02]
mat_Sqrt:  [[ 2.14823431e+01  0.00000000e+00]
 [-8.43657589e-03  1.93306238e-02]]
grads:  [ -0.03807705 -34.75543902]
Stock Position:  -0.03807705436151576
Bond Position:  [0.43270571]


portfolio before change:  [-3.46291138]
curr_Stock_Price:  102.31020366019486
curr_Factors:  [1.02310204e+02 4.49902435e-02]
mat_Sqrt:  [[ 2.17009188e+01  0.00000000e+00]
 [-8.48436147e-03  1.94401143e-02]]
grads:  [5.31885333e-03 6.90094125e+00]
Stock Position:  0.005318853332960788
Bond Position:  [-4.00708435]


portfolio before change:  [-3.45847515]
curr_Stock_Price:  103.2384400561559
curr_Factors:  [1.03238440e+02 4.38628937e-02]
mat_Sqrt:  [[ 2.16217118e+01  0.00000000e+00]
 [-8.37738802e-03  1.91950074e-02]]
grads:  [ 1.02128672e-03 -3.50253678e+00]
Stock Position:  0.0010212867207258379
Bond Position:  [-3.56391119]


portfolio before change:  [-3.45909732]
curr_Stock_Price:  103.06546224388092
curr_Factors:  [1.03065462e+02 4.42070791e-02]
mat_Sqrt:  [[ 2.16700077e+01  0.00000000e+00]
 [-8.41019182e-03  1.92701703e-02]]
grads:  [3.27237145e-03 1.47591887e+01]
Stock Position:  0.003272371447692156
Bond Position:  [-3.7963658]


portfolio before change:  [-3.45676614]
curr_Stock_Price:  103.92287163865402
curr_Factors:  [1.03922872e+02 4.28397466e-02]
mat_Sqrt:  [[ 2.15097115e+01  0.00000000e+00]
 [-8.27910590e-03  1.89698147e-02]]
grads:  [3.74518429e-03 7.31089190e+00]
Stock Position:  0.003745184287892397
Bond Position:  [-3.84597644]


portfolio before change:  [-3.4558561]
curr_Stock_Price:  104.29423081390986
curr_Factors:  [1.04294231e+02 4.28329456e-02]
mat_Sqrt:  [[ 2.15848610e+01  0.00000000e+00]
 [-8.27844871e-03  1.89683089e-02]]
grads:  [2.13189636e-03 3.78802325e+00]
Stock Position:  0.002131896355041813
Bond Position:  [-3.6782006]


portfolio before change:  [-3.45625457]
curr_Stock_Price:  104.32300348972366
curr_Factors:  [1.04323003e+02 4.42322092e-02]
mat_Sqrt:  [[ 2.19406453e+01  0.00000000e+00]
 [-8.41258193e-03  1.92756467e-02]]
grads:  [-0.00542268 -1.70629394]
Stock Position:  -0.005422675057452759
Bond Position:  [-2.89054482]


portfolio before change:  [-3.45350636]
curr_Stock_Price:  103.74956881320571
curr_Factors:  [1.03749569e+02 4.49365417e-02]
mat_Sqrt:  [[ 2.19930835e+01  0.00000000e+00]
 [-8.47929636e-03  1.94285087e-02]]
grads:  [ 0.01554852 13.01199245]
Stock Position:  0.015548517220529981
Bond Position:  [-5.06665832]


portfolio before change:  [-3.45848938]
curr_Stock_Price:  103.4698222115816
curr_Factors:  [1.03469822e+02 4.48121490e-02]
mat_Sqrt:  [[ 2.19034027e+01  0.00000000e+00]
 [-8.46755209e-03  1.94015992e-02]]
grads:  [0.00176557 0.97875933]
Stock Position:  0.0017655719613550536
Bond Position:  [-3.64117279]


portfolio before change:  [-3.45767432]
curr_Stock_Price:  104.18926746960453
curr_Factors:  [1.04189267e+02 4.42201239e-02]
mat_Sqrt:  [[ 2.19095250e+01  0.00000000e+00]
 [-8.41143259e-03  1.92730133e-02]]
grads:  [4.08660361e-04 2.19407096e+00]
Stock Position:  0.0004086603606825003
Bond Position:  [-3.50025234]


portfolio before change:  [-3.45749159]
curr_Stock_Price:  105.7071245057279
curr_Factors:  [1.05707125e+02 4.37828992e-02]
mat_Sqrt:  [[ 2.21185431e+01  0.00000000e+00]
 [-8.36974544e-03  1.91774960e-02]]
grads:  [9.02196039e-03 1.02384256e+01]
Stock Position:  0.009021960385320514
Bond Position:  [-4.41117708]


portfolio before change:  [-3.45702419]
curr_Stock_Price:  105.82005209157725
curr_Factors:  [1.05820052e+02 4.50478101e-02]
mat_Sqrt:  [[ 2.24597446e+01  0.00000000e+00]
 [-8.48978775e-03  1.94525475e-02]]
grads:  [6.41422333e-03 8.10099360e+00]
Stock Position:  0.006414223333951054
Bond Position:  [-4.13577764]


portfolio before change:  [-3.45478813]
curr_Stock_Price:  106.24926458382782
curr_Factors:  [1.06249265e+02 4.49905699e-02]
mat_Sqrt:  [[ 2.25365109e+01  0.00000000e+00]
 [-8.48439225e-03  1.94401849e-02]]
grads:  [ 2.21971426e-02 -3.54950041e+01]
Stock Position:  0.02219714261776496
Bond Position:  [-5.81321821]


portfolio before change:  [-3.49710652]
curr_Stock_Price:  104.375523994655
curr_Factors:  [1.04375524e+02 4.43258556e-02]
mat_Sqrt:  [[ 2.19749164e+01  0.00000000e+00]
 [-8.42148259e-03  1.92960407e-02]]
grads:  [-7.51342198e-03  2.49180003e+01]
Stock Position:  -0.007513421984997277
Bond Position:  [-2.71288916]


portfolio before change:  [-3.49361085]
curr_Stock_Price:  103.8651307806223
curr_Factors:  [1.03865131e+02 4.74873534e-02]
mat_Sqrt:  [[ 2.26338668e+01  0.00000000e+00]
 [-8.71663728e-03  1.99723251e-02]]
grads:  [ 0.00655427 -0.33941884]
Stock Position:  0.006554269496073189
Bond Position:  [-4.17437091]


portfolio before change:  [-3.4951367]
curr_Stock_Price:  103.71194446491667
curr_Factors:  [1.03711944e+02 4.70138977e-02]
mat_Sqrt:  [[ 2.24875378e+01  0.00000000e+00]
 [-8.67307537e-03  1.98725122e-02]]
grads:  [-3.26354866e-03 -3.28873676e+00]
Stock Position:  -0.0032635486631463926
Bond Position:  [-3.15666773]


portfolio before change:  [-3.49713751]
curr_Stock_Price:  104.20410910265485
curr_Factors:  [1.04204109e+02 4.72221743e-02]
mat_Sqrt:  [[ 2.26442445e+01  0.00000000e+00]
 [-8.69226546e-03  1.99164822e-02]]
grads:  [-3.39547323e-03 -7.70736776e+00]
Stock Position:  -0.0033954732285501675
Bond Position:  [-3.14331525]


portfolio before change:  [-3.50090347]
curr_Stock_Price:  105.19749465005508
curr_Factors:  [1.05197495e+02 4.57026512e-02]
mat_Sqrt:  [[ 2.24893081e+01  0.00000000e+00]
 [-8.55127136e-03  1.95934241e-02]]
grads:  [-2.13439770e-03 -3.71568111e+00]
Stock Position:  -0.0021343976974403478
Bond Position:  [-3.27637018]


portfolio before change:  [-3.50355119]
curr_Stock_Price:  106.24610378957667
curr_Factors:  [1.06246104e+02 4.75488729e-02]
mat_Sqrt:  [[ 2.31677110e+01  0.00000000e+00]
 [-8.72228162e-03  1.99852579e-02]]
grads:  [ 0.0048005  -0.61940739]
Stock Position:  0.004800496805616847
Bond Position:  [-4.01358527]


portfolio before change:  [-3.50111505]
curr_Stock_Price:  106.85809567086861
curr_Factors:  [1.06858096e+02 4.62038461e-02]
mat_Sqrt:  [[ 2.29692331e+01  0.00000000e+00]
 [-8.59803197e-03  1.97005662e-02]]
grads:  [ 0.01688423 15.67453717]
Stock Position:  0.01688423111090564
Bond Position:  [-5.30533184]


portfolio before change:  [-3.51913817]
curr_Stock_Price:  105.82992288761544
curr_Factors:  [1.05829923e+02 4.69220159e-02]
mat_Sqrt:  [[ 2.29243384e+01  0.00000000e+00]
 [-8.66459609e-03  1.98530837e-02]]
grads:  [0.01059251 1.25539053]
Stock Position:  0.010592512652326464
Bond Position:  [-4.64014296]


portfolio before change:  [-3.52667871]
curr_Stock_Price:  105.17280913085185
curr_Factors:  [1.05172809e+02 4.45100937e-02]
mat_Sqrt:  [[ 2.21887444e+01  0.00000000e+00]
 [-8.43896616e-03  1.93361006e-02]]
grads:  [ -0.01402556 -12.10017745]
Stock Position:  -0.014025560751481954
Bond Position:  [-2.05157108]


portfolio before change:  [-3.54668751]
curr_Stock_Price:  106.58111955558707
curr_Factors:  [1.06581120e+02 4.47406933e-02]
mat_Sqrt:  [[ 2.25440341e+01  0.00000000e+00]
 [-8.46079839e-03  1.93861245e-02]]
grads:  [ 0.00609492 -4.7429035 ]
Stock Position:  0.006094916334297817
Bond Position:  [-4.19629052]


portfolio before change:  [-3.5410641]
curr_Stock_Price:  107.58982667619921
curr_Factors:  [1.07589827e+02 4.52719839e-02]
mat_Sqrt:  [[ 2.28921178e+01  0.00000000e+00]
 [-8.51088563e-03  1.95008888e-02]]
grads:  [-6.68699534e-03  8.54992737e+00]
Stock Position:  -0.006686995337496438
Bond Position:  [-2.82161143]


portfolio before change:  [-3.53675858]
curr_Stock_Price:  106.89321438164028
curr_Factors:  [1.06893214e+02 4.60148762e-02]
mat_Sqrt:  [[ 2.29297472e+01  0.00000000e+00]
 [-8.58043134e-03  1.96602380e-02]]
grads:  [-2.75631949e-03  6.22487273e+00]
Stock Position:  -0.0027563194941164363
Bond Position:  [-3.24212673]


portfolio before change:  [-3.54355426]
curr_Stock_Price:  109.21166619351715
curr_Factors:  [1.09211666e+02 4.43896595e-02]
mat_Sqrt:  [[ 2.30096462e+01  0.00000000e+00]
 [-8.42754147e-03  1.93099234e-02]]
grads:  [-0.00870153  8.64323997]
Stock Position:  -0.00870153334008109
Bond Position:  [-2.59324531]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.52910811]
Stock Price:  107.51422670107074
PL:  [-11.04333481]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.08380735e-01  9.37058633e-03]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.57506681e-01 -6.40968548e-01]
 [-1.07434212e-02  2.50439105e-02]
 [-1.36407362e-01  5.79515065e-02]
 [ 7.70699623e-02  9.20103574e-02]
 [ 8.06444493e-02  7.42985685e-02]
 [ 3.52631414e-01 -8.23959415e-03]
 [ 2.69964157e-02  6.70220112e-02]
 [ 5.08501153e-01 -3.62456244e-01]
 [ 5.96905068e-02 -1.44402579e-02]
 [-4.78015030e-01 -2.37755276e-01]
 [-1.16661199e-01  1.23965877e-01]
 [-7.12398528e-01 -9.93687186e-01]
 [-4.95881645e-02 -3.39853092e-01]
 [ 1.60663649e-03 -1.70244607e-01]
 [-5.12607976e-02  1.74543512e-01]
 [ 1.34357526e-01  1.57164850e-01]
 [ 1.58683559e-02  4.17923795e-02]
 [-1.10108139e-01 -2.72512154e-02]
 [ 2.31587178e-01  2.52024089e-01]
 [ 4.04897072e-02  1.08195997e-02]
 [-8.90722622e-03  9.36946812e-02]
 [ 4.88663884e-02  1.73721294e-01]
 [ 4.26076746e-02  9.38115347e-02]
 [ 7.14702110e-01 -3.09289139e-01]
 [-4.92230907e-02  9.19437527e-02]
 [-1.12549399e-01  1.04664352e-01]
 [ 3.49166031e-02 -1.57566544e-01]
 [ 3.54701078e-02 -5.46142900e-02]
 [-8.19105145e-01 -9.89573590e-02]
 [-1.18188507e-01  9.82776921e-03]
 [ 7.23534829e-03 -9.15591758e-02]
 [ 1.00586056e-01  9.23183066e-02]
 [-2.79344809e-01 -1.38502721e-01]
 [-4.83648243e-01 -3.20456528e-01]
 [-5.77920098e-02  3.02067156e-01]
 [-1.23705253e-01  1.17598442e-01]
 [ 5.12486887e-01  4.26357164e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.05407996]
curr_Stock_Price:  99.13216833327596
curr_Factors:  [9.91321683e+01 4.04458673e-02]
mat_Sqrt:  [[ 1.99366269e+01  0.00000000e+00]
 [-8.04446317e-03  1.84321807e-02]]
grads:  [-0.01024702  0.50838186]
Stock Position:  -0.010247023038755044
Bond Position:  [-2.03827035]


portfolio before change:  [-3.05962003]
curr_Stock_Price:  99.64795452960713
curr_Factors:  [9.96479545e+01 3.96270995e-02]
mat_Sqrt:  [[ 1.98364764e+01  0.00000000e+00]
 [-7.96262263e-03  1.82446605e-02]]
grads:  [-0.01023289 -4.82395221]
Stock Position:  -0.010232888311541363
Bond Position:  [-2.03993364]


portfolio before change:  [-3.07320271]
curr_Stock_Price:  100.95038955542014
curr_Factors:  [1.00950390e+02 3.88866513e-02]
mat_Sqrt:  [[ 1.99071126e+01  0.00000000e+00]
 [-7.88787944e-03  1.80734023e-02]]
grads:  [ 2.39997172e-02 -3.54647419e+01]
Stock Position:  0.023999717244633584
Bond Position:  [-5.49598352]


portfolio before change:  [-3.08963643]
curr_Stock_Price:  100.29427032562516
curr_Factors:  [1.00294270e+02 3.91787884e-02]
mat_Sqrt:  [[ 1.98518792e+01  0.00000000e+00]
 [-7.91745296e-03  1.81411637e-02]]
grads:  [9.40149810e-06 1.38050187e+00]
Stock Position:  9.401498098998328e-06
Bond Position:  [-3.09057935]


portfolio before change:  [-3.09000608]
curr_Stock_Price:  102.06993860543542
curr_Factors:  [1.02069939e+02 3.96693202e-02]
mat_Sqrt:  [[ 2.03294314e+01  0.00000000e+00]
 [-7.96686339e-03  1.82543773e-02]]
grads:  [-0.00546573  3.17466357]
Stock Position:  -0.005465733346117928
Bond Position:  [-2.53211902]


portfolio before change:  [-3.0927721]
curr_Stock_Price:  102.5180917046786
curr_Factors:  [1.02518092e+02 3.91570420e-02]
mat_Sqrt:  [[ 2.02864218e+01  0.00000000e+00]
 [-7.91525535e-03  1.81361284e-02]]
grads:  [0.00577857 5.0733186 ]
Stock Position:  0.005778573244077347
Bond Position:  [-3.6851804]


portfolio before change:  [-3.0884616]
curr_Stock_Price:  103.34375875982788
curr_Factors:  [1.03343759e+02 4.00012268e-02]
mat_Sqrt:  [[ 2.06690687e+01  0.00000000e+00]
 [-8.00012268e-03  1.83305839e-02]]
grads:  [0.00547054 4.05325706]
Stock Position:  0.005470541739478667
Bond Position:  [-3.65380795]


portfolio before change:  [-3.09092123]
curr_Stock_Price:  102.97763805651445
curr_Factors:  [1.02977638e+02 4.05107571e-02]
mat_Sqrt:  [[ 2.07266019e+01  0.00000000e+00]
 [-8.05091370e-03  1.84469607e-02]]
grads:  [ 0.01683997 -0.44666405]
Stock Position:  0.01683997028679029
Bond Position:  [-4.8250616]


portfolio before change:  [-3.08857776]
curr_Stock_Price:  103.15261706141325
curr_Factors:  [1.03152617e+02 4.04424776e-02]
mat_Sqrt:  [[ 2.07443164e+01  0.00000000e+00]
 [-8.04412607e-03  1.84314083e-02]]
grads:  [2.71145206e-03 3.63629355e+00]
Stock Position:  0.0027114520623540877
Bond Position:  [-3.36827114]


portfolio before change:  [-3.08676043]
curr_Stock_Price:  103.97814971864157
curr_Factors:  [1.03978150e+02 4.07686897e-02]
mat_Sqrt:  [[ 2.09944964e+01  0.00000000e+00]
 [-8.07650317e-03  1.85055936e-02]]
grads:  [ 1.66859101e-02 -1.95863074e+01]
Stock Position:  0.016685910055934748
Bond Position:  [-4.82173049]


portfolio before change:  [-3.08147923]
curr_Stock_Price:  104.3307798075771
curr_Factors:  [1.04330780e+02 4.08498409e-02]
mat_Sqrt:  [[ 2.10866524e+01  0.00000000e+00]
 [-8.08453743e-03  1.85240024e-02]]
grads:  [ 0.00253185 -0.77954308]
Stock Position:  0.0025318509863155375
Bond Position:  [-3.34562922]


portfolio before change:  [-3.07714133]
curr_Stock_Price:  106.20929972553895
curr_Factors:  [1.06209300e+02 3.83749614e-02]
mat_Sqrt:  [[ 2.08059007e+01  0.00000000e+00]
 [-7.83581127e-03  1.79540991e-02]]
grads:  [ -0.02796226 -13.24239517]
Stock Position:  -0.027962256888216443
Bond Position:  [-0.10728961]


portfolio before change:  [-3.05248887]
curr_Stock_Price:  105.3271868508363
curr_Factors:  [1.05327187e+02 3.75557225e-02]
mat_Sqrt:  [[ 2.04116703e+01  0.00000000e+00]
 [-7.75171955e-03  1.77614208e-02]]
grads:  [-3.06481801e-03  6.97950229e+00]
Stock Position:  -0.0030648180060663392
Bond Position:  [-2.72968022]


portfolio before change:  [-3.05012768]
curr_Stock_Price:  104.44543034368371
curr_Factors:  [1.04445430e+02 3.94627498e-02]
mat_Sqrt:  [[ 2.07483285e+01  0.00000000e+00]
 [-7.94609336e-03  1.82067871e-02]]
grads:  [ -0.05523718 -54.57784385]
Stock Position:  -0.0552371806875693
Bond Position:  [2.71914343]


portfolio before change:  [-3.0751464]
curr_Stock_Price:  104.90451657870179
curr_Factors:  [1.04904517e+02 3.99013217e-02]
mat_Sqrt:  [[ 2.09550078e+01  0.00000000e+00]
 [-7.99012607e-03  1.83076788e-02]]
grads:  [-9.44462611e-03 -1.85634179e+01]
Stock Position:  -0.009444626108863473
Bond Position:  [-2.08436246]


portfolio before change:  [-3.07542158]
curr_Stock_Price:  104.90606512993281
curr_Factors:  [1.04906065e+02 3.92787381e-02]
mat_Sqrt:  [[ 2.07911907e+01  0.00000000e+00]
 [-7.92754571e-03  1.81642891e-02]]
grads:  [-3.49639434e-03 -9.37248937e+00]
Stock Position:  -0.0034963943438000907
Bond Position:  [-2.70862861]


portfolio before change:  [-3.07675092]
curr_Stock_Price:  105.1894250398365
curr_Factors:  [1.05189425e+02 3.80124750e-02]
mat_Sqrt:  [[ 2.05085594e+01  0.00000000e+00]
 [-7.79871528e-03  1.78691015e-02]]
grads:  [1.21491889e-03 9.76789524e+00]
Stock Position:  0.001214918890368834
Bond Position:  [-3.20454754]


portfolio before change:  [-3.07455349]
curr_Stock_Price:  107.32786376172218
curr_Factors:  [1.07327864e+02 3.87268751e-02]
mat_Sqrt:  [[ 2.11212060e+01  0.00000000e+00]
 [-7.87165803e-03  1.80362344e-02]]
grads:  [0.00960882 8.71383939]
Stock Position:  0.009608821097766963
Bond Position:  [-4.10584773]


portfolio before change:  [-3.09030687]
curr_Stock_Price:  105.74180892610292
curr_Factors:  [1.05741809e+02 3.77177735e-02]
mat_Sqrt:  [[ 2.05361846e+01  0.00000000e+00]
 [-7.76842568e-03  1.77996994e-02]]
grads:  [1.66087549e-03 2.34792614e+00]
Stock Position:  0.001660875489167562
Bond Position:  [-3.26593085]


portfolio before change:  [-3.09074408]
curr_Stock_Price:  105.72438143141395
curr_Factors:  [1.05724381e+02 3.60314356e-02]
mat_Sqrt:  [[ 2.00685473e+01  0.00000000e+00]
 [-7.59277927e-03  1.73972429e-02]]
grads:  [-0.00607924 -1.56641001]
Stock Position:  -0.0060792414617762466
Bond Position:  [-2.44802004]


portfolio before change:  [-3.07900339]
curr_Stock_Price:  103.74276718846383
curr_Factors:  [1.03742767e+02 3.54863496e-02]
mat_Sqrt:  [[ 1.95428767e+01  0.00000000e+00]
 [-7.53512836e-03  1.72651480e-02]]
grads:  [ 0.01747847 14.59727355]
Stock Position:  0.017478466134219644
Bond Position:  [-4.89226783]


portfolio before change:  [-3.07742763]
curr_Stock_Price:  103.86791122219888
curr_Factors:  [1.03867911e+02 3.54520969e-02]
mat_Sqrt:  [[ 1.95570057e+01  0.00000000e+00]
 [-7.53149089e-03  1.72568135e-02]]
grads:  [0.00231179 0.62697552]
Stock Position:  0.0023117939616448422
Bond Position:  [-3.31754884]


portfolio before change:  [-3.07789067]
curr_Stock_Price:  103.84701028037655
curr_Factors:  [1.0384701e+02 3.4944515e-02]
mat_Sqrt:  [[ 1.94125911e+01  0.00000000e+00]
 [-7.47738082e-03  1.71328318e-02]]
grads:  [1.64761546e-03 5.46872124e+00]
Stock Position:  0.001647615455334902
Bond Position:  [-3.24899061]


portfolio before change:  [-3.08005656]
curr_Stock_Price:  102.77895989026977
curr_Factors:  [1.02778960e+02 3.42876369e-02]
mat_Sqrt:  [[ 1.90314990e+01  0.00000000e+00]
 [-7.40676846e-03  1.69710386e-02]]
grads:  [6.55148485e-03 1.02363384e+01]
Stock Position:  0.006551484845394832
Bond Position:  [-3.75341136]


portfolio before change:  [-3.07868231]
curr_Stock_Price:  103.06033998777005
curr_Factors:  [1.03060340e+02 3.57706561e-02]
mat_Sqrt:  [[ 1.94919381e+01  0.00000000e+00]
 [-7.56525278e-03  1.73341718e-02]]
grads:  [4.28640726e-03 5.41194214e+00]
Stock Position:  0.004286407260470442
Bond Position:  [-3.5204409]


portfolio before change:  [-3.08416986]
curr_Stock_Price:  101.88278628490826
curr_Factors:  [1.01882786e+02 3.76559355e-02]
mat_Sqrt:  [[ 1.97704946e+01  0.00000000e+00]
 [-7.76205493e-03  1.77851021e-02]]
grads:  [  0.02932235 -17.39034931]
Stock Position:  0.029322345009683514
Bond Position:  [-6.07161207]


portfolio before change:  [-3.10752804]
curr_Stock_Price:  101.11207090839939
curr_Factors:  [1.01112071e+02 3.75681217e-02]
mat_Sqrt:  [[ 1.95980448e+01  0.00000000e+00]
 [-7.75299907e-03  1.77643526e-02]]
grads:  [-4.64104832e-04  5.17574465e+00]
Stock Position:  -0.0004641048321374334
Bond Position:  [-3.06060144]


portfolio before change:  [-3.10752121]
curr_Stock_Price:  100.27295773099073
curr_Factors:  [1.00272958e+02 3.70104797e-02]
mat_Sqrt:  [[ 1.92906198e+01  0.00000000e+00]
 [-7.69524318e-03  1.76320172e-02]]
grads:  [-3.46645835e-03  5.93603961e+00]
Stock Position:  -0.0034664583515193925
Bond Position:  [-2.75992918]


portfolio before change:  [-3.10751353]
curr_Stock_Price:  100.17121269621869
curr_Factors:  [1.00171213e+02 3.70899333e-02]
mat_Sqrt:  [[ 1.92917203e+01  0.00000000e+00]
 [-7.70349877e-03  1.76509331e-02]]
grads:  [-1.75469445e-03 -8.92681103e+00]
Stock Position:  -0.001754694452449857
Bond Position:  [-2.93174365]


portfolio before change:  [-3.10620483]
curr_Stock_Price:  99.21652215064653
curr_Factors:  [9.92165222e+01 3.77515890e-02]
mat_Sqrt:  [[ 1.92775402e+01  0.00000000e+00]
 [-7.77190725e-03  1.78076766e-02]]
grads:  [ 6.03525002e-04 -3.06689587e+00]
Stock Position:  0.0006035250021698123
Bond Position:  [-3.16608448]


portfolio before change:  [-3.10709702]
curr_Stock_Price:  98.39401237899881
curr_Factors:  [9.83940124e+01 3.79176517e-02]
mat_Sqrt:  [[ 1.91597301e+01  0.00000000e+00]
 [-7.78898213e-03  1.78468001e-02]]
grads:  [-0.04500552 -5.54482363]
Stock Position:  -0.04500552315117994
Bond Position:  [1.32117699]


portfolio before change:  [-3.0977885]
curr_Stock_Price:  98.19085159110692
curr_Factors:  [9.81908516e+01 3.76715749e-02]
mat_Sqrt:  [[ 1.90580260e+01  0.00000000e+00]
 [-7.76366665e-03  1.77887951e-02]]
grads:  [-0.00597645  0.55246964]
Stock Position:  -0.005976448803472842
Bond Position:  [-2.5109559]


portfolio before change:  [-3.10069882]
curr_Stock_Price:  98.62529506451243
curr_Factors:  [9.86252951e+01 3.49325717e-02]
mat_Sqrt:  [[ 1.84333214e+01  0.00000000e+00]
 [-7.47610291e-03  1.71299037e-02]]
grads:  [-1.77528246e-03 -5.34499068e+00]
Stock Position:  -0.0017752824578846926
Bond Position:  [-2.92561106]


portfolio before change:  [-3.10300422]
curr_Stock_Price:  99.7178973437524
curr_Factors:  [9.97178973e+01 3.39770879e-02]
mat_Sqrt:  [[ 1.83808753e+01  0.00000000e+00]
 [-7.37314998e-03  1.68940089e-02]]
grads:  [0.00766433 5.46455888]
Stock Position:  0.0076643285949342735
Bond Position:  [-3.86727495]


portfolio before change:  [-3.09617894]
curr_Stock_Price:  100.67149899773514
curr_Factors:  [1.00671499e+02 3.31473010e-02]
mat_Sqrt:  [[ 1.83286561e+01  0.00000000e+00]
 [-7.28256010e-03  1.66864415e-02]]
grads:  [-0.01853886 -8.30031506]
Stock Position:  -0.01853885803038887
Bond Position:  [-1.22984432]


portfolio before change:  [-3.06798259]
curr_Stock_Price:  99.14227343177059
curr_Factors:  [9.91422734e+01 3.40767557e-02]
mat_Sqrt:  [[ 1.83015551e+01  0.00000000e+00]
 [-7.38395619e-03  1.69187691e-02]]
grads:  [ -0.03406852 -18.94088901]
Stock Position:  -0.03406852227647701
Bond Position:  [0.30964816]


portfolio before change:  [-3.08957575]
curr_Stock_Price:  99.77722519625617
curr_Factors:  [9.97772252e+01 3.42461563e-02]
mat_Sqrt:  [[ 1.84644910e+01  0.00000000e+00]
 [-7.40228682e-03  1.69607698e-02]]
grads:  [4.00990775e-03 1.78097551e+01]
Stock Position:  0.00400990774630687
Bond Position:  [-3.48967322]


portfolio before change:  [-3.08936288]
curr_Stock_Price:  99.9391008790714
curr_Factors:  [9.99391009e+01 3.51529652e-02]
mat_Sqrt:  [[ 1.87377060e+01  0.00000000e+00]
 [-7.49964962e-03  1.71838560e-02]]
grads:  [-3.86285736e-03  6.84354206e+00]
Stock Position:  -0.003862857363337172
Bond Position:  [-2.70331239]


portfolio before change:  [-3.08618637]
curr_Stock_Price:  99.02929749878645
curr_Factors:  [9.90292975e+01 3.68959667e-02]
mat_Sqrt:  [[ 1.90218672e+01  0.00000000e+00]
 [-7.68332915e-03  1.76047187e-02]]
grads:  [0.02792022 2.42183457]
Stock Position:  0.02792021591669252
Bond Position:  [-5.85110574]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.09807193]
Stock Price:  98.62979773634625
PL:  [-3.09807193]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.50520429e-02  3.03622208e-01]
 [-1.73521607e-01 -7.20251209e-02]
 [ 7.50603054e-01 -6.36272409e-01]
 [ 9.87858239e-03  2.37983956e-02]
 [ 1.75504981e-02 -3.66394734e-03]
 [-8.94776914e-02 -6.63169280e-02]
 [-5.44463564e-04  3.21530318e-01]
 [ 1.24515136e-01 -3.07640802e-02]
 [ 1.64798568e-01  8.36204686e-02]
 [ 1.68189325e-01 -5.22140452e-03]
 [ 1.55789444e-01  3.25897812e-01]
 [ 1.58616469e-01  2.76847561e-01]
 [ 2.04469862e-01  2.48127547e-02]
 [-2.95382255e-01 -4.02467684e-01]
 [ 8.40731732e-02  2.28568828e-01]
 [ 4.81987156e-02  2.64681560e-02]
 [ 5.26402773e-02  8.67329164e-02]
 [ 8.87715878e-02  6.53920225e-02]
 [ 1.80443505e-02 -1.22378957e-02]
 [ 3.70916364e-01 -1.17341820e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.96467161e-02  1.03704851e-01]
 [-3.46121956e-02 -1.14798924e-01]
 [ 3.21325410e-02 -1.49991604e-01]
 [ 7.39325288e-02  2.60868691e-01]
 [-5.81421108e-03  1.32663835e-01]
 [ 3.78139724e-02  1.63748596e-01]
 [-1.50899857e-01  7.08804680e-02]
 [-4.95137322e-01  1.07490642e-01]
 [ 2.35052785e-01 -1.00768117e-01]
 [-1.36016497e+00 -1.53747318e-01]
 [ 1.80057282e-01  4.15210157e-01]
 [-1.27648168e-02 -1.26063372e-01]
 [ 3.07862010e-02  7.24730730e-02]
 [-4.88758240e-02  1.64884028e-01]
 [-1.48038452e+00 -1.13998794e-01]
 [-5.20176275e-02  2.64288936e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 9.82611194e-01 -1.34961795e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.53841418]
curr_Stock_Price:  99.9744884680521
curr_Factors:  [9.99744885e+01 3.97042342e-02]
mat_Sqrt:  [[ 1.99208380e+01  0.00000000e+00]
 [-7.97036854e-03  1.82624086e-02]]
grads:  [8.41147538e-03 1.66255292e+01]
Stock Position:  0.008411475382811777
Bond Position:  [1.69748123]


portfolio before change:  [2.54555855]
curr_Stock_Price:  100.79862043360725
curr_Factors:  [1.00798620e+02 3.93973974e-02]
mat_Sqrt:  [[ 2.00072940e+01  0.00000000e+00]
 [-7.93951106e-03  1.81917052e-02]]
grads:  [-0.01024406 -3.95922868]
Stock Position:  -0.01024406132957372
Bond Position:  [3.5781458]


portfolio before change:  [2.54197379]
curr_Stock_Price:  101.19221928183393
curr_Factors:  [1.01192219e+02 3.78221761e-02]
mat_Sqrt:  [[ 1.96797862e+01  0.00000000e+00]
 [-7.77916973e-03  1.78243171e-02]]
grads:  [ 2.40302919e-02 -3.56968745e+01]
Stock Position:  0.024030291942437106
Bond Position:  [0.11029522]


portfolio before change:  [2.53070898]
curr_Stock_Price:  100.7228699480653
curr_Factors:  [1.00722870e+02 3.78493262e-02]
mat_Sqrt:  [[ 1.95955369e+01  0.00000000e+00]
 [-7.78196131e-03  1.78307134e-02]]
grads:  [1.03416680e-03 1.33468556e+00]
Stock Position:  0.0010341668017091563
Bond Position:  [2.42654473]


portfolio before change:  [2.52979328]
curr_Stock_Price:  99.54410870868351
curr_Factors:  [9.95441087e+01 4.00316921e-02]
mat_Sqrt:  [[ 1.99167071e+01  0.00000000e+00]
 [-8.00316858e-03  1.83375629e-02]]
grads:  [ 0.00080091 -0.19980558]
Stock Position:  0.0008009065117118119
Bond Position:  [2.45006775]


portfolio before change:  [2.53005833]
curr_Stock_Price:  99.49263130140724
curr_Factors:  [9.94926313e+01 4.07305991e-02]
mat_Sqrt:  [[ 2.00794270e+01  0.00000000e+00]
 [-8.07272931e-03  1.84969466e-02]]
grads:  [-0.00589762 -3.58529056]
Stock Position:  -0.005897617074707023
Bond Position:  [3.11682777]


portfolio before change:  [2.52250545]
curr_Stock_Price:  100.83936275037459
curr_Factors:  [1.00839363e+02 3.94942693e-02]
mat_Sqrt:  [[ 2.00399731e+01  0.00000000e+00]
 [-7.94926606e-03  1.82140567e-02]]
grads:  [6.97520256e-03 1.76528668e+01]
Stock Position:  0.006975202563568484
Bond Position:  [1.81913047]


portfolio before change:  [2.51750805]
curr_Stock_Price:  100.09030782100251
curr_Factors:  [1.00090308e+02 3.95576243e-02]
mat_Sqrt:  [[ 1.99070600e+01  0.00000000e+00]
 [-7.95563944e-03  1.82286600e-02]]
grads:  [ 0.00558036 -1.68767646]
Stock Position:  0.005580361483707203
Bond Position:  [1.95896795]


portfolio before change:  [2.51037193]
curr_Stock_Price:  98.76763365988961
curr_Factors:  [9.87676337e+01 4.14360358e-02]
mat_Sqrt:  [[ 2.01049848e+01  0.00000000e+00]
 [-8.14233734e-03  1.86564386e-02]]
grads:  [0.01001212 4.48212386]
Stock Position:  0.010012120627909942
Bond Position:  [1.52149847]


portfolio before change:  [2.50947567]
curr_Stock_Price:  98.65911902703087
curr_Factors:  [9.86591190e+01 4.13170721e-02]
mat_Sqrt:  [[ 2.00540458e+01  0.00000000e+00]
 [-8.13064053e-03  1.86296378e-02]]
grads:  [ 0.00827317 -0.28027408]
Stock Position:  0.008273169347018557
Bond Position:  [1.69325207]


portfolio before change:  [2.49467544]
curr_Stock_Price:  96.84459121130308
curr_Factors:  [9.68445912e+01 4.32905809e-02]
mat_Sqrt:  [[ 2.01498620e+01  0.00000000e+00]
 [-8.32255546e-03  1.90693702e-02]]
grads:  [1.47903201e-02 1.70901193e+01]
Stock Position:  0.01479032011976789
Bond Position:  [1.06231294]


portfolio before change:  [2.48060549]
curr_Stock_Price:  95.88431796461528
curr_Factors:  [9.58843180e+01 4.34911403e-02]
mat_Sqrt:  [[ 1.99962234e+01  0.00000000e+00]
 [-8.34181182e-03  1.91134920e-02]]
grads:  [1.39747714e-02 1.44844051e+01]
Stock Position:  0.013974771351327384
Bond Position:  [1.14064407]


portfolio before change:  [2.49543093]
curr_Stock_Price:  96.93498652679453
curr_Factors:  [9.69349865e+01 4.24189414e-02]
mat_Sqrt:  [[ 1.99645933e+01  0.00000000e+00]
 [-8.23834366e-03  1.88764167e-02]]
grads:  [0.01078404 1.31448437]
Stock Position:  0.010784043144802693
Bond Position:  [1.45007986]


portfolio before change:  [2.5199384]
curr_Stock_Price:  99.19074463787794
curr_Factors:  [9.91907446e+01 4.20951840e-02]
mat_Sqrt:  [[ 2.03510751e+01  0.00000000e+00]
 [-8.20684436e-03  1.88042428e-02]]
grads:  [ -0.02314539 -21.40302532]
Stock Position:  -0.02314538917024447
Bond Position:  [4.81574679]


portfolio before change:  [2.53063145]
curr_Stock_Price:  98.75475952152232
curr_Factors:  [9.87547595e+01 4.24890622e-02]
mat_Sqrt:  [[ 2.03561953e+01  0.00000000e+00]
 [-8.24515006e-03  1.88920121e-02]]
grads:  [9.03060642e-03 1.20987021e+01]
Stock Position:  0.009030606417293228
Bond Position:  [1.63881608]


portfolio before change:  [2.51695882]
curr_Stock_Price:  97.21804148653885
curr_Factors:  [9.72180415e+01 4.37394061e-02]
mat_Sqrt:  [[ 2.03321502e+01  0.00000000e+00]
 [-8.36558723e-03  1.91679684e-02]]
grads:  [0.00293871 1.38085349]
Stock Position:  0.0029387135844908515
Bond Position:  [2.23126284]


portfolio before change:  [2.51382077]
curr_Stock_Price:  96.05529521843708
curr_Factors:  [9.60552952e+01 4.32868909e-02]
mat_Sqrt:  [[ 1.99847863e+01  0.00000000e+00]
 [-8.32220076e-03  1.90685575e-02]]
grads:  [4.52812575e-03 4.54847812e+00]
Stock Position:  0.004528125752452639
Bond Position:  [2.07887031]


portfolio before change:  [2.51181705]
curr_Stock_Price:  95.55540008074975
curr_Factors:  [9.55554001e+01 4.35759808e-02]
mat_Sqrt:  [[ 1.99470566e+01  0.00000000e+00]
 [-8.34994427e-03  1.91321258e-02]]
grads:  [0.00588112 3.41791723]
Stock Position:  0.005881118623704427
Bond Position:  [1.94984441]


portfolio before change:  [2.50889014]
curr_Stock_Price:  95.01627456301267
curr_Factors:  [9.50162746e+01 4.40994119e-02]
mat_Sqrt:  [[ 1.99532846e+01  0.00000000e+00]
 [-8.39994399e-03  1.92466896e-02]]
grads:  [ 0.00063665 -0.63584419]
Stock Position:  0.0006366518210849854
Bond Position:  [2.44839785]


portfolio before change:  [2.50861686]
curr_Stock_Price:  94.10627889072184
curr_Factors:  [9.41062789e+01 4.55862748e-02]
mat_Sqrt:  [[ 2.00925775e+01  0.00000000e+00]
 [-8.54037702e-03  1.95684621e-02]]
grads:  [ 0.01591156 -5.99647636]
Stock Position:  0.015911557142709035
Bond Position:  [1.01123942]


portfolio before change:  [2.5250028]
curr_Stock_Price:  95.1281478514069
curr_Factors:  [9.51281479e+01 4.49598497e-02]
mat_Sqrt:  [[ 2.01707231e+01  0.00000000e+00]
 [-8.48149513e-03  1.94335467e-02]]
grads:  [ 0.0020886  -1.94395754]
Stock Position:  0.002088601905275724
Bond Position:  [2.32631796]


portfolio before change:  [2.52264046]
curr_Stock_Price:  93.8578518045669
curr_Factors:  [9.38578518e+01 4.56803607e-02]
mat_Sqrt:  [[ 2.00602053e+01  0.00000000e+00]
 [-8.54918576e-03  1.95886454e-02]]
grads:  [7.78346548e-04 5.29413080e+00]
Stock Position:  0.0007783465480661959
Bond Position:  [2.44958653]


portfolio before change:  [2.52262062]
curr_Stock_Price:  93.43894705738315
curr_Factors:  [9.34389471e+01 4.46518143e-02]
mat_Sqrt:  [[ 1.97445614e+01  0.00000000e+00]
 [-8.45239036e-03  1.93668593e-02]]
grads:  [-4.29052597e-03 -5.92759631e+00]
Stock Position:  -0.004290525974129706
Bond Position:  [2.92352285]


portfolio before change:  [2.52518709]
curr_Stock_Price:  92.92595637301837
curr_Factors:  [9.29259564e+01 4.48717299e-02]
mat_Sqrt:  [[ 1.96844573e+01  0.00000000e+00]
 [-8.47317933e-03  1.94144928e-02]]
grads:  [-1.69317148e-03 -7.72575444e+00]
Stock Position:  -0.0016931714846974855
Bond Position:  [2.68252667]


portfolio before change:  [2.52939678]
curr_Stock_Price:  90.63773457660047
curr_Factors:  [9.06377346e+01 4.64375531e-02]
mat_Sqrt:  [[ 1.95318647e+01  0.00000000e+00]
 [-8.61974971e-03  1.97503278e-02]]
grads:  [9.61428737e-03 1.32083221e+01]
Stock Position:  0.009614287367003715
Bond Position:  [1.65797955]


portfolio before change:  [2.52679558]
curr_Stock_Price:  90.34562167111389
curr_Factors:  [9.03456217e+01 4.77178996e-02]
mat_Sqrt:  [[ 1.97354835e+01  0.00000000e+00]
 [-8.73777085e-03  2.00207482e-02]]
grads:  [2.63915669e-03 6.62631756e+00]
Stock Position:  0.002639156692228197
Bond Position:  [2.28835933]


portfolio before change:  [2.52988778]
curr_Stock_Price:  91.40889364900079
curr_Factors:  [9.14088936e+01 4.70371721e-02]
mat_Sqrt:  [[ 1.98248109e+01  0.00000000e+00]
 [-8.67522192e-03  1.98774305e-02]]
grads:  [5.51227040e-03 8.23791562e+00]
Stock Position:  0.005512270401325253
Bond Position:  [2.02601724]


portfolio before change:  [2.53196239]
curr_Stock_Price:  91.73930945257777
curr_Factors:  [9.17393095e+01 4.72454870e-02]
mat_Sqrt:  [[ 1.99404811e+01  0.00000000e+00]
 [-8.69441080e-03  1.99213978e-02]]
grads:  [-0.00601616  3.55800676]
Stock Position:  -0.006016157978368211
Bond Position:  [3.08388057]


portfolio before change:  [2.53294334]
curr_Stock_Price:  91.64033715495542
curr_Factors:  [9.16403372e+01 4.54890698e-02]
mat_Sqrt:  [[ 1.95452039e+01  0.00000000e+00]
 [-8.53126671e-03  1.95475877e-02]]
grads:  [-0.02293271  5.49892108]
Stock Position:  -0.02293271338519875
Bond Position:  [4.63450492]


portfolio before change:  [2.49602723]
curr_Stock_Price:  93.27535755234874
curr_Factors:  [9.32753576e+01 4.63560284e-02]
mat_Sqrt:  [[ 2.00826044e+01  0.00000000e+00]
 [-8.61218007e-03  1.97329835e-02]]
grads:  [ 0.0095144  -5.10658293]
Stock Position:  0.009514402080866458
Bond Position:  [1.60856797]


portfolio before change:  [2.49378498]
curr_Stock_Price:  93.01855336571052
curr_Factors:  [9.30185534e+01 4.84343421e-02]
mat_Sqrt:  [[ 2.04713406e+01  0.00000000e+00]
 [-8.80312145e-03  2.01704852e-02]]
grads:  [-0.06972019 -7.62239065]
Stock Position:  -0.06972019231201189
Bond Position:  [8.9790564]


portfolio before change:  [2.50760532]
curr_Stock_Price:  92.83642684899178
curr_Factors:  [9.28364268e+01 4.89385305e-02]
mat_Sqrt:  [[ 2.05373251e+01  0.00000000e+00]
 [-8.84882189e-03  2.02751981e-02]]
grads:  [1.75908911e-02 2.04787226e+01]
Stock Position:  0.017590891139255126
Bond Position:  [0.87452985]


portfolio before change:  [2.53105172]
curr_Stock_Price:  94.16308352371391
curr_Factors:  [9.41630835e+01 4.81700462e-02]
mat_Sqrt:  [[ 2.06666081e+01  0.00000000e+00]
 [-8.77907022e-03  2.01153769e-02]]
grads:  [-3.27985040e-03 -6.26701514e+00]
Stock Position:  -0.0032798504037948807
Bond Position:  [2.83989255]


portfolio before change:  [2.53079334]
curr_Stock_Price:  94.35009974381697
curr_Factors:  [9.43500997e+01 4.83790013e-02]
mat_Sqrt:  [[ 2.07525187e+01  0.00000000e+00]
 [-8.79809082e-03  2.01589586e-02]]
grads:  [3.00763701e-03 3.59508021e+00]
Stock Position:  0.003007637009085241
Bond Position:  [2.24702249]


portfolio before change:  [2.5321314]
curr_Stock_Price:  94.70159043940983
curr_Factors:  [9.47015904e+01 4.79014760e-02]
mat_Sqrt:  [[ 2.07267744e+01  0.00000000e+00]
 [-8.75456233e-03  2.00592223e-02]]
grads:  [1.11379924e-03 8.21986145e+00]
Stock Position:  0.0011137992368037298
Bond Position:  [2.42665284]


portfolio before change:  [2.53239128]
curr_Stock_Price:  94.6625665466412
curr_Factors:  [9.46625665e+01 4.69739401e-02]
mat_Sqrt:  [[ 2.05166651e+01  0.00000000e+00]
 [-8.66938892e-03  1.98640655e-02]]
grads:  [-0.07458023 -5.73894573]
Stock Position:  -0.07458023348143075
Bond Position:  [9.5923476]


portfolio before change:  [2.45482083]
curr_Stock_Price:  95.71873871027736
curr_Factors:  [9.57187387e+01 4.49004604e-02]
mat_Sqrt:  [[ 2.02825411e+01  0.00000000e+00]
 [-8.47589150e-03  1.94207072e-02]]
grads:  [3.12226758e-03 1.36086155e+01]
Stock Position:  0.003122267581575865
Bond Position:  [2.15596132]


portfolio before change:  [2.45453722]
curr_Stock_Price:  95.54158446506253
curr_Factors:  [9.55415845e+01 4.51364598e-02]
mat_Sqrt:  [[ 2.02981373e+01  0.00000000e+00]
 [-8.49813719e-03  1.94716785e-02]]
grads:  [-4.34449792e-03  5.61645287e+00]
Stock Position:  -0.004344497922620571
Bond Position:  [2.86961744]


portfolio before change:  [2.45510967]
curr_Stock_Price:  95.49239136742541
curr_Factors:  [9.54923914e+01 4.61662339e-02]
mat_Sqrt:  [[ 2.05178095e+01  0.00000000e+00]
 [-8.59453164e-03  1.96925459e-02]]
grads:  [ 0.04760357 -0.68534457]
Stock Position:  0.047603569895588956
Bond Position:  [-2.09066906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.48899351]
Stock Price:  96.2096735095337
PL:  [2.48899351]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.38101781e-01  4.30813468e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.34928955e-01 -7.33039899e-01]
 [-3.01853176e-02  1.54563233e-01]
 [ 1.98244348e-02 -9.29924157e-02]
 [-8.11493879e-02 -1.00298241e-01]
 [-9.68336377e-02  1.30544206e-01]
 [-2.40025694e-03 -1.28675557e-01]
 [ 1.65788554e-01  1.07811833e-01]
 [ 1.34700598e-01  4.06491415e-02]
 [ 9.24817217e-02  1.00501589e-01]
 [-1.05758855e-01 -1.97880189e-02]
 [-5.88957490e-02  1.22131403e-01]
 [-3.92598756e-01 -5.16633091e-01]
 [ 8.04535344e-02  2.25670707e-01]
 [ 5.31453958e-02 -1.98597583e-02]
 [-5.13323265e-02  1.78564386e-01]
 [-1.27944347e-01  3.38881638e-02]
 [ 1.48276361e-02  6.76336098e-02]
 [-7.85454391e-02 -4.03647835e-02]
 [ 2.04998429e-01  1.13211767e-01]
 [ 5.33500743e-02  2.76973272e-01]
 [ 3.65562079e-02  3.13713078e-01]
 [-5.83272596e-02  1.24656370e-01]
 [ 2.53344444e-02  6.32051901e-02]
 [ 5.15071632e-01 -1.26506789e-01]
 [ 1.06817266e-02  7.58938143e-02]
 [-2.03614667e-01  1.45255848e-01]
 [-4.53782279e-02 -1.14520204e-01]
 [ 1.24929026e-02 -4.92435007e-02]
 [-7.45595776e-01 -9.34942078e-02]
 [-1.18171111e-01  9.15247287e-03]
 [ 4.11135225e-02 -6.02079512e-02]
 [ 9.78891251e-02  9.37019512e-02]
 [-8.10536733e-02  1.54880383e-01]
 [-8.42817147e-01 -2.44449843e-01]
 [-2.96051780e-02  2.93872680e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.23197539e-01  7.22998219e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.98778118]
curr_Stock_Price:  100.34340278185128
curr_Factors:  [1.00343403e+02 3.81448169e-02]
mat_Sqrt:  [[ 1.95977671e+01  0.00000000e+00]
 [-7.81227925e-03  1.79001805e-02]]
grads:  [1.66408853e-02 2.40675488e+01]
Stock Position:  0.016640885252416568
Bond Position:  [3.31797813]


portfolio before change:  [4.96111928]
curr_Stock_Price:  98.71628560004146
curr_Factors:  [9.87162856e+01 3.89332532e-02]
mat_Sqrt:  [[ 1.94782149e+01  0.00000000e+00]
 [-7.89260445e-03  1.80842287e-02]]
grads:  [-0.0104211  -4.86674725]
Stock Position:  -0.01042110117543405
Bond Position:  [5.98985168]


portfolio before change:  [4.95844853]
curr_Stock_Price:  99.0444209815605
curr_Factors:  [9.90444210e+01 3.85358784e-02]
mat_Sqrt:  [[ 1.94429719e+01  0.00000000e+00]
 [-7.85222296e-03  1.79917031e-02]]
grads:  [ 2.64879318e-02 -4.07432191e+01]
Stock Position:  0.026487931847318253
Bond Position:  [2.33496666]


portfolio before change:  [4.93356286]
curr_Stock_Price:  98.09389144034138
curr_Factors:  [9.80938914e+01 3.81178601e-02]
mat_Sqrt:  [[ 1.91516510e+01  0.00000000e+00]
 [-7.80951831e-03  1.78938544e-02]]
grads:  [1.94613027e-03 8.63778312e+00]
Stock Position:  0.0019461302711475585
Bond Position:  [4.74265936]


portfolio before change:  [4.93183831]
curr_Stock_Price:  96.90311236323876
curr_Factors:  [9.69031124e+01 3.80771271e-02]
mat_Sqrt:  [[ 1.89090545e+01  0.00000000e+00]
 [-7.80534454e-03  1.78842911e-02]]
grads:  [-1.09792812e-03 -5.19967022e+00]
Stock Position:  -0.001097928124157938
Bond Position:  [5.03823097]


portfolio before change:  [4.93114086]
curr_Stock_Price:  98.11200374914702
curr_Factors:  [9.81120037e+01 3.57098233e-02]
mat_Sqrt:  [[ 1.85402675e+01  0.00000000e+00]
 [-7.55881718e-03  1.73194260e-02]]
grads:  [-0.00673794 -5.79108346]
Stock Position:  -0.0067379356354129545
Bond Position:  [5.59221322]


portfolio before change:  [4.93652884]
curr_Stock_Price:  97.41610584635129
curr_Factors:  [9.74161058e+01 3.72018908e-02]
mat_Sqrt:  [[ 1.87894156e+01  0.00000000e+00]
 [-7.71511668e-03  1.76775531e-02]]
grads:  [-2.12137919e-03  7.38474411e+00]
Stock Position:  -0.002121379192313406
Bond Position:  [5.14318534]


portfolio before change:  [4.93851851]
curr_Stock_Price:  96.78126940416675
curr_Factors:  [9.67812694e+01 3.73924589e-02]
mat_Sqrt:  [[ 1.87147197e+01  0.00000000e+00]
 [-7.73485192e-03  1.77227722e-02]]
grads:  [-3.12902759e-03 -7.26046444e+00]
Stock Position:  -0.0031290275889479455
Bond Position:  [5.24134977]


portfolio before change:  [4.93741067]
curr_Stock_Price:  97.34471886927372
curr_Factors:  [9.73447189e+01 3.76111617e-02]
mat_Sqrt:  [[ 1.88786428e+01  0.00000000e+00]
 [-7.75743893e-03  1.77745255e-02]]
grads:  [0.01127419 6.06552521]
Stock Position:  0.011274194727660895
Bond Position:  [3.83992735]


portfolio before change:  [4.94646607]
curr_Stock_Price:  98.10533877859952
curr_Factors:  [9.81053388e+01 3.73458258e-02]
mat_Sqrt:  [[ 1.89589235e+01  0.00000000e+00]
 [-7.73002725e-03  1.77117175e-02]]
grads:  [0.00804061 2.29504234]
Stock Position:  0.008040611461620393
Bond Position:  [4.15763916]


portfolio before change:  [4.96085126]
curr_Stock_Price:  99.8297660701263
curr_Factors:  [9.98297661e+01 3.67459466e-02]
mat_Sqrt:  [[ 1.91365997e+01  0.00000000e+00]
 [-7.66769291e-03  1.75688916e-02]]
grads:  [0.00712479 5.72042855]
Stock Position:  0.007124787739604312
Bond Position:  [4.24958536]


portfolio before change:  [4.96422663]
curr_Stock_Price:  100.22895617438661
curr_Factors:  [1.00228956e+02 3.62750367e-02]
mat_Sqrt:  [[ 1.90896136e+01  0.00000000e+00]
 [-7.61840264e-03  1.74559534e-02]]
grads:  [-0.00599253 -1.13359715]
Stock Position:  -0.005992528545363133
Bond Position:  [5.56485151]


portfolio before change:  [4.96286346]
curr_Stock_Price:  100.57252139199048
curr_Factors:  [1.00572521e+02 3.72039174e-02]
mat_Sqrt:  [[ 1.93987468e+01  0.00000000e+00]
 [-7.71532681e-03  1.76780346e-02]]
grads:  [-2.88329702e-04  6.90865279e+00]
Stock Position:  -0.00028832970247879533
Bond Position:  [4.9918615]


portfolio before change:  [4.96356793]
curr_Stock_Price:  100.29351196608074
curr_Factors:  [1.00293512e+02 3.72850268e-02]
mat_Sqrt:  [[ 1.93660063e+01  0.00000000e+00]
 [-7.72373245e-03  1.76972943e-02]]
grads:  [ -0.03191551 -29.19277278]
Stock Position:  -0.03191550763325788
Bond Position:  [8.16448627]


portfolio before change:  [4.98282088]
curr_Stock_Price:  99.72224321553509
curr_Factors:  [9.97222432e+01 3.88807570e-02]
mat_Sqrt:  [[ 1.96634354e+01  0.00000000e+00]
 [-7.88728161e-03  1.80720325e-02]]
grads:  [9.10035821e-03 1.24872898e+01]
Stock Position:  0.009100358208839842
Bond Position:  [4.07531275]


portfolio before change:  [4.98350449]
curr_Stock_Price:  99.7413810651387
curr_Factors:  [9.97413811e+01 3.87982998e-02]
mat_Sqrt:  [[ 1.96463431e+01  0.00000000e+00]
 [-7.87891361e-03  1.80528590e-02]]
grads:  [ 0.00226393 -1.10008937]
Stock Position:  0.0022639270008472006
Bond Position:  [4.75769728]


portfolio before change:  [4.98382692]
curr_Stock_Price:  99.62109679687045
curr_Factors:  [9.96210968e+01 3.88785539e-02]
mat_Sqrt:  [[ 1.96429346e+01  0.00000000e+00]
 [-7.88705815e-03  1.80715205e-02]]
grads:  [1.35415412e-03 9.88098297e+00]
Stock Position:  0.0013541541157090107
Bond Position:  [4.84892461]


portfolio before change:  [4.98680431]
curr_Stock_Price:  101.37217828836015
curr_Factors:  [1.01372178e+02 3.86490361e-02]
mat_Sqrt:  [[ 1.99291195e+01  0.00000000e+00]
 [-7.86374324e-03  1.80180993e-02]]
grads:  [-0.00567784  1.8807846 ]
Stock Position:  -0.005677839367872551
Bond Position:  [5.56237926]


portfolio before change:  [4.97925024]
curr_Stock_Price:  102.82509301856832
curr_Factors:  [1.02825093e+02 3.84949257e-02]
mat_Sqrt:  [[ 2.01744105e+01  0.00000000e+00]
 [-7.84804951e-03  1.79821405e-02]]
grads:  [2.19809958e-03 3.76115457e+00]
Stock Position:  0.0021980995828113628
Bond Position:  [4.75323044]


portfolio before change:  [4.9775802]
curr_Stock_Price:  101.79500886593331
curr_Factors:  [1.01795009e+02 4.03856389e-02]
mat_Sqrt:  [[ 2.04569066e+01  0.00000000e+00]
 [-8.03847138e-03  1.84184518e-02]]
grads:  [-0.00470071 -2.19154052]
Stock Position:  -0.004700714362690055
Bond Position:  [5.45608946]


portfolio before change:  [4.97770594]
curr_Stock_Price:  101.9133548566932
curr_Factors:  [1.01913355e+02 3.99881450e-02]
mat_Sqrt:  [[ 2.03796503e+01  0.00000000e+00]
 [-7.99881441e-03  1.83275863e-02]]
grads:  [0.01248344 6.17712369]
Stock Position:  0.012483437706837136
Bond Position:  [3.70547693]


portfolio before change:  [4.96132142]
curr_Stock_Price:  100.56374795356174
curr_Factors:  [1.00563748e+02 3.95558886e-02]
mat_Sqrt:  [[ 2.00007842e+01  0.00000000e+00]
 [-7.95546489e-03  1.82282600e-02]]
grads:  [8.71121447e-03 1.51947181e+01]
Stock Position:  0.00871121447043931
Bond Position:  [4.08528905]


portfolio before change:  [4.95018771]
curr_Stock_Price:  99.22703361943017
curr_Factors:  [9.92270336e+01 4.00053187e-02]
mat_Sqrt:  [[ 1.98467261e+01  0.00000000e+00]
 [-8.00053185e-03  1.83315214e-02]]
grads:  [8.74057611e-03 1.71133138e+01]
Stock Position:  0.008740576110665987
Bond Position:  [4.08288627]


portfolio before change:  [4.94600206]
curr_Stock_Price:  98.68976451325696
curr_Factors:  [9.86897645e+01 3.94951271e-02]
mat_Sqrt:  [[ 1.96129929e+01  0.00000000e+00]
 [-7.94935239e-03  1.82142545e-02]]
grads:  [-2.00008202e-04  6.84389087e+00]
Stock Position:  -0.00020000820173704173
Bond Position:  [4.96574082]


portfolio before change:  [4.94663808]
curr_Stock_Price:  98.61344980231786
curr_Factors:  [9.86134498e+01 4.11327678e-02]
mat_Sqrt:  [[ 2.00000057e+01  0.00000000e+00]
 [-8.11248597e-03  1.85880405e-02]]
grads:  [2.64597179e-03 3.40031485e+00]
Stock Position:  0.002645971789947971
Bond Position:  [4.68570968]


portfolio before change:  [4.94927694]
curr_Stock_Price:  99.38938639169861
curr_Factors:  [9.93893864e+01 4.10946652e-02]
mat_Sqrt:  [[ 2.01480367e+01  0.00000000e+00]
 [-8.10872766e-03  1.85794292e-02]]
grads:  [ 0.02282404 -6.80897072]
Stock Position:  0.02282403738687664
Bond Position:  [2.68080987]


portfolio before change:  [4.95825569]
curr_Stock_Price:  99.76809368566198
curr_Factors:  [9.97680937e+01 4.09296319e-02]
mat_Sqrt:  [[ 2.01841560e+01  0.00000000e+00]
 [-8.09242925e-03  1.85420848e-02]]
grads:  [2.17024198e-03 4.09305723e+00]
Stock Position:  0.0021702419823136517
Bond Position:  [4.74173478]


portfolio before change:  [4.95672662]
curr_Stock_Price:  98.79040322113391
curr_Factors:  [9.87904032e+01 4.30690563e-02]
mat_Sqrt:  [[ 2.05020570e+01  0.00000000e+00]
 [-8.30123425e-03  1.90205172e-02]]
grads:  [-6.83930486e-03  7.63679804e+00]
Stock Position:  -0.006839304862834714
Bond Position:  [5.6323843]


portfolio before change:  [4.95766085]
curr_Stock_Price:  98.75675325354582
curr_Factors:  [9.87567533e+01 4.32512714e-02]
mat_Sqrt:  [[ 2.05383827e+01  0.00000000e+00]
 [-8.31877600e-03  1.90607104e-02]]
grads:  [-4.64296258e-03 -6.00818132e+00]
Stock Position:  -0.00464296258323004
Bond Position:  [5.41618476]


portfolio before change:  [4.9533766]
curr_Stock_Price:  99.82532020589036
curr_Factors:  [9.98253202e+01 4.20929009e-02]
mat_Sqrt:  [[ 2.04807162e+01  0.00000000e+00]
 [-8.20662180e-03  1.88037328e-02]]
grads:  [-4.39375407e-04 -2.61881517e+00]
Stock Position:  -0.0004393754068284787
Bond Position:  [4.99723739]


portfolio before change:  [4.95431506]
curr_Stock_Price:  99.11119652693378
curr_Factors:  [9.91111965e+01 4.17846978e-02]
mat_Sqrt:  [[ 2.02596227e+01  0.00000000e+00]
 [-8.17652227e-03  1.87347661e-02]]
grads:  [-0.03881612 -4.99041233]
Stock Position:  -0.03881612246131504
Bond Position:  [8.80142741]


portfolio before change:  [4.98107001]
curr_Stock_Price:  98.45026748353186
curr_Factors:  [9.84502675e+01 4.32621291e-02]
mat_Sqrt:  [[ 2.04772129e+01  0.00000000e+00]
 [-8.31982010e-03  1.90631027e-02]]
grads:  [-0.00557579  0.48011454]
Stock Position:  -0.005575790291991538
Bond Position:  [5.53000806]


portfolio before change:  [4.97545157]
curr_Stock_Price:  99.58189937062224
curr_Factors:  [9.95818994e+01 4.05687897e-02]
mat_Sqrt:  [[ 2.00574829e+01  0.00000000e+00]
 [-8.05667819e-03  1.84601688e-02]]
grads:  [ 7.39704896e-04 -3.26150599e+00]
Stock Position:  0.0007397048956858428
Bond Position:  [4.90179035]


portfolio before change:  [4.97566896]
curr_Stock_Price:  99.04740706902149
curr_Factors:  [9.90474071e+01 4.14366341e-02]
mat_Sqrt:  [[ 2.01620806e+01  0.00000000e+00]
 [-8.14239612e-03  1.86565733e-02]]
grads:  [0.00688342 5.02246312]
Stock Position:  0.006883417055484261
Bond Position:  [4.29388435]


portfolio before change:  [4.96428757]
curr_Stock_Price:  97.31597577752017
curr_Factors:  [9.73159758e+01 4.19151506e-02]
mat_Sqrt:  [[ 1.99236845e+01  0.00000000e+00]
 [-8.18927597e-03  1.87639885e-02]]
grads:  [-6.75494149e-04  8.25412909e+00]
Stock Position:  -0.000675494148782597
Bond Position:  [5.03002394]


portfolio before change:  [4.96477073]
curr_Stock_Price:  97.53157242729354
curr_Factors:  [9.75315724e+01 4.32612578e-02]
mat_Sqrt:  [[ 2.02859241e+01  0.00000000e+00]
 [-8.31973632e-03  1.90629107e-02]]
grads:  [ -0.04680604 -12.82332203]
Stock Position:  -0.04680604139024056
Bond Position:  [9.52983754]


portfolio before change:  [4.98968422]
curr_Stock_Price:  97.02475348922702
curr_Factors:  [9.70247535e+01 4.35170782e-02]
mat_Sqrt:  [[ 2.02400887e+01  0.00000000e+00]
 [-8.34429896e-03  1.91191908e-02]]
grads:  [4.87405840e-03 1.53705606e+01]
Stock Position:  0.004874058403533988
Bond Position:  [4.5167799]


portfolio before change:  [4.99254206]
curr_Stock_Price:  97.4952458802952
curr_Factors:  [9.74952459e+01 4.27904731e-02]
mat_Sqrt:  [[ 2.01677284e+01  0.00000000e+00]
 [-8.27434330e-03  1.89589022e-02]]
grads:  [-4.37259040e-03  5.76835953e+00]
Stock Position:  -0.004372590396657062
Bond Position:  [5.41884883]


portfolio before change:  [4.9958334]
curr_Stock_Price:  96.89744428698049
curr_Factors:  [9.68974443e+01 4.46383025e-02]
mat_Sqrt:  [[ 2.04722774e+01  0.00000000e+00]
 [-8.45111141e-03  1.93639289e-02]]
grads:  [0.04036449 0.37337372]
Stock Position:  0.04036448629281905
Bond Position:  [1.08461784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.03995981]
Stock Price:  97.98728415092783
PL:  [5.03995981]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.37289284e-01 -2.43639084e-02]
 [-1.69997001e-01 -8.60193603e-02]
 [ 9.03699260e-01 -8.91059478e-01]
 [-3.42585042e-02  1.35504924e-01]
 [ 1.52260331e-02 -1.05860913e-01]
 [-8.03352281e-02 -1.03620192e-01]
 [-7.50344164e-02  1.60132307e-01]
 [-5.65096941e-02 -1.15462053e-01]
 [ 1.42987283e-01  7.74602761e-02]
 [ 2.95960544e-01 -1.33469068e-01]
 [ 6.85424469e-02  1.61240004e-02]
 [-1.49168967e-01 -1.32156418e-01]
 [-1.90437554e-01  1.65819927e-01]
 [-5.93564655e-01 -7.52635761e-01]
 [ 6.31430934e-02  1.62026098e-01]
 [ 6.14691837e-02 -3.89186767e-02]
 [-5.29991289e-02  2.72260747e-01]
 [ 3.52972824e-02  1.41345317e-01]
 [ 1.47634628e-02  6.92270411e-02]
 [-1.01481786e-01 -3.53223181e-02]
 [ 2.17354814e-01  1.32828215e-01]
 [ 3.37812441e-02  1.55503253e-01]
 [ 3.80548229e-02  4.00087973e-01]
 [ 9.75144592e-03  1.60099605e-01]
 [ 2.82200867e-02  6.42675242e-02]
 [ 7.08549747e-01 -2.79561701e-01]
 [-6.60919921e-02  1.06407460e-01]
 [-1.59681113e-01  1.25744527e-01]
 [ 2.18369943e-02 -1.48876266e-01]
 [ 2.87000514e-02 -5.30315691e-02]
 [-6.61120598e-01 -8.68775466e-02]
 [-1.18076095e-01  5.46391819e-03]
 [ 7.21175534e-02 -1.08313320e-03]
 [ 1.27134896e-01  7.86975801e-02]
 [-2.83777955e-01 -1.47923701e-01]
 [-1.35786458e-02 -3.80735663e-01]
 [-1.56389161e-01  2.19545041e-01]
 [-1.22318636e-01  1.18533882e-01]
 [ 3.37067922e-01  6.26109918e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.68446171]
curr_Stock_Price:  99.03722263927818
curr_Factors:  [9.90372226e+01 4.04719315e-02]
mat_Sqrt:  [[ 1.99239489e+01  0.00000000e+00]
 [-8.04705477e-03  1.84381188e-02]]
grads:  [-0.01244345 -1.32138797]
Stock Position:  -0.012443445164591468
Bond Position:  [-2.45209746]


portfolio before change:  [-3.66373946]
curr_Stock_Price:  97.34727462342812
curr_Factors:  [9.73472746e+01 4.09709497e-02]
mat_Sqrt:  [[ 1.97043364e+01  0.00000000e+00]
 [-8.09651280e-03  1.85514414e-02]]
grads:  [-0.01053265 -4.63680199]
Stock Position:  -0.01053265250561673
Bond Position:  [-2.63841445]


portfolio before change:  [-3.65576293]
curr_Stock_Price:  96.55864607538064
curr_Factors:  [9.65586461e+01 4.11414519e-02]
mat_Sqrt:  [[ 1.95853337e+01  0.00000000e+00]
 [-8.11334229e-03  1.85900026e-02]]
grads:  [ 2.62854353e-02 -4.79321869e+01]
Stock Position:  0.026285435343967434
Bond Position:  [-6.19384898]


portfolio before change:  [-3.60888804]
curr_Stock_Price:  98.37140562401937
curr_Factors:  [9.83714056e+01 4.09778725e-02]
mat_Sqrt:  [[ 1.99133158e+01  0.00000000e+00]
 [-8.09719680e-03  1.85530086e-02]]
grads:  [1.24945002e-03 7.30366305e+00]
Stock Position:  0.0012494500242954385
Bond Position:  [-3.7317982]


portfolio before change:  [-3.61163508]
curr_Stock_Price:  96.54617723982645
curr_Factors:  [9.65461772e+01 4.17950406e-02]
mat_Sqrt:  [[ 1.97377416e+01  0.00000000e+00]
 [-8.17753416e-03  1.87370846e-02]]
grads:  [-1.56935163e-03 -5.64980704e+00]
Stock Position:  -0.0015693516315030108
Bond Position:  [-3.46012018]


portfolio before change:  [-3.61379443]
curr_Stock_Price:  97.64651175867546
curr_Factors:  [9.76465118e+01 4.25130065e-02]
mat_Sqrt:  [[ 2.01334242e+01  0.00000000e+00]
 [-8.24747297e-03  1.88973346e-02]]
grads:  [-0.00623634 -5.48332316]
Stock Position:  -0.006236335493712103
Bond Position:  [-3.00483802]


portfolio before change:  [-3.61672851]
curr_Stock_Price:  98.05676141072011
curr_Factors:  [9.80567614e+01 4.31577494e-02]
mat_Sqrt:  [[ 2.03707463e+01  0.00000000e+00]
 [-8.30977731e-03  1.90400918e-02]]
grads:  [-2.52663697e-04  8.41026969e+00]
Stock Position:  -0.0002526636968029833
Bond Position:  [-3.59195313]


portfolio before change:  [-3.61699397]
curr_Stock_Price:  97.33024099957693
curr_Factors:  [9.73302410e+01 4.27921836e-02]
mat_Sqrt:  [[ 2.01339981e+01  0.00000000e+00]
 [-8.27450868e-03  1.89592812e-02]]
grads:  [-5.30950011e-03 -6.09000159e+00]
Stock Position:  -0.005309500111188995
Bond Position:  [-3.10021904]


portfolio before change:  [-3.63443398]
curr_Stock_Price:  100.54192891219755
curr_Factors:  [1.00541929e+02 4.11212225e-02]
mat_Sqrt:  [[ 2.03882627e+01  0.00000000e+00]
 [-8.11134736e-03  1.85854316e-02]]
grads:  [0.00867135 4.16779538]
Stock Position:  0.008671347875427695
Bond Position:  [-4.50626802]


portfolio before change:  [-3.63483597]
curr_Stock_Price:  100.56053403809867
curr_Factors:  [1.00560534e+02 4.12870030e-02]
mat_Sqrt:  [[ 2.04330995e+01  0.00000000e+00]
 [-8.12768139e-03  1.86228576e-02]]
grads:  [ 0.01163357 -7.16694888]
Stock Position:  0.011633568693027035
Bond Position:  [-4.80471385]


portfolio before change:  [-3.62915855]
curr_Stock_Price:  101.10018281178164
curr_Factors:  [1.01100183e+02 4.11045904e-02]
mat_Sqrt:  [[ 2.04973210e+01  0.00000000e+00]
 [-8.10970682e-03  1.85816727e-02]]
grads:  [0.00368729 0.86773676]
Stock Position:  0.0036872885683153513
Bond Position:  [-4.0019441]


portfolio before change:  [-3.62898406]
curr_Stock_Price:  101.28318019337506
curr_Factors:  [1.0128318e+02 4.2441767e-02]
mat_Sqrt:  [[ 2.08657528e+01  0.00000000e+00]
 [-8.24055988e-03  1.88814947e-02]]
grads:  [-0.00991322 -6.99925616]
Stock Position:  -0.00991321804246059
Bond Position:  [-2.62494181]


portfolio before change:  [-3.63736642]
curr_Stock_Price:  102.09565290138892
curr_Factors:  [1.02095653e+02 4.29995363e-02]
mat_Sqrt:  [[ 2.11708910e+01  0.00000000e+00]
 [-8.29453182e-03  1.90051600e-02]]
grads:  [-5.57689349e-03  8.72499507e+00]
Stock Position:  -0.005576893485642081
Bond Position:  [-3.06798984]


portfolio before change:  [-3.64076398]
curr_Stock_Price:  102.63610424019264
curr_Factors:  [1.02636104e+02 4.16099902e-02]
mat_Sqrt:  [[ 2.09362534e+01  0.00000000e+00]
 [-8.15941078e-03  1.86955588e-02]]
grads:  [ -0.04404044 -40.25746277]
Stock Position:  -0.04404044095550686
Bond Position:  [0.87937531]


portfolio before change:  [-3.61923811]
curr_Stock_Price:  102.14982533608678
curr_Factors:  [1.02149825e+02 4.12932811e-02]
mat_Sqrt:  [[ 2.07576089e+01  0.00000000e+00]
 [-8.12829931e-03  1.86242734e-02]]
grads:  [6.44857895e-03 8.69972717e+00]
Stock Position:  0.006448578954982513
Bond Position:  [-4.27795933]


portfolio before change:  [-3.6155498]
curr_Stock_Price:  102.80471234828228
curr_Factors:  [1.02804712e+02 3.99781469e-02]
mat_Sqrt:  [[ 2.05553252e+01  0.00000000e+00]
 [-7.99781440e-03  1.83252949e-02]]
grads:  [ 0.0021641 -2.1237681]
Stock Position:  0.0021640952020834598
Bond Position:  [-3.83802899]


portfolio before change:  [-3.61290612]
curr_Stock_Price:  104.24802659754305
curr_Factors:  [1.04248027e+02 4.02599494e-02]
mat_Sqrt:  [[ 2.09172436e+01  0.00000000e+00]
 [-8.02595285e-03  1.83897682e-02]]
grads:  [3.14693484e-03 1.48050124e+01]
Stock Position:  0.003146934835855777
Bond Position:  [-3.94096786]


portfolio before change:  [-3.61369148]
curr_Stock_Price:  104.15501120653056
curr_Factors:  [1.04155011e+02 3.96932052e-02]
mat_Sqrt:  [[ 2.07509629e+01  0.00000000e+00]
 [-7.96926147e-03  1.82598719e-02]]
grads:  [4.67378003e-03 7.74076167e+00]
Stock Position:  0.004673780028807176
Bond Position:  [-4.10048909]


portfolio before change:  [-3.6173703]
curr_Stock_Price:  103.47756804457539
curr_Factors:  [1.03477568e+02 3.73554298e-02]
mat_Sqrt:  [[ 1.99996816e+01  0.00000000e+00]
 [-7.73102113e-03  1.77139948e-02]]
grads:  [2.24886683e-03 3.90804232e+00]
Stock Position:  0.0022488668280301115
Bond Position:  [-3.85007757]


portfolio before change:  [-3.61715626]
curr_Stock_Price:  103.78675638551694
curr_Factors:  [1.03786756e+02 3.70700154e-02]
mat_Sqrt:  [[ 1.99826611e+01  0.00000000e+00]
 [-7.70143004e-03  1.76461931e-02]]
grads:  [-0.00584996 -2.00169623]
Stock Position:  -0.005849957052273784
Bond Position:  [-3.01000819]


portfolio before change:  [-3.60841684]
curr_Stock_Price:  102.22850608165707
curr_Factors:  [1.02228506e+02 3.88389558e-02]
mat_Sqrt:  [[ 2.01467866e+01  0.00000000e+00]
 [-7.88304061e-03  1.80623152e-02]]
grads:  [0.01366599 7.35388646]
Stock Position:  0.013665990765794079
Bond Position:  [-5.00547066]


portfolio before change:  [-3.6189865]
curr_Stock_Price:  101.50086456681017
curr_Factors:  [1.01500865e+02 4.00069531e-02]
mat_Sqrt:  [[ 2.03019372e+01  0.00000000e+00]
 [-8.00069528e-03  1.83318959e-02]]
grads:  [5.00683392e-03 8.48266073e+00]
Stock Position:  0.005006833916943014
Bond Position:  [-4.12718448]


portfolio before change:  [-3.6230216]
curr_Stock_Price:  100.79799198039782
curr_Factors:  [1.00797992e+02 4.03350340e-02]
mat_Sqrt:  [[ 2.02438492e+01  0.00000000e+00]
 [-8.03343353e-03  1.84069086e-02]]
grads:  [1.05052911e-02 2.17357505e+01]
Stock Position:  0.010505291124318323
Bond Position:  [-4.68193385]


portfolio before change:  [-3.62138565]
curr_Stock_Price:  101.00943095518151
curr_Factors:  [1.01009431e+02 3.89757565e-02]
mat_Sqrt:  [[ 1.99415633e+01  0.00000000e+00]
 [-7.89691145e-03  1.80940972e-02]]
grads:  [3.99289868e-03 8.84816758e+00]
Stock Position:  0.003992898683071819
Bond Position:  [-4.02470607]


portfolio before change:  [-3.62113909]
curr_Stock_Price:  101.19718464667098
curr_Factors:  [1.01197185e+02 4.00272400e-02]
mat_Sqrt:  [[ 2.02463273e+01  0.00000000e+00]
 [-8.00272353e-03  1.83365432e-02]]
grads:  [2.77920696e-03 3.50488768e+00]
Stock Position:  0.0027792069635950863
Bond Position:  [-3.90238701]


portfolio before change:  [-3.62072381]
curr_Stock_Price:  101.52213806581312
curr_Factors:  [1.01522138e+02 4.02879741e-02]
mat_Sqrt:  [[ 2.03773859e+01  0.00000000e+00]
 [-8.02874577e-03  1.83961676e-02]]
grads:  [  0.02878382 -15.19673593]
Stock Position:  0.02878382050230258
Bond Position:  [-6.5429188]


portfolio before change:  [-3.62576152]
curr_Stock_Price:  101.3755349829344
curr_Factors:  [1.01375535e+02 4.13699198e-02]
mat_Sqrt:  [[ 2.06193751e+01  0.00000000e+00]
 [-8.13583872e-03  1.86415484e-02]]
grads:  [-9.53082678e-04  5.70808057e+00]
Stock Position:  -0.0009530826783587372
Bond Position:  [-3.52914225]


portfolio before change:  [-3.62471948]
curr_Stock_Price:  99.8193092318795
curr_Factors:  [9.98193092e+01 4.20496092e-02]
mat_Sqrt:  [[ 2.04689489e+01  0.00000000e+00]
 [-8.20240055e-03  1.87940607e-02]]
grads:  [-5.12003341e-03  6.69065240e+00]
Stock Position:  -0.005120033409365327
Bond Position:  [-3.11364128]


portfolio before change:  [-3.62540818]
curr_Stock_Price:  99.87780035028057
curr_Factors:  [9.98778004e+01 4.16531047e-02]
mat_Sqrt:  [[ 2.03841524e+01  0.00000000e+00]
 [-8.16363690e-03  1.87052420e-02]]
grads:  [-2.11624865e-03 -7.95906655e+00]
Stock Position:  -0.002116248650984493
Bond Position:  [-3.41404192]


portfolio before change:  [-3.62480914]
curr_Stock_Price:  99.39306355497784
curr_Factors:  [9.93930636e+01 4.04060743e-02]
mat_Sqrt:  [[ 1.99792603e+01  0.00000000e+00]
 [-8.04050489e-03  1.84231111e-02]]
grads:  [ 2.78047189e-04 -2.87853494e+00]
Stock Position:  0.00027804718856849514
Bond Position:  [-3.6524451]


portfolio before change:  [-3.62511054]
curr_Stock_Price:  99.95119555893992
curr_Factors:  [9.99511956e+01 4.18529216e-02]
mat_Sqrt:  [[ 2.04480022e+01  0.00000000e+00]
 [-8.18319465e-03  1.87500544e-02]]
grads:  [-0.03418608 -4.6334557 ]
Stock Position:  -0.034186081397608606
Bond Position:  [-0.20817083]


portfolio before change:  [-3.62296567]
curr_Stock_Price:  99.88769343723109
curr_Factors:  [9.98876934e+01 4.08535618e-02]
mat_Sqrt:  [[ 2.01895644e+01  0.00000000e+00]
 [-8.08490562e-03  1.85248460e-02]]
grads:  [-0.00573026  0.2949508 ]
Stock Position:  -0.005730259619911166
Bond Position:  [-3.05058326]


portfolio before change:  [-3.62507676]
curr_Stock_Price:  100.18955445021503
curr_Factors:  [1.00189554e+02 4.07458547e-02]
mat_Sqrt:  [[ 2.02238652e+01  0.00000000e+00]
 [-8.07424099e-03  1.85004103e-02]]
grads:  [ 0.00354259 -0.05854644]
Stock Position:  0.003542588656419134
Bond Position:  [-3.98000714]


portfolio before change:  [-3.62482481]
curr_Stock_Price:  100.401117913409
curr_Factors:  [1.00401118e+02 4.06004744e-02]
mat_Sqrt:  [[ 2.02303829e+01  0.00000000e+00]
 [-8.05982376e-03  1.84673762e-02]]
grads:  [0.00798212 4.26143807]
Stock Position:  0.007982119580243863
Bond Position:  [-4.42623854]


portfolio before change:  [-3.62228577]
curr_Stock_Price:  100.78852864341164
curr_Factors:  [1.00788529e+02 3.94979643e-02]
mat_Sqrt:  [[ 2.00308077e+01  0.00000000e+00]
 [-7.94963791e-03  1.82149087e-02]]
grads:  [-0.01739007 -8.12102345]
Stock Position:  -0.0173900701356688
Bond Position:  [-1.86956618]


portfolio before change:  [-3.65082308]
curr_Stock_Price:  102.41610156680495
curr_Factors:  [1.02416102e+02 3.91501509e-02]
mat_Sqrt:  [[ 2.02644565e+01  0.00000000e+00]
 [-7.91455883e-03  1.81345325e-02]]
grads:  [-8.86997940e-03 -2.09950636e+01]
Stock Position:  -0.00886997939796246
Bond Position:  [-2.74239437]


portfolio before change:  [-3.65836795]
curr_Stock_Price:  103.22805926266021
curr_Factors:  [1.03228059e+02 4.11803194e-02]
mat_Sqrt:  [[ 2.09480025e+01  0.00000000e+00]
 [-8.11717383e-03  1.85987818e-02]]
grads:  [-2.89153341e-03  1.18042700e+01]
Stock Position:  -0.0028915334093247173
Bond Position:  [-3.35988057]


portfolio before change:  [-3.65563897]
curr_Stock_Price:  102.13902056272383
curr_Factors:  [1.02139021e+02 4.32639869e-02]
mat_Sqrt:  [[ 2.12449130e+01  0.00000000e+00]
 [-8.31999874e-03  1.90635120e-02]]
grads:  [-3.32249930e-03  6.21784076e+00]
Stock Position:  -0.003322499301510574
Bond Position:  [-3.31628215]


portfolio before change:  [-3.64970298]
curr_Stock_Price:  100.22764198322982
curr_Factors:  [1.00227642e+02 4.44998528e-02]
mat_Sqrt:  [[ 2.11430093e+01  0.00000000e+00]
 [-8.43799529e-03  1.93338761e-02]]
grads:  [0.01723471 3.23840866]
Stock Position:  0.017234708387611604
Bond Position:  [-5.37709716]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.63836749]
Stock Price:  100.92435635008898
PL:  [-4.56272384]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.62205002e-02  2.93269595e-01]
 [-1.64884067e-01 -8.62673081e-02]
 [ 8.14717076e-01 -6.94021860e-01]
 [ 5.54721529e-02  2.77642849e-02]
 [-1.62249572e-01  6.82938137e-02]
 [ 1.35658727e-01  1.37910308e-01]
 [ 2.72444100e-02  2.67975978e-01]
 [ 3.90905062e-01 -1.14752668e-02]
 [-1.29374458e-01 -2.03561454e-03]
 [ 4.80390710e-01 -3.26780739e-01]
 [ 6.21039245e-02 -6.10713314e-03]
 [-1.12745513e-01 -1.75472833e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-5.08779166e-01 -6.53068611e-01]
 [ 8.20941054e-02  2.26989318e-01]
 [ 5.26001160e-02 -1.95123319e-02]
 [-5.14772523e-02  1.86711132e-01]
 [-2.58422912e-02  3.46507529e-02]
 [ 1.51529291e-02  5.95565344e-02]
 [-2.68580844e-02 -8.12016966e-02]
 [ 2.19600915e-01  1.37975233e-01]
 [ 1.50569546e-03  9.12991090e-02]
 [ 3.38838929e-02  3.39425877e-01]
 [ 2.01763988e-02  1.63730902e-01]
 [ 4.07585522e-02  9.02028887e-02]
 [ 7.33987457e-01 -3.98504812e-01]
 [-9.49523753e-02  1.40781334e-01]
 [-2.38301027e-02  6.50580208e-02]
 [-1.13817197e-02 -9.57493657e-02]
 [-7.14016371e-02 -5.77839273e-02]
 [-5.87510731e-01 -9.57104333e-02]
 [-1.17960940e-01  9.93610625e-04]
 [ 7.31774123e-02  1.23591663e-03]
 [ 1.10711119e-01  8.71237022e-02]
 [-2.67805999e-01 -1.11993084e-01]
 [-3.31557023e-01 -3.70877322e-01]
 [-8.90392085e-02  2.79633456e-01]
 [-1.22442352e-01  1.18450420e-01]
 [-2.19835990e-02  1.07988753e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.32976205]
curr_Stock_Price:  99.94306207995821
curr_Factors:  [9.99430621e+01 4.16275660e-02]
mat_Sqrt:  [[ 2.03912177e+01  0.00000000e+00]
 [-8.16113384e-03  1.86995068e-02]]
grads:  [7.56275801e-03 1.56832797e+01]
Stock Position:  0.00756275801411321
Bond Position:  [1.57391686]


portfolio before change:  [2.32437604]
curr_Stock_Price:  99.20487062024543
curr_Factors:  [9.92048706e+01 4.29210773e-02]
mat_Sqrt:  [[ 2.05526725e+01  0.00000000e+00]
 [-8.28696107e-03  1.89878132e-02]]
grads:  [-0.0098544  -4.54329876]
Stock Position:  -0.009854397606800363
Bond Position:  [3.30198028]


portfolio before change:  [2.32020712]
curr_Stock_Price:  99.66980988015008
curr_Factors:  [9.96698099e+01 4.24496924e-02]
mat_Sqrt:  [[ 2.05352930e+01  0.00000000e+00]
 [-8.24132925e-03  1.88832576e-02]]
grads:  [ 2.49239738e-02 -3.67532910e+01]
Stock Position:  0.02492397377295485
Bond Position:  [-0.16396061]


portfolio before change:  [2.37419018]
curr_Stock_Price:  101.83654147480786
curr_Factors:  [1.01836541e+02 4.21121892e-02]
mat_Sqrt:  [[ 2.08981360e+01  0.00000000e+00]
 [-8.20850186e-03  1.88080406e-02]]
grads:  [0.00323423 1.47619232]
Stock Position:  0.0032342348741255726
Bond Position:  [2.04482689]


portfolio before change:  [2.37792528]
curr_Stock_Price:  102.91236828681313
curr_Factors:  [1.02912368e+02 4.13100712e-02]
mat_Sqrt:  [[ 2.09168145e+01  0.00000000e+00]
 [-8.12995165e-03  1.86280594e-02]]
grads:  [-0.00633193  3.66617972]
Stock Position:  -0.0063319253724196615
Bond Position:  [3.02955871]


portfolio before change:  [2.37747328]
curr_Stock_Price:  103.0435628487419
curr_Factors:  [1.03043563e+02 3.97798125e-02]
mat_Sqrt:  [[ 2.05519120e+01  0.00000000e+00]
 [-7.97795086e-03  1.82797819e-02]]
grads:  [0.00952942 7.54441759]
Stock Position:  0.009529416041151349
Bond Position:  [1.3955283]


portfolio before change:  [2.36733848]
curr_Stock_Price:  101.96172809308274
curr_Factors:  [1.01961728e+02 4.09473612e-02]
mat_Sqrt:  [[ 2.06324189e+01  0.00000000e+00]
 [-8.09418173e-03  1.85461002e-02]]
grads:  [6.9889389e-03 1.4449182e+01]
Stock Position:  0.006988938899087702
Bond Position:  [1.65473419]


portfolio before change:  [2.37788866]
curr_Stock_Price:  103.44168493484739
curr_Factors:  [1.03441685e+02 3.94747977e-02]
mat_Sqrt:  [[ 2.05520687e+01  0.00000000e+00]
 [-7.94730623e-03  1.82095662e-02]]
grads:  [ 0.01877655 -0.63017794]
Stock Position:  0.018776545132523293
Bond Position:  [0.4356112]


portfolio before change:  [2.39918002]
curr_Stock_Price:  104.57271845261141
curr_Factors:  [1.04572718e+02 3.98724763e-02]
mat_Sqrt:  [[ 2.08811783e+01  0.00000000e+00]
 [-7.98723745e-03  1.83010601e-02]]
grads:  [-0.00623829 -0.11122932]
Stock Position:  -0.006238291292170318
Bond Position:  [3.0515351]


portfolio before change:  [2.4057747]
curr_Stock_Price:  103.57673900081208
curr_Factors:  [1.03576739e+02 4.13635462e-02]
mat_Sqrt:  [[ 2.10654682e+01  0.00000000e+00]
 [-8.13521198e-03  1.86401124e-02]]
grads:  [ 1.60343886e-02 -1.75310498e+01]
Stock Position:  0.016034388607688545
Bond Position:  [0.74498501]


portfolio before change:  [2.3967674]
curr_Stock_Price:  103.00918228479867
curr_Factors:  [1.03009182e+02 4.14370103e-02]
mat_Sqrt:  [[ 2.09686343e+01  0.00000000e+00]
 [-8.14243308e-03  1.86566580e-02]]
grads:  [ 0.00283464 -0.32734336]
Stock Position:  0.002834641116066253
Bond Position:  [2.10477334]


portfolio before change:  [2.39896073]
curr_Stock_Price:  103.69012246951644
curr_Factors:  [1.03690122e+02 4.11561044e-02]
mat_Sqrt:  [[ 2.10355813e+01  0.00000000e+00]
 [-8.11478694e-03  1.85933127e-02]]
grads:  [-9.00037574e-03 -9.43741634e+00]
Stock Position:  -0.009000375743325526
Bond Position:  [3.3322108]


portfolio before change:  [2.41144201]
curr_Stock_Price:  102.34965351927677
curr_Factors:  [1.02349654e+02 4.16115737e-02]
mat_Sqrt:  [[ 2.08782189e+01  0.00000000e+00]
 [-8.15956604e-03  1.86959145e-02]]
grads:  [-5.78556149e-03  8.85389407e+00]
Stock Position:  -0.005785561491227539
Bond Position:  [3.00359222]


portfolio before change:  [2.41581047]
curr_Stock_Price:  101.65948955114844
curr_Factors:  [1.01659490e+02 4.24375281e-02]
mat_Sqrt:  [[ 2.09422319e+01  0.00000000e+00]
 [-8.24014836e-03  1.88805518e-02]]
grads:  [ -0.03790435 -34.58948751]
Stock Position:  -0.037904349366381825
Bond Position:  [6.26914728]


portfolio before change:  [2.50668591]
curr_Stock_Price:  99.2826713692216
curr_Factors:  [9.92826714e+01 4.23552381e-02]
mat_Sqrt:  [[ 2.04327593e+01  0.00000000e+00]
 [-8.23215531e-03  1.88622374e-02]]
grads:  [8.86617237e-03 1.20340611e+01]
Stock Position:  0.008866172372000696
Bond Position:  [1.62642863]


portfolio before change:  [2.50578049]
curr_Stock_Price:  99.15761890252546
curr_Factors:  [9.91576189e+01 4.16032587e-02]
mat_Sqrt:  [[ 2.02250575e+01  0.00000000e+00]
 [-8.15875075e-03  1.86940465e-02]]
grads:  [ 0.00217968 -1.04377252]
Stock Position:  0.002179684104040793
Bond Position:  [2.2896482]


portfolio before change:  [2.50730578]
curr_Stock_Price:  99.72607936074414
curr_Factors:  [9.97260794e+01 4.09208644e-02]
mat_Sqrt:  [[ 2.01734950e+01  0.00000000e+00]
 [-8.09156246e-03  1.85400987e-02]]
grads:  [1.48760373e-03 1.00706655e+01]
Stock Position:  0.001487603730346888
Bond Position:  [2.35895289]


portfolio before change:  [2.50651715]
curr_Stock_Price:  98.99771925569551
curr_Factors:  [9.89977193e+01 3.87087050e-02]
mat_Sqrt:  [[ 1.94773339e+01  0.00000000e+00]
 [-7.86981118e-03  1.80320027e-02]]
grads:  [-5.50355754e-04  1.92162531e+00]
Stock Position:  -0.0005503557539591201
Bond Position:  [2.56100112]


portfolio before change:  [2.50645496]
curr_Stock_Price:  99.69241951781063
curr_Factors:  [9.96924195e+01 3.92973967e-02]
mat_Sqrt:  [[ 1.97625976e+01  0.00000000e+00]
 [-7.92942840e-03  1.81686029e-02]]
grads:  [2.08199006e-03 3.27799197e+00]
Stock Position:  0.002081990060924152
Bond Position:  [2.29889634]


portfolio before change:  [2.50816294]
curr_Stock_Price:  100.37474582441466
curr_Factors:  [1.00374746e+02 3.85880689e-02]
mat_Sqrt:  [[ 1.97174606e+01  0.00000000e+00]
 [-7.85753843e-03  1.80038823e-02]]
grads:  [-3.15950474e-03 -4.51023258e+00]
Stock Position:  -0.0031595047438098024
Bond Position:  [2.82529743]


portfolio before change:  [2.50242709]
curr_Stock_Price:  102.30195774874569
curr_Factors:  [1.02301958e+02 3.65123674e-02]
mat_Sqrt:  [[ 1.95480725e+01  0.00000000e+00]
 [-7.64328384e-03  1.75129634e-02]]
grads:  [0.01431436 7.87846291]
Stock Position:  0.014314364903214676
Bond Position:  [1.03803954]


portfolio before change:  [2.5045128]
curr_Stock_Price:  102.43860019183711
curr_Factors:  [1.02438600e+02 3.71260273e-02]
mat_Sqrt:  [[ 1.97379877e+01  0.00000000e+00]
 [-7.70724618e-03  1.76595195e-02]]
grads:  [2.09504099e-03 5.16996564e+00]
Stock Position:  0.0020950409880232286
Bond Position:  [2.28989974]


portfolio before change:  [2.50348786]
curr_Stock_Price:  101.81274229827174
curr_Factors:  [1.01812742e+02 3.67235007e-02]
mat_Sqrt:  [[ 1.95107593e+01  0.00000000e+00]
 [-7.66535068e-03  1.75635249e-02]]
grads:  [9.32928786e-03 1.93256125e+01]
Stock Position:  0.009329287859298655
Bond Position:  [1.55364748]


portfolio before change:  [2.50059982]
curr_Stock_Price:  101.48235667784859
curr_Factors:  [1.01482357e+02 3.58525729e-02]
mat_Sqrt:  [[ 1.92154566e+01  0.00000000e+00]
 [-7.57391026e-03  1.73540085e-02]]
grads:  [4.76878717e-03 9.43475978e+00]
Stock Position:  0.004768787172043053
Bond Position:  [2.01665206]


portfolio before change:  [2.50766865]
curr_Stock_Price:  102.91180428803634
curr_Factors:  [1.02911804e+02 3.47969977e-02]
mat_Sqrt:  [[ 1.91971200e+01  0.00000000e+00]
 [-7.46158136e-03  1.70966307e-02]]
grads:  [4.17387193e-03 5.27606231e+00]
Stock Position:  0.004173871932020212
Bond Position:  [2.07812795]


portfolio before change:  [2.50804141]
curr_Stock_Price:  102.93887303183234
curr_Factors:  [1.02938873e+02 3.40243143e-02]
mat_Sqrt:  [[ 1.89877760e+01  0.00000000e+00]
 [-7.37827235e-03  1.69057458e-02]]
grads:  [  0.02949612 -23.57215218]
Stock Position:  0.02949611885525787
Bond Position:  [-0.52825583]


portfolio before change:  [2.47077946]
curr_Stock_Price:  101.67782860477722
curr_Factors:  [1.01677829e+02 3.41965935e-02]
mat_Sqrt:  [[ 1.88025904e+01  0.00000000e+00]
 [-7.39692839e-03  1.69484921e-02]]
grads:  [-1.78222058e-03  8.30642238e+00]
Stock Position:  -0.0017822205837666192
Bond Position:  [2.65199178]


portfolio before change:  [2.47208489]
curr_Stock_Price:  101.13136869416081
curr_Factors:  [1.01131369e+02 3.26911282e-02]
mat_Sqrt:  [[ 1.82852473e+01  0.00000000e+00]
 [-7.23227524e-03  1.65712244e-02]]
grads:  [2.49575259e-04 3.92596343e+00]
Stock Position:  0.0002495752589544245
Bond Position:  [2.446845]


portfolio before change:  [2.47282674]
curr_Stock_Price:  102.8782509031829
curr_Factors:  [1.02878251e+02 3.23016748e-02]
mat_Sqrt:  [[ 1.84899651e+01  0.00000000e+00]
 [-7.18906668e-03  1.64722211e-02]]
grads:  [-2.87562299e-03 -5.81277807e+00]
Stock Position:  -0.0028756229909119913
Bond Position:  [2.7686658]


portfolio before change:  [2.47334405]
curr_Stock_Price:  102.81871621412101
curr_Factors:  [1.02818716e+02 3.40959061e-02]
mat_Sqrt:  [[ 1.89855549e+01  0.00000000e+00]
 [-7.38603072e-03  1.69235224e-02]]
grads:  [-0.00508916 -3.41441491]
Stock Position:  -0.0050891644191413616
Bond Position:  [2.9966054]


portfolio before change:  [2.48409155]
curr_Stock_Price:  100.780482137115
curr_Factors:  [1.00780482e+02 3.50804791e-02]
mat_Sqrt:  [[ 1.88759662e+01  0.00000000e+00]
 [-7.49191341e-03  1.71661302e-02]]
grads:  [-0.03333775 -5.5755393 ]
Stock Position:  -0.03333774727277046
Bond Position:  [5.8438858]


portfolio before change:  [2.45000268]
curr_Stock_Price:  101.82492601173244
curr_Factors:  [1.01824926e+02 3.49025646e-02]
mat_Sqrt:  [[ 1.90231649e+01  0.00000000e+00]
 [-7.47289124e-03  1.71225449e-02]]
grads:  [-0.00617811  0.05802938]
Stock Position:  -0.006178114607337845
Bond Position:  [3.07908874]


portfolio before change:  [2.46032864]
curr_Stock_Price:  100.21585057549275
curr_Factors:  [1.00215851e+02 3.43467064e-02]
mat_Sqrt:  [[ 1.85728677e+01  0.00000000e+00]
 [-7.41314577e-03  1.69856508e-02]]
grads:  [0.00396906 0.07276239]
Stock Position:  0.003969059151028182
Bond Position:  [2.062566]


portfolio before change:  [2.46001379]
curr_Stock_Price:  100.07156148355679
curr_Factors:  [1.00071561e+02 3.35101878e-02]
mat_Sqrt:  [[ 1.83188880e+01  0.00000000e+00]
 [-7.32231524e-03  1.67775319e-02]]
grads:  [0.00811922 5.19287953]
Stock Position:  0.008119216646656944
Bond Position:  [1.6475111]


portfolio before change:  [2.46296163]
curr_Stock_Price:  100.40926562824556
curr_Factors:  [1.00409266e+02 3.31911332e-02]
mat_Sqrt:  [[ 1.82929957e+01  0.00000000e+00]
 [-7.28737355e-03  1.66974704e-02]]
grads:  [-0.01731175 -6.70718866]
Stock Position:  -0.017311751111638764
Bond Position:  [4.20122185]


portfolio before change:  [2.46781833]
curr_Stock_Price:  100.15905899700014
curr_Factors:  [1.00159059e+02 3.43615074e-02]
mat_Sqrt:  [[ 1.85663417e+01  0.00000000e+00]
 [-7.41474287e-03  1.69893102e-02]]
grads:  [ -0.02657611 -21.83004001]
Stock Position:  -0.026576110885635905
Bond Position:  [5.12965659]


portfolio before change:  [2.44504067]
curr_Stock_Price:  101.0402604952132
curr_Factors:  [1.01040260e+02 3.41804455e-02]
mat_Sqrt:  [[ 1.86802772e+01  0.00000000e+00]
 [-7.39518172e-03  1.69444900e-02]]
grads:  [1.76672095e-03 1.65029137e+01]
Stock Position:  0.0017667209453281997
Bond Position:  [2.26653073]


portfolio before change:  [2.44708813]
curr_Stock_Price:  102.03879178405766
curr_Factors:  [1.02038792e+02 3.51245421e-02]
mat_Sqrt:  [[ 1.91236437e+01  0.00000000e+00]
 [-7.49661707e-03  1.71769076e-02]]
grads:  [-3.69941795e-03  6.89591067e+00]
Stock Position:  -0.0036994179467933984
Bond Position:  [2.82457227]


portfolio before change:  [2.44514148]
curr_Stock_Price:  102.6604412784477
curr_Factors:  [1.02660441e+02 3.54913368e-02]
mat_Sqrt:  [[ 1.93403490e+01  0.00000000e+00]
 [-7.53565783e-03  1.72663612e-02]]
grads:  [1.30021215e-03 6.25428552e+00]
Stock Position:  0.001300212148621514
Bond Position:  [2.31166113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.44540417]
Stock Price:  102.64021945319243
PL:  [-0.19481529]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 9.30141768e-02  3.75558910e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.24228481e-01 -7.10456993e-01]
 [-4.13012744e-02  1.02552027e-01]
 [ 3.12737886e-02 -6.09517238e-02]
 [-8.16079698e-02 -9.84271259e-02]
 [-9.05508657e-02  1.39071817e-01]
 [-1.11908565e-01 -9.93505441e-02]
 [ 1.60541070e-01  7.56610810e-02]
 [ 1.75215882e-01 -1.54222317e-02]
 [ 1.00642467e-01  1.29289702e-01]
 [ 2.22064305e-02  1.58638267e-01]
 [-1.45512899e-02  1.07915376e-01]
 [-4.05492249e-01 -5.31774460e-01]
 [ 7.95447409e-02  2.24943389e-01]
 [ 5.37421937e-02 -2.02400097e-02]
 [-5.16644506e-02  1.97234157e-01]
 [-3.05683060e-02  3.05545344e-02]
 [ 1.54563729e-02  5.20219807e-02]
 [-1.30900141e-03 -8.83429738e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 2.80358470e-02  2.18287393e-01]
 [ 3.42179705e-02  1.96058498e-01]
 [-7.07839813e-02  1.16024440e-01]
 [ 3.20813438e-02  7.74805444e-02]
 [ 3.40652313e-01 -3.59965169e-02]
 [ 3.22771495e-03  2.15993420e-01]
 [-1.92353383e-01  1.40008005e-01]
 [-2.18253591e-02 -1.25990351e-01]
 [ 4.30751799e-02 -5.63920654e-02]
 [-6.74671787e-01 -8.74964773e-02]
 [-1.17986517e-01  1.98648703e-03]
 [ 8.40747296e-02  2.55808617e-02]
 [ 1.38490789e-01  7.28715055e-02]
 [-2.87793892e-01 -1.79108857e-01]
 [-1.10163071e-01 -4.17669036e-01]
 [-5.65340341e-02  3.02356777e-01]
 [-1.23736580e-01  1.17577308e-01]
 [ 3.31733634e-01  6.33608008e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.91701583]
curr_Stock_Price:  100.18212818892518
curr_Factors:  [1.00182128e+02 4.01197960e-02]
mat_Sqrt:  [[ 2.00664068e+01  0.00000000e+00]
 [-8.01197065e-03  1.83577310e-02]]
grads:  [1.28035640e-02 2.04578066e+01]
Stock Position:  0.01280356399307585
Bond Position:  [2.63432754]


portfolio before change:  [3.90889935]
curr_Stock_Price:  99.52248501159934
curr_Factors:  [9.95224850e+01 4.01465656e-02]
mat_Sqrt:  [[ 1.99409301e+01  0.00000000e+00]
 [-8.01464316e-03  1.83638545e-02]]
grads:  [-0.01017929 -4.79264145]
Stock Position:  -0.010179286873451212
Bond Position:  [4.92196728]


portfolio before change:  [3.9108675]
curr_Stock_Price:  99.38958136071504
curr_Factors:  [9.93895814e+01 4.01662099e-02]
mat_Sqrt:  [[ 1.99191723e+01  0.00000000e+00]
 [-8.01660376e-03  1.83683468e-02]]
grads:  [ 2.58122989e-02 -3.86783308e+01]
Stock Position:  0.025812298870663705
Bond Position:  [1.34539392]


portfolio before change:  [3.89729157]
curr_Stock_Price:  98.85711739329693
curr_Factors:  [9.88571174e+01 4.15688016e-02]
mat_Sqrt:  [[ 2.01554127e+01  0.00000000e+00]
 [-8.15537139e-03  1.86863034e-02]]
grads:  [1.71472516e-04 5.48808529e+00]
Stock Position:  0.0001714725162650724
Bond Position:  [3.88034029]


portfolio before change:  [3.89759403]
curr_Stock_Price:  97.7921597704827
curr_Factors:  [9.77921598e+01 4.18239096e-02]
mat_Sqrt:  [[ 1.99993717e+01  0.00000000e+00]
 [-8.18035790e-03  1.87435546e-02]]
grads:  [ 2.33621111e-04 -3.25187644e+00]
Stock Position:  0.00023362111098106274
Bond Position:  [3.87474772]


portfolio before change:  [3.89821573]
curr_Stock_Price:  98.3799719468938
curr_Factors:  [9.83799719e+01 4.12979183e-02]
mat_Sqrt:  [[ 1.99926689e+01  0.00000000e+00]
 [-8.12875570e-03  1.86253192e-02]]
grads:  [-0.00623054 -5.28458735]
Stock Position:  -0.006230538287764053
Bond Position:  [4.51117591]


portfolio before change:  [3.90364207]
curr_Stock_Price:  97.59955693612243
curr_Factors:  [9.75995569e+01 4.10297295e-02]
mat_Sqrt:  [[ 1.97695677e+01  0.00000000e+00]
 [-8.10231863e-03  1.85647442e-02]]
grads:  [-1.51014676e-03  7.49117875e+00]
Stock Position:  -0.0015101467556090423
Bond Position:  [4.05103172]


portfolio before change:  [3.90339138]
curr_Stock_Price:  98.10089925426465
curr_Factors:  [9.81008993e+01 4.01216809e-02]
mat_Sqrt:  [[ 1.96499997e+01  0.00000000e+00]
 [-8.01215885e-03  1.83581622e-02]]
grads:  [-0.00790172 -5.41179139]
Stock Position:  -0.007901715004455424
Bond Position:  [4.67855673]


portfolio before change:  [3.89440896]
curr_Stock_Price:  99.31168327205557
curr_Factors:  [9.93116833e+01 4.01003104e-02]
mat_Sqrt:  [[ 1.98872260e+01  0.00000000e+00]
 [-8.01002476e-03  1.83532724e-02]]
grads:  [0.009733  4.1224845]
Stock Position:  0.009732995055662594
Bond Position:  [2.92780884]


portfolio before change:  [3.8896585]
curr_Stock_Price:  98.78600092791231
curr_Factors:  [9.87860009e+01 3.98890528e-02]
mat_Sqrt:  [[ 1.97297811e+01  0.00000000e+00]
 [-7.98889757e-03  1.83048639e-02]]
grads:  [ 0.00853963 -0.84252097]
Stock Position:  0.008539631930339613
Bond Position:  [3.04606241]


portfolio before change:  [3.89659604]
curr_Stock_Price:  99.55380471776797
curr_Factors:  [9.95538047e+01 4.00972593e-02]
mat_Sqrt:  [[ 1.99349526e+01  0.00000000e+00]
 [-8.00972003e-03  1.83525742e-02]]
grads:  [0.00787908 7.04477207]
Stock Position:  0.007879081634398972
Bond Position:  [3.11220349]


portfolio before change:  [3.89140038]
curr_Stock_Price:  98.8450026794929
curr_Factors:  [9.88450027e+01 4.13006198e-02]
mat_Sqrt:  [[ 2.00878290e+01  0.00000000e+00]
 [-8.12902157e-03  1.86259283e-02]]
grads:  [4.55210200e-03 8.51706633e+00]
Stock Position:  0.004552102002505241
Bond Position:  [3.44144785]


portfolio before change:  [3.89778189]
curr_Stock_Price:  100.1523774316018
curr_Factors:  [1.00152377e+02 4.07001206e-02]
mat_Sqrt:  [[ 2.02050119e+01  0.00000000e+00]
 [-8.06970835e-03  1.84900247e-02]]
grads:  [1.61083010e-03 5.83641058e+00]
Stock Position:  0.0016108300994371772
Bond Position:  [3.73645343]


portfolio before change:  [3.89873368]
curr_Stock_Price:  100.4532774051268
curr_Factors:  [1.00453277e+02 3.97090090e-02]
mat_Sqrt:  [[ 2.00174446e+01  0.00000000e+00]
 [-7.97084778e-03  1.82635067e-02]]
grads:  [ -0.0318511  -29.11677753]
Stock Position:  -0.03185110109083183
Bond Position:  [7.09828117]


portfolio before change:  [3.9151705]
curr_Stock_Price:  99.9650843861817
curr_Factors:  [9.99650844e+01 3.80916918e-02]
mat_Sqrt:  [[ 1.95102784e+01  0.00000000e+00]
 [-7.80683718e-03  1.78877112e-02]]
grads:  [9.10894658e-03 1.25753030e+01]
Stock Position:  0.009108946583186586
Bond Position:  [3.00459389]


portfolio before change:  [3.91936191]
curr_Stock_Price:  100.38399239795578
curr_Factors:  [1.00383992e+02 3.73469596e-02]
mat_Sqrt:  [[ 1.93995694e+01  0.00000000e+00]
 [-7.73014459e-03  1.77119864e-02]]
grads:  [ 0.00231493 -1.14272952]
Stock Position:  0.002314934335515079
Bond Position:  [3.68697956]


portfolio before change:  [3.91859609]
curr_Stock_Price:  99.85407314274907
curr_Factors:  [9.98540731e+01 3.73651605e-02]
mat_Sqrt:  [[ 1.93018622e+01  0.00000000e+00]
 [-7.73202799e-03  1.77163018e-02]]
grads:  [1.78301930e-03 1.11329193e+01]
Stock Position:  0.0017830192973681584
Bond Position:  [3.74055435]


portfolio before change:  [3.91779718]
curr_Stock_Price:  99.14375997964122
curr_Factors:  [9.91437600e+01 3.72553203e-02]
mat_Sqrt:  [[ 1.91363690e+01  0.00000000e+00]
 [-7.72065493e-03  1.76902428e-02]]
grads:  [-9.00547745e-04  1.72719700e+00]
Stock Position:  -0.0009005477449458674
Bond Position:  [4.00708087]


portfolio before change:  [3.91861949]
curr_Stock_Price:  98.78687425041464
curr_Factors:  [9.87868743e+01 3.63794988e-02]
mat_Sqrt:  [[ 1.88420261e+01  0.00000000e+00]
 [-7.62936420e-03  1.74810695e-02]]
grads:  [2.02529317e-03 2.97590378e+00]
Stock Position:  0.0020252931659869803
Bond Position:  [3.71854711]


portfolio before change:  [3.92115064]
curr_Stock_Price:  99.80712322542259
curr_Factors:  [9.98071232e+01 3.53533293e-02]
mat_Sqrt:  [[ 1.87662154e+01  0.00000000e+00]
 [-7.52099241e-03  1.72327585e-02]]
grads:  [-2.12429812e-03 -5.12645574e+00]
Stock Position:  -0.0021242981219843637
Bond Position:  [4.13317073]


portfolio before change:  [3.92558766]
curr_Stock_Price:  97.96164639537035
curr_Factors:  [9.79616464e+01 3.56514364e-02]
mat_Sqrt:  [[ 1.84967144e+01  0.00000000e+00]
 [-7.55263518e-03  1.73052612e-02]]
grads:  [ 0.00227763 -2.18303493]
Stock Position:  0.002277626697998303
Bond Position:  [3.7024676]


portfolio before change:  [3.92363409]
curr_Stock_Price:  96.90071312666112
curr_Factors:  [9.69007131e+01 3.58656857e-02]
mat_Sqrt:  [[ 1.83512876e+01  0.00000000e+00]
 [-7.57529518e-03  1.73571818e-02]]
grads:  [6.71910757e-03 1.25762002e+01]
Stock Position:  0.006719107574282685
Bond Position:  [3.27254778]


portfolio before change:  [3.92524954]
curr_Stock_Price:  97.08025463322824
curr_Factors:  [9.70802546e+01 3.60068984e-02]
mat_Sqrt:  [[ 1.84214480e+01  0.00000000e+00]
 [-7.59019351e-03  1.73913181e-02]]
grads:  [6.50247006e-03 1.12733547e+01]
Stock Position:  0.006502470064061289
Bond Position:  [3.29398809]


portfolio before change:  [3.93219087]
curr_Stock_Price:  98.08441999886958
curr_Factors:  [9.8084420e+01 3.4631732e-02]
mat_Sqrt:  [[ 1.82531211e+01  0.00000000e+00]
 [-7.44384116e-03  1.70559828e-02]]
grads:  [-1.10374353e-03  6.80256551e+00]
Stock Position:  -0.001103743526243893
Bond Position:  [4.04045092]


portfolio before change:  [3.93269647]
curr_Stock_Price:  98.08396055147048
curr_Factors:  [9.80839606e+01 3.48859621e-02]
mat_Sqrt:  [[ 1.83199105e+01  0.00000000e+00]
 [-7.47111367e-03  1.71184719e-02]]
grads:  [3.59699497e-03 4.52613672e+00]
Stock Position:  0.0035969949668653274
Bond Position:  [3.57988896]


portfolio before change:  [3.93342663]
curr_Stock_Price:  98.16253964662337
curr_Factors:  [9.81625396e+01 3.55781319e-02]
mat_Sqrt:  [[ 1.85155815e+01  0.00000000e+00]
 [-7.54486653e-03  1.72874610e-02]]
grads:  [ 0.01754966 -2.08223272]
Stock Position:  0.017549659162858715
Bond Position:  [2.21070752]


portfolio before change:  [3.92911646]
curr_Stock_Price:  97.90119401830573
curr_Factors:  [9.79011940e+01 3.64605365e-02]
mat_Sqrt:  [[ 1.86938828e+01  0.00000000e+00]
 [-7.63785692e-03  1.75005287e-02]]
grads:  [5.21534092e-03 1.23421083e+01]
Stock Position:  0.005215340917783461
Bond Position:  [3.41852836]


portfolio before change:  [3.92997797]
curr_Stock_Price:  97.98444258045835
curr_Factors:  [9.79844426e+01 3.54605216e-02]
mat_Sqrt:  [[ 1.84514154e+01  0.00000000e+00]
 [-7.53238571e-03  1.72588639e-02]]
grads:  [-7.11321474e-03  8.11223767e+00]
Stock Position:  -0.007113214736986993
Bond Position:  [4.62696235]


portfolio before change:  [3.92246664]
curr_Stock_Price:  99.12172520602805
curr_Factors:  [9.91217252e+01 3.52210707e-02]
mat_Sqrt:  [[ 1.86024493e+01  0.00000000e+00]
 [-7.50691102e-03  1.72004940e-02]]
grads:  [-4.12913671e-03 -7.32481002e+00]
Stock Position:  -0.004129136705792838
Bond Position:  [4.3317538]


portfolio before change:  [3.92344271]
curr_Stock_Price:  99.01648302674853
curr_Factors:  [9.90164830e+01 3.56053034e-02]
mat_Sqrt:  [[ 1.86837842e+01  0.00000000e+00]
 [-7.54774704e-03  1.72940611e-02]]
grads:  [ 9.88218694e-04 -3.26077636e+00]
Stock Position:  0.0009882186939168423
Bond Position:  [3.82559277]


portfolio before change:  [3.92473192]
curr_Stock_Price:  99.83713464237113
curr_Factors:  [9.98371346e+01 3.61227367e-02]
mat_Sqrt:  [[ 1.89750282e+01  0.00000000e+00]
 [-7.60239296e-03  1.74192706e-02]]
grads:  [-0.03756824 -5.02297021]
Stock Position:  -0.03756823819850636
Bond Position:  [7.67543717]


portfolio before change:  [3.8677275]
curr_Stock_Price:  101.38003136642672
curr_Factors:  [1.01380031e+02 3.68975289e-02]
mat_Sqrt:  [[ 1.94738160e+01  0.00000000e+00]
 [-7.68349180e-03  1.76050914e-02]]
grads:  [-0.00601421  0.11283594]
Stock Position:  -0.006014206088793033
Bond Position:  [4.4774479]


portfolio before change:  [3.87383821]
curr_Stock_Price:  100.4570498686551
curr_Factors:  [1.00457050e+02 3.60916849e-02]
mat_Sqrt:  [[ 1.90846412e+01  0.00000000e+00]
 [-7.59912467e-03  1.74117820e-02]]
grads:  [0.00499035 1.46916965]
Stock Position:  0.00499035492427623
Bond Position:  [3.37252188]


portfolio before change:  [3.87665969]
curr_Stock_Price:  100.93795519132021
curr_Factors:  [1.00937955e+02 3.55704568e-02]
mat_Sqrt:  [[ 1.90370313e+01  0.00000000e+00]
 [-7.54405269e-03  1.72855962e-02]]
grads:  [0.00894543 4.21573572]
Stock Position:  0.008945434758187445
Bond Position:  [2.9737258]


portfolio before change:  [3.88170205]
curr_Stock_Price:  101.46007879442374
curr_Factors:  [1.01460079e+02 3.60117710e-02]
mat_Sqrt:  [[ 1.92538434e+01  0.00000000e+00]
 [-7.59070706e-03  1.73924948e-02]]
grads:  [ -0.01900729 -10.29805432]
Stock Position:  -0.019007291066391787
Bond Position:  [5.8101833]


portfolio before change:  [3.87858598]
curr_Stock_Price:  101.66223235691706
curr_Factors:  [1.01662232e+02 3.45389366e-02]
mat_Sqrt:  [[ 1.88935742e+01  0.00000000e+00]
 [-7.43386162e-03  1.70331168e-02]]
grads:  [-1.54787432e-02 -2.45209987e+01]
Stock Position:  -0.015478743159016652
Bond Position:  [5.45218957]


portfolio before change:  [3.90923304]
curr_Stock_Price:  99.72631999222219
curr_Factors:  [9.97263200e+01 3.51984646e-02]
mat_Sqrt:  [[ 1.87099081e+01  0.00000000e+00]
 [-7.50450154e-03  1.71949732e-02]]
grads:  [4.03130158e-03 1.75840214e+01]
Stock Position:  0.004031301576878106
Bond Position:  [3.50720617]


portfolio before change:  [3.90999809]
curr_Stock_Price:  99.80734109673196
curr_Factors:  [9.98073411e+01 3.53182222e-02]
mat_Sqrt:  [[ 1.87569363e+01  0.00000000e+00]
 [-7.51725719e-03  1.72242000e-02]]
grads:  [-3.86105890e-03  6.82628555e+00]
Stock Position:  -0.003861058903968371
Bond Position:  [4.29536011]


portfolio before change:  [3.90870125]
curr_Stock_Price:  100.28228575553777
curr_Factors:  [1.00282286e+02 3.62535945e-02]
mat_Sqrt:  [[ 1.90941250e+01  0.00000000e+00]
 [-7.61615068e-03  1.74507935e-02]]
grads:  [0.01882184 3.63082635]
Stock Position:  0.01882183946058264
Bond Position:  [2.02120417]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.90537551]
Stock Price:  100.09216577237464
PL:  [3.81320974]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-9.86566025e-02  1.37783246e-01]
 [-1.64752454e-01 -8.70055495e-02]
 [ 8.50975965e-01 -7.70015287e-01]
 [-2.59282835e-02  1.74481760e-01]
 [ 3.35773809e-02 -5.45051860e-02]
 [-8.13156333e-02 -9.96199234e-02]
 [-8.66158092e-02  1.44412873e-01]
 [-1.09642348e-02 -1.26486531e-01]
 [ 1.65688622e-01  1.11083540e-01]
 [ 1.52261898e-01  1.67697418e-02]
 [ 1.36443953e-01  2.56923660e-01]
 [ 1.85336680e-01  2.48815378e-01]
 [ 1.93046505e-01  2.61372129e-02]
 [-9.39773900e-02 -6.18072264e-02]
 [ 9.72220876e-02  2.39051412e-01]
 [ 4.05456690e-02  1.27945467e-01]
 [ 1.38492514e-01  3.41206116e-01]
 [ 1.57748826e-01  7.36822513e-02]
 [ 3.57694078e-02 -6.93295008e-02]
 [ 4.45674529e-01 -1.24907927e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-3.80761899e-02  1.10049481e-01]
 [-3.01440665e-02 -9.87840814e-02]
 [ 2.82402600e-02 -1.29315761e-01]
 [ 3.19670486e-02  1.53878923e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 6.32793914e-02  1.68200678e-01]
 [-1.59978639e-01  9.23479227e-02]
 [-3.12233856e-01  1.94869316e-02]
 [ 2.06350698e-01 -9.45273019e-02]
 [-1.31504986e+00 -1.47420375e-01]
 [ 1.31278800e-01  3.60985281e-01]
 [-4.57569467e-03 -1.29187595e-01]
 [-8.95132401e-03  5.96859298e-02]
 [-3.63540334e-02  1.66180643e-01]
 [-1.73866938e+00 -6.27475259e-02]
 [-9.17405982e-02  2.01992351e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 9.98354815e-01 -1.55099359e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.6415363]
curr_Stock_Price:  99.49553645619287
curr_Factors:  [9.94955365e+01 3.90938217e-02]
mat_Sqrt:  [[ 1.96724143e+01  0.00000000e+00]
 [-7.90886305e-03  1.81214818e-02]]
grads:  [-1.95822756e-03  7.60331014e+00]
Stock Position:  -0.001958227561498151
Bond Position:  [-0.4467014]


portfolio before change:  [-0.64257809]
curr_Stock_Price:  99.99902775330992
curr_Factors:  [9.99990278e+01 3.96650288e-02]
mat_Sqrt:  [[ 1.99158875e+01  0.00000000e+00]
 [-7.96643245e-03  1.82533899e-02]]
grads:  [-0.01017905 -4.766542  ]
Stock Position:  -0.010179048699269614
Bond Position:  [0.37531688]


portfolio before change:  [-0.62685315]
curr_Stock_Price:  98.4588023076114
curr_Factors:  [9.84588023e+01 3.94497340e-02]
mat_Sqrt:  [[ 1.95558451e+01  0.00000000e+00]
 [-7.94478285e-03  1.82037844e-02]]
grads:  [ 2.63304265e-02 -4.22997367e+01]
Stock Position:  0.02633042650598145
Bond Position:  [-3.2193154]


portfolio before change:  [-0.64465022]
curr_Stock_Price:  97.7981736143247
curr_Factors:  [9.77981736e+01 3.93374554e-02]
mat_Sqrt:  [[ 1.93969692e+01  0.00000000e+00]
 [-7.93346889e-03  1.81778609e-02]]
grads:  [2.58915706e-03 9.59858597e+00]
Stock Position:  0.002589157056774092
Bond Position:  [-0.89786505]


portfolio before change:  [-0.64431516]
curr_Stock_Price:  97.97093317655113
curr_Factors:  [9.79709332e+01 3.85840069e-02]
mat_Sqrt:  [[ 1.92442464e+01  0.00000000e+00]
 [-7.85712485e-03  1.80029347e-02]]
grads:  [ 5.08690615e-04 -3.02757228e+00]
Stock Position:  0.0005086906153574179
Bond Position:  [-0.69415205]


portfolio before change:  [-0.6442809]
curr_Stock_Price:  98.20885871049244
curr_Factors:  [9.82088587e+01 3.72642818e-02]
mat_Sqrt:  [[ 1.89581974e+01  0.00000000e+00]
 [-7.72158344e-03  1.76923703e-02]]
grads:  [-0.00658255 -5.6306714 ]
Stock Position:  -0.006582552628658608
Bond Position:  [0.00218408]


portfolio before change:  [-0.64104474]
curr_Stock_Price:  97.71727253119285
curr_Factors:  [9.77172725e+01 3.84434363e-02]
mat_Sqrt:  [[ 1.91594235e+01  0.00000000e+00]
 [-7.84279913e-03  1.79701103e-02]]
grads:  [-1.23118863e-03  8.03628193e+00]
Stock Position:  -0.0012311886290503893
Bond Position:  [-0.52073634]


portfolio before change:  [-0.64006319]
curr_Stock_Price:  96.86716250852682
curr_Factors:  [9.68671625e+01 3.96398546e-02]
mat_Sqrt:  [[ 1.92860197e+01  0.00000000e+00]
 [-7.96390403e-03  1.82475965e-02]]
grads:  [-3.43085218e-03 -6.93168170e+00]
Stock Position:  -0.0034308521814370376
Bond Position:  [-0.30772627]


portfolio before change:  [-0.64107969]
curr_Stock_Price:  97.15223157006412
curr_Factors:  [9.71522316e+01 4.08171485e-02]
mat_Sqrt:  [[ 1.96279124e+01  0.00000000e+00]
 [-8.08130172e-03  1.85165884e-02]]
grads:  [0.01091147 5.99913641]
Stock Position:  0.010911473895256048
Bond Position:  [-1.70115373]


portfolio before change:  [-0.62775924]
curr_Stock_Price:  98.39249518483528
curr_Factors:  [9.83924952e+01 4.01143823e-02]
mat_Sqrt:  [[ 1.97066149e+01  0.00000000e+00]
 [-8.01143007e-03  1.83564924e-02]]
grads:  [0.00809783 0.91355916]
Stock Position:  0.008097829840436645
Bond Position:  [-1.42452492]


portfolio before change:  [-0.63282495]
curr_Stock_Price:  97.78892254955214
curr_Factors:  [9.77889225e+01 3.96920060e-02]
mat_Sqrt:  [[ 1.94823430e+01  0.00000000e+00]
 [-7.96914108e-03  1.82595961e-02]]
grads:  [1.27589701e-02 1.40706103e+01]
Stock Position:  0.012758970084560535
Bond Position:  [-1.88051088]


portfolio before change:  [-0.64397114]
curr_Stock_Price:  96.93375025494052
curr_Factors:  [9.69337503e+01 3.92326526e-02]
mat_Sqrt:  [[ 1.91998949e+01  0.00000000e+00]
 [-7.92289367e-03  1.81536300e-02]]
grads:  [ 0.01530887 13.70609505]
Stock Position:  0.015308865756524844
Bond Position:  [-2.12791691]


portfolio before change:  [-0.64054329]
curr_Stock_Price:  97.17503927154596
curr_Factors:  [9.71750393e+01 3.92198715e-02]
mat_Sqrt:  [[ 1.92445521e+01  0.00000000e+00]
 [-7.92160302e-03  1.81506727e-02]]
grads:  [0.01062398 1.44001345]
Stock Position:  0.010623979112649817
Bond Position:  [-1.67292888]


portfolio before change:  [-0.65502057]
curr_Stock_Price:  95.83202494749231
curr_Factors:  [9.58320249e+01 3.97990195e-02]
mat_Sqrt:  [[ 1.91181934e+01  0.00000000e+00]
 [-7.97987664e-03  1.82841944e-02]]
grads:  [-0.00632655 -3.38036367]
Stock Position:  -0.006326553575519552
Bond Position:  [-0.04873413]


portfolio before change:  [-0.65134305]
curr_Stock_Price:  95.2497780833478
curr_Factors:  [9.52497781e+01 3.91388806e-02]
mat_Sqrt:  [[ 1.88437864e+01  0.00000000e+00]
 [-7.91341955e-03  1.81319221e-02]]
grads:  [1.06959755e-02 1.31840084e+01]
Stock Position:  0.010695975473540878
Bond Position:  [-1.67013234]


portfolio before change:  [-0.65154748]
curr_Stock_Price:  95.25018452163185
curr_Factors:  [9.52501845e+01 3.90216824e-02]
mat_Sqrt:  [[ 1.88156324e+01  0.00000000e+00]
 [-7.90156262e-03  1.81047544e-02]]
grads:  [5.12263667e-03 7.06695402e+00]
Stock Position:  0.005122636668393479
Bond Position:  [-1.13947957]


portfolio before change:  [-0.65850485]
curr_Stock_Price:  93.91982947785822
curr_Factors:  [9.39198295e+01 3.98322466e-02]
mat_Sqrt:  [[ 1.87445361e+01  0.00000000e+00]
 [-7.98320703e-03  1.82918253e-02]]
grads:  [1.53328453e-02 1.86534756e+01]
Stock Position:  0.015332845254618943
Bond Position:  [-2.09856306]


portfolio before change:  [-0.67775572]
curr_Stock_Price:  92.68140730386132
curr_Factors:  [9.26814073e+01 4.02088780e-02]
mat_Sqrt:  [[ 1.85846162e+01  0.00000000e+00]
 [-8.02086060e-03  1.83781004e-02]]
grads:  [0.01021847 4.00924196]
Stock Position:  0.010218472891623365
Bond Position:  [-1.62481817]


portfolio before change:  [-0.66909331]
curr_Stock_Price:  93.5490052858619
curr_Factors:  [9.35490053e+01 3.79600004e-02]
mat_Sqrt:  [[ 1.82264580e+01  0.00000000e+00]
 [-7.79333053e-03  1.78567635e-02]]
grads:  [ 3.02391886e-04 -3.88253452e+00]
Stock Position:  0.00030239188603540097
Bond Position:  [-0.69738177]


portfolio before change:  [-0.66933091]
curr_Stock_Price:  93.05155775288162
curr_Factors:  [9.30515578e+01 3.77880201e-02]
mat_Sqrt:  [[ 1.80884235e+01  0.00000000e+00]
 [-7.77565638e-03  1.78162670e-02]]
grads:  [ 0.02162489 -7.0108922 ]
Stock Position:  0.021624894025554633
Bond Position:  [-2.68156099]


portfolio before change:  [-0.68051523]
curr_Stock_Price:  92.54986293210771
curr_Factors:  [9.25498629e+01 3.67385403e-02]
mat_Sqrt:  [[ 1.77393102e+01  0.00000000e+00]
 [-7.66692015e-03  1.75671210e-02]]
grads:  [ 0.00237487 -2.15049408]
Stock Position:  0.0023748730985475065
Bond Position:  [-0.90030941]


portfolio before change:  [-0.67675198]
curr_Stock_Price:  94.18186468844803
curr_Factors:  [9.41818647e+01 3.58741556e-02]
mat_Sqrt:  [[ 1.78384916e+01  0.00000000e+00]
 [-7.57618961e-03  1.73592312e-02]]
grads:  [5.57969887e-04 6.33953657e+00]
Stock Position:  0.0005579698873744713
Bond Position:  [-0.72930262]


portfolio before change:  [-0.67714691]
curr_Stock_Price:  93.63744683032486
curr_Factors:  [9.36374468e+01 3.67408653e-02]
mat_Sqrt:  [[ 1.79483386e+01  0.00000000e+00]
 [-7.66716274e-03  1.75676768e-02]]
grads:  [-4.08154626e-03 -5.62305889e+00]
Stock Position:  -0.0040815462566056926
Bond Position:  [-0.29496134]


portfolio before change:  [-0.67510548]
curr_Stock_Price:  93.12825027535513
curr_Factors:  [9.31282503e+01 3.73181812e-02]
mat_Sqrt:  [[ 1.79904356e+01  0.00000000e+00]
 [-7.72716571e-03  1.77051609e-02]]
grads:  [-1.56737535e-03 -7.30384558e+00]
Stock Position:  -0.0015673753454384142
Bond Position:  [-0.52913855]


portfolio before change:  [-0.67576972]
curr_Stock_Price:  93.50983913302152
curr_Factors:  [9.35098391e+01 3.64595013e-02]
mat_Sqrt:  [[ 1.78551158e+01  0.00000000e+00]
 [-7.63774850e-03  1.75002803e-02]]
grads:  [5.55164790e-03 8.79294045e+00]
Stock Position:  0.005551647902279307
Bond Position:  [-1.19490342]


portfolio before change:  [-0.683891]
curr_Stock_Price:  92.07388572906427
curr_Factors:  [9.20738857e+01 3.86776285e-02]
mat_Sqrt:  [[ 1.81078293e+01  0.00000000e+00]
 [-7.86665149e-03  1.80247630e-02]]
grads:  [6.92985553e-03 1.01010216e+01]
Stock Position:  0.006929855528932489
Bond Position:  [-1.32194972]


portfolio before change:  [-0.68371861]
curr_Stock_Price:  92.12260765029133
curr_Factors:  [9.21226077e+01 3.92737042e-02]
mat_Sqrt:  [[ 1.82564846e+01  0.00000000e+00]
 [-7.92703770e-03  1.81631252e-02]]
grads:  [7.48710327e-03 9.26055823e+00]
Stock Position:  0.007487103274174424
Bond Position:  [-1.37345009]


portfolio before change:  [-0.67155933]
curr_Stock_Price:  93.76956994258272
curr_Factors:  [9.37695699e+01 3.71145187e-02]
mat_Sqrt:  [[ 1.80648284e+01  0.00000000e+00]
 [-7.70605152e-03  1.76567822e-02]]
grads:  [-0.00662473  5.23016718]
Stock Position:  -0.006624734989762415
Bond Position:  [-0.05036078]


portfolio before change:  [-0.67712932]
curr_Stock_Price:  94.60940608393382
curr_Factors:  [9.46094061e+01 3.64468375e-02]
mat_Sqrt:  [[ 1.80619336e+01  0.00000000e+00]
 [-7.63642194e-03  1.74972408e-02]]
grads:  [-0.01681598  1.11371455]
Stock Position:  -0.01681597707660434
Bond Position:  [0.91382029]


portfolio before change:  [-0.67687462]
curr_Stock_Price:  94.60105343404915
curr_Factors:  [9.46010534e+01 3.49090624e-02]
mat_Sqrt:  [[ 1.76752296e+01  0.00000000e+00]
 [-7.47358681e-03  1.71241386e-02]]
grads:  [ 0.00934051 -5.5201201 ]
Stock Position:  0.009340506701487967
Bond Position:  [-1.5604964]


portfolio before change:  [-0.68724928]
curr_Stock_Price:  93.51122188841381
curr_Factors:  [9.35112219e+01 3.44791160e-02]
mat_Sqrt:  [[ 1.73636808e+01  0.00000000e+00]
 [-7.42742120e-03  1.70183599e-02]]
grads:  [-0.07944107 -8.66243138]
Stock Position:  -0.07944107038525151
Bond Position:  [6.74138228]


portfolio before change:  [-0.67853887]
curr_Stock_Price:  93.41218390010471
curr_Factors:  [9.34121839e+01 3.44454193e-02]
mat_Sqrt:  [[ 1.73368129e+01  0.00000000e+00]
 [-7.42379087e-03  1.70100418e-02]]
grads:  [1.66596764e-02 2.12218927e+01]
Stock Position:  0.016659676350837198
Bond Position:  [-2.23475562]


portfolio before change:  [-0.6792489]
curr_Stock_Price:  93.38633270956538
curr_Factors:  [9.33863327e+01 3.54872699e-02]
mat_Sqrt:  [[ 1.75921782e+01  0.00000000e+00]
 [-7.53522607e-03  1.72653719e-02]]
grads:  [-3.46505035e-03 -7.48246810e+00]
Stock Position:  -0.003465050354026919
Bond Position:  [-0.35566056]


portfolio before change:  [-0.67674749]
curr_Stock_Price:  92.65160440675174
curr_Factors:  [9.26516044e+01 3.73305895e-02]
mat_Sqrt:  [[ 1.79013329e+01  0.00000000e+00]
 [-7.72845024e-03  1.77081041e-02]]
grads:  [9.55110522e-04 3.37054320e+00]
Stock Position:  0.0009551105215922529
Bond Position:  [-0.76524001]


portfolio before change:  [-0.67592244]
curr_Stock_Price:  93.6155856902397
curr_Factors:  [9.36155857e+01 3.60778215e-02]
mat_Sqrt:  [[ 1.77814966e+01  0.00000000e+00]
 [-7.59766507e-03  1.74084376e-02]]
grads:  [2.03431387e-03 9.54598262e+00]
Stock Position:  0.002034313873101633
Bond Position:  [-0.86636593]


portfolio before change:  [-0.67629447]
curr_Stock_Price:  93.48594939240543
curr_Factors:  [9.34859494e+01 3.72227903e-02]
mat_Sqrt:  [[ 1.80364394e+01  0.00000000e+00]
 [-7.71728349e-03  1.76825179e-02]]
grads:  [-0.09791593 -3.54856284]
Stock Position:  -0.0979159250531249
Bond Position:  [8.47746875]


portfolio before change:  [-0.63961589]
curr_Stock_Price:  93.12217983682231
curr_Factors:  [9.31221798e+01 3.85276792e-02]
mat_Sqrt:  [[ 1.82784581e+01  0.00000000e+00]
 [-7.85138756e-03  1.79897889e-02]]
grads:  [-1.96072821e-04  1.12281668e+01]
Stock Position:  -0.00019607282100540484
Bond Position:  [-0.62135716]


portfolio before change:  [-0.63979564]
curr_Stock_Price:  93.64280550474577
curr_Factors:  [9.36428055e+01 3.82258445e-02]
mat_Sqrt:  [[ 1.83085083e+01  0.00000000e+00]
 [-7.82057230e-03  1.79191823e-02]]
grads:  [-4.81662482e-03  6.10305552e+00]
Stock Position:  -0.004816624816226948
Bond Position:  [-0.18875338]


portfolio before change:  [-0.64821046]
curr_Stock_Price:  95.38494230710347
curr_Factors:  [9.53849423e+01 3.87604721e-02]
mat_Sqrt:  [[ 1.87790817e+01  0.00000000e+00]
 [-7.87507177e-03  1.80440562e-02]]
grads:  [ 0.05280267 -0.85955927]
Stock Position:  0.05280267383313105
Bond Position:  [-5.68479045]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.72943402]
Stock Price:  93.86015365596472
PL:  [-0.72943402]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.54648984e-01 -1.59524632e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.27397901e-01 -7.15823803e-01]
 [ 1.85926888e-02  2.32720865e-02]
 [ 2.28784680e-02 -5.79625344e-03]
 [-2.16335252e-02 -1.61437268e-03]
 [-5.47132915e-03  3.01016793e-01]
 [ 1.14708987e-01 -3.33159390e-02]
 [ 1.60212289e-01  7.50324741e-02]
 [ 1.36495917e-01  3.85550358e-02]
 [ 1.19288058e-01  1.95756263e-01]
 [-3.79877434e-02  9.78477472e-02]
 [ 1.74566592e-01  3.02811997e-02]
 [-2.46288927e-01 -3.34601867e-01]
 [ 8.59170671e-02  2.30032548e-01]
 [ 5.23633568e-02 -1.93614801e-02]
 [-5.15016427e-02  1.88082197e-01]
 [-3.29659936e-02  2.84763665e-02]
 [ 1.34564076e-02  4.24952644e-02]
 [ 2.31276477e-01 -1.08225931e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 6.00361236e-02  2.62912014e-01]
 [ 2.69110118e-02  1.53257949e-01]
 [-5.95539558e-02  5.52480186e-02]
 [ 5.38187790e-02  1.37645078e-01]
 [ 4.53873487e-02  1.52689636e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.73091992e-01  1.21807264e-01]
 [-1.78132533e-01 -4.78811142e-02]
 [ 1.09755826e-01 -7.19750654e-02]
 [-8.50867130e-01 -1.01689027e-01]
 [-1.19626366e-01  2.36360815e-02]
 [-9.19604094e-03 -9.17381188e-02]
 [ 6.22787498e-02  9.47639465e-02]
 [-7.22635867e-02  1.59784833e-01]
 [-9.11645647e-01 -2.31314391e-01]
 [-2.02253558e-02  3.13223643e-01]
 [-1.33270232e-01  1.11145711e-01]
 [ 5.12203296e-01  4.26623026e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.22861732]
curr_Stock_Price:  98.65403162645626
curr_Factors:  [9.86540316e+01 3.96039208e-02]
mat_Sqrt:  [[ 1.96328763e+01  0.00000000e+00]
 [-7.96029354e-03  1.82393239e-02]]
grads:  [-0.02161024 -8.74619222]
Stock Position:  -0.021610243749023976
Bond Position:  [-4.09667965]


portfolio before change:  [-6.23242828]
curr_Stock_Price:  98.80668364381137
curr_Factors:  [9.88066836e+01 3.87308905e-02]
mat_Sqrt:  [[ 1.94453186e+01  0.00000000e+00]
 [-7.87206611e-03  1.80371694e-02]]
grads:  [-0.01043873 -4.87944467]
Stock Position:  -0.010438730872079922
Bond Position:  [-5.2010119]


portfolio before change:  [-6.23849347]
curr_Stock_Price:  99.32542677251816
curr_Factors:  [9.93254268e+01 3.77196178e-02]
mat_Sqrt:  [[ 1.92905265e+01  0.00000000e+00]
 [-7.76861561e-03  1.78001345e-02]]
grads:  [ 2.66963569e-02 -4.02145165e+01]
Stock Position:  0.026696356902093123
Bond Position:  [-8.89012051]


portfolio before change:  [-6.19744427]
curr_Stock_Price:  100.90468830426832
curr_Factors:  [1.00904688e+02 3.61721894e-02]
mat_Sqrt:  [[ 1.91910503e+01  0.00000000e+00]
 [-7.60759509e-03  1.74311902e-02]]
grads:  [0.00149807 1.33508305]
Stock Position:  0.0014980660026520855
Bond Position:  [-6.34860615]


portfolio before change:  [-6.2006199]
curr_Stock_Price:  99.31463759416812
curr_Factors:  [9.93146376e+01 3.70478197e-02]
mat_Sqrt:  [[ 1.91158929e+01  0.00000000e+00]
 [-7.69912407e-03  1.76409094e-02]]
grads:  [ 0.0010645  -0.32856886]
Stock Position:  0.0010644951670198027
Bond Position:  [-6.30633985]


portfolio before change:  [-6.19911578]
curr_Stock_Price:  101.46820726049947
curr_Factors:  [1.01468207e+02 3.72391855e-02]
mat_Sqrt:  [[ 1.95807839e+01  0.00000000e+00]
 [-7.71898289e-03  1.76864117e-02]]
grads:  [-0.00114082 -0.09127757]
Stock Position:  -0.0011408172080933378
Bond Position:  [-6.0833591]


portfolio before change:  [-6.19850439]
curr_Stock_Price:  100.26568891133867
curr_Factors:  [1.00265689e+02 3.71434427e-02]
mat_Sqrt:  [[ 1.93238394e+01  0.00000000e+00]
 [-7.70905366e-03  1.76636610e-02]]
grads:  [6.51543243e-03 1.70415857e+01]
Stock Position:  0.006515432425000955
Bond Position:  [-6.85177871]


portfolio before change:  [-6.20085372]
curr_Stock_Price:  100.03657104674325
curr_Factors:  [1.00036571e+02 3.80112427e-02]
mat_Sqrt:  [[ 1.95036022e+01  0.00000000e+00]
 [-7.79858887e-03  1.78688119e-02]]
grads:  [ 0.00513591 -1.86447421]
Stock Position:  0.005135908645673105
Bond Position:  [-6.71463241]


portfolio before change:  [-6.20518562]
curr_Stock_Price:  99.35654996698953
curr_Factors:  [9.93565500e+01 3.82625864e-02]
mat_Sqrt:  [[ 1.94349606e+01  0.00000000e+00]
 [-7.82432989e-03  1.79277920e-02]]
grads:  [0.00992846 4.18526019]
Stock Position:  0.009928455711948912
Bond Position:  [-7.19164273]


portfolio before change:  [-6.21827968]
curr_Stock_Price:  98.12825760233807
curr_Factors:  [9.81282576e+01 3.89908013e-02]
mat_Sqrt:  [[ 1.93764926e+01  0.00000000e+00]
 [-7.89843542e-03  1.80975891e-02]]
grads:  [0.00791282 2.13039624]
Stock Position:  0.007912820793979083
Bond Position:  [-6.994751]


portfolio before change:  [-6.2151993]
curr_Stock_Price:  98.62805131518
curr_Factors:  [9.86280513e+01 3.78728915e-02]
mat_Sqrt:  [[ 1.91939644e+01  0.00000000e+00]
 [-7.78438349e-03  1.78362633e-02]]
grads:  [1.06660142e-02 1.09751835e+01]
Stock Position:  0.010666014163587012
Bond Position:  [-7.2671675]


portfolio before change:  [-6.20816309]
curr_Stock_Price:  99.37290902669972
curr_Factors:  [9.9372909e+01 3.7320548e-02]
mat_Sqrt:  [[ 1.91973821e+01  0.00000000e+00]
 [-7.72741074e-03  1.77057223e-02]]
grads:  [2.45685295e-04 5.52633467e+00]
Stock Position:  0.00024568529516463784
Bond Position:  [-6.23257756]


portfolio before change:  [-6.20930313]
curr_Stock_Price:  97.90390373445146
curr_Factors:  [9.79039037e+01 3.81082710e-02]
mat_Sqrt:  [[ 1.91121538e+01  0.00000000e+00]
 [-7.80853594e-03  1.78916035e-02]]
grads:  [0.00982529 1.69248104]
Stock Position:  0.009825286745849534
Bond Position:  [-7.17123705]


portfolio before change:  [-6.204378]
curr_Stock_Price:  98.49641417609737
curr_Factors:  [9.84964142e+01 3.98104875e-02]
mat_Sqrt:  [[ 1.96525617e+01  0.00000000e+00]
 [-7.98102625e-03  1.82868285e-02]]
grads:  [ -0.01996285 -18.2974247 ]
Stock Position:  -0.01996285063191108
Bond Position:  [-4.2381088]


portfolio before change:  [-6.20027959]
curr_Stock_Price:  98.26457294945065
curr_Factors:  [9.82645729e+01 3.97414302e-02]
mat_Sqrt:  [[ 1.9589291e+01  0.0000000e+00]
 [-7.9741011e-03  1.8270961e-02]]
grads:  [9.51088540e-03 1.25900629e+01]
Stock Position:  0.009510885402980417
Bond Position:  [-7.13486268]


portfolio before change:  [-6.19518398]
curr_Stock_Price:  98.89411704415912
curr_Factors:  [9.88941170e+01 3.84259696e-02]
mat_Sqrt:  [[ 1.93857619e+01  0.00000000e+00]
 [-7.84101724e-03  1.79660275e-02]]
grads:  [ 0.00226524 -1.07767174]
Stock Position:  0.002265235394854643
Bond Position:  [-6.41920243]


portfolio before change:  [-6.19407265]
curr_Stock_Price:  99.73896619228603
curr_Factors:  [9.97389662e+01 3.73733828e-02]
mat_Sqrt:  [[ 1.92817331e+01  0.00000000e+00]
 [-7.73287867e-03  1.77182509e-02]]
grads:  [1.58617266e-03 1.06151673e+01]
Stock Position:  0.0015861726622996273
Bond Position:  [-6.35227587]


portfolio before change:  [-6.19569277]
curr_Stock_Price:  99.21819048496116
curr_Factors:  [9.92181905e+01 3.77816277e-02]
mat_Sqrt:  [[ 1.92855325e+01  0.00000000e+00]
 [-7.77499867e-03  1.78147600e-02]]
grads:  [-1.06493758e-03  1.59847040e+00]
Stock Position:  -0.001064937584039722
Bond Position:  [-6.09003159]


portfolio before change:  [-6.19398863]
curr_Stock_Price:  96.90308242650464
curr_Factors:  [9.69030824e+01 3.86719226e-02]
mat_Sqrt:  [[ 1.90561637e+01  0.00000000e+00]
 [-7.86607120e-03  1.80234334e-02]]
grads:  [1.67939687e-03 2.35777854e+00]
Stock Position:  0.00167939686637248
Bond Position:  [-6.35672736]


portfolio before change:  [-6.19598416]
curr_Stock_Price:  96.18800876818436
curr_Factors:  [9.61880088e+01 3.83000318e-02]
mat_Sqrt:  [[ 1.88243722e+01  0.00000000e+00]
 [-7.82815757e-03  1.79365623e-02]]
grads:  [ 0.00977684 -6.03381678]
Stock Position:  0.009776836432276257
Bond Position:  [-7.13639859]


portfolio before change:  [-6.17785245]
curr_Stock_Price:  98.13381326358135
curr_Factors:  [9.81338133e+01 3.72496053e-02]
mat_Sqrt:  [[ 1.89399798e+01  0.00000000e+00]
 [-7.72006272e-03  1.76888859e-02]]
grads:  [ 0.00222432 -2.13569073]
Stock Position:  0.0022243218298503174
Bond Position:  [-6.39613364]


portfolio before change:  [-6.17894422]
curr_Stock_Price:  98.00244783316235
curr_Factors:  [9.80024478e+01 3.73321191e-02]
mat_Sqrt:  [[ 1.89355640e+01  0.00000000e+00]
 [-7.72860858e-03  1.77084669e-02]]
grads:  [9.23026818e-03 1.48466841e+01]
Stock Position:  0.009230268178807313
Bond Position:  [-7.0835331]


portfolio before change:  [-6.19438003]
curr_Stock_Price:  96.42607788861372
curr_Factors:  [9.64260779e+01 3.82338262e-02]
mat_Sqrt:  [[ 1.88546460e+01  0.00000000e+00]
 [-7.82138874e-03  1.79210530e-02]]
grads:  [4.97480909e-03 8.55183840e+00]
Stock Position:  0.004974809093075711
Bond Position:  [-6.67408136]


portfolio before change:  [-6.19781982]
curr_Stock_Price:  95.90234510445796
curr_Factors:  [9.59023451e+01 3.82452387e-02]
mat_Sqrt:  [[ 1.87550366e+01  0.00000000e+00]
 [-7.82255597e-03  1.79237274e-02]]
grads:  [-1.88971872e-03  3.08239560e+00]
Stock Position:  -0.0018897187196769722
Bond Position:  [-6.01659136]


portfolio before change:  [-6.1976729]
curr_Stock_Price:  95.42659367631285
curr_Factors:  [9.54265937e+01 3.90163290e-02]
mat_Sqrt:  [[ 1.88491870e+01  0.00000000e+00]
 [-7.90102059e-03  1.81035125e-02]]
grads:  [6.04227737e-03 7.60322499e+00]
Stock Position:  0.0060422773692451305
Bond Position:  [-6.77426685]


portfolio before change:  [-6.20249789]
curr_Stock_Price:  94.76820670505204
curr_Factors:  [9.47682067e+01 3.91064837e-02]
mat_Sqrt:  [[ 1.87407534e+01  0.00000000e+00]
 [-7.91014373e-03  1.81244162e-02]]
grads:  [5.97769828e-03 8.42452715e+00]
Stock Position:  0.005977698277122813
Bond Position:  [-6.76899364]


portfolio before change:  [-6.19606285]
curr_Stock_Price:  95.98627117042072
curr_Factors:  [9.59862712e+01 3.90163024e-02]
mat_Sqrt:  [[ 1.89597312e+01  0.00000000e+00]
 [-7.90101790e-03  1.81035063e-02]]
grads:  [9.39684212e-03 9.66317749e+00]
Stock Position:  0.009396842120836264
Bond Position:  [-7.09803069]


portfolio before change:  [-6.19160999]
curr_Stock_Price:  96.55456512488752
curr_Factors:  [9.65545651e+01 4.02467473e-02]
mat_Sqrt:  [[ 1.93703829e+01  0.00000000e+00]
 [-8.02463680e-03  1.83867528e-02]]
grads:  [-6.19145961e-03  6.62472955e+00]
Stock Position:  -0.006191459614258077
Bond Position:  [-5.5937963]


portfolio before change:  [-6.1931703]
curr_Stock_Price:  96.69363428940082
curr_Factors:  [9.66936343e+01 4.05071568e-02]
mat_Sqrt:  [[ 1.94609378e+01  0.00000000e+00]
 [-8.05055594e-03  1.84461410e-02]]
grads:  [-0.01022713 -2.59572527]
Stock Position:  -0.01022713123991804
Bond Position:  [-5.20427181]


portfolio before change:  [-6.19914815]
curr_Stock_Price:  97.21453081900155
curr_Factors:  [9.72145308e+01 4.00754044e-02]
mat_Sqrt:  [[ 1.94612235e+01  0.00000000e+00]
 [-8.00753689e-03  1.83475720e-02]]
grads:  [ 0.00402561 -3.92286595]
Stock Position:  0.004025611840486044
Bond Position:  [-6.59049612]


portfolio before change:  [-6.1965412]
curr_Stock_Price:  98.06677800839319
curr_Factors:  [9.8066778e+01 4.1043889e-02]
mat_Sqrt:  [[ 1.98676344e+01  0.00000000e+00]
 [-8.10371658e-03  1.85679473e-02]]
grads:  [-0.04506062 -5.47658959]
Stock Position:  -0.04506061682108952
Bond Position:  [-1.77759169]


portfolio before change:  [-6.17699175]
curr_Stock_Price:  97.62799871917453
curr_Factors:  [9.76279987e+01 4.04746498e-02]
mat_Sqrt:  [[ 1.96411059e+01  0.00000000e+00]
 [-8.04732500e-03  1.84387380e-02]]
grads:  [-0.00556541  1.28187089]
Stock Position:  -0.0055654062976356255
Bond Position:  [-5.63365227]


portfolio before change:  [-6.17681701]
curr_Stock_Price:  97.47006096078071
curr_Factors:  [9.74700610e+01 3.94810756e-02]
mat_Sqrt:  [[ 1.93671504e+01  0.00000000e+00]
 [-7.94793816e-03  1.82110141e-02]]
grads:  [-2.54213126e-03 -5.03750742e+00]
Stock Position:  -0.00254213125521998
Bond Position:  [-5.92903532]


portfolio before change:  [-6.17569349]
curr_Stock_Price:  96.73654571050082
curr_Factors:  [9.67365457e+01 3.94095715e-02]
mat_Sqrt:  [[ 1.92039883e+01  0.00000000e+00]
 [-7.94073764e-03  1.81945157e-02]]
grads:  [0.00539665 5.20837972]
Stock Position:  0.005396646016691356
Bond Position:  [-6.69774639]


portfolio before change:  [-6.17589719]
curr_Stock_Price:  96.85394765705055
curr_Factors:  [9.68539477e+01 3.92440175e-02]
mat_Sqrt:  [[ 1.91868666e+01  0.00000000e+00]
 [-7.92404114e-03  1.81562592e-02]]
grads:  [-1.31744722e-04  8.80053713e+00]
Stock Position:  -0.0001317447220868759
Bond Position:  [-6.16313719]


portfolio before change:  [-6.17671497]
curr_Stock_Price:  97.21332721202602
curr_Factors:  [9.72133272e+01 3.69799916e-02]
mat_Sqrt:  [[ 1.86943002e+01  0.00000000e+00]
 [-7.69207296e-03  1.76247533e-02]]
grads:  [ -0.05416622 -13.12440445]
Stock Position:  -0.05416621728404443
Bond Position:  [-0.91103677]


portfolio before change:  [-6.23038027]
curr_Stock_Price:  98.20197675742925
curr_Factors:  [9.82019768e+01 3.76297972e-02]
mat_Sqrt:  [[ 1.90496135e+01  0.00000000e+00]
 [-7.75936051e-03  1.77789284e-02]]
grads:  [6.11438385e-03 1.76176896e+01]
Stock Position:  0.0061143838490215225
Bond Position:  [-6.83082485]


portfolio before change:  [-6.22972958]
curr_Stock_Price:  98.44805139817429
curr_Factors:  [9.84480514e+01 3.76740480e-02]
mat_Sqrt:  [[ 1.91085735e+01  0.00000000e+00]
 [-7.76392148e-03  1.77893789e-02]]
grads:  [-4.43582390e-03  6.24786908e+00]
Stock Position:  -0.004435823900909027
Bond Position:  [-5.79303136]


portfolio before change:  [-6.23304663]
curr_Stock_Price:  99.03258195732727
curr_Factors:  [9.90325820e+01 3.65791016e-02]
mat_Sqrt:  [[ 1.89406387e+01  0.00000000e+00]
 [-7.65026552e-03  1.75289604e-02]]
grads:  [0.02802559 2.43381818]
Stock Position:  0.028025594077248944
Bond Position:  [-9.00849357]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.22978444]
Stock Price:  99.1891643207845
PL:  [-6.22978444]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.13673543e-01  1.19193631e-01]
 [-1.64643914e-01 -8.76143697e-02]
 [ 9.09564853e-01 -9.03438970e-01]
 [-2.03308653e-02  2.00671901e-01]
 [ 2.22429345e-02 -8.62243129e-02]
 [-7.88943553e-02 -1.04822776e-01]
 [-1.11296378e-01  1.10913917e-01]
 [ 4.95012258e-03 -1.30503397e-01]
 [ 1.64770305e-01  1.41148900e-01]
 [ 1.63029867e-02  2.06991902e-01]
 [ 1.46006794e-01  2.91018884e-01]
 [ 1.85933312e-01  2.36406679e-01]
 [ 2.45219213e-01  2.22714856e-02]
 [-1.75051281e-01 -2.08261548e-01]
 [ 8.96784319e-02  2.33035664e-01]
 [ 5.24686556e-02 -1.94285715e-02]
 [-5.14025210e-02  1.82510243e-01]
 [-3.05351738e-02  3.05832513e-02]
 [ 1.58195112e-02  4.30052005e-02]
 [ 2.51442159e-01 -1.09617922e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.14629810e-03  1.47400379e-01]
 [ 1.44172483e-02  8.13595458e-02]
 [ 3.45265578e-02 -1.60501399e-01]
 [ 4.99454136e-02  1.44358553e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.65781658e-01  1.04886254e-01]
 [-2.74083832e-01  1.84360429e-05]
 [ 2.14099721e-01 -9.62122045e-02]
 [-1.34405439e+00 -1.51754716e-01]
 [ 1.36930451e-01  3.66811526e-01]
 [-4.64149365e-03 -1.29499145e-01]
 [ 3.29288132e-02  7.54917884e-02]
 [-3.28217789e-02  1.67544685e-01]
 [-1.80499159e+00 -4.83447795e-02]
 [-1.04394549e-01  1.62993748e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.26239395e+00 -4.98595618e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.9899248]
curr_Stock_Price:  99.44306350986056
curr_Factors:  [9.94430635e+01 3.80191035e-02]
mat_Sqrt:  [[ 1.93898938e+01  0.00000000e+00]
 [-7.79939520e-03  1.78706594e-02]]
grads:  [-3.17965523e-03  6.66979479e+00]
Stock Position:  -0.003179655229484235
Bond Position:  [-0.67373014]


portfolio before change:  [-0.98976069]
curr_Stock_Price:  99.36496248300452
curr_Factors:  [9.93649625e+01 3.84941322e-02]
mat_Sqrt:  [[ 1.94953277e+01  0.00000000e+00]
 [-7.84796862e-03  1.79819551e-02]]
grads:  [-0.0104067  -4.87234948]
Stock Position:  -0.010406696562224664
Bond Position:  [0.04430033]


portfolio before change:  [-0.95896523]
curr_Stock_Price:  96.40629877307776
curr_Factors:  [9.64062988e+01 3.80944237e-02]
mat_Sqrt:  [[ 1.88163817e+01  0.00000000e+00]
 [-7.80711713e-03  1.78883526e-02]]
grads:  [ 2.73842107e-02 -5.05043136e+01]
Stock Position:  0.027384210708264335
Bond Position:  [-3.59897563]


portfolio before change:  [-0.93182008]
curr_Stock_Price:  97.41399823008096
curr_Factors:  [9.74139982e+01 3.74918572e-02]
mat_Sqrt:  [[ 1.88620914e+01  0.00000000e+00]
 [-7.74512566e-03  1.77463123e-02]]
grads:  [3.56532745e-03 1.13078085e+01]
Stock Position:  0.0035653274486442846
Bond Position:  [-1.27913288]


portfolio before change:  [-0.93313198]
curr_Stock_Price:  97.09088735053044
curr_Factors:  [9.70908874e+01 3.79803471e-02]
mat_Sqrt:  [[ 1.89216034e+01  0.00000000e+00]
 [-7.79541887e-03  1.78615485e-02]]
grads:  [-8.13273615e-04 -4.82737053e+00]
Stock Position:  -0.0008132736150015523
Bond Position:  [-0.85417052]


portfolio before change:  [-0.93310601]
curr_Stock_Price:  96.92765946266738
curr_Factors:  [9.69276595e+01 3.65747194e-02]
mat_Sqrt:  [[ 1.85369478e+01  0.00000000e+00]
 [-7.64980725e-03  1.75279104e-02]]
grads:  [-0.00672402 -5.98033497]
Stock Position:  -0.006724017697843571
Bond Position:  [-0.28136271]


portfolio before change:  [-0.93355629]
curr_Stock_Price:  96.98939556675911
curr_Factors:  [9.69893956e+01 3.61993218e-02]
mat_Sqrt:  [[ 1.84533182e+01  0.00000000e+00]
 [-7.61044775e-03  1.74377264e-02]]
grads:  [-3.40803616e-03  6.36057216e+00]
Stock Position:  -0.0034080361565311857
Bond Position:  [-0.60301293]


portfolio before change:  [-0.93266936]
curr_Stock_Price:  96.7070298403565
curr_Factors:  [9.67070298e+01 3.61902595e-02]
mat_Sqrt:  [[ 1.83972917e+01  0.00000000e+00]
 [-7.60949507e-03  1.74355436e-02]]
grads:  [-2.82684159e-03 -7.48490553e+00]
Stock Position:  -0.0028268415850547677
Bond Position:  [-0.65929391]


portfolio before change:  [-0.92911774]
curr_Stock_Price:  95.42148154255355
curr_Factors:  [9.54214815e+01 3.78786195e-02]
mat_Sqrt:  [[ 1.85713394e+01  0.00000000e+00]
 [-7.78497214e-03  1.78376121e-02]]
grads:  [0.01218936 7.91299303]
Stock Position:  0.012189359665098978
Bond Position:  [-2.09224449]


portfolio before change:  [-0.92147249]
curr_Stock_Price:  96.07014476963697
curr_Factors:  [9.60701448e+01 3.96663475e-02]
mat_Sqrt:  [[ 1.91337260e+01  0.00000000e+00]
 [-7.96656488e-03  1.82536933e-02]]
grads:  [5.57349147e-03 1.13397272e+01]
Stock Position:  0.005573491465313409
Bond Position:  [-1.45691863]


portfolio before change:  [-0.91468847]
curr_Stock_Price:  97.32001746423273
curr_Factors:  [9.73200175e+01 3.97525499e-02]
mat_Sqrt:  [[ 1.94037055e+01  0.00000000e+00]
 [-7.97521660e-03  1.82735169e-02]]
grads:  [1.40703974e-02 1.59257184e+01]
Stock Position:  0.01407039743065563
Bond Position:  [-2.28401979]


portfolio before change:  [-0.91483436]
curr_Stock_Price:  97.32994117721458
curr_Factors:  [9.73299412e+01 3.98071057e-02]
mat_Sqrt:  [[ 1.94189955e+01  0.00000000e+00]
 [-7.98068726e-03  1.82860517e-02]]
grads:  [ 0.01488798 12.92825168]
Stock Position:  0.014887981466608816
Bond Position:  [-2.36388072]


portfolio before change:  [-0.93373498]
curr_Stock_Price:  96.0802673502713
curr_Factors:  [9.60802674e+01 4.09213010e-02]
mat_Sqrt:  [[ 1.94360908e+01  0.00000000e+00]
 [-8.09160562e-03  1.85401976e-02]]
grads:  [0.0131168  1.20125395]
Stock Position:  0.01311679848484699
Bond Position:  [-2.19400048]


portfolio before change:  [-0.91848811]
curr_Stock_Price:  97.26356920613762
curr_Factors:  [9.72635692e+01 4.02581721e-02]
mat_Sqrt:  [[ 1.95153897e+01  0.00000000e+00]
 [-8.02577568e-03  1.83893623e-02]]
grads:  [ -0.0136274  -11.32510984]
Stock Position:  -0.0136274025673017
Bond Position:  [0.4069617]


portfolio before change:  [-0.91840218]
curr_Stock_Price:  97.26099660708874
curr_Factors:  [9.72609966e+01 4.04103693e-02]
mat_Sqrt:  [[ 1.95517270e+01  0.00000000e+00]
 [-8.04093221e-03  1.84240903e-02]]
grads:  [9.78857437e-03 1.26484218e+01]
Stock Position:  0.009788574371728498
Bond Position:  [-1.87044868]


portfolio before change:  [-0.90148005]
curr_Stock_Price:  99.01364733695256
curr_Factors:  [9.90136473e+01 4.08630796e-02]
mat_Sqrt:  [[ 2.00152310e+01  0.00000000e+00]
 [-8.08584735e-03  1.85270038e-02]]
grads:  [ 0.00219779 -1.04866236]
Stock Position:  0.002197792866751964
Bond Position:  [-1.11909154]


portfolio before change:  [-0.90017279]
curr_Stock_Price:  99.67210627050801
curr_Factors:  [9.96721063e+01 3.99991086e-02]
mat_Sqrt:  [[ 1.99341991e+01  0.00000000e+00]
 [-7.99991086e-03  1.83300985e-02]]
grads:  [1.41723675e-03 9.95686101e+00]
Stock Position:  0.001417236746376583
Bond Position:  [-1.04143176]


portfolio before change:  [-0.90105126]
curr_Stock_Price:  99.14411671944838
curr_Factors:  [9.91441167e+01 4.24197467e-02]
mat_Sqrt:  [[ 2.04197765e+01  0.00000000e+00]
 [-8.23842186e-03  1.88765959e-02]]
grads:  [-8.41710912e-04  1.62016772e+00]
Stock Position:  -0.000841710912223493
Bond Position:  [-0.81760058]


portfolio before change:  [-0.89991398]
curr_Stock_Price:  97.67152675737529
curr_Factors:  [9.76715268e+01 4.33229779e-02]
mat_Sqrt:  [[ 2.03295201e+01  0.00000000e+00]
 [-8.32566902e-03  1.90765043e-02]]
grads:  [1.70139380e-03 2.25435436e+00]
Stock Position:  0.0017013937988111171
Bond Position:  [-1.06609171]


portfolio before change:  [-0.90311292]
curr_Stock_Price:  95.86966748965676
curr_Factors:  [9.58696675e+01 4.44000476e-02]
mat_Sqrt:  [[ 2.02010033e+01  0.00000000e+00]
 [-8.42852752e-03  1.93121827e-02]]
grads:  [ 0.01007876 -5.67610217]
Stock Position:  0.010078755659778876
Bond Position:  [-1.86935987]


portfolio before change:  [-0.90630322]
curr_Stock_Price:  95.57631649822444
curr_Factors:  [9.55763165e+01 4.48759578e-02]
mat_Sqrt:  [[ 2.02468355e+01  0.00000000e+00]
 [-8.47357849e-03  1.94154074e-02]]
grads:  [ 0.00208075 -1.94577373]
Stock Position:  0.002080750378483161
Bond Position:  [-1.10517367]


portfolio before change:  [-0.90766239]
curr_Stock_Price:  94.98950024841369
curr_Factors:  [9.49895002e+01 4.45919991e-02]
mat_Sqrt:  [[ 2.00587596e+01  0.00000000e+00]
 [-8.44672709e-03  1.93538831e-02]]
grads:  [3.10011698e-03 7.61606225e+00]
Stock Position:  0.0031001169763067104
Bond Position:  [-1.20214095]


portfolio before change:  [-0.90669017]
curr_Stock_Price:  95.35158135877532
curr_Factors:  [9.53515814e+01 4.29285922e-02]
mat_Sqrt:  [[ 1.97561003e+01  0.00000000e+00]
 [-8.28768650e-03  1.89894754e-02]]
grads:  [2.52709109e-03 4.28445464e+00]
Stock Position:  0.0025270910937954514
Bond Position:  [-1.1476523]


portfolio before change:  [-0.91320744]
curr_Stock_Price:  92.82939122667729
curr_Factors:  [9.28293912e+01 4.44222863e-02]
mat_Sqrt:  [[ 1.95652750e+01  0.00000000e+00]
 [-8.43063806e-03  1.93170185e-02]]
grads:  [-1.81556333e-03 -8.30880806e+00]
Stock Position:  -0.0018155633259519762
Bond Position:  [-0.7446698]


portfolio before change:  [-0.91707663]
curr_Stock_Price:  94.90924178304776
curr_Factors:  [9.49092418e+01 4.21605051e-02]
mat_Sqrt:  [[ 1.94877369e+01  0.00000000e+00]
 [-8.21320937e-03  1.88188268e-02]]
grads:  [5.79588343e-03 7.67096450e+00]
Stock Position:  0.00579588343073985
Bond Position:  [-1.46715953]


portfolio before change:  [-0.92789254]
curr_Stock_Price:  93.07474976592961
curr_Factors:  [9.30747498e+01 4.41187089e-02]
mat_Sqrt:  [[ 1.95498430e+01  0.00000000e+00]
 [-8.40178161e-03  1.92509001e-02]]
grads:  [6.41870323e-03 9.45766270e+00]
Stock Position:  0.006418703233490975
Bond Position:  [-1.52531174]


portfolio before change:  [-0.92261326]
curr_Stock_Price:  93.92693971151662
curr_Factors:  [9.39269397e+01 4.42140345e-02]
mat_Sqrt:  [[ 1.97501431e+01  0.00000000e+00]
 [-8.41085342e-03  1.92716862e-02]]
grads:  [9.02077518e-03 9.07743060e+00]
Stock Position:  0.00902077518285161
Bond Position:  [-1.76990707]


portfolio before change:  [-0.9135648]
curr_Stock_Price:  94.9545361877907
curr_Factors:  [9.49545362e+01 4.42179648e-02]
mat_Sqrt:  [[ 1.99671045e+01  0.00000000e+00]
 [-8.41122724e-03  1.92725428e-02]]
grads:  [-0.00601016  5.44226341]
Stock Position:  -0.006010162533439285
Bond Position:  [-0.3428726]


portfolio before change:  [-0.91510306]
curr_Stock_Price:  95.20334844218904
curr_Factors:  [9.52033484e+01 4.50014866e-02]
mat_Sqrt:  [[ 2.01960136e+01  0.00000000e+00]
 [-8.48542153e-03  1.94425432e-02]]
grads:  [-0.01357079  0.00094823]
Stock Position:  -0.01357078639771823
Bond Position:  [0.37688125]


portfolio before change:  [-0.90181786]
curr_Stock_Price:  94.22786414958324
curr_Factors:  [9.42278641e+01 4.62694957e-02]
mat_Sqrt:  [[ 2.02687390e+01  0.00000000e+00]
 [-8.60413814e-03  1.97145572e-02]]
grads:  [ 0.00849137 -4.88026202]
Stock Position:  0.00849136557336455
Bond Position:  [-1.7019411]


portfolio before change:  [-0.9108893]
curr_Stock_Price:  93.18460608282884
curr_Factors:  [9.31846061e+01 4.62362354e-02]
mat_Sqrt:  [[ 2.00371250e+01  0.00000000e+00]
 [-8.60104509e-03  1.97074701e-02]]
grads:  [-0.07038363 -7.70036515]
Stock Position:  -0.0703836292674015
Bond Position:  [5.64778147]


portfolio before change:  [-0.92183807]
curr_Stock_Price:  93.35019558371408
curr_Factors:  [9.33501956e+01 4.69789660e-02]
mat_Sqrt:  [[ 2.02333111e+01  0.00000000e+00]
 [-8.66985268e-03  1.98651281e-02]]
grads:  [1.46797588e-02 1.84650975e+01]
Stock Position:  0.014679758753890765
Bond Position:  [-2.29219642]


portfolio before change:  [-0.92133354]
curr_Stock_Price:  93.40408471196425
curr_Factors:  [9.34040847e+01 4.71784356e-02]
mat_Sqrt:  [[ 2.02879253e+01  0.00000000e+00]
 [-8.68823900e-03  1.99072564e-02]]
grads:  [-3.01457902e-03 -6.50512265e+00]
Stock Position:  -0.0030145790189367813
Bond Position:  [-0.63975954]


portfolio before change:  [-0.92514233]
curr_Stock_Price:  94.64101368232508
curr_Factors:  [9.46410137e+01 4.55785467e-02]
mat_Sqrt:  [[ 2.02050356e+01  0.00000000e+00]
 [-8.53965308e-03  1.95668033e-02]]
grads:  [3.26038182e-03 3.85815644e+00]
Stock Position:  0.003260381818944444
Bond Position:  [-1.23370817]


portfolio before change:  [-0.92978934]
curr_Stock_Price:  93.26301910096338
curr_Factors:  [9.32630191e+01 4.42044376e-02]
mat_Sqrt:  [[ 1.96084112e+01  0.00000000e+00]
 [-8.40994056e-03  1.92695946e-02]]
grads:  [2.05527700e-03 8.69476959e+00]
Stock Position:  0.0020552769989867397
Bond Position:  [-1.12147068]


portfolio before change:  [-0.93006934]
curr_Stock_Price:  93.19499513851241
curr_Factors:  [9.31949951e+01 4.34824342e-02]
mat_Sqrt:  [[ 1.94334324e+01  0.00000000e+00]
 [-8.34097684e-03  1.91115789e-02]]
grads:  [-0.09396647 -2.52960678]
Stock Position:  -0.09396646678145072
Bond Position:  [7.82713507]


portfolio before change:  [-0.80154419]
curr_Stock_Price:  91.83763117067524
curr_Factors:  [9.18376312e+01 4.44130727e-02]
mat_Sqrt:  [[ 1.93542383e+01  0.00000000e+00]
 [-8.42976371e-03  1.93150152e-02]]
grads:  [-1.71839600e-03  8.43870671e+00]
Stock Position:  -0.0017183959997344603
Bond Position:  [-0.64373078]


portfolio before change:  [-0.80587723]
curr_Stock_Price:  94.3123603448275
curr_Factors:  [9.43123603e+01 4.44434681e-02]
mat_Sqrt:  [[ 1.98825730e+01  0.00000000e+00]
 [-8.43264781e-03  1.93216234e-02]]
grads:  [-4.43530199e-03  5.66007120e+00]
Stock Position:  -0.004435301985559488
Bond Position:  [-0.38757343]


portfolio before change:  [-0.80027479]
curr_Stock_Price:  93.03828812703034
curr_Factors:  [9.30382881e+01 4.59836945e-02]
mat_Sqrt:  [[ 1.99509528e+01  0.00000000e+00]
 [-8.57752361e-03  1.96535756e-02]]
grads:  [ 0.06218417 -2.53692065]
Stock Position:  0.06218417063281078
Bond Position:  [-6.58578357]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.72219499]
Stock Price:  94.30714912711827
PL:  [-0.72219499]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.81464603e-01  6.09393584e-01]
 [-1.76642456e-01 -7.44459770e-02]
 [ 8.28637518e-01 -6.89354747e-01]
 [ 1.28531288e-02  2.36187408e-02]
 [-1.44202355e-01  6.10711396e-02]
 [ 2.97029976e-03  3.27005847e-02]
 [ 4.92204224e-02  1.92168724e-01]
 [ 2.70022175e-01 -2.10088419e-03]
 [ 2.16997190e-02  6.54232959e-02]
 [ 5.45980790e-01 -4.10059311e-01]
 [ 6.11499133e-02 -9.40117313e-03]
 [-1.00333967e-01 -1.81244799e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-6.62110882e-01 -8.66090262e-01]
 [-8.70336171e-02 -5.06690570e-01]
 [-8.91488223e-02 -2.61897737e-01]
 [-4.98347931e-02  9.43831817e-02]
 [ 1.36065556e-01  1.57168822e-01]
 [ 1.27848274e-04 -4.26253414e-02]
 [-1.09320778e-01 -2.62530136e-02]
 [ 5.83587177e-02  5.05369463e-01]
 [ 4.58638784e-02  2.88427734e-01]
 [-3.65122897e-04 -3.39606308e-01]
 [ 2.47298346e-01  2.38896950e-01]
 [ 1.60131932e-01  3.15770525e-01]
 [ 9.12826927e-01 -1.19076489e+00]
 [-1.32251568e+00  1.51719621e+00]
 [-1.82043462e-02 -3.92243122e-02]
 [-6.94456280e-02 -3.84936897e-02]
 [ 1.99157279e-01  7.05037145e-02]
 [-2.81892017e-01 -1.87285851e-01]
 [ 3.35866370e-01 -4.14830078e-02]
 [ 3.55343770e-01  4.79264858e-01]
 [ 2.97722259e-01 -8.82126661e-03]
 [-1.06232040e-01 -3.06201857e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-3.90349405e-01  4.69225421e-02]
 [-1.09909105e-01  1.26905606e-01]
 [-3.14377878e-01  1.73072055e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.39910198]
curr_Stock_Price:  100.85720290833306
curr_Factors:  [1.00857203e+02 4.13048965e-02]
mat_Sqrt:  [[ 2.04978206e+01  0.00000000e+00]
 [-8.12944244e-03  1.86268927e-02]]
grads:  [2.67065352e-02 3.27157940e+01]
Stock Position:  0.026706535152126946
Bond Position:  [5.70555555]


portfolio before change:  [8.39486837]
curr_Stock_Price:  100.67197297927392
curr_Factors:  [1.00671973e+02 4.15575439e-02]
mat_Sqrt:  [[ 2.05226537e+01  0.00000000e+00]
 [-8.15426700e-03  1.86837729e-02]]
grads:  [-0.01019037 -3.9845259 ]
Stock Position:  -0.010190365597095626
Bond Position:  [9.42075258]


portfolio before change:  [8.38215581]
curr_Stock_Price:  102.03504735977158
curr_Factors:  [1.02035047e+02 4.02055790e-02]
mat_Sqrt:  [[ 2.04593829e+01  0.00000000e+00]
 [-8.02053156e-03  1.83773465e-02]]
grads:  [ 2.57964007e-02 -3.75111145e+01]
Stock Position:  0.02579640074094685
Bond Position:  [5.75001884]


portfolio before change:  [8.35053894]
curr_Stock_Price:  100.78155192595082
curr_Factors:  [1.00781552e+02 4.26053703e-02]
mat_Sqrt:  [[ 2.08023890e+01  0.00000000e+00]
 [-8.25642735e-03  1.89178516e-02]]
grads:  [1.11339098e-03 1.24848959e+00]
Stock Position:  0.0011133909840134492
Bond Position:  [8.23832967]


portfolio before change:  [8.35328753]
curr_Stock_Price:  102.3252422252548
curr_Factors:  [1.02325242e+02 4.23322412e-02]
mat_Sqrt:  [[ 2.10532143e+01  0.00000000e+00]
 [-8.22992016e-03  1.88571160e-02]]
grads:  [-0.00558341  3.23862564]
Stock Position:  -0.005583409871111203
Bond Position:  [8.92461129]


portfolio before change:  [8.35713598]
curr_Stock_Price:  101.83579143173498
curr_Factors:  [1.01835791e+02 4.37093018e-02]
mat_Sqrt:  [[ 2.12905744e+01  0.00000000e+00]
 [-8.36270787e-03  1.91613709e-02]]
grads:  [8.09842172e-04 1.70658900e+00]
Stock Position:  0.0008098421720105145
Bond Position:  [8.27466506]


portfolio before change:  [8.35872203]
curr_Stock_Price:  102.51697484073416
curr_Factors:  [1.02516975e+02 4.35076809e-02]
mat_Sqrt:  [[ 2.13834980e+01  0.00000000e+00]
 [-8.34339796e-03  1.91171263e-02]]
grads:  [6.22394568e-03 1.00521763e+01]
Stock Position:  0.006223945675447697
Bond Position:  [7.72066194]


portfolio before change:  [8.35591482]
curr_Stock_Price:  101.91087205343072
curr_Factors:  [1.01910872e+02 4.43026823e-02]
mat_Sqrt:  [[ 2.14504066e+01  0.00000000e+00]
 [-8.41928094e-03  1.92909961e-02]]
grads:  [ 0.01254546 -0.10890491]
Stock Position:  0.012545462617619484
Bond Position:  [7.07739578]


portfolio before change:  [8.37336753]
curr_Stock_Price:  103.23150762880623
curr_Factors:  [1.03231508e+02 4.26589434e-02]
mat_Sqrt:  [[ 2.13214785e+01  0.00000000e+00]
 [-8.26161664e-03  1.89297418e-02]]
grads:  [2.35690907e-03 3.45611137e+00]
Stock Position:  0.0023569090736655592
Bond Position:  [8.13006025]


portfolio before change:  [8.377407]
curr_Stock_Price:  104.51418343726381
curr_Factors:  [1.04514183e+02 3.97849150e-02]
mat_Sqrt:  [[ 2.08465624e+01  0.00000000e+00]
 [-7.97846251e-03  1.82809542e-02]]
grads:  [ 1.76055998e-02 -2.24309577e+01]
Stock Position:  0.017605599838623903
Bond Position:  [6.53737211]


portfolio before change:  [8.36081262]
curr_Stock_Price:  103.5252025265675
curr_Factors:  [1.03525203e+02 4.03528474e-02]
mat_Sqrt:  [[ 2.07961615e+01  0.00000000e+00]
 [-8.03520727e-03  1.84109728e-02]]
grads:  [ 0.00274315 -0.51062881]
Stock Position:  0.0027431458912893776
Bond Position:  [8.07682789]


portfolio before change:  [8.36024428]
curr_Stock_Price:  102.94994569997945
curr_Factors:  [1.02949946e+02 4.21899748e-02]
mat_Sqrt:  [[ 2.11461231e+01  0.00000000e+00]
 [-8.21607934e-03  1.88254028e-02]]
grads:  [-8.48551207e-03 -9.62767178e+00]
Stock Position:  -0.008485512067763436
Bond Position:  [9.23382728]


portfolio before change:  [8.36430453]
curr_Stock_Price:  102.6074856390266
curr_Factors:  [1.02607486e+02 4.27512715e-02]
mat_Sqrt:  [[ 2.12155143e+01  0.00000000e+00]
 [-8.27055224e-03  1.89502158e-02]]
grads:  [-5.69357961e-03  8.73507975e+00]
Stock Position:  -0.005693579608429428
Bond Position:  [8.94850841]


portfolio before change:  [8.3598745]
curr_Stock_Price:  103.58203325606786
curr_Factors:  [1.03582033e+02 4.36413291e-02]
mat_Sqrt:  [[ 2.16388121e+01  0.00000000e+00]
 [-8.35620288e-03  1.91464661e-02]]
grads:  [ -0.04806658 -45.23499312]
Stock Position:  -0.04806657854071769
Bond Position:  [13.33870843]


portfolio before change:  [8.25510634]
curr_Stock_Price:  105.79637023152219
curr_Factors:  [1.05796370e+02 4.44938223e-02]
mat_Sqrt:  [[ 2.23162196e+01  0.00000000e+00]
 [-8.43742352e-03  1.93325660e-02]]
grads:  [-1.38093063e-02 -2.62091732e+01]
Stock Position:  -0.01380930628826571
Bond Position:  [9.71608082]


portfolio before change:  [8.22706882]
curr_Stock_Price:  107.9146591079871
curr_Factors:  [1.07914659e+02 4.43761878e-02]
mat_Sqrt:  [[ 2.27329312e+01  0.00000000e+00]
 [-8.42626254e-03  1.93069930e-02]]
grads:  [-8.94958786e-03 -1.35649159e+01]
Stock Position:  -0.00894958785620055
Bond Position:  [9.19286054]


portfolio before change:  [8.23302244]
curr_Stock_Price:  107.37782517453324
curr_Factors:  [1.07377825e+02 4.42917812e-02]
mat_Sqrt:  [[ 2.25983212e+01  0.00000000e+00]
 [-8.41824507e-03  1.92886226e-02]]
grads:  [-3.82444139e-04  4.89320485e+00]
Stock Position:  -0.0003824441390543775
Bond Position:  [8.27408846]


portfolio before change:  [8.23393516]
curr_Stock_Price:  107.69580049150477
curr_Factors:  [1.07695800e+02 4.44193366e-02]
mat_Sqrt:  [[ 2.26978542e+01  0.00000000e+00]
 [-8.43035815e-03  1.93163772e-02]]
grads:  [0.0090167  8.13655793]
Stock Position:  0.009016696067687697
Bond Position:  [7.26287486]


portfolio before change:  [8.24001772]
curr_Stock_Price:  108.26969658428247
curr_Factors:  [1.08269697e+02 4.46333282e-02]
mat_Sqrt:  [[ 2.28737071e+01  0.00000000e+00]
 [-8.45064051e-03  1.93628499e-02]]
grads:  [-8.07712356e-04 -2.20139812e+00]
Stock Position:  -0.0008077123557224653
Bond Position:  [8.3274685]


portfolio before change:  [8.24078246]
curr_Stock_Price:  108.6117340292052
curr_Factors:  [1.08611734e+02 4.52597087e-02]
mat_Sqrt:  [[ 2.31064179e+01  0.00000000e+00]
 [-8.50973172e-03  1.94982449e-02]]
grads:  [-0.00522706 -1.34642958]
Stock Position:  -0.005227055635091406
Bond Position:  [8.80850203]


portfolio before change:  [8.23136924]
curr_Stock_Price:  110.62325778666995
curr_Factors:  [1.10623258e+02 4.40160125e-02]
mat_Sqrt:  [[ 2.32087522e+01  0.00000000e+00]
 [-8.39199738e-03  1.92284816e-02]]
grads:  [1.20178815e-02 2.62823385e+01]
Stock Position:  0.01201788147227607
Bond Position:  [6.90191204]


portfolio before change:  [8.2463077]
curr_Stock_Price:  111.79448467957708
curr_Factors:  [1.11794485e+02 4.34776706e-02]
mat_Sqrt:  [[ 2.33106032e+01  0.00000000e+00]
 [-8.34051995e-03  1.91105320e-02]]
grads:  [7.36763694e-03 1.50926062e+01]
Stock Position:  0.007367636943792693
Bond Position:  [7.42264652]


portfolio before change:  [8.23929671]
curr_Stock_Price:  110.71695031858322
curr_Factors:  [1.10716950e+02 4.35942796e-02]
mat_Sqrt:  [[ 2.31168613e+01  0.00000000e+00]
 [-8.35169727e-03  1.91361425e-02]]
grads:  [-6.42740661e-03 -1.77468531e+01]
Stock Position:  -0.0064274066116618315
Bond Position:  [8.95091956]


portfolio before change:  [8.23059199]
curr_Stock_Price:  112.24535131566172
curr_Factors:  [1.12245351e+02 4.31780228e-02]
mat_Sqrt:  [[ 2.33238231e+01  0.00000000e+00]
 [-8.31172885e-03  1.90445633e-02]]
grads:  [ 0.01507307 12.54410229]
Stock Position:  0.015073065914666004
Bond Position:  [6.53871041]


portfolio before change:  [8.2528213]
curr_Stock_Price:  113.66589320538567
curr_Factors:  [1.13665893e+02 4.17448502e-02]
mat_Sqrt:  [[ 2.32237112e+01  0.00000000e+00]
 [-8.17262261e-03  1.87258309e-02]]
grads:  [1.28293658e-02 1.68628312e+01]
Stock Position:  0.012829365829887033
Bond Position:  [6.79455997]


portfolio before change:  [8.2332585]
curr_Stock_Price:  112.0748422699411
curr_Factors:  [1.12074842e+02 4.11584393e-02]
mat_Sqrt:  [[ 2.27372316e+01  0.00000000e+00]
 [-8.11501712e-03  1.85938401e-02]]
grads:  [ 1.72903426e-02 -6.40408265e+01]
Stock Position:  0.01729034257742907
Bond Position:  [6.29544608]


portfolio before change:  [8.24694286]
curr_Stock_Price:  112.82077198460152
curr_Factors:  [1.12820772e+02 4.08143672e-02]
mat_Sqrt:  [[ 2.27926909e+01  0.00000000e+00]
 [-8.08102639e-03  1.85159576e-02]]
grads:  [-2.89723126e-02  8.19399269e+01]
Stock Position:  -0.02897231262268996
Bond Position:  [11.51562153]


portfolio before change:  [8.21330233]
curr_Stock_Price:  114.03158539448121
curr_Factors:  [1.14031585e+02 3.92190911e-02]
mat_Sqrt:  [[ 2.25825991e+01  0.00000000e+00]
 [-7.92152421e-03  1.81504921e-02]]
grads:  [-1.56417954e-03 -2.16106053e+00]
Stock Position:  -0.0015641795421645166
Bond Position:  [8.39166821]


portfolio before change:  [8.21373105]
curr_Stock_Price:  114.42815675945346
curr_Factors:  [1.14428157e+02 3.94146751e-02]
mat_Sqrt:  [[ 2.27175701e+01  0.00000000e+00]
 [-7.94125180e-03  1.81956937e-02]]
grads:  [-0.00379643 -2.11553845]
Stock Position:  -0.003796429412020035
Bond Position:  [8.64814947]


portfolio before change:  [8.2151787]
curr_Stock_Price:  114.33160065115861
curr_Factors:  [1.14331601e+02 4.06446421e-02]
mat_Sqrt:  [[ 2.30498411e+01  0.00000000e+00]
 [-8.06420656e-03  1.84774185e-02]]
grads:  [0.00997524 3.81566909]
Stock Position:  0.009975236793914925
Bond Position:  [7.07469391]


portfolio before change:  [8.19824169]
curr_Stock_Price:  112.54503579081306
curr_Factors:  [1.12545036e+02 4.17480544e-02]
mat_Sqrt:  [[ 2.29955851e+01  0.00000000e+00]
 [-8.17293626e-03  1.87265495e-02]]
grads:  [ -0.01581305 -10.00108702]
Stock Position:  -0.015813046811933035
Bond Position:  [9.97792161]


portfolio before change:  [8.19950702]
curr_Stock_Price:  112.54389689001769
curr_Factors:  [1.12543897e+02 4.02960425e-02]
mat_Sqrt:  [[ 2.25919203e+01  0.00000000e+00]
 [-8.02954967e-03  1.83980096e-02]]
grads:  [ 0.01406528 -2.2547552 ]
Stock Position:  0.014065280746448852
Bond Position:  [6.61654551]


portfolio before change:  [8.17528967]
curr_Stock_Price:  110.76330945862573
curr_Factors:  [1.10763309e+02 4.29927562e-02]
mat_Sqrt:  [[ 2.29664340e+01  0.00000000e+00]
 [-8.29387786e-03  1.90036615e-02]]
grads:  [2.45798761e-02 2.52196061e+01]
Stock Position:  0.0245798761129587
Bond Position:  [5.45274125]


portfolio before change:  [8.19654546]
curr_Stock_Price:  111.60034171052054
curr_Factors:  [1.11600342e+02 4.43970299e-02]
mat_Sqrt:  [[ 2.35148646e+01  0.00000000e+00]
 [-8.42824109e-03  1.93115264e-02]]
grads:  [ 0.0124973  -0.45678764]
Stock Position:  0.012497301047807234
Bond Position:  [6.80184239]


portfolio before change:  [8.21312255]
curr_Stock_Price:  112.85875833902661
curr_Factors:  [1.12858758e+02 4.63120777e-02]
mat_Sqrt:  [[ 2.42874769e+01  0.00000000e+00]
 [-8.60809644e-03  1.97236268e-02]]
grads:  [-9.87626204e-03 -1.55246224e+01]
Stock Position:  -0.009876262042793377
Bond Position:  [9.32774522]


portfolio before change:  [8.21070711]
curr_Stock_Price:  113.2213939046539
curr_Factors:  [1.13221394e+02 4.53604181e-02]
mat_Sqrt:  [[ 2.41138759e+01  0.00000000e+00]
 [-8.51919415e-03  1.95199260e-02]]
grads:  [ 0.00646415 -3.56950552]
Stock Position:  0.006464147349707158
Bond Position:  [7.47882734]


portfolio before change:  [8.21804054]
curr_Stock_Price:  114.21124135990752
curr_Factors:  [1.14211241e+02 4.52086911e-02]
mat_Sqrt:  [[ 2.42839773e+01  0.00000000e+00]
 [-8.50493420e-03  1.94872524e-02]]
grads:  [-0.01523106  2.40785829]
Stock Position:  -0.015231060525307046
Bond Position:  [9.95759887]


portfolio before change:  [8.24562378]
curr_Stock_Price:  112.48198166276676
curr_Factors:  [1.12481982e+02 4.55209155e-02]
mat_Sqrt:  [[ 2.39987407e+01  0.00000000e+00]
 [-8.53425244e-03  1.95544289e-02]]
grads:  [-2.27190910e-03  6.48986512e+00]
Stock Position:  -0.0022719090983716428
Bond Position:  [8.50117262]


portfolio before change:  [8.2491062]
curr_Stock_Price:  111.41692870580614
curr_Factors:  [1.11416929e+02 4.71573120e-02]
mat_Sqrt:  [[ 2.41950043e+01  0.00000000e+00]
 [-8.68629375e-03  1.99027993e-02]]
grads:  [-0.00987158  8.69586498]
Stock Position:  -0.009871584959482258
Bond Position:  [9.34896787]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.24611177]
Stock Price:  111.83865654269086
PL:  [-3.59254478]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-2.34160060e-01 -2.03490655e-02]
 [-2.49438789e-01 -6.41466021e-02]
 [ 8.77476617e-01 -7.55669452e-01]
 [-6.53762874e-02  1.08488059e-02]
 [-1.75174197e-01  7.34663760e-02]
 [ 1.96145073e-01  1.85358577e-01]
 [ 1.25022554e-01 -2.42775956e-02]
 [ 6.65671322e-01 -3.91769727e-02]
 [-6.63034845e-01 -4.95977947e-01]
 [ 1.00145364e+00 -8.67842255e-01]
 [ 6.29428824e-02 -3.21035283e-03]
 [-9.33739159e-01 -3.31157870e-01]
 [-4.99290659e-02  1.35860264e-01]
 [-1.32656466e+00 -1.55844977e+00]
 [-2.36783513e-01 -1.12022658e+00]
 [-2.25641462e-01 -4.00762409e-01]
 [ 4.45858706e-02  9.85976108e-02]
 [ 1.53791006e-01  1.57210047e-01]
 [-5.44138851e-01 -4.22316476e-01]
 [-9.16593473e-02 -3.11711969e-02]
 [ 2.12131648e-01  5.48518117e-01]
 [-2.26853309e-02  2.44495367e-01]
 [-1.12231394e-02 -1.06569965e-01]
 [ 1.04533936e-01  1.93104108e-01]
 [ 7.52121435e-02  1.57440631e-01]
 [ 8.08346011e-01 -7.28934413e-01]
 [-5.66535760e-01  7.12412958e-01]
 [ 1.35612671e-01 -1.03328749e-02]
 [-4.87036550e-02 -6.11612262e-02]
 [ 3.62343645e-02 -2.12985670e-01]
 [-6.87119462e-02 -7.53085304e-02]
 [ 4.77975628e-02 -8.77859303e-03]
 [ 2.50766166e-01  3.04995331e-01]
 [ 2.31241094e-01  2.52865050e-02]
 [-2.18275007e-01 -2.28595473e-01]
 [ 1.45394008e-01 -1.92437459e-01]
 [-1.45062288e-01  2.29623016e-01]
 [-1.23479337e-01  1.17750849e-01]
 [ 2.85340569e-01  6.94421454e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.61568364]
curr_Stock_Price:  99.04758172862745
curr_Factors:  [9.90475817e+01 4.16938357e-02]
mat_Sqrt:  [[ 2.02245935e+01  0.00000000e+00]
 [-8.16762738e-03  1.87143854e-02]]
grads:  [-0.01201711 -1.08734886]
Stock Position:  -0.012017107789893369
Bond Position:  [-2.42541818]


portfolio before change:  [-3.65314515]
curr_Stock_Price:  102.13969954285325
curr_Factors:  [1.02139700e+02 4.19942889e-02]
mat_Sqrt:  [[ 2.09309862e+01  0.00000000e+00]
 [-8.19700325e-03  1.87816939e-02]]
grads:  [-0.01325473 -3.41537895]
Stock Position:  -0.013254734312130579
Bond Position:  [-2.29931057]


portfolio before change:  [-3.66103445]
curr_Stock_Price:  102.7132203194275
curr_Factors:  [1.02713220e+02 4.19945057e-02]
mat_Sqrt:  [[ 2.10485693e+01  0.00000000e+00]
 [-8.19702441e-03  1.87817424e-02]]
grads:  [ 2.60196035e-02 -4.02342571e+01]
Stock Position:  0.026019603549091948
Bond Position:  [-6.33359172]


portfolio before change:  [-3.66313959]
curr_Stock_Price:  102.66274343826683
curr_Factors:  [1.02662743e+02 4.17808132e-02]
mat_Sqrt:  [[ 2.09846297e+01  0.00000000e+00]
 [-8.17614219e-03  1.87338952e-02]]
grads:  [-0.0028898   0.57910038]
Stock Position:  -0.0028898046433961898
Bond Position:  [-3.36646432]


portfolio before change:  [-3.66550666]
curr_Stock_Price:  103.33622712224418
curr_Factors:  [1.03336227e+02 4.13999136e-02]
mat_Sqrt:  [[ 2.10257898e+01  0.00000000e+00]
 [-8.13878749e-03  1.86483049e-02]]
grads:  [-0.00680644  3.93957394]
Stock Position:  -0.006806443084940801
Bond Position:  [-2.96215451]


portfolio before change:  [-3.66757705]
curr_Stock_Price:  103.58600565028561
curr_Factors:  [1.03586006e+02 4.26997367e-02]
mat_Sqrt:  [[ 2.14049237e+01  0.00000000e+00]
 [-8.26556584e-03  1.89387906e-02]]
grads:  [0.01294292 9.78724467]
Stock Position:  0.01294291869442844
Bond Position:  [-5.0082823]


portfolio before change:  [-3.66625713]
curr_Stock_Price:  103.73635781599279
curr_Factors:  [1.03736358e+02 4.11120789e-02]
mat_Sqrt:  [[ 2.10337019e+01  0.00000000e+00]
 [-8.11044550e-03  1.85833652e-02]]
grads:  [ 0.00544017 -1.30641546]
Stock Position:  0.005440171365080275
Bond Position:  [-4.2306007]


portfolio before change:  [-3.65017698]
curr_Stock_Price:  106.78938866818308
curr_Factors:  [1.06789389e+02 3.83398660e-02]
mat_Sqrt:  [[ 2.09099693e+01  0.00000000e+00]
 [-7.83222737e-03  1.79458874e-02]]
grads:  [ 0.03101741 -2.18306132]
Stock Position:  0.031017409883112985
Bond Position:  [-6.96250722]


portfolio before change:  [-3.58645662]
curr_Stock_Price:  108.87179090548175
curr_Factors:  [1.08871791e+02 3.80685728e-02]
mat_Sqrt:  [[ 2.12421594e+01  0.00000000e+00]
 [-7.80446772e-03  1.78822820e-02]]
grads:  [ -0.04140339 -27.73571884]
Stock Position:  -0.04140338788699775
Bond Position:  [0.92120436]


portfolio before change:  [-3.60538641]
curr_Stock_Price:  109.33177602579887
curr_Factors:  [1.09331776e+02 3.67032533e-02]
mat_Sqrt:  [[ 2.09458835e+01  0.00000000e+00]
 [-7.66323726e-03  1.75586824e-02]]
grads:  [ 2.97288116e-02 -4.94252492e+01]
Stock Position:  0.02972881163004273
Bond Position:  [-6.85569018]


portfolio before change:  [-3.57156081]
curr_Stock_Price:  110.49840902875629
curr_Factors:  [1.10498409e+02 3.67838801e-02]
mat_Sqrt:  [[ 2.11926270e+01  0.00000000e+00]
 [-7.67164964e-03  1.75779576e-02]]
grads:  [ 0.00290392 -0.18263514]
Stock Position:  0.002903923592375605
Bond Position:  [-3.89243975]


portfolio before change:  [-3.57508834]
curr_Stock_Price:  109.45122615876149
curr_Factors:  [1.09451226e+02 3.74808630e-02]
mat_Sqrt:  [[ 2.11897300e+01  0.00000000e+00]
 [-7.74398998e-03  1.77437101e-02]]
grads:  [ -0.05088636 -18.66339494]
Stock Position:  -0.05088636354371988
Bond Position:  [1.99448655]


portfolio before change:  [-3.59551405]
curr_Stock_Price:  109.85752435544835
curr_Factors:  [1.09857524e+02 3.75639507e-02]
mat_Sqrt:  [[ 2.12919501e+01  0.00000000e+00]
 [-7.75256868e-03  1.77633664e-02]]
grads:  [4.39847657e-04 7.64833989e+00]
Stock Position:  0.00043984765654034915
Bond Position:  [-3.64383462]


portfolio before change:  [-3.5960987]
curr_Stock_Price:  109.56390896398325
curr_Factors:  [1.09563909e+02 3.78147674e-02]
mat_Sqrt:  [[ 2.13058191e+01  0.00000000e+00]
 [-7.77840780e-03  1.78225713e-02]]
grads:  [ -0.09418685 -87.4424767 ]
Stock Position:  -0.09418684621349271
Bond Position:  [6.72338034]


portfolio before change:  [-3.75359024]
curr_Stock_Price:  111.24495060882526
curr_Factors:  [1.11244951e+02 3.78029096e-02]
mat_Sqrt:  [[ 2.16293228e+01  0.00000000e+00]
 [-7.77718814e-03  1.78197767e-02]]
grads:  [-3.35512341e-02 -6.28642320e+01]
Stock Position:  -0.033551234146072126
Bond Position:  [-0.02118485]


portfolio before change:  [-3.7899444]
curr_Stock_Price:  112.328413305246
curr_Factors:  [1.12328413e+02 3.68789509e-02]
mat_Sqrt:  [[ 2.15714284e+01  0.00000000e+00]
 [-7.68155723e-03  1.76006587e-02]]
grads:  [-1.85684745e-02 -2.27697392e+01]
Stock Position:  -0.018568474451655714
Bond Position:  [-1.70417712]


portfolio before change:  [-3.80142211]
curr_Stock_Price:  112.93506953805858
curr_Factors:  [1.12935070e+02 3.59207689e-02]
mat_Sqrt:  [[ 2.14043299e+01  0.00000000e+00]
 [-7.58111009e-03  1.73705054e-02]]
grads:  [4.09344260e-03 5.67615095e+00]
Stock Position:  0.004093442604565446
Bond Position:  [-4.26371534]


portfolio before change:  [-3.80787354]
curr_Stock_Price:  111.4892373352791
curr_Factors:  [1.11489237e+02 3.60519269e-02]
mat_Sqrt:  [[ 2.11688461e+01  0.00000000e+00]
 [-7.59493798e-03  1.74021891e-02]]
grads:  [0.01050615 9.03392358]
Stock Position:  0.010506151091132619
Bond Position:  [-4.97919631]


portfolio before change:  [-3.81229175]
curr_Stock_Price:  111.12794730323715
curr_Factors:  [1.11127947e+02 3.63835399e-02]
mat_Sqrt:  [[ 2.11970668e+01  0.00000000e+00]
 [-7.62978793e-03  1.74820404e-02]]
grads:  [ -0.03436574 -24.15716169]
Stock Position:  -0.034365739315006895
Bond Position:  [0.00670232]


portfolio before change:  [-3.75122031]
curr_Stock_Price:  109.35086940540464
curr_Factors:  [1.09350869e+02 3.75062697e-02]
mat_Sqrt:  [[ 2.11774749e+01  0.00000000e+00]
 [-7.74661420e-03  1.77497230e-02]]
grads:  [-0.00497054 -1.75615118]
Stock Position:  -0.004970544089101913
Bond Position:  [-3.207687]


portfolio before change:  [-3.74376445]
curr_Stock_Price:  107.7701871977235
curr_Factors:  [1.07770187e+02 3.91365391e-02]
mat_Sqrt:  [[ 2.13201299e+01  0.00000000e+00]
 [-7.91318284e-03  1.81313797e-02]]
grads:  [2.11783222e-02 3.02524203e+01]
Stock Position:  0.021178322233894566
Bond Position:  [-6.0261562]


portfolio before change:  [-3.75146428]
curr_Stock_Price:  107.44218591761323
curr_Factors:  [1.07442186e+02 3.77664534e-02]
mat_Sqrt:  [[ 2.08798770e+01  0.00000000e+00]
 [-7.77343717e-03  1.78111821e-02]]
grads:  [4.02402731e-03 1.37270713e+01]
Stock Position:  0.004024027308618577
Bond Position:  [-4.18381457]


portfolio before change:  [-3.76061501]
curr_Stock_Price:  105.29813589899527
curr_Factors:  [1.05298136e+02 3.65053985e-02]
mat_Sqrt:  [[ 2.01186683e+01  0.00000000e+00]
 [-7.64255439e-03  1.75112920e-02]]
grads:  [-2.86967728e-03 -6.08578540e+00]
Stock Position:  -0.0028696772848449802
Bond Position:  [-3.45844334]


portfolio before change:  [-3.76103015]
curr_Stock_Price:  105.29214429621267
curr_Factors:  [1.05292144e+02 3.50169756e-02]
mat_Sqrt:  [[ 1.97031329e+01  0.00000000e+00]
 [-7.48512932e-03  1.71505858e-02]]
grads:  [9.58281502e-03 1.12593301e+01]
Stock Position:  0.009582815021040027
Bond Position:  [-4.77002529]


portfolio before change:  [-3.75492451]
curr_Stock_Price:  105.99151382181647
curr_Factors:  [1.05991514e+02 3.45675953e-02]
mat_Sqrt:  [[ 1.97063267e+01  0.00000000e+00]
 [-7.43694510e-03  1.70401819e-02]]
grads:  [7.30348532e-03 9.23937498e+00]
Stock Position:  0.007303485315656337
Bond Position:  [-4.52903197]


portfolio before change:  [-3.74990289]
curr_Stock_Price:  106.7565984082096
curr_Factors:  [1.06756598e+02 3.58026554e-02]
mat_Sqrt:  [[ 2.02000455e+01  0.00000000e+00]
 [-7.56863585e-03  1.73419234e-02]]
grads:  [ 2.42679133e-02 -4.20330778e+01]
Stock Position:  0.024267913267034473
Bond Position:  [-6.34066276]


portfolio before change:  [-3.76263936]
curr_Stock_Price:  106.2644325069725
curr_Factors:  [1.06264433e+02 3.50971217e-02]
mat_Sqrt:  [[ 1.99078187e+01  0.00000000e+00]
 [-7.49369033e-03  1.71702016e-02]]
grads:  [-1.28398424e-02  4.14912402e+01]
Stock Position:  -0.012839842354307095
Bond Position:  [-2.3982208]


portfolio before change:  [-3.74975271]
curr_Stock_Price:  105.23743842209767
curr_Factors:  [1.05237438e+02 3.61515517e-02]
mat_Sqrt:  [[ 2.00093850e+01  0.00000000e+00]
 [-7.60542456e-03  1.74262169e-02]]
grads:  [ 0.00655208 -0.59294998]
Stock Position:  0.0065520771764299695
Bond Position:  [-4.43927653]


portfolio before change:  [-3.74764679]
curr_Stock_Price:  105.64354937345733
curr_Factors:  [1.05643549e+02 3.53547128e-02]
mat_Sqrt:  [[ 1.98639970e+01  0.00000000e+00]
 [-7.52113957e-03  1.72330957e-02]]
grads:  [-0.00379564 -3.54905626]
Stock Position:  -0.0037956410530991204
Bond Position:  [-3.34666179]


portfolio before change:  [-3.74568602]
curr_Stock_Price:  105.0167442815696
curr_Factors:  [1.05016744e+02 3.66762698e-02]
mat_Sqrt:  [[ 2.01118087e+01  0.00000000e+00]
 [-7.66041981e-03  1.75522268e-02]]
grads:  [-2.82024373e-03 -1.21343959e+01]
Stock Position:  -0.0028202437338110883
Bond Position:  [-3.4495132]


portfolio before change:  [-3.74558497]
curr_Stock_Price:  104.82801501091444
curr_Factors:  [1.04828015e+02 3.75485520e-02]
mat_Sqrt:  [[ 2.03129949e+01  0.00000000e+00]
 [-7.75097950e-03  1.77597251e-02]]
grads:  [-0.0050007  -4.24041081]
Stock Position:  -0.005000704427048554
Bond Position:  [-3.22137105]


portfolio before change:  [-3.74902269]
curr_Stock_Price:  105.43493392707252
curr_Factors:  [1.05434934e+02 3.82474244e-02]
mat_Sqrt:  [[ 2.06198560e+01  0.00000000e+00]
 [-7.82277949e-03  1.79242396e-02]]
grads:  [ 0.00213223 -0.48976097]
Stock Position:  0.002132229765593223
Bond Position:  [-3.9738342]


portfolio before change:  [-3.74666642]
curr_Stock_Price:  106.7729859444656
curr_Factors:  [1.06772986e+02 3.73587568e-02]
mat_Sqrt:  [[ 2.06375242e+01  0.00000000e+00]
 [-7.73136540e-03  1.77147836e-02]]
grads:  [ 0.01860093 17.21699449]
Stock Position:  0.018600925063184157
Bond Position:  [-5.73274273]


portfolio before change:  [-3.75294621]
curr_Stock_Price:  106.47390659079574
curr_Factors:  [1.06473907e+02 3.82985744e-02]
mat_Sqrt:  [[ 2.08369665e+01  0.00000000e+00]
 [-7.82800863e-03  1.79362210e-02]]
grads:  [0.01162727 1.40980115]
Stock Position:  0.01162726973985917
Bond Position:  [-4.99094704]


portfolio before change:  [-3.77625699]
curr_Stock_Price:  104.5227283619561
curr_Factors:  [1.04522728e+02 3.90568825e-02]
mat_Sqrt:  [[ 2.06566326e+01  0.00000000e+00]
 [-7.90512567e-03  1.81129184e-02]]
grads:  [ -0.01539662 -12.62057653]
Stock Position:  -0.015396616536538222
Bond Position:  [-2.16696062]


portfolio before change:  [-3.78690374]
curr_Stock_Price:  105.19663386363283
curr_Factors:  [1.05196634e+02 4.02269767e-02]
mat_Sqrt:  [[ 2.10989353e+01  0.00000000e+00]
 [-8.02266556e-03  1.83822361e-02]]
grads:  [ 2.91045090e-03 -1.04686643e+01]
Stock Position:  0.0029104508985384058
Bond Position:  [-4.09307338]


portfolio before change:  [-3.79439345]
curr_Stock_Price:  102.79905342949571
curr_Factors:  [1.02799053e+02 4.14918761e-02]
mat_Sqrt:  [[ 2.09397095e+01  0.00000000e+00]
 [-8.14782190e-03  1.86690053e-02]]
grads:  [-2.14170058e-03  1.22996920e+01]
Stock Position:  -0.002141700583026561
Bond Position:  [-3.57422866]


portfolio before change:  [-3.79080479]
curr_Stock_Price:  100.9148175467517
curr_Factors:  [1.00914818e+02 4.30346264e-02]
mat_Sqrt:  [[ 2.09345658e+01  0.00000000e+00]
 [-8.29791553e-03  1.90129130e-02]]
grads:  [-3.44352273e-03  6.19320401e+00]
Stock Position:  -0.003443522730396978
Bond Position:  [-3.44330232]


portfolio before change:  [-3.78996196]
curr_Stock_Price:  100.54506095541977
curr_Factors:  [1.00545061e+02 4.19205556e-02]
mat_Sqrt:  [[ 2.05861085e+01  0.00000000e+00]
 [-8.18980396e-03  1.87651983e-02]]
grads:  [0.01533304 3.70058148]
Stock Position:  0.015333039074422138
Bond Position:  [-5.33162331]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.80302117]
Stock Price:  99.73682466852951
PL:  [-3.80302117]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.88105598e-01  9.06251559e-01]
 [-2.06875577e-01 -7.50237336e-02]
 [ 8.11341293e-01 -6.77589125e-01]
 [ 5.43497505e-02  2.45479373e-02]
 [-1.37601893e-01  5.84295694e-02]
 [ 1.12635778e-01  1.19894288e-01]
 [ 3.06522592e-02  2.57112978e-01]
 [ 1.84799443e-01 -1.16215828e-02]
 [ 1.24069825e-01  8.34766329e-02]
 [ 4.09921854e-01 -2.38641561e-01]
 [ 6.14704809e-02 -8.29430717e-03]
 [-1.28626737e-01 -1.91440798e-01]
 [-1.19618166e-01  1.27939908e-01]
 [-6.97980363e-01 -9.57931296e-01]
 [-1.19286079e-01 -6.56069953e-01]
 [ 8.17531974e-03 -1.63355299e-01]
 [-5.29451209e-02  2.69224778e-01]
 [-2.80077751e-02  1.30239602e-01]
 [ 1.47391607e-02  6.98304669e-02]
 [-9.97963981e-02 -3.73504445e-02]
 [ 2.16702168e-01  3.35982408e-01]
 [ 2.87203977e-02  8.57519991e-02]
 [-1.13216986e-02 -1.15092706e-01]
 [ 5.72113595e-02  1.76624474e-01]
 [ 4.40258147e-02  9.65790993e-02]
 [ 7.33826100e-01 -3.92116193e-01]
 [-3.21775571e-01  4.16107735e-01]
 [ 1.63230808e-02  4.71637762e-02]
 [ 3.95022801e-02 -1.41727147e-01]
 [-5.15679848e-02 -3.43878574e-02]
 [-2.24958203e-01 -8.52237163e-02]
 [-1.17918542e-01 -6.52279763e-04]
 [ 1.44514431e-01  1.27936008e-01]
 [ 1.97854757e-01  4.24151698e-02]
 [-2.38254412e-01 -2.07701876e-01]
 [ 1.26563348e-01 -2.51316881e-01]
 [-1.59584796e-01  2.16758957e-01]
 [-1.21693447e-01  1.18955647e-01]
 [-5.76555181e-02  1.14412250e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.77077212]
curr_Stock_Price:  101.81687955871006
curr_Factors:  [1.01816880e+02 3.94230464e-02]
mat_Sqrt:  [[ 2.02159834e+01  0.00000000e+00]
 [-7.94209508e-03  1.81976259e-02]]
grads:  [4.37092861e-02 4.98005379e+01]
Stock Position:  0.04370928610536059
Bond Position:  [10.320429]


portfolio before change:  [14.763181]
curr_Stock_Price:  101.6136905559871
curr_Factors:  [1.01613691e+02 3.86544422e-02]
mat_Sqrt:  [[ 1.99779964e+01  0.00000000e+00]
 [-7.86429319e-03  1.80193594e-02]]
grads:  [-0.01199413 -4.16350725]
Stock Position:  -0.011994126653303733
Bond Position:  [15.98194848]


portfolio before change:  [14.76199176]
curr_Stock_Price:  101.87941350084326
curr_Factors:  [1.01879414e+02 3.90469989e-02]
mat_Sqrt:  [[ 2.01316915e+01  0.00000000e+00]
 [-7.90412539e-03  1.81106265e-02]]
grads:  [ 2.56122122e-02 -3.74138976e+01]
Stock Position:  0.025612212216249593
Bond Position:  [12.1526346]


portfolio before change:  [14.75974317]
curr_Stock_Price:  101.73230562679748
curr_Factors:  [1.01732306e+02 3.82582592e-02]
mat_Sqrt:  [[ 1.98985527e+01  0.00000000e+00]
 [-7.82388744e-03  1.79267782e-02]]
grads:  [0.00326975 1.36934462]
Stock Position:  0.003269752813071908
Bond Position:  [14.42710368]


portfolio before change:  [14.76277666]
curr_Stock_Price:  102.10847675184077
curr_Factors:  [1.02108477e+02 3.90151215e-02]
mat_Sqrt:  [[ 2.01687173e+01  0.00000000e+00]
 [-7.90089833e-03  1.81032323e-02]]
grads:  [-0.00555817  3.22757662]
Stock Position:  -0.005558168924873514
Bond Position:  [15.33031282]


portfolio before change:  [14.76064349]
curr_Stock_Price:  102.83705859630746
curr_Factors:  [1.02837059e+02 4.03009104e-02]
mat_Sqrt:  [[ 2.06446286e+01  0.00000000e+00]
 [-8.03003466e-03  1.83991208e-02]]
grads:  [0.00799055 6.51630529]
Stock Position:  0.007990549883266022
Bond Position:  [13.93891884]


portfolio before change:  [14.75603483]
curr_Stock_Price:  102.04222829677418
curr_Factors:  [1.02042228e+02 4.06303834e-02]
mat_Sqrt:  [[ 2.05686313e+01  0.00000000e+00]
 [-8.06279192e-03  1.84741771e-02]]
grads:  [6.94579819e-03 1.39174252e+01]
Stock Position:  0.0069457981932908005
Bond Position:  [14.04727011]


portfolio before change:  [14.74730342]
curr_Stock_Price:  100.53233250878446
curr_Factors:  [1.00532333e+02 4.19724750e-02]
mat_Sqrt:  [[ 2.05962450e+01  0.00000000e+00]
 [-8.19487401e-03  1.87768152e-02]]
grads:  [ 0.00872622 -0.61893259]
Stock Position:  0.008726220171344395
Bond Position:  [13.87003615]


portfolio before change:  [14.75673021]
curr_Stock_Price:  101.41392041588483
curr_Factors:  [1.01413920e+02 4.17173752e-02]
mat_Sqrt:  [[ 2.07136226e+01  0.00000000e+00]
 [-8.16993270e-03  1.87196675e-02]]
grads:  [0.00774862 4.45930105]
Stock Position:  0.007748621173380303
Bond Position:  [13.97091216]


portfolio before change:  [14.76774027]
curr_Stock_Price:  102.60943480531725
curr_Factors:  [1.02609435e+02 4.17327542e-02]
mat_Sqrt:  [[ 2.09616671e+01  0.00000000e+00]
 [-8.17143848e-03  1.87231177e-02]]
grads:  [  0.01458711 -12.7458239 ]
Stock Position:  0.01458710974455898
Bond Position:  [13.27096519]


portfolio before change:  [14.78058327]
curr_Stock_Price:  103.37614030287492
curr_Factors:  [1.03376140e+02 4.39563504e-02]
mat_Sqrt:  [[ 2.16736036e+01  0.00000000e+00]
 [-8.38630792e-03  1.92154454e-02]]
grads:  [ 0.00266917 -0.43164793]
Stock Position:  0.002669170733287921
Bond Position:  [14.5046547]


portfolio before change:  [14.77906328]
curr_Stock_Price:  102.12736952350465
curr_Factors:  [1.02127370e+02 4.51869931e-02]
mat_Sqrt:  [[ 2.17094523e+01  0.00000000e+00]
 [-8.50289297e-03  1.94825753e-02]]
grads:  [-9.77354692e-03 -9.82625728e+00]
Stock Position:  -0.009773546924484297
Bond Position:  [15.77720992]


portfolio before change:  [14.7615969]
curr_Stock_Price:  104.11627458690752
curr_Factors:  [1.04116275e+02 4.39442819e-02]
mat_Sqrt:  [[ 2.18257817e+01  0.00000000e+00]
 [-8.38515659e-03  1.92128074e-02]]
grads:  [-2.92226020e-03  6.65909489e+00]
Stock Position:  -0.0029222602006033676
Bond Position:  [15.06585174]


portfolio before change:  [14.76319665]
curr_Stock_Price:  104.21332053706973
curr_Factors:  [1.04213321e+02 4.33374641e-02]
mat_Sqrt:  [[ 2.16947666e+01  0.00000000e+00]
 [-8.32706086e-03  1.90796933e-02]]
grads:  [ -0.05144355 -50.2068497 ]
Stock Position:  -0.051443552221833604
Bond Position:  [20.12430005]


portfolio before change:  [14.63978992]
curr_Stock_Price:  106.66109913497863
curr_Factors:  [1.06661099e+02 4.08843746e-02]
mat_Sqrt:  [[ 2.15667515e+01  0.00000000e+00]
 [-8.08795397e-03  1.85318306e-02]]
grads:  [-1.88075836e-02 -3.54023284e+01]
Stock Position:  -0.0188075835862314
Bond Position:  [16.64582746]


portfolio before change:  [14.6784517]
curr_Stock_Price:  104.71609027633248
curr_Factors:  [1.0471609e+02 4.2703079e-02]
mat_Sqrt:  [[ 2.16392903e+01  0.00000000e+00]
 [-8.26588933e-03  1.89395318e-02]]
grads:  [-2.91685987e-03 -8.62509702e+00]
Stock Position:  -0.002916859874690302
Bond Position:  [14.98389386]


portfolio before change:  [14.6816238]
curr_Stock_Price:  104.27074855041643
curr_Factors:  [1.04270749e+02 4.26924019e-02]
mat_Sqrt:  [[ 2.15445678e+01  0.00000000e+00]
 [-8.26485590e-03  1.89371639e-02]]
grads:  [2.99631007e-03 1.42167423e+01]
Stock Position:  0.002996310066784915
Bond Position:  [14.3691963]


portfolio before change:  [14.68015693]
curr_Stock_Price:  103.18169821350351
curr_Factors:  [1.03181698e+02 4.24380657e-02]
mat_Sqrt:  [[ 2.12559472e+01  0.00000000e+00]
 [-8.24020055e-03  1.88806714e-02]]
grads:  [1.35648848e-03 6.89803873e+00]
Stock Position:  0.001356488478953606
Bond Position:  [14.54019214]


portfolio before change:  [14.68242528]
curr_Stock_Price:  103.51396520627388
curr_Factors:  [1.03513965e+02 4.29218294e-02]
mat_Sqrt:  [[ 2.14455929e+01  0.00000000e+00]
 [-8.28703367e-03  1.89879795e-02]]
grads:  [2.10839007e-03 3.67761440e+00]
Stock Position:  0.0021083900692084032
Bond Position:  [14.46417747]


portfolio before change:  [14.68369239]
curr_Stock_Price:  103.25735657896263
curr_Factors:  [1.03257357e+02 4.39929837e-02]
mat_Sqrt:  [[ 2.16577188e+01  0.00000000e+00]
 [-8.38980178e-03  1.92234509e-02]]
grads:  [-0.00536056 -1.94296252]
Stock Position:  -0.005360558482218699
Bond Position:  [15.23720948]


portfolio before change:  [14.67681002]
curr_Stock_Price:  104.89657773013298
curr_Factors:  [1.04896578e+02 4.24480643e-02]
mat_Sqrt:  [[ 2.16117664e+01  0.00000000e+00]
 [-8.24117120e-03  1.88828954e-02]]
grads:  [1.68119952e-02 1.77929497e+01]
Stock Position:  0.016811995190760834
Bond Position:  [12.91328925]


portfolio before change:  [14.67751106]
curr_Stock_Price:  104.8422583141769
curr_Factors:  [1.04842258e+02 4.28285196e-02]
mat_Sqrt:  [[ 2.16971604e+01  0.00000000e+00]
 [-8.27802098e-03  1.89673289e-02]]
grads:  [3.04858504e-03 4.52103718e+00]
Stock Position:  0.0030485850363605994
Bond Position:  [14.35789052]


portfolio before change:  [14.68083394]
curr_Stock_Price:  105.34348633462356
curr_Factors:  [1.05343486e+02 4.13850931e-02]
mat_Sqrt:  [[ 2.14303693e+01  0.00000000e+00]
 [-8.13733058e-03  1.86449667e-02]]
grads:  [-2.87219845e-03 -6.17285662e+00]
Stock Position:  -0.002872198452709688
Bond Position:  [14.98340134]


portfolio before change:  [14.68900179]
curr_Stock_Price:  103.15185279155182
curr_Factors:  [1.03151853e+02 3.99098229e-02]
mat_Sqrt:  [[ 2.06071026e+01  0.00000000e+00]
 [-7.99097720e-03  1.83096290e-02]]
grads:  [6.51700543e-03 9.64653485e+00]
Stock Position:  0.006517005433584855
Bond Position:  [14.01676061]


portfolio before change:  [14.69058284]
curr_Stock_Price:  103.12558954719574
curr_Factors:  [1.03125590e+02 3.93817037e-02]
mat_Sqrt:  [[ 2.04650917e+01  0.00000000e+00]
 [-7.93792958e-03  1.81880816e-02]]
grads:  [4.21089681e-03 5.31002123e+00]
Stock Position:  0.004210896811610313
Bond Position:  [14.25633162]


portfolio before change:  [14.69109608]
curr_Stock_Price:  102.82425019793348
curr_Factors:  [1.02824250e+02 4.06211747e-02]
mat_Sqrt:  [[ 2.07239144e+01  0.00000000e+00]
 [-8.06187816e-03  1.84720835e-02]]
grads:  [  0.02715185 -21.22750225]
Stock Position:  0.027151847463857973
Bond Position:  [11.89922773]


portfolio before change:  [14.72093626]
curr_Stock_Price:  103.86847674464363
curr_Factors:  [1.03868477e+02 4.04149587e-02]
mat_Sqrt:  [[ 2.08811701e+01  0.00000000e+00]
 [-8.04138880e-03  1.84251364e-02]]
grads:  [-6.7128071e-03  2.2583699e+01]
Stock Position:  -0.00671280709865735
Bond Position:  [15.41818531]


portfolio before change:  [14.73839823]
curr_Stock_Price:  101.55430756182616
curr_Factors:  [1.01554308e+02 4.24442817e-02]
mat_Sqrt:  [[ 2.09222286e+01  0.00000000e+00]
 [-8.24080401e-03  1.88820541e-02]]
grads:  [1.76401094e-03 2.49780961e+00]
Stock Position:  0.0017640109446197436
Bond Position:  [14.55925532]


portfolio before change:  [14.74084556]
curr_Stock_Price:  101.90992788244458
curr_Factors:  [1.01909928e+02 4.19776798e-02]
mat_Sqrt:  [[ 2.08797699e+01  0.00000000e+00]
 [-8.19538209e-03  1.87779794e-02]]
grads:  [-1.07053467e-03 -7.54751849e+00]
Stock Position:  -0.0010705346729228341
Bond Position:  [14.84994368]


portfolio before change:  [14.74305825]
curr_Stock_Price:  101.57707711838083
curr_Factors:  [1.01577077e+02 4.30341562e-02]
mat_Sqrt:  [[ 2.10718350e+01  0.00000000e+00]
 [-8.29787020e-03  1.90128092e-02]]
grads:  [-0.00315948 -1.80866789]
Stock Position:  -0.0031594816503631258
Bond Position:  [15.06398916]


portfolio before change:  [14.73838067]
curr_Stock_Price:  103.65358910029984
curr_Factors:  [1.03653589e+02 4.25928323e-02]
mat_Sqrt:  [[ 2.13920598e+01  0.00000000e+00]
 [-8.25521240e-03  1.89150678e-02]]
grads:  [-0.01225468 -4.50559929]
Stock Position:  -0.01225468160651823
Bond Position:  [16.0086224]


portfolio before change:  [14.74922288]
curr_Stock_Price:  102.9321496154298
curr_Factors:  [1.02932150e+02 4.34503527e-02]
mat_Sqrt:  [[ 2.14559474e+01  0.00000000e+00]
 [-8.33789928e-03  1.91045273e-02]]
grads:  [-0.00550911 -0.03414268]
Stock Position:  -0.005509112159614097
Bond Position:  [15.31628764]


portfolio before change:  [14.75232744]
curr_Stock_Price:  102.71616102568873
curr_Factors:  [1.02716161e+02 4.33964320e-02]
mat_Sqrt:  [[ 2.13976358e+01  0.00000000e+00]
 [-8.33272411e-03  1.90926695e-02]]
grads:  [0.0093632  6.70079207]
Stock Position:  0.009363197134321214
Bond Position:  [13.79057578]


portfolio before change:  [14.75827364]
curr_Stock_Price:  103.16710403111732
curr_Factors:  [1.03167104e+02 4.42083839e-02]
mat_Sqrt:  [[ 2.16916985e+01  0.00000000e+00]
 [-8.41031595e-03  1.92704547e-02]]
grads:  [0.00997461 2.20104665]
Stock Position:  0.009974611005406047
Bond Position:  [13.72922191]


portfolio before change:  [14.76633532]
curr_Stock_Price:  103.80326108292124
curr_Factors:  [1.03803261e+02 4.43134966e-02]
mat_Sqrt:  [[ 2.18513869e+01  0.00000000e+00]
 [-8.42030846e-03  1.92933505e-02]]
grads:  [ -0.01505181 -10.76546432]
Stock Position:  -0.015051810826827676
Bond Position:  [16.32876237]


portfolio before change:  [14.75956811]
curr_Stock_Price:  104.38846878743055
curr_Factors:  [1.04388469e+02 4.61199272e-02]
mat_Sqrt:  [[ 2.24179984e+01  0.00000000e+00]
 [-8.59022023e-03  1.96826672e-02]]
grads:  [ 7.52951662e-04 -1.27684362e+01]
Stock Position:  0.0007529516621225638
Bond Position:  [14.68096863]


portfolio before change:  [14.76066027]
curr_Stock_Price:  103.40158941487294
curr_Factors:  [1.03401589e+02 4.46778389e-02]
mat_Sqrt:  [[ 2.18561314e+01  0.00000000e+00]
 [-8.45485318e-03  1.93725023e-02]]
grads:  [-2.97323576e-03  1.11890015e+01]
Stock Position:  -0.0029732357619164603
Bond Position:  [15.06809757]


portfolio before change:  [14.76475114]
curr_Stock_Price:  102.65922080623241
curr_Factors:  [1.02659221e+02 4.58415919e-02]
mat_Sqrt:  [[ 2.19800061e+01  0.00000000e+00]
 [-8.56425987e-03  1.96231846e-02]]
grads:  [-3.17456444e-03  6.06199504e+00]
Stock Position:  -0.0031745644438709282
Bond Position:  [15.09064945]


portfolio before change:  [14.76506858]
curr_Stock_Price:  103.15346340327115
curr_Factors:  [1.03153463e+02 4.35915165e-02]
mat_Sqrt:  [[ 2.15369799e+01  0.00000000e+00]
 [-8.35143259e-03  1.91355360e-02]]
grads:  [-3.58542313e-04  5.97904599e+00]
Stock Position:  -0.0003585423132059772
Bond Position:  [14.80205346]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.76716141]
Stock Price:  102.47724203253276
PL:  [12.28991937]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.55095314e-01  7.00031034e-01]
 [-2.66548988e-01 -5.94123973e-02]
 [ 7.96121031e-01 -6.67235660e-01]
 [ 5.28301018e-02  2.12042366e-02]
 [-1.47418943e-01  6.23584497e-02]
 [ 8.73579149e-02  9.99770131e-02]
 [ 5.95541095e-03  3.13303165e-01]
 [ 9.81083399e-02 -3.76147211e-02]
 [ 1.57270515e-01  7.29177513e-02]
 [ 2.64706244e-01 -1.10957272e-01]
 [ 9.84719041e-02  1.21633761e-01]
 [-1.00319334e-01 -5.77608651e-03]
 [ 1.30698295e-01  4.93600228e-02]
 [-2.70994235e-01 -3.65053346e-01]
 [ 8.52832199e-02  2.29512177e-01]
 [ 4.98048881e-02  5.32380380e-03]
 [ 7.59050999e-04 -3.51797429e-02]
 [ 5.58712287e-02  5.97869394e-02]
 [ 1.83041397e-02 -1.86885011e-02]
 [ 3.94321174e-01 -1.19553321e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-3.16508736e-02  8.35547948e-02]
 [-3.07189135e-02 -1.00807868e-01]
 [ 3.31562323e-02 -1.51872849e-01]
 [ 5.00687089e-02  2.08875879e-01]
 [ 4.60234241e-02  1.82068520e-01]
 [ 8.54131191e-02  1.72070286e-01]
 [-1.54629773e-01  8.04111094e-02]
 [-4.31753478e-01  7.93850402e-02]
 [ 2.56448607e-01 -1.05420300e-01]
 [-1.33227265e+00 -1.49383209e-01]
 [ 1.07140541e-01  3.33818421e-01]
 [-6.21798262e-03 -1.28674795e-01]
 [ 1.91840539e-02  7.42900857e-02]
 [-5.80270294e-02  1.62324168e-01]
 [-1.50392680e+00 -1.10430251e-01]
 [-5.75965491e-02  2.57616758e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 1.04899157e+00 -2.20947743e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.14865488]
curr_Stock_Price:  101.12071389216477
curr_Factors:  [1.01120714e+02 3.93976739e-02]
mat_Sqrt:  [[ 2.00712961e+01  0.00000000e+00]
 [-7.93953892e-03  1.81917690e-02]]
grads:  [3.29133655e-02 3.84806465e+01]
Stock Position:  0.03291336553582341
Bond Position:  [6.82043186]


portfolio before change:  [10.19000414]
curr_Stock_Price:  102.35111540354853
curr_Factors:  [1.02351115e+02 3.86703704e-02]
mat_Sqrt:  [[ 2.01271251e+01  0.00000000e+00]
 [-7.86591334e-03  1.80230716e-02]]
grads:  [-0.01453157 -3.29646347]
Stock Position:  -0.014531567858979341
Bond Position:  [11.67732632]


portfolio before change:  [10.20025791]
curr_Stock_Price:  101.74594950606291
curr_Factors:  [1.01745950e+02 3.88309652e-02]
mat_Sqrt:  [[ 2.00496235e+01  0.00000000e+00]
 [-7.88222966e-03  1.80604570e-02]]
grads:  [ 2.51832916e-02 -3.69445612e+01]
Stock Position:  0.025183291585228355
Bond Position:  [7.63796]


portfolio before change:  [10.19787818]
curr_Stock_Price:  101.61353882509385
curr_Factors:  [1.01613539e+02 3.82613227e-02]
mat_Sqrt:  [[ 1.98761180e+01  0.00000000e+00]
 [-7.82420068e-03  1.79274959e-02]]
grads:  [0.00312357 1.18277738]
Stock Position:  0.00312356715379976
Bond Position:  [9.88048147]


portfolio before change:  [10.20165388]
curr_Stock_Price:  102.42689386780675
curr_Factors:  [1.02426894e+02 3.67193536e-02]
mat_Sqrt:  [[ 1.96273432e+01  0.00000000e+00]
 [-7.66491785e-03  1.75625331e-02]]
grads:  [-0.00612429  3.55065236]
Stock Position:  -0.0061242870804697975
Bond Position:  [10.82894559]


portfolio before change:  [10.20188354]
curr_Stock_Price:  102.61043386965126
curr_Factors:  [1.02610434e+02 3.58275482e-02]
mat_Sqrt:  [[ 1.94222736e+01  0.00000000e+00]
 [-7.57126655e-03  1.73479510e-02]]
grads:  [0.00674439 5.76304446]
Stock Position:  0.006744393737059635
Bond Position:  [9.50983837]


portfolio before change:  [10.19327028]
curr_Stock_Price:  101.15707058717236
curr_Factors:  [1.01157071e+02 3.65746024e-02]
mat_Sqrt:  [[ 1.93457714e+01  0.00000000e+00]
 [-7.64979502e-03  1.75278824e-02]]
grads:  [7.37588176e-03 1.78745588e+01]
Stock Position:  0.007375881760619798
Bond Position:  [9.44714769]


portfolio before change:  [10.18550433]
curr_Stock_Price:  99.94407329867259
curr_Factors:  [9.99440733e+01 3.63052960e-02]
mat_Sqrt:  [[ 1.90432924e+01  0.00000000e+00]
 [-7.62157947e-03  1.74632324e-02]]
grads:  [ 0.0042898  -2.15393807]
Stock Position:  0.004289800727828199
Bond Position:  [9.75676417]


portfolio before change:  [10.18576381]
curr_Stock_Price:  99.72024320506948
curr_Factors:  [9.97202432e+01 3.72012724e-02]
mat_Sqrt:  [[ 1.92336729e+01  0.00000000e+00]
 [-7.71505255e-03  1.76774061e-02]]
grads:  [0.00983143 4.12491237]
Stock Position:  0.009831425925918057
Bond Position:  [9.20537163]


portfolio before change:  [10.18760311]
curr_Stock_Price:  99.79027921431747
curr_Factors:  [9.97902792e+01 3.63995351e-02]
mat_Sqrt:  [[ 1.90386503e+01  0.00000000e+00]
 [-7.63146488e-03  1.74858827e-02]]
grads:  [ 0.01136008 -6.34553449]
Stock Position:  0.011360076313110899
Bond Position:  [9.05397792]


portfolio before change:  [10.18682148]
curr_Stock_Price:  99.6218431113998
curr_Factors:  [9.96218431e+01 3.55181918e-02]
mat_Sqrt:  [[ 1.87750022e+01  0.00000000e+00]
 [-7.53850827e-03  1.72728924e-02]]
grads:  [0.00807229 7.04188726]
Stock Position:  0.00807228823864612
Bond Position:  [9.38264525]


portfolio before change:  [10.1918357]
curr_Stock_Price:  100.09770753023976
curr_Factors:  [1.00097708e+02 3.48460801e-02]
mat_Sqrt:  [[ 1.86853439e+01  0.00000000e+00]
 [-7.46684191e-03  1.71086841e-02]]
grads:  [-0.00550379 -0.33761138]
Stock Position:  -0.005503790831229943
Bond Position:  [10.74275254]


portfolio before change:  [10.20101754]
curr_Stock_Price:  98.67343302886323
curr_Factors:  [9.86734330e+01 3.51203206e-02]
mat_Sqrt:  [[ 1.84918122e+01  0.00000000e+00]
 [-7.49616656e-03  1.71758753e-02]]
grads:  [0.00823287 2.87379955]
Stock Position:  0.0082328748159684
Bond Position:  [9.38865151]


portfolio before change:  [10.20302033]
curr_Stock_Price:  98.77414409427381
curr_Factors:  [9.87741441e+01 3.42935415e-02]
mat_Sqrt:  [[ 1.82915051e+01  0.00000000e+00]
 [-7.40740618e-03  1.69724998e-02]]
grads:  [ -0.02352549 -21.50851974]
Stock Position:  -0.023525487565836944
Bond Position:  [12.52673023]


portfolio before change:  [10.21252463]
curr_Stock_Price:  98.43670772488872
curr_Factors:  [9.84367077e+01 3.44335298e-02]
mat_Sqrt:  [[ 1.82661850e+01  0.00000000e+00]
 [-7.42250953e-03  1.70071059e-02]]
grads:  [1.01526698e-02 1.34950754e+01]
Stock Position:  0.010152669847552925
Bond Position:  [9.21312923]


portfolio before change:  [10.20535778]
curr_Stock_Price:  97.61736018472861
curr_Factors:  [9.76173602e+01 3.45215476e-02]
mat_Sqrt:  [[ 1.81372812e+01  0.00000000e+00]
 [-7.43199005e-03  1.70288285e-02]]
grads:  [0.0028741  0.31263477]
Stock Position:  0.002874101466375591
Bond Position:  [9.92479558]


portfolio before change:  [10.20754155]
curr_Stock_Price:  97.94549826753826
curr_Factors:  [9.79454983e+01 3.61482418e-02]
mat_Sqrt:  [[ 1.86220749e+01  0.00000000e+00]
 [-7.60507639e-03  1.74254191e-02]]
grads:  [-7.83728323e-04 -2.01887499e+00]
Stock Position:  -0.0007837283225143942
Bond Position:  [10.28430422]


portfolio before change:  [10.20971007]
curr_Stock_Price:  96.81896208382868
curr_Factors:  [9.68189621e+01 3.75441498e-02]
mat_Sqrt:  [[ 1.87599450e+01  0.00000000e+00]
 [-7.75052513e-03  1.77586840e-02]]
grads:  [0.00436912 3.36663118]
Stock Position:  0.004369116669821355
Bond Position:  [9.78669673]


portfolio before change:  [10.2021853]
curr_Stock_Price:  94.81668356906607
curr_Factors:  [9.48166836e+01 3.78432577e-02]
mat_Sqrt:  [[ 1.84450152e+01  0.00000000e+00]
 [-7.78133743e-03  1.78292839e-02]]
grads:  [ 5.50165399e-04 -1.04819135e+00]
Stock Position:  0.0005501653990556239
Bond Position:  [10.15002044]


portfolio before change:  [10.20289545]
curr_Stock_Price:  93.80121891593386
curr_Factors:  [9.38012189e+01 3.58889074e-02]
mat_Sqrt:  [[ 1.77700480e+01  0.00000000e+00]
 [-7.57774715e-03  1.73628000e-02]]
grads:  [ 0.01925396 -6.88560147]
Stock Position:  0.01925396189880595
Bond Position:  [8.39685036]


portfolio before change:  [10.22200593]
curr_Stock_Price:  94.73924962263996
curr_Factors:  [9.47392496e+01 3.56279770e-02]
mat_Sqrt:  [[ 1.78823883e+01  0.00000000e+00]
 [-7.55014988e-03  1.72995667e-02]]
grads:  [ 0.00235587 -2.18375352]
Stock Position:  0.0023558715866900722
Bond Position:  [9.99881243]


portfolio before change:  [10.22076243]
curr_Stock_Price:  93.68085705301063
curr_Factors:  [9.36808571e+01 3.58869564e-02]
mat_Sqrt:  [[ 1.77467638e+01  0.00000000e+00]
 [-7.57754117e-03  1.73623280e-02]]
grads:  [2.71341218e-04 4.81241886e+00]
Stock Position:  0.0002713412176767968
Bond Position:  [10.19534295]


portfolio before change:  [10.22201876]
curr_Stock_Price:  93.61390424131005
curr_Factors:  [9.36139042e+01 3.71282816e-02]
mat_Sqrt:  [[ 1.80381828e+01  0.00000000e+00]
 [-7.70748017e-03  1.76600556e-02]]
grads:  [-4.14205106e-03 -5.70824182e+00]
Stock Position:  -0.004142051062915562
Bond Position:  [10.60977233]


portfolio before change:  [10.22622901]
curr_Stock_Price:  92.9176426099995
curr_Factors:  [9.29176426e+01 3.86479870e-02]
mat_Sqrt:  [[ 1.82667642e+01  0.00000000e+00]
 [-7.86363651e-03  1.80178548e-02]]
grads:  [-1.81348556e-03 -8.42901949e+00]
Stock Position:  -0.0018134855609077568
Bond Position:  [10.39473382]


portfolio before change:  [10.22968278]
curr_Stock_Price:  91.72968381900641
curr_Factors:  [9.17296838e+01 3.71333431e-02]
mat_Sqrt:  [[ 1.76763227e+01  0.00000000e+00]
 [-7.70800551e-03  1.76612593e-02]]
grads:  [7.98976227e-03 1.18267829e+01]
Stock Position:  0.007989762274618818
Bond Position:  [9.49678441]


portfolio before change:  [10.23559836]
curr_Stock_Price:  92.32149246884995
curr_Factors:  [9.23214925e+01 3.66642539e-02]
mat_Sqrt:  [[ 1.76776383e+01  0.00000000e+00]
 [-7.65916486e-03  1.75493514e-02]]
grads:  [7.09849578e-03 1.03746581e+01]
Stock Position:  0.007098495783322723
Bond Position:  [9.58025464]


portfolio before change:  [10.23997256]
curr_Stock_Price:  92.7689944885172
curr_Factors:  [9.27689945e+01 3.59988482e-02]
mat_Sqrt:  [[ 1.76013975e+01  0.00000000e+00]
 [-7.58934497e-03  1.73893739e-02]]
grads:  [9.11920478e-03 9.89513981e+00]
Stock Position:  0.00911920477986212
Bond Position:  [9.3939931]


portfolio before change:  [10.23998113]
curr_Stock_Price:  92.64115933556283
curr_Factors:  [9.26411593e+01 3.49247018e-02]
mat_Sqrt:  [[ 1.73129205e+01  0.00000000e+00]
 [-7.47526072e-03  1.71279740e-02]]
grads:  [-0.00690441  4.69472392]
Stock Position:  -0.006904409190245651
Bond Position:  [10.8796136]


portfolio before change:  [10.24057388]
curr_Stock_Price:  92.75228982503018
curr_Factors:  [9.27522898e+01 3.63564671e-02]
mat_Sqrt:  [[ 1.76854240e+01  0.00000000e+00]
 [-7.62694876e-03  1.74755350e-02]]
grads:  [-0.02245391  4.54263862]
Stock Position:  -0.02245391489206878
Bond Position:  [12.3232259]


portfolio before change:  [10.25153516]
curr_Stock_Price:  92.33272912600518
curr_Factors:  [9.23327291e+01 3.58286296e-02]
mat_Sqrt:  [[ 1.74771563e+01  0.00000000e+00]
 [-7.57138081e-03  1.73482128e-02]]
grads:  [ 0.01204083 -6.07672393]
Stock Position:  0.012040827012869357
Bond Position:  [9.13977274]


portfolio before change:  [10.2648049]
curr_Stock_Price:  93.33990266613723
curr_Factors:  [9.33399027e+01 3.50817681e-02]
mat_Sqrt:  [[ 1.74826829e+01  0.00000000e+00]
 [-7.49205105e-03  1.71664455e-02]]
grads:  [-0.07993446 -8.70204662]
Stock Position:  -0.07993446051549837
Bond Position:  [17.72587967]


portfolio before change:  [10.23819274]
curr_Stock_Price:  93.70054857412791
curr_Factors:  [9.37005486e+01 3.52024077e-02]
mat_Sqrt:  [[ 1.75803824e+01  0.00000000e+00]
 [-7.50492188e-03  1.71959363e-02]]
grads:  [1.43814189e-02 1.94126342e+01]
Stock Position:  0.01438141892370672
Bond Position:  [8.8906459]


portfolio before change:  [10.23642406]
curr_Stock_Price:  93.50028470075229
curr_Factors:  [9.35002847e+01 3.73102425e-02]
mat_Sqrt:  [[ 1.80603835e+01  0.00000000e+00]
 [-7.72634376e-03  1.77032776e-02]]
grads:  [-3.45376205e-03 -7.26841653e+00]
Stock Position:  -0.003453762053469729
Bond Position:  [10.5593518]


portfolio before change:  [10.23488122]
curr_Stock_Price:  94.32919015299544
curr_Factors:  [9.43291902e+01 3.70602900e-02]
mat_Sqrt:  [[ 1.81593589e+01  0.00000000e+00]
 [-7.70041973e-03  1.76438781e-02]]
grads:  [2.84189027e-03 4.21053042e+00]
Stock Position:  0.0028418902727890007
Bond Position:  [9.96680801]


portfolio before change:  [10.23965314]
curr_Stock_Price:  95.56990941735572
curr_Factors:  [9.55699094e+01 3.80309848e-02]
mat_Sqrt:  [[ 1.86375989e+01  0.00000000e+00]
 [-7.80061380e-03  1.78734516e-02]]
grads:  [6.87698320e-04 9.08185902e+00]
Stock Position:  0.0006876983203262557
Bond Position:  [10.17392987]


portfolio before change:  [10.2402204]
curr_Stock_Price:  94.54539825003707
curr_Factors:  [9.45453983e+01 3.83058611e-02]
mat_Sqrt:  [[ 1.85043149e+01  0.00000000e+00]
 [-7.82875327e-03  1.79379272e-02]]
grads:  [-0.08387895 -6.15624368]
Stock Position:  -0.08387895045059754
Bond Position:  [18.17058918]


portfolio before change:  [10.17167201]
curr_Stock_Price:  95.38970854579166
curr_Factors:  [9.53897085e+01 3.92565888e-02]
mat_Sqrt:  [[ 1.88998258e+01  0.00000000e+00]
 [-7.92531022e-03  1.81591670e-02]]
grads:  [2.90143530e-03 1.41865956e+01]
Stock Position:  0.0029014353032968654
Bond Position:  [9.89490494]


portfolio before change:  [10.17353445]
curr_Stock_Price:  95.60529257544769
curr_Factors:  [9.56052926e+01 3.93308197e-02]
mat_Sqrt:  [[ 1.89604410e+01  0.00000000e+00]
 [-7.93279973e-03  1.81763276e-02]]
grads:  [-4.65101078e-03  6.01671397e+00]
Stock Position:  -0.004651010777687989
Bond Position:  [10.6181957]


portfolio before change:  [10.17796815]
curr_Stock_Price:  94.93740633123369
curr_Factors:  [9.49374063e+01 3.95425492e-02]
mat_Sqrt:  [[ 1.88785961e+01  0.00000000e+00]
 [-7.95412338e-03  1.82251862e-02]]
grads:  [ 0.05505434 -1.21232091]
Stock Position:  0.05505433874069506
Bond Position:  [4.95125203]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.14990504]
Stock Price:  94.41642906524494
PL:  [10.14990504]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.54551123e-02  2.16954360e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.68570017e-01 -8.10851560e-01]
 [-2.15667779e-02  1.94889105e-01]
 [ 2.17933360e-02 -8.74825018e-02]
 [-7.35402008e-02 -5.65342493e-02]
 [-1.48772296e-01  5.45428052e-02]
 [ 1.42370216e-01 -1.62406586e-01]
 [ 1.64018272e-01  1.65770158e-01]
 [-1.94671882e-01  5.03800827e-01]
 [ 2.53116576e-01  8.11405738e-01]
 [ 2.51472491e-02  4.16870168e-01]
 [ 5.12536388e-01  2.75423105e-02]
 [-8.85098086e-02  1.55123860e-01]
 [ 1.00036862e-01  2.58531683e-01]
 [ 1.29814870e-02  4.93027114e-01]
 [ 3.71100483e-01  1.03342114e+00]
 [ 1.88314661e-01  1.33770994e-02]
 [-2.34724126e-01 -5.37217212e-01]
 [ 8.46270144e-01 -1.66602744e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 8.04276871e-03 -1.54758443e-01]
 [-1.95213906e-01  4.73073164e-01]
 [ 1.50391451e-01 -6.80363217e-01]
 [ 1.19337766e-01  3.59601022e-01]
 [-6.61586338e-02  7.50752373e-02]
 [-3.66058231e-02  1.50737890e-01]
 [-1.36919115e-01  3.90852029e-02]
 [-6.56648095e-01  1.56758594e-01]
 [ 2.89223500e-01 -1.11262218e-01]
 [-1.54448441e+00 -1.73934196e-01]
 [ 3.26515229e-01  5.95900692e-01]
 [ 4.54295396e-02 -1.46739459e-01]
 [ 1.23652435e-01  1.27679812e-03]
 [ 2.52704669e-02  1.78799281e-01]
 [-2.55691812e+00  3.32384812e-01]
 [-1.60390248e-01  4.90391644e-02]
 [-1.35035957e-01 -9.75933944e-02]
 [ 1.27176972e+00 -5.10752356e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.86336784]
curr_Stock_Price:  99.72219937728264
curr_Factors:  [9.97221994e+01 4.19375124e-02]
mat_Sqrt:  [[ 2.04217606e+01  0.00000000e+00]
 [-8.19146017e-03  1.87689931e-02]]
grads:  [2.90041267e-03 1.15591901e+01]
Stock Position:  0.002900412670606942
Bond Position:  [0.57413231]


portfolio before change:  [0.86371613]
curr_Stock_Price:  99.81753821388861
curr_Factors:  [9.98175382e+01 4.17699405e-02]
mat_Sqrt:  [[ 2.04004047e+01  0.00000000e+00]
 [-8.17507828e-03  1.87314575e-02]]
grads:  [-0.00995002 -4.69858633]
Stock Position:  -0.009950020646534705
Bond Position:  [1.8569027]


portfolio before change:  [0.88401649]
curr_Stock_Price:  97.8006347658985
curr_Factors:  [9.78006348e+01 4.13333014e-02]
mat_Sqrt:  [[ 1.98834491e+01  0.00000000e+00]
 [-8.13223723e-03  1.86332963e-02]]
grads:  [ 2.58851159e-02 -4.35162703e+01]
Stock Position:  0.025885115901398397
Bond Position:  [-1.64756428]


portfolio before change:  [0.87588888]
curr_Stock_Price:  97.49460356185284
curr_Factors:  [9.74946036e+01 4.10280656e-02]
mat_Sqrt:  [[ 1.97479081e+01  0.00000000e+00]
 [-8.10215434e-03  1.85643678e-02]]
grads:  [3.21501399e-03 1.04980201e+01]
Stock Position:  0.0032150139871560935
Bond Position:  [0.56244236]


portfolio before change:  [0.87454936]
curr_Stock_Price:  97.05608916965964
curr_Factors:  [9.70560892e+01 4.22904301e-02]
mat_Sqrt:  [[ 1.99592326e+01  0.00000000e+00]
 [-8.22585486e-03  1.88478013e-02]]
grads:  [-8.21031466e-04 -4.64152293e+00]
Stock Position:  -0.00082103146617656
Bond Position:  [0.95423546]


portfolio before change:  [0.87587825]
curr_Stock_Price:  95.58280824016894
curr_Factors:  [9.55828082e+01 4.36748121e-02]
mat_Sqrt:  [[ 1.99753919e+01  0.00000000e+00]
 [-8.35940783e-03  1.91538096e-02]]
grads:  [-0.00491674 -2.95159295]
Stock Position:  -0.004916738080555639
Bond Position:  [1.34583389]


portfolio before change:  [0.87602021]
curr_Stock_Price:  95.58815497506743
curr_Factors:  [9.55881550e+01 4.53878124e-02]
mat_Sqrt:  [[ 2.03644978e+01  0.00000000e+00]
 [-8.52176624e-03  1.95258194e-02]]
grads:  [-0.00613656  2.79336831]
Stock Position:  -0.006136555182958635
Bond Position:  [1.46260219]


portfolio before change:  [0.87799587]
curr_Stock_Price:  95.29599894899422
curr_Factors:  [9.52959989e+01 4.60646944e-02]
mat_Sqrt:  [[ 2.04530822e+01  0.00000000e+00]
 [-8.58507490e-03  1.96708778e-02]]
grads:  [ 3.49532508e-03 -8.25619412e+00]
Stock Position:  0.003495325081218173
Bond Position:  [0.54490538]


portfolio before change:  [0.87350825]
curr_Stock_Price:  93.99261867736217
curr_Factors:  [9.39926187e+01 4.52564562e-02]
mat_Sqrt:  [[ 1.99955807e+01  0.00000000e+00]
 [-8.50942595e-03  1.94975443e-02]]
grads:  [0.01182093 8.50210448]
Stock Position:  0.011820927049690066
Bond Position:  [-0.23757163]


portfolio before change:  [0.85508003]
curr_Stock_Price:  92.43618228106804
curr_Factors:  [9.24361823e+01 4.53696360e-02]
mat_Sqrt:  [[ 1.96890448e+01  0.00000000e+00]
 [-8.52005972e-03  1.95219093e-02]]
grads:  [1.28014461e-03 2.58069444e+01]
Stock Position:  0.0012801446119359294
Bond Position:  [0.73674835]


portfolio before change:  [0.85332791]
curr_Stock_Price:  90.99554338365397
curr_Factors:  [9.09955434e+01 4.64942863e-02]
mat_Sqrt:  [[ 1.96209448e+01  0.00000000e+00]
 [-8.62501351e-03  1.97623886e-02]]
grads:  [3.09487173e-02 4.10580802e+01]
Stock Position:  0.030948717273321054
Bond Position:  [-1.96286744]


portfolio before change:  [0.84113733]
curr_Stock_Price:  90.6095756804092
curr_Factors:  [9.06095757e+01 4.57920482e-02]
mat_Sqrt:  [[ 1.93896126e+01  0.00000000e+00]
 [-8.55963067e-03  1.96125777e-02]]
grads:  [1.06801673e-02 2.12552462e+01]
Stock Position:  0.010680167298815232
Bond Position:  [-0.1265881]


portfolio before change:  [0.8405849]
curr_Stock_Price:  90.55933253101142
curr_Factors:  [9.05593325e+01 4.83464856e-02]
mat_Sqrt:  [[ 1.99120360e+01  0.00000000e+00]
 [-8.79513371e-03  2.01521830e-02]]
grads:  [0.02634371 1.36671598]
Stock Position:  0.02634370683988768
Bond Position:  [-1.54508361]


portfolio before change:  [0.80323907]
curr_Stock_Price:  89.14902691535136
curr_Factors:  [8.91490269e+01 4.94918505e-02]
mat_Sqrt:  [[ 1.98327736e+01  0.00000000e+00]
 [-8.89870557e-03  2.03894959e-02]]
grads:  [-1.04918285e-03  7.60802817e+00]
Stock Position:  -0.0010491828520747136
Bond Position:  [0.8967727]


portfolio before change:  [0.80335731]
curr_Stock_Price:  89.14318388666277
curr_Factors:  [8.91431839e+01 4.93701837e-02]
mat_Sqrt:  [[ 1.98070826e+01  0.00000000e+00]
 [-8.88776091e-03  2.03644186e-02]]
grads:  [1.07471324e-02 1.26952647e+01]
Stock Position:  0.010747132399486123
Bond Position:  [-0.15467629]


portfolio before change:  [0.79319417]
curr_Stock_Price:  88.19932238462833
curr_Factors:  [8.81993224e+01 4.95001840e-02]
mat_Sqrt:  [[ 1.96231469e+01  0.00000000e+00]
 [-8.89945472e-03  2.03912125e-02]]
grads:  [1.16268895e-02 2.41784110e+01]
Stock Position:  0.011626889491328804
Bond Position:  [-0.23228961]


portfolio before change:  [0.79205203]
curr_Stock_Price:  88.10358749377686
curr_Factors:  [8.81035875e+01 4.98081706e-02]
mat_Sqrt:  [[ 1.96627333e+01  0.00000000e+00]
 [-8.92709768e-03  2.04545504e-02]]
grads:  [4.18111985e-02 5.05227991e+01]
Stock Position:  0.04181119854775519
Bond Position:  [-2.89166456]


portfolio before change:  [0.78175722]
curr_Stock_Price:  87.86601170032708
curr_Factors:  [8.78660117e+01 4.89153198e-02]
mat_Sqrt:  [[ 1.94331572e+01  0.00000000e+00]
 [-8.84672322e-03  2.02703894e-02]]
grads:  [0.00999081 0.65993302]
Stock Position:  0.009990806165168249
Bond Position:  [-0.09609507]


portfolio before change:  [0.77540386]
curr_Stock_Price:  87.23129382754398
curr_Factors:  [8.72312938e+01 4.90325564e-02]
mat_Sqrt:  [[ 1.93158837e+01  0.00000000e+00]
 [-8.85731846e-03  2.02946661e-02]]
grads:  [-2.42901100e-02 -2.64708573e+01]
Stock Position:  -0.024290109957701745
Bond Position:  [2.89426158]


portfolio before change:  [0.77614556]
curr_Stock_Price:  87.21565400424252
curr_Factors:  [8.72156540e+01 4.91314536e-02]
mat_Sqrt:  [[ 1.93318870e+01  0.00000000e+00]
 [-8.86624643e-03  2.03151227e-02]]
grads:  [ 0.04001465 -8.20092238]
Stock Position:  0.04001465272113319
Bond Position:  [-2.71375854]


portfolio before change:  [0.81260119]
curr_Stock_Price:  88.13518893840377
curr_Factors:  [8.81351889e+01 4.95344599e-02]
mat_Sqrt:  [[ 1.96156659e+01  0.00000000e+00]
 [-8.90253536e-03  2.03982711e-02]]
grads:  [ 0.0021477 -1.8520192]
Stock Position:  0.002147702292555983
Bond Position:  [0.62331305]


portfolio before change:  [0.81290625]
curr_Stock_Price:  88.24094688988752
curr_Factors:  [8.82409469e+01 4.91429583e-02]
mat_Sqrt:  [[ 1.95614394e+01  0.00000000e+00]
 [-8.86728444e-03  2.03175011e-02]]
grads:  [-3.04166540e-03 -7.61700186e+00]
Stock Position:  -0.003041665401012781
Bond Position:  [1.08130568]


portfolio before change:  [0.81787197]
curr_Stock_Price:  86.65281882418634
curr_Factors:  [8.66528188e+01 4.93019296e-02]
mat_Sqrt:  [[ 1.92404247e+01  0.00000000e+00]
 [-8.88161513e-03  2.03503368e-02]]
grads:  [5.84818155e-04 2.32464538e+01]
Stock Position:  0.0005848181554776782
Bond Position:  [0.76719583]


portfolio before change:  [0.81876413]
curr_Stock_Price:  88.01434638784488
curr_Factors:  [8.80143464e+01 4.85528092e-02]
mat_Sqrt:  [[ 1.93936989e+01  0.00000000e+00]
 [-8.81388080e-03  2.01951380e-02]]
grads:  [-7.55623779e-03 -3.36894563e+01]
Stock Position:  -0.007556237790438016
Bond Position:  [1.48382146]


portfolio before change:  [0.81703976]
curr_Stock_Price:  88.26709910222081
curr_Factors:  [8.82670991e+01 4.82279101e-02]
mat_Sqrt:  [[ 1.93842086e+01  0.00000000e+00]
 [-8.78434153e-03  2.01274550e-02]]
grads:  [1.42528655e-02 1.78661943e+01]
Stock Position:  0.014252865523541951
Bond Position:  [-0.44101934]


portfolio before change:  [0.8195506]
curr_Stock_Price:  88.44713108854626
curr_Factors:  [8.84471311e+01 4.77921238e-02]
mat_Sqrt:  [[ 1.93357898e+01  0.00000000e+00]
 [-8.74456392e-03  2.00363130e-02]]
grads:  [-1.72701061e-03  3.74695869e+00]
Stock Position:  -0.0017270106069997527
Bond Position:  [0.97229973]


portfolio before change:  [0.81951086]
curr_Stock_Price:  88.5405189770031
curr_Factors:  [8.85405190e+01 4.84324098e-02]
mat_Sqrt:  [[ 1.94854349e+01  0.00000000e+00]
 [-8.80294585e-03  2.01700829e-02]]
grads:  [1.49761018e-03 7.47334015e+00]
Stock Position:  0.0014976101754271731
Bond Position:  [0.68691168]


portfolio before change:  [0.81988529]
curr_Stock_Price:  88.73319649124943
curr_Factors:  [8.87331965e+01 4.83506582e-02]
mat_Sqrt:  [[ 1.95113501e+01  0.00000000e+00]
 [-8.79551324e-03  2.01530526e-02]]
grads:  [-0.00614314  1.93941849]
Stock Position:  -0.006143138891604442
Bond Position:  [1.36498564]


portfolio before change:  [0.81749817]
curr_Stock_Price:  89.1495544855643
curr_Factors:  [8.91495545e+01 4.73661184e-02]
mat_Sqrt:  [[ 1.94022937e+01  0.00000000e+00]
 [-8.70550340e-03  1.99468141e-02]]
grads:  [-0.03031771  7.85882864]
Stock Position:  -0.030317705905137847
Bond Position:  [3.52030815]


portfolio before change:  [0.76613481]
curr_Stock_Price:  90.85824006030137
curr_Factors:  [9.08582401e+01 4.65698918e-02]
mat_Sqrt:  [[ 1.96072612e+01  0.00000000e+00]
 [-8.63202334e-03  1.97784502e-02]]
grads:  [ 0.01227426 -5.62542651]
Stock Position:  0.012274263293273857
Bond Position:  [-0.34908315]


portfolio before change:  [0.77047547]
curr_Stock_Price:  91.2154338869613
curr_Factors:  [9.12154339e+01 4.63268738e-02]
mat_Sqrt:  [[ 1.96329168e+01  0.00000000e+00]
 [-8.60947142e-03  1.97267772e-02]]
grads:  [-0.08253463 -8.81716226]
Stock Position:  -0.08253462970314471
Bond Position:  [8.29890753]


portfolio before change:  [0.84096574]
curr_Stock_Price:  90.37393443952342
curr_Factors:  [9.03739344e+01 4.85591852e-02]
mat_Sqrt:  [[ 1.99149346e+01  0.00000000e+00]
 [-8.81445950e-03  2.01964639e-02]]
grads:  [2.94546592e-02 2.95051992e+01]
Stock Position:  0.029454659235188446
Bond Position:  [-1.8209677]


portfolio before change:  [0.8295358]
curr_Stock_Price:  89.99361072038637
curr_Factors:  [8.99936107e+01 4.77759623e-02]
mat_Sqrt:  [[ 1.96705453e+01  0.00000000e+00]
 [-8.74308525e-03  2.00329250e-02]]
grads:  [-9.46227493e-04 -7.32491432e+00]
Stock Position:  -0.0009462274931389925
Bond Position:  [0.91469023]


portfolio before change:  [0.83002125]
curr_Stock_Price:  89.60141114439557
curr_Factors:  [8.96014111e+01 4.89575747e-02]
mat_Sqrt:  [[ 1.98255296e+01  0.00000000e+00]
 [-8.85054346e-03  2.02791427e-02]]
grads:  [0.00626514 0.06296115]
Stock Position:  0.006265137848376261
Bond Position:  [0.26865606]


portfolio before change:  [0.81991005]
curr_Stock_Price:  87.9821677478918
curr_Factors:  [8.79821677e+01 4.95060101e-02]
mat_Sqrt:  [[ 1.95759849e+01  0.00000000e+00]
 [-8.89997844e-03  2.03924124e-02]]
grads:  [5.27712252e-03 8.76793179e+00]
Stock Position:  0.005277122521408532
Bond Position:  [0.35561737]


portfolio before change:  [0.81829108]
curr_Stock_Price:  87.66695211516236
curr_Factors:  [8.76669521e+01 4.99602258e-02]
mat_Sqrt:  [[ 1.95951280e+01  0.00000000e+00]
 [-8.94071369e-03  2.04857486e-02]]
grads:  [-0.12308435 16.22517281]
Stock Position:  -0.12308434508306206
Bond Position:  [11.60872046]


portfolio before change:  [0.72321086]
curr_Stock_Price:  88.45122238890467
curr_Factors:  [8.84512224e+01 4.74280642e-02]
mat_Sqrt:  [[ 1.92628942e+01  0.00000000e+00]
 [-8.71119410e-03  1.99598532e-02]]
grads:  [-0.00721531  2.45689003]
Stock Position:  -0.007215312549124531
Bond Position:  [1.36141408]


portfolio before change:  [0.70585526]
curr_Stock_Price:  90.88019468734198
curr_Factors:  [9.08801947e+01 4.67758921e-02]
mat_Sqrt:  [[ 1.96553277e+01  0.00000000e+00]
 [-8.65109400e-03  1.98221466e-02]]
grads:  [-0.0090372  -4.92345237]
Stock Position:  -0.009037204003073382
Bond Position:  [1.52715812]


portfolio before change:  [0.68726153]
curr_Stock_Price:  92.95878380709536
curr_Factors:  [9.29587838e+01 4.53175930e-02]
mat_Sqrt:  [[ 1.97890001e+01  0.00000000e+00]
 [-8.51517169e-03  1.95107094e-02]]
grads:  [ 0.06314006 -2.61780515]
Stock Position:  0.06314006024060662
Bond Position:  [-5.18216168]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.73709728]
Stock Price:  93.75833263771719
PL:  [0.73709728]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.14491553e-01  6.49970086e-01]
 [-1.87758016e-01 -7.58543582e-02]
 [ 8.13341545e-01 -6.78949780e-01]
 [-1.24258080e-02  2.07565773e-02]
 [-1.15664455e-01  4.96499906e-02]
 [ 1.09849578e-02  4.03336034e-02]
 [ 4.34810891e-02  2.14377002e-01]
 [ 4.09067234e-01 -1.29938828e-02]
 [ 1.09970160e-01  8.79607776e-02]
 [ 3.32095612e-01 -1.59990694e-01]
 [ 6.92301559e-02  1.84985437e-02]
 [-1.15098631e-01 -4.36775756e-02]
 [-1.35177377e-02  1.07501834e-01]
 [-4.86423634e-01 -6.26815573e-01]
 [ 7.31941399e-02  2.12187814e-01]
 [ 5.34369411e-02 -2.00455172e-02]
 [-5.25936649e-02  2.49468303e-01]
 [-1.05020486e-01  5.86541307e-02]
 [ 1.49791560e-02  6.38713480e-02]
 [-1.01525995e-01 -3.56709456e-02]
 [ 2.34307475e-01  2.37633431e-01]
 [ 7.34121878e-03  9.81860162e-02]
 [ 3.83654583e-02  4.17991905e-01]
 [ 1.52803993e-03  1.57124272e-01]
 [ 1.89070940e-02  4.44655703e-02]
 [ 6.96517870e-01 -2.53202763e-01]
 [-2.53209152e-02  7.19621644e-02]
 [-8.32586954e-02  9.15971517e-02]
 [ 6.74958585e-02 -1.66884334e-01]
 [-5.72286393e-02 -3.30966047e-02]
 [-5.33078747e-01 -1.03109811e-01]
 [-1.17965461e-01  1.16911998e-03]
 [ 1.36337545e-01  1.14309937e-01]
 [ 1.80913246e-01  5.11069128e-02]
 [-2.90880298e-01 -1.70380179e-01]
 [-2.91987502e-01 -3.78617019e-01]
 [-8.74962698e-02  2.81010799e-01]
 [-1.23561067e-01  1.17695712e-01]
 [ 3.05029778e-01  6.68718131e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.18367979]
curr_Stock_Price:  100.97537302557697
curr_Factors:  [1.00975373e+02 4.01920321e-02]
mat_Sqrt:  [[ 2.02434929e+01  0.00000000e+00]
 [-8.01918022e-03  1.83742502e-02]]
grads:  [2.95483472e-02 3.53739652e+01]
Stock Position:  0.02954834715322822
Bond Position:  [6.20002442]


portfolio before change:  [9.19537175]
curr_Stock_Price:  101.34483206045691
curr_Factors:  [1.01344832e+02 4.04918847e-02]
mat_Sqrt:  [[ 2.03932106e+01  0.00000000e+00]
 [-8.04903818e-03  1.84426634e-02]]
grads:  [-0.01083025 -4.11298285]
Stock Position:  -0.010830250167419658
Bond Position:  [10.29296163]


portfolio before change:  [9.19064671]
curr_Stock_Price:  101.8999200381087
curr_Factors:  [1.01899920e+02 3.97583806e-02]
mat_Sqrt:  [[ 2.03183383e+01  0.00000000e+00]
 [-7.97580146e-03  1.82748570e-02]]
grads:  [ 2.54461541e-02 -3.71521256e+01]
Stock Position:  0.02544615413625582
Bond Position:  [6.59768564]


portfolio before change:  [9.20415895]
curr_Stock_Price:  102.39852110614888
curr_Factors:  [1.02398521e+02 4.13916702e-02]
mat_Sqrt:  [[ 2.08329207e+01  0.00000000e+00]
 [-8.13797716e-03  1.86464482e-02]]
grads:  [-1.61614162e-04  1.11316520e+00]
Stock Position:  -0.00016161416184529647
Bond Position:  [9.220708]


portfolio before change:  [9.20547372]
curr_Stock_Price:  101.39543541699746
curr_Factors:  [1.01395435e+02 4.14269152e-02]
mat_Sqrt:  [[ 2.06376243e+01  0.00000000e+00]
 [-8.14144117e-03  1.86543852e-02]]
grads:  [-0.00455457  2.66157207]
Stock Position:  -0.004554566044514566
Bond Position:  [9.66728593]


portfolio before change:  [9.20426884]
curr_Stock_Price:  101.92531461170839
curr_Factors:  [1.01925315e+02 4.19949880e-02]
mat_Sqrt:  [[ 2.08872272e+01  0.00000000e+00]
 [-8.19707148e-03  1.87818503e-02]]
grads:  [1.36868265e-03 2.14747764e+00]
Stock Position:  0.001368682649628716
Bond Position:  [9.06476543]


portfolio before change:  [9.2059925]
curr_Stock_Price:  102.35674451936676
curr_Factors:  [1.02356745e+02 4.07410726e-02]
mat_Sqrt:  [[ 2.06601131e+01  0.00000000e+00]
 [-8.07376716e-03  1.84993246e-02]]
grads:  [6.63321071e-03 1.15883691e+01]
Stock Position:  0.006633210707051799
Bond Position:  [8.52703864]


portfolio before change:  [9.21568851]
curr_Stock_Price:  103.65778359739407
curr_Factors:  [1.03657784e+02 4.01433654e-02]
mat_Sqrt:  [[ 2.07686758e+01  0.00000000e+00]
 [-8.01432371e-03  1.83631225e-02]]
grads:  [ 0.0194233  -0.70760748]
Stock Position:  0.01942330085401584
Bond Position:  [7.20231219]


portfolio before change:  [9.18358567]
curr_Stock_Price:  101.95862909916882
curr_Factors:  [1.01958629e+02 3.93492790e-02]
mat_Sqrt:  [[ 2.02251792e+01  0.00000000e+00]
 [-7.93466108e-03  1.81805925e-02]]
grads:  [0.00733538 4.83816892]
Stock Position:  0.007335380798365131
Bond Position:  [8.4356803]


portfolio before change:  [9.18131032]
curr_Stock_Price:  101.50468291784819
curr_Factors:  [1.01504683e+02 3.88449162e-02]
mat_Sqrt:  [[ 2.00056733e+01  0.00000000e+00]
 [-7.88364547e-03  1.80637011e-02]]
grads:  [ 0.01310978 -8.85702734]
Stock Position:  0.013109778602716424
Bond Position:  [7.8506064]


portfolio before change:  [9.17554939]
curr_Stock_Price:  100.99038595550785
curr_Factors:  [1.00990386e+02 4.03777426e-02]
mat_Sqrt:  [[ 2.02932240e+01  0.00000000e+00]
 [-8.03768550e-03  1.84166511e-02]]
grads:  [0.00380933 1.00444666]
Stock Position:  0.0038093297611188955
Bond Position:  [8.79084371]


portfolio before change:  [9.17459822]
curr_Stock_Price:  100.45220767077917
curr_Factors:  [1.00452208e+02 4.03514496e-02]
mat_Sqrt:  [[ 2.01785082e+01  0.00000000e+00]
 [-8.03506810e-03  1.84106539e-02]]
grads:  [-0.00664871 -2.37240762]
Stock Position:  -0.006648711915647593
Bond Position:  [9.84247601]


portfolio before change:  [9.17789084]
curr_Stock_Price:  100.14203682320392
curr_Factors:  [1.00142037e+02 4.09776290e-02]
mat_Sqrt:  [[ 2.02716843e+01  0.00000000e+00]
 [-8.09717274e-03  1.85529535e-02]]
grads:  [1.64761393e-03 5.79432458e+00]
Stock Position:  0.001647613929551402
Bond Position:  [9.01289543]


portfolio before change:  [9.18108324]
curr_Stock_Price:  101.39579669007513
curr_Factors:  [1.01395797e+02 4.12533522e-02]
mat_Sqrt:  [[ 2.05944204e+01  0.00000000e+00]
 [-8.12436850e-03  1.86152668e-02]]
grads:  [ -0.03690263 -33.67212405]
Stock Position:  -0.036902634902746
Bond Position:  [12.9228553]


portfolio before change:  [9.19386647]
curr_Stock_Price:  101.09316845420012
curr_Factors:  [1.01093168e+02 4.25453320e-02]
mat_Sqrt:  [[ 2.08520024e+01  0.00000000e+00]
 [-8.25060793e-03  1.89045177e-02]]
grads:  [7.95129844e-03 1.12241856e+01]
Stock Position:  0.007951298436170463
Bond Position:  [8.39004452]


portfolio before change:  [9.18674642]
curr_Stock_Price:  100.06580453946339
curr_Factors:  [1.00065805e+02 4.26877520e-02]
mat_Sqrt:  [[ 2.06746104e+01  0.00000000e+00]
 [-8.26440580e-03  1.89361326e-02]]
grads:  [ 0.00216151 -1.0585856 ]
Stock Position:  0.0021615091801356957
Bond Position:  [8.97045326]


portfolio before change:  [9.19084421]
curr_Stock_Price:  101.44281219125963
curr_Factors:  [1.01442812e+02 4.22009342e-02]
mat_Sqrt:  [[ 2.08392609e+01  0.00000000e+00]
 [-8.21714639e-03  1.88278477e-02]]
grads:  [2.70082651e-03 1.32499639e+01]
Stock Position:  0.0027008265102501585
Bond Position:  [8.91686477]


portfolio before change:  [9.19300809]
curr_Stock_Price:  101.83128612391924
curr_Factors:  [1.01831286e+02 4.18816373e-02]
mat_Sqrt:  [[ 2.08397764e+01  0.00000000e+00]
 [-8.18600145e-03  1.87564856e-02]]
grads:  [-0.00381106  3.12713863]
Stock Position:  -0.0038110641652858122
Bond Position:  [9.58109365]


portfolio before change:  [9.19652349]
curr_Stock_Price:  101.223138552874
curr_Factors:  [1.01223139e+02 4.29330600e-02]
mat_Sqrt:  [[ 2.09737323e+01  0.00000000e+00]
 [-8.28811776e-03  1.89904635e-02]]
grads:  [2.04326521e-03 3.36333803e+00]
Stock Position:  0.0020432652128685946
Bond Position:  [8.98969777]


portfolio before change:  [9.20263934]
curr_Stock_Price:  103.66632137176975
curr_Factors:  [1.03666321e+02 4.28728323e-02]
mat_Sqrt:  [[ 2.14648953e+01  0.00000000e+00]
 [-8.28230232e-03  1.89771386e-02]]
grads:  [-0.00545514 -1.87967987]
Stock Position:  -0.00545514290559336
Bond Position:  [9.76815394]


portfolio before change:  [9.20454247]
curr_Stock_Price:  103.54129533320881
curr_Factors:  [1.03541295e+02 4.31864901e-02]
mat_Sqrt:  [[ 2.15172888e+01  0.00000000e+00]
 [-8.31254379e-03  1.90464306e-02]]
grads:  [ 0.01570919 12.47653363]
Stock Position:  0.015709191360753817
Bond Position:  [7.57799245]


portfolio before change:  [9.1859041]
curr_Stock_Price:  102.29452994053554
curr_Factors:  [1.02294530e+02 4.15008613e-02]
mat_Sqrt:  [[ 2.08391963e+01  0.00000000e+00]
 [-8.14870407e-03  1.86710266e-02]]
grads:  [2.40859142e-03 5.25873688e+00]
Stock Position:  0.0024085914170764826
Bond Position:  [8.93951838]


portfolio before change:  [9.1842152]
curr_Stock_Price:  101.12936027923817
curr_Factors:  [1.01129360e+02 4.21684571e-02]
mat_Sqrt:  [[ 2.07668734e+01  0.00000000e+00]
 [-8.21398389e-03  1.88206015e-02]]
grads:  [1.06319366e-02 2.22092745e+01]
Stock Position:  0.010631936609300466
Bond Position:  [8.10901425]


portfolio before change:  [9.18021376]
curr_Stock_Price:  100.65765681109139
curr_Factors:  [1.00657657e+02 4.17301432e-02]
mat_Sqrt:  [[ 2.05623030e+01  0.00000000e+00]
 [-8.17118285e-03  1.87225320e-02]]
grads:  [3.40928223e-03 8.39225550e+00]
Stock Position:  0.0034092822284972875
Bond Position:  [8.8370434]


portfolio before change:  [9.17835359]
curr_Stock_Price:  99.7880083111101
curr_Factors:  [9.97880083e+01 4.09496995e-02]
mat_Sqrt:  [[ 2.01931334e+01  0.00000000e+00]
 [-8.09441284e-03  1.85466298e-02]]
grads:  [1.89735090e-03 2.39750137e+00]
Stock Position:  0.001897350901494924
Bond Position:  [8.98902072]


portfolio before change:  [9.18217354]
curr_Stock_Price:  101.20907380609522
curr_Factors:  [1.01209074e+02 4.00147351e-02]
mat_Sqrt:  [[ 2.02455427e+01  0.00000000e+00]
 [-8.00147338e-03  1.83336787e-02]]
grads:  [  0.02894519 -13.81079961]
Stock Position:  0.028945192163072106
Bond Position:  [6.25265745]


portfolio before change:  [9.16870168]
curr_Stock_Price:  100.71664320244406
curr_Factors:  [1.00716643e+02 4.08797756e-02]
mat_Sqrt:  [[ 2.03636439e+01  0.00000000e+00]
 [-8.08749906e-03  1.85307883e-02]]
grads:  [2.98863417e-04 3.88338387e+00]
Stock Position:  0.0002988634171222577
Bond Position:  [9.13860116]


portfolio before change:  [9.16980084]
curr_Stock_Price:  100.5720001852126
curr_Factors:  [1.0057200e+02 4.0628818e-02]
mat_Sqrt:  [[ 2.02718872e+01  0.00000000e+00]
 [-8.06263659e-03  1.84738212e-02]]
grads:  [-2.13509579e-03  4.95821360e+00]
Stock Position:  -0.0021350957891478313
Bond Position:  [9.3845317]


portfolio before change:  [9.17014423]
curr_Stock_Price:  100.96062415848493
curr_Factors:  [1.00960624e+02 4.00715881e-02]
mat_Sqrt:  [[ 2.02101857e+01  0.00000000e+00]
 [-8.00715561e-03  1.83466983e-02]]
grads:  [-2.64145829e-04 -9.09615078e+00]
Stock Position:  -0.00026414582854957766
Bond Position:  [9.19681256]


portfolio before change:  [9.1710878]
curr_Stock_Price:  101.74088764956515
curr_Factors:  [1.01740888e+02 4.15163697e-02]
mat_Sqrt:  [[ 2.07302819e+01  0.00000000e+00]
 [-8.15022647e-03  1.86745149e-02]]
grads:  [-0.00345741 -1.77228726]
Stock Position:  -0.003457414721248756
Bond Position:  [9.52284825]


portfolio before change:  [9.1736149]
curr_Stock_Price:  101.35428016101062
curr_Factors:  [1.01354280e+02 4.10023732e-02]
mat_Sqrt:  [[ 2.05232715e+01  0.00000000e+00]
 [-8.09961710e-03  1.85585542e-02]]
grads:  [-0.02816703 -5.55591828]
Stock Position:  -0.02816702771478212
Bond Position:  [12.02846372]


portfolio before change:  [9.16419339]
curr_Stock_Price:  101.74215081175085
curr_Factors:  [1.01742151e+02 3.92576998e-02]
mat_Sqrt:  [[ 2.01587379e+01  0.00000000e+00]
 [-7.92542237e-03  1.81594240e-02]]
grads:  [-0.00582652  0.0643809 ]
Stock Position:  -0.005826516320509965
Bond Position:  [9.75699569]


portfolio before change:  [9.16154939]
curr_Stock_Price:  102.40527415747486
curr_Factors:  [1.02405274e+02 3.79542953e-02]
mat_Sqrt:  [[ 1.99504544e+01  0.00000000e+00]
 [-7.79274487e-03  1.78554216e-02]]
grads:  [0.00933445 6.40197355]
Stock Position:  0.009334448657255764
Bond Position:  [8.20565261]


portfolio before change:  [9.16138696]
curr_Stock_Price:  102.27798194178685
curr_Factors:  [1.02277982e+02 3.81717158e-02]
mat_Sqrt:  [[ 1.99826458e+01  0.00000000e+00]
 [-7.81503328e-03  1.79064908e-02]]
grads:  [0.01016973 2.85409986]
Stock Position:  0.010169730916515407
Bond Position:  [8.1212474]


portfolio before change:  [9.14925213]
curr_Stock_Price:  100.98492434678103
curr_Factors:  [1.00984924e+02 3.78068773e-02]
mat_Sqrt:  [[ 1.96354993e+01  0.00000000e+00]
 [-7.77759626e-03  1.78207118e-02]]
grads:  [-0.01860102 -9.56079539]
Stock Position:  -0.018601019508604533
Bond Position:  [11.02767468]


portfolio before change:  [9.16097364]
curr_Stock_Price:  100.4288813972528
curr_Factors:  [1.00428881e+02 3.78204633e-02]
mat_Sqrt:  [[ 1.95308906e+01  0.00000000e+00]
 [-7.77899359e-03  1.78239135e-02]]
grads:  [ -0.02341058 -21.24208128]
Stock Position:  -0.02341058198512706
Bond Position:  [11.5120722]


portfolio before change:  [9.14972765]
curr_Stock_Price:  100.97073403498023
curr_Factors:  [1.00970734e+02 3.81786670e-02]
mat_Sqrt:  [[ 1.97290373e+01  0.00000000e+00]
 [-7.81574483e-03  1.79081211e-02]]
grads:  [1.78148063e-03 1.56918080e+01]
Stock Position:  0.0017814806275866294
Bond Position:  [8.96985025]


portfolio before change:  [9.15011769]
curr_Stock_Price:  100.56025342690006
curr_Factors:  [1.00560253e+02 3.96224252e-02]
mat_Sqrt:  [[ 2.00169031e+01  0.00000000e+00]
 [-7.96215300e-03  1.82435844e-02]]
grads:  [-3.60667415e-03  6.45134804e+00]
Stock Position:  -0.0036066741539398125
Bond Position:  [9.51280576]


portfolio before change:  [9.15179641]
curr_Stock_Price:  100.42451929891328
curr_Factors:  [1.00424519e+02 4.17241667e-02]
mat_Sqrt:  [[ 2.05132086e+01  0.00000000e+00]
 [-8.17059769e-03  1.87211912e-02]]
grads:  [0.01629267 3.57198494]
Stock Position:  0.016292674432555602
Bond Position:  [7.51561242]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.17344904]
Stock Price:  101.69583407596173
PL:  [7.47761497]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.28007447e-01  5.42711776e-01]
 [-2.22367664e-01 -7.09694630e-02]
 [ 9.50205654e-01 -8.59784468e-01]
 [-1.45358016e-01 -4.91977226e-03]
 [-1.74777587e-01  7.33076489e-02]
 [ 2.18241504e-01  2.02849605e-01]
 [ 2.40667614e-02  2.78105182e-01]
 [ 2.98581927e-01 -3.69275732e-03]
 [ 1.05708133e-01  8.93162386e-02]
 [ 6.23487261e-01 -5.08000130e-01]
 [ 5.63421114e-02 -2.87296094e-02]
 [-2.19860510e-01 -1.89228356e-01]
 [-1.24712649e-01  1.30548402e-01]
 [-7.22890654e-01 -1.02008585e+00]
 [-1.89783828e-02 -2.03478660e-01]
 [ 4.72356772e-02 -7.72349273e-02]
 [-5.35095041e-02  3.00950588e-01]
 [ 6.07697990e-02  1.45781879e-01]
 [ 1.47626961e-02  6.92460799e-02]
 [-1.01430706e-01 -3.54823527e-02]
 [ 2.29152464e-01  2.66005948e-01]
 [ 1.33802710e-02  1.39164950e-01]
 [-1.34794325e-02 -3.01679063e-01]
 [ 1.21129498e-01  1.98881557e-01]
 [ 8.06860634e-02  1.67929311e-01]
 [ 7.98346152e-01 -6.82677497e-01]
 [-6.00614276e-01  7.53923847e-01]
 [ 8.06711848e-02 -1.53844700e-02]
 [-5.37057489e-02 -5.56947671e-02]
 [ 8.64756573e-02 -1.91912932e-01]
 [ 1.14605538e-01 -6.51565569e-02]
 [ 1.41241384e-01 -1.36673393e-02]
 [ 2.11429515e-01  2.39444206e-01]
 [ 2.07520524e-01  3.74562047e-02]
 [-2.48187917e-01 -1.96531434e-01]
 [ 1.33113178e-01 -2.30836972e-01]
 [-1.59344095e-01  2.17279226e-01]
 [-1.19589919e-01  1.20374730e-01]
 [-1.29284320e-01  1.32546840e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.12687408]
curr_Stock_Price:  100.66558479525196
curr_Factors:  [1.00665585e+02 3.98233738e-02]
mat_Sqrt:  [[ 2.00886173e+01  0.00000000e+00]
 [-7.98231784e-03  1.82897879e-02]]
grads:  [2.31407805e-02 2.96729399e+01]
Stock Position:  0.023140780506254604
Bond Position:  [4.79739388]


portfolio before change:  [7.15384391]
curr_Stock_Price:  101.80513665425255
curr_Factors:  [1.01805137e+02 3.86412843e-02]
mat_Sqrt:  [[ 2.00122292e+01  0.00000000e+00]
 [-7.86295459e-03  1.80162923e-02]]
grads:  [-0.01265932 -3.93918248]
Stock Position:  -0.012659323207268399
Bond Position:  [8.44262804]


portfolio before change:  [7.13047688]
curr_Stock_Price:  103.73434186854689
curr_Factors:  [1.03734342e+02 3.80956274e-02]
mat_Sqrt:  [[ 2.02469738e+01  0.00000000e+00]
 [-7.80724048e-03  1.78886352e-02]]
grads:  [ 2.83975746e-02 -4.80631673e+01]
Stock Position:  0.028397574552834714
Bond Position:  [4.18467317]


portfolio before change:  [7.12404164]
curr_Stock_Price:  103.4893084160385
curr_Factors:  [1.03489308e+02 3.80567627e-02]
mat_Sqrt:  [[ 2.01888418e+01  0.00000000e+00]
 [-7.80325703e-03  1.78795080e-02]]
grads:  [-0.00730627 -0.27516262]
Stock Position:  -0.007306272540487353
Bond Position:  [7.88016273]


portfolio before change:  [7.12625724]
curr_Stock_Price:  103.32088907606921
curr_Factors:  [1.03320889e+02 3.75251638e-02]
mat_Sqrt:  [[ 2.00147160e+01  0.00000000e+00]
 [-7.74856516e-03  1.77541932e-02]]
grads:  [-0.00713393  4.12903297]
Stock Position:  -0.007133926162118126
Bond Position:  [7.86334083]


portfolio before change:  [7.12400616]
curr_Stock_Price:  103.7742241276279
curr_Factors:  [1.03774224e+02 3.90618997e-02]
mat_Sqrt:  [[ 2.05100243e+01  0.00000000e+00]
 [-7.90563341e-03  1.81140817e-02]]
grads:  [ 0.01495719 11.19844811]
Stock Position:  0.014957189947964192
Bond Position:  [5.57183538]


portfolio before change:  [7.09646264]
curr_Stock_Price:  101.88616631907995
curr_Factors:  [1.01886166e+02 4.03084917e-02]
mat_Sqrt:  [[ 2.04556599e+01  0.00000000e+00]
 [-8.03078992e-03  1.84008513e-02]]
grads:  [7.11010126e-03 1.51137128e+01]
Stock Position:  0.00711010125943189
Bond Position:  [6.37204168]


portfolio before change:  [7.1003994]
curr_Stock_Price:  102.32781973649077
curr_Factors:  [1.02327820e+02 4.04197672e-02]
mat_Sqrt:  [[ 2.05726683e+01  0.00000000e+00]
 [-8.04186717e-03  1.84262325e-02]]
grads:  [ 0.01443519 -0.20040762]
Stock Position:  0.014435185115239557
Bond Position:  [5.62327838]


portfolio before change:  [7.097896]
curr_Stock_Price:  102.10569898495788
curr_Factors:  [1.02105699e+02 4.05045280e-02]
mat_Sqrt:  [[ 2.05495242e+01  0.00000000e+00]
 [-8.05029471e-03  1.84455424e-02]]
grads:  [0.00704099 4.84215842]
Stock Position:  0.007040987119519119
Bond Position:  [6.37897108]


portfolio before change:  [7.12337696]
curr_Stock_Price:  105.611391987457
curr_Factors:  [1.05611392e+02 4.03341665e-02]
mat_Sqrt:  [[ 2.12103244e+01  0.00000000e+00]
 [-8.03334715e-03  1.84067107e-02]]
grads:  [ 1.89425593e-02 -2.75986372e+01]
Stock Position:  0.018942559297086034
Bond Position:  [5.1228269]


portfolio before change:  [7.1213691]
curr_Stock_Price:  105.47158785667582
curr_Factors:  [1.05471588e+02 4.05972883e-02]
mat_Sqrt:  [[ 2.12512264e+01  0.00000000e+00]
 [-8.05950751e-03  1.84666516e-02]]
grads:  [ 0.00206122 -1.55575629]
Stock Position:  0.0020612213670848077
Bond Position:  [6.90396881]


portfolio before change:  [7.12003199]
curr_Stock_Price:  104.40418295815577
curr_Factors:  [1.04404183e+02 4.02109656e-02]
mat_Sqrt:  [[ 2.09358284e+01  0.00000000e+00]
 [-8.02106882e-03  1.83785775e-02]]
grads:  [ -0.01444636 -10.29613722]
Stock Position:  -0.014446361024171813
Bond Position:  [8.62829251]


portfolio before change:  [7.12585839]
curr_Stock_Price:  104.07553348234867
curr_Factors:  [1.04075533e+02 3.91098200e-02]
mat_Sqrt:  [[ 2.05821886e+01  0.00000000e+00]
 [-7.91048115e-03  1.81251893e-02]]
grads:  [-3.29103264e-03  7.20259525e+00]
Stock Position:  -0.0032910326448238863
Bond Position:  [7.46837437]


portfolio before change:  [7.12499551]
curr_Stock_Price:  104.62140497373528
curr_Factors:  [1.04621405e+02 3.78685451e-02]
mat_Sqrt:  [[ 2.03591601e+01  0.00000000e+00]
 [-7.78393681e-03  1.78352398e-02]]
grads:  [ -0.0573743  -57.19496131]
Stock Position:  -0.057374302820346244
Bond Position:  [13.12757568]


portfolio before change:  [7.15228852]
curr_Stock_Price:  104.17430655080717
curr_Factors:  [1.04174307e+02 3.77405123e-02]
mat_Sqrt:  [[ 2.02378566e+01  0.00000000e+00]
 [-7.77076699e-03  1.78050640e-02]]
grads:  [-5.32584813e-03 -1.14281342e+01]
Stock Position:  -0.005325848134465002
Bond Position:  [7.70710506]


portfolio before change:  [7.15763521]
curr_Stock_Price:  103.35129448169381
curr_Factors:  [1.03351294e+02 3.86248828e-02]
mat_Sqrt:  [[ 2.03118513e+01  0.00000000e+00]
 [-7.86128567e-03  1.80124683e-02]]
grads:  [ 6.65995004e-04 -4.28785916e+00]
Stock Position:  0.0006659950044731139
Bond Position:  [7.08880376]


portfolio before change:  [7.15893834]
curr_Stock_Price:  103.97739414464567
curr_Factors:  [1.03977394e+02 3.87102924e-02]
mat_Sqrt:  [[ 2.04574809e+01  0.00000000e+00]
 [-7.86997255e-03  1.80323725e-02]]
grads:  [3.80477445e-03 1.66894616e+01]
Stock Position:  0.0038047744505143428
Bond Position:  [6.76332781]


portfolio before change:  [7.16193784]
curr_Stock_Price:  104.54353362488371
curr_Factors:  [1.04543534e+02 3.78510261e-02]
mat_Sqrt:  [[ 2.03393001e+01  0.00000000e+00]
 [-7.78213607e-03  1.78311138e-02]]
grads:  [6.11595417e-03 8.17570236e+00]
Stock Position:  0.006115954167526033
Bond Position:  [6.52255438]


portfolio before change:  [7.15592137]
curr_Stock_Price:  103.42648083191457
curr_Factors:  [1.03426481e+02 3.90180817e-02]
mat_Sqrt:  [[ 2.04298277e+01  0.00000000e+00]
 [-7.90119806e-03  1.81039191e-02]]
grads:  [2.20188655e-03 3.82492208e+00]
Stock Position:  0.002201886554567873
Bond Position:  [6.92818799]


portfolio before change:  [7.15747286]
curr_Stock_Price:  103.73776277068411
curr_Factors:  [1.03737763e+02 3.87478034e-02]
mat_Sqrt:  [[ 2.04202202e+01  0.00000000e+00]
 [-7.87378470e-03  1.80411072e-02]]
grads:  [-0.00572552 -1.96675029]
Stock Position:  -0.0057255246655129625
Bond Position:  [7.75142598]


portfolio before change:  [7.15731859]
curr_Stock_Price:  103.93394708993584
curr_Factors:  [1.03933947e+02 3.89687142e-02]
mat_Sqrt:  [[ 2.05170756e+01  0.00000000e+00]
 [-7.89619799e-03  1.80924625e-02]]
grads:  [ 0.0168273 14.7025839]
Stock Position:  0.016827299557826875
Bond Position:  [5.40839092]


portfolio before change:  [7.18928649]
curr_Stock_Price:  105.793533144759
curr_Factors:  [1.05793533e+02 3.76021277e-02]
mat_Sqrt:  [[ 2.05147076e+01  0.00000000e+00]
 [-7.75650722e-03  1.77723907e-02]]
grads:  [3.61286332e-03 7.83040122e+00]
Stock Position:  0.0036128633175118077
Bond Position:  [6.80706891]


portfolio before change:  [7.1935242]
curr_Stock_Price:  106.73095491930988
curr_Factors:  [1.06730955e+02 3.67477652e-02]
mat_Sqrt:  [[ 2.04600109e+01  0.00000000e+00]
 [-7.66788265e-03  1.75693263e-02]]
grads:  [-7.09398300e-03 -1.71707815e+01]
Stock Position:  -0.007093982996849598
Bond Position:  [7.95067178]


portfolio before change:  [7.19942047]
curr_Stock_Price:  106.03989387206846
curr_Factors:  [1.06039894e+02 3.73510049e-02]
mat_Sqrt:  [[ 2.04937026e+01  0.00000000e+00]
 [-7.73056322e-03  1.77129456e-02]]
grads:  [1.01459717e-02 1.12280341e+01]
Stock Position:  0.010145971667456384
Bond Position:  [6.12354272]


portfolio before change:  [7.20413166]
curr_Stock_Price:  106.42878694031208
curr_Factors:  [1.06428787e+02 3.79252928e-02]
mat_Sqrt:  [[ 2.07263861e+01  0.00000000e+00]
 [-7.78976691e-03  1.78485982e-02]]
grads:  [7.42900488e-03 9.40854337e+00]
Stock Position:  0.007429004880099456
Bond Position:  [6.41347169]


portfolio before change:  [7.20330102]
curr_Stock_Price:  106.20905686036119
curr_Factors:  [1.06209057e+02 3.76818997e-02]
mat_Sqrt:  [[ 2.06171175e+01  0.00000000e+00]
 [-7.76473048e-03  1.77912326e-02]]
grads:  [ 2.42711555e-02 -3.83715683e+01]
Stock Position:  0.024271155522792135
Bond Position:  [4.62548448]


portfolio before change:  [7.21306929]
curr_Stock_Price:  106.58769737696319
curr_Factors:  [1.06587697e+02 3.82304510e-02]
mat_Sqrt:  [[ 2.08406755e+01  0.00000000e+00]
 [-7.82104351e-03  1.79202619e-02]]
grads:  [-1.30310044e-02  4.20710283e+01]
Stock Position:  -0.013031004363878643
Bond Position:  [8.60201404]


portfolio before change:  [7.18439731]
curr_Stock_Price:  108.87050642030583
curr_Factors:  [1.08870506e+02 3.77176124e-02]
mat_Sqrt:  [[ 2.11437658e+01  0.00000000e+00]
 [-7.76840909e-03  1.77996614e-02]]
grads:  [ 0.00349781 -0.86431251]
Stock Position:  0.0034978088717181723
Bond Position:  [6.80358909]


portfolio before change:  [7.18136554]
curr_Stock_Price:  107.76059211616746
curr_Factors:  [1.07760592e+02 3.77931068e-02]
mat_Sqrt:  [[ 2.09491433e+01  0.00000000e+00]
 [-7.77617971e-03  1.78174661e-02]]
grads:  [-0.00372392 -3.12585229]
Stock Position:  -0.0037239202149247147
Bond Position:  [7.58265739]


portfolio before change:  [7.18471497]
curr_Stock_Price:  107.11569730282422
curr_Factors:  [1.07115697e+02 3.72403581e-02]
mat_Sqrt:  [[ 2.06709313e+01  0.00000000e+00]
 [-7.71910442e-03  1.76866901e-02]]
grads:  [ 1.31488377e-04 -1.08506979e+01]
Stock Position:  0.0001314883771401651
Bond Position:  [7.1706305]


portfolio before change:  [7.18549951]
curr_Stock_Price:  106.26508825302419
curr_Factors:  [1.06265088e+02 3.82731885e-02]
mat_Sqrt:  [[ 2.07892073e+01  0.00000000e+00]
 [-7.82541383e-03  1.79302756e-02]]
grads:  [ 0.00414489 -3.63388485]
Stock Position:  0.004144885576937731
Bond Position:  [6.74504288]


portfolio before change:  [7.18745877]
curr_Stock_Price:  106.53435421573008
curr_Factors:  [1.06534354e+02 3.71788616e-02]
mat_Sqrt:  [[ 2.05417633e+01  0.00000000e+00]
 [-7.71272835e-03  1.76720807e-02]]
grads:  [ 0.00658544 -0.77338597]
Stock Position:  0.006585436039381108
Bond Position:  [6.4858836]


portfolio before change:  [7.17995332]
curr_Stock_Price:  105.27153193802829
curr_Factors:  [1.05271532e+02 3.74911794e-02]
mat_Sqrt:  [[ 2.03833468e+01  0.00000000e+00]
 [-7.74505565e-03  1.77461519e-02]]
grads:  [ 0.01549949 13.49273957]
Stock Position:  0.015499492615731171
Bond Position:  [5.54829799]


portfolio before change:  [7.16708277]
curr_Stock_Price:  104.3963981816894
curr_Factors:  [1.04396398e+02 3.91658046e-02]
mat_Sqrt:  [[ 2.06604150e+01  0.00000000e+00]
 [-7.91614094e-03  1.81381575e-02]]
grads:  [0.01083559 2.06505013]
Stock Position:  0.010835588315898259
Bond Position:  [6.03588638]


portfolio before change:  [7.15734979]
curr_Stock_Price:  103.4285213100185
curr_Factors:  [1.03428521e+02 3.83164714e-02]
mat_Sqrt:  [[ 2.02457127e+01  0.00000000e+00]
 [-7.82983743e-03  1.79404114e-02]]
grads:  [ -0.01649541 -10.95467822]
Stock Position:  -0.016495406777466286
Bond Position:  [8.86344532]


portfolio before change:  [7.13802418]
curr_Stock_Price:  104.6672666846766
curr_Factors:  [1.04667267e+02 3.75759732e-02]
mat_Sqrt:  [[ 2.02892504e+01  0.00000000e+00]
 [-7.75380921e-03  1.77662088e-02]]
grads:  [ 1.59531097e-03 -1.29930350e+01]
Stock Position:  0.001595310968156272
Bond Position:  [6.97104734]


portfolio before change:  [7.13845753]
curr_Stock_Price:  104.39265584289514
curr_Factors:  [1.04392656e+02 3.91166402e-02]
mat_Sqrt:  [[ 2.06467034e+01  0.00000000e+00]
 [-7.91117086e-03  1.81267697e-02]]
grads:  [-3.12474417e-03  1.19866490e+01]
Stock Position:  -0.0031247441671898757
Bond Position:  [7.46465787]


portfolio before change:  [7.13931974]
curr_Stock_Price:  104.41535605610073
curr_Factors:  [1.04415356e+02 3.80372286e-02]
mat_Sqrt:  [[ 2.03642681e+01  0.00000000e+00]
 [-7.80125411e-03  1.78749187e-02]]
grads:  [-3.29273211e-03  6.73428126e+00]
Stock Position:  -0.0032927321056954438
Bond Position:  [7.48313153]


portfolio before change:  [7.13854481]
curr_Stock_Price:  104.93479620541099
curr_Factors:  [1.04934796e+02 3.89377421e-02]
mat_Sqrt:  [[ 2.07064146e+01  0.00000000e+00]
 [-7.89305944e-03  1.80852712e-02]]
grads:  [-3.44995202e-03  7.32899378e+00]
Stock Position:  -0.003449952021569438
Bond Position:  [7.50056482]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.1387167]
Stock Price:  105.15675189380993
PL:  [1.98196481]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.46171723e-01  6.88668693e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.49040400e-01 -6.35209426e-01]
 [-2.58541068e-02  2.59565562e-02]
 [-3.62217067e-02  1.78562193e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-2.17116584e-02  2.46562544e-01]
 [-6.06077017e-02 -7.51532100e-02]
 [ 1.58796568e-01  7.24324174e-02]
 [ 2.16491129e-01 -6.11072324e-02]
 [ 9.04373421e-02  9.32886615e-02]
 [-6.15187293e-02  6.02543792e-02]
 [ 1.51762074e-02  9.59403350e-02]
 [-2.83804320e-01 -3.88871230e-01]
 [ 8.08737781e-02  2.26011534e-01]
 [ 5.39874965e-02 -2.03963051e-02]
 [-5.24520468e-02  2.41507489e-01]
 [-1.48796965e-01  1.22800900e-02]
 [ 1.51045691e-02  6.07573205e-02]
 [ 6.34558056e-03 -9.11630911e-02]
 [ 1.25513489e-01  3.12249158e-02]
 [ 9.05072465e-02  3.12941812e-01]
 [ 3.52562198e-02  2.38786339e-01]
 [-8.57400080e-02  1.05660608e-01]
 [ 4.99115815e-02  1.10660923e-01]
 [ 1.23762298e-01  5.97385325e-02]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.73243765e-01  1.22376993e-01]
 [-1.66477208e-01 -5.35862556e-02]
 [ 1.38926139e-01 -7.87929390e-02]
 [-1.06703915e+00 -1.20271814e-01]
 [-8.72658004e-02  1.15188421e-01]
 [-9.25217973e-03 -9.67240439e-02]
 [ 6.95417173e-02  1.01637680e-01]
 [-1.10259448e-01  1.25341417e-01]
 [-6.27535143e-01 -2.89864596e-01]
 [-3.00530352e-02  2.94582833e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 6.07603984e-01  3.21346367e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.93574933]
curr_Stock_Price:  101.08864687077205
curr_Factors:  [1.01088647e+02 3.83952870e-02]
mat_Sqrt:  [[ 1.98080326e+01  0.00000000e+00]
 [-7.83788615e-03  1.79588533e-02]]
grads:  [3.26499554e-02 3.83470304e+01]
Stock Position:  0.03264995537876924
Bond Position:  [6.63520952]


portfolio before change:  [9.89341629]
curr_Stock_Price:  99.76666957113366
curr_Factors:  [9.97666696e+01 3.98778453e-02]
mat_Sqrt:  [[ 1.99228432e+01  0.00000000e+00]
 [-7.98777519e-03  1.83022922e-02]]
grads:  [-0.01018853 -4.80876215]
Stock Position:  -0.010188528113428137
Bond Position:  [10.9098918]


portfolio before change:  [9.88091972]
curr_Stock_Price:  101.12706119114722
curr_Factors:  [1.01127061e+02 3.97278631e-02]
mat_Sqrt:  [[ 2.01564938e+01  0.00000000e+00]
 [-7.97273986e-03  1.82678420e-02]]
grads:  [ 2.34074578e-02 -3.47720014e+01]
Stock Position:  0.02340745782247736
Bond Position:  [7.5137923]


portfolio before change:  [9.85502564]
curr_Stock_Price:  99.98070145226468
curr_Factors:  [9.99807015e+01 3.93876003e-02]
mat_Sqrt:  [[ 1.98424795e+01  0.00000000e+00]
 [-7.93852382e-03  1.81894432e-02]]
grads:  [-7.32052510e-04  1.42701214e+00]
Stock Position:  -0.000732052510484165
Bond Position:  [9.92821676]


portfolio before change:  [9.85608815]
curr_Stock_Price:  100.22466346285924
curr_Factors:  [1.00224663e+02 3.65391562e-02]
mat_Sqrt:  [[ 1.91581630e+01  0.00000000e+00]
 [-7.64608723e-03  1.75193867e-02]]
grads:  [-0.00148389  1.01922627]
Stock Position:  -0.0014838903800629532
Bond Position:  [10.00481056]


portfolio before change:  [9.8580656]
curr_Stock_Price:  99.73489077382884
curr_Factors:  [9.97348908e+01 3.78484456e-02]
mat_Sqrt:  [[ 1.94031008e+01  0.00000000e+00]
 [-7.78187079e-03  1.78305060e-02]]
grads:  [-0.00610319 -3.71929592]
Stock Position:  -0.006103187977176831
Bond Position:  [10.46676638]


portfolio before change:  [9.86016718]
curr_Stock_Price:  99.60493363684344
curr_Factors:  [9.96049336e+01 3.74166767e-02]
mat_Sqrt:  [[ 1.92669716e+01  0.00000000e+00]
 [-7.73735632e-03  1.77285105e-02]]
grads:  [4.45825426e-03 1.39076853e+01]
Stock Position:  0.004458254256725588
Bond Position:  [9.41610306]


portfolio before change:  [9.85859148]
curr_Stock_Price:  98.98747560738347
curr_Factors:  [9.89874756e+01 3.84792243e-02]
mat_Sqrt:  [[ 1.94175040e+01  0.00000000e+00]
 [-7.84644880e-03  1.79784728e-02]]
grads:  [-0.00481047 -4.18017765]
Stock Position:  -0.004810466457511862
Bond Position:  [10.33476741]


portfolio before change:  [9.85723473]
curr_Stock_Price:  99.53808170636285
curr_Factors:  [9.95380817e+01 3.73270822e-02]
mat_Sqrt:  [[ 1.92309743e+01  0.00000000e+00]
 [-7.72808719e-03  1.77072723e-02]]
grads:  [0.00990115 4.09054632]
Stock Position:  0.00990114507977972
Bond Position:  [8.87169374]


portfolio before change:  [9.85495132]
curr_Stock_Price:  99.19545073612629
curr_Factors:  [9.91954507e+01 3.81276809e-02]
mat_Sqrt:  [[ 1.93692119e+01  0.00000000e+00]
 [-7.81052427e-03  1.78961593e-02]]
grads:  [ 0.00980018 -3.4145445 ]
Stock Position:  0.00980017914409156
Bond Position:  [8.88281814]


portfolio before change:  [9.86301337]
curr_Stock_Price:  99.90478760876886
curr_Factors:  [9.99047876e+01 3.99577825e-02]
mat_Sqrt:  [[ 1.99704104e+01  0.00000000e+00]
 [-7.99577713e-03  1.83206270e-02]]
grads:  [0.00656731 5.09200158]
Stock Position:  0.006567308795140609
Bond Position:  [9.20690778]


portfolio before change:  [9.86233436]
curr_Stock_Price:  99.6261415978133
curr_Factors:  [9.96261416e+01 3.98179423e-02]
mat_Sqrt:  [[ 1.98798323e+01  0.00000000e+00]
 [-7.98177347e-03  1.82885405e-02]]
grads:  [-1.77172331e-03  3.29465214e+00]
Stock Position:  -0.001771723308670051
Bond Position:  [10.03884431]


portfolio before change:  [9.86319227]
curr_Stock_Price:  99.85022837639254
curr_Factors:  [9.98502284e+01 4.04918715e-02]
mat_Sqrt:  [[ 2.00924542e+01  0.00000000e+00]
 [-8.04903687e-03  1.84426604e-02]]
grads:  [2.83927497e-03 5.20208761e+00]
Stock Position:  0.002839274970422588
Bond Position:  [9.57969002]


portfolio before change:  [9.86211979]
curr_Stock_Price:  99.05072191358771
curr_Factors:  [9.90507219e+01 4.06985449e-02]
mat_Sqrt:  [[ 1.99823741e+01  0.00000000e+00]
 [-8.06955214e-03  1.84896668e-02]]
grads:  [ -0.02269608 -21.03181388]
Stock Position:  -0.022696083855668403
Bond Position:  [12.11018328]


portfolio before change:  [9.85096295]
curr_Stock_Price:  99.60899906989977
curr_Factors:  [9.96089991e+01 4.08810842e-02]
mat_Sqrt:  [[ 2.01400145e+01  0.00000000e+00]
 [-8.08762850e-03  1.85310849e-02]]
grads:  [8.91326561e-03 1.21963466e+01]
Stock Position:  0.008913265605341883
Bond Position:  [8.96312148]


portfolio before change:  [9.86142222]
curr_Stock_Price:  100.65674206108491
curr_Factors:  [1.00656742e+02 4.05246932e-02]
mat_Sqrt:  [[ 2.02629530e+01  0.00000000e+00]
 [-8.05229838e-03  1.84501334e-02]]
grads:  [ 0.00222504 -1.1054828 ]
Stock Position:  0.0022250369505970717
Bond Position:  [9.63745725]


portfolio before change:  [9.86351885]
curr_Stock_Price:  101.05757622276954
curr_Factors:  [1.01057576e+02 4.03992119e-02]
mat_Sqrt:  [[ 2.03121233e+01  0.00000000e+00]
 [-8.03982208e-03  1.84215466e-02]]
grads:  [2.60684036e-03 1.31100550e+01]
Stock Position:  0.002606840355982247
Bond Position:  [9.60007788]


portfolio before change:  [9.86433825]
curr_Stock_Price:  100.91154197828443
curr_Factors:  [1.00911542e+02 4.22485084e-02]
mat_Sqrt:  [[ 2.07418043e+01  0.00000000e+00]
 [-8.22177678e-03  1.88384572e-02]]
grads:  [-0.00691538  0.65186283]
Stock Position:  -0.0069153817117190396
Bond Position:  [10.56218008]


portfolio before change:  [9.87140846]
curr_Stock_Price:  100.08008244614466
curr_Factors:  [1.00080082e+02 4.14002525e-02]
mat_Sqrt:  [[ 2.03633464e+01  0.00000000e+00]
 [-8.13882080e-03  1.86483812e-02]]
grads:  [2.04392917e-03 3.25804797e+00]
Stock Position:  0.002043929168736154
Bond Position:  [9.66685186]


portfolio before change:  [9.87162207]
curr_Stock_Price:  99.59336213951617
curr_Factors:  [9.95933621e+01 4.10519766e-02]
mat_Sqrt:  [[ 2.01788973e+01  0.00000000e+00]
 [-8.10451495e-03  1.85697766e-02]]
grads:  [-1.65723893e-03 -4.90921851e+00]
Stock Position:  -0.0016572389345972604
Bond Position:  [10.03667207]


portfolio before change:  [9.87169635]
curr_Stock_Price:  100.3056214786004
curr_Factors:  [1.00305621e+02 4.14643177e-02]
mat_Sqrt:  [[ 2.04250221e+01  0.00000000e+00]
 [-8.14511561e-03  1.86628044e-02]]
grads:  [0.00681229 1.67310952]
Stock Position:  0.006812289308164662
Bond Position:  [9.18838544]


portfolio before change:  [9.86867487]
curr_Stock_Price:  99.69347833472992
curr_Factors:  [9.96934783e+01 4.03998031e-02]
mat_Sqrt:  [[ 2.00380923e+01  0.00000000e+00]
 [-8.03988090e-03  1.84216814e-02]]
grads:  [1.13327280e-02 1.69876899e+01]
Stock Position:  0.011332728029075059
Bond Position:  [8.7388758]


portfolio before change:  [9.84907241]
curr_Stock_Price:  97.86736104264911
curr_Factors:  [9.78673610e+01 4.06639116e-02]
mat_Sqrt:  [[ 1.97352419e+01  0.00000000e+00]
 [-8.06611794e-03  1.84817980e-02]]
grads:  [7.06710982e-03 1.29200816e+01]
Stock Position:  0.007067109819105566
Bond Position:  [9.15743302]


portfolio before change:  [9.84634092]
curr_Stock_Price:  97.31886998777371
curr_Factors:  [9.73188700e+01 3.93114666e-02]
mat_Sqrt:  [[ 1.92955286e+01  0.00000000e+00]
 [-7.93084778e-03  1.81718551e-02]]
grads:  [-2.05363321e-03  5.81451959e+00]
Stock Position:  -0.002053633206031471
Bond Position:  [10.04619818]


portfolio before change:  [9.84848903]
curr_Stock_Price:  96.88439135569469
curr_Factors:  [9.68843914e+01 3.88251213e-02]
mat_Sqrt:  [[ 1.90901889e+01  0.00000000e+00]
 [-7.88163651e-03  1.80590980e-02]]
grads:  [5.14442096e-03 6.12771045e+00]
Stock Position:  0.005144420958446371
Bond Position:  [9.35007494]


portfolio before change:  [9.84877409]
curr_Stock_Price:  96.71259918961674
curr_Factors:  [9.67125992e+01 3.81554697e-02]
mat_Sqrt:  [[ 1.88912831e+01  0.00000000e+00]
 [-7.81337005e-03  1.79026798e-02]]
grads:  [0.0079314  3.33684862]
Stock Position:  0.007931400395895339
Bond Position:  [9.08170774]


portfolio before change:  [9.85002285]
curr_Stock_Price:  96.72690667174057
curr_Factors:  [9.67269067e+01 3.73044468e-02]
mat_Sqrt:  [[ 1.86821821e+01  0.00000000e+00]
 [-7.72574364e-03  1.77019025e-02]]
grads:  [9.53644490e-03 9.88240638e+00]
Stock Position:  0.009536444901307702
Bond Position:  [8.92759204]


portfolio before change:  [9.8500106]
curr_Stock_Price:  96.60859488889257
curr_Factors:  [9.66085949e+01 3.76578495e-02]
mat_Sqrt:  [[ 1.87475069e+01  0.00000000e+00]
 [-7.76225219e-03  1.77855541e-02]]
grads:  [-6.39200012e-03  6.88069610e+00]
Stock Position:  -0.006392000121144096
Bond Position:  [10.46753275]


portfolio before change:  [9.84962083]
curr_Stock_Price:  96.87428478687691
curr_Factors:  [9.68742848e+01 3.71966418e-02]
mat_Sqrt:  [[ 1.86835920e+01  0.00000000e+00]
 [-7.71457237e-03  1.76763059e-02]]
grads:  [-0.01016208 -3.03153022]
Stock Position:  -0.010162080577031453
Bond Position:  [10.83406512]


portfolio before change:  [9.85542944]
curr_Stock_Price:  96.43596241342277
curr_Factors:  [9.64359624e+01 3.73179992e-02]
mat_Sqrt:  [[ 1.86293711e+01  0.00000000e+00]
 [-7.72714687e-03  1.77051177e-02]]
grads:  [ 0.00561147 -4.45029173]
Stock Position:  0.00561146592749144
Bond Position:  [9.31428232]


portfolio before change:  [9.85379329]
curr_Stock_Price:  95.93689301178667
curr_Factors:  [9.59368930e+01 3.74595229e-02]
mat_Sqrt:  [[ 1.85680702e+01  0.00000000e+00]
 [-7.74178511e-03  1.77386581e-02]]
grads:  [-0.06029329 -6.78020926]
Stock Position:  -0.06029329173910814
Bond Position:  [15.63814437]


portfolio before change:  [9.85066149]
curr_Stock_Price:  96.02125883645361
curr_Factors:  [9.60212588e+01 3.72969252e-02]
mat_Sqrt:  [[ 1.85440210e+01  0.00000000e+00]
 [-7.72496475e-03  1.77001178e-02]]
grads:  [-1.99489916e-03  6.50777709e+00]
Stock Position:  -0.001994899157990208
Bond Position:  [10.04221421]


portfolio before change:  [9.84961496]
curr_Stock_Price:  97.17514018474989
curr_Factors:  [9.71751402e+01 3.63018436e-02]
mat_Sqrt:  [[ 1.85148210e+01  0.00000000e+00]
 [-7.62121708e-03  1.74624021e-02]]
grads:  [-2.77971974e-03 -5.53898848e+00]
Stock Position:  -0.0027797197431083894
Bond Position:  [10.11973462]


portfolio before change:  [9.85015706]
curr_Stock_Price:  97.43521841224786
curr_Factors:  [9.74352184e+01 3.48143232e-02]
mat_Sqrt:  [[ 1.81800445e+01  0.00000000e+00]
 [-7.46343870e-03  1.71008864e-02]]
grads:  [0.00626511 5.94341592]
Stock Position:  0.006265113256384274
Bond Position:  [9.23971439]


portfolio before change:  [9.85388575]
curr_Stock_Price:  97.84600901455619
curr_Factors:  [9.78460090e+01 3.28984005e-02]
mat_Sqrt:  [[ 1.77472271e+01  0.00000000e+00]
 [-7.25516649e-03  1.66236748e-02]]
grads:  [-3.13040277e-03  7.53993439e+00]
Stock Position:  -0.0031304027659903888
Bond Position:  [10.16018317]


portfolio before change:  [9.85314606]
curr_Stock_Price:  98.48803363573032
curr_Factors:  [9.84880336e+01 3.23697280e-02]
mat_Sqrt:  [[ 1.77195624e+01  0.00000000e+00]
 [-7.19663566e-03  1.64895638e-02]]
grads:  [ -0.04255424 -17.57866969]
Stock Position:  -0.042554235149924534
Bond Position:  [14.044229]


portfolio before change:  [9.91859608]
curr_Stock_Price:  96.99125228339521
curr_Factors:  [9.69912523e+01 3.22810148e-02]
mat_Sqrt:  [[ 1.74263389e+01  0.00000000e+00]
 [-7.18676727e-03  1.64669525e-02]]
grads:  [5.65313539e-03 1.78893352e+01]
Stock Position:  0.005653135394121067
Bond Position:  [9.3702914]


portfolio before change:  [9.92218789]
curr_Stock_Price:  97.41941244155247
curr_Factors:  [9.74194124e+01 3.30975389e-02]
mat_Sqrt:  [[ 1.77232497e+01  0.00000000e+00]
 [-7.27709161e-03  1.66739116e-02]]
grads:  [-4.97567978e-03  6.55885477e+00]
Stock Position:  -0.004975679783843147
Bond Position:  [10.40691569]


portfolio before change:  [9.91853292]
curr_Stock_Price:  98.41544034857633
curr_Factors:  [9.84154403e+01 3.32914224e-02]
mat_Sqrt:  [[ 1.79568194e+01  0.00000000e+00]
 [-7.29837488e-03  1.67226777e-02]]
grads:  [0.03461797 1.92162029]
Stock Position:  0.03461797292310057
Bond Position:  [6.51158987]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.91376258]
Stock Price:  98.25412723080957
PL:  [9.91376258]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-4.68390873e-01 -2.23653598e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.79542473e-01 -8.35662206e-01]
 [-3.80927219e-02  1.17564741e-01]
 [-5.08613034e-02  2.37151302e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-1.43281901e-02  2.66505733e-01]
 [ 1.12654507e-01 -3.37823655e-02]
 [ 1.57027472e-01  7.29950466e-02]
 [ 2.00195502e-01 -4.25176059e-02]
 [ 1.12275509e-01  1.70753817e-01]
 [ 1.12210378e-02  1.54544484e-01]
 [-4.81358126e-03  1.04026681e-01]
 [-3.07914941e-01 -4.17185341e-01]
 [ 8.31342566e-02  2.27820549e-01]
 [ 5.34926815e-02 -2.00810324e-02]
 [-5.21184234e-02  2.22753437e-01]
 [-3.73578184e-02  2.46698033e-02]
 [ 1.52131555e-02  5.80611056e-02]
 [ 2.88586680e-02 -9.53984895e-02]
 [ 9.49729278e-02 -2.76956973e-04]
 [ 9.25663965e-02  3.10185554e-01]
 [ 3.52434098e-02  2.38048011e-01]
 [-2.55960060e-02  1.44874662e-01]
 [ 2.26003448e-02  5.24372512e-02]
 [ 6.99960214e-01 -2.55639243e-01]
 [-3.21644812e-02  7.74300169e-02]
 [-1.05535689e-01  1.01523802e-01]
 [ 6.67992382e-02 -1.66258298e-01]
 [-3.34208268e-02 -3.85335314e-02]
 [-4.74026108e-01 -9.95566493e-02]
 [-1.17988955e-01  2.08113911e-03]
 [ 1.14510963e-01  7.79378267e-02]
 [ 1.26563845e-01  7.89905540e-02]
 [-2.31310325e-01 -4.29756955e-02]
 [-8.18732714e-01 -2.50349898e-01]
 [-2.26133488e-02  3.03885520e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 8.51482644e-01  3.57927374e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.4006805]
curr_Stock_Price:  98.02565138438408
curr_Factors:  [9.80256514e+01 3.90772275e-02]
mat_Sqrt:  [[ 1.93776724e+01  0.00000000e+00]
 [-7.90718433e-03  1.81176354e-02]]
grads:  [ -0.02920894 -12.34452476]
Stock Position:  -0.02920894189866764
Bond Position:  [-7.53745494]


portfolio before change:  [-10.40333318]
curr_Stock_Price:  98.08421007464626
curr_Factors:  [9.80842101e+01 4.03450065e-02]
mat_Sqrt:  [[ 1.97012596e+01  0.00000000e+00]
 [-8.03442658e-03  1.84091840e-02]]
grads:  [-0.01030312 -4.78084038]
Stock Position:  -0.010303120311457983
Bond Position:  [-9.39275976]


portfolio before change:  [-10.39772416]
curr_Stock_Price:  97.4258480098582
curr_Factors:  [9.74258480e+01 4.05533132e-02]
mat_Sqrt:  [[ 1.96194743e+01  0.00000000e+00]
 [-8.05514129e-03  1.84566473e-02]]
grads:  [ 2.62407432e-02 -4.52770316e+01]
Stock Position:  0.026240743201786106
Bond Position:  [-12.95425082]


portfolio before change:  [-10.36754404]
curr_Stock_Price:  98.63768504884996
curr_Factors:  [9.86376850e+01 3.99291963e-02]
mat_Sqrt:  [[ 1.97100695e+01  0.00000000e+00]
 [-7.99291650e-03  1.83140724e-02]]
grads:  [6.70557645e-04 6.41936641e+00]
Stock Position:  0.0006705576452585638
Bond Position:  [-10.43368629]


portfolio before change:  [-10.36767665]
curr_Stock_Price:  100.38500445082542
curr_Factors:  [1.00385004e+02 4.00413341e-02]
mat_Sqrt:  [[ 2.00873715e+01  0.00000000e+00]
 [-8.00413234e-03  1.83397712e-02]]
grads:  [-0.00201675  1.29309848]
Stock Position:  -0.0020167482837190123
Bond Position:  [-10.16522537]


portfolio before change:  [-10.36725419]
curr_Stock_Price:  99.54543874317811
curr_Factors:  [9.95454387e+01 3.94354842e-02]
mat_Sqrt:  [[ 1.97681011e+01  0.00000000e+00]
 [-7.94334783e-03  1.82004964e-02]]
grads:  [-0.0059905  -3.64368788]
Stock Position:  -0.005990498070801312
Bond Position:  [-9.77092744]


portfolio before change:  [-10.37018206]
curr_Stock_Price:  99.83029332326362
curr_Factors:  [9.98302933e+01 3.99568389e-02]
mat_Sqrt:  [[ 1.99552838e+01  0.00000000e+00]
 [-7.99568272e-03  1.83204107e-02]]
grads:  [5.11064883e-03 1.45469301e+01]
Stock Position:  0.005110648825835359
Bond Position:  [-10.88037963]


portfolio before change:  [-10.37057062]
curr_Stock_Price:  100.02039981451033
curr_Factors:  [1.00020400e+02 4.06196644e-02]
mat_Sqrt:  [[ 2.01584322e+01  0.00000000e+00]
 [-8.06172829e-03  1.84717401e-02]]
grads:  [ 0.00485706 -1.82886752]
Stock Position:  0.0048570579625784125
Bond Position:  [-10.8563755]


portfolio before change:  [-10.37327757]
curr_Stock_Price:  99.74249102166507
curr_Factors:  [9.97424910e+01 4.13686091e-02]
mat_Sqrt:  [[ 2.02868991e+01  0.00000000e+00]
 [-8.13570984e-03  1.86412531e-02]]
grads:  [0.00931069 3.91578003]
Stock Position:  0.009310694617809001
Bond Position:  [-11.30194945]


portfolio before change:  [-10.3813494]
curr_Stock_Price:  99.02729273787618
curr_Factors:  [9.90272927e+01 4.35624341e-02]
mat_Sqrt:  [[ 2.06685960e+01  0.00000000e+00]
 [-8.34864627e-03  1.91291517e-02]]
grads:  [ 0.00878818 -2.22266029]
Stock Position:  0.00878817788106465
Bond Position:  [-11.25161886]


portfolio before change:  [-10.38317691]
curr_Stock_Price:  98.9793905405574
curr_Factors:  [9.89793905e+01 4.39407636e-02]
mat_Sqrt:  [[ 2.07481116e+01  0.00000000e+00]
 [-8.38482091e-03  1.92120383e-02]]
grads:  [0.00900316 8.88785533]
Stock Position:  0.0090031607779127
Bond Position:  [-11.27430428]


portfolio before change:  [-10.38512294]
curr_Stock_Price:  98.91978324660234
curr_Factors:  [9.89197832e+01 4.49661513e-02]
mat_Sqrt:  [[ 2.09761613e+01  0.00000000e+00]
 [-8.48208949e-03  1.94349086e-02]]
grads:  [3.75043741e-03 7.95190178e+00]
Stock Position:  0.0037504374121895933
Bond Position:  [-10.7561154]


portfolio before change:  [-10.3822085]
curr_Stock_Price:  100.05539377126709
curr_Factors:  [1.00055394e+02 4.40792499e-02]
mat_Sqrt:  [[ 2.10066889e+01  0.00000000e+00]
 [-8.39802357e-03  1.92422893e-02]]
grads:  [1.93211718e-03 5.40614888e+00]
Stock Position:  0.0019321171783888607
Bond Position:  [-10.57552725]


portfolio before change:  [-10.3849138]
curr_Stock_Price:  99.33945496515071
curr_Factors:  [9.9339455e+01 4.2958965e-02]
mat_Sqrt:  [[ 2.05896364e+01  0.00000000e+00]
 [-8.29061783e-03  1.89961919e-02]]
grads:  [ -0.02379787 -21.96152493]
Stock Position:  -0.023797872930419
Bond Position:  [-8.02084608]


portfolio before change:  [-10.37795682]
curr_Stock_Price:  99.00498599341367
curr_Factors:  [9.90049860e+01 4.28171509e-02]
mat_Sqrt:  [[ 2.04864142e+01  0.00000000e+00]
 [-8.27692222e-03  1.89648113e-02]]
grads:  [8.91143241e-03 1.20128034e+01]
Stock Position:  0.008911432414178065
Bond Position:  [-11.26023306]


portfolio before change:  [-10.36942097]
curr_Stock_Price:  100.1207965678449
curr_Factors:  [1.00120797e+02 4.03499986e-02]
mat_Sqrt:  [[ 2.01115739e+01  0.00000000e+00]
 [-8.03492363e-03  1.84103229e-02]]
grads:  [ 0.00222402 -1.09074852]
Stock Position:  0.0022240228819200014
Bond Position:  [-10.59209191]


portfolio before change:  [-10.37058414]
curr_Stock_Price:  100.19315536018306
curr_Factors:  [1.00193155e+02 3.98790387e-02]
mat_Sqrt:  [[ 2.00083094e+01  0.00000000e+00]
 [-7.98789471e-03  1.83025661e-02]]
grads:  [2.25402087e-03 1.21706124e+01]
Stock Position:  0.0022540208662055056
Bond Position:  [-10.5964216]


portfolio before change:  [-10.37377637]
curr_Stock_Price:  99.36459343828953
curr_Factors:  [9.93645934e+01 4.04228460e-02]
mat_Sqrt:  [[ 1.99776824e+01  0.00000000e+00]
 [-8.04217344e-03  1.84269343e-02]]
grads:  [-1.33103696e-03  1.33879043e+00]
Stock Position:  -0.0013310369561828057
Bond Position:  [-10.24151842]


portfolio before change:  [-10.37518266]
curr_Stock_Price:  99.45927386038767
curr_Factors:  [9.94592739e+01 4.01141359e-02]
mat_Sqrt:  [[ 1.99202142e+01  0.00000000e+00]
 [-8.01140546e-03  1.83564360e-02]]
grads:  [2.03577627e-03 3.16298358e+00]
Stock Position:  0.0020357762673333265
Bond Position:  [-10.57765949]


portfolio before change:  [-10.37711645]
curr_Stock_Price:  99.15889597106728
curr_Factors:  [9.91588960e+01 4.13926553e-02]
mat_Sqrt:  [[ 2.01740608e+01  0.00000000e+00]
 [-8.13807401e-03  1.86466701e-02]]
grads:  [-6.33320495e-04 -5.11611398e+00]
Stock Position:  -0.0006333204946488638
Bond Position:  [-10.31431709]


portfolio before change:  [-10.37874166]
curr_Stock_Price:  99.68917111881002
curr_Factors:  [9.96891711e+01 3.99038893e-02]
mat_Sqrt:  [[ 1.99138668e+01  0.00000000e+00]
 [-7.99038315e-03  1.83082678e-02]]
grads:  [ 0.00476312 -0.01512743]
Stock Position:  0.00476311580826894
Bond Position:  [-10.85357272]


portfolio before change:  [-10.38167927]
curr_Stock_Price:  99.35727990983906
curr_Factors:  [9.93572799e+01 3.91735039e-02]
mat_Sqrt:  [[ 1.96650884e+01  0.00000000e+00]
 [-7.91691898e-03  1.81399403e-02]]
grads:  [1.15912253e-02 1.70995907e+01]
Stock Position:  0.01159122533922142
Bond Position:  [-11.5333519]


portfolio before change:  [-10.40060547]
curr_Stock_Price:  97.84885981492702
curr_Factors:  [9.78488598e+01 3.91004945e-02]
mat_Sqrt:  [[ 1.93484819e+01  0.00000000e+00]
 [-7.90953799e-03  1.81230283e-02]]
grads:  [7.19105923e-03 1.31351122e+01]
Stock Position:  0.007191059230754006
Bond Position:  [-11.10424242]


portfolio before change:  [-10.38666751]
curr_Stock_Price:  99.98012818288984
curr_Factors:  [9.99801282e+01 3.76089692e-02]
mat_Sqrt:  [[ 1.93891783e+01  0.00000000e+00]
 [-7.75721282e-03  1.77740075e-02]]
grads:  [1.94090124e-03 8.15092839e+00]
Stock Position:  0.0019409012382796333
Bond Position:  [-10.58071907]


portfolio before change:  [-10.38708002]
curr_Stock_Price:  100.44906857217936
curr_Factors:  [1.00449069e+02 3.69831942e-02]
mat_Sqrt:  [[ 1.93173756e+01  0.00000000e+00]
 [-7.69240605e-03  1.76255165e-02]]
grads:  [2.35465927e-03 2.97507601e+00]
Stock Position:  0.0023546592703640383
Bond Position:  [-10.62360335]


portfolio before change:  [-10.38649615]
curr_Stock_Price:  101.26103185834798
curr_Factors:  [1.01261032e+02 3.70254578e-02]
mat_Sqrt:  [[ 1.94846481e+01  0.00000000e+00]
 [-7.69680015e-03  1.76355846e-02]]
grads:  [  0.03019763 -14.4956489 ]
Stock Position:  0.03019762520416536
Bond Position:  [-13.44433884]


portfolio before change:  [-10.40086728]
curr_Stock_Price:  100.8407843475209
curr_Factors:  [1.00840784e+02 3.56349402e-02]
mat_Sqrt:  [[ 1.90359358e+01  0.00000000e+00]
 [-7.55088765e-03  1.73012571e-02]]
grads:  [8.55617876e-05 4.47539831e+00]
Stock Position:  8.556178759521869e-05
Bond Position:  [-10.4094954]


portfolio before change:  [-10.40221173]
curr_Stock_Price:  100.33604159099731
curr_Factors:  [1.00336042e+02 3.47770231e-02]
mat_Sqrt:  [[ 1.87112657e+01  0.00000000e+00]
 [-7.45943946e-03  1.70917230e-02]]
grads:  [-3.27220350e-03  5.93993959e+00]
Stock Position:  -0.0032722035035963205
Bond Position:  [-10.07389179]


portfolio before change:  [-10.40562047]
curr_Stock_Price:  100.99291532567618
curr_Factors:  [1.00992915e+02 3.38461871e-02]
mat_Sqrt:  [[ 1.85800032e+01  0.00000000e+00]
 [-7.35893330e-03  1.68614344e-02]]
grads:  [-3.10109295e-04 -9.86027009e+00]
Stock Position:  -0.00031010929514510457
Bond Position:  [-10.37430163]


portfolio before change:  [-10.40694507]
curr_Stock_Price:  101.0823227864836
curr_Factors:  [1.01082323e+02 3.36100120e-02]
mat_Sqrt:  [[ 1.85314562e+01  0.00000000e+00]
 [-7.33321343e-03  1.68025028e-02]]
grads:  [-0.00271097 -2.29332093]
Stock Position:  -0.0027109709109774446
Bond Position:  [-10.13291383]


portfolio before change:  [-10.4102282]
curr_Stock_Price:  101.82613126654854
curr_Factors:  [1.01826131e+02 3.30543529e-02]
mat_Sqrt:  [[ 1.85128624e+01  0.00000000e+00]
 [-7.27234245e-03  1.66630299e-02]]
grads:  [-0.02795225 -5.97470268]
Stock Position:  -0.027952251806820438
Bond Position:  [-7.56395854]


portfolio before change:  [-10.39758767]
curr_Stock_Price:  101.34008493302743
curr_Factors:  [1.01340085e+02 3.46989901e-02]
mat_Sqrt:  [[ 1.88772915e+01  0.00000000e+00]
 [-7.45106598e-03  1.70725369e-02]]
grads:  [-0.0062022   0.12189982]
Stock Position:  -0.006202196513380729
Bond Position:  [-9.76905655]


portfolio before change:  [-10.40025356]
curr_Stock_Price:  101.57301539217337
curr_Factors:  [1.01573015e+02 3.42265851e-02]
mat_Sqrt:  [[ 1.87914430e+01  0.00000000e+00]
 [-7.40017136e-03  1.69559227e-02]]
grads:  [0.00790391 4.59649576]
Stock Position:  0.007903907100387072
Bond Position:  [-11.20307723]


portfolio before change:  [-10.40966587]
curr_Stock_Price:  100.55935911225268
curr_Factors:  [1.00559359e+02 3.48986459e-02]
mat_Sqrt:  [[ 1.87856742e+01  0.00000000e+00]
 [-7.47247171e-03  1.71215836e-02]]
grads:  [0.00857239 4.61350747]
Stock Position:  0.00857239129288551
Bond Position:  [-11.27170005]


portfolio before change:  [-10.41748246]
curr_Stock_Price:  99.81189703605543
curr_Factors:  [9.98118970e+01 3.52272463e-02]
mat_Sqrt:  [[ 1.87336179e+01  0.00000000e+00]
 [-7.50756912e-03  1.72020019e-02]]
grads:  [-0.01334854 -2.49829617]
Stock Position:  -0.01334854043439121
Bond Position:  [-9.08513932]


portfolio before change:  [-10.38950912]
curr_Stock_Price:  97.63120518235617
curr_Factors:  [9.76312052e+01 3.62638277e-02]
mat_Sqrt:  [[ 1.85919727e+01  0.00000000e+00]
 [-7.61722550e-03  1.74532562e-02]]
grads:  [ -0.04991371 -14.3440224 ]
Stock Position:  -0.04991371194807998
Bond Position:  [-5.51637327]


portfolio before change:  [-10.38004204]
curr_Stock_Price:  97.42772065673081
curr_Factors:  [9.74277207e+01 3.63008582e-02]
mat_Sqrt:  [[ 1.85626933e+01  0.00000000e+00]
 [-7.62111364e-03  1.74621651e-02]]
grads:  [5.92657347e-03 1.74025110e+01]
Stock Position:  0.005926573466828382
Bond Position:  [-10.95745459]


portfolio before change:  [-10.38894664]
curr_Stock_Price:  96.15635699207137
curr_Factors:  [9.61563570e+01 3.83517857e-02]
mat_Sqrt:  [[ 1.88308878e+01  0.00000000e+00]
 [-7.83344478e-03  1.79486768e-02]]
grads:  [-4.68300890e-03  6.09302654e+00]
Stock Position:  -0.004683008903585362
Bond Position:  [-9.93864557]


portfolio before change:  [-10.39261054]
curr_Stock_Price:  96.67343775733636
curr_Factors:  [9.66734378e+01 3.88051126e-02]
mat_Sqrt:  [[ 1.90437134e+01  0.00000000e+00]
 [-7.87960533e-03  1.80544439e-02]]
grads:  [0.04479404 0.1982489 ]
Stock Position:  0.04479403521334707
Bond Position:  [-14.72300392]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.44725964]
Stock Price:  95.49451727784603
PL:  [-10.44725964]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 1.39947438e-01  4.33708202e-01]
 [-1.84170163e-01 -7.46273338e-02]
 [ 7.67969719e-01 -6.48085948e-01]
 [ 4.08198022e-02  3.07146960e-02]
 [-1.23658498e-01  5.28492853e-02]
 [-8.24553827e-02 -6.34452151e-02]
 [-1.75097354e-02  2.56929228e-01]
 [ 2.29642638e-01 -2.10353834e-03]
 [ 1.20376257e-01  8.46513060e-02]
 [ 3.14017804e-01 -1.46841660e-01]
 [ 6.34119924e-02 -1.59059500e-03]
 [-1.48291430e-01 -1.50825474e-01]
 [-1.58210943e-01  1.54559691e-01]
 [-4.87560470e-01 -6.28150607e-01]
 [ 7.39167029e-02  2.14372817e-01]
 [ 5.39854787e-02 -2.03950194e-02]
 [-5.28889361e-02  2.66066450e-01]
 [-1.20353073e-01  4.19424030e-02]
 [ 1.48142304e-02  6.79664739e-02]
 [-1.02776304e-01 -3.39112538e-02]
 [ 2.09817365e-01  3.73589302e-01]
 [ 5.10176562e-03  1.67801577e-01]
 [-1.26616849e-02 -2.30965736e-01]
 [ 1.18114612e-01  1.97833439e-01]
 [ 6.92755478e-02  1.45855096e-01]
 [ 7.87005317e-01 -6.34559809e-01]
 [-6.01324375e-01  7.54577298e-01]
 [ 1.28886330e-01 -1.10059032e-02]
 [-5.11271159e-02 -5.85127853e-02]
 [ 8.50972471e-02 -1.95123018e-01]
 [ 1.30416372e-01 -6.52116060e-02]
 [ 1.61737950e-01 -1.47396587e-02]
 [ 2.35910251e-01  2.80239235e-01]
 [ 2.34530100e-01  2.35991003e-02]
 [-1.83142159e-01 -2.38504968e-01]
 [ 1.83277274e-01 -7.48987506e-02]
 [-2.17104840e-01  1.73098133e-01]
 [-1.17353380e-01  1.21883545e-01]
 [-1.31713479e-01  1.33129756e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.03307166]
curr_Stock_Price:  100.3502242612615
curr_Factors:  [1.00350224e+02 4.01312874e-02]
mat_Sqrt:  [[ 2.01029547e+01  0.00000000e+00]
 [-8.01311799e-03  1.83603599e-02]]
grads:  [1.63773545e-02 2.36219881e+01]
Stock Position:  0.016377354507548018
Bond Position:  [3.38960046]


portfolio before change:  [5.04824815]
curr_Stock_Price:  101.2510271354144
curr_Factors:  [1.01251027e+02 3.89084451e-02]
mat_Sqrt:  [[ 1.99719916e+01  0.00000000e+00]
 [-7.89008949e-03  1.80784662e-02]]
grads:  [-0.01085221 -4.12796822]
Stock Position:  -0.010852207717249538
Bond Position:  [6.14704533]


portfolio before change:  [5.04633026]
curr_Stock_Price:  101.49856427330556
curr_Factors:  [1.01498564e+02 3.83091502e-02]
mat_Sqrt:  [[ 1.98660333e+01  0.00000000e+00]
 [-7.82908937e-03  1.79386973e-02]]
grads:  [ 2.44196622e-02 -3.61278155e+01]
Stock Position:  0.024419662228402535
Bond Position:  [2.5677696]


portfolio before change:  [5.06225138]
curr_Stock_Price:  102.1373989405076
curr_Factors:  [1.02137399e+02 3.82953135e-02]
mat_Sqrt:  [[ 1.99874600e+01  0.00000000e+00]
 [-7.82767536e-03  1.79354574e-02]]
grads:  [0.00271294 1.71251255]
Stock Position:  0.002712940738715908
Bond Position:  [4.78515867]


portfolio before change:  [5.06153918]
curr_Stock_Price:  101.65438787193415
curr_Factors:  [1.01654388e+02 3.89492190e-02]
mat_Sqrt:  [[ 2.00620591e+01  0.00000000e+00]
 [-7.89422259e-03  1.80879363e-02]]
grads:  [-0.0050141   2.92179741]
Stock Position:  -0.005014100411180334
Bond Position:  [5.57124449]


portfolio before change:  [5.06802758]
curr_Stock_Price:  100.49925586118054
curr_Factors:  [1.00499256e+02 4.04154007e-02]
mat_Sqrt:  [[ 2.02039503e+01  0.00000000e+00]
 [-8.04143278e-03  1.84252372e-02]]
grads:  [-0.00545166 -3.44338661]
Stock Position:  -0.005451663820379743
Bond Position:  [5.61591573]


portfolio before change:  [5.07299237]
curr_Stock_Price:  99.71733611024437
curr_Factors:  [9.97173361e+01 4.03365204e-02]
mat_Sqrt:  [[ 2.00271838e+01  0.00000000e+00]
 [-8.03358156e-03  1.84072478e-02]]
grads:  [4.72474681e-03 1.39580469e+01]
Stock Position:  0.004724746809746301
Bond Position:  [4.60185321]


portfolio before change:  [5.08066472]
curr_Stock_Price:  101.21944426326428
curr_Factors:  [1.01219444e+02 3.81061927e-02]
mat_Sqrt:  [[ 1.97588529e+01  0.00000000e+00]
 [-7.80832302e-03  1.78911156e-02]]
grads:  [ 0.0115758  -0.11757446]
Stock Position:  0.011575802498098534
Bond Position:  [3.90896843]


portfolio before change:  [5.08536563]
curr_Stock_Price:  101.58332889533331
curr_Factors:  [1.01583329e+02 3.80408438e-02]
mat_Sqrt:  [[ 1.98128755e+01  0.00000000e+00]
 [-7.80162484e-03  1.78757682e-02]]
grads:  [0.00794035 4.73553389]
Stock Position:  0.007940347424852128
Bond Position:  [4.27875871]


portfolio before change:  [5.08162821]
curr_Stock_Price:  101.04528020083208
curr_Factors:  [1.01045280e+02 3.81132007e-02]
mat_Sqrt:  [[ 1.97266684e+01  0.00000000e+00]
 [-7.80904098e-03  1.78927607e-02]]
grads:  [ 0.01266969 -8.20676376]
Stock Position:  0.012669693889780056
Bond Position:  [3.80141544]


portfolio before change:  [5.09741928]
curr_Stock_Price:  102.25413777005103
curr_Factors:  [1.02254138e+02 3.65976923e-02]
mat_Sqrt:  [[ 1.95617517e+01  0.00000000e+00]
 [-7.65220933e-03  1.75334142e-02]]
grads:  [ 0.00320614 -0.09071793]
Stock Position:  0.003206144359746251
Bond Position:  [4.76957775]


portfolio before change:  [5.09560308]
curr_Stock_Price:  101.50169791866483
curr_Factors:  [1.01501698e+02 3.69477826e-02]
mat_Sqrt:  [[ 1.95104595e+01  0.00000000e+00]
 [-7.68872240e-03  1.76170762e-02]]
grads:  [-0.01097448 -8.56132268]
Stock Position:  -0.0109744757183826
Bond Position:  [6.209531]


portfolio before change:  [5.0952425]
curr_Stock_Price:  101.60528581995283
curr_Factors:  [1.01605286e+02 3.63554666e-02]
mat_Sqrt:  [[ 1.93731911e+01  0.00000000e+00]
 [-7.62684381e-03  1.74752945e-02]]
grads:  [-4.68459550e-03  8.84446844e+00]
Stock Position:  -0.004684595499105365
Bond Position:  [5.57122216]


portfolio before change:  [5.09697168]
curr_Stock_Price:  101.38483097578224
curr_Factors:  [1.01384831e+02 3.57887861e-02]
mat_Sqrt:  [[ 1.91799056e+01  0.00000000e+00]
 [-7.56716973e-03  1.73385640e-02]]
grads:  [ -0.03971385 -36.22852536]
Stock Position:  -0.039713848746244965
Bond Position:  [9.12335353]


portfolio before change:  [5.1124475]
curr_Stock_Price:  101.02386567608642
curr_Factors:  [1.01023866e+02 3.51338518e-02]
mat_Sqrt:  [[ 1.89359398e+01  0.00000000e+00]
 [-7.49761048e-03  1.71791838e-02]]
grads:  [8.84438121e-03 1.24786381e+01]
Stock Position:  0.008844381205953706
Bond Position:  [4.21895392]


portfolio before change:  [5.10960677]
curr_Stock_Price:  100.64304466144277
curr_Factors:  [1.00643045e+02 3.54812547e-02]
mat_Sqrt:  [[ 1.89575955e+01  0.00000000e+00]
 [-7.53458742e-03  1.72639086e-02]]
grads:  [ 0.00237817 -1.18136743]
Stock Position:  0.0023781688231989473
Bond Position:  [4.87026062]


portfolio before change:  [5.11372993]
curr_Stock_Price:  102.12079503608562
curr_Factors:  [1.02120795e+02 3.51406347e-02]
mat_Sqrt:  [[ 1.91433962e+01  0.00000000e+00]
 [-7.49833419e-03  1.71808420e-02]]
grads:  [3.30307025e-03 1.54862288e+01]
Stock Position:  0.00330307025424655
Bond Position:  [4.77641777]


portfolio before change:  [5.11241938]
curr_Stock_Price:  101.54325809107581
curr_Factors:  [1.01543258e+02 3.48757624e-02]
mat_Sqrt:  [[ 1.89632578e+01  0.00000000e+00]
 [-7.47002141e-03  1.71159693e-02]]
grads:  [-0.00538135  2.45048365]
Stock Position:  -0.005381348982290435
Bond Position:  [5.65885909]


portfolio before change:  [5.1047603]
curr_Stock_Price:  103.09797523513356
curr_Factors:  [1.03097975e+02 3.43687252e-02]
mat_Sqrt:  [[ 1.91131315e+01  0.00000000e+00]
 [-7.41552159e-03  1.69910945e-02]]
grads:  [2.32705099e-03 4.00012336e+00]
Stock Position:  0.0023270509855082494
Bond Position:  [4.86484606]


portfolio before change:  [5.10780339]
curr_Stock_Price:  104.14433907365198
curr_Factors:  [1.04144339e+02 3.39374984e-02]
mat_Sqrt:  [[ 1.91856087e+01  0.00000000e+00]
 [-7.36885320e-03  1.68841638e-02]]
grads:  [-0.00612836 -2.00846511]
Stock Position:  -0.006128363756571278
Bond Position:  [5.74603778]


portfolio before change:  [5.10071521]
curr_Stock_Price:  105.41816590187167
curr_Factors:  [1.05418166e+02 3.41208485e-02]
mat_Sqrt:  [[ 1.94726639e+01  0.00000000e+00]
 [-7.38873180e-03  1.69297114e-02]]
grads:  [1.91481302e-02 2.20670804e+01]
Stock Position:  0.019148130216937346
Bond Position:  [3.08215445]


portfolio before change:  [5.11810806]
curr_Stock_Price:  106.30637535593958
curr_Factors:  [1.06306375e+02 3.41705370e-02]
mat_Sqrt:  [[ 1.96510252e+01  0.00000000e+00]
 [-7.39410976e-03  1.69420338e-02]]
grads:  [3.98637614e-03 9.90445297e+00]
Stock Position:  0.003986376140702946
Bond Position:  [4.69433086]


portfolio before change:  [5.11831103]
curr_Stock_Price:  106.21008271691855
curr_Factors:  [1.06210083e+02 3.43737892e-02]
mat_Sqrt:  [[ 1.96915296e+01  0.00000000e+00]
 [-7.41606787e-03  1.69923462e-02]]
grads:  [-5.76204078e-03 -1.35923394e+01]
Stock Position:  -0.005762040779681559
Bond Position:  [5.73029786]


portfolio before change:  [5.12077746]
curr_Stock_Price:  105.90635273206374
curr_Factors:  [1.05906353e+02 3.36333612e-02]
mat_Sqrt:  [[ 1.94225902e+01  0.00000000e+00]
 [-7.33576022e-03  1.68083382e-02]]
grads:  [1.05267217e-02 1.17699582e+01]
Stock Position:  0.010526721748164165
Bond Position:  [4.00593076]


portfolio before change:  [5.11662541]
curr_Stock_Price:  105.46435117711073
curr_Factors:  [1.05464351e+02 3.44015416e-02]
mat_Sqrt:  [[ 1.95611614e+01  0.00000000e+00]
 [-7.41906103e-03  1.69992044e-02]]
grads:  [6.79570744e-03 8.58011307e+00]
Stock Position:  0.006795707437167246
Bond Position:  [4.39992053]


portfolio before change:  [5.1185696]
curr_Stock_Price:  105.66950462987826
curr_Factors:  [1.05669505e+02 3.47595329e-02]
mat_Sqrt:  [[ 1.97009259e+01  0.00000000e+00]
 [-7.45756345e-03  1.70874245e-02]]
grads:  [ 2.58901898e-02 -3.71360710e+01]
Stock Position:  0.02589018984791719
Bond Position:  [2.38276606]


portfolio before change:  [5.14303531]
curr_Stock_Price:  106.60297995113476
curr_Factors:  [1.06602980e+02 3.50905906e-02]
mat_Sqrt:  [[ 1.99693847e+01  0.00000000e+00]
 [-7.49299306e-03  1.71686039e-02]]
grads:  [-1.36208425e-02  4.39509992e+01]
Stock Position:  -0.013620842461836168
Bond Position:  [6.59505771]


portfolio before change:  [5.15628613]
curr_Stock_Price:  105.69067370391845
curr_Factors:  [1.05690674e+02 3.57024741e-02]
mat_Sqrt:  [[ 1.99703567e+01  0.00000000e+00]
 [-7.55803933e-03  1.73176437e-02]]
grads:  [ 0.00621336 -0.63553122]
Stock Position:  0.006213357225733691
Bond Position:  [4.49959222]


portfolio before change:  [5.16293613]
curr_Stock_Price:  106.67042075915799
curr_Factors:  [1.06670421e+02 3.53300718e-02]
mat_Sqrt:  [[ 2.00500873e+01  0.00000000e+00]
 [-7.51851813e-03  1.72270892e-02]]
grads:  [-0.00382363 -3.3965567 ]
Stock Position:  -0.003823633675574126
Bond Position:  [5.57080474]


portfolio before change:  [5.16226285]
curr_Stock_Price:  107.02863381850506
curr_Factors:  [1.07028634e+02 3.58352076e-02]
mat_Sqrt:  [[ 2.02607232e+01  0.00000000e+00]
 [-7.57207581e-03  1.73498053e-02]]
grads:  [-3.03147120e-06 -1.12464097e+01]
Stock Position:  -3.0314711951426225e-06
Bond Position:  [5.1625873]


portfolio before change:  [5.16290922]
curr_Stock_Price:  106.69526579485579
curr_Factors:  [1.06695266e+02 3.66941192e-02]
mat_Sqrt:  [[ 2.04382348e+01  0.00000000e+00]
 [-7.66228365e-03  1.75564974e-02]]
grads:  [ 0.00498848 -3.71438588]
Stock Position:  0.004988478446441351
Bond Position:  [4.63066219]


portfolio before change:  [5.16388883]
curr_Stock_Price:  106.7755983986363
curr_Factors:  [1.06775598e+02 3.75753624e-02]
mat_Sqrt:  [[ 2.06977722e+01  0.00000000e+00]
 [-7.75374618e-03  1.77660644e-02]]
grads:  [ 0.00750347 -0.82965244]
Stock Position:  0.007503466253427807
Bond Position:  [4.36270173]


portfolio before change:  [5.16015939]
curr_Stock_Price:  106.20588668986508
curr_Factors:  [1.06205887e+02 3.76724980e-02]
mat_Sqrt:  [[ 2.06139301e+01  0.00000000e+00]
 [-7.76376176e-03  1.77890130e-02]]
grads:  [ 0.01737741 15.75350107]
Stock Position:  0.017377408369672498
Bond Position:  [3.31457632]


portfolio before change:  [5.17157812]
curr_Stock_Price:  106.83914483165637
curr_Factors:  [1.06839145e+02 3.72327644e-02]
mat_Sqrt:  [[ 2.06154607e+01  0.00000000e+00]
 [-7.71831737e-03  1.76848868e-02]]
grads:  [0.01187602 1.3344219 ]
Stock Position:  0.01187601844382891
Bond Position:  [3.90275447]


portfolio before change:  [5.17082253]
curr_Stock_Price:  106.73444040688634
curr_Factors:  [1.06734440e+02 3.78039387e-02]
mat_Sqrt:  [[ 2.07526281e+01  0.00000000e+00]
 [-7.77729400e-03  1.78200192e-02]]
grads:  [ -0.01384086 -13.38410271]
Stock Position:  -0.013840861995188386
Bond Position:  [6.64811919]


portfolio before change:  [5.16464206]
curr_Stock_Price:  107.24102264545357
curr_Factors:  [1.07241023e+02 3.59814701e-02]
mat_Sqrt:  [[ 2.03423161e+01  0.00000000e+00]
 [-7.58751291e-03  1.73851761e-02]]
grads:  [ 0.00740274 -4.30819625]
Stock Position:  0.007402735168759302
Bond Position:  [4.37076517]


portfolio before change:  [5.16515521]
curr_Stock_Price:  107.2365344137988
curr_Factors:  [1.07236534e+02 3.50326525e-02]
mat_Sqrt:  [[ 2.00714746e+01  0.00000000e+00]
 [-7.48680465e-03  1.71544245e-02]]
grads:  [-7.05272651e-03  1.00905823e+01]
Stock Position:  -0.007052726508728715
Bond Position:  [5.92146516]


portfolio before change:  [5.17263944]
curr_Stock_Price:  106.28030868931428
curr_Factors:  [1.06280309e+02 3.60051606e-02]
mat_Sqrt:  [[ 2.01667161e+01  0.00000000e+00]
 [-7.59001034e-03  1.73908985e-02]]
grads:  [-3.18143222e-03  7.00846741e+00]
Stock Position:  -0.003181432217936539
Bond Position:  [5.51076304]


portfolio before change:  [5.17739866]
curr_Stock_Price:  105.00090690556928
curr_Factors:  [1.05000907e+02 3.51832792e-02]
mat_Sqrt:  [[ 1.96952368e+01  0.00000000e+00]
 [-7.50288256e-03  1.71912636e-02]]
grads:  [-3.73749706e-03  7.74403551e+00]
Stock Position:  -0.003737497056275775
Bond Position:  [5.56983924]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.18102502]
Stock Price:  104.21693501190875
PL:  [0.96409001]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.36419125e-02  2.43371259e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 7.60606723e-01 -6.43077327e-01]
 [ 4.38741929e-02  3.12848771e-02]
 [-1.35430096e-01  5.75603950e-02]
 [ 1.02253733e-01  1.11781213e-01]
 [ 9.70503315e-02  4.10163118e-02]
 [ 2.09606553e-01 -2.07252247e-03]
 [ 1.41457250e-01  7.79468754e-02]
 [ 2.86744656e-01 -1.26797385e-01]
 [ 1.12445497e-01  1.71359889e-01]
 [ 1.87450848e-01  2.37635547e-01]
 [ 1.73586169e-01  2.94088472e-02]
 [-1.91405065e-01 -2.41034256e-01]
 [ 8.56137320e-02  2.29793926e-01]
 [ 5.28192464e-02 -1.96519514e-02]
 [-5.21234435e-02  2.23035631e-01]
 [-1.77436696e-02  4.16701391e-02]
 [ 1.56617122e-02  4.69233742e-02]
 [-1.93615052e-03 -8.84020720e-02]
 [ 1.01408004e-01  6.36067338e-03]
 [ 8.59651596e-02  3.05844897e-01]
 [ 3.62281986e-02  2.94807773e-01]
 [-8.28617462e-02  1.07655110e-01]
 [ 3.94915067e-02  9.12701536e-02]
 [ 3.00539208e-01 -1.94350836e-02]
 [-3.76104407e-02  2.23073145e-01]
 [-1.96078641e-01  1.41746421e-01]
 [-7.37304984e-02 -1.00169883e-01]
 [ 3.71262701e-02 -5.50006094e-02]
 [-7.46311578e-01 -9.35749260e-02]
 [-1.18163578e-01  8.86002729e-03]
 [-4.91012676e-03 -9.00923635e-02]
 [ 8.71352151e-02  9.92191817e-02]
 [-1.65773838e-01  7.28622046e-02]
 [-3.18422351e-01 -3.72251284e-01]
 [-7.65903342e-02  2.90746263e-01]
 [-1.22463867e-01  1.18435906e-01]
 [-8.37275088e-02  1.20989369e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.38067362]
curr_Stock_Price:  99.80011400143616
curr_Factors:  [9.9800114e+01 3.9952993e-02]
mat_Sqrt:  [[ 1.99482911e+01  0.00000000e+00]
 [-7.99529792e-03  1.83195290e-02]]
grads:  [4.64069892e-03 1.32847990e+01]
Stock Position:  0.0046406989201158945
Bond Position:  [0.91753134]


portfolio before change:  [1.3811019]
curr_Stock_Price:  99.8676860207726
curr_Factors:  [9.98676860e+01 3.91609751e-02]
mat_Sqrt:  [[ 1.97629483e+01  0.00000000e+00]
 [-7.91565285e-03  1.81370392e-02]]
grads:  [-0.01027096 -4.8525765 ]
Stock Position:  -0.01027095979956158
Bond Position:  [2.40683889]


portfolio before change:  [1.36530349]
curr_Stock_Price:  101.43514290675662
curr_Factors:  [1.01435143e+02 3.84679104e-02]
mat_Sqrt:  [[ 1.98947160e+01  0.00000000e+00]
 [-7.84529519e-03  1.79758295e-02]]
grads:  [ 2.41242332e-02 -3.57745564e+01]
Stock Position:  0.024124233199973494
Bond Position:  [-1.08174155]


portfolio before change:  [1.38177224]
curr_Stock_Price:  102.12341236431517
curr_Factors:  [1.02123412e+02 3.75305983e-02]
mat_Sqrt:  [[ 1.97841803e+01  0.00000000e+00]
 [-7.74912623e-03  1.77554787e-02]]
grads:  [0.00290778 1.76198443]
Stock Position:  0.0029077794317441345
Bond Position:  [1.08481988]


portfolio before change:  [1.3816596]
curr_Stock_Price:  102.03803696765712
curr_Factors:  [1.02038037e+02 3.95278685e-02]
mat_Sqrt:  [[ 2.02868115e+01  0.00000000e+00]
 [-7.95264670e-03  1.82218027e-02]]
grads:  [-0.00543746  3.15887488]
Stock Position:  -0.005437457753586797
Bond Position:  [1.93648711]


portfolio before change:  [1.37806342]
curr_Stock_Price:  102.74392834784513
curr_Factors:  [1.02743928e+02 4.09465200e-02]
mat_Sqrt:  [[ 2.07904871e+01  0.00000000e+00]
 [-8.09409859e-03  1.85459097e-02]]
grads:  [0.00726482 6.02727042]
Stock Position:  0.007264815531144573
Bond Position:  [0.63164773]


portfolio before change:  [1.38341197]
curr_Stock_Price:  103.46928584060414
curr_Factors:  [1.03469286e+02 4.08305037e-02]
mat_Sqrt:  [[ 2.09075826e+01  0.00000000e+00]
 [-8.08262371e-03  1.85196175e-02]]
grads:  [0.00549807 2.21474941]
Stock Position:  0.0054980683293578275
Bond Position:  [0.81453076]


portfolio before change:  [1.3690339]
curr_Stock_Price:  100.83565378645463
curr_Factors:  [1.00835654e+02 4.44926143e-02]
mat_Sqrt:  [[ 2.12695392e+01  0.00000000e+00]
 [-8.43730898e-03  1.93323035e-02]]
grads:  [ 0.00981225 -0.10720515]
Stock Position:  0.00981224971160231
Bond Position:  [0.37960929]


portfolio before change:  [1.36689332]
curr_Stock_Price:  100.61266338109493
curr_Factors:  [1.00612663e+02 4.21046838e-02]
mat_Sqrt:  [[ 2.06451409e+01  0.00000000e+00]
 [-8.20777035e-03  1.88063645e-02]]
grads:  [0.00849963 4.14470727]
Stock Position:  0.008499629853727769
Bond Position:  [0.51172292]


portfolio before change:  [1.3645527]
curr_Stock_Price:  100.3297582371143
curr_Factors:  [1.00329758e+02 4.03972199e-02]
mat_Sqrt:  [[ 2.01653380e+01  0.00000000e+00]
 [-8.03962386e-03  1.84210925e-02]]
grads:  [ 0.01147542 -6.88327175]
Stock Position:  0.01147542089515634
Bond Position:  [0.21322649]


portfolio before change:  [1.34895419]
curr_Stock_Price:  98.96813786170833
curr_Factors:  [9.89681379e+01 4.15595298e-02]
mat_Sqrt:  [[ 2.01757976e+01  0.00000000e+00]
 [-8.15446183e-03  1.86842193e-02]]
grads:  [0.00928008 9.17137004]
Stock Position:  0.009280083400493529
Bond Position:  [0.43052161]


portfolio before change:  [1.33357363]
curr_Stock_Price:  97.30496593165574
curr_Factors:  [9.73049659e+01 4.21069688e-02]
mat_Sqrt:  [[ 1.99669621e+01  0.00000000e+00]
 [-8.20799306e-03  1.88068748e-02]]
grads:  [ 0.01458226 12.63556814]
Stock Position:  0.014582263544980559
Bond Position:  [-0.08535303]


portfolio before change:  [1.34021239]
curr_Stock_Price:  97.76096053607763
curr_Factors:  [9.77609605e+01 4.27401576e-02]
mat_Sqrt:  [[ 2.02108007e+01  0.00000000e+00]
 [-8.26947714e-03  1.89477525e-02]]
grads:  [0.00922384 1.55210214]
Stock Position:  0.009223842456812941
Bond Position:  [0.43848069]


portfolio before change:  [1.33872755]
curr_Stock_Price:  97.59403909455612
curr_Factors:  [9.75940391e+01 4.20329726e-02]
mat_Sqrt:  [[ 2.00086757e+01  0.00000000e+00]
 [-8.20077778e-03  1.87903425e-02]]
grads:  [ -0.01482362 -12.82756059]
Stock Position:  -0.01482362170867442
Bond Position:  [2.78542467]


portfolio before change:  [1.32794743]
curr_Stock_Price:  98.34475442814067
curr_Factors:  [9.83447544e+01 4.09822786e-02]
mat_Sqrt:  [[ 1.99089910e+01  0.00000000e+00]
 [-8.09763211e-03  1.85540061e-02]]
grads:  [9.33769185e-03 1.23851380e+01]
Stock Position:  0.009337691847997622
Bond Position:  [0.40963442]


portfolio before change:  [1.33775551]
curr_Stock_Price:  99.38964601843965
curr_Factors:  [9.93896460e+01 3.93511046e-02]
mat_Sqrt:  [[ 1.97160362e+01  0.00000000e+00]
 [-7.93484513e-03  1.81810142e-02]]
grads:  [ 0.00224398 -1.08090512]
Stock Position:  0.002243982061698486
Bond Position:  [1.11472693]


portfolio before change:  [1.3396819]
curr_Stock_Price:  100.18601369964539
curr_Factors:  [1.00186014e+02 3.81464625e-02]
mat_Sqrt:  [[ 1.95674499e+01  0.00000000e+00]
 [-7.81244775e-03  1.79005666e-02]]
grads:  [2.31084206e-03 1.24596967e+01]
Stock Position:  0.0023108420610063146
Bond Position:  [1.10816784]


portfolio before change:  [1.33649438]
curr_Stock_Price:  98.74669209675397
curr_Factors:  [9.87466921e+01 3.83320532e-02]
mat_Sqrt:  [[ 1.93331935e+01  0.00000000e+00]
 [-7.83142931e-03  1.79440588e-02]]
grads:  [2.28968914e-05 2.32222484e+00]
Stock Position:  2.2896891409754753e-05
Bond Position:  [1.33423339]


portfolio before change:  [1.33664803]
curr_Stock_Price:  98.17272948422321
curr_Factors:  [9.81727295e+01 3.84475009e-02]
mat_Sqrt:  [[ 1.92497425e+01  0.00000000e+00]
 [-7.84321372e-03  1.79710603e-02]]
grads:  [1.87746676e-03 2.61105207e+00]
Stock Position:  0.0018774667591298308
Bond Position:  [1.15233199]


portfolio before change:  [1.3398585]
curr_Stock_Price:  99.80600602306849
curr_Factors:  [9.98060060e+01 3.77291751e-02]
mat_Sqrt:  [[ 1.93863180e+01  0.00000000e+00]
 [-7.76959974e-03  1.78023895e-02]]
grads:  [-2.09002957e-03 -4.96574194e+00]
Stock Position:  -0.0020900295708579605
Bond Position:  [1.54845601]


portfolio before change:  [1.34002157]
curr_Stock_Price:  99.82060179240582
curr_Factors:  [9.98206018e+01 3.76917754e-02]
mat_Sqrt:  [[ 1.93795408e+01  0.00000000e+00]
 [-7.76574791e-03  1.77935638e-02]]
grads:  [0.00537598 0.35747046]
Stock Position:  0.005375980315347539
Bond Position:  [0.80338798]


portfolio before change:  [1.33603135]
curr_Stock_Price:  99.05968985357632
curr_Factors:  [9.90596899e+01 3.87608279e-02]
mat_Sqrt:  [[ 1.95026437e+01  0.00000000e+00]
 [-7.87510791e-03  1.80441391e-02]]
grads:  [1.12521574e-02 1.69498193e+01]
Stock Position:  0.011252157368731931
Bond Position:  [0.22139613]


portfolio before change:  [1.3340369]
curr_Stock_Price:  98.87997970757641
curr_Factors:  [9.88799797e+01 3.89454945e-02]
mat_Sqrt:  [[ 1.95135812e+01  0.00000000e+00]
 [-7.89384515e-03  1.80870715e-02]]
grads:  [8.45015875e-03 1.62993646e+01]
Stock Position:  0.008450158754208934
Bond Position:  [0.49848537]


portfolio before change:  [1.32235289]
curr_Stock_Price:  97.48990823976125
curr_Factors:  [9.74899082e+01 3.94089460e-02]
mat_Sqrt:  [[ 1.93533910e+01  0.00000000e+00]
 [-7.94067463e-03  1.81943713e-02]]
grads:  [-1.85379422e-03  5.91694585e+00]
Stock Position:  -0.0018537942195265094
Bond Position:  [1.50307912]


portfolio before change:  [1.32230561]
curr_Stock_Price:  97.61676704296116
curr_Factors:  [9.76167670e+01 3.86505421e-02]
mat_Sqrt:  [[ 1.91912037e+01  0.00000000e+00]
 [-7.86389644e-03  1.80184504e-02]]
grads:  [4.13340761e-03 5.06537198e+00]
Stock Position:  0.0041334076131620285
Bond Position:  [0.91881573]


portfolio before change:  [1.32353993]
curr_Stock_Price:  97.88759776703324
curr_Factors:  [9.78875978e+01 3.89583032e-02]
mat_Sqrt:  [[ 1.93209149e+01  0.00000000e+00]
 [-7.89514314e-03  1.80900455e-02]]
grads:  [ 0.01511611 -1.07435239]
Stock Position:  0.015116108319532865
Bond Position:  [-0.1561396]


portfolio before change:  [1.3317502]
curr_Stock_Price:  98.43203613143437
curr_Factors:  [9.84320361e+01 3.86528609e-02]
mat_Sqrt:  [[ 1.93520640e+01  0.00000000e+00]
 [-7.86413234e-03  1.80189909e-02]]
grads:  [3.08735344e-03 1.23798911e+01]
Stock Position:  0.0030873534409127357
Bond Position:  [1.02785571]


portfolio before change:  [1.33130994]
curr_Stock_Price:  98.24781829610167
curr_Factors:  [9.82478183e+01 3.91648540e-02]
mat_Sqrt:  [[ 1.94433534e+01  0.00000000e+00]
 [-7.91604487e-03  1.81379374e-02]]
grads:  [-6.90289518e-03  7.81491400e+00]
Stock Position:  -0.006902895184936701
Bond Position:  [2.00950433]


portfolio before change:  [1.33109228]
curr_Stock_Price:  98.31574106610151
curr_Factors:  [9.83157411e+01 3.97794132e-02]
mat_Sqrt:  [[ 1.96088554e+01  0.00000000e+00]
 [-7.97791083e-03  1.82796901e-02]]
grads:  [-0.00598955 -5.47984579]
Stock Position:  -0.005989549986123922
Bond Position:  [1.91995933]


portfolio before change:  [1.32625221]
curr_Stock_Price:  99.16389844045247
curr_Factors:  [9.91638984e+01 4.16780615e-02]
mat_Sqrt:  [[ 2.02445136e+01  0.00000000e+00]
 [-8.16608220e-03  1.87108449e-02]]
grads:  [ 6.48177399e-04 -2.93950432e+00]
Stock Position:  0.000648177398702408
Bond Position:  [1.26197641]


portfolio before change:  [1.32637045]
curr_Stock_Price:  99.10292618556366
curr_Factors:  [9.91029262e+01 4.21027486e-02]
mat_Sqrt:  [[ 2.03348842e+01  0.00000000e+00]
 [-8.20758173e-03  1.88059323e-02]]
grads:  [-0.03870939 -4.97581958]
Stock Position:  -0.03870939309060131
Bond Position:  [5.16258457]


portfolio before change:  [1.34785674]
curr_Stock_Price:  98.5645316742852
curr_Factors:  [9.85645317e+01 4.25906746e-02]
mat_Sqrt:  [[ 2.03412633e+01  0.00000000e+00]
 [-8.25500329e-03  1.89145887e-02]]
grads:  [-0.00561896  0.46842294]
Stock Position:  -0.0056189599998874235
Bond Position:  [1.9016869]


portfolio before change:  [1.35217617]
curr_Stock_Price:  97.8381141412849
curr_Factors:  [9.78381141e+01 4.30175893e-02]
mat_Sqrt:  [[ 2.02922922e+01  0.00000000e+00]
 [-8.29627283e-03  1.90091491e-02]]
grads:  [-2.17962847e-03 -4.73942116e+00]
Stock Position:  -0.0021796284670779044
Bond Position:  [1.56542691]


portfolio before change:  [1.35189182]
curr_Stock_Price:  98.05835290896884
curr_Factors:  [9.80583529e+01 4.35844474e-02]
mat_Sqrt:  [[ 2.04715330e+01  0.00000000e+00]
 [-8.35075541e-03  1.91339844e-02]]
grads:  [0.00637168 5.18549507]
Stock Position:  0.006371677976196024
Bond Position:  [0.72709558]


portfolio before change:  [1.35718694]
curr_Stock_Price:  98.87512686550207
curr_Factors:  [9.88751269e+01 4.20053168e-02]
mat_Sqrt:  [[ 2.02646537e+01  0.00000000e+00]
 [-8.19807946e-03  1.87841598e-02]]
grads:  [-0.00661122  3.87891741]
Stock Position:  -0.0066112240314843435
Bond Position:  [2.01087255]


portfolio before change:  [1.34833615]
curr_Stock_Price:  100.25190117887304
curr_Factors:  [1.00251901e+02 4.00465474e-02]
mat_Sqrt:  [[ 2.00620430e+01  0.00000000e+00]
 [-8.00465339e-03  1.83409650e-02]]
grads:  [ -0.02396995 -20.29616674]
Stock Position:  -0.02396994814905466
Bond Position:  [3.75136902]


portfolio before change:  [1.34291809]
curr_Stock_Price:  100.49750071135934
curr_Factors:  [1.00497501e+02 3.95553776e-02]
mat_Sqrt:  [[ 1.99874794e+01  0.00000000e+00]
 [-7.95541352e-03  1.82281423e-02]]
grads:  [2.51666240e-03 1.59504056e+01]
Stock Position:  0.002516662398584803
Bond Position:  [1.08999981]


portfolio before change:  [1.34688371]
curr_Stock_Price:  102.01910461418642
curr_Factors:  [1.02019105e+02 4.00598640e-02]
mat_Sqrt:  [[ 2.04190834e+01  0.00000000e+00]
 [-8.00598416e-03  1.83440142e-02]]
grads:  [-3.46608113e-03  6.45637889e+00]
Stock Position:  -0.003466081128947325
Bond Position:  [1.70049021]


portfolio before change:  [1.3409026]
curr_Stock_Price:  103.80604710184113
curr_Factors:  [1.03806047e+02 3.92470017e-02]
mat_Sqrt:  [[ 2.05648665e+01  0.00000000e+00]
 [-7.92434241e-03  1.81569495e-02]]
grads:  [-1.50370143e-03  6.66352952e+00]
Stock Position:  -0.0015037014283912548
Bond Position:  [1.4969959]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.34235861]
Stock Price:  102.96221005839615
PL:  [-1.61985144]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.32718686e-01  6.72542081e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.38924236e-01 -7.42690375e-01]
 [ 1.31596584e-02  2.36002272e-02]
 [-4.55940841e-02  2.16071371e-02]
 [-3.58679304e-02 -2.32787001e-02]
 [-1.69919649e-02  2.58206635e-01]
 [ 9.74837763e-03 -5.99361998e-02]
 [ 1.57252374e-01  7.29235205e-02]
 [ 2.42827527e-01 -8.93818917e-02]
 [ 8.76300414e-02  8.33848975e-02]
 [ 6.22107517e-02  1.74265013e-01]
 [ 1.47500936e-01  4.26707111e-02]
 [-2.50426054e-01 -3.44572882e-01]
 [ 8.55260954e-02  2.29725829e-01]
 [ 4.95002545e-02  9.27292928e-03]
 [ 2.24780074e-02 -3.14093282e-02]
 [ 2.53919654e-02  5.44698576e-02]
 [ 1.50793556e-02  6.13833753e-02]
 [-4.74669664e-02 -6.88166147e-02]
 [ 1.67934689e-01  7.49813886e-02]
 [ 6.23875278e-02  3.12341498e-01]
 [ 3.77136697e-02  3.80425099e-01]
 [-2.53811627e-02  1.44972892e-01]
 [ 2.92518221e-02  6.66064587e-02]
 [ 6.34521532e-01 -1.96658618e-01]
 [-7.72409693e-02  1.19440087e-01]
 [-9.77746434e-02  9.80641362e-02]
 [ 6.26883375e-02 -1.62563925e-01]
 [-2.94628313e-02 -3.94397961e-02]
 [-7.15729971e-01 -9.04227835e-02]
 [-1.18122683e-01  7.27249718e-03]
 [ 8.50694249e-02  2.77657767e-02]
 [ 1.34440440e-01  7.49495133e-02]
 [-2.89974005e-01 -1.80342861e-01]
 [-7.77199469e-02 -4.09593201e-01]
 [-1.29816129e-01  2.43232891e-01]
 [-1.22647386e-01  1.18312100e-01]
 [ 2.58077763e-01  7.28878408e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.61708897]
curr_Stock_Price:  101.0406514628794
curr_Factors:  [1.01040651e+02 4.01604694e-02]
mat_Sqrt:  [[ 2.02486246e+01  0.00000000e+00]
 [-8.01603088e-03  1.83670341e-02]]
grads:  [3.09275384e-02 3.66168035e+01]
Stock Position:  0.030927538439341432
Bond Position:  [6.49215034]


portfolio before change:  [9.56980995]
curr_Stock_Price:  99.48570739259607
curr_Factors:  [9.94857074e+01 4.09209045e-02]
mat_Sqrt:  [[ 2.01248803e+01  0.00000000e+00]
 [-8.09156643e-03  1.85401078e-02]]
grads:  [-0.01008624 -4.74707974]
Stock Position:  -0.010086243767568198
Bond Position:  [10.57324705]


portfolio before change:  [9.57729683]
curr_Stock_Price:  98.87446524648497
curr_Factors:  [9.88744652e+01 4.00866655e-02]
mat_Sqrt:  [[ 1.97963040e+01  0.00000000e+00]
 [-8.00866186e-03  1.83501496e-02]]
grads:  [ 2.6004227e-02 -4.0473260e+01]
Stock Position:  0.02600422699219156
Bond Position:  [7.00614279]


portfolio before change:  [9.62799317]
curr_Stock_Price:  100.79032777458943
curr_Factors:  [1.00790328e+02 3.87956664e-02]
mat_Sqrt:  [[ 1.98522834e+01  0.00000000e+00]
 [-7.87864622e-03  1.80522463e-02]]
grads:  [1.18171001e-03 1.30732912e+00]
Stock Position:  0.0011817100123113335
Bond Position:  [9.50888823]


portfolio before change:  [9.62863466]
curr_Stock_Price:  100.32726819737488
curr_Factors:  [1.00327268e+02 3.96550338e-02]
mat_Sqrt:  [[ 1.99787425e+01  0.00000000e+00]
 [-7.96542868e-03  1.82510899e-02]]
grads:  [-0.00181012  1.18388201]
Stock Position:  -0.0018101217510297168
Bond Position:  [9.81023923]


portfolio before change:  [9.62814435]
curr_Stock_Price:  101.27563498888264
curr_Factors:  [1.01275635e+02 3.98777291e-02]
mat_Sqrt:  [[ 2.02241457e+01  0.00000000e+00]
 [-7.98776356e-03  1.83022656e-02]]
grads:  [-0.00227587 -1.27190265]
Stock Position:  -0.002275873050068863
Bond Position:  [9.85863484]


portfolio before change:  [9.6328932]
curr_Stock_Price:  99.73054151664734
curr_Factors:  [9.97305415e+01 4.18381380e-02]
mat_Sqrt:  [[ 2.03992571e+01  0.00000000e+00]
 [-8.18174925e-03  1.87467426e-02]]
grads:  [4.69128110e-03 1.37734133e+01]
Stock Position:  0.004691281102299296
Bond Position:  [9.16502919]


portfolio before change:  [9.63260215]
curr_Stock_Price:  99.42428251857766
curr_Factors:  [9.94242825e+01 4.18946226e-02]
mat_Sqrt:  [[ 2.03503371e+01  0.00000000e+00]
 [-8.18727037e-03  1.87593931e-02]]
grads:  [-8.06371139e-04 -3.19499674e+00]
Stock Position:  -0.0008063711394259283
Bond Position:  [9.71277502]


portfolio before change:  [9.63358021]
curr_Stock_Price:  99.71709056570343
curr_Factors:  [9.97170906e+01 4.04921819e-02]
mat_Sqrt:  [[ 2.00657404e+01  0.00000000e+00]
 [-8.04906772e-03  1.84427310e-02]]
grads:  [0.00942297 3.95405216]
Stock Position:  0.009422966943024141
Bond Position:  [8.69394936]


portfolio before change:  [9.63206345]
curr_Stock_Price:  99.44078984515318
curr_Factors:  [9.94407898e+01 4.06568864e-02]
mat_Sqrt:  [[ 2.00507962e+01  0.00000000e+00]
 [-8.06542114e-03  1.84802015e-02]]
grads:  [ 0.01016509 -4.83662973]
Stock Position:  0.010165086144959277
Bond Position:  [8.62123925]


portfolio before change:  [9.63885723]
curr_Stock_Price:  100.00311281807751
curr_Factors:  [1.00003113e+02 4.11399467e-02]
mat_Sqrt:  [[ 2.02836160e+01  0.00000000e+00]
 [-8.11319387e-03  1.85896625e-02]]
grads:  [0.0061144  4.48555198]
Stock Position:  0.006114402580154065
Bond Position:  [9.02739794]


portfolio before change:  [9.63125268]
curr_Stock_Price:  98.57483782969658
curr_Factors:  [9.85748378e+01 4.14321016e-02]
mat_Sqrt:  [[ 2.00647870e+01  0.00000000e+00]
 [-8.14195078e-03  1.86555529e-02]]
grads:  [6.89098963e-03 9.34118727e+00]
Stock Position:  0.0068909896277369685
Bond Position:  [8.9519745]


portfolio before change:  [9.63190635]
curr_Stock_Price:  98.50730119730811
curr_Factors:  [9.85073012e+01 4.30570965e-02]
mat_Sqrt:  [[ 2.04404659e+01  0.00000000e+00]
 [-8.30008159e-03  1.90178761e-02]]
grads:  [0.00812721 2.24371591]
Stock Position:  0.008127210090583738
Bond Position:  [8.83131682]


portfolio before change:  [9.63385739]
curr_Stock_Price:  98.61152619456219
curr_Factors:  [9.86115262e+01 4.18252141e-02]
mat_Sqrt:  [[ 2.01672539e+01  0.00000000e+00]
 [-8.18048547e-03  1.87438470e-02]]
grads:  [ -0.0198743  -18.38325304]
Stock Position:  -0.019874296679006954
Bond Position:  [11.59369212]


portfolio before change:  [9.64015174]
curr_Stock_Price:  98.36774175500727
curr_Factors:  [9.83677418e+01 4.16471474e-02]
mat_Sqrt:  [[ 2.00745275e+01  0.00000000e+00]
 [-8.16305309e-03  1.87039044e-02]]
grads:  [9.25484632e-03 1.22822393e+01]
Stock Position:  0.009254846324341683
Bond Position:  [8.72977341]


portfolio before change:  [9.63364807]
curr_Stock_Price:  97.5470949587791
curr_Factors:  [9.75470950e+01 4.03517424e-02]
mat_Sqrt:  [[ 1.95950099e+01  0.00000000e+00]
 [-8.03509725e-03  1.84107207e-02]]
grads:  [0.0027327  0.50367009]
Stock Position:  0.002732700470063225
Bond Position:  [9.36708108]


portfolio before change:  [9.6336604]
curr_Stock_Price:  97.12310834641114
curr_Factors:  [9.71231083e+01 4.11401732e-02]
mat_Sqrt:  [[ 1.96995194e+01  0.00000000e+00]
 [-8.11321620e-03  1.85897137e-02]]
grads:  [ 4.45181052e-04 -1.68960796e+00]
Stock Position:  0.0004451810515716115
Bond Position:  [9.59042303]


portfolio before change:  [9.63510675]
curr_Stock_Price:  97.6790074030346
curr_Factors:  [9.76790074e+01 4.03782159e-02]
mat_Sqrt:  [[ 1.96279436e+01  0.00000000e+00]
 [-8.03773261e-03  1.84167590e-02]]
grads:  [2.50482482e-03 2.95762449e+00]
Stock Position:  0.002504824821556988
Bond Position:  [9.39043795]


portfolio before change:  [9.64318612]
curr_Stock_Price:  100.43588354786161
curr_Factors:  [1.00435884e+02 3.81215672e-02]
mat_Sqrt:  [[ 1.96098503e+01  0.00000000e+00]
 [-7.80989805e-03  1.78947245e-02]]
grads:  [2.13511354e-03 3.43024981e+00]
Stock Position:  0.0021351135435416324
Bond Position:  [9.42874411]


portfolio before change:  [9.64526998]
curr_Stock_Price:  100.85983597868228
curr_Factors:  [1.00859836e+02 3.74937283e-02]
mat_Sqrt:  [[ 1.95297899e+01  0.00000000e+00]
 [-7.74531892e-03  1.77467551e-02]]
grads:  [-0.00396835 -3.87770126]
Stock Position:  -0.003968347829221446
Bond Position:  [10.04551689]


portfolio before change:  [9.64531036]
curr_Stock_Price:  101.1661059106857
curr_Factors:  [1.01166106e+02 3.66607591e-02]
mat_Sqrt:  [[ 1.93702738e+01  0.00000000e+00]
 [-7.65879982e-03  1.75485149e-02]]
grads:  [0.01035913 4.27280535]
Stock Position:  0.010359133354841073
Bond Position:  [8.59731718]


portfolio before change:  [9.63654188]
curr_Stock_Price:  100.21590991540424
curr_Factors:  [1.00215910e+02 3.78091814e-02]
mat_Sqrt:  [[ 1.94865659e+01  0.00000000e+00]
 [-7.77783326e-03  1.78212548e-02]]
grads:  [1.01970010e-02 1.75263471e+01]
Stock Position:  0.010197001044853826
Bond Position:  [8.61464015]


portfolio before change:  [9.63979442]
curr_Stock_Price:  100.429270817658
curr_Factors:  [1.00429271e+02 3.68453716e-02]
mat_Sqrt:  [[ 1.92775474e+01  0.00000000e+00]
 [-7.67805930e-03  1.75926440e-02]]
grads:  [1.05690205e-02 2.16241004e+01]
Stock Position:  0.010569020549950042
Bond Position:  [8.5783554]


portfolio before change:  [9.636178]
curr_Stock_Price:  99.98563617176286
curr_Factors:  [9.99856362e+01 3.71637975e-02]
mat_Sqrt:  [[ 1.92751451e+01  0.00000000e+00]
 [-7.71116567e-03  1.76685002e-02]]
grads:  [1.96575406e-03 8.20516121e+00]
Stock Position:  0.0019657540550019614
Bond Position:  [9.43963083]


portfolio before change:  [9.64029204]
curr_Stock_Price:  101.47819918615795
curr_Factors:  [1.01478199e+02 3.55256288e-02]
mat_Sqrt:  [[ 1.91268582e+01  0.00000000e+00]
 [-7.53929745e-03  1.72747006e-02]]
grads:  [3.04918159e-03 3.85572290e+00]
Stock Position:  0.003049181586915884
Bond Position:  [9.33086658]


portfolio before change:  [9.63846888]
curr_Stock_Price:  100.49774253446405
curr_Factors:  [1.00497743e+02 3.69796154e-02]
mat_Sqrt:  [[ 1.93258009e+01  0.00000000e+00]
 [-7.69203385e-03  1.76246637e-02]]
grads:  [  0.02839172 -11.15814867]
Stock Position:  0.028391717203095832
Bond Position:  [6.7851654]


portfolio before change:  [9.66778448]
curr_Stock_Price:  101.50040814403123
curr_Factors:  [1.01500408e+02 3.60978400e-02]
mat_Sqrt:  [[ 1.92845006e+01  0.00000000e+00]
 [-7.59977263e-03  1.74132667e-02]]
grads:  [-1.30223968e-03  6.85914303e+00]
Stock Position:  -0.0013022396775747168
Bond Position:  [9.79996234]


portfolio before change:  [9.6704209]
curr_Stock_Price:  100.41662312681387
curr_Factors:  [1.00416623e+02 3.62702823e-02]
mat_Sqrt:  [[ 1.91241033e+01  0.00000000e+00]
 [-7.61790336e-03  1.74548094e-02]]
grads:  [-2.87469403e-03  5.61817285e+00]
Stock Position:  -0.0028746940316229604
Bond Position:  [9.95908797]


portfolio before change:  [9.66934087]
curr_Stock_Price:  101.22540228418403
curr_Factors:  [1.01225402e+02 3.47484366e-02]
mat_Sqrt:  [[ 1.88693590e+01  0.00000000e+00]
 [-7.45637302e-03  1.70846969e-02]]
grads:  [-4.37766655e-04 -9.51517762e+00]
Stock Position:  -0.0004377666545620774
Bond Position:  [9.71365398]


portfolio before change:  [9.67066606]
curr_Stock_Price:  100.97205382144168
curr_Factors:  [1.00972054e+02 3.30064372e-02]
mat_Sqrt:  [[ 1.83442734e+01  0.00000000e+00]
 [-7.26706953e-03  1.66509481e-02]]
grads:  [-0.00254443 -2.36862165]
Stock Position:  -0.0025444327249961015
Bond Position:  [9.92758266]


portfolio before change:  [9.67579917]
curr_Stock_Price:  99.44240518361539
curr_Factors:  [9.94424052e+01 3.23458636e-02]
mat_Sqrt:  [[ 1.78846726e+01  0.00000000e+00]
 [-7.19398233e-03  1.64834843e-02]]
grads:  [-0.04222575 -5.48565958]
Stock Position:  -0.04222574966378454
Bond Position:  [13.87482928]


portfolio before change:  [9.68823658]
curr_Stock_Price:  99.1889355859325
curr_Factors:  [9.91889356e+01 3.23047713e-02]
mat_Sqrt:  [[ 1.78277512e+01  0.00000000e+00]
 [-7.18941124e-03  1.64730106e-02]]
grads:  [-0.00644774  0.44147954]
Stock Position:  -0.00644774004669414
Bond Position:  [10.32778105]


portfolio before change:  [9.68119521]
curr_Stock_Price:  100.48123709228759
curr_Factors:  [1.00481237e+02 3.12253055e-02]
mat_Sqrt:  [[ 1.77557214e+01  0.00000000e+00]
 [-7.06827339e-03  1.61954489e-02]]
grads:  [0.00547358 1.71441847]
Stock Position:  0.005473582361403374
Bond Position:  [9.13120288]


portfolio before change:  [9.6847575]
curr_Stock_Price:  100.92350973951537
curr_Factors:  [1.0092351e+02 3.1673578e-02]
mat_Sqrt:  [[ 1.79614299e+01  0.00000000e+00]
 [-7.11882890e-03  1.63112861e-02]]
grads:  [0.00930611 4.5949481 ]
Stock Position:  0.009306112599127716
Bond Position:  [8.74555195]


portfolio before change:  [9.68921456]
curr_Stock_Price:  101.28497103820052
curr_Factors:  [1.01284971e+02 3.02493649e-02]
mat_Sqrt:  [[ 1.76158311e+01  0.00000000e+00]
 [-6.95693782e-03  1.59403471e-02]]
grads:  [ -0.02092902 -11.3136094 ]
Stock Position:  -0.02092901999825056
Bond Position:  [11.80900974]


portfolio before change:  [9.67758956]
curr_Stock_Price:  101.91095413046689
curr_Factors:  [1.01910954e+02 3.07635636e-02]
mat_Sqrt:  [[ 1.78747176e+01  0.00000000e+00]
 [-7.01581797e-03  1.60752584e-02]]
grads:  [-1.43488183e-02 -2.54797273e+01]
Stock Position:  -0.014348818341216664
Bond Position:  [11.13989133]


portfolio before change:  [9.67356771]
curr_Stock_Price:  102.28829750765978
curr_Factors:  [1.02288298e+02 2.97026322e-02]
mat_Sqrt:  [[ 1.76288271e+01  0.00000000e+00]
 [-6.89378064e-03  1.57956358e-02]]
grads:  [-1.34215354e-03  1.53987401e+01]
Stock Position:  -0.0013421535410705332
Bond Position:  [9.81085431]


portfolio before change:  [9.67535574]
curr_Stock_Price:  101.86986091099011
curr_Factors:  [1.01869861e+02 2.95768898e-02]
mat_Sqrt:  [[ 1.75195104e+01  0.00000000e+00]
 [-6.87917318e-03  1.57621659e-02]]
grads:  [-4.05329549e-03  7.50608140e+00]
Stock Position:  -0.004053295489369445
Bond Position:  [10.08826439]


portfolio before change:  [9.68108527]
curr_Stock_Price:  100.76744632668144
curr_Factors:  [1.00767446e+02 3.03816335e-02]
mat_Sqrt:  [[ 1.75640964e+01  0.00000000e+00]
 [-6.97213121e-03  1.59751595e-02]]
grads:  [0.01650461 4.56257358]
Stock Position:  0.016504613563740785
Bond Position:  [8.01795751]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.67653142]
Stock Price:  100.43080396664571
PL:  [9.24572746]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.98320967e-01  7.58026643e-01]
 [-1.74722188e-01 -7.29789244e-02]
 [ 8.34526008e-01 -6.94088466e-01]
 [ 2.16096236e-02  2.71174706e-02]
 [-1.38037304e-01  5.86038251e-02]
 [-5.07402827e-02 -4.63520964e-02]
 [-1.34432913e-02  2.69953772e-01]
 [ 1.40298295e-02 -5.91631898e-02]
 [ 1.63362395e-01  8.09067384e-02]
 [ 1.07429214e-01  7.89744195e-02]
 [ 1.49797827e-01  3.04535383e-01]
 [ 1.88314353e-01  2.45691500e-01]
 [ 2.11697216e-01  2.38098245e-02]
 [-1.63013938e-01 -1.81173783e-01]
 [ 8.70309240e-02  2.30916907e-01]
 [ 5.20718976e-02 -1.91757761e-02]
 [-2.85778215e-02  3.52488033e-02]
 [-1.61359663e-01 -2.08683800e-04]
 [ 1.50159656e-02  6.29573593e-02]
 [-7.12591498e-02 -4.62461334e-02]
 [ 1.66754339e-01  7.37638857e-02]
 [ 9.32947383e-03  1.01094621e-01]
 [ 2.89326351e-02  3.16262919e-01]
 [ 5.86034282e-02  1.77111039e-01]
 [ 4.58869960e-02  1.00211279e-01]
 [ 7.37170315e-01 -4.12518438e-01]
 [-2.05894288e-01  2.75273354e-01]
 [ 9.59873105e-02  1.44826166e-02]
 [-1.48628668e-02 -9.25958357e-02]
 [-5.16182942e-02 -9.57784901e-02]
 [ 3.65587114e-03 -7.08102774e-02]
 [ 6.87458605e-03 -6.63764897e-03]
 [ 2.40777771e-01  2.88350535e-01]
 [ 2.05109782e-01  3.86930219e-02]
 [-2.08960216e-01 -2.33398954e-01]
 [ 1.67412353e-01 -1.23590828e-01]
 [-1.89094424e-01  1.93498374e-01]
 [-1.19572533e-01  1.20386460e-01]
 [-1.20322119e-01  1.30224548e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.33345925]
curr_Stock_Price:  101.2991646063863
curr_Factors:  [1.01299165e+02 3.93565907e-02]
mat_Sqrt:  [[ 2.00962303e+01  0.00000000e+00]
 [-7.93539823e-03  1.81822815e-02]]
grads:  [3.62829698e-02 4.16904029e+01]
Stock Position:  0.03628296979393261
Bond Position:  [7.65802472]


portfolio before change:  [11.31446263]
curr_Stock_Price:  100.7492116077631
curr_Factors:  [1.00749212e+02 3.93365492e-02]
mat_Sqrt:  [[ 1.99820382e+01  0.00000000e+00]
 [-7.93337751e-03  1.81776515e-02]]
grads:  [-0.01033792 -4.0147609 ]
Stock Position:  -0.010337924474689222
Bond Position:  [12.35600037]


portfolio before change:  [11.30222992]
curr_Stock_Price:  102.08190773804407
curr_Factors:  [1.02081908e+02 3.79480708e-02]
mat_Sqrt:  [[ 1.98858257e+01  0.00000000e+00]
 [-7.79210583e-03  1.78539574e-02]]
grads:  [ 2.67326574e-02 -3.88758890e+01]
Stock Position:  0.026732657447717894
Bond Position:  [8.57330925]


portfolio before change:  [11.30741617]
curr_Stock_Price:  102.23582148523761
curr_Factors:  [1.02235821e+02 3.69198036e-02]
mat_Sqrt:  [[ 1.96441292e+01  0.00000000e+00]
 [-7.68581068e-03  1.76104046e-02]]
grads:  [0.00170253 1.53985506]
Stock Position:  0.0017025268800638668
Bond Position:  [11.13335694]


portfolio before change:  [11.30861377]
curr_Stock_Price:  102.12177761875903
curr_Factors:  [1.02121778e+02 3.74222347e-02]
mat_Sqrt:  [[ 1.97552816e+01  0.00000000e+00]
 [-7.73793096e-03  1.77298272e-02]]
grads:  [-0.00569268  3.30538051]
Stock Position:  -0.005692680044166595
Bond Position:  [11.88996037]


portfolio before change:  [11.31607653]
curr_Stock_Price:  101.0719334269172
curr_Factors:  [1.01071933e+02 3.80122254e-02]
mat_Sqrt:  [[ 1.97057161e+01  0.00000000e+00]
 [-7.79868967e-03  1.78690429e-02]]
grads:  [-0.00360149 -2.59398876]
Stock Position:  -0.0036014928723534703
Bond Position:  [11.68008638]


portfolio before change:  [11.32184535]
curr_Stock_Price:  99.87556243720879
curr_Factors:  [9.98755624e+01 3.65458518e-02]
mat_Sqrt:  [[ 1.90931807e+01  0.00000000e+00]
 [-7.64678774e-03  1.75209918e-02]]
grads:  [5.46656922e-03 1.54074481e+01]
Stock Position:  0.005466569223112044
Bond Position:  [10.77586868]


portfolio before change:  [11.32092054]
curr_Stock_Price:  99.45996709547602
curr_Factors:  [9.94599671e+01 3.69252761e-02]
mat_Sqrt:  [[ 1.91121782e+01  0.00000000e+00]
 [-7.68638028e-03  1.76117097e-02]]
grads:  [-6.16941893e-04 -3.35930984e+00]
Stock Position:  -0.0006169418930887581
Bond Position:  [11.38228156]


portfolio before change:  [11.32265369]
curr_Stock_Price:  98.95704735611369
curr_Factors:  [9.89570474e+01 3.74042080e-02]
mat_Sqrt:  [[ 1.91384587e+01  0.00000000e+00]
 [-7.73606701e-03  1.77255563e-02]]
grads:  [0.01038082 4.5644118 ]
Stock Position:  0.010380824966947413
Bond Position:  [10.2953979]


portfolio before change:  [11.31023093]
curr_Stock_Price:  97.63636598049116
curr_Factors:  [9.76363660e+01 3.79208947e-02]
mat_Sqrt:  [[ 1.90130108e+01  0.00000000e+00]
 [-7.78931521e-03  1.78475633e-02]]
grads:  [0.00746313 4.42494128]
Stock Position:  0.00746312504672911
Bond Position:  [10.58155852]


portfolio before change:  [11.30778391]
curr_Stock_Price:  97.1312428281837
curr_Factors:  [9.71312428e+01 3.74209200e-02]
mat_Sqrt:  [[ 1.87895412e+01  0.00000000e+00]
 [-7.73779503e-03  1.77295157e-02]]
grads:  [1.50460281e-02 1.71767457e+01]
Stock Position:  0.01504602808283684
Bond Position:  [9.8463445]


portfolio before change:  [11.30775671]
curr_Stock_Price:  97.04762829034402
curr_Factors:  [9.70476283e+01 3.69804690e-02]
mat_Sqrt:  [[ 1.86625564e+01  0.00000000e+00]
 [-7.69212262e-03  1.76248671e-02]]
grads:  [ 0.01583614 13.9400484 ]
Stock Position:  0.01583614314953209
Bond Position:  [9.77089658]


portfolio before change:  [11.30472012]
curr_Stock_Price:  96.77874731485197
curr_Factors:  [9.67787473e+01 3.70513399e-02]
mat_Sqrt:  [[ 1.86286746e+01  0.00000000e+00]
 [-7.69948984e-03  1.76417475e-02]]
grads:  [0.01192187 1.34962959]
Stock Position:  0.011921872103759439
Bond Position:  [10.15093627]


portfolio before change:  [11.30841277]
curr_Stock_Price:  96.98204625609957
curr_Factors:  [9.69820463e+01 3.74079286e-02]
mat_Sqrt:  [[ 1.87574231e+01  0.00000000e+00]
 [-7.73645176e-03  1.77264379e-02]]
grads:  [ -0.01290607 -10.22054089]
Stock Position:  -0.012906072360696054
Bond Position:  [12.56007007]


portfolio before change:  [11.29725255]
curr_Stock_Price:  97.96842867323625
curr_Factors:  [9.79684287e+01 3.81385695e-02]
mat_Sqrt:  [[ 1.91323511e+01  0.00000000e+00]
 [-7.81163947e-03  1.78987146e-02]]
grads:  [9.81642681e-03 1.29013123e+01]
Stock Position:  0.009816426812205637
Bond Position:  [10.33555264]


portfolio before change:  [11.30450667]
curr_Stock_Price:  98.57578767042641
curr_Factors:  [9.85757877e+01 3.71651909e-02]
mat_Sqrt:  [[ 1.90037120e+01  0.00000000e+00]
 [-7.71131023e-03  1.76688314e-02]]
grads:  [ 0.0022997  -1.08528831]
Stock Position:  0.002299703488015565
Bond Position:  [11.07781159]


portfolio before change:  [11.30570185]
curr_Stock_Price:  98.493326139149
curr_Factors:  [9.84933261e+01 3.88885939e-02]
mat_Sqrt:  [[ 1.94230722e+01  0.00000000e+00]
 [-7.88807646e-03  1.80738537e-02]]
grads:  [-6.79294315e-04  1.95026494e+00]
Stock Position:  -0.0006792943146094546
Bond Position:  [11.3726078]


portfolio before change:  [11.30566286]
curr_Stock_Price:  100.64356724275683
curr_Factors:  [1.00643567e+02 3.74841975e-02]
mat_Sqrt:  [[ 1.94854361e+01  0.00000000e+00]
 [-7.74433444e-03  1.77444994e-02]]
grads:  [-0.00828571 -0.01176048]
Stock Position:  -0.008285713451621827
Bond Position:  [12.13956662]


portfolio before change:  [11.3033447]
curr_Stock_Price:  101.10649656724627
curr_Factors:  [1.01106497e+02 3.62529378e-02]
mat_Sqrt:  [[ 1.92508835e+01  0.00000000e+00]
 [-7.61608171e-03  1.74506355e-02]]
grads:  [2.20731739e-03 3.60774022e+00]
Stock Position:  0.002207317390041962
Bond Position:  [11.08017058]


portfolio before change:  [11.30575896]
curr_Stock_Price:  101.57273788513183
curr_Factors:  [1.01572738e+02 3.75034400e-02]
mat_Sqrt:  [[ 1.96703783e+01  0.00000000e+00]
 [-7.74632196e-03  1.77490534e-02]]
grads:  [-0.00464875 -2.60555492]
Stock Position:  -0.004648747261980089
Bond Position:  [11.77794494]


portfolio before change:  [11.30922949]
curr_Stock_Price:  101.14290264937793
curr_Factors:  [1.01142903e+02 3.55753583e-02]
mat_Sqrt:  [[ 1.90769989e+01  0.00000000e+00]
 [-7.54457244e-03  1.72867871e-02]]
grads:  [0.01042866 4.26706739]
Stock Position:  0.010428660168113611
Bond Position:  [10.25444453]


portfolio before change:  [11.32184962]
curr_Stock_Price:  102.23012270674906
curr_Factors:  [1.02230123e+02 3.54907553e-02]
mat_Sqrt:  [[ 1.92591228e+01  0.00000000e+00]
 [-7.53559609e-03  1.72662198e-02]]
grads:  [2.77534882e-03 5.85505240e+00]
Stock Position:  0.002775348820021894
Bond Position:  [11.03812537]


portfolio before change:  [11.32262603]
curr_Stock_Price:  102.01269320895643
curr_Factors:  [1.02012693e+02 3.57755166e-02]
mat_Sqrt:  [[ 1.92951061e+01  0.00000000e+00]
 [-7.56576675e-03  1.73353494e-02]]
grads:  [8.65302778e-03 1.82438156e+01]
Stock Position:  0.008653027778724872
Bond Position:  [10.43990736]


portfolio before change:  [11.33435747]
curr_Stock_Price:  103.2176326269198
curr_Factors:  [1.03217633e+02 3.57300858e-02]
mat_Sqrt:  [[ 1.95106134e+01  0.00000000e+00]
 [-7.56096140e-03  1.73243390e-02]]
grads:  [6.96549205e-03 1.02232494e+01]
Stock Position:  0.006965492048900611
Bond Position:  [10.61539587]


portfolio before change:  [11.33676135]
curr_Stock_Price:  103.37223352842902
curr_Factors:  [1.03372234e+02 3.46444266e-02]
mat_Sqrt:  [[ 1.92406876e+01  0.00000000e+00]
 [-7.44520534e-03  1.70591085e-02]]
grads:  [4.65798236e-03 5.87435613e+00]
Stock Position:  0.00465798236443354
Bond Position:  [10.85525531]


portfolio before change:  [11.33684957]
curr_Stock_Price:  103.09984753158749
curr_Factors:  [1.03099848e+02 3.42519021e-02]
mat_Sqrt:  [[ 1.90809665e+01  0.00000000e+00]
 [-7.40290776e-03  1.69621926e-02]]
grads:  [  0.02919834 -24.31987707]
Stock Position:  0.029198337918182236
Bond Position:  [8.32650539]


portfolio before change:  [11.32785962]
curr_Stock_Price:  102.75630636714642
curr_Factors:  [1.02756306e+02 3.46107651e-02]
mat_Sqrt:  [[ 1.91167511e+01  0.00000000e+00]
 [-7.44158747e-03  1.70508189e-02]]
grads:  [-4.48586405e-03  1.61442893e+01]
Stock Position:  -0.004485864051849834
Bond Position:  [11.78881044]


portfolio before change:  [11.32986181]
curr_Stock_Price:  102.63849249376746
curr_Factors:  [1.02638492e+02 3.41580798e-02]
mat_Sqrt:  [[ 1.89695483e+01  0.00000000e+00]
 [-7.39276185e-03  1.69389454e-02]]
grads:  [0.00539328 0.85498927]
Stock Position:  0.005393277743044688
Bond Position:  [10.77630392]


portfolio before change:  [11.33285755]
curr_Stock_Price:  102.94417167514547
curr_Factors:  [1.02944172e+02 3.49074063e-02]
mat_Sqrt:  [[ 1.92335989e+01  0.00000000e+00]
 [-7.47340954e-03  1.71237324e-02]]
grads:  [-2.87387727e-03 -5.40745635e+00]
Stock Position:  -0.0028738772713551245
Bond Position:  [11.62870646]


portfolio before change:  [11.33298703]
curr_Stock_Price:  103.40494101951644
curr_Factors:  [1.03404941e+02 3.53548470e-02]
mat_Sqrt:  [[ 1.94431118e+01  0.00000000e+00]
 [-7.52115385e-03  1.72331284e-02]]
grads:  [-4.80475838e-03 -5.55781212e+00]
Stock Position:  -0.004804758383264189
Bond Position:  [11.82982279]


portfolio before change:  [11.32502848]
curr_Stock_Price:  105.36911370185244
curr_Factors:  [1.05369114e+02 3.63357389e-02]
mat_Sqrt:  [[ 2.00853926e+01  0.00000000e+00]
 [-7.62477424e-03  1.74705526e-02]]
grads:  [-1.35662111e-03 -4.05312180e+00]
Stock Position:  -0.0013566211065249977
Bond Position:  [11.46797444]


portfolio before change:  [11.32702653]
curr_Stock_Price:  104.95303455312414
curr_Factors:  [1.04953035e+02 3.58020840e-02]
mat_Sqrt:  [[ 1.98586240e+01  0.00000000e+00]
 [-7.56857546e-03  1.73417850e-02]]
grads:  [ 2.00299806e-04 -3.82754658e-01]
Stock Position:  0.000200299806231606
Bond Position:  [11.30600445]


portfolio before change:  [11.32872818]
curr_Stock_Price:  106.39247400687323
curr_Factors:  [1.06392474e+02 3.40798301e-02]
mat_Sqrt:  [[ 1.96408201e+01  0.00000000e+00]
 [-7.38428927e-03  1.69195323e-02]]
grads:  [ 0.01866644 17.04246489]
Stock Position:  0.018666443627169092
Bond Position:  [9.34275906]


portfolio before change:  [11.29674689]
curr_Stock_Price:  104.6166021804731
curr_Factors:  [1.04616602e+02 3.39692990e-02]
mat_Sqrt:  [[ 1.92816370e+01  0.00000000e+00]
 [-7.37230482e-03  1.68920725e-02]]
grads:  [0.01151338 2.29060241]
Stock Position:  0.01151337930939536
Bond Position:  [10.09225627]


portfolio before change:  [11.30408759]
curr_Stock_Price:  105.14460400059798
curr_Factors:  [1.05144604e+02 3.42959252e-02]
mat_Sqrt:  [[ 1.94718964e+01  0.00000000e+00]
 [-7.40766362e-03  1.69730896e-02]]
grads:  [ -0.01596269 -13.75111776]
Stock Position:  -0.01596269123615731
Bond Position:  [12.98247843]


portfolio before change:  [11.28979428]
curr_Stock_Price:  106.14169281116754
curr_Factors:  [1.06141693e+02 3.35796975e-02]
mat_Sqrt:  [[ 1.94502147e+01  0.00000000e+00]
 [-7.32990560e-03  1.67949236e-02]]
grads:  [ 5.83401754e-03 -7.35882049e+00]
Stock Position:  0.005834017535815674
Bond Position:  [10.67056178]


portfolio before change:  [11.29093612]
curr_Stock_Price:  106.10877227347768
curr_Factors:  [1.06108772e+02 3.27924220e-02]
mat_Sqrt:  [[ 1.92148959e+01  0.00000000e+00]
 [-7.24347121e-03  1.65968776e-02]]
grads:  [-5.44602532e-03  1.16587215e+01]
Stock Position:  -0.005446025321337177
Bond Position:  [11.86880718]


portfolio before change:  [11.30155356]
curr_Stock_Price:  104.43163181000753
curr_Factors:  [1.04431632e+02 3.30188862e-02]
mat_Sqrt:  [[ 1.89763759e+01  0.00000000e+00]
 [-7.26843986e-03  1.66540879e-02]]
grads:  [-3.53236965e-03  7.22864321e+00]
Stock Position:  -0.00353236964641526
Bond Position:  [11.67044469]


portfolio before change:  [11.30198895]
curr_Stock_Price:  104.7213831283713
curr_Factors:  [1.04721383e+02 3.35462853e-02]
mat_Sqrt:  [[ 1.91803968e+01  0.00000000e+00]
 [-7.32625801e-03  1.67865660e-02]]
grads:  [-3.31001844e-03  7.75766457e+00]
Stock Position:  -0.003310018438578715
Bond Position:  [11.64861866]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.29530222]
Stock Price:  107.18146136005943
PL:  [4.11384086]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 3.37378689e-01  6.77899108e-01]
 [-1.79457845e-01 -7.29946049e-02]
 [ 7.50814655e-01 -6.36416349e-01]
 [ 2.26780569e-02  2.30253410e-02]
 [-7.61212179e-02  3.38243971e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-5.08580143e-03  3.18765296e-01]
 [ 3.18699190e-01 -5.45440637e-03]
 [ 1.19990599e-01  8.47739573e-02]
 [ 4.41725611e-01 -2.78859068e-01]
 [ 6.22946675e-02 -5.44852943e-03]
 [-1.02998394e-01 -1.82476516e-01]
 [-1.71668265e-01  1.54590785e-01]
 [-7.15681540e-01 -1.00096981e+00]
 [-9.88555580e-02 -5.59312559e-01]
 [-7.03429091e-02 -2.43558933e-01]
 [-4.99893035e-02  1.03068713e-01]
 [ 1.31698256e-01  1.57158665e-01]
 [ 1.76657744e-02 -2.83779419e-03]
 [-1.13676482e-01 -2.50400795e-02]
 [ 2.03197434e-01  4.84350926e-01]
 [ 1.08138634e-02  1.47974535e-01]
 [-1.27928455e-02 -2.42307623e-01]
 [ 1.29063739e-01  2.01646624e-01]
 [ 7.51499560e-02  1.57319269e-01]
 [ 7.44079290e-01 -4.43942436e-01]
 [-3.68898896e-01  4.72674430e-01]
 [ 1.50576355e-01 -9.04458185e-03]
 [-4.98213390e-02 -5.99397830e-02]
 [ 4.93398201e-02 -2.29879454e-01]
 [-6.44169796e-02 -7.45886358e-02]
 [-1.05710606e-01 -7.47537466e-04]
 [ 1.60194923e-01  1.54066192e-01]
 [ 1.85529184e-01  4.87387325e-02]
 [-2.67046729e-01 -1.75661798e-01]
 [-6.21211882e-02 -4.02575231e-01]
 [-9.40875677e-02  2.75126908e-01]
 [-1.22521425e-01  1.18397076e-01]
 [-4.69091706e-02  1.11576811e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.72694186]
curr_Stock_Price:  101.05719708494014
curr_Factors:  [1.01057197e+02 3.88007596e-02]
mat_Sqrt:  [[ 1.99061541e+01  0.00000000e+00]
 [-7.87916337e-03  1.80534313e-02]]
grads:  [3.18111731e-02 3.75495992e+01]
Stock Position:  0.03181117313515182
Bond Position:  [6.51219386]


portfolio before change:  [9.7299717]
curr_Stock_Price:  101.12685093179536
curr_Factors:  [1.01126851e+02 3.81942897e-02]
mat_Sqrt:  [[ 1.97635839e+01  0.00000000e+00]
 [-7.81734377e-03  1.79117848e-02]]
grads:  [-0.01069215 -4.07522789]
Stock Position:  -0.010692154997331376
Bond Position:  [10.81123567]


portfolio before change:  [9.72956186]
curr_Stock_Price:  101.29158194374052
curr_Factors:  [1.01291582e+02 3.74787384e-02]
mat_Sqrt:  [[ 1.96094691e+01  0.00000000e+00]
 [-7.74377049e-03  1.77432072e-02]]
grads:  [ 2.41240488e-02 -3.58681687e+01]
Stock Position:  0.024124048799789966
Bond Position:  [7.2859988]


portfolio before change:  [9.72316202]
curr_Stock_Price:  100.9885379119801
curr_Factors:  [1.00988538e+02 3.75777343e-02]
mat_Sqrt:  [[ 1.95766051e+01  0.00000000e+00]
 [-7.75399090e-03  1.77666251e-02]]
grads:  [0.00167175 1.29598845]
Stock Position:  0.0016717474465552842
Bond Position:  [9.55433469]


portfolio before change:  [9.72389155]
curr_Stock_Price:  100.7104839522993
curr_Factors:  [1.00710484e+02 3.64510629e-02]
mat_Sqrt:  [[ 1.92278082e+01  0.00000000e+00]
 [-7.63686458e-03  1.74982550e-02]]
grads:  [-0.00319116  1.93301544]
Stock Position:  -0.003191161476784744
Bond Position:  [10.04527497]


portfolio before change:  [9.72709784]
curr_Stock_Price:  100.09924640379066
curr_Factors:  [1.00099246e+02 3.74147684e-02]
mat_Sqrt:  [[ 1.93620946e+01  0.00000000e+00]
 [-7.73715901e-03  1.77280584e-02]]
grads:  [-0.00611611 -3.74078912]
Stock Position:  -0.006116113665175115
Bond Position:  [10.33931621]


portfolio before change:  [9.72561513]
curr_Stock_Price:  100.55300023033774
curr_Factors:  [1.00553000e+02 3.60760983e-02]
mat_Sqrt:  [[ 1.90987443e+01  0.00000000e+00]
 [-7.59748362e-03  1.74080219e-02]]
grads:  [7.01798909e-03 1.83114025e+01]
Stock Position:  0.007017989094768106
Bond Position:  [9.01993527]


portfolio before change:  [9.74101452]
curr_Stock_Price:  102.58660687235287
curr_Factors:  [1.02586607e+02 3.56735584e-02]
mat_Sqrt:  [[ 1.93759891e+01  0.00000000e+00]
 [-7.55497806e-03  1.73106294e-02]]
grads:  [ 0.01632529 -0.31509001]
Stock Position:  0.016325292610830523
Bond Position:  [8.06625815]


portfolio before change:  [9.72592635]
curr_Stock_Price:  101.60062048677196
curr_Factors:  [1.01600620e+02 3.58752589e-02]
mat_Sqrt:  [[ 1.92439351e+01  0.00000000e+00]
 [-7.57630611e-03  1.73594981e-02]]
grads:  [0.00815784 4.88343365]
Stock Position:  0.008157842315124737
Bond Position:  [8.89708451]


portfolio before change:  [9.73886664]
curr_Stock_Price:  103.05052410420281
curr_Factors:  [1.03050524e+02 3.62508839e-02]
mat_Sqrt:  [[ 1.96204745e+01  0.00000000e+00]
 [-7.61586596e-03  1.74501411e-02]]
grads:  [  0.01631059 -15.98033311]
Stock Position:  0.016310591076396697
Bond Position:  [8.05805168]


portfolio before change:  [9.73694415]
curr_Stock_Price:  102.8708978645162
curr_Factors:  [1.02870898e+02 3.69793025e-02]
mat_Sqrt:  [[ 1.97820770e+01  0.00000000e+00]
 [-7.69200130e-03  1.76245891e-02]]
grads:  [ 0.00302884 -0.30914363]
Stock Position:  0.0030288394047943493
Bond Position:  [9.42536472]


portfolio before change:  [9.7381721]
curr_Stock_Price:  102.88730701847277
curr_Factors:  [1.02887307e+02 3.56639553e-02]
mat_Sqrt:  [[ 1.94301679e+01  0.00000000e+00]
 [-7.55396111e-03  1.73082993e-02]]
grads:  [-9.39969619e-03 -1.05427179e+01]
Stock Position:  -0.009399696186608998
Bond Position:  [10.70528152]


portfolio before change:  [9.73264398]
curr_Stock_Price:  103.61779458033874
curr_Factors:  [1.03617795e+02 3.66750346e-02]
mat_Sqrt:  [[ 1.98435610e+01  0.00000000e+00]
 [-7.66029081e-03  1.75519312e-02]]
grads:  [-5.25103915e-03  8.80762251e+00]
Stock Position:  -0.005251039145852541
Bond Position:  [10.27674507]


portfolio before change:  [9.72938929]
curr_Stock_Price:  104.48226433698353
curr_Factors:  [1.04482264e+02 3.58033946e-02]
mat_Sqrt:  [[ 1.97699094e+01  0.00000000e+00]
 [-7.56871399e-03  1.73421024e-02]]
grads:  [ -0.05829772 -57.71905788]
Stock Position:  -0.05829771688783044
Bond Position:  [15.82046675]


portfolio before change:  [9.63784295]
curr_Stock_Price:  106.08651267918555
curr_Factors:  [1.06086513e+02 3.42101125e-02]
mat_Sqrt:  [[ 1.96217358e+01  0.00000000e+00]
 [-7.39839036e-03  1.69518419e-02]]
grads:  [-1.74785541e-02 -3.29942057e+01]
Stock Position:  -0.017478554102519625
Bond Position:  [11.4920818]


portfolio before change:  [9.61946327]
curr_Stock_Price:  107.22026098801966
curr_Factors:  [1.07220261e+02 3.36291638e-02]
mat_Sqrt:  [[ 1.96623261e+01  0.00000000e+00]
 [-7.33530245e-03  1.68072894e-02]]
grads:  [-8.98371542e-03 -1.44912679e+01]
Stock Position:  -0.008983715422969945
Bond Position:  [10.58269958]


portfolio before change:  [9.62093124]
curr_Stock_Price:  107.2041156326352
curr_Factors:  [1.07204116e+02 3.29196148e-02]
mat_Sqrt:  [[ 1.94508610e+01  0.00000000e+00]
 [-7.25750533e-03  1.66290338e-02]]
grads:  [-2.57388567e-04  6.19811798e+00]
Stock Position:  -0.0002573885668933078
Bond Position:  [9.64852435]


portfolio before change:  [9.62225279]
curr_Stock_Price:  106.75573094521982
curr_Factors:  [1.06755731e+02 3.18038129e-02]
mat_Sqrt:  [[ 1.90384152e+01  0.00000000e+00]
 [-7.13344942e-03  1.63447860e-02]]
grads:  [0.0105202  9.61521706]
Stock Position:  0.010520199226755731
Bond Position:  [8.49916123]


portfolio before change:  [9.62844739]
curr_Stock_Price:  107.2435681089698
curr_Factors:  [1.07243568e+02 3.24045367e-02]
mat_Sqrt:  [[ 1.93051937e+01  0.00000000e+00]
 [-7.20050406e-03  1.64984274e-02]]
grads:  [ 0.00085092 -0.17200392]
Stock Position:  0.0008509243567730669
Bond Position:  [9.53719123]


portfolio before change:  [9.6292848]
curr_Stock_Price:  106.82659357024411
curr_Factors:  [1.06826594e+02 3.19678385e-02]
mat_Sqrt:  [[ 1.91001165e+01  0.00000000e+00]
 [-7.15182086e-03  1.63868802e-02]]
grads:  [-0.00652378 -1.52805654]
Stock Position:  -0.006523775307224778
Bond Position:  [10.3261975]


portfolio before change:  [9.62994545]
curr_Stock_Price:  106.92319568130502
curr_Factors:  [1.06923196e+02 3.13719406e-02]
mat_Sqrt:  [[ 1.89383711e+01  0.00000000e+00]
 [-7.08485039e-03  1.62334316e-02]]
grads:  [2.18912971e-02 2.98366321e+01]
Stock Position:  0.02189129707980019
Bond Position:  [7.28925801]


portfolio before change:  [9.60962426]
curr_Stock_Price:  105.9532941719332
curr_Factors:  [1.05953294e+02 3.18391548e-02]
mat_Sqrt:  [[ 1.89058074e+01  0.00000000e+00]
 [-7.13741183e-03  1.63538650e-02]]
grads:  [3.98794103e-03 9.04829131e+00]
Stock Position:  0.003987941026392414
Bond Position:  [9.18708877]


portfolio before change:  [9.6121641]
curr_Stock_Price:  106.30219251267152
curr_Factors:  [1.06302193e+02 3.15499880e-02]
mat_Sqrt:  [[ 1.88817317e+01  0.00000000e+00]
 [-7.10492651e-03  1.62794318e-02]]
grads:  [-6.27826749e-03 -1.48842801e+01]
Stock Position:  -0.006278267493423622
Bond Position:  [10.2795577]


portfolio before change:  [9.61282276]
curr_Stock_Price:  106.40196079210037
curr_Factors:  [1.06401961e+02 3.19228232e-02]
mat_Sqrt:  [[ 1.90107949e+01  0.00000000e+00]
 [-7.14678369e-03  1.63753386e-02]]
grads:  [1.14182253e-02 1.23140430e+01]
Stock Position:  0.011418225347604538
Bond Position:  [8.39790119]


portfolio before change:  [9.60937015]
curr_Stock_Price:  106.00764315538338
curr_Factors:  [1.06007643e+02 3.32915269e-02]
mat_Sqrt:  [[ 1.93421183e+01  0.00000000e+00]
 [-7.29838633e-03  1.67227039e-02]]
grads:  [7.43505502e-03 9.40752584e+00]
Stock Position:  0.00743505501749878
Bond Position:  [8.82119749]


portfolio before change:  [9.59159132]
curr_Stock_Price:  103.46811253493631
curr_Factors:  [1.03468113e+02 3.35764461e-02]
mat_Sqrt:  [[ 1.89593695e+01  0.00000000e+00]
 [-7.32955072e-03  1.67941105e-02]]
grads:  [  0.02902665 -26.43441197]
Stock Position:  0.029026647085970504
Bond Position:  [6.58825893]


portfolio before change:  [9.61798942]
curr_Stock_Price:  104.34918265975959
curr_Factors:  [1.04349183e+02 3.21097621e-02]
mat_Sqrt:  [[ 1.86985356e+01  0.00000000e+00]
 [-7.16767880e-03  1.64232153e-02]]
grads:  [-8.69623514e-03  2.87808703e+01]
Stock Position:  -0.008696235143969534
Bond Position:  [10.52543445]


portfolio before change:  [9.62008391]
curr_Stock_Price:  104.2596346330925
curr_Factors:  [1.04259635e+02 3.15590416e-02]
mat_Sqrt:  [[ 1.85215830e+01  0.00000000e+00]
 [-7.10594586e-03  1.62817674e-02]]
grads:  [ 0.00791665 -0.55550369]
Stock Position:  0.007916654652162508
Bond Position:  [8.79469639]


portfolio before change:  [9.63592425]
curr_Stock_Price:  106.12165032168554
curr_Factors:  [1.0612165e+02 3.0755713e-02]
mat_Sqrt:  [[ 1.86108794e+01  0.00000000e+00]
 [-7.01492273e-03  1.60732072e-02]]
grads:  [-0.00408262 -3.72917379]
Stock Position:  -0.004082623031645656
Bond Position:  [10.06917894]


portfolio before change:  [9.64074686]
curr_Stock_Price:  105.24870955381918
curr_Factors:  [1.05248710e+02 3.14579499e-02]
mat_Sqrt:  [[ 1.86673207e+01  0.00000000e+00]
 [-7.09455565e-03  1.62556691e-02]]
grads:  [-2.73139352e-03 -1.41414944e+01]
Stock Position:  -0.002731393522930135
Bond Position:  [9.92822251]


portfolio before change:  [9.64301182]
curr_Stock_Price:  104.8738656407937
curr_Factors:  [1.04873866e+02 3.20696521e-02]
mat_Sqrt:  [[ 1.87808135e+01  0.00000000e+00]
 [-7.16320064e-03  1.64129546e-02]]
grads:  [-0.00516325 -4.54449779]
Stock Position:  -0.005163254983335183
Bond Position:  [10.18450232]


portfolio before change:  [9.65071872]
curr_Stock_Price:  103.62779769565721
curr_Factors:  [1.03627798e+02 3.28466400e-02]
mat_Sqrt:  [[ 1.87811311e+01  0.00000000e+00]
 [-7.24945681e-03  1.66105923e-02]]
grads:  [-0.00564593 -0.04500366]
Stock Position:  -0.005645925002010541
Bond Position:  [10.2357935]


portfolio before change:  [9.65375208]
curr_Stock_Price:  103.31716593796583
curr_Factors:  [1.03317166e+02 3.21711317e-02]
mat_Sqrt:  [[ 1.85312901e+01  0.00000000e+00]
 [-7.17452513e-03  1.64389022e-02]]
grads:  [0.01227302 9.37204871]
Stock Position:  0.0122730215311219
Bond Position:  [8.38573828]


portfolio before change:  [9.65308689]
curr_Stock_Price:  103.17755259953329
curr_Factors:  [1.03177553e+02 3.13053292e-02]
mat_Sqrt:  [[ 1.82555264e+01  0.00000000e+00]
 [-7.07732483e-03  1.62161884e-02]]
grads:  [0.0113281  3.00556033]
Stock Position:  0.011328104545415187
Bond Position:  [8.48428078]


portfolio before change:  [9.64901438]
curr_Stock_Price:  102.72442199926202
curr_Factors:  [1.02724422e+02 3.06454171e-02]
mat_Sqrt:  [[ 1.79827652e+01  0.00000000e+00]
 [-7.00233299e-03  1.60443605e-02]]
grads:  [ -0.0191134  -10.94850733]
Stock Position:  -0.01911340208810315
Bond Position:  [11.61242756]


portfolio before change:  [9.66367918]
curr_Stock_Price:  102.03311893424525
curr_Factors:  [1.02033119e+02 3.08759800e-02]
mat_Sqrt:  [[ 1.79288130e+01  0.00000000e+00]
 [-7.02862491e-03  1.61046028e-02]]
grads:  [-1.32646496e-02 -2.49975262e+01]
Stock Position:  -0.013264649635285663
Bond Position:  [11.01711275]


portfolio before change:  [9.67602326]
curr_Stock_Price:  101.20634524710516
curr_Factors:  [1.01206345e+02 2.95511128e-02]
mat_Sqrt:  [[ 1.73978131e+01  0.00000000e+00]
 [-6.87617484e-03  1.57552959e-02]]
grads:  [1.49373137e-03 1.74625034e+01]
Stock Position:  0.001493731368022238
Bond Position:  [9.52484817]


portfolio before change:  [9.67836209]
curr_Stock_Price:  101.97498665771477
curr_Factors:  [1.01974987e+02 2.92021207e-02]
mat_Sqrt:  [[ 1.74261261e+01  0.00000000e+00]
 [-6.83545120e-03  1.56619863e-02]]
grads:  [-4.06566007e-03  7.55951857e+00]
Stock Position:  -0.004065660073626732
Bond Position:  [10.09295772]


portfolio before change:  [9.67583618]
curr_Stock_Price:  102.90659682515641
curr_Factors:  [1.02906597e+02 3.14279995e-02]
mat_Sqrt:  [[ 1.82432238e+01  0.00000000e+00]
 [-7.09117757e-03  1.62479290e-02]]
grads:  [9.79509974e-05 6.86714049e+00]
Stock Position:  9.795099743523617e-05
Bond Position:  [9.66575637]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.67699853]
Stock Price:  102.43760986174689
PL:  [7.23938867]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.43416004e-01  8.32473774e-01]
 [-1.64737537e-01 -8.70892189e-02]
 [ 8.42909021e-01 -7.51252656e-01]
 [-3.95701495e-02  1.10651905e-01]
 [ 2.34075478e-02 -8.29651757e-02]
 [-7.91802486e-02 -1.07401216e-01]
 [-8.63162336e-02  1.44819487e-01]
 [-7.95271095e-02 -1.10177215e-01]
 [ 1.63150509e-01  8.05288074e-02]
 [ 1.09310341e-01  7.70019548e-02]
 [ 1.06508264e-01  1.50191359e-01]
 [-1.80333575e-02  1.29662708e-01]
 [ 1.04139887e-01  6.00922367e-02]
 [-2.56081085e-01 -3.47407888e-01]
 [ 8.46411454e-02  2.29004502e-01]
 [ 5.48200122e-02 -2.09267446e-02]
 [-5.23929955e-02  2.38188026e-01]
 [-1.70078103e-01 -1.29520181e-02]
 [ 1.49842144e-02  6.37457461e-02]
 [-2.30224110e-03 -8.79879785e-02]
 [ 9.38150078e-02 -1.47132431e-03]
 [ 7.06086769e-02  3.12564841e-01]
 [ 3.75391479e-02  3.70366282e-01]
 [-3.13241364e-02  1.42285109e-01]
 [ 2.14898281e-02  5.00209037e-02]
 [ 5.51669511e-01 -1.45044669e-01]
 [-4.90327259e-02  9.18588447e-02]
 [ 1.05995094e-01  1.12751561e-02]
 [-4.50115444e-02 -6.51960908e-02]
 [ 1.33845825e-02 -1.83504005e-01]
 [-2.85078497e-01 -8.84223298e-02]
 [-1.17916330e-01 -7.38157420e-04]
 [ 1.39243215e-01  1.19151984e-01]
 [ 1.89278616e-01  4.68151088e-02]
 [-2.76420848e-01 -1.71760228e-01]
 [-5.70839623e-02 -4.00308954e-01]
 [-1.58080555e-01  2.18456426e-01]
 [-1.21757397e-01  1.18912506e-01]
 [ 1.79525067e-01  8.27289633e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.0663244]
curr_Stock_Price:  101.56016214487322
curr_Factors:  [1.01560162e+02 3.87501846e-02]
mat_Sqrt:  [[ 1.99921855e+01  0.00000000e+00]
 [-7.87402663e-03  1.80416615e-02]]
grads:  [4.03526340e-02 4.61417466e+01]
Stock Position:  0.04035263402156813
Bond Position:  [8.96810434]


portfolio before change:  [12.97615457]
curr_Stock_Price:  99.29783378173778
curr_Factors:  [9.92978338e+01 3.74972095e-02]
mat_Sqrt:  [[ 1.92282274e+01  0.00000000e+00]
 [-7.74567848e-03  1.77475790e-02]]
grads:  [-0.01054421 -4.90710417]
Stock Position:  -0.010544205905736693
Bond Position:  [14.02317138]


portfolio before change:  [12.98355019]
curr_Stock_Price:  98.76269541141568
curr_Factors:  [9.87626954e+01 3.84699240e-02]
mat_Sqrt:  [[ 1.93710695e+01  0.00000000e+00]
 [-7.84550052e-03  1.79763000e-02]]
grads:  [ 2.65878703e-02 -4.17912839e+01]
Stock Position:  0.026587870265743108
Bond Position:  [10.35766045]


portfolio before change:  [12.98433021]
curr_Stock_Price:  98.7433343575795
curr_Factors:  [9.87433344e+01 3.72682292e-02]
mat_Sqrt:  [[ 1.90623820e+01  0.00000000e+00]
 [-7.72199241e-03  1.76933074e-02]]
grads:  [4.57566153e-04 6.25388472e+00]
Stock Position:  0.0004575661525137716
Bond Position:  [12.9391486]


portfolio before change:  [12.98523301]
curr_Stock_Price:  97.18139522468918
curr_Factors:  [9.71813952e+01 4.13160794e-02]
mat_Sqrt:  [[ 1.97534374e+01  0.00000000e+00]
 [-8.13054285e-03  1.86294140e-02]]
grads:  [-6.48060545e-04 -4.45345064e+00]
Stock Position:  -0.0006480605445698174
Bond Position:  [13.04821244]


portfolio before change:  [12.9869802]
curr_Stock_Price:  97.00230684235416
curr_Factors:  [9.70023068e+01 4.08222505e-02]
mat_Sqrt:  [[ 1.95988475e+01  0.00000000e+00]
 [-8.08180678e-03  1.85177457e-02]]
grads:  [-0.0064317  -5.79990773]
Stock Position:  -0.006431703807581388
Bond Position:  [13.6108703]


portfolio before change:  [12.98403348]
curr_Stock_Price:  97.72500472870152
curr_Factors:  [9.77250047e+01 4.04227874e-02]
mat_Sqrt:  [[ 1.96480217e+01  0.00000000e+00]
 [-8.04216761e-03  1.84269209e-02]]
grads:  [-1.17629286e-03  7.85912566e+00]
Stock Position:  -0.0011762928644522017
Bond Position:  [13.09898671]


portfolio before change:  [12.98585661]
curr_Stock_Price:  97.56718231403596
curr_Factors:  [9.75671823e+01 4.02994784e-02]
mat_Sqrt:  [[ 1.95863484e+01  0.00000000e+00]
 [-8.02989200e-03  1.83987939e-02]]
grads:  [-0.00651537 -5.9882846 ]
Stock Position:  -0.006515374149878131
Bond Position:  [13.6215433]


portfolio before change:  [12.97835174]
curr_Stock_Price:  98.9804038758545
curr_Factors:  [9.89804039e+01 3.95991199e-02]
mat_Sqrt:  [[ 1.96966328e+01  0.00000000e+00]
 [-7.95981104e-03  1.82382183e-02]]
grads:  [0.01006752 4.41538785]
Stock Position:  0.010067515799731806
Bond Position:  [11.98186496]


portfolio before change:  [12.96651881]
curr_Stock_Price:  97.65626808489688
curr_Factors:  [9.76562681e+01 4.05144562e-02]
mat_Sqrt:  [[ 1.96564520e+01  0.00000000e+00]
 [-8.05128126e-03  1.84478029e-02]]
grads:  [0.00727073 4.17404475]
Stock Position:  0.007270729698836069
Bond Position:  [12.25648648]


portfolio before change:  [12.97969546]
curr_Stock_Price:  99.2578268894335
curr_Factors:  [9.92578269e+01 4.03479499e-02]
mat_Sqrt:  [[ 1.99377203e+01  0.00000000e+00]
 [-8.03471965e-03  1.84098555e-02]]
grads:  [0.00862973 8.15820411]
Stock Position:  0.008629730204611972
Bond Position:  [12.1231272]


portfolio before change:  [12.98036193]
curr_Stock_Price:  99.15944348653899
curr_Factors:  [9.91594435e+01 3.83781986e-02]
mat_Sqrt:  [[ 1.94256864e+01  0.00000000e+00]
 [-7.83614176e-03  1.79548564e-02]]
grads:  [1.98479924e-03 7.22159538e+00]
Stock Position:  0.0019847992400945104
Bond Position:  [12.78355034]


portfolio before change:  [12.98153504]
curr_Stock_Price:  98.94535280325974
curr_Factors:  [9.89453528e+01 3.87384698e-02]
mat_Sqrt:  [[ 1.94745142e+01  0.00000000e+00]
 [-7.87283632e-03  1.80389342e-02]]
grads:  [0.0066942  3.33125206]
Stock Position:  0.006694199799233331
Bond Position:  [12.31917508]


portfolio before change:  [12.98087607]
curr_Stock_Price:  98.61686381218598
curr_Factors:  [9.86168638e+01 3.80679493e-02]
mat_Sqrt:  [[ 1.92411457e+01  0.00000000e+00]
 [-7.80440381e-03  1.78821356e-02]]
grads:  [ -0.02118909 -19.4276509 ]
Stock Position:  -0.02118908739236278
Bond Position:  [15.07047741]


portfolio before change:  [12.98296957]
curr_Stock_Price:  98.60697329428865
curr_Factors:  [9.86069733e+01 3.61230734e-02]
mat_Sqrt:  [[ 1.87413113e+01  0.00000000e+00]
 [-7.60242839e-03  1.74193518e-02]]
grads:  [9.84919896e-03 1.31465571e+01]
Stock Position:  0.009849198955200603
Bond Position:  [12.01176987]


portfolio before change:  [13.01283459]
curr_Stock_Price:  101.48674674815288
curr_Factors:  [1.01486747e+02 3.52353655e-02]
mat_Sqrt:  [[ 1.90501641e+01  0.00000000e+00]
 [-7.50843424e-03  1.72039841e-02]]
grads:  [ 0.00239824 -1.21638944]
Stock Position:  0.00239823824056705
Bond Position:  [12.7694452]


portfolio before change:  [13.0129154]
curr_Stock_Price:  100.85483640617593
curr_Factors:  [1.00854836e+02 3.60109140e-02]
mat_Sqrt:  [[ 1.91387602e+01  0.00000000e+00]
 [-7.59061674e-03  1.73922879e-02]]
grads:  [2.69405024e-03 1.36950370e+01]
Stock Position:  0.002694050237939785
Bond Position:  [12.7412074]


portfolio before change:  [13.01302188]
curr_Stock_Price:  100.30315042616752
curr_Factors:  [1.00303150e+02 3.61261577e-02]
mat_Sqrt:  [[ 1.90645018e+01  0.00000000e+00]
 [-7.60275294e-03  1.74200954e-02]]
grads:  [-0.0092177  -0.74351017]
Stock Position:  -0.009217698347241727
Bond Position:  [13.93758607]


portfolio before change:  [13.00444193]
curr_Stock_Price:  101.42298119335875
curr_Factors:  [1.01422981e+02 3.58696995e-02]
mat_Sqrt:  [[ 1.92088003e+01  0.00000000e+00]
 [-7.57571905e-03  1.73581530e-02]]
grads:  [2.22841293e-03 3.67238070e+00]
Stock Position:  0.0022284129285888815
Bond Position:  [12.77842964]


portfolio before change:  [13.00249878]
curr_Stock_Price:  99.8341581200883
curr_Factors:  [9.98341581e+01 3.47210326e-02]
mat_Sqrt:  [[ 1.86026783e+01  0.00000000e+00]
 [-7.45343224e-03  1.70779587e-02]]
grads:  [-2.18803672e-03 -5.15213674e+00]
Stock Position:  -0.002188036716847505
Bond Position:  [13.22093958]


portfolio before change:  [13.00451494]
curr_Stock_Price:  99.66805519638281
curr_Factors:  [9.96680552e+01 3.61242919e-02]
mat_Sqrt:  [[ 1.89433008e+01  0.00000000e+00]
 [-7.60255662e-03  1.74196456e-02]]
grads:  [ 0.00491851 -0.0844635 ]
Stock Position:  0.004918512889343809
Bond Position:  [12.51429632]


portfolio before change:  [13.00801806]
curr_Stock_Price:  100.0622264983139
curr_Factors:  [1.00062226e+02 3.80650361e-02]
mat_Sqrt:  [[ 1.95224035e+01  0.00000000e+00]
 [-7.80410518e-03  1.78814514e-02]]
grads:  [1.06043888e-02 1.74798362e+01]
Stock Position:  0.010604388805452033
Bond Position:  [11.9469193]


portfolio before change:  [13.01149427]
curr_Stock_Price:  100.24920173875678
curr_Factors:  [1.00249202e+02 3.76921868e-02]
mat_Sqrt:  [[ 1.94628569e+01  0.00000000e+00]
 [-7.76579029e-03  1.77936609e-02]]
grads:  [1.02338647e-02 2.08145071e+01]
Stock Position:  0.010233864731882807
Bond Position:  [11.9855575]


portfolio before change:  [13.00879359]
curr_Stock_Price:  99.83890002004357
curr_Factors:  [9.98389000e+01 3.88670042e-02]
mat_Sqrt:  [[ 1.96829560e+01  0.00000000e+00]
 [-7.88588655e-03  1.80688360e-02]]
grads:  [1.56349361e-03 7.87461397e+00]
Stock Position:  0.0015634936132916369
Bond Position:  [12.85269611]


portfolio before change:  [13.01101746]
curr_Stock_Price:  100.23364256663274
curr_Factors:  [1.00233643e+02 3.87624553e-02]
mat_Sqrt:  [[ 1.97341831e+01  0.00000000e+00]
 [-7.87527323e-03  1.80445179e-02]]
grads:  [2.19521326e-03 2.77208314e+00]
Stock Position:  0.00219521325543246
Bond Position:  [12.79098323]


portfolio before change:  [13.01136036]
curr_Stock_Price:  99.66145756405083
curr_Factors:  [9.96614576e+01 3.88345454e-02]
mat_Sqrt:  [[ 1.96397677e+01  0.00000000e+00]
 [-7.88259301e-03  1.80612896e-02]]
grads:  [ 0.02486622 -8.03069285]
Stock Position:  0.024866222165375453
Bond Position:  [10.53315641]


portfolio before change:  [13.04859041]
curr_Stock_Price:  101.10571878334949
curr_Factors:  [1.01105719e+02 3.88542313e-02]
mat_Sqrt:  [[ 1.99294302e+01  0.00000000e+00]
 [-7.88459067e-03  1.80658668e-02]]
grads:  [-4.48695181e-04  5.08466302e+00]
Stock Position:  -0.0004486951808558328
Bond Position:  [13.09395606]


portfolio before change:  [13.04944284]
curr_Stock_Price:  102.85391870368686
curr_Factors:  [1.02853919e+02 3.77899470e-02]
mat_Sqrt:  [[ 1.99944280e+01  0.00000000e+00]
 [-7.77585463e-03  1.78167212e-02]]
grads:  [0.00554734 0.63284125]
Stock Position:  0.005547344280502377
Bond Position:  [12.47887675]


portfolio before change:  [13.0563482]
curr_Stock_Price:  103.81751472189745
curr_Factors:  [1.03817515e+02 3.66004907e-02]
mat_Sqrt:  [[ 1.98615932e+01  0.00000000e+00]
 [-7.65250188e-03  1.75340846e-02]]
grads:  [-3.69887000e-03 -3.71824891e+00]
Stock Position:  -0.003698869999925324
Bond Position:  [13.44035569]


portfolio before change:  [13.05506983]
curr_Stock_Price:  104.61735880275346
curr_Factors:  [1.04617359e+02 3.54345206e-02]
mat_Sqrt:  [[ 1.96932336e+01  0.00000000e+00]
 [-7.52962369e-03  1.72525353e-02]]
grads:  [-3.38710912e-03 -1.06363501e+01]
Stock Position:  -0.0033871091246815343
Bond Position:  [13.40942024]


portfolio before change:  [13.06147779]
curr_Stock_Price:  103.22039376767962
curr_Factors:  [1.03220394e+02 3.71736496e-02]
mat_Sqrt:  [[ 1.99013763e+01  0.00000000e+00]
 [-7.71218772e-03  1.76708420e-02]]
grads:  [-0.01626366 -5.00385493]
Stock Position:  -0.016263657377305153
Bond Position:  [14.7402189]


portfolio before change:  [13.07332443]
curr_Stock_Price:  102.60528014586073
curr_Factors:  [1.02605280e+02 3.66898245e-02]
mat_Sqrt:  [[ 1.96536188e+01  0.00000000e+00]
 [-7.66183523e-03  1.75554700e-02]]
grads:  [-0.00601612 -0.04204715]
Stock Position:  -0.00601611794940823
Bond Position:  [13.69060989]


portfolio before change:  [13.07556952]
curr_Stock_Price:  102.51657479952418
curr_Factors:  [1.02516575e+02 3.61810799e-02]
mat_Sqrt:  [[ 1.95000107e+01  0.00000000e+00]
 [-7.60852994e-03  1.74333322e-02]]
grads:  [0.00980745 6.83472229]
Stock Position:  0.009807451239012997
Bond Position:  [12.07014321]


portfolio before change:  [13.08291804]
curr_Stock_Price:  103.11200535488457
curr_Factors:  [1.03112005e+02 3.59945479e-02]
mat_Sqrt:  [[ 1.95626460e+01  0.00000000e+00]
 [-7.58889167e-03  1.73883352e-02]]
grads:  [0.01071994 2.6923284 ]
Stock Position:  0.010719940685429707
Bond Position:  [11.97756346]


portfolio before change:  [13.07542808]
curr_Stock_Price:  102.27363816478713
curr_Factors:  [1.02273638e+02 3.52176218e-02]
mat_Sqrt:  [[ 1.91930378e+01  0.00000000e+00]
 [-7.50654347e-03  1.71996518e-02]]
grads:  [-0.01830784 -9.98626193]
Stock Position:  -0.018307844796195297
Bond Position:  [14.94783798]


portfolio before change:  [13.08095641]
curr_Stock_Price:  102.07373870386249
curr_Factors:  [1.02073739e+02 3.42086363e-02]
mat_Sqrt:  [[ 1.88791268e+01  0.00000000e+00]
 [-7.39823074e-03  1.69514762e-02]]
grads:  [-1.22777454e-02 -2.36149908e+01]
Stock Position:  -0.01227774544197583
Bond Position:  [14.33419179]


portfolio before change:  [13.05533275]
curr_Stock_Price:  104.30668444738743
curr_Factors:  [1.04306684e+02 3.31271173e-02]
mat_Sqrt:  [[ 1.89847098e+01  0.00000000e+00]
 [-7.28034255e-03  1.66813604e-02]]
grads:  [-3.30467809e-03  1.30958399e+01]
Stock Position:  -0.003304678094380418
Bond Position:  [13.40003277]


portfolio before change:  [13.06261355]
curr_Stock_Price:  102.61039580158806
curr_Factors:  [1.02610396e+02 3.32387771e-02]
mat_Sqrt:  [[ 1.87074193e+01  0.00000000e+00]
 [-7.29260196e-03  1.67094502e-02]]
grads:  [-3.73433252e-03  7.11648222e+00]
Stock Position:  -0.0037343325198606063
Bond Position:  [13.44579489]


portfolio before change:  [13.06921417]
curr_Stock_Price:  101.29294657598729
curr_Factors:  [1.01292947e+02 3.35374549e-02]
mat_Sqrt:  [[ 1.85500146e+01  0.00000000e+00]
 [-7.32529370e-03  1.67843564e-02]]
grads:  [0.0116243 4.9289327]
Stock Position:  0.011624300648366982
Bond Position:  [11.89175451]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.06162275]
Stock Price:  100.51199775000553
PL:  [12.549625]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.34907919e-01  5.51051738e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.09286863e-01 -6.84424845e-01]
 [-4.32246448e-02  6.05781268e-02]
 [ 3.66244533e-02 -2.46938635e-02]
 [-8.12190214e-02 -1.00014121e-01]
 [-5.00776800e-02  1.94006105e-01]
 [-1.76993512e-02 -6.59471338e-02]
 [ 1.51561690e-01  7.47333402e-02]
 [ 1.66190376e-01 -3.90883652e-03]
 [ 1.39919123e-01  2.69313983e-01]
 [ 1.81139373e-01  2.32524649e-01]
 [ 2.05049480e-01  2.47488689e-02]
 [-1.58647187e-01 -1.68749110e-01]
 [ 8.96071412e-02  2.32963560e-01]
 [ 4.76647292e-02  3.36825479e-02]
 [ 9.55396304e-02  2.12879594e-01]
 [ 9.57368534e-02  6.69012191e-02]
 [ 1.91312990e-02 -2.59011779e-02]
 [ 3.54737046e-01 -1.15985419e-01]
 [ 5.86162770e-02 -3.77779896e-02]
 [-2.04408756e-02  4.05300450e-02]
 [-8.42511862e-02 -9.33134295e-03]
 [ 9.05823924e-02 -4.07123709e-01]
 [ 1.03975663e-01  3.26368384e-01]
 [-3.97093516e-02  1.00289116e-01]
 [-3.61471425e-02  1.50818080e-01]
 [-1.28082584e-01  2.02712430e-02]
 [-9.18041678e-01  2.28566751e-01]
 [ 2.99668566e-01  1.86961880e-01]
 [-1.78676621e+00 -1.99523927e-01]
 [ 3.46313596e-01  6.32995623e-01]
 [ 4.80673352e-02 -1.47176425e-01]
 [ 9.50373876e-02  5.95003315e-03]
 [ 1.42779205e-02  1.75264703e-01]
 [-2.61513797e+00  2.09013281e-01]
 [-1.50280445e-01  6.99783447e-02]
 [-1.33429568e-01 -3.41227525e-01]
 [ 1.87832314e+00 -1.29852798e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.29048174]
curr_Stock_Price:  100.69022675659231
curr_Factors:  [1.00690227e+02 3.91405011e-02]
mat_Sqrt:  [[ 1.99205126e+01  0.00000000e+00]
 [-7.91358337e-03  1.81322974e-02]]
grads:  [2.38651798e-02 3.03906188e+01]
Stock Position:  0.023865179785860523
Bond Position:  [4.88749138]


portfolio before change:  [7.26591026]
curr_Stock_Price:  99.63503019434113
curr_Factors:  [9.96350302e+01 4.08136380e-02]
mat_Sqrt:  [[ 2.01286529e+01  0.00000000e+00]
 [-8.08095420e-03  1.85157922e-02]]
grads:  [-0.01008435 -4.75331379]
Stock Position:  -0.010084353337796672
Bond Position:  [8.27066511]


portfolio before change:  [7.26440563]
curr_Stock_Price:  99.8867593042245
curr_Factors:  [9.98867593e+01 4.04676954e-02]
mat_Sqrt:  [[ 2.00938039e+01  0.00000000e+00]
 [-8.04663362e-03  1.84371538e-02]]
grads:  [ 2.54097917e-02 -3.71220445e+01]
Stock Position:  0.025409791674533996
Bond Position:  [4.72630389]


portfolio before change:  [7.2544923]
curr_Stock_Price:  99.47336929742019
curr_Factors:  [9.94733693e+01 3.95207231e-02]
mat_Sqrt:  [[ 1.97751265e+01  0.00000000e+00]
 [-7.95192788e-03  1.82201557e-02]]
grads:  [-8.48853369e-04  3.32478644e+00]
Stock Position:  -0.0008488533689223179
Bond Position:  [7.33893061]


portfolio before change:  [7.2560457]
curr_Stock_Price:  98.72415136430212
curr_Factors:  [9.87241514e+01 3.86901155e-02]
mat_Sqrt:  [[ 1.94188462e+01  0.00000000e+00]
 [-7.86792125e-03  1.80276723e-02]]
grads:  [ 1.33103519e-03 -1.36977548e+00]
Stock Position:  0.0013310351906418195
Bond Position:  [7.12464038]


portfolio before change:  [7.25617822]
curr_Stock_Price:  98.15457655648186
curr_Factors:  [9.81545766e+01 3.96293684e-02]
mat_Sqrt:  [[ 1.95397557e+01  0.00000000e+00]
 [-7.96285059e-03  1.82451828e-02]]
grads:  [-0.0063905  -5.48167274]
Stock Position:  -0.0063904976290947435
Bond Position:  [7.8834348]


portfolio before change:  [7.2530596]
curr_Stock_Price:  98.79679690138403
curr_Factors:  [9.87967969e+01 3.83223398e-02]
mat_Sqrt:  [[ 1.93405524e+01  0.00000000e+00]
 [-7.83043700e-03  1.79417851e-02]]
grads:  [1.78865243e-03 1.08130882e+01]
Stock Position:  0.0017886524274802755
Bond Position:  [7.07634647]


portfolio before change:  [7.25476966]
curr_Stock_Price:  99.25829830855807
curr_Factors:  [9.92582983e+01 3.80452961e-02]
mat_Sqrt:  [[ 1.93605330e+01  0.00000000e+00]
 [-7.80208137e-03  1.78768142e-02]]
grads:  [-2.40081407e-03 -3.68897573e+00]
Stock Position:  -0.0024008140707226077
Bond Position:  [7.49307038]


portfolio before change:  [7.25357101]
curr_Stock_Price:  100.14772223076844
curr_Factors:  [1.00147722e+02 3.57884637e-02]
mat_Sqrt:  [[ 1.89457850e+01  0.00000000e+00]
 [-7.56713564e-03  1.73384859e-02]]
grads:  [0.00972132 4.31025757]
Stock Position:  0.00972131764742412
Bond Position:  [6.28000319]


portfolio before change:  [7.23982053]
curr_Stock_Price:  98.65249980836637
curr_Factors:  [9.86524998e+01 3.54872202e-02]
mat_Sqrt:  [[ 1.85842092e+01  0.00000000e+00]
 [-7.53522079e-03  1.72653598e-02]]
grads:  [ 0.00885076 -0.22639763]
Stock Position:  0.008850762393293838
Bond Position:  [6.3666707]


portfolio before change:  [7.23142953]
curr_Stock_Price:  97.61452262681496
curr_Factors:  [9.76145226e+01 3.64492375e-02]
mat_Sqrt:  [[ 1.86362556e+01  0.00000000e+00]
 [-7.63667336e-03  1.74978169e-02]]
grads:  [1.38148664e-02 1.53912906e+01]
Stock Position:  0.013814866404767338
Bond Position:  [5.88289794]


portfolio before change:  [7.22941845]
curr_Stock_Price:  97.4157159203802
curr_Factors:  [9.74157159e+01 3.65243747e-02]
mat_Sqrt:  [[ 1.86174596e+01  0.00000000e+00]
 [-7.64454050e-03  1.75158427e-02]]
grads:  [ 0.01518045 13.27510486]
Stock Position:  0.015180451830077699
Bond Position:  [5.75060386]


portfolio before change:  [7.22260182]
curr_Stock_Price:  96.91932152113223
curr_Factors:  [9.69193215e+01 3.59617933e-02]
mat_Sqrt:  [[ 1.83793875e+01  0.00000000e+00]
 [-7.58543797e-03  1.73804218e-02]]
grads:  [0.01174418 1.42395099]
Stock Position:  0.01174417653945094
Bond Position:  [6.0843642]


portfolio before change:  [7.22250577]
curr_Stock_Price:  96.84637904007398
curr_Factors:  [9.68463790e+01 3.50211606e-02]
mat_Sqrt:  [[ 1.81237747e+01  0.00000000e+00]
 [-7.48557659e-03  1.71516107e-02]]
grads:  [-0.01281716 -9.83867423]
Stock Position:  -0.012817160906788555
Bond Position:  [8.46380139]


portfolio before change:  [7.21796473]
curr_Stock_Price:  97.2832214207676
curr_Factors:  [9.72832214e+01 3.48809934e-02]
mat_Sqrt:  [[ 1.81690561e+01  0.00000000e+00]
 [-7.47058160e-03  1.71172528e-02]]
grads:  [1.05278322e-02 1.36098685e+01]
Stock Position:  0.010527832222864979
Bond Position:  [6.1937833]


portfolio before change:  [7.21648127]
curr_Stock_Price:  97.06876759435698
curr_Factors:  [9.70687676e+01 3.44814555e-02]
mat_Sqrt:  [[ 1.80248770e+01  0.00000000e+00]
 [-7.42767317e-03  1.70189373e-02]]
grads:  [0.00345994 1.97912169]
Stock Position:  0.0034599402916461724
Bond Position:  [6.88062913]


portfolio before change:  [7.21018159]
curr_Stock_Price:  94.99942249693495
curr_Factors:  [9.49994225e+01 3.44435120e-02]
mat_Sqrt:  [[ 1.76309080e+01  0.00000000e+00]
 [-7.42358533e-03  1.70095709e-02]]
grads:  [1.06884967e-02 1.25152831e+01]
Stock Position:  0.010688496727105605
Bond Position:  [6.19478057]


portfolio before change:  [7.21398234]
curr_Stock_Price:  95.28256390961795
curr_Factors:  [9.52825639e+01 3.32558581e-02]
mat_Sqrt:  [[ 1.73759082e+01  0.00000000e+00]
 [-7.29447551e-03  1.67137431e-02]]
grads:  [0.00719012 4.00276699]
Stock Position:  0.007190124256555512
Bond Position:  [6.52888887]


portfolio before change:  [7.20991452]
curr_Stock_Price:  94.60330130514944
curr_Factors:  [9.46033013e+01 3.30371777e-02]
mat_Sqrt:  [[ 1.71952210e+01  0.00000000e+00]
 [-7.27045282e-03  1.66587002e-02]]
grads:  [ 4.55190321e-04 -1.55481386e+00]
Stock Position:  0.00045519032127006986
Bond Position:  [7.16685201]


portfolio before change:  [7.2107127]
curr_Stock_Price:  94.3885955936598
curr_Factors:  [9.43885956e+01 3.27990387e-02]
mat_Sqrt:  [[ 1.70942512e+01  0.00000000e+00]
 [-7.24420195e-03  1.65985519e-02]]
grads:  [ 0.01779059 -6.98768301]
Stock Position:  0.017790592619382387
Bond Position:  [5.53148365]


portfolio before change:  [7.19176769]
curr_Stock_Price:  93.28483835584223
curr_Factors:  [9.32848384e+01 3.25539227e-02]
mat_Sqrt:  [[ 1.68311088e+01  0.00000000e+00]
 [-7.21708226e-03  1.65364129e-02]]
grads:  [ 0.00250302 -2.28453353]
Stock Position:  0.002503020516552057
Bond Position:  [6.95827382]


portfolio before change:  [7.19176794]
curr_Stock_Price:  92.93742381840174
curr_Factors:  [9.29374238e+01 3.34210496e-02]
mat_Sqrt:  [[ 1.69902853e+01  0.00000000e+00]
 [-7.31256995e-03  1.67552027e-02]]
grads:  [-1.61981609e-04  2.41895284e+00]
Stock Position:  -0.0001619816086768085
Bond Position:  [7.20682209]


portfolio before change:  [7.19291527]
curr_Stock_Price:  91.4161025085855
curr_Factors:  [9.14161025e+01 3.38853888e-02]
mat_Sqrt:  [[ 1.68278618e+01  0.00000000e+00]
 [-7.36319374e-03  1.68711963e-02]]
grads:  [-0.00524866 -0.55309314]
Stock Position:  -0.0052486595688072055
Bond Position:  [7.67272727]


portfolio before change:  [7.19835963]
curr_Stock_Price:  90.56155890363989
curr_Factors:  [9.05615589e+01 3.51353559e-02]
mat_Sqrt:  [[ 1.69752457e+01  0.00000000e+00]
 [-7.49777097e-03  1.71795515e-02]]
grads:  [-5.13105749e-03 -2.36981570e+01]
Stock Position:  -0.005131057485198645
Bond Position:  [7.6630362]


portfolio before change:  [7.20706933]
curr_Stock_Price:  89.05080605517811
curr_Factors:  [8.90508061e+01 3.54042591e-02]
mat_Sqrt:  [[ 1.67558171e+01  0.00000000e+00]
 [-7.52640781e-03  1.72451668e-02]]
grads:  [1.47062064e-02 1.89252090e+01]
Stock Position:  0.014706206362862599
Bond Position:  [5.8974698]


portfolio before change:  [7.2112735]
curr_Stock_Price:  89.28655270686158
curr_Factors:  [8.92865527e+01 3.36935355e-02]
mat_Sqrt:  [[ 1.63892601e+01  0.00000000e+00]
 [-7.34231958e-03  1.68233676e-02]]
grads:  [2.47748037e-04 5.96129849e+00]
Stock Position:  0.0002477480373472412
Bond Position:  [7.18915293]


portfolio before change:  [7.21195586]
curr_Stock_Price:  88.4133380439209
curr_Factors:  [8.84133380e+01 3.38787535e-02]
mat_Sqrt:  [[ 1.62735199e+01  0.00000000e+00]
 [-7.36247279e-03  1.68695444e-02]]
grads:  [1.82353076e-03 8.94025805e+00]
Stock Position:  0.001823530761807946
Bond Position:  [7.05073142]


portfolio before change:  [7.21017858]
curr_Stock_Price:  86.9553509783967
curr_Factors:  [8.69553510e+01 3.43352248e-02]
mat_Sqrt:  [[ 1.61126235e+01  0.00000000e+00]
 [-7.41190661e-03  1.69828116e-02]]
grads:  [-0.00740013  1.19363292]
Stock Position:  -0.0074001287243204246
Bond Position:  [7.85365937]


portfolio before change:  [7.22102813]
curr_Stock_Price:  85.6218902489966
curr_Factors:  [8.56218902e+01 3.42469491e-02]
mat_Sqrt:  [[ 1.58451281e+01  0.00000000e+00]
 [-7.40237250e-03  1.69609661e-02]]
grads:  [-0.05164281 13.47604548]
Stock Position:  -0.05164281178211512
Bond Position:  [11.64278329]


portfolio before change:  [7.15185276]
curr_Stock_Price:  86.989569596343
curr_Factors:  [8.69895696e+01 3.38967996e-02]
mat_Sqrt:  [[ 1.60157223e+01  0.00000000e+00]
 [-7.36443340e-03  1.68740368e-02]]
grads:  [ 0.0238057  11.07985495]
Stock Position:  0.023805696214107136
Bond Position:  [5.08100549]


portfolio before change:  [7.19749809]
curr_Stock_Price:  88.88030053951488
curr_Factors:  [8.88803005e+01 3.36865824e-02]
mat_Sqrt:  [[ 1.63130058e+01  0.00000000e+00]
 [-7.34156195e-03  1.68216317e-02]]
grads:  [ -0.1148682  -11.86115179]
Stock Position:  -0.11486819866901048
Bond Position:  [17.40701811]


portfolio before change:  [7.12844469]
curr_Stock_Price:  89.5003973920482
curr_Factors:  [8.95003974e+01 3.18040525e-02]
mat_Sqrt:  [[ 1.59612241e+01  0.00000000e+00]
 [-7.13347629e-03  1.63448475e-02]]
grads:  [ 0.0390055  38.72753307]
Stock Position:  0.03900550059178295
Bond Position:  [3.63743689]


portfolio before change:  [7.14039952]
curr_Stock_Price:  89.79523055631174
curr_Factors:  [8.97952306e+01 3.13203045e-02]
mat_Sqrt:  [[ 1.58915500e+01  0.00000000e+00]
 [-7.07901739e-03  1.62200665e-02]]
grads:  [-1.01725273e-03 -9.07372511e+00]
Stock Position:  -0.0010172527310634385
Bond Position:  [7.23174396]


portfolio before change:  [7.14153175]
curr_Stock_Price:  89.5708882936803
curr_Factors:  [8.95708883e+01 3.25469706e-02]
mat_Sqrt:  [[ 1.61592860e+01  0.00000000e+00]
 [-7.21631159e-03  1.65346471e-02]]
grads:  [0.00604199 0.35985244]
Stock Position:  0.006041986944892177
Bond Position:  [6.60034562]


portfolio before change:  [7.1391884]
curr_Stock_Price:  89.04648354947744
curr_Factors:  [8.90464835e+01 3.23720050e-02]
mat_Sqrt:  [[ 1.60214409e+01  0.00000000e+00]
 [-7.19688877e-03  1.64901438e-02]]
grads:  [5.66551462e-03 1.06284521e+01]
Stock Position:  0.005665514615170549
Bond Position:  [6.63469425]


portfolio before change:  [7.13891581]
curr_Stock_Price:  88.8519764353508
curr_Factors:  [8.88519764e+01 3.21467853e-02]
mat_Sqrt:  [[ 1.59307370e+01  0.00000000e+00]
 [-7.17180985e-03  1.64326807e-02]]
grads:  [-0.15843066 12.719366  ]
Stock Position:  -0.1584306550459902
Bond Position:  [21.21579264]


portfolio before change:  [7.11992358]
curr_Stock_Price:  88.98859376320847
curr_Factors:  [8.89885938e+01 3.10966619e-02]
mat_Sqrt:  [[ 1.56924672e+01  0.00000000e+00]
 [-7.05369825e-03  1.61620531e-02]]
grads:  [-0.00763037  4.32979302]
Stock Position:  -0.0076303738748581765
Bond Position:  [7.79893982]


portfolio before change:  [7.1268348]
curr_Stock_Price:  88.21061178449642
curr_Factors:  [8.82106118e+01 3.12771193e-02]
mat_Sqrt:  [[ 1.56003452e+01  0.00000000e+00]
 [-7.07413535e-03  1.62088803e-02]]
grads:  [-1.80991809e-02 -2.10518875e+01]
Stock Position:  -0.018099180913480947
Bond Position:  [8.72337462]


portfolio before change:  [7.13732019]
curr_Stock_Price:  87.6915326784388
curr_Factors:  [8.76915327e+01 3.21056599e-02]
mat_Sqrt:  [[ 1.57126147e+01  0.00000000e+00]
 [-7.16722093e-03  1.64221662e-02]]
grads:  [ 0.11593556 -7.9071662 ]
Stock Position:  0.11593555641479746
Bond Position:  [-3.02924644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.12072259]
Stock Price:  87.55163661002118
PL:  [7.12072259]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.80962647e-01 -1.74360573e-01]
 [-1.99865447e-01 -7.59297273e-02]
 [ 7.66899366e-01 -6.47357849e-01]
 [ 2.07711689e-02  2.31405120e-02]
 [-6.35454923e-02  2.87914677e-02]
 [-8.62144221e-02 -7.96317856e-02]
 [-3.67582209e-02  2.12084618e-01]
 [-5.25546143e-02 -7.33658029e-02]
 [ 1.59819434e-01  7.43037547e-02]
 [ 1.58011393e-01  8.50633029e-03]
 [ 1.03515351e-01  1.39520468e-01]
 [-7.92775889e-02  3.19314289e-02]
 [ 1.30097417e-01  4.96547282e-02]
 [-2.67478840e-01 -3.69699535e-01]
 [ 8.32229683e-02  2.27888043e-01]
 [ 5.21575129e-02 -1.92303261e-02]
 [-4.35724681e-02  1.00531200e-01]
 [-3.25065693e-02  2.88745671e-02]
 [ 1.51477784e-02  5.96844276e-02]
 [ 4.98644541e-02 -9.67205178e-02]
 [ 5.86162770e-02 -3.77779896e-02]
 [ 3.20355637e-02  2.08156835e-01]
 [ 3.53244586e-02  2.42719381e-01]
 [-6.74439497e-02  1.18338927e-01]
 [ 4.43726156e-02  1.00353434e-01]
 [ 1.67141446e-01  3.87245692e-02]
 [ 1.01812662e-01  1.74937394e-01]
 [-1.65798763e-01  1.05121976e-01]
 [-2.77054087e-01  1.59592742e-03]
 [ 1.81407971e-01 -8.87206464e-02]
 [-1.30555977e+00 -1.47023789e-01]
 [ 9.24581437e-02  3.17106825e-01]
 [ 1.59236231e-03 -1.31492526e-01]
 [-3.40457403e-03  5.86280006e-02]
 [-2.88851166e-02  1.68167049e-01]
 [-1.96232816e+00 -1.64476298e-02]
 [-1.03647161e-01  1.65525924e-01]
 [-1.35121127e-01 -6.52650892e-03]
 [ 1.26424363e+00 -5.00843058e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.20221264]
curr_Stock_Price:  98.50739241253207
curr_Factors:  [9.85073924e+01 4.01057626e-02]
mat_Sqrt:  [[ 1.97275073e+01  0.00000000e+00]
 [-8.01056928e-03  1.83545200e-02]]
grads:  [-0.02316866 -9.49959863]
Stock Position:  -0.023168656488284995
Bond Position:  [-4.9199287]


portfolio before change:  [-7.27268766]
curr_Stock_Price:  101.52267239783508
curr_Factors:  [1.01522672e+02 3.93430633e-02]
mat_Sqrt:  [[ 2.01371093e+01  0.00000000e+00]
 [-7.93403437e-03  1.81791565e-02]]
grads:  [-0.01157087 -4.17674644]
Stock Position:  -0.011570871152049373
Bond Position:  [-6.09798189]


portfolio before change:  [-7.2731325]
curr_Stock_Price:  101.49523717810004
curr_Factors:  [1.01495237e+02 3.96887941e-02]
mat_Sqrt:  [[ 2.02199285e+01  0.00000000e+00]
 [-7.96881865e-03  1.82588573e-02]]
grads:  [ 2.39550421e-02 -3.54544558e+01]
Stock Position:  0.023955042128101914
Bond Position:  [-9.70445518]


portfolio before change:  [-7.28747497]
curr_Stock_Price:  100.94715466698815
curr_Factors:  [1.00947155e+02 4.04603004e-02]
mat_Sqrt:  [[ 2.03052637e+01  0.00000000e+00]
 [-8.04589837e-03  1.84354692e-02]]
grads:  [0.00152032 1.25521688]
Stock Position:  0.001520320879718551
Bond Position:  [-7.44094704]


portfolio before change:  [-7.28904734]
curr_Stock_Price:  100.52475297986523
curr_Factors:  [1.00524753e+02 3.87571927e-02]
mat_Sqrt:  [[ 1.97901539e+01  0.00000000e+00]
 [-7.87473862e-03  1.80432929e-02]]
grads:  [-0.00257602  1.5956881 ]
Stock Position:  -0.002576021693172048
Bond Position:  [-7.03009339]


portfolio before change:  [-7.28525527]
curr_Stock_Price:  98.7115383767676
curr_Factors:  [9.87115384e+01 4.02871634e-02]
mat_Sqrt:  [[ 1.98130468e+01  0.00000000e+00]
 [-8.02866499e-03  1.83959825e-02]]
grads:  [-0.0061055  -4.32875958]
Stock Position:  -0.006105501281361261
Bond Position:  [-6.68257185]


portfolio before change:  [-7.28900657]
curr_Stock_Price:  99.18912800554638
curr_Factors:  [9.91891280e+01 4.03920999e-02]
mat_Sqrt:  [[ 1.99348186e+01  0.00000000e+00]
 [-8.03911437e-03  1.84199251e-02]]
grads:  [2.79927778e-03 1.15138698e+01]
Stock Position:  0.0027992777848339125
Bond Position:  [-7.56666449]


portfolio before change:  [-7.29038459]
curr_Stock_Price:  99.03475799904874
curr_Factors:  [9.90347580e+01 4.04144439e-02]
mat_Sqrt:  [[ 1.99092981e+01  0.00000000e+00]
 [-8.04133759e-03  1.84250191e-02]]
grads:  [-0.00424797 -3.98185763]
Stock Position:  -0.004247968738246701
Bond Position:  [-6.86968803]


portfolio before change:  [-7.2928186]
curr_Stock_Price:  99.40558122359168
curr_Factors:  [9.94055812e+01 3.88507716e-02]
mat_Sqrt:  [[ 1.95934356e+01  0.00000000e+00]
 [-7.88423963e-03  1.80650625e-02]]
grads:  [0.00981187 4.11311917]
Stock Position:  0.009811870443022484
Bond Position:  [-8.26817328]


portfolio before change:  [-7.30278895]
curr_Stock_Price:  98.49476918431499
curr_Factors:  [9.84947692e+01 3.92732626e-02]
mat_Sqrt:  [[ 1.95191840e+01  0.00000000e+00]
 [-7.92699314e-03  1.81630230e-02]]
grads:  [0.00828538 0.4683323 ]
Stock Position:  0.00828538015774405
Bond Position:  [-8.11885556]


portfolio before change:  [-7.29622481]
curr_Stock_Price:  99.409521239705
curr_Factors:  [9.94095212e+01 3.90896769e-02]
mat_Sqrt:  [[ 1.96543652e+01  0.00000000e+00]
 [-7.90844378e-03  1.81205211e-02]]
grads:  [0.00836491 7.69958363]
Stock Position:  0.00836491403393918
Bond Position:  [-8.1277769]


portfolio before change:  [-7.29383827]
curr_Stock_Price:  99.81628871158716
curr_Factors:  [9.98162887e+01 3.92959598e-02]
mat_Sqrt:  [[ 1.97867911e+01  0.00000000e+00]
 [-7.92928342e-03  1.81682707e-02]]
grads:  [-0.00330228  1.75753815]
Stock Position:  -0.003302282343287577
Bond Position:  [-6.9642167]


portfolio before change:  [-7.29096519]
curr_Stock_Price:  98.68262969582764
curr_Factors:  [9.86826297e+01 4.04763323e-02]
mat_Sqrt:  [[ 1.98536925e+01  0.00000000e+00]
 [-8.04749226e-03  1.84391212e-02]]
grads:  [0.00764435 2.69290101]
Stock Position:  0.00764434715433617
Bond Position:  [-8.04532947]


portfolio before change:  [-7.29057785]
curr_Stock_Price:  98.86486455346976
curr_Factors:  [9.88648646e+01 4.13543081e-02]
mat_Sqrt:  [[ 2.01049203e+01  0.00000000e+00]
 [-8.13430347e-03  1.86380307e-02]]
grads:  [ -0.02132955 -19.8357617 ]
Stock Position:  -0.021329552146155593
Bond Position:  [-5.18183456]


portfolio before change:  [-7.29372449]
curr_Stock_Price:  98.98202000225753
curr_Factors:  [9.89820200e+01 4.16217585e-02]
mat_Sqrt:  [[ 2.01937291e+01  0.00000000e+00]
 [-8.16056454e-03  1.86982024e-02]]
grads:  [9.04644525e-03 1.21876980e+01]
Stock Position:  0.009046445254980984
Bond Position:  [-8.18915992]


portfolio before change:  [-7.29748959]
curr_Stock_Price:  98.67898509445982
curr_Factors:  [9.86789851e+01 4.17798226e-02]
mat_Sqrt:  [[ 2.01700962e+01  0.00000000e+00]
 [-8.17604526e-03  1.87336732e-02]]
grads:  [ 0.00216978 -1.02651124]
Stock Position:  0.0021697819387780973
Bond Position:  [-7.51160147]


portfolio before change:  [-7.29783799]
curr_Stock_Price:  98.95118288561574
curr_Factors:  [9.89511829e+01 4.12338795e-02]
mat_Sqrt:  [[ 2.00931529e+01  0.00000000e+00]
 [-8.12245081e-03  1.86108728e-02]]
grads:  [1.50770154e-05 5.40174559e+00]
Stock Position:  1.5077015382547297e-05
Bond Position:  [-7.29932988]


portfolio before change:  [-7.29874663]
curr_Stock_Price:  99.20496153600051
curr_Factors:  [9.92049615e+01 4.15365830e-02]
mat_Sqrt:  [[ 2.02184927e+01  0.00000000e+00]
 [-8.15221030e-03  1.86790604e-02]]
grads:  [-9.84478683e-04  1.54582546e+00]
Stock Position:  -0.0009844786834975118
Bond Position:  [-7.20108146]


portfolio before change:  [-7.30012955]
curr_Stock_Price:  99.69529329751401
curr_Factors:  [9.96952933e+01 4.06149638e-02]
mat_Sqrt:  [[ 2.00917465e+01  0.00000000e+00]
 [-8.06126181e-03  1.84706712e-02]]
grads:  [2.05040404e-03 3.23130800e+00]
Stock Position:  0.002050404036126465
Bond Position:  [-7.50454518]


portfolio before change:  [-7.30279598]
curr_Stock_Price:  98.85238468684275
curr_Factors:  [9.88523847e+01 4.05587303e-02]
mat_Sqrt:  [[ 1.99080776e+01  0.00000000e+00]
 [-8.05567927e-03  1.84578800e-02]]
grads:  [ 3.84374603e-04 -5.24006645e+00]
Stock Position:  0.0003843746034126599
Bond Position:  [-7.34079232]


portfolio before change:  [-7.30423761]
curr_Stock_Price:  97.48920428501727
curr_Factors:  [9.74892043e+01 4.15466765e-02]
mat_Sqrt:  [[ 1.98712263e+01  0.00000000e+00]
 [-8.15320075e-03  1.86813298e-02]]
grads:  [ 0.00212008 -2.02223236]
Stock Position:  0.0021200810610584007
Bond Position:  [-7.51092262]


portfolio before change:  [-7.30709526]
curr_Stock_Price:  96.58417748867004
curr_Factors:  [9.65841775e+01 4.11223466e-02]
mat_Sqrt:  [[ 1.95859630e+01  0.00000000e+00]
 [-8.11145822e-03  1.85856857e-02]]
grads:  [6.27401646e-03 1.11998470e+01]
Stock Position:  0.006274016459075946
Bond Position:  [-7.91306598]


portfolio before change:  [-7.29957197]
curr_Stock_Price:  97.94096187136522
curr_Factors:  [9.79409619e+01 4.13151139e-02]
mat_Sqrt:  [[ 1.99075971e+01  0.00000000e+00]
 [-8.13044785e-03  1.86291964e-02]]
grads:  [7.09557665e-03 1.30289775e+01]
Stock Position:  0.007095576646587384
Bond Position:  [-7.99451957]


portfolio before change:  [-7.29835717]
curr_Stock_Price:  98.25301250259388
curr_Factors:  [9.82530125e+01 4.09848839e-02]
mat_Sqrt:  [[ 1.98910509e+01  0.00000000e+00]
 [-8.09788950e-03  1.85545958e-02]]
grads:  [-7.94156514e-04  6.37787686e+00]
Stock Position:  -0.0007941565135985644
Bond Position:  [-7.2203289]


portfolio before change:  [-7.29853204]
curr_Stock_Price:  97.33666129188988
curr_Factors:  [9.73366613e+01 4.30062763e-02]
mat_Sqrt:  [[ 2.01856327e+01  0.00000000e+00]
 [-8.29518186e-03  1.90066494e-02]]
grads:  [4.36798024e-03 5.27991187e+00]
Stock Position:  0.004367980244103861
Bond Position:  [-7.72369665]


portfolio before change:  [-7.30100505]
curr_Stock_Price:  96.99153752154716
curr_Factors:  [9.69915375e+01 4.23752035e-02]
mat_Sqrt:  [[ 1.99659391e+01  0.00000000e+00]
 [-8.23409532e-03  1.88666825e-02]]
grads:  [0.00921781 2.05253728]
Stock Position:  0.009217810015626427
Bond Position:  [-8.19505462]


portfolio before change:  [-7.31745459]
curr_Stock_Price:  95.31813626198266
curr_Factors:  [9.53181363e+01 4.27780232e-02]
mat_Sqrt:  [[ 1.9714506e+01  0.0000000e+00]
 [-8.2731395e-03  1.8956144e-02]]
grads:  [9.03708167e-03 9.22853268e+00]
Stock Position:  0.00903708166775481
Bond Position:  [-8.17885238]


portfolio before change:  [-7.32156019]
curr_Stock_Price:  94.97696665001718
curr_Factors:  [9.49769667e+01 4.19580665e-02]
mat_Sqrt:  [[ 1.94547668e+01  0.00000000e+00]
 [-8.19346730e-03  1.87735921e-02]]
grads:  [-0.00616403  5.59945989]
Stock Position:  -0.006164030286963135
Bond Position:  [-6.73611929]


portfolio before change:  [-7.32351138]
curr_Stock_Price:  95.15690062661028
curr_Factors:  [9.51569006e+01 4.28289370e-02]
mat_Sqrt:  [[ 1.96928665e+01  0.00000000e+00]
 [-8.27806132e-03  1.89674213e-02]]
grads:  [-0.01403338  0.08414045]
Stock Position:  -0.014033384533693918
Bond Position:  [-5.988138]


portfolio before change:  [-7.32607956]
curr_Stock_Price:  95.28656396258323
curr_Factors:  [9.52865640e+01 4.08378289e-02]
mat_Sqrt:  [[ 1.92558631e+01  0.00000000e+00]
 [-8.08334871e-03  1.85212787e-02]]
grads:  [ 0.00741006 -4.79020094]
Stock Position:  0.0074100603065907385
Bond Position:  [-8.03215874]


portfolio before change:  [-7.3397275]
curr_Stock_Price:  93.58025400770555
curr_Factors:  [9.35802540e+01 4.12993649e-02]
mat_Sqrt:  [[ 1.90176087e+01  0.00000000e+00]
 [-8.12889807e-03  1.86256454e-02]]
grads:  [-0.0720241  -7.89362118]
Stock Position:  -0.07202410361642457
Bond Position:  [-0.59969359]


portfolio before change:  [-7.36123902]
curr_Stock_Price:  93.87788426709778
curr_Factors:  [9.38778843e+01 4.01100765e-02]
mat_Sqrt:  [[ 1.88013935e+01  0.00000000e+00]
 [-8.01100009e-03  1.83555071e-02]]
grads:  [1.22786063e-02 1.72758411e+01]
Stock Position:  0.012278606292999117
Bond Position:  [-8.5139286]


portfolio before change:  [-7.3734091]
curr_Stock_Price:  92.97340302915097
curr_Factors:  [9.29734030e+01 4.18987467e-02]
mat_Sqrt:  [[ 1.90308963e+01  0.00000000e+00]
 [-8.18767334e-03  1.87603164e-02]]
grads:  [-2.93184723e-03 -7.00907824e+00]
Stock Position:  -0.0029318472333214364
Bond Position:  [-7.10082528]


portfolio before change:  [-7.37333511]
curr_Stock_Price:  92.64540496404517
curr_Factors:  [9.26454050e+01 4.30177759e-02]
mat_Sqrt:  [[ 1.92153306e+01  0.00000000e+00]
 [-8.29629082e-03  1.90091903e-02]]
grads:  [1.15443152e-03 3.08419241e+00]
Stock Position:  0.001154431515337713
Bond Position:  [-7.48028789]


portfolio before change:  [-7.37396284]
curr_Stock_Price:  92.91165441228645
curr_Factors:  [9.29116544e+01 4.29526887e-02]
mat_Sqrt:  [[ 1.92559687e+01  0.00000000e+00]
 [-8.29001218e-03  1.89948042e-02]]
grads:  [2.31143919e-03 8.85331838e+00]
Stock Position:  0.002311439192430318
Bond Position:  [-7.58872248]


portfolio before change:  [-7.37589921]
curr_Stock_Price:  92.48433777890001
curr_Factors:  [9.24843378e+01 4.23173004e-02]
mat_Sqrt:  [[ 1.90251096e+01  0.00000000e+00]
 [-8.22846769e-03  1.88537880e-02]]
grads:  [-0.10352143 -0.87237799]
Stock Position:  -0.10352142680852855
Bond Position:  [2.1982114]


portfolio before change:  [-7.31646901]
curr_Stock_Price:  91.91290625564473
curr_Factors:  [9.19129063e+01 4.22822005e-02]
mat_Sqrt:  [[ 1.88997165e+01  0.00000000e+00]
 [-8.22505445e-03  1.88459673e-02]]
grads:  [-1.66170350e-03  8.78309514e+00]
Stock Position:  -0.001661703504884401
Bond Position:  [-7.16373701]


portfolio before change:  [-7.31734574]
curr_Stock_Price:  91.90159799410561
curr_Factors:  [9.19015980e+01 4.28493382e-02]
mat_Sqrt:  [[ 1.90237059e+01  0.00000000e+00]
 [-8.28003267e-03  1.89719382e-02]]
grads:  [-0.00725251 -0.34400855]
Stock Position:  -0.00725250539981321
Bond Position:  [-6.6508289]


portfolio before change:  [-7.32641061]
curr_Stock_Price:  93.03685543918714
curr_Factors:  [9.30368554e+01 4.24128882e-02]
mat_Sqrt:  [[ 1.91603725e+01  0.00000000e+00]
 [-8.23775583e-03  1.88750698e-02]]
grads:  [ 0.06484138 -2.65346334]
Stock Position:  0.06484138311394581
Bond Position:  [-13.35904899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.34116439]
Stock Price:  92.83507378737812
PL:  [-7.34116439]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 4.07110450e-01  7.72537150e-01]
 [-3.56668561e-01 -3.57882842e-02]
 [ 9.51543427e-01 -8.61680865e-01]
 [-1.49181128e-01  1.07985319e-01]
 [-1.79841263e-01  1.14964658e-01]
 [ 4.35782040e-01  3.76600060e-01]
 [ 1.78901675e-01 -3.20611250e-01]
 [ 5.29805420e-01 -2.32519527e-02]
 [-1.42007144e-01 -8.90605638e-03]
 [ 6.25072818e-01 -5.11187203e-01]
 [ 5.65052325e-02 -2.78191430e-02]
 [-3.51979846e-01 -2.11923830e-01]
 [-1.25812717e-01  1.26361277e-01]
 [-8.39624745e-01 -1.21719073e+00]
 [-8.72891322e-02 -5.07778364e-01]
 [-2.61418228e-02 -1.98858046e-01]
 [-5.10279832e-02  1.61456263e-01]
 [ 1.26553651e-01  1.57146700e-01]
 [ 1.67198716e-02  2.06491154e-02]
 [-1.14738477e-01 -2.47443453e-02]
 [ 2.07998055e-01  5.19014423e-01]
 [-2.32137525e-02  2.64063968e-01]
 [-1.47889273e-02 -4.14915398e-01]
 [ 1.83748704e-01  2.20371373e-01]
 [ 1.13131214e-01  2.28306654e-01]
 [ 8.94463689e-01 -1.11700462e+00]
 [-1.18472219e+00  1.37173052e+00]
 [ 3.64954699e-02 -2.00661320e-02]
 [-6.34636170e-02 -4.50310355e-02]
 [ 1.56494785e-01 -2.88500976e-02]
 [-1.37306264e-01 -1.41740820e-01]
 [ 3.32001710e-01 -3.97011756e-02]
 [ 3.79430483e-01  5.19403282e-01]
 [ 2.93335872e-01 -6.57085659e-03]
 [-1.00512280e-01 -3.39273055e-01]
 [ 1.86284958e-01 -6.96764836e-02]
 [-3.97173878e-01  4.19522161e-02]
 [-1.06721665e-01  6.91284815e-02]
 [-3.81364022e-01  1.83081150e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.66005672]
curr_Stock_Price:  101.3483554721174
curr_Factors:  [1.01348355e+02 4.03453325e-02]
mat_Sqrt:  [[ 2.03569803e+01  0.00000000e+00]
 [-8.03445904e-03  1.84092584e-02]]
grads:  [3.65610859e-02 4.19645993e+01]
Stock Position:  0.03656108588863462
Bond Position:  [7.95465079]


portfolio before change:  [11.73842987]
curr_Stock_Price:  103.4647792494302
curr_Factors:  [1.03464779e+02 3.80793633e-02]
mat_Sqrt:  [[ 2.01900491e+01  0.00000000e+00]
 [-7.80557373e-03  1.78848162e-02]]
grads:  [-0.01843918 -2.00104288]
Stock Position:  -0.018439175031234597
Bond Position:  [13.64623504]


portfolio before change:  [11.7349213]
curr_Stock_Price:  103.74757118676365
curr_Factors:  [1.03747571e+02 3.67773304e-02]
mat_Sqrt:  [[ 1.98961038e+01  0.00000000e+00]
 [-7.67096660e-03  1.75763925e-02]]
grads:  [ 2.89240080e-02 -4.90248987e+01]
Stock Position:  0.028924008000241676
Bond Position:  [8.73412572]


portfolio before change:  [11.75626215]
curr_Stock_Price:  104.44764738953221
curr_Factors:  [1.04447647e+02 3.67745706e-02]
mat_Sqrt:  [[ 2.00296088e+01  0.00000000e+00]
 [-7.67067879e-03  1.75757331e-02]]
grads:  [-5.09508057e-03  6.14400087e+00]
Stock Position:  -0.005095080565247527
Bond Position:  [12.28843133]


portfolio before change:  [11.75512152]
curr_Stock_Price:  104.9730124959831
curr_Factors:  [1.04973012e+02 3.48625023e-02]
mat_Sqrt:  [[ 1.96000391e+01  0.00000000e+00]
 [-7.46860119e-03  1.71127151e-02]]
grads:  [-6.61562826e-03  6.71808401e+00]
Stock Position:  -0.006615628260259064
Bond Position:  [12.44958395]


portfolio before change:  [11.75251962]
curr_Stock_Price:  105.60155373075214
curr_Factors:  [1.05601554e+02 3.42164896e-02]
mat_Sqrt:  [[ 1.95338583e+01  0.00000000e+00]
 [-7.39907990e-03  1.69534218e-02]]
grads:  [ 0.03072326 22.2138081 ]
Stock Position:  0.03072325860845961
Bond Position:  [8.50809577]


portfolio before change:  [11.74298032]
curr_Stock_Price:  105.25644452155188
curr_Factors:  [1.05256445e+02 3.40310222e-02]
mat_Sqrt:  [[ 1.94171816e+01  0.00000000e+00]
 [-7.37899963e-03  1.69074122e-02]]
grads:  [ 2.00726629e-03 -1.89627630e+01]
Stock Position:  0.0020072662850158613
Bond Position:  [11.53170261]


portfolio before change:  [11.74417624]
curr_Stock_Price:  105.13407276072087
curr_Factors:  [1.05134073e+02 3.33715950e-02]
mat_Sqrt:  [[ 1.92057809e+01  0.00000000e+00]
 [-7.30715759e-03  1.67428014e-02]]
grads:  [ 0.02705734 -1.38877313]
Stock Position:  0.027057344763954504
Bond Position:  [8.89952739]


portfolio before change:  [11.73098629]
curr_Stock_Price:  104.60547466478017
curr_Factors:  [1.04605475e+02 3.45299491e-02]
mat_Sqrt:  [[ 1.94380361e+01  0.00000000e+00]
 [-7.43289436e-03  1.70309005e-02]]
grads:  [-0.0075056  -0.52293514]
Stock Position:  -0.007505597044200333
Bond Position:  [12.51611283]


portfolio before change:  [11.72463208]
curr_Stock_Price:  105.6605304982059
curr_Factors:  [1.05660530e+02 3.42362692e-02]
mat_Sqrt:  [[ 1.95504160e+01  0.00000000e+00]
 [-7.40121820e-03  1.69583213e-02]]
grads:  [ 2.05608122e-02 -3.01437385e+01]
Stock Position:  0.020560812177570227
Bond Position:  [9.55216575]


portfolio before change:  [11.72343201]
curr_Stock_Price:  105.54408742203333
curr_Factors:  [1.05544087e+02 3.43802828e-02]
mat_Sqrt:  [[ 1.95699011e+01  0.00000000e+00]
 [-7.41676833e-03  1.69939511e-02]]
grads:  [ 0.00226695 -1.63700265]
Stock Position:  0.0022669487622428274
Bond Position:  [11.48416897]


portfolio before change:  [11.72425986]
curr_Stock_Price:  105.27599214173424
curr_Factors:  [1.05275992e+02 3.26038432e-02]
mat_Sqrt:  [[ 1.90091957e+01  0.00000000e+00]
 [-7.22261374e-03  1.65490871e-02]]
grads:  [ -0.02338189 -12.80577162]
Stock Position:  -0.02338189346558576
Bond Position:  [14.18581189]


portfolio before change:  [11.70125824]
curr_Stock_Price:  106.33557104684635
curr_Factors:  [1.06335571e+02 3.25238301e-02]
mat_Sqrt:  [[ 1.91769444e+01  0.00000000e+00]
 [-7.21374578e-03  1.65287680e-02]]
grads:  [-3.68484849e-03  7.64493013e+00]
Stock Position:  -0.0036848484947992377
Bond Position:  [12.09308871]


portfolio before change:  [11.70432886]
curr_Stock_Price:  105.91251597636985
curr_Factors:  [1.05912516e+02 3.37425782e-02]
mat_Sqrt:  [[ 1.94552321e+01  0.00000000e+00]
 [-7.34766120e-03  1.68356068e-02]]
grads:  [-7.04617825e-02 -7.22985959e+01]
Stock Position:  -0.07046178253773648
Bond Position:  [19.16711353]


portfolio before change:  [11.7138732]
curr_Stock_Price:  105.81106659844986
curr_Factors:  [1.05811067e+02 3.27419963e-02]
mat_Sqrt:  [[ 1.91462476e+01  0.00000000e+00]
 [-7.23789984e-03  1.65841119e-02]]
grads:  [-1.61338026e-02 -3.06183632e+01]
Stock Position:  -0.016133802604840212
Bond Position:  [13.42100807]


portfolio before change:  [11.71634622]
curr_Stock_Price:  105.76177327170289
curr_Factors:  [1.05761773e+02 3.20754226e-02]
mat_Sqrt:  [[ 1.89415239e+01  0.00000000e+00]
 [-7.16384507e-03  1.64144311e-02]]
grads:  [-5.96206459e-03 -1.21148302e+01]
Stock Position:  -0.005962064588779606
Bond Position:  [12.34690475]


portfolio before change:  [11.72043641]
curr_Stock_Price:  105.33461854411743
curr_Factors:  [1.05334619e+02 3.30640990e-02]
mat_Sqrt:  [[ 1.91535585e+01  0.00000000e+00]
 [-7.27341449e-03  1.66654862e-02]]
grads:  [1.01481439e-03 9.68806192e+00]
Stock Position:  0.001014814390277925
Bond Position:  [11.61354132]


portfolio before change:  [11.72221227]
curr_Stock_Price:  105.65396865793738
curr_Factors:  [1.05653969e+02 3.21704801e-02]
mat_Sqrt:  [[ 1.89502344e+01  0.00000000e+00]
 [-7.17445246e-03  1.64387357e-02]]
grads:  [0.0102974  9.55953685]
Stock Position:  0.01029739735453224
Bond Position:  [10.63425137]


portfolio before change:  [11.73171708]
curr_Stock_Price:  106.44790155937122
curr_Factors:  [1.06447902e+02 3.20357801e-02]
mat_Sqrt:  [[ 1.90526222e+01  0.00000000e+00]
 [-7.15941675e-03  1.64042846e-02]]
grads:  [0.00135057 1.25876354]
Stock Position:  0.0013505691826069827
Bond Position:  [11.58795182]


portfolio before change:  [11.73414002]
curr_Stock_Price:  107.16934180802976
curr_Factors:  [1.07169342e+02 3.20600838e-02]
mat_Sqrt:  [[ 1.91890242e+01  0.00000000e+00]
 [-7.16213195e-03  1.64105059e-02]]
grads:  [-0.00654217 -1.50783562]
Stock Position:  -0.006542166699952222
Bond Position:  [12.43525972]


portfolio before change:  [11.73430763]
curr_Stock_Price:  107.3813351000822
curr_Factors:  [1.07381335e+02 3.41464371e-02]
mat_Sqrt:  [[ 1.98427334e+01  0.00000000e+00]
 [-7.39150184e-03  1.69360583e-02]]
grads:  [2.18979165e-02 3.06455264e+01]
Stock Position:  0.021897916540656277
Bond Position:  [9.38288011]


portfolio before change:  [11.74763887]
curr_Stock_Price:  107.93656165096438
curr_Factors:  [1.07936562e+02 3.51128687e-02]
mat_Sqrt:  [[ 2.02256150e+01  0.00000000e+00]
 [-7.49537124e-03  1.71740530e-02]]
grads:  [4.55032944e-03 1.53757513e+01]
Stock Position:  0.00455032943927261
Bond Position:  [11.25649195]


portfolio before change:  [11.74786806]
curr_Stock_Price:  107.67768909935131
curr_Factors:  [1.07677689e+02 3.41149130e-02]
mat_Sqrt:  [[ 1.98883091e+01  0.00000000e+00]
 [-7.38808912e-03  1.69282388e-02]]
grads:  [-9.84864283e-03 -2.45102519e+01]
Stock Position:  -0.009848642833999588
Bond Position:  [12.80834716]


portfolio before change:  [11.73731712]
curr_Stock_Price:  108.91157335423962
curr_Factors:  [1.08911573e+02 3.33969445e-02]
mat_Sqrt:  [[ 1.99034059e+01  0.00000000e+00]
 [-7.30993237e-03  1.67491592e-02]]
grads:  [ 0.01406426 13.15716035]
Stock Position:  0.014064259036570423
Bond Position:  [10.20555654]


portfolio before change:  [11.74686551]
curr_Stock_Price:  109.49977467379397
curr_Factors:  [1.09499775e+02 3.26929788e-02]
mat_Sqrt:  [[ 1.97988731e+01  0.00000000e+00]
 [-7.23247994e-03  1.65716934e-02]]
grads:  [1.07466928e-02 1.37769055e+01]
Stock Position:  0.010746692801758408
Bond Position:  [10.57010507]


portfolio before change:  [11.76730817]
curr_Stock_Price:  111.27904947068896
curr_Factors:  [1.11279049e+02 3.15936623e-02]
mat_Sqrt:  [[ 1.97794128e+01  0.00000000e+00]
 [-7.10984246e-03  1.62906956e-02]]
grads:  [ 2.05750752e-02 -6.85670304e+01]
Stock Position:  0.02057507518679639
Bond Position:  [9.47773336]


portfolio before change:  [11.77628933]
curr_Stock_Price:  111.6579725198627
curr_Factors:  [1.11657973e+02 3.22152560e-02]
mat_Sqrt:  [[ 2.00410528e+01  0.00000000e+00]
 [-7.17944355e-03  1.64501718e-02]]
grads:  [-2.92424715e-02  8.33870029e+01]
Stock Position:  -0.02924247145279271
Bond Position:  [15.04144441]


portfolio before change:  [11.77145352]
curr_Stock_Price:  111.8876423857356
curr_Factors:  [1.11887642e+02 3.16977723e-02]
mat_Sqrt:  [[ 1.99203284e+01  0.00000000e+00]
 [-7.12154728e-03  1.63175147e-02]]
grads:  [ 0.00139244 -1.22972967]
Stock Position:  0.0013924414977160896
Bond Position:  [11.61565652]


portfolio before change:  [11.77292533]
curr_Stock_Price:  111.90183811002214
curr_Factors:  [1.11901838e+02 3.09548353e-02]
mat_Sqrt:  [[ 1.96879941e+01  0.00000000e+00]
 [-7.03759451e-03  1.61251548e-02]]
grads:  [-0.0042217  -2.79259555]
Stock Position:  -0.004221698358611287
Bond Position:  [12.24534114]


portfolio before change:  [11.77570509]
curr_Stock_Price:  111.60598658771747
curr_Factors:  [1.11605987e+02 3.21199947e-02]
mat_Sqrt:  [[ 2.00020829e+01  0.00000000e+00]
 [-7.16882079e-03  1.64258320e-02]]
grads:  [ 0.00719443 -1.75638578]
Stock Position:  0.00719442922614847
Bond Position:  [10.97276372]


portfolio before change:  [11.77293838]
curr_Stock_Price:  111.03076503613252
curr_Factors:  [1.11030765e+02 3.09712678e-02]
mat_Sqrt:  [[ 1.95399219e+01  0.00000000e+00]
 [-7.03946223e-03  1.61294343e-02]]
grads:  [-0.01019283 -8.7877118 ]
Stock Position:  -0.01019282627896223
Bond Position:  [12.90465568]


portfolio before change:  [11.76300239]
curr_Stock_Price:  112.1638337916221
curr_Factors:  [1.12163834e+02 3.04564579e-02]
mat_Sqrt:  [[ 1.95745840e+01  0.00000000e+00]
 [-6.98071147e-03  1.59948194e-02]]
grads:  [ 0.01607568 -2.48212716]
Stock Position:  0.016075677315526535
Bond Position:  [9.95989279]


portfolio before change:  [11.75655794]
curr_Stock_Price:  111.68550166605546
curr_Factors:  [1.11685502e+02 3.02706153e-02]
mat_Sqrt:  [[ 1.94315491e+01  0.00000000e+00]
 [-6.95938104e-03  1.59459452e-02]]
grads:  [3.11924004e-02 3.25727497e+01]
Stock Position:  0.03119240042441641
Bond Position:  [8.27281905]


portfolio before change:  [11.7801047]
curr_Stock_Price:  112.40723480463181
curr_Factors:  [1.12407235e+02 2.99649535e-02]
mat_Sqrt:  [[ 1.94581286e+01  0.00000000e+00]
 [-6.92415523e-03  1.58652327e-02]]
grads:  [ 0.01492785 -0.41416705]
Stock Position:  0.0149278546496015
Bond Position:  [10.10210584]


portfolio before change:  [11.81103697]
curr_Stock_Price:  114.39475625088382
curr_Factors:  [1.14394756e+02 2.97538919e-02]
mat_Sqrt:  [[ 1.97323136e+01  0.00000000e+00]
 [-6.89972660e-03  1.58092597e-02]]
grads:  [-1.25977716e-02 -2.14604011e+01]
Stock Position:  -0.012597771645588238
Bond Position:  [13.25215599]


portfolio before change:  [11.81400383]
curr_Stock_Price:  114.29075084304492
curr_Factors:  [1.14290751e+02 3.03812897e-02]
mat_Sqrt:  [[ 1.99211401e+01  0.00000000e+00]
 [-6.97209176e-03  1.59750691e-02]]
grads:  [ 0.00782463 -4.36157635]
Stock Position:  0.007824634870079842
Bond Position:  [10.91972044]


portfolio before change:  [11.81687907]
curr_Stock_Price:  114.48375557921518
curr_Factors:  [1.14483756e+02 2.94089056e-02]
mat_Sqrt:  [[ 1.96328478e+01  0.00000000e+00]
 [-6.85960998e-03  1.57173410e-02]]
grads:  [-0.01929748  2.66916752]
Stock Position:  -0.019297477054017326
Bond Position:  [14.02612672]


portfolio before change:  [11.81695631]
curr_Stock_Price:  114.57061326607165
curr_Factors:  [1.14570613e+02 3.08110679e-02]
mat_Sqrt:  [[ 2.01106734e+01  0.00000000e+00]
 [-7.02123270e-03  1.60876652e-02]]
grads:  [-3.80651214e-03  4.29698659e+00]
Stock Position:  -0.003806512141675631
Bond Position:  [12.25307075]


portfolio before change:  [11.81692802]
curr_Stock_Price:  114.98044443048241
curr_Factors:  [1.14980444e+02 3.04729101e-02]
mat_Sqrt:  [[ 2.00715517e+01  0.00000000e+00]
 [-6.98259667e-03  1.59991389e-02]]
grads:  [-0.01501931 11.44318776]
Stock Position:  -0.015019310011305794
Bond Position:  [13.54385496]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.81434682]
Stock Price:  115.2650303554229
PL:  [-3.45068354]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.15788621e-01  1.17553582e-01]
 [-1.64667814e-01 -8.74803094e-02]
 [ 8.22463891e-01 -7.07368565e-01]
 [-1.59715974e-03  2.44915003e-02]
 [-1.42359939e-01  6.03337862e-02]
 [ 2.30681856e-01  2.12727143e-01]
 [ 1.42280570e-01 -1.19177417e-01]
 [ 5.22800707e-01 -2.26151393e-02]
 [-1.95967265e-01 -4.01248958e-02]
 [ 5.26605346e-01 -3.85637441e-01]
 [ 6.09651952e-02 -1.00389737e-02]
 [-8.69573669e-02 -1.72210525e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-6.13393347e-01 -7.75921424e-01]
 [ 3.22989029e-02  2.49512185e-02]
 [ 5.50185235e-02 -2.10532266e-02]
 [-5.28708103e-02  2.65047542e-01]
 [-1.21879847e-01  4.00872176e-02]
 [ 1.48562488e-02  6.69231525e-02]
 [-1.01751810e-01 -3.50897281e-02]
 [ 2.27746097e-01  2.73587036e-01]
 [ 1.97239506e-02  1.17141268e-01]
 [-1.19390188e-02 -1.68474416e-01]
 [ 1.41515109e-01  2.05981060e-01]
 [ 8.28876584e-02  1.72026270e-01]
 [ 7.82730639e-01 -6.16208952e-01]
 [-7.10387729e-01  8.71747014e-01]
 [ 1.23027553e-01 -1.16964604e-02]
 [-5.04473983e-02 -5.92556040e-02]
 [ 8.01979464e-02 -2.06532670e-01]
 [ 8.07369818e-02 -6.60764386e-02]
 [ 1.14168322e-01 -1.22509598e-02]
 [ 2.42957665e-01  2.91983140e-01]
 [ 2.14713014e-01  3.37661397e-02]
 [-2.05793895e-01 -2.34259524e-01]
 [ 1.68164210e-01 -1.21239933e-01]
 [-1.75642398e-01  2.03295606e-01]
 [-1.20461449e-01  1.19786779e-01]
 [-5.46739389e-02  1.13602894e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.03481066]
curr_Stock_Price:  99.43630297337343
curr_Factors:  [9.94363030e+01 4.08132124e-02]
mat_Sqrt:  [[ 2.00884005e+01  0.00000000e+00]
 [-8.08091207e-03  1.85156956e-02]]
grads:  [-3.21001325e-03  6.34886124e+00]
Stock Position:  -0.0032100132476706052
Bond Position:  [-0.71561881]


portfolio before change:  [-1.03463062]
curr_Stock_Price:  99.35234858662574
curr_Factors:  [9.93523486e+01 4.08502316e-02]
mat_Sqrt:  [[ 2.00805406e+01  0.00000000e+00]
 [-8.08457609e-03  1.85240910e-02]]
grads:  [-0.01010169 -4.72251565]
Stock Position:  -0.010101687780522324
Bond Position:  [-0.03100421]


portfolio before change:  [-1.03564155]
curr_Stock_Price:  99.45204048986915
curr_Factors:  [9.94520405e+01 3.99859192e-02]
mat_Sqrt:  [[ 1.98869069e+01  0.00000000e+00]
 [-7.99859180e-03  1.83270762e-02]]
grads:  [ 2.58332249e-02 -3.85969130e+01]
Stock Position:  0.025833224934720286
Bond Position:  [-3.60480848]


portfolio before change:  [-1.00943072]
curr_Stock_Price:  100.48410129126904
curr_Factors:  [1.00484101e+02 3.90009714e-02]
mat_Sqrt:  [[ 1.98442671e+01  0.00000000e+00]
 [-7.89946544e-03  1.80999492e-02]]
grads:  [4.58157877e-04 1.35312536e+00]
Stock Position:  0.0004581578774816342
Bond Position:  [-1.0554683]


portfolio before change:  [-1.00874767]
curr_Stock_Price:  102.26295805552763
curr_Factors:  [1.02262958e+02 3.81810668e-02]
mat_Sqrt:  [[ 1.99821576e+01  0.00000000e+00]
 [-7.81599046e-03  1.79086840e-02]]
grads:  [-0.00580659  3.36896817]
Stock Position:  -0.0058065859357456125
Bond Position:  [-0.41494901]


portfolio before change:  [-1.01818156]
curr_Stock_Price:  103.87871418873053
curr_Factors:  [1.03878714e+02 3.65647202e-02]
mat_Sqrt:  [[ 1.98635877e+01  0.00000000e+00]
 [-7.64876149e-03  1.75255143e-02]]
grads:  [ 0.01628727 12.13813987]
Stock Position:  0.016287268815960248
Bond Position:  [-2.71008211]


portfolio before change:  [-1.01290707]
curr_Stock_Price:  104.22335602912372
curr_Factors:  [1.04223356e+02 3.72469011e-02]
mat_Sqrt:  [[ 2.01145410e+01  0.00000000e+00]
 [-7.71978249e-03  1.76882438e-02]]
grads:  [ 4.48766300e-03 -6.73766249e+00]
Stock Position:  0.004487662997228814
Bond Position:  [-1.48062637]


portfolio before change:  [-1.00943521]
curr_Stock_Price:  105.03824669745511
curr_Factors:  [1.05038247e+02 3.66391564e-02]
mat_Sqrt:  [[ 2.01057462e+01  0.00000000e+00]
 [-7.65654296e-03  1.75433438e-02]]
grads:  [ 0.02551164 -1.28910084]
Stock Position:  0.02551164454207551
Bond Position:  [-3.68913362]


portfolio before change:  [-1.00892141]
curr_Stock_Price:  105.07646340146457
curr_Factors:  [1.05076463e+02 3.80415482e-02]
mat_Sqrt:  [[ 2.04943684e+01  0.00000000e+00]
 [-7.80169707e-03  1.78759337e-02]]
grads:  [-0.01041648 -2.24463217]
Stock Position:  -0.010416481299620214
Bond Position:  [0.08560561]


portfolio before change:  [-1.00021117]
curr_Stock_Price:  104.24129294947907
curr_Factors:  [1.04241293e+02 3.93283287e-02]
mat_Sqrt:  [[ 2.06724778e+01  0.00000000e+00]
 [-7.93254852e-03  1.81757520e-02]]
grads:  [ 1.73321926e-02 -2.12171381e+01]
Stock Position:  0.017332192631820512
Bond Position:  [-2.80694134]


portfolio before change:  [-1.01117562]
curr_Stock_Price:  103.62893198542274
curr_Factors:  [1.03628932e+02 4.06509865e-02]
mat_Sqrt:  [[ 2.08937583e+01  0.00000000e+00]
 [-8.06483592e-03  1.84788605e-02]]
grads:  [ 0.00270817 -0.543268  ]
Stock Position:  0.002708168964255477
Bond Position:  [-1.29182027]


portfolio before change:  [-1.01164669]
curr_Stock_Price:  103.51461620352352
curr_Factors:  [1.03514616e+02 4.07515776e-02]
mat_Sqrt:  [[ 2.08965163e+01  0.00000000e+00]
 [-8.07480799e-03  1.85017094e-02]]
grads:  [-7.75804922e-03 -9.30781696e+00]
Stock Position:  -0.007758049220212197
Bond Position:  [-0.2085752]


portfolio before change:  [-1.00693469]
curr_Stock_Price:  102.90388570421376
curr_Factors:  [1.02903886e+02 4.10858170e-02]
mat_Sqrt:  [[ 2.08582437e+01  0.00000000e+00]
 [-8.10785466e-03  1.85774289e-02]]
grads:  [-5.79110211e-03  8.91036364e+00]
Stock Position:  -0.005791102110559926
Bond Position:  [-0.41100778]


portfolio before change:  [-1.00673111]
curr_Stock_Price:  102.85985970465326
curr_Factors:  [1.02859860e+02 4.03637798e-02]
mat_Sqrt:  [[ 2.06653061e+01  0.00000000e+00]
 [-8.03629564e-03  1.84134665e-02]]
grads:  [ -0.04606916 -42.13880217]
Stock Position:  -0.04606915653177887
Bond Position:  [3.73193587]


portfolio before change:  [-1.01028156]
curr_Stock_Price:  102.94705418254698
curr_Factors:  [1.02947054e+02 3.96079034e-02]
mat_Sqrt:  [[ 2.04882493e+01  0.00000000e+00]
 [-7.96069378e-03  1.82402409e-02]]
grads:  [0.00210796 1.36792154]
Stock Position:  0.002107964749501181
Bond Position:  [-1.22729032]


portfolio before change:  [-1.01307794]
curr_Stock_Price:  101.6932584645627
curr_Factors:  [1.01693258e+02 3.98283022e-02]
mat_Sqrt:  [[ 2.02949535e+01  0.00000000e+00]
 [-7.98281175e-03  1.82909196e-02]]
grads:  [ 0.0022582  -1.15102068]
Stock Position:  0.0022582038500404077
Bond Position:  [-1.24272205]


portfolio before change:  [-1.01226424]
curr_Stock_Price:  102.12238355246052
curr_Factors:  [1.02122384e+02 3.93062434e-02]
mat_Sqrt:  [[ 2.02465818e+01  0.00000000e+00]
 [-7.93032089e-03  1.81706479e-02]]
grads:  [3.10202587e-03 1.45865763e+01]
Stock Position:  0.0031020258712732606
Bond Position:  [-1.32905051]


portfolio before change:  [-1.01434673]
curr_Stock_Price:  101.50460873228663
curr_Factors:  [1.01504609e+02 3.87180767e-02]
mat_Sqrt:  [[ 1.99729700e+01  0.00000000e+00]
 [-7.87076379e-03  1.80341854e-02]]
grads:  [-0.00522628  2.22284604]
Stock Position:  -0.005226280872752499
Bond Position:  [-0.48385514]


portfolio before change:  [-1.02008564]
curr_Stock_Price:  102.59112240451417
curr_Factors:  [1.02591122e+02 3.73818689e-02]
mat_Sqrt:  [[ 1.98353691e+01  0.00000000e+00]
 [-7.73375654e-03  1.77202624e-02]]
grads:  [2.22148158e-03 3.77664569e+00]
Stock Position:  0.0022214815808430997
Bond Position:  [-1.24798993]


portfolio before change:  [-1.01746573]
curr_Stock_Price:  103.84070492527866
curr_Factors:  [1.03840705e+02 3.73361649e-02]
mat_Sqrt:  [[ 2.00646912e+01  0.00000000e+00]
 [-7.72902735e-03  1.77094264e-02]]
grads:  [-0.00583444 -1.98141527]
Stock Position:  -0.005834439289199016
Bond Position:  [-0.41161344]


portfolio before change:  [-1.01867703]
curr_Stock_Price:  104.03949805428967
curr_Factors:  [1.04039498e+02 3.63176779e-02]
mat_Sqrt:  [[ 1.98270127e+01  0.00000000e+00]
 [-7.62287903e-03  1.74662101e-02]]
grads:  [ 0.0175089  15.66378937]
Stock Position:  0.01750890435774858
Bond Position:  [-2.84029465]


portfolio before change:  [-0.99518559]
curr_Stock_Price:  105.40146202039418
curr_Factors:  [1.05401462e+02 3.47103347e-02]
mat_Sqrt:  [[ 1.96370405e+01  0.00000000e+00]
 [-7.45228392e-03  1.70753276e-02]]
grads:  [3.60790574e-03 6.86026474e+00]
Stock Position:  0.0036079057401365677
Bond Position:  [-1.37546413]


portfolio before change:  [-0.99408505]
curr_Stock_Price:  105.75415474277112
curr_Factors:  [1.05754155e+02 3.48001590e-02]
mat_Sqrt:  [[ 1.97282268e+01  0.00000000e+00]
 [-7.46192029e-03  1.70974073e-02]]
grads:  [-4.33223335e-03 -9.85379908e+00]
Stock Position:  -0.0043322333465513835
Bond Position:  [-0.53593338]


portfolio before change:  [-0.99938703]
curr_Stock_Price:  106.96253336215132
curr_Factors:  [1.06962533e+02 3.43199672e-02]
mat_Sqrt:  [[ 1.98155035e+01  0.00000000e+00]
 [-7.41025961e-03  1.69790378e-02]]
grads:  [1.16783615e-02 1.21314919e+01]
Stock Position:  0.011678361541016518
Bond Position:  [-2.24853416]


portfolio before change:  [-1.00252481]
curr_Stock_Price:  106.71791894329166
curr_Factors:  [1.06717919e+02 3.28177536e-02]
mat_Sqrt:  [[ 1.93326671e+01  0.00000000e+00]
 [-7.24626841e-03  1.66032867e-02]]
grads:  [8.17094077e-03 1.03609769e+01]
Stock Position:  0.008170940767742397
Bond Position:  [-1.8745106]


portfolio before change:  [-1.01302019]
curr_Stock_Price:  105.46212079147756
curr_Factors:  [1.05462121e+02 3.39070165e-02]
mat_Sqrt:  [[ 1.94196451e+01  0.00000000e+00]
 [-7.36554318e-03  1.68765796e-02]]
grads:  [ 2.64574868e-02 -3.65126683e+01]
Stock Position:  0.026457486781979442
Bond Position:  [-3.80328285]


portfolio before change:  [-0.95785747]
curr_Stock_Price:  107.56504766939459
curr_Factors:  [1.07565048e+02 3.31279048e-02]
mat_Sqrt:  [[ 1.95779925e+01  0.00000000e+00]
 [-7.28042909e-03  1.66815587e-02]]
grads:  [-1.68518882e-02  5.22581271e+01]
Stock Position:  -0.016851888177752638
Bond Position:  [0.85481669]


portfolio before change:  [-0.93308879]
curr_Stock_Price:  106.10160234077587
curr_Factors:  [1.06101602e+02 3.40862269e-02]
mat_Sqrt:  [[ 1.95889613e+01  0.00000000e+00]
 [-7.38498226e-03  1.69211201e-02]]
grads:  [ 0.00601986 -0.69123441]
Stock Position:  0.006019859708268228
Bond Position:  [-1.57180555]


portfolio before change:  [-0.93158994]
curr_Stock_Price:  106.38322611230357
curr_Factors:  [1.06383226e+02 3.45078036e-02]
mat_Sqrt:  [[ 1.97620419e+01  0.00000000e+00]
 [-7.43051047e-03  1.70254383e-02]]
grads:  [-0.00386138 -3.48041576]
Stock Position:  -0.0038613754863915904
Bond Position:  [-0.52080436]


portfolio before change:  [-0.93294217]
curr_Stock_Price:  106.71655859222912
curr_Factors:  [1.06716559e+02 3.38052612e-02]
mat_Sqrt:  [[ 1.96211275e+01  0.00000000e+00]
 [-7.35448285e-03  1.68512372e-02]]
grads:  [-5.06612103e-04 -1.22562319e+01]
Stock Position:  -0.0005066121030223026
Bond Position:  [-0.87887827]


portfolio before change:  [-0.9326605]
curr_Stock_Price:  105.94371357148236
curr_Factors:  [1.05943714e+02 3.57289709e-02]
mat_Sqrt:  [[ 2.00255958e+01  0.00000000e+00]
 [-7.56084343e-03  1.73240687e-02]]
grads:  [ 2.59162626e-03 -3.81414088e+00]
Stock Position:  0.0025916262558412753
Bond Position:  [-1.20722701]


portfolio before change:  [-0.93210659]
curr_Stock_Price:  106.2156776279391
curr_Factors:  [1.06215678e+02 3.64654172e-02]
mat_Sqrt:  [[ 2.02828611e+01  0.00000000e+00]
 [-7.63836812e-03  1.75017000e-02]]
grads:  [ 0.0053652  -0.69998685]
Stock Position:  0.005365197938286467
Bond Position:  [-1.50197472]


portfolio before change:  [-0.93090268]
curr_Stock_Price:  106.47506527734669
curr_Factors:  [1.06475065e+02 3.68258398e-02]
mat_Sqrt:  [[ 2.04326288e+01  0.00000000e+00]
 [-7.67602395e-03  1.75879804e-02]]
grads:  [ 0.01812736 16.60128868]
Stock Position:  0.0181273569098334
Bond Position:  [-2.86101419]


portfolio before change:  [-0.95201668]
curr_Stock_Price:  105.33003617489547
curr_Factors:  [1.05330036e+02 3.51820185e-02]
mat_Sqrt:  [[ 1.97566183e+01  0.00000000e+00]
 [-7.50274813e-03  1.71909556e-02]]
grads:  [0.01161382 1.96418049]
Stock Position:  0.011613817820065053
Bond Position:  [-2.17530053]


portfolio before change:  [-0.95115406]
curr_Stock_Price:  105.4277257314864
curr_Factors:  [1.05427726e+02 3.58731165e-02]
mat_Sqrt:  [[ 1.99682218e+01  0.00000000e+00]
 [-7.57607988e-03  1.73589798e-02]]
grads:  [ -0.01542617 -13.49500533]
Stock Position:  -0.01542616745959693
Bond Position:  [0.67519169]


portfolio before change:  [-0.96259565]
curr_Stock_Price:  106.1748970993898
curr_Factors:  [1.06174897e+02 3.59833797e-02]
mat_Sqrt:  [[ 2.01406195e+01  0.00000000e+00]
 [-7.58771425e-03  1.73856375e-02]]
grads:  [ 5.72230490e-03 -6.97356843e+00]
Stock Position:  0.005722304901248659
Bond Position:  [-1.57016078]


portfolio before change:  [-0.96626564]
curr_Stock_Price:  105.56784981153562
curr_Factors:  [1.05567850e+02 3.66920835e-02]
mat_Sqrt:  [[ 2.02217093e+01  0.00000000e+00]
 [-7.66207110e-03  1.75560104e-02]]
grads:  [-4.29819857e-03  1.15798294e+01]
Stock Position:  -0.004298198569251292
Bond Position:  [-0.51251406]


portfolio before change:  [-0.9582543]
curr_Stock_Price:  103.68906146029924
curr_Factors:  [1.03689061e+02 3.76016528e-02]
mat_Sqrt:  [[ 2.01064969e+01  0.00000000e+00]
 [-7.75645824e-03  1.77722785e-02]]
grads:  [-3.39105379e-03  6.74009123e+00]
Stock Position:  -0.0033910537886566307
Bond Position:  [-0.60663912]


portfolio before change:  [-0.95629528]
curr_Stock_Price:  103.08899619988667
curr_Factors:  [1.03088996e+02 3.76763936e-02]
mat_Sqrt:  [[ 2.00099947e+01  0.00000000e+00]
 [-7.76416317e-03  1.77899327e-02]]
grads:  [-2.54551352e-04  6.38579671e+00]
Stock Position:  -0.0002545513524669675
Bond Position:  [-0.93005384]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.95631091]
Stock Price:  102.69365091783115
PL:  [-3.64996183]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-3.93641658e-01 -1.81509144e-01]
 [-1.69127172e-01 -8.39291196e-02]
 [ 7.69226259e-01 -6.48940700e-01]
 [-1.73531033e-02  2.54431179e-02]
 [-1.11171143e-01  4.78517225e-02]
 [-2.31381990e-03  2.56357188e-02]
 [ 3.38610641e-02  2.46884460e-01]
 [ 3.37556950e-01 -7.02625572e-03]
 [ 2.36281723e-02  6.49653343e-02]
 [ 5.02390187e-01 -3.55481586e-01]
 [ 5.95548746e-02 -1.49085731e-02]
 [-1.13114995e-01 -1.86039904e-01]
 [-1.74098890e-01  1.55835322e-01]
 [-6.85553049e-01 -9.22429639e-01]
 [ 6.43442103e-05 -1.18620580e-01]
 [ 5.79667636e-02 -2.60432225e-02]
 [-5.26976156e-02  2.55311707e-01]
 [-7.40313275e-02  9.56429492e-02]
 [ 1.49134723e-02  6.55022824e-02]
 [-7.53522442e-02 -4.15477139e-02]
 [ 1.38547912e-01  4.46696169e-02]
 [ 5.23365631e-02  2.72882958e-01]
 [ 3.73526644e-02  3.59618028e-01]
 [-2.10295461e-02  1.46955149e-01]
 [ 2.66770662e-02  6.12973635e-02]
 [ 7.18079114e-01 -3.30641140e-01]
 [-1.36016726e-01  1.90374712e-01]
 [ 3.91536232e-02  3.69494726e-02]
 [ 1.28212664e-03 -1.07213059e-01]
 [-5.73651418e-02 -3.30685313e-02]
 [-5.87791221e-01 -9.56679911e-02]
 [-1.18015507e-01  3.11189892e-03]
 [ 8.91091728e-02  3.56079409e-02]
 [ 1.32970606e-01  7.57036029e-02]
 [-2.81927959e-01 -1.44413930e-01]
 [-3.97388989e-01 -3.56246410e-01]
 [-5.40524905e-02  3.03180130e-01]
 [-1.23726718e-01  1.17583961e-01]
 [ 2.27616822e-01  7.66996782e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.66094043]
curr_Stock_Price:  98.4383005826042
curr_Factors:  [9.84383006e+01 4.06870186e-02]
mat_Sqrt:  [[ 1.98560127e+01  0.00000000e+00]
 [-8.06840937e-03  1.84870483e-02]]
grads:  [-0.02381439 -9.81817867]
Stock Position:  -0.023814385631899047
Bond Position:  [-5.31669278]


portfolio before change:  [-7.70276631]
curr_Stock_Price:  100.16672037168455
curr_Factors:  [1.00166720e+02 4.04012329e-02]
mat_Sqrt:  [[ 2.01335688e+01  0.00000000e+00]
 [-8.04002318e-03  1.84220074e-02]]
grads:  [-0.01021959 -4.55591607]
Stock Position:  -0.010219591183741768
Bond Position:  [-6.67910338]


portfolio before change:  [-7.7093899]
curr_Stock_Price:  100.733147104883
curr_Factors:  [1.00733147e+02 3.95193426e-02]
mat_Sqrt:  [[ 2.00252183e+01  0.00000000e+00]
 [-7.95178899e-03  1.82198375e-02]]
grads:  [ 2.42696640e-02 -3.56172606e+01]
Stock Position:  0.024269663978587267
Bond Position:  [-10.15414954]


portfolio before change:  [-7.72463375]
curr_Stock_Price:  100.1573461141426
curr_Factors:  [1.00157346e+02 3.88976349e-02]
mat_Sqrt:  [[ 1.97535159e+01  0.00000000e+00]
 [-7.88899334e-03  1.80759546e-02]]
grads:  [-3.16339445e-04  1.40756704e+00]
Stock Position:  -0.0003163394449567025
Bond Position:  [-7.69295003]


portfolio before change:  [-7.72594037]
curr_Stock_Price:  101.2477706428004
curr_Factors:  [1.01247771e+02 3.89871219e-02]
mat_Sqrt:  [[ 1.99915311e+01  0.00000000e+00]
 [-7.89806274e-03  1.80967352e-02]]
grads:  [-0.00451626  2.64421853]
Stock Position:  -0.004516259313109389
Bond Position:  [-7.26867918]


portfolio before change:  [-7.72913459]
curr_Stock_Price:  101.75384783460767
curr_Factors:  [1.01753848e+02 3.76837132e-02]
mat_Sqrt:  [[ 1.97527554e+01  0.00000000e+00]
 [-7.76491733e-03  1.77916607e-02]]
grads:  [4.49280359e-04 1.44088397e+00]
Stock Position:  0.00044928035926875725
Bond Position:  [-7.77485059]


portfolio before change:  [-7.72994371]
curr_Stock_Price:  102.11618939420462
curr_Factors:  [1.02116189e+02 3.68939165e-02]
mat_Sqrt:  [[ 1.96142624e+01  0.00000000e+00]
 [-7.68311567e-03  1.76042296e-02]]
grads:  [7.21976046e-03 1.40241559e+01]
Stock Position:  0.0072197604586249665
Bond Position:  [-8.46719814]


portfolio before change:  [-7.72599463]
curr_Stock_Price:  102.80977862982621
curr_Factors:  [1.02809779e+02 3.67075645e-02]
mat_Sqrt:  [[ 1.96975499e+01  0.00000000e+00]
 [-7.66368731e-03  1.75597136e-02]]
grads:  [ 0.01698132 -0.40013498]
Stock Position:  0.016981322147371566
Bond Position:  [-9.4718406]


portfolio before change:  [-7.72145654]
curr_Stock_Price:  103.14674554270215
curr_Factors:  [1.03146746e+02 3.77014078e-02]
mat_Sqrt:  [[ 2.00278492e+01  0.00000000e+00]
 [-7.76674015e-03  1.77958373e-02]]
grads:  [2.59545436e-03 3.65059161e+00]
Stock Position:  0.0025954543620766092
Bond Position:  [-7.98916921]


portfolio before change:  [-7.72047815]
curr_Stock_Price:  103.90849890034869
curr_Factors:  [1.03908499e+02 3.68670932e-02]
mat_Sqrt:  [[ 1.99512688e+01  0.00000000e+00]
 [-7.68032221e-03  1.75978289e-02]]
grads:  [ 1.74046727e-02 -2.02003092e+01]
Stock Position:  0.017404672708654357
Bond Position:  [-9.52897157]


portfolio before change:  [-7.71371455]
curr_Stock_Price:  104.36554870371366
curr_Factors:  [1.04365549e+02 3.55577339e-02]
mat_Sqrt:  [[ 1.96799594e+01  0.00000000e+00]
 [-7.54270338e-03  1.72825046e-02]]
grads:  [ 0.00269555 -0.86263961]
Stock Position:  0.002695546200256656
Bond Position:  [-7.99503671]


portfolio before change:  [-7.71951678]
curr_Stock_Price:  102.58379874163319
curr_Factors:  [1.02583799e+02 3.57419898e-02]
mat_Sqrt:  [[ 1.93940335e+01  0.00000000e+00]
 [-7.56222082e-03  1.73272247e-02]]
grads:  [-1.00190332e-02 -1.07368553e+01]
Stock Position:  -0.010019033212775131
Bond Position:  [-6.69172629]


portfolio before change:  [-7.73053644]
curr_Stock_Price:  103.6001789477951
curr_Factors:  [1.03600179e+02 3.34349408e-02]
mat_Sqrt:  [[ 1.89435245e+01  0.00000000e+00]
 [-7.31408951e-03  1.67586844e-02]]
grads:  [-5.60016057e-03  9.29878013e+00]
Stock Position:  -0.0056001605746491415
Bond Position:  [-7.15035881]


portfolio before change:  [-7.7332546]
curr_Stock_Price:  103.92593823188582
curr_Factors:  [1.03925938e+02 3.15372631e-02]
mat_Sqrt:  [[ 1.84559309e+01  0.00000000e+00]
 [-7.10349358e-03  1.62761485e-02]]
grads:  [ -0.05895852 -56.67370497]
Stock Position:  -0.058958518846242675
Bond Position:  [-1.60593521]


portfolio before change:  [-7.7214944]
curr_Stock_Price:  103.72306764746783
curr_Factors:  [1.03723068e+02 3.22445894e-02]
mat_Sqrt:  [[ 1.86253215e+01  0.00000000e+00]
 [-7.18271140e-03  1.64576593e-02]]
grads:  [-2.77610892e-03 -7.20762153e+00]
Stock Position:  -0.0027761089154553333
Bond Position:  [-7.43354787]


portfolio before change:  [-7.71895858]
curr_Stock_Price:  102.4748903262279
curr_Factors:  [1.02474890e+02 3.35245712e-02]
mat_Sqrt:  [[ 1.87628617e+01  0.00000000e+00]
 [-7.32388653e-03  1.67811322e-02]]
grads:  [ 0.00248366 -1.55193477]
Stock Position:  0.0024836600180829574
Bond Position:  [-7.97347137]


portfolio before change:  [-7.72211748]
curr_Stock_Price:  101.60434062289029
curr_Factors:  [1.01604341e+02 3.30507159e-02]
mat_Sqrt:  [[ 1.84715227e+01  0.00000000e+00]
 [-7.27194234e-03  1.66621131e-02]]
grads:  [3.17946440e-03 1.53228889e+01]
Stock Position:  0.0031794643961421667
Bond Position:  [-8.04516486]


portfolio before change:  [-7.72055868]
curr_Stock_Price:  102.4109237657526
curr_Factors:  [1.02410924e+02 3.27986848e-02]
mat_Sqrt:  [[ 1.85470353e+01  0.00000000e+00]
 [-7.24416287e-03  1.65984623e-02]]
grads:  [-1.74094252e-03  5.76215719e+00]
Stock Position:  -0.0017409425153444838
Bond Position:  [-7.54226715]


portfolio before change:  [-7.72111883]
curr_Stock_Price:  102.19110143619098
curr_Factors:  [1.02191101e+02 3.32227095e-02]
mat_Sqrt:  [[ 1.86264720e+01  0.00000000e+00]
 [-7.29083913e-03  1.67054111e-02]]
grads:  [2.33544023e-03 3.92102188e+00]
Stock Position:  0.0023354402293288908
Bond Position:  [-7.95978003]


portfolio before change:  [-7.72314496]
curr_Stock_Price:  101.74960044011104
curr_Factors:  [1.01749600e+02 3.31702459e-02]
mat_Sqrt:  [[ 1.85313500e+01  0.00000000e+00]
 [-7.28508020e-03  1.66922157e-02]]
grads:  [-0.0050447  -2.48904727]
Stock Position:  -0.005044702799965427
Bond Position:  [-7.20984847]


portfolio before change:  [-7.71811815]
curr_Stock_Price:  100.5744876327997
curr_Factors:  [1.00574488e+02 3.26143947e-02]
mat_Sqrt:  [[ 1.81632052e+01  0.00000000e+00]
 [-7.22378236e-03  1.65517647e-02]]
grads:  [0.00870129 2.69878274]
Stock Position:  0.008701290803382692
Bond Position:  [-8.59324602]


portfolio before change:  [-7.71902939]
curr_Stock_Price:  100.59321868202649
curr_Factors:  [1.00593219e+02 3.25173485e-02]
mat_Sqrt:  [[ 1.81395399e+01  0.00000000e+00]
 [-7.21302694e-03  1.65271210e-02]]
grads:  [9.45076066e-03 1.65112217e+01]
Stock Position:  0.00945076065634149
Bond Position:  [-8.66971182]


portfolio before change:  [-7.72537808]
curr_Stock_Price:  100.03613007566216
curr_Factors:  [1.00036130e+02 3.22409708e-02]
mat_Sqrt:  [[ 1.79622583e+01  0.00000000e+00]
 [-7.18230835e-03  1.64567358e-02]]
grads:  [1.08172834e-02 2.18523304e+01]
Stock Position:  0.0108172834325075
Bond Position:  [-8.80749726]


portfolio before change:  [-7.72582787]
curr_Stock_Price:  100.09633220423233
curr_Factors:  [1.00096332e+02 3.10771447e-02]
mat_Sqrt:  [[ 1.76456930e+01  0.00000000e+00]
 [-7.05148435e-03  1.61569804e-02]]
grads:  [2.44291561e-03 9.09545875e+00]
Stock Position:  0.002442915611027622
Bond Position:  [-7.97035476]


portfolio before change:  [-7.72405229]
curr_Stock_Price:  101.2310124800582
curr_Factors:  [1.01231012e+02 3.07645637e-02]
mat_Sqrt:  [[ 1.77557475e+01  0.00000000e+00]
 [-7.01593201e-03  1.60755198e-02]]
grads:  [3.0091343e-03 3.8130875e+00]
Stock Position:  0.003009134298519023
Bond Position:  [-8.02867001]


portfolio before change:  [-7.72221493]
curr_Stock_Price:  102.17514246473957
curr_Factors:  [1.02175142e+02 3.03516764e-02]
mat_Sqrt:  [[ 1.78006800e+01  0.00000000e+00]
 [-6.96869300e-03  1.59672816e-02]]
grads:  [  0.03223335 -20.70741586]
Stock Position:  0.03223334669885025
Bond Position:  [-11.01566172]


portfolio before change:  [-7.72651011]
curr_Stock_Price:  102.0846107661265
curr_Factors:  [1.02084611e+02 3.15029937e-02]
mat_Sqrt:  [[ 1.81190820e+01  0.00000000e+00]
 [-7.09963309e-03  1.62673030e-02]]
grads:  [-2.92125122e-03  1.17029056e+01]
Stock Position:  -0.0029212512193406708
Bond Position:  [-7.42829532]


portfolio before change:  [-7.72645047]
curr_Stock_Price:  101.74632045401259
curr_Factors:  [1.01746320e+02 3.17094788e-02]
mat_Sqrt:  [[ 1.81181255e+01  0.00000000e+00]
 [-7.12286221e-03  1.63205276e-02]]
grads:  [0.00305107 2.26398762]
Stock Position:  0.003051071427128441
Bond Position:  [-8.03688577]


portfolio before change:  [-7.72473129]
curr_Stock_Price:  102.63907594806915
curr_Factors:  [1.02639076e+02 3.27802575e-02]
mat_Sqrt:  [[ 1.85831321e+01  0.00000000e+00]
 [-7.24212759e-03  1.65937989e-02]]
grads:  [-2.44896759e-03 -6.46103156e+00]
Stock Position:  -0.0024489675920586693
Bond Position:  [-7.47337152]


portfolio before change:  [-7.72351281]
curr_Stock_Price:  101.76004903405227
curr_Factors:  [1.01760049e+02 3.43286365e-02]
mat_Sqrt:  [[ 1.88540904e+01  0.00000000e+00]
 [-7.41119548e-03  1.69811821e-02]]
grads:  [-0.00380806 -1.94736332]
Stock Position:  -0.0038080560034399018
Bond Position:  [-7.33600484]


portfolio before change:  [-7.72070208]
curr_Stock_Price:  100.78112907658075
curr_Factors:  [1.00781129e+02 3.41413003e-02]
mat_Sqrt:  [[ 1.86216967e+01  0.00000000e+00]
 [-7.39094585e-03  1.69347844e-02]]
grads:  [-0.03380702 -5.64920042]
Stock Position:  -0.03380702445838112
Bond Position:  [-4.31359199]


portfolio before change:  [-7.72461317]
curr_Stock_Price:  100.88086724771428
curr_Factors:  [1.00880867e+02 3.42010669e-02]
mat_Sqrt:  [[ 1.86564339e+01  0.00000000e+00]
 [-7.39741219e-03  1.69496006e-02]]
grads:  [-0.00625293  0.18359718]
Stock Position:  -0.006252929342422689
Bond Position:  [-7.09381223]


portfolio before change:  [-7.72376391]
curr_Stock_Price:  100.60323061085508
curr_Factors:  [1.00603231e+02 3.52773963e-02]
mat_Sqrt:  [[ 1.88955783e+01  0.00000000e+00]
 [-7.51291116e-03  1.72142420e-02]]
grads:  [0.00553832 2.06851634]
Stock Position:  0.0055383196188805005
Bond Position:  [-8.28093675]


portfolio before change:  [-7.72384307]
curr_Stock_Price:  100.77584910363929
curr_Factors:  [1.00775849e+02 3.48377335e-02]
mat_Sqrt:  [[ 1.88096802e+01  0.00000000e+00]
 [-7.46594760e-03  1.71066350e-02]]
grads:  [0.00882579 4.42539417]
Stock Position:  0.00882579423233833
Bond Position:  [-8.61326998]


portfolio before change:  [-7.72525404]
curr_Stock_Price:  100.73797792589104
curr_Factors:  [1.00737978e+02 3.49984443e-02]
mat_Sqrt:  [[ 1.88459311e+01  0.00000000e+00]
 [-7.48314846e-03  1.71460471e-02]]
grads:  [-0.01830397 -8.42257865]
Stock Position:  -0.018303970394444286
Bond Position:  [-5.88134908]


portfolio before change:  [-7.70726407]
curr_Stock_Price:  99.71496554900507
curr_Factors:  [9.97149655e+01 3.52664900e-02]
mat_Sqrt:  [[ 1.87258466e+01  0.00000000e+00]
 [-7.51174973e-03  1.72115809e-02]]
grads:  [ -0.02952431 -20.69806441]
Stock Position:  -0.029524308269590394
Bond Position:  [-4.76324869]


portfolio before change:  [-7.70506653]
curr_Stock_Price:  99.62036623245854
curr_Factors:  [9.96203662e+01 3.45588243e-02]
mat_Sqrt:  [[ 1.85194299e+01  0.00000000e+00]
 [-7.43600153e-03  1.70380199e-02]]
grads:  [4.22616499e-03 1.77943289e+01]
Stock Position:  0.004226164989806535
Bond Position:  [-8.12607864]


portfolio before change:  [-7.70514038]
curr_Stock_Price:  99.84325680928552
curr_Factors:  [9.98432568e+01 3.32886298e-02]
mat_Sqrt:  [[ 1.82165738e+01  0.00000000e+00]
 [-7.29806876e-03  1.67219763e-02]]
grads:  [-3.97488965e-03  7.03170240e+00]
Stock Position:  -0.003974889645975456
Bond Position:  [-7.30827446]


portfolio before change:  [-7.71051474]
curr_Stock_Price:  100.96549374988612
curr_Factors:  [1.00965494e+02 3.34149547e-02]
mat_Sqrt:  [[ 1.84562478e+01  0.00000000e+00]
 [-7.31190313e-03  1.67536748e-02]]
grads:  [0.0141465  4.57808087]
Stock Position:  0.014146499863603081
Bond Position:  [-9.13882309]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.72083542]
Stock Price:  100.3166937929345
PL:  [-8.03752921]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.46630209e-01  5.65154093e-01]
 [-1.71726663e-01 -8.21960588e-02]
 [ 7.68943263e-01 -6.48748194e-01]
 [-7.02741817e-03  2.48194737e-02]
 [-1.73781860e-02  1.03148565e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-1.68962548e-03  3.22979795e-01]
 [ 4.02316560e-02 -5.25215800e-02]
 [ 1.43808451e-01  7.71991185e-02]
 [ 3.12434914e-01 -1.45970864e-01]
 [ 6.62274080e-02  8.13056089e-03]
 [-1.11745222e-01 -1.85575032e-01]
 [-1.11281167e-01  1.22557660e-01]
 [-7.36003206e-01 -1.05206210e+00]
 [-4.36695588e-02 -3.13460933e-01]
 [-2.86075244e-03 -1.75063275e-01]
 [-5.07158928e-02  1.43912654e-01]
 [ 1.33046902e-01  1.57161801e-01]
 [ 1.68509512e-02  1.73943907e-02]
 [-1.12015148e-01 -2.55027116e-02]
 [ 2.06488034e-01  3.92352631e-01]
 [-5.20836298e-03  1.98262336e-01]
 [-1.49960634e-02 -4.32827142e-01]
 [ 1.19676809e-01  1.98377310e-01]
 [ 8.70001547e-02  1.79679235e-01]
 [ 8.10318286e-01 -7.41187900e-01]
 [-6.70688686e-01  8.29910630e-01]
 [ 1.04201782e-01 -1.34914129e-02]
 [-4.99962275e-02 -5.97486589e-02]
 [ 8.67653006e-02 -1.91238401e-01]
 [-1.03254249e-02 -7.15731131e-02]
 [-1.17927896e-01 -2.89172410e-04]
 [ 1.76172551e-01  1.80691526e-01]
 [ 2.08998993e-01  3.66976846e-02]
 [-1.88434388e-01 -2.37315676e-01]
 [ 1.57909687e-01 -1.53303620e-01]
 [-2.06602566e-01  1.80747035e-01]
 [-1.15397899e-01  1.23202753e-01]
 [-2.47790228e-01  1.61981002e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.5682624]
curr_Stock_Price:  100.73206502037127
curr_Factors:  [1.00732065e+02 3.77671931e-02]
mat_Sqrt:  [[ 1.95760512e+01  0.00000000e+00]
 [-7.77351329e-03  1.78113565e-02]]
grads:  [2.51983238e-02 3.17299859e+01]
Stock Position:  0.025198323822993567
Bond Position:  [5.02998321]


portfolio before change:  [7.55705339]
curr_Stock_Price:  100.26227995657067
curr_Factors:  [1.00262280e+02 3.64689781e-02]
mat_Sqrt:  [[ 1.91469399e+01  0.00000000e+00]
 [-7.63874106e-03  1.75025546e-02]]
grads:  [-0.01084246 -4.69623211]
Stock Position:  -0.01084246180544553
Bond Position:  [8.64414334]


portfolio before change:  [7.55238805]
curr_Stock_Price:  100.79222726410202
curr_Factors:  [1.00792227e+02 3.62131881e-02]
mat_Sqrt:  [[ 1.91805220e+01  0.00000000e+00]
 [-7.61190521e-03  1.74410659e-02]]
grads:  [ 2.53281083e-02 -3.71965909e+01]
Stock Position:  0.025328108319208315
Bond Position:  [4.9995116]


portfolio before change:  [7.54241183]
curr_Stock_Price:  100.3736726091715
curr_Factors:  [1.00373673e+02 3.55191613e-02]
mat_Sqrt:  [[ 1.89169522e+01  0.00000000e+00]
 [-7.53861116e-03  1.72731281e-02]]
grads:  [2.01125855e-04 1.43688355e+00]
Stock Position:  0.00020112585515019243
Bond Position:  [7.52222409]


portfolio before change:  [7.54328065]
curr_Stock_Price:  100.01810889746118
curr_Factors:  [1.00018109e+02 3.52065376e-02]
mat_Sqrt:  [[ 1.87668031e+01  0.00000000e+00]
 [-7.50536209e-03  1.71969449e-02]]
grads:  [-0.00068613  0.59980749]
Stock Position:  -0.0006861271735654456
Bond Position:  [7.61190579]


portfolio before change:  [7.54427799]
curr_Stock_Price:  99.95136407232391
curr_Factors:  [9.99513641e+01 3.44316991e-02]
mat_Sqrt:  [[ 1.85467558e+01  0.00000000e+00]
 [-7.42231222e-03  1.70066538e-02]]
grads:  [-0.00638499 -3.89946952]
Stock Position:  -0.006384985771676765
Bond Position:  [8.18246603]


portfolio before change:  [7.54000494]
curr_Stock_Price:  100.7807988283022
curr_Factors:  [1.00780799e+02 3.51631299e-02]
mat_Sqrt:  [[ 1.88982486e+01  0.00000000e+00]
 [-7.50073382e-03  1.71863402e-02]]
grads:  [7.36948255e-03 1.87928198e+01]
Stock Position:  0.007369482547053716
Bond Position:  [6.7973026]


portfolio before change:  [7.53226916]
curr_Stock_Price:  99.61579281839067
curr_Factors:  [9.96157928e+01 3.38167658e-02]
mat_Sqrt:  [[ 1.83186823e+01  0.00000000e+00]
 [-7.35573418e-03  1.68541043e-02]]
grads:  [ 9.44901984e-04 -3.11624866e+00]
Stock Position:  0.0009449019842711346
Bond Position:  [7.438142]


portfolio before change:  [7.53403671]
curr_Stock_Price:  100.50236282984817
curr_Factors:  [1.00502363e+02 3.33973707e-02]
mat_Sqrt:  [[ 1.83667541e+01  0.00000000e+00]
 [-7.30997901e-03  1.67492661e-02]]
grads:  [0.00966425 4.60910455]
Stock Position:  0.009664250286881816
Bond Position:  [6.56275672]


portfolio before change:  [7.54000927]
curr_Stock_Price:  101.0354785374074
curr_Factors:  [1.01035479e+02 3.34563732e-02]
mat_Sqrt:  [[ 1.84804836e+01  0.00000000e+00]
 [-7.31643336e-03  1.67640548e-02]]
grads:  [ 0.01345896 -8.70737214]
Stock Position:  0.01345895543731205
Bond Position:  [6.18017727]


portfolio before change:  [7.54623432]
curr_Stock_Price:  101.44059790170975
curr_Factors:  [1.01440598e+02 3.18782926e-02]
mat_Sqrt:  [[ 1.81117046e+01  0.00000000e+00]
 [-7.14179727e-03  1.63639133e-02]]
grads:  [0.00385253 0.4968592 ]
Stock Position:  0.0038525294619560753
Bond Position:  [7.15543143]


portfolio before change:  [7.55168169]
curr_Stock_Price:  102.62238873658247
curr_Factors:  [1.02622389e+02 3.31185387e-02]
mat_Sqrt:  [[ 1.86757350e+01  0.00000000e+00]
 [-7.27939983e-03  1.66792004e-02]]
grads:  [-1.03201725e-02 -1.11261348e+01]
Stock Position:  -0.010320172471016386
Bond Position:  [8.61076244]


portfolio before change:  [7.53080307]
curr_Stock_Price:  104.74977860658656
curr_Factors:  [1.04749779e+02 3.26223915e-02]
mat_Sqrt:  [[ 1.89195591e+01  0.00000000e+00]
 [-7.22466791e-03  1.65537938e-02]]
grads:  [-3.05464934e-03  7.40359951e+00]
Stock Position:  -0.003054649342016254
Bond Position:  [7.85077692]


portfolio before change:  [7.53156267]
curr_Stock_Price:  104.82239310196994
curr_Factors:  [1.04822393e+02 3.25929763e-02]
mat_Sqrt:  [[ 1.89241369e+01  0.00000000e+00]
 [-7.22140998e-03  1.65463289e-02]]
grads:  [-6.31553638e-02 -6.35828108e+01]
Stock Position:  -0.06315536384122641
Bond Position:  [14.15165905]


portfolio before change:  [7.53681252]
curr_Stock_Price:  104.76727856705116
curr_Factors:  [1.04767279e+02 3.40741087e-02]
mat_Sqrt:  [[ 1.93391737e+01  0.00000000e+00]
 [-7.38366940e-03  1.69181120e-02]]
grads:  [-9.33210117e-03 -1.85281273e+01]
Stock Position:  -0.009332101166439554
Bond Position:  [8.51451136]


portfolio before change:  [7.53551109]
curr_Stock_Price:  105.02079134490367
curr_Factors:  [1.05020791e+02 3.49731525e-02]
mat_Sqrt:  [[ 1.96400540e+01  0.00000000e+00]
 [-7.48044410e-03  1.71398507e-02]]
grads:  [-4.03586617e-03 -1.02138156e+01]
Stock Position:  -0.004035866165058557
Bond Position:  [7.95936095]


portfolio before change:  [7.53301671]
curr_Stock_Price:  105.88537902114147
curr_Factors:  [1.05885379e+02 3.42173667e-02]
mat_Sqrt:  [[ 1.95866105e+01  0.00000000e+00]
 [-7.39917474e-03  1.69536392e-02]]
grads:  [6.17398224e-04 8.48859956e+00]
Stock Position:  0.0006173982241599322
Bond Position:  [7.46764327]


portfolio before change:  [7.53466652]
curr_Stock_Price:  107.04555384679436
curr_Factors:  [1.07045554e+02 3.44117493e-02]
mat_Sqrt:  [[ 1.98573828e+01  0.00000000e+00]
 [-7.42016165e-03  1.70017262e-02]]
grads:  [0.01015431 9.24387321]
Stock Position:  0.010154305666661449
Bond Position:  [6.44769324]


portfolio before change:  [7.53055765]
curr_Stock_Price:  106.56153463145117
curr_Factors:  [1.06561535e+02 3.40796937e-02]
mat_Sqrt:  [[ 1.96719906e+01  0.00000000e+00]
 [-7.38427451e-03  1.69194984e-02]]
grads:  [0.0012425  1.02806775]
Stock Position:  0.0012425018987086566
Bond Position:  [7.39815474]


portfolio before change:  [7.53101384]
curr_Stock_Price:  106.18435910054733
curr_Factors:  [1.06184359e+02 3.50205459e-02]
mat_Sqrt:  [[ 1.98711044e+01  0.00000000e+00]
 [-7.48551090e-03  1.71514602e-02]]
grads:  [-0.00619721 -1.48691198]
Stock Position:  -0.0061972118407409935
Bond Position:  [8.1890608]


portfolio before change:  [7.53518742]
curr_Stock_Price:  105.67608470280207
curr_Factors:  [1.05676085e+02 3.55308231e-02]
mat_Sqrt:  [[ 1.99195420e+01  0.00000000e+00]
 [-7.53984860e-03  1.72759635e-02]]
grads:  [1.89625224e-02 2.27108972e+01]
Stock Position:  0.018962522371370097
Bond Position:  [5.5313023]


portfolio before change:  [7.55696074]
curr_Stock_Price:  106.78784943406963
curr_Factors:  [1.06787849e+02 3.45720301e-02]
mat_Sqrt:  [[ 1.98556579e+01  0.00000000e+00]
 [-7.43742215e-03  1.70412750e-02]]
grads:  [4.09557895e-03 1.16342431e+01]
Stock Position:  0.004095578950825306
Bond Position:  [7.11960267]


portfolio before change:  [7.56209768]
curr_Stock_Price:  107.82480595526224
curr_Factors:  [1.07824806e+02 3.44243762e-02]
mat_Sqrt:  [[ 2.00056066e+01  0.00000000e+00]
 [-7.42152288e-03  1.70048452e-02]]
grads:  [-1.01920086e-02 -2.54531657e+01]
Stock Position:  -0.010192008619721445
Bond Position:  [8.66104903]


portfolio before change:  [7.58201556]
curr_Stock_Price:  105.97677198351434
curr_Factors:  [1.05976772e+02 3.38086783e-02]
mat_Sqrt:  [[ 1.94860936e+01  0.00000000e+00]
 [-7.35485454e-03  1.68520888e-02]]
grads:  [1.05847672e-02 1.17716748e+01]
Stock Position:  0.010584767247278451
Bond Position:  [6.46027609]


portfolio before change:  [7.59487454]
curr_Stock_Price:  107.11533305303587
curr_Factors:  [1.07115333e+02 3.16743099e-02]
mat_Sqrt:  [[ 1.90636135e+01  0.00000000e+00]
 [-7.11891114e-03  1.63114746e-02]]
grads:  [8.67719031e-03 1.10155115e+01]
Stock Position:  0.008677190312474069
Bond Position:  [6.66541441]


portfolio before change:  [7.59404129]
curr_Stock_Price:  106.92327967791566
curr_Factors:  [1.06923280e+02 3.17889931e-02]
mat_Sqrt:  [[ 1.90638520e+01  0.00000000e+00]
 [-7.13178723e-03  1.63409774e-02]]
grads:  [ 2.55371982e-02 -4.53576234e+01]
Stock Position:  0.025537198154141932
Bond Position:  [4.86352031]


portfolio before change:  [7.60226212]
curr_Stock_Price:  107.22138821939659
curr_Factors:  [1.07221388e+02 3.35784219e-02]
mat_Sqrt:  [[ 1.96476931e+01  0.00000000e+00]
 [-7.32976637e-03  1.67946046e-02]]
grads:  [-1.57008759e-02  4.94153122e+01]
Stock Position:  -0.015700875922903017
Bond Position:  [9.28573184]


portfolio before change:  [7.6013033]
curr_Stock_Price:  107.35638780453455
curr_Factors:  [1.07356388e+02 3.38711669e-02]
mat_Sqrt:  [[ 1.97579995e+01  0.00000000e+00]
 [-7.36164839e-03  1.68676555e-02]]
grads:  [ 0.00497589 -0.79983925]
Stock Position:  0.004975890742049699
Bond Position:  [7.06710965]


portfolio before change:  [7.5963968]
curr_Stock_Price:  106.1927879421868
curr_Factors:  [1.06192788e+02 3.37681558e-02]
mat_Sqrt:  [[ 1.95141076e+01  0.00000000e+00]
 [-7.35044552e-03  1.68419865e-02]]
grads:  [-0.00389834 -3.54760164]
Stock Position:  -0.003898342767441051
Bond Position:  [8.01037269]


portfolio before change:  [7.59371715]
curr_Stock_Price:  107.1370369431742
curr_Factors:  [1.07137037e+02 3.40960034e-02]
mat_Sqrt:  [[ 1.97829644e+01  0.00000000e+00]
 [-7.38604125e-03  1.69235466e-02]]
grads:  [ 1.66912293e-04 -1.13001374e+01]
Stock Position:  0.00016691229310996893
Bond Position:  [7.57583466]


portfolio before change:  [7.59435219]
curr_Stock_Price:  105.26779613061245
curr_Factors:  [1.05267796e+02 3.53020696e-02]
mat_Sqrt:  [[ 1.97786030e+01  0.00000000e+00]
 [-7.51553799e-03  1.72202609e-02]]
grads:  [-2.10138665e-03 -4.15633153e+00]
Stock Position:  -0.002101386650737813
Bond Position:  [7.81556053]


portfolio before change:  [7.59932274]
curr_Stock_Price:  103.36736639205724
curr_Factors:  [1.03367366e+02 3.41526418e-02]
mat_Sqrt:  [[ 1.91027373e+01  0.00000000e+00]
 [-7.39217336e-03  1.69375970e-02]]
grads:  [-0.00617996 -0.01707281]
Stock Position:  -0.006179957323981612
Bond Position:  [8.23812865]


portfolio before change:  [7.59689677]
curr_Stock_Price:  103.92656071859857
curr_Factors:  [1.03926561e+02 3.41838633e-02]
mat_Sqrt:  [[ 1.92148557e+01  0.00000000e+00]
 [-7.39555145e-03  1.69453372e-02]]
grads:  [ 0.01327269 10.66320043]
Stock Position:  0.013272688727933196
Bond Position:  [6.21751188]


portfolio before change:  [7.61203724]
curr_Stock_Price:  105.00872520182448
curr_Factors:  [1.05008725e+02 3.31962016e-02]
mat_Sqrt:  [[ 1.91324058e+01  0.00000000e+00]
 [-7.28792992e-03  1.66987453e-02]]
grads:  [0.01176095 2.19763126]
Stock Position:  0.011760945223524123
Bond Position:  [6.37703537]


portfolio before change:  [7.62973326]
curr_Stock_Price:  106.4455860921205
curr_Factors:  [1.06445586e+02 3.28706460e-02]
mat_Sqrt:  [[ 1.92988654e+01  0.00000000e+00]
 [-7.25210546e-03  1.66166611e-02]]
grads:  [ -0.01513081 -14.2817907 ]
Stock Position:  -0.015130808715180162
Bond Position:  [9.24034106]


portfolio before change:  [7.64167706]
curr_Stock_Price:  105.73255826256836
curr_Factors:  [1.05732558e+02 3.28794089e-02]
mat_Sqrt:  [[ 1.91721466e+01  0.00000000e+00]
 [-7.25307205e-03  1.66188759e-02]]
grads:  [ 4.74659956e-03 -9.22466845e+00]
Stock Position:  0.004746599557258659
Bond Position:  [7.13980695]


portfolio before change:  [7.64770019]
curr_Stock_Price:  106.81345708148062
curr_Factors:  [1.06813457e+02 3.25088790e-02]
mat_Sqrt:  [[ 1.92587000e+01  0.00000000e+00]
 [-7.21208752e-03  1.65249685e-02]]
grads:  [-6.63170891e-03  1.09378142e+01]
Stock Position:  -0.006631708905338653
Bond Position:  [8.35605594]


portfolio before change:  [7.6414587]
curr_Stock_Price:  107.91212742763183
curr_Factors:  [1.07912127e+02 3.07747214e-02]
mat_Sqrt:  [[ 1.89307282e+01  0.00000000e+00]
 [-7.01709016e-03  1.60781734e-02]]
grads:  [-3.25543786e-03  7.66273318e+00]
Stock Position:  -0.0032554378631574183
Bond Position:  [7.99275992]


portfolio before change:  [7.64169672]
curr_Stock_Price:  108.14593253673391
curr_Factors:  [1.08145933e+02 3.12479299e-02]
mat_Sqrt:  [[ 1.91170474e+01  0.00000000e+00]
 [-7.07083361e-03  1.62013151e-02]]
grads:  [-9.26376962e-03  9.99801565e+00]
Stock Position:  -0.009263769621869597
Bond Position:  [8.64353572]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.64549682]
Stock Price:  107.85235920476399
PL:  [-0.20686238]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-4.99075065e-01 -2.40953693e-01]
 [-1.66787018e-01 -8.71982831e-02]
 [ 8.51431883e-01 -7.71291394e-01]
 [-3.43035247e-02  1.35294274e-01]
 [ 3.67551707e-02 -4.56122313e-02]
 [-8.05388102e-02 -1.02789532e-01]
 [-4.06998945e-02  2.06734581e-01]
 [-1.10424995e-02 -6.44611350e-02]
 [ 1.56125968e-01  7.32817537e-02]
 [ 3.13846716e-01 -1.46608300e-01]
 [ 9.86220834e-02  1.22162282e-01]
 [-3.74968622e-02  9.85792061e-02]
 [ 5.98095850e-02  7.79403382e-02]
 [-2.29988920e-01 -3.03677691e-01]
 [ 8.44010716e-02  2.28819077e-01]
 [ 5.23156089e-02 -1.93310574e-02]
 [-4.70448590e-02  1.33035255e-01]
 [-3.00682184e-02  3.09879795e-02]
 [ 1.51232962e-02  6.02923232e-02]
 [ 5.54963944e-02 -9.70535758e-02]
 [ 6.09751379e-02 -3.53448800e-02]
 [ 5.69052795e-02  3.05204427e-01]
 [ 3.64258118e-02  3.06197505e-01]
 [-1.97278624e-02  1.47530452e-01]
 [ 1.78190959e-02  4.23257334e-02]
 [ 6.16756747e-01 -1.80032592e-01]
 [ 1.28695326e-02  6.22283774e-02]
 [-1.73367491e-01  1.31837843e-01]
 [-9.19854663e-03 -1.32015261e-01]
 [ 5.72923250e-02 -5.97148239e-02]
 [-6.98954774e-01 -8.92214236e-02]
 [-1.20312409e-01  2.99917046e-02]
 [-9.28345281e-03 -9.79252580e-02]
 [ 5.77910743e-02  9.47419822e-02]
 [-7.55516868e-02  1.58785044e-01]
 [-7.04074034e-01 -2.74001277e-01]
 [-1.98539436e-02  3.13707087e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 6.39589310e-01  2.85747882e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.50488471]
curr_Stock_Price:  97.8593403580192
curr_Factors:  [9.78593404e+01 4.13330755e-02]
mat_Sqrt:  [[ 1.98953299e+01  0.00000000e+00]
 [-8.13221500e-03  1.86332454e-02]]
grads:  [ -0.03037074 -12.93138623]
Stock Position:  -0.03037073932056138
Bond Position:  [-8.5328242]


portfolio before change:  [-11.50018436]
curr_Stock_Price:  97.6694530270223
curr_Factors:  [9.76694530e+01 4.21415948e-02]
mat_Sqrt:  [[ 2.00499936e+01  0.00000000e+00]
 [-8.21136722e-03  1.88146059e-02]]
grads:  [-0.01021664 -4.63460588]
Stock Position:  -0.01021663513055382
Bond Position:  [-10.5023312]


portfolio before change:  [-11.50926654]
curr_Stock_Price:  98.42990918491721
curr_Factors:  [9.84299092e+01 4.01471222e-02]
mat_Sqrt:  [[ 1.97221517e+01  0.00000000e+00]
 [-8.01469872e-03  1.83639818e-02]]
grads:  [ 2.61032736e-02 -4.20002265e+01]
Stock Position:  0.026103273646125795
Bond Position:  [-14.07860939]


portfolio before change:  [-11.51241575]
curr_Stock_Price:  98.37668693081608
curr_Factors:  [9.83766869e+01 3.93683527e-02]
mat_Sqrt:  [[ 1.95193708e+01  0.00000000e+00]
 [-7.93658392e-03  1.81849983e-02]]
grads:  [1.26765035e-03 7.43988378e+00]
Stock Position:  0.0012676503549935623
Bond Position:  [-11.63712299]


portfolio before change:  [-11.51407207]
curr_Stock_Price:  98.21766031108325
curr_Factors:  [9.82176603e+01 3.84577917e-02]
mat_Sqrt:  [[ 1.92611297e+01  0.00000000e+00]
 [-7.84426330e-03  1.79734652e-02]]
grads:  [ 8.74733786e-04 -2.53775390e+00]
Stock Position:  0.0008747337858381329
Bond Position:  [-11.59998638]


portfolio before change:  [-11.5159206]
curr_Stock_Price:  97.76216219680937
curr_Factors:  [9.77621622e+01 3.95941473e-02]
mat_Sqrt:  [[ 1.94529869e+01  0.00000000e+00]
 [-7.95931125e-03  1.82370732e-02]]
grads:  [-0.0064463  -5.63629545]
Stock Position:  -0.006446302586835482
Bond Position:  [-10.88571612]


portfolio before change:  [-11.52572978]
curr_Stock_Price:  99.0727401845375
curr_Factors:  [9.90727402e+01 4.02821424e-02]
mat_Sqrt:  [[ 1.98843068e+01  0.00000000e+00]
 [-8.02816466e-03  1.83948361e-02]]
grads:  [2.49073173e-03 1.12387292e+01]
Stock Position:  0.0024907317266459504
Bond Position:  [-11.7724934]


portfolio before change:  [-11.52664317]
curr_Stock_Price:  99.29687779039928
curr_Factors:  [9.92968778e+01 3.99322759e-02]
mat_Sqrt:  [[ 1.98425565e+01  0.00000000e+00]
 [-7.99322472e-03  1.83147787e-02]]
grads:  [-1.97432450e-03 -3.51962402e+00]
Stock Position:  -0.001974324496399276
Bond Position:  [-11.33059891]


portfolio before change:  [-11.52915697]
curr_Stock_Price:  99.85270820160588
curr_Factors:  [9.98527082e+01 3.96804655e-02]
mat_Sqrt:  [[ 1.98906157e+01  0.00000000e+00]
 [-7.96798248e-03  1.82569414e-02]]
grads:  [0.00945716 4.01391186]
Stock Position:  0.009457160605408174
Bond Position:  [-12.47348007]


portfolio before change:  [-11.51959074]
curr_Stock_Price:  101.02912032424891
curr_Factors:  [1.01029120e+02 3.98894342e-02]
mat_Sqrt:  [[ 2.01778788e+01  0.00000000e+00]
 [-7.98893577e-03  1.83049514e-02]]
grads:  [ 0.01238295 -8.00921545]
Stock Position:  0.012382947182759018
Bond Position:  [-12.770629]


portfolio before change:  [-11.53859352]
curr_Stock_Price:  99.62344927275078
curr_Factors:  [9.96234493e+01 4.01782644e-02]
mat_Sqrt:  [[ 1.99690388e+01  0.00000000e+00]
 [-8.01780662e-03  1.83711029e-02]]
grads:  [0.00760868 6.64969778]
Stock Position:  0.007608682417170686
Bond Position:  [-12.2965967]


portfolio before change:  [-11.5420692]
curr_Stock_Price:  99.36867292010946
curr_Factors:  [9.93686729e+01 3.98712399e-02]
mat_Sqrt:  [[ 1.98417220e+01  0.00000000e+00]
 [-7.98711361e-03  1.83007764e-02]]
grads:  [2.78535831e-04 5.38661334e+00]
Stock Position:  0.000278535831089551
Bond Position:  [-11.56974693]


portfolio before change:  [-11.54350807]
curr_Stock_Price:  99.3953759267625
curr_Factors:  [9.93953759e+01 3.80992970e-02]
mat_Sqrt:  [[ 1.94010244e+01  0.00000000e+00]
 [-7.80761649e-03  1.78894968e-02]]
grads:  [0.00483611 4.35676527]
Stock Position:  0.004836112537145509
Bond Position:  [-12.02419529]


portfolio before change:  [-11.55086837]
curr_Stock_Price:  98.18424209032847
curr_Factors:  [9.81842421e+01 3.85777727e-02]
mat_Sqrt:  [[ 1.92845881e+01  0.00000000e+00]
 [-7.85649008e-03  1.80014802e-02]]
grads:  [ -0.01879868 -16.86959557]
Stock Position:  -0.018798676332441745
Bond Position:  [-9.70513458]


portfolio before change:  [-11.56120772]
curr_Stock_Price:  98.66970874405472
curr_Factors:  [9.86697087e+01 3.83518291e-02]
mat_Sqrt:  [[ 1.93231038e+01  0.00000000e+00]
 [-7.83344921e-03  1.79486870e-02]]
grads:  [9.53604069e-03 1.27485134e+01]
Stock Position:  0.009536040693015889
Bond Position:  [-12.50212607]


portfolio before change:  [-11.56109252]
curr_Stock_Price:  98.84567870899788
curr_Factors:  [9.88456787e+01 3.98452406e-02]
mat_Sqrt:  [[ 1.97308554e+01  0.00000000e+00]
 [-7.98450907e-03  1.82948086e-02]]
grads:  [ 0.00222387 -1.05664169]
Stock Position:  0.0022238693032254142
Bond Position:  [-11.78091239]


portfolio before change:  [-11.5617692]
curr_Stock_Price:  99.2036245644013
curr_Factors:  [9.92036246e+01 3.81973280e-02]
mat_Sqrt:  [[ 1.93884920e+01  0.00000000e+00]
 [-7.81765469e-03  1.79124972e-02]]
grads:  [5.68197177e-04 7.42695191e+00]
Stock Position:  0.0005681971770605222
Bond Position:  [-11.61813642]


portfolio before change:  [-11.5632641]
curr_Stock_Price:  99.12875705951143
curr_Factors:  [9.91287571e+01 3.90910641e-02]
mat_Sqrt:  [[ 1.95992028e+01  0.00000000e+00]
 [-7.90858410e-03  1.81208426e-02]]
grads:  [-8.44113687e-04  1.71007387e+00]
Stock Position:  -0.0008441136866928718
Bond Position:  [-11.47958816]


portfolio before change:  [-11.56543406]
curr_Stock_Price:  99.99939981549927
curr_Factors:  [9.99993998e+01 3.86092087e-02]
mat_Sqrt:  [[ 1.96491082e+01  0.00000000e+00]
 [-7.85969045e-03  1.80088132e-02]]
grads:  [2.10885008e-03 3.34793429e+00]
Stock Position:  0.0021088500798358395
Bond Position:  [-11.7763178]


portfolio before change:  [-11.56948953]
curr_Stock_Price:  98.77440062698622
curr_Factors:  [9.87744006e+01 3.91331748e-02]
mat_Sqrt:  [[ 1.95396574e+01  0.00000000e+00]
 [-7.91284270e-03  1.81306003e-02]]
grads:  [ 6.72414108e-04 -5.35302605e+00]
Stock Position:  0.0006724141080924761
Bond Position:  [-11.63590683]


portfolio before change:  [-11.57079082]
curr_Stock_Price:  99.00236784513956
curr_Factors:  [9.90023678e+01 3.91066797e-02]
mat_Sqrt:  [[ 1.95781231e+01  0.00000000e+00]
 [-7.91016356e-03  1.81244616e-02]]
grads:  [ 0.00232654 -1.95012027]
Stock Position:  0.00232654414327544
Bond Position:  [-11.8011242]


portfolio before change:  [-11.56912352]
curr_Stock_Price:  100.35309975746564
curr_Factors:  [1.0035310e+02 3.7410384e-02]
mat_Sqrt:  [[ 1.94100599e+01  0.00000000e+00]
 [-7.73670565e-03  1.77270196e-02]]
grads:  [9.79427232e-03 1.72169058e+01]
Stock Position:  0.009794272318019022
Bond Position:  [-12.5520091]


portfolio before change:  [-11.58314457]
curr_Stock_Price:  99.08174893494561
curr_Factors:  [9.90817489e+01 3.73327775e-02]
mat_Sqrt:  [[ 1.91442702e+01  0.00000000e+00]
 [-7.72867673e-03  1.77086231e-02]]
grads:  [8.88314662e-03 1.72908703e+01]
Stock Position:  0.008883146617008474
Bond Position:  [-12.46330228]


portfolio before change:  [-11.57541416]
curr_Stock_Price:  100.12737179920366
curr_Factors:  [1.00127372e+02 3.62578278e-02]
mat_Sqrt:  [[ 1.90657418e+01  0.00000000e+00]
 [-7.61659533e-03  1.74518123e-02]]
grads:  [2.34240586e-03 8.45358917e+00]
Stock Position:  0.0023424058624705
Bond Position:  [-11.8099531]


portfolio before change:  [-11.57772134]
curr_Stock_Price:  99.77267568049899
curr_Factors:  [9.97726757e+01 3.57987363e-02]
mat_Sqrt:  [[ 1.88775430e+01  0.00000000e+00]
 [-7.56822159e-03  1.73409742e-02]]
grads:  [1.92247267e-03 2.44079329e+00]
Stock Position:  0.0019224726676716805
Bond Position:  [-11.76953158]


portfolio before change:  [-11.57817613]
curr_Stock_Price:  100.30141998174736
curr_Factors:  [1.00301420e+02 3.42077533e-02]
mat_Sqrt:  [[ 1.85510868e+01  0.00000000e+00]
 [-7.39813525e-03  1.69512574e-02]]
grads:  [  0.02901092 -10.62060396]
Stock Position:  0.029010919355608126
Bond Position:  [-14.48801253]


portfolio before change:  [-11.58982415]
curr_Stock_Price:  99.96234409171805
curr_Factors:  [9.99623441e+01 3.48262520e-02]
mat_Sqrt:  [[ 1.86547658e+01  0.00000000e+00]
 [-7.46471722e-03  1.71038158e-02]]
grads:  [2.14573710e-03 3.63827452e+00]
Stock Position:  0.002145737099554254
Bond Position:  [-11.80431706]


portfolio before change:  [-11.5919425]
curr_Stock_Price:  99.66280955189552
curr_Factors:  [9.96628096e+01 3.47949094e-02]
mat_Sqrt:  [[ 1.85904962e+01  0.00000000e+00]
 [-7.46135745e-03  1.70961176e-02]]
grads:  [-6.23053514e-03  7.71156619e+00]
Stock Position:  -0.006230535138230032
Bond Position:  [-10.97098986]


portfolio before change:  [-11.59120742]
curr_Stock_Price:  99.32471064447681
curr_Factors:  [9.93247106e+01 3.42640445e-02]
mat_Sqrt:  [[ 1.83855498e+01  0.00000000e+00]
 [-7.40421982e-03  1.69651989e-02]]
grads:  [-3.63408932e-03 -7.78153335e+00]
Stock Position:  -0.0036340893211597274
Bond Position:  [-11.23025255]


portfolio before change:  [-11.59010563]
curr_Stock_Price:  98.63522365078646
curr_Factors:  [9.86352237e+01 3.51330611e-02]
mat_Sqrt:  [[ 1.84880041e+01  0.00000000e+00]
 [-7.49752611e-03  1.71789905e-02]]
grads:  [ 1.68923800e-03 -3.47603802e+00]
Stock Position:  0.0016892380047954776
Bond Position:  [-11.756724]


portfolio before change:  [-11.58993891]
curr_Stock_Price:  99.60394940460526
curr_Factors:  [9.96039494e+01 3.38146015e-02]
mat_Sqrt:  [[ 1.83159182e+01  0.00000000e+00]
 [-7.35549879e-03  1.68535650e-02]]
grads:  [-0.04028704 -5.29391994]
Stock Position:  -0.04028704357893059
Bond Position:  [-7.57719026]


portfolio before change:  [-11.50537602]
curr_Stock_Price:  97.48142844809925
curr_Factors:  [9.74814284e+01 3.42105647e-02]
mat_Sqrt:  [[ 1.80302607e+01  0.00000000e+00]
 [-7.39843926e-03  1.69519540e-02]]
grads:  [-0.00594683  1.76921815]
Stock Position:  -0.005946833360882701
Bond Position:  [-10.92567021]


portfolio before change:  [-11.50449538]
curr_Stock_Price:  97.1036747811978
curr_Factors:  [9.71036748e+01 3.51143354e-02]
mat_Sqrt:  [[ 1.81960823e+01  0.00000000e+00]
 [-7.49552777e-03  1.71744117e-02]]
grads:  [-2.85894174e-03 -5.70181149e+00]
Stock Position:  -0.0028589417430077875
Bond Position:  [-11.22688163]


portfolio before change:  [-11.50464878]
curr_Stock_Price:  96.66643261912058
curr_Factors:  [9.66664326e+01 3.60882990e-02]
mat_Sqrt:  [[ 1.83636454e+01  0.00000000e+00]
 [-7.59876821e-03  1.74109653e-02]]
grads:  [5.39870288e-03 5.44151234e+00]
Stock Position:  0.0053987028811166736
Bond Position:  [-12.02652212]


portfolio before change:  [-11.50343549]
curr_Stock_Price:  97.16964572201006
curr_Factors:  [9.71696457e+01 3.47788159e-02]
mat_Sqrt:  [[ 1.81212443e+01  0.00000000e+00]
 [-7.45963172e-03  1.70921635e-02]]
grads:  [-3.45021126e-04  9.28993244e+00]
Stock Position:  -0.0003450211260638543
Bond Position:  [-11.46990991]


portfolio before change:  [-11.50520599]
curr_Stock_Price:  98.14543939875622
curr_Factors:  [9.81454394e+01 3.42464650e-02]
mat_Sqrt:  [[ 1.81625992e+01  0.00000000e+00]
 [-7.40232017e-03  1.69608463e-02]]
grads:  [ -0.04534913 -16.15492958]
Stock Position:  -0.04534912586585821
Bond Position:  [-7.0543961]


portfolio before change:  [-11.50757382]
curr_Stock_Price:  98.17820691962031
curr_Factors:  [9.81782069e+01 3.39349755e-02]
mat_Sqrt:  [[ 1.80858476e+01  0.00000000e+00]
 [-7.36857930e-03  1.68835362e-02]]
grads:  [6.47241183e-03 1.85806506e+01]
Stock Position:  0.00647241182977206
Bond Position:  [-12.14302361]


portfolio before change:  [-11.51075779]
curr_Stock_Price:  97.92080736980459
curr_Factors:  [9.79208074e+01 3.49420368e-02]
mat_Sqrt:  [[ 1.83041301e+01  0.00000000e+00]
 [-7.47711568e-03  1.71322243e-02]]
grads:  [-4.81777691e-03  6.38339555e+00]
Stock Position:  -0.004817776908127355
Bond Position:  [-11.03899718]


portfolio before change:  [-11.51350797]
curr_Stock_Price:  98.20521626197444
curr_Factors:  [9.82052163e+01 3.58030386e-02]
mat_Sqrt:  [[ 1.85820874e+01  0.00000000e+00]
 [-7.56867635e-03  1.73420161e-02]]
grads:  [0.0350908  1.64772008]
Stock Position:  0.035090802983213536
Bond Position:  [-14.95960786]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.53361358]
Stock Price:  97.68554891328435
PL:  [-11.53361358]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [ 2.85624964e-01  6.14139164e-01]
 [-1.87711368e-01 -7.58387829e-02]
 [ 8.11912875e-01 -6.77977939e-01]
 [-1.45372510e-01 -2.23505254e-03]
 [-1.26215205e-01  5.38725048e-02]
 [ 5.31344510e-03  3.57373664e-02]
 [ 2.38818406e-02  2.78694643e-01]
 [ 3.36646183e-01 -6.95320925e-03]
 [ 3.39227380e-02  6.87655482e-02]
 [ 3.73210909e-01 -1.97852513e-01]
 [ 6.16593998e-02 -7.64200205e-03]
 [-1.36991064e-01 -1.76902074e-01]
 [-1.77861257e-01  1.61555387e-01]
 [-6.47696495e-01 -8.26601474e-01]
 [ 4.88635360e-02  9.85960470e-02]
 [ 5.09857239e-02 -6.72286753e-02]
 [-5.29617526e-02  2.70159703e-01]
 [ 4.28976802e-02  1.42669022e-01]
 [ 1.52690053e-02  5.66743457e-02]
 [-1.04700481e-01 -3.21955206e-02]
 [ 2.32874998e-01  2.44841816e-01]
 [ 2.76692513e-02  8.96101715e-02]
 [-1.35973646e-02 -3.11877041e-01]
 [ 1.28001640e-01  2.01276549e-01]
 [ 7.19729133e-02  1.51119126e-01]
 [ 7.70385489e-01 -5.60169378e-01]
 [-5.22937628e-01  6.59541186e-01]
 [ 1.26668875e-01 -1.13639585e-02]
 [-4.78433648e-02 -6.21013807e-02]
 [ 2.03588675e-02 -1.92504664e-01]
 [-2.91447291e-01 -8.89496296e-02]
 [-1.17918185e-01 -6.66146765e-04]
 [ 1.13057108e-01  7.55151033e-02]
 [ 1.26470881e-01  7.90382489e-02]
 [-2.41454363e-01 -6.11979476e-02]
 [-5.02510947e-01 -3.14151479e-01]
 [-1.51964576e-02  3.13141543e-01]
 [-1.35914602e-01  1.09361764e-01]
 [ 7.63092255e-01  1.48119066e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.49709107]
curr_Stock_Price:  100.87196165035614
curr_Factors:  [1.00871962e+02 3.99698840e-02]
mat_Sqrt:  [[ 2.01667962e+01  0.00000000e+00]
 [-7.99698783e-03  1.83234010e-02]]
grads:  [2.74539031e-02 3.35166579e+01]
Stock Position:  0.02745390305826946
Bond Position:  [5.72776201]


portfolio before change:  [8.51075621]
curr_Stock_Price:  101.3436298173053
curr_Factors:  [1.0134363e+02 4.0446869e-02]
mat_Sqrt:  [[ 2.03816298e+01  0.00000000e+00]
 [-8.04456278e-03  1.84324089e-02]]
grads:  [-0.01083378 -4.11442602]
Stock Position:  -0.010833781597938338
Bond Position:  [9.60869096]


portfolio before change:  [8.50610489]
curr_Stock_Price:  101.883837256884
curr_Factors:  [1.01883837e+02 3.89196602e-02]
mat_Sqrt:  [[ 2.00997110e+01  0.00000000e+00]
 [-7.89122654e-03  1.80810715e-02]]
grads:  [ 2.56729584e-02 -3.74965577e+01]
Stock Position:  0.02567295837532592
Bond Position:  [5.89044537]


portfolio before change:  [8.54874758]
curr_Stock_Price:  103.51615160958674
curr_Factors:  [1.03516152e+02 3.55685902e-02]
mat_Sqrt:  [[ 1.95227703e+01  0.00000000e+00]
 [-7.54385474e-03  1.72851427e-02]]
grads:  [-0.00749627 -0.12930484]
Stock Position:  -0.0074962705140648915
Bond Position:  [9.32473265]


portfolio before change:  [8.56325549]
curr_Stock_Price:  101.7363003464949
curr_Factors:  [1.01736300e+02 3.65102694e-02]
mat_Sqrt:  [[ 1.94394270e+01  0.00000000e+00]
 [-7.64306425e-03  1.75124602e-02]]
grads:  [-0.00528325  3.07623852]
Stock Position:  -0.0052832481464986725
Bond Position:  [9.10075361]


portfolio before change:  [8.56366455]
curr_Stock_Price:  101.8742084700505
curr_Factors:  [1.01874208e+02 3.72769690e-02]
mat_Sqrt:  [[ 1.96691025e+01  0.00000000e+00]
 [-7.72289779e-03  1.76953819e-02]]
grads:  [1.06311462e-03 2.01958718e+00]
Stock Position:  0.001063114623350598
Bond Position:  [8.45536059]


portfolio before change:  [8.56472781]
curr_Stock_Price:  101.88011320968693
curr_Factors:  [1.01880113e+02 3.71728102e-02]
mat_Sqrt:  [[ 1.96427422e+01  0.00000000e+00]
 [-7.71210065e-03  1.76706425e-02]]
grads:  [7.40803668e-03 1.57716191e+01]
Stock Position:  0.007408036683229582
Bond Position:  [7.8099962]


portfolio before change:  [8.57251646]
curr_Stock_Price:  102.7997006116466
curr_Factors:  [1.02799701e+02 3.64597963e-02]
mat_Sqrt:  [[ 1.96290359e+01  0.00000000e+00]
 [-7.63777939e-03  1.75003511e-02]]
grads:  [ 0.01699582 -0.39731827]
Stock Position:  0.016995819658999056
Bond Position:  [6.82535129]


portfolio before change:  [8.57729663]
curr_Stock_Price:  103.0307544476001
curr_Factors:  [1.03030754e+02 3.61590616e-02]
mat_Sqrt:  [[ 1.95918504e+01  0.00000000e+00]
 [-7.60621446e-03  1.74280268e-02]]
grads:  [3.26332033e-03 3.94568755e+00]
Stock Position:  0.0032633203325127783
Bond Position:  [8.24107428]


portfolio before change:  [8.57581192]
curr_Stock_Price:  102.260095442226
curr_Factors:  [1.02260095e+02 3.75777684e-02]
mat_Sqrt:  [[ 1.98231052e+01  0.00000000e+00]
 [-7.75399442e-03  1.77666332e-02]]
grads:  [  0.01447104 -11.13618493]
Stock Position:  0.014471042229012068
Bond Position:  [7.09600176]


portfolio before change:  [8.59057521]
curr_Stock_Price:  103.2189920778034
curr_Factors:  [1.03218992e+02 3.68538943e-02]
mat_Sqrt:  [[ 1.98153299e+01  0.00000000e+00]
 [-7.67894725e-03  1.75946785e-02]]
grads:  [ 0.00294339 -0.43433599]
Stock Position:  0.0029433856014793435
Bond Position:  [8.28676192]


portfolio before change:  [8.58760861]
curr_Stock_Price:  101.85916001881407
curr_Factors:  [1.01859160e+02 3.78666614e-02]
mat_Sqrt:  [[ 1.98211386e+01  0.00000000e+00]
 [-7.78374321e-03  1.78347962e-02]]
grads:  [-0.01080652 -9.91892883]
Stock Position:  -0.010806516373117464
Bond Position:  [9.68835129]


portfolio before change:  [8.58849781]
curr_Stock_Price:  101.88894957817759
curr_Factors:  [1.01888950e+02 3.63380409e-02]
mat_Sqrt:  [[ 1.94226212e+01  0.00000000e+00]
 [-7.62501576e-03  1.74711060e-02]]
grads:  [-5.52719966e-03  9.24700403e+00]
Stock Position:  -0.005527199659542926
Bond Position:  [9.15165838]


portfolio before change:  [8.58195211]
curr_Stock_Price:  103.28020243447307
curr_Factors:  [1.03280202e+02 3.54162551e-02]
mat_Sqrt:  [[ 1.94365151e+01  0.00000000e+00]
 [-7.52768279e-03  1.72480881e-02]]
grads:  [ -0.05188456 -47.92423773]
Stock Position:  -0.051884556023493636
Bond Position:  [13.94059956]


portfolio before change:  [8.62292523]
curr_Stock_Price:  102.52409225171962
curr_Factors:  [1.02524092e+02 3.64698396e-02]
mat_Sqrt:  [[ 1.95791061e+01  0.00000000e+00]
 [-7.63883128e-03  1.75027613e-02]]
grads:  [4.69349205e-03 5.63317098e+00]
Stock Position:  0.004693492050643823
Bond Position:  [8.14172922]


portfolio before change:  [8.62709482]
curr_Stock_Price:  103.195620576451
curr_Factors:  [1.03195621e+02 3.60177438e-02]
mat_Sqrt:  [[ 1.95848171e+01  0.00000000e+00]
 [-7.59133651e-03  1.73939371e-02]]
grads:  [ 1.10517879e-03 -3.86506372e+00]
Stock Position:  0.0011051787930723299
Bond Position:  [8.51304521]


portfolio before change:  [8.62718793]
curr_Stock_Price:  102.31694708640083
curr_Factors:  [1.02316947e+02 3.59006063e-02]
mat_Sqrt:  [[ 1.93864578e+01  0.00000000e+00]
 [-7.57898213e-03  1.73656297e-02]]
grads:  [3.35005027e-03 1.55571499e+01]
Stock Position:  0.0033500502673802736
Bond Position:  [8.28442101]


portfolio before change:  [8.63476402]
curr_Stock_Price:  104.26929655765919
curr_Factors:  [1.04269297e+02 3.45125472e-02]
mat_Sqrt:  [[ 1.93706837e+01  0.00000000e+00]
 [-7.43102116e-03  1.70266085e-02]]
grads:  [5.42900538e-03 8.37918029e+00]
Stock Position:  0.0054290053824145295
Bond Position:  [8.06868544]


portfolio before change:  [8.64100165]
curr_Stock_Price:  105.23245319659011
curr_Factors:  [1.05232453e+02 3.44121825e-02]
mat_Sqrt:  [[ 1.95211682e+01  0.00000000e+00]
 [-7.42020835e-03  1.70018332e-02]]
grads:  [2.04924814e-03 3.33342558e+00]
Stock Position:  0.0020492481393018045
Bond Position:  [8.42535424]


portfolio before change:  [8.64065281]
curr_Stock_Price:  104.5482651495547
curr_Factors:  [1.04548265e+02 3.49656339e-02]
mat_Sqrt:  [[ 1.95495846e+01  0.00000000e+00]
 [-7.47963998e-03  1.71380082e-02]]
grads:  [-0.00607439 -1.87860341]
Stock Position:  -0.006074387775172912
Bond Position:  [9.27571952]


portfolio before change:  [8.64730675]
curr_Stock_Price:  103.64374628493209
curr_Factors:  [1.03643746e+02 3.56524552e-02]
mat_Sqrt:  [[ 1.95698647e+01  0.00000000e+00]
 [-7.55274310e-03  1.73055085e-02]]
grads:  [ 0.01735999 14.14820124]
Stock Position:  0.017359993621920193
Bond Position:  [6.84805197]


portfolio before change:  [8.67014146]
curr_Stock_Price:  104.90979816422399
curr_Factors:  [1.04909798e+02 3.47514027e-02]
mat_Sqrt:  [[ 1.95569993e+01  0.00000000e+00]
 [-7.45669124e-03  1.70854260e-02]]
grads:  [3.41454920e-03 5.24483097e+00]
Stock Position:  0.003414549201748088
Bond Position:  [8.31192179]


portfolio before change:  [8.67773861]
curr_Stock_Price:  106.83043061909015
curr_Factors:  [1.06830431e+02 3.25989555e-02]
mat_Sqrt:  [[ 1.92884274e+01  0.00000000e+00]
 [-7.22207233e-03  1.65478466e-02]]
grads:  [-7.76173511e-03 -1.88469865e+01]
Stock Position:  -0.007761735110996229
Bond Position:  [9.50692811]


portfolio before change:  [8.68262813]
curr_Stock_Price:  106.35359433756331
curr_Factors:  [1.06353594e+02 3.25051844e-02]
mat_Sqrt:  [[ 1.91746961e+01  0.00000000e+00]
 [-7.21167769e-03  1.65240294e-02]]
grads:  [1.12568109e-02 1.21808394e+01]
Stock Position:  0.011256810898034954
Bond Position:  [7.48542583]


portfolio before change:  [8.67648657]
curr_Stock_Price:  105.72488228740579
curr_Factors:  [1.05724882e+02 3.32405202e-02]
mat_Sqrt:  [[ 1.92757425e+01  0.00000000e+00]
 [-7.29279317e-03  1.67098884e-02]]
grads:  [7.15545495e-03 9.04369454e+00]
Stock Position:  0.007155454952809142
Bond Position:  [7.91997694]


portfolio before change:  [8.67090269]
curr_Stock_Price:  104.80615146173118
curr_Factors:  [1.04806151e+02 3.49862630e-02]
mat_Sqrt:  [[ 1.96035873e+01  0.00000000e+00]
 [-7.48184608e-03  1.71430630e-02]]
grads:  [ 2.68271067e-02 -3.26761547e+01]
Stock Position:  0.026827106663834664
Bond Position:  [5.85925689]


portfolio before change:  [8.69940716]
curr_Stock_Price:  105.84137350811717
curr_Factors:  [1.05841374e+02 3.46482468e-02]
mat_Sqrt:  [[ 1.97013551e+01  0.00000000e+00]
 [-7.44561582e-03  1.70600490e-02]]
grads:  [-1.19326947e-02  3.86599818e+01]
Stock Position:  -0.011932694709515803
Bond Position:  [9.96237996]


portfolio before change:  [8.70041629]
curr_Stock_Price:  105.8611717125079
curr_Factors:  [1.05861172e+02 3.39554340e-02]
mat_Sqrt:  [[ 1.95070384e+01  0.00000000e+00]
 [-7.37080012e-03  1.68886247e-02]]
grads:  [ 0.00623925 -0.67287649]
Stock Position:  0.006239247324855499
Bond Position:  [8.03992225]


portfolio before change:  [8.69779145]
curr_Stock_Price:  105.2793886232261
curr_Factors:  [1.05279389e+02 3.49953054e-02]
mat_Sqrt:  [[ 1.96946491e+01  0.00000000e+00]
 [-7.48281289e-03  1.71452782e-02]]
grads:  [-0.00380543 -3.622069  ]
Stock Position:  -0.0038054310493842508
Bond Position:  [9.09842491]


portfolio before change:  [8.7009858]
curr_Stock_Price:  104.73885175738792
curr_Factors:  [1.04738852e+02 3.66499653e-02]
mat_Sqrt:  [[ 2.00513950e+01  0.00000000e+00]
 [-7.65767226e-03  1.75459314e-02]]
grads:  [-3.17469461e-03 -1.09714702e+01]
Stock Position:  -0.0031746946129671866
Bond Position:  [9.03349967]


portfolio before change:  [8.70709953]
curr_Stock_Price:  103.16878782906016
curr_Factors:  [1.03168788e+02 3.88493234e-02]
mat_Sqrt:  [[ 2.03348071e+01  0.00000000e+00]
 [-7.88409268e-03  1.80647258e-02]]
grads:  [-0.01624152 -4.92394021]
Stock Position:  -0.016241515850679525
Bond Position:  [10.38271704]


portfolio before change:  [8.71307512]
curr_Stock_Price:  102.88078080081802
curr_Factors:  [1.02880781e+02 3.98270402e-02]
mat_Sqrt:  [[ 2.05316224e+01  0.00000000e+00]
 [-7.98268529e-03  1.82906298e-02]]
grads:  [-0.00575741 -0.03642011]
Stock Position:  -0.005757407446111968
Bond Position:  [9.3054017]


portfolio before change:  [8.72209484]
curr_Stock_Price:  101.51619668720686
curr_Factors:  [1.01516197e+02 4.01792164e-02]
mat_Sqrt:  [[ 2.03486719e+01  0.00000000e+00]
 [-8.01790161e-03  1.83713205e-02]]
grads:  [0.00717563 4.11048858]
Stock Position:  0.007175632981943415
Bond Position:  [7.99365187]


portfolio before change:  [8.71517048]
curr_Stock_Price:  100.4119551698667
curr_Factors:  [1.00411955e+02 3.95371071e-02]
mat_Sqrt:  [[ 1.99658530e+01  0.00000000e+00]
 [-7.95357602e-03  1.82239321e-02]]
grads:  [0.00806206 4.33705792]
Stock Position:  0.008062064821356746
Bond Position:  [7.90564279]


portfolio before change:  [8.71273879]
curr_Stock_Price:  99.9877517869936
curr_Factors:  [9.99877518e+01 4.02301662e-02]
mat_Sqrt:  [[ 2.00550023e+01  0.00000000e+00]
 [-8.02298361e-03  1.83829648e-02]]
grads:  [-0.01337139 -3.32905753]
Stock Position:  -0.013371393972340573
Bond Position:  [10.04971441]


portfolio before change:  [8.72637002]
curr_Stock_Price:  99.06227340269861
curr_Factors:  [9.90622734e+01 4.07686187e-02]
mat_Sqrt:  [[ 2.00019017e+01  0.00000000e+00]
 [-8.07649614e-03  1.85055775e-02]]
grads:  [ -0.03197785 -16.976043  ]
Stock Position:  -0.03197785398601447
Bond Position:  [11.89416893]


portfolio before change:  [8.76620851]
curr_Stock_Price:  97.86295501069834
curr_Factors:  [9.78629550e+01 4.04655747e-02]
mat_Sqrt:  [[ 1.96861678e+01  0.00000000e+00]
 [-8.04642278e-03  1.84366707e-02]]
grads:  [6.17030789e-03 1.69847120e+01]
Stock Position:  0.006170307891556607
Bond Position:  [8.16236395]


portfolio before change:  [8.76756375]
curr_Stock_Price:  97.9172284849158
curr_Factors:  [9.79172285e+01 4.04644890e-02]
mat_Sqrt:  [[ 1.96968212e+01  0.00000000e+00]
 [-8.04631483e-03  1.84364234e-02]]
grads:  [-4.4771293e-03  5.9318319e+00]
Stock Position:  -0.0044771293026054405
Bond Position:  [9.20595185]


portfolio before change:  [8.77101058]
curr_Stock_Price:  97.4043968603518
curr_Factors:  [9.74043969e+01 4.17870078e-02]
mat_Sqrt:  [[ 1.99112809e+01  0.00000000e+00]
 [-8.17674828e-03  1.87352840e-02]]
grads:  [0.03864928 0.79058885]
Stock Position:  0.03864928159034539
Bond Position:  [5.00640062]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.79301624]
Stock Price:  97.95757188888103
PL:  [8.79301624]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.23333809e-01  1.08480407e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.49752921e-01 -7.68345310e-01]
 [-2.07019998e-02  1.98935375e-01]
 [ 2.89964300e-02 -6.73248472e-02]
 [-8.03082220e-02 -1.03730383e-01]
 [-6.49423013e-02  1.73830343e-01]
 [-1.31902303e-01 -9.04099914e-02]
 [ 1.58777531e-01  7.24384721e-02]
 [ 2.95081423e-01 -1.32937526e-01]
 [ 1.00177237e-01  1.27648677e-01]
 [-1.18183475e-02  1.39560748e-01]
 [ 2.83523024e-02  9.06241597e-02]
 [-4.55204553e-01 -5.90153700e-01]
 [ 8.08690215e-02  2.26007659e-01]
 [ 5.39335464e-02 -2.03619306e-02]
 [-5.30448413e-02  2.74830389e-01]
 [-1.62478328e-01 -1.61692204e-03]
 [ 1.49376432e-02  6.49021175e-02]
 [-9.56280673e-02 -3.84962011e-02]
 [ 2.28369898e-01  1.58121977e-01]
 [-1.08885682e-03  8.78759616e-02]
 [ 5.21894200e-03  2.05325599e-01]
 [ 8.52050883e-02  1.86373233e-01]
 [ 5.83298184e-02  1.24494010e-01]
 [ 7.35204774e-01 -4.02272304e-01]
 [-2.00075607e-01  2.68187175e-01]
 [ 1.11501179e-01  9.19303621e-03]
 [-4.52595651e-02 -6.49250453e-02]
 [ 2.77949963e-02 -2.02083467e-01]
 [-2.59583997e-02 -7.21634642e-02]
 [ 8.91927756e-02 -1.09443713e-02]
 [ 1.98094916e-01  2.17223251e-01]
 [ 1.99215056e-01  4.17172762e-02]
 [-2.27613396e-01 -2.18007188e-01]
 [ 1.18222955e-01 -2.77395497e-01]
 [-1.69736631e-01  2.07596830e-01]
 [-1.19566259e-01  1.20390692e-01]
 [-7.36786656e-02  1.18360028e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.19974203]
curr_Stock_Price:  99.41146163829217
curr_Factors:  [9.94114616e+01 3.99150179e-02]
mat_Sqrt:  [[ 1.98611606e+01  0.00000000e+00]
 [-7.99149727e-03  1.83108206e-02]]
grads:  [-3.82601398e-03  5.92438806e+00]
Stock Position:  -0.0038260139845450554
Bond Position:  [-0.81939239]


portfolio before change:  [-1.19721169]
curr_Stock_Price:  98.72333671158248
curr_Factors:  [9.87233367e+01 4.22252999e-02]
mat_Sqrt:  [[ 2.02864566e+01  0.00000000e+00]
 [-8.21951822e-03  1.88332822e-02]]
grads:  [-0.01000591 -4.67318278]
Stock Position:  -0.010005909446553631
Bond Position:  [-0.20939492]


portfolio before change:  [-1.19441345]
curr_Stock_Price:  98.44106232069103
curr_Factors:  [9.84410623e+01 4.27974398e-02]
mat_Sqrt:  [[ 2.03650362e+01  0.00000000e+00]
 [-8.27501684e-03  1.89604455e-02]]
grads:  [ 2.52599372e-02 -4.05235895e+01]
Stock Position:  0.02525993719015109
Bond Position:  [-3.6810285]


portfolio before change:  [-1.22028347]
curr_Stock_Price:  97.43512699567407
curr_Factors:  [9.74351270e+01 4.08341379e-02]
mat_Sqrt:  [[ 1.96891629e+01  0.00000000e+00]
 [-8.08298340e-03  1.85204416e-02]]
grads:  [3.35821874e-03 1.07413947e+01]
Stock Position:  0.003358218738492679
Bond Position:  [-1.54749194]


portfolio before change:  [-1.21987188]
curr_Stock_Price:  97.61529477000708
curr_Factors:  [9.76152948e+01 4.00131048e-02]
mat_Sqrt:  [[ 1.95262568e+01  0.00000000e+00]
 [-8.00131037e-03  1.83333052e-02]]
grads:  [-1.97960205e-05 -3.67227002e+00]
Stock Position:  -1.979602054118074e-05
Bond Position:  [-1.21793948]


portfolio before change:  [-1.22002442]
curr_Stock_Price:  97.63015308560404
curr_Factors:  [9.76301531e+01 4.12414850e-02]
mat_Sqrt:  [[ 1.98267312e+01  0.00000000e+00]
 [-8.12319986e-03  1.86125891e-02]]
grads:  [-0.00633387 -5.57313024]
Stock Position:  -0.006333866729037171
Bond Position:  [-0.60164805]


portfolio before change:  [-1.22469968]
curr_Stock_Price:  98.35641529601814
curr_Factors:  [9.83564153e+01 4.05030903e-02]
mat_Sqrt:  [[ 1.97946019e+01  0.00000000e+00]
 [-8.05015183e-03  1.84452150e-02]]
grads:  [5.51841358e-04 9.42414292e+00]
Stock Position:  0.0005518413584911264
Bond Position:  [-1.27897682]


portfolio before change:  [-1.22476094]
curr_Stock_Price:  98.53513125679578
curr_Factors:  [9.85351313e+01 4.05409561e-02]
mat_Sqrt:  [[ 1.98398367e+01  0.00000000e+00]
 [-8.05391394e-03  1.84538351e-02]]
grads:  [-0.00863719 -4.89925215]
Stock Position:  -0.008637190947752253
Bond Position:  [-0.3736942]


portfolio before change:  [-1.23344618]
curr_Stock_Price:  99.53528595586803
curr_Factors:  [9.95352860e+01 4.04632945e-02]
mat_Sqrt:  [[ 2.00220107e+01  0.00000000e+00]
 [-8.04619607e-03  1.84361513e-02]]
grads:  [0.00950915 3.9291537 ]
Stock Position:  0.009509148443283514
Bond Position:  [-2.17994199]


portfolio before change:  [-1.22407063]
curr_Stock_Price:  100.5498943121095
curr_Factors:  [1.00549894e+02 3.94850375e-02]
mat_Sqrt:  [[ 1.99801110e+01  0.00000000e+00]
 [-7.94833693e-03  1.82119278e-02]]
grads:  [ 0.01186494 -7.29947576]
Stock Position:  0.01186493561582664
Bond Position:  [-2.41708866]


portfolio before change:  [-1.23601324]
curr_Stock_Price:  99.56881422447819
curr_Factors:  [9.95688142e+01 3.94091387e-02]
mat_Sqrt:  [[ 1.97661372e+01  0.00000000e+00]
 [-7.94069404e-03  1.81944158e-02]]
grads:  [0.0078866 7.0158162]
Stock Position:  0.007886603474810619
Bond Position:  [-2.021273]


portfolio before change:  [-1.24001708]
curr_Stock_Price:  99.09317693457771
curr_Factors:  [9.90931769e+01 3.92537599e-02]
mat_Sqrt:  [[ 1.96328968e+01  0.00000000e+00]
 [-7.92502466e-03  1.81585127e-02]]
grads:  [2.50044388e-03 7.68569269e+00]
Stock Position:  0.002500443879693298
Bond Position:  [-1.48779401]


portfolio before change:  [-1.23864621]
curr_Stock_Price:  99.7158091174891
curr_Factors:  [9.97158091e+01 3.95369164e-02]
mat_Sqrt:  [[ 1.98273839e+01  0.00000000e+00]
 [-7.95355683e-03  1.82238881e-02]]
grads:  [3.42475481e-03 4.97282244e+00]
Stock Position:  0.0034247548110061753
Bond Position:  [-1.5801484]


portfolio before change:  [-1.23435436]
curr_Stock_Price:  101.02667012378755
curr_Factors:  [1.01026670e+02 3.93992094e-02]
mat_Sqrt:  [[ 2.00530203e+01  0.00000000e+00]
 [-7.93969364e-03  1.81921236e-02]]
grads:  [ -0.03554421 -32.44006661]
Stock Position:  -0.03554420902709547
Bond Position:  [2.35655872]


portfolio before change:  [-1.18371547]
curr_Stock_Price:  99.61028463971418
curr_Factors:  [9.96102846e+01 4.08518905e-02]
mat_Sqrt:  [[ 2.01330819e+01  0.00000000e+00]
 [-8.08474025e-03  1.85244671e-02]]
grads:  [8.91601450e-03 1.22004945e+01]
Stock Position:  0.008916014498895439
Bond Position:  [-2.07184221]


portfolio before change:  [-1.17514784]
curr_Stock_Price:  100.60025903215775
curr_Factors:  [1.00600259e+02 4.13605167e-02]
mat_Sqrt:  [[ 2.04593615e+01  0.00000000e+00]
 [-8.13491406e-03  1.86394297e-02]]
grads:  [ 0.00220177 -1.09241167]
Stock Position:  0.0022017730750685206
Bond Position:  [-1.39664678]


portfolio before change:  [-1.17095755]
curr_Stock_Price:  102.58269884563866
curr_Factors:  [1.02582699e+02 4.03895008e-02]
mat_Sqrt:  [[ 2.06161879e+01  0.00000000e+00]
 [-8.03885572e-03  1.84193324e-02]]
grads:  [3.24507006e-03 1.49207573e+01]
Stock Position:  0.003245070063013833
Bond Position:  [-1.50384559]


portfolio before change:  [-1.17753292]
curr_Stock_Price:  100.61436661901647
curr_Factors:  [1.00614367e+02 4.09408606e-02]
mat_Sqrt:  [[ 2.03581580e+01  0.00000000e+00]
 [-8.09353921e-03  1.85446280e-02]]
grads:  [-0.00801566 -0.08719086]
Stock Position:  -0.008015656943566936
Bond Position:  [-0.37104267]


portfolio before change:  [-1.1861401]
curr_Stock_Price:  101.68237569684378
curr_Factors:  [1.01682376e+02 4.11380843e-02]
mat_Sqrt:  [[ 2.06237538e+01  0.00000000e+00]
 [-8.11301022e-03  1.85892417e-02]]
grads:  [2.09773884e-03 3.49138058e+00]
Stock Position:  0.0020977388410179185
Bond Position:  [-1.39944316]


portfolio before change:  [-1.18388734]
curr_Stock_Price:  102.83966605040524
curr_Factors:  [1.02839666e+02 4.09482250e-02]
mat_Sqrt:  [[ 2.08102932e+01  0.00000000e+00]
 [-8.09426711e-03  1.85462959e-02]]
grads:  [-0.00540258 -2.07568139]
Stock Position:  -0.005402575832046417
Bond Position:  [-0.62828825]


portfolio before change:  [-1.18256523]
curr_Stock_Price:  102.58040996388628
curr_Factors:  [1.02580410e+02 4.13380849e-02]
mat_Sqrt:  [[ 2.08564125e+01  0.00000000e+00]
 [-8.13270778e-03  1.86343745e-02]]
grads:  [0.01425844 8.48549957]
Stock Position:  0.014258443871181256
Bond Position:  [-2.64520225]


portfolio before change:  [-1.18386422]
curr_Stock_Price:  102.5124981659569
curr_Factors:  [1.02512498e+02 3.99996920e-02]
mat_Sqrt:  [[ 2.05024207e+01  0.00000000e+00]
 [-7.99996920e-03  1.83302322e-02]]
grads:  [1.81751012e-03 4.79404519e+00]
Stock Position:  0.001817510116277227
Bond Position:  [-1.37018172]


portfolio before change:  [-1.18324807]
curr_Stock_Price:  102.94574624962719
curr_Factors:  [1.02945746e+02 3.84518666e-02]
mat_Sqrt:  [[ 2.01867832e+01  0.00000000e+00]
 [-7.84365900e-03  1.79720805e-02]]
grads:  [4.69764692e-03 1.14246984e+01]
Stock Position:  0.004697646923525875
Bond Position:  [-1.66685084]


portfolio before change:  [-1.17653901]
curr_Stock_Price:  104.41827842633185
curr_Factors:  [1.04418278e+02 3.65380657e-02]
mat_Sqrt:  [[ 1.99594838e+01  0.00000000e+00]
 [-7.64597313e-03  1.75191253e-02]]
grads:  [8.34415548e-03 1.06382728e+01]
Stock Position:  0.008344155480763399
Bond Position:  [-2.04782136]


portfolio before change:  [-1.1764717]
curr_Stock_Price:  104.45702374571471
curr_Factors:  [1.04457024e+02 3.61765180e-02]
mat_Sqrt:  [[ 1.98678572e+01  0.00000000e+00]
 [-7.60805026e-03  1.74322331e-02]]
grads:  [5.67063965e-03 7.14159849e+00]
Stock Position:  0.00567063965224505
Bond Position:  [-1.76880984]


portfolio before change:  [-1.18512186]
curr_Stock_Price:  102.97058743578764
curr_Factors:  [1.02970587e+02 3.59643487e-02]
mat_Sqrt:  [[ 1.95276189e+01  0.00000000e+00]
 [-7.58570748e-03  1.73810394e-02]]
grads:  [  0.02865883 -23.14431813]
Stock Position:  0.02865883188540495
Bond Position:  [-4.13613862]


portfolio before change:  [-1.19336356]
curr_Stock_Price:  102.70104917794029
curr_Factors:  [1.02701049e+02 3.40989657e-02]
mat_Sqrt:  [[ 1.89646784e+01  0.00000000e+00]
 [-7.38636210e-03  1.69242817e-02]]
grads:  [-4.37809307e-03  1.58462959e+01]
Stock Position:  -0.0043780930723925126
Bond Position:  [-0.74372881]


portfolio before change:  [-1.19449129]
curr_Stock_Price:  102.9373963555956
curr_Factors:  [1.02937396e+02 3.37622837e-02]
mat_Sqrt:  [[ 1.89142483e+01  0.00000000e+00]
 [-7.34980638e-03  1.68405220e-02]]
grads:  [0.00610721 0.54588784]
Stock Position:  0.006107213293226871
Bond Position:  [-1.82315192]


portfolio before change:  [-1.18844091]
curr_Stock_Price:  103.96540682517727
curr_Factors:  [1.03965407e+02 3.24299506e-02]
mat_Sqrt:  [[ 1.87224208e+01  0.00000000e+00]
 [-7.20332708e-03  1.65048958e-02]]
grads:  [-3.93085803e-03 -3.93368404e+00]
Stock Position:  -0.003930858026303132
Bond Position:  [-0.77976766]


portfolio before change:  [-1.19210114]
curr_Stock_Price:  104.87176166968842
curr_Factors:  [1.04871762e+02 3.10471294e-02]
mat_Sqrt:  [[ 1.84786096e+01  0.00000000e+00]
 [-7.04807825e-03  1.61491760e-02]]
grads:  [-3.26872318e-03 -1.25135466e+01]
Stock Position:  -0.0032687231780284564
Bond Position:  [-0.84930439]


portfolio before change:  [-1.19315757]
curr_Stock_Price:  105.16247391981483
curr_Factors:  [1.05162474e+02 3.10114155e-02]
mat_Sqrt:  [[ 1.85191730e+01  0.00000000e+00]
 [-7.04402334e-03  1.61398851e-02]]
grads:  [-3.10235870e-03 -4.47112627e+00]
Stock Position:  -0.0031023586952554135
Bond Position:  [-0.86690586]


portfolio before change:  [-1.19561966]
curr_Stock_Price:  105.9211593564358
curr_Factors:  [1.05921159e+02 3.20941297e-02]
mat_Sqrt:  [[ 1.89756005e+01  0.00000000e+00]
 [-7.16593382e-03  1.64192171e-02]]
grads:  [ 0.00444867 -0.66655866]
Stock Position:  0.004448674000488152
Bond Position:  [-1.66682836]


portfolio before change:  [-1.20097668]
curr_Stock_Price:  104.76381177679225
curr_Factors:  [1.04763812e+02 3.19173992e-02]
mat_Sqrt:  [[ 1.87165173e+01  0.00000000e+00]
 [-7.14617651e-03  1.63739474e-02]]
grads:  [ 0.01564922 13.26639486]
Stock Position:  0.015649221032298283
Bond Position:  [-2.84044873]


portfolio before change:  [-1.20972743]
curr_Stock_Price:  104.22732076754448
curr_Factors:  [1.04227321e+02 3.26289347e-02]
mat_Sqrt:  [[ 1.88270823e+01  0.00000000e+00]
 [-7.22539242e-03  1.65554538e-02]]
grads:  [0.01154836 2.51985096]
Stock Position:  0.01154836232359422
Bond Position:  [-2.41338229]


portfolio before change:  [-1.21070789]
curr_Stock_Price:  104.16854422231417
curr_Factors:  [1.04168544e+02 3.24609956e-02]
mat_Sqrt:  [[ 1.87679792e+01  0.00000000e+00]
 [-7.20677410e-03  1.65127939e-02]]
grads:  [ -0.01719735 -13.20231988]
Stock Position:  -0.017197351414753398
Bond Position:  [0.58071517]


portfolio before change:  [-1.2081663]
curr_Stock_Price:  104.02497565627493
curr_Factors:  [1.04024976e+02 3.31061627e-02]
mat_Sqrt:  [[ 1.89274473e+01  0.00000000e+00]
 [-7.27803960e-03  1.66760837e-02]]
grads:  [-1.50171617e-04 -1.66343311e+01]
Stock Position:  -0.00015017161689050612
Bond Position:  [-1.1925447]


portfolio before change:  [-1.20847561]
curr_Stock_Price:  105.09198298755793
curr_Factors:  [1.05091983e+02 3.17972046e-02]
mat_Sqrt:  [[ 1.87397614e+01  0.00000000e+00]
 [-7.13270827e-03  1.63430878e-02]]
grads:  [-4.22278305e-03  1.27024240e+01]
Stock Position:  -0.004222783051989882
Bond Position:  [-0.76469497]


portfolio before change:  [-1.20580819]
curr_Stock_Price:  104.43767283003591
curr_Factors:  [1.04437673e+02 3.07349885e-02]
mat_Sqrt:  [[ 1.83093832e+01  0.00000000e+00]
 [-7.01255885e-03  1.60677909e-02]]
grads:  [-3.66060685e-03  7.49267232e+00]
Stock Position:  -0.003660606847027599
Bond Position:  [-0.82350293]


portfolio before change:  [-1.20273963]
curr_Stock_Price:  103.57128445148685
curr_Factors:  [1.03571284e+02 3.03459259e-02]
mat_Sqrt:  [[ 1.80422027e+01  0.00000000e+00]
 [-6.96803282e-03  1.59657689e-02]]
grads:  [-1.22058900e-03  7.41336223e+00]
Stock Position:  -0.0012205890004402808
Bond Position:  [-1.07632166]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.20271073]
Stock Price:  103.437373651313
PL:  [-4.64008438]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-5.66773261e-01 -2.76650278e-01]
 [-1.72295727e-01 -8.51751129e-02]
 [ 8.48915877e-01 -7.66014600e-01]
 [-3.99196310e-02  1.09016692e-01]
 [ 3.98120708e-02 -3.15896599e-02]
 [-8.94776914e-02 -6.63169280e-02]
 [-4.42654857e-03  3.12282883e-01]
 [ 1.31854411e-01 -2.89022349e-02]
 [ 1.34432326e-01  8.01810260e-02]
 [ 3.35862682e-01 -1.62765524e-01]
 [ 6.32309789e-02 -2.21560385e-03]
 [-1.17669612e-01 -1.87628794e-01]
 [-1.90357012e-01  1.65828862e-01]
 [-5.44058461e-01 -6.94498565e-01]
 [ 4.66497993e-03 -9.81529584e-02]
 [ 4.93560025e-02 -7.16676309e-02]
 [-5.31715931e-02  2.81955517e-01]
 [-7.32424961e-02  9.61602258e-02]
 [ 1.48893879e-02  6.61003020e-02]
 [-9.15536977e-02 -3.84756505e-02]
 [ 2.40011250e-01  2.01712473e-01]
 [ 3.97757228e-02  8.06067595e-03]
 [-9.42700818e-03  4.87474222e-02]
 [ 1.04338153e-01  1.93036593e-01]
 [ 6.13973952e-02  1.30480524e-01]
 [ 7.23869492e-01 -3.50645949e-01]
 [-1.62654487e-01  2.23079234e-01]
 [ 1.26949091e-01  4.38378258e-03]
 [-4.09980728e-03 -1.02336834e-01]
 [-6.28533302e-02 -3.18142835e-02]
 [-3.04715266e-01 -8.95890875e-02]
 [-1.17932299e-01 -1.18258703e-04]
 [ 1.42289797e-01  1.24228849e-01]
 [ 2.13316154e-01  3.44827905e-02]
 [-2.12250100e-01 -2.32846087e-01]
 [ 1.38281675e-01 -2.14676193e-01]
 [-2.11898619e-01  1.76889871e-01]
 [-1.16293186e-01  1.22598774e-01]
 [-1.80850689e-01  1.45626810e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.94390862]
curr_Stock_Price:  97.49198388062312
curr_Factors:  [9.74919839e+01 4.07544193e-02]
mat_Sqrt:  [[ 1.96814124e+01  0.00000000e+00]
 [-8.07508953e-03  1.85023545e-02]]
grads:  [ -0.03493211 -14.9521661 ]
Stock Position:  -0.03493211386466448
Bond Position:  [-10.53830754]


portfolio before change:  [-13.93217882]
curr_Stock_Price:  97.11848318502417
curr_Factors:  [9.71184832e+01 4.16421694e-02]
mat_Sqrt:  [[ 1.98183988e+01  0.00000000e+00]
 [-8.16256523e-03  1.87027865e-02]]
grads:  [-0.01056943 -4.55414026]
Stock Position:  -0.010569430715235544
Bond Position:  [-12.90569174]


portfolio before change:  [-13.94832473]
curr_Stock_Price:  98.49344815131606
curr_Factors:  [9.84934482e+01 4.15532586e-02]
mat_Sqrt:  [[ 2.00775116e+01  0.00000000e+00]
 [-8.15384656e-03  1.86828095e-02]]
grads:  [ 2.56306512e-02 -4.10010389e+01]
Stock Position:  0.02563065122409082
Bond Position:  [-16.47277595]


portfolio before change:  [-13.94344672]
curr_Stock_Price:  98.76410991403958
curr_Factors:  [9.87641099e+01 3.97635691e-02]
mat_Sqrt:  [[ 1.96943582e+01  0.00000000e+00]
 [-7.97632187e-03  1.82760494e-02]]
grads:  [3.88900926e-04 5.96500316e+00]
Stock Position:  0.00038890092636144927
Bond Position:  [-13.98185617]


portfolio before change:  [-13.94526316]
curr_Stock_Price:  98.58771029015537
curr_Factors:  [9.85877103e+01 3.77487905e-02]
mat_Sqrt:  [[ 1.91546535e+01  0.00000000e+00]
 [-7.77161918e-03  1.78070166e-02]]
grads:  [ 1.35868878e-03 -1.77400070e+00]
Stock Position:  0.0013586887846661199
Bond Position:  [-14.07921318]


portfolio before change:  [-13.94526553]
curr_Stock_Price:  99.88134283254341
curr_Factors:  [9.98813428e+01 3.69834131e-02]
mat_Sqrt:  [[ 1.92082530e+01  0.00000000e+00]
 [-7.69242881e-03  1.76255687e-02]]
grads:  [-0.0061651  -3.76254119]
Stock Position:  -0.006165098500389652
Bond Position:  [-13.32948721]


portfolio before change:  [-13.95033226]
curr_Stock_Price:  100.43290591918974
curr_Factors:  [1.00432906e+02 3.70983006e-02]
mat_Sqrt:  [[ 1.93443008e+01  0.00000000e+00]
 [-7.70436765e-03  1.76529240e-02]]
grads:  [6.81672998e-03 1.76901506e+01]
Stock Position:  0.00681672998014092
Bond Position:  [-14.63495626]


portfolio before change:  [-13.95419939]
curr_Stock_Price:  100.13398762828693
curr_Factors:  [1.00133988e+02 3.86490207e-02]
mat_Sqrt:  [[ 1.96856953e+01  0.00000000e+00]
 [-7.86374167e-03  1.80180957e-02]]
grads:  [ 0.00605721 -1.60406712]
Stock Position:  0.006057212586306166
Bond Position:  [-14.56073224]


portfolio before change:  [-13.95116304]
curr_Stock_Price:  100.93576778980744
curr_Factors:  [1.00935768e+02 3.91555773e-02]
mat_Sqrt:  [[ 1.99729358e+01  0.00000000e+00]
 [-7.91510731e-03  1.81357892e-02]]
grads:  [0.00848279 4.42114899]
Stock Position:  0.008482788738722795
Bond Position:  [-14.80737984]


portfolio before change:  [-13.947344]
curr_Stock_Price:  101.6041901390109
curr_Factors:  [1.01604190e+02 3.84272949e-02]
mat_Sqrt:  [[ 1.99173486e+01  0.00000000e+00]
 [-7.84115245e-03  1.79663373e-02]]
grads:  [ 0.01329625 -9.05947168]
Stock Position:  0.013296246825791978
Bond Position:  [-15.29829839]


portfolio before change:  [-13.93915087]
curr_Stock_Price:  102.36421881977185
curr_Factors:  [1.02364219e+02 3.80123933e-02]
mat_Sqrt:  [[ 1.99577135e+01  0.00000000e+00]
 [-7.79870689e-03  1.78690823e-02]]
grads:  [ 0.0031198  -0.12399091]
Stock Position:  0.0031197967755829605
Bond Position:  [-14.25850643]


portfolio before change:  [-13.94066772]
curr_Stock_Price:  102.44934514162875
curr_Factors:  [1.02449345e+02 3.80613600e-02]
mat_Sqrt:  [[ 1.99871715e+01  0.00000000e+00]
 [-7.80372834e-03  1.78805879e-02]]
grads:  [-9.98428075e-03 -1.04934354e+01]
Stock Position:  -0.00998428075026538
Bond Position:  [-12.9177847]


portfolio before change:  [-13.93867316]
curr_Stock_Price:  102.08783863039446
curr_Factors:  [1.02087839e+02 3.86743932e-02]
mat_Sqrt:  [[ 2.00763965e+01  0.00000000e+00]
 [-7.86632246e-03  1.80240091e-02]]
grads:  [-5.87672013e-03  9.20044266e+00]
Stock Position:  -0.0058767201298844775
Bond Position:  [-13.33873151]


portfolio before change:  [-13.94013566]
curr_Stock_Price:  102.05296408701851
curr_Factors:  [1.02052964e+02 3.91703543e-02]
mat_Sqrt:  [[ 2.01978142e+01  0.00000000e+00]
 [-7.91660072e-03  1.81392110e-02]]
grads:  [ -0.04194328 -38.28714292]
Stock Position:  -0.04194327541501457
Bond Position:  [-9.65970008]


portfolio before change:  [-14.00657995]
curr_Stock_Price:  103.60832071691412
curr_Factors:  [1.03608321e+02 3.87575144e-02]
mat_Sqrt:  [[ 2.03972958e+01  0.00000000e+00]
 [-7.87477131e-03  1.80433678e-02]]
grads:  [-1.87144823e-03 -5.43983582e+00]
Stock Position:  -0.0018714482294355528
Bond Position:  [-13.81268234]


portfolio before change:  [-14.00766971]
curr_Stock_Price:  103.26797840762653
curr_Factors:  [1.03267978e+02 3.77790769e-02]
mat_Sqrt:  [[ 2.00720323e+01  0.00000000e+00]
 [-7.77473620e-03  1.78141586e-02]]
grads:  [ 9.00640446e-04 -4.02307135e+00]
Stock Position:  0.0009006404456958309
Bond Position:  [-14.10067703]


portfolio before change:  [-14.0097667]
curr_Stock_Price:  102.89680133738719
curr_Factors:  [1.02896801e+02 3.93508547e-02]
mat_Sqrt:  [[ 2.04116898e+01  0.00000000e+00]
 [-7.93481994e-03  1.81809565e-02]]
grads:  [3.42371865e-03 1.55082884e+01]
Stock Position:  0.003423718653370324
Bond Position:  [-14.3620564]


portfolio before change:  [-14.01319416]
curr_Stock_Price:  102.42010210560554
curr_Factors:  [1.02420102e+02 3.74808729e-02]
mat_Sqrt:  [[ 1.98285087e+01  0.00000000e+00]
 [-7.74399101e-03  1.77437125e-02]]
grads:  [-1.57726097e-03  5.41939720e+00]
Stock Position:  -0.00157726096863896
Bond Position:  [-13.85165093]


portfolio before change:  [-14.01467148]
curr_Stock_Price:  102.25891158901337
curr_Factors:  [1.02258912e+02 3.78357010e-02]
mat_Sqrt:  [[ 1.98907912e+01  0.00000000e+00]
 [-7.78056050e-03  1.78275037e-02]]
grads:  [2.19890322e-03 3.70777104e+00]
Stock Position:  0.002198903219814017
Bond Position:  [-14.23952893]


portfolio before change:  [-14.01561089]
curr_Stock_Price:  102.64121348630597
curr_Factors:  [1.02641213e+02 3.69613228e-02]
mat_Sqrt:  [[ 1.97331097e+01  0.00000000e+00]
 [-7.69013111e-03  1.76203040e-02]]
grads:  [-0.00549056 -2.18359744]
Stock Position:  -0.005490561285271038
Bond Position:  [-13.45205302]


portfolio before change:  [-14.01955502]
curr_Stock_Price:  103.0532882535693
curr_Factors:  [1.03053288e+02 3.64854820e-02]
mat_Sqrt:  [[ 1.96843871e+01  0.00000000e+00]
 [-7.64046931e-03  1.75065145e-02]]
grads:  [ 0.01666528 11.52213785]
Stock Position:  0.016665278340611718
Bond Position:  [-15.73696676]


portfolio before change:  [-14.00879961]
curr_Stock_Price:  103.81671098869556
curr_Factors:  [1.03816711e+02 3.54938555e-02]
mat_Sqrt:  [[ 1.95588743e+01  0.00000000e+00]
 [-7.53592521e-03  1.72669739e-02]]
grads:  [0.00221351 0.46682621]
Stock Position:  0.002213506241137374
Bond Position:  [-14.23859855]


portfolio before change:  [-14.00978388]
curr_Stock_Price:  104.17617453793333
curr_Factors:  [1.04176175e+02 3.42754173e-02]
mat_Sqrt:  [[ 1.92867824e+01  0.00000000e+00]
 [-7.40544852e-03  1.69680142e-02]]
grads:  [6.14312477e-04 2.87290084e+00]
Stock Position:  0.0006143124765490333
Bond Position:  [-14.0737806]


portfolio before change:  [-14.01086245]
curr_Stock_Price:  105.28433596514509
curr_Factors:  [1.05284336e+02 3.35394094e-02]
mat_Sqrt:  [[ 1.92815289e+01  0.00000000e+00]
 [-7.32550715e-03  1.67848455e-02]]
grads:  [9.78066779e-03 1.15006476e+01]
Stock Position:  0.009780667786961378
Bond Position:  [-15.04061356]


portfolio before change:  [-14.0178253]
curr_Stock_Price:  104.76467259022866
curr_Factors:  [1.04764673e+02 3.41875367e-02]
mat_Sqrt:  [[ 1.93708539e+01  0.00000000e+00]
 [-7.39594880e-03  1.69462476e-02]]
grads:  [6.10937265e-03 7.69967060e+00]
Stock Position:  0.006109372646644319
Bond Position:  [-14.65787172]


portfolio before change:  [-14.0343177]
curr_Stock_Price:  102.36507253073879
curr_Factors:  [1.02365073e+02 3.71542988e-02]
mat_Sqrt:  [[ 1.97313288e+01  0.00000000e+00]
 [-7.71018016e-03  1.76662421e-02]]
grads:  [  0.02893039 -19.84836089]
Stock Position:  0.028930390835096787
Bond Position:  [-16.99577926]


portfolio before change:  [-14.0375466]
curr_Stock_Price:  102.32690167688483
curr_Factors:  [1.02326902e+02 3.78493056e-02]
mat_Sqrt:  [[ 1.99075943e+01  0.00000000e+00]
 [-7.78195919e-03  1.78307085e-02]]
grads:  [-3.27989040e-03  1.25109573e+01]
Stock Position:  -0.003279890395476236
Bond Position:  [-13.70192558]


portfolio before change:  [-14.04236976]
curr_Stock_Price:  103.2751979351979
curr_Factors:  [1.03275198e+02 3.77460390e-02]
mat_Sqrt:  [[ 2.00646564e+01  0.00000000e+00]
 [-7.77133594e-03  1.78063676e-02]]
grads:  [0.00642235 0.24619185]
Stock Position:  0.006422354187754285
Bond Position:  [-14.70563966]


portfolio before change:  [-14.04763856]
curr_Stock_Price:  102.74105142482644
curr_Factors:  [1.02741051e+02 3.77579087e-02]
mat_Sqrt:  [[ 1.99640189e+01  0.00000000e+00]
 [-7.77255775e-03  1.78091671e-02]]
grads:  [-2.44255745e-03 -5.74630093e+00]
Stock Position:  -0.0024425574520355498
Bond Position:  [-13.79668763]


portfolio before change:  [-14.04732669]
curr_Stock_Price:  101.90727061680772
curr_Factors:  [1.01907271e+02 3.83095958e-02]
mat_Sqrt:  [[ 1.99461442e+01  0.00000000e+00]
 [-7.82913490e-03  1.79388017e-02]]
grads:  [-0.00384727 -1.7734899 ]
Stock Position:  -0.003847270980121885
Bond Position:  [-13.65526181]


portfolio before change:  [-14.05352705]
curr_Stock_Price:  103.07520099612886
curr_Factors:  [1.03075201e+02 3.68601528e-02]
mat_Sqrt:  [[ 1.97894059e+01  0.00000000e+00]
 [-7.67959924e-03  1.75961724e-02]]
grads:  [-0.0173737  -5.09139632]
Stock Position:  -0.017373697388629525
Bond Position:  [-12.2627297]


portfolio before change:  [-14.04189813]
curr_Stock_Price:  102.31762750184569
curr_Factors:  [1.02317628e+02 3.80082823e-02]
mat_Sqrt:  [[ 1.99475509e+01  0.00000000e+00]
 [-7.79828518e-03  1.78681161e-02]]
grads:  [-0.00591471 -0.00661842]
Stock Position:  -0.005914706593213259
Bond Position:  [-13.43671939]


portfolio before change:  [-14.0454397]
curr_Stock_Price:  102.63241428697903
curr_Factors:  [1.02632414e+02 3.81736691e-02]
mat_Sqrt:  [[ 2.00524064e+01  0.00000000e+00]
 [-7.81523324e-03  1.79069489e-02]]
grads:  [0.00979971 6.93746596]
Stock Position:  0.009799707205786157
Bond Position:  [-15.05120731]


portfolio before change:  [-14.02402858]
curr_Stock_Price:  105.00928551598352
curr_Factors:  [1.05009286e+02 3.76639295e-02]
mat_Sqrt:  [[ 2.03793589e+01  0.00000000e+00]
 [-7.76287879e-03  1.77869898e-02]]
grads:  [0.01120573 1.9386524 ]
Stock Position:  0.011205734153970469
Bond Position:  [-15.20073471]


portfolio before change:  [-14.02745487]
curr_Stock_Price:  104.87309756452785
curr_Factors:  [1.04873098e+02 3.84253657e-02]
mat_Sqrt:  [[ 2.05576326e+01  0.00000000e+00]
 [-7.84095562e-03  1.79658863e-02]]
grads:  [ -0.01526793 -12.9604564 ]
Stock Position:  -0.015267928461650386
Bond Position:  [-12.42625992]


portfolio before change:  [-14.02927217]
curr_Stock_Price:  104.89038334034576
curr_Factors:  [1.04890383e+02 3.96152701e-02]
mat_Sqrt:  [[ 2.08769467e+01  0.00000000e+00]
 [-7.96143405e-03  1.82419371e-02]]
grads:  [ 2.13581533e-03 -1.17682784e+01]
Stock Position:  0.0021358153294965543
Bond Position:  [-14.25329866]


portfolio before change:  [-14.02648925]
curr_Stock_Price:  107.02759737954857
curr_Factors:  [1.07027597e+02 3.95254646e-02]
mat_Sqrt:  [[ 2.12781697e+01  0.00000000e+00]
 [-7.95240488e-03  1.82212487e-02]]
grads:  [-6.33031659e-03  9.70788962e+00]
Stock Position:  -0.006330316585084566
Bond Position:  [-13.34897068]


portfolio before change:  [-14.02901797]
curr_Stock_Price:  107.1634504785479
curr_Factors:  [1.07163450e+02 3.75975091e-02]
mat_Sqrt:  [[ 2.07790757e+01  0.00000000e+00]
 [-7.75603085e-03  1.77712992e-02]]
grads:  [-3.02163077e-03  6.89869504e+00]
Stock Position:  -0.0030216307665599713
Bond Position:  [-13.70520959]


portfolio before change:  [-14.02785875]
curr_Stock_Price:  106.21281325165647
curr_Factors:  [1.06212813e+02 3.83537645e-02]
mat_Sqrt:  [[ 2.08008418e+01  0.00000000e+00]
 [-7.83364686e-03  1.79491399e-02]]
grads:  [-5.63890345e-03  8.11330300e+00]
Stock Position:  -0.005638903453187566
Bond Position:  [-13.42893495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.02948672]
Stock Price:  106.20381254338224
PL:  [-20.23329926]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.54286108e+02 -4.92586898e+01]
 [-1.27606016e-01  1.03770452e-01]
 [-1.64573137e-01 -8.80113702e-02]
 [ 8.47573124e-01 -7.62720151e-01]
 [-3.14307182e-02  1.48736044e-01]
 [-2.75732728e-02  1.43950307e-02]
 [-4.73271056e-02 -4.09729369e-02]
 [ 4.08416893e-03  3.15671671e-01]
 [ 1.73744366e-01 -1.63300202e-02]
 [ 1.22525708e-01  8.39677115e-02]
 [ 3.46796503e-01 -1.70748471e-01]
 [ 6.42886716e-02  1.43643071e-03]
 [-1.05249096e-01 -1.83258973e-01]
 [-1.93036153e-01  1.65531647e-01]
 [-6.16471187e-01 -7.79535860e-01]
 [ 6.98005071e-02  2.01947935e-01]
 [ 5.47061364e-02 -2.08541884e-02]
 [-5.21701715e-02  2.25662367e-01]
 [-1.28279549e-01 -1.23919013e-03]
 [ 1.50051328e-02  6.32263403e-02]
 [-6.41375791e-02 -5.11095213e-02]
 [ 2.37907480e-01  2.17003262e-01]
 [ 1.48358617e-02  5.07676397e-02]
 [-2.16683753e-04  1.79896673e-01]
 [ 3.70136900e-02  1.69592421e-01]
 [ 3.86279040e-02  8.60448323e-02]
 [ 7.22102966e-01 -3.41165832e-01]
 [-8.56894887e-02  1.29991872e-01]
 [-5.38400994e-02  7.84734670e-02]
 [ 6.03195827e-02 -1.67796595e-01]
 [-3.22035083e-02 -3.88084231e-02]
 [-3.64246156e-01 -9.35099085e-02]
 [-9.32698593e-02 -1.39828301e-03]
 [ 1.07505218e-01  6.62633577e-02]
 [ 1.74158018e-01  5.45726428e-02]
 [-2.89857103e-01 -1.80682425e-01]
 [-1.20389015e-01 -4.14350220e-01]
 [-1.00033610e-01  2.69819021e-01]
 [-1.21990114e-01  1.18755510e-01]
 [-4.42776209e-02  1.11035834e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.28610848 -49.25868982]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63939269 -2687.28184235]
init_Out:  [2.79044403]
Stock Position:  6.639392687216187
Bond position:  [-661.14882469]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.29249105]
curr_Stock_Price:  99.39749213501199
curr_Factors:  [9.93974921e+01 4.08476087e-02]
mat_Sqrt:  [[ 2.00890197e+01  0.00000000e+00]
 [-8.08431654e-03  1.85234962e-02]]
grads:  [-4.09760551e-03  5.60209858e+00]
Stock Position:  -0.004097605513497662
Bond Position:  [-0.88519934]


portfolio before change:  [-1.29052914]
curr_Stock_Price:  98.89169183155094
curr_Factors:  [9.88916918e+01 4.04221631e-02]
mat_Sqrt:  [[ 1.98824355e+01  0.00000000e+00]
 [-8.04210550e-03  1.84267786e-02]]
grads:  [-0.01020923 -4.77627544]
Stock Position:  -0.010209234589857466
Bond Position:  [-0.28092066]


portfolio before change:  [-1.28710996]
curr_Stock_Price:  98.55334215694849
curr_Factors:  [9.85533422e+01 4.08800530e-02]
mat_Sqrt:  [[ 1.99263191e+01  0.00000000e+00]
 [-8.08752650e-03  1.85308512e-02]]
grads:  [ 2.58298964e-02 -4.11594774e+01]
Stock Position:  0.025829896427023536
Bond Position:  [-3.83273258]


portfolio before change:  [-1.29731739]
curr_Stock_Price:  98.17671244690685
curr_Factors:  [9.81767124e+01 4.04975136e-02]
mat_Sqrt:  [[ 1.97570757e+01  0.00000000e+00]
 [-8.04959761e-03  1.84439452e-02]]
grads:  [1.69473527e-03 8.06422066e+00]
Stock Position:  0.0016947352747762447
Bond Position:  [-1.46370093]


portfolio before change:  [-1.29419075]
curr_Stock_Price:  100.12959624808958
curr_Factors:  [1.00129596e+02 4.09147607e-02]
mat_Sqrt:  [[ 2.02536114e+01  0.00000000e+00]
 [-8.09095898e-03  1.85387160e-02]]
grads:  [-0.00105121  0.77648478]
Stock Position:  -0.001051208394094399
Bond Position:  [-1.18893367]


portfolio before change:  [-1.29537945]
curr_Stock_Price:  101.11900567492077
curr_Factors:  [1.01119006e+02 4.07598695e-02]
mat_Sqrt:  [[ 2.04149905e+01  0.00000000e+00]
 [-8.07562946e-03  1.85035916e-02]]
grads:  [-0.00319418 -2.21432345]
Stock Position:  -0.0031941803359615477
Bond Position:  [-0.97238711]


portfolio before change:  [-1.29533684]
curr_Stock_Price:  101.06761181779163
curr_Factors:  [1.01067612e+02 4.11684939e-02]
mat_Sqrt:  [[ 2.05066393e+01  0.00000000e+00]
 [-8.11600827e-03  1.85961111e-02]]
grads:  [6.91749530e-03 1.69751444e+01]
Stock Position:  0.006917495297800744
Bond Position:  [-1.99447157]


portfolio before change:  [-1.3001981]
curr_Stock_Price:  100.40090583942724
curr_Factors:  [1.00400906e+02 4.16634214e-02]
mat_Sqrt:  [[ 2.04934510e+01  0.00000000e+00]
 [-8.16464783e-03  1.87075584e-02]]
grads:  [ 0.00813027 -0.87291029]
Stock Position:  0.008130273505646357
Bond Position:  [-2.11648493]


portfolio before change:  [-1.29164922]
curr_Stock_Price:  101.48493530185218
curr_Factors:  [1.01484935e+02 4.10456006e-02]
mat_Sqrt:  [[ 2.05605575e+01  0.00000000e+00]
 [-8.10388555e-03  1.85683345e-02]]
grads:  [0.00774163 4.52209172]
Stock Position:  0.007741629668051398
Bond Position:  [-2.07730801]


portfolio before change:  [-1.28880931]
curr_Stock_Price:  101.8853156257372
curr_Factors:  [1.01885316e+02 3.83762852e-02]
mat_Sqrt:  [[ 1.99591969e+01  0.00000000e+00]
 [-7.83594642e-03  1.79544088e-02]]
grads:  [ 0.01364162 -9.51011383]
Stock Position:  0.013641619065216111
Bond Position:  [-2.67868997]


portfolio before change:  [-1.29053759]
curr_Stock_Price:  101.78317057073647
curr_Factors:  [1.01783171e+02 3.80232523e-02]
mat_Sqrt:  [[ 1.98472621e+01  0.00000000e+00]
 [-7.79982075e-03  1.78716345e-02]]
grads:  [0.00327076 0.08037489]
Stock Position:  0.0032707574913077974
Bond Position:  [-1.62344565]


portfolio before change:  [-1.28734522]
curr_Stock_Price:  102.82125069516509
curr_Factors:  [1.02821251e+02 3.72117626e-02]
mat_Sqrt:  [[ 1.98345797e+01  0.00000000e+00]
 [-7.71614024e-03  1.76798984e-02]]
grads:  [-9.33873422e-03 -1.03653861e+01]
Stock Position:  -0.009338734220541697
Bond Position:  [-0.32712489]


portfolio before change:  [-1.28512972]
curr_Stock_Price:  102.57963385120483
curr_Factors:  [1.02579634e+02 3.77055353e-02]
mat_Sqrt:  [[ 1.99188243e+01  0.00000000e+00]
 [-7.76716528e-03  1.77968114e-02]]
grads:  [-6.06422436e-03  9.30119686e+00]
Stock Position:  -0.00606422435991451
Bond Position:  [-0.66306381]


portfolio before change:  [-1.28704435]
curr_Stock_Price:  102.88169164254981
curr_Factors:  [1.02881692e+02 3.72465360e-02]
mat_Sqrt:  [[ 1.98555097e+01  0.00000000e+00]
 [-7.71974466e-03  1.76881571e-02]]
grads:  [ -0.04818252 -44.07106148]
Stock Position:  -0.048182521679282386
Bond Position:  [3.67005498]


portfolio before change:  [-1.21770865]
curr_Stock_Price:  101.45219156307527
curr_Factors:  [1.01452192e+02 3.65628472e-02]
mat_Sqrt:  [[ 1.93990935e+01  0.00000000e+00]
 [-7.64856559e-03  1.75250654e-02]]
grads:  [8.14150473e-03 1.15233770e+01]
Stock Position:  0.00814150473235816
Bond Position:  [-2.04368215]


portfolio before change:  [-1.2185833]
curr_Stock_Price:  101.37613999297982
curr_Factors:  [1.01376140e+02 3.62981779e-02]
mat_Sqrt:  [[ 1.93142640e+01  0.00000000e+00]
 [-7.62083228e-03  1.74615204e-02]]
grads:  [ 0.00236119 -1.19429396]
Stock Position:  0.0023611887258815096
Bond Position:  [-1.4579515]


portfolio before change:  [-1.22135311]
curr_Stock_Price:  100.28027088178604
curr_Factors:  [1.00280271e+02 3.59030427e-02]
mat_Sqrt:  [[ 1.90012043e+01  0.00000000e+00]
 [-7.57923930e-03  1.73662189e-02]]
grads:  [2.43758022e-03 1.29943293e+01]
Stock Position:  0.0024375802171276695
Bond Position:  [-1.46579431]


portfolio before change:  [-1.22217684]
curr_Stock_Price:  100.01751063660275
curr_Factors:  [1.00017511e+02 3.65947886e-02]
mat_Sqrt:  [[ 1.91331142e+01  0.00000000e+00]
 [-7.65190576e-03  1.75327187e-02]]
grads:  [-0.00673285 -0.07067872]
Stock Position:  -0.0067328494077477695
Bond Position:  [-0.54877401]


portfolio before change:  [-1.22990413]
curr_Stock_Price:  101.1550203994528
curr_Factors:  [1.01155020e+02 3.78147032e-02]
mat_Sqrt:  [[ 1.96706083e+01  0.00000000e+00]
 [-7.77840119e-03  1.78225561e-02]]
grads:  [2.16563562e-03 3.54754615e+00]
Stock Position:  0.00216563561885687
Bond Position:  [-1.44896904]


portfolio before change:  [-1.2295336]
curr_Stock_Price:  101.40975359780016
curr_Factors:  [1.01409754e+02 3.84744068e-02]
mat_Sqrt:  [[ 1.98914157e+01  0.00000000e+00]
 [-7.84595761e-03  1.79773473e-02]]
grads:  [-0.00434577 -2.84299571]
Stock Position:  -0.004345774290392832
Bond Position:  [-0.7888297]


portfolio before change:  [-1.23766881]
curr_Stock_Price:  103.25904367821293
curr_Factors:  [1.03259044e+02 3.84480322e-02]
mat_Sqrt:  [[ 2.02472086e+01  0.00000000e+00]
 [-7.84326791e-03  1.79711844e-02]]
grads:  [ 0.01642772 12.07506731]
Stock Position:  0.01642771972823824
Bond Position:  [-2.93397944]


portfolio before change:  [-1.24178709]
curr_Stock_Price:  103.03067917541301
curr_Factors:  [1.03030679e+02 3.82371051e-02]
mat_Sqrt:  [[ 2.01469387e+01  0.00000000e+00]
 [-7.82172411e-03  1.79218214e-02]]
grads:  [1.83614378e-03 2.83272768e+00]
Stock Position:  0.0018361437800446603
Bond Position:  [-1.43096623]


portfolio before change:  [-1.2417242]
curr_Stock_Price:  103.16234931535928
curr_Factors:  [1.03162349e+02 3.82644665e-02]
mat_Sqrt:  [[ 2.01799021e+01  0.00000000e+00]
 [-7.82452212e-03  1.79282325e-02]]
grads:  [3.87993265e-03 1.00342671e+01]
Stock Position:  0.0038799326532894945
Bond Position:  [-1.64198717]


portfolio before change:  [-1.24550476]
curr_Stock_Price:  102.24086583815172
curr_Factors:  [1.02240866e+02 3.84095789e-02]
mat_Sqrt:  [[ 2.00375349e+01  0.00000000e+00]
 [-7.83934475e-03  1.79621954e-02]]
grads:  [5.54109531e-03 9.44163101e+00]
Stock Position:  0.00554109530702428
Bond Position:  [-1.81203114]


portfolio before change:  [-1.24340325]
curr_Stock_Price:  102.66100485262638
curr_Factors:  [1.02661005e+02 3.83629768e-02]
mat_Sqrt:  [[ 2.01076659e+01  0.00000000e+00]
 [-7.83458760e-03  1.79512954e-02]]
grads:  [3.78865195e-03 4.79323807e+00]
Stock Position:  0.003788651948345211
Bond Position:  [-1.63235006]


portfolio before change:  [-1.2451879]
curr_Stock_Price:  102.24381124298125
curr_Factors:  [1.02243811e+02 3.90092491e-02]
mat_Sqrt:  [[ 2.01939290e+01  0.00000000e+00]
 [-7.90030370e-03  1.81018699e-02]]
grads:  [  0.02838507 -18.84699396]
Stock Position:  0.02838506509064029
Bond Position:  [-4.14738514]


portfolio before change:  [-1.26483206]
curr_Stock_Price:  101.57001670190901
curr_Factors:  [1.01570017e+02 4.08247463e-02]
mat_Sqrt:  [[ 2.05223586e+01  0.00000000e+00]
 [-8.08205383e-03  1.85183117e-02]]
grads:  [-1.41096768e-03  7.01963947e+00]
Stock Position:  -0.001410967680785512
Bond Position:  [-1.12152005]


portfolio before change:  [-1.2639785]
curr_Stock_Price:  100.86570531266125
curr_Factors:  [1.00865705e+02 4.23443810e-02]
mat_Sqrt:  [[ 2.07558930e+01  0.00000000e+00]
 [-8.23110015e-03  1.88598197e-02]]
grads:  [-9.43899188e-04  4.16088107e+00]
Stock Position:  -0.0009438991883181884
Bond Position:  [-1.16877144]


portfolio before change:  [-1.26400023]
curr_Stock_Price:  100.73393457223642
curr_Factors:  [1.00733935e+02 4.22055453e-02]
mat_Sqrt:  [[ 2.06947677e+01  0.00000000e+00]
 [-8.21759530e-03  1.88288762e-02]]
grads:  [-6.23967139e-04 -8.91166273e+00]
Stock Position:  -0.0006239671394971709
Bond Position:  [-1.20114556]


portfolio before change:  [-1.26433714]
curr_Stock_Price:  101.03324066231487
curr_Factors:  [1.01033241e+02 4.04498732e-02]
mat_Sqrt:  [[ 2.03199608e+01  0.00000000e+00]
 [-8.04486154e-03  1.84330935e-02]]
grads:  [-0.00241836 -2.10536681]
Stock Position:  -0.002418355684170592
Bond Position:  [-1.02000282]


portfolio before change:  [-1.26831021]
curr_Stock_Price:  102.62339759385353
curr_Factors:  [1.02623398e+02 4.04899587e-02]
mat_Sqrt:  [[ 2.06500000e+01  0.00000000e+00]
 [-8.04884674e-03  1.84422247e-02]]
grads:  [-0.01961536 -5.07042452]
Stock Position:  -0.019615362033081975
Bond Position:  [0.74468489]


portfolio before change:  [-1.29081315]
curr_Stock_Price:  103.77535334410312
curr_Factors:  [1.03775353e+02 4.09695626e-02]
mat_Sqrt:  [[ 2.10051063e+01  0.00000000e+00]
 [-8.09637574e-03  1.85511273e-02]]
grads:  [-0.0044694  -0.07537456]
Stock Position:  -0.004469395135204073
Bond Position:  [-0.82700009]


portfolio before change:  [-1.27986925]
curr_Stock_Price:  101.30359129435519
curr_Factors:  [1.01303591e+02 4.33080233e-02]
mat_Sqrt:  [[ 2.10818647e+01  0.00000000e+00]
 [-8.32423193e-03  1.90732115e-02]]
grads:  [0.0064712  3.47415839]
Stock Position:  0.006471197855133724
Bond Position:  [-1.93542483]


portfolio before change:  [-1.27648642]
curr_Stock_Price:  101.86372969964873
curr_Factors:  [1.0186373e+02 4.4214832e-02]
mat_Sqrt:  [[ 2.14192156e+01  0.00000000e+00]
 [-8.41092927e-03  1.92718600e-02]]
grads:  [0.00924289 2.83172682]
Stock Position:  0.009242890833498343
Bond Position:  [-2.21800176]


portfolio before change:  [-1.28161502]
curr_Stock_Price:  101.3388581091921
curr_Factors:  [1.01338858e+02 4.42977616e-02]
mat_Sqrt:  [[ 2.13288233e+01  0.00000000e+00]
 [-8.41881337e-03  1.92899248e-02]]
grads:  [-0.01728709 -9.3666734 ]
Stock Position:  -0.01728709418243806
Bond Position:  [0.47023936]


portfolio before change:  [-1.28595055]
curr_Stock_Price:  101.59305388410819
curr_Factors:  [1.01593054e+02 4.45870560e-02]
mat_Sqrt:  [[ 2.14520309e+01  0.00000000e+00]
 [-8.44625891e-03  1.93528104e-02]]
grads:  [-1.40418536e-02 -2.14103384e+01]
Stock Position:  -0.014041853569217649
Bond Position:  [0.14060424]


portfolio before change:  [-1.28305085]
curr_Stock_Price:  101.38780157059266
curr_Factors:  [1.01387802e+02 4.57102696e-02]
mat_Sqrt:  [[ 2.16766716e+01  0.00000000e+00]
 [-8.55198406e-03  1.95950571e-02]]
grads:  [8.17702333e-04 1.37697491e+01]
Stock Position:  0.0008177023327775342
Bond Position:  [-1.36595589]


portfolio before change:  [-1.2823841]
curr_Stock_Price:  102.41201340608458
curr_Factors:  [1.02412013e+02 4.56317574e-02]
mat_Sqrt:  [[ 2.18768355e+01  0.00000000e+00]
 [-8.54463644e-03  1.95782216e-02]]
grads:  [-3.20708907e-03  6.06569442e+00]
Stock Position:  -0.0032070890709335518
Bond Position:  [-0.95393965]


portfolio before change:  [-1.28380827]
curr_Stock_Price:  102.81889895355846
curr_Factors:  [1.02818899e+02 4.56407747e-02]
mat_Sqrt:  [[ 2.19659228e+01  0.00000000e+00]
 [-8.54548065e-03  1.95801560e-02]]
grads:  [1.90403563e-04 5.67083501e+00]
Stock Position:  0.0001904035630851262
Bond Position:  [-1.30338535]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.28410643]
Stock Price:  102.10868836599175
PL:  [-3.39279479]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  0.28480780039060777
FINAL STD P&L:  8.370907372615694
