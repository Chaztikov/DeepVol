WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 19:20:35.501697: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 19:20:35.529150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 19:20:35.529812: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:20:35.531980: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 19:20:35.533852: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 19:20:35.534448: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 19:20:35.536793: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 19:20:35.538640: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 19:20:35.543564: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 19:20:35.545697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 19:20:35.546119: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 19:20:35.552972: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400070000 Hz
2019-12-18 19:20:35.553163: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562abf106210 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 19:20:35.553182: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 19:20:35.554318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 19:20:35.554343: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:20:35.554356: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 19:20:35.554367: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 19:20:35.554378: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 19:20:35.554388: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 19:20:35.554399: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 19:20:35.554410: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 19:20:35.556390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 19:20:35.556418: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:20:35.650386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 19:20:35.650419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 19:20:35.650430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 19:20:35.653560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-18 19:20:35.655715: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562abf73f4e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 19:20:35.655732: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: 4.0000e-02
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 19:20:43.636589: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 4.7235e+02,   Y0: 2.9027e+00,  elapsed time   8
INFO   step:     1,    loss: 3.5035e+02,   Y0: 2.8977e+00,  elapsed time  11
INFO   step:     2,    loss: 3.5031e+02,   Y0: 2.8927e+00,  elapsed time  11
INFO   step:     3,    loss: 3.5027e+02,   Y0: 2.8910e+00,  elapsed time  12
INFO   step:     4,    loss: 3.5024e+02,   Y0: 2.8881e+00,  elapsed time  12
INFO   step:     5,    loss: 3.5020e+02,   Y0: 2.8867e+00,  elapsed time  13
INFO   step:     6,    loss: 3.5017e+02,   Y0: 2.8839e+00,  elapsed time  14
INFO   step:     7,    loss: 3.5013e+02,   Y0: 2.8808e+00,  elapsed time  14
INFO   step:     8,    loss: 3.5010e+02,   Y0: 2.8802e+00,  elapsed time  15
INFO   step:     9,    loss: 3.5007e+02,   Y0: 2.8788e+00,  elapsed time  15
INFO   step:    10,    loss: 3.5003e+02,   Y0: 2.8778e+00,  elapsed time  16
INFO   step:    11,    loss: 3.5000e+02,   Y0: 2.8772e+00,  elapsed time  16
INFO   step:    12,    loss: 3.4997e+02,   Y0: 2.8766e+00,  elapsed time  17
INFO   step:    13,    loss: 3.4995e+02,   Y0: 2.8758e+00,  elapsed time  18
INFO   step:    14,    loss: 3.4993e+02,   Y0: 2.8746e+00,  elapsed time  18
INFO   step:    15,    loss: 3.4991e+02,   Y0: 2.8735e+00,  elapsed time  19
INFO   step:    16,    loss: 3.4989e+02,   Y0: 2.8734e+00,  elapsed time  19
INFO   step:    17,    loss: 3.4986e+02,   Y0: 2.8719e+00,  elapsed time  20
INFO   step:    18,    loss: 3.4984e+02,   Y0: 2.8695e+00,  elapsed time  20
INFO   step:    19,    loss: 3.4982e+02,   Y0: 2.8689e+00,  elapsed time  21
INFO   step:    20,    loss: 3.4979e+02,   Y0: 2.8680e+00,  elapsed time  21
INFO   step:    21,    loss: 3.4977e+02,   Y0: 2.8675e+00,  elapsed time  22
INFO   step:    22,    loss: 3.4975e+02,   Y0: 2.8661e+00,  elapsed time  23
INFO   step:    23,    loss: 3.4973e+02,   Y0: 2.8643e+00,  elapsed time  23
INFO   step:    24,    loss: 3.4970e+02,   Y0: 2.8622e+00,  elapsed time  24
INFO   step:    25,    loss: 3.4968e+02,   Y0: 2.8601e+00,  elapsed time  24
INFO   step:    26,    loss: 3.4965e+02,   Y0: 2.8582e+00,  elapsed time  25
INFO   step:    27,    loss: 3.4962e+02,   Y0: 2.8566e+00,  elapsed time  25
INFO   step:    28,    loss: 3.4959e+02,   Y0: 2.8549e+00,  elapsed time  26
INFO   step:    29,    loss: 3.4956e+02,   Y0: 2.8530e+00,  elapsed time  27
INFO   step:    30,    loss: 3.4952e+02,   Y0: 2.8508e+00,  elapsed time  27
INFO   step:    31,    loss: 3.4949e+02,   Y0: 2.8482e+00,  elapsed time  28
INFO   step:    32,    loss: 3.4946e+02,   Y0: 2.8460e+00,  elapsed time  28
INFO   step:    33,    loss: 3.4943e+02,   Y0: 2.8441e+00,  elapsed time  29
INFO   step:    34,    loss: 3.4940e+02,   Y0: 2.8420e+00,  elapsed time  29
INFO   step:    35,    loss: 3.4937e+02,   Y0: 2.8397e+00,  elapsed time  30
INFO   step:    36,    loss: 3.4934e+02,   Y0: 2.8378e+00,  elapsed time  30
INFO   step:    37,    loss: 3.4931e+02,   Y0: 2.8358e+00,  elapsed time  31
INFO   step:    38,    loss: 3.4928e+02,   Y0: 2.8333e+00,  elapsed time  32
INFO   step:    39,    loss: 3.4925e+02,   Y0: 2.8314e+00,  elapsed time  32
INFO   step:    40,    loss: 3.4922e+02,   Y0: 2.8293e+00,  elapsed time  33
INFO   step:    41,    loss: 3.4920e+02,   Y0: 2.8272e+00,  elapsed time  33
INFO   step:    42,    loss: 3.4917e+02,   Y0: 2.8254e+00,  elapsed time  34
INFO   step:    43,    loss: 3.4914e+02,   Y0: 2.8231e+00,  elapsed time  34
INFO   step:    44,    loss: 3.4912e+02,   Y0: 2.8200e+00,  elapsed time  35
INFO   step:    45,    loss: 3.4909e+02,   Y0: 2.8178e+00,  elapsed time  35
INFO   step:    46,    loss: 3.4906e+02,   Y0: 2.8158e+00,  elapsed time  36
INFO   step:    47,    loss: 3.4903e+02,   Y0: 2.8135e+00,  elapsed time  37
INFO   step:    48,    loss: 3.4900e+02,   Y0: 2.8106e+00,  elapsed time  37
INFO   step:    49,    loss: 3.4898e+02,   Y0: 2.8075e+00,  elapsed time  38
INFO   step:    50,    loss: 3.4896e+02,   Y0: 2.8052e+00,  elapsed time  38
INFO   step:    51,    loss: 3.4894e+02,   Y0: 2.8035e+00,  elapsed time  39
INFO   step:    52,    loss: 3.4890e+02,   Y0: 2.8023e+00,  elapsed time  39
INFO   step:    53,    loss: 3.4888e+02,   Y0: 2.8008e+00,  elapsed time  40
INFO   step:    54,    loss: 3.4885e+02,   Y0: 2.7996e+00,  elapsed time  41
INFO   step:    55,    loss: 3.4882e+02,   Y0: 2.7980e+00,  elapsed time  41
INFO   step:    56,    loss: 3.4879e+02,   Y0: 2.7972e+00,  elapsed time  42
INFO   step:    57,    loss: 3.4876e+02,   Y0: 2.7960e+00,  elapsed time  42
INFO   step:    58,    loss: 3.4873e+02,   Y0: 2.7953e+00,  elapsed time  43
INFO   step:    59,    loss: 3.4871e+02,   Y0: 2.7942e+00,  elapsed time  43
INFO   step:    60,    loss: 3.4868e+02,   Y0: 2.7937e+00,  elapsed time  44
INFO   step:    61,    loss: 3.4865e+02,   Y0: 2.7937e+00,  elapsed time  44
INFO   step:    62,    loss: 3.4862e+02,   Y0: 2.7929e+00,  elapsed time  45
INFO   step:    63,    loss: 3.4859e+02,   Y0: 2.7927e+00,  elapsed time  46
INFO   step:    64,    loss: 3.4855e+02,   Y0: 2.7923e+00,  elapsed time  46
INFO   step:    65,    loss: 3.4852e+02,   Y0: 2.7920e+00,  elapsed time  47
INFO   step:    66,    loss: 3.4849e+02,   Y0: 2.7917e+00,  elapsed time  47
INFO   step:    67,    loss: 3.4847e+02,   Y0: 2.7913e+00,  elapsed time  48
INFO   step:    68,    loss: 3.4843e+02,   Y0: 2.7913e+00,  elapsed time  48
INFO   step:    69,    loss: 3.4840e+02,   Y0: 2.7915e+00,  elapsed time  49
INFO   step:    70,    loss: 3.4838e+02,   Y0: 2.7920e+00,  elapsed time  49
INFO   step:    71,    loss: 3.4835e+02,   Y0: 2.7926e+00,  elapsed time  50
INFO   step:    72,    loss: 3.4832e+02,   Y0: 2.7922e+00,  elapsed time  51
INFO   step:    73,    loss: 3.4829e+02,   Y0: 2.7915e+00,  elapsed time  51
INFO   step:    74,    loss: 3.4826e+02,   Y0: 2.7907e+00,  elapsed time  52
INFO   step:    75,    loss: 3.4823e+02,   Y0: 2.7910e+00,  elapsed time  52
INFO   step:    76,    loss: 3.4820e+02,   Y0: 2.7909e+00,  elapsed time  53
INFO   step:    77,    loss: 3.4817e+02,   Y0: 2.7906e+00,  elapsed time  53
INFO   step:    78,    loss: 3.4813e+02,   Y0: 2.7902e+00,  elapsed time  54
INFO   step:    79,    loss: 3.4810e+02,   Y0: 2.7891e+00,  elapsed time  54
INFO   step:    80,    loss: 3.4807e+02,   Y0: 2.7878e+00,  elapsed time  55
INFO   step:    81,    loss: 3.4804e+02,   Y0: 2.7867e+00,  elapsed time  56
INFO   step:    82,    loss: 3.4801e+02,   Y0: 2.7849e+00,  elapsed time  56
INFO   step:    83,    loss: 3.4798e+02,   Y0: 2.7837e+00,  elapsed time  57
INFO   step:    84,    loss: 3.4794e+02,   Y0: 2.7836e+00,  elapsed time  57
INFO   step:    85,    loss: 3.4791e+02,   Y0: 2.7840e+00,  elapsed time  58
INFO   step:    86,    loss: 3.4788e+02,   Y0: 2.7842e+00,  elapsed time  58
INFO   step:    87,    loss: 3.4785e+02,   Y0: 2.7844e+00,  elapsed time  59
INFO   step:    88,    loss: 3.4781e+02,   Y0: 2.7846e+00,  elapsed time  60
INFO   step:    89,    loss: 3.4778e+02,   Y0: 2.7840e+00,  elapsed time  60
INFO   step:    90,    loss: 3.4775e+02,   Y0: 2.7830e+00,  elapsed time  61
INFO   step:    91,    loss: 3.4772e+02,   Y0: 2.7819e+00,  elapsed time  61
INFO   step:    92,    loss: 3.4769e+02,   Y0: 2.7804e+00,  elapsed time  62
INFO   step:    93,    loss: 3.4767e+02,   Y0: 2.7790e+00,  elapsed time  62
INFO   step:    94,    loss: 3.4764e+02,   Y0: 2.7773e+00,  elapsed time  63
INFO   step:    95,    loss: 3.4762e+02,   Y0: 2.7757e+00,  elapsed time  63
INFO   step:    96,    loss: 3.4759e+02,   Y0: 2.7738e+00,  elapsed time  64
INFO   step:    97,    loss: 3.4756e+02,   Y0: 2.7726e+00,  elapsed time  65
INFO   step:    98,    loss: 3.4753e+02,   Y0: 2.7713e+00,  elapsed time  65
INFO   step:    99,    loss: 3.4750e+02,   Y0: 2.7703e+00,  elapsed time  66
INFO   step:   100,    loss: 3.4747e+02,   Y0: 2.7694e+00,  elapsed time  66
INFO   step:   101,    loss: 3.4745e+02,   Y0: 2.7688e+00,  elapsed time  67
INFO   step:   102,    loss: 3.4742e+02,   Y0: 2.7685e+00,  elapsed time  67
INFO   step:   103,    loss: 3.4739e+02,   Y0: 2.7688e+00,  elapsed time  68
INFO   step:   104,    loss: 3.4737e+02,   Y0: 2.7684e+00,  elapsed time  68
INFO   step:   105,    loss: 3.4735e+02,   Y0: 2.7685e+00,  elapsed time  69
INFO   step:   106,    loss: 3.4732e+02,   Y0: 2.7681e+00,  elapsed time  70
INFO   step:   107,    loss: 3.4730e+02,   Y0: 2.7674e+00,  elapsed time  70
INFO   step:   108,    loss: 3.4727e+02,   Y0: 2.7670e+00,  elapsed time  71
INFO   step:   109,    loss: 3.4724e+02,   Y0: 2.7667e+00,  elapsed time  71
INFO   step:   110,    loss: 3.4721e+02,   Y0: 2.7665e+00,  elapsed time  72
INFO   step:   111,    loss: 3.4718e+02,   Y0: 2.7661e+00,  elapsed time  72
INFO   step:   112,    loss: 3.4715e+02,   Y0: 2.7656e+00,  elapsed time  73
INFO   step:   113,    loss: 3.4712e+02,   Y0: 2.7652e+00,  elapsed time  74
INFO   step:   114,    loss: 3.4709e+02,   Y0: 2.7645e+00,  elapsed time  74
INFO   step:   115,    loss: 3.4707e+02,   Y0: 2.7635e+00,  elapsed time  75
INFO   step:   116,    loss: 3.4705e+02,   Y0: 2.7613e+00,  elapsed time  75
INFO   step:   117,    loss: 3.4702e+02,   Y0: 2.7600e+00,  elapsed time  76
INFO   step:   118,    loss: 3.4699e+02,   Y0: 2.7578e+00,  elapsed time  76
INFO   step:   119,    loss: 3.4697e+02,   Y0: 2.7558e+00,  elapsed time  77
INFO   step:   120,    loss: 3.4694e+02,   Y0: 2.7537e+00,  elapsed time  77
INFO   step:   121,    loss: 3.4692e+02,   Y0: 2.7518e+00,  elapsed time  78
INFO   step:   122,    loss: 3.4689e+02,   Y0: 2.7506e+00,  elapsed time  79
INFO   step:   123,    loss: 3.4687e+02,   Y0: 2.7490e+00,  elapsed time  79
INFO   step:   124,    loss: 3.4685e+02,   Y0: 2.7480e+00,  elapsed time  80
INFO   step:   125,    loss: 3.4682e+02,   Y0: 2.7474e+00,  elapsed time  80
INFO   step:   126,    loss: 3.4680e+02,   Y0: 2.7455e+00,  elapsed time  81
INFO   step:   127,    loss: 3.4679e+02,   Y0: 2.7437e+00,  elapsed time  81
INFO   step:   128,    loss: 3.4676e+02,   Y0: 2.7426e+00,  elapsed time  82
INFO   step:   129,    loss: 3.4674e+02,   Y0: 2.7420e+00,  elapsed time  82
INFO   step:   130,    loss: 3.4671e+02,   Y0: 2.7422e+00,  elapsed time  83
INFO   step:   131,    loss: 3.4668e+02,   Y0: 2.7431e+00,  elapsed time  84
INFO   step:   132,    loss: 3.4666e+02,   Y0: 2.7438e+00,  elapsed time  84
INFO   step:   133,    loss: 3.4663e+02,   Y0: 2.7445e+00,  elapsed time  85
INFO   step:   134,    loss: 3.4660e+02,   Y0: 2.7460e+00,  elapsed time  85
INFO   step:   135,    loss: 3.4656e+02,   Y0: 2.7476e+00,  elapsed time  86
INFO   step:   136,    loss: 3.4651e+02,   Y0: 2.7494e+00,  elapsed time  86
INFO   step:   137,    loss: 3.4648e+02,   Y0: 2.7506e+00,  elapsed time  87
INFO   step:   138,    loss: 3.4644e+02,   Y0: 2.7520e+00,  elapsed time  87
INFO   step:   139,    loss: 3.4640e+02,   Y0: 2.7531e+00,  elapsed time  88
INFO   step:   140,    loss: 3.4637e+02,   Y0: 2.7544e+00,  elapsed time  89
INFO   step:   141,    loss: 3.4633e+02,   Y0: 2.7564e+00,  elapsed time  89
INFO   step:   142,    loss: 3.4629e+02,   Y0: 2.7588e+00,  elapsed time  90
INFO   step:   143,    loss: 3.4626e+02,   Y0: 2.7613e+00,  elapsed time  90
INFO   step:   144,    loss: 3.4623e+02,   Y0: 2.7638e+00,  elapsed time  91
INFO   step:   145,    loss: 3.4619e+02,   Y0: 2.7658e+00,  elapsed time  91
INFO   step:   146,    loss: 3.4616e+02,   Y0: 2.7661e+00,  elapsed time  92
INFO   step:   147,    loss: 3.4614e+02,   Y0: 2.7671e+00,  elapsed time  93
INFO   step:   148,    loss: 3.4611e+02,   Y0: 2.7680e+00,  elapsed time  93
INFO   step:   149,    loss: 3.4608e+02,   Y0: 2.7681e+00,  elapsed time  94
Delta:  155 ,  155.05
Other:  -50 ,  -50
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 2) dtype=float64>]
num_iterations:  150
total time intervals:  10
# of dimensions:  2
Loss out:  342.1170673579277
Output_Z_Vals:  [[[ 1.54293379e+02 -4.92669686e+01]
  [ 1.54293379e+02 -4.92669686e+01]
  [ 1.54293379e+02 -4.92669686e+01]
  ...
  [ 1.54293379e+02 -4.92669686e+01]
  [ 1.54293379e+02 -4.92669686e+01]
  [ 1.54293379e+02 -4.92669686e+01]]

 [[-2.65433639e-01  3.35174511e-01]
  [-2.81163312e-01  3.22380490e-01]
  [ 2.26675888e-01 -1.47770170e-01]
  ...
  [-2.34029734e-01  3.47620196e-01]
  [-9.31184339e-01  2.59050629e-01]
  [-2.08299911e-01  3.26423207e-01]]

 [[ 1.14593051e-01 -4.72770129e-02]
  [ 1.14593051e-01 -4.72770129e-02]
  [ 1.14593051e-01 -4.72770129e-02]
  ...
  [ 1.14593051e-01 -4.72770129e-02]
  [ 1.14593051e-01 -4.72770129e-02]
  [ 1.14593051e-01 -4.72770129e-02]]

 ...

 [[-8.80064425e-01  3.33274239e-01]
  [-1.06326263e+00  2.67942430e-01]
  [-7.63031234e-01  1.32875438e-01]
  ...
  [-5.54587521e-01  5.41183158e-02]
  [-5.68845420e-01  4.33818698e-01]
  [-8.43056643e-01  1.67180080e-01]]

 [[ 1.11514686e-01  6.87592726e-02]
  [-5.26704956e-02  1.15545763e-02]
  [-2.74713298e-02  2.05633911e-02]
  ...
  [ 2.34722260e-01 -3.62784975e-01]
  [ 1.77135799e-01  2.14695632e-02]
  [ 5.66187901e-03  3.99357676e-03]]

 [[ 1.14157440e-02 -1.81613641e-01]
  [-3.75575611e-02 -5.64831699e-02]
  [-3.19693296e-02  9.11318851e-03]
  ...
  [-3.71293998e-02  1.56077806e-01]
  [ 4.87766481e-02 -1.71767505e-01]
  [-2.77068853e-02  6.55985647e-02]]]
Z_Vals dimensionality:  (10, 200, 2)
X_test:  [[[1.00000000e+02 1.00278215e+02 1.00613659e+02 ... 9.01926832e+01
   9.07231308e+01 9.52785860e+01]
  [4.00000000e-02 3.87819629e-02 3.94184315e-02 ... 4.78082370e-02
   5.02131748e-02 5.22814604e-02]]

 [[1.00000000e+02 1.00163795e+02 9.86819110e+01 ... 9.73651680e+01
   9.70063806e+01 9.66471957e+01]
  [4.00000000e-02 4.26241462e-02 4.33369234e-02 ... 4.05038085e-02
   4.11670506e-02 4.14205177e-02]]

 [[1.00000000e+02 1.02403668e+02 1.01305465e+02 ... 1.01398972e+02
   9.95868355e+01 9.70729761e+01]
  [4.00000000e-02 3.91529222e-02 4.00836087e-02 ... 3.72173241e-02
   3.64843518e-02 3.94735525e-02]]

 ...

 [[1.00000000e+02 1.00547399e+02 9.91726342e+01 ... 1.08960205e+02
   1.05178928e+02 1.05129629e+02]
  [4.00000000e-02 4.00761937e-02 4.15474007e-02 ... 4.18762100e-02
   4.09997330e-02 4.37113695e-02]]

 [[1.00000000e+02 9.74599865e+01 9.55380972e+01 ... 8.87196506e+01
   8.97351543e+01 8.91468837e+01]
  [4.00000000e-02 4.11676889e-02 4.30041993e-02 ... 3.78641084e-02
   3.32348866e-02 3.64818258e-02]]

 [[1.00000000e+02 1.01006787e+02 9.87251515e+01 ... 1.02730431e+02
   1.02355193e+02 1.02134074e+02]
  [4.00000000e-02 3.97388739e-02 4.12487075e-02 ... 4.07154793e-02
   3.81427263e-02 3.77435154e-02]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.65433639e-01  3.35174511e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.13595358e-01 -5.16299570e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.53929067e-01 -1.46550255e+00]
 [-8.80064425e-01  3.33274239e-01]
 [ 1.11514686e-01  6.87592726e-02]
 [ 1.14157440e-02 -1.81613641e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.28414511]
curr_Stock_Price:  100.27821534349191
curr_Factors:  [1.00278215e+02 3.87819629e-02]
mat_Sqrt:  [[ 1.97479259e+01  0.00000000e+00]
 [-7.87725464e-03  1.80490578e-02]]
grads:  [-6.03362047e-03  1.85701943e+01]
Stock Position:  -0.006033620468054476
Bond Position:  [4.8891858]


portfolio before change:  [4.28456638]
curr_Stock_Price:  100.61365855779498
curr_Factors:  [1.00613659e+02 3.94184315e-02]
mat_Sqrt:  [[ 1.99759118e+01  0.00000000e+00]
 [-7.94163021e-03  1.81965608e-02]]
grads:  [ 0.00470365 -2.59812903]
Stock Position:  0.004703648682973563
Bond Position:  [3.81131508]


portfolio before change:  [4.26930116]
curr_Stock_Price:  96.96301256665228
curr_Factors:  [9.69630126e+01 4.24992878e-02]
mat_Sqrt:  [[ 1.99892696e+01  0.00000000e+00]
 [-8.24614215e-03  1.88942853e-02]]
grads:  [ 0.02014912 10.31554735]
Stock Position:  0.02014911944978226
Bond Position:  [2.31558183]


portfolio before change:  [4.25786185]
curr_Stock_Price:  96.33780454647459
curr_Factors:  [9.63378045e+01 4.42981675e-02]
mat_Sqrt:  [[ 2.02763428e+01  0.00000000e+00]
 [-8.41885194e-03  1.92900131e-02]]
grads:  [-1.67153893e-02 -2.67651228e+01]
Stock Position:  -0.016715389315114442
Bond Position:  [5.86818575]


portfolio before change:  [4.2924397]
curr_Stock_Price:  94.4447569218563
curr_Factors:  [9.44447569e+01 4.33724485e-02]
mat_Sqrt:  [[ 1.96691152e+01  0.00000000e+00]
 [-8.33042121e-03  1.90873929e-02]]
grads:  [-3.58263192e-03 -4.46341717e+00]
Stock Position:  -0.0035826319163658354
Bond Position:  [4.6308005]


portfolio before change:  [4.29916154]
curr_Stock_Price:  93.21497315077035
curr_Factors:  [9.32149732e+01 4.39855263e-02]
mat_Sqrt:  [[ 1.95497215e+01  0.00000000e+00]
 [-8.38909066e-03  1.92218215e-02]]
grads:  [-9.49725454e-03 -7.62416064e+01]
Stock Position:  -0.009497254543735718
Bond Position:  [5.18444787]


portfolio before change:  [4.31643684]
curr_Stock_Price:  91.6690075559032
curr_Factors:  [9.16690076e+01 4.63749419e-02]
mat_Sqrt:  [[ 1.97407759e+01  0.00000000e+00]
 [-8.61393679e-03  1.97370087e-02]]
grads:  [-0.03721291 16.88575227]
Stock Position:  -0.03721290520059533
Bond Position:  [7.72770693]


portfolio before change:  [4.37523998]
curr_Stock_Price:  90.19268320033397
curr_Factors:  [9.01926832e+01 4.78082370e-02]
mat_Sqrt:  [[ 1.97207157e+01  0.00000000e+00]
 [-8.74603791e-03  2.00396904e-02]]
grads:  [0.0071764  3.43115444]
Stock Position:  0.007176397415575116
Bond Position:  [3.72798144]


portfolio before change:  [4.38091114]
curr_Stock_Price:  90.72313081075637
curr_Factors:  [9.07231308e+01 5.02131748e-02]
mat_Sqrt:  [[ 2.03295081e+01  0.00000000e+00]
 [-8.96331857e-03  2.05375429e-02]]
grads:  [-3.33736294e-03 -8.84300724e+00]
Stock Position:  -0.0033373629445355695
Bond Position:  [4.68368716]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.36805036]
Stock Price:  95.27858604357182
PL:  [4.36805036]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.81163312e-01  3.22380490e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.02146667e-01  1.27473372e-01]
 [-1.20371760e-01 -4.97175984e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.26311644e-01 -1.17910024e+00]
 [-1.06326263e+00  2.67942430e-01]
 [-5.26704956e-02  1.15545763e-02]
 [-3.75575611e-02 -5.64831699e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.52444212]
curr_Stock_Price:  100.16379492867213
curr_Factors:  [1.00163795e+02 4.26241462e-02]
mat_Sqrt:  [[ 2.06794325e+01  0.00000000e+00]
 [-8.25824641e-03  1.89220197e-02]]
grads:  [-6.79249448e-03  1.70373193e+01]
Stock Position:  -0.00679249447930568
Bond Position:  [4.20480414]


portfolio before change:  [3.53661074]
curr_Stock_Price:  98.68191100112318
curr_Factors:  [9.86819110e+01 4.33369234e-02]
mat_Sqrt:  [[ 2.05431288e+01  0.00000000e+00]
 [-8.32700891e-03  1.90795743e-02]]
grads:  [ 0.00457378 -2.47788614]
Stock Position:  0.004573776072423918
Bond Position:  [3.08526177]


portfolio before change:  [3.53526076]
curr_Stock_Price:  98.04939324288904
curr_Factors:  [9.80493932e+01 4.29938493e-02]
mat_Sqrt:  [[ 2.03305007e+01  0.00000000e+00]
 [-8.29398329e-03  1.90039031e-02]]
grads:  [0.0126795  6.70774689]
Stock Position:  0.012679501178417096
Bond Position:  [2.29204336]


portfolio before change:  [3.52166139]
curr_Stock_Price:  96.88643884879012
curr_Factors:  [9.68864388e+01 4.15452104e-02]
mat_Sqrt:  [[ 1.97480162e+01  0.00000000e+00]
 [-8.15305689e-03  1.86810002e-02]]
grads:  [-1.70830905e-02 -2.66139917e+01]
Stock Position:  -0.01708309051095193
Bond Position:  [5.17678119]


portfolio before change:  [3.56245068]
curr_Stock_Price:  94.6502946914128
curr_Factors:  [9.46502947e+01 4.28791083e-02]
mat_Sqrt:  [[ 1.95994933e+01  0.00000000e+00]
 [-8.28290850e-03  1.89785276e-02]]
grads:  [-3.59535825e-03 -4.48902038e+00]
Stock Position:  -0.003595358246106969
Bond Position:  [3.90275239]


portfolio before change:  [3.56038828]
curr_Stock_Price:  95.76680625212397
curr_Factors:  [9.57668063e+01 4.09813371e-02]
mat_Sqrt:  [[ 1.93868864e+01  0.00000000e+00]
 [-8.09753909e-03  1.85537929e-02]]
grads:  [-4.55410370e-03 -6.35503614e+01]
Stock Position:  -0.004554103698776853
Bond Position:  [3.99652025]


portfolio before change:  [3.55959212]
curr_Stock_Price:  96.38052009176872
curr_Factors:  [9.63805201e+01 4.01800991e-02]
mat_Sqrt:  [[ 1.93194504e+01  0.00000000e+00]
 [-8.01798969e-03  1.83715223e-02]]
grads:  [-0.04898291 14.58466126]
Stock Position:  -0.04898291344669392
Bond Position:  [8.2805908]


portfolio before change:  [3.51550253]
curr_Stock_Price:  97.36516804914481
curr_Factors:  [9.73651680e+01 4.05038085e-02]
mat_Sqrt:  [[ 1.95952834e+01  0.00000000e+00]
 [-8.05022320e-03  1.84453786e-02]]
grads:  [-0.00243057  0.62642121]
Stock Position:  -0.002430567813814146
Bond Position:  [3.75215517]


portfolio before change:  [3.51825113]
curr_Stock_Price:  97.0063805883634
curr_Factors:  [9.70063806e+01 4.11670506e-02]
mat_Sqrt:  [[ 1.96822697e+01  0.00000000e+00]
 [-8.11586600e-03  1.85957851e-02]]
grads:  [-0.00316065 -3.03741786]
Stock Position:  -0.0031606536507122964
Bond Position:  [3.8248547]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.5212993]
Stock Price:  96.64719565403688
PL:  [3.5212993]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 2.26675888e-01 -1.47770170e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.94320150e-02  4.85844415e-03]
 [-1.57176966e-01 -4.22615254e-01]
 [ 5.45713644e-02  2.01396009e-01]
 [ 2.78413223e-01 -6.15181217e-01]
 [-7.63031234e-01  1.32875438e-01]
 [-2.74713298e-02  2.05633911e-02]
 [-3.19693296e-02  9.11318851e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.39624592]
curr_Stock_Price:  102.40366758901985
curr_Factors:  [1.02403668e+02 3.91529222e-02]
mat_Sqrt:  [[ 2.02627134e+01  0.00000000e+00]
 [-7.91483895e-03  1.81351743e-02]]
grads:  [ 8.00404639e-03 -8.14826304e+00]
Stock Position:  0.00800404638796188
Bond Position:  [17.57660221]


portfolio before change:  [18.39624635]
curr_Stock_Price:  101.30546538346373
curr_Factors:  [1.01305465e+02 4.00836087e-02]
mat_Sqrt:  [[ 2.02822571e+01  0.00000000e+00]
 [-8.00835651e-03  1.83494499e-02]]
grads:  [ 0.0046326 -2.5764812]
Stock Position:  0.004632604284266989
Bond Position:  [17.92693822]


portfolio before change:  [18.40635421]
curr_Stock_Price:  101.55200962684847
curr_Factors:  [1.01552010e+02 3.77284646e-02]
mat_Sqrt:  [[ 1.97252760e+01  0.00000000e+00]
 [-7.76952659e-03  1.78022219e-02]]
grads:  [-0.00493335  0.27291223]
Stock Position:  -0.004933346244467027
Bond Position:  [18.90734543]


portfolio before change:  [18.41623371]
curr_Stock_Price:  101.46617091104837
curr_Factors:  [1.01466171e+02 3.76634992e-02]
mat_Sqrt:  [[ 1.96916272e+01  0.00000000e+00]
 [-7.76283445e-03  1.77868882e-02]]
grads:  [-1.73485605e-02 -2.37599319e+01]
Stock Position:  -0.017348560456350248
Bond Position:  [20.17652571]


portfolio before change:  [18.42794907]
curr_Stock_Price:  101.37252811058725
curr_Factors:  [1.01372528e+02 3.84416490e-02]
mat_Sqrt:  [[ 1.98756473e+01  0.00000000e+00]
 [-7.84261681e-03  1.79696926e-02]]
grads:  [7.16795717e-03 1.12075378e+01]
Stock Position:  0.007167957168671219
Bond Position:  [17.70131513]


portfolio before change:  [18.44879924]
curr_Stock_Price:  103.04626837312534
curr_Factors:  [1.03046268e+02 3.80276184e-02]
mat_Sqrt:  [[ 2.00947141e+01  0.00000000e+00]
 [-7.80026855e-03  1.78726605e-02]]
grads:  [ 4.93967135e-04 -3.44202373e+01]
Stock Position:  0.0004939671346043387
Bond Position:  [18.39789777]


portfolio before change:  [18.45740901]
curr_Stock_Price:  101.84886391379585
curr_Factors:  [1.01848864e+02 3.97185677e-02]
mat_Sqrt:  [[ 2.02979874e+01  0.00000000e+00]
 [-7.97180709e-03  1.82657047e-02]]
grads:  [-0.03473446  7.27458592]
Stock Position:  -0.03473446036851108
Bond Position:  [21.99507433]


portfolio before change:  [18.48403605]
curr_Stock_Price:  101.39897177048951
curr_Factors:  [1.01398972e+02 3.72173241e-02]
mat_Sqrt:  [[ 1.95616788e+01  0.00000000e+00]
 [-7.71671683e-03  1.76812195e-02]]
grads:  [-9.45559446e-04  1.16300752e+00]
Stock Position:  -0.0009455594455894563
Bond Position:  [18.57991481]


portfolio before change:  [18.49504182]
curr_Stock_Price:  99.58683549069144
curr_Factors:  [9.95868355e+01 3.64843518e-02]
mat_Sqrt:  [[ 1.90219594e+01  0.00000000e+00]
 [-7.64035097e-03  1.75062433e-02]]
grads:  [-0.00147156  0.52056791]
Stock Position:  -0.0014715628109183575
Bond Position:  [18.6415901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.50806425]
Stock Price:  97.072976063574
PL:  [18.50806425]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.08433549e-01  3.26587451e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.89639811e-02  8.19040194e-03]
 [-1.10103902e-01 -4.80615418e-01]
 [ 1.60927879e-01  6.42961561e-01]
 [ 1.62849315e-01 -6.88545442e-01]
 [-2.82200855e-01 -4.87979689e-02]
 [ 2.49655475e-01 -3.86373412e-01]
 [-5.08145995e-02  2.87911225e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.28133018]
curr_Stock_Price:  101.03085156459306
curr_Factors:  [1.01030852e+02 4.24029254e-02]
mat_Sqrt:  [[ 2.08042433e+01  0.00000000e+00]
 [-8.23678825e-03  1.88728528e-02]]
grads:  [-3.16757978e-03  1.73046149e+01]
Stock Position:  -0.003167579783843037
Bond Position:  [9.60135346]


portfolio before change:  [9.29078542]
curr_Stock_Price:  99.56179296664267
curr_Factors:  [9.95617930e+01 4.42315217e-02]
mat_Sqrt:  [[ 2.09391308e+01  0.00000000e+00]
 [-8.41251655e-03  1.92754969e-02]]
grads:  [ 0.00448728 -2.45270008]
Stock Position:  0.004487276573455074
Bond Position:  [8.84402411]


portfolio before change:  [9.31293522]
curr_Stock_Price:  103.51222665921873
curr_Factors:  [1.03512227e+02 4.43627998e-02]
mat_Sqrt:  [[ 2.18022404e+01  0.00000000e+00]
 [-8.42499137e-03  1.93040803e-02]]
grads:  [-0.00437521  0.42428346]
Stock Position:  -0.004375210748512523
Bond Position:  [9.76582303]


portfolio before change:  [9.30673626]
curr_Stock_Price:  106.04538339648984
curr_Factors:  [1.06045383e+02 4.15197450e-02]
mat_Sqrt:  [[ 2.16082256e+01  0.00000000e+00]
 [-8.15055777e-03  1.86752740e-02]]
grads:  [-1.48027734e-02 -2.57353878e+01]
Stock Position:  -0.01480277341523833
Bond Position:  [10.87650204]


portfolio before change:  [9.30588473]
curr_Stock_Price:  106.47038069385493
curr_Factors:  [1.06470381e+02 4.10644839e-02]
mat_Sqrt:  [[ 2.15755558e+01  0.00000000e+00]
 [-8.10574945e-03  1.85726052e-02]]
grads:  [2.04647943e-02 3.46188137e+01]
Stock Position:  0.020464794271739997
Bond Position:  [7.1269903]


portfolio before change:  [9.30362098]
curr_Stock_Price:  106.18559213756897
curr_Factors:  [1.06185592e+02 4.03565320e-02]
mat_Sqrt:  [[ 2.13315549e+01  0.00000000e+00]
 [-8.03557410e-03  1.84118133e-02]]
grads:  [-6.45318888e-03 -3.73969381e+01]
Stock Position:  -0.00645318887512054
Bond Position:  [9.98885666]


portfolio before change:  [9.29048346]
curr_Stock_Price:  108.995550403984
curr_Factors:  [1.08995550e+02 3.89987656e-02]
mat_Sqrt:  [[ 2.15245559e+01  0.00000000e+00]
 [-7.89924205e-03  1.80994373e-02]]
grads:  [-0.01410008 -2.6961042 ]
Stock Position:  -0.014100083495648952
Bond Position:  [10.82732983]


portfolio before change:  [9.2906636]
curr_Stock_Price:  109.36681654017704
curr_Factors:  [1.09366817e+02 3.84291290e-02]
mat_Sqrt:  [[ 2.14395587e+01  0.00000000e+00]
 [-7.84133958e-03  1.79667661e-02]]
grads:  [ 3.77938254e-03 -2.15048946e+01]
Stock Position:  0.0037793825394892913
Bond Position:  [8.87732456]


portfolio before change:  [9.29484425]
curr_Stock_Price:  109.29825389237533
curr_Factors:  [1.09298254e+02 3.81249052e-02]
mat_Sqrt:  [[ 2.13411398e+01  0.00000000e+00]
 [-7.81023996e-03  1.78955079e-02]]
grads:  [3.50684929e-03 1.60884635e+01]
Stock Position:  0.0035068492911559997
Bond Position:  [8.91155174]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.29023419]
Stock Price:  106.7127573879557
PL:  [2.5774768]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.01465147e+00  1.40401042e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.05192299e-01 -5.41215820e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.22640312e-01 -1.14737173e+00]
 [-1.04734188e+00  2.74026695e-01]
 [-6.48361106e-02 -4.23284015e-03]
 [-3.49133247e-02 -1.21973352e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.82197661]
curr_Stock_Price:  96.6475432516472
curr_Factors:  [9.66475433e+01 4.47192257e-02]
mat_Sqrt:  [[ 2.04379794e+01  0.00000000e+00]
 [-8.45876830e-03  1.93814730e-02]]
grads:  [-0.04664724  7.24408522]
Stock Position:  -0.04664724491021132
Bond Position:  [-15.31363499]


portfolio before change:  [-19.71113483]
curr_Stock_Price:  94.10718928471532
curr_Factors:  [9.41071893e+01 4.66481971e-02]
mat_Sqrt:  [[ 2.03254530e+01  0.00000000e+00]
 [-8.63927748e-03  1.97950715e-02]]
grads:  [ 0.00462276 -2.38832241]
Stock Position:  0.004622759007944445
Bond Position:  [-20.14616969]


portfolio before change:  [-19.72707797]
curr_Stock_Price:  92.83791735536555
curr_Factors:  [9.28379174e+01 4.48065266e-02]
mat_Sqrt:  [[ 1.96515146e+01  0.00000000e+00]
 [-8.46702088e-03  1.94003821e-02]]
grads:  [ 0.02049543 10.04644621]
Stock Position:  0.020495426901570933
Bond Position:  [-21.62983072]


portfolio before change:  [-19.68066091]
curr_Stock_Price:  95.630475923452
curr_Factors:  [9.56304759e+01 4.30425260e-02]
mat_Sqrt:  [[ 1.9840161e+01  0.0000000e+00]
 [-8.2986771e-03  1.9014658e-02]]
grads:  [-1.72074333e-02 -2.84630847e+01]
Stock Position:  -0.017207433308974736
Bond Position:  [-18.03510587]


portfolio before change:  [-19.70566568]
curr_Stock_Price:  96.55943266794071
curr_Factors:  [9.65594327e+01 4.54105042e-02]
mat_Sqrt:  [[ 2.05765646e+01  0.00000000e+00]
 [-8.52389622e-03  1.95306998e-02]]
grads:  [-3.42463386e-03 -4.36210673e+00]
Stock Position:  -0.0034246338581196308
Bond Position:  [-19.37498498]


portfolio before change:  [-19.71352332]
curr_Stock_Price:  96.0244045917039
curr_Factors:  [9.60244046e+01 4.37688004e-02]
mat_Sqrt:  [[ 2.00892602e+01  0.00000000e+00]
 [-8.36839773e-03  1.91744080e-02]]
grads:  [-3.88833447e-03 -5.98387040e+01]
Stock Position:  -0.0038883344700192846
Bond Position:  [-19.34014832]


portfolio before change:  [-19.72272687]
curr_Stock_Price:  95.90380195747059
curr_Factors:  [9.59038020e+01 4.44731697e-02]
mat_Sqrt:  [[ 2.02248294e+01  0.00000000e+00]
 [-8.43546511e-03  1.93280787e-02]]
grads:  [-0.04587168 14.17764796]
Stock Position:  -0.045871676192155764
Bond Position:  [-15.32345872]


portfolio before change:  [-19.89457491]
curr_Stock_Price:  99.4830127482206
curr_Factors:  [9.94830127e+01 4.34015309e-02]
mat_Sqrt:  [[ 2.07253299e+01  0.00000000e+00]
 [-8.33321363e-03  1.90937911e-02]]
grads:  [-0.00321749 -0.22168673]
Stock Position:  -0.0032174867030957044
Bond Position:  [-19.57448964]


portfolio before change:  [-19.89343006]
curr_Stock_Price:  96.08453864772963
curr_Factors:  [9.60845386e+01 4.42693868e-02]
mat_Sqrt:  [[ 2.02164670e+01  0.00000000e+00]
 [-8.41611661e-03  1.92837457e-02]]
grads:  [-4.36015154e-03 -6.32518983e+00]
Stock Position:  -0.00436015153668101
Bond Position:  [-19.47448691]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.90540876]
Stock Price:  96.59805848667045
PL:  [-19.90540876]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.05598983e-01  3.24340198e-01]
 [-7.30171873e-02  2.37084232e-01]
 [-9.90841635e-02  7.33481681e-03]
 [-1.46640961e-01 -4.44026791e-01]
 [ 1.13760614e-01  4.22902446e-01]
 [ 3.37849167e-01 -6.30260589e-01]
 [-7.65106542e-01  1.33659952e-01]
 [ 6.11366174e-03  3.15238975e-03]
 [-3.57806305e-02  1.43212943e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.85435638]
curr_Stock_Price:  101.11715620855921
curr_Factors:  [1.01117156e+02 3.56322902e-02]
mat_Sqrt:  [[ 1.90873974e+01  0.00000000e+00]
 [-7.55060688e-03  1.73006138e-02]]
grads:  [-3.35537182e-03  1.87473232e+01]
Stock Position:  -0.0033553718193606945
Bond Position:  [10.19364204]


portfolio before change:  [9.84524051]
curr_Stock_Price:  105.35333924775715
curr_Factors:  [1.05353339e+02 3.44857579e-02]
mat_Sqrt:  [[ 1.95644747e+01  0.00000000e+00]
 [-7.42813655e-03  1.70199990e-02]]
grads:  [1.55664054e-03 1.39297442e+01]
Stock Position:  0.0015566405411419383
Bond Position:  [9.68124323]


portfolio before change:  [9.846443]
curr_Stock_Price:  103.01539237893194
curr_Factors:  [1.03015392e+02 3.31671966e-02]
mat_Sqrt:  [[ 1.87610225e+01  0.00000000e+00]
 [-7.28474533e-03  1.66914485e-02]]
grads:  [-0.00511075  0.43943561]
Stock Position:  -0.005110754872924156
Bond Position:  [10.37292942]


portfolio before change:  [9.85209236]
curr_Stock_Price:  102.92507414921971
curr_Factors:  [1.02925074e+02 3.29204219e-02]
mat_Sqrt:  [[ 1.86747108e+01  0.00000000e+00]
 [-7.25759430e-03  1.66292376e-02]]
grads:  [-1.82294732e-02 -2.67015723e+01]
Stock Position:  -0.018229473192776013
Bond Position:  [11.72836224]


portfolio before change:  [9.8378584]
curr_Stock_Price:  104.0276625044664
curr_Factors:  [1.04027663e+02 3.52421475e-02]
mat_Sqrt:  [[ 1.95290008e+01  0.00000000e+00]
 [-7.50915681e-03  1.72056398e-02]]
grads:  [1.52762743e-02 2.45792922e+01]
Stock Position:  0.015276274336754552
Bond Position:  [8.24870329]


portfolio before change:  [9.80130288]
curr_Stock_Price:  101.36465027250014
curr_Factors:  [1.01364650e+02 3.78882908e-02]
mat_Sqrt:  [[ 1.97305428e+01  0.00000000e+00]
 [-7.78596592e-03  1.78398891e-02]]
grads:  [ 3.18191423e-03 -3.53287280e+01]
Stock Position:  0.0031819142293809948
Bond Position:  [9.47876925]


portfolio before change:  [9.80750015]
curr_Stock_Price:  101.82245958128854
curr_Factors:  [1.01822460e+02 3.78960644e-02]
mat_Sqrt:  [[ 1.98216881e+01  0.00000000e+00]
 [-7.78676461e-03  1.78417191e-02]]
grads:  [-0.03565653  7.49142789]
Stock Position:  -0.03565652696423907
Bond Position:  [13.43813543]


portfolio before change:  [9.78128796]
curr_Stock_Price:  102.74607563910877
curr_Factors:  [1.02746076e+02 3.72175727e-02]
mat_Sqrt:  [[ 1.98216255e+01  0.00000000e+00]
 [-7.71674260e-03  1.76812785e-02]]
grads:  [0.00037784 0.17828969]
Stock Position:  0.0003778437560843398
Bond Position:  [9.742466]


portfolio before change:  [9.78692834]
curr_Stock_Price:  104.77845623720745
curr_Factors:  [1.04778456e+02 3.91486298e-02]
mat_Sqrt:  [[ 2.07314787e+01  0.00000000e+00]
 [-7.91440508e-03  1.81341802e-02]]
grads:  [1.28898774e-03 7.89740375e+00]
Stock Position:  0.0012889877428097353
Bond Position:  [9.65187019]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.79348406]
Stock Price:  106.11949612128365
PL:  [3.67398794]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.97781090e-01  3.08774585e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.08090228e-02  5.68268470e-02]
 [-1.59883795e-01 -4.16971302e-01]
 [ 4.21148340e-02  1.63754587e-01]
 [ 3.38509661e-01 -6.32338235e-01]
 [-8.85849644e-01  1.88218576e-01]
 [-4.38740011e-02  1.94172237e-02]
 [-3.26684308e-02  7.85881381e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.62821043]
curr_Stock_Price:  100.02881164899271
curr_Factors:  [1.00028812e+02 4.10507947e-02]
mat_Sqrt:  [[ 2.02668332e+01  0.00000000e+00]
 [-8.10439828e-03  1.85695093e-02]]
grads:  [-8.04372401e-03  1.66280422e+01]
Stock Position:  -0.00804372401434288
Bond Position:  [3.43281459]


portfolio before change:  [2.64027799]
curr_Stock_Price:  98.74200496018217
curr_Factors:  [9.87420050e+01 3.70592072e-02]
mat_Sqrt:  [[ 1.90085944e+01  0.00000000e+00]
 [-7.70030724e-03  1.76436204e-02]]
grads:  [ 0.00494301 -2.67955282]
Stock Position:  0.004943009939312512
Bond Position:  [2.15219528]


portfolio before change:  [2.64634328]
curr_Stock_Price:  99.7512941085574
curr_Factors:  [9.97512941e+01 3.55953355e-02]
mat_Sqrt:  [[ 1.88198035e+01  0.00000000e+00]
 [-7.54669045e-03  1.72916401e-02]]
grads:  [0.0050803  3.28637692]
Stock Position:  0.005080302368812341
Bond Position:  [2.13957655]


portfolio before change:  [2.65423517]
curr_Stock_Price:  101.09409455664913
curr_Factors:  [1.01094095e+02 3.44676211e-02]
mat_Sqrt:  [[ 1.87685811e+01  0.00000000e+00]
 [-7.42618299e-03  1.70155228e-02]]
grads:  [-1.82147488e-02 -2.45053476e+01]
Stock Position:  -0.01821474880281984
Bond Position:  [4.49563871]


portfolio before change:  [2.66067389]
curr_Stock_Price:  100.86404264595106
curr_Factors:  [1.00864043e+02 3.37852606e-02]
mat_Sqrt:  [[ 1.85395849e+01  0.00000000e+00]
 [-7.35230691e-03  1.68462515e-02]]
grads:  [6.12652308e-03 9.72053560e+00]
Stock Position:  0.006126523081353685
Bond Position:  [2.042728]


portfolio before change:  [2.66475654]
curr_Stock_Price:  101.36367816769629
curr_Factors:  [1.01363678e+02 3.56737143e-02]
mat_Sqrt:  [[ 1.91450510e+01  0.00000000e+00]
 [-7.55499457e-03  1.73106672e-02]]
grads:  [ 3.26636007e-03 -3.65288193e+01]
Stock Position:  0.0032663600678078573
Bond Position:  [2.33366627]


portfolio before change:  [2.66148878]
curr_Stock_Price:  100.0059344030566
curr_Factors:  [1.00005934e+02 3.63436853e-02]
mat_Sqrt:  [[ 1.90651512e+01  0.00000000e+00]
 [-7.62560794e-03  1.74724628e-02]]
grads:  [-0.04215568 10.77229801]
Stock Position:  -0.042155675277599655
Bond Position:  [6.87730648]


portfolio before change:  [2.8052074]
curr_Stock_Price:  96.678289832891
curr_Factors:  [9.66782898e+01 3.71869425e-02]
mat_Sqrt:  [[ 1.86433604e+01  0.00000000e+00]
 [-7.71356649e-03  1.76740012e-02]]
grads:  [-0.00189878  1.09863202]
Stock Position:  -0.0018987794661117355
Bond Position:  [2.98877815]


portfolio before change:  [2.80154434]
curr_Stock_Price:  99.39467769083667
curr_Factors:  [9.93946777e+01 3.74102063e-02]
mat_Sqrt:  [[ 1.92246385e+01  0.00000000e+00]
 [-7.73668728e-03  1.77269775e-02]]
grads:  [-0.00152089  0.44332508]
Stock Position:  -0.00152089015067359
Bond Position:  [2.95271273]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.80379664]
Stock Price:  98.88473117663453
PL:  [2.80379664]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.80999981e-01  3.22475737e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.24185076e-01  1.41657001e-01]
 [-1.23508771e-01 -4.88626610e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.40939180e-01 -1.32739720e+00]
 [-1.06205089e+00  2.60487336e-01]
 [-3.98417869e-02  2.31940245e-02]
 [-3.66689325e-02  6.09166244e-04]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.49300414]
curr_Stock_Price:  100.15905998962948
curr_Factors:  [1.00159060e+02 4.02186406e-02]
mat_Sqrt:  [[ 2.00864845e+01  0.00000000e+00]
 [-8.02183427e-03  1.83803314e-02]]
grads:  [-6.98280631e-03  1.75446095e+01]
Stock Position:  -0.006982806312201314
Bond Position:  [4.19239545]


portfolio before change:  [3.51713566]
curr_Stock_Price:  97.00347942896059
curr_Factors:  [9.70034794e+01 4.19579750e-02]
mat_Sqrt:  [[ 1.98698493e+01  0.00000000e+00]
 [-8.19345837e-03  1.87735716e-02]]
grads:  [ 0.00472876 -2.51827483]
Stock Position:  0.004728756105597669
Bond Position:  [3.05842987]


portfolio before change:  [3.52267018]
curr_Stock_Price:  97.85040768558598
curr_Factors:  [9.78504077e+01 3.94878788e-02]
mat_Sqrt:  [[ 1.94443998e+01  0.00000000e+00]
 [-7.94862291e-03  1.82125831e-02]]
grads:  [0.01470908 7.7779742 ]
Stock Position:  0.014709081431662156
Bond Position:  [2.08338056]


portfolio before change:  [3.51316858]
curr_Stock_Price:  97.13360232162721
curr_Factors:  [9.71336023e+01 3.90916951e-02]
mat_Sqrt:  [[ 1.92048866e+01  0.00000000e+00]
 [-7.90864793e-03  1.81209889e-02]]
grads:  [-1.75352718e-02 -2.69646768e+01]
Stock Position:  -0.017535271840453746
Bond Position:  [5.2164327]


portfolio before change:  [3.53853929]
curr_Stock_Price:  95.8355423134804
curr_Factors:  [9.58355423e+01 4.26902871e-02]
mat_Sqrt:  [[ 1.98011832e+01  0.00000000e+00]
 [-8.26465120e-03  1.89366949e-02]]
grads:  [-3.55873681e-03 -4.49893700e+00]
Stock Position:  -0.0035587368137764094
Bond Position:  [3.87959276]


portfolio before change:  [3.5453786]
curr_Stock_Price:  94.45892111063988
curr_Factors:  [9.44589211e+01 4.08668481e-02]
mat_Sqrt:  [[ 1.90953909e+01  0.00000000e+00]
 [-8.08622019e-03  1.85278581e-02]]
grads:  [-7.24700814e-03 -7.16433166e+01]
Stock Position:  -0.007247008141510459
Bond Position:  [4.22992317]


portfolio before change:  [3.52979653]
curr_Stock_Price:  96.9009717896006
curr_Factors:  [9.69009718e+01 4.25386631e-02]
mat_Sqrt:  [[ 1.99857316e+01  0.00000000e+00]
 [-8.24996127e-03  1.89030360e-02]]
grads:  [-0.0474521  13.78018518]
Stock Position:  -0.047452098143936014
Bond Position:  [8.12795095]


portfolio before change:  [3.55554842]
curr_Stock_Price:  96.44394466421251
curr_Factors:  [9.64439447e+01 4.02728855e-02]
mat_Sqrt:  [[ 1.93544725e+01  0.00000000e+00]
 [-8.02724216e-03  1.83927224e-02]]
grads:  [-0.00153552  1.26104358]
Stock Position:  -0.001535515100230173
Bond Position:  [3.70363955]


portfolio before change:  [3.5545536]
curr_Stock_Price:  98.29811078073789
curr_Factors:  [9.82981108e+01 3.82620321e-02]
mat_Sqrt:  [[ 1.92277819e+01  0.00000000e+00]
 [-7.82427322e-03  1.79276621e-02]]
grads:  [-0.00189325  0.03397912]
Stock Position:  -0.001893253769207371
Bond Position:  [3.74065687]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.55849293]
Stock Price:  97.20553068524843
PL:  [3.55849293]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 2.49633781e-01 -1.73110014e-01]
 [ 8.55871973e-02  3.59245899e-02]
 [-9.89006073e-02  8.64156308e-03]
 [-1.54628219e-01 -4.27760386e-01]
 [ 6.23359638e-02  2.25381570e-01]
 [ 2.00074949e-01 -6.50385196e-01]
 [-6.99445143e-01  1.08851817e-01]
 [-5.17203409e-02  4.47112256e-03]
 [-3.01709251e-02  1.23715546e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.68781345]
curr_Stock_Price:  102.44758116918928
curr_Factors:  [1.02447581e+02 4.16081061e-02]
mat_Sqrt:  [[ 2.08973243e+01  0.00000000e+00]
 [-8.15922605e-03  1.86951355e-02]]
grads:  [ 8.33036680e-03 -9.25962873e+00]
Stock Position:  0.00833036679990899
Bond Position:  [17.83438752]


portfolio before change:  [18.69391782]
curr_Stock_Price:  102.10965433212016
curr_Factors:  [1.02109654e+02 3.74092306e-02]
mat_Sqrt:  [[ 1.97495040e+01  0.00000000e+00]
 [-7.73658638e-03  1.77267464e-02]]
grads:  [0.00512752 2.0265755 ]
Stock Position:  0.00512751983735626
Bond Position:  [18.17034854]


portfolio before change:  [18.71159736]
curr_Stock_Price:  103.78533753221849
curr_Factors:  [1.03785338e+02 3.40552006e-02]
mat_Sqrt:  [[ 1.91525993e+01  0.00000000e+00]
 [-7.38162049e-03  1.69134173e-02]]
grads:  [-0.0049669   0.51092945]
Stock Position:  -0.004966903878881771
Bond Position:  [19.22708916]


portfolio before change:  [18.73097619]
curr_Stock_Price:  101.81975096957186
curr_Factors:  [1.01819751e+02 3.54516573e-02]
mat_Sqrt:  [[ 1.91712443e+01  0.00000000e+00]
 [-7.53144420e-03  1.72567066e-02]]
grads:  [-1.78036517e-02 -2.47880663e+01]
Stock Position:  -0.017803651699226864
Bond Position:  [20.54373957]


portfolio before change:  [18.74374384]
curr_Stock_Price:  101.67971161586725
curr_Factors:  [1.01679712e+02 3.34106600e-02]
mat_Sqrt:  [[ 1.85856106e+01  0.00000000e+00]
 [-7.31143323e-03  1.67525981e-02]]
grads:  [8.64650340e-03 1.34535293e+01]
Stock Position:  0.008646503401835736
Bond Position:  [17.86456987]


portfolio before change:  [18.78142096]
curr_Stock_Price:  105.00389905004702
curr_Factors:  [1.05003899e+02 3.11739351e-02]
mat_Sqrt:  [[ 1.85396376e+01  0.00000000e+00]
 [-7.06245681e-03  1.61821215e-02]]
grads:  [-4.51877343e-03 -4.01915903e+01]
Stock Position:  -0.0045187734324412514
Bond Position:  [19.25590979]


portfolio before change:  [18.80097252]
curr_Stock_Price:  102.80834863021967
curr_Factors:  [1.02808349e+02 3.37081549e-02]
mat_Sqrt:  [[ 1.88753874e+01  0.00000000e+00]
 [-7.34391229e-03  1.68270170e-02]]
grads:  [-0.03453907  6.46887189]
Stock Position:  -0.03453906941906636
Bond Position:  [22.35187721]


portfolio before change:  [18.90112316]
curr_Stock_Price:  100.23236980306615
curr_Factors:  [1.00232370e+02 3.59271066e-02]
mat_Sqrt:  [[ 1.89984915e+01  0.00000000e+00]
 [-7.58177885e-03  1.73720377e-02]]
grads:  [-0.00261963  0.25737467]
Stock Position:  -0.0026196281406614683
Bond Position:  [19.1636947]


portfolio before change:  [18.91110703]
curr_Stock_Price:  100.07981987103803
curr_Factors:  [1.00079820e+02 3.60595607e-02]
mat_Sqrt:  [[ 1.90045124e+01  0.00000000e+00]
 [-7.59574204e-03  1.74040314e-02]]
grads:  [-0.00130346  0.71084419]
Stock Position:  -0.0013034554894334532
Bond Position:  [19.04155662]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.91723766]
Stock Price:  102.6825376363945
PL:  [16.23470002]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.06017201e-01  3.24673848e-01]
 [ 7.41591674e-02  6.87052284e-02]
 [-9.92624937e-02  6.06527534e-03]
 [-1.56249389e-01 -4.24637591e-01]
 [ 3.39346835e-03  4.78375954e-02]
 [ 3.87003148e-01 -7.87947727e-01]
 [-8.39180317e-01  1.65304955e-01]
 [-6.36064097e-02 -3.41677896e-03]
 [-3.63876187e-02  1.24059953e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.77233367]
curr_Stock_Price:  101.10480260043569
curr_Factors:  [1.01104803e+02 3.75853417e-02]
mat_Sqrt:  [[ 1.96011267e+01  0.00000000e+00]
 [-7.75477574e-03  1.77684234e-02]]
grads:  [-3.28133775e-03  1.82725186e+01]
Stock Position:  -0.0032813377484114774
Bond Position:  [10.10409267]


portfolio before change:  [9.77388218]
curr_Stock_Price:  102.17290319394122
curr_Factors:  [1.02172903e+02 3.82548133e-02]
mat_Sqrt:  [[ 1.99838323e+01  0.00000000e+00]
 [-7.82353509e-03  1.79259709e-02]]
grads:  [0.00521144 3.83272007]
Stock Position:  0.00521144221166679
Bond Position:  [9.241414]


portfolio before change:  [9.77896647]
curr_Stock_Price:  102.26163586512938
curr_Factors:  [1.02261636e+02 4.06590651e-02]
mat_Sqrt:  [[ 2.06201315e+01  0.00000000e+00]
 [-8.06563725e-03  1.84806966e-02]]
grads:  [-0.00468549  0.32819517]
Stock Position:  -0.004685488577706517
Bond Position:  [10.25811219]


portfolio before change:  [9.78723444]
curr_Stock_Price:  101.59198757920547
curr_Factors:  [1.01591988e+02 4.14821875e-02]
mat_Sqrt:  [[ 2.06914193e+01  0.00000000e+00]
 [-8.14687057e-03  1.86668255e-02]]
grads:  [-1.65081197e-02 -2.27482488e+01]
Stock Position:  -0.016508119736811232
Bond Position:  [11.46432713]


portfolio before change:  [9.8290058]
curr_Stock_Price:  99.40895483970891
curr_Factors:  [9.94089548e+01 4.32982205e-02]
mat_Sqrt:  [[ 2.06852385e+01  0.00000000e+00]
 [-8.32328979e-03  1.90710527e-02]]
grads:  [1.17337330e-03 2.50838777e+00]
Stock Position:  0.001173373304863459
Bond Position:  [9.71236198]


portfolio before change:  [9.83360243]
curr_Stock_Price:  99.18671685026898
curr_Factors:  [9.91867169e+01 4.49884693e-02]
mat_Sqrt:  [[ 2.10379842e+01  0.00000000e+00]
 [-8.48419418e-03  1.94397310e-02]]
grads:  [ 2.04936775e-03 -4.05328513e+01]
Stock Position:  0.002049367748620962
Bond Position:  [9.63033237]


portfolio before change:  [9.84142999]
curr_Stock_Price:  100.65604650329654
curr_Factors:  [1.00656047e+02 4.80407272e-02]
mat_Sqrt:  [[ 2.20619886e+01  0.00000000e+00]
 [-8.76727800e-03  2.00883575e-02]]
grads:  [-0.03476728  8.22889351]
Stock Position:  -0.03476727939694792
Bond Position:  [13.34096688]


portfolio before change:  [9.88673685]
curr_Stock_Price:  99.54480900555768
curr_Factors:  [9.95448090e+01 4.68950419e-02]
mat_Sqrt:  [[ 2.15566903e+01  0.00000000e+00]
 [-8.66210523e-03  1.98473764e-02]]
grads:  [-0.00301983 -0.17215268]
Stock Position:  -0.003019833449654919
Bond Position:  [10.18734559]


portfolio before change:  [9.89537927]
curr_Stock_Price:  98.37008370557058
curr_Factors:  [9.83700837e+01 4.57476645e-02]
mat_Sqrt:  [[ 2.10400857e+01  0.00000000e+00]
 [-8.55548147e-03  1.96030707e-02]]
grads:  [-0.00170371  0.06328598]
Stock Position:  -0.0017037086791156573
Bond Position:  [10.06297323]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.89300245]
Stock Price:  102.71916148729518
PL:  [7.17384097]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 1.63547561e-01 -7.82591629e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.72664327e-02 -1.13672123e-03]
 [-1.63921041e-01 -4.13860381e-01]
 [-2.60932356e-02 -4.58531446e-02]
 [ 4.06682462e-01 -9.75066938e-01]
 [-9.24509022e-01  2.07226904e-01]
 [-3.60683828e-02  1.48581653e-02]
 [-3.72020860e-02 -3.74448205e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.49750213]
curr_Stock_Price:  102.2683059565744
curr_Factors:  [1.02268306e+02 3.74528630e-02]
mat_Sqrt:  [[ 1.97917216e+01  0.00000000e+00]
 [-7.74109688e-03  1.77370812e-02]]
grads:  [ 0.00653771 -4.41217819]
Stock Position:  0.006537706237444329
Bond Position:  [16.82890199]


portfolio before change:  [17.49311835]
curr_Stock_Price:  100.31038148491842
curr_Factors:  [1.00310381e+02 3.74513760e-02]
mat_Sqrt:  [[ 1.94124241e+01  0.00000000e+00]
 [-7.74094320e-03  1.77367291e-02]]
grads:  [ 0.00484018 -2.66548655]
Stock Position:  0.00484018226501493
Bond Position:  [17.00759782]


portfolio before change:  [17.50648233]
curr_Stock_Price:  101.31407341753933
curr_Factors:  [1.01314073e+02 3.59491288e-02]
mat_Sqrt:  [[ 1.92094072e+01  0.00000000e+00]
 [-7.58410220e-03  1.73773612e-02]]
grads:  [-0.00508931 -0.06541392]
Stock Position:  -0.005089305343447735
Bond Position:  [18.02210058]


portfolio before change:  [17.52194533]
curr_Stock_Price:  100.04676764754882
curr_Factors:  [1.00046768e+02 3.76413064e-02]
mat_Sqrt:  [[ 1.94104411e+01  0.00000000e+00]
 [-7.76054703e-03  1.77816471e-02]]
grads:  [-1.77504734e-02 -2.32745807e+01]
Stock Position:  -0.017750473403489935
Bond Position:  [19.29782282]


portfolio before change:  [17.56115167]
curr_Stock_Price:  98.38174124289516
curr_Factors:  [9.83817412e+01 3.92360790e-02]
mat_Sqrt:  [[ 1.94875528e+01  0.00000000e+00]
 [-7.92323965e-03  1.81544227e-02]]
grads:  [-2.36587883e-03 -2.52572860e+00]
Stock Position:  -0.0023658788264726478
Bond Position:  [17.79391094]


portfolio before change:  [17.57193205]
curr_Stock_Price:  97.58660166627905
curr_Factors:  [9.75866017e+01 3.86090952e-02]
mat_Sqrt:  [[ 1.91749838e+01  0.00000000e+00]
 [-7.85967889e-03  1.80087867e-02]]
grads:  [-9.84180145e-04 -5.41439550e+01]
Stock Position:  -0.0009841801454502617
Bond Position:  [17.66797485]


portfolio before change:  [17.57893087]
curr_Stock_Price:  99.45351059061767
curr_Factors:  [9.94535106e+01 3.48487199e-02]
mat_Sqrt:  [[ 1.85657942e+01  0.00000000e+00]
 [-7.46712474e-03  1.71093322e-02]]
grads:  [-0.04492497 12.11192243]
Stock Position:  -0.04492497203258326
Bond Position:  [22.04687705]


portfolio before change:  [17.52023035]
curr_Stock_Price:  101.00558092051969
curr_Factors:  [1.01005581e+02 3.40234884e-02]
mat_Sqrt:  [[ 1.86309410e+01  0.00000000e+00]
 [-7.37818280e-03  1.69055406e-02]]
grads:  [-0.00158788  0.87889324]
Stock Position:  -0.001587882643987399
Bond Position:  [17.68061536]


portfolio before change:  [17.5350291]
curr_Stock_Price:  97.2545297633338
curr_Factors:  [9.72545298e+01 3.67941417e-02]
mat_Sqrt:  [[ 1.86551685e+01  0.00000000e+00]
 [-7.67271964e-03  1.75804093e-02]]
grads:  [-0.00287022 -2.12991745]
Stock Position:  -0.0028702150471470547
Bond Position:  [17.81417051]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.5442235]
Stock Price:  97.15520420057089
PL:  [17.5442235]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 1.89578600e-01 -1.06880468e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.94178387e-02  4.95936631e-03]
 [-1.54665544e-01 -4.13065921e-01]
 [-3.46625728e-02 -8.27095161e-02]
 [ 4.11880554e-01 -1.02921354e+00]
 [-1.03573986e+00  2.77746547e-01]
 [-4.00897414e-02  2.30099251e-02]
 [-3.51566272e-02  3.38516220e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.89227769]
curr_Stock_Price:  102.327763908761
curr_Factors:  [1.02327764e+02 3.68949925e-02]
mat_Sqrt:  [[ 1.96551878e+01  0.00000000e+00]
 [-7.68322770e-03  1.76044863e-02]]
grads:  [ 0.00727198 -6.07120632]
Stock Position:  0.00727198037992785
Bond Position:  [17.1481522]


portfolio before change:  [17.88364351]
curr_Stock_Price:  99.9610901735171
curr_Factors:  [9.99610902e+01 3.99475909e-02]
mat_Sqrt:  [[ 1.99791166e+01  0.00000000e+00]
 [-7.99475737e-03  1.83182904e-02]]
grads:  [ 0.00470289 -2.58086381]
Stock Position:  0.004702894178797942
Bond Position:  [17.41353708]


portfolio before change:  [17.90010174]
curr_Stock_Price:  101.60885918442665
curr_Factors:  [1.01608859e+02 4.16074026e-02]
mat_Sqrt:  [[ 2.07260661e+01  0.00000000e+00]
 [-8.15915708e-03  1.86949775e-02]]
grads:  [-0.00469232  0.265278  ]
Stock Position:  -0.004692322869771808
Bond Position:  [18.37688331]


portfolio before change:  [17.9189363]
curr_Stock_Price:  99.55362404154924
curr_Factors:  [9.95536240e+01 4.20576557e-02]
mat_Sqrt:  [[ 2.04164206e+01  0.00000000e+00]
 [-8.20318530e-03  1.87958588e-02]]
grads:  [-1.64055345e-02 -2.19764325e+01]
Stock Position:  -0.01640553445147455
Bond Position:  [19.55216671]


portfolio before change:  [17.95439334]
curr_Stock_Price:  97.98838969087278
curr_Factors:  [9.79883897e+01 4.18751984e-02]
mat_Sqrt:  [[ 2.00517859e+01  0.00000000e+00]
 [-8.18537216e-03  1.87550438e-02]]
grads:  [-3.52886098e-03 -4.40998790e+00]
Stock Position:  -0.003528860983227654
Bond Position:  [18.30018074]


portfolio before change:  [17.96666941]
curr_Stock_Price:  97.10320571906978
curr_Factors:  [9.71032057e+01 3.92953805e-02]
mat_Sqrt:  [[ 1.92488291e+01  0.00000000e+00]
 [-7.92922499e-03  1.81681368e-02]]
grads:  [-1.93804323e-03 -5.66493721e+01]
Stock Position:  -0.0019380432349116806
Bond Position:  [18.15485962]


portfolio before change:  [17.97862692]
curr_Stock_Price:  95.61829798241666
curr_Factors:  [9.56182980e+01 3.93073998e-02]
mat_Sqrt:  [[ 1.89573735e+01  0.00000000e+00]
 [-7.93043754e-03  1.81709152e-02]]
grads:  [-0.04824093 15.28522613]
Stock Position:  -0.048240929883689825
Bond Position:  [22.59134253]


portfolio before change:  [17.94831711]
curr_Stock_Price:  96.48080842544346
curr_Factors:  [9.64808084e+01 4.13677342e-02]
mat_Sqrt:  [[ 1.96232890e+01  0.00000000e+00]
 [-8.13562381e-03  1.86410560e-02]]
grads:  [-0.00153121  1.23436811]
Stock Position:  -0.001531210526268956
Bond Position:  [18.09604954]


portfolio before change:  [17.95395228]
curr_Stock_Price:  98.71114891513417
curr_Factors:  [9.87111489e+01 4.01371350e-02]
mat_Sqrt:  [[ 1.97760427e+01  0.00000000e+00]
 [-8.01370176e-03  1.83616975e-02]]
grads:  [-0.00170303  0.18435998]
Stock Position:  -0.0017030313770473665
Bond Position:  [18.12206046]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.95833961]
Stock Price:  101.45682104686924
PL:  [16.50151856]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.37103245e-01  2.91879622e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.91026077e-02  7.20351200e-03]
 [-1.54721435e-01 -4.27808098e-01]
 [ 4.61989207e-02  1.75520895e-01]
 [ 2.80845418e-01 -6.07873898e-01]
 [-4.46823370e-01  1.34011682e-02]
 [ 1.21727256e-01 -1.84002533e-01]
 [-4.53150658e-02  2.34813726e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.82310875]
curr_Stock_Price:  98.30410514261713
curr_Factors:  [9.83041051e+01 4.18579249e-02]
mat_Sqrt:  [[ 2.01122427e+01  0.00000000e+00]
 [-8.18368376e-03  1.87511751e-02]]
grads:  [-0.03031569 15.5659376 ]
Stock Position:  -0.030315690928454604
Bond Position:  [-5.84295188]


portfolio before change:  [-8.86193815]
curr_Stock_Price:  99.48854768839966
curr_Factors:  [9.94885477e+01 4.12394638e-02]
mat_Sqrt:  [[ 2.02036388e+01  0.00000000e+00]
 [-8.12300080e-03  1.86121330e-02]]
grads:  [ 0.00465063 -2.54011793]
Stock Position:  0.004650631100804446
Bond Position:  [-9.32462268]


portfolio before change:  [-8.85058316]
curr_Stock_Price:  102.93291238686417
curr_Factors:  [1.02932912e+02 4.05311112e-02]
mat_Sqrt:  [[ 2.07228038e+01  0.00000000e+00]
 [-8.05293598e-03  1.84515943e-02]]
grads:  [-0.00463059  0.39040052]
Stock Position:  -0.004630586575648133
Bond Position:  [-8.3739434]


portfolio before change:  [-8.84953583]
curr_Stock_Price:  101.80231203028345
curr_Factors:  [1.01802312e+02 4.28110379e-02]
mat_Sqrt:  [[ 2.10637417e+01  0.00000000e+00]
 [-8.27633135e-03  1.89634575e-02]]
grads:  [-1.62094751e-02 -2.25596044e+01]
Stock Position:  -0.016209475086615348
Bond Position:  [-7.19937379]


portfolio before change:  [-8.84080756]
curr_Stock_Price:  101.04171612321447
curr_Factors:  [1.01041716e+02 4.44705073e-02]
mat_Sqrt:  [[ 2.13077089e+01  0.00000000e+00]
 [-8.43521261e-03  1.93275001e-02]]
grads:  [5.76329063e-03 9.08140697e+00]
Stock Position:  0.00576329063065504
Bond Position:  [-9.42314034]


portfolio before change:  [-8.83457292]
curr_Stock_Price:  102.94121852997061
curr_Factors:  [1.02941219e+02 4.41307958e-02]
mat_Sqrt:  [[ 2.16252026e+01  0.00000000e+00]
 [-8.40293242e-03  1.92535369e-02]]
grads:  [ 7.18952757e-04 -3.15720639e+01]
Stock Position:  0.0007189527569196939
Bond Position:  [-8.9085828]


portfolio before change:  [-8.83643972]
curr_Stock_Price:  106.54174578458013
curr_Factors:  [1.06541746e+02 4.21160756e-02]
mat_Sqrt:  [[ 2.18647118e+01  0.00000000e+00]
 [-8.20888061e-03  1.88089084e-02]]
grads:  [-0.02016833  0.71249048]
Stock Position:  -0.02016832533440994
Bond Position:  [-6.68767113]


portfolio before change:  [-8.82684169]
curr_Stock_Price:  105.90001150456632
curr_Factors:  [1.05900012e+02 4.29387265e-02]
mat_Sqrt:  [[ 2.19442422e+01  0.00000000e+00]
 [-8.28866469e-03  1.89917167e-02]]
grads:  [ 1.88760072e-03 -9.68856771e+00]
Stock Position:  0.0018876007188392487
Bond Position:  [-9.02673862]


portfolio before change:  [-8.82807604]
curr_Stock_Price:  107.63774576468124
curr_Factors:  [1.07637746e+02 4.12600076e-02]
mat_Sqrt:  [[ 2.18639812e+01  0.00000000e+00]
 [-8.12502382e-03  1.86167683e-02]]
grads:  [2.61462199e-03 1.26130229e+01]
Stock Position:  0.002614621989926946
Bond Position:  [-9.10950805]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.83377884]
Stock Price:  107.19909225649499
PL:  [-16.0328711]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.96193749e-01  2.76140020e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 9.24634065e-02  5.75811287e-02]
 [-1.26590272e-01 -4.66015139e-01]
 [ 1.03790048e-01  3.76384722e-01]
 [ 2.86064737e-01 -6.09143100e-01]
 [-5.41520693e-01  4.91813651e-02]
 [-1.31207240e-02  3.25704708e-02]
 [-3.14553687e-02  1.01226431e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.88160563]
curr_Stock_Price:  99.5001911026658
curr_Factors:  [9.95001911e+01 4.38887006e-02]
mat_Sqrt:  [[ 2.08449221e+01  0.00000000e+00]
 [-8.37985209e-03  1.92006533e-02]]
grads:  [-1.32251088e-02  1.43818034e+01]
Stock Position:  -0.01322510883832203
Bond Position:  [0.43429523]


portfolio before change:  [-0.86819619]
curr_Stock_Price:  98.50267644609067
curr_Factors:  [9.85026764e+01 4.21598972e-02]
mat_Sqrt:  [[ 2.02254318e+01  0.00000000e+00]
 [-8.21315015e-03  1.88186911e-02]]
grads:  [ 0.00464562 -2.51223704]
Stock Position:  0.004645620024940949
Bond Position:  [-1.32580219]


portfolio before change:  [-0.86623677]
curr_Stock_Price:  99.0671836467486
curr_Factors:  [9.90671836e+01 4.31197430e-02]
mat_Sqrt:  [[ 2.05715918e+01  0.00000000e+00]
 [-8.30611755e-03  1.90317062e-02]]
grads:  [0.00571632 3.02553687]
Stock Position:  0.005716323383461812
Bond Position:  [-1.43253683]


portfolio before change:  [-0.83461108]
curr_Stock_Price:  104.72503924844779
curr_Factors:  [1.04725039e+02 4.11403470e-02]
mat_Sqrt:  [[ 2.12414670e+01  0.00000000e+00]
 [-8.11323334e-03  1.85897530e-02]]
grads:  [-1.55345181e-02 -2.50683880e+01]
Stock Position:  -0.01553451808280826
Bond Position:  [0.79224193]


portfolio before change:  [-0.81546667]
curr_Stock_Price:  103.51816605868079
curr_Factors:  [1.03518166e+02 4.22001944e-02]
mat_Sqrt:  [[ 2.12654117e+01  0.00000000e+00]
 [-8.21707436e-03  1.88276826e-02]]
grads:  [1.26053430e-02 1.99910276e+01]
Stock Position:  0.01260534299418326
Bond Position:  [-2.12034866]


portfolio before change:  [-0.82520554]
curr_Stock_Price:  102.82969414348717
curr_Factors:  [1.02829694e+02 4.11597159e-02]
mat_Sqrt:  [[ 2.08619418e+01  0.00000000e+00]
 [-8.11514298e-03  1.85941285e-02]]
grads:  [ 9.68888371e-04 -3.27599705e+01]
Stock Position:  0.0009688883705345797
Bond Position:  [-0.92483603]


portfolio before change:  [-0.82343023]
curr_Stock_Price:  105.13939498489967
curr_Factors:  [1.05139395e+02 4.01384654e-02]
mat_Sqrt:  [[ 2.10642430e+01  0.00000000e+00]
 [-8.01383458e-03  1.83620018e-02]]
grads:  [-0.02468905  2.67843156]
Stock Position:  -0.024689051757541217
Bond Position:  [1.77236174]


portfolio before change:  [-0.74550137]
curr_Stock_Price:  102.0188841506773
curr_Factors:  [1.02018884e+02 4.11112455e-02]
mat_Sqrt:  [[ 2.06852553e+01  0.00000000e+00]
 [-8.11036329e-03  1.85831769e-02]]
grads:  [5.28973317e-05 1.75268583e+00]
Stock Position:  5.289733170736238e-05
Bond Position:  [-0.7508979]


portfolio before change:  [-0.74580054]
curr_Stock_Price:  103.46275954316462
curr_Factors:  [1.03462760e+02 4.53849677e-02]
mat_Sqrt:  [[ 2.20414455e+01  0.00000000e+00]
 [-8.52149918e-03  1.95252075e-02]]
grads:  [5.77251968e-04 5.18439720e+00]
Stock Position:  0.000577251968006003
Bond Position:  [-0.80552462]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.74657464]
Stock Price:  102.8196389012225
PL:  [-3.56621354]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.53252262e-02  1.89173421e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 4.66584034e-02  5.07814792e-02]
 [-1.57849724e-01 -4.21282978e-01]
 [ 9.32864597e-03  6.61122117e-02]
 [ 3.59302173e-01 -6.97743025e-01]
 [-8.43066873e-01  1.67183510e-01]
 [-3.21270357e-02  1.74737447e-02]
 [-3.21899572e-02  1.08653019e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.40264416]
curr_Stock_Price:  101.80218309400702
curr_Factors:  [1.01802183e+02 3.71821427e-02]
mat_Sqrt:  [[ 1.96301807e+01  0.00000000e+00]
 [-7.71306867e-03  1.76728605e-02]]
grads:  [2.40633665e-03 1.07041767e+01]
Stock Position:  0.0024063366518473845
Bond Position:  [14.15767383]


portfolio before change:  [14.40808485]
curr_Stock_Price:  101.12068448412857
curr_Factors:  [1.01120684e+02 3.93540742e-02]
mat_Sqrt:  [[ 2.00601812e+01  0.00000000e+00]
 [-7.93514453e-03  1.81817002e-02]]
grads:  [ 0.00468389 -2.60025258]
Stock Position:  0.0046838894548488635
Bond Position:  [13.93444674]


portfolio before change:  [14.4112568]
curr_Stock_Price:  100.31003051161018
curr_Factors:  [1.00310031e+02 3.88143954e-02]
mat_Sqrt:  [[ 1.97624496e+01  0.00000000e+00]
 [-7.88054774e-03  1.80566033e-02]]
grads:  [0.00348243 2.8123495 ]
Stock Position:  0.0034824254733945856
Bond Position:  [14.0619346]


portfolio before change:  [14.42198897]
curr_Stock_Price:  101.37234795521557
curr_Factors:  [1.01372348e+02 3.90438646e-02]
mat_Sqrt:  [[ 2.00306898e+01  0.00000000e+00]
 [-7.90380815e-03  1.81098996e-02]]
grads:  [-1.70594570e-02 -2.32625795e+01]
Stock Position:  -0.017059456966501525
Bond Position:  [16.15134618]


portfolio before change:  [14.46014139]
curr_Stock_Price:  99.60941206759995
curr_Factors:  [9.96094121e+01 3.82232643e-02]
mat_Sqrt:  [[ 1.94744079e+01  0.00000000e+00]
 [-7.82030836e-03  1.79185775e-02]]
grads:  [1.96064398e-03 3.68959041e+00]
Stock Position:  0.0019606439790168465
Bond Position:  [14.26484279]


portfolio before change:  [14.46893431]
curr_Stock_Price:  100.4554200667773
curr_Factors:  [1.00455420e+02 3.83283308e-02]
mat_Sqrt:  [[ 1.96667831e+01  0.00000000e+00]
 [-7.83104906e-03  1.79431875e-02]]
grads:  [ 2.78551663e-03 -3.88862360e+01]
Stock Position:  0.002785516625782095
Bond Position:  [14.18911407]


portfolio before change:  [14.47648055]
curr_Stock_Price:  100.61693406091513
curr_Factors:  [1.00616934e+02 3.82018796e-02]
mat_Sqrt:  [[ 1.96658828e+01  0.00000000e+00]
 [-7.81812045e-03  1.79135644e-02]]
grads:  [-0.03915929  9.33278863]
Stock Position:  -0.039159290050819036
Bond Position:  [18.41656825]


portfolio before change:  [14.46375081]
curr_Stock_Price:  101.17721810427501
curr_Factors:  [1.01177218e+02 4.06999890e-02]
mat_Sqrt:  [[ 2.04117331e+01  0.00000000e+00]
 [-8.06969531e-03  1.84899948e-02]]
grads:  [-0.00120033  0.94503784]
Stock Position:  -0.001200332584922096
Bond Position:  [14.58519712]


portfolio before change:  [14.46801833]
curr_Stock_Price:  103.69893526602296
curr_Factors:  [1.03698935e+02 3.94026044e-02]
mat_Sqrt:  [[ 2.05843312e+01  0.00000000e+00]
 [-7.94003571e-03  1.81929073e-02]]
grads:  [7.39888408e-04 5.97227355e+00]
Stock Position:  0.0007398884077460794
Bond Position:  [14.39129269]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.47453083]
Stock Price:  102.77319287817187
PL:  [11.70133795]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.05375713e-01  3.24166904e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 9.74754021e-02  6.08915639e-02]
 [-1.60481824e-01 -4.15789070e-01]
 [ 5.48044672e-02  2.02167285e-01]
 [ 3.47121570e-01 -6.59427799e-01]
 [-7.86355498e-01  1.41688028e-01]
 [-6.99337004e-02 -7.61573210e-03]
 [-2.76319973e-02  1.71008100e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.90398666]
curr_Stock_Price:  101.12463112483483
curr_Factors:  [1.01124631e+02 3.67988270e-02]
mat_Sqrt:  [[ 1.93987586e+01  0.00000000e+00]
 [-7.67320814e-03  1.75815286e-02]]
grads:  [-3.29390550e-03  1.84379249e+01]
Stock Position:  -0.0032939054950444652
Bond Position:  [10.23708163]


portfolio before change:  [9.91791602]
curr_Stock_Price:  98.45013301955382
curr_Factors:  [9.84501330e+01 3.84812378e-02]
mat_Sqrt:  [[ 1.93126035e+01  0.00000000e+00]
 [-7.84665410e-03  1.79789432e-02]]
grads:  [ 0.0048652  -2.62957685]
Stock Position:  0.00486519961143609
Bond Position:  [9.43893647]


portfolio before change:  [9.92543593]
curr_Stock_Price:  99.02549661429387
curr_Factors:  [9.90254966e+01 3.77251695e-02]
mat_Sqrt:  [[ 1.92336908e+01  0.00000000e+00]
 [-7.76918730e-03  1.78014444e-02]]
grads:  [0.00644965 3.4205968 ]
Stock Position:  0.006449654457513278
Bond Position:  [9.28675569]


portfolio before change:  [9.94288405]
curr_Stock_Price:  101.0106540002986
curr_Factors:  [1.01010654e+02 3.57581126e-02]
mat_Sqrt:  [[ 1.91009284e+01  0.00000000e+00]
 [-7.56392624e-03  1.73311323e-02]]
grads:  [-1.79021168e-02 -2.39908774e+01]
Stock Position:  -0.017902116800165284
Bond Position:  [11.75118857]


portfolio before change:  [9.94215007]
curr_Stock_Price:  101.37994194441728
curr_Factors:  [1.01379942e+02 3.56845085e-02]
mat_Sqrt:  [[ 1.91510195e+01  0.00000000e+00]
 [-7.55613748e-03  1.73132860e-02]]
grads:  [7.46892373e-03 1.16770026e+01]
Stock Position:  0.007468923728544744
Bond Position:  [9.18495102]


portfolio before change:  [9.94351628]
curr_Stock_Price:  100.9478299189995
curr_Factors:  [1.00947830e+02 4.00437554e-02]
mat_Sqrt:  [[ 2.02006055e+01  0.00000000e+00]
 [-8.00437434e-03  1.83403257e-02]]
grads:  [ 2.93672799e-03 -3.59550758e+01]
Stock Position:  0.002936727991408856
Bond Position:  [9.64705997]


portfolio before change:  [9.94996645]
curr_Stock_Price:  101.50131381524801
curr_Factors:  [1.01501314e+02 4.01137578e-02]
mat_Sqrt:  [[ 2.03291087e+01  0.00000000e+00]
 [-8.01136770e-03  1.83563495e-02]]
grads:  [-0.03563943  7.71874761]
Stock Position:  -0.03563942641759429
Bond Position:  [13.56741506]


portfolio before change:  [10.03883521]
curr_Stock_Price:  99.19815244116317
curr_Factors:  [9.91981524e+01 4.31412498e-02]
mat_Sqrt:  [[ 2.06039242e+01  0.00000000e+00]
 [-8.30818871e-03  1.90364518e-02]]
grads:  [-0.00355551 -0.40006048]
Stock Position:  -0.0035555109560395665
Bond Position:  [10.39153532]


portfolio before change:  [10.03844234]
curr_Stock_Price:  100.77034226866618
curr_Factors:  [1.00770342e+02 4.34744319e-02]
mat_Sqrt:  [[ 2.10111436e+01  0.00000000e+00]
 [-8.34020930e-03  1.91098202e-02]]
grads:  [-0.0009599   0.89487027]
Stock Position:  -0.0009598997692522152
Bond Position:  [10.13517176]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.03981414]
Stock Price:  104.62183840232741
PL:  [5.41797574]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 2.76187770e-02  7.13516621e-02]
 [-6.19263446e-03  2.30486431e-01]
 [-9.91124566e-02  7.13339659e-03]
 [-9.63041476e-02 -4.92680780e-01]
 [ 1.43099302e-01  5.59782245e-01]
 [ 2.37952355e-01 -6.28706331e-01]
 [-8.41115388e-01  1.66224465e-01]
 [-2.58639030e-02  2.16301210e-02]
 [-2.66378733e-02  2.34036824e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.52676043]
curr_Stock_Price:  101.97148853567788
curr_Factors:  [1.01971489e+02 3.56435335e-02]
mat_Sqrt:  [[ 1.92517022e+01  0.00000000e+00]
 [-7.55179804e-03  1.73033431e-02]]
grads:  [3.05215584e-03 4.12357669e+00]
Stock Position:  0.0030521558444052905
Bond Position:  [15.21552756]


portfolio before change:  [15.53869773]
curr_Stock_Price:  103.38938176322752
curr_Factors:  [1.03389382e+02 3.59185250e-02]
mat_Sqrt:  [[ 1.95945451e+01  0.00000000e+00]
 [-7.58087330e-03  1.73699629e-02]]
grads:  [4.81766178e-03 1.32692530e+01]
Stock Position:  0.004817661782091299
Bond Position:  [15.04060266]


portfolio before change:  [15.54382939]
curr_Stock_Price:  102.8931817851369
curr_Factors:  [1.02893182e+02 3.81780081e-02]
mat_Sqrt:  [[ 2.01044978e+01  0.00000000e+00]
 [-7.81567738e-03  1.79079666e-02]]
grads:  [-0.00477501  0.39833649]
Stock Position:  -0.004775010441575348
Bond Position:  [16.0351454]


portfolio before change:  [15.5315214]
curr_Stock_Price:  107.15025420381018
curr_Factors:  [1.07150254e+02 3.85010694e-02]
mat_Sqrt:  [[ 2.10246900e+01  0.00000000e+00]
 [-7.84867575e-03  1.79835754e-02]]
grads:  [-1.48077174e-02 -2.73961529e+01]
Stock Position:  -0.014807717381729039
Bond Position:  [17.11817208]


portfolio before change:  [15.56380801]
curr_Stock_Price:  105.5480228289403
curr_Factors:  [1.05548023e+02 4.00043201e-02]
mat_Sqrt:  [[ 2.11107445e+01  0.00000000e+00]
 [-8.00043200e-03  1.83312926e-02]]
grads:  [1.83512383e-02 3.05369761e+01]
Stock Position:  0.018351238324010487
Bond Position:  [13.62687109]


portfolio before change:  [15.54345973]
curr_Stock_Price:  104.06782737770006
curr_Factors:  [1.04067827e+02 3.89116121e-02]
mat_Sqrt:  [[ 2.05284472e+01  0.00000000e+00]
 [-7.89041060e-03  1.80792019e-02]]
grads:  [-1.77498003e-03 -3.47751153e+01]
Stock Position:  -0.0017749800261807297
Bond Position:  [15.72817805]


portfolio before change:  [15.55740199]
curr_Stock_Price:  100.64457910358952
curr_Factors:  [1.00644579e+02 3.84193417e-02]
mat_Sqrt:  [[ 1.97271955e+01  0.00000000e+00]
 [-7.84034098e-03  1.79644780e-02]]
grads:  [-0.03895988  9.25295268]
Stock Position:  -0.03895987576931079
Bond Position:  [19.47850229]


portfolio before change:  [15.53492858]
curr_Stock_Price:  101.47145774582165
curr_Factors:  [1.01471458e+02 3.84532739e-02]
mat_Sqrt:  [[ 1.98980519e+01  0.00000000e+00]
 [-7.84380254e-03  1.79724094e-02]]
grads:  [-8.25394580e-04  1.20351815e+00]
Stock Position:  -0.0008253945799014911
Bond Position:  [15.61868258]


portfolio before change:  [15.54297015]
curr_Stock_Price:  101.19247220313439
curr_Factors:  [1.01192472e+02 3.96728344e-02]
mat_Sqrt:  [[ 2.01555578e+01  0.00000000e+00]
 [-7.96721626e-03  1.82551858e-02]]
grads:  [-8.14845667e-04  1.28202926e+00]
Stock Position:  -0.0008148456669537729
Bond Position:  [15.6254264]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.54974158]
Stock Price:  102.4727586730441
PL:  [13.07698291]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.33469886e-01  3.82843947e-01]
 [-1.68611682e-02  2.30262202e-01]
 [-9.79083091e-02  1.57057843e-02]
 [-5.65150157e-02 -5.27748327e-01]
 [ 1.99192032e-01  8.21483157e-01]
 [ 2.00873446e-01 -6.83118742e-01]
 [-4.01047590e-01 -3.89319125e-03]
 [ 2.11674204e-01 -3.26225596e-01]
 [-4.49434256e-02  2.31373632e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.65051379]
curr_Stock_Price:  101.53829117142136
curr_Factors:  [1.01538291e+02 3.77895366e-02]
mat_Sqrt:  [[ 1.97385676e+01  0.00000000e+00]
 [-7.77581240e-03  1.78166245e-02]]
grads:  [1.70310793e-03 2.14880180e+01]
Stock Position:  0.001703107925775382
Bond Position:  [12.47758313]


portfolio before change:  [12.6606]
curr_Stock_Price:  103.79643170039013
curr_Factors:  [1.03796432e+02 3.70480807e-02]
mat_Sqrt:  [[ 1.99786105e+01  0.00000000e+00]
 [-7.69915119e-03  1.76409716e-02]]
grads:  [4.18615177e-03 1.30526939e+01]
Stock Position:  0.0041861517692183
Bond Position:  [12.22609239]


portfolio before change:  [12.68410602]
curr_Stock_Price:  107.95094904384389
curr_Factors:  [1.07950949e+02 3.40218054e-02]
mat_Sqrt:  [[ 1.99115534e+01  0.00000000e+00]
 [-7.37800031e-03  1.69051224e-02]]
grads:  [-0.00457291  0.92905475]
Stock Position:  -0.004572910065521796
Bond Position:  [13.177756]


portfolio before change:  [12.67978759]
curr_Stock_Price:  110.33650885786564
curr_Factors:  [1.10336509e+02 3.57819558e-02]
mat_Sqrt:  [[ 2.08713853e+01  0.00000000e+00]
 [-7.56644760e-03  1.73369094e-02]]
grads:  [-1.37433747e-02 -3.04407385e+01]
Stock Position:  -0.013743374675498266
Bond Position:  [14.19618357]


portfolio before change:  [12.71291471]
curr_Stock_Price:  108.44270558861432
curr_Factors:  [1.08442706e+02 3.46738002e-02]
mat_Sqrt:  [[ 2.01930102e+01  0.00000000e+00]
 [-7.44836092e-03  1.70663388e-02]]
grads:  [2.76192934e-02 4.81347033e+01]
Stock Position:  0.027619293397176305
Bond Position:  [9.71780381]


portfolio before change:  [12.72100317]
curr_Stock_Price:  108.55959297762554
curr_Factors:  [1.08559593e+02 3.52443353e-02]
mat_Sqrt:  [[ 2.03804077e+01  0.00000000e+00]
 [-7.50938988e-03  1.72061738e-02]]
grads:  [-4.77242734e-03 -3.97019553e+01]
Stock Position:  -0.004772427340580526
Bond Position:  [13.23909594]


portfolio before change:  [12.73394165]
curr_Stock_Price:  107.23588978881476
curr_Factors:  [1.07235890e+02 3.63880667e-02]
mat_Sqrt:  [[ 2.04559499e+01  0.00000000e+00]
 [-7.63026256e-03  1.74831279e-02]]
grads:  [-0.01968849 -0.22268276]
Stock Position:  -0.019688487746906524
Bond Position:  [14.84525415]


portfolio before change:  [12.71960511]
curr_Stock_Price:  108.34115634342183
curr_Factors:  [1.08341156e+02 3.42850537e-02]
mat_Sqrt:  [[ 2.00606908e+01  0.00000000e+00]
 [-7.40648945e-03  1.69703993e-02]]
grads:  [ 3.45440154e-03 -1.92232128e+01]
Stock Position:  0.0034544015353469583
Bond Position:  [12.34535125]


portfolio before change:  [12.72298384]
curr_Stock_Price:  107.5319033886969
curr_Factors:  [1.07531903e+02 3.90070894e-02]
mat_Sqrt:  [[ 2.12377794e+01  0.00000000e+00]
 [-7.90008500e-03  1.81013688e-02]]
grads:  [2.63852002e-03 1.27821070e+01]
Stock Position:  0.002638520015911326
Bond Position:  [12.43925876]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.72157991]
Stock Price:  104.64198126589507
PL:  [8.07959864]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.76925022e-01  2.89679014e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.91915255e-02  6.57050145e-03]
 [-1.55785522e-01 -4.25294819e-01]
 [ 9.25024870e-02  3.23722547e-01]
 [ 2.45872813e-01 -6.32804024e-01]
 [-3.67313043e-01 -1.66385843e-02]
 [ 1.74505326e-01 -2.67372370e-01]
 [-4.17125455e-02  2.00609257e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.85230559]
curr_Stock_Price:  98.14909570959472
curr_Factors:  [9.81490957e+01 4.09697362e-02]
mat_Sqrt:  [[ 1.98663410e+01  0.00000000e+00]
 [-8.09639289e-03  1.85511666e-02]]
grads:  [-0.03274376 15.61513726]
Stock Position:  -0.032743761652051874
Bond Position:  [-6.638535]


portfolio before change:  [-9.94525909]
curr_Stock_Price:  100.88651487711923
curr_Factors:  [1.00886515e+02 3.86403297e-02]
mat_Sqrt:  [[ 1.98314072e+01  0.00000000e+00]
 [-7.86285746e-03  1.80160697e-02]]
grads:  [ 0.00473792 -2.62415796]
Stock Position:  0.004737922542929598
Bond Position:  [-10.42325159]


portfolio before change:  [-9.94253222]
curr_Stock_Price:  102.56231228860062
curr_Factors:  [1.02562312e+02 3.66401910e-02]
mat_Sqrt:  [[ 1.96320960e+01  0.00000000e+00]
 [-7.65665107e-03  1.75435916e-02]]
grads:  [-0.00490645  0.37452431]
Stock Position:  -0.0049064513423685225
Bond Position:  [-9.43931523]


portfolio before change:  [-9.94283412]
curr_Stock_Price:  101.66167296319956
curr_Factors:  [1.01661673e+02 3.24654273e-02]
mat_Sqrt:  [[ 1.83175681e+01  0.00000000e+00]
 [-7.20726603e-03  1.65139211e-02]]
grads:  [-1.86378125e-02 -2.57537151e+01]
Stock Position:  -0.018637812488230827
Bond Position:  [-8.04808292]


portfolio before change:  [-9.97043563]
curr_Stock_Price:  102.92665327198802
curr_Factors:  [1.02926653e+02 3.25173429e-02]
mat_Sqrt:  [[ 1.85603165e+01  0.00000000e+00]
 [-7.21302632e-03  1.65271196e-02]]
grads:  [1.25960454e-02 1.95873544e+01]
Stock Position:  0.012596045426552896
Bond Position:  [-11.26690443]


portfolio before change:  [-9.96364416]
curr_Stock_Price:  103.91317951897084
curr_Factors:  [1.0391318e+02 3.2344291e-02]
mat_Sqrt:  [[ 1.86882851e+01  0.00000000e+00]
 [-7.19380745e-03  1.64830836e-02]]
grads:  [-1.62163114e-03 -3.83911190e+01]
Stock Position:  -0.0016216311351559087
Bond Position:  [-9.79513532]


portfolio before change:  [-9.97475557]
curr_Stock_Price:  107.74426816625444
curr_Factors:  [1.07744268e+02 3.34707742e-02]
mat_Sqrt:  [[ 1.97118350e+01  0.00000000e+00]
 [-7.31800784e-03  1.67676624e-02]]
grads:  [-0.01900253 -0.99230196]
Stock Position:  -0.01900252901504508
Bond Position:  [-7.92734199]


portfolio before change:  [-9.97098081]
curr_Stock_Price:  107.33698445502633
curr_Factors:  [1.07336984e+02 3.09114918e-02]
mat_Sqrt:  [[ 1.88716282e+01  0.00000000e+00]
 [-7.03266570e-03  1.61138615e-02]]
grads:  [ 3.06356486e-03 -1.65926939e+01]
Stock Position:  0.003063564861983705
Bond Position:  [-10.29981462]


portfolio before change:  [-9.97846682]
curr_Stock_Price:  106.57485935027364
curr_Factors:  [1.06574859e+02 3.36992206e-02]
mat_Sqrt:  [[ 1.95643173e+01  0.00000000e+00]
 [-7.34293899e-03  1.68247869e-02]]
grads:  [2.34306730e-03 1.19234352e+01]
Stock Position:  0.0023430672964773547
Bond Position:  [-10.22817889]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.97926924]
Stock Price:  108.41558658147561
PL:  [-18.39485583]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.95934635e-01  3.10271856e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 2.62778203e-02 -5.51190454e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.76487776e-01 -1.68409040e+00]
 [-1.06600792e+00  2.66463306e-01]
 [-6.76500269e-02 -6.10022752e-03]
 [-3.68667496e-02  1.97201163e-04]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.71260226]
curr_Stock_Price:  100.04152207400033
curr_Factors:  [1.00041522e+02 4.03118057e-02]
mat_Sqrt:  [[ 2.00861368e+01  0.00000000e+00]
 [-8.03112004e-03  1.84016078e-02]]
grads:  [-7.99162609e-03  1.68611276e+01]
Stock Position:  -0.00799162608734849
Bond Position:  [3.5120967]


portfolio before change:  [2.72683407]
curr_Stock_Price:  98.48047350004347
curr_Factors:  [9.84804735e+01 4.10541838e-02]
mat_Sqrt:  [[ 1.99539481e+01  0.00000000e+00]
 [-8.10473282e-03  1.85702758e-02]]
grads:  [ 0.00470883 -2.54584333]
Stock Position:  0.004708826062134623
Bond Position:  [2.26310665]


portfolio before change:  [2.71832213]
curr_Stock_Price:  96.43245274881478
curr_Factors:  [9.64324527e+01 4.17246688e-02]
mat_Sqrt:  [[ 1.96978879e+01  0.00000000e+00]
 [-8.17064686e-03  1.87213038e-02]]
grads:  [ 0.02044718 10.41086114]
Stock Position:  0.020447176017027037
Bond Position:  [0.74655079]


portfolio before change:  [2.64862386]
curr_Stock_Price:  93.0054936429492
curr_Factors:  [9.30054936e+01 4.31992813e-02]
mat_Sqrt:  [[ 1.93306681e+01  0.00000000e+00]
 [-8.31377472e-03  1.90492510e-02]]
grads:  [-1.10850497e-02 -2.89350198e+01]
Stock Position:  -0.01108504968177981
Bond Position:  [3.67959438]


portfolio before change:  [2.66018662]
curr_Stock_Price:  92.12841106773021
curr_Factors:  [9.21284111e+01 4.21964640e-02]
mat_Sqrt:  [[ 1.89248136e+01  0.00000000e+00]
 [-8.21671117e-03  1.88268504e-02]]
grads:  [-3.72353468e-03 -4.52518584e+00]
Stock Position:  -0.0037235346794415956
Bond Position:  [3.00322996]


portfolio before change:  [2.66466856]
curr_Stock_Price:  91.32811048540447
curr_Factors:  [9.13281105e+01 3.87272189e-02]
mat_Sqrt:  [[ 1.79726711e+01  0.00000000e+00]
 [-7.87169297e-03  1.80363144e-02]]
grads:  [-1.43834786e-02 -9.33722022e+01]
Stock Position:  -0.014383478647640864
Bond Position:  [3.97828449]


portfolio before change:  [2.5922797]
curr_Stock_Price:  96.49921681903596
curr_Factors:  [9.64992168e+01 3.45648023e-02]
mat_Sqrt:  [[ 1.79407596e+01  0.00000000e+00]
 [-7.43664466e-03  1.70394935e-02]]
grads:  [-0.0529361  15.63798276]
Stock Position:  -0.05293609742263762
Bond Position:  [7.70057164]


portfolio before change:  [2.50473252]
curr_Stock_Price:  98.2257971729141
curr_Factors:  [9.82257972e+01 3.50302312e-02]
mat_Sqrt:  [[ 1.83842985e+01  0.00000000e+00]
 [-7.48654593e-03  1.71538317e-02]]
grads:  [-0.00382459 -0.35561894]
Stock Position:  -0.003824588918855145
Bond Position:  [2.88040582]


portfolio before change:  [2.50609526]
curr_Stock_Price:  98.24614646415901
curr_Factors:  [9.82461465e+01 3.49864685e-02]
mat_Sqrt:  [[ 1.83766176e+01  0.00000000e+00]
 [-7.48186805e-03  1.71431133e-02]]
grads:  [-0.00200149  0.01150323]
Stock Position:  -0.002001493674348765
Bond Position:  [2.7027343]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.50785844]
Stock Price:  98.04056094515013
PL:  [2.50785844]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.73642969e-01  2.82454400e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 2.12504650e-01 -5.57460205e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 5.24705054e-01 -2.18948751e+00]
 [-5.69729949e-01  4.33609112e-01]
 [ 3.80942839e-01 -1.08560508e-01]
 [ 2.00258380e-01 -1.31835511e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.70405902]
curr_Stock_Price:  99.22570768588989
curr_Factors:  [9.92257077e+01 3.80683778e-02]
mat_Sqrt:  [[ 1.93600462e+01  0.00000000e+00]
 [-7.80444774e-03  1.78822363e-02]]
grads:  [-0.01809757 15.79525044]
Stock Position:  -0.018097568479198415
Bond Position:  [-0.90831498]


portfolio before change:  [-2.65137101]
curr_Stock_Price:  96.28927566085535
curr_Factors:  [9.62892757e+01 3.93329611e-02]
mat_Sqrt:  [[ 1.90966083e+01  0.00000000e+00]
 [-7.93301568e-03  1.81768224e-02]]
grads:  [ 0.00492023 -2.60095036]
Stock Position:  0.0049202282097342434
Bond Position:  [-3.12513622]


portfolio before change:  [-2.68505726]
curr_Stock_Price:  89.76045501562247
curr_Factors:  [8.97604550e+01 4.26772965e-02]
mat_Sqrt:  [[ 1.85431493e+01  0.00000000e+00]
 [-8.26339364e-03  1.89338134e-02]]
grads:  [ 0.02172048 10.29401158]
Stock Position:  0.021720484170888427
Bond Position:  [-4.6346978]


portfolio before change:  [-2.69386387]
curr_Stock_Price:  89.46171910320557
curr_Factors:  [8.94617191e+01 4.12635537e-02]
mat_Sqrt:  [[ 1.81727459e+01  0.00000000e+00]
 [-8.12537298e-03  1.86175684e-02]]
grads:  [-1.69434658e-03 -2.99426969e+01]
Stock Position:  -0.0016943465848856276
Bond Position:  [-2.54228472]


portfolio before change:  [-2.69600083]
curr_Stock_Price:  89.97253542024096
curr_Factors:  [8.99725354e+01 4.12171760e-02]
mat_Sqrt:  [[ 1.82662365e+01  0.00000000e+00]
 [-8.12080548e-03  1.86071029e-02]]
grads:  [-3.85778427e-03 -4.57862772e+00]
Stock Position:  -0.003857784272517985
Bond Position:  [-2.3489062]


portfolio before change:  [-2.68495131]
curr_Stock_Price:  86.80380771560893
curr_Factors:  [8.68038077e+01 4.66681362e-02]
mat_Sqrt:  [[ 1.87520609e+01  0.00000000e+00]
 [-8.64112365e-03  1.97993016e-02]]
grads:  [-2.29769751e-02 -1.10584078e+02]
Stock Position:  -0.022976975147782117
Bond Position:  [-0.69046238]


portfolio before change:  [-2.65113159]
curr_Stock_Price:  85.31688263379701
curr_Factors:  [8.53168826e+01 4.20536495e-02]
mat_Sqrt:  [[ 1.74959216e+01  0.00000000e+00]
 [-8.20279460e-03  1.87949636e-02]]
grads:  [-2.17472064e-02  2.30704950e+01]
Stock Position:  -0.02174720640172968
Bond Position:  [-0.79572773]


portfolio before change:  [-2.62867426]
curr_Stock_Price:  84.26592966749253
curr_Factors:  [8.42659297e+01 4.02497461e-02]
mat_Sqrt:  [[ 1.69057168e+01  0.00000000e+00]
 [-8.02493575e-03  1.83874378e-02]]
grads:  [ 0.01973079 -5.90405848]
Stock Position:  0.01973079007866557
Bond Position:  [-4.29130763]


portfolio before change:  [-2.60319329]
curr_Stock_Price:  85.66613507109989
curr_Factors:  [8.56661351e+01 3.66653771e-02]
mat_Sqrt:  [[ 1.64035275e+01  0.00000000e+00]
 [-7.65928217e-03  1.75496202e-02]]
grads:  [ 0.00870061 -7.51215752]
Stock Position:  0.00870060695382972
Bond Position:  [-3.34854066]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.60844745]
Stock Price:  85.25473094033238
PL:  [-2.60844745]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-6.30601211e-01  2.93717612e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.36051428e-01  1.49294028e-01]
 [-1.23515832e-01 -4.87684199e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 3.81561287e-01 -7.67761150e-01]
 [-7.53112158e-01  1.29128336e-01]
 [-2.99582336e-04  1.36029560e-02]
 [-4.04055853e-02  1.88052654e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.20265866]
curr_Stock_Price:  98.69877646868953
curr_Factors:  [9.86987765e+01 4.15605419e-02]
mat_Sqrt:  [[ 2.01211301e+01  0.00000000e+00]
 [-8.15456112e-03  1.86844468e-02]]
grads:  [-0.02496939 15.71989877]
Stock Position:  -0.02496938953441492
Bond Position:  [-3.73821046]


portfolio before change:  [-6.18797982]
curr_Stock_Price:  98.036028608117
curr_Factors:  [9.80360286e+01 4.09383306e-02]
mat_Sqrt:  [[ 1.98358481e+01  0.00000000e+00]
 [-8.09328914e-03  1.85440550e-02]]
grads:  [ 0.00473686 -2.54944308]
Stock Position:  0.004736861786657564
Bond Position:  [-6.65236294]


portfolio before change:  [-6.19269508]
curr_Stock_Price:  97.74295581431947
curr_Factors:  [9.77429558e+01 4.09109444e-02]
mat_Sqrt:  [[ 1.97699341e+01  0.00000000e+00]
 [-8.09058163e-03  1.85378514e-02]]
grads:  [0.01523569 8.05346992]
Stock Position:  0.01523569488485629
Bond Position:  [-7.68187693]


portfolio before change:  [-6.20549656]
curr_Stock_Price:  97.1548906583932
curr_Factors:  [9.71548907e+01 4.26721459e-02]
mat_Sqrt:  [[ 2.00695165e+01  0.00000000e+00]
 [-8.26289498e-03  1.89326709e-02]]
grads:  [-1.67596796e-02 -2.57588696e+01]
Stock Position:  -0.016759679619644953
Bond Position:  [-4.57721172]


portfolio before change:  [-6.2025935]
curr_Stock_Price:  96.84508542057924
curr_Factors:  [9.68450854e+01 4.18224473e-02]
mat_Sqrt:  [[ 1.98053402e+01  0.00000000e+00]
 [-8.18021489e-03  1.87432270e-02]]
grads:  [-3.55798986e-03 -4.54537510e+00]
Stock Position:  -0.0035579898594491183
Bond Position:  [-5.85801967]


portfolio before change:  [-6.21500736]
curr_Stock_Price:  99.51066943639735
curr_Factors:  [9.95106694e+01 3.88966866e-02]
mat_Sqrt:  [[ 1.96257360e+01  0.00000000e+00]
 [-7.88889717e-03  1.80757342e-02]]
grads:  [ 2.36846406e-03 -4.24746868e+01]
Stock Position:  0.0023684640628997625
Bond Position:  [-6.45069481]


portfolio before change:  [-6.21232914]
curr_Stock_Price:  102.00358449569364
curr_Factors:  [1.02003584e+02 3.67067326e-02]
mat_Sqrt:  [[ 1.95428680e+01  0.00000000e+00]
 [-7.66360047e-03  1.75595146e-02]]
grads:  [-0.0356527   7.35375314]
Stock Position:  -0.035652696097488425
Bond Position:  [-2.57562634]


portfolio before change:  [-6.23380837]
curr_Stock_Price:  102.56991189414818
curr_Factors:  [1.02569912e+02 3.79270060e-02]
mat_Sqrt:  [[ 1.99753438e+01  0.00000000e+00]
 [-7.78994285e-03  1.78490014e-02]]
grads:  [2.82209631e-04 7.62113003e-01]
Stock Position:  0.00028220963095367365
Bond Position:  [-6.26275459]


portfolio before change:  [-6.23592091]
curr_Stock_Price:  106.18290706787553
curr_Factors:  [1.06182907e+02 3.34124762e-02]
mat_Sqrt:  [[ 1.94092584e+01  0.00000000e+00]
 [-7.31163196e-03  1.67530535e-02]]
grads:  [2.14677555e-03 1.12249778e+01]
Stock Position:  0.002146775553958926
Bond Position:  [-6.46387178]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.23219089]
Stock Price:  109.42626576448109
PL:  [-15.65845665]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.45515753e-01  2.80035530e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.47235000e-01 -4.19911279e-01]
 [-9.99990978e-03  6.97398906e-03]
 [ 4.14487121e-01 -1.05200561e+00]
 [-9.33661750e-01  2.11737307e-01]
 [-5.65984892e-02  1.23385766e-03]
 [-4.33334293e-02  2.16234109e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.02623599]
curr_Stock_Price:  99.3277959928641
curr_Factors:  [9.93277960e+01 4.14350505e-02]
mat_Sqrt:  [[ 2.02187701e+01  0.00000000e+00]
 [-8.14224052e-03  1.86562168e-02]]
grads:  [-0.01599    15.01030642]
Stock Position:  -0.015990004599596437
Bond Position:  [-0.43798408]


portfolio before change:  [-2.01893681]
curr_Stock_Price:  98.85761298731329
curr_Factors:  [9.88576130e+01 3.95085887e-02]
mat_Sqrt:  [[ 1.96496979e+01  0.00000000e+00]
 [-7.95070700e-03  1.82173583e-02]]
grads:  [ 0.00478174 -2.59516292]
Stock Position:  0.004781736162572171
Bond Position:  [-2.49164783]


portfolio before change:  [-2.03157664]
curr_Stock_Price:  96.47486022995353
curr_Factors:  [9.64748602e+01 3.69624290e-02]
mat_Sqrt:  [[ 1.85478857e+01  0.00000000e+00]
 [-7.69024619e-03  1.76205676e-02]]
grads:  [ 0.02171494 11.06121543]
Stock Position:  0.02171493769795267
Bond Position:  [-4.12652222]


portfolio before change:  [-1.97676565]
curr_Stock_Price:  99.09401430751926
curr_Factors:  [9.90940143e+01 3.62810861e-02]
mat_Sqrt:  [[ 1.88750261e+01  0.00000000e+00]
 [-7.61903785e-03  1.74574088e-02]]
grads:  [-1.75098728e-02 -2.40534711e+01]
Stock Position:  -0.017509872809507967
Bond Position:  [-0.24164206]


portfolio before change:  [-1.9743385]
curr_Stock_Price:  98.94849648104909
curr_Factors:  [9.89484965e+01 3.86971077e-02]
mat_Sqrt:  [[ 1.94647331e+01  0.00000000e+00]
 [-7.86863218e-03  1.80293013e-02]]
grads:  [-3.57375125e-04  3.86814162e-01]
Stock Position:  -0.0003573751250306027
Bond Position:  [-1.93897677]


portfolio before change:  [-1.97458219]
curr_Stock_Price:  96.91690043815619
curr_Factors:  [9.69169004e+01 3.74497012e-02]
mat_Sqrt:  [[ 1.87552861e+01  0.00000000e+00]
 [-7.74077011e-03  1.77363325e-02]]
grads:  [-2.38043651e-03 -5.93135931e+01]
Stock Position:  -0.0023804365119215382
Bond Position:  [-1.74387766]


portfolio before change:  [-1.98116904]
curr_Stock_Price:  99.31759342851771
curr_Factors:  [9.93175934e+01 3.75203520e-02]
mat_Sqrt:  [[ 1.92379876e+01  0.00000000e+00]
 [-7.74806835e-03  1.77530549e-02]]
grads:  [-0.04372869 11.92680973]
Stock Position:  -0.04372869099538061
Bond Position:  [2.36185931]


portfolio before change:  [-2.00793667]
curr_Stock_Price:  99.95673561386994
curr_Factors:  [9.99567356e+01 3.71832285e-02]
mat_Sqrt:  [[ 1.92746106e+01  0.00000000e+00]
 [-7.71318129e-03  1.76731185e-02]]
grads:  [-0.00290849  0.0698155 ]
Stock Position:  -0.002908488833048778
Bond Position:  [-1.71721362]


portfolio before change:  [-2.02946457]
curr_Stock_Price:  107.06320311010293
curr_Factors:  [1.07063203e+02 3.31852880e-02]
mat_Sqrt:  [[ 1.95035213e+01  0.00000000e+00]
 [-7.28673183e-03  1.66960001e-02]]
grads:  [2.61690555e-03 1.29512523e+01]
Stock Position:  0.0026169055489193107
Bond Position:  [-2.30963886]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.02959076]
Stock Price:  107.45638380109976
PL:  [-9.48597457]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.60713916e-01  2.90574863e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.51705997e-01  1.59369103e-01]
 [-1.04516638e-01 -5.42617712e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.10528193e-01 -1.02435516e+00]
 [-1.03838419e+00  2.77112402e-01]
 [-9.28832562e-03  5.66183785e-02]
 [-3.72775272e-02 -9.47612107e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.46232249]
curr_Stock_Price:  98.20783185884771
curr_Factors:  [9.82078319e+01 3.94009150e-02]
mat_Sqrt:  [[ 1.94939244e+01  0.00000000e+00]
 [-7.93986549e-03  1.81925173e-02]]
grads:  [-0.03251765 15.97221856]
Stock Position:  -0.03251765203744561
Bond Position:  [-6.26883439]


portfolio before change:  [-9.48000601]
curr_Stock_Price:  98.65522933331287
curr_Factors:  [9.86552293e+01 4.09717040e-02]
mat_Sqrt:  [[ 1.99692670e+01  0.00000000e+00]
 [-8.09658733e-03  1.85516122e-02]]
grads:  [ 0.00470521 -2.54840455]
Stock Position:  0.0047052138160697515
Bond Position:  [-9.94419996]


portfolio before change:  [-9.48993868]
curr_Stock_Price:  97.60122159027236
curr_Factors:  [9.76012216e+01 4.25681787e-02]
mat_Sqrt:  [[ 2.01371399e+01  0.00000000e+00]
 [-8.25282290e-03  1.89095928e-02]]
grads:  [0.01595362 8.42795   ]
Stock Position:  0.01595362486521458
Bond Position:  [-11.04703196]


portfolio before change:  [-9.52759595]
curr_Stock_Price:  95.58711108112963
curr_Factors:  [9.55871111e+01 4.52781899e-02]
mat_Sqrt:  [[ 2.03396682e+01  0.00000000e+00]
 [-8.51146896e-03  1.95022254e-02]]
grads:  [-1.67817104e-02 -2.78233741e+01]
Stock Position:  -0.01678171043493518
Bond Position:  [-7.92348073]


portfolio before change:  [-9.52404218]
curr_Stock_Price:  95.13921278653686
curr_Factors:  [9.51392128e+01 4.34556468e-02]
mat_Sqrt:  [[ 1.98327375e+01  0.00000000e+00]
 [-8.33840721e-03  1.91056911e-02]]
grads:  [-3.55307480e-03 -4.45914239e+00]
Stock Position:  -0.0035530748048557465
Bond Position:  [-9.18600544]


portfolio before change:  [-9.5356395]
curr_Stock_Price:  97.11022886741883
curr_Factors:  [9.71102289e+01 4.37523763e-02]
mat_Sqrt:  [[ 2.03126133e+01  0.00000000e+00]
 [-8.36682748e-03  1.91708101e-02]]
grads:  [-1.79873703e-03 -5.34330657e+01]
Stock Position:  -0.0017987370282886396
Bond Position:  [-9.36096373]


portfolio before change:  [-9.53772778]
curr_Stock_Price:  95.6684589039711
curr_Factors:  [9.56684589e+01 4.24128968e-02]
mat_Sqrt:  [[ 1.97023371e+01  0.00000000e+00]
 [-8.23775666e-03  1.88750717e-02]]
grads:  [-0.04656516 14.68139595]
Stock Position:  -0.04656515730706456
Bond Position:  [-5.08291094]


portfolio before change:  [-9.47832795]
curr_Stock_Price:  94.33823856661182
curr_Factors:  [9.43382386e+01 4.25011288e-02]
mat_Sqrt:  [[ 1.94485844e+01  0.00000000e+00]
 [-8.24632076e-03  1.88946946e-02]]
grads:  [7.92960572e-04 2.99652256e+00]
Stock Position:  0.0007929605721363985
Bond Position:  [-9.55313446]


portfolio before change:  [-9.48139447]
curr_Stock_Price:  96.4962909348111
curr_Factors:  [9.64962909e+01 4.07266472e-02]
mat_Sqrt:  [[ 1.94737661e+01  0.00000000e+00]
 [-8.07233768e-03  1.84960492e-02]]
grads:  [-4.03798164e-03 -5.12332172e+00]
Stock Position:  -0.00403798164255366
Bond Position:  [-9.09174421]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.49373116]
Stock Price:  98.42539529018579
PL:  [-9.49373116]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.13392489e-01  2.95999689e-01]
 [ 4.05706384e-02  1.65051968e-01]
 [-9.94330274e-02  4.85123698e-03]
 [-1.38751260e-01 -4.54931521e-01]
 [ 9.74041435e-02  3.46591251e-01]
 [ 3.63399435e-01 -7.10631345e-01]
 [-6.53919123e-01  9.16505753e-02]
 [ 5.37472074e-02 -7.45329629e-02]
 [-2.72088612e-02  5.23910740e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.79360844]
curr_Stock_Price:  99.90311054306021
curr_Factors:  [9.99031105e+01 4.00150665e-02]
mat_Sqrt:  [[ 1.99843847e+01  0.00000000e+00]
 [-8.00150651e-03  1.83337546e-02]]
grads:  [-9.21757845e-03  1.61450666e+01]
Stock Position:  -0.009217578450499432
Bond Position:  [2.7144732]


portfolio before change:  [1.77233806]
curr_Stock_Price:  102.35798084051713
curr_Factors:  [1.02357981e+02 3.88098084e-02]
mat_Sqrt:  [[ 2.01647323e+01  0.00000000e+00]
 [-7.88008207e-03  1.80555363e-02]]
grads:  [5.58426572e-03 9.14134953e+00]
Stock Position:  0.0055842657161912545
Bond Position:  [1.2007439]


portfolio before change:  [1.76841395]
curr_Stock_Price:  101.54773397942446
curr_Factors:  [1.01547734e+02 3.77660070e-02]
mat_Sqrt:  [[ 1.97342566e+01  0.00000000e+00]
 [-7.77339123e-03  1.78110769e-02]]
grads:  [-0.00493131  0.27237191]
Stock Position:  -0.004931311876020317
Bond Position:  [2.26917749]


portfolio before change:  [1.75868641]
curr_Stock_Price:  103.75047628759833
curr_Factors:  [1.03750476e+02 3.41329909e-02]
mat_Sqrt:  [[ 1.91680208e+01  0.00000000e+00]
 [-7.39004637e-03  1.69327235e-02]]
grads:  [-1.75969996e-02 -2.68670024e+01]
Stock Position:  -0.01759699955106398
Bond Position:  [3.5843835]


portfolio before change:  [1.77052778]
curr_Stock_Price:  103.17942823122891
curr_Factors:  [1.03179428e+02 3.18408872e-02]
mat_Sqrt:  [[ 1.84113527e+01  0.00000000e+00]
 [-7.13760601e-03  1.63543099e-02]]
grads:  [1.35062845e-02 2.11926552e+01]
Stock Position:  0.01350628446439656
Bond Position:  [0.37695707]


portfolio before change:  [1.73232644]
curr_Stock_Price:  100.33705751970429
curr_Factors:  [1.00337058e+02 3.38533126e-02]
mat_Sqrt:  [[ 1.84612858e+01  0.00000000e+00]
 [-7.35970789e-03  1.68632092e-02]]
grads:  [ 2.88465762e-03 -4.21409315e+01]
Stock Position:  0.0028846576223796635
Bond Position:  [1.44288838]


portfolio before change:  [1.74212799]
curr_Stock_Price:  103.48471749532031
curr_Factors:  [1.03484717e+02 3.37609583e-02]
mat_Sqrt:  [[ 1.90144427e+01  0.00000000e+00]
 [-7.34966212e-03  1.68401915e-02]]
grads:  [-0.03228701  5.44237133]
Stock Position:  -0.032287011660594465
Bond Position:  [5.08334027]


portfolio before change:  [1.72620865]
curr_Stock_Price:  104.05651534844539
curr_Factors:  [1.04056515e+02 2.98100023e-02]
mat_Sqrt:  [[ 1.79659540e+01  0.00000000e+00]
 [-6.90622934e-03  1.58241594e-02]]
grads:  [ 1.18103139e-03 -4.71007409e+00]
Stock Position:  0.0011810313879505182
Bond Position:  [1.60331464]


portfolio before change:  [1.72457369]
curr_Stock_Price:  101.99322239900135
curr_Factors:  [1.01993222e+02 3.04875946e-02]
mat_Sqrt:  [[ 1.78087277e+01  0.00000000e+00]
 [-6.98427888e-03  1.60029933e-02]]
grads:  [-2.43898499e-04  3.27382965e+00]
Stock Position:  -0.00024389849913843877
Bond Position:  [1.74944969]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.72553844]
Stock Price:  101.62503580477235
PL:  [0.10050263]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.08384543e-01  3.26514006e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.50860152e-01  9.44660472e-02]
 [-1.60201217e-01 -4.14688846e-01]
 [ 5.29930392e-02  1.96467306e-01]
 [ 1.97100535e-01 -6.44223903e-01]
 [-5.61247491e-01  5.66353104e-02]
 [ 1.15635086e-01 -1.74281042e-01]
 [-4.05053878e-02  1.88850248e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.18652003]
curr_Stock_Price:  101.01657201578395
curr_Factors:  [1.01016572e+02 3.96115349e-02]
mat_Sqrt:  [[ 2.01049715e+01  0.00000000e+00]
 [-7.96105871e-03  1.82410771e-02]]
grads:  [-3.27690831e-03  1.78999301e+01]
Stock Position:  -0.0032769083101862394
Bond Position:  [9.51754208]


portfolio before change:  [9.19861218]
curr_Stock_Price:  98.77904059215922
curr_Factors:  [9.87790406e+01 4.04841670e-02]
mat_Sqrt:  [[ 1.98750124e+01  0.00000000e+00]
 [-8.04827107e-03  1.84409057e-02]]
grads:  [ 0.00472753 -2.56370341]
Stock Position:  0.004727527677151146
Bond Position:  [8.73163153]


portfolio before change:  [9.20172364]
curr_Stock_Price:  98.51347877465761
curr_Factors:  [9.85134788e+01 4.02886104e-02]
mat_Sqrt:  [[ 1.97736480e+01  0.00000000e+00]
 [-8.02880917e-03  1.83963129e-02]]
grads:  [0.00971437 5.13505331]
Stock Position:  0.009714369071498483
Bond Position:  [8.24472735]


portfolio before change:  [9.21842833]
curr_Stock_Price:  99.80860111935957
curr_Factors:  [9.98086011e+01 4.33362314e-02]
mat_Sqrt:  [[ 2.07775119e+01  0.00000000e+00]
 [-8.32694243e-03  1.90794220e-02]]
grads:  [-1.64209396e-02 -2.17348747e+01]
Stock Position:  -0.016420939555017482
Bond Position:  [10.85737933]


portfolio before change:  [9.19917178]
curr_Stock_Price:  101.31196199757181
curr_Factors:  [1.01311962e+02 4.21676788e-02]
mat_Sqrt:  [[ 2.08041786e+01  0.00000000e+00]
 [-8.21390809e-03  1.88204278e-02]]
grads:  [6.66877573e-03 1.04390457e+01]
Stock Position:  0.006668775733215169
Bond Position:  [8.52354502]


portfolio before change:  [9.22821524]
curr_Stock_Price:  105.02787950607127
curr_Factors:  [1.05027880e+02 3.80214546e-02]
mat_Sqrt:  [[ 2.04794817e+01  0.00000000e+00]
 [-7.79963636e-03  1.78712120e-02]]
grads:  [-4.10468529e-03 -3.60481373e+01]
Stock Position:  -0.004104685286058403
Bond Position:  [9.65932163]


portfolio before change:  [9.23376799]
curr_Stock_Price:  104.85201007085273
curr_Factors:  [1.04852010e+02 3.77762356e-02]
mat_Sqrt:  [[ 2.03791516e+01  0.00000000e+00]
 [-7.77444384e-03  1.78134887e-02]]
grads:  [-0.02632739  3.17934973]
Stock Position:  -0.026327387228938997
Bond Position:  [11.99424746]


portfolio before change:  [9.21639836]
curr_Stock_Price:  105.73961253929428
curr_Factors:  [1.05739613e+02 3.60351458e-02]
mat_Sqrt:  [[ 2.00724718e+01  0.00000000e+00]
 [-7.59317017e-03  1.73981385e-02]]
grads:  [ 1.97148631e-03 -1.00172235e+01]
Stock Position:  0.0019714863054987783
Bond Position:  [9.00793416]


portfolio before change:  [9.22182274]
curr_Stock_Price:  106.205900403731
curr_Factors:  [1.06205900e+02 3.61188893e-02]
mat_Sqrt:  [[ 2.01843997e+01  0.00000000e+00]
 [-7.60198809e-03  1.74183429e-02]]
grads:  [2.07663433e-03 1.08420329e+01]
Stock Position:  0.0020766343323187523
Bond Position:  [9.00127192]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.22643358]
Stock Price:  106.25843121789198
PL:  [2.96800237]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.00841941e+00  1.48421502e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.21302467e-01 -4.95414307e-01]
 [-3.46344266e-02 -9.19869830e-02]
 [ 4.13257568e-01 -1.04639118e+00]
 [-8.59023467e-01  1.75031927e-01]
 [-1.96674711e-02  2.58168600e-02]
 [-2.73425013e-02  6.18529626e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.47487886]
curr_Stock_Price:  96.69982035104394
curr_Factors:  [9.66998204e+01 4.23724124e-02]
mat_Sqrt:  [[ 1.99052329e+01  0.00000000e+00]
 [-8.23382413e-03  1.88660612e-02]]
grads:  [-0.04740678  7.86711654]
Stock Position:  -0.047406778090995326
Bond Position:  [-14.89065193]


portfolio before change:  [-19.37492287]
curr_Stock_Price:  94.4342544637217
curr_Factors:  [9.44342545e+01 4.08544377e-02]
mat_Sqrt:  [[ 1.90875055e+01  0.00000000e+00]
 [-8.08499229e-03  1.85250446e-02]]
grads:  [ 0.00492257 -2.55205933]
Stock Position:  0.004922574669749618
Bond Position:  [-19.83978254]


portfolio before change:  [-19.37787967]
curr_Stock_Price:  95.849279633774
curr_Factors:  [9.58492796e+01 3.73672390e-02]
mat_Sqrt:  [[ 1.85282481e+01  0.00000000e+00]
 [-7.73224304e-03  1.77167945e-02]]
grads:  [ 0.02173795 11.00113763]
Stock Position:  0.021737952708534423
Bond Position:  [-21.46144678]


portfolio before change:  [-19.36485156]
curr_Stock_Price:  96.9423686547977
curr_Factors:  [9.69423687e+01 3.78076275e-02]
mat_Sqrt:  [[ 1.88496521e+01  0.00000000e+00]
 [-7.77767343e-03  1.78208886e-02]]
grads:  [-1.79058475e-02 -2.77996411e+01]
Stock Position:  -0.017905847510343832
Bond Position:  [-17.62901629]


portfolio before change:  [-19.38715046]
curr_Stock_Price:  97.69531746621514
curr_Factors:  [9.76953175e+01 3.95163265e-02]
mat_Sqrt:  [[ 1.94205726e+01  0.00000000e+00]
 [-7.95148555e-03  1.82191422e-02]]
grads:  [-3.85059899e-03 -5.04891954e+00]
Stock Position:  -0.0038505989889596045
Bond Position:  [-19.01096497]


portfolio before change:  [-19.39374485]
curr_Stock_Price:  96.93868981036206
curr_Factors:  [9.69386898e+01 4.09005902e-02]
mat_Sqrt:  [[ 1.96047782e+01  0.00000000e+00]
 [-8.08955773e-03  1.85355053e-02]]
grads:  [-2.21502047e-03 -5.64533400e+01]
Stock Position:  -0.00221502047031652
Bond Position:  [-19.17902367]


portfolio before change:  [-19.410976]
curr_Stock_Price:  100.38752297494784
curr_Factors:  [1.00387523e+02 3.84101181e-02]
mat_Sqrt:  [[ 1.96744481e+01  0.00000000e+00]
 [-7.83939978e-03  1.79623214e-02]]
grads:  [-0.03977917  9.74439344]
Stock Position:  -0.03977917278061257
Bond Position:  [-15.41764337]


portfolio before change:  [-19.47326568]
curr_Stock_Price:  101.7595710568785
curr_Factors:  [1.01759571e+02 3.69113333e-02]
mat_Sqrt:  [[ 1.95503769e+01  0.00000000e+00]
 [-7.68492897e-03  1.76083844e-02]]
grads:  [-4.29662802e-04  1.46616858e+00]
Stock Position:  -0.0004296628017007814
Bond Position:  [-19.42954338]


portfolio before change:  [-19.48318944]
curr_Stock_Price:  102.24030683826174
curr_Factors:  [1.02240307e+02 3.72810045e-02]
mat_Sqrt:  [[ 1.97408545e+01  0.00000000e+00]
 [-7.72331581e-03  1.76963397e-02]]
grads:  [-1.76109542e-05  3.49524047e+00]
Stock Position:  -1.7610954222198466e-05
Bond Position:  [-19.48138889]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.49295288]
Stock Price:  103.39377042702644
PL:  [-22.88672331]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-6.51326958e-01  2.95481795e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.61773797e-01  1.01489925e-01]
 [-1.42219988e-01 -4.35254317e-01]
 [-2.19837872e-02 -2.99789332e-02]
 [ 3.70408584e-01 -7.32679281e-01]
 [-1.00608574e+00  2.41210138e-01]
 [-2.78691864e-02  3.38583683e-02]
 [-3.55366539e-02 -2.03295844e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.69980848]
curr_Stock_Price:  98.62389972058719
curr_Factors:  [9.86238997e+01 3.92610190e-02]
mat_Sqrt:  [[ 1.95417276e+01  0.00000000e+00]
 [-7.92575740e-03  1.81601916e-02]]
grads:  [-0.02673091 16.27085225]
Stock Position:  -0.026730908422447425
Bond Position:  [-4.06350205]


portfolio before change:  [-6.73313009]
curr_Stock_Price:  99.79443056307373
curr_Factors:  [9.97944306e+01 3.83373462e-02]
mat_Sqrt:  [[ 1.95396746e+01  0.00000000e+00]
 [-7.83196999e-03  1.79452977e-02]]
grads:  [ 0.00480866 -2.63450703]
Stock Position:  0.0048086609846974574
Bond Position:  [-7.21300768]


portfolio before change:  [-6.74336967]
curr_Stock_Price:  98.4152170649227
curr_Factors:  [9.84152171e+01 3.55853620e-02]
mat_Sqrt:  [[ 1.85651280e+01  0.00000000e+00]
 [-7.54563312e-03  1.72892175e-02]]
grads:  [0.01109972 5.87012832]
Stock Position:  0.01109971506277809
Bond Position:  [-7.83575054]


portfolio before change:  [-6.74455756]
curr_Stock_Price:  98.66125657868635
curr_Factors:  [9.86612566e+01 3.36950633e-02]
mat_Sqrt:  [[ 1.81104725e+01  0.00000000e+00]
 [-7.34248604e-03  1.68237490e-02]]
grads:  [-1.83419039e-02 -2.58714223e+01]
Stock Position:  -0.018341903878832895
Bond Position:  [-4.93492227]


portfolio before change:  [-6.74471448]
curr_Stock_Price:  98.5352526723802
curr_Factors:  [9.85352527e+01 3.54858109e-02]
mat_Sqrt:  [[ 1.85617535e+01  0.00000000e+00]
 [-7.53507116e-03  1.72650170e-02]]
grads:  [-0.00188924 -1.73639755]
Stock Position:  -0.001889243182076999
Bond Position:  [-6.55855743]


portfolio before change:  [-6.75078443]
curr_Stock_Price:  100.01195654287834
curr_Factors:  [1.00011957e+02 3.63089064e-02]
mat_Sqrt:  [[ 1.90571744e+01  0.00000000e+00]
 [-7.62195843e-03  1.74641007e-02]]
grads:  [ 2.65732630e-03 -4.19534502e+01]
Stock Position:  0.002657326295118615
Bond Position:  [-7.01654884]


portfolio before change:  [-6.7595298]
curr_Stock_Price:  98.04147620337054
curr_Factors:  [9.80414762e+01 3.50270662e-02]
mat_Sqrt:  [[ 1.83489714e+01  0.00000000e+00]
 [-7.48620772e-03  1.71530568e-02]]
grads:  [-0.04909338 14.06222465]
Stock Position:  -0.04909337882348268
Bond Position:  [-1.94634246]


portfolio before change:  [-6.63532595]
curr_Stock_Price:  95.4916973808934
curr_Factors:  [9.54916974e+01 3.47651133e-02]
mat_Sqrt:  [[ 1.78048139e+01  0.00000000e+00]
 [-7.45816206e-03  1.70887961e-02]]
grads:  [-7.35317041e-04  1.98131970e+00]
Stock Position:  -0.0007353170412611776
Bond Position:  [-6.56510928]


portfolio before change:  [-6.63712546]
curr_Stock_Price:  93.47370625591647
curr_Factors:  [9.34737063e+01 3.62657278e-02]
mat_Sqrt:  [[ 1.78007238e+01  0.00000000e+00]
 [-7.61742506e-03  1.74537135e-02]]
grads:  [-6.98074053e-03 -1.16477129e+01]
Stock Position:  -0.006980740526884458
Bond Position:  [-5.98460978]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.61859846]
Stock Price:  90.39093087297347
PL:  [-6.61859846]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.30383877e-01  3.44553802e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.91750880e-02  6.68752089e-03]
 [-1.52423093e-01 -4.32532277e-01]
 [ 5.46722138e-02  2.01687320e-01]
 [ 2.89558840e-01 -6.11329569e-01]
 [-9.51852050e-01  2.20693173e-01]
 [ 3.25378957e-02 -3.97971518e-02]
 [-4.03799225e-02  1.87323493e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.28421105]
curr_Stock_Price:  100.57944934836827
curr_Factors:  [1.00579449e+02 3.95357846e-02]
mat_Sqrt:  [[ 1.99988229e+01  0.00000000e+00]
 [-7.95344299e-03  1.82236273e-02]]
grads:  [-4.00064891e-03  1.89069825e+01]
Stock Position:  -0.0040006489051911
Bond Position:  [6.68659412]


portfolio before change:  [6.2862165]
curr_Stock_Price:  100.9140669877871
curr_Factors:  [1.00914067e+02 4.20489307e-02]
mat_Sqrt:  [[ 2.06932730e+01  0.00000000e+00]
 [-8.20233437e-03  1.87939091e-02]]
grads:  [ 0.00454059 -2.51554973]
Stock Position:  0.004540590125130307
Bond Position:  [5.82800708]


portfolio before change:  [6.29690478]
curr_Stock_Price:  102.62608146134878
curr_Factors:  [1.02626081e+02 4.42682246e-02]
mat_Sqrt:  [[ 2.15925433e+01  0.00000000e+00]
 [-8.41600614e-03  1.92834926e-02]]
grads:  [-0.00445785  0.34680029]
Stock Position:  -0.0044578544230248415
Bond Position:  [6.75439692]


portfolio before change:  [6.30254092]
curr_Stock_Price:  102.11953873839147
curr_Factors:  [1.02119539e+02 4.34250097e-02]
mat_Sqrt:  [[ 2.12803519e+01  0.00000000e+00]
 [-8.33546732e-03  1.90989550e-02]]
grads:  [-1.60333652e-02 -2.26469081e+01]
Stock Position:  -0.01603336521088679
Bond Position:  [7.93986078]


portfolio before change:  [6.31841352]
curr_Stock_Price:  101.37723208298843
curr_Factors:  [1.01377232e+02 3.94056113e-02]
mat_Sqrt:  [[ 2.01242389e+01  0.00000000e+00]
 [-7.94033866e-03  1.81936015e-02]]
grads:  [7.09074155e-03 1.10856182e+01]
Stock Position:  0.007090741549232263
Bond Position:  [5.59957377]


portfolio before change:  [6.33104734]
curr_Stock_Price:  102.76401674138991
curr_Factors:  [1.02764017e+02 3.79034850e-02]
mat_Sqrt:  [[ 2.00069388e+01  0.00000000e+00]
 [-7.78752695e-03  1.78434659e-02]]
grads:  [ 1.13724259e-03 -3.42606965e+01]
Stock Position:  0.0011372425929180399
Bond Position:  [6.21417972]


portfolio before change:  [6.32993331]
curr_Stock_Price:  99.05162044688481
curr_Factors:  [9.90516204e+01 4.03812327e-02]
mat_Sqrt:  [[ 1.99045045e+01  0.00000000e+00]
 [-8.03803287e-03  1.84174470e-02]]
grads:  [-0.04298191 11.98283198]
Stock Position:  -0.042981911573647585
Bond Position:  [10.5873613]


portfolio before change:  [6.14538057]
curr_Stock_Price:  103.46854219052463
curr_Factors:  [1.03468542e+02 3.78907591e-02]
mat_Sqrt:  [[ 2.01407196e+01  0.00000000e+00]
 [-7.78621953e-03  1.78404702e-02]]
grads:  [ 7.53150580e-04 -2.23072326e+00]
Stock Position:  0.0007531505803718627
Bond Position:  [6.06745318]


portfolio before change:  [6.15043795]
curr_Stock_Price:  106.15444992331913
curr_Factors:  [1.06154450e+02 4.14409749e-02]
mat_Sqrt:  [[ 2.16099213e+01  0.00000000e+00]
 [-8.14282260e-03  1.86575505e-02]]
grads:  [1.91461837e-03 1.00400904e+01]
Stock Position:  0.0019146183689613839
Bond Position:  [5.94719269]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.15713393]
Stock Price:  108.09825141566597
PL:  [-1.94111749]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.11003483e-01  2.84953782e-01]
 [-1.08557076e-02  2.30388424e-01]
 [-9.88548639e-02  8.96721227e-03]
 [-1.48217470e-01 -4.41179082e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.51285192e-01 -1.45453968e+00]
 [-8.82463346e-01  3.33381706e-01]
 [ 1.84573130e-01  2.40216892e-02]
 [ 4.57671347e-02 -1.72558492e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.51376126]
curr_Stock_Price:  99.10375678274305
curr_Factors:  [9.91037568e+01 4.07098385e-02]
mat_Sqrt:  [[ 1.99958471e+01  0.00000000e+00]
 [-8.07067170e-03  1.84922320e-02]]
grads:  [-0.01933599 15.40937744]
Stock Position:  -0.01933598784818085
Bond Position:  [-1.59749222]


portfolio before change:  [-3.60089835]
curr_Stock_Price:  103.56891008138138
curr_Factors:  [1.03568910e+02 4.02105703e-02]
mat_Sqrt:  [[ 2.07682318e+01  0.00000000e+00]
 [-8.02102939e-03  1.83784872e-02]]
grads:  [4.31880985e-03 1.25357665e+01]
Stock Position:  0.004318809846619945
Bond Position:  [-4.04819278]


portfolio before change:  [-3.60117821]
curr_Stock_Price:  103.97289737391924
curr_Factors:  [1.03972897e+02 4.05652972e-02]
mat_Sqrt:  [[ 2.09410029e+01  0.00000000e+00]
 [-8.05633139e-03  1.84593742e-02]]
grads:  [-0.00453375  0.48578095]
Stock Position:  -0.0045337490289143415
Bond Position:  [-3.12979119]


portfolio before change:  [-3.59697238]
curr_Stock_Price:  102.6999728970624
curr_Factors:  [1.02699973e+02 4.46183169e-02]
mat_Sqrt:  [[ 2.16933649e+01  0.00000000e+00]
 [-8.44921932e-03  1.93595935e-02]]
grads:  [-1.57082043e-02 -2.27886542e+01]
Stock Position:  -0.015708204285868457
Bond Position:  [-1.98374022]


portfolio before change:  [-3.49361232]
curr_Stock_Price:  96.05680891279036
curr_Factors:  [9.60568089e+01 4.89477376e-02]
mat_Sqrt:  [[ 2.12517387e+01  0.00000000e+00]
 [-8.84965424e-03  2.02771052e-02]]
grads:  [-3.31583222e-03 -4.20153647e+00]
Stock Position:  -0.003315832219208725
Bond Position:  [-3.17510406]


portfolio before change:  [-3.48588523]
curr_Stock_Price:  93.24754862172391
curr_Factors:  [9.32475486e+01 5.19632767e-02]
mat_Sqrt:  [[ 2.12562030e+01  0.00000000e+00]
 [-9.11818199e-03  2.08923796e-02]]
grads:  [-8.63409005e-03 -6.96205848e+01]
Stock Position:  -0.008634090048324456
Bond Position:  [-2.6807775]


portfolio before change:  [-3.47348942]
curr_Stock_Price:  91.65658352258579
curr_Factors:  [9.16565835e+01 5.43853510e-02]
mat_Sqrt:  [[ 2.13749266e+01  0.00000000e+00]
 [-9.32826681e-03  2.13737444e-02]]
grads:  [-0.03447795 15.59772119]
Stock Position:  -0.034477949491214244
Bond Position:  [-0.31335836]


portfolio before change:  [-3.36859428]
curr_Stock_Price:  88.60965474270098
curr_Factors:  [8.86096547e+01 5.23654028e-02]
mat_Sqrt:  [[ 2.02769798e+01  0.00000000e+00]
 [-9.15339524e-03  2.09730633e-02]]
grads:  [0.00961963 1.14535912]
Stock Position:  0.009619630574464412
Bond Position:  [-4.22098642]


portfolio before change:  [-3.35923909]
curr_Stock_Price:  89.80161489788394
curr_Factors:  [8.98016149e+01 4.96051952e-02]
mat_Sqrt:  [[ 2.00008166e+01  0.00000000e+00]
 [-8.90888951e-03  2.04128303e-02]]
grads:  [-1.47711797e-03 -8.45343296e+00]
Stock Position:  -0.0014771179661497852
Bond Position:  [-3.22659151]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.3678896]
Stock Price:  94.56549794191606
PL:  [-3.3678896]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.73133015e-02  2.30211002e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.93417118e-02  5.50131730e-03]
 [-1.35332052e-01 -4.58243464e-01]
 [ 1.08941574e-01  4.00419189e-01]
 [ 3.78714102e-01 -7.58805065e-01]
 [-8.43795387e-01  1.67543828e-01]
 [-7.28513696e-02 -9.55197255e-03]
 [-3.60844420e-02  1.71267339e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.9942184]
curr_Stock_Price:  101.74066925848275
curr_Factors:  [1.01740669e+02 3.85557815e-02]
mat_Sqrt:  [[ 1.99774175e+01  0.00000000e+00]
 [-7.85425047e-03  1.79963487e-02]]
grads:  [2.1603902e-03 1.2792095e+01]
Stock Position:  0.002160390199804455
Bond Position:  [13.77441885]


portfolio before change:  [13.99792]
curr_Stock_Price:  100.26531906835706
curr_Factors:  [1.00265319e+02 3.99551683e-02]
mat_Sqrt:  [[ 2.00418230e+01  0.00000000e+00]
 [-7.99551557e-03  1.83200277e-02]]
grads:  [ 0.00468818 -2.58061908]
Stock Position:  0.004688179866265404
Bond Position:  [13.52785815]


portfolio before change:  [14.01247985]
curr_Stock_Price:  101.92784693188561
curr_Factors:  [1.01927847e+02 4.24624825e-02]
mat_Sqrt:  [[ 2.10036872e+01  0.00000000e+00]
 [-8.24257072e-03  1.88861021e-02]]
grads:  [-0.00461542  0.29128919]
Stock Position:  -0.004615415350382368
Bond Position:  [14.4829192]


portfolio before change:  [14.01004446]
curr_Stock_Price:  104.02487640764546
curr_Factors:  [1.04024876e+02 4.02965803e-02]
mat_Sqrt:  [[ 2.08819622e+01  0.00000000e+00]
 [-8.02960326e-03  1.83981324e-02]]
grads:  [-1.60581603e-02 -2.49070642e+01]
Stock Position:  -0.016058160305996456
Bond Position:  [15.6804926]


portfolio before change:  [14.02180892]
curr_Stock_Price:  103.7806231023074
curr_Factors:  [1.03780623e+02 3.76671677e-02]
mat_Sqrt:  [[ 2.01417758e+01  0.00000000e+00]
 [-7.76321250e-03  1.77877544e-02]]
grads:  [1.40850955e-02 2.25109465e+01]
Stock Position:  0.01408509548219829
Bond Position:  [12.56004894]


portfolio before change:  [13.96997396]
curr_Stock_Price:  99.65452034128924
curr_Factors:  [9.96545203e+01 3.69268742e-02]
mat_Sqrt:  [[ 1.91499779e+01  0.00000000e+00]
 [-7.68654660e-03  1.76120908e-02]]
grads:  [ 2.48274030e-03 -4.30843261e+01]
Stock Position:  0.0024827403012928945
Bond Position:  [13.72255767]


portfolio before change:  [13.97919787]
curr_Stock_Price:  100.60545152344565
curr_Factors:  [1.00605452e+02 3.88063108e-02]
mat_Sqrt:  [[ 1.98185873e+01  0.00000000e+00]
 [-7.87972698e-03  1.80547227e-02]]
grads:  [-0.03888639  9.27977853]
Stock Position:  -0.03888638756574936
Bond Position:  [17.89138045]


portfolio before change:  [14.06038764]
curr_Stock_Price:  98.74768479513739
curr_Factors:  [9.87476848e+01 3.85929469e-02]
mat_Sqrt:  [[ 1.93990692e+01  0.00000000e+00]
 [-7.85803507e-03  1.80050203e-02]]
grads:  [-0.0039703  -0.53051718]
Stock Position:  -0.00397030348433153
Bond Position:  [14.45244591]


portfolio before change:  [14.06877195]
curr_Stock_Price:  98.45645289777401
curr_Factors:  [9.84564529e+01 4.08857147e-02]
mat_Sqrt:  [[ 1.99081077e+01  0.00000000e+00]
 [-8.08808652e-03  1.85321344e-02]]
grads:  [-0.001775    0.09241641]
Stock Position:  -0.001775003958200072
Bond Position:  [14.24353254]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.07548299]
Stock Price:  98.68884694588591
PL:  [14.07548299]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.04080176e-01  3.03632901e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 5.99111019e-02  5.51263518e-02]
 [-1.52917244e-01 -4.12611994e-01]
 [ 3.05726293e-02  1.30257771e-01]
 [ 2.59379325e-01 -6.26128439e-01]
 [-5.20514182e-01  4.12459035e-02]
 [ 1.43282138e-01 -2.18023604e-01]
 [-4.03396825e-02  1.87173588e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.30493977]
curr_Stock_Price:  99.98012319641268
curr_Factors:  [9.99801232e+01 4.14440613e-02]
mat_Sqrt:  [[ 2.03537681e+01  0.00000000e+00]
 [-8.14312582e-03  1.86582452e-02]]
grads:  [-8.42909842e-03  1.62733900e+01]
Stock Position:  -0.008429098415798475
Bond Position:  [3.14768207]


portfolio before change:  [2.31514398]
curr_Stock_Price:  98.95629280268551
curr_Factors:  [9.89562928e+01 4.03893073e-02]
mat_Sqrt:  [[ 1.98873364e+01  0.00000000e+00]
 [-8.03883646e-03  1.84192883e-02]]
grads:  [ 0.0047246  -2.56671225]
Stock Position:  0.004724598068525662
Bond Position:  [1.84761527]


portfolio before change:  [2.32121855]
curr_Stock_Price:  100.04644695553048
curr_Factors:  [1.00046447e+02 3.48144497e-02]
mat_Sqrt:  [[ 1.86672970e+01  0.00000000e+00]
 [-7.46345225e-03  1.71009174e-02]]
grads:  [0.00449825 3.22359031]
Stock Position:  0.004498252442741542
Bond Position:  [1.87118438]


portfolio before change:  [2.31947776]
curr_Stock_Price:  99.45141066536266
curr_Factors:  [9.94514107e+01 3.40254575e-02]
mat_Sqrt:  [[ 1.83447980e+01  0.00000000e+00]
 [-7.37839631e-03  1.69060298e-02]]
grads:  [-1.81520604e-02 -2.44062030e+01]
Stock Position:  -0.018152060391399646
Bond Position:  [4.12472577]


portfolio before change:  [2.30469567]
curr_Stock_Price:  100.37940287483927
curr_Factors:  [1.00379403e+02 3.51018918e-02]
mat_Sqrt:  [[ 1.88065819e+01  0.00000000e+00]
 [-7.49419955e-03  1.71713684e-02]]
grads:  [4.64846731e-03 7.58575369e+00]
Stock Position:  0.004648467311932361
Bond Position:  [1.83808529]


portfolio before change:  [2.3203889]
curr_Stock_Price:  103.5576463840639
curr_Factors:  [1.03557646e+02 3.40974289e-02]
mat_Sqrt:  [[ 1.91224259e+01  0.00000000e+00]
 [-7.38619565e-03  1.69239003e-02]]
grads:  [-7.26138485e-04 -3.69966986e+01]
Stock Position:  -0.0007261384846523297
Bond Position:  [2.39558609]


portfolio before change:  [2.32019958]
curr_Stock_Price:  105.4683104199516
curr_Factors:  [1.05468310e+02 3.32462814e-02]
mat_Sqrt:  [[ 1.92306307e+01  0.00000000e+00]
 [-7.29342513e-03  1.67113364e-02]]
grads:  [-0.02613086  2.46813915]
Stock Position:  -0.02613086399919409
Bond Position:  [5.07617766]


portfolio before change:  [2.29608189]
curr_Stock_Price:  106.48842297257558
curr_Factors:  [1.06488423e+02 3.56879788e-02]
mat_Sqrt:  [[ 2.01170072e+01  0.00000000e+00]
 [-7.55650488e-03  1.73141278e-02]]
grads:  [ 2.39244517e-03 -1.25922372e+01]
Stock Position:  0.002392445166174768
Bond Position:  [2.04131417]


portfolio before change:  [2.29629928]
curr_Stock_Price:  106.1525646068652
curr_Factors:  [1.06152565e+02 3.74916935e-02]
mat_Sqrt:  [[ 2.05540789e+01  0.00000000e+00]
 [-7.74510876e-03  1.77462736e-02]]
grads:  [2.01174515e-03 1.05472052e+01]
Stock Position:  0.0020117451517972745
Bond Position:  [2.08274737]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.30334195]
Stock Price:  109.13556783924818
PL:  [-6.83222589]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.91705004e-01 -1.23435261e-01]
 [-6.27669668e-02  2.35246981e-01]
 [-9.89939592e-02  7.97698627e-03]
 [-1.56662645e-01 -4.23449342e-01]
 [ 4.35669431e-02  1.68034094e-01]
 [ 3.28423357e-01 -6.06869934e-01]
 [-8.83826511e-01  1.87212705e-01]
 [-1.24318338e-02  3.27146097e-02]
 [-3.77085671e-02  1.62456223e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [36.36936004]
curr_Stock_Price:  105.11063491512469
curr_Factors:  [1.05110635e+02 3.53645348e-02]
mat_Sqrt:  [[ 1.97665390e+01  0.00000000e+00]
 [-7.52218423e-03  1.72354893e-02]]
grads:  [ 0.01709118 -7.16169171]
Stock Position:  0.017091178119113544
Bond Position:  [34.57289546]


portfolio before change:  [36.3866776]
curr_Stock_Price:  105.11220227050511
curr_Factors:  [1.05112202e+02 3.49176663e-02]
mat_Sqrt:  [[ 1.96415493e+01  0.00000000e+00]
 [-7.47450775e-03  1.71262488e-02]]
grads:  [2.03157258e-03 1.37360483e+01]
Stock Position:  0.002031572581608442
Bond Position:  [36.17313453]


portfolio before change:  [36.40127997]
curr_Stock_Price:  103.39495195813866
curr_Factors:  [1.03394952e+02 3.18718209e-02]
mat_Sqrt:  [[ 1.84587707e+01  0.00000000e+00]
 [-7.14107229e-03  1.63622522e-02]]
grads:  [-0.00517437  0.48752373]
Stock Position:  -0.005174370423359051
Bond Position:  [36.93628375]


portfolio before change:  [36.42934358]
curr_Stock_Price:  101.54142249044588
curr_Factors:  [1.01541422e+02 3.09173715e-02]
mat_Sqrt:  [[ 1.78543698e+01  0.00000000e+00]
 [-7.03333451e-03  1.61153939e-02]]
grads:  [-1.91253510e-02 -2.62760777e+01]
Stock Position:  -0.01912535097181201
Bond Position:  [38.37135892]


portfolio before change:  [36.46035728]
curr_Stock_Price:  100.92322628164246
curr_Factors:  [1.00923226e+02 3.14101506e-02]
mat_Sqrt:  [[ 1.78865316e+01  0.00000000e+00]
 [-7.08916363e-03  1.62433145e-02]]
grads:  [6.53581346e-03 1.03448157e+01]
Stock Position:  0.006535813461070471
Bond Position:  [35.80074189]


portfolio before change:  [36.48425462]
curr_Stock_Price:  101.84009654607485
curr_Factors:  [1.01840097e+02 2.89665291e-02]
mat_Sqrt:  [[ 1.73327324e+01  0.00000000e+00]
 [-6.80782245e-03  1.55986808e-02]]
grads:  [ 3.66725815e-03 -3.89052087e+01]
Stock Position:  0.003667258145521968
Bond Position:  [36.11078069]


portfolio before change:  [36.49571486]
curr_Stock_Price:  100.04047930796641
curr_Factors:  [1.00040479e+02 3.30977545e-02]
mat_Sqrt:  [[ 1.82001526e+01  0.00000000e+00]
 [-7.27711530e-03  1.66739659e-02]]
grads:  [-0.04407217 11.22784507]
Stock Position:  -0.04407216829610624
Bond Position:  [40.9047157]


portfolio before change:  [36.42089581]
curr_Stock_Price:  102.20230901238043
curr_Factors:  [1.02202309e+02 3.14034061e-02]
mat_Sqrt:  [[ 1.81112775e+01  0.00000000e+00]
 [-7.08840248e-03  1.62415705e-02]]
grads:  [1.01925026e-04 2.01425162e+00]
Stock Position:  0.00010192502611094111
Bond Position:  [36.41047884]


portfolio before change:  [36.43943026]
curr_Stock_Price:  105.3876384134029
curr_Factors:  [1.05387638e+02 2.75745907e-02]
mat_Sqrt:  [[ 1.75002483e+01  0.00000000e+00]
 [-6.64223946e-03  1.52192826e-02]]
grads:  [1.89672402e-03 1.06743680e+01]
Stock Position:  0.0018967240222184207
Bond Position:  [36.239539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.45712294]
Stock Price:  105.1600747149401
PL:  [31.29704822]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.16880574e-01  2.93134205e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-4.33442605e-02 -5.48600476e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.67243458e-01 -1.60360386e+00]
 [-9.32160679e-01  3.16302123e-01]
 [ 1.90391717e-02  1.07266066e-01]
 [-2.64106522e-02 -2.07200038e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.5954553]
curr_Stock_Price:  99.8732662943177
curr_Factors:  [9.98732663e+01 3.90812789e-02]
mat_Sqrt:  [[ 1.97439316e+01  0.00000000e+00]
 [-7.90759421e-03  1.81185745e-02]]
grads:  [-9.56984267e-03  1.61786571e+01]
Stock Position:  -0.009569842666161184
Bond Position:  [2.55122674]


portfolio before change:  [1.61938088]
curr_Stock_Price:  97.50649308046235
curr_Factors:  [9.75064931e+01 4.40660426e-02]
mat_Sqrt:  [[ 2.04684785e+01  0.00000000e+00]
 [-8.39676534e-03  1.92394064e-02]]
grads:  [ 0.00459046 -2.45730102]
Stock Position:  0.004590457022750431
Bond Position:  [1.17178151]


portfolio before change:  [1.60499974]
curr_Stock_Price:  94.24599532611704
curr_Factors:  [9.42459953e+01 4.58895934e-02]
mat_Sqrt:  [[ 2.01892418e+01  0.00000000e+00]
 [-8.56874258e-03  1.96334557e-02]]
grads:  [0.01994954 9.92718232]
Stock Position:  0.019949544656660066
Bond Position:  [-0.27516495]


portfolio before change:  [1.60665515]
curr_Stock_Price:  94.33587327107338
curr_Factors:  [9.43358733e+01 4.47590162e-02]
mat_Sqrt:  [[ 1.99580056e+01  0.00000000e+00]
 [-8.46253070e-03  1.93900938e-02]]
grads:  [-1.41684066e-02 -2.82928223e+01]
Stock Position:  -0.01416840657139539
Bond Position:  [2.94324415]


portfolio before change:  [1.65222133]
curr_Stock_Price:  91.22372455441004
curr_Factors:  [9.12237246e+01 4.56500590e-02]
mat_Sqrt:  [[ 1.94907464e+01  0.00000000e+00]
 [-8.54634977e-03  1.95821474e-02]]
grads:  [-3.61541822e-03 -4.35064630e+00]
Stock Position:  -0.0036154182170006315
Bond Position:  [1.98203324]


portfolio before change:  [1.65046246]
curr_Stock_Price:  91.98439139663385
curr_Factors:  [9.19843914e+01 4.54471254e-02]
mat_Sqrt:  [[ 1.96095374e+01  0.00000000e+00]
 [-8.52733256e-03  1.95385735e-02]]
grads:  [-1.18629338e-02 -8.20737431e+01]
Stock Position:  -0.011862933814488294
Bond Position:  [2.74166721]


portfolio before change:  [1.64281867]
curr_Stock_Price:  92.74431895144184
curr_Factors:  [9.27443190e+01 4.59371473e-02]
mat_Sqrt:  [[ 1.98778463e+01  0.00000000e+00]
 [-8.57318119e-03  1.96436259e-02]]
grads:  [-0.03994976 16.10202339]
Stock Position:  -0.03994975635355122
Bond Position:  [5.34793161]


portfolio before change:  [1.65161597]
curr_Stock_Price:  92.5910596702587
curr_Factors:  [9.25910597e+01 4.83728014e-02]
mat_Sqrt:  [[ 2.03643088e+01  0.00000000e+00]
 [-8.79752706e-03  2.01576668e-02]]
grads:  [3.23379112e-03 5.32135327e+00]
Stock Position:  0.003233791120082591
Bond Position:  [1.35219583]


portfolio before change:  [1.6575532]
curr_Stock_Price:  94.21793068038025
curr_Factors:  [9.42179307e+01 5.19039772e-02]
mat_Sqrt:  [[ 2.14651477e+01  0.00000000e+00]
 [-9.11297776e-03  2.08804552e-02]]
grads:  [-5.44324988e-03 -9.92315714e+00]
Stock Position:  -0.005443249881868728
Bond Position:  [2.17040494]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.65503714]
Stock Price:  94.87958251662977
PL:  [1.65503714]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 4.27126174e-01 -2.60402170e-01]
 [-7.25175825e-02  2.37014481e-01]
 [-9.86433457e-02  1.04730216e-02]
 [-1.57645902e-01 -4.21731664e-01]
 [-3.36432035e-02 -8.69977188e-02]
 [ 4.15324358e-01 -1.07869668e+00]
 [-1.06585129e+00  2.61836216e-01]
 [-1.68331219e-02  4.44357389e-02]
 [-2.95345141e-02 -1.73493959e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.57472386]
curr_Stock_Price:  103.78605684667302
curr_Factors:  [1.03786057e+02 3.81359743e-02]
mat_Sqrt:  [[ 2.02677918e+01  0.00000000e+00]
 [-7.81137369e-03  1.78981056e-02]]
grads:  [  0.01546677 -14.54914703]
Stock Position:  0.015466773712411482
Bond Position:  [25.9694884]


portfolio before change:  [27.61177455]
curr_Stock_Price:  105.34182426876536
curr_Factors:  [1.05341824e+02 3.84609069e-02]
mat_Sqrt:  [[ 2.06590618e+01  0.00000000e+00]
 [-7.84458100e-03  1.79741931e-02]]
grads:  [1.49687425e-03 1.31863767e+01]
Stock Position:  0.0014968742528377228
Bond Position:  [27.45409109]


portfolio before change:  [27.62478496]
curr_Stock_Price:  104.86077452875953
curr_Factors:  [1.04860775e+02 4.06522145e-02]
mat_Sqrt:  [[ 2.11424429e+01  0.00000000e+00]
 [-8.06495773e-03  1.84791396e-02]]
grads:  [-0.00444946  0.56674833]
Stock Position:  -0.004449464282839173
Bond Position:  [28.09135923]


portfolio before change:  [27.65423313]
curr_Stock_Price:  101.39991230239495
curr_Factors:  [1.01399912e+02 4.00157413e-02]
mat_Sqrt:  [[ 2.02839725e+01  0.00000000e+00]
 [-8.00157398e-03  1.83339092e-02]]
grads:  [-1.68460438e-02 -2.30028227e+01]
Stock Position:  -0.01684604381422813
Bond Position:  [29.3624205]


portfolio before change:  [27.74150592]
curr_Stock_Price:  97.09101331493872
curr_Factors:  [9.70910133e+01 4.47618475e-02]
mat_Sqrt:  [[ 2.05415417e+01  0.00000000e+00]
 [-8.46279836e-03  1.93907070e-02]]
grads:  [-3.48620965e-03 -4.48656764e+00]
Stock Position:  -0.003486209646495663
Bond Position:  [28.07998554]


portfolio before change:  [27.75723388]
curr_Stock_Price:  96.60783415904295
curr_Factors:  [9.66078342e+01 4.65864907e-02]
mat_Sqrt:  [[ 2.08517421e+01  0.00000000e+00]
 [-8.63356156e-03  1.97819747e-02]]
grads:  [-2.65960848e-03 -5.45292722e+01]
Stock Position:  -0.002659608478586888
Bond Position:  [28.0141729]


portfolio before change:  [27.77068345]
curr_Stock_Price:  96.81877585317595
curr_Factors:  [9.68187759e+01 4.65037265e-02]
mat_Sqrt:  [[ 2.08787005e+01  0.00000000e+00]
 [-8.62588907e-03  1.97643948e-02]]
grads:  [-0.04557643 13.24787421]
Stock Position:  -0.04557642806809394
Bond Position:  [32.18333742]


portfolio before change:  [27.87138658]
curr_Stock_Price:  94.96238991320698
curr_Factors:  [9.49623899e+01 4.96242390e-02]
mat_Sqrt:  [[ 2.11542955e+01  0.00000000e+00]
 [-8.91059944e-03  2.04167482e-02]]
grads:  [1.21026224e-04 2.17643566e+00]
Stock Position:  0.00012102622400266322
Bond Position:  [27.85989364]


portfolio before change:  [27.88535785]
curr_Stock_Price:  95.27506592040874
curr_Factors:  [9.52750659e+01 4.77891049e-02]
mat_Sqrt:  [[ 2.08278147e+01  0.00000000e+00]
 [-8.74428773e-03  2.00356802e-02]]
grads:  [-5.05350594e-03 -8.65924978e+00]
Stock Position:  -0.0050535059447115605
Bond Position:  [28.36683097]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.90210845]
Stock Price:  94.76776824355983
PL:  [27.90210845]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.14442093e-01 -2.44323211e-01]
 [-1.63338593e-02  2.30273285e-01]
 [-9.90621159e-02  7.49177502e-03]
 [-1.25444385e-01 -4.67165236e-01]
 [ 1.01126711e-01  3.63958909e-01]
 [ 2.78845649e-01 -6.12287125e-01]
 [-7.80050251e-01  1.39305567e-01]
 [-6.39322028e-02 -3.63298362e-03]
 [-3.83087068e-02 -7.11643426e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.696206]
curr_Stock_Price:  102.59945722548483
curr_Factors:  [1.02599457e+02 3.88894939e-02]
mat_Sqrt:  [[ 2.02330432e+01  0.00000000e+00]
 [-7.88816774e-03  1.80740629e-02]]
grads:  [ 1.02708574e-02 -1.35178910e+01]
Stock Position:  0.010270857380785533
Bond Position:  [18.64242161]


portfolio before change:  [19.71763371]
curr_Stock_Price:  103.77795349240934
curr_Factors:  [1.03777953e+02 4.08580221e-02]
mat_Sqrt:  [[ 2.09770190e+01  0.00000000e+00]
 [-8.08534695e-03  1.85258572e-02]]
grads:  [4.01227847e-03 1.24298316e+01]
Stock Position:  0.004012278467751655
Bond Position:  [19.30124766]


portfolio before change:  [19.72457597]
curr_Stock_Price:  103.10233279226077
curr_Factors:  [1.03102333e+02 4.13484602e-02]
mat_Sqrt:  [[ 2.09651591e+01  0.00000000e+00]
 [-8.13372832e-03  1.86367129e-02]]
grads:  [-0.00456913  0.40199015]
Stock Position:  -0.0045691252216689335
Bond Position:  [20.19566344]


portfolio before change:  [19.72684143]
curr_Stock_Price:  104.817079697893
curr_Factors:  [1.04817080e+02 4.40666739e-02]
mat_Sqrt:  [[ 2.20032682e+01  0.00000000e+00]
 [-8.39682549e-03  1.92395442e-02]]
grads:  [-1.49674133e-02 -2.42815127e+01]
Stock Position:  -0.014967413346493406
Bond Position:  [21.29568199]


portfolio before change:  [19.75896983]
curr_Stock_Price:  103.38210285116959
curr_Factors:  [1.03382103e+02 4.40987607e-02]
mat_Sqrt:  [[ 2.17099365e+01  0.00000000e+00]
 [-8.39988197e-03  1.92465475e-02]]
grads:  [1.19747656e-02 1.89103479e+01]
Stock Position:  0.011974765620366203
Bond Position:  [18.52099338]


portfolio before change:  [19.76385911]
curr_Stock_Price:  103.01687354334724
curr_Factors:  [1.03016874e+02 4.06246208e-02]
mat_Sqrt:  [[ 2.07636178e+01  0.00000000e+00]
 [-8.06222012e-03  1.84728670e-02]]
grads:  [ 5.59711706e-04 -3.31452137e+01]
Stock Position:  0.0005597117055995383
Bond Position:  [19.70619936]


portfolio before change:  [19.77291801]
curr_Stock_Price:  101.5935284941406
curr_Factors:  [1.01593528e+02 4.07215293e-02]
mat_Sqrt:  [[ 2.05011434e+01  0.00000000e+00]
 [-8.07183046e-03  1.84948870e-02]]
grads:  [-0.03508352  7.53211234]
Stock Position:  -0.03508352202473987
Bond Position:  [23.3371768]


portfolio before change:  [19.85687711]
curr_Stock_Price:  99.53308545742034
curr_Factors:  [9.95330855e+01 4.36652420e-02]
mat_Sqrt:  [[ 2.07986623e+01  0.00000000e+00]
 [-8.35849192e-03  1.91517110e-02]]
grads:  [-0.0031501  -0.18969499]
Stock Position:  -0.003150095230541869
Bond Position:  [20.17041581]


portfolio before change:  [19.8729771]
curr_Stock_Price:  97.62448870515726
curr_Factors:  [9.76244887e+01 4.55615484e-02]
mat_Sqrt:  [[ 2.08380948e+01  0.00000000e+00]
 [-8.53806052e-03  1.95631543e-02]]
grads:  [-0.00198745 -0.36376722]
Stock Position:  -0.0019874452879447644
Bond Position:  [20.06700043]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.88267987]
Stock Price:  97.79216238286693
PL:  [19.88267987]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.54933177e-01  3.43775226e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-5.82000206e-02  1.49511875e-02]
 [-1.54208505e-01 -4.12929168e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.26201651e-01 -1.17969486e+00]
 [-9.81277225e-01  2.32733685e-01]
 [-2.43342585e-02  3.70758751e-02]
 [-3.69814065e-02 -2.56223567e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.85401213]
curr_Stock_Price:  100.36404417565059
curr_Factors:  [1.00364044e+02 3.99899815e-02]
mat_Sqrt:  [[ 2.00702949e+01  0.00000000e+00]
 [-7.99899809e-03  1.83280071e-02]]
grads:  [-5.22649860e-03  1.87568252e+01]
Stock Position:  -0.005226498603676911
Bond Position:  [5.37856467]


portfolio before change:  [4.8671953]
curr_Stock_Price:  98.35634802133276
curr_Factors:  [9.83563480e+01 4.28178854e-02]
mat_Sqrt:  [[ 2.03523706e+01  0.00000000e+00]
 [-8.27699321e-03  1.89649740e-02]]
grads:  [ 0.00461665 -2.49285936]
Stock Position:  0.00461664504500747
Bond Position:  [4.41311896]


portfolio before change:  [4.88207327]
curr_Stock_Price:  101.10095003994641
curr_Factors:  [1.01100950e+02 4.15014063e-02]
mat_Sqrt:  [[ 2.05961783e+01  0.00000000e+00]
 [-8.14875757e-03  1.86711492e-02]]
grads:  [-0.00250895  0.80076418]
Stock Position:  -0.0025089502834206804
Bond Position:  [5.13573053]


portfolio before change:  [4.8885742]
curr_Stock_Price:  99.53359328577267
curr_Factors:  [9.95335933e+01 4.23111963e-02]
mat_Sqrt:  [[ 2.04737471e+01  0.00000000e+00]
 [-8.22787421e-03  1.88524282e-02]]
grads:  [-1.63343606e-02 -2.19032352e+01]
Stock Position:  -0.016334360593986158
Bond Position:  [6.5143918]


portfolio before change:  [4.957953]
curr_Stock_Price:  95.48563589465952
curr_Factors:  [9.54856359e+01 4.13405507e-02]
mat_Sqrt:  [[ 1.94144984e+01  0.00000000e+00]
 [-8.13295034e-03  1.86349303e-02]]
grads:  [-3.62961733e-03 -4.57179050e+00]
Stock Position:  -0.003629617332064144
Bond Position:  [5.30452932]


portfolio before change:  [4.95962954]
curr_Stock_Price:  95.75464277207122
curr_Factors:  [9.57546428e+01 4.18409996e-02]
mat_Sqrt:  [[ 1.95866817e+01  0.00000000e+00]
 [-8.18202905e-03  1.87473837e-02]]
grads:  [-4.52651428e-03 -6.29258394e+01]
Stock Position:  -0.004526514278950953
Bond Position:  [5.3930643]


portfolio before change:  [4.94972404]
curr_Stock_Price:  98.53883868230461
curr_Factors:  [9.85388387e+01 3.76681289e-02]
mat_Sqrt:  [[ 1.91246926e+01  0.00000000e+00]
 [-7.76331155e-03  1.77879814e-02]]
grads:  [-0.04599833 13.08376028]
Stock Position:  -0.045998329754145695
Bond Position:  [9.48234604]


portfolio before change:  [5.10608564]
curr_Stock_Price:  95.24264861874292
curr_Factors:  [9.52426486e+01 3.49756890e-02]
mat_Sqrt:  [[ 1.78120786e+01  0.00000000e+00]
 [-7.48071537e-03  1.71404722e-02]]
grads:  [-4.57724235e-04  2.16306031e+00]
Stock Position:  -0.00045772423498386
Bond Position:  [5.14968051]


portfolio before change:  [5.10766999]
curr_Stock_Price:  97.40800121829635
curr_Factors:  [9.74080012e+01 3.46826644e-02]
mat_Sqrt:  [[ 1.81405671e+01  0.00000000e+00]
 [-7.44931293e-03  1.70685202e-02]]
grads:  [-0.00265504 -1.50114693]
Stock Position:  -0.002655039370797787
Bond Position:  [5.36629207]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.10153026]
Stock Price:  100.73132232180046
PL:  [4.37020793]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.43571264e-01  2.72783288e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 6.22969179e-02  5.47896063e-02]
 [-1.16082468e-01 -5.10530247e-01]
 [-3.43408016e-02 -9.05090384e-02]
 [ 3.91069823e-01 -8.11566305e-01]
 [-1.01810143e+00  2.45336906e-01]
 [-9.09925011e-03  5.83502034e-02]
 [-2.43074900e-02 -2.08099792e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.23807675]
curr_Stock_Price:  99.66882874595943
curr_Factors:  [9.96688287e+01 3.85366125e-02]
mat_Sqrt:  [[ 1.95657330e+01  0.00000000e+00]
 [-7.85229775e-03  1.79918744e-02]]
grads:  [-1.14751068e-02  1.51614713e+01]
Stock Position:  -0.011475106830122048
Bond Position:  [1.3817872]


portfolio before change:  [0.24337275]
curr_Stock_Price:  99.2675303757773
curr_Factors:  [9.92675304e+01 4.00841049e-02]
mat_Sqrt:  [[ 1.98743673e+01  0.00000000e+00]
 [-8.00840608e-03  1.83495635e-02]]
grads:  [ 0.00472768 -2.57646526]
Stock Position:  0.004727681110346871
Bond Position:  [-0.22593247]


portfolio before change:  [0.24651205]
curr_Stock_Price:  99.95545535122065
curr_Factors:  [9.99554554e+01 3.65989014e-02]
mat_Sqrt:  [[ 1.91223176e+01  0.00000000e+00]
 [-7.65233574e-03  1.75337039e-02]]
grads:  [0.0045083  3.12481645]
Stock Position:  0.00450829571554189
Bond Position:  [-0.2041167]


portfolio before change:  [0.23088182]
curr_Stock_Price:  96.51110617990676
curr_Factors:  [9.65111062e+01 3.84341292e-02]
mat_Sqrt:  [[ 1.89206397e+01  0.00000000e+00]
 [-7.84184970e-03  1.79679349e-02]]
grads:  [-1.79114522e-02 -2.84134070e+01]
Stock Position:  -0.017911452224610293
Bond Position:  [1.95953589]


portfolio before change:  [0.21387527]
curr_Stock_Price:  97.51529969734771
curr_Factors:  [9.75152997e+01 3.91869560e-02]
mat_Sqrt:  [[ 1.93038318e+01  0.00000000e+00]
 [-7.91827820e-03  1.81430546e-02]]
grads:  [-3.82526046e-03 -4.98863286e+00]
Stock Position:  -0.00382526045763964
Bond Position:  [0.58689669]


portfolio before change:  [0.20829937]
curr_Stock_Price:  99.04968489681514
curr_Factors:  [9.90496849e+01 3.61110508e-02]
mat_Sqrt:  [[ 1.88223204e+01  0.00000000e+00]
 [-7.60116316e-03  1.74164528e-02]]
grads:  [ 1.95901717e-03 -4.65976807e+01]
Stock Position:  0.0019590171713449287
Bond Position:  [0.01425933]


portfolio before change:  [0.20585452]
curr_Stock_Price:  97.79804516204283
curr_Factors:  [9.77980452e+01 3.55959406e-02]
mat_Sqrt:  [[ 1.84514462e+01  0.00000000e+00]
 [-7.54675460e-03  1.72917871e-02]]
grads:  [-0.04937432 14.18805963]
Stock Position:  -0.04937432073605789
Bond Position:  [5.03456657]


portfolio before change:  [0.38540216]
curr_Stock_Price:  94.2125834673828
curr_Factors:  [9.42125835e+01 3.53424616e-02]
mat_Sqrt:  [[ 1.77115802e+01  0.00000000e+00]
 [-7.51983634e-03  1.72301096e-02]]
grads:  [9.24077144e-04 3.38652537e+00]
Stock Position:  0.0009240771440605794
Bond Position:  [0.29834247]


portfolio before change:  [0.38573189]
curr_Stock_Price:  94.40793255774364
curr_Factors:  [9.44079326e+01 3.38077163e-02]
mat_Sqrt:  [[ 1.73586683e+01  0.00000000e+00]
 [-7.35474990e-03  1.68518491e-02]]
grads:  [-6.63240307e-03 -1.23487809e+01]
Stock Position:  -0.0066324030712284175
Bond Position:  [1.01188335]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.391823]
Stock Price:  93.56584807857962
PL:  [0.391823]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.83256101e-01  1.83949909e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.05124419e-02  3.92210906e-02]
 [-1.48860388e-01 -4.14362217e-01]
 [ 1.61829772e-02  8.70973314e-02]
 [ 3.15366296e-01 -6.03094723e-01]
 [-7.25290817e-01  1.18616269e-01]
 [ 1.80524578e-02 -1.61458223e-02]
 [-3.10081569e-02  9.69864739e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.86467139]
curr_Stock_Price:  96.94233697709592
curr_Factors:  [9.69423370e+01 4.07020162e-02]
mat_Sqrt:  [[ 1.95578651e+01  0.00000000e+00]
 [-8.06989628e-03  1.84904553e-02]]
grads:  [-0.04616934  9.94837102]
Stock Position:  -0.046169342799413995
Bond Position:  [-13.38890741]


portfolio before change:  [-17.93921293]
curr_Stock_Price:  98.41182750973788
curr_Factors:  [9.84118275e+01 3.83807909e-02]
mat_Sqrt:  [[ 1.92798769e+01  0.00000000e+00]
 [-7.83640641e-03  1.79554628e-02]]
grads:  [ 0.00487346 -2.63301556]
Stock Position:  0.004873458038203479
Bond Position:  [-18.41881885]


portfolio before change:  [-17.93779031]
curr_Stock_Price:  100.59392066881139
curr_Factors:  [1.00593921e+02 3.93471614e-02]
mat_Sqrt:  [[ 1.99539297e+01  0.00000000e+00]
 [-7.93444757e-03  1.81801033e-02]]
grads:  [1.38468610e-03 2.15736346e+00]
Stock Position:  0.0013846861001378897
Bond Position:  [-18.07708131]


portfolio before change:  [-17.94869587]
curr_Stock_Price:  99.24721559162063
curr_Factors:  [9.92472156e+01 3.93578801e-02]
mat_Sqrt:  [[ 1.96894770e+01  0.00000000e+00]
 [-7.93552822e-03  1.81825794e-02]]
grads:  [-1.67451317e-02 -2.27889678e+01]
Stock Position:  -0.016745131692373145
Bond Position:  [-16.28678818]


portfolio before change:  [-17.96682612]
curr_Stock_Price:  99.84349762403562
curr_Factors:  [9.98434976e+01 3.74814967e-02]
mat_Sqrt:  [[ 1.93298395e+01  0.00000000e+00]
 [-7.74405544e-03  1.77438601e-02]]
grads:  [2.80371541e-03 4.90858983e+00]
Stock Position:  0.0028037154111588036
Bond Position:  [-18.24675888]


portfolio before change:  [-17.96958296]
curr_Stock_Price:  102.11506226565055
curr_Factors:  [1.02115062e+02 3.69680624e-02]
mat_Sqrt:  [[ 1.96337452e+01  0.00000000e+00]
 [-7.69083219e-03  1.76219103e-02]]
grads:  [ 2.65635415e-03 -3.42241398e+01]
Stock Position:  0.0026563541454359906
Bond Position:  [-18.24083673]


portfolio before change:  [-17.97791101]
curr_Stock_Price:  102.41421491768314
curr_Factors:  [1.02414215e+02 3.78506211e-02]
mat_Sqrt:  [[ 1.99249273e+01  0.00000000e+00]
 [-7.78209444e-03  1.78310184e-02]]
grads:  [-0.03380301  6.65224307]
Stock Position:  -0.033803005774493806
Bond Position:  [-14.51600271]


portfolio before change:  [-18.00731131]
curr_Stock_Price:  103.0692007842069
curr_Factors:  [1.03069201e+02 4.10329933e-02]
mat_Sqrt:  [[ 2.08783180e+01  0.00000000e+00]
 [-8.10264089e-03  1.85654826e-02]]
grads:  [ 5.27142239e-04 -8.69668872e-01]
Stock Position:  0.0005271422385814853
Bond Position:  [-18.06164344]


portfolio before change:  [-18.01620635]
curr_Stock_Price:  103.33107834109329
curr_Factors:  [1.03331078e+02 4.43442136e-02]
mat_Sqrt:  [[ 2.17595265e+01  0.00000000e+00]
 [-8.42322633e-03  1.93000361e-02]]
grads:  [5.20241584e-04 5.02519650e+00]
Stock Position:  0.0005202415837467533
Bond Position:  [-18.06996347]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.02513341]
Stock Price:  103.54286293343597
PL:  [-21.56799634]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.91518037e-01  2.83450618e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-6.84400160e-02  1.11586801e-02]
 [-1.54184097e-01 -4.12899624e-01]
 [-2.95892133e-02 -5.94418683e-02]
 [ 4.22233355e-01 -1.14749448e+00]
 [-9.78656298e-01  2.31922052e-01]
 [-3.38446485e-02  2.87551129e-02]
 [-3.72767791e-02 -4.14016443e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.06610631]
curr_Stock_Price:  99.17117900667283
curr_Factors:  [9.91711790e+01 4.13221052e-02]
mat_Sqrt:  [[ 2.01593579e+01  0.00000000e+00]
 [-8.13113573e-03  1.86307725e-02]]
grads:  [-0.01824513 15.21410977]
Stock Position:  -0.018245126997339926
Bond Position:  [-1.25671555]


portfolio before change:  [-3.08993421]
curr_Stock_Price:  100.44271776429487
curr_Factors:  [1.00442718e+02 4.00684671e-02]
mat_Sqrt:  [[ 2.01057288e+01  0.00000000e+00]
 [-8.00684379e-03  1.83459839e-02]]
grads:  [ 0.00467328 -2.57696797]
Stock Position:  0.004673278552206751
Bond Position:  [-3.559331]


portfolio before change:  [-3.08829619]
curr_Stock_Price:  101.17413713599795
curr_Factors:  [1.01174137e+02 4.22992908e-02]
mat_Sqrt:  [[ 2.08082737e+01  0.00000000e+00]
 [-8.22671655e-03  1.88497757e-02]]
grads:  [-0.00305503  0.59197946]
Stock Position:  -0.0030550332844171313
Bond Position:  [-2.77920583]


portfolio before change:  [-3.08469609]
curr_Stock_Price:  99.54074973872436
curr_Factors:  [9.95407497e+01 4.52184965e-02]
mat_Sqrt:  [[ 2.11669833e+01  0.00000000e+00]
 [-8.50585647e-03  1.94893656e-02]]
grads:  [-1.57976346e-02 -2.11858935e+01]
Stock Position:  -0.015797634588908052
Bond Position:  [-1.5121877]


portfolio before change:  [-3.06510589]
curr_Stock_Price:  98.2528047770988
curr_Factors:  [9.82528048e+01 4.57678283e-02]
mat_Sqrt:  [[ 2.10196321e+01  0.00000000e+00]
 [-8.55736673e-03  1.96073904e-02]]
grads:  [-2.64190026e-03 -3.03160528e+00]
Stock Position:  -0.002641900264497487
Bond Position:  [-2.80553178]


portfolio before change:  [-3.06057351]
curr_Stock_Price:  96.00612787557426
curr_Factors:  [9.60061279e+01 4.59060369e-02]
mat_Sqrt:  [[ 2.05699793e+01  0.00000000e+00]
 [-8.57027766e-03  1.96369730e-02]]
grads:  [-3.81985295e-03 -5.84354056e+01]
Stock Position:  -0.003819852949504945
Bond Position:  [-2.69384422]


portfolio before change:  [-3.07175787]
curr_Stock_Price:  98.58138520430997
curr_Factors:  [9.85813852e+01 4.52218425e-02]
mat_Sqrt:  [[ 2.09637534e+01  0.00000000e+00]
 [-8.50617117e-03  1.94900866e-02]]
grads:  [-0.04185497 11.899488  ]
Stock Position:  -0.04185496739243227
Bond Position:  [1.05436279]


portfolio before change:  [-2.96608342]
curr_Stock_Price:  96.06920708058678
curr_Factors:  [9.60692071e+01 4.33639568e-02]
mat_Sqrt:  [[ 2.00054653e+01  0.00000000e+00]
 [-8.32960569e-03  1.90855243e-02]]
grads:  [-1.06445354e-03  1.50664516e+00]
Stock Position:  -0.0010644535398720658
Bond Position:  [-2.86382222]


portfolio before change:  [-2.96871408]
curr_Stock_Price:  97.19502812387327
curr_Factors:  [9.71950281e+01 4.53694010e-02]
mat_Sqrt:  [[ 2.07026325e+01  0.00000000e+00]
 [-8.52003765e-03  1.95218587e-02]]
grads:  [-0.00267338 -2.12078393]
Stock Position:  -0.002673376831365188
Bond Position:  [-2.70887514]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.96805981]
Stock Price:  96.44352662144448
PL:  [-2.96805981]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.51353550e-01  2.91092130e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.82405450e-01  1.14768185e-01]
 [-1.26653107e-01 -4.81322162e-01]
 [-1.57408184e-02 -1.04394184e-02]
 [ 3.91455601e-01 -8.03855671e-01]
 [-8.07445211e-01  1.49991585e-01]
 [-9.02431188e-03  2.73822412e-02]
 [-2.88421334e-02  7.73333635e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.2412581]
curr_Stock_Price:  98.24112681782604
curr_Factors:  [9.82411268e+01 3.82211897e-02]
mat_Sqrt:  [[ 1.92063764e+01  0.00000000e+00]
 [-7.82009613e-03  1.79180912e-02]]
grads:  [-0.03250538 16.24571089]
Stock Position:  -0.03250537822212308
Bond Position:  [-6.04789311]


portfolio before change:  [-9.22814889]
curr_Stock_Price:  97.74478098133059
curr_Factors:  [9.77447810e+01 3.48479957e-02]
mat_Sqrt:  [[ 1.82466222e+01  0.00000000e+00]
 [-7.46704715e-03  1.71091544e-02]]
grads:  [ 0.00514943 -2.7632583 ]
Stock Position:  0.005149428203964825
Bond Position:  [-9.73147862]


portfolio before change:  [-9.23052282]
curr_Stock_Price:  98.22891713695144
curr_Factors:  [9.82289171e+01 3.24740688e-02]
mat_Sqrt:  [[ 1.77014038e+01  0.00000000e+00]
 [-7.20822517e-03  1.65161187e-02]]
grads:  [0.01313423 6.9488593 ]
Stock Position:  0.013134234743996076
Bond Position:  [-10.52068448]


portfolio before change:  [-9.24728981]
curr_Stock_Price:  97.35293668770029
curr_Factors:  [9.73529367e+01 3.17190919e-02]
mat_Sqrt:  [[ 1.73384164e+01  0.00000000e+00]
 [-7.12394181e-03  1.63230013e-02]]
grads:  [-1.94204195e-02 -2.94873567e+01]
Stock Position:  -0.019420419530395007
Bond Position:  [-7.35665494]


portfolio before change:  [-9.27807957]
curr_Stock_Price:  98.74891647122757
curr_Factors:  [9.87489165e+01 3.23471770e-02]
mat_Sqrt:  [[ 1.77603096e+01  0.00000000e+00]
 [-7.19412839e-03  1.64838189e-02]]
grads:  [-0.00114283 -0.6333131 ]
Stock Position:  -0.0011428265933921856
Bond Position:  [-9.16522668]


portfolio before change:  [-9.28313852]
curr_Stock_Price:  99.16472125593954
curr_Factors:  [9.91647213e+01 3.02704443e-02]
mat_Sqrt:  [[ 1.72530783e+01  0.00000000e+00]
 [-6.95936139e-03  1.59459002e-02]]
grads:  [ 2.35460731e-03 -5.04114325e+01]
Stock Position:  0.00235460731072049
Bond Position:  [-9.5166325]


portfolio before change:  [-9.28308213]
curr_Stock_Price:  101.2100287521801
curr_Factors:  [1.01210029e+02 2.75201868e-02]
mat_Sqrt:  [[ 1.67899436e+01  0.00000000e+00]
 [-6.63568375e-03  1.52042615e-02]]
grads:  [-0.04419214  9.86510159]
Stock Position:  -0.044192138782041646
Bond Position:  [-4.8103945]


portfolio before change:  [-9.33558933]
curr_Stock_Price:  102.34374625888884
curr_Factors:  [1.02343746e+02 2.45113650e-02]
mat_Sqrt:  [[ 1.60230452e+01  0.00000000e+00]
 [-6.26244233e-03  1.43490580e-02]]
grads:  [1.82629324e-04 1.90829539e+00]
Stock Position:  0.00018262932394406395
Bond Position:  [-9.3542803]


portfolio before change:  [-9.34019687]
curr_Stock_Price:  102.73126572555964
curr_Factors:  [1.02731266e+02 2.46091253e-02]
mat_Sqrt:  [[ 1.61157577e+01  0.00000000e+00]
 [-6.27491837e-03  1.43776442e-02]]
grads:  [3.04603333e-04 5.37872286e+00]
Stock Position:  0.0003046033332944681
Bond Position:  [-9.37148916]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.34480933]
Stock Price:  102.97569661559184
PL:  [-12.32050595]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 9.54300343e-02 -3.40973217e-03]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.74884001e-01  1.09927480e-01]
 [-1.37083316e-01 -4.48383127e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.37898661e-01 -1.29150597e+00]
 [-1.02252841e+00  2.82201209e-01]
 [-9.06868667e-03  5.82448334e-02]
 [-4.86742969e-02 -1.97675429e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.43760517]
curr_Stock_Price:  102.1086727169017
curr_Factors:  [1.02108673e+02 4.03110361e-02]
mat_Sqrt:  [[ 2.05009795e+01  0.00000000e+00]
 [-8.03104338e-03  1.84014321e-02]]
grads:  [ 0.00458231 -0.18529711]
Stock Position:  0.004582313014991226
Bond Position:  [15.96971127]


portfolio before change:  [16.43344799]
curr_Stock_Price:  99.45847609356667
curr_Factors:  [9.94584761e+01 4.23790550e-02]
mat_Sqrt:  [[ 2.04746947e+01  0.00000000e+00]
 [-8.23446951e-03  1.88675399e-02]]
grads:  [ 0.00458906 -2.50573276]
Stock Position:  0.004589063345659016
Bond Position:  [15.97702674]


portfolio before change:  [16.43610465]
curr_Stock_Price:  98.29617926689207
curr_Factors:  [9.82961793e+01 4.06012839e-02]
mat_Sqrt:  [[ 1.98064445e+01  0.00000000e+00]
 [-8.05990411e-03  1.84675603e-02]]
grads:  [0.01125191 5.95246355]
Stock Position:  0.01125190776961106
Bond Position:  [15.33008511]


portfolio before change:  [16.44354551]
curr_Stock_Price:  98.27608537988083
curr_Factors:  [9.82760854e+01 4.10931189e-02]
mat_Sqrt:  [[ 1.99219755e+01  0.00000000e+00]
 [-8.10857510e-03  1.85790796e-02]]
grads:  [-1.67038533e-02 -2.41337642e+01]
Stock Position:  -0.016703853288685806
Bond Position:  [18.08513483]


portfolio before change:  [16.49758127]
curr_Stock_Price:  95.58263947539113
curr_Factors:  [9.55826395e+01 4.27683948e-02]
mat_Sqrt:  [[ 1.97669878e+01  0.00000000e+00]
 [-8.27220839e-03  1.89540106e-02]]
grads:  [-3.56489317e-03 -4.49482693e+00]
Stock Position:  -0.0035648931664288646
Bond Position:  [16.83832317]


portfolio before change:  [16.50880696]
curr_Stock_Price:  94.79596053997263
curr_Factors:  [9.47959605e+01 3.83460875e-02]
mat_Sqrt:  [[ 1.85630939e+01  0.00000000e+00]
 [-7.83286282e-03  1.79473434e-02]]
grads:  [-6.77477339e-03 -7.19608435e+01]
Stock Position:  -0.006774773391495915
Bond Position:  [17.15102811]


portfolio before change:  [16.51411944]
curr_Stock_Price:  95.27792126500934
curr_Factors:  [9.52779213e+01 3.53992625e-02]
mat_Sqrt:  [[ 1.79262472e+01  0.00000000e+00]
 [-7.52587669e-03  1.72439498e-02]]
grads:  [-0.05017033 16.36523024]
Stock Position:  -0.05017032841152045
Bond Position:  [21.29424404]


portfolio before change:  [16.57765556]
curr_Stock_Price:  94.22378567977884
curr_Factors:  [9.42237857e+01 3.61751655e-02]
mat_Sqrt:  [[ 1.79211474e+01  0.00000000e+00]
 [-7.60790805e-03  1.74319072e-02]]
grads:  [9.12410476e-04 3.34127715e+00]
Stock Position:  0.0009124104762345794
Bond Position:  [16.49168479]


portfolio before change:  [16.58422561]
curr_Stock_Price:  92.38486196331999
curr_Factors:  [9.23848620e+01 3.42582721e-02]
mat_Sqrt:  [[ 1.70995051e+01  0.00000000e+00]
 [-7.40359611e-03  1.69637698e-02]]
grads:  [-7.89186156e-03 -1.16528007e+01]
Stock Position:  -0.007891861555137523
Bond Position:  [17.31331415]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.57325114]
Stock Price:  94.87265085739361
PL:  [16.57325114]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.31782462e-01  2.92173656e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.90732192e-01  1.84485847e-01]
 [-1.32709075e-01 -4.62079680e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.21900546e-01 -1.12373900e+00]
 [-1.01280409e+00  2.85701728e-01]
 [-9.97830011e-03  5.71423814e-02]
 [-3.80811416e-02 -8.46266388e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.73574351]
curr_Stock_Price:  98.3172634001434
curr_Factors:  [9.83172634e+01 3.86376205e-02]
mat_Sqrt:  [[ 1.93256882e+01  0.00000000e+00]
 [-7.86258182e-03  1.80154382e-02]]
grads:  [-0.03126758 16.21796004]
Stock Position:  -0.03126757597983553
Bond Position:  [-5.661601]


portfolio before change:  [-8.68987958]
curr_Stock_Price:  96.7598852971251
curr_Factors:  [9.67598853e+01 3.82309406e-02]
mat_Sqrt:  [[ 1.89192030e+01  0.00000000e+00]
 [-7.82109359e-03  1.79203767e-02]]
grads:  [ 0.00496637 -2.63817071]
Stock Position:  0.004966365188774684
Bond Position:  [-9.1704245]


portfolio before change:  [-8.69203848]
curr_Stock_Price:  97.24866454393882
curr_Factors:  [9.72486645e+01 3.83683789e-02]
mat_Sqrt:  [[ 1.90489206e+01  0.00000000e+00]
 [-7.83513920e-03  1.79525592e-02]]
grads:  [ 0.01948921 10.27629791]
Stock Position:  0.019489210157867316
Bond Position:  [-10.58733814]


portfolio before change:  [-8.68480371]
curr_Stock_Price:  97.89157186841096
curr_Factors:  [9.78915719e+01 3.76181707e-02]
mat_Sqrt:  [[ 1.89864661e+01  0.00000000e+00]
 [-7.75816171e-03  1.77761816e-02]]
grads:  [-1.76113437e-02 -2.59943159e+01]
Stock Position:  -0.01761134373718211
Bond Position:  [-6.96080159]


portfolio before change:  [-8.65100182]
curr_Stock_Price:  95.77457468350522
curr_Factors:  [9.57745747e+01 3.64711390e-02]
mat_Sqrt:  [[ 1.82904713e+01  0.00000000e+00]
 [-7.63896737e-03  1.75030731e-02]]
grads:  [-3.85267272e-03 -4.86743080e+00]
Stock Position:  -0.0038526727243040995
Bond Position:  [-8.28201373]


portfolio before change:  [-8.65716091]
curr_Stock_Price:  96.2981202329121
curr_Factors:  [9.62981202e+01 3.56710853e-02]
mat_Sqrt:  [[ 1.81876242e+01  0.00000000e+00]
 [-7.55471618e-03  1.73100294e-02]]
grads:  [-3.76846145e-03 -6.49183762e+01]
Stock Position:  -0.003768461446781044
Bond Position:  [-8.29426516]


portfolio before change:  [-8.65646208]
curr_Stock_Price:  95.01191872407782
curr_Factors:  [9.50119187e+01 3.45226731e-02]
mat_Sqrt:  [[ 1.76534787e+01  0.00000000e+00]
 [-7.43211121e-03  1.70291061e-02]]
grads:  [-0.05030814 16.77725927]
Stock Position:  -0.0503081376529102
Bond Position:  [-3.8765894]


portfolio before change:  [-8.61941826]
curr_Stock_Price:  94.23704199832005
curr_Factors:  [9.42370420e+01 3.32811632e-02]
mat_Sqrt:  [[ 1.71917819e+01  0.00000000e+00]
 [-7.29725025e-03  1.67201008e-02]]
grads:  [8.70222746e-04 3.41758594e+00]
Stock Position:  0.0008702227458831797
Bond Position:  [-8.70142547]


portfolio before change:  [-8.62166321]
curr_Stock_Price:  96.65808982121142
curr_Factors:  [9.66580898e+01 2.97061090e-02]
mat_Sqrt:  [[ 1.66594666e+01  0.00000000e+00]
 [-6.89418410e-03  1.57965602e-02]]
grads:  [-4.50285933e-03 -5.35728269e+00]
Stock Position:  -0.004502859326221869
Bond Position:  [-8.18642542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.61259941]
Stock Price:  93.7359406324082
PL:  [-8.61259941]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.32060027e-01  3.45947754e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.88203662e-02  5.77756703e-02]
 [-1.20265857e-01 -4.98640865e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.42148213e-01 -1.32980020e+00]
 [-1.01867813e+00  2.83808936e-01]
 [ 4.54996766e-03  8.23857974e-02]
 [-3.64533815e-02 -2.02903658e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.14308705]
curr_Stock_Price:  100.55819437488687
curr_Factors:  [1.00558194e+02 3.71768076e-02]
mat_Sqrt:  [[ 1.93889153e+01  0.00000000e+00]
 [-7.71251529e-03  1.76715926e-02]]
grads:  [-4.18156705e-03  1.95764900e+01]
Stock Position:  -0.004181567045348828
Bond Position:  [6.56357788]


portfolio before change:  [6.15219524]
curr_Stock_Price:  99.16503593563016
curr_Factors:  [9.91650359e+01 3.24318713e-02]
mat_Sqrt:  [[ 1.78584835e+01  0.00000000e+00]
 [-7.20354039e-03  1.65053846e-02]]
grads:  [ 0.00526135 -2.86433877]
Stock Position:  0.005261346565533098
Bond Position:  [5.63045362]


portfolio before change:  [6.15689514]
curr_Stock_Price:  99.52311300259187
curr_Factors:  [9.95231130e+01 3.68549374e-02]
mat_Sqrt:  [[ 1.91060888e+01  0.00000000e+00]
 [-7.67905592e-03  1.75949275e-02]]
grads:  [0.00544516 3.28365492]
Stock Position:  0.00544516134608192
Bond Position:  [5.61497573]


portfolio before change:  [6.14515694]
curr_Stock_Price:  96.85167895102886
curr_Factors:  [9.6851679e+01 3.7058938e-02]
mat_Sqrt:  [[ 1.86446244e+01  0.00000000e+00]
 [-7.70027927e-03  1.76435563e-02]]
grads:  [-1.81226806e-02 -2.82619250e+01]
Stock Position:  -0.018122680585597836
Bond Position:  [7.90036898]


portfolio before change:  [6.20328353]
curr_Stock_Price:  93.86230774791846
curr_Factors:  [9.38623077e+01 3.99953190e-02]
mat_Sqrt:  [[ 1.87713631e+01  0.00000000e+00]
 [-7.99953189e-03  1.83292302e-02]]
grads:  [-3.75397351e-03 -4.64804011e+00]
Stock Position:  -0.003753973506500965
Bond Position:  [6.55564015]


portfolio before change:  [6.20425235]
curr_Stock_Price:  94.47760927444006
curr_Factors:  [9.44776093e+01 3.59075189e-02]
mat_Sqrt:  [[ 1.79028261e+01  0.00000000e+00]
 [-7.57971176e-03  1.73673014e-02]]
grads:  [-7.72080194e-03 -7.65691898e+01]
Stock Position:  -0.0077208019400997405
Bond Position:  [6.93369526]


portfolio before change:  [6.20247364]
curr_Stock_Price:  95.15712738633067
curr_Factors:  [9.51571274e+01 3.70527912e-02]
mat_Sqrt:  [[ 1.83168921e+01  0.00000000e+00]
 [-7.69964064e-03  1.76420930e-02]]
grads:  [-0.04885183 16.08703317]
Stock Position:  -0.04885183312126578
Bond Position:  [10.85107375]


portfolio before change:  [6.29369781]
curr_Stock_Price:  93.40085182337182
curr_Factors:  [9.34008518e+01 4.00736755e-02]
mat_Sqrt:  [[ 1.86973658e+01  0.00000000e+00]
 [-8.00736416e-03  1.83471762e-02]]
grads:  [2.16640557e-03 4.49038024e+00]
Stock Position:  0.0021664055687805866
Bond Position:  [6.09135369]


portfolio before change:  [6.29672961]
curr_Stock_Price:  93.39409295644616
curr_Factors:  [9.33940930e+01 4.03921242e-02]
mat_Sqrt:  [[ 1.87701505e+01  0.00000000e+00]
 [-8.03911679e-03  1.84199306e-02]]
grads:  [-6.65992518e-03 -1.10154410e+01]
Stock Position:  -0.00665992518087708
Bond Position:  [6.91872728]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.29395387]
Stock Price:  94.33043402602365
PL:  [6.29395387]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.19919050e-01  2.90689674e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.38566381e-02  5.65894889e-02]
 [-1.63879367e-01 -4.14169363e-01]
 [-3.42520366e-02 -9.00622452e-02]
 [ 4.59450299e-01 -1.50725965e+00]
 [-9.76328687e-01  2.99683624e-01]
 [ 1.16104214e-02  9.55764931e-02]
 [-3.86185668e-02 -2.01977371e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.476807]
curr_Stock_Price:  99.8553964319131
curr_Factors:  [9.98553964e+01 4.15139080e-02]
mat_Sqrt:  [[ 2.03454992e+01  0.00000000e+00]
 [-8.14998483e-03  1.86739612e-02]]
grads:  [-9.48866741e-03  1.55665780e+01]
Stock Position:  -0.00948866740935911
Bond Position:  [2.42430164]


portfolio before change:  [1.49319284]
curr_Stock_Price:  98.2562901722757
curr_Factors:  [9.82562902e+01 3.99563810e-02]
mat_Sqrt:  [[ 1.96405405e+01  0.00000000e+00]
 [-7.99563691e-03  1.83203057e-02]]
grads:  [ 0.00478397 -2.58057991]
Stock Position:  0.004783965646394048
Bond Position:  [1.02313812]


portfolio before change:  [1.50033484]
curr_Stock_Price:  99.64223442834178
curr_Factors:  [9.96422344e+01 3.74360351e-02]
mat_Sqrt:  [[ 1.92791721e+01  0.00000000e+00]
 [-7.73935761e-03  1.77330960e-02]]
grads:  [0.00511196 3.19117929]
Stock Position:  0.005111957877063501
Bond Position:  [0.99096794]


portfolio before change:  [1.50279945]
curr_Stock_Price:  100.02740845394548
curr_Factors:  [1.00027408e+02 3.62361888e-02]
mat_Sqrt:  [[ 1.90410228e+01  0.00000000e+00]
 [-7.61432217e-03  1.74466039e-02]]
grads:  [-1.80997470e-02 -2.37392541e+01]
Stock Position:  -0.018099746996174938
Bond Position:  [3.31327023]


portfolio before change:  [1.55091782]
curr_Stock_Price:  97.46044824476702
curr_Factors:  [9.74604482e+01 3.82823792e-02]
mat_Sqrt:  [[ 1.90689976e+01  0.00000000e+00]
 [-7.82635334e-03  1.79324283e-02]]
grads:  [-3.85748765e-03 -5.02231174e+00]
Stock Position:  -0.003857487654417992
Bond Position:  [1.9268703]


portfolio before change:  [1.569457]
curr_Stock_Price:  92.90424372005367
curr_Factors:  [9.29042437e+01 3.68004828e-02]
mat_Sqrt:  [[ 1.78222409e+01  0.00000000e+00]
 [-7.67338077e-03  1.75819241e-02]]
grads:  [-1.11305724e-02 -8.57277987e+01]
Stock Position:  -0.01113057237077855
Bond Position:  [2.60353441]


portfolio before change:  [1.5590666]
curr_Stock_Price:  93.95472886882274
curr_Factors:  [9.39547289e+01 3.89191195e-02]
mat_Sqrt:  [[ 1.85353225e+01  0.00000000e+00]
 [-7.89117172e-03  1.80809459e-02]]
grads:  [-0.04561755 16.57455458]
Stock Position:  -0.04561755162707572
Bond Position:  [5.84505129]


portfolio before change:  [1.60923733]
curr_Stock_Price:  92.91899871066069
curr_Factors:  [9.29189987e+01 3.86086177e-02]
mat_Sqrt:  [[ 1.82577244e+01  0.00000000e+00]
 [-7.85963029e-03  1.80086754e-02]]
grads:  [2.92059522e-03 5.30724726e+00]
Stock Position:  0.002920595220768696
Bond Position:  [1.33785854]


portfolio before change:  [1.61077426]
curr_Stock_Price:  93.21614289811666
curr_Factors:  [9.32161429e+01 3.83008831e-02]
mat_Sqrt:  [[ 1.82429691e+01  0.00000000e+00]
 [-7.82824456e-03  1.79367616e-02]]
grads:  [-6.94890823e-03 -1.12605260e+01]
Stock Position:  -0.006948908234658914
Bond Position:  [2.25852468]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.62235512]
Stock Price:  91.71212059865948
PL:  [1.62235512]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.28864080e-01  2.78985199e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 5.03876376e-02  5.01641548e-02]
 [-1.62465779e-01 -4.11924953e-01]
 [ 4.38013796e-02  1.68395484e-01]
 [ 3.70480272e-01 -7.32904781e-01]
 [-9.59041451e-01  2.24244916e-01]
 [-7.30137498e-02 -9.65973220e-03]
 [-2.96543662e-02  1.34199205e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.6734342]
curr_Stock_Price:  99.38093218887575
curr_Factors:  [9.93809322e+01 3.96232094e-02]
mat_Sqrt:  [[ 1.97823504e+01  0.00000000e+00]
 [-7.96223179e-03  1.82437649e-02]]
grads:  [-0.01552419 15.29208472]
Stock Position:  -0.015524189495996432
Bond Position:  [-0.13062578]


portfolio before change:  [-1.69936822]
curr_Stock_Price:  101.04727968909307
curr_Factors:  [1.01047280e+02 4.18822412e-02]
mat_Sqrt:  [[ 2.06794785e+01  0.00000000e+00]
 [-8.18606046e-03  1.87566209e-02]]
grads:  [ 0.00454362 -2.52055065]
Stock Position:  0.004543618975202816
Bond Position:  [-2.15848856]


portfolio before change:  [-1.70441076]
curr_Stock_Price:  100.17506200676452
curr_Factors:  [1.00175062e+02 4.20426215e-02]
mat_Sqrt:  [[ 2.05401927e+01  0.00000000e+00]
 [-8.20171899e-03  1.87924991e-02]]
grads:  [0.00351901 2.66937115]
Stock Position:  0.003519006401090435
Bond Position:  [-2.05692745]


portfolio before change:  [-1.70347703]
curr_Stock_Price:  100.7327341679184
curr_Factors:  [1.00732734e+02 4.18265636e-02]
mat_Sqrt:  [[ 2.06013991e+01  0.00000000e+00]
 [-8.18061744e-03  1.87441493e-02]]
grads:  [-1.66126857e-02 -2.19761882e+01]
Stock Position:  -0.016612685680906843
Bond Position:  [-0.03003578]


portfolio before change:  [-1.70696524]
curr_Stock_Price:  100.94180257844262
curr_Factors:  [1.00941803e+02 4.21730947e-02]
mat_Sqrt:  [[ 2.07294983e+01  0.00000000e+00]
 [-8.21443556e-03  1.88216364e-02]]
grads:  [5.65837110e-03 8.94690986e+00]
Stock Position:  0.005658371096656779
Bond Position:  [-2.27813142]


portfolio before change:  [-1.7139319]
curr_Stock_Price:  99.91194577405422
curr_Factors:  [9.99119458e+01 4.43065589e-02]
mat_Sqrt:  [[ 2.10305886e+01  0.00000000e+00]
 [-8.41964930e-03  1.92918401e-02]]
grads:  [ 2.40670401e-03 -3.79904030e+01]
Stock Position:  0.0024067040081467424
Bond Position:  [-1.95439038]


portfolio before change:  [-1.71724763]
curr_Stock_Price:  98.94037229956744
curr_Factors:  [9.89403723e+01 4.51261154e-02]
mat_Sqrt:  [[ 2.10178126e+01  0.00000000e+00]
 [-8.49716333e-03  1.94694471e-02]]
grads:  [-0.04097348 11.51778554]
Stock Position:  -0.04097348110536799
Bond Position:  [2.33668384]


portfolio before change:  [-1.71946834]
curr_Stock_Price:  99.02309270950524
curr_Factors:  [9.90230927e+01 4.44424767e-02]
mat_Sqrt:  [[ 2.08754388e+01  0.00000000e+00]
 [-8.43255374e-03  1.93214079e-02]]
grads:  [-0.00369954 -0.49994971]
Stock Position:  -0.003699543915519569
Bond Position:  [-1.35312806]


portfolio before change:  [-1.72456077]
curr_Stock_Price:  100.2166711424209
curr_Factors:  [1.00216671e+02 4.29135603e-02]
mat_Sqrt:  [[ 2.07604731e+01  0.00000000e+00]
 [-8.28623536e-03  1.89861504e-02]]
grads:  [-0.00114629  0.70682683]
Stock Position:  -0.0011462856629559676
Bond Position:  [-1.60968384]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.72589666]
Stock Price:  100.67976830254896
PL:  [-2.40566496]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 4.18166759e-01 -2.25244875e-01]
 [-1.90031753e-02  2.30217182e-01]
 [-9.88641737e-02  8.90093588e-03]
 [-1.44155531e-01 -4.49227814e-01]
 [ 9.19678930e-02  3.21228396e-01]
 [ 3.18106371e-01 -6.02739472e-01]
 [-9.29169245e-01  2.09538412e-01]
 [-5.42775480e-02  2.77409407e-03]
 [-3.43171779e-02  4.98231652e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.81215895]
curr_Stock_Price:  104.12304150249743
curr_Factors:  [1.04123042e+02 3.90352248e-02]
mat_Sqrt:  [[ 2.05719371e+01  0.00000000e+00]
 [-7.90293361e-03  1.81078957e-02]]
grads:  [  0.01554845 -12.43904196]
Stock Position:  0.015548454912606953
Bond Position:  [28.19320653]


portfolio before change:  [29.82246612]
curr_Stock_Price:  103.87909734977124
curr_Factors:  [1.03879097e+02 3.94870201e-02]
mat_Sqrt:  [[ 2.06421699e+01  0.00000000e+00]
 [-7.94853648e-03  1.82123850e-02]]
grads:  [3.94686416e-03 1.26406938e+01]
Stock Position:  0.003946864155385643
Bond Position:  [29.41246943]


portfolio before change:  [29.83740142]
curr_Stock_Price:  103.93620358509682
curr_Factors:  [1.03936204e+02 3.70855992e-02]
mat_Sqrt:  [[ 2.00156408e+01  0.00000000e+00]
 [-7.70304866e-03  1.76499018e-02]]
grads:  [-0.00474526  0.50430512]
Stock Position:  -0.004745263340555117
Bond Position:  [30.33060608]


portfolio before change:  [29.8557491]
curr_Stock_Price:  103.26636004302233
curr_Factors:  [1.03266360e+02 3.64320377e-02]
mat_Sqrt:  [[ 1.97106343e+01  0.00000000e+00]
 [-7.63487134e-03  1.74936879e-02]]
grads:  [-1.72604604e-02 -2.56794231e+01]
Stock Position:  -0.017260460350452683
Bond Position:  [31.63817402]


portfolio before change:  [29.87787653]
curr_Stock_Price:  102.90110991330951
curr_Factors:  [1.02901110e+02 3.50075033e-02]
mat_Sqrt:  [[ 1.92530983e+01  0.00000000e+00]
 [-7.48411687e-03  1.71482660e-02]]
grads:  [1.20584986e-02 1.87324127e+01]
Stock Position:  0.012058498588153724
Bond Position:  [28.63704364]


portfolio before change:  [29.88193129]
curr_Stock_Price:  102.04964850217806
curr_Factors:  [1.02049649e+02 3.63766849e-02]
mat_Sqrt:  [[ 1.94635956e+01  0.00000000e+00]
 [-7.62906914e-03  1.74803934e-02]]
grads:  [ 2.82832115e-03 -3.44808871e+01]
Stock Position:  0.002828321154883427
Bond Position:  [29.59330211]


portfolio before change:  [29.88917172]
curr_Stock_Price:  99.37671573930098
curr_Factors:  [9.93767157e+01 4.06868023e-02]
mat_Sqrt:  [[ 2.00452473e+01  0.00000000e+00]
 [-8.06838792e-03  1.84869992e-02]]
grads:  [-0.04179141 11.33436583]
Stock Position:  -0.04179141174160135
Bond Position:  [34.04226497]


portfolio before change:  [29.87691666]
curr_Stock_Price:  100.07734897601611
curr_Factors:  [1.00077349e+02 4.18045858e-02]
mat_Sqrt:  [[ 2.04619847e+01  0.00000000e+00]
 [-8.17846791e-03  1.87392241e-02]]
grads:  [-0.00259344  0.14803676]
Stock Position:  -0.002593435335049669
Bond Position:  [30.13646079]


portfolio before change:  [29.89494338]
curr_Stock_Price:  98.93804188882183
curr_Factors:  [9.89380419e+01 4.46676457e-02]
mat_Sqrt:  [[ 2.09102797e+01  0.00000000e+00]
 [-8.45388864e-03  1.93702923e-02]]
grads:  [-0.00153717  0.25721432]
Stock Position:  -0.0015371729682391124
Bond Position:  [30.04702826]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.90620471]
Stock Price:  101.38795638710064
PL:  [28.51824832]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.00300447e-02  1.57184017e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.94068703e-02  5.03745069e-03]
 [-1.36080931e-01 -4.57567634e-01]
 [ 7.63973978e-02  2.68463508e-01]
 [ 2.95521039e-01 -6.03780825e-01]
 [-4.81133169e-01  2.63644024e-02]
 [ 1.51100607e-01 -2.30469215e-01]
 [-4.30947780e-02  2.13418744e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.66349737]
curr_Stock_Price:  101.8414707281018
curr_Factors:  [1.01841471e+02 3.80384212e-02]
mat_Sqrt:  [[ 1.98625912e+01  0.00000000e+00]
 [-7.80137641e-03  1.78751990e-02]]
grads:  [2.44533474e-03 8.79341354e+00]
Stock Position:  0.0024453347431775555
Bond Position:  [14.41446089]


portfolio before change:  [14.66373148]
curr_Stock_Price:  98.98913053358251
curr_Factors:  [9.89891305e+01 4.01743906e-02]
mat_Sqrt:  [[ 1.98409361e+01  0.00000000e+00]
 [-8.01742009e-03  1.83702172e-02]]
grads:  [ 0.00473565 -2.57356853]
Stock Position:  0.004735647075715481
Bond Position:  [14.19495389]


portfolio before change:  [14.68346508]
curr_Stock_Price:  101.65705486918432
curr_Factors:  [1.01657055e+02 3.84721307e-02]
mat_Sqrt:  [[ 1.99393338e+01  0.00000000e+00]
 [-7.84572553e-03  1.79768156e-02]]
grads:  [-0.00487521  0.2802193 ]
Stock Position:  -0.004875205344237824
Bond Position:  [15.1790641]


portfolio before change:  [14.67980541]
curr_Stock_Price:  103.96487576957146
curr_Factors:  [1.03964876e+02 4.00087695e-02]
mat_Sqrt:  [[ 2.07952543e+01  0.00000000e+00]
 [-8.00087690e-03  1.83323120e-02]]
grads:  [-1.61469446e-02 -2.49596251e+01]
Stock Position:  -0.016146944571590667
Bond Position:  [16.35852049]


portfolio before change:  [14.71570009]
curr_Stock_Price:  102.24855247039173
curr_Factors:  [1.02248552e+02 4.23756759e-02]
mat_Sqrt:  [[ 2.10482255e+01  0.00000000e+00]
 [-8.23414121e-03  1.88667877e-02]]
grads:  [9.19623740e-03 1.42294233e+01]
Stock Position:  0.009196237399923991
Bond Position:  [13.77539813]


portfolio before change:  [14.72560216]
curr_Stock_Price:  102.57614831339438
curr_Factors:  [1.02576148e+02 4.30398114e-02]
mat_Sqrt:  [[ 2.12804872e+01  0.00000000e+00]
 [-8.29841540e-03  1.90140584e-02]]
grads:  [ 1.50417059e-03 -3.17544426e+01]
Stock Position:  0.0015041705903032707
Bond Position:  [14.57131013]


portfolio before change:  [14.73808536]
curr_Stock_Price:  106.03035891539574
curr_Factors:  [1.06030359e+02 4.27564071e-02]
mat_Sqrt:  [[ 2.19245573e+01  0.00000000e+00]
 [-8.27104899e-03  1.89513540e-02]]
grads:  [-0.02142013  1.39116193]
Stock Position:  -0.021420126894123946
Bond Position:  [17.0092691]


portfolio before change:  [14.73233445]
curr_Stock_Price:  106.69597904366599
curr_Factors:  [1.06695979e+02 4.19621587e-02]
mat_Sqrt:  [[ 2.18563161e+01  0.00000000e+00]
 [-8.19386685e-03  1.87745075e-02]]
grads:  [ 2.31125843e-03 -1.22756463e+01]
Stock Position:  0.0023112584349897765
Bond Position:  [14.48573247]


portfolio before change:  [14.74021051]
curr_Stock_Price:  106.96915421861424
curr_Factors:  [1.06969154e+02 4.18316179e-02]
mat_Sqrt:  [[ 2.18781650e+01  0.00000000e+00]
 [-8.18111170e-03  1.87452818e-02]]
grads:  [2.28761407e-03 1.13851979e+01]
Stock Position:  0.002287614065607223
Bond Position:  [14.49550637]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.74508392]
Stock Price:  105.93044964499363
PL:  [8.81463427]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.51262926e-01  2.80701894e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.93994462e-02  5.09030361e-03]
 [-1.47578633e-01 -4.42396897e-01]
 [ 1.61708767e-01  6.46604796e-01]
 [ 2.09550721e-01 -6.36874086e-01]
 [-1.88125670e-01 -6.78836027e-02]
 [ 1.13648275e-01 -1.71195615e-01]
 [-3.49823821e-02  1.35399522e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.18659617]
curr_Stock_Price:  99.30364381996424
curr_Factors:  [9.93036438e+01 3.90312347e-02]
mat_Sqrt:  [[ 1.96187498e+01  0.00000000e+00]
 [-7.90252969e-03  1.81069702e-02]]
grads:  [-0.01675716 15.502422  ]
Stock Position:  -0.016757162338535844
Bond Position:  [-0.52254889]


portfolio before change:  [-2.203394]
curr_Stock_Price:  100.29047512231641
curr_Factors:  [1.00290475e+02 3.93837479e-02]
mat_Sqrt:  [[ 1.99029848e+01  0.00000000e+00]
 [-7.93813559e-03  1.81885536e-02]]
grads:  [ 0.00472088 -2.59927281]
Stock Position:  0.004720883433861634
Bond Position:  [-2.67685364]


portfolio before change:  [-2.19814557]
curr_Stock_Price:  101.68580474733086
curr_Factors:  [1.01685805e+02 4.19932718e-02]
mat_Sqrt:  [[ 2.08377194e+01  0.00000000e+00]
 [-8.19690398e-03  1.87814665e-02]]
grads:  [-0.00466356  0.27102802]
Stock Position:  -0.0046635552338618776
Bond Position:  [-1.72392821]


portfolio before change:  [-2.20415708]
curr_Stock_Price:  102.78996870188128
curr_Factors:  [1.02789969e+02 4.18485132e-02]
mat_Sqrt:  [[ 2.10276505e+01  0.00000000e+00]
 [-8.18276366e-03  1.87490669e-02]]
grads:  [-1.62004057e-02 -2.35956754e+01]
Stock Position:  -0.016200405653051527
Bond Position:  [-0.53891789]


portfolio before change:  [-2.26469682]
curr_Stock_Price:  106.51025896670723
curr_Factors:  [1.06510259e+02 4.04895601e-02]
mat_Sqrt:  [[ 2.14320133e+01  0.00000000e+00]
 [-8.04880712e-03  1.84421339e-02]]
grads:  [2.07124842e-02 3.50612786e+01]
Stock Position:  0.02071248415198054
Bond Position:  [-4.47078887]


portfolio before change:  [-2.30381921]
curr_Stock_Price:  104.72937961903219
curr_Factors:  [1.0472938e+02 4.0779456e-02]
mat_Sqrt:  [[ 2.11489712e+01  0.00000000e+00]
 [-8.07756954e-03  1.85080369e-02]]
grads:  [-3.23438512e-03 -3.44106773e+01]
Stock Position:  -0.0032343851201875966
Bond Position:  [-1.96508406]


portfolio before change:  [-2.32241268]
curr_Stock_Price:  110.1742107406269
curr_Factors:  [1.10174211e+02 3.92240452e-02]
mat_Sqrt:  [[ 2.18200699e+01  0.00000000e+00]
 [-7.92202451e-03  1.81516385e-02]]
grads:  [-0.00997946 -3.73980579]
Stock Position:  -0.009979459469993433
Bond Position:  [-1.22293361]


portfolio before change:  [-2.27820008]
curr_Stock_Price:  105.68256305835709
curr_Factors:  [1.05682563e+02 4.09669852e-02]
mat_Sqrt:  [[ 2.13904706e+01  0.00000000e+00]
 [-8.09612107e-03  1.85505438e-02]]
grads:  [ 1.82008074e-03 -9.22860355e+00]
Stock Position:  0.001820080738667277
Bond Position:  [-2.47055088]


portfolio before change:  [-2.28152822]
curr_Stock_Price:  104.53285882450996
curr_Factors:  [1.04532859e+02 4.13750373e-02]
mat_Sqrt:  [[ 2.12628770e+01  0.00000000e+00]
 [-8.13634191e-03  1.86427013e-02]]
grads:  [1.13393941e-03 7.26287033e+00]
Stock Position:  0.001133939406331398
Bond Position:  [-2.40006215]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.28461776]
Stock Price:  102.86680300166877
PL:  [-5.15142076]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.65382391e-01  2.88581698e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.85170254e-02  1.13723022e-02]
 [-8.50771101e-02 -5.02884739e-01]
 [ 2.11114864e-01  8.77109192e-01]
 [ 1.83077096e-01 -7.55841269e-01]
 [-1.64133529e-01 -6.46966149e-02]
 [ 2.56610606e-01 -3.97402398e-01]
 [-5.16757844e-02  2.95944649e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.69102993]
curr_Stock_Price:  98.92644594919311
curr_Factors:  [9.89264459e+01 4.46540290e-02]
mat_Sqrt:  [[ 2.09046419e+01  0.00000000e+00]
 [-8.45259998e-03  1.93673396e-02]]
grads:  [-0.02102093 14.90043051]
Stock Position:  -0.0210209299712574
Bond Position:  [-2.61150404]


portfolio before change:  [-4.69841774]
curr_Stock_Price:  99.21576345785546
curr_Factors:  [9.92157635e+01 4.21792332e-02]
mat_Sqrt:  [[ 2.03765202e+01  0.00000000e+00]
 [-8.21503336e-03  1.88230061e-02]]
grads:  [ 0.00461117 -2.51166114]
Stock Position:  0.004611173561410762
Bond Position:  [-5.15591884]


portfolio before change:  [-4.67252275]
curr_Stock_Price:  105.3906756693152
curr_Factors:  [1.05390676e+02 4.12080912e-02]
mat_Sqrt:  [[ 2.13940713e+01  0.00000000e+00]
 [-8.11991046e-03  1.86050522e-02]]
grads:  [-0.00437288  0.61124807]
Stock Position:  -0.004372881845751982
Bond Position:  [-4.21166178]


portfolio before change:  [-4.68625765]
curr_Stock_Price:  108.04991512424905
curr_Factors:  [1.08049915e+02 4.43605105e-02]
mat_Sqrt:  [[ 2.27574029e+01  0.00000000e+00]
 [-8.42477399e-03  1.93035823e-02]]
grads:  [-1.33826345e-02 -2.60513687e+01]
Stock Position:  -0.013382634452994643
Bond Position:  [-3.24026513]


portfolio before change:  [-4.70147158]
curr_Stock_Price:  109.0656642007144
curr_Factors:  [1.09065664e+02 4.27004572e-02]
mat_Sqrt:  [[ 2.25374259e+01  0.00000000e+00]
 [-8.26563558e-03  1.89389503e-02]]
grads:  [2.63524638e-02 4.63124501e+01]
Stock Position:  0.026352463800211785
Bond Position:  [-7.57562055]


portfolio before change:  [-4.73237068]
curr_Stock_Price:  108.03690507268296
curr_Factors:  [1.08036905e+02 4.09449218e-02]
mat_Sqrt:  [[ 2.18611074e+01  0.00000000e+00]
 [-8.09394063e-03  1.85455478e-02]]
grads:  [-6.71507966e-03 -4.07559419e+01]
Stock Position:  -0.00671507965885664
Bond Position:  [-4.00689425]


portfolio before change:  [-4.75088332]
curr_Stock_Price:  110.49535593077808
curr_Factors:  [1.10495356e+02 3.84353477e-02]
mat_Sqrt:  [[ 2.16625427e+01  0.00000000e+00]
 [-7.84197401e-03  1.79682198e-02]]
grads:  [-0.00888028 -3.60061352]
Stock Position:  -0.008880280084694544
Bond Position:  [-3.76965361]


portfolio before change:  [-4.74440747]
curr_Stock_Price:  109.55381478127846
curr_Factors:  [1.09553815e+02 4.04318355e-02]
mat_Sqrt:  [[ 2.20287185e+01  0.00000000e+00]
 [-8.04306762e-03  1.84289831e-02]]
grads:  [ 3.77552512e-03 -2.15639895e+01]
Stock Position:  0.003775525120164976
Bond Position:  [-5.15803065]


portfolio before change:  [-4.74701596]
curr_Stock_Price:  109.54617829962166
curr_Factors:  [1.09546178e+02 4.23158522e-02]
mat_Sqrt:  [[ 2.25345441e+01  0.00000000e+00]
 [-8.22832689e-03  1.88534654e-02]]
grads:  [3.43850086e-03 1.56970956e+01]
Stock Position:  0.0034385008585513187
Bond Position:  [-5.12369059]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.74436971]
Stock Price:  111.06100453728794
PL:  [-15.80537425]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 9.22314724e-02  2.00792417e-04]
 [-7.37100156e-02  2.37212403e-01]
 [-9.81052495e-02  1.43037559e-02]
 [-5.64809521e-02 -5.27904116e-01]
 [ 2.06453235e-01  8.55360338e-01]
 [ 2.11611013e-01 -6.26250598e-01]
 [ 4.06436716e-02 -3.74946814e-02]
 [ 2.79925069e-01 -4.34270430e-01]
 [-4.94041095e-02  2.74342744e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.44349286]
curr_Stock_Price:  102.10955947426244
curr_Factors:  [1.02109559e+02 3.75472697e-02]
mat_Sqrt:  [[ 1.97858897e+01  0.00000000e+00]
 [-7.75084714e-03  1.77594219e-02]]
grads:  [0.00466591 0.01130625]
Stock Position:  0.004665906200256728
Bond Position:  [15.96705924]


portfolio before change:  [16.46668983]
curr_Stock_Price:  105.36968605955805
curr_Factors:  [1.05369686e+02 3.52530325e-02]
mat_Sqrt:  [[ 1.97839920e+01  0.00000000e+00]
 [-7.51031637e-03  1.72082966e-02]]
grads:  [1.50717634e-03 1.37847695e+01]
Stock Position:  0.001507176338464469
Bond Position:  [16.30787914]


portfolio before change:  [16.4774881]
curr_Stock_Price:  107.12282154445128
curr_Factors:  [1.07122822e+02 3.60440251e-02]
mat_Sqrt:  [[ 2.03375505e+01  0.00000000e+00]
 [-7.59410562e-03  1.74002819e-02]]
grads:  [-0.00451689  0.82204162]
Stock Position:  -0.004516894917979624
Bond Position:  [16.96135062]


portfolio before change:  [16.47144155]
curr_Stock_Price:  110.33948736140722
curr_Factors:  [1.10339487e+02 3.84752148e-02]
mat_Sqrt:  [[ 2.16432008e+01  0.00000000e+00]
 [-7.84604000e-03  1.79775361e-02]]
grads:  [-1.32548415e-02 -2.93646534e+01]
Stock Position:  -0.013254841543740556
Bond Position:  [17.93397397]


portfolio before change:  [16.50054088]
curr_Stock_Price:  108.82078975060467
curr_Factors:  [1.08820790e+02 3.80015761e-02]
mat_Sqrt:  [[ 2.12135171e+01  0.00000000e+00]
 [-7.79759718e-03  1.78665397e-02]]
grads:  [2.73298902e-02 4.78749861e+01]
Stock Position:  0.027329890153487968
Bond Position:  [13.52648065]


portfolio before change:  [16.50923638]
curr_Stock_Price:  108.89142937507982
curr_Factors:  [1.08891429e+02 3.87958997e-02]
mat_Sqrt:  [[ 2.14479907e+01  0.00000000e+00]
 [-7.87866991e-03  1.80523006e-02]]
grads:  [-2.87705998e-03 -3.46909024e+01]
Stock Position:  -0.0028770599761696923
Bond Position:  [16.82252355]


portfolio before change:  [16.50519495]
curr_Stock_Price:  113.22043008214949
curr_Factors:  [1.13220430e+02 3.82616569e-02]
mat_Sqrt:  [[ 2.21465809e+01  0.00000000e+00]
 [-7.82423485e-03  1.79275742e-02]]
grads:  [ 1.09631600e-03 -2.09145314e+00]
Stock Position:  0.001096316002852744
Bond Position:  [16.38106958]


portfolio before change:  [16.51006125]
curr_Stock_Price:  110.18637151548964
curr_Factors:  [1.10186372e+02 3.84825552e-02]
mat_Sqrt:  [[ 2.16152286e+01  0.00000000e+00]
 [-7.84678841e-03  1.79792509e-02]]
grads:  [ 4.18195506e-03 -2.41539780e+01]
Stock Position:  0.004181955060543216
Bond Position:  [16.04926679]


portfolio before change:  [16.51260175]
curr_Stock_Price:  108.87451274676741
curr_Factors:  [1.08874513e+02 3.81020695e-02]
mat_Sqrt:  [[ 2.12520342e+01  0.00000000e+00]
 [-7.80790057e-03  1.78901477e-02]]
grads:  [3.30927756e-03 1.53348507e+01]
Stock Position:  0.0033092775624929214
Bond Position:  [16.15230577]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.51891648]
Stock Price:  108.3416336796793
PL:  [8.1772828]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.85710808e-01  1.79743676e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.88793791e-02  8.79268777e-03]
 [-1.19240497e-01 -4.72563136e-01]
 [ 7.95247021e-02  2.78109070e-01]
 [ 1.62259073e-01 -6.74067770e-01]
 [-4.33152841e-01  8.23655630e-03]
 [ 2.06861301e-01 -3.18697320e-01]
 [-4.51948164e-02  2.33549392e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.07090203]
curr_Stock_Price:  96.91127616083392
curr_Factors:  [9.69112762e+01 3.90268396e-02]
mat_Sqrt:  [[ 1.91450279e+01  0.00000000e+00]
 [-7.90208475e-03  1.81059508e-02]]
grads:  [-0.04738903  9.927326  ]
Stock Position:  -0.047389026542602825
Bond Position:  [-13.47837099]


portfolio before change:  [-18.27595196]
curr_Stock_Price:  101.09598028412765
curr_Factors:  [1.01095980e+02 3.99040614e-02]
mat_Sqrt:  [[ 2.01949340e+01  0.00000000e+00]
 [-7.99040038e-03  1.83083073e-02]]
grads:  [ 0.00465264 -2.5822711 ]
Stock Position:  0.004652635713101077
Bond Position:  [-18.74631472]


portfolio before change:  [-18.27243019]
curr_Stock_Price:  103.86801398265828
curr_Factors:  [1.03868014e+02 4.34374624e-02]
mat_Sqrt:  [[ 2.16478141e+01  0.00000000e+00]
 [-8.33666239e-03  1.91016932e-02]]
grads:  [-0.00439037  0.46030934]
Stock Position:  -0.004390371004937033
Bond Position:  [-17.81641108]


portfolio before change:  [-18.28768789]
curr_Stock_Price:  105.3137387075249
curr_Factors:  [1.05313739e+02 4.21466224e-02]
mat_Sqrt:  [[ 2.16205341e+01  0.00000000e+00]
 [-8.21185702e-03  1.88157282e-02]]
grads:  [-1.50543902e-02 -2.51153254e+01]
Stock Position:  -0.015054390234788634
Bond Position:  [-16.70225378]


portfolio before change:  [-18.25176713]
curr_Stock_Price:  102.37280366672472
curr_Factors:  [1.02372804e+02 4.11112502e-02]
mat_Sqrt:  [[ 2.07570169e+01  0.00000000e+00]
 [-8.11036376e-03  1.85831779e-02]]
grads:  [9.67872464e-03 1.49656357e+01]
Stock Position:  0.009678724642357197
Bond Position:  [-19.2426053]


portfolio before change:  [-18.22603943]
curr_Stock_Price:  106.02528965144474
curr_Factors:  [1.06025290e+02 3.96667932e-02]
mat_Sqrt:  [[ 2.11165524e+01  0.00000000e+00]
 [-7.96660964e-03  1.82537958e-02]]
grads:  [-6.24762122e-03 -3.69275397e+01]
Stock Position:  -0.006247621221912006
Bond Position:  [-17.56363358]


portfolio before change:  [-18.23935887]
curr_Stock_Price:  106.75123459640571
curr_Factors:  [1.06751235e+02 3.95057339e-02]
mat_Sqrt:  [[ 2.12179281e+01  0.00000000e+00]
 [-7.95041976e-03  1.82167002e-02]]
grads:  [-0.02024505  0.45214316]
Stock Position:  -0.02024505459852591
Bond Position:  [-16.0781743]


portfolio before change:  [-18.27685121]
curr_Stock_Price:  108.20597228104253
curr_Factors:  [1.08205972e+02 4.16636659e-02]
mat_Sqrt:  [[ 2.20866562e+01  0.00000000e+00]
 [-8.16467179e-03  1.87076133e-02]]
grads:  [ 3.06838605e-03 -1.70357017e+01]
Stock Position:  0.0030683860457666598
Bond Position:  [-18.60886891]


portfolio before change:  [-18.28802656]
curr_Stock_Price:  107.59699271888142
curr_Factors:  [1.07596993e+02 4.30488521e-02]
mat_Sqrt:  [[ 2.23244579e+01  0.00000000e+00]
 [-8.29928692e-03  1.90160553e-02]]
grads:  [2.54136047e-03 1.22816951e+01]
Stock Position:  0.0025413604742066448
Bond Position:  [-18.5614693]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.29990429]
Stock Price:  106.57601464656886
PL:  [-24.87591893]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-8.29376376e-01  2.86780476e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.18529070e-01  7.36581894e-02]
 [-1.61637279e-01 -4.15090866e-01]
 [ 2.87827332e-02  1.24820045e-01]
 [ 3.63243181e-01 -7.10139836e-01]
 [-6.00377547e-01  7.14191100e-02]
 [-1.74320760e-02  2.82533131e-02]
 [-2.69522639e-02  3.76431203e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.18199067]
curr_Stock_Price:  97.94882913233224
curr_Factors:  [9.79488291e+01 4.15258544e-02]
mat_Sqrt:  [[ 1.99599081e+01  0.00000000e+00]
 [-8.15115740e-03  1.86766479e-02]]
grads:  [-0.03528148 15.35502933]
Stock Position:  -0.035281480848481483
Bond Position:  [-7.72621093]


portfolio before change:  [-11.19623898]
curr_Stock_Price:  98.24315465649437
curr_Factors:  [9.82431547e+01 4.26583103e-02]
mat_Sqrt:  [[ 2.02910315e+01  0.00000000e+00]
 [-8.26155533e-03  1.89296013e-02]]
grads:  [ 0.0046306  -2.49751762]
Stock Position:  0.00463060102280404
Bond Position:  [-11.65116383]


portfolio before change:  [-11.19946102]
curr_Stock_Price:  98.80571560284586
curr_Factors:  [9.88057156e+01 4.20337061e-02]
mat_Sqrt:  [[ 2.02572697e+01  0.00000000e+00]
 [-8.20084933e-03  1.87905064e-02]]
grads:  [0.00743813 3.9199683 ]
Stock Position:  0.007438126742464764
Bond Position:  [-11.93439046]


portfolio before change:  [-11.19742585]
curr_Stock_Price:  99.88177376364379
curr_Factors:  [9.98817738e+01 4.61397010e-02]
mat_Sqrt:  [[ 2.14547587e+01  0.00000000e+00]
 [-8.59206155e-03  1.96868862e-02]]
grads:  [-1.59777041e-02 -2.10846379e+01]
Stock Position:  -0.015977704055020903
Bond Position:  [-9.60154443]


portfolio before change:  [-11.20908439]
curr_Stock_Price:  100.31090712849037
curr_Factors:  [1.00310907e+02 4.35339900e-02]
mat_Sqrt:  [[ 2.09296707e+01  0.00000000e+00]
 [-8.34592020e-03  1.91229055e-02]]
grads:  [3.97802089e-03 6.52725315e+00]
Stock Position:  0.0039780208920444605
Bond Position:  [-11.60812328]


portfolio before change:  [-11.21521214]
curr_Stock_Price:  100.22990394282913
curr_Factors:  [1.00229904e+02 4.32318762e-02]
mat_Sqrt:  [[ 2.08400788e+01  0.00000000e+00]
 [-8.31691060e-03  1.90564362e-02]]
grads:  [ 2.55818360e-03 -3.72650914e+01]
Stock Position:  0.0025581836049220256
Bond Position:  [-11.47161863]


portfolio before change:  [-11.21063641]
curr_Stock_Price:  104.26126986133582
curr_Factors:  [1.04261270e+02 4.15924213e-02]
mat_Sqrt:  [[ 2.12632728e+01  0.00000000e+00]
 [-8.15768804e-03  1.86916115e-02]]
grads:  [-0.02676952  3.82091775]
Stock Position:  -0.026769523971651034
Bond Position:  [-8.41961184]


portfolio before change:  [-11.14971846]
curr_Stock_Price:  101.82832399509714
curr_Factors:  [1.01828324e+02 4.36361531e-02]
mat_Sqrt:  [[ 2.12711918e+01  0.00000000e+00]
 [-8.35570733e-03  1.91453307e-02]]
grads:  [-2.39822918e-04  1.47572866e+00]
Stock Position:  -0.00023982291836505734
Bond Position:  [-11.1252977]


portfolio before change:  [-11.15522339]
curr_Stock_Price:  101.58184038844001
curr_Factors:  [1.01581840e+02 4.18650438e-02]
mat_Sqrt:  [[ 2.07846086e+01  0.00000000e+00]
 [-8.18437964e-03  1.87527696e-02]]
grads:  [-5.06310199e-04  2.00733658e+00]
Stock Position:  -0.0005063101993728257
Bond Position:  [-11.10379147]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.16159521]
Stock Price:  103.1985047563612
PL:  [-14.36009996]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.15358611e-01  2.94393891e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 8.84657061e-02  6.10448573e-02]
 [-1.38955095e-01 -4.44092070e-01]
 [ 2.78300815e-02  1.22347496e-01]
 [ 3.33251081e-01 -6.15796880e-01]
 [-6.80063286e-01  1.01528865e-01]
 [-1.25309012e-02  3.27250213e-02]
 [-2.93522485e-02  8.16677097e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.69172949]
curr_Stock_Price:  99.88776634618148
curr_Factors:  [9.98877663e+01 4.00790403e-02]
mat_Sqrt:  [[ 1.99972814e+01  0.00000000e+00]
 [-8.00790013e-03  1.83484042e-02]]
grads:  [-9.34499943e-03  1.60446591e+01]
Stock Position:  -0.00934499943086973
Bond Position:  [2.62518061]


portfolio before change:  [1.70382566]
curr_Stock_Price:  98.73386008457719
curr_Factors:  [9.87338601e+01 3.83888228e-02]
mat_Sqrt:  [[ 1.93449902e+01  0.00000000e+00]
 [-7.83722633e-03  1.79573414e-02]]
grads:  [ 0.00485705 -2.6327401 ]
Stock Position:  0.004857054467466598
Bond Position:  [1.22426992]


portfolio before change:  [1.70732134]
curr_Stock_Price:  99.32751007066945
curr_Factors:  [9.93275101e+01 3.35314860e-02]
mat_Sqrt:  [[ 1.81884608e+01  0.00000000e+00]
 [-7.32464180e-03  1.67828627e-02]]
grads:  [0.00632862 3.63733281]
Stock Position:  0.006328620509317292
Bond Position:  [1.07871522]


portfolio before change:  [1.70202494]
curr_Stock_Price:  98.4053679733662
curr_Factors:  [9.8405368e+01 3.6482210e-02]
mat_Sqrt:  [[ 1.87957370e+01  0.00000000e+00]
 [-7.64012670e-03  1.75057295e-02]]
grads:  [-1.77046936e-02 -2.53683841e+01]
Stock Position:  -0.0177046935718444
Bond Position:  [3.44426183]


portfolio before change:  [1.67086032]
curr_Stock_Price:  100.26290817841262
curr_Factors:  [1.00262908e+02 3.37600254e-02]
mat_Sqrt:  [[ 1.84222079e+01  0.00000000e+00]
 [-7.34956058e-03  1.68399588e-02]]
grads:  [4.40918411e-03 7.26530853e+00]
Stock Position:  0.004409184114547551
Bond Position:  [1.2287827]


portfolio before change:  [1.67750473]
curr_Stock_Price:  101.63047672578654
curr_Factors:  [1.01630477e+02 3.19436877e-02]
mat_Sqrt:  [[ 1.81642089e+01  0.00000000e+00]
 [-7.14911885e-03  1.63806891e-02]]
grads:  [ 3.55067977e-03 -3.75928555e+01]
Stock Position:  0.003550679768629969
Bond Position:  [1.31664745]


portfolio before change:  [1.68337415]
curr_Stock_Price:  103.09806276398345
curr_Factors:  [1.03098063e+02 3.30061105e-02]
mat_Sqrt:  [[ 1.87304271e+01  0.00000000e+00]
 [-7.26703356e-03  1.66508657e-02]]
grads:  [-0.03394223  6.09751268]
Stock Position:  -0.03394222964608852
Bond Position:  [5.18275227]


portfolio before change:  [1.71737051]
curr_Stock_Price:  102.1728336871764
curr_Factors:  [1.02172834e+02 3.43602515e-02]
mat_Sqrt:  [[ 1.89392861e+01  0.00000000e+00]
 [-7.41460737e-03  1.69889998e-02]]
grads:  [9.24780911e-05 1.92624768e+00]
Stock Position:  9.24780911413807e-05
Bond Position:  [1.70792176]


portfolio before change:  [1.71828822]
curr_Stock_Price:  102.85987394617851
curr_Factors:  [1.02859874e+02 3.41530828e-02]
mat_Sqrt:  [[ 1.90090732e+01  0.00000000e+00]
 [-7.39222108e-03  1.69377063e-02]]
grads:  [3.30918925e-04 4.82165106e+00]
Stock Position:  0.00033091892535395436
Bond Position:  [1.68424994]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.71884048]
Stock Price:  101.9832939640043
PL:  [-0.26445349]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.92103389e-01  1.71861715e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 1.70663802e-02 -5.50379954e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.31701008e-01 -1.24176048e+00]
 [-1.06651389e+00  2.67413113e-01]
 [-6.65508047e-02 -5.37075533e-03]
 [-2.90540672e-02  1.45130634e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.40403075]
curr_Stock_Price:  96.86110296553909
curr_Factors:  [9.6861103e+01 4.2290823e-02]
mat_Sqrt:  [[ 1.99192269e+01  0.00000000e+00]
 [-8.22589307e-03  1.88478888e-02]]
grads:  [-0.04604078  9.1183536 ]
Stock Position:  -0.0460407822581287
Bond Position:  [-13.9444698]


portfolio before change:  [-18.38128707]
curr_Stock_Price:  96.21563903740496
curr_Factors:  [9.62156390e+01 4.06230922e-02]
mat_Sqrt:  [[ 1.93924267e+01  0.00000000e+00]
 [-8.06206844e-03  1.84725194e-02]]
grads:  [ 0.00484517 -2.55931591]
Stock Position:  0.00484517345804153
Bond Position:  [-18.84746853]


portfolio before change:  [-18.39133745]
curr_Stock_Price:  96.08679095699974
curr_Factors:  [9.60867910e+01 4.40618146e-02]
mat_Sqrt:  [[ 2.01694882e+01  0.00000000e+00]
 [-8.39636251e-03  1.92384834e-02]]
grads:  [ 0.01996908 10.13099063]
Stock Position:  0.01996908285405563
Bond Position:  [-20.31010254]


portfolio before change:  [-18.45930129]
curr_Stock_Price:  93.19200364033019
curr_Factors:  [9.31920036e+01 4.49956549e-02]
mat_Sqrt:  [[ 1.97680549e+01  0.00000000e+00]
 [-8.48487171e-03  1.94412834e-02]]
grads:  [-1.12878645e-02 -2.83098570e+01]
Stock Position:  -0.011287864485383804
Bond Position:  [-17.40736258]


portfolio before change:  [-18.48293053]
curr_Stock_Price:  94.51407721443968
curr_Factors:  [9.45140772e+01 4.58846712e-02]
mat_Sqrt:  [[ 2.02455841e+01  0.00000000e+00]
 [-8.56828302e-03  1.96324028e-02]]
grads:  [-3.48062074e-03 -4.33950944e+00]
Stock Position:  -0.003480620736860414
Bond Position:  [-18.15396287]


portfolio before change:  [-18.49433359]
curr_Stock_Price:  95.18171851342947
curr_Factors:  [9.51817185e+01 4.49684730e-02]
mat_Sqrt:  [[ 2.01840174e+01  0.00000000e+00]
 [-8.48230846e-03  1.94354103e-02]]
grads:  [-5.46212836e-03 -6.38916522e+01]
Stock Position:  -0.005462128356484075
Bond Position:  [-17.97443883]


portfolio before change:  [-18.51012976]
curr_Stock_Price:  96.42788280356814
curr_Factors:  [9.64278828e+01 4.57728105e-02]
mat_Sqrt:  [[ 2.06303417e+01  0.00000000e+00]
 [-8.55783248e-03  1.96084576e-02]]
grads:  [-0.04603924 13.63764141]
Stock Position:  -0.046039239399557536
Bond Position:  [-14.07066338]


portfolio before change:  [-18.60249171]
curr_Stock_Price:  98.28119007760108
curr_Factors:  [9.82811901e+01 4.40636844e-02]
mat_Sqrt:  [[ 2.06305502e+01  0.00000000e+00]
 [-8.39654066e-03  1.92388916e-02]]
grads:  [-0.00333946 -0.27916137]
Stock Position:  -0.003339455021915884
Bond Position:  [-18.2742861]


portfolio before change:  [-18.61864334]
curr_Stock_Price:  100.38099406264831
curr_Factors:  [1.00380994e+02 4.31139117e-02]
mat_Sqrt:  [[ 2.08429989e+01  0.00000000e+00]
 [-8.30555589e-03  1.90304193e-02]]
grads:  [-0.00109006  0.76262447]
Stock Position:  -0.0010900565285639912
Bond Position:  [-18.50922238]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.62862476]
Stock Price:  101.04563542562839
PL:  [-19.67426019]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.04596332e+00  9.53353173e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.05457195e-02  3.96431629e-02]
 [-1.60067625e-01 -4.14684911e-01]
 [-2.29808616e-02 -3.38731152e-02]
 [ 4.05829401e-01 -9.71002412e-01]
 [-9.73875153e-01  3.01468201e-01]
 [-3.82343398e-02  2.47381226e-02]
 [-2.85092477e-02 -1.78342737e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.88246596]
curr_Stock_Price:  96.33720875419837
curr_Factors:  [9.63372088e+01 4.46723850e-02]
mat_Sqrt:  [[ 2.03616810e+01  0.00000000e+00]
 [-8.45433711e-03  1.93713199e-02]]
grads:  [-0.04932577  4.92146729]
Stock Position:  -0.04932576911142056
Bond Position:  [-17.13055904]


portfolio before change:  [-21.95627981]
curr_Stock_Price:  97.6599742550182
curr_Factors:  [9.76599743e+01 4.20576025e-02]
mat_Sqrt:  [[ 2.00280590e+01  0.00000000e+00]
 [-8.20318011e-03  1.87958469e-02]]
grads:  [ 0.0046914  -2.51529038]
Stock Position:  0.004691401756435323
Bond Position:  [-22.41444198]


portfolio before change:  [-21.9537007]
curr_Stock_Price:  100.59920960214849
curr_Factors:  [1.00599210e+02 3.81977809e-02]
mat_Sqrt:  [[ 1.96613636e+01  0.00000000e+00]
 [-7.81770103e-03  1.79126034e-02]]
grads:  [1.41635213e-03 2.21314356e+00]
Stock Position:  0.0014163521287187968
Bond Position:  [-22.0961846]


portfolio before change:  [-21.9658985]
curr_Stock_Price:  99.78941740345104
curr_Factors:  [9.97894174e+01 3.87216085e-02]
mat_Sqrt:  [[ 1.96363689e+01  0.00000000e+00]
 [-7.87112276e-03  1.80350079e-02]]
grads:  [-1.73683312e-02 -2.29933312e+01]
Stock Position:  -0.017368331157255595
Bond Position:  [-20.23272285]


portfolio before change:  [-21.95360231]
curr_Stock_Price:  98.49884513592585
curr_Factors:  [9.84988451e+01 3.80860367e-02]
mat_Sqrt:  [[ 1.92226841e+01  0.00000000e+00]
 [-7.80625767e-03  1.78863833e-02]]
grads:  [-0.00196457 -1.89379343]
Stock Position:  -0.0019645696128730394
Bond Position:  [-21.76009447]


portfolio before change:  [-21.96272688]
curr_Stock_Price:  97.60389674230623
curr_Factors:  [9.76038967e+01 4.09182989e-02]
mat_Sqrt:  [[ 1.97435817e+01  0.00000000e+00]
 [-8.09130881e-03  1.85395175e-02]]
grads:  [-9.09196452e-04 -5.23747401e+01]
Stock Position:  -0.0009091964522278774
Bond Position:  [-21.87398577]


portfolio before change:  [-21.97023059]
curr_Stock_Price:  93.82471533492817
curr_Factors:  [9.38247153e+01 4.68311141e-02]
mat_Sqrt:  [[ 2.03041354e+01  0.00000000e+00]
 [-8.65619908e-03  1.98338438e-02]]
grads:  [-0.04148434 15.1996862 ]
Stock Position:  -0.041484339421818145
Bond Position:  [-18.07797426]


portfolio before change:  [-22.08479754]
curr_Stock_Price:  96.36846312986913
curr_Factors:  [9.63684631e+01 4.25295319e-02]
mat_Sqrt:  [[ 1.98737689e+01  0.00000000e+00]
 [-8.24907577e-03  1.89010071e-02]]
grads:  [-0.0013806   1.30882563]
Stock Position:  -0.0013806006356059356
Bond Position:  [-21.95175118]


portfolio before change:  [-22.0941446]
curr_Stock_Price:  95.18668612974994
curr_Factors:  [9.51866861e+01 4.14598839e-02]
mat_Sqrt:  [[ 1.93816278e+01  0.00000000e+00]
 [-8.14468012e-03  1.86618066e-02]]
grads:  [-5.48686625e-03 -9.55656336e+00]
Stock Position:  -0.005486866252692122
Bond Position:  [-21.57186798]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.11280048]
Stock Price:  96.62052017958659
PL:  [-22.11280048]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 6.43243588e-02  3.08021054e-02]
 [ 1.63892401e-02  2.30961052e-01]
 [-9.91016969e-02  7.20999601e-03]
 [-1.27053453e-01 -4.65654176e-01]
 [ 3.72036937e-02  1.49213878e-01]
 [ 3.21587730e-01 -5.95784420e-01]
 [-7.70844428e-01  1.35827386e-01]
 [-1.34224217e-02  3.23650141e-02]
 [-2.93167964e-02  1.40818187e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.97221945]
curr_Stock_Price:  102.0385800262439
curr_Factors:  [1.02038580e+02 4.06470458e-02]
mat_Sqrt:  [[ 2.05721129e+01  0.00000000e+00]
 [-8.06444501e-03  1.84779648e-02]]
grads:  [0.00378024 1.66696418]
Stock Position:  0.0037802388102223944
Bond Position:  [15.58648925]


portfolio before change:  [15.9818778]
curr_Stock_Price:  102.53144691843873
curr_Factors:  [1.02531447e+02 4.21496325e-02]
mat_Sqrt:  [[ 2.10500912e+01  0.00000000e+00]
 [-8.21215027e-03  1.88164001e-02]]
grads:  [5.56714486e-03 1.22744548e+01]
Stock Position:  0.00556714486076196
Bond Position:  [15.41107038]


portfolio before change:  [15.99183757]
curr_Stock_Price:  102.93601880709811
curr_Factors:  [1.02936019e+02 4.15760815e-02]
mat_Sqrt:  [[ 2.09888742e+01  0.00000000e+00]
 [-8.15608548e-03  1.86879396e-02]]
grads:  [-0.00457171  0.38581011]
Stock Position:  -0.0045717076404723144
Bond Position:  [16.46243096]


portfolio before change:  [15.99206111]
curr_Stock_Price:  104.68804264063475
curr_Factors:  [1.04688043e+02 4.21848013e-02]
mat_Sqrt:  [[ 2.15018132e+01  0.00000000e+00]
 [-8.21557558e-03  1.88242485e-02]]
grads:  [-1.53606393e-02 -2.47369331e+01]
Stock Position:  -0.015360639315589304
Bond Position:  [17.60013637]


portfolio before change:  [16.06264888]
curr_Stock_Price:  100.66571627728976
curr_Factors:  [1.00665716e+02 4.40878409e-02]
mat_Sqrt:  [[ 2.11368859e+01  0.00000000e+00]
 [-8.39884191e-03  1.92441644e-02]]
grads:  [4.84110902e-03 7.75372083e+00]
Stock Position:  0.004841109024086589
Bond Position:  [15.57531517]


portfolio before change:  [16.07652432]
curr_Stock_Price:  101.92283329949703
curr_Factors:  [1.01922833e+02 4.17905470e-02]
mat_Sqrt:  [[ 2.08358161e+01  0.00000000e+00]
 [-8.17709455e-03  1.87360774e-02]]
grads:  [ 2.95482026e-03 -3.17987809e+01]
Stock Position:  0.0029548202637755864
Bond Position:  [15.77536067]


portfolio before change:  [16.08384788]
curr_Stock_Price:  101.73124897030792
curr_Factors:  [1.01731249e+02 4.03409629e-02]
mat_Sqrt:  [[ 2.04327822e+01  0.00000000e+00]
 [-8.03402393e-03  1.84082614e-02]]
grads:  [-0.03482465  7.37861024]
Stock Position:  -0.03482465037577024
Bond Position:  [19.62660306]


portfolio before change:  [16.08502929]
curr_Stock_Price:  101.97918659015689
curr_Factors:  [1.01979187e+02 4.30696247e-02]
mat_Sqrt:  [[ 2.11639676e+01  0.00000000e+00]
 [-8.30128903e-03  1.90206427e-02]]
grads:  [3.32087284e-05 1.70157311e+00]
Stock Position:  3.320872841627409e-05
Bond Position:  [16.0816427]


portfolio before change:  [16.0930166]
curr_Stock_Price:  100.30708311234307
curr_Factors:  [1.00307083e+02 4.59531368e-02]
mat_Sqrt:  [[ 2.15025112e+01  0.00000000e+00]
 [-8.57467311e-03  1.96470443e-02]]
grads:  [-0.00107759  0.71673981]
Stock Position:  -0.0010775944554901721
Bond Position:  [16.20110695]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.10044547]
Stock Price:  100.93227435923924
PL:  [15.16817111]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.81546146e-01 -2.99785607e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.62869363e-01  1.66553698e-01]
 [-1.63695696e-01 -4.09778908e-01]
 [ 8.14447192e-02  2.83786723e-01]
 [ 3.69131214e-01 -7.28661194e-01]
 [-8.56418436e-01  1.73792446e-01]
 [ 3.90708688e-02 -5.01171513e-02]
 [-3.32958207e-02  1.18832536e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.66107745]
curr_Stock_Price:  102.89539051571634
curr_Factors:  [1.02895391e+02 4.32237793e-02]
mat_Sqrt:  [[ 2.13922905e+01  0.00000000e+00]
 [-8.31613173e-03  1.90546516e-02]]
grads:  [ 1.17195950e-02 -1.57329357e+01]
Stock Position:  0.011719594990237735
Bond Position:  [20.45518514]


portfolio before change:  [21.649652]
curr_Stock_Price:  101.04757974550223
curr_Factors:  [1.01047580e+02 4.73133837e-02]
mat_Sqrt:  [[ 2.19795056e+01  0.00000000e+00]
 [-8.70065595e-03  1.99357072e-02]]
grads:  [ 0.00427488 -2.37147407]
Stock Position:  0.004274876448331438
Bond Position:  [21.21768608]


portfolio before change:  [21.64509507]
curr_Stock_Price:  97.4993058235055
curr_Factors:  [9.74993058e+01 5.27616672e-02]
mat_Sqrt:  [[ 2.23955008e+01  0.00000000e+00]
 [-9.18796318e-03  2.10522684e-02]]
grads:  [0.01498334 7.91143714]
Stock Position:  0.014983337911668117
Bond Position:  [20.18423002]


portfolio before change:  [21.70098434]
curr_Stock_Price:  100.55567640767178
curr_Factors:  [1.00555676e+02 5.32854224e-02]
mat_Sqrt:  [[ 2.32119057e+01  0.00000000e+00]
 [-9.23345417e-03  2.11565013e-02]]
grads:  [-1.47569905e-02 -1.93689354e+01]
Stock Position:  -0.014756990527159368
Bond Position:  [23.1848835]


portfolio before change:  [21.68451132]
curr_Stock_Price:  102.45771459122116
curr_Factors:  [1.02457715e+02 5.27682240e-02]
mat_Sqrt:  [[ 2.35359050e+01  0.00000000e+00]
 [-9.18853407e-03  2.10535765e-02]]
grads:  [8.72281728e-03 1.34792644e+01]
Stock Position:  0.008722817283518492
Bond Position:  [20.7907914]


portfolio before change:  [21.67222699]
curr_Stock_Price:  99.85737113826826
curr_Factors:  [9.98573711e+01 5.34936777e-02]
mat_Sqrt:  [[ 2.30957121e+01  0.00000000e+00]
 [-9.25148012e-03  2.11978040e-02]]
grads:  [ 2.21328519e-03 -3.43743718e+01]
Stock Position:  0.002213285185765085
Bond Position:  [21.45121415]


portfolio before change:  [21.68416464]
curr_Stock_Price:  100.40378082968515
curr_Factors:  [1.00403781e+02 5.08787888e-02]
mat_Sqrt:  [[ 2.26474051e+01  0.00000000e+00]
 [-9.02253080e-03  2.06732152e-02]]
grads:  [-0.03446616  8.40664814]
Stock Position:  -0.034466164680088236
Bond Position:  [25.14469789]


portfolio before change:  [21.58527034]
curr_Stock_Price:  103.637961189553
curr_Factors:  [1.03637961e+02 4.78628151e-02]
mat_Sqrt:  [[ 2.26734694e+01  0.00000000e+00]
 [-8.75102875e-03  2.00511258e-02]]
grads:  [ 7.58505476e-04 -2.49946820e+00]
Stock Position:  0.0007585054762647991
Bond Position:  [21.50666038]


portfolio before change:  [21.59630964]
curr_Stock_Price:  104.01143399285529
curr_Factors:  [1.04011434e+02 4.70541744e-02]
mat_Sqrt:  [[ 2.25621334e+01  0.00000000e+00]
 [-8.67678967e-03  1.98810227e-02]]
grads:  [8.22925284e-04 5.97718427e+00]
Stock Position:  0.0008229252835650433
Bond Position:  [21.510716]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.60500731]
Stock Price:  101.50770827504913
PL:  [20.09729904]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.35409531e-01  2.79451588e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 9.00511357e-02  5.77582611e-02]
 [-1.61489720e-01 -4.15081693e-01]
 [-3.46411878e-02 -8.13572670e-02]
 [ 4.31261776e-01 -1.22478703e+00]
 [-1.02976683e+00  2.79828500e-01]
 [-3.06635765e-02  3.14701820e-02]
 [-3.67068604e-02  4.98166636e-04]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.81891216]
curr_Stock_Price:  99.35902145745065
curr_Factors:  [9.93590215e+01 3.98018164e-02]
mat_Sqrt:  [[ 1.98225148e+01  0.00000000e+00]
 [-7.98015703e-03  1.82848368e-02]]
grads:  [-0.01581267 15.2832421 ]
Stock Position:  -0.01581266863096303
Bond Position:  [-0.24778088]


portfolio before change:  [-1.85560521]
curr_Stock_Price:  101.67166876517045
curr_Factors:  [1.01671669e+02 4.04639881e-02]
mat_Sqrt:  [[ 2.04519298e+01  0.00000000e+00]
 [-8.04626503e-03  1.84363093e-02]]
grads:  [ 0.00459417 -2.56434258]
Stock Position:  0.0045941713966798645
Bond Position:  [-2.32270228]


portfolio before change:  [-1.86833755]
curr_Stock_Price:  99.15310772174848
curr_Factors:  [9.91531077e+01 4.16872266e-02]
mat_Sqrt:  [[ 2.02445362e+01  0.00000000e+00]
 [-8.16698001e-03  1.87129020e-02]]
grads:  [0.00569333 3.0865475 ]
Stock Position:  0.005693334054658487
Bond Position:  [-2.43284931]


portfolio before change:  [-1.86551621]
curr_Stock_Price:  99.86236973776153
curr_Factors:  [9.98623697e+01 4.16706541e-02]
mat_Sqrt:  [[ 2.03852962e+01  0.00000000e+00]
 [-8.16535648e-03  1.87091821e-02]]
grads:  [-1.68084986e-02 -2.21859882e+01]
Stock Position:  -0.016808498595756876
Bond Position:  [-0.18697971]


portfolio before change:  [-1.83448497]
curr_Stock_Price:  98.0106425569797
curr_Factors:  [9.80106426e+01 4.01377038e-02]
mat_Sqrt:  [[ 1.96358406e+01  0.00000000e+00]
 [-8.01375855e-03  1.83618276e-02]]
grads:  [-3.57246789e-03 -4.43078265e+00]
Stock Position:  -0.003572467889363658
Bond Position:  [-1.4843451]


portfolio before change:  [-1.82583689]
curr_Stock_Price:  95.38208393617339
curr_Factors:  [9.53820839e+01 3.86829188e-02]
mat_Sqrt:  [[ 1.87597232e+01  0.00000000e+00]
 [-7.86718947e-03  1.80259956e-02]]
grads:  [-5.50536422e-03 -6.79455970e+01]
Stock Position:  -0.005505364215149308
Bond Position:  [-1.30072378]


portfolio before change:  [-1.82691454]
curr_Stock_Price:  95.4596682083459
curr_Factors:  [9.54596682e+01 3.81536453e-02]
mat_Sqrt:  [[ 1.86460970e+01  0.00000000e+00]
 [-7.81318325e-03  1.79022518e-02]]
grads:  [-0.04867719 15.63091071]
Stock Position:  -0.04867719258779991
Bond Position:  [2.81979411]


portfolio before change:  [-1.84017148]
curr_Stock_Price:  95.76098364450979
curr_Factors:  [9.57609836e+01 3.87415267e-02]
mat_Sqrt:  [[ 1.88485074e+01  0.00000000e+00]
 [-7.87314693e-03  1.80396459e-02]]
grads:  [-8.98154042e-04  1.74450109e+00]
Stock Position:  -0.0008981540420027996
Bond Position:  [-1.75416337]


portfolio before change:  [-1.84331978]
curr_Stock_Price:  98.2894995351213
curr_Factors:  [9.82894995e+01 3.56482169e-02]
mat_Sqrt:  [[ 1.85577803e+01  0.00000000e+00]
 [-7.55229416e-03  1.73044798e-02]]
grads:  [-0.00196626  0.0287883 ]
Stock Position:  -0.001966261158094562
Bond Position:  [-1.65005695]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.85025439]
Stock Price:  101.39660422200072
PL:  [-3.24685862]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.28364360e-01  2.83766202e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.29036908e-03  3.14621895e-02]
 [-1.30206570e-01 -4.62811722e-01]
 [ 6.86374363e-02  2.44592641e-01]
 [ 3.95268135e-01 -8.68569519e-01]
 [-1.00551175e+00  2.41092796e-01]
 [-9.94657064e-03  5.55923855e-02]
 [-3.66071922e-02 -1.02478722e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.01210475]
curr_Stock_Price:  99.78540667995446
curr_Factors:  [9.97854067e+01 4.01591690e-02]
mat_Sqrt:  [[ 1.99967488e+01  0.00000000e+00]
 [-8.01590110e-03  1.83667368e-02]]
grads:  [-1.02275944e-02  1.54500064e+01]
Stock Position:  -0.010227594441408906
Bond Position:  [2.03266942]


portfolio before change:  [0.99628213]
curr_Stock_Price:  101.43185475900952
curr_Factors:  [1.01431855e+02 4.11448247e-02]
mat_Sqrt:  [[ 2.05746272e+01  0.00000000e+00]
 [-8.11367484e-03  1.85907646e-02]]
grads:  [ 0.00456677 -2.54303758]
Stock Position:  0.0045667739238796305
Bond Position:  [0.53306578]


portfolio before change:  [0.99334278]
curr_Stock_Price:  100.72983784853957
curr_Factors:  [1.00729838e+02 4.24247386e-02]
mat_Sqrt:  [[ 2.07475931e+01  0.00000000e+00]
 [-8.23890659e-03  1.88777065e-02]]
grads:  [2.14041991e-04 1.66663198e+00]
Stock Position:  0.00021404199118313843
Bond Position:  [0.97178237]


portfolio before change:  [0.99462194]
curr_Stock_Price:  104.43541911988976
curr_Factors:  [1.04435419e+02 4.10392249e-02]
mat_Sqrt:  [[ 2.11566737e+01  0.00000000e+00]
 [-8.10325613e-03  1.85668923e-02]]
grads:  [-1.57016253e-02 -2.49267198e+01]
Stock Position:  -0.015701625342867693
Bond Position:  [2.63442777]


portfolio before change:  [1.0351529]
curr_Stock_Price:  101.93800784913316
curr_Factors:  [1.01938008e+02 4.22949117e-02]
mat_Sqrt:  [[ 2.09642922e+01  0.00000000e+00]
 [-8.22629071e-03  1.88487999e-02]]
grads:  [8.36595937e-03 1.29765631e+01]
Stock Position:  0.008365959365951145
Bond Position:  [0.18234367]


portfolio before change:  [1.00638577]
curr_Stock_Price:  98.48851423131863
curr_Factors:  [9.84885142e+01 4.33313181e-02]
mat_Sqrt:  [[ 2.05015424e+01  0.00000000e+00]
 [-8.32647038e-03  1.90783404e-02]]
grads:  [ 7.89858596e-04 -4.55264714e+01]
Stock Position:  0.0007898585960048536
Bond Position:  [0.92859377]


portfolio before change:  [1.00649876]
curr_Stock_Price:  98.04359317692104
curr_Factors:  [9.80435932e+01 4.19207496e-02]
mat_Sqrt:  [[ 2.00739916e+01  0.00000000e+00]
 [-8.18982291e-03  1.87652417e-02]]
grads:  [-0.04484859 12.84783856]
Stock Position:  -0.04484859036887652
Bond Position:  [5.40361571]


portfolio before change:  [1.17411389]
curr_Stock_Price:  94.36649548664587
curr_Factors:  [9.43664955e+01 4.15853671e-02]
mat_Sqrt:  [[ 1.92436787e+01  0.00000000e+00]
 [-8.15699622e-03  1.86900263e-02]]
grads:  [7.43929253e-04 2.97444126e+00]
Stock Position:  0.0007439292526335747
Bond Position:  [1.1039119]


portfolio before change:  [1.17616547]
curr_Stock_Price:  96.38212637941041
curr_Factors:  [9.63821264e+01 3.92155177e-02]
mat_Sqrt:  [[ 1.90864641e+01  0.00000000e+00]
 [-7.92116332e-03  1.81496653e-02]]
grads:  [-4.26126981e-03 -5.64631471e+00]
Stock Position:  -0.004261269806030199
Bond Position:  [1.58687572]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.16673415]
Stock Price:  98.78163650453688
PL:  [1.16673415]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.07557689e-01  3.25626903e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.97145843e-02  5.76787964e-02]
 [-1.29995516e-01 -4.69428485e-01]
 [-8.21108417e-03  1.24248370e-02]
 [ 3.94793213e-01 -8.58454328e-01]
 [-9.83647292e-01  2.33560091e-01]
 [-7.00881082e-02 -7.71820109e-03]
 [-3.68257910e-02 -1.72569926e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.55287071]
curr_Stock_Price:  100.92113679965522
curr_Factors:  [1.00921137e+02 4.06237211e-02]
mat_Sqrt:  [[ 2.03409852e+01  0.00000000e+00]
 [-8.06213084e-03  1.84726624e-02]]
grads:  [-3.21727081e-03  1.76275025e+01]
Stock Position:  -0.003217270807677294
Bond Position:  [8.87756133]


portfolio before change:  [8.56058333]
curr_Stock_Price:  99.90389810631727
curr_Factors:  [9.99038981e+01 3.84866797e-02]
mat_Sqrt:  [[ 1.95991690e+01  0.00000000e+00]
 [-7.84720890e-03  1.79802144e-02]]
grads:  [ 0.00479406 -2.62939094]
Stock Position:  0.004794064033559382
Bond Position:  [8.08163764]


portfolio before change:  [8.56264138]
curr_Stock_Price:  99.49010025675737
curr_Factors:  [9.94901003e+01 3.74569921e-02]
mat_Sqrt:  [[ 1.92551239e+01  0.00000000e+00]
 [-7.74152358e-03  1.77380589e-02]]
grads:  [0.00544726 3.2516972 ]
Stock Position:  0.005447260439758996
Bond Position:  [8.0206929]


portfolio before change:  [8.5567862]
curr_Stock_Price:  97.67881679494822
curr_Factors:  [9.76788168e+01 3.99212160e-02]
mat_Sqrt:  [[ 1.95165151e+01  0.00000000e+00]
 [-7.99211772e-03  1.83122422e-02]]
grads:  [-1.71583350e-02 -2.56346809e+01]
Stock Position:  -0.017158334984338518
Bond Position:  [10.23279206]


portfolio before change:  [8.5390605]
curr_Stock_Price:  99.01014490227242
curr_Factors:  [9.90101449e+01 3.96075496e-02]
mat_Sqrt:  [[ 1.97046481e+01  0.00000000e+00]
 [-7.96065822e-03  1.82401594e-02]]
grads:  [-1.41511827e-04  6.81180284e-01]
Stock Position:  -0.0001415118265848015
Bond Position:  [8.55307161]


portfolio before change:  [8.54339626]
curr_Stock_Price:  98.59917437389751
curr_Factors:  [9.85991744e+01 4.06726837e-02]
mat_Sqrt:  [[ 1.98849587e+01  0.00000000e+00]
 [-8.06698791e-03  1.84837914e-02]]
grads:  [ 1.01247525e-03 -4.64436279e+01]
Stock Position:  0.0010124752494114707
Bond Position:  [8.44356704]


portfolio before change:  [8.5475079]
curr_Stock_Price:  98.48934310073669
curr_Factors:  [9.84893431e+01 3.88567501e-02]
mat_Sqrt:  [[ 1.94143332e+01  0.00000000e+00]
 [-7.88484624e-03  1.80664524e-02]]
grads:  [-0.04541559 12.92783366]
Stock Position:  -0.04541558570192803
Bond Position:  [13.0204591]


portfolio before change:  [8.55361741]
curr_Stock_Price:  98.49820242363283
curr_Factors:  [9.84982024e+01 3.83407923e-02]
mat_Sqrt:  [[ 1.92867409e+01  0.00000000e+00]
 [-7.83232198e-03  1.79461042e-02]]
grads:  [-0.00380866 -0.43007669]
Stock Position:  -0.0038086583783331364
Bond Position:  [8.92876341]


portfolio before change:  [8.56184132]
curr_Stock_Price:  97.51139523979826
curr_Factors:  [9.75113952e+01 3.82168857e-02]
mat_Sqrt:  [[ 1.90626387e+01  0.00000000e+00]
 [-7.81965582e-03  1.79170824e-02]]
grads:  [-0.00232693 -0.96315864]
Stock Position:  -0.0023269265411518395
Bond Position:  [8.78874317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.5735492]
Stock Price:  94.36887369394364
PL:  [8.5735492]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.66007171e-01  2.81951965e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.41053089e-01  1.52513032e-01]
 [-1.42439675e-01 -4.33759473e-01]
 [ 1.17211778e-01  4.39003872e-01]
 [ 2.83540061e-01 -6.16237356e-01]
 [-5.80173594e-01  6.37865319e-02]
 [ 4.55282893e-02 -6.10967902e-02]
 [-2.70654976e-02  4.24846146e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.53963682]
curr_Stock_Price:  99.2504716484897
curr_Factors:  [9.92504716e+01 3.74448468e-02]
mat_Sqrt:  [[ 1.92056322e+01  0.00000000e+00]
 [-7.74026840e-03  1.77351829e-02]]
grads:  [-0.01785691 15.89788875]
Stock Position:  -0.01785690994176616
Bond Position:  [-0.76733008]


portfolio before change:  [-2.51998347]
curr_Stock_Price:  98.12837908966749
curr_Factors:  [9.81283791e+01 3.88201072e-02]
mat_Sqrt:  [[ 1.93340568e+01  0.00000000e+00]
 [-7.88112756e-03  1.80579318e-02]]
grads:  [ 0.0048598  -2.61807462]
Stock Position:  0.004859801122304104
Bond Position:  [-2.99686788]


portfolio before change:  [-2.52357443]
curr_Stock_Price:  97.69787834344133
curr_Factors:  [9.76978783e+01 3.92324279e-02]
mat_Sqrt:  [[ 1.93511921e+01  0.00000000e+00]
 [-7.92287099e-03  1.81535780e-02]]
grads:  [0.01589645 8.40126568]
Stock Position:  0.01589644871858979
Bond Position:  [-4.07662374]


portfolio before change:  [-2.50970389]
curr_Stock_Price:  98.69869031292728
curr_Factors:  [9.86986903e+01 3.70041733e-02]
mat_Sqrt:  [[ 1.89861428e+01  0.00000000e+00]
 [-7.69458753e-03  1.76305149e-02]]
grads:  [-1.74731557e-02 -2.46027683e+01]
Stock Position:  -0.017473155697801845
Bond Position:  [-0.78512631]


portfolio before change:  [-2.60633894]
curr_Stock_Price:  104.20670439716598
curr_Factors:  [1.04206704e+02 3.60398574e-02]
mat_Sqrt:  [[ 1.97827742e+01  0.00000000e+00]
 [-7.59366656e-03  1.73992759e-02]]
grads:  [1.56099834e-02 2.52311576e+01]
Stock Position:  0.015609983379760982
Bond Position:  [-4.23300387]


portfolio before change:  [-2.6283004]
curr_Stock_Price:  102.93543942640858
curr_Factors:  [1.02935439e+02 3.52898393e-02]
mat_Sqrt:  [[ 1.93370296e+01  0.00000000e+00]
 [-7.51423601e-03  1.72172777e-02]]
grads:  [ 7.54615876e-04 -3.57917999e+01]
Stock Position:  0.0007546158758567406
Bond Position:  [-2.70597712]


portfolio before change:  [-2.62841699]
curr_Stock_Price:  104.57433313063896
curr_Factors:  [1.04574333e+02 3.63141959e-02]
mat_Sqrt:  [[ 1.99279819e+01  0.00000000e+00]
 [-7.62251359e-03  1.74653728e-02]]
grads:  [-0.02771655  3.65217123]
Stock Position:  -0.02771654811867937
Bond Position:  [0.27002254]


portfolio before change:  [-2.60763555]
curr_Stock_Price:  103.8294207953558
curr_Factors:  [1.03829421e+02 3.21381175e-02]
mat_Sqrt:  [[ 1.86136117e+01  0.00000000e+00]
 [-7.17084291e-03  1.64304652e-02]]
grads:  [ 1.01342310e-03 -3.71850641e+00]
Stock Position:  0.001013423099254617
Bond Position:  [-2.71285868]


portfolio before change:  [-2.61112505]
curr_Stock_Price:  101.7249388002686
curr_Factors:  [1.01724939e+02 3.25578334e-02]
mat_Sqrt:  [[ 1.83550337e+01  0.00000000e+00]
 [-7.21751574e-03  1.65374061e-02]]
grads:  [-4.64378970e-04  2.56900111e+00]
Stock Position:  -0.0004643789697061632
Bond Position:  [-2.56388613]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.61342024]
Stock Price:  103.90619653046001
PL:  [-6.51961677]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.02474364e-01  3.30287847e-01]
 [ 4.22042001e-02  1.60366192e-01]
 [-3.28350272e-02  2.27375645e-02]
 [-1.49376368e-01 -4.38728678e-01]
 [ 5.17194638e-02  1.92574177e-01]
 [ 4.08303510e-01 -9.98173419e-01]
 [-8.03793639e-01  1.48276491e-01]
 [-2.03803601e-02  2.52691414e-02]
 [-2.97381194e-02  8.51267053e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.08651669]
curr_Stock_Price:  101.15212234449558
curr_Factors:  [1.01152122e+02 4.20642994e-02]
mat_Sqrt:  [[ 2.07458785e+01  0.00000000e+00]
 [-8.20383319e-03  1.87973433e-02]]
grads:  [-2.81139840e-03  1.75709855e+01]
Stock Position:  -0.0028113983983371026
Bond Position:  [10.3708956]


portfolio before change:  [10.08833344]
curr_Stock_Price:  102.35081222823719
curr_Factors:  [1.02350812e+02 4.31001689e-02]
mat_Sqrt:  [[ 2.12486224e+01  0.00000000e+00]
 [-8.30423207e-03  1.90273860e-02]]
grads:  [5.28004789e-03 8.42817776e+00]
Stock Position:  0.005280047894877707
Bond Position:  [9.54791624]


portfolio before change:  [10.08543796]
curr_Stock_Price:  100.898054314593
curr_Factors:  [1.00898054e+02 4.42728055e-02]
mat_Sqrt:  [[ 2.12300645e+01  0.00000000e+00]
 [-8.41644158e-03  1.92844903e-02]]
grads:  [-1.07920259e-03  1.17905965e+00]
Stock Position:  -0.0010792025878725569
Bond Position:  [10.1943274]


portfolio before change:  [10.08876297]
curr_Stock_Price:  102.54132242807864
curr_Factors:  [1.02541322e+02 4.22006388e-02]
mat_Sqrt:  [[ 2.10648527e+01  0.00000000e+00]
 [-8.21711762e-03  1.88277817e-02]]
grads:  [-1.61811367e-02 -2.33021969e+01]
Stock Position:  -0.016181136719415116
Bond Position:  [11.74799813]


portfolio before change:  [10.11536965]
curr_Stock_Price:  101.26012658956009
curr_Factors:  [1.01260127e+02 4.09028101e-02]
mat_Sqrt:  [[ 2.04792967e+01  0.00000000e+00]
 [-8.08977726e-03  1.85360083e-02]]
grads:  [6.62941344e-03 1.03891935e+01]
Stock Position:  0.006629413439513852
Bond Position:  [9.4440744]


portfolio before change:  [10.09420957]
curr_Stock_Price:  97.35581554913104
curr_Factors:  [9.73558155e+01 4.19477287e-02]
mat_Sqrt:  [[ 1.99395854e+01  0.00000000e+00]
 [-8.19245787e-03  1.87712792e-02]]
grads:  [-1.37089538e-03 -5.31755673e+01]
Stock Position:  -0.0013708953791673616
Bond Position:  [10.22767421]


portfolio before change:  [10.0940006]
curr_Stock_Price:  101.23947572847734
curr_Factors:  [1.01239476e+02 4.12296206e-02]
mat_Sqrt:  [[ 2.05567549e+01  0.00000000e+00]
 [-8.12203134e-03  1.86099117e-02]]
grads:  [-0.03595317  7.96760854]
Stock Position:  -0.03595316855183894
Bond Position:  [13.73388053]


portfolio before change:  [10.08330766]
curr_Stock_Price:  101.72793329849341
curr_Factors:  [1.01727933e+02 3.71676439e-02]
mat_Sqrt:  [[ 1.96120385e+01  0.00000000e+00]
 [-7.71156470e-03  1.76694145e-02]]
grads:  [-4.76850106e-04  1.43010632e+00]
Stock Position:  -0.0004768501062942399
Bond Position:  [10.13181663]


portfolio before change:  [10.08778498]
curr_Stock_Price:  102.96491563287107
curr_Factors:  [1.02964916e+02 3.83705128e-02]
mat_Sqrt:  [[ 2.01691720e+01  0.00000000e+00]
 [-7.83535707e-03  1.79530584e-02]]
grads:  [3.67601638e-04 4.74162693e+00]
Stock Position:  0.00036760163836506746
Bond Position:  [10.04993491]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.09263892]
Stock Price:  102.49625078999638
PL:  [7.59638813]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.39662868e-01  2.79590633e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.27883495e-01  1.44037255e-01]
 [-1.63749622e-01 -4.15131327e-01]
 [ 1.39159185e-01  5.41399610e-01]
 [ 2.50002421e-01 -6.17526012e-01]
 [-5.71429109e-01  6.04813119e-02]
 [ 4.61213944e-02 -6.17886838e-02]
 [-4.06870405e-02  1.90400814e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.89261263]
curr_Stock_Price:  99.3479212794639
curr_Factors:  [9.93479213e+01 4.15530519e-02]
mat_Sqrt:  [[ 2.02516423e+01  0.00000000e+00]
 [-8.15382628e-03  1.86827631e-02]]
grads:  [-0.01568463 14.96516504]
Stock Position:  -0.01568462981501673
Bond Position:  [-0.33437726]


portfolio before change:  [-1.84175041]
curr_Stock_Price:  96.09445277926282
curr_Factors:  [9.60944528e+01 4.46621867e-02]
mat_Sqrt:  [[ 2.03080540e+01  0.00000000e+00]
 [-8.45337203e-03  1.93691086e-02]]
grads:  [ 0.00462672 -2.44084608]
Stock Position:  0.0046267195812131606
Bond Position:  [-2.2863525]


portfolio before change:  [-1.83492653]
curr_Stock_Price:  97.81648065039674
curr_Factors:  [9.78164807e+01 4.45982171e-02]
mat_Sqrt:  [[ 2.06571680e+01  0.00000000e+00]
 [-8.44731599e-03  1.93552325e-02]]
grads:  [0.01407485 7.44177344]
Stock Position:  0.01407484834015995
Bond Position:  [-3.21167866]


portfolio before change:  [-1.80580247]
curr_Stock_Price:  99.99982942158469
curr_Factors:  [9.99998294e+01 4.48907787e-02]
mat_Sqrt:  [[ 2.11874079e+01  0.00000000e+00]
 [-8.47497763e-03  1.94186133e-02]]
grads:  [-1.62798483e-02 -2.13780110e+01]
Stock Position:  -0.0162798482770211
Bond Position:  [-0.17782042]


portfolio before change:  [-1.89295923]
curr_Stock_Price:  105.34802592705975
curr_Factors:  [1.05348026e+02 4.43566526e-02]
mat_Sqrt:  [[ 2.21873679e+01  0.00000000e+00]
 [-8.42440764e-03  1.93027429e-02]]
grads:  [1.69215812e-02 2.80478072e+01]
Stock Position:  0.01692158118923759
Bond Position:  [-3.6756144]


portfolio before change:  [-1.92242202]
curr_Stock_Price:  103.71552324487217
curr_Factors:  [1.03715523e+02 4.54283872e-02]
mat_Sqrt:  [[ 2.21058603e+01  0.00000000e+00]
 [-8.52557444e-03  1.95345451e-02]]
grads:  [-8.82482115e-04 -3.16119986e+01]
Stock Position:  -0.0008824821153206309
Bond Position:  [-1.83089493]


portfolio before change:  [-1.92419769]
curr_Stock_Price:  104.69003663109874
curr_Factors:  [1.04690037e+02 4.21657172e-02]
mat_Sqrt:  [[ 2.14973584e+01  0.00000000e+00]
 [-8.21371703e-03  1.88199900e-02]]
grads:  [-0.02535348  3.21367396]
Stock Position:  -0.02535348247292442
Bond Position:  [0.73005932]


portfolio before change:  [-1.90221153]
curr_Stock_Price:  103.83725283552519
curr_Factors:  [1.03837253e+02 4.10897955e-02]
mat_Sqrt:  [[ 2.10484529e+01  0.00000000e+00]
 [-8.10824721e-03  1.85783283e-02]]
grads:  [ 9.10024223e-04 -3.32584734e+00]
Stock Position:  0.0009100242231269164
Bond Position:  [-1.99670595]


portfolio before change:  [-1.90101265]
curr_Stock_Price:  106.25200338683963
curr_Factors:  [1.06252003e+02 3.93993138e-02]
mat_Sqrt:  [[ 2.10902368e+01  0.00000000e+00]
 [-7.93970416e-03  1.81921476e-02]]
grads:  [2.01091566e-03 1.04660988e+01]
Stock Position:  0.0020109156550137206
Bond Position:  [-2.11467647]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.89547389]
Stock Price:  109.53228317263806
PL:  [-11.42775706]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.42137842e-02  2.05369424e-01]
 [ 1.13184730e-01 -4.32373255e-02]
 [ 8.73489378e-02  5.76328225e-02]
 [-1.63822852e-01 -4.14588379e-01]
 [ 2.62571473e-02  1.17577245e-01]
 [ 3.85269096e-01 -7.79424411e-01]
 [-1.05945532e+00  2.59583075e-01]
 [-4.57902667e-02  1.78043385e-02]
 [-3.82854921e-02 -2.33388776e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.23488479]
curr_Stock_Price:  101.77691651372618
curr_Factors:  [1.01776917e+02 3.79443387e-02]
mat_Sqrt:  [[ 1.98254376e+01  0.00000000e+00]
 [-7.79172265e-03  1.78530794e-02]]
grads:  [2.29083370e-03 1.15033054e+01]
Stock Position:  0.0022908337031003964
Bond Position:  [14.0017308]


portfolio before change:  [14.24230478]
curr_Stock_Price:  101.95910858665313
curr_Factors:  [1.01959109e+02 4.05357580e-02]
mat_Sqrt:  [[ 2.0527931e+01  0.0000000e+00]
 [-8.0533976e-03  1.8452652e-02]]
grads:  [ 0.00459444 -2.34314967]
Stock Position:  0.0045944432455212415
Bond Position:  [13.77385944]


portfolio before change:  [14.23668828]
curr_Stock_Price:  99.23731134295312
curr_Factors:  [9.92373113e+01 4.08195330e-02]
mat_Sqrt:  [[ 2.00497520e+01  0.00000000e+00]
 [-8.08153778e-03  1.85171293e-02]]
grads:  [0.00561114 3.1124059 ]
Stock Position:  0.005611139910506607
Bond Position:  [13.67985385]


portfolio before change:  [14.24787108]
curr_Stock_Price:  100.01097893217482
curr_Factors:  [1.00010979e+02 3.82458527e-02]
mat_Sqrt:  [[ 1.95586940e+01  0.00000000e+00]
 [-7.82261876e-03  1.79238713e-02]]
grads:  [-1.76271511e-02 -2.31305153e+01]
Stock Position:  -0.017627151118516857
Bond Position:  [16.01077972]


portfolio before change:  [14.25250273]
curr_Stock_Price:  100.2024867892662
curr_Factors:  [1.00202487e+02 4.08878956e-02]
mat_Sqrt:  [[ 2.02616999e+01  0.00000000e+00]
 [-8.08830223e-03  1.85326286e-02]]
grads:  [3.82850719e-03 6.34433718e+00]
Stock Position:  0.003828507190082644
Bond Position:  [13.86887679]


portfolio before change:  [14.25604408]
curr_Stock_Price:  99.31576392681302
curr_Factors:  [9.93157639e+01 4.20863312e-02]
mat_Sqrt:  [[ 2.03745827e+01  0.00000000e+00]
 [-8.20598135e-03  1.88022653e-02]]
grads:  [ 2.21356167e-03 -4.14537502e+01]
Stock Position:  0.002213561672852769
Bond Position:  [14.03620251]


portfolio before change:  [14.25783843]
curr_Stock_Price:  96.9550843950346
curr_Factors:  [9.69550844e+01 4.13041134e-02]
mat_Sqrt:  [[ 1.97045827e+01  0.00000000e+00]
 [-8.12936538e-03  1.86267161e-02]]
grads:  [-0.04801746 13.93606225]
Stock Position:  -0.048017458474008304
Bond Position:  [18.91337516]


portfolio before change:  [14.27116548]
curr_Stock_Price:  96.87453035037548
curr_Factors:  [9.68745304e+01 4.05761008e-02]
mat_Sqrt:  [[ 1.95139310e+01  0.00000000e+00]
 [-8.05740412e-03  1.84618322e-02]]
grads:  [-0.00194834  0.96438633]
Stock Position:  -0.001948342251770861
Bond Position:  [14.45991022]


portfolio before change:  [14.27648584]
curr_Stock_Price:  97.8555721599747
curr_Factors:  [9.78555722e+01 3.77657458e-02]
mat_Sqrt:  [[ 1.90166754e+01  0.00000000e+00]
 [-7.77336435e-03  1.78110153e-02]]
grads:  [-0.00206682 -0.1310362 ]
Stock Position:  -0.0020668220593463202
Bond Position:  [14.47873589]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.28697837]
Stock Price:  96.2824554541716
PL:  [14.28697837]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.46688231e-01  2.87611108e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.38309213e-01  8.63884285e-02]
 [-1.24877872e-01 -4.84666213e-01]
 [ 6.25169754e-03  5.66490209e-02]
 [ 2.61607797e-01 -6.20429658e-01]
 [-4.44477994e-01  1.25153850e-02]
 [ 1.15702529e-01 -1.74449797e-01]
 [-2.71240002e-02  4.63828020e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.32144585]
curr_Stock_Price:  98.98210976170652
curr_Factors:  [9.89821098e+01 4.05406257e-02]
mat_Sqrt:  [[ 1.99297536e+01  0.00000000e+00]
 [-8.05388112e-03  1.84537599e-02]]
grads:  [-0.02113245 15.58550178]
Stock Position:  -0.021132446533253142
Bond Position:  [-2.2297117]


portfolio before change:  [-4.28710995]
curr_Stock_Price:  97.30454581825535
curr_Factors:  [9.73045458e+01 3.97032817e-02]
mat_Sqrt:  [[ 1.93885947e+01  0.00000000e+00]
 [-7.97027294e-03  1.82621895e-02]]
grads:  [ 0.00484613 -2.58879215]
Stock Position:  0.004846131060184779
Bond Position:  [-4.75866053]


portfolio before change:  [-4.28308005]
curr_Stock_Price:  98.62721507278657
curr_Factors:  [9.86272151e+01 3.78722295e-02]
mat_Sqrt:  [[ 1.91936339e+01  0.00000000e+00]
 [-7.78431546e-03  1.78361074e-02]]
grads:  [0.00917034 4.84345751]
Stock Position:  0.009170343415785202
Bond Position:  [-5.18752548]


portfolio before change:  [-4.298335]
curr_Stock_Price:  97.24661924577809
curr_Factors:  [9.72466192e+01 3.89110229e-02]
mat_Sqrt:  [[ 1.91827486e+01  0.00000000e+00]
 [-7.89035085e-03  1.80790650e-02]]
grads:  [-1.75367751e-02 -2.68081459e+01]
Stock Position:  -0.017536775114634483
Bond Position:  [-2.5929429]


portfolio before change:  [-4.33924099]
curr_Stock_Price:  99.5052556698179
curr_Factors:  [9.95052557e+01 4.03903108e-02]
mat_Sqrt:  [[ 1.99979104e+01  0.00000000e+00]
 [-8.03893633e-03  1.84195171e-02]]
grads:  [1.54892970e-03 3.07548893e+00]
Stock Position:  0.0015489296954433304
Bond Position:  [-4.49336764]


portfolio before change:  [-4.33535008]
curr_Stock_Price:  103.46809188730505
curr_Factors:  [1.03468092e+02 3.87447874e-02]
mat_Sqrt:  [[ 2.03663443e+01  0.00000000e+00]
 [-7.87347826e-03  1.80404050e-02]]
grads:  [-4.50247974e-04 -3.43911157e+01]
Stock Position:  -0.000450247974067412
Bond Position:  [-4.28876378]


portfolio before change:  [-4.33889651]
curr_Stock_Price:  106.58083868471081
curr_Factors:  [1.06580839e+02 4.03725956e-02]
mat_Sqrt:  [[ 2.14152165e+01  0.00000000e+00]
 [-8.03717319e-03  1.84154773e-02]]
grads:  [-0.02050018  0.67961231]
Stock Position:  -0.02050018186336512
Bond Position:  [-2.15396993]


portfolio before change:  [-4.32269499]
curr_Stock_Price:  105.73797945441945
curr_Factors:  [1.05737979e+02 4.12781477e-02]
mat_Sqrt:  [[ 2.14828110e+01  0.00000000e+00]
 [-8.12680973e-03  1.86208604e-02]]
grads:  [ 1.84176994e-03 -9.36851429e+00]
Stock Position:  0.0018417699428487947
Bond Position:  [-4.51744003]


portfolio before change:  [-4.33216655]
curr_Stock_Price:  101.82203446730725
curr_Factors:  [1.01822034e+02 4.02772073e-02]
mat_Sqrt:  [[ 2.04348496e+01  0.00000000e+00]
 [-8.02767287e-03  1.83937093e-02]]
grads:  [-3.36723095e-04  2.52166658e+00]
Stock Position:  -0.0003367230951876773
Bond Position:  [-4.29788072]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.33406637]
Stock Price:  101.08062179142125
PL:  [-5.41468817]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.19099331e-01  3.46325444e-01]
 [ 1.31993470e-02  2.30894008e-01]
 [-9.91895761e-02  6.58437905e-03]
 [-1.49160536e-01 -4.39036764e-01]
 [ 7.40194070e-02  2.61245376e-01]
 [ 2.50903958e-01 -6.25572981e-01]
 [-8.09473152e-01  1.50944949e-01]
 [-1.29039996e-02  3.26343871e-02]
 [-3.24786509e-02  1.11605119e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.85195126]
curr_Stock_Price:  101.56863007871387
curr_Factors:  [1.01568630e+02 4.19948722e-02]
mat_Sqrt:  [[ 2.08141043e+01  0.00000000e+00]
 [-8.19706017e-03  1.87818244e-02]]
grads:  [1.53979646e-03 1.84393932e+01]
Stock Position:  0.001539796461306641
Bond Position:  [12.69555625]


portfolio before change:  [12.85996894]
curr_Stock_Price:  102.65209024482522
curr_Factors:  [1.02652090e+02 3.99791033e-02]
mat_Sqrt:  [[ 2.05250546e+01  0.00000000e+00]
 [-7.99791005e-03  1.83255141e-02]]
grads:  [5.55271378e-03 1.25995924e+01]
Stock Position:  0.00555271377634666
Bond Position:  [12.28997126]


portfolio before change:  [12.86565376]
curr_Stock_Price:  102.56894151485453
curr_Factors:  [1.02568942e+02 3.89049712e-02]
mat_Sqrt:  [[ 2.02310500e+01  0.00000000e+00]
 [-7.88973725e-03  1.80776591e-02]]
grads:  [-0.0047608   0.36422742]
Stock Position:  -0.004760796780816356
Bond Position:  [13.35396364]


portfolio before change:  [12.87230974]
curr_Stock_Price:  102.57370267813128
curr_Factors:  [1.02573703e+02 3.80757297e-02]
mat_Sqrt:  [[ 2.00152100e+01  0.00000000e+00]
 [-7.80520131e-03  1.78839629e-02]]
grads:  [-1.70256465e-02 -2.45491878e+01]
Stock Position:  -0.017025646451003407
Bond Position:  [14.61869334]


portfolio before change:  [12.88683533]
curr_Stock_Price:  102.149964347817
curr_Factors:  [1.02149964e+02 3.74164250e-02]
mat_Sqrt:  [[ 1.97592003e+01  0.00000000e+00]
 [-7.73733029e-03  1.77284509e-02]]
grads:  [9.51638900e-03 1.47359393e+01]
Stock Position:  0.009516389002003247
Bond Position:  [11.91473654]


portfolio before change:  [12.90800992]
curr_Stock_Price:  103.7488618899433
curr_Factors:  [1.03748862e+02 3.74948245e-02]
mat_Sqrt:  [[ 2.00894943e+01  0.00000000e+00]
 [-7.74543215e-03  1.77470146e-02]]
grads:  [-1.10099708e-03 -3.52494770e+01]
Stock Position:  -0.001100997077812123
Bond Position:  [13.02223712]


portfolio before change:  [12.9173886]
curr_Stock_Price:  101.14582694667008
curr_Factors:  [1.01145827e+02 3.95201165e-02]
mat_Sqrt:  [[ 2.01074537e+01  0.00000000e+00]
 [-7.95186685e-03  1.82200159e-02]]
grads:  [-0.03698108  8.28456736]
Stock Position:  -0.03698108105439812
Bond Position:  [16.65787063]


portfolio before change:  [12.89136733]
curr_Stock_Price:  102.07474230618402
curr_Factors:  [1.02074742e+02 3.89879438e-02]
mat_Sqrt:  [[ 2.01550304e+01  0.00000000e+00]
 [-7.89814599e-03  1.80969259e-02]]
grads:  [6.64258319e-05 1.80331109e+00]
Stock Position:  6.642583189590946e-05
Bond Position:  [12.88458693]


portfolio before change:  [12.89792538]
curr_Stock_Price:  103.79319126687366
curr_Factors:  [1.03793191e+02 3.64947471e-02]
mat_Sqrt:  [[ 1.98282344e+01  0.00000000e+00]
 [-7.64143935e-03  1.75087371e-02]]
grads:  [8.18520496e-04 6.37425293e+00]
Stock Position:  0.0008185204956485358
Bond Position:  [12.81296853]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.90311048]
Stock Price:  102.29904243440772
PL:  [10.60406804]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.11327423e-01  2.82251743e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.85337909e-02  5.43224032e-02]
 [-1.33928848e-01 -4.59546043e-01]
 [ 1.14200421e-01  4.24954367e-01]
 [ 1.72289786e-01 -6.51807567e-01]
 [-3.70974517e-01 -1.52560327e-02]
 [ 2.37982253e-01 -3.67874882e-01]
 [-4.58007387e-02  2.39898193e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.27045895]
curr_Stock_Price:  97.63428067038376
curr_Factors:  [9.76342807e+01 4.16662619e-02]
mat_Sqrt:  [[ 1.99294173e+01  0.00000000e+00]
 [-8.16492615e-03  1.87081961e-02]]
grads:  [-0.0395467  15.08706357]
Stock Position:  -0.039546698820635384
Bond Position:  [-9.40934546]


portfolio before change:  [-13.3340905]
curr_Stock_Price:  99.12430894835006
curr_Factors:  [9.91243089e+01 4.40053955e-02]
mat_Sqrt:  [[ 2.07937652e+01  0.00000000e+00]
 [-8.39098521e-03  1.92261624e-02]]
grads:  [ 0.00451865 -2.45899373]
Stock Position:  0.004518646329894025
Bond Position:  [-13.7819982]


portfolio before change:  [-13.33971905]
curr_Stock_Price:  99.40407704464427
curr_Factors:  [9.94040770e+01 4.45910955e-02]
mat_Sqrt:  [[ 2.09907651e+01  0.00000000e+00]
 [-8.44664151e-03  1.93536871e-02]]
grads:  [0.00487081 2.80682451]
Stock Position:  0.004870810135739965
Bond Position:  [-13.82389744]


portfolio before change:  [-13.32357773]
curr_Stock_Price:  104.13737427777383
curr_Factors:  [1.04137374e+02 4.16128316e-02]
mat_Sqrt:  [[ 2.12432157e+01  0.00000000e+00]
 [-8.15968937e-03  1.86961971e-02]]
grads:  [-1.57457887e-02 -2.45796533e+01]
Stock Position:  -0.015745788652374203
Bond Position:  [-11.68385265]


portfolio before change:  [-13.32810862]
curr_Stock_Price:  104.054018499824
curr_Factors:  [1.04054018e+02 3.95667018e-02]
mat_Sqrt:  [[ 2.06977807e+01  0.00000000e+00]
 [-7.95655220e-03  1.82307514e-02]]
grads:  [1.44781567e-02 2.33097561e+01]
Stock Position:  0.014478156654060076
Bond Position:  [-14.834619]


portfolio before change:  [-13.31342708]
curr_Stock_Price:  105.5805042334321
curr_Factors:  [1.05580504e+02 3.92219019e-02]
mat_Sqrt:  [[ 2.09097123e+01  0.00000000e+00]
 [-7.92180807e-03  1.81511426e-02]]
grads:  [-5.36508379e-03 -3.59100021e+01]
Stock Position:  -0.0053650837937116915
Bond Position:  [-12.74697883]


portfolio before change:  [-13.33106628]
curr_Stock_Price:  107.68002617524682
curr_Factors:  [1.07680026e+02 3.75129732e-02]
mat_Sqrt:  [[ 2.08557540e+01  0.00000000e+00]
 [-7.74730644e-03  1.77513091e-02]]
grads:  [-0.01810689 -0.85943142]
Stock Position:  -0.018106887683553532
Bond Position:  [-11.38131614]


portfolio before change:  [-13.36160581]
curr_Stock_Price:  109.05229158507457
curr_Factors:  [1.09052292e+02 3.60899327e-02]
mat_Sqrt:  [[ 2.07170461e+01  0.00000000e+00]
 [-7.59894021e-03  1.74113594e-02]]
grads:  [ 3.73742915e-03 -2.11284411e+01]
Stock Position:  0.0037374291452793
Bond Position:  [-13.76918103]


portfolio before change:  [-13.37316726]
curr_Stock_Price:  107.80139486514148
curr_Factors:  [1.07801395e+02 3.44017828e-02]
mat_Sqrt:  [[ 1.99946983e+01  0.00000000e+00]
 [-7.41908704e-03  1.69992640e-02]]
grads:  [2.94575170e-03 1.41122694e+01]
Stock Position:  0.002945751700215717
Bond Position:  [-13.69072341]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.3793332]
Stock Price:  108.03262179056931
PL:  [-21.41195499]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.10615000e+00  6.75247676e-03]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.08760708e-01 -5.30133610e-01]
 [-2.04679704e-02 -2.51929044e-02]
 [ 3.87979000e-01 -7.96701579e-01]
 [-1.06627116e+00  2.67309729e-01]
 [-2.22368408e-03  6.96441123e-02]
 [-3.05844130e-02 -2.05414462e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.97312058]
curr_Stock_Price:  95.72110692930228
curr_Factors:  [9.57211069e+01 3.97192051e-02]
mat_Sqrt:  [[ 1.90769080e+01  0.00000000e+00]
 [-7.97187106e-03  1.82658513e-02]]
grads:  [-0.05782923  0.36967764]
Stock Position:  -0.05782923388856561
Bond Position:  [-20.4376423]


portfolio before change:  [-25.96776632]
curr_Stock_Price:  95.45176848029635
curr_Factors:  [9.54517685e+01 4.17632650e-02]
mat_Sqrt:  [[ 1.95065831e+01  0.00000000e+00]
 [-8.17442500e-03  1.87299607e-02]]
grads:  [ 0.00481682 -2.5241384 ]
Stock Position:  0.00481681854587242
Bond Position:  [-26.42754017]


portfolio before change:  [-25.98330207]
curr_Stock_Price:  94.97039823167698
curr_Factors:  [9.49703982e+01 4.46598127e-02]
mat_Sqrt:  [[ 2.00699693e+01  0.00000000e+00]
 [-8.45314736e-03  1.93685938e-02]]
grads:  [ 0.0200681  10.06293469]
Stock Position:  0.02006810154272091
Bond Position:  [-27.88917767]


portfolio before change:  [-25.9777498]
curr_Stock_Price:  95.94210686693846
curr_Factors:  [9.59421069e+01 4.55232985e-02]
mat_Sqrt:  [[ 2.04703898e+01  0.00000000e+00]
 [-8.53447582e-03  1.95549407e-02]]
grads:  [-1.66157063e-02 -2.71099574e+01]
Stock Position:  -0.016615706263842
Bond Position:  [-24.38360393]


portfolio before change:  [-26.0340002]
curr_Stock_Price:  98.59354724670821
curr_Factors:  [9.85935472e+01 4.48819025e-02]
mat_Sqrt:  [[ 2.08873874e+01  0.00000000e+00]
 [-8.47413972e-03  1.94166934e-02]]
grads:  [-0.00150632 -1.29748685]
Stock Position:  -0.0015063183684053774
Bond Position:  [-25.88548693]


portfolio before change:  [-26.04773034]
curr_Stock_Price:  99.11412519137482
curr_Factors:  [9.91141252e+01 4.44084398e-02]
mat_Sqrt:  [[ 2.08866269e+01  0.00000000e+00]
 [-8.42932404e-03  1.93140077e-02]]
grads:  [ 1.92802433e-03 -4.12499358e+01]
Stock Position:  0.001928024334462731
Bond Position:  [-26.23882479]


portfolio before change:  [-26.06601798]
curr_Stock_Price:  96.43524318491413
curr_Factors:  [9.64352432e+01 4.39240705e-02]
mat_Sqrt:  [[ 2.02109659e+01  0.00000000e+00]
 [-8.38322807e-03  1.92083886e-02]]
grads:  [-0.04698477 13.91630161]
Stock Position:  -0.04698477225138765
Bond Position:  [-21.53503004]


portfolio before change:  [-25.9562717]
curr_Stock_Price:  93.87023141034909
curr_Factors:  [9.38702314e+01 4.19275213e-02]
mat_Sqrt:  [[ 1.92210666e+01  0.00000000e+00]
 [-8.19048436e-03  1.87667573e-02]]
grads:  [1.46565740e-03 3.71103602e+00]
Stock Position:  0.0014656573996439399
Bond Position:  [-26.0938533]


portfolio before change:  [-25.96930504]
curr_Stock_Price:  93.88172652481944
curr_Factors:  [9.38817265e+01 3.98628530e-02]
mat_Sqrt:  [[ 1.87441287e+01  0.00000000e+00]
 [-7.98627352e-03  1.82988515e-02]]
grads:  [-6.41452243e-03 -1.12255385e+01]
Stock Position:  -0.0064145224310533525
Bond Position:  [-25.3670986]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.96501291]
Stock Price:  91.23478727493145
PL:  [-25.96501291]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-6.53245824e-01  2.95694736e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.93717722e-02  5.28731618e-03]
 [-1.46817887e-01 -4.19468563e-01]
 [ 3.64078691e-02  1.46978325e-01]
 [ 2.67774798e-01 -6.17692368e-01]
 [-6.65546633e-01  9.60429862e-02]
 [ 3.75590953e-02 -4.79957775e-02]
 [-2.71170361e-02  4.58897386e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.75213734]
curr_Stock_Price:  98.61601836539315
curr_Factors:  [9.86160184e+01 3.85535762e-02]
mat_Sqrt:  [[ 1.93633189e+01  0.00000000e+00]
 [-7.85402584e-03  1.79958340e-02]]
grads:  [-0.0270715  16.43128833]
Stock Position:  -0.027071498625135478
Bond Position:  [-4.08245393]


portfolio before change:  [-6.84024605]
curr_Stock_Price:  101.79526501897274
curr_Factors:  [1.01795265e+02 3.97333938e-02]
mat_Sqrt:  [[ 2.02910914e+01  0.00000000e+00]
 [-7.97329481e-03  1.82691135e-02]]
grads:  [ 0.00463059 -2.587811  ]
Stock Position:  0.004630587333126937
Bond Position:  [-7.31161791]


portfolio before change:  [-6.84386526]
curr_Stock_Price:  101.8033641511605
curr_Factors:  [1.01803364e+02 3.99731089e-02]
mat_Sqrt:  [[ 2.03538277e+01  0.00000000e+00]
 [-7.99731044e-03  1.83241402e-02]]
grads:  [-0.00476884  0.28854375]
Stock Position:  -0.004768842488857262
Bond Position:  [-6.35838106]


portfolio before change:  [-6.83413722]
curr_Stock_Price:  99.09662140328591
curr_Factors:  [9.90966214e+01 4.27427082e-02]
mat_Sqrt:  [[ 2.04875424e+01  0.00000000e+00]
 [-8.26972388e-03  1.89483178e-02]]
grads:  [-1.61019301e-02 -2.21375094e+01]
Stock Position:  -0.016101930125077213
Bond Position:  [-5.23849035]


portfolio before change:  [-6.86145189]
curr_Stock_Price:  100.63027427026154
curr_Factors:  [1.00630274e+02 4.16747299e-02]
mat_Sqrt:  [[ 2.05430561e+01  0.00000000e+00]
 [-8.16575580e-03  1.87100970e-02]]
grads:  [4.89481547e-03 7.85556187e+00]
Stock Position:  0.004894815466925515
Bond Position:  [-7.35401851]


portfolio before change:  [-6.8520236]
curr_Stock_Price:  103.30784555617848
curr_Factors:  [1.03307846e+02 3.92506858e-02]
mat_Sqrt:  [[ 2.04671291e+01  0.00000000e+00]
 [-7.92471433e-03  1.81578016e-02]]
grads:  [-8.83490975e-05 -3.40180150e+01]
Stock Position:  -8.83490974651342e-05
Bond Position:  [-6.84289645]


portfolio before change:  [-6.85544543]
curr_Stock_Price:  103.30242705840266
curr_Factors:  [1.03302427e+02 3.76702036e-02]
mat_Sqrt:  [[ 2.00497753e+01  0.00000000e+00]
 [-7.76352535e-03  1.77884713e-02]]
grads:  [-0.03110409  5.39917032]
Stock Position:  -0.031104091118930106
Bond Position:  [-3.64231732]


portfolio before change:  [-6.86673972]
curr_Stock_Price:  103.60697460091062
curr_Factors:  [1.03606975e+02 3.67955712e-02]
mat_Sqrt:  [[ 1.98740678e+01  0.00000000e+00]
 [-7.67286869e-03  1.75807508e-02]]
grads:  [ 8.35864148e-04 -2.73001864e+00]
Stock Position:  0.0008358641476624547
Bond Position:  [-6.95334107]


portfolio before change:  [-6.87171666]
curr_Stock_Price:  101.8131430374118
curr_Factors:  [1.01813143e+02 3.59909755e-02]
mat_Sqrt:  [[ 1.93152642e+01  0.00000000e+00]
 [-7.58851506e-03  1.73874723e-02]]
grads:  [-3.67021243e-04  2.63924150e+00]
Stock Position:  -0.00036702124250206805
Bond Position:  [-6.83434907]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.87609991]
Stock Price:  104.44302553521642
PL:  [-11.31912544]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.12324977e-01  2.96853579e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.93745803e-02  5.26732472e-03]
 [-1.58533365e-01 -4.19820618e-01]
 [ 4.92128757e-02  1.84941562e-01]
 [ 3.77734554e-01 -7.55723805e-01]
 [-8.23606026e-01  1.57657830e-01]
 [-3.73626399e-02  1.39992629e-02]
 [-3.27211549e-02  7.72017570e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.83011544]
curr_Stock_Price:  99.90860893564249
curr_Factors:  [9.99086089e+01 3.88489409e-02]
mat_Sqrt:  [[ 1.96921214e+01  0.00000000e+00]
 [-7.88405387e-03  1.80646368e-02]]
grads:  [-9.28124758e-03  1.64328562e+01]
Stock Position:  -0.00928124757821136
Bond Position:  [2.75739197]


portfolio before change:  [1.8256579]
curr_Stock_Price:  100.53746634274466
curr_Factors:  [1.00537466e+02 4.00753277e-02]
mat_Sqrt:  [[ 2.01264175e+01  0.00000000e+00]
 [-8.00752922e-03  1.83475544e-02]]
grads:  [ 0.00466847 -2.57674739]
Stock Position:  0.00466847470679939
Bond Position:  [1.35630128]


portfolio before change:  [1.83219697]
curr_Stock_Price:  101.79285541272596
curr_Factors:  [1.01792855e+02 3.81081208e-02]
mat_Sqrt:  [[ 1.98712901e+01  0.00000000e+00]
 [-7.80852056e-03  1.78915683e-02]]
grads:  [-0.00488523  0.29440263]
Stock Position:  -0.0048852254101143825
Bond Position:  [2.32947801]


portfolio before change:  [1.8358719]
curr_Stock_Price:  101.27908126694217
curr_Factors:  [1.01279081e+02 3.70976211e-02]
mat_Sqrt:  [[ 1.95071033e+01  0.00000000e+00]
 [-7.70429710e-03  1.76527623e-02]]
grads:  [-1.75196747e-02 -2.37821487e+01]
Stock Position:  -0.017519674681083675
Bond Position:  [3.61024846]


portfolio before change:  [1.83981526]
curr_Stock_Price:  101.15705958426649
curr_Factors:  [1.01157060e+02 3.69041701e-02]
mat_Sqrt:  [[ 1.94327346e+01  0.00000000e+00]
 [-7.68418325e-03  1.76066757e-02]]
grads:  [6.68603742e-03 1.05040591e+01]
Stock Position:  0.006686037421896598
Bond Position:  [1.16347537]


portfolio before change:  [1.83080332]
curr_Stock_Price:  99.72215567578893
curr_Factors:  [9.97221557e+01 3.47529948e-02]
mat_Sqrt:  [[ 1.85903590e+01  0.00000000e+00]
 [-7.45686205e-03  1.70858174e-02]]
grads:  [ 2.57712323e-03 -4.42310594e+01]
Stock Position:  0.0025771232257269456
Bond Position:  [1.57380703]


portfolio before change:  [1.83465566]
curr_Stock_Price:  100.9115599743537
curr_Factors:  [1.00911560e+02 3.50055073e-02]
mat_Sqrt:  [[ 1.88803094e+01  0.00000000e+00]
 [-7.48390350e-03  1.71477772e-02]]
grads:  [-0.03997808  9.19406806]
Stock Position:  -0.03997807932482037
Bond Position:  [5.86890601]


portfolio before change:  [1.83637548]
curr_Stock_Price:  100.94196070054112
curr_Factors:  [1.00941961e+02 3.61724307e-02]
mat_Sqrt:  [[ 1.91982032e+01  0.00000000e+00]
 [-7.60762047e-03  1.74312483e-02]]
grads:  [-0.00162791  0.80311305]
Stock Position:  -0.0016279055054476408
Bond Position:  [2.00069946]


portfolio before change:  [1.83991548]
curr_Stock_Price:  99.38204557007938
curr_Factors:  [9.93820456e+01 3.47483536e-02]
mat_Sqrt:  [[ 1.85257179e+01  0.00000000e+00]
 [-7.45636411e-03  1.70846765e-02]]
grads:  [-0.00158438  0.4518772 ]
Stock Position:  -0.0015843809153023541
Bond Position:  [1.99737449]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.84384327]
Stock Price:  97.53346307256395
PL:  [1.84384327]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.92206348e-01  2.76447358e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.11841359e-01 -5.23111495e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.33662074e-01 -1.24493453e+00]
 [-9.38619522e-01  3.13405834e-01]
 [ 1.38079965e-02  9.95011118e-02]
 [-2.55009201e-02 -2.07589230e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.86810651]
curr_Stock_Price:  99.50222423244965
curr_Factors:  [9.95022242e+01 3.78835520e-02]
mat_Sqrt:  [[ 1.93668119e+01  0.00000000e+00]
 [-7.78547900e-03  1.78387734e-02]]
grads:  [-1.40216589e-02  1.54969936e+01]
Stock Position:  -0.0140216588561684
Bond Position:  [0.52707973]


portfolio before change:  [-0.82797322]
curr_Stock_Price:  96.65878875981534
curr_Factors:  [9.66587888e+01 3.86867797e-02]
mat_Sqrt:  [[ 1.90117738e+01  0.00000000e+00]
 [-7.86758206e-03  1.80268952e-02]]
grads:  [ 0.00494218 -2.62258211]
Stock Position:  0.004942183297878061
Bond Position:  [-1.30567868]


portfolio before change:  [-0.83941907]
curr_Stock_Price:  94.47496826531352
curr_Factors:  [9.44749683e+01 4.02309518e-02]
mat_Sqrt:  [[ 1.89494630e+01  0.00000000e+00]
 [-8.02306194e-03  1.83831443e-02]]
grads:  [ 0.02125475 10.60236983]
Stock Position:  0.02125475431745427
Bond Position:  [-2.84746131]


portfolio before change:  [-0.80515615]
curr_Stock_Price:  96.1539808135269
curr_Factors:  [9.61539808e+01 3.77779992e-02]
mat_Sqrt:  [[ 1.86890293e+01  0.00000000e+00]
 [-7.77462531e-03  1.78139045e-02]]
grads:  [-1.82002996e-02 -2.93653475e+01]
Stock Position:  -0.01820029956328557
Bond Position:  [0.9448751]


portfolio before change:  [-0.81005695]
curr_Stock_Price:  96.44921525828249
curr_Factors:  [9.64492153e+01 3.70776037e-02]
mat_Sqrt:  [[ 1.85718227e+01  0.00000000e+00]
 [-7.70221825e-03  1.76479991e-02]]
grads:  [-3.79430716e-03 -4.82745929e+00]
Stock Position:  -0.00379430716477564
Bond Position:  [-0.44409901]


portfolio before change:  [-0.80562013]
curr_Stock_Price:  95.22134156318626
curr_Factors:  [9.52213416e+01 3.65608993e-02]
mat_Sqrt:  [[ 1.82071819e+01  0.00000000e+00]
 [-7.64836184e-03  1.75245985e-02]]
grads:  [-6.02355153e-03 -7.10392608e+01]
Stock Position:  -0.006023551531544501
Bond Position:  [-0.23204947]


portfolio before change:  [-0.79195118]
curr_Stock_Price:  92.93282389432072
curr_Factors:  [9.29328239e+01 3.87275665e-02]
mat_Sqrt:  [[ 1.82885485e+01  0.00000000e+00]
 [-7.87172829e-03  1.80363954e-02]]
grads:  [-0.04384372 17.37630095]
Stock Position:  -0.04384372015853079
Bond Position:  [3.28256955]


portfolio before change:  [-0.78377682]
curr_Stock_Price:  92.78382506536667
curr_Factors:  [9.27838251e+01 3.90873668e-02]
mat_Sqrt:  [[ 1.83438495e+01  0.00000000e+00]
 [-7.90821009e-03  1.81199857e-02]]
grads:  [3.12005622e-03 5.49123567e+00]
Stock Position:  0.003120056222388894
Bond Position:  [-1.07326757]


portfolio before change:  [-0.77956648]
curr_Stock_Price:  94.30530664320528
curr_Factors:  [9.43053066e+01 3.79852496e-02]
mat_Sqrt:  [[ 1.83799203e+01  0.00000000e+00]
 [-7.79592197e-03  1.78627013e-02]]
grads:  [-6.31669158e-03 -1.16213795e+01]
Stock Position:  -0.006316691580865418
Bond Position:  [-0.18386894]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.79234424]
Stock Price:  96.31360511438504
PL:  [-0.79234424]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.07620454e+00  5.03951424e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 1.13308740e-01 -5.52795312e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 5.14001406e-01 -2.09949630e+00]
 [-5.32878339e-01  4.47623051e-01]
 [ 3.03221228e-01 -4.95624096e-02]
 [ 3.22090509e-01 -9.97164321e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.966464]
curr_Stock_Price:  96.02333356434123
curr_Factors:  [9.60233336e+01 4.11133589e-02]
mat_Sqrt:  [[ 1.94701034e+01  0.00000000e+00]
 [-8.11057176e-03  1.85836545e-02]]
grads:  [-0.05414508  2.71179936]
Stock Position:  -0.05414507934557578
Bond Position:  [-18.76727299]


portfolio before change:  [-24.01411456]
curr_Stock_Price:  96.73003816152787
curr_Factors:  [9.67300382e+01 4.21534888e-02]
mat_Sqrt:  [[ 1.98599487e+01  0.00000000e+00]
 [-8.21252593e-03  1.88172609e-02]]
grads:  [ 0.00473111 -2.51242799]
Stock Position:  0.004731113490341224
Bond Position:  [-24.47175535]


portfolio before change:  [-24.03719546]
curr_Stock_Price:  94.43840728607887
curr_Factors:  [9.44384073e+01 4.61737029e-02]
mat_Sqrt:  [[ 2.02929883e+01  0.00000000e+00]
 [-8.59522685e-03  1.96941388e-02]]
grads:  [0.01984755 9.89659393]
Stock Position:  0.0198475539738656
Bond Position:  [-25.91156685]


portfolio before change:  [-24.11087476]
curr_Stock_Price:  91.37907438527344
curr_Factors:  [9.13790744e+01 4.67987161e-02]
mat_Sqrt:  [[ 1.97680451e+01  0.00000000e+00]
 [-8.65320437e-03  1.98269820e-02]]
grads:  [-6.47261337e-03 -2.78809610e+01]
Stock Position:  -0.006472613371550001
Bond Position:  [-23.51941334]


portfolio before change:  [-24.13224582]
curr_Stock_Price:  92.86354670454621
curr_Factors:  [9.28635467e+01 4.94420031e-02]
mat_Sqrt:  [[ 2.06487276e+01  0.00000000e+00]
 [-8.89422313e-03  2.03792254e-02]]
grads:  [-3.41266547e-03 -4.18048260e+00]
Stock Position:  -0.0034126654700495345
Bond Position:  [-23.8153336]


portfolio before change:  [-24.12592928]
curr_Stock_Price:  87.5225038219622
curr_Factors:  [8.75225038e+01 5.60567815e-02]
mat_Sqrt:  [[ 2.07221023e+01  0.00000000e+00]
 [-9.47052535e-03  2.16996996e-02]]
grads:  [-1.94137590e-02 -9.67523206e+01]
Stock Position:  -0.019413758992660117
Bond Position:  [-22.42678848]


portfolio before change:  [-24.07684256]
curr_Stock_Price:  84.41630899436687
curr_Factors:  [8.4416309e+01 6.0504742e-02]
mat_Sqrt:  [[ 2.07644803e+01  0.00000000e+00]
 [-9.83908468e-03  2.25441751e-02]]
grads:  [-1.62546627e-02  1.98553750e+01]
Stock Position:  -0.016254662685485862
Bond Position:  [-22.70468393]


portfolio before change:  [-24.11446187]
curr_Stock_Price:  86.03209950105787
curr_Factors:  [8.60320995e+01 5.79301837e-02]
mat_Sqrt:  [[ 2.07067993e+01  0.00000000e+00]
 [-9.62747599e-03  2.20593187e-02]]
grads:  [ 0.01359894 -2.24677879]
Stock Position:  0.013598935044383507
Bond Position:  [-25.2844068]


portfolio before change:  [-24.17683703]
curr_Stock_Price:  82.37521031837898
curr_Factors:  [8.23752103e+01 6.03872979e-02]
mat_Sqrt:  [[ 2.02427418e+01  0.00000000e+00]
 [-9.82953084e-03  2.25222846e-02]]
grads:  [ 0.01376151 -4.42745636]
Stock Position:  0.013761509864959895
Bond Position:  [-25.3104443]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.19746203]
Stock Price:  81.79630483886243
PL:  [-24.19746203]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.10198222e-01  3.27593609e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 8.86531719e-02  5.67816388e-02]
 [-1.47762237e-01 -4.16590024e-01]
 [-1.59674907e-02 -1.13951058e-02]
 [ 3.99466786e-01 -9.14536222e-01]
 [-9.29354589e-01  2.09653081e-01]
 [-3.77234943e-02  2.54294593e-02]
 [-4.47207770e-02 -1.99366784e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.50953769]
curr_Stock_Price:  100.76399828863313
curr_Factors:  [1.00763998e+02 3.93834453e-02]
mat_Sqrt:  [[ 1.99968802e+01  0.00000000e+00]
 [-7.93810509e-03  1.81884837e-02]]
grads:  [-3.36175689e-03  1.80110456e+01]
Stock Position:  -0.0033617568922628383
Bond Position:  [7.84828175]


portfolio before change:  [7.52142242]
curr_Stock_Price:  98.39630496614888
curr_Factors:  [9.83963050e+01 4.14226422e-02]
mat_Sqrt:  [[ 2.00261603e+01  0.00000000e+00]
 [-8.14102129e-03  1.86534231e-02]]
grads:  [ 0.00469185 -2.53449528]
Stock Position:  0.004691846538064269
Bond Position:  [7.05976206]


portfolio before change:  [7.52854924]
curr_Stock_Price:  99.16275381400986
curr_Factors:  [9.91627538e+01 4.33131107e-02]
mat_Sqrt:  [[ 2.06375561e+01  0.00000000e+00]
 [-8.32472084e-03  1.90743317e-02]]
grads:  [0.00549652 2.97686124]
Stock Position:  0.005496518592786918
Bond Position:  [6.98349932]


portfolio before change:  [7.53212497]
curr_Stock_Price:  99.17787307135295
curr_Factors:  [9.91778731e+01 4.31883928e-02]
mat_Sqrt:  [[ 2.06109643e+01  0.00000000e+00]
 [-8.31272689e-03  1.90468501e-02]]
grads:  [-1.59903740e-02 -2.18718592e+01]
Stock Position:  -0.015990374042211986
Bond Position:  [9.11801626]


portfolio before change:  [7.54357765]
curr_Stock_Price:  98.746830492451
curr_Factors:  [9.87468305e+01 4.35732552e-02]
mat_Sqrt:  [[ 2.06126186e+01  0.00000000e+00]
 [-8.34968312e-03  1.91315275e-02]]
grads:  [-0.00101592 -0.59561924]
Stock Position:  -0.0010159176261604268
Bond Position:  [7.64389629]


portfolio before change:  [7.54808881]
curr_Stock_Price:  98.06935748058324
curr_Factors:  [9.80693575e+01 4.50062328e-02]
mat_Sqrt:  [[ 2.08050930e+01  0.00000000e+00]
 [-8.48586899e-03  1.94435685e-02]]
grads:  [ 1.58834230e-05 -4.70354103e+01]
Stock Position:  1.5883422951440273e-05
Bond Position:  [7.54653113]


portfolio before change:  [7.55188355]
curr_Stock_Price:  99.36214085888584
curr_Factors:  [9.93621409e+01 4.77148112e-02]
mat_Sqrt:  [[ 2.17043880e+01  0.00000000e+00]
 [-8.73748808e-03  2.00201003e-02]]
grads:  [-0.038603   10.47212942]
Stock Position:  -0.03860299960207359
Bond Position:  [11.38756024]


portfolio before change:  [7.67045815]
curr_Stock_Price:  96.43803135671271
curr_Factors:  [9.64380314e+01 4.85993452e-02]
mat_Sqrt:  [[ 2.12600140e+01  0.00000000e+00]
 [-8.81810367e-03  2.02048138e-02]]
grads:  [-1.25235893e-03  1.25858420e+00]
Stock Position:  -0.0012523589324371115
Bond Position:  [7.79123318]


portfolio before change:  [7.67903466]
curr_Stock_Price:  92.70115146631649
curr_Factors:  [9.27011515e+01 4.82153817e-02]
mat_Sqrt:  [[ 2.03553200e+01  0.00000000e+00]
 [-8.78320048e-03  2.01248405e-02]]
grads:  [-6.47160425e-03 -9.90650256e+00]
Stock Position:  -0.006471604247375212
Bond Position:  [8.27895982]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.67046675]
Stock Price:  94.66487271200629
PL:  [7.67046675]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.31641739e-01  2.78817270e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-2.75196956e-02 -5.48988221e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.56179994e-01 -1.48820111e+00]
 [-9.95375818e-01  2.92739163e-01]
 [-3.49706251e-02  2.75599071e-02]
 [-2.44071473e-02 -2.08057157e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.68870152]
curr_Stock_Price:  99.37863274680801
curr_Factors:  [9.93786327e+01 4.33462184e-02]
mat_Sqrt:  [[ 2.06903875e+01  0.00000000e+00]
 [-8.32790186e-03  1.90816203e-02]]
grads:  [-0.01498067 14.61182359]
Stock Position:  -0.014980671856107608
Bond Position:  [-0.19994283]


portfolio before change:  [-1.64049398]
curr_Stock_Price:  96.15397489554242
curr_Factors:  [9.61539749e+01 4.64075539e-02]
mat_Sqrt:  [[ 2.07138860e+01  0.00000000e+00]
 [-8.61696503e-03  1.97439473e-02]]
grads:  [ 0.00453607 -2.39450664]
Stock Position:  0.004536071654352281
Bond Position:  [-2.0766553]


portfolio before change:  [-1.6425713]
curr_Stock_Price:  95.92498082107944
curr_Factors:  [9.59249808e+01 4.44573677e-02]
mat_Sqrt:  [[ 2.02257015e+01  0.00000000e+00]
 [-8.43396635e-03  1.93246446e-02]]
grads:  [ 0.01991358 10.0858204 ]
Stock Position:  0.019913582793641516
Bond Position:  [-3.55278134]


portfolio before change:  [-1.68192478]
curr_Stock_Price:  94.03799476047216
curr_Factors:  [9.40379948e+01 4.50874243e-02]
mat_Sqrt:  [[ 1.99678393e+01  0.00000000e+00]
 [-8.49351982e-03  1.94610987e-02]]
grads:  [-1.33774013e-02 -2.82095183e+01]
Stock Position:  -0.013377401250216761
Bond Position:  [-0.4239408]


portfolio before change:  [-1.66545144]
curr_Stock_Price:  92.79071470039396
curr_Factors:  [9.27907147e+01 4.35780422e-02]
mat_Sqrt:  [[ 1.93703906e+01  0.00000000e+00]
 [-8.35014177e-03  1.91325784e-02]]
grads:  [-3.63788224e-03 -4.45287590e+00]
Stock Position:  -0.0036378822361446852
Bond Position:  [-1.32788975]


portfolio before change:  [-1.66693249]
curr_Stock_Price:  93.01527913944896
curr_Factors:  [9.30152791e+01 4.39067296e-02]
mat_Sqrt:  [[ 1.94903590e+01  0.00000000e+00]
 [-8.38157308e-03  1.92045966e-02]]
grads:  [-9.91896656e-03 -7.74919226e+01]
Stock Position:  -0.009918966561990828
Bond Position:  [-0.74431705]


portfolio before change:  [-1.68185199]
curr_Stock_Price:  94.4818887027654
curr_Factors:  [9.44818887e+01 3.98424409e-02]
mat_Sqrt:  [[ 1.88591248e+01  0.00000000e+00]
 [-7.98422854e-03  1.82941658e-02]]
grads:  [-0.046005   16.00177702]
Stock Position:  -0.04600499662517063
Bond Position:  [2.66478698]


portfolio before change:  [-1.75353908]
curr_Stock_Price:  96.0691036202554
curr_Factors:  [9.60691036e+01 3.87522815e-02]
mat_Sqrt:  [[ 1.89117787e+01  0.00000000e+00]
 [-7.87423967e-03  1.80421497e-02]]
grads:  [-1.21313262e-03  1.52752902e+00]
Stock Position:  -0.0012131326171403716
Bond Position:  [-1.63699452]


portfolio before change:  [-1.75232516]
curr_Stock_Price:  94.39358581790383
curr_Factors:  [9.43935858e+01 4.09368086e-02]
mat_Sqrt:  [[ 1.90985095e+01  0.00000000e+00]
 [-8.09313869e-03  1.85437103e-02]]
grads:  [-6.03244640e-03 -1.12198235e+01]
Stock Position:  -0.0060324464032461365
Bond Position:  [-1.18290091]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.74906506]
Stock Price:  93.75508907926915
PL:  [-1.74906506]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.68808395e-01  2.89409457e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.38392937e-01  1.50800993e-01]
 [-1.22125400e-01 -4.92760351e-01]
 [ 2.95518391e-02  1.27266567e-01]
 [ 3.63729331e-01 -7.11669066e-01]
 [-8.60929001e-01  1.75972583e-01]
 [-6.00909994e-02 -1.08386212e-03]
 [-3.46174148e-02  4.33861232e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.84130742]
curr_Stock_Price:  98.90381235084872
curr_Factors:  [9.89038124e+01 3.89290567e-02]
mat_Sqrt:  [[ 1.95141650e+01  0.00000000e+00]
 [-7.89217909e-03  1.80832540e-02]]
grads:  [-0.02267582 16.0042798 ]
Stock Position:  -0.022675823070532203
Bond Position:  [-2.59858207]


portfolio before change:  [-4.84868451]
curr_Stock_Price:  99.17182787791681
curr_Factors:  [9.91718279e+01 3.76907652e-02]
mat_Sqrt:  [[ 1.92533274e+01  0.00000000e+00]
 [-7.76564384e-03  1.77933254e-02]]
grads:  [ 0.00488018 -2.65700828]
Stock Position:  0.004880178331158812
Bond Position:  [-5.33266072]


portfolio before change:  [-4.85842698]
curr_Stock_Price:  97.7219892478512
curr_Factors:  [9.77219892e+01 3.86704876e-02]
mat_Sqrt:  [[ 1.92168466e+01  0.00000000e+00]
 [-7.86592525e-03  1.80230989e-02]]
grads:  [0.01583027 8.36709564]
Stock Position:  0.01583027081004638
Bond Position:  [-6.40539253]


portfolio before change:  [-4.87279949]
curr_Stock_Price:  97.01644155228264
curr_Factors:  [9.70164416e+01 3.87612558e-02]
mat_Sqrt:  [[ 1.91004791e+01  0.00000000e+00]
 [-7.87515138e-03  1.80442387e-02]]
grads:  [-1.76531514e-02 -2.73084590e+01]
Stock Position:  -0.01765315135220119
Bond Position:  [-3.16015356]


portfolio before change:  [-4.93300408]
curr_Stock_Price:  100.3373285861608
curr_Factors:  [1.00337329e+02 3.61909086e-02]
mat_Sqrt:  [[ 1.90880813e+01  0.00000000e+00]
 [-7.60956331e-03  1.74356999e-02]]
grads:  [4.45804485e-03 7.29919462e+00]
Stock Position:  0.004458044845134038
Bond Position:  [-5.38031239]


portfolio before change:  [-4.93605976]
curr_Stock_Price:  100.2554871194765
curr_Factors:  [1.00255487e+02 3.94333164e-02]
mat_Sqrt:  [[ 1.99085579e+01  0.00000000e+00]
 [-7.94312950e-03  1.81999961e-02]]
grads:  [ 2.66877627e-03 -3.91027043e+01]
Stock Position:  0.002668776274484993
Bond Position:  [-5.20361923]


portfolio before change:  [-4.93838756]
curr_Stock_Price:  100.35840420080318
curr_Factors:  [1.00358404e+02 3.94510852e-02]
mat_Sqrt:  [[ 1.99334846e+01  0.00000000e+00]
 [-7.94491890e-03  1.82040961e-02]]
grads:  [-0.03933724  9.66664767]
Stock Position:  -0.039337240147186946
Bond Position:  [-0.99056491]


portfolio before change:  [-4.91526841]
curr_Stock_Price:  99.75809372892334
curr_Factors:  [9.97580937e+01 3.87277330e-02]
mat_Sqrt:  [[ 1.96317574e+01  0.00000000e+00]
 [-7.87174522e-03  1.80364342e-02]]
grads:  [-0.003085   -0.06009293]
Stock Position:  -0.003085003259959175
Bond Position:  [-4.60751436]


portfolio before change:  [-4.91480197]
curr_Stock_Price:  98.85995200972822
curr_Factors:  [9.88599520e+01 3.85520388e-02]
mat_Sqrt:  [[ 1.94108284e+01  0.00000000e+00]
 [-7.85386924e-03  1.79954752e-02]]
grads:  [-0.00168586  0.24109462]
Stock Position:  -0.0016858574208094017
Bond Position:  [-4.74813819]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.9175677]
Stock Price:  99.0919182522526
PL:  [-4.9175677]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.92238174e-01  3.53757262e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 4.90792672e-02  5.03652791e-02]
 [-1.48505254e-01 -4.14615178e-01]
 [ 4.49455860e-02  1.71712962e-01]
 [ 3.07883488e-01 -6.01825403e-01]
 [-7.02107425e-01  1.09856488e-01]
 [ 1.06922185e-01 -1.60538957e-01]
 [-2.89223230e-02  1.47721190e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.5770026]
curr_Stock_Price:  101.22599542688056
curr_Factors:  [1.01225995e+02 4.03016247e-02]
mat_Sqrt:  [[ 2.03213864e+01  0.00000000e+00]
 [-8.03010583e-03  1.83992839e-02]]
grads:  [-1.86236543e-03  1.92266864e+01]
Stock Position:  -0.0018623654268608311
Bond Position:  [10.76552239]


portfolio before change:  [10.58517288]
curr_Stock_Price:  99.72995613423505
curr_Factors:  [9.97299561e+01 4.12381055e-02]
mat_Sqrt:  [[ 2.02523293e+01  0.00000000e+00]
 [-8.12286703e-03  1.86118265e-02]]
grads:  [ 0.00463945 -2.54015976]
Stock Position:  0.004639450086319449
Bond Position:  [10.12248072]


portfolio before change:  [10.59253478]
curr_Stock_Price:  100.22557349066898
curr_Factors:  [1.00225573e+02 4.10265913e-02]
mat_Sqrt:  [[ 2.03007119e+01  0.00000000e+00]
 [-8.10200877e-03  1.85640342e-02]]
grads:  [0.00350039 2.71305679]
Stock Position:  0.0035003933574169225
Bond Position:  [10.24170584]


portfolio before change:  [10.59419053]
curr_Stock_Price:  99.23528948437246
curr_Factors:  [9.92352895e+01 4.24125891e-02]
mat_Sqrt:  [[ 2.04368301e+01  0.00000000e+00]
 [-8.23772679e-03  1.88750033e-02]]
grads:  [-1.61208050e-02 -2.19663632e+01]
Stock Position:  -0.016120805021635196
Bond Position:  [12.19394328]


portfolio before change:  [10.57200277]
curr_Stock_Price:  100.98993211097365
curr_Factors:  [1.00989932e+02 4.21488668e-02]
mat_Sqrt:  [[ 2.07334241e+01  0.00000000e+00]
 [-8.21207567e-03  1.88162292e-02]]
grads:  [5.78231872e-03 9.12579028e+00]
Stock Position:  0.005782318719714414
Bond Position:  [9.9880468]


portfolio before change:  [10.58444982]
curr_Stock_Price:  102.27865005206901
curr_Factors:  [1.02278650e+02 4.07059611e-02]
mat_Sqrt:  [[ 2.06354524e+01  0.00000000e+00]
 [-8.07028734e-03  1.84913513e-02]]
grads:  [ 2.19163350e-03 -3.25463182e+01]
Stock Position:  0.0021916335037566177
Bond Position:  [10.3602925]


portfolio before change:  [10.5906752]
curr_Stock_Price:  102.75497936876305
curr_Factors:  [1.02754979e+02 3.93841784e-02]
mat_Sqrt:  [[ 2.03921854e+01  0.00000000e+00]
 [-7.93817898e-03  1.81886530e-02]]
grads:  [-0.03207906  6.03983636]
Stock Position:  -0.03207905917525012
Bond Position:  [13.88695826]


portfolio before change:  [10.5095238]
curr_Stock_Price:  105.50121368744352
curr_Factors:  [1.05501214e+02 3.98019889e-02]
mat_Sqrt:  [[ 2.10479519e+01  0.00000000e+00]
 [-7.98017432e-03  1.82848765e-02]]
grads:  [ 1.75110813e-03 -8.77987650e+00]
Stock Position:  0.0017511081322606759
Bond Position:  [10.32477977]


portfolio before change:  [10.50578316]
curr_Stock_Price:  100.4162483453763
curr_Factors:  [1.00416248e+02 4.43457575e-02]
mat_Sqrt:  [[ 2.11460878e+01  0.00000000e+00]
 [-8.42337295e-03  1.93003721e-02]]
grads:  [-0.00106286  0.76538001]
Stock Position:  -0.0010628557837551145
Bond Position:  [10.61251115]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.51488766]
Stock Price:  96.84387508708689
PL:  [10.51488766]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.03437658e-01  3.27970923e-01]
 [-2.28869172e-02  2.30135555e-01]
 [-9.85817826e-02  1.09112923e-02]
 [-1.55490103e-01 -4.26045577e-01]
 [ 6.39702124e-02  2.30402657e-01]
 [ 3.13438624e-01 -6.08297900e-01]
 [-6.71494267e-01  9.82910313e-02]
 [-9.54840974e-03  2.85928434e-02]
 [-2.71465100e-02  4.79765289e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.03780352]
curr_Stock_Price:  101.14478555530921
curr_Factors:  [1.01144786e+02 3.92630055e-02]
mat_Sqrt:  [[ 2.00417328e+01  0.00000000e+00]
 [-7.92595791e-03  1.81606510e-02]]
grads:  [-3.00869256e-03  1.80594254e+01]
Stock Position:  -0.0030086925562568764
Bond Position:  [10.34211708]


portfolio before change:  [10.03430912]
curr_Stock_Price:  104.02535711038841
curr_Factors:  [1.04025357e+02 3.53712774e-02]
mat_Sqrt:  [[ 1.95643123e+01  0.00000000e+00]
 [-7.52290129e-03  1.72371323e-02]]
grads:  [3.96397644e-03 1.33511509e+01]
Stock Position:  0.003963976441819573
Bond Position:  [9.62195505]


portfolio before change:  [10.04347655]
curr_Stock_Price:  105.12406591756083
curr_Factors:  [1.05124066e+02 3.35775622e-02]
mat_Sqrt:  [[ 1.92631245e+01  0.00000000e+00]
 [-7.32967253e-03  1.67943896e-02]]
grads:  [-0.00487043  0.64969865]
Stock Position:  -0.0048704302554872445
Bond Position:  [10.55547598]


portfolio before change:  [10.06543372]
curr_Stock_Price:  101.69970534516845
curr_Factors:  [1.01699705e+02 3.69731298e-02]
mat_Sqrt:  [[ 1.95552243e+01  0.00000000e+00]
 [-7.69135929e-03  1.76231181e-02]]
grads:  [-1.74598681e-02 -2.41753801e+01]
Stock Position:  -0.017459868074108344
Bond Position:  [11.84109716]


portfolio before change:  [10.07055918]
curr_Stock_Price:  101.74532845736357
curr_Factors:  [1.01745328e+02 3.37391513e-02]
mat_Sqrt:  [[ 1.86888060e+01  0.00000000e+00]
 [-7.34728808e-03  1.68347519e-02]]
grads:  [8.80346107e-03 1.36861332e+01]
Stock Position:  0.008803461071290616
Bond Position:  [9.17484814]


portfolio before change:  [10.07910084]
curr_Stock_Price:  102.19436738809534
curr_Factors:  [1.02194367e+02 3.26886261e-02]
mat_Sqrt:  [[ 1.84767377e+01  0.00000000e+00]
 [-7.23199846e-03  1.65705902e-02]]
grads:  [ 2.59546118e-03 -3.67094891e+01]
Stock Position:  0.002595461182094348
Bond Position:  [9.81385933]


portfolio before change:  [10.08667987]
curr_Stock_Price:  103.22342009958021
curr_Factors:  [1.03223420e+02 3.38177749e-02]
mat_Sqrt:  [[ 1.89823842e+01  0.00000000e+00]
 [-7.35584393e-03  1.68543558e-02]]
grads:  [-0.03311473  5.83178809]
Stock Position:  -0.03311473085914324
Bond Position:  [13.50489564]


portfolio before change:  [10.12340468]
curr_Stock_Price:  102.31836437127942
curr_Factors:  [1.02318364e+02 3.62788367e-02]
mat_Sqrt:  [[ 1.94885831e+01  0.00000000e+00]
 [-7.61880166e-03  1.74568677e-02]]
grads:  [1.50371638e-04 1.63791374e+00]
Stock Position:  0.00015037163765695575
Bond Position:  [10.1080189]


portfolio before change:  [10.12839254]
curr_Stock_Price:  101.8700641925419
curr_Factors:  [1.01870064e+02 3.50934974e-02]
mat_Sqrt:  [[ 1.90835825e+01  0.00000000e+00]
 [-7.49330340e-03  1.71693150e-02]]
grads:  [-3.25297214e-04  2.79431817e+00]
Stock Position:  -0.000325297213713517
Bond Position:  [10.16153059]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.13449245]
Stock Price:  98.74100906372976
PL:  [10.13449245]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.52414126e-01  2.27671006e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 1.47448291e-01 -5.54888065e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.44722246e-01 -1.36686871e+00]
 [-1.05617425e+00  2.70533886e-01]
 [-4.70582033e-02  1.66311976e-02]
 [-2.26589236e-02 -2.06242458e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.87947291]
curr_Stock_Price:  97.24133176347488
curr_Factors:  [9.72413318e+01 3.90888829e-02]
mat_Sqrt:  [[ 1.92254949e+01  0.00000000e+00]
 [-7.90836346e-03  1.81203371e-02]]
grads:  [-0.04437079 12.56439129]
Stock Position:  -0.04437078777356012
Bond Position:  [-11.56479842]


portfolio before change:  [-15.7733956]
curr_Stock_Price:  94.72027752941152
curr_Factors:  [9.47202775e+01 4.09816796e-02]
mat_Sqrt:  [[ 1.91751089e+01  0.00000000e+00]
 [-8.09757293e-03  1.85538705e-02]]
grads:  [ 0.00490009 -2.54809437]
Stock Position:  0.004900085394326136
Bond Position:  [-16.23753305]


portfolio before change:  [-15.78587641]
curr_Stock_Price:  93.83049316899786
curr_Factors:  [9.38304932e+01 4.14127802e-02]
mat_Sqrt:  [[ 1.90946276e+01  0.00000000e+00]
 [-8.14005211e-03  1.86512025e-02]]
grads:  [ 0.02109317 10.44999082]
Stock Position:  0.021093167669227874
Bond Position:  [-17.76505874]


portfolio before change:  [-15.86061888]
curr_Stock_Price:  90.70826345583805
curr_Factors:  [9.07082635e+01 4.32376361e-02]
mat_Sqrt:  [[ 1.88615693e+01  0.00000000e+00]
 [-8.31746463e-03  1.90577056e-02]]
grads:  [-5.02210145e-03 -2.91162051e+01]
Stock Position:  -0.005022101447359181
Bond Position:  [-15.40507278]


portfolio before change:  [-15.87630535]
curr_Stock_Price:  92.29764070197851
curr_Factors:  [9.22976407e+01 4.25789417e-02]
mat_Sqrt:  [[ 1.90453094e+01  0.00000000e+00]
 [-8.25386617e-03  1.89119833e-02]]
grads:  [-3.69997664e-03 -4.50481560e+00]
Stock Position:  -0.0036999766415165094
Bond Position:  [-15.53480624]


portfolio before change:  [-15.89076663]
curr_Stock_Price:  94.1062828189059
curr_Factors:  [9.41062828e+01 4.13988153e-02]
mat_Sqrt:  [[ 1.91475219e+01  0.00000000e+00]
 [-8.13867952e-03  1.86480575e-02]]
grads:  [-7.92938982e-03 -7.32981818e+01]
Stock Position:  -0.007929389817590768
Bond Position:  [-15.14456123]


portfolio before change:  [-15.91468622]
curr_Stock_Price:  96.16765392189386
curr_Factors:  [9.61676539e+01 4.23833809e-02]
mat_Sqrt:  [[ 1.97982507e+01  0.00000000e+00]
 [-8.23488977e-03  1.88685028e-02]]
grads:  [-0.04738315 14.33785651]
Stock Position:  -0.04738315497989396
Bond Position:  [-11.35795937]


portfolio before change:  [-15.9576723]
curr_Stock_Price:  96.95497324213012
curr_Factors:  [9.69549732e+01 3.99920619e-02]
mat_Sqrt:  [[ 1.93890704e+01  0.00000000e+00]
 [-7.99920615e-03  1.83284838e-02]]
grads:  [-0.00205269  0.90739625]
Stock Position:  -0.002052690134189154
Bond Position:  [-15.75865378]


portfolio before change:  [-15.9608057]
curr_Stock_Price:  94.64196102270486
curr_Factors:  [9.46419610e+01 4.17422104e-02]
mat_Sqrt:  [[ 1.93362143e+01  0.00000000e+00]
 [-8.17236420e-03  1.87252388e-02]]
grads:  [-5.82691676e-03 -1.10141430e+01]
Stock Position:  -0.00582691676259149
Bond Position:  [-15.40933487]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.9574669]
Stock Price:  92.74638110535902
PL:  [-15.9574669]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.79585912e-03  1.13769230e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 8.95186868e-02  6.03086287e-02]
 [-1.19729475e-01 -5.00640102e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.14019797e-01 -1.03648385e+00]
 [-1.06870757e+00  2.65514191e-01]
 [-6.18873521e-02 -1.26690476e-05]
 [-2.71428781e-02  4.77193856e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.11317078]
curr_Stock_Price:  101.90919695576233
curr_Factors:  [1.01909197e+02 3.59959620e-02]
mat_Sqrt:  [[ 1.93348262e+01  0.00000000e+00]
 [-7.58904073e-03  1.73886768e-02]]
grads:  [2.76438078e-03 6.54271922e+00]
Stock Position:  0.0027643807782596484
Bond Position:  [14.83145495]


portfolio before change:  [15.11786121]
curr_Stock_Price:  100.92266499821444
curr_Factors:  [1.00922665e+02 3.71277750e-02]
mat_Sqrt:  [[ 1.94463533e+01  0.00000000e+00]
 [-7.70742759e-03  1.76599352e-02]]
grads:  [ 0.00483174 -2.67707737]
Stock Position:  0.004831737318151369
Bond Position:  [14.6302294]


portfolio before change:  [15.11717113]
curr_Stock_Price:  99.265492073398
curr_Factors:  [9.92654921e+01 3.56562440e-02]
mat_Sqrt:  [[ 1.87441649e+01  0.00000000e+00]
 [-7.55314441e-03  1.73064280e-02]]
grads:  [0.00618003 3.4847531 ]
Stock Position:  0.006180031532870711
Bond Position:  [14.50370726]


portfolio before change:  [15.10917159]
curr_Stock_Price:  96.79734853611328
curr_Factors:  [9.67973485e+01 3.53908825e-02]
mat_Sqrt:  [[ 1.82099669e+01  0.00000000e+00]
 [-7.52498585e-03  1.72419086e-02]]
grads:  [-1.85737146e-02 -2.90362345e+01]
Stock Position:  -0.01857371458330561
Bond Position:  [16.90705792]


portfolio before change:  [15.12853894]
curr_Stock_Price:  96.20986748409966
curr_Factors:  [9.62098675e+01 3.32890305e-02]
mat_Sqrt:  [[ 1.75537614e+01  0.00000000e+00]
 [-7.29811269e-03  1.67220769e-02]]
grads:  [-4.01436469e-03 -5.09476171e+00]
Stock Position:  -0.004014364687434142
Bond Position:  [15.51476044]


portfolio before change:  [15.13273524]
curr_Stock_Price:  97.09743531018246
curr_Factors:  [9.70974353e+01 3.20366011e-02]
mat_Sqrt:  [[ 1.73792478e+01  0.00000000e+00]
 [-7.15950849e-03  1.64044948e-02]]
grads:  [-2.20601275e-03 -6.31829182e+01]
Stock Position:  -0.00220601274933577
Bond Position:  [15.34693342]


portfolio before change:  [15.14155783]
curr_Stock_Price:  96.57740155229796
curr_Factors:  [9.65774016e+01 3.41048290e-02]
mat_Sqrt:  [[ 1.78354247e+01  0.00000000e+00]
 [-7.38699712e-03  1.69257367e-02]]
grads:  [-0.05342332 15.68700941]
Stock Position:  -0.05342332460204833
Bond Position:  [20.3010437]


portfolio before change:  [15.08696493]
curr_Stock_Price:  97.78934336129875
curr_Factors:  [9.77893434e+01 3.30998290e-02]
mat_Sqrt:  [[ 1.77911657e+01  0.00000000e+00]
 [-7.27734336e-03  1.66744884e-02]]
grads:  [-0.00347885 -0.00075979]
Stock Position:  -0.0034788547513495576
Bond Position:  [15.42715985]


portfolio before change:  [15.08050629]
curr_Stock_Price:  101.86371340424185
curr_Factors:  [1.01863713e+02 3.45494670e-02]
mat_Sqrt:  [[ 1.89339044e+01  0.00000000e+00]
 [-7.43499477e-03  1.70357132e-02]]
grads:  [-3.33604244e-04  2.80113812e+00]
Stock Position:  -0.0003336042439615599
Bond Position:  [15.11448846]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.08833395]
Stock Price:  101.05880843683101
PL:  [14.02952551]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-6.88523758e-01  2.94564195e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.93575603e-02 -5.49982313e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.34703329e-01 -1.26355624e+00]
 [-1.02540473e+00  2.81961899e-01]
 [ 1.09595136e-02  9.36435396e-02]
 [-2.42134913e-02 -1.98831823e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.66031989]
curr_Stock_Price:  98.47923514097245
curr_Factors:  [9.84792351e+01 3.67661521e-02]
mat_Sqrt:  [[ 1.88829028e+01  0.00000000e+00]
 [-7.66980074e-03  1.75737212e-02]]
grads:  [-0.02965463 16.76162896]
Stock Position:  -0.029654625153671902
Bond Position:  [-4.73995509]


portfolio before change:  [-7.62145269]
curr_Stock_Price:  97.08863329273271
curr_Factors:  [9.70886333e+01 4.05096768e-02]
mat_Sqrt:  [[ 1.95410446e+01  0.00000000e+00]
 [-8.05080634e-03  1.84467147e-02]]
grads:  [ 0.00480832 -2.56289608]
Stock Position:  0.004808323855419495
Bond Position:  [-8.08828628]


portfolio before change:  [-7.63160094]
curr_Stock_Price:  95.81935557028036
curr_Factors:  [9.58193556e+01 4.23258636e-02]
mat_Sqrt:  [[ 1.97131561e+01  0.00000000e+00]
 [-8.22930020e-03  1.88556955e-02]]
grads:  [ 0.02043134 10.33665898]
Stock Position:  0.020431339374465778
Bond Position:  [-9.58931871]


portfolio before change:  [-7.67629538]
curr_Stock_Price:  93.86654247585102
curr_Factors:  [9.38665425e+01 4.25579184e-02]
mat_Sqrt:  [[ 1.93642647e+01  0.00000000e+00]
 [-8.25182824e-03  1.89073138e-02]]
grads:  [-1.33952683e-02 -2.90883369e+01]
Stock Position:  -0.013395268299904171
Bond Position:  [-6.41892786]


portfolio before change:  [-7.67966881]
curr_Stock_Price:  93.8787229380468
curr_Factors:  [9.38787229e+01 4.23283914e-02]
mat_Sqrt:  [[ 1.93144816e+01  0.00000000e+00]
 [-8.22954594e-03  1.88562586e-02]]
grads:  [-3.64841269e-03 -4.51812838e+00]
Stock Position:  -0.0036484126943110685
Bond Position:  [-7.33716049]


portfolio before change:  [-7.68751846]
curr_Stock_Price:  95.02446963487633
curr_Factors:  [9.50244696e+01 4.06039145e-02]
mat_Sqrt:  [[ 1.91478231e+01  0.00000000e+00]
 [-8.06016521e-03  1.84681586e-02]]
grads:  [-6.09770744e-03 -6.84180955e+01]
Stock Position:  -0.006097707441020044
Bond Position:  [-7.10808705]


portfolio before change:  [-7.69275989]
curr_Stock_Price:  95.30104829055064
curr_Factors:  [9.53010483e+01 4.28418554e-02]
mat_Sqrt:  [[ 1.97256723e+01  0.00000000e+00]
 [-8.27930968e-03  1.89702816e-02]]
grads:  [-0.04574478 14.86334809]
Stock Position:  -0.04574477665729825
Bond Position:  [-3.33323472]


portfolio before change:  [-7.59017485]
curr_Stock_Price:  93.02205426261004
curr_Factors:  [9.30220543e+01 4.24459472e-02]
mat_Sqrt:  [[ 1.91647889e+01  0.00000000e+00]
 [-8.24096569e-03  1.88824245e-02]]
grads:  [2.70438172e-03 4.95929637e+00]
Stock Position:  0.0027043817184977596
Bond Position:  [-7.841742]


portfolio before change:  [-7.58932581]
curr_Stock_Price:  94.7861890547549
curr_Factors:  [9.47861891e+01 4.21338176e-02]
mat_Sqrt:  [[ 1.94563096e+01  0.00000000e+00]
 [-8.21060949e-03  1.88128698e-02]]
grads:  [-5.70461796e-03 -1.05689257e+01]
Stock Position:  -0.005704617957637313
Bond Position:  [-7.04860682]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.59019096]
Stock Price:  94.31989309914563
PL:  [-7.59019096]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.27649453e-01  2.78909951e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.16545300e-01 -5.07674733e-01]
 [-3.34360879e-02 -8.59552138e-02]
 [ 4.14340567e-01 -1.06689959e+00]
 [-1.00075919e+00  2.39524548e-01]
 [-6.75056081e-02 -6.00438746e-03]
 [-3.69053361e-02 -2.14700822e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.64787331]
curr_Stock_Price:  99.38478196652237
curr_Factors:  [9.93847820e+01 3.94774202e-02]
mat_Sqrt:  [[ 1.97466883e+01  0.00000000e+00]
 [-7.94757021e-03  1.82101710e-02]]
grads:  [-0.01549238 15.31616319]
Stock Position:  -0.015492378528597039
Bond Position:  [-0.10816665]


portfolio before change:  [-1.63697966]
curr_Stock_Price:  98.6781282476914
curr_Factors:  [9.86781282e+01 3.97392665e-02]
mat_Sqrt:  [[ 1.96711988e+01  0.00000000e+00]
 [-7.97388402e-03  1.82704636e-02]]
grads:  [ 0.00477651 -2.58761978]
Stock Position:  0.004776509666401091
Bond Position:  [-2.10831669]


portfolio before change:  [-1.65213742]
curr_Stock_Price:  95.7254825122817
curr_Factors:  [9.57254825e+01 4.32955754e-02]
mat_Sqrt:  [[ 1.99181648e+01  0.00000000e+00]
 [-8.32303555e-03  1.90704702e-02]]
grads:  [ 0.02022105 10.22024589]
Stock Position:  0.020221048709731824
Bond Position:  [-3.58780707]


portfolio before change:  [-1.63658433]
curr_Stock_Price:  96.58337298161517
curr_Factors:  [9.6583373e+01 4.4264476e-02]
mat_Sqrt:  [[ 2.03202961e+01  0.00000000e+00]
 [-8.41564980e-03  1.92826761e-02]]
grads:  [-1.66391630e-02 -2.63280226e+01]
Stock Position:  -0.01663916296075366
Bond Position:  [-0.02951785]


portfolio before change:  [-1.64293758]
curr_Stock_Price:  96.96431106641415
curr_Factors:  [9.69643111e+01 4.50485474e-02]
mat_Sqrt:  [[ 2.05803289e+01  0.00000000e+00]
 [-8.48985723e-03  1.94527067e-02]]
grads:  [-3.44746767e-03 -4.41867629e+00]
Stock Position:  -0.003447467672099057
Bond Position:  [-1.30865626]


portfolio before change:  [-1.64274726]
curr_Stock_Price:  96.7192556499772
curr_Factors:  [9.67192556e+01 4.56783912e-02]
mat_Sqrt:  [[ 2.06713264e+01  0.00000000e+00]
 [-8.54900146e-03  1.95882231e-02]]
grads:  [-2.48133991e-03 -5.44663791e+01]
Stock Position:  -0.0024813399129533288
Bond Position:  [-1.40275391]


portfolio before change:  [-1.64695492]
curr_Stock_Price:  98.13224707144504
curr_Factors:  [9.81322471e+01 4.72476496e-02]
mat_Sqrt:  [[ 2.13305399e+01  0.00000000e+00]
 [-8.69460979e-03  1.99218537e-02]]
grads:  [-0.04201591 12.02320581]
Stock Position:  -0.04201591304440094
Bond Position:  [2.47616104]


portfolio before change:  [-1.65595668]
curr_Stock_Price:  98.37596781710594
curr_Factors:  [9.83759678e+01 4.46571766e-02]
mat_Sqrt:  [[ 2.07890502e+01  0.00000000e+00]
 [-8.45289788e-03  1.93680222e-02]]
grads:  [-0.00337322 -0.31001552]
Stock Position:  -0.0033732246926246176
Bond Position:  [-1.32411244]


portfolio before change:  [-1.65348832]
curr_Stock_Price:  97.44789896451434
curr_Factors:  [9.74478990e+01 4.74838603e-02]
mat_Sqrt:  [[ 2.12346687e+01  0.00000000e+00]
 [-8.71631668e-03  1.99715905e-02]]
grads:  [-0.00217925 -1.07503117]
Stock Position:  -0.002179249832846584
Bond Position:  [-1.441125]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.65567146]
Stock Price:  98.11895431229377
PL:  [-1.65567146]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.95904959e-01 -2.87882990e-01]
 [-5.34927465e-02  2.33583833e-01]
 [-9.87079703e-02  1.00129559e-02]
 [-1.36214214e-01 -4.57134120e-01]
 [ 2.01243654e-03  4.37928667e-02]
 [ 3.36088445e-01 -6.24722074e-01]
 [-6.20474457e-01  7.90146467e-02]
 [-9.29283992e-03  2.80140886e-02]
 [-3.50201041e-02  1.36414413e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.55085777]
curr_Stock_Price:  103.18001417946259
curr_Factors:  [1.03180014e+02 3.77646740e-02]
mat_Sqrt:  [[ 2.00511116e+01  0.00000000e+00]
 [-7.77325404e-03  1.78107625e-02]]
grads:  [ 1.34786803e-02 -1.61634287e+01]
Stock Position:  0.013478680273739526
Bond Position:  [22.16012735]


portfolio before change:  [23.58504308]
curr_Stock_Price:  104.89401569543348
curr_Factors:  [1.04894016e+02 3.51415924e-02]
mat_Sqrt:  [[ 1.96635275e+01  0.00000000e+00]
 [-7.49843636e-03  1.71810761e-02]]
grads:  [2.46403377e-03 1.35954134e+01]
Stock Position:  0.0024640337699545828
Bond Position:  [23.32658069]


portfolio before change:  [23.59596851]
curr_Stock_Price:  104.59337933678523
curr_Factors:  [1.04593379e+02 3.49778112e-02]
mat_Sqrt:  [[ 1.95614259e+01  0.00000000e+00]
 [-7.48094232e-03  1.71409922e-02]]
grads:  [-0.00482265  0.58415264]
Stock Position:  -0.004822652414924731
Bond Position:  [24.10038603]


portfolio before change:  [23.61110728]
curr_Stock_Price:  103.95357256756257
curr_Factors:  [1.03953573e+02 3.32440117e-02]
mat_Sqrt:  [[ 1.89537930e+01  0.00000000e+00]
 [-7.29317617e-03  1.67107659e-02]]
grads:  [-1.77127555e-02 -2.73556653e+01]
Stock Position:  -0.017712755494563456
Bond Position:  [25.4524115]


portfolio before change:  [23.70523999]
curr_Stock_Price:  99.35782714259527
curr_Factors:  [9.93578271e+01 3.55971516e-02]
mat_Sqrt:  [[ 1.87460474e+01  0.00000000e+00]
 [-7.54688298e-03  1.72920812e-02]]
grads:  [1.12691546e-03 2.53253880e+00]
Stock Position:  0.0011269154561250876
Bond Position:  [23.59327212]


portfolio before change:  [23.71946298]
curr_Stock_Price:  101.50830087613349
curr_Factors:  [1.01508301e+02 3.21603311e-02]
mat_Sqrt:  [[ 1.82037899e+01  0.00000000e+00]
 [-7.17332069e-03  1.64361425e-02]]
grads:  [ 3.48484462e-03 -3.80090446e+01]
Stock Position:  0.00348484462096182
Bond Position:  [23.36572232]


portfolio before change:  [23.73979043]
curr_Stock_Price:  103.9880867432249
curr_Factors:  [1.03988087e+02 3.11320577e-02]
mat_Sqrt:  [[ 1.83479480e+01  0.00000000e+00]
 [-7.05771155e-03  1.61712487e-02]]
grads:  [-0.03193761  4.88611907]
Stock Position:  -0.03193761162538884
Bond Position:  [27.06092155]


portfolio before change:  [23.80626731]
curr_Stock_Price:  102.33038475384744
curr_Factors:  [1.02330385e+02 3.09208659e-02]
mat_Sqrt:  [[ 1.79941125e+01  0.00000000e+00]
 [-7.03373197e-03  1.61163046e-02]]
grads:  [1.63026139e-04 1.73824517e+00]
Stock Position:  0.0001630261392958607
Bond Position:  [23.78958478]


portfolio before change:  [23.81853056]
curr_Stock_Price:  104.57224008468394
curr_Factors:  [1.04572240e+02 3.05212747e-02]
mat_Sqrt:  [[ 1.82691249e+01  0.00000000e+00]
 [-6.98813563e-03  1.60118302e-02]]
grads:  [1.34193767e-03 8.51960153e+00]
Stock Position:  0.0013419376685984208
Bond Position:  [23.67820113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.83309237]
Stock Price:  106.59897115728513
PL:  [17.23412121]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.17993707e-01  2.78048878e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.94157028e-02  4.97457144e-03]
 [-1.15896796e-01 -4.75349575e-01]
 [ 1.52538302e-01  6.03819947e-01]
 [ 1.65823355e-01 -7.48207217e-01]
 [-2.88100110e-01 -4.65690782e-02]
 [ 1.87273815e-01 -2.87694484e-01]
 [-4.50596779e-02  2.32292077e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.41128479]
curr_Stock_Price:  99.42041504596575
curr_Factors:  [9.94204150e+01 4.09392464e-02]
mat_Sqrt:  [[ 2.01161791e+01  0.00000000e+00]
 [-8.09337966e-03  1.85442625e-02]]
grads:  [-1.47464996e-02  1.49937955e+01]
Stock Position:  -0.014746499640114123
Bond Position:  [0.05481833]


portfolio before change:  [-1.41172868]
curr_Stock_Price:  99.45237582589208
curr_Factors:  [9.94523758e+01 4.27176837e-02]
mat_Sqrt:  [[ 2.05550724e+01  0.00000000e+00]
 [-8.26730270e-03  1.89427702e-02]]
grads:  [ 0.00457112 -2.49578136]
Stock Position:  0.0045711184685641995
Bond Position:  [-1.86633727]


portfolio before change:  [-1.40276754]
curr_Stock_Price:  101.61695296413859
curr_Factors:  [1.01616953e+02 4.28786339e-02]
mat_Sqrt:  [[ 2.10419817e+01  0.00000000e+00]
 [-8.28286268e-03  1.89784226e-02]]
grads:  [-0.00462146  0.26211722]
Stock Position:  -0.004621457394661522
Bond Position:  [-0.93314913]


portfolio before change:  [-1.42155473]
curr_Stock_Price:  105.58117732247311
curr_Factors:  [1.05581177e+02 3.84785351e-02]
mat_Sqrt:  [[ 2.07107471e+01  0.00000000e+00]
 [-7.84637853e-03  1.79783118e-02]]
grads:  [-1.56129742e-02 -2.64401675e+01]
Stock Position:  -0.015612974160276063
Bond Position:  [0.22688146]


portfolio before change:  [-1.42852267]
curr_Stock_Price:  106.0347366101121
curr_Factors:  [1.06034737e+02 3.86434998e-02]
mat_Sqrt:  [[ 2.08442555e+01  0.00000000e+00]
 [-7.86317999e-03  1.80168088e-02]]
grads:  [1.99607481e-02 3.35142563e+01]
Stock Position:  0.01996074805473938
Bond Position:  [-3.54505533]


portfolio before change:  [-1.41480139]
curr_Stock_Price:  106.81097266668763
curr_Factors:  [1.06810973e+02 3.89038319e-02]
mat_Sqrt:  [[ 2.10674543e+01  0.00000000e+00]
 [-7.88962173e-03  1.80773944e-02]]
grads:  [-7.62887835e-03 -4.13891073e+01]
Stock Position:  -0.007628878348362624
Bond Position:  [-0.59995347]


portfolio before change:  [-1.43109494]
curr_Stock_Price:  108.90741465966201
curr_Factors:  [1.08907415e+02 3.91941405e-02]
mat_Sqrt:  [[ 2.15609564e+01  0.00000000e+00]
 [-7.91900403e-03  1.81447177e-02]]
grads:  [-0.01430477 -2.56653639]
Stock Position:  -0.01430477001369949
Bond Position:  [0.12680058]


portfolio before change:  [-1.41341811]
curr_Stock_Price:  107.67611821649714
curr_Factors:  [1.07676118e+02 4.09003053e-02]
mat_Sqrt:  [[ 2.17762285e+01  0.00000000e+00]
 [-8.08952956e-03  1.85354408e-02]]
grads:  [ 2.83399158e-03 -1.55213187e+01]
Stock Position:  0.0028339915759082695
Bond Position:  [-1.71857132]


portfolio before change:  [-1.41461171]
curr_Stock_Price:  107.55823009031842
curr_Factors:  [1.07558230e+02 4.23362232e-02]
mat_Sqrt:  [[ 2.21309320e+01  0.00000000e+00]
 [-8.23030723e-03  1.88580029e-02]]
grads:  [2.54489490e-03 1.23179574e+01]
Stock Position:  0.002544894902529613
Bond Position:  [-1.6883361]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.4208953]
Stock Price:  105.42092538117834
PL:  [-6.84182068]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.18888216e-01  2.76297673e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-8.67804274e-02  3.98458911e-03]
 [-1.02579940e-01 -4.87115553e-01]
 [ 1.82626493e-01  7.44196555e-01]
 [ 1.79716202e-01 -7.71887301e-01]
 [-2.55471075e-01 -5.77623358e-02]
 [ 1.74338614e-01 -2.67238325e-01]
 [-4.73248341e-02  2.54201098e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.64843454]
curr_Stock_Price:  97.5773529970902
curr_Factors:  [9.75773530e+01 4.00683949e-02]
mat_Sqrt:  [[ 1.95321480e+01  0.00000000e+00]
 [-8.00683657e-03  1.83459673e-02]]
grads:  [-0.04087118 15.06040363]
Stock Position:  -0.04087118462579168
Bond Position:  [-9.66033253]


portfolio before change:  [-13.66884418]
curr_Stock_Price:  97.95850821040779
curr_Factors:  [9.79585082e+01 4.26909633e-02]
mat_Sqrt:  [[ 2.02399828e+01  0.00000000e+00]
 [-8.26471664e-03  1.89368448e-02]]
grads:  [ 0.00464228 -2.4965623 ]
Stock Position:  0.0046422801740723975
Bond Position:  [-14.12359502]


portfolio before change:  [-13.66045312]
curr_Stock_Price:  101.28761107364978
curr_Factors:  [1.01287611e+02 4.10884327e-02]
mat_Sqrt:  [[ 2.05312843e+01  0.00000000e+00]
 [-8.10811275e-03  1.85780202e-02]]
grads:  [-0.00414204  0.21447867]
Stock Position:  -0.0041420404630617726
Bond Position:  [-13.24091573]


portfolio before change:  [-13.68927664]
curr_Stock_Price:  106.64762994516936
curr_Factors:  [1.06647630e+02 3.81979572e-02]
mat_Sqrt:  [[ 2.08435303e+01  0.00000000e+00]
 [-7.81771908e-03  1.79126447e-02]]
grads:  [-1.51209796e-02 -2.71939493e+01]
Stock Position:  -0.01512097962937126
Bond Position:  [-12.07666]


portfolio before change:  [-13.70956041]
curr_Stock_Price:  107.58962770535278
curr_Factors:  [1.07589628e+02 3.83859356e-02]
mat_Sqrt:  [[ 2.10793138e+01  0.00000000e+00]
 [-7.83693161e-03  1.79566662e-02]]
grads:  [2.40719647e-02 4.14440269e+01]
Stock Position:  0.024071964655960617
Bond Position:  [-16.29945413]


portfolio before change:  [-13.70939206]
curr_Stock_Price:  107.93526265250516
curr_Factors:  [1.07935263e+02 4.07771589e-02]
mat_Sqrt:  [[ 2.17957508e+01  0.00000000e+00]
 [-8.07734203e-03  1.85075156e-02]]
grads:  [-7.21071898e-03 -4.17066945e+01]
Stock Position:  -0.007210718983673635
Bond Position:  [-12.93110122]


portfolio before change:  [-13.72625129]
curr_Stock_Price:  109.3764580098527
curr_Factors:  [1.09376458e+02 3.66568934e-02]
mat_Sqrt:  [[ 2.09412057e+01  0.00000000e+00]
 [-7.65839601e-03  1.75475897e-02]]
grads:  [-0.01340327 -3.29175327]
Stock Position:  -0.013403269547267517
Bond Position:  [-12.26024914]


portfolio before change:  [-13.70488986]
curr_Stock_Price:  107.32523587068229
curr_Factors:  [1.07325236e+02 4.18768213e-02]
mat_Sqrt:  [[ 2.19628505e+01  0.00000000e+00]
 [-8.18553077e-03  1.87554072e-02]]
grads:  [ 2.62744798e-03 -1.42486016e+01]
Stock Position:  0.0026274479813675933
Bond Position:  [-13.98688134]


portfolio before change:  [-13.70947145]
curr_Stock_Price:  108.24384656451484
curr_Factors:  [1.08243847e+02 4.03932958e-02]
mat_Sqrt:  [[ 2.17549386e+01  0.00000000e+00]
 [-8.03923338e-03  1.84201977e-02]]
grads:  [2.92428408e-03 1.38001286e+01]
Stock Position:  0.002924284076364771
Bond Position:  [-14.02600721]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.71973211]
Stock Price:  107.13386437733263
PL:  [-20.85359649]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.73750460e-01  3.28341475e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.70749220e-01  1.07266389e-01]
 [-1.64474977e-01 -4.09753351e-01]
 [ 3.72967022e-02  1.49734258e-01]
 [ 3.61248830e-01 -7.03866418e-01]
 [-8.20008898e-01  1.55948769e-01]
 [ 3.18220678e-02 -3.86839573e-02]
 [-4.45424152e-02  2.27629613e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.81093018]
curr_Stock_Price:  100.2069434785837
curr_Factors:  [1.00206943e+02 3.65104781e-02]
mat_Sqrt:  [[ 1.91472574e+01  0.00000000e+00]
 [-7.64308608e-03  1.75125103e-02]]
grads:  [-6.81301185e-03  1.87489669e+01]
Stock Position:  -0.006813011853705171
Bond Position:  [4.49364127]


portfolio before change:  [3.8279381]
curr_Stock_Price:  98.04042216625956
curr_Factors:  [9.80404222e+01 3.64367889e-02]
mat_Sqrt:  [[ 1.87143704e+01  0.00000000e+00]
 [-7.63536916e-03  1.74948286e-02]]
grads:  [ 0.00502072 -2.70234216]
Stock Position:  0.005020723060848972
Bond Position:  [3.33570429]


portfolio before change:  [3.83107907]
curr_Stock_Price:  98.33374798636204
curr_Factors:  [9.83337480e+01 3.87438041e-02]
mat_Sqrt:  [[ 1.93554701e+01  0.00000000e+00]
 [-7.87337835e-03  1.80401761e-02]]
grads:  [0.01124045 5.9459724 ]
Stock Position:  0.011240445733433293
Bond Position:  [2.72576392]


portfolio before change:  [3.85407893]
curr_Stock_Price:  100.25863875349182
curr_Factors:  [1.00258639e+02 3.82031647e-02]
mat_Sqrt:  [[ 1.95961825e+01  0.00000000e+00]
 [-7.81825195e-03  1.79138657e-02]]
grads:  [-1.75190245e-02 -2.28735304e+01]
Stock Position:  -0.01751902449923841
Bond Position:  [5.61051247]


portfolio before change:  [3.84980499]
curr_Stock_Price:  100.66276464500321
curr_Factors:  [1.00662765e+02 3.56051320e-02]
mat_Sqrt:  [[ 1.89943814e+01  0.00000000e+00]
 [-7.54772888e-03  1.72940195e-02]]
grads:  [5.40402383e-03 8.65815249e+00]
Stock Position:  0.005404023831160913
Bond Position:  [3.30582101]


portfolio before change:  [3.84993157]
curr_Stock_Price:  100.38024355117486
curr_Factors:  [1.00380244e+02 3.77640444e-02]
mat_Sqrt:  [[ 1.95068657e+01  0.00000000e+00]
 [-7.77318924e-03  1.78106140e-02]]
grads:  [ 2.77114435e-03 -3.95194919e+01]
Stock Position:  0.0027711443508005164
Bond Position:  [3.57176342]


portfolio before change:  [3.85335132]
curr_Stock_Price:  100.96968367423302
curr_Factors:  [1.00969684e+02 3.67758356e-02]
mat_Sqrt:  [[ 1.93629833e+01  0.00000000e+00]
 [-7.67081071e-03  1.75760354e-02]]
grads:  [-0.03883427  8.87280694]
Stock Position:  -0.038834267669456815
Bond Position:  [7.77443504]


portfolio before change:  [3.76089803]
curr_Stock_Price:  103.450520424796
curr_Factors:  [1.03450520e+02 3.62206747e-02]
mat_Sqrt:  [[ 1.96884237e+01  0.00000000e+00]
 [-7.61269200e-03  1.74428687e-02]]
grads:  [ 7.58770989e-04 -2.21775202e+00]
Stock Position:  0.0007587709890502864
Bond Position:  [3.68240277]


portfolio before change:  [3.76574882]
curr_Stock_Price:  107.41631728489732
curr_Factors:  [1.07416317e+02 3.71098278e-02]
mat_Sqrt:  [[ 2.06925841e+01  0.00000000e+00]
 [-7.70556451e-03  1.76556663e-02]]
grads:  [2.64845088e-03 1.28927228e+01]
Stock Position:  0.002648450879099574
Bond Position:  [3.48126198]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.76112087]
Stock Price:  105.01150816099567
PL:  [-1.25038729]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.07146854e-01  3.25565210e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.66872004e-01  1.69129745e-01]
 [-1.12291478e-01 -5.22279050e-01]
 [ 5.81033162e-02  2.12356426e-01]
 [ 2.64787603e-01 -6.25081499e-01]
 [-7.96194966e-01  1.45406618e-01]
 [-5.36740804e-02  3.17457069e-03]
 [-3.06654691e-02  1.14631213e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.53884887]
curr_Stock_Price:  101.06963697939557
curr_Factors:  [1.01069637e+02 3.83480524e-02]
mat_Sqrt:  [[ 1.97921221e+01  0.00000000e+00]
 [-7.83306350e-03  1.79478032e-02]]
grads:  [-3.28709305e-03  1.81395576e+01]
Stock Position:  -0.0032870930534793542
Bond Position:  [9.87107417]


portfolio before change:  [9.54873598]
curr_Stock_Price:  99.56364509889895
curr_Factors:  [9.95636451e+01 3.60654952e-02]
mat_Sqrt:  [[ 1.89080498e+01  0.00000000e+00]
 [-7.59636704e-03  1.74054635e-02]]
grads:  [ 0.00496929 -2.71621683]
Stock Position:  0.00496929466409452
Bond Position:  [9.05397489]


portfolio before change:  [9.54283396]
curr_Stock_Price:  97.46472802103223
curr_Factors:  [9.7464728e+01 3.5449987e-02]
mat_Sqrt:  [[ 1.83508217e+01  0.00000000e+00]
 [-7.53126678e-03  1.72563000e-02]]
grads:  [0.01856518 9.80104336]
Stock Position:  0.018565178288505662
Bond Position:  [7.73338391]


portfolio before change:  [9.52286139]
curr_Stock_Price:  96.18059103852707
curr_Factors:  [9.61805910e+01 3.58944142e-02]
mat_Sqrt:  [[ 1.82222028e+01  0.00000000e+00]
 [-7.57832849e-03  1.73641320e-02]]
grads:  [-1.86713289e-02 -3.00780396e+01]
Stock Position:  -0.01867132892874345
Bond Position:  [11.31868084]


portfolio before change:  [9.42900571]
curr_Stock_Price:  101.51049733675002
curr_Factors:  [1.01510497e+02 3.36135636e-02]
mat_Sqrt:  [[ 1.86109368e+01  0.00000000e+00]
 [-7.33360087e-03  1.68033906e-02]]
grads:  [8.10186291e-03 1.26377129e+01]
Stock Position:  0.008101862913583365
Bond Position:  [8.60658157]


portfolio before change:  [9.44883093]
curr_Stock_Price:  103.42621113885029
curr_Factors:  [1.03426211e+02 3.32579490e-02]
mat_Sqrt:  [[ 1.88615920e+01  0.00000000e+00]
 [-7.29470482e-03  1.67142685e-02]]
grads:  [-4.25220124e-04 -3.73980769e+01]
Stock Position:  -0.00042522012367539596
Bond Position:  [9.49280983]


portfolio before change:  [9.45445482]
curr_Stock_Price:  101.365390337494
curr_Factors:  [1.01365390e+02 3.58854364e-02]
mat_Sqrt:  [[ 1.92021038e+01  0.00000000e+00]
 [-7.57738069e-03  1.73619603e-02]]
grads:  [-0.03815906  8.37501155]
Stock Position:  -0.03815906440940412
Bond Position:  [13.32246328]


portfolio before change:  [9.50857621]
curr_Stock_Price:  100.12168852734378
curr_Factors:  [1.00121689e+02 3.65726849e-02]
mat_Sqrt:  [[ 1.91472579e+01  0.00000000e+00]
 [-7.64959448e-03  1.75274229e-02]]
grads:  [-0.00273087  0.18112022]
Stock Position:  -0.0027308654034202727
Bond Position:  [9.78199507]


portfolio before change:  [9.51395155]
curr_Stock_Price:  99.94477816290133
curr_Factors:  [9.99447782e+01 3.54063258e-02]
mat_Sqrt:  [[ 1.88061779e+01  0.00000000e+00]
 [-7.52662748e-03  1.72456701e-02]]
grads:  [-0.00136458  0.66469562]
Stock Position:  -0.001364580990854259
Bond Position:  [9.6503343]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.52061989]
Stock Price:  98.59494361328213
PL:  [9.52061989]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.09572257e-01  3.27061705e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.89459995e-02  8.31841326e-03]
 [-1.45895589e-01 -4.45653755e-01]
 [ 6.50553913e-02  2.33679967e-01]
 [ 2.55628039e-01 -6.24076935e-01]
 [-8.62231361e-01  1.76612373e-01]
 [-4.26140199e-02  1.05143118e-02]
 [-3.09318455e-02  9.67157582e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.53119653]
curr_Stock_Price:  100.76726037142063
curr_Factors:  [1.00767260e+02 3.83946394e-02]
mat_Sqrt:  [[ 1.97448913e+01  0.00000000e+00]
 [-7.83782004e-03  1.79587018e-02]]
grads:  [-3.38471483e-03  1.82118791e+01]
Stock Position:  -0.0033847148307254004
Bond Position:  [7.87226497]


portfolio before change:  [7.53706754]
curr_Stock_Price:  100.19589975002151
curr_Factors:  [1.00195900e+02 3.94096094e-02]
mat_Sqrt:  [[ 1.98907434e+01  0.00000000e+00]
 [-7.94074147e-03  1.81945244e-02]]
grads:  [ 0.00472379 -2.59841982]
Stock Position:  0.004723788803747735
Bond Position:  [7.06376327]


portfolio before change:  [7.5566449]
curr_Stock_Price:  103.59245232430605
curr_Factors:  [1.03592452e+02 3.74539188e-02]
mat_Sqrt:  [[ 2.00482628e+01  0.00000000e+00]
 [-7.74120598e-03  1.77373312e-02]]
grads:  [-0.0047543   0.46897773]
Stock Position:  -0.0047543045167381375
Bond Position:  [8.04915497]


portfolio before change:  [7.5633629]
curr_Stock_Price:  103.02614064553022
curr_Factors:  [1.03026141e+02 3.60469283e-02]
mat_Sqrt:  [[ 1.95605726e+01  0.00000000e+00]
 [-7.59441145e-03  1.74009827e-02]]
grads:  [-1.74020895e-02 -2.56108384e+01]
Stock Position:  -0.017402089457100707
Bond Position:  [9.35623302]


portfolio before change:  [7.58953786]
curr_Stock_Price:  101.79090580488261
curr_Factors:  [1.01790906e+02 3.68488337e-02]
mat_Sqrt:  [[ 1.95398332e+01  0.00000000e+00]
 [-7.67842001e-03  1.75934705e-02]]
grads:  [8.54877769e-03 1.32821985e+01]
Stock Position:  0.008548777694431721
Bond Position:  [6.71935003]


portfolio before change:  [7.60862163]
curr_Stock_Price:  103.63014638180627
curr_Factors:  [1.03630146e+02 3.73128338e-02]
mat_Sqrt:  [[ 2.00177485e+01  0.00000000e+00]
 [-7.72661207e-03  1.77038923e-02]]
grads:  [-8.36331069e-04 -3.52508321e+01]
Stock Position:  -0.0008363310691799815
Bond Position:  [7.69529074]


portfolio before change:  [7.61522182]
curr_Stock_Price:  100.34008001585612
curr_Factors:  [1.00340080e+02 3.92320663e-02]
mat_Sqrt:  [[ 1.98744461e+01  0.00000000e+00]
 [-7.92283448e-03  1.81534944e-02]]
grads:  [-0.03950557  9.72883621]
Stock Position:  -0.039505574003676394
Bond Position:  [11.57921428]


portfolio before change:  [7.60716009]
curr_Stock_Price:  100.69073407901942
curr_Factors:  [1.00690734e+02 4.07590528e-02]
mat_Sqrt:  [[ 2.03283228e+01  0.00000000e+00]
 [-8.07554856e-03  1.85034063e-02]]
grads:  [-0.00187055  0.56823656]
Stock Position:  -0.0018705526440995946
Bond Position:  [7.79550741]


portfolio before change:  [7.60612551]
curr_Stock_Price:  103.32808653119736
curr_Factors:  [1.03328087e+02 3.66289701e-02]
mat_Sqrt:  [[ 1.97756488e+01  0.00000000e+00]
 [-7.65547857e-03  1.75409050e-02]]
grads:  [5.70316154e-04 5.51372681e+00]
Stock Position:  0.0005703161537838759
Bond Position:  [7.54719583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.61174836]
Stock Price:  106.56893594500349
PL:  [1.04281242]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.63682087e-01  2.12752708e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.37545933e-01 -4.47398642e-01]
 [-2.77489264e-02 -5.22273003e-02]
 [ 3.65448391e-01 -7.17076528e-01]
 [-1.01773193e+00  2.45236185e-01]
 [-5.63730970e-02  1.38343374e-03]
 [-3.39445754e-02  5.53695944e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.53471755]
curr_Stock_Price:  97.14264403430981
curr_Factors:  [9.71426440e+01 4.22973504e-02]
mat_Sqrt:  [[ 1.99786667e+01  0.00000000e+00]
 [-8.22652786e-03  1.88493433e-02]]
grads:  [-0.04358795 11.287009  ]
Stock Position:  -0.043587953417001245
Bond Position:  [-12.30046851]


portfolio before change:  [-16.47548812]
curr_Stock_Price:  95.6426607518991
curr_Factors:  [9.56426608e+01 4.41874723e-02]
mat_Sqrt:  [[ 2.01048681e+01  0.00000000e+00]
 [-8.40832657e-03  1.92658965e-02]]
grads:  [ 0.00467348 -2.45392229]
Stock Position:  0.004673478600815991
Bond Position:  [-16.92247205]


portfolio before change:  [-16.4835893]
curr_Stock_Price:  95.72015658767975
curr_Factors:  [9.57201566e+01 4.20757516e-02]
mat_Sqrt:  [[ 1.96344772e+01  0.00000000e+00]
 [-8.20494988e-03  1.87999019e-02]]
grads:  [ 0.02051321 10.36733571]
Stock Position:  0.02051321141832741
Bond Position:  [-18.44711711]


portfolio before change:  [-16.43976444]
curr_Stock_Price:  98.30632980541968
curr_Factors:  [9.83063298e+01 3.96580382e-02]
mat_Sqrt:  [[ 1.95770430e+01  0.00000000e+00]
 [-7.96573042e-03  1.82517813e-02]]
grads:  [-1.69998456e-02 -2.45126015e+01]
Stock Position:  -0.016999845585807916
Bond Position:  [-14.76857202]


portfolio before change:  [-16.44737392]
curr_Stock_Price:  98.31946777234714
curr_Factors:  [9.83194678e+01 3.98928658e-02]
mat_Sqrt:  [[ 1.96375424e+01  0.00000000e+00]
 [-7.98927939e-03  1.83057388e-02]]
grads:  [-2.57378382e-03 -2.85305613e+00]
Stock Position:  -0.002573783818193165
Bond Position:  [-16.19432086]


portfolio before change:  [-16.46028846]
curr_Stock_Price:  100.19039258557224
curr_Factors:  [1.00190393e+02 3.88284252e-02]
mat_Sqrt:  [[ 1.97424464e+01  0.00000000e+00]
 [-7.88197185e-03  1.80598663e-02]]
grads:  [ 2.65876557e-03 -3.97055280e+01]
Stock Position:  0.0026587655674454075
Bond Position:  [-16.72667123]


portfolio before change:  [-16.47500297]
curr_Stock_Price:  97.80241006075994
curr_Factors:  [9.78024101e+01 3.78492502e-02]
mat_Sqrt:  [[ 1.90273452e+01  0.00000000e+00]
 [-7.78195350e-03  1.78306955e-02]]
grads:  [-0.0478628  13.75359614]
Stock Position:  -0.04786280351849181
Bond Position:  [-11.79390544]


portfolio before change:  [-16.58453159]
curr_Stock_Price:  99.96756087827758
curr_Factors:  [9.99675609e+01 3.80720879e-02]
mat_Sqrt:  [[ 1.95057405e+01  0.00000000e+00]
 [-7.80482804e-03  1.78831076e-02]]
grads:  [-0.00285912  0.07735981]
Stock Position:  -0.002859123287172037
Bond Position:  [-16.29871201]


portfolio before change:  [-16.59004603]
curr_Stock_Price:  99.04526752399634
curr_Factors:  [9.90452675e+01 3.71084669e-02]
mat_Sqrt:  [[ 1.90796426e+01  0.00000000e+00]
 [-7.70542322e-03  1.76553426e-02]]
grads:  [-0.00165244  0.31361382]
Stock Position:  -0.0016524443781364903
Bond Position:  [-16.42637924]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.59988907]
Stock Price:  100.0303478145812
PL:  [-16.63023688]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.55885437e-01  3.42971871e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.09309653e-01  1.91673791e-01]
 [-1.02941865e-01 -5.50032256e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.66187408e-01 -1.57208442e+00]
 [-9.76745487e-01  2.98784482e-01]
 [ 1.08096281e-02  9.54881848e-02]
 [-3.27852588e-02 -2.04472918e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.77788111]
curr_Stock_Price:  100.35257792728984
curr_Factors:  [1.00352578e+02 3.84096098e-02]
mat_Sqrt:  [[ 1.96674693e+01  0.00000000e+00]
 [-7.83934791e-03  1.79622026e-02]]
grads:  [-5.39979188e-03  1.90940876e+01]
Stock Position:  -0.005399791881812027
Bond Position:  [5.31976414]


portfolio before change:  [4.78661905]
curr_Stock_Price:  99.227091460193
curr_Factors:  [9.92270915e+01 3.73535880e-02]
mat_Sqrt:  [[ 1.91776957e+01  0.00000000e+00]
 [-7.73083054e-03  1.77135581e-02]]
grads:  [ 0.00489942 -2.66897326]
Stock Position:  0.004899424432632806
Bond Position:  [4.30046341]


portfolio before change:  [4.77839763]
curr_Stock_Price:  97.11007072159006
curr_Factors:  [9.71100707e+01 3.49562760e-02]
mat_Sqrt:  [[ 1.81562791e+01  0.00000000e+00]
 [-7.47863902e-03  1.71357147e-02]]
grads:  [ 0.02164336 11.18563156]
Stock Position:  0.02164336379375533
Bond Position:  [2.67660904]


portfolio before change:  [4.74257014]
curr_Stock_Price:  95.39286387709107
curr_Factors:  [9.53928639e+01 3.36928741e-02]
mat_Sqrt:  [[ 1.75099504e+01  0.00000000e+00]
 [-7.34224751e-03  1.68232025e-02]]
grads:  [-1.95886118e-02 -3.26948603e+01]
Stock Position:  -0.019588611831723914
Bond Position:  [6.61118392]


portfolio before change:  [4.76658388]
curr_Stock_Price:  94.33575378073975
curr_Factors:  [9.43357538e+01 3.41273829e-02]
mat_Sqrt:  [[ 1.74272081e+01  0.00000000e+00]
 [-7.38943927e-03  1.69313324e-02]]
grads:  [-4.04351629e-03 -5.03179520e+00]
Stock Position:  -0.0040435162891196245
Bond Position:  [5.14803203]


portfolio before change:  [4.7772017]
curr_Stock_Price:  92.34660357319387
curr_Factors:  [9.23466036e+01 3.50010476e-02]
mat_Sqrt:  [[ 1.72767261e+01  0.00000000e+00]
 [-7.48342676e-03  1.71466848e-02]]
grads:  [-1.27296387e-02 -9.16844530e+01]
Stock Position:  -0.012729638714950581
Bond Position:  [5.9527406]


portfolio before change:  [4.7588974]
curr_Stock_Price:  94.01840389609805
curr_Factors:  [9.40184039e+01 3.21973964e-02]
mat_Sqrt:  [[ 1.68703173e+01  0.00000000e+00]
 [-7.17745319e-03  1.64456113e-02]]
grads:  [-0.05016771 18.16803748]
Stock Position:  -0.0501677136570485
Bond Position:  [9.47558576]


portfolio before change:  [4.82182552]
curr_Stock_Price:  92.85851160464814
curr_Factors:  [9.28585116e+01 3.15046065e-02]
mat_Sqrt:  [[ 1.64819559e+01  0.00000000e+00]
 [-7.09981481e-03  1.62677194e-02]]
grads:  [3.18433618e-03 5.86979542e+00]
Stock Position:  0.0031843361840377107
Bond Position:  [4.5261328]


portfolio before change:  [4.82678433]
curr_Stock_Price:  93.70489805542758
curr_Factors:  [9.37048981e+01 3.29809761e-02]
mat_Sqrt:  [[ 1.70174328e+01  0.00000000e+00]
 [-7.26426608e-03  1.66445246e-02]]
grads:  [-7.17056195e-03 -1.22846956e+01]
Stock Position:  -0.007170561951090799
Bond Position:  [5.49870111]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.82499659]
Stock Price:  94.33773226969039
PL:  [4.82499659]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.05464658e+00  8.24551657e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-3.85255006e-02 -5.48518880e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.60279931e-01 -1.52671886e+00]
 [-9.54491602e-01  3.07956379e-01]
 [ 7.50294368e-02  8.96026898e-02]
 [-3.10441686e-02 -1.92807479e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.47927977]
curr_Stock_Price:  96.24732141090729
curr_Factors:  [9.62473214e+01 4.37092426e-02]
mat_Sqrt:  [[ 2.01221922e+01  0.00000000e+00]
 [-8.36270221e-03  1.91613579e-02]]
grads:  [-0.05062372  4.30320053]
Stock Position:  -0.05062371879727337
Bond Position:  [-17.60688243]


portfolio before change:  [-22.67361041]
curr_Stock_Price:  99.91210560855897
curr_Factors:  [9.99121056e+01 4.12634348e-02]
mat_Sqrt:  [[ 2.02955488e+01  0.00000000e+00]
 [-8.12536127e-03  1.86175415e-02]]
grads:  [ 0.00462957 -2.53938001]
Stock Position:  0.004629570347383825
Bond Position:  [-23.13616054]


portfolio before change:  [-22.69978003]
curr_Stock_Price:  96.75875945609239
curr_Factors:  [9.67587595e+01 4.18054002e-02]
mat_Sqrt:  [[ 1.97836529e+01  0.00000000e+00]
 [-8.17854756e-03  1.87394066e-02]]
grads:  [ 0.02035853 10.40080396]
Stock Position:  0.02035853456102606
Bond Position:  [-24.66964657]


portfolio before change:  [-22.76319985]
curr_Stock_Price:  94.24964402054343
curr_Factors:  [9.42496440e+01 4.55376356e-02]
mat_Sqrt:  [[ 2.01124491e+01  0.00000000e+00]
 [-8.53581964e-03  1.95580198e-02]]
grads:  [-1.38182459e-02 -2.80457268e+01]
Stock Position:  -0.013818245856447928
Bond Position:  [-21.46083509]


portfolio before change:  [-22.79465207]
curr_Stock_Price:  95.74904720087531
curr_Factors:  [9.57490472e+01 4.28274805e-02]
mat_Sqrt:  [[ 1.98150752e+01  0.00000000e+00]
 [-8.27792056e-03  1.89670988e-02]]
grads:  [-3.55624186e-03 -4.49172528e+00]
Stock Position:  -0.0035562418592653845
Bond Position:  [-22.4541453]


portfolio before change:  [-22.79499582]
curr_Stock_Price:  92.6879133171563
curr_Factors:  [9.26879133e+01 4.23435058e-02]
mat_Sqrt:  [[ 1.90728903e+01  0.00000000e+00]
 [-8.23101508e-03  1.88596248e-02]]
grads:  [-1.08024953e-02 -8.09517092e+01]
Stock Position:  -0.01080249529189875
Bond Position:  [-21.79373507]


portfolio before change:  [-22.8128169]
curr_Stock_Price:  93.32864392818817
curr_Factors:  [9.33286439e+01 4.06676116e-02]
mat_Sqrt:  [[ 1.88208524e+01  0.00000000e+00]
 [-8.06648489e-03  1.84826388e-02]]
grads:  [-0.04357339 16.66192705]
Stock Position:  -0.04357339413051011
Bond Position:  [-18.74617111]


portfolio before change:  [-22.71952531]
curr_Stock_Price:  90.9724579202444
curr_Factors:  [9.09724579e+01 4.25724919e-02]
mat_Sqrt:  [[ 1.87704405e+01  0.00000000e+00]
 [-8.25324100e-03  1.89105508e-02]]
grads:  [0.00608058 4.73823797]
Stock Position:  0.006080584882331425
Bond Position:  [-23.27269106]


portfolio before change:  [-22.72570789]
curr_Stock_Price:  91.86984950258241
curr_Factors:  [9.18698495e+01 4.21822465e-02]
mat_Sqrt:  [[ 1.88685209e+01  0.00000000e+00]
 [-8.21532680e-03  1.88236785e-02]]
grads:  [-6.10499634e-03 -1.02428162e+01]
Stock Position:  -0.006104996338405873
Bond Position:  [-22.1648428]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.73320993]
Stock Price:  91.28292735899213
PL:  [-22.73320993]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.09803173e-01  3.26331455e-01]
 [-5.97711658e-02  2.34723355e-01]
 [-9.86474974e-02  1.04434653e-02]
 [-1.08526307e-01 -4.81757652e-01]
 [ 1.77670342e-01  7.21073605e-01]
 [ 1.80386148e-01 -6.53049201e-01]
 [-6.79903836e-01  1.01468160e-01]
 [-6.72623556e-02 -5.84295887e-03]
 [-3.83873631e-02 -2.55947578e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.00677]
curr_Stock_Price:  101.59194764420911
curr_Factors:  [1.01591948e+02 4.28054313e-02]
mat_Sqrt:  [[ 2.10188391e+01  0.00000000e+00]
 [-8.27578939e-03  1.89622157e-02]]
grads:  [1.55191969e-03 1.72095635e+01]
Stock Position:  0.0015519196925157161
Bond Position:  [12.84910746]


portfolio before change:  [13.01855019]
curr_Stock_Price:  105.04188644417422
curr_Factors:  [1.05041886e+02 3.77084317e-02]
mat_Sqrt:  [[ 2.03977257e+01  0.00000000e+00]
 [-7.76746360e-03  1.77974949e-02]]
grads:  [2.09192462e-03 1.31885614e+01]
Stock Position:  0.0020919246221999606
Bond Position:  [12.79881048]


portfolio before change:  [13.02454329]
curr_Stock_Price:  104.84689644122246
curr_Factors:  [1.04846896e+02 3.54779541e-02]
mat_Sqrt:  [[ 1.97485340e+01  0.00000000e+00]
 [-7.53423696e-03  1.72631056e-02]]
grads:  [-0.00476438  0.60495867]
Stock Position:  -0.004764383787187485
Bond Position:  [13.52407414]


portfolio before change:  [13.02499743]
curr_Stock_Price:  106.17122012503833
curr_Factors:  [1.06171220e+02 3.60931979e-02]
mat_Sqrt:  [[ 2.01706313e+01  0.00000000e+00]
 [-7.59928396e-03  1.74121470e-02]]
grads:  [-1.58042939e-02 -2.76679063e+01]
Stock Position:  -0.0158042938659704
Bond Position:  [14.70295859]


portfolio before change:  [13.01400592]
curr_Stock_Price:  107.33197004665388
curr_Factors:  [1.0733197e+02 3.6597263e-02]
mat_Sqrt:  [[ 2.05330472e+01  0.00000000e+00]
 [-7.65216446e-03  1.75333114e-02]]
grads:  [2.39795224e-02 4.11259224e+01]
Stock Position:  0.023979522375053863
Bond Position:  [10.44023654]


portfolio before change:  [12.97343646]
curr_Stock_Price:  105.42238729856818
curr_Factors:  [1.05422387e+02 3.53066179e-02]
mat_Sqrt:  [[ 1.98089249e+01  0.00000000e+00]
 [-7.51602213e-03  1.72213702e-02]]
grads:  [-5.28185607e-03 -3.79208620e+01]
Stock Position:  -0.005281856068547337
Bond Position:  [13.53026233]


portfolio before change:  [12.99249482]
curr_Stock_Price:  103.09526301029447
curr_Factors:  [1.03095263e+02 3.51308303e-02]
mat_Sqrt:  [[ 1.93233722e+01  0.00000000e+00]
 [-7.49728808e-03  1.71784451e-02]]
grads:  [-0.03289382  5.90671388]
Stock Position:  -0.0328938187005825
Bond Position:  [16.38369171]


portfolio before change:  [13.16206495]
curr_Stock_Price:  98.18928833404503
curr_Factors:  [9.81892883e+01 3.49057984e-02]
mat_Sqrt:  [[ 1.83447966e+01  0.00000000e+00]
 [-7.47323742e-03  1.71233381e-02]]
grads:  [-0.00380557 -0.34122779]
Stock Position:  -0.0038055713313029102
Bond Position:  [13.53573129]


portfolio before change:  [13.17020417]
curr_Stock_Price:  97.82937921878226
curr_Factors:  [9.78293792e+01 3.52454648e-02]
mat_Sqrt:  [[ 1.83662681e+01  0.00000000e+00]
 [-7.50951022e-03  1.72064495e-02]]
grads:  [-0.00215092 -0.14875095]
Stock Position:  -0.0021509219933694554
Bond Position:  [13.38062753]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.17311779]
Stock Price:  99.5860075084543
PL:  [13.17311779]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.06480913e-01  2.82519568e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 9.61688223e-02 -5.52860447e-01]
 [-3.22272230e-02 -5.76439893e-02]
 [ 5.49180968e-01 -2.44179321e+00]
 [-5.78427450e-01  4.31432169e-01]
 [ 2.83827057e-01 -3.93616550e-02]
 [ 1.45227476e-01 -1.46339954e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.14017751]
curr_Stock_Price:  97.65390262374486
curr_Factors:  [9.76539026e+01 4.21087859e-02]
mat_Sqrt:  [[ 2.00389962e+01  0.00000000e+00]
 [-8.20817016e-03  1.88072805e-02]]
grads:  [-0.03908276 15.02181922]
Stock Position:  -0.039082759189419794
Bond Position:  [-9.32359355]


portfolio before change:  [-12.9942825]
curr_Stock_Price:  93.80161644870216
curr_Factors:  [9.38016164e+01 4.20789662e-02]
mat_Sqrt:  [[ 1.92416740e+01  0.00000000e+00]
 [-8.20526330e-03  1.88006201e-02]]
grads:  [ 0.00488313 -2.51465178]
Stock Position:  0.00488313391508747
Bond Position:  [-13.45232835]


portfolio before change:  [-13.00095155]
curr_Stock_Price:  93.81365661042375
curr_Factors:  [9.38136566e+01 4.51042847e-02]
mat_Sqrt:  [[ 1.99239280e+01  0.00000000e+00]
 [-8.49510774e-03  1.94647371e-02]]
grads:  [ 0.0202152  10.01323026]
Stock Position:  0.020215199601949434
Bond Position:  [-14.89741335]


portfolio before change:  [-13.05131543]
curr_Stock_Price:  91.6908329102937
curr_Factors:  [9.16908329e+01 4.47942712e-02]
mat_Sqrt:  [[ 1.94060504e+01  0.00000000e+00]
 [-8.46586285e-03  1.93977287e-02]]
grads:  [-7.47804192e-03 -2.85012981e+01]
Stock Position:  -0.007478041916558816
Bond Position:  [-12.36564753]


portfolio before change:  [-13.02557299]
curr_Stock_Price:  87.42142564410241
curr_Factors:  [8.74214256e+01 4.88350841e-02]
mat_Sqrt:  [[ 1.93189649e+01  0.00000000e+00]
 [-8.83946461e-03  2.02537578e-02]]
grads:  [-0.0029704 -2.8460886]
Stock Position:  -0.0029704035719458973
Bond Position:  [-12.76589607]


portfolio before change:  [-13.02346323]
curr_Stock_Price:  84.56178017442714
curr_Factors:  [8.45617802e+01 4.85680712e-02]
mat_Sqrt:  [[ 1.86358646e+01  0.00000000e+00]
 [-8.81526596e-03  2.01983118e-02]]
grads:  [-2.77156423e-02 -1.20890955e+02]
Stock Position:  -0.027715642289339287
Bond Position:  [-10.67977918]


portfolio before change:  [-13.05344037]
curr_Stock_Price:  85.45066132389618
curr_Factors:  [8.54506613e+01 4.79114755e-02]
mat_Sqrt:  [[ 1.87040305e+01  0.00000000e+00]
 [-8.75547605e-03  2.00613159e-02]]
grads:  [-2.08583394e-02  2.15056765e+01]
Stock Position:  -0.020858339350986004
Bond Position:  [-11.27108148]


portfolio before change:  [-13.07971895]
curr_Stock_Price:  86.44027186335663
curr_Factors:  [8.64402719e+01 5.34111285e-02]
mat_Sqrt:  [[ 1.99770797e+01  0.00000000e+00]
 [-9.24433911e-03  2.11814419e-02]]
grads:  [ 0.01334771 -1.85830857]
Stock Position:  0.013347707822581505
Bond Position:  [-14.23349844]


portfolio before change:  [-13.07762072]
curr_Stock_Price:  87.13078461335739
curr_Factors:  [8.71307846e+01 5.09214842e-02]
mat_Sqrt:  [[ 1.96617492e+01  0.00000000e+00]
 [-9.02631568e-03  2.06818874e-02]]
grads:  [ 4.13795757e-03 -7.07575432e+00]
Stock Position:  0.004137957570290188
Bond Position:  [-13.43816421]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.08499063]
Stock Price:  86.9739079856009
PL:  [-13.08499063]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.01773563e+00  1.34052893e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.23955634e-01  1.41509335e-01]
 [-1.35861457e-01 -4.52743604e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.18797996e-01 -1.09179175e+00]
 [-1.03073572e+00  2.49692235e-01]
 [-6.74998137e-02 -6.00054213e-03]
 [-3.71453609e-02 -3.43776865e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.1516814]
curr_Stock_Price:  96.59788574125491
curr_Factors:  [9.65978857e+01 3.99746935e-02]
mat_Sqrt:  [[ 1.93134648e+01  0.00000000e+00]
 [-7.99746895e-03  1.83245034e-02]]
grads:  [-0.04966639  7.31549934]
Stock Position:  -0.04966639415915046
Bond Position:  [-15.35401274]


portfolio before change:  [-20.12456767]
curr_Stock_Price:  95.89735859477746
curr_Factors:  [9.58973586e+01 4.04052620e-02]
mat_Sqrt:  [[ 1.92763858e+01  0.00000000e+00]
 [-8.04042407e-03  1.84229260e-02]]
grads:  [ 0.00487434 -2.56620544]
Stock Position:  0.004874340667737492
Bond Position:  [-20.59200407]


portfolio before change:  [-20.12533574]
curr_Stock_Price:  97.85259995383844
curr_Factors:  [9.7852600e+01 3.8236817e-02]
mat_Sqrt:  [[ 1.91343289e+01  0.00000000e+00]
 [-7.82169465e-03  1.79217539e-02]]
grads:  [0.01493208 7.89595348]
Stock Position:  0.014932082106095491
Bond Position:  [-21.58647879]


portfolio before change:  [-20.13159123]
curr_Stock_Price:  98.15667297425348
curr_Factors:  [9.81566730e+01 3.80458005e-02]
mat_Sqrt:  [[ 1.91457857e+01  0.00000000e+00]
 [-7.80213309e-03  1.78769327e-02]]
grads:  [-1.74166248e-02 -2.53255752e+01]
Stock Position:  -0.017416624792523632
Bond Position:  [-18.42203329]


portfolio before change:  [-20.11376566]
curr_Stock_Price:  96.6041967728031
curr_Factors:  [9.66041968e+01 3.59629795e-02]
mat_Sqrt:  [[ 1.83199307e+01  0.00000000e+00]
 [-7.58556308e-03  1.73807085e-02]]
grads:  [-3.84647742e-03 -4.90169875e+00]
Stock Position:  -0.003846477417055216
Bond Position:  [-19.74217979]


portfolio before change:  [-20.12355333]
curr_Stock_Price:  96.58186972037342
curr_Factors:  [9.65818697e+01 3.54477534e-02]
mat_Sqrt:  [[ 1.81840228e+01  0.00000000e+00]
 [-7.53102951e-03  1.72557564e-02]]
grads:  [-3.17305965e-03 -6.32711616e+01]
Stock Position:  -0.003173059649296825
Bond Position:  [-19.8170933]


portfolio before change:  [-20.13650508]
curr_Stock_Price:  97.54016230524121
curr_Factors:  [9.75401623e+01 3.75905142e-02]
mat_Sqrt:  [[ 1.89113533e+01  0.00000000e+00]
 [-7.75530933e-03  1.77696460e-02]]
grads:  [-0.04874115 14.05161561]
Stock Position:  -0.048741149506206526
Bond Position:  [-15.38228544]


portfolio before change:  [-20.18038192]
curr_Stock_Price:  98.28252847349175
curr_Factors:  [9.82825285e+01 3.91684671e-02]
mat_Sqrt:  [[ 1.94511198e+01  0.00000000e+00]
 [-7.91641000e-03  1.81387740e-02]]
grads:  [-0.00360487 -0.33081299]
Stock Position:  -0.003604865206721366
Bond Position:  [-19.82608666]


portfolio before change:  [-20.18671668]
curr_Stock_Price:  97.28921274877008
curr_Factors:  [9.72892127e+01 4.12097265e-02]
mat_Sqrt:  [[ 1.97498843e+01  0.00000000e+00]
 [-8.12007157e-03  1.86054213e-02]]
grads:  [-0.00264047 -1.84772416]
Stock Position:  -0.002640471844192572
Bond Position:  [-19.92982725]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.19258384]
Stock Price:  95.73636912959739
PL:  [-20.19258384]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.73908259e-01  2.89845724e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 5.96515493e-02 -5.52454380e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.73997639e-01 -1.65552227e+00]
 [-8.54650050e-01  3.40632100e-01]
 [ 7.09020285e-02  9.07270097e-02]
 [-3.05199666e-02 -2.05442032e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.77612608]
curr_Stock_Price:  98.16056926186626
curr_Factors:  [9.81605693e+01 4.09179158e-02]
mat_Sqrt:  [[ 1.98560940e+01  0.00000000e+00]
 [-8.09127094e-03  1.85394308e-02]]
grads:  [-0.03260506 15.63401422]
Stock Position:  -0.032605063862755135
Bond Position:  [-6.57559445]


portfolio before change:  [-9.69659924]
curr_Stock_Price:  95.62061247660661
curr_Factors:  [9.56206125e+01 4.17338702e-02]
mat_Sqrt:  [[ 1.95342100e+01  0.00000000e+00]
 [-8.17154773e-03  1.87233680e-02]]
grads:  [ 0.00481001 -2.52502717]
Stock Position:  0.004810006198592174
Bond Position:  [-10.15653498]


portfolio before change:  [-9.71030064]
curr_Stock_Price:  93.82812826029254
curr_Factors:  [9.38281283e+01 4.17047103e-02]
mat_Sqrt:  [[ 1.91613281e+01  0.00000000e+00]
 [-8.16869246e-03  1.87168258e-02]]
grads:  [ 0.02101974 10.41335199]
Stock Position:  0.02101974244395771
Bond Position:  [-11.68254373]


portfolio before change:  [-9.74685032]
curr_Stock_Price:  92.3672663148024
curr_Factors:  [9.23672663e+01 4.23754643e-02]
mat_Sqrt:  [[ 1.90140804e+01  0.00000000e+00]
 [-8.23412065e-03  1.88667406e-02]]
grads:  [-9.54341760e-03 -2.92819196e+01]
Stock Position:  -0.009543417599264957
Bond Position:  [-8.86535092]


portfolio before change:  [-9.73301808]
curr_Stock_Price:  90.45327496311556
curr_Factors:  [9.04532750e+01 4.18724361e-02]
mat_Sqrt:  [[ 1.85092325e+01  0.00000000e+00]
 [-8.18510218e-03  1.87544252e-02]]
grads:  [-3.80713787e-03 -4.54266107e+00]
Stock Position:  -0.0038071378658847458
Bond Position:  [-9.38864999]


portfolio before change:  [-9.74205461]
curr_Stock_Price:  91.59350989160356
curr_Factors:  [9.15935099e+01 3.70777697e-02]
mat_Sqrt:  [[ 1.76368696e+01  0.00000000e+00]
 [-7.70223549e-03  1.76480386e-02]]
grads:  [-1.40915890e-02 -9.38077207e+01]
Stock Position:  -0.014091588981664077
Bond Position:  [-8.45135652]


portfolio before change:  [-9.74085811]
curr_Stock_Price:  91.20865363622691
curr_Factors:  [9.12086536e+01 3.82622387e-02]
mat_Sqrt:  [[ 1.78410838e+01  0.00000000e+00]
 [-7.82429434e-03  1.79277105e-02]]
grads:  [-0.0395708  19.00031236]
Stock Position:  -0.039570803071575046
Bond Position:  [-6.13165844]


portfolio before change:  [-9.73771749]
curr_Stock_Price:  91.05179006434138
curr_Factors:  [9.10517901e+01 3.95434483e-02]
mat_Sqrt:  [[ 1.81061352e+01  0.00000000e+00]
 [-7.95421381e-03  1.82253934e-02]]
grads:  [0.00610282 4.97805493]
Stock Position:  0.006102823206548988
Bond Position:  [-10.29339047]


portfolio before change:  [-9.725551]
curr_Stock_Price:  93.88891480984744
curr_Factors:  [9.38889148e+01 3.77049528e-02]
mat_Sqrt:  [[ 1.82311272e+01  0.00000000e+00]
 [-7.76710528e-03  1.77966739e-02]]
grads:  [-6.59214426e-03 -1.15438443e+01]
Stock Position:  -0.00659214426436087
Bond Position:  [-9.10662173]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.72889254]
Stock Price:  93.70492130085688
PL:  [-9.72889254]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.75418646e-01 -3.04864947e-01]
 [ 1.72858349e-02  2.30979897e-01]
 [-9.85860368e-02  1.08810065e-02]
 [-1.47067459e-01 -4.43104084e-01]
 [ 1.12092897e-01  4.15121706e-01]
 [ 2.24717112e-01 -6.43919108e-01]
 [-5.23850354e-01  4.25074108e-02]
 [ 7.29848215e-02 -1.05809083e-01]
 [-3.94491280e-02  1.78980633e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.98260691]
curr_Stock_Price:  102.7932046866248
curr_Factors:  [1.02793205e+02 3.81621531e-02]
mat_Sqrt:  [[ 2.00807921e+01  0.00000000e+00]
 [-7.81405433e-03  1.79042477e-02]]
grads:  [ 1.20694778e-02 -1.70275206e+01]
Stock Position:  0.01206947782099657
Bond Position:  [19.74194661]


portfolio before change:  [20.98889213]
curr_Stock_Price:  102.49590756705794
curr_Factors:  [1.02495908e+02 3.89202702e-02]
mat_Sqrt:  [[ 2.02206191e+01  0.00000000e+00]
 [-7.89128839e-03  1.80812132e-02]]
grads:  [5.84026264e-03 1.27745796e+01]
Stock Position:  0.005840262640119224
Bond Position:  [20.39028911]


portfolio before change:  [21.01433228]
curr_Stock_Price:  105.10579929944859
curr_Factors:  [1.05105799e+02 3.41719114e-02]
mat_Sqrt:  [[ 1.94294862e+01  0.00000000e+00]
 [-7.39425847e-03  1.69423746e-02]]
grads:  [-0.00482963  0.64223621]
Stock Position:  -0.004829627273271098
Bond Position:  [21.52195412]


portfolio before change:  [21.03590809]
curr_Stock_Price:  102.86708701535537
curr_Factors:  [1.02867087e+02 3.13855488e-02]
mat_Sqrt:  [[ 1.82238992e+01  0.00000000e+00]
 [-7.08638681e-03  1.62369520e-02]]
grads:  [-1.86817284e-02 -2.72898561e+01]
Stock Position:  -0.01868172842863687
Bond Position:  [22.95764308]


portfolio before change:  [21.02737748]
curr_Stock_Price:  103.93831047352491
curr_Factors:  [1.0393831e+02 3.1476485e-02]
mat_Sqrt:  [[ 1.84403333e+01  0.00000000e+00]
 [-7.09664541e-03  1.62604574e-02]]
grads:  [1.59035554e-02 2.55295221e+01]
Stock Position:  0.015903555415195714
Bond Position:  [19.3743888]


portfolio before change:  [21.04538612]
curr_Stock_Price:  104.46140266769655
curr_Factors:  [1.04461403e+02 2.89709109e-02]
mat_Sqrt:  [[ 1.77802117e+01  0.00000000e+00]
 [-6.80833735e-03  1.55998606e-02]]
grads:  [-3.16712915e-03 -4.12772346e+01]
Stock Position:  -0.0031671291515660478
Bond Position:  [21.37622888]


portfolio before change:  [21.05300958]
curr_Stock_Price:  105.42989189981478
curr_Factors:  [1.05429892e+02 2.86608733e-02]
mat_Sqrt:  [[ 1.78487773e+01  0.00000000e+00]
 [-6.77180901e-03  1.55161637e-02]]
grads:  [-0.02830998  2.73955674]
Stock Position:  -0.0283099839877461
Bond Position:  [24.03772813]


portfolio before change:  [21.08901469]
curr_Stock_Price:  104.58272621896177
curr_Factors:  [1.04582726e+02 3.00505540e-02]
mat_Sqrt:  [[ 1.81295156e+01  0.00000000e+00]
 [-6.93403825e-03  1.58878776e-02]]
grads:  [ 1.47858070e-03 -6.65973678e+00]
Stock Position:  0.001478580702874448
Bond Position:  [20.93438069]


portfolio before change:  [21.10143384]
curr_Stock_Price:  105.90110796082195
curr_Factors:  [1.05901108e+02 3.12527444e-02]
mat_Sqrt:  [[ 1.87216699e+01  0.00000000e+00]
 [-7.07137830e-03  1.62025632e-02]]
grads:  [2.06522304e-03 1.10464394e+01]
Stock Position:  0.0020652230399400636
Bond Position:  [20.88272443]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.11062101]
Stock Price:  105.29255636515437
PL:  [15.81806465]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.78060706e-01  2.89616254e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.92364325e-02  6.25080580e-03]
 [-1.51184475e-01 -4.34745230e-01]
 [ 1.29282433e-01  4.95319569e-01]
 [ 3.35730114e-01 -6.23594909e-01]
 [-8.21605982e-01  1.56707506e-01]
 [-2.19702558e-02  2.42140456e-02]
 [-2.70381165e-02  4.11236683e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.89599132]
curr_Stock_Price:  98.1425161142983
curr_Factors:  [9.81425161e+01 3.99900739e-02]
mat_Sqrt:  [[ 1.96260677e+01  0.00000000e+00]
 [-7.99900733e-03  1.83280283e-02]]
grads:  [-0.03320389 15.80182272]
Stock Position:  -0.0332038909679673
Bond Position:  [-6.63727791]


portfolio before change:  [-9.92610111]
curr_Stock_Price:  98.94935910126442
curr_Factors:  [9.89493591e+01 3.91477796e-02]
mat_Sqrt:  [[ 1.95779201e+01  0.00000000e+00]
 [-7.91431913e-03  1.81339832e-02]]
grads:  [ 0.00479927 -2.60709477]
Stock Position:  0.004799267252360006
Bond Position:  [-10.40098553]


portfolio before change:  [-9.9148577]
curr_Stock_Price:  102.37596702976796
curr_Factors:  [1.02375967e+02 3.34762805e-02]
mat_Sqrt:  [[ 1.87312438e+01  0.00000000e+00]
 [-7.31860976e-03  1.67690416e-02]]
grads:  [-0.00515227  0.37275868]
Stock Position:  -0.005152266361380715
Bond Position:  [-9.38738945]


portfolio before change:  [-9.91914499]
curr_Stock_Price:  102.296860645622
curr_Factors:  [1.02296861e+02 3.34811530e-02]
mat_Sqrt:  [[ 1.87181321e+01  0.00000000e+00]
 [-7.31914235e-03  1.67702619e-02]]
grads:  [-1.82135080e-02 -2.59235802e+01]
Stock Position:  -0.018213507986470954
Bond Position:  [-8.0559603]


portfolio before change:  [-9.96929525]
curr_Stock_Price:  104.8291169632219
curr_Factors:  [1.04829117e+02 3.42994463e-02]
mat_Sqrt:  [[ 1.94144675e+01  0.00000000e+00]
 [-7.40804388e-03  1.69739609e-02]]
grads:  [1.77938239e-02 2.91811423e+01]
Stock Position:  0.017793823921298073
Bond Position:  [-11.83460609]


portfolio before change:  [-10.03505177]
curr_Stock_Price:  101.46627925089575
curr_Factors:  [1.01466279e+02 3.68703009e-02]
mat_Sqrt:  [[ 1.94831905e+01  0.00000000e+00]
 [-7.68065632e-03  1.75985945e-02]]
grads:  [ 3.26286308e-03 -3.54343587e+01]
Stock Position:  0.003262863080786706
Bond Position:  [-10.36612235]


portfolio before change:  [-10.04194132]
curr_Stock_Price:  100.94367305935167
curr_Factors:  [1.00943673e+02 3.60743331e-02]
mat_Sqrt:  [[ 1.91724785e+01  0.00000000e+00]
 [-7.59729774e-03  1.74075960e-02]]
grads:  [-0.03928617  9.00224859]
Stock Position:  -0.03928616843967493
Bond Position:  [-6.07625118]


portfolio before change:  [-10.07344628]
curr_Stock_Price:  101.66825575122522
curr_Factors:  [1.01668256e+02 2.87568022e-02]
mat_Sqrt:  [[ 1.72407307e+01  0.00000000e+00]
 [-6.78313228e-03  1.55421086e-02]]
grads:  [-6.61362914e-04  1.55796400e+00]
Stock Position:  -0.0006613629136269908
Bond Position:  [-10.00620667]


portfolio before change:  [-10.07846649]
curr_Stock_Price:  101.69223126408242
curr_Factors:  [1.01692231e+02 2.81186460e-02]
mat_Sqrt:  [[ 1.70523791e+01  0.00000000e+00]
 [-6.70744613e-03  1.53686898e-02]]
grads:  [-5.33079648e-04  2.67580834e+00]
Stock Position:  -0.0005330796484850683
Bond Position:  [-10.02425643]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.08327495]
Stock Price:  101.30780898870205
PL:  [-11.39108394]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.57619663e-01  2.90745855e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 5.97716118e-02  5.26395898e-02]
 [-1.19571005e-01 -4.99251504e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 3.94098029e-01 -8.61163995e-01]
 [-1.04642639e+00  2.55139486e-01]
 [-5.82323397e-02  4.45753502e-03]
 [-3.76976392e-02 -6.39994535e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.32651962]
curr_Stock_Price:  98.22828540690716
curr_Factors:  [9.82282854e+01 4.31871340e-02]
mat_Sqrt:  [[ 2.04133253e+01  0.00000000e+00]
 [-8.31260576e-03  1.90465725e-02]]
grads:  [-0.03089785 15.26499609]
Stock Position:  -0.03089784541968639
Bond Position:  [-6.29147724]


portfolio before change:  [-9.28232558]
curr_Stock_Price:  96.6961215675086
curr_Factors:  [9.66961216e+01 4.53942307e-02]
mat_Sqrt:  [[ 2.06020001e+01  0.00000000e+00]
 [-8.52236875e-03  1.95271999e-02]]
grads:  [ 0.00456071 -2.4210851 ]
Stock Position:  0.004560706265367475
Bond Position:  [-9.72332819]


portfolio before change:  [-9.27230958]
curr_Stock_Price:  99.9585274605481
curr_Factors:  [9.99585275e+01 4.04139411e-02]
mat_Sqrt:  [[ 2.00948816e+01  0.00000000e+00]
 [-8.04128756e-03  1.84249045e-02]]
grads:  [0.00411774 2.85698034]
Stock Position:  0.004117735744881188
Bond Position:  [-9.68391239]


portfolio before change:  [-9.29005272]
curr_Stock_Price:  96.82574618985939
curr_Factors:  [9.68257462e+01 4.25863356e-02]
mat_Sqrt:  [[ 1.99814034e+01  0.00000000e+00]
 [-8.25458278e-03  1.89136252e-02]]
grads:  [-1.68888149e-02 -2.63963940e+01]
Stock Position:  -0.016888814936849527
Bond Position:  [-7.65478061]


portfolio before change:  [-9.27947872]
curr_Stock_Price:  95.97297196564342
curr_Factors:  [9.59729720e+01 4.50608533e-02]
mat_Sqrt:  [[ 2.03727028e+01  0.00000000e+00]
 [-8.49101674e-03  1.94553635e-02]]
grads:  [-3.45890285e-03 -4.37899797e+00]
Stock Position:  -0.0034589028522685997
Bond Position:  [-8.94751753]


portfolio before change:  [-9.29281813]
curr_Stock_Price:  98.53578764288355
curr_Factors:  [9.85357876e+01 4.55793506e-02]
mat_Sqrt:  [[ 2.10367216e+01  0.00000000e+00]
 [-8.53972839e-03  1.95669759e-02]]
grads:  [ 8.67780118e-04 -4.40110930e+01]
Stock Position:  0.0008677801178165025
Bond Position:  [-9.37832552]


portfolio before change:  [-9.29865433]
curr_Stock_Price:  97.21532683425883
curr_Factors:  [9.72153268e+01 4.33912833e-02]
mat_Sqrt:  [[ 2.02505111e+01  0.00000000e+00]
 [-8.33222979e-03  1.90915369e-02]]
grads:  [-0.04617535 13.36400983]
Stock Position:  -0.04617534788209388
Bond Position:  [-4.80970279]


portfolio before change:  [-9.32423348]
curr_Stock_Price:  97.71718971962993
curr_Factors:  [9.77171897e+01 4.22538140e-02]
mat_Sqrt:  [[ 2.00864842e+01  0.00000000e+00]
 [-8.22229301e-03  1.88396401e-02]]
grads:  [-0.00280223  0.23660404]
Stock Position:  -0.0028022281815956954
Bond Position:  [-9.05040761]


portfolio before change:  [-9.3265006]
curr_Stock_Price:  96.91097117721522
curr_Factors:  [9.69109712e+01 4.04186642e-02]
mat_Sqrt:  [[ 1.94833631e+01  0.00000000e+00]
 [-8.04175744e-03  1.84259811e-02]]
grads:  [-3.36847855e-03 -3.47332678e+00]
Stock Position:  -0.0033684785482608194
Bond Position:  [-9.00005808]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.33225996]
Stock Price:  97.28449427703195
PL:  [-9.33225996]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.95703230e-01 -2.88050212e-01]
 [-4.22053986e-02  2.31567196e-01]
 [-9.90739489e-02  7.40753542e-03]
 [-1.40065861e-01 -4.53972702e-01]
 [ 7.40226658e-02  2.61281879e-01]
 [ 2.16643215e-01 -6.38410101e-01]
 [-3.10498506e-01 -3.81050287e-02]
 [ 1.17227391e-01 -1.76773688e-01]
 [-5.27692102e-02  3.07136931e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.50670739]
curr_Stock_Price:  103.17336460019804
curr_Factors:  [1.03173365e+02 3.88578793e-02]
mat_Sqrt:  [[ 2.03379484e+01  0.00000000e+00]
 [-7.88496080e-03  1.80667149e-02]]
grads:  [ 1.32750760e-02 -1.59436961e+01]
Stock Position:  0.013275075996386129
Bond Position:  [22.13707313]


portfolio before change:  [23.5370965]
curr_Stock_Price:  104.628558573888
curr_Factors:  [1.04628559e+02 3.69172071e-02]
mat_Sqrt:  [[ 2.01031754e+01  0.00000000e+00]
 [-7.68554041e-03  1.76097853e-02]]
grads:  [2.92783653e-03 1.31499159e+01]
Stock Position:  0.0029278365325465174
Bond Position:  [23.23076119]


portfolio before change:  [23.54411226]
curr_Stock_Price:  103.05656958616682
curr_Factors:  [1.03056570e+02 3.56491808e-02]
mat_Sqrt:  [[ 1.94581013e+01  0.00000000e+00]
 [-7.55239626e-03  1.73047138e-02]]
grads:  [-0.00492551  0.4280646 ]
Stock Position:  -0.004925508095302245
Bond Position:  [24.05171823]


portfolio before change:  [23.55323984]
curr_Stock_Price:  103.64560325174969
curr_Factors:  [1.03645603e+02 3.85048253e-02]
mat_Sqrt:  [[ 2.03380103e+01  0.00000000e+00]
 [-7.84905857e-03  1.79844525e-02]]
grads:  [-1.66287551e-02 -2.52425088e+01]
Stock Position:  -0.016628755080799886
Bond Position:  [25.27673719]


portfolio before change:  [23.59076536]
curr_Stock_Price:  102.14915966403368
curr_Factors:  [1.02149160e+02 3.60687214e-02]
mat_Sqrt:  [[ 1.93999304e+01  0.00000000e+00]
 [-7.59670680e-03  1.74062420e-02]]
grads:  [9.69361347e-03 1.50108151e+01]
Stock Position:  0.009693613472942399
Bond Position:  [22.60057089]


portfolio before change:  [23.62576343]
curr_Stock_Price:  104.593547928891
curr_Factors:  [1.04593548e+02 3.69245586e-02]
mat_Sqrt:  [[ 2.00984493e+01  0.00000000e+00]
 [-7.68630560e-03  1.76115386e-02]]
grads:  [-3.08390933e-03 -3.62495359e+01]
Stock Position:  -0.0030839093294529937
Bond Position:  [23.94832044]


portfolio before change:  [23.62542187]
curr_Stock_Price:  108.58805759718783
curr_Factors:  [1.08588058e+02 3.36559359e-02]
mat_Sqrt:  [[ 1.99210810e+01  0.00000000e+00]
 [-7.33822169e-03  1.68139782e-02]]
grads:  [-0.01642124 -2.26627085]
Stock Position:  -0.016421242610870256
Bond Position:  [25.40857271]


portfolio before change:  [23.68417173]
curr_Stock_Price:  105.78422630882244
curr_Factors:  [1.05784226e+02 3.37617176e-02]
mat_Sqrt:  [[ 1.94371766e+01  0.00000000e+00]
 [-7.34974477e-03  1.68403809e-02]]
grads:  [ 2.06187499e-03 -1.04970125e+01]
Stock Position:  0.0020618749900008578
Bond Position:  [23.46605788]


portfolio before change:  [23.70440144]
curr_Stock_Price:  109.9036551205525
curr_Factors:  [1.09903655e+02 3.11155307e-02]
mat_Sqrt:  [[ 1.93865595e+01  0.00000000e+00]
 [-7.05583795e-03  1.61669557e-02]]
grads:  [4.1924064e-03 1.8997821e+01]
Stock Position:  0.004192406399095227
Bond Position:  [23.24364065]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.72623542]
Stock Price:  112.3388323751445
PL:  [11.38740304]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 1.57884049e-02  8.82956415e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.93741101e-02  5.27067238e-03]
 [-1.48844928e-01 -4.39648098e-01]
 [ 1.13387439e-01  4.21161399e-01]
 [ 1.70359492e-01 -6.57282575e-01]
 [-4.28464576e-01  6.46609501e-03]
 [ 1.04389118e-01 -1.56477299e-01]
 [-3.90358600e-02  1.74779886e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.3150546]
curr_Stock_Price:  101.93960308937908
curr_Factors:  [1.01939603e+02 3.68733804e-02]
mat_Sqrt:  [[ 1.95748938e+01  0.00000000e+00]
 [-7.68097707e-03  1.75993294e-02]]
grads:  [2.77517633e-03 5.01698897e+00]
Stock Position:  0.002775176333198589
Bond Position:  [15.03215423]


portfolio before change:  [15.32137645]
curr_Stock_Price:  101.5086002006505
curr_Factors:  [1.01508600e+02 3.74976653e-02]
mat_Sqrt:  [[ 1.96564440e+01  0.00000000e+00]
 [-7.74572556e-03  1.77476868e-02]]
grads:  [ 0.0047801  -2.66384083]
Stock Position:  0.004780095072699838
Bond Position:  [14.83615569]


portfolio before change:  [15.33017173]
curr_Stock_Price:  101.79632342510287
curr_Factors:  [1.01796323e+02 3.59308586e-02]
mat_Sqrt:  [[ 1.92959378e+01  0.00000000e+00]
 [-7.58217473e-03  1.73729448e-02]]
grads:  [-0.00503079  0.30338394]
Stock Position:  -0.0050307894412580665
Bond Position:  [15.84228759]


portfolio before change:  [15.33396128]
curr_Stock_Price:  102.61797857461046
curr_Factors:  [1.02617979e+02 3.70063698e-02]
mat_Sqrt:  [[ 1.97406613e+01  0.00000000e+00]
 [-7.69481590e-03  1.76310382e-02]]
grads:  [-1.72599632e-02 -2.49360301e+01]
Stock Position:  -0.01725996323711273
Bond Position:  [17.10514381]


portfolio before change:  [15.31851168]
curr_Stock_Price:  104.00872945515715
curr_Factors:  [1.04008729e+02 3.56650593e-02]
mat_Sqrt:  [[ 1.96422514e+01  0.00000000e+00]
 [-7.55407802e-03  1.73085672e-02]]
grads:  [1.51305131e-02 2.43325397e+01]
Stock Position:  0.015130513128793262
Bond Position:  [13.74480623]


portfolio before change:  [15.35025997]
curr_Stock_Price:  105.65270359636821
curr_Factors:  [1.05652704e+02 3.46837614e-02]
mat_Sqrt:  [[ 1.96763124e+01  0.00000000e+00]
 [-7.44943073e-03  1.70687901e-02]]
grads:  [-5.92093372e-03 -3.85078597e+01]
Stock Position:  -0.005920933723940074
Bond Position:  [15.97582263]


portfolio before change:  [15.35127179]
curr_Stock_Price:  106.83124897651028
curr_Factors:  [1.06831249e+02 3.52519673e-02]
mat_Sqrt:  [[ 2.00581089e+01  0.00000000e+00]
 [-7.51020291e-03  1.72080367e-02]]
grads:  [-0.02122047  0.37576018]
Stock Position:  -0.021220472098833508
Bond Position:  [17.61828133]


portfolio before change:  [15.38969922]
curr_Stock_Price:  105.43561158217504
curr_Factors:  [1.05435612e+02 3.52790518e-02]
mat_Sqrt:  [[ 1.98036742e+01  0.00000000e+00]
 [-7.51308744e-03  1.72146459e-02]]
grads:  [ 1.82273375e-03 -9.08977739e+00]
Stock Position:  0.001822733750173458
Bond Position:  [15.19751817]


portfolio before change:  [15.39790439]
curr_Stock_Price:  105.76726421729572
curr_Factors:  [1.05767264e+02 3.49956219e-02]
mat_Sqrt:  [[ 1.97860057e+01  0.00000000e+00]
 [-7.48284673e-03  1.71453558e-02]]
grads:  [1.88235749e-03 1.01940076e+01]
Stock Position:  0.0018823574933860322
Bond Position:  [15.19881259]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.40907394]
Stock Price:  107.66289033999546
PL:  [7.7461836]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 1.63934787e-01 -7.88108017e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.94354635e-02  4.83389395e-03]
 [-1.55747404e-01 -4.25544557e-01]
 [ 3.74101047e-03  4.89640415e-02]
 [ 3.92727804e-01 -8.32919424e-01]
 [-1.02033929e+00  2.83280707e-01]
 [ 2.33638115e-03  7.82099421e-02]
 [-3.73634903e-02 -2.02514305e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.43028452]
curr_Stock_Price:  102.25818217616202
curr_Factors:  [1.02258182e+02 4.12502729e-02]
mat_Sqrt:  [[ 2.07688037e+01  0.00000000e+00]
 [-8.12406528e-03  1.86145720e-02]]
grads:  [ 0.00623719 -4.23382292]
Stock Position:  0.006237188007092899
Bond Position:  [16.79248102]


portfolio before change:  [17.43213009]
curr_Stock_Price:  101.20758518585944
curr_Factors:  [1.01207585e+02 4.19109821e-02]
mat_Sqrt:  [[ 2.07193908e+01  0.00000000e+00]
 [-8.18886875e-03  1.87630554e-02]]
grads:  [ 0.00453487 -2.51968625]
Stock Position:  0.004534866492936134
Bond Position:  [16.97316721]


portfolio before change:  [17.44210751]
curr_Stock_Price:  101.53586605907793
curr_Factors:  [1.01535866e+02 4.01578001e-02]
mat_Sqrt:  [[ 2.03471897e+01  0.00000000e+00]
 [-8.01576448e-03  1.83664237e-02]]
grads:  [-0.00478325  0.2631919 ]
Stock Position:  -0.004783254133484204
Bond Position:  [17.92777936]


portfolio before change:  [17.45046237]
curr_Stock_Price:  101.66365930098016
curr_Factors:  [1.01663659e+02 3.77639103e-02]
mat_Sqrt:  [[ 1.97562365e+01  0.00000000e+00]
 [-7.77317544e-03  1.78105824e-02]]
grads:  [-1.72841763e-02 -2.38927929e+01]
Stock Position:  -0.017284176334516503
Bond Position:  [19.20763499]


portfolio before change:  [17.49885746]
curr_Stock_Price:  99.4194751864311
curr_Factors:  [9.94194752e+01 4.05891159e-02]
mat_Sqrt:  [[ 2.00297838e+01  0.00000000e+00]
 [-8.05869626e-03  1.84647928e-02]]
grads:  [1.25366656e-03 2.65175147e+00]
Stock Position:  0.0012536665569256244
Bond Position:  [17.37421859]


portfolio before change:  [17.506824]
curr_Stock_Price:  98.84297360057815
curr_Factors:  [9.88429736e+01 3.83806015e-02]
mat_Sqrt:  [[ 1.93642950e+01  0.00000000e+00]
 [-7.83638707e-03  1.79554185e-02]]
grads:  [ 1.50854785e-03 -4.63881933e+01]
Stock Position:  0.001508547848050752
Bond Position:  [17.35771465]


portfolio before change:  [17.51000596]
curr_Stock_Price:  95.19770018605249
curr_Factors:  [9.51977002e+01 3.78318994e-02]
mat_Sqrt:  [[ 1.85163563e+01  0.00000000e+00]
 [-7.78016960e-03  1.78266081e-02]]
grads:  [-0.04842775 15.8908922 ]
Stock Position:  -0.04842774910577858
Bond Position:  [22.1202163]


portfolio before change:  [17.60061047]
curr_Stock_Price:  93.55521973294641
curr_Factors:  [9.35552197e+01 4.07412309e-02]
mat_Sqrt:  [[ 1.88836132e+01  0.00000000e+00]
 [-8.07378285e-03  1.84993605e-02]]
grads:  [1.93130403e-03 4.22771057e+00]
Stock Position:  0.0019313040279955846
Bond Position:  [17.41992689]


portfolio before change:  [17.60886314]
curr_Stock_Price:  93.31731432852963
curr_Factors:  [9.33173143e+01 4.18364032e-02]
mat_Sqrt:  [[ 1.90870759e+01  0.00000000e+00]
 [-8.18157963e-03  1.87463540e-02]]
grads:  [-6.58812169e-03 -1.08028636e+01]
Stock Position:  -0.00658812168943405
Bond Position:  [18.22364896]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.61451427]
Stock Price:  93.84295354890344
PL:  [17.61451427]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.95119224e-01  3.10950862e-01]
 [ 6.27796586e-03  2.30748536e-01]
 [-9.92655084e-02  6.04381319e-03]
 [-1.41550470e-01 -4.52746382e-01]
 [ 8.11328035e-02  2.83045147e-01]
 [ 3.97613298e-01 -8.95469139e-01]
 [-7.60194109e-01  1.31802580e-01]
 [-1.28853643e-02  3.28196637e-02]
 [-2.68731578e-02  3.41180735e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.76848492]
curr_Stock_Price:  100.04993867508315
curr_Factors:  [1.00049939e+02 4.11051818e-02]
mat_Sqrt:  [[ 2.02845377e+01  0.00000000e+00]
 [-8.10976516e-03  1.85818063e-02]]
grads:  [-7.85865296e-03  1.67341568e+01]
Stock Position:  -0.007858652959684395
Bond Position:  [3.55474267]


portfolio before change:  [2.74774333]
curr_Stock_Price:  102.91549406427995
curr_Factors:  [1.02915494e+02 3.91185878e-02]
mat_Sqrt:  [[ 2.03550582e+01  0.00000000e+00]
 [-7.91136780e-03  1.81272209e-02]]
grads:  [5.25593601e-03 1.27293939e+01]
Stock Position:  0.005255936009503369
Bond Position:  [2.20682608]


portfolio before change:  [2.74535318]
curr_Stock_Price:  102.25075247221528
curr_Factors:  [1.02250752e+02 3.80762258e-02]
mat_Sqrt:  [[ 1.99523227e+01  0.00000000e+00]
 [-7.80525216e-03  1.78840794e-02]]
grads:  [-0.00484293  0.33794377]
Stock Position:  -0.004842933514967
Bond Position:  [3.24054678]


portfolio before change:  [2.74079365]
curr_Stock_Price:  103.52688172915788
curr_Factors:  [1.03526882e+02 4.03663165e-02]
mat_Sqrt:  [[ 2.07999693e+01  0.00000000e+00]
 [-8.03654816e-03  1.84140451e-02]]
grads:  [-1.63050813e-02 -2.45870138e+01]
Stock Position:  -0.016305081323340635
Bond Position:  [4.42880788]


portfolio before change:  [2.76077048]
curr_Stock_Price:  102.43753578406486
curr_Factors:  [1.02437536e+02 4.16724663e-02]
mat_Sqrt:  [[ 2.09114296e+01  0.00000000e+00]
 [-8.16553403e-03  1.87095889e-02]]
grads:  [9.78717556e-03 1.51283467e+01]
Stock Position:  0.009787175562620893
Bond Position:  [1.75819634]


portfolio before change:  [2.72055441]
curr_Stock_Price:  98.2386342182668
curr_Factors:  [9.82386342e+01 4.48820836e-02]
mat_Sqrt:  [[ 2.08122398e+01  0.00000000e+00]
 [-8.47415682e-03  1.94167325e-02]]
grads:  [ 3.26659961e-04 -4.61184258e+01]
Stock Position:  0.00032665996125700436
Bond Position:  [2.68846378]


portfolio before change:  [2.72308877]
curr_Stock_Price:  101.88091033539644
curr_Factors:  [1.01880910e+02 4.38750404e-02]
mat_Sqrt:  [[ 2.13403522e+01  0.00000000e+00]
 [-8.37854789e-03  1.91976650e-02]]
grads:  [-0.03292686  6.86555269]
Stock Position:  -0.03292685810385406
Bond Position:  [6.07770705]


portfolio before change:  [2.72017678]
curr_Stock_Price:  102.06166246014739
curr_Factors:  [1.02061662e+02 4.78163078e-02]
mat_Sqrt:  [[ 2.23177628e+01  0.00000000e+00]
 [-8.74677612e-03  2.00413818e-02]]
grads:  [6.44469295e-05 1.63759485e+00]
Stock Position:  6.444692954303456e-05
Bond Position:  [2.71359922]


portfolio before change:  [2.72149665]
curr_Stock_Price:  101.48329227745758
curr_Factors:  [1.01483292e+02 4.33477089e-02]
mat_Sqrt:  [[ 2.11289357e+01  0.00000000e+00]
 [-8.32804504e-03  1.90819484e-02]]
grads:  [-5.67127938e-04  1.78797641e+00]
Stock Position:  -0.0005671279376276419
Bond Position:  [2.77905066]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.72217791]
Stock Price:  102.73275717620348
PL:  [-0.01057926]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.17604036e-01  2.78367070e-01]
 [-3.98855344e-02  2.31156060e-01]
 [-9.84577439e-02  1.17943301e-02]
 [-1.33758743e-01 -4.59518530e-01]
 [ 8.97766070e-02  3.11004940e-01]
 [ 3.46957384e-01 -6.58911337e-01]
 [-8.47230961e-01  1.69256764e-01]
 [-2.58748530e-02  2.16228543e-02]
 [-3.79665409e-02 -8.68242992e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.44656598]
curr_Stock_Price:  99.41510127403971
curr_Factors:  [9.94151013e+01 3.74796954e-02]
mat_Sqrt:  [[ 1.92464389e+01  0.00000000e+00]
 [-7.74386935e-03  1.77434337e-02]]
grads:  [-1.53854273e-02  1.56884555e+01]
Stock Position:  -0.015385427304662547
Bond Position:  [0.08297784]


portfolio before change:  [-1.52589695]
curr_Stock_Price:  104.57403993463988
curr_Factors:  [1.04574040e+02 3.79491234e-02]
mat_Sqrt:  [[ 2.03715822e+01  0.00000000e+00]
 [-7.79221390e-03  1.78542050e-02]]
grads:  [2.99433008e-03 1.29468694e+01]
Stock Position:  0.002994330078613366
Bond Position:  [-1.83902615]


portfolio before change:  [-1.52361556]
curr_Stock_Price:  105.64310729963384
curr_Factors:  [1.05643107e+02 3.60013775e-02]
mat_Sqrt:  [[ 2.00447538e+01  0.00000000e+00]
 [-7.58961159e-03  1.73899848e-02]]
grads:  [-0.0046551   0.67822544]
Stock Position:  -0.004655097152351878
Bond Position:  [-1.03183663]


portfolio before change:  [-1.51718403]
curr_Stock_Price:  104.15064232651474
curr_Factors:  [1.04150642e+02 3.77982810e-02]
mat_Sqrt:  [[ 2.02487388e+01  0.00000000e+00]
 [-7.77671201e-03  1.78186857e-02]]
grads:  [-1.65101182e-02 -2.57885759e+01]
Stock Position:  -0.016510118210662297
Bond Position:  [0.20235538]


portfolio before change:  [-1.49466498]
curr_Stock_Price:  102.79281755593857
curr_Factors:  [1.02792818e+02 4.09303207e-02]
mat_Sqrt:  [[ 2.07962651e+01  0.00000000e+00]
 [-8.09249733e-03  1.85422408e-02]]
grads:  [1.08437881e-02 1.67727808e+01]
Stock Position:  0.010843788072262175
Bond Position:  [-2.60932851]


portfolio before change:  [-1.51657986]
curr_Stock_Price:  100.89220071636827
curr_Factors:  [1.00892201e+02 4.52012694e-02]
mat_Sqrt:  [[ 2.14502773e+01  0.00000000e+00]
 [-8.50423606e-03  1.94856527e-02]]
grads:  [ 2.76849103e-03 -3.38152047e+01]
Stock Position:  0.0027684910297218514
Bond Position:  [-1.79589901]


portfolio before change:  [-1.51844107]
curr_Stock_Price:  100.54434642575
curr_Factors:  [1.00544346e+02 4.57593616e-02]
mat_Sqrt:  [[ 2.15078814e+01  0.00000000e+00]
 [-8.55657517e-03  1.96055767e-02]]
grads:  [-0.03595711  8.63309283]
Stock Position:  -0.03595710974055127
Bond Position:  [2.09684303]


portfolio before change:  [-1.5502422]
curr_Stock_Price:  101.45792981486066
curr_Factors:  [1.01457930e+02 4.62410997e-02]
mat_Sqrt:  [[ 2.18172533e+01  0.00000000e+00]
 [-8.60149751e-03  1.97085067e-02]]
grads:  [-7.53434245e-04  1.09713306e+00]
Stock Position:  -0.0007534342450797181
Bond Position:  [-1.47380032]


portfolio before change:  [-1.54732499]
curr_Stock_Price:  96.60774316793253
curr_Factors:  [9.66077432e+01 4.80223659e-02]
mat_Sqrt:  [[ 2.11706266e+01  0.00000000e+00]
 [-8.76560240e-03  2.00845183e-02]]
grads:  [-3.58325585e-03 -4.32294657e+00]
Stock Position:  -0.0035832558483416327
Bond Position:  [-1.20115473]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.54437677]
Stock Price:  95.61731873119221
PL:  [-1.54437677]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.13748121e+00 -3.79666399e-02]
 [ 1.14645942e-01 -4.12933056e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 2.46694934e-01 -5.58104722e-01]
 [-3.27131214e-02 -7.02991118e-02]
 [ 5.26413697e-01 -2.19094953e+00]
 [-6.85793892e-01  3.95843829e-01]
 [ 2.34372137e-01 -1.35901301e-02]
 [ 1.17579462e-01 -1.53629696e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-28.0100238]
curr_Stock_Price:  95.41432478757265
curr_Factors:  [9.54143248e+01 4.06019936e-02]
mat_Sqrt:  [[ 1.92259257e+01  0.00000000e+00]
 [-8.05997455e-03  1.84677217e-02]]
grads:  [-0.06002578 -2.05583777]
Stock Position:  -0.060025781037948193
Bond Position:  [-22.28270443]


portfolio before change:  [-27.89031704]
curr_Stock_Price:  93.23441324523196
curr_Factors:  [9.32344132e+01 4.14183511e-02]
mat_Sqrt:  [[ 1.89746007e+01  0.00000000e+00]
 [-8.14059959e-03  1.86524569e-02]]
grads:  [ 0.00509228 -2.21382662]
Stock Position:  0.005092284570553328
Bond Position:  [-28.36509321]


portfolio before change:  [-27.91685236]
curr_Stock_Price:  90.80932875517847
curr_Factors:  [9.08093288e+01 4.19437182e-02]
mat_Sqrt:  [[ 1.85979009e+01  0.00000000e+00]
 [-8.19206623e-03  1.87703818e-02]]
grads:  [ 0.02165654 10.3836404 ]
Stock Position:  0.02165653983923001
Bond Position:  [-29.8834682]


portfolio before change:  [-27.97482649]
curr_Stock_Price:  88.8224618004111
curr_Factors:  [8.88224618e+01 4.26298642e-02]
mat_Sqrt:  [[ 1.83391744e+01  0.00000000e+00]
 [-8.25880032e-03  1.89232888e-02]]
grads:  [ 1.70022033e-04 -2.94930087e+01]
Stock Position:  0.00017002203332170272
Bond Position:  [-27.98992827]


portfolio before change:  [-27.98896251]
curr_Stock_Price:  88.01341711809914
curr_Factors:  [8.80134171e+01 4.02623948e-02]
mat_Sqrt:  [[ 1.76603247e+01  0.00000000e+00]
 [-8.02619659e-03  1.83903267e-02]]
grads:  [-3.58963780e-03 -3.82261354e+00]
Stock Position:  -0.003589637799712022
Bond Position:  [-27.67302622]


portfolio before change:  [-27.99864455]
curr_Stock_Price:  86.85510166853216
curr_Factors:  [8.68551017e+01 3.86880232e-02]
mat_Sqrt:  [[ 1.70837656e+01  0.00000000e+00]
 [-7.86770851e-03  1.80271849e-02]]
grads:  [-2.51580994e-02 -1.21535866e+02]
Stock Position:  -0.025158099388858327
Bond Position:  [-25.81353527]


portfolio before change:  [-28.03304466]
curr_Stock_Price:  87.70930427359512
curr_Factors:  [8.77093043e+01 4.14980767e-02]
mat_Sqrt:  [[ 1.78673297e+01  0.00000000e+00]
 [-8.14843070e-03  1.86704002e-02]]
grads:  [-0.02871349 21.20167884]
Stock Position:  -0.0287134949963951
Bond Position:  [-25.51460399]


portfolio before change:  [-28.03920314]
curr_Stock_Price:  87.47937713826569
curr_Factors:  [8.74793771e+01 4.14129472e-02]
mat_Sqrt:  [[ 1.78022031e+01  0.00000000e+00]
 [-8.14006852e-03  1.86512401e-02]]
grads:  [ 0.01283217 -0.72864486]
Stock Position:  0.012832171203610085
Bond Position:  [-29.16175348]


portfolio before change:  [-28.04861554]
curr_Stock_Price:  87.8824361637361
curr_Factors:  [8.78824362e+01 4.00227755e-02]
mat_Sqrt:  [[ 1.75814904e+01  0.00000000e+00]
 [-8.00227723e-03  1.83355206e-02]]
grads:  [ 2.87404335e-03 -8.37880197e+00]
Stock Position:  0.0028740433509796474
Bond Position:  [-28.30119347]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-28.06073555]
Stock Price:  88.59019379390719
PL:  [-28.06073555]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.28282932e-01  3.42802720e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.93351286e-02  5.54818359e-03]
 [-1.58046821e-01 -4.14096816e-01]
 [-1.25435608e-02 -7.99861168e-04]
 [ 3.98504254e-01 -8.88803202e-01]
 [-9.50461230e-01  2.19999241e-01]
 [-7.19598575e-02 -8.96034215e-03]
 [-2.66553596e-02  1.87818973e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.45053485]
curr_Stock_Price:  100.60449971491958
curr_Factors:  [1.00604500e+02 4.18562398e-02]
mat_Sqrt:  [[ 2.05824709e+01  0.00000000e+00]
 [-8.18351903e-03  1.87507977e-02]]
grads:  [-3.8222602e-03  1.8282034e+01]
Stock Position:  -0.003822260201426667
Bond Position:  [6.83507143]


portfolio before change:  [6.45067709]
curr_Stock_Price:  101.46162337765358
curr_Factors:  [1.01461623e+02 3.97303018e-02]
mat_Sqrt:  [[ 2.02237989e+01  0.00000000e+00]
 [-7.97298457e-03  1.82684027e-02]]
grads:  [ 0.004646   -2.58791169]
Stock Position:  0.004645995112451311
Bond Position:  [5.97928689]


portfolio before change:  [6.45597617]
curr_Stock_Price:  101.95854301392576
curr_Factors:  [1.01958543e+02 3.80026262e-02]
mat_Sqrt:  [[ 1.98760658e+01  0.00000000e+00]
 [-7.79770492e-03  1.78667865e-02]]
grads:  [-0.0048759   0.31053058]
Stock Position:  -0.0048758996730369495
Bond Position:  [6.9531158]


portfolio before change:  [6.47049174]
curr_Stock_Price:  99.69472666649817
curr_Factors:  [9.96947267e+01 3.76881291e-02]
mat_Sqrt:  [[ 1.93541667e+01  0.00000000e+00]
 [-7.76537227e-03  1.77927031e-02]]
grads:  [-1.75039047e-02 -2.32734067e+01]
Stock Position:  -0.017503904684194705
Bond Position:  [8.21553873]


portfolio before change:  [6.48918823]
curr_Stock_Price:  98.86132981551644
curr_Factors:  [9.88613298e+01 3.83836683e-02]
mat_Sqrt:  [[ 1.93686650e+01  0.00000000e+00]
 [-7.83670016e-03  1.79561358e-02]]
grads:  [-0.00066564 -0.04454528]
Stock Position:  -0.000665644684472417
Bond Position:  [6.55499475]


portfolio before change:  [6.49279962]
curr_Stock_Price:  98.36095627677618
curr_Factors:  [9.83609563e+01 3.69897068e-02]
mat_Sqrt:  [[ 1.89174758e+01  0.00000000e+00]
 [-7.69308332e-03  1.76270683e-02]]
grads:  [ 5.60261563e-04 -5.04226333e+01]
Stock Position:  0.0005602615630636727
Bond Position:  [6.43769176]


portfolio before change:  [6.49642022]
curr_Stock_Price:  99.0766038294163
curr_Factors:  [9.90766038e+01 3.74211659e-02]
mat_Sqrt:  [[ 1.91659243e+01  0.00000000e+00]
 [-7.73782046e-03  1.77295740e-02]]
grads:  [-0.0445815  12.40860279]
Stock Position:  -0.04458150188360421
Bond Position:  [10.91340402]


portfolio before change:  [6.50115041]
curr_Stock_Price:  99.09293073506794
curr_Factors:  [9.90929307e+01 3.90709260e-02]
mat_Sqrt:  [[ 1.95870723e+01  0.00000000e+00]
 [-7.90654676e-03  1.81161745e-02]]
grads:  [-0.0038735  -0.49460454]
Stock Position:  -0.003873497297755323
Bond Position:  [6.88498661]


portfolio before change:  [6.49704485]
curr_Stock_Price:  101.04179446437817
curr_Factors:  [1.01041794e+02 3.77605492e-02]
mat_Sqrt:  [[ 1.96345161e+01  0.00000000e+00]
 [-7.77282952e-03  1.78097898e-02]]
grads:  [-9.40092820e-04  1.05458276e+00]
Stock Position:  -0.0009400928201314984
Bond Position:  [6.59203351]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.49831815]
Stock Price:  103.1942815245433
PL:  [3.30403663]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.96413171e-01  2.84080576e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.37995560e-01 -4.45147765e-01]
 [ 9.19942920e-02  3.21351561e-01]
 [ 2.93013983e-01 -6.05217717e-01]
 [-4.71682724e-01  2.27944309e-02]
 [ 5.83577063e-02 -8.17507064e-02]
 [-4.28676062e-02  2.11275491e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.21061642]
curr_Stock_Price:  99.14941404417011
curr_Factors:  [9.91494140e+01 3.86527313e-02]
mat_Sqrt:  [[ 1.94930702e+01  0.00000000e+00]
 [-7.86411916e-03  1.80189607e-02]]
grads:  [-0.01910578 15.76564714]
Stock Position:  -0.01910577657029505
Bond Position:  [-1.31628987]


portfolio before change:  [-3.16939451]
curr_Stock_Price:  96.95739533254321
curr_Factors:  [9.69573953e+01 4.18440893e-02]
mat_Sqrt:  [[ 1.98334379e+01  0.00000000e+00]
 [-8.18233114e-03  1.87480759e-02]]
grads:  [ 0.00473744 -2.52169946]
Stock Position:  0.0047374374350847084
Bond Position:  [-3.6287241]


portfolio before change:  [-3.17755249]
curr_Stock_Price:  95.61845133634195
curr_Factors:  [9.56184513e+01 4.17629472e-02]
mat_Sqrt:  [[ 1.95405721e+01  0.00000000e+00]
 [-8.17439390e-03  1.87298894e-02]]
grads:  [ 0.02061179 10.40608893]
Stock Position:  0.020611790631011692
Bond Position:  [-5.14841999]


portfolio before change:  [-3.12352047]
curr_Stock_Price:  98.36478577264546
curr_Factors:  [9.83647858e+01 4.32898479e-02]
mat_Sqrt:  [[ 2.04659864e+01  0.00000000e+00]
 [-8.32248500e-03  1.90692087e-02]]
grads:  [-1.62354243e-02 -2.33437984e+01]
Stock Position:  -0.016235424292657813
Bond Position:  [-1.52652644]


portfolio before change:  [-3.19801905]
curr_Stock_Price:  102.90640551435554
curr_Factors:  [1.02906406e+02 3.96978315e-02]
mat_Sqrt:  [[ 2.05033961e+01  0.00000000e+00]
 [-7.96972587e-03  1.82609360e-02]]
grads:  [1.13270802e-02 1.75977595e+01]
Stock Position:  0.011327080191214178
Bond Position:  [-4.36364816]


portfolio before change:  [-3.2031797]
curr_Stock_Price:  102.64347084568246
curr_Factors:  [1.02643471e+02 4.25269092e-02]
mat_Sqrt:  [[ 2.11671915e+01  0.00000000e+00]
 [-8.24882141e-03  1.89004243e-02]]
grads:  [ 1.36415437e-03 -3.20213826e+01]
Stock Position:  0.0013641543749421026
Bond Position:  [-3.34320124]


portfolio before change:  [-3.20002889]
curr_Stock_Price:  106.17886759361117
curr_Factors:  [1.06178868e+02 3.94355693e-02]
mat_Sqrt:  [[ 2.10854147e+01  0.00000000e+00]
 [-7.94335640e-03  1.82005160e-02]]
grads:  [-0.02189828  1.25240575]
Stock Position:  -0.021898284920479228
Bond Position:  [-0.8748938]


portfolio before change:  [-3.15656471]
curr_Stock_Price:  104.17406518983195
curr_Factors:  [1.04174065e+02 3.89940685e-02]
mat_Sqrt:  [[ 2.05711650e+01  0.00000000e+00]
 [-7.89876633e-03  1.80983473e-02]]
grads:  [ 1.10245448e-03 -4.51702606e+00]
Stock Position:  0.0011024544777010344
Bond Position:  [-3.27141188]


portfolio before change:  [-3.15519261]
curr_Stock_Price:  106.90271678237431
curr_Factors:  [1.06902717e+02 4.11275843e-02]
mat_Sqrt:  [[ 2.16798036e+01  0.00000000e+00]
 [-8.11197478e-03  1.85868692e-02]]
grads:  [2.27587752e-03 1.13669219e+01]
Stock Position:  0.002275877517182633
Bond Position:  [-3.3984901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.14885975]
Stock Price:  110.43214175168853
PL:  [-13.5810015]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-8.30057292e-01  2.86742848e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-9.44584419e-02 -5.46339875e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.03400229e-01 -9.58839619e-01]
 [-7.31456705e-01  1.20945144e-01]
 [-6.00665870e-02 -1.06766139e-03]
 [-3.06965390e-02  1.15265645e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.21002449]
curr_Stock_Price:  97.94460690200005
curr_Factors:  [9.79446069e+01 4.08158848e-02]
mat_Sqrt:  [[ 1.97876917e+01  0.00000000e+00]
 [-8.08117663e-03  1.85163018e-02]]
grads:  [-0.03562378 15.48596749]
Stock Position:  -0.03562378390831392
Bond Position:  [-7.72086697]


portfolio before change:  [-11.26722024]
curr_Stock_Price:  99.44176273613951
curr_Factors:  [9.94417627e+01 4.09684271e-02]
mat_Sqrt:  [[ 2.01276680e+01  0.00000000e+00]
 [-8.09626355e-03  1.85508703e-02]]
grads:  [ 0.00466818 -2.54850647]
Stock Position:  0.00466818466826237
Bond Position:  [-11.73143275]


portfolio before change:  [-11.28741752]
curr_Stock_Price:  96.37202646943514
curr_Factors:  [9.63720265e+01 4.20648541e-02]
mat_Sqrt:  [[ 1.97656311e+01  0.00000000e+00]
 [-8.20388729e-03  1.87974672e-02]]
grads:  [ 0.0203771  10.36867852]
Stock Position:  0.020377096998608242
Bond Position:  [-13.25119965]


portfolio before change:  [-11.31546883]
curr_Stock_Price:  95.3206475119958
curr_Factors:  [9.53206475e+01 4.71246850e-02]
mat_Sqrt:  [[ 2.06924166e+01  0.00000000e+00]
 [-8.68328832e-03  1.98959130e-02]]
grads:  [-1.60880538e-02 -2.74599047e+01]
Stock Position:  -0.01608805378411004
Bond Position:  [-9.78194512]


portfolio before change:  [-11.34281181]
curr_Stock_Price:  96.71614152219253
curr_Factors:  [9.67161415e+01 4.72382251e-02]
mat_Sqrt:  [[ 2.10206310e+01  0.00000000e+00]
 [-8.69374259e-03  1.99198667e-02]]
grads:  [-3.35228756e-03 -4.27688589e+00]
Stock Position:  -0.0033522875623816016
Bond Position:  [-11.01859149]


portfolio before change:  [-11.35148898]
curr_Stock_Price:  97.66072013083401
curr_Factors:  [9.76607201e+01 4.71982922e-02]
mat_Sqrt:  [[ 2.12169555e+01  0.00000000e+00]
 [-8.69006718e-03  1.99114453e-02]]
grads:  [-7.10360560e-04 -4.81551994e+01]
Stock Position:  -0.0007103605598380336
Bond Position:  [-11.28211465]


portfolio before change:  [-11.36043666]
curr_Stock_Price:  102.31358951672291
curr_Factors:  [1.02313590e+02 4.15511958e-02]
mat_Sqrt:  [[ 2.08557151e+01  0.00000000e+00]
 [-8.15364417e-03  1.86823458e-02]]
grads:  [-0.03254129  6.4737665 ]
Stock Position:  -0.03254129211164075
Bond Position:  [-8.03102026]


portfolio before change:  [-11.28117849]
curr_Stock_Price:  99.75454284337944
curr_Factors:  [9.97545428e+01 4.11653359e-02]
mat_Sqrt:  [[ 2.02394411e+01  0.00000000e+00]
 [-8.11569698e-03  1.85953979e-02]]
grads:  [-0.00299082 -0.05741536]
Stock Position:  -0.0029908213605674425
Bond Position:  [-10.98283047]


portfolio before change:  [-11.28719964]
curr_Stock_Price:  99.93120436425677
curr_Factors:  [9.99312044e+01 4.28410439e-02]
mat_Sqrt:  [[ 2.06838388e+01  0.00000000e+00]
 [-8.27923126e-03  1.89701020e-02]]
grads:  [-0.00124087  0.60761743]
Stock Position:  -0.0012408689752425317
Bond Position:  [-11.16319811]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.29107247]
Stock Price:  98.5530056157869
PL:  [-11.29107247]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.09058032e-01  2.93429441e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.71359380e-02  5.81182783e-02]
 [-1.35310502e-01 -4.55256760e-01]
 [ 7.08206006e-02  2.51444154e-01]
 [ 3.88900873e-01 -7.90848504e-01]
 [-1.02944296e+00  2.79942843e-01]
 [-1.79929539e-02  4.29607962e-02]
 [-3.03538408e-02 -1.69543556e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.16714547]
curr_Stock_Price:  98.40290110800109
curr_Factors:  [9.84029011e+01 3.78983412e-02]
mat_Sqrt:  [[ 1.91565811e+01  0.00000000e+00]
 [-7.78699852e-03  1.78422551e-02]]
grads:  [-0.03032874 16.44575979]
Stock Position:  -0.03032873771206615
Bond Position:  [-5.18270969]


portfolio before change:  [-8.24292327]
curr_Stock_Price:  100.81598508975266
curr_Factors:  [1.00815985e+02 3.57939636e-02]
mat_Sqrt:  [[ 1.90736713e+01  0.00000000e+00]
 [-7.56771707e-03  1.73398182e-02]]
grads:  [ 0.00492615 -2.72649992]
Stock Position:  0.004926145029228312
Bond Position:  [-8.73955743]


portfolio before change:  [-8.25332733]
curr_Stock_Price:  99.59125544535324
curr_Factors:  [9.95912554e+01 3.53564581e-02]
mat_Sqrt:  [[ 1.87264555e+01  0.00000000e+00]
 [-7.52132521e-03  1.72335211e-02]]
grads:  [0.00547358 3.37239721]
Stock Position:  0.005473584367111956
Bond Position:  [-8.79844847]


portfolio before change:  [-8.26594192]
curr_Stock_Price:  98.09054500738566
curr_Factors:  [9.80905450e+01 3.45471313e-02]
mat_Sqrt:  [[ 1.82319509e+01  0.00000000e+00]
 [-7.43474344e-03  1.70351373e-02]]
grads:  [-1.83195338e-02 -2.67245724e+01]
Stock Position:  -0.01831953383602888
Bond Position:  [-6.46896886]


portfolio before change:  [-8.34117365]
curr_Stock_Price:  102.02058116528228
curr_Factors:  [1.02020581e+02 3.54076077e-02]
mat_Sqrt:  [[ 1.91971203e+01  0.00000000e+00]
 [-7.52676374e-03  1.72459823e-02]]
grads:  [9.40556832e-03 1.45798685e+01]
Stock Position:  0.00940556832459272
Bond Position:  [-9.30073519]


portfolio before change:  [-8.37194545]
curr_Stock_Price:  99.24347413972178
curr_Factors:  [9.92434741e+01 3.54294539e-02]
mat_Sqrt:  [[ 1.86803147e+01  0.00000000e+00]
 [-7.52908536e-03  1.72513018e-02]]
grads:  [ 2.34183897e-03 -4.58428305e+01]
Stock Position:  0.0023418389736859745
Bond Position:  [-8.60435768]


portfolio before change:  [-8.38513015]
curr_Stock_Price:  95.45096539900523
curr_Factors:  [9.54509654e+01 3.81042397e-02]
mat_Sqrt:  [[ 1.86323218e+01  0.00000000e+00]
 [-7.80812292e-03  1.78906572e-02]]
grads:  [-0.04869312 15.64743212]
Stock Position:  -0.04869312039144171
Bond Position:  [-3.7373248]


portfolio before change:  [-8.35766788]
curr_Stock_Price:  94.84859284467295
curr_Factors:  [9.48485928e+01 3.83693005e-02]
mat_Sqrt:  [[ 1.85790213e+01  0.00000000e+00]
 [-7.83523330e-03  1.79527748e-02]]
grads:  [4.07273735e-05 2.39298920e+00]
Stock Position:  4.072737353918965e-05
Bond Position:  [-8.36153081]


portfolio before change:  [-8.3618289]
curr_Stock_Price:  95.35886654072284
curr_Factors:  [9.53588665e+01 4.09837186e-02]
mat_Sqrt:  [[ 1.93048646e+01  0.00000000e+00]
 [-8.09777437e-03  1.85543320e-02]]
grads:  [-5.40530674e-03 -9.13768040e+00]
Stock Position:  -0.005405306739576074
Bond Position:  [-7.84638498]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.35778903]
Stock Price:  93.88549047468032
PL:  [-8.35778903]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.96567045e-01  3.43753764e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.90063971e-02  7.88843984e-03]
 [-1.60472918e-01 -4.15988774e-01]
 [ 7.08896330e-02  2.51587914e-01]
 [ 2.38907206e-01 -6.27510481e-01]
 [-4.30105472e-01  7.08526651e-03]
 [ 1.15497175e-01 -1.74116703e-01]
 [-4.83555712e-02  2.64259276e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.367729]
curr_Stock_Price:  101.19447630366255
curr_Factors:  [1.01194476e+02 3.89013172e-02]
mat_Sqrt:  [[ 1.99590084e+01  0.00000000e+00]
 [-7.88936674e-03  1.80768101e-02]]
grads:  [-2.33180935e-03  1.90162845e+01]
Stock Position:  -0.002331809353198351
Bond Position:  [10.60369522]


portfolio before change:  [10.37219621]
curr_Stock_Price:  101.55298060217059
curr_Factors:  [1.01552981e+02 3.87880015e-02]
mat_Sqrt:  [[ 2.00005241e+01  0.00000000e+00]
 [-7.87786789e-03  1.80504630e-02]]
grads:  [ 0.00469786 -2.61915791]
Stock Position:  0.004697860439259776
Bond Position:  [9.89511448]


portfolio before change:  [10.38552513]
curr_Stock_Price:  103.33679915646633
curr_Factors:  [1.03336799e+02 4.05274249e-02]
mat_Sqrt:  [[ 2.08031696e+01  0.00000000e+00]
 [-8.05256977e-03  1.84507553e-02]]
grads:  [-0.0045937   0.42754021]
Stock Position:  -0.004593703817734495
Bond Position:  [10.86022378]


portfolio before change:  [10.4016525]
curr_Stock_Price:  101.008417157747
curr_Factors:  [1.01008417e+02 4.13576581e-02]
mat_Sqrt:  [[ 2.05416599e+01  0.00000000e+00]
 [-8.13463293e-03  1.86387856e-02]]
grads:  [-1.66503245e-02 -2.23184484e+01]
Stock Position:  -0.01665032448007224
Bond Position:  [12.08347542]


portfolio before change:  [10.39075656]
curr_Stock_Price:  102.02576627476292
curr_Factors:  [1.02025766e+02 3.88998364e-02]
mat_Sqrt:  [[ 2.01225842e+01  0.00000000e+00]
 [-7.88921657e-03  1.80764661e-02]]
grads:  [8.97954256e-03 1.39179812e+01]
Stock Position:  0.008979542555952428
Bond Position:  [9.47461185]


portfolio before change:  [10.41356244]
curr_Stock_Price:  104.03782802503983
curr_Factors:  [1.04037828e+02 3.97217920e-02]
mat_Sqrt:  [[ 2.07350790e+01  0.00000000e+00]
 [-7.97213066e-03  1.82664461e-02]]
grads:  [-1.68607124e-03 -3.43531784e+01]
Stock Position:  -0.0016860712429136887
Bond Position:  [10.58897763]


portfolio before change:  [10.41420488]
curr_Stock_Price:  106.79771730938712
curr_Factors:  [1.06797717e+02 3.90124420e-02]
mat_Sqrt:  [[ 2.10942233e+01  0.00000000e+00]
 [-7.90062701e-03  1.81026107e-02]]
grads:  [-0.02024313  0.39139474]
Stock Position:  -0.020243134954971938
Bond Position:  [12.57612549]


portfolio before change:  [10.44205028]
curr_Stock_Price:  105.73287406032912
curr_Factors:  [1.05732874e+02 4.05887739e-02]
mat_Sqrt:  [[ 2.13016382e+01  0.00000000e+00]
 [-8.05866231e-03  1.84647150e-02]]
grads:  [ 1.85461867e-03 -9.42969891e+00]
Stock Position:  0.0018546186737429743
Bond Position:  [10.24595612]


portfolio before change:  [10.45241712]
curr_Stock_Price:  108.55964504293188
curr_Factors:  [1.08559645e+02 3.80326883e-02]
mat_Sqrt:  [[ 2.11712708e+01  0.00000000e+00]
 [-7.80078850e-03  1.78738519e-02]]
grads:  [3.16356221e-03 1.47846853e+01]
Stock Position:  0.0031635622121858045
Bond Position:  [10.10898193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.45691743]
Stock Price:  108.38406900635997
PL:  [2.07284843]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.61841904e-01  3.38103980e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 6.41818330e-02  5.62335100e-02]
 [-1.49212361e-01 -4.38744314e-01]
 [ 6.48004224e-02  2.33025401e-01]
 [ 3.44497437e-01 -6.51173345e-01]
 [-9.55886402e-01  2.22643718e-01]
 [-5.72094417e-02  8.28413821e-04]
 [-2.76997164e-02  1.66972623e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.46605118]
curr_Stock_Price:  100.3056125876903
curr_Factors:  [1.00305613e+02 3.84119906e-02]
mat_Sqrt:  [[ 1.96588741e+01  0.00000000e+00]
 [-7.83959087e-03  1.79627593e-02]]
grads:  [-5.81321335e-03  1.88224968e+01]
Stock Position:  -0.005813213350758232
Bond Position:  [5.04914911]


portfolio before change:  [4.46942016]
curr_Stock_Price:  100.16046552769005
curr_Factors:  [1.00160466e+02 3.54286099e-02]
mat_Sqrt:  [[ 1.88526928e+01  0.00000000e+00]
 [-7.52899567e-03  1.72510963e-02]]
grads:  [ 0.00498389 -2.74052223]
Stock Position:  0.004983885965082556
Bond Position:  [3.97023182]


portfolio before change:  [4.47034277]
curr_Stock_Price:  99.94717717411673
curr_Factors:  [9.99471772e+01 3.41174489e-02]
mat_Sqrt:  [[ 1.84611524e+01  0.00000000e+00]
 [-7.38836370e-03  1.69288680e-02]]
grads:  [0.00480599 3.32175253]
Stock Position:  0.00480599189641555
Bond Position:  [3.98999745]


portfolio before change:  [4.48494402]
curr_Stock_Price:  102.57010220064338
curr_Factors:  [1.02570102e+02 3.23250121e-02]
mat_Sqrt:  [[ 1.84412407e+01  0.00000000e+00]
 [-7.19166318e-03  1.64781705e-02]]
grads:  [-1.84746831e-02 -2.66257905e+01]
Stock Position:  -0.018474683116278236
Bond Position:  [6.37989416]


portfolio before change:  [4.50280334]
curr_Stock_Price:  101.77611967677858
curr_Factors:  [1.01776120e+02 3.02414234e-02]
mat_Sqrt:  [[ 1.76989297e+01  0.00000000e+00]
 [-6.95602454e-03  1.59382545e-02]]
grads:  [9.40740758e-03 1.46205095e+01]
Stock Position:  0.009407407583130021
Bond Position:  [3.5453539]


portfolio before change:  [4.49891432]
curr_Stock_Price:  101.1742388226459
curr_Factors:  [1.01174239e+02 3.04914107e-02]
mat_Sqrt:  [[ 1.76668330e+01  0.00000000e+00]
 [-6.98471596e-03  1.60039948e-02]]
grads:  [ 3.41329372e-03 -4.06881753e+01]
Stock Position:  0.0034132937199791
Bond Position:  [4.15357693]


portfolio before change:  [4.49360698]
curr_Stock_Price:  99.01074060223843
curr_Factors:  [9.90107406e+01 3.03334335e-02]
mat_Sqrt:  [[ 1.72442017e+01  0.00000000e+00]
 [-6.96659842e-03  1.59624823e-02]]
grads:  [-0.04979742 13.94793828]
Stock Position:  -0.049797417770330935
Bond Position:  [9.42408619]


portfolio before change:  [4.45204001]
curr_Stock_Price:  99.94010985769961
curr_Factors:  [9.99401099e+01 2.84699788e-02]
mat_Sqrt:  [[ 1.68629439e+01  0.00000000e+00]
 [-6.74921966e-03  1.54644050e-02]]
grads:  [-0.00337117  0.05356907]
Stock Position:  -0.003371172483155935
Bond Position:  [4.78895536]


portfolio before change:  [4.45165882]
curr_Stock_Price:  100.7636401922531
curr_Factors:  [1.00763640e+02 2.60687133e-02]
mat_Sqrt:  [[ 1.62691044e+01  0.00000000e+00]
 [-6.45832341e-03  1.47978779e-02]]
grads:  [-0.00125467  1.12835518]
Stock Position:  -0.0012546747026191316
Bond Position:  [4.57808441]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.45614175]
Stock Price:  99.01552701185749
PL:  [4.45614175]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-8.18733037e-01  2.87368642e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 1.81331477e-01 -5.57113877e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 5.05427324e-01 -1.99051435e+00]
 [-7.88089872e-01  3.62611852e-01]
 [ 6.63246670e-03  8.65554103e-02]
 [-3.23419603e-02 -2.04662565e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.95787832]
curr_Stock_Price:  97.98258314920295
curr_Factors:  [9.79825831e+01 3.83700196e-02]
mat_Sqrt:  [[ 1.91930898e+01  0.00000000e+00]
 [-7.83530671e-03  1.79529431e-02]]
grads:  [-0.03612316 16.00677068]
Stock Position:  -0.03612316135552076
Bond Position:  [-7.41843766]


portfolio before change:  [-10.87251602]
curr_Stock_Price:  95.5167841961358
curr_Factors:  [9.55167842e+01 4.27165028e-02]
mat_Sqrt:  [[ 1.97413813e+01  0.00000000e+00]
 [-8.26718842e-03  1.89425084e-02]]
grads:  [ 0.00475953 -2.49581586]
Stock Position:  0.004759528704897465
Bond Position:  [-11.32713089]


portfolio before change:  [-10.89504031]
curr_Stock_Price:  91.97456174894637
curr_Factors:  [9.19745617e+01 3.83918478e-02]
mat_Sqrt:  [[ 1.80213464e+01  0.00000000e+00]
 [-7.83753510e-03  1.79580489e-02]]
grads:  [ 0.02234939 10.85334468]
Stock Position:  0.022349394576649168
Bond Position:  [-12.95061608]


portfolio before change:  [-10.94477244]
curr_Stock_Price:  90.03915321916344
curr_Factors:  [9.00391532e+01 3.91976628e-02]
mat_Sqrt:  [[ 1.78263114e+01  0.00000000e+00]
 [-7.91935986e-03  1.81455330e-02]]
grads:  [-3.46751222e-03 -3.07025358e+01]
Stock Position:  -0.0034675122150438268
Bond Position:  [-10.63256058]


portfolio before change:  [-10.94845458]
curr_Stock_Price:  89.56749854434001
curr_Factors:  [8.95674985e+01 4.20961586e-02]
mat_Sqrt:  [[ 1.83768758e+01  0.00000000e+00]
 [-8.20693937e-03  1.88044604e-02]]
grads:  [-3.83455821e-03 -4.53057387e+00]
Stock Position:  -0.003834558207512766
Bond Position:  [-10.6050028]


portfolio before change:  [-10.94994463]
curr_Stock_Price:  88.57291725948733
curr_Factors:  [8.85729173e+01 4.50451113e-02]
mat_Sqrt:  [[ 1.87985686e+01  0.00000000e+00]
 [-8.48953345e-03  1.94519648e-02]]
grads:  [-1.93261715e-02 -1.02329732e+02]
Stock Position:  -0.019326171488513417
Bond Position:  [-9.23816924]


portfolio before change:  [-10.97855419]
curr_Stock_Price:  89.81420416966203
curr_Factors:  [8.98142042e+01 4.14911315e-02]
mat_Sqrt:  [[ 1.82945893e+01  0.00000000e+00]
 [-8.14774879e-03  1.86688378e-02]]
grads:  [-0.03442729 19.42337576]
Stock Position:  -0.034427287400779855
Bond Position:  [-7.88649478]


portfolio before change:  [-11.1002985]
curr_Stock_Price:  93.23591060087261
curr_Factors:  [9.32359106e+01 3.82007981e-02]
mat_Sqrt:  [[ 1.82229815e+01  0.00000000e+00]
 [-7.81800978e-03  1.79133108e-02]]
grads:  [2.43694176e-03 4.83190468e+00]
Stock Position:  0.0024369417649270524
Bond Position:  [-11.32750898]


portfolio before change:  [-11.10473376]
curr_Stock_Price:  93.74060300885832
curr_Factors:  [9.37406030e+01 3.42640549e-02]
mat_Sqrt:  [[ 1.73519034e+01  0.00000000e+00]
 [-7.40422095e-03  1.69652015e-02]]
grads:  [-7.01156662e-03 -1.20636684e+01]
Stock Position:  -0.007011566616529148
Bond Position:  [-10.44746528]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.10526858]
Stock Price:  93.07167667935538
PL:  [-11.10526858]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.77182153e-01  2.89664804e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.09795527e-01  6.80373964e-02]
 [-1.36554498e-01 -4.48749966e-01]
 [-2.12784762e-02 -2.77111982e-02]
 [ 4.02789727e-01 -9.55134660e-01]
 [-1.03341298e+00  2.79331619e-01]
 [-3.12806595e-02  3.12271241e-02]
 [-3.64961833e-02 -1.03750907e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.86193947]
curr_Stock_Price:  98.14764473129152
curr_Factors:  [9.81476447e+01 4.07650436e-02]
mat_Sqrt:  [[ 1.98163579e+01  0.00000000e+00]
 [-8.07614201e-03  1.85047660e-02]]
grads:  [-0.03283964 15.65352426]
Stock Position:  -0.03283964041222246
Bond Position:  [-6.63880611]


portfolio before change:  [-9.90890253]
curr_Stock_Price:  99.47661240569431
curr_Factors:  [9.94766124e+01 4.21341508e-02]
mat_Sqrt:  [[ 2.04191712e+01  0.00000000e+00]
 [-8.21064195e-03  1.88129441e-02]]
grads:  [ 0.00460154 -2.51300448]
Stock Position:  0.004601541863778732
Bond Position:  [-10.36664833]


portfolio before change:  [-9.91681163]
curr_Stock_Price:  98.88453300536543
curr_Factors:  [9.88845330e+01 4.38293283e-02]
mat_Sqrt:  [[ 2.07019271e+01  0.00000000e+00]
 [-8.37418206e-03  1.91876616e-02]]
grads:  [0.006738   3.54589308]
Stock Position:  0.006737995008781923
Bond Position:  [-10.58309512]


portfolio before change:  [-9.92632238]
curr_Stock_Price:  98.25854755515392
curr_Factors:  [9.82585476e+01 4.56799900e-02]
mat_Sqrt:  [[ 2.10006792e+01  0.00000000e+00]
 [-8.54915107e-03  1.95885660e-02]]
grads:  [-1.58282995e-02 -2.29087707e+01]
Stock Position:  -0.015828299479231825
Bond Position:  [-8.37105667]


portfolio before change:  [-9.93538592]
curr_Stock_Price:  98.56666379950009
curr_Factors:  [9.85666638e+01 4.65473261e-02]
mat_Sqrt:  [[ 2.12655895e+01  0.00000000e+00]
 [-8.62993174e-03  1.97736577e-02]]
grads:  [-0.00156933 -1.40141994]
Stock Position:  -0.0015693256264499547
Bond Position:  [-9.78070272]


portfolio before change:  [-9.93889127]
curr_Stock_Price:  97.68334093976564
curr_Factors:  [9.76833409e+01 4.84510016e-02]
mat_Sqrt:  [[ 2.15016548e+01  0.00000000e+00]
 [-8.80463528e-03  2.01739538e-02]]
grads:  [-6.54145651e-04 -4.73449413e+01]
Stock Position:  -0.0006541456507784983
Bond Position:  [-9.87499214]


portfolio before change:  [-9.9424034]
curr_Stock_Price:  95.50248930213506
curr_Factors:  [9.55024893e+01 4.58420228e-02]
mat_Sqrt:  [[ 2.04477995e+01  0.00000000e+00]
 [-8.56430012e-03  1.96232768e-02]]
grads:  [-0.04457705 14.23470819]
Stock Position:  -0.04457705400368586
Bond Position:  [-5.68518378]


portfolio before change:  [-9.96533082]
curr_Stock_Price:  95.95303759790362
curr_Factors:  [9.59530376e+01 4.72054051e-02]
mat_Sqrt:  [[ 2.08475293e+01  0.00000000e+00]
 [-8.69072196e-03  1.99129456e-02]]
grads:  [-8.46720249e-04  1.56818206e+00]
Stock Position:  -0.0008467202492708532
Bond Position:  [-9.88408544]


portfolio before change:  [-9.9706147]
curr_Stock_Price:  96.35529968052096
curr_Factors:  [9.63552997e+01 4.66831241e-02]
mat_Sqrt:  [[ 2.08187937e+01  0.00000000e+00]
 [-8.64251112e-03  1.98024807e-02]]
grads:  [-3.92802736e-03 -5.23928838e+00]
Stock Position:  -0.003928027360191155
Bond Position:  [-9.59212845]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.97897114]
Stock Price:  97.261396688388
PL:  [-9.97897114]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.52780701e-01  2.28262713e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 4.63350369e-02  4.88298869e-02]
 [-1.32712699e-01 -4.60184484e-01]
 [ 1.27094142e-02  7.62887558e-02]
 [ 2.47737763e-01 -6.19672881e-01]
 [-2.98333209e-01 -4.27046085e-02]
 [ 2.35958053e-01 -3.64792155e-01]
 [-4.71973731e-02  2.52511832e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.82928804]
curr_Stock_Price:  97.24889020946907
curr_Factors:  [9.72488902e+01 4.18671241e-02]
mat_Sqrt:  [[ 1.98985403e+01  0.00000000e+00]
 [-8.18458298e-03  1.87532355e-02]]
grads:  [-0.04287544 12.17191098]
Stock Position:  -0.04287544077513376
Bond Position:  [-11.65969901]


portfolio before change:  [-15.84295385]
curr_Stock_Price:  97.43161734038041
curr_Factors:  [9.74316173e+01 4.24849137e-02]
mat_Sqrt:  [[ 2.00824772e+01  0.00000000e+00]
 [-8.24474754e-03  1.88910898e-02]]
grads:  [ 0.00467869 -2.50260907]
Stock Position:  0.004678689296605636
Bond Position:  [-16.29880612]


portfolio before change:  [-15.83787821]
curr_Stock_Price:  100.25870947980758
curr_Factors:  [1.00258709e+02 4.33495321e-02]
mat_Sqrt:  [[ 2.08744152e+01  0.00000000e+00]
 [-8.32822018e-03  1.90823497e-02]]
grads:  [0.00324062 2.55890326]
Stock Position:  0.003240624758509976
Bond Position:  [-16.16277907]


portfolio before change:  [-15.85349449]
curr_Stock_Price:  97.93419693369152
curr_Factors:  [9.79341969e+01 4.49387061e-02]
mat_Sqrt:  [[ 2.07608270e+01  0.00000000e+00]
 [-8.47950056e-03  1.94289766e-02]]
grads:  [-1.60664927e-02 -2.36854722e+01]
Stock Position:  -0.016066492670161706
Bond Position:  [-14.28003544]


portfolio before change:  [-15.88946653]
curr_Stock_Price:  99.72862948437214
curr_Factors:  [9.97286295e+01 4.53033762e-02]
mat_Sqrt:  [[ 2.12268297e+01  0.00000000e+00]
 [-8.51383591e-03  1.95076488e-02]]
grads:  [2.16728346e-03 3.91070994e+00]
Stock Position:  0.002167283462030533
Bond Position:  [-16.10560674]


portfolio before change:  [-15.88873646]
curr_Stock_Price:  103.78204124209026
curr_Factors:  [1.03782041e+02 4.41603494e-02]
mat_Sqrt:  [[ 2.18091359e+01  0.00000000e+00]
 [-8.40574560e-03  1.92599827e-02]]
grads:  [-1.04129086e-03 -3.21741140e+01]
Stock Position:  -0.0010412908641912234
Bond Position:  [-15.78066917]


portfolio before change:  [-15.9017848]
curr_Stock_Price:  108.73361657131034
curr_Factors:  [1.08733617e+02 4.81296051e-02]
mat_Sqrt:  [[ 2.38544816e+01  0.00000000e+00]
 [-8.77538421e-03  2.01069312e-02]]
grads:  [-0.01328769 -2.123875  ]
Stock Position:  -0.013287693013315751
Bond Position:  [-14.45696588]


portfolio before change:  [-15.9124322]
curr_Stock_Price:  108.9907803309604
curr_Factors:  [1.08990780e+02 4.62499327e-02]
mat_Sqrt:  [[ 2.34393365e+01  0.00000000e+00]
 [-8.60231901e-03  1.97103890e-02]]
grads:  [ 3.27439747e-03 -1.85076081e+01]
Stock Position:  0.0032743974740552613
Bond Position:  [-16.26931133]


portfolio before change:  [-15.92320527]
curr_Stock_Price:  108.18563139105683
curr_Factors:  [1.08185631e+02 4.81011520e-02]
mat_Sqrt:  [[ 2.37272454e+01  0.00000000e+00]
 [-8.77278993e-03  2.01009870e-02]]
grads:  [2.65550526e-03 1.25621609e+01]
Stock Position:  0.00265550526152309
Bond Position:  [-16.21049278]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.93962052]
Stock Price:  105.05704456560657
PL:  [-20.99666508]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-6.32865411e-01  2.94184883e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 8.93750572e-02  5.88868263e-02]
 [-1.62913027e-01 -4.10845239e-01]
 [ 2.90178565e-02  1.25711419e-01]
 [ 4.03896714e-01 -9.41896733e-01]
 [-1.03924862e+00  2.52584255e-01]
 [-5.80674004e-02  5.27287106e-03]
 [-2.45979204e-02 -1.96950462e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.29184124]
curr_Stock_Price:  98.68534449824831
curr_Factors:  [9.86853445e+01 3.85723662e-02]
mat_Sqrt:  [[ 1.93816525e+01  0.00000000e+00]
 [-7.85593953e-03  1.80002188e-02]]
grads:  [-0.02602836 16.34340598]
Stock Position:  -0.026028358655634517
Bond Position:  [-3.7232237]


portfolio before change:  [-6.32475342]
curr_Stock_Price:  99.87827818946795
curr_Factors:  [9.98782782e+01 3.85127079e-02]
mat_Sqrt:  [[ 1.96007674e+01  0.00000000e+00]
 [-7.84986195e-03  1.79862933e-02]]
grads:  [ 0.00479367 -2.62850228]
Stock Position:  0.00479367308072248
Bond Position:  [-6.80353724]


portfolio before change:  [-6.33132443]
curr_Stock_Price:  99.21732499871484
curr_Factors:  [9.9217325e+01 3.8830486e-02]
mat_Sqrt:  [[ 1.95512229e+01  0.00000000e+00]
 [-7.88218102e-03  1.80603456e-02]]
grads:  [0.00588584 3.26055922]
Stock Position:  0.005885840276988641
Bond Position:  [-6.91530176]


portfolio before change:  [-6.32620879]
curr_Stock_Price:  100.67406828966007
curr_Factors:  [1.00674068e+02 3.67575368e-02]
mat_Sqrt:  [[ 1.93014893e+01  0.00000000e+00]
 [-7.66890207e-03  1.75716621e-02]]
grads:  [-1.77302686e-02 -2.33811256e+01]
Stock Position:  -0.017730268598445346
Bond Position:  [-4.54123052]


portfolio before change:  [-6.32211461]
curr_Stock_Price:  100.31505717285542
curr_Factors:  [1.00315057e+02 3.64367956e-02]
mat_Sqrt:  [[ 1.91485641e+01  0.00000000e+00]
 [-7.63536986e-03  1.74948302e-02]]
grads:  [4.38063228e-03 7.18563246e+00]
Stock Position:  0.004380632277512311
Bond Position:  [-6.76155799]


portfolio before change:  [-6.33607972]
curr_Stock_Price:  97.8990844464381
curr_Factors:  [9.78990844e+01 3.61557100e-02]
mat_Sqrt:  [[ 1.86151730e+01  0.00000000e+00]
 [-7.60586194e-03  1.74272190e-02]]
grads:  [-3.85745661e-04 -5.40474490e+01]
Stock Position:  -0.0003857456614518145
Bond Position:  [-6.29831558]


portfolio before change:  [-6.33902615]
curr_Stock_Price:  97.37147711492756
curr_Factors:  [9.73714771e+01 3.52422133e-02]
mat_Sqrt:  [[ 1.82794593e+01  0.00000000e+00]
 [-7.50916382e-03  1.72056558e-02]]
grads:  [-0.05082272 14.68030385]
Stock Position:  -0.05082271837022777
Bond Position:  [-1.39034299]


portfolio before change:  [-6.35107288]
curr_Stock_Price:  97.59482969301045
curr_Factors:  [9.75948297e+01 3.39086826e-02]
mat_Sqrt:  [[ 1.79714148e+01  0.00000000e+00]
 [-7.36572414e-03  1.68769942e-02]]
grads:  [-0.00310305  0.31242951]
Stock Position:  -0.003103046217193783
Bond Position:  [-6.04823161]


portfolio before change:  [-6.34551947]
curr_Stock_Price:  94.83035892696662
curr_Factors:  [9.48303589e+01 3.45725260e-02]
mat_Sqrt:  [[ 1.76324618e+01  0.00000000e+00]
 [-7.43747549e-03  1.70413972e-02]]
grads:  [-6.26992138e-03 -1.15571781e+01]
Stock Position:  -0.006269921379018528
Bond Position:  [-5.75094057]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.34117536]
Stock Price:  93.67878161024753
PL:  [-6.34117536]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.72799635e-01  2.89444793e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 5.11863993e-02  5.07132401e-02]
 [-1.53215383e-01 -4.12650639e-01]
 [-1.35633101e-02 -4.03698372e-03]
 [ 3.98538351e-01 -9.03748687e-01]
 [-1.01231651e+00  2.43439567e-01]
 [-6.50292966e-02 -4.36104334e-03]
 [-3.71639371e-02 -2.20974112e-04]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.89838198]
curr_Stock_Price:  98.89521623553017
curr_Factors:  [9.88952162e+01 4.15208576e-02]
mat_Sqrt:  [[ 2.01515493e+01  0.00000000e+00]
 [-8.15066697e-03  1.86755242e-02]]
grads:  [-0.02215589 15.4986168 ]
Stock Position:  -0.022155893048947883
Bond Position:  [-2.70727014]


portfolio before change:  [-4.89995326]
curr_Stock_Price:  98.90502449602843
curr_Factors:  [9.89050245e+01 4.05698022e-02]
mat_Sqrt:  [[ 1.99213974e+01  0.00000000e+00]
 [-8.05677873e-03  1.84603992e-02]]
grads:  [ 0.00471652 -2.56099624]
Stock Position:  0.0047165200781382295
Bond Position:  [-5.3664408]


portfolio before change:  [-4.89667456]
curr_Stock_Price:  100.16921818786209
curr_Factors:  [1.00169218e+02 4.11339588e-02]
mat_Sqrt:  [[ 2.03158285e+01  0.00000000e+00]
 [-8.11260341e-03  1.85883096e-02]]
grads:  [0.00360898 2.72823302]
Stock Position:  0.003608982605097527
Bond Position:  [-5.25818353]


portfolio before change:  [-4.90178022]
curr_Stock_Price:  99.48317801109562
curr_Factors:  [9.94831780e+01 4.04385409e-02]
mat_Sqrt:  [[ 2.00054069e+01  0.00000000e+00]
 [-8.04373455e-03  1.84305112e-02]]
grads:  [-1.66610401e-02 -2.23895384e+01]
Stock Position:  -0.01666104010514485
Bond Position:  [-3.244287]


portfolio before change:  [-4.89250332]
curr_Stock_Price:  98.8289904464054
curr_Factors:  [9.88289904e+01 4.34193029e-02]
mat_Sqrt:  [[ 2.05932922e+01  0.00000000e+00]
 [-8.33491959e-03  1.90977000e-02]]
grads:  [-0.00074418 -0.21138586]
Stock Position:  -0.0007441837895775948
Bond Position:  [-4.81895639]


portfolio before change:  [-4.89442304]
curr_Stock_Price:  98.17006084798017
curr_Factors:  [9.81700608e+01 4.43229025e-02]
mat_Sqrt:  [[ 2.06677479e+01  0.00000000e+00]
 [-8.42120205e-03  1.92953979e-02]]
grads:  [ 1.98864808e-04 -4.68375252e+01]
Stock Position:  0.00019886480781142627
Bond Position:  [-4.91394561]


portfolio before change:  [-4.89693342]
curr_Stock_Price:  97.90457792133738
curr_Factors:  [9.79045779e+01 4.30830344e-02]
mat_Sqrt:  [[ 2.03215178e+01  0.00000000e+00]
 [-8.30258122e-03  1.90236035e-02]]
grads:  [-0.04458677 12.7967116 ]
Stock Position:  -0.04458676694368497
Bond Position:  [-0.53168482]


portfolio before change:  [-4.90846059]
curr_Stock_Price:  98.15714757322414
curr_Factors:  [9.81571476e+01 4.47120487e-02]
mat_Sqrt:  [[ 2.07555485e+01  0.00000000e+00]
 [-8.45808950e-03  1.93799177e-02]]
grads:  [-0.00322481 -0.22502899]
Stock Position:  -0.0032248057433090153
Bond Position:  [-4.59192286]


portfolio before change:  [-4.91076504]
curr_Stock_Price:  98.15960100906395
curr_Factors:  [9.81596010e+01 4.25172906e-02]
mat_Sqrt:  [[ 2.02402361e+01  0.00000000e+00]
 [-8.24788851e-03  1.88982867e-02]]
grads:  [-0.00184091 -0.01169281]
Stock Position:  -0.0018409062946944828
Bond Position:  [-4.73006241]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.91676453]
Stock Price:  100.13355890054237
PL:  [-5.05032343]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.08206151e-01  3.26322614e-01]
 [-1.64908715e-02  2.30269985e-01]
 [-9.84142601e-02  1.21038937e-02]
 [-1.32537546e-01 -4.60664001e-01]
 [ 7.80116640e-02  2.73527837e-01]
 [ 3.19140026e-01 -6.04099857e-01]
 [-7.57631628e-01  1.30836814e-01]
 [-2.30623189e-02  2.34893244e-02]
 [-2.80013684e-02  1.62944775e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.05739092]
curr_Stock_Price:  100.99712361722275
curr_Factors:  [1.00997124e+02 3.82434483e-02]
mat_Sqrt:  [[ 1.97509290e+01  0.00000000e+00]
 [-7.82237286e-03  1.79233079e-02]]
grads:  [-3.33084514e-03  1.82066065e+01]
Stock Position:  -0.003330845137002753
Bond Position:  [9.3937967]


portfolio before change:  [9.05280985]
curr_Stock_Price:  103.78294585781047
curr_Factors:  [1.03782946e+02 3.85226833e-02]
mat_Sqrt:  [[ 2.03696825e+01  0.00000000e+00]
 [-7.85087851e-03  1.79886225e-02]]
grads:  [4.12412856e-03 1.28008682e+01]
Stock Position:  0.0041241285587102485
Bond Position:  [8.62479564]


portfolio before change:  [9.06553772]
curr_Stock_Price:  105.82322857548964
curr_Factors:  [1.05823229e+02 3.95287566e-02]
mat_Sqrt:  [[ 2.10396051e+01  0.00000000e+00]
 [-7.95273604e-03  1.82220075e-02]]
grads:  [-0.00442649  0.6642459 ]
Stock Position:  -0.004426494094737026
Bond Position:  [9.53396361]


portfolio before change:  [9.0772761]
curr_Stock_Price:  104.24857191939759
curr_Factors:  [1.04248572e+02 3.91977315e-02]
mat_Sqrt:  [[ 2.06395670e+01  0.00000000e+00]
 [-7.91936680e-03  1.81455489e-02]]
grads:  [-1.61625386e-02 -2.53871626e+01]
Stock Position:  -0.016162538617854282
Bond Position:  [10.76219767]


portfolio before change:  [9.11399609]
curr_Stock_Price:  102.3096716316495
curr_Factors:  [1.02309672e+02 3.73741065e-02]
mat_Sqrt:  [[ 1.97788984e+01  0.00000000e+00]
 [-7.73295354e-03  1.77184225e-02]]
grads:  [9.97977717e-03 1.54374825e+01]
Stock Position:  0.009979777165952152
Bond Position:  [8.09296837]


portfolio before change:  [9.11530257]
curr_Stock_Price:  102.03501442568808
curr_Factors:  [1.02035014e+02 3.47369699e-02]
mat_Sqrt:  [[ 1.90171397e+01  0.00000000e+00]
 [-7.45514264e-03  1.70818777e-02]]
grads:  [ 2.91785379e-03 -3.53649561e+01]
Stock Position:  0.002917853790982896
Bond Position:  [8.81757932]


portfolio before change:  [9.11945347]
curr_Stock_Price:  101.94625347291887
curr_Factors:  [1.01946253e+02 3.26676778e-02]
mat_Sqrt:  [[ 1.84259718e+01  0.00000000e+00]
 [-7.22968080e-03  1.65652798e-02]]
grads:  [-0.03801861  7.89825562]
Stock Position:  -0.03801860600243586
Bond Position:  [12.99530792]


portfolio before change:  [9.13876062]
curr_Stock_Price:  101.6093693340424
curr_Factors:  [1.01609369e+02 3.36834650e-02]
mat_Sqrt:  [[ 1.86484241e+01  0.00000000e+00]
 [-7.34122224e-03  1.68208533e-02]]
grads:  [-6.86960855e-04  1.39644071e+00]
Stock Position:  -0.0006869608550959214
Bond Position:  [9.20856228]


portfolio before change:  [9.14400801]
curr_Stock_Price:  100.67487934005464
curr_Factors:  [1.00674879e+02 3.50570348e-02]
mat_Sqrt:  [[ 1.88498851e+01  0.00000000e+00]
 [-7.48940957e-03  1.71603931e-02]]
grads:  [-0.00110822  0.94953987]
Stock Position:  -0.0011082229543522134
Bond Position:  [9.25557822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.14941796]
Stock Price:  99.97013949816888
PL:  [9.14941796]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.06055877e+00  7.42194902e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.06101938e-01 -5.38155677e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.45516535e-01 -1.37614205e+00]
 [-9.78815831e-01  2.99139121e-01]
 [ 6.44883181e-03  8.53440628e-02]
 [-2.95261889e-02 -2.05867180e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.85017906]
curr_Stock_Price:  96.19145951242542
curr_Factors:  [9.61914595e+01 4.43792970e-02]
mat_Sqrt:  [[ 2.02640722e+01  0.00000000e+00]
 [-8.42655773e-03  1.93076693e-02]]
grads:  [-0.05073841  3.84404192]
Stock Position:  -0.050738406232314834
Bond Position:  [-17.96957772]


portfolio before change:  [-22.86662619]
curr_Stock_Price:  96.33849003821184
curr_Factors:  [9.63384900e+01 4.45653623e-02]
mat_Sqrt:  [[ 2.03375464e+01  0.00000000e+00]
 [-8.44420391e-03  1.93481018e-02]]
grads:  [ 0.00462001 -2.44349618]
Stock Position:  0.00462001016837629
Bond Position:  [-23.311711]


portfolio before change:  [-22.87515673]
curr_Stock_Price:  97.0155964943826
curr_Factors:  [9.70155965e+01 4.48391264e-02]
mat_Sqrt:  [[ 2.05432963e+01  0.00000000e+00]
 [-8.47010048e-03  1.94074383e-02]]
grads:  [ 0.01960572 10.04279348]
Stock Position:  0.019605723263358972
Bond Position:  [-24.77721766]


portfolio before change:  [-22.91304373]
curr_Stock_Price:  95.71519554173538
curr_Factors:  [9.57151955e+01 4.45882418e-02]
mat_Sqrt:  [[ 2.02111518e+01  0.00000000e+00]
 [-8.44637123e-03  1.93530678e-02]]
grads:  [-1.68705046e-02 -2.78072543e+01]
Stock Position:  -0.016870504639829097
Bond Position:  [-21.29828008]


portfolio before change:  [-22.86809612]
curr_Stock_Price:  92.41953757080707
curr_Factors:  [9.24195376e+01 4.22998542e-02]
mat_Sqrt:  [[ 1.90078601e+01  0.00000000e+00]
 [-8.22677134e-03  1.88499012e-02]]
grads:  [-3.70726634e-03 -4.51965218e+00]
Stock Position:  -0.0037072663352241985
Bond Position:  [-22.52547228]


portfolio before change:  [-22.88529338]
curr_Stock_Price:  94.01955775395517
curr_Factors:  [9.40195578e+01 4.20057422e-02]
mat_Sqrt:  [[ 1.92695927e+01  0.00000000e+00]
 [-8.19812097e-03  1.87842550e-02]]
grads:  [-8.04796944e-03 -7.32604008e+01]
Stock Position:  -0.008047969438063303
Bond Position:  [-22.12862685]


portfolio before change:  [-22.89618924]
curr_Stock_Price:  93.99828309873845
curr_Factors:  [9.39982831e+01 4.23087252e-02]
mat_Sqrt:  [[ 1.93345866e+01  0.00000000e+00]
 [-8.22763394e-03  1.88518777e-02]]
grads:  [-0.04387272 15.86786879]
Stock Position:  -0.04387271536956258
Bond Position:  [-18.77222932]


portfolio before change:  [-22.87579576]
curr_Stock_Price:  93.3194570567078
curr_Factors:  [9.33194571e+01 4.27229238e-02]
mat_Sqrt:  [[ 1.92886879e+01  0.00000000e+00]
 [-8.26780975e-03  1.89439320e-02]]
grads:  [2.26537101e-03 4.50508705e+00]
Stock Position:  0.002265371010677448
Bond Position:  [-23.08719895]


portfolio before change:  [-22.88587376]
curr_Stock_Price:  93.96768724524767
curr_Factors:  [9.39676872e+01 4.20721386e-02]
mat_Sqrt:  [[ 1.92741765e+01  0.00000000e+00]
 [-8.20459760e-03  1.87990948e-02]]
grads:  [-6.19346784e-03 -1.09509092e+01]
Stock Position:  -0.006193467836879569
Bond Position:  [-22.30388791]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.9104802]
Stock Price:  96.13960596414799
PL:  [-22.9104802]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.27729900e-01  2.92397607e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.89111833e-02  8.56627218e-03]
 [-1.62359253e-01 -4.12115668e-01]
 [ 1.29371518e-01  4.95735200e-01]
 [ 2.20006982e-01 -5.89801922e-01]
 [-2.22236078e-01 -6.48005968e-02]
 [ 3.41524150e-01 -5.31764663e-01]
 [-5.08641378e-02  3.35917338e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.58033159]
curr_Stock_Price:  98.34067030450848
curr_Factors:  [9.83406703e+01 4.21017667e-02]
mat_Sqrt:  [[ 2.01782419e+01  0.00000000e+00]
 [-8.20748602e-03  1.88057130e-02]]
grads:  [-0.0297408  15.54833934]
Stock Position:  -0.02974080325844025
Bond Position:  [-5.65560107]


portfolio before change:  [-8.66891815]
curr_Stock_Price:  101.22418504357164
curr_Factors:  [1.01224185e+02 4.11373208e-02]
mat_Sqrt:  [[ 2.05306307e+01  0.00000000e+00]
 [-8.11293494e-03  1.85890692e-02]]
grads:  [ 0.00457656 -2.5432695 ]
Stock Position:  0.004576560380672184
Bond Position:  [-9.13217674]


portfolio before change:  [-8.66198636]
curr_Stock_Price:  103.73677408953117
curr_Factors:  [1.03736774e+02 4.01270403e-02]
mat_Sqrt:  [[ 2.07802756e+01  0.00000000e+00]
 [-8.01269396e-03  1.83593883e-02]]
grads:  [-0.00457995  0.4665881 ]
Stock Position:  -0.004579946747870968
Bond Position:  [-8.18687746]


portfolio before change:  [-8.65239229]
curr_Stock_Price:  100.74797694121729
curr_Factors:  [1.00747977e+02 4.09835057e-02]
mat_Sqrt:  [[ 2.03958067e+01  0.00000000e+00]
 [-8.09775334e-03  1.85542838e-02]]
grads:  [-1.67790018e-02 -2.22113487e+01]
Stock Position:  -0.016779001791735332
Bond Position:  [-6.96194181]


portfolio before change:  [-8.72449297]
curr_Stock_Price:  104.8375429783074
curr_Factors:  [1.04837543e+02 3.88590626e-02]
mat_Sqrt:  [[ 2.06663126e+01  0.00000000e+00]
 [-7.88508086e-03  1.80669900e-02]]
grads:  [1.67290655e-02 2.74387267e+01]
Stock Position:  0.016729065522380165
Bond Position:  [-10.47832709]


portfolio before change:  [-8.65774505]
curr_Stock_Price:  109.14073578265979
curr_Factors:  [1.09140736e+02 3.72579477e-02]
mat_Sqrt:  [[ 2.10666918e+01  0.00000000e+00]
 [-7.72092717e-03  1.76908666e-02]]
grads:  [-1.7754890e-03 -3.3339346e+01]
Stock Position:  -0.0017754890018174072
Bond Position:  [-8.46396687]


portfolio before change:  [-8.66307076]
curr_Stock_Price:  109.75615600965043
curr_Factors:  [1.09756156e+02 3.96198284e-02]
mat_Sqrt:  [[ 2.18466667e+01  0.00000000e+00]
 [-7.96189208e-03  1.82429866e-02]]
grads:  [-0.01146708 -3.55208269]
Stock Position:  -0.011467075507369905
Bond Position:  [-7.40448863]


portfolio before change:  [-8.69081736]
curr_Stock_Price:  111.85289169746143
curr_Factors:  [1.11852892e+02 4.05413531e-02]
mat_Sqrt:  [[ 2.25214494e+01  0.00000000e+00]
 [-8.05395338e-03  1.84539255e-02]]
grads:  [ 4.85950182e-03 -2.88158020e+01]
Stock Position:  0.004859501816114646
Bond Position:  [-9.23436669]


portfolio before change:  [-8.69619696]
curr_Stock_Price:  111.69623632335349
curr_Factors:  [1.11696236e+02 4.10510851e-02]
mat_Sqrt:  [[ 2.26308497e+01  0.00000000e+00]
 [-8.10442695e-03  1.85695750e-02]]
grads:  [4.23060596e-03 1.80896621e+01]
Stock Position:  0.004230605961008645
Bond Position:  [-9.16873973]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.70283863]
Stock Price:  111.21021839473737
PL:  [-19.91305702]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.15698997e+00 -6.57219072e-02]
 [ 1.14661002e-01 -3.95895240e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 5.27070857e-02 -5.52949558e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.76401185e-01 -1.68103280e+00]
 [-8.20006305e-01  3.51774589e-01]
 [ 1.46344733e-01  4.16518593e-02]
 [ 1.44179783e-01 -1.46617808e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.27237571]
curr_Stock_Price:  95.22419939429479
curr_Factors:  [9.52241994e+01 4.13742051e-02]
mat_Sqrt:  [[ 1.93692213e+01  0.00000000e+00]
 [-8.13626008e-03  1.86425138e-02]]
grads:  [-0.0612143  -3.52537795]
Stock Position:  -0.06121430183148626
Bond Position:  [-23.44329283]


portfolio before change:  [-29.15585798]
curr_Stock_Price:  93.12922628931007
curr_Factors:  [9.31292263e+01 4.13867442e-02]
mat_Sqrt:  [[ 1.89459604e+01  0.00000000e+00]
 [-8.13749290e-03  1.86453386e-02]]
grads:  [ 0.00514003 -2.12329338]
Stock Position:  0.005140025379453372
Bond Position:  [-29.63454456]


portfolio before change:  [-29.17164293]
curr_Stock_Price:  92.94168313022149
curr_Factors:  [9.29416831e+01 4.12784742e-02]
mat_Sqrt:  [[ 1.88830590e+01  0.00000000e+00]
 [-8.12684187e-03  1.86209340e-02]]
grads:  [ 0.0213295  10.46697736]
Stock Position:  0.021329498603527553
Bond Position:  [-31.15404243]


portfolio before change:  [-29.19700593]
curr_Stock_Price:  92.48306552260584
curr_Factors:  [9.24830655e+01 3.99700711e-02]
mat_Sqrt:  [[ 1.84896920e+01  0.00000000e+00]
 [-7.99700655e-03  1.83234439e-02]]
grads:  [-1.02013536e-02 -3.01771632e+01]
Stock Position:  -0.010201353601803
Bond Position:  [-28.25355348]


portfolio before change:  [-29.21118379]
curr_Stock_Price:  92.48772647624256
curr_Factors:  [9.24877265e+01 4.06154427e-02]
mat_Sqrt:  [[ 1.86393043e+01  0.00000000e+00]
 [-8.06130934e-03  1.84707801e-02]]
grads:  [-3.78057027e-03 -4.61242008e+00]
Stock Position:  -0.0037805702660713065
Bond Position:  [-28.86152744]


portfolio before change:  [-29.22136945]
curr_Stock_Price:  91.36389795393157
curr_Factors:  [9.13638980e+01 3.76330245e-02]
mat_Sqrt:  [[ 1.77238955e+01  0.00000000e+00]
 [-7.75969324e-03  1.77796908e-02]]
grads:  [-1.45149624e-02 -9.45479209e+01]
Stock Position:  -0.014514962391865104
Bond Position:  [-27.8952259]


portfolio before change:  [-29.22283338]
curr_Stock_Price:  90.50360184313388
curr_Factors:  [9.05036018e+01 3.72536373e-02]
mat_Sqrt:  [[ 1.74682824e+01  0.00000000e+00]
 [-7.72048054e-03  1.76898432e-02]]
grads:  [-0.03815368 19.88568153]
Stock Position:  -0.03815368173346482
Bond Position:  [-25.76978776]


portfolio before change:  [-29.1934771]
curr_Stock_Price:  89.39638516487304
curr_Factors:  [8.93963852e+01 3.85652566e-02]
mat_Sqrt:  [[ 1.75556968e+01  0.00000000e+00]
 [-7.85521550e-03  1.79985598e-02]]
grads:  [0.00937149 2.31417734]
Stock Position:  0.009371493282773733
Bond Position:  [-30.03125473]


portfolio before change:  [-29.22936889]
curr_Stock_Price:  87.16916193967275
curr_Factors:  [8.71691619e+01 3.91972845e-02]
mat_Sqrt:  [[ 1.72580158e+01  0.00000000e+00]
 [-7.91932163e-03  1.81454454e-02]]
grads:  [ 4.64656698e-03 -8.08014376e+00]
Stock Position:  0.004646566979205639
Bond Position:  [-29.63440624]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.24500079]
Stock Price:  86.99462741314355
PL:  [-29.24500079]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.08312454e+00  4.01260738e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.64377464e-01  1.67524292e-01]
 [-1.29122379e-01 -4.70415205e-01]
 [ 1.38783505e-02  7.98793655e-02]
 [ 4.09380587e-01 -1.02231113e+00]
 [-9.69035902e-01  2.28634408e-01]
 [-5.05538164e-02  1.37065517e-02]
 [-3.71095568e-02 -3.24362658e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.44237939]
curr_Stock_Price:  95.9516549788012
curr_Factors:  [9.59516550e+01 4.03348345e-02]
mat_Sqrt:  [[ 1.92704834e+01  0.00000000e+00]
 [-8.03341367e-03  1.84068631e-02]]
grads:  [-0.05529763  2.17995177]
Stock Position:  -0.05529763134323578
Bond Position:  [-19.13648014]


portfolio before change:  [-24.43488683]
curr_Stock_Price:  95.64308504690665
curr_Factors:  [9.56430850e+01 4.26613732e-02]
mat_Sqrt:  [[ 1.97547251e+01  0.00000000e+00]
 [-8.26185192e-03  1.89302809e-02]]
grads:  [ 0.00475631 -2.49742796]
Stock Position:  0.004756313759276171
Bond Position:  [-24.88979535]


portfolio before change:  [-24.43856769]
curr_Stock_Price:  97.48635089039232
curr_Factors:  [9.74863509e+01 4.54580060e-02]
mat_Sqrt:  [[ 2.07849510e+01  0.00000000e+00]
 [-8.52835328e-03  1.95409122e-02]]
grads:  [0.01623728 8.57300263]
Stock Position:  0.01623727952574754
Bond Position:  [-26.02148082]


portfolio before change:  [-24.44906569]
curr_Stock_Price:  97.64130297310084
curr_Factors:  [9.76413030e+01 4.60145717e-02]
mat_Sqrt:  [[ 2.09450431e+01  0.00000000e+00]
 [-8.58040295e-03  1.96601730e-02]]
grads:  [-1.59669476e-02 -2.39273177e+01]
Stock Position:  -0.015966947629219387
Bond Position:  [-22.89003211]


portfolio before change:  [-24.49447514]
curr_Stock_Price:  99.76829515313841
curr_Factors:  [9.97682952e+01 4.46713215e-02]
mat_Sqrt:  [[ 2.10866190e+01  0.00000000e+00]
 [-8.45423648e-03  1.93710893e-02]]
grads:  [2.31144517e-03 4.12363829e+00]
Stock Position:  0.002311445171661745
Bond Position:  [-24.72508408]


portfolio before change:  [-24.51303279]
curr_Stock_Price:  97.08944237263275
curr_Factors:  [9.70894424e+01 4.85787240e-02]
mat_Sqrt:  [[ 2.13990778e+01  0.00000000e+00]
 [-8.81623266e-03  2.02005268e-02]]
grads:  [-1.71935299e-03 -5.06081422e+01]
Stock Position:  -0.001719352992876433
Bond Position:  [-24.34610177]


portfolio before change:  [-24.5281058]
curr_Stock_Price:  98.7743262376992
curr_Factors:  [9.87743262e+01 4.61945081e-02]
mat_Sqrt:  [[ 2.12294748e+01  0.00000000e+00]
 [-8.59716308e-03  1.96985753e-02]]
grads:  [-0.04094551 11.60664691]
Stock Position:  -0.040945509729848305
Bond Position:  [-20.48374066]


portfolio before change:  [-24.47884852]
curr_Stock_Price:  97.32113385141525
curr_Factors:  [9.73211339e+01 4.66426491e-02]
mat_Sqrt:  [[ 2.10183570e+01  0.00000000e+00]
 [-8.63876372e-03  1.97938943e-02]]
grads:  [-0.00212061  0.69246362]
Stock Position:  -0.0021206123195871367
Bond Position:  [-24.27246813]


portfolio before change:  [-24.49096456]
curr_Stock_Price:  97.31017736640302
curr_Factors:  [9.73101774e+01 4.49609539e-02]
mat_Sqrt:  [[ 2.06336482e+01  0.00000000e+00]
 [-8.48159927e-03  1.94337853e-02]]
grads:  [-0.00248458 -1.66906576]
Stock Position:  -0.00248457777159603
Bond Position:  [-24.24918985]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.50013947]
Stock Price:  96.12176061561796
PL:  [-24.50013947]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 2.13033990e-01 -1.32835312e-01]
 [-1.10183454e-02  2.30385006e-01]
 [-9.85803160e-02  1.09217330e-02]
 [-1.18038215e-01 -4.73369026e-01]
 [ 4.78075526e-02  1.80633255e-01]
 [ 2.57980619e-01 -6.24423846e-01]
 [-5.30231963e-01  4.49173014e-02]
 [ 9.32147173e-02 -1.38539111e-01]
 [-3.29888804e-02  1.16515723e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.15190722]
curr_Stock_Price:  102.36686724005459
curr_Factors:  [1.02366867e+02 4.13953348e-02]
mat_Sqrt:  [[ 2.08274026e+01  0.00000000e+00]
 [-8.13833740e-03  1.86472736e-02]]
grads:  [ 0.00744499 -7.12357824]
Stock Position:  0.007444994923201099
Bond Position:  [17.38978641]


portfolio before change:  [18.16960757]
curr_Stock_Price:  103.576174456171
curr_Factors:  [1.03576174e+02 4.27228384e-02]
mat_Sqrt:  [[ 2.14086812e+01  0.00000000e+00]
 [-8.26780149e-03  1.89439131e-02]]
grads:  [4.18194439e-03 1.21614265e+01]
Stock Position:  0.004181944387318881
Bond Position:  [17.73645777]


portfolio before change:  [18.18496176]
curr_Stock_Price:  105.12658714758909
curr_Factors:  [1.05126587e+02 3.88755690e-02]
mat_Sqrt:  [[ 2.07276919e+01  0.00000000e+00]
 [-7.88675538e-03  1.80708268e-02]]
grads:  [-0.00452601  0.6043848 ]
Stock Position:  -0.004526007107020902
Bond Position:  [18.66076544]


portfolio before change:  [18.19301396]
curr_Stock_Price:  105.40950977589428
curr_Factors:  [1.05409510e+02 3.66264226e-02]
mat_Sqrt:  [[ 2.01733045e+01  0.00000000e+00]
 [-7.65521235e-03  1.75402950e-02]]
grads:  [-1.60922270e-02 -2.69875179e+01]
Stock Position:  -0.016092226997005462
Bond Position:  [19.88928772]


portfolio before change:  [18.27230585]
curr_Stock_Price:  101.10030144160902
curr_Factors:  [1.01100301e+02 3.61418827e-02]
mat_Sqrt:  [[ 1.92201971e+01  0.00000000e+00]
 [-7.60440742e-03  1.74238863e-02]]
grads:  [6.58902547e-03 1.03669900e+01]
Stock Position:  0.0065890254729880715
Bond Position:  [17.60615339]


portfolio before change:  [18.29743915]
curr_Stock_Price:  103.57836419345739
curr_Factors:  [1.03578364e+02 3.61870927e-02]
mat_Sqrt:  [[ 1.97036142e+01  0.00000000e+00]
 [-7.60916213e-03  1.74347807e-02]]
grads:  [-7.37950376e-04 -3.58148379e+01]
Stock Position:  -0.0007379503755917617
Bond Position:  [18.37387484]


portfolio before change:  [18.30534275]
curr_Stock_Price:  105.3205325857667
curr_Factors:  [1.05320533e+02 3.46338483e-02]
mat_Sqrt:  [[ 1.96003317e+01  0.00000000e+00]
 [-7.44406859e-03  1.70565039e-02]]
grads:  [-0.02605203  2.63344127]
Stock Position:  -0.02605203080563778
Bond Position:  [21.04915651]


portfolio before change:  [18.32080322]
curr_Stock_Price:  105.13117059631516
curr_Factors:  [1.05131171e+02 3.55355780e-02]
mat_Sqrt:  [[ 1.98181537e+01  0.00000000e+00]
 [-7.54035310e-03  1.72771194e-02]]
grads:  [ 1.65259050e-03 -8.01864635e+00]
Stock Position:  0.0016525904962403698
Bond Position:  [18.14706445]


portfolio before change:  [18.32792138]
curr_Stock_Price:  103.94657626745321
curr_Factors:  [1.03946576e+02 3.64638285e-02]
mat_Sqrt:  [[ 1.98491229e+01  0.00000000e+00]
 [-7.63820172e-03  1.75013188e-02]]
grads:  [8.99926423e-04 6.65753962e+00]
Stock Position:  0.0008999264232591256
Bond Position:  [18.2343771]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.33902962]
Stock Price:  106.15650679443931
PL:  [12.18252282]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 8.01448277e-02  1.33977883e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.91377201e-02  6.95354503e-03]
 [-1.39781096e-01 -4.54408891e-01]
 [ 5.47918237e-02  2.01968067e-01]
 [ 3.57864886e-01 -6.93221905e-01]
 [-8.98182035e-01  1.94307395e-01]
 [-3.48737498e-02  1.56509545e-02]
 [-4.23335754e-02  2.06226827e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.20656955]
curr_Stock_Price:  102.07387597140946
curr_Factors:  [1.02073876e+02 4.05983506e-02]
mat_Sqrt:  [[ 2.05668983e+01  0.00000000e+00]
 [-8.05961295e-03  1.84668932e-02]]
grads:  [0.00418109 0.7255031 ]
Stock Position:  0.004181092382072234
Bond Position:  [15.77978924]


portfolio before change:  [16.21185039]
curr_Stock_Price:  101.44939240918272
curr_Factors:  [1.01449392e+02 4.16629981e-02]
mat_Sqrt:  [[ 2.07073589e+01  0.00000000e+00]
 [-8.16460636e-03  1.87074633e-02]]
grads:  [ 0.0045375  -2.52717389]
Stock Position:  0.004537501459571122
Bond Position:  [15.75152363]


portfolio before change:  [16.22578619]
curr_Stock_Price:  102.78450221022355
curr_Factors:  [1.02784502e+02 4.20046723e-02]
mat_Sqrt:  [[ 2.10657263e+01  0.00000000e+00]
 [-8.19801657e-03  1.87840157e-02]]
grads:  [-0.00456205  0.37018416]
Stock Position:  -0.004562052257305604
Bond Position:  [16.69469446]


portfolio before change:  [16.23010152]
curr_Stock_Price:  103.66877612199863
curr_Factors:  [1.03668776e+02 4.24550998e-02]
mat_Sqrt:  [[ 2.13605733e+01  0.00000000e+00]
 [-8.24185414e-03  1.88844602e-02]]
grads:  [-1.58282922e-02 -2.40625830e+01]
Stock Position:  -0.01582829216797043
Bond Position:  [17.87100119]


portfolio before change:  [16.27518598]
curr_Stock_Price:  101.385098034224
curr_Factors:  [1.01385098e+02 4.38449854e-02]
mat_Sqrt:  [[ 2.12292226e+01  0.00000000e+00]
 [-8.37567769e-03  1.91910885e-02]]
grads:  [6.73307344e-03 1.05240548e+01]
Stock Position:  0.006733073436688291
Bond Position:  [15.59255267]


portfolio before change:  [16.27658988]
curr_Stock_Price:  100.4354090529871
curr_Factors:  [1.00435409e+02 4.49719245e-02]
mat_Sqrt:  [[ 2.12989203e+01  0.00000000e+00]
 [-8.48263398e-03  1.94361561e-02]]
grads:  [ 2.59722287e-03 -3.56666153e+01]
Stock Position:  0.002597222865345309
Bond Position:  [16.01573673]


portfolio before change:  [16.28299353]
curr_Stock_Price:  99.81697327893148
curr_Factors:  [9.98169733e+01 4.33802556e-02]
mat_Sqrt:  [[ 2.07898066e+01  0.00000000e+00]
 [-8.33117093e-03  1.90891107e-02]]
grads:  [-0.03912395 10.17896527]
Stock Position:  -0.03912394902531516
Bond Position:  [20.18822771]


portfolio before change:  [16.24516461]
curr_Stock_Price:  101.04194067743344
curr_Factors:  [1.01041941e+02 4.54163838e-02]
mat_Sqrt:  [[ 2.15331693e+01  0.00000000e+00]
 [-8.52444803e-03  1.95319642e-02]]
grads:  [-0.00130232  0.80129957]
Stock Position:  -0.0013023216847317136
Bond Position:  [16.37675372]


portfolio before change:  [16.24592639]
curr_Stock_Price:  106.74609184272353
curr_Factors:  [1.06746092e+02 3.96448343e-02]
mat_Sqrt:  [[ 2.12542257e+01  0.00000000e+00]
 [-7.96440424e-03  1.82487426e-02]]
grads:  [2.24290415e-03 1.13008787e+01]
Stock Position:  0.00224290415283166
Bond Position:  [16.00650514]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.25117809]
Stock Price:  105.51841981261835
PL:  [10.73275828]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.52988331e-01 -2.86806681e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.58576800e-01  9.94323800e-02]
 [-1.63712999e-01 -4.15402860e-01]
 [ 1.97504620e-02  9.80118275e-02]
 [ 3.63535189e-01 -7.11058374e-01]
 [-9.52845369e-01  2.21158175e-01]
 [-3.85128461e-02  2.42102707e-02]
 [-3.57421122e-02  2.22834531e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.22177937]
curr_Stock_Price:  102.67861490004249
curr_Factors:  [1.02678615e+02 4.11355864e-02]
mat_Sqrt:  [[ 2.08251840e+01  0.00000000e+00]
 [-8.11276391e-03  1.85886774e-02]]
grads:  [ 1.09394296e-02 -1.54291064e+01]
Stock Position:  0.010939429565178255
Bond Position:  [19.09853389]


portfolio before change:  [20.20902996]
curr_Stock_Price:  100.64002074805866
curr_Factors:  [1.00640021e+02 3.92130015e-02]
mat_Sqrt:  [[ 1.99290116e+01  0.00000000e+00]
 [-7.92090919e-03  1.81490830e-02]]
grads:  [ 0.00471472 -2.60492571]
Stock Position:  0.004714718059003954
Bond Position:  [19.73454064]


portfolio before change:  [20.20854425]
curr_Stock_Price:  98.44361249312229
curr_Factors:  [9.84436125e+01 4.11147168e-02]
mat_Sqrt:  [[ 1.99611792e+01  0.00000000e+00]
 [-8.11070570e-03  1.85839614e-02]]
grads:  [0.01011827 5.35044051]
Stock Position:  0.010118272365487914
Bond Position:  [19.21246497]


portfolio before change:  [20.23362096]
curr_Stock_Price:  99.97233901698847
curr_Factors:  [9.99723390e+01 3.94803057e-02]
mat_Sqrt:  [[ 1.98641555e+01  0.00000000e+00]
 [-7.94786066e-03  1.82108365e-02]]
grads:  [-1.73684540e-02 -2.28107511e+01]
Stock Position:  -0.01736845395180951
Bond Position:  [21.96998593]


portfolio before change:  [20.24472752]
curr_Stock_Price:  99.9654981014038
curr_Factors:  [9.99654981e+01 3.74234178e-02]
mat_Sqrt:  [[ 1.93384587e+01  0.00000000e+00]
 [-7.73805327e-03  1.77301074e-02]]
grads:  [3.23326338e-03 5.52798836e+00]
Stock Position:  0.0032332633789690264
Bond Position:  [19.92151273]


portfolio before change:  [20.2558499]
curr_Stock_Price:  100.32400330467665
curr_Factors:  [1.00324003e+02 3.44580922e-02]
mat_Sqrt:  [[ 1.86230354e+01  0.00000000e+00]
 [-7.42515640e-03  1.70131706e-02]]
grads:  [ 2.85688513e-03 -4.17945831e+01]
Stock Position:  0.002856885129062013
Bond Position:  [19.96923575]


portfolio before change:  [20.26219529]
curr_Stock_Price:  99.0492832201863
curr_Factors:  [9.90492832e+01 3.33486903e-02]
mat_Sqrt:  [[ 1.80880074e+01  0.00000000e+00]
 [-7.30464951e-03  1.67370546e-02]]
grads:  [-0.04734209 13.21368544]
Stock Position:  -0.04734208736300044
Bond Position:  [24.95139511]


portfolio before change:  [20.40671768]
curr_Stock_Price:  96.26014618788842
curr_Factors:  [9.62601462e+01 3.51931515e-02]
mat_Sqrt:  [[ 1.80582473e+01  0.00000000e+00]
 [-7.50393513e-03  1.71936754e-02]]
grads:  [-0.00154758  1.40809165]
Stock Position:  -0.0015475819588658159
Bond Position:  [20.55568814]


portfolio before change:  [20.41344707]
curr_Stock_Price:  98.55470950520422
curr_Factors:  [9.85547095e+01 3.43185894e-02]
mat_Sqrt:  [[ 1.82575331e+01  0.00000000e+00]
 [-7.41011087e-03  1.69786970e-02]]
grads:  [-0.0019044  0.1312436]
Stock Position:  -0.0019043965235417833
Bond Position:  [20.60113431]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.42351361]
Stock Price:  98.67894881430718
PL:  [20.42351361]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.85748714e-01  2.75548442e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 5.29258612e-02  5.10118063e-02]
 [-1.59824565e-01 -4.14578533e-01]
 [ 5.87770616e-02  2.14328815e-01]
 [ 2.52194920e-01 -6.22204371e-01]
 [-5.38895850e-01  4.81899390e-02]
 [ 5.83935719e-02 -8.18982012e-02]
 [-2.87539082e-02  7.58871051e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.66884799]
curr_Stock_Price:  99.53223496398532
curr_Factors:  [9.95322350e+01 4.20816655e-02]
mat_Sqrt:  [[ 2.04178597e+01  0.00000000e+00]
 [-8.20552648e-03  1.88012231e-02]]
grads:  [-1.30028082e-02  1.46558786e+01]
Stock Position:  -0.013002808237204124
Bond Position:  [0.62535057]


portfolio before change:  [-0.68614474]
curr_Stock_Price:  100.88651964310124
curr_Factors:  [1.00886520e+02 4.28898319e-02]
mat_Sqrt:  [[ 2.08934574e+01  0.00000000e+00]
 [-8.28394417e-03  1.89809006e-02]]
grads:  [ 0.00449709 -2.49076763]
Stock Position:  0.004497085817300494
Bond Position:  [-1.13984008]


portfolio before change:  [-0.69014789]
curr_Stock_Price:  100.12311734816979
curr_Factors:  [1.00123117e+02 4.11968308e-02]
mat_Sqrt:  [[ 2.03219916e+01  0.00000000e+00]
 [-8.11880097e-03  1.86025100e-02]]
grads:  [0.0036999  2.74220018]
Stock Position:  0.003699895184236839
Bond Position:  [-1.06059293]


portfolio before change:  [-0.69190634]
curr_Stock_Price:  99.79121070078591
curr_Factors:  [9.97912107e+01 4.32346124e-02]
mat_Sqrt:  [[ 2.07495211e+01  0.00000000e+00]
 [-8.31717379e-03  1.90570392e-02]]
grads:  [-1.64226186e-02 -2.17546140e+01]
Stock Position:  -0.01642261861418946
Bond Position:  [0.94692666]


portfolio before change:  [-0.72016883]
curr_Stock_Price:  101.54099704432618
curr_Factors:  [1.01540997e+02 3.87186660e-02]
mat_Sqrt:  [[ 1.99802821e+01  0.00000000e+00]
 [-7.87082369e-03  1.80343227e-02]]
grads:  [7.62340713e-03 1.18844949e+01]
Stock Position:  0.0076234071308622624
Bond Position:  [-1.49425719]


portfolio before change:  [-0.70448364]
curr_Stock_Price:  103.6965304888014
curr_Factors:  [1.03696530e+02 4.02508393e-02]
mat_Sqrt:  [[ 2.08042324e+01  0.00000000e+00]
 [-8.02504473e-03  1.83876875e-02]]
grads:  [-9.30451568e-04 -3.38380980e+01]
Stock Position:  -0.000930451568180317
Bond Position:  [-0.60799904]


portfolio before change:  [-0.70616993]
curr_Stock_Price:  105.18206663511631
curr_Factors:  [1.05182067e+02 3.86309275e-02]
mat_Sqrt:  [[ 2.06732743e+01  0.00000000e+00]
 [-7.86190078e-03  1.80138777e-02]]
grads:  [-0.02504993  2.67515633]
Stock Position:  -0.02504992817479993
Bond Position:  [1.92863328]


portfolio before change:  [-0.68004842]
curr_Stock_Price:  104.17779394623666
curr_Factors:  [1.04177794e+02 3.60657343e-02]
mat_Sqrt:  [[ 1.97843846e+01  0.00000000e+00]
 [-7.59639223e-03  1.74055212e-02]]
grads:  [ 1.14485575e-03 -4.70530014e+00]
Stock Position:  0.001144855751723906
Bond Position:  [-0.79931696]


portfolio before change:  [-0.68216401]
curr_Stock_Price:  102.67905492823608
curr_Factors:  [1.02679055e+02 3.45554863e-02]
mat_Sqrt:  [[ 1.90871184e+01  0.00000000e+00]
 [-7.43564241e-03  1.70371971e-02]]
grads:  [2.28737501e-04 4.45420128e+00]
Stock Position:  0.00022873750147382749
Bond Position:  [-0.70565057]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.68259228]
Stock Price:  102.3496442498948
PL:  [-3.03223653]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.92280672e-01 -2.90887312e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-6.46391997e-02  1.39588900e-02]
 [-1.47877413e-01 -4.41638934e-01]
 [ 8.65750484e-02  2.99863393e-01]
 [ 3.04026762e-01 -6.04822964e-01]
 [-8.09427670e-01  1.50924101e-01]
 [-5.92110263e-02  3.25478515e-03]
 [-3.70018869e-02 -2.66747163e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.07769654]
curr_Stock_Price:  103.10875040241334
curr_Factors:  [1.0310875e+02 3.8921081e-02]
mat_Sqrt:  [[ 2.03417340e+01  0.00000000e+00]
 [-7.89137057e-03  1.80814015e-02]]
grads:  [ 1.3043482e-02 -1.6087653e+01]
Stock Position:  0.013043481989362856
Bond Position:  [21.73279941]


portfolio before change:  [23.05888799]
curr_Stock_Price:  100.83346368891443
curr_Factors:  [1.00833464e+02 3.84107202e-02]
mat_Sqrt:  [[ 1.97620007e+01  0.00000000e+00]
 [-7.83946123e-03  1.79624623e-02]]
grads:  [ 0.00475456 -2.63198955]
Stock Position:  0.004754562671928865
Bond Position:  [22.57946897]


portfolio before change:  [23.07176012]
curr_Stock_Price:  101.16568583509175
curr_Factors:  [1.01165686e+02 3.78911705e-02]
mat_Sqrt:  [[ 1.96925629e+01  0.00000000e+00]
 [-7.78626180e-03  1.78405670e-02]]
grads:  [-0.00297305  0.78242412]
Stock Position:  -0.0029730533790508526
Bond Position:  [23.37253111]


portfolio before change:  [23.07873466]
curr_Stock_Price:  102.7514782253214
curr_Factors:  [1.02751478e+02 3.73307240e-02]
mat_Sqrt:  [[ 1.98527779e+01  0.00000000e+00]
 [-7.72846417e-03  1.77081360e-02]]
grads:  [-1.71575206e-02 -2.49398883e+01]
Stock Position:  -0.017157520566294344
Bond Position:  [24.84169527]


portfolio before change:  [23.092855]
curr_Stock_Price:  102.65260725885963
curr_Factors:  [1.02652607e+02 3.78076408e-02]
mat_Sqrt:  [[ 1.99599649e+01  0.00000000e+00]
 [-7.77767480e-03  1.78208918e-02]]
grads:  [1.08941155e-02 1.68265089e+01]
Stock Position:  0.010894115453214592
Bond Position:  [21.97454564]


portfolio before change:  [23.10095696]
curr_Stock_Price:  102.38750504705742
curr_Factors:  [1.02387505e+02 3.91707813e-02]
mat_Sqrt:  [[ 2.02641353e+01  0.00000000e+00]
 [-7.91664387e-03  1.81393099e-02]]
grads:  [ 1.97691039e-03 -3.33432180e+01]
Stock Position:  0.0019769103939236772
Bond Position:  [22.89854604]


portfolio before change:  [23.10996053]
curr_Stock_Price:  101.14892031277996
curr_Factors:  [1.01148920e+02 3.85672716e-02]
mat_Sqrt:  [[ 1.98641831e+01  0.00000000e+00]
 [-7.85542071e-03  1.79990300e-02]]
grads:  [-0.03743215  8.38512412]
Stock Position:  -0.03743214549918198
Bond Position:  [26.89618163]


portfolio before change:  [23.25110381]
curr_Stock_Price:  97.73763248574622
curr_Factors:  [9.77376325e+01 3.98852341e-02]
mat_Sqrt:  [[ 1.95194640e+01  0.00000000e+00]
 [-7.98851517e-03  1.83039877e-02]]
grads:  [-0.00296066  0.17781836]
Stock Position:  -0.002960661299253554
Bond Position:  [23.54047183]


portfolio before change:  [23.26391751]
curr_Stock_Price:  97.38618050009485
curr_Factors:  [9.73861805e+01 4.27613603e-02]
mat_Sqrt:  [[ 2.01383131e+01  0.00000000e+00]
 [-8.27152806e-03  1.89524517e-02]]
grads:  [-0.00241548 -1.40745465]
Stock Position:  -0.0024154797486689973
Bond Position:  [23.49915186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.27224884]
Stock Price:  98.8025416454835
PL:  [23.27224884]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.29524312e-01  2.85998469e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.93891765e-02  5.16341360e-03]
 [-1.47478947e-01 -4.42660651e-01]
 [ 7.09667958e-02  2.51762652e-01]
 [ 3.52775175e-01 -6.77211743e-01]
 [-5.13092690e-01  3.84403862e-02]
 [ 1.30737206e-01 -1.98202429e-01]
 [-4.45655516e-02  2.27686877e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.89047307]
curr_Stock_Price:  99.04701944902773
curr_Factors:  [9.90470194e+01 4.39567015e-02]
mat_Sqrt:  [[ 2.07660531e+01  0.00000000e+00]
 [-8.38634142e-03  1.92155222e-02]]
grads:  [-0.01948875 14.88372088]
Stock Position:  -0.019488746671354213
Bond Position:  [-1.9601708]


portfolio before change:  [-3.8997268]
curr_Stock_Price:  99.47154114264491
curr_Factors:  [9.94715411e+01 4.51855611e-02]
mat_Sqrt:  [[ 2.11445617e+01  0.00000000e+00]
 [-8.50275825e-03  1.94822666e-02]]
grads:  [ 0.00444368 -2.42666902]
Stock Position:  0.004443680247193991
Bond Position:  [-4.34174652]


portfolio before change:  [-3.89187107]
curr_Stock_Price:  101.72803678618756
curr_Factors:  [1.01728037e+02 4.32743285e-02]
mat_Sqrt:  [[ 2.11619572e+01  0.00000000e+00]
 [-8.32099306e-03  1.90657903e-02]]
grads:  [-0.00459011  0.27082085]
Stock Position:  -0.004590108426012336
Bond Position:  [-3.42492835]


portfolio before change:  [-3.89851634]
curr_Stock_Price:  102.80260336098777
curr_Factors:  [1.02802603e+02 4.36910301e-02]
mat_Sqrt:  [[ 2.14882108e+01  0.00000000e+00]
 [-8.36095976e-03  1.91573655e-02]]
grads:  [-1.58538976e-02 -2.31065514e+01]
Stock Position:  -0.015853897612604043
Bond Position:  [-2.26869439]


portfolio before change:  [-3.88741909]
curr_Stock_Price:  102.0310660088536
curr_Factors:  [1.02031066e+02 4.20884126e-02]
mat_Sqrt:  [[ 2.09321432e+01  0.00000000e+00]
 [-8.20618426e-03  1.88027303e-02]]
grads:  [8.63958475e-03 1.33896859e+01]
Stock Position:  0.008639584749888903
Bond Position:  [-4.76892514]


portfolio before change:  [-3.90163606]
curr_Stock_Price:  100.66156620081789
curr_Factors:  [1.00661566e+02 4.40064216e-02]
mat_Sqrt:  [[ 2.11164890e+01  0.00000000e+00]
 [-8.39108303e-03  1.92263866e-02]]
grads:  [ 2.70952900e-03 -3.52230379e+01]
Stock Position:  0.002709529000800522
Bond Position:  [-4.1743815]


portfolio before change:  [-3.89044464]
curr_Stock_Price:  105.56246847288907
curr_Factors:  [1.05562468e+02 3.98731643e-02]
mat_Sqrt:  [[ 2.10789944e+01  0.00000000e+00]
 [-7.98730636e-03  1.83012180e-02]]
grads:  [-0.02354552  2.10042776]
Stock Position:  -0.023545522191691683
Bond Position:  [-1.40492119]


portfolio before change:  [-3.90491354]
curr_Stock_Price:  106.14713455459561
curr_Factors:  [1.06147135e+02 3.81394179e-02]
mat_Sqrt:  [[ 2.07298092e+01  0.00000000e+00]
 [-7.81172635e-03  1.78989137e-02]]
grads:  [ 2.13386307e-03 -1.10734335e+01]
Stock Position:  0.0021338630686664776
Bond Position:  [-4.13141699]


portfolio before change:  [-3.90427185]
curr_Stock_Price:  107.41615696229049
curr_Factors:  [1.07416157e+02 3.98620293e-02]
mat_Sqrt:  [[ 2.14461487e+01  0.00000000e+00]
 [-7.98619101e-03  1.82986624e-02]]
grads:  [2.55547740e-03 1.24428153e+01]
Stock Position:  0.002555477398298619
Bond Position:  [-4.17877141]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.90699505]
Stock Price:  107.16833900551757
PL:  [-11.07533405]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.31932824e-01  3.75106982e-01]
 [-6.41446425e-03  2.30481769e-01]
 [-9.81661308e-02  1.38703387e-02]
 [-5.06003436e-02 -5.33394995e-01]
 [ 2.11825072e-01  8.80422672e-01]
 [ 2.27962042e-01 -5.43999229e-01]
 [-2.18086306e-01 -6.56794511e-02]
 [ 2.40627876e-01 -3.72123526e-01]
 [-4.31889359e-02  2.14319605e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.64618731]
curr_Stock_Price:  101.53763955099244
curr_Factors:  [1.01537640e+02 4.02552135e-02]
mat_Sqrt:  [[ 2.03722093e+01  0.00000000e+00]
 [-8.02548077e-03  1.83886866e-02]]
grads:  [1.55983495e-03 2.03987914e+01]
Stock Position:  0.0015598349465262343
Bond Position:  [12.48780535]


portfolio before change:  [12.65533919]
curr_Stock_Price:  103.40092209376517
curr_Factors:  [1.03400922e+02 4.31902142e-02]
mat_Sqrt:  [[ 2.14890438e+01  0.00000000e+00]
 [-8.31290218e-03  1.90472518e-02]]
grads:  [4.38251359e-03 1.21005262e+01]
Stock Position:  0.004382513593945456
Bond Position:  [12.20218324]


portfolio before change:  [12.67661324]
curr_Stock_Price:  106.86273231430243
curr_Factors:  [1.06862732e+02 4.26230192e-02]
mat_Sqrt:  [[ 2.20621777e+01  0.00000000e+00]
 [-8.25813724e-03  1.89217695e-02]]
grads:  [-0.00417514  0.73303603]
Stock Position:  -0.004175137185380741
Bond Position:  [13.1227798]


portfolio before change:  [12.66669166]
curr_Stock_Price:  110.81101201634188
curr_Factors:  [1.10811012e+02 4.46767276e-02]
mat_Sqrt:  [[ 2.34219796e+01  0.00000000e+00]
 [-8.45474802e-03  1.93722614e-02]]
grads:  [-1.20994471e-02 -2.75339561e+01]
Stock Position:  -0.012099447144311392
Bond Position:  [14.00744364]


portfolio before change:  [12.69434983]
curr_Stock_Price:  109.10409904070634
curr_Factors:  [1.09104099e+02 4.47618736e-02]
mat_Sqrt:  [[ 2.30831565e+01  0.00000000e+00]
 [-8.46280082e-03  1.93907127e-02]]
grads:  [2.58228561e-02 4.54043483e+01]
Stock Position:  0.025822856100069187
Bond Position:  [9.87697038]


portfolio before change:  [12.70670423]
curr_Stock_Price:  109.39123507312033
curr_Factors:  [1.09391235e+02 4.18649079e-02]
mat_Sqrt:  [[ 2.23824486e+01  0.00000000e+00]
 [-8.18436636e-03  1.87527392e-02]]
grads:  [-4.22593889e-04 -2.90090543e+01]
Stock Position:  -0.0004225938888822603
Bond Position:  [12.75293229]


portfolio before change:  [12.71290837]
curr_Stock_Price:  109.8027752428761
curr_Factors:  [1.09802775e+02 4.03144962e-02]
mat_Sqrt:  [[ 2.20467174e+01  0.00000000e+00]
 [-8.03138804e-03  1.84022218e-02]]
grads:  [-0.0111922  -3.56910441]
Stock Position:  -0.011192195370318715
Bond Position:  [13.94184249]


portfolio before change:  [12.7275178]
curr_Stock_Price:  109.12044576225371
curr_Factors:  [1.09120446e+02 4.13639324e-02]
mat_Sqrt:  [[ 2.21930525e+01  0.00000000e+00]
 [-8.13524995e-03  1.86401994e-02]]
grads:  [ 3.52451986e-03 -1.99634950e+01]
Stock Position:  0.003524519855571964
Bond Position:  [12.34292062]


portfolio before change:  [12.72620749]
curr_Stock_Price:  106.99723008962852
curr_Factors:  [1.06997230e+02 4.19148646e-02]
mat_Sqrt:  [[ 2.19056714e+01  0.00000000e+00]
 [-8.18924803e-03  1.87639245e-02]]
grads:  [2.29839147e-03 1.14218966e+01]
Stock Position:  0.0022983914672548796
Bond Position:  [12.48028597]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.73154299]
Stock Price:  106.60295408365758
PL:  [6.12858891]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 2.96578376e-02  6.89603912e-02]
 [-5.67861507e-02  2.34190267e-01]
 [-9.86760755e-02  1.02400165e-02]
 [-1.29248025e-01 -4.63536972e-01]
 [ 6.16763749e-02  2.23241984e-01]
 [ 3.05798945e-01 -6.07394671e-01]
 [-4.67746639e-01  2.13084768e-02]
 [ 1.79606435e-01 -2.75493665e-01]
 [-4.05280428e-02  1.89185412e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.47099019]
curr_Stock_Price:  101.9630888667364
curr_Factors:  [1.01963089e+02 4.01138670e-02]
mat_Sqrt:  [[ 2.04216227e+01  0.00000000e+00]
 [-8.01137861e-03  1.83563744e-02]]
grads:  [2.92604660e-03 3.75675444e+00]
Stock Position:  0.002926046602724257
Bond Position:  [15.17264145]


portfolio before change:  [15.48738171]
curr_Stock_Price:  104.9716872317379
curr_Factors:  [1.04971687e+02 3.82229745e-02]
mat_Sqrt:  [[ 2.05226963e+01  0.00000000e+00]
 [-7.82027871e-03  1.79185096e-02]]
grads:  [2.21329890e-03 1.30697403e+01]
Stock Position:  0.002213298901175619
Bond Position:  [15.25504799]


portfolio before change:  [15.49446241]
curr_Stock_Price:  104.72376013889861
curr_Factors:  [1.04723760e+02 4.00945761e-02]
mat_Sqrt:  [[ 2.09694983e+01  0.00000000e+00]
 [-8.00945203e-03  1.83519601e-02]]
grads:  [-0.00449257  0.55797945]
Stock Position:  -0.004492571276047845
Bond Position:  [15.96494136]


portfolio before change:  [15.50339849]
curr_Stock_Price:  104.51193963997872
curr_Factors:  [1.04511940e+02 3.84114164e-02]
mat_Sqrt:  [[ 2.04831181e+01  0.00000000e+00]
 [-7.83953228e-03  1.79626250e-02]]
grads:  [-1.61866051e-02 -2.58056365e+01]
Stock Position:  -0.01618660513526072
Bond Position:  [17.19509199]


portfolio before change:  [15.55820639]
curr_Stock_Price:  101.6572211279209
curr_Factors:  [1.01657221e+02 3.90326936e-02]
mat_Sqrt:  [[ 2.00841056e+01  0.00000000e+00]
 [-7.90267738e-03  1.81073086e-02]]
grads:  [7.92204382e-03 1.23288330e+01]
Stock Position:  0.007922043820236004
Bond Position:  [14.75287343]


portfolio before change:  [15.57118399]
curr_Stock_Price:  102.36402361204455
curr_Factors:  [1.02364024e+02 3.61326233e-02]
mat_Sqrt:  [[ 1.94579505e+01  0.00000000e+00]
 [-7.60343326e-03  1.74216542e-02]]
grads:  [ 2.09221302e-03 -3.48643512e+01]
Stock Position:  0.0020922130235805523
Bond Position:  [15.35701665]


portfolio before change:  [15.58699717]
curr_Stock_Price:  106.2511756526112
curr_Factors:  [1.06251176e+02 3.37551739e-02]
mat_Sqrt:  [[ 1.95210835e+01  0.00000000e+00]
 [-7.34903247e-03  1.68387488e-02]]
grads:  [-0.0234847  1.265443 ]
Stock Position:  -0.023484703486502667
Bond Position:  [18.08227452]


portfolio before change:  [15.56736202]
curr_Stock_Price:  107.47233415635033
curr_Factors:  [1.07472334e+02 3.51094998e-02]
mat_Sqrt:  [[ 2.01376599e+01  0.00000000e+00]
 [-7.49501166e-03  1.71732291e-02]]
grads:  [ 2.94826425e-03 -1.60420421e+01]
Stock Position:  0.002948264247592395
Bond Position:  [15.25050518]


portfolio before change:  [15.57129033]
curr_Stock_Price:  106.21774950366073
curr_Factors:  [1.06217750e+02 3.41676787e-02]
mat_Sqrt:  [[ 1.96338212e+01  0.00000000e+00]
 [-7.39380051e-03  1.69413252e-02]]
grads:  [2.14116445e-03 1.11670964e+01]
Stock Position:  0.0021411644523567433
Bond Position:  [15.34386066]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.58243259]
Stock Price:  107.83762169994087
PL:  [7.74481089]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.61217113e-01 -3.70562813e-03]
 [-7.70587663e-02  2.28966248e-01]
 [-9.88095556e-02  9.28976480e-03]
 [-9.99082940e-02 -4.89543169e-01]
 [ 1.83658005e-01  7.49009078e-01]
 [ 1.64865065e-01 -7.20961759e-01]
 [-5.89956722e-01  6.74825666e-02]
 [ 1.04708351e-01 -1.56978328e-01]
 [-5.10087111e-02  2.90001863e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [43.98545233]
curr_Stock_Price:  106.25771008680798
curr_Factors:  [1.06257710e+02 3.87155855e-02]
mat_Sqrt:  [[ 2.09075608e+01  0.00000000e+00]
 [-7.87051058e-03  1.80336052e-02]]
grads:  [ 0.01719951 -0.2054846 ]
Stock Position:  0.01719951208099948
Bond Position:  [42.15787156]


portfolio before change:  [44.01008249]
curr_Stock_Price:  106.46387631676711
curr_Factors:  [1.06463876e+02 3.95666200e-02]
mat_Sqrt:  [[ 2.11771128e+01  0.00000000e+00]
 [-7.95654397e-03  1.82307325e-02]]
grads:  [1.07995349e-03 1.25593554e+01]
Stock Position:  0.001079953490620441
Bond Position:  [43.89510646]


portfolio before change:  [44.02955009]
curr_Stock_Price:  104.1624410214365
curr_Factors:  [1.04162441e+02 4.15231278e-02]
mat_Sqrt:  [[ 2.12254144e+01  0.00000000e+00]
 [-8.15088980e-03  1.86760347e-02]]
grads:  [-0.00446423  0.49741634]
Stock Position:  -0.004464231786015087
Bond Position:  [44.49455537]


portfolio before change:  [44.03975274]
curr_Stock_Price:  106.86171695544893
curr_Factors:  [1.06861717e+02 3.95800125e-02]
mat_Sqrt:  [[ 2.12598459e+01  0.00000000e+00]
 [-7.95789043e-03  1.82338176e-02]]
grads:  [-1.47490462e-02 -2.68480896e+01]
Stock Position:  -0.014749046206553963
Bond Position:  [45.61586114]


portfolio before change:  [44.05103718]
curr_Stock_Price:  107.64340776215201
curr_Factors:  [1.07643408e+02 3.89424223e-02]
mat_Sqrt:  [[ 2.12421719e+01  0.00000000e+00]
 [-7.89353379e-03  1.80863580e-02]]
grads:  [2.40348477e-02 4.14129299e+01]
Stock Position:  0.02403484771198087
Bond Position:  [41.46384427]


portfolio before change:  [44.0442779]
curr_Stock_Price:  106.49938624943054
curr_Factors:  [1.06499386e+02 3.63967441e-02]
mat_Sqrt:  [[ 2.03178791e+01  0.00000000e+00]
 [-7.63117229e-03  1.74852123e-02]]
grads:  [-7.37224794e-03 -4.12326568e+01]
Stock Position:  -0.007372247940569702
Bond Position:  [44.82941778]


portfolio before change:  [44.08199121]
curr_Stock_Price:  104.42498523057569
curr_Factors:  [1.04424985e+02 3.79479942e-02]
mat_Sqrt:  [[ 2.03422429e+01  0.00000000e+00]
 [-7.79209796e-03  1.78539394e-02]]
grads:  [-0.02755374  3.77970179]
Stock Position:  -0.027553742152607117
Bond Position:  [46.95929033]


portfolio before change:  [44.07738572]
curr_Stock_Price:  105.44448404551511
curr_Factors:  [1.05444484e+02 3.49322815e-02]
mat_Sqrt:  [[ 1.97077635e+01  0.00000000e+00]
 [-7.47607185e-03  1.71298326e-02]]
grads:  [ 1.83670725e-03 -9.16403163e+00]
Stock Position:  0.0018367072486825328
Bond Position:  [43.88371507]


portfolio before change:  [44.10653607]
curr_Stock_Price:  109.36617705490272
curr_Factors:  [1.09366177e+02 3.44099486e-02]
mat_Sqrt:  [[ 2.02873370e+01  0.00000000e+00]
 [-7.41996750e-03  1.70012814e-02]]
grads:  [3.72441580e-03 1.70576474e+01]
Stock Position:  0.003724415803497245
Bond Position:  [43.69921095]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [44.13894873]
Stock Price:  112.2008749444005
PL:  [31.93807379]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-6.28894547e-01  2.93802979e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.66127609e-01  1.04291981e-01]
 [-1.24412917e-01 -4.86631725e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.48480498e-01 -1.40050328e+00]
 [-8.92481641e-01  3.28570513e-01]
 [ 9.56042200e-04  7.64725234e-02]
 [-2.16538712e-03 -1.85195399e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.19101553]
curr_Stock_Price:  98.70053006302844
curr_Factors:  [9.87005301e+01 3.94506100e-02]
mat_Sqrt:  [[ 1.96040746e+01  0.00000000e+00]
 [-7.94487105e-03  1.82039865e-02]]
grads:  [-0.025539   16.13948566]
Stock Position:  -0.02553899762599039
Bond Position:  [-3.67030293]


portfolio before change:  [-6.18172559]
curr_Stock_Price:  98.26489992446525
curr_Factors:  [9.82648999e+01 3.76026346e-02]
mat_Sqrt:  [[ 1.90549386e+01  0.00000000e+00]
 [-7.75655951e-03  1.77725105e-02]]
grads:  [ 0.00493099 -2.66012012]
Stock Position:  0.0049309878675876245
Bond Position:  [-6.66626862]


portfolio before change:  [-6.18451423]
curr_Stock_Price:  98.37549121596602
curr_Factors:  [9.83754912e+01 3.93238690e-02]
mat_Sqrt:  [[ 1.95081027e+01  0.00000000e+00]
 [-7.93209873e-03  1.81747214e-02]]
grads:  [0.01084905 5.73829874]
Stock Position:  0.010849048915838603
Bond Position:  [-7.25179475]


portfolio before change:  [-6.20095581]
curr_Stock_Price:  97.19430230631953
curr_Factors:  [9.71943023e+01 3.65619547e-02]
mat_Sqrt:  [[ 1.85846981e+01  0.00000000e+00]
 [-7.64847223e-03  1.75248515e-02]]
grads:  [-1.81222430e-02 -2.77680941e+01]
Stock Position:  -0.018122242960335405
Bond Position:  [-4.43957705]


portfolio before change:  [-6.17285167]
curr_Stock_Price:  95.52097283313506
curr_Factors:  [9.55209728e+01 3.90195446e-02]
mat_Sqrt:  [[ 1.88686068e+01  0.00000000e+00]
 [-7.90134617e-03  1.81042585e-02]]
grads:  [-3.73462653e-03 -4.70579876e+00]
Stock Position:  -0.0037346265347989872
Bond Position:  [-5.81611651]


portfolio before change:  [-6.16943681]
curr_Stock_Price:  93.82772670233204
curr_Factors:  [9.38277267e+01 3.91254503e-02]
mat_Sqrt:  [[ 1.85592691e+01  0.00000000e+00]
 [-7.91206171e-03  1.81288108e-02]]
grads:  [-8.76916240e-03 -7.72529039e+01]
Stock Position:  -0.008769162401405732
Bond Position:  [-5.34664624]


portfolio before change:  [-6.15583047]
curr_Stock_Price:  91.9711827330645
curr_Factors:  [9.19711827e+01 4.03230823e-02]
mat_Sqrt:  [[ 1.84683728e+01  0.00000000e+00]
 [-8.03224325e-03  1.84041814e-02]]
grads:  [-0.04056024 17.85303604]
Stock Position:  -0.040560244332660575
Bond Position:  [-2.42545683]


portfolio before change:  [-6.22232215]
curr_Stock_Price:  93.58060718309756
curr_Factors:  [9.35806072e+01 3.66824051e-02]
mat_Sqrt:  [[ 1.79231674e+01  0.00000000e+00]
 [-7.66106052e-03  1.75536949e-02]]
grads:  [1.91547548e-03 4.35649156e+00]
Stock Position:  0.001915475481239174
Bond Position:  [-6.40157351]


portfolio before change:  [-6.23027909]
curr_Stock_Price:  91.09801302081291
curr_Factors:  [9.10980130e+01 3.83897329e-02]
mat_Sqrt:  [[ 1.78491052e+01  0.00000000e+00]
 [-7.83731923e-03  1.79575543e-02]]
grads:  [-4.64960481e-03 -1.03129522e+01]
Stock Position:  -0.004649604808419906
Bond Position:  [-5.80670933]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.23189897]
Stock Price:  90.82181746589308
PL:  [-6.23189897]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.89871229e-01  3.15269426e-01]
 [ 2.49067300e-02  2.09982978e-01]
 [ 1.43345275e-01  8.96295719e-02]
 [-1.56812147e-01 -4.13680944e-01]
 [-3.54684195e-03  2.65364993e-02]
 [ 3.93523076e-01 -8.59029296e-01]
 [-8.33289462e-01  1.62398178e-01]
 [ 1.19109590e-02 -6.06141696e-03]
 [-3.17445245e-02  1.04282303e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.07425466]
curr_Stock_Price:  100.09599127879476
curr_Factors:  [1.00095991e+02 4.29695977e-02]
mat_Sqrt:  [[ 2.07490076e+01  0.00000000e+00]
 [-8.29164377e-03  1.89985426e-02]]
grads:  [-7.33897130e-03  1.65944006e+01]
Stock Position:  -0.007338971300575362
Bond Position:  [3.80885627]


portfolio before change:  [3.0589103]
curr_Stock_Price:  102.44635757502573
curr_Factors:  [1.02446358e+02 4.39367682e-02]
mat_Sqrt:  [[ 2.14738827e+01  0.00000000e+00]
 [-8.38443970e-03  1.92111648e-02]]
grads:  [5.42756130e-03 1.09302575e+01]
Stock Position:  0.005427561304850304
Bond Position:  [2.50287641]


portfolio before change:  [3.03918314]
curr_Stock_Price:  98.58110326571202
curr_Factors:  [9.85811033e+01 4.39134280e-02]
mat_Sqrt:  [[ 2.06581937e+01  0.00000000e+00]
 [-8.38221240e-03  1.92060614e-02]]
grads:  [0.00883247 4.66673359]
Stock Position:  0.008832467667557388
Bond Position:  [2.16846874]


portfolio before change:  [3.04977745]
curr_Stock_Price:  99.65779039804923
curr_Factors:  [9.96577904e+01 4.44151534e-02]
mat_Sqrt:  [[ 2.10027826e+01  0.00000000e+00]
 [-8.42996117e-03  1.93154676e-02]]
grads:  [-1.60625056e-02 -2.14170815e+01]
Stock Position:  -0.01606250558387983
Bond Position:  [4.65053127]


portfolio before change:  [3.05988908]
curr_Stock_Price:  99.17307269862704
curr_Factors:  [9.91730727e+01 4.63068050e-02]
mat_Sqrt:  [[ 2.13410694e+01  0.00000000e+00]
 [-8.60760640e-03  1.97225039e-02]]
grads:  [3.76487030e-04 1.34549342e+00]
Stock Position:  0.00037648703048326956
Bond Position:  [3.02255171]


portfolio before change:  [3.06116226]
curr_Stock_Price:  98.53966343823653
curr_Factors:  [9.85396634e+01 4.74394902e-02]
mat_Sqrt:  [[ 2.14625382e+01  0.00000000e+00]
 [-8.71224336e-03  1.99622573e-02]]
grads:  [ 8.67183291e-04 -4.30326732e+01]
Stock Position:  0.0008671832906163326
Bond Position:  [2.97571031]


portfolio before change:  [3.06456331]
curr_Stock_Price:  100.74545181996312
curr_Factors:  [1.00745452e+02 4.51847148e-02]
mat_Sqrt:  [[ 2.14151550e+01  0.00000000e+00]
 [-8.50267862e-03  1.94820842e-02]]
grads:  [-0.03560157  8.33577028]
Stock Position:  -0.03560156754605686
Bond Position:  [6.65125932]


portfolio before change:  [2.99125071]
curr_Stock_Price:  102.89813984538056
curr_Factors:  [1.02898140e+02 4.42296889e-02]
mat_Sqrt:  [[ 2.16403592e+01  0.00000000e+00]
 [-8.41234225e-03  1.92750976e-02]]
grads:  [ 0.00042816 -0.31446881]
Stock Position:  0.00042816016536667263
Bond Position:  [2.94719382]


portfolio before change:  [2.99300867]
curr_Stock_Price:  103.56142725788138
curr_Factors:  [1.03561427e+02 4.08235813e-02]
mat_Sqrt:  [[ 2.09244272e+01  0.00000000e+00]
 [-8.08193851e-03  1.85180475e-02]]
grads:  [6.57987129e-04 5.63138759e+00]
Stock Position:  0.0006579871288282649
Bond Position:  [2.92486658]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.99564561]
Stock Price:  105.34587898957359
PL:  [-2.35023338]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.02934219e-01  3.29157753e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.20030998e-01 -4.98947550e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.35251930e-01 -1.26431940e+00]
 [-9.81574814e-01  2.97659906e-01]
 [-2.38340256e-02  3.76830961e-02]
 [-3.25342688e-02 -1.49362343e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.06269477]
curr_Stock_Price:  101.14853447739856
curr_Factors:  [1.01148534e+02 4.00682052e-02]
mat_Sqrt:  [[ 2.02469467e+01  0.00000000e+00]
 [-8.00681761e-03  1.83459239e-02]]
grads:  [-2.92774999e-03  1.79417377e+01]
Stock Position:  -0.0029277499872923155
Bond Position:  [10.35883239]


portfolio before change:  [10.0689762]
curr_Stock_Price:  100.77257579223911
curr_Factors:  [1.00772576e+02 3.81405911e-02]
mat_Sqrt:  [[ 1.96804973e+01  0.00000000e+00]
 [-7.81184650e-03  1.78991889e-02]]
grads:  [ 0.00477425 -2.64129358]
Stock Position:  0.00477425287829676
Bond Position:  [9.58786244]


portfolio before change:  [10.0472351]
curr_Stock_Price:  95.21438052158484
curr_Factors:  [9.52143805e+01 3.97390306e-02]
mat_Sqrt:  [[ 1.89806544e+01  0.00000000e+00]
 [-7.97386036e-03  1.82704093e-02]]
grads:  [ 0.02121983 10.66779026]
Stock Position:  0.02121982592552689
Bond Position:  [8.02680252]


portfolio before change:  [10.0857589]
curr_Stock_Price:  96.84066146763202
curr_Factors:  [9.68406615e+01 3.85376234e-02]
mat_Sqrt:  [[ 1.90107921e+01  0.00000000e+00]
 [-7.85240075e-03  1.79921104e-02]]
grads:  [-1.77683055e-02 -2.77314633e+01]
Stock Position:  -0.01776830551930513
Bond Position:  [11.80645336]


portfolio before change:  [10.1648014]
curr_Stock_Price:  92.72446735507526
curr_Factors:  [9.27244674e+01 3.97711053e-02]
mat_Sqrt:  [[ 1.84917570e+01  0.00000000e+00]
 [-7.97707769e-03  1.82777812e-02]]
grads:  [-3.81073577e-03 -4.66112360e+00]
Stock Position:  -0.003810735766969823
Bond Position:  [10.51814984]


portfolio before change:  [10.16124873]
curr_Stock_Price:  95.03715931831181
curr_Factors:  [9.50371593e+01 3.81892586e-02]
mat_Sqrt:  [[ 1.85722303e+01  0.00000000e+00]
 [-7.81682888e-03  1.79106050e-02]]
grads:  [-6.27508343e-03 -7.05905467e+01]
Stock Position:  -0.006275083428472897
Bond Position:  [10.75761483]


portfolio before change:  [10.1724615]
curr_Stock_Price:  94.10767057757468
curr_Factors:  [9.41076706e+01 3.81717301e-02]
mat_Sqrt:  [[ 1.83863679e+01  0.00000000e+00]
 [-7.81503475e-03  1.79064942e-02]]
grads:  [-0.04632048 16.62301416]
Stock Position:  -0.04632047970938864
Bond Position:  [14.53157395]


portfolio before change:  [10.1255076]
curr_Stock_Price:  95.27824355193584
curr_Factors:  [9.52782436e+01 3.90583705e-02]
mat_Sqrt:  [[ 1.88300209e+01  0.00000000e+00]
 [-7.90527627e-03  1.81132634e-02]]
grads:  [-3.92340197e-04  2.08041451e+00]
Stock Position:  -0.0003923401966938687
Bond Position:  [10.16288909]


portfolio before change:  [10.13043341]
curr_Stock_Price:  95.67816637526113
curr_Factors:  [9.56781664e+01 4.00716208e-02]
mat_Sqrt:  [[ 1.91527570e+01  0.00000000e+00]
 [-8.00715888e-03  1.83467058e-02]]
grads:  [-5.10220745e-03 -8.14109868e+00]
Stock Position:  -0.00510220744877824
Bond Position:  [10.61860326]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.13426009]
Stock Price:  95.96901045549006
PL:  [10.13426009]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-8.15362042e-01  2.87554928e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 5.18291446e-02  5.13576036e-02]
 [-1.58745618e-01 -4.19410685e-01]
 [ 1.23246492e-01  4.67158860e-01]
 [ 1.99101893e-01 -6.43786843e-01]
 [-6.36876032e-01  8.52102532e-02]
 [ 3.44470813e-02 -4.28713751e-02]
 [-3.94019569e-02  1.78142785e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.82930469]
curr_Stock_Price:  98.00194788660063
curr_Factors:  [9.80019479e+01 4.12048989e-02]
mat_Sqrt:  [[ 1.98934055e+01  0.00000000e+00]
 [-8.11959594e-03  1.86043315e-02]]
grads:  [-0.03467796 15.45634296]
Stock Position:  -0.034677963207278936
Bond Position:  [-7.43079674]


portfolio before change:  [-10.88436945]
curr_Stock_Price:  99.48267032917589
curr_Factors:  [9.94826703e+01 3.96023394e-02]
mat_Sqrt:  [[ 1.97973862e+01  0.00000000e+00]
 [-7.96013461e-03  1.82389597e-02]]
grads:  [ 0.00474606 -2.59208933]
Stock Position:  0.004746064460851208
Bond Position:  [-11.35652062]


portfolio before change:  [-10.88677729]
curr_Stock_Price:  100.1720497680628
curr_Factors:  [1.00172050e+02 3.99418964e-02]
mat_Sqrt:  [[ 2.00198538e+01  0.00000000e+00]
 [-7.99418753e-03  1.83169847e-02]]
grads:  [0.00370849 2.80382412]
Stock Position:  0.0037084906469976296
Bond Position:  [-11.2582644]


portfolio before change:  [-10.88841293]
curr_Stock_Price:  101.24928169846956
curr_Factors:  [1.01249282e+02 3.78539249e-02]
mat_Sqrt:  [[ 1.96991465e+01  0.00000000e+00]
 [-7.78243406e-03  1.78317966e-02]]
grads:  [-1.73505714e-02 -2.35203830e+01]
Stock Position:  -0.017350571441029555
Bond Position:  [-9.13168003]


portfolio before change:  [-10.94972478]
curr_Stock_Price:  104.51977198496442
curr_Factors:  [1.04519772e+02 3.74282017e-02]
mat_Sqrt:  [[ 2.02207814e+01  0.00000000e+00]
 [-7.73854785e-03  1.77312406e-02]]
grads:  [1.61779769e-02 2.63466539e+01]
Stock Position:  0.016177976890788776
Bond Position:  [-12.64064324]


portfolio before change:  [-10.94853081]
curr_Stock_Price:  104.98434634748129
curr_Factors:  [1.04984346e+02 3.77590079e-02]
mat_Sqrt:  [[ 2.04002193e+01  0.00000000e+00]
 [-7.77267088e-03  1.78094263e-02]]
grads:  [-4.01317845e-03 -3.61486570e+01]
Stock Position:  -0.004013178446048811
Bond Position:  [-10.5272099]


portfolio before change:  [-10.94875405]
curr_Stock_Price:  103.72806395282717
curr_Factors:  [1.03728064e+02 3.78330025e-02]
mat_Sqrt:  [[ 2.01758424e+01  0.00000000e+00]
 [-7.78028303e-03  1.78268680e-02]]
grads:  [-0.02972303  4.77987796]
Stock Position:  -0.029723032965896987
Bond Position:  [-7.86564138]


portfolio before change:  [-10.9464991]
curr_Stock_Price:  103.51984980955507
curr_Factors:  [1.03519850e+02 3.88896848e-02]
mat_Sqrt:  [[ 2.04145986e+01  0.00000000e+00]
 [-7.88818710e-03  1.80741072e-02]]
grads:  [ 7.70844410e-04 -2.37197747e+00]
Stock Position:  0.0007708444097196831
Bond Position:  [-11.02629679]


portfolio before change:  [-10.9502017]
curr_Stock_Price:  105.87041440107353
curr_Factors:  [1.05870414e+02 3.76458349e-02]
mat_Sqrt:  [[ 2.05415438e+01  0.00000000e+00]
 [-7.76101384e-03  1.77827167e-02]]
grads:  [1.86675008e-03 1.00177486e+01]
Stock Position:  0.001866750082309358
Bond Position:  [-11.14783531]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.95128846]
Stock Price:  108.27488957338187
PL:  [-19.22617803]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.42273923e-01  2.79859329e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.28475683e-01  1.44418379e-01]
 [-1.27908575e-01 -4.74979022e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.35491909e-01 -1.26597656e+00]
 [-9.66695348e-01  3.03267512e-01]
 [-9.73415238e-03  5.65189490e-02]
 [-2.53664995e-02 -2.07646737e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.96114314]
curr_Stock_Price:  99.3375997601168
curr_Factors:  [9.93375998e+01 4.08003563e-02]
mat_Sqrt:  [[ 2.00652992e+01  0.00000000e+00]
 [-8.07963923e-03  1.85127792e-02]]
grads:  [-0.01595457 15.11708894]
Stock Position:  -0.015954573856409734
Bond Position:  [-0.37625406]


portfolio before change:  [-1.96399351]
curr_Stock_Price:  99.50446109531134
curr_Factors:  [9.95044611e+01 4.32463025e-02]
mat_Sqrt:  [[ 2.06926944e+01  0.00000000e+00]
 [-8.31829815e-03  1.90596155e-02]]
grads:  [ 0.00454072 -2.48048094]
Stock Position:  0.004540717096260921
Bond Position:  [-2.41581512]


portfolio before change:  [-1.97288943]
curr_Stock_Price:  97.81140171304618
curr_Factors:  [9.78114017e+01 4.16439713e-02]
mat_Sqrt:  [[ 1.99602305e+01  0.00000000e+00]
 [-8.16274182e-03  1.87031911e-02]]
grads:  [0.01460429 7.72159028]
Stock Position:  0.014604291803799034
Bond Position:  [-3.40135568]


portfolio before change:  [-1.97888326]
curr_Stock_Price:  97.5174657220259
curr_Factors:  [9.75174657e+01 4.20858212e-02]
mat_Sqrt:  [[ 2.00055414e+01  0.00000000e+00]
 [-8.20593163e-03  1.88021514e-02]]
grads:  [-1.67556783e-02 -2.52619507e+01]
Stock Position:  -0.01675567828465224
Bond Position:  [-0.34491197]


portfolio before change:  [-1.94199098]
curr_Stock_Price:  95.30539351927963
curr_Factors:  [9.53053935e+01 4.03468879e-02]
mat_Sqrt:  [[ 1.91435510e+01  0.00000000e+00]
 [-8.03461391e-03  1.84096132e-02]]
grads:  [-3.68098895e-03 -4.62774509e+00]
Stock Position:  -0.0036809889526502166
Bond Position:  [-1.59117288]


portfolio before change:  [-1.94175716]
curr_Stock_Price:  95.02568391286029
curr_Factors:  [9.50256839e+01 3.77976980e-02]
mat_Sqrt:  [[ 1.84745419e+01  0.00000000e+00]
 [-7.77665203e-03  1.78185483e-02]]
grads:  [-6.33442272e-03 -7.10482435e+01]
Stock Position:  -0.0063344227249614166
Bond Position:  [-1.33982431]


portfolio before change:  [-1.93392282]
curr_Stock_Price:  93.68311204774378
curr_Factors:  [9.36831120e+01 3.90985039e-02]
mat_Sqrt:  [[ 1.85242818e+01  0.00000000e+00]
 [-7.90933665e-03  1.81225669e-02]]
grads:  [-0.04504026 16.73424702]
Stock Position:  -0.045040264672011825
Bond Position:  [2.28558934]


portfolio before change:  [-1.96095525]
curr_Stock_Price:  94.30867459444991
curr_Factors:  [9.43086746e+01 3.88056890e-02]
mat_Sqrt:  [[ 1.85780163e+01  0.00000000e+00]
 [-7.87966385e-03  1.80545780e-02]]
grads:  [8.03785452e-04 3.13044974e+00]
Stock Position:  0.0008037854516160208
Bond Position:  [-2.03675919]


portfolio before change:  [-1.96196716]
curr_Stock_Price:  94.3170319189701
curr_Factors:  [9.43170319e+01 3.73197384e-02]
mat_Sqrt:  [[ 1.82204635e+01  0.00000000e+00]
 [-7.72732693e-03  1.77055303e-02]]
grads:  [-6.36597225e-03 -1.17277898e+01]
Stock Position:  -0.006365972252262777
Bond Position:  [-1.36154755]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.94455265]
Stock Price:  91.47450362011297
PL:  [-1.94455265]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.05053466e+00  8.73707779e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 4.61393942e-02  4.87491475e-02]
 [-1.57756527e-01 -4.13952082e-01]
 [-3.47297137e-02 -9.24666055e-02]
 [ 3.77194407e-01 -7.54024719e-01]
 [-8.08763166e-01  1.50605210e-01]
 [-2.42406414e-02  2.27073592e-02]
 [-2.66595056e-02  1.88621788e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.27524585]
curr_Stock_Price:  96.27805137439108
curr_Factors:  [9.62780514e+01 4.12265837e-02]
mat_Sqrt:  [[ 1.95486137e+01  0.00000000e+00]
 [-8.12173220e-03  1.86092263e-02]]
grads:  [-0.05178899  4.69502474]
Stock Position:  -0.051788988002206125
Bond Position:  [-17.28910301]


portfolio before change:  [-22.38197636]
curr_Stock_Price:  98.17196351025838
curr_Factors:  [9.81719635e+01 4.22322674e-02]
mat_Sqrt:  [[ 2.01748204e+01  0.00000000e+00]
 [-8.22019634e-03  1.88348360e-02]]
grads:  [ 0.00465727 -2.5100836 ]
Stock Position:  0.004657274228814861
Bond Position:  [-22.83919011]


portfolio before change:  [-22.38366428]
curr_Stock_Price:  100.26214029093744
curr_Factors:  [1.00262140e+02 4.34497777e-02]
mat_Sqrt:  [[ 2.08992524e+01  0.00000000e+00]
 [-8.33784410e-03  1.91044009e-02]]
grads:  [0.00322573 2.55172344]
Stock Position:  0.0032257262205608404
Bond Position:  [-22.7070825]


portfolio before change:  [-22.39682298]
curr_Stock_Price:  99.70340877271015
curr_Factors:  [9.97034088e+01 4.53788817e-02]
mat_Sqrt:  [[ 2.12391387e+01  0.00000000e+00]
 [-8.52092781e-03  1.95238983e-02]]
grads:  [-1.59337924e-02 -2.12023273e+01]
Stock Position:  -0.01593379241677364
Bond Position:  [-20.80816956]


portfolio before change:  [-22.37623045]
curr_Stock_Price:  97.75790724198048
curr_Factors:  [9.77579072e+01 4.74162706e-02]
mat_Sqrt:  [[ 2.12870555e+01  0.00000000e+00]
 [-8.71011096e-03  1.99573714e-02]]
grads:  [-3.52728206e-03 -4.63320563e+00]
Stock Position:  -0.003527282057219816
Bond Position:  [-22.03141073]


portfolio before change:  [-22.39384816]
curr_Stock_Price:  99.62882437699105
curr_Factors:  [9.96288244e+01 4.43255507e-02]
mat_Sqrt:  [[ 2.09754881e+01  0.00000000e+00]
 [-8.42145363e-03  1.92959744e-02]]
grads:  [ 2.29367915e-03 -3.90767890e+01]
Stock Position:  0.002293679150454509
Bond Position:  [-22.62236472]


portfolio before change:  [-22.40167347]
curr_Stock_Price:  101.14982860075989
curr_Factors:  [1.01149829e+02 4.29586538e-02]
mat_Sqrt:  [[ 2.09647884e+01  0.00000000e+00]
 [-8.29058780e-03  1.89961231e-02]]
grads:  [-0.03544198  7.92820774]
Stock Position:  -0.03544198256261604
Bond Position:  [-18.81672301]


portfolio before change:  [-22.42488414]
curr_Stock_Price:  101.53919605694317
curr_Factors:  [1.01539196e+02 4.29682736e-02]
mat_Sqrt:  [[ 2.10478467e+01  0.00000000e+00]
 [-8.29151601e-03  1.89982499e-02]]
grads:  [-6.80845769e-04  1.19523426e+00]
Stock Position:  -0.0006808457688782002
Bond Position:  [-22.35575161]


portfolio before change:  [-22.43572286]
curr_Stock_Price:  101.03695018111644
curr_Factors:  [1.01036950e+02 4.32074552e-02]
mat_Sqrt:  [[ 2.10019477e+01  0.00000000e+00]
 [-8.31456122e-03  1.90510531e-02]]
grads:  [-8.77412710e-04  9.90085889e-01]
Stock Position:  -0.0008774127097512207
Bond Position:  [-22.34707176]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.44530146]
Stock Price:  99.21598919872322
PL:  [-22.44530146]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.42844120e-01  2.79897701e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.53129111e-01 -4.31047448e-01]
 [-1.17483079e-02  1.46309395e-03]
 [ 3.55899429e-01 -6.87039377e-01]
 [-8.41279189e-01  1.66320671e-01]
 [-3.62246563e-02  2.66998403e-02]
 [-3.80333156e-02 -1.76455444e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.9735295]
curr_Stock_Price:  99.33573422402495
curr_Factors:  [9.93357342e+01 4.08384198e-02]
mat_Sqrt:  [[ 2.00742797e+01  0.00000000e+00]
 [-8.08340719e-03  1.85214127e-02]]
grads:  [-0.01597501 15.11211407]
Stock Position:  -0.015975006486895326
Bond Position:  [-0.38664051]


portfolio before change:  [-1.94586583]
curr_Stock_Price:  97.59194517934424
curr_Factors:  [9.75919452e+01 4.30759865e-02]
mat_Sqrt:  [[ 2.02549693e+01  0.00000000e+00]
 [-8.30190209e-03  1.90220474e-02]]
grads:  [ 0.00463885 -2.48537983]
Stock Position:  0.004638845381920425
Bond Position:  [-2.39857978]


portfolio before change:  [-1.95325918]
curr_Stock_Price:  96.25675176813198
curr_Factors:  [9.62567518e+01 4.34836561e-02]
mat_Sqrt:  [[ 2.00721655e+01  0.00000000e+00]
 [-8.34109404e-03  1.91118474e-02]]
grads:  [ 0.02006591 10.19811903]
Stock Position:  0.020065905810677378
Bond Position:  [-3.88473809]


portfolio before change:  [-1.83950238]
curr_Stock_Price:  102.02273374427365
curr_Factors:  [1.02022734e+02 4.21987726e-02]
mat_Sqrt:  [[ 2.09578567e+01  0.00000000e+00]
 [-8.21693593e-03  1.88273654e-02]]
grads:  [-1.62828502e-02 -2.28947300e+01]
Stock Position:  -0.016282850170547678
Bond Position:  [-0.17828149]


portfolio before change:  [-1.78861754]
curr_Stock_Price:  98.89220080944871
curr_Factors:  [9.88922008e+01 4.56499938e-02]
mat_Sqrt:  [[ 2.11291684e+01  0.00000000e+00]
 [-8.54634367e-03  1.95821334e-02]]
grads:  [-0.0005258   0.07471576]
Stock Position:  -0.0005258021111623265
Bond Position:  [-1.73661982]


portfolio before change:  [-1.79034717]
curr_Stock_Price:  100.52987907107688
curr_Factors:  [1.00529879e+02 4.40106154e-02]
mat_Sqrt:  [[ 2.10898689e+01  0.00000000e+00]
 [-8.39148286e-03  1.92273027e-02]]
grads:  [ 2.65771507e-03 -3.57324887e+01]
Stock Position:  0.0026577150738490685
Bond Position:  [-2.05752694]


portfolio before change:  [-1.79109867]
curr_Stock_Price:  100.63429970758486
curr_Factors:  [1.00634300e+02 4.30959488e-02]
mat_Sqrt:  [[ 2.08912416e+01  0.00000000e+00]
 [-8.30382551e-03  1.90264545e-02]]
grads:  [-0.03679489  8.74154832]
Stock Position:  -0.03679488803125125
Bond Position:  [1.91172912]


portfolio before change:  [-1.63024522]
curr_Stock_Price:  96.2886595066908
curr_Factors:  [9.62886595e+01 4.61842268e-02]
mat_Sqrt:  [[ 2.06929296e+01  0.00000000e+00]
 [-8.59620631e-03  1.96963830e-02]]
grads:  [-1.18745345e-03  1.35557073e+00]
Stock Position:  -0.001187453454668741
Bond Position:  [-1.51590692]


portfolio before change:  [-1.63294044]
curr_Stock_Price:  97.91995101223
curr_Factors:  [9.79199510e+01 4.46808274e-02]
mat_Sqrt:  [[ 2.06981624e+01  0.00000000e+00]
 [-8.45513595e-03  1.93731502e-02]]
grads:  [-0.00187473 -0.09108247]
Stock Position:  -0.0018747282689619345
Bond Position:  [-1.44936714]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.63460869]
Stock Price:  98.42316278069887
PL:  [-1.63460869]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.13105071e-01  2.85078060e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.73039564e-01  1.73099105e-01]
 [-1.33004613e-01 -4.60786990e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.48123694e-01 -1.39554462e+00]
 [-1.00451574e+00  2.89411553e-01]
 [-2.82244609e-02  3.37457176e-02]
 [-3.75596353e-02 -5.66101631e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.55723588]
curr_Stock_Price:  99.09720898049811
curr_Factors:  [9.90972090e+01 4.10210831e-02]
mat_Sqrt:  [[ 2.00708139e+01  0.00000000e+00]
 [-8.10146487e-03  1.85627880e-02]]
grads:  [-0.01936577 15.35750235]
Stock Position:  -0.019365771941844356
Bond Position:  [-1.63814193]


portfolio before change:  [-3.57476021]
curr_Stock_Price:  99.95981610648089
curr_Factors:  [9.99598161e+01 3.84487062e-02]
mat_Sqrt:  [[ 1.96004622e+01  0.00000000e+00]
 [-7.84333666e-03  1.79713420e-02]]
grads:  [ 0.00479375 -2.63068907]
Stock Position:  0.004793747710969417
Bond Position:  [-4.05394235]


portfolio before change:  [-3.58901771]
curr_Stock_Price:  97.40857143890345
curr_Factors:  [9.74085714e+01 3.94799945e-02]
mat_Sqrt:  [[ 1.93546676e+01  0.00000000e+00]
 [-7.94782934e-03  1.82107648e-02]]
grads:  [0.01801045 9.50531772]
Stock Position:  0.018010446642289926
Bond Position:  [-5.34338959]


portfolio before change:  [-3.58237457]
curr_Stock_Price:  97.92579962506636
curr_Factors:  [9.79257996e+01 3.92797193e-02]
mat_Sqrt:  [[ 1.94080237e+01  0.00000000e+00]
 [-7.92764472e-03  1.81645160e-02]]
grads:  [-1.72149698e-02 -2.53674246e+01]
Stock Position:  -0.017214969842169706
Bond Position:  [-1.89658488]


portfolio before change:  [-3.54900481]
curr_Stock_Price:  95.93228570032747
curr_Factors:  [9.59322857e+01 3.83571274e-02]
mat_Sqrt:  [[ 1.87883149e+01  0.00000000e+00]
 [-7.83399029e-03  1.79499267e-02]]
grads:  [-3.75058648e-03 -4.74625876e+00]
Stock Position:  -0.0037505864817551325
Bond Position:  [-3.18920248]


portfolio before change:  [-3.54289086]
curr_Stock_Price:  93.87688720375492
curr_Factors:  [9.38768872e+01 3.84545093e-02]
mat_Sqrt:  [[ 1.84090899e+01  0.00000000e+00]
 [-7.84392854e-03  1.79726981e-02]]
grads:  [-8.74252417e-03 -7.76480311e+01]
Stock Position:  -0.008742524173519497
Bond Position:  [-2.72216991]


portfolio before change:  [-3.55175016]
curr_Stock_Price:  94.73451941563506
curr_Factors:  [9.47345194e+01 4.03283258e-02]
mat_Sqrt:  [[ 1.90245044e+01  0.00000000e+00]
 [-8.03276548e-03  1.84053779e-02]]
grads:  [-0.04616184 15.72429286]
Stock Position:  -0.04616184267572069
Bond Position:  [0.82136982]


portfolio before change:  [-3.59198365]
curr_Stock_Price:  95.6149929753123
curr_Factors:  [9.56149930e+01 4.03660193e-02]
mat_Sqrt:  [[ 1.92102917e+01  0.00000000e+00]
 [-8.03651858e-03  1.84139774e-02]]
grads:  [-7.02572481e-04  1.83261427e+00]
Stock Position:  -0.0007025724807171975
Bond Position:  [-3.52480719]


portfolio before change:  [-3.59472492]
curr_Stock_Price:  97.00762106979623
curr_Factors:  [9.70076211e+01 3.83959258e-02]
mat_Sqrt:  [[ 1.90085254e+01  0.00000000e+00]
 [-7.83795135e-03  1.79590027e-02]]
grads:  [-0.00327571 -3.15218858]
Stock Position:  -0.0032757057582598163
Bond Position:  [-3.2769565]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.58875692]
Stock Price:  94.68540898201238
PL:  [-3.58875692]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.19204812e-01  3.35160387e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.12142279e-01  1.92764277e-01]
 [-1.63204272e-01 -4.10354887e-01]
 [-3.36559691e-02 -8.70619736e-02]
 [ 3.93952428e-01 -8.58778755e-01]
 [-1.00996388e+00  2.42674424e-01]
 [-7.25420227e-02 -9.34668195e-03]
 [-3.68382474e-02 -9.98142432e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.9610288]
curr_Stock_Price:  100.68138624832343
curr_Factors:  [1.00681386e+02 3.93440133e-02]
mat_Sqrt:  [[ 1.99704806e+01  0.00000000e+00]
 [-7.93413015e-03  1.81793760e-02]]
grads:  [-3.65183135e-03  1.84362977e+01]
Stock Position:  -0.0036518313472393665
Bond Position:  [7.32870024]


portfolio before change:  [6.96835435]
curr_Stock_Price:  99.67907355362179
curr_Factors:  [9.96790736e+01 3.99259346e-02]
mat_Sqrt:  [[ 1.99173492e+01  0.00000000e+00]
 [-7.99259003e-03  1.83133244e-02]]
grads:  [ 0.00471748 -2.58156367]
Stock Position:  0.004717478714486611
Bond Position:  [6.49812044]


portfolio before change:  [6.959383]
curr_Stock_Price:  97.08844762707636
curr_Factors:  [9.70884476e+01 4.00335765e-02]
mat_Sqrt:  [[ 1.94258375e+01  0.00000000e+00]
 [-8.00335695e-03  1.83379945e-02]]
grads:  [ 0.0203992  10.51174252]
Stock Position:  0.020399198007343782
Bond Position:  [4.97885653]


portfolio before change:  [7.03415459]
curr_Stock_Price:  100.63180002425644
curr_Factors:  [1.00631800e+02 4.00212915e-02]
mat_Sqrt:  [[ 2.01317158e+01  0.00000000e+00]
 [-8.00212887e-03  1.83351806e-02]]
grads:  [-1.70029138e-02 -2.23807387e+01]
Stock Position:  -0.01700291376037403
Bond Position:  [8.74518841]


portfolio before change:  [7.0986236]
curr_Stock_Price:  97.09738704371281
curr_Factors:  [9.70973870e+01 4.20615923e-02]
mat_Sqrt:  [[ 1.99136284e+01  0.00000000e+00]
 [-8.20356921e-03  1.87967384e-02]]
grads:  [-3.59818554e-03 -4.63175960e+00]
Stock Position:  -0.0035981855358402253
Bond Position:  [7.44799801]


portfolio before change:  [7.09708397]
curr_Stock_Price:  98.5605031190575
curr_Factors:  [9.85605031e+01 4.51238473e-02]
mat_Sqrt:  [[ 2.09365911e+01  0.00000000e+00]
 [-8.49694979e-03  1.94689578e-02]]
grads:  [ 9.14697693e-04 -4.41101555e+01]
Stock Position:  0.0009146976925173687
Bond Position:  [7.0069309]


portfolio before change:  [7.10002726]
curr_Stock_Price:  97.9471311827447
curr_Factors:  [9.79471312e+01 4.66896648e-02]
mat_Sqrt:  [[ 2.11642118e+01  0.00000000e+00]
 [-8.64311655e-03  1.98038679e-02]]
grads:  [-0.04271608 12.25389025]
Stock Position:  -0.04271607581776878
Bond Position:  [11.28394434]


portfolio before change:  [7.06886015]
curr_Stock_Price:  98.80887907821547
curr_Factors:  [9.88088791e+01 4.38288990e-02]
mat_Sqrt:  [[ 2.06859873e+01  0.00000000e+00]
 [-8.37414105e-03  1.91875676e-02]]
grads:  [-0.00370402 -0.48712177]
Stock Position:  -0.003704017029330436
Bond Position:  [7.43484992]


portfolio before change:  [7.08144334]
curr_Stock_Price:  96.41557682147975
curr_Factors:  [9.64155768e+01 4.54857052e-02]
mat_Sqrt:  [[ 2.05629145e+01  0.00000000e+00]
 [-8.53095119e-03  1.95468648e-02]]
grads:  [-3.90998827e-03 -5.10640679e+00]
Stock Position:  -0.003909988273606056
Bond Position:  [7.45842711]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.08917889]
Stock Price:  95.39117264997526
PL:  [7.08917889]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 1.10932875e-01 -2.03774239e-02]
 [ 9.96591531e-02 -4.43999619e-03]
 [ 6.23340332e-03  3.74640171e-02]
 [-1.47711968e-01 -4.42115790e-01]
 [ 1.16125047e-01  4.33933719e-01]
 [ 2.20090407e-01 -6.34509663e-01]
 [-5.98623855e-01  7.07564857e-02]
 [ 5.53243482e-03  4.21081003e-03]
 [-2.96721366e-02  8.44370009e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.71788023]
curr_Stock_Price:  102.15088551514641
curr_Factors:  [1.02150886e+02 3.76270783e-02]
mat_Sqrt:  [[ 1.98149228e+01  0.00000000e+00]
 [-7.75908018e-03  1.77782861e-02]]
grads:  [ 0.00514963 -1.14619732]
Stock Position:  0.005149625838980773
Bond Position:  [16.19184139]


portfolio before change:  [16.72537108]
curr_Stock_Price:  102.03299316754608
curr_Factors:  [1.02032993e+02 3.92436762e-02]
mat_Sqrt:  [[ 2.02127530e+01  0.00000000e+00]
 [-7.92400668e-03  1.81561802e-02]]
grads:  [ 0.00483464 -0.24454462]
Stock Position:  0.004834639793387134
Bond Position:  [16.23207831]


portfolio before change:  [16.72666885]
curr_Stock_Price:  100.62227869205469
curr_Factors:  [1.00622279e+02 4.04698197e-02]
mat_Sqrt:  [[ 2.02422965e+01  0.00000000e+00]
 [-8.04684481e-03  1.84376377e-02]]
grads:  [1.11568570e-03 2.03193151e+00]
Stock Position:  0.0011156857035235542
Bond Position:  [16.61440601]


portfolio before change:  [16.73737621]
curr_Stock_Price:  102.77169977429757
curr_Factors:  [1.02771700e+02 4.15956753e-02]
mat_Sqrt:  [[ 2.09603065e+01  0.00000000e+00]
 [-8.15800714e-03  1.86923426e-02]]
grads:  [-1.62529645e-02 -2.36522409e+01]
Stock Position:  -0.01625296454318405
Bond Position:  [18.407721]


portfolio before change:  [16.72411033]
curr_Stock_Price:  104.15434215819222
curr_Factors:  [1.04154342e+02 4.05801924e-02]
mat_Sqrt:  [[ 2.09813984e+01  0.00000000e+00]
 [-8.05781036e-03  1.84627630e-02]]
grads:  [1.45609574e-02 2.35031842e+01]
Stock Position:  0.014560957352494196
Bond Position:  [15.2075234]


portfolio before change:  [16.73674542]
curr_Stock_Price:  104.49974725884856
curr_Factors:  [1.04499747e+02 3.94568336e-02]
mat_Sqrt:  [[ 2.07575625e+01  0.00000000e+00]
 [-7.94549770e-03  1.82054223e-02]]
grads:  [-2.73790880e-03 -3.48527846e+01]
Stock Position:  -0.002737908804990132
Bond Position:  [17.0228562]


portfolio before change:  [16.74584122]
curr_Stock_Price:  104.28708708468834
curr_Factors:  [1.04287087e+02 4.16918526e-02]
mat_Sqrt:  [[ 2.12939453e+01  0.00000000e+00]
 [-8.16743314e-03  1.87139403e-02]]
grads:  [-0.02666219  3.7809507 ]
Stock Position:  -0.02666218895130911
Bond Position:  [19.52636325]


portfolio before change:  [16.79721068]
curr_Stock_Price:  102.72668119439726
curr_Factors:  [1.02726681e+02 4.09366934e-02]
mat_Sqrt:  [[ 2.07845027e+01  0.00000000e+00]
 [-8.09312729e-03  1.85436842e-02]]
grads:  [0.0003546  0.22707516]
Stock Position:  0.00035459991976035933
Bond Position:  [16.76078381]


portfolio before change:  [16.80566978]
curr_Stock_Price:  102.94272827537263
curr_Factors:  [1.02942728e+02 3.92845442e-02]
mat_Sqrt:  [[ 2.04035874e+01  0.00000000e+00]
 [-7.92813160e-03  1.81656316e-02]]
grads:  [3.51859293e-04 4.64817315e+00]
Stock Position:  0.00035185929288428247
Bond Position:  [16.76944843]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.81316947]
Stock Price:  100.42146460447843
PL:  [16.39170487]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.76419163e-01  3.26196286e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.07219836e-01 -5.36009523e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.81764989e-01 -1.74787857e+00]
 [-1.02066641e+00  2.83677881e-01]
 [-6.94067004e-02 -7.26600133e-03]
 [-3.70759084e-02 -3.06682172e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.70865727]
curr_Stock_Price:  100.19153994790311
curr_Factors:  [1.00191540e+02 3.87635412e-02]
mat_Sqrt:  [[ 1.97261701e+01  0.00000000e+00]
 [-7.87538354e-03  1.80447706e-02]]
grads:  [-6.79581652e-03  1.80770537e+01]
Stock Position:  -0.00679581651744526
Bond Position:  [4.38954059]


portfolio before change:  [3.71011645]
curr_Stock_Price:  100.29986254423356
curr_Factors:  [1.00299863e+02 3.90259687e-02]
mat_Sqrt:  [[ 1.98142293e+01  0.00000000e+00]
 [-7.90199658e-03  1.81057487e-02]]
grads:  [ 0.00474203 -2.61116033]
Stock Position:  0.004742030069062067
Bond Position:  [3.23449149]


portfolio before change:  [3.69457303]
curr_Stock_Price:  96.68093230503759
curr_Factors:  [9.66809323e+01 4.03267216e-02]
mat_Sqrt:  [[ 1.94149952e+01  0.00000000e+00]
 [-8.03260571e-03  1.84050119e-02]]
grads:  [ 0.02074511 10.58977285]
Stock Position:  0.02074510844724601
Bond Position:  [1.6889166]


portfolio before change:  [3.67679106]
curr_Stock_Price:  95.78305160480359
curr_Factors:  [9.57830516e+01 4.02160662e-02]
mat_Sqrt:  [[ 1.92082793e+01  0.00000000e+00]
 [-8.02157752e-03  1.83797431e-02]]
grads:  [-1.77607564e-02 -2.91630585e+01]
Stock Position:  -0.017760756412250295
Bond Position:  [5.37797051]


portfolio before change:  [3.74644993]
curr_Stock_Price:  92.01242338897471
curr_Factors:  [9.20124234e+01 4.23540916e-02]
mat_Sqrt:  [[ 1.89362577e+01  0.00000000e+00]
 [-8.23204389e-03  1.88619821e-02]]
grads:  [-3.72128437e-03 -4.51675739e+00]
Stock Position:  -0.003721284369087864
Bond Position:  [4.08885432]


portfolio before change:  [3.7532898]
curr_Stock_Price:  90.72390874258076
curr_Factors:  [9.07239087e+01 4.38529155e-02]
mat_Sqrt:  [[ 1.89985733e+01  0.00000000e+00]
 [-8.37643509e-03  1.91928239e-02]]
grads:  [-1.47943613e-02 -9.10693796e+01]
Stock Position:  -0.014794361293922765
Bond Position:  [5.09549208]


portfolio before change:  [3.69005051]
curr_Stock_Price:  95.17071572178355
curr_Factors:  [9.51707157e+01 4.25076551e-02]
mat_Sqrt:  [[ 1.96217126e+01  0.00000000e+00]
 [-8.24695388e-03  1.88961452e-02]]
grads:  [-0.04570749 15.0124736 ]
Stock Position:  -0.0457074899386353
Bond Position:  [8.04006504]


portfolio before change:  [3.54435548]
curr_Stock_Price:  98.44624154847409
curr_Factors:  [9.84462415e+01 3.88433030e-02]
mat_Sqrt:  [[ 1.94024788e+01  0.00000000e+00]
 [-7.88348177e-03  1.80633260e-02]]
grads:  [-0.00374065 -0.40225157]
Stock Position:  -0.003740647998653948
Bond Position:  [3.91260822]


portfolio before change:  [3.55045249]
curr_Stock_Price:  97.33942493955222
curr_Factors:  [9.73394249e+01 3.85567604e-02]
mat_Sqrt:  [[ 1.91134482e+01  0.00000000e+00]
 [-7.85435018e-03  1.79965771e-02]]
grads:  [-0.00264006 -1.7041139 ]
Stock Position:  -0.002640058198689159
Bond Position:  [3.80743424]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.54457035]
Stock Price:  100.28872923844399
PL:  [3.25584111]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-8.64614235e-01  2.84833181e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-1.79706477e-02  2.88520348e-02]
 [-1.55449199e-01 -4.26073660e-01]
 [ 6.17347151e-02  2.23460676e-01]
 [ 3.57265508e-01 -6.91336504e-01]
 [-8.28970107e-01  1.60236919e-01]
 [-4.88547126e-02  6.37282736e-03]
 [-3.35347897e-02  6.17894811e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.12811004]
curr_Stock_Price:  97.80633216609867
curr_Factors:  [9.78063322e+01 3.83834003e-02]
mat_Sqrt:  [[ 1.91619056e+01  0.00000000e+00]
 [-7.83667280e-03  1.79560731e-02]]
grads:  [-0.03863409 15.86277684]
Stock Position:  -0.038634093065060174
Bond Position:  [-8.34945111]


portfolio before change:  [-12.16596151]
curr_Stock_Price:  98.67798973393528
curr_Factors:  [9.86779897e+01 3.85530952e-02]
mat_Sqrt:  [[ 1.93753662e+01  0.00000000e+00]
 [-7.85397685e-03  1.79957217e-02]]
grads:  [ 0.00484944 -2.62712514]
Stock Position:  0.004849439756656223
Bond Position:  [-12.64449448]


portfolio before change:  [-12.16199476]
curr_Stock_Price:  100.80000365502934
curr_Factors:  [1.00800004e+02 4.13155124e-02]
mat_Sqrt:  [[ 2.04888281e+01  0.00000000e+00]
 [-8.13048706e-03  1.86292862e-02]]
grads:  [-2.62513179e-04  1.54874613e+00]
Stock Position:  -0.00026251317917228364
Bond Position:  [-12.13553343]


portfolio before change:  [-12.16830199]
curr_Stock_Price:  101.70642095133779
curr_Factors:  [1.01706421e+02 3.52563492e-02]
mat_Sqrt:  [[ 1.90970833e+01  0.00000000e+00]
 [-7.51066966e-03  1.72091061e-02]]
grads:  [-1.78772321e-02 -2.47586166e+01]
Stock Position:  -0.017877232108602894
Bond Position:  [-10.3500727]


portfolio before change:  [-12.17261574]
curr_Stock_Price:  101.65817042213334
curr_Factors:  [1.01658170e+02 3.70365347e-02]
mat_Sqrt:  [[ 1.95639913e+01  0.00000000e+00]
 [-7.69795139e-03  1.76382225e-02]]
grads:  [8.14051422e-03 1.26691154e+01]
Stock Position:  0.008140514220576881
Bond Position:  [-13.00016552]


portfolio before change:  [-12.1879875]
curr_Stock_Price:  100.56855198129622
curr_Factors:  [1.00568552e+02 3.60755910e-02]
mat_Sqrt:  [[ 1.91015638e+01  0.00000000e+00]
 [-7.59743020e-03  1.74078995e-02]]
grads:  [ 2.90769496e-03 -3.97139531e+01]
Stock Position:  0.0029076949580558926
Bond Position:  [-12.48041017]


portfolio before change:  [-12.1934802]
curr_Stock_Price:  100.82616780965265
curr_Factors:  [1.00826168e+02 3.41472292e-02]
mat_Sqrt:  [[ 1.86316362e+01  0.00000000e+00]
 [-7.39158756e-03  1.69362548e-02]]
grads:  [-0.04073915  9.46117789]
Stock Position:  -0.04073914786142649
Bond Position:  [-8.08590804]


portfolio before change:  [-12.18007232]
curr_Stock_Price:  100.39778755285627
curr_Factors:  [1.00397788e+02 3.34549397e-02]
mat_Sqrt:  [[ 1.83634496e+01  0.00000000e+00]
 [-7.31627662e-03  1.67636957e-02]]
grads:  [-0.00250897  0.38015647]
Stock Position:  -0.0025089720944889097
Bond Position:  [-11.92817707]


portfolio before change:  [-12.18293694]
curr_Stock_Price:  99.16184221668559
curr_Factors:  [9.91618422e+01 3.07797082e-02]
mat_Sqrt:  [[ 1.73970990e+01  0.00000000e+00]
 [-7.01765866e-03  1.60794760e-02]]
grads:  [-0.0017726   0.38427546]
Stock Position:  -0.001772598732978506
Bond Position:  [-12.00716279]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.19073648]
Stock Price:  100.17417409520426
PL:  [-12.36491058]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.86319797e-01  2.90623090e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.49655059e-01  9.36904654e-02]
 [-1.31483946e-01 -4.64362280e-01]
 [-1.61893691e-02 -1.20842536e-02]
 [ 4.15421703e-01 -1.07367336e+00]
 [-8.79545063e-01  1.85143001e-01]
 [-6.97755866e-02 -7.51080369e-03]
 [-3.64853178e-02 -1.03879704e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.22617842]
curr_Stock_Price:  98.8458461461715
curr_Factors:  [9.88458461e+01 3.97470712e-02]
mat_Sqrt:  [[ 1.97065677e+01  0.00000000e+00]
 [-7.97466701e-03  1.82722576e-02]]
grads:  [-0.02331616 15.90515505]
Stock Position:  -0.02331615978034034
Bond Position:  [-2.92147288]


portfolio before change:  [-5.24504193]
curr_Stock_Price:  99.59221317398432
curr_Factors:  [9.95922132e+01 3.86323158e-02]
mat_Sqrt:  [[ 1.95749542e+01  0.00000000e+00]
 [-7.86204206e-03  1.80142014e-02]]
grads:  [ 0.00479999 -2.62443012]
Stock Position:  0.0047999944209759
Bond Position:  [-5.723084]


portfolio before change:  [-5.2530301]
curr_Stock_Price:  98.5243138145119
curr_Factors:  [9.85243138e+01 4.09690364e-02]
mat_Sqrt:  [[ 1.99421186e+01  0.00000000e+00]
 [-8.09632375e-03  1.85510082e-02]]
grads:  [0.0095549  5.05042444]
Stock Position:  0.009554899092052595
Bond Position:  [-6.19441998]


portfolio before change:  [-5.26286952]
curr_Stock_Price:  97.81876586775215
curr_Factors:  [9.78187659e+01 4.26793855e-02]
mat_Sqrt:  [[ 2.02083688e+01  0.00000000e+00]
 [-8.26359588e-03  1.89342768e-02]]
grads:  [-1.65351426e-02 -2.45249546e+01]
Stock Position:  -0.016535142625947966
Bond Position:  [-3.64542228]


portfolio before change:  [-5.2799166]
curr_Stock_Price:  98.73946582071126
curr_Factors:  [9.87394658e+01 4.40187779e-02]
mat_Sqrt:  [[ 2.07161842e+01  0.00000000e+00]
 [-8.39226099e-03  1.92290856e-02]]
grads:  [-0.00103607 -0.6284362 ]
Stock Position:  -0.0010360677199231067
Bond Position:  [-5.17761582]


portfolio before change:  [-5.28036864]
curr_Stock_Price:  96.67646020310613
curr_Factors:  [9.66764602e+01 4.35667992e-02]
mat_Sqrt:  [[ 2.01789502e+01  0.00000000e+00]
 [-8.34906455e-03  1.91301101e-02]]
grads:  [-2.63481336e-03 -5.61247871e+01]
Stock Position:  -0.0026348133578844098
Bond Position:  [-5.02564421]


portfolio before change:  [-5.29185955]
curr_Stock_Price:  100.08370736837439
curr_Factors:  [1.00083707e+02 4.38527408e-02]
mat_Sqrt:  [[ 2.09585752e+01  0.00000000e+00]
 [-8.37641840e-03  1.91927857e-02]]
grads:  [-0.03811051  9.64648926]
Stock Position:  -0.038110512063069216
Bond Position:  [-1.47761821]


portfolio before change:  [-5.25909375]
curr_Stock_Price:  99.20455898470385
curr_Factors:  [9.92045590e+01 4.43533891e-02]
mat_Sqrt:  [[ 2.08927225e+01  0.00000000e+00]
 [-8.42409773e-03  1.93020328e-02]]
grads:  [-0.0034966  -0.38911983]
Stock Position:  -0.0034966036644859255
Bond Position:  [-4.91221472]


portfolio before change:  [-5.2515988]
curr_Stock_Price:  96.35846206236329
curr_Factors:  [9.63584621e+01 4.17741873e-02]
mat_Sqrt:  [[ 1.96944503e+01  0.00000000e+00]
 [-8.17549385e-03  1.87324097e-02]]
grads:  [-4.15457837e-03 -5.54545334e+00]
Stock Position:  -0.004154578372872
Bond Position:  [-4.85127001]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.26217743]
Stock Price:  98.32072882469762
PL:  [-5.26217743]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-8.19379870e-01  2.87332897e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 8.98150412e-02  5.77963876e-02]
 [-1.32909535e-01 -4.59889740e-01]
 [-2.21258985e-02 -3.07545772e-02]
 [ 4.23683160e-01 -1.16437848e+00]
 [-1.05564094e+00  2.71222841e-01]
 [-4.92656764e-02  1.47407282e-02]
 [-3.38304032e-02  5.83459122e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.93069495]
curr_Stock_Price:  97.98667729245433
curr_Factors:  [9.79866773e+01 4.12784564e-02]
mat_Sqrt:  [[ 1.99080515e+01  0.00000000e+00]
 [-8.12684011e-03  1.86209300e-02]]
grads:  [-0.03485914 15.43064164]
Stock Position:  -0.0348591379447978
Bond Position:  [-7.51496385]


portfolio before change:  [-10.93695855]
curr_Stock_Price:  98.05854305252888
curr_Factors:  [9.80585431e+01 4.22076693e-02]
mat_Sqrt:  [[ 2.01456425e+01  0.00000000e+00]
 [-8.21780208e-03  1.88293500e-02]]
grads:  [ 0.00466402 -2.51081491]
Stock Position:  0.004664019585690702
Bond Position:  [-11.39430551]


portfolio before change:  [-10.93750923]
curr_Stock_Price:  99.16229069942538
curr_Factors:  [9.91622907e+01 4.14997116e-02]
mat_Sqrt:  [[ 2.02008242e+01  0.00000000e+00]
 [-8.14859120e-03  1.86707680e-02]]
grads:  [0.00569479 3.09555491]
Stock Position:  0.00569479004131306
Bond Position:  [-11.50221765]


portfolio before change:  [-10.9501981]
curr_Stock_Price:  97.94427762209267
curr_Factors:  [9.79442776e+01 4.38459068e-02]
mat_Sqrt:  [[ 2.05089580e+01  0.00000000e+00]
 [-8.37576569e-03  1.91912901e-02]]
grads:  [-1.62671293e-02 -2.39634614e+01]
Stock Position:  -0.016267129344836134
Bond Position:  [-9.35692587]


portfolio before change:  [-10.96447742]
curr_Stock_Price:  98.53440533745771
curr_Factors:  [9.85344053e+01 4.46046134e-02]
mat_Sqrt:  [[ 2.08102736e+01  0.00000000e+00]
 [-8.44792172e-03  1.93566204e-02]]
grads:  [-0.00170821 -1.58884023]
Stock Position:  -0.0017082089904979386
Bond Position:  [-10.79616006]


portfolio before change:  [-10.96528855]
curr_Stock_Price:  95.8483766760498
curr_Factors:  [9.58483767e+01 4.69925012e-02]
mat_Sqrt:  [[ 2.07777752e+01  0.00000000e+00]
 [-8.67110154e-03  1.98679896e-02]]
grads:  [-4.06652155e-03 -5.86057525e+01]
Stock Position:  -0.004066521549351504
Bond Position:  [-10.57551906]


portfolio before change:  [-10.97167408]
curr_Stock_Price:  96.11800513480802
curr_Factors:  [9.61180051e+01 4.68779943e-02]
mat_Sqrt:  [[ 2.08108232e+01  0.00000000e+00]
 [-8.66053063e-03  1.98437686e-02]]
grads:  [-0.0450376  13.66790988]
Stock Position:  -0.0450376029026971
Bond Position:  [-6.64274953]


portfolio before change:  [-11.02219048]
curr_Stock_Price:  97.16588929197133
curr_Factors:  [9.71658893e+01 4.30296836e-02]
mat_Sqrt:  [[ 2.01557010e+01  0.00000000e+00]
 [-8.29743899e-03  1.90118211e-02]]
grads:  [-0.00212507  0.77534541]
Stock Position:  -0.0021250709796850164
Bond Position:  [-10.81570607]


portfolio before change:  [-11.03165186]
curr_Stock_Price:  99.07273113215945
curr_Factors:  [9.90727311e+01 4.27122974e-02]
mat_Sqrt:  [[ 2.04753155e+01  0.00000000e+00]
 [-8.26678147e-03  1.89415759e-02]]
grads:  [-0.00152789  0.30803093]
Stock Position:  -0.0015278875125696399
Bond Position:  [-10.88027987]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.04001043]
Stock Price:  100.98195037220091
PL:  [-12.0219608]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-6.71262578e-01  2.95518072e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.33704486e-01 -4.59102290e-01]
 [-3.40187344e-02 -8.88879319e-02]
 [ 4.26841829e-01 -1.18443942e+00]
 [-9.17216870e-01  3.20788805e-01]
 [ 1.15350887e-02  9.49793562e-02]
 [-2.40354555e-02 -1.99663064e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.1522977]
curr_Stock_Price:  98.55574939741373
curr_Factors:  [9.85557494e+01 4.12727539e-02]
mat_Sqrt:  [[ 2.00222873e+01  0.00000000e+00]
 [-8.12627874e-03  1.86196437e-02]]
grads:  [-0.02708421 15.87130649]
Stock Position:  -0.027084214217764083
Bond Position:  [-4.48299267]


portfolio before change:  [-7.2164011]
curr_Stock_Price:  100.83978609893877
curr_Factors:  [1.00839786e+02 4.07844630e-02]
mat_Sqrt:  [[ 2.03647597e+01  0.00000000e+00]
 [-8.07806541e-03  1.85091731e-02]]
grads:  [ 0.00461384 -2.5542477 ]
Stock Position:  0.004613836467673231
Bond Position:  [-7.68165938]


portfolio before change:  [-7.23776924]
curr_Stock_Price:  97.04113600571576
curr_Factors:  [9.7041136e+01 4.0284477e-02]
mat_Sqrt:  [[ 1.94771198e+01  0.00000000e+00]
 [-8.02839730e-03  1.83953692e-02]]
grads:  [ 0.02067894 10.59532391]
Stock Position:  0.020678939425080426
Bond Position:  [-9.24447701]


portfolio before change:  [-7.22306185]
curr_Stock_Price:  97.97594141074553
curr_Factors:  [9.79759414e+01 3.78673467e-02]
mat_Sqrt:  [[ 1.90656617e+01  0.00000000e+00]
 [-7.78381363e-03  1.78349576e-02]]
grads:  [-1.75222428e-02 -2.57417091e+01]
Stock Position:  -0.017522242753821547
Bond Position:  [-5.50630362]


portfolio before change:  [-7.21428146]
curr_Stock_Price:  97.3176789847721
curr_Factors:  [9.73176790e+01 3.85165791e-02]
mat_Sqrt:  [[ 1.90992185e+01  0.00000000e+00]
 [-7.85025647e-03  1.79871972e-02]]
grads:  [-3.81233444e-03 -4.94173331e+00]
Stock Position:  -0.0038123344387256037
Bond Position:  [-6.84327392]


portfolio before change:  [-7.21161254]
curr_Stock_Price:  95.7198635920301
curr_Factors:  [9.57198636e+01 4.09591325e-02]
mat_Sqrt:  [[ 1.93721332e+01  0.00000000e+00]
 [-8.09534508e-03  1.85487658e-02]]
grads:  [-4.65049008e-03 -6.38554301e+01]
Stock Position:  -0.004650490084960068
Bond Position:  [-6.76646827]


portfolio before change:  [-7.19984812]
curr_Stock_Price:  92.46246527799846
curr_Factors:  [9.24624653e+01 4.26140885e-02]
mat_Sqrt:  [[ 1.90871932e+01  0.00000000e+00]
 [-8.25727205e-03  1.89197871e-02]]
grads:  [-0.04071909 16.95520162]
Stock Position:  -0.040719090925624146
Bond Position:  [-3.43486059]


portfolio before change:  [-7.2218849]
curr_Stock_Price:  92.96146757312192
curr_Factors:  [9.29614676e+01 4.09812222e-02]
mat_Sqrt:  [[ 1.88189516e+01  0.00000000e+00]
 [-8.09752774e-03  1.85537669e-02]]
grads:  [2.81564454e-03 5.11914139e+00]
Stock Position:  0.002815644537372862
Bond Position:  [-7.48363135]


portfolio before change:  [-7.22052783]
curr_Stock_Price:  94.77271438080359
curr_Factors:  [9.47727144e+01 3.93486100e-02]
mat_Sqrt:  [[ 1.87995744e+01  0.00000000e+00]
 [-7.93459362e-03  1.81804379e-02]]
grads:  [-5.91372753e-03 -1.09823022e+01]
Stock Position:  -0.005913727526200742
Bond Position:  [-6.66006782]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.21739311]
Stock Price:  93.67939731895626
PL:  [-7.21739311]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.74750467e-01 -3.05418829e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.80532130e-02  5.60254824e-02]
 [-1.38735852e-01 -4.43889090e-01]
 [-3.13933094e-02 -6.62640262e-02]
 [ 4.23266878e-01 -1.15384949e+00]
 [-1.00481468e+00  2.89503232e-01]
 [-1.60793833e-02  4.47793321e-02]
 [-2.24162472e-02 -2.08908884e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.88468535]
curr_Stock_Price:  102.77845652070829
curr_Factors:  [1.02778457e+02 3.89926757e-02]
mat_Sqrt:  [[ 2.02952128e+01  0.00000000e+00]
 [-7.89862527e-03  1.80980241e-02]]
grads:  [ 1.18971288e-02 -1.68758107e+01]
Stock Position:  0.011897128837790438
Bond Position:  [19.66191681]


portfolio before change:  [20.86298938]
curr_Stock_Price:  100.12828836788024
curr_Factors:  [1.00128288e+02 4.10068663e-02]
mat_Sqrt:  [[ 2.02761308e+01  0.00000000e+00]
 [-8.10006087e-03  1.85595710e-02]]
grads:  [ 0.004634   -2.54731172]
Stock Position:  0.004634003998255543
Bond Position:  [20.39899449]


portfolio before change:  [20.87020225]
curr_Stock_Price:  99.4832365047269
curr_Factors:  [9.94832365e+01 4.05103867e-02]
mat_Sqrt:  [[ 2.00231823e+01  0.00000000e+00]
 [-8.05087690e-03  1.84468764e-02]]
grads:  [0.0051193 3.0371257]
Stock Position:  0.005119303055785345
Bond Position:  [20.36091741]


portfolio before change:  [20.87487092]
curr_Stock_Price:  98.40607086979782
curr_Factors:  [9.84060709e+01 3.97631123e-02]
mat_Sqrt:  [[ 1.96228497e+01  0.00000000e+00]
 [-7.97627606e-03  1.82759444e-02]]
grads:  [-1.69427448e-02 -2.42881616e+01]
Stock Position:  -0.016942744765878096
Bond Position:  [22.54213986]


portfolio before change:  [20.88993233]
curr_Stock_Price:  98.18252222013882
curr_Factors:  [9.81825222e+01 4.15927365e-02]
mat_Sqrt:  [[ 2.00236355e+01  0.00000000e+00]
 [-8.15771895e-03  1.86916823e-02]]
grads:  [-3.01210543e-03 -3.54510767e+00]
Stock Position:  -0.0030121054307095992
Bond Position:  [21.18566844]


portfolio before change:  [20.9072019]
curr_Stock_Price:  95.9667669437703
curr_Factors:  [9.59667669e+01 4.38269348e-02]
mat_Sqrt:  [[ 2.00905309e+01  0.00000000e+00]
 [-8.37395341e-03  1.91871377e-02]]
grads:  [-3.99762075e-03 -6.01366137e+01]
Stock Position:  -0.003997620751988128
Bond Position:  [21.29084064]


portfolio before change:  [20.92279895]
curr_Stock_Price:  94.72878991826485
curr_Factors:  [9.47287899e+01 4.21535080e-02]
mat_Sqrt:  [[ 1.94490705e+01  0.00000000e+00]
 [-8.21252779e-03  1.88172651e-02]]
grads:  [-0.04516746 15.38497916]
Stock Position:  -0.045167459770105306
Bond Position:  [25.20145776]


portfolio before change:  [20.9344635]
curr_Stock_Price:  94.74958656457596
curr_Factors:  [9.47495866e+01 4.05322040e-02]
mat_Sqrt:  [[ 1.90755660e+01  0.00000000e+00]
 [-8.05304454e-03  1.84518431e-02]]
grads:  [1.81589340e-04 2.42682164e+00]
Stock Position:  0.0001815893396937097
Bond Position:  [20.91725798]


portfolio before change:  [20.94489027]
curr_Stock_Price:  94.55974164420674
curr_Factors:  [9.45597416e+01 3.98906436e-02]
mat_Sqrt:  [[ 1.88860788e+01  0.00000000e+00]
 [-7.98905687e-03  1.83052289e-02]]
grads:  [-6.01456554e-03 -1.14125251e+01]
Stock Position:  -0.0060145655446798545
Bond Position:  [21.51362603]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.9471047]
Stock Price:  95.98047107065885
PL:  [20.9471047]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.26664872e-01  2.65546086e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.15719996e-01  7.18503068e-02]
 [-1.51005635e-01 -4.35172800e-01]
 [-1.27319866e-02 -1.26940649e-03]
 [ 3.30649210e-01 -6.07612452e-01]
 [-6.61611106e-01  9.45573410e-02]
 [ 3.00838278e-02 -3.60307280e-02]
 [-3.42237053e-02  1.28582763e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.13090372]
curr_Stock_Price:  97.50468733091921
curr_Factors:  [9.75046873e+01 4.11515964e-02]
mat_Sqrt:  [[ 1.97796607e+01  0.00000000e+00]
 [-8.11434250e-03  1.85922944e-02]]
grads:  [-0.04099014 14.28258831]
Stock Position:  -0.040990139868319196
Bond Position:  [-10.13417295]


portfolio before change:  [-14.23282711]
curr_Stock_Price:  99.86757342694989
curr_Factors:  [9.98675734e+01 3.89216863e-02]
mat_Sqrt:  [[ 1.97024540e+01  0.00000000e+00]
 [-7.89143194e-03  1.80815421e-02]]
grads:  [ 0.00476893 -2.61465602]
Stock Position:  0.00476893239640089
Bond Position:  [-14.70908881]


portfolio before change:  [-14.24512504]
curr_Stock_Price:  98.83137777145905
curr_Factors:  [9.88313778e+01 3.92895901e-02]
mat_Sqrt:  [[ 1.95899622e+01  0.00000000e+00]
 [-7.92864075e-03  1.81667982e-02]]
grads:  [0.00750783 3.95503413]
Stock Position:  0.007507826686589084
Bond Position:  [-14.98713389]


portfolio before change:  [-14.22642551]
curr_Stock_Price:  102.32039900962829
curr_Factors:  [1.02320399e+02 3.53793170e-02]
mat_Sqrt:  [[ 1.92458434e+01  0.00000000e+00]
 [-7.52375619e-03  1.72390911e-02]]
grads:  [-1.77145064e-02 -2.52433725e+01]
Stock Position:  -0.017714506385119098
Bond Position:  [-12.41387015]


portfolio before change:  [-14.17120322]
curr_Stock_Price:  98.85257540607104
curr_Factors:  [9.88525754e+01 3.38099349e-02]
mat_Sqrt:  [[ 1.81764956e+01  0.00000000e+00]
 [-7.35499122e-03  1.68524020e-02]]
grads:  [-0.00073094 -0.07532496]
Stock Position:  -0.000730944033944715
Bond Position:  [-14.09894752]


portfolio before change:  [-14.18038061]
curr_Stock_Price:  101.7613530290467
curr_Factors:  [1.01761353e+02 3.01914530e-02]
mat_Sqrt:  [[ 1.76817351e+01  0.00000000e+00]
 [-6.95027516e-03  1.59250810e-02]]
grads:  [ 3.70243051e-03 -3.81544339e+01]
Stock Position:  0.003702430510746903
Bond Position:  [-14.55714494]


portfolio before change:  [-14.1816835]
curr_Stock_Price:  103.37583223516953
curr_Factors:  [1.03375832e+02 3.15354405e-02]
mat_Sqrt:  [[ 1.83577085e+01  0.00000000e+00]
 [-7.10328831e-03  1.62756782e-02]]
grads:  [-0.03379196  5.80973278]
Stock Position:  -0.03379195711994179
Bond Position:  [-10.68841181]


portfolio before change:  [-14.18812608]
curr_Stock_Price:  103.40829670079314
curr_Factors:  [1.03408297e+02 3.05254312e-02]
mat_Sqrt:  [[ 1.80670102e+01  0.00000000e+00]
 [-6.98861145e-03  1.60129205e-02]]
grads:  [ 7.94748484e-04 -2.25010347e+00]
Stock Position:  0.0007947484837772834
Bond Position:  [-14.27030967]


portfolio before change:  [-14.19453396]
curr_Stock_Price:  104.32564867196095
curr_Factors:  [1.04325649e+02 3.33474036e-02]
mat_Sqrt:  [[ 1.90511899e+01  0.00000000e+00]
 [-7.30450859e-03  1.67367318e-02]]
grads:  [1.14924124e-03 7.68266854e+00]
Stock Position:  0.0011492412378884464
Bond Position:  [-14.31442929]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.20366892]
Stock Price:  102.6062845300285
PL:  [-16.80995345]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.87405679e-01  2.83115834e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-2.46664116e-02  2.60279736e-02]
 [-1.50650568e-01 -4.36059497e-01]
 [ 6.26437015e-02  2.26206392e-01]
 [ 2.20585585e-01 -6.37249939e-01]
 [-6.94519182e-01  1.06990001e-01]
 [ 5.90839297e-02 -8.29279673e-02]
 [-3.82882171e-02  1.67565719e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.96940141]
curr_Stock_Price:  99.18574392814787
curr_Factors:  [9.91857439e+01 4.16262219e-02]
mat_Sqrt:  [[ 2.02363766e+01  0.00000000e+00]
 [-8.16100209e-03  1.86992049e-02]]
grads:  [-0.01797969 15.14052793]
Stock Position:  -0.01797969103712499
Bond Position:  [-1.18607238]


portfolio before change:  [-2.98333135]
curr_Stock_Price:  99.92751167742102
curr_Factors:  [9.99275117e+01 4.20334695e-02]
mat_Sqrt:  [[ 2.04872040e+01  0.00000000e+00]
 [-8.20082625e-03  1.87904535e-02]]
grads:  [ 0.00458626 -2.51601233]
Stock Position:  0.004586261301858607
Bond Position:  [-3.44162503]


portfolio before change:  [-2.98085285]
curr_Stock_Price:  100.84323384082049
curr_Factors:  [1.00843234e+02 4.28536242e-02]
mat_Sqrt:  [[ 2.08756757e+01  0.00000000e+00]
 [-8.28044677e-03  1.89728870e-02]]
grads:  [-6.37434342e-04  1.37185097e+00]
Stock Position:  -0.0006374343424480854
Bond Position:  [-2.91657191]


portfolio before change:  [-2.98328242]
curr_Stock_Price:  102.3664094812693
curr_Factors:  [1.02366409e+02 4.03144037e-02]
mat_Sqrt:  [[ 2.05535853e+01  0.00000000e+00]
 [-8.03137883e-03  1.84022007e-02]]
grads:  [-1.65889566e-02 -2.36960516e+01]
Stock Position:  -0.016588956571028157
Bond Position:  [-1.2851305]


portfolio before change:  [-2.97280922]
curr_Stock_Price:  101.69632940088843
curr_Factors:  [1.01696329e+02 3.96149308e-02]
mat_Sqrt:  [[ 2.02411288e+01  0.00000000e+00]
 [-7.96139995e-03  1.82418590e-02]]
grads:  [7.97229574e-03 1.24004024e+01]
Stock Position:  0.007972295735754722
Bond Position:  [-3.78356243]


portfolio before change:  [-2.95230191]
curr_Stock_Price:  104.50600538247618
curr_Factors:  [1.04506005e+02 3.66912740e-02]
mat_Sqrt:  [[ 2.00180903e+01  0.00000000e+00]
 [-7.66198658e-03  1.75558167e-02]]
grads:  [-2.87405486e-03 -3.62985071e+01]
Stock Position:  -0.002874054861586303
Bond Position:  [-2.65194591]


portfolio before change:  [-2.94893919]
curr_Stock_Price:  102.87450643629963
curr_Factors:  [1.02874506e+02 3.66018377e-02]
mat_Sqrt:  [[ 1.96815460e+01  0.00000000e+00]
 [-7.65264270e-03  1.75344072e-02]]
grads:  [-0.03291535  6.10171761]
Stock Position:  -0.03291534705888885
Bond Position:  [0.43721089]


portfolio before change:  [-2.99214634]
curr_Stock_Price:  104.19382443073411
curr_Factors:  [1.04193824e+02 3.91154048e-02]
mat_Sqrt:  [[ 2.06070533e+01  0.00000000e+00]
 [-7.91104593e-03  1.81264834e-02]]
grads:  [ 1.11084284e-03 -4.57496170e+00]
Stock Position:  0.0011108428417457082
Bond Position:  [-3.10788931]


portfolio before change:  [-2.99220339]
curr_Stock_Price:  105.54170691534321
curr_Factors:  [1.05541707e+02 3.53509620e-02]
mat_Sqrt:  [[ 1.98437950e+01  0.00000000e+00]
 [-7.52074060e-03  1.72321815e-02]]
grads:  [1.75588682e-03 9.72399915e+00]
Stock Position:  0.001755886821694309
Bond Position:  [-3.17752268]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.9892798]
Stock Price:  108.1117783491039
PL:  [-11.10105814]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.03603351e-01  3.03950308e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 4.31553104e-03 -5.52405853e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.62038552e-01 -1.53455965e+00]
 [-1.04940974e+00  2.56083233e-01]
 [-5.81411019e-02  5.08967134e-03]
 [-3.75916583e-02 -5.83375009e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.25431069]
curr_Stock_Price:  99.97249784640935
curr_Factors:  [9.99724978e+01 3.68967990e-02]
mat_Sqrt:  [[ 1.92032567e+01  0.00000000e+00]
 [-7.68341580e-03  1.76049173e-02]]
grads:  [-8.90206087e-03  1.72650802e+01]
Stock Position:  -0.008902060872838775
Bond Position:  [3.14427195]


portfolio before change:  [2.27334594]
curr_Stock_Price:  98.01084818214578
curr_Factors:  [9.80108482e+01 3.65061924e-02]
mat_Sqrt:  [[ 1.87265346e+01  0.00000000e+00]
 [-7.64263749e-03  1.75114824e-02]]
grads:  [ 0.00501746 -2.69977217]
Stock Position:  0.005017461757506486
Bond Position:  [1.78158026]


portfolio before change:  [2.26173645]
curr_Stock_Price:  95.5194478960892
curr_Factors:  [9.55194479e+01 3.75440068e-02]
mat_Sqrt:  [[ 1.85081118e+01  0.00000000e+00]
 [-7.75051036e-03  1.77586502e-02]]
grads:  [ 0.0217616  10.97520884]
Stock Position:  0.021761603048776144
Bond Position:  [0.18308014]


portfolio before change:  [2.21526105]
curr_Stock_Price:  93.37957957426546
curr_Factors:  [9.33795796e+01 3.67837674e-02]
mat_Sqrt:  [[ 1.79093580e+01  0.00000000e+00]
 [-7.67163789e-03  1.75779307e-02]]
grads:  [-1.32206944e-02 -3.14261026e+01]
Stock Position:  -0.013220694363843889
Bond Position:  [3.44980393]


portfolio before change:  [2.24300816]
curr_Stock_Price:  91.41131816384944
curr_Factors:  [9.14113182e+01 3.53258751e-02]
mat_Sqrt:  [[ 1.71809208e+01  0.00000000e+00]
 [-7.51807158e-03  1.72260660e-02]]
grads:  [-4.10147980e-03 -4.94570246e+00]
Stock Position:  -0.004101479803782698
Bond Position:  [2.61792984]


portfolio before change:  [2.23919935]
curr_Stock_Price:  92.65918615519381
curr_Factors:  [9.26591862e+01 3.73125403e-02]
mat_Sqrt:  [[ 1.78984692e+01  0.00000000e+00]
 [-7.72658168e-03  1.77038227e-02]]
grads:  [-1.1604243e-02 -8.6679565e+01]
Stock Position:  -0.011604242980321805
Bond Position:  [3.31443906]


portfolio before change:  [2.18857591]
curr_Stock_Price:  97.16452692417855
curr_Factors:  [9.71645269e+01 3.65175948e-02]
mat_Sqrt:  [[ 1.85677305e+01  0.00000000e+00]
 [-7.64383096e-03  1.75142170e-02]]
grads:  [-0.05049868 14.62144917]
Stock Position:  -0.05049867858321115
Bond Position:  [7.09525613]


portfolio before change:  [2.16940906]
curr_Stock_Price:  97.61434797722089
curr_Factors:  [9.76143480e+01 3.50523714e-02]
mat_Sqrt:  [[ 1.82756301e+01  0.00000000e+00]
 [-7.48891142e-03  1.71592517e-02]]
grads:  [-0.0030598   0.29661383]
Stock Position:  -0.0030598007746751284
Bond Position:  [2.46808952]


portfolio before change:  [2.17256194]
curr_Stock_Price:  96.98733891093401
curr_Factors:  [9.69873389e+01 3.66339855e-02]
mat_Sqrt:  [[ 1.85633831e+01  0.00000000e+00]
 [-7.65600266e-03  1.75421059e-02]]
grads:  [-0.00339659 -3.32557   ]
Stock Position:  -0.003396591595806046
Bond Position:  [2.50198832]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.17308345]
Stock Price:  97.20220026737036
PL:  [2.17308345]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.41019026e+00 -4.29415996e-01]
 [ 1.14991235e-01 -2.22957684e-03]
 [ 3.17702712e-01  1.94904895e-01]
 [ 1.59258264e-01 -5.54210026e-01]
 [-3.13716554e-02 -3.53609075e-02]
 [ 5.01700462e-01 -1.96475635e+00]
 [-8.14010943e-01  3.55302302e-01]
 [ 2.14697447e-02  1.11234944e-01]
 [-3.24526990e-02 -1.50295538e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-45.88615608]
curr_Stock_Price:  92.72196409521008
curr_Factors:  [9.27219641e+01 4.27967771e-02]
mat_Sqrt:  [[ 1.91817468e+01  0.00000000e+00]
 [-8.27495277e-03  1.89602987e-02]]
grads:  [ -0.08328766 -22.64816619]
Stock Position:  -0.08328765752988568
Bond Position:  [-38.16356089]


portfolio before change:  [-45.74649804]
curr_Stock_Price:  90.81598430130343
curr_Factors:  [9.08159843e+01 4.53248614e-02]
mat_Sqrt:  [[ 1.93343928e+01  0.00000000e+00]
 [-8.51585452e-03  1.95122740e-02]]
grads:  [ 0.00589717 -0.11426535]
Stock Position:  0.005897168269725375
Bond Position:  [-46.28205518]


portfolio before change:  [-45.76523491]
curr_Stock_Price:  91.56379049359718
curr_Factors:  [9.15637905e+01 4.72603541e-02]
mat_Sqrt:  [[ 1.99054614e+01  0.00000000e+00]
 [-8.69577866e-03  1.99245320e-02]]
grads:  [0.02023395 9.78215674]
Stock Position:  0.020233953574265242
Bond Position:  [-47.6179324]


portfolio before change:  [-45.81041969]
curr_Stock_Price:  90.50765184272356
curr_Factors:  [9.05076518e+01 4.67706817e-02]
mat_Sqrt:  [[ 1.95736648e+01  0.00000000e+00]
 [-8.65061216e-03  1.98210425e-02]]
grads:  [-4.22091732e-03 -2.79606900e+01]
Stock Position:  -0.004220917315206171
Bond Position:  [-45.42839438]


portfolio before change:  [-45.81568258]
curr_Stock_Price:  86.37182449244717
curr_Factors:  [8.63718245e+01 5.11829173e-02]
mat_Sqrt:  [[ 1.95404523e+01  0.00000000e+00]
 [-9.04945676e-03  2.07349103e-02]]
grads:  [-0.00239526 -1.7053803 ]
Stock Position:  -0.0023952577946570732
Bond Position:  [-45.6087998]


portfolio before change:  [-45.84419242]
curr_Stock_Price:  88.75141820915732
curr_Factors:  [8.87514182e+01 5.11147723e-02]
mat_Sqrt:  [[ 2.00654321e+01  0.00000000e+00]
 [-9.04343053e-03  2.07211025e-02]]
grads:  [-1.77314652e-02 -9.48191032e+01]
Stock Position:  -0.017731465155918946
Bond Position:  [-44.27049974]


portfolio before change:  [-45.89326254]
curr_Stock_Price:  90.27014938433483
curr_Factors:  [9.02701494e+01 5.15271451e-02]
mat_Sqrt:  [[ 2.04909551e+01  0.00000000e+00]
 [-9.07983657e-03  2.08045192e-02]]
grads:  [-0.03215781 17.0781309 ]
Stock Position:  -0.032157813165389404
Bond Position:  [-42.99037194]


portfolio before change:  [-45.98556873]
curr_Stock_Price:  92.47196687915978
curr_Factors:  [9.24719669e+01 5.08226490e-02]
mat_Sqrt:  [[ 2.08467685e+01  0.00000000e+00]
 [-9.01755169e-03  2.06618066e-02]]
grads:  [3.35863347e-03 5.38360205e+00]
Stock Position:  0.0033586334652584648
Bond Position:  [-46.29614818]


portfolio before change:  [-45.99802768]
curr_Stock_Price:  95.65627212920045
curr_Factors:  [9.56562721e+01 4.76848190e-02]
mat_Sqrt:  [[ 2.08883204e+01  0.00000000e+00]
 [-8.73474158e-03  2.00138072e-02]]
grads:  [-4.69386946e-03 -7.50959255e+00]
Stock Position:  -0.004693869457994071
Bond Position:  [-45.54902963]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-46.02038164]
Stock Price:  95.56546188682522
PL:  [-46.02038164]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.77003892e-01  2.75102046e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-2.61230058e-02 -5.52031136e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.39560403e-01 -1.30730676e+00]
 [-9.28577420e-01  3.16533072e-01]
 [ 3.05372803e-02  1.17085275e-01]
 [-2.63821272e-02 -1.88446319e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.49693168]
curr_Stock_Price:  99.55812762920507
curr_Factors:  [9.95581276e+01 4.00814215e-02]
mat_Sqrt:  [[ 1.99318807e+01  0.00000000e+00]
 [-8.00813801e-03  1.83489493e-02]]
grads:  [-1.28908817e-02  1.49927956e+01]
Stock Position:  -0.012890881715431873
Bond Position:  [0.78646036]


portfolio before change:  [-0.47609439]
curr_Stock_Price:  97.9722028802124
curr_Factors:  [9.79722029e+01 3.91397200e-02]
mat_Sqrt:  [[ 1.93825865e+01  0.00000000e+00]
 [-7.91350441e-03  1.81321165e-02]]
grads:  [ 0.00484763 -2.60736318]
Stock Position:  0.004847633264551318
Bond Position:  [-0.9510277]


portfolio before change:  [-0.49360107]
curr_Stock_Price:  94.45893143806852
curr_Factors:  [9.44589314e+01 3.74286228e-02]
mat_Sqrt:  [[ 1.82744768e+01  0.00000000e+00]
 [-7.73859137e-03  1.77313404e-02]]
grads:  [ 0.02203982 10.99211287]
Stock Position:  0.022039820122141427
Bond Position:  [-2.57545893]


portfolio before change:  [-0.50623315]
curr_Stock_Price:  93.94422546244267
curr_Factors:  [9.39442255e+01 3.48907864e-02]
mat_Sqrt:  [[ 1.75479129e+01  0.00000000e+00]
 [-7.47163023e-03  1.71196555e-02]]
grads:  [-1.52182854e-02 -3.22454581e+01]
Stock Position:  -0.015218285353579655
Bond Position:  [0.92343688]


portfolio before change:  [-0.49708569]
curr_Stock_Price:  93.37348930446534
curr_Factors:  [9.33734893e+01 3.56630001e-02]
mat_Sqrt:  [[ 1.76332565e+01  0.00000000e+00]
 [-7.55385995e-03  1.73080675e-02]]
grads:  [-3.99626692e-03 -4.92227090e+00]
Stock Position:  -0.003996266919167847
Bond Position:  [-0.1239403]


portfolio before change:  [-0.50229228]
curr_Stock_Price:  94.6608419883748
curr_Factors:  [9.46608420e+01 3.78075299e-02]
mat_Sqrt:  [[ 1.84060041e+01  0.00000000e+00]
 [-7.77766340e-03  1.78208656e-02]]
grads:  [-7.11697337e-03 -7.33582073e+01]
Stock Position:  -0.007116973365930809
Bond Position:  [0.17140641]


portfolio before change:  [-0.48850467]
curr_Stock_Price:  92.73560134783446
curr_Factors:  [9.27356013e+01 3.75083076e-02]
mat_Sqrt:  [[ 1.79601611e+01  0.00000000e+00]
 [-7.74682465e-03  1.77502052e-02]]
grads:  [-0.04401024 17.832643  ]
Stock Position:  -0.04401024347508761
Bond Position:  [3.59281172]


portfolio before change:  [-0.45161503]
curr_Stock_Price:  91.93822364871316
curr_Factors:  [9.19382236e+01 4.02666653e-02]
mat_Sqrt:  [[ 1.84488347e+01  0.00000000e+00]
 [-8.02662223e-03  1.83913020e-02]]
grads:  [4.42507533e-03 6.36633964e+00]
Stock Position:  0.004425075331990942
Bond Position:  [-0.85844859]


portfolio before change:  [-0.43851486]
curr_Stock_Price:  94.99568597072764
curr_Factors:  [9.49956860e+01 3.52076697e-02]
mat_Sqrt:  [[ 1.78247121e+01  0.00000000e+00]
 [-7.50548277e-03  1.71972215e-02]]
grads:  [-6.09417100e-03 -1.09579515e+01]
Stock Position:  -0.00609417100064754
Bond Position:  [0.1404051]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.44597325]
Stock Price:  96.23106476429838
PL:  [-0.44597325]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.57928668e-01  3.41284598e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.94400547e-02  4.80120928e-03]
 [-1.03780067e-01 -5.45911715e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.68246331e-01 -1.59830698e+00]
 [-9.85235771e-01  2.95840580e-01]
 [ 4.93914567e-03  8.37902966e-02]
 [-4.81452914e-02 -1.97901743e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.65266091]
curr_Stock_Price:  100.33371825774715
curr_Factors:  [1.00333718e+02 3.73123894e-02]
mat_Sqrt:  [[ 1.93808775e+01  0.00000000e+00]
 [-7.72656606e-03  1.77037869e-02]]
grads:  [-5.62306106e-03  1.92774913e+01]
Stock Position:  -0.005623061055207481
Bond Position:  [5.21684353]


portfolio before change:  [4.65675722]
curr_Stock_Price:  100.06922835604877
curr_Factors:  [1.00069228e+02 3.57531901e-02]
mat_Sqrt:  [[ 1.89216040e+01  0.00000000e+00]
 [-7.56340559e-03  1.73299393e-02]]
grads:  [ 0.00496573 -2.72805415]
Stock Position:  0.004965734982092118
Bond Position:  [4.15983995]


portfolio before change:  [4.66604091]
curr_Stock_Price:  101.51981803289726
curr_Factors:  [1.01519818e+02 3.54574272e-02]
mat_Sqrt:  [[ 1.91163265e+01  0.00000000e+00]
 [-7.53205706e-03  1.72581108e-02]]
grads:  [-0.00509222  0.27820017]
Stock Position:  -0.005092224961255355
Bond Position:  [5.18300266]


portfolio before change:  [4.69928639]
curr_Stock_Price:  95.5001830866792
curr_Factors:  [9.55001831e+01 4.08565401e-02]
mat_Sqrt:  [[ 1.93034528e+01  0.00000000e+00]
 [-8.08520031e-03  1.85255212e-02]]
grads:  [-1.77188753e-02 -2.94680894e+01]
Stock Position:  -0.017718875329882727
Bond Position:  [6.39144223]


portfolio before change:  [4.76636342]
curr_Stock_Price:  91.89495940548701
curr_Factors:  [9.18949594e+01 4.13630920e-02]
mat_Sqrt:  [[ 1.86895217e+01  0.00000000e+00]
 [-8.13516731e-03  1.86400100e-02]]
grads:  [-3.77041214e-03 -4.57054460e+00]
Stock Position:  -0.0037704121449887293
Bond Position:  [5.11284529]


portfolio before change:  [4.76817118]
curr_Stock_Price:  92.09369050692247
curr_Factors:  [9.20936905e+01 3.76716216e-02]
mat_Sqrt:  [[ 1.78746289e+01  0.00000000e+00]
 [-7.76367146e-03  1.77888061e-02]]
grads:  [-1.28289111e-02 -8.98490307e+01]
Stock Position:  -0.012828911065821097
Bond Position:  [5.94963295]


portfolio before change:  [4.74357592]
curr_Stock_Price:  94.24280708499519
curr_Factors:  [9.42428071e+01 3.39768933e-02]
mat_Sqrt:  [[ 1.73716090e+01  0.00000000e+00]
 [-7.37312887e-03  1.68939606e-02]]
grads:  [-0.04928273 17.51161779]
Stock Position:  -0.04928273222265091
Bond Position:  [9.38811894]


portfolio before change:  [4.79380444]
curr_Stock_Price:  93.31888726625726
curr_Factors:  [9.33188873e+01 3.64945300e-02]
mat_Sqrt:  [[ 1.78272124e+01  0.00000000e+00]
 [-7.64141663e-03  1.75086851e-02]]
grads:  [2.32836341e-03 4.78564189e+00]
Stock Position:  0.002328363413562747
Bond Position:  [4.57652416]


portfolio before change:  [4.79402425]
curr_Stock_Price:  92.43026650965524
curr_Factors:  [9.24302665e+01 3.25073472e-02]
mat_Sqrt:  [[ 1.66649867e+01  0.00000000e+00]
 [-7.21191761e-03  1.65245792e-02]]
grads:  [-8.07181522e-03 -1.19762047e+01]
Stock Position:  -0.00807181522396585
Bond Position:  [5.54010428]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.8114651]
Stock Price:  90.6128180330875
PL:  [4.8114651]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.83400290e-01  2.75493576e-01]
 [ 6.48760786e-02  9.53332281e-02]
 [-9.91854869e-02  6.61349074e-03]
 [-1.46330607e-01 -4.44862438e-01]
 [ 3.14236791e-02  1.32682723e-01]
 [ 4.11452029e-01 -1.02242776e+00]
 [-8.53534848e-01  1.72330017e-01]
 [-1.31669897e-02  3.24475340e-02]
 [-2.69955192e-02  3.93986660e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.6309376]
curr_Stock_Price:  99.53794472524406
curr_Factors:  [9.95379447e+01 4.08963627e-02]
mat_Sqrt:  [[ 2.01294084e+01  0.00000000e+00]
 [-8.08913965e-03  1.85345474e-02]]
grads:  [-1.30736597e-02  1.48637876e+01]
Stock Position:  -0.013073659735648545
Bond Position:  [0.67038762]


portfolio before change:  [-0.66573202]
curr_Stock_Price:  102.22500369946421
curr_Factors:  [1.02225004e+02 4.06447902e-02]
mat_Sqrt:  [[ 2.06091262e+01  0.00000000e+00]
 [-8.06422124e-03  1.84774521e-02]]
grads:  [0.00516678 5.1594358 ]
Stock Position:  0.005166784345102458
Bond Position:  [-1.19390657]


portfolio before change:  [-0.66446533]
curr_Stock_Price:  102.58572976075203
curr_Factors:  [1.02585730e+02 3.94560896e-02]
mat_Sqrt:  [[ 2.03771749e+01  0.00000000e+00]
 [-7.94542279e-03  1.82052507e-02]]
grads:  [-0.00472583  0.36327381]
Stock Position:  -0.004725832870591734
Bond Position:  [-0.17966231]


portfolio before change:  [-0.66634345]
curr_Stock_Price:  102.9641323143227
curr_Factors:  [1.02964132e+02 3.91042682e-02]
mat_Sqrt:  [[ 2.03609504e+01  0.00000000e+00]
 [-7.90991966e-03  1.81239028e-02]]
grads:  [-1.67224263e-02 -2.45456204e+01]
Stock Position:  -0.016722426332672014
Bond Position:  [1.05546667]


portfolio before change:  [-0.62321075]
curr_Stock_Price:  100.4163662139632
curr_Factors:  [1.00416366e+02 3.65233632e-02]
mat_Sqrt:  [[ 1.91906587e+01  0.00000000e+00]
 [-7.64443465e-03  1.75156002e-02]]
grads:  [4.65492968e-03 7.57511714e+00]
Stock Position:  0.004654929683928563
Bond Position:  [-1.09064187]


portfolio before change:  [-0.63885417]
curr_Stock_Price:  97.17293204862261
curr_Factors:  [9.71729320e+01 3.80724657e-02]
mat_Sqrt:  [[ 1.89605447e+01  0.00000000e+00]
 [-7.80486676e-03  1.78831964e-02]]
grads:  [-1.83391515e-03 -5.71725403e+01]
Stock Position:  -0.0018339151513151043
Bond Position:  [-0.46064725]


portfolio before change:  [-0.64512666]
curr_Stock_Price:  100.46758682887247
curr_Factors:  [1.00467587e+02 3.76584158e-02]
mat_Sqrt:  [[ 1.94965153e+01  0.00000000e+00]
 [-7.76231056e-03  1.77856879e-02]]
grads:  [-0.03992118  9.68925232]
Stock Position:  -0.03992117831047323
Bond Position:  [3.36565778]


portfolio before change:  [-0.70533099]
curr_Stock_Price:  102.01783106027713
curr_Factors:  [1.02017831e+02 3.60865991e-02]
mat_Sqrt:  [[ 1.93797898e+01  0.00000000e+00]
 [-7.59858925e-03  1.74105552e-02]]
grads:  [5.13047416e-05 1.86367027e+00]
Stock Position:  5.130474163547888e-05
Bond Position:  [-0.71056499]


portfolio before change:  [-0.70570588]
curr_Stock_Price:  101.63743946856897
curr_Factors:  [1.01637439e+02 3.50072897e-02]
mat_Sqrt:  [[ 1.90166038e+01  0.00000000e+00]
 [-7.48409403e-03  1.71482137e-02]]
grads:  [-5.15367081e-04  2.29753761e+00]
Stock Position:  -0.0005153670813644652
Bond Position:  [-0.65332529]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.70639634]
Stock Price:  102.34318986310203
PL:  [-3.04958621]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.92489071e-01  3.13030825e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.12206396e-01 -5.22156106e-01]
 [-3.36329022e-02 -8.69458674e-02]
 [ 4.09889015e-01 -1.00562288e+00]
 [-1.01770099e+00  2.84359687e-01]
 [-5.36919170e-02  3.16273387e-03]
 [-3.39251716e-02  5.57045926e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.83347224]
curr_Stock_Price:  100.05972654782511
curr_Factors:  [1.00059727e+02 3.67306909e-02]
mat_Sqrt:  [[ 1.91766994e+01  0.00000000e+00]
 [-7.66610106e-03  1.75652442e-02]]
grads:  [-8.12815675e-03  1.78210346e+01]
Stock Position:  -0.008128156750988333
Bond Position:  [3.64677338]


portfolio before change:  [2.8420965]
curr_Stock_Price:  99.2230774293797
curr_Factors:  [9.92230774e+01 3.65729865e-02]
mat_Sqrt:  [[ 1.89754859e+01  0.00000000e+00]
 [-7.64962603e-03  1.75274952e-02]]
grads:  [ 0.00495163 -2.69730571]
Stock Position:  0.004951634519121206
Bond Position:  [2.35078008]


portfolio before change:  [2.82712427]
curr_Stock_Price:  95.96194966648372
curr_Factors:  [9.59619497e+01 3.56121848e-02]
mat_Sqrt:  [[ 1.81091628e+01  0.00000000e+00]
 [-7.54847638e-03  1.72957322e-02]]
grads:  [ 0.02224102 11.26895887]
Stock Position:  0.022241016156751635
Bond Position:  [0.692833]


portfolio before change:  [2.83236171]
curr_Stock_Price:  96.18185581864486
curr_Factors:  [9.61818558e+01 3.73392327e-02]
mat_Sqrt:  [[ 1.85855684e+01  0.00000000e+00]
 [-7.72934488e-03  1.77101540e-02]]
grads:  [-1.82988218e-02 -2.94834312e+01]
Stock Position:  -0.018298821794669122
Bond Position:  [4.59237635]


portfolio before change:  [2.81820581]
curr_Stock_Price:  97.08096651643038
curr_Factors:  [9.70809665e+01 3.77780548e-02]
mat_Sqrt:  [[ 1.88692174e+01  0.00000000e+00]
 [-7.77463104e-03  1.78139176e-02]]
grads:  [-3.79343712e-03 -4.88078307e+00]
Stock Position:  -0.0037934371218437133
Bond Position:  [3.18647635]


portfolio before change:  [2.81887364]
curr_Stock_Price:  97.32502041526207
curr_Factors:  [9.73250204e+01 3.76031339e-02]
mat_Sqrt:  [[ 1.88728081e+01  0.00000000e+00]
 [-7.75661100e-03  1.77726285e-02]]
grads:  [-1.53664431e-03 -5.65826762e+01]
Stock Position:  -0.0015366443095281858
Bond Position:  [2.96842758]


portfolio before change:  [2.82375192]
curr_Stock_Price:  95.11651148901456
curr_Factors:  [9.51165115e+01 3.87603555e-02]
mat_Sqrt:  [[ 1.87262057e+01  0.00000000e+00]
 [-7.87505993e-03  1.80440291e-02]]
grads:  [-0.04771902 15.75921237]
Stock Position:  -0.047719023417164
Bond Position:  [7.36261896]


portfolio before change:  [2.58853549]
curr_Stock_Price:  100.12287248744506
curr_Factors:  [1.00122872e+02 3.54908275e-02]
mat_Sqrt:  [[ 1.88621574e+01  0.00000000e+00]
 [-7.53560376e-03  1.72662373e-02]]
grads:  [-0.00277336  0.18317447]
Stock Position:  -0.0027733618054974563
Bond Position:  [2.86621244]


portfolio before change:  [2.5929426]
curr_Stock_Price:  99.05065650595871
curr_Factors:  [9.90506565e+01 3.70011477e-02]
mat_Sqrt:  [[ 1.90530697e+01  0.00000000e+00]
 [-7.69427296e-03  1.76297941e-02]]
grads:  [-0.00165296  0.31596848]
Stock Position:  -0.001652963240800845
Bond Position:  [2.75666969]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.59569598]
Stock Price:  98.21899707066665
PL:  [2.59569598]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.89494202e-01  3.60039340e-01]
 [ 8.01755582e-02  5.14475617e-02]
 [-9.91516922e-02  6.85407677e-03]
 [-1.63061996e-01 -4.10611019e-01]
 [ 2.96669275e-02  1.27471078e-01]
 [ 3.71013344e-01 -7.34581609e-01]
 [-8.72151084e-01  1.81488337e-01]
 [-6.59582351e-02 -4.97751086e-03]
 [-2.70695431e-02  4.28291761e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.70826639]
curr_Stock_Price:  101.24576533432707
curr_Factors:  [1.01245765e+02 3.95751610e-02]
mat_Sqrt:  [[ 2.01413331e+01  0.00000000e+00]
 [-7.95740269e-03  1.82327001e-02]]
grads:  [-1.60665392e-03  1.97469019e+01]
Stock Position:  -0.00160665391761022
Bond Position:  [10.8709333]


portfolio before change:  [10.71226612]
curr_Stock_Price:  102.14023149397835
curr_Factors:  [1.02140231e+02 3.92850280e-02]
mat_Sqrt:  [[ 2.02446546e+01  0.00000000e+00]
 [-7.92818043e-03  1.81657435e-02]]
grads:  [0.00506944 2.8321198 ]
Stock Position:  0.005069442622002198
Bond Position:  [10.19447208]


portfolio before change:  [10.72034328]
curr_Stock_Price:  102.72780138259225
curr_Factors:  [1.02727801e+02 3.91584138e-02]
mat_Sqrt:  [[ 2.03282755e+01  0.00000000e+00]
 [-7.91539399e-03  1.81364461e-02]]
grads:  [-0.00473037  0.3779173 ]
Stock Position:  -0.004730373102579244
Bond Position:  [11.20628411]


portfolio before change:  [10.73576652]
curr_Stock_Price:  100.65213151569912
curr_Factors:  [1.00652132e+02 3.89388135e-02]
mat_Sqrt:  [[ 1.98616047e+01  0.00000000e+00]
 [-7.89316803e-03  1.80855200e-02]]
grads:  [-1.72326125e-02 -2.27038547e+01]
Stock Position:  -0.017232612459598232
Bond Position:  [12.4702657]


portfolio before change:  [10.74728372]
curr_Stock_Price:  100.34570605766429
curr_Factors:  [1.00345706e+02 4.05579245e-02]
mat_Sqrt:  [[ 2.02086198e+01  0.00000000e+00]
 [-8.05559924e-03  1.84576966e-02]]
grads:  [4.22096451e-03 6.90612056e+00]
Stock Position:  0.0042209645056323465
Bond Position:  [10.32372806]


portfolio before change:  [10.75074985]
curr_Stock_Price:  99.94365849359723
curr_Factors:  [9.99436585e+01 3.98395475e-02]
mat_Sqrt:  [[ 1.99486009e+01  0.00000000e+00]
 [-7.98393863e-03  1.82935016e-02]]
grads:  [ 2.52727730e-03 -4.01553309e+01]
Stock Position:  0.00252727730034427
Bond Position:  [10.49816451]


portfolio before change:  [10.75664572]
curr_Stock_Price:  100.19906103230466
curr_Factors:  [1.00199061e+02 3.84184140e-02]
mat_Sqrt:  [[ 1.96396330e+01  0.00000000e+00]
 [-7.84024632e-03  1.79642611e-02]]
grads:  [-0.04037464 10.1027443 ]
Stock Position:  -0.04037463839841392
Bond Position:  [14.80214657]


portfolio before change:  [10.7952762]
curr_Stock_Price:  99.42561605399054
curr_Factors:  [9.94256161e+01 4.07125414e-02]
mat_Sqrt:  [[ 2.00614536e+01  0.00000000e+00]
 [-8.07093962e-03  1.84928459e-02]]
grads:  [-0.00339609 -0.26915873]
Stock Position:  -0.0033960948348651585
Bond Position:  [11.13293502]


portfolio before change:  [10.79302379]
curr_Stock_Price:  101.72834183269649
curr_Factors:  [1.01728342e+02 3.82597274e-02]
mat_Sqrt:  [[ 1.98981592e+01  0.00000000e+00]
 [-7.82403757e-03  1.79271222e-02]]
grads:  [-4.21011717e-04  2.38907146e+00]
Stock Position:  -0.00042101171699092334
Bond Position:  [10.83585261]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.79741995]
Stock Price:  104.1584723797079
PL:  [6.63894757]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.80363363e-01  1.87775538e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.83794340e-02  1.23518221e-02]
 [-1.47588753e-01 -4.42181571e-01]
 [ 7.55155737e-02  2.65861174e-01]
 [ 3.10180209e-01 -6.01843712e-01]
 [-6.99649979e-01  1.08928529e-01]
 [-2.75331997e-02  2.05223327e-02]
 [-3.57200233e-02  2.31545945e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.6967364]
curr_Stock_Price:  96.96763000886915
curr_Factors:  [9.69676300e+01 3.98678236e-02]
mat_Sqrt:  [[ 1.93614574e+01  0.00000000e+00]
 [-7.98677143e-03  1.82999923e-02]]
grads:  [-0.04640205 10.26096268]
Stock Position:  -0.046402054367177335
Bond Position:  [-13.19723916]


portfolio before change:  [-17.8962186]
curr_Stock_Price:  101.12438409350878
curr_Factors:  [1.01124384e+02 3.91392270e-02]
mat_Sqrt:  [[ 2.00060805e+01  0.00000000e+00]
 [-7.91345456e-03  1.81320023e-02]]
grads:  [ 0.00469656 -2.6073796 ]
Stock Position:  0.004696555687884505
Bond Position:  [-18.3711549]


portfolio before change:  [-17.88264059]
curr_Stock_Price:  105.97174061186115
curr_Factors:  [1.05971741e+02 3.61548267e-02]
mat_Sqrt:  [[ 2.01499146e+01  0.00000000e+00]
 [-7.60576904e-03  1.74270062e-02]]
grads:  [-0.00461484  0.70877476]
Stock Position:  -0.004614841243043668
Bond Position:  [-17.39359783]


portfolio before change:  [-17.8766669]
curr_Stock_Price:  102.7922890145349
curr_Factors:  [1.02792289e+02 3.58435502e-02]
mat_Sqrt:  [[ 1.94610401e+01  0.00000000e+00]
 [-7.57295718e-03  1.73518247e-02]]
grads:  [-1.75002266e-02 -2.54832894e+01]
Stock Position:  -0.01750022663662977
Bond Position:  [-16.07777855]


portfolio before change:  [-17.87450654]
curr_Stock_Price:  102.20936764066435
curr_Factors:  [1.02209368e+02 3.67523555e-02]
mat_Sqrt:  [[ 1.95944596e+01  0.00000000e+00]
 [-7.66836155e-03  1.75704236e-02]]
grads:  [9.77556443e-03 1.51311761e+01]
Stock Position:  0.009775564431484652
Bond Position:  [-18.8736608]


portfolio before change:  [-17.88378368]
curr_Stock_Price:  102.2259445182453
curr_Factors:  [1.02225945e+02 3.99106410e-02]
mat_Sqrt:  [[ 2.04223391e+01  0.00000000e+00]
 [-7.99105911e-03  1.83098166e-02]]
grads:  [ 2.32657378e-03 -3.28700022e+01]
Stock Position:  0.0023265737791336154
Bond Position:  [-18.12161989]


portfolio before change:  [-17.89151669]
curr_Stock_Price:  102.79763297071489
curr_Factors:  [1.02797633e+02 3.68616171e-02]
mat_Sqrt:  [[ 1.97365076e+01  0.00000000e+00]
 [-7.67975178e-03  1.75965219e-02]]
grads:  [-0.03304078  6.1903443 ]
Stock Position:  -0.03304078332145649
Bond Position:  [-14.49500237]


portfolio before change:  [-17.852562]
curr_Stock_Price:  101.3992399784966
curr_Factors:  [1.01399240e+02 3.53405237e-02]
mat_Sqrt:  [[ 1.90621196e+01  0.00000000e+00]
 [-7.51963017e-03  1.72296372e-02]]
grads:  [-9.74525383e-04  1.19110649e+00]
Stock Position:  -0.0009745253831936072
Bond Position:  [-17.75374587]


portfolio before change:  [-17.85867299]
curr_Stock_Price:  98.55877570838196
curr_Factors:  [9.85587757e+01 3.72346233e-02]
mat_Sqrt:  [[ 1.90181725e+01  0.00000000e+00]
 [-7.71851004e-03  1.76853283e-02]]
grads:  [-0.00182507  0.13092544]
Stock Position:  -0.0018250688334929183
Bond Position:  [-17.67879644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.86740218]
Stock Price:  98.49718218296684
PL:  [-17.86740218]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.73530101e-01  3.28619768e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 1.71887491e-03 -5.49993594e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.92328519e-01 -1.85508265e+00]
 [-7.53664511e-01  3.74149353e-01]
 [ 1.21260755e-01  6.06328247e-02]
 [-6.45365541e-03 -1.86324812e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.92517824]
curr_Stock_Price:  100.22415061114454
curr_Factors:  [1.00224151e+02 4.26888343e-02]
mat_Sqrt:  [[ 2.07075888e+01  0.00000000e+00]
 [-8.26451057e-03  1.89363726e-02]]
grads:  [-6.28313982e-03  1.73538921e+01]
Stock Position:  -0.006283139816501787
Bond Position:  [4.55490059]


portfolio before change:  [3.94676921]
curr_Stock_Price:  97.15037555307418
curr_Factors:  [9.71503756e+01 4.28307416e-02]
mat_Sqrt:  [[ 2.01058427e+01  0.00000000e+00]
 [-8.27823571e-03  1.89678209e-02]]
grads:  [ 0.00467325 -2.4924852 ]
Stock Position:  0.004673252066578902
Bond Position:  [3.49276102]


portfolio before change:  [3.93951483]
curr_Stock_Price:  95.22426557253938
curr_Factors:  [9.52242656e+01 4.44159436e-02]
mat_Sqrt:  [[ 2.00686001e+01  0.00000000e+00]
 [-8.43003617e-03  1.93156394e-02]]
grads:  [ 0.02006947 10.09052253]
Stock Position:  0.02006947071786181
Bond Position:  [2.02841422]


portfolio before change:  [3.90554555]
curr_Stock_Price:  93.48113317162753
curr_Factors:  [9.34811332e+01 4.47121677e-02]
mat_Sqrt:  [[ 1.97668211e+01  0.00000000e+00]
 [-8.45810075e-03  1.93799435e-02]]
grads:  [-1.20564661e-02 -2.83795252e+01]
Stock Position:  -0.012056466129903512
Bond Position:  [5.03259767]


portfolio before change:  [3.93929559]
curr_Stock_Price:  90.8905634901794
curr_Factors:  [9.08905635e+01 4.38472927e-02]
mat_Sqrt:  [[ 1.90322524e+01  0.00000000e+00]
 [-8.37589806e-03  1.91915934e-02]]
grads:  [-3.70251499e-03 -4.43918309e+00]
Stock Position:  -0.0037025149927349195
Bond Position:  [4.27581927]


portfolio before change:  [3.94555333]
curr_Stock_Price:  89.77799625028182
curr_Factors:  [8.97779963e+01 4.38249077e-02]
mat_Sqrt:  [[ 1.87944843e+01  0.00000000e+00]
 [-8.37375975e-03  1.91866940e-02]]
grads:  [-1.68823958e-02 -9.66858933e+01]
Stock Position:  -0.016882395802291318
Bond Position:  [5.461221]


portfolio before change:  [3.96004854]
curr_Stock_Price:  89.08118091709926
curr_Factors:  [8.90811809e+01 4.46916490e-02]
mat_Sqrt:  [[ 1.88321175e+01  0.00000000e+00]
 [-8.45615979e-03  1.93754962e-02]]
grads:  [-0.03134923 19.31043983]
Stock Position:  -0.0313492280365172
Bond Position:  [6.75267479]


portfolio before change:  [3.93568833]
curr_Stock_Price:  89.9659681304616
curr_Factors:  [8.99659681e+01 4.41526290e-02]
mat_Sqrt:  [[ 1.89041233e+01  0.00000000e+00]
 [-8.40501079e-03  1.92582991e-02]]
grads:  [0.00781433 3.14839979]
Stock Position:  0.007814331635544661
Bond Position:  [3.23266441]


portfolio before change:  [3.94700285]
curr_Stock_Price:  91.20699378985438
curr_Factors:  [9.12069938e+01 4.53900376e-02]
mat_Sqrt:  [[ 1.94315933e+01  0.00000000e+00]
 [-8.52197513e-03  1.95262981e-02]]
grads:  [-4.51699810e-03 -9.54224971e+00]
Stock Position:  -0.004516998101873422
Bond Position:  [4.35898467]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.955225]
Stock Price:  89.86935540131412
PL:  [3.955225]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.60152617e-01 -2.94684321e-01]
 [ 1.10369887e-02  2.30848560e-01]
 [-9.91123863e-02  7.13389743e-03]
 [-1.54384979e-01 -4.28506832e-01]
 [ 7.66313631e-02  2.69218066e-01]
 [ 2.89590775e-01 -6.08867260e-01]
 [-9.41109879e-01  2.15424955e-01]
 [-4.40608157e-02  1.96130881e-02]
 [-3.60488761e-02 -1.08898886e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.33016307]
curr_Stock_Price:  102.69493879089006
curr_Factors:  [1.02694939e+02 4.09959394e-02]
mat_Sqrt:  [[ 2.07931105e+01  0.00000000e+00]
 [-8.09898160e-03  1.85570981e-02]]
grads:  [ 1.11355074e-02 -1.58798708e+01]
Stock Position:  0.011135507387697557
Bond Position:  [19.18660282]


portfolio before change:  [20.34020349]
curr_Stock_Price:  102.73487564707797
curr_Factors:  [1.02734876e+02 4.08729734e-02]
mat_Sqrt:  [[ 2.07699770e+01  0.00000000e+00]
 [-8.08682617e-03  1.85292465e-02]]
grads:  [5.38217062e-03 1.24586048e+01]
Stock Position:  0.005382170616927948
Bond Position:  [19.78726686]


portfolio before change:  [20.3509402]
curr_Stock_Price:  102.89105834990134
curr_Factors:  [1.02891058e+02 4.17030092e-02]
mat_Sqrt:  [[ 2.10117068e+01  0.00000000e+00]
 [-8.16852586e-03  1.87164440e-02]]
grads:  [-0.00456883  0.38115667]
Stock Position:  -0.004568829140466605
Bond Position:  [20.82103186]


portfolio before change:  [20.36611607]
curr_Stock_Price:  101.84861421145455
curr_Factors:  [1.01848614e+02 4.31218156e-02]
mat_Sqrt:  [[ 2.11496723e+01  0.00000000e+00]
 [-8.30631717e-03  1.90321636e-02]]
grads:  [-1.61421268e-02 -2.25148775e+01]
Stock Position:  -0.016142126818231663
Bond Position:  [22.01016931]


portfolio before change:  [20.37053677]
curr_Stock_Price:  102.25668493130837
curr_Factors:  [1.02256685e+02 4.06045365e-02]
mat_Sqrt:  [[ 2.06053022e+01  0.00000000e+00]
 [-8.06022695e-03  1.84683001e-02]]
grads:  [9.42125274e-03 1.45773062e+01]
Stock Position:  0.009421252741740242
Bond Position:  [19.4071507]


portfolio before change:  [20.38485967]
curr_Stock_Price:  102.74673548376565
curr_Factors:  [1.02746735e+02 4.02268326e-02]
mat_Sqrt:  [[ 2.06075305e+01  0.00000000e+00]
 [-8.02265120e-03  1.83822032e-02]]
grads:  [ 1.15779606e-03 -3.31226488e+01]
Stock Position:  0.0011577960616962965
Bond Position:  [20.2658999]


portfolio before change:  [20.39088672]
curr_Stock_Price:  99.19824407643313
curr_Factors:  [9.91982441e+01 4.48531410e-02]
mat_Sqrt:  [[ 2.10087598e+01  0.00000000e+00]
 [-8.47142406e-03  1.94104710e-02]]
grads:  [-0.04032083 11.09838886]
Stock Position:  -0.04032083421401173
Bond Position:  [24.39064267]


portfolio before change:  [20.49728108]
curr_Stock_Price:  96.86208245384765
curr_Factors:  [9.68620825e+01 4.69381566e-02]
mat_Sqrt:  [[ 2.09853790e+01  0.00000000e+00]
 [-8.66608623e-03  1.98564981e-02]]
grads:  [-0.0016917   0.98774155]
Stock Position:  -0.001691699842035038
Bond Position:  [20.66114265]


portfolio before change:  [20.50860462]
curr_Stock_Price:  96.2766392129777
curr_Factors:  [9.62766392e+01 4.80909335e-02]
mat_Sqrt:  [[ 2.11131253e+01  0.00000000e+00]
 [-8.77185804e-03  2.00988517e-02]]
grads:  [-3.95849716e-03 -5.41816456e+00]
Stock Position:  -0.003958497157348733
Bond Position:  [20.88971543]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.52654286]
Stock Price:  94.38431436256928
PL:  [20.52654286]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.96923770e-01  3.09428751e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-3.53919638e-02  2.44407443e-02]
 [-1.52714915e-01 -4.12532361e-01]
 [ 1.77502906e-02  9.19382176e-02]
 [ 3.45689640e-01 -6.54923530e-01]
 [-8.40625878e-01  1.65969353e-01]
 [-2.07609352e-02  2.50165819e-02]
 [-2.96318328e-02  1.33490482e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.62448615]
curr_Stock_Price:  100.02825072671568
curr_Factors:  [1.00028251e+02 3.81266333e-02]
mat_Sqrt:  [[ 1.95315587e+01  0.00000000e+00]
 [-7.81041697e-03  1.78959135e-02]]
grads:  [-8.28802218e-03  1.72904697e+01]
Stock Position:  -0.008288022179794735
Bond Position:  [3.45352251]


portfolio before change:  [2.61598616]
curr_Stock_Price:  101.26222221006348
curr_Factors:  [1.01262222e+02 3.57246025e-02]
mat_Sqrt:  [[ 1.91395251e+01  0.00000000e+00]
 [-7.56038121e-03  1.73230096e-02]]
grads:  [ 0.0049092  -2.72914545]
Stock Position:  0.004909195538836309
Bond Position:  [2.11887011]


portfolio before change:  [2.61552264]
curr_Stock_Price:  100.95194409682584
curr_Factors:  [1.00951944e+02 3.66464173e-02]
mat_Sqrt:  [[ 1.93254871e+01  0.00000000e+00]
 [-7.65730159e-03  1.75450821e-02]]
grads:  [-1.27940623e-03  1.39302536e+00]
Stock Position:  -0.001279406227449574
Bond Position:  [2.74468119]


portfolio before change:  [2.61881743]
curr_Stock_Price:  99.44960508532348
curr_Factors:  [9.94496051e+01 3.66219126e-02]
mat_Sqrt:  [[ 1.90315243e+01  0.00000000e+00]
 [-7.65474103e-03  1.75392151e-02]]
grads:  [-1.74846109e-02 -2.35205714e+01]
Stock Position:  -0.01748461092383504
Bond Position:  [4.35765508]


portfolio before change:  [2.61318989]
curr_Stock_Price:  99.89610700691674
curr_Factors:  [9.98961070e+01 3.54961513e-02]
mat_Sqrt:  [[ 1.88208484e+01  0.00000000e+00]
 [-7.53616893e-03  1.72675323e-02]]
grads:  [3.07506957e-03 5.32434028e+00]
Stock Position:  0.0030750695734206974
Bond Position:  [2.30600241]


portfolio before change:  [2.61798503]
curr_Stock_Price:  101.08042343966851
curr_Factors:  [1.01080423e+02 3.40852322e-02]
mat_Sqrt:  [[ 1.86616561e+01  0.00000000e+00]
 [-7.38487451e-03  1.69208732e-02]]
grads:  [ 3.20751694e-03 -3.87050669e+01]
Stock Position:  0.0032075169403617274
Bond Position:  [2.29376786]


portfolio before change:  [2.61778011]
curr_Stock_Price:  100.65888324743453
curr_Factors:  [1.00658883e+02 3.41266601e-02]
mat_Sqrt:  [[ 1.85951207e+01  0.00000000e+00]
 [-7.38936102e-03  1.69311531e-02]]
grads:  [-0.04131142  9.80260189]
Stock Position:  -0.04131142389094927
Bond Position:  [6.7761419]


portfolio before change:  [2.57765879]
curr_Stock_Price:  101.71210855318358
curr_Factors:  [1.01712109e+02 3.60752658e-02]
mat_Sqrt:  [[ 1.93186790e+01  0.00000000e+00]
 [-7.59739595e-03  1.74078210e-02]]
grads:  [-5.09496728e-04  1.43708864e+00]
Stock Position:  -0.0005094967276819867
Bond Position:  [2.62948077]


portfolio before change:  [2.57973023]
curr_Stock_Price:  100.22756543690316
curr_Factors:  [1.00227565e+02 3.59794311e-02]
mat_Sqrt:  [[ 1.90114100e+01  0.00000000e+00]
 [-7.58729792e-03  1.73846835e-02]]
grads:  [-0.00125219  0.76786259]
Stock Position:  -0.0012521864793998848
Bond Position:  [2.70523383]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.57991924]
Stock Price:  101.15709145072911
PL:  [1.42282779]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.08020578e-01  2.84592421e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 2.84147648e-01  1.80248121e-01]
 [-1.38173444e-01 -4.44743729e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.06944517e-01 -9.92581249e-01]
 [-9.72881657e-01  3.02174681e-01]
 [ 3.04304289e-02  1.22760320e-01]
 [-4.82368864e-02 -1.97862558e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.42856157]
curr_Stock_Price:  99.11658888162944
curr_Factors:  [9.91165889e+01 4.21120405e-02]
mat_Sqrt:  [[ 2.03399317e+01  0.00000000e+00]
 [-8.20848736e-03  1.88080073e-02]]
grads:  [-0.01886999 15.1314499 ]
Stock Position:  -0.018869987824643053
Bond Position:  [-1.55823274]


portfolio before change:  [-3.38330105]
curr_Stock_Price:  96.67674501542263
curr_Factors:  [9.66767450e+01 4.60683801e-02]
mat_Sqrt:  [[ 2.07502575e+01  0.00000000e+00]
 [-8.58541834e-03  1.96716647e-02]]
grads:  [ 0.00452812 -2.40330514]
Stock Position:  0.004528120723795463
Bond Position:  [-3.82106503]


portfolio before change:  [-3.38235549]
curr_Stock_Price:  97.30759654792132
curr_Factors:  [9.73075965e+01 4.49671673e-02]
mat_Sqrt:  [[ 2.06345267e+01  0.00000000e+00]
 [-8.48218532e-03  1.94351281e-02]]
grads:  [0.01758288 9.27434695]
Stock Position:  0.017582878616212792
Bond Position:  [-5.09330315]


portfolio before change:  [-3.36609981]
curr_Stock_Price:  98.37698758748941
curr_Factors:  [9.83769876e+01 4.28370297e-02]
mat_Sqrt:  [[ 2.03611918e+01  0.00000000e+00]
 [-8.27884337e-03  1.89692132e-02]]
grads:  [-1.63190605e-02 -2.34455549e+01]
Stock Position:  -0.01631906050228506
Bond Position:  [-1.76067979]


portfolio before change:  [-3.31821619]
curr_Stock_Price:  95.38881424180079
curr_Factors:  [9.53888142e+01 4.59838955e-02]
mat_Sqrt:  [[ 2.04550398e+01  0.00000000e+00]
 [-8.57754235e-03  1.96536185e-02]]
grads:  [-3.44497983e-03 -4.33482500e+00]
Stock Position:  -0.003444979832649234
Bond Position:  [-2.98960364]


portfolio before change:  [-3.32654342]
curr_Stock_Price:  97.37200773302973
curr_Factors:  [9.73720077e+01 4.60699699e-02]
mat_Sqrt:  [[ 2.08998461e+01  0.00000000e+00]
 [-8.58556648e-03  1.96720041e-02]]
grads:  [-1.25615541e-03 -5.04565392e+01]
Stock Position:  -0.001256155414303554
Bond Position:  [-3.20422905]


portfolio before change:  [-3.32362527]
curr_Stock_Price:  93.77319589342517
curr_Factors:  [9.37731959e+01 4.98892454e-02]
mat_Sqrt:  [[ 2.09450878e+01  0.00000000e+00]
 [-8.93436023e-03  2.04711910e-02]]
grads:  [-0.0401527  14.76097219]
Stock Position:  -0.04015269940621921
Bond Position:  [0.44162168]


portfolio before change:  [-3.2514397]
curr_Stock_Price:  91.98092022342318
curr_Factors:  [9.19809202e+01 5.13407533e-02]
mat_Sqrt:  [[ 2.08414950e+01  0.00000000e+00]
 [-9.06339921e-03  2.07668565e-02]]
grads:  [4.03077731e-03 5.91135787e+00]
Stock Position:  0.004030777310467157
Bond Position:  [-3.6221943]


portfolio before change:  [-3.25151427]
curr_Stock_Price:  92.41184985349787
curr_Factors:  [9.24118499e+01 4.51986427e-02]
mat_Sqrt:  [[ 1.96467338e+01  0.00000000e+00]
 [-8.50398897e-03  1.94850866e-02]]
grads:  [-6.85056293e-03 -1.01545639e+01]
Stock Position:  -0.00685056293039565
Bond Position:  [-2.61844107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.25459642]
Stock Price:  92.67060333629647
PL:  [-3.25459642]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.10930175e-01  2.84979623e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.32331277e-02  5.71823678e-02]
 [-1.64385097e-01 -4.07836191e-01]
 [ 8.61823424e-02  2.98642504e-01]
 [ 2.85529156e-01 -6.13547188e-01]
 [-6.85794953e-01  1.03694487e-01]
 [ 1.10678738e-01 -1.66382460e-01]
 [-4.57583773e-02  2.39779908e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.51607758]
curr_Stock_Price:  99.10340791697168
curr_Factors:  [9.91034079e+01 4.03981519e-02]
mat_Sqrt:  [[ 1.99190828e+01  0.00000000e+00]
 [-8.03971660e-03  1.84213049e-02]]
grads:  [-0.01940626 15.4701105 ]
Stock Position:  -0.019406258517959553
Bond Position:  [-1.59285122]


portfolio before change:  [-3.53417362]
curr_Stock_Price:  99.99484313083381
curr_Factors:  [9.99948431e+01 3.86094149e-02]
mat_Sqrt:  [[ 1.96482653e+01  0.00000000e+00]
 [-7.85971144e-03  1.80088613e-02]]
grads:  [ 0.00478208 -2.62520834]
Stock Position:  0.004782084806682117
Bond Position:  [-4.01235744]


portfolio before change:  [-3.53766298]
curr_Stock_Price:  99.68479542459716
curr_Factors:  [9.96847954e+01 3.58207660e-02]
mat_Sqrt:  [[ 1.88667179e+01  0.00000000e+00]
 [-7.57054988e-03  1.73463089e-02]]
grads:  [0.00520438 3.29651501]
Stock Position:  0.005204379453564578
Bond Position:  [-4.05646048]


portfolio before change:  [-3.53560226]
curr_Stock_Price:  100.47056688264298
curr_Factors:  [1.00470567e+02 3.68812379e-02]
mat_Sqrt:  [[ 1.92948585e+01  0.00000000e+00]
 [-7.68179541e-03  1.76012045e-02]]
grads:  [-1.77445926e-02 -2.31709252e+01]
Stock Position:  -0.017744592636328358
Bond Position:  [-1.75279298]


portfolio before change:  [-3.57492749]
curr_Stock_Price:  102.63734588979551
curr_Factors:  [1.02637346e+02 3.84582790e-02]
mat_Sqrt:  [[ 2.01279867e+01  0.00000000e+00]
 [-7.84431300e-03  1.79735790e-02]]
grads:  [1.07571920e-02 1.66156392e+01]
Stock Position:  0.010757191987405152
Bond Position:  [-4.67901712]


portfolio before change:  [-3.57474757]
curr_Stock_Price:  102.87160887433365
curr_Factors:  [1.02871609e+02 3.71662431e-02]
mat_Sqrt:  [[ 1.98321530e+01  0.00000000e+00]
 [-7.71141939e-03  1.76690815e-02]]
grads:  [ 8.95273963e-04 -3.47243396e+01]
Stock Position:  0.0008952739630891629
Bond Position:  [-3.66684584]


portfolio before change:  [-3.57645487]
curr_Stock_Price:  103.01300248010823
curr_Factors:  [1.03013002e+02 3.29609559e-02]
mat_Sqrt:  [[ 1.87021676e+01  0.00000000e+00]
 [-7.26206097e-03  1.66394720e-02]]
grads:  [-0.03424945  6.23183757]
Stock Position:  -0.03424945073760208
Bond Position:  [-0.04831611]


portfolio before change:  [-3.66537464]
curr_Stock_Price:  105.60853635012978
curr_Factors:  [1.05608536e+02 3.13007501e-02]
mat_Sqrt:  [[ 1.86842813e+01  0.00000000e+00]
 [-7.07680720e-03  1.62150023e-02]]
grads:  [ 2.03719258e-03 -1.02610198e+01]
Stock Position:  0.00203719257895971
Bond Position:  [-3.88051957]


portfolio before change:  [-3.66284869]
curr_Stock_Price:  107.80111032796798
curr_Factors:  [1.0780111e+02 2.9586378e-02]
mat_Sqrt:  [[ 1.85425362e+01  0.00000000e+00]
 [-6.88027651e-03  1.57646939e-02]]
grads:  [3.17594926e-03 1.52099310e+01]
Stock Position:  0.0031759492555108364
Bond Position:  [-4.00521955]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.66329306]
Stock Price:  108.29190521468462
PL:  [-11.95519828]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.11738289e+00 -8.82658482e-03]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.25372467e-01 -4.83253912e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.06032768e-01 -9.70332892e-01]
 [-1.07193839e+00  2.64924874e-01]
 [-2.31135676e-03  6.96398411e-02]
 [-4.87287762e-02 -1.97469509e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.67327473]
curr_Stock_Price:  95.61565528710331
curr_Factors:  [9.56156553e+01 4.11619875e-02]
mat_Sqrt:  [[ 1.93989031e+01  0.00000000e+00]
 [-8.11536691e-03  1.85946416e-02]]
grads:  [-0.05779889 -0.47468432]
Stock Position:  -0.05779889298188307
Bond Position:  [-21.1467957]


portfolio before change:  [-26.73134022]
curr_Stock_Price:  96.43728770812814
curr_Factors:  [9.64372877e+01 4.26200311e-02]
mat_Sqrt:  [[ 1.99091110e+01  0.00000000e+00]
 [-8.25784776e-03  1.89211062e-02]]
grads:  [ 0.00471943 -2.49863894]
Stock Position:  0.00471943076466958
Bond Position:  [-27.18646932]


portfolio before change:  [-26.74291533]
curr_Stock_Price:  96.86562839156106
curr_Factors:  [9.68656284e+01 4.02622872e-02]
mat_Sqrt:  [[ 1.94365384e+01  0.00000000e+00]
 [-8.02618587e-03  1.83903021e-02]]
grads:  [ 0.02072211 10.59824321]
Stock Position:  0.020722114834192864
Bond Position:  [-28.750176]


portfolio before change:  [-26.7485616]
curr_Stock_Price:  97.28703367958924
curr_Factors:  [9.72870337e+01 3.87742249e-02]
mat_Sqrt:  [[ 1.91569570e+01  0.00000000e+00]
 [-7.87646874e-03  1.80472571e-02]]
grads:  [-1.75540283e-02 -2.67771390e+01]
Stock Position:  -0.01755402830864831
Bond Position:  [-25.04078226]


portfolio before change:  [-26.75108268]
curr_Stock_Price:  96.7172245385705
curr_Factors:  [9.67172245e+01 4.27076996e-02]
mat_Sqrt:  [[ 1.99874281e+01  0.00000000e+00]
 [-8.26633652e-03  1.89405564e-02]]
grads:  [-3.52557614e-03 -4.49801977e+00]
Stock Position:  -0.0035255761422913466
Bond Position:  [-26.41009874]


portfolio before change:  [-26.76747685]
curr_Stock_Price:  97.62085511044289
curr_Factors:  [9.76208551e+01 3.95447795e-02]
mat_Sqrt:  [[ 1.94127556e+01  0.00000000e+00]
 [-7.95434769e-03  1.82257002e-02]]
grads:  [-8.99162655e-04 -5.32398142e+01]
Stock Position:  -0.0008991626549924507
Bond Position:  [-26.67969982]


portfolio before change:  [-26.77992846]
curr_Stock_Price:  96.62929528878375
curr_Factors:  [9.66292953e+01 3.90281170e-02]
mat_Sqrt:  [[ 1.90896344e+01  0.00000000e+00]
 [-7.90221407e-03  1.81062471e-02]]
grads:  [-0.05009607 14.63168338]
Stock Position:  -0.0500960718405502
Bond Position:  [-21.93918034]


portfolio before change:  [-26.65232867]
curr_Stock_Price:  93.86316773257445
curr_Factors:  [9.38631677e+01 4.11218859e-02]
mat_Sqrt:  [[ 1.90340725e+01  0.00000000e+00]
 [-8.11141279e-03  1.85855816e-02]]
grads:  [1.47535225e-03 3.74698208e+00]
Stock Position:  0.0014753522492290763
Bond Position:  [-26.7908099]


portfolio before change:  [-26.66796559]
curr_Stock_Price:  92.34612678860901
curr_Factors:  [9.23461268e+01 4.03606855e-02]
mat_Sqrt:  [[ 1.85523083e+01  0.00000000e+00]
 [-8.03598761e-03  1.84127608e-02]]
grads:  [-7.27195417e-03 -1.07246008e+01]
Stock Position:  -0.007271954173002825
Bond Position:  [-25.99642879]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.68678006]
Stock Price:  93.14550028142656
PL:  [-26.68678006]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 4.22474255e-01 -2.65858595e-01]
 [ 9.96953096e-03  2.30826124e-01]
 [-9.87375157e-02  9.80262031e-03]
 [-1.54173794e-01 -4.28834768e-01]
 [ 1.12465832e-01  4.16861636e-01]
 [ 2.38307604e-01 -6.29421561e-01]
 [-6.92486649e-01  1.06221397e-01]
 [ 1.21301021e-01 -1.83267997e-01]
 [-3.15966338e-02  1.02890021e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.86626203]
curr_Stock_Price:  103.67935396744517
curr_Factors:  [1.03679354e+02 3.81406157e-02]
mat_Sqrt:  [[ 2.02481865e+01  0.00000000e+00]
 [-7.81184902e-03  1.78991947e-02]]
grads:  [  0.01513439 -14.85310371]
Stock Position:  0.015134394940018333
Bond Position:  [25.29713774]


portfolio before change:  [26.86522269]
curr_Stock_Price:  102.77472089998771
curr_Factors:  [1.02774721e+02 3.89061832e-02]
mat_Sqrt:  [[ 2.02719544e+01  0.00000000e+00]
 [-7.88986015e-03  1.80779407e-02]]
grads:  [5.46125493e-03 1.27683860e+01]
Stock Position:  0.005461254925782876
Bond Position:  [26.30394374]


portfolio before change:  [26.88761929]
curr_Stock_Price:  104.46688503096613
curr_Factors:  [1.04466885e+02 3.85699799e-02]
mat_Sqrt:  [[ 2.05165036e+01  0.00000000e+00]
 [-7.85569652e-03  1.79996620e-02]]
grads:  [-0.00460406  0.54460024]
Stock Position:  -0.00460406427816465
Bond Position:  [27.36859154]


portfolio before change:  [26.91321815]
curr_Stock_Price:  101.87979123748869
curr_Factors:  [1.01879791e+02 3.99028862e-02]
mat_Sqrt:  [[ 2.03512084e+01  0.00000000e+00]
 [-7.99028271e-03  1.83080377e-02]]
grads:  [-1.67721063e-02 -2.34233060e+01]
Stock Position:  -0.016772106318923542
Bond Position:  [28.62195684]


portfolio before change:  [26.89256497]
curr_Stock_Price:  103.9646658944783
curr_Factors:  [1.03964666e+02 3.99240733e-02]
mat_Sqrt:  [[ 2.07731896e+01  0.00000000e+00]
 [-7.99240372e-03  1.83128975e-02]]
grads:  [1.41720733e-02 2.27632812e+01]
Stock Position:  0.014172073341041402
Bond Position:  [25.4191701]


portfolio before change:  [26.90669205]
curr_Stock_Price:  104.06446235695614
curr_Factors:  [1.04064462e+02 3.81132717e-02]
mat_Sqrt:  [[ 2.03161102e+01  0.00000000e+00]
 [-7.80904826e-03  1.78927774e-02]]
grads:  [-1.79141015e-03 -3.51774097e+01]
Stock Position:  -0.0017914101473751791
Bond Position:  [27.09311419]


portfolio before change:  [26.92233261]
curr_Stock_Price:  102.89744226370763
curr_Factors:  [1.02897442e+02 3.95887743e-02]
mat_Sqrt:  [[ 2.04734300e+01  0.00000000e+00]
 [-7.95877119e-03  1.82358357e-02]]
grads:  [-0.03155933  5.82487138]
Stock Position:  -0.03155933479513946
Bond Position:  [30.16970744]


portfolio before change:  [26.84292062]
curr_Stock_Price:  105.8918213729269
curr_Factors:  [1.05891821e+02 3.78600811e-02]
mat_Sqrt:  [[ 2.06040781e+01  0.00000000e+00]
 [-7.78306686e-03  1.78332465e-02]]
grads:  [ 2.00524915e-03 -1.02767601e+01]
Stock Position:  0.002005249151549711
Bond Position:  [26.63058114]


portfolio before change:  [26.85147975]
curr_Stock_Price:  103.51830472872956
curr_Factors:  [1.03518305e+02 4.03154088e-02]
mat_Sqrt:  [[ 2.07851271e+01  0.00000000e+00]
 [-8.03147895e-03  1.84024301e-02]]
grads:  [6.40277683e-04 5.59111056e+00]
Stock Position:  0.0006402776826822193
Bond Position:  [26.78519929]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.86641416]
Stock Price:  105.92111108542535
PL:  [20.94530308]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.43919717e-01  4.03446527e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-3.33097100e-02  2.69441689e-02]
 [-1.43486091e-01 -4.50422694e-01]
 [ 8.98252632e-02  3.11231946e-01]
 [ 3.67959384e-01 -7.24975092e-01]
 [-7.99785636e-01  1.46764141e-01]
 [-1.84538102e-02  2.69694214e-02]
 [-3.24490332e-02  1.11664902e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.46383464]
curr_Stock_Price:  101.5101750443482
curr_Factors:  [1.01510175e+02 3.78638109e-02]
mat_Sqrt:  [[ 1.97524849e+01  0.00000000e+00]
 [-7.78345023e-03  1.78341249e-02]]
grads:  [1.62808797e-03 2.26221656e+01]
Stock Position:  0.0016280879720772048
Bond Position:  [12.29856715]


portfolio before change:  [12.47014824]
curr_Stock_Price:  101.61015291775703
curr_Factors:  [1.01610153e+02 3.38372571e-02]
mat_Sqrt:  [[ 1.86910922e+01  0.00000000e+00]
 [-7.35796245e-03  1.68592099e-02]]
grads:  [ 0.00502698 -2.80422469]
Stock Position:  0.00502697594151293
Bond Position:  [11.95935644]


portfolio before change:  [12.47286282]
curr_Stock_Price:  100.9603408729366
curr_Factors:  [1.00960341e+02 3.13690985e-02]
mat_Sqrt:  [[ 1.78814127e+01  0.00000000e+00]
 [-7.08452946e-03  1.62326963e-02]]
grads:  [-1.20517942e-03  1.65987021e+00]
Stock Position:  -0.00120517942176876
Bond Position:  [12.59453815]


portfolio before change:  [12.47626697]
curr_Stock_Price:  103.3622199744342
curr_Factors:  [1.03362220e+02 3.10218284e-02]
mat_Sqrt:  [[ 1.82052029e+01  0.00000000e+00]
 [-7.04520585e-03  1.61425945e-02]]
grads:  [-1.86796419e-02 -2.79027447e+01]
Stock Position:  -0.018679641907375817
Bond Position:  [14.40703623]


portfolio before change:  [12.49423027]
curr_Stock_Price:  102.78629970732972
curr_Factors:  [1.02786300e+02 3.01533586e-02]
mat_Sqrt:  [[ 1.78485557e+01  0.00000000e+00]
 [-6.94588898e-03  1.59150310e-02]]
grads:  [1.26429289e-02 1.95558492e+01]
Stock Position:  0.012642928903468305
Bond Position:  [11.19471039]


portfolio before change:  [12.46672069]
curr_Stock_Price:  100.16757563045576
curr_Factors:  [1.00167576e+02 3.19860065e-02]
mat_Sqrt:  [[ 1.79146024e+01  0.00000000e+00]
 [-7.15385283e-03  1.63915361e-02]]
grads:  [ 2.87778164e-03 -4.42286244e+01]
Stock Position:  0.0028777816445171482
Bond Position:  [12.17846028]


portfolio before change:  [12.47613244]
curr_Stock_Price:  101.32158811259032
curr_Factors:  [1.01321588e+02 3.19585080e-02]
mat_Sqrt:  [[ 1.81132022e+01  0.00000000e+00]
 [-7.15077708e-03  1.63844886e-02]]
grads:  [-0.04061858  8.95750512]
Stock Position:  -0.04061857777236451
Bond Position:  [16.59167124]


portfolio before change:  [12.46438738]
curr_Stock_Price:  101.81503132407306
curr_Factors:  [1.01815031e+02 3.22474647e-02]
mat_Sqrt:  [[ 1.82835148e+01  0.00000000e+00]
 [-7.18303164e-03  1.64583931e-02]]
grads:  [-3.65541844e-04  1.63864244e+00]
Stock Position:  -0.0003655418444898679
Bond Position:  [12.50160504]


portfolio before change:  [12.46991448]
curr_Stock_Price:  103.79912178949309
curr_Factors:  [1.03799122e+02 3.07559816e-02]
mat_Sqrt:  [[ 1.82036499e+01  0.00000000e+00]
 [-7.01495335e-03  1.60732774e-02]]
grads:  [8.94629678e-04 6.94723917e+00]
Stock Position:  0.0008946296777197968
Bond Position:  [12.37705271]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.47582802]
Stock Price:  103.4900152283948
PL:  [8.98581279]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.33658977e-01  2.79247984e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 5.48809771e-02  5.10279277e-02]
 [-1.30428419e-01 -4.67709380e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 3.52375830e-01 -6.75955567e-01]
 [-6.88894173e-01  1.04864734e-01]
 [-3.75355218e-02  1.38845340e-02]
 [-3.08730529e-02  9.64621096e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.7699869]
curr_Stock_Price:  99.36639018966798
curr_Factors:  [9.93663902e+01 4.05403245e-02]
mat_Sqrt:  [[ 2.00070530e+01  0.00000000e+00]
 [-8.05385121e-03  1.84536914e-02]]
grads:  [-0.01558376 15.13236446]
Stock Position:  -0.015583762619833384
Bond Position:  [-0.22148467]


portfolio before change:  [-1.74964354]
curr_Stock_Price:  98.05386164467251
curr_Factors:  [9.80538616e+01 4.04255135e-02]
mat_Sqrt:  [[ 1.97148045e+01  0.00000000e+00]
 [-8.04243878e-03  1.84275422e-02]]
grads:  [ 0.00476594 -2.56556258]
Stock Position:  0.0047659448546359656
Bond Position:  [-2.21696284]


portfolio before change:  [-1.74119393]
curr_Stock_Price:  100.05941719224052
curr_Factors:  [1.00059417e+02 4.19944793e-02]
mat_Sqrt:  [[ 2.05047307e+01  0.00000000e+00]
 [-8.19702183e-03  1.87817365e-02]]
grads:  [0.00376261 2.71689083]
Stock Position:  0.0037626141895591935
Bond Position:  [-2.11767891]


portfolio before change:  [-1.75103641]
curr_Stock_Price:  97.72503640532429
curr_Factors:  [9.77250364e+01 4.16775214e-02]
mat_Sqrt:  [[ 1.99506377e+01  0.00000000e+00]
 [-8.16602929e-03  1.87107237e-02]]
grads:  [-1.67690643e-02 -2.49968621e+01]
Stock Position:  -0.016769064297766725
Bond Position:  [-0.11227899]


portfolio before change:  [-1.73652564]
curr_Stock_Price:  96.85635809647098
curr_Factors:  [9.68563581e+01 3.94826327e-02]
mat_Sqrt:  [[ 1.92455881e+01  0.00000000e+00]
 [-7.94809489e-03  1.82113732e-02]]
grads:  [-3.66147292e-03 -4.67812043e+00]
Stock Position:  -0.0036614729210698153
Bond Position:  [-1.38188871]


portfolio before change:  [-1.75142558]
curr_Stock_Price:  100.736988657134
curr_Factors:  [1.00736989e+02 3.91746472e-02]
mat_Sqrt:  [[ 1.99384554e+01  0.00000000e+00]
 [-7.91703451e-03  1.81402050e-02]]
grads:  [ 2.87708520e-03 -3.72628407e+01]
Stock Position:  0.0028770851958218545
Bond Position:  [-2.04125448]


portfolio before change:  [-1.74605465]
curr_Stock_Price:  102.95861719528564
curr_Factors:  [1.02958617e+02 3.63858295e-02]
mat_Sqrt:  [[ 1.96394283e+01  0.00000000e+00]
 [-7.63002800e-03  1.74825904e-02]]
grads:  [-0.03274675  5.99823777]
Stock Position:  -0.03274675013536555
Bond Position:  [1.62550546]


portfolio before change:  [-1.67904535]
curr_Stock_Price:  100.93715424400445
curr_Factors:  [1.00937154e+02 3.42513285e-02]
mat_Sqrt:  [[ 1.86805547e+01  0.00000000e+00]
 [-7.40284578e-03  1.69620506e-02]]
grads:  [-0.00168495  0.81856459]
Stock Position:  -0.0016849507409297734
Bond Position:  [-1.50897122]


portfolio before change:  [-1.68382148]
curr_Stock_Price:  103.32384222297034
curr_Factors:  [1.03323842e+02 3.14354065e-02]
mat_Sqrt:  [[ 1.83193512e+01  0.00000000e+00]
 [-7.09201315e-03  1.62498435e-02]]
grads:  [6.12819913e-04 5.93618698e+00]
Stock Position:  0.0006128199128292602
Bond Position:  [-1.74714039]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.68341216]
Stock Price:  105.41761966645703
PL:  [-7.10103182]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.28526905e-01  3.43003969e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.50190344e-02  5.38270970e-02]
 [-1.24932032e-01 -4.82451241e-01]
 [-2.49579039e-02 -4.17002915e-02]
 [ 3.76346565e-01 -7.51357756e-01]
 [-7.30233653e-01  1.20481872e-01]
 [ 3.88697825e-02 -4.98922473e-02]
 [-3.62551276e-02  1.47478664e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.42547697]
curr_Stock_Price:  100.60072569608496
curr_Factors:  [1.00600726e+02 4.12408508e-02]
mat_Sqrt:  [[ 2.04298379e+01  0.00000000e+00]
 [-8.12313740e-03  1.86124460e-02]]
grads:  [-3.85845937e-03  1.84287422e+01]
Stock Position:  -0.003858459369861139
Bond Position:  [6.81364078]


portfolio before change:  [6.43039668]
curr_Stock_Price:  100.20884851861928
curr_Factors:  [1.00208849e+02 4.46188684e-02]
mat_Sqrt:  [[ 2.11672943e+01  0.00000000e+00]
 [-8.44927153e-03  1.93597132e-02]]
grads:  [ 0.00443891 -2.44203065]
Stock Position:  0.004438907960153331
Bond Position:  [5.98557883]


portfolio before change:  [6.43024924]
curr_Stock_Price:  99.50124510002911
curr_Factors:  [9.95012451e+01 4.42183390e-02]
mat_Sqrt:  [[ 2.09232781e+01  0.00000000e+00]
 [-8.41126283e-03  1.92726243e-02]]
grads:  [0.00470821 2.79293033]
Stock Position:  0.0047082060957633455
Bond Position:  [5.96177687]


portfolio before change:  [6.42285431]
curr_Stock_Price:  97.29731436143894
curr_Factors:  [9.72973144e+01 4.68991957e-02]
mat_Sqrt:  [[ 2.10709225e+01  0.00000000e+00]
 [-8.66248885e-03  1.98482554e-02]]
grads:  [-1.59219899e-02 -2.43069847e+01]
Stock Position:  -0.01592198989710992
Bond Position:  [7.97202117]


portfolio before change:  [6.40882687]
curr_Stock_Price:  98.42873343867747
curr_Factors:  [9.84287334e+01 4.74303052e-02]
mat_Sqrt:  [[ 2.14363015e+01  0.00000000e+00]
 [-8.71139991e-03  1.99603247e-02]]
grads:  [-2.01328588e-03 -2.08915897e+00]
Stock Position:  -0.0020132858806635014
Bond Position:  [6.60699205]


portfolio before change:  [6.40973694]
curr_Stock_Price:  99.61795967922691
curr_Factors:  [9.96179597e+01 4.81670628e-02]
mat_Sqrt:  [[ 2.18631495e+01  0.00000000e+00]
 [-8.77879835e-03  2.01147540e-02]]
grads:  [ 2.21501284e-03 -3.73535643e+01]
Stock Position:  0.002215012843237858
Bond Position:  [6.18908188]


portfolio before change:  [6.41881439]
curr_Stock_Price:  102.31867972034146
curr_Factors:  [1.02318680e+02 4.69291932e-02]
mat_Sqrt:  [[ 2.21654459e+01  0.00000000e+00]
 [-8.66525874e-03  1.98546021e-02]]
grads:  [-0.03057241  6.06820886]
Stock Position:  -0.030572407951718422
Bond Position:  [9.5469428]


portfolio before change:  [6.38332751]
curr_Stock_Price:  103.63560390845167
curr_Factors:  [1.03635604e+02 4.45101040e-02]
mat_Sqrt:  [[ 2.18644364e+01  0.00000000e+00]
 [-8.43896714e-03  1.93361029e-02]]
grads:  [ 7.81864226e-04 -2.58026386e+00]
Stock Position:  0.0007818642260702668
Bond Position:  [6.30229854]


portfolio before change:  [6.38747441]
curr_Stock_Price:  104.90815153405173
curr_Factors:  [1.04908152e+02 4.41304614e-02]
mat_Sqrt:  [[ 2.20383192e+01  0.00000000e+00]
 [-8.40290059e-03  1.92534640e-02]]
grads:  [1.27549828e-03 7.65985093e+00]
Stock Position:  0.0012754982814140528
Bond Position:  [6.25366424]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.3909718]
Stock Price:  105.19806394171896
PL:  [1.19290786]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.07135182e-01  3.25559264e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-7.88509732e-02  7.66711533e-03]
 [-1.52996170e-01 -4.31236562e-01]
 [ 1.16270264e-01  4.34611232e-01]
 [ 3.13338138e-01 -5.99145306e-01]
 [-9.36942808e-01  2.13372911e-01]
 [-7.18894915e-02 -8.91364543e-03]
 [-3.43934673e-02  4.88422377e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.54521021]
curr_Stock_Price:  101.07059507399852
curr_Factors:  [1.01070595e+02 3.98336006e-02]
mat_Sqrt:  [[ 2.01720300e+01  0.00000000e+00]
 [-7.98334272e-03  1.82921361e-02]]
grads:  [-3.22473598e-03  1.77977717e+01]
Stock Position:  -0.0032247359800022363
Bond Position:  [9.8711362]


portfolio before change:  [9.55013506]
curr_Stock_Price:  101.07430193910446
curr_Factors:  [1.01074302e+02 3.89535180e-02]
mat_Sqrt:  [[ 1.99486768e+01  0.00000000e+00]
 [-7.89465825e-03  1.80889345e-02]]
grads:  [ 0.00471007 -2.61358749]
Stock Position:  0.004710070347702211
Bond Position:  [9.07406799]


portfolio before change:  [9.55551699]
curr_Stock_Price:  101.25344131730976
curr_Factors:  [1.01253441e+02 4.20348816e-02]
mat_Sqrt:  [[ 2.07593957e+01  0.00000000e+00]
 [-8.20096401e-03  1.87907692e-02]]
grads:  [-0.00363714  0.40802562]
Stock Position:  -0.003637137173711075
Bond Position:  [9.92378964]


portfolio before change:  [9.55760952]
curr_Stock_Price:  102.04269066865852
curr_Factors:  [1.02042691e+02 3.96379807e-02]
mat_Sqrt:  [[ 2.03159747e+01  0.00000000e+00]
 [-7.96371579e-03  1.82471652e-02]]
grads:  [-1.67948248e-02 -2.36330716e+01]
Stock Position:  -0.016794824786417743
Bond Position:  [11.27139863]


portfolio before change:  [9.52767231]
curr_Stock_Price:  104.1608619889736
curr_Factors:  [1.04160862e+02 3.94040992e-02]
mat_Sqrt:  [[ 2.06764163e+01  0.00000000e+00]
 [-7.94018631e-03  1.81932524e-02]]
grads:  [1.47970592e-02 2.38885947e+01]
Stock Position:  0.014797059245911211
Bond Position:  [7.98639786]


portfolio before change:  [9.50169227]
curr_Stock_Price:  102.13517338046901
curr_Factors:  [1.02135173e+02 4.13989365e-02]
mat_Sqrt:  [[ 2.07811665e+01  0.00000000e+00]
 [-8.13869144e-03  1.86480848e-02]]
grads:  [ 2.49503265e-03 -3.21290531e+01]
Stock Position:  0.0024950326547997287
Bond Position:  [9.24686168]


portfolio before change:  [9.49914167]
curr_Stock_Price:  99.25938454835861
curr_Factors:  [9.92593845e+01 4.40733892e-02]
mat_Sqrt:  [[ 2.08381808e+01  0.00000000e+00]
 [-8.39746526e-03  1.92410101e-02]]
grads:  [-0.0404939  11.08948596]
Stock Position:  -0.04049390119278008
Bond Position:  [13.51854138]


portfolio before change:  [9.51293132]
curr_Stock_Price:  99.08581058740835
curr_Factors:  [9.90858106e+01 4.45530269e-02]
mat_Sqrt:  [[ 2.09146246e+01  0.00000000e+00]
 [-8.44303518e-03  1.93454239e-02]]
grads:  [-0.00362329 -0.46076248]
Stock Position:  -0.0036232888080533873
Bond Position:  [9.87194783]


portfolio before change:  [9.51848585]
curr_Stock_Price:  98.91543444793655
curr_Factors:  [9.89154344e+01 4.71749167e-02]
mat_Sqrt:  [[ 2.14842221e+01  0.00000000e+00]
 [-8.68791498e-03  1.99065140e-02]]
grads:  [-0.00150165  0.24535807]
Stock Position:  -0.0015016516334898863
Bond Position:  [9.66702237]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.52364364]
Stock Price:  98.70028703294057
PL:  [9.52364364]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.08070172e-01  2.93484032e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.34367737e-01  8.38517465e-02]
 [-1.14838596e-01 -5.11700434e-01]
 [ 3.63809851e-02  1.46671694e-01]
 [ 3.84984608e-01 -7.78529526e-01]
 [-9.72709521e-01  2.29952889e-01]
 [-3.89881780e-02  1.29205140e-02]
 [-2.73421102e-02  6.13209785e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.09603267]
curr_Stock_Price:  98.41361155167222
curr_Factors:  [9.84136116e+01 4.09551341e-02]
mat_Sqrt:  [[ 1.99163315e+01  0.00000000e+00]
 [-8.09494994e-03  1.85478604e-02]]
grads:  [-0.02912099 15.82306665]
Stock Position:  -0.02912098745957778
Bond Position:  [-5.23013112]


portfolio before change:  [-8.09633541]
curr_Stock_Price:  98.3341847864015
curr_Factors:  [9.83341848e+01 4.39112992e-02]
mat_Sqrt:  [[ 2.06059511e+01  0.00000000e+00]
 [-8.38200923e-03  1.92055959e-02]]
grads:  [ 0.00455983 -2.46162697]
Stock Position:  0.004559831794659295
Bond Position:  [-8.54472275]


portfolio before change:  [-8.09911326]
curr_Stock_Price:  98.66217344099036
curr_Factors:  [9.86621734e+01 4.52170742e-02]
mat_Sqrt:  [[ 2.09798272e+01  0.00000000e+00]
 [-8.50572270e-03  1.94890591e-02]]
grads:  [0.00814895 4.30250358]
Stock Position:  0.008148953634075966
Bond Position:  [-8.90310674]


portfolio before change:  [-8.12148728]
curr_Stock_Price:  96.462952565218
curr_Factors:  [9.64629526e+01 4.80294986e-02]
mat_Sqrt:  [[ 2.11404670e+01  0.00000000e+00]
 [-8.76625335e-03  2.00860098e-02]]
grads:  [-1.59960030e-02 -2.54754648e+01]
Stock Position:  -0.015996003005068343
Bond Position:  [-6.5784656]


portfolio before change:  [-8.19151988]
curr_Stock_Price:  100.63540424237175
curr_Factors:  [1.00635404e+02 4.94108748e-02]
mat_Sqrt:  [[ 2.23697982e+01  0.00000000e+00]
 [-8.89142282e-03  2.03728090e-02]]
grads:  [4.48791533e-03 7.19938491e+00]
Stock Position:  0.004487915326198929
Bond Position:  [-8.64316306]


portfolio before change:  [-8.20203338]
curr_Stock_Price:  99.25595792279758
curr_Factors:  [9.92559579e+01 4.80062195e-02]
mat_Sqrt:  [[ 2.17472996e+01  0.00000000e+00]
 [-8.76412866e-03  2.00811415e-02]]
grads:  [ 2.07871632e-03 -3.87691868e+01]
Stock Position:  0.0020787163172936215
Bond Position:  [-8.40835836]


portfolio before change:  [-8.20740857]
curr_Stock_Price:  98.6931321767567
curr_Factors:  [9.86931322e+01 5.12933877e-02]
mat_Sqrt:  [[ 2.23520636e+01  0.00000000e+00]
 [-9.05921742e-03  2.07572748e-02]]
grads:  [-0.03902771 11.078183  ]
Stock Position:  -0.039027709925535364
Bond Position:  [-4.35564163]


portfolio before change:  [-8.2934418]
curr_Stock_Price:  100.8417304605072
curr_Factors:  [1.00841730e+02 5.10290024e-02]
mat_Sqrt:  [[ 2.27797435e+01  0.00000000e+00]
 [-9.03583997e-03  2.07037103e-02]]
grads:  [-0.00146399  0.62406756]
Stock Position:  -0.0014639850281562142
Bond Position:  [-8.14581102]


portfolio before change:  [-8.29952258]
curr_Stock_Price:  102.21254494353553
curr_Factors:  [1.02212545e+02 5.09313474e-02]
mat_Sqrt:  [[ 2.30673011e+01  0.00000000e+00]
 [-9.02718981e-03  2.06838903e-02]]
grads:  [-2.51195877e-05  2.96467336e+00]
Stock Position:  -2.511958770020836e-05
Bond Position:  [-8.29695504]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.3035985]
Stock Price:  99.28262202931192
PL:  [-8.3035985]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.64088912e-01  2.81811079e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 3.81537735e-02 -5.52236225e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.58543141e-01 -1.50860884e+00]
 [-1.00234071e+00  2.90581560e-01]
 [-3.38360414e-02  2.88544854e-02]
 [-3.31552338e-02 -2.04314639e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.49646816]
curr_Stock_Price:  99.2569733685859
curr_Factors:  [9.92569734e+01 3.74343995e-02]
mat_Sqrt:  [[ 1.92042108e+01  0.00000000e+00]
 [-7.73918854e-03  1.77327086e-02]]
grads:  [-0.01776155 15.89216202]
Stock Position:  -0.017761546044040115
Bond Position:  [-0.73351085]


portfolio before change:  [-2.44833124]
curr_Stock_Price:  96.52614319777571
curr_Factors:  [9.65261432e+01 3.83307135e-02]
mat_Sqrt:  [[ 1.88981114e+01  0.00000000e+00]
 [-7.83129246e-03  1.79437452e-02]]
grads:  [ 0.00497191 -2.63473496]
Stock Position:  0.004971907981159945
Bond Position:  [-2.92825034]


portfolio before change:  [-2.45393593]
curr_Stock_Price:  95.69342486644621
curr_Factors:  [9.56934249e+01 3.90501870e-02]
mat_Sqrt:  [[ 1.89100927e+01  0.00000000e+00]
 [-7.90444806e-03  1.81113658e-02]]
grads:  [ 0.02129901 10.76146863]
Stock Position:  0.021299006226121908
Bond Position:  [-4.49211078]


portfolio before change:  [-2.51855476]
curr_Stock_Price:  92.76501503499968
curr_Factors:  [9.27650150e+01 4.08804848e-02]
mat_Sqrt:  [[ 1.87560870e+01  0.00000000e+00]
 [-8.08756921e-03  1.85309490e-02]]
grads:  [-1.08157887e-02 -2.98007525e+01]
Stock Position:  -0.010815788743064977
Bond Position:  [-1.51522796]


portfolio before change:  [-2.50858092]
curr_Stock_Price:  91.7727948902469
curr_Factors:  [9.17727949e+01 4.17887874e-02]
mat_Sqrt:  [[ 1.87604755e+01  0.00000000e+00]
 [-8.17692239e-03  1.87356829e-02]]
grads:  [-3.75615211e-03 -4.54720532e+00]
Stock Position:  -0.0037561521072046315
Bond Position:  [-2.16386835]


portfolio before change:  [-2.51370801]
curr_Stock_Price:  92.84966423703614
curr_Factors:  [9.28496642e+01 4.21048988e-02]
mat_Sqrt:  [[ 1.90522667e+01  0.00000000e+00]
 [-8.20779130e-03  1.88064125e-02]]
grads:  [-1.04904964e-02 -8.02177896e+01]
Stock Position:  -0.01049049639956656
Bond Position:  [-1.53966894]


portfolio before change:  [-2.53334362]
curr_Stock_Price:  94.64801396012084
curr_Factors:  [9.46480140e+01 4.36246717e-02]
mat_Sqrt:  [[ 1.97686763e+01  0.00000000e+00]
 [-8.35460799e-03  1.91428118e-02]]
grads:  [-0.04428827 15.1796697 ]
Stock Position:  -0.04428827217686374
Bond Position:  [1.65845338]


portfolio before change:  [-2.59732004]
curr_Stock_Price:  96.11128748771165
curr_Factors:  [9.61112875e+01 4.58067200e-02]
mat_Sqrt:  [[ 2.05702227e+01  0.00000000e+00]
 [-8.56100181e-03  1.96157194e-02]]
grads:  [-1.03270207e-03  1.47098788e+00]
Stock Position:  -0.0010327020709474336
Bond Position:  [-2.49806572]


portfolio before change:  [-2.59604149]
curr_Stock_Price:  93.66343916410962
curr_Factors:  [9.36634392e+01 4.55947326e-02]
mat_Sqrt:  [[ 1.99998822e+01  0.00000000e+00]
 [-8.54116925e-03  1.95702773e-02]]
grads:  [-6.11630867e-03 -1.04400482e+01]
Stock Position:  -0.00611630866548514
Bond Position:  [-2.02316699]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.60900684]
Stock Price:  95.61780615869078
PL:  [-2.60900684]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.86190403e-02  1.74526399e-01]
 [-2.85873858e-02  2.30015743e-01]
 [-7.78931731e-03  3.46832426e-02]
 [-1.64191863e-01 -4.11852437e-01]
 [-3.47940027e-02 -9.17972104e-02]
 [ 3.82759644e-01 -7.71530695e-01]
 [-7.90915754e-01  1.43413132e-01]
 [-5.10943067e-02  4.88657500e-03]
 [-2.97335645e-02  1.31237914e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.51282002]
curr_Stock_Price:  101.81877690513564
curr_Factors:  [1.01818777e+02 3.78844774e-02]
mat_Sqrt:  [[ 1.98179408e+01  0.00000000e+00]
 [-7.78557409e-03  1.78389913e-02]]
grads:  [2.39936760e-03 9.78342309e+00]
Stock Position:  0.0023993676028949834
Bond Position:  [14.26851935]


portfolio before change:  [14.52577134]
curr_Stock_Price:  104.24244771731757
curr_Factors:  [1.04242448e+02 3.50171027e-02]
mat_Sqrt:  [[ 1.95067405e+01  0.00000000e+00]
 [-7.48514291e-03  1.71506170e-02]]
grads:  [3.68076434e-03 1.34115142e+01]
Stock Position:  0.0036807643381392657
Bond Position:  [14.14207946]


portfolio before change:  [14.5200074]
curr_Stock_Price:  100.7549253336738
curr_Factors:  [1.00754925e+02 3.44380195e-02]
mat_Sqrt:  [[ 1.86975787e+01  0.00000000e+00]
 [-7.42299341e-03  1.70082146e-02]]
grads:  [3.92975523e-04 2.03920538e+00]
Stock Position:  0.0003929755231381487
Bond Position:  [14.48041318]


portfolio before change:  [14.52700691]
curr_Stock_Price:  100.13781173584337
curr_Factors:  [1.00137812e+02 3.29181473e-02]
mat_Sqrt:  [[ 1.81683626e+01  0.00000000e+00]
 [-7.25734357e-03  1.66286631e-02]]
grads:  [-1.89306549e-02 -2.47676217e+01]
Stock Position:  -0.018930654900993705
Bond Position:  [16.42268126]


portfolio before change:  [14.57913348]
curr_Stock_Price:  97.81812545739375
curr_Factors:  [9.78181255e+01 3.22729903e-02]
mat_Sqrt:  [[ 1.75727180e+01  0.00000000e+00]
 [-7.18587396e-03  1.64649057e-02]]
grads:  [-4.25987544e-03 -5.57532562e+00]
Stock Position:  -0.004259875439613051
Bond Position:  [14.99582651]


portfolio before change:  [14.57929309]
curr_Stock_Price:  99.54122319307587
curr_Factors:  [9.95412232e+01 3.22138612e-02]
mat_Sqrt:  [[ 1.78658780e+01  0.00000000e+00]
 [-7.17928812e-03  1.64498156e-02]]
grads:  [ 2.57675796e-03 -4.69020877e+01]
Stock Position:  0.002576757956218418
Bond Position:  [14.32279945]


portfolio before change:  [14.5913929]
curr_Stock_Price:  101.4570512025742
curr_Factors:  [1.01457051e+02 3.04539278e-02]
mat_Sqrt:  [[ 1.77053246e+01  0.00000000e+00]
 [-6.98042151e-03  1.59941550e-02]]
grads:  [-0.04113594  8.96659638]
Stock Position:  -0.04113593788143221
Bond Position:  [18.76492386]


portfolio before change:  [14.64950239]
curr_Stock_Price:  100.2725715152475
curr_Factors:  [1.00272572e+02 3.33725336e-02]
mat_Sqrt:  [[ 1.83179446e+01  0.00000000e+00]
 [-7.30726034e-03  1.67430368e-02]]
grads:  [-0.00267288  0.29185715]
Stock Position:  -0.0026728779626867963
Bond Position:  [14.91751874]


portfolio before change:  [14.65715323]
curr_Stock_Price:  100.20140736090286
curr_Factors:  [1.00201407e+02 3.34640059e-02]
mat_Sqrt:  [[ 1.83300135e+01  0.00000000e+00]
 [-7.31726789e-03  1.67659670e-02]]
grads:  [-0.00130965  0.78276376]
Stock Position:  -0.001309648372220191
Bond Position:  [14.78838184]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.6617619]
Stock Price:  102.32974400670629
PL:  [12.33201789]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.69156692e-01 -3.04596956e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.20578019e-01  7.49768660e-02]
 [-1.33062949e-01 -4.59632530e-01]
 [ 4.99993652e-02  1.87235975e-01]
 [ 3.67945037e-01 -7.24929964e-01]
 [-8.92631596e-01  1.91577133e-01]
 [-4.90481956e-02  1.50384050e-02]
 [-3.72239801e-02 -3.85707029e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.4594035]
curr_Stock_Price:  102.71440395472516
curr_Factors:  [1.02714404e+02 4.11836741e-02]
mat_Sqrt:  [[ 2.08446158e+01  0.00000000e+00]
 [-8.11750446e-03  1.85995393e-02]]
grads:  [ 1.13324076e-02 -1.63765860e+01]
Stock Position:  0.011332407595895029
Bond Position:  [19.29540201]


portfolio before change:  [20.44561095]
curr_Stock_Price:  100.64576502057554
curr_Factors:  [1.00645765e+02 4.15990893e-02]
mat_Sqrt:  [[ 2.05275641e+01  0.00000000e+00]
 [-8.15834192e-03  1.86931097e-02]]
grads:  [ 0.00457724 -2.5291144 ]
Stock Position:  0.004577244071337389
Bond Position:  [19.98493072]


portfolio before change:  [20.44709887]
curr_Stock_Price:  98.7872135078379
curr_Factors:  [9.87872135e+01 4.17297713e-02]
mat_Sqrt:  [[ 2.01801197e+01  0.00000000e+00]
 [-8.17114643e-03  1.87224485e-02]]
grads:  [0.00759662 4.00465067]
Stock Position:  0.007596615299348345
Bond Position:  [19.69665041]


portfolio before change:  [20.45061057]
curr_Stock_Price:  97.95275176125017
curr_Factors:  [9.79527518e+01 4.31009439e-02]
mat_Sqrt:  [[ 2.03357424e+01  0.00000000e+00]
 [-8.30430673e-03  1.90275571e-02]]
grads:  [-1.64077133e-02 -2.41561504e+01]
Stock Position:  -0.016407713302359607
Bond Position:  [22.05779124]


portfolio before change:  [20.40847804]
curr_Stock_Price:  101.19294683810419
curr_Factors:  [1.01192947e+02 4.32725143e-02]
mat_Sqrt:  [[ 2.10502040e+01  0.00000000e+00]
 [-8.32081865e-03  1.90653906e-02]]
grads:  [6.25722412e-03 9.82072585e+00]
Stock Position:  0.006257224119653555
Bond Position:  [19.77529109]


portfolio before change:  [20.41094741]
curr_Stock_Price:  100.00699813883513
curr_Factors:  [1.00006998e+02 4.52767913e-02]
mat_Sqrt:  [[ 2.12798328e+01  0.00000000e+00]
 [-8.51133750e-03  1.95019242e-02]]
grads:  [ 2.42293552e-03 -3.71722276e+01]
Stock Position:  0.0024229355216937873
Bond Position:  [20.1686369]


portfolio before change:  [20.42076745]
curr_Stock_Price:  99.89688479527618
curr_Factors:  [9.98968848e+01 4.32418934e-02]
mat_Sqrt:  [[ 2.07732428e+01  0.00000000e+00]
 [-8.31787410e-03  1.90586438e-02]]
grads:  [-0.03894531 10.05198138]
Stock Position:  -0.038945314868085223
Bond Position:  [24.31128308]


portfolio before change:  [20.53807122]
curr_Stock_Price:  97.19707135677565
curr_Factors:  [9.71970714e+01 4.57033056e-02]
mat_Sqrt:  [[ 2.07791121e+01  0.00000000e+00]
 [-8.55133258e-03  1.95935644e-02]]
grads:  [-0.0020446   0.76751757]
Stock Position:  -0.002044596392708484
Bond Position:  [20.7368]


portfolio before change:  [20.54837212]
curr_Stock_Price:  97.23135144846437
curr_Factors:  [9.72313514e+01 4.52758513e-02]
mat_Sqrt:  [[ 2.06890064e+01  0.00000000e+00]
 [-8.51124915e-03  1.95017217e-02]]
grads:  [-0.00261287 -1.97781013]
Stock Position:  -0.0026128666483853933
Bond Position:  [20.80242467]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.56035473]
Stock Price:  96.6271113913261
PL:  [20.56035473]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.61859280e-01  3.38096422e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.32828161e-01 -4.62524083e-01]
 [-3.46513424e-02 -8.22717791e-02]
 [ 3.96047529e-01 -8.55415978e-01]
 [-9.57955454e-01  2.23667111e-01]
 [-7.00290961e-02 -7.67903915e-03]
 [-3.25881155e-02 -2.04557258e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.47208936]
curr_Stock_Price:  100.30652200888383
curr_Factors:  [1.00306522e+02 3.88299331e-02]
mat_Sqrt:  [[ 1.97657134e+01  0.00000000e+00]
 [-7.88212491e-03  1.80602170e-02]]
grads:  [-5.78283730e-03  1.87205072e+01]
Stock Position:  -0.005782837300069617
Bond Position:  [5.05214565]


portfolio before change:  [4.48127542]
curr_Stock_Price:  99.15494921328562
curr_Factors:  [9.91549492e+01 3.78478258e-02]
mat_Sqrt:  [[ 1.92901171e+01  0.00000000e+00]
 [-7.78180707e-03  1.78303600e-02]]
grads:  [ 0.00487087 -2.65148953]
Stock Position:  0.004870870943290315
Bond Position:  [3.99830446]


portfolio before change:  [4.47257194]
curr_Stock_Price:  96.95757366616355
curr_Factors:  [9.69575737e+01 3.56534458e-02]
mat_Sqrt:  [[ 1.83076455e+01  0.00000000e+00]
 [-7.55284802e-03  1.73057489e-02]]
grads:  [ 0.02199989 11.26243632]
Stock Position:  0.02199988973550406
Bond Position:  [2.33951601]


portfolio before change:  [4.49411636]
curr_Stock_Price:  97.8836858944478
curr_Factors:  [9.78836859e+01 3.45381094e-02]
mat_Sqrt:  [[ 1.81911266e+01  0.00000000e+00]
 [-7.43377260e-03  1.70329128e-02]]
grads:  [-1.83985427e-02 -2.71547261e+01]
Stock Position:  -0.018398542748538513
Bond Position:  [6.29503353]


portfolio before change:  [4.49533936]
curr_Stock_Price:  97.98832996236702
curr_Factors:  [9.79883300e+01 3.38519716e-02]
mat_Sqrt:  [[ 1.80287800e+01  0.00000000e+00]
 [-7.35956211e-03  1.68628752e-02]]
grads:  [-3.91361425e-03 -4.87887018e+00]
Stock Position:  -0.003913614254434628
Bond Position:  [4.87882789]


portfolio before change:  [4.49503437]
curr_Stock_Price:  98.68973098882604
curr_Factors:  [9.86897310e+01 3.27492163e-02]
mat_Sqrt:  [[ 1.78596285e+01  0.00000000e+00]
 [-7.23869782e-03  1.65859403e-02]]
grads:  [ 1.27177275e-03 -5.15747652e+01]
Stock Position:  0.0012717727499309986
Bond Position:  [4.36952346]


portfolio before change:  [4.49758642]
curr_Stock_Price:  98.97810091896945
curr_Factors:  [9.89781009e+01 3.20666821e-02]
mat_Sqrt:  [[ 1.77241791e+01  0.00000000e+00]
 [-7.16286893e-03  1.64121945e-02]]
grads:  [-0.04854042 13.62810504]
Stock Position:  -0.04854042148052493
Bond Position:  [9.30202516]


portfolio before change:  [4.53079159]
curr_Stock_Price:  98.38986971531445
curr_Factors:  [9.83898697e+01 3.22513351e-02]
mat_Sqrt:  [[ 1.76694989e+01  0.00000000e+00]
 [-7.18346268e-03  1.64593807e-02]]
grads:  [-0.00415295 -0.46654484]
Stock Position:  -0.004152947621493924
Bond Position:  [4.93939956]


portfolio before change:  [4.55264967]
curr_Stock_Price:  93.721434103144
curr_Factors:  [9.37214341e+01 3.27800430e-02]
mat_Sqrt:  [[ 1.69685091e+01  0.00000000e+00]
 [-7.24210390e-03  1.65937447e-02]]
grads:  [-7.18178723e-03 -1.23273717e+01]
Stock Position:  -0.007181787234685475
Bond Position:  [5.22573707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.56210125]
Stock Price:  92.76929604649375
PL:  [4.56210125]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.08220784e-01  3.26338314e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.40105625e-02  4.18462676e-02]
 [-1.36513419e-01 -4.51710452e-01]
 [ 2.17921403e-02  1.04347692e-01]
 [ 3.31471034e-01 -6.10197577e-01]
 [-7.08163159e-01  1.12145542e-01]
 [ 2.74724011e-02 -3.15650166e-02]
 [-2.70757711e-02  4.31537233e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.0719415]
curr_Stock_Price:  100.99931510958997
curr_Factors:  [1.00999315e+02 3.75271455e-02]
mat_Sqrt:  [[ 1.95655110e+01  0.00000000e+00]
 [-7.74876976e-03  1.77546620e-02]]
grads:  [-3.36280852e-03  1.83804296e+01]
Stock Position:  -0.0033628085243887413
Bond Position:  [9.41158286]


portfolio before change:  [9.0739138]
curr_Stock_Price:  101.81252653402306
curr_Factors:  [1.01812527e+02 3.75750666e-02]
mat_Sqrt:  [[ 1.97356345e+01  0.00000000e+00]
 [-7.75371566e-03  1.77659945e-02]]
grads:  [ 0.00476091 -2.66109578]
Stock Position:  0.004760914622147103
Bond Position:  [8.58919305]


portfolio before change:  [9.07237373]
curr_Stock_Price:  100.58676807169846
curr_Factors:  [1.00586768e+02 3.50891035e-02]
mat_Sqrt:  [[ 1.88419996e+01  0.00000000e+00]
 [-7.49283428e-03  1.71682401e-02]]
grads:  [1.71286337e-03 2.43742324e+00]
Stock Position:  0.0017128633727118141
Bond Position:  [8.90008234]


portfolio before change:  [9.07272185]
curr_Stock_Price:  98.19134008205856
curr_Factors:  [9.81913401e+01 3.46472169e-02]
mat_Sqrt:  [[ 1.82771032e+01  0.00000000e+00]
 [-7.44550515e-03  1.70597955e-02]]
grads:  [-1.82554105e-02 -2.64780696e+01]
Stock Position:  -0.018255410531177865
Bond Position:  [10.86524507]


portfolio before change:  [9.04452853]
curr_Stock_Price:  100.03338570960726
curr_Factors:  [1.00033386e+02 3.35604177e-02]
mat_Sqrt:  [[ 1.83256187e+01  0.00000000e+00]
 [-7.32780106e-03  1.67901015e-02]]
grads:  [3.67426648e-03 6.21483389e+00]
Stock Position:  0.0036742664793977136
Bond Position:  [8.67697921]


portfolio before change:  [9.05495202]
curr_Stock_Price:  101.6892029556319
curr_Factors:  [1.01689203e+02 3.32855844e-02]
mat_Sqrt:  [[ 1.85525212e+01  0.00000000e+00]
 [-7.29773493e-03  1.67212113e-02]]
grads:  [ 3.51213606e-03 -3.64924266e+01]
Stock Position:  0.0035121360599305144
Bond Position:  [8.6978057]


portfolio before change:  [9.06276856]
curr_Stock_Price:  102.67622269808882
curr_Factors:  [1.02676223e+02 3.47686082e-02]
mat_Sqrt:  [[ 1.91453600e+01  0.00000000e+00]
 [-7.45853693e-03  1.70896550e-02]]
grads:  [-0.0344323   6.56218873]
Stock Position:  -0.03443230281802966
Bond Position:  [12.59814735]


portfolio before change:  [9.04655524]
curr_Stock_Price:  103.33008444735204
curr_Factors:  [1.03330084e+02 3.77209432e-02]
mat_Sqrt:  [[ 2.00686452e+01  0.00000000e+00]
 [-7.76875209e-03  1.78004473e-02]]
grads:  [ 6.82472497e-04 -1.77327098e+00]
Stock Position:  0.0006824724965016073
Bond Position:  [8.9760353]


portfolio before change:  [9.04995621]
curr_Stock_Price:  101.73563203591627
curr_Factors:  [1.01735632e+02 3.97966447e-02]
mat_Sqrt:  [[ 2.02953393e+01  0.00000000e+00]
 [-7.97963855e-03  1.82836488e-02]]
grads:  [-4.06100240e-04  2.36023584e+00]
Stock Position:  -0.00040610024037082167
Bond Position:  [9.09127107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.05498495]
Stock Price:  100.54881386536437
PL:  [8.50617108]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.49866716e-01  2.73084483e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 4.01668961e-02  4.86151076e-02]
 [-1.41506926e-01 -4.52694760e-01]
 [ 1.14716391e-01  4.27361629e-01]
 [ 2.96954403e-01 -6.12573822e-01]
 [-8.35532640e-01  1.63464315e-01]
 [-7.18197502e-02 -8.86736335e-03]
 [-3.40360712e-02  5.30095527e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.11687494]
curr_Stock_Price:  99.65057429549363
curr_Factors:  [9.96505743e+01 4.01776738e-02]
mat_Sqrt:  [[ 1.99743291e+01  0.00000000e+00]
 [-8.01774770e-03  1.83709679e-02]]
grads:  [-1.15489675e-02  1.48650025e+01]
Stock Position:  -0.011548967486899698
Bond Position:  [1.26773619]


portfolio before change:  [0.12653492]
curr_Stock_Price:  98.86903726908281
curr_Factors:  [9.88690373e+01 4.40105476e-02]
mat_Sqrt:  [[ 2.07414298e+01  0.00000000e+00]
 [-8.39147640e-03  1.92272879e-02]]
grads:  [ 0.00453005 -2.45884979]
Stock Position:  0.0045300479190178355
Bond Position:  [-0.32134656]


portfolio before change:  [0.13312742]
curr_Stock_Price:  100.35979762093986
curr_Factors:  [1.00359798e+02 3.91620208e-02]
mat_Sqrt:  [[ 1.98605981e+01  0.00000000e+00]
 [-7.91575854e-03  1.81372814e-02]]
grads:  [0.00309076 2.68039662]
Stock Position:  0.0030907562839278388
Bond Position:  [-0.17706026]


portfolio before change:  [0.14283777]
curr_Stock_Price:  103.53018924976045
curr_Factors:  [1.03530189e+02 3.84343853e-02]
mat_Sqrt:  [[ 2.02967722e+01  0.00000000e+00]
 [-7.84187582e-03  1.79679948e-02]]
grads:  [-1.67060611e-02 -2.51945065e+01]
Stock Position:  -0.01670606110435739
Bond Position:  [1.87241944]


portfolio before change:  [0.1346159]
curr_Stock_Price:  104.07839247892514
curr_Factors:  [1.04078392e+02 3.68297958e-02]
mat_Sqrt:  [[ 1.99737786e+01  0.00000000e+00]
 [-7.67643623e-03  1.75889250e-02]]
grads:  [1.50813876e-02 2.42972000e+01]
Stock Position:  0.01508138762999918
Bond Position:  [-1.43503068]


portfolio before change:  [0.11163619]
curr_Stock_Price:  102.60226732128754
curr_Factors:  [1.02602267e+02 3.42189013e-02]
mat_Sqrt:  [[ 1.89797282e+01  0.00000000e+00]
 [-7.39934065e-03  1.69540193e-02]]
grads:  [ 1.55983627e-03 -3.61314807e+01]
Stock Position:  0.0015598362694748899
Bond Position:  [-0.04840655]


portfolio before change:  [0.10869474]
curr_Stock_Price:  100.73204704780777
curr_Factors:  [1.00732047e+02 3.40971591e-02]
mat_Sqrt:  [[ 1.86005916e+01  0.00000000e+00]
 [-7.38616644e-03  1.69238334e-02]]
grads:  [-0.04108423  9.65882324]
Stock Position:  -0.04108422891847132
Bond Position:  [4.24719322]


portfolio before change:  [0.19775643]
curr_Stock_Price:  98.61596599485979
curr_Factors:  [9.86159660e+01 3.62201312e-02]
mat_Sqrt:  [[ 1.87681836e+01  0.00000000e+00]
 [-7.61263488e-03  1.74427378e-02]]
grads:  [-0.00403288 -0.50836993]
Stock Position:  -0.004032877481225536
Bond Position:  [0.59546254]


portfolio before change:  [0.1964121]
curr_Stock_Price:  99.02315246963374
curr_Factors:  [9.90231525e+01 3.27735484e-02]
mat_Sqrt:  [[ 1.79266228e+01  0.00000000e+00]
 [-7.24138644e-03  1.65921007e-02]]
grads:  [-0.00176958  0.31948669]
Stock Position:  -0.0017695772915419673
Bond Position:  [0.37164122]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.20030993]
Stock Price:  96.92549976522379
PL:  [0.20030993]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.06172886e-01  2.84802516e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.94308405e-02  4.86680582e-03]
 [-1.57352667e-01 -4.22229004e-01]
 [-3.23052204e-03  2.78022508e-02]
 [ 2.97090985e-01 -6.13665131e-01]
 [-8.84499802e-01  1.87547022e-01]
 [ 7.34679839e-03  1.02184551e-03]
 [-3.34501120e-02  6.37214970e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.43090279]
curr_Stock_Price:  99.11623626580167
curr_Factors:  [9.91162363e+01 3.86546375e-02]
mat_Sqrt:  [[ 1.94870278e+01  0.00000000e+00]
 [-7.86431306e-03  1.80194049e-02]]
grads:  [-0.01959636 15.80532304]
Stock Position:  -0.019596363355916777
Bond Position:  [-1.488585]


portfolio before change:  [-3.48399898]
curr_Stock_Price:  101.78773786085914
curr_Factors:  [1.01787738e+02 3.57943186e-02]
mat_Sqrt:  [[ 1.92576155e+01  0.00000000e+00]
 [-7.56775460e-03  1.73399042e-02]]
grads:  [ 0.00487909 -2.7264864 ]
Stock Position:  0.0048790916421394956
Bond Position:  [-3.98063068]


portfolio before change:  [-3.48710611]
curr_Stock_Price:  101.5589426954502
curr_Factors:  [1.01558943e+02 3.48102427e-02]
mat_Sqrt:  [[ 1.89483630e+01  0.00000000e+00]
 [-7.46300129e-03  1.70998842e-02]]
grads:  [-0.00513537  0.28461046]
Stock Position:  -0.005135366690969428
Bond Position:  [-2.96556369]


portfolio before change:  [-3.48799077]
curr_Stock_Price:  101.442399619474
curr_Factors:  [1.01442400e+02 3.68420272e-02]
mat_Sqrt:  [[ 1.94711352e+01  0.00000000e+00]
 [-7.67771082e-03  1.75918455e-02]]
grads:  [-1.75453823e-02 -2.40014047e+01]
Stock Position:  -0.01754538232413905
Bond Position:  [-1.70814508]


portfolio before change:  [-3.44910566]
curr_Stock_Price:  99.17745099910094
curr_Factors:  [9.91774510e+01 3.35472841e-02]
mat_Sqrt:  [[ 1.81652603e+01  0.00000000e+00]
 [-7.32636708e-03  1.67868159e-02]]
grads:  [4.90131979e-04 1.65619561e+00]
Stock Position:  0.0004901319790882346
Bond Position:  [-3.4977157]


portfolio before change:  [-3.44917429]
curr_Stock_Price:  102.60645927574319
curr_Factors:  [1.02606459e+02 3.31381220e-02]
mat_Sqrt:  [[ 1.86783560e+01  0.00000000e+00]
 [-7.28155170e-03  1.66841309e-02]]
grads:  [ 1.56681694e-03 -3.67813663e+01]
Stock Position:  0.0015668169393160784
Bond Position:  [-3.60993983]


portfolio before change:  [-3.4550178]
curr_Stock_Price:  100.02920263964131
curr_Factors:  [1.00029203e+02 3.40483597e-02]
mat_Sqrt:  [[ 1.84575861e+01  0.00000000e+00]
 [-7.38087904e-03  1.69117185e-02]]
grads:  [-0.04348605 11.08976729]
Stock Position:  -0.04348605312458636
Bond Position:  [0.89485742]


portfolio before change:  [-3.5743516]
curr_Stock_Price:  102.7836797148499
curr_Factors:  [1.02783680e+02 3.31039136e-02]
mat_Sqrt:  [[ 1.87009570e+01  0.00000000e+00]
 [-7.27779237e-03  1.66755172e-02]]
grads:  [0.0004167  0.06127819]
Stock Position:  0.00041670425360178297
Bond Position:  [-3.61718199]


portfolio before change:  [-3.5776609]
curr_Stock_Price:  99.18337423466708
curr_Factors:  [9.91833742e+01 3.32274196e-02]
mat_Sqrt:  [[ 1.80795321e+01  0.00000000e+00]
 [-7.29135594e-03  1.67065953e-02]]
grads:  [-0.00169634  0.38141522]
Stock Position:  -0.0016963424545388725
Bond Position:  [-3.40941194]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.57686874]
Stock Price:  97.7112074655257
PL:  [-3.57686874]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.67564493e-01  2.82023370e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.72736368e-02  5.85848893e-02]
 [-1.64214409e-01 -4.08093892e-01]
 [ 3.80481622e-03  4.92838340e-02]
 [ 3.69853929e-01 -7.30934562e-01]
 [-7.66829706e-01  1.34310988e-01]
 [-7.19434518e-02 -8.94945487e-03]
 [-3.52262366e-02 -1.18370660e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.56922479]
curr_Stock_Price:  99.24601534443403
curr_Factors:  [9.92460153e+01 3.78817264e-02]
mat_Sqrt:  [[ 1.93164788e+01  0.00000000e+00]
 [-7.78529141e-03  1.78383436e-02]]
grads:  [-0.01783345 15.80995279]
Stock Position:  -0.017833447159826224
Bond Position:  [-0.79932621]


portfolio before change:  [-2.55565304]
curr_Stock_Price:  98.462571370537
curr_Factors:  [9.84625714e+01 3.79087611e-02]
mat_Sqrt:  [[ 1.91708323e+01  0.00000000e+00]
 [-7.78806894e-03  1.78447077e-02]]
grads:  [ 0.00490118 -2.64935765]
Stock Position:  0.004901178484826483
Bond Position:  [-3.03823568]


portfolio before change:  [-2.55157778]
curr_Stock_Price:  99.6040846407454
curr_Factors:  [9.96040846e+01 3.43533736e-02]
mat_Sqrt:  [[ 1.84612815e+01  0.00000000e+00]
 [-7.41386524e-03  1.69872993e-02]]
grads:  [0.0055707  3.44874651]
Stock Position:  0.005570695540397157
Bond Position:  [-3.10644181]


portfolio before change:  [-2.54816332]
curr_Stock_Price:  100.49590575572117
curr_Factors:  [1.00495906e+02 3.40527907e-02]
mat_Sqrt:  [[ 1.85449097e+01  0.00000000e+00]
 [-7.38135930e-03  1.69128189e-02]]
grads:  [-1.84590376e-02 -2.41292652e+01]
Stock Position:  -0.018459037579188074
Bond Position:  [-0.69310562]


portfolio before change:  [-2.52863068]
curr_Stock_Price:  99.41896514141584
curr_Factors:  [9.94189651e+01 3.52557750e-02]
mat_Sqrt:  [[ 1.86674231e+01  0.00000000e+00]
 [-7.51060850e-03  1.72089660e-02]]
grads:  [1.35605459e-03 2.86384633e+00]
Stock Position:  0.0013560545891496663
Bond Position:  [-2.66344822]


portfolio before change:  [-2.52912661]
curr_Stock_Price:  100.03555155657254
curr_Factors:  [1.00035552e+02 3.62903226e-02]
mat_Sqrt:  [[ 1.90567916e+01  0.00000000e+00]
 [-7.62000762e-03  1.74596309e-02]]
grads:  [ 2.66823159e-03 -4.18642620e+01]
Stock Position:  0.0026682315881104957
Bond Position:  [-2.79604463]


portfolio before change:  [-2.52582639]
curr_Stock_Price:  101.79648995440259
curr_Factors:  [1.01796490e+02 3.80457445e-02]
mat_Sqrt:  [[ 1.98557295e+01  0.00000000e+00]
 [-7.80212735e-03  1.78769196e-02]]
grads:  [-0.03566787  7.51309459]
Stock Position:  -0.03566787039343673
Bond Position:  [1.10503762]


portfolio before change:  [-2.42880391]
curr_Stock_Price:  99.09181991827526
curr_Factors:  [9.90918199e+01 4.00768204e-02]
mat_Sqrt:  [[ 1.98373855e+01  0.00000000e+00]
 [-8.00767835e-03  1.83478961e-02]]
grads:  [-0.00382355 -0.48776464]
Stock Position:  -0.003823553963180019
Bond Position:  [-2.04992099]


portfolio before change:  [-2.41853355]
curr_Stock_Price:  96.1376096081851
curr_Factors:  [9.61376096e+01 4.51900972e-02]
mat_Sqrt:  [[ 2.04368971e+01  0.00000000e+00]
 [-8.50318502e-03  1.94832445e-02]]
grads:  [-4.25149805e-03 -6.07551067e+00]
Stock Position:  -0.004251498048142388
Bond Position:  [-2.00980469]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.43297823]
Stock Price:  99.29873747105674
PL:  [-2.43297823]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.80644549e-01  2.89473467e-01]
 [ 1.03747095e-01 -1.61660196e-02]
 [-9.91328270e-02  6.98837906e-03]
 [-1.17159399e-01 -4.73994027e-01]
 [ 1.85555813e-01  7.57863311e-01]
 [ 2.41494814e-01 -5.01986400e-01]
 [-2.21648625e-02 -4.58386109e-02]
 [ 4.88792298e-01 -7.64613392e-01]
 [-4.18549763e-02  3.68388045e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.96243544]
curr_Stock_Price:  98.13250883001686
curr_Factors:  [9.81325088e+01 3.99547795e-02]
mat_Sqrt:  [[ 1.96154046e+01  0.00000000e+00]
 [-7.99547668e-03  1.83199385e-02]]
grads:  [-0.03335684 15.80100645]
Stock Position:  -0.033356842856538546
Bond Position:  [-6.68904476]


portfolio before change:  [-10.09511517]
curr_Stock_Price:  102.00980562353634
curr_Factors:  [1.02009806e+02 3.76155784e-02]
mat_Sqrt:  [[ 1.97845325e+01  0.00000000e+00]
 [-7.75789439e-03  1.77755691e-02]]
grads:  [ 0.00488724 -0.90945159]
Stock Position:  0.004887235308084165
Bond Position:  [-10.5936611]


portfolio before change:  [-10.09650857]
curr_Stock_Price:  102.80877663931095
curr_Factors:  [1.02808777e+02 3.65633511e-02]
mat_Sqrt:  [[ 1.96586272e+01  0.00000000e+00]
 [-7.64861829e-03  1.75251861e-02]]
grads:  [-0.00488757  0.39876204]
Stock Position:  -0.00488756651815415
Bond Position:  [-9.59402383]


portfolio before change:  [-10.11436054]
curr_Stock_Price:  105.47958598208858
curr_Factors:  [1.05479586e+02 3.33614659e-02]
mat_Sqrt:  [[ 1.92659744e+01  0.00000000e+00]
 [-7.30604855e-03  1.67402603e-02]]
grads:  [-1.68186329e-02 -2.83146152e+01]
Stock Position:  -0.016818632940324516
Bond Position:  [-8.3403381]


portfolio before change:  [-10.15644694]
curr_Stock_Price:  107.73394214760846
curr_Factors:  [1.07733942e+02 2.99299464e-02]
mat_Sqrt:  [[ 1.86382667e+01  0.00000000e+00]
 [-6.92010941e-03  1.58559626e-02]]
grads:  [2.77018506e-02 4.77967393e+01]
Stock Position:  0.027701850589520682
Bond Position:  [-13.14087651]


portfolio before change:  [-10.10656507]
curr_Stock_Price:  109.77185481680564
curr_Factors:  [1.09771855e+02 3.03793196e-02]
mat_Sqrt:  [[ 1.91328657e+01  0.00000000e+00]
 [-6.97186570e-03  1.59745512e-02]]
grads:  [ 1.17128234e-03 -3.14241317e+01]
Stock Position:  0.0011712823439014816
Bond Position:  [-10.2351389]


portfolio before change:  [-10.10859507]
curr_Stock_Price:  112.40900403625481
curr_Factors:  [1.12409004e+02 2.82876445e-02]
mat_Sqrt:  [[ 1.89059930e+01  0.00000000e+00]
 [-6.72757246e-03  1.54148050e-02]]
grads:  [-2.23053465e-03 -2.97367439e+00]
Stock Position:  -0.0022305346461788276
Bond Position:  [-9.85786289]


portfolio before change:  [-10.12120112]
curr_Stock_Price:  115.85027882959727
curr_Factors:  [1.15850279e+02 2.55321916e-02]
mat_Sqrt:  [[ 1.85114795e+01  0.00000000e+00]
 [-6.39151833e-03  1.46448083e-02]]
grads:  [ 8.37791789e-03 -5.22105430e+01]
Stock Position:  0.008377917891329275
Bond Position:  [-11.09178524]


portfolio before change:  [-10.13426995]
curr_Stock_Price:  114.95249569538636
curr_Factors:  [1.14952496e+02 2.33683015e-02]
mat_Sqrt:  [[ 1.75724363e+01  0.00000000e+00]
 [-6.11467762e-03  1.40104865e-02]]
grads:  [6.76757312e-03 2.62937368e+01]
Stock Position:  0.006767573122561441
Bond Position:  [-10.91221937]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.11109132]
Stock Price:  119.18386606191856
PL:  [-29.29495738]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.76560630e-01 -3.03918309e-01]
 [-7.87769086e-02  2.34309271e-01]
 [-9.77371477e-02  1.69242915e-02]
 [-7.85189740e-02 -5.08599471e-01]
 [ 2.47362610e-01  1.04622323e+00]
 [ 3.03513003e-01 -1.80263082e-01]
 [-3.65830040e-01 -1.72025937e-02]
 [ 9.38954791e-02 -1.39170383e-01]
 [-4.12200328e-02  1.94679834e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.04232889]
curr_Stock_Price:  102.8021995347311
curr_Factors:  [1.02802200e+02 4.29591452e-02]
mat_Sqrt:  [[ 2.13073884e+01  0.00000000e+00]
 [-8.29063521e-03  1.89962317e-02]]
grads:  [ 1.14476632e-02 -1.59988735e+01]
Stock Position:  0.011447663176744222
Bond Position:  [19.86548393]


portfolio before change:  [21.08808602]
curr_Stock_Price:  105.93138866667007
curr_Factors:  [1.05931389e+02 4.49008058e-02]
mat_Sqrt:  [[ 2.24466602e+01  0.00000000e+00]
 [-8.47592409e-03  1.94207819e-02]]
grads:  [1.04621537e-03 1.20648732e+01]
Stock Position:  0.0010462153748262096
Bond Position:  [20.97725897]


portfolio before change:  [21.10143467]
curr_Stock_Price:  108.662572485947
curr_Factors:  [1.08662572e+02 4.40756664e-02]
mat_Sqrt:  [[ 2.28128438e+01  0.00000000e+00]
 [-8.39768219e-03  1.92415072e-02]]
grads:  [-0.00396052  0.87957203]
Stock Position:  -0.0039605225161941215
Bond Position:  [21.53179524]


portfolio before change:  [21.11255029]
curr_Stock_Price:  108.57495098383667
curr_Factors:  [1.08574951e+02 4.25152967e-02]
mat_Sqrt:  [[ 2.23873273e+01  0.00000000e+00]
 [-8.24769512e-03  1.88978436e-02]]
grads:  [-1.34223249e-02 -2.69130956e+01]
Stock Position:  -0.013422324902250577
Bond Position:  [22.56987856]


portfolio before change:  [21.09207859]
curr_Stock_Price:  110.94111813563259
curr_Factors:  [1.10941118e+02 4.50755189e-02]
mat_Sqrt:  [[ 2.35539043e+01  0.00000000e+00]
 [-8.49239838e-03  1.94585292e-02]]
grads:  [2.98876931e-02 5.37668198e+01]
Stock Position:  0.02988769308330671
Bond Position:  [17.7763045]


portfolio before change:  [21.12305064]
curr_Stock_Price:  111.6799399891778
curr_Factors:  [1.11679940e+02 4.72671096e-02]
mat_Sqrt:  [[ 2.42803361e+01  0.00000000e+00]
 [-8.69640013e-03  1.99259559e-02]]
grads:  [ 0.00926016 -9.0466466 ]
Stock Position:  0.009260157793932692
Bond Position:  [20.08887678]


portfolio before change:  [21.09647308]
curr_Stock_Price:  107.72487698871305
curr_Factors:  [1.07724877e+02 5.04993926e-02]
mat_Sqrt:  [[ 2.42080097e+01  0.00000000e+00]
 [-8.98882796e-03  2.05959923e-02]]
grads:  [-0.01542208 -0.83523986]
Stock Position:  -0.015422080242229167
Bond Position:  [22.75781478]


portfolio before change:  [21.14779394]
curr_Stock_Price:  105.13514203386087
curr_Factors:  [1.05135142e+02 5.11590522e-02]
mat_Sqrt:  [[ 2.37798522e+01  0.00000000e+00]
 [-9.04734677e-03  2.07300757e-02]]
grads:  [ 1.39431247e-03 -6.71345272e+00]
Stock Position:  0.0013943124671915233
Bond Position:  [21.0012027]


portfolio before change:  [21.1600268]
curr_Stock_Price:  106.37563722504797
curr_Factors:  [1.06375637e+02 5.35282833e-02]
mat_Sqrt:  [[ 2.46112591e+01  0.00000000e+00]
 [-9.25447207e-03  2.12046594e-02]]
grads:  [1.77744716e-03 9.18099323e+00]
Stock Position:  0.001777447159817521
Bond Position:  [20.97094973]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.16935927]
Stock Price:  105.7254770677416
PL:  [15.44388221]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.31492432e-01  2.79427387e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 5.48837583e-02  5.36947358e-02]
 [-1.56390909e-01 -4.24144727e-01]
 [ 1.25829294e-01  4.79208935e-01]
 [ 1.63211044e-01 -6.79209520e-01]
 [-4.50358988e-01  1.47387581e-02]
 [ 1.10318339e-01 -1.65852390e-01]
 [-3.62127780e-02  1.47727250e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.76422867]
curr_Stock_Price:  99.36725744833196
curr_Factors:  [9.93672574e+01 3.71537059e-02]
mat_Sqrt:  [[ 1.91533336e+01  0.00000000e+00]
 [-7.71011864e-03  1.76661011e-02]]
grads:  [-0.01616117 15.81715086]
Stock Position:  -0.016161172209180442
Bond Position:  [-0.15833731]


portfolio before change:  [-1.74043469]
curr_Stock_Price:  97.8900641208613
curr_Factors:  [9.78900641e+01 3.56033618e-02]
mat_Sqrt:  [[ 1.84707324e+01  0.00000000e+00]
 [-7.54754124e-03  1.72935895e-02]]
grads:  [ 0.00508695 -2.73378831]
Stock Position:  0.005086948852742962
Bond Position:  [-2.23839644]


portfolio before change:  [-1.73001459]
curr_Stock_Price:  100.1585304555738
curr_Factors:  [1.00158530e+02 3.59269247e-02]
mat_Sqrt:  [[ 1.89844476e+01  0.00000000e+00]
 [-7.58175965e-03  1.73719938e-02]]
grads:  [0.00412538 3.09087929]
Stock Position:  0.0041253800846641295
Bond Position:  [-2.1432066]


portfolio before change:  [-1.72523757]
curr_Stock_Price:  101.57631387732968
curr_Factors:  [1.01576314e+02 3.52122481e-02]
mat_Sqrt:  [[ 1.90607210e+01  0.00000000e+00]
 [-7.50597076e-03  1.71983396e-02]]
grads:  [-1.79165753e-02 -2.46619579e+01]
Stock Position:  -0.017916575282223738
Bond Position:  [0.09466211]


portfolio before change:  [-1.78027834]
curr_Stock_Price:  104.65101487198775
curr_Factors:  [1.04651015e+02 3.47447520e-02]
mat_Sqrt:  [[ 1.95068908e+01  0.00000000e+00]
 [-7.45597768e-03  1.70837911e-02]]
grads:  [1.71720457e-02 2.80505031e+01]
Stock Position:  0.017172045673191055
Bond Position:  [-3.57735034]


portfolio before change:  [-1.75831952]
curr_Stock_Price:  106.0339564463965
curr_Factors:  [1.06033956e+02 3.40255672e-02]
mat_Sqrt:  [[ 1.95590453e+01  0.00000000e+00]
 [-7.37840820e-03  1.69060570e-02]]
grads:  [-6.81118585e-03 -4.01755133e+01]
Stock Position:  -0.006811185851001047
Bond Position:  [-1.03610254]


portfolio before change:  [-1.76207007]
curr_Stock_Price:  106.5085240766006
curr_Factors:  [1.06508524e+02 3.41763640e-02]
mat_Sqrt:  [[ 1.96900716e+01  0.00000000e+00]
 [-7.39474018e-03  1.69434783e-02]]
grads:  [-0.0225457   0.86987795]
Stock Position:  -0.0225457010381931
Bond Position:  [0.63923927]


portfolio before change:  [-1.74118898]
curr_Stock_Price:  105.5965366165362
curr_Factors:  [1.05596537e+02 3.46980332e-02]
mat_Sqrt:  [[ 1.96698978e+01  0.00000000e+00]
 [-7.45096323e-03  1.70723015e-02]]
grads:  [ 1.92855205e-03 -9.71470600e+00]
Stock Position:  0.0019285520545069088
Bond Position:  [-1.94483739]


portfolio before change:  [-1.74345934]
curr_Stock_Price:  104.9236479126008
curr_Factors:  [1.04923648e+02 3.32094987e-02]
mat_Sqrt:  [[ 1.91207332e+01  0.00000000e+00]
 [-7.28938941e-03  1.67020894e-02]]
grads:  [1.47801235e-03 8.84483654e+00]
Stock Position:  0.0014780123495280143
Bond Position:  [-1.89853779]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.74269703]
Stock Price:  106.08183715585906
PL:  [-7.82453418]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.49715028e-01  2.32965452e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-3.36850279e-02  2.34620874e-02]
 [-1.54165028e-01 -4.29011702e-01]
 [ 9.85164049e-02  3.51780512e-01]
 [ 1.93007766e-01 -7.04159806e-01]
 [-3.63058706e-01 -1.82479505e-02]
 [ 1.03660592e-01 -1.55325947e-01]
 [-3.80800350e-02  1.65117149e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.60826763]
curr_Stock_Price:  97.28217854322297
curr_Factors:  [9.72821785e+01 4.25927978e-02]
mat_Sqrt:  [[ 2.00771180e+01  0.00000000e+00]
 [-8.25520905e-03  1.89150602e-02]]
grads:  [-0.04223916 12.31640024]
Stock Position:  -0.04223915847611728
Bond Position:  [-11.49915028]


portfolio before change:  [-15.66540309]
curr_Stock_Price:  98.49869051441975
curr_Factors:  [9.84986905e+01 4.35568330e-02]
mat_Sqrt:  [[ 2.05569464e+01  0.00000000e+00]
 [-8.34810954e-03  1.91279219e-02]]
grads:  [ 0.0045707  -2.47162306]
Stock Position:  0.004570701746596124
Bond Position:  [-16.11561123]


portfolio before change:  [-15.66240452]
curr_Stock_Price:  100.91809668917712
curr_Factors:  [1.00918097e+02 4.12700246e-02]
mat_Sqrt:  [[ 2.05015367e+01  0.00000000e+00]
 [-8.12601005e-03  1.86190281e-02]]
grads:  [-1.14358908e-03  1.26011343e+00]
Stock Position:  -0.0011435890811715165
Bond Position:  [-15.54699569]


portfolio before change:  [-15.67127766]
curr_Stock_Price:  101.8779645727386
curr_Factors:  [1.01877965e+02 4.48087229e-02]
mat_Sqrt:  [[ 2.15655998e+01  0.00000000e+00]
 [-8.46722839e-03  1.94008575e-02]]
grads:  [-1.58308179e-02 -2.21130279e+01]
Stock Position:  -0.015830817944153995
Bond Position:  [-14.05846615]


portfolio before change:  [-15.69999914]
curr_Stock_Price:  103.24810758508447
curr_Factors:  [1.03248108e+02 4.51944130e-02]
mat_Sqrt:  [[ 2.19494921e+01  0.00000000e+00]
 [-8.50359105e-03  1.94841748e-02]]
grads:  [1.14829995e-02 1.80546785e+01]
Stock Position:  0.01148299951751557
Bond Position:  [-16.88559711]


portfolio before change:  [-15.64994345]
curr_Stock_Price:  108.34264721579234
curr_Factors:  [1.08342647e+02 4.37381372e-02]
mat_Sqrt:  [[ 2.26584180e+01  0.00000000e+00]
 [-8.36546589e-03  1.91676903e-02]]
grads:  [-5.04504632e-03 -3.67368104e+01]
Stock Position:  -0.0050450463242222195
Bond Position:  [-15.10334978]


portfolio before change:  [-15.65468712]
curr_Stock_Price:  107.7856871916282
curr_Factors:  [1.07785687e+02 4.24309129e-02]
mat_Sqrt:  [[ 2.22025207e+01  0.00000000e+00]
 [-8.23950609e-03  1.88790802e-02]]
grads:  [-0.01671084 -0.96656989]
Stock Position:  -0.01671083972088035
Bond Position:  [-13.85349778]


portfolio before change:  [-15.62193033]
curr_Stock_Price:  105.4108649501119
curr_Factors:  [1.05410865e+02 4.20978850e-02]
mat_Sqrt:  [[ 2.16279579e+01  0.00000000e+00]
 [-8.20710766e-03  1.88048460e-02]]
grads:  [ 1.65853806e-03 -8.25988934e+00]
Stock Position:  0.0016585380573650335
Bond Position:  [-15.79675826]


portfolio before change:  [-15.62974922]
curr_Stock_Price:  105.45998171669434
curr_Factors:  [1.05459982e+02 4.27710166e-02]
mat_Sqrt:  [[ 2.18103421e+01  0.00000000e+00]
 [-8.27246194e-03  1.89545915e-02]]
grads:  [1.55811388e-03 8.71119532e+00]
Stock Position:  0.0015581138781179211
Bond Position:  [-15.79406788]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.64023817]
Stock Price:  103.79775751028774
PL:  [-19.43799568]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.29124483e-01  2.83173932e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 1.76866461e-01 -5.55772669e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.97318046e-01 -1.91145993e+00]
 [-7.49058855e-01  3.75933754e-01]
 [ 2.08713868e-01  6.71109889e-03]
 [ 2.08677250e-01 -1.29614551e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.00257569]
curr_Stock_Price:  99.78397148828762
curr_Factors:  [9.97839715e+01 4.19799759e-02]
mat_Sqrt:  [[ 2.04447535e+01  0.00000000e+00]
 [-8.19560623e-03  1.87784930e-02]]
grads:  [-1.00533003e-02  1.50796943e+01]
Stock Position:  -0.010053300328608494
Bond Position:  [2.00573392]


portfolio before change:  [1.04943067]
curr_Stock_Price:  95.22309476687128
curr_Factors:  [9.52230948e+01 4.21788290e-02]
mat_Sqrt:  [[ 1.95564288e+01  0.00000000e+00]
 [-8.21499400e-03  1.88229159e-02]]
grads:  [ 0.00480454 -2.51167317]
Stock Position:  0.004804541357443936
Bond Position:  [0.59192737]


portfolio before change:  [1.03319565]
curr_Stock_Price:  91.78238092663018
curr_Factors:  [9.17823809e+01 4.50687104e-02]
mat_Sqrt:  [[ 1.94848418e+01  0.00000000e+00]
 [-8.49175698e-03  1.94570596e-02]]
grads:  [ 0.02067074 10.01718137]
Stock Position:  0.020670744196008048
Bond Position:  [-0.86401447]


portfolio before change:  [0.99903813]
curr_Stock_Price:  90.15082841080972
curr_Factors:  [9.01508284e+01 4.32915202e-02]
mat_Sqrt:  [[ 1.87573352e+01  0.00000000e+00]
 [-8.32264575e-03  1.90695771e-02]]
grads:  [-3.50223617e-03 -2.91444675e+01]
Stock Position:  -0.0035022361738875395
Bond Position:  [1.31476762]


portfolio before change:  [1.00034171]
curr_Stock_Price:  89.96636644883348
curr_Factors:  [8.99663664e+01 4.62896401e-02]
mat_Sqrt:  [[ 1.93562883e+01  0.00000000e+00]
 [-8.60601093e-03  1.97188483e-02]]
grads:  [-3.64053265e-03 -4.32048545e+00]
Stock Position:  -0.0036405326545255606
Bond Position:  [1.3278672]


portfolio before change:  [1.00358704]
curr_Stock_Price:  89.25734216167187
curr_Factors:  [8.92573422e+01 4.66953932e-02]
mat_Sqrt:  [[ 1.92877234e+01  0.00000000e+00]
 [-8.64364675e-03  1.98050828e-02]]
grads:  [-1.74676635e-02 -9.65136050e+01]
Stock Position:  -0.017467663478452827
Bond Position:  [2.56270425]


portfolio before change:  [1.00995197]
curr_Stock_Price:  88.96633210720279
curr_Factors:  [8.89663321e+01 4.72953869e-02]
mat_Sqrt:  [[ 1.93479554e+01  0.00000000e+00]
 [-8.69900104e-03  1.99319154e-02]]
grads:  [-0.03023513 18.86089457]
Stock Position:  -0.030235128320372576
Bond Position:  [3.69986044]


portfolio before change:  [1.03895217]
curr_Stock_Price:  88.06837634033343
curr_Factors:  [8.80683763e+01 4.88777760e-02]
mat_Sqrt:  [[ 1.94704374e+01  0.00000000e+00]
 [-8.84332752e-03  2.02626089e-02]]
grads:  [0.01086996 0.33120606]
Stock Position:  0.010869957749776815
Bond Position:  [0.08165264]


portfolio before change:  [1.01031164]
curr_Stock_Price:  85.42978543501714
curr_Factors:  [8.54297854e+01 4.85242486e-02]
mat_Sqrt:  [[ 1.88186613e+01  0.00000000e+00]
 [-8.81128809e-03  2.01891973e-02]]
grads:  [ 0.00808287 -6.41999526]
Stock Position:  0.00808287156023714
Bond Position:  [0.31979366]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.01402403]
Stock Price:  85.86929003234305
PL:  [1.01402403]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-5.21622754e-01  2.85544450e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.32560653e-02  8.28797937e-04]
 [-1.43953216e-01 -4.49802630e-01]
 [ 8.84734367e-02  3.05638391e-01]
 [ 3.49348785e-01 -6.66433713e-01]
 [-6.45547115e-01  8.84859563e-02]
 [ 3.31785314e-02 -4.07171411e-02]
 [-2.70396054e-02  4.16237690e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.72869902]
curr_Stock_Price:  99.07138456893595
curr_Factors:  [9.90713846e+01 4.26544636e-02]
mat_Sqrt:  [[ 2.04611705e+01  0.00000000e+00]
 [-8.26118283e-03  1.89287478e-02]]
grads:  [-0.01940265 15.0852266 ]
Stock Position:  -0.019402650444834874
Bond Position:  [-1.80645157]


portfolio before change:  [-3.76430361]
curr_Stock_Price:  100.85985899806374
curr_Factors:  [1.00859859e+02 4.09152742e-02]
mat_Sqrt:  [[ 2.04014526e+01  0.00000000e+00]
 [-8.09100975e-03  1.85388323e-02]]
grads:  [ 0.00460554 -2.55016131]
Stock Position:  0.004605538293957678
Bond Position:  [-4.22881755]


portfolio before change:  [-3.76434836]
curr_Stock_Price:  101.30935833868158
curr_Factors:  [1.01309358e+02 3.94976069e-02]
mat_Sqrt:  [[ 2.01342268e+01  0.00000000e+00]
 [-7.94960195e-03  1.82148263e-02]]
grads:  [-0.00461375  0.04550128]
Stock Position:  -0.0046137529463777475
Bond Position:  [-3.29693201]


portfolio before change:  [-3.77514119]
curr_Stock_Price:  103.29124687651498
curr_Factors:  [1.03291247e+02 4.13910493e-02]
mat_Sqrt:  [[ 2.10143876e+01  0.00000000e+00]
 [-8.13791613e-03  1.86463083e-02]]
grads:  [-1.61919150e-02 -2.41228785e+01]
Stock Position:  -0.016191915000261865
Bond Position:  [-2.1026581]


portfolio before change:  [-3.76711912]
curr_Stock_Price:  102.73086504886011
curr_Factors:  [1.02730865e+02 4.11228829e-02]
mat_Sqrt:  [[ 2.08325639e+01  0.00000000e+00]
 [-8.11151112e-03  1.85858069e-02]]
grads:  [1.06499117e-02 1.64447201e+01]
Stock Position:  0.010649911746394455
Bond Position:  [-4.86119377]


portfolio before change:  [-3.78994356]
curr_Stock_Price:  100.8159918143513
curr_Factors:  [1.00815992e+02 4.31769530e-02]
mat_Sqrt:  [[ 2.09486202e+01  0.00000000e+00]
 [-8.31162588e-03  1.90443274e-02]]
grads:  [ 2.79222531e-03 -3.49938173e+01]
Stock Position:  0.0027922253086128243
Bond Position:  [-4.07144452]


portfolio before change:  [-3.78422467]
curr_Stock_Price:  103.59338987456
curr_Factors:  [1.03593390e+02 4.02275116e-02]
mat_Sqrt:  [[ 2.07775162e+01  0.00000000e+00]
 [-8.02271890e-03  1.83823583e-02]]
grads:  [-0.02921084  4.81363461]
Stock Position:  -0.02921083887374562
Bond Position:  [-0.75817485]


portfolio before change:  [-3.78135944]
curr_Stock_Price:  103.48232101373102
curr_Factors:  [1.03482321e+02 4.18901628e-02]
mat_Sqrt:  [[ 2.11798161e+01  0.00000000e+00]
 [-8.18683458e-03  1.87583946e-02]]
grads:  [ 7.27490459e-04 -2.17060905e+00]
Stock Position:  0.0007274904585005745
Bond Position:  [-3.85664184]


portfolio before change:  [-3.78459231]
curr_Stock_Price:  101.68976472359529
curr_Factors:  [1.01689765e+02 4.33450116e-02]
mat_Sqrt:  [[ 2.11712648e+01  0.00000000e+00]
 [-8.32778594e-03  1.90813547e-02]]
grads:  [-4.19129575e-04  2.18138438e+00]
Stock Position:  -0.00041912957544328213
Bond Position:  [-3.74197112]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.78806072]
Stock Price:  105.49993845682914
PL:  [-9.28799917]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.00242486e+00  1.57627105e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.14723771e-01 -5.13525067e-01]
 [ 1.78177586e-02  9.20141542e-02]
 [ 3.75730763e-01 -7.49420691e-01]
 [-1.03779942e+00  2.52132780e-01]
 [-5.29191073e-02  1.12481804e-02]
 [-2.79868459e-02  1.63580186e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.04203855]
curr_Stock_Price:  96.76501131138473
curr_Factors:  [9.67650113e+01 4.38161190e-02]
mat_Sqrt:  [[ 2.02551426e+01  0.00000000e+00]
 [-8.37292007e-03  1.91847700e-02]]
grads:  [-0.04609352  8.21626243]
Stock Position:  -0.04609351644558147
Bond Position:  [-14.58179891]


portfolio before change:  [-19.07185642]
curr_Stock_Price:  97.2536949417752
curr_Factors:  [9.72536949e+01 4.29692920e-02]
mat_Sqrt:  [[ 2.01597531e+01  0.00000000e+00]
 [-8.29161427e-03  1.89984750e-02]]
grads:  [ 0.00466076 -2.48846357]
Stock Position:  0.004660755045794711
Bond Position:  [-19.52513207]


portfolio before change:  [-19.09158398]
curr_Stock_Price:  95.1161546982156
curr_Factors:  [9.51161547e+01 4.25213586e-02]
mat_Sqrt:  [[ 1.96136242e+01  0.00000000e+00]
 [-8.24828308e-03  1.88991908e-02]]
grads:  [ 0.02053502 10.31286984]
Stock Position:  0.020535020785557048
Bond Position:  [-21.04479619]


portfolio before change:  [-19.07533541]
curr_Stock_Price:  96.4199566412693
curr_Factors:  [9.64199566e+01 4.22472300e-02]
mat_Sqrt:  [[ 1.98182842e+01  0.00000000e+00]
 [-8.22165239e-03  1.88381722e-02]]
grads:  [-1.70975692e-02 -2.72598138e+01]
Stock Position:  -0.01709756917223877
Bond Position:  [-17.42678853]


portfolio before change:  [-19.14357236]
curr_Stock_Price:  99.90123370888018
curr_Factors:  [9.99012337e+01 4.10796478e-02]
mat_Sqrt:  [[ 2.02480968e+01  0.00000000e+00]
 [-8.10724593e-03  1.85760341e-02]]
grads:  [2.86328283e-03 4.95337992e+00]
Stock Position:  0.002863282830842924
Bond Position:  [-19.42961784]


portfolio before change:  [-19.15366867]
curr_Stock_Price:  99.76884093330796
curr_Factors:  [9.97688409e+01 3.78651202e-02]
mat_Sqrt:  [[ 1.94139808e+01  0.00000000e+00]
 [-7.78358480e-03  1.78344333e-02]]
grads:  [ 2.50627417e-03 -4.20209984e+01]
Stock Position:  0.0025062741697033835
Bond Position:  [-19.40371674]


portfolio before change:  [-19.16932164]
curr_Stock_Price:  97.39532399231054
curr_Factors:  [9.73953240e+01 3.91849615e-02]
mat_Sqrt:  [[ 1.92795911e+01  0.00000000e+00]
 [-7.91807668e-03  1.81425929e-02]]
grads:  [-0.04812133 13.89728477]
Stock Position:  -0.04812133474907301
Bond Position:  [-14.48252865]


portfolio before change:  [-19.17415879]
curr_Stock_Price:  97.34532694353722
curr_Factors:  [9.73453269e+01 3.83516997e-02]
mat_Sqrt:  [[ 1.90637097e+01  0.00000000e+00]
 [-7.83343600e-03  1.79486567e-02]]
grads:  [-0.0025184   0.62668647]
Stock Position:  -0.002518397502949417
Bond Position:  [-18.92900456]


portfolio before change:  [-19.19201686]
curr_Stock_Price:  100.6772879855989
curr_Factors:  [1.00677288e+02 3.73629757e-02]
mat_Sqrt:  [[ 1.94604212e+01  0.00000000e+00]
 [-7.73180193e-03  1.77157838e-02]]
grads:  [-0.00107128  0.92335845]
Stock Position:  -0.0010712831467044113
Bond Position:  [-19.08416298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.20249516]
Stock Price:  101.54898251716116
PL:  [-20.75147768]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 3.48088748e-01 -2.81326019e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 5.03149691e-03  3.71526724e-02]
 [-1.28663983e-01 -4.64000052e-01]
 [ 7.49116726e-02  2.63979001e-01]
 [ 3.36051575e-01 -6.24606094e-01]
 [-7.30588649e-01  1.20618953e-01]
 [-2.69389574e-02  2.09166872e-02]
 [-3.21361705e-02  1.08498497e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.2017842]
curr_Stock_Price:  102.6756033870206
curr_Factors:  [1.02675603e+02 3.84127469e-02]
mat_Sqrt:  [[ 2.01235662e+01  0.00000000e+00]
 [-7.83966805e-03  1.79629361e-02]]
grads:  [ 1.11962266e-02 -1.56614719e+01]
Stock Position:  0.011196226603913917
Bond Position:  [19.05220487]


portfolio before change:  [20.17202024]
curr_Stock_Price:  99.16616722932548
curr_Factors:  [9.91661672e+01 4.15875557e-02]
mat_Sqrt:  [[ 2.02229834e+01  0.00000000e+00]
 [-8.15721087e-03  1.86905181e-02]]
grads:  [ 0.00464618 -2.52946507]
Stock Position:  0.004646182465094398
Bond Position:  [19.71127613]


portfolio before change:  [20.18869197]
curr_Stock_Price:  100.63266698050785
curr_Factors:  [1.00632667e+02 4.01683876e-02]
mat_Sqrt:  [[ 2.01688521e+01  0.00000000e+00]
 [-8.01682108e-03  1.83688447e-02]]
grads:  [1.05341902e-03 2.02259168e+00]
Stock Position:  0.0010534190217274684
Bond Position:  [20.0826836]


portfolio before change:  [20.20287148]
curr_Stock_Price:  104.55860584947395
curr_Factors:  [1.04558606e+02 3.72643651e-02]
mat_Sqrt:  [[ 2.01839726e+01  0.00000000e+00]
 [-7.72159207e-03  1.76923901e-02]]
grads:  [-1.64075831e-02 -2.62259678e+01]
Stock Position:  -0.01640758314428568
Bond Position:  [21.9184255]


portfolio before change:  [20.2527611]
curr_Stock_Price:  102.18606466504963
curr_Factors:  [1.02186065e+02 3.79919716e-02]
mat_Sqrt:  [[ 1.99176268e+01  0.00000000e+00]
 [-7.79661174e-03  1.78642817e-02]]
grads:  [9.54539194e-03 1.47769166e+01]
Stock Position:  0.00954539193994414
Bond Position:  [19.27735506]


portfolio before change:  [20.25563875]
curr_Stock_Price:  101.47750931003708
curr_Factors:  [1.01477509e+02 3.48274483e-02]
mat_Sqrt:  [[ 1.89378480e+01  0.00000000e+00]
 [-7.46484543e-03  1.71041096e-02]]
grads:  [ 3.35049295e-03 -3.65178959e+01]
Stock Position:  0.0033504929505905052
Bond Position:  [19.91563907]


portfolio before change:  [20.26851099]
curr_Stock_Price:  102.34661409286402
curr_Factors:  [1.02346614e+02 3.32787227e-02]
mat_Sqrt:  [[ 1.86705368e+01  0.00000000e+00]
 [-7.29698269e-03  1.67194878e-02]]
grads:  [-0.03631102  7.21427323]
Stock Position:  -0.03631101934948178
Bond Position:  [23.98482087]


portfolio before change:  [20.31374616]
curr_Stock_Price:  101.43119605801016
curr_Factors:  [1.01431196e+02 3.27115896e-02]
mat_Sqrt:  [[ 1.83451966e+01  0.00000000e+00]
 [-7.23453822e-03  1.65764095e-02]]
grads:  [-9.70835421e-04  1.26183461e+00]
Stock Position:  -0.0009708354211989936
Bond Position:  [20.41221915]


portfolio before change:  [20.32175375]
curr_Stock_Price:  103.69838754670695
curr_Factors:  [1.03698388e+02 3.33605873e-02]
mat_Sqrt:  [[ 1.89403869e+01  0.00000000e+00]
 [-7.30595235e-03  1.67400398e-02]]
grads:  [8.03386743e-04 6.48137629e+00]
Stock Position:  0.0008033867433472908
Bond Position:  [20.23844384]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.33350368]
Stock Price:  105.72503280813497
PL:  [14.60847087]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.99536233e-01  3.07338371e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-8.67538483e-02  4.01240832e-03]
 [-1.36742060e-01 -4.49131053e-01]
 [-3.39997842e-02 -8.87925469e-02]
 [ 4.15841834e-01 -1.07519909e+00]
 [-1.03879927e+00  2.76974118e-01]
 [ 9.55291256e-03  9.11902087e-02]
 [-3.51026438e-02 -2.03481517e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.53440936]
curr_Stock_Price:  100.01468407839367
curr_Factors:  [1.00014684e+02 4.09361993e-02]
mat_Sqrt:  [[ 2.02356671e+01  0.00000000e+00]
 [-8.09307845e-03  1.85435723e-02]]
grads:  [-8.17382348e-03  1.65738492e+01]
Stock Position:  -0.008173823481332186
Bond Position:  [3.35191174]


portfolio before change:  [2.52346921]
curr_Stock_Price:  101.55821219027844
curr_Factors:  [1.01558212e+02 4.27763801e-02]
mat_Sqrt:  [[ 2.10047280e+01  0.00000000e+00]
 [-8.27298061e-03  1.89557799e-02]]
grads:  [ 0.00447326 -2.49406846]
Stock Position:  0.0044732629223280945
Bond Position:  [2.06917263]


portfolio before change:  [2.52334546]
curr_Stock_Price:  101.29920762639307
curr_Factors:  [1.01299208e+02 4.45170954e-02]
mat_Sqrt:  [[ 2.13731955e+01  0.00000000e+00]
 [-8.43962989e-03  1.93376214e-02]]
grads:  [-0.00397707  0.20749234]
Stock Position:  -0.0039770697710582075
Bond Position:  [2.92621948]


portfolio before change:  [2.53692277]
curr_Stock_Price:  98.25328767311497
curr_Factors:  [9.82532877e+01 4.20674008e-02]
mat_Sqrt:  [[ 2.01520824e+01  0.00000000e+00]
 [-8.20413562e-03  1.87980363e-02]]
grads:  [-1.65123839e-02 -2.38924453e+01]
Stock Position:  -0.016512383894630757
Bond Position:  [4.15931878]


portfolio before change:  [2.55460013]
curr_Stock_Price:  97.30871291165747
curr_Factors:  [9.73087129e+01 4.34511376e-02]
mat_Sqrt:  [[ 2.02839394e+01  0.00000000e+00]
 [-8.33797458e-03  1.91046998e-02]]
grads:  [-3.58668143e-03 -4.64768082e+00]
Stock Position:  -0.0035866814313389866
Bond Position:  [2.90361549]


portfolio before change:  [2.55832857]
curr_Stock_Price:  96.67406738149845
curr_Factors:  [9.66740674e+01 4.21904026e-02]
mat_Sqrt:  [[ 1.98571459e+01  0.00000000e+00]
 [-8.21612099e-03  1.88254982e-02]]
grads:  [-2.68988903e-03 -5.71139779e+01]
Stock Position:  -0.002689889026041309
Bond Position:  [2.81837109]


portfolio before change:  [2.56241464]
curr_Stock_Price:  95.6790360936536
curr_Factors:  [9.56790361e+01 4.25507801e-02]
mat_Sqrt:  [[ 1.97365189e+01  0.00000000e+00]
 [-8.25113618e-03  1.89057280e-02]]
grads:  [-0.0465086  14.65027518]
Stock Position:  -0.0465085996538971
Bond Position:  [7.01231262]


portfolio before change:  [2.6856935]
curr_Stock_Price:  93.10377400948569
curr_Factors:  [9.3103774e+01 4.1836379e-02]
mat_Sqrt:  [[ 1.90433930e+01  0.00000000e+00]
 [-8.18157726e-03  1.87463485e-02]]
grads:  [2.59153306e-03 4.86442511e+00]
Stock Position:  0.002591533055186405
Bond Position:  [2.44441199]


portfolio before change:  [2.68795674]
curr_Stock_Price:  93.50536115325927
curr_Factors:  [9.35053612e+01 4.13972945e-02]
mat_Sqrt:  [[ 1.90249048e+01  0.00000000e+00]
 [-8.13853004e-03  1.86477150e-02]]
grads:  [-6.51300283e-03 -1.09118741e+01]
Stock Position:  -0.0065130028326843515
Bond Position:  [3.29695742]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.69433552]
Stock Price:  92.77913861329164
PL:  [2.69433552]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-4.05376204e-01  2.77096488e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 7.28428068e-02  5.64716723e-02]
 [-1.43926557e-01 -4.49669423e-01]
 [ 1.26203209e-01  4.80953436e-01]
 [ 2.20807947e-01 -6.40307789e-01]
 [-3.15023434e-01 -3.63948701e-02]
 [ 3.62803278e-01 -5.65295700e-01]
 [-5.23931979e-02  3.03626739e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.12407499]
curr_Stock_Price:  99.46367229861104
curr_Factors:  [9.94636723e+01 4.11267497e-02]
mat_Sqrt:  [[ 2.01709654e+01  0.00000000e+00]
 [-8.11189248e-03  1.85866807e-02]]
grads:  [-1.41015255e-02  1.49083364e+01]
Stock Position:  -0.014101525494025059
Bond Position:  [0.27851452]


portfolio before change:  [-1.0984449]
curr_Stock_Price:  97.65601020744269
curr_Factors:  [9.76560102e+01 4.22795546e-02]
mat_Sqrt:  [[ 2.00800217e+01  0.00000000e+00]
 [-8.22479710e-03  1.88453776e-02]]
grads:  [ 0.00467926 -2.50867952]
Stock Position:  0.004679261418884004
Bond Position:  [-1.55540291]


portfolio before change:  [-1.08979323]
curr_Stock_Price:  99.67119456945423
curr_Factors:  [9.96711946e+01 3.72714982e-02]
mat_Sqrt:  [[ 1.92423490e+01  0.00000000e+00]
 [-7.72233106e-03  1.76940833e-02]]
grads:  [0.00506638 3.19155682]
Stock Position:  0.00506638066306822
Bond Position:  [-1.59476544]


portfolio before change:  [-1.0722134]
curr_Stock_Price:  103.2985187819086
curr_Factors:  [1.03298519e+02 3.55971750e-02]
mat_Sqrt:  [[ 1.94895522e+01  0.00000000e+00]
 [-7.54688545e-03  1.72920869e-02]]
grads:  [-1.74543971e-02 -2.60043467e+01]
Stock Position:  -0.017454397058974697
Bond Position:  [0.73079996]


portfolio before change:  [-1.09577029]
curr_Stock_Price:  104.66908334180107
curr_Factors:  [1.04669083e+02 3.32446441e-02]
mat_Sqrt:  [[ 1.90844331e+01  0.00000000e+00]
 [-7.29324554e-03  1.67109249e-02]]
grads:  [1.76116574e-02 2.87807790e+01]
Stock Position:  0.01761165736707796
Bond Position:  [-2.93916632]


portfolio before change:  [-1.09987042]
curr_Stock_Price:  104.51974016464524
curr_Factors:  [1.04519740e+02 3.37168802e-02]
mat_Sqrt:  [[ 1.91920786e+01  0.00000000e+00]
 [-7.34486271e-03  1.68291947e-02]]
grads:  [-3.05570251e-03 -3.80474408e+01]
Stock Position:  -0.0030557025077640855
Bond Position:  [-0.78048919]


portfolio before change:  [-1.11250377]
curr_Stock_Price:  108.52634989804758
curr_Factors:  [1.08526350e+02 3.13825416e-02]
mat_Sqrt:  [[ 1.92255713e+01  0.00000000e+00]
 [-7.08604732e-03  1.62361741e-02]]
grads:  [-0.01721184 -2.24159152]
Stock Position:  -0.017211840058225982
Bond Position:  [0.75543441]


portfolio before change:  [-1.17943254]
curr_Stock_Price:  112.436831045324
curr_Factors:  [1.12436831e+02 2.87522275e-02]
mat_Sqrt:  [[ 1.90653308e+01  0.00000000e+00]
 [-6.78259272e-03  1.55408723e-02]]
grads:  [ 6.08895848e-03 -3.63747729e+01]
Stock Position:  0.006088958477243416
Bond Position:  [-1.86405573]


portfolio before change:  [-1.19644901]
curr_Stock_Price:  109.79529302524065
curr_Factors:  [1.09795293e+02 2.93293254e-02]
mat_Sqrt:  [[ 1.88033296e+01  0.00000000e+00]
 [-6.85032266e-03  1.56960611e-02]]
grads:  [4.26096742e-03 1.93441359e+01]
Stock Position:  0.004260967417605939
Bond Position:  [-1.66428318]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.19470231]
Stock Price:  110.40056571767084
PL:  [-11.59526803]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.79883906e-01  1.88895055e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 6.08547337e-02  5.51760197e-02]
 [-1.59741879e-01 -4.17281957e-01]
 [ 6.15661054e-02  2.22957824e-01]
 [ 1.87977728e-01 -6.49661877e-01]
 [-5.07303774e-01  3.62540778e-02]
 [ 1.57169599e-01 -2.39997885e-01]
 [-4.60325650e-02  2.42069504e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.63667509]
curr_Stock_Price:  96.97667596517927
curr_Factors:  [9.69766760e+01 4.09347108e-02]
mat_Sqrt:  [[ 1.96206394e+01  0.00000000e+00]
 [-8.09293132e-03  1.85432352e-02]]
grads:  [-0.04573976 10.18673675]
Stock Position:  -0.045739760273432406
Bond Position:  [-13.20098518]


portfolio before change:  [-17.71890072]
curr_Stock_Price:  98.63001845724978
curr_Factors:  [9.86300185e+01 3.84456497e-02]
mat_Sqrt:  [[ 1.93389423e+01  0.00000000e+00]
 [-7.84302490e-03  1.79706276e-02]]
grads:  [ 0.00485857 -2.63079364]
Stock Position:  0.004858573430982606
Bond Position:  [-18.19810191]


portfolio before change:  [-17.72126203]
curr_Stock_Price:  100.01726042193214
curr_Factors:  [1.00017260e+02 3.51041123e-02]
mat_Sqrt:  [[ 1.87393254e+01  0.00000000e+00]
 [-7.49443659e-03  1.71719115e-02]]
grads:  [0.00453247 3.21315538]
Stock Position:  0.004532474949551065
Bond Position:  [-18.17458776]


portfolio before change:  [-17.72538373]
curr_Stock_Price:  101.11332033366608
curr_Factors:  [1.01113320e+02 3.50902576e-02]
mat_Sqrt:  [[ 1.89409453e+01  0.00000000e+00]
 [-7.49295750e-03  1.71685225e-02]]
grads:  [-1.80486586e-02 -2.43050593e+01]
Stock Position:  -0.01804865859445516
Bond Position:  [-15.90042393]


portfolio before change:  [-17.74303788]
curr_Stock_Price:  101.65086424599015
curr_Factors:  [1.01650864e+02 3.62296646e-02]
mat_Sqrt:  [[ 1.93483187e+01  0.00000000e+00]
 [-7.61363667e-03  1.74450332e-02]]
grads:  [8.21119807e-03 1.27805904e+01]
Stock Position:  0.00821119806965843
Bond Position:  [-18.57771326]


portfolio before change:  [-17.72280115]
curr_Stock_Price:  105.24691716425838
curr_Factors:  [1.05246917e+02 3.59508299e-02]
mat_Sqrt:  [[ 1.99555565e+01  0.00000000e+00]
 [-7.58428163e-03  1.73777723e-02]]
grads:  [-4.78853897e-03 -3.73846466e+01]
Stock Position:  -0.004788538973861916
Bond Position:  [-17.21882219]


portfolio before change:  [-17.73338603]
curr_Stock_Price:  105.65900756589132
curr_Factors:  [1.05659008e+02 3.55497230e-02]
mat_Sqrt:  [[ 1.99216193e+01  0.00000000e+00]
 [-7.54185367e-03  1.72805577e-02]]
grads:  [-0.02467075  2.0979692 ]
Stock Position:  -0.02467074531413893
Bond Position:  [-15.12669956]


portfolio before change:  [-17.77069061]
curr_Stock_Price:  106.86445701097203
curr_Factors:  [1.06864457e+02 3.56694459e-02]
mat_Sqrt:  [[ 2.01828022e+01  0.00000000e+00]
 [-7.55454257e-03  1.73096316e-02]]
grads:  [ 2.59755481e-03 -1.38649910e+01]
Stock Position:  0.002597554811767912
Bond Position:  [-18.04827689]


portfolio before change:  [-17.77710891]
curr_Stock_Price:  107.86851148552068
curr_Factors:  [1.07868511e+02 3.53841914e-02]
mat_Sqrt:  [[ 2.02908072e+01  0.00000000e+00]
 [-7.52427446e-03  1.72402786e-02]]
grads:  [2.93804123e-03 1.40409276e+01]
Stock Position:  0.0029380412302259856
Bond Position:  [-18.09403105]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.79580524]
Stock Price:  104.5850133870215
PL:  [-22.38081863]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.27981586e-01  2.84105921e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.49457550e-01  9.35633513e-02]
 [-1.64540125e-01 -4.09270324e-01]
 [ 6.48670095e-02  2.33054728e-01]
 [ 3.03469528e-01 -6.05099774e-01]
 [-5.50518491e-01  5.25816483e-02]
 [ 1.55957959e-02 -1.23105800e-02]
 [-2.95215208e-02  8.28625155e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.06027687]
curr_Stock_Price:  99.7926619808721
curr_Factors:  [9.97926620e+01 4.18513216e-02]
mat_Sqrt:  [[ 2.04151792e+01  0.00000000e+00]
 [-8.18303823e-03  1.87496960e-02]]
grads:  [-9.99195718e-03  1.51525614e+01]
Stock Position:  -0.00999195717664699
Bond Position:  [2.05740087]


portfolio before change:  [1.07328428]
curr_Stock_Price:  98.59385263398624
curr_Factors:  [9.85938526e+01 4.39398156e-02]
mat_Sqrt:  [[ 2.06670720e+01  0.00000000e+00]
 [-8.38473046e-03  1.92118310e-02]]
grads:  [ 0.00454635 -2.46082806]
Stock Position:  0.004546346531268073
Bond Position:  [0.62504246]


portfolio before change:  [1.07328725]
curr_Stock_Price:  98.52574827917971
curr_Factors:  [9.85257483e+01 4.47241237e-02]
mat_Sqrt:  [[ 2.08363029e+01  0.00000000e+00]
 [-8.45923152e-03  1.93825344e-02]]
grads:  [0.00913271 4.82719903]
Stock Position:  0.009132711565599751
Bond Position:  [0.17348001]


portfolio before change:  [1.08957669]
curr_Stock_Price:  100.29988508141656
curr_Factors:  [1.00299885e+02 4.47766127e-02]
mat_Sqrt:  [[ 2.12239422e+01  0.00000000e+00]
 [-8.46419402e-03  1.93939049e-02]]
grads:  [-1.61685485e-02 -2.11030386e+01]
Stock Position:  -0.016168548512738738
Bond Position:  [2.71128025]


portfolio before change:  [1.0669208]
curr_Stock_Price:  101.78498258526078
curr_Factors:  [1.01784983e+02 3.91754021e-02]
mat_Sqrt:  [[ 2.01460746e+01  0.00000000e+00]
 [-7.91711079e-03  1.81403797e-02]]
grads:  [8.26862975e-03 1.28472905e+01]
Stock Position:  0.0082686297503299
Bond Position:  [0.22529846]


portfolio before change:  [1.07213688]
curr_Stock_Price:  102.40218257052425
curr_Factors:  [1.02402183e+02 3.90971277e-02]
mat_Sqrt:  [[ 2.02479770e+01  0.00000000e+00]
 [-7.90919745e-03  1.81222480e-02]]
grads:  [ 1.94500099e-03 -3.33898849e+01]
Stock Position:  0.001945000994295623
Bond Position:  [0.87296453]


portfolio before change:  [1.07765083]
curr_Stock_Price:  105.01264869381414
curr_Factors:  [1.05012649e+02 3.72787764e-02]
mat_Sqrt:  [[ 2.02755403e+01  0.00000000e+00]
 [-7.72308502e-03  1.76958108e-02]]
grads:  [-0.02602002  2.97141785]
Stock Position:  -0.026020020658814216
Bond Position:  [3.81008211]


portfolio before change:  [1.13174612]
curr_Stock_Price:  103.00689403990168
curr_Factors:  [1.03006894e+02 3.57890851e-02]
mat_Sqrt:  [[ 1.94868477e+01  0.00000000e+00]
 [-7.56720134e-03  1.73386365e-02]]
grads:  [ 5.24611188e-04 -7.10008540e-01]
Stock Position:  0.0005246111877391385
Bond Position:  [1.07770755]


portfolio before change:  [1.13222487]
curr_Stock_Price:  102.89207663709453
curr_Factors:  [1.02892077e+02 4.13731513e-02]
mat_Sqrt:  [[ 2.09286509e+01  0.00000000e+00]
 [-8.13615647e-03  1.86422764e-02]]
grads:  [3.17394840e-04 4.44487108e+00]
Stock Position:  0.0003173948402497601
Bond Position:  [1.09956746]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.13378867]
Stock Price:  106.0864403472652
PL:  [-4.95265168]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.07828297e-01  3.00558682e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.91556529e-02  6.82588014e-03]
 [-1.54830147e-01 -4.27426524e-01]
 [ 4.26120669e-02  1.65064555e-01]
 [ 3.16918477e-01 -5.99504970e-01]
 [-7.56130508e-01  1.30267925e-01]
 [ 6.29739586e-02 -8.92186212e-02]
 [-3.34649842e-02  1.20795063e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.09712474]
curr_Stock_Price:  99.94882375139392
curr_Factors:  [9.99488238e+01 4.07480645e-02]
mat_Sqrt:  [[ 2.01758193e+01  0.00000000e+00]
 [-8.07445993e-03  1.85009119e-02]]
grads:  [-8.75571548e-03  1.62456145e+01]
Stock Position:  -0.008755715481143359
Bond Position:  [2.97224821]


portfolio before change:  [2.08223523]
curr_Stock_Price:  101.81914561348353
curr_Factors:  [1.01819146e+02 3.82438419e-02]
mat_Sqrt:  [[ 1.99117855e+01  0.00000000e+00]
 [-7.82241312e-03  1.79234001e-02]]
grads:  [ 0.0047188  -2.63772568]
Stock Position:  0.004718796860644654
Bond Position:  [1.60177137]


portfolio before change:  [2.08724599]
curr_Stock_Price:  102.71125208050705
curr_Factors:  [1.02711252e+02 3.90454340e-02]
mat_Sqrt:  [[ 2.02956587e+01  0.00000000e+00]
 [-7.90396701e-03  1.81102636e-02]]
grads:  [-0.00473878  0.37690673]
Stock Position:  -0.004738776702237685
Bond Position:  [2.57397168]


portfolio before change:  [2.09289735]
curr_Stock_Price:  101.79032853043914
curr_Factors:  [1.01790329e+02 3.79030903e-02]
mat_Sqrt:  [[ 1.9817270e+01  0.0000000e+00]
 [-7.7874864e-03  1.7843373e-02]]
grads:  [-1.72261051e-02 -2.39543569e+01]
Stock Position:  -0.017226105090446812
Bond Position:  [3.84634824]


portfolio before change:  [2.1103549]
curr_Stock_Price:  100.88856355284587
curr_Factors:  [1.00888564e+02 3.82294802e-02]
mat_Sqrt:  [[ 1.97260957e+01  0.00000000e+00]
 [-7.82094421e-03  1.79200344e-02]]
grads:  [5.81220666e-03 9.21117398e+00]
Stock Position:  0.005812206660259738
Bond Position:  [1.52396972]


portfolio before change:  [2.11789802]
curr_Stock_Price:  102.05523631347378
curr_Factors:  [1.02055236e+02 3.98452297e-02]
mat_Sqrt:  [[ 2.03715212e+01  0.00000000e+00]
 [-7.98450797e-03  1.82948061e-02]]
grads:  [ 2.71325134e-03 -3.27691350e+01]
Stock Position:  0.0027132513395952836
Bond Position:  [1.84099651]


portfolio before change:  [2.11853119]
curr_Stock_Price:  101.94925474915844
curr_Factors:  [1.01949255e+02 4.06027292e-02]
mat_Sqrt:  [[ 2.05428961e+01  0.00000000e+00]
 [-8.06004756e-03  1.84678890e-02]]
grads:  [-0.03403984  7.05375287]
Stock Position:  -0.03403984142365154
Bond Position:  [5.58886766]


portfolio before change:  [2.04133484]
curr_Stock_Price:  104.2991917707379
curr_Factors:  [1.04299192e+02 4.02699273e-02]
mat_Sqrt:  [[ 2.09301030e+01  0.00000000e+00]
 [-8.02694734e-03  1.83920469e-02]]
grads:  [ 1.14838231e-03 -4.85093485e+00]
Stock Position:  0.0011483823093944895
Bond Position:  [1.9215595]


portfolio before change:  [2.04204033]
curr_Stock_Price:  104.0766752011087
curr_Factors:  [1.04076675e+02 4.14762800e-02]
mat_Sqrt:  [[ 2.11959706e+01  0.00000000e+00]
 [-8.14629044e-03  1.86654963e-02]]
grads:  [9.08394516e-04 6.47156986e+00]
Stock Position:  0.0009083945158036185
Bond Position:  [1.94749765]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.04475778]
Stock Price:  105.99595296106311
PL:  [-3.95119518]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.22634187e-01  2.88452537e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.86320082e-02 -6.88791268e-05]
 [-1.63655973e-01 -4.09483606e-01]
 [ 5.81872389e-02  2.12533614e-01]
 [ 2.54949213e-01 -6.28738284e-01]
 [-7.55589281e-01  1.30064723e-01]
 [ 6.44009205e-02 -9.17057971e-02]
 [-2.72129994e-02  5.26840589e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.31562444]
curr_Stock_Price:  99.8311203990565
curr_Factors:  [9.98311204e+01 4.03696143e-02]
mat_Sqrt:  [[ 2.00582595e+01  0.00000000e+00]
 [-8.03687644e-03  1.84147973e-02]]
grads:  [-9.80858679e-03  1.56641711e+01]
Stock Position:  -0.00980858679089656
Bond Position:  [2.29482665]


portfolio before change:  [1.30358647]
curr_Stock_Price:  101.1754195220404
curr_Factors:  [1.01175420e+02 4.23116194e-02]
mat_Sqrt:  [[ 2.08115697e+01  0.00000000e+00]
 [-8.22791535e-03  1.88525225e-02]]
grads:  [ 0.00451478 -2.50772876]
Stock Position:  0.004514780595407769
Bond Position:  [0.84680165]


portfolio before change:  [1.30491617]
curr_Stock_Price:  101.37613657937007
curr_Factors:  [1.01376137e+02 4.03608971e-02]
mat_Sqrt:  [[ 2.03664878e+01  0.00000000e+00]
 [-8.03600867e-03  1.84128090e-02]]
grads:  [-0.00484433 -0.00374083]
Stock Position:  -0.004844334005105958
Bond Position:  [1.79601603]


portfolio before change:  [1.30972753]
curr_Stock_Price:  100.5683619307496
curr_Factors:  [1.00568362e+02 4.16648826e-02]
mat_Sqrt:  [[ 2.05279914e+01  0.00000000e+00]
 [-8.16479101e-03  1.87078864e-02]]
grads:  [-1.6678167e-02 -2.1888288e+01]
Stock Position:  -0.016678167041202507
Bond Position:  [2.98702347]


portfolio before change:  [1.29540462]
curr_Stock_Price:  101.5167154254991
curr_Factors:  [1.01516715e+02 3.77359159e-02]
mat_Sqrt:  [[ 1.97203676e+01  0.00000000e+00]
 [-7.77029378e-03  1.78039797e-02]]
grads:  [7.65424438e-03 1.19374217e+01]
Stock Position:  0.007654244383910527
Bond Position:  [0.51837087]


portfolio before change:  [1.31219986]
curr_Stock_Price:  103.67708479129719
curr_Factors:  [1.03677085e+02 3.31240098e-02]
mat_Sqrt:  [[ 1.88692322e+01  0.00000000e+00]
 [-7.28000107e-03  1.66805780e-02]]
grads:  [-1.03102608e-03 -3.76928356e+01]
Stock Position:  -0.0010310260807219254
Bond Position:  [1.41909364]


portfolio before change:  [1.31466775]
curr_Stock_Price:  101.97182543749491
curr_Factors:  [1.01971825e+02 3.46309990e-02]
mat_Sqrt:  [[ 1.89763510e+01  0.00000000e+00]
 [-7.44376238e-03  1.70558023e-02]]
grads:  [-0.03682607  7.62583436]
Stock Position:  -0.03682606752639529
Bond Position:  [5.06988908]


portfolio before change:  [1.22986843]
curr_Stock_Price:  104.34337661599456
curr_Factors:  [1.04343377e+02 3.47953861e-02]
mat_Sqrt:  [[ 1.94637141e+01  0.00000000e+00]
 [-7.46140857e-03  1.70962348e-02]]
grads:  [ 1.25244490e-03 -5.36409322e+00]
Stock Position:  0.0012524448968803709
Bond Position:  [1.0991841]


portfolio before change:  [1.22747493]
curr_Stock_Price:  101.99339026041328
curr_Factors:  [1.01993390e+02 3.80832728e-02]
mat_Sqrt:  [[ 1.99039448e+01  0.00000000e+00]
 [-7.80597441e-03  1.78857343e-02]]
grads:  [-2.12007771e-04  2.94559105e+00]
Stock Position:  -0.0002120077714178219
Bond Position:  [1.24909832]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.22823507]
Stock Price:  101.35457830585216
PL:  [-0.12634324]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-7.26965719e-01  2.92439837e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 5.99277651e-03 -5.51242568e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.41401843e-01 -1.33017979e+00]
 [-9.04926838e-01  3.24824273e-01]
 [ 1.81365237e-02  1.06788142e-01]
 [ 3.12763772e-02 -1.76378593e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.62033195]
curr_Stock_Price:  98.33464576914369
curr_Factors:  [9.83346458e+01 3.81406826e-02]
mat_Sqrt:  [[ 1.92044020e+01  0.00000000e+00]
 [-7.81185588e-03  1.78992104e-02]]
grads:  [-0.03120818 16.33814171]
Stock Position:  -0.031208183953872207
Bond Position:  [-5.55148624]


portfolio before change:  [-8.56126321]
curr_Stock_Price:  96.35294836465407
curr_Factors:  [9.63529484e+01 3.71877132e-02]
mat_Sqrt:  [[ 1.85808144e+01  0.00000000e+00]
 [-7.71364643e-03  1.76741843e-02]]
grads:  [ 0.00505681 -2.67491908]
Stock Position:  0.005056811237089825
Bond Position:  [-9.04850188]


portfolio before change:  [-8.57857164]
curr_Stock_Price:  93.82506169290177
curr_Factors:  [9.38250617e+01 3.89651406e-02]
mat_Sqrt:  [[ 1.85206823e+01  0.00000000e+00]
 [-7.89583593e-03  1.80916329e-02]]
grads:  [ 0.02174683 10.77320636]
Stock Position:  0.021746832783246597
Bond Position:  [-10.61896957]


portfolio before change:  [-8.59366945]
curr_Stock_Price:  93.37501905590193
curr_Factors:  [9.33750191e+01 4.09119023e-02]
mat_Sqrt:  [[ 1.88866764e+01  0.00000000e+00]
 [-8.09067634e-03  1.85380684e-02]]
grads:  [-1.24208833e-02 -2.97357069e+01]
Stock Position:  -0.012420883292382228
Bond Position:  [-7.43386924]


portfolio before change:  [-8.61837662]
curr_Stock_Price:  95.06485834876
curr_Factors:  [9.50648583e+01 4.03416515e-02]
mat_Sqrt:  [[ 1.90939967e+01  0.00000000e+00]
 [-8.03409251e-03  1.84084185e-02]]
grads:  [-3.69054216e-03 -4.62804542e+00]
Stock Position:  -0.003690542163338985
Bond Position:  [-8.26753575]


portfolio before change:  [-8.62021311]
curr_Stock_Price:  94.44210205648093
curr_Factors:  [9.44421021e+01 3.99048513e-02]
mat_Sqrt:  [[ 1.88659419e+01  0.00000000e+00]
 [-7.99047947e-03  1.83084885e-02]]
grads:  [-7.37499422e-03 -7.26537197e+01]
Stock Position:  -0.007374994217202191
Bond Position:  [-7.92370315]


portfolio before change:  [-8.60768905]
curr_Stock_Price:  92.20658852530842
curr_Factors:  [9.22065885e+01 4.30025953e-02]
mat_Sqrt:  [[ 1.91209422e+01  0.00000000e+00]
 [-8.29482686e-03  1.90058360e-02]]
grads:  [-0.03991236 17.09076483]
Stock Position:  -0.039912358740448954
Bond Position:  [-4.92750661]


portfolio before change:  [-8.6240125]
curr_Stock_Price:  92.553826259689
curr_Factors:  [9.25538263e+01 4.23193070e-02]
mat_Sqrt:  [[ 1.90398556e+01  0.00000000e+00]
 [-8.22866278e-03  1.88542350e-02]]
grads:  [3.40037713e-03 5.66388090e+00]
Stock Position:  0.003400377127875157
Bond Position:  [-8.93873041]


portfolio before change:  [-8.63651376]
curr_Stock_Price:  90.1920937352661
curr_Factors:  [9.01920937e+01 4.78639628e-02]
mat_Sqrt:  [[ 1.97320767e+01  0.00000000e+00]
 [-8.75113366e-03  2.00513662e-02]]
grads:  [-2.31610450e-03 -8.79633791e+00]
Stock Position:  -0.002316104496394718
Bond Position:  [-8.42761945]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.63878986]
Stock Price:  89.35501540663932
PL:  [-8.63878986]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-1.32633642e-01  3.71353022e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 6.11973707e-02  5.14073556e-02]
 [-1.51395548e-01 -4.12073928e-01]
 [ 9.84395008e-02  3.51421715e-01]
 [ 3.02220724e-01 -6.02925784e-01]
 [-4.55545563e-01  1.66971891e-02]
 [ 1.21996789e-01 -1.84399026e-01]
 [-4.24976985e-02  2.07696176e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.59898455]
curr_Stock_Price:  101.53053024722578
curr_Factors:  [1.01530530e+02 4.29626071e-02]
mat_Sqrt:  [[ 2.10446627e+01  0.00000000e+00]
 [-8.29096927e-03  1.89969971e-02]]
grads:  [1.39883945e-03 1.95479854e+01]
Stock Position:  0.0013988394520143387
Bond Position:  [12.45695964]


portfolio before change:  [12.60252657]
curr_Stock_Price:  99.60892673271127
curr_Factors:  [9.96089267e+01 4.30962577e-02]
mat_Sqrt:  [[ 2.06784528e+01  0.00000000e+00]
 [-8.30385527e-03  1.90265227e-02]]
grads:  [ 0.00454384 -2.48479523]
Stock Position:  0.004543844358209916
Bond Position:  [12.14991911]


portfolio before change:  [12.60977024]
curr_Stock_Price:  99.86579821929276
curr_Factors:  [9.98657982e+01 4.38265190e-02]
mat_Sqrt:  [[ 2.09066894e+01  0.00000000e+00]
 [-8.37391369e-03  1.91870467e-02]]
grads:  [0.00400032 2.67927402]
Stock Position:  0.004000316770333183
Bond Position:  [12.21027541]


portfolio before change:  [12.61407487]
curr_Stock_Price:  99.41532530954558
curr_Factors:  [9.94153253e+01 4.56361489e-02]
mat_Sqrt:  [[ 2.12377171e+01  0.00000000e+00]
 [-8.54504759e-03  1.95791637e-02]]
grads:  [-1.55967495e-02 -2.10465541e+01]
Stock Position:  -0.015596749510194933
Bond Position:  [14.16463079]


portfolio before change:  [12.56148878]
curr_Stock_Price:  103.24113357230279
curr_Factors:  [1.03241134e+02 4.16159952e-02]
mat_Sqrt:  [[ 2.10611900e+01  0.00000000e+00]
 [-8.15999953e-03  1.86969078e-02]]
grads:  [1.19562338e-02 1.87957132e+01]
Stock Position:  0.011956233763153856
Bond Position:  [11.32711365]


portfolio before change:  [12.55729183]
curr_Stock_Price:  102.41629803088445
curr_Factors:  [1.02416298e+02 4.15809832e-02]
mat_Sqrt:  [[ 2.08841330e+01  0.00000000e+00]
 [-8.15656626e-03  1.86890412e-02]]
grads:  [ 1.87138910e-03 -3.22609266e+01]
Stock Position:  0.001871389096301815
Bond Position:  [12.36563108]


portfolio before change:  [12.57096425]
curr_Stock_Price:  106.41763711619211
curr_Factors:  [1.06417637e+02 3.98555846e-02]
mat_Sqrt:  [[ 2.12450718e+01  0.00000000e+00]
 [-7.98554540e-03  1.82971831e-02]]
grads:  [-0.0210994   0.91255517]
Stock Position:  -0.021099402091524652
Bond Position:  [14.81631277]


portfolio before change:  [12.58910658]
curr_Stock_Price:  105.90898197545509
curr_Factors:  [1.05908982e+02 4.04037416e-02]
mat_Sqrt:  [[ 2.12884276e+01  0.00000000e+00]
 [-8.04027279e-03  1.84225793e-02]]
grads:  [ 1.95028288e-03 -1.00094033e+01]
Stock Position:  0.0019502828777766474
Bond Position:  [12.3825541]


portfolio before change:  [12.59701898]
curr_Stock_Price:  106.79068889773768
curr_Factors:  [1.06790689e+02 4.14697893e-02]
mat_Sqrt:  [[ 2.17469974e+01  0.00000000e+00]
 [-8.14565301e-03  1.86640357e-02]]
grads:  [2.21402263e-03 1.11281493e+01]
Stock Position:  0.0022140226297373837
Bond Position:  [12.36058198]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.60522556]
Stock Price:  107.70519926112291
PL:  [4.9000263]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.07487487e-01  3.25551585e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-7.99257481e-02 -5.46803396e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 4.15794680e-01 -1.09113793e+00]
 [-9.85215992e-01  2.34237167e-01]
 [-2.75414067e-02  3.47438057e-02]
 [-3.24374652e-02 -1.50469348e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.50602079]
curr_Stock_Price:  100.91408063861526
curr_Factors:  [1.00914081e+02 3.92552132e-02]
mat_Sqrt:  [[ 1.99940346e+01  0.00000000e+00]
 [-7.92517136e-03  1.81588488e-02]]
grads:  [-3.27123206e-03  1.79279858e+01]
Stock Position:  -0.0032712320610406107
Bond Position:  [8.83613417]


portfolio before change:  [8.51374192]
curr_Stock_Price:  99.90468729392984
curr_Factors:  [9.99046873e+01 4.03885978e-02]
mat_Sqrt:  [[ 2.00777597e+01  0.00000000e+00]
 [-8.03876585e-03  1.84191265e-02]]
grads:  [ 0.00467979 -2.56673479]
Stock Position:  0.004679788598204061
Bond Position:  [8.04620911]


portfolio before change:  [8.50431598]
curr_Stock_Price:  97.03061536593015
curr_Factors:  [9.70306154e+01 4.07333919e-02]
mat_Sqrt:  [[ 1.95832187e+01  0.00000000e+00]
 [-8.07300607e-03  1.84975807e-02]]
grads:  [ 0.0205669  10.53677764]
Stock Position:  0.02056690416110458
Bond Position:  [6.50869662]


portfolio before change:  [8.46672655]
curr_Stock_Price:  95.04467749780302
curr_Factors:  [9.50446775e+01 4.70611588e-02]
mat_Sqrt:  [[ 2.06185970e+01  0.00000000e+00]
 [-8.67743361e-03  1.98824982e-02]]
grads:  [-1.54506301e-02 -2.75017451e+01]
Stock Position:  -0.015450630095652836
Bond Position:  [9.93522671]


portfolio before change:  [8.47337825]
curr_Stock_Price:  94.93576026503396
curr_Factors:  [9.49357603e+01 4.76224190e-02]
mat_Sqrt:  [[ 2.07174147e+01  0.00000000e+00]
 [-8.72902459e-03  2.00007080e-02]]
grads:  [-3.40135103e-03 -4.25959907e+00]
Stock Position:  -0.0034013510342961687
Bond Position:  [8.79628809]


portfolio before change:  [8.47256901]
curr_Stock_Price:  96.46705735935151
curr_Factors:  [9.64670574e+01 5.04369622e-02]
mat_Sqrt:  [[ 2.16647405e+01  0.00000000e+00]
 [-8.98326998e-03  2.05832573e-02]]
grads:  [-2.78872263e-03 -5.30109452e+01]
Stock Position:  -0.0027887226336284422
Bond Position:  [8.74158888]


portfolio before change:  [8.47143591]
curr_Stock_Price:  98.44107528362647
curr_Factors:  [9.84410753e+01 5.09271277e-02]
mat_Sqrt:  [[ 2.22152365e+01  0.00000000e+00]
 [-9.02681584e-03  2.06830334e-02]]
grads:  [-0.03974689 11.32508765]
Stock Position:  -0.039746887819137676
Bond Position:  [12.38416229]


portfolio before change:  [8.58489426]
curr_Stock_Price:  95.74238038985601
curr_Factors:  [9.57423804e+01 5.04482673e-02]
mat_Sqrt:  [[ 2.15044009e+01  0.00000000e+00]
 [-8.98427670e-03  2.05855640e-02]]
grads:  [-5.75601562e-04  1.68777526e+00]
Stock Position:  -0.0005756015623097741
Bond Position:  [8.64000373]


portfolio before change:  [8.58926763]
curr_Stock_Price:  95.65154524450854
curr_Factors:  [9.56515452e+01 4.97282574e-02]
mat_Sqrt:  [[ 2.13301353e+01  0.00000000e+00]
 [-8.91993340e-03  2.04381350e-02]]
grads:  [-4.59948664e-03 -7.36218584e+00]
Stock Position:  -0.004599486644355086
Bond Position:  [9.02921564]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.58808033]
Stock Price:  96.89147527754326
PL:  [8.58808033]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.93709599e-01  3.12056625e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 6.95239458e-02  5.57884252e-02]
 [-1.62559071e-01 -4.11551412e-01]
 [ 5.95514960e-03  5.58634324e-02]
 [ 4.14596332e-01 -1.04980932e+00]
 [-8.18980196e-01  1.55464946e-01]
 [ 2.55695552e-02 -2.86498368e-02]
 [-4.19978677e-02  2.03654354e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.7939132]
curr_Stock_Price:  100.05376847997051
curr_Factors:  [1.00053768e+02 3.81951511e-02]
mat_Sqrt:  [[ 1.95540881e+01  0.00000000e+00]
 [-7.81743191e-03  1.79119867e-02]]
grads:  [-8.05544714e-03  1.74216646e+01]
Stock Position:  -0.00805544713674783
Bond Position:  [3.59989104]


portfolio before change:  [2.79075246]
curr_Stock_Price:  100.66964162714764
curr_Factors:  [1.00669642e+02 3.90973091e-02]
mat_Sqrt:  [[ 1.9905448e+01  0.0000000e+00]
 [-7.9092158e-03  1.8122290e-02]]
grads:  [ 0.0047203  -2.60877697]
Stock Position:  0.004720299235782295
Bond Position:  [2.31556163]


portfolio before change:  [2.78759281]
curr_Stock_Price:  99.75492864664393
curr_Factors:  [9.97549286e+01 3.74100279e-02]
mat_Sqrt:  [[ 1.92942712e+01  0.00000000e+00]
 [-7.73666884e-03  1.77269353e-02]]
grads:  [0.00486528 3.14709928]
Stock Position:  0.004865278911004635
Bond Position:  [2.30225726]


portfolio before change:  [2.79345578]
curr_Stock_Price:  100.72333104227063
curr_Factors:  [1.00723331e+02 3.61926383e-02]
mat_Sqrt:  [[ 1.91619720e+01  0.00000000e+00]
 [-7.60974515e-03  1.74361166e-02]]
grads:  [-1.78569738e-02 -2.36033872e+01]
Stock Position:  -0.017856973844280435
Bond Position:  [4.59206967]


portfolio before change:  [2.81773157]
curr_Stock_Price:  99.49248498403144
curr_Factors:  [9.94924850e+01 3.51870241e-02]
mat_Sqrt:  [[ 1.86630039e+01  0.00000000e+00]
 [-7.50328185e-03  1.71921785e-02]]
grads:  [1.62545914e-03 3.24935158e+00]
Stock Position:  0.0016254591411125321
Bond Position:  [2.6560106]


portfolio before change:  [2.81492662]
curr_Stock_Price:  96.94963961059678
curr_Factors:  [9.69496396e+01 3.57895058e-02]
mat_Sqrt:  [[ 1.83410439e+01  0.00000000e+00]
 [-7.56724582e-03  1.73387384e-02]]
grads:  [-2.37598355e-03 -6.05470420e+01]
Stock Position:  -0.0023759835465458163
Bond Position:  [3.04527737]


portfolio before change:  [2.80682228]
curr_Stock_Price:  101.00158470636819
curr_Factors:  [1.01001585e+02 3.09641960e-02]
mat_Sqrt:  [[ 1.77728916e+01  0.00000000e+00]
 [-7.03865851e-03  1.61275927e-02]]
grads:  [-0.04226266  9.63968701]
Stock Position:  -0.04226266315516103
Bond Position:  [7.07541824]


portfolio before change:  [2.71391968]
curr_Stock_Price:  103.28353267343925
curr_Factors:  [1.03283533e+02 3.18376961e-02]
mat_Sqrt:  [[ 1.84290055e+01  0.00000000e+00]
 [-7.13724833e-03  1.63534904e-02]]
grads:  [ 7.08977016e-04 -1.75190960e+00]
Stock Position:  0.0007089770163021802
Bond Position:  [2.64069403]


portfolio before change:  [2.71764376]
curr_Stock_Price:  106.67349832818422
curr_Factors:  [1.06673498e+02 2.87032066e-02]
mat_Sqrt:  [[ 1.80726462e+01  0.00000000e+00]
 [-6.77680829e-03  1.55276185e-02]]
grads:  [2.59420667e-03 1.31156207e+01]
Stock Position:  0.00259420667198565
Bond Position:  [2.44091066]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.72246482]
Stock Price:  108.0613213831138
PL:  [-5.33885656]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.24843238e-01  3.39889026e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.20073569e-01 -5.00023055e-01]
 [-3.33688362e-02 -8.56167065e-02]
 [ 4.21733706e-01 -1.11702902e+00]
 [-7.81586436e-01  1.39888062e-01]
 [ 4.15105708e-03  6.21876632e-03]
 [-3.22071774e-02  1.09226728e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.59457439]
curr_Stock_Price:  100.62619380222837
curr_Factors:  [1.00626194e+02 3.79298733e-02]
mat_Sqrt:  [[ 1.95975482e+01  0.00000000e+00]
 [-7.79023731e-03  1.78496761e-02]]
grads:  [-3.90372840e-03  1.90417476e+01]
Stock Position:  -0.003903728400643912
Bond Position:  [6.98739172]


portfolio before change:  [6.60623721]
curr_Stock_Price:  98.5337695611069
curr_Factors:  [9.85337696e+01 3.63608519e-02]
mat_Sqrt:  [[ 1.87889332e+01  0.00000000e+00]
 [-7.62740868e-03  1.74765888e-02]]
grads:  [ 0.0050008  -2.70516251]
Stock Position:  0.005000798604587923
Bond Position:  [6.11348967]


portfolio before change:  [6.59457947]
curr_Stock_Price:  95.5911895605759
curr_Factors:  [9.55911896e+01 3.43802457e-02]
mat_Sqrt:  [[ 1.77244331e+01  0.00000000e+00]
 [-7.41676433e-03  1.69939420e-02]]
grads:  [ 0.02272378 11.46908086]
Stock Position:  0.02272378351918892
Bond Position:  [4.42238597]


portfolio before change:  [6.62465211]
curr_Stock_Price:  96.8172569435374
curr_Factors:  [9.68172569e+01 3.38759463e-02]
mat_Sqrt:  [[ 1.78196222e+01  0.00000000e+00]
 [-7.36216776e-03  1.68688455e-02]]
grads:  [-1.89847752e-02 -2.96418065e+01]
Stock Position:  -0.018984775191578443
Bond Position:  [8.46270596]


portfolio before change:  [6.62700479]
curr_Stock_Price:  96.91626916082828
curr_Factors:  [9.69162692e+01 3.22461580e-02]
mat_Sqrt:  [[ 1.74034631e+01  0.00000000e+00]
 [-7.18288611e-03  1.64580596e-02]]
grads:  [-4.06442270e-03 -5.20211424e+00]
Stock Position:  -0.004064422695494284
Bond Position:  [7.02091348]


portfolio before change:  [6.63270547]
curr_Stock_Price:  96.37760801240593
curr_Factors:  [9.63776080e+01 3.31515953e-02]
mat_Sqrt:  [[ 1.75480297e+01  0.00000000e+00]
 [-7.28303182e-03  1.66875223e-02]]
grads:  [-3.74843950e-03 -6.69379793e+01]
Stock Position:  -0.0037484394967285156
Bond Position:  [6.99397111]


portfolio before change:  [6.61664988]
curr_Stock_Price:  101.5940320298555
curr_Factors:  [1.01594032e+02 3.11316839e-02]
mat_Sqrt:  [[ 1.79254267e+01  0.00000000e+00]
 [-7.05766918e-03  1.61711516e-02]]
grads:  [-0.04019621  8.65046999]
Stock Position:  -0.04019621355624597
Bond Position:  [10.70034529]


portfolio before change:  [6.57769744]
curr_Stock_Price:  102.69622428031627
curr_Factors:  [1.02696224e+02 3.31082835e-02]
mat_Sqrt:  [[ 1.86862782e+01  0.00000000e+00]
 [-7.27827271e-03  1.66766178e-02]]
grads:  [3.67389865e-04 3.72903330e-01]
Stock Position:  0.00036738986503106856
Bond Position:  [6.53996789]


portfolio before change:  [6.58134498]
curr_Stock_Price:  103.72166250861342
curr_Factors:  [1.03721663e+02 3.26098273e-02]
mat_Sqrt:  [[ 1.87302562e+01  0.00000000e+00]
 [-7.22327652e-03  1.65506057e-02]]
grads:  [8.25577326e-04 6.59956075e+00]
Stock Position:  0.0008255773255702358
Bond Position:  [6.49571472]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.58384639]
Stock Price:  102.8165306293276
PL:  [3.76731576]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.64158910e-01  2.11313643e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [-1.49060538e-01 -4.12911647e-01]
 [-1.33508579e-02 -3.40102621e-03]
 [ 4.13815646e-01 -1.06435344e+00]
 [-9.81215364e-01  2.98761747e-01]
 [-1.45458871e-02  4.64864583e-02]
 [-3.36116248e-02 -2.04119390e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.61607115]
curr_Stock_Price:  97.13039120277789
curr_Factors:  [9.71303912e+01 4.04277403e-02]
mat_Sqrt:  [[ 1.95296685e+01  0.00000000e+00]
 [-8.04266029e-03  1.84280498e-02]]
grads:  [-0.04464664 11.46695638]
Stock Position:  -0.04464663981060847
Bond Position:  [-12.27952556]


portfolio before change:  [-16.62798226]
curr_Stock_Price:  97.25962407070121
curr_Factors:  [9.72596241e+01 4.21850083e-02]
mat_Sqrt:  [[ 1.99761438e+01  0.00000000e+00]
 [-8.21559574e-03  1.88242947e-02]]
grads:  [ 0.00470359 -2.5114892 ]
Stock Position:  0.004703594038867319
Bond Position:  [-17.08545205]


portfolio before change:  [-16.64032395]
curr_Stock_Price:  96.45240554222887
curr_Factors:  [9.64524055e+01 4.10216797e-02]
mat_Sqrt:  [[ 1.95352864e+01  0.00000000e+00]
 [-8.10152378e-03  1.85629230e-02]]
grads:  [ 0.02061737 10.49968773]
Stock Position:  0.02061736759977079
Bond Position:  [-18.62891865]


portfolio before change:  [-16.59127491]
curr_Stock_Price:  99.28331146682206
curr_Factors:  [9.92833115e+01 4.27171162e-02]
mat_Sqrt:  [[ 2.05199934e+01  0.00000000e+00]
 [-8.26724778e-03  1.89426444e-02]]
grads:  [-1.60462992e-02 -2.17979939e+01]
Stock Position:  -0.01604629924585146
Bond Position:  [-14.99814519]


portfolio before change:  [-16.59160714]
curr_Stock_Price:  98.83655896103637
curr_Factors:  [9.88365590e+01 4.40162017e-02]
mat_Sqrt:  [[ 2.07359482e+01  0.00000000e+00]
 [-8.39201541e-03  1.92285229e-02]]
grads:  [-0.00071543 -0.17687402]
Stock Position:  -0.0007154332817651224
Bond Position:  [-16.52089617]


portfolio before change:  [-16.59836289]
curr_Stock_Price:  96.73047808136089
curr_Factors:  [9.67304781e+01 4.70766842e-02]
mat_Sqrt:  [[ 2.09877686e+01  0.00000000e+00]
 [-8.67886483e-03  1.98857775e-02]]
grads:  [-2.41599192e-03 -5.35233506e+01]
Stock Position:  -0.00241599191700948
Bond Position:  [-16.36466284]


portfolio before change:  [-16.60002288]
curr_Stock_Price:  94.02997902542444
curr_Factors:  [9.4029979e+01 4.6913893e-02]
mat_Sqrt:  [[ 2.03665316e+01  0.00000000e+00]
 [-8.66384607e-03  1.98513652e-02]]
grads:  [-0.04177565 15.04993455]
Stock Position:  -0.04177564762309517
Bond Position:  [-12.67185961]


portfolio before change:  [-16.63528513]
curr_Stock_Price:  94.72236168435926
curr_Factors:  [9.47223617e+01 4.51903259e-02]
mat_Sqrt:  [[ 2.01360951e+01  0.00000000e+00]
 [-8.50320654e-03  1.94832938e-02]]
grads:  [2.85182729e-04 2.38596506e+00]
Stock Position:  0.0002851827288525364
Bond Position:  [-16.66229831]


portfolio before change:  [-16.64393117]
curr_Stock_Price:  93.62548622282215
curr_Factors:  [9.36254862e+01 4.56744957e-02]
mat_Sqrt:  [[ 2.00092572e+01  0.00000000e+00]
 [-8.54863691e-03  1.95873879e-02]]
grads:  [-6.13199326e-03 -1.04209602e+01]
Stock Position:  -0.0061319932550467715
Bond Position:  [-16.06982032]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.64054163]
Stock Price:  91.76206913280147
PL:  [-16.64054163]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-3.54008744e-01  2.73557195e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.93317513e-02  5.57222680e-03]
 [-1.47656804e-01 -4.42135258e-01]
 [ 6.21405709e-02  2.24703963e-01]
 [ 3.47386970e-01 -6.60262641e-01]
 [-1.06327797e+00  2.60959776e-01]
 [-7.21743896e-02 -9.10271119e-03]
 [-2.78202740e-02  1.68131083e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.00226005]
curr_Stock_Price:  99.63331191279657
curr_Factors:  [9.96333119e+01 3.85204029e-02]
mat_Sqrt:  [[ 1.95546469e+01  0.00000000e+00]
 [-7.85064613e-03  1.79880901e-02]]
grads:  [-1.19980994e-02  1.52076843e+01]
Stock Position:  -0.011998099366018936
Bond Position:  [1.19767042]


portfolio before change:  [-0.00470172]
curr_Stock_Price:  100.26347443403486
curr_Factors:  [1.00263474e+02 4.20596249e-02]
mat_Sqrt:  [[ 2.05624779e+01  0.00000000e+00]
 [-8.20337734e-03  1.87962988e-02]]
grads:  [ 0.00456947 -2.5152299 ]
Stock Position:  0.004569472204582692
Bond Position:  [-0.46285288]


portfolio before change:  [0.00286963]
curr_Stock_Price:  101.9710755022898
curr_Factors:  [1.01971076e+02 4.04002226e-02]
mat_Sqrt:  [[ 2.04959890e+01  0.00000000e+00]
 [-8.03992265e-03  1.84217771e-02]]
grads:  [-0.00472775  0.30248042]
Stock Position:  -0.004727746105780284
Bond Position:  [0.48496299]


portfolio before change:  [-0.00071746]
curr_Stock_Price:  102.7811085223099
curr_Factors:  [1.02781109e+02 3.87123512e-02]
mat_Sqrt:  [[ 2.02226503e+01  0.00000000e+00]
 [-7.87018182e-03  1.80328520e-02]]
grads:  [-1.68435119e-02 -2.45183213e+01]
Stock Position:  -0.016843511851277995
Bond Position:  [1.73047736]


portfolio before change:  [0.01878556]
curr_Stock_Price:  101.67459560065623
curr_Factors:  [1.01674596e+02 3.73049476e-02]
mat_Sqrt:  [[ 1.96379283e+01  0.00000000e+00]
 [-7.72579550e-03  1.77020214e-02]]
grads:  [8.15816299e-03 1.26936895e+01]
Stock Position:  0.008158162989356935
Bond Position:  [-0.81069236]


portfolio before change:  [0.01247305]
curr_Stock_Price:  100.95052748170436
curr_Factors:  [1.00950527e+02 3.88992461e-02]
mat_Sqrt:  [[ 1.99103633e+01  0.00000000e+00]
 [-7.88915672e-03  1.80763289e-02]]
grads:  [ 2.97456798e-03 -3.65263679e+01]
Stock Position:  0.00297456797629837
Bond Position:  [-0.28781116]


portfolio before change:  [0.0001914]
curr_Stock_Price:  96.87003219186126
curr_Factors:  [9.68700322e+01 4.70205003e-02]
mat_Sqrt:  [[ 2.10055021e+01  0.00000000e+00]
 [-8.67368437e-03  1.98739076e-02]]
grads:  [-0.045197   13.13077337]
Stock Position:  -0.04519700494933308
Bond Position:  [4.37842672]


portfolio before change:  [-0.09678773]
curr_Stock_Price:  99.06417950030792
curr_Factors:  [9.90641795e+01 4.73691579e-02]
mat_Sqrt:  [[ 2.15607805e+01  0.00000000e+00]
 [-8.70578271e-03  1.99474541e-02]]
grads:  [-0.00353174 -0.45633448]
Stock Position:  -0.0035317431288382404
Bond Position:  [0.25308151]


portfolio before change:  [-0.10249664]
curr_Stock_Price:  100.7164751691205
curr_Factors:  [1.00716475e+02 4.68326026e-02]
mat_Sqrt:  [[ 2.17958929e+01  0.00000000e+00]
 [-8.65633665e-03  1.98341590e-02]]
grads:  [-0.00093974  0.84768446]
Stock Position:  -0.0009397381474435829
Bond Position:  [-0.00784953]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.09954312]
Stock Price:  97.56937601447173
PL:  [-0.09954312]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [ 2.73927596e-02  7.14730695e-02]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.93477972e-02  5.45799538e-03]
 [-1.43790271e-01 -4.50146277e-01]
 [ 9.05547434e-02  3.14635340e-01]
 [ 3.24602633e-01 -5.90883826e-01]
 [-5.97885227e-01  7.04766190e-02]
 [ 1.29893800e-02 -7.78963426e-03]
 [-3.35866519e-02  1.21708097e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.44953452]
curr_Stock_Price:  101.95985738310318
curr_Factors:  [1.01959857e+02 3.94909566e-02]
mat_Sqrt:  [[ 2.02618010e+01  0.00000000e+00]
 [-7.94893267e-03  1.82132928e-02]]
grads:  [2.89145888e-03 3.92422557e+00]
Stock Position:  0.002891458876090359
Bond Position:  [15.15472178]


portfolio before change:  [15.45310658]
curr_Stock_Price:  100.57398606582403
curr_Factors:  [1.00573986e+02 3.81910083e-02]
mat_Sqrt:  [[ 1.96546912e+01  0.00000000e+00]
 [-7.81700795e-03  1.79110153e-02]]
grads:  [ 0.00478052 -2.63954957]
Stock Position:  0.0047805213527989335
Bond Position:  [14.97231049]


portfolio before change:  [15.46695514]
curr_Stock_Price:  101.90449595187498
curr_Factors:  [1.01904496e+02 3.92638302e-02]
mat_Sqrt:  [[ 2.01924807e+01  0.00000000e+00]
 [-7.92604115e-03  1.81608418e-02]]
grads:  [-0.00480207  0.30053648]
Stock Position:  -0.004802071331040561
Bond Position:  [15.9563078]


portfolio before change:  [15.46816881]
curr_Stock_Price:  103.3135705251036
curr_Factors:  [1.03313571e+02 4.17036172e-02]
mat_Sqrt:  [[ 2.10981431e+01  0.00000000e+00]
 [-8.16858540e-03  1.87165805e-02]]
grads:  [-1.61270218e-02 -2.40506687e+01]
Stock Position:  -0.016127021767578117
Bond Position:  [17.13430901]


portfolio before change:  [15.48442976]
curr_Stock_Price:  102.83662874443775
curr_Factors:  [1.02836629e+02 4.52174638e-02]
mat_Sqrt:  [[ 2.18675904e+01  0.00000000e+00]
 [-8.50575935e-03  1.94891430e-02]]
grads:  [1.04205749e-02 1.61441342e+01]
Stock Position:  0.010420574882870938
Bond Position:  [14.41281297]


portfolio before change:  [15.48104988]
curr_Stock_Price:  101.82055332522846
curr_Factors:  [1.01820553e+02 4.54148706e-02]
mat_Sqrt:  [[ 2.16987389e+01  0.00000000e+00]
 [-8.52430601e-03  1.95316388e-02]]
grads:  [ 3.07482338e-03 -3.02526497e+01]
Stock Position:  0.0030748233787484458
Bond Position:  [15.16796966]


portfolio before change:  [15.49622638]
curr_Stock_Price:  104.28918863219619
curr_Factors:  [1.04289189e+02 4.53394982e-02]
mat_Sqrt:  [[ 2.22063737e+01  0.00000000e+00]
 [-8.51722943e-03  1.95154243e-02]]
grads:  [-0.02553892  3.61132907]
Stock Position:  -0.025538915856010178
Bond Position:  [18.15965919]


portfolio before change:  [15.54010071]
curr_Stock_Price:  102.92686614395501
curr_Factors:  [1.02926866e+02 4.50660437e-02]
mat_Sqrt:  [[ 2.18501019e+01  0.00000000e+00]
 [-8.49150575e-03  1.94564839e-02]]
grads:  [ 0.00043889 -0.40036187]
Stock Position:  0.00043888604922151774
Bond Position:  [15.49492755]


portfolio before change:  [15.54836593]
curr_Stock_Price:  104.10215499207227
curr_Factors:  [1.04102155e+02 4.57628292e-02]
mat_Sqrt:  [[ 2.22697916e+01  0.00000000e+00]
 [-8.55689936e-03  1.96063195e-02]]
grads:  [8.77022857e-04 6.20759529e+00]
Stock Position:  0.0008770228570048846
Bond Position:  [15.45706596]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.55512264]
Stock Price:  102.99185500409563
PL:  [12.56326764]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.34029734e-01  3.47620196e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [-9.90913084e-02  7.28395176e-03]
 [-1.41971993e-01 -4.52478220e-01]
 [ 1.85875548e-01  7.59355035e-01]
 [ 2.01524304e-01 -6.72961361e-01]
 [-5.54587521e-01  5.41183158e-02]
 [ 2.34722260e-01 -3.62784975e-01]
 [-3.71293998e-02  1.56077806e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.07141286]
curr_Stock_Price:  100.54739937959884
curr_Factors:  [1.00547399e+02 4.00761937e-02]
mat_Sqrt:  [[ 2.01286235e+01  0.00000000e+00]
 [-8.00761575e-03  1.83477527e-02]]
grads:  [-4.08949190e-03  1.89462003e+01]
Stock Position:  -0.004089491901444439
Bond Position:  [6.48260064]


portfolio before change:  [6.08027706]
curr_Stock_Price:  99.17263419911049
curr_Factors:  [9.91726342e+01 4.15474007e-02]
mat_Sqrt:  [[ 2.02145361e+01  0.00000000e+00]
 [-8.15327181e-03  1.86814926e-02]]
grads:  [ 0.00464812 -2.53068713]
Stock Position:  0.0046481240407175006
Bond Position:  [5.61931036]


portfolio before change:  [6.10077743]
curr_Stock_Price:  102.978472037911
curr_Factors:  [1.02978472e+02 4.32616055e-02]
mat_Sqrt:  [[ 2.14189294e+01  0.00000000e+00]
 [-8.31976976e-03  1.90629873e-02]]
grads:  [-0.00447792  0.38209918]
Stock Position:  -0.004477923677940734
Bond Position:  [6.56190717]


portfolio before change:  [6.10175369]
curr_Stock_Price:  103.49333281207412
curr_Factors:  [1.03493333e+02 4.26100210e-02]
mat_Sqrt:  [[ 2.13632955e+01  0.00000000e+00]
 [-8.25687796e-03  1.89188841e-02]]
grads:  [-1.58893874e-02 -2.39167499e+01]
Stock Position:  -0.015889387404337364
Bond Position:  [7.74619935]


portfolio before change:  [6.03785001]
curr_Stock_Price:  107.75893138537187
curr_Factors:  [1.07758931e+02 4.00281702e-02]
mat_Sqrt:  [[ 2.15593739e+01  0.00000000e+00]
 [-8.00281652e-03  1.83367562e-02]]
grads:  [2.39935194e-02 4.14116338e+01]
Stock Position:  0.023993519355506653
Bond Position:  [3.45233401]


portfolio before change:  [6.05947403]
curr_Stock_Price:  108.58821422665211
curr_Factors:  [1.08588214e+02 3.90709007e-02]
mat_Sqrt:  [[ 2.14639379e+01  0.00000000e+00]
 [-7.90654420e-03  1.81161686e-02]]
grads:  [-4.29465054e-03 -3.71470025e+01]
Stock Position:  -0.004294650540500679
Bond Position:  [6.52582246]


portfolio before change:  [6.07838928]
curr_Stock_Price:  104.94379094713275
curr_Factors:  [1.04943791e+02 4.07289322e-02]
mat_Sqrt:  [[ 2.11791371e+01  0.00000000e+00]
 [-8.07256413e-03  1.84965681e-02]]
grads:  [-0.02507035  2.92585714]
Stock Position:  -0.025070348729352043
Bond Position:  [8.70936671]


portfolio before change:  [5.98205214]
curr_Stock_Price:  108.960205236997
curr_Factors:  [1.08960205e+02 4.18762100e-02]
mat_Sqrt:  [[ 2.22972651e+01  0.00000000e+00]
 [-8.18547103e-03  1.87552703e-02]]
grads:  [ 3.42597698e-03 -1.93430950e+01]
Stock Position:  0.0034259769783350153
Bond Position:  [5.60875699]


portfolio before change:  [5.97190265]
curr_Stock_Price:  105.17892813614715
curr_Factors:  [1.05178928e+02 4.09997330e-02]
mat_Sqrt:  [[ 2.12970404e+01  0.00000000e+00]
 [-8.09935632e-03  1.85579567e-02]]
grads:  [1.45506317e-03 8.41029043e+00]
Stock Position:  0.0014550631723858453
Bond Position:  [5.81886067]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.97474108]
Stock Price:  105.12962911988495
PL:  [0.84511196]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-9.31184339e-01  2.59050629e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 3.17702712e-01  1.94904895e-01]
 [ 1.93408009e-01 -5.57207451e-01]
 [-3.32850547e-02 -8.51949971e-02]
 [ 5.29661113e-01 -2.22131675e+00]
 [-5.68845420e-01  4.33818698e-01]
 [ 1.77135799e-01  2.14695632e-02]
 [ 4.87766481e-02 -1.71767505e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.42769796]
curr_Stock_Price:  97.45998654686423
curr_Factors:  [9.74599865e+01 4.11676889e-02]
mat_Sqrt:  [[ 1.97744581e+01  0.00000000e+00]
 [-8.11592892e-03  1.85959293e-02]]
grads:  [-0.04137283 13.93050192]
Stock Position:  -0.041372834167321425
Bond Position:  [-10.3955021]


portfolio before change:  [-14.353383]
curr_Stock_Price:  95.53809720468462
curr_Factors:  [9.55380972e+01 4.30041993e-02]
mat_Sqrt:  [[ 1.98121688e+01  0.00000000e+00]
 [-8.29498155e-03  1.90061904e-02]]
grads:  [ 0.00474252 -2.48745339]
Stock Position:  0.004742523234994257
Bond Position:  [-14.80647464]


portfolio before change:  [-14.37571359]
curr_Stock_Price:  92.39093131899266
curr_Factors:  [9.23909313e+01 4.18652088e-02]
mat_Sqrt:  [[ 1.89040987e+01  0.00000000e+00]
 [-8.18439577e-03  1.87528066e-02]]
grads:  [ 0.02130576 10.39337201]
Stock Position:  0.021305759574635368
Bond Position:  [-16.34417256]


portfolio before change:  [-14.43874082]
curr_Stock_Price:  89.8163648529838
curr_Factors:  [8.98163649e+01 4.01359594e-02]
mat_Sqrt:  [[ 1.79937755e+01  0.00000000e+00]
 [-8.01358441e-03  1.83614286e-02]]
grads:  [-2.76635993e-03 -3.03466284e+01]
Stock Position:  -0.002766359929819646
Bond Position:  [-14.19027643]


portfolio before change:  [-14.4428531]
curr_Stock_Price:  88.73746310469987
curr_Factors:  [8.87374631e+01 3.95373071e-02]
mat_Sqrt:  [[ 1.76445486e+01  0.00000000e+00]
 [-7.95359612e-03  1.82239781e-02]]
grads:  [-3.99370942e-03 -4.67488473e+00]
Stock Position:  -0.003993709416799931
Bond Position:  [-14.08846146]


portfolio before change:  [-14.4413532]
curr_Stock_Price:  86.59762517040637
curr_Factors:  [8.65976252e+01 3.73788594e-02]
mat_Sqrt:  [[ 1.67424498e+01  0.00000000e+00]
 [-7.73344522e-03  1.77195491e-02]]
grads:  [-2.62686169e-02 -1.25359666e+02]
Stock Position:  -0.026268616868640304
Bond Position:  [-12.16655336]


portfolio before change:  [-14.41345889]
curr_Stock_Price:  85.30410017284053
curr_Factors:  [8.53041002e+01 4.13512438e-02]
mat_Sqrt:  [[ 1.73465932e+01  0.00000000e+00]
 [-8.13400210e-03  1.86373402e-02]]
grads:  [-2.18781528e-02  2.32768568e+01]
Stock Position:  -0.02187815282911278
Bond Position:  [-12.54716275]


portfolio before change:  [-14.49445997]
curr_Stock_Price:  88.71965057953366
curr_Factors:  [8.87196506e+01 3.78641084e-02]
mat_Sqrt:  [[ 1.72636924e+01  0.00000000e+00]
 [-7.78348081e-03  1.78341950e-02]]
grads:  [0.01080336 1.20384258]
Stock Position:  0.010803359992228569
Bond Position:  [-15.45293029]


portfolio before change:  [-14.49121752]
curr_Stock_Price:  89.73515425591951
curr_Factors:  [8.97351543e+01 3.32348866e-02]
mat_Sqrt:  [[ 1.63591116e+01  0.00000000e+00]
 [-7.29217516e-03  1.67084723e-02]]
grads:  [-1.60087161e-03 -1.02802639e+01]
Stock Position:  -0.0016008716069829828
Bond Position:  [-14.34756305]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.49745134]
Stock Price:  89.14688365399766
PL:  [-14.49745134]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.54293379e+02 -4.92669686e+01]
 [-2.08299911e-01  3.26423207e-01]
 [ 1.14593051e-01 -4.72770129e-02]
 [ 1.43477199e-01  8.97144763e-02]
 [-1.41998701e-01 -4.34661413e-01]
 [ 5.34201775e-02  1.97881786e-01]
 [ 3.61935694e-01 -7.06027014e-01]
 [-8.43056643e-01  1.67180080e-01]
 [ 5.66187901e-03  3.99357676e-03]
 [-2.77068853e-02  6.55985647e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.2933793  -49.26696863]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63957557 -2687.73348822]
init_Out:  [2.76759096]
Stock Position:  6.639575569856165
Bond position:  [-661.18996603]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.12154971]
curr_Stock_Price:  101.00678670272674
curr_Factors:  [1.01006787e+02 3.97388739e-02]
mat_Sqrt:  [[ 2.01353106e+01  0.00000000e+00]
 [-7.97384463e-03  1.82703733e-02]]
grads:  [-3.26973570e-03  1.78662582e+01]
Stock Position:  -0.0032697357015340402
Bond Position:  [9.45181521]


portfolio before change:  [9.13373714]
curr_Stock_Price:  98.72515150560356
curr_Factors:  [9.87251515e+01 4.12487075e-02]
mat_Sqrt:  [[ 2.00508589e+01  0.00000000e+00]
 [-8.12391112e-03  1.86142188e-02]]
grads:  [ 0.00468607 -2.5398333 ]
Stock Position:  0.00468606713698683
Bond Position:  [8.67110445]


portfolio before change:  [9.13739466]
curr_Stock_Price:  98.58022766330477
curr_Factors:  [9.85802277e+01 4.05243137e-02]
mat_Sqrt:  [[ 1.98448422e+01  0.00000000e+00]
 [-8.05226067e-03  1.84500470e-02]]
grads:  [0.00920299 4.86256085]
Stock Position:  0.009202986063676269
Bond Position:  [8.23016219]


portfolio before change:  [9.1423432]
curr_Stock_Price:  98.6706802584757
curr_Factors:  [9.86706803e+01 3.85138373e-02]
mat_Sqrt:  [[ 1.93640644e+01  0.00000000e+00]
 [-7.84997705e-03  1.79865570e-02]]
grads:  [-1.71296938e-02 -2.41659041e+01]
Stock Position:  -0.017129693807591634
Bond Position:  [10.83254174]


portfolio before change:  [9.10228449]
curr_Stock_Price:  101.3255050826761
curr_Factors:  [1.01325505e+02 3.70548792e-02]
mat_Sqrt:  [[ 1.95047989e+01  0.00000000e+00]
 [-7.69985758e-03  1.76425901e-02]]
grads:  [7.16658856e-03 1.12161414e+01]
Stock Position:  0.007166588557780093
Bond Position:  [8.37612628]


portfolio before change:  [9.09952082]
curr_Stock_Price:  100.35533939975379
curr_Factors:  [1.00355339e+02 3.74312469e-02]
mat_Sqrt:  [[ 1.94159047e+01  0.00000000e+00]
 [-7.73886265e-03  1.77319619e-02]]
grads:  [ 2.77093675e-03 -3.98166326e+01]
Stock Position:  0.002770936746828548
Bond Position:  [8.82144252]


portfolio before change:  [9.10465567]
curr_Stock_Price:  100.61626961030044
curr_Factors:  [1.00616270e+02 3.86804465e-02]
mat_Sqrt:  [[ 1.97885490e+01  0.00000000e+00]
 [-7.86693806e-03  1.80254196e-02]]
grads:  [-0.03891611  9.27468454]
Stock Position:  -0.03891610614931714
Bond Position:  [13.02024909]


portfolio before change:  [9.02889249]
curr_Stock_Price:  102.73043096742114
curr_Factors:  [1.02730431e+02 4.07154793e-02]
mat_Sqrt:  [[ 2.07290255e+01  0.00000000e+00]
 [-8.07123082e-03  1.84935131e-02]]
grads:  [0.00035722 0.21594473]
Stock Position:  0.00035721982194829565
Bond Position:  [8.99219514]


portfolio before change:  [9.03325567]
curr_Stock_Price:  102.35519346440572
curr_Factors:  [1.02355193e+02 3.81427263e-02]
mat_Sqrt:  [[ 1.99901360e+01  0.00000000e+00]
 [-7.81206516e-03  1.78996900e-02]]
grads:  [4.61565366e-05 3.66478776e+00]
Stock Position:  4.6156536594406566e-05
Bond Position:  [9.02853131]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.03776086]
Stock Price:  102.13407428871206
PL:  [6.90368657]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -1.4950340262229576
FINAL STD P&L:  13.362378564154627
